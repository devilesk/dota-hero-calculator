<div class="row">
    <div class="col-md-4">
        <img class="img-rounded" data-bind="attr:{src: '/media/images/heroes/meepo.png'}"/>
    </div>
</div>

<div class="row">
    <div class="col-md-4" data-bind="css: {'col-md-4': $root.layout() == 0, 'col-md-12': $root.layout() == 1}">
        <div class="row">
            <h3 class="col-md-12">Stats <a class="btn btn-default btn-xs" data-bind="toggle: showStatDetails, text: !showStatDetails() ? 'Show more' : 'Show less', attr: {title: !showStatDetails() ? 'Click to show base stats' : 'Click to hide base stats'}"></a></h3>

            <div class="col-md-12" data-bind="visible: showStatDetails(), css: {'col-md-12': $root.layout() == 0, 'col-md-3': $root.layout() == 1}, component: {name: 'stats-additional', params: $data}"></div>

            <div class="statscontainer" data-bind="foreach: $root.allItems">
                <div data-bind="component: { name: $data.value, params: $root.heroes[$parentContext.$index()].clone()}"></div>
            </div>
        </div>

        <div class="row" data-bind="visible: showDamageDetails()">
            <div class="col-md-12">
                <h3 style="display:block;" class="section_header" data-bind="toggle: showDamageDetails, css: { section_disabled: !showDamageDetails() }">Damage Details
                    <span class="pull-right">
                        <small style="text-align:center" data-bind="style: {color: getDamageTypeColor('physical')}">Physical</small>
                        <small style="text-align:center" data-bind="style: {color: getDamageTypeColor('magic')}">Magical</small>
                        <small style="text-align:center" data-bind="style: {color: getDamageTypeColor('pure')}">Pure</small>
                    </span>
                </h3>
                <table class="table">
                    <tbody>
                        <tr>
                            <td></td>
                            <td class="text-right"><strong>Unmitigated</strong></td>
                            <td class="text-right"><strong><abbr data-bind="attr: {title: 'After reductions from ' + enemy().hero().displayname()}">After Reductions</abbr></strong></td>
                        </tr>
                        <tr>
                            <td><abbr title="Sum of damage sources">Damage Per Attack:</abbr></td>
                            <td class="text-right">
                                <span data-bind="html: damageTotalInfo().total.toFixed(2)"></span>
                                <span data-bind="html: $root.getDiffTextWrapper($data, 'total'), diffStyle: $root.getDiffMagnitude($data, 'total'), visible: showDiff"></span>
                            </td>
                            <td class="text-right">
                                <span data-bind="html: damageTotalInfo().totalReduced.toFixed(2)"></span>
                                <span data-bind="html: $root.getDiffTextWrapper($data, 'totalReduced'), diffStyle: $root.getDiffMagnitude($data, 'totalReduced'), visible: showDiff"></span>
                            </td>
                        </tr>
                        <tr data-bind="visible: damageTotalInfo().geminateAttack.active">
                            <td class="indent"><abbr title="Sum of damage sources + geminate attack damage">with Geminate Attack:</abbr></td>
                            <td class="text-right">
                                <span data-bind="html: damageTotalInfo().totalGeminateAttack.toFixed(2)"></span>
                                <span data-bind="html: $root.getDiffTextWrapper($data, 'totalGeminateAttack'), diffStyle: $root.getDiffMagnitude($data, 'totalGeminateAttack'), visible: showDiff"></span>
                            </td>
                            <td class="text-right">
                                <span data-bind="html: damageTotalInfo().totalGeminateAttackReduced.toFixed(2)"></span>
                                <span data-bind="html: $root.getDiffTextWrapper($data, 'totalGeminateAttackReduced'), diffStyle: $root.getDiffMagnitude($data, 'totalGeminateAttackReduced'), visible: showDiff"></span>
                            </td>
                        </tr>
                        <tr data-bind="visible: damageTotalInfo().sourcesCrit.length > 0">
                            <td class="indent"><abbr title="Sum of damage sources + average crit damage per attack">with Crit:</abbr></td>
                            <td class="text-right"><span data-bind="html: damageTotalInfo().sumTotal.toFixed(2)"></span></td>
                            <td class="text-right"><span data-bind="html: damageTotalInfo().sumTotalReduced.toFixed(2)"></span></td>
                        </tr>
                        <tr>
                            <td><abbr title="Damage per attack * attacks per second">DPS:</abbr></td>
                            <td class="text-right">
                                <span data-bind="html: damageTotalInfo().dps.base.toFixed(2)"></span>
                                <span data-bind="html: $root.getDiffTextWrapper($data, 'dps.base'), diffStyle: $root.getDiffMagnitude($data, 'dps.base'), visible: showDiff"></span>
                            </td>
                            <td class="text-right">
                                <span data-bind="html: damageTotalInfo().dps.reduced.base.toFixed(2)"></span>
                                <span data-bind="html: $root.getDiffTextWrapper($data, 'dps.reduced.base'), diffStyle: $root.getDiffMagnitude($data, 'dps.reduced.base'), visible: showDiff"></span>
                            </td>
                        </tr>
                        <tr data-bind="visible: damageTotalInfo().geminateAttack.active">
                            <td class="indent"><abbr title="(Damage per attack * attacks per second) + average geminate attack dps">with Geminate Attack:</abbr></td>
                            <td class="text-right">
                                <span data-bind="html: damageTotalInfo().dps.geminateAttack.toFixed(2)"></span>
                                <span data-bind="html: $root.getDiffTextWrapper($data, 'dps.geminateAttack'), diffStyle: $root.getDiffMagnitude($data, 'dps.geminateAttack'), visible: showDiff"></span>
                            </td>
                            <td class="text-right">
                                <span data-bind="html: damageTotalInfo().dps.reduced.geminateAttack.toFixed(2)"></span>
                                <span data-bind="html: $root.getDiffTextWrapper($data, 'dps.reduced.geminateAttack'), diffStyle: $root.getDiffMagnitude($data, 'dps.reduced.geminateAttack'), visible: showDiff"></span>
                            </td>
                        </tr>
                        <tr data-bind="visible: damageTotalInfo().sourcesCrit.length > 0">
                            <td class="indent"><abbr data-bind="attr: { title: damageTotalInfo().geminateAttack.active ? 'Damage per attack (including crit) * attacks per second + average geminate attack dps' : 'Damage per attack (including crit) * attacks per second' }, text: damageTotalInfo().geminateAttack.active ? 'with Crit and Geminate Attack' : 'with Crit:' "></abbr></td>
                            <td class="text-right"><span data-bind="html: damageTotalInfo().dps.total.toFixed(2)"></span></td>
                            <td class="text-right"><span data-bind="html: damageTotalInfo().dps.reduced.total.toFixed(2)"></span></td>
                        </tr>
                        <tr><td colspan=3><strong><abbr title="with %chance taken into account">Damage Sources</abbr></strong></td></tr>
                        <tr>
                            <td>Base Damage</td>
                            <td class="text-right">
                                <span data-bind="html: ((baseDamage()[0] + baseDamage()[1])/2).toFixed(2)"></span>
                                <span data-bind="html: $root.getDiffText(((baseDamage()[0] + baseDamage()[1])/2).toFixed(2) - ((heroCompare().baseDamage()[0] + heroCompare().baseDamage()[1])/2).toFixed(2)), diffStyle: (((baseDamage()[0] + baseDamage()[1])/2).toFixed(2) - ((heroCompare().baseDamage()[0] + heroCompare().baseDamage()[1])/2).toFixed(2)), visible: showDiff"></span>
                            </td>
                            <td class="text-right">
                                <span data-bind="html: getReducedDamage((baseDamage()[0] + baseDamage()[1])/2, 'physical').toFixed(2)"></span>
                                <span data-bind="html: $root.getDiffText(getReducedDamage((baseDamage()[0] + baseDamage()[1])/2, 'physical').toFixed(2) - getReducedDamage((heroCompare().baseDamage()[0] + heroCompare().baseDamage()[1])/2, 'physical').toFixed(2)), diffStyle: (getReducedDamage((baseDamage()[0] + baseDamage()[1])/2, 'physical').toFixed(2) - getReducedDamage((heroCompare().baseDamage()[0] + heroCompare().baseDamage()[1])/2, 'physical').toFixed(2)), visible: showDiff"></span>
                            </td>
                        </tr>
                    </tbody>
                    <tbody data-bind="foreach: damageTotalInfo().sources">
                        <tr>
                            <td><span data-bind="text: $data.name"></span></td>
                            <td class="text-right"><span data-bind="html: $data.damage.toFixed(2), style: {color: $parent.getDamageTypeColor($data.damageType)}"></span></td>
                            <td class="text-right"><span data-bind="html: $data.damageReduced.toFixed(2), style: {color: $parent.getDamageTypeColor($data.damageType)}"></span></td>
                        </tr>
                    </tbody>

                    <tr data-bind="visible: damageTotalInfo().sourcesCrit.length > 0">
                        <td colspan=2><strong>Critical Strike</strong></td>
                    </tr>
                    
                    <tbody data-bind="foreach: damageTotalInfo().sourcesCrit">
                        <tr>
                            <td><span data-bind="text: $data.name"></span></td>
                            <td class="text-right"><span data-bind="html: $data.damage.toFixed(2), style: {color: $parent.getDamageTypeColor($data.damageType)}"></span></td>
                            <td class="text-right"><span data-bind="html: $data.damageReduced.toFixed(2), style: {color: $parent.getDamageTypeColor($data.damageType)}"></span></td>
                        </tr>
                    </tbody>
                
                    <tbody>
                        <tr data-bind="visible: cleaveInfo().length > 0">
                            <td colspan=3><strong>Cleave</strong></td>
                        </tr>
                    </tbody>    
                    <tbody data-bind="foreach: cleaveInfo()">
                        <tr><td>Radius:</td><td class="text-right"><span data-bind="html: $data.radius"></span></td></tr>
                        <tr><td>Magnitude:</td><td class="text-right"><span data-bind="html: ($data.magnitude * 100).toFixed(2) + '%'"></span></td></tr>
                        <tr>
                            <td>Cleave Damage:</td>
                            <td class="text-right"><span data-bind="html: ($data.magnitude * $parent.damageTotalInfo().total).toFixed(2)"></span></td>
                        </tr>
                    </tbody>
                
                </table>
            </div>
        </div>
    </div>
    <div class="col-md-8" data-bind="css: {'col-md-8': $root.layout() == 0, 'col-md-12': $root.layout() == 1}">
        <div class="row">
            <div class="col-md-12">
                <h3 class="section_header" data-bind="toggle: sectionDisplay().inventory, css: { section_disabled: !sectionDisplay().inventory() }">Inventory <small style="color:goldenrod" data-bind="html: inventory.totalCost() ? '<img src=\'http://cdn.dota2.com/apps/dota2/images/tooltips/gold.png\'/> ' + inventory.totalCost() : '' "></small></h3>
                <div id="inventory" class="inventory hover-cursor" data-bind="click: function (data, event) { buildExplorer.selectInventory(-1); }, css: {'row-highlight': selectedInventory() == -1}, template: { name: 'item-template', foreach: inventory.items }, visible: sectionDisplay().inventory()"></div>
            </div>
        </div>

        <div class="row" data-bind="component: { name: 'damage-amp', params: $data}"></div>
    </div>
</div>