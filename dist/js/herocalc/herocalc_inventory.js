define(["require","exports","module","herocalc_knockout","./herocalc_core"],function(e,t,a){"use strict";var i=e("herocalc_knockout"),s=e("./herocalc_core").HEROCALCULATOR;s.prototype.stackableItems=["clarity","flask","dust","ward_observer","ward_sentry","tango","tpscroll","smoke_of_deceit"],s.prototype.levelitems=["necronomicon","dagon","diffusal_blade","travel_boots"],s.prototype.validItems=["abyssal_blade","ultimate_scepter","courier","arcane_boots","armlet","assault","boots_of_elves","bfury","belt_of_strength","black_king_bar","blade_mail","blade_of_alacrity","blades_of_attack","blink","bloodstone","boots","travel_boots","bottle","bracer","broadsword","buckler","butterfly","chainmail","circlet","clarity","claymore","cloak","lesser_crit","greater_crit","dagon","demon_edge","desolator","diffusal_blade","rapier","ancient_janggo","dust","eagle","energy_booster","ethereal_blade","cyclone","skadi","flying_courier","force_staff","gauntlets","gem","ghost","gloves","hand_of_midas","headdress","flask","heart","heavens_halberd","helm_of_iron_will","helm_of_the_dominator","hood_of_defiance","hyperstone","branches","javelin","sphere","maelstrom","magic_stick","magic_wand","manta","mantle","mask_of_madness","medallion_of_courage","mekansm","mithril_hammer","mjollnir","monkey_king_bar","lifesteal","mystic_staff","necronomicon","null_talisman","oblivion_staff","ward_observer","ogre_axe","orb_of_venom","orchid","pers","phase_boots","pipe","platemail","point_booster","poor_mans_shield","power_treads","quarterstaff","quelling_blade","radiance","reaver","refresher","ring_of_aquila","ring_of_basilius","ring_of_health","ring_of_protection","ring_of_regen","robe","rod_of_atos","relic","sobi_mask","sange","sange_and_yasha","satanic","sheepstick","ward_sentry","shadow_amulet","invis_sword","shivas_guard","basher","slippers","smoke_of_deceit","soul_booster","soul_ring","staff_of_wizardry","stout_shield","talisman_of_evasion","tango","tpscroll","tranquil_boots","ultimate_orb","urn_of_shadows","vanguard","veil_of_discord","vitality_booster","vladmir","void_stone","wraith_band","yasha","crimson_guard","enchanted_mango","lotus_orb","glimmer_cape","guardian_greaves","moon_shard","silver_edge","solar_crest","octarine_core","aether_lens","faerie_fire","iron_talon","dragon_lance","echo_sabre","infused_raindrop","blight_stone","wind_lace","tome_of_knowledge","bloodthorn","hurricane_pike"],s.prototype.itemsWithActive=["heart","smoke_of_deceit","dust","ghost","tranquil_boots","phase_boots","power_treads","buckler","medallion_of_courage","ancient_janggo","mekansm","pipe","veil_of_discord","rod_of_atos","orchid","sheepstick","armlet","invis_sword","ethereal_blade","shivas_guard","manta","mask_of_madness","diffusal_blade","mjollnir","satanic","ring_of_basilius","ring_of_aquila","butterfly","moon_shard","silver_edge","bloodthorn","hurricane_pike"],s.prototype.ItemInput=function(e,t,a){if(s.prototype.itemData["item_"+e].ItemAliases instanceof Array)var r=s.prototype.itemData["item_"+e].ItemAliases.join(" ");else var r=s.prototype.itemData["item_"+e].ItemAliases;this.value=i.observable(e),this.debuff=i.observable(a),this.debuff()?(this.value=i.observable(e+"|"+a.id),this.name=i.observable(t+" ("+a.name+")"),this.displayname=i.observable(t+" ("+a.name+') <span style="display:none">;'+r+"</span>")):(this.value=i.observable(e),this.name=i.observable(t),this.displayname=i.observable(t+' <span style="display:none">;'+r+"</span>"))},s.prototype.BasicInventoryViewModel=function(e){var t=this;t.items=i.observableArray([]),t.activeItems=i.observableArray([]),t.addItem=function(e,a){if(void 0!=e.selectedItem()){var s={item:e.selectedItem().split("|")[0],state:i.observable(0),size:e.itemInputValue(),enabled:i.observable(!0)};switch(s.item){case"dagon":s.size=Math.min(s.size,5);break;case"travel_boots":case"diffusal_blade":s.size=Math.min(s.size,2);break;case"necronomicon":s.size=Math.min(s.size,3)}t.items.push(s),("ring_of_aquila"===e.selectedItem()||"ring_of_basilius"===e.selectedItem()||"heart"===e.selectedItem())&&t.toggleItem(void 0,s,void 0)}},t.toggleItem=function(e,a,i){if(s.prototype.itemsWithActive.indexOf(a.item)>=0)switch(t.activeItems.indexOf(a)<0?t.activeItems.push(a):t.activeItems.remove(a),a.item){case"power_treads":a.state()<2?a.state(a.state()+1):a.state(0);break;default:0==a.state()?a.state(1):a.state(0)}}.bind(this),t.removeItem=function(e){t.activeItems.remove(e),t.items.remove(e)}.bind(this),t.toggleMuteItem=function(e){e.enabled(!e.enabled())}.bind(this),t.getItemImage=function(e){var t=i.utils.unwrapObservable(e.state);switch(e.item){case"power_treads":return 0==t?"/media/images/items/"+e.item+"_str.png":1==t?"/media/images/items/"+e.item+"_int.png":"/media/images/items/"+e.item+"_agi.png";case"tranquil_boots":case"ring_of_basilius":return 0==t?"/media/images/items/"+e.item+".png":"/media/images/items/"+e.item+"_active.png";case"armlet":return 0==t?"/media/images/items/"+e.item+".png":"/media/images/items/"+e.item+"_active.png";case"ring_of_aquila":return 0==t?"/media/images/items/"+e.item+"_active.png":"/media/images/items/"+e.item+".png";case"dagon":case"diffusal_blade":case"travel_boots":case"necronomicon":return e.size>1?"/media/images/items/"+e.item+"_"+e.size+".png":"/media/images/items/"+e.item+".png";default:return"/media/images/items/"+e.item+".png"}},t.getItemSizeLabel=function(e){return-1!=s.prototype.stackableItems.indexOf(e.item)?'<span style="font-size:10px">Qty: </span>'+e.size:-1!=s.prototype.levelitems.indexOf(e.item)?'<span style="font-size:10px">Lvl: </span>'+e.size:"bloodstone"==e.item?'<span style="font-size:10px">Charges: </span>'+e.size:""},t.getActiveBorder=function(e){switch(e.item){case"power_treads":case"tranquil_boots":case"ring_of_basilius":case"ring_of_aquila":case"armlet":return 0;default:return i.utils.unwrapObservable(e.state)}},t.removeAll=function(){t.activeItems.removeAll(),t.items.removeAll()}.bind(this)},s.prototype.InventoryViewModel=function(e){var t=new s.prototype.BasicInventoryViewModel;t.hero=e,t.hasInventory=i.observable(!0),t.items=i.observableArray([]),t.activeItems=i.observableArray([]),t.hasScepter=i.computed(function(){for(var e=0;e<t.items().length;e++){var a=t.items()[e].item;if("ultimate_scepter"===a&&t.items()[e].enabled())return!0}return!1},this),t.isEthereal=i.computed(function(){for(var e=0;e<t.items().length;e++){var a=t.items()[e].item,i=t.activeItems.indexOf(t.items()[e])>=0?!0:!1;if(("ghost"===a||"ethereal_blade"===a)&&t.items()[e].enabled()&&i)return!0}return!1},this),t.isSheeped=i.computed(function(){for(var e=0;e<t.items().length;e++){var a=t.items()[e].item,i=t.activeItems.indexOf(t.items()[e])>=0?!0:!1;if("sheepstick"===a&&t.items()[e].enabled()&&i)return!0}return!1},this),t.totalCost=i.computed(function(){for(var e=0,a=0;a<t.items().length;a++){var i=t.items()[a].item;if(t.items()[a].enabled())if(-1!=s.prototype.stackableItems.indexOf(i))e+=s.prototype.itemData["item_"+i].itemcost*t.items()[a].size;else if(-1!=s.prototype.levelitems.indexOf(i))switch(i){case"diffusal_blade":e+=s.prototype.itemData["item_"+i].itemcost+700*(t.items()[a].size-1);break;case"necronomicon":case"dagon":e+=s.prototype.itemData["item_"+i].itemcost+1250*(t.items()[a].size-1);break;default:e+=s.prototype.itemData["item_"+i].itemcost}else e+=s.prototype.itemData["item_"+i].itemcost}return e},this),t.addItemBuff=function(e,a){if(t.hasInventory()&&void 0!=t.selectedItemBuff()){var s={item:t.selectedItemBuff(),state:i.observable(0),size:1,enabled:i.observable(!0)};t.items.push(s),("ring_of_aquila"===t.selectedItemBuff()||"ring_of_basilius"===t.selectedItemBuff())&&t.toggleItem(void 0,s,void 0)}},t.addItemDebuff=function(e,a){if(t.hasInventory()&&void 0!=t.selectedItemDebuff()){var s={item:t.selectedItemDebuff().split("|")[0],state:i.observable(0),size:1,enabled:i.observable(!0)};2==t.selectedItemDebuff().split("|").length&&(s.debuff=t.selectedItemDebuff().split("|")[1]),t.items.push(s),("ring_of_aquila"===t.selectedItemDebuff()||"ring_of_basilius"===t.selectedItemDebuff())&&t.toggleItem(void 0,s,void 0)}},t.getItemAttributeValue=function(e,t,a){for(var i=0;i<e.length;i++)if(e[i].name==t)return 0==a?parseFloat(e[i].value[0]):a>e[i].value.length?parseFloat(e[i].value[0]):parseFloat(e[i].value[a-1])},t.getAttributes=function(e){for(var a=0,i=0;i<t.items().length;i++){var r=t.items()[i].item,n=t.activeItems.indexOf(t.items()[i])>=0?!0:!1;if(t.items()[i].enabled())for(var m=t.items()[i].size,o=0;o<s.prototype.itemData["item_"+r].attributes.length;o++){var u=s.prototype.itemData["item_"+r].attributes[o];switch(u.name){case"bonus_all_stats":a+=parseInt(u.value[0]);break;case"bonus_stats":a+=parseInt(u.value[0])}switch(e){case"agi":"bonus_agility"==u.name&&(a+="diffusal_blade"==r?parseInt(u.value[m-1]):parseInt(u.value[0])),"bonus_stat"==u.name&&2==t.items()[i].state()&&(a+=parseInt(u.value[0])),"bonus_agi"==u.name&&(a+=parseInt(u.value[0]));break;case"int":"bonus_intellect"==u.name&&(a+="necronomicon"==r?parseInt(u.value[m-1]):"diffusal_blade"==r?parseInt(u.value[m-1]):"dagon"==r?parseInt(u.value[m-1]):parseInt(u.value[0])),"bonus_intelligence"==u.name&&(a+=parseInt(u.value[0])),"bonus_int"==u.name&&(a+=parseInt(u.value[0])),"bonus_stat"==u.name&&1==t.items()[i].state()&&(a+=parseInt(u.value[0]));break;case"str":"bonus_strength"==u.name&&(a+="necronomicon"==r?parseInt(u.value[m-1]):parseInt(u.value[0])),"bonus_stat"==u.name&&0==t.items()[i].state()&&(a+=parseInt(u.value[0])),"bonus_str"==u.name&&(a+=parseInt(u.value[0])),"unholy_bonus_strength"==u.name&&n&&(a+=parseInt(u.value[0]))}}}return a},t.getBash=function(e){for(var a=1,i=0;i<t.items().length;i++){var r=t.items()[i].item;if(t.items()[i].enabled())for(var n=0;n<s.prototype.itemData["item_"+r].attributes.length;n++){var m=s.prototype.itemData["item_"+r].attributes[n];switch(m.name){case"bash_chance":a*=1-parseInt(m.value[0])/100;break;case"bash_chance_melee":"DOTA_UNIT_CAP_MELEE_ATTACK"==e&&(a*=1-parseInt(m.value[0])/100);break;case"bash_chance_ranged":"DOTA_UNIT_CAP_RANGED_ATTACK"==e&&(a*=1-parseInt(m.value[0])/100)}}}return a},t.getCritChance=function(){for(var e=1,a=0;a<t.items().length;a++){var i=t.items()[a].item;t.activeItems.indexOf(t.items()[a])>=0?!0:!1;if(t.items()[a].enabled())for(var r=0;r<s.prototype.itemData["item_"+i].attributes.length;r++){var n=s.prototype.itemData["item_"+i].attributes[r];switch(n.name){case"crit_chance":e*=1-parseInt(n.value[0])/100}}}return e},t.getCritSource=function(){for(var e={},a=0;a<t.items().length;a++){var i=t.items()[a].item,r=t.activeItems.indexOf(t.items()[a])>=0?!0:!1;if(t.items()[a].enabled()){switch(i){case"lesser_crit":case"greater_crit":case"bloodthorn":void 0==e[i]?e[i]={chance:t.getItemAttributeValue(s.prototype.itemData["item_"+i].attributes,"crit_chance",0)/100,multiplier:t.getItemAttributeValue(s.prototype.itemData["item_"+i].attributes,"crit_multiplier",0)/100,count:1,displayname:s.prototype.itemData["item_"+i].displayname}:e[i].count+=1}"bloodthorn"===i&&r&&(void 0==e.soul_rend?e.soul_rend={chance:1,multiplier:t.getItemAttributeValue(s.prototype.itemData["item_"+i].attributes,"target_crit_multiplier",0)/100,count:1,displayname:"Soul Rend"}:e.soul_rend.count+=1)}}return e},t.getCleaveSource=function(){for(var e={},a=0;a<t.items().length;a++){var i=t.items()[a].item;t.activeItems.indexOf(t.items()[a])>=0?!0:!1;if(t.items()[a].enabled())switch(i){case"bfury":void 0==e[i]?e[i]={radius:t.getItemAttributeValue(s.prototype.itemData["item_"+i].attributes,"cleave_radius",0),magnitude:t.getItemAttributeValue(s.prototype.itemData["item_"+i].attributes,"cleave_damage_percent",0)/100,count:1,displayname:s.prototype.itemData["item_"+i].displayname}:e[i].count+=1}}return e},t.getBashSource=function(e){for(var a={},i=0;i<t.items().length;i++){var r=t.items()[i].item;t.activeItems.indexOf(t.items()[i])>=0?!0:!1;if(t.items()[i].enabled())switch(r){case"javelin":void 0==a[r]?a[r]={damage:t.getItemAttributeValue(s.prototype.itemData["item_"+r].attributes,"bonus_chance_damage",1),damageType:"magic",count:1,chance:t.getItemAttributeValue(s.prototype.itemData["item_"+r].attributes,"bonus_chance",1)/100,displayname:s.prototype.itemData["item_"+r].displayname+" Pierce"}:a[r].count+=1;break;case"monkey_king_bar":void 0==a[r]?a[r]={item:r,chance:t.getItemAttributeValue(s.prototype.itemData["item_"+r].attributes,"bash_chance",0)/100,damage:t.getItemAttributeValue(s.prototype.itemData["item_"+r].attributes,"bash_damage",0),duration:t.getItemAttributeValue(s.prototype.itemData["item_"+r].attributes,"bash_stun",0),count:1,damageType:"magic",displayname:"Mini-Bash"}:a[r].count+=1;break;case"abyssal_blade":case"basher":a.hasOwnProperty("bash")||(a.bash={item:r,chance:t.getItemAttributeValue(s.prototype.itemData["item_"+r].attributes,"DOTA_UNIT_CAP_MELEE_ATTACK"==e?"bash_chance_melee":"bash_chance_ranged",0)/100,damage:t.getItemAttributeValue(s.prototype.itemData["item_"+r].attributes,"bonus_chance_damage",0),duration:t.getItemAttributeValue(s.prototype.itemData["item_"+r].attributes,"bash_duration",0),count:1,damageType:"physical",displayname:"Bash"})}}return a},t.getOrbProcSource=function(){for(var e={},a=0;a<t.items().length;a++){var i=t.items()[a].item;t.activeItems.indexOf(t.items()[a])>=0?!0:!1;if(t.items()[a].enabled())switch(i){case"maelstrom":case"mjollnir":void 0==e[i]?e[i]={chance:t.getItemAttributeValue(s.prototype.itemData["item_"+i].attributes,"chain_chance",0)/100,damage:t.getItemAttributeValue(s.prototype.itemData["item_"+i].attributes,"chain_damage",0),count:1,damageType:"magic",displayname:s.prototype.itemData["item_"+i].displayname}:e[i].count+=1}}return e},t.getOrbSource=function(){for(var e={},a=0;a<t.items().length;a++){var i=t.items()[a].item;t.activeItems.indexOf(t.items()[a])>=0?!0:!1;if(t.items()[a].enabled())switch(i){case"diffusal_blade":void 0==e[i]?e[i]={chance:1,damage:t.getItemAttributeValue(s.prototype.itemData["item_"+i].attributes,"feedback_mana_burn",t.items()[a].size),count:1,damageType:"physical",displayname:s.prototype.itemData["item_"+i].displayname}:e[i].count+=1}}return e},t.getHealth=function(){for(var e=0,a=0;a<t.items().length;a++){var i=t.items()[a].item;if(t.items()[a].enabled())for(var r=0;r<s.prototype.itemData["item_"+i].attributes.length;r++){var n=s.prototype.itemData["item_"+i].attributes[r];switch(n.name){case"bonus_health":e+=parseInt(n.value[0])}}}return e},t.getHealthRegen=function(){for(var e=0,a=0;a<t.items().length;a++){var i=t.items()[a].item,r=t.activeItems.indexOf(t.items()[a])>=0?!0:!1;if(t.items()[a].enabled())for(var n=0;n<s.prototype.itemData["item_"+i].attributes.length;n++){var m=s.prototype.itemData["item_"+i].attributes[n];switch(m.name){case"health_regen":case"bonus_regen":e+=parseInt(m.value[0]);break;case"bonus_health_regen":"tranquil_boots"!=i||r?"tranquil_boots"!=i&&(e+=parseInt(m.value[0])):e+=parseInt(m.value[0]);break;case"hp_regen":e+=parseInt(m.value[0]);break;case"health_regen_rate":"heart"==i&&r&&(e+=parseInt(m.value[0])/100*t.hero.health())}}}return e},t.getHealthRegenAura=function(e){for(var a=0,i=e||[],r=0;r<t.items().length;r++){var n=t.items()[r].item;t.activeItems.indexOf(t.items()[r])>=0?!0:!1;if(t.items()[r].enabled())for(var m=0;m<s.prototype.itemData["item_"+n].attributes.length;m++){var o=s.prototype.itemData["item_"+n].attributes[m];if(!(i.indexOf(n+o.name)>-1))switch(o.name){case"aura_health_regen":a+=parseInt(o.value[0]),i.push(n+o.name)}}}return{value:a,excludeList:i}},t.getMana=function(){for(var e=0,a=0;a<t.items().length;a++){var i=t.items()[a].item;if(t.items()[a].enabled())for(var r=0;r<s.prototype.itemData["item_"+i].attributes.length;r++){var n=s.prototype.itemData["item_"+i].attributes[r];switch(n.name){case"bonus_mana":e+=parseInt(n.value[0])}}}return e},t.getManaRegen=function(){for(var e=0,a=0;a<t.items().length;a++){var i=t.items()[a].item;if(t.items()[a].enabled())for(var r=0;r<s.prototype.itemData["item_"+i].attributes.length;r++){var n=s.prototype.itemData["item_"+i].attributes[r];switch(n.name){case"aura_mana_regen":case"mana_regen_aura":e+=parseFloat(n.value[0]);break;case"mana_regen":"infused_raindrop"==i&&(e+=parseFloat(n.value[0]))}}}return e},t.getManaRegenPercent=function(){for(var e=0,a=0;a<t.items().length;a++){var i=t.items()[a].item;if(t.items()[a].enabled())for(var r=0;r<s.prototype.itemData["item_"+i].attributes.length;r++){var n=s.prototype.itemData["item_"+i].attributes[r];switch(n.name){case"bonus_mana_regen":case"mana_regen":case"bonus_mana_regen_pct":"infused_raindrop"!=i&&(e+=parseFloat(n.value[0]))}}}return e/100},t.getManaRegenBloodstone=function(){for(var e=0;e<t.items().length;e++){var a=t.items()[e].item;if(t.items()[e].enabled()&&-1!=a.indexOf("bloodstone"))return parseInt(t.items()[e].size)}return 0},t.getArmor=function(){for(var e=0,a=0;a<t.items().length;a++){var i=t.items()[a].item,r=t.activeItems.indexOf(t.items()[a])>=0?!0:!1;if(t.items()[a].enabled())for(var n=0;n<s.prototype.itemData["item_"+i].attributes.length;n++){var m=s.prototype.itemData["item_"+i].attributes[n];switch(m.name){case"bonus_armor":r&&"medallion_of_courage"==i||(e+=parseInt(m.value[0]));break;case"unholy_bonus_armor":r&&"armlet"==i&&(e+=parseInt(m.value[0]))}}}return e},t.getArmorAura=function(e){for(var a=0,i=e||[],r=0;r<t.items().length;r++){var n=t.items()[r].item,m=t.activeItems.indexOf(t.items()[r])>=0?!0:!1;if(t.items()[r].enabled())for(var o=0;o<s.prototype.itemData["item_"+n].attributes.length;o++){var u=s.prototype.itemData["item_"+n].attributes[o];if(!i.find(function(e){return u.name==e.name}))switch(u.name){case"bonus_aoe_armor":m&&i.push({name:u.name,value:parseInt(u.value[0])});break;case"aura_positive_armor":i.push({name:u.name,value:parseInt(u.value[0])});break;case"aura_bonus_armor":m&&i.push({name:u.name,value:parseInt(u.value[0])});break;case"armor_aura":i.push({name:u.name,value:parseInt(u.value[0])});break;case"heal_bonus_armor":m&&i.push({name:u.name,value:parseInt(u.value[0])})}}}return i.find(function(e){return"heal_bonus_armor"==e.name})&&(i=i.filter(function(e){return"bonus_aoe_armor"!==e.name})),i.find(function(e){return"armor_aura"==e.name})&&(i=i.filter(function(e){return"aura_bonus_armor"!==e.name})),a=i.reduce(function(e,t){return e+=t.value},0),{value:a,attributes:i}},t.getArmorReduction=function(e){for(var a=0,i=e||[],r=0;r<t.items().length;r++){var n=t.items()[r].item;t.activeItems.indexOf(t.items()[r])>=0?!0:!1;if(t.items()[r].enabled())for(var m=0;m<s.prototype.itemData["item_"+n].attributes.length;m++){var o=s.prototype.itemData["item_"+n].attributes[m];if(!(i.indexOf(o.name)>-1||i.indexOf(n+"_"+o.name)>-1))switch(o.name){case"armor_reduction":a+=parseInt(o.value[0]),i.push(n+"_"+o.name);break;case"aura_negative_armor":a+=parseInt(o.value[0]),i.push(o.name);break;case"corruption_armor":a+=parseInt(o.value[0]),i.push(o.name)}}}return{value:a,excludeList:i}},t.getEvasion=function(){for(var e=1,a=0;a<t.items().length;a++){var i=t.items()[a].item,r=t.activeItems.indexOf(t.items()[a])>=0?!0:!1;if(t.items()[a].enabled())for(var n=0;n<s.prototype.itemData["item_"+i].attributes.length;n++){var m=s.prototype.itemData["item_"+i].attributes[n];switch(m.name){case"bonus_evasion":"butterfly"==i&&r||(e*=1-parseInt(m.value[0])/100)}}}return e},t.getMovementSpeedFlat=function(){for(var e=0,a=!1,i=!1,r=!1,n=["boots","phase_boots","arcane_boots","travel_boots","power_treads","tranquil_boots","guardian_greaves"],m=0;m<t.items().length;m++){var o=t.items()[m].item,u=t.activeItems.indexOf(t.items()[m])>=0?!0:!1;if(t.items()[m].enabled())for(var l=0;l<s.prototype.itemData["item_"+o].attributes.length;l++){var c=s.prototype.itemData["item_"+o].attributes[l];switch(c.name){case"bonus_movement_speed":!a&&n.indexOf(o)>=0?("tranquil_boots"!=o||"tranquil_boots"==o&&!u)&&(e+=parseInt(c.value[0]),a=!0):"cyclone"==o&&(e+=parseInt(c.value[0]),i=!0);break;case"broken_movement_speed":!a&&n.indexOf(o)>=0&&"tranquil_boots"==o&&u&&(e+=parseInt(c.value[0]),a=!0);break;case"bonus_movement":!a&&n.indexOf(o)>=0&&(e+=parseInt(c.value[0]),a=!0);break;case"movement_speed":r||"wind_lace"!=o||(e+=parseInt(c.value[0]),r=!0)}}}return e},t.getMovementSpeedPercent=function(e){for(var a=0,i=e||[],r=!1,n=!1,m=!1,o=!1,u=!1,l=!1,c=!1,p=["manta","yasha","sange_and_yasha"],_=0;_<t.items().length;_++){var d=t.items()[_].item,v=t.activeItems.indexOf(t.items()[_])>=0?!0:!1;if(t.items()[_].enabled())for(var b=0;b<s.prototype.itemData["item_"+d].attributes.length;b++){var f=s.prototype.itemData["item_"+d].attributes[b];if(!(i.indexOf(f.name)>-1))switch(f.name){case"movement_speed_percent_bonus":!r&&p.indexOf(d)>=0&&(a+=parseInt(f.value[0]),r=!0);break;case"bonus_aura_movement_speed_pct":n||"ancient_janggo"!=d||(a+=parseInt(f.value[0]),n=!0,i.push(f.name));break;case"phase_movement_speed":v&&!o&&(a+=parseInt(f.value[0]),o=!0);break;case"bonus_movement_speed_pct":v&&!m&&"ancient_janggo"==d&&(a+=parseInt(f.value[0]),m=!0,i.push(f.name));break;case"windwalk_movement_speed":!v||u||"invis_sword"!=d&&"silver_edge"!=d||(a+=parseInt(f.value[0]),u=!0);break;case"berserk_bonus_movement_speed":v&&!c&&"mask_of_madness"==d&&(a+=parseInt(f.value[0]),c=!0);break;case"bonus_movement_speed":r||"manta"!=d?"smoke_of_deceit"==d&&v&&(a+=parseInt(f.value[0])):(a+=parseInt(f.value[0]),r=!0);break;case"bonus_move_speed":v&&!l&&"butterfly"==d&&(a+=parseInt(f.value[0]),l=!0)}}}return{value:a/100,excludeList:i}},t.getMovementSpeedPercentReduction=function(e){for(var a=0,i=e||[],r=0;r<t.items().length;r++){var n=t.items()[r].item,m=t.activeItems.indexOf(t.items()[r])>=0?!0:!1;if(t.items()[r].enabled())for(var o=0;o<s.prototype.itemData["item_"+n].attributes.length;o++){var u=s.prototype.itemData["item_"+n].attributes[o];if(!(i.indexOf(u.name)>-1))switch(u.name){case"movespeed":"dust"==n&&m&&(a+=parseInt(u.value[0]));case"blast_movement_speed":"shivas_guard"==n&&m&&(a+=parseInt(u.value[0]),i.push(u.name));case"cold_movement_speed":"skadi"==n&&(a+=parseInt(u.value[0]));break;case"maim_movement_speed":t.items()[r].debuff&&"maim"==t.items()[r].debuff&&(a+=parseInt(u.value[0]),i.push(u.name))}}}return{value:a/100,excludeList:i}},t.getBonusDamage=function(){for(var e=0,a={},i=0;i<t.items().length;i++){var r=t.items()[i].item,n=t.activeItems.indexOf(t.items()[i])>=0?!0:!1;if(t.items()[i].enabled())for(var m=0;m<s.prototype.itemData["item_"+r].attributes.length;m++){var o=s.prototype.itemData["item_"+r].attributes[m];switch(o.name){case"bonus_damage":e+=parseInt(o.value[0]),void 0==a[r]?a[r]={damage:parseInt(o.value[0]),damageType:"physical",count:1,displayname:s.prototype.itemData["item_"+r].displayname}:a[r].count+=1;break;case"unholy_bonus_damage":n&&(e+=parseInt(o.value[0]),void 0==a[r+"_active"]?a[r+"_active"]={damage:parseInt(o.value[0]),damageType:"physical",count:1,displayname:s.prototype.itemData["item_"+r].displayname+" Unholy Strength"}:a[r].count+=1)}}}return{sources:a,total:e}},t.getBonusDamagePercent=function(e){e=e||{sources:{},total:0};for(var a=e.total||0,i=e.sources||{},r=0;r<t.items().length;r++){var n=t.items()[r].item;t.activeItems.indexOf(t.items()[r])>=0?!0:!1;if(t.items()[r].enabled())for(var m=0;m<s.prototype.itemData["item_"+n].attributes.length;m++){var o=s.prototype.itemData["item_"+n].attributes[m];switch(o.name){case"damage_aura":void 0==i[n]&&(a+=parseInt(o.value[0])/100,i[n]={damage:parseInt(o.value[0])/100,damageType:"physical",count:1,displayname:s.prototype.itemData["item_"+n].displayname})}}}return{sources:i,total:a}},t.getAttackSpeed=function(e){for(var a=0,i=!1,r=e||[],n=0;n<t.items().length;n++){var m=t.items()[n].item,o=t.activeItems.indexOf(t.items()[n])>=0?!0:!1;if(t.items()[n].enabled())for(var u=0;u<s.prototype.itemData["item_"+m].attributes.length;u++){var l=s.prototype.itemData["item_"+m].attributes[u];if(!(r.indexOf(l.name)>-1))switch(l.name){case"bonus_attack_speed":"power_treads"==m?i||(a+=parseInt(l.value[0]),i=!0):"moon_shard"==m?o||(a+=parseInt(l.value[0])):"hurricane_pike"==m?o&&(a+=parseInt(l.value[0])):a+=parseInt(l.value[0]);break;case"consumed_bonus":"moon_shard"==m&&o&&(a+=parseInt(l.value[0]));break;case"bonus_speed":a+=parseInt(l.value[0]);break;case"aura_attack_speed":"shivas_guard"!=m&&(a+=parseInt(l.value[0]));break;case"bonus_aura_attack_speed_pct":a+=parseInt(l.value[0]),r.push(l.name);break;case"bonus_attack_speed_pct":o&&(a+=parseInt(l.value[0]),r.push(l.name));break;case"unholy_bonus_attack_speed":o&&(a+=parseInt(l.value[0]));break;case"berserk_bonus_attack_speed":o&&(a+=parseInt(l.value[0]))}}}return{value:a,excludeList:r}},t.getAttackSpeedReduction=function(e){for(var a=0,i=e||[],r=0;r<t.items().length;r++){var n=t.items()[r].item;t.activeItems.indexOf(t.items()[r])>=0?!0:!1;if(t.items()[r].enabled())for(var m=0;m<s.prototype.itemData["item_"+n].attributes.length;m++){var o=s.prototype.itemData["item_"+n].attributes[m];if(!(i.indexOf(o.name)>-1))switch(o.name){case"aura_attack_speed":"shivas_guard"==n&&(a+=parseInt(o.value[0]),i.push(o.name));break;case"cold_attack_speed":"skadi"==n&&(a+=parseInt(o.value[0]),i.push(o.name));break;case"maim_attack_speed":t.items()[r].debuff&&"maim"==t.items()[r].debuff&&(a+=parseInt(o.value[0]),i.push(o.name))}}}return{value:a,excludeList:i}},t.getLifesteal=function(){for(var e=0,a=0;a<t.items().length;a++){var i=t.items()[a].item,r=t.activeItems.indexOf(t.items()[a])>=0?!0:!1;if(t.items()[a].enabled())for(var n=0;n<s.prototype.itemData["item_"+i].attributes.length;n++){var m=s.prototype.itemData["item_"+i].attributes[n];switch(m.name){case"lifesteal_percent":if("satanic"!=i)return parseInt(m.value[0]);if(!r)return parseInt(m.value[0]);break;case"unholy_lifesteal_percent":if(r)return parseInt(m.value[0])}}}return e},t.getLifestealAura=function(e){for(var a=0,i=e||[],r=0;r<t.items().length;r++){var n=t.items()[r].item;t.activeItems.indexOf(t.items()[r])>=0?!0:!1;if(t.items()[r].enabled())for(var m=0;m<s.prototype.itemData["item_"+n].attributes.length;m++){var o=s.prototype.itemData["item_"+n].attributes[m];if(!(i.indexOf(o.name)>-1))switch(o.name){case"vampiric_aura":a+=parseInt(o.value[0]),i.push(o.name)}}}return{value:a,excludeList:i}},t.getMagicResist=function(){for(var e=1,a=0;a<t.items().length;a++){var i=t.items()[a].item;t.activeItems.indexOf(t.items()[a])>=0?!0:!1;if(t.items()[a].enabled())for(var r=0;r<s.prototype.itemData["item_"+i].attributes.length;r++){var n=s.prototype.itemData["item_"+i].attributes[r];switch(n.name){case"bonus_magical_armor":e*=1-parseInt(n.value[0])/100;break;case"bonus_spell_resist":e*=1-parseInt(n.value[0])/100;break;case"magic_resistance":e*=1-parseInt(n.value[0])/100}}}return e},t.getMagicResistReductionSelf=function(){for(var e=1,a=0;a<t.items().length;a++){var i=t.items()[a].item,r=t.activeItems.indexOf(t.items()[a])>=0?!0:!1;if(t.items()[a].enabled()&&r)for(var n=0;n<s.prototype.itemData["item_"+i].attributes.length;n++){var m=s.prototype.itemData["item_"+i].attributes[n];switch(m.name){case"extra_spell_damage_percent":case"ethereal_damage_bonus":return 1-parseInt(m.value[0])/100}}}return e},t.getMagicResistReduction=function(){for(var e=1,a=0;a<t.items().length;a++){var i=t.items()[a].item,r=t.activeItems.indexOf(t.items()[a])>=0?!0:!1;if(t.items()[a].enabled()&&r)for(var n=0;n<s.prototype.itemData["item_"+i].attributes.length;n++){var m=s.prototype.itemData["item_"+i].attributes[n];switch(m.name){case"ethereal_damage_bonus":t.isEthereal()||(e*=1-parseInt(m.value[0])/100);case"resist_debuff":e*=1-parseInt(m.value[0])/100}}}return e},t.getVisionRangeNight=i.computed(function(){for(var e=0,a=0;a<t.items().length;a++){var i=t.items()[a].item,r=t.activeItems.indexOf(t.items()[a])>=0?!0:!1;if(t.items()[a].enabled())for(var n=0;n<s.prototype.itemData["item_"+i].attributes.length;n++){var m=s.prototype.itemData["item_"+i].attributes[n];switch(m.name){case"bonus_night_vision":"moon_shard"==i&&r||(e+=parseInt(m.value[0]))}}}return e}),t.getAttackRange=function(e,a){for(var i=0,r=a||[],n=0;n<t.items().length;n++){var m=t.items()[n].item;t.activeItems.indexOf(t.items()[n])>=0?!0:!1;if(t.items()[n].enabled())for(var o=0;o<s.prototype.itemData["item_"+m].attributes.length;o++){var u=s.prototype.itemData["item_"+m].attributes[o];if(!r.find(function(e){return u.name==e.name}))switch(u.name){case"base_attack_range":"DOTA_UNIT_CAP_RANGED_ATTACK"==e&&r.push({name:u.name,value:parseInt(u.value[0])})}}}return i=r.reduce(function(e,t){return e+=t.value},0),{value:i,attributes:r}},t.getMissChance=function(e){for(var a=1,i=e||[],r=0;r<t.items().length;r++){var n=t.items()[r].item;t.activeItems.indexOf(t.items()[r])>=0?!0:!1;if(t.items()[r].enabled())for(var m=0;m<s.prototype.itemData["item_"+n].attributes.length;m++){var o=s.prototype.itemData["item_"+n].attributes[m];if(!(i.indexOf(o.name)>-1))switch(o.name){case"miss_chance":a*=1-parseInt(o.value[0])/100,i.push(o.name);break;case"blind_pct":a*=1-parseInt(o.value[0])/100,i.push(o.name)}}}return{value:a,excludeList:i}},t.getBaseDamageReductionPct=function(){for(var e=1,a=0;a<t.items().length;a++){var i=t.items()[a].item;t.activeItems.indexOf(t.items()[a])>=0?!0:!1;if(t.items()[a].enabled())for(var r=0;r<s.prototype.itemData["item_"+i].attributes.length;r++){var n=s.prototype.itemData["item_"+i].attributes[r];switch(n.name){case"backstab_reduction":t.items()[a].debuff&&"shadow_walk"==t.items()[a].debuff&&(e*=1+parseInt(n.value[0])/100)}}}return e},t.getBonusDamageReductionPct=function(){for(var e=1,a=0;a<t.items().length;a++){var i=t.items()[a].item;t.activeItems.indexOf(t.items()[a])>=0?!0:!1;if(t.items()[a].enabled())for(var r=0;r<s.prototype.itemData["item_"+i].attributes.length;r++){var n=s.prototype.itemData["item_"+i].attributes[r];switch(n.name){case"backstab_reduction":t.items()[a].debuff&&"shadow_walk"==t.items()[a].debuff&&(e*=1+parseInt(n.value[0])/100)}}}return e},t.itemOptions=i.observableArray([]);for(var a=[],r=0;r<s.prototype.validItems.length;r++)a.push(new s.prototype.ItemInput(s.prototype.validItems[r],s.prototype.itemData["item_"+s.prototype.validItems[r]].displayname));t.itemOptions.push.apply(t.itemOptions,a);var n=["assault","ancient_janggo","headdress","mekansm","pipe","ring_of_aquila","vladmir","ring_of_basilius","buckler","solar_crest"];t.itemBuffOptions=i.observableArray(n.map(function(e){return new s.prototype.ItemInput(e,s.prototype.itemData["item_"+e].displayname)})),t.selectedItemBuff=i.observable("assault");var m=[{item:"assault",debuff:null},{item:"shivas_guard",debuff:null},{item:"desolator",debuff:null},{item:"medallion_of_courage",debuff:null},{item:"radiance",debuff:null},{item:"sheepstick",debuff:null},{item:"veil_of_discord",debuff:null},{item:"solar_crest",debuff:null},{item:"silver_edge",debuff:{id:"shadow_walk",name:"Shadow Walk"}},{item:"silver_edge",debuff:{id:"maim",name:"Lesser Maim"}}];return t.itemDebuffOptions=i.observableArray(m.map(function(e){return new s.prototype.ItemInput(e.item,s.prototype.itemData["item_"+e.item].displayname,e.debuff)})),t.selectedItemDebuff=i.observable("assault"),t}});
//# sourceMappingURL=herocalc_inventory.js.map