define(["require","exports","module","knockout","jquery","knockout-mapping"],function(t,e,i){"use strict";var n=t("knockout"),o=t("jquery");return n.mapping=t("knockout-mapping"),n.bindingHandlers.stopBinding={init:function(){return{controlsDescendantBindings:!0}}},n.virtualElements.allowedBindings.stopBinding=!0,n.bindingHandlers.lazyBinding={init:function(t,e,i,o,a){return n.utils.domData.set(t,"isBound",!1),{controlsDescendantBindings:!0}},update:function(t,e,i,o,a){var s=n.unwrap(e()),r=n.utils.domData.get(t,"isBound");s&&!r&&(n.utils.domData.set(t,"isBound",!0),n.applyBindingsToDescendants(a,t))}},n.virtualElements.allowedBindings.lazyBinding=!0,n.bindingHandlers.itemBuildTable={init:function(t,e,i,a,s){var r=n.unwrap(e()),l=(o(t),{});n.utils.domData.set(t,"pressedKeys",l);var u=function(e){var i=n.utils.domData.get(t,"pressedKeys");i[e.which]=!0,n.utils.domData.set(t,"pressedKeys",i)};n.utils.domData.set(t,"keyDownHandler",u);var d=function(e){var i=n.utils.domData.get(t,"pressedKeys");if(i[17]&&i[67]||i[17]&&i[86]){var a=o(t).find(".hover-cursor:hover");1==a.length&&(i[67]?r.copyInventoryToClipBoard(o("tr",o(t)).index(a[0])):r.pasteInventoryFromClipBoard(o("tr",o(t)).index(a[0])),a.fadeOut(50).fadeIn(50))}delete i[e.which],n.utils.domData.set(t,"pressedKeys",i)};n.utils.domData.set(t,"keyUpHandler",d),o(document).bind("keydown",u),o(document).bind("keyup",d),n.utils.domNodeDisposal.addDisposeCallback(t,function(){var e=n.utils.domData.get(t,"keyDownHandler"),i=n.utils.domData.get(t,"keyUpHandler");o(document).unbind("keydown",e),o(document).unbind("keyup",i)})}},n.bindingHandlers.preventBubble={init:function(t,e){var i=n.utils.unwrapObservable(e());n.utils.registerEventHandler(t,i,function(t){t.cancelBubble=!0,t.stopPropagation&&t.stopPropagation()})}},n.bindingHandlers.toggle={init:function(t,e){var i=e();n.applyBindingsToNode(t,{click:function(){i(!i())}})}},n.bindingHandlers.shopDockStyle={init:function(t,e,i,o,a){n.utils.unwrapObservable(e());a.$data.shopDock()&&!a.$data.shopPopout()?n.applyBindingsToNode(t,{style:{height:a.$data.windowHeight()-52+"px",position:"fixed",right:0,top:"52px","overflow-y":"auto"}}):n.applyBindingsToNode(t,{style:{height:"auto",position:"relative",right:"initial",top:"initial","overflow-y":"initial"}})},update:function(t,e,i,o,a){n.utils.unwrapObservable(e());a.$data.shopDock()&&!a.$data.shopPopout()?n.applyBindingsToNode(t,{style:{height:a.$data.windowHeight()-52+"px",position:"fixed",right:0,top:"52px","overflow-y":"auto"}}):n.applyBindingsToNode(t,{style:{height:"auto",position:"relative",right:"initial",top:"initial","overflow-y":"initial"}})}},n.bindingHandlers.logger={update:function(t,e,i){var o=n.utils.domData.get(t,"_ko_logger")||0,a=n.toJS(e()||i());n.utils.domData.set(t,"_ko_logger",++o),window.console&&console.log&&console.log(o,t,a)}},n.bindingHandlers.tooltip={update:function(t,e,i,a,s){var r,l,u;if(l=n.utils.unwrapObservable(e()),r=o(t),n.isObservable(l.title)){var d=!1;r.on("show.bs.tooltip",function(){d=!0}),r.on("hide.bs.tooltip",function(){d=!1});var p=l.animation||!0;l.title.subscribe(function(){d&&(r.data("bs.tooltip").options.animation=!1,r.tooltip("fixTitle").tooltip("show"),r.data("bs.tooltip").options.animation=p)})}u=r.data("bs.tooltip"),u?o.extend(u.options,l):r.tooltip(l)}},n.bindingHandlers.popover={init:function(t,e,i,a,s){var r=o(t),l=n.utils.unwrapObservable(e()),u=l.template||!1,d=l.options||{title:"popover"},p=l.data||!1;return u!==!1&&(p?d.content="<!-- ko template: { name: template, if: data, data: data } --><!-- /ko -->":d.content=o("#"+u).html(),d.html=!0),r.on("shown.bs.popover",function(t){var e=o(t.target).data(),i=e["bs.popover"].$tip,a=e["bs.popover"].options||{},r=o(t.target),l=r.position(),d={x:r.outerWidth(),y:r.outerHeight()};p&&n.applyBindingsToNode(i[0],{template:{name:u,data:p}},s);var c={x:i.outerWidth(),y:i.outerHeight()};switch(i.find('button[data-dismiss="popover"]').click(function(){r.popover("hide")}),a.placement){case"right":i.css({left:d.x+l.left,top:d.y/2+l.top-c.y/2});break;case"left":i.css({left:l.left-c.x,top:d.y/2+l.top-c.y/2});break;case"top":i.css({left:l.left+(d.x/2-c.x/2),top:l.top-c.y});break;case"bottom":i.css({left:l.left+(d.x/2-c.x/2),top:l.top+d.y})}}),r.popover(d),{controlsDescendantBindings:!0}}},n.bindingHandlers.chart={init:function(t,e,i,a,s){var r=o("<canvas/>"),l=n.utils.unwrapObservable(e()),u=r[0].getContext("2d"),d=i().chartType,p=i().chartOptions||{},c=i().chartContext;o(t).append(r);var g=new Chart(u)[d](l,p);n.utils.domData.set(t,"myChart",g),n.utils.domNodeDisposal.addDisposeCallback(t,function(){var e=n.utils.domData.get(t,"myChart");e.clear(),e.destroy()}),c&&c(u)},update:function(t,e,i,a,s){var r=o("<canvas/>").width(730).height(365),l=n.utils.unwrapObservable(e()),u=r[0].getContext("2d"),d=i().chartType,p=i().chartOptions||{},c=i().chartContext,g=n.utils.domData.get(t,"myChart");g&&(g.clear(),g.destroy()),s.$root.displayShop(),s.$root.sideView(),s.$root.shopDock(),o(t).empty(),o(t).append(r),l.datasets.length>0&&(g=new Chart(u)[d](l,p),n.utils.domData.set(t,"myChart",g)),c&&c(u)}},n.bindingHandlers.spinner={init:function(t,e,i){var a=i().spinnerOptions||{};o(t).spinner(a),n.utils.registerEventHandler(t,"spinchange",function(){var i=e();i(o(t).spinner("value"))}),n.utils.domNodeDisposal.addDisposeCallback(t,function(){o(t).spinner("destroy")})},update:function(t,e){var i=n.utils.unwrapObservable(e()),a=o(t).spinner("value");i!==a&&o(t).spinner("value",i)}},n.bindingHandlers.secondTab={update:function(t,e,i,o,a){var s=a.$root,r=n.utils.unwrapObservable(e());n.applyBindingsToNode(t,{css:{"second-tab":s.isSecondTab(r)&&s.sideView()}})}},n.bindingHandlers.hoverTab={update:function(t,e,i,o,a){var s=a.$root,r=n.utils.unwrapObservable(e());n.utils.registerEventHandler(t,"mouseover",function(){s.highlightTab(r)}),n.utils.registerEventHandler(t,"mouseout",function(){s.unhighlightTab(r)})}},n.bindingHandlers.hoverPaneStyle={init:function(t,e,i,o,a){var s=a.$root,r=n.utils.unwrapObservable(e());n.applyBindingsToNode(t,{style:{opacity:s.sideView()&&s.highlightedTab()!=r&&""!=s.highlightedTab()?.5:1}})},update:function(t,e,i,o,a){var s=a.$root,r=n.utils.unwrapObservable(e());n.applyBindingsToNode(t,{style:{opacity:s.sideView()&&s.highlightedTab()!=r&&""!=s.highlightedTab()?.5:1}})}},n.bindingHandlers.diffStyle={init:function(t,e,i,o){var a=n.utils.unwrapObservable(e());n.applyBindingsToNode(t,{css:{diffPos:a>0,diffNeg:0>a}})},update:function(t,e,i,o){var a=n.utils.unwrapObservable(e());n.applyBindingsToNode(t,{css:{diffPos:a>0,diffNeg:0>a}})}},n.bindingHandlers.diffCss={init:function(t,e,i,o){var a=n.utils.unwrapObservable(e()),s=i().diffCssStat;("attackTime"==s||"bat"==s)&&(a=-a),n.applyBindingsToNode(t,{css:{diffPos:a>0,diffNeg:0>a}})},update:function(t,e,i,o){var a=n.utils.unwrapObservable(e()),s=i().diffCssStat;("attackTime"==s||"bat"==s)&&(a=-a),n.applyBindingsToNode(t,{css:{diffPos:a>0,diffNeg:0>a}})}},n.bindingHandlers.jqAuto={init:function(t,e,i,a){function s(t){n.isWriteableObservable(d)?d(t):l._ko_property_writers&&l._ko_property_writers.jqAutoValue&&l._ko_property_writers.jqAutoValue(t)}var r=e()||{},l=i(),u=n.utils.unwrapObservable,d=l.jqAutoValue,p=l.jqAutoSource,c=l.jqAutoSourceValue,g=l.jqAutoSourceInputValue||c,b=l.jqAutoSourceLabel||c;r.select=function(t,e){s(e.item?e.item.actualValue:null)},r.change=function(e,i){var a=o(t).val(),r=n.utils.arrayFirst(u(p),function(t){return u(t[g])===a});r||s(null)};var f=n.dependentObservable(function(){var t=n.utils.arrayMap(u(p),function(t){var e={};return e.label=b?u(t[b]):u(t).toString(),e.value=g?u(t[g]):u(t).toString(),e.actualValue=c?u(t[c]):t,e});return t});f.subscribe(function(e){o(t).autocomplete("option","source",e)}),r.source=f(),r.minLength=1,o(t).autocomplete(r)},update:function(t,e,i,a){var s=i(),r=n.utils.unwrapObservable,l=r(s.jqAutoValue)||"",u=s.jqAutoSourceValue,d=s.jqAutoSourceInputValue||u;if(u&&d!==u)var p=r(s.jqAutoSource)||[],l=n.utils.arrayFirst(p,function(t){return r(t[u])===l})||{};o(t).val(l&&d!==u?r(l[d]):l.toString())}},n.bindingHandlers.jqAutoCombo={init:function(t,e){var i=o("#"+e());o(t).click(function(){return i.autocomplete("widget").is(":visible")?void i.autocomplete("close"):(i.autocomplete("search"," "),void i.focus())})}},n.extenders.numeric=function(t,e){var i=n.computed({read:t,write:function(i){var n=t(),o=Math.pow(10,e),a=isNaN(i)?0:parseFloat(+i),s=Math.round(a*o)/o;s!==n?t(s):i!==n&&t.notifySubscribers(s)}}).extend({notify:"always"});return i(t()),i},n});
//# sourceMappingURL=herocalc_knockout.js.map