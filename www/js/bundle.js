(function e(t,n,r){function s(o,u){if(!n[o]){if(!t[o]){var a=typeof require=="function"&&require;if(!u&&a)return a(o,!0);if(i)return i(o,!0);var f=new Error("Cannot find module '"+o+"'");throw f.code="MODULE_NOT_FOUND",f}var l=n[o]={exports:{}};t[o][0].call(l.exports,function(e){var n=t[o][1][e];return s(n?n:e)},l,l.exports,e,t,n,r)}return n[o].exports}var i=typeof require=="function"&&require;for(var o=0;o<r.length;o++)s(r[o]);return s})({1:[function(require,module,exports){
// This file is autogenerated via the `commonjs` Grunt task. You can require() this file in a CommonJS environment.
require('../../js/transition.js')
require('../../js/alert.js')
require('../../js/button.js')
require('../../js/carousel.js')
require('../../js/collapse.js')
require('../../js/dropdown.js')
require('../../js/modal.js')
require('../../js/tooltip.js')
require('../../js/popover.js')
require('../../js/scrollspy.js')
require('../../js/tab.js')
require('../../js/affix.js')
},{"../../js/affix.js":2,"../../js/alert.js":3,"../../js/button.js":4,"../../js/carousel.js":5,"../../js/collapse.js":6,"../../js/dropdown.js":7,"../../js/modal.js":8,"../../js/popover.js":9,"../../js/scrollspy.js":10,"../../js/tab.js":11,"../../js/tooltip.js":12,"../../js/transition.js":13}],2:[function(require,module,exports){
/* ========================================================================
 * Bootstrap: affix.js v3.3.7
 * http://getbootstrap.com/javascript/#affix
 * ========================================================================
 * Copyright 2011-2016 Twitter, Inc.
 * Licensed under MIT (https://github.com/twbs/bootstrap/blob/master/LICENSE)
 * ======================================================================== */


+function ($) {
  'use strict';

  // AFFIX CLASS DEFINITION
  // ======================

  var Affix = function (element, options) {
    this.options = $.extend({}, Affix.DEFAULTS, options)

    this.$target = $(this.options.target)
      .on('scroll.bs.affix.data-api', $.proxy(this.checkPosition, this))
      .on('click.bs.affix.data-api',  $.proxy(this.checkPositionWithEventLoop, this))

    this.$element     = $(element)
    this.affixed      = null
    this.unpin        = null
    this.pinnedOffset = null

    this.checkPosition()
  }

  Affix.VERSION  = '3.3.7'

  Affix.RESET    = 'affix affix-top affix-bottom'

  Affix.DEFAULTS = {
    offset: 0,
    target: window
  }

  Affix.prototype.getState = function (scrollHeight, height, offsetTop, offsetBottom) {
    var scrollTop    = this.$target.scrollTop()
    var position     = this.$element.offset()
    var targetHeight = this.$target.height()

    if (offsetTop != null && this.affixed == 'top') return scrollTop < offsetTop ? 'top' : false

    if (this.affixed == 'bottom') {
      if (offsetTop != null) return (scrollTop + this.unpin <= position.top) ? false : 'bottom'
      return (scrollTop + targetHeight <= scrollHeight - offsetBottom) ? false : 'bottom'
    }

    var initializing   = this.affixed == null
    var colliderTop    = initializing ? scrollTop : position.top
    var colliderHeight = initializing ? targetHeight : height

    if (offsetTop != null && scrollTop <= offsetTop) return 'top'
    if (offsetBottom != null && (colliderTop + colliderHeight >= scrollHeight - offsetBottom)) return 'bottom'

    return false
  }

  Affix.prototype.getPinnedOffset = function () {
    if (this.pinnedOffset) return this.pinnedOffset
    this.$element.removeClass(Affix.RESET).addClass('affix')
    var scrollTop = this.$target.scrollTop()
    var position  = this.$element.offset()
    return (this.pinnedOffset = position.top - scrollTop)
  }

  Affix.prototype.checkPositionWithEventLoop = function () {
    setTimeout($.proxy(this.checkPosition, this), 1)
  }

  Affix.prototype.checkPosition = function () {
    if (!this.$element.is(':visible')) return

    var height       = this.$element.height()
    var offset       = this.options.offset
    var offsetTop    = offset.top
    var offsetBottom = offset.bottom
    var scrollHeight = Math.max($(document).height(), $(document.body).height())

    if (typeof offset != 'object')         offsetBottom = offsetTop = offset
    if (typeof offsetTop == 'function')    offsetTop    = offset.top(this.$element)
    if (typeof offsetBottom == 'function') offsetBottom = offset.bottom(this.$element)

    var affix = this.getState(scrollHeight, height, offsetTop, offsetBottom)

    if (this.affixed != affix) {
      if (this.unpin != null) this.$element.css('top', '')

      var affixType = 'affix' + (affix ? '-' + affix : '')
      var e         = $.Event(affixType + '.bs.affix')

      this.$element.trigger(e)

      if (e.isDefaultPrevented()) return

      this.affixed = affix
      this.unpin = affix == 'bottom' ? this.getPinnedOffset() : null

      this.$element
        .removeClass(Affix.RESET)
        .addClass(affixType)
        .trigger(affixType.replace('affix', 'affixed') + '.bs.affix')
    }

    if (affix == 'bottom') {
      this.$element.offset({
        top: scrollHeight - height - offsetBottom
      })
    }
  }


  // AFFIX PLUGIN DEFINITION
  // =======================

  function Plugin(option) {
    return this.each(function () {
      var $this   = $(this)
      var data    = $this.data('bs.affix')
      var options = typeof option == 'object' && option

      if (!data) $this.data('bs.affix', (data = new Affix(this, options)))
      if (typeof option == 'string') data[option]()
    })
  }

  var old = $.fn.affix

  $.fn.affix             = Plugin
  $.fn.affix.Constructor = Affix


  // AFFIX NO CONFLICT
  // =================

  $.fn.affix.noConflict = function () {
    $.fn.affix = old
    return this
  }


  // AFFIX DATA-API
  // ==============

  $(window).on('load', function () {
    $('[data-spy="affix"]').each(function () {
      var $spy = $(this)
      var data = $spy.data()

      data.offset = data.offset || {}

      if (data.offsetBottom != null) data.offset.bottom = data.offsetBottom
      if (data.offsetTop    != null) data.offset.top    = data.offsetTop

      Plugin.call($spy, data)
    })
  })

}(jQuery);

},{}],3:[function(require,module,exports){
/* ========================================================================
 * Bootstrap: alert.js v3.3.7
 * http://getbootstrap.com/javascript/#alerts
 * ========================================================================
 * Copyright 2011-2016 Twitter, Inc.
 * Licensed under MIT (https://github.com/twbs/bootstrap/blob/master/LICENSE)
 * ======================================================================== */


+function ($) {
  'use strict';

  // ALERT CLASS DEFINITION
  // ======================

  var dismiss = '[data-dismiss="alert"]'
  var Alert   = function (el) {
    $(el).on('click', dismiss, this.close)
  }

  Alert.VERSION = '3.3.7'

  Alert.TRANSITION_DURATION = 150

  Alert.prototype.close = function (e) {
    var $this    = $(this)
    var selector = $this.attr('data-target')

    if (!selector) {
      selector = $this.attr('href')
      selector = selector && selector.replace(/.*(?=#[^\s]*$)/, '') // strip for ie7
    }

    var $parent = $(selector === '#' ? [] : selector)

    if (e) e.preventDefault()

    if (!$parent.length) {
      $parent = $this.closest('.alert')
    }

    $parent.trigger(e = $.Event('close.bs.alert'))

    if (e.isDefaultPrevented()) return

    $parent.removeClass('in')

    function removeElement() {
      // detach from parent, fire event then clean up data
      $parent.detach().trigger('closed.bs.alert').remove()
    }

    $.support.transition && $parent.hasClass('fade') ?
      $parent
        .one('bsTransitionEnd', removeElement)
        .emulateTransitionEnd(Alert.TRANSITION_DURATION) :
      removeElement()
  }


  // ALERT PLUGIN DEFINITION
  // =======================

  function Plugin(option) {
    return this.each(function () {
      var $this = $(this)
      var data  = $this.data('bs.alert')

      if (!data) $this.data('bs.alert', (data = new Alert(this)))
      if (typeof option == 'string') data[option].call($this)
    })
  }

  var old = $.fn.alert

  $.fn.alert             = Plugin
  $.fn.alert.Constructor = Alert


  // ALERT NO CONFLICT
  // =================

  $.fn.alert.noConflict = function () {
    $.fn.alert = old
    return this
  }


  // ALERT DATA-API
  // ==============

  $(document).on('click.bs.alert.data-api', dismiss, Alert.prototype.close)

}(jQuery);

},{}],4:[function(require,module,exports){
/* ========================================================================
 * Bootstrap: button.js v3.3.7
 * http://getbootstrap.com/javascript/#buttons
 * ========================================================================
 * Copyright 2011-2016 Twitter, Inc.
 * Licensed under MIT (https://github.com/twbs/bootstrap/blob/master/LICENSE)
 * ======================================================================== */


+function ($) {
  'use strict';

  // BUTTON PUBLIC CLASS DEFINITION
  // ==============================

  var Button = function (element, options) {
    this.$element  = $(element)
    this.options   = $.extend({}, Button.DEFAULTS, options)
    this.isLoading = false
  }

  Button.VERSION  = '3.3.7'

  Button.DEFAULTS = {
    loadingText: 'loading...'
  }

  Button.prototype.setState = function (state) {
    var d    = 'disabled'
    var $el  = this.$element
    var val  = $el.is('input') ? 'val' : 'html'
    var data = $el.data()

    state += 'Text'

    if (data.resetText == null) $el.data('resetText', $el[val]())

    // push to event loop to allow forms to submit
    setTimeout($.proxy(function () {
      $el[val](data[state] == null ? this.options[state] : data[state])

      if (state == 'loadingText') {
        this.isLoading = true
        $el.addClass(d).attr(d, d).prop(d, true)
      } else if (this.isLoading) {
        this.isLoading = false
        $el.removeClass(d).removeAttr(d).prop(d, false)
      }
    }, this), 0)
  }

  Button.prototype.toggle = function () {
    var changed = true
    var $parent = this.$element.closest('[data-toggle="buttons"]')

    if ($parent.length) {
      var $input = this.$element.find('input')
      if ($input.prop('type') == 'radio') {
        if ($input.prop('checked')) changed = false
        $parent.find('.active').removeClass('active')
        this.$element.addClass('active')
      } else if ($input.prop('type') == 'checkbox') {
        if (($input.prop('checked')) !== this.$element.hasClass('active')) changed = false
        this.$element.toggleClass('active')
      }
      $input.prop('checked', this.$element.hasClass('active'))
      if (changed) $input.trigger('change')
    } else {
      this.$element.attr('aria-pressed', !this.$element.hasClass('active'))
      this.$element.toggleClass('active')
    }
  }


  // BUTTON PLUGIN DEFINITION
  // ========================

  function Plugin(option) {
    return this.each(function () {
      var $this   = $(this)
      var data    = $this.data('bs.button')
      var options = typeof option == 'object' && option

      if (!data) $this.data('bs.button', (data = new Button(this, options)))

      if (option == 'toggle') data.toggle()
      else if (option) data.setState(option)
    })
  }

  var old = $.fn.button

  $.fn.button             = Plugin
  $.fn.button.Constructor = Button


  // BUTTON NO CONFLICT
  // ==================

  $.fn.button.noConflict = function () {
    $.fn.button = old
    return this
  }


  // BUTTON DATA-API
  // ===============

  $(document)
    .on('click.bs.button.data-api', '[data-toggle^="button"]', function (e) {
      var $btn = $(e.target).closest('.btn')
      Plugin.call($btn, 'toggle')
      if (!($(e.target).is('input[type="radio"], input[type="checkbox"]'))) {
        // Prevent double click on radios, and the double selections (so cancellation) on checkboxes
        e.preventDefault()
        // The target component still receive the focus
        if ($btn.is('input,button')) $btn.trigger('focus')
        else $btn.find('input:visible,button:visible').first().trigger('focus')
      }
    })
    .on('focus.bs.button.data-api blur.bs.button.data-api', '[data-toggle^="button"]', function (e) {
      $(e.target).closest('.btn').toggleClass('focus', /^focus(in)?$/.test(e.type))
    })

}(jQuery);

},{}],5:[function(require,module,exports){
/* ========================================================================
 * Bootstrap: carousel.js v3.3.7
 * http://getbootstrap.com/javascript/#carousel
 * ========================================================================
 * Copyright 2011-2016 Twitter, Inc.
 * Licensed under MIT (https://github.com/twbs/bootstrap/blob/master/LICENSE)
 * ======================================================================== */


+function ($) {
  'use strict';

  // CAROUSEL CLASS DEFINITION
  // =========================

  var Carousel = function (element, options) {
    this.$element    = $(element)
    this.$indicators = this.$element.find('.carousel-indicators')
    this.options     = options
    this.paused      = null
    this.sliding     = null
    this.interval    = null
    this.$active     = null
    this.$items      = null

    this.options.keyboard && this.$element.on('keydown.bs.carousel', $.proxy(this.keydown, this))

    this.options.pause == 'hover' && !('ontouchstart' in document.documentElement) && this.$element
      .on('mouseenter.bs.carousel', $.proxy(this.pause, this))
      .on('mouseleave.bs.carousel', $.proxy(this.cycle, this))
  }

  Carousel.VERSION  = '3.3.7'

  Carousel.TRANSITION_DURATION = 600

  Carousel.DEFAULTS = {
    interval: 5000,
    pause: 'hover',
    wrap: true,
    keyboard: true
  }

  Carousel.prototype.keydown = function (e) {
    if (/input|textarea/i.test(e.target.tagName)) return
    switch (e.which) {
      case 37: this.prev(); break
      case 39: this.next(); break
      default: return
    }

    e.preventDefault()
  }

  Carousel.prototype.cycle = function (e) {
    e || (this.paused = false)

    this.interval && clearInterval(this.interval)

    this.options.interval
      && !this.paused
      && (this.interval = setInterval($.proxy(this.next, this), this.options.interval))

    return this
  }

  Carousel.prototype.getItemIndex = function (item) {
    this.$items = item.parent().children('.item')
    return this.$items.index(item || this.$active)
  }

  Carousel.prototype.getItemForDirection = function (direction, active) {
    var activeIndex = this.getItemIndex(active)
    var willWrap = (direction == 'prev' && activeIndex === 0)
                || (direction == 'next' && activeIndex == (this.$items.length - 1))
    if (willWrap && !this.options.wrap) return active
    var delta = direction == 'prev' ? -1 : 1
    var itemIndex = (activeIndex + delta) % this.$items.length
    return this.$items.eq(itemIndex)
  }

  Carousel.prototype.to = function (pos) {
    var that        = this
    var activeIndex = this.getItemIndex(this.$active = this.$element.find('.item.active'))

    if (pos > (this.$items.length - 1) || pos < 0) return

    if (this.sliding)       return this.$element.one('slid.bs.carousel', function () { that.to(pos) }) // yes, "slid"
    if (activeIndex == pos) return this.pause().cycle()

    return this.slide(pos > activeIndex ? 'next' : 'prev', this.$items.eq(pos))
  }

  Carousel.prototype.pause = function (e) {
    e || (this.paused = true)

    if (this.$element.find('.next, .prev').length && $.support.transition) {
      this.$element.trigger($.support.transition.end)
      this.cycle(true)
    }

    this.interval = clearInterval(this.interval)

    return this
  }

  Carousel.prototype.next = function () {
    if (this.sliding) return
    return this.slide('next')
  }

  Carousel.prototype.prev = function () {
    if (this.sliding) return
    return this.slide('prev')
  }

  Carousel.prototype.slide = function (type, next) {
    var $active   = this.$element.find('.item.active')
    var $next     = next || this.getItemForDirection(type, $active)
    var isCycling = this.interval
    var direction = type == 'next' ? 'left' : 'right'
    var that      = this

    if ($next.hasClass('active')) return (this.sliding = false)

    var relatedTarget = $next[0]
    var slideEvent = $.Event('slide.bs.carousel', {
      relatedTarget: relatedTarget,
      direction: direction
    })
    this.$element.trigger(slideEvent)
    if (slideEvent.isDefaultPrevented()) return

    this.sliding = true

    isCycling && this.pause()

    if (this.$indicators.length) {
      this.$indicators.find('.active').removeClass('active')
      var $nextIndicator = $(this.$indicators.children()[this.getItemIndex($next)])
      $nextIndicator && $nextIndicator.addClass('active')
    }

    var slidEvent = $.Event('slid.bs.carousel', { relatedTarget: relatedTarget, direction: direction }) // yes, "slid"
    if ($.support.transition && this.$element.hasClass('slide')) {
      $next.addClass(type)
      $next[0].offsetWidth // force reflow
      $active.addClass(direction)
      $next.addClass(direction)
      $active
        .one('bsTransitionEnd', function () {
          $next.removeClass([type, direction].join(' ')).addClass('active')
          $active.removeClass(['active', direction].join(' '))
          that.sliding = false
          setTimeout(function () {
            that.$element.trigger(slidEvent)
          }, 0)
        })
        .emulateTransitionEnd(Carousel.TRANSITION_DURATION)
    } else {
      $active.removeClass('active')
      $next.addClass('active')
      this.sliding = false
      this.$element.trigger(slidEvent)
    }

    isCycling && this.cycle()

    return this
  }


  // CAROUSEL PLUGIN DEFINITION
  // ==========================

  function Plugin(option) {
    return this.each(function () {
      var $this   = $(this)
      var data    = $this.data('bs.carousel')
      var options = $.extend({}, Carousel.DEFAULTS, $this.data(), typeof option == 'object' && option)
      var action  = typeof option == 'string' ? option : options.slide

      if (!data) $this.data('bs.carousel', (data = new Carousel(this, options)))
      if (typeof option == 'number') data.to(option)
      else if (action) data[action]()
      else if (options.interval) data.pause().cycle()
    })
  }

  var old = $.fn.carousel

  $.fn.carousel             = Plugin
  $.fn.carousel.Constructor = Carousel


  // CAROUSEL NO CONFLICT
  // ====================

  $.fn.carousel.noConflict = function () {
    $.fn.carousel = old
    return this
  }


  // CAROUSEL DATA-API
  // =================

  var clickHandler = function (e) {
    var href
    var $this   = $(this)
    var $target = $($this.attr('data-target') || (href = $this.attr('href')) && href.replace(/.*(?=#[^\s]+$)/, '')) // strip for ie7
    if (!$target.hasClass('carousel')) return
    var options = $.extend({}, $target.data(), $this.data())
    var slideIndex = $this.attr('data-slide-to')
    if (slideIndex) options.interval = false

    Plugin.call($target, options)

    if (slideIndex) {
      $target.data('bs.carousel').to(slideIndex)
    }

    e.preventDefault()
  }

  $(document)
    .on('click.bs.carousel.data-api', '[data-slide]', clickHandler)
    .on('click.bs.carousel.data-api', '[data-slide-to]', clickHandler)

  $(window).on('load', function () {
    $('[data-ride="carousel"]').each(function () {
      var $carousel = $(this)
      Plugin.call($carousel, $carousel.data())
    })
  })

}(jQuery);

},{}],6:[function(require,module,exports){
/* ========================================================================
 * Bootstrap: collapse.js v3.3.7
 * http://getbootstrap.com/javascript/#collapse
 * ========================================================================
 * Copyright 2011-2016 Twitter, Inc.
 * Licensed under MIT (https://github.com/twbs/bootstrap/blob/master/LICENSE)
 * ======================================================================== */

/* jshint latedef: false */

+function ($) {
  'use strict';

  // COLLAPSE PUBLIC CLASS DEFINITION
  // ================================

  var Collapse = function (element, options) {
    this.$element      = $(element)
    this.options       = $.extend({}, Collapse.DEFAULTS, options)
    this.$trigger      = $('[data-toggle="collapse"][href="#' + element.id + '"],' +
                           '[data-toggle="collapse"][data-target="#' + element.id + '"]')
    this.transitioning = null

    if (this.options.parent) {
      this.$parent = this.getParent()
    } else {
      this.addAriaAndCollapsedClass(this.$element, this.$trigger)
    }

    if (this.options.toggle) this.toggle()
  }

  Collapse.VERSION  = '3.3.7'

  Collapse.TRANSITION_DURATION = 350

  Collapse.DEFAULTS = {
    toggle: true
  }

  Collapse.prototype.dimension = function () {
    var hasWidth = this.$element.hasClass('width')
    return hasWidth ? 'width' : 'height'
  }

  Collapse.prototype.show = function () {
    if (this.transitioning || this.$element.hasClass('in')) return

    var activesData
    var actives = this.$parent && this.$parent.children('.panel').children('.in, .collapsing')

    if (actives && actives.length) {
      activesData = actives.data('bs.collapse')
      if (activesData && activesData.transitioning) return
    }

    var startEvent = $.Event('show.bs.collapse')
    this.$element.trigger(startEvent)
    if (startEvent.isDefaultPrevented()) return

    if (actives && actives.length) {
      Plugin.call(actives, 'hide')
      activesData || actives.data('bs.collapse', null)
    }

    var dimension = this.dimension()

    this.$element
      .removeClass('collapse')
      .addClass('collapsing')[dimension](0)
      .attr('aria-expanded', true)

    this.$trigger
      .removeClass('collapsed')
      .attr('aria-expanded', true)

    this.transitioning = 1

    var complete = function () {
      this.$element
        .removeClass('collapsing')
        .addClass('collapse in')[dimension]('')
      this.transitioning = 0
      this.$element
        .trigger('shown.bs.collapse')
    }

    if (!$.support.transition) return complete.call(this)

    var scrollSize = $.camelCase(['scroll', dimension].join('-'))

    this.$element
      .one('bsTransitionEnd', $.proxy(complete, this))
      .emulateTransitionEnd(Collapse.TRANSITION_DURATION)[dimension](this.$element[0][scrollSize])
  }

  Collapse.prototype.hide = function () {
    if (this.transitioning || !this.$element.hasClass('in')) return

    var startEvent = $.Event('hide.bs.collapse')
    this.$element.trigger(startEvent)
    if (startEvent.isDefaultPrevented()) return

    var dimension = this.dimension()

    this.$element[dimension](this.$element[dimension]())[0].offsetHeight

    this.$element
      .addClass('collapsing')
      .removeClass('collapse in')
      .attr('aria-expanded', false)

    this.$trigger
      .addClass('collapsed')
      .attr('aria-expanded', false)

    this.transitioning = 1

    var complete = function () {
      this.transitioning = 0
      this.$element
        .removeClass('collapsing')
        .addClass('collapse')
        .trigger('hidden.bs.collapse')
    }

    if (!$.support.transition) return complete.call(this)

    this.$element
      [dimension](0)
      .one('bsTransitionEnd', $.proxy(complete, this))
      .emulateTransitionEnd(Collapse.TRANSITION_DURATION)
  }

  Collapse.prototype.toggle = function () {
    this[this.$element.hasClass('in') ? 'hide' : 'show']()
  }

  Collapse.prototype.getParent = function () {
    return $(this.options.parent)
      .find('[data-toggle="collapse"][data-parent="' + this.options.parent + '"]')
      .each($.proxy(function (i, element) {
        var $element = $(element)
        this.addAriaAndCollapsedClass(getTargetFromTrigger($element), $element)
      }, this))
      .end()
  }

  Collapse.prototype.addAriaAndCollapsedClass = function ($element, $trigger) {
    var isOpen = $element.hasClass('in')

    $element.attr('aria-expanded', isOpen)
    $trigger
      .toggleClass('collapsed', !isOpen)
      .attr('aria-expanded', isOpen)
  }

  function getTargetFromTrigger($trigger) {
    var href
    var target = $trigger.attr('data-target')
      || (href = $trigger.attr('href')) && href.replace(/.*(?=#[^\s]+$)/, '') // strip for ie7

    return $(target)
  }


  // COLLAPSE PLUGIN DEFINITION
  // ==========================

  function Plugin(option) {
    return this.each(function () {
      var $this   = $(this)
      var data    = $this.data('bs.collapse')
      var options = $.extend({}, Collapse.DEFAULTS, $this.data(), typeof option == 'object' && option)

      if (!data && options.toggle && /show|hide/.test(option)) options.toggle = false
      if (!data) $this.data('bs.collapse', (data = new Collapse(this, options)))
      if (typeof option == 'string') data[option]()
    })
  }

  var old = $.fn.collapse

  $.fn.collapse             = Plugin
  $.fn.collapse.Constructor = Collapse


  // COLLAPSE NO CONFLICT
  // ====================

  $.fn.collapse.noConflict = function () {
    $.fn.collapse = old
    return this
  }


  // COLLAPSE DATA-API
  // =================

  $(document).on('click.bs.collapse.data-api', '[data-toggle="collapse"]', function (e) {
    var $this   = $(this)

    if (!$this.attr('data-target')) e.preventDefault()

    var $target = getTargetFromTrigger($this)
    var data    = $target.data('bs.collapse')
    var option  = data ? 'toggle' : $this.data()

    Plugin.call($target, option)
  })

}(jQuery);

},{}],7:[function(require,module,exports){
/* ========================================================================
 * Bootstrap: dropdown.js v3.3.7
 * http://getbootstrap.com/javascript/#dropdowns
 * ========================================================================
 * Copyright 2011-2016 Twitter, Inc.
 * Licensed under MIT (https://github.com/twbs/bootstrap/blob/master/LICENSE)
 * ======================================================================== */


+function ($) {
  'use strict';

  // DROPDOWN CLASS DEFINITION
  // =========================

  var backdrop = '.dropdown-backdrop'
  var toggle   = '[data-toggle="dropdown"]'
  var Dropdown = function (element) {
    $(element).on('click.bs.dropdown', this.toggle)
  }

  Dropdown.VERSION = '3.3.7'

  function getParent($this) {
    var selector = $this.attr('data-target')

    if (!selector) {
      selector = $this.attr('href')
      selector = selector && /#[A-Za-z]/.test(selector) && selector.replace(/.*(?=#[^\s]*$)/, '') // strip for ie7
    }

    var $parent = selector && $(selector)

    return $parent && $parent.length ? $parent : $this.parent()
  }

  function clearMenus(e) {
    if (e && e.which === 3) return
    $(backdrop).remove()
    $(toggle).each(function () {
      var $this         = $(this)
      var $parent       = getParent($this)
      var relatedTarget = { relatedTarget: this }

      if (!$parent.hasClass('open')) return

      if (e && e.type == 'click' && /input|textarea/i.test(e.target.tagName) && $.contains($parent[0], e.target)) return

      $parent.trigger(e = $.Event('hide.bs.dropdown', relatedTarget))

      if (e.isDefaultPrevented()) return

      $this.attr('aria-expanded', 'false')
      $parent.removeClass('open').trigger($.Event('hidden.bs.dropdown', relatedTarget))
    })
  }

  Dropdown.prototype.toggle = function (e) {
    var $this = $(this)

    if ($this.is('.disabled, :disabled')) return

    var $parent  = getParent($this)
    var isActive = $parent.hasClass('open')

    clearMenus()

    if (!isActive) {
      if ('ontouchstart' in document.documentElement && !$parent.closest('.navbar-nav').length) {
        // if mobile we use a backdrop because click events don't delegate
        $(document.createElement('div'))
          .addClass('dropdown-backdrop')
          .insertAfter($(this))
          .on('click', clearMenus)
      }

      var relatedTarget = { relatedTarget: this }
      $parent.trigger(e = $.Event('show.bs.dropdown', relatedTarget))

      if (e.isDefaultPrevented()) return

      $this
        .trigger('focus')
        .attr('aria-expanded', 'true')

      $parent
        .toggleClass('open')
        .trigger($.Event('shown.bs.dropdown', relatedTarget))
    }

    return false
  }

  Dropdown.prototype.keydown = function (e) {
    if (!/(38|40|27|32)/.test(e.which) || /input|textarea/i.test(e.target.tagName)) return

    var $this = $(this)

    e.preventDefault()
    e.stopPropagation()

    if ($this.is('.disabled, :disabled')) return

    var $parent  = getParent($this)
    var isActive = $parent.hasClass('open')

    if (!isActive && e.which != 27 || isActive && e.which == 27) {
      if (e.which == 27) $parent.find(toggle).trigger('focus')
      return $this.trigger('click')
    }

    var desc = ' li:not(.disabled):visible a'
    var $items = $parent.find('.dropdown-menu' + desc)

    if (!$items.length) return

    var index = $items.index(e.target)

    if (e.which == 38 && index > 0)                 index--         // up
    if (e.which == 40 && index < $items.length - 1) index++         // down
    if (!~index)                                    index = 0

    $items.eq(index).trigger('focus')
  }


  // DROPDOWN PLUGIN DEFINITION
  // ==========================

  function Plugin(option) {
    return this.each(function () {
      var $this = $(this)
      var data  = $this.data('bs.dropdown')

      if (!data) $this.data('bs.dropdown', (data = new Dropdown(this)))
      if (typeof option == 'string') data[option].call($this)
    })
  }

  var old = $.fn.dropdown

  $.fn.dropdown             = Plugin
  $.fn.dropdown.Constructor = Dropdown


  // DROPDOWN NO CONFLICT
  // ====================

  $.fn.dropdown.noConflict = function () {
    $.fn.dropdown = old
    return this
  }


  // APPLY TO STANDARD DROPDOWN ELEMENTS
  // ===================================

  $(document)
    .on('click.bs.dropdown.data-api', clearMenus)
    .on('click.bs.dropdown.data-api', '.dropdown form', function (e) { e.stopPropagation() })
    .on('click.bs.dropdown.data-api', toggle, Dropdown.prototype.toggle)
    .on('keydown.bs.dropdown.data-api', toggle, Dropdown.prototype.keydown)
    .on('keydown.bs.dropdown.data-api', '.dropdown-menu', Dropdown.prototype.keydown)

}(jQuery);

},{}],8:[function(require,module,exports){
/* ========================================================================
 * Bootstrap: modal.js v3.3.7
 * http://getbootstrap.com/javascript/#modals
 * ========================================================================
 * Copyright 2011-2016 Twitter, Inc.
 * Licensed under MIT (https://github.com/twbs/bootstrap/blob/master/LICENSE)
 * ======================================================================== */


+function ($) {
  'use strict';

  // MODAL CLASS DEFINITION
  // ======================

  var Modal = function (element, options) {
    this.options             = options
    this.$body               = $(document.body)
    this.$element            = $(element)
    this.$dialog             = this.$element.find('.modal-dialog')
    this.$backdrop           = null
    this.isShown             = null
    this.originalBodyPad     = null
    this.scrollbarWidth      = 0
    this.ignoreBackdropClick = false

    if (this.options.remote) {
      this.$element
        .find('.modal-content')
        .load(this.options.remote, $.proxy(function () {
          this.$element.trigger('loaded.bs.modal')
        }, this))
    }
  }

  Modal.VERSION  = '3.3.7'

  Modal.TRANSITION_DURATION = 300
  Modal.BACKDROP_TRANSITION_DURATION = 150

  Modal.DEFAULTS = {
    backdrop: true,
    keyboard: true,
    show: true
  }

  Modal.prototype.toggle = function (_relatedTarget) {
    return this.isShown ? this.hide() : this.show(_relatedTarget)
  }

  Modal.prototype.show = function (_relatedTarget) {
    var that = this
    var e    = $.Event('show.bs.modal', { relatedTarget: _relatedTarget })

    this.$element.trigger(e)

    if (this.isShown || e.isDefaultPrevented()) return

    this.isShown = true

    this.checkScrollbar()
    this.setScrollbar()
    this.$body.addClass('modal-open')

    this.escape()
    this.resize()

    this.$element.on('click.dismiss.bs.modal', '[data-dismiss="modal"]', $.proxy(this.hide, this))

    this.$dialog.on('mousedown.dismiss.bs.modal', function () {
      that.$element.one('mouseup.dismiss.bs.modal', function (e) {
        if ($(e.target).is(that.$element)) that.ignoreBackdropClick = true
      })
    })

    this.backdrop(function () {
      var transition = $.support.transition && that.$element.hasClass('fade')

      if (!that.$element.parent().length) {
        that.$element.appendTo(that.$body) // don't move modals dom position
      }

      that.$element
        .show()
        .scrollTop(0)

      that.adjustDialog()

      if (transition) {
        that.$element[0].offsetWidth // force reflow
      }

      that.$element.addClass('in')

      that.enforceFocus()

      var e = $.Event('shown.bs.modal', { relatedTarget: _relatedTarget })

      transition ?
        that.$dialog // wait for modal to slide in
          .one('bsTransitionEnd', function () {
            that.$element.trigger('focus').trigger(e)
          })
          .emulateTransitionEnd(Modal.TRANSITION_DURATION) :
        that.$element.trigger('focus').trigger(e)
    })
  }

  Modal.prototype.hide = function (e) {
    if (e) e.preventDefault()

    e = $.Event('hide.bs.modal')

    this.$element.trigger(e)

    if (!this.isShown || e.isDefaultPrevented()) return

    this.isShown = false

    this.escape()
    this.resize()

    $(document).off('focusin.bs.modal')

    this.$element
      .removeClass('in')
      .off('click.dismiss.bs.modal')
      .off('mouseup.dismiss.bs.modal')

    this.$dialog.off('mousedown.dismiss.bs.modal')

    $.support.transition && this.$element.hasClass('fade') ?
      this.$element
        .one('bsTransitionEnd', $.proxy(this.hideModal, this))
        .emulateTransitionEnd(Modal.TRANSITION_DURATION) :
      this.hideModal()
  }

  Modal.prototype.enforceFocus = function () {
    $(document)
      .off('focusin.bs.modal') // guard against infinite focus loop
      .on('focusin.bs.modal', $.proxy(function (e) {
        if (document !== e.target &&
            this.$element[0] !== e.target &&
            !this.$element.has(e.target).length) {
          this.$element.trigger('focus')
        }
      }, this))
  }

  Modal.prototype.escape = function () {
    if (this.isShown && this.options.keyboard) {
      this.$element.on('keydown.dismiss.bs.modal', $.proxy(function (e) {
        e.which == 27 && this.hide()
      }, this))
    } else if (!this.isShown) {
      this.$element.off('keydown.dismiss.bs.modal')
    }
  }

  Modal.prototype.resize = function () {
    if (this.isShown) {
      $(window).on('resize.bs.modal', $.proxy(this.handleUpdate, this))
    } else {
      $(window).off('resize.bs.modal')
    }
  }

  Modal.prototype.hideModal = function () {
    var that = this
    this.$element.hide()
    this.backdrop(function () {
      that.$body.removeClass('modal-open')
      that.resetAdjustments()
      that.resetScrollbar()
      that.$element.trigger('hidden.bs.modal')
    })
  }

  Modal.prototype.removeBackdrop = function () {
    this.$backdrop && this.$backdrop.remove()
    this.$backdrop = null
  }

  Modal.prototype.backdrop = function (callback) {
    var that = this
    var animate = this.$element.hasClass('fade') ? 'fade' : ''

    if (this.isShown && this.options.backdrop) {
      var doAnimate = $.support.transition && animate

      this.$backdrop = $(document.createElement('div'))
        .addClass('modal-backdrop ' + animate)
        .appendTo(this.$body)

      this.$element.on('click.dismiss.bs.modal', $.proxy(function (e) {
        if (this.ignoreBackdropClick) {
          this.ignoreBackdropClick = false
          return
        }
        if (e.target !== e.currentTarget) return
        this.options.backdrop == 'static'
          ? this.$element[0].focus()
          : this.hide()
      }, this))

      if (doAnimate) this.$backdrop[0].offsetWidth // force reflow

      this.$backdrop.addClass('in')

      if (!callback) return

      doAnimate ?
        this.$backdrop
          .one('bsTransitionEnd', callback)
          .emulateTransitionEnd(Modal.BACKDROP_TRANSITION_DURATION) :
        callback()

    } else if (!this.isShown && this.$backdrop) {
      this.$backdrop.removeClass('in')

      var callbackRemove = function () {
        that.removeBackdrop()
        callback && callback()
      }
      $.support.transition && this.$element.hasClass('fade') ?
        this.$backdrop
          .one('bsTransitionEnd', callbackRemove)
          .emulateTransitionEnd(Modal.BACKDROP_TRANSITION_DURATION) :
        callbackRemove()

    } else if (callback) {
      callback()
    }
  }

  // these following methods are used to handle overflowing modals

  Modal.prototype.handleUpdate = function () {
    this.adjustDialog()
  }

  Modal.prototype.adjustDialog = function () {
    var modalIsOverflowing = this.$element[0].scrollHeight > document.documentElement.clientHeight

    this.$element.css({
      paddingLeft:  !this.bodyIsOverflowing && modalIsOverflowing ? this.scrollbarWidth : '',
      paddingRight: this.bodyIsOverflowing && !modalIsOverflowing ? this.scrollbarWidth : ''
    })
  }

  Modal.prototype.resetAdjustments = function () {
    this.$element.css({
      paddingLeft: '',
      paddingRight: ''
    })
  }

  Modal.prototype.checkScrollbar = function () {
    var fullWindowWidth = window.innerWidth
    if (!fullWindowWidth) { // workaround for missing window.innerWidth in IE8
      var documentElementRect = document.documentElement.getBoundingClientRect()
      fullWindowWidth = documentElementRect.right - Math.abs(documentElementRect.left)
    }
    this.bodyIsOverflowing = document.body.clientWidth < fullWindowWidth
    this.scrollbarWidth = this.measureScrollbar()
  }

  Modal.prototype.setScrollbar = function () {
    var bodyPad = parseInt((this.$body.css('padding-right') || 0), 10)
    this.originalBodyPad = document.body.style.paddingRight || ''
    if (this.bodyIsOverflowing) this.$body.css('padding-right', bodyPad + this.scrollbarWidth)
  }

  Modal.prototype.resetScrollbar = function () {
    this.$body.css('padding-right', this.originalBodyPad)
  }

  Modal.prototype.measureScrollbar = function () { // thx walsh
    var scrollDiv = document.createElement('div')
    scrollDiv.className = 'modal-scrollbar-measure'
    this.$body.append(scrollDiv)
    var scrollbarWidth = scrollDiv.offsetWidth - scrollDiv.clientWidth
    this.$body[0].removeChild(scrollDiv)
    return scrollbarWidth
  }


  // MODAL PLUGIN DEFINITION
  // =======================

  function Plugin(option, _relatedTarget) {
    return this.each(function () {
      var $this   = $(this)
      var data    = $this.data('bs.modal')
      var options = $.extend({}, Modal.DEFAULTS, $this.data(), typeof option == 'object' && option)

      if (!data) $this.data('bs.modal', (data = new Modal(this, options)))
      if (typeof option == 'string') data[option](_relatedTarget)
      else if (options.show) data.show(_relatedTarget)
    })
  }

  var old = $.fn.modal

  $.fn.modal             = Plugin
  $.fn.modal.Constructor = Modal


  // MODAL NO CONFLICT
  // =================

  $.fn.modal.noConflict = function () {
    $.fn.modal = old
    return this
  }


  // MODAL DATA-API
  // ==============

  $(document).on('click.bs.modal.data-api', '[data-toggle="modal"]', function (e) {
    var $this   = $(this)
    var href    = $this.attr('href')
    var $target = $($this.attr('data-target') || (href && href.replace(/.*(?=#[^\s]+$)/, ''))) // strip for ie7
    var option  = $target.data('bs.modal') ? 'toggle' : $.extend({ remote: !/#/.test(href) && href }, $target.data(), $this.data())

    if ($this.is('a')) e.preventDefault()

    $target.one('show.bs.modal', function (showEvent) {
      if (showEvent.isDefaultPrevented()) return // only register focus restorer if modal will actually get shown
      $target.one('hidden.bs.modal', function () {
        $this.is(':visible') && $this.trigger('focus')
      })
    })
    Plugin.call($target, option, this)
  })

}(jQuery);

},{}],9:[function(require,module,exports){
/* ========================================================================
 * Bootstrap: popover.js v3.3.7
 * http://getbootstrap.com/javascript/#popovers
 * ========================================================================
 * Copyright 2011-2016 Twitter, Inc.
 * Licensed under MIT (https://github.com/twbs/bootstrap/blob/master/LICENSE)
 * ======================================================================== */


+function ($) {
  'use strict';

  // POPOVER PUBLIC CLASS DEFINITION
  // ===============================

  var Popover = function (element, options) {
    this.init('popover', element, options)
  }

  if (!$.fn.tooltip) throw new Error('Popover requires tooltip.js')

  Popover.VERSION  = '3.3.7'

  Popover.DEFAULTS = $.extend({}, $.fn.tooltip.Constructor.DEFAULTS, {
    placement: 'right',
    trigger: 'click',
    content: '',
    template: '<div class="popover" role="tooltip"><div class="arrow"></div><h3 class="popover-title"></h3><div class="popover-content"></div></div>'
  })


  // NOTE: POPOVER EXTENDS tooltip.js
  // ================================

  Popover.prototype = $.extend({}, $.fn.tooltip.Constructor.prototype)

  Popover.prototype.constructor = Popover

  Popover.prototype.getDefaults = function () {
    return Popover.DEFAULTS
  }

  Popover.prototype.setContent = function () {
    var $tip    = this.tip()
    var title   = this.getTitle()
    var content = this.getContent()

    $tip.find('.popover-title')[this.options.html ? 'html' : 'text'](title)
    $tip.find('.popover-content').children().detach().end()[ // we use append for html objects to maintain js events
      this.options.html ? (typeof content == 'string' ? 'html' : 'append') : 'text'
    ](content)

    $tip.removeClass('fade top bottom left right in')

    // IE8 doesn't accept hiding via the `:empty` pseudo selector, we have to do
    // this manually by checking the contents.
    if (!$tip.find('.popover-title').html()) $tip.find('.popover-title').hide()
  }

  Popover.prototype.hasContent = function () {
    return this.getTitle() || this.getContent()
  }

  Popover.prototype.getContent = function () {
    var $e = this.$element
    var o  = this.options

    return $e.attr('data-content')
      || (typeof o.content == 'function' ?
            o.content.call($e[0]) :
            o.content)
  }

  Popover.prototype.arrow = function () {
    return (this.$arrow = this.$arrow || this.tip().find('.arrow'))
  }


  // POPOVER PLUGIN DEFINITION
  // =========================

  function Plugin(option) {
    return this.each(function () {
      var $this   = $(this)
      var data    = $this.data('bs.popover')
      var options = typeof option == 'object' && option

      if (!data && /destroy|hide/.test(option)) return
      if (!data) $this.data('bs.popover', (data = new Popover(this, options)))
      if (typeof option == 'string') data[option]()
    })
  }

  var old = $.fn.popover

  $.fn.popover             = Plugin
  $.fn.popover.Constructor = Popover


  // POPOVER NO CONFLICT
  // ===================

  $.fn.popover.noConflict = function () {
    $.fn.popover = old
    return this
  }

}(jQuery);

},{}],10:[function(require,module,exports){
/* ========================================================================
 * Bootstrap: scrollspy.js v3.3.7
 * http://getbootstrap.com/javascript/#scrollspy
 * ========================================================================
 * Copyright 2011-2016 Twitter, Inc.
 * Licensed under MIT (https://github.com/twbs/bootstrap/blob/master/LICENSE)
 * ======================================================================== */


+function ($) {
  'use strict';

  // SCROLLSPY CLASS DEFINITION
  // ==========================

  function ScrollSpy(element, options) {
    this.$body          = $(document.body)
    this.$scrollElement = $(element).is(document.body) ? $(window) : $(element)
    this.options        = $.extend({}, ScrollSpy.DEFAULTS, options)
    this.selector       = (this.options.target || '') + ' .nav li > a'
    this.offsets        = []
    this.targets        = []
    this.activeTarget   = null
    this.scrollHeight   = 0

    this.$scrollElement.on('scroll.bs.scrollspy', $.proxy(this.process, this))
    this.refresh()
    this.process()
  }

  ScrollSpy.VERSION  = '3.3.7'

  ScrollSpy.DEFAULTS = {
    offset: 10
  }

  ScrollSpy.prototype.getScrollHeight = function () {
    return this.$scrollElement[0].scrollHeight || Math.max(this.$body[0].scrollHeight, document.documentElement.scrollHeight)
  }

  ScrollSpy.prototype.refresh = function () {
    var that          = this
    var offsetMethod  = 'offset'
    var offsetBase    = 0

    this.offsets      = []
    this.targets      = []
    this.scrollHeight = this.getScrollHeight()

    if (!$.isWindow(this.$scrollElement[0])) {
      offsetMethod = 'position'
      offsetBase   = this.$scrollElement.scrollTop()
    }

    this.$body
      .find(this.selector)
      .map(function () {
        var $el   = $(this)
        var href  = $el.data('target') || $el.attr('href')
        var $href = /^#./.test(href) && $(href)

        return ($href
          && $href.length
          && $href.is(':visible')
          && [[$href[offsetMethod]().top + offsetBase, href]]) || null
      })
      .sort(function (a, b) { return a[0] - b[0] })
      .each(function () {
        that.offsets.push(this[0])
        that.targets.push(this[1])
      })
  }

  ScrollSpy.prototype.process = function () {
    var scrollTop    = this.$scrollElement.scrollTop() + this.options.offset
    var scrollHeight = this.getScrollHeight()
    var maxScroll    = this.options.offset + scrollHeight - this.$scrollElement.height()
    var offsets      = this.offsets
    var targets      = this.targets
    var activeTarget = this.activeTarget
    var i

    if (this.scrollHeight != scrollHeight) {
      this.refresh()
    }

    if (scrollTop >= maxScroll) {
      return activeTarget != (i = targets[targets.length - 1]) && this.activate(i)
    }

    if (activeTarget && scrollTop < offsets[0]) {
      this.activeTarget = null
      return this.clear()
    }

    for (i = offsets.length; i--;) {
      activeTarget != targets[i]
        && scrollTop >= offsets[i]
        && (offsets[i + 1] === undefined || scrollTop < offsets[i + 1])
        && this.activate(targets[i])
    }
  }

  ScrollSpy.prototype.activate = function (target) {
    this.activeTarget = target

    this.clear()

    var selector = this.selector +
      '[data-target="' + target + '"],' +
      this.selector + '[href="' + target + '"]'

    var active = $(selector)
      .parents('li')
      .addClass('active')

    if (active.parent('.dropdown-menu').length) {
      active = active
        .closest('li.dropdown')
        .addClass('active')
    }

    active.trigger('activate.bs.scrollspy')
  }

  ScrollSpy.prototype.clear = function () {
    $(this.selector)
      .parentsUntil(this.options.target, '.active')
      .removeClass('active')
  }


  // SCROLLSPY PLUGIN DEFINITION
  // ===========================

  function Plugin(option) {
    return this.each(function () {
      var $this   = $(this)
      var data    = $this.data('bs.scrollspy')
      var options = typeof option == 'object' && option

      if (!data) $this.data('bs.scrollspy', (data = new ScrollSpy(this, options)))
      if (typeof option == 'string') data[option]()
    })
  }

  var old = $.fn.scrollspy

  $.fn.scrollspy             = Plugin
  $.fn.scrollspy.Constructor = ScrollSpy


  // SCROLLSPY NO CONFLICT
  // =====================

  $.fn.scrollspy.noConflict = function () {
    $.fn.scrollspy = old
    return this
  }


  // SCROLLSPY DATA-API
  // ==================

  $(window).on('load.bs.scrollspy.data-api', function () {
    $('[data-spy="scroll"]').each(function () {
      var $spy = $(this)
      Plugin.call($spy, $spy.data())
    })
  })

}(jQuery);

},{}],11:[function(require,module,exports){
/* ========================================================================
 * Bootstrap: tab.js v3.3.7
 * http://getbootstrap.com/javascript/#tabs
 * ========================================================================
 * Copyright 2011-2016 Twitter, Inc.
 * Licensed under MIT (https://github.com/twbs/bootstrap/blob/master/LICENSE)
 * ======================================================================== */


+function ($) {
  'use strict';

  // TAB CLASS DEFINITION
  // ====================

  var Tab = function (element) {
    // jscs:disable requireDollarBeforejQueryAssignment
    this.element = $(element)
    // jscs:enable requireDollarBeforejQueryAssignment
  }

  Tab.VERSION = '3.3.7'

  Tab.TRANSITION_DURATION = 150

  Tab.prototype.show = function () {
    var $this    = this.element
    var $ul      = $this.closest('ul:not(.dropdown-menu)')
    var selector = $this.data('target')

    if (!selector) {
      selector = $this.attr('href')
      selector = selector && selector.replace(/.*(?=#[^\s]*$)/, '') // strip for ie7
    }

    if ($this.parent('li').hasClass('active')) return

    var $previous = $ul.find('.active:last a')
    var hideEvent = $.Event('hide.bs.tab', {
      relatedTarget: $this[0]
    })
    var showEvent = $.Event('show.bs.tab', {
      relatedTarget: $previous[0]
    })

    $previous.trigger(hideEvent)
    $this.trigger(showEvent)

    if (showEvent.isDefaultPrevented() || hideEvent.isDefaultPrevented()) return

    var $target = $(selector)

    this.activate($this.closest('li'), $ul)
    this.activate($target, $target.parent(), function () {
      $previous.trigger({
        type: 'hidden.bs.tab',
        relatedTarget: $this[0]
      })
      $this.trigger({
        type: 'shown.bs.tab',
        relatedTarget: $previous[0]
      })
    })
  }

  Tab.prototype.activate = function (element, container, callback) {
    var $active    = container.find('> .active')
    var transition = callback
      && $.support.transition
      && ($active.length && $active.hasClass('fade') || !!container.find('> .fade').length)

    function next() {
      $active
        .removeClass('active')
        .find('> .dropdown-menu > .active')
          .removeClass('active')
        .end()
        .find('[data-toggle="tab"]')
          .attr('aria-expanded', false)

      element
        .addClass('active')
        .find('[data-toggle="tab"]')
          .attr('aria-expanded', true)

      if (transition) {
        element[0].offsetWidth // reflow for transition
        element.addClass('in')
      } else {
        element.removeClass('fade')
      }

      if (element.parent('.dropdown-menu').length) {
        element
          .closest('li.dropdown')
            .addClass('active')
          .end()
          .find('[data-toggle="tab"]')
            .attr('aria-expanded', true)
      }

      callback && callback()
    }

    $active.length && transition ?
      $active
        .one('bsTransitionEnd', next)
        .emulateTransitionEnd(Tab.TRANSITION_DURATION) :
      next()

    $active.removeClass('in')
  }


  // TAB PLUGIN DEFINITION
  // =====================

  function Plugin(option) {
    return this.each(function () {
      var $this = $(this)
      var data  = $this.data('bs.tab')

      if (!data) $this.data('bs.tab', (data = new Tab(this)))
      if (typeof option == 'string') data[option]()
    })
  }

  var old = $.fn.tab

  $.fn.tab             = Plugin
  $.fn.tab.Constructor = Tab


  // TAB NO CONFLICT
  // ===============

  $.fn.tab.noConflict = function () {
    $.fn.tab = old
    return this
  }


  // TAB DATA-API
  // ============

  var clickHandler = function (e) {
    e.preventDefault()
    Plugin.call($(this), 'show')
  }

  $(document)
    .on('click.bs.tab.data-api', '[data-toggle="tab"]', clickHandler)
    .on('click.bs.tab.data-api', '[data-toggle="pill"]', clickHandler)

}(jQuery);

},{}],12:[function(require,module,exports){
/* ========================================================================
 * Bootstrap: tooltip.js v3.3.7
 * http://getbootstrap.com/javascript/#tooltip
 * Inspired by the original jQuery.tipsy by Jason Frame
 * ========================================================================
 * Copyright 2011-2016 Twitter, Inc.
 * Licensed under MIT (https://github.com/twbs/bootstrap/blob/master/LICENSE)
 * ======================================================================== */


+function ($) {
  'use strict';

  // TOOLTIP PUBLIC CLASS DEFINITION
  // ===============================

  var Tooltip = function (element, options) {
    this.type       = null
    this.options    = null
    this.enabled    = null
    this.timeout    = null
    this.hoverState = null
    this.$element   = null
    this.inState    = null

    this.init('tooltip', element, options)
  }

  Tooltip.VERSION  = '3.3.7'

  Tooltip.TRANSITION_DURATION = 150

  Tooltip.DEFAULTS = {
    animation: true,
    placement: 'top',
    selector: false,
    template: '<div class="tooltip" role="tooltip"><div class="tooltip-arrow"></div><div class="tooltip-inner"></div></div>',
    trigger: 'hover focus',
    title: '',
    delay: 0,
    html: false,
    container: false,
    viewport: {
      selector: 'body',
      padding: 0
    }
  }

  Tooltip.prototype.init = function (type, element, options) {
    this.enabled   = true
    this.type      = type
    this.$element  = $(element)
    this.options   = this.getOptions(options)
    this.$viewport = this.options.viewport && $($.isFunction(this.options.viewport) ? this.options.viewport.call(this, this.$element) : (this.options.viewport.selector || this.options.viewport))
    this.inState   = { click: false, hover: false, focus: false }

    if (this.$element[0] instanceof document.constructor && !this.options.selector) {
      throw new Error('`selector` option must be specified when initializing ' + this.type + ' on the window.document object!')
    }

    var triggers = this.options.trigger.split(' ')

    for (var i = triggers.length; i--;) {
      var trigger = triggers[i]

      if (trigger == 'click') {
        this.$element.on('click.' + this.type, this.options.selector, $.proxy(this.toggle, this))
      } else if (trigger != 'manual') {
        var eventIn  = trigger == 'hover' ? 'mouseenter' : 'focusin'
        var eventOut = trigger == 'hover' ? 'mouseleave' : 'focusout'

        this.$element.on(eventIn  + '.' + this.type, this.options.selector, $.proxy(this.enter, this))
        this.$element.on(eventOut + '.' + this.type, this.options.selector, $.proxy(this.leave, this))
      }
    }

    this.options.selector ?
      (this._options = $.extend({}, this.options, { trigger: 'manual', selector: '' })) :
      this.fixTitle()
  }

  Tooltip.prototype.getDefaults = function () {
    return Tooltip.DEFAULTS
  }

  Tooltip.prototype.getOptions = function (options) {
    options = $.extend({}, this.getDefaults(), this.$element.data(), options)

    if (options.delay && typeof options.delay == 'number') {
      options.delay = {
        show: options.delay,
        hide: options.delay
      }
    }

    return options
  }

  Tooltip.prototype.getDelegateOptions = function () {
    var options  = {}
    var defaults = this.getDefaults()

    this._options && $.each(this._options, function (key, value) {
      if (defaults[key] != value) options[key] = value
    })

    return options
  }

  Tooltip.prototype.enter = function (obj) {
    var self = obj instanceof this.constructor ?
      obj : $(obj.currentTarget).data('bs.' + this.type)

    if (!self) {
      self = new this.constructor(obj.currentTarget, this.getDelegateOptions())
      $(obj.currentTarget).data('bs.' + this.type, self)
    }

    if (obj instanceof $.Event) {
      self.inState[obj.type == 'focusin' ? 'focus' : 'hover'] = true
    }

    if (self.tip().hasClass('in') || self.hoverState == 'in') {
      self.hoverState = 'in'
      return
    }

    clearTimeout(self.timeout)

    self.hoverState = 'in'

    if (!self.options.delay || !self.options.delay.show) return self.show()

    self.timeout = setTimeout(function () {
      if (self.hoverState == 'in') self.show()
    }, self.options.delay.show)
  }

  Tooltip.prototype.isInStateTrue = function () {
    for (var key in this.inState) {
      if (this.inState[key]) return true
    }

    return false
  }

  Tooltip.prototype.leave = function (obj) {
    var self = obj instanceof this.constructor ?
      obj : $(obj.currentTarget).data('bs.' + this.type)

    if (!self) {
      self = new this.constructor(obj.currentTarget, this.getDelegateOptions())
      $(obj.currentTarget).data('bs.' + this.type, self)
    }

    if (obj instanceof $.Event) {
      self.inState[obj.type == 'focusout' ? 'focus' : 'hover'] = false
    }

    if (self.isInStateTrue()) return

    clearTimeout(self.timeout)

    self.hoverState = 'out'

    if (!self.options.delay || !self.options.delay.hide) return self.hide()

    self.timeout = setTimeout(function () {
      if (self.hoverState == 'out') self.hide()
    }, self.options.delay.hide)
  }

  Tooltip.prototype.show = function () {
    var e = $.Event('show.bs.' + this.type)

    if (this.hasContent() && this.enabled) {
      this.$element.trigger(e)

      var inDom = $.contains(this.$element[0].ownerDocument.documentElement, this.$element[0])
      if (e.isDefaultPrevented() || !inDom) return
      var that = this

      var $tip = this.tip()

      var tipId = this.getUID(this.type)

      this.setContent()
      $tip.attr('id', tipId)
      this.$element.attr('aria-describedby', tipId)

      if (this.options.animation) $tip.addClass('fade')

      var placement = typeof this.options.placement == 'function' ?
        this.options.placement.call(this, $tip[0], this.$element[0]) :
        this.options.placement

      var autoToken = /\s?auto?\s?/i
      var autoPlace = autoToken.test(placement)
      if (autoPlace) placement = placement.replace(autoToken, '') || 'top'

      $tip
        .detach()
        .css({ top: 0, left: 0, display: 'block' })
        .addClass(placement)
        .data('bs.' + this.type, this)

      this.options.container ? $tip.appendTo(this.options.container) : $tip.insertAfter(this.$element)
      this.$element.trigger('inserted.bs.' + this.type)

      var pos          = this.getPosition()
      var actualWidth  = $tip[0].offsetWidth
      var actualHeight = $tip[0].offsetHeight

      if (autoPlace) {
        var orgPlacement = placement
        var viewportDim = this.getPosition(this.$viewport)

        placement = placement == 'bottom' && pos.bottom + actualHeight > viewportDim.bottom ? 'top'    :
                    placement == 'top'    && pos.top    - actualHeight < viewportDim.top    ? 'bottom' :
                    placement == 'right'  && pos.right  + actualWidth  > viewportDim.width  ? 'left'   :
                    placement == 'left'   && pos.left   - actualWidth  < viewportDim.left   ? 'right'  :
                    placement

        $tip
          .removeClass(orgPlacement)
          .addClass(placement)
      }

      var calculatedOffset = this.getCalculatedOffset(placement, pos, actualWidth, actualHeight)

      this.applyPlacement(calculatedOffset, placement)

      var complete = function () {
        var prevHoverState = that.hoverState
        that.$element.trigger('shown.bs.' + that.type)
        that.hoverState = null

        if (prevHoverState == 'out') that.leave(that)
      }

      $.support.transition && this.$tip.hasClass('fade') ?
        $tip
          .one('bsTransitionEnd', complete)
          .emulateTransitionEnd(Tooltip.TRANSITION_DURATION) :
        complete()
    }
  }

  Tooltip.prototype.applyPlacement = function (offset, placement) {
    var $tip   = this.tip()
    var width  = $tip[0].offsetWidth
    var height = $tip[0].offsetHeight

    // manually read margins because getBoundingClientRect includes difference
    var marginTop = parseInt($tip.css('margin-top'), 10)
    var marginLeft = parseInt($tip.css('margin-left'), 10)

    // we must check for NaN for ie 8/9
    if (isNaN(marginTop))  marginTop  = 0
    if (isNaN(marginLeft)) marginLeft = 0

    offset.top  += marginTop
    offset.left += marginLeft

    // $.fn.offset doesn't round pixel values
    // so we use setOffset directly with our own function B-0
    $.offset.setOffset($tip[0], $.extend({
      using: function (props) {
        $tip.css({
          top: Math.round(props.top),
          left: Math.round(props.left)
        })
      }
    }, offset), 0)

    $tip.addClass('in')

    // check to see if placing tip in new offset caused the tip to resize itself
    var actualWidth  = $tip[0].offsetWidth
    var actualHeight = $tip[0].offsetHeight

    if (placement == 'top' && actualHeight != height) {
      offset.top = offset.top + height - actualHeight
    }

    var delta = this.getViewportAdjustedDelta(placement, offset, actualWidth, actualHeight)

    if (delta.left) offset.left += delta.left
    else offset.top += delta.top

    var isVertical          = /top|bottom/.test(placement)
    var arrowDelta          = isVertical ? delta.left * 2 - width + actualWidth : delta.top * 2 - height + actualHeight
    var arrowOffsetPosition = isVertical ? 'offsetWidth' : 'offsetHeight'

    $tip.offset(offset)
    this.replaceArrow(arrowDelta, $tip[0][arrowOffsetPosition], isVertical)
  }

  Tooltip.prototype.replaceArrow = function (delta, dimension, isVertical) {
    this.arrow()
      .css(isVertical ? 'left' : 'top', 50 * (1 - delta / dimension) + '%')
      .css(isVertical ? 'top' : 'left', '')
  }

  Tooltip.prototype.setContent = function () {
    var $tip  = this.tip()
    var title = this.getTitle()

    $tip.find('.tooltip-inner')[this.options.html ? 'html' : 'text'](title)
    $tip.removeClass('fade in top bottom left right')
  }

  Tooltip.prototype.hide = function (callback) {
    var that = this
    var $tip = $(this.$tip)
    var e    = $.Event('hide.bs.' + this.type)

    function complete() {
      if (that.hoverState != 'in') $tip.detach()
      if (that.$element) { // TODO: Check whether guarding this code with this `if` is really necessary.
        that.$element
          .removeAttr('aria-describedby')
          .trigger('hidden.bs.' + that.type)
      }
      callback && callback()
    }

    this.$element.trigger(e)

    if (e.isDefaultPrevented()) return

    $tip.removeClass('in')

    $.support.transition && $tip.hasClass('fade') ?
      $tip
        .one('bsTransitionEnd', complete)
        .emulateTransitionEnd(Tooltip.TRANSITION_DURATION) :
      complete()

    this.hoverState = null

    return this
  }

  Tooltip.prototype.fixTitle = function () {
    var $e = this.$element
    if ($e.attr('title') || typeof $e.attr('data-original-title') != 'string') {
      $e.attr('data-original-title', $e.attr('title') || '').attr('title', '')
    }
  }

  Tooltip.prototype.hasContent = function () {
    return this.getTitle()
  }

  Tooltip.prototype.getPosition = function ($element) {
    $element   = $element || this.$element

    var el     = $element[0]
    var isBody = el.tagName == 'BODY'

    var elRect    = el.getBoundingClientRect()
    if (elRect.width == null) {
      // width and height are missing in IE8, so compute them manually; see https://github.com/twbs/bootstrap/issues/14093
      elRect = $.extend({}, elRect, { width: elRect.right - elRect.left, height: elRect.bottom - elRect.top })
    }
    var isSvg = window.SVGElement && el instanceof window.SVGElement
    // Avoid using $.offset() on SVGs since it gives incorrect results in jQuery 3.
    // See https://github.com/twbs/bootstrap/issues/20280
    var elOffset  = isBody ? { top: 0, left: 0 } : (isSvg ? null : $element.offset())
    var scroll    = { scroll: isBody ? document.documentElement.scrollTop || document.body.scrollTop : $element.scrollTop() }
    var outerDims = isBody ? { width: $(window).width(), height: $(window).height() } : null

    return $.extend({}, elRect, scroll, outerDims, elOffset)
  }

  Tooltip.prototype.getCalculatedOffset = function (placement, pos, actualWidth, actualHeight) {
    return placement == 'bottom' ? { top: pos.top + pos.height,   left: pos.left + pos.width / 2 - actualWidth / 2 } :
           placement == 'top'    ? { top: pos.top - actualHeight, left: pos.left + pos.width / 2 - actualWidth / 2 } :
           placement == 'left'   ? { top: pos.top + pos.height / 2 - actualHeight / 2, left: pos.left - actualWidth } :
        /* placement == 'right' */ { top: pos.top + pos.height / 2 - actualHeight / 2, left: pos.left + pos.width }

  }

  Tooltip.prototype.getViewportAdjustedDelta = function (placement, pos, actualWidth, actualHeight) {
    var delta = { top: 0, left: 0 }
    if (!this.$viewport) return delta

    var viewportPadding = this.options.viewport && this.options.viewport.padding || 0
    var viewportDimensions = this.getPosition(this.$viewport)

    if (/right|left/.test(placement)) {
      var topEdgeOffset    = pos.top - viewportPadding - viewportDimensions.scroll
      var bottomEdgeOffset = pos.top + viewportPadding - viewportDimensions.scroll + actualHeight
      if (topEdgeOffset < viewportDimensions.top) { // top overflow
        delta.top = viewportDimensions.top - topEdgeOffset
      } else if (bottomEdgeOffset > viewportDimensions.top + viewportDimensions.height) { // bottom overflow
        delta.top = viewportDimensions.top + viewportDimensions.height - bottomEdgeOffset
      }
    } else {
      var leftEdgeOffset  = pos.left - viewportPadding
      var rightEdgeOffset = pos.left + viewportPadding + actualWidth
      if (leftEdgeOffset < viewportDimensions.left) { // left overflow
        delta.left = viewportDimensions.left - leftEdgeOffset
      } else if (rightEdgeOffset > viewportDimensions.right) { // right overflow
        delta.left = viewportDimensions.left + viewportDimensions.width - rightEdgeOffset
      }
    }

    return delta
  }

  Tooltip.prototype.getTitle = function () {
    var title
    var $e = this.$element
    var o  = this.options

    title = $e.attr('data-original-title')
      || (typeof o.title == 'function' ? o.title.call($e[0]) :  o.title)

    return title
  }

  Tooltip.prototype.getUID = function (prefix) {
    do prefix += ~~(Math.random() * 1000000)
    while (document.getElementById(prefix))
    return prefix
  }

  Tooltip.prototype.tip = function () {
    if (!this.$tip) {
      this.$tip = $(this.options.template)
      if (this.$tip.length != 1) {
        throw new Error(this.type + ' `template` option must consist of exactly 1 top-level element!')
      }
    }
    return this.$tip
  }

  Tooltip.prototype.arrow = function () {
    return (this.$arrow = this.$arrow || this.tip().find('.tooltip-arrow'))
  }

  Tooltip.prototype.enable = function () {
    this.enabled = true
  }

  Tooltip.prototype.disable = function () {
    this.enabled = false
  }

  Tooltip.prototype.toggleEnabled = function () {
    this.enabled = !this.enabled
  }

  Tooltip.prototype.toggle = function (e) {
    var self = this
    if (e) {
      self = $(e.currentTarget).data('bs.' + this.type)
      if (!self) {
        self = new this.constructor(e.currentTarget, this.getDelegateOptions())
        $(e.currentTarget).data('bs.' + this.type, self)
      }
    }

    if (e) {
      self.inState.click = !self.inState.click
      if (self.isInStateTrue()) self.enter(self)
      else self.leave(self)
    } else {
      self.tip().hasClass('in') ? self.leave(self) : self.enter(self)
    }
  }

  Tooltip.prototype.destroy = function () {
    var that = this
    clearTimeout(this.timeout)
    this.hide(function () {
      that.$element.off('.' + that.type).removeData('bs.' + that.type)
      if (that.$tip) {
        that.$tip.detach()
      }
      that.$tip = null
      that.$arrow = null
      that.$viewport = null
      that.$element = null
    })
  }


  // TOOLTIP PLUGIN DEFINITION
  // =========================

  function Plugin(option) {
    return this.each(function () {
      var $this   = $(this)
      var data    = $this.data('bs.tooltip')
      var options = typeof option == 'object' && option

      if (!data && /destroy|hide/.test(option)) return
      if (!data) $this.data('bs.tooltip', (data = new Tooltip(this, options)))
      if (typeof option == 'string') data[option]()
    })
  }

  var old = $.fn.tooltip

  $.fn.tooltip             = Plugin
  $.fn.tooltip.Constructor = Tooltip


  // TOOLTIP NO CONFLICT
  // ===================

  $.fn.tooltip.noConflict = function () {
    $.fn.tooltip = old
    return this
  }

}(jQuery);

},{}],13:[function(require,module,exports){
/* ========================================================================
 * Bootstrap: transition.js v3.3.7
 * http://getbootstrap.com/javascript/#transitions
 * ========================================================================
 * Copyright 2011-2016 Twitter, Inc.
 * Licensed under MIT (https://github.com/twbs/bootstrap/blob/master/LICENSE)
 * ======================================================================== */


+function ($) {
  'use strict';

  // CSS TRANSITION SUPPORT (Shoutout: http://www.modernizr.com/)
  // ============================================================

  function transitionEnd() {
    var el = document.createElement('bootstrap')

    var transEndEventNames = {
      WebkitTransition : 'webkitTransitionEnd',
      MozTransition    : 'transitionend',
      OTransition      : 'oTransitionEnd otransitionend',
      transition       : 'transitionend'
    }

    for (var name in transEndEventNames) {
      if (el.style[name] !== undefined) {
        return { end: transEndEventNames[name] }
      }
    }

    return false // explicit for ie8 (  ._.)
  }

  // http://blog.alexmaccaw.com/css-transitions
  $.fn.emulateTransitionEnd = function (duration) {
    var called = false
    var $el = this
    $(this).one('bsTransitionEnd', function () { called = true })
    var callback = function () { if (!called) $($el).trigger($.support.transition.end) }
    setTimeout(callback, duration)
    return this
  }

  $(function () {
    $.support.transition = transitionEnd()

    if (!$.support.transition) return

    $.event.special.bsTransitionEnd = {
      bindType: $.support.transition.end,
      delegateType: $.support.transition.end,
      handle: function (e) {
        if ($(e.target).is(this)) return e.handleObj.handler.apply(this, arguments)
      }
    }
  })

}(jQuery);

},{}],14:[function(require,module,exports){
/*!
 * jQuery UI :data 1.12.0
 * http://jqueryui.com
 *
 * Copyright jQuery Foundation and other contributors
 * Released under the MIT license.
 * http://jquery.org/license
 */

//>>label: :data Selector
//>>group: Core
//>>description: Selects elements which have data stored under the specified key.
//>>docs: http://api.jqueryui.com/data-selector/

( function( factory ) {
	if ( typeof define === "function" && define.amd ) {

		// AMD. Register as an anonymous module.
		define( [ "jquery", "./version" ], factory );
	} else {

		// Browser globals
		factory( jQuery );
	}
} ( function( $ ) {
return $.extend( $.expr[ ":" ], {
	data: $.expr.createPseudo ?
		$.expr.createPseudo( function( dataName ) {
			return function( elem ) {
				return !!$.data( elem, dataName );
			};
		} ) :

		// Support: jQuery <1.8
		function( elem, i, match ) {
			return !!$.data( elem, match[ 3 ] );
		}
} );
} ) );

},{}],15:[function(require,module,exports){
/*!
 * jQuery UI Disable Selection 1.12.0
 * http://jqueryui.com
 *
 * Copyright jQuery Foundation and other contributors
 * Released under the MIT license.
 * http://jquery.org/license
 */

//>>label: disableSelection
//>>group: Core
//>>description: Disable selection of text content within the set of matched elements.
//>>docs: http://api.jqueryui.com/disableSelection/

// This file is deprecated
( function( factory ) {
	if ( typeof define === "function" && define.amd ) {

		// AMD. Register as an anonymous module.
		define( [ "jquery", "./version" ], factory );
	} else {

		// Browser globals
		factory( jQuery );
	}
} ( function( $ ) {

return $.fn.extend( {
	disableSelection: ( function() {
		var eventType = "onselectstart" in document.createElement( "div" ) ?
			"selectstart" :
			"mousedown";

		return function() {
			return this.on( eventType + ".ui-disableSelection", function( event ) {
				event.preventDefault();
			} );
		};
	} )(),

	enableSelection: function() {
		return this.off( ".ui-disableSelection" );
	}
} );

} ) );

},{}],16:[function(require,module,exports){
/*!
 * jQuery UI Focusable 1.12.0
 * http://jqueryui.com
 *
 * Copyright jQuery Foundation and other contributors
 * Released under the MIT license.
 * http://jquery.org/license
 */

//>>label: :focusable Selector
//>>group: Core
//>>description: Selects elements which can be focused.
//>>docs: http://api.jqueryui.com/focusable-selector/

( function( factory ) {
	if ( typeof define === "function" && define.amd ) {

		// AMD. Register as an anonymous module.
		define( [ "jquery", "./version" ], factory );
	} else {

		// Browser globals
		factory( jQuery );
	}
} ( function( $ ) {

// Selectors
$.ui.focusable = function( element, hasTabindex ) {
	var map, mapName, img, focusableIfVisible, fieldset,
		nodeName = element.nodeName.toLowerCase();

	if ( "area" === nodeName ) {
		map = element.parentNode;
		mapName = map.name;
		if ( !element.href || !mapName || map.nodeName.toLowerCase() !== "map" ) {
			return false;
		}
		img = $( "img[usemap='#" + mapName + "']" );
		return img.length > 0 && img.is( ":visible" );
	}

	if ( /^(input|select|textarea|button|object)$/.test( nodeName ) ) {
		focusableIfVisible = !element.disabled;

		if ( focusableIfVisible ) {

			// Form controls within a disabled fieldset are disabled.
			// However, controls within the fieldset's legend do not get disabled.
			// Since controls generally aren't placed inside legends, we skip
			// this portion of the check.
			fieldset = $( element ).closest( "fieldset" )[ 0 ];
			if ( fieldset ) {
				focusableIfVisible = !fieldset.disabled;
			}
		}
	} else if ( "a" === nodeName ) {
		focusableIfVisible = element.href || hasTabindex;
	} else {
		focusableIfVisible = hasTabindex;
	}

	return focusableIfVisible && $( element ).is( ":visible" ) && visible( $( element ) );
};

// Support: IE 8 only
// IE 8 doesn't resolve inherit to visible/hidden for computed values
function visible( element ) {
	var visibility = element.css( "visibility" );
	while ( visibility === "inherit" ) {
		element = element.parent();
		visibility = element.css( "visibility" );
	}
	return visibility !== "hidden";
}

$.extend( $.expr[ ":" ], {
	focusable: function( element ) {
		return $.ui.focusable( element, $.attr( element, "tabindex" ) != null );
	}
} );

return $.ui.focusable;

} ) );

},{}],17:[function(require,module,exports){
( function( factory ) {
	if ( typeof define === "function" && define.amd ) {

		// AMD. Register as an anonymous module.
		define( [ "jquery", "./version" ], factory );
	} else {

		// Browser globals
		factory( jQuery );
	}
} ( function( $ ) {

// This file is deprecated
return $.ui.ie = !!/msie [\w.]+/.exec( navigator.userAgent.toLowerCase() );
} ) );

},{}],18:[function(require,module,exports){
/*!
 * jQuery UI Keycode 1.12.0
 * http://jqueryui.com
 *
 * Copyright jQuery Foundation and other contributors
 * Released under the MIT license.
 * http://jquery.org/license
 */

//>>label: Keycode
//>>group: Core
//>>description: Provide keycodes as keynames
//>>docs: http://api.jqueryui.com/jQuery.ui.keyCode/

( function( factory ) {
	if ( typeof define === "function" && define.amd ) {

		// AMD. Register as an anonymous module.
		define( [ "jquery", "./version" ], factory );
	} else {

		// Browser globals
		factory( jQuery );
	}
} ( function( $ ) {
return $.ui.keyCode = {
	BACKSPACE: 8,
	COMMA: 188,
	DELETE: 46,
	DOWN: 40,
	END: 35,
	ENTER: 13,
	ESCAPE: 27,
	HOME: 36,
	LEFT: 37,
	PAGE_DOWN: 34,
	PAGE_UP: 33,
	PERIOD: 190,
	RIGHT: 39,
	SPACE: 32,
	TAB: 9,
	UP: 38
};

} ) );

},{}],19:[function(require,module,exports){
( function( factory ) {
	if ( typeof define === "function" && define.amd ) {

		// AMD. Register as an anonymous module.
		define( [ "jquery", "./version" ], factory );
	} else {

		// Browser globals
		factory( jQuery );
	}
} ( function( $ ) {

// $.ui.plugin is deprecated. Use $.widget() extensions instead.
return $.ui.plugin = {
	add: function( module, option, set ) {
		var i,
			proto = $.ui[ module ].prototype;
		for ( i in set ) {
			proto.plugins[ i ] = proto.plugins[ i ] || [];
			proto.plugins[ i ].push( [ option, set[ i ] ] );
		}
	},
	call: function( instance, name, args, allowDisconnected ) {
		var i,
			set = instance.plugins[ name ];

		if ( !set ) {
			return;
		}

		if ( !allowDisconnected && ( !instance.element[ 0 ].parentNode ||
				instance.element[ 0 ].parentNode.nodeType === 11 ) ) {
			return;
		}

		for ( i = 0; i < set.length; i++ ) {
			if ( instance.options[ set[ i ][ 0 ] ] ) {
				set[ i ][ 1 ].apply( instance.element, args );
			}
		}
	}
};

} ) );

},{}],20:[function(require,module,exports){
/*!
 * jQuery UI Position 1.12.0
 * http://jqueryui.com
 *
 * Copyright jQuery Foundation and other contributors
 * Released under the MIT license.
 * http://jquery.org/license
 *
 * http://api.jqueryui.com/position/
 */

//>>label: Position
//>>group: Core
//>>description: Positions elements relative to other elements.
//>>docs: http://api.jqueryui.com/position/
//>>demos: http://jqueryui.com/position/

( function( factory ) {
	if ( typeof define === "function" && define.amd ) {

		// AMD. Register as an anonymous module.
		define( [ "jquery", "./version" ], factory );
	} else {

		// Browser globals
		factory( jQuery );
	}
}( function( $ ) {
( function() {
var cachedScrollbarWidth, supportsOffsetFractions,
	max = Math.max,
	abs = Math.abs,
	round = Math.round,
	rhorizontal = /left|center|right/,
	rvertical = /top|center|bottom/,
	roffset = /[\+\-]\d+(\.[\d]+)?%?/,
	rposition = /^\w+/,
	rpercent = /%$/,
	_position = $.fn.position;

// Support: IE <=9 only
supportsOffsetFractions = function() {
	var element = $( "<div>" )
			.css( "position", "absolute" )
			.appendTo( "body" )
			.offset( {
				top: 1.5,
				left: 1.5
			} ),
		support = element.offset().top === 1.5;

	element.remove();

	supportsOffsetFractions = function() {
		return support;
	};

	return support;
};

function getOffsets( offsets, width, height ) {
	return [
		parseFloat( offsets[ 0 ] ) * ( rpercent.test( offsets[ 0 ] ) ? width / 100 : 1 ),
		parseFloat( offsets[ 1 ] ) * ( rpercent.test( offsets[ 1 ] ) ? height / 100 : 1 )
	];
}

function parseCss( element, property ) {
	return parseInt( $.css( element, property ), 10 ) || 0;
}

function getDimensions( elem ) {
	var raw = elem[ 0 ];
	if ( raw.nodeType === 9 ) {
		return {
			width: elem.width(),
			height: elem.height(),
			offset: { top: 0, left: 0 }
		};
	}
	if ( $.isWindow( raw ) ) {
		return {
			width: elem.width(),
			height: elem.height(),
			offset: { top: elem.scrollTop(), left: elem.scrollLeft() }
		};
	}
	if ( raw.preventDefault ) {
		return {
			width: 0,
			height: 0,
			offset: { top: raw.pageY, left: raw.pageX }
		};
	}
	return {
		width: elem.outerWidth(),
		height: elem.outerHeight(),
		offset: elem.offset()
	};
}

$.position = {
	scrollbarWidth: function() {
		if ( cachedScrollbarWidth !== undefined ) {
			return cachedScrollbarWidth;
		}
		var w1, w2,
			div = $( "<div " +
				"style='display:block;position:absolute;width:50px;height:50px;overflow:hidden;'>" +
				"<div style='height:100px;width:auto;'></div></div>" ),
			innerDiv = div.children()[ 0 ];

		$( "body" ).append( div );
		w1 = innerDiv.offsetWidth;
		div.css( "overflow", "scroll" );

		w2 = innerDiv.offsetWidth;

		if ( w1 === w2 ) {
			w2 = div[ 0 ].clientWidth;
		}

		div.remove();

		return ( cachedScrollbarWidth = w1 - w2 );
	},
	getScrollInfo: function( within ) {
		var overflowX = within.isWindow || within.isDocument ? "" :
				within.element.css( "overflow-x" ),
			overflowY = within.isWindow || within.isDocument ? "" :
				within.element.css( "overflow-y" ),
			hasOverflowX = overflowX === "scroll" ||
				( overflowX === "auto" && within.width < within.element[ 0 ].scrollWidth ),
			hasOverflowY = overflowY === "scroll" ||
				( overflowY === "auto" && within.height < within.element[ 0 ].scrollHeight );
		return {
			width: hasOverflowY ? $.position.scrollbarWidth() : 0,
			height: hasOverflowX ? $.position.scrollbarWidth() : 0
		};
	},
	getWithinInfo: function( element ) {
		var withinElement = $( element || window ),
			isWindow = $.isWindow( withinElement[ 0 ] ),
			isDocument = !!withinElement[ 0 ] && withinElement[ 0 ].nodeType === 9,
			hasOffset = !isWindow && !isDocument;
		return {
			element: withinElement,
			isWindow: isWindow,
			isDocument: isDocument,
			offset: hasOffset ? $( element ).offset() : { left: 0, top: 0 },
			scrollLeft: withinElement.scrollLeft(),
			scrollTop: withinElement.scrollTop(),
			width: withinElement.outerWidth(),
			height: withinElement.outerHeight()
		};
	}
};

$.fn.position = function( options ) {
	if ( !options || !options.of ) {
		return _position.apply( this, arguments );
	}

	// Make a copy, we don't want to modify arguments
	options = $.extend( {}, options );

	var atOffset, targetWidth, targetHeight, targetOffset, basePosition, dimensions,
		target = $( options.of ),
		within = $.position.getWithinInfo( options.within ),
		scrollInfo = $.position.getScrollInfo( within ),
		collision = ( options.collision || "flip" ).split( " " ),
		offsets = {};

	dimensions = getDimensions( target );
	if ( target[ 0 ].preventDefault ) {

		// Force left top to allow flipping
		options.at = "left top";
	}
	targetWidth = dimensions.width;
	targetHeight = dimensions.height;
	targetOffset = dimensions.offset;

	// Clone to reuse original targetOffset later
	basePosition = $.extend( {}, targetOffset );

	// Force my and at to have valid horizontal and vertical positions
	// if a value is missing or invalid, it will be converted to center
	$.each( [ "my", "at" ], function() {
		var pos = ( options[ this ] || "" ).split( " " ),
			horizontalOffset,
			verticalOffset;

		if ( pos.length === 1 ) {
			pos = rhorizontal.test( pos[ 0 ] ) ?
				pos.concat( [ "center" ] ) :
				rvertical.test( pos[ 0 ] ) ?
					[ "center" ].concat( pos ) :
					[ "center", "center" ];
		}
		pos[ 0 ] = rhorizontal.test( pos[ 0 ] ) ? pos[ 0 ] : "center";
		pos[ 1 ] = rvertical.test( pos[ 1 ] ) ? pos[ 1 ] : "center";

		// Calculate offsets
		horizontalOffset = roffset.exec( pos[ 0 ] );
		verticalOffset = roffset.exec( pos[ 1 ] );
		offsets[ this ] = [
			horizontalOffset ? horizontalOffset[ 0 ] : 0,
			verticalOffset ? verticalOffset[ 0 ] : 0
		];

		// Reduce to just the positions without the offsets
		options[ this ] = [
			rposition.exec( pos[ 0 ] )[ 0 ],
			rposition.exec( pos[ 1 ] )[ 0 ]
		];
	} );

	// Normalize collision option
	if ( collision.length === 1 ) {
		collision[ 1 ] = collision[ 0 ];
	}

	if ( options.at[ 0 ] === "right" ) {
		basePosition.left += targetWidth;
	} else if ( options.at[ 0 ] === "center" ) {
		basePosition.left += targetWidth / 2;
	}

	if ( options.at[ 1 ] === "bottom" ) {
		basePosition.top += targetHeight;
	} else if ( options.at[ 1 ] === "center" ) {
		basePosition.top += targetHeight / 2;
	}

	atOffset = getOffsets( offsets.at, targetWidth, targetHeight );
	basePosition.left += atOffset[ 0 ];
	basePosition.top += atOffset[ 1 ];

	return this.each( function() {
		var collisionPosition, using,
			elem = $( this ),
			elemWidth = elem.outerWidth(),
			elemHeight = elem.outerHeight(),
			marginLeft = parseCss( this, "marginLeft" ),
			marginTop = parseCss( this, "marginTop" ),
			collisionWidth = elemWidth + marginLeft + parseCss( this, "marginRight" ) +
				scrollInfo.width,
			collisionHeight = elemHeight + marginTop + parseCss( this, "marginBottom" ) +
				scrollInfo.height,
			position = $.extend( {}, basePosition ),
			myOffset = getOffsets( offsets.my, elem.outerWidth(), elem.outerHeight() );

		if ( options.my[ 0 ] === "right" ) {
			position.left -= elemWidth;
		} else if ( options.my[ 0 ] === "center" ) {
			position.left -= elemWidth / 2;
		}

		if ( options.my[ 1 ] === "bottom" ) {
			position.top -= elemHeight;
		} else if ( options.my[ 1 ] === "center" ) {
			position.top -= elemHeight / 2;
		}

		position.left += myOffset[ 0 ];
		position.top += myOffset[ 1 ];

		// If the browser doesn't support fractions, then round for consistent results
		if ( !supportsOffsetFractions() ) {
			position.left = round( position.left );
			position.top = round( position.top );
		}

		collisionPosition = {
			marginLeft: marginLeft,
			marginTop: marginTop
		};

		$.each( [ "left", "top" ], function( i, dir ) {
			if ( $.ui.position[ collision[ i ] ] ) {
				$.ui.position[ collision[ i ] ][ dir ]( position, {
					targetWidth: targetWidth,
					targetHeight: targetHeight,
					elemWidth: elemWidth,
					elemHeight: elemHeight,
					collisionPosition: collisionPosition,
					collisionWidth: collisionWidth,
					collisionHeight: collisionHeight,
					offset: [ atOffset[ 0 ] + myOffset[ 0 ], atOffset [ 1 ] + myOffset[ 1 ] ],
					my: options.my,
					at: options.at,
					within: within,
					elem: elem
				} );
			}
		} );

		if ( options.using ) {

			// Adds feedback as second argument to using callback, if present
			using = function( props ) {
				var left = targetOffset.left - position.left,
					right = left + targetWidth - elemWidth,
					top = targetOffset.top - position.top,
					bottom = top + targetHeight - elemHeight,
					feedback = {
						target: {
							element: target,
							left: targetOffset.left,
							top: targetOffset.top,
							width: targetWidth,
							height: targetHeight
						},
						element: {
							element: elem,
							left: position.left,
							top: position.top,
							width: elemWidth,
							height: elemHeight
						},
						horizontal: right < 0 ? "left" : left > 0 ? "right" : "center",
						vertical: bottom < 0 ? "top" : top > 0 ? "bottom" : "middle"
					};
				if ( targetWidth < elemWidth && abs( left + right ) < targetWidth ) {
					feedback.horizontal = "center";
				}
				if ( targetHeight < elemHeight && abs( top + bottom ) < targetHeight ) {
					feedback.vertical = "middle";
				}
				if ( max( abs( left ), abs( right ) ) > max( abs( top ), abs( bottom ) ) ) {
					feedback.important = "horizontal";
				} else {
					feedback.important = "vertical";
				}
				options.using.call( this, props, feedback );
			};
		}

		elem.offset( $.extend( position, { using: using } ) );
	} );
};

$.ui.position = {
	fit: {
		left: function( position, data ) {
			var within = data.within,
				withinOffset = within.isWindow ? within.scrollLeft : within.offset.left,
				outerWidth = within.width,
				collisionPosLeft = position.left - data.collisionPosition.marginLeft,
				overLeft = withinOffset - collisionPosLeft,
				overRight = collisionPosLeft + data.collisionWidth - outerWidth - withinOffset,
				newOverRight;

			// Element is wider than within
			if ( data.collisionWidth > outerWidth ) {

				// Element is initially over the left side of within
				if ( overLeft > 0 && overRight <= 0 ) {
					newOverRight = position.left + overLeft + data.collisionWidth - outerWidth -
						withinOffset;
					position.left += overLeft - newOverRight;

				// Element is initially over right side of within
				} else if ( overRight > 0 && overLeft <= 0 ) {
					position.left = withinOffset;

				// Element is initially over both left and right sides of within
				} else {
					if ( overLeft > overRight ) {
						position.left = withinOffset + outerWidth - data.collisionWidth;
					} else {
						position.left = withinOffset;
					}
				}

			// Too far left -> align with left edge
			} else if ( overLeft > 0 ) {
				position.left += overLeft;

			// Too far right -> align with right edge
			} else if ( overRight > 0 ) {
				position.left -= overRight;

			// Adjust based on position and margin
			} else {
				position.left = max( position.left - collisionPosLeft, position.left );
			}
		},
		top: function( position, data ) {
			var within = data.within,
				withinOffset = within.isWindow ? within.scrollTop : within.offset.top,
				outerHeight = data.within.height,
				collisionPosTop = position.top - data.collisionPosition.marginTop,
				overTop = withinOffset - collisionPosTop,
				overBottom = collisionPosTop + data.collisionHeight - outerHeight - withinOffset,
				newOverBottom;

			// Element is taller than within
			if ( data.collisionHeight > outerHeight ) {

				// Element is initially over the top of within
				if ( overTop > 0 && overBottom <= 0 ) {
					newOverBottom = position.top + overTop + data.collisionHeight - outerHeight -
						withinOffset;
					position.top += overTop - newOverBottom;

				// Element is initially over bottom of within
				} else if ( overBottom > 0 && overTop <= 0 ) {
					position.top = withinOffset;

				// Element is initially over both top and bottom of within
				} else {
					if ( overTop > overBottom ) {
						position.top = withinOffset + outerHeight - data.collisionHeight;
					} else {
						position.top = withinOffset;
					}
				}

			// Too far up -> align with top
			} else if ( overTop > 0 ) {
				position.top += overTop;

			// Too far down -> align with bottom edge
			} else if ( overBottom > 0 ) {
				position.top -= overBottom;

			// Adjust based on position and margin
			} else {
				position.top = max( position.top - collisionPosTop, position.top );
			}
		}
	},
	flip: {
		left: function( position, data ) {
			var within = data.within,
				withinOffset = within.offset.left + within.scrollLeft,
				outerWidth = within.width,
				offsetLeft = within.isWindow ? within.scrollLeft : within.offset.left,
				collisionPosLeft = position.left - data.collisionPosition.marginLeft,
				overLeft = collisionPosLeft - offsetLeft,
				overRight = collisionPosLeft + data.collisionWidth - outerWidth - offsetLeft,
				myOffset = data.my[ 0 ] === "left" ?
					-data.elemWidth :
					data.my[ 0 ] === "right" ?
						data.elemWidth :
						0,
				atOffset = data.at[ 0 ] === "left" ?
					data.targetWidth :
					data.at[ 0 ] === "right" ?
						-data.targetWidth :
						0,
				offset = -2 * data.offset[ 0 ],
				newOverRight,
				newOverLeft;

			if ( overLeft < 0 ) {
				newOverRight = position.left + myOffset + atOffset + offset + data.collisionWidth -
					outerWidth - withinOffset;
				if ( newOverRight < 0 || newOverRight < abs( overLeft ) ) {
					position.left += myOffset + atOffset + offset;
				}
			} else if ( overRight > 0 ) {
				newOverLeft = position.left - data.collisionPosition.marginLeft + myOffset +
					atOffset + offset - offsetLeft;
				if ( newOverLeft > 0 || abs( newOverLeft ) < overRight ) {
					position.left += myOffset + atOffset + offset;
				}
			}
		},
		top: function( position, data ) {
			var within = data.within,
				withinOffset = within.offset.top + within.scrollTop,
				outerHeight = within.height,
				offsetTop = within.isWindow ? within.scrollTop : within.offset.top,
				collisionPosTop = position.top - data.collisionPosition.marginTop,
				overTop = collisionPosTop - offsetTop,
				overBottom = collisionPosTop + data.collisionHeight - outerHeight - offsetTop,
				top = data.my[ 1 ] === "top",
				myOffset = top ?
					-data.elemHeight :
					data.my[ 1 ] === "bottom" ?
						data.elemHeight :
						0,
				atOffset = data.at[ 1 ] === "top" ?
					data.targetHeight :
					data.at[ 1 ] === "bottom" ?
						-data.targetHeight :
						0,
				offset = -2 * data.offset[ 1 ],
				newOverTop,
				newOverBottom;
			if ( overTop < 0 ) {
				newOverBottom = position.top + myOffset + atOffset + offset + data.collisionHeight -
					outerHeight - withinOffset;
				if ( newOverBottom < 0 || newOverBottom < abs( overTop ) ) {
					position.top += myOffset + atOffset + offset;
				}
			} else if ( overBottom > 0 ) {
				newOverTop = position.top - data.collisionPosition.marginTop + myOffset + atOffset +
					offset - offsetTop;
				if ( newOverTop > 0 || abs( newOverTop ) < overBottom ) {
					position.top += myOffset + atOffset + offset;
				}
			}
		}
	},
	flipfit: {
		left: function() {
			$.ui.position.flip.left.apply( this, arguments );
			$.ui.position.fit.left.apply( this, arguments );
		},
		top: function() {
			$.ui.position.flip.top.apply( this, arguments );
			$.ui.position.fit.top.apply( this, arguments );
		}
	}
};

} )();

return $.ui.position;

} ) );

},{}],21:[function(require,module,exports){
( function( factory ) {
	if ( typeof define === "function" && define.amd ) {

		// AMD. Register as an anonymous module.
		define( [ "jquery", "./version" ], factory );
	} else {

		// Browser globals
		factory( jQuery );
	}
} ( function( $ ) {
return $.ui.safeActiveElement = function( document ) {
	var activeElement;

	// Support: IE 9 only
	// IE9 throws an "Unspecified error" accessing document.activeElement from an <iframe>
	try {
		activeElement = document.activeElement;
	} catch ( error ) {
		activeElement = document.body;
	}

	// Support: IE 9 - 11 only
	// IE may return null instead of an element
	// Interestingly, this only seems to occur when NOT in an iframe
	if ( !activeElement ) {
		activeElement = document.body;
	}

	// Support: IE 11 only
	// IE11 returns a seemingly empty object in some cases when accessing
	// document.activeElement from an <iframe>
	if ( !activeElement.nodeName ) {
		activeElement = document.body;
	}

	return activeElement;
};

} ) );

},{}],22:[function(require,module,exports){
( function( factory ) {
	if ( typeof define === "function" && define.amd ) {

		// AMD. Register as an anonymous module.
		define( [ "jquery", "./version" ], factory );
	} else {

		// Browser globals
		factory( jQuery );
	}
} ( function( $ ) {
return $.ui.safeBlur = function( element ) {

	// Support: IE9 - 10 only
	// If the <body> is blurred, IE will switch windows, see #9420
	if ( element && element.nodeName.toLowerCase() !== "body" ) {
		$( element ).trigger( "blur" );
	}
};

} ) );

},{}],23:[function(require,module,exports){
/*!
 * jQuery UI Scroll Parent 1.12.0
 * http://jqueryui.com
 *
 * Copyright jQuery Foundation and other contributors
 * Released under the MIT license.
 * http://jquery.org/license
 */

//>>label: scrollParent
//>>group: Core
//>>description: Get the closest ancestor element that is scrollable.
//>>docs: http://api.jqueryui.com/scrollParent/

( function( factory ) {
	if ( typeof define === "function" && define.amd ) {

		// AMD. Register as an anonymous module.
		define( [ "jquery", "./version" ], factory );
	} else {

		// Browser globals
		factory( jQuery );
	}
} ( function( $ ) {

return $.fn.scrollParent = function( includeHidden ) {
	var position = this.css( "position" ),
		excludeStaticParent = position === "absolute",
		overflowRegex = includeHidden ? /(auto|scroll|hidden)/ : /(auto|scroll)/,
		scrollParent = this.parents().filter( function() {
			var parent = $( this );
			if ( excludeStaticParent && parent.css( "position" ) === "static" ) {
				return false;
			}
			return overflowRegex.test( parent.css( "overflow" ) + parent.css( "overflow-y" ) +
				parent.css( "overflow-x" ) );
		} ).eq( 0 );

	return position === "fixed" || !scrollParent.length ?
		$( this[ 0 ].ownerDocument || document ) :
		scrollParent;
};

} ) );

},{}],24:[function(require,module,exports){
/*!
 * jQuery UI Tabbable 1.12.0
 * http://jqueryui.com
 *
 * Copyright jQuery Foundation and other contributors
 * Released under the MIT license.
 * http://jquery.org/license
 */

//>>label: :tabbable Selector
//>>group: Core
//>>description: Selects elements which can be tabbed to.
//>>docs: http://api.jqueryui.com/tabbable-selector/

( function( factory ) {
	if ( typeof define === "function" && define.amd ) {

		// AMD. Register as an anonymous module.
		define( [ "jquery", "./version", "./focusable" ], factory );
	} else {

		// Browser globals
		factory( jQuery );
	}
} ( function( $ ) {

return $.extend( $.expr[ ":" ], {
	tabbable: function( element ) {
		var tabIndex = $.attr( element, "tabindex" ),
			hasTabindex = tabIndex != null;
		return ( !hasTabindex || tabIndex >= 0 ) && $.ui.focusable( element, hasTabindex );
	}
} );

} ) );

},{}],25:[function(require,module,exports){
/*!
 * jQuery UI Unique ID 1.12.0
 * http://jqueryui.com
 *
 * Copyright jQuery Foundation and other contributors
 * Released under the MIT license.
 * http://jquery.org/license
 */

//>>label: uniqueId
//>>group: Core
//>>description: Functions to generate and remove uniqueId's
//>>docs: http://api.jqueryui.com/uniqueId/

( function( factory ) {
	if ( typeof define === "function" && define.amd ) {

		// AMD. Register as an anonymous module.
		define( [ "jquery", "./version" ], factory );
	} else {

		// Browser globals
		factory( jQuery );
	}
} ( function( $ ) {

return $.fn.extend( {
	uniqueId: ( function() {
		var uuid = 0;

		return function() {
			return this.each( function() {
				if ( !this.id ) {
					this.id = "ui-id-" + ( ++uuid );
				}
			} );
		};
	} )(),

	removeUniqueId: function() {
		return this.each( function() {
			if ( /^ui-id-\d+$/.test( this.id ) ) {
				$( this ).removeAttr( "id" );
			}
		} );
	}
} );

} ) );

},{}],26:[function(require,module,exports){
( function( factory ) {
	if ( typeof define === "function" && define.amd ) {

		// AMD. Register as an anonymous module.
		define( [ "jquery" ], factory );
	} else {

		// Browser globals
		factory( jQuery );
	}
} ( function( $ ) {

$.ui = $.ui || {};

return $.ui.version = "1.12.0";

} ) );

},{}],27:[function(require,module,exports){
/*!
 * jQuery UI Widget 1.12.0
 * http://jqueryui.com
 *
 * Copyright jQuery Foundation and other contributors
 * Released under the MIT license.
 * http://jquery.org/license
 */

//>>label: Widget
//>>group: Core
//>>description: Provides a factory for creating stateful widgets with a common API.
//>>docs: http://api.jqueryui.com/jQuery.widget/
//>>demos: http://jqueryui.com/widget/

( function( factory ) {
	if ( typeof define === "function" && define.amd ) {

		// AMD. Register as an anonymous module.
		define( [ "jquery", "./version" ], factory );
	} else {

		// Browser globals
		factory( jQuery );
	}
}( function( $ ) {

var widgetUuid = 0;
var widgetSlice = Array.prototype.slice;

$.cleanData = ( function( orig ) {
	return function( elems ) {
		var events, elem, i;
		for ( i = 0; ( elem = elems[ i ] ) != null; i++ ) {
			try {

				// Only trigger remove when necessary to save time
				events = $._data( elem, "events" );
				if ( events && events.remove ) {
					$( elem ).triggerHandler( "remove" );
				}

			// Http://bugs.jquery.com/ticket/8235
			} catch ( e ) {}
		}
		orig( elems );
	};
} )( $.cleanData );

$.widget = function( name, base, prototype ) {
	var existingConstructor, constructor, basePrototype;

	// ProxiedPrototype allows the provided prototype to remain unmodified
	// so that it can be used as a mixin for multiple widgets (#8876)
	var proxiedPrototype = {};

	var namespace = name.split( "." )[ 0 ];
	name = name.split( "." )[ 1 ];
	var fullName = namespace + "-" + name;

	if ( !prototype ) {
		prototype = base;
		base = $.Widget;
	}

	if ( $.isArray( prototype ) ) {
		prototype = $.extend.apply( null, [ {} ].concat( prototype ) );
	}

	// Create selector for plugin
	$.expr[ ":" ][ fullName.toLowerCase() ] = function( elem ) {
		return !!$.data( elem, fullName );
	};

	$[ namespace ] = $[ namespace ] || {};
	existingConstructor = $[ namespace ][ name ];
	constructor = $[ namespace ][ name ] = function( options, element ) {

		// Allow instantiation without "new" keyword
		if ( !this._createWidget ) {
			return new constructor( options, element );
		}

		// Allow instantiation without initializing for simple inheritance
		// must use "new" keyword (the code above always passes args)
		if ( arguments.length ) {
			this._createWidget( options, element );
		}
	};

	// Extend with the existing constructor to carry over any static properties
	$.extend( constructor, existingConstructor, {
		version: prototype.version,

		// Copy the object used to create the prototype in case we need to
		// redefine the widget later
		_proto: $.extend( {}, prototype ),

		// Track widgets that inherit from this widget in case this widget is
		// redefined after a widget inherits from it
		_childConstructors: []
	} );

	basePrototype = new base();

	// We need to make the options hash a property directly on the new instance
	// otherwise we'll modify the options hash on the prototype that we're
	// inheriting from
	basePrototype.options = $.widget.extend( {}, basePrototype.options );
	$.each( prototype, function( prop, value ) {
		if ( !$.isFunction( value ) ) {
			proxiedPrototype[ prop ] = value;
			return;
		}
		proxiedPrototype[ prop ] = ( function() {
			function _super() {
				return base.prototype[ prop ].apply( this, arguments );
			}

			function _superApply( args ) {
				return base.prototype[ prop ].apply( this, args );
			}

			return function() {
				var __super = this._super;
				var __superApply = this._superApply;
				var returnValue;

				this._super = _super;
				this._superApply = _superApply;

				returnValue = value.apply( this, arguments );

				this._super = __super;
				this._superApply = __superApply;

				return returnValue;
			};
		} )();
	} );
	constructor.prototype = $.widget.extend( basePrototype, {

		// TODO: remove support for widgetEventPrefix
		// always use the name + a colon as the prefix, e.g., draggable:start
		// don't prefix for widgets that aren't DOM-based
		widgetEventPrefix: existingConstructor ? ( basePrototype.widgetEventPrefix || name ) : name
	}, proxiedPrototype, {
		constructor: constructor,
		namespace: namespace,
		widgetName: name,
		widgetFullName: fullName
	} );

	// If this widget is being redefined then we need to find all widgets that
	// are inheriting from it and redefine all of them so that they inherit from
	// the new version of this widget. We're essentially trying to replace one
	// level in the prototype chain.
	if ( existingConstructor ) {
		$.each( existingConstructor._childConstructors, function( i, child ) {
			var childPrototype = child.prototype;

			// Redefine the child widget using the same prototype that was
			// originally used, but inherit from the new version of the base
			$.widget( childPrototype.namespace + "." + childPrototype.widgetName, constructor,
				child._proto );
		} );

		// Remove the list of existing child constructors from the old constructor
		// so the old child constructors can be garbage collected
		delete existingConstructor._childConstructors;
	} else {
		base._childConstructors.push( constructor );
	}

	$.widget.bridge( name, constructor );

	return constructor;
};

$.widget.extend = function( target ) {
	var input = widgetSlice.call( arguments, 1 );
	var inputIndex = 0;
	var inputLength = input.length;
	var key;
	var value;

	for ( ; inputIndex < inputLength; inputIndex++ ) {
		for ( key in input[ inputIndex ] ) {
			value = input[ inputIndex ][ key ];
			if ( input[ inputIndex ].hasOwnProperty( key ) && value !== undefined ) {

				// Clone objects
				if ( $.isPlainObject( value ) ) {
					target[ key ] = $.isPlainObject( target[ key ] ) ?
						$.widget.extend( {}, target[ key ], value ) :

						// Don't extend strings, arrays, etc. with objects
						$.widget.extend( {}, value );

				// Copy everything else by reference
				} else {
					target[ key ] = value;
				}
			}
		}
	}
	return target;
};

$.widget.bridge = function( name, object ) {
	var fullName = object.prototype.widgetFullName || name;
	$.fn[ name ] = function( options ) {
		var isMethodCall = typeof options === "string";
		var args = widgetSlice.call( arguments, 1 );
		var returnValue = this;

		if ( isMethodCall ) {
			this.each( function() {
				var methodValue;
				var instance = $.data( this, fullName );

				if ( options === "instance" ) {
					returnValue = instance;
					return false;
				}

				if ( !instance ) {
					return $.error( "cannot call methods on " + name +
						" prior to initialization; " +
						"attempted to call method '" + options + "'" );
				}

				if ( !$.isFunction( instance[ options ] ) || options.charAt( 0 ) === "_" ) {
					return $.error( "no such method '" + options + "' for " + name +
						" widget instance" );
				}

				methodValue = instance[ options ].apply( instance, args );

				if ( methodValue !== instance && methodValue !== undefined ) {
					returnValue = methodValue && methodValue.jquery ?
						returnValue.pushStack( methodValue.get() ) :
						methodValue;
					return false;
				}
			} );
		} else {

			// Allow multiple hashes to be passed on init
			if ( args.length ) {
				options = $.widget.extend.apply( null, [ options ].concat( args ) );
			}

			this.each( function() {
				var instance = $.data( this, fullName );
				if ( instance ) {
					instance.option( options || {} );
					if ( instance._init ) {
						instance._init();
					}
				} else {
					$.data( this, fullName, new object( options, this ) );
				}
			} );
		}

		return returnValue;
	};
};

$.Widget = function( /* options, element */ ) {};
$.Widget._childConstructors = [];

$.Widget.prototype = {
	widgetName: "widget",
	widgetEventPrefix: "",
	defaultElement: "<div>",

	options: {
		classes: {},
		disabled: false,

		// Callbacks
		create: null
	},

	_createWidget: function( options, element ) {
		element = $( element || this.defaultElement || this )[ 0 ];
		this.element = $( element );
		this.uuid = widgetUuid++;
		this.eventNamespace = "." + this.widgetName + this.uuid;

		this.bindings = $();
		this.hoverable = $();
		this.focusable = $();
		this.classesElementLookup = {};

		if ( element !== this ) {
			$.data( element, this.widgetFullName, this );
			this._on( true, this.element, {
				remove: function( event ) {
					if ( event.target === element ) {
						this.destroy();
					}
				}
			} );
			this.document = $( element.style ?

				// Element within the document
				element.ownerDocument :

				// Element is window or document
				element.document || element );
			this.window = $( this.document[ 0 ].defaultView || this.document[ 0 ].parentWindow );
		}

		this.options = $.widget.extend( {},
			this.options,
			this._getCreateOptions(),
			options );

		this._create();

		if ( this.options.disabled ) {
			this._setOptionDisabled( this.options.disabled );
		}

		this._trigger( "create", null, this._getCreateEventData() );
		this._init();
	},

	_getCreateOptions: function() {
		return {};
	},

	_getCreateEventData: $.noop,

	_create: $.noop,

	_init: $.noop,

	destroy: function() {
		var that = this;

		this._destroy();
		$.each( this.classesElementLookup, function( key, value ) {
			that._removeClass( value, key );
		} );

		// We can probably remove the unbind calls in 2.0
		// all event bindings should go through this._on()
		this.element
			.off( this.eventNamespace )
			.removeData( this.widgetFullName );
		this.widget()
			.off( this.eventNamespace )
			.removeAttr( "aria-disabled" );

		// Clean up events and states
		this.bindings.off( this.eventNamespace );
	},

	_destroy: $.noop,

	widget: function() {
		return this.element;
	},

	option: function( key, value ) {
		var options = key;
		var parts;
		var curOption;
		var i;

		if ( arguments.length === 0 ) {

			// Don't return a reference to the internal hash
			return $.widget.extend( {}, this.options );
		}

		if ( typeof key === "string" ) {

			// Handle nested keys, e.g., "foo.bar" => { foo: { bar: ___ } }
			options = {};
			parts = key.split( "." );
			key = parts.shift();
			if ( parts.length ) {
				curOption = options[ key ] = $.widget.extend( {}, this.options[ key ] );
				for ( i = 0; i < parts.length - 1; i++ ) {
					curOption[ parts[ i ] ] = curOption[ parts[ i ] ] || {};
					curOption = curOption[ parts[ i ] ];
				}
				key = parts.pop();
				if ( arguments.length === 1 ) {
					return curOption[ key ] === undefined ? null : curOption[ key ];
				}
				curOption[ key ] = value;
			} else {
				if ( arguments.length === 1 ) {
					return this.options[ key ] === undefined ? null : this.options[ key ];
				}
				options[ key ] = value;
			}
		}

		this._setOptions( options );

		return this;
	},

	_setOptions: function( options ) {
		var key;

		for ( key in options ) {
			this._setOption( key, options[ key ] );
		}

		return this;
	},

	_setOption: function( key, value ) {
		if ( key === "classes" ) {
			this._setOptionClasses( value );
		}

		this.options[ key ] = value;

		if ( key === "disabled" ) {
			this._setOptionDisabled( value );
		}

		return this;
	},

	_setOptionClasses: function( value ) {
		var classKey, elements, currentElements;

		for ( classKey in value ) {
			currentElements = this.classesElementLookup[ classKey ];
			if ( value[ classKey ] === this.options.classes[ classKey ] ||
					!currentElements ||
					!currentElements.length ) {
				continue;
			}

			// We are doing this to create a new jQuery object because the _removeClass() call
			// on the next line is going to destroy the reference to the current elements being
			// tracked. We need to save a copy of this collection so that we can add the new classes
			// below.
			elements = $( currentElements.get() );
			this._removeClass( currentElements, classKey );

			// We don't use _addClass() here, because that uses this.options.classes
			// for generating the string of classes. We want to use the value passed in from
			// _setOption(), this is the new value of the classes option which was passed to
			// _setOption(). We pass this value directly to _classes().
			elements.addClass( this._classes( {
				element: elements,
				keys: classKey,
				classes: value,
				add: true
			} ) );
		}
	},

	_setOptionDisabled: function( value ) {
		this._toggleClass( this.widget(), this.widgetFullName + "-disabled", null, !!value );

		// If the widget is becoming disabled, then nothing is interactive
		if ( value ) {
			this._removeClass( this.hoverable, null, "ui-state-hover" );
			this._removeClass( this.focusable, null, "ui-state-focus" );
		}
	},

	enable: function() {
		return this._setOptions( { disabled: false } );
	},

	disable: function() {
		return this._setOptions( { disabled: true } );
	},

	_classes: function( options ) {
		var full = [];
		var that = this;

		options = $.extend( {
			element: this.element,
			classes: this.options.classes || {}
		}, options );

		function processClassString( classes, checkOption ) {
			var current, i;
			for ( i = 0; i < classes.length; i++ ) {
				current = that.classesElementLookup[ classes[ i ] ] || $();
				if ( options.add ) {
					current = $( $.unique( current.get().concat( options.element.get() ) ) );
				} else {
					current = $( current.not( options.element ).get() );
				}
				that.classesElementLookup[ classes[ i ] ] = current;
				full.push( classes[ i ] );
				if ( checkOption && options.classes[ classes[ i ] ] ) {
					full.push( options.classes[ classes[ i ] ] );
				}
			}
		}

		if ( options.keys ) {
			processClassString( options.keys.match( /\S+/g ) || [], true );
		}
		if ( options.extra ) {
			processClassString( options.extra.match( /\S+/g ) || [] );
		}

		return full.join( " " );
	},

	_removeClass: function( element, keys, extra ) {
		return this._toggleClass( element, keys, extra, false );
	},

	_addClass: function( element, keys, extra ) {
		return this._toggleClass( element, keys, extra, true );
	},

	_toggleClass: function( element, keys, extra, add ) {
		add = ( typeof add === "boolean" ) ? add : extra;
		var shift = ( typeof element === "string" || element === null ),
			options = {
				extra: shift ? keys : extra,
				keys: shift ? element : keys,
				element: shift ? this.element : element,
				add: add
			};
		options.element.toggleClass( this._classes( options ), add );
		return this;
	},

	_on: function( suppressDisabledCheck, element, handlers ) {
		var delegateElement;
		var instance = this;

		// No suppressDisabledCheck flag, shuffle arguments
		if ( typeof suppressDisabledCheck !== "boolean" ) {
			handlers = element;
			element = suppressDisabledCheck;
			suppressDisabledCheck = false;
		}

		// No element argument, shuffle and use this.element
		if ( !handlers ) {
			handlers = element;
			element = this.element;
			delegateElement = this.widget();
		} else {
			element = delegateElement = $( element );
			this.bindings = this.bindings.add( element );
		}

		$.each( handlers, function( event, handler ) {
			function handlerProxy() {

				// Allow widgets to customize the disabled handling
				// - disabled as an array instead of boolean
				// - disabled class as method for disabling individual parts
				if ( !suppressDisabledCheck &&
						( instance.options.disabled === true ||
						$( this ).hasClass( "ui-state-disabled" ) ) ) {
					return;
				}
				return ( typeof handler === "string" ? instance[ handler ] : handler )
					.apply( instance, arguments );
			}

			// Copy the guid so direct unbinding works
			if ( typeof handler !== "string" ) {
				handlerProxy.guid = handler.guid =
					handler.guid || handlerProxy.guid || $.guid++;
			}

			var match = event.match( /^([\w:-]*)\s*(.*)$/ );
			var eventName = match[ 1 ] + instance.eventNamespace;
			var selector = match[ 2 ];

			if ( selector ) {
				delegateElement.on( eventName, selector, handlerProxy );
			} else {
				element.on( eventName, handlerProxy );
			}
		} );
	},

	_off: function( element, eventName ) {
		eventName = ( eventName || "" ).split( " " ).join( this.eventNamespace + " " ) +
			this.eventNamespace;
		element.off( eventName ).off( eventName );

		// Clear the stack to avoid memory leaks (#10056)
		this.bindings = $( this.bindings.not( element ).get() );
		this.focusable = $( this.focusable.not( element ).get() );
		this.hoverable = $( this.hoverable.not( element ).get() );
	},

	_delay: function( handler, delay ) {
		function handlerProxy() {
			return ( typeof handler === "string" ? instance[ handler ] : handler )
				.apply( instance, arguments );
		}
		var instance = this;
		return setTimeout( handlerProxy, delay || 0 );
	},

	_hoverable: function( element ) {
		this.hoverable = this.hoverable.add( element );
		this._on( element, {
			mouseenter: function( event ) {
				this._addClass( $( event.currentTarget ), null, "ui-state-hover" );
			},
			mouseleave: function( event ) {
				this._removeClass( $( event.currentTarget ), null, "ui-state-hover" );
			}
		} );
	},

	_focusable: function( element ) {
		this.focusable = this.focusable.add( element );
		this._on( element, {
			focusin: function( event ) {
				this._addClass( $( event.currentTarget ), null, "ui-state-focus" );
			},
			focusout: function( event ) {
				this._removeClass( $( event.currentTarget ), null, "ui-state-focus" );
			}
		} );
	},

	_trigger: function( type, event, data ) {
		var prop, orig;
		var callback = this.options[ type ];

		data = data || {};
		event = $.Event( event );
		event.type = ( type === this.widgetEventPrefix ?
			type :
			this.widgetEventPrefix + type ).toLowerCase();

		// The original event may come from any element
		// so we need to reset the target on the new event
		event.target = this.element[ 0 ];

		// Copy original event properties over to the new event
		orig = event.originalEvent;
		if ( orig ) {
			for ( prop in orig ) {
				if ( !( prop in event ) ) {
					event[ prop ] = orig[ prop ];
				}
			}
		}

		this.element.trigger( event, data );
		return !( $.isFunction( callback ) &&
			callback.apply( this.element[ 0 ], [ event ].concat( data ) ) === false ||
			event.isDefaultPrevented() );
	}
};

$.each( { show: "fadeIn", hide: "fadeOut" }, function( method, defaultEffect ) {
	$.Widget.prototype[ "_" + method ] = function( element, options, callback ) {
		if ( typeof options === "string" ) {
			options = { effect: options };
		}

		var hasOptions;
		var effectName = !options ?
			method :
			options === true || typeof options === "number" ?
				defaultEffect :
				options.effect || defaultEffect;

		options = options || {};
		if ( typeof options === "number" ) {
			options = { duration: options };
		}

		hasOptions = !$.isEmptyObject( options );
		options.complete = callback;

		if ( options.delay ) {
			element.delay( options.delay );
		}

		if ( hasOptions && $.effects && $.effects.effect[ effectName ] ) {
			element[ method ]( options );
		} else if ( effectName !== method && element[ effectName ] ) {
			element[ effectName ]( options.duration, options.easing, callback );
		} else {
			element.queue( function( next ) {
				$( this )[ method ]();
				if ( callback ) {
					callback.call( element[ 0 ] );
				}
				next();
			} );
		}
	};
} );

return $.widget;

} ) );

},{}],28:[function(require,module,exports){
/*!
 * jQuery UI Autocomplete 1.12.0
 * http://jqueryui.com
 *
 * Copyright jQuery Foundation and other contributors
 * Released under the MIT license.
 * http://jquery.org/license
 */

//>>label: Autocomplete
//>>group: Widgets
//>>description: Lists suggested words as the user is typing.
//>>docs: http://api.jqueryui.com/autocomplete/
//>>demos: http://jqueryui.com/autocomplete/
//>>css.structure: ../../themes/base/core.css
//>>css.structure: ../../themes/base/autocomplete.css
//>>css.theme: ../../themes/base/theme.css

( function( factory ) {
	if ( typeof define === "function" && define.amd ) {

		// AMD. Register as an anonymous module.
		define( [
			"jquery",
			"./menu",
			"../keycode",
			"../position",
			"../safe-active-element",
			"../version",
			"../widget"
		], factory );
	} else {

		// Browser globals
		factory( jQuery );
	}
}( function( $ ) {

$.widget( "ui.autocomplete", {
	version: "1.12.0",
	defaultElement: "<input>",
	options: {
		appendTo: null,
		autoFocus: false,
		delay: 300,
		minLength: 1,
		position: {
			my: "left top",
			at: "left bottom",
			collision: "none"
		},
		source: null,

		// Callbacks
		change: null,
		close: null,
		focus: null,
		open: null,
		response: null,
		search: null,
		select: null
	},

	requestIndex: 0,
	pending: 0,

	_create: function() {

		// Some browsers only repeat keydown events, not keypress events,
		// so we use the suppressKeyPress flag to determine if we've already
		// handled the keydown event. #7269
		// Unfortunately the code for & in keypress is the same as the up arrow,
		// so we use the suppressKeyPressRepeat flag to avoid handling keypress
		// events when we know the keydown event was used to modify the
		// search term. #7799
		var suppressKeyPress, suppressKeyPressRepeat, suppressInput,
			nodeName = this.element[ 0 ].nodeName.toLowerCase(),
			isTextarea = nodeName === "textarea",
			isInput = nodeName === "input";

		// Textareas are always multi-line
		// Inputs are always single-line, even if inside a contentEditable element
		// IE also treats inputs as contentEditable
		// All other element types are determined by whether or not they're contentEditable
		this.isMultiLine = isTextarea || !isInput && this._isContentEditable( this.element );

		this.valueMethod = this.element[ isTextarea || isInput ? "val" : "text" ];
		this.isNewMenu = true;

		this._addClass( "ui-autocomplete-input" );
		this.element.attr( "autocomplete", "off" );

		this._on( this.element, {
			keydown: function( event ) {
				if ( this.element.prop( "readOnly" ) ) {
					suppressKeyPress = true;
					suppressInput = true;
					suppressKeyPressRepeat = true;
					return;
				}

				suppressKeyPress = false;
				suppressInput = false;
				suppressKeyPressRepeat = false;
				var keyCode = $.ui.keyCode;
				switch ( event.keyCode ) {
				case keyCode.PAGE_UP:
					suppressKeyPress = true;
					this._move( "previousPage", event );
					break;
				case keyCode.PAGE_DOWN:
					suppressKeyPress = true;
					this._move( "nextPage", event );
					break;
				case keyCode.UP:
					suppressKeyPress = true;
					this._keyEvent( "previous", event );
					break;
				case keyCode.DOWN:
					suppressKeyPress = true;
					this._keyEvent( "next", event );
					break;
				case keyCode.ENTER:

					// when menu is open and has focus
					if ( this.menu.active ) {

						// #6055 - Opera still allows the keypress to occur
						// which causes forms to submit
						suppressKeyPress = true;
						event.preventDefault();
						this.menu.select( event );
					}
					break;
				case keyCode.TAB:
					if ( this.menu.active ) {
						this.menu.select( event );
					}
					break;
				case keyCode.ESCAPE:
					if ( this.menu.element.is( ":visible" ) ) {
						if ( !this.isMultiLine ) {
							this._value( this.term );
						}
						this.close( event );

						// Different browsers have different default behavior for escape
						// Single press can mean undo or clear
						// Double press in IE means clear the whole form
						event.preventDefault();
					}
					break;
				default:
					suppressKeyPressRepeat = true;

					// search timeout should be triggered before the input value is changed
					this._searchTimeout( event );
					break;
				}
			},
			keypress: function( event ) {
				if ( suppressKeyPress ) {
					suppressKeyPress = false;
					if ( !this.isMultiLine || this.menu.element.is( ":visible" ) ) {
						event.preventDefault();
					}
					return;
				}
				if ( suppressKeyPressRepeat ) {
					return;
				}

				// Replicate some key handlers to allow them to repeat in Firefox and Opera
				var keyCode = $.ui.keyCode;
				switch ( event.keyCode ) {
				case keyCode.PAGE_UP:
					this._move( "previousPage", event );
					break;
				case keyCode.PAGE_DOWN:
					this._move( "nextPage", event );
					break;
				case keyCode.UP:
					this._keyEvent( "previous", event );
					break;
				case keyCode.DOWN:
					this._keyEvent( "next", event );
					break;
				}
			},
			input: function( event ) {
				if ( suppressInput ) {
					suppressInput = false;
					event.preventDefault();
					return;
				}
				this._searchTimeout( event );
			},
			focus: function() {
				this.selectedItem = null;
				this.previous = this._value();
			},
			blur: function( event ) {
				if ( this.cancelBlur ) {
					delete this.cancelBlur;
					return;
				}

				clearTimeout( this.searching );
				this.close( event );
				this._change( event );
			}
		} );

		this._initSource();
		this.menu = $( "<ul>" )
			.appendTo( this._appendTo() )
			.menu( {

				// disable ARIA support, the live region takes care of that
				role: null
			} )
			.hide()
			.menu( "instance" );

		this._addClass( this.menu.element, "ui-autocomplete", "ui-front" );
		this._on( this.menu.element, {
			mousedown: function( event ) {

				// prevent moving focus out of the text field
				event.preventDefault();

				// IE doesn't prevent moving focus even with event.preventDefault()
				// so we set a flag to know when we should ignore the blur event
				this.cancelBlur = true;
				this._delay( function() {
					delete this.cancelBlur;

					// Support: IE 8 only
					// Right clicking a menu item or selecting text from the menu items will
					// result in focus moving out of the input. However, we've already received
					// and ignored the blur event because of the cancelBlur flag set above. So
					// we restore focus to ensure that the menu closes properly based on the user's
					// next actions.
					if ( this.element[ 0 ] !== $.ui.safeActiveElement( this.document[ 0 ] ) ) {
						this.element.trigger( "focus" );
					}
				} );
			},
			menufocus: function( event, ui ) {
				var label, item;

				// support: Firefox
				// Prevent accidental activation of menu items in Firefox (#7024 #9118)
				if ( this.isNewMenu ) {
					this.isNewMenu = false;
					if ( event.originalEvent && /^mouse/.test( event.originalEvent.type ) ) {
						this.menu.blur();

						this.document.one( "mousemove", function() {
							$( event.target ).trigger( event.originalEvent );
						} );

						return;
					}
				}

				item = ui.item.data( "ui-autocomplete-item" );
				if ( false !== this._trigger( "focus", event, { item: item } ) ) {

					// use value to match what will end up in the input, if it was a key event
					if ( event.originalEvent && /^key/.test( event.originalEvent.type ) ) {
						this._value( item.value );
					}
				}

				// Announce the value in the liveRegion
				label = ui.item.attr( "aria-label" ) || item.value;
				if ( label && $.trim( label ).length ) {
					this.liveRegion.children().hide();
					$( "<div>" ).text( label ).appendTo( this.liveRegion );
				}
			},
			menuselect: function( event, ui ) {
				var item = ui.item.data( "ui-autocomplete-item" ),
					previous = this.previous;

				// Only trigger when focus was lost (click on menu)
				if ( this.element[ 0 ] !== $.ui.safeActiveElement( this.document[ 0 ] ) ) {
					this.element.trigger( "focus" );
					this.previous = previous;

					// #6109 - IE triggers two focus events and the second
					// is asynchronous, so we need to reset the previous
					// term synchronously and asynchronously :-(
					this._delay( function() {
						this.previous = previous;
						this.selectedItem = item;
					} );
				}

				if ( false !== this._trigger( "select", event, { item: item } ) ) {
					this._value( item.value );
				}

				// reset the term after the select event
				// this allows custom select handling to work properly
				this.term = this._value();

				this.close( event );
				this.selectedItem = item;
			}
		} );

		this.liveRegion = $( "<div>", {
			role: "status",
			"aria-live": "assertive",
			"aria-relevant": "additions"
		} )
			.appendTo( this.document[ 0 ].body );

		this._addClass( this.liveRegion, null, "ui-helper-hidden-accessible" );

		// Turning off autocomplete prevents the browser from remembering the
		// value when navigating through history, so we re-enable autocomplete
		// if the page is unloaded before the widget is destroyed. #7790
		this._on( this.window, {
			beforeunload: function() {
				this.element.removeAttr( "autocomplete" );
			}
		} );
	},

	_destroy: function() {
		clearTimeout( this.searching );
		this.element.removeAttr( "autocomplete" );
		this.menu.element.remove();
		this.liveRegion.remove();
	},

	_setOption: function( key, value ) {
		this._super( key, value );
		if ( key === "source" ) {
			this._initSource();
		}
		if ( key === "appendTo" ) {
			this.menu.element.appendTo( this._appendTo() );
		}
		if ( key === "disabled" && value && this.xhr ) {
			this.xhr.abort();
		}
	},

	_isEventTargetInWidget: function( event ) {
		var menuElement = this.menu.element[ 0 ];

		return event.target === this.element[ 0 ] ||
			event.target === menuElement ||
			$.contains( menuElement, event.target );
	},

	_closeOnClickOutside: function( event ) {
		if ( !this._isEventTargetInWidget( event ) ) {
			this.close();
		}
	},

	_appendTo: function() {
		var element = this.options.appendTo;

		if ( element ) {
			element = element.jquery || element.nodeType ?
				$( element ) :
				this.document.find( element ).eq( 0 );
		}

		if ( !element || !element[ 0 ] ) {
			element = this.element.closest( ".ui-front, dialog" );
		}

		if ( !element.length ) {
			element = this.document[ 0 ].body;
		}

		return element;
	},

	_initSource: function() {
		var array, url,
			that = this;
		if ( $.isArray( this.options.source ) ) {
			array = this.options.source;
			this.source = function( request, response ) {
				response( $.ui.autocomplete.filter( array, request.term ) );
			};
		} else if ( typeof this.options.source === "string" ) {
			url = this.options.source;
			this.source = function( request, response ) {
				if ( that.xhr ) {
					that.xhr.abort();
				}
				that.xhr = $.ajax( {
					url: url,
					data: request,
					dataType: "json",
					success: function( data ) {
						response( data );
					},
					error: function() {
						response( [] );
					}
				} );
			};
		} else {
			this.source = this.options.source;
		}
	},

	_searchTimeout: function( event ) {
		clearTimeout( this.searching );
		this.searching = this._delay( function() {

			// Search if the value has changed, or if the user retypes the same value (see #7434)
			var equalValues = this.term === this._value(),
				menuVisible = this.menu.element.is( ":visible" ),
				modifierKey = event.altKey || event.ctrlKey || event.metaKey || event.shiftKey;

			if ( !equalValues || ( equalValues && !menuVisible && !modifierKey ) ) {
				this.selectedItem = null;
				this.search( null, event );
			}
		}, this.options.delay );
	},

	search: function( value, event ) {
		value = value != null ? value : this._value();

		// Always save the actual value, not the one passed as an argument
		this.term = this._value();

		if ( value.length < this.options.minLength ) {
			return this.close( event );
		}

		if ( this._trigger( "search", event ) === false ) {
			return;
		}

		return this._search( value );
	},

	_search: function( value ) {
		this.pending++;
		this._addClass( "ui-autocomplete-loading" );
		this.cancelSearch = false;

		this.source( { term: value }, this._response() );
	},

	_response: function() {
		var index = ++this.requestIndex;

		return $.proxy( function( content ) {
			if ( index === this.requestIndex ) {
				this.__response( content );
			}

			this.pending--;
			if ( !this.pending ) {
				this._removeClass( "ui-autocomplete-loading" );
			}
		}, this );
	},

	__response: function( content ) {
		if ( content ) {
			content = this._normalize( content );
		}
		this._trigger( "response", null, { content: content } );
		if ( !this.options.disabled && content && content.length && !this.cancelSearch ) {
			this._suggest( content );
			this._trigger( "open" );
		} else {

			// use ._close() instead of .close() so we don't cancel future searches
			this._close();
		}
	},

	close: function( event ) {
		this.cancelSearch = true;
		this._close( event );
	},

	_close: function( event ) {

		// Remove the handler that closes the menu on outside clicks
		this._off( this.document, "mousedown" );

		if ( this.menu.element.is( ":visible" ) ) {
			this.menu.element.hide();
			this.menu.blur();
			this.isNewMenu = true;
			this._trigger( "close", event );
		}
	},

	_change: function( event ) {
		if ( this.previous !== this._value() ) {
			this._trigger( "change", event, { item: this.selectedItem } );
		}
	},

	_normalize: function( items ) {

		// assume all items have the right format when the first item is complete
		if ( items.length && items[ 0 ].label && items[ 0 ].value ) {
			return items;
		}
		return $.map( items, function( item ) {
			if ( typeof item === "string" ) {
				return {
					label: item,
					value: item
				};
			}
			return $.extend( {}, item, {
				label: item.label || item.value,
				value: item.value || item.label
			} );
		} );
	},

	_suggest: function( items ) {
		var ul = this.menu.element.empty();
		this._renderMenu( ul, items );
		this.isNewMenu = true;
		this.menu.refresh();

		// Size and position menu
		ul.show();
		this._resizeMenu();
		ul.position( $.extend( {
			of: this.element
		}, this.options.position ) );

		if ( this.options.autoFocus ) {
			this.menu.next();
		}

		// Listen for interactions outside of the widget (#6642)
		this._on( this.document, {
			mousedown: "_closeOnClickOutside"
		} );
	},

	_resizeMenu: function() {
		var ul = this.menu.element;
		ul.outerWidth( Math.max(

			// Firefox wraps long text (possibly a rounding bug)
			// so we add 1px to avoid the wrapping (#7513)
			ul.width( "" ).outerWidth() + 1,
			this.element.outerWidth()
		) );
	},

	_renderMenu: function( ul, items ) {
		var that = this;
		$.each( items, function( index, item ) {
			that._renderItemData( ul, item );
		} );
	},

	_renderItemData: function( ul, item ) {
		return this._renderItem( ul, item ).data( "ui-autocomplete-item", item );
	},

	_renderItem: function( ul, item ) {
		return $( "<li>" )
			.append( $( "<div>" ).text( item.label ) )
			.appendTo( ul );
	},

	_move: function( direction, event ) {
		if ( !this.menu.element.is( ":visible" ) ) {
			this.search( null, event );
			return;
		}
		if ( this.menu.isFirstItem() && /^previous/.test( direction ) ||
				this.menu.isLastItem() && /^next/.test( direction ) ) {

			if ( !this.isMultiLine ) {
				this._value( this.term );
			}

			this.menu.blur();
			return;
		}
		this.menu[ direction ]( event );
	},

	widget: function() {
		return this.menu.element;
	},

	_value: function() {
		return this.valueMethod.apply( this.element, arguments );
	},

	_keyEvent: function( keyEvent, event ) {
		if ( !this.isMultiLine || this.menu.element.is( ":visible" ) ) {
			this._move( keyEvent, event );

			// Prevents moving cursor to beginning/end of the text field in some browsers
			event.preventDefault();
		}
	},

	// Support: Chrome <=50
	// We should be able to just use this.element.prop( "isContentEditable" )
	// but hidden elements always report false in Chrome.
	// https://code.google.com/p/chromium/issues/detail?id=313082
	_isContentEditable: function( element ) {
		if ( !element.length ) {
			return false;
		}

		var editable = element.prop( "contentEditable" );

		if ( editable === "inherit" ) {
		  return this._isContentEditable( element.parent() );
		}

		return editable === "true";
	}
} );

$.extend( $.ui.autocomplete, {
	escapeRegex: function( value ) {
		return value.replace( /[\-\[\]{}()*+?.,\\\^$|#\s]/g, "\\$&" );
	},
	filter: function( array, term ) {
		var matcher = new RegExp( $.ui.autocomplete.escapeRegex( term ), "i" );
		return $.grep( array, function( value ) {
			return matcher.test( value.label || value.value || value );
		} );
	}
} );

// Live region extension, adding a `messages` option
// NOTE: This is an experimental API. We are still investigating
// a full solution for string manipulation and internationalization.
$.widget( "ui.autocomplete", $.ui.autocomplete, {
	options: {
		messages: {
			noResults: "No search results.",
			results: function( amount ) {
				return amount + ( amount > 1 ? " results are" : " result is" ) +
					" available, use up and down arrow keys to navigate.";
			}
		}
	},

	__response: function( content ) {
		var message;
		this._superApply( arguments );
		if ( this.options.disabled || this.cancelSearch ) {
			return;
		}
		if ( content && content.length ) {
			message = this.options.messages.results( content.length );
		} else {
			message = this.options.messages.noResults;
		}
		this.liveRegion.children().hide();
		$( "<div>" ).text( message ).appendTo( this.liveRegion );
	}
} );

return $.ui.autocomplete;

} ) );

},{}],29:[function(require,module,exports){
/*!
 * jQuery UI Button 1.12.0
 * http://jqueryui.com
 *
 * Copyright jQuery Foundation and other contributors
 * Released under the MIT license.
 * http://jquery.org/license
 */

//>>label: Button
//>>group: Widgets
//>>description: Enhances a form with themeable buttons.
//>>docs: http://api.jqueryui.com/button/
//>>demos: http://jqueryui.com/button/
//>>css.structure: ../../themes/base/core.css
//>>css.structure: ../../themes/base/button.css
//>>css.theme: ../../themes/base/theme.css

( function( factory ) {
	if ( typeof define === "function" && define.amd ) {

		// AMD. Register as an anonymous module.
		define( [
			"jquery",

			// These are only for backcompat
			// TODO: Remove after 1.12
			"./controlgroup",
			"./checkboxradio",

			"../keycode",
			"../widget"
		], factory );
	} else {

		// Browser globals
		factory( jQuery );
	}
}( function( $ ) {

$.widget( "ui.button", {
	version: "1.12.0",
	defaultElement: "<button>",
	options: {
		classes: {
			"ui-button": "ui-corner-all"
		},
		disabled: null,
		icon: null,
		iconPosition: "beginning",
		label: null,
		showLabel: true
	},

	_getCreateOptions: function() {
		var disabled,

			// This is to support cases like in jQuery Mobile where the base widget does have
			// an implementation of _getCreateOptions
			options = this._super() || {};

		this.isInput = this.element.is( "input" );

		disabled = this.element[ 0 ].disabled;
		if ( disabled != null ) {
			options.disabled = disabled;
		}

		this.originalLabel = this.isInput ? this.element.val() : this.element.html();
		if ( this.originalLabel ) {
			options.label = this.originalLabel;
		}

		return options;
	},

	_create: function() {
		if ( !this.option.showLabel & !this.options.icon ) {
			this.options.showLabel = true;
		}

		// We have to check the option again here even though we did in _getCreateOptions,
		// because null may have been passed on init which would override what was set in
		// _getCreateOptions
		if ( this.options.disabled == null ) {
			this.options.disabled = this.element[ 0 ].disabled || false;
		}

		this.hasTitle = !!this.element.attr( "title" );

		// Check to see if the label needs to be set or if its already correct
		if ( this.options.label && this.options.label !== this.originalLabel ) {
			if ( this.isInput ) {
				this.element.val( this.options.label );
			} else {
				this.element.html( this.options.label );
			}
		}
		this._addClass( "ui-button", "ui-widget" );
		this._setOption( "disabled", this.options.disabled );
		this._enhance();

		if ( this.element.is( "a" ) ) {
			this._on( {
				"keyup": function( event ) {
					if ( event.keyCode === $.ui.keyCode.SPACE ) {
						event.preventDefault();

						// Support: PhantomJS <= 1.9, IE 8 Only
						// If a native click is available use it so we actually cause navigation
						// otherwise just trigger a click event
						if ( this.element[ 0 ].click ) {
							this.element[ 0 ].click();
						} else {
							this.element.trigger( "click" );
						}
					}
				}
			} );
		}
	},

	_enhance: function() {
		if ( !this.element.is( "button" ) ) {
			this.element.attr( "role", "button" );
		}

		if ( this.options.icon ) {
			this._updateIcon( "icon", this.options.icon );
			this._updateTooltip();
		}
	},

	_updateTooltip: function() {
		this.title = this.element.attr( "title" );

		if ( !this.options.showLabel && !this.title ) {
			this.element.attr( "title", this.options.label );
		}
	},

	_updateIcon: function( option, value ) {
		var icon = option !== "iconPosition",
			position = icon ? this.options.iconPosition : value,
			displayBlock = position === "top" || position === "bottom";

		// Create icon
		if ( !this.icon ) {
			this.icon = $( "<span>" );

			this._addClass( this.icon, "ui-button-icon", "ui-icon" );

			if ( !this.options.showLabel ) {
				this._addClass( "ui-button-icon-only" );
			}
		} else if ( icon ) {

			// If we are updating the icon remove the old icon class
			this._removeClass( this.icon, null, this.options.icon );
		}

		// If we are updating the icon add the new icon class
		if ( icon ) {
			this._addClass( this.icon, null, value );
		}

		this._attachIcon( position );

		// If the icon is on top or bottom we need to add the ui-widget-icon-block class and remove
		// the iconSpace if there is one.
		if ( displayBlock ) {
			this._addClass( this.icon, null, "ui-widget-icon-block" );
			if ( this.iconSpace ) {
				this.iconSpace.remove();
			}
		} else {

			// Position is beginning or end so remove the ui-widget-icon-block class and add the
			// space if it does not exist
			if ( !this.iconSpace ) {
				this.iconSpace = $( "<span> </span>" );
				this._addClass( this.iconSpace, "ui-button-icon-space" );
			}
			this._removeClass( this.icon, null, "ui-wiget-icon-block" );
			this._attachIconSpace( position );
		}
	},

	_destroy: function() {
		this.element.removeAttr( "role" );

		if ( this.icon ) {
			this.icon.remove();
		}
		if ( this.iconSpace ) {
			this.iconSpace.remove();
		}
		if ( !this.hasTitle ) {
			this.element.removeAttr( "title" );
		}
	},

	_attachIconSpace: function( iconPosition ) {
		this.icon[ /^(?:end|bottom)/.test( iconPosition ) ? "before" : "after" ]( this.iconSpace );
	},

	_attachIcon: function( iconPosition ) {
		this.element[ /^(?:end|bottom)/.test( iconPosition ) ? "append" : "prepend" ]( this.icon );
	},

	_setOptions: function( options ) {
		var newShowLabel = options.showLabel === undefined ?
				this.options.showLabel :
				options.showLabel,
			newIcon = options.icon === undefined ? this.options.icon : options.icon;

		if ( !newShowLabel && !newIcon ) {
			options.showLabel = true;
		}
		this._super( options );
	},

	_setOption: function( key, value ) {
		if ( key === "icon" ) {
			if ( value ) {
				this._updateIcon( key, value );
			} else if ( this.icon ) {
				this.icon.remove();
				if ( this.iconSpace ) {
					this.iconSpace.remove();
				}
			}
		}

		if ( key === "iconPosition" ) {
			this._updateIcon( key, value );
		}

		// Make sure we can't end up with a button that has neither text nor icon
		if ( key === "showLabel" ) {
				this._toggleClass( "ui-button-icon-only", null, !value );
				this._updateTooltip();
		}

		if ( key === "label" ) {
			if ( this.isInput ) {
				this.element.val( value );
			} else {

				// If there is an icon, append it, else nothing then append the value
				// this avoids removal of the icon when setting label text
				this.element.html( value );
				if ( this.icon ) {
					this._attachIcon( this.options.iconPosition );
					this._attachIconSpace( this.options.iconPosition );
				}
			}
		}

		this._super( key, value );

		if ( key === "disabled" ) {
			this._toggleClass( null, "ui-state-disabled", value );
			this.element[ 0 ].disabled = value;
			if ( value ) {
				this.element.blur();
			}
		}
	},

	refresh: function() {

		// Make sure to only check disabled if its an element that supports this otherwise
		// check for the disabled class to determine state
		var isDisabled = this.element.is( "input, button" ) ?
			this.element[ 0 ].disabled : this.element.hasClass( "ui-button-disabled" );

		if ( isDisabled !== this.options.disabled ) {
			this._setOptions( { disabled: isDisabled } );
		}

		this._updateTooltip();
	}
} );

// DEPRECATED
if ( $.uiBackCompat !== false ) {

	// Text and Icons options
	$.widget( "ui.button", $.ui.button, {
		options: {
			text: true,
			icons: {
				primary: null,
				secondary: null
			}
		},

		_create: function() {
			if ( this.options.showLabel && !this.options.text ) {
				this.options.showLabel = this.options.text;
			}
			if ( !this.options.showLabel && this.options.text ) {
				this.options.text = this.options.showLabel;
			}
			if ( !this.options.icon && ( this.options.icons.primary ||
					this.options.icons.secondary ) ) {
				if ( this.options.icons.primary ) {
					this.options.icon = this.options.icons.primary;
				} else {
					this.options.icon = this.options.icons.secondary;
					this.options.iconPosition = "end";
				}
			} else if ( this.options.icon ) {
				this.options.icons.primary = this.options.icon;
			}
			this._super();
		},

		_setOption: function( key, value ) {
			if ( key === "text" ) {
				this._super( "showLabel", value );
				return;
			}
			if ( key === "showLabel" ) {
				this.options.text = value;
			}
			if ( key === "icon" ) {
				this.options.icons.primary = value;
			}
			if ( key === "icons" ) {
				if ( value.primary ) {
					this._super( "icon", value.primary );
					this._super( "iconPosition", "beginning" );
				} else if ( value.secondary ) {
					this._super( "icon", value.secondary );
					this._super( "iconPosition", "end" );
				}
			}
			this._superApply( arguments );
		}
	} );

	$.fn.button = ( function( orig ) {
		return function() {
			if ( !this.length || ( this.length && this[ 0 ].tagName !== "INPUT" ) ||
					( this.length && this[ 0 ].tagName === "INPUT" && (
						this.attr( "type" ) !== "checkbox" && this.attr( "type" ) !== "radio"
					) ) ) {
				return orig.apply( this, arguments );
			}
			if ( !$.ui.checkboxradio ) {
				$.error( "Checkboxradio widget missing" );
			}
			if ( arguments.length === 0 ) {
				return this.checkboxradio( {
					"icon": false
				} );
			}
			return this.checkboxradio.apply( this, arguments );
		};
	} )( $.fn.button );

	$.fn.buttonset = function() {
		if ( !$.ui.controlgroup ) {
			$.error( "Controlgroup widget missing" );
		}
		if ( arguments[ 0 ] === "option" && arguments[ 1 ] === "items" && arguments[ 2 ] ) {
			return this.controlgroup.apply( this,
				[ arguments[ 0 ], "items.button", arguments[ 2 ] ] );
		}
		if ( arguments[ 0 ] === "option" && arguments[ 1 ] === "items" ) {
			return this.controlgroup.apply( this, [ arguments[ 0 ], "items.button" ] );
		}
		if ( typeof arguments[ 0 ] === "object" && arguments[ 0 ].items ) {
			arguments[ 0 ].items = {
				button: arguments[ 0 ].items
			};
		}
		return this.controlgroup.apply( this, arguments );
	};
}

return $.ui.button;

} ) );

},{}],30:[function(require,module,exports){
/*!
 * jQuery UI Dialog 1.12.0
 * http://jqueryui.com
 *
 * Copyright jQuery Foundation and other contributors
 * Released under the MIT license.
 * http://jquery.org/license
 */

//>>label: Dialog
//>>group: Widgets
//>>description: Displays customizable dialog windows.
//>>docs: http://api.jqueryui.com/dialog/
//>>demos: http://jqueryui.com/dialog/
//>>css.structure: ../../themes/base/core.css
//>>css.structure: ../../themes/base/dialog.css
//>>css.theme: ../../themes/base/theme.css

( function( factory ) {
	if ( typeof define === "function" && define.amd ) {

		// AMD. Register as an anonymous module.
		define( [
			"jquery",
			"./button",
			"./draggable",
			"./mouse",
			"./resizable",
			"../focusable",
			"../keycode",
			"../position",
			"../safe-active-element",
			"../safe-blur",
			"../tabbable",
			"../unique-id",
			"../version",
			"../widget"
		], factory );
	} else {

		// Browser globals
		factory( jQuery );
	}
}( function( $ ) {

$.widget( "ui.dialog", {
	version: "1.12.0",
	options: {
		appendTo: "body",
		autoOpen: true,
		buttons: [],
		classes: {
			"ui-dialog": "ui-corner-all",
			"ui-dialog-titlebar": "ui-corner-all"
		},
		closeOnEscape: true,
		closeText: "Close",
		draggable: true,
		hide: null,
		height: "auto",
		maxHeight: null,
		maxWidth: null,
		minHeight: 150,
		minWidth: 150,
		modal: false,
		position: {
			my: "center",
			at: "center",
			of: window,
			collision: "fit",

			// Ensure the titlebar is always visible
			using: function( pos ) {
				var topOffset = $( this ).css( pos ).offset().top;
				if ( topOffset < 0 ) {
					$( this ).css( "top", pos.top - topOffset );
				}
			}
		},
		resizable: true,
		show: null,
		title: null,
		width: 300,

		// Callbacks
		beforeClose: null,
		close: null,
		drag: null,
		dragStart: null,
		dragStop: null,
		focus: null,
		open: null,
		resize: null,
		resizeStart: null,
		resizeStop: null
	},

	sizeRelatedOptions: {
		buttons: true,
		height: true,
		maxHeight: true,
		maxWidth: true,
		minHeight: true,
		minWidth: true,
		width: true
	},

	resizableRelatedOptions: {
		maxHeight: true,
		maxWidth: true,
		minHeight: true,
		minWidth: true
	},

	_create: function() {
		this.originalCss = {
			display: this.element[ 0 ].style.display,
			width: this.element[ 0 ].style.width,
			minHeight: this.element[ 0 ].style.minHeight,
			maxHeight: this.element[ 0 ].style.maxHeight,
			height: this.element[ 0 ].style.height
		};
		this.originalPosition = {
			parent: this.element.parent(),
			index: this.element.parent().children().index( this.element )
		};
		this.originalTitle = this.element.attr( "title" );
		if ( this.options.title == null && this.originalTitle != null ) {
			this.options.title = this.originalTitle;
		}

		// Dialogs can't be disabled
		if ( this.options.disabled ) {
			this.options.disabled = false;
		}

		this._createWrapper();

		this.element
			.show()
			.removeAttr( "title" )
			.appendTo( this.uiDialog );

		this._addClass( "ui-dialog-content", "ui-widget-content" );

		this._createTitlebar();
		this._createButtonPane();

		if ( this.options.draggable && $.fn.draggable ) {
			this._makeDraggable();
		}
		if ( this.options.resizable && $.fn.resizable ) {
			this._makeResizable();
		}

		this._isOpen = false;

		this._trackFocus();
	},

	_init: function() {
		if ( this.options.autoOpen ) {
			this.open();
		}
	},

	_appendTo: function() {
		var element = this.options.appendTo;
		if ( element && ( element.jquery || element.nodeType ) ) {
			return $( element );
		}
		return this.document.find( element || "body" ).eq( 0 );
	},

	_destroy: function() {
		var next,
			originalPosition = this.originalPosition;

		this._untrackInstance();
		this._destroyOverlay();

		this.element
			.removeUniqueId()
			.css( this.originalCss )

			// Without detaching first, the following becomes really slow
			.detach();

		this.uiDialog.remove();

		if ( this.originalTitle ) {
			this.element.attr( "title", this.originalTitle );
		}

		next = originalPosition.parent.children().eq( originalPosition.index );

		// Don't try to place the dialog next to itself (#8613)
		if ( next.length && next[ 0 ] !== this.element[ 0 ] ) {
			next.before( this.element );
		} else {
			originalPosition.parent.append( this.element );
		}
	},

	widget: function() {
		return this.uiDialog;
	},

	disable: $.noop,
	enable: $.noop,

	close: function( event ) {
		var that = this;

		if ( !this._isOpen || this._trigger( "beforeClose", event ) === false ) {
			return;
		}

		this._isOpen = false;
		this._focusedElement = null;
		this._destroyOverlay();
		this._untrackInstance();

		if ( !this.opener.filter( ":focusable" ).trigger( "focus" ).length ) {

			// Hiding a focused element doesn't trigger blur in WebKit
			// so in case we have nothing to focus on, explicitly blur the active element
			// https://bugs.webkit.org/show_bug.cgi?id=47182
			$.ui.safeBlur( $.ui.safeActiveElement( this.document[ 0 ] ) );
		}

		this._hide( this.uiDialog, this.options.hide, function() {
			that._trigger( "close", event );
		} );
	},

	isOpen: function() {
		return this._isOpen;
	},

	moveToTop: function() {
		this._moveToTop();
	},

	_moveToTop: function( event, silent ) {
		var moved = false,
			zIndices = this.uiDialog.siblings( ".ui-front:visible" ).map( function() {
				return +$( this ).css( "z-index" );
			} ).get(),
			zIndexMax = Math.max.apply( null, zIndices );

		if ( zIndexMax >= +this.uiDialog.css( "z-index" ) ) {
			this.uiDialog.css( "z-index", zIndexMax + 1 );
			moved = true;
		}

		if ( moved && !silent ) {
			this._trigger( "focus", event );
		}
		return moved;
	},

	open: function() {
		var that = this;
		if ( this._isOpen ) {
			if ( this._moveToTop() ) {
				this._focusTabbable();
			}
			return;
		}

		this._isOpen = true;
		this.opener = $( $.ui.safeActiveElement( this.document[ 0 ] ) );

		this._size();
		this._position();
		this._createOverlay();
		this._moveToTop( null, true );

		// Ensure the overlay is moved to the top with the dialog, but only when
		// opening. The overlay shouldn't move after the dialog is open so that
		// modeless dialogs opened after the modal dialog stack properly.
		if ( this.overlay ) {
			this.overlay.css( "z-index", this.uiDialog.css( "z-index" ) - 1 );
		}

		this._show( this.uiDialog, this.options.show, function() {
			that._focusTabbable();
			that._trigger( "focus" );
		} );

		// Track the dialog immediately upon openening in case a focus event
		// somehow occurs outside of the dialog before an element inside the
		// dialog is focused (#10152)
		this._makeFocusTarget();

		this._trigger( "open" );
	},

	_focusTabbable: function() {

		// Set focus to the first match:
		// 1. An element that was focused previously
		// 2. First element inside the dialog matching [autofocus]
		// 3. Tabbable element inside the content element
		// 4. Tabbable element inside the buttonpane
		// 5. The close button
		// 6. The dialog itself
		var hasFocus = this._focusedElement;
		if ( !hasFocus ) {
			hasFocus = this.element.find( "[autofocus]" );
		}
		if ( !hasFocus.length ) {
			hasFocus = this.element.find( ":tabbable" );
		}
		if ( !hasFocus.length ) {
			hasFocus = this.uiDialogButtonPane.find( ":tabbable" );
		}
		if ( !hasFocus.length ) {
			hasFocus = this.uiDialogTitlebarClose.filter( ":tabbable" );
		}
		if ( !hasFocus.length ) {
			hasFocus = this.uiDialog;
		}
		hasFocus.eq( 0 ).trigger( "focus" );
	},

	_keepFocus: function( event ) {
		function checkFocus() {
			var activeElement = $.ui.safeActiveElement( this.document[ 0 ] ),
				isActive = this.uiDialog[ 0 ] === activeElement ||
					$.contains( this.uiDialog[ 0 ], activeElement );
			if ( !isActive ) {
				this._focusTabbable();
			}
		}
		event.preventDefault();
		checkFocus.call( this );

		// support: IE
		// IE <= 8 doesn't prevent moving focus even with event.preventDefault()
		// so we check again later
		this._delay( checkFocus );
	},

	_createWrapper: function() {
		this.uiDialog = $( "<div>" )
			.hide()
			.attr( {

				// Setting tabIndex makes the div focusable
				tabIndex: -1,
				role: "dialog"
			} )
			.appendTo( this._appendTo() );

		this._addClass( this.uiDialog, "ui-dialog", "ui-widget ui-widget-content ui-front" );
		this._on( this.uiDialog, {
			keydown: function( event ) {
				if ( this.options.closeOnEscape && !event.isDefaultPrevented() && event.keyCode &&
						event.keyCode === $.ui.keyCode.ESCAPE ) {
					event.preventDefault();
					this.close( event );
					return;
				}

				// Prevent tabbing out of dialogs
				if ( event.keyCode !== $.ui.keyCode.TAB || event.isDefaultPrevented() ) {
					return;
				}
				var tabbables = this.uiDialog.find( ":tabbable" ),
					first = tabbables.filter( ":first" ),
					last = tabbables.filter( ":last" );

				if ( ( event.target === last[ 0 ] || event.target === this.uiDialog[ 0 ] ) &&
						!event.shiftKey ) {
					this._delay( function() {
						first.trigger( "focus" );
					} );
					event.preventDefault();
				} else if ( ( event.target === first[ 0 ] ||
						event.target === this.uiDialog[ 0 ] ) && event.shiftKey ) {
					this._delay( function() {
						last.trigger( "focus" );
					} );
					event.preventDefault();
				}
			},
			mousedown: function( event ) {
				if ( this._moveToTop( event ) ) {
					this._focusTabbable();
				}
			}
		} );

		// We assume that any existing aria-describedby attribute means
		// that the dialog content is marked up properly
		// otherwise we brute force the content as the description
		if ( !this.element.find( "[aria-describedby]" ).length ) {
			this.uiDialog.attr( {
				"aria-describedby": this.element.uniqueId().attr( "id" )
			} );
		}
	},

	_createTitlebar: function() {
		var uiDialogTitle;

		this.uiDialogTitlebar = $( "<div>" );
		this._addClass( this.uiDialogTitlebar,
			"ui-dialog-titlebar", "ui-widget-header ui-helper-clearfix" );
		this._on( this.uiDialogTitlebar, {
			mousedown: function( event ) {

				// Don't prevent click on close button (#8838)
				// Focusing a dialog that is partially scrolled out of view
				// causes the browser to scroll it into view, preventing the click event
				if ( !$( event.target ).closest( ".ui-dialog-titlebar-close" ) ) {

					// Dialog isn't getting focus when dragging (#8063)
					this.uiDialog.trigger( "focus" );
				}
			}
		} );

		// Support: IE
		// Use type="button" to prevent enter keypresses in textboxes from closing the
		// dialog in IE (#9312)
		this.uiDialogTitlebarClose = $( "<button type='button'></button>" )
			.button( {
				label: $( "<a>" ).text( this.options.closeText ).html(),
				icon: "ui-icon-closethick",
				showLabel: false
			} )
			.appendTo( this.uiDialogTitlebar );

		this._addClass( this.uiDialogTitlebarClose, "ui-dialog-titlebar-close" );
		this._on( this.uiDialogTitlebarClose, {
			click: function( event ) {
				event.preventDefault();
				this.close( event );
			}
		} );

		uiDialogTitle = $( "<span>" ).uniqueId().prependTo( this.uiDialogTitlebar );
		this._addClass( uiDialogTitle, "ui-dialog-title" );
		this._title( uiDialogTitle );

		this.uiDialogTitlebar.prependTo( this.uiDialog );

		this.uiDialog.attr( {
			"aria-labelledby": uiDialogTitle.attr( "id" )
		} );
	},

	_title: function( title ) {
		if ( this.options.title ) {
			title.text( this.options.title );
		} else {
			title.html( "&#160;" );
		}
	},

	_createButtonPane: function() {
		this.uiDialogButtonPane = $( "<div>" );
		this._addClass( this.uiDialogButtonPane, "ui-dialog-buttonpane",
			"ui-widget-content ui-helper-clearfix" );

		this.uiButtonSet = $( "<div>" )
			.appendTo( this.uiDialogButtonPane );
		this._addClass( this.uiButtonSet, "ui-dialog-buttonset" );

		this._createButtons();
	},

	_createButtons: function() {
		var that = this,
			buttons = this.options.buttons;

		// If we already have a button pane, remove it
		this.uiDialogButtonPane.remove();
		this.uiButtonSet.empty();

		if ( $.isEmptyObject( buttons ) || ( $.isArray( buttons ) && !buttons.length ) ) {
			this._removeClass( this.uiDialog, "ui-dialog-buttons" );
			return;
		}

		$.each( buttons, function( name, props ) {
			var click, buttonOptions;
			props = $.isFunction( props ) ?
				{ click: props, text: name } :
				props;

			// Default to a non-submitting button
			props = $.extend( { type: "button" }, props );

			// Change the context for the click callback to be the main element
			click = props.click;
			buttonOptions = {
				icon: props.icon,
				iconPosition: props.iconPosition,
				showLabel: props.showLabel
			};

			delete props.click;
			delete props.icon;
			delete props.iconPosition;
			delete props.showLabel;

			$( "<button></button>", props )
				.button( buttonOptions )
				.appendTo( that.uiButtonSet )
				.on( "click", function() {
					click.apply( that.element[ 0 ], arguments );
				} );
		} );
		this._addClass( this.uiDialog, "ui-dialog-buttons" );
		this.uiDialogButtonPane.appendTo( this.uiDialog );
	},

	_makeDraggable: function() {
		var that = this,
			options = this.options;

		function filteredUi( ui ) {
			return {
				position: ui.position,
				offset: ui.offset
			};
		}

		this.uiDialog.draggable( {
			cancel: ".ui-dialog-content, .ui-dialog-titlebar-close",
			handle: ".ui-dialog-titlebar",
			containment: "document",
			start: function( event, ui ) {
				that._addClass( $( this ), "ui-dialog-dragging" );
				that._blockFrames();
				that._trigger( "dragStart", event, filteredUi( ui ) );
			},
			drag: function( event, ui ) {
				that._trigger( "drag", event, filteredUi( ui ) );
			},
			stop: function( event, ui ) {
				var left = ui.offset.left - that.document.scrollLeft(),
					top = ui.offset.top - that.document.scrollTop();

				options.position = {
					my: "left top",
					at: "left" + ( left >= 0 ? "+" : "" ) + left + " " +
						"top" + ( top >= 0 ? "+" : "" ) + top,
					of: that.window
				};
				that._removeClass( $( this ), "ui-dialog-dragging" );
				that._unblockFrames();
				that._trigger( "dragStop", event, filteredUi( ui ) );
			}
		} );
	},

	_makeResizable: function() {
		var that = this,
			options = this.options,
			handles = options.resizable,

			// .ui-resizable has position: relative defined in the stylesheet
			// but dialogs have to use absolute or fixed positioning
			position = this.uiDialog.css( "position" ),
			resizeHandles = typeof handles === "string" ?
				handles :
				"n,e,s,w,se,sw,ne,nw";

		function filteredUi( ui ) {
			return {
				originalPosition: ui.originalPosition,
				originalSize: ui.originalSize,
				position: ui.position,
				size: ui.size
			};
		}

		this.uiDialog.resizable( {
			cancel: ".ui-dialog-content",
			containment: "document",
			alsoResize: this.element,
			maxWidth: options.maxWidth,
			maxHeight: options.maxHeight,
			minWidth: options.minWidth,
			minHeight: this._minHeight(),
			handles: resizeHandles,
			start: function( event, ui ) {
				that._addClass( $( this ), "ui-dialog-resizing" );
				that._blockFrames();
				that._trigger( "resizeStart", event, filteredUi( ui ) );
			},
			resize: function( event, ui ) {
				that._trigger( "resize", event, filteredUi( ui ) );
			},
			stop: function( event, ui ) {
				var offset = that.uiDialog.offset(),
					left = offset.left - that.document.scrollLeft(),
					top = offset.top - that.document.scrollTop();

				options.height = that.uiDialog.height();
				options.width = that.uiDialog.width();
				options.position = {
					my: "left top",
					at: "left" + ( left >= 0 ? "+" : "" ) + left + " " +
						"top" + ( top >= 0 ? "+" : "" ) + top,
					of: that.window
				};
				that._removeClass( $( this ), "ui-dialog-resizing" );
				that._unblockFrames();
				that._trigger( "resizeStop", event, filteredUi( ui ) );
			}
		} )
			.css( "position", position );
	},

	_trackFocus: function() {
		this._on( this.widget(), {
			focusin: function( event ) {
				this._makeFocusTarget();
				this._focusedElement = $( event.target );
			}
		} );
	},

	_makeFocusTarget: function() {
		this._untrackInstance();
		this._trackingInstances().unshift( this );
	},

	_untrackInstance: function() {
		var instances = this._trackingInstances(),
			exists = $.inArray( this, instances );
		if ( exists !== -1 ) {
			instances.splice( exists, 1 );
		}
	},

	_trackingInstances: function() {
		var instances = this.document.data( "ui-dialog-instances" );
		if ( !instances ) {
			instances = [];
			this.document.data( "ui-dialog-instances", instances );
		}
		return instances;
	},

	_minHeight: function() {
		var options = this.options;

		return options.height === "auto" ?
			options.minHeight :
			Math.min( options.minHeight, options.height );
	},

	_position: function() {

		// Need to show the dialog to get the actual offset in the position plugin
		var isVisible = this.uiDialog.is( ":visible" );
		if ( !isVisible ) {
			this.uiDialog.show();
		}
		this.uiDialog.position( this.options.position );
		if ( !isVisible ) {
			this.uiDialog.hide();
		}
	},

	_setOptions: function( options ) {
		var that = this,
			resize = false,
			resizableOptions = {};

		$.each( options, function( key, value ) {
			that._setOption( key, value );

			if ( key in that.sizeRelatedOptions ) {
				resize = true;
			}
			if ( key in that.resizableRelatedOptions ) {
				resizableOptions[ key ] = value;
			}
		} );

		if ( resize ) {
			this._size();
			this._position();
		}
		if ( this.uiDialog.is( ":data(ui-resizable)" ) ) {
			this.uiDialog.resizable( "option", resizableOptions );
		}
	},

	_setOption: function( key, value ) {
		var isDraggable, isResizable,
			uiDialog = this.uiDialog;

		if ( key === "disabled" ) {
			return;
		}

		this._super( key, value );

		if ( key === "appendTo" ) {
			this.uiDialog.appendTo( this._appendTo() );
		}

		if ( key === "buttons" ) {
			this._createButtons();
		}

		if ( key === "closeText" ) {
			this.uiDialogTitlebarClose.button( {

				// Ensure that we always pass a string
				label: $( "<a>" ).text( "" + this.options.closeText ).html()
			} );
		}

		if ( key === "draggable" ) {
			isDraggable = uiDialog.is( ":data(ui-draggable)" );
			if ( isDraggable && !value ) {
				uiDialog.draggable( "destroy" );
			}

			if ( !isDraggable && value ) {
				this._makeDraggable();
			}
		}

		if ( key === "position" ) {
			this._position();
		}

		if ( key === "resizable" ) {

			// currently resizable, becoming non-resizable
			isResizable = uiDialog.is( ":data(ui-resizable)" );
			if ( isResizable && !value ) {
				uiDialog.resizable( "destroy" );
			}

			// Currently resizable, changing handles
			if ( isResizable && typeof value === "string" ) {
				uiDialog.resizable( "option", "handles", value );
			}

			// Currently non-resizable, becoming resizable
			if ( !isResizable && value !== false ) {
				this._makeResizable();
			}
		}

		if ( key === "title" ) {
			this._title( this.uiDialogTitlebar.find( ".ui-dialog-title" ) );
		}
	},

	_size: function() {

		// If the user has resized the dialog, the .ui-dialog and .ui-dialog-content
		// divs will both have width and height set, so we need to reset them
		var nonContentHeight, minContentHeight, maxContentHeight,
			options = this.options;

		// Reset content sizing
		this.element.show().css( {
			width: "auto",
			minHeight: 0,
			maxHeight: "none",
			height: 0
		} );

		if ( options.minWidth > options.width ) {
			options.width = options.minWidth;
		}

		// Reset wrapper sizing
		// determine the height of all the non-content elements
		nonContentHeight = this.uiDialog.css( {
			height: "auto",
			width: options.width
		} )
			.outerHeight();
		minContentHeight = Math.max( 0, options.minHeight - nonContentHeight );
		maxContentHeight = typeof options.maxHeight === "number" ?
			Math.max( 0, options.maxHeight - nonContentHeight ) :
			"none";

		if ( options.height === "auto" ) {
			this.element.css( {
				minHeight: minContentHeight,
				maxHeight: maxContentHeight,
				height: "auto"
			} );
		} else {
			this.element.height( Math.max( 0, options.height - nonContentHeight ) );
		}

		if ( this.uiDialog.is( ":data(ui-resizable)" ) ) {
			this.uiDialog.resizable( "option", "minHeight", this._minHeight() );
		}
	},

	_blockFrames: function() {
		this.iframeBlocks = this.document.find( "iframe" ).map( function() {
			var iframe = $( this );

			return $( "<div>" )
				.css( {
					position: "absolute",
					width: iframe.outerWidth(),
					height: iframe.outerHeight()
				} )
				.appendTo( iframe.parent() )
				.offset( iframe.offset() )[ 0 ];
		} );
	},

	_unblockFrames: function() {
		if ( this.iframeBlocks ) {
			this.iframeBlocks.remove();
			delete this.iframeBlocks;
		}
	},

	_allowInteraction: function( event ) {
		if ( $( event.target ).closest( ".ui-dialog" ).length ) {
			return true;
		}

		// TODO: Remove hack when datepicker implements
		// the .ui-front logic (#8989)
		return !!$( event.target ).closest( ".ui-datepicker" ).length;
	},

	_createOverlay: function() {
		if ( !this.options.modal ) {
			return;
		}

		// We use a delay in case the overlay is created from an
		// event that we're going to be cancelling (#2804)
		var isOpening = true;
		this._delay( function() {
			isOpening = false;
		} );

		if ( !this.document.data( "ui-dialog-overlays" ) ) {

			// Prevent use of anchors and inputs
			// Using _on() for an event handler shared across many instances is
			// safe because the dialogs stack and must be closed in reverse order
			this._on( this.document, {
				focusin: function( event ) {
					if ( isOpening ) {
						return;
					}

					if ( !this._allowInteraction( event ) ) {
						event.preventDefault();
						this._trackingInstances()[ 0 ]._focusTabbable();
					}
				}
			} );
		}

		this.overlay = $( "<div>" )
			.appendTo( this._appendTo() );

		this._addClass( this.overlay, null, "ui-widget-overlay ui-front" );
		this._on( this.overlay, {
			mousedown: "_keepFocus"
		} );
		this.document.data( "ui-dialog-overlays",
			( this.document.data( "ui-dialog-overlays" ) || 0 ) + 1 );
	},

	_destroyOverlay: function() {
		if ( !this.options.modal ) {
			return;
		}

		if ( this.overlay ) {
			var overlays = this.document.data( "ui-dialog-overlays" ) - 1;

			if ( !overlays ) {
				this._off( this.document, "focusin" );
				this.document.removeData( "ui-dialog-overlays" );
			} else {
				this.document.data( "ui-dialog-overlays", overlays );
			}

			this.overlay.remove();
			this.overlay = null;
		}
	}
} );

// DEPRECATED
// TODO: switch return back to widget declaration at top of file when this is removed
if ( $.uiBackCompat !== false ) {

	// Backcompat for dialogClass option
	$.widget( "ui.dialog", $.ui.dialog, {
		options: {
			dialogClass: ""
		},
		_createWrapper: function() {
			this._super();
			this.uiDialog.addClass( this.options.dialogClass );
		},
		_setOption: function( key, value ) {
			if ( key === "dialogClass" ) {
				this.uiDialog
					.removeClass( this.options.dialogClass )
					.addClass( value );
			}
			this._superApply( arguments );
		}
	} );
}

return $.ui.dialog;

} ) );

},{}],31:[function(require,module,exports){
/*!
 * jQuery UI Draggable 1.12.0
 * http://jqueryui.com
 *
 * Copyright jQuery Foundation and other contributors
 * Released under the MIT license.
 * http://jquery.org/license
 */

//>>label: Draggable
//>>group: Interactions
//>>description: Enables dragging functionality for any element.
//>>docs: http://api.jqueryui.com/draggable/
//>>demos: http://jqueryui.com/draggable/
//>>css.structure: ../../themes/base/draggable.css

( function( factory ) {
	if ( typeof define === "function" && define.amd ) {

		// AMD. Register as an anonymous module.
		define( [
			"jquery",
			"./mouse",
			"../data",
			"../plugin",
			"../safe-active-element",
			"../safe-blur",
			"../scroll-parent",
			"../version",
			"../widget"
		], factory );
	} else {

		// Browser globals
		factory( jQuery );
	}
}( function( $ ) {

$.widget( "ui.draggable", $.ui.mouse, {
	version: "1.12.0",
	widgetEventPrefix: "drag",
	options: {
		addClasses: true,
		appendTo: "parent",
		axis: false,
		connectToSortable: false,
		containment: false,
		cursor: "auto",
		cursorAt: false,
		grid: false,
		handle: false,
		helper: "original",
		iframeFix: false,
		opacity: false,
		refreshPositions: false,
		revert: false,
		revertDuration: 500,
		scope: "default",
		scroll: true,
		scrollSensitivity: 20,
		scrollSpeed: 20,
		snap: false,
		snapMode: "both",
		snapTolerance: 20,
		stack: false,
		zIndex: false,

		// Callbacks
		drag: null,
		start: null,
		stop: null
	},
	_create: function() {

		if ( this.options.helper === "original" ) {
			this._setPositionRelative();
		}
		if ( this.options.addClasses ) {
			this._addClass( "ui-draggable" );
		}
		this._setHandleClassName();

		this._mouseInit();
	},

	_setOption: function( key, value ) {
		this._super( key, value );
		if ( key === "handle" ) {
			this._removeHandleClassName();
			this._setHandleClassName();
		}
	},

	_destroy: function() {
		if ( ( this.helper || this.element ).is( ".ui-draggable-dragging" ) ) {
			this.destroyOnClear = true;
			return;
		}
		this._removeHandleClassName();
		this._mouseDestroy();
	},

	_mouseCapture: function( event ) {
		var o = this.options;

		this._blurActiveElement( event );

		// Among others, prevent a drag on a resizable-handle
		if ( this.helper || o.disabled ||
				$( event.target ).closest( ".ui-resizable-handle" ).length > 0 ) {
			return false;
		}

		//Quit if we're not on a valid handle
		this.handle = this._getHandle( event );
		if ( !this.handle ) {
			return false;
		}

		this._blockFrames( o.iframeFix === true ? "iframe" : o.iframeFix );

		return true;

	},

	_blockFrames: function( selector ) {
		this.iframeBlocks = this.document.find( selector ).map( function() {
			var iframe = $( this );

			return $( "<div>" )
				.css( "position", "absolute" )
				.appendTo( iframe.parent() )
				.outerWidth( iframe.outerWidth() )
				.outerHeight( iframe.outerHeight() )
				.offset( iframe.offset() )[ 0 ];
		} );
	},

	_unblockFrames: function() {
		if ( this.iframeBlocks ) {
			this.iframeBlocks.remove();
			delete this.iframeBlocks;
		}
	},

	_blurActiveElement: function( event ) {
		var activeElement = $.ui.safeActiveElement( this.document[ 0 ] ),
			target = $( event.target );

		// Only blur if the event occurred on an element that is:
		// 1) within the draggable handle
		// 2) but not within the currently focused element
		// See #10527, #12472
		if ( this._getHandle( event ) && target.closest( activeElement ).length ) {
			return;
		}

		// Blur any element that currently has focus, see #4261
		$.ui.safeBlur( activeElement );
	},

	_mouseStart: function( event ) {

		var o = this.options;

		//Create and append the visible helper
		this.helper = this._createHelper( event );

		this._addClass( this.helper, "ui-draggable-dragging" );

		//Cache the helper size
		this._cacheHelperProportions();

		//If ddmanager is used for droppables, set the global draggable
		if ( $.ui.ddmanager ) {
			$.ui.ddmanager.current = this;
		}

		/*
		 * - Position generation -
		 * This block generates everything position related - it's the core of draggables.
		 */

		//Cache the margins of the original element
		this._cacheMargins();

		//Store the helper's css position
		this.cssPosition = this.helper.css( "position" );
		this.scrollParent = this.helper.scrollParent( true );
		this.offsetParent = this.helper.offsetParent();
		this.hasFixedAncestor = this.helper.parents().filter( function() {
				return $( this ).css( "position" ) === "fixed";
			} ).length > 0;

		//The element's absolute position on the page minus margins
		this.positionAbs = this.element.offset();
		this._refreshOffsets( event );

		//Generate the original position
		this.originalPosition = this.position = this._generatePosition( event, false );
		this.originalPageX = event.pageX;
		this.originalPageY = event.pageY;

		//Adjust the mouse offset relative to the helper if "cursorAt" is supplied
		( o.cursorAt && this._adjustOffsetFromHelper( o.cursorAt ) );

		//Set a containment if given in the options
		this._setContainment();

		//Trigger event + callbacks
		if ( this._trigger( "start", event ) === false ) {
			this._clear();
			return false;
		}

		//Recache the helper size
		this._cacheHelperProportions();

		//Prepare the droppable offsets
		if ( $.ui.ddmanager && !o.dropBehaviour ) {
			$.ui.ddmanager.prepareOffsets( this, event );
		}

		// Execute the drag once - this causes the helper not to be visible before getting its
		// correct position
		this._mouseDrag( event, true );

		// If the ddmanager is used for droppables, inform the manager that dragging has started
		// (see #5003)
		if ( $.ui.ddmanager ) {
			$.ui.ddmanager.dragStart( this, event );
		}

		return true;
	},

	_refreshOffsets: function( event ) {
		this.offset = {
			top: this.positionAbs.top - this.margins.top,
			left: this.positionAbs.left - this.margins.left,
			scroll: false,
			parent: this._getParentOffset(),
			relative: this._getRelativeOffset()
		};

		this.offset.click = {
			left: event.pageX - this.offset.left,
			top: event.pageY - this.offset.top
		};
	},

	_mouseDrag: function( event, noPropagation ) {

		// reset any necessary cached properties (see #5009)
		if ( this.hasFixedAncestor ) {
			this.offset.parent = this._getParentOffset();
		}

		//Compute the helpers position
		this.position = this._generatePosition( event, true );
		this.positionAbs = this._convertPositionTo( "absolute" );

		//Call plugins and callbacks and use the resulting position if something is returned
		if ( !noPropagation ) {
			var ui = this._uiHash();
			if ( this._trigger( "drag", event, ui ) === false ) {
				this._mouseUp( new $.Event( "mouseup", event ) );
				return false;
			}
			this.position = ui.position;
		}

		this.helper[ 0 ].style.left = this.position.left + "px";
		this.helper[ 0 ].style.top = this.position.top + "px";

		if ( $.ui.ddmanager ) {
			$.ui.ddmanager.drag( this, event );
		}

		return false;
	},

	_mouseStop: function( event ) {

		//If we are using droppables, inform the manager about the drop
		var that = this,
			dropped = false;
		if ( $.ui.ddmanager && !this.options.dropBehaviour ) {
			dropped = $.ui.ddmanager.drop( this, event );
		}

		//if a drop comes from outside (a sortable)
		if ( this.dropped ) {
			dropped = this.dropped;
			this.dropped = false;
		}

		if ( ( this.options.revert === "invalid" && !dropped ) ||
				( this.options.revert === "valid" && dropped ) ||
				this.options.revert === true || ( $.isFunction( this.options.revert ) &&
				this.options.revert.call( this.element, dropped ) )
		) {
			$( this.helper ).animate(
				this.originalPosition,
				parseInt( this.options.revertDuration, 10 ),
				function() {
					if ( that._trigger( "stop", event ) !== false ) {
						that._clear();
					}
				}
			);
		} else {
			if ( this._trigger( "stop", event ) !== false ) {
				this._clear();
			}
		}

		return false;
	},

	_mouseUp: function( event ) {
		this._unblockFrames();

		// If the ddmanager is used for droppables, inform the manager that dragging has stopped
		// (see #5003)
		if ( $.ui.ddmanager ) {
			$.ui.ddmanager.dragStop( this, event );
		}

		// Only need to focus if the event occurred on the draggable itself, see #10527
		if ( this.handleElement.is( event.target ) ) {

			// The interaction is over; whether or not the click resulted in a drag,
			// focus the element
			this.element.trigger( "focus" );
		}

		return $.ui.mouse.prototype._mouseUp.call( this, event );
	},

	cancel: function() {

		if ( this.helper.is( ".ui-draggable-dragging" ) ) {
			this._mouseUp( new $.Event( "mouseup", { target: this.element[ 0 ] } ) );
		} else {
			this._clear();
		}

		return this;

	},

	_getHandle: function( event ) {
		return this.options.handle ?
			!!$( event.target ).closest( this.element.find( this.options.handle ) ).length :
			true;
	},

	_setHandleClassName: function() {
		this.handleElement = this.options.handle ?
			this.element.find( this.options.handle ) : this.element;
		this._addClass( this.handleElement, "ui-draggable-handle" );
	},

	_removeHandleClassName: function() {
		this._removeClass( this.handleElement, "ui-draggable-handle" );
	},

	_createHelper: function( event ) {

		var o = this.options,
			helperIsFunction = $.isFunction( o.helper ),
			helper = helperIsFunction ?
				$( o.helper.apply( this.element[ 0 ], [ event ] ) ) :
				( o.helper === "clone" ?
					this.element.clone().removeAttr( "id" ) :
					this.element );

		if ( !helper.parents( "body" ).length ) {
			helper.appendTo( ( o.appendTo === "parent" ?
				this.element[ 0 ].parentNode :
				o.appendTo ) );
		}

		// Http://bugs.jqueryui.com/ticket/9446
		// a helper function can return the original element
		// which wouldn't have been set to relative in _create
		if ( helperIsFunction && helper[ 0 ] === this.element[ 0 ] ) {
			this._setPositionRelative();
		}

		if ( helper[ 0 ] !== this.element[ 0 ] &&
				!( /(fixed|absolute)/ ).test( helper.css( "position" ) ) ) {
			helper.css( "position", "absolute" );
		}

		return helper;

	},

	_setPositionRelative: function() {
		if ( !( /^(?:r|a|f)/ ).test( this.element.css( "position" ) ) ) {
			this.element[ 0 ].style.position = "relative";
		}
	},

	_adjustOffsetFromHelper: function( obj ) {
		if ( typeof obj === "string" ) {
			obj = obj.split( " " );
		}
		if ( $.isArray( obj ) ) {
			obj = { left: +obj[ 0 ], top: +obj[ 1 ] || 0 };
		}
		if ( "left" in obj ) {
			this.offset.click.left = obj.left + this.margins.left;
		}
		if ( "right" in obj ) {
			this.offset.click.left = this.helperProportions.width - obj.right + this.margins.left;
		}
		if ( "top" in obj ) {
			this.offset.click.top = obj.top + this.margins.top;
		}
		if ( "bottom" in obj ) {
			this.offset.click.top = this.helperProportions.height - obj.bottom + this.margins.top;
		}
	},

	_isRootNode: function( element ) {
		return ( /(html|body)/i ).test( element.tagName ) || element === this.document[ 0 ];
	},

	_getParentOffset: function() {

		//Get the offsetParent and cache its position
		var po = this.offsetParent.offset(),
			document = this.document[ 0 ];

		// This is a special case where we need to modify a offset calculated on start, since the
		// following happened:
		// 1. The position of the helper is absolute, so it's position is calculated based on the
		// next positioned parent
		// 2. The actual offset parent is a child of the scroll parent, and the scroll parent isn't
		// the document, which means that the scroll is included in the initial calculation of the
		// offset of the parent, and never recalculated upon drag
		if ( this.cssPosition === "absolute" && this.scrollParent[ 0 ] !== document &&
				$.contains( this.scrollParent[ 0 ], this.offsetParent[ 0 ] ) ) {
			po.left += this.scrollParent.scrollLeft();
			po.top += this.scrollParent.scrollTop();
		}

		if ( this._isRootNode( this.offsetParent[ 0 ] ) ) {
			po = { top: 0, left: 0 };
		}

		return {
			top: po.top + ( parseInt( this.offsetParent.css( "borderTopWidth" ), 10 ) || 0 ),
			left: po.left + ( parseInt( this.offsetParent.css( "borderLeftWidth" ), 10 ) || 0 )
		};

	},

	_getRelativeOffset: function() {
		if ( this.cssPosition !== "relative" ) {
			return { top: 0, left: 0 };
		}

		var p = this.element.position(),
			scrollIsRootNode = this._isRootNode( this.scrollParent[ 0 ] );

		return {
			top: p.top - ( parseInt( this.helper.css( "top" ), 10 ) || 0 ) +
				( !scrollIsRootNode ? this.scrollParent.scrollTop() : 0 ),
			left: p.left - ( parseInt( this.helper.css( "left" ), 10 ) || 0 ) +
				( !scrollIsRootNode ? this.scrollParent.scrollLeft() : 0 )
		};

	},

	_cacheMargins: function() {
		this.margins = {
			left: ( parseInt( this.element.css( "marginLeft" ), 10 ) || 0 ),
			top: ( parseInt( this.element.css( "marginTop" ), 10 ) || 0 ),
			right: ( parseInt( this.element.css( "marginRight" ), 10 ) || 0 ),
			bottom: ( parseInt( this.element.css( "marginBottom" ), 10 ) || 0 )
		};
	},

	_cacheHelperProportions: function() {
		this.helperProportions = {
			width: this.helper.outerWidth(),
			height: this.helper.outerHeight()
		};
	},

	_setContainment: function() {

		var isUserScrollable, c, ce,
			o = this.options,
			document = this.document[ 0 ];

		this.relativeContainer = null;

		if ( !o.containment ) {
			this.containment = null;
			return;
		}

		if ( o.containment === "window" ) {
			this.containment = [
				$( window ).scrollLeft() - this.offset.relative.left - this.offset.parent.left,
				$( window ).scrollTop() - this.offset.relative.top - this.offset.parent.top,
				$( window ).scrollLeft() + $( window ).width() -
					this.helperProportions.width - this.margins.left,
				$( window ).scrollTop() +
					( $( window ).height() || document.body.parentNode.scrollHeight ) -
					this.helperProportions.height - this.margins.top
			];
			return;
		}

		if ( o.containment === "document" ) {
			this.containment = [
				0,
				0,
				$( document ).width() - this.helperProportions.width - this.margins.left,
				( $( document ).height() || document.body.parentNode.scrollHeight ) -
					this.helperProportions.height - this.margins.top
			];
			return;
		}

		if ( o.containment.constructor === Array ) {
			this.containment = o.containment;
			return;
		}

		if ( o.containment === "parent" ) {
			o.containment = this.helper[ 0 ].parentNode;
		}

		c = $( o.containment );
		ce = c[ 0 ];

		if ( !ce ) {
			return;
		}

		isUserScrollable = /(scroll|auto)/.test( c.css( "overflow" ) );

		this.containment = [
			( parseInt( c.css( "borderLeftWidth" ), 10 ) || 0 ) +
				( parseInt( c.css( "paddingLeft" ), 10 ) || 0 ),
			( parseInt( c.css( "borderTopWidth" ), 10 ) || 0 ) +
				( parseInt( c.css( "paddingTop" ), 10 ) || 0 ),
			( isUserScrollable ? Math.max( ce.scrollWidth, ce.offsetWidth ) : ce.offsetWidth ) -
				( parseInt( c.css( "borderRightWidth" ), 10 ) || 0 ) -
				( parseInt( c.css( "paddingRight" ), 10 ) || 0 ) -
				this.helperProportions.width -
				this.margins.left -
				this.margins.right,
			( isUserScrollable ? Math.max( ce.scrollHeight, ce.offsetHeight ) : ce.offsetHeight ) -
				( parseInt( c.css( "borderBottomWidth" ), 10 ) || 0 ) -
				( parseInt( c.css( "paddingBottom" ), 10 ) || 0 ) -
				this.helperProportions.height -
				this.margins.top -
				this.margins.bottom
		];
		this.relativeContainer = c;
	},

	_convertPositionTo: function( d, pos ) {

		if ( !pos ) {
			pos = this.position;
		}

		var mod = d === "absolute" ? 1 : -1,
			scrollIsRootNode = this._isRootNode( this.scrollParent[ 0 ] );

		return {
			top: (

				// The absolute mouse position
				pos.top	+

				// Only for relative positioned nodes: Relative offset from element to offset parent
				this.offset.relative.top * mod +

				// The offsetParent's offset without borders (offset + border)
				this.offset.parent.top * mod -
				( ( this.cssPosition === "fixed" ?
					-this.offset.scroll.top :
					( scrollIsRootNode ? 0 : this.offset.scroll.top ) ) * mod )
			),
			left: (

				// The absolute mouse position
				pos.left +

				// Only for relative positioned nodes: Relative offset from element to offset parent
				this.offset.relative.left * mod +

				// The offsetParent's offset without borders (offset + border)
				this.offset.parent.left * mod	-
				( ( this.cssPosition === "fixed" ?
					-this.offset.scroll.left :
					( scrollIsRootNode ? 0 : this.offset.scroll.left ) ) * mod )
			)
		};

	},

	_generatePosition: function( event, constrainPosition ) {

		var containment, co, top, left,
			o = this.options,
			scrollIsRootNode = this._isRootNode( this.scrollParent[ 0 ] ),
			pageX = event.pageX,
			pageY = event.pageY;

		// Cache the scroll
		if ( !scrollIsRootNode || !this.offset.scroll ) {
			this.offset.scroll = {
				top: this.scrollParent.scrollTop(),
				left: this.scrollParent.scrollLeft()
			};
		}

		/*
		 * - Position constraining -
		 * Constrain the position to a mix of grid, containment.
		 */

		// If we are not dragging yet, we won't check for options
		if ( constrainPosition ) {
			if ( this.containment ) {
				if ( this.relativeContainer ) {
					co = this.relativeContainer.offset();
					containment = [
						this.containment[ 0 ] + co.left,
						this.containment[ 1 ] + co.top,
						this.containment[ 2 ] + co.left,
						this.containment[ 3 ] + co.top
					];
				} else {
					containment = this.containment;
				}

				if ( event.pageX - this.offset.click.left < containment[ 0 ] ) {
					pageX = containment[ 0 ] + this.offset.click.left;
				}
				if ( event.pageY - this.offset.click.top < containment[ 1 ] ) {
					pageY = containment[ 1 ] + this.offset.click.top;
				}
				if ( event.pageX - this.offset.click.left > containment[ 2 ] ) {
					pageX = containment[ 2 ] + this.offset.click.left;
				}
				if ( event.pageY - this.offset.click.top > containment[ 3 ] ) {
					pageY = containment[ 3 ] + this.offset.click.top;
				}
			}

			if ( o.grid ) {

				//Check for grid elements set to 0 to prevent divide by 0 error causing invalid
				// argument errors in IE (see ticket #6950)
				top = o.grid[ 1 ] ? this.originalPageY + Math.round( ( pageY -
					this.originalPageY ) / o.grid[ 1 ] ) * o.grid[ 1 ] : this.originalPageY;
				pageY = containment ? ( ( top - this.offset.click.top >= containment[ 1 ] ||
					top - this.offset.click.top > containment[ 3 ] ) ?
						top :
						( ( top - this.offset.click.top >= containment[ 1 ] ) ?
							top - o.grid[ 1 ] : top + o.grid[ 1 ] ) ) : top;

				left = o.grid[ 0 ] ? this.originalPageX +
					Math.round( ( pageX - this.originalPageX ) / o.grid[ 0 ] ) * o.grid[ 0 ] :
					this.originalPageX;
				pageX = containment ? ( ( left - this.offset.click.left >= containment[ 0 ] ||
					left - this.offset.click.left > containment[ 2 ] ) ?
						left :
						( ( left - this.offset.click.left >= containment[ 0 ] ) ?
							left - o.grid[ 0 ] : left + o.grid[ 0 ] ) ) : left;
			}

			if ( o.axis === "y" ) {
				pageX = this.originalPageX;
			}

			if ( o.axis === "x" ) {
				pageY = this.originalPageY;
			}
		}

		return {
			top: (

				// The absolute mouse position
				pageY -

				// Click offset (relative to the element)
				this.offset.click.top -

				// Only for relative positioned nodes: Relative offset from element to offset parent
				this.offset.relative.top -

				// The offsetParent's offset without borders (offset + border)
				this.offset.parent.top +
				( this.cssPosition === "fixed" ?
					-this.offset.scroll.top :
					( scrollIsRootNode ? 0 : this.offset.scroll.top ) )
			),
			left: (

				// The absolute mouse position
				pageX -

				// Click offset (relative to the element)
				this.offset.click.left -

				// Only for relative positioned nodes: Relative offset from element to offset parent
				this.offset.relative.left -

				// The offsetParent's offset without borders (offset + border)
				this.offset.parent.left +
				( this.cssPosition === "fixed" ?
					-this.offset.scroll.left :
					( scrollIsRootNode ? 0 : this.offset.scroll.left ) )
			)
		};

	},

	_clear: function() {
		this._removeClass( this.helper, "ui-draggable-dragging" );
		if ( this.helper[ 0 ] !== this.element[ 0 ] && !this.cancelHelperRemoval ) {
			this.helper.remove();
		}
		this.helper = null;
		this.cancelHelperRemoval = false;
		if ( this.destroyOnClear ) {
			this.destroy();
		}
	},

	// From now on bulk stuff - mainly helpers

	_trigger: function( type, event, ui ) {
		ui = ui || this._uiHash();
		$.ui.plugin.call( this, type, [ event, ui, this ], true );

		// Absolute position and offset (see #6884 ) have to be recalculated after plugins
		if ( /^(drag|start|stop)/.test( type ) ) {
			this.positionAbs = this._convertPositionTo( "absolute" );
			ui.offset = this.positionAbs;
		}
		return $.Widget.prototype._trigger.call( this, type, event, ui );
	},

	plugins: {},

	_uiHash: function() {
		return {
			helper: this.helper,
			position: this.position,
			originalPosition: this.originalPosition,
			offset: this.positionAbs
		};
	}

} );

$.ui.plugin.add( "draggable", "connectToSortable", {
	start: function( event, ui, draggable ) {
		var uiSortable = $.extend( {}, ui, {
			item: draggable.element
		} );

		draggable.sortables = [];
		$( draggable.options.connectToSortable ).each( function() {
			var sortable = $( this ).sortable( "instance" );

			if ( sortable && !sortable.options.disabled ) {
				draggable.sortables.push( sortable );

				// RefreshPositions is called at drag start to refresh the containerCache
				// which is used in drag. This ensures it's initialized and synchronized
				// with any changes that might have happened on the page since initialization.
				sortable.refreshPositions();
				sortable._trigger( "activate", event, uiSortable );
			}
		} );
	},
	stop: function( event, ui, draggable ) {
		var uiSortable = $.extend( {}, ui, {
			item: draggable.element
		} );

		draggable.cancelHelperRemoval = false;

		$.each( draggable.sortables, function() {
			var sortable = this;

			if ( sortable.isOver ) {
				sortable.isOver = 0;

				// Allow this sortable to handle removing the helper
				draggable.cancelHelperRemoval = true;
				sortable.cancelHelperRemoval = false;

				// Use _storedCSS To restore properties in the sortable,
				// as this also handles revert (#9675) since the draggable
				// may have modified them in unexpected ways (#8809)
				sortable._storedCSS = {
					position: sortable.placeholder.css( "position" ),
					top: sortable.placeholder.css( "top" ),
					left: sortable.placeholder.css( "left" )
				};

				sortable._mouseStop( event );

				// Once drag has ended, the sortable should return to using
				// its original helper, not the shared helper from draggable
				sortable.options.helper = sortable.options._helper;
			} else {

				// Prevent this Sortable from removing the helper.
				// However, don't set the draggable to remove the helper
				// either as another connected Sortable may yet handle the removal.
				sortable.cancelHelperRemoval = true;

				sortable._trigger( "deactivate", event, uiSortable );
			}
		} );
	},
	drag: function( event, ui, draggable ) {
		$.each( draggable.sortables, function() {
			var innermostIntersecting = false,
				sortable = this;

			// Copy over variables that sortable's _intersectsWith uses
			sortable.positionAbs = draggable.positionAbs;
			sortable.helperProportions = draggable.helperProportions;
			sortable.offset.click = draggable.offset.click;

			if ( sortable._intersectsWith( sortable.containerCache ) ) {
				innermostIntersecting = true;

				$.each( draggable.sortables, function() {

					// Copy over variables that sortable's _intersectsWith uses
					this.positionAbs = draggable.positionAbs;
					this.helperProportions = draggable.helperProportions;
					this.offset.click = draggable.offset.click;

					if ( this !== sortable &&
							this._intersectsWith( this.containerCache ) &&
							$.contains( sortable.element[ 0 ], this.element[ 0 ] ) ) {
						innermostIntersecting = false;
					}

					return innermostIntersecting;
				} );
			}

			if ( innermostIntersecting ) {

				// If it intersects, we use a little isOver variable and set it once,
				// so that the move-in stuff gets fired only once.
				if ( !sortable.isOver ) {
					sortable.isOver = 1;

					// Store draggable's parent in case we need to reappend to it later.
					draggable._parent = ui.helper.parent();

					sortable.currentItem = ui.helper
						.appendTo( sortable.element )
						.data( "ui-sortable-item", true );

					// Store helper option to later restore it
					sortable.options._helper = sortable.options.helper;

					sortable.options.helper = function() {
						return ui.helper[ 0 ];
					};

					// Fire the start events of the sortable with our passed browser event,
					// and our own helper (so it doesn't create a new one)
					event.target = sortable.currentItem[ 0 ];
					sortable._mouseCapture( event, true );
					sortable._mouseStart( event, true, true );

					// Because the browser event is way off the new appended portlet,
					// modify necessary variables to reflect the changes
					sortable.offset.click.top = draggable.offset.click.top;
					sortable.offset.click.left = draggable.offset.click.left;
					sortable.offset.parent.left -= draggable.offset.parent.left -
						sortable.offset.parent.left;
					sortable.offset.parent.top -= draggable.offset.parent.top -
						sortable.offset.parent.top;

					draggable._trigger( "toSortable", event );

					// Inform draggable that the helper is in a valid drop zone,
					// used solely in the revert option to handle "valid/invalid".
					draggable.dropped = sortable.element;

					// Need to refreshPositions of all sortables in the case that
					// adding to one sortable changes the location of the other sortables (#9675)
					$.each( draggable.sortables, function() {
						this.refreshPositions();
					} );

					// Hack so receive/update callbacks work (mostly)
					draggable.currentItem = draggable.element;
					sortable.fromOutside = draggable;
				}

				if ( sortable.currentItem ) {
					sortable._mouseDrag( event );

					// Copy the sortable's position because the draggable's can potentially reflect
					// a relative position, while sortable is always absolute, which the dragged
					// element has now become. (#8809)
					ui.position = sortable.position;
				}
			} else {

				// If it doesn't intersect with the sortable, and it intersected before,
				// we fake the drag stop of the sortable, but make sure it doesn't remove
				// the helper by using cancelHelperRemoval.
				if ( sortable.isOver ) {

					sortable.isOver = 0;
					sortable.cancelHelperRemoval = true;

					// Calling sortable's mouseStop would trigger a revert,
					// so revert must be temporarily false until after mouseStop is called.
					sortable.options._revert = sortable.options.revert;
					sortable.options.revert = false;

					sortable._trigger( "out", event, sortable._uiHash( sortable ) );
					sortable._mouseStop( event, true );

					// Restore sortable behaviors that were modfied
					// when the draggable entered the sortable area (#9481)
					sortable.options.revert = sortable.options._revert;
					sortable.options.helper = sortable.options._helper;

					if ( sortable.placeholder ) {
						sortable.placeholder.remove();
					}

					// Restore and recalculate the draggable's offset considering the sortable
					// may have modified them in unexpected ways. (#8809, #10669)
					ui.helper.appendTo( draggable._parent );
					draggable._refreshOffsets( event );
					ui.position = draggable._generatePosition( event, true );

					draggable._trigger( "fromSortable", event );

					// Inform draggable that the helper is no longer in a valid drop zone
					draggable.dropped = false;

					// Need to refreshPositions of all sortables just in case removing
					// from one sortable changes the location of other sortables (#9675)
					$.each( draggable.sortables, function() {
						this.refreshPositions();
					} );
				}
			}
		} );
	}
} );

$.ui.plugin.add( "draggable", "cursor", {
	start: function( event, ui, instance ) {
		var t = $( "body" ),
			o = instance.options;

		if ( t.css( "cursor" ) ) {
			o._cursor = t.css( "cursor" );
		}
		t.css( "cursor", o.cursor );
	},
	stop: function( event, ui, instance ) {
		var o = instance.options;
		if ( o._cursor ) {
			$( "body" ).css( "cursor", o._cursor );
		}
	}
} );

$.ui.plugin.add( "draggable", "opacity", {
	start: function( event, ui, instance ) {
		var t = $( ui.helper ),
			o = instance.options;
		if ( t.css( "opacity" ) ) {
			o._opacity = t.css( "opacity" );
		}
		t.css( "opacity", o.opacity );
	},
	stop: function( event, ui, instance ) {
		var o = instance.options;
		if ( o._opacity ) {
			$( ui.helper ).css( "opacity", o._opacity );
		}
	}
} );

$.ui.plugin.add( "draggable", "scroll", {
	start: function( event, ui, i ) {
		if ( !i.scrollParentNotHidden ) {
			i.scrollParentNotHidden = i.helper.scrollParent( false );
		}

		if ( i.scrollParentNotHidden[ 0 ] !== i.document[ 0 ] &&
				i.scrollParentNotHidden[ 0 ].tagName !== "HTML" ) {
			i.overflowOffset = i.scrollParentNotHidden.offset();
		}
	},
	drag: function( event, ui, i  ) {

		var o = i.options,
			scrolled = false,
			scrollParent = i.scrollParentNotHidden[ 0 ],
			document = i.document[ 0 ];

		if ( scrollParent !== document && scrollParent.tagName !== "HTML" ) {
			if ( !o.axis || o.axis !== "x" ) {
				if ( ( i.overflowOffset.top + scrollParent.offsetHeight ) - event.pageY <
						o.scrollSensitivity ) {
					scrollParent.scrollTop = scrolled = scrollParent.scrollTop + o.scrollSpeed;
				} else if ( event.pageY - i.overflowOffset.top < o.scrollSensitivity ) {
					scrollParent.scrollTop = scrolled = scrollParent.scrollTop - o.scrollSpeed;
				}
			}

			if ( !o.axis || o.axis !== "y" ) {
				if ( ( i.overflowOffset.left + scrollParent.offsetWidth ) - event.pageX <
						o.scrollSensitivity ) {
					scrollParent.scrollLeft = scrolled = scrollParent.scrollLeft + o.scrollSpeed;
				} else if ( event.pageX - i.overflowOffset.left < o.scrollSensitivity ) {
					scrollParent.scrollLeft = scrolled = scrollParent.scrollLeft - o.scrollSpeed;
				}
			}

		} else {

			if ( !o.axis || o.axis !== "x" ) {
				if ( event.pageY - $( document ).scrollTop() < o.scrollSensitivity ) {
					scrolled = $( document ).scrollTop( $( document ).scrollTop() - o.scrollSpeed );
				} else if ( $( window ).height() - ( event.pageY - $( document ).scrollTop() ) <
						o.scrollSensitivity ) {
					scrolled = $( document ).scrollTop( $( document ).scrollTop() + o.scrollSpeed );
				}
			}

			if ( !o.axis || o.axis !== "y" ) {
				if ( event.pageX - $( document ).scrollLeft() < o.scrollSensitivity ) {
					scrolled = $( document ).scrollLeft(
						$( document ).scrollLeft() - o.scrollSpeed
					);
				} else if ( $( window ).width() - ( event.pageX - $( document ).scrollLeft() ) <
						o.scrollSensitivity ) {
					scrolled = $( document ).scrollLeft(
						$( document ).scrollLeft() + o.scrollSpeed
					);
				}
			}

		}

		if ( scrolled !== false && $.ui.ddmanager && !o.dropBehaviour ) {
			$.ui.ddmanager.prepareOffsets( i, event );
		}

	}
} );

$.ui.plugin.add( "draggable", "snap", {
	start: function( event, ui, i ) {

		var o = i.options;

		i.snapElements = [];

		$( o.snap.constructor !== String ? ( o.snap.items || ":data(ui-draggable)" ) : o.snap )
			.each( function() {
				var $t = $( this ),
					$o = $t.offset();
				if ( this !== i.element[ 0 ] ) {
					i.snapElements.push( {
						item: this,
						width: $t.outerWidth(), height: $t.outerHeight(),
						top: $o.top, left: $o.left
					} );
				}
			} );

	},
	drag: function( event, ui, inst ) {

		var ts, bs, ls, rs, l, r, t, b, i, first,
			o = inst.options,
			d = o.snapTolerance,
			x1 = ui.offset.left, x2 = x1 + inst.helperProportions.width,
			y1 = ui.offset.top, y2 = y1 + inst.helperProportions.height;

		for ( i = inst.snapElements.length - 1; i >= 0; i-- ) {

			l = inst.snapElements[ i ].left - inst.margins.left;
			r = l + inst.snapElements[ i ].width;
			t = inst.snapElements[ i ].top - inst.margins.top;
			b = t + inst.snapElements[ i ].height;

			if ( x2 < l - d || x1 > r + d || y2 < t - d || y1 > b + d ||
					!$.contains( inst.snapElements[ i ].item.ownerDocument,
					inst.snapElements[ i ].item ) ) {
				if ( inst.snapElements[ i ].snapping ) {
					( inst.options.snap.release &&
						inst.options.snap.release.call(
							inst.element,
							event,
							$.extend( inst._uiHash(), { snapItem: inst.snapElements[ i ].item } )
						) );
				}
				inst.snapElements[ i ].snapping = false;
				continue;
			}

			if ( o.snapMode !== "inner" ) {
				ts = Math.abs( t - y2 ) <= d;
				bs = Math.abs( b - y1 ) <= d;
				ls = Math.abs( l - x2 ) <= d;
				rs = Math.abs( r - x1 ) <= d;
				if ( ts ) {
					ui.position.top = inst._convertPositionTo( "relative", {
						top: t - inst.helperProportions.height,
						left: 0
					} ).top;
				}
				if ( bs ) {
					ui.position.top = inst._convertPositionTo( "relative", {
						top: b,
						left: 0
					} ).top;
				}
				if ( ls ) {
					ui.position.left = inst._convertPositionTo( "relative", {
						top: 0,
						left: l - inst.helperProportions.width
					} ).left;
				}
				if ( rs ) {
					ui.position.left = inst._convertPositionTo( "relative", {
						top: 0,
						left: r
					} ).left;
				}
			}

			first = ( ts || bs || ls || rs );

			if ( o.snapMode !== "outer" ) {
				ts = Math.abs( t - y1 ) <= d;
				bs = Math.abs( b - y2 ) <= d;
				ls = Math.abs( l - x1 ) <= d;
				rs = Math.abs( r - x2 ) <= d;
				if ( ts ) {
					ui.position.top = inst._convertPositionTo( "relative", {
						top: t,
						left: 0
					} ).top;
				}
				if ( bs ) {
					ui.position.top = inst._convertPositionTo( "relative", {
						top: b - inst.helperProportions.height,
						left: 0
					} ).top;
				}
				if ( ls ) {
					ui.position.left = inst._convertPositionTo( "relative", {
						top: 0,
						left: l
					} ).left;
				}
				if ( rs ) {
					ui.position.left = inst._convertPositionTo( "relative", {
						top: 0,
						left: r - inst.helperProportions.width
					} ).left;
				}
			}

			if ( !inst.snapElements[ i ].snapping && ( ts || bs || ls || rs || first ) ) {
				( inst.options.snap.snap &&
					inst.options.snap.snap.call(
						inst.element,
						event,
						$.extend( inst._uiHash(), {
							snapItem: inst.snapElements[ i ].item
						} ) ) );
			}
			inst.snapElements[ i ].snapping = ( ts || bs || ls || rs || first );

		}

	}
} );

$.ui.plugin.add( "draggable", "stack", {
	start: function( event, ui, instance ) {
		var min,
			o = instance.options,
			group = $.makeArray( $( o.stack ) ).sort( function( a, b ) {
				return ( parseInt( $( a ).css( "zIndex" ), 10 ) || 0 ) -
					( parseInt( $( b ).css( "zIndex" ), 10 ) || 0 );
			} );

		if ( !group.length ) { return; }

		min = parseInt( $( group[ 0 ] ).css( "zIndex" ), 10 ) || 0;
		$( group ).each( function( i ) {
			$( this ).css( "zIndex", min + i );
		} );
		this.css( "zIndex", ( min + group.length ) );
	}
} );

$.ui.plugin.add( "draggable", "zIndex", {
	start: function( event, ui, instance ) {
		var t = $( ui.helper ),
			o = instance.options;

		if ( t.css( "zIndex" ) ) {
			o._zIndex = t.css( "zIndex" );
		}
		t.css( "zIndex", o.zIndex );
	},
	stop: function( event, ui, instance ) {
		var o = instance.options;

		if ( o._zIndex ) {
			$( ui.helper ).css( "zIndex", o._zIndex );
		}
	}
} );

return $.ui.draggable;

} ) );

},{}],32:[function(require,module,exports){
/*!
 * jQuery UI Menu 1.12.0
 * http://jqueryui.com
 *
 * Copyright jQuery Foundation and other contributors
 * Released under the MIT license.
 * http://jquery.org/license
 */

//>>label: Menu
//>>group: Widgets
//>>description: Creates nestable menus.
//>>docs: http://api.jqueryui.com/menu/
//>>demos: http://jqueryui.com/menu/
//>>css.structure: ../../themes/base/core.css
//>>css.structure: ../../themes/base/menu.css
//>>css.theme: ../../themes/base/theme.css

( function( factory ) {
	if ( typeof define === "function" && define.amd ) {

		// AMD. Register as an anonymous module.
		define( [
			"jquery",
			"../keycode",
			"../position",
			"../safe-active-element",
			"../unique-id",
			"../version",
			"../widget"
		], factory );
	} else {

		// Browser globals
		factory( jQuery );
	}
}( function( $ ) {

return $.widget( "ui.menu", {
	version: "1.12.0",
	defaultElement: "<ul>",
	delay: 300,
	options: {
		icons: {
			submenu: "ui-icon-caret-1-e"
		},
		items: "> *",
		menus: "ul",
		position: {
			my: "left top",
			at: "right top"
		},
		role: "menu",

		// Callbacks
		blur: null,
		focus: null,
		select: null
	},

	_create: function() {
		this.activeMenu = this.element;

		// Flag used to prevent firing of the click handler
		// as the event bubbles up through nested menus
		this.mouseHandled = false;
		this.element
			.uniqueId()
			.attr( {
				role: this.options.role,
				tabIndex: 0
			} );

		this._addClass( "ui-menu", "ui-widget ui-widget-content" );
		this._on( {

			// Prevent focus from sticking to links inside menu after clicking
			// them (focus should always stay on UL during navigation).
			"mousedown .ui-menu-item": function( event ) {
				event.preventDefault();
			},
			"click .ui-menu-item": function( event ) {
				var target = $( event.target );
				var active = $( $.ui.safeActiveElement( this.document[ 0 ] ) );
				if ( !this.mouseHandled && target.not( ".ui-state-disabled" ).length ) {
					this.select( event );

					// Only set the mouseHandled flag if the event will bubble, see #9469.
					if ( !event.isPropagationStopped() ) {
						this.mouseHandled = true;
					}

					// Open submenu on click
					if ( target.has( ".ui-menu" ).length ) {
						this.expand( event );
					} else if ( !this.element.is( ":focus" ) &&
							active.closest( ".ui-menu" ).length ) {

						// Redirect focus to the menu
						this.element.trigger( "focus", [ true ] );

						// If the active item is on the top level, let it stay active.
						// Otherwise, blur the active item since it is no longer visible.
						if ( this.active && this.active.parents( ".ui-menu" ).length === 1 ) {
							clearTimeout( this.timer );
						}
					}
				}
			},
			"mouseenter .ui-menu-item": function( event ) {

				// Ignore mouse events while typeahead is active, see #10458.
				// Prevents focusing the wrong item when typeahead causes a scroll while the mouse
				// is over an item in the menu
				if ( this.previousFilter ) {
					return;
				}

				var actualTarget = $( event.target ).closest( ".ui-menu-item" ),
					target = $( event.currentTarget );

				// Ignore bubbled events on parent items, see #11641
				if ( actualTarget[ 0 ] !== target[ 0 ] ) {
					return;
				}

				// Remove ui-state-active class from siblings of the newly focused menu item
				// to avoid a jump caused by adjacent elements both having a class with a border
				this._removeClass( target.siblings().children( ".ui-state-active" ),
					null, "ui-state-active" );
				this.focus( event, target );
			},
			mouseleave: "collapseAll",
			"mouseleave .ui-menu": "collapseAll",
			focus: function( event, keepActiveItem ) {

				// If there's already an active item, keep it active
				// If not, activate the first item
				var item = this.active || this.element.find( this.options.items ).eq( 0 );

				if ( !keepActiveItem ) {
					this.focus( event, item );
				}
			},
			blur: function( event ) {
				this._delay( function() {
					var notContained = !$.contains(
						this.element[ 0 ],
						$.ui.safeActiveElement( this.document[ 0 ] )
					);
					if ( notContained ) {
						this.collapseAll( event );
					}
				} );
			},
			keydown: "_keydown"
		} );

		this.refresh();

		// Clicks outside of a menu collapse any open menus
		this._on( this.document, {
			click: function( event ) {
				if ( this._closeOnDocumentClick( event ) ) {
					this.collapseAll( event );
				}

				// Reset the mouseHandled flag
				this.mouseHandled = false;
			}
		} );
	},

	_destroy: function() {
		var items = this.element.find( ".ui-menu-item" )
				.removeAttr( "role aria-disabled" ),
			submenus = items.children( ".ui-menu-item-wrapper" )
				.removeUniqueId()
				.removeAttr( "tabIndex role aria-haspopup" );

		// Destroy (sub)menus
		this.element
			.removeAttr( "aria-activedescendant" )
			.find( ".ui-menu" ).addBack()
				.removeAttr( "role aria-labelledby aria-expanded aria-hidden aria-disabled " +
					"tabIndex" )
				.removeUniqueId()
				.show();

		submenus.children().each( function() {
			var elem = $( this );
			if ( elem.data( "ui-menu-submenu-caret" ) ) {
				elem.remove();
			}
		} );
	},

	_keydown: function( event ) {
		var match, prev, character, skip,
			preventDefault = true;

		switch ( event.keyCode ) {
		case $.ui.keyCode.PAGE_UP:
			this.previousPage( event );
			break;
		case $.ui.keyCode.PAGE_DOWN:
			this.nextPage( event );
			break;
		case $.ui.keyCode.HOME:
			this._move( "first", "first", event );
			break;
		case $.ui.keyCode.END:
			this._move( "last", "last", event );
			break;
		case $.ui.keyCode.UP:
			this.previous( event );
			break;
		case $.ui.keyCode.DOWN:
			this.next( event );
			break;
		case $.ui.keyCode.LEFT:
			this.collapse( event );
			break;
		case $.ui.keyCode.RIGHT:
			if ( this.active && !this.active.is( ".ui-state-disabled" ) ) {
				this.expand( event );
			}
			break;
		case $.ui.keyCode.ENTER:
		case $.ui.keyCode.SPACE:
			this._activate( event );
			break;
		case $.ui.keyCode.ESCAPE:
			this.collapse( event );
			break;
		default:
			preventDefault = false;
			prev = this.previousFilter || "";
			character = String.fromCharCode( event.keyCode );
			skip = false;

			clearTimeout( this.filterTimer );

			if ( character === prev ) {
				skip = true;
			} else {
				character = prev + character;
			}

			match = this._filterMenuItems( character );
			match = skip && match.index( this.active.next() ) !== -1 ?
				this.active.nextAll( ".ui-menu-item" ) :
				match;

			// If no matches on the current filter, reset to the last character pressed
			// to move down the menu to the first item that starts with that character
			if ( !match.length ) {
				character = String.fromCharCode( event.keyCode );
				match = this._filterMenuItems( character );
			}

			if ( match.length ) {
				this.focus( event, match );
				this.previousFilter = character;
				this.filterTimer = this._delay( function() {
					delete this.previousFilter;
				}, 1000 );
			} else {
				delete this.previousFilter;
			}
		}

		if ( preventDefault ) {
			event.preventDefault();
		}
	},

	_activate: function( event ) {
		if ( this.active && !this.active.is( ".ui-state-disabled" ) ) {
			if ( this.active.children( "[aria-haspopup='true']" ).length ) {
				this.expand( event );
			} else {
				this.select( event );
			}
		}
	},

	refresh: function() {
		var menus, items, newSubmenus, newItems, newWrappers,
			that = this,
			icon = this.options.icons.submenu,
			submenus = this.element.find( this.options.menus );

		this._toggleClass( "ui-menu-icons", null, !!this.element.find( ".ui-icon" ).length );

		// Initialize nested menus
		newSubmenus = submenus.filter( ":not(.ui-menu)" )
			.hide()
			.attr( {
				role: this.options.role,
				"aria-hidden": "true",
				"aria-expanded": "false"
			} )
			.each( function() {
				var menu = $( this ),
					item = menu.prev(),
					submenuCaret = $( "<span>" ).data( "ui-menu-submenu-caret", true );

				that._addClass( submenuCaret, "ui-menu-icon", "ui-icon " + icon );
				item
					.attr( "aria-haspopup", "true" )
					.prepend( submenuCaret );
				menu.attr( "aria-labelledby", item.attr( "id" ) );
			} );

		this._addClass( newSubmenus, "ui-menu", "ui-widget ui-widget-content ui-front" );

		menus = submenus.add( this.element );
		items = menus.find( this.options.items );

		// Initialize menu-items containing spaces and/or dashes only as dividers
		items.not( ".ui-menu-item" ).each( function() {
			var item = $( this );
			if ( that._isDivider( item ) ) {
				that._addClass( item, "ui-menu-divider", "ui-widget-content" );
			}
		} );

		// Don't refresh list items that are already adapted
		newItems = items.not( ".ui-menu-item, .ui-menu-divider" );
		newWrappers = newItems.children()
			.not( ".ui-menu" )
				.uniqueId()
				.attr( {
					tabIndex: -1,
					role: this._itemRole()
				} );
		this._addClass( newItems, "ui-menu-item" )
			._addClass( newWrappers, "ui-menu-item-wrapper" );

		// Add aria-disabled attribute to any disabled menu item
		items.filter( ".ui-state-disabled" ).attr( "aria-disabled", "true" );

		// If the active item has been removed, blur the menu
		if ( this.active && !$.contains( this.element[ 0 ], this.active[ 0 ] ) ) {
			this.blur();
		}
	},

	_itemRole: function() {
		return {
			menu: "menuitem",
			listbox: "option"
		}[ this.options.role ];
	},

	_setOption: function( key, value ) {
		if ( key === "icons" ) {
			var icons = this.element.find( ".ui-menu-icon" );
			this._removeClass( icons, null, this.options.icons.submenu )
				._addClass( icons, null, value.submenu );
		}
		this._super( key, value );
	},

	_setOptionDisabled: function( value ) {
		this._super( value );

		this.element.attr( "aria-disabled", String( value ) );
		this._toggleClass( null, "ui-state-disabled", !!value );
	},

	focus: function( event, item ) {
		var nested, focused, activeParent;
		this.blur( event, event && event.type === "focus" );

		this._scrollIntoView( item );

		this.active = item.first();

		focused = this.active.children( ".ui-menu-item-wrapper" );
		this._addClass( focused, null, "ui-state-active" );

		// Only update aria-activedescendant if there's a role
		// otherwise we assume focus is managed elsewhere
		if ( this.options.role ) {
			this.element.attr( "aria-activedescendant", focused.attr( "id" ) );
		}

		// Highlight active parent menu item, if any
		activeParent = this.active
			.parent()
				.closest( ".ui-menu-item" )
					.children( ".ui-menu-item-wrapper" );
		this._addClass( activeParent, null, "ui-state-active" );

		if ( event && event.type === "keydown" ) {
			this._close();
		} else {
			this.timer = this._delay( function() {
				this._close();
			}, this.delay );
		}

		nested = item.children( ".ui-menu" );
		if ( nested.length && event && ( /^mouse/.test( event.type ) ) ) {
			this._startOpening( nested );
		}
		this.activeMenu = item.parent();

		this._trigger( "focus", event, { item: item } );
	},

	_scrollIntoView: function( item ) {
		var borderTop, paddingTop, offset, scroll, elementHeight, itemHeight;
		if ( this._hasScroll() ) {
			borderTop = parseFloat( $.css( this.activeMenu[ 0 ], "borderTopWidth" ) ) || 0;
			paddingTop = parseFloat( $.css( this.activeMenu[ 0 ], "paddingTop" ) ) || 0;
			offset = item.offset().top - this.activeMenu.offset().top - borderTop - paddingTop;
			scroll = this.activeMenu.scrollTop();
			elementHeight = this.activeMenu.height();
			itemHeight = item.outerHeight();

			if ( offset < 0 ) {
				this.activeMenu.scrollTop( scroll + offset );
			} else if ( offset + itemHeight > elementHeight ) {
				this.activeMenu.scrollTop( scroll + offset - elementHeight + itemHeight );
			}
		}
	},

	blur: function( event, fromFocus ) {
		if ( !fromFocus ) {
			clearTimeout( this.timer );
		}

		if ( !this.active ) {
			return;
		}

		this._removeClass( this.active.children( ".ui-menu-item-wrapper" ),
			null, "ui-state-active" );

		this._trigger( "blur", event, { item: this.active } );
		this.active = null;
	},

	_startOpening: function( submenu ) {
		clearTimeout( this.timer );

		// Don't open if already open fixes a Firefox bug that caused a .5 pixel
		// shift in the submenu position when mousing over the caret icon
		if ( submenu.attr( "aria-hidden" ) !== "true" ) {
			return;
		}

		this.timer = this._delay( function() {
			this._close();
			this._open( submenu );
		}, this.delay );
	},

	_open: function( submenu ) {
		var position = $.extend( {
			of: this.active
		}, this.options.position );

		clearTimeout( this.timer );
		this.element.find( ".ui-menu" ).not( submenu.parents( ".ui-menu" ) )
			.hide()
			.attr( "aria-hidden", "true" );

		submenu
			.show()
			.removeAttr( "aria-hidden" )
			.attr( "aria-expanded", "true" )
			.position( position );
	},

	collapseAll: function( event, all ) {
		clearTimeout( this.timer );
		this.timer = this._delay( function() {

			// If we were passed an event, look for the submenu that contains the event
			var currentMenu = all ? this.element :
				$( event && event.target ).closest( this.element.find( ".ui-menu" ) );

			// If we found no valid submenu ancestor, use the main menu to close all
			// sub menus anyway
			if ( !currentMenu.length ) {
				currentMenu = this.element;
			}

			this._close( currentMenu );

			this.blur( event );

			// Work around active item staying active after menu is blurred
			this._removeClass( currentMenu.find( ".ui-state-active" ), null, "ui-state-active" );

			this.activeMenu = currentMenu;
		}, this.delay );
	},

	// With no arguments, closes the currently active menu - if nothing is active
	// it closes all menus.  If passed an argument, it will search for menus BELOW
	_close: function( startMenu ) {
		if ( !startMenu ) {
			startMenu = this.active ? this.active.parent() : this.element;
		}

		startMenu.find( ".ui-menu" )
			.hide()
			.attr( "aria-hidden", "true" )
			.attr( "aria-expanded", "false" );
	},

	_closeOnDocumentClick: function( event ) {
		return !$( event.target ).closest( ".ui-menu" ).length;
	},

	_isDivider: function( item ) {

		// Match hyphen, em dash, en dash
		return !/[^\-\u2014\u2013\s]/.test( item.text() );
	},

	collapse: function( event ) {
		var newItem = this.active &&
			this.active.parent().closest( ".ui-menu-item", this.element );
		if ( newItem && newItem.length ) {
			this._close();
			this.focus( event, newItem );
		}
	},

	expand: function( event ) {
		var newItem = this.active &&
			this.active
				.children( ".ui-menu " )
					.find( this.options.items )
						.first();

		if ( newItem && newItem.length ) {
			this._open( newItem.parent() );

			// Delay so Firefox will not hide activedescendant change in expanding submenu from AT
			this._delay( function() {
				this.focus( event, newItem );
			} );
		}
	},

	next: function( event ) {
		this._move( "next", "first", event );
	},

	previous: function( event ) {
		this._move( "prev", "last", event );
	},

	isFirstItem: function() {
		return this.active && !this.active.prevAll( ".ui-menu-item" ).length;
	},

	isLastItem: function() {
		return this.active && !this.active.nextAll( ".ui-menu-item" ).length;
	},

	_move: function( direction, filter, event ) {
		var next;
		if ( this.active ) {
			if ( direction === "first" || direction === "last" ) {
				next = this.active
					[ direction === "first" ? "prevAll" : "nextAll" ]( ".ui-menu-item" )
					.eq( -1 );
			} else {
				next = this.active
					[ direction + "All" ]( ".ui-menu-item" )
					.eq( 0 );
			}
		}
		if ( !next || !next.length || !this.active ) {
			next = this.activeMenu.find( this.options.items )[ filter ]();
		}

		this.focus( event, next );
	},

	nextPage: function( event ) {
		var item, base, height;

		if ( !this.active ) {
			this.next( event );
			return;
		}
		if ( this.isLastItem() ) {
			return;
		}
		if ( this._hasScroll() ) {
			base = this.active.offset().top;
			height = this.element.height();
			this.active.nextAll( ".ui-menu-item" ).each( function() {
				item = $( this );
				return item.offset().top - base - height < 0;
			} );

			this.focus( event, item );
		} else {
			this.focus( event, this.activeMenu.find( this.options.items )
				[ !this.active ? "first" : "last" ]() );
		}
	},

	previousPage: function( event ) {
		var item, base, height;
		if ( !this.active ) {
			this.next( event );
			return;
		}
		if ( this.isFirstItem() ) {
			return;
		}
		if ( this._hasScroll() ) {
			base = this.active.offset().top;
			height = this.element.height();
			this.active.prevAll( ".ui-menu-item" ).each( function() {
				item = $( this );
				return item.offset().top - base + height > 0;
			} );

			this.focus( event, item );
		} else {
			this.focus( event, this.activeMenu.find( this.options.items ).first() );
		}
	},

	_hasScroll: function() {
		return this.element.outerHeight() < this.element.prop( "scrollHeight" );
	},

	select: function( event ) {

		// TODO: It should never be possible to not have an active item at this
		// point, but the tests don't trigger mouseenter before click.
		this.active = this.active || $( event.target ).closest( ".ui-menu-item" );
		var ui = { item: this.active };
		if ( !this.active.has( ".ui-menu" ).length ) {
			this.collapseAll( event, true );
		}
		this._trigger( "select", event, ui );
	},

	_filterMenuItems: function( character ) {
		var escapedCharacter = character.replace( /[\-\[\]{}()*+?.,\\\^$|#\s]/g, "\\$&" ),
			regex = new RegExp( "^" + escapedCharacter, "i" );

		return this.activeMenu
			.find( this.options.items )

				// Only match on items, not dividers or other content (#10571)
				.filter( ".ui-menu-item" )
					.filter( function() {
						return regex.test(
							$.trim( $( this ).children( ".ui-menu-item-wrapper" ).text() ) );
					} );
	}
} );

} ) );

},{}],33:[function(require,module,exports){
/*!
 * jQuery UI Mouse 1.12.0
 * http://jqueryui.com
 *
 * Copyright jQuery Foundation and other contributors
 * Released under the MIT license.
 * http://jquery.org/license
 */

//>>label: Mouse
//>>group: Widgets
//>>description: Abstracts mouse-based interactions to assist in creating certain widgets.
//>>docs: http://api.jqueryui.com/mouse/

( function( factory ) {
	if ( typeof define === "function" && define.amd ) {

		// AMD. Register as an anonymous module.
		define( [
			"jquery",
			"../ie",
			"../version",
			"../widget"
		], factory );
	} else {

		// Browser globals
		factory( jQuery );
	}
}( function( $ ) {

var mouseHandled = false;
$( document ).on( "mouseup", function() {
	mouseHandled = false;
} );

return $.widget( "ui.mouse", {
	version: "1.12.0",
	options: {
		cancel: "input, textarea, button, select, option",
		distance: 1,
		delay: 0
	},
	_mouseInit: function() {
		var that = this;

		this.element
			.on( "mousedown." + this.widgetName, function( event ) {
				return that._mouseDown( event );
			} )
			.on( "click." + this.widgetName, function( event ) {
				if ( true === $.data( event.target, that.widgetName + ".preventClickEvent" ) ) {
					$.removeData( event.target, that.widgetName + ".preventClickEvent" );
					event.stopImmediatePropagation();
					return false;
				}
			} );

		this.started = false;
	},

	// TODO: make sure destroying one instance of mouse doesn't mess with
	// other instances of mouse
	_mouseDestroy: function() {
		this.element.off( "." + this.widgetName );
		if ( this._mouseMoveDelegate ) {
			this.document
				.off( "mousemove." + this.widgetName, this._mouseMoveDelegate )
				.off( "mouseup." + this.widgetName, this._mouseUpDelegate );
		}
	},

	_mouseDown: function( event ) {

		// don't let more than one widget handle mouseStart
		if ( mouseHandled ) {
			return;
		}

		this._mouseMoved = false;

		// We may have missed mouseup (out of window)
		( this._mouseStarted && this._mouseUp( event ) );

		this._mouseDownEvent = event;

		var that = this,
			btnIsLeft = ( event.which === 1 ),

			// event.target.nodeName works around a bug in IE 8 with
			// disabled inputs (#7620)
			elIsCancel = ( typeof this.options.cancel === "string" && event.target.nodeName ?
				$( event.target ).closest( this.options.cancel ).length : false );
		if ( !btnIsLeft || elIsCancel || !this._mouseCapture( event ) ) {
			return true;
		}

		this.mouseDelayMet = !this.options.delay;
		if ( !this.mouseDelayMet ) {
			this._mouseDelayTimer = setTimeout( function() {
				that.mouseDelayMet = true;
			}, this.options.delay );
		}

		if ( this._mouseDistanceMet( event ) && this._mouseDelayMet( event ) ) {
			this._mouseStarted = ( this._mouseStart( event ) !== false );
			if ( !this._mouseStarted ) {
				event.preventDefault();
				return true;
			}
		}

		// Click event may never have fired (Gecko & Opera)
		if ( true === $.data( event.target, this.widgetName + ".preventClickEvent" ) ) {
			$.removeData( event.target, this.widgetName + ".preventClickEvent" );
		}

		// These delegates are required to keep context
		this._mouseMoveDelegate = function( event ) {
			return that._mouseMove( event );
		};
		this._mouseUpDelegate = function( event ) {
			return that._mouseUp( event );
		};

		this.document
			.on( "mousemove." + this.widgetName, this._mouseMoveDelegate )
			.on( "mouseup." + this.widgetName, this._mouseUpDelegate );

		event.preventDefault();

		mouseHandled = true;
		return true;
	},

	_mouseMove: function( event ) {

		// Only check for mouseups outside the document if you've moved inside the document
		// at least once. This prevents the firing of mouseup in the case of IE<9, which will
		// fire a mousemove event if content is placed under the cursor. See #7778
		// Support: IE <9
		if ( this._mouseMoved ) {

			// IE mouseup check - mouseup happened when mouse was out of window
			if ( $.ui.ie && ( !document.documentMode || document.documentMode < 9 ) &&
					!event.button ) {
				return this._mouseUp( event );

			// Iframe mouseup check - mouseup occurred in another document
			} else if ( !event.which ) {

				// Support: Safari <=8 - 9
				// Safari sets which to 0 if you press any of the following keys
				// during a drag (#14461)
				if ( event.originalEvent.altKey || event.originalEvent.ctrlKey ||
						event.originalEvent.metaKey || event.originalEvent.shiftKey ) {
					this.ignoreMissingWhich = true;
				} else if ( !this.ignoreMissingWhich ) {
					return this._mouseUp( event );
				}
			}
		}

		if ( event.which || event.button ) {
			this._mouseMoved = true;
		}

		if ( this._mouseStarted ) {
			this._mouseDrag( event );
			return event.preventDefault();
		}

		if ( this._mouseDistanceMet( event ) && this._mouseDelayMet( event ) ) {
			this._mouseStarted =
				( this._mouseStart( this._mouseDownEvent, event ) !== false );
			( this._mouseStarted ? this._mouseDrag( event ) : this._mouseUp( event ) );
		}

		return !this._mouseStarted;
	},

	_mouseUp: function( event ) {
		this.document
			.off( "mousemove." + this.widgetName, this._mouseMoveDelegate )
			.off( "mouseup." + this.widgetName, this._mouseUpDelegate );

		if ( this._mouseStarted ) {
			this._mouseStarted = false;

			if ( event.target === this._mouseDownEvent.target ) {
				$.data( event.target, this.widgetName + ".preventClickEvent", true );
			}

			this._mouseStop( event );
		}

		if ( this._mouseDelayTimer ) {
			clearTimeout( this._mouseDelayTimer );
			delete this._mouseDelayTimer;
		}

		this.ignoreMissingWhich = false;
		mouseHandled = false;
		event.preventDefault();
	},

	_mouseDistanceMet: function( event ) {
		return ( Math.max(
				Math.abs( this._mouseDownEvent.pageX - event.pageX ),
				Math.abs( this._mouseDownEvent.pageY - event.pageY )
			) >= this.options.distance
		);
	},

	_mouseDelayMet: function( /* event */ ) {
		return this.mouseDelayMet;
	},

	// These are placeholder methods, to be overriden by extending plugin
	_mouseStart: function( /* event */ ) {},
	_mouseDrag: function( /* event */ ) {},
	_mouseStop: function( /* event */ ) {},
	_mouseCapture: function( /* event */ ) { return true; }
} );

} ) );

},{}],34:[function(require,module,exports){
/*!
 * jQuery UI Resizable 1.12.0
 * http://jqueryui.com
 *
 * Copyright jQuery Foundation and other contributors
 * Released under the MIT license.
 * http://jquery.org/license
 */

//>>label: Resizable
//>>group: Interactions
//>>description: Enables resize functionality for any element.
//>>docs: http://api.jqueryui.com/resizable/
//>>demos: http://jqueryui.com/resizable/
//>>css.structure: ../../themes/base/core.css
//>>css.structure: ../../themes/base/resizable.css
//>>css.theme: ../../themes/base/theme.css

( function( factory ) {
	if ( typeof define === "function" && define.amd ) {

		// AMD. Register as an anonymous module.
		define( [
			"jquery",
			"./mouse",
			"../disable-selection",
			"../plugin",
			"../version",
			"../widget"
		], factory );
	} else {

		// Browser globals
		factory( jQuery );
	}
}( function( $ ) {

$.widget( "ui.resizable", $.ui.mouse, {
	version: "1.12.0",
	widgetEventPrefix: "resize",
	options: {
		alsoResize: false,
		animate: false,
		animateDuration: "slow",
		animateEasing: "swing",
		aspectRatio: false,
		autoHide: false,
		classes: {
			"ui-resizable-se": "ui-icon ui-icon-gripsmall-diagonal-se"
		},
		containment: false,
		ghost: false,
		grid: false,
		handles: "e,s,se",
		helper: false,
		maxHeight: null,
		maxWidth: null,
		minHeight: 10,
		minWidth: 10,

		// See #7960
		zIndex: 90,

		// Callbacks
		resize: null,
		start: null,
		stop: null
	},

	_num: function( value ) {
		return parseFloat( value ) || 0;
	},

	_isNumber: function( value ) {
		return !isNaN( parseFloat( value ) );
	},

	_hasScroll: function( el, a ) {

		if ( $( el ).css( "overflow" ) === "hidden" ) {
			return false;
		}

		var scroll = ( a && a === "left" ) ? "scrollLeft" : "scrollTop",
			has = false;

		if ( el[ scroll ] > 0 ) {
			return true;
		}

		// TODO: determine which cases actually cause this to happen
		// if the element doesn't have the scroll set, see if it's possible to
		// set the scroll
		el[ scroll ] = 1;
		has = ( el[ scroll ] > 0 );
		el[ scroll ] = 0;
		return has;
	},

	_create: function() {

		var margins,
			o = this.options,
			that = this;
		this._addClass( "ui-resizable" );

		$.extend( this, {
			_aspectRatio: !!( o.aspectRatio ),
			aspectRatio: o.aspectRatio,
			originalElement: this.element,
			_proportionallyResizeElements: [],
			_helper: o.helper || o.ghost || o.animate ? o.helper || "ui-resizable-helper" : null
		} );

		// Wrap the element if it cannot hold child nodes
		if ( this.element[ 0 ].nodeName.match( /^(canvas|textarea|input|select|button|img)$/i ) ) {

			this.element.wrap(
				$( "<div class='ui-wrapper' style='overflow: hidden;'></div>" ).css( {
					position: this.element.css( "position" ),
					width: this.element.outerWidth(),
					height: this.element.outerHeight(),
					top: this.element.css( "top" ),
					left: this.element.css( "left" )
				} )
			);

			this.element = this.element.parent().data(
				"ui-resizable", this.element.resizable( "instance" )
			);

			this.elementIsWrapper = true;

			margins = {
				marginTop: this.originalElement.css( "marginTop" ),
				marginRight: this.originalElement.css( "marginRight" ),
				marginBottom: this.originalElement.css( "marginBottom" ),
				marginLeft: this.originalElement.css( "marginLeft" )
			};

			this.element.css( margins );
			this.originalElement.css( "margin", 0 );

			// support: Safari
			// Prevent Safari textarea resize
			this.originalResizeStyle = this.originalElement.css( "resize" );
			this.originalElement.css( "resize", "none" );

			this._proportionallyResizeElements.push( this.originalElement.css( {
				position: "static",
				zoom: 1,
				display: "block"
			} ) );

			// Support: IE9
			// avoid IE jump (hard set the margin)
			this.originalElement.css( margins );

			this._proportionallyResize();
		}

		this._setupHandles();

		if ( o.autoHide ) {
			$( this.element )
				.on( "mouseenter", function() {
					if ( o.disabled ) {
						return;
					}
					that._removeClass( "ui-resizable-autohide" );
					that._handles.show();
				} )
				.on( "mouseleave", function() {
					if ( o.disabled ) {
						return;
					}
					if ( !that.resizing ) {
						that._addClass( "ui-resizable-autohide" );
						that._handles.hide();
					}
				} );
		}

		this._mouseInit();
	},

	_destroy: function() {

		this._mouseDestroy();

		var wrapper,
			_destroy = function( exp ) {
				$( exp )
					.removeData( "resizable" )
					.removeData( "ui-resizable" )
					.off( ".resizable" )
					.find( ".ui-resizable-handle" )
						.remove();
			};

		// TODO: Unwrap at same DOM position
		if ( this.elementIsWrapper ) {
			_destroy( this.element );
			wrapper = this.element;
			this.originalElement.css( {
				position: wrapper.css( "position" ),
				width: wrapper.outerWidth(),
				height: wrapper.outerHeight(),
				top: wrapper.css( "top" ),
				left: wrapper.css( "left" )
			} ).insertAfter( wrapper );
			wrapper.remove();
		}

		this.originalElement.css( "resize", this.originalResizeStyle );
		_destroy( this.originalElement );

		return this;
	},

	_setOption: function( key, value ) {
		this._super( key, value );

		switch ( key ) {
		case "handles":
			this._removeHandles();
			this._setupHandles();
			break;
		default:
			break;
		}
	},

	_setupHandles: function() {
		var o = this.options, handle, i, n, hname, axis, that = this;
		this.handles = o.handles ||
			( !$( ".ui-resizable-handle", this.element ).length ?
				"e,s,se" : {
					n: ".ui-resizable-n",
					e: ".ui-resizable-e",
					s: ".ui-resizable-s",
					w: ".ui-resizable-w",
					se: ".ui-resizable-se",
					sw: ".ui-resizable-sw",
					ne: ".ui-resizable-ne",
					nw: ".ui-resizable-nw"
				} );

		this._handles = $();
		if ( this.handles.constructor === String ) {

			if ( this.handles === "all" ) {
				this.handles = "n,e,s,w,se,sw,ne,nw";
			}

			n = this.handles.split( "," );
			this.handles = {};

			for ( i = 0; i < n.length; i++ ) {

				handle = $.trim( n[ i ] );
				hname = "ui-resizable-" + handle;
				axis = $( "<div>" );
				this._addClass( axis, "ui-resizable-handle " + hname );

				axis.css( { zIndex: o.zIndex } );

				this.handles[ handle ] = ".ui-resizable-" + handle;
				this.element.append( axis );
			}

		}

		this._renderAxis = function( target ) {

			var i, axis, padPos, padWrapper;

			target = target || this.element;

			for ( i in this.handles ) {

				if ( this.handles[ i ].constructor === String ) {
					this.handles[ i ] = this.element.children( this.handles[ i ] ).first().show();
				} else if ( this.handles[ i ].jquery || this.handles[ i ].nodeType ) {
					this.handles[ i ] = $( this.handles[ i ] );
					this._on( this.handles[ i ], { "mousedown": that._mouseDown } );
				}

				if ( this.elementIsWrapper &&
						this.originalElement[ 0 ]
							.nodeName
							.match( /^(textarea|input|select|button)$/i ) ) {
					axis = $( this.handles[ i ], this.element );

					padWrapper = /sw|ne|nw|se|n|s/.test( i ) ?
						axis.outerHeight() :
						axis.outerWidth();

					padPos = [ "padding",
						/ne|nw|n/.test( i ) ? "Top" :
						/se|sw|s/.test( i ) ? "Bottom" :
						/^e$/.test( i ) ? "Right" : "Left" ].join( "" );

					target.css( padPos, padWrapper );

					this._proportionallyResize();
				}

				this._handles = this._handles.add( this.handles[ i ] );
			}
		};

		// TODO: make renderAxis a prototype function
		this._renderAxis( this.element );

		this._handles = this._handles.add( this.element.find( ".ui-resizable-handle" ) );
		this._handles.disableSelection();

		this._handles.on( "mouseover", function() {
			if ( !that.resizing ) {
				if ( this.className ) {
					axis = this.className.match( /ui-resizable-(se|sw|ne|nw|n|e|s|w)/i );
				}
				that.axis = axis && axis[ 1 ] ? axis[ 1 ] : "se";
			}
		} );

		if ( o.autoHide ) {
			this._handles.hide();
			this._addClass( "ui-resizable-autohide" );
		}
	},

	_removeHandles: function() {
		this._handles.remove();
	},

	_mouseCapture: function( event ) {
		var i, handle,
			capture = false;

		for ( i in this.handles ) {
			handle = $( this.handles[ i ] )[ 0 ];
			if ( handle === event.target || $.contains( handle, event.target ) ) {
				capture = true;
			}
		}

		return !this.options.disabled && capture;
	},

	_mouseStart: function( event ) {

		var curleft, curtop, cursor,
			o = this.options,
			el = this.element;

		this.resizing = true;

		this._renderProxy();

		curleft = this._num( this.helper.css( "left" ) );
		curtop = this._num( this.helper.css( "top" ) );

		if ( o.containment ) {
			curleft += $( o.containment ).scrollLeft() || 0;
			curtop += $( o.containment ).scrollTop() || 0;
		}

		this.offset = this.helper.offset();
		this.position = { left: curleft, top: curtop };

		this.size = this._helper ? {
				width: this.helper.width(),
				height: this.helper.height()
			} : {
				width: el.width(),
				height: el.height()
			};

		this.originalSize = this._helper ? {
				width: el.outerWidth(),
				height: el.outerHeight()
			} : {
				width: el.width(),
				height: el.height()
			};

		this.sizeDiff = {
			width: el.outerWidth() - el.width(),
			height: el.outerHeight() - el.height()
		};

		this.originalPosition = { left: curleft, top: curtop };
		this.originalMousePosition = { left: event.pageX, top: event.pageY };

		this.aspectRatio = ( typeof o.aspectRatio === "number" ) ?
			o.aspectRatio :
			( ( this.originalSize.width / this.originalSize.height ) || 1 );

		cursor = $( ".ui-resizable-" + this.axis ).css( "cursor" );
		$( "body" ).css( "cursor", cursor === "auto" ? this.axis + "-resize" : cursor );

		this._addClass( "ui-resizable-resizing" );
		this._propagate( "start", event );
		return true;
	},

	_mouseDrag: function( event ) {

		var data, props,
			smp = this.originalMousePosition,
			a = this.axis,
			dx = ( event.pageX - smp.left ) || 0,
			dy = ( event.pageY - smp.top ) || 0,
			trigger = this._change[ a ];

		this._updatePrevProperties();

		if ( !trigger ) {
			return false;
		}

		data = trigger.apply( this, [ event, dx, dy ] );

		this._updateVirtualBoundaries( event.shiftKey );
		if ( this._aspectRatio || event.shiftKey ) {
			data = this._updateRatio( data, event );
		}

		data = this._respectSize( data, event );

		this._updateCache( data );

		this._propagate( "resize", event );

		props = this._applyChanges();

		if ( !this._helper && this._proportionallyResizeElements.length ) {
			this._proportionallyResize();
		}

		if ( !$.isEmptyObject( props ) ) {
			this._updatePrevProperties();
			this._trigger( "resize", event, this.ui() );
			this._applyChanges();
		}

		return false;
	},

	_mouseStop: function( event ) {

		this.resizing = false;
		var pr, ista, soffseth, soffsetw, s, left, top,
			o = this.options, that = this;

		if ( this._helper ) {

			pr = this._proportionallyResizeElements;
			ista = pr.length && ( /textarea/i ).test( pr[ 0 ].nodeName );
			soffseth = ista && this._hasScroll( pr[ 0 ], "left" ) ? 0 : that.sizeDiff.height;
			soffsetw = ista ? 0 : that.sizeDiff.width;

			s = {
				width: ( that.helper.width()  - soffsetw ),
				height: ( that.helper.height() - soffseth )
			};
			left = ( parseFloat( that.element.css( "left" ) ) +
				( that.position.left - that.originalPosition.left ) ) || null;
			top = ( parseFloat( that.element.css( "top" ) ) +
				( that.position.top - that.originalPosition.top ) ) || null;

			if ( !o.animate ) {
				this.element.css( $.extend( s, { top: top, left: left } ) );
			}

			that.helper.height( that.size.height );
			that.helper.width( that.size.width );

			if ( this._helper && !o.animate ) {
				this._proportionallyResize();
			}
		}

		$( "body" ).css( "cursor", "auto" );

		this._removeClass( "ui-resizable-resizing" );

		this._propagate( "stop", event );

		if ( this._helper ) {
			this.helper.remove();
		}

		return false;

	},

	_updatePrevProperties: function() {
		this.prevPosition = {
			top: this.position.top,
			left: this.position.left
		};
		this.prevSize = {
			width: this.size.width,
			height: this.size.height
		};
	},

	_applyChanges: function() {
		var props = {};

		if ( this.position.top !== this.prevPosition.top ) {
			props.top = this.position.top + "px";
		}
		if ( this.position.left !== this.prevPosition.left ) {
			props.left = this.position.left + "px";
		}
		if ( this.size.width !== this.prevSize.width ) {
			props.width = this.size.width + "px";
		}
		if ( this.size.height !== this.prevSize.height ) {
			props.height = this.size.height + "px";
		}

		this.helper.css( props );

		return props;
	},

	_updateVirtualBoundaries: function( forceAspectRatio ) {
		var pMinWidth, pMaxWidth, pMinHeight, pMaxHeight, b,
			o = this.options;

		b = {
			minWidth: this._isNumber( o.minWidth ) ? o.minWidth : 0,
			maxWidth: this._isNumber( o.maxWidth ) ? o.maxWidth : Infinity,
			minHeight: this._isNumber( o.minHeight ) ? o.minHeight : 0,
			maxHeight: this._isNumber( o.maxHeight ) ? o.maxHeight : Infinity
		};

		if ( this._aspectRatio || forceAspectRatio ) {
			pMinWidth = b.minHeight * this.aspectRatio;
			pMinHeight = b.minWidth / this.aspectRatio;
			pMaxWidth = b.maxHeight * this.aspectRatio;
			pMaxHeight = b.maxWidth / this.aspectRatio;

			if ( pMinWidth > b.minWidth ) {
				b.minWidth = pMinWidth;
			}
			if ( pMinHeight > b.minHeight ) {
				b.minHeight = pMinHeight;
			}
			if ( pMaxWidth < b.maxWidth ) {
				b.maxWidth = pMaxWidth;
			}
			if ( pMaxHeight < b.maxHeight ) {
				b.maxHeight = pMaxHeight;
			}
		}
		this._vBoundaries = b;
	},

	_updateCache: function( data ) {
		this.offset = this.helper.offset();
		if ( this._isNumber( data.left ) ) {
			this.position.left = data.left;
		}
		if ( this._isNumber( data.top ) ) {
			this.position.top = data.top;
		}
		if ( this._isNumber( data.height ) ) {
			this.size.height = data.height;
		}
		if ( this._isNumber( data.width ) ) {
			this.size.width = data.width;
		}
	},

	_updateRatio: function( data ) {

		var cpos = this.position,
			csize = this.size,
			a = this.axis;

		if ( this._isNumber( data.height ) ) {
			data.width = ( data.height * this.aspectRatio );
		} else if ( this._isNumber( data.width ) ) {
			data.height = ( data.width / this.aspectRatio );
		}

		if ( a === "sw" ) {
			data.left = cpos.left + ( csize.width - data.width );
			data.top = null;
		}
		if ( a === "nw" ) {
			data.top = cpos.top + ( csize.height - data.height );
			data.left = cpos.left + ( csize.width - data.width );
		}

		return data;
	},

	_respectSize: function( data ) {

		var o = this._vBoundaries,
			a = this.axis,
			ismaxw = this._isNumber( data.width ) && o.maxWidth && ( o.maxWidth < data.width ),
			ismaxh = this._isNumber( data.height ) && o.maxHeight && ( o.maxHeight < data.height ),
			isminw = this._isNumber( data.width ) && o.minWidth && ( o.minWidth > data.width ),
			isminh = this._isNumber( data.height ) && o.minHeight && ( o.minHeight > data.height ),
			dw = this.originalPosition.left + this.originalSize.width,
			dh = this.originalPosition.top + this.originalSize.height,
			cw = /sw|nw|w/.test( a ), ch = /nw|ne|n/.test( a );
		if ( isminw ) {
			data.width = o.minWidth;
		}
		if ( isminh ) {
			data.height = o.minHeight;
		}
		if ( ismaxw ) {
			data.width = o.maxWidth;
		}
		if ( ismaxh ) {
			data.height = o.maxHeight;
		}

		if ( isminw && cw ) {
			data.left = dw - o.minWidth;
		}
		if ( ismaxw && cw ) {
			data.left = dw - o.maxWidth;
		}
		if ( isminh && ch ) {
			data.top = dh - o.minHeight;
		}
		if ( ismaxh && ch ) {
			data.top = dh - o.maxHeight;
		}

		// Fixing jump error on top/left - bug #2330
		if ( !data.width && !data.height && !data.left && data.top ) {
			data.top = null;
		} else if ( !data.width && !data.height && !data.top && data.left ) {
			data.left = null;
		}

		return data;
	},

	_getPaddingPlusBorderDimensions: function( element ) {
		var i = 0,
			widths = [],
			borders = [
				element.css( "borderTopWidth" ),
				element.css( "borderRightWidth" ),
				element.css( "borderBottomWidth" ),
				element.css( "borderLeftWidth" )
			],
			paddings = [
				element.css( "paddingTop" ),
				element.css( "paddingRight" ),
				element.css( "paddingBottom" ),
				element.css( "paddingLeft" )
			];

		for ( ; i < 4; i++ ) {
			widths[ i ] = ( parseFloat( borders[ i ] ) || 0 );
			widths[ i ] += ( parseFloat( paddings[ i ] ) || 0 );
		}

		return {
			height: widths[ 0 ] + widths[ 2 ],
			width: widths[ 1 ] + widths[ 3 ]
		};
	},

	_proportionallyResize: function() {

		if ( !this._proportionallyResizeElements.length ) {
			return;
		}

		var prel,
			i = 0,
			element = this.helper || this.element;

		for ( ; i < this._proportionallyResizeElements.length; i++ ) {

			prel = this._proportionallyResizeElements[ i ];

			// TODO: Seems like a bug to cache this.outerDimensions
			// considering that we are in a loop.
			if ( !this.outerDimensions ) {
				this.outerDimensions = this._getPaddingPlusBorderDimensions( prel );
			}

			prel.css( {
				height: ( element.height() - this.outerDimensions.height ) || 0,
				width: ( element.width() - this.outerDimensions.width ) || 0
			} );

		}

	},

	_renderProxy: function() {

		var el = this.element, o = this.options;
		this.elementOffset = el.offset();

		if ( this._helper ) {

			this.helper = this.helper || $( "<div style='overflow:hidden;'></div>" );

			this._addClass( this.helper, this._helper );
			this.helper.css( {
				width: this.element.outerWidth(),
				height: this.element.outerHeight(),
				position: "absolute",
				left: this.elementOffset.left + "px",
				top: this.elementOffset.top + "px",
				zIndex: ++o.zIndex //TODO: Don't modify option
			} );

			this.helper
				.appendTo( "body" )
				.disableSelection();

		} else {
			this.helper = this.element;
		}

	},

	_change: {
		e: function( event, dx ) {
			return { width: this.originalSize.width + dx };
		},
		w: function( event, dx ) {
			var cs = this.originalSize, sp = this.originalPosition;
			return { left: sp.left + dx, width: cs.width - dx };
		},
		n: function( event, dx, dy ) {
			var cs = this.originalSize, sp = this.originalPosition;
			return { top: sp.top + dy, height: cs.height - dy };
		},
		s: function( event, dx, dy ) {
			return { height: this.originalSize.height + dy };
		},
		se: function( event, dx, dy ) {
			return $.extend( this._change.s.apply( this, arguments ),
				this._change.e.apply( this, [ event, dx, dy ] ) );
		},
		sw: function( event, dx, dy ) {
			return $.extend( this._change.s.apply( this, arguments ),
				this._change.w.apply( this, [ event, dx, dy ] ) );
		},
		ne: function( event, dx, dy ) {
			return $.extend( this._change.n.apply( this, arguments ),
				this._change.e.apply( this, [ event, dx, dy ] ) );
		},
		nw: function( event, dx, dy ) {
			return $.extend( this._change.n.apply( this, arguments ),
				this._change.w.apply( this, [ event, dx, dy ] ) );
		}
	},

	_propagate: function( n, event ) {
		$.ui.plugin.call( this, n, [ event, this.ui() ] );
		( n !== "resize" && this._trigger( n, event, this.ui() ) );
	},

	plugins: {},

	ui: function() {
		return {
			originalElement: this.originalElement,
			element: this.element,
			helper: this.helper,
			position: this.position,
			size: this.size,
			originalSize: this.originalSize,
			originalPosition: this.originalPosition
		};
	}

} );

/*
 * Resizable Extensions
 */

$.ui.plugin.add( "resizable", "animate", {

	stop: function( event ) {
		var that = $( this ).resizable( "instance" ),
			o = that.options,
			pr = that._proportionallyResizeElements,
			ista = pr.length && ( /textarea/i ).test( pr[ 0 ].nodeName ),
			soffseth = ista && that._hasScroll( pr[ 0 ], "left" ) ? 0 : that.sizeDiff.height,
			soffsetw = ista ? 0 : that.sizeDiff.width,
			style = {
				width: ( that.size.width - soffsetw ),
				height: ( that.size.height - soffseth )
			},
			left = ( parseFloat( that.element.css( "left" ) ) +
				( that.position.left - that.originalPosition.left ) ) || null,
			top = ( parseFloat( that.element.css( "top" ) ) +
				( that.position.top - that.originalPosition.top ) ) || null;

		that.element.animate(
			$.extend( style, top && left ? { top: top, left: left } : {} ), {
				duration: o.animateDuration,
				easing: o.animateEasing,
				step: function() {

					var data = {
						width: parseFloat( that.element.css( "width" ) ),
						height: parseFloat( that.element.css( "height" ) ),
						top: parseFloat( that.element.css( "top" ) ),
						left: parseFloat( that.element.css( "left" ) )
					};

					if ( pr && pr.length ) {
						$( pr[ 0 ] ).css( { width: data.width, height: data.height } );
					}

					// Propagating resize, and updating values for each animation step
					that._updateCache( data );
					that._propagate( "resize", event );

				}
			}
		);
	}

} );

$.ui.plugin.add( "resizable", "containment", {

	start: function() {
		var element, p, co, ch, cw, width, height,
			that = $( this ).resizable( "instance" ),
			o = that.options,
			el = that.element,
			oc = o.containment,
			ce = ( oc instanceof $ ) ?
				oc.get( 0 ) :
				( /parent/.test( oc ) ) ? el.parent().get( 0 ) : oc;

		if ( !ce ) {
			return;
		}

		that.containerElement = $( ce );

		if ( /document/.test( oc ) || oc === document ) {
			that.containerOffset = {
				left: 0,
				top: 0
			};
			that.containerPosition = {
				left: 0,
				top: 0
			};

			that.parentData = {
				element: $( document ),
				left: 0,
				top: 0,
				width: $( document ).width(),
				height: $( document ).height() || document.body.parentNode.scrollHeight
			};
		} else {
			element = $( ce );
			p = [];
			$( [ "Top", "Right", "Left", "Bottom" ] ).each( function( i, name ) {
				p[ i ] = that._num( element.css( "padding" + name ) );
			} );

			that.containerOffset = element.offset();
			that.containerPosition = element.position();
			that.containerSize = {
				height: ( element.innerHeight() - p[ 3 ] ),
				width: ( element.innerWidth() - p[ 1 ] )
			};

			co = that.containerOffset;
			ch = that.containerSize.height;
			cw = that.containerSize.width;
			width = ( that._hasScroll ( ce, "left" ) ? ce.scrollWidth : cw );
			height = ( that._hasScroll ( ce ) ? ce.scrollHeight : ch ) ;

			that.parentData = {
				element: ce,
				left: co.left,
				top: co.top,
				width: width,
				height: height
			};
		}
	},

	resize: function( event ) {
		var woset, hoset, isParent, isOffsetRelative,
			that = $( this ).resizable( "instance" ),
			o = that.options,
			co = that.containerOffset,
			cp = that.position,
			pRatio = that._aspectRatio || event.shiftKey,
			cop = {
				top: 0,
				left: 0
			},
			ce = that.containerElement,
			continueResize = true;

		if ( ce[ 0 ] !== document && ( /static/ ).test( ce.css( "position" ) ) ) {
			cop = co;
		}

		if ( cp.left < ( that._helper ? co.left : 0 ) ) {
			that.size.width = that.size.width +
				( that._helper ?
					( that.position.left - co.left ) :
					( that.position.left - cop.left ) );

			if ( pRatio ) {
				that.size.height = that.size.width / that.aspectRatio;
				continueResize = false;
			}
			that.position.left = o.helper ? co.left : 0;
		}

		if ( cp.top < ( that._helper ? co.top : 0 ) ) {
			that.size.height = that.size.height +
				( that._helper ?
					( that.position.top - co.top ) :
					that.position.top );

			if ( pRatio ) {
				that.size.width = that.size.height * that.aspectRatio;
				continueResize = false;
			}
			that.position.top = that._helper ? co.top : 0;
		}

		isParent = that.containerElement.get( 0 ) === that.element.parent().get( 0 );
		isOffsetRelative = /relative|absolute/.test( that.containerElement.css( "position" ) );

		if ( isParent && isOffsetRelative ) {
			that.offset.left = that.parentData.left + that.position.left;
			that.offset.top = that.parentData.top + that.position.top;
		} else {
			that.offset.left = that.element.offset().left;
			that.offset.top = that.element.offset().top;
		}

		woset = Math.abs( that.sizeDiff.width +
			( that._helper ?
				that.offset.left - cop.left :
				( that.offset.left - co.left ) ) );

		hoset = Math.abs( that.sizeDiff.height +
			( that._helper ?
				that.offset.top - cop.top :
				( that.offset.top - co.top ) ) );

		if ( woset + that.size.width >= that.parentData.width ) {
			that.size.width = that.parentData.width - woset;
			if ( pRatio ) {
				that.size.height = that.size.width / that.aspectRatio;
				continueResize = false;
			}
		}

		if ( hoset + that.size.height >= that.parentData.height ) {
			that.size.height = that.parentData.height - hoset;
			if ( pRatio ) {
				that.size.width = that.size.height * that.aspectRatio;
				continueResize = false;
			}
		}

		if ( !continueResize ) {
			that.position.left = that.prevPosition.left;
			that.position.top = that.prevPosition.top;
			that.size.width = that.prevSize.width;
			that.size.height = that.prevSize.height;
		}
	},

	stop: function() {
		var that = $( this ).resizable( "instance" ),
			o = that.options,
			co = that.containerOffset,
			cop = that.containerPosition,
			ce = that.containerElement,
			helper = $( that.helper ),
			ho = helper.offset(),
			w = helper.outerWidth() - that.sizeDiff.width,
			h = helper.outerHeight() - that.sizeDiff.height;

		if ( that._helper && !o.animate && ( /relative/ ).test( ce.css( "position" ) ) ) {
			$( this ).css( {
				left: ho.left - cop.left - co.left,
				width: w,
				height: h
			} );
		}

		if ( that._helper && !o.animate && ( /static/ ).test( ce.css( "position" ) ) ) {
			$( this ).css( {
				left: ho.left - cop.left - co.left,
				width: w,
				height: h
			} );
		}
	}
} );

$.ui.plugin.add( "resizable", "alsoResize", {

	start: function() {
		var that = $( this ).resizable( "instance" ),
			o = that.options;

		$( o.alsoResize ).each( function() {
			var el = $( this );
			el.data( "ui-resizable-alsoresize", {
				width: parseFloat( el.width() ), height: parseFloat( el.height() ),
				left: parseFloat( el.css( "left" ) ), top: parseFloat( el.css( "top" ) )
			} );
		} );
	},

	resize: function( event, ui ) {
		var that = $( this ).resizable( "instance" ),
			o = that.options,
			os = that.originalSize,
			op = that.originalPosition,
			delta = {
				height: ( that.size.height - os.height ) || 0,
				width: ( that.size.width - os.width ) || 0,
				top: ( that.position.top - op.top ) || 0,
				left: ( that.position.left - op.left ) || 0
			};

			$( o.alsoResize ).each( function() {
				var el = $( this ), start = $( this ).data( "ui-resizable-alsoresize" ), style = {},
					css = el.parents( ui.originalElement[ 0 ] ).length ?
							[ "width", "height" ] :
							[ "width", "height", "top", "left" ];

				$.each( css, function( i, prop ) {
					var sum = ( start[ prop ] || 0 ) + ( delta[ prop ] || 0 );
					if ( sum && sum >= 0 ) {
						style[ prop ] = sum || null;
					}
				} );

				el.css( style );
			} );
	},

	stop: function() {
		$( this ).removeData( "ui-resizable-alsoresize" );
	}
} );

$.ui.plugin.add( "resizable", "ghost", {

	start: function() {

		var that = $( this ).resizable( "instance" ), cs = that.size;

		that.ghost = that.originalElement.clone();
		that.ghost.css( {
			opacity: 0.25,
			display: "block",
			position: "relative",
			height: cs.height,
			width: cs.width,
			margin: 0,
			left: 0,
			top: 0
		} );

		that._addClass( that.ghost, "ui-resizable-ghost" );

		// DEPRECATED
		// TODO: remove after 1.12
		if ( $.uiBackCompat !== false && typeof that.options.ghost === "string" ) {

			// Ghost option
			that.ghost.addClass( this.options.ghost );
		}

		that.ghost.appendTo( that.helper );

	},

	resize: function() {
		var that = $( this ).resizable( "instance" );
		if ( that.ghost ) {
			that.ghost.css( {
				position: "relative",
				height: that.size.height,
				width: that.size.width
			} );
		}
	},

	stop: function() {
		var that = $( this ).resizable( "instance" );
		if ( that.ghost && that.helper ) {
			that.helper.get( 0 ).removeChild( that.ghost.get( 0 ) );
		}
	}

} );

$.ui.plugin.add( "resizable", "grid", {

	resize: function() {
		var outerDimensions,
			that = $( this ).resizable( "instance" ),
			o = that.options,
			cs = that.size,
			os = that.originalSize,
			op = that.originalPosition,
			a = that.axis,
			grid = typeof o.grid === "number" ? [ o.grid, o.grid ] : o.grid,
			gridX = ( grid[ 0 ] || 1 ),
			gridY = ( grid[ 1 ] || 1 ),
			ox = Math.round( ( cs.width - os.width ) / gridX ) * gridX,
			oy = Math.round( ( cs.height - os.height ) / gridY ) * gridY,
			newWidth = os.width + ox,
			newHeight = os.height + oy,
			isMaxWidth = o.maxWidth && ( o.maxWidth < newWidth ),
			isMaxHeight = o.maxHeight && ( o.maxHeight < newHeight ),
			isMinWidth = o.minWidth && ( o.minWidth > newWidth ),
			isMinHeight = o.minHeight && ( o.minHeight > newHeight );

		o.grid = grid;

		if ( isMinWidth ) {
			newWidth += gridX;
		}
		if ( isMinHeight ) {
			newHeight += gridY;
		}
		if ( isMaxWidth ) {
			newWidth -= gridX;
		}
		if ( isMaxHeight ) {
			newHeight -= gridY;
		}

		if ( /^(se|s|e)$/.test( a ) ) {
			that.size.width = newWidth;
			that.size.height = newHeight;
		} else if ( /^(ne)$/.test( a ) ) {
			that.size.width = newWidth;
			that.size.height = newHeight;
			that.position.top = op.top - oy;
		} else if ( /^(sw)$/.test( a ) ) {
			that.size.width = newWidth;
			that.size.height = newHeight;
			that.position.left = op.left - ox;
		} else {
			if ( newHeight - gridY <= 0 || newWidth - gridX <= 0 ) {
				outerDimensions = that._getPaddingPlusBorderDimensions( this );
			}

			if ( newHeight - gridY > 0 ) {
				that.size.height = newHeight;
				that.position.top = op.top - oy;
			} else {
				newHeight = gridY - outerDimensions.height;
				that.size.height = newHeight;
				that.position.top = op.top + os.height - newHeight;
			}
			if ( newWidth - gridX > 0 ) {
				that.size.width = newWidth;
				that.position.left = op.left - ox;
			} else {
				newWidth = gridX - outerDimensions.width;
				that.size.width = newWidth;
				that.position.left = op.left + os.width - newWidth;
			}
		}
	}

} );

return $.ui.resizable;

} ) );

},{}],35:[function(require,module,exports){
/*!
 * jQuery UI Spinner 1.12.0
 * http://jqueryui.com
 *
 * Copyright jQuery Foundation and other contributors
 * Released under the MIT license.
 * http://jquery.org/license
 */

//>>label: Spinner
//>>group: Widgets
//>>description: Displays buttons to easily input numbers via the keyboard or mouse.
//>>docs: http://api.jqueryui.com/spinner/
//>>demos: http://jqueryui.com/spinner/
//>>css.structure: ../../themes/base/core.css
//>>css.structure: ../../themes/base/spinner.css
//>>css.theme: ../../themes/base/theme.css

( function( factory ) {
	if ( typeof define === "function" && define.amd ) {

		// AMD. Register as an anonymous module.
		define( [
			"jquery",
			"./button",
			"../version",
			"../keycode",
			"../safe-active-element",
			"../widget"
		], factory );
	} else {

		// Browser globals
		factory( jQuery );
	}
}( function( $ ) {

function spinnerModifer( fn ) {
	return function() {
		var previous = this.element.val();
		fn.apply( this, arguments );
		this._refresh();
		if ( previous !== this.element.val() ) {
			this._trigger( "change" );
		}
	};
}

$.widget( "ui.spinner", {
	version: "1.12.0",
	defaultElement: "<input>",
	widgetEventPrefix: "spin",
	options: {
		classes: {
			"ui-spinner": "ui-corner-all",
			"ui-spinner-down": "ui-corner-br",
			"ui-spinner-up": "ui-corner-tr"
		},
		culture: null,
		icons: {
			down: "ui-icon-triangle-1-s",
			up: "ui-icon-triangle-1-n"
		},
		incremental: true,
		max: null,
		min: null,
		numberFormat: null,
		page: 10,
		step: 1,

		change: null,
		spin: null,
		start: null,
		stop: null
	},

	_create: function() {

		// handle string values that need to be parsed
		this._setOption( "max", this.options.max );
		this._setOption( "min", this.options.min );
		this._setOption( "step", this.options.step );

		// Only format if there is a value, prevents the field from being marked
		// as invalid in Firefox, see #9573.
		if ( this.value() !== "" ) {

			// Format the value, but don't constrain.
			this._value( this.element.val(), true );
		}

		this._draw();
		this._on( this._events );
		this._refresh();

		// Turning off autocomplete prevents the browser from remembering the
		// value when navigating through history, so we re-enable autocomplete
		// if the page is unloaded before the widget is destroyed. #7790
		this._on( this.window, {
			beforeunload: function() {
				this.element.removeAttr( "autocomplete" );
			}
		} );
	},

	_getCreateOptions: function() {
		var options = this._super();
		var element = this.element;

		$.each( [ "min", "max", "step" ], function( i, option ) {
			var value = element.attr( option );
			if ( value != null && value.length ) {
				options[ option ] = value;
			}
		} );

		return options;
	},

	_events: {
		keydown: function( event ) {
			if ( this._start( event ) && this._keydown( event ) ) {
				event.preventDefault();
			}
		},
		keyup: "_stop",
		focus: function() {
			this.previous = this.element.val();
		},
		blur: function( event ) {
			if ( this.cancelBlur ) {
				delete this.cancelBlur;
				return;
			}

			this._stop();
			this._refresh();
			if ( this.previous !== this.element.val() ) {
				this._trigger( "change", event );
			}
		},
		mousewheel: function( event, delta ) {
			if ( !delta ) {
				return;
			}
			if ( !this.spinning && !this._start( event ) ) {
				return false;
			}

			this._spin( ( delta > 0 ? 1 : -1 ) * this.options.step, event );
			clearTimeout( this.mousewheelTimer );
			this.mousewheelTimer = this._delay( function() {
				if ( this.spinning ) {
					this._stop( event );
				}
			}, 100 );
			event.preventDefault();
		},
		"mousedown .ui-spinner-button": function( event ) {
			var previous;

			// We never want the buttons to have focus; whenever the user is
			// interacting with the spinner, the focus should be on the input.
			// If the input is focused then this.previous is properly set from
			// when the input first received focus. If the input is not focused
			// then we need to set this.previous based on the value before spinning.
			previous = this.element[ 0 ] === $.ui.safeActiveElement( this.document[ 0 ] ) ?
				this.previous : this.element.val();
			function checkFocus() {
				var isActive = this.element[ 0 ] === $.ui.safeActiveElement( this.document[ 0 ] );
				if ( !isActive ) {
					this.element.trigger( "focus" );
					this.previous = previous;

					// support: IE
					// IE sets focus asynchronously, so we need to check if focus
					// moved off of the input because the user clicked on the button.
					this._delay( function() {
						this.previous = previous;
					} );
				}
			}

			// Ensure focus is on (or stays on) the text field
			event.preventDefault();
			checkFocus.call( this );

			// Support: IE
			// IE doesn't prevent moving focus even with event.preventDefault()
			// so we set a flag to know when we should ignore the blur event
			// and check (again) if focus moved off of the input.
			this.cancelBlur = true;
			this._delay( function() {
				delete this.cancelBlur;
				checkFocus.call( this );
			} );

			if ( this._start( event ) === false ) {
				return;
			}

			this._repeat( null, $( event.currentTarget )
				.hasClass( "ui-spinner-up" ) ? 1 : -1, event );
		},
		"mouseup .ui-spinner-button": "_stop",
		"mouseenter .ui-spinner-button": function( event ) {

			// button will add ui-state-active if mouse was down while mouseleave and kept down
			if ( !$( event.currentTarget ).hasClass( "ui-state-active" ) ) {
				return;
			}

			if ( this._start( event ) === false ) {
				return false;
			}
			this._repeat( null, $( event.currentTarget )
				.hasClass( "ui-spinner-up" ) ? 1 : -1, event );
		},

		// TODO: do we really want to consider this a stop?
		// shouldn't we just stop the repeater and wait until mouseup before
		// we trigger the stop event?
		"mouseleave .ui-spinner-button": "_stop"
	},

	// Support mobile enhanced option and make backcompat more sane
	_enhance: function() {
		this.uiSpinner = this.element
			.attr( "autocomplete", "off" )
			.wrap( "<span>" )
			.parent()

				// Add buttons
				.append(
					"<a></a><a></a>"
				);
	},

	_draw: function() {
		this._enhance();

		this._addClass( this.uiSpinner, "ui-spinner", "ui-widget ui-widget-content" );
		this._addClass( "ui-spinner-input" );

		this.element.attr( "role", "spinbutton" );

		// Button bindings
		this.buttons = this.uiSpinner.children( "a" )
			.attr( "tabIndex", -1 )
			.attr( "aria-hidden", true )
			.button( {
				classes: {
					"ui-button": ""
				}
			} );

		// TODO: Right now button does not support classes this is already updated in button PR
		this._removeClass( this.buttons, "ui-corner-all" );

		this._addClass( this.buttons.first(), "ui-spinner-button ui-spinner-up" );
		this._addClass( this.buttons.last(), "ui-spinner-button ui-spinner-down" );
		this.buttons.first().button( {
			"icon": this.options.icons.up,
			"showLabel": false
		} );
		this.buttons.last().button( {
			"icon": this.options.icons.down,
			"showLabel": false
		} );

		// IE 6 doesn't understand height: 50% for the buttons
		// unless the wrapper has an explicit height
		if ( this.buttons.height() > Math.ceil( this.uiSpinner.height() * 0.5 ) &&
				this.uiSpinner.height() > 0 ) {
			this.uiSpinner.height( this.uiSpinner.height() );
		}
	},

	_keydown: function( event ) {
		var options = this.options,
			keyCode = $.ui.keyCode;

		switch ( event.keyCode ) {
		case keyCode.UP:
			this._repeat( null, 1, event );
			return true;
		case keyCode.DOWN:
			this._repeat( null, -1, event );
			return true;
		case keyCode.PAGE_UP:
			this._repeat( null, options.page, event );
			return true;
		case keyCode.PAGE_DOWN:
			this._repeat( null, -options.page, event );
			return true;
		}

		return false;
	},

	_start: function( event ) {
		if ( !this.spinning && this._trigger( "start", event ) === false ) {
			return false;
		}

		if ( !this.counter ) {
			this.counter = 1;
		}
		this.spinning = true;
		return true;
	},

	_repeat: function( i, steps, event ) {
		i = i || 500;

		clearTimeout( this.timer );
		this.timer = this._delay( function() {
			this._repeat( 40, steps, event );
		}, i );

		this._spin( steps * this.options.step, event );
	},

	_spin: function( step, event ) {
		var value = this.value() || 0;

		if ( !this.counter ) {
			this.counter = 1;
		}

		value = this._adjustValue( value + step * this._increment( this.counter ) );

		if ( !this.spinning || this._trigger( "spin", event, { value: value } ) !== false ) {
			this._value( value );
			this.counter++;
		}
	},

	_increment: function( i ) {
		var incremental = this.options.incremental;

		if ( incremental ) {
			return $.isFunction( incremental ) ?
				incremental( i ) :
				Math.floor( i * i * i / 50000 - i * i / 500 + 17 * i / 200 + 1 );
		}

		return 1;
	},

	_precision: function() {
		var precision = this._precisionOf( this.options.step );
		if ( this.options.min !== null ) {
			precision = Math.max( precision, this._precisionOf( this.options.min ) );
		}
		return precision;
	},

	_precisionOf: function( num ) {
		var str = num.toString(),
			decimal = str.indexOf( "." );
		return decimal === -1 ? 0 : str.length - decimal - 1;
	},

	_adjustValue: function( value ) {
		var base, aboveMin,
			options = this.options;

		// Make sure we're at a valid step
		// - find out where we are relative to the base (min or 0)
		base = options.min !== null ? options.min : 0;
		aboveMin = value - base;

		// - round to the nearest step
		aboveMin = Math.round( aboveMin / options.step ) * options.step;

		// - rounding is based on 0, so adjust back to our base
		value = base + aboveMin;

		// Fix precision from bad JS floating point math
		value = parseFloat( value.toFixed( this._precision() ) );

		// Clamp the value
		if ( options.max !== null && value > options.max ) {
			return options.max;
		}
		if ( options.min !== null && value < options.min ) {
			return options.min;
		}

		return value;
	},

	_stop: function( event ) {
		if ( !this.spinning ) {
			return;
		}

		clearTimeout( this.timer );
		clearTimeout( this.mousewheelTimer );
		this.counter = 0;
		this.spinning = false;
		this._trigger( "stop", event );
	},

	_setOption: function( key, value ) {
		var prevValue, first, last;

		if ( key === "culture" || key === "numberFormat" ) {
			prevValue = this._parse( this.element.val() );
			this.options[ key ] = value;
			this.element.val( this._format( prevValue ) );
			return;
		}

		if ( key === "max" || key === "min" || key === "step" ) {
			if ( typeof value === "string" ) {
				value = this._parse( value );
			}
		}
		if ( key === "icons" ) {
			first = this.buttons.first().find( ".ui-icon" );
			this._removeClass( first, null, this.options.icons.up );
			this._addClass( first, null, value.up );
			last = this.buttons.last().find( ".ui-icon" );
			this._removeClass( last, null, this.options.icons.down );
			this._addClass( last, null, value.down );
		}

		this._super( key, value );
	},

	_setOptionDisabled: function( value ) {
		this._super( value );

		this._toggleClass( this.uiSpinner, null, "ui-state-disabled", !!value );
		this.element.prop( "disabled", !!value );
		this.buttons.button( value ? "disable" : "enable" );
	},

	_setOptions: spinnerModifer( function( options ) {
		this._super( options );
	} ),

	_parse: function( val ) {
		if ( typeof val === "string" && val !== "" ) {
			val = window.Globalize && this.options.numberFormat ?
				Globalize.parseFloat( val, 10, this.options.culture ) : +val;
		}
		return val === "" || isNaN( val ) ? null : val;
	},

	_format: function( value ) {
		if ( value === "" ) {
			return "";
		}
		return window.Globalize && this.options.numberFormat ?
			Globalize.format( value, this.options.numberFormat, this.options.culture ) :
			value;
	},

	_refresh: function() {
		this.element.attr( {
			"aria-valuemin": this.options.min,
			"aria-valuemax": this.options.max,

			// TODO: what should we do with values that can't be parsed?
			"aria-valuenow": this._parse( this.element.val() )
		} );
	},

	isValid: function() {
		var value = this.value();

		// Null is invalid
		if ( value === null ) {
			return false;
		}

		// If value gets adjusted, it's invalid
		return value === this._adjustValue( value );
	},

	// Update the value without triggering change
	_value: function( value, allowAny ) {
		var parsed;
		if ( value !== "" ) {
			parsed = this._parse( value );
			if ( parsed !== null ) {
				if ( !allowAny ) {
					parsed = this._adjustValue( parsed );
				}
				value = this._format( parsed );
			}
		}
		this.element.val( value );
		this._refresh();
	},

	_destroy: function() {
		this.element
			.prop( "disabled", false )
			.removeAttr( "autocomplete role aria-valuemin aria-valuemax aria-valuenow" );

		this.uiSpinner.replaceWith( this.element );
	},

	stepUp: spinnerModifer( function( steps ) {
		this._stepUp( steps );
	} ),
	_stepUp: function( steps ) {
		if ( this._start() ) {
			this._spin( ( steps || 1 ) * this.options.step );
			this._stop();
		}
	},

	stepDown: spinnerModifer( function( steps ) {
		this._stepDown( steps );
	} ),
	_stepDown: function( steps ) {
		if ( this._start() ) {
			this._spin( ( steps || 1 ) * -this.options.step );
			this._stop();
		}
	},

	pageUp: spinnerModifer( function( pages ) {
		this._stepUp( ( pages || 1 ) * this.options.page );
	} ),

	pageDown: spinnerModifer( function( pages ) {
		this._stepDown( ( pages || 1 ) * this.options.page );
	} ),

	value: function( newVal ) {
		if ( !arguments.length ) {
			return this._parse( this.element.val() );
		}
		spinnerModifer( this._value ).call( this, newVal );
	},

	widget: function() {
		return this.uiSpinner;
	}
} );

// DEPRECATED
// TODO: switch return back to widget declaration at top of file when this is removed
if ( $.uiBackCompat !== false ) {

	// Backcompat for spinner html extension points
	$.widget( "ui.spinner", $.ui.spinner, {
		_enhance: function() {
			this.uiSpinner = this.element
				.attr( "autocomplete", "off" )
				.wrap( this._uiSpinnerHtml() )
				.parent()

					// Add buttons
					.append( this._buttonHtml() );
		},
		_uiSpinnerHtml: function() {
			return "<span>";
		},

		_buttonHtml: function() {
			return "<a></a><a></a>";
		}
	} );
}

return $.ui.spinner;

} ) );

},{}],36:[function(require,module,exports){
'use strict';
var ko = require('./herocalc_knockout');
    
var my = require("../herocalc/main");

my.prototype.DamageAmpViewModel = function (a) {
    var self = new my.prototype.BuffViewModel(ko.observableArray([]));
    self.availableBuffs = ko.observableArray([
        new my.prototype.BuffOption('slardar', 'slardar_sprint'),
        new my.prototype.BuffOption('undying', 'undying_flesh_golem'),
        new my.prototype.BuffOption('chen', 'chen_penitence'),
        new my.prototype.BuffOption('medusa', 'medusa_stone_gaze'),
        new my.prototype.BuffOption('shadow_demon', 'shadow_demon_soul_catcher')
    ]);
    self.availableDebuffs = ko.observableArray([
        new my.prototype.BuffOption('medusa', 'medusa_mana_shield'),
        //new my.prototype.BuffOption('templar_assassin', 'templar_assassin_refraction'),
        //new my.prototype.BuffOption('faceless_void', 'faceless_void_backtrack'),
        //new my.prototype.BuffOption('nyx_assassin', 'nyx_assassin_spiked_carapace'),
        new my.prototype.BuffOption('spectre', 'spectre_dispersion'),
        new my.prototype.BuffOption('wisp', 'wisp_overcharge'),
        new my.prototype.BuffOption('bristleback', 'bristleback_bristleback'),
        //new my.prototype.BuffOption('abaddon', 'abaddon_borrowed_time'),
        //new my.prototype.BuffOption('abaddon', 'abaddon_aphotic_shield'),
        //new my.prototype.BuffOption('dazzle', 'dazzle_shallow_grave'),
        //new my.prototype.BuffOption('treant', 'treant_living_armor'),
        new my.prototype.BuffOption('kunkka', 'kunkka_ghostship')
    ]);
    self.selectedBuff = ko.observable(self.availableBuffs()[0]);
    
    self.buffs = ko.observableArray([]);

    self.getAbilityDamageAmpValue = function (abilityName, attributeName) {
        var a = my.prototype.findWhere(self.buffs(), {name: abilityName});
        if (a == undefined) {
            return 0;
        }
        else {
            var ability = a.data;
            return self.getAbilityAttributeValue(ability.attributes, attributeName, ability.level());
        }
    }
    
    self.getDamageMultiplierSources = ko.computed(function () {
        var sources = {};
        for (var i = 0; i < self.abilities().length; i++) {
            var ability = self.abilities()[i];
                if (ability.level() > 0 && (ability.isActive() || (ability.behavior.indexOf('DOTA_ABILITY_BEHAVIOR_PASSIVE') != -1))) {
                    switch (ability.name) {
                        case 'bristleback_bristleback':
                            sources[ability.name] = {
                                'multiplier': ability.damageReduction() / 100,
                                'damageType': 'physical',
                                'displayname': ability.displayname
                            }
                        break;
                        case 'slardar_sprint':
                            sources[ability.name] = {
                                'multiplier': self.getAbilityAttributeValue(ability.attributes, 'bonus_damage', ability.level()) / 100,
                                'damageType': 'physical',
                                'displayname': ability.displayname
                            }
                        break;
                        case 'undying_flesh_golem':
                            sources[ability.name] = {
                                'multiplier': ability.damageAmplification() / 100,
                                'damageType': 'physical',
                                'displayname': ability.displayname
                            }
                        break;
                        case 'medusa_stone_gaze':
                            sources[ability.name] = {
                                'multiplier': self.getAbilityAttributeValue(ability.attributes, 'bonus_physical_damage', ability.level()) / 100,
                                'damageType': 'physical',
                                'displayname': ability.displayname
                            }
                        break;
                        case 'chen_penitence':
                            sources[ability.name] = {
                                'multiplier': self.getAbilityAttributeValue(ability.attributes, 'bonus_damage_taken', ability.level()) / 100,
                                'damageType': 'physical',
                                'displayname': ability.displayname
                            }
                        break;
                        case 'shadow_demon_soul_catcher':
                            sources[ability.name] = {
                                'multiplier': self.getAbilityAttributeValue(ability.attributes, 'bonus_damage_taken', ability.level()) / 100,
                                'damageType': 'pure',
                                'displayname': ability.displayname
                            }
                        break;
                        case 'medusa_mana_shield':
                            sources[ability.name] = {
                                'multiplier': ability.damageReduction() / 100,
                                'damageType': 'physical',
                                'displayname': ability.displayname
                            }                            
                        break;
                        case 'spectre_dispersion':
                            sources[ability.name] = {
                                'multiplier': -self.getAbilityAttributeValue(ability.attributes, 'damage_reflection_pct', ability.level()) / 100,
                                'damageType': 'percentreduction',
                                'displayname': ability.displayname
                            }                                
                        break;
                        case 'abaddon_aphotic_shield':
                            sources[ability.name] = {
                                'multiplier': self.getAbilityAttributeValue(ability.attributes, 'damage_absorb', ability.level()),
                                'damageType': 'flatreduction',
                                'displayname': ability.displayname
                            }                                
                        break;
                        case 'kunkka_ghostship':
                            sources[ability.name] = {
                                'multiplier': -50 / 100,
                                'damageType': 'percentreduction',
                                'displayname': ability.displayname
                            }                                
                        break;
                        case 'wisp_overcharge':
                            sources[ability.name] = {
                                'multiplier': self.getAbilityAttributeValue(ability.attributes, 'bonus_damage_pct', ability.level()) / 100,
                                'damageType': 'percentreduction',
                                'displayname': ability.displayname
                            }                                
                        break;
                        /*case 'faceless_void_backtrack':
                            sources[ability.name] = {
                                'multiplier': -self.getAbilityAttributeValue(ability.attributes, 'dodge_chance_pct', ability.level()) / 100,
                                'damageType': 'percentreduction',
                                'displayname': ability.displayname
                            }                                
                        break;*/
                    }
                }
        }
        return sources;
    });
    
    return self;
}
},{"../herocalc/main":57,"./herocalc_knockout":39}],37:[function(require,module,exports){
'use strict';
var ko = require('./herocalc_knockout');
    
var my = require("../herocalc/main");

my.prototype.GraphPropertyOption = function (id, label) {
    this.id = id;
    this.label = label;
};

my.prototype.AbilityModel.prototype.isQWER = function (ability) {
    return (ability.displayname != 'Empty' &&  (ability.behavior.indexOf('DOTA_ABILITY_BEHAVIOR_HIDDEN') == -1 || ability.name.indexOf('invoker_') != -1) && ability.behavior.indexOf('DOTA_ABILITY_BEHAVIOR_NOT_LEARNABLE') == -1)
}

my.prototype.BuildExplorerViewModel = function (h) {
var self = this;
    self.parent = h;

    self.itemBuild = ko.observableArray([]);
    self.skillBuild = ko.observableArray([]);
    self.graphDataItemRows = [];
    for (var i = 0; i < 25; i++) {
        self.itemBuild.push(new my.prototype.BasicInventoryViewModel());
        self.itemBuild()[i].carryOver = ko.observable(true);
        self.skillBuild.push(ko.observable(-1));
        self.graphDataItemRows.push(ko.observable(false));
    }
    self.toggleItemBuildCarryOver = function (index) {
        self.itemBuild()[index].carryOver(!self.itemBuild()[index].carryOver());
    }
    
    self.abilityMapData = [0,1,2,3,4];
    self.abilityMapHero = self.parent.selectedHero().heroName;
    self.abilityMap = ko.computed(function () {
        if (self.abilityMapHero == self.parent.selectedHero().heroName) return;
        self.abilityMapHero = self.parent.selectedHero().heroName;
        var newMap = self.parent.ability().abilities().map(function(ability, index) {
            if (self.parent.ability().isQWER(ability)) {
                return index;
            }
            else {
                return -1;
            }
        }).filter(function(element) { return element != -1; });
        for (var i = 0; i < 25; i++) {
            var abilityValue = self.skillBuild()[i]();
            if (abilityValue == -1) continue;
            
            var abilityIndex = self.abilityMapData.indexOf(abilityValue);
            var newValue = newMap[abilityIndex];
            if (newValue != abilityValue) {
                self.skillBuild()[i](newValue);
            }
        }
        self.abilityMapData = newMap;
    });
    
    self.availableSkillBuildPoints = ko.computed(function () {
        return self.skillBuild().reduce(function(memo, num){ return memo + (num() == -1); }, 0);
    });
    self.getSkillBuildAbilityLevel = function (index) {
        return self.skillBuild().reduce(function(memo, num){ return memo + (num() == index); }, 0);
    };
    self.toggleAbilitySkillBuild = function (index, abilityIndex, data, event) {
        if (self.skillBuild()[index]() != abilityIndex) {
            var ability = self.parent.ability().abilities()[abilityIndex],
                abilityType = ability.abilitytype,
                skillBuildSlice = self.skillBuild().slice(0, index),
                currentAbilityLevel = self.skillBuild().reduce(function(memo, num){ return memo + (num() == abilityIndex); }, 0),
                n = skillBuildSlice.reduce(function(memo, num){ return memo + (num() == abilityIndex); }, 0);
            
            if (self.IsValidAbilityLevel(ability, self.parent.selectedHero().heroName, index + 1, n)) {
                self.skillBuild()[index](abilityIndex);
                for (var i = index + 1; i < 25; i++) {
                    if (self.skillBuild()[i]() == abilityIndex) {
                        n++;
                        if (!self.IsValidAbilityLevel(ability, self.parent.selectedHero().heroName, i + 1, n)) {
                            self.skillBuild()[i](-1);
                            n--;
                        }
                    }
                }
            }
            else if (n > 0 && self.IsValidAbilityLevel(ability, self.parent.selectedHero().heroName, index + 1, n - 1)) {
                for (var i = skillBuildSlice.length - 1; i >= 0; i--) {
                    if (skillBuildSlice[i]() == abilityIndex) {
                        self.skillBuild()[i](-1);
                        self.skillBuild()[index](abilityIndex);
                        break;
                    }
                }
            }
        }
        else {
            self.skillBuild()[index](-1);
        }
    };
    self.IsValidAbilityLevel = function (ability, heroName, heroLevel, abilityLevel) {
        var a = 1, b = 2, m = 4;
        if (ability.name == 'attribute_bonus') {
            m = 10;
        }
        else {
            if (ability.abilitytype == 'DOTA_ABILITY_TYPE_ULTIMATE') {
                if (heroName == 'invoker') {
                    a = 2;
                    b = 5;
                }
                else if (heroName == 'meepo') {
                    a = 3;
                    b = 7;
                    m = 3;
                }
                else {
                    a = 6;
                    b = 5;
                    m = 3;
                }
            }
            else {
                if (heroName == 'invoker') {
                    m = 7;
                }
            }                
        }
        
        return heroLevel >= a + b * abilityLevel && abilityLevel < m;
    }
    
    self.resetItemBuild = function (index) {
        self.itemBuild()[index].removeAll();
    };        
    self.resetAllItemBuilds = function () {
        for (var i = 0; i < 25; i++) {
            self.itemBuild()[i].removeAll();
            self.itemBuild()[i].carryOver(true);
        }
    };
    self.resetSkillBuild = function () {
        for (var i = 0; i < 25; i++) {
            self.skillBuild()[i](-1);
        }
    };
    self.graphData = ko.observableArray([]);
    self.graphDataHeader = ko.observable(self.parent.selectedHero().heroDisplayName);
    self.parent.selectedHero.subscribe(function (newValue) {
        self.graphDataHeader(self.parent.selectedHero().heroDisplayName);
    });
    self.graphDataDescription = ko.observable('');
    self.graphProperties = ko.observableArray([
        new my.prototype.GraphPropertyOption('totalArmorPhysical', 'Armor'),
        new my.prototype.GraphPropertyOption('totalArmorPhysicalReduction', 'Physical Damage Reduction'),
        new my.prototype.GraphPropertyOption('totalMagicResistance', 'Magical Resistance'),
        new my.prototype.GraphPropertyOption('health', 'Health'),
        new my.prototype.GraphPropertyOption('healthregen', 'Health Regeneration'),
        new my.prototype.GraphPropertyOption('mana', 'Mana'),
        new my.prototype.GraphPropertyOption('manaregen', 'Mana Regeneration'),
        new my.prototype.GraphPropertyOption('ehpPhysical', 'EHP Physical'),
        new my.prototype.GraphPropertyOption('ehpMagical', 'EHP Magical'),
        new my.prototype.GraphPropertyOption('damage', 'Damage per attack'),
        new my.prototype.GraphPropertyOption('dps', 'Damage per second'),
        new my.prototype.GraphPropertyOption('attacksPerSecond', 'Attacks per second'),
        new my.prototype.GraphPropertyOption('attackTime', 'Time per attack')
    ]);
    self.graph = function() {
        var savedAbilityLevels = [],
            savedLevel = self.parent.selectedHeroLevel(),
            savedItems = self.parent.inventory.items(),
            savedActiveItems = self.parent.inventory.activeItems(),
            s = ko.toJS(self.skillBuild),
            carryOverItems = [],
            carryOverActiveItems = [],
            dataset = [];
        for (var i = 0; i < self.parent.ability().abilities().length; i++) {
            savedAbilityLevels.push(self.parent.ability().abilities()[i].level());
        }
        for (var i = 1; i < 26; i++) {
            self.parent.selectedHeroLevel(i);
            var skillBuildSubset = s.slice(0, i);
            for (var j = 0; j < self.parent.ability().abilities().length; j++) {
                var a = self.parent.ability().abilities()[j],
                    count = skillBuildSubset.reduce(function(memo, num) {
                        return memo + (num == j);
                    }, 0);
                a.level(count);
            }

            if (!self.itemBuild()[i - 1].carryOver()) {
                carryOverItems = [];
                carryOverActiveItems = [];
            }
            carryOverItems = carryOverItems.concat(self.itemBuild()[i - 1].items());
            carryOverActiveItems = carryOverActiveItems.concat(self.itemBuild()[i - 1].activeItems());

            self.parent.inventory.items(carryOverItems);
            self.parent.inventory.activeItems(carryOverActiveItems);
            var dataObj = {};
            for (var j = 0; j < self.graphProperties().length; j++) {
                var prop = self.graphProperties()[j];
                switch (prop.id) {
                    case 'dps':
                        dataObj[prop.id] = self.parent['damageTotalInfo']().totalRow[2]().toFixed(2);
                        break;
                    case 'damage':
                        dataObj[prop.id] = self.parent['damageTotalInfo']().totalRow[0]().toFixed(2);
                        break;
                    default:
                        dataObj[prop.id] = self.parent[prop.id]();
                        break;
                }
            }

            dataObj.items = carryOverItems.map(function(item) {
                return ko.toJS(item);
            });
            dataset.push(dataObj);
            if (carryOverItems > 0) {
                self.graphDataItemRows[i - 1](true);
            }
        }
        var data = {
            header: self.graphDataHeader(),
            description: self.graphDataDescription(),
            items: self.parent.inventory.items().map(function(item) {
                return ko.toJS(item);
            }),
            skillBuild: ko.toJS(self.skillBuild),
            data: dataset,
            abilityMap: self.abilityMapData.slice(0),
            cumulativeSkillBuild: [],
            visible: ko.observable(true)
        }
        for (var i = 0; i < 25; i++) {
            var skillBuildAtLevel = [],
                skillBuildSlice = data.skillBuild.slice(0, i + 1);
            for (var j = 0; j < data.abilityMap.length; j++) {
                var abilityIndex = data.abilityMap[j];
                skillBuildAtLevel.push(skillBuildSlice.reduce(function(memo, num) {
                    return memo + (num == abilityIndex);
                }, 0));
            }
            data.cumulativeSkillBuild.push(skillBuildAtLevel);
        }

        self.graphData.push(data);
        self.parent.selectedHeroLevel(savedLevel);
        for (var i = 0; i < self.parent.ability().abilities().length; i++) {
            self.parent.ability().abilities()[i].level(savedAbilityLevels[i]);
        }
        self.parent.inventory.items(savedItems);
        self.parent.inventory.activeItems(savedActiveItems);
    };
    self.removeGraphDataSet = function (data) {
        self.graphData.remove(data);
    }
    self.selectedGraphProperty = ko.observable(self.graphProperties()[0].id);
    
    self.graphChartOptions = ko.computed(function () {
        //var color = my.prototype.theme() == 'dark' ? 'rgb(151, 154, 162)' : 'rgb(51, 51, 51)';
        var color = 'rgb(151, 154, 162)';
        return {
            responsive: true,
            datasetStroke: false,
            datasetStrokeWidth: -1,
            datasetFill: false,
            pointHitDetectionRadius : 10,
            scaleFontColor: color,
            scaleLineColor: color.replace('rgb', 'rgba').replace(')', ', .1)'),
            scaleGridLineColor: color.replace('rgb', 'rgba').replace(')', ', .1)')
        }
    });
    self.graphChartData = ko.computed(function () {
        var data = {
            labels: [],
            datasets: []
        }
        for (var i = 0; i < 25; i++) {
            data.labels.push((i+1).toString());
        }
        for (var i = 0; i < self.graphData().length; i++) {
            var dataObj = self.graphData()[i],
                dataset = {
                    label: dataObj.header,
                    fillColor: self.graphDistinctColor(self.graphData().length, i, .1),
                    strokeColor: self.graphDistinctColor(self.graphData().length, i, 1),
                    pointColor: self.graphDistinctColor(self.graphData().length, i, 1),
                    pointStrokeColor: self.graphDistinctColor(self.graphData().length, i, 1),
                    pointHighlightFill: self.graphDistinctColor(self.graphData().length, i, .1),
                    pointHighlightStroke: self.graphDistinctColor(self.graphData().length, i, .5),
                    data: dataObj.data.map(function (o) {
                        return o[self.selectedGraphProperty()]
                    })
                };
            data.datasets.push(dataset);
        }
        return data;
    });
    self.graphDistinctColor = function (max, index, alpha) {
        var alpha = alpha || 1,
            rgba = self.hslToRgb((1 / max) * index % 1, 1, .5);
        rgba.push(alpha);
        return "rgba(" + rgba.join() + ")";
    }
    self.getDistinctColor = function (max, index, alpha) {
        var alpha = alpha || 1;
        rgba = self.hslToRgb((1 / max) * index % 1, 1, .5);
        rgba.push(alpha);
        return rgba;
    }
    self.hslToRgb = function(h, s, l) {
        var r, g, b;
        if (s == 0) {
            r = g = b = l; // achromatic
        }
        else {
            var hue2rgb = function hue2rgb(p, q, t) {
                if (t < 0) t += 1;
                if (t > 1) t -= 1;
                if (t < 1 / 6) return p + (q - p) * 6 * t;
                if (t < 1 / 2) return q;
                if (t < 2 / 3) return p + (q - p) * (2 / 3 - t) * 6;
                return p;
            }

            var q = l < 0.5 ? l * (1 + s) : l + s - l * s;
            var p = 2 * l - q;
            r = hue2rgb(p, q, h + 1 / 3);
            g = hue2rgb(p, q, h);
            b = hue2rgb(p, q, h - 1 / 3);
        }

        return [Math.round(r * 255), Math.round(g * 255), Math.round(b * 255)];
    }
    
    self.showGraphItemBuildRows = ko.observable(false);
    self.showGraphSkillBuildColumns = ko.observable(false);
    self.graphRowHasItems = function (index) {
        return self.graphData().some(function (dataset) {
            return dataset.visible() && dataset.data[index].items.length > 0;
        });
    }

    self.selectInventory = function (index) {
        self.parent.selectedInventory(self.parent.selectedInventory() == index ? -1 : index);
    }
    self.getSelectedInventory = ko.pureComputed(function () {
        if (self.parent.selectedInventory() == -1) {
            return self.parent.inventory;
        }
        else {
            return self.itemBuild()[self.parent.selectedInventory()];
        }
    });
    self.copyInventory = function (index) {
        if (self.parent.selectedInventory() != -1 && self.parent.selectedInventory() != index) {
            self.itemBuild()[self.parent.selectedInventory()].items(self.itemBuild()[self.parent.selectedInventory()].items().concat(self.itemBuild()[index].items()));
            self.itemBuild()[self.parent.selectedInventory()].activeItems(my.prototype.union(self.itemBuild()[self.parent.selectedInventory()].activeItems(), self.itemBuild()[index].activeItems()));
        }
    }
    self.copyInventoryToClipBoard = function (index) {
        if (index == -1) {
            my.prototype.inventoryClipBoard.items = self.parent.inventory.items.slice(0);
            my.prototype.inventoryClipBoard.activeItems = self.parent.inventory.activeItems.slice(0);            
        }
        else {
            my.prototype.inventoryClipBoard.items = self.itemBuild()[index].items.slice(0);
            my.prototype.inventoryClipBoard.activeItems = self.itemBuild()[index].activeItems.slice(0);
        }
    }
    self.pasteInventoryFromClipBoard = function (index) {
        if (my.prototype.inventoryClipBoard.items.length > 0) {
            if (index == -1) {
                self.parent.inventory.items(self.parent.inventory.items().concat(my.prototype.inventoryClipBoard.items));
                self.parent.inventory.activeItems(my.prototype.union(self.parent.inventory.activeItems(), my.prototype.inventoryClipBoard.activeItems));    
            }
            else {
                self.itemBuild()[index].items(self.itemBuild()[index].items().concat(my.prototype.inventoryClipBoard.items));
                self.itemBuild()[index].activeItems(my.prototype.union(self.itemBuild()[index].activeItems(), my.prototype.inventoryClipBoard.activeItems));
            }
        }
    }
    self.loadGraphData = function (data) {
        self.parent.sectionDisplay()['skillbuild'](true);
        for (var i = 0; i < data.length; i++) {
            data[i].visible = ko.observable(data[i].visible);
        }
        self.graphData(data);
    }
    self.graphChartContext = ko.observable();
    self.exportImage = function () {
        var w = window.open();
        w.document.write('<img src="'+ self.graphChartContext().canvas.toDataURL() +'"/>');
    }
    return self;
}
},{"../herocalc/main":57,"./herocalc_knockout":39}],38:[function(require,module,exports){
'use strict';
var ko = require('./herocalc_knockout');
    
var my = require("../herocalc/main");

my.prototype.DamageInstance = function (label, damageType, value, data, total) {
    this.label = label || '';
    this.damageType = damageType || '';
    this.value = parseFloat(value) || 0;
    this.data = data || [];
    this.total = parseFloat(total) || 0;
}

my.prototype.HeroDamageAmpMixin = function (self) {
    self.damageBrackets = [
        ['medusa_mana_shield', 'templar_assassin_refraction', 'faceless_void_backtrack', 'nyx_assassin_spiked_carapace'],
        ['spectre_dispersion', 'wisp_overcharge', 'slardar_sprint','bristleback_bristleback', 'undying_flesh_golem'],
        ['abaddon_borrowed_time', 'abaddon_aphotic_shield', 'kunkka_ghostship', 'treant_living_armor'],
        ['chen_penitence', 'medusa_stone_gaze', 'shadow_demon_soul_catcher'],
        ['dazzle_shallow_grave']
    ];
    
    self.getDamageAfterBracket = function (initialDamage,index) {
        var bracket = self.damageBrackets[index];
        var multiplier = 1;
        for (var i = 0; i < bracket.length; i++) {
            if (my.prototype.findWhere(self.damageAmplification.buffs, {name: bracket[i].name}) != undefined || my.prototype.findWhere(self.damageReduction.buffs, {name: bracket[i].name}) != undefined) {
                multiplier += bracket[i].value;
            }
        };
        return initialDamage * multiplier;
    };
    
    self.processDamageAmpReducBracket = function (index, sources, damage) {
        var multiplier = 1,
            data = [],
            damage = parseFloat(damage),
            total = parseFloat(damage);
            
        for (var i = 0; i < self.damageBrackets[index].length; i++) {
            if (sources[self.damageBrackets[index][i]] != undefined) {
                multiplier = 1 + parseFloat(sources[self.damageBrackets[index][i]].multiplier);
                total += (damage * multiplier) - damage;
                data.push(new my.prototype.DamageInstance(
                    sources[self.damageBrackets[index][i]].displayname,
                    sources[self.damageBrackets[index][i]].damageType,
                    (damage * multiplier) - damage,
                    [],
                    total
                ));
            }
        }
        return data;
    }
    
    self.getDamageAmpReducInstance = function(sources, initialDamage, ability, damageType) {
        var data = [],
            damage = parseFloat(initialDamage),
            prevDamage = damage,
            label = ability == 'initial' ? 'Initial' : sources[ability].displayname;

        // Bracket 0
        data = data.concat(self.processDamageAmpReducBracket(0, sources, damage));
        damage = data[data.length - 1] ? data[data.length - 1].total : damage;

        // Bracket 1
        data = data.concat(self.processDamageAmpReducBracket(1, sources, damage));
        damage = data[data.length - 1] ? data[data.length - 1].total : damage;
        
        // Bracket 2
        data = data.concat(self.processDamageAmpReducBracket(2, sources, damage));
        damage = data[data.length - 1] ? data[data.length - 1].total : damage;

        return new my.prototype.DamageInstance(label, damageType, initialDamage, data, data[data.length - 1] ? data[data.length - 1].total : damage);
    }
    
    self.getDamageAmpReduc = function (initialDamage) {
        var instances = [],
            sources = {},
            sourcesAmp = self.damageReduction.getDamageMultiplierSources(),
            sourcesReduc = self.damageAmplification.getDamageMultiplierSources();
        my.prototype.extend(sources, sourcesAmp);
        my.prototype.extend(sources, sourcesReduc);
        // Initial damage instance
        instances.push(self.getDamageAmpReducInstance(sources, initialDamage, 'initial', 'physical'));
        
        // Bracket 4 damage instances
        var b4 = ['shadow_demon_soul_catcher', 'medusa_stone_gaze', 'chen_penitence'];
        for (var i = 0; i < b4.length; i++) {
            if (sources[b4[i]] != undefined) {
                instances.push(self.getDamageAmpReducInstance(sources, initialDamage * sources[b4[i]].multiplier, b4[i], sources[b4[i]].damageType));
            }
        }
    
        return new my.prototype.DamageInstance('Total', 'physical', initialDamage, instances, instances.reduce(function(memo, i) {return parseFloat(memo) + parseFloat(i.total);}, 0));
    };
    
    self.damageInputValue = ko.observable(0);
    self.damageInputModified = ko.computed(function () {
        return self.getDamageAmpReduc(self.damageInputValue());
    });
}
},{"../herocalc/main":57,"./herocalc_knockout":39}],39:[function(require,module,exports){
(function (global){
'use strict';
var ko = (typeof window !== "undefined" ? window['ko'] : typeof global !== "undefined" ? global['ko'] : null);
var $ = (typeof window !== "undefined" ? window['$'] : typeof global !== "undefined" ? global['$'] : null);

ko.bindingHandlers.stopBinding = {
    init: function() {
        return { controlsDescendantBindings: true };
    }
};

ko.virtualElements.allowedBindings.stopBinding = true;

ko.bindingHandlers.lazyBinding = {
    init: function(element, valueAccessor, allBindingsAccessor, viewModel, bindingContext) {
        ko.utils.domData.set(element, 'isBound', false)
        
        // Also tell KO *not* to bind the descendants itself, otherwise they will be bound twice
        return { controlsDescendantBindings: true };
    },
    update: function(element, valueAccessor, allBindingsAccessor, viewModel, bindingContext) {
        var val = ko.unwrap(valueAccessor()),
            isBound = ko.utils.domData.get(element, 'isBound');
        if (val && !isBound) {
            ko.utils.domData.set(element, 'isBound', true);
            ko.applyBindingsToDescendants(bindingContext, element);
        }
    }
};

ko.virtualElements.allowedBindings.lazyBinding = true;

ko.bindingHandlers.itemBuildTable = {
    init: function(element, valueAccessor, allBindingsAccessor, viewModel, bindingContext) {
        var buildExplorer = ko.unwrap(valueAccessor()),
            $el = $(element);

        var pressedKeys = {};
        ko.utils.domData.set(element, 'pressedKeys', pressedKeys);
        
        var keyDownHandler = function(e) {
            var pressedKeys = ko.utils.domData.get(element, 'pressedKeys');
            pressedKeys[e.which] = true;
            ko.utils.domData.set(element, 'pressedKeys', pressedKeys);
        }
        ko.utils.domData.set(element, 'keyDownHandler', keyDownHandler);
        
        var keyUpHandler = function(e) {
            var pressedKeys = ko.utils.domData.get(element, 'pressedKeys');
            if ((pressedKeys[17] && pressedKeys[67]) || (pressedKeys[17] && pressedKeys[86])) { // ctrl + c
                var $hoveredRows = $(element).find('.hover-cursor:hover');
                if ($hoveredRows.length == 1) {
                    if (pressedKeys[67]) {
                        buildExplorer.copyInventoryToClipBoard($("tr", $(element)).index($hoveredRows[0]));
                    }
                    else {
                        buildExplorer.pasteInventoryFromClipBoard($("tr", $(element)).index($hoveredRows[0]));
                    }
                    $hoveredRows.fadeOut(50).fadeIn(50);
                }
            }
            delete pressedKeys[e.which];
            ko.utils.domData.set(element, 'pressedKeys', pressedKeys);
        }
        ko.utils.domData.set(element, 'keyUpHandler', keyUpHandler);
        
        $(document).bind( "keydown", keyDownHandler );
        $(document).bind( "keyup", keyUpHandler );

        ko.utils.domNodeDisposal.addDisposeCallback(element, function() {
            var keyDownHandler = ko.utils.domData.get(element, 'keyDownHandler');
            var keyUpHandler = ko.utils.domData.get(element, 'keyUpHandler');
            $(document).unbind( "keydown", keyDownHandler );
            $(document).unbind( "keyup", keyUpHandler );
        });
    }
};

ko.bindingHandlers.preventBubble = {
    init: function(element, valueAccessor) {
        var eventName = ko.utils.unwrapObservable(valueAccessor());
        ko.utils.registerEventHandler(element, eventName, function(event) {
           event.cancelBubble = true;
           if (event.stopPropagation) {
                event.stopPropagation();
           }                
        });
    }        
};

ko.bindingHandlers.toggle = {
    init: function (element, valueAccessor) {
        var value = valueAccessor();
        ko.applyBindingsToNode(element, {
            click: function () {
                value(!value());
            }
        });
    }
};

ko.bindingHandlers.shopDockStyle = {
    init: function(element, valueAccessor, allBindingsAccessor, viewModel, bindingContext) {
        var value = ko.utils.unwrapObservable(valueAccessor());
        if (bindingContext.$data.shopDock() && !bindingContext.$data.shopPopout()) {
            ko.applyBindingsToNode(element, { style: { height: (bindingContext.$data.windowHeight() - 52) + 'px', position: 'fixed', right: 0, top: '52px', 'overflow-y': 'auto' } });
        }
        else {
            ko.applyBindingsToNode(element, { style: { height: 'auto', position: 'relative', right: 'initial', top: 'initial', 'overflow-y': 'initial' } });
        }
    },
    update: function(element, valueAccessor, allBindingsAccessor, viewModel, bindingContext) {
        var value = ko.utils.unwrapObservable(valueAccessor());
        if (bindingContext.$data.shopDock() && !bindingContext.$data.shopPopout()) {
            ko.applyBindingsToNode(element, { style: { height: (bindingContext.$data.windowHeight() - 52) + 'px', position: 'fixed', right: 0, top: '52px', 'overflow-y': 'auto' } });
        }
        else {
            ko.applyBindingsToNode(element, { style: { height: 'auto', position: 'relative', right: 'initial', top: 'initial', 'overflow-y': 'initial' } });
        }
    }
};

ko.bindingHandlers.logger = {
    update: function(element, valueAccessor, allBindings) {
        //store a counter with this element
        var count = ko.utils.domData.get(element, "_ko_logger") || 0,
            data = ko.toJS(valueAccessor() || allBindings());

        ko.utils.domData.set(element, "_ko_logger", ++count);

        if (window.console && console.log) {
            console.log(count, element, data);
        }
    }
};

ko.bindingHandlers.tooltip = {
    update: function (element, valueAccessor, allBindingsAccessor, viewModel, bindingContext) {
        var $element, options, tooltip;
        options = ko.utils.unwrapObservable(valueAccessor());
        $element = $(element);

        // If the title is an observable, make it auto-updating.
        if (ko.isObservable(options.title)) {
            var isToolTipVisible = false;

            $element.on('show.bs.tooltip', function () {
                isToolTipVisible = true;
            });
            $element.on('hide.bs.tooltip', function () {
                isToolTipVisible = false;
            });

            // "true" is the bootstrap default.
            var origAnimation = options.animation || true;
            options.title.subscribe(function () {
                if (isToolTipVisible) {
                    $element.data('bs.tooltip').options.animation = false; // temporarily disable animation to avoid flickering of the tooltip
                    $element.tooltip('fixTitle') // call this method to update the title
                        .tooltip('show');
                    $element.data('bs.tooltip').options.animation = origAnimation;
                }
            });
        }

        tooltip = $element.data('bs.tooltip');
        if (tooltip) {
            $.extend(tooltip.options, options);
        } else {
            $element.tooltip(options);
        }
    }
};

ko.bindingHandlers.popover = {
    init: function (element, valueAccessor, allBindingsAccessor, viewModel, bindingContext) {
        var $element = $(element);
        var popoverBindingValues = ko.utils.unwrapObservable(valueAccessor());
        var template = popoverBindingValues.template || false;
        var options = popoverBindingValues.options || {title: 'popover'};
        var data = popoverBindingValues.data || false;
        if (template !== false) {
            if (data) {
                options.content = "<!-- ko template: { name: template, if: data, data: data } --><!-- /ko -->";
            }
            else {
                options.content = $('#' + template).html();
            }
            options.html = true;
        }
        $element.on('shown.bs.popover', function(event) {

            var popoverData = $(event.target).data();
            var popoverEl = popoverData['bs.popover'].$tip;
            var options = popoverData['bs.popover'].options || {};
            var button = $(event.target);
            var buttonPosition = button.position();
            var buttonDimensions = {
                x: button.outerWidth(),
                y: button.outerHeight()
            };

            if (data) {
                ko.applyBindingsToNode(popoverEl[0], { template: { name: template, data: data } }, bindingContext);
                //ko.applyBindings({template: template, data: data}, popoverEl[0]);
                //ko.renderTemplate(template, data, {}, popoverEl[0], 'replaceChildren');
            }
            else {
                //ko.renderTemplate(template, data, {}, popoverEl[0], 'replaceChildren');
                //ko.applyBindings(viewModel, popoverEl[0]);
            }

            var popoverDimensions = {
                x: popoverEl.outerWidth(),
                y: popoverEl.outerHeight()
            };

            popoverEl.find('button[data-dismiss="popover"]').click(function() {
                button.popover('hide');
            });

            switch (options.placement) {
                case 'right':
                    popoverEl.css({
                        left: buttonDimensions.x + buttonPosition.left,
                        top: (buttonDimensions.y / 2 + buttonPosition.top) - popoverDimensions.y / 2
                    });
                    break;
                case 'left':
                    popoverEl.css({
                        left: buttonPosition.left - popoverDimensions.x,
                        top: (buttonDimensions.y / 2 + buttonPosition.top) - popoverDimensions.y / 2
                    });
                    break;
                case 'top':
                    popoverEl.css({
                        left: buttonPosition.left + (buttonDimensions.x / 2 - popoverDimensions.x / 2),
                        top: buttonPosition.top - popoverDimensions.y
                    });
                    break;
                case 'bottom':
                    popoverEl.css({
                        left: buttonPosition.left + (buttonDimensions.x / 2 - popoverDimensions.x / 2),
                        top: buttonPosition.top + buttonDimensions.y
                    });
                    break;
            }
        });

        $element.popover(options);

        return { controlsDescendantBindings: true };

    }
};

ko.bindingHandlers.chart = {
    init: function(element, valueAccessor, allBindingsAccessor, viewModel, bindingContext) {
        var newCanvas = $('<canvas/>'),
      data = ko.utils.unwrapObservable(valueAccessor()),
      ctx = newCanvas[0].getContext("2d"),
      chartType = allBindingsAccessor().chartType,
      options = allBindingsAccessor().chartOptions || {},
      chartContext = allBindingsAccessor().chartContext;
            
        $(element).append(newCanvas);
        var myChart = new Chart(ctx)[chartType](data, options);
        ko.utils.domData.set(element, 'myChart', myChart);
        
  //handle disposal (if KO removes by the template binding)
  ko.utils.domNodeDisposal.addDisposeCallback(element, function() {
    var myChart = ko.utils.domData.get(element, 'myChart');
    myChart.clear();
    myChart.destroy();
  });
        
  if (chartContext) {
    chartContext(ctx);
  }
    },
    update: function(element, valueAccessor, allBindingsAccessor, viewModel, bindingContext) {
        var newCanvas = $('<canvas/>').width(730).height(365),
      data = ko.utils.unwrapObservable(valueAccessor()),
      ctx = newCanvas[0].getContext("2d"),
      chartType = allBindingsAccessor().chartType,
      options = allBindingsAccessor().chartOptions || {},
      chartContext = allBindingsAccessor().chartContext,
      myChart = ko.utils.domData.get(element, 'myChart');
        
  if (myChart) {
    myChart.clear();
    myChart.destroy();
  }
        bindingContext.$root.displayShop();
        bindingContext.$root.sideView();
        bindingContext.$root.shopDock();
        $(element).empty();
        $(element).append(newCanvas);
  if (data.datasets.length > 0) {
            myChart = new Chart(ctx)[chartType](data, options);
            ko.utils.domData.set(element, 'myChart', myChart);
  }
  
  if (chartContext) {
    chartContext(ctx);
  }
    }
};

ko.bindingHandlers.spinner = {
    init: function(element, valueAccessor, allBindingsAccessor) {
        //initialize datepicker with some optional options
        var options = allBindingsAccessor().spinnerOptions || {};
        options.icons = options.icons || { down: "glyphicon glyphicon-triangle-bottom", up: "glyphicon glyphicon-triangle-top" };
        $(element).spinner(options);

        //handle the field changing
        ko.utils.registerEventHandler(element, "spinchange", function () {
            var observable = valueAccessor();
            observable($(element).spinner("value"));
        });

        //handle disposal (if KO removes by the template binding)
        ko.utils.domNodeDisposal.addDisposeCallback(element, function() {
            $(element).spinner("destroy");
        });

    },
    update: function(element, valueAccessor) {
        var value = ko.utils.unwrapObservable(valueAccessor()),
            current = $(element).spinner("value");

        if (value !== current) {
            $(element).spinner("value", value);
        }
    }
};

ko.bindingHandlers.secondTab = {
    update: function(element, valueAccessor, allBindingsAccessor, viewModel, bindingContext) {
        var $root = bindingContext.$root,
            value = ko.utils.unwrapObservable(valueAccessor());
        ko.applyBindingsToNode(element, { css: {'second-tab': $root.isSecondTab(value) && $root.sideView()} });
    }
};

ko.bindingHandlers.hoverTab = {
    update: function(element, valueAccessor, allBindingsAccessor, viewModel, bindingContext) {
        var $root = bindingContext.$root,
            value = ko.utils.unwrapObservable(valueAccessor());
            
        ko.utils.registerEventHandler(element, "mouseover", function() {
            $root.highlightTab(value);
        });  

        ko.utils.registerEventHandler(element, "mouseout", function() {
            $root.unhighlightTab(value);
        });      
    }
};

ko.bindingHandlers.hoverPaneStyle = {
    init: function(element, valueAccessor, allBindingsAccessor, viewModel, bindingContext) {
        var $root = bindingContext.$root,
            value = ko.utils.unwrapObservable(valueAccessor());
        ko.applyBindingsToNode(element, { style: { opacity: !($root.sideView()) || $root.highlightedTab() == value || $root.highlightedTab() == '' ? 1 : .5 } });
    },
    update: function(element, valueAccessor, allBindingsAccessor, viewModel, bindingContext) {
        var $root = bindingContext.$root,
            value = ko.utils.unwrapObservable(valueAccessor());
        ko.applyBindingsToNode(element, { style: { opacity: !($root.sideView()) || $root.highlightedTab() == value || $root.highlightedTab() == '' ? 1 : .5 } });
    }
};

ko.bindingHandlers.diffStyle = {
    init: function(element, valueAccessor, allBindingsAccessor, viewModel) {
        var value = ko.utils.unwrapObservable(valueAccessor());
        ko.applyBindingsToNode(element, { css: {'diffPos': value > 0, 'diffNeg': value < 0} });
    },
    update: function(element, valueAccessor, allBindingsAccessor, viewModel) {
        var value = ko.utils.unwrapObservable(valueAccessor());
        ko.applyBindingsToNode(element, { css: {'diffPos': value > 0, 'diffNeg': value < 0} });
    }
};

ko.bindingHandlers.diffCss = {
    init: function(element, valueAccessor, allBindingsAccessor, viewModel) {
        var value = ko.utils.unwrapObservable(valueAccessor()),
            stat = allBindingsAccessor().diffCssStat;
        if (stat == 'attackTime' || stat == 'bat') {
            value = -value;
        }
        ko.applyBindingsToNode(element, { css: {'diffPos': value > 0, 'diffNeg': value < 0} });
    },
    update: function(element, valueAccessor, allBindingsAccessor, viewModel) {
        var value = ko.utils.unwrapObservable(valueAccessor()),
            stat = allBindingsAccessor().diffCssStat;
        if (stat == 'attackTime' || stat == 'bat') {
            value = -value;
        }
        ko.applyBindingsToNode(element, { css: {'diffPos': value > 0, 'diffNeg': value < 0} });
    }
};

ko.bindingHandlers.jqAuto = {
    init: function(element, valueAccessor, allBindingsAccessor, viewModel) {
        var options = valueAccessor() || {},
            allBindings = allBindingsAccessor(),
            unwrap = ko.utils.unwrapObservable,
            modelValue = allBindings.jqAutoValue,
            source = allBindings.jqAutoSource,
            valueProp = allBindings.jqAutoSourceValue,
            inputValueProp = allBindings.jqAutoSourceInputValue || valueProp,
            labelProp = allBindings.jqAutoSourceLabel || valueProp;

        //function that is shared by both select and change event handlers
        function writeValueToModel(valueToWrite) {
            if (ko.isWriteableObservable(modelValue)) {
               modelValue(valueToWrite );  
            } else {  //write to non-observable
               if (allBindings['_ko_property_writers'] && allBindings['_ko_property_writers']['jqAutoValue'])
                        allBindings['_ko_property_writers']['jqAutoValue'](valueToWrite );    
            }
        }
        
        //on a selection write the proper value to the model
        options.select = function(event, ui) {
            writeValueToModel(ui.item ? ui.item.actualValue : null);
        };
            
        //on a change, make sure that it is a valid value or clear out the model value
        options.change = function(event, ui) {
            var currentValue = $(element).val();
            var matchingItem =  ko.utils.arrayFirst(unwrap(source), function(item) {
               return unwrap(item[inputValueProp]) === currentValue;  
            });
            
            if (!matchingItem) {
               writeValueToModel(null);
            }    
        }
        
        
        //handle the choices being updated in a DO, to decouple value updates from source (options) updates
        var mappedSource = ko.dependentObservable(function() {
            var mapped = ko.utils.arrayMap(unwrap(source), function(item) {
                var result = {};
                result.label = labelProp ? unwrap(item[labelProp]) : unwrap(item).toString();  //show in pop-up choices
                result.value = inputValueProp ? unwrap(item[inputValueProp]) : unwrap(item).toString();  //show in input box
                result.actualValue = valueProp ? unwrap(item[valueProp]) : item;  //store in model
                return result;
            });
            return mapped;                
        });
        
        //whenever the items that make up the source are updated, make sure that autocomplete knows it
        mappedSource.subscribe(function(newValue) {
           $(element).autocomplete("option", "source", newValue); 
        });
        
        options.source = mappedSource();
        
        options.minLength = 1;
        //initialize autocomplete
        $(element).autocomplete(options);
    },
    update: function(element, valueAccessor, allBindingsAccessor, viewModel) {
       //update value based on a model change
       var allBindings = allBindingsAccessor(),
           unwrap = ko.utils.unwrapObservable,
           modelValue = unwrap(allBindings.jqAutoValue) || '', 
           valueProp = allBindings.jqAutoSourceValue,
           inputValueProp = allBindings.jqAutoSourceInputValue || valueProp;
        
       //if we are writing a different property to the input than we are writing to the model, then locate the object
       if (valueProp && inputValueProp !== valueProp) {
           var source = unwrap(allBindings.jqAutoSource) || [];
           var modelValue = ko.utils.arrayFirst(source, function(item) {
                 return unwrap(item[valueProp]) === modelValue;
           }) || {};  //probably don't need the || {}, but just protect against a bad value          
       } 

       //update the element with the value that should be shown in the input
       $(element).val(modelValue && inputValueProp !== valueProp ? unwrap(modelValue[inputValueProp]) : modelValue.toString());    
    }
};

ko.bindingHandlers.jqAutoCombo = {
    init: function(element, valueAccessor) {
       var autoEl = $("#" + valueAccessor());
       
        $(element).click(function() {
           // close if already visible
            if (autoEl.autocomplete("widget").is(":visible")) {
                autoEl.autocomplete( "close" );
                return;
            }

           //autoEl.blur();
            autoEl.autocomplete("search", " ");
            autoEl.focus(); 
            
        });
        
    }  
}

module.exports = ko;
}).call(this,typeof global !== "undefined" ? global : typeof self !== "undefined" ? self : typeof window !== "undefined" ? window : {})

},{}],40:[function(require,module,exports){
(function (global){
var ko = (typeof window !== "undefined" ? window['ko'] : typeof global !== "undefined" ? global['ko'] : null);
var my = require("../herocalc/main");
require("./herocalc_hero_damageamp");
require("./herocalc_buffs.amplification.reduction");
require("./herocalc_buildexplorer");

my.prototype.HeroOption2 = function (hero) {
    this.heroName = ko.computed(function () {
        return hero.selectedHero().heroName;
    });
    this.heroDisplayName = ko.computed(function () {
        return hero.selectedHero().heroDisplayName;
    });
    this.hero = hero;
};

my.prototype.HeroCalculatorModel = function (h) {
    var self = this;
    self.index = ko.observable(h);
    self.availableHeroes = ko.observableArray(my.prototype.HeroOptions);
    self.availableHeroes.sort(function (left, right) {
        return left.heroDisplayName == right.heroDisplayName ? 0 : (left.heroDisplayName < right.heroDisplayName ? -1 : 1);
    });
    self.selectedHero = ko.observable(self.availableHeroes()[h]);
    
    my.prototype.HeroModel.call(this, self.selectedHero().heroName);
    
    self.selectedHero.subscribe(function (newValue) {
        self.heroId(newValue.heroName);
    });
    
    
    self.bound = ko.observable(false);
    self.playerColorCss = ko.computed(function () {
        return 'player-color-' + self.index();
    });
    self.heroOption = new my.prototype.HeroOption2(self);
    self.otherHeroes = ko.observableArray([]);
    self.availableCompare = ko.computed(function () {
        return self.otherHeroes().map(function (o) {
            return o.heroOption;
        });
    });
    self.selectedCompare = ko.observable();
    self.selectedCompare.subscribe(function (newValue) {
        self.heroCompare(newValue.hero);
    });
    self.enemies = ko.observableArray([]);
    self.availableEnemies = ko.computed(function () {
        return self.enemies().map(function (o) {
            return o.heroOption;
        });
    });
    self.selectedEnemy = ko.observable();
    self.selectedEnemy.subscribe(function (newValue) {
        self.enemy(newValue.hero);
    });
    self.setHeroOptionStyling = function(option, item) {
        ko.applyBindingsToNode(option, {css: item.hero.playerColorCss() }, item);
    }
    self.sectionDisplay = ko.observable({
        'inventory': ko.observable(true),
        'ability': ko.observable(true),
        'buff': ko.observable(true),
        'debuff': ko.observable(true),
        'damageamp': ko.observable(false),
        'illusion': ko.observable(false),
        'skillbuild': ko.observable(false),
        'skillbuild-skills': ko.observable(true),
        'skillbuild-items': ko.observable(true)
    });
    self.sectionDisplayToggle = function (section) {
        self.sectionDisplay()[section](!self.sectionDisplay()[section]());
    }
    self.showUnitTab = ko.observable(false);
    self.showDiff = ko.observable(false);
    self.showCriticalStrikeDetails = ko.observable(false);
    self.showDamageDetails = ko.observable(false);
    self.showStatDetails = ko.observable(false);
    self.showDamageAmpCalcDetails = ko.observable(false);
    
    self.damageAmplification = new my.prototype.DamageAmpViewModel();
    self.damageReduction = new my.prototype.DamageAmpViewModel();
    self.buildExplorer = new my.prototype.BuildExplorerViewModel(self);
    my.prototype.HeroDamageAmpMixin(self);
}
my.prototype.HeroCalculatorModel.prototype = Object.create(my.prototype.HeroModel.prototype);
my.prototype.HeroCalculatorModel.prototype.constructor = my.prototype.HeroCalculatorModel;
}).call(this,typeof global !== "undefined" ? global : typeof self !== "undefined" ? self : typeof window !== "undefined" ? window : {})

},{"../herocalc/main":57,"./herocalc_buffs.amplification.reduction":36,"./herocalc_buildexplorer":37,"./herocalc_hero_damageamp":38}],41:[function(require,module,exports){
(function (global){
'use strict';
var $ = (typeof window !== "undefined" ? window['$'] : typeof global !== "undefined" ? global['$'] : null);
require('jquery-ui');
require('../../../node_modules/jquery-ui/ui/version');
require('../../../node_modules/jquery-ui/ui/widget');
require('../../../node_modules/jquery-ui/ui/unique-id');
require('../../../node_modules/jquery-ui/ui/safe-active-element');
require('../../../node_modules/jquery-ui/ui/keycode');
require('../../../node_modules/jquery-ui/ui/position');
require('../../../node_modules/jquery-ui/ui/focusable');
require('../../../node_modules/jquery-ui/ui/tabbable');
require('../../../node_modules/jquery-ui/ui/plugin');
require('../../../node_modules/jquery-ui/ui/ie');
require('../../../node_modules/jquery-ui/ui/data');
require('../../../node_modules/jquery-ui/ui/scroll-parent');
require('../../../node_modules/jquery-ui/ui/disable-selection');
require('../../../node_modules/jquery-ui/ui/safe-blur');
require('../../../node_modules/jquery-ui/ui/widgets/button');
require('../../../node_modules/jquery-ui/ui/widgets/spinner');
require('../../../node_modules/jquery-ui/ui/widgets/menu');
require('../../../node_modules/jquery-ui/ui/widgets/autocomplete');
require('../../../node_modules/jquery-ui/ui/widgets/mouse');
require('../../../node_modules/jquery-ui/ui/widgets/draggable');
require('../../../node_modules/jquery-ui/ui/widgets/resizable');
require('../../../node_modules/jquery-ui/ui/widgets/dialog');

var proto = $.ui.autocomplete.prototype,
    initSource = proto._initSource;

function filter( array, term ) {
    var matcher = new RegExp( $.ui.autocomplete.escapeRegex(term), "i" );
    return $.grep( array, function(value) {
        return matcher.test( $( "<div>" ).html( value.label || value.value || value ).text() );
    });
}

$.extend( proto, {
    _initSource: function() {
        if ( this.options.html && $.isArray(this.options.source) ) {
            this.source = function( request, response ) {
                response( filter( this.options.source, request.term ) );
            };
        } else {
            initSource.call( this );
        }
    },

    _renderItem: function( ul, item) {
        return $( "<li></li>" )
            .data( "item.autocomplete", item )
            .append( $( "<a></a>" )[ this.options.html ? "html" : "text" ]( item.label ) )
            .appendTo( ul );
    }
});
}).call(this,typeof global !== "undefined" ? global : typeof self !== "undefined" ? self : typeof window !== "undefined" ? window : {})

},{"../../../node_modules/jquery-ui/ui/data":14,"../../../node_modules/jquery-ui/ui/disable-selection":15,"../../../node_modules/jquery-ui/ui/focusable":16,"../../../node_modules/jquery-ui/ui/ie":17,"../../../node_modules/jquery-ui/ui/keycode":18,"../../../node_modules/jquery-ui/ui/plugin":19,"../../../node_modules/jquery-ui/ui/position":20,"../../../node_modules/jquery-ui/ui/safe-active-element":21,"../../../node_modules/jquery-ui/ui/safe-blur":22,"../../../node_modules/jquery-ui/ui/scroll-parent":23,"../../../node_modules/jquery-ui/ui/tabbable":24,"../../../node_modules/jquery-ui/ui/unique-id":25,"../../../node_modules/jquery-ui/ui/version":26,"../../../node_modules/jquery-ui/ui/widget":27,"../../../node_modules/jquery-ui/ui/widgets/autocomplete":28,"../../../node_modules/jquery-ui/ui/widgets/button":29,"../../../node_modules/jquery-ui/ui/widgets/dialog":30,"../../../node_modules/jquery-ui/ui/widgets/draggable":31,"../../../node_modules/jquery-ui/ui/widgets/menu":32,"../../../node_modules/jquery-ui/ui/widgets/mouse":33,"../../../node_modules/jquery-ui/ui/widgets/resizable":34,"../../../node_modules/jquery-ui/ui/widgets/spinner":35,"jquery-ui":27}],42:[function(require,module,exports){
(function (global){
'use strict';
var ko = require('./herocalc_knockout');
var $ = (typeof window !== "undefined" ? window['$'] : typeof global !== "undefined" ? global['$'] : null);
global.jQuery = $;
require('bootstrap');
require('./jquery-ui.custom');
require('../lib/Chart.min');
require('../lib/Chart.scatter');

ko.components.register('hero-pane', { template: "<div class=\"row\">\n    <div class=\"col-md-3\">\n        <img class=\"img-rounded hero-image\" data-bind=\"attr:{src: '/media/images/heroes/' + selectedHero().heroName + '.png'}\"/>\n    </div>\n    <div class=\"col-md-9\">\n        <div class=\"row form-group\">\n            <div class=\"col-md-6\">\n                <label for=\"heroselect\">Hero</label>\n                <select id=\"heroselect\" class=\"form-control\" data-bind=\"options: availableHeroes , optionsText: 'heroDisplayName', value: selectedHero\"></select>\n            </div>\n            <div class=\"col-md-6\">\n                <label for=\"herolevel\">Level</label>\n                <input id=\"herolevel\" data-bind=\"spinner: selectedHeroLevel, spinnerOptions: { min: 1, max: 25 }\">\n            </div>\n        </div>\n        <div class=\"row\">\n            <div class=\"col-md-6\">\n                <label for=\"enemyselect\">Enemy</label>\n                <select id=\"enemyselect\" class=\"form-control\" data-bind=\"css: enemy().playerColorCss, options: availableEnemies , optionsText: 'heroDisplayName', value: selectedEnemy, optionsAfterRender: setHeroOptionStyling\"></select>\n            </div>\n            <div class=\"col-md-6\">\n                <label for=\"enemyselect\">Compare to</label>\n                <select id=\"enemyselect\" class=\"form-control\" data-bind=\"css: heroCompare().playerColorCss, options: availableCompare , optionsText: 'heroDisplayName', value: selectedCompare, optionsAfterRender: setHeroOptionStyling\"></select>\n            </div>\n            <div class=\"col-md-12 checkbox\" style=\"margin-bottom:0px;padding-left:34px;\" data-bind=\"visible: $root.layout() == 0\">\n                <label><input type=\"checkbox\" style=\"float:none;margin-right:5px;\" data-bind=\"checked: showDiff\"><span style=\"font-size:12px\">Show <abbr title=\"The difference between two adjacent hero tabs shown next to each stat.\">delta values</abbr>. <span data-bind=\"visible: showDiff\">Comparing level <span data-bind=\"text: selectedHeroLevel\"></span> <span data-bind=\"text: heroData().displayname, css: playerColorCss\"></span> to level <span data-bind=\"text: heroCompare().selectedHeroLevel\"></span> <span data-bind=\"text: heroCompare().heroData().displayname, css: heroCompare().playerColorCss\"></span>.</span></span></label>\n                <label style=\"margin-left:25px;font-size:12px;\"><input type=\"checkbox\" style=\"float:none;margin-right:5px;\" data-bind=\"checked: showUnitTab\">Show unit tab</label>\n            </div>\n        </div>\n    </div>\n</div>\n\n<div class=\"row\">\n    <div class=\"col-md-4\" data-bind=\"css: {'col-md-4': $root.layout() == 0, 'col-md-12': $root.layout() == 1}\">\n        <div class=\"row\">\n            <h3 class=\"col-md-12\">Stats <a class=\"btn btn-default btn-xs\" data-bind=\"toggle: showStatDetails, text: !showStatDetails() ? 'Show more' : 'Show less', attr: {title: !showStatDetails() ? 'Click to show base stats' : 'Click to hide base stats'}\"></a>\n                <div style=\"margin-left:15px;display:inline;\" data-bind=\"style: {'display': $root.layout() == 1 ? 'inline' : 'none'}\">\n                    <label><input type=\"checkbox\" style=\"float:none;margin-right:5px;\" data-bind=\"checked: showDiff\"><span style=\"font-size:12px\">Show <abbr title=\"The difference between two adjacent hero tabs shown next to each stat.\">delta values</abbr>. <span data-bind=\"visible: showDiff\">Comparing level <span data-bind=\"text: selectedHeroLevel\"></span> <span data-bind=\"text: heroData().displayname, css: playerColorCss\"></span> to level <span data-bind=\"text: heroCompare().selectedHeroLevel\"></span> <span data-bind=\"text: heroCompare().heroData().displayname, css: heroCompare().playerColorCss\"></span>.</span></span></label>\n                    <label style=\"margin-left:25px;font-size:12px;\"><input type=\"checkbox\" style=\"float:none;margin-right:5px;\" data-bind=\"checked: showUnitTab\">Show unit tab</label>\n                </div>\n            </h3>\n\n            <div class=\"col-md-12\" data-bind=\"visible: showStatDetails(), css: {'col-md-12': $root.layout() == 0, 'col-md-3': $root.layout() == 1}, component: {name: 'stats-additional', params: $data}\"></div>\n\n            <div class=\"statscontainer\" data-bind=\"foreach: $root.allItems\">\n                <div data-bind=\"component: { name: $data.value, params: $parentContext.$data}\"></div>\n            </div>\n        </div>\n    </div>\n    <div class=\"col-md-8\" data-bind=\"css: {'col-md-8': $root.layout() == 0, 'col-md-12': $root.layout() == 1}\">\n        <div data-bind=\"component: { name: 'damage-details', params: $data}\"></div>\n    \n        <div class=\"row\">\n            <div class=\"col-md-12\" data-bind=\"itemBuildTable: $data.buildExplorer\">\n                <h3 class=\"section_header\" data-bind=\"toggle: sectionDisplay().inventory, css: { section_disabled: !sectionDisplay().inventory() }\">Inventory <small style=\"color:goldenrod\" data-bind=\"html: inventory.totalCost() ? '<img src=\\'http://cdn.dota2.com/apps/dota2/images/tooltips/gold.png\\'/> ' + inventory.totalCost() : '' \"></small></h3>\n                <div id=\"inventory\" class=\"inventory hover-cursor\" data-bind=\"click: function (data, event) { buildExplorer.selectInventory(-1); }, css: {'row-highlight': selectedInventory() == -1}, template: { name: 'item-template', foreach: inventory.items }, visible: sectionDisplay().inventory()\"></div>\n            </div>\n        </div>\n        \n        <div class=\"row\">\n            <div class=\"col-md-12\">\n                <h3 class=\"section_header\" data-bind=\"toggle: sectionDisplay().ability, css: { section_disabled: !sectionDisplay().ability() }\">Abilities <small style=\"color:inherit\" data-bind=\"text: availableSkillPoints() ? (availableSkillPoints() == 1 ? '1 unspent skillpoint' : availableSkillPoints() + ' unspent skillpoints') : ''\"></small></h3>\n                <div class=\"row\" data-bind=\"visible: sectionDisplay().ability(), foreach: ability().abilities()\">\n                    <div data-bind=\"component: { name: 'ability', params: $data }\"></div>\n                </div>\n                <div class=\"form-horizontal\" data-bind=\"if: selectedHero().heroName == 'silencer', visible: sectionDisplay().ability()\">\n                    <div class=\"form-group\">\n                            <div class=\"col-md-2 control-label\">\n                                <label for=\"intelligencestolen\">Intelligence Stolen</label>\n                            </div>\n                            <div class=\"col-md-2\">\n                                <input class=\"form-control\" id=\"intelligencestolen\" data-bind=\"value: intStolen\" />\n                            </div>\n                    </div>\n                </div>\n            </div>\n        </div>\n\n        <div data-bind=\"component: { name: 'buff-section', params: $data}\"></div>\n        \n        <div class=\"row\" data-bind=\"component: { name: 'damage-amp', params: $data}\"></div>\n\n        <div class=\"row\">\n            <div class=\"col-md-12\">\n                <h3 class=\"section_header\" data-bind=\"toggle: sectionDisplay().illusion, css: { section_disabled: !sectionDisplay().illusion() }\">Illusions</h3>\n                <div data-bind=\"visible: sectionDisplay().illusion(), lazyBinding: sectionDisplay().illusion\">\n                    <h4 style=\"color:red\">Under Construction</h4>\n                    <div class=\"form-horizontal\">\n                        <div class=\"form-group\">\n                                <div class=\"col-md-2 control-label\">\n                                    <label for=\"illusionSelect\">Type</label>\n                                </div>\n                                <div class=\"col-md-10\">\n                                    <select id=\"illusionSelect\" class=\"form-control\" data-bind=\"options: availableIllusions , optionsText: 'illusionDisplayName', value: selectedIllusion\"></select>\n                                </div>\n                        </div>\n                        <div class=\"form-group\">\n                                <div class=\"col-md-2 control-label\">\n                                    <label for=\"illusionabilitylevel\">Ability Level</label>\n                                </div>\n                                <div class=\"col-md-10\">\n                                    <select id=\"illusionabilitylevel\" class=\"form-control\" data-bind=\"value: illusionAbilityLevel, foreach: new Array(illusionAbilityMaxLevel())\">\n                                        <option data-bind=\"text: $index()+1\"></option>\n                                    </select>\n                                </div>\n                        </div>\n                        <div class=\"form-group\">\n                            <div class=\"col-md-offset-2 col-md-10\">\n                                <button class=\"btn btn-default\" data-bind=\"click: addIllusion\">Add Illusion</button>\n                            </div>\n                        </div>\n                    </div>\n                </div>\n            </div>\n        </div>\n    </div>\n    \n    <div class=\"col-md-12\">\n        <h3 class=\"section_header\" data-bind=\"toggle: sectionDisplay().skillbuild, css: { section_disabled: !sectionDisplay().skillbuild() }\">Build Explorer</h3>\n        <div data-bind=\"visible: sectionDisplay().skillbuild(), attr: {id: 'section-build-explorer-' + index() }, lazyBinding: sectionDisplay().skillbuild\">\n            <div class=\"section-content\">    \n                <div class=\"col-md-12\">\n                    <h4 class=\"section_header\" data-bind=\"toggle: sectionDisplay()['skillbuild-skills'], css: { section_disabled: !sectionDisplay()['skillbuild-skills']() }\">Skill Build <small style=\"color:inherit\" data-bind=\"text: buildExplorer.availableSkillBuildPoints() ? (buildExplorer.availableSkillBuildPoints() == 1 ? '1 unspent skillpoint' : buildExplorer.availableSkillBuildPoints() + ' unspent skillpoints') : ''\"></small></h4>\n                        <div data-bind=\"visible: sectionDisplay()['skillbuild-skills']\">\n                        <table>\n                            <tbody data-bind=\"template: { name: 'ability-3-template', foreach: ability().abilities() }\"></tbody>\n                        </table>\n                        <div class=\"form-group\">\n                            <button class=\"btn btn-default\" data-bind=\"click: buildExplorer.resetSkillBuild\">Clear</button>\n                        </div>\n                    </div>\n                </div>\n                <div class=\"col-md-12\">\n                    <h4 class=\"section_header\" data-bind=\"toggle: sectionDisplay()['skillbuild-items'], css: { section_disabled: !sectionDisplay()['skillbuild-items']() }\">Item Build</h4>\n                    <div data-bind=\"visible: sectionDisplay()['skillbuild-items']\">\n                        <table class=\"table\">\n                            <thead>\n                                <tr>\n                                    <th>Level</th>\n                                    <th class=\"text-center\">Inventory</th>\n                                    <th></th>\n                                    <th></th>\n                                    <th></th>\n                                </tr>\n                            </thead>\n                            <tbody data-bind=\"foreach: new Array(25), itemBuildTable: buildExplorer\">\n                                <tr class=\"hover-cursor\" data-bind=\"css: {'row-highlight': $parent.selectedInventory() == $index()}\">\n                                    <td class=\"carry-over\" data-bind=\"click: function (data, event) { $parent.buildExplorer.selectInventory($index()); }\">\n                                        <strong data-bind=\"text: ($index() + 1)\"></strong>\n                                        <a class=\"btn btn-default btn-xs glyphicon\" data-bind=\"visible: $index() > 0, toggle: $parent.buildExplorer.itemBuild()[$index()].carryOver, preventBubble: 'click', css: { 'glyphicon-arrow-down': $parent.buildExplorer.itemBuild()[$index()].carryOver(), 'glyphicon-stop': !$parent.buildExplorer.itemBuild()[$index()].carryOver() }\" title=\"Carry over items to next level's inventory\"></a>\n                                    </td>\n                                    <td class=\"col-md-10\" data-bind=\"click: function (data, event) { $parent.buildExplorer.selectInventory($index()); }\">\n                                        <div class=\"itemBuild-inventory\" data-bind=\"template: { name: 'itemBuild-item-template', foreach: $parent.buildExplorer.itemBuild()[$index()].items }\"></div>\n                                    </td>\n                                    <td>\n                                        <a class=\"btn btn-default btn-xs\" data-bind=\"click: function (data, event) { $parent.buildExplorer.copyInventoryToClipBoard($index()); }\" title=\"Copy items\">Copy</a>\n                                    </td>\n                                    <td>\n                                        <a class=\"btn btn-default btn-xs\" data-bind=\"click: function (data, event) { $parent.buildExplorer.pasteInventoryFromClipBoard($index()); }\" title=\"Paste items\">Paste</a>\n                                    </td>\n                                    <td>\n                                        <a class=\"btn btn-default btn-xs\" data-bind=\"click: function (data, event) { $parent.buildExplorer.resetItemBuild($index()); }\" title=\"Clear inventory\">Clear</a>\n                                    </td>\n                                </tr>\n                            </tbody>\n                        </table>\n                        <div class=\"form-group\">\n                            <button class=\"btn btn-default\" data-bind=\"click: buildExplorer.resetAllItemBuilds\">Clear</button>\n                        </div>\n                    </div>\n                </div>\n                <div class=\"form-group\">\n                    <label>Data set header label</label>\n                    <input type=\"text\" class=\"form-control\" data-bind=\"value: buildExplorer.graphDataHeader\">\n                </div>\n                <div class=\"form-group\">\n                    <label>Data set description</label>\n                    <input type=\"text\" class=\"form-control\" data-bind=\"value: buildExplorer.graphDataDescription\">\n                </div>\n                <div class=\"form-group\">\n                    <button class=\"btn btn-default\" data-bind=\"click: buildExplorer.graph\">Add data set</button>\n                </div>\n                <div class=\"form-group\">\n                    <label>Hero Property</label>\n                    <select class=\"form-control\" data-bind=\"options: buildExplorer.graphProperties, optionsText: 'label', optionsValue: 'id', value: buildExplorer.selectedGraphProperty\"></select>\n                </div>\n                <!-- ko if: buildExplorer.graphData().length > 0 -->\n                <div class=\"form-group\" data-bind=\"chart: buildExplorer.graphChartData, chartType: 'Scatter', chartOptions: buildExplorer.graphChartOptions(), chartContext: buildExplorer.graphChartContext\"></div>\n                <div class=\"form-group\">\n                  <button class=\"btn btn-default\" data-bind=\"click: buildExplorer.exportImage\"><span class=\"glyphicon glyphicon-export\"></span> Export Image</button>\n                </div>\n                <button class=\"btn btn-default btn-xs\" data-bind=\"toggle: buildExplorer.showGraphItemBuildRows, css: {'toggled': buildExplorer.showGraphItemBuildRows}\">Show item build rows</button>\n                <button class=\"btn btn-default btn-xs\" data-bind=\"toggle: buildExplorer.showGraphSkillBuildColumns, css: {'toggled': buildExplorer.showGraphSkillBuildColumns}\">Show skill build columns</button>\n                <table class=\"table build-table\">\n                    <thead>\n                        <tr>\n                            <th class=\"right-border\">Level</th>\n                            <!-- ko foreach: buildExplorer.graphData -->\n                            <th class=\"text-center\" data-bind=\"css: { 'right-border': !$parent.buildExplorer.showGraphSkillBuildColumns() || !$data.visible() }\">\n                                <span data-bind=\"css: { 'tooltip-underline': $data.description }, tooltip: {title: $data.description, placement: 'bottom'}, visible: $data.visible(), text: $data.header, style: { color: $parent.buildExplorer.graphDistinctColor($parent.buildExplorer.graphData().length, $index(), 1) }\"></span>\n                                <span class=\"btn btn-xs glyphicon glyphicon-info-sign\" data-bind=\"visible: $data.visible(), popover: {template: 'popover-graphData-template', data: $data, options: {} }\"></span>\n                                <button class=\"btn btn-default btn-xs shop-button glyphicon glyphicon-remove pull-right\" class=\"close\" data-bind=\"visible: !$parent.buildExplorer.showGraphSkillBuildColumns() || !$data.visible(), click: function(data, event) { $parent.buildExplorer.removeGraphDataSet($data); }\"></button>\n                                <button class=\"btn btn-default btn-xs shop-button glyphicon pull-right\" data-bind=\"visible: !$parent.buildExplorer.showGraphSkillBuildColumns() || !$data.visible(), toggle: $data.visible, css: { 'glyphicon-minus': $data.visible(), 'glyphicon-plus': !$data.visible()}\"></button>\n                            </th>\n                            <th class=\"text-left right-border\" data-bind=\"visible: $data.visible() && $parent.buildExplorer.showGraphSkillBuildColumns()\"><abbr title=\"Q-W-E-R-Stats\">Skill Build</abbr>\n                                <button class=\"btn btn-default btn-xs shop-button glyphicon glyphicon-remove pull-right\" class=\"close\" data-bind=\"visible: $parent.buildExplorer.showGraphSkillBuildColumns(), click: function(data, event) { $parent.buildExplorer.removeGraphDataSet($data); }\"></button>\n                                <button class=\"btn btn-default btn-xs shop-button glyphicon pull-right\" data-bind=\"visible: $parent.buildExplorer.showGraphSkillBuildColumns(), toggle: $data.visible, css: { 'glyphicon-minus': $data.visible(), 'glyphicon-plus': !$data.visible()}\"></button>\n                            </th>\n                            <!-- /ko -->\n                        </tr>\n                    </thead>\n                    <tbody data-bind=\"foreach: new Array(buildExplorer.graphData()[0].data.length)\">\n                        <tr>\n                            <td class=\"right-border\">\n                                <strong data-bind=\"text: ($index() + 1)\"></strong>\n                            </td>\n                            <!-- ko foreach: new Array($parent.buildExplorer.graphData().length) -->\n                            <td class=\"text-right\" data-bind=\"css: { 'right-border': !$parents[1].buildExplorer.showGraphSkillBuildColumns() || !$parents[1].buildExplorer.graphData()[$index()].visible() }\">\n                                <span data-bind=\"visible: $parents[1].buildExplorer.graphData()[$index()].visible(), text: $parents[1].buildExplorer.graphData()[$index()].data[$parentContext.$index()][$parents[1].buildExplorer.selectedGraphProperty()]\"></span>\n                            </td>\n                            <td class=\"text-left right-border\" data-bind=\"visible: $parents[1].buildExplorer.graphData()[$index()].visible() && $parents[1].buildExplorer.showGraphSkillBuildColumns(), text: $parents[1].buildExplorer.graphData()[$index()].cumulativeSkillBuild[$parentContext.$index()].join('-')\"></td>\n                            <!-- /ko -->\n                        </tr>\n                        <tr class=\"itemBuild-inventory\" data-bind=\"visible: $parent.buildExplorer.showGraphItemBuildRows() && $parent.buildExplorer.graphRowHasItems($index())\">\n                            <td class=\"right-border-itemrow no-top-border\"></td>\n                            <!-- ko foreach: new Array($parent.buildExplorer.graphData().length) -->\n                            <td class=\"right-border-itemrow no-top-border\" data-bind=\"attr: { colspan: $parents[1].buildExplorer.graphData()[$index()].visible() && $parents[1].buildExplorer.showGraphSkillBuildColumns() ? 2 : 1 }\">\n                                <div data-bind=\"visible: $parents[1].buildExplorer.graphData()[$index()].visible(), foreach: $parents[1].buildExplorer.graphData()[$index()].data[$parentContext.$index()].items\">\n                                    <img class=\"itemBuild-img-sm img-rounded\" data-bind=\"css: { item_disabled: !enabled, item_active: $parents[2].inventory.getActiveBorder($data) == 1, item_inactive: $parents[2].inventory.getActiveBorder($data) == 0 }, attr:{ src: $parents[2].inventory.getItemImage($data) }\"/>\n                                    <div style=\"float:left\" data-bind=\"visible: $parents[2].inventory.getItemSizeLabel($data) != ''\">\n                                        <div data-bind=\"html: $parents[2].inventory.getItemSizeLabel($data)\" style=\"position:absolute;left:0;bottom:0;color:white;opacity:.5;background-color:black;padding:0px 2px\"></div>\n                                        <div data-bind=\"html: $parents[2].inventory.getItemSizeLabel($data)\" style=\"position:absolute;left:0;bottom:0;color:white;padding:0px 2px\"></div>\n                                    </div>\n                                </div>\n                            </td>\n                            <!-- /ko -->\n                        </tr>\n                    </tbody>\n                </table>\n                <!-- /ko -->\n            </div>\n        </div>\n    </div>\n\n</div>" });
ko.components.register('unit-pane', { template: "<div class=\"row\">\n    <div class=\"col-md-4\">\n        <img class=\"img-rounded\" data-bind=\"attr:{src: selectedUnit().image}\"/>\n    </div>\n    <div class=\"col-md-4\">\n        <label for=\"unitselect\">Unit</label>\n        <select id=\"unitselect\" class=\"form-control\" data-bind=\"options: availableUnits , optionsText: 'heroDisplayName', value: selectedUnit\"></select>\n    </div>\n    <div class=\"col-md-4\">\n        <label for=\"unitlevel\">Level</label>\n        <p class=\"form-control-static\" data-bind=\"visible: selectedUnit().levels == 0, text: hero().level\"></p>\n        <select id=\"herolevel\" class=\"form-control\" data-bind=\"visible: selectedUnit().levels > 0, value: selectedUnitLevel, foreach: new Array(selectedUnit().levels)\">\n            <option data-bind=\"text: $index()+1\"></option>\n        </select>\n    </div>\n</div>\n\n<div class=\"row\">\n    <div class=\"col-md-4\" data-bind=\"css: {'col-md-4': $root.layout() == 0, 'col-md-12': $root.layout() == 1}\">\n        <div class=\"row\">\n            <h3 class=\"col-md-12\">Stats <a class=\"btn btn-default btn-xs\" data-bind=\"toggle: showStatDetails, text: !showStatDetails() ? 'Show more' : 'Show less', attr: {title: !showStatDetails() ? 'Click to show base stats' : 'Click to hide base stats'}\"></a></h3>\n\n            <div class=\"col-md-3\" data-bind=\"visible: showStatDetails(), component: {name: 'stats-additional', params: $data}\"></div>\n            \n            <div class=\"col-md-12\" data-bind=\"css: {'col-md-12': $root.layout() == 0, 'col-md-3': $root.layout() == 1}\">\n                <table class=\"table table-condensed\">\n                <tbody>\n                <tr><td>Gold:</td><td class=\"text-right\"><span data-bind=\"text: hero().bountygoldmin() == hero().bountygoldmax() ? hero().bountygoldmax() : hero().bountygoldmin() + '-' + hero().bountygoldmax()\"></span></td></tr>\n                <tr><td>Experience:</td><td class=\"text-right\"><span data-bind=\"text: hero().bountyxp()\"></span></td></tr>\n                <tr><td>Level:</td><td class=\"text-right\"><span data-bind=\"text: hero().level()\"></span></td></tr>\n                <tr><td><abbr title=\"Movement Speed\">MS</abbr>:</td><td class=\"text-right\"><span data-bind=\"text: totalMovementSpeed\"></span></td></tr>\n                <tr><td>Turn Rate:</td><td class=\"text-right\"><span data-bind=\"text: totalTurnRate\"></span></td></tr>\n                <tr><td>Sight Range:</td><td class=\"text-right\"><span data-bind=\"html: '<abbr title=\\'Day\\'>' + visionrangeday() + '</abbr>/<abbr title=\\'Night\\'>' + visionrangenight() + '</abbr>'\"></span></td></tr>\n                </tbody>\n                </table>\n            </div>\n\n\n            <div class=\"col-md-12\" data-bind=\"css: {'col-md-12': $root.layout() == 0, 'col-md-3': $root.layout() == 1}\">\n                <table class=\"table table-condensed\">\n                <tbody>\n                <tr><td>Health:</td><td class=\"text-right\"><span data-bind=\"text: health\"></span></td></tr>\n                <tr><td>Health Regen:</td><td class=\"text-right\"><span data-bind=\"text: healthregen\"></span></td></tr>\n                <tr><td>Mana:</td><td class=\"text-right\"><span data-bind=\"text: mana\"></span></td></tr>\n                <tr><td>Mana Regen:</td><td class=\"text-right\"><span data-bind=\"text: manaregen\"></span></td></tr>\n                <tr><td>Physical <abbr title=\"Effective Hit Points\">EHP</abbr>:</td><td class=\"text-right\"><span data-bind=\"text: ehpPhysical\"></span></td></tr>\n                <tr><td>Magical <abbr title=\"Effective Hit Points\">EHP</abbr>:</td><td class=\"text-right\"><span data-bind=\"text: ehpMagical\"></span></td></tr>\n                </tbody>\n                </table>\n            </div>\n\n            <div class=\"col-md-12\" data-bind=\"css: {'col-md-12': $root.layout() == 0, 'col-md-3': $root.layout() == 1}\">\n                <table class=\"table table-condensed\">\n                <tbody>\n                <tr><td>Armor:</td><td class=\"text-right\"><span data-bind=\"text: totalArmorPhysical\"></span></td></tr>\n                <tr><td>Magic Res:</td><td class=\"text-right\"><span data-bind=\"html: totalMagicResistance().toFixed(2) + '%'\"></span></td></tr>\n                <tr><td>Lifesteal:</td><td class=\"text-right\"><span data-bind=\"text: lifesteal\"></span></td></tr>\n                <tr><td>Evasion:</td><td class=\"text-right\"><span data-bind=\"text: evasion\"></span></td></tr>\n                <tr><td>Bash:</td><td class=\"text-right\"><span data-bind=\"text: bash\"></span></td></tr>\n                <tr><td>Miss Chance:</td><td class=\"text-right\"><span data-bind=\"text: missChance\"></span></td></tr>\n                </tbody>\n                <tbody class=\"tabledropdown\" style=\"border-top:0\" data-bind=\"visible: showCriticalStrikeDetails(),foreach: critInfo().sources\">\n                <tr><td colspan=2><strong data-bind=\"text: $data.name\"></strong></td></tr>\n                <tr><td>Crit Chance:</td><td class=\"text-right\"><span data-bind=\"text: ($data.totalchance * 100).toFixed(2) + '%'\"></span></td></tr>\n                <tr><td>Crit Multiplier:</td><td class=\"text-right\"><span data-bind=\"text: ($data.multiplier * 100).toFixed(2) + '%'\"></span></td></tr>\n                </tbody>\n                </table>\n            </div>\n\n            <div class=\"col-md-12\" data-bind=\"css: {'col-md-12': $root.layout() == 0, 'col-md-3': $root.layout() == 1}\">\n                <table class=\"table table-condensed\">\n                <tbody>\n                <tr>\n                    <td>Damage:</td>\n                    <td class=\"text-right\">\n                        <span data-bind=\"html: baseDamage()[0] + '-' + baseDamage()[1]\"></span>\n                        <span style=\"color:green\" data-bind=\"visible: bonusDamage() > 0, text: ' + ' + bonusDamage()\"></span>\n                        <span style=\"color:red\" data-bind=\"visible: bonusDamageReduction() != 0, text: ' - ' + bonusDamageReduction()\"></span>\n                    </td>\n                </tr>\n                <tr><td><abbr title=\"Increased Attack Speed\">IAS</abbr>:</td><td class=\"text-right\"><span data-bind=\"text: ias\"></span></td></tr>\n                <tr><td><abbr title=\"Base Attack Time\">BAT</abbr>:</td><td class=\"text-right\"><span data-bind=\"text: bat\"></span></td></tr>\n                <tr><td>Attack Time:</td><td class=\"text-right\"><span data-bind=\"text: attackTime\"></span></td></tr>\n                <tr><td>Attack / Sec:</td><td class=\"text-right\"><span data-bind=\"text: attacksPerSecond().toFixed(2)\"></span></td></tr>\n                <tr><td>Attack Range:</td><td class=\"text-right\"><span data-bind=\"text: totalattackrange\"></span></td></tr>\n                </tbody>\n                </table>\n            </div>\n        </div>\n    </div>\n    <div class=\"col-md-8\" data-bind=\"css: {'col-md-8': $root.layout() == 0, 'col-md-12': $root.layout() == 1}\">\n        <div data-bind=\"component: { name: 'damage-details', params: $data}\"></div>\n        \n        <div class=\"row\">\n            <div class=\"col-md-12\">\n                <h3 class=\"section_header\" data-bind=\"toggle: sectionDisplay().inventory, css: { section_disabled: !sectionDisplay().inventory() }\">Inventory <small style=\"color:goldenrod\" data-bind=\"html: inventory.totalCost() ? '<img src=\\'http://cdn.dota2.com/apps/dota2/images/tooltips/gold.png\\'/> ' + inventory.totalCost() : '' \"></small></h3>\n                <div id=\"inventory\" class=\"inventory hover-cursor\" data-bind=\"click: function (data, event) { buildExplorer.selectInventory(-1); }, css: {'row-highlight': selectedInventory() == -1}, template: { name: 'item-template', foreach: inventory.items }, visible: sectionDisplay().inventory()\"></div>\n            </div>\n        </div>\n        \n        <div class=\"row\">\n            <div class=\"col-md-12\">\n                <h3 class=\"section_header\" data-bind=\"toggle: sectionDisplay().ability, css: { section_disabled: !sectionDisplay().ability() }\">Abilities <small style=\"color:inherit\" data-bind=\"text: availableSkillPoints() ? (availableSkillPoints() == 1 ? '1 unspent skillpoint' : availableSkillPoints() + ' unspent skillpoints') : ''\"></small></h3>\n                <div class=\"row\" data-bind=\"visible: sectionDisplay().ability(), foreach: ability().abilities()\">\n                    <div data-bind=\"component: { name: 'ability', params: $data }\"></div>\n                </div>\n                <div class=\"form-horizontal\" data-bind=\"if: selectedHero().heroName == 'silencer', visible: sectionDisplay().ability()\">\n                    <div class=\"form-group\">\n                            <div class=\"col-md-2 control-label\">\n                                <label for=\"intelligencestolen\">Intelligence Stolen</label>\n                            </div>\n                            <div class=\"col-md-2\">\n                                <input class=\"form-control\" id=\"intelligencestolen\" data-bind=\"value: intStolen\" />\n                            </div>\n                    </div>\n                </div>\n            </div>\n        </div>\n\n        <div data-bind=\"component: { name: 'buff-section', params: $data}\"></div>\n    </div>\n</div>" });
ko.components.register('clone-pane', { template: "<div class=\"row\">\n    <div class=\"col-md-4\">\n        <img class=\"img-rounded\" data-bind=\"attr:{src: '/media/images/heroes/meepo.png'}\"/>\n    </div>\n</div>\n\n<div class=\"row\">\n    <div class=\"col-md-4\" data-bind=\"css: {'col-md-4': $root.layout() == 0, 'col-md-12': $root.layout() == 1}\">\n        <div class=\"row\">\n            <h3 class=\"col-md-12\">Stats <a class=\"btn btn-default btn-xs\" data-bind=\"toggle: showStatDetails, text: !showStatDetails() ? 'Show more' : 'Show less', attr: {title: !showStatDetails() ? 'Click to show base stats' : 'Click to hide base stats'}\"></a></h3>\n\n            <div class=\"col-md-12\" data-bind=\"visible: showStatDetails(), css: {'col-md-12': $root.layout() == 0, 'col-md-3': $root.layout() == 1}, component: {name: 'stats-additional', params: $data}\"></div>\n\n            <div class=\"statscontainer\" data-bind=\"foreach: $root.allItems\">\n                <div data-bind=\"component: { name: $data.value, params: $root.heroes[$parentContext.$index()].clone()}\"></div>\n            </div>\n        </div>\n    </div>\n    <div class=\"col-md-8\" data-bind=\"css: {'col-md-8': $root.layout() == 0, 'col-md-12': $root.layout() == 1}\">\n        <div data-bind=\"component: { name: 'damage-details', params: $data}\"></div>\n        \n        <div class=\"row\">\n            <div class=\"col-md-12\">\n                <h3 class=\"section_header\" data-bind=\"toggle: sectionDisplay().inventory, css: { section_disabled: !sectionDisplay().inventory() }\">Inventory <small style=\"color:goldenrod\" data-bind=\"html: inventory.totalCost() ? '<img src=\\'http://cdn.dota2.com/apps/dota2/images/tooltips/gold.png\\'/> ' + inventory.totalCost() : '' \"></small></h3>\n                <div id=\"inventory\" class=\"inventory hover-cursor\" data-bind=\"click: function (data, event) { buildExplorer.selectInventory(-1); }, css: {'row-highlight': selectedInventory() == -1}, template: { name: 'item-template', foreach: inventory.items }, visible: sectionDisplay().inventory()\"></div>\n            </div>\n        </div>\n\n        <div class=\"row\" data-bind=\"component: { name: 'damage-amp', params: $data}\"></div>\n    </div>\n</div>" });
ko.components.register('illusion-pane', { template: "<div class=\"row\">\n    <div class=\"col-md-4\">\n        <div class=\"img-rounded\" style=\"background-color:#428bca;display:inline-block\">\n            <img class=\"img-rounded\" style=\"opacity:.5\" data-bind=\"attr:{src: '/media/images/heroes/' + selectedHero().heroName + '.png'}\"/>\n        </div>\n    </div>\n    <div class=\"col-md-4\">\n        <label for=\"illusionlevel\" data-bind=\"text: illusionDisplayName\"></label>\n        <table class=\"table\">\n            <tbody>\n            <tr>\n                <td>Damage Dealt</td>\n                <td class=\"text-right\" data-bind=\"text: (getOutgoingDamageMultiplier(illusionType(), false, hero().attacktype())*100).toFixed(0)+'%'\"></td>\n            </tr>\n            <tr>\n                <td>Damage Taken</td>\n                <td class=\"text-right\" data-bind=\"text: (getIncomingDamageMultiplier(illusionType(), false, hero().attacktype())*100).toFixed(0)+'%'\"></td>\n            </tr>\n            </tbody>\n        </table>\n    </div>\n    <div class=\"col-md-4\">\n        <div data-bind=\"visible: illusionType() != 'item_manta'\">\n            <label for=\"illusionlevel\">Ability Level</label>\n            <select id=\"illusionlevel\" class=\"form-control\" data-bind=\"value: illusionAbilityLevel, foreach: new Array(illusionAbilityMaxLevel())\">\n                <option data-bind=\"text: $index()+1\"></option>\n            </select>\n        </div>\n    </div>\n</div>\n\n<div class=\"row\">\n    <div class=\"col-md-4\" data-bind=\"css: {'col-md-4': $root.layout() == 0, 'col-md-12': $root.layout() == 1}\">\n        <div class=\"row\">\n            <h3 class=\"col-md-12\">Stats <a class=\"btn btn-default btn-xs\" data-bind=\"toggle: showStatDetails, text: !showStatDetails() ? 'Show more' : 'Show less', attr: {title: !showStatDetails() ? 'Click to show base stats' : 'Click to hide base stats'}\"></a></h3>\n\n            <div class=\"col-md-12\" data-bind=\"visible: showStatDetails(), css: {'col-md-12': $root.layout() == 0, 'col-md-3': $root.layout() == 1}, component: {name: 'stats-additional', params: $data}\">\n            </div>\n            <div class=\"statscontainer\" data-bind=\"foreach: $root.allItems\">\n                <div data-bind=\"component: { name: $data.value, params: $parentContext.$data}\"></div>\n            </div>\n        </div>\n    </div>\n    <div class=\"col-md-8\" data-bind=\"css: {'col-md-4': $root.layout() == 0, 'col-md-12': $root.layout() == 1}\">\n        <div class=\"row\">\n            <div class=\"col-md-12\">\n                <h3 class=\"section_header\" data-bind=\"toggle: sectionDisplay().inventory, css: { section_disabled: !sectionDisplay().inventory() }\">Inventory <small style=\"color:goldenrod\" data-bind=\"html: inventory.totalCost() ? '<img src=\\'http://cdn.dota2.com/apps/dota2/images/tooltips/gold.png\\'/> ' + inventory.totalCost() : '' \"></small></h3>\n                <div id=\"inventory\" class=\"inventory hover-cursor\" data-bind=\"click: function (data, event) { buildExplorer.selectInventory(-1); }, css: {'row-highlight': selectedInventory() == -1}, foreach: inventory.items, visible: sectionDisplay().inventory()\">\n                    <div class=\"btn-group\">\n                        <img style=\"width:75px;\" class=\"img-rounded\" data-bind=\"css: { item_disabled: !enabled(), item_active: $parent.inventory.getActiveBorder($data) == 1, item_inactive: $parent.inventory.getActiveBorder($data) == 0 }, attr:{ src: $parent.inventory.getItemImage($data) }, click: function(data, event) { $parent.inventory.toggleItem($index, data, event); }, event: { dblclick: $parent.inventory.removeItem }\"/>\n                        <div style=\"float:left\" data-bind=\"visible: $parent.inventory.getItemSizeLabel($data) != ''\">\n                            <div data-bind=\"html: $parent.inventory.getItemSizeLabel($data)\" style=\"position:absolute;left:0;bottom:0;color:white;opacity:.5;background-color:black;padding:0px 2px\"></div>\n                            <div data-bind=\"html: $parent.inventory.getItemSizeLabel($data)\" style=\"position:absolute;left:0;bottom:0;color:white;padding:0px 2px\"></div>\n                        </div>\n                    </div>\n                </div>\n            </div>\n        </div>\n    </div>\n</div>" });
ko.components.register('buff-settings', { template: "<div class=\"form-horizontal\">\n    <div data-bind=\"foreach: data\">\n        <div class=\"form-group\" data-bind=\"visible: (display == undefined || display == 'buff')\">\n            <label class=\"col-md-6 control-label\" data-bind=\"css: {'checkbox-label': controlType == 'checkbox'}, attr: {'for': labelName}, html: labelName\"></label>\n            <div data-bind=\"if: controlType == 'input' && (display == undefined || display == 'buff' || display == 'hidden')\">\n                <div class=\"col-md-6\"><input class=\"form-control\" data-bind=\"attr: {'id': labelName}, value: controlVal\"></div>\n            </div>\n            <div data-bind=\"if: controlType == 'checkbox' && (display == undefined || display == 'buff' || display == 'hidden')\">\n                <div class=\"col-md-6\">\n                    <div class=\"checkbox\">\n                        <input type=\"checkbox\" data-bind=\"attr: {'id': labelName}, checked: controlVal\">\n                    </div>\n                </div>\n            </div>\n            <div data-bind=\"if: (controlType == 'text' || controlType == 'method') && (display == undefined || display == 'buff' || display == 'hidden')\">\n                <div class=\"col-md-6\"><p class=\"form-control-static\" data-bind=\"html: controlVal\"></p></div>\n            </div>\n            <div data-bind=\"if: controlType == 'radio' && (display == undefined || display == 'buff' || display == 'hidden')\">\n                <div class=\"col-md-6\">\n                    <!-- ko foreach: controlOptions -->\n                    <div class=\"radio\">\n                        <label>\n                            <input type=\"radio\" data-bind=\"attr: {'id': $parent.labelName + value, value: value}, checked: $parent.controlVal\">\n                            <span data-bind=\"text: text\"></span>\n                        </label>\n                    </div>\n                    <!-- /ko -->\n                </div>\n            </div>\n        </div>\n    </div>\n</div>" });
ko.components.register('item-buff', { template: "<div class=\"btn-group\">\n    <img style=\"width:75px;\" class=\"img-rounded\" data-bind=\"css: { item_disabled: !enabled(), item_active: $parents[1].buffs.itemBuffs.getActiveBorder($data) == 1, item_inactive: $parents[1].buffs.itemBuffs.getActiveBorder($data) == 0 }, attr:{ src: $parents[1].buffs.itemBuffs.getItemImage($data) }, click: function(data, event) { $parents[1].buffs.itemBuffs.toggleItem($index, data, event); }, event: { dblclick: $parents[1].buffs.itemBuffs.removeItem }\"/>\n    <div class=\"btn-group-vertical\">\n        <button style=\"padding:3px 10px;\" class=\"btn btn-default btn-xs\" title=\"Remove Item\" data-bind=\"click: $parents[1].buffs.itemBuffs.removeItem\">&times;</button>\n        <button style=\"padding:3px 10px;\" class=\"btn btn-default btn-xs\" title=\"Disable/Enable Item\" data-bind=\"click: $parents[1].buffs.itemBuffs.toggleMuteItem, html: enabled() ? 'o' : '-', attr: {title: enabled() ? 'Disable Item' : 'Enable Item'}\">o</button>\n    </div>\n</div>" });
ko.components.register('item-debuff', { template: "<div class=\"btn-group\">\n    <img style=\"width:75px;\" class=\"img-rounded\" data-bind=\"css: { item_disabled: !enabled(), item_active: $parents[1].debuffs.itemBuffs.getActiveBorder($data) == 1, item_inactive: $parents[1].debuffs.itemBuffs.getActiveBorder($data) == 0 }, attr:{ src: $parents[1].debuffs.itemBuffs.getItemImage($data) }, click: function(data, event) { $parents[1].debuffs.itemBuffs.toggleItem($index, data, event); }, event: { dblclick: $parents[1].debuffs.itemBuffs.removeItem }\"/>\n    <div class=\"btn-group-vertical\">\n        <button style=\"padding:3px 10px;\" class=\"btn btn-default btn-xs\" title=\"Remove Item\" data-bind=\"click: $parents[1].debuffs.itemBuffs.removeItem\">&times;</button>\n        <button style=\"padding:3px 10px;\" class=\"btn btn-default btn-xs\" title=\"Disable/Enable Item\" data-bind=\"click: $parents[1].debuffs.itemBuffs.toggleMuteItem, html: enabled() ? 'o' : '-', attr: {title: enabled() ? 'Disable Item' : 'Enable Item'}\">o</button>\n    </div>\n</div>" });
ko.components.register('buff-section', { template: "<div class=\"row\">\n    <div class=\"col-md-12\">\n        <h3 class=\"section_header\" data-bind=\"toggle: sectionDisplay().buff, css: { section_disabled: !sectionDisplay().buff() }\">Buffs</h3>\n        <div class=\"form-horizontal\" data-bind=\"visible: sectionDisplay().buff()\">\n            <div class=\"form-group\">\n                <div class=\"col-md-6\">\n                    <select id=\"buffselect\" class=\"form-control\" data-bind=\"options: buffs.availableBuffs , optionsText: 'buffDisplayName', value: buffs.selectedBuff\"></select>\n                </div>\n                <div class=\"col-md-6\">\n                    <button class=\"btn btn-default\" data-bind=\"click: buffs.addBuff\">Add</button>\n                    <button class=\"btn btn-default\" data-bind=\"click: function(data,event) { buffs.removeBuff(data, event, buffs.selectedBuff().buffName) }\">Remove</button>\n                </div>\n            </div>\n        </div>\n        <div class=\"row\" data-bind=\"foreach: buffs.buffs, visible: sectionDisplay().buff()\">\n            <div data-bind=\"css: {row: $data.data.isDetail() || ($index() < $parent.buffs.buffs().length-1 && $parent.buffs.buffs()[$index()+1].data.isDetail()), row2: $data.data.isDetail() || ($index() < $parent.buffs.buffs().length-1 && $parent.buffs.buffs()[$index()+1].data.isDetail()) }\">\n                <div class=\"col-md-3 text-center bottom-buffer2\" data-bind=\"css: {'col-md-3': $root.layout() == 0, 'col-md-2': $root.layout() == 1}\">\n                    <img style=\"padding:0px;margin-bottom:1px;\" class=\"img-rounded ability\" data-bind=\"css: { ability_active: $data.data.isActive() || $data.data.behavior.indexOf('DOTA_ABILITY_BEHAVIOR_PASSIVE') != -1, ability_inactive: !$data.data.isActive() && $data.data.behavior.indexOf('DOTA_ABILITY_BEHAVIOR_PASSIVE') == -1, btn: $data.data.behavior.indexOf('DOTA_ABILITY_BEHAVIOR_PASSIVE') == -1, 'btn-default': $data.data.behavior.indexOf('DOTA_ABILITY_BEHAVIOR_PASSIVE') == -1}, attr:{src: '/media/images/spellicons/' + $data.data.name + '.png'}, click: function(data, event) { $parent.buffs.toggleBuff($index, data.data, event); }, event: { dblclick: function(data,event) { $parent.buffs.removeBuff(data, event, $data.data.name) } }\"/>\n                    <div class=\"progress\" style=\"position:relative\">\n                        <div style=\"position:absolute;width:100%;color:white;\" class=\"text-center\" data-bind=\"visible: $parent.getAbilityLevelMax($data.data) > 0, text: $data.data.level() + '/' + $parent.getAbilityLevelMax($data.data)\"></div>\n                        <div class=\"progress-bar progress-bar-danger\" role=\"progressbar\" aria-valuenow=\"60\" aria-valuemin=\"0\" aria-valuemax=\"100\" style=\"width: 60%;\" data-bind=\"attr: { 'aria-valuenow': ($parent.getAbilityLevelMax($data.data) > 0 ? $data.data.level()/$parent.getAbilityLevelMax($data.data)*100 : 0) }, style: { width: ($parent.getAbilityLevelMax($data.data) > 0 ? $data.data.level()/$parent.getAbilityLevelMax($data.data)*100 : 0) + '%' }\"></div>\n                    </div>\n                    <div class=\"btn-group btn-group-justified\" data-bind=\"if: $data.data.behavior.indexOf('DOTA_ABILITY_BEHAVIOR_NOT_LEARNABLE') == -1\">\n                        <a class=\"btn btn-default btn-sm\" data-bind=\"click: function(data, event) { $parent.buffs.levelDownAbility($index, data.data, event, $parent); }\">-</a>\n                        <a class=\"btn btn-default btn-sm\" data-bind=\"click: function(data, event) { $parent.buffs.levelUpAbility($index, data.data, event, $parent); }\">+</a>\n                    </div>\n                    <div class=\"btn-group btn-group-justified\">\n                        <a class=\"btn btn-default btn-sm\" data-bind=\"click: function(data, event) { $parent.buffs.toggleBuffDetail($index, data, event); }, css: {'toggled': $data.data.isDetail}\">Details</a>\n                    </div>\n                </div>\n                <div class=\"col-md-9 bottom-buffer\" data-bind=\"visible: $data.data.isDetail()\">\n                    <button type=\"button\" class=\"close\" data-bind=\"click: function(data, event) { $parent.buffs.toggleBuffDetail($index, data.data, event); }\">&times;</button>\n                    <div data-bind=\"html: $parent.ability().getAbilityTooltipData($data.hero, $data.data.name)\"></div>\n                    <div data-bind=\"if: $data.data.name in $parent.buffs.abilityData && $parent.buffs.buffs()[$index()].data.level() > 0\">\n                        <div class=\"col-md-8\">\n                            <div data-bind=\"component: { name: 'buff-settings', params: $parent.buffs.abilitySettingsData($data.data.name, $parent, $index()) }\"></div>\n                        </div>\n                    </div>\n                </div>\n            </div>\n        </div>\n        \n        <div class=\"form-horizontal\" data-bind=\"visible: sectionDisplay().buff()\">\n            <div class=\"form-group\">\n                <div class=\"col-md-6\">\n                    <div class=\"input-group\">\n                        <input class=\"form-control\" id=\"auto2\" data-bind=\"attr: {id: id() + '-auto2' }, jqAuto: { autoFocus: true, html: true }, jqAutoSource: buffs.itemBuffs.itemBuffOptions, jqAutoValue: buffs.itemBuffs.selectedItemBuff, jqAutoSourceLabel: 'displayname', jqAutoSourceInputValue: 'name', jqAutoSourceValue: 'value'\" />\n                        <span class=\"input-group-btn\">\n                            <button class=\"btn btn-default\" data-bind=\"jqAutoCombo: id() + '-auto2'\"><span class=\"glyphicon glyphicon-search\"></span></button>\n                        </span>\n                    </div>\n                </div>\n                <div class=\"col-md-6\">\n                    <button class=\"btn btn-default\" data-bind=\"click: buffs.itemBuffs.addItemBuff\">Add</button>\n                </div>\n            </div>\n        </div>\n        <div data-bind=\"foreach: buffs.itemBuffs.items, visible: sectionDisplay().buff()\">\n            <div class=\"pull-left\" style=\"margin-right:10px\" data-bind=\"component: { name: 'item-buff', params: $data}\"></div>\n        </div>\n    </div>\n</div>\n\n<div class=\"row\">\n    <div class=\"col-md-12\">\n        <h3 class=\"section_header\" data-bind=\"toggle: sectionDisplay().debuff, css: { section_disabled: !sectionDisplay().debuff() }\">Debuffs</h3>\n        <div class=\"form-horizontal\" data-bind=\"visible: sectionDisplay().debuff()\">\n            <div class=\"form-group\">\n                <div class=\"col-md-6\">\n                    <select id=\"buffselect\" class=\"form-control\" data-bind=\"options: debuffs.availableDebuffs , optionsText: 'buffDisplayName', value: debuffs.selectedBuff\"></select>\n                </div>\n                <div class=\"col-md-6\">\n                    <button class=\"btn btn-default\" data-bind=\"click: debuffs.addBuff\">Add</button>\n                    <button class=\"btn btn-default\" data-bind=\"click: function(data,event) { debuffs.removeBuff(data, event, debuffs.selectedBuff().buffName) }\">Remove</button>\n                </div>\n            </div>\n        </div>\n\n        <div class=\"row\" data-bind=\"foreach: debuffs.buffs, visible: sectionDisplay().debuff()\">\n            <div data-bind=\"css: {row: $data.data.isDetail() || ($index() < $parent.debuffs.buffs().length-1 && $parent.debuffs.buffs()[$index()+1].data.isDetail()), row2: $data.data.isDetail() || ($index() < $parent.debuffs.buffs().length-1 && $parent.debuffs.buffs()[$index()+1].data.isDetail()) }\">\n                <div class=\"col-md-3 text-center bottom-buffer2\" data-bind=\"css: {'col-md-3': $root.layout() == 0, 'col-md-2': $root.layout() == 1}\">\n                    <img style=\"padding:0px;margin-bottom:1px;\" class=\"img-rounded ability\" data-bind=\"css: { ability_active: $data.data.isActive() || $data.data.behavior.indexOf('DOTA_ABILITY_BEHAVIOR_PASSIVE') != -1, ability_inactive: !$data.data.isActive() && $data.data.behavior.indexOf('DOTA_ABILITY_BEHAVIOR_PASSIVE') == -1, btn: $data.data.behavior.indexOf('DOTA_ABILITY_BEHAVIOR_PASSIVE') == -1, 'btn-default': $data.data.behavior.indexOf('DOTA_ABILITY_BEHAVIOR_PASSIVE') == -1}, attr:{src: '/media/images/spellicons/' + $data.data.name + '.png'}, click: function(data, event) { $parent.debuffs.toggleBuff($index, data.data, event); }, event: { dblclick: function(data,event) { $parent.debuffs.removeBuff(data, event, $data.data.name) } }\"/>\n                    <div class=\"progress\" style=\"position:relative\">\n                        <div style=\"position:absolute;width:100%;color:white;\" class=\"text-center\" data-bind=\"visible: $parent.getAbilityLevelMax($data.data) > 0, text: $data.data.level() + '/' + $parent.getAbilityLevelMax($data.data)\"></div>\n                        <div class=\"progress-bar progress-bar-danger\" role=\"progressbar\" aria-valuenow=\"60\" aria-valuemin=\"0\" aria-valuemax=\"100\" style=\"width: 60%;\" data-bind=\"attr: { 'aria-valuenow': ($parent.getAbilityLevelMax($data.data) > 0 ? $data.data.level()/$parent.getAbilityLevelMax($data.data)*100 : 0) }, style: { width: ($parent.getAbilityLevelMax($data.data) > 0 ? $data.data.level()/$parent.getAbilityLevelMax($data.data)*100 : 0) + '%' }\"></div>\n                    </div>\n                    <div class=\"btn-group btn-group-justified\" data-bind=\"if: $data.data.behavior.indexOf('DOTA_ABILITY_BEHAVIOR_NOT_LEARNABLE') == -1\">\n                        <a class=\"btn btn-default btn-sm\" data-bind=\"click: function(data, event) { $parent.debuffs.levelDownAbility($index, data.data, event, $parent); }\">-</a>\n                        <a class=\"btn btn-default btn-sm\" data-bind=\"click: function(data, event) { $parent.debuffs.levelUpAbility($index, data.data, event, $parent); }\">+</a>\n                    </div>\n                    <div class=\"btn-group btn-group-justified\">\n                        <a class=\"btn btn-default btn-sm\" data-bind=\"click: function(data, event) { $parent.debuffs.toggleBuffDetail($index, data, event); }, css: {'toggled': $data.data.isDetail}\">Details</a>\n                    </div>\n                </div>\n                <div class=\"col-md-9 bottom-buffer\" data-bind=\"visible: $data.data.isDetail()\">\n                    <button type=\"button\" class=\"close\" data-bind=\"click: function(data, event) { $parent.debuffs.toggleBuffDetail($index, data.data, event); }\">&times;</button>\n                    <div data-bind=\"html: $parent.ability().getAbilityTooltipData($data.hero, $data.data.name)\"></div>\n                    <div data-bind=\"if: $data.data.name in $parent.debuffs.abilityData && $parent.debuffs.buffs()[$index()].data.level() > 0\">\n                        <div class=\"col-md-8\">\n                            <div data-bind=\"component: { name: 'buff-settings', params: $parent.debuffs.abilitySettingsData($data.data.name, $parent, $index()) }\"></div>\n                        </div>\n                    </div>\n                </div>\n            </div>\n        </div>\n        \n        <div class=\"form-horizontal\" data-bind=\"visible: sectionDisplay().debuff()\">\n            <div class=\"form-group\">\n                <div class=\"col-md-6\">\n                    <div class=\"input-group\">\n                        <input class=\"form-control\" id=\"auto3\" data-bind=\"attr: {id: id() + '-auto3' }, jqAuto: { autoFocus: true, html: true }, jqAutoSource: debuffs.itemBuffs.itemDebuffOptions, jqAutoValue: debuffs.itemBuffs.selectedItemDebuff, jqAutoSourceLabel: 'displayname', jqAutoSourceInputValue: 'name', jqAutoSourceValue: 'value'\" />\n                        <span class=\"input-group-btn\">\n                            <button class=\"btn btn-default\" data-bind=\"jqAutoCombo: id() + '-auto3'\"><span class=\"glyphicon glyphicon-search\"></span></button>\n                        </span>\n                    </div>\n                </div>\n                <div class=\"col-md-6\">\n                    <button class=\"btn btn-default\" data-bind=\"click: debuffs.itemBuffs.addItemDebuff\">Add</button>\n                </div>\n            </div>\n        </div>\n        <div data-bind=\"foreach: debuffs.itemBuffs.items, visible: sectionDisplay().debuff()\">\n            <div class=\"pull-left\" style=\"margin-right:10px\" data-bind=\"component: { name: 'item-debuff', params: $data}\"></div>\n        </div>\n    </div>\n</div>" });
ko.components.register('damage-details', { template: "<div class=\"row\">\n    <div class=\"col-md-12\">\n        <h3 style=\"display:block;\" class=\"section_header\" data-bind=\"toggle: showDamageDetails, css: { section_disabled: !showDamageDetails() }\">Damage Details\n            <span class=\"pull-right\" data-bind=\"visible: showDamageDetails()\">\n                <small style=\"text-align:center\" data-bind=\"style: {color: getDamageTypeColor('physical')}\">Physical</small>\n                <small style=\"text-align:center\" data-bind=\"style: {color: getDamageTypeColor('magic')}\">Magical</small>\n                <small style=\"text-align:center\" data-bind=\"style: {color: getDamageTypeColor('pure')}\">Pure</small>\n            </span>\n        </h3>\n        <table class=\"table damage-details\" data-bind=\"visible: showDamageDetails()\">\n            <thead>\n                <tr class=\"damage-details-header-row\">\n                    <td></td>\n                    <td class=\"text-center\" colspan=\"2\"><strong>Attack Damage</strong><img src=\"img/reduc_icon.png\" class=\"pull-right\" data-bind=\"attr: {title: 'After reductions from ' + enemy().heroData().displayname}\"></td>\n                    <td class=\"text-center\" colspan=\"2\"><strong>DPS</strong><img src=\"img/reduc_icon.png\" class=\"pull-right\" data-bind=\"attr: {title: 'After reductions from ' + enemy().heroData().displayname}\"></td>\n                </tr>\n                <tr class=\"damage-details-header-row-2 total-row\">\n                    <td><strong>Total</strong></td>\n                    <td class=\"text-right\" data-bind=\"text: damageTotalInfo().totalRow[0]().toFixed(2)\"></td>\n                    <td class=\"text-right\" data-bind=\"text: damageTotalInfo().totalRow[1]().toFixed(2)\"></td>\n                    <td class=\"text-right\" data-bind=\"text: damageTotalInfo().totalRow[2]().toFixed(2)\"></td>\n                    <td class=\"text-right\" data-bind=\"text: damageTotalInfo().totalRow[3]().toFixed(2)\"></td>\n                </tr>\n            </thead>\n            <!-- ko foreach: damageTotalInfo().attacks -->\n            <tbody>\n                <tr class=\"indent subtotal-row\" data-bind=\"toggle: $data.enabled, css: { 'inactive': !$data.enabled() }\">\n                    <td>\n                        <button class=\"btn btn-default btn-xs glyphicon pull-left\" data-bind=\"toggle: $data.enabled, css: {'glyphicon-eye-open': $data.enabled(), 'glyphicon-eye-close': !$data.enabled()}, preventBubble: 'click'\"></button>\n                        <button class=\"btn btn-default btn-xs glyphicon pull-right\" data-bind=\"toggle: $data.visible, css: {'glyphicon-minus': $data.visible(), 'glyphicon-plus': !$data.visible()}, preventBubble: 'click'\"></button>\n                        <strong><span data-bind=\"text: $data.name\"></span></strong>\n                    </td>\n                    <td class=\"text-right\" data-bind=\"text: $data.totalRow[0]().toFixed(2)\"></td>\n                    <td class=\"text-right\" data-bind=\"text: $data.totalRow[1]().toFixed(2)\"></td>\n                    <td class=\"text-right\" data-bind=\"text: $data.totalRow[2]().toFixed(2)\"></td>\n                    <td class=\"text-right\" data-bind=\"text: $data.totalRow[3]().toFixed(2)\"></td>\n                </tr>\n            </tbody>\n            <tbody class=\"indent\" data-bind=\"foreach: $data.sources, visible: $data.visible\">\n                <tr data-bind=\"toggle: $data.enabled, css: { 'inactive': !$data.enabled() }\">\n                    <td class=\"indent\">\n                        <span data-bind=\"text: $data.name\"></span>\n                        <button class=\"btn btn-default btn-xs glyphicon pull-left\" data-bind=\"toggle: $data.enabled, css: {'glyphicon-eye-open': $data.enabled(), 'glyphicon-eye-close': !$data.enabled()}, preventBubble: 'click'\"></button>\n                    </td>\n                    <td class=\"text-right\"><span data-bind=\"html: $data.damage.toFixed(2), style: {color: $parents[1].getDamageTypeColor($data.damageType)}\"></span></td>\n                    <td class=\"text-right\"><span data-bind=\"html: $data.damageReduced.toFixed(2), style: {color: $parents[1].getDamageTypeColor($data.damageType)}\"></span></td>\n                    <td class=\"text-right\"><span data-bind=\"html: $data.dps.toFixed(2), style: {color: $parents[1].getDamageTypeColor($data.damageType)}\"></span></td>\n                    <td class=\"text-right\"><span data-bind=\"html: $data.dpsReduced.toFixed(2), style: {color: $parents[1].getDamageTypeColor($data.damageType)}\"></span></td>\n                </tr>\n            </tbody>\n            <tr class=\"indent crit\" data-bind=\"visible: $data.visible() && $data.sourcesCrit.length > 0\">\n                <td class=\"indent\">Critical Strike Proc, <span data-bind=\"text: ($data.totalCritChance * 100).toFixed(1) + '%'\"></span></td>\n                <td class=\"text-right\" data-bind=\"text: $data.totalCritRow[0]().toFixed(2)\"></td>\n                <td class=\"text-right\" data-bind=\"text: $data.totalCritRow[1]().toFixed(2)\"></td>\n                <td class=\"text-right\" data-bind=\"text: $data.totalCritRow[2]().toFixed(2)\"></td>\n                <td class=\"text-right\" data-bind=\"text: $data.totalCritRow[3]().toFixed(2)\"></td>\n            </tr>\n            <tbody class=\"indent\" data-bind=\"visible: $data.visible, foreach: $data.sourcesCrit\">\n                <tr class=\"indent crit\" data-bind=\"toggle: $data.enabled, css: { 'inactive': !$data.enabled() }\">\n                    <td class=\"indent\">\n                        <span data-bind=\"text: $data.name\"></span>\n                        <button class=\"btn btn-default btn-xs glyphicon pull-left\" data-bind=\"toggle: $data.enabled, css: {'glyphicon-eye-open': $data.enabled(), 'glyphicon-eye-close': !$data.enabled()}, preventBubble: 'click'\"></button>\n                    </td>\n                    <td class=\"text-right\"><span data-bind=\"html: $data.damage.toFixed(2)\"></span></td>\n                    <td class=\"text-right\"><span data-bind=\"html: $data.damageReduced.toFixed(2)\"></span></td>\n                    <td class=\"text-right\"><span data-bind=\"html: $data.dps.toFixed(2)\"></span></td>\n                    <td class=\"text-right\"><span data-bind=\"html: $data.dpsReduced.toFixed(2)\"></span></td>\n                </tr>\n            </tbody>\n            <!-- /ko -->\n            <tbody>\n                <tr data-bind=\"visible: cleaveInfo().length > 0\">\n                    <td colspan=3><strong>Cleave</strong></td>\n                </tr>\n            </tbody>    \n            <tbody data-bind=\"foreach: cleaveInfo()\">\n                <tr><td>Radius:</td><td class=\"text-right\"><span data-bind=\"html: $data.radius\"></span></td></tr>\n                <tr><td>Magnitude:</td><td class=\"text-right\"><span data-bind=\"html: ($data.magnitude * 100).toFixed(2) + '%'\"></span></td></tr>\n                <tr>\n                    <td>Cleave Damage:</td>\n                    <td class=\"text-right\"><span data-bind=\"html: ($data.magnitude * $parent.damageTotalInfo().total).toFixed(2)\"></span></td>\n                </tr>\n            </tbody>\n        \n        </table>\n    </div>\n</div>" });
ko.components.register('damage-amp', { template: "<div class=\"col-md-12\">\n    <h3 class=\"section_header\" data-bind=\"toggle: sectionDisplay().damageamp, css: { section_disabled: !sectionDisplay().damageamp() }\">Damage Amplification & Reduction</h3>\n    <div data-bind=\"visible: sectionDisplay().damageamp(), lazyBinding: sectionDisplay().damageamp\">\n        <div class=\"form-horizontal\">\n            <div class=\"form-group\">\n                    <div class=\"col-md-3 control-label\">\n                        <label for=\"damageinput\">Damage</label>\n                    </div>\n                    <div class=\"col-md-6\">\n                        <input class=\"form-control\" id=\"damageinput\" data-bind=\"value: damageInputValue\" />\n                    </div>\n            </div>\n        </div>\n        <div class=\"form-horizontal\">\n            <div class=\"form-group\">\n                    <div class=\"col-md-3 control-label\">\n                        <label for=\"buffampselect\">Amplification</label>\n                    </div>\n                    <div class=\"col-md-5\">\n                        <select id=\"buffampselect\" class=\"form-control\" data-bind=\"options: damageAmplification.availableBuffs , optionsText: 'buffDisplayName', value: damageAmplification.selectedBuff\"></select>\n                    </div>\n                    <div class=\"col-md-4\">\n                        <button class=\"btn btn-default\" data-bind=\"click: damageAmplification.addBuff\">Add</button>\n                        <button class=\"btn btn-default\" data-bind=\"click: function(data,event) { damageAmplification.removeBuff(data, event, damageAmplification.selectedBuff().buffName) }\">Remove</button>\n                    </div>\n            </div>\n        </div>\n        <div class=\"row\" data-bind=\"foreach: damageAmplification.buffs\">\n            <div data-bind=\"css: {row: $data.data.isDetail() || ($index() < $parent.damageAmplification.buffs().length-1 && $parent.damageAmplification.buffs()[$index()+1].data.isDetail()), row2: $data.data.isDetail() || ($index() < $parent.damageAmplification.buffs().length-1 && $parent.damageAmplification.buffs()[$index()+1].data.isDetail()) }\">\n                <div class=\"col-md-3 text-center bottom-buffer row2\" data-bind=\"css: {'col-md-3': $root.layout() == 0, 'col-md-2': $root.layout() == 1}\">\n                    <img style=\"padding:0px;margin-bottom:1px;\" class=\"img-rounded ability\" data-bind=\"css: { ability_active: $data.data.isActive() || $data.data.behavior.indexOf('DOTA_ABILITY_BEHAVIOR_PASSIVE') != -1, ability_inactive: !$data.data.isActive() && $data.data.behavior.indexOf('DOTA_ABILITY_BEHAVIOR_PASSIVE') == -1, btn: $data.data.behavior.indexOf('DOTA_ABILITY_BEHAVIOR_PASSIVE') == -1, 'btn-default': $data.data.behavior.indexOf('DOTA_ABILITY_BEHAVIOR_PASSIVE') == -1}, attr:{src: '/media/images/spellicons/' + $data.data.name + '.png'}, click: function(data, event) { $parent.damageAmplification.toggleBuff($index, data.data, event); }, event: { dblclick: function(data,event) { $parent.damageAmplification.removeBuff(data, event, $data.data.name) } }\"/>\n                    <div class=\"progress\" style=\"position:relative\">\n                        <div style=\"position:absolute;width:100%;color:white;\" class=\"text-center\" data-bind=\"visible: $parent.getAbilityLevelMax($data.data) > 0, text: $data.data.level() + '/' + $parent.getAbilityLevelMax($data.data)\"></div>\n                        <div class=\"progress-bar progress-bar-danger\" role=\"progressbar\" aria-valuenow=\"60\" aria-valuemin=\"0\" aria-valuemax=\"100\" style=\"width: 60%;\" data-bind=\"attr: { 'aria-valuenow': ($parent.getAbilityLevelMax($data.data) > 0 ? $data.data.level()/$parent.getAbilityLevelMax($data.data)*100 : 0) }, style: { width: ($parent.getAbilityLevelMax($data.data) > 0 ? $data.data.level()/$parent.getAbilityLevelMax($data.data)*100 : 0) + '%' }\"></div>\n                    </div>\n                    <div class=\"btn-group btn-group-justified\" data-bind=\"if: $data.data.behavior.indexOf('DOTA_ABILITY_BEHAVIOR_NOT_LEARNABLE') == -1\">\n                        <a class=\"btn btn-default btn-sm\" data-bind=\"click: function(data, event) { $parent.damageAmplification.levelDownAbility($index, data.data, event, $parent); }\">-</a>\n                        <a class=\"btn btn-default btn-sm\" data-bind=\"click: function(data, event) { $parent.damageAmplification.levelUpAbility($index, data.data, event, $parent); }\">+</a>\n                    </div>\n                    <div class=\"btn-group btn-group-justified\">\n                        <a class=\"btn btn-default btn-sm\" data-bind=\"click: function(data, event) { $parent.damageAmplification.toggleBuffDetail($index, data, event); }, css: {'toggled': $data.data.isDetail}\">Details</a>\n                    </div>\n                </div>\n                <div class=\"col-md-9 bottom-buffer\" data-bind=\"visible: $data.data.isDetail()\">\n                    <button type=\"button\" class=\"close\" data-bind=\"click: function(data, event) { $parent.damageAmplification.toggleBuffDetail($index, data.data, event); }\">&times;</button>\n                    <div data-bind=\"html: $parent.ability().getAbilityTooltipData($data.hero, $data.data.name)\"></div>\n                    <div data-bind=\"if: $data.data.name in $parent.damageAmplification.abilityData && $parent.damageAmplification.buffs()[$index()].data.level() > 0\">\n                        <div class=\"col-md-8\">\n                            <div data-bind=\"component: { name: 'buff-settings', params: $parent.damageAmplification.abilitySettingsData($data.data.name, $parent, $index()) }\"></div>\n                        </div>\n                    </div>\n                </div>\n            </div>\n        </div>\n        <div class=\"form-horizontal\">\n            <div class=\"form-group\">\n                    <div class=\"col-md-3 control-label\">\n                        <label for=\"buffreductionselect\">Reduction</label>\n                    </div>\n                    <div class=\"col-md-5\">\n                        <select id=\"buffreductionselect\" class=\"form-control\" data-bind=\"options: damageReduction.availableDebuffs , optionsText: 'buffDisplayName', value: damageReduction.selectedBuff\"></select>\n                    </div>\n                    <div class=\"col-md-4\">\n                        <button class=\"btn btn-default\" data-bind=\"click: damageReduction.addBuff\">Add</button>\n                        <button class=\"btn btn-default\" data-bind=\"click: function(data,event) { damageReduction.removeBuff(data, event, damageReduction.selectedBuff().buffName) }\">Remove</button>\n                    </div>\n            </div>\n        </div>\n        <div class=\"row\" data-bind=\"foreach: damageReduction.buffs\">\n            <div data-bind=\"css: {row: $data.data.isDetail() || ($index() < $parent.damageReduction.buffs().length-1 && $parent.damageReduction.buffs()[$index()+1].data.isDetail()), row2: $data.data.isDetail() || ($index() < $parent.damageReduction.buffs().length-1 && $parent.damageReduction.buffs()[$index()+1].data.isDetail()) }\">\n                <div class=\"col-md-3 text-center bottom-buffer row2\" data-bind=\"css: {'col-md-3': $root.layout() == 0, 'col-md-2': $root.layout() == 1}\">\n                    <img style=\"padding:0px;margin-bottom:1px;\" class=\"img-rounded ability\" data-bind=\"css: { ability_active: $data.data.isActive() || $data.data.behavior.indexOf('DOTA_ABILITY_BEHAVIOR_PASSIVE') != -1, ability_inactive: !$data.data.isActive() && $data.data.behavior.indexOf('DOTA_ABILITY_BEHAVIOR_PASSIVE') == -1, btn: $data.data.behavior.indexOf('DOTA_ABILITY_BEHAVIOR_PASSIVE') == -1, 'btn-default': $data.data.behavior.indexOf('DOTA_ABILITY_BEHAVIOR_PASSIVE') == -1}, attr:{src: '/media/images/spellicons/' + $data.data.name + '.png'}, click: function(data, event) { $parent.damageReduction.toggleBuff($index, data.data, event); }, event: { dblclick: function(data,event) { $parent.damageReduction.removeBuff(data, event, $data.data.name) } }\"/>\n                    <div class=\"progress\" style=\"position:relative\">\n                        <div style=\"position:absolute;width:100%;color:white;\" class=\"text-center\" data-bind=\"visible: $parent.getAbilityLevelMax($data.data) > 0, text: $data.data.level() + '/' + $parent.getAbilityLevelMax($data.data)\"></div>\n                        <div class=\"progress-bar progress-bar-danger\" role=\"progressbar\" aria-valuenow=\"60\" aria-valuemin=\"0\" aria-valuemax=\"100\" style=\"width: 60%;\" data-bind=\"attr: { 'aria-valuenow': ($parent.getAbilityLevelMax($data.data) > 0 ? $data.data.level()/$parent.getAbilityLevelMax($data.data)*100 : 0) }, style: { width: ($parent.getAbilityLevelMax($data.data) > 0 ? $data.data.level()/$parent.getAbilityLevelMax($data.data)*100 : 0) + '%' }\"></div>\n                    </div>\n                    <div class=\"btn-group btn-group-justified\" data-bind=\"if: $data.data.behavior.indexOf('DOTA_ABILITY_BEHAVIOR_NOT_LEARNABLE') == -1\">\n                        <a class=\"btn btn-default btn-sm\" data-bind=\"click: function(data, event) { $parent.damageReduction.levelDownAbility($index, data.data, event, $parent); }\">-</a>\n                        <a class=\"btn btn-default btn-sm\" data-bind=\"click: function(data, event) { $parent.damageReduction.levelUpAbility($index, data.data, event, $parent); }\">+</a>\n                    </div>\n                    <div class=\"btn-group btn-group-justified\">\n                        <a class=\"btn btn-default btn-sm\" data-bind=\"click: function(data, event) { $parent.damageReduction.toggleBuffDetail($index, data, event); }, css: {'toggled': $data.data.isDetail}\">Details</a>\n                    </div>\n                </div>\n                <div class=\"col-md-9 bottom-buffer\" data-bind=\"visible: $data.data.isDetail()\">\n                    <button type=\"button\" class=\"close\" data-bind=\"click: function(data, event) { $parent.damageReduction.toggleBuffDetail($index, data.data, event); }\">&times;</button>\n                    <div data-bind=\"html: $parent.ability().getAbilityTooltipData($data.hero, $data.data.name)\"></div>\n                    <div data-bind=\"if: $data.data.name in $parent.damageReduction.abilityData && $parent.damageReduction.buffs()[$index()].data.level() > 0\">\n                        <div class=\"col-md-8\">\n                            <div data-bind=\"component: { name: 'buff-settings', params: $parent.damageReduction.abilitySettingsData($data.data.name, $parent, $index()) }\"></div>\n                        </div>\n                    </div>\n                </div>\n            </div>\n        </div>\n        \n        <h4>Calculations <a class=\"btn btn-default btn-xs\" data-bind=\"toggle: showDamageAmpCalcDetails, text: !showDamageAmpCalcDetails() ? 'Show details' : 'Hide details'\"></a></h4>\n        <table class=\"table\">\n            <tbody>\n                <!-- ko foreach: damageInputModified().data -->\n                <tr data-bind=\"visible: $parent.showDamageAmpCalcDetails()\">\n                    <td><span style=\"text-decoration: underline;\" data-bind=\"text: $data.label + ' damage'\"></span></td>\n                    <td class=\"text-right\"><span data-bind=\"html: Math.round($data.value * 100) / 100, style: {color: $parent.getDamageTypeColor($data.damageType)}\"></span></td>\n                </tr>\n                    <!-- ko foreach: $data.data -->\n                    <tr data-bind=\"visible: $parents[1].showDamageAmpCalcDetails()\">\n                        <td><span data-bind=\"text: $data.label\"></span></td>\n                        <td class=\"text-right\"><span data-bind=\"html: Math.round($data.value * 100) / 100, diffStyle: $data.value\"></span></td>\n                    </tr>\n                    <!-- /ko -->\n                <tr data-bind=\"css: {subtotal: $parent.showDamageAmpCalcDetails()}\">\n                    <td data-bind=\"visible: $parent.showDamageAmpCalcDetails()\"><span data-bind=\"text: $data.label + ' damage subtotal'\"></span></td>\n                    <td data-bind=\"visible: !$parent.showDamageAmpCalcDetails()\"><span data-bind=\"text: $data.label + ' damage'\"></span></td>\n                    <td class=\"text-right\"><span data-bind=\"html: Math.round($data.total * 100) / 100, style: {color: $parent.getDamageTypeColor($data.damageType)}\"></span></td>\n                </tr>\n                <!-- /ko -->\n                <tr>\n                    <td><strong data-bind=\"text: damageInputModified().label + ' damage'\"></strong></td>\n                    <td class=\"text-right\"><strong data-bind=\"html: Math.round(damageInputModified().total * 100) / 100, style: {color: getDamageTypeColor(damageInputModified().damageType)}\"></strong></td>\n                </tr>\n            </tbody>\n        </table>\n    </div>\n</div>" });
ko.components.register('ability', { template: "<div data-bind=\"if: $data.displayname != 'Empty' &&  ($data.behavior.indexOf('DOTA_ABILITY_BEHAVIOR_HIDDEN') == -1 || $data.name.indexOf('invoker_') != -1),\nstyle: {clear: $data.name == 'invoker_cold_snap' || $data.name == 'invoker_chaos_meteor' ? 'both' : ''},\ncss: {row: $data.isDetail() || ($index() < $parents[1].ability().abilities().length-1 && $parents[1].ability().abilities()[$index()+1].isDetail()), row3: $data.isDetail() || ($index() < $parents[1].ability().abilities().length-1 && $parents[1].ability().abilities()[$index()+1].isDetail()) }\">\n    <div class=\"col-md-3 text-center bottom-buffer row2\" data-bind=\"css: {'col-md-3': $root.layout() == 0, 'col-md-2': $root.layout() == 1}\">\n        <img style=\"padding:0px;margin-bottom:1px;\" class=\"img-rounded ability\" data-bind=\"css: { ability_active: $data.isActive() || $data.behavior.indexOf('DOTA_ABILITY_BEHAVIOR_PASSIVE') != -1, ability_inactive: !$data.isActive() && $data.behavior.indexOf('DOTA_ABILITY_BEHAVIOR_PASSIVE') == -1, btn: $data.behavior.indexOf('DOTA_ABILITY_BEHAVIOR_PASSIVE') == -1, 'btn-default': $data.behavior.indexOf('DOTA_ABILITY_BEHAVIOR_PASSIVE') == -1}, attr:{src: '/media/images/spellicons/' + $data.name + '.png'}, click: function(data, event) { $parents[1].ability().toggleAbility($index, data, event); }\"/>\n        <div class=\"progress\" style=\"position:relative\">\n            <div style=\"position:absolute;width:100%;color:white;\" class=\"text-center\" data-bind=\"visible: $parents[1].getAbilityLevelMax($data) > 0, text: $data.level() + '/' + $parents[1].getAbilityLevelMax($data)\"></div>\n            <div class=\"progress-bar progress-bar-danger\" role=\"progressbar\" aria-valuenow=\"60\" aria-valuemin=\"0\" aria-valuemax=\"100\" style=\"width: 60%;\" data-bind=\"attr: { 'aria-valuenow': ($parents[1].getAbilityLevelMax($data) > 0 ? $data.level()/$parents[1].getAbilityLevelMax($data)*100 : 0) }, style: { width: ($parents[1].getAbilityLevelMax($data) > 0 ? $data.level()/$parents[1].getAbilityLevelMax($data)*100 : 0) + '%' }\"></div>\n        </div>\n        <div class=\"btn-group btn-group-justified\" data-bind=\"if: $data.behavior.indexOf('DOTA_ABILITY_BEHAVIOR_NOT_LEARNABLE') == -1\">\n            <a class=\"btn btn-default btn-sm\" data-bind=\"click: function(data, event) { $parents[1].ability().levelDownAbility($index, data, event, $parents[1]); }\">-</a>\n            <a class=\"btn btn-default btn-sm\" data-bind=\"click: function(data, event) { $parents[1].ability().levelUpAbility($index, data, event, $parents[1]); }\">+</a>\n        </div>\n        <div class=\"btn-group btn-group-justified\">\n            <a class=\"btn btn-default btn-sm\" data-bind=\"click: function(data, event) { $parents[1].ability().toggleAbilityDetail($index, data, event); }, css: {'toggled': $data.isDetail}\">Details</a>\n        </div>\n        <div class=\"btn-group btn-group-justified\" data-bind=\"if: $data.behavior.indexOf('DOTA_ABILITY_BEHAVIOR_NOT_LEARNABLE') != -1\">\n            <a class=\"btn btn-default btn-sm btn-block\" style=\"visibility:hidden;\">&mdash;</a>\n        </div>\n    </div>\n    <div class=\"col-md-9 bottom-buffer2\" data-bind=\"visible: $data.isDetail()\">\n        <button type=\"button\" class=\"close\" data-bind=\"click: function(data, event) { $parents[1].ability().toggleAbilityDetail($index, data, event); }\">&times;</button>\n        <div data-bind=\"html: $parents[1].ability().getAbilityTooltipData('npc_dota_hero_' + $parents[1].heroId(), $data.name)\"></div>\n        <div data-bind=\"if: $data.name in $parents[1].ability().abilityData && $parents[1].ability().abilities()[$index()].level() > 0\">\n            <div class=\"col-md-12\" style=\"margin-top: 10px\" >\n                <div data-bind=\"template: { name: 'ability-settings-template', data: $parents[1].ability().abilitySettingsData($data.name, $parents[1], $index()) }\"></div>\n            </div>\n        </div>\n    </div>\n</div>" });
ko.components.register('shop', require('../components/shop'));
ko.components.register('stat', { template: "<span data-bind=\"text: parseFloat(hero[stat]()).toString()\"></span><span data-bind=\"html: $root.getDiffText(hero.diff[stat]()), diffCss: hero.diff[stat], diffCssStat: stat, visible: hero.showDiff\"></span>" });
ko.components.register('stats0', { template: "<div class=\"col-md-12 stats0\" data-bind=\"css: {'col-md-12': $root.layout() == 0, 'col-md-3': $root.layout() == 1}\">\n    <table class=\"table table-condensed\">\n    <tbody>\n    <tr><td>Strength:</td><td class=\"text-right\" data-bind=\"component: { name: 'stat', params: {'hero': $data, 'stat': 'totalStr' } }\"></td></tr>\n    <tr><td>Agility:</td><td class=\"text-right\" data-bind=\"component: { name: 'stat', params: {'hero': $data, 'stat': 'totalAgi' } }\"></td></tr>\n    <tr><td>Intelligence:</td><td class=\"text-right\" data-bind=\"component: { name: 'stat', params: {'hero': $data, 'stat': 'totalInt' } }\"></td></tr>\n    <tr><td><abbr title=\"Movement Speed\">MS</abbr>:</td><td class=\"text-right\" data-bind=\"component: { name: 'stat', params: {'hero': $data, 'stat': 'totalMovementSpeed' } }\"></td></tr>\n    <tr><td>Turn Rate:</td><td class=\"text-right\" data-bind=\"component: { name: 'stat', params: {'hero': $data, 'stat': 'totalTurnRate' } }\"></td></tr>\n    <tr><td>Sight Range:</td><td class=\"text-right\"><span data-bind=\"html: '<abbr title=\\'Day\\'>' + visionrangeday() + '</abbr>/<abbr title=\\'Night\\'>' + visionrangenight() + '</abbr>'\"></span></td></tr>\n    </tbody>\n    </table>\n</div>" });
ko.components.register('stats1', { template: "<div class=\"col-md-12 stats1\" data-bind=\"css: {'col-md-12': $root.layout() == 0, 'col-md-3': $root.layout() == 1}\">\n    <table class=\"table table-condensed\">\n    <tbody>\n    <tr><td>Armor:</td><td class=\"text-right\" data-bind=\"component: { name: 'stat', params: {'hero': $data, 'stat': 'totalArmorPhysical' } }\"></td></tr>\n    <tr><td>Health:</td><td class=\"text-right\" data-bind=\"component: { name: 'stat', params: {'hero': $data, 'stat': 'health' } }\"></td></tr>\n    <tr><td>Health Regen:</td><td class=\"text-right\" data-bind=\"component: { name: 'stat', params: {'hero': $data, 'stat': 'healthregen' } }\"></td></tr>\n    <tr><td>Mana:</td><td class=\"text-right\" data-bind=\"component: { name: 'stat', params: {'hero': $data, 'stat': 'mana' } }\"></td></tr>\n    <tr><td>Mana Regen:</td><td class=\"text-right\" data-bind=\"component: { name: 'stat', params: {'hero': $data, 'stat': 'manaregen' } }\"></td></tr>\n    <tr><td>Physical <abbr title=\"Effective Hit Points\">EHP</abbr>:</td><td class=\"text-right\" data-bind=\"component: { name: 'stat', params: {'hero': $data, 'stat': 'ehpPhysical' } }\"></td></tr>\n    <tr><td>Magical <abbr title=\"Effective Hit Points\">EHP</abbr>:</td><td class=\"text-right\" data-bind=\"component: { name: 'stat', params: {'hero': $data, 'stat': 'ehpMagical' } }\"></td></tr>\n    </tbody>\n    </table>\n</div>" });
ko.components.register('stats2', { template: "<div class=\"col-md-12 stats2\" data-bind=\"css: {'col-md-12': $root.layout() == 0, 'col-md-3': $root.layout() == 1}\">\n    <table class=\"table table-condensed\">\n    <tbody>\n    <tr><td>%Phys Res:</td><td class=\"text-right\" data-bind=\"component: { name: 'stat', params: {'hero': $data, 'stat': 'totalArmorPhysicalReduction' } }\"></td></tr>\n    <tr><td>%Magic Res:</td><td class=\"text-right\" data-bind=\"component: { name: 'stat', params: {'hero': $data, 'stat': 'totalMagicResistance' } }\"></td></tr>\n    <tr><td>%Lifesteal:</td><td class=\"text-right\" data-bind=\"component: { name: 'stat', params: {'hero': $data, 'stat': 'lifesteal' } }\"></td></tr>\n    <tr><td>%Evasion:</td><td class=\"text-right\" data-bind=\"component: { name: 'stat', params: {'hero': $data, 'stat': 'evasion' } }\"></td></tr>\n    <tr><td>%Bash:</td><td class=\"text-right\" data-bind=\"component: { name: 'stat', params: {'hero': $data, 'stat': 'bash' } }\"></td></tr>\n    <tr><td>%Miss Chance:</td><td class=\"text-right\" data-bind=\"component: { name: 'stat', params: {'hero': $data, 'stat': 'missChance' } }\"></td></tr>\n    <tr style=\"display: none\"><td colspan=2><a class=\"btn btn-default btn-block btn-xs\" data-bind=\"css: {disabled: critInfo().sources.length == 0 ? 'disabled' : '', 'toggled': showCriticalStrikeDetails}, toggle: showCriticalStrikeDetails\">Critical Strike Details</a></td></tr>\n    </tbody>\n    <tbody class=\"tabledropdown\" style=\"border-top:0\" data-bind=\"visible: showCriticalStrikeDetails(),foreach: critInfo().sources\">\n    <tr><td colspan=2><strong data-bind=\"text: $data.name\"></strong></td></tr>\n    <tr><td>Crit Chance:</td><td class=\"text-right\"><span data-bind=\"text: ($data.totalchance * 100).toFixed(2) + '%'\"></span></td></tr>\n    <tr><td>Crit Multiplier:</td><td class=\"text-right\"><span data-bind=\"text: ($data.multiplier * 100).toFixed(2) + '%'\"></span></td></tr>\n    </tbody>\n    </table>\n</div>" });
ko.components.register('stats3', { template: "<div class=\"col-md-12 stats3\" data-bind=\"css: {'col-md-12': $root.layout() == 0, 'col-md-3': $root.layout() == 1}\">\n    <table class=\"table table-condensed\">\n    <tbody>\n    <tr>\n        <td>Damage:</td>\n        <td class=\"text-right\">\n            <span data-bind=\"html: baseDamage()[0].toFixed(0)\"></span>\n            <span data-bind=\"html: $root.getDiffText(diff['baseDamage']()[0]), css: {'diffPos': diff['baseDamage']()[0] > 0, 'diffNeg': diff['baseDamage']()[0] < 0}, visible: showDiff\"></span>\n            <span>&ndash;</span>\n            <span data-bind=\"html: baseDamage()[1].toFixed(0)\"></span>\n            <span data-bind=\"html: $root.getDiffText(diff['baseDamage']()[1]), css: {'diffPos': diff['baseDamage']()[1] > 0, 'diffNeg': diff['baseDamage']()[1] < 0}, visible: showDiff\"></span>\n            <span style=\"color:green\" data-bind=\"visible: bonusDamage() > 0, html: ' + ' + bonusDamage().toFixed(0)\"></span>\n            <span data-bind=\"html: $root.getDiffText(diff['bonusDamage']()), css: {'diffPos': diff['bonusDamage']() > 0, 'diffNeg': diff['bonusDamage']() < 0}, visible: showDiff\"></span>\n            <span style=\"color:red\" data-bind=\"visible: bonusDamageReduction() != 0, html: ' - ' + bonusDamageReduction().toFixed(0)\"></span>\n            <span data-bind=\"html: $root.getDiffText(diff['bonusDamageReduction']()), css: {'diffPos': diff['bonusDamageReduction']() > 0, 'diffNeg': diff['bonusDamageReduction']() < 0}, visible: showDiff\"></span>\n        </td>\n    </tr>\n    <tr><td><abbr title=\"Increased Attack Speed\">IAS</abbr>:</td><td class=\"text-right\" data-bind=\"component: { name: 'stat', params: {'hero': $data, 'stat': 'ias' } }\"></td></tr>\n    <tr><td><abbr title=\"Base Attack Time\">BAT</abbr>:</td><td class=\"text-right\" data-bind=\"component: { name: 'stat', params: {'hero': $data, 'stat': 'bat' } }\"></td></tr>\n    <tr><td>Attack Time:</td><td class=\"text-right\" data-bind=\"component: { name: 'stat', params: {'hero': $data, 'stat': 'attackTime' } }\"></td></tr>\n    <tr><td>Attack &frasl; Sec:</td><td class=\"text-right\" data-bind=\"component: { name: 'stat', params: {'hero': $data, 'stat': 'attacksPerSecond' } }\"></td></tr>\n    <tr><td>Attack Range:</td><td class=\"text-right\" data-bind=\"component: { name: 'stat', params: {'hero': $data, 'stat': 'totalattackrange' } }\"></td></tr>\n    </tbody>\n    </table>\n</div>" });
ko.components.register('stats-additional', { template: "<table class=\"table table-condensed\">\n    <tbody>\n        <tr><td>Base Strength:</td><td class=\"text-right\"><span data-bind=\"text: heroData().attributebasestrength\"></span></td></tr>\n        <tr><td>Strength Gain:</td><td class=\"text-right\"><span data-bind=\"text: heroData().attributestrengthgain\"></span></td></tr>\n        <tr><td>Base Agility:</td><td class=\"text-right\"><span data-bind=\"text: heroData().attributebaseagility\"></span></td></tr>\n        <tr><td>Agility Gain:</td><td class=\"text-right\"><span data-bind=\"text: heroData().attributeagilitygain\"></span></td></tr>\n        <tr><td>Base Intelligence:</td><td class=\"text-right\"><span data-bind=\"text: heroData().attributebaseintelligence\"></span></td></tr>\n        <tr><td>Intelligence Gain:</td><td class=\"text-right\"><span data-bind=\"text: heroData().attributeintelligencegain\"></span></td></tr>\n        <tr><td>Base Armor:</td><td class=\"text-right\"><span data-bind=\"text: heroData().armorphysical\"></span></td></tr>\n        <tr><td><abbr title=\"Base Armor + armor from base agility\">Starting Armor:</abbr></td><td class=\"text-right\"><span data-bind=\"text: parseFloat($data.startingArmor()).toString()\"></span></td></tr>\n        <tr><td>Base Magic Res:</td><td class=\"text-right\"><span data-bind=\"text: heroData().magicalresistance + '%'\"></span></td></tr>\n        <tr><td>Base Attack Point:</td><td class=\"text-right\"><span data-bind=\"text: heroData().attackpoint\"></span></td></tr>\n        <tr><td><abbr data-bind=\"attr: { title: 'Total experience required to reach level ' + $data.selectedHeroLevel() }\">Total Exp:</abbr></td><td class=\"text-right\"><span data-bind=\"text: $data.totalExp()\"></span></span></td></tr>\n        <tr><td><abbr title=\"Experience required for next level\">Next level exp:</abbr></td><td class=\"text-right\"><span data-bind=\"html: $data.nextLevelExp()\"></span></span></td></tr>\n        <tr><td>Respawn Time:</td><td class=\"text-right\"><span data-bind=\"text: $data.respawnTime()\"></span></td></tr>\n    </tbody>\n</table>" });

// The app extends the herocalc library, provides a frontend
var my = require("../herocalc/main");
var getItemTooltipData = require("../herocalc/herocalc_tooltips_item");
var getAbilityTooltipData = require("../herocalc/herocalc_tooltips_ability");
my.prototype.AbilityModel.prototype.getAbilityTooltipData = function (hero, el) {
    return getAbilityTooltipData(my.prototype.heroData, my.prototype.unitData, hero, el);
}
//require("./herocalc_tooltips");
require("./heroviewmodel");

my.prototype.PlayerColors = [
    "#2E6AE6", //Blue
    "#5DE6AD", //Teal
    "#AD00AD", //Purple
    "#DCD90A", //Yellow
    "#E66200", //Orange
    "#E67AB0", //Pink
    "#92A440", //Pus Yellow
    "#5CC5E0", //Light Blue
    "#00771F", //Green
    "#956000" //Brown
];

my.prototype.Tab = function (id, href, data, text, color, template) {
    var self = this;
    self.id = id;
    self.href = href;
    self.color = color;
    self.data = data;
    self.data.id = ko.observable(self.href);
    self.text = text;
    self.template = template;
    return self;
}
my.prototype.Tab.prototype.toJS = function () {
    return {
        id: this.id,
        href: this.href,
        color: this.color,
        text: this.text,
        template: this.template
    }
}

my.prototype.TabGroup = function (hero, unit, clone) {
    var self = this;
    self.hero = hero;
    self.unit = unit;
    self.clone = clone;
    self.illusions = ko.observableArray([]);
    return self;
}
my.prototype.TabGroup.prototype.toJS = function () {
    return {
        hero: this.hero.toJS(),
        unit: this.unit.toJS(),
        clone: this.clone.toJS(),
        illusions: this.illusions().map(function (illusion) { return illusion.toJS(); })
    }
}

my.prototype.HeroCalculatorViewModel = function () {
    var self = this;
    self.heroes = [];

    for (var i = 0; i < 10; i++) {
        self.heroes.push(new my.prototype.HeroCalculatorModel(i));
    }
    
    for (var i = 0; i < 5; i++) {
        var arr = [];
        for (var j = 5; j < 10; j++) {
            arr.push(self.heroes[j]);
        }
        self.heroes[i].enemies.push.apply(self.heroes[i].enemies, arr);
    }
    for (var i = 5; i < 10; i++) {
        var arr = [];
        for (var j = 0; j < 5; j++) {
            arr.push(self.heroes[j]);
        }
        self.heroes[i].enemies.push.apply(self.heroes[i].enemies, arr);
    }
    for (var i = 0; i < 10; i++) {
        var arr = [];
        for (var j = 0; j < 10; j++) {
            if (i !== j) arr.push(self.heroes[j]);
        }
        self.heroes[i].otherHeroes.push.apply(self.heroes[i].otherHeroes, arr);
    }
    
    for (var i = 0; i < 10; i++) {
        self.heroes[i].clone = ko.observable(new my.prototype.CloneViewModel('meepo', self.heroes[i]));
        self.heroes[i].unit = ko.observable(new my.prototype.UnitViewModel('abaddon', self.heroes[i]));
        
        self.heroes[i].selectedCompare(self.heroes[i].availableCompare()[i < 5 ? 4 + i : i - 5]);
        self.heroes[i].selectedEnemy(self.heroes[i].availableEnemies()[i % 5]);
        //self.heroes[i].enemy = ko.observable(self.heroes[i < 2 ? 2 : 0]);
        self.heroes[i].unit().enemy(self.heroes[i].enemy());
        //self.heroes[i].unit().enemy = ko.observable(self.heroes[i < 2 ? 2 : 0]);
        //self.heroes[i].heroCompare = ko.observable(self.heroes[1 - (i % 2) + (i < 2 ? 0 : 2)]);
        
        self.heroes[i].unit().selectedUnit(self.heroes[i].unit().availableUnits()[0]);
        //self.heroes[i].selectedHero(self.heroes[i].availableHeroes()[i < 2 ? 0 : 2]);
        self.heroes[i].illusions.subscribe(function (changes) {
            for (var i = 0; i < changes.length; i++) {
                if (changes[i].status == 'added') {
                    var color = this.index < 2 ? '#5cb85c' : '#d9534f',
                        j = my.prototype.uniqueId();
                    self.tabs()[this.index].illusions.push(
                        new my.prototype.Tab(
                            'illusionTab' + this.index + '-' + j,
                            'illusionPane' + this.index + '-' + j,
                            self.heroes[this.index].illusions()[self.tabs()[this.index].illusions().length](),
                            'Illusion ' + j,
                            color,
                            'illusion-pane')
                    );
                }
            }
        }, {vm: this, index: i}, "arrayChange");
    }
    //self.heroes[0].showUnitTab(true);
    self.heroes[0].bound(true);
    self.tabs = ko.observableArray([]);
    var tabsArr = [];
    for (var i = 0; i < 10; i++) {
        //var color = i < 5 ? '#5cb85c' : '#d9534f';
        var color = my.prototype.PlayerColors[i];
        var tabGroup = new my.prototype.TabGroup(
            new my.prototype.Tab('heroTab' + i, 'heroPane' + i, self.heroes[i], 'Hero ' + i, color, 'hero-pane'),
            new my.prototype.Tab('unitTab' + i, 'unitPane' + i, self.heroes[i].unit(), 'Unit ' + i, color, 'unit-pane'),
            new my.prototype.Tab('cloneTab' + i, 'clonePane' + i, self.heroes[i].clone(), 'Meepo Clone ' + i, color, 'clone-pane')
        );
        //self.tabs.push(tabGroup);
        tabsArr.push(tabGroup);
    }
    self.tabs.push.apply(self.tabs, tabsArr);//.slice(0, 1));

    self.selectedItem = ko.observable();
    self.layout = ko.observable("1");
    self.displayShop = ko.observable(true);
    self.displayShopItemTooltip = ko.observable(true);
    self.allItems = ko.observableArray([
        {name: 'Str, Agi, Int, MS, Turn, Sight', value: 'stats0'},
        {name: 'Armor, Health, Mana, Regen, EHP', value: 'stats1'},
        {name: 'Phys Res, Magic Res, Lifesteal, Evasion, Bash, Miss', value: 'stats2'},
        {name: 'Damage, IAS, BAT, Attack', value: 'stats3'}
    ]); // Initial items
    self.selectedItems = ko.observableArray([]); 
    self.moveUp = function () {
        var start = self.allItems.indexOf(self.selectedItems()[0]),
            end = self.allItems.indexOf(self.selectedItems()[self.selectedItems().length - 1]);
        if (start > 0) {
            var e = self.allItems.splice(start - 1, 1);
            self.allItems.splice(end, 0, e[0]);            
        }
    };
    self.moveDown = function () {
        var start = self.allItems.indexOf(self.selectedItems()[0]),
            end = self.allItems.indexOf(self.selectedItems()[self.selectedItems().length - 1]);        
        if (end < self.allItems().length - 1) {
            var e = self.allItems.splice(end + 1, 1);
            self.allItems.splice(start, 0, e[0]);
        }
    };
    self.selectedTabId = ko.observable('heroTab0');
    self.getSelectedTab = function (tabId) {
        var indices = tabId.replace('heroTab', '').replace('cloneTab', '').replace('unitTab', '').replace('illusionTab', '').split('-'),
            index = indices[0],
            tab = self.tabs()[index];
        return tab;
    }
    self.selectedTab = ko.computed(function () {
        /*var indices = self.selectedTabId().replace('heroTab', '').replace('cloneTab', '').replace('unitTab', '').replace('illusionTab', '').split('-'),
            index = indices[0],
            tab = self.tabs()[index];*/
        var tab = self.getSelectedTab(self.selectedTabId());
        if (self.selectedTabId().indexOf('hero') != -1) {
            return tab.hero;
        }
        else if (self.selectedTabId().indexOf('unit') != -1) {
            return tab.unit;
        }
        else if (self.selectedTabId().indexOf('clone') != -1) {
            return tab.clone;
        }
        else if (self.selectedTabId().indexOf('illusion') != -1) {
            return tab.illusions().find(function (tab) {
                return tab.id == self.selectedTabId();
            });
        }
        else {
            return self.tabs()[0].hero;
        }
    });
    self.selectedTabs = ko.observableArray(['heroTab0', 'heroTab1']);
    //self.selectedTabs.push('heroTab0');
    //self.selectedTabs.push('heroTab1');
    self.boundSettings = ko.observable(false);
    self.clickTab = function (data, event, index) {
        /*if (event.target.id != 'settingsTab') {
            self.selectedTabId(event.target.id);
        }*/
        self.selectedTabId(event.target.id);
        if (self.selectedTabs()[1] != event.target.id) {
            self.selectedTabs.shift();
            self.selectedTabs.push(event.target.id);
        }
        if (self.selectedTab().data.hasOwnProperty('bound')) {
            self.selectedTab().data.bound(true);

            // make sure build explorer graph renders
            setTimeout(function () {
                self.selectedTab().data.buildExplorer.graphData.valueHasMutated();
            }, 0);
        }
        if (event.target.id === 'settingsTab') self.boundSettings(true);
    };
    self.isSecondTab = function (id) {
        return self.selectedTabs().indexOf(id) > -1 && self.selectedTabId() != id;
    }
    
    self.showSideTabId = function (id) {
        return self.selectedTabs().indexOf(id) > -1 && self.sideView();
    };
    
    self.removeTab = function (index, data, event, tab) {
        if (data.id == self.selectedTabId()) {
            //self.selectedTabId('heroTab0');
            self.clickTab(null, {target: {id: 'heroTab0'}});
            $('#heroTab0').tab('show');
        }
        self.tabs()[tab].illusions.remove(function (illusion) {
            return illusion == data;
        });
        self.heroes[tab].illusions.remove(function (illusion) {
            return illusion() == data.data;
        });
    };
    
    self.sideView = ko.observable(false);
    self.sideView.subscribe(function (newValue) {
        if (newValue) {
            if (!self.shopPopout()) {
                self.displayShop(false);
            }
            for (var i = 0; i < self.selectedTabs().length; i++) {
                var tab = self.getSelectedTab(self.selectedTabs()[i]);
                if (tab && tab.hero.data.hasOwnProperty('bound')) {
                    tab.hero.data.bound(true);
                }
            }
            self.layout("0");
        }
    });
    var $window = $(window);
    self.windowWidth = ko.observable($window.width());
    self.windowHeight = ko.observable($window.height());
    $window.resize(function () { 
        self.windowWidth($window.width());
        self.windowHeight($window.height());
    });
    self.shopDock = ko.observable(false);
    self.shopDock.subscribe(function (newValue) {
        if (newValue) {
            self.shopPopout(false);
        }
        else {
        }
    });

    self.shopDockTrigger = ko.computed(function () {
        self.windowWidth();
        self.shopDock();
    });
    self.shopPopout = ko.observable(false);
    self.shopPopout.subscribe(function (newValue) {
        if (newValue) {
            self.displayShop(true);
            $( "#shop-dialog" ).dialog({
                minWidth: 380,
                minHeight: 0,
                closeText: "",
                open: function ( event, ui ) {
                    $(event.target.offsetParent).find('.ui-dialog-titlebar').find('button')
                        .addClass('close glyphicon glyphicon-remove shop-button btn btn-default btn-xs pull-right')
                        .removeClass('ui-button ui-widget ui-state-default ui-corner-all ui-button-icon-only ui-dialog-titlebar-close close')
                        .css('margin-right','0px')
                        .parent()
                            .append($('#shop-minimize'))
                            .append($('#shop-maximize'));
                    $(event.target.offsetParent).find('.ui-dialog-titlebar').dblclick(function () {
                        self.displayShop(!self.displayShop());
                    });
                },
                close: function ( event, ui ) {
                    self.shopPopout(false);
                }
            });
        }
        else {
            $('#shop-container').prepend($('#shop-minimize')).prepend($('#shop-maximize'));
            $( "#shop-dialog" ).dialog("destroy");
        }
    });

    self.addItem = function (data, event) {
        self.selectedTab().data.buildExplorer.getSelectedInventory().addItem(data, event);
    }
    self.itemOptions = ko.computed(function () {
        return self.selectedTab().data.inventory.itemOptions();
    });
    
    self.changeSelectedItem = function (data, event) {
        self.itemInputValue(1);
        self.selectedItem(event.target.id);
    }
    
    self.getItemTooltipData = ko.computed(function () {
        return getItemTooltipData(my.prototype.itemData, self.selectedItem());
    }, this);
    self.getItemInputLabel = ko.computed(function () {
        if (my.prototype.stackableItems.indexOf(self.selectedItem()) != -1) {
            return 'Stack Size'
        }
        else if (my.prototype.levelitems.indexOf(self.selectedItem()) != -1) {
            return 'Upgrade Level'
        }
        else if (self.selectedItem() == 'bloodstone') {
            return 'Charges'
        }
        else {
            return ''
        }
    }, this);
    self.itemInputValue = ko.observable(1);
    self.saveLink = ko.observable();
    self.getAppState = function () {
        var data = {
            selectedItem: self.selectedItem,
            layout: self.layout,
            displayShop: self.displayShop,
            displayShopItemTooltip: self.displayShopItemTooltip,
            allItems: self.allItems,
            selectedItems: self.selectedItems,
            selectedTabId: self.selectedTabId,
            selectedTabs: self.selectedTabs,
            boundSettings: self.boundSettings,
            sideView: self.sideView,
            windowWidth: self.windowWidth,
            windowHeight: self.windowHeight,
            shopDock: self.shopDock,
            shopPopout: self.shopPopout,
            itemInputValue: self.itemInputValue,
            saveLink: self.saveLink
        }
        data.tabs = self.tabs().map(function (tab) { return tab.toJS() });
        return ko.toJS(data);
    }
    self.getSaveData = function () {
        var data = {
            version: "1.3.0",
            heroes: []
        }
        for (var i = 0; i < 10; i++) {
            var hero = self.heroes[i];
            var d = {
                hero: hero.selectedHero().heroName,
                level: hero.selectedHeroLevel(),
                items: [],
                abilities: [],
                skillPointHistory: hero.skillPointHistory(),
                buffs: [],
                itemBuffs: [],
                debuffs: [],
                itemDebuffs: [],
                graphData: [],
                enemyIndex: hero.enemy().index(),
                heroCompareIndex: hero.heroCompare().index()
            }
            // items
            for (var j = 0; j < hero.inventory.items().length; j++) {
                d.items.push(ko.toJS(hero.inventory.items()[j]));
            }
            // abilities
            for (var j = 0; j < hero.ability().abilities().length; j++) {
                d.abilities().push({
                    level: hero.ability().abilities()[j].level(),
                    isActive: hero.ability().abilities()[j].isActive()
                });
            }
            // buffs
            for (var j = 0; j < hero.buffs.buffs().length; j++) {
                d.buffs.push({
                    name: hero.buffs.buffs()[j].name,
                    level: hero.buffs.buffs()[j].data.level(),
                    isActive: hero.buffs.buffs()[j].data.isActive()
                });
            }
            
            // debuffs
            for (var j = 0; j < hero.debuffs.buffs().length; j++) {
                d.debuffs.push({
                    name: hero.debuffs.buffs()[j].name,
                    level: hero.debuffs.buffs()[j].data.level(),
                    isActive: hero.debuffs.buffs()[j].data.isActive()
                });
            }

            // item buffs
            for (var j = 0; j < hero.buffs.itemBuffs.items().length; j++) {
                d.itemBuffs.push(ko.toJS(hero.buffs.itemBuffs.items()[j]));
            }
            
            // item debuffs
            for (var j = 0; j < hero.debuffs.itemBuffs.items().length; j++) {
                d.itemDebuffs.push(ko.toJS(hero.debuffs.itemBuffs.items()[j]));
            }
            
            // graph data
            d.graphData = ko.toJS(hero.buildExplorer.graphData);
            
            data.heroes.push(d);
        }
        return data;
    }
    self.save = function () {
        var data = self.getSaveData();
        var serialized = JSON.stringify(data);
        $.ajax({
            type: "POST",
            url: "save.php",
            data: {'data': serialized},
            dataType: "json",
            success: function (data){
                self.saveLink([location.protocol, '//', location.host, location.pathname].join('') + '?id=' + data.file);
            },
            failure: function (errMsg) {
                alert("Save request failed.");
            }
        });
    }
    self.load = function (data) {
        for (var i = 0; i < data.heroes.length; i++) {
            var hero = self.heroes[i];
            hero.selectedHero(my.prototype.findWhere(hero.availableHeroes(), {'heroName': data.heroes[i].hero}));
            hero.selectedHeroLevel(data.heroes[i].level);
            hero.inventory.items.removeAll();
            hero.inventory.activeItems.removeAll();
            
            // load hero compare
            if (data.heroes[i].hasOwnProperty('heroCompareIndex')) {
                var o = hero.availableCompare().filter(function (option) {
                    return option.hero.index() == data.heroes[i].heroCompareIndex;
                });
                if (o.length) {
                    hero.selectedCompare(o[0]);
                    hero.heroCompare(o[0].hero);
                }
            }
            
            // load enemy
            if (data.heroes[i].hasOwnProperty('enemyIndex')) {
                var o = hero.availableEnemies().filter(function (option) {
                    return option.hero.index() == data.heroes[i].enemyIndex;
                });
                if (o.length) {
                    hero.selectedEnemy(o[0]);
                    hero.enemy(o[0].hero);
                }
            }
            
            // load items
            for (var j = 0; j < data.heroes[i].items.length; j++) {
                var item = data.heroes[i].items[j];
                var new_item = {
                    item: item.item,
                    state: ko.observable(item.state),
                    size: item.size,
                    enabled: ko.observable(item.enabled)
                }
                hero.inventory.items.push(new_item);
            }

            // load abilities
            for (var j = 0; j < data.heroes[i].abilities().length; j++) {
                hero.ability().abilities()[j].level(data.heroes[i].abilities()[j].level);
                hero.ability().abilities()[j].isActive(data.heroes[i].abilities()[j].isActive);
            }
            hero.skillPointHistory(data.heroes[i].skillPointHistory);

            // load buffs
            for (var j = 0; j < data.heroes[i].buffs.length; j++) {
                hero.buffs.selectedBuff(my.prototype.findWhere(hero.buffs.availableBuffs(), {buffName: data.heroes[i].buffs[j].name}));
                hero.buffs.addBuff(hero, {});
                var b = my.prototype.findWhere(hero.buffs.buffs(), { name: data.heroes[i].buffs[j].name });
                b.data.level(data.heroes[i].buffs[j].level);
                b.data.isActive(data.heroes[i].buffs[j].isActive);
            }

            // load debuffs
            for (var j = 0; j < data.heroes[i].debuffs.length; j++) {
                hero.debuffs.selectedBuff(my.prototype.findWhere(hero.debuffs.availableDebuffs(), {buffName: data.heroes[i].debuffs[j].name}));
                hero.debuffs.addBuff(hero, {});
                var b = my.prototype.findWhere(hero.debuffs.buffs(), { name: data.heroes[i].debuffs[j].name });
                b.data.level(data.heroes[i].debuffs[j].level);
                b.data.isActive(data.heroes[i].debuffs[j].isActive);
            }

            // load item buffs
            if (data.heroes[i].itemBuffs) {
                for (var j = 0; j < data.heroes[i].itemBuffs.length; j++) {
                    var item = data.heroes[i].itemBuffs[j];
                    var new_item = {
                        item: item.item,
                        state: ko.observable(item.state),
                        size: item.size,
                        enabled: ko.observable(item.enabled)
                    }
                    hero.buffs.itemBuffs.items.push(new_item);
                }
            }

            // load item debuffs
            if (data.heroes[i].itemDebuffs) {
                for (var j = 0; j < data.heroes[i].itemDebuffs.length; j++) {
                    var item = data.heroes[i].itemDebuffs[j];
                    var new_item = {
                        item: item.item,
                        state: ko.observable(item.state),
                        size: item.size,
                        enabled: ko.observable(item.enabled)
                    }
                    hero.debuffs.itemBuffs.items.push(new_item);
                }
            }
            
            // load graph data
            if (data.heroes[i].graphData) {
                hero.buildExplorer.loadGraphData(data.heroes[i].graphData);
            }
        }
    }
    
    self.sendReport = function () {
        if ($('#BugReportFormText').val()) {
            $.post( "report.php", { name: $('#BugReportFormName').val(), email: $('#BugReportFormEmail').val(), body: $('#BugReportFormText').val() })
            .done(function (data) {
                if (data == 'Success') {
                    alert('Report successfully sent. Thanks!');
                    $('#BugReportFormText').val('');
                }
                else {
                    alert('Failed to send report. Try again later or email admin@devilesk.com');
                }
            });
            $('#myModal').modal('hide');
        }
        else {
            alert('Message is required.');
        }
    }
    
    self.getProperty = function (obj, properties) {
        var result = obj;
        for (var i = 0; i < properties.length; i++) {
            result = result[properties[i]];
        }
        return result;
    };
    
    self.getDiffTextWrapper = function (hero, property) {
        return self.getDiffText(self.getDiffMagnitude(hero, property));
    }
    
    self.getDiffMagnitude = function (hero, property) {
        var properties = property.split('.');
        return self.getProperty(hero.damageTotalInfo(), properties).toFixed(2) - self.getProperty(hero.heroCompare().damageTotalInfo(), properties).toFixed(2);
    }
    
    self.getDiffText = function (value) {
        if (value > 0) {
            return '+' + parseFloat(value.toFixed(2));
        }
        else if (value < 0) {
            return '&minus;' + parseFloat(value.toFixed(2)*-1).toString();
        }
        else {
            return '';
        }
    }
    self.highlightedTabInternal = ko.observable('');
    self.highlightedTab = ko.computed(function () {
        return self.highlightedTabInternal();
    }).extend({ throttle: 100 });
    self.highlightTab = function (data) {
        self.highlightedTabInternal(data);
    }
    self.unhighlightTab = function (data) {
        self.highlightedTabInternal('');
    }
}

my.prototype.theme = ko.observable('dark'); //ko.observable($('#theme-select').val());
my.prototype.heroCalculator = {};

my.prototype.run = function () {
    my.prototype.heroCalculator = new my.prototype.HeroCalculatorViewModel();
    ko.applyBindings(my.prototype.heroCalculator);
    /*$('#theme-select').change(function () {
        my.prototype.theme($(this).val());
    });*/
    $('#spinner').hide();
    $('.initial-hidden').css('display', 'inline-block');
    $('#popHero0').addClass('active');
    $('#heroPane0').addClass('active');
    $('[data-toggle="tooltip"]').tooltip();
    var saveId = my.prototype.getParameterByName('id');
    if (saveId) {
        $.get('save/' + saveId + '.json', function (data) {
            my.prototype.heroCalculator.load(data);
        });
    }
}

my.prototype.inventoryClipBoard = {
    items: [],
    activeItems: []
};

my.prototype.getParameterByName = function (name) {
    name = name.replace(/[\[]/, "\\[").replace(/[\]]/, "\\]");
    var regex = new RegExp("[\\?&]" + name + "=([^&#]*)"),
        results = regex.exec(location.search);
    return results == null ? "" : decodeURIComponent(results[1].replace(/\+/g, " "));
}

module.exports = my;
}).call(this,typeof global !== "undefined" ? global : typeof self !== "undefined" ? self : typeof window !== "undefined" ? window : {})

},{"../components/shop":43,"../herocalc/herocalc_tooltips_ability":54,"../herocalc/herocalc_tooltips_item":55,"../herocalc/main":57,"../lib/Chart.min":59,"../lib/Chart.scatter":60,"./herocalc_knockout":39,"./heroviewmodel":40,"./jquery-ui.custom":41,"bootstrap":1}],43:[function(require,module,exports){
function ViewModel(params) {
    var self = this;
    self.windowWidth = params.windowWidth;
    self.windowHeight = params.windowHeight;
    self.displayShop = params.displayShop;
    self.displayShopItemTooltip = params.displayShopItemTooltip;
    self.shopDock = params.shopDock;
    self.shopDockTrigger = params.shopDockTrigger;
    self.shopPopout = params.shopPopout;
    self.selectedItem = params.selectedItem;
    self.addItem = params.addItem;
    self.changeSelectedItem = params.changeSelectedItem;
    self.getItemTooltipData = params.getItemTooltipData;
    self.getItemInputLabel = params.getItemInputLabel;
    self.itemInputValue = params.itemInputValue;
    self.itemOptions = params.itemOptions;
}

module.exports = {
    viewModel: ViewModel,
    template: "        <div id=\"shop-container\" class=\"col-md-12 col-lg-4\" data-bind=\"shopDockStyle: shopDockTrigger, visible: displayShop() || shopPopout(), css: {'col-lg-4': !shopPopout()}, style: { 'padding-top': shopPopout() ? '5px' : '0px'}\">\n              <button id=\"shop-minimize\" class=\"btn btn-default btn-xs shop-button glyphicon glyphicon-minus pull-right\" data-bind=\"toggle: displayShop, visible: displayShop()\" title=\"Minimize shop\"></button>\n              <button id=\"shop-maximize\" class=\"btn btn-default btn-xs shop-button glyphicon glyphicon-plus pull-right\" data-bind=\"toggle: displayShop, visible: !displayShop()\" title=\"Maximize shop\"></button>\n              <button class=\"btn btn-default btn-xs shop-button glyphicon glyphicon-new-window pull-right hidden-xs\" data-bind=\"click: shopPopout, visible: !shopPopout()\" title=\"Popout shop\"></button>\n              <button class=\"btn btn-default btn-xs shop-button glyphicon glyphicon-align-right pull-right hidden-xs\" data-bind=\"toggle: shopDock, attr: { title: shopDock() ? 'Undock shop to right side of screen' : 'Dock shop to right side of screen' }\" ></button>\n            <ul id=\"shoptabs\" class=\"nav nav-tabs\" data-bind=\"visible: displayShop()\">\n              <li><a href=\"#shop_basic\" data-toggle=\"tab\">Basic</a></li>\n              <li><a href=\"#shop_upgrade\" data-toggle=\"tab\">Upgrade</a></li>\n              <li><a href=\"#shop_secret\" data-toggle=\"tab\">Secret</a></li>\n            </ul>\n            <div class=\"tab-content text-center bottom-buffer2\" data-bind=\"visible: displayShop()\">\n                <div class=\"tab-pane active\" id=\"shop_basic\">\n<div class=\"shop-column\">\n  <div class=\"hc-shop hc-shop-consumables\" id=\"consumables\"></div>\n  <div class=\"img-rounded hc-item hc-item-clarity\" id=\"clarity\" data-bind=\"click: changeSelectedItem, event: { dblclick: addItem }\"></div>\n  <div class=\"img-rounded hc-item hc-item-faerie_fire\" id=\"faerie_fire\" data-bind=\"click: changeSelectedItem, event: { dblclick: addItem }\"></div>\n  <div class=\"img-rounded hc-item hc-item-enchanted_mango\" id=\"enchanted_mango\" data-bind=\"click: changeSelectedItem, event: { dblclick: addItem }\"></div>\n  <div class=\"img-rounded hc-item hc-item-tango\" id=\"tango\" data-bind=\"click: changeSelectedItem, event: { dblclick: addItem }\"></div>\n  <div class=\"img-rounded hc-item hc-item-flask\" id=\"flask\" data-bind=\"click: changeSelectedItem, event: { dblclick: addItem }\"></div>\n  <div class=\"img-rounded hc-item hc-item-smoke_of_deceit\" id=\"smoke_of_deceit\" data-bind=\"click: changeSelectedItem, event: { dblclick: addItem }\"></div>\n  <div class=\"img-rounded hc-item hc-item-tpscroll\" id=\"tpscroll\" data-bind=\"click: changeSelectedItem, event: { dblclick: addItem }\"></div>\n  <div class=\"img-rounded hc-item hc-item-dust\" id=\"dust\" data-bind=\"click: changeSelectedItem, event: { dblclick: addItem }\"></div>\n  <div class=\"img-rounded hc-item hc-item-courier\" id=\"courier\" data-bind=\"click: changeSelectedItem, event: { dblclick: addItem }\"></div>\n  <div class=\"img-rounded hc-item hc-item-flying_courier\" id=\"flying_courier\" data-bind=\"click: changeSelectedItem, event: { dblclick: addItem }\"></div>\n  <div class=\"img-rounded hc-item hc-item-ward_observer\" id=\"ward_observer\" data-bind=\"click: changeSelectedItem, event: { dblclick: addItem }\"></div>\n  <div class=\"img-rounded hc-item hc-item-ward_sentry\" id=\"ward_sentry\" data-bind=\"click: changeSelectedItem, event: { dblclick: addItem }\"></div>\n  <div class=\"img-rounded hc-item hc-item-tome_of_knowledge\" id=\"tome_of_knowledge\" data-bind=\"click: changeSelectedItem, event: { dblclick: addItem }\"></div>\n  <div class=\"img-rounded hc-item hc-item-bottle\" id=\"bottle\" data-bind=\"click: changeSelectedItem, event: { dblclick: addItem }\"></div>\n</div>\n<div class=\"shop-column\">\n  <div class=\"hc-shop hc-shop-attributes\" id=\"attributes\"></div>\n  <div class=\"img-rounded hc-item hc-item-branches\" id=\"branches\" data-bind=\"click: changeSelectedItem, event: { dblclick: addItem }\"></div>\n  <div class=\"img-rounded hc-item hc-item-gauntlets\" id=\"gauntlets\" data-bind=\"click: changeSelectedItem, event: { dblclick: addItem }\"></div>\n  <div class=\"img-rounded hc-item hc-item-slippers\" id=\"slippers\" data-bind=\"click: changeSelectedItem, event: { dblclick: addItem }\"></div>\n  <div class=\"img-rounded hc-item hc-item-mantle\" id=\"mantle\" data-bind=\"click: changeSelectedItem, event: { dblclick: addItem }\"></div>\n  <div class=\"img-rounded hc-item hc-item-circlet\" id=\"circlet\" data-bind=\"click: changeSelectedItem, event: { dblclick: addItem }\"></div>\n  <div class=\"img-rounded hc-item hc-item-belt_of_strength\" id=\"belt_of_strength\" data-bind=\"click: changeSelectedItem, event: { dblclick: addItem }\"></div>\n  <div class=\"img-rounded hc-item hc-item-boots_of_elves\" id=\"boots_of_elves\" data-bind=\"click: changeSelectedItem, event: { dblclick: addItem }\"></div>\n  <div class=\"img-rounded hc-item hc-item-robe\" id=\"robe\" data-bind=\"click: changeSelectedItem, event: { dblclick: addItem }\"></div>\n  <div class=\"img-rounded hc-item hc-item-ogre_axe\" id=\"ogre_axe\" data-bind=\"click: changeSelectedItem, event: { dblclick: addItem }\"></div>\n  <div class=\"img-rounded hc-item hc-item-blade_of_alacrity\" id=\"blade_of_alacrity\" data-bind=\"click: changeSelectedItem, event: { dblclick: addItem }\"></div>\n  <div class=\"img-rounded hc-item hc-item-staff_of_wizardry\" id=\"staff_of_wizardry\" data-bind=\"click: changeSelectedItem, event: { dblclick: addItem }\"></div>\n  <div class=\"img-rounded hc-item hc-item-emptyitembg\" id=\"emptyitembg\"></div>\n  <div class=\"img-rounded hc-item hc-item-emptyitembg\" id=\"emptyitembg\"></div>\n  <div class=\"img-rounded hc-item hc-item-emptyitembg\" id=\"emptyitembg\"></div>\n</div>\n<div class=\"shop-column\">\n  <div class=\"hc-shop hc-shop-armaments\" id=\"armaments\"></div>\n  <div class=\"img-rounded hc-item hc-item-ring_of_protection\" id=\"ring_of_protection\" data-bind=\"click: changeSelectedItem, event: { dblclick: addItem }\"></div>\n  <div class=\"img-rounded hc-item hc-item-stout_shield\" id=\"stout_shield\" data-bind=\"click: changeSelectedItem, event: { dblclick: addItem }\"></div>\n  <div class=\"img-rounded hc-item hc-item-quelling_blade\" id=\"quelling_blade\" data-bind=\"click: changeSelectedItem, event: { dblclick: addItem }\"></div>\n  <div class=\"img-rounded hc-item hc-item-infused_raindrop\" id=\"infused_raindrop\" data-bind=\"click: changeSelectedItem, event: { dblclick: addItem }\"></div>\n  <div class=\"img-rounded hc-item hc-item-blight_stone\" id=\"blight_stone\" data-bind=\"click: changeSelectedItem, event: { dblclick: addItem }\"></div>\n  <div class=\"img-rounded hc-item hc-item-orb_of_venom\" id=\"orb_of_venom\" data-bind=\"click: changeSelectedItem, event: { dblclick: addItem }\"></div>\n  <div class=\"img-rounded hc-item hc-item-blades_of_attack\" id=\"blades_of_attack\" data-bind=\"click: changeSelectedItem, event: { dblclick: addItem }\"></div>\n  <div class=\"img-rounded hc-item hc-item-chainmail\" id=\"chainmail\" data-bind=\"click: changeSelectedItem, event: { dblclick: addItem }\"></div>\n  <div class=\"img-rounded hc-item hc-item-quarterstaff\" id=\"quarterstaff\" data-bind=\"click: changeSelectedItem, event: { dblclick: addItem }\"></div>\n  <div class=\"img-rounded hc-item hc-item-helm_of_iron_will\" id=\"helm_of_iron_will\" data-bind=\"click: changeSelectedItem, event: { dblclick: addItem }\"></div>\n  <div class=\"img-rounded hc-item hc-item-broadsword\" id=\"broadsword\" data-bind=\"click: changeSelectedItem, event: { dblclick: addItem }\"></div>\n  <div class=\"img-rounded hc-item hc-item-claymore\" id=\"claymore\" data-bind=\"click: changeSelectedItem, event: { dblclick: addItem }\"></div>\n  <div class=\"img-rounded hc-item hc-item-javelin\" id=\"javelin\" data-bind=\"click: changeSelectedItem, event: { dblclick: addItem }\"></div>\n  <div class=\"img-rounded hc-item hc-item-mithril_hammer\" id=\"mithril_hammer\" data-bind=\"click: changeSelectedItem, event: { dblclick: addItem }\"></div>\n</div>\n<div class=\"shop-column\">\n  <div class=\"hc-shop hc-shop-arcane\" id=\"arcane\"></div>\n  <div class=\"img-rounded hc-item hc-item-wind_lace\" id=\"wind_lace\" data-bind=\"click: changeSelectedItem, event: { dblclick: addItem }\"></div>\n  <div class=\"img-rounded hc-item hc-item-magic_stick\" id=\"magic_stick\" data-bind=\"click: changeSelectedItem, event: { dblclick: addItem }\"></div>\n  <div class=\"img-rounded hc-item hc-item-sobi_mask\" id=\"sobi_mask\" data-bind=\"click: changeSelectedItem, event: { dblclick: addItem }\"></div>\n  <div class=\"img-rounded hc-item hc-item-ring_of_regen\" id=\"ring_of_regen\" data-bind=\"click: changeSelectedItem, event: { dblclick: addItem }\"></div>\n  <div class=\"img-rounded hc-item hc-item-boots\" id=\"boots\" data-bind=\"click: changeSelectedItem, event: { dblclick: addItem }\"></div>\n  <div class=\"img-rounded hc-item hc-item-gloves\" id=\"gloves\" data-bind=\"click: changeSelectedItem, event: { dblclick: addItem }\"></div>\n  <div class=\"img-rounded hc-item hc-item-cloak\" id=\"cloak\" data-bind=\"click: changeSelectedItem, event: { dblclick: addItem }\"></div>\n  <div class=\"img-rounded hc-item hc-item-ring_of_health\" id=\"ring_of_health\" data-bind=\"click: changeSelectedItem, event: { dblclick: addItem }\"></div>\n  <div class=\"img-rounded hc-item hc-item-void_stone\" id=\"void_stone\" data-bind=\"click: changeSelectedItem, event: { dblclick: addItem }\"></div>\n  <div class=\"img-rounded hc-item hc-item-gem\" id=\"gem\" data-bind=\"click: changeSelectedItem, event: { dblclick: addItem }\"></div>\n  <div class=\"img-rounded hc-item hc-item-lifesteal\" id=\"lifesteal\" data-bind=\"click: changeSelectedItem, event: { dblclick: addItem }\"></div>\n  <div class=\"img-rounded hc-item hc-item-shadow_amulet\" id=\"shadow_amulet\" data-bind=\"click: changeSelectedItem, event: { dblclick: addItem }\"></div>\n  <div class=\"img-rounded hc-item hc-item-ghost\" id=\"ghost\" data-bind=\"click: changeSelectedItem, event: { dblclick: addItem }\"></div>\n  <div class=\"img-rounded hc-item hc-item-blink\" id=\"blink\" data-bind=\"click: changeSelectedItem, event: { dblclick: addItem }\"></div>\n</div>\n\n\n                </div>\n                <div class=\"tab-pane\" id=\"shop_upgrade\">\n<div class=\"shop-column\">\n  <div class=\"hc-shop hc-shop-common\" id=\"common\"></div>\n  <div class=\"img-rounded hc-item hc-item-magic_wand\" id=\"magic_wand\" data-bind=\"click: changeSelectedItem, event: { dblclick: addItem }\"></div>\n  <div class=\"img-rounded hc-item hc-item-null_talisman\" id=\"null_talisman\" data-bind=\"click: changeSelectedItem, event: { dblclick: addItem }\"></div>\n  <div class=\"img-rounded hc-item hc-item-wraith_band\" id=\"wraith_band\" data-bind=\"click: changeSelectedItem, event: { dblclick: addItem }\"></div>\n  <div class=\"img-rounded hc-item hc-item-poor_mans_shield\" id=\"poor_mans_shield\" data-bind=\"click: changeSelectedItem, event: { dblclick: addItem }\"></div>\n  <div class=\"img-rounded hc-item hc-item-bracer\" id=\"bracer\" data-bind=\"click: changeSelectedItem, event: { dblclick: addItem }\"></div>\n  <div class=\"img-rounded hc-item hc-item-soul_ring\" id=\"soul_ring\" data-bind=\"click: changeSelectedItem, event: { dblclick: addItem }\"></div>\n  <div class=\"img-rounded hc-item hc-item-phase_boots\" id=\"phase_boots\" data-bind=\"click: changeSelectedItem, event: { dblclick: addItem }\"></div>\n  <div class=\"img-rounded hc-item hc-item-power_treads\" id=\"power_treads\" data-bind=\"click: changeSelectedItem, event: { dblclick: addItem }\"></div>\n  <div class=\"img-rounded hc-item hc-item-oblivion_staff\" id=\"oblivion_staff\" data-bind=\"click: changeSelectedItem, event: { dblclick: addItem }\"></div>\n  <div class=\"img-rounded hc-item hc-item-pers\" id=\"pers\" data-bind=\"click: changeSelectedItem, event: { dblclick: addItem }\"></div>\n  <div class=\"img-rounded hc-item hc-item-hand_of_midas\" id=\"hand_of_midas\" data-bind=\"click: changeSelectedItem, event: { dblclick: addItem }\"></div>\n  <div class=\"img-rounded hc-item hc-item-travel_boots\" id=\"travel_boots\" data-bind=\"click: changeSelectedItem, event: { dblclick: addItem }\"></div>\n  <div class=\"img-rounded hc-item hc-item-moon_shard\" id=\"moon_shard\" data-bind=\"click: changeSelectedItem, event: { dblclick: addItem }\"></div>\n  <div class=\"img-rounded hc-item hc-item-emptyitembg\" id=\"emptyitembg\"></div>\n</div>\n<div class=\"shop-column\">\n  <div class=\"hc-shop hc-shop-support\" id=\"support\"></div>\n  <div class=\"img-rounded hc-item hc-item-ring_of_basilius\" id=\"ring_of_basilius\" data-bind=\"click: changeSelectedItem, event: { dblclick: addItem }\"></div>\n  <div class=\"img-rounded hc-item hc-item-iron_talon\" id=\"iron_talon\" data-bind=\"click: changeSelectedItem, event: { dblclick: addItem }\"></div>\n  <div class=\"img-rounded hc-item hc-item-headdress\" id=\"headdress\" data-bind=\"click: changeSelectedItem, event: { dblclick: addItem }\"></div>\n  <div class=\"img-rounded hc-item hc-item-buckler\" id=\"buckler\" data-bind=\"click: changeSelectedItem, event: { dblclick: addItem }\"></div>\n  <div class=\"img-rounded hc-item hc-item-urn_of_shadows\" id=\"urn_of_shadows\" data-bind=\"click: changeSelectedItem, event: { dblclick: addItem }\"></div>\n  <div class=\"img-rounded hc-item hc-item-tranquil_boots\" id=\"tranquil_boots\" data-bind=\"click: changeSelectedItem, event: { dblclick: addItem }\"></div>\n  <div class=\"img-rounded hc-item hc-item-ring_of_aquila\" id=\"ring_of_aquila\" data-bind=\"click: changeSelectedItem, event: { dblclick: addItem }\"></div>\n  <div class=\"img-rounded hc-item hc-item-medallion_of_courage\" id=\"medallion_of_courage\" data-bind=\"click: changeSelectedItem, event: { dblclick: addItem }\"></div>\n  <div class=\"img-rounded hc-item hc-item-arcane_boots\" id=\"arcane_boots\" data-bind=\"click: changeSelectedItem, event: { dblclick: addItem }\"></div>\n  <div class=\"img-rounded hc-item hc-item-ancient_janggo\" id=\"ancient_janggo\" data-bind=\"click: changeSelectedItem, event: { dblclick: addItem }\"></div>\n  <div class=\"img-rounded hc-item hc-item-mekansm\" id=\"mekansm\" data-bind=\"click: changeSelectedItem, event: { dblclick: addItem }\"></div>\n  <div class=\"img-rounded hc-item hc-item-vladmir\" id=\"vladmir\" data-bind=\"click: changeSelectedItem, event: { dblclick: addItem }\"></div>\n  <div class=\"img-rounded hc-item hc-item-pipe\" id=\"pipe\" data-bind=\"click: changeSelectedItem, event: { dblclick: addItem }\"></div>\n  <div class=\"img-rounded hc-item hc-item-guardian_greaves\" id=\"guardian_greaves\" data-bind=\"click: changeSelectedItem, event: { dblclick: addItem }\"></div>\n</div>\n<div class=\"shop-column\">\n  <div class=\"hc-shop hc-shop-caster\" id=\"caster\"></div>\n  <div class=\"img-rounded hc-item hc-item-glimmer_cape\" id=\"glimmer_cape\" data-bind=\"click: changeSelectedItem, event: { dblclick: addItem }\"></div>\n  <div class=\"img-rounded hc-item hc-item-force_staff\" id=\"force_staff\" data-bind=\"click: changeSelectedItem, event: { dblclick: addItem }\"></div>\n  <div class=\"img-rounded hc-item hc-item-veil_of_discord\" id=\"veil_of_discord\" data-bind=\"click: changeSelectedItem, event: { dblclick: addItem }\"></div>\n  <div class=\"img-rounded hc-item hc-item-aether_lens\" id=\"aether_lens\" data-bind=\"click: changeSelectedItem, event: { dblclick: addItem }\"></div>\n  <div class=\"img-rounded hc-item hc-item-necronomicon\" id=\"necronomicon\" data-bind=\"click: changeSelectedItem, event: { dblclick: addItem }\"></div>\n  <div class=\"img-rounded hc-item hc-item-dagon\" id=\"dagon\" data-bind=\"click: changeSelectedItem, event: { dblclick: addItem }\"></div>\n  <div class=\"img-rounded hc-item hc-item-cyclone\" id=\"cyclone\" data-bind=\"click: changeSelectedItem, event: { dblclick: addItem }\"></div>\n  <div class=\"img-rounded hc-item hc-item-solar_crest\" id=\"solar_crest\" data-bind=\"click: changeSelectedItem, event: { dblclick: addItem }\"></div>\n  <div class=\"img-rounded hc-item hc-item-rod_of_atos\" id=\"rod_of_atos\" data-bind=\"click: changeSelectedItem, event: { dblclick: addItem }\"></div>\n  <div class=\"img-rounded hc-item hc-item-orchid\" id=\"orchid\" data-bind=\"click: changeSelectedItem, event: { dblclick: addItem }\"></div>\n  <div class=\"img-rounded hc-item hc-item-ultimate_scepter\" id=\"ultimate_scepter\" data-bind=\"click: changeSelectedItem, event: { dblclick: addItem }\"></div>\n  <div class=\"img-rounded hc-item hc-item-refresher\" id=\"refresher\" data-bind=\"click: changeSelectedItem, event: { dblclick: addItem }\"></div>\n  <div class=\"img-rounded hc-item hc-item-sheepstick\" id=\"sheepstick\" data-bind=\"click: changeSelectedItem, event: { dblclick: addItem }\"></div>\n  <div class=\"img-rounded hc-item hc-item-octarine_core\" id=\"octarine_core\" data-bind=\"click: changeSelectedItem, event: { dblclick: addItem }\"></div>\n</div>\n<div class=\"shop-column\">\n  <div class=\"hc-shop hc-shop-weapons\" id=\"weapons\"></div>\n  <div class=\"img-rounded hc-item hc-item-lesser_crit\" id=\"lesser_crit\" data-bind=\"click: changeSelectedItem, event: { dblclick: addItem }\"></div>\n  <div class=\"img-rounded hc-item hc-item-armlet\" id=\"armlet\" data-bind=\"click: changeSelectedItem, event: { dblclick: addItem }\"></div>\n  <div class=\"img-rounded hc-item hc-item-invis_sword\" id=\"invis_sword\" data-bind=\"click: changeSelectedItem, event: { dblclick: addItem }\"></div>\n  <div class=\"img-rounded hc-item hc-item-basher\" id=\"basher\" data-bind=\"click: changeSelectedItem, event: { dblclick: addItem }\"></div>\n  <div class=\"img-rounded hc-item hc-item-bfury\" id=\"bfury\" data-bind=\"click: changeSelectedItem, event: { dblclick: addItem }\"></div>\n  <div class=\"img-rounded hc-item hc-item-ethereal_blade\" id=\"ethereal_blade\" data-bind=\"click: changeSelectedItem, event: { dblclick: addItem }\"></div>\n  <div class=\"img-rounded hc-item hc-item-silver_edge\" id=\"silver_edge\" data-bind=\"click: changeSelectedItem, event: { dblclick: addItem }\"></div>\n  <div class=\"img-rounded hc-item hc-item-radiance\" id=\"radiance\" data-bind=\"click: changeSelectedItem, event: { dblclick: addItem }\"></div>\n  <div class=\"img-rounded hc-item hc-item-monkey_king_bar\" id=\"monkey_king_bar\" data-bind=\"click: changeSelectedItem, event: { dblclick: addItem }\"></div>\n  <div class=\"img-rounded hc-item hc-item-greater_crit\" id=\"greater_crit\" data-bind=\"click: changeSelectedItem, event: { dblclick: addItem }\"></div>\n  <div class=\"img-rounded hc-item hc-item-butterfly\" id=\"butterfly\" data-bind=\"click: changeSelectedItem, event: { dblclick: addItem }\"></div>\n  <div class=\"img-rounded hc-item hc-item-rapier\" id=\"rapier\" data-bind=\"click: changeSelectedItem, event: { dblclick: addItem }\"></div>\n  <div class=\"img-rounded hc-item hc-item-abyssal_blade\" id=\"abyssal_blade\" data-bind=\"click: changeSelectedItem, event: { dblclick: addItem }\"></div>\n  <div class=\"img-rounded hc-item hc-item-bloodthorn\" id=\"bloodthorn\" data-bind=\"click: changeSelectedItem, event: { dblclick: addItem }\"></div>\n</div>\n<div class=\"shop-column\">\n  <div class=\"hc-shop hc-shop-armor\" id=\"armor\"></div>\n  <div class=\"img-rounded hc-item hc-item-hood_of_defiance\" id=\"hood_of_defiance\" data-bind=\"click: changeSelectedItem, event: { dblclick: addItem }\"></div>\n  <div class=\"img-rounded hc-item hc-item-vanguard\" id=\"vanguard\" data-bind=\"click: changeSelectedItem, event: { dblclick: addItem }\"></div>\n  <div class=\"img-rounded hc-item hc-item-blade_mail\" id=\"blade_mail\" data-bind=\"click: changeSelectedItem, event: { dblclick: addItem }\"></div>\n  <div class=\"img-rounded hc-item hc-item-soul_booster\" id=\"soul_booster\" data-bind=\"click: changeSelectedItem, event: { dblclick: addItem }\"></div>\n  <div class=\"img-rounded hc-item hc-item-crimson_guard\" id=\"crimson_guard\" data-bind=\"click: changeSelectedItem, event: { dblclick: addItem }\"></div>\n  <div class=\"img-rounded hc-item hc-item-black_king_bar\" id=\"black_king_bar\" data-bind=\"click: changeSelectedItem, event: { dblclick: addItem }\"></div>\n  <div class=\"img-rounded hc-item hc-item-lotus_orb\" id=\"lotus_orb\" data-bind=\"click: changeSelectedItem, event: { dblclick: addItem }\"></div>\n  <div class=\"img-rounded hc-item hc-item-shivas_guard\" id=\"shivas_guard\" data-bind=\"click: changeSelectedItem, event: { dblclick: addItem }\"></div>\n  <div class=\"img-rounded hc-item hc-item-bloodstone\" id=\"bloodstone\" data-bind=\"click: changeSelectedItem, event: { dblclick: addItem }\"></div>\n  <div class=\"img-rounded hc-item hc-item-manta\" id=\"manta\" data-bind=\"click: changeSelectedItem, event: { dblclick: addItem }\"></div>\n  <div class=\"img-rounded hc-item hc-item-sphere\" id=\"sphere\" data-bind=\"click: changeSelectedItem, event: { dblclick: addItem }\"></div>\n  <div class=\"img-rounded hc-item hc-item-hurricane_pike\" id=\"hurricane_pike\" data-bind=\"click: changeSelectedItem, event: { dblclick: addItem }\"></div>\n  <div class=\"img-rounded hc-item hc-item-assault\" id=\"assault\" data-bind=\"click: changeSelectedItem, event: { dblclick: addItem }\"></div>\n  <div class=\"img-rounded hc-item hc-item-heart\" id=\"heart\" data-bind=\"click: changeSelectedItem, event: { dblclick: addItem }\"></div>\n</div>\n<div class=\"shop-column\">\n  <div class=\"hc-shop hc-shop-artifacts\" id=\"artifacts\"></div>\n  <div class=\"img-rounded hc-item hc-item-mask_of_madness\" id=\"mask_of_madness\" data-bind=\"click: changeSelectedItem, event: { dblclick: addItem }\"></div>\n  <div class=\"img-rounded hc-item hc-item-helm_of_the_dominator\" id=\"helm_of_the_dominator\" data-bind=\"click: changeSelectedItem, event: { dblclick: addItem }\"></div>\n  <div class=\"img-rounded hc-item hc-item-dragon_lance\" id=\"dragon_lance\" data-bind=\"click: changeSelectedItem, event: { dblclick: addItem }\"></div>\n  <div class=\"img-rounded hc-item hc-item-sange\" id=\"sange\" data-bind=\"click: changeSelectedItem, event: { dblclick: addItem }\"></div>\n  <div class=\"img-rounded hc-item hc-item-yasha\" id=\"yasha\" data-bind=\"click: changeSelectedItem, event: { dblclick: addItem }\"></div>\n  <div class=\"img-rounded hc-item hc-item-echo_sabre\" id=\"echo_sabre\" data-bind=\"click: changeSelectedItem, event: { dblclick: addItem }\"></div>\n  <div class=\"img-rounded hc-item hc-item-maelstrom\" id=\"maelstrom\" data-bind=\"click: changeSelectedItem, event: { dblclick: addItem }\"></div>\n  <div class=\"img-rounded hc-item hc-item-diffusal_blade\" id=\"diffusal_blade\" data-bind=\"click: changeSelectedItem, event: { dblclick: addItem }\"></div>\n  <div class=\"img-rounded hc-item hc-item-desolator\" id=\"desolator\" data-bind=\"click: changeSelectedItem, event: { dblclick: addItem }\"></div>\n  <div class=\"img-rounded hc-item hc-item-heavens_halberd\" id=\"heavens_halberd\" data-bind=\"click: changeSelectedItem, event: { dblclick: addItem }\"></div>\n  <div class=\"img-rounded hc-item hc-item-sange_and_yasha\" id=\"sange_and_yasha\" data-bind=\"click: changeSelectedItem, event: { dblclick: addItem }\"></div>\n  <div class=\"img-rounded hc-item hc-item-skadi\" id=\"skadi\" data-bind=\"click: changeSelectedItem, event: { dblclick: addItem }\"></div>\n  <div class=\"img-rounded hc-item hc-item-mjollnir\" id=\"mjollnir\" data-bind=\"click: changeSelectedItem, event: { dblclick: addItem }\"></div>\n  <div class=\"img-rounded hc-item hc-item-satanic\" id=\"satanic\" data-bind=\"click: changeSelectedItem, event: { dblclick: addItem }\"></div>\n</div>\n                </div>\n                <div class=\"tab-pane\" id=\"shop_secret\">\n<div class=\"shop-column\">\n  <div class=\"hc-shop hc-shop-secret\" id=\"secret\"></div>\n  <div class=\"img-rounded hc-item hc-item-energy_booster\" id=\"energy_booster\" data-bind=\"click: changeSelectedItem, event: { dblclick: addItem }\"></div>\n  <div class=\"img-rounded hc-item hc-item-vitality_booster\" id=\"vitality_booster\" data-bind=\"click: changeSelectedItem, event: { dblclick: addItem }\"></div>\n  <div class=\"img-rounded hc-item hc-item-point_booster\" id=\"point_booster\" data-bind=\"click: changeSelectedItem, event: { dblclick: addItem }\"></div>\n  <div class=\"img-rounded hc-item hc-item-platemail\" id=\"platemail\" data-bind=\"click: changeSelectedItem, event: { dblclick: addItem }\"></div>\n  <div class=\"img-rounded hc-item hc-item-talisman_of_evasion\" id=\"talisman_of_evasion\" data-bind=\"click: changeSelectedItem, event: { dblclick: addItem }\"></div>\n  <div class=\"img-rounded hc-item hc-item-hyperstone\" id=\"hyperstone\" data-bind=\"click: changeSelectedItem, event: { dblclick: addItem }\"></div>\n  <div class=\"img-rounded hc-item hc-item-ultimate_orb\" id=\"ultimate_orb\" data-bind=\"click: changeSelectedItem, event: { dblclick: addItem }\"></div>\n  <div class=\"img-rounded hc-item hc-item-demon_edge\" id=\"demon_edge\" data-bind=\"click: changeSelectedItem, event: { dblclick: addItem }\"></div>\n  <div class=\"img-rounded hc-item hc-item-mystic_staff\" id=\"mystic_staff\" data-bind=\"click: changeSelectedItem, event: { dblclick: addItem }\"></div>\n  <div class=\"img-rounded hc-item hc-item-eagle\" id=\"eagle\" data-bind=\"click: changeSelectedItem, event: { dblclick: addItem }\"></div>\n  <div class=\"img-rounded hc-item hc-item-reaver\" id=\"reaver\" data-bind=\"click: changeSelectedItem, event: { dblclick: addItem }\"></div>\n  <div class=\"img-rounded hc-item hc-item-relic\" id=\"relic\" data-bind=\"click: changeSelectedItem, event: { dblclick: addItem }\"></div>\n</div>\n                </div>\n            </div>\n\n            <div class=\"form-group\" data-bind=\"visible: displayShop()\">\n                <div class=\"input-group\">\n                    <input class=\"form-control\" id=\"auto\" data-bind=\"jqAuto: { autoFocus: true, html: true }, jqAutoSource: itemOptions, jqAutoValue: selectedItem, jqAutoSourceLabel: 'displayname', jqAutoSourceInputValue: 'name', jqAutoSourceValue: 'value'\" />\n                    <span class=\"input-group-btn\">\n                        <button class=\"btn btn-default\" data-bind=\"jqAutoCombo: 'auto'\"><span class=\"glyphicon glyphicon-search\"></span></button>\n                    </span>\n                </div>\n            </div>\n\n            <div data-bind=\"visible: selectedItem() && displayShop()\">\n                <button class=\"btn btn-default btn-xs glyphicon glyphicon-minus pull-right\" data-bind=\"toggle: displayShopItemTooltip, visible: displayShopItemTooltip()\" title=\"Hide item description\"></button>\n                <button class=\"btn btn-default btn-xs glyphicon glyphicon-plus pull-right\" data-bind=\"toggle: displayShopItemTooltip, visible: !displayShopItemTooltip()\" title=\"Show item description\"></button>\n                <div data-bind=\"html: getItemTooltipData, css: { 'hide-shop-item-details': !displayShopItemTooltip() }\"></div>\n                <div style=\"margin-top:10px;margin-bottom:10px;\" class=\"form-inline\" data-bind=\"visible: getItemInputLabel() != ''\">\n                    <div class=\"form-group\">\n                        <label for=\"iteminput\" data-bind=\"text: getItemInputLabel\"></label>\n                        <input class=\"form-control\" id=\"iteminput\" data-bind=\"value: itemInputValue\" />\n                    </div>\n                </div>\n                <div class=\"form-group text-right\">\n                    <button class=\"btn btn-default\" data-bind=\"click: addItem\">Add Item</button>\n                </div>\n            </div>\n        </div>"
};
},{}],44:[function(require,module,exports){
'use strict';
var ko = require('./herocalc_knockout');
    
var my = require("./herocalc_core");

my.prototype.AbilityModel = function (a, h) {
    var self = this;
    self.hero = h;
    self.abilityData = my.prototype.abilityData;
    self.hasScepter = ko.observable(false);
    self.isShapeShiftActive = ko.observable(false);
    self.abilities = a;
    for (var i = 0; i < self.abilities().length; i++) {
        self.abilities()[i].level = ko.observable(0);
        self.abilities()[i].isActive = ko.observable(false);
        self.abilities()[i].isDetail = ko.observable(false);
        self.abilities()[i].baseDamage = ko.observable(0);
        self.abilities()[i].baseDamageReductionPct = ko.observable(0);
        self.abilities()[i].baseDamageMultiplier = ko.observable(0);
        self.abilities()[i].bash = ko.observable(0);
        self.abilities()[i].bashBonusDamage = ko.observable(0);
        self.abilities()[i].bonusDamage = ko.observable(0);
        self.abilities()[i].bonusDamageOrb = ko.observable(0);
        self.abilities()[i].bonusDamagePct = ko.observable(0);
        self.abilities()[i].bonusDamagePrecisionAura = ko.observable(0);
        self.abilities()[i].bonusDamageReduction = ko.observable(0);
        self.abilities()[i].bonusHealth = ko.observable(0);
        self.abilities()[i].bonusStrength = ko.observable(0);
        self.abilities()[i].bonusStrength2 = ko.observable(0);
        self.abilities()[i].bonusAgility = ko.observable(0);
        self.abilities()[i].bonusAgility2 = ko.observable(0);
        self.abilities()[i].bonusInt = ko.observable(0);
        self.abilities()[i].bonusAllStatsReduction = ko.observable(0);
        self.abilities()[i].damageAmplification = ko.observable(0);
        self.abilities()[i].damageReduction = ko.observable(0);
        self.abilities()[i].evasion = ko.observable(0);
        self.abilities()[i].magicResist = ko.observable(0);
        self.abilities()[i].manaregen = ko.observable(0);
        self.abilities()[i].manaregenreduction = ko.observable(0);
        self.abilities()[i].missChance = ko.observable(0);
        self.abilities()[i].movementSpeedFlat = ko.observable(0);
        self.abilities()[i].movementSpeedPct = ko.observable(0);
        self.abilities()[i].movementSpeedPctReduction = ko.observable(0);
        self.abilities()[i].turnRateReduction = ko.observable(0);
        self.abilities()[i].attackrange = ko.observable(0);
        self.abilities()[i].attackspeed = ko.observable(0);
        self.abilities()[i].attackspeedreduction = ko.observable(0);
        self.abilities()[i].armor = ko.observable(0);
        self.abilities()[i].armorReduction = ko.observable(0);
        self.abilities()[i].healthregen = ko.observable(0);
        self.abilities()[i].lifesteal = ko.observable(0);
        self.abilities()[i].visionnight = ko.observable(0);
        self.abilities()[i].visionday = ko.observable(0);
    }
    self.abilityControlData = {};
    self.abilitySettingsData = function (data, parent, index) {
        if (self.abilityControlData[data] == undefined) {
            return self.processAbility(data, parent, index, self.abilityData[data]);
        }
        else {
            return self.abilityControlData[data];
        }
    }
    
    self.processAbility = function (data, parent, index, args) {
        var result = {};
        result.data = [];
        var v;
        var v_list = [];
        for (var i=0; i < args.length; i++) {
            switch (args[i].controlType) {
                case 'input':
                    v = ko.observable(0).extend({ numeric: 2 });
                    v.controlValueType = args[i].controlValueType;
                    v_list.push(v);
                    result.data.push({ labelName: args[i].label.toUpperCase() + ':', controlVal: v, controlType: args[i].controlType, display: args[i].display });
                break;
                case 'checkbox':
                    v = ko.observable(false);
                    v.controlValueType = args[i].controlValueType;
                    v_list.push(v);
                    result.data.push({ labelName: args[i].label.toUpperCase() + '?', controlVal: v, controlType: args[i].controlType, display: args[i].display });
                break;
                case 'radio':
                    v = ko.observable(args[i].controlOptions[0].value);
                    v.controlValueType = args[i].controlValueType;
                    v_list.push(v);
                    result.data.push({ labelName: args[i].label.toUpperCase() + '?', controlVal: v, controlType: args[i].controlType, display: args[i].display, controlOptions: args[i].controlOptions });
                break;
                case 'method':
                case 'text':
                    // single input abilities
                    if (args[i].controls == undefined) {
                        if (args[i].noLevel) {
                            var attributeValue = function (attributeName) {
                                return {fn: ko.computed(function () {
                                    var _ability = self.abilities().find(function(b) {
                                        return b.name == data;
                                    });
                                    return self.getAbilityAttributeValue(_ability.attributes, attributeName, 0);
                                })};
                            };
                        }
                        else {
                            var attributeValue = function (attributeName) {
                                return {fn: ko.computed(function () {
                                    var _ability = self.abilities().find(function(b) {
                                        return b.name == data;
                                    });
                                    return self.getAbilityAttributeValue(_ability.attributes, attributeName, _ability.level());
                                })};
                            };
                        }
                        var g = attributeValue(args[i].attributeName)
                        var r = self.getComputedFunction(v, g.fn, args[i].fn, parent, index, self, args[i].returnProperty, undefined, data);
                        if (args[i].ignoreTooltip) {
                            var tooltip = args[i].label || args[i].attributeName;
                        }
                        else {
                            var tooltip = self.getAbilityAttributeTooltip(self.abilities()[index].attributes, args[i].attributeName) || args[i].label || args[i].attributeName;
                        }
                        result.data.push({ labelName: tooltip.toUpperCase(), controlVal: r, controlType: args[i].controlType, display: args[i].display, clean: g.fn });
                    }
                    // multi input abilities
                    else {
                        if (args[i].noLevel) {
                            var attributeValue = function (attributeName) {
                                return {fn: ko.computed(function () {
                                    return self.getAbilityAttributeValue(self.abilities()[index].attributes, attributeName, 0);
                                })};
                            };
                        }
                        else {
                            var attributeValue = function (attributeName) {
                                return {fn: ko.computed(function () {
                                    return self.getAbilityAttributeValue(self.abilities()[index].attributes, attributeName, self.abilities()[index].level());
                                })};
                            };
                        }
                        var g = attributeValue(args[i].attributeName)
                        var r = self.getComputedFunction(v_list, g.fn, args[i].fn, parent, index, self, args[i].returnProperty, args[i].controls, data);
                        if (args[i].ignoreTooltip) {
                            var tooltip = args[i].label || args[i].attributeName;
                        }
                        else {
                            var tooltip = self.getAbilityAttributeTooltip(self.abilities()[index].attributes, args[i].attributeName) || args[i].label || args[i].attributeName;
                        }
                        result.data.push({ labelName: tooltip.toUpperCase(), controlVal: r, controlType: args[i].controlType, display: args[i].display, clean: g.fn });
                    }
                    
                    if (args[i].controlType == 'method') {
                        v_list.push(r);
                    }
                break;
            }
        }
        self.abilityControlData[data] = result;
        return result;
    }

    self.getComputedFunction = function (v, attributeValue, fn, parent, index, abilityModel, returnProperty, controls, abilityName) {
        var _ability = abilityModel.abilities().find(function(b) {
            return b.name == abilityName;
        });
        return ko.pureComputed(function () {                
            var inputValue;
            if (controls == undefined) {
                if (v == undefined) {
                    inputValue = v;
                }
                else if (typeof v() == 'boolean') {
                    inputValue = v();
                }
                else if (v.controlValueType == undefined) {
                    inputValue = parseFloat(v());
                }
                else if (v.controlValueType == 'string') {
                    inputValue = v();
                }
                else {
                    inputValue = parseFloat(v());
                }
            }
            else {
                var v_list = [];
                for (var i=0;i<controls.length;i++) {
                    switch (typeof v[controls[i]]()) {
                        case 'boolean':
                        case 'object':
                            v_list.push(v[controls[i]]());
                        break;
                        default:
                            v_list.push(parseFloat(v[controls[i]]()));
                        break;
                    }
                }
                inputValue = v_list;
            }
            
            var returnVal = fn.call(this, inputValue, attributeValue(), parent, index, abilityModel, _ability);
            if (returnProperty != undefined) {
                _ability[returnProperty](returnVal);
            }
            return returnVal;
        }, this);
    }

    self.getAbilityAttributeValue = function (attributes, attributeName, level) {
        for (var i=0; i < attributes.length; i++) {
            if (attributes[i].name == attributeName) {
                if (level == 0) {
                    return parseFloat(attributes[i].value[0]);
                }
                else if (level > attributes[i].value.length) {
                    return parseFloat(attributes[i].value[0]);
                }
                else {
                    return parseFloat(attributes[i].value[level-1]);
                }
            }
        }
    }

    self.getAbilityAttributeTooltip = function (attributes, attributeName) {
        for (var i=0; i<attributes.length; i++) {
            if (attributes[i].name == attributeName) {
                if (attributes[i].hasOwnProperty('tooltip')) {
                    var d = attributes[i].tooltip.replace(/\\n/g, '');
                    return d;
                }
                else {
                    return '';
                }
            }
        }
        return '';
    }
    
    self.getAbilityLevelByAbilityName = function (abilityName) {
        for (var i = 0; i < self.abilities().length; i++) {
            if (self.abilities()[i].name == abilityName) {
                return self.abilities()[i].level();
            }
        }
        return -1;
    }

    self.getAbilityByName = function (abilityName) {
        for (var i = 0; i < self.abilities().length; i++) {
            if (self.abilities()[i].name == abilityName) {
                return self.abilities()[i];
            }
        }
        return undefined;
    }

    self.getAbilityPropertyValue = function (ability, property) {
        return parseFloat(ability[property]()[ability.level()-1]);
    }
    
    self.getAttributeBonusLevel = function () {
        for (var i = 0; i < self.abilities().length; i++) {
            if (self.abilities()[i].name == 'attribute_bonus') {
                return self.abilities()[i].level();
            }
        }
        return 0;        
    }
    
    self.getAllStatsReduction = ko.computed(function () {
        var totalAttribute = 0;
        for (var i = 0; i < self.abilities().length; i++) {
            var ability = self.abilities()[i];
            if (!(ability.name in self.abilityData)) {
                if (ability.level() > 0 && (ability.isActive() || (ability.behavior.indexOf('DOTA_ABILITY_BEHAVIOR_PASSIVE') != -1))) {
                    for (var j = 0; j < self.abilities()[i].attributes.length; j++) {
                        var attribute = self.abilities()[i].attributes[j];
                        /*switch(attribute.name) {
                            // invoker_quas
                            case 'bonus_strength':
                                totalAttribute += parseInt(attribute.value[ability.level()-1]);
                            break;
                        }*/
                    }
                }
            }
            else if (ability.bonusAllStatsReduction != undefined) {
                if (ability.level() > 0 && (ability.isActive() || (ability.behavior.indexOf('DOTA_ABILITY_BEHAVIOR_PASSIVE') != -1))) {
                    // slark_essence_shift
                    totalAttribute+=ability.bonusAllStatsReduction();
                }
            }
        }
        return totalAttribute;
    });
    
    self.getStrengthReduction = ko.computed(function () {
        var totalAttribute = 0;
        for (var i = 0; i < self.abilities().length; i++) {
            var ability = self.abilities()[i];
            if (!(ability.name in self.abilityData)) {
                if (ability.level() > 0 && (ability.isActive() || (ability.behavior.indexOf('DOTA_ABILITY_BEHAVIOR_PASSIVE') != -1))) {
                    for (var j = 0; j < self.abilities()[i].attributes.length; j++) {
                        var attribute = self.abilities()[i].attributes[j];
                        /*switch(attribute.name) {
                            // invoker_quas
                            case 'bonus_strength':
                                totalAttribute += parseInt(attribute.value[ability.level()-1]);
                            break;
                        }*/
                    }
                }
            }
            else if (ability.bonusStrength != undefined && ability.name == 'undying_decay') {
                if (ability.level() > 0 && (ability.isActive() || (ability.behavior.indexOf('DOTA_ABILITY_BEHAVIOR_PASSIVE') != -1))) {
                    // undying_decay
                    totalAttribute-=ability.bonusStrength();
                }
            }
        }
        return totalAttribute;
    });
    
    self.getStrength = ko.computed(function () {
        var totalAttribute = 0;
        for (var i = 0; i < self.abilities().length; i++) {
            var ability = self.abilities()[i];
            if (!(ability.name in self.abilityData)) {
                if (ability.level() > 0 && (ability.isActive() || (ability.behavior.indexOf('DOTA_ABILITY_BEHAVIOR_PASSIVE') != -1))) {
                    for (var j = 0; j < self.abilities()[i].attributes.length; j++) {
                        var attribute = self.abilities()[i].attributes[j];
                        /*switch(attribute.name) {
                            // invoker_quas
                            case 'bonus_strength':
                                totalAttribute += parseInt(attribute.value[ability.level()-1]);
                            break;
                        }*/
                    }
                }
            }
            else {
                if (ability.bonusStrength != undefined) {
                    if (ability.level() > 0 && (ability.isActive() || (ability.behavior.indexOf('DOTA_ABILITY_BEHAVIOR_PASSIVE') != -1) || ability.name == 'invoker_quas')) {
                        // pudge_flesh_heap,invoker_quas,morphling_morph_str,morphling_morph_agi,undying_decay
                        totalAttribute+=ability.bonusStrength();
                    }
                }
                if (ability.bonusStrength2 != undefined) {
                    if (ability.level() > 0 && (ability.isActive() || (ability.behavior.indexOf('DOTA_ABILITY_BEHAVIOR_PASSIVE') != -1))) {
                        // morphling_morph_str
                        totalAttribute+=ability.bonusStrength2();
                    }
                }
            }
        }
        return totalAttribute;
    });
    
    self.getAgility = ko.computed(function () {
        var totalAttribute = 0;
        for (var i = 0; i < self.abilities().length; i++) {
            var ability = self.abilities()[i];
            if (!(ability.name in self.abilityData)) {
                if (ability.level() > 0 && (ability.isActive() || (ability.behavior.indexOf('DOTA_ABILITY_BEHAVIOR_PASSIVE') != -1))) {
                    for (var j = 0; j < self.abilities()[i].attributes.length; j++) {
                        var attribute = self.abilities()[i].attributes[j];
                        switch(attribute.name) {
                            // drow_ranger_marksmanship
                            case 'marksmanship_agility_bonus':
                                totalAttribute += self.getAbilityAttributeValue(self.abilities()[i].attributes, attribute.name, ability.level());
                            break;
                        }
                    }
                }
            }
            else {
                if (ability.bonusAgility != undefined) {
                    if (ability.level() > 0 && (ability.isActive() || (ability.behavior.indexOf('DOTA_ABILITY_BEHAVIOR_PASSIVE') != -1) || ability.name == 'invoker_wex')) {
                        // invoker_wex,morphling_morph_agi,morphling_morph_str
                        totalAttribute+=ability.bonusAgility();
                    }
                }
                if (ability.bonusAgility2 != undefined) {
                    if (ability.level() > 0 && (ability.isActive() || (ability.behavior.indexOf('DOTA_ABILITY_BEHAVIOR_PASSIVE') != -1))) {
                        // invoker_wex,morphling_morph_agi,morphling_morph_str
                        totalAttribute+=ability.bonusAgility2();
                    }
                }
            }
        }
        return totalAttribute;
    });

    self.getIntelligence = ko.computed(function () {
        var totalAttribute = 0;
        for (var i = 0; i < self.abilities().length; i++) {
            var ability = self.abilities()[i];
            if (!(ability.name in self.abilityData)) {
                if (ability.level() > 0 && (ability.isActive() || (ability.behavior.indexOf('DOTA_ABILITY_BEHAVIOR_PASSIVE') != -1))) {
                    for (var j = 0; j < self.abilities()[i].attributes.length; j++) {
                        var attribute = self.abilities()[i].attributes[j];
                        switch(attribute.name) {
                            // invoker_exort
                        /*    case 'bonus_intelligence':
                                totalAttribute += self.getAbilityAttributeValue(self.abilities()[i].attributes, attribute.name, ability.level());
                            break;*/
                        }
                    }
                }
            }
            else if (ability.bonusInt != undefined) {
                if (ability.level() > 0 && (ability.isActive() || (ability.behavior.indexOf('DOTA_ABILITY_BEHAVIOR_PASSIVE') != -1) || ability.name == 'invoker_exort')) {
                    // invoker_exort
                    totalAttribute+=ability.bonusInt();
                }
            }
        }
        return totalAttribute;
    });
    
    self.getArmor = ko.computed(function () {
        var totalAttribute = 0;
        for (var i = 0; i < self.abilities().length; i++) {
            var ability = self.abilities()[i];
            if (!(ability.name in self.abilityData)) {
                if (ability.level() > 0 && (ability.isActive() || (ability.behavior.indexOf('DOTA_ABILITY_BEHAVIOR_PASSIVE') != -1))) {
                    for (var j = 0; j < self.abilities()[i].attributes.length; j++) {
                        var attribute = self.abilities()[i].attributes[j];
                        switch(attribute.name) {
                            // axe_berserkers_call,dragon_knight_dragon_blood,troll_warlord_berserkers_rage,lycan_shapeshift,enraged_wildkin_toughness_aura
                            case 'bonus_armor':
                                if (ability.name != 'templar_assassin_meld') {
                                    totalAttribute += self.getAbilityAttributeValue(self.abilities()[i].attributes, attribute.name, ability.level());
                                }
                            break;
                            // sven_warcry
                            case 'warcry_armor':
                                totalAttribute += self.getAbilityAttributeValue(self.abilities()[i].attributes, attribute.name, ability.level());
                            break;
                            // lich_frost_armor,ogre_magi_frost_armor
                            case 'armor_bonus':
                                if (ability.name == 'lich_frost_armor' || ability.name == 'ogre_magi_frost_armor') {
                                    totalAttribute += self.getAbilityAttributeValue(self.abilities()[i].attributes, attribute.name, ability.level());
                                }
                            break;
                        }
                    }
                }
            }
            else if (ability.armor != undefined) {
                if (ability.level() > 0 && (ability.isActive() || (ability.behavior.indexOf('DOTA_ABILITY_BEHAVIOR_PASSIVE') != -1))) {
                    // shredder_reactive_armor,visage_gravekeepers_cloak
                    totalAttribute+=ability.armor();
                }
            }
        }
        return totalAttribute;
    });

    self.getArmorBaseReduction = ko.computed(function () {
        var totalAttribute = 1;
        for (var i = 0; i < self.abilities().length; i++) {
            var ability = self.abilities()[i];
            if (!(ability.name in self.abilityData)) {
                if (ability.level() > 0 && (ability.isActive() || (ability.behavior.indexOf('DOTA_ABILITY_BEHAVIOR_PASSIVE') != -1))) {
                    switch(ability.name) {
                        //elder_titan_natural_order
                        case 'elder_titan_natural_order':
                            totalAttribute *= (1-self.getAbilityAttributeValue(self.abilities()[i].attributes, 'armor_reduction_pct', ability.level())/100);
                        break;
                    }
                }
            }
        }
        return totalAttribute;
    });
    
    self.getArmorReduction = ko.computed(function () {
        var totalAttribute = 0;
        for (var i = 0; i < self.abilities().length; i++) {
            var ability = self.abilities()[i];
            if (!(ability.name in self.abilityData)) {
                if (ability.level() > 0 && (ability.isActive() || (ability.behavior.indexOf('DOTA_ABILITY_BEHAVIOR_PASSIVE') != -1))) {
                    switch(ability.name) {
                        //templar_assassin_meld
                        case 'templar_assassin_meld':
                            totalAttribute += self.getAbilityAttributeValue(self.abilities()[i].attributes, 'bonus_armor', ability.level());
                        break;
                        // tidehunter_gush
                        case 'tidehunter_gush':
                            totalAttribute += self.getAbilityAttributeValue(self.abilities()[i].attributes, 'armor_bonus', ability.level());
                        break;
                        // naga_siren_rip_tide
                        case 'naga_siren_rip_tide':
                        // slardar_amplify_damage
                        case 'slardar_amplify_damage':
                        // vengefulspirit_wave_of_terror
                        case 'vengefulspirit_wave_of_terror':
                            totalAttribute += self.getAbilityAttributeValue(self.abilities()[i].attributes, 'armor_reduction', ability.level());
                        break;
                        // nevermore_dark_lord
                        case 'nevermore_dark_lord':
                            totalAttribute += self.getAbilityAttributeValue(self.abilities()[i].attributes, 'presence_armor_reduction', ability.level());
                        break;
                    }
                }
            }
            else if (ability.armorReduction != undefined) {
                if (ability.level() > 0 && (ability.isActive() || (ability.behavior.indexOf('DOTA_ABILITY_BEHAVIOR_PASSIVE') != -1))) {
                    // alchemist_acid_spray
                    totalAttribute+=ability.armorReduction();
                }
            }
        }
        return totalAttribute;
    });

    self.getHealth = ko.computed(function () {
        var totalAttribute = 0;
        for (var i = 0; i < self.abilities().length; i++) {
            var ability = self.abilities()[i];
            if (!(ability.name in self.abilityData)) {
                if (ability.level() > 0 && (ability.isActive() || (ability.behavior.indexOf('DOTA_ABILITY_BEHAVIOR_PASSIVE') != -1))) {
                    for (var j = 0; j < self.abilities()[i].attributes.length; j++) {
                        var attribute = self.abilities()[i].attributes[j];
                        switch(attribute.name) {
                            // lone_druid_true_form,lycan_shapeshift,troll_warlord_berserkers_rage
                            case 'bonus_hp':
                                totalAttribute += self.getAbilityAttributeValue(self.abilities()[i].attributes, attribute.name, ability.level());
                            break;
                            // lone_druid_synergy
                            case 'true_form_hp_bonus':
                                if (self.isTrueFormActive()) {
                                    totalAttribute += self.getAbilityAttributeValue(self.abilities()[i].attributes, attribute.name, ability.level());
                                }
                            break;
                        }
                    }
                }
            }
            else if (ability.bonusHealth != undefined) {
                if (ability.level() > 0 && (ability.isActive() || (ability.behavior.indexOf('DOTA_ABILITY_BEHAVIOR_PASSIVE') != -1))) {
                    // clinkz_death_pact
                    totalAttribute+=ability.bonusHealth();
                }
            }
        }
        return totalAttribute;
    });
    
    self.isTrueFormActive = function () {
        for (var i = 0; i < self.abilities().length; i++) {
            var ability = self.abilities()[i];
            if (ability.isActive() && ability.name == 'lone_druid_true_form') {
                return true;
            }
        }
        return false;
    }

    self.getHealthRegen = ko.computed(function () {
        var totalAttribute = 0;
        for (var i = 0; i < self.abilities().length; i++) {
            var ability = self.abilities()[i];
            if (!(ability.name in self.abilityData)) {
                if (ability.level() > 0 && (ability.isActive() || (ability.behavior.indexOf('DOTA_ABILITY_BEHAVIOR_PASSIVE') != -1))) {
                    for (var j = 0; j < self.abilities()[i].attributes.length; j++) {
                        var attribute = self.abilities()[i].attributes[j];
                        switch(attribute.name) {
                            // alchemist_chemical_rage, dragon_knight_dragon_blood
                            case 'bonus_health_regen':
                            // broodmother_spin_web
                            case 'heath_regen':
                            // omniknight_guardian_angel,treant_living_armor,satyr_hellcaller_unholy_aura
                            case 'health_regen':
                                totalAttribute += self.getAbilityAttributeValue(self.abilities()[i].attributes, attribute.name, ability.level());
                            break;
                            // legion_commander_press_the_attack
                            case 'hp_regen':
                                totalAttribute += self.getAbilityAttributeValue(self.abilities()[i].attributes, attribute.name, ability.level());
                            break;
                        }
                    }
                }
            }
            else if (ability.healthregen != undefined) {
                if (ability.level() > 0 && (ability.isActive() || (ability.behavior.indexOf('DOTA_ABILITY_BEHAVIOR_PASSIVE') != -1))) {
                    // shredder_reactive_armor,invoker_quas,necrolyte_sadist
                    totalAttribute+=ability.healthregen();
                }
            }
        }
        return totalAttribute;
    });

    self.getMana = ko.computed(function () {
        var totalAttribute = 0;
        for (var i = 0; i < self.abilities().length; i++) {
            var ability = self.abilities()[i];
            if (!(ability.name in self.abilityData)) {
                if (ability.level() > 0 && (ability.isActive() || (ability.behavior.indexOf('DOTA_ABILITY_BEHAVIOR_PASSIVE') != -1))) {
                    for (var j = 0; j < self.abilities()[i].attributes.length; j++) {
                        var attribute = self.abilities()[i].attributes[j];
                        switch(attribute.name) {
                            // obsidian_destroyer_essence_aura
                            case 'bonus_mana':
                                totalAttribute += self.getAbilityAttributeValue(self.abilities()[i].attributes, attribute.name, ability.level());
                            break;
                        }
                    }
                }
            }
        }
        return totalAttribute;
    });
    
    self.getManaRegen = ko.computed(function () {
        var totalAttribute = 0;
        for (var i = 0; i < self.abilities().length; i++) {
            var ability = self.abilities()[i];
            if (!(ability.name in self.abilityData)) {
                if (ability.level() > 0 && (ability.isActive() || (ability.behavior.indexOf('DOTA_ABILITY_BEHAVIOR_PASSIVE') != -1))) {
                    for (var j = 0; j < self.abilities()[i].attributes.length; j++) {
                        var attribute = self.abilities()[i].attributes[j];
                        switch(attribute.name) {
                            // alchemist_chemical_rage
                            case 'bonus_mana_regen':
                                totalAttribute += self.getAbilityAttributeValue(self.abilities()[i].attributes, attribute.name, ability.level());
                            break;
                        }
                    }
                }
            }
            else if (ability.manaregen != undefined) {
                if (ability.level() > 0 && (ability.isActive() || (ability.behavior.indexOf('DOTA_ABILITY_BEHAVIOR_PASSIVE') != -1))) {
                    // necrolyte_sadist
                    totalAttribute+=ability.manaregen();
                }
            }
        }
        return totalAttribute;
    });
    
    self.getManaRegenArcaneAura = ko.computed(function () {
        var totalAttribute = 0;
        for (var i = 0; i < self.abilities().length; i++) {
            var ability = self.abilities()[i];
            if (!(ability.name in self.abilityData)) {
                if (ability.level() > 0 && (ability.isActive() || (ability.behavior.indexOf('DOTA_ABILITY_BEHAVIOR_PASSIVE') != -1))) {
                    for (var j = 0; j < self.abilities()[i].attributes.length; j++) {
                        var attribute = self.abilities()[i].attributes[j];
                        switch(attribute.name) {
                            // crystal_maiden_brilliance_aura
                            case 'mana_regen':
                                if (ability.name == 'crystal_maiden_brilliance_aura') {
                                    totalAttribute += self.getAbilityAttributeValue(self.abilities()[i].attributes, attribute.name, ability.level());
                                }
                            break;
                        }
                    }
                }
            }
        }
        return totalAttribute;
    });

    self.getManaRegenReduction = ko.computed(function () {
        var totalAttribute = 0;
        for (var i = 0; i < self.abilities().length; i++) {
            var ability = self.abilities()[i];
            if (!(ability.name in self.abilityData)) {
                if (ability.level() > 0 && (ability.isActive() || (ability.behavior.indexOf('DOTA_ABILITY_BEHAVIOR_PASSIVE') != -1))) {
                    for (var j = 0; j < self.abilities()[i].attributes.length; j++) {
                        var attribute = self.abilities()[i].attributes[j];
                        //switch(attribute.name) {
                        //    // 
                        //    case '':
                        //        totalAttribute += parseInt(attribute.value[ability.level()-1]);
                        //    break;
                        //}
                    }
                }
            }
            else if (ability.manaregenreduction != undefined) {
                if (ability.level() > 0 && (ability.isActive() || (ability.behavior.indexOf('DOTA_ABILITY_BEHAVIOR_PASSIVE') != -1))) {
                    // pugna_nether_ward
                    totalAttribute+=ability.manaregenreduction();
                }
            }
        }
        return totalAttribute;
    });
    
    self.getAttackRange = ko.computed(function () {
        var totalAttribute = 0;
        for (var i = 0; i < self.abilities().length; i++) {
            var ability = self.abilities()[i];
            if (!(ability.name in self.abilityData)) {
                if (ability.level() > 0 && (ability.isActive() || (ability.behavior.indexOf('DOTA_ABILITY_BEHAVIOR_PASSIVE') != -1))) {
                    for (var j = 0; j < self.abilities()[i].attributes.length; j++) {
                        var attribute = self.abilities()[i].attributes[j];
                        switch(attribute.name) {
                            // winter_wyvern_arctic_burn
                            case 'attack_range_bonus':
                                totalAttribute += self.getAbilityAttributeValue(self.abilities()[i].attributes, attribute.name, ability.level());
                            break;
                            // templar_assassin_psi_blades,sniper_take_aim
                            case 'bonus_attack_range':
                            // terrorblade_metamorphosis,troll_warlord_berserkers_rage
                            case 'bonus_range':
                                if (ability.name == 'terrorblade_metamorphosis') {
                                    totalAttribute += self.getAbilityAttributeValue(self.abilities()[i].attributes, attribute.name, ability.level());
                                }
                                if (ability.name == 'troll_warlord_berserkers_rage') {
                                    totalAttribute -= self.getAbilityAttributeValue(self.abilities()[i].attributes, attribute.name, ability.level());
                                }
                            break;
                            // tiny_grow
                            case 'bonus_range_scepter':
                                if (ability.name == 'tiny_grow' && self.hasScepter()) {
                                    totalAttribute += self.getAbilityAttributeValue(self.abilities()[i].attributes, attribute.name, ability.level());
                                }
                            break;
                            // enchantress_impetus
                            case 'bonus_attack_range_scepter':
                                if (ability.name == 'enchantress_impetus' && self.hasScepter()) {
                                    totalAttribute += self.getAbilityAttributeValue(self.abilities()[i].attributes, attribute.name, ability.level());
                                }
                            break;
                        }
                    }
                    // lone_druid_true_form
                    if (ability.name == 'lone_druid_true_form') {
                        totalAttribute -= 422;
                    }
                }
                else if (ability.level() > 0 && ability.name == 'enchantress_impetus' && self.hasScepter()) {
                    for (var j = 0; j < self.abilities()[i].attributes.length; j++) {
                        var attribute = self.abilities()[i].attributes[j];
                        switch(attribute.name) {
                          case 'bonus_attack_range_scepter':
                            totalAttribute += self.getAbilityAttributeValue(self.abilities()[i].attributes, attribute.name, ability.level());
                          break;
                        }
                    }
                }
            }
            else if (ability.attackrange != undefined) {
                if (ability.level() > 0 && (ability.isActive() || (ability.behavior.indexOf('DOTA_ABILITY_BEHAVIOR_PASSIVE') != -1))) {
                    // dragon_knight_elder_dragon_form
                    totalAttribute+=ability.attackrange();
                }
            }
        }
        return totalAttribute;
    });
    
    self.getAttackSpeed = ko.computed(function () {
        var totalAttribute = 0;
        for (var i = 0; i < self.abilities().length; i++) {
            var ability = self.abilities()[i];
            if (!(ability.name in self.abilityData)) {
                if (ability.level() > 0 && (ability.isActive() || (ability.behavior.indexOf('DOTA_ABILITY_BEHAVIOR_PASSIVE') != -1))) {
                    for (var j = 0; j < self.abilities()[i].attributes.length; j++) {
                        var attribute = self.abilities()[i].attributes[j];
                        switch(attribute.name) {
                            // abaddon_frostmourne,troll_warlord_battle_trance
                            case 'attack_speed':
                            // visage_grave_chill
                            case 'attackspeed_bonus':
                            // mirana_leap
                            case 'leap_speedbonus_as':
                            // life_stealer
                            case 'attack_speed_bonus':
                                totalAttribute += self.getAbilityAttributeValue(self.abilities()[i].attributes, attribute.name, ability.level());
                            break;
                            // clinkz_strafe,ursa_overpower
                            case 'attack_speed_bonus_pct':
                                if (ability.name == 'clinkz_strafe' || ability.name == 'ursa_overpower') {
                                    totalAttribute += self.getAbilityAttributeValue(self.abilities()[i].attributes, attribute.name, ability.level());
                                }
                            break;
                            // axe_culling_blade,necronomicon_archer_aoe
                            case 'speed_bonus':
                                if (ability.name == 'axe_culling_blade' || ability.name == 'necronomicon_archer_aoe') {
                                    totalAttribute += self.getAbilityAttributeValue(self.abilities()[i].attributes, attribute.name, ability.level());
                                }
                            break;
                            // ancient_apparition_chilling_touch
                            case 'attack_speed_pct':
                                if (ability.name == 'ancient_apparition_chilling_touch') {
                                    totalAttribute += self.getAbilityAttributeValue(self.abilities()[i].attributes, attribute.name, ability.level());
                                }
                            break;
                            // beastmaster_inner_beast,lycan_feral_impulse,lone_druid_rabid,tiny_grow,phantom_assassin_phantom_strike,windrunner_focusfire,ogre_magi_bloodlust,centaur_khan_endurance_aura
                            case 'bonus_attack_speed':
                                if (ability.name == 'beastmaster_inner_beast' 
                                 || ability.name == 'lycan_feral_impulse' 
                                 || ability.name == 'lone_druid_rabid' 
                                 || ability.name == 'tiny_grow' 
                                 || ability.name == 'phantom_assassin_phantom_strike' 
                                 || ability.name == 'windrunner_focusfire' 
                                 || ability.name == 'ogre_magi_bloodlust'
                                 || ability.name == 'centaur_khan_endurance_aura') {
                                    totalAttribute += self.getAbilityAttributeValue(self.abilities()[i].attributes, attribute.name, ability.level());
                                }
                            break;
                        }
                    }
                }
            }
            else if (ability.attackspeed != undefined) {
                if (ability.level() > 0 && (ability.isActive() || (ability.behavior.indexOf('DOTA_ABILITY_BEHAVIOR_PASSIVE') != -1))) {
                    // troll_warlord_fervor,wisp_overcharge,lina_fiery_soul,invoker_alacrity,invoker_wex,huskar_berserkers_blood
                    totalAttribute+=ability.attackspeed();
                }
            }
        }
        return totalAttribute;
    });

    self.getAttackSpeedReduction = ko.computed(function () {
        var totalAttribute = 0;
        for (var i = 0; i < self.abilities().length; i++) {
            var ability = self.abilities()[i];
            if (!(ability.name in self.abilityData)) {
                if (ability.level() > 0 && (ability.isActive() || (ability.behavior.indexOf('DOTA_ABILITY_BEHAVIOR_PASSIVE') != -1))) {
                    for (var j = 0; j < self.abilities()[i].attributes.length; j++) {
                        var attribute = self.abilities()[i].attributes[j];
                        switch(attribute.name) {
                            // night_stalker_void,crystal_maiden_crystal_nova,ghost_frost_attack,ogre_magi_frost_armor,polar_furbolg_ursa_warrior_thunder_clap
                            case 'attackspeed_slow':
                            // lich_frost_armor,lich_frost_nova,enchantress_untouchable
                            case 'slow_attack_speed':
                            // beastmaster_primal_roar
                            case 'slow_attack_speed_pct':
                            // storm_spirit_overload
                            case 'overload_attack_slow':
                                totalAttribute += self.getAbilityAttributeValue(self.abilities()[i].attributes, attribute.name, ability.level());
                            break;
                            // omniknight_degen_aura
                            case 'speed_bonus':
                                if (ability.name == 'omniknight_degen_aura') {
                                    totalAttribute += self.getAbilityAttributeValue(self.abilities()[i].attributes, attribute.name, ability.level());
                                }
                            break;
                            // tusk_frozen_sigil,crystal_maiden_freezing_field
                            case 'attack_slow':
                                if (ability.name == 'crystal_maiden_freezing_field' && !self.hasScepter()) {
                                    totalAttribute += self.getAbilityAttributeValue(self.abilities()[i].attributes, attribute.name, ability.level());
                                }
                                else if (ability.name == 'tusk_frozen_sigil') {
                                    totalAttribute -= self.getAbilityAttributeValue(self.abilities()[i].attributes, attribute.name, ability.level());
                                }
                            break;
                            case 'attack_slow_scepter':
                                if (ability.name == 'crystal_maiden_freezing_field' && self.hasScepter()) {
                                    totalAttribute += self.getAbilityAttributeValue(self.abilities()[i].attributes, attribute.name, ability.level());
                                }
                            break;
                            // faceless_void_time_walk
                            case 'attack_speed_pct':
                                if (ability.name == 'faceless_void_time_walk') {
                                    totalAttribute += self.getAbilityAttributeValue(self.abilities()[i].attributes, attribute.name, ability.level());
                                }
                            break;
                            // bounty_hunter_jinada
                            case 'bonus_attackspeed':
                                if (ability.name == 'bounty_hunter_jinada') {
                                    totalAttribute += self.getAbilityAttributeValue(self.abilities()[i].attributes, attribute.name, ability.level());
                                }
                            break;
                            // brewmaster_thunder_clap
                            case 'attack_speed_slow':
                                if (ability.name == 'brewmaster_thunder_clap') {
                                    totalAttribute -= self.getAbilityAttributeValue(self.abilities()[i].attributes, attribute.name, ability.level());
                                }
                            break;
                            // medusa_stone_gaze
                            case 'slow':
                                if (ability.name == 'medusa_stone_gaze') {
                                    totalAttribute -= self.getAbilityAttributeValue(self.abilities()[i].attributes, attribute.name, ability.level());
                                }
                            break;
                            // visage_grave_chill
                            case 'attackspeed_bonus':
                                totalAttribute -= self.getAbilityAttributeValue(self.abilities()[i].attributes, attribute.name, ability.level());
                            break;
                            // abaddon_frostmourne
                            case 'attack_slow_tooltip':
                                if (ability.name == 'abaddon_frostmourne') {
                                    totalAttribute -= self.getAbilityAttributeValue(self.abilities()[i].attributes, attribute.name, ability.level());
                                }
                            break;
                        }
                    }
                    if (ability.name == 'enraged_wildkin_tornado') {
                        totalAttribute -= 15;
                    }
                }
            }
            else if (ability.attackspeedreduction != undefined) {
                if (ability.level() > 0 && (ability.isActive() || (ability.behavior.indexOf('DOTA_ABILITY_BEHAVIOR_PASSIVE') != -1))) {
                    // viper_viper_strike,viper_corrosive_skin,jakiro_liquid_fire,lich_chain_frost,sandking_epicenter,earth_spirit_rolling_boulder
                    totalAttribute+=ability.attackspeedreduction();
                }
            }
        }
        return totalAttribute;
    });
    self.getBash = ko.computed(function () {
        var totalAttribute = 1;
        for (var i = 0; i < self.abilities().length; i++) {
            var ability = self.abilities()[i];
            if (!(ability.name in self.abilityData)) {
                if (ability.level() > 0 && (ability.isActive() || (ability.behavior.indexOf('DOTA_ABILITY_BEHAVIOR_PASSIVE') != -1))) {
                    for (var j = 0; j < self.abilities()[i].attributes.length; j++) {
                        var attribute = self.abilities()[i].attributes[j];
                        switch(attribute.name) {
                            // slardar_bash
                            case 'chance':
                            // sniper_headshot
                            case 'proc_chance':
                                totalAttribute *= (1 - self.getAbilityAttributeValue(self.abilities()[i].attributes, attribute.name, ability.level())/100);
                            break;
                        }
                    }
                }
            }
            else if (ability.bash != undefined) {
                // spirit_breaker_greater_bash,faceless_void_time_lock
                if (ability.level() > 0 && (ability.isActive() || (ability.behavior.indexOf('DOTA_ABILITY_BEHAVIOR_PASSIVE') != -1))) {
                    totalAttribute *= (1 - ability.bash()/100);
                }
            }
        }
        return totalAttribute;
    });    
    self.getBaseDamage = ko.computed(function () {
        var totalAttribute = 0;
        var totalMultiplier = 1;
        var sources = {};
        for (var i = 0; i < self.abilities().length; i++) {
            var ability = self.abilities()[i];
            if (!(ability.name in self.abilityData)) {
                if (ability.level() > 0 && (ability.isActive() || (ability.behavior.indexOf('DOTA_ABILITY_BEHAVIOR_PASSIVE') != -1))) {
                    for (var j = 0; j < self.abilities()[i].attributes.length; j++) {
                        var attribute = self.abilities()[i].attributes[j];
                        switch(attribute.name) {
                            // tiny_grow,terrorblade_metamorphosis
                            case 'bonus_damage':
                                if (ability.name == 'tiny_grow' || ability.name == 'terrorblade_metamorphosis') {
                                    totalAttribute += self.getAbilityAttributeValue(self.abilities()[i].attributes, attribute.name, ability.level());
                                    sources[ability.name] = {
                                        'damage': self.getAbilityAttributeValue(self.abilities()[i].attributes, attribute.name, ability.level()),
                                        'damageType': 'physical',
                                        'displayname': ability.displayname
                                    }
                                }
                            break;
                        }
                    }
                }
            }
            else {
                if (ability.baseDamageMultiplier != undefined) {
                    // earthshaker_enchant_totem
                    if (ability.level() > 0 && (ability.isActive() || (ability.behavior.indexOf('DOTA_ABILITY_BEHAVIOR_PASSIVE') != -1))) {
                        totalMultiplier += ability.baseDamageMultiplier()/100;
                        /*totalAttribute += ability.baseDamage();
                        sources[ability.name] = {
                            'damage': ability.baseDamage(),
                            'damageType': 'physical',
                            'displayname': ability.displayname
                        }*/
                    }
                }
                if (ability.baseDamage != undefined) {
                    // clinkz_death_pact
                    if (ability.level() > 0 && (ability.isActive() || (ability.behavior.indexOf('DOTA_ABILITY_BEHAVIOR_PASSIVE') != -1))) {
                        totalAttribute += ability.baseDamage();
                        sources[ability.name] = {
                            'damage': ability.baseDamage(),
                            'damageType': 'physical',
                            'displayname': ability.displayname
                        }
                    }
                }
            }
        }
        return { sources: sources, total: totalAttribute, multiplier: totalMultiplier };
    });
    
    self.getSelfBaseDamageReductionPct = ko.computed(function () {
        var totalAttribute = 1;
        for (var i = 0; i < self.abilities().length; i++) {
            var ability = self.abilities()[i];
            if (!(ability.name in self.abilityData)) {
                if (ability.level() > 0 && (ability.isActive() || (ability.behavior.indexOf('DOTA_ABILITY_BEHAVIOR_PASSIVE') != -1))) {
                    for (var j = 0; j < self.abilities()[i].attributes.length; j++) {
                        var attribute = self.abilities()[i].attributes[j];
                        switch(attribute.name) {
                            // medusa_split_shot
                            case 'damage_modifier':
                                totalAttribute *= (1 + self.getAbilityAttributeValue(self.abilities()[i].attributes, attribute.name, ability.level())/100);
                            break;
                            // windrunner_focusfire
                            case 'focusfire_damage_reduction':
                                if (!self.hasScepter()) {
                                    totalAttribute *= (1 + self.getAbilityAttributeValue(self.abilities()[i].attributes, attribute.name, ability.level())/100);
                                }
                            break;
                            case 'focusfire_damage_reduction_scepter':
                                if (self.hasScepter()) {
                                    totalAttribute *= (1 + self.getAbilityAttributeValue(self.abilities()[i].attributes, attribute.name, ability.level())/100);
                                }
                            break;
                        }
                    }
                }
            }
        }
        return totalAttribute;
    });
    
    self.getBaseDamageReductionPct = ko.computed(function () {
        var totalAttribute = 1;
        for (var i = 0; i < self.abilities().length; i++) {
            var ability = self.abilities()[i];
            if (!(ability.name in self.abilityData)) {
                if (ability.level() > 0 && (ability.isActive() || (ability.behavior.indexOf('DOTA_ABILITY_BEHAVIOR_PASSIVE') != -1))) {
                    for (var j = 0; j < self.abilities()[i].attributes.length; j++) {
                        var attribute = self.abilities()[i].attributes[j];
                        switch(attribute.name) {
                            // vengefulspirit_command_aura
                            case 'bonus_damage_pct':
                                if (ability.name == 'vengefulspirit_command_aura') {
                                    totalAttribute *= (1 - self.getAbilityAttributeValue(self.abilities()[i].attributes, attribute.name, ability.level())/100);
                                }
                            break;
                        }
                    }
                }
            }
            else if (ability.baseDamageReductionPct != undefined) {
                if (ability.level() > 0 && (ability.isActive() || (ability.behavior.indexOf('DOTA_ABILITY_BEHAVIOR_PASSIVE') != -1))) {
                    // nevermore_requiem
                    totalAttribute *= (1 + ability.baseDamageReductionPct()/100);
                }
            }
        }
        return totalAttribute;
    });
    
    self.getBAT = ko.computed(function () {
        var totalAttribute = 0;
        for (var i = 0; i < self.abilities().length; i++) {
            var ability = self.abilities()[i];
            if (!(ability.name in self.abilityData)) {
                if (ability.level() > 0 && (ability.isActive() || (ability.behavior.indexOf('DOTA_ABILITY_BEHAVIOR_PASSIVE') != -1))) {
                    for (var j = 0; j < self.abilities()[i].attributes.length; j++) {
                        var attribute = self.abilities()[i].attributes[j];
                        switch(attribute.name) {
                            // troll_warlord_berserkers_rage,alchemist_chemical_rage,lone_druid_true_form,lycan_shapeshift
                            case 'base_attack_time':
                                totalAttribute += self.getAbilityAttributeValue(self.abilities()[i].attributes, attribute.name, ability.level());
                            break;
                        }
                    }
                }
            }
        }
        return totalAttribute;
    });
    self.getBonusDamage = ko.computed(function () {
        var totalAttribute = 0;
        var sources = {};
        for (var i = 0; i < self.abilities().length; i++) {
            var ability = self.abilities()[i];
            if (!(ability.name in self.abilityData)) {
                if (ability.level() > 0 && (ability.isActive() || (ability.behavior.indexOf('DOTA_ABILITY_BEHAVIOR_PASSIVE') != -1))) {
                    for (var j = 0; j < self.abilities()[i].attributes.length; j++) {
                        var attribute = self.abilities()[i].attributes[j];
                        switch(attribute.name) {
                            // broodmother_insatiable_hunger,luna_lunar_blessing,templar_assassin_refraction,templar_assassin_meld,troll_warlord_berserkers_rage,lone_druid_true_form_battle_cry
                            case 'bonus_damage':
                                if (ability.name == 'broodmother_insatiable_hunger' || ability.name == 'luna_lunar_blessing'
                                 || ability.name == 'templar_assassin_refraction' || ability.name == 'templar_assassin_meld'
                                 || ability.name == 'troll_warlord_berserkers_rage' || ability.name == 'lone_druid_true_form_battle_cry') {
                                    totalAttribute += self.getAbilityAttributeValue(self.abilities()[i].attributes, attribute.name, ability.level());
                                    sources[ability.name] = {
                                        'damage': self.getAbilityAttributeValue(self.abilities()[i].attributes, attribute.name, ability.level()),
                                        'damageType': 'physical',
                                        'displayname': ability.displayname
                                    }
                                }
                            break;
                            // lycan_howl
                            case 'hero_bonus_damage':
                                totalAttribute += self.getAbilityAttributeValue(self.abilities()[i].attributes, attribute.name, ability.level());
                                sources[ability.name] = {
                                    'damage': self.getAbilityAttributeValue(self.abilities()[i].attributes, attribute.name, ability.level()),
                                    'damageType': 'physical',
                                    'displayname': ability.displayname
                                }
                            break;
                        }
                    }
                    if (ability.name == 'storm_spirit_overload') {
                        totalAttribute += self.getAbilityPropertyValue(ability, 'damage');
                        sources[ability.name] = {
                            'damage': self.getAbilityPropertyValue(ability, 'damage'),
                            'damageType': 'magic',
                            'displayname': ability.displayname
                        }                        
                    }
                }
            }
            else if (ability.bonusDamage != undefined && ability.bonusDamage() != 0) {
                if (ability.level() > 0 && (ability.isActive() || (ability.behavior.indexOf('DOTA_ABILITY_BEHAVIOR_PASSIVE') != -1))) {
                    // nevermore_necromastery,ursa_fury_swipes,ursa_enrage,invoker_alacrity,invoker_exort,elder_titan_ancestral_spirit,spectre_desolate,razor_static_link
                    totalAttribute+=ability.bonusDamage();
                    sources[ability.name] = {
                        'damage': ability.bonusDamage(),
                        'damageType': ability.name == 'spectre_desolate' ? 'pure' : 'physical',
                        'displayname': ability.displayname
                    }
                }
            }
        }
        return { sources: sources, total: totalAttribute };
    });

    self.getBonusDamagePercent = ko.computed(function () {
        var totalAttribute = 0;
        var sources = {};
        for (var i = 0; i < self.abilities().length; i++) {
            var ability = self.abilities()[i];
            if (!(ability.name in self.abilityData)) {
                if (ability.level() > 0 && (ability.isActive() || (ability.behavior.indexOf('DOTA_ABILITY_BEHAVIOR_PASSIVE') != -1))) {
                    for (var j = 0; j < self.abilities()[i].attributes.length; j++) {
                        var attribute = self.abilities()[i].attributes[j];
                        switch(attribute.name) {
                            // bloodseeker_bloodrage
                            case 'damage_increase_pct':
                                if (ability.name == 'bloodseeker_bloodrage') {
                                    totalAttribute += self.getAbilityAttributeValue(self.abilities()[i].attributes, attribute.name, ability.level())/100;
                                    sources[ability.name] = {
                                        'damage': self.getAbilityAttributeValue(self.abilities()[i].attributes, attribute.name, ability.level())/100,
                                        'damageType': 'physical',
                                        'displayname': ability.displayname
                                    }
                                }
                            break;
                            // magnataur_empower,vengefulspirit_command_aura,alpha_wolf_command_aura
                            case 'bonus_damage_pct':
                                if (ability.name == 'magnataur_empower' || ability.name == 'vengefulspirit_command_aura' || ability.name == 'alpha_wolf_command_aura') {
                                    totalAttribute += self.getAbilityAttributeValue(self.abilities()[i].attributes, attribute.name, ability.level())/100;
                                    sources[ability.name] = {
                                        'damage': self.getAbilityAttributeValue(self.abilities()[i].attributes, attribute.name, ability.level())/100,
                                        'damageType': 'physical',
                                        'displayname': ability.displayname
                                    }
                                }
                            break;
                            // sven_gods_strength
                            case 'gods_strength_damage':
                                if (ability.name == 'sven_gods_strength' && self.hero != undefined && self.hero.heroId() == 'sven') {
                                    totalAttribute += self.getAbilityAttributeValue(self.abilities()[i].attributes, attribute.name, ability.level())/100;
                                    sources[ability.name] = {
                                        'damage': self.getAbilityAttributeValue(self.abilities()[i].attributes, attribute.name, ability.level())/100,
                                        'damageType': 'physical',
                                        'displayname': ability.displayname
                                    }
                                }
                            break;
                            case 'gods_strength_damage_scepter':
                                if (ability.name == 'sven_gods_strength' && self.hero == undefined) {
                                    totalAttribute += self.getAbilityAttributeValue(self.abilities()[i].attributes, attribute.name, ability.level())/100;
                                    sources[ability.name] = {
                                        'damage': self.getAbilityAttributeValue(self.abilities()[i].attributes, attribute.name, ability.level())/100,
                                        'damageType': 'physical',
                                        'displayname': ability.displayname
                                    }
                                }
                            break;
                        }
                    }
                }
            }
            else if (ability.bonusDamagePct != undefined && ability.bonusDamagePct() != 0) {
                if (ability.level() > 0 && (ability.isActive() || (ability.behavior.indexOf('DOTA_ABILITY_BEHAVIOR_PASSIVE') != -1))) {
                    // bloodseeker_bloodrage
                    /*totalAttribute+=ability.bonusDamagePct()/100;
                    sources[ability.name] = {
                        'damage': ability.bonusDamagePct()/100,
                        'damageType': 'physical',
                        'displayname': ability.displayname
                    }*/
                }
            }
        }
        return { sources: sources, total: totalAttribute };
    });

    self.getBonusDamageBackstab = ko.computed(function () {
        var totalAttribute1 = 0;
        var totalAttribute2 = 0;
        var sources = [];
        for (var i = 0; i < self.abilities().length; i++) {
            var ability = self.abilities()[i];
            if (ability.name == 'riki_backstab') {
                if (ability.level() > 0 && (ability.isActive() || (ability.behavior.indexOf('DOTA_ABILITY_BEHAVIOR_PASSIVE') != -1))) {
                    for (var j = 0; j < self.abilities()[i].attributes.length; j++) {
                        var attribute = self.abilities()[i].attributes[j];
                        switch(attribute.name) {
                            // riki_backstab
                            case 'damage_multiplier':
                                totalAttribute1 += self.getAbilityAttributeValue(self.abilities()[i].attributes, attribute.name, ability.level());
                                sources.push({
                                    'damage': self.getAbilityAttributeValue(self.abilities()[i].attributes, attribute.name, ability.level()),
                                    'damageType': 'physical',
                                    'displayname': ability.displayname
                                });
                            break;
                        }
                    }/*
                    if (ability.bonusDamageBackstab != undefined) {
                        console.log('bonusDamageBackstab');
                        // damage_multiplier
                        totalAttribute2+=ability.bonusDamageBackstab();
                        sources.push({
                            'damage': ability.bonusDamageBackstab(),
                            'damageType': 'physical',
                            'displayname': ability.displayname
                        });
                    }
                    */
                }
            }
        }
        return { sources: sources, total: [totalAttribute1,totalAttribute2] };
    });
    
    self.getBonusDamagePrecisionAura = ko.computed(function () {
        var totalAttribute1 = 0;
        var totalAttribute2 = 0;
        var sources = [];
        for (var i = 0; i < self.abilities().length; i++) {
            var ability = self.abilities()[i];
            if (ability.name == 'drow_ranger_trueshot') {
                if (ability.level() > 0 && (ability.isActive() || (ability.behavior.indexOf('DOTA_ABILITY_BEHAVIOR_PASSIVE') != -1))) {
                    for (var j = 0; j < self.abilities()[i].attributes.length; j++) {
                        var attribute = self.abilities()[i].attributes[j];
                        switch(attribute.name) {
                            // drow_ranger_trueshot
                            case 'trueshot_ranged_damage':
                                totalAttribute1 += self.getAbilityAttributeValue(self.abilities()[i].attributes, attribute.name, ability.level())/100;
                                sources.push({
                                    'damage': self.getAbilityAttributeValue(self.abilities()[i].attributes, attribute.name, ability.level())/100,
                                    'damageType': 'physical',
                                    'displayname': ability.displayname
                                });
                            break;
                        }
                    }
                    if (ability.bonusDamagePrecisionAura != undefined) {
                        // drow_ranger_trueshot
                        totalAttribute2+=ability.bonusDamagePrecisionAura();
                        sources.push({
                            'damage': ability.bonusDamagePrecisionAura(),
                            'damageType': 'physical',
                            'displayname': ability.displayname
                        });
                    }
                }
            }
        }
        return { sources: sources, total: [totalAttribute1,totalAttribute2] };
    });
    
    self.getBonusDamageReduction = ko.computed(function () {
        var totalAttribute = 0;
        for (var i = 0; i < self.abilities().length; i++) {
            var ability = self.abilities()[i];
            if (!(ability.name in self.abilityData)) {
                if (ability.level() > 0 && (ability.isActive() || (ability.behavior.indexOf('DOTA_ABILITY_BEHAVIOR_PASSIVE') != -1))) {
                    for (var j = 0; j < self.abilities()[i].attributes.length; j++) {
                        var attribute = self.abilities()[i].attributes[j];
                        switch(attribute.name) {
                            // bane_enfeeble
                            case 'enfeeble_attack_reduction':
                                totalAttribute += self.getAbilityAttributeValue(self.abilities()[i].attributes, attribute.name, ability.level());
                            break;
                        }
                    }
                }
            }
            else if (ability.bonusDamageReduction != undefined) {
                if (ability.level() > 0 && (ability.isActive() || (ability.behavior.indexOf('DOTA_ABILITY_BEHAVIOR_PASSIVE') != -1))) {
                    // rubick_fade_bolt,razor_static_link
                    totalAttribute+=ability.bonusDamageReduction();
                }
            }
        }
        return totalAttribute;
    });
    
    self.getBonusDamageReductionPct = ko.computed(function () {
        var totalAttribute = 1;
        for (var i = 0; i < self.abilities().length; i++) {
            var ability = self.abilities()[i];
            if (!(ability.name in self.abilityData)) {
                if (ability.level() > 0 && (ability.isActive() || (ability.behavior.indexOf('DOTA_ABILITY_BEHAVIOR_PASSIVE') != -1))) {
                    for (var j = 0; j < self.abilities()[i].attributes.length; j++) {
                        var attribute = self.abilities()[i].attributes[j];
                        switch(attribute.name) {
                            // medusa_split_shot
                            case 'damage_modifier':
                                totalAttribute *= (1 + self.getAbilityAttributeValue(self.abilities()[i].attributes, attribute.name, ability.level())/100);
                            break;
                            // windrunner_focusfire
                            case 'focusfire_damage_reduction':
                                if (!self.hasScepter()) {
                                    totalAttribute *= (1 + self.getAbilityAttributeValue(self.abilities()[i].attributes, attribute.name, ability.level())/100);
                                }
                            break;
                            case 'focusfire_damage_reduction_scepter':
                                if (self.hasScepter()) {
                                    totalAttribute *= (1 + self.getAbilityAttributeValue(self.abilities()[i].attributes, attribute.name, ability.level())/100);
                                }
                            break;
                        }
                    }
                }
            }
        }
        return totalAttribute;
    });

    self.getDamageAmplification = ko.computed(function () {
        var totalAttribute = 1;
        for (var i = 0; i < self.abilities().length; i++) {
            var ability = self.abilities()[i];
            if (!(ability.name in self.abilityData)) {
                /*if (ability.level() > 0 && (ability.isActive() || (ability.behavior.indexOf('DOTA_ABILITY_BEHAVIOR_PASSIVE') != -1))) {
                    for (var j = 0; j < self.abilities()[i].attributes.length; j++) {
                        var attribute = self.abilities()[i].attributes[j];
                        switch(attribute.name) {
                            // bane_enfeeble
                            case 'enfeeble_attack_reduction':
                                totalAttribute += self.getAbilityAttributeValue(self.abilities()[i].attributes, attribute.name, ability.level());
                            break;
                        }
                    }
                }*/
            }
            else if (ability.damageAmplification != undefined) {
                if (ability.level() > 0 && (ability.isActive() || (ability.behavior.indexOf('DOTA_ABILITY_BEHAVIOR_PASSIVE') != -1))) {
                    // undying_flesh_golem
                    totalAttribute *= (1 + ability.damageAmplification()/100);
                }
            }
        }
        return totalAttribute;
    });
    
    self.getDamageReduction = ko.computed(function () {
        var totalAttribute = 1;
        for (var i = 0; i < self.abilities().length; i++) {
            var ability = self.abilities()[i];
            if (!(ability.name in self.abilityData)) {
                if (ability.level() > 0 && (ability.isActive() || (ability.behavior.indexOf('DOTA_ABILITY_BEHAVIOR_PASSIVE') != -1))) {
                    for (var j = 0; j < self.abilities()[i].attributes.length; j++) {
                        var attribute = self.abilities()[i].attributes[j];
                        switch(attribute.name) {
                            // bloodseeker_bloodrage
                            case 'damage_increase_pct':
                                if (ability.name == 'bloodseeker_bloodrage') {
                                    totalAttribute *= (1 + self.getAbilityAttributeValue(self.abilities()[i].attributes, attribute.name, ability.level())/100);
                                }
                            break;
                        }
                    }
                    // kunkka_ghostship
                    if (ability.name == 'kunkka_ghostship') {
                        totalAttribute *= (1 - 50/100);
                    }
                }
            }
            else if (ability.damageReduction != undefined) {
                if (ability.level() > 0 && (ability.isActive() || (ability.behavior.indexOf('DOTA_ABILITY_BEHAVIOR_PASSIVE') != -1))) {
                    // wisp_overcharge,bristleback_bristleback,spectre_dispersion,medusa_mana_shield,ursa_enrage
                    totalAttribute *= (1 + ability.damageReduction()/100);
                }
            }
        }
        return totalAttribute;
    });

    self.getCritSource = ko.computed(function () {
        var sources = {};
        for (var i = 0; i < self.abilities().length; i++) {
            var ability = self.abilities()[i];
            if (!(ability.name in self.abilityData)) {
                if (ability.level() > 0 && (ability.isActive() || (ability.behavior.indexOf('DOTA_ABILITY_BEHAVIOR_PASSIVE') != -1))) {
                    switch(ability.name) {
                        // phantom_assassin_coup_de_grace,brewmaster_drunken_brawler,chaos_knight_chaos_strike,lycan_shapeshift,skeleton_king_mortal_strike,juggernaut_blade_dance,alpha_wolf_critical_strike,giant_wolf_critical_strike
                        case 'phantom_assassin_coup_de_grace':
                            if (sources[ability.name] == undefined) {
                                sources[ability.name] = {
                                    'chance': self.getAbilityAttributeValue(self.abilities()[i].attributes, 'crit_chance', ability.level())/100,
                                    'multiplier': self.getAbilityAttributeValue(self.abilities()[i].attributes, 'crit_bonus', ability.level())/100,
                                    'count': 1,
                                    'displayname': ability.displayname
                                }
                            }
                            else {
                                sources[ability.name].count += 1;
                            }
                        break;
                        case 'brewmaster_drunken_brawler':
                            if (sources[ability.name] == undefined) {
                                sources[ability.name] = {
                                    'chance': self.getAbilityAttributeValue(self.abilities()[i].attributes, 'crit_chance', ability.level())/100,
                                    'multiplier': self.getAbilityAttributeValue(self.abilities()[i].attributes, 'crit_multiplier', ability.level())/100,
                                    'count': 1,
                                    'displayname': ability.displayname
                                }
                            }
                            else {
                                sources[ability.name].count += 1;
                            }
                        break;
                        case 'chaos_knight_chaos_strike':
                        case 'lycan_shapeshift':
                            if (sources[ability.name] == undefined) {
                                sources[ability.name] = {
                                    'chance': self.getAbilityAttributeValue(self.abilities()[i].attributes, 'crit_chance', ability.level())/100,
                                    'multiplier': self.getAbilityAttributeValue(self.abilities()[i].attributes, 'crit_multiplier', ability.level())/100,
                                    'count': 1,
                                    'displayname': ability.displayname
                                }
                            }
                            else {
                                sources[ability.name].count += 1;
                            }
                        break;
                        case 'skeleton_king_mortal_strike':
                            if (sources[ability.name] == undefined) {
                                sources[ability.name] = {
                                    'chance': self.getAbilityAttributeValue(self.abilities()[i].attributes, 'crit_chance', ability.level())/100,
                                    'multiplier': self.getAbilityAttributeValue(self.abilities()[i].attributes, 'crit_mult', ability.level())/100,
                                    'count': 1,
                                    'displayname': ability.displayname
                                }
                            }
                            else {
                                sources[ability.name].count += 1;
                            }
                        break;
                        case 'juggernaut_blade_dance':
                            if (sources[ability.name] == undefined) {
                                sources[ability.name] = {
                                    'chance': self.getAbilityAttributeValue(self.abilities()[i].attributes, 'blade_dance_crit_chance', ability.level())/100,
                                    'multiplier': self.getAbilityAttributeValue(self.abilities()[i].attributes, 'blade_dance_crit_mult', ability.level())/100,
                                    'count': 1,
                                    'displayname': ability.displayname
                                }
                            }
                            else {
                                sources[ability.name].count += 1;
                            }
                        break;
                        case 'alpha_wolf_critical_strike':
                        case 'giant_wolf_critical_strike':
                            if (sources[ability.name] == undefined) {
                                sources[ability.name] = {
                                    'chance': self.getAbilityAttributeValue(self.abilities()[i].attributes, 'crit_chance', ability.level())/100,
                                    'multiplier': self.getAbilityAttributeValue(self.abilities()[i].attributes, 'crit_mult', ability.level())/100,
                                    'count': 1,
                                    'displayname': ability.displayname
                                }
                            }
                            else {
                                sources[ability.name].count += 1;
                            }
                        break;
                    }
                }
            }
        }
        return sources;
    });    

    self.getCleaveSource = ko.computed(function () {
        var sources = {};
        for (var i = 0; i < self.abilities().length; i++) {
            var ability = self.abilities()[i];
            if (!(ability.name in self.abilityData)) {
                if (ability.level() > 0 && (ability.isActive() || (ability.behavior.indexOf('DOTA_ABILITY_BEHAVIOR_PASSIVE') != -1))) {
                    switch(ability.name) {
                        // magnataur_empower
                        case 'magnataur_empower':
                            if (sources[ability.name] == undefined) {
                                sources[ability.name] = {
                                    'radius': self.getAbilityAttributeValue(self.abilities()[i].attributes, 'cleave_radius', ability.level()),
                                    'magnitude': self.getAbilityAttributeValue(self.abilities()[i].attributes, 'cleave_damage_pct', ability.level())/100,
                                    'count': 1,
                                    'displayname': ability.displayname
                                }
                            }
                            else {
                                sources[ability.name].count += 1;
                            }
                        break;
                        // sven_great_cleave
                        case 'sven_great_cleave':
                            if (sources[ability.name] == undefined) {
                                sources[ability.name] = {
                                    'radius': self.getAbilityAttributeValue(self.abilities()[i].attributes, 'great_cleave_radius', ability.level()),
                                    'magnitude': self.getAbilityAttributeValue(self.abilities()[i].attributes, 'great_cleave_damage', ability.level())/100,
                                    'count': 1,
                                    'displayname': ability.displayname
                                }
                            }
                            else {
                                sources[ability.name].count += 1;
                            }
                        break;
                        // kunkka_tidebringer
                        case 'kunkka_tidebringer':
                            if (sources[ability.name] == undefined) {
                                sources[ability.name] = {
                                    'radius': self.getAbilityAttributeValue(self.abilities()[i].attributes, 'radius', ability.level()),
                                    'magnitude': 1,
                                    'count': 1,
                                    'displayname': ability.displayname
                                }
                            }
                            else {
                                sources[ability.name].count += 1;
                            }
                        break;
                        // tiny_grow
                        case 'tiny_grow':
                            if (self.hasScepter()) {
                                if (sources[ability.name] == undefined) {
                                    sources[ability.name] = {
                                        'radius': self.getAbilityAttributeValue(self.abilities()[i].attributes, 'bonus_cleave_radius_scepter', ability.level()),
                                        'magnitude': self.getAbilityAttributeValue(self.abilities()[i].attributes, 'bonus_cleave_damage_scepter', ability.level())/100,
                                        'count': 1,
                                        'displayname': ability.displayname
                                    }
                                }
                                else {
                                    sources[ability.name].count += 1;
                                }
                            }
                        break;
                    }
                }
            }
        }
        return sources;
    });    
    
    self.getCritChance = ko.computed(function () {
        var totalAttribute = 1;
        for (var i = 0; i < self.abilities().length; i++) {
            var ability = self.abilities()[i];
            if (!(ability.name in self.abilityData)) {
                if (ability.level() > 0 && (ability.isActive() || (ability.behavior.indexOf('DOTA_ABILITY_BEHAVIOR_PASSIVE') != -1))) {
                    for (var j = 0; j < self.abilities()[i].attributes.length; j++) {
                        var attribute = self.abilities()[i].attributes[j];
                        switch(attribute.name) {
                            // phantom_assassin_coup_de_grace,brewmaster_drunken_brawler,chaos_knight_chaos_strike,lycan_shapeshift,skeleton_king_mortal_strike
                            case 'crit_chance':
                                totalAttribute *= (1 - self.getAbilityAttributeValue(self.abilities()[i].attributes, attribute.name, ability.level())/100);
                            break;
                        }
                    }
                }
            }
        }
        return totalAttribute;
    });            
    
    self.getEvasion = ko.computed(function () {
        var totalAttribute = 1;
        for (var i = 0; i < self.abilities().length; i++) {
            var ability = self.abilities()[i];
            if (!(ability.name in self.abilityData)) {
                if (ability.level() > 0 && (ability.isActive() || (ability.behavior.indexOf('DOTA_ABILITY_BEHAVIOR_PASSIVE') != -1))) {
                    for (var j = 0; j < self.abilities()[i].attributes.length; j++) {
                        var attribute = self.abilities()[i].attributes[j];
                        switch(attribute.name) {
                            // phantom_assassin_blur
                            case 'bonus_evasion':
                            // brewmaster_drunken_brawler
                            case 'dodge_chance':
                                totalAttribute *= (1 - self.getAbilityAttributeValue(self.abilities()[i].attributes, attribute.name, ability.level())/100);
                            break;
                        }
                    }
                }
            }
        }
        return totalAttribute;
    });
    
    self.getEvasionBacktrack = ko.computed(function () {
        var totalAttribute = 1;
        for (var i = 0; i < self.abilities().length; i++) {
            var ability = self.abilities()[i];
            if (!(ability.name in self.abilityData)) {
                if (ability.level() > 0 && (ability.isActive() || (ability.behavior.indexOf('DOTA_ABILITY_BEHAVIOR_PASSIVE') != -1))) {
                    for (var j = 0; j < self.abilities()[i].attributes.length; j++) {
                        var attribute = self.abilities()[i].attributes[j];
                        switch(attribute.name) {
                            // faceless_void_backtrack
                            case 'dodge_chance_pct':
                                totalAttribute *= (1 - self.getAbilityAttributeValue(self.abilities()[i].attributes, attribute.name, ability.level())/100);
                            break;
                        }
                    }
                }
            }
        }
        return totalAttribute;
    });
    
    self.getMissChance = ko.computed(function () {
        var totalAttribute = 1;
        for (var i = 0; i < self.abilities().length; i++) {
            var ability = self.abilities()[i];
            if (!(ability.name in self.abilityData)) {
                if (ability.level() > 0 && (ability.isActive() || (ability.behavior.indexOf('DOTA_ABILITY_BEHAVIOR_PASSIVE') != -1))) {
                    for (var j = 0; j < self.abilities()[i].attributes.length; j++) {
                        var attribute = self.abilities()[i].attributes[j];
                        switch(attribute.name) {
                            // broodmother_incapacitating_bite,brewmaster_drunken_haze
                            case 'miss_chance':
                            // riki_smoke_screen,keeper_of_the_light_blinding_light,tinker_laser
                            case 'miss_rate':
                                totalAttribute *= (1 - self.getAbilityAttributeValue(self.abilities()[i].attributes, attribute.name, ability.level())/100);
                            break;
                        }
                    }
                }
            }
            else if (ability.missChance != undefined) {
                if (ability.level() > 0 && (ability.isActive() || (ability.behavior.indexOf('DOTA_ABILITY_BEHAVIOR_PASSIVE') != -1))) {
                    // night_stalker_crippling_fear
                    totalAttribute*=(1-ability.missChance()/100);
                }
            }
        }
        return totalAttribute;
    });
    
    self.getLifesteal = ko.computed(function () {
        var totalAttribute = 0;
        for (var i = 0; i < self.abilities().length; i++) {
            var ability = self.abilities()[i];
            if (!(ability.name in self.abilityData)) {
                if (ability.level() > 0 && (ability.isActive() || (ability.behavior.indexOf('DOTA_ABILITY_BEHAVIOR_PASSIVE') != -1))) {
                    for (var j = 0; j < self.abilities()[i].attributes.length; j++) {
                        var attribute = self.abilities()[i].attributes[j];
                        switch(attribute.name) {
                            // skeleton_king_vampiric_aura
                            case 'vampiric_aura':
                            // broodmother_insatiable_hunger
                            case 'lifesteal_pct':
                                totalAttribute += self.getAbilityAttributeValue(self.abilities()[i].attributes, attribute.name, ability.level());
                            break;
                        }
                    }
                }
            }
            else if (ability.lifesteal != undefined) {
                if (ability.level() > 0 && (ability.isActive() || (ability.behavior.indexOf('DOTA_ABILITY_BEHAVIOR_PASSIVE') != -1))) {
                    // life_stealer_open_wounds
                    totalAttribute+=ability.lifesteal();
                }
            }
        }
        return totalAttribute;
    });
    
    self.getMagicResist = ko.computed(function () {
        var totalAttribute = 1;
        for (var i = 0; i < self.abilities().length; i++) {
            var ability = self.abilities()[i];
            if (!(ability.name in self.abilityData)) {
                if (ability.level() > 0 && (ability.isActive() || (ability.behavior.indexOf('DOTA_ABILITY_BEHAVIOR_PASSIVE') != -1))) {
                    for (var j = 0; j < self.abilities()[i].attributes.length; j++) {
                        var attribute = self.abilities()[i].attributes[j];
                        switch(attribute.name) {
                            // antimage_spell_shield
                            case 'spell_shield_resistance':
                                totalAttribute *= (1 - self.getAbilityAttributeValue(self.abilities()[i].attributes, attribute.name, ability.level())/100);
                            break;
                            // phantom_lancer_phantom_edge
                            case 'magic_resistance_pct':
                                if (ability.name == 'phantom_lancer_phantom_edge') {
                                    totalAttribute *= (1 - self.getAbilityAttributeValue(self.abilities()[i].attributes, attribute.name, ability.level())/100);
                                }
                            break;
                            // rubick_null_field
                            case 'magic_damage_reduction_pct':
                                if (ability.name == 'rubick_null_field') {
                                    totalAttribute *= (1 - self.getAbilityAttributeValue(self.abilities()[i].attributes, attribute.name, ability.level())/100);
                                }
                            break;
                        }
                    }
                }
            }
            else if (ability.magicResist != undefined) {
                if (ability.level() > 0 && (ability.isActive() || (ability.behavior.indexOf('DOTA_ABILITY_BEHAVIOR_PASSIVE') != -1))) {
                    // huskar_berserkers_blood,viper_corrosive_skin,visage_gravekeepers_cloak
                    totalAttribute *= (1 - ability.magicResist()/100);
                }
            }
        }
        return totalAttribute;
    });

    self.getMagicResistReduction = ko.computed(function () {
        var totalAttribute = 1;
        for (var i = 0; i < self.abilities().length; i++) {
            var ability = self.abilities()[i];
            if (!(ability.name in self.abilityData)) {
                if (ability.level() > 0 && (ability.isActive() || (ability.behavior.indexOf('DOTA_ABILITY_BEHAVIOR_PASSIVE') != -1))) {
                    for (var j = 0; j < self.abilities()[i].attributes.length; j++) {
                        var attribute = self.abilities()[i].attributes[j];
                        switch(attribute.name) {
                            // ancient_apparition_ice_vortex
                            case 'spell_resist_pct':
                            // pugna_decrepify
                            case 'bonus_spell_damage_pct':
                            // skywrath_mage_ancient_seal
                            case 'resist_debuff':
                                totalAttribute *= (1 - self.getAbilityAttributeValue(self.abilities()[i].attributes, attribute.name, ability.level())/100);
                            break;
                            // elder_titan_natural_order
                            case 'magic_resistance_pct':
                                totalAttribute *= (1 - self.getAbilityAttributeValue(self.abilities()[i].attributes, attribute.name, ability.level())/100);
                            break;
                        }
                    }
                }
            }
        }
        return totalAttribute;
    });
    
    self.getMovementSpeedFlat = ko.computed(function () {
        var totalAttribute = 0;
        for (var i = 0; i < self.abilities().length; i++) {
            var ability = self.abilities()[i];
            if (!(ability.name in self.abilityData)) {
                if (ability.level() > 0 && (ability.isActive() || (ability.behavior.indexOf('DOTA_ABILITY_BEHAVIOR_PASSIVE') != -1))) {
                    for (var j = 0; j < self.abilities()[i].attributes.length; j++) {
                        var attribute = self.abilities()[i].attributes[j];
                        switch(attribute.name) {
                            // alchemist_chemical_rage
                            case 'bonus_movespeed':
                                if (ability.name == 'alchemist_chemical_rage') {
                                    totalAttribute += self.getAbilityAttributeValue(self.abilities()[i].attributes, attribute.name, ability.level());
                                }
                            break;
                            // tiny_grow
                            case 'bonus_movement_speed':
                                if (ability.name == 'tiny_grow') {
                                    totalAttribute += self.getAbilityAttributeValue(self.abilities()[i].attributes, attribute.name, ability.level());
                                }
                            break;
                            // troll_warlord_berserkers_rage
                            case 'bonus_move_speed':
                                if (ability.name == 'troll_warlord_berserkers_rage') {
                                    totalAttribute += self.getAbilityAttributeValue(self.abilities()[i].attributes, attribute.name, ability.level());
                                }                                
                            break;
                            // lone_druid_true_form
                            case 'speed_loss':
                                totalAttribute -= self.getAbilityAttributeValue(self.abilities()[i].attributes, attribute.name, ability.level());
                            break;
                        }
                    }
                }
            }
            else if (ability.movementSpeedFlat != undefined) {
                // dragon_knight_elder_dragon_form
                if (ability.level() > 0 && (ability.isActive() || (ability.behavior.indexOf('DOTA_ABILITY_BEHAVIOR_PASSIVE') != -1))) {
                    totalAttribute+=ability.movementSpeedFlat();
                }
            }
        }
        return totalAttribute;
    });
    
    self.getMovementSpeedPercent = ko.computed(function () {
        var totalAttribute = 0;
        for (var i = 0; i < self.abilities().length; i++) {
            var ability = self.abilities()[i];
            if (!(ability.name in self.abilityData)) {
                if (ability.level() > 0 && (ability.isActive() || (ability.behavior.indexOf('DOTA_ABILITY_BEHAVIOR_PASSIVE') != -1))) {
                    for (var j = 0; j < self.abilities()[i].attributes.length; j++) {
                        var attribute = self.abilities()[i].attributes[j];
                        switch(attribute.name) {
                            // abaddon_frostmourne 
                            case 'move_speed_pct':
                            // bounty_hunter_track 
                            case 'bonus_move_speed_pct':
                            // mirana_leap 
                            case 'leap_speedbonus':
                            // sven_warcry 
                            case 'warcry_movespeed':
                            // clinkz_wind_walk
                            case 'move_speed_bonus_pct':
                            // windrunner_windrun
                            case 'movespeed_bonus_pct':
                                totalAttribute += self.getAbilityAttributeValue(self.abilities()[i].attributes, attribute.name, ability.level())/100;
                            break;
                            // broodmother_spin_web,spectre_spectral_dagger
                            case 'bonus_movespeed':
                                if (ability.name == 'broodmother_spin_web' || ability.name == 'spectre_spectral_dagger') {
                                    totalAttribute += self.getAbilityAttributeValue(self.abilities()[i].attributes, attribute.name, ability.level())/100;
                                }
                            break;
                            // axe_culling_blade,necronomicon_archer_aoe
                            case 'speed_bonus':
                                if (ability.name == 'axe_culling_blade' || ability.name == 'necronomicon_archer_aoe') {
                                    totalAttribute += self.getAbilityAttributeValue(self.abilities()[i].attributes, attribute.name, ability.level())/100;
                                }
                            break;
                            // nyx_assassin_vendetta 
                            case 'movement_speed':
                                if (ability.name == 'nyx_assassin_vendetta') {
                                    totalAttribute += self.getAbilityAttributeValue(self.abilities()[i].attributes, attribute.name, ability.level())/100;
                                }
                            break;
                            // spirit_breaker_empowering_haste
                            case 'bonus_movespeed_pct':
                                if (ability.name == 'spirit_breaker_empowering_haste') {
                                    totalAttribute += self.getAbilityAttributeValue(self.abilities()[i].attributes, attribute.name, ability.level())/100;
                                }
                            break;
                            // ogre_magi_bloodlust,death_prophet_witchcraft,kobold_taskmaster_speed_aura
                            case 'bonus_movement_speed':
                                if (ability.name == 'ogre_magi_bloodlust' || ability.name == 'death_prophet_witchcraft' || ability.name == 'kobold_taskmaster_speed_aura') {
                                    totalAttribute += self.getAbilityAttributeValue(self.abilities()[i].attributes, attribute.name, ability.level())/100;
                                }
                            break;
                            // razor_unstable_current,phantom_lancer_doppelwalk
                            case 'movement_speed_pct':
                                if (ability.name == 'razor_unstable_current' || ability.name == 'phantom_lancer_doppelwalk') {
                                    totalAttribute += self.getAbilityAttributeValue(self.abilities()[i].attributes, attribute.name, ability.level())/100;
                                }
                            break;
                            // treant_natures_guise,lone_druid_rabid
                            case 'bonus_move_speed':
                                if (ability.name == 'treant_natures_guise' || ability.name == 'lone_druid_rabid') {
                                    totalAttribute += self.getAbilityAttributeValue(self.abilities()[i].attributes, attribute.name, ability.level())/100;
                                }
                            break;
                            // wisp_tether
                            case 'movespeed':
                                if (ability.name == 'wisp_tether') {
                                    totalAttribute += self.getAbilityAttributeValue(self.abilities()[i].attributes, attribute.name, ability.level())/100;
                                }
                            break;
                            // kunkka_ghostship,visage_grave_chill
                            case 'movespeed_bonus':
                                if (ability.name == 'kunkka_ghostship' || ability.name == 'visage_grave_chill') {
                                    totalAttribute += self.getAbilityAttributeValue(self.abilities()[i].attributes, attribute.name, ability.level())/100;
                                }                                
                            break;
                        }
                    }
                }
            }
            else if (ability.movementSpeedPct != undefined) {
                // axe_battle_hunger,bristleback_warpath,spirit_breaker_greater_bash,lina_fiery_soul,invoker_ghost_walk,invoker_wex,elder_titan_ancestral_spirit
                if (ability.level() > 0 && (ability.isActive() || (ability.behavior.indexOf('DOTA_ABILITY_BEHAVIOR_PASSIVE') != -1))) {
                    totalAttribute+=ability.movementSpeedPct()/100;
                }
            }
        }
        return totalAttribute;
    });

    self.getMovementSpeedPercentReduction = ko.computed(function () {
        var totalAttribute = 0;
        for (var i = 0; i < self.abilities().length; i++) {
            var ability = self.abilities()[i];
            if (!(ability.name in self.abilityData)) {
                if (ability.level() > 0 && (ability.isActive() || (ability.behavior.indexOf('DOTA_ABILITY_BEHAVIOR_PASSIVE') != -1))) {
                    for (var j = 0; j < self.abilities()[i].attributes.length; j++) {
                        var attribute = self.abilities()[i].attributes[j];
                        switch(attribute.name) {
                            // crystal_maiden_freezing_field
                            case 'movespeed_slow':
                                if (ability.name == 'crystal_maiden_freezing_field' && !self.hasScepter()) {
                                    totalAttribute += self.getAbilityAttributeValue(self.abilities()[i].attributes, attribute.name, ability.level())/100;
                                }
                            break;
                            case 'movespeed_slow_scepter':
                                if (ability.name == 'crystal_maiden_freezing_field' && self.hasScepter()) {
                                    totalAttribute += self.getAbilityAttributeValue(self.abilities()[i].attributes, attribute.name, ability.level())/100;
                                }
                            break;
                            // elder_titan_earth_splitter,magnataur_skewer,abaddon_frostmourne 
                            case 'slow_pct':
                                totalAttribute -= self.getAbilityAttributeValue(self.abilities()[i].attributes, attribute.name, ability.level())/100;
                            break;
                            // night_stalker_void,crystal_maiden_crystal_nova,ghost_frost_attack,ogre_magi_frost_armor,polar_furbolg_ursa_warrior_thunder_clap
                            case 'movespeed_slow':
                                if (ability.name != 'crystal_maiden_freezing_field') {
                                    totalAttribute += self.getAbilityAttributeValue(self.abilities()[i].attributes, attribute.name, ability.level())/100;
                                }
                            break;
                            // lich_frost_armor,lich_frost_nova,enchantress_enchant
                            case 'slow_movement_speed':
                            // beastmaster_primal_roar
                            case 'slow_movement_speed_pct':
                            // drow_ranger_frost_arrows
                            case 'frost_arrows_movement_speed':
                            // skeleton_king_hellfire_blast
                            case 'blast_slow':
                            // slardar_slithereen_crush
                            case 'crush_extra_slow':
                            // storm_spirit_overload:
                            case 'overload_move_slow':
                            // windrunner_windrun
                            case 'enemy_movespeed_bonus_pct':
                                totalAttribute += self.getAbilityAttributeValue(self.abilities()[i].attributes, attribute.name, ability.level())/100;
                            break;
                            // phantom_assassin_stifling_dagger,tusk_frozen_sigil
                            case 'move_slow':
                                if (ability.name == 'phantom_assassin_stifling_dagger') {
                                    totalAttribute += self.getAbilityAttributeValue(self.abilities()[i].attributes, attribute.name, ability.level())/100;
                                }
                                else if (ability.name == 'tusk_frozen_sigil') {
                                    totalAttribute -= self.getAbilityAttributeValue(self.abilities()[i].attributes, attribute.name, ability.level())/100;
                                }
                            break;
                            // invoker_ice_wall,medusa_stone_gaze,wisp_tether
                            case 'slow':
                                if (ability.name == 'medusa_stone_gaze') {
                                    totalAttribute -= self.getAbilityAttributeValue(self.abilities()[i].attributes, attribute.name, ability.level())/100;
                                }
                                else {
                                    totalAttribute += self.getAbilityAttributeValue(self.abilities()[i].attributes, attribute.name, ability.level())/100;
                                }
                            break;
                            // broodmother_incapacitating_bite,bounty_hunter_jinada,spectre_spectral_dagger,winter_wyvern_arctic_burn
                            case 'bonus_movespeed':
                                if (ability.name == 'broodmother_incapacitating_bite' || ability.name == 'bounty_hunter_jinada' || ability.name == 'winter_wyvern_arctic_burn' || ability.name == 'winter_wyvern_splinter_blast') {
                                    totalAttribute += self.getAbilityAttributeValue(self.abilities()[i].attributes, attribute.name, ability.level())/100;
                                }
                                else if (ability.name == 'spectre_spectral_dagger') {
                                    totalAttribute -= self.getAbilityAttributeValue(self.abilities()[i].attributes, attribute.name, ability.level())/100;
                                }
                            break;
                            // omniknight_degen_aura
                            case 'speed_bonus':
                                if (ability.name == 'omniknight_degen_aura') {
                                    totalAttribute += self.getAbilityAttributeValue(self.abilities()[i].attributes, attribute.name, ability.level())/100;
                                }
                            break;
                            // tidehunter_gush
                            case 'movement_speed':
                                if (ability.name == 'tidehunter_gush') {
                                    totalAttribute += self.getAbilityAttributeValue(self.abilities()[i].attributes, attribute.name, ability.level())/100;
                                }
                            break;
                            // pugna_decrepify,chen_penitence
                            case 'bonus_movement_speed':
                                if (ability.name == 'pugna_decrepify' || ability.name == 'chen_penitence') {
                                    totalAttribute += self.getAbilityAttributeValue(self.abilities()[i].attributes, attribute.name, ability.level())/100;
                                }
                            break;
                            // ancient_apparition_ice_vortex,phantom_lancer_spirit_lance,skywrath_mage_concussive_shot,faceless_void_time_walk
                            case 'movement_speed_pct':
                                if (ability.name == 'ancient_apparition_ice_vortex' || ability.name == 'phantom_lancer_spirit_lance' || ability.name == 'faceless_void_time_walk') {
                                    totalAttribute += self.getAbilityAttributeValue(self.abilities()[i].attributes, attribute.name, ability.level())/100;
                                }
                                else if (ability.name == 'skywrath_mage_concussive_shot') {
                                    totalAttribute -= self.getAbilityAttributeValue(self.abilities()[i].attributes, attribute.name, ability.level())/100;
                                }
                            break;
                            // razor_unstable_current
                            case 'slow_amount':
                                if (ability.name == 'razor_unstable_current') {
                                    totalAttribute += self.getAbilityAttributeValue(self.abilities()[i].attributes, attribute.name, ability.level())/100;
                                }
                            break;
                            // brewmaster_drunken_haze,brewmaster_thunder_clap,treant_leech_seed
                            case 'movement_slow':
                                if (ability.name == 'brewmaster_drunken_haze' || ability.name == 'brewmaster_thunder_clap') {
                                    totalAttribute -= self.getAbilityAttributeValue(self.abilities()[i].attributes, attribute.name, ability.level())/100;
                                }
                                else if (ability.name == 'ursa_earthshock' || ability.name == 'treant_leech_seed') {
                                    totalAttribute += self.getAbilityAttributeValue(self.abilities()[i].attributes, attribute.name, ability.level())/100;
                                }
                            break;
                            // skeleton_king_reincarnation
                            case 'movespeed':
                                if (ability.name == 'skeleton_king_reincarnation') {
                                    totalAttribute += self.getAbilityAttributeValue(self.abilities()[i].attributes, attribute.name, ability.level())/100;
                                }
                            break;
                            // kunkka_torrent,visage_grave_chill
                            case 'movespeed_bonus':
                                if (ability.name == 'kunkka_torrent') {
                                    totalAttribute += self.getAbilityAttributeValue(self.abilities()[i].attributes, attribute.name, ability.level())/100;
                                }
                                else if (ability.name == 'visage_grave_chill') {
                                    totalAttribute -= self.getAbilityAttributeValue(self.abilities()[i].attributes, attribute.name, ability.level())/100;
                                }
                            break;
                        }
                    }
                    if (ability.name == 'satyr_trickster_purge') {
                        totalAttribute -= 80/100;
                    }
                    else if (ability.name == 'enraged_wildkin_tornado') {
                        totalAttribute -= 15/100;
                    }
                }
            }
            else if (ability.movementSpeedPctReduction != undefined) {
                if (ability.level() > 0 && (ability.isActive() || (ability.behavior.indexOf('DOTA_ABILITY_BEHAVIOR_PASSIVE') != -1))) {
                    // axe_battle_hunger,batrider_sticky_napalm,shredder_chakram,meepo_geostrike,life_stealer_open_wounds,
                    // venomancer_poison_sting,viper_viper_strike,viper_corrosive_skin,viper_poison_attack,venomancer_venomous_gale,treant_leech_seed
                    // lich_chain_frost,sniper_shrapnel,centaur_stampede,huskar_life_break,jakiro_dual_breath,meepo_geostrike,sandking_epicenter
                    // earth_spirit_rolling_boulder,invoker_ghost_walk,invoker_ice_wall,elder_titan_earth_splitter
                    // undying_flesh_golem,templar_assassin_psionic_trap,nevermore_requiem,queenofpain_shadow_strike
                    totalAttribute+=ability.movementSpeedPctReduction()/100;
                }
            }
        }
        return totalAttribute;
    });

    self.getTurnRateReduction = ko.computed(function () {
        var totalAttribute = 0;
        for (var i = 0; i < self.abilities().length; i++) {
            var ability = self.abilities()[i];
            if (!(ability.name in self.abilityData)) {
                if (ability.level() > 0 && (ability.isActive() || (ability.behavior.indexOf('DOTA_ABILITY_BEHAVIOR_PASSIVE') != -1))) {
                    for (var j = 0; j < self.abilities()[i].attributes.length; j++) {
                        var attribute = self.abilities()[i].attributes[j];
                        switch(attribute.name) {
                            // medusa_stone_gaze
                            case 'slow':
                                if (ability.name == 'medusa_stone_gaze') {
                                    totalAttribute -= self.getAbilityAttributeValue(self.abilities()[i].attributes, attribute.name, ability.level())/100;
                                }
                            break;
                        }
                    }
                }
            }
            else if (ability.turnRateReduction != undefined) {
                if (ability.level() > 0 && (ability.isActive() || (ability.behavior.indexOf('DOTA_ABILITY_BEHAVIOR_PASSIVE') != -1))) {
                    // batrider_sticky_napalm
                    totalAttribute+=ability.turnRateReduction()/100;
                }
            }
        }
        return totalAttribute;
    });
    
    self.getVisionRangeNight = ko.computed(function () {
        var totalAttribute = 0;
        for (var i = 0; i < self.abilities().length; i++) {
            var ability = self.abilities()[i];
            if (!(ability.name in self.abilityData)) {
                if (ability.level() > 0 && (ability.isActive() || (ability.behavior.indexOf('DOTA_ABILITY_BEHAVIOR_PASSIVE') != -1))) {
                    for (var j = 0; j < self.abilities()[i].attributes.length; j++) {
                        var attribute = self.abilities()[i].attributes[j];
                        switch(attribute.name) {
                            // winter_wyvern_arctic_burn
                            case 'night_vision_bonus':
                            // lycan_shapeshift,luna_lunar_blessing
                            case 'bonus_night_vision':
                                totalAttribute += self.getAbilityAttributeValue(self.abilities()[i].attributes, attribute.name, ability.level());
                            break;
                        }
                    }
                }
            }
            else if (ability.visionnight != undefined) {
                if (ability.level() > 0 && (ability.isActive() || (ability.behavior.indexOf('DOTA_ABILITY_BEHAVIOR_PASSIVE') != -1))) {
                    // 
                    totalAttribute+=ability.visionnight();
                }
            }
        }
        return totalAttribute;
    });

    self.getVisionRangePctReduction = ko.computed(function () {
        var totalAttribute = 0;
        for (var i = 0; i < self.abilities().length; i++) {
            var ability = self.abilities()[i];
            if (!(ability.name in self.abilityData)) {
                if (ability.level() > 0 && (ability.isActive() || (ability.behavior.indexOf('DOTA_ABILITY_BEHAVIOR_PASSIVE') != -1))) {
                    for (var j = 0; j < self.abilities()[i].attributes.length; j++) {
                        var attribute = self.abilities()[i].attributes[j];
                        switch(attribute.name) {
                            // night_stalker_darkness
                            case 'blind_percentage':
                                totalAttribute += self.getAbilityAttributeValue(self.abilities()[i].attributes, attribute.name, ability.level())/100;
                            break;
                        }
                    }
                }
            }
        }
        return totalAttribute;
    });

    self.setEvasion = ko.computed(function () {
        var totalAttribute = 0;
        for (var i = 0; i < self.abilities().length; i++) {
            var ability = self.abilities()[i];
            if (ability.level() > 0 && (ability.isActive() || (ability.behavior.indexOf('DOTA_ABILITY_BEHAVIOR_PASSIVE') != -1))) {
                if (ability.name == 'windrunner_windrun') {
                    return 1;
                }
            }
        }
        return totalAttribute;
    });
    
    self.setMovementSpeed = ko.computed(function () {
        var MAX_MOVESPEED = 522;
        var MIN_MOVESPEED = 100;
        var totalAttribute = 0;
        for (var i = 0; i < self.abilities().length; i++) {
            var ability = self.abilities()[i];
            if (ability.level() > 0 && (ability.isActive() || (ability.behavior.indexOf('DOTA_ABILITY_BEHAVIOR_PASSIVE') != -1))) {
                if (ability.name == 'spirit_breaker_charge_of_darkness') {
                    return self.getAbilityAttributeValue(ability.attributes, 'movement_speed', ability.level());
                }
                if (ability.name == 'dark_seer_surge') {
                    return MAX_MOVESPEED;
                }
                if (ability.name == 'centaur_stampede') {
                    return MAX_MOVESPEED;
                }
                if (ability.name == 'lycan_shapeshift') {
                    return MAX_MOVESPEED;
                }
                if (ability.name == 'lion_voodoo' || ability.name == 'shadow_shaman_voodoo') {
                    return MIN_MOVESPEED;
                }
            }
        }
        return totalAttribute;
    });

    self.getBashSource = function (attacktype) {
        var sources = {};
        for (var i = 0; i < self.abilities().length; i++) {
            var ability = self.abilities()[i];
            if (!(ability.name in self.abilityData)) {
                if (ability.level() > 0 && (ability.isActive() || (ability.behavior.indexOf('DOTA_ABILITY_BEHAVIOR_PASSIVE') != -1))) {
                    for (var j = 0; j < self.abilities()[i].attributes.length; j++) {
                        var attribute = self.abilities()[i].attributes[j];
                        switch(attribute.name) {
                            // sniper_headshot
                            case 'proc_chance':
                                if (sources[ability.name] == undefined && ability.name == 'sniper_headshot') {
                                    sources[ability.name] = {
                                        'chance': self.getAbilityAttributeValue(ability.attributes, attribute.name, ability.level())/100,
                                        'damage': self.getAbilityPropertyValue(ability, 'damage'),
                                        'count': 1,
                                        'damageType': 'physical',
                                        'displayname': ability.displayname
                                    }
                                }
                            break;
                            // slardar_bash
                            case 'chance':
                                if (sources[ability.name] == undefined && ability.name == 'slardar_bash') {
                                    sources[ability.name] = {
                                        'chance': self.getAbilityAttributeValue(ability.attributes, attribute.name, ability.level())/100,
                                        'damage': self.getAbilityAttributeValue(ability.attributes, 'bonus_damage', ability.level()),
                                        'count': 1,
                                        'damageType': 'physical',
                                        'displayname': ability.displayname
                                    }
                                }
                            break;
                        }
                    }
                }
            }
            else if (ability.bashBonusDamage != undefined) {
                if (ability.level() > 0 && (ability.isActive() || (ability.behavior.indexOf('DOTA_ABILITY_BEHAVIOR_PASSIVE') != -1))) {
                    // faceless_void_time_lock
                    if (sources[ability.name] == undefined && ability.name == 'faceless_void_time_lock') {
                        sources[ability.name] = {
                            'chance': ability.bash()/100,
                            'damage': ability.bashBonusDamage(),
                            'count': 1,
                            'damageType': 'magic',
                            'displayname': ability.displayname
                        }
                    }
                    // spirit_breaker_greater_bash
                    if (sources[ability.name] == undefined && ability.name == 'spirit_breaker_greater_bash') {
                        sources[ability.name] = {
                            'chance': ability.bash()/100,
                            'damage': ability.bashBonusDamage()/100,
                            'count': 1,
                            'damageType': 'magic',
                            'displayname': ability.displayname
                        }
                    }
                }
            }
        }

        return sources;
    };
    
    self.getOrbSource = function () {
        var sources = {};
        for (var i = 0; i < self.abilities().length; i++) {
            var ability = self.abilities()[i];
            if (!(ability.name in self.abilityData)) {
                if (ability.level() > 0 && (ability.isActive() || (ability.behavior.indexOf('DOTA_ABILITY_BEHAVIOR_PASSIVE') != -1))) {
                    for (var j = 0; j < self.abilities()[i].attributes.length; j++) {
                        var attribute = self.abilities()[i].attributes[j];
                        switch(attribute.name) {
                            // antimage_mana_break
                            case 'mana_per_hit':
                                if (sources[ability.name] == undefined && ability.name == 'antimage_mana_break') {
                                    sources[ability.name] = {
                                        'damage': self.getAbilityAttributeValue(ability.attributes, attribute.name, ability.level()) 
                                                * self.getAbilityAttributeValue(ability.attributes, 'damage_per_burn', ability.level()),
                                        'damageType': 'physical',
                                        'displayname': ability.displayname
                                    }
                                }
                            break;
                            // clinkz_searing_arrows
                            case 'damage_bonus':
                                if (sources[ability.name] == undefined && ability.name == 'clinkz_searing_arrows') {
                                    sources[ability.name] = {
                                        'damage': self.getAbilityAttributeValue(ability.attributes, attribute.name, ability.level()),
                                        'damageType': 'physical',
                                        'displayname': ability.displayname
                                    }
                                }
                            // silencer_glaives_of_wisdom
                            case 'intellect_damage_pct':
                                if (sources[ability.name] == undefined && ability.name == 'silencer_glaives_of_wisdom') {
                                    sources[ability.name] = {
                                        'damage': self.getAbilityAttributeValue(ability.attributes, attribute.name, ability.level())/100 * self.hero.totalInt(),
                                        'damageType': 'pure',
                                        'displayname': ability.displayname
                                    }
                                }
                            break;
                        }
                    }
                }
            }
            else if (ability.bonusDamageOrb != undefined) {
                if (ability.level() > 0 && (ability.isActive() || (ability.behavior.indexOf('DOTA_ABILITY_BEHAVIOR_PASSIVE') != -1))) {
                    // obsidian_destroyer_arcane_orb
                    if (sources[ability.name] == undefined && ability.name == 'obsidian_destroyer_arcane_orb') {
                        sources[ability.name] = {
                            'damage': ability.bonusDamageOrb(),
                            'damageType': 'pure',
                            'displayname': ability.displayname
                        }
                    }
                }
            }
        }
        
        return sources;
    };
    
    self.toggleAbility = function (index, data, event) {
        if (self.abilities()[index()].behavior.indexOf('DOTA_ABILITY_BEHAVIOR_PASSIVE') < 0) {
            if (self.abilities()[index()].isActive()) {
                self.abilities()[index()].isActive(false);
            }
            else {
                self.abilities()[index()].isActive(true);
            }
            
            if (self.abilities()[index()].name == 'lycan_shapeshift') {
                self.isShapeShiftActive(self.abilities()[index()].isActive());
            }
        }
    }.bind(this);

    self.toggleAbilityDetail = function (index, data, event) {
        if (self.abilities()[index()].isDetail()) {
            self.abilities()[index()].isDetail(false);
        }
        else {
            self.abilities()[index()].isDetail(true);
        }
    }.bind(this);
    
    self.getAbility = function (abilityName) {
        return self.abilities().find(function(b) {
            return b.name == abilityName;
        });
    }
}

my.prototype.AbilityModel.prototype.levelUpAbility = function (index, data, event, hero) {
    var self = this;
    if (self.abilities()[index()].level() < hero.getAbilityLevelMax(data) && hero.availableSkillPoints() > 0 ) {
        switch(self.abilities()[index()].abilitytype) {
            case 'DOTA_ABILITY_TYPE_ULTIMATE':
                if (hero.heroId() == 'invoker') {
                    if (
                        (self.abilities()[index()].level() == 0) && (parseInt(hero.selectedHeroLevel()) >= 2) ||
                        (self.abilities()[index()].level() == 1) && (parseInt(hero.selectedHeroLevel()) >= 7) ||
                        (self.abilities()[index()].level() == 2) && (parseInt(hero.selectedHeroLevel()) >= 11) ||
                        (self.abilities()[index()].level() == 3) && (parseInt(hero.selectedHeroLevel()) >= 17)
                    ) {
                        self.abilities()[index()].level(self.abilities()[index()].level()+1);
                        hero.skillPointHistory.push(index());
                    }
                }
                else if (hero.heroId() == 'meepo') {
                    if (self.abilities()[index()].level() * 7 + 3 <= parseInt(hero.selectedHeroLevel())) {
                        self.abilities()[index()].level(self.abilities()[index()].level()+1);
                        hero.skillPointHistory.push(index());
                    }
                }
                else {
                    if ((self.abilities()[index()].level()+1) * 5 + 1 <= parseInt(hero.selectedHeroLevel())) {
                        self.abilities()[index()].level(self.abilities()[index()].level()+1);
                        hero.skillPointHistory.push(index());
                    }
                }
            break;
            default:
                if (self.abilities()[index()].level() * 2 + 1 <= parseInt(hero.selectedHeroLevel())) {
                    self.abilities()[index()].level(self.abilities()[index()].level()+1);
                    hero.skillPointHistory.push(index());
                }
            break;
        }
        switch (self.abilities()[index()].name) {
            case 'beastmaster_call_of_the_wild':
            case 'chen_test_of_faith':
            case 'morphling_morph_agi':
            case 'shadow_demon_shadow_poison':
                self.abilities()[index() + 1].level(self.abilities()[index()].level());
            break;
            case 'morphling_morph_str':
                self.abilities()[index() - 1].level(self.abilities()[index()].level());
            break;
            case 'keeper_of_the_light_spirit_form':
                self.abilities()[index() - 1].level(self.abilities()[index()].level());
                self.abilities()[index() - 2].level(self.abilities()[index()].level());
            break;
            case 'nevermore_shadowraze1':
                self.abilities()[index() + 1].level(self.abilities()[index()].level());
                self.abilities()[index() + 2].level(self.abilities()[index()].level());
            break;
            case 'nevermore_shadowraze2':
                self.abilities()[index() - 1].level(self.abilities()[index()].level());
                self.abilities()[index() + 1].level(self.abilities()[index()].level());
            break;
            case 'nevermore_shadowraze3':
                self.abilities()[index() - 1].level(self.abilities()[index()].level());
                self.abilities()[index() - 2].level(self.abilities()[index()].level());
            break;
            case 'ember_spirit_fire_remnant':
                self.abilities()[index() - 1].level(self.abilities()[index()].level());
            break;
            case 'lone_druid_true_form':
                self.abilities()[index() - 1].level(self.abilities()[index()].level());
            break;
        }
    }
};
my.prototype.AbilityModel.prototype.levelDownAbility = function (index, data, event, hero) {
    var self = this;
    if (self.abilities()[index()].level() > 0) {
        self.abilities()[index()].level(self.abilities()[index()].level() - 1);
        hero.skillPointHistory.splice(hero.skillPointHistory().lastIndexOf(index()), 1);
        switch (self.abilities()[index()].name) {
            case 'beastmaster_call_of_the_wild':
            case 'chen_test_of_faith':
            case 'morphling_morph_agi':
            case 'shadow_demon_shadow_poison':
                self.abilities()[index() + 1].level(self.abilities()[index()].level());
            break;
            case 'morphling_morph_str':
                self.abilities()[index() - 1].level(self.abilities()[index()].level());
            break;
            case 'keeper_of_the_light_spirit_form':
                self.abilities()[index() - 1].level(self.abilities()[index()].level());
                self.abilities()[index() - 2].level(self.abilities()[index()].level());
            break;
            case 'nevermore_shadowraze1':
                self.abilities()[index() + 1].level(self.abilities()[index()].level());
                self.abilities()[index() + 2].level(self.abilities()[index()].level());
            break;
            case 'nevermore_shadowraze2':
                self.abilities()[index() - 1].level(self.abilities()[index()].level());
                self.abilities()[index() + 1].level(self.abilities()[index()].level());
            break;
            case 'nevermore_shadowraze3':
                self.abilities()[index() - 1].level(self.abilities()[index()].level());
                self.abilities()[index() - 2].level(self.abilities()[index()].level());
            break;
            case 'ember_spirit_fire_remnant':
                self.abilities()[index() - 1].level(self.abilities()[index()].level());
            break;
            case 'lone_druid_true_form':
                self.abilities()[index() - 1].level(self.abilities()[index()].level());
            break;
        }
    }
};
},{"./herocalc_core":47,"./herocalc_knockout":53}],45:[function(require,module,exports){
'use strict';
    
var my = require("./herocalc_core");

my.prototype.abilityData = {
    'alchemist_acid_spray': [
        {
            label: 'Duration',
            controlType: 'input'
        },
        {
            attributeName: 'damage',
            label: 'Total Damage',
            controlType: 'text',
            fn: function (v, a, parent, index, abilityModel, ability) {
                return v*a;
            }
        },
        {
            attributeName: 'armor_reduction',
            label: 'Total Damage',
            controlType: 'text',
            fn: function (v, a, parent, index, abilityModel, ability) {
                return -a;
            },
            returnProperty: 'armorReduction'
        }
    ],
    'alchemist_unstable_concoction': [
        {
            label: 'Brew Time',
            controlType: 'input'
        },
        {
            attributeName: 'max_damage',
            label: 'Total Damage',
            controlType: 'text',
            fn: function (v, a, parent, index, abilityModel, ability) {
                return v*a/5;
            }
        },
        {
            attributeName: 'max_stun',
            label: 'Total Stun',
            controlType: 'text',
            fn: function (v, a, parent, index, abilityModel, ability) {
                return v*a/5;
            }
        }
    ],
    'ancient_apparition_cold_feet': [
        {
            label: 'Duration',
            controlType: 'input'
        },
        {
            attributeName: 'damage',
            label: 'Total Damage',
            controlType: 'text',
            fn: function (v, a, parent, index, abilityModel, ability) {
                return v*a;
            }
        },
        {
            attributeName: 'stun_duration',
            label: 'Total Stun',
            controlType: 'text',
            fn: function (v, a, parent, index, abilityModel, ability) {
                return a;
            }
        }
    ],
    'ancient_apparition_ice_blast': [
        {
            label: 'Duration',
            controlType: 'input'
        },
        {
            attributeName: 'dot_damage',
            label: 'Total Damage',
            controlType: 'text',
            fn: function (v, a, parent, index, abilityModel, ability) {
                return abilityModel.getAbilityPropertyValue(ability, 'damage')+v*a;
            }
        }
    ],
    'antimage_mana_void': [
        {
            label: 'Enemy Missing Mana',
            controlType: 'input'
        },
        {
            attributeName: 'mana_void_damage_per_mana',
            label: 'Total Damage',
            controlType: 'text',
            fn: function (v, a, parent, index, abilityModel, ability) {
                return v*a;
            }
        }
    ],
    'axe_battle_hunger': [
        {
            label: 'Battle Hungered Enemies',
            controlType: 'input'
        },
        {
            attributeName: 'speed_bonus',
            label: 'Movement Speed Bonus',
            controlType: 'text',
            noLevel: true,
            fn: function (v, a, parent, index, abilityModel, ability) {
                return v*a;
            },
            returnProperty: 'movementSpeedPct'
        },
        {
            attributeName: 'slow',
            label: 'Movement Speed Bonus',
            controlType: 'text',
            noLevel: true,
            fn: function (v, a, parent, index, abilityModel, ability) {
                return a;
            },
            returnProperty: 'movementSpeedPctReduction'
        }
    ],
    'bane_nightmare': [
        {
            label: 'Duration',
            controlType: 'input'
        },
        {
            label: 'DAMAGE:',
            controlType: 'text',
            fn: function (v, a, parent, index, abilityModel, ability) {
                return abilityModel.getAbilityPropertyValue(ability, 'damage')*v;
            }
        }
    ],
    'bane_fiends_grip': [
        {
            label: 'Duration',
            controlType: 'input'
        },
        {
            label: 'Enemy Max Mana',
            controlType: 'input'
        },
        {
            attributeName: 'fiend_grip_damage',
            label: 'Total Damage',
            controlType: 'text',
            controls: [0,1],
            fn: function (v, a, parent, index, abilityModel, ability) {
                if (parent.inventory.hasScepter()) {
                    return v[0]*abilityModel.getAbilityAttributeValue(ability.attributes, 'fiend_grip_damage_scepter',ability.level());
                }
                else {
                    return v[0]*a;
                }
            }
        },
        {
            attributeName: 'fiend_grip_mana_drain',
            label: 'Total Mana Drain',
            controlType: 'text',
            controls: [0,1],
            noLevel: true,
            fn: function (v, a, parent, index, abilityModel, ability) {
                if (parent.inventory.hasScepter()) {
                    return v[0]*v[1]*abilityModel.getAbilityAttributeValue(ability.attributes, 'fiend_grip_mana_drain_scepter',ability.level())/100;
                }
                else {
                    return v[0]*v[1]*a/100;
                }
            }
        }
    ],
    'batrider_sticky_napalm': [
        {
            label: 'Stacks',
            controlType: 'input'
        },
        {
            attributeName: 'damage',
            label: 'Total Bonus Damage',
            controlType: 'text',
            fn: function (v, a, parent, index, abilityModel, ability) {
                return v*a;
            },
            returnProperty: 'bonusDamage'
        },
        {
            attributeName: 'movement_speed_pct',
            label: 'Enemy Movement Speed Slow',
            controlType: 'text',
            fn: function (v, a, parent, index, abilityModel, ability) {
                return v*a;
            },
            returnProperty: 'movementSpeedPctReduction'
        },
        {
            attributeName: 'turn_rate_pct',
            label: 'Enemy Turn Rate Slow',
            controlType: 'text',
            fn: function (v, a, parent, index, abilityModel, ability) {
                return a;
            },
            returnProperty: 'turnRateReduction'
        }
    ],
    'batrider_firefly': [
        {
            label: 'Duration',
            controlType: 'input'
        },
        {
            attributeName: 'damage_per_second',
            label: 'Total Damage',
            controlType: 'text',
            fn: function (v, a, parent, index, abilityModel, ability) {
                return v*a;
            }
        }
    ],
    'bloodseeker_rupture': [
        {
            label: 'Enemy Distance Traveled',
            controlType: 'input'
        },
        {
            attributeName: 'movement_damage_pct',
            label: 'DAMAGE:',
            ignoreTooltip: true,
            controlType: 'text',
            fn: function (v, a, parent, index, abilityModel, ability) {
                return abilityModel.getAbilityPropertyValue(ability, 'damage') + v*a/100;
            }
        }
    ],
    'bristleback_viscous_nasal_goo': [
        {
            label: 'Stacks',
            controlType: 'input'
        },
        {
            attributeName: 'armor_per_stack',
            label: 'Enemy Armor Reduction',
            controlType: 'text',
            fn: function (v, a, parent, index, abilityModel, ability) {
                return -v*a;
            },
            returnProperty: 'armorReduction'
        },
        {
            attributeName: 'move_slow_per_stack',
            label: '%SLOW:',
            ignoreTooltip: true,
            controlType: 'text',
            fn: function (v, a, parent, index, abilityModel, ability) {
                return -(abilityModel.getAbilityAttributeValue(ability.attributes, 'base_move_slow',0)+v*a);
            },
            returnProperty: 'movementSpeedPctReduction'
        }
    ],
    'bristleback_quill_spray': [
        {
            label: 'Stacks',
            controlType: 'input'
        },
        {
            attributeName: 'quill_stack_damage',
            label: 'DAMAGE',
            controlType: 'text',
            fn: function (v, a, parent, index, abilityModel, ability) {
                var total = abilityModel.getAbilityAttributeValue(ability.attributes, 'quill_base_damage',ability.level())+v*a,
                damage_cap = abilityModel.getAbilityAttributeValue(ability.attributes, 'max_damage',0);
                if (total > damage_cap) {
                    total = damage_cap;
                }
                return total;
            }
        }
    ],
    'bristleback_bristleback': [
        {
            label: 'Damage From',
            controlType: 'radio',
            controlValueType: 'string',
            controlOptions: [
                {text: 'Back', value: 'back'},
                {text: 'Side', value: 'side'}
            ]
        },
        {
            attributeName: 'back_damage_reduction',
            label: '%DAMAGE REDUCTION:',
            ignoreTooltip: true,
            controlType: 'text',
            fn: function (v, a, parent, index, abilityModel, ability) {
                var ability = abilityModel.abilities().find(function(b) {
                    return b.name == 'bristleback_bristleback';
                });
                if (v == 'back') {
                    var total = abilityModel.getAbilityAttributeValue(ability.attributes, 'back_damage_reduction', ability.level());
                }
                else {
                    var total = abilityModel.getAbilityAttributeValue(ability.attributes, 'side_damage_reduction', ability.level());
                }
                return -total;
            },
            returnProperty: 'damageReduction'
        }
    ],
    'bristleback_warpath': [
        {
            label: 'Stacks',
            controlType: 'input'
        },
        {
            attributeName: 'damage_per_stack',
            label: 'BONUS DAMAGE:',
            ignoreTooltip: true,
            controlType: 'text',
            fn: function (v, a, parent, index, abilityModel, ability) {
                if (v < 1) {
                    return 0;
                }
                else {
                    return abilityModel.getAbilityAttributeValue(ability.attributes, 'base_damage',ability.level())+(v-1)*a;
                }
            }
        },
        {
            attributeName: 'move_speed_per_stack',
            label: '%MOVEMENT:',
            ignoreTooltip: true,
            controlType: 'text',
            fn: function (v, a, parent, index, abilityModel, ability) {
                if (v < 1) {
                    return 0;
                }
                else {
                    return abilityModel.getAbilityAttributeValue(ability.attributes, 'base_move_speed',ability.level())+(v-1)*a;
                }
            },
            returnProperty: 'movementSpeedPct'
        }
    ],
    'centaur_return': [
        {
            label: 'Strength',
            controlType: 'input'
        },
        {
            attributeName: 'strength_pct',
            label: 'DAMAGE:',
            controlType: 'text',
            fn: function (v, a, parent, index, abilityModel, ability) {
                return abilityModel.getAbilityAttributeValue(ability.attributes, 'return_damage',ability.level()) + v*a/100;
            }
        }
    ],
    'centaur_stampede': [
        {
            label: 'Strength',
            controlType: 'input'
        },
        {
            attributeName: 'strength_damage',
            label: 'DAMAGE:',
            ignoreTooltip: true,
            controlType: 'text',
            fn: function (v, a, parent, index, abilityModel, ability) {
                return v*a;
            }
        },
        {
            attributeName: 'slow_movement_speed',
            label: 'Enemy Movement Speed Slow',
            controlType: 'text',
            fn: function (v, a, parent, index, abilityModel, ability) {
                return -a;
            },
            returnProperty: 'movementSpeedPctReduction'
        }
    ],
    'clinkz_death_pact': [
        {
            label: 'Consumed Unit HP',
            controlType: 'input'
        },
        {
            attributeName: 'damage_gain_pct',
            label: 'BASE DAMAGE GAIN:',
            ignoreTooltip: true,
            controlType: 'text',
            fn: function (v, a, parent, index, abilityModel, ability) {
                return v*a/100;
            },
            returnProperty: 'baseDamage'
        },
        {
            attributeName: 'health_gain_pct',
            label: 'HEALTH GAIN:',
            ignoreTooltip: true,
            controlType: 'text',
            fn: function (v, a, parent, index, abilityModel, ability) {
                return v*a/100;
            },
            returnProperty: 'bonusHealth'
        }
    ],
    'crystal_maiden_frostbite': [
        {
            label: 'Duration',
            controlType: 'input'
        },
        {
            label: 'DAMAGE:',
            controlType: 'text',
            fn: function (v, a, parent, index, abilityModel, ability) {
                return abilityModel.getAbilityPropertyValue(ability, 'damage')*v;
            }
        }
    ],
    'dark_seer_ion_shell': [
        {
            label: 'Duration',
            controlType: 'input'
        },
        {
            attributeName: 'damage_per_second',
            label: 'Total Damage',
            controlType: 'text',
            fn: function (v, a, parent, index, abilityModel, ability) {
                return v*a;
            }
        }
    ],
    'dazzle_shadow_wave': [
        {
            label: 'Targets',
            controlType: 'input'
        },
        {
            label: 'DAMAGE:',
            controlType: 'text',
            fn: function (v, a, parent, index, abilityModel, ability) {
                return abilityModel.getAbilityPropertyValue(ability, 'damage')*v;
            }
        }
    ],
    'dazzle_weave': [
        {
            label: 'Duration',
            controlType: 'input'
        },
        {
            attributeName: 'armor_per_second',
            label: 'ARMOR',
            ignoreTooltip: true,
            controlType: 'text',
            fn: function (v, a, parent, index, abilityModel, ability) {
                return v*a;
            },
            returnProperty: 'armor'
        },
        {
            attributeName: 'armor_per_second',
            label: 'ARMOR REDUCTION:',
            ignoreTooltip: true,
            controlType: 'text',
            fn: function (v, a, parent, index, abilityModel, ability) {
                return -v*a;
            },
            returnProperty: 'armorReduction'
        }
    ],
    'death_prophet_exorcism': [
        {
            label: 'Damage Dealt',
            controlType: 'input'
        },
        {
            attributeName: 'heal_percent',
            label: 'Total Armor',
            controlType: 'text',
            fn: function (v, a, parent, index, abilityModel, ability) {
                return v*a/100;
            }
        }
    ],
    'disruptor_static_storm': [
        {
            label: 'Duration',
            controlType: 'input'
        },
        {
            label: 'DAMAGE:',
            controlType: 'text',
            fn: function (v, a, parent, index, abilityModel, ability) {
                var damagevalue = 0.25 * (130 + 40 * ability.level()) * (1/20),
                mult = (v*4)*((v*4)+1)/2;
                return damagevalue * mult;
            }
        }
    ],
    'doom_bringer_scorched_earth': [
        {
            label: 'Duration',
            controlType: 'input'
        },
        {
            attributeName: 'damage_per_second',
            label: 'Total Damage',
            controlType: 'text',
            fn: function (v, a, parent, index, abilityModel, ability) {
                return v*a;
            }
        },
        {
            attributeName: 'bonus_movement_speed_pct',
            label: 'Total Damage',
            controlType: 'text',
            fn: function (v, a, parent, index, abilityModel, ability) {
                return a;
            },
            returnProperty: 'movementSpeedPct'
        },
        {
            attributeName: 'damage_per_second',
            label: 'HP REGEN:',
            ignoreTooltip: true,
            controlType: 'text',
            fn: function (v, a, parent, index, abilityModel, ability) {
                return a;
            },
            returnProperty: 'healthregen'
        }
    ],
    'doom_bringer_doom': [
        {
            label: 'Duration',
            controlType: 'input'
        },
        {
            attributeName: 'damage',
            label: 'Total Damage',
            controlType: 'text',
            fn: function (v, a, parent, index, abilityModel, ability) {
                if (parent.inventory.hasScepter()) {
                    return v*abilityModel.getAbilityAttributeValue(ability.attributes, 'damage_scepter',ability.level());
                }
                else {
                    return v*a;
                }
            }
        }
    ],
    'dragon_knight_elder_dragon_form': [
        {
            label: 'Duration',
            controlType: 'input'
        },
        {
            attributeName: 'bonus_attack_range',
            label: 'Total Damage',
            controlType: 'text',
            fn: function (v, a, parent, index, abilityModel, ability) {
                return a;
            },
            returnProperty: 'attackrange'
        },
        {
            attributeName: 'bonus_movement_speed',
            label: 'Total Damage',
            controlType: 'text',
            fn: function (v, a, parent, index, abilityModel, ability) {
                return a;
            },
            returnProperty: 'movementSpeedFlat'
        }
    ],
    'drow_ranger_trueshot': [
        {
            label: 'Drow\'s Agility',
            controlType: 'input',
            display: 'buff'
        },
        {
            attributeName: 'trueshot_ranged_damage',
            label: 'DAMAGE BONUS:',
            ignoreTooltip: true,
            controlType: 'text',
            display: 'buff',
            fn: function (v, a, parent, index, abilityModel, ability) {
                return v*a/100;
            },
            returnProperty: 'bonusDamagePrecisionAura'
        }
    ],
    'earth_spirit_rolling_boulder': [
        {
            label: 'Using Stone',
            controlType: 'checkbox'
        },
        {
            attributeName: 'move_slow',
            label: 'Total Damage',
            controlType: 'text',
            fn: function (v, a, parent, index, abilityModel, ability) {
                if (v) {
                    return -a;
                }
                else {
                    return 0;
                }
            },
            returnProperty: 'movementSpeedPctReduction'
        }
    ],
    'earthshaker_enchant_totem': [
        {
            label: 'Activated',
            controlType: 'checkbox'
        },
        {
            attributeName: 'totem_damage_percentage',
            label: 'DAMAGE',
            controlType: 'text',
            fn: function (v, a, parent, index, abilityModel, ability) {
                if (v) {
                    return a;
                }
                else {
                    return 0;
                }
            },
            returnProperty: 'baseDamageMultiplier'
        }
    ],
    'earthshaker_echo_slam': [
        {
            label: 'Enemies in Range',
            controlType: 'input'
        },
        {
            attributeName: 'echo_slam_echo_damage',
            label: 'Total Damage',
            controlType: 'text',
            fn: function (v, a, parent, index, abilityModel, ability) {
                return v*a;
            }
        }
    ],
    'elder_titan_ancestral_spirit': [
        {
            label: 'HEROES PASSED THROUGH',
            controlType: 'input'
        },
        {
            label: 'CREEPS PASSED THROUGH',
            controlType: 'input'
        },
        {
            attributeName: 'damage_creeps',
            label: 'DAMAGE:',
            ignoreTooltip: true,
            controlType: 'text',
            controls: [0,1],
            fn: function (v, a, parent, index, abilityModel, ability) {
                return v[0]*abilityModel.getAbilityAttributeValue(ability.attributes, 'damage_heroes',ability.level()) + v[1]*a;
            },
            returnProperty: 'bonusDamage'
        },
        {
            attributeName: 'move_pct_creeps',
            label: '%BONUS SPEED:',
            ignoreTooltip: true,
            controlType: 'text',
            controls: [0,1],
            fn: function (v, a, parent, index, abilityModel, ability) {
                return v[0]*abilityModel.getAbilityAttributeValue(ability.attributes, 'move_pct_heroes',ability.level()) + v[1]*a;
            },
            returnProperty: 'movementSpeedPct'
        }
    ],
    'elder_titan_earth_splitter': [
        {
            label: 'Enemy Max Health',
            controlType: 'input'
        },
        {
            attributeName: 'damage_pct',
            label: 'Total Damage',
            controlType: 'text',
            fn: function (v, a, parent, index, abilityModel, ability) {
                return v*a/100;
            }
        },
        {
            attributeName: 'slow_pct',
            label: 'Total Damage',
            controlType: 'text',
            fn: function (v, a, parent, index, abilityModel, ability) {
                return -a;
            },
            returnProperty: 'movementSpeedPctReduction'
        }
    ],
    'enchantress_natures_attendants': [
        {
            label: 'Duration',
            controlType: 'input'
        },
        {
            attributeName: 'heal',
            label: 'HEAL:',
            ignoreTooltip: true,
            controlType: 'text',
            fn: function (v, a, parent, index, abilityModel, ability) {
                return abilityModel.getAbilityAttributeValue(ability.attributes, 'wisp_count',ability.level())*v*a;
            }
        }
    ],
    'enigma_malefice': [
        {
            label: 'Hits',
            controlType: 'input'
        },
        {
            attributeName: 'damage',
            label: 'DAMAGE:',
            ignoreTooltip: true,
            controlType: 'text',
            fn: function (v, a, parent, index, abilityModel, ability) {
                return v*a;
            }
        },
        {
            attributeName: 'stun_duration',
            label: 'Total Damage',
            controlType: 'text',
            fn: function (v, a, parent, index, abilityModel, ability) {
                return v*a;
            }
        }
    ],
    'enigma_midnight_pulse': [
        {
            label: 'Duration',
            controlType: 'input'
        },
        {
            label: 'Enemy Max Health',
            controlType: 'input'
        },
        {
            attributeName: 'damage_percent',
            label: 'DAMAGE:',
            ignoreTooltip: true,
            controlType: 'text',
            controls: [0,1],
            fn: function (v, a, parent, index, abilityModel, ability) {
                return v[0]*v[1]*a/100;
            }
        }
    ],
    'enigma_black_hole': [
        {
            label: 'Duration',
            controlType: 'input'
        },
        {
            attributeName: 'far_damage',
            label: 'Total Damage',
            controlType: 'text',
            fn: function (v, a, parent, index, abilityModel, ability) {
                return v*a;
            }
        },
        {
            attributeName: 'near_damage',
            label: 'Total Damage',
            controlType: 'text',
            fn: function (v, a, parent, index, abilityModel, ability) {
                return v*a;
            }
        }
    ],
    'faceless_void_time_lock': [
        {
            label: 'In Chronosphere',
            controlType: 'checkbox'
        },
        {
            attributeName: 'bonus_damage',
            label: '%MOVESPEED AS DAMAGE',
            controlType: 'text',
            fn: function (v, a, parent, index, abilityModel, ability) {
                if (v) {
                    return a*2;
                }
                else {
                    return a;
                }
            },
            returnProperty: 'bashBonusDamage'
        },
        {
            attributeName: 'duration',
            label: 'Total Damage',
            controlType: 'text',
            fn: function (v, a, parent, index, abilityModel, ability) {
                return a;
            }
        },
        {
            attributeName: 'chance_pct',
            label: 'Total Damage',
            controlType: 'text',
            fn: function (v, a, parent, index, abilityModel, ability) {
                return a;
            },
            returnProperty: 'bash'
        }
    ],
    'gyrocopter_rocket_barrage': [
        {
            label: 'Rockets',
            controlType: 'input'
        },
        {
            attributeName: 'rockets_per_second',
            label: 'Total Damage',
            controlType: 'text',
            fn: function (v, a, parent, index, abilityModel, ability) {
                return a;
            }
        },
        {
            label: 'DAMAGE:',
            controlType: 'text',
            fn: function (v, a, parent, index, abilityModel, ability) {
                return abilityModel.getAbilityPropertyValue(ability, 'damage')*v;
            }
        }
    ],
/*        'gyrocopter_homing_missile': [
        {
            label: 'Distance Traveled',
            controlType: 'input'
        },
        {
            attributeName: 'damage',
            label: 'Total Damage',
            controlType: 'text',
            fn: function (v, a, parent, index, abilityModel, ability) {
                return v*a;
            }
        }
    ],
    'gyrocopter_flak_cannon': [
        {
            label: 'Attacks',
            controlType: 'input'
        },
        {
            attributeName: 'damage',
            label: 'Total Damage',
            controlType: 'text',
            fn: function (v, a, parent, index, abilityModel, ability) {
                return v*a;
            }
        }
    ],*/
    'huskar_burning_spear': [
        {
            label: 'Stacks',
            controlType: 'input'
        },
        {
            attributeName: 'health_cost',
            label: 'Total Damage',
            controlType: 'text',
            fn: function (v, a, parent, index, abilityModel, ability) {
                return v*a;
            }
        },
        {
            label: 'DAMAGE:',
            controlType: 'text',
            fn: function (v, a, parent, index, abilityModel, ability) {
                return abilityModel.getAbilityPropertyValue(ability, 'damage')*v;
            }
        }
    ],
    'huskar_berserkers_blood': [
        {
            label: '%HP',
            controlType: 'input'
        },
        {
            attributeName: 'hp_threshold_max',
            label: 'Health at given %HP:',
            ignoreTooltip: true,
            controlType: 'text',
            fn: function (v, a, parent, index, abilityModel, ability) {
                return parent.health()*v/100;
            }
        },
        {
            attributeName: 'hp_threshold_max',
            label: 'Total Damage',
            controlType: 'text',
            fn: function (v, a, parent, index, abilityModel, ability) {
                return a;
            }
        },
        {
            attributeName: 'maximum_resistance',
            label: 'MAGIC RESISTANCE BONUS:',
            ignoreTooltip: true,
            controlType: 'text',
            fn: function (v, a, parent, index, abilityModel, ability) {
                var v = Math.min(v, 100);
                v = Math.max(v, 10);
                var hp_threshold_max = abilityModel.getAbilityAttributeValue(ability.attributes, 'hp_threshold_max',0);
                var d = 100 - hp_threshold_max;
                var c = (v - hp_threshold_max) / d;
                c = 1 - c;
                return c*a;
            },
            returnProperty: 'magicResist'
        },
        {
            attributeName: 'maximum_attack_speed',
            label: 'ATTACK SPEED BONUS:',
            ignoreTooltip: true,
            controlType: 'text',
            fn: function (v, a, parent, index, abilityModel, ability) {
                var v = Math.min(v, 100);
                v = Math.max(v, 10);
                var hp_threshold_max = abilityModel.getAbilityAttributeValue(ability.attributes, 'hp_threshold_max',0);
                var d = 100 - hp_threshold_max;
                var c = (v - hp_threshold_max) / d;
                c = 1 - c;
                return c*a;
            },
            returnProperty: 'attackspeed'
        }
    ],
    'huskar_life_break': [
        {
            label: 'Enemy Current HP',
            controlType: 'input'
        },
        {
            attributeName: 'health_damage',
            label: 'DAMAGE:',
            ignoreTooltip: true,
            controlType: 'text',
            fn: function (v, a, parent, index, abilityModel, ability) {
                return v*a;
            }
        },
        {
            label: 'Huskar Current HP',
            controlType: 'input'
        },
        {
            attributeName: 'health_cost_percent',
            label: 'DAMAGE TAKEN:',
            ignoreTooltip: true,
            controlType: 'text',
            fn: function (v, a, parent, index, abilityModel, ability) {
                return v*a;
            }
        },
        {
            attributeName: 'movespeed',
            label: 'Total Damage',
            controlType: 'text',
            fn: function (v, a, parent, index, abilityModel, ability) {
                return a;
            },
            returnProperty: 'movementSpeedPctReduction'
        }
    ],
    'invoker_quas': [
        {
            label: 'Instances',
            controlType: 'input'
        },
        {
            attributeName: 'bonus_strength',
            label: 'Total Damage',
            controlType: 'text',
            fn: function (v, a, parent, index, abilityModel, ability) {
                return a;
            },
            returnProperty: 'bonusStrength'
        },
        {
            attributeName: 'health_regen_per_instance',
            label: 'HP REGEN:',
            ignoreTooltip: true,
            controlType: 'text',
            fn: function (v, a, parent, index, abilityModel, ability) {
                return v*a;
            },
            returnProperty: 'healthregen'
        }
    ],
    'invoker_wex': [
        {
            label: 'Instances',
            controlType: 'input'
        },
        {
            attributeName: 'bonus_agility',
            label: 'Total Damage',
            controlType: 'text',
            fn: function (v, a, parent, index, abilityModel, ability) {
                return a;
            },
            returnProperty: 'bonusAgility'
        },
        {
            attributeName: 'move_speed_per_instance',
            label: '%MOVE SPEED:',
            ignoreTooltip: true,
            controlType: 'text',
            fn: function (v, a, parent, index, abilityModel, ability) {
                return v*a;
            },
            returnProperty: 'movementSpeedPct'
        },
        {
            attributeName: 'attack_speed_per_instance',
            label: '%ATTACK SPEED:',
            ignoreTooltip: true,
            controlType: 'text',
            fn: function (v, a, parent, index, abilityModel, ability) {
                return v*a;
            },
            returnProperty: 'attackspeed'
        }
    ],
    'invoker_exort': [
        {
            label: 'Instances',
            controlType: 'input'
        },
        {
            attributeName: 'bonus_intelligence',
            label: 'Total Damage',
            controlType: 'text',
            fn: function (v, a, parent, index, abilityModel, ability) {
                return a;
            },
            returnProperty: 'bonusInt'
        },
        {
            attributeName: 'bonus_damage_per_instance',
            label: 'DAMAGE:',
            ignoreTooltip: true,
            controlType: 'text',
            fn: function (v, a, parent, index, abilityModel, ability) {
                return v*a;
            },
            returnProperty: 'bonusDamage'
        }
    ],
    'invoker_ghost_walk': [
        {
            label: 'Quas Level',
            controlType: 'input'
        },
        {
            attributeName: 'enemy_slow',
            label: 'Total Damage',
            controlType: 'text',
            fn: function (v, a, parent, index, abilityModel, ability) {
                if (v == 0) {
                    return 0;
                }
                return abilityModel.getAbilityAttributeValue(ability.attributes, 'enemy_slow',v);
            },
            returnProperty: 'movementSpeedPctReduction'
        },
        {
            label: 'Wex Level',
            controlType: 'input',
            display: 'ability'
        },
        {
            attributeName: 'self_slow',
            label: 'Total Damage',
            controlType: 'text',
            display: 'ability',
            fn: function (v, a, parent, index, abilityModel, ability) {
                if (v == 0) {
                    return 0;
                }
                return abilityModel.getAbilityAttributeValue(ability.attributes, 'self_slow',v);
            },
            returnProperty: 'movementSpeedPct'
        }
    ],
    'invoker_alacrity': [
        {
            label: 'Wex Level',
            controlType: 'input'
        },
        {
            attributeName: 'bonus_attack_speed',
            label: 'Total Damage',
            controlType: 'text',
            fn: function (v, a, parent, index, abilityModel, ability) {
                if (v == 0) {
                    return 0;
                }
                return abilityModel.getAbilityAttributeValue(ability.attributes, 'bonus_attack_speed',v);
            },
            returnProperty: 'attackspeed'
        },
        {
            label: 'Exort Level',
            controlType: 'input',
        },
        {
            attributeName: 'bonus_damage',
            label: 'Total Damage',
            controlType: 'text',
            fn: function (v, a, parent, index, abilityModel, ability) {
                if (v == 0) {
                    return 0;
                }
                return abilityModel.getAbilityAttributeValue(ability.attributes, 'bonus_damage',v);
            },
            returnProperty: 'bonusDamage'
        }
    ],
    'invoker_ice_wall': [
        {
            label: 'Quas Level',
            controlType: 'input'
        },
        {
            attributeName: 'slow',
            label: 'Total Damage',
            controlType: 'text',
            fn: function (v, a, parent, index, abilityModel, ability) {
                if (v == 0) {
                    return 0;
                }
                return abilityModel.getAbilityAttributeValue(ability.attributes, 'slow',v);
            },
            returnProperty: 'movementSpeedPctReduction'
        },
        {
            label: 'Exort Level',
            controlType: 'input',
            display: 'ability'
        },
        {
            label: 'Duration',
            controlType: 'input',
            display: 'ability'
        },
        {
            attributeName: 'damage_per_second',
            label: 'DAMAGE:',
            ignoreTooltip: true,
            controlType: 'text',
            display: 'ability',
            controls: [1,2],
            fn: function (v, a, parent, index, abilityModel, ability) {
                if (v[0] == 0) {
                    return 0;
                }
                return abilityModel.getAbilityAttributeValue(ability.attributes, 'damage_per_second',v[0])*v[1];
            }
        }
    ],
    'jakiro_dual_breath': [
        {
            label: 'Duration',
            controlType: 'input'
        },
        {
            label: 'DAMAGE:',
            controlType: 'text',
            fn: function (v, a, parent, index, abilityModel, ability) {
                return abilityModel.getAbilityPropertyValue(ability, 'damage')*2 + 
                abilityModel.getAbilityAttributeValue(ability.attributes, 'burn_damage',ability.level())*v;
            }
        },
        {
            attributeName: 'slow_movement_speed_pct',
            label: 'Total Damage',
            controlType: 'text',
            fn: function (v, a, parent, index, abilityModel, ability) {
                return a;
            },
            returnProperty: 'movementSpeedPctReduction'
        },
        {
            attributeName: 'slow_attack_speed_pct',
            label: '%ATTACK SLOW:',
            ignoreTooltip: true,
            controlType: 'text',
            fn: function (v, a, parent, index, abilityModel, ability) {
                return a;
            },
            returnProperty: 'attackspeedreduction'
        }
    ],
    'jakiro_liquid_fire': [
        {
            label: 'Duration',
            controlType: 'input'
        },
        {
            attributeName: 'damage',
            label: 'Total Damage',
            controlType: 'text',
            fn: function (v, a, parent, index, abilityModel, ability) {
                return v*a;
            }
        },
        {
            attributeName: 'slow_attack_speed_pct',
            label: 'Total Damage',
            controlType: 'text',
            fn: function (v, a, parent, index, abilityModel, ability) {
                return a;
            },
            returnProperty: 'attackspeedreduction'
        }
    ],
    'jakiro_macropyre': [
        {
            label: 'Duration',
            controlType: 'input'
        },
        {
            attributeName: 'damage',
            label: 'Total Damage',
            controlType: 'text',
            fn: function (v, a, parent, index, abilityModel, ability) {
                return v*a;
            }
        }
    ],
    'juggernaut_blade_fury': [
        {
            label: 'Duration',
            controlType: 'input'
        },
        {
            label: 'DAMAGE:',
            controlType: 'text',
            fn: function (v, a, parent, index, abilityModel, ability) {
                return abilityModel.getAbilityPropertyValue(ability, 'damage')*v;
            }
        }
    ],
    'juggernaut_healing_ward': [
        {
            label: 'Duration',
            controlType: 'input'
        },
        {
            label: 'Max Health',
            controlType: 'input'
        },
        {
            attributeName: 'healing_ward_heal_amount',
            label: 'HEAL OVER TIME:',
            ignoreTooltip: true,
            controlType: 'text',
            controls: [0,1],
            fn: function (v, a, parent, index, abilityModel, ability) {
                return v[0]*v[1]*a/100;
            }
        }
    ],
    'juggernaut_omni_slash': [
        {
            label: 'Jumps',
            controlType: 'input'
        },
        {
            label: 'MIN DAMAGE:',
            ignoreTooltip: true,
            controlType: 'text',
            fn: function (v, a, parent, index, abilityModel, ability) {
                return abilityModel.getAbilityAttributeValue(ability.attributes, 'omni_slash_damage',1)*v;
            }
        },
        {
            label: 'MAX DAMAGE:',
            ignoreTooltip: true,
            controlType: 'text',
            fn: function (v, a, parent, index, abilityModel, ability) {
                return abilityModel.getAbilityAttributeValue(ability.attributes, 'omni_slash_damage',2)*v;
            }
        }
    ],
    'keeper_of_the_light_illuminate': [
        {
            label: 'Duration',
            controlType: 'input'
        },
        {
            attributeName: 'damage_per_second',
            label: 'DAMAGE:',
            ignoreTooltip: true,
            controlType: 'text',
            fn: function (v, a, parent, index, abilityModel, ability) {
                return v*a;
            }
        }
    ],
    'keeper_of_the_light_mana_leak': [
        {
            label: 'Distance Moved',
            controlType: 'input'
        },
        {
            label: 'Enemy Max Mana',
            controlType: 'input'
        },
        {
            attributeName: 'mana_leak_pct',
            label: 'MANA LEAKED:',
            ignoreTooltip: true,
            controlType: 'text',
            controls: [0,1],
            fn: function (v, a, parent, index, abilityModel, ability) {
                return v[0]/100*v[1]*a/100;
            }
        }
    ],
    'legion_commander_duel': [
        {
            label: 'Duel Wins',
            controlType: 'input'
        },
        {
            attributeName: 'reward_damage',
            label: 'Total Damage:',
            ignoreTooltip: true,
            controlType: 'text',
            fn: function (v, a, parent, index, abilityModel, ability) {
                return v*a;
            },
            returnProperty: 'bonusDamage'
        }
    ],
    'leshrac_pulse_nova': [
        {
            label: 'Duration',
            controlType: 'input'
        },
        {
            attributeName: 'damage',
            label: 'Total Damage',
            controlType: 'text',
            fn: function (v, a, parent, index, abilityModel, ability) {
                return v*a;
            }
        },
        {
            attributeName: 'mana_cost_per_second',
            label: 'MANA COST:',
            ignoreTooltip: true,
            controlType: 'text',
            fn: function (v, a, parent, index, abilityModel, ability) {
                return v*a;
            }
        }
    ],
    'lich_chain_frost': [
        {
            label: 'Bounce Hits',
            controlType: 'input'
        },
        {
            attributeName: 'damage',
            label: 'Total Damage',
            controlType: 'text',
            fn: function (v, a, parent, index, abilityModel, ability) {
                return v*a;
            }
        },
        {
            attributeName: 'slow_movement_speed',
            label: 'Enemy Movement Speed Slow',
            controlType: 'text',
            fn: function (v, a, parent, index, abilityModel, ability) {
                return a;
            },
            returnProperty: 'movementSpeedPctReduction'
        },
        {
            attributeName: 'slow_attack_speed',
            label: 'Total Damage',
            controlType: 'text',
            fn: function (v, a, parent, index, abilityModel, ability) {
                return a;
            },
            returnProperty: 'attackspeedreduction'
        }
    ],
    'life_stealer_feast': [
        {
            label: 'Enemy Current HP',
            controlType: 'input'
        },
        {
            attributeName: 'hp_leech_percent',
            label: 'Total Damage',
            controlType: 'text',
            fn: function (v, a, parent, index, abilityModel, ability) {
                return v*a/100;
            },
            returnProperty: 'bonusDamage'
        }
    ],
    'life_stealer_open_wounds': [
        {
            label: 'Duration',
            controlType: 'input'
        },
        {
            attributeName: 'heal_percent',
            label: 'Total Damage',
            controlType: 'text',
            fn: function (v, a, parent, index, abilityModel, ability) {
                return a;
            },
            returnProperty: 'lifesteal'
        },
        {
            attributeName: 'slow_steps',
            label: '%SLOW:',
            ignoreTooltip: true,
            controlType: 'text',
            noLevel: true,
            fn: function (v, a, parent, index, abilityModel, ability) {
                return abilityModel.getAbilityAttributeValue(ability.attributes, 'slow_steps',v+1);
            },
            returnProperty: 'movementSpeedPctReduction'
        }
    ],
    'lina_fiery_soul': [
        {
            label: 'Duration',
            controlType: 'input'
        },
        {
            attributeName: 'fiery_soul_move_speed_bonus',
            label: 'Enemy Movement Speed Slow',
            controlType: 'text',
            fn: function (v, a, parent, index, abilityModel, ability) {
                return v*a;
            },
            returnProperty: 'movementSpeedPct'
        },
        {
            attributeName: 'fiery_soul_attack_speed_bonus',
            label: 'Total Damage',
            controlType: 'text',
            fn: function (v, a, parent, index, abilityModel, ability) {
                return v*a;
            },
            returnProperty: 'attackspeed'
        }
    ],
    'lion_mana_drain': [
        {
            label: 'Duration',
            controlType: 'input'
        },
        {
            attributeName: 'mana_per_second',
            label: 'MANA DRAINED:',
            ignoreTooltip: true,
            controlType: 'text',
            fn: function (v, a, parent, index, abilityModel, ability) {
                return v*a;
            }
        }
    ],
    'luna_moon_glaive': [
        {
            label: 'Damage',
            controlType: 'input'
        },
        {
            attributeName: 'damage_reduction_percent',
            label: 'BOUNCE DAMAGE:',
            ignoreTooltip: true,
            controlType: 'text',
            fn: function (v, a, parent, index, abilityModel, ability) {
                var result = [];
                for (var i = 1; i < 6; i++) {
                    result.push((v*Math.pow(a/100,i)).toFixed(2))
                }
                return result.join('<br>');
            }
        }
    ],
    'luna_eclipse': [
        {
            label: 'Beam Count',
            controlType: 'input'
        },
        {
            attributeName: 'beams',
            label: 'Total Damage',
            controlType: 'text',
            fn: function (v, a, parent, index, abilityModel, ability) {
                var lucentBeamAbility = abilityModel.abilities().find(function(b) {
                    return b.name == 'luna_lucent_beam';
                });
                if (lucentBeamAbility.level() == 0) return 0;
                var damage = abilityModel.getAbilityPropertyValue(lucentBeamAbility, 'damage');
                return v*damage;
            }
        }
    ],
    'medusa_mystic_snake': [
        {
            label: 'Jump Count',
            controlType: 'input'
        },
        {
            attributeName: 'snake_damage',
            label: 'Damage Per Jump:',
            ignoreTooltip: true,
            controlType: 'method',
            display: 'none',
            fn: function (v, a, parent, index, abilityModel, ability) {
                var snake_jumps = abilityModel.getAbilityAttributeValue(ability.attributes, 'snake_jumps',ability.level());
                var snake_scale = abilityModel.getAbilityAttributeValue(ability.attributes, 'snake_scale',0);
                var damage = [];
                for (var i = 0; i < snake_jumps; i++) {
                    damage.push(a + a * i * snake_scale/100);
                }
                return damage;
            }
        },
        {
            attributeName: 'snake_damage',
            label: 'Damage Per Jump:',
            ignoreTooltip: true,
            controlType: 'text',
            controls: [0,1],
            fn: function (v, a, parent, index, abilityModel, ability) {
                return v[1].join(' / ');
            }
        },
        {
            attributeName: 'snake_damage',
            label: 'Total Damage:',
            ignoreTooltip: true,
            controlType: 'text',
            controls: [0,1],
            fn: function (v, a, parent, index, abilityModel, ability) {
                return v[1].slice(0, v[0]).reduce(function (memo, o) { return memo + o }, 0);
            }
        },
        {
            attributeName: 'snake_damage',
            label: 'Max Damage:',
            ignoreTooltip: true,
            controlType: 'text',
            controls: [0,1],
            fn: function (v, a, parent, index, abilityModel, ability) {
                return v[1].reduce(function (memo, o) { return memo + o }, 0);
            }
        }
    ],
    'medusa_mana_shield': [
        {
            label: 'Damage',
            controlType: 'input'
        },
        {
            attributeName: 'damage_per_mana',
            label: 'MANA USED:',
            ignoreTooltip: true,
            controlType: 'text',
            fn: function (v, a, parent, index, abilityModel, ability) {
                return (v/a).toFixed(2);
            }
        },
        {
            attributeName: 'absorption_tooltip',
            label: '%DAMAGE REDUCTION:',
            ignoreTooltip: true,
            controlType: 'text',
            fn: function (v, a, parent, index, abilityModel, ability) {
                return -a;
            },
            returnProperty: 'damageReduction'
        }
    ],
    'meepo_poof': [
        {
            label: 'Meepo Count',
            controlType: 'input'
        },
        {
            label: 'DAMAGE:',
            controlType: 'text',
            fn: function (v, a, parent, index, abilityModel, ability) {
                return abilityModel.getAbilityPropertyValue(ability, 'damage')*v;
            }
        }
    ],
    'meepo_geostrike': [
        {
            label: 'Stacks',
            controlType: 'input'
        },
        {
            label: 'DAMAGE:',
            ignoreTooltip: true,
            controlType: 'text',
            fn: function (v, a, parent, index, abilityModel, ability) {
                return abilityModel.getAbilityPropertyValue(ability, 'damage')*v;
            }
        },
        {
            attributeName: 'slow',
            label: '%SLOW:',
            ignoreTooltip: true,
            controlType: 'text',
            noLevel: true,
            fn: function (v, a, parent, index, abilityModel, ability) {
                return abilityModel.getAbilityAttributeValue(ability.attributes, 'slow',ability.level())*v;
            },
            returnProperty: 'movementSpeedPctReduction'
        }
    ],
    'mirana_arrow': [
        {
            label: 'Arrow Travel Distance',
            controlType: 'input'
        },
        {
            attributeName: 'arrow_max_stun',
            label: 'STUN DURATION:',
            ignoreTooltip: true,
            controlType: 'text',
            fn: function (v, a, parent, index, abilityModel, ability) {
                var arrow_min_stun = abilityModel.getAbilityAttributeValue(ability.attributes, 'arrow_min_stun',0);
                var arrow_max_stunrange = abilityModel.getAbilityAttributeValue(ability.attributes, 'arrow_max_stunrange',0);
                var scale = Math.min(v, arrow_max_stunrange) / arrow_max_stunrange;
                return Math.max(arrow_min_stun, Math.floor(a * scale / 0.1) * 0.1);
            }
        },
        {
            attributeName: 'arrow_bonus_damage',
            label: 'TOTAL DAMAGE:',
            ignoreTooltip: true,
            controlType: 'text',
            fn: function (v, a, parent, index, abilityModel, ability) {
                var ability = ability;
                var damage = ability.damage()[ability.level()-1];
                var arrow_max_stunrange = abilityModel.getAbilityAttributeValue(ability.attributes, 'arrow_max_stunrange',0);
                var scale = Math.min(v, arrow_max_stunrange) / arrow_max_stunrange;
                var bonus_damage = Math.floor(a * scale / 2.8) * 2.8;
                return damage + ' + ' + bonus_damage + ' = ' + (damage + bonus_damage);
            }
        }
    ],
    'morphling_morph_agi': [
        {
            label: 'Shifts',
            controlType: 'input'
        },
        {
            attributeName: 'points_per_tick',
            label: 'AGI SHIFT GAIN:',
            ignoreTooltip: true,
            controlType: 'text',
            fn: function (v, a, parent, index, abilityModel, ability) {
                return v*a;
            },
            returnProperty: 'bonusAgility'
        },
        {
            attributeName: 'points_per_tick',
            label: 'STR SHIFT LOSS:',
            ignoreTooltip: true,
            controlType: 'text',
            fn: function (v, a, parent, index, abilityModel, ability) {
                return -v*a;
            },
            returnProperty: 'bonusStrength'
        },
        {
            attributeName: 'bonus_attributes',
            label: 'SHIFT TIME:',
            controlType: 'text',
            fn: function (v, a, parent, index, abilityModel, ability) {
                return a;
            },
            returnProperty: 'bonusAgility2'
        },
        {
            attributeName: 'morph_cooldown',
            label: 'SHIFT TIME:',
            ignoreTooltip: true,
            controlType: 'text',
            fn: function (v, a, parent, index, abilityModel, ability) {
                return v*a;
            }
        },
        {
            attributeName: 'mana_cost',
            label: 'SHIFT MANA COST:',
            ignoreTooltip: true,
            controlType: 'text',
            fn: function (v, a, parent, index, abilityModel, ability) {
                return v*a*abilityModel.getAbilityAttributeValue(ability.attributes, 'morph_cooldown',ability.level());
            }
        }
    ],
    'morphling_morph_str': [
        {
            label: 'Shifts',
            controlType: 'input'
        },
        {
            attributeName: 'points_per_tick',
            label: 'STR SHIFT GAIN:',
            ignoreTooltip: true,
            controlType: 'text',
            fn: function (v, a, parent, index, abilityModel, ability) {
                return v*a;
            },
            returnProperty: 'bonusStrength'
        },
        {
            attributeName: 'points_per_tick',
            label: 'AGI SHIFT LOSS:',
            ignoreTooltip: true,
            controlType: 'text',
            fn: function (v, a, parent, index, abilityModel, ability) {
                return -v*a;
            },
            returnProperty: 'bonusAgility'
        },
        {
            attributeName: 'bonus_attributes',
            label: 'SHIFT TIME:',
            controlType: 'text',
            fn: function (v, a, parent, index, abilityModel, ability) {
                return a;
            },
            returnProperty: 'bonusStrength2'
        },
        {
            attributeName: 'morph_cooldown',
            label: 'SHIFT TIME:',
            ignoreTooltip: true,
            controlType: 'text',
            fn: function (v, a, parent, index, abilityModel, ability) {
                return v*a;
            }
        },
        {
            attributeName: 'mana_cost',
            label: 'SHIFT MANA COST:',
            ignoreTooltip: true,
            controlType: 'text',
            fn: function (v, a, parent, index, abilityModel, ability) {
                return v*a*abilityModel.getAbilityAttributeValue(ability.attributes, 'morph_cooldown',ability.level());
            }
        }
    ],
    'furion_wrath_of_nature': [
        {
            label: 'Duration',
            controlType: 'input'
        },
        {
            attributeName: 'damage',
            label: 'Total Damage',
            controlType: 'text',
            fn: function (v, a, parent, index, abilityModel, ability) {
                return v*a;
            }
        }
    ],
    'necrolyte_heartstopper_aura': [
        {
            label: 'Duration',
            controlType: 'input'
        },
        {
            label: 'Enemy Max Health',
            controlType: 'input'
        },
        {
            attributeName: 'aura_damage',
            label: 'HEALTH LOST:',
            ignoreTooltip: true,
            controlType: 'text',
            controls: [0,1],
            fn: function (v, a, parent, index, abilityModel, ability) {
                return v[0]*v[1]*a/100;
            }
        }
    ],
    'necrolyte_sadist': [
        {
            label: 'Unit Kills',
            controlType: 'input'
        },
        {
            label: 'Hero Kills',
            controlType: 'input'
        },
        {
            attributeName: 'health_regen',
            label: 'Total Damage',
            controlType: 'text',
            controls: [0,1],
            fn: function (v, a, parent, index, abilityModel, ability) {
                var hero_multiplier = abilityModel.getAbilityAttributeValue(ability.attributes, 'hero_multiplier',0)
                return (v[0]+v[1]*hero_multiplier)*a;
            },
            returnProperty: 'healthregen'
        },
        {
            attributeName: 'mana_regen',
            label: 'Total Damage',
            controlType: 'text',
            controls: [0,1],
            fn: function (v, a, parent, index, abilityModel, ability) {
                var hero_multiplier = abilityModel.getAbilityAttributeValue(ability.attributes, 'hero_multiplier',0)
                return (v[0]+v[1]*hero_multiplier)*a;
            },
            returnProperty: 'manaregen'
        }
    ],
    'night_stalker_crippling_fear': [
        {
            label: 'Is Night',
            controlType: 'checkbox'
        },
        {
            attributeName: 'miss_rate_night',
            label: '%CHANCE TO MISS:',
            ignoreTooltip: true,
            controlType: 'text',
            fn: function (v, a, parent, index, abilityModel, ability) {
                if (v) {
                    return abilityModel.getAbilityAttributeValue(ability.attributes, 'miss_rate_night',ability.level());
                }
                else {
                    return abilityModel.getAbilityAttributeValue(ability.attributes, 'miss_rate_day',ability.level());
                }
            },
            returnProperty: 'missChance'
        }
    ],    
    'night_stalker_hunter_in_the_night': [
        {
            label: 'Is Night',
            controlType: 'checkbox'
        },
        {
            attributeName: 'bonus_attack_speed_night',
            label: 'Total Damage',
            controlType: 'text',
            fn: function (v, a, parent, index, abilityModel, ability) {
                if (v) {
                    return a;
                }
                else {
                    return 0;
                }
            },
            returnProperty: 'attackspeed'
        },
        {
            attributeName: 'bonus_movement_speed_pct_night',
            label: 'Total Damage',
            controlType: 'text',
            fn: function (v, a, parent, index, abilityModel, ability) {
                if (v) {
                    return a;
                }
                else {
                    return 0;
                }
            },
            returnProperty: 'movementSpeedPct'
        }
    ],    
    'obsidian_destroyer_arcane_orb': [
        {
            label: 'Current Mana',
            controlType: 'input'
        },
        {
            attributeName: 'mana_pool_damage_pct',
            label: 'Total Damage',
            controlType: 'text',
            fn: function (v, a, parent, index, abilityModel, ability) {
                return v*a/100;
            },
            returnProperty: 'bonusDamageOrb'
        }
    ],
    'ogre_magi_ignite': [
        {
            label: 'Duration',
            controlType: 'input'
        },
        {
            attributeName: 'burn_damage',
            label: 'Total Damage',
            controlType: 'text',
            fn: function (v, a, parent, index, abilityModel, ability) {
                return v*a;
            }
        },
        {
            attributeName: 'slow_movement_speed_pct',
            label: 'Total Damage',
            controlType: 'text',
            fn: function (v, a, parent, index, abilityModel, ability) {
                return a;
            },
            returnProperty: 'movementSpeedPctReduction'
        }
    ],
    'pudge_rot': [
        {
            label: 'Duration',
            controlType: 'input'
        },
        {
            label: 'DAMAGE:',
            controlType: 'text',
            fn: function (v, a, parent, index, abilityModel, ability) {
                return abilityModel.getAbilityPropertyValue(ability, 'damage')*v;
            }
        },
        {
            attributeName: 'rot_slow',
            label: 'Total Damage',
            controlType: 'text',
            fn: function (v, a, parent, index, abilityModel, ability) {
                return a;
            },
            returnProperty: 'movementSpeedPctReduction'
        }
    ],
    'pudge_flesh_heap': [
        {
            label: 'Stacks',
            controlType: 'input'
        },
        {
            attributeName: 'flesh_heap_strength_buff_amount',
            label: 'Total Damage',
            controlType: 'text',
            fn: function (v, a, parent, index, abilityModel, ability) {
                return v*a;
            },
            returnProperty: 'bonusStrength'
        },
        {
            attributeName: 'flesh_heap_magic_resist',
            label: 'Total Damage',
            controlType: 'text',
            fn: function (v, a, parent, index, abilityModel, ability) {
                return a;
            },
            returnProperty: 'magicResist'
        }
    ],
    'pudge_dismember': [
        {
            label: 'Duration',
            controlType: 'input'
        },
        {
            attributeName: 'dismember_damage',
            label: 'Total Damage',
            controlType: 'text',
            fn: function (v, a, parent, index, abilityModel, ability) {
                return v*a;
            }
        }
    ],
    'pugna_nether_ward': [
        {
            label: 'Enemy Mana Spent',
            controlType: 'input'
        },
        {
            attributeName: 'mana_multiplier',
            label: 'DAMAGE:',
            ignoreTooltip: true,
            controlType: 'text',
            fn: function (v, a, parent, index, abilityModel, ability) {
                return v*a;
            }
        },
        {
            attributeName: 'mana_regen',
            label: 'Total Damage',
            controlType: 'text',
            fn: function (v, a, parent, index, abilityModel, ability) {
                return a;
            },
            returnProperty: 'manaregenreduction'
        }
    ],
    'pugna_life_drain': [
        {
            label: 'Duration',
            controlType: 'input'
        },
        {
            attributeName: 'health_drain',
            label: 'HEALTH DRAINED:',
            ignoreTooltip: true,
            controlType: 'text',
            fn: function (v, a, parent, index, abilityModel, ability) {
                return v*a;
            }
        }
    ],
    'queenofpain_shadow_strike': [
        {
            label: 'Duration',
            controlType: 'input'
        },
        {
            attributeName: 'movement_slow',
            label: 'Total Damage',
            controlType: 'text',
            fn: function (v, a, parent, index, abilityModel, ability) {
                return a;
            },
            returnProperty: 'movementSpeedPctReduction'
        },
        {
            attributeName: 'strike_damage',
            label: 'Total Damage:',
            ignoreTooltip: true,
            controlType: 'text',
            fn: function (v, a, parent, index, abilityModel, ability) {
                var duration_damage = abilityModel.getAbilityAttributeValue(ability.attributes, 'duration_damage',ability.level());
                var ticks = Math.floor(v/3);
                return a + duration_damage * ticks;
            }
        }
    ],
    'razor_plasma_field': [
        {
            label: 'Distance',
            controlType: 'input'
        },
        {
            attributeName: 'radius',
            label: 'MIN DISTANCE:',
            ignoreTooltip: true,
            controlType: 'text',
            fn: function (v, a, parent, index, abilityModel, ability) {
                return 200;
            }
        },
        {
            attributeName: 'radius',
            label: 'MAX DISTANCE:',
            ignoreTooltip: true,
            controlType: 'text',
            fn: function (v, a, parent, index, abilityModel, ability) {
                return 200 + a;
            }
        },
        {
            attributeName: 'radius',
            label: 'Instance Damage',
            ignoreTooltip: true,
            controlType: 'text',
            fn: function (v, a, parent, index, abilityModel, ability) {
                var max_radius = a + 200;
                var scale = (Math.min(Math.max(v, 200), max_radius) - 200) / (max_radius - 200);
                var damage_min = abilityModel.getAbilityAttributeValue(ability.attributes, 'damage_min',ability.level());
                var damage_max = abilityModel.getAbilityAttributeValue(ability.attributes, 'damage_max',ability.level());
                return damage_min + (damage_max - damage_min) * scale;
            }
        }
    ],
    'razor_static_link': [
        {
            label: 'Duration',
            controlType: 'input'
        },
        {
            attributeName: 'drain_length',
            label: 'Damage Drained:',
            ignoreTooltip: true,
            controlType: 'text',
            fn: function (v, a, parent, index, abilityModel, ability) {
                var tick_duration = Math.floor(v * 4) + 1;
                var ticks = Math.min(a * 4 + 1, tick_duration);
                var drain_rate = abilityModel.getAbilityAttributeValue(ability.attributes, 'drain_rate',ability.level());
                return ticks * drain_rate/4;
            },
            returnProperty: 'bonusDamage'
        },
        {
            attributeName: 'drain_length',
            label: 'Enemy Damage Lost:',
            ignoreTooltip: true,
            controlType: 'text',
            display: 'hidden',
            fn: function (v, a, parent, index, abilityModel, ability) {
                var tick_duration = Math.floor(v * 4) + 1;
                var ticks = Math.min(a * 4 + 1, tick_duration);
                var drain_rate = abilityModel.getAbilityAttributeValue(ability.attributes, 'drain_rate',ability.level());
                return ticks * drain_rate/4;
            },
            returnProperty: 'bonusDamageReduction'
        }
    ],
    'razor_eye_of_the_storm': [
        {
            label: 'Duration',
            controlType: 'input'
        },
        {
            attributeName: 'damage',
            label: 'Total Damage',
            controlType: 'text',
            fn: function (v, a, parent, index, abilityModel, ability) {
                return v*a;
            }
        }
    ],
    'rubick_fade_bolt': [
        {
            label: 'Jumps',
            controlType: 'input'
        },
        {
            attributeName: 'damage',
            label: 'Total Damage',
            controlType: 'text',
            fn: function (v, a, parent, index, abilityModel, ability) {
                return a * (1 - v*abilityModel.getAbilityAttributeValue(ability.attributes, 'jump_damage_reduction_pct',ability.level())/100);
            }
        },
        {
            attributeName: 'hero_attack_damage_reduction',
            label: 'Total Damage',
            controlType: 'text',
            fn: function (v, a, parent, index, abilityModel, ability) {
                return a;
            },
            returnProperty: 'bonusDamageReduction'
        }
    ],
    'sandking_sand_storm': [
        {
            label: 'Duration',
            controlType: 'input'
        },
        {
            label: 'DAMAGE:',
            controlType: 'text',
            fn: function (v, a, parent, index, abilityModel, ability) {
                return abilityModel.getAbilityPropertyValue(ability, 'damage')*v;
            }
        }
    ],
    'sandking_epicenter': [
        {
            label: 'Pulses',
            controlType: 'input'
        },
        {
            attributeName: 'epicenter_damage',
            label: 'DAMAGE:',
            ignoreTooltip: true,
            controlType: 'text',
            fn: function (v, a, parent, index, abilityModel, ability) {
                return v*a;
            }
        },
        {
            attributeName: 'epicenter_slow',
            label: 'Total Damage',
            controlType: 'text',
            fn: function (v, a, parent, index, abilityModel, ability) {
                return a;
            },
            returnProperty: 'movementSpeedPctReduction'
        },
        {
            attributeName: 'epicenter_slow_as',
            label: '%ATTACK SLOW:',
            ignoreTooltip: true,
            controlType: 'text',
            fn: function (v, a, parent, index, abilityModel, ability) {
                return a;
            },
            returnProperty: 'attackspeedreduction'
        }
    ],
    'shadow_demon_shadow_poison': [
        {
            label: 'Duration',
            controlType: 'input'
        },
        {
            attributeName: 'stack_damage',
            label: 'Total Damage',
            controlType: 'text',
            fn: function (v, a, parent, index, abilityModel, ability) {
                var stackmult = [1,2,4,8];
                if (v > 4) {
                    return a * stackmult[3] + 50 * (v - 4);
                }
                else if (v <= 0) {
                    return 0
                }
                else {
                    return a * stackmult[v-1]
                }
            }
        }
    ],
    'nevermore_necromastery': [
        {
            label: 'Souls',
            controlType: 'input'
        },
        {
            attributeName: 'necromastery_damage_per_soul',
            label: 'DAMAGE:',
            ignoreTooltip: true,
            controlType: 'text',
            fn: function (v, a, parent, index, abilityModel, ability) {
                return v*a;
            },
            returnProperty: 'bonusDamage'
        }
    ],
    'nevermore_requiem': [
        {
            label: 'Line Hit Count',
            controlType: 'input'
        },
        {
            attributeName: 'requiem_reduction_damage',
            label: 'Damage:',
            ignoreTooltip: true,
            controlType: 'text',
            fn: function (v, a, parent, index, abilityModel, ability) {
                return abilityModel.getAbilityPropertyValue(ability, 'damage')*v;
            }
        },
        {
            label: 'Return Line Hit Count (Scepter)',
            controlType: 'input'
        },
        {
            attributeName: 'requiem_damage_pct_scepter',
            label: 'Damage/Heal:',
            ignoreTooltip: true,
            controlType: 'text',
            fn: function (v, a, parent, index, abilityModel, ability) {
                return abilityModel.getAbilityPropertyValue(ability, 'damage')*v*a/100;
            }
        },
        {
            attributeName: 'requiem_damage_pct_scepter',
            label: 'Total Damage:',
            ignoreTooltip: true,
            controlType: 'text',
            controls: [0,1],
            fn: function (v, a, parent, index, abilityModel, ability) {
                var damage = abilityModel.getAbilityPropertyValue(ability, 'damage');
                return damage*v[0] + damage*v[1]*a/100;
            }
        },
        {
            attributeName: 'requiem_reduction_damage',
            label: '%DAMAGE REDUCTION:',
            ignoreTooltip: true,
            controlType: 'text',
            fn: function (v, a, parent, index, abilityModel, ability) {
                return a;
            },
            returnProperty: 'baseDamageReductionPct'
        },
        {
            attributeName: 'requiem_reduction_ms',
            label: '%DAMAGE REDUCTION:',
            controlType: 'text',
            fn: function (v, a, parent, index, abilityModel, ability) {
                return a;
            },
            returnProperty: 'movementSpeedPctReduction'
        }
    ],
    'shadow_shaman_shackles': [
        {
            label: 'Duration',
            controlType: 'input'
        },
        {
            label: 'DAMAGE:',
            controlType: 'text',
            fn: function (v, a, parent, index, abilityModel, ability) {
                return abilityModel.getAbilityPropertyValue(ability, 'damage')*v;
            }
        }
    ],
    'silencer_curse_of_the_silent': [
        {
            label: 'Duration',
            controlType: 'input'
        },
        {
            attributeName: 'damage',
            label: 'Total Damage',
            controlType: 'text',
            fn: function (v, a, parent, index, abilityModel, ability) {
                return Math.floor(v)*a;
            }
        },
        {
            attributeName: 'movespeed',
            label: 'Total Damage',
            controlType: 'text',
            fn: function (v, a, parent, index, abilityModel, ability) {
                return a;
            },
            returnProperty: 'movementSpeedPctReduction'
        }
    ],
/*        'silencer_glaives_of_wisdom': [
        {
            label: 'Duration',
            controlType: 'input'
        },
        {
            attributeName: 'damage',
            label: 'Total Damage',
            controlType: 'text',
            fn: function (v, a, parent, index, abilityModel, ability) {
                return v*a;
            }
        }
    ],*/
    'skywrath_mage_mystic_flare': [
        {
            label: 'Duration',
            controlType: 'input'
        },
        {
            attributeName: 'damage',
            label: 'Total Damage',
            controlType: 'text',
            fn: function (v, a, parent, index, abilityModel, ability) {
                return v*a;
            }
        }
    ],
    'slark_essence_shift': [
        {
            label: 'Attacks',
            controlType: 'input'
        },
        {
            attributeName: 'agi_gain',
            label: 'Total Damage',
            controlType: 'text',
            display: 'ability',
            fn: function (v, a, parent, index, abilityModel, ability) {
                return v*a;
            },
            returnProperty: 'bonusAgility'
        },
        {
            attributeName: 'stat_loss',
            label: 'Total Damage',
            controlType: 'text',
            fn: function (v, a, parent, index, abilityModel, ability) {
                return -v*a;
            },
            returnProperty: 'bonusAllStatsReduction'
        }
    ],
    'slark_shadow_dance': [
        {
            label: 'Duration',
            controlType: 'input'
        },
        {
            attributeName: 'bonus_regen_pct',
            label: 'TOTAL HEALTH REGENERATED:',
            ignoreTooltip: true,
            controlType: 'text',
            fn: function (v, a, parent, index, abilityModel, ability) {
                return v*parent.health()*a/100;
            }
        },
        {
            attributeName: 'bonus_regen_pct',
            label: 'HEALTH GAINED PER SECOND:',
            ignoreTooltip: true,
            controlType: 'text',
            fn: function (v, a, parent, index, abilityModel, ability) {
                return parent.health()*a/100;
            },
            returnProperty: 'healthregen'
        },
        {
            attributeName: 'bonus_movement_speed',
            label: '%MOVE SPEED:',
            ignoreTooltip: true,
            controlType: 'text',
            fn: function (v, a, parent, index, abilityModel, ability) {
                return a;
            },
            returnProperty: 'movementSpeedPct'
        }
    ],
    'sniper_shrapnel': [
        {
            label: 'Duration',
            controlType: 'input'
        },
        {
            label: 'DAMAGE:',
            ignoreTooltip: true,
            controlType: 'text',
            fn: function (v, a, parent, index, abilityModel, ability) {
                return abilityModel.getAbilityPropertyValue(ability, 'damage')*v;
            }
        },
        {
            attributeName: 'building_damage',
            label: 'BUILDING DAMAGE:',
            ignoreTooltip: true,
            controlType: 'text',
            fn: function (v, a, parent, index, abilityModel, ability) {
                return v*a;
            }
        },
        {
            attributeName: 'slow_movement_speed',
            label: 'Enemy Movement Speed Slow',
            controlType: 'text',
            fn: function (v, a, parent, index, abilityModel, ability) {
                return a;
            },
            returnProperty: 'movementSpeedPctReduction'
        }
    ],
    'spectre_desolate': [
        {
            label: 'Enemy Alone',
            controlType: 'checkbox'
        },
        {
            attributeName: 'bonus_damage',
            label: 'Total Damage',
            controlType: 'text',
            fn: function (v, a, parent, index, abilityModel, ability) {
                if (v) {
                    return a;
                }
                else {
                    return 0;
                }
            },
            returnProperty: 'bonusDamage'
        }
    ],
    'spectre_dispersion': [
        {
            label: 'Damage Taken',
            controlType: 'input'
        },
        {
            attributeName: 'damage_reflection_pct',
            label: 'DAMAGE REFLECTED:',
            controlType: 'text',
            fn: function (v, a, parent, index, abilityModel, ability) {
                return -a;
            },
            returnProperty: 'damageReduction'
        },
        {
            attributeName: 'damage_reflection_pct',
            label: 'DAMAGE REFLECTED:',
            ignoreTooltip: true,
            controlType: 'text',
            fn: function (v, a, parent, index, abilityModel, ability) {
                return v*a/100;
            }
        }
    ],
    'storm_spirit_ball_lightning': [
        {
            label: 'MAX MANA',
            controlType: 'input'
        },
        {
            label: 'Distance',
            controlType: 'input'
        },
        {
            attributeName: 'ball_lightning_initial_mana_base',
            label: 'Total Damage:',
            ignoreTooltip: true,
            controlType: 'text',
            controls: [0, 1],
            fn: function (v, a, parent, index, abilityModel, ability) {
                return abilityModel.getAbilityPropertyValue(ability, 'damage')/100*v[1];
            }
        },
        {
            attributeName: 'ball_lightning_initial_mana_base',
            label: 'FLAT MANA COST:',
            ignoreTooltip: true,
            controlType: 'method',
            controls: [0, 1],
            fn: function (v, a, parent, index, abilityModel, ability) {
                var distance_intervals = Math.floor(v[1]/100);
                var travel_cost_base = abilityModel.getAbilityAttributeValue(ability.attributes, 'ball_lightning_travel_cost_base',0);
                return a + distance_intervals * travel_cost_base;
            }
        },
        {
            attributeName: 'ball_lightning_initial_mana_percentage',
            label: '%MAX MANA COST:',
            ignoreTooltip: true,
            controlType: 'method',
            controls: [0, 1],
            fn: function (v, a, parent, index, abilityModel, ability) {
                var distance_intervals = Math.floor(v[1]/100);
                var travel_cost_percent = abilityModel.getAbilityAttributeValue(ability.attributes, 'ball_lightning_travel_cost_percent',0);
                return a + distance_intervals * travel_cost_percent;
            }
        },
        {
            attributeName: 'ball_lightning_initial_mana_base',
            label: 'TOTAL MANA COST:',
            ignoreTooltip: true,
            controlType: 'text',
            controls: [0, 1, 2, 3],
            fn: function (v, a, parent, index, abilityModel, ability) {
                return v[2] + ' + ' + (v[3]/100 * v[0]) + ' (' + v[3] + '% of max) = ' + (v[2] + v[3]/100 * v[0]);
            }
        }
    ],
    'templar_assassin_psionic_trap': [
        {
            label: 'Charge Time',
            controlType: 'input'
        },
        {
            attributeName: 'movement_speed_min_tooltip',
            label: '%MOVE SLOW:',
            ignoreTooltip: true,
            controlType: 'text',
            fn: function (v, a, parent, index, abilityModel, ability) {
                var max_slow = abilityModel.getAbilityAttributeValue(ability.attributes, 'movement_speed_max_tooltip',0);
                var slow_per_tick = (max_slow - a)/40;
                return -(a + slow_per_tick * Math.min(Math.max(0, v), 4) * 10);
            },
            returnProperty: 'movementSpeedPctReduction'
        }
    ],
    'shredder_reactive_armor': [
        {
            label: 'Stacks',
            controlType: 'input'
        },
        {
            attributeName: 'bonus_armor',
            label: 'Total Armor Bonus',
            controlType: 'text',
            noLevel: true,
            fn: function (v, a, parent, index, abilityModel, ability) {
                return v*a;
            },
            returnProperty: 'armor'
        },
        {
            attributeName: 'bonus_hp_regen',
            label: 'Total HP Regen Bonus',
            controlType: 'text',
            noLevel: true,
            fn: function (v, a, parent, index, abilityModel, ability) {
                return v*a;
            },
            returnProperty: 'healthregen'
        }
    ],
    'shredder_chakram': [
        {
            label: 'Duration',
            controlType: 'input'
        },
        {
            attributeName: 'damage_per_second',
            label: 'DAMAGE:',
            ignoreTooltip: true,
            controlType: 'text',
            fn: function (v, a, parent, index, abilityModel, ability) {
                var interval = abilityModel.getAbilityAttributeValue(ability.attributes, 'damage_interval',0);
                var ticks = Math.floor(v / interval);
                return a*interval*ticks;
            }
        },
        {
            attributeName: 'mana_per_second',
            label: 'MANA COST:',
            ignoreTooltip: true,
            controlType: 'text',
            fn: function (v, a, parent, index, abilityModel, ability) {
                var interval = abilityModel.getAbilityAttributeValue(ability.attributes, 'damage_interval',0);
                var ticks = Math.floor(v / interval);
                return a*interval*ticks;
            }
        },
        {
            label: 'ENEMY %HP',
            controlType: 'input'
        },
        {
            attributeName: 'slow',
            label: 'MANA COST:',
            controlType: 'text',
            fn: function (v, a, parent, index, abilityModel, ability) {
                var ticks = 20 - Math.floor(Math.min(Math.max(v-1, 0), 99) / 5);
                return -a*ticks;
            },
            returnProperty: 'movementSpeedPctReduction'
        }
    ],
    'spirit_breaker_greater_bash': [
        {
            label: 'Bash Proc',
            controlType: 'checkbox'
        },
        {
            attributeName: 'damage',
            label: '%MOVESPEED AS DAMAGE',
            controlType: 'text',
            fn: function (v, a, parent, index, abilityModel, ability) {
                if (v) {
                    return a;
                }
                else {
                    return 0;
                }
            },
            returnProperty: 'bashBonusDamage'
        },
        {
            attributeName: 'bonus_movespeed_pct',
            label: 'Total Damage',
            controlType: 'text',
            fn: function (v, a, parent, index, abilityModel, ability) {
                if (v) {
                    return a;
                }
                else {
                    return 0;
                }
            },
            returnProperty: 'movementSpeedPct'
        },
        {
            attributeName: 'chance_pct',
            label: 'Total Damage',
            controlType: 'text',
            fn: function (v, a, parent, index, abilityModel, ability) {
                return a
            },
            returnProperty: 'bash'
        }
    ],
    'techies_land_mines': [
        {
            label: 'Number of Mines',
            controlType: 'input'
        },
        {
            attributeName: 'damage',
            label: 'Total Damage',
            controlType: 'text',
            fn: function (v, a, parent, index, abilityModel, ability) {
                return v*a;
            }
        },
        {
            attributeName: 'damage',
            label: 'AFTER REDUCTIONS:',
            ignoreTooltip: true,
            controlType: 'text',
            fn: function (v, a, parent, index, abilityModel, ability) {
                var phys_reduction = parent.enemy().totalArmorPhysicalReduction(),
                    magic_reduction = parent.enemy().totalMagicResistance();
                return (v * a * (1 - phys_reduction / 100) * (1 - magic_reduction / 100)).toFixed(2);
            }
        }
    ],
    'techies_suicide': [
        {
            attributeName: 'damage',
            label: 'FULL DAMAGE AFTER REDUCTIONS:',
            ignoreTooltip: true,
            controlType: 'text',
            fn: function (v, a, parent, index, abilityModel, ability) {
                var phys_reduction = parent.enemy().totalArmorPhysicalReduction(),
                    magic_reduction = parent.enemy().totalMagicResistance();
                return (a * (1 - phys_reduction / 100) * (1 - magic_reduction / 100)).toFixed(2);
            }
        },
        {
            attributeName: 'partial_damage',
            label: 'PARTIAL DAMAGE AFTER REDUCTIONS:',
            ignoreTooltip: true,
            controlType: 'text',
            fn: function (v, a, parent, index, abilityModel, ability) {
                var phys_reduction = parent.enemy().totalArmorPhysicalReduction(),
                    magic_reduction = parent.enemy().totalMagicResistance();
                return (a * (1 - phys_reduction / 100) * (1 - magic_reduction / 100)).toFixed(2);
            }
        },
        {
            attributeName: 'damage',
            label: 'RESPAWN TIME:',
            ignoreTooltip: true,
            controlType: 'text',
            fn: function (v, a, parent, index, abilityModel, ability) {
                return (parent.respawnTime() / 2).toFixed(0) + ' seconds';
            }
        }
    ],
    'techies_remote_mines': [
        {
            label: 'Number of Mines',
            controlType: 'input'
        },
        {
            attributeName: 'damage',
            label: 'Total Damage',
            controlType: 'text',
            fn: function (v, a, parent, index, abilityModel, ability) {
                return v*a;
            }
        },
        {
            attributeName: 'damage',
            label: 'AFTER REDUCTIONS:',
            ignoreTooltip: true,
            controlType: 'text',
            fn: function (v, a, parent, index, abilityModel, ability) {
                var magic_reduction = parent.enemy().totalMagicResistance();
                return (v * a * (1 - magic_reduction / 100)).toFixed(2);
            }
        }
    ],
    'tinker_march_of_the_machines': [
        {
            label: 'Robot Explosions',
            controlType: 'input'
        },
        {
            attributeName: 'machines_per_sec',
            label: 'TOTAL DAMAGE:',
            ignoreTooltip: true,
            controlType: 'text',
            fn: function (v, a, parent, index, abilityModel, ability) {
                return abilityModel.getAbilityPropertyValue(ability, 'damage')*v;
            }
        }
    ],
    'treant_leech_seed': [
        {
            label: 'Pulses',
            controlType: 'input'
        },
        {
            attributeName: 'leech_damage',
            label: 'DAMAGE/HEAL:',
            ignoreTooltip: true,
            controlType: 'text',
            fn: function (v, a, parent, index, abilityModel, ability) {
                return v*a;
            }
        },
        {
            attributeName: 'movement_slow',
            label: 'Total Damage',
            controlType: 'text',
            fn: function (v, a, parent, index, abilityModel, ability) {
                return a;
            },
            returnProperty: 'movementSpeedPctReduction'
        }
    ],
    'troll_warlord_fervor': [
        {
            label: 'Stacks',
            controlType: 'input'
        },
        {
            attributeName: 'attack_speed',
            label: 'ATTACK SPEED:',
            ignoreTooltip: true,
            controlType: 'text',
            fn: function (v, a, parent, index, abilityModel, ability) {
                return v*a;
            },
            returnProperty: 'attackspeed'
        }
    ],
    'undying_decay': [
        {
            label: 'Stacks',
            controlType: 'input'
        },
        {
            attributeName: 'str_steal',
            label: 'STRENGTH STOLEN:',
            ignoreTooltip: true,
            controlType: 'text',
            fn: function (v, a, parent, index, abilityModel, ability) {
                if (parent.inventory.hasScepter()) {
                    var str_steal_scepter = abilityModel.getAbilityAttributeValue(ability.attributes, 'str_steal_scepter',0);
                    return v*str_steal_scepter;
                }
                else {
                    return v*a;
                }
            },
            returnProperty: 'bonusStrength'
        },
    ],
    'undying_soul_rip': [
        {
            label: 'Units',
            controlType: 'input'
        },
        {
            attributeName: 'damage_per_unit',
            label: 'DAMAGE/HEAL:',
            ignoreTooltip: true,
            controlType: 'text',
            fn: function (v, a, parent, index, abilityModel, ability) {
                return v*a;
            }
        }
    ],
    'undying_flesh_golem': [
        {
            label: 'Distance',
            controlType: 'input'
        },
        {
            attributeName: 'max_speed_slow',
            label: '%MOVE SLOW:',
            ignoreTooltip: true,
            controlType: 'text',
            fn: function (v, a, parent, index, abilityModel, ability) {
                var min_speed_slow = abilityModel.getAbilityAttributeValue(ability.attributes, 'min_speed_slow', 0);
                var radius = abilityModel.getAbilityAttributeValue(ability.attributes, 'radius', 0);
                var full_power_radius = abilityModel.getAbilityAttributeValue(ability.attributes, 'full_power_radius', 0);
                var distance = Math.min(Math.max(v, full_power_radius), radius);
                var scale = 1 - (distance - full_power_radius) / (radius - full_power_radius);
                return -Math.max(scale * a, min_speed_slow);
            },
            returnProperty: 'movementSpeedPctReduction'
        },
        {
            attributeName: 'max_damage_amp',
            label: '%DAMAGE AMP:',
            ignoreTooltip: true,
            controlType: 'text',
            fn: function (v, a, parent, index, abilityModel, ability) {
                var min_damage_amp = abilityModel.getAbilityAttributeValue(ability.attributes, 'min_damage_amp', 0);
                var radius = abilityModel.getAbilityAttributeValue(ability.attributes, 'radius', 0);
                var full_power_radius = abilityModel.getAbilityAttributeValue(ability.attributes, 'full_power_radius', 0);
                var distance = Math.min(Math.max(v, full_power_radius), radius);
                var scale = 1 - (distance - full_power_radius) / (radius - full_power_radius);
                return Math.max(scale * a, min_damage_amp);
            },
            returnProperty: 'damageAmplification'
        },
        {
            label: 'MAX HP',
            controlType: 'input'
        },
        {
            label: 'Hero Death Count',
            controlType: 'input'
        },
        {
            label: 'Creep Death Count',
            controlType: 'input'
        },
        {
            attributeName: 'death_heal',
            label: 'DEATH HEAL (HEROES):',
            ignoreTooltip: true,
            controlType: 'method',
            controls: [1, 2],
            fn: function (v, a, parent, index, abilityModel, ability) {
                return v[0]*v[1]*a/100;
            }
        },
        {
            attributeName: 'death_heal_creep',
            label: 'DEATH HEAL (CREEPS):',
            ignoreTooltip: true,
            controlType: 'method',
            controls: [1, 3],
            fn: function (v, a, parent, index, abilityModel, ability) {
                return v[0]*v[1]*a/100;
            }
        },
        {
            attributeName: 'death_heal_creep',
            label: 'TOTAL DEATH HEAL:',
            ignoreTooltip: true,
            controlType: 'text',
            controls: [4, 5],
            fn: function (v, a, parent, index, abilityModel, ability) {
                return v[0]+v[1];
            }
        }
    ],
    'ursa_fury_swipes': [
        {
            label: 'Stacks',
            controlType: 'input'
        },
        {
            attributeName: 'damage_per_stack',
            label: 'Total Damage',
            controlType: 'text',
            fn: function (v, a, parent, index, abilityModel, ability) {
                var enrageAbility = abilityModel.abilities().find(function(b) {
                    return b.name == 'ursa_enrage';
                });
                if (enrageAbility.isActive() && enrageAbility.level() > 0) {
                    var enrage_multiplier = abilityModel.getAbilityAttributeValue(enrageAbility.attributes, 'enrage_multiplier', enrageAbility.level());
                    return v*a*enrage_multiplier;
                }
                return v*a;
            },
            returnProperty: 'bonusDamage'
        }
    ],
    'ursa_enrage': [
        {
            attributeName: 'damage_reduction',
            label: 'Total Damage',
            controlType: 'text',
            fn: function (v, a, parent, index, abilityModel, ability) {
                return -a;
            },
            returnProperty: 'damageReduction'
        }
    ],
    'venomancer_venomous_gale': [
        {
            label: 'Duration',
            controlType: 'input'
        },
        {
            attributeName: 'tick_damage',
            label: 'Total Damage',
            controlType: 'text',
            fn: function (v, a, parent, index, abilityModel, ability) {
                return abilityModel.getAbilityAttributeValue(ability.attributes, 'strike_damage',ability.level()) + Math.floor(v/3)*a;
            }
        },
        {
            attributeName: 'movement_slow',
            label: 'Total Damage',
            controlType: 'text',
            fn: function (v, a, parent, index, abilityModel, ability) {
                return a;
            },
            returnProperty: 'movementSpeedPctReduction'
        }
    ],
    'venomancer_poison_sting': [
        {
            label: 'Duration',
            controlType: 'input'
        },
        {
            attributeName: 'damage',
            label: 'Total Damage',
            controlType: 'text',
            fn: function (v, a, parent, index, abilityModel, ability) {
                return v*a;
            }
        },
        {
            attributeName: 'movement_speed',
            label: 'Total Damage',
            controlType: 'text',
            fn: function (v, a, parent, index, abilityModel, ability) {
                return a;
            },
            returnProperty: 'movementSpeedPctReduction'
        }
    ],
    'venomancer_poison_nova': [
        {
            label: 'Duration',
            controlType: 'input'
        },
        {
            attributeName: 'damage',
            label: 'Total Damage',
            controlType: 'text',
            fn: function (v, a, parent, index, abilityModel, ability) {
                return v*a;
            }
        }
    ],
    'viper_poison_attack': [
        {
            label: 'Duration',
            controlType: 'input'
        },
        {
            attributeName: 'damage',
            label: 'Total Damage',
            controlType: 'text',
            fn: function (v, a, parent, index, abilityModel, ability) {
                return v*a;
            }
        },
        {
            attributeName: 'bonus_movement_speed',
            label: 'Total Damage',
            controlType: 'text',
            fn: function (v, a, parent, index, abilityModel, ability) {
                return a;
            },
            returnProperty: 'movementSpeedPctReduction'
        },
        {
            attributeName: 'bonus_attack_speed',
            label: 'Total Damage',
            controlType: 'text',
            fn: function (v, a, parent, index, abilityModel, ability) {
                return a;
            },
            returnProperty: 'attackspeedreduction'
        }
    ],
    'viper_corrosive_skin': [
        {
            label: 'Duration',
            controlType: 'input'
        },
        {
            attributeName: 'damage',
            label: 'Total Damage',
            controlType: 'text',
            fn: function (v, a, parent, index, abilityModel, ability) {
                return v*a;
            }
        },
        {
            attributeName: 'bonus_movement_speed',
            label: 'Total Damage',
            controlType: 'text',
            fn: function (v, a, parent, index, abilityModel, ability) {
                return a;
            },
            returnProperty: 'movementSpeedPctReduction'
        },
        {
            attributeName: 'bonus_attack_speed',
            label: 'Total Damage',
            controlType: 'text',
            fn: function (v, a, parent, index, abilityModel, ability) {
                return a;
            },
            returnProperty: 'attackspeedreduction'
        },
        {
            attributeName: 'bonus_magic_resistance',
            label: 'Total Damage',
            controlType: 'text',
            fn: function (v, a, parent, index, abilityModel, ability) {
                return a;
            },
            returnProperty: 'magicResist'
        }
    ],
    'viper_viper_strike': [
        {
            label: 'Duration',
            controlType: 'input'
        },
        {
            attributeName: 'damage',
            label: 'Total Damage',
            controlType: 'text',
            fn: function (v, a, parent, index, abilityModel, ability) {
                return v*a;
            }
        },
        {
            attributeName: 'bonus_movement_speed',
            label: 'Total Damage',
            controlType: 'text',
            fn: function (v, a, parent, index, abilityModel, ability) {
                return a;
            },
            returnProperty: 'movementSpeedPctReduction'
        },
        {
            attributeName: 'bonus_attack_speed',
            label: 'Total Damage',
            controlType: 'text',
            fn: function (v, a, parent, index, abilityModel, ability) {
                return a;
            },
            returnProperty: 'attackspeedreduction'
        }
    ],
    'visage_soul_assumption': [
        {
            label: 'Charges',
            controlType: 'input'
        },
        {
            attributeName: 'soul_charge_damage',
            label: 'Total Damage:',
            ignoreTooltip: true,
            controlType: 'text',
            fn: function (v, a, parent, index, abilityModel, ability) {
                var soul_base_damage = abilityModel.getAbilityAttributeValue(ability.attributes, 'soul_base_damage',0);
                var stack_limit = abilityModel.getAbilityAttributeValue(ability.attributes, 'stack_limit', ability.level());
                stack_limit = Math.max(Math.min(v, stack_limit), 0);
                return soul_base_damage + stack_limit*a;
            }
        }
    ],
    'visage_gravekeepers_cloak': [
        {
            label: 'Layers',
            controlType: 'input'
        },
        {
            attributeName: 'bonus_armor',
            label: 'ARMOR:',
            ignoreTooltip: true,
            controlType: 'text',
            fn: function (v, a, parent, index, abilityModel, ability) {
                return v*a;
            },
            returnProperty: 'armor'
        },
        {
            attributeName: 'bonus_resist',
            label: '%RESIST:',
            ignoreTooltip: true,
            controlType: 'text',
            fn: function (v, a, parent, index, abilityModel, ability) {
                return v*a;
            },
            returnProperty: 'magicResist'
        }
    ],
    'warlock_shadow_word': [
        {
            label: 'Duration',
            controlType: 'input'
        },
        {
            label: 'DAMAGE:',
            ignoreTooltip: true,
            controlType: 'text',
            fn: function (v, a, parent, index, abilityModel, ability) {
                return abilityModel.getAbilityPropertyValue(ability, 'damage')*v;
            }
        }
    ],
    'warlock_upheaval': [
        {
            label: 'Channel Duration',
            controlType: 'input'
        },
        {
            attributeName: 'slow_rate_duration',
            label: '%MOVE SLOW:',
            ignoreTooltip: true,
            controlType: 'text',
            fn: function (v, a, parent, index, abilityModel, ability) {
                var max_slow = abilityModel.getAbilityAttributeValue(ability.attributes, 'max_slow',0);
                var slow_per_tick = max_slow / (a - 0.5) / 2;
                var ticks = Math.max(Math.floor(v * 2) - 1, 0);
                return -Math.min(ticks * slow_per_tick, max_slow);
            },
            returnProperty: 'movementSpeedPctReduction'
        }
    ],
    'weaver_the_swarm': [
        {
            label: 'Attacks',
            controlType: 'input'
        },
        {
            attributeName: 'damage',
            label: 'DAMAGE:',
            controlType: 'text',
            fn: function (v, a, parent, index, abilityModel, ability) {
                return v*a;
            }
        },
        {
            attributeName: 'armor_reduction',
            label: 'DAMAGE:',
            controlType: 'text',
            fn: function (v, a, parent, index, abilityModel, ability) {
                return -v*a;
            },
            returnProperty: 'armorReduction'
        }
    ],
    'windrunner_powershot': [
        {
            label: 'Duration',
            controlType: 'input'
        },
        {
            label: 'DAMAGE:',
            ignoreTooltip: true,
            controlType: 'text',
            fn: function (v, a, parent, index, abilityModel, ability) {
                return abilityModel.getAbilityPropertyValue(ability, 'damage')*v;
            }
        }
    ],
    'winter_wyvern_cold_embrace': [
        {
            label: 'Duration',
            controlType: 'input'
        },
        {
            label: 'Ally Max Health',
            controlType: 'input'
        },
        {
            attributeName: 'heal_percentage',
            label: 'TOTAL HEAL:',
            ignoreTooltip: true,
            controlType: 'text',
            controls: [0,1],
            fn: function (v, a, parent, index, abilityModel, ability) {
                var base_heal = abilityModel.getAbilityAttributeValue(ability.attributes, 'heal_additive',ability.level());
                return (base_heal + v[1] * a/100) * v[0];
            }
        }
    ],
    'wisp_spirits': [
        {
            label: 'Collision Count',
            controlType: 'input'
        },
        {
            attributeName: 'hero_damage',
            label: 'Total Damage',
            controlType: 'text',
            fn: function (v, a, parent, index, abilityModel, ability) {
                return v*a;
            }
        },
        {
            attributeName: 'creep_damage',
            label: 'Total Damage',
            controlType: 'text',
            fn: function (v, a, parent, index, abilityModel, ability) {
                return v*a;
            }
        }
    ],
    'wisp_overcharge': [
        {
            label: 'Current HP',
            controlType: 'input'
        },
        {
            attributeName: 'drain_pct',
            label: 'HP DRAINED:',
            ignoreTooltip: true, 
            controlType: 'text',
            fn: function (v, a, parent, index, abilityModel, ability) {
                return v*a;
            }
        },
        {
            label: 'Current MP',
            controlType: 'input'
        },
        {
            attributeName: 'drain_pct',
            label: 'MP DRAINED:',
            ignoreTooltip: true, 
            controlType: 'text',
            fn: function (v, a, parent, index, abilityModel, ability) {
                return v*a;
            }
        },
        {
            attributeName: 'bonus_attack_speed',
            label: 'Total Damage',
            controlType: 'text',
            fn: function (v, a, parent, index, abilityModel, ability) {
                return a;
            },
            returnProperty: 'attackspeed'
        },
        {
            attributeName: 'bonus_damage_pct',
            label: 'Total Damage',
            controlType: 'text',
            fn: function (v, a, parent, index, abilityModel, ability) {
                return a;
            },
            returnProperty: 'damageReduction'
        }
    ],
    'witch_doctor_paralyzing_cask': [
        {
            label: 'Hero Bounce Count',
            controlType: 'input'
        },
        {
            attributeName: 'hero_damage',
            label: 'Total Damage',
            controlType: 'text',
            fn: function (v, a, parent, index, abilityModel, ability) {
                var bounces = abilityModel.getAbilityAttributeValue(ability.attributes, 'bounces',ability.level());
                return Math.min(Math.max(v, 0), bounces)*a;
            }
        },
        {
            label: 'Creep Bounce Count',
            controlType: 'input'
        },
        {
            attributeName: 'hero_damage',
            label: 'CREEP DAMAGE:',
            ignoreTooltip: true,
            controlType: 'text',
            fn: function (v, a, parent, index, abilityModel, ability) {
                var bounces = abilityModel.getAbilityAttributeValue(ability.attributes, 'bounces',ability.level());
                var damage = abilityModel.getAbilityPropertyValue(ability, 'damage');
                return Math.min(Math.max(v, 0), bounces)*damage;
            }
        }
    ],
    'witch_doctor_voodoo_restoration': [
        {
            label: 'Duration',
            controlType: 'input'
        },
        {
            attributeName: 'heal',
            label: 'Total Damage',
            controlType: 'text',
            fn: function (v, a, parent, index, abilityModel, ability) {
                var interval = abilityModel.getAbilityAttributeValue(ability.attributes, 'heal_interval',ability.level());
                var heal_per_tick = a * interval;
                var ticks = Math.max(Math.floor(v / interval) - 1, 0);
                return heal_per_tick * ticks;
            }
        },
        {
            attributeName: 'mana_per_second',
            label: 'MANA COST:',
            ignoreTooltip: true,
            controlType: 'text',
            fn: function (v, a, parent, index, abilityModel, ability) {
                var interval = abilityModel.getAbilityAttributeValue(ability.attributes, 'heal_interval',ability.level());
                var mana_per_tick = a * interval;
                var ticks = Math.max(Math.floor(v / interval) - 1, 0);
                return mana_per_tick * ticks;
            }
        }
    ],
    'witch_doctor_maledict': [
        {
            label: 'damage 0-4s',
            controlType: 'input'
        },
        {
            label: 'damage 4-8s',
            controlType: 'input'
        },
        {
            label: 'damage 8-12s',
            controlType: 'input'
        },
        {
            attributeName: 'bonus_damage',
            label: 'Dot Damage after 3s:',
            ignoreTooltip: true,
            controlType: 'method',
            fn: function (v, a, parent, index, abilityModel, ability) {
                var damage = abilityModel.getAbilityPropertyValue(ability, 'damage');
                return 3*damage;
            }
        },
        {
            attributeName: 'bonus_damage',
            label: 'Burst Damage at 4s:',
            ignoreTooltip: true,
            controlType: 'method',
            controls: [0, 3],
            fn: function (v, a, parent, index, abilityModel, ability) {
                var damage = abilityModel.getAbilityPropertyValue(ability, 'damage');
                var d = v.reduce(function (memo, o) { return memo + o }, 0);
                return Math.max(d, 0) * a/100;
            }
        },
        {
            attributeName: 'bonus_damage',
            label: 'Dot Damage after 7s:',
            ignoreTooltip: true,
            controlType: 'method',
            fn: function (v, a, parent, index, abilityModel, ability) {
                var damage = abilityModel.getAbilityPropertyValue(ability, 'damage');
                return 7*damage;
            }
        },
        {
            attributeName: 'bonus_damage',
            label: 'Burst Damage at 8s:',
            ignoreTooltip: true,
            controlType: 'method',
            controls: [0, 1, 4, 5],
            fn: function (v, a, parent, index, abilityModel, ability) {
                var damage = abilityModel.getAbilityPropertyValue(ability, 'damage');
                var d = v.reduce(function (memo, o) { return memo + o }, 0);
                return Math.max(d, 0) * a/100;
            }
        },
        {
            attributeName: 'bonus_damage',
            label: 'Dot Damage after 11s:',
            ignoreTooltip: true,
            controlType: 'method',
            fn: function (v, a, parent, index, abilityModel, ability) {
                var damage = abilityModel.getAbilityPropertyValue(ability, 'damage');
                return 11*damage;
            }
        },
        {
            attributeName: 'bonus_damage',
            label: 'Burst Damage at 12s:',
            ignoreTooltip: true,
            controlType: 'method',
            controls: [0, 1, 2, 4, 6, 7],
            fn: function (v, a, parent, index, abilityModel, ability) {
                var damage = abilityModel.getAbilityPropertyValue(ability, 'damage');
                var d = v.reduce(function (memo, o) { return memo + o }, 0);
                return Math.max(d, 0) * a/100;
            }
        },
        {
            attributeName: 'bonus_damage',
            label: 'Total Burst Damage:',
            ignoreTooltip: true,
            controlType: 'method',
            controls: [4, 6, 8],
            fn: function (v, a, parent, index, abilityModel, ability) {
                return v.reduce(function (memo, o) { return memo + o }, 0);
            }
        },
        {
            attributeName: 'bonus_damage',
            label: 'Total Maledict Damage:',
            ignoreTooltip: true,
            controlType: 'method',
            controls: [9],
            fn: function (v, a, parent, index, abilityModel, ability) {
                var duration = abilityModel.getAbilityAttributeValue(ability.attributes, 'duration_tooltip',0);
                var damage = abilityModel.getAbilityPropertyValue(ability, 'damage');
                return damage * duration + v[0];
            }
        },
        {
            label: 'Duration',
            controlType: 'input'
        },
        {
            attributeName: 'bonus_damage',
            label: 'DOT Damage',
            controlType: 'text',
            fn: function (v, a, parent, index, abilityModel, ability) {
                var duration = abilityModel.getAbilityAttributeValue(ability.attributes, 'duration_tooltip',0);
                return abilityModel.getAbilityPropertyValue(ability, 'damage')*Math.min(Math.max(v, 0), duration);
            }
        }
    ],
    'witch_doctor_death_ward': [
        {
            label: 'Duration',
            controlType: 'input'
        },
        {
            attributeName: 'damage',
            label: 'Total Damage',
            controlType: 'text',
            fn: function (v, a, parent, index, abilityModel, ability) {
                return v*a;
            }
        }
    ],
    'zuus_static_field': [
        {
            label: 'Enemy HP',
            controlType: 'input'
        },
        {
            attributeName: 'damage_health_pct',
            label: 'DAMAGE:',
            ignoreTooltip: true,
            controlType: 'text',
            fn: function (v, a, parent, index, abilityModel, ability) {
                return v*a/100;
            }
        }
    ]
}
},{"./herocalc_core":47}],46:[function(require,module,exports){
'use strict';
var ko = require('./herocalc_knockout');
    
var my = require("./herocalc_core");

my.prototype.BuffOption = function (hero, ability) {
    this.buffName = ability;
    if (my.prototype.heroData['npc_dota_hero_' + hero] == undefined) {
        this.hero = hero;
        this.abilityData = my.prototype.findWhere(my.prototype.unitData[hero].abilities, {name: ability})
        this.buffDisplayName = my.prototype.unitData[hero].displayname + ' - ' + this.abilityData.displayname;
    }
    else {
        this.hero = 'npc_dota_hero_' + hero;
        this.abilityData = my.prototype.findWhere(my.prototype.heroData['npc_dota_hero_' + hero].abilities, {name: ability})
        this.buffDisplayName = my.prototype.heroData['npc_dota_hero_' + hero].displayname + ' - ' + this.abilityData.displayname;        
        if (ability == 'sven_gods_strength') {
            this.buffDisplayName += ' (Aura for allies)';
        }
    }

};

my.prototype.ItemBuffOption = function (item) {
    this.buffName = item;
    if (my.prototype.heroData['npc_dota_hero_' + hero] == undefined) {
        this.hero = hero;
        this.abilityData = my.prototype.findWhere(my.prototype.unitData[hero].abilities, {name: item})
        this.buffDisplayName = my.prototype.unitData[hero].displayname + ' - ' + this.abilityData.displayname;        
    }
    else {
        this.hero = 'npc_dota_hero_' + hero;
        this.abilityData = my.prototype.findWhere(my.prototype.heroData['npc_dota_hero_' + hero].abilities, {name: item})
        this.buffDisplayName = my.prototype.heroData['npc_dota_hero_' + hero].displayname + ' - ' + this.abilityData.displayname;        
    }

};

my.prototype.BuffViewModel = function (a) {
    var self = new my.prototype.AbilityModel(ko.observableArray([]));
    self.availableBuffs = ko.observableArray(my.prototype.availableBuffs);
    self.availableDebuffs = ko.observableArray(my.prototype.availableDebuffs);
    self.selectedBuff = ko.observable(self.availableBuffs()[0]);
    
    self.buffs = ko.observableArray([]);
    self.itemBuffs = new my.prototype.InventoryViewModel();
    
    self.addBuff = function (data, event) {
        if (my.prototype.findWhere(self.buffs(), { name: self.selectedBuff().buffName })  == undefined) {
            var a = JSON.parse(JSON.stringify(self.selectedBuff().abilityData));
            a.level = ko.observable(0);
            a.isActive = ko.observable(false);
            a.isDetail = ko.observable(false);
            a.baseDamage = ko.observable(0);
            a.bash = ko.observable(0);
            a.bashBonusDamage = ko.observable(0);
            a.bonusDamage = ko.observable(0);
            a.bonusDamageOrb = ko.observable(0);
            a.bonusDamagePct = ko.observable(0);
            a.bonusDamagePrecisionAura = ko.observable(0);
            a.bonusDamageReduction = ko.observable(0);
            a.bonusHealth = ko.observable(0);
            a.bonusStrength = ko.observable(0);
            a.bonusStrength2 = ko.observable(0);
            a.bonusAgility = ko.observable(0);
            a.bonusAgility2 = ko.observable(0);
            a.bonusInt = ko.observable(0);
            a.bonusAllStatsReduction = ko.observable(0);
            a.damageAmplification = ko.observable(0);
            a.damageReduction = ko.observable(0);
            a.evasion = ko.observable(0);
            a.magicResist = ko.observable(0);
            a.manaregen = ko.observable(0);
            a.manaregenreduction = ko.observable(0);
            a.missChance = ko.observable(0);
            a.movementSpeedFlat = ko.observable(0);
            a.movementSpeedPct = ko.observable(0);
            a.movementSpeedPctReduction = ko.observable(0);
            a.turnRateReduction = ko.observable(0);
            a.attackrange = ko.observable(0);
            a.attackspeed = ko.observable(0);
            a.attackspeedreduction = ko.observable(0);
            a.armor = ko.observable(0);
            a.armorReduction = ko.observable(0);
            a.healthregen = ko.observable(0);
            a.lifesteal = ko.observable(0);
            a.visionnight = ko.observable(0);
            a.visionday = ko.observable(0);
            switch (a.name) {
                case 'invoker_cold_snap':
                case 'invoker_ghost_walk':
                case 'invoker_tornado':
                case 'invoker_emp':
                case 'invoker_alacrity':
                case 'invoker_chaos_meteor':
                case 'invoker_sun_strike':
                case 'invoker_forge_spirit':
                case 'invoker_ice_wall':
                case 'invoker_deafening_blast':
                    a.level(1);
                break;
            }
            self.abilities.push(a);
            self.buffs.push({ name: self.selectedBuff().buffName, hero: self.selectedBuff().hero, data: a });
        }
    };
    
    self.removeBuff = function (data, event, abilityName) {
        if (my.prototype.findWhere(self.buffs(), { name: abilityName })  != undefined) {
                self.buffs.remove(my.prototype.findWhere(self.buffs(), { name: abilityName }));
                if (self.abilityControlData[abilityName] != undefined) {
                    for (var i = 0; i < self.abilityControlData[abilityName].data.length; i++) {
                        if (self.abilityControlData[abilityName].data[i].controlVal.dispose != undefined) {
                            self.abilityControlData[abilityName].data[i].controlVal.dispose();
                        }
                        if (self.abilityControlData[abilityName].data[i].clean != undefined) {
                            self.abilityControlData[abilityName].data[i].clean.dispose();
                        }
                    }
                    self.abilityControlData[abilityName] = undefined;
                }
                for (var i = 0; i < self.abilities().length; i++) {
                    if (self.abilities()[i].name == abilityName) {
                        self.abilities()[i].level(0);
                        self.abilities.remove(self.abilities()[i]);
                        break;
                    }
                }
        }
    };
    self.toggleBuff = function (index, data, event) {
        if (self.buffs()[index()].data.behavior.indexOf('DOTA_ABILITY_BEHAVIOR_PASSIVE') < 0) {
            if (self.buffs()[index()].data.isActive()) {
                self.buffs()[index()].data.isActive(false);
                self.abilities()[index()].isActive(false);
            }
            else {
                self.buffs()[index()].data.isActive(true);
                self.abilities()[index()].isActive(true);
            }
        }
    }.bind(this);

    self.toggleBuffDetail = function (index, data, event) {
        if (self.buffs()[index()].data.isDetail()) {
            self.buffs()[index()].data.isDetail(false);
        }
        else {
            self.buffs()[index()].data.isDetail(true);
        }
    }.bind(this);

    // Overrides the ability module function to remove available skill point check
    self.levelUpAbility = function (index, data, event, hero) {
        if (self.abilities()[index()].level() < hero.getAbilityLevelMax(data)) {
            switch(self.abilities()[index()].abilitytype) {
                case 'DOTA_ABILITY_TYPE_ULTIMATE':
                    self.abilities()[index()].level(self.abilities()[index()].level() + 1);
                break;
                default:
                    self.abilities()[index()].level(self.abilities()[index()].level() + 1);
                break;
            }
            switch (self.abilities()[index()].name) {
                case 'beastmaster_call_of_the_wild':
                case 'chen_test_of_faith':
                case 'morphling_morph_agi':
                case 'shadow_demon_shadow_poison':
                    self.abilities()[index() + 1].level(self.abilities()[index()].level());
                break;
                case 'morphling_morph_str':
                    self.abilities()[index() - 1].level(self.abilities()[index()].level());
                break;
                case 'keeper_of_the_light_spirit_form':
                    self.abilities()[index() - 1].level(self.abilities()[index()].level());
                    self.abilities()[index() - 2].level(self.abilities()[index()].level());
                case 'nevermore_shadowraze1':
                    self.abilities()[index() + 1].level(self.abilities()[index()].level());
                    self.abilities()[index() + 2].level(self.abilities()[index()].level());
                break;
                case 'nevermore_shadowraze2':
                    self.abilities()[index() - 1].level(self.abilities()[index()].level());
                    self.abilities()[index() + 1].level(self.abilities()[index()].level());
                break;
                case 'nevermore_shadowraze3':
                    self.abilities()[index() - 1].level(self.abilities()[index()].level());
                    self.abilities()[index() - 2].level(self.abilities()[index()].level());
                break;
            }
        }
    };
    self.levelDownAbility = function (index, data, event, hero) {
        if (self.abilities()[index()].level() > 0) {
            self.abilities()[index()].level(self.abilities()[index()].level() - 1);
            switch (self.abilities()[index()].name) {
                case 'beastmaster_call_of_the_wild':
                case 'chen_test_of_faith':
                case 'morphling_morph_agi':
                case 'shadow_demon_shadow_poison':
                    self.abilities()[index() + 1].level(self.abilities()[index()].level());
                break;
                case 'morphling_morph_str':
                    self.abilities()[index() - 1].level(self.abilities()[index()].level());
                break;
                case 'keeper_of_the_light_spirit_form':
                    self.abilities()[index() - 1].level(self.abilities()[index()].level());
                    self.abilities()[index() - 2].level(self.abilities()[index()].level());
                case 'nevermore_shadowraze1':
                    self.abilities()[index() + 1].level(self.abilities()[index()].level());
                    self.abilities()[index() + 2].level(self.abilities()[index()].level());
                break;
                case 'nevermore_shadowraze2':
                    self.abilities()[index() - 1].level(self.abilities()[index()].level());
                    self.abilities()[index() + 1].level(self.abilities()[index()].level());
                break;
                case 'nevermore_shadowraze3':
                    self.abilities()[index() - 1].level(self.abilities()[index()].level());
                    self.abilities()[index() - 2].level(self.abilities()[index()].level());
                break;
                case 'ember_spirit_fire_remnant':
                    self.abilities()[index() - 1].level(self.abilities()[index()].level());
                break;
                case 'lone_druid_true_form':
                    self.abilities()[index() - 1].level(self.abilities()[index()].level());
                break;
            }
        }
    };
    
    return self;
}
},{"./herocalc_core":47,"./herocalc_knockout":53}],47:[function(require,module,exports){
'use strict';
require('./polyfill');

function HEROCALCULATOR () {
   // ...
}

var my = HEROCALCULATOR;

my.prototype.heroData = {};
my.prototype.itemData = {};
my.prototype.unitData = {};
my.prototype.abilityData = {};

my.prototype.HeroOptions = [];

my.prototype.HeroOption = function (name, displayname, hero) {
    this.heroName = name;
    this.heroDisplayName = displayname;
    this.hero = hero;
};

my.prototype.idCounter = 0;
my.prototype.uniqueId = function (prefix) {
    var id = ++my.prototype.idCounter + '';
    return prefix ? prefix + id : id;
};
my.prototype.findWhere = function (arr, obj) {
    arrLoop: for (var i = 0; i < arr.length; i++) {
        objLoop: for (var key in obj) {
            if (arr[i][key] != obj[key]) {
                continue arrLoop;
            }
        }
        return arr[i];
    }
}
my.prototype.uniques = function (arr) {
    var a = [];
    for (var i=0, l=arr.length; i<l; i++)
        if (a.indexOf(arr[i]) === -1 && arr[i] !== '')
            a.push(arr[i]);
    return a;
}
my.prototype.union = function (a, b) {
    var arr = a.concat(b);
    return my.prototype.uniques(arr);
}

my.prototype.totalResources = 3;
my.prototype.numResourcesLoaded = 0;
my.prototype.onResourceLoaded = function (callback) {
    my.prototype.numResourcesLoaded++;
    if (my.prototype.numResourcesLoaded == my.prototype.totalResources) {
        
        my.prototype.availableBuffs = [
            new my.prototype.BuffOption('abaddon', 'abaddon_frostmourne'),
            new my.prototype.BuffOption('axe', 'axe_culling_blade'),
            new my.prototype.BuffOption('beastmaster', 'beastmaster_inner_beast'),
            new my.prototype.BuffOption('bloodseeker', 'bloodseeker_bloodrage'),
            new my.prototype.BuffOption('bounty_hunter', 'bounty_hunter_track'),
            new my.prototype.BuffOption('centaur', 'centaur_stampede'),
            new my.prototype.BuffOption('crystal_maiden', 'crystal_maiden_brilliance_aura'),
            new my.prototype.BuffOption('dark_seer', 'dark_seer_surge'),
            new my.prototype.BuffOption('dazzle', 'dazzle_weave'),
            new my.prototype.BuffOption('drow_ranger', 'drow_ranger_trueshot'),
            new my.prototype.BuffOption('invoker', 'invoker_alacrity'),
            new my.prototype.BuffOption('wisp', 'wisp_tether'),
            new my.prototype.BuffOption('wisp', 'wisp_overcharge'),
            new my.prototype.BuffOption('kunkka', 'kunkka_ghostship'),
            new my.prototype.BuffOption('lich', 'lich_frost_armor'),
            new my.prototype.BuffOption('life_stealer', 'life_stealer_open_wounds'),
            new my.prototype.BuffOption('luna', 'luna_lunar_blessing'),
            new my.prototype.BuffOption('lycan', 'lycan_howl'),
            new my.prototype.BuffOption('magnataur', 'magnataur_empower'),
            new my.prototype.BuffOption('mirana', 'mirana_leap'),
            new my.prototype.BuffOption('ogre_magi', 'ogre_magi_bloodlust'),
            new my.prototype.BuffOption('omniknight', 'omniknight_guardian_angel'),
            new my.prototype.BuffOption('rubick', 'rubick_null_field'),
            new my.prototype.BuffOption('skeleton_king', 'skeleton_king_vampiric_aura'),
            new my.prototype.BuffOption('spirit_breaker', 'spirit_breaker_empowering_haste'),
            new my.prototype.BuffOption('sven', 'sven_warcry'),
            new my.prototype.BuffOption('sven', 'sven_gods_strength'),
            new my.prototype.BuffOption('treant', 'treant_living_armor'),
            new my.prototype.BuffOption('troll_warlord', 'troll_warlord_battle_trance'),
            new my.prototype.BuffOption('vengefulspirit', 'vengefulspirit_command_aura'),
            new my.prototype.BuffOption('npc_dota_neutral_alpha_wolf', 'alpha_wolf_critical_strike'),
            new my.prototype.BuffOption('npc_dota_neutral_alpha_wolf', 'alpha_wolf_command_aura'),
            new my.prototype.BuffOption('npc_dota_neutral_polar_furbolg_ursa_warrior', 'centaur_khan_endurance_aura'),
            new my.prototype.BuffOption('npc_dota_neutral_giant_wolf', 'giant_wolf_critical_strike'),
            new my.prototype.BuffOption('npc_dota_neutral_kobold_taskmaster', 'kobold_taskmaster_speed_aura'),
            new my.prototype.BuffOption('npc_dota_neutral_ogre_magi', 'ogre_magi_frost_armor'),
            new my.prototype.BuffOption('npc_dota_neutral_satyr_hellcaller', 'satyr_hellcaller_unholy_aura'),
            new my.prototype.BuffOption('npc_dota_neutral_enraged_wildkin', 'enraged_wildkin_toughness_aura'),
            new my.prototype.BuffOption('npc_dota_necronomicon_archer_1', 'necronomicon_archer_aoe')
        ];

        my.prototype.availableDebuffs = [
            new my.prototype.BuffOption('abaddon', 'abaddon_frostmourne'),
            new my.prototype.BuffOption('alchemist', 'alchemist_acid_spray'),
            new my.prototype.BuffOption('ancient_apparition', 'ancient_apparition_ice_vortex'),
            new my.prototype.BuffOption('axe', 'axe_battle_hunger'),
            new my.prototype.BuffOption('bane', 'bane_enfeeble'),
            new my.prototype.BuffOption('batrider', 'batrider_sticky_napalm'),
            new my.prototype.BuffOption('beastmaster', 'beastmaster_primal_roar'),
            new my.prototype.BuffOption('bounty_hunter', 'bounty_hunter_jinada'),
            new my.prototype.BuffOption('brewmaster', 'brewmaster_thunder_clap'),
            new my.prototype.BuffOption('brewmaster', 'brewmaster_drunken_haze'),
            new my.prototype.BuffOption('bristleback', 'bristleback_viscous_nasal_goo'),
            new my.prototype.BuffOption('broodmother', 'broodmother_incapacitating_bite'),
            new my.prototype.BuffOption('centaur', 'centaur_stampede'),
            new my.prototype.BuffOption('chen', 'chen_penitence'),
            new my.prototype.BuffOption('crystal_maiden', 'crystal_maiden_crystal_nova'),
            new my.prototype.BuffOption('crystal_maiden', 'crystal_maiden_freezing_field'),
            new my.prototype.BuffOption('dazzle', 'dazzle_weave'),
            new my.prototype.BuffOption('drow_ranger', 'drow_ranger_frost_arrows'),
            new my.prototype.BuffOption('earth_spirit', 'earth_spirit_rolling_boulder'),
            new my.prototype.BuffOption('elder_titan', 'elder_titan_natural_order'),
            new my.prototype.BuffOption('elder_titan', 'elder_titan_earth_splitter'),
            new my.prototype.BuffOption('enchantress', 'enchantress_untouchable'),
            new my.prototype.BuffOption('enchantress', 'enchantress_enchant'),
            new my.prototype.BuffOption('faceless_void', 'faceless_void_time_walk'),
            new my.prototype.BuffOption('huskar', 'huskar_life_break'),
            new my.prototype.BuffOption('invoker', 'invoker_ghost_walk'),
            new my.prototype.BuffOption('invoker', 'invoker_ice_wall'),
            new my.prototype.BuffOption('wisp', 'wisp_tether'),
            new my.prototype.BuffOption('jakiro', 'jakiro_dual_breath'),
            new my.prototype.BuffOption('jakiro', 'jakiro_liquid_fire'),
            new my.prototype.BuffOption('keeper_of_the_light', 'keeper_of_the_light_blinding_light'),
            new my.prototype.BuffOption('kunkka', 'kunkka_torrent'),
            new my.prototype.BuffOption('lich', 'lich_frost_nova'),
            new my.prototype.BuffOption('lich', 'lich_frost_armor'),
            new my.prototype.BuffOption('lich', 'lich_chain_frost'),
            new my.prototype.BuffOption('life_stealer', 'life_stealer_open_wounds'),
            new my.prototype.BuffOption('lion', 'lion_voodoo'),
            new my.prototype.BuffOption('magnataur', 'magnataur_skewer'),
            new my.prototype.BuffOption('medusa', 'medusa_stone_gaze'),
            new my.prototype.BuffOption('meepo', 'meepo_geostrike'),
            new my.prototype.BuffOption('naga_siren', 'naga_siren_rip_tide'),
            new my.prototype.BuffOption('night_stalker', 'night_stalker_void'),
            new my.prototype.BuffOption('night_stalker', 'night_stalker_crippling_fear'),
            new my.prototype.BuffOption('night_stalker', 'night_stalker_darkness'),
            new my.prototype.BuffOption('ogre_magi', 'ogre_magi_ignite'),
            new my.prototype.BuffOption('omniknight', 'omniknight_degen_aura'),
            new my.prototype.BuffOption('phantom_assassin', 'phantom_assassin_stifling_dagger'),
            new my.prototype.BuffOption('phantom_lancer', 'phantom_lancer_spirit_lance'),
            new my.prototype.BuffOption('pudge', 'pudge_rot'),
            new my.prototype.BuffOption('pugna', 'pugna_decrepify'),
            new my.prototype.BuffOption('queenofpain', 'queenofpain_shadow_strike'),
            new my.prototype.BuffOption('riki', 'riki_smoke_screen'),
            new my.prototype.BuffOption('rubick', 'rubick_fade_bolt'),
            new my.prototype.BuffOption('sand_king', 'sandking_epicenter'),
            new my.prototype.BuffOption('nevermore', 'nevermore_dark_lord'),
            new my.prototype.BuffOption('shadow_shaman', 'shadow_shaman_voodoo'),
            new my.prototype.BuffOption('skeleton_king', 'skeleton_king_hellfire_blast'),
            new my.prototype.BuffOption('skeleton_king', 'skeleton_king_reincarnation'),
            new my.prototype.BuffOption('skywrath_mage', 'skywrath_mage_concussive_shot'),
            new my.prototype.BuffOption('skywrath_mage', 'skywrath_mage_ancient_seal'),
            new my.prototype.BuffOption('slardar', 'slardar_slithereen_crush'),
            new my.prototype.BuffOption('slardar', 'slardar_amplify_damage'),
            new my.prototype.BuffOption('slark', 'slark_essence_shift'),
            new my.prototype.BuffOption('sniper', 'sniper_shrapnel'),
            new my.prototype.BuffOption('spectre', 'spectre_spectral_dagger'),
            new my.prototype.BuffOption('storm_spirit', 'storm_spirit_overload'),
            new my.prototype.BuffOption('templar_assassin', 'templar_assassin_meld'),
            new my.prototype.BuffOption('tidehunter', 'tidehunter_gush'),
            new my.prototype.BuffOption('tinker', 'tinker_laser'),
            new my.prototype.BuffOption('treant', 'treant_leech_seed'),
            new my.prototype.BuffOption('tusk', 'tusk_frozen_sigil'),
            new my.prototype.BuffOption('undying', 'undying_flesh_golem'),
            new my.prototype.BuffOption('ursa', 'ursa_earthshock'),
            new my.prototype.BuffOption('vengefulspirit', 'vengefulspirit_wave_of_terror'),
            new my.prototype.BuffOption('vengefulspirit', 'vengefulspirit_command_aura'),
            new my.prototype.BuffOption('venomancer', 'venomancer_venomous_gale'),
            new my.prototype.BuffOption('venomancer', 'venomancer_poison_sting'),
            new my.prototype.BuffOption('viper', 'viper_poison_attack'),
            new my.prototype.BuffOption('viper', 'viper_corrosive_skin'),
            new my.prototype.BuffOption('viper', 'viper_viper_strike'),
            new my.prototype.BuffOption('visage', 'visage_grave_chill'),
            new my.prototype.BuffOption('warlock', 'warlock_upheaval'),
            new my.prototype.BuffOption('weaver', 'weaver_the_swarm'),
            new my.prototype.BuffOption('windrunner', 'windrunner_windrun'),
            new my.prototype.BuffOption('winter_wyvern', 'winter_wyvern_arctic_burn'),
            new my.prototype.BuffOption('winter_wyvern', 'winter_wyvern_splinter_blast'),
            new my.prototype.BuffOption('npc_dota_neutral_ghost', 'ghost_frost_attack'),
            new my.prototype.BuffOption('npc_dota_neutral_polar_furbolg_ursa_warrior', 'polar_furbolg_ursa_warrior_thunder_clap'),
            new my.prototype.BuffOption('npc_dota_neutral_ogre_magi', 'ogre_magi_frost_armor'),
            new my.prototype.BuffOption('npc_dota_neutral_satyr_trickster', 'satyr_trickster_purge'),
            new my.prototype.BuffOption('npc_dota_neutral_enraged_wildkin', 'enraged_wildkin_tornado')
        ];
        
        my.prototype.itemOptionsArr = [];
        for (var i = 0; i < my.prototype.validItems.length; i++) {
            my.prototype.itemOptionsArr.push(new my.prototype.ItemInput(my.prototype.validItems[i], my.prototype.itemData['item_' + my.prototype.validItems[i]].displayname));
        }
        
        var itemBuffs = ['assault', 'ancient_janggo', 'headdress', 'mekansm', 'pipe', 'ring_of_aquila', 'vladmir', 'ring_of_basilius', 'buckler', 'solar_crest'];
        my.prototype.itemBuffOptions = itemBuffs.map(function(item) {
            return new my.prototype.ItemInput(item, my.prototype.itemData['item_' + item].displayname);
        });
        
        var itemDebuffs = [
            {item: 'assault', debuff: null},
            {item: 'shivas_guard', debuff: null},
            {item: 'desolator', debuff: null},
            {item: 'medallion_of_courage', debuff: null},
            {item: 'radiance', debuff: null},
            {item: 'sheepstick', debuff: null},
            {item: 'veil_of_discord', debuff: null},
            {item: 'solar_crest', debuff: null},
            {item: 'silver_edge', debuff: {id: 'shadow_walk', name: 'Shadow Walk'}},
            {item: 'silver_edge', debuff: {id: 'maim', name: 'Lesser Maim'}}
        ]
        my.prototype.itemDebuffOptions = itemDebuffs.map(function(item) {
            return new my.prototype.ItemInput(item.item, my.prototype.itemData['item_' + item.item].displayname, item.debuff);
        });
        if (callback) callback();
    }
}

my.prototype.init = function (HERODATA_PATH,ITEMDATA_PATH,UNITDATA_PATH, callback) {
    my.prototype.numResourcesLoaded = 0;
    my.prototype.getJSON(HERODATA_PATH, function (data) {
        my.prototype.heroData = data;
        my.prototype.heroData['npc_dota_hero_chen'].abilities[2].behavior.push('DOTA_ABILITY_BEHAVIOR_NOT_LEARNABLE');
        my.prototype.heroData['npc_dota_hero_nevermore'].abilities[1].behavior.push('DOTA_ABILITY_BEHAVIOR_NOT_LEARNABLE');
        my.prototype.heroData['npc_dota_hero_nevermore'].abilities[2].behavior.push('DOTA_ABILITY_BEHAVIOR_NOT_LEARNABLE');
        my.prototype.heroData['npc_dota_hero_morphling'].abilities[3].behavior.push('DOTA_ABILITY_BEHAVIOR_NOT_LEARNABLE');
        my.prototype.heroData['npc_dota_hero_ogre_magi'].abilities[3].behavior.push('DOTA_ABILITY_BEHAVIOR_NOT_LEARNABLE');
        my.prototype.heroData['npc_dota_hero_techies'].abilities[4].behavior.push('DOTA_ABILITY_BEHAVIOR_NOT_LEARNABLE');
        my.prototype.heroData['npc_dota_hero_beastmaster'].abilities[2].behavior.push('DOTA_ABILITY_BEHAVIOR_NOT_LEARNABLE');
        var index = my.prototype.heroData['npc_dota_hero_lone_druid'].abilities[3].behavior.indexOf('DOTA_ABILITY_BEHAVIOR_HIDDEN');
        my.prototype.heroData['npc_dota_hero_lone_druid'].abilities[3].behavior.splice(index, 1);
        
        index = my.prototype.heroData['npc_dota_hero_abaddon'].abilities[2].behavior.indexOf('DOTA_ABILITY_BEHAVIOR_PASSIVE');
        my.prototype.heroData['npc_dota_hero_abaddon'].abilities[2].behavior.splice(index, 1);
        
        index = my.prototype.heroData['npc_dota_hero_riki'].abilities[2].behavior.indexOf('DOTA_ABILITY_BEHAVIOR_PASSIVE');
        my.prototype.heroData['npc_dota_hero_riki'].abilities[2].behavior.splice(index, 1);
        
        for (var h in my.prototype.heroData) {
            my.prototype.HeroOptions.push(new my.prototype.HeroOption(h.replace('npc_dota_hero_', ''), my.prototype.heroData[h].displayname));
        }
            
        my.prototype.onResourceLoaded(callback);
    });
    my.prototype.getJSON(ITEMDATA_PATH, function (data) {
        my.prototype.itemData = data;
        my.prototype.onResourceLoaded(callback);
    });
    my.prototype.getJSON(UNITDATA_PATH, function (data) {
        my.prototype.unitData = data;
        my.prototype.onResourceLoaded(callback);
    });
}

my.prototype.extend = function (out) {
    out = out || {};

    for (var i = 1; i < arguments.length; i++) {
        var obj = arguments[i];

        if (!obj)
            continue;

        for (var key in obj) {
            if (obj.hasOwnProperty(key)) {
                if (typeof obj[key] === 'object')
                    out[key] = my.prototype.extend(out[key], obj[key]);
                else
                    out[key] = obj[key];
            }
        }
    }

    return out;
};

my.prototype.getJSON = function (url, successCallback, errorCallback) {
    var request = new XMLHttpRequest();
    request.open('GET', url, true);

    request.onload = function() {
        if (request.status >= 200 && request.status < 400) {
            // Success!
            var data = JSON.parse(request.responseText);
            successCallback(data);
        } else {
            // We reached our target server, but it returned an error
            errorCallback();
        }
    };

    request.onerror = function() {
        // There was a connection error of some sort
        errorCallback();
    };

    request.send();
}
module.exports = HEROCALCULATOR;
},{"./polyfill":58}],48:[function(require,module,exports){
'use strict';
var ko = require('./herocalc_knockout');
    
var my = require("./herocalc_core");

my.prototype.illusionData = {
    chaos_knight_phantasm: {
        hero: 'chaos_knight',
        displayName: 'Chaos Knight Phantasm',
        use_selected_hero: false,
        max_level: 3,
        outgoing_damage: 'outgoing_damage',
        incoming_damage: 'incoming_damage'
    },
    naga_siren_mirror_image: {
        hero: 'naga_siren',
        displayName: 'Naga Siren Mirror Image',
        use_selected_hero: false,
        max_level: 4,
        outgoing_damage: 'outgoing_damage',
        incoming_damage: 'incoming_damage'
    },
    dark_seer_wall_of_replica: {
        hero: 'dark_seer',
        displayName: 'Dark Seer Wall of Replica',
        use_selected_hero: true,
        max_level: 3,
        outgoing_damage: 'replica_damage_outgoing',
        incoming_damage: 'replica_damage_incoming',
        outgoing_damage_scepter: 'replica_damage_outgoing_scepter'
    },
    morphling_replicate: {
        hero: 'morphling',
        displayName: 'Morphling Replicate',
        use_selected_hero: true,
        max_level: 3,
        outgoing_damage: 'illusion_damage_out_pct',
        incoming_damage: 'illusion_damage_in_pct'
    },
    phantom_lancer_doppelwalk: {
        hero: 'phantom_lancer',
        displayName: 'Phantom Lancer Doppelwalk',
        use_selected_hero: false,
        max_level: 4,
        outgoing_damage: 'illusion_damage_out_pct',
        incoming_damage: 'illusion_damage_in_pct'        
    },
    phantom_lancer_juxtapose: {
        hero: 'phantom_lancer',
        displayName: 'Phantom Lancer Juxtapose',
        use_selected_hero: false,
        max_level: 4,
        outgoing_damage: 'illusion_damage_out_pct',
        incoming_damage: 'illusion_damage_in_pct'        
    },
    phantom_lancer_spirit_lance: {
        hero: 'phantom_lancer',
        displayName: 'Phantom Lancer Spirit Lance',
        use_selected_hero: false,
        max_level: 4,
        outgoing_damage: 'illusion_damage_out_pct',
        incoming_damage: 'illusion_damage_in_pct'        
    },
    shadow_demon_disruption: {
        hero: 'shadow_demon',
        displayName: 'Shadow Demon Disruption',
        use_selected_hero: true,
        max_level: 4,
        outgoing_damage: 'illusion_outgoing_damage',
        incoming_damage: 'illusion_incoming_damage'        
    },
    spectre_haunt: {
        hero: 'spectre',
        displayName: 'Spectre Haunt',
        use_selected_hero: false,
        max_level: 3,
        outgoing_damage: 'illusion_damage_outgoing',
        incoming_damage: 'illusion_damage_incoming'        
    },
    terrorblade_conjure_image: {
        hero: 'terrorblade',
        displayName: 'Terrorblade Conjure Image',
        use_selected_hero: false,
        max_level: 4,
        outgoing_damage: 'illusion_outgoing_damage',
        incoming_damage: 'illusion_incoming_damage'        
    },
    terrorblade_reflection: {
        hero: 'terrorblade',
        displayName: 'Terrorblade Reflection',
        use_selected_hero: true,
        max_level: 4,
        outgoing_damage: 'illusion_outgoing_damage'     
    },
    item_manta: {
        hero: '',
        is_item: true,
        displayName: 'Manta Style Illusion',
        use_selected_hero: true,
        max_level: 1,
        outgoing_damage_melee: 'images_do_damage_percent_melee',
        incoming_damage_melee: 'images_take_damage_percent_melee',
        outgoing_damage_ranged: 'images_do_damage_percent_ranged',
        incoming_damage_ranged: 'images_take_damage_percent_ranged'
    }
}

my.prototype.IllusionViewModel = function (h, p, abilityLevel) {
    var self = new my.prototype.HeroCalculatorModel(0);
    self.parent = p;
    self.inventory = self.parent.inventory;
    self.illusionType = ko.observable(self.parent.selectedIllusion().illusionName);
    self.illusionDisplayName = ko.observable(self.parent.selectedIllusion().illusionDisplayName);
    self.illusionAbilityLevel(abilityLevel);
    self.illusionAbilityMaxLevel = ko.observable(my.prototype.illusionData[self.parent.selectedIllusion().illusionName].max_level);
    if (!my.prototype.illusionData[self.illusionType()].use_selected_hero) {
        self.selectedHero(my.prototype.findWhere(self.availableHeroes(), {heroName: self.parent.selectedIllusion().baseHero}));
    }
    else {
        self.selectedHero(self.parent.selectedHero());
    }
    self.selectedHeroLevel(self.parent.selectedHeroLevel());
    self.hero = ko.computed(function() {
        return ko.wrap.fromJS(my.prototype.heroData['npc_dota_hero_' + self.selectedHero().heroName]);
    });
    
    self.ability().getAttributeBonusLevel = self.parent.ability().getAttributeBonusLevel;
    self.totalAgi = ko.computed(function () {
        return (self.heroData().attributebaseagility
                + self.heroData().attributeagilitygain * (self.selectedHeroLevel() - 1) 
                + self.inventory.getAttributes('agi') 
                + self.ability().getAttributeBonusLevel() * 2
                + self.ability().getAgility()
                + self.enemy().ability().getAllStatsReduction()
                + self.debuffs.getAllStatsReduction()
               ).toFixed(2);
    });
    self.intStolen = ko.observable(0).extend({ numeric: 0 });
    self.totalInt = ko.computed(function () {
        return (self.heroData().attributebaseintelligence 
                + self.heroData().attributeintelligencegain * (self.selectedHeroLevel() - 1) 
                + self.inventory.getAttributes('int') 
                + self.ability().getAttributeBonusLevel() * 2
                + self.ability().getIntelligence()
                + self.enemy().ability().getAllStatsReduction()
                + self.debuffs.getAllStatsReduction() + self.intStolen()
               ).toFixed(2);
    });
    self.totalStr = ko.computed(function () {
        return (self.heroData().attributebasestrength 
                + self.heroData().attributestrengthgain * (self.selectedHeroLevel() - 1) 
                + self.inventory.getAttributes('str') 
                + self.ability().getAttributeBonusLevel() * 2
                + self.ability().getStrength()
                + self.enemy().ability().getAllStatsReduction()
                + self.debuffs.getAllStatsReduction()
               ).toFixed(2);
    });
    
    self.getAbilityAttributeValue = function(hero, ability, attributeName, level) {
        if (ability == 'item_manta') {
            var abilityObj = my.prototype.itemData[ability];
        }
        else {
            var abilityObj = my.prototype.findWhere(my.prototype.heroData['npc_dota_hero_' + hero].abilities, {name: ability});
        }
        var attribute = my.prototype.findWhere(abilityObj.attributes, {name: attributeName});
        if (level == 0) {
            return parseFloat(attribute.value[0]);
        }
        else if (level > attribute.length) {
            return parseFloat(attribute.value[0]);
        }
        else {
            return parseFloat(attribute.value[level - 1]);
        }
    }
    
    self.getIncomingDamageMultiplier = function(illusionType, hasScepter, attackType) {
        if (illusionType == 'item_manta') {
            if (attackType == 'DOTA_UNIT_CAP_MELEE_ATTACK') {
                return (1 + self.getAbilityAttributeValue(my.prototype.illusionData[self.illusionType()].hero, self.illusionType(), my.prototype.illusionData[illusionType].incoming_damage_melee, self.illusionAbilityLevel())/100)
            }
            else {
                return (1 + self.getAbilityAttributeValue(my.prototype.illusionData[self.illusionType()].hero, self.illusionType(), my.prototype.illusionData[illusionType].incoming_damage_ranged, self.illusionAbilityLevel())/100)
            }
        }
        else {
            return (1 + self.getAbilityAttributeValue(my.prototype.illusionData[self.illusionType()].hero, self.illusionType(), my.prototype.illusionData[illusionType].incoming_damage, self.illusionAbilityLevel())/100)
        }
    }
    self.getOutgoingDamageMultiplier = function(illusionType, hasScepter, attackType) {
        if (illusionType == 'item_manta') {
            if (attackType == 'DOTA_UNIT_CAP_MELEE_ATTACK') {
                return (1 + self.getAbilityAttributeValue(my.prototype.illusionData[self.illusionType()].hero, self.illusionType(), my.prototype.illusionData[illusionType].outgoing_damage_melee, self.illusionAbilityLevel())/100);
            }
            else {
                return (1 + self.getAbilityAttributeValue(my.prototype.illusionData[self.illusionType()].hero, self.illusionType(), my.prototype.illusionData[illusionType].outgoing_damage_ranged, self.illusionAbilityLevel())/100);
            }
        }
        else {
            return (1 + self.getAbilityAttributeValue(my.prototype.illusionData[self.illusionType()].hero, self.illusionType(), my.prototype.illusionData[illusionType].outgoing_damage, self.illusionAbilityLevel())/100);
        }
    }

    self.baseDamage = ko.computed(function() {
        return [Math.floor(my.prototype.heroData['npc_dota_hero_' + self.selectedHero().heroName].attackdamagemin + self.totalAttribute(self.primaryAttribute()) + self.ability().getBaseDamage().total)
                * self.getOutgoingDamageMultiplier(self.illusionType(), false, self.hero().attacktype()),
                Math.floor(my.prototype.heroData['npc_dota_hero_' + self.selectedHero().heroName].attackdamagemax + self.totalAttribute(self.primaryAttribute()) + self.ability().getBaseDamage().total)
                * self.getOutgoingDamageMultiplier(self.illusionType(), false, self.hero().attacktype())];
    });
    
    self.damage = ko.computed(function() {
        return [self.baseDamage()[0],
                self.baseDamage()[1]];
    });
    
    self.ehpPhysical = ko.computed(function() {
        var ehp = (self.health() * (1 + .06 * self.totalArmorPhysical())) / (1 - (1 - (self.inventory.getEvasion() * self.ability().getEvasion())))
        ehp *= (self.inventory.activeItems().some(function(item) {return item.item == 'mask_of_madness';}) ? (1 / 1.3) : 1);
        ehp *= (1 / self.getIncomingDamageMultiplier(self.illusionType(), false, self.hero().attacktype()));
        return ehp.toFixed(2);
    });
    self.ehpMagical = ko.computed(function() {
        var ehp = self.health() / self.totalMagicResistanceProduct();
        ehp *= (1 / self.getIncomingDamageMultiplier(self.illusionType(), false, self.hero().attacktype()));
        return ehp.toFixed(2);
    });
    
    self.totalArmorPhysical = ko.computed(function() {
        return (self.enemy().ability().getArmorBaseReduction() * self.debuffs.getArmorBaseReduction() * (my.prototype.heroData['npc_dota_hero_' + self.selectedHero().heroName].armorphysical + self.totalAgi() * .14)
                + self.ability().getArmor() + self.enemy().ability().getArmorReduction() + self.buffs.getArmor() + self.debuffs.getArmorReduction()).toFixed(2);
    });
    
    self.ias = ko.computed(function() {
        var val = parseFloat(self.totalAgi()) 
                + self.ability().getAttackSpeed() 
                + self.enemy().ability().getAttackSpeedReduction() 
                + self.buffs.getAttackSpeed() 
                + self.debuffs.getAttackSpeedReduction()
                + self.unit().ability().getAttackSpeed(); 
        if (val < -80) {
            return -80;
        }
        else if (val > 400) {
            return 400;
        }
        return val.toFixed(2);
    });
    
    return self;
}
},{"./herocalc_core":47,"./herocalc_knockout":53}],49:[function(require,module,exports){
'use strict';
var ko = require('./herocalc_knockout');

var my = require("./herocalc_core");
require("./herocalc_hero_damage");

my.prototype.totalExp = [0, 200, 500, 900, 1400, 2000, 2600, 3400, 4400, 5400, 6000, 8200, 9000, 10400, 11900, 13500, 15200, 17000, 18900, 20900, 23000, 25200, 27500, 29900, 32400];
my.prototype.nextLevelExp = [200, 300, 400, 500, 600, 600, 800, 1000, 1000, 600, 2200, 800, 1400, 1500, 1600, 1700, 1800, 1900, 2000, 2100, 2200, 2300, 2400, 2500, '&mdash;'];
my.prototype.diffProperties = [
    'totalAgi',
    'totalInt',
    'totalStr',
    'health',
    'healthregen',
    'mana',
    'manaregen',
    'totalArmorPhysical',
    'totalArmorPhysicalReduction',
    'totalMovementSpeed',
    'totalTurnRate',
    'baseDamage',
    'bonusDamage',
    'bonusDamageReduction',
    'damage',
    'totalMagicResistanceProduct',
    'totalMagicResistance',
    'bat',
    'ias',
    'attackTime',
    'attacksPerSecond',
    'evasion',
    'ehpPhysical',
    'ehpMagical',
    'bash',
    'critChance',
    //'critDamage',
    'missChance',
    'totalattackrange',
    'visionrangeday',
    'visionrangenight',
    'lifesteal'
];

my.prototype.IllusionOption = function (name, displayname, baseHero) {
    this.illusionName = name;
    this.illusionDisplayName = displayname;
    this.baseHero = baseHero;
};

my.prototype.createIllusionOptions = function () {
    var options = [];
    for (var h in my.prototype.illusionData) {
        options.push(new my.prototype.IllusionOption(h, my.prototype.illusionData[h].displayName, my.prototype.illusionData[h].hero));
    }
    return options;
}

my.prototype.HeroModel = function (h) {
    var self = this;
    self.heroId = ko.observable(h);
    self.selectedHeroLevel = ko.observable(1);
    self.inventory = new my.prototype.InventoryViewModel(self);
    self.selectedInventory = ko.observable(-1);
    self.buffs = new my.prototype.BuffViewModel();
    self.buffs.hasScepter = self.inventory.hasScepter;
    self.debuffs = new my.prototype.BuffViewModel();
    /*self.hero = ko.computed(function () {
        return ko.mapping.fromJS(my.prototype.heroData['npc_dota_hero_' + self.heroId()]);
    });*/
    self.heroData = ko.computed(function () {
      return my.prototype.heroData['npc_dota_hero_' + self.heroId()];
    });
    self.heroCompare = ko.observable(self);
    self.enemy = ko.observable(self);
    self.unit = ko.observable(self);
    self.clone = ko.observable(self);
    self.illusions = ko.observableArray([]);
    self.availableIllusions = ko.observableArray(my.prototype.createIllusionOptions());
    self.selectedIllusion = ko.observable(self.availableIllusions()[0]);
    self.illusionAbilityLevel = ko.observable(1);
    self.illusionAbilityMaxLevel = ko.computed(function () {
        return my.prototype.illusionData[self.selectedIllusion().illusionName].max_level;
    });
    
    self.skillPointHistory = ko.observableArray();
    
    self.ability = ko.computed(function () {
        var a = new my.prototype.AbilityModel(ko.observableArray(JSON.parse(JSON.stringify(self.heroData().abilities))), self);
        if (self.heroId() === 'earth_spirit' || self.heroId() === 'ogre_magi') {
            a.abilities()[3].level(1);
        }
        else if (self.heroId() === 'invoker') {
            for (var i = 6; i < 16; i++) {
                a.abilities()[i].level(1);
            }
        }
        self.skillPointHistory.removeAll();
        a.hasScepter = self.inventory.hasScepter
        return a;
    });

    self.availableSkillPoints = ko.computed(function () {
        var c = self.selectedHeroLevel();
        for (var i = 0; i < self.ability().abilities().length; i++) {
            var getIndex = function () {
                return i;
            };
            switch(self.ability().abilities()[i].abilitytype) {
                case 'DOTA_ABILITY_TYPE_ULTIMATE':
                    if (self.heroId() === 'invoker') {
                        while (
                            ((self.ability().abilities()[i].level() == 1) && (parseInt(self.selectedHeroLevel()) < 2)) ||
                            ((self.ability().abilities()[i].level() == 2) && (parseInt(self.selectedHeroLevel()) < 7)) ||
                            ((self.ability().abilities()[i].level() == 3) && (parseInt(self.selectedHeroLevel()) < 11)) ||
                            ((self.ability().abilities()[i].level() == 4) && (parseInt(self.selectedHeroLevel()) < 17))
                        ) {
                            self.ability().levelDownAbility(getIndex, null, null, self);
                        }
                    }
                    else if (self.heroId() === 'meepo') {
                        while ((self.ability().abilities()[i].level()-1) * 7 + 3 > parseInt(self.selectedHeroLevel())) {
                            self.ability().levelDownAbility(getIndex, null, null, self);
                        }
                    }
                    else {
                        while (self.ability().abilities()[i].level() * 5 + 1 > parseInt(self.selectedHeroLevel())) {
                            self.ability().levelDownAbility(getIndex, null, null, self);
                        }
                    }
                break;
                default:
                    while (self.ability().abilities()[i].level() * 2 - 1 > parseInt(self.selectedHeroLevel())) {
                        self.ability().levelDownAbility(getIndex, null, null, self);
                    }
                break;
            }
        }
        var getIndex = function () {
            return self.skillPointHistory()[self.skillPointHistory().length-1];
        };
        while (self.skillPointHistory().length > c) {
            self.ability().levelDownAbility(getIndex, null, null, self);
        }
        return c-self.skillPointHistory().length;
    }, this);
    self.primaryAttribute = ko.pureComputed(function () {
        var v = self.heroData().attributeprimary;
        if (v === 'DOTA_ATTRIBUTE_AGILITY') return 'agi';
        if (v === 'DOTA_ATTRIBUTE_INTELLECT') return 'int';
        if (v === 'DOTA_ATTRIBUTE_STRENGTH') return 'str';
        return '';
    });
    self.totalExp = ko.pureComputed(function () {
        return my.prototype.totalExp[self.selectedHeroLevel() - 1];
    });
    self.nextLevelExp = ko.pureComputed(function () {
        return my.prototype.nextLevelExp[self.selectedHeroLevel() - 1];
    });
    self.startingArmor = ko.pureComputed(function () {
        return (self.heroData().attributebaseagility * .14 + self.heroData().armorphysical).toFixed(2);
    });
    self.respawnTime = ko.pureComputed(function () {
        return 5 + 3.8 * self.selectedHeroLevel();
    });
    self.totalAttribute = function (a) {
        if (a === 'agi') return parseFloat(self.totalAgi());
        if (a === 'int') return parseFloat(self.totalInt());
        if (a === 'str') return parseFloat(self.totalStr());
        return 0;
    };
    self.totalAgi = ko.pureComputed(function () {
        return (self.heroData().attributebaseagility
                + self.heroData().attributeagilitygain * (self.selectedHeroLevel() - 1) 
                + self.inventory.getAttributes('agi') 
                + self.ability().getAttributeBonusLevel() * 2
                + self.ability().getAgility()
                + self.enemy().ability().getAllStatsReduction()
                + self.debuffs.getAllStatsReduction()
               ).toFixed(2);
    });
    self.intStolen = ko.observable(0).extend({ numeric: 0 });
    self.totalInt = ko.pureComputed(function () {
        return (self.heroData().attributebaseintelligence 
                + self.heroData().attributeintelligencegain * (self.selectedHeroLevel() - 1) 
                + self.inventory.getAttributes('int') 
                + self.ability().getAttributeBonusLevel() * 2
                + self.ability().getIntelligence()
                + self.enemy().ability().getAllStatsReduction()
                + self.debuffs.getAllStatsReduction() + self.intStolen()
               ).toFixed(2);
    });
    self.totalStr = ko.pureComputed(function () {
        return (self.heroData().attributebasestrength 
                + self.heroData().attributestrengthgain * (self.selectedHeroLevel() - 1) 
                + self.inventory.getAttributes('str') 
                + self.ability().getAttributeBonusLevel() * 2
                + self.ability().getStrength()
                + self.enemy().ability().getStrengthReduction()
                + self.enemy().ability().getAllStatsReduction()
                + self.debuffs.getAllStatsReduction()
               ).toFixed(2);
    });
    self.health = ko.pureComputed(function () {
        return (self.heroData().statushealth + Math.floor(self.totalStr()) * 20 
                + self.inventory.getHealth()
                + self.ability().getHealth()).toFixed(2);
    });
    self.healthregen = ko.pureComputed(function () {
        var healthRegenAura = [self.inventory.getHealthRegenAura, self.buffs.itemBuffs.getHealthRegenAura].reduce(function (memo, fn) {
            var obj = fn(memo.excludeList);
            obj.value += memo.value;
            return obj;
        }, {value: 0, excludeList: []});
        return (self.heroData().statushealthregen + self.totalStr() * .03 
                + self.inventory.getHealthRegen() 
                + self.ability().getHealthRegen()
                + self.buffs.getHealthRegen()
                + healthRegenAura.value
                ).toFixed(2);
    });
    self.mana = ko.pureComputed(function () {
        return (self.heroData().statusmana
                + self.totalInt() * 12
                + self.inventory.getMana()
                + self.ability().getMana()).toFixed(2);
    });
    self.manaregen = ko.pureComputed(function () {
        return ((self.heroData().statusmanaregen 
                + self.totalInt() * .04 
                + self.ability().getManaRegen()) 
                * (1 + self.inventory.getManaRegenPercent()) 
                + (self.heroId() === 'crystal_maiden' ? self.ability().getManaRegenArcaneAura() * 2 : self.buffs.getManaRegenArcaneAura())
                + self.inventory.getManaRegenBloodstone()
                + self.inventory.getManaRegen()
                - self.enemy().ability().getManaRegenReduction()).toFixed(2);
    });
    self.totalArmorPhysical = ko.pureComputed(function () {
        var armorAura = [self.inventory.getArmorAura, self.buffs.itemBuffs.getArmorAura].reduce(function (memo, fn) {
            var obj = fn(memo.attributes);
            return obj;
        }, {value:0, attributes:[]});
        var armorReduction = [self.enemy().inventory.getArmorReduction, self.debuffs.itemBuffs.getArmorReduction].reduce(function (memo, fn) {
            var obj = fn(memo.excludeList);
            obj.value += memo.value;
            return obj;
        }, {value: 0, excludeList: []});
        return (self.enemy().ability().getArmorBaseReduction() * self.debuffs.getArmorBaseReduction() * (self.heroData().armorphysical + self.totalAgi() * .14)
                + self.inventory.getArmor()
                //+ self.inventory.getArmorAura().value
                //+ self.enemy().inventory.getArmorReduction()
                + self.ability().getArmor()
                + self.enemy().ability().getArmorReduction()
                + self.buffs.getArmor()
                + self.buffs.itemBuffs.getArmor()
                + self.debuffs.getArmorReduction()
                //+ self.buffs.itemBuffs.getArmorAura().value
                + armorAura.value
                + armorReduction.value
                //+ self.debuffs.getArmorReduction()
                ).toFixed(2);
    });
    self.totalArmorPhysicalReduction = ko.pureComputed(function () {
        var totalArmor = self.totalArmorPhysical();
        if (totalArmor >= 0) {
            return ((0.06 * self.totalArmorPhysical()) / (1 + 0.06 * self.totalArmorPhysical()) * 100).toFixed(2);
        }
        else {
            return -((0.06 * -self.totalArmorPhysical()) / (1 + 0.06 * -self.totalArmorPhysical()) * 100).toFixed(2);
        }
    });
    self.totalMovementSpeed = ko.pureComputed(function () {
        var MIN_MOVESPEED = 100;
        var ms = (self.ability().setMovementSpeed() > 0 ? self.ability().setMovementSpeed() : self.buffs.setMovementSpeed());
        if (ms > 0) {
            return ms;
        }
        else {
            var movementSpeedPercent = [self.inventory.getMovementSpeedPercent, self.buffs.itemBuffs.getMovementSpeedPercent].reduce(function (memo, fn) {
                var obj = fn(memo.excludeList);
                obj.value += memo.value;
                return obj;
            }, {value:0, excludeList:[]});
            var movementSpeedPercentReduction = [self.enemy().inventory.getMovementSpeedPercentReduction, self.debuffs.itemBuffs.getMovementSpeedPercentReduction].reduce(function (memo, fn) {
                var obj = fn(memo.excludeList);
                obj.value += memo.value;
                return obj;
            }, {value:0, excludeList:[]});
            return Math.max(
                self.enemy().inventory.isSheeped() || self.debuffs.itemBuffs.isSheeped() ? 140 :
                (self.heroData().movementspeed + self.inventory.getMovementSpeedFlat()+ self.ability().getMovementSpeedFlat()) * 
                (1 //+ self.inventory.getMovementSpeedPercent() 
                   + movementSpeedPercent.value
                   + movementSpeedPercentReduction.value
                   + self.ability().getMovementSpeedPercent() 
                   //+ self.enemy().inventory.getMovementSpeedPercentReduction() 
                   + self.enemy().ability().getMovementSpeedPercentReduction() 
                   + self.buffs.getMovementSpeedPercent() 
                   + self.debuffs.getMovementSpeedPercentReduction()
                   + self.unit().ability().getMovementSpeedPercent() 
                )
            , MIN_MOVESPEED).toFixed(2);
        }
    });
    self.totalTurnRate = ko.pureComputed(function () {
        return (self.heroData().movementturnrate 
                * (1 + self.enemy().ability().getTurnRateReduction()
                     + self.debuffs.getTurnRateReduction())).toFixed(2);
    });
    self.baseDamage = ko.pureComputed(function () {
        var totalAttribute = self.totalAttribute(self.primaryAttribute()),
            abilityBaseDamage = self.ability().getBaseDamage(),
            minDamage = self.heroData().attackdamagemin,
            maxDamage = self.heroData().attackdamagemax;
        return [Math.floor((minDamage + totalAttribute + abilityBaseDamage.total) * self.ability().getSelfBaseDamageReductionPct() * self.enemy().ability().getBaseDamageReductionPct() * self.debuffs.getBaseDamageReductionPct() * self.debuffs.itemBuffs.getBaseDamageReductionPct() * abilityBaseDamage.multiplier),
                Math.floor((maxDamage + totalAttribute + abilityBaseDamage.total) * self.ability().getSelfBaseDamageReductionPct() * self.enemy().ability().getBaseDamageReductionPct() * self.debuffs.getBaseDamageReductionPct() * self.debuffs.itemBuffs.getBaseDamageReductionPct() * abilityBaseDamage.multiplier)];
    });
    self.baseDamageAvg = ko.pureComputed(function () {
        return (self.baseDamage()[0] + self.baseDamage()[1]) / 2;
    });
    self.baseDamageMin = ko.pureComputed(function () {
        return self.baseDamage()[0];
    });
    self.baseDamageMax = ko.pureComputed(function () {
        return self.baseDamage()[1];
    });
    self.bonusDamage = ko.pureComputed(function () {
        return ((self.inventory.getBonusDamage().total
                + self.ability().getBonusDamage().total
                + self.buffs.getBonusDamage().total
                + Math.floor((self.baseDamage()[0] + self.baseDamage()[1]) / 2 
                              * (self.buffs.itemBuffs.getBonusDamagePercent(self.inventory.getBonusDamagePercent()).total
                                 + self.ability().getBonusDamagePercent().total
                                 + self.buffs.getBonusDamagePercent().total
                                )
                            )
                + Math.floor(
                    (self.heroData().attacktype == 'DOTA_UNIT_CAP_RANGED_ATTACK' 
                        ? ((self.heroId() == 'drow_ranger') ? self.ability().getBonusDamagePrecisionAura().total[0] * self.totalAgi() : self.buffs.getBonusDamagePrecisionAura().total[1])
                        : 0)
                  )
                + Math.floor(
                    ((self.heroId() == 'riki') ? self.ability().getBonusDamageBackstab().total[0] * self.totalAgi() : 0)
                  )
                ) * self.ability().getSelfBaseDamageReductionPct()
                  * self.enemy().ability().getBaseDamageReductionPct()
                  * self.debuffs.itemBuffs.getBaseDamageReductionPct());
    });
    self.bonusDamageReduction = ko.pureComputed(function () {
        return Math.abs(self.enemy().ability().getBonusDamageReduction() + self.debuffs.getBonusDamageReduction());
    });
    self.damageAvg = ko.pureComputed(function () {
        return (self.baseDamage()[0] + self.baseDamage()[1]) / 2 + self.bonusDamage();
    });
    self.damageMin = ko.pureComputed(function () {
        return self.baseDamage()[0] + self.bonusDamage();
    });
    self.damageMax = ko.pureComputed(function () {
        return self.baseDamage()[1] + self.bonusDamage();
    });
    self.damage = ko.pureComputed(function () {
        return [self.baseDamage()[0] + self.bonusDamage(),
                self.baseDamage()[1] + self.bonusDamage()];
    });
    self.totalMagicResistanceProduct = ko.pureComputed(function () {
        return (1 - self.heroData().magicalresistance / 100) 
                * self.inventory.getMagicResist()
                * self.ability().getMagicResist()
                * self.buffs.getMagicResist()
                * self.inventory.getMagicResistReductionSelf()
                * self.enemy().inventory.getMagicResistReduction()
                * self.enemy().ability().getMagicResistReduction()
                * self.debuffs.getMagicResistReduction()
                * self.debuffs.itemBuffs.getMagicResistReduction();
    });
    self.totalMagicResistance = ko.pureComputed(function () {
        return ((1 - self.totalMagicResistanceProduct()) * 100).toFixed(2);
    });
    self.bat = ko.pureComputed(function () {
        var abilityBAT = self.ability().getBAT();
        if (abilityBAT > 0) {
            return abilityBAT;
        }
        return self.heroData().attackrate;
    });
    self.ias = ko.pureComputed(function () {
        var attackSpeed = [self.inventory.getAttackSpeed, self.buffs.itemBuffs.getAttackSpeed].reduce(function (memo, fn) {
            var obj = fn(memo.excludeList);
            obj.value += memo.value;
            return obj;
        }, {value:0, excludeList:[]});
        var attackSpeedReduction = [self.enemy().inventory.getAttackSpeedReduction, self.debuffs.itemBuffs.getAttackSpeedReduction].reduce(function (memo, fn) {
            var obj = fn(memo.excludeList);
            obj.value += memo.value;
            return obj;
        }, {value:0, excludeList: []});
        var val = parseFloat(self.totalAgi()) 
                //+ self.inventory.getAttackSpeed() 
                + attackSpeed.value
                + attackSpeedReduction.value
                //+ self.enemy().inventory.getAttackSpeedReduction() 
                + self.ability().getAttackSpeed() 
                + self.enemy().ability().getAttackSpeedReduction() 
                + self.buffs.getAttackSpeed() 
                + self.debuffs.getAttackSpeedReduction()
                + self.unit().ability().getAttackSpeed(); 
        if (val < -80) {
            return -80;
        }
        else if (val > 500) {
            return 500;
        }
        return val.toFixed(2);
    });
    self.attackTime = ko.pureComputed(function () {
        return (self.bat() / (1 + self.ias() / 100)).toFixed(2);
    });
    self.attacksPerSecond = ko.pureComputed(function () {
        return ((1 + self.ias() / 100) / self.bat()).toFixed(2);
    });
    self.evasion = ko.pureComputed(function () {
        if (self.enemy().inventory.isSheeped() || self.debuffs.itemBuffs.isSheeped()) return 0;
        var e = self.ability().setEvasion();
        if (e) {
            return (e * 100).toFixed(2);
        }
        else {
            return ((1-(self.inventory.getEvasion() * self.ability().getEvasion() * self.ability().getEvasionBacktrack() * self.buffs.itemBuffs.getEvasion())) * 100).toFixed(2);
        }
    });
    self.ehpPhysical = ko.pureComputed(function () {
        var evasion = self.enemy().inventory.isSheeped() || self.debuffs.itemBuffs.isSheeped() ? 1 : self.inventory.getEvasion() * self.ability().getEvasion() * self.buffs.itemBuffs.getEvasion();
        if (self.totalArmorPhysical() >= 0) {
            var ehp = self.health() * (1 + .06 * self.totalArmorPhysical());
        }
        else {
            var ehp = self.health() * (1 - .06 * self.totalArmorPhysical()) / (1 - .12 * self.totalArmorPhysical());
        }
        ehp /= (1 - (1 - (evasion * self.ability().getEvasionBacktrack())));
        ehp /= (1 - parseFloat(self.enemy().missChance()) / 100);
        ehp *= (self.inventory.activeItems().some(function (item) {return item.item == 'mask_of_madness';}) ? (1 / 1.3) : 1);
        ehp *= (1 / self.ability().getDamageReduction());
        ehp *= (1 / self.buffs.getDamageReduction());
        ehp *= (1 / self.enemy().ability().getDamageAmplification());
        ehp *= (1 / self.debuffs.getDamageAmplification());
        return ehp.toFixed(2);
    });
    self.ehpMagical = ko.pureComputed(function () {
        var ehp = self.health() / self.totalMagicResistanceProduct();
        ehp *= (self.inventory.activeItems().some(function (item) {return item.item == 'mask_of_madness';}) ? (1 / 1.3) : 1);
        ehp *= (1 / self.ability().getDamageReduction());
        ehp *= (1 / self.buffs.getDamageReduction());
        ehp *= (1 / self.ability().getEvasionBacktrack());
        ehp *= (1 / self.enemy().ability().getDamageAmplification());
        ehp *= (1 / self.debuffs.getDamageAmplification());
        return ehp.toFixed(2);
    });
    self.bash = ko.pureComputed(function () {
        var attacktype = self.heroData().attacktype;
        return ((1 - (self.inventory.getBash(attacktype) * self.ability().getBash())) * 100).toFixed(2);
    });
    
    self.critChance = ko.pureComputed(function () {
        return ((1 - (self.inventory.getCritChance() * self.ability().getCritChance())) * 100).toFixed(2);
    });

    my.prototype.HeroDamageMixin(self);
    
    /*self.critDamage = ko.computed(function () {
        self.critInfo();
        return 0;
    });*/
    self.missChance = ko.pureComputed(function () {
        var missDebuff = [self.enemy().inventory.getMissChance, self.debuffs.itemBuffs.getMissChance].reduce(function (memo, fn) {
            var obj = fn(memo.excludeList);
            obj.value *= memo.value;
            return obj;
        }, {value:1, excludeList:[]});
        return ((1 - (self.enemy().ability().getMissChance() * self.debuffs.getMissChance() * missDebuff.value)) * 100).toFixed(2);
    });
    self.totalattackrange = ko.pureComputed(function () {
        var attacktype = self.heroData().attacktype;
        return self.heroData().attackrange + self.ability().getAttackRange() + self.inventory.getAttackRange(attacktype).value;
    });
    self.visionrangeday = ko.pureComputed(function () {
        return (self.heroData().visiondaytimerange) * (1 + self.enemy().ability().getVisionRangePctReduction() + self.debuffs.getVisionRangePctReduction());
    });
    self.visionrangenight = ko.pureComputed(function () {
        return (self.heroData().visionnighttimerange + self.inventory.getVisionRangeNight() + self.ability().getVisionRangeNight()) * (1 + self.enemy().ability().getVisionRangePctReduction() + self.debuffs.getVisionRangePctReduction());
    });
    self.lifesteal = ko.pureComputed(function () {
        var total = self.inventory.getLifesteal() + self.ability().getLifesteal() + self.buffs.getLifesteal();
        if (self.heroData().attacktype == 'DOTA_UNIT_CAP_MELEE_ATTACK') {
            var lifestealAura = [self.inventory.getLifestealAura, self.buffs.itemBuffs.getLifestealAura].reduce(function (memo, fn) {
                var obj = fn(memo.excludeList);
                obj.value += memo.value;
                return obj;
            }, {value: 0, excludeList: []});
            total += lifestealAura.value;
        }
        return (total).toFixed(2);
    });
    
    self.addIllusion = function (data, event) {
        self.illusions.push(ko.observable(new my.prototype.IllusionViewModel(0, self, self.illusionAbilityLevel())));
    };
    
    self.diffProperties = my.prototype.diffProperties;
    self.diff = {};

    for (var i = 0; i < self.diffProperties.length; i++) {
        var index = i;
        self.diff[self.diffProperties[index]] = self.getDiffFunction(self.diffProperties[index]);
    }
};

my.prototype.HeroModel.prototype.getDiffFunction = function (prop) {
    var self = this;
    return ko.computed(function () {
        if (prop == 'baseDamage') {
            return [self[prop]()[0] - self.heroCompare()[prop]()[0], self[prop]()[1] - self.heroCompare()[prop]()[1]];
        }
        else {
            return self[prop]() - self.heroCompare()[prop]();
        }
    }, this, { deferEvaluation: true });
}

my.prototype.HeroModel.prototype.getAbilityLevelMax = function (data) {
    if (data.abilitytype === 'DOTA_ABILITY_TYPE_ATTRIBUTES') {
        return 10;
    }
    else if (data.name === 'invoker_quas' || data.name === 'invoker_wex' || data.name === 'invoker_exort') {
        return 7;
    }
    else if (data.name === 'invoker_invoke') {
        return 4;
    }
    else if (data.name === 'earth_spirit_stone_caller' || data.name === 'ogre_magi_unrefined_fireblast') {
        return 1;
    }
    else if (data.abilitytype === 'DOTA_ABILITY_TYPE_ULTIMATE' || data.name === 'keeper_of_the_light_recall' ||
             data.name === 'keeper_of_the_light_blinding_light' || data.name === 'ember_spirit_activate_fire_remnant' ||
             data.name === 'lone_druid_true_form_battle_cry') {
        return 3;
    }
    else if (data.name === 'puck_ethereal_jaunt'  || data.name === 'shadow_demon_shadow_poison_release' ||
             data.name === 'templar_assassin_trap' || data.name === 'spectre_reality') {
        return 0;
    }
    else if (data.name === 'invoker_cold_snap'  || data.name === 'invoker_ghost_walk' || data.name === 'invoker_tornado' || 
             data.name === 'invoker_emp' || data.name === 'invoker_alacrity' || data.name === 'invoker_chaos_meteor' || 
             data.name === 'invoker_sun_strike' || data.name === 'invoker_forge_spirit' || data.name === 'invoker_ice_wall' || 
             data.name === 'invoker_deafening_blast') {
        return 0;
    }
    else if (data.name === 'techies_minefield_sign' || data.name === 'techies_focused_detonate') {
        return 0;
    }
    else {
        return 4;
    }
};
},{"./herocalc_core":47,"./herocalc_hero_damage":51,"./herocalc_knockout":53}],50:[function(require,module,exports){
'use strict';
var ko = require('./herocalc_knockout');

var my = require("./herocalc_core");

my.prototype.CloneOption = function (name, displayname, levels, image, level) {
    this.heroName = ko.computed(function() {
        return (levels > 0) ? name + (level() <= levels ? level() : 1) : name;
    });
    this.heroDisplayName = displayname;
    this.image = image;
    this.levels = levels;
};

my.prototype.CloneViewModel = function (h,p) {
    var self = new my.prototype.HeroModel(h);
    self.parent = p;
    /*self.selectedHero(my.prototype.findWhere(self.availableHeroes(), {heroName: 'meepo'}));
    self.hero = ko.computed(function() {
        return ko.wrap.fromJS(my.prototype.heroData['npc_dota_hero_meepo']);
    });*/
    return self;
}
},{"./herocalc_core":47,"./herocalc_knockout":53}],51:[function(require,module,exports){
'use strict';
var ko = require('./herocalc_knockout');
    
var my = require("./herocalc_core");

my.prototype.DamageTypeColor = {
    'physical': '#979aa2',
    'pure': 'goldenrod',
    'magic': '#428bca',
    'default': '#979aa2'
}

my.prototype.HeroDamageMixin = function (self) {
    self.critInfo = ko.pureComputed(function () {
        var critSources = self.inventory.getCritSource();
        my.prototype.extend(critSources, self.ability().getCritSource());
        my.prototype.extend(critSources, self.buffs.getCritSource());
        var critSourcesArray = [];
        for (var prop in critSources) {
            var el = critSources[prop];
            el.name = prop
            critSourcesArray.push(el);
        }
        function compareByMultiplier(a,b) {
            if (a.multiplier < b.multiplier)
                return 1;
            if (a.multiplier > b.multiplier)
                return -1;
            return 0;
        }

        critSourcesArray.sort(compareByMultiplier);
        
        var result = [];
        var critTotal = 0;
        for (var i = 0; i < critSourcesArray.length; i++) {
            var total = 1;
            for (var j = 0; j < i; j++) {
                for (var k = 0; k <critSourcesArray[j].count; k++) {
                    total *= (1 - critSourcesArray[j].chance);
                }
            }
            var total2 = 1;
            for (var k = 0; k < critSourcesArray[i].count; k++) {
                total2 *= (1 - critSourcesArray[i].chance);
            }
            total *= (1 - total2);
            critTotal += total;
            if (critSourcesArray[i].count > 1) {
                result.push({
                    'name':critSourcesArray[i].displayname + ' x' + critSourcesArray[i].count,
                    'chance':critSourcesArray[i].chance,
                    'multiplier':critSourcesArray[i].multiplier,
                    'count':critSourcesArray[i].count,
                    'totalChance':total
                });
            }
            else {
                result.push({
                    'name':critSourcesArray[i].displayname,
                    'chance':critSourcesArray[i].chance,
                    'multiplier':critSourcesArray[i].multiplier,
                    'count':critSourcesArray[i].count,
                    'totalChance':total
                });
            }
        }
        return { sources: result, total: critTotal };
    });

    self.cleaveInfo = ko.pureComputed(function () {
        var cleaveSources = self.inventory.getCleaveSource();
        my.prototype.extend(cleaveSources, self.ability().getCleaveSource());
        my.prototype.extend(cleaveSources, self.buffs.getCleaveSource());
        var cleaveSourcesArray = [];
        for (var prop in cleaveSources) {
            var el = cleaveSources[prop];
            el.name = prop
            cleaveSourcesArray.push(el);
        }
        function compareByRadius(a,b) {
            if (a.radius < b.radius)
                return 1;
            if (a.radius > b.radius)
                return -1;
            return 0;
        }

        cleaveSourcesArray.sort(compareByRadius);
        var cleaveSourcesByRadius = {};
        for (var i = 0; i < cleaveSourcesArray.length; i++) {
            var total = 0;
            for (var j = 0; j <cleaveSourcesArray.length; j++) {
                if (cleaveSourcesArray[j].radius >= cleaveSourcesArray[i].radius) {
                    total += cleaveSourcesArray[j].magnitude * cleaveSourcesArray[j].count;
                }
            }
            cleaveSourcesByRadius[cleaveSourcesArray[i].radius] = total;
        }
        var result = [];
        for (var prop in cleaveSourcesByRadius) {
            result.push({
                'radius':prop,
                'magnitude':cleaveSourcesByRadius[prop]
            });
        }
        return result;
    });
    
    self.bashInfo = ko.pureComputed(function () {
        var attacktype = self.heroData().attacktype;
        var bashSources = self.inventory.getBashSource(attacktype);
        my.prototype.extend(bashSources, self.ability().getBashSource());
        var bashSourcesArray = [];
        for (var prop in bashSources) {
            var el = bashSources[prop];
            el.name = prop
            bashSourcesArray.push(el);
        }
        function compareByDuration(a, b) {
            if (a.duration < b.duration)
                return 1;
            if (a.duration > b.duration)
                return -1;
            return 0;
        }

        //bashSourcesArray.sort(compareByDuration);
        
        var result = [];
        var bashTotal = 0;
        for (var i = 0;i < bashSourcesArray.length; i++) {
            var total = 1;
            for (var j = 0; j < i; j++) {
                for (var k = 0; k < bashSourcesArray[j].count; k++) {
                    total *= (1 - bashSourcesArray[j].chance);
                }
            }
            var total2 = 1;
            for (var k = 0; k < bashSourcesArray[i].count; k++) {
                total2 *= (1 - bashSourcesArray[i].chance);
            }
            total *= (1 - total2);
            bashTotal += total;
            if (bashSourcesArray[i].name === 'spirit_breaker_greater_bash') {
                var d = bashSourcesArray[i].damage * self.totalMovementSpeed();
            }
            else {
                var d = bashSourcesArray[i].damage;
            }
            if (bashSourcesArray[i].count > 1) {
                result.push({
                    'name':bashSourcesArray[i].displayname, // + ' x' + bashSourcesArray[i].count,
                    'chance':bashSourcesArray[i].chance,
                    'damage':d,
                    'count':bashSourcesArray[i].count,
                    'damageType':bashSourcesArray[i].damageType,
                    'totalChance':total
                });
            }
            else {
                result.push({
                    'name':bashSourcesArray[i].displayname,
                    'chance':bashSourcesArray[i].chance,
                    'damage':d,
                    'count':bashSourcesArray[i].count,
                    'damageType':bashSourcesArray[i].damageType,
                    'totalChance':total
                });
            }

        }
        return { sources: result, total: bashTotal };
    });
    
    self.orbProcInfo = ko.pureComputed(function () {
        var attacktype = self.heroData().attacktype;
        var damageSources = self.inventory.getOrbProcSource();
        var damageSourcesArray = [];
        for (var prop in damageSources) {
            var el = damageSources[prop];
            el.name = prop
            damageSourcesArray.push(el);
        }
        function compareByDamage(a, b) {
            if (a.priority > b.priority) {
                return 1;
            }
            if (a.priority < b.priority) {
                return -1;
            }
            if (a.damage < b.damage)
                return 1;
            if (a.damage > b.damage)
                return -1;
            return 0;
        }

        damageSourcesArray.sort(compareByDamage);
        
        var result = [];
        var damageTotal = 0;
        for (var i=0 ; i < damageSourcesArray.length; i++) {
            var total = 1;
            for (var j = 0; j < i; j++) {
                for (var k = 0; k < damageSourcesArray[j].count; k++) {
                    total *= (1 - damageSourcesArray[j].chance);
                }
            }
            var total2 = 1;
            for (var k = 0; k < damageSourcesArray[i].count; k++) {
                total2 *= (1 - damageSourcesArray[i].chance);
            }
            total *= (1 - total2);
            damageTotal += total;
            if (damageSourcesArray[i].count > 1) {
                result.push({
                    'name':damageSourcesArray[i].displayname + ' x' + damageSourcesArray[i].count,
                    'chance':damageSourcesArray[i].chance,
                    'damage':damageSourcesArray[i].damage,
                    'count':damageSourcesArray[i].count,
                    'damageType':damageSourcesArray[i].damageType,
                    'totalChance':total
                });
            }
            else {
                result.push({
                    'name':damageSourcesArray[i].displayname,
                    'chance':damageSourcesArray[i].chance,
                    'damage':damageSourcesArray[i].damage,
                    'count':damageSourcesArray[i].count,
                    'damageType':damageSourcesArray[i].damageType,
                    'totalChance':total
                });
            }
        }
        return { sources: result, total: damageTotal };
    });
    
    self.getReducedDamage = function (value, type) {
        var result = value;
        switch (type) {
            case 'physical':
                result = value * (1 - (0.06 * self.enemy().totalArmorPhysical()) / (1 + 0.06 * Math.abs(self.enemy().totalArmorPhysical())));
            break;
            case 'magic':
                result = value * (1 - self.enemy().totalMagicResistance() / 100);
            break;
            case 'pure':
                result = value;
            break;
            case 'composite':
                result = value * (1 - (0.06 * self.enemy().totalArmorPhysical()) / (1 + 0.06 * Math.abs(self.enemy().totalArmorPhysical())));
                result *= (1 - self.enemy().totalMagicResistance() / 100);
            break;
        }
        result *= self.ability().getDamageAmplification() * self.debuffs.getDamageAmplification();
        result *= self.enemy().ability().getDamageReduction() * self.enemy().buffs.getDamageReduction();
        return result;
    }
    
    self.damageTotalInfo = ko.pureComputed(function () {
        var bonusDamageArray = [
            self.ability().getBonusDamage().sources,
            self.buffs.getBonusDamage().sources
        ],
        bonusDamagePctArray = [
            self.ability().getBonusDamagePercent().sources,
            self.buffs.getBonusDamagePercent().sources
        ],
        itemBonusDamage = self.inventory.getBonusDamage().sources,
        itemBonusDamagePct = self.buffs.itemBuffs.getBonusDamagePercent(self.inventory.getBonusDamagePercent()).sources,
        critSources = self.critInfo(),
        abilityOrbSources = self.ability().getOrbSource(),
        itemOrbSources = self.inventory.getOrbSource(),
        itemProcOrbSources = self.orbProcInfo(),
        bashSources = self.bashInfo(),
        
        attackSources = [];
        
        attackSources.push({
            name: 'Base Attack',
            cooldown: 1
        });
        
        // weaver_geminate_attack
        if (self.heroId() === 'weaver') {
            var a = self.ability().abilities().find(function (ability) {
                return ability.name === 'weaver_geminate_attack';
            });
            if (a) {
                if (a.level() > 0) {
                    var cd = a.cooldown[a.level() - 1];
                    attackSources.push({
                        name: a.displayname,
                        cooldown: (1/cd)
                    });
                }
            }
        }
        
        // echo_sabre
        var item = self.inventory.items().find(function (o) { return o.item === "echo_sabre" && o.enabled(); });
        if (item && self.heroData().attacktype === 'DOTA_UNIT_CAP_MELEE_ATTACK') {
            var item_echo_sabre = my.prototype.itemData['item_echo_sabre'];
            attackSources.push({
                name: item_echo_sabre.displayname,
                cooldown: (1/item_echo_sabre.cooldown)
            });
        }

        var attacks = attackSources.map(function (a) {
            var baseDamage = (self.baseDamage()[0] + self.baseDamage()[1]) / 2,
            totalDamage = 0,
            totalCritableDamage = 0,
            totalCrit = 0,
            geminateAttack = { damage: 0, damageReduced: 0, cooldown: 6, active: false },
            echoSabreAttack = { damage: 0, damageReduced: 0, cooldown: my.prototype.itemData['item_echo_sabre'].cooldown[0], active: false },
            damage = {
                pure: 0,
                physical: 0,
                magic: 0
            },
            result = [],
            crits = [];
            
            // base damage
            result.push({
                name: 'Base Damage',
                damage: baseDamage,
                damageType: 'physical',
                damageReduced: self.getReducedDamage(baseDamage, 'physical'),
                enabled: ko.observable(true)
            });
            totalDamage += baseDamage;
            totalCritableDamage += baseDamage;
            damage.physical += baseDamage;
            
            // bonus damage from items
            for (i in itemBonusDamage) {
                var d = itemBonusDamage[i].damage*itemBonusDamage[i].count * self.ability().getSelfBaseDamageReductionPct() * self.enemy().ability().getBaseDamageReductionPct() * self.debuffs.itemBuffs.getBaseDamageReductionPct();
                result.push({
                    name: itemBonusDamage[i].displayname + (itemBonusDamage[i].count > 1 ? ' x' + itemBonusDamage[i].count : ''),
                    damage: d,
                    damageType: itemBonusDamage[i].damageType,
                    damageReduced: self.getReducedDamage(d, itemBonusDamage[i].damageType),
                    enabled: ko.observable(true)
                });
                totalDamage += d;
                totalCritableDamage += d;
                damage[itemBonusDamage[i].damageType] += d;
            }

            // bonus damage percent from items
            for (i in itemBonusDamagePct) {
                var d = baseDamage * itemBonusDamagePct[i].damage;
                result.push({
                    name: itemBonusDamagePct[i].displayname,
                    damage: d,
                    damageType: itemBonusDamagePct[i].damageType,
                    damageReduced: self.getReducedDamage(d, itemBonusDamagePct[i].damageType),
                    enabled: ko.observable(true)
                });
                totalDamage += d;
                totalCritableDamage += d;
                damage[itemBonusDamagePct[i].damageType] += d;
            }
            
            // bonus damage from abilities and buffs
            for (var i = 0; i < bonusDamageArray.length; i++) {
                for (j in bonusDamageArray[i]) {
                    var d = bonusDamageArray[i][j].damage;
                    result.push({
                        name: bonusDamageArray[i][j].displayname,
                        damage: d,
                        damageType: bonusDamageArray[i][j].damageType,
                        damageReduced: self.getReducedDamage(d, bonusDamageArray[i][j].damageType),
                        enabled: ko.observable(true)
                    });
                    totalDamage += d;
                    totalCritableDamage += d;
                    damage[bonusDamageArray[i][j].damageType] += d;
                }
            }
            
            // bonus damage percent from abilities and buffs
            for (var i = 0; i < bonusDamagePctArray.length; i++) {
                for (j in bonusDamagePctArray[i]) {
                    var d = baseDamage * bonusDamagePctArray[i][j].damage;
                    result.push({
                        name: bonusDamagePctArray[i][j].displayname,
                        damage: d,
                        damageType: bonusDamagePctArray[i][j].damageType,
                        damageReduced: self.getReducedDamage(d, bonusDamagePctArray[i][j].damageType),
                        enabled: ko.observable(true)
                    });
                    totalDamage += d;
                    totalCritableDamage += d;
                    damage[bonusDamagePctArray[i][j].damageType] += d;
                }
            }
            // drow_ranger_trueshot
            if (self.heroData().attacktype === 'DOTA_UNIT_CAP_RANGED_ATTACK') {
                if (self.heroId() === 'drow_ranger') {
                    var s = self.ability().getBonusDamagePrecisionAura().sources;
                    var index = 0;
                }
                else {
                    var s = self.buffs.getBonusDamagePrecisionAura().sources;
                    var index = 1;
                }
                if (s[index] != undefined) {
                    if (self.heroId() === 'drow_ranger') {
                        var d = s[index].damage * self.totalAgi();
                    }
                    else {
                        var d = s[index].damage;
                    }
                    result.push({
                        name: s[index].displayname,
                        damage: d,
                        damageType: 'physical',
                        damageReduced: self.getReducedDamage(d, 'physical'),
                        enabled: ko.observable(true)
                    });
                    totalDamage += d;
                    totalCritableDamage += d;
                    damage.physical += d;                    
                }
            }
            
            // riki_backstab
            if (self.heroId() === 'riki') {
                var s = self.ability().getBonusDamageBackstab().sources;
                var index = 0;
            }
            else {
                var s = self.buffs.getBonusDamageBackstab().sources;
                var index = 1;
            }
            if (s[index] != undefined) {
                if (self.heroId() === 'riki') {
                    var d = s[index].damage * self.totalAgi();
                }
                else {
                    var d = s[index].damage;
                }
                result.push({
                    name: s[index].displayname,
                    damage: d,
                    damageType: 'physical',
                    damageReduced: self.getReducedDamage(d, 'physical'),
                    enabled: ko.observable(true)
                });
                totalDamage += d;
                //totalCritableDamage += d;
                damage.physical += d;                    
            }

            // bash damage
            for (var i = 0; i < bashSources.sources.length; i++) {
                var o = bashSources.sources[i];
                var d = bashSources.sources[i].damage;
                var cd = self.attacksPerSecond();
                if (o.cooldown) {
                    cd = Math.max(1/o.cooldown, cd);
                }
                for (var j = 0; j < bashSources.sources[i].count; j++) {
                    result.push({
                        name: bashSources.sources[i].name,
                        damage: d,
                        damageType: bashSources.sources[i].damageType,
                        damageReduced: self.getReducedDamage(d, bashSources.sources[i].damageType),
                        dps: d * cd * bashSources.sources[i].chance,
                        dpsReduced: self.getReducedDamage(d, bashSources.sources[i].damageType) * cd * bashSources.sources[i].chance,
                        enabled: ko.observable(true)
                    });
                    totalDamage += d;
                    damage[bashSources.sources[i].damageType] += d;
                }

            }
            
            // %-based orbs
            for (var i = 0; i < itemProcOrbSources.sources.length; i++) {
                var d = itemProcOrbSources.sources[i].damage * (1 - Math.pow(1 - itemProcOrbSources.sources[i].chance, itemProcOrbSources.sources[i].count));
                result.push({
                    name: itemProcOrbSources.sources[i].name,
                    damage: d,
                    damageType: itemProcOrbSources.sources[i].damageType,
                    damageReduced: self.getReducedDamage(d, itemProcOrbSources.sources[i].damageType),
                    enabled: ko.observable(true)
                });
                totalDamage += d;
                damage[itemProcOrbSources.sources[i].damageType] += d;
            }
            
            // ability orbs
            for (var orb in abilityOrbSources) {
                var d = abilityOrbSources[orb].damage * (1 - itemProcOrbSources.total);
                result.push({
                    name: abilityOrbSources[orb].displayname,
                    damage: d,
                    damageType: abilityOrbSources[orb].damageType,
                    damageReduced: self.getReducedDamage(d, abilityOrbSources[orb].damageType),
                    enabled: ko.observable(true)
                });
                totalDamage += d;
                damage[abilityOrbSources[orb].damageType] += d;
            }
            
            // item orbs
            if (Object.keys(abilityOrbSources).length === 0) {
                for (var orb in itemOrbSources) {
                    var d = itemOrbSources[orb].damage * (1 - itemProcOrbSources.total);
                    result.push({
                        name: itemOrbSources[orb].displayname,
                        damage: d,
                        damageType: itemOrbSources[orb].damageType,
                        damageReduced: self.getReducedDamage(d, itemOrbSources[orb].damageType),
                        enabled: ko.observable(true)
                    });
                    totalDamage += d;
                    damage[itemOrbSources[orb].damageType] += d;
                }            
            }
            
            // crit damage
            for (var i = 0; i < critSources.sources.length; i++) {
                var d = totalCritableDamage * (critSources.sources[i].multiplier - 1);// * critSources.sources[i].totalChance;
                crits.push({
                    name: critSources.sources[i].name + ', ' + critSources.sources[i].multiplier + 'x, ' + (critSources.sources[i].totalChance * 100).toFixed(1) + '%',
                    damage: d,
                    damageType: 'physical',
                    damageReduced: self.getReducedDamage(d, 'physical'),
                    enabled: ko.observable(true),
                    chance: critSources.sources[i].totalChance
                });
                totalCrit += d;
            }

            var totalReduced = self.getReducedDamage(damage.pure, 'pure') 
                    + self.getReducedDamage(damage.physical, 'physical')
                    + self.getReducedDamage(damage.magic, 'magic'),
                totalCritReduced = self.getReducedDamage(totalCrit, 'physical'),
                dps = {
                    base: totalDamage * self.attacksPerSecond(),
                    crit: totalCrit * self.attacksPerSecond(),
                    geminateAttack: geminateAttack.active ? geminateAttack.damage / geminateAttack.cooldown : 0,
                    reduced: {
                        base: totalReduced * self.attacksPerSecond(),
                        crit: totalCritReduced * self.attacksPerSecond(),
                        geminateAttack: geminateAttack.active ? self.getReducedDamage(geminateAttack.damage, 'physical') / geminateAttack.cooldown : 0,
                    }
                }
                
            crits.forEach(function (o) {
                if (!o.dps) {
                    o.dps = o.damage * (o.cooldown || self.attacksPerSecond()) * o.chance;
                }
                if (!o.dpsReduced) {
                    o.dpsReduced = o.damageReduced * (o.cooldown || self.attacksPerSecond()) * o.chance;
                }
            });
                
            result.forEach(function (o) {
                if (!o.dps) {
                    o.dps = o.damage * (o.cooldown || self.attacksPerSecond());
                }
                if (!o.dpsReduced) {
                    o.dpsReduced = o.damageReduced * (o.cooldown || self.attacksPerSecond());
                }
            });
            
            var totalCritChance = crits.reduce(function (memo, o) { return memo + o.chance }, 0);
                
            var t1Crit = ko.computed(function () {
                var c = crits.find(function (o) { return o.enabled(); });
                return c ? c.damage : 0;
            });
            var t2Crit = ko.computed(function () {
                var c = crits.find(function (o) { return o.enabled(); });
                return c ? c.damageReduced : 0;
            });
            var t3Crit = ko.computed(function () {
                return crits.filter(function (o) { return o.enabled(); }).reduce(function (memo, o) { return memo + o.dps }, 0);
            });
            var t4Crit = ko.computed(function () {
                return crits.filter(function (o) { return o.enabled(); }).reduce(function (memo, o) { return memo + o.dpsReduced }, 0);
            });
                
            var t1 = ko.computed(function () {
                return result.filter(function (o) { return o.enabled(); }).reduce(function (memo, o) { return memo + o.damage }, 0) + t1Crit();
            });
            var t2 = ko.computed(function () {
                return result.filter(function (o) { return o.enabled(); }).reduce(function (memo, o) { return memo + o.damageReduced }, 0) + t2Crit();
            });
            var t3 = ko.computed(function () {
                return (result.filter(function (o) { return o.enabled(); }).reduce(function (memo, o) { return memo + o.dps }, 0) + t3Crit()) * a.cooldown;
            });
            var t4 = ko.computed(function () {
                return (result.filter(function (o) { return o.enabled(); }).reduce(function (memo, o) { return memo + o.dpsReduced }, 0) + t4Crit()) * a.cooldown;
            });
            
            var totalCritRow = [t1Crit, t2Crit, t3Crit, t4Crit];
            
            var totalRow = [t1, t2, t3, t4];

            return {
                name: a.name + ' Subtotal',
                cooldown: a.cooldown,
                enabled: ko.observable(true),
                visible: ko.observable(true),
                totalCritChance: totalCritChance,
                totalCritRow: totalCritRow,
                totalRow: totalRow,
                sources: result,
                sourcesCrit: crits,
                total: totalDamage,
                totalCrit: totalCrit,
                totalGeminateAttack: totalDamage + geminateAttack.damage,
                totalGeminateAttackReduced: totalReduced + geminateAttack.damageReduced,
                geminateAttack: geminateAttack,
                totalCritReduced: totalCritReduced,
                totalReduced: totalReduced,
                sumTotal: totalDamage + totalCrit,
                sumTotalReduced: totalReduced + totalCritReduced,
                dps: {
                    base: dps.base,
                    crit: dps.base + dps.crit,
                    geminateAttack: dps.base + dps.geminateAttack,
                    total: dps.base + dps.crit + dps.geminateAttack,
                    reduced: {
                        base: dps.reduced.base,
                        crit: dps.reduced.base + dps.reduced.crit,
                        geminateAttack: dps.reduced.base + dps.reduced.geminateAttack,
                        total: dps.reduced.base + dps.reduced.crit + dps.reduced.geminateAttack
                    }
                }
            };
        });
        
        var t1 = ko.computed(function () {
            return attacks.filter(function (o) { return o.enabled(); }).reduce(function (memo, o) { return memo + o.totalRow[0]() }, 0);
        });
        var t2 = ko.computed(function () {
            return attacks.filter(function (o) { return o.enabled(); }).reduce(function (memo, o) { return memo + o.totalRow[1]() }, 0);
        });
        var t3 = ko.computed(function () {
            return attacks.filter(function (o) { return o.enabled(); }).reduce(function (memo, o) { return memo + o.totalRow[2]() }, 0);
        });
        var t4 = ko.computed(function () {
            return attacks.filter(function (o) { return o.enabled(); }).reduce(function (memo, o) { return memo + o.totalRow[3]() }, 0);
        });
            
        return {
            attacks: attacks,
            totalRow: [t1, t2, t3, t4]
        }
    });
    
    self.getDamageTypeColor = function (damageType) {
        return my.prototype.DamageTypeColor[damageType] || my.prototype.DamageTypeColor['default'];
    }
    
}
},{"./herocalc_core":47,"./herocalc_knockout":53}],52:[function(require,module,exports){
'use strict';
var ko = require('./herocalc_knockout');
var my = require("./herocalc_core");

my.prototype.stackableItems = ['clarity','flask','dust','ward_observer','ward_sentry','tango','tpscroll','smoke_of_deceit'],
my.prototype.levelitems = ['necronomicon','dagon','diffusal_blade','travel_boots'],
my.prototype.validItems = ["abyssal_blade","ultimate_scepter","courier","arcane_boots","armlet","assault","boots_of_elves","bfury","belt_of_strength","black_king_bar","blade_mail","blade_of_alacrity","blades_of_attack","blink","bloodstone","boots","travel_boots","bottle","bracer","broadsword","buckler","butterfly","chainmail","circlet","clarity","claymore","cloak","lesser_crit","greater_crit","dagon","demon_edge","desolator","diffusal_blade","rapier","ancient_janggo","dust","eagle","energy_booster","ethereal_blade","cyclone","skadi","flying_courier","force_staff","gauntlets","gem","ghost","gloves","hand_of_midas","headdress","flask","heart","heavens_halberd","helm_of_iron_will","helm_of_the_dominator","hood_of_defiance","hyperstone","branches","javelin","sphere","maelstrom","magic_stick","magic_wand","manta","mantle","mask_of_madness","medallion_of_courage","mekansm","mithril_hammer","mjollnir","monkey_king_bar","lifesteal","mystic_staff","necronomicon","null_talisman","oblivion_staff","ward_observer","ogre_axe","orb_of_venom","orchid","pers","phase_boots","pipe","platemail","point_booster","poor_mans_shield","power_treads","quarterstaff","quelling_blade","radiance","reaver","refresher","ring_of_aquila","ring_of_basilius","ring_of_health","ring_of_protection","ring_of_regen","robe","rod_of_atos","relic","sobi_mask","sange","sange_and_yasha","satanic","sheepstick","ward_sentry","shadow_amulet","invis_sword","shivas_guard","basher","slippers","smoke_of_deceit","soul_booster","soul_ring","staff_of_wizardry","stout_shield","talisman_of_evasion","tango","tpscroll","tranquil_boots","ultimate_orb","urn_of_shadows","vanguard","veil_of_discord","vitality_booster","vladmir","void_stone","wraith_band","yasha","crimson_guard","enchanted_mango","lotus_orb","glimmer_cape","guardian_greaves","moon_shard","silver_edge","solar_crest","octarine_core","aether_lens","faerie_fire","iron_talon","dragon_lance","echo_sabre","infused_raindrop","blight_stone","wind_lace","tome_of_knowledge","bloodthorn","hurricane_pike"],
my.prototype.itemsWithActive = ['heart','smoke_of_deceit','dust','ghost','tranquil_boots','phase_boots','power_treads','buckler','medallion_of_courage','ancient_janggo','mekansm','pipe','veil_of_discord','rod_of_atos','orchid','sheepstick','armlet','invis_sword','ethereal_blade','shivas_guard','manta','mask_of_madness','diffusal_blade','mjollnir','satanic','ring_of_basilius','ring_of_aquila', 'butterfly', 'moon_shard', 'silver_edge','bloodthorn'];

my.prototype.ItemInput = function (value, name, debuff) {
    if (my.prototype.itemData['item_' + value].ItemAliases instanceof Array) {
        var itemAlias = my.prototype.itemData['item_' + value].ItemAliases.join(' ');
    }
    else {
        var itemAlias = my.prototype.itemData['item_' + value].ItemAliases;
    }
    this.value = ko.observable(value);
    this.debuff = ko.observable(debuff);
    if (this.debuff()) {
        this.value = ko.observable(value + '|' + debuff.id);
        this.name = ko.observable(name + ' (' + debuff.name + ')');
        this.displayname = ko.observable(name + ' (' + debuff.name + ') <span style="display:none">' + ';' + itemAlias + '</span>');
    }
    else {
        this.value = ko.observable(value);
        this.name = ko.observable(name);
        this.displayname = ko.observable(name + ' <span style="display:none">' + ';' + itemAlias + '</span>');
    }
};

my.prototype.BasicInventoryViewModel = function (h) {
    var self = this;
    self.items = ko.observableArray([]);
    self.activeItems = ko.observableArray([]);
    self.addItem = function (data, event) {
        if (data.selectedItem() != undefined) {
            var new_item = {
                item: data.selectedItem().split('|')[0],
                state: ko.observable(0),
                size: data.itemInputValue(),
                enabled: ko.observable(true)
            }
            switch (new_item.item) {
                case 'dagon':
                    new_item.size = Math.min(new_item.size, 5);
                break;
                break;
                case 'travel_boots':
                case 'diffusal_blade':
                    new_item.size = Math.min(new_item.size, 2);
                break;
                case 'necronomicon':
                    new_item.size = Math.min(new_item.size, 3);
                break;
            }
            self.items.push(new_item);
            if (data.selectedItem() === 'ring_of_aquila' || data.selectedItem() === 'ring_of_basilius' || data.selectedItem() === 'heart') {
                self.toggleItem(undefined, new_item, undefined);
            }
        }
    };
    self.toggleItem = function (index, data, event) {
        if (my.prototype.itemsWithActive.indexOf(data.item) >= 0) {
            if (self.activeItems.indexOf(data) < 0) {
                self.activeItems.push(data);
            }
            else {
                self.activeItems.remove(data);
            }
            switch (data.item) {
                case 'power_treads':
                    if (data.state() < 2) {
                        data.state(data.state() + 1);
                    }
                    else {
                        data.state(0);
                    }                
                break;
                default:
                    if (data.state() == 0) {
                        data.state(1);
                    }
                    else {
                        data.state(0);
                    }                
                break;
            }
        }
    }.bind(this);
    self.removeItem = function (item) {
        self.activeItems.remove(item);
        self.items.remove(item);
    }.bind(this);
    self.toggleMuteItem = function (item) {
        item.enabled(!item.enabled());
    }.bind(this);      
    self.removeAll = function () {
        self.activeItems.removeAll();
        self.items.removeAll();
    }.bind(this);
}
my.prototype.BasicInventoryViewModel.prototype.getItemImage = function (data) {
    var state = ko.utils.unwrapObservable(data.state);
    switch (data.item) {
        case 'power_treads':
            if (state == 0) {
                return '/media/images/items/' + data.item + '_str.png';
            }
            else if (state == 1) {
                return '/media/images/items/' + data.item + '_int.png';
            }
            else {
                return '/media/images/items/' + data.item + '_agi.png';
            }
        break;
        case 'tranquil_boots':
        case 'ring_of_basilius':
            if (state == 0) {
                return '/media/images/items/' + data.item + '.png';
            }
            else {
                return '/media/images/items/' + data.item + '_active.png';
            }
        break;
        case 'armlet':
            if (state == 0) {
                return '/media/images/items/' + data.item + '.png';
            }
            else {
                return '/media/images/items/' + data.item + '_active.png';
            }
        break;
        case 'ring_of_aquila':
            if (state == 0) {
                return '/media/images/items/' + data.item + '_active.png';
            }
            else {
                return '/media/images/items/' + data.item + '.png';
            }
        break;
        case 'dagon':
        case 'diffusal_blade':
        case 'travel_boots':
        case 'necronomicon':
            if (data.size > 1) {
                return '/media/images/items/' + data.item + '_' + data.size + '.png';
            }
            else {
                return '/media/images/items/' + data.item + '.png';
            }
        break;
        default:
            return '/media/images/items/' + data.item + '.png';            
        break;
    }
};
my.prototype.BasicInventoryViewModel.prototype.getItemSizeLabel = function (data) {
    if (my.prototype.stackableItems.indexOf(data.item) != -1) {
        return '<span style="font-size:10px">Qty: </span>' + data.size;
    }
    else if (my.prototype.levelitems.indexOf(data.item) != -1) {
        return '<span style="font-size:10px">Lvl: </span>' + data.size;
    }
    else if (data.item == 'bloodstone') {
        return '<span style="font-size:10px">Charges: </span>' + data.size;
    }
    else {
        return '';
    }
};
my.prototype.BasicInventoryViewModel.prototype.getActiveBorder = function (data) {
    switch (data.item) {
        case 'power_treads':
        case 'tranquil_boots':
        case 'ring_of_basilius':
        case 'ring_of_aquila':
        case 'armlet':
            return 0;
        break;
        default:
            return ko.utils.unwrapObservable(data.state);    
        break;
    }
}
my.prototype.BasicInventoryViewModel.prototype.getItemAttributeValue = function (attributes, attributeName, level) {
    for (var i = 0; i < attributes.length; i++) {
        if (attributes[i].name == attributeName) {
            if (level == 0) {
                return parseFloat(attributes[i].value[0]);
            }
            else if (level > attributes[i].value.length) {
                return parseFloat(attributes[i].value[0]);
            }
            else {
                return parseFloat(attributes[i].value[level - 1]);
            }
        }
    }
}

my.prototype.InventoryViewModel = function (h) {
    var self = new my.prototype.BasicInventoryViewModel();
    self.hero = h;
    self.hasInventory = ko.observable(true);
    self.items = ko.observableArray([]);
    self.activeItems = ko.observableArray([]);
    self.hasScepter = ko.computed(function () {
        for (var i = 0; i < self.items().length; i++) {
            var item = self.items()[i].item;
            if (item === 'ultimate_scepter' && self.items()[i].enabled()) {
                return true;
            }
            
        }
        return false;
    }, this);
    self.isEthereal = ko.computed(function () {
        for (var i = 0; i < self.items().length; i++) {
            var item = self.items()[i].item;
            var isActive = self.activeItems.indexOf(self.items()[i]) >= 0 ? true : false;
            if ((item === 'ghost' || item === 'ethereal_blade') && self.items()[i].enabled() && isActive) {
                return true;
            }
        }
        return false;
    }, this);
    self.isSheeped = ko.computed(function () {
        for (var i = 0; i < self.items().length; i++) {
            var item = self.items()[i].item;
            var isActive = self.activeItems.indexOf(self.items()[i]) >= 0 ? true : false;
            if (item === 'sheepstick' && self.items()[i].enabled() && isActive) {
                return true;
            }
        }
        return false;
    }, this);
    self.totalCost = ko.computed(function () {
        var c = 0;
        for (var i = 0; i < self.items().length; i++) {
            var item = self.items()[i].item;
            if (!self.items()[i].enabled()) continue;
            if (my.prototype.stackableItems.indexOf(item) != -1) {
                c += my.prototype.itemData['item_' + item].itemcost * self.items()[i].size;
            }
            else if (my.prototype.levelitems.indexOf(item) != -1) {
                switch(item) {
                    case 'diffusal_blade':
                        c += my.prototype.itemData['item_' + item].itemcost + (self.items()[i].size - 1) * 700;
                    break;
                    case 'necronomicon':
                    case 'dagon':
                        c += my.prototype.itemData['item_' + item].itemcost + (self.items()[i].size - 1) * 1250;
                    break;
                    default:
                        c += my.prototype.itemData['item_' + item].itemcost;
                    break;
                }
            }
            else {
                c += my.prototype.itemData['item_' + item].itemcost;
            }
            
        }
        return c;
    }, this);
    self.addItemBuff = function (data, event) {
        if (self.hasInventory() && self.selectedItemBuff() != undefined) {
            var new_item = {
                item: self.selectedItemBuff(),
                state: ko.observable(0),
                size: 1,
                enabled: ko.observable(true)
            }
            self.items.push(new_item);
            if (self.selectedItemBuff() === 'ring_of_aquila' || self.selectedItemBuff() === 'ring_of_basilius') {
                self.toggleItem(undefined, new_item, undefined);
            }
        }
    };
    self.addItemDebuff = function (data, event) {
        if (self.hasInventory() && self.selectedItemDebuff() != undefined) {
            var new_item = {
                item: self.selectedItemDebuff().split('|')[0],
                state: ko.observable(0),
                size: 1,
                enabled: ko.observable(true)
            }
            if (self.selectedItemDebuff().split('|').length == 2) {
                new_item.debuff = self.selectedItemDebuff().split('|')[1]
            }
            self.items.push(new_item);
            if (self.selectedItemDebuff() === 'ring_of_aquila' || self.selectedItemDebuff() === 'ring_of_basilius') {
                self.toggleItem(undefined, new_item, undefined);
            }
        }
    };
    
    self.getAttributes = function (attributetype) {
        var totalAttribute = 0;
        for (var i = 0; i < self.items().length; i++) {
            var item = self.items()[i].item;
            var isActive = self.activeItems.indexOf(self.items()[i]) >= 0 ? true : false;
            if (!self.items()[i].enabled()) continue;
            var size = self.items()[i].size;
            for (var j = 0; j < my.prototype.itemData['item_' + item].attributes.length; j++) {
                var attribute = my.prototype.itemData['item_' + item].attributes[j];
                switch(attribute.name) {
                    case 'bonus_all_stats':
                        totalAttribute += parseInt(attribute.value[0]);
                    break;
                    case 'bonus_stats':
                        totalAttribute += parseInt(attribute.value[0]);
                    break;
                }
                switch(attributetype) {
                    case 'agi':
                        if (attribute.name == 'bonus_agility') {
                            if (item == 'diffusal_blade') {
                                totalAttribute += parseInt(attribute.value[size-1]);
                            }
                            else {
                                totalAttribute += parseInt(attribute.value[0]);
                            }
                        }
                        if (attribute.name == 'bonus_stat' && self.items()[i].state() == 2) {totalAttribute += parseInt(attribute.value[0]);};
                        if (attribute.name == 'bonus_agi') {totalAttribute += parseInt(attribute.value[0]);};
                    break;
                    case 'int':
                        if (attribute.name == 'bonus_intellect') {
                            if (item == 'necronomicon') {
                                totalAttribute += parseInt(attribute.value[size-1]);
                            }
                            else if (item == 'diffusal_blade') {
                                totalAttribute += parseInt(attribute.value[size-1]);
                            }
                            else if (item == 'dagon') {
                                totalAttribute += parseInt(attribute.value[size-1]);
                            }
                            else {
                                totalAttribute += parseInt(attribute.value[0]);
                            }
                        }
                        if (attribute.name == 'bonus_intelligence') {totalAttribute += parseInt(attribute.value[0]);};
                        if (attribute.name == 'bonus_int') {totalAttribute += parseInt(attribute.value[0]);};
                        if (attribute.name == 'bonus_stat' && self.items()[i].state() == 1) {totalAttribute += parseInt(attribute.value[0]);};
                    break;
                    case 'str':
                        if (attribute.name == 'bonus_strength') {
                            if (item == 'necronomicon') {
                                totalAttribute += parseInt(attribute.value[size-1]);
                            }
                            else {
                                totalAttribute += parseInt(attribute.value[0]);
                            }
                        }
                        if (attribute.name == 'bonus_stat' && self.items()[i].state() == 0) {totalAttribute += parseInt(attribute.value[0]);};
                        if (attribute.name == 'bonus_str') {totalAttribute += parseInt(attribute.value[0]);};
                        if (attribute.name == 'unholy_bonus_strength' && isActive) {totalAttribute += parseInt(attribute.value[0]);};
                    break;
                }
            }
        }
        return totalAttribute;
    };
    self.getBash = function (attacktype) {
        var totalAttribute = 1;
        for (var i = 0; i < self.items().length; i++) {
            var item = self.items()[i].item;
            if (!self.items()[i].enabled()) continue;
            for (var j = 0; j < my.prototype.itemData['item_' + item].attributes.length; j++) {
                var attribute = my.prototype.itemData['item_' + item].attributes[j];
                switch(attribute.name) {
                    case 'bash_chance':
                        totalAttribute *= (1 - parseInt(attribute.value[0]) / 100);
                    break;
                    case 'bash_chance_melee':
                        if (attacktype == 'DOTA_UNIT_CAP_MELEE_ATTACK') { totalAttribute *= (1 - parseInt(attribute.value[0]) / 100); };
                    break;
                    case 'bash_chance_ranged':
                        if (attacktype == 'DOTA_UNIT_CAP_RANGED_ATTACK') { totalAttribute *= (1 - parseInt(attribute.value[0]) / 100); };
                    break;
                }
            }
        }
        return totalAttribute;
    };
    
    self.getCritChance = function () {
        var totalAttribute = 1;
        for (var i = 0; i < self.items().length; i++) {
            var item = self.items()[i].item;
            var isActive = self.activeItems.indexOf(self.items()[i]) >= 0 ? true : false;
            if (!self.items()[i].enabled()) continue;
            for (var j = 0; j < my.prototype.itemData['item_' + item].attributes.length; j++) {
                var attribute = my.prototype.itemData['item_' + item].attributes[j];
                switch(attribute.name) {
                    case 'crit_chance':
                        totalAttribute *= (1 - parseInt(attribute.value[0]) / 100);
                    break;
                }
            }
        }
        return totalAttribute;
    };
    
    self.getCritSource = function () {
        var sources = {};
        for (var i = 0; i < self.items().length; i++) {
            var item = self.items()[i].item;
            var isActive = self.activeItems.indexOf(self.items()[i]) >= 0 ? true : false;
            if (!self.items()[i].enabled()) continue;
            switch (item) {
                case 'lesser_crit':
                case 'greater_crit':
                case 'bloodthorn':
                    if (sources[item] == undefined) {
                        sources[item] = {
                            'chance': self.getItemAttributeValue(my.prototype.itemData['item_' + item].attributes, 'crit_chance', 0) / 100,
                            'multiplier': self.getItemAttributeValue(my.prototype.itemData['item_' + item].attributes, 'crit_multiplier', 0) / 100,
                            'count': 1,
                            'displayname': my.prototype.itemData['item_' + item].displayname
                        }
                    }
                    else {
                        sources[item].count += 1;
                    }
                break;
            }
            if (item === 'bloodthorn' && isActive) {
                if (sources['soul_rend'] == undefined) {
                    sources['soul_rend'] = {
                        'chance': 1,
                        'multiplier': self.getItemAttributeValue(my.prototype.itemData['item_' + item].attributes, 'target_crit_multiplier', 0) / 100,
                        'count': 1,
                        'displayname': 'Soul Rend'
                    }
                }
                else {
                    sources['soul_rend'].count += 1;
                }
            }
        }
        return sources;
    };

    self.getCleaveSource = function () {
        var sources = {};
        for (var i = 0; i < self.items().length; i++) {
            var item = self.items()[i].item;
            var isActive = self.activeItems.indexOf(self.items()[i]) >= 0 ? true : false;
            if (!self.items()[i].enabled()) continue;
            switch (item) {
                case 'bfury':
                    if (sources[item] == undefined) {
                        sources[item] = {
                            'radius': self.getItemAttributeValue(my.prototype.itemData['item_' + item].attributes, 'cleave_radius', 0),
                            'magnitude': self.getItemAttributeValue(my.prototype.itemData['item_' + item].attributes, 'cleave_damage_percent', 0) / 100,
                            'count': 1,
                            'displayname': my.prototype.itemData['item_' + item].displayname
                        }
                    }
                    else {
                        sources[item].count += 1;
                    }
                break;
            }

        }
        return sources;
    };
    
    self.getBashSource = function (attacktype) {
        var sources = {};
        for (var i = 0; i < self.items().length; i++) {
            var item = self.items()[i].item;
            var isActive = self.activeItems.indexOf(self.items()[i]) >= 0 ? true : false;
            if (!self.items()[i].enabled()) continue;
            switch (item) {
                case 'javelin':
                    if (sources[item] == undefined) {
                        sources[item] = {
                            'damage': self.getItemAttributeValue(my.prototype.itemData['item_' + item].attributes, 'bonus_chance_damage', 1),
                            'damageType': 'magic',
                            'count': 1,
                            'chance': self.getItemAttributeValue(my.prototype.itemData['item_' + item].attributes, 'bonus_chance', 1) / 100,
                            'displayname': my.prototype.itemData['item_' + item].displayname + ' Pierce'
                        }
                    }
                    else {
                        sources[item].count += 1;
                    }
                break;
                case 'monkey_king_bar':
                    if (sources[item] == undefined) {
                        sources[item] = {
                            'item': item,
                            'chance': self.getItemAttributeValue(my.prototype.itemData['item_' + item].attributes, 'bash_chance', 0) / 100,
                            'damage': self.getItemAttributeValue(my.prototype.itemData['item_' + item].attributes, 'bash_damage', 0),
                            'duration': self.getItemAttributeValue(my.prototype.itemData['item_' + item].attributes, 'bash_stun', 0),
                            'count': 1,
                            'damageType': 'magic',
                            'displayname': 'Mini-Bash' //my.prototype.itemData['item_' + item].displayname
                        }
                    }
                    else {
                        sources[item].count += 1;
                    }
                break;
                case 'abyssal_blade':
                case 'basher':
                    if (!sources.hasOwnProperty('bash')) {
                        sources['bash'] = {
                            'item': item,
                            'chance': self.getItemAttributeValue(my.prototype.itemData['item_' + item].attributes, (attacktype == 'DOTA_UNIT_CAP_MELEE_ATTACK') ?'bash_chance_melee' : 'bash_chance_ranged', 0) / 100,
                            'damage': self.getItemAttributeValue(my.prototype.itemData['item_' + item].attributes, 'bonus_chance_damage', 0),
                            'duration': self.getItemAttributeValue(my.prototype.itemData['item_' + item].attributes, 'bash_duration', 0),
                            'count': 1,
                            'damageType': 'physical',
                            'displayname': 'Bash' //my.prototype.itemData['item_' + item].displayname
                        }
                    }
                    else {
                        //sources[item].count += 1;
                    }
                break;
            }

        }
        return sources;
    };
    
    self.getOrbProcSource = function () {
        var sources = {};
        for (var i = 0; i < self.items().length; i++) {
            var item = self.items()[i].item;
            var isActive = self.activeItems.indexOf(self.items()[i]) >= 0 ? true : false;
            if (!self.items()[i].enabled()) continue;
            switch (item) {
                case 'maelstrom':
                case 'mjollnir':
                    if (sources[item] == undefined) {
                        sources[item] = {
                            'chance': self.getItemAttributeValue(my.prototype.itemData['item_' + item].attributes, 'chain_chance', 0) / 100,
                            'damage': self.getItemAttributeValue(my.prototype.itemData['item_' + item].attributes, 'chain_damage', 0),
                            'count': 1,
                            'damageType': 'magic',
                            'displayname': my.prototype.itemData['item_' + item].displayname
                        }
                    }
                    else {
                        sources[item].count += 1;
                    }
                break;
            }

        }
        return sources;
    };

    self.getOrbSource = function () {
        var sources = {};
        for (var i = 0; i < self.items().length; i++) {
            var item = self.items()[i].item;
            var isActive = self.activeItems.indexOf(self.items()[i]) >= 0 ? true : false;
            if (!self.items()[i].enabled()) continue;
            switch (item) {
                case 'diffusal_blade':
                    if (sources[item] == undefined) {
                        sources[item] = {
                            'chance': 1,
                            'damage': self.getItemAttributeValue(my.prototype.itemData['item_' + item].attributes, 'feedback_mana_burn', self.items()[i].size),
                            'count': 1,
                            'damageType': 'physical',
                            'displayname': my.prototype.itemData['item_' + item].displayname
                        }
                    }
                    else {
                        sources[item].count += 1;
                    }
                break;
            }

        }
        return sources;
    };
    
    self.getHealth = function () {
        var totalAttribute = 0;
        for (var i = 0; i < self.items().length; i++) {
            var item = self.items()[i].item;
            if (!self.items()[i].enabled()) continue;
            for (var j = 0; j < my.prototype.itemData['item_' + item].attributes.length; j++) {
                var attribute = my.prototype.itemData['item_' + item].attributes[j];
                switch(attribute.name) {
                    case 'bonus_health':
                        totalAttribute += parseInt(attribute.value[0]);
                    break;
                }
            }
        }
        return totalAttribute;
    };
    self.getHealthRegen = function () {
        var totalAttribute = 0;
        for (var i = 0; i < self.items().length; i++) {
            var item = self.items()[i].item;
            var isActive = self.activeItems.indexOf(self.items()[i]) >= 0 ? true : false;
            if (!self.items()[i].enabled()) continue;
            for (var j = 0; j < my.prototype.itemData['item_' + item].attributes.length; j++) {
                var attribute = my.prototype.itemData['item_' + item].attributes[j];
                switch(attribute.name) {
                    case 'health_regen':
                    case 'bonus_regen':
                        totalAttribute += parseInt(attribute.value[0]);
                    break;
                    case 'bonus_health_regen':
                        if (item == 'tranquil_boots' && !isActive) {
                            totalAttribute += parseInt(attribute.value[0]);
                        }
                        else if (item != 'tranquil_boots') {
                            totalAttribute += parseInt(attribute.value[0]);
                        }
                    break;
                    case 'hp_regen':
                        totalAttribute += parseInt(attribute.value[0]);
                    break;
                    case 'health_regen_rate':
                        if (item == 'heart' && isActive) {
                            totalAttribute += (parseInt(attribute.value[0]) / 100) * self.hero.health();
                        }
                    break;
                }
            }
        }
        return totalAttribute;
    };
    self.getHealthRegenAura = function (e) {
        var totalAttribute = 0,
            excludeList = e || [];
        for (var i = 0; i < self.items().length; i++) {
            var item = self.items()[i].item;
            var isActive = self.activeItems.indexOf(self.items()[i]) >= 0 ? true : false;
            if (!self.items()[i].enabled()) continue;
            for (var j = 0; j < my.prototype.itemData['item_' + item].attributes.length; j++) {
                var attribute = my.prototype.itemData['item_' + item].attributes[j];
                if (excludeList.indexOf(item + attribute.name) > -1) continue;
                switch(attribute.name) {
                    case 'aura_health_regen':
                        totalAttribute += parseInt(attribute.value[0]);
                        excludeList.push(item + attribute.name);
                    break;
                }
            }
        }
        return {value: totalAttribute, excludeList: excludeList};
    };
    
    self.getMana = function () {
        var totalAttribute = 0;
        for (var i = 0; i < self.items().length; i++) {
            var item = self.items()[i].item;
            if (!self.items()[i].enabled()) continue;
            for (var j = 0; j < my.prototype.itemData['item_' + item].attributes.length; j++) {
                var attribute = my.prototype.itemData['item_' + item].attributes[j];
                switch(attribute.name) {
                    case 'bonus_mana':
                        totalAttribute += parseInt(attribute.value[0]);
                    break;
                }
            }
        }
        return totalAttribute;
    };
    
    self.getManaRegen = function () {
        var totalAttribute = 0;
        for (var i = 0; i < self.items().length; i++) {
            var item = self.items()[i].item;
            if (!self.items()[i].enabled()) continue;
            for (var j = 0; j < my.prototype.itemData['item_' + item].attributes.length; j++) {
                var attribute = my.prototype.itemData['item_' + item].attributes[j];
                switch(attribute.name) {
                    case 'aura_mana_regen':
                    case 'mana_regen_aura':
                        totalAttribute += parseFloat(attribute.value[0]);
                    break;
                    case 'mana_regen':
                        if (item == 'infused_raindrop') totalAttribute += parseFloat(attribute.value[0]);
                    break;
                }
            }
        }
        return totalAttribute;    
    };
    self.getManaRegenPercent = function () {
        var totalAttribute = 0;
        for (var i = 0; i < self.items().length; i++) {
            var item = self.items()[i].item;
            if (!self.items()[i].enabled()) continue;
            for (var j = 0; j < my.prototype.itemData['item_' + item].attributes.length; j++) {
                var attribute = my.prototype.itemData['item_' + item].attributes[j];
                switch(attribute.name) {
                    case 'bonus_mana_regen':
                    case 'mana_regen':
                    case 'bonus_mana_regen_pct':
                        if (item != 'infused_raindrop') totalAttribute += parseFloat(attribute.value[0]);
                    break;
                }
            }
        }
        return totalAttribute / 100;    
    };
    self.getManaRegenBloodstone = function () {
        for (var i = 0; i < self.items().length; i++) {
            var item = self.items()[i].item;
            if (!self.items()[i].enabled()) continue;
            if (item.indexOf('bloodstone') != -1) {
                return parseInt(self.items()[i].size);
            }
        }
        return 0;
    };
    
    self.getArmor = function () {
        var totalAttribute = 0;
        for (var i = 0; i < self.items().length; i++) {
            var item = self.items()[i].item;
            var isActive = self.activeItems.indexOf(self.items()[i]) >= 0 ? true : false;
            if (!self.items()[i].enabled()) continue;
            for (var j = 0; j < my.prototype.itemData['item_' + item].attributes.length; j++) {
                var attribute = my.prototype.itemData['item_' + item].attributes[j];
                switch(attribute.name) {
                    case 'bonus_armor':
                        if (!isActive || item != 'medallion_of_courage') { totalAttribute += parseInt(attribute.value[0]); };
                    break;
                    case 'unholy_bonus_armor':
                        if (isActive && item == 'armlet') { totalAttribute += parseInt(attribute.value[0]); };
                    break;
                }
            }
        }
        return totalAttribute;
    };
    
    self.getArmorAura = function (aList) {
        var totalAttribute = 0,
            attributeList = aList || [];
        for (var i = 0; i < self.items().length; i++) {
            var item = self.items()[i].item;
            var isActive = self.activeItems.indexOf(self.items()[i]) >= 0 ? true : false;
            if (!self.items()[i].enabled()) continue;
            for (var j = 0;j < my.prototype.itemData['item_' + item].attributes.length; j++) {
                var attribute = my.prototype.itemData['item_' + item].attributes[j];
                if (attributeList.find(function (a) { return attribute.name == a.name; })) continue;
                switch(attribute.name) {
                    // buckler
                    case 'bonus_aoe_armor':
                        if (isActive) {
                            attributeList.push({'name':attribute.name, 'value': parseInt(attribute.value[0])});
                        }
                    break;
                    // assault
                    case 'aura_positive_armor':
                        attributeList.push({'name':attribute.name, 'value': parseInt(attribute.value[0])});
                    break;
                    // ring_of_aquila,ring_of_basilius
                    case 'aura_bonus_armor':
                        if (isActive) {
                            attributeList.push({'name':attribute.name, 'value': parseInt(attribute.value[0])});
                        }
                    break;
                    // vladmir
                    case 'armor_aura':
                        attributeList.push({'name':attribute.name, 'value': parseInt(attribute.value[0])});
                    break;
                    // mekansm
                    case 'heal_bonus_armor':
                        if (isActive) {
                            attributeList.push({'name':attribute.name, 'value': parseInt(attribute.value[0])});
                        }
                    break;
                }
            }
        }
        // remove buckler if there is a mekansm
        if (attributeList.find(function (attribute) { return attribute.name == 'heal_bonus_armor'; })) {
            attributeList = attributeList.filter(function (attribute) {
                return attribute.name !== 'bonus_aoe_armor';
            });
        }
        // remove ring_of_aquila,ring_of_basilius if there is a vladmir
        if (attributeList.find(function (attribute) { return attribute.name == 'armor_aura'; })) {
            attributeList = attributeList.filter(function (attribute) {
                return attribute.name !== 'aura_bonus_armor';
            });
        }
        
        totalAttribute = attributeList.reduce(function (memo, attribute) {
            return memo += attribute.value;
        }, 0);
        return {value: totalAttribute, attributes: attributeList};
    };
    self.getArmorReduction = function (e) {
        var totalAttribute = 0,
            excludeList = e || [];
        for (var i = 0; i < self.items().length; i++) {
            var item = self.items()[i].item;
            var isActive = self.activeItems.indexOf(self.items()[i]) >= 0 ? true : false;
            if (!self.items()[i].enabled()) continue;
            for (var j = 0; j < my.prototype.itemData['item_' + item].attributes.length; j++) {
                var attribute = my.prototype.itemData['item_' + item].attributes[j];
                if (excludeList.indexOf(attribute.name) > -1 || excludeList.indexOf(item + '_' + attribute.name) > -1) continue;
                switch(attribute.name) {
                    case 'armor_reduction':
                        totalAttribute += parseInt(attribute.value[0]);
                        excludeList.push(item + '_' + attribute.name);
                    break;
                    case 'aura_negative_armor':
                        totalAttribute += parseInt(attribute.value[0]);
                        excludeList.push(attribute.name);
                    break;
                    case 'corruption_armor':
                        totalAttribute += parseInt(attribute.value[0]);
                        excludeList.push(attribute.name);
                    break;
                }
            }
        }
        return {value: totalAttribute, excludeList: excludeList};
    };
    self.getEvasion = function () {
        var totalAttribute = 1;
        for (var i = 0; i < self.items().length; i++) {
            var item = self.items()[i].item;
            var isActive = self.activeItems.indexOf(self.items()[i]) >= 0 ? true : false;
            if (!self.items()[i].enabled()) continue;
            for (var j = 0; j < my.prototype.itemData['item_' + item].attributes.length; j++) {
                var attribute = my.prototype.itemData['item_' + item].attributes[j];
                switch(attribute.name) {
                    case 'bonus_evasion':
                        if (item != 'butterfly' || !isActive) totalAttribute *= (1 - parseInt(attribute.value[0]) / 100);
                    break;
                }
            }
        }
        return totalAttribute;
    };
    self.getMovementSpeedFlat = function () {
        var totalAttribute = 0,
        hasBoots = false,
        hasEuls = false,
        hasWindLace = false,
        bootItems = ['boots','phase_boots','arcane_boots','travel_boots','power_treads','tranquil_boots','guardian_greaves'];
        for (var i = 0; i < self.items().length; i++) {
            var item = self.items()[i].item;
            var isActive = self.activeItems.indexOf(self.items()[i]) >= 0 ? true : false;
            if (!self.items()[i].enabled()) continue;
            for (var j = 0; j < my.prototype.itemData['item_' + item].attributes.length; j++) {
                var attribute = my.prototype.itemData['item_' + item].attributes[j];
                switch(attribute.name) {
                    case 'bonus_movement_speed':
                        if (!hasBoots && bootItems.indexOf(item) >= 0) {
                            if (item != 'tranquil_boots' || (item == 'tranquil_boots' && !isActive)) {
                                totalAttribute += parseInt(attribute.value[0]);
                                hasBoots = true;
                            }
                        }
                        //else if (!hasEuls && item == 'cyclone') {
                        else if (item == 'cyclone') {
                            totalAttribute += parseInt(attribute.value[0]);
                            hasEuls = true;
                        }
                    break;
                    case 'broken_movement_speed':
                        if (!hasBoots && bootItems.indexOf(item) >= 0) {
                            if (item == 'tranquil_boots' && isActive) {
                                totalAttribute += parseInt(attribute.value[0]);
                                hasBoots = true;
                            }
                        }
                    break;
                    case 'bonus_movement':
                        if (!hasBoots && bootItems.indexOf(item) >= 0) {
                            totalAttribute += parseInt(attribute.value[0]);
                            hasBoots = true;
                        }
                    break;
                    case 'movement_speed':
                        if (!hasWindLace && item == 'wind_lace') {
                            totalAttribute += parseInt(attribute.value[0]);
                            hasWindLace = true;
                        }
                    break;
                }
            }
        }
        return totalAttribute;
    };
    self.getMovementSpeedPercent = function (e) {
        var totalAttribute = 0,
            excludeList = e || [],
            hasYasha = false,
            hasDrums = false,
            hasDrumsActive = false,
            hasPhaseActive = false,
            hasShadowBladeActive = false,
            hasButterflyActive = false,
            hasMoMActive = false,
            yashaItems = ['manta','yasha','sange_and_yasha'];
        for (var i = 0; i < self.items().length; i++) {
            var item = self.items()[i].item;
            var isActive = self.activeItems.indexOf(self.items()[i]) >= 0 ? true : false;
            if (!self.items()[i].enabled()) continue;
            for (var j = 0; j < my.prototype.itemData['item_' + item].attributes.length; j++) {
                var attribute = my.prototype.itemData['item_' + item].attributes[j];
                if (excludeList.indexOf(attribute.name) > -1) continue;
                switch(attribute.name) {
                    case 'movement_speed_percent_bonus':
                        if (!hasYasha && yashaItems.indexOf(item) >= 0) {
                            totalAttribute += parseInt(attribute.value[0]);
                            hasYasha = true;
                        }
                    break;
                    case 'bonus_aura_movement_speed_pct':
                        if (!hasDrums && item == 'ancient_janggo') {
                            totalAttribute += parseInt(attribute.value[0]);
                            hasDrums = true;
                            excludeList.push(attribute.name);
                        }
                    break;
                    case 'phase_movement_speed':
                        if (isActive && !hasPhaseActive) {
                            totalAttribute += parseInt(attribute.value[0]);
                            hasPhaseActive = true;
                        }
                    break;
                    case 'bonus_movement_speed_pct':
                        if (isActive && !hasDrumsActive && item == 'ancient_janggo') {
                            totalAttribute += parseInt(attribute.value[0]);
                            hasDrumsActive = true;
                            excludeList.push(attribute.name);
                        }
                    break;
                    case 'windwalk_movement_speed':
                        if (isActive && !hasShadowBladeActive && (item == 'invis_sword' || item == 'silver_edge')) {
                            totalAttribute += parseInt(attribute.value[0]);
                            hasShadowBladeActive = true;
                        }
                    break;
                    case 'berserk_bonus_movement_speed':
                        if (isActive && !hasMoMActive && item == 'mask_of_madness') {
                            totalAttribute += parseInt(attribute.value[0]);
                            hasMoMActive = true;
                        }
                    break;
                    case 'bonus_movement_speed': //manta
                        if (!hasYasha && item == 'manta') {
                            totalAttribute += parseInt(attribute.value[0]);
                            hasYasha = true;
                        }
                        else if (item == 'smoke_of_deceit' && isActive) {
                            totalAttribute += parseInt(attribute.value[0]);
                        }
                    break;
                    case 'bonus_move_speed':
                        if (isActive && !hasButterflyActive && item == 'butterfly') {
                            totalAttribute += parseInt(attribute.value[0]);
                            hasButterflyActive = true;
                        }
                    break;
                }
            }
        }
        return {value: totalAttribute/100, excludeList: excludeList};
    };
    
    self.getMovementSpeedPercentReduction = function (e) {
        var totalAttribute = 0,
            excludeList = e || [];
        for (var i = 0; i < self.items().length; i++) {
            var item = self.items()[i].item;
            var isActive = self.activeItems.indexOf(self.items()[i]) >= 0 ? true : false;
            if (!self.items()[i].enabled()) continue;
            for (var j = 0; j < my.prototype.itemData['item_' + item].attributes.length; j++) {
                var attribute = my.prototype.itemData['item_' + item].attributes[j];
                if (excludeList.indexOf(attribute.name) > -1) continue;
                switch(attribute.name) {
                    case 'movespeed':
                        if (item == 'dust' && isActive) {
                            totalAttribute += parseInt(attribute.value[0]);
                        }
                    case 'blast_movement_speed':
                        if (item == 'shivas_guard' && isActive) {
                            totalAttribute += parseInt(attribute.value[0]);
                            excludeList.push(attribute.name);
                        }
                    case 'cold_movement_speed':
                        if (item == 'skadi') {
                            totalAttribute += parseInt(attribute.value[0]);
                        }
                    break;
                    case 'maim_movement_speed':
                        if (self.items()[i].debuff && self.items()[i].debuff == 'maim') {
                            totalAttribute += parseInt(attribute.value[0]);
                            excludeList.push(attribute.name);
                        }
                    break;
                }
            }
        }
        return {value: totalAttribute/100, excludeList: excludeList};
    };
    
    self.getBonusDamage = function () {
        var totalAttribute = 0;
        var sources = {};
        for (var i = 0; i < self.items().length; i++) {
            var item = self.items()[i].item;
            var isActive = self.activeItems.indexOf(self.items()[i]) >= 0 ? true : false;
            if (!self.items()[i].enabled()) continue;
            for (var j = 0; j < my.prototype.itemData['item_' + item].attributes.length; j++) {
                var attribute = my.prototype.itemData['item_' + item].attributes[j];
                switch(attribute.name) {
                    case 'bonus_damage':
                        totalAttribute += parseInt(attribute.value[0]);
                        if (sources[item] == undefined) {
                            sources[item] = {
                                'damage': parseInt(attribute.value[0]),
                                'damageType': 'physical',
                                'count':1,
                                'displayname': my.prototype.itemData['item_' + item].displayname
                            }                            
                        }
                        else {
                            sources[item].count += 1;
                        }
                    break;
                    case 'unholy_bonus_damage':
                        if (isActive) {
                            totalAttribute += parseInt(attribute.value[0]);
                            if (sources[item + '_active'] == undefined) {
                                sources[item + '_active'] = {
                                    'damage': parseInt(attribute.value[0]),
                                    'damageType': 'physical',
                                    'count':1,
                                    'displayname': my.prototype.itemData['item_' + item].displayname + ' Unholy Strength'
                                }                            
                            }
                            else {
                                sources[item].count += 1;
                            }
                        }
                    break;
                }
            }
        }
        return { sources: sources, total: totalAttribute };
    };
    self.getBonusDamagePercent = function (s) {
        s = s || {sources:{},total:0};
        var totalAttribute = s.total || 0;
        var sources = s.sources || {};
        for (var i = 0; i < self.items().length; i++) {
            var item = self.items()[i].item;
            var isActive = self.activeItems.indexOf(self.items()[i]) >= 0 ? true : false;
            if (!self.items()[i].enabled()) continue;
            for (var j = 0; j < my.prototype.itemData['item_' + item].attributes.length; j++) {
                var attribute = my.prototype.itemData['item_' + item].attributes[j];
                switch(attribute.name) {
                    case 'damage_aura':
                        if (sources[item] == undefined) {
                            totalAttribute += parseInt(attribute.value[0]) / 100;
                            sources[item] = {
                                'damage': parseInt(attribute.value[0]) / 100,
                                'damageType': 'physical',
                                'count':1,
                                'displayname': my.prototype.itemData['item_' + item].displayname
                            }
                        }
                        // else {
                            // sources[item].count += 1;
                        // }
                    break;
                }
            }
        }
        return { sources: sources, total: totalAttribute };
    };
    self.getAttackSpeed = function (e) {
        var totalAttribute = 0,
            hasPowerTreads = false,
            excludeList = e || [];
        for (var i = 0; i < self.items().length; i++) {
            var item = self.items()[i].item;
            var isActive = self.activeItems.indexOf(self.items()[i]) >= 0 ? true : false;
            if (!self.items()[i].enabled()) continue;
            for (var j = 0; j < my.prototype.itemData['item_' + item].attributes.length; j++) {
                var attribute = my.prototype.itemData['item_' + item].attributes[j];
                if (excludeList.indexOf(attribute.name) > -1) continue;
                switch(attribute.name) {
                    case 'bonus_attack_speed':
                        if (item == 'power_treads') {
                            if (!hasPowerTreads) {
                                totalAttribute += parseInt(attribute.value[0]);
                                hasPowerTreads = true;
                            }
                        }
                        else if (item == 'moon_shard') {
                            if (!isActive) {
                                totalAttribute += parseInt(attribute.value[0]);
                            }
                        }
                        else {
                            totalAttribute += parseInt(attribute.value[0]);
                        }
                    break;
                    case 'consumed_bonus':
                        if (item == 'moon_shard' && isActive) {
                            totalAttribute += parseInt(attribute.value[0]);
                        }
                    break;
                    break;
                    case 'bonus_speed':
                        totalAttribute += parseInt(attribute.value[0]);
                    break;
                    case 'aura_attack_speed':
                        if (item != 'shivas_guard') { totalAttribute += parseInt(attribute.value[0]); };
                    break;
                    // ancient_janggo
                    case 'bonus_aura_attack_speed_pct':
                        totalAttribute += parseInt(attribute.value[0]);
                        excludeList.push(attribute.name);
                    break;
                    // ancient_janggo
                    case 'bonus_attack_speed_pct':
                        if (isActive) {
                            totalAttribute += parseInt(attribute.value[0]);
                            excludeList.push(attribute.name);
                        }
                    break;
                    case 'unholy_bonus_attack_speed':
                        if (isActive) { totalAttribute += parseInt(attribute.value[0]); };
                    break;
                    case 'berserk_bonus_attack_speed':
                        if (isActive) { totalAttribute += parseInt(attribute.value[0]); };
                    break;
                }
            }
        }
        return {value: totalAttribute, excludeList: excludeList};
    };
    self.getAttackSpeedReduction = function (e) {
        var totalAttribute = 0,
            excludeList = e || [];
        for (var i = 0; i < self.items().length; i++) {
            var item = self.items()[i].item;
            var isActive = self.activeItems.indexOf(self.items()[i]) >= 0 ? true : false;
            if (!self.items()[i].enabled()) continue;
            for (var j = 0; j < my.prototype.itemData['item_' + item].attributes.length; j++) {
                var attribute = my.prototype.itemData['item_' + item].attributes[j];
                if (excludeList.indexOf(attribute.name) > -1) continue;
                switch(attribute.name) {
                    case 'aura_attack_speed':
                        if (item == 'shivas_guard') {
                            totalAttribute += parseInt(attribute.value[0]);
                            excludeList.push(attribute.name);
                        }
                    break;
                    case 'cold_attack_speed':
                        if (item == 'skadi') {
                            totalAttribute += parseInt(attribute.value[0]);
                            excludeList.push(attribute.name);
                        }
                    break;
                    case 'maim_attack_speed':
                        if (self.items()[i].debuff && self.items()[i].debuff == 'maim') {
                            totalAttribute += parseInt(attribute.value[0]);
                            excludeList.push(attribute.name);
                        }
                    break;
                }
            }
        }
        return {value: totalAttribute, excludeList: excludeList};
    };
    self.getLifesteal = function () {
        var totalAttribute = 0;
        for (var i = 0; i < self.items().length; i++) {
            var item = self.items()[i].item;
            var isActive = self.activeItems.indexOf(self.items()[i]) >= 0 ? true : false;
            if (!self.items()[i].enabled()) continue;
            for (var j = 0; j < my.prototype.itemData['item_' + item].attributes.length; j++) {
                var attribute = my.prototype.itemData['item_' + item].attributes[j];
                switch(attribute.name) {
                    case 'lifesteal_percent':
                        if (item == 'satanic') {
                            if (!isActive) { return parseInt(attribute.value[0]); };
                        }
                        else {
                            return parseInt(attribute.value[0]);
                        }
                    break;
                    case 'unholy_lifesteal_percent':
                        if (isActive) { return parseInt(attribute.value[0]); };
                    break;
                }
            }
        }
        return totalAttribute;
    };
    self.getLifestealAura = function (e) {
        var totalAttribute = 0,
            excludeList = e || [];
        for (var i = 0; i < self.items().length; i++) {
            var item = self.items()[i].item;
            var isActive = self.activeItems.indexOf(self.items()[i]) >= 0 ? true : false;
            if (!self.items()[i].enabled()) continue;
            for (var j = 0; j < my.prototype.itemData['item_' + item].attributes.length; j++) {
                var attribute = my.prototype.itemData['item_' + item].attributes[j];
                if (excludeList.indexOf(attribute.name) > -1) continue;
                switch(attribute.name) {
                    case 'vampiric_aura':
                        totalAttribute += parseInt(attribute.value[0]);
                        excludeList.push(attribute.name);
                    break;
                }
            }
        }
        return {value: totalAttribute, excludeList: excludeList};
    };
    self.getMagicResist = function () {
        var totalAttribute = 1;
        for (var i = 0; i < self.items().length; i++) {
            var item = self.items()[i].item;
            var isActive = self.activeItems.indexOf(self.items()[i]) >= 0 ? true : false;
            if (!self.items()[i].enabled()) continue;
            for (var j = 0; j < my.prototype.itemData['item_' + item].attributes.length; j++) {
                var attribute = my.prototype.itemData['item_' + item].attributes[j];
                switch(attribute.name) {
                    case 'bonus_magical_armor':
                        totalAttribute *= (1 - parseInt(attribute.value[0]) / 100);
                    break;
                    case 'bonus_spell_resist':
                        totalAttribute *= (1 - parseInt(attribute.value[0]) / 100);
                    break;
                    case 'magic_resistance':
                        totalAttribute *= (1 - parseInt(attribute.value[0]) / 100);
                    break;
                }
            }
        }
        return totalAttribute;
    };
    self.getMagicResistReductionSelf = function () {
        var totalAttribute = 1;
        for (var i = 0; i < self.items().length; i++) {
            var item = self.items()[i].item;
            var isActive = self.activeItems.indexOf(self.items()[i]) >= 0 ? true : false;
            if (!self.items()[i].enabled()) continue;
            if (isActive) {
                for (var j = 0; j < my.prototype.itemData['item_' + item].attributes.length; j++) {
                    var attribute = my.prototype.itemData['item_' + item].attributes[j];
                    switch(attribute.name) {
                        case 'extra_spell_damage_percent':
                        case 'ethereal_damage_bonus':
                            return (1 - parseInt(attribute.value[0]) / 100);
                        break;
                    }
                }
            }
        }
        return totalAttribute;
    };   
    self.getMagicResistReduction = function () {
        var totalAttribute = 1;
        for (var i = 0; i < self.items().length; i++) {
            var item = self.items()[i].item;
            var isActive = self.activeItems.indexOf(self.items()[i]) >= 0 ? true : false;
            if (!self.items()[i].enabled()) continue;
            if (isActive) {
                for (var j = 0; j < my.prototype.itemData['item_' + item].attributes.length; j++) {
                    var attribute = my.prototype.itemData['item_' + item].attributes[j];
                    switch(attribute.name) {
                        case 'ethereal_damage_bonus':
                            if (!self.isEthereal()) totalAttribute *= (1 - parseInt(attribute.value[0]) / 100);
                        case 'resist_debuff':
                            totalAttribute *= (1 - parseInt(attribute.value[0]) / 100);
                        break;
                    }
                }
            }
        }
        return totalAttribute;
    };        

    self.getVisionRangeNight = ko.computed(function () {
        var totalAttribute = 0;
        for (var i = 0; i < self.items().length; i++) {
            var item = self.items()[i].item;
            var isActive = self.activeItems.indexOf(self.items()[i]) >= 0 ? true : false;
            if (!self.items()[i].enabled()) continue;
            for (var j = 0; j < my.prototype.itemData['item_' + item].attributes.length; j++) {
                var attribute = my.prototype.itemData['item_' + item].attributes[j];
                switch(attribute.name) {
                    case 'bonus_night_vision':
                        if (item != 'moon_shard' || !isActive) {
                            totalAttribute += parseInt(attribute.value[0]);
                        }
                    break;
                }
            }
        }
        return totalAttribute;
    });
    
    self.getAttackRange = function (attacktype, aList) {
        var totalAttribute = 0,
            attributeList = aList || [];
        for (var i = 0; i < self.items().length; i++) {
            var item = self.items()[i].item;
            var isActive = self.activeItems.indexOf(self.items()[i]) >= 0 ? true : false;
            if (!self.items()[i].enabled()) continue;
            for (var j = 0;j < my.prototype.itemData['item_' + item].attributes.length; j++) {
                var attribute = my.prototype.itemData['item_' + item].attributes[j];
                if (attributeList.find(function (a) { return attribute.name == a.name; })) continue;
                switch(attribute.name) {
                    // dragon_lance
                    case 'base_attack_range':
                        if (attacktype == 'DOTA_UNIT_CAP_RANGED_ATTACK') attributeList.push({'name':attribute.name, 'value': parseInt(attribute.value[0])});
                    break;
                }
            }
        }
        
        totalAttribute = attributeList.reduce(function (memo, attribute) {
            return memo += attribute.value;
        }, 0);
        return {value: totalAttribute, attributes: attributeList};
    };
    
    self.getMissChance = function (e) {
        var totalAttribute = 1,
            excludeList = e || [];
        for (var i = 0; i < self.items().length; i++) {
            var item = self.items()[i].item;
            var isActive = self.activeItems.indexOf(self.items()[i]) >= 0 ? true : false;
            if (!self.items()[i].enabled()) continue;
            for (var j = 0; j < my.prototype.itemData['item_' + item].attributes.length; j++) {
                var attribute = my.prototype.itemData['item_' + item].attributes[j];
                if (excludeList.indexOf(attribute.name) > -1) continue;
                switch(attribute.name) {
                    case 'miss_chance':
                        totalAttribute *= (1 - parseInt(attribute.value[0]) / 100);
                        excludeList.push(attribute.name);
                    break;
                    case 'blind_pct':
                        totalAttribute *= (1 - parseInt(attribute.value[0]) / 100);
                        excludeList.push(attribute.name);
                    break;
                }
            }
        }
        return {value: totalAttribute, excludeList: excludeList};
    };
    
    self.getBaseDamageReductionPct = function () {
        var totalAttribute = 1;
        for (var i = 0; i < self.items().length; i++) {
            var item = self.items()[i].item;
            var isActive = self.activeItems.indexOf(self.items()[i]) >= 0 ? true : false;
            if (!self.items()[i].enabled()) continue;
            for (var j = 0; j < my.prototype.itemData['item_' + item].attributes.length; j++) {
                var attribute = my.prototype.itemData['item_' + item].attributes[j];
                switch(attribute.name) {
                    case 'backstab_reduction':
                        if (self.items()[i].debuff && self.items()[i].debuff == 'shadow_walk') {
                            totalAttribute *= (1 + parseInt(attribute.value[0]) / 100);
                        }
                    break;
                }
            }
        }
        return totalAttribute;
    };    
    self.getBonusDamageReductionPct = function () {
        var totalAttribute = 1;
        for (var i = 0; i < self.items().length; i++) {
            var item = self.items()[i].item;
            var isActive = self.activeItems.indexOf(self.items()[i]) >= 0 ? true : false;
            if (!self.items()[i].enabled()) continue;
            for (var j = 0; j < my.prototype.itemData['item_' + item].attributes.length; j++) {
                var attribute = my.prototype.itemData['item_' + item].attributes[j];
                switch(attribute.name) {
                    case 'backstab_reduction':
                        if (self.items()[i].debuff && self.items()[i].debuff == 'shadow_walk') {
                            totalAttribute *= (1 + parseInt(attribute.value[0]) / 100);
                        }
                    break;
                }
            }
        }
        return totalAttribute;
    };    
    
    self.itemOptions = ko.observableArray(my.prototype.itemOptionsArr);
    
    self.itemBuffOptions = ko.observableArray(my.prototype.itemBuffOptions);
    self.selectedItemBuff = ko.observable('assault');

    self.itemDebuffOptions = ko.observableArray(my.prototype.itemDebuffOptions);
    self.selectedItemDebuff = ko.observable('assault');
    
    return self;
};
},{"./herocalc_core":47,"./herocalc_knockout":53}],53:[function(require,module,exports){
(function (global){
'use strict';
var ko = (typeof window !== "undefined" ? window['ko'] : typeof global !== "undefined" ? global['ko'] : null);

ko.mapping = require('../lib/knockout.mapping');
ko.wrap = require('../lib/knockout.wrap');

ko.extenders.numeric = function(target, precision) {
    //create a writeable computed observable to intercept writes to our observable
    var result = ko.computed({
        read: target,  //always return the original observables value
        write: function(newValue) {
            var current = target(),
                roundingMultiplier = Math.pow(10, precision),
                newValueAsNum = isNaN(newValue) ? 0 : parseFloat(+newValue),
                valueToWrite = Math.round(newValueAsNum * roundingMultiplier) / roundingMultiplier;
 
            //only write if it changed
            if (valueToWrite !== current) {
                target(valueToWrite);
            } else {
                //if the rounded value is the same, but a different value was written, force a notification for the current field
                if (newValue !== current) {
                    target.notifySubscribers(valueToWrite);
                }
            }
        }
    }).extend({ notify: 'always' });
 
    //initialize with current value to make sure it is rounded appropriately
    result(target());
 
    //return the new computed observable
    return result;
};

module.exports = ko;
}).call(this,typeof global !== "undefined" ? global : typeof self !== "undefined" ? self : typeof window !== "undefined" ? window : {})

},{"../lib/knockout.mapping":61,"../lib/knockout.wrap":62}],54:[function(require,module,exports){
(function (global){
'use strict';
var $ = (typeof window !== "undefined" ? window['$'] : typeof global !== "undefined" ? global['$'] : null);

var ability_vars = {
    '$health': 'Health',
    '$mana': 'Mana',
    '$armor': 'Armor',
    '$damage': 'Damage',
    '$str': 'Strength',
    '$int': 'Intelligence',
    '$agi': 'Agility',
    '$all': 'All Attributes',
    '$attack': 'Attack Speed',
    '$hp_regen': 'HP Regeneration',
    '$mana_regen': 'Mana Regeneration',
    '$move_speed': 'Movement Speed',
    '$evasion': 'Evasion',
    '$spell_resist': 'Spell Resistance',
    '$selected_attribute': 'Selected Attribute',
    '$selected_attrib': 'Selected Attribute',
    '$cast_range': 'Cast Range',
    '$attack_range': 'Attack Range'
}
var abilityTooltipData = {};
var abilityDamageTypes = {
    'DAMAGE_TYPE_MAGICAL': 'Magical',
    'DAMAGE_TYPE_PURE': 'Pure',
    'DAMAGE_TYPE_PHYSICAL': 'Physical',
    'DAMAGE_TYPE_COMPOSITE': 'Composite',
    'DAMAGE_TYPE_HP_REMOVAL': 'HP Removal'
}

var getTooltipAbilityDescription = function (item) {
    var d = item.description;
    for (var i = 0; i < item.attributes.length; i++) {
        if (item.attributes[i].name != null) {
            var attributeName = item.attributes[i].name;
            var attributeValue = item.attributes[i].value[0];
            for (var j = 1; j < item.attributes[i].value.length; j++) {
                attributeValue += ' / ' + item.attributes[i].value[j];
            }
            regexp = new RegExp('%' + attributeName + '%', 'gi');
            d = d.replace(regexp, attributeValue);
        }
    }
    var regexp = new RegExp('%%', 'gi');
    d = d.replace(regexp, '%');
    regexp = new RegExp('\n', 'gi');
    d = d.replace(/\\n/g, '<br>');
    return d;
}

var getTooltipAbilityAttributes = function (item) {
    var a = '';
    if (item.damage.length > 0 && item.damage.reduce(function(memo, num){ return memo + num; }, 0) > 0) {
        var attributeTooltip = 'DAMAGE: ';
        var attributeValue = item.damage[0];
        for (var j = 1; j < item.damage.length; j++) {
            attributeValue += ' / ' + item.damage[j];
        }
        a = a + attributeTooltip + ' ' + attributeValue + '<br>';
    }
    for (var i = 0; i < item.attributes.length; i++) {
        if (item.attributes[i].tooltip != null) {
            var attributeTooltip = item.attributes[i].tooltip;
            attributeTooltip = attributeTooltip.replace(/\\n/g, '');
            var attributeValue = item.attributes[i].value[0];
            for (var j = 1; j < item.attributes[i].value.length; j++) {
                attributeValue += ' / ' + item.attributes[i].value[j];
            }
            var p = attributeTooltip.indexOf('%');
            if (p == 0) {
                if (attributeValue.toString().indexOf('/') == -1) {
                    attributeValue = attributeValue.toString().trim() + '%';
                } else {
                    //var regexp2 = new RegExp('/', 'gi');
                    //attributeValue = attributeValue.replace(regexp2, '%/') + '%';
                    var attributeValues = attributeValue.split('/');
                    var trimmedAttributeValues = attributeValues.map(function(v) {
                        return v.trim();
                    });
                    attributeValue = trimmedAttributeValues.join('% / ') + '%';
                }
                attributeTooltip = attributeTooltip.slice(1);
            }
            var d = attributeTooltip.indexOf('$');
            a = a + attributeTooltip + ' ' + attributeValue + '<br>';
        }
    }
    return a.trim('<br>');
}

var getTooltipAbilityManaCost = function (item) {
    var c = '';
    if (item.manacost.reduce(function(memo, num){ return memo + num; }, 0) == 0) {
        return c;
    }
    if (item.manacost.every(function(num) { return num == item.manacost[0]; })) {
        return item.manacost[0].toString();
    }
    for (var i = 0; i < 4; i++) {
        if (item.manacost[i] != null) {
            c = c + ' ' + item.manacost[i];
        }
    }
    return c;
}

var getTooltipAbilityCooldown = function (item) {
    var c = '';
    if (item.cooldown.reduce(function(memo, num){ return memo + num; }, 0) == 0) {
        return c;
    }
    if (item.cooldown.every(function(num) { return num == item.cooldown[0]; })) {
        return item.cooldown[0].toString();
    }
    for (var i = 0; i < 4; i++) {
        if (item.cooldown[i] != null) {
            c = c + ' ' + item.cooldown[i];
        }
    }
    return c;
}
    
var getAbilityTooltipData = function(heroData, unitData, hero, el) {
    if (abilityTooltipData[el] == undefined) {
        var abilityName = el
        var ability = {};
        if (heroData[hero] == undefined) {
            for (var i = 0; i < unitData[hero].abilities.length; i++) {
                if (unitData[hero].abilities[i].name == el) {
                    ability = unitData[hero].abilities[i];
                }
            }            
        }
        else {
            for (var i = 0; i < heroData[hero].abilities.length; i++) {
                if (heroData[hero].abilities[i].name == el) {
                    ability = heroData[hero].abilities[i];
                }
            }
        }
        var data = $('<div>')
        data.append($('<span>').html(ability.displayname).addClass('item_field pull-left item_name'));
        if (ability.abilityunitdamagetype) {
            data.append($('<span>').html(abilityDamageTypes[ability.abilityunitdamagetype]).addClass('item_field pull-right item_ability_damage_type').css('margin-right','10px'));
        }
        data.append($('<hr>').css('clear', 'both'));
        if (ability.description != null) {
            data.append($('<div>').html(getTooltipAbilityDescription(ability)).addClass('item_field item_description'));
        }
        var attributedata = getTooltipAbilityAttributes(ability);
        if (attributedata != '') {
            data.append($('<div>').html(attributedata).addClass('item_field item_attributes'));
        }
        var cd = getTooltipAbilityCooldown(ability);
        var mana = getTooltipAbilityManaCost(ability);
        if (cd != '' || mana != '') {
            var cdmanacost = $('<div>').addClass('item_cdmana');
            if (mana != '') {
                cdmanacost.append($('<span>').html(mana.trim()).addClass('item_field item_manacost'));
            }
            if (cd != '') {
                cdmanacost.append($('<span>').html(cd.trim()).addClass('item_field item_cooldown'));
            }
            data.append(cdmanacost);
        }
        if (ability.lore != null) {
            data.append($('<div>').html(ability.lore).addClass('item_field item_lore'));
        }
        abilityTooltipData[el] = data.html();
        return data.html();
    }
    else {
        return abilityTooltipData[el];
    }
}

module.exports = getAbilityTooltipData;
}).call(this,typeof global !== "undefined" ? global : typeof self !== "undefined" ? self : typeof window !== "undefined" ? window : {})

},{}],55:[function(require,module,exports){
(function (global){
'use strict';
var $ = (typeof window !== "undefined" ? window['$'] : typeof global !== "undefined" ? global['$'] : null);

var itemtooltipdata = {};
var ability_vars = {
    '$health': 'Health',
    '$mana': 'Mana',
    '$armor': 'Armor',
    '$damage': 'Damage',
    '$str': 'Strength',
    '$int': 'Intelligence',
    '$agi': 'Agility',
    '$all': 'All Attributes',
    '$attack': 'Attack Speed',
    '$hp_regen': 'HP Regeneration',
    '$mana_regen': 'Mana Regeneration',
    '$move_speed': 'Movement Speed',
    '$evasion': 'Evasion',
    '$spell_resist': 'Spell Resistance',
    '$selected_attribute': 'Selected Attribute',
    '$selected_attrib': 'Selected Attribute',
    '$cast_range': 'Cast Range',
    '$attack_range': 'Attack Range'
}

var getTooltipItemDescription = function (item) {
    var d = item.description;
    for (var i = 0; i < item.attributes.length; i++) {
        if (item.attributes[i].name != null) {
            var attributeName = item.attributes[i].name;
            var attributeValue = item.attributes[i].value[0];
            for (var j = 1; j < item.attributes[i].value.length; j++) {
                attributeValue += ' / ' + item.attributes[i].value[j];
            }
            var regexp = new RegExp('%' + attributeName + '%', 'gi');
            d = d.replace(regexp, attributeValue );
        }
    }
    var regexp = new RegExp('%%', 'gi');
    d = d.replace(regexp,'%');
    regexp = new RegExp('\n', 'gi');
    d = d.replace(/\\n/g, '<br>');
    return d;
}

var getTooltipItemAttributes = function (item) {
    var a = '';
    for (var i = 0; i < item.attributes.length; i++) {
        if (item.attributes[i].tooltip != null) {
            var attributeTooltip = item.attributes[i].tooltip;
            var attributeValue = item.attributes[i].value[0];
            for (var j = 1; j < item.attributes[i].value.length; j++) {
                attributeValue += ' / ' + item.attributes[i].value[j];
            }
            var p = attributeTooltip.indexOf('%');
            if (p == 0) {
                attributeValue = attributeValue + '%';
                attributeTooltip = attributeTooltip.slice(1);
            }
            var d = attributeTooltip.indexOf('$');
            if (d != -1) {
                a = a + attributeTooltip.slice(0, d) + ' ' + attributeValue + ' ' + ability_vars[attributeTooltip.slice(d)] + '<br>';
            }
            else {
                a = a + attributeTooltip + ' ' + attributeValue + '<br>';
            }
        }
    }
    return a.trim('<br>');
}

var getTooltipItemCooldown = function (item) {
    var c = '';
    for (var i = 0; i < item.cooldown.length; i++) {
        c = c + ' ' + item.cooldown[i];
    }
    return c;
}

var getTooltipItemManaCost = function (item) {
    var c = '';
    for (var i = 0; i < item.manacost.length; i++) {
        if (item.manacost[i] > 0) {
            c = c + ' ' + item.manacost[i];
        }
    }
    return c;
}

var getItemTooltipData = function(itemData, el) {
    if (itemData['item_' + el] == undefined) {
        return undefined;
    }
    if (itemtooltipdata[el] == undefined) {
        var item = itemData['item_' + el];
        var data = $('<div>');
        data.append($('<span>').html(item.displayname).addClass('item_field item_name'));
        data.append($('<span>').html(item.itemcost).addClass('item_field item_cost'));
        data.append($('<hr>'));
        if (item.description != null) {
            data.append($('<div>').html(getTooltipItemDescription(item)).addClass('item_field item_description'));
        }
        var attributedata = getTooltipItemAttributes(item);
        if (attributedata != '') {
            data.append($('<div>').html(attributedata).addClass('item_field item_attributes'));
        }
        var cd = getTooltipItemCooldown(item);
        var mana = getTooltipItemManaCost(item);
        if (cd != '' || mana != '') {
            var cdmanacost = $('<div>').addClass('item_cdmana');
            if (cd != '') {
                cdmanacost.append($('<span>').html(cd).addClass('item_field item_cooldown'));
            }
            if (mana != '') {
                cdmanacost.append($('<span>').html(mana).addClass('item_field item_manacost'));
            }
            data.append(cdmanacost);
        }
        if (item.lore != null) {
            data.append($('<div>').html(item.lore).addClass('item_field item_lore'));
        }
        itemtooltipdata[el] = data.html();
        return data.html();
    }
    else {
        return itemtooltipdata[el];
    }
}

module.exports = getItemTooltipData;
}).call(this,typeof global !== "undefined" ? global : typeof self !== "undefined" ? self : typeof window !== "undefined" ? window : {})

},{}],56:[function(require,module,exports){
'use strict';
var ko = require('./herocalc_knockout');
    
var my = require("./herocalc_core");

my.prototype.UnitOption = function (name, displayname, levels, image, level) {
    this.heroName = ko.computed(function() {
        return (levels > 0) ? name + (level() <= levels ? level() : 1) : name;
    });
    this.heroDisplayName = displayname;
    this.image = image;
    this.levels = levels;
};

my.prototype.UnitViewModel = function (h,p) {
    var self = new my.prototype.HeroModel(h);
    self.parent = p;
    self.selectedUnitLevel = ko.observable(1);
    self.availableUnits = ko.observableArray([
        new my.prototype.UnitOption('npc_dota_lone_druid_bear', 'Lone Druid Spirit Bear',4,'/media/images/units/spirit_bear.png', self.selectedUnitLevel),
        new my.prototype.UnitOption('npc_dota_brewmaster_earth_','Brewmaster Earth Warrior',3,'/media/images/units/npc_dota_brewmaster_earth.png', self.selectedUnitLevel),
        new my.prototype.UnitOption('npc_dota_brewmaster_fire_','Brewmaster Fire Warrior',3,'/media/images/units/npc_dota_brewmaster_fire.png', self.selectedUnitLevel),
        new my.prototype.UnitOption('npc_dota_brewmaster_storm_','Brewmaster Storm Warrior',3,'/media/images/units/npc_dota_brewmaster_storm.png', self.selectedUnitLevel),
        new my.prototype.UnitOption('npc_dota_necronomicon_archer_','Necronomicon Archer',3,'/media/images/units/npc_dota_necronomicon_archer.png', self.selectedUnitLevel),
        new my.prototype.UnitOption('npc_dota_necronomicon_warrior_','Necronomicon Warrior',3,'/media/images/units/npc_dota_necronomicon_warrior.png', self.selectedUnitLevel),
        new my.prototype.UnitOption('npc_dota_lycan_wolf','Lycan Wolf',4,'/media/images/units/npc_dota_lycan_wolf.png', self.selectedUnitLevel),
        new my.prototype.UnitOption('npc_dota_visage_familiar','Visage Familiar',3,'/media/images/units/npc_dota_visage_familiar.png', self.selectedUnitLevel)
    ]);
    self.selectedUnit = ko.observable(self.availableUnits()[0]);
    self.selectedUnit.subscribe(function(newValue) {
        if (newValue.heroName().indexOf('npc_dota_lone_druid_bear') != -1) {
            self.inventory.hasInventory(true);
            self.inventory.items.removeAll();
            self.inventory.activeItems.removeAll();
        }
        else {
            self.inventory.hasInventory(false);
            self.inventory.items.removeAll();
            self.inventory.activeItems.removeAll();
        }
    });
    self.hero = ko.computed(function() {
        return ko.wrap.fromJS(my.prototype.unitData[self.selectedUnit().heroName()]);
    });
    self.heroData = ko.computed(function() {
        return my.prototype.unitData[self.selectedUnit().heroName()];
    });
    self.getAbilityLevelMax = function(data) {
        if (data.abilitytype == 'DOTA_ABILITY_TYPE_ATTRIBUTES') {
            return 10;
        }
        else if (data.name == 'necronomicon_archer_mana_burn' || data.name == 'necronomicon_archer_aoe'
            || data.name == 'necronomicon_warrior_mana_burn' || data.name == 'necronomicon_warrior_last_will') {
            return 3;
        }
        else if (data.name == 'necronomicon_warrior_sight') {
            return 1;
        }
        else {
            return 4;
        }
    };
    self.ability = ko.computed(function() {
        var a = new my.prototype.AbilityModel(ko.mapping.fromJS(my.prototype.unitData[self.selectedUnit().heroName()].abilities));
        a.hasScepter = self.inventory.hasScepter
        switch (self.selectedUnit().heroName()) {
            case 'npc_dota_necronomicon_archer_1':
            case 'npc_dota_necronomicon_warrior_1':
                a.abilities()[0].level(1);
                a.abilities()[1].level(1);
            break;
            case 'npc_dota_necronomicon_archer_2':
            case 'npc_dota_necronomicon_warrior_2':
                a.abilities()[0].level(2);
                a.abilities()[1].level(2);
            break;
            case 'npc_dota_necronomicon_archer_3':
                a.abilities()[0].level(3);
                a.abilities()[1].level(3);
            break;
            case 'npc_dota_necronomicon_warrior_3':
                a.abilities()[0].level(3);
                a.abilities()[1].level(3);
                a.abilities()[2].level(1);
            break;
        }
        a.levelUpAbility = function(index, data, event, hero) {
            switch (a.abilities()[index()].name) {
                case 'necronomicon_archer_mana_burn':
                case 'necronomicon_archer_aoe':
                case 'necronomicon_warrior_mana_burn':
                case 'necronomicon_warrior_last_will':
                case 'necronomicon_warrior_sight':
                break;
                default:
                    if (a.abilities()[index()].level() < hero.getAbilityLevelMax(data)) {
                        a.abilities()[index()].level(a.abilities()[index()].level()+1);
                    }                    
                break;
            }

        };
        a.levelDownAbility = function(index, data, event, hero) {            
            switch (a.abilities()[index()].name) {
                case 'necronomicon_archer_mana_burn':
                case 'necronomicon_archer_aoe':
                case 'necronomicon_warrior_mana_burn':
                case 'necronomicon_warrior_last_will':
                case 'necronomicon_warrior_sight':
                break;
                default:
                    if (a.abilities()[index()].level()>0) {
                        a.abilities()[index()].level(a.abilities()[index()].level()-1);
                    }
                break;
            }
        };
        return a;
    });        
    self.primaryAttribute = ko.computed(function() {
        //var v = my.prototype.unitData[self.selectedUnit().heroName()].attributeprimary;
        var v = 0;
        if (v == 'DOTA_ATTRIBUTE_AGILITY') {
            return 'agi'
        }
        else if (v == 'DOTA_ATTRIBUTE_INTELLECT') {
            return 'int'
        }
        else if (v == 'DOTA_ATTRIBUTE_STRENGTH') {
            return 'str'
        }
        else {
            return ''
        }
    });
    self.totalAttribute = function(a) {
        if (a == 'agi') {
            return parseFloat(self.totalAgi());
        }
        if (a == 'int') {
            return parseFloat(self.totalInt());
        }
        if (a == 'str') {
            return parseFloat(self.totalStr());
        }
        return 0;
    };
    self.totalAgi = ko.computed(function() {
        return (my.prototype.unitData[self.selectedUnit().heroName()].attributebaseagility
                + my.prototype.unitData[self.selectedUnit().heroName()].attributeagilitygain * (self.selectedHeroLevel() - 1) 
                //+ self.inventory.getAttributes('agi') 
                + self.ability().getAttributeBonusLevel()*2
                + self.ability().getAgility()
                + self.enemy().ability().getAllStatsReduction()
                + self.debuffs.getAllStatsReduction()
               ).toFixed(2);
    });
    self.totalInt = ko.computed(function() {
        return (my.prototype.unitData[self.selectedUnit().heroName()].attributebaseintelligence 
                + my.prototype.unitData[self.selectedUnit().heroName()].attributeintelligencegain * (self.selectedHeroLevel() - 1) 
                //+ self.inventory.getAttributes('int') 
                + self.ability().getAttributeBonusLevel()*2
                + self.ability().getIntelligence()
                + self.enemy().ability().getAllStatsReduction()
                + self.debuffs.getAllStatsReduction()
               ).toFixed(2);
    });
    self.totalStr = ko.computed(function() {
        return (my.prototype.unitData[self.selectedUnit().heroName()].attributebasestrength 
                + my.prototype.unitData[self.selectedUnit().heroName()].attributestrengthgain * (self.selectedHeroLevel() - 1) 
                //+ self.inventory.getAttributes('str') 
                + self.ability().getAttributeBonusLevel()*2
                + self.ability().getStrength()
                + self.enemy().ability().getAllStatsReduction()
                + self.debuffs.getAllStatsReduction()
               ).toFixed(2);
    });
    /*self.health = ko.computed(function() {
        return (my.prototype.unitData[self.selectedUnit().heroName()].statushealth + self.totalStr()*19 
                + self.inventory.getHealth()
                + self.ability().getHealth()).toFixed(2);
    });
    self.healthregen = ko.computed(function() {
        return (my.prototype.unitData[self.selectedUnit().heroName()].statushealthregen + self.totalStr()*.03 
                + self.inventory.getHealthRegen() 
                + self.ability().getHealthRegen()
                + self.buffs.getHealthRegen()).toFixed(2);
    });
    self.mana = ko.computed(function() {
        return (my.prototype.unitData[self.selectedUnit().heroName()].statusmana + self.totalInt()*13 + self.inventory.getMana()).toFixed(2);
    });
    self.manaregen = ko.computed(function() {
        return ((my.prototype.unitData[self.selectedUnit().heroName()].statusmanaregen 
                + self.totalInt()*.04 
                + self.ability().getManaRegen()) 
                * (1 + self.inventory.getManaRegenPercent()) 
                + (self.selectedHero().heroName == 'crystal_maiden' ? self.ability().getManaRegenArcaneAura() * 2 : self.buffs.getManaRegenArcaneAura())
                + self.inventory.getManaRegenBloodstone()
                - self.enemy().ability().getManaRegenReduction()).toFixed(2);
    });
    self.totalArmorPhysical = ko.computed(function() {
        return (self.enemy().ability().getArmorBaseReduction() * self.debuffs.getArmorBaseReduction() * (my.prototype.unitData[self.selectedUnit().heroName()].armorphysical + self.totalAgi()*.14)
                + self.inventory.getArmor() + self.ability().getArmor() + self.enemy().ability().getArmorReduction() + self.buffs.getArmor() + self.debuffs.getArmorReduction()).toFixed(2);
    });
    self.totalArmorPhysicalReduction = ko.computed(function() {
        return ((0.06 * self.totalArmorPhysical()) / (1 + 0.06 * self.totalArmorPhysical()) * 100).toFixed(2);
    });
    self.totalMovementSpeed = ko.computed(function() {
        if (self.parent.ability().isShapeShiftActive()) {
            return 522;
        }
        var ms = (self.ability().setMovementSpeed() > 0 ? self.ability().setMovementSpeed() : self.buffs.setMovementSpeed());
        if (ms > 0) {
            return ms;
        }
        else {
            return ((my.prototype.unitData[self.selectedUnit().heroName()].movementspeed + self.inventory.getMovementSpeedFlat()+ self.ability().getMovementSpeedFlat()) * 
                    (1 + self.inventory.getMovementSpeedPercent() 
                       + self.ability().getMovementSpeedPercent() 
                       + self.enemy().inventory.getMovementSpeedPercentReduction() 
                       + self.enemy().ability().getMovementSpeedPercentReduction() 
                       + self.buffs.getMovementSpeedPercent() 
                       + self.debuffs.getMovementSpeedPercentReduction()
                    )).toFixed(2);
        }
    });
    self.totalTurnRate = ko.computed(function() {
        return (my.prototype.unitData[self.selectedUnit().heroName()].movementturnrate 
                * (1 + self.enemy().ability().getTurnRateReduction()
                     + self.debuffs.getTurnRateReduction())).toFixed(2);
    });
    */
    self.baseDamage = ko.computed(function() {
        return [Math.floor(my.prototype.unitData[self.selectedUnit().heroName()].attackdamagemin + self.totalAttribute(self.primaryAttribute()) + self.ability().getBaseDamage().total),
                Math.floor(my.prototype.unitData[self.selectedUnit().heroName()].attackdamagemax + self.totalAttribute(self.primaryAttribute()) + self.ability().getBaseDamage().total)];
    });
    /*self.bonusDamage = ko.computed(function() {
        return self.inventory.getBonusDamage().total
                + self.ability().getBonusDamage().total
                + self.buffs.getBonusDamage().total
                + Math.floor((self.baseDamage()[0] + self.baseDamage()[1])/2 
                              * (self.inventory.getBonusDamagePercent().total
                                 + self.ability().getBonusDamagePercent().total
                                 + self.buffs.getBonusDamagePercent().total
                                )
                            )
                + Math.floor(
                    (self.hero().attacktype() == 'DOTA_UNIT_CAP_RANGED_ATTACK' 
                        ? ((self.selectedHero().heroName == 'drow_ranger') ? self.ability().getBonusDamagePrecisionAura().total[0] * self.totalAgi() : self.buffs.getBonusDamagePrecisionAura().total[1])
                        : 0)
                  );
    });*/
    /*self.bonusDamageReduction = ko.computed(function() {
        return Math.abs(self.enemy().ability().getBonusDamageReduction() + self.debuffs.getBonusDamageReduction());
    });
    self.damage = ko.computed(function() {
        return [self.baseDamage()[0] + self.bonusDamage()[0],
                self.baseDamage()[1] + self.bonusDamage()[1]];
    });*/
    self.totalMagicResistanceProduct = ko.computed(function() {
        return (1 - my.prototype.unitData[self.selectedUnit().heroName()].magicalresistance / 100) 
                   * (1 - self.inventory.getMagicResist() / 100) 
                   * (1 - self.ability().getMagicResist() / 100) 
                   * (1 - self.buffs.getMagicResist() / 100) 
                   * self.enemy().inventory.getMagicResistReduction()
                   * self.enemy().ability().getMagicResistReduction() 
                   * self.debuffs.getMagicResistReduction();
    });
    self.totalMagicResistance = ko.computed(function() {
        return (1 - self.totalMagicResistanceProduct());
    });
    self.bat = ko.computed(function() {
        var abilityBAT = self.ability().getBAT();
        if (abilityBAT > 0) {
            return abilityBAT;
        }
        return my.prototype.unitData[self.selectedUnit().heroName()].attackrate;
    });
    /*
    self.ias = ko.computed(function() {
        var val = parseFloat(self.totalAgi()) 
                + self.inventory.getAttackSpeed() 
                + self.ability().getAttackSpeed() 
                + self.enemy().ability().getAttackSpeedReduction() 
                + self.buffs.getAttackSpeed() 
                + self.debuffs.getAttackSpeedReduction();
        if (val < -80) {
            return -80;
        }
        else if (val > 400) {
            return 400;
        }
        return (val).toFixed(2);
    });*/
    self.attackTime = ko.computed(function() {
        return (self.bat() / (1 + self.ias() / 100)).toFixed(2);
    });
    self.attacksPerSecond = ko.computed(function() {
        return (1 + self.ias() / 100) / self.bat();
    });
    self.evasion = ko.computed(function() {
        var e = self.ability().setEvasion();
        if (e) {
            return (e * 100).toFixed(2) + '%';
        }
        else {
            return ((1-(self.inventory.getEvasion() * self.ability().getEvasion())) * 100).toFixed(2) + '%';
        }
    });
    self.ehpPhysical = ko.computed(function() {
        return ((self.health() * (1 + .06 * self.totalArmorPhysical())) / (1-(1-(self.inventory.getEvasion() * self.ability().getEvasion())))).toFixed(2);
    });
    self.ehpMagical = ko.computed(function() {
        return (self.health() / self.totalMagicResistanceProduct()).toFixed(2);
    });
    
    return self;
}
},{"./herocalc_core":47,"./herocalc_knockout":53}],57:[function(require,module,exports){
'use strict';

var core = require("./herocalc_core");
require("./herocalc_inventory");
require("./herocalc_abilitydata");
require("./herocalc_abilities");
require("./herocalc_buffs");
require("./herocalc_hero");
require("./herocalc_hero.illusion");
require("./herocalc_hero.meepo");
require("./herocalc_unit");

module.exports = core;
},{"./herocalc_abilities":44,"./herocalc_abilitydata":45,"./herocalc_buffs":46,"./herocalc_core":47,"./herocalc_hero":49,"./herocalc_hero.illusion":48,"./herocalc_hero.meepo":50,"./herocalc_inventory":52,"./herocalc_unit":56}],58:[function(require,module,exports){
if (!Array.prototype.find) {
  Array.prototype.find = function(predicate) {
    'use strict';
    if (this == null) {
      throw new TypeError('Array.prototype.find called on null or undefined');
    }
    if (typeof predicate !== 'function') {
      throw new TypeError('predicate must be a function');
    }
    var list = Object(this);
    var length = list.length >>> 0;
    var thisArg = arguments[1];
    var value;

    for (var i = 0; i < length; i++) {
      value = list[i];
      if (predicate.call(thisArg, value, i, list)) {
        return value;
      }
    }
    return undefined;
  };
}
},{}],59:[function(require,module,exports){
/*!
 * Chart.js
 * http://chartjs.org/
 * Version: 1.0.1
 *
 * Copyright 2015 Nick Downie
 * Released under the MIT license
 * https://github.com/nnnick/Chart.js/blob/master/LICENSE.md
 */
(function(){"use strict";var t=this,i=t.Chart,e=function(t){this.canvas=t.canvas,this.ctx=t;this.width=t.canvas.width,this.height=t.canvas.height;return this.aspectRatio=this.width/this.height,s.retinaScale(this),this};e.defaults={global:{animation:!0,animationSteps:60,animationEasing:"easeOutQuart",showScale:!0,scaleOverride:!1,scaleSteps:null,scaleStepWidth:null,scaleStartValue:null,scaleLineColor:"rgba(0,0,0,.1)",scaleLineWidth:1,scaleShowLabels:!0,scaleLabel:"<%=value%>",scaleIntegersOnly:!0,scaleBeginAtZero:!1,scaleFontFamily:"'Helvetica Neue', 'Helvetica', 'Arial', sans-serif",scaleFontSize:12,scaleFontStyle:"normal",scaleFontColor:"#666",responsive:!1,maintainAspectRatio:!0,showTooltips:!0,customTooltips:!1,tooltipEvents:["mousemove","touchstart","touchmove","mouseout"],tooltipFillColor:"rgba(0,0,0,0.8)",tooltipFontFamily:"'Helvetica Neue', 'Helvetica', 'Arial', sans-serif",tooltipFontSize:14,tooltipFontStyle:"normal",tooltipFontColor:"#fff",tooltipTitleFontFamily:"'Helvetica Neue', 'Helvetica', 'Arial', sans-serif",tooltipTitleFontSize:14,tooltipTitleFontStyle:"bold",tooltipTitleFontColor:"#fff",tooltipYPadding:6,tooltipXPadding:6,tooltipCaretSize:8,tooltipCornerRadius:6,tooltipXOffset:10,tooltipTemplate:"<%if (label){%><%=label%>: <%}%><%= value %>",multiTooltipTemplate:"<%= value %>",multiTooltipKeyBackground:"#fff",onAnimationProgress:function(){},onAnimationComplete:function(){}}},e.types={};var s=e.helpers={},n=s.each=function(t,i,e){var s=Array.prototype.slice.call(arguments,3);if(t)if(t.length===+t.length){var n;for(n=0;n<t.length;n++)i.apply(e,[t[n],n].concat(s))}else for(var o in t)i.apply(e,[t[o],o].concat(s))},o=s.clone=function(t){var i={};return n(t,function(e,s){t.hasOwnProperty(s)&&(i[s]=e)}),i},a=s.extend=function(t){return n(Array.prototype.slice.call(arguments,1),function(i){n(i,function(e,s){i.hasOwnProperty(s)&&(t[s]=e)})}),t},h=s.merge=function(){var t=Array.prototype.slice.call(arguments,0);return t.unshift({}),a.apply(null,t)},l=s.indexOf=function(t,i){if(Array.prototype.indexOf)return t.indexOf(i);for(var e=0;e<t.length;e++)if(t[e]===i)return e;return-1},r=(s.where=function(t,i){var e=[];return s.each(t,function(t){i(t)&&e.push(t)}),e},s.findNextWhere=function(t,i,e){e||(e=-1);for(var s=e+1;s<t.length;s++){var n=t[s];if(i(n))return n}},s.findPreviousWhere=function(t,i,e){e||(e=t.length);for(var s=e-1;s>=0;s--){var n=t[s];if(i(n))return n}},s.inherits=function(t){var i=this,e=t&&t.hasOwnProperty("constructor")?t.constructor:function(){return i.apply(this,arguments)},s=function(){this.constructor=e};return s.prototype=i.prototype,e.prototype=new s,e.extend=r,t&&a(e.prototype,t),e.__super__=i.prototype,e}),c=s.noop=function(){},u=s.uid=function(){var t=0;return function(){return"chart-"+t++}}(),d=s.warn=function(t){window.console&&"function"==typeof window.console.warn&&console.warn(t)},p=s.amd="function"==typeof define&&define.amd,f=s.isNumber=function(t){return!isNaN(parseFloat(t))&&isFinite(t)},g=s.max=function(t){return Math.max.apply(Math,t)},m=s.min=function(t){return Math.min.apply(Math,t)},v=(s.cap=function(t,i,e){if(f(i)){if(t>i)return i}else if(f(e)&&e>t)return e;return t},s.getDecimalPlaces=function(t){return t%1!==0&&f(t)?t.toString().split(".")[1].length:0}),S=s.radians=function(t){return t*(Math.PI/180)},x=(s.getAngleFromPoint=function(t,i){var e=i.x-t.x,s=i.y-t.y,n=Math.sqrt(e*e+s*s),o=2*Math.PI+Math.atan2(s,e);return 0>e&&0>s&&(o+=2*Math.PI),{angle:o,distance:n}},s.aliasPixel=function(t){return t%2===0?0:.5}),y=(s.splineCurve=function(t,i,e,s){var n=Math.sqrt(Math.pow(i.x-t.x,2)+Math.pow(i.y-t.y,2)),o=Math.sqrt(Math.pow(e.x-i.x,2)+Math.pow(e.y-i.y,2)),a=s*n/(n+o),h=s*o/(n+o);return{inner:{x:i.x-a*(e.x-t.x),y:i.y-a*(e.y-t.y)},outer:{x:i.x+h*(e.x-t.x),y:i.y+h*(e.y-t.y)}}},s.calculateOrderOfMagnitude=function(t){return Math.floor(Math.log(t)/Math.LN10)}),C=(s.calculateScaleRange=function(t,i,e,s,n){var o=2,a=Math.floor(i/(1.5*e)),h=o>=a,l=g(t),r=m(t);l===r&&(l+=.5,r>=.5&&!s?r-=.5:l+=.5);for(var c=Math.abs(l-r),u=y(c),d=Math.ceil(l/(1*Math.pow(10,u)))*Math.pow(10,u),p=s?0:Math.floor(r/(1*Math.pow(10,u)))*Math.pow(10,u),f=d-p,v=Math.pow(10,u),S=Math.round(f/v);(S>a||a>2*S)&&!h;)if(S>a)v*=2,S=Math.round(f/v),S%1!==0&&(h=!0);else if(n&&u>=0){if(v/2%1!==0)break;v/=2,S=Math.round(f/v)}else v/=2,S=Math.round(f/v);return h&&(S=o,v=f/S),{steps:S,stepValue:v,min:p,max:p+S*v}},s.template=function(t,i){function e(t,i){var e=/\W/.test(t)?new Function("obj","var p=[],print=function(){p.push.apply(p,arguments);};with(obj){p.push('"+t.replace(/[\r\t\n]/g," ").split("<%").join("	").replace(/((^|%>)[^\t]*)'/g,"$1\r").replace(/\t=(.*?)%>/g,"',$1,'").split("	").join("');").split("%>").join("p.push('").split("\r").join("\\'")+"');}return p.join('');"):s[t]=s[t];return i?e(i):e}if(t instanceof Function)return t(i);var s={};return e(t,i)}),w=(s.generateLabels=function(t,i,e,s){var o=new Array(i);return labelTemplateString&&n(o,function(i,n){o[n]=C(t,{value:e+s*(n+1)})}),o},s.easingEffects={linear:function(t){return t},easeInQuad:function(t){return t*t},easeOutQuad:function(t){return-1*t*(t-2)},easeInOutQuad:function(t){return(t/=.5)<1?.5*t*t:-0.5*(--t*(t-2)-1)},easeInCubic:function(t){return t*t*t},easeOutCubic:function(t){return 1*((t=t/1-1)*t*t+1)},easeInOutCubic:function(t){return(t/=.5)<1?.5*t*t*t:.5*((t-=2)*t*t+2)},easeInQuart:function(t){return t*t*t*t},easeOutQuart:function(t){return-1*((t=t/1-1)*t*t*t-1)},easeInOutQuart:function(t){return(t/=.5)<1?.5*t*t*t*t:-0.5*((t-=2)*t*t*t-2)},easeInQuint:function(t){return 1*(t/=1)*t*t*t*t},easeOutQuint:function(t){return 1*((t=t/1-1)*t*t*t*t+1)},easeInOutQuint:function(t){return(t/=.5)<1?.5*t*t*t*t*t:.5*((t-=2)*t*t*t*t+2)},easeInSine:function(t){return-1*Math.cos(t/1*(Math.PI/2))+1},easeOutSine:function(t){return 1*Math.sin(t/1*(Math.PI/2))},easeInOutSine:function(t){return-0.5*(Math.cos(Math.PI*t/1)-1)},easeInExpo:function(t){return 0===t?1:1*Math.pow(2,10*(t/1-1))},easeOutExpo:function(t){return 1===t?1:1*(-Math.pow(2,-10*t/1)+1)},easeInOutExpo:function(t){return 0===t?0:1===t?1:(t/=.5)<1?.5*Math.pow(2,10*(t-1)):.5*(-Math.pow(2,-10*--t)+2)},easeInCirc:function(t){return t>=1?t:-1*(Math.sqrt(1-(t/=1)*t)-1)},easeOutCirc:function(t){return 1*Math.sqrt(1-(t=t/1-1)*t)},easeInOutCirc:function(t){return(t/=.5)<1?-0.5*(Math.sqrt(1-t*t)-1):.5*(Math.sqrt(1-(t-=2)*t)+1)},easeInElastic:function(t){var i=1.70158,e=0,s=1;return 0===t?0:1==(t/=1)?1:(e||(e=.3),s<Math.abs(1)?(s=1,i=e/4):i=e/(2*Math.PI)*Math.asin(1/s),-(s*Math.pow(2,10*(t-=1))*Math.sin(2*(1*t-i)*Math.PI/e)))},easeOutElastic:function(t){var i=1.70158,e=0,s=1;return 0===t?0:1==(t/=1)?1:(e||(e=.3),s<Math.abs(1)?(s=1,i=e/4):i=e/(2*Math.PI)*Math.asin(1/s),s*Math.pow(2,-10*t)*Math.sin(2*(1*t-i)*Math.PI/e)+1)},easeInOutElastic:function(t){var i=1.70158,e=0,s=1;return 0===t?0:2==(t/=.5)?1:(e||(e=.3*1.5),s<Math.abs(1)?(s=1,i=e/4):i=e/(2*Math.PI)*Math.asin(1/s),1>t?-.5*s*Math.pow(2,10*(t-=1))*Math.sin(2*(1*t-i)*Math.PI/e):s*Math.pow(2,-10*(t-=1))*Math.sin(2*(1*t-i)*Math.PI/e)*.5+1)},easeInBack:function(t){var i=1.70158;return 1*(t/=1)*t*((i+1)*t-i)},easeOutBack:function(t){var i=1.70158;return 1*((t=t/1-1)*t*((i+1)*t+i)+1)},easeInOutBack:function(t){var i=1.70158;return(t/=.5)<1?.5*t*t*(((i*=1.525)+1)*t-i):.5*((t-=2)*t*(((i*=1.525)+1)*t+i)+2)},easeInBounce:function(t){return 1-w.easeOutBounce(1-t)},easeOutBounce:function(t){return(t/=1)<1/2.75?7.5625*t*t:2/2.75>t?1*(7.5625*(t-=1.5/2.75)*t+.75):2.5/2.75>t?1*(7.5625*(t-=2.25/2.75)*t+.9375):1*(7.5625*(t-=2.625/2.75)*t+.984375)},easeInOutBounce:function(t){return.5>t?.5*w.easeInBounce(2*t):.5*w.easeOutBounce(2*t-1)+.5}}),b=s.requestAnimFrame=function(){return window.requestAnimationFrame||window.webkitRequestAnimationFrame||window.mozRequestAnimationFrame||window.oRequestAnimationFrame||window.msRequestAnimationFrame||function(t){return window.setTimeout(t,1e3/60)}}(),P=(s.cancelAnimFrame=function(){return window.cancelAnimationFrame||window.webkitCancelAnimationFrame||window.mozCancelAnimationFrame||window.oCancelAnimationFrame||window.msCancelAnimationFrame||function(t){return window.clearTimeout(t,1e3/60)}}(),s.animationLoop=function(t,i,e,s,n,o){var a=0,h=w[e]||w.linear,l=function(){a++;var e=a/i,r=h(e);t.call(o,r,e,a),s.call(o,r,e),i>a?o.animationFrame=b(l):n.apply(o)};b(l)},s.getRelativePosition=function(t){var i,e,s=t.originalEvent||t,n=t.currentTarget||t.srcElement,o=n.getBoundingClientRect();return s.touches?(i=s.touches[0].clientX-o.left,e=s.touches[0].clientY-o.top):(i=s.clientX-o.left,e=s.clientY-o.top),{x:i,y:e}},s.addEvent=function(t,i,e){t.addEventListener?t.addEventListener(i,e):t.attachEvent?t.attachEvent("on"+i,e):t["on"+i]=e}),L=s.removeEvent=function(t,i,e){t.removeEventListener?t.removeEventListener(i,e,!1):t.detachEvent?t.detachEvent("on"+i,e):t["on"+i]=c},k=(s.bindEvents=function(t,i,e){t.events||(t.events={}),n(i,function(i){t.events[i]=function(){e.apply(t,arguments)},P(t.chart.canvas,i,t.events[i])})},s.unbindEvents=function(t,i){n(i,function(i,e){L(t.chart.canvas,e,i)})}),F=s.getMaximumWidth=function(t){var i=t.parentNode;return i.clientWidth},R=s.getMaximumHeight=function(t){var i=t.parentNode;return i.clientHeight},T=(s.getMaximumSize=s.getMaximumWidth,s.retinaScale=function(t){var i=t.ctx,e=t.canvas.width,s=t.canvas.height;window.devicePixelRatio&&(i.canvas.style.width=e+"px",i.canvas.style.height=s+"px",i.canvas.height=s*window.devicePixelRatio,i.canvas.width=e*window.devicePixelRatio,i.scale(window.devicePixelRatio,window.devicePixelRatio))}),A=s.clear=function(t){t.ctx.clearRect(0,0,t.width,t.height)},M=s.fontString=function(t,i,e){return i+" "+t+"px "+e},W=s.longestText=function(t,i,e){t.font=i;var s=0;return n(e,function(i){var e=t.measureText(i).width;s=e>s?e:s}),s},z=s.drawRoundedRectangle=function(t,i,e,s,n,o){t.beginPath(),t.moveTo(i+o,e),t.lineTo(i+s-o,e),t.quadraticCurveTo(i+s,e,i+s,e+o),t.lineTo(i+s,e+n-o),t.quadraticCurveTo(i+s,e+n,i+s-o,e+n),t.lineTo(i+o,e+n),t.quadraticCurveTo(i,e+n,i,e+n-o),t.lineTo(i,e+o),t.quadraticCurveTo(i,e,i+o,e),t.closePath()};e.instances={},e.Type=function(t,i,s){this.options=i,this.chart=s,this.id=u(),e.instances[this.id]=this,i.responsive&&this.resize(),this.initialize.call(this,t)},a(e.Type.prototype,{initialize:function(){return this},clear:function(){return A(this.chart),this},stop:function(){return s.cancelAnimFrame.call(t,this.animationFrame),this},resize:function(t){this.stop();var i=this.chart.canvas,e=F(this.chart.canvas),s=this.options.maintainAspectRatio?e/this.chart.aspectRatio:R(this.chart.canvas);return i.width=this.chart.width=e,i.height=this.chart.height=s,T(this.chart),"function"==typeof t&&t.apply(this,Array.prototype.slice.call(arguments,1)),this},reflow:c,render:function(t){return t&&this.reflow(),this.options.animation&&!t?s.animationLoop(this.draw,this.options.animationSteps,this.options.animationEasing,this.options.onAnimationProgress,this.options.onAnimationComplete,this):(this.draw(),this.options.onAnimationComplete.call(this)),this},generateLegend:function(){return C(this.options.legendTemplate,this)},destroy:function(){this.clear(),k(this,this.events);var t=this.chart.canvas;t.width=this.chart.width,t.height=this.chart.height,t.style.removeProperty?(t.style.removeProperty("width"),t.style.removeProperty("height")):(t.style.removeAttribute("width"),t.style.removeAttribute("height")),delete e.instances[this.id]},showTooltip:function(t,i){"undefined"==typeof this.activeElements&&(this.activeElements=[]);var o=function(t){var i=!1;return t.length!==this.activeElements.length?i=!0:(n(t,function(t,e){t!==this.activeElements[e]&&(i=!0)},this),i)}.call(this,t);if(o||i){if(this.activeElements=t,this.draw(),this.options.customTooltips&&this.options.customTooltips(!1),t.length>0)if(this.datasets&&this.datasets.length>1){for(var a,h,r=this.datasets.length-1;r>=0&&(a=this.datasets[r].points||this.datasets[r].bars||this.datasets[r].segments,h=l(a,t[0]),-1===h);r--);var c=[],u=[],d=function(){var t,i,e,n,o,a=[],l=[],r=[];return s.each(this.datasets,function(i){t=i.points||i.bars||i.segments,t[h]&&t[h].hasValue()&&a.push(t[h])}),s.each(a,function(t){l.push(t.x),r.push(t.y),c.push(s.template(this.options.multiTooltipTemplate,t)),u.push({fill:t._saved.fillColor||t.fillColor,stroke:t._saved.strokeColor||t.strokeColor})},this),o=m(r),e=g(r),n=m(l),i=g(l),{x:n>this.chart.width/2?n:i,y:(o+e)/2}}.call(this,h);new e.MultiTooltip({x:d.x,y:d.y,xPadding:this.options.tooltipXPadding,yPadding:this.options.tooltipYPadding,xOffset:this.options.tooltipXOffset,fillColor:this.options.tooltipFillColor,textColor:this.options.tooltipFontColor,fontFamily:this.options.tooltipFontFamily,fontStyle:this.options.tooltipFontStyle,fontSize:this.options.tooltipFontSize,titleTextColor:this.options.tooltipTitleFontColor,titleFontFamily:this.options.tooltipTitleFontFamily,titleFontStyle:this.options.tooltipTitleFontStyle,titleFontSize:this.options.tooltipTitleFontSize,cornerRadius:this.options.tooltipCornerRadius,labels:c,legendColors:u,legendColorBackground:this.options.multiTooltipKeyBackground,title:t[0].label,chart:this.chart,ctx:this.chart.ctx,custom:this.options.customTooltips}).draw()}else n(t,function(t){var i=t.tooltipPosition();new e.Tooltip({x:Math.round(i.x),y:Math.round(i.y),xPadding:this.options.tooltipXPadding,yPadding:this.options.tooltipYPadding,fillColor:this.options.tooltipFillColor,textColor:this.options.tooltipFontColor,fontFamily:this.options.tooltipFontFamily,fontStyle:this.options.tooltipFontStyle,fontSize:this.options.tooltipFontSize,caretHeight:this.options.tooltipCaretSize,cornerRadius:this.options.tooltipCornerRadius,text:C(this.options.tooltipTemplate,t),chart:this.chart,custom:this.options.customTooltips}).draw()},this);return this}},toBase64Image:function(){return this.chart.canvas.toDataURL.apply(this.chart.canvas,arguments)}}),e.Type.extend=function(t){var i=this,s=function(){return i.apply(this,arguments)};if(s.prototype=o(i.prototype),a(s.prototype,t),s.extend=e.Type.extend,t.name||i.prototype.name){var n=t.name||i.prototype.name,l=e.defaults[i.prototype.name]?o(e.defaults[i.prototype.name]):{};e.defaults[n]=a(l,t.defaults),e.types[n]=s,e.prototype[n]=function(t,i){var o=h(e.defaults.global,e.defaults[n],i||{});return new s(t,o,this)}}else d("Name not provided for this chart, so it hasn't been registered");return i},e.Element=function(t){a(this,t),this.initialize.apply(this,arguments),this.save()},a(e.Element.prototype,{initialize:function(){},restore:function(t){return t?n(t,function(t){this[t]=this._saved[t]},this):a(this,this._saved),this},save:function(){return this._saved=o(this),delete this._saved._saved,this},update:function(t){return n(t,function(t,i){this._saved[i]=this[i],this[i]=t},this),this},transition:function(t,i){return n(t,function(t,e){this[e]=(t-this._saved[e])*i+this._saved[e]},this),this},tooltipPosition:function(){return{x:this.x,y:this.y}},hasValue:function(){return f(this.value)}}),e.Element.extend=r,e.Point=e.Element.extend({display:!0,inRange:function(t,i){var e=this.hitDetectionRadius+this.radius;return Math.pow(t-this.x,2)+Math.pow(i-this.y,2)<Math.pow(e,2)},draw:function(){if(this.display){var t=this.ctx;t.beginPath(),t.arc(this.x,this.y,this.radius,0,2*Math.PI),t.closePath(),t.strokeStyle=this.strokeColor,t.lineWidth=this.strokeWidth,t.fillStyle=this.fillColor,t.fill(),t.stroke()}}}),e.Arc=e.Element.extend({inRange:function(t,i){var e=s.getAngleFromPoint(this,{x:t,y:i}),n=e.angle>=this.startAngle&&e.angle<=this.endAngle,o=e.distance>=this.innerRadius&&e.distance<=this.outerRadius;return n&&o},tooltipPosition:function(){var t=this.startAngle+(this.endAngle-this.startAngle)/2,i=(this.outerRadius-this.innerRadius)/2+this.innerRadius;return{x:this.x+Math.cos(t)*i,y:this.y+Math.sin(t)*i}},draw:function(t){var i=this.ctx;i.beginPath(),i.arc(this.x,this.y,this.outerRadius,this.startAngle,this.endAngle),i.arc(this.x,this.y,this.innerRadius,this.endAngle,this.startAngle,!0),i.closePath(),i.strokeStyle=this.strokeColor,i.lineWidth=this.strokeWidth,i.fillStyle=this.fillColor,i.fill(),i.lineJoin="bevel",this.showStroke&&i.stroke()}}),e.Rectangle=e.Element.extend({draw:function(){var t=this.ctx,i=this.width/2,e=this.x-i,s=this.x+i,n=this.base-(this.base-this.y),o=this.strokeWidth/2;this.showStroke&&(e+=o,s-=o,n+=o),t.beginPath(),t.fillStyle=this.fillColor,t.strokeStyle=this.strokeColor,t.lineWidth=this.strokeWidth,t.moveTo(e,this.base),t.lineTo(e,n),t.lineTo(s,n),t.lineTo(s,this.base),t.fill(),this.showStroke&&t.stroke()},height:function(){return this.base-this.y},inRange:function(t,i){return t>=this.x-this.width/2&&t<=this.x+this.width/2&&i>=this.y&&i<=this.base}}),e.Tooltip=e.Element.extend({draw:function(){var t=this.chart.ctx;t.font=M(this.fontSize,this.fontStyle,this.fontFamily),this.xAlign="center",this.yAlign="above";var i=this.caretPadding=2,e=t.measureText(this.text).width+2*this.xPadding,s=this.fontSize+2*this.yPadding,n=s+this.caretHeight+i;this.x+e/2>this.chart.width?this.xAlign="left":this.x-e/2<0&&(this.xAlign="right"),this.y-n<0&&(this.yAlign="below");var o=this.x-e/2,a=this.y-n;if(t.fillStyle=this.fillColor,this.custom)this.custom(this);else{switch(this.yAlign){case"above":t.beginPath(),t.moveTo(this.x,this.y-i),t.lineTo(this.x+this.caretHeight,this.y-(i+this.caretHeight)),t.lineTo(this.x-this.caretHeight,this.y-(i+this.caretHeight)),t.closePath(),t.fill();break;case"below":a=this.y+i+this.caretHeight,t.beginPath(),t.moveTo(this.x,this.y+i),t.lineTo(this.x+this.caretHeight,this.y+i+this.caretHeight),t.lineTo(this.x-this.caretHeight,this.y+i+this.caretHeight),t.closePath(),t.fill()}switch(this.xAlign){case"left":o=this.x-e+(this.cornerRadius+this.caretHeight);break;case"right":o=this.x-(this.cornerRadius+this.caretHeight)}z(t,o,a,e,s,this.cornerRadius),t.fill(),t.fillStyle=this.textColor,t.textAlign="center",t.textBaseline="middle",t.fillText(this.text,o+e/2,a+s/2)}}}),e.MultiTooltip=e.Element.extend({initialize:function(){this.font=M(this.fontSize,this.fontStyle,this.fontFamily),this.titleFont=M(this.titleFontSize,this.titleFontStyle,this.titleFontFamily),this.height=this.labels.length*this.fontSize+(this.labels.length-1)*(this.fontSize/2)+2*this.yPadding+1.5*this.titleFontSize,this.ctx.font=this.titleFont;var t=this.ctx.measureText(this.title).width,i=W(this.ctx,this.font,this.labels)+this.fontSize+3,e=g([i,t]);this.width=e+2*this.xPadding;var s=this.height/2;this.y-s<0?this.y=s:this.y+s>this.chart.height&&(this.y=this.chart.height-s),this.x>this.chart.width/2?this.x-=this.xOffset+this.width:this.x+=this.xOffset},getLineHeight:function(t){var i=this.y-this.height/2+this.yPadding,e=t-1;return 0===t?i+this.titleFontSize/2:i+(1.5*this.fontSize*e+this.fontSize/2)+1.5*this.titleFontSize},draw:function(){if(this.custom)this.custom(this);else{z(this.ctx,this.x,this.y-this.height/2,this.width,this.height,this.cornerRadius);var t=this.ctx;t.fillStyle=this.fillColor,t.fill(),t.closePath(),t.textAlign="left",t.textBaseline="middle",t.fillStyle=this.titleTextColor,t.font=this.titleFont,t.fillText(this.title,this.x+this.xPadding,this.getLineHeight(0)),t.font=this.font,s.each(this.labels,function(i,e){t.fillStyle=this.textColor,t.fillText(i,this.x+this.xPadding+this.fontSize+3,this.getLineHeight(e+1)),t.fillStyle=this.legendColorBackground,t.fillRect(this.x+this.xPadding,this.getLineHeight(e+1)-this.fontSize/2,this.fontSize,this.fontSize),t.fillStyle=this.legendColors[e].fill,t.fillRect(this.x+this.xPadding,this.getLineHeight(e+1)-this.fontSize/2,this.fontSize,this.fontSize)},this)}}}),e.Scale=e.Element.extend({initialize:function(){this.fit()},buildYLabels:function(){this.yLabels=[];for(var t=v(this.stepValue),i=0;i<=this.steps;i++)this.yLabels.push(C(this.templateString,{value:(this.min+i*this.stepValue).toFixed(t)}));this.yLabelWidth=this.display&&this.showLabels?W(this.ctx,this.font,this.yLabels):0},addXLabel:function(t){this.xLabels.push(t),this.valuesCount++,this.fit()},removeXLabel:function(){this.xLabels.shift(),this.valuesCount--,this.fit()},fit:function(){this.startPoint=this.display?this.fontSize:0,this.endPoint=this.display?this.height-1.5*this.fontSize-5:this.height,this.startPoint+=this.padding,this.endPoint-=this.padding;var t,i=this.endPoint-this.startPoint;for(this.calculateYRange(i),this.buildYLabels(),this.calculateXLabelRotation();i>this.endPoint-this.startPoint;)i=this.endPoint-this.startPoint,t=this.yLabelWidth,this.calculateYRange(i),this.buildYLabels(),t<this.yLabelWidth&&this.calculateXLabelRotation()},calculateXLabelRotation:function(){this.ctx.font=this.font;var t,i,e=this.ctx.measureText(this.xLabels[0]).width,s=this.ctx.measureText(this.xLabels[this.xLabels.length-1]).width;if(this.xScalePaddingRight=s/2+3,this.xScalePaddingLeft=e/2>this.yLabelWidth+10?e/2:this.yLabelWidth+10,this.xLabelRotation=0,this.display){var n,o=W(this.ctx,this.font,this.xLabels);this.xLabelWidth=o;for(var a=Math.floor(this.calculateX(1)-this.calculateX(0))-6;this.xLabelWidth>a&&0===this.xLabelRotation||this.xLabelWidth>a&&this.xLabelRotation<=90&&this.xLabelRotation>0;)n=Math.cos(S(this.xLabelRotation)),t=n*e,i=n*s,t+this.fontSize/2>this.yLabelWidth+8&&(this.xScalePaddingLeft=t+this.fontSize/2),this.xScalePaddingRight=this.fontSize/2,this.xLabelRotation++,this.xLabelWidth=n*o;this.xLabelRotation>0&&(this.endPoint-=Math.sin(S(this.xLabelRotation))*o+3)}else this.xLabelWidth=0,this.xScalePaddingRight=this.padding,this.xScalePaddingLeft=this.padding},calculateYRange:c,drawingArea:function(){return this.startPoint-this.endPoint},calculateY:function(t){var i=this.drawingArea()/(this.min-this.max);return this.endPoint-i*(t-this.min)},calculateX:function(t){var i=(this.xLabelRotation>0,this.width-(this.xScalePaddingLeft+this.xScalePaddingRight)),e=i/(this.valuesCount-(this.offsetGridLines?0:1)),s=e*t+this.xScalePaddingLeft;return this.offsetGridLines&&(s+=e/2),Math.round(s)},update:function(t){s.extend(this,t),this.fit()},draw:function(){var t=this.ctx,i=(this.endPoint-this.startPoint)/this.steps,e=Math.round(this.xScalePaddingLeft);this.display&&(t.fillStyle=this.textColor,t.font=this.font,n(this.yLabels,function(n,o){var a=this.endPoint-i*o,h=Math.round(a),l=this.showHorizontalLines;t.textAlign="right",t.textBaseline="middle",this.showLabels&&t.fillText(n,e-10,a),0!==o||l||(l=!0),l&&t.beginPath(),o>0?(t.lineWidth=this.gridLineWidth,t.strokeStyle=this.gridLineColor):(t.lineWidth=this.lineWidth,t.strokeStyle=this.lineColor),h+=s.aliasPixel(t.lineWidth),l&&(t.moveTo(e,h),t.lineTo(this.width,h),t.stroke(),t.closePath()),t.lineWidth=this.lineWidth,t.strokeStyle=this.lineColor,t.beginPath(),t.moveTo(e-5,h),t.lineTo(e,h),t.stroke(),t.closePath()},this),n(this.xLabels,function(i,e){var s=this.calculateX(e)+x(this.lineWidth),n=this.calculateX(e-(this.offsetGridLines?.5:0))+x(this.lineWidth),o=this.xLabelRotation>0,a=this.showVerticalLines;0!==e||a||(a=!0),a&&t.beginPath(),e>0?(t.lineWidth=this.gridLineWidth,t.strokeStyle=this.gridLineColor):(t.lineWidth=this.lineWidth,t.strokeStyle=this.lineColor),a&&(t.moveTo(n,this.endPoint),t.lineTo(n,this.startPoint-3),t.stroke(),t.closePath()),t.lineWidth=this.lineWidth,t.strokeStyle=this.lineColor,t.beginPath(),t.moveTo(n,this.endPoint),t.lineTo(n,this.endPoint+5),t.stroke(),t.closePath(),t.save(),t.translate(s,o?this.endPoint+12:this.endPoint+8),t.rotate(-1*S(this.xLabelRotation)),t.font=this.font,t.textAlign=o?"right":"center",t.textBaseline=o?"middle":"top",t.fillText(i,0,0),t.restore()},this))}}),e.RadialScale=e.Element.extend({initialize:function(){this.size=m([this.height,this.width]),this.drawingArea=this.display?this.size/2-(this.fontSize/2+this.backdropPaddingY):this.size/2},calculateCenterOffset:function(t){var i=this.drawingArea/(this.max-this.min);return(t-this.min)*i},update:function(){this.lineArc?this.drawingArea=this.display?this.size/2-(this.fontSize/2+this.backdropPaddingY):this.size/2:this.setScaleSize(),this.buildYLabels()},buildYLabels:function(){this.yLabels=[];for(var t=v(this.stepValue),i=0;i<=this.steps;i++)this.yLabels.push(C(this.templateString,{value:(this.min+i*this.stepValue).toFixed(t)}))},getCircumference:function(){return 2*Math.PI/this.valuesCount},setScaleSize:function(){var t,i,e,s,n,o,a,h,l,r,c,u,d=m([this.height/2-this.pointLabelFontSize-5,this.width/2]),p=this.width,g=0;for(this.ctx.font=M(this.pointLabelFontSize,this.pointLabelFontStyle,this.pointLabelFontFamily),i=0;i<this.valuesCount;i++)t=this.getPointPosition(i,d),e=this.ctx.measureText(C(this.templateString,{value:this.labels[i]})).width+5,0===i||i===this.valuesCount/2?(s=e/2,t.x+s>p&&(p=t.x+s,n=i),t.x-s<g&&(g=t.x-s,a=i)):i<this.valuesCount/2?t.x+e>p&&(p=t.x+e,n=i):i>this.valuesCount/2&&t.x-e<g&&(g=t.x-e,a=i);l=g,r=Math.ceil(p-this.width),o=this.getIndexAngle(n),h=this.getIndexAngle(a),c=r/Math.sin(o+Math.PI/2),u=l/Math.sin(h+Math.PI/2),c=f(c)?c:0,u=f(u)?u:0,this.drawingArea=d-(u+c)/2,this.setCenterPoint(u,c)},setCenterPoint:function(t,i){var e=this.width-i-this.drawingArea,s=t+this.drawingArea;this.xCenter=(s+e)/2,this.yCenter=this.height/2},getIndexAngle:function(t){var i=2*Math.PI/this.valuesCount;return t*i-Math.PI/2},getPointPosition:function(t,i){var e=this.getIndexAngle(t);return{x:Math.cos(e)*i+this.xCenter,y:Math.sin(e)*i+this.yCenter}},draw:function(){if(this.display){var t=this.ctx;if(n(this.yLabels,function(i,e){if(e>0){var s,n=e*(this.drawingArea/this.steps),o=this.yCenter-n;if(this.lineWidth>0)if(t.strokeStyle=this.lineColor,t.lineWidth=this.lineWidth,this.lineArc)t.beginPath(),t.arc(this.xCenter,this.yCenter,n,0,2*Math.PI),t.closePath(),t.stroke();else{t.beginPath();for(var a=0;a<this.valuesCount;a++)s=this.getPointPosition(a,this.calculateCenterOffset(this.min+e*this.stepValue)),0===a?t.moveTo(s.x,s.y):t.lineTo(s.x,s.y);t.closePath(),t.stroke()}if(this.showLabels){if(t.font=M(this.fontSize,this.fontStyle,this.fontFamily),this.showLabelBackdrop){var h=t.measureText(i).width;t.fillStyle=this.backdropColor,t.fillRect(this.xCenter-h/2-this.backdropPaddingX,o-this.fontSize/2-this.backdropPaddingY,h+2*this.backdropPaddingX,this.fontSize+2*this.backdropPaddingY)}t.textAlign="center",t.textBaseline="middle",t.fillStyle=this.fontColor,t.fillText(i,this.xCenter,o)}}},this),!this.lineArc){t.lineWidth=this.angleLineWidth,t.strokeStyle=this.angleLineColor;for(var i=this.valuesCount-1;i>=0;i--){if(this.angleLineWidth>0){var e=this.getPointPosition(i,this.calculateCenterOffset(this.max));t.beginPath(),t.moveTo(this.xCenter,this.yCenter),t.lineTo(e.x,e.y),t.stroke(),t.closePath()}var s=this.getPointPosition(i,this.calculateCenterOffset(this.max)+5);t.font=M(this.pointLabelFontSize,this.pointLabelFontStyle,this.pointLabelFontFamily),t.fillStyle=this.pointLabelFontColor;var o=this.labels.length,a=this.labels.length/2,h=a/2,l=h>i||i>o-h,r=i===h||i===o-h;t.textAlign=0===i?"center":i===a?"center":a>i?"left":"right",t.textBaseline=r?"middle":l?"bottom":"top",t.fillText(this.labels[i],s.x,s.y)}}}}}),s.addEvent(window,"resize",function(){var t;return function(){clearTimeout(t),t=setTimeout(function(){n(e.instances,function(t){t.options.responsive&&t.resize(t.render,!0)})},50)}}()),p?define(function(){return e}):"object"==typeof module&&module.exports&&(module.exports=e),t.Chart=e,e.noConflict=function(){return t.Chart=i,e}}).call(this),function(){"use strict";var t=this,i=t.Chart,e=i.helpers,s={scaleBeginAtZero:!0,scaleShowGridLines:!0,scaleGridLineColor:"rgba(0,0,0,.05)",scaleGridLineWidth:1,scaleShowHorizontalLines:!0,scaleShowVerticalLines:!0,barShowStroke:!0,barStrokeWidth:2,barValueSpacing:5,barDatasetSpacing:1,legendTemplate:'<ul class="<%=name.toLowerCase()%>-legend"><% for (var i=0; i<datasets.length; i++){%><li><span style="background-color:<%=datasets[i].fillColor%>"></span><%if(datasets[i].label){%><%=datasets[i].label%><%}%></li><%}%></ul>'};i.Type.extend({name:"Bar",defaults:s,initialize:function(t){var s=this.options;this.ScaleClass=i.Scale.extend({offsetGridLines:!0,calculateBarX:function(t,i,e){var n=this.calculateBaseWidth(),o=this.calculateX(e)-n/2,a=this.calculateBarWidth(t);return o+a*i+i*s.barDatasetSpacing+a/2},calculateBaseWidth:function(){return this.calculateX(1)-this.calculateX(0)-2*s.barValueSpacing},calculateBarWidth:function(t){var i=this.calculateBaseWidth()-(t-1)*s.barDatasetSpacing;return i/t}}),this.datasets=[],this.options.showTooltips&&e.bindEvents(this,this.options.tooltipEvents,function(t){var i="mouseout"!==t.type?this.getBarsAtEvent(t):[];this.eachBars(function(t){t.restore(["fillColor","strokeColor"])}),e.each(i,function(t){t.fillColor=t.highlightFill,t.strokeColor=t.highlightStroke}),this.showTooltip(i)}),this.BarClass=i.Rectangle.extend({strokeWidth:this.options.barStrokeWidth,showStroke:this.options.barShowStroke,ctx:this.chart.ctx}),e.each(t.datasets,function(i){var s={label:i.label||null,fillColor:i.fillColor,strokeColor:i.strokeColor,bars:[]};this.datasets.push(s),e.each(i.data,function(e,n){s.bars.push(new this.BarClass({value:e,label:t.labels[n],datasetLabel:i.label,strokeColor:i.strokeColor,fillColor:i.fillColor,highlightFill:i.highlightFill||i.fillColor,highlightStroke:i.highlightStroke||i.strokeColor}))},this)},this),this.buildScale(t.labels),this.BarClass.prototype.base=this.scale.endPoint,this.eachBars(function(t,i,s){e.extend(t,{width:this.scale.calculateBarWidth(this.datasets.length),x:this.scale.calculateBarX(this.datasets.length,s,i),y:this.scale.endPoint}),t.save()},this),this.render()},update:function(){this.scale.update(),e.each(this.activeElements,function(t){t.restore(["fillColor","strokeColor"])}),this.eachBars(function(t){t.save()}),this.render()},eachBars:function(t){e.each(this.datasets,function(i,s){e.each(i.bars,t,this,s)},this)},getBarsAtEvent:function(t){for(var i,s=[],n=e.getRelativePosition(t),o=function(t){s.push(t.bars[i])},a=0;a<this.datasets.length;a++)for(i=0;i<this.datasets[a].bars.length;i++)if(this.datasets[a].bars[i].inRange(n.x,n.y))return e.each(this.datasets,o),s;return s},buildScale:function(t){var i=this,s=function(){var t=[];return i.eachBars(function(i){t.push(i.value)}),t},n={templateString:this.options.scaleLabel,height:this.chart.height,width:this.chart.width,ctx:this.chart.ctx,textColor:this.options.scaleFontColor,fontSize:this.options.scaleFontSize,fontStyle:this.options.scaleFontStyle,fontFamily:this.options.scaleFontFamily,valuesCount:t.length,beginAtZero:this.options.scaleBeginAtZero,integersOnly:this.options.scaleIntegersOnly,calculateYRange:function(t){var i=e.calculateScaleRange(s(),t,this.fontSize,this.beginAtZero,this.integersOnly);e.extend(this,i)},xLabels:t,font:e.fontString(this.options.scaleFontSize,this.options.scaleFontStyle,this.options.scaleFontFamily),lineWidth:this.options.scaleLineWidth,lineColor:this.options.scaleLineColor,showHorizontalLines:this.options.scaleShowHorizontalLines,showVerticalLines:this.options.scaleShowVerticalLines,gridLineWidth:this.options.scaleShowGridLines?this.options.scaleGridLineWidth:0,gridLineColor:this.options.scaleShowGridLines?this.options.scaleGridLineColor:"rgba(0,0,0,0)",padding:this.options.showScale?0:this.options.barShowStroke?this.options.barStrokeWidth:0,showLabels:this.options.scaleShowLabels,display:this.options.showScale};this.options.scaleOverride&&e.extend(n,{calculateYRange:e.noop,steps:this.options.scaleSteps,stepValue:this.options.scaleStepWidth,min:this.options.scaleStartValue,max:this.options.scaleStartValue+this.options.scaleSteps*this.options.scaleStepWidth}),this.scale=new this.ScaleClass(n)},addData:function(t,i){e.each(t,function(t,e){this.datasets[e].bars.push(new this.BarClass({value:t,label:i,x:this.scale.calculateBarX(this.datasets.length,e,this.scale.valuesCount+1),y:this.scale.endPoint,width:this.scale.calculateBarWidth(this.datasets.length),base:this.scale.endPoint,strokeColor:this.datasets[e].strokeColor,fillColor:this.datasets[e].fillColor}))},this),this.scale.addXLabel(i),this.update()},removeData:function(){this.scale.removeXLabel(),e.each(this.datasets,function(t){t.bars.shift()},this),this.update()},reflow:function(){e.extend(this.BarClass.prototype,{y:this.scale.endPoint,base:this.scale.endPoint});
var t=e.extend({height:this.chart.height,width:this.chart.width});this.scale.update(t)},draw:function(t){var i=t||1;this.clear();this.chart.ctx;this.scale.draw(i),e.each(this.datasets,function(t,s){e.each(t.bars,function(t,e){t.hasValue()&&(t.base=this.scale.endPoint,t.transition({x:this.scale.calculateBarX(this.datasets.length,s,e),y:this.scale.calculateY(t.value),width:this.scale.calculateBarWidth(this.datasets.length)},i).draw())},this)},this)}})}.call(this),function(){"use strict";var t=this,i=t.Chart,e=i.helpers,s={segmentShowStroke:!0,segmentStrokeColor:"#fff",segmentStrokeWidth:2,percentageInnerCutout:50,animationSteps:100,animationEasing:"easeOutBounce",animateRotate:!0,animateScale:!1,legendTemplate:'<ul class="<%=name.toLowerCase()%>-legend"><% for (var i=0; i<segments.length; i++){%><li><span style="background-color:<%=segments[i].fillColor%>"></span><%if(segments[i].label){%><%=segments[i].label%><%}%></li><%}%></ul>'};i.Type.extend({name:"Doughnut",defaults:s,initialize:function(t){this.segments=[],this.outerRadius=(e.min([this.chart.width,this.chart.height])-this.options.segmentStrokeWidth/2)/2,this.SegmentArc=i.Arc.extend({ctx:this.chart.ctx,x:this.chart.width/2,y:this.chart.height/2}),this.options.showTooltips&&e.bindEvents(this,this.options.tooltipEvents,function(t){var i="mouseout"!==t.type?this.getSegmentsAtEvent(t):[];e.each(this.segments,function(t){t.restore(["fillColor"])}),e.each(i,function(t){t.fillColor=t.highlightColor}),this.showTooltip(i)}),this.calculateTotal(t),e.each(t,function(t,i){this.addData(t,i,!0)},this),this.render()},getSegmentsAtEvent:function(t){var i=[],s=e.getRelativePosition(t);return e.each(this.segments,function(t){t.inRange(s.x,s.y)&&i.push(t)},this),i},addData:function(t,i,e){var s=i||this.segments.length;this.segments.splice(s,0,new this.SegmentArc({value:t.value,outerRadius:this.options.animateScale?0:this.outerRadius,innerRadius:this.options.animateScale?0:this.outerRadius/100*this.options.percentageInnerCutout,fillColor:t.color,highlightColor:t.highlight||t.color,showStroke:this.options.segmentShowStroke,strokeWidth:this.options.segmentStrokeWidth,strokeColor:this.options.segmentStrokeColor,startAngle:1.5*Math.PI,circumference:this.options.animateRotate?0:this.calculateCircumference(t.value),label:t.label})),e||(this.reflow(),this.update())},calculateCircumference:function(t){return 2*Math.PI*(t/this.total)},calculateTotal:function(t){this.total=0,e.each(t,function(t){this.total+=t.value},this)},update:function(){this.calculateTotal(this.segments),e.each(this.activeElements,function(t){t.restore(["fillColor"])}),e.each(this.segments,function(t){t.save()}),this.render()},removeData:function(t){var i=e.isNumber(t)?t:this.segments.length-1;this.segments.splice(i,1),this.reflow(),this.update()},reflow:function(){e.extend(this.SegmentArc.prototype,{x:this.chart.width/2,y:this.chart.height/2}),this.outerRadius=(e.min([this.chart.width,this.chart.height])-this.options.segmentStrokeWidth/2)/2,e.each(this.segments,function(t){t.update({outerRadius:this.outerRadius,innerRadius:this.outerRadius/100*this.options.percentageInnerCutout})},this)},draw:function(t){var i=t?t:1;this.clear(),e.each(this.segments,function(t,e){t.transition({circumference:this.calculateCircumference(t.value),outerRadius:this.outerRadius,innerRadius:this.outerRadius/100*this.options.percentageInnerCutout},i),t.endAngle=t.startAngle+t.circumference,t.draw(),0===e&&(t.startAngle=1.5*Math.PI),e<this.segments.length-1&&(this.segments[e+1].startAngle=t.endAngle)},this)}}),i.types.Doughnut.extend({name:"Pie",defaults:e.merge(s,{percentageInnerCutout:0})})}.call(this),function(){"use strict";var t=this,i=t.Chart,e=i.helpers,s={scaleShowGridLines:!0,scaleGridLineColor:"rgba(0,0,0,.05)",scaleGridLineWidth:1,scaleShowHorizontalLines:!0,scaleShowVerticalLines:!0,bezierCurve:!0,bezierCurveTension:.4,pointDot:!0,pointDotRadius:4,pointDotStrokeWidth:1,pointHitDetectionRadius:20,datasetStroke:!0,datasetStrokeWidth:2,datasetFill:!0,legendTemplate:'<ul class="<%=name.toLowerCase()%>-legend"><% for (var i=0; i<datasets.length; i++){%><li><span style="background-color:<%=datasets[i].strokeColor%>"></span><%if(datasets[i].label){%><%=datasets[i].label%><%}%></li><%}%></ul>'};i.Type.extend({name:"Line",defaults:s,initialize:function(t){this.PointClass=i.Point.extend({strokeWidth:this.options.pointDotStrokeWidth,radius:this.options.pointDotRadius,display:this.options.pointDot,hitDetectionRadius:this.options.pointHitDetectionRadius,ctx:this.chart.ctx,inRange:function(t){return Math.pow(t-this.x,2)<Math.pow(this.radius+this.hitDetectionRadius,2)}}),this.datasets=[],this.options.showTooltips&&e.bindEvents(this,this.options.tooltipEvents,function(t){var i="mouseout"!==t.type?this.getPointsAtEvent(t):[];this.eachPoints(function(t){t.restore(["fillColor","strokeColor"])}),e.each(i,function(t){t.fillColor=t.highlightFill,t.strokeColor=t.highlightStroke}),this.showTooltip(i)}),e.each(t.datasets,function(i){var s={label:i.label||null,fillColor:i.fillColor,strokeColor:i.strokeColor,pointColor:i.pointColor,pointStrokeColor:i.pointStrokeColor,points:[]};this.datasets.push(s),e.each(i.data,function(e,n){s.points.push(new this.PointClass({value:e,label:t.labels[n],datasetLabel:i.label,strokeColor:i.pointStrokeColor,fillColor:i.pointColor,highlightFill:i.pointHighlightFill||i.pointColor,highlightStroke:i.pointHighlightStroke||i.pointStrokeColor}))},this),this.buildScale(t.labels),this.eachPoints(function(t,i){e.extend(t,{x:this.scale.calculateX(i),y:this.scale.endPoint}),t.save()},this)},this),this.render()},update:function(){this.scale.update(),e.each(this.activeElements,function(t){t.restore(["fillColor","strokeColor"])}),this.eachPoints(function(t){t.save()}),this.render()},eachPoints:function(t){e.each(this.datasets,function(i){e.each(i.points,t,this)},this)},getPointsAtEvent:function(t){var i=[],s=e.getRelativePosition(t);return e.each(this.datasets,function(t){e.each(t.points,function(t){t.inRange(s.x,s.y)&&i.push(t)})},this),i},buildScale:function(t){var s=this,n=function(){var t=[];return s.eachPoints(function(i){t.push(i.value)}),t},o={templateString:this.options.scaleLabel,height:this.chart.height,width:this.chart.width,ctx:this.chart.ctx,textColor:this.options.scaleFontColor,fontSize:this.options.scaleFontSize,fontStyle:this.options.scaleFontStyle,fontFamily:this.options.scaleFontFamily,valuesCount:t.length,beginAtZero:this.options.scaleBeginAtZero,integersOnly:this.options.scaleIntegersOnly,calculateYRange:function(t){var i=e.calculateScaleRange(n(),t,this.fontSize,this.beginAtZero,this.integersOnly);e.extend(this,i)},xLabels:t,font:e.fontString(this.options.scaleFontSize,this.options.scaleFontStyle,this.options.scaleFontFamily),lineWidth:this.options.scaleLineWidth,lineColor:this.options.scaleLineColor,showHorizontalLines:this.options.scaleShowHorizontalLines,showVerticalLines:this.options.scaleShowVerticalLines,gridLineWidth:this.options.scaleShowGridLines?this.options.scaleGridLineWidth:0,gridLineColor:this.options.scaleShowGridLines?this.options.scaleGridLineColor:"rgba(0,0,0,0)",padding:this.options.showScale?0:this.options.pointDotRadius+this.options.pointDotStrokeWidth,showLabels:this.options.scaleShowLabels,display:this.options.showScale};this.options.scaleOverride&&e.extend(o,{calculateYRange:e.noop,steps:this.options.scaleSteps,stepValue:this.options.scaleStepWidth,min:this.options.scaleStartValue,max:this.options.scaleStartValue+this.options.scaleSteps*this.options.scaleStepWidth}),this.scale=new i.Scale(o)},addData:function(t,i){e.each(t,function(t,e){this.datasets[e].points.push(new this.PointClass({value:t,label:i,x:this.scale.calculateX(this.scale.valuesCount+1),y:this.scale.endPoint,strokeColor:this.datasets[e].pointStrokeColor,fillColor:this.datasets[e].pointColor}))},this),this.scale.addXLabel(i),this.update()},removeData:function(){this.scale.removeXLabel(),e.each(this.datasets,function(t){t.points.shift()},this),this.update()},reflow:function(){var t=e.extend({height:this.chart.height,width:this.chart.width});this.scale.update(t)},draw:function(t){var i=t||1;this.clear();var s=this.chart.ctx,n=function(t){return null!==t.value},o=function(t,i,s){return e.findNextWhere(i,n,s)||t},a=function(t,i,s){return e.findPreviousWhere(i,n,s)||t};this.scale.draw(i),e.each(this.datasets,function(t){var h=e.where(t.points,n);e.each(t.points,function(t,e){t.hasValue()&&t.transition({y:this.scale.calculateY(t.value),x:this.scale.calculateX(e)},i)},this),this.options.bezierCurve&&e.each(h,function(t,i){var s=i>0&&i<h.length-1?this.options.bezierCurveTension:0;t.controlPoints=e.splineCurve(a(t,h,i),t,o(t,h,i),s),t.controlPoints.outer.y>this.scale.endPoint?t.controlPoints.outer.y=this.scale.endPoint:t.controlPoints.outer.y<this.scale.startPoint&&(t.controlPoints.outer.y=this.scale.startPoint),t.controlPoints.inner.y>this.scale.endPoint?t.controlPoints.inner.y=this.scale.endPoint:t.controlPoints.inner.y<this.scale.startPoint&&(t.controlPoints.inner.y=this.scale.startPoint)},this),s.lineWidth=this.options.datasetStrokeWidth,s.strokeStyle=t.strokeColor,s.beginPath(),e.each(h,function(t,i){if(0===i)s.moveTo(t.x,t.y);else if(this.options.bezierCurve){var e=a(t,h,i);s.bezierCurveTo(e.controlPoints.outer.x,e.controlPoints.outer.y,t.controlPoints.inner.x,t.controlPoints.inner.y,t.x,t.y)}else s.lineTo(t.x,t.y)},this),s.stroke(),this.options.datasetFill&&h.length>0&&(s.lineTo(h[h.length-1].x,this.scale.endPoint),s.lineTo(h[0].x,this.scale.endPoint),s.fillStyle=t.fillColor,s.closePath(),s.fill()),e.each(h,function(t){t.draw()})},this)}})}.call(this),function(){"use strict";var t=this,i=t.Chart,e=i.helpers,s={scaleShowLabelBackdrop:!0,scaleBackdropColor:"rgba(255,255,255,0.75)",scaleBeginAtZero:!0,scaleBackdropPaddingY:2,scaleBackdropPaddingX:2,scaleShowLine:!0,segmentShowStroke:!0,segmentStrokeColor:"#fff",segmentStrokeWidth:2,animationSteps:100,animationEasing:"easeOutBounce",animateRotate:!0,animateScale:!1,legendTemplate:'<ul class="<%=name.toLowerCase()%>-legend"><% for (var i=0; i<segments.length; i++){%><li><span style="background-color:<%=segments[i].fillColor%>"></span><%if(segments[i].label){%><%=segments[i].label%><%}%></li><%}%></ul>'};i.Type.extend({name:"PolarArea",defaults:s,initialize:function(t){this.segments=[],this.SegmentArc=i.Arc.extend({showStroke:this.options.segmentShowStroke,strokeWidth:this.options.segmentStrokeWidth,strokeColor:this.options.segmentStrokeColor,ctx:this.chart.ctx,innerRadius:0,x:this.chart.width/2,y:this.chart.height/2}),this.scale=new i.RadialScale({display:this.options.showScale,fontStyle:this.options.scaleFontStyle,fontSize:this.options.scaleFontSize,fontFamily:this.options.scaleFontFamily,fontColor:this.options.scaleFontColor,showLabels:this.options.scaleShowLabels,showLabelBackdrop:this.options.scaleShowLabelBackdrop,backdropColor:this.options.scaleBackdropColor,backdropPaddingY:this.options.scaleBackdropPaddingY,backdropPaddingX:this.options.scaleBackdropPaddingX,lineWidth:this.options.scaleShowLine?this.options.scaleLineWidth:0,lineColor:this.options.scaleLineColor,lineArc:!0,width:this.chart.width,height:this.chart.height,xCenter:this.chart.width/2,yCenter:this.chart.height/2,ctx:this.chart.ctx,templateString:this.options.scaleLabel,valuesCount:t.length}),this.updateScaleRange(t),this.scale.update(),e.each(t,function(t,i){this.addData(t,i,!0)},this),this.options.showTooltips&&e.bindEvents(this,this.options.tooltipEvents,function(t){var i="mouseout"!==t.type?this.getSegmentsAtEvent(t):[];e.each(this.segments,function(t){t.restore(["fillColor"])}),e.each(i,function(t){t.fillColor=t.highlightColor}),this.showTooltip(i)}),this.render()},getSegmentsAtEvent:function(t){var i=[],s=e.getRelativePosition(t);return e.each(this.segments,function(t){t.inRange(s.x,s.y)&&i.push(t)},this),i},addData:function(t,i,e){var s=i||this.segments.length;this.segments.splice(s,0,new this.SegmentArc({fillColor:t.color,highlightColor:t.highlight||t.color,label:t.label,value:t.value,outerRadius:this.options.animateScale?0:this.scale.calculateCenterOffset(t.value),circumference:this.options.animateRotate?0:this.scale.getCircumference(),startAngle:1.5*Math.PI})),e||(this.reflow(),this.update())},removeData:function(t){var i=e.isNumber(t)?t:this.segments.length-1;this.segments.splice(i,1),this.reflow(),this.update()},calculateTotal:function(t){this.total=0,e.each(t,function(t){this.total+=t.value},this),this.scale.valuesCount=this.segments.length},updateScaleRange:function(t){var i=[];e.each(t,function(t){i.push(t.value)});var s=this.options.scaleOverride?{steps:this.options.scaleSteps,stepValue:this.options.scaleStepWidth,min:this.options.scaleStartValue,max:this.options.scaleStartValue+this.options.scaleSteps*this.options.scaleStepWidth}:e.calculateScaleRange(i,e.min([this.chart.width,this.chart.height])/2,this.options.scaleFontSize,this.options.scaleBeginAtZero,this.options.scaleIntegersOnly);e.extend(this.scale,s,{size:e.min([this.chart.width,this.chart.height]),xCenter:this.chart.width/2,yCenter:this.chart.height/2})},update:function(){this.calculateTotal(this.segments),e.each(this.segments,function(t){t.save()}),this.render()},reflow:function(){e.extend(this.SegmentArc.prototype,{x:this.chart.width/2,y:this.chart.height/2}),this.updateScaleRange(this.segments),this.scale.update(),e.extend(this.scale,{xCenter:this.chart.width/2,yCenter:this.chart.height/2}),e.each(this.segments,function(t){t.update({outerRadius:this.scale.calculateCenterOffset(t.value)})},this)},draw:function(t){var i=t||1;this.clear(),e.each(this.segments,function(t,e){t.transition({circumference:this.scale.getCircumference(),outerRadius:this.scale.calculateCenterOffset(t.value)},i),t.endAngle=t.startAngle+t.circumference,0===e&&(t.startAngle=1.5*Math.PI),e<this.segments.length-1&&(this.segments[e+1].startAngle=t.endAngle),t.draw()},this),this.scale.draw()}})}.call(this),function(){"use strict";var t=this,i=t.Chart,e=i.helpers;i.Type.extend({name:"Radar",defaults:{scaleShowLine:!0,angleShowLineOut:!0,scaleShowLabels:!1,scaleBeginAtZero:!0,angleLineColor:"rgba(0,0,0,.1)",angleLineWidth:1,pointLabelFontFamily:"'Arial'",pointLabelFontStyle:"normal",pointLabelFontSize:10,pointLabelFontColor:"#666",pointDot:!0,pointDotRadius:3,pointDotStrokeWidth:1,pointHitDetectionRadius:20,datasetStroke:!0,datasetStrokeWidth:2,datasetFill:!0,legendTemplate:'<ul class="<%=name.toLowerCase()%>-legend"><% for (var i=0; i<datasets.length; i++){%><li><span style="background-color:<%=datasets[i].strokeColor%>"></span><%if(datasets[i].label){%><%=datasets[i].label%><%}%></li><%}%></ul>'},initialize:function(t){this.PointClass=i.Point.extend({strokeWidth:this.options.pointDotStrokeWidth,radius:this.options.pointDotRadius,display:this.options.pointDot,hitDetectionRadius:this.options.pointHitDetectionRadius,ctx:this.chart.ctx}),this.datasets=[],this.buildScale(t),this.options.showTooltips&&e.bindEvents(this,this.options.tooltipEvents,function(t){var i="mouseout"!==t.type?this.getPointsAtEvent(t):[];this.eachPoints(function(t){t.restore(["fillColor","strokeColor"])}),e.each(i,function(t){t.fillColor=t.highlightFill,t.strokeColor=t.highlightStroke}),this.showTooltip(i)}),e.each(t.datasets,function(i){var s={label:i.label||null,fillColor:i.fillColor,strokeColor:i.strokeColor,pointColor:i.pointColor,pointStrokeColor:i.pointStrokeColor,points:[]};this.datasets.push(s),e.each(i.data,function(e,n){var o;this.scale.animation||(o=this.scale.getPointPosition(n,this.scale.calculateCenterOffset(e))),s.points.push(new this.PointClass({value:e,label:t.labels[n],datasetLabel:i.label,x:this.options.animation?this.scale.xCenter:o.x,y:this.options.animation?this.scale.yCenter:o.y,strokeColor:i.pointStrokeColor,fillColor:i.pointColor,highlightFill:i.pointHighlightFill||i.pointColor,highlightStroke:i.pointHighlightStroke||i.pointStrokeColor}))},this)},this),this.render()},eachPoints:function(t){e.each(this.datasets,function(i){e.each(i.points,t,this)},this)},getPointsAtEvent:function(t){var i=e.getRelativePosition(t),s=e.getAngleFromPoint({x:this.scale.xCenter,y:this.scale.yCenter},i),n=2*Math.PI/this.scale.valuesCount,o=Math.round((s.angle-1.5*Math.PI)/n),a=[];return(o>=this.scale.valuesCount||0>o)&&(o=0),s.distance<=this.scale.drawingArea&&e.each(this.datasets,function(t){a.push(t.points[o])}),a},buildScale:function(t){this.scale=new i.RadialScale({display:this.options.showScale,fontStyle:this.options.scaleFontStyle,fontSize:this.options.scaleFontSize,fontFamily:this.options.scaleFontFamily,fontColor:this.options.scaleFontColor,showLabels:this.options.scaleShowLabels,showLabelBackdrop:this.options.scaleShowLabelBackdrop,backdropColor:this.options.scaleBackdropColor,backdropPaddingY:this.options.scaleBackdropPaddingY,backdropPaddingX:this.options.scaleBackdropPaddingX,lineWidth:this.options.scaleShowLine?this.options.scaleLineWidth:0,lineColor:this.options.scaleLineColor,angleLineColor:this.options.angleLineColor,angleLineWidth:this.options.angleShowLineOut?this.options.angleLineWidth:0,pointLabelFontColor:this.options.pointLabelFontColor,pointLabelFontSize:this.options.pointLabelFontSize,pointLabelFontFamily:this.options.pointLabelFontFamily,pointLabelFontStyle:this.options.pointLabelFontStyle,height:this.chart.height,width:this.chart.width,xCenter:this.chart.width/2,yCenter:this.chart.height/2,ctx:this.chart.ctx,templateString:this.options.scaleLabel,labels:t.labels,valuesCount:t.datasets[0].data.length}),this.scale.setScaleSize(),this.updateScaleRange(t.datasets),this.scale.buildYLabels()},updateScaleRange:function(t){var i=function(){var i=[];return e.each(t,function(t){t.data?i=i.concat(t.data):e.each(t.points,function(t){i.push(t.value)})}),i}(),s=this.options.scaleOverride?{steps:this.options.scaleSteps,stepValue:this.options.scaleStepWidth,min:this.options.scaleStartValue,max:this.options.scaleStartValue+this.options.scaleSteps*this.options.scaleStepWidth}:e.calculateScaleRange(i,e.min([this.chart.width,this.chart.height])/2,this.options.scaleFontSize,this.options.scaleBeginAtZero,this.options.scaleIntegersOnly);e.extend(this.scale,s)},addData:function(t,i){this.scale.valuesCount++,e.each(t,function(t,e){var s=this.scale.getPointPosition(this.scale.valuesCount,this.scale.calculateCenterOffset(t));this.datasets[e].points.push(new this.PointClass({value:t,label:i,x:s.x,y:s.y,strokeColor:this.datasets[e].pointStrokeColor,fillColor:this.datasets[e].pointColor}))},this),this.scale.labels.push(i),this.reflow(),this.update()},removeData:function(){this.scale.valuesCount--,this.scale.labels.shift(),e.each(this.datasets,function(t){t.points.shift()},this),this.reflow(),this.update()},update:function(){this.eachPoints(function(t){t.save()}),this.reflow(),this.render()},reflow:function(){e.extend(this.scale,{width:this.chart.width,height:this.chart.height,size:e.min([this.chart.width,this.chart.height]),xCenter:this.chart.width/2,yCenter:this.chart.height/2}),this.updateScaleRange(this.datasets),this.scale.setScaleSize(),this.scale.buildYLabels()},draw:function(t){var i=t||1,s=this.chart.ctx;this.clear(),this.scale.draw(),e.each(this.datasets,function(t){e.each(t.points,function(t,e){t.hasValue()&&t.transition(this.scale.getPointPosition(e,this.scale.calculateCenterOffset(t.value)),i)},this),s.lineWidth=this.options.datasetStrokeWidth,s.strokeStyle=t.strokeColor,s.beginPath(),e.each(t.points,function(t,i){0===i?s.moveTo(t.x,t.y):s.lineTo(t.x,t.y)},this),s.closePath(),s.stroke(),s.fillStyle=t.fillColor,s.fill(),e.each(t.points,function(t){t.hasValue()&&t.draw()})},this)}})}.call(this);
},{}],60:[function(require,module,exports){
var Chart = require('./Chart.min');
Chart.types.Line.extend({
    // Passing in a name registers this chart in the Chart namespace in the same way
    name: "Scatter",
    draw : function(ease){
            var easingDecimal = ease || 1;
            this.clear();

            var ctx = this.chart.ctx;

            // Some helper methods for getting the next/prev points
            var hasValue = function(item){
                return item.value !== null;
            },
            nextPoint = function(point, collection, index){
                return Chart.helpers.findNextWhere(collection, hasValue, index) || point;
            },
            previousPoint = function(point, collection, index){
                return Chart.helpers.findPreviousWhere(collection, hasValue, index) || point;
            };

            this.scale.draw(easingDecimal);


            Chart.helpers.each(this.datasets,function(dataset){
                var pointsWithValues = Chart.helpers.where(dataset.points, hasValue);

                //Transition each point first so that the line and point drawing isn't out of sync
                //We can use this extra loop to calculate the control points of this dataset also in this loop

                Chart.helpers.each(dataset.points, function(point, index){
                    if (point.hasValue()){
                        point.transition({
                            y : this.scale.calculateY(point.value),
                            x : this.scale.calculateX(index)
                        }, easingDecimal);
                    }
                },this);


                // Control points need to be calculated in a seperate loop, because we need to know the current x/y of the point
                // This would cause issues when there is no animation, because the y of the next point would be 0, so beziers would be skewed
                if (this.options.bezierCurve){
                    Chart.helpers.each(pointsWithValues, function(point, index){
                        var tension = (index > 0 && index < pointsWithValues.length - 1) ? this.options.bezierCurveTension : 0;
                        point.controlPoints = Chart.helpers.splineCurve(
                            previousPoint(point, pointsWithValues, index),
                            point,
                            nextPoint(point, pointsWithValues, index),
                            tension
                        );

                        // Prevent the bezier going outside of the bounds of the graph

                        // Cap puter bezier handles to the upper/lower scale bounds
                        if (point.controlPoints.outer.y > this.scale.endPoint){
                            point.controlPoints.outer.y = this.scale.endPoint;
                        }
                        else if (point.controlPoints.outer.y < this.scale.startPoint){
                            point.controlPoints.outer.y = this.scale.startPoint;
                        }

                        // Cap inner bezier handles to the upper/lower scale bounds
                        if (point.controlPoints.inner.y > this.scale.endPoint){
                            point.controlPoints.inner.y = this.scale.endPoint;
                        }
                        else if (point.controlPoints.inner.y < this.scale.startPoint){
                            point.controlPoints.inner.y = this.scale.startPoint;
                        }
                    },this);
                }

                if (this.options.datasetFill && pointsWithValues.length > 0){
                    //Round off the line by going to the base of the chart, back to the start, then fill.
                    ctx.lineTo(pointsWithValues[pointsWithValues.length - 1].x, this.scale.endPoint);
                    ctx.lineTo(pointsWithValues[0].x, this.scale.endPoint);
                    ctx.fillStyle = dataset.fillColor;
                    ctx.closePath();
                    ctx.fill();
                }

                //Now draw the points over the line
                //A little inefficient double looping, but better than the line
                //lagging behind the point positions
                Chart.helpers.each(pointsWithValues,function(point){
                    point.draw();
                });
            },this);
        }
});
},{"./Chart.min":59}],61:[function(require,module,exports){
(function (global){
(function (factory) {
	// Module systems magic dance.

	if (typeof require === "function" && typeof exports === "object" && typeof module === "object") {
		// CommonJS or Node: hard-coded dependency on "knockout"
		factory((typeof window !== "undefined" ? window['ko'] : typeof global !== "undefined" ? global['ko'] : null), exports);
	} else if (typeof define === "function" && define["amd"]) {
		// AMD anonymous module with hard-coded dependency on "knockout"
		define(["knockout", "exports"], factory);
	} else {
		// <script> tag: use the global `ko` object, attaching a `mapping` property
		factory(ko, ko.mapping = {});
	}
}(function (ko, exports) {
	var DEBUG=true;
	var mappingProperty = "__ko_mapping__";
	var realKoDependentObservable = ko.dependentObservable;
	var mappingNesting = 0;
	var dependentObservables;
	var visitedObjects;
	var recognizedRootProperties = ["create", "update", "key", "arrayChanged"];
	var emptyReturn = {};

	var _defaultOptions = {
		include: ["_destroy"],
		ignore: [],
		copy: [],
		observe: []
	};
	var defaultOptions = _defaultOptions;

	// Author: KennyTM @ StackOverflow
	function unionArrays (x, y) {
		var obj = {};
		for (var i = x.length - 1; i >= 0; -- i) obj[x[i]] = x[i];
		for (var i = y.length - 1; i >= 0; -- i) obj[y[i]] = y[i];
		var res = [];

		for (var k in obj) {
			res.push(obj[k]);
		};

		return res;
	}

	function extendObject(destination, source) {
		var destType;

		for (var key in source) {
			if (source.hasOwnProperty(key) && source[key]) {
				destType = exports.getType(destination[key]);
				if (key && destination[key] && destType !== "array" && destType !== "string") {
					extendObject(destination[key], source[key]);
				} else {
					var bothArrays = exports.getType(destination[key]) === "array" && exports.getType(source[key]) === "array";
					if (bothArrays) {
						destination[key] = unionArrays(destination[key], source[key]);
					} else {
						destination[key] = source[key];
					}
				}
			}
		}
	}

	function merge(obj1, obj2) {
		var merged = {};
		extendObject(merged, obj1);
		extendObject(merged, obj2);

		return merged;
	}

	exports.isMapped = function (viewModel) {
		var unwrapped = ko.utils.unwrapObservable(viewModel);
		return unwrapped && unwrapped[mappingProperty];
	}

	exports.fromJS = function (jsObject /*, inputOptions, target*/ ) {
		if (arguments.length == 0) throw new Error("When calling ko.fromJS, pass the object you want to convert.");

		try {
			if (!mappingNesting++) {
				dependentObservables = [];
				visitedObjects = new objectLookup();
			}

			var options;
			var target;

			if (arguments.length == 2) {
				if (arguments[1][mappingProperty]) {
					target = arguments[1];
				} else {
					options = arguments[1];
				}
			}
			if (arguments.length == 3) {
				options = arguments[1];
				target = arguments[2];
			}

			if (target) {
				options = merge(options, target[mappingProperty]);
			}
			options = fillOptions(options);

			var result = updateViewModel(target, jsObject, options);
			if (target) {
				result = target;
			}

			// Evaluate any dependent observables that were proxied.
			// Do this after the model's observables have been created
			if (!--mappingNesting) {
				while (dependentObservables.length) {
					var DO = dependentObservables.pop();
					if (DO) {
						DO();
						
						// Move this magic property to the underlying dependent observable
						DO.__DO["throttleEvaluation"] = DO["throttleEvaluation"];
					}
				}
			}

			// Save any new mapping options in the view model, so that updateFromJS can use them later.
			result[mappingProperty] = merge(result[mappingProperty], options);

			return result;
		} catch(e) {
			mappingNesting = 0;
			throw e;
		}
	};

	exports.fromJSON = function (jsonString /*, options, target*/ ) {
		var parsed = ko.utils.parseJson(jsonString);
		arguments[0] = parsed;
		return exports.fromJS.apply(this, arguments);
	};

	exports.updateFromJS = function (viewModel) {
		throw new Error("ko.mapping.updateFromJS, use ko.mapping.fromJS instead. Please note that the order of parameters is different!");
	};

	exports.updateFromJSON = function (viewModel) {
		throw new Error("ko.mapping.updateFromJSON, use ko.mapping.fromJSON instead. Please note that the order of parameters is different!");
	};

	exports.toJS = function (rootObject, options) {
		if (!defaultOptions) exports.resetDefaultOptions();

		if (arguments.length == 0) throw new Error("When calling ko.mapping.toJS, pass the object you want to convert.");
		if (exports.getType(defaultOptions.ignore) !== "array") throw new Error("ko.mapping.defaultOptions().ignore should be an array.");
		if (exports.getType(defaultOptions.include) !== "array") throw new Error("ko.mapping.defaultOptions().include should be an array.");
		if (exports.getType(defaultOptions.copy) !== "array") throw new Error("ko.mapping.defaultOptions().copy should be an array.");

		// Merge in the options used in fromJS
		options = fillOptions(options, rootObject[mappingProperty]);

		// We just unwrap everything at every level in the object graph
		return exports.visitModel(rootObject, function (x) {
			return ko.utils.unwrapObservable(x)
		}, options);
	};

	exports.toJSON = function (rootObject, options) {
		var plainJavaScriptObject = exports.toJS(rootObject, options);
		return ko.utils.stringifyJson(plainJavaScriptObject);
	};

	exports.defaultOptions = function () {
		if (arguments.length > 0) {
			defaultOptions = arguments[0];
		} else {
			return defaultOptions;
		}
	};

	exports.resetDefaultOptions = function () {
		defaultOptions = {
			include: _defaultOptions.include.slice(0),
			ignore: _defaultOptions.ignore.slice(0),
			copy: _defaultOptions.copy.slice(0)
		};
	};

	exports.getType = function(x) {
		if ((x) && (typeof (x) === "object")) {
			if (x.constructor === Date) return "date";
			if (x.constructor === Array) return "array";
		}
		return typeof x;
	}

	function fillOptions(rawOptions, otherOptions) {
		var options = merge({}, rawOptions);

		// Move recognized root-level properties into a root namespace
		for (var i = recognizedRootProperties.length - 1; i >= 0; i--) {
			var property = recognizedRootProperties[i];
			
			// Carry on, unless this property is present
			if (!options[property]) continue;
			
			// Move the property into the root namespace
			if (!(options[""] instanceof Object)) options[""] = {};
			options[""][property] = options[property];
			delete options[property];
		}

		if (otherOptions) {
			options.ignore = mergeArrays(otherOptions.ignore, options.ignore);
			options.include = mergeArrays(otherOptions.include, options.include);
			options.copy = mergeArrays(otherOptions.copy, options.copy);
			options.observe = mergeArrays(otherOptions.observe, options.observe);
		}
		options.ignore = mergeArrays(options.ignore, defaultOptions.ignore);
		options.include = mergeArrays(options.include, defaultOptions.include);
		options.copy = mergeArrays(options.copy, defaultOptions.copy);
		options.observe = mergeArrays(options.observe, defaultOptions.observe);

		options.mappedProperties = options.mappedProperties || {};
		options.copiedProperties = options.copiedProperties || {};
		return options;
	}

	function mergeArrays(a, b) {
		if (exports.getType(a) !== "array") {
			if (exports.getType(a) === "undefined") a = [];
			else a = [a];
		}
		if (exports.getType(b) !== "array") {
			if (exports.getType(b) === "undefined") b = [];
			else b = [b];
		}

		return ko.utils.arrayGetDistinctValues(a.concat(b));
	}

	// When using a 'create' callback, we proxy the dependent observable so that it doesn't immediately evaluate on creation.
	// The reason is that the dependent observables in the user-specified callback may contain references to properties that have not been mapped yet.
	function withProxyDependentObservable(dependentObservables, callback) {
		var localDO = ko.dependentObservable;
		ko.dependentObservable = function (read, owner, options) {
			options = options || {};

			if (read && typeof read == "object") { // mirrors condition in knockout implementation of DO's
				options = read;
			}

			var realDeferEvaluation = options.deferEvaluation;

			var isRemoved = false;

			// We wrap the original dependent observable so that we can remove it from the 'dependentObservables' list we need to evaluate after mapping has
			// completed if the user already evaluated the DO themselves in the meantime.
			var wrap = function (DO) {
				// Temporarily revert ko.dependentObservable, since it is used in ko.isWriteableObservable
				var tmp = ko.dependentObservable;
				ko.dependentObservable = realKoDependentObservable;
				var isWriteable = ko.isWriteableObservable(DO);
				ko.dependentObservable = tmp;

				var wrapped = realKoDependentObservable({
					read: function () {
						if (!isRemoved) {
							ko.utils.arrayRemoveItem(dependentObservables, DO);
							isRemoved = true;
						}
						return DO.apply(DO, arguments);
					},
					write: isWriteable && function (val) {
						return DO(val);
					},
					deferEvaluation: true
				});
				if (DEBUG) wrapped._wrapper = true;
				wrapped.__DO = DO;
				return wrapped;
			};
			
			options.deferEvaluation = true; // will either set for just options, or both read/options.
			var realDependentObservable = new realKoDependentObservable(read, owner, options);

			if (!realDeferEvaluation) {
				realDependentObservable = wrap(realDependentObservable);
				dependentObservables.push(realDependentObservable);
			}

			return realDependentObservable;
		}
		ko.dependentObservable.fn = realKoDependentObservable.fn;
		ko.computed = ko.dependentObservable;
		var result = callback();
		ko.dependentObservable = localDO;
		ko.computed = ko.dependentObservable;
		return result;
	}

	function updateViewModel(mappedRootObject, rootObject, options, parentName, parent, parentPropertyName, mappedParent) {
		var isArray = exports.getType(ko.utils.unwrapObservable(rootObject)) === "array";

		parentPropertyName = parentPropertyName || "";

		// If this object was already mapped previously, take the options from there and merge them with our existing ones.
		if (exports.isMapped(mappedRootObject)) {
			var previousMapping = ko.utils.unwrapObservable(mappedRootObject)[mappingProperty];
			options = merge(previousMapping, options);
		}

		var callbackParams = {
			data: rootObject,
			parent: mappedParent || parent
		};

		var hasCreateCallback = function () {
			return options[parentName] && options[parentName].create instanceof Function;
		};

		var createCallback = function (data) {
			return withProxyDependentObservable(dependentObservables, function () {
				
				if (ko.utils.unwrapObservable(parent) instanceof Array) {
					return options[parentName].create({
						data: data || callbackParams.data,
						parent: callbackParams.parent,
						skip: emptyReturn
					});
				} else {
					return options[parentName].create({
						data: data || callbackParams.data,
						parent: callbackParams.parent
					});
				}				
			});
		};

		var hasUpdateCallback = function () {
			return options[parentName] && options[parentName].update instanceof Function;
		};

		var updateCallback = function (obj, data) {
			var params = {
				data: data || callbackParams.data,
				parent: callbackParams.parent,
				target: ko.utils.unwrapObservable(obj)
			};

			if (ko.isWriteableObservable(obj)) {
				params.observable = obj;
			}

			return options[parentName].update(params);
		}

		var alreadyMapped = visitedObjects.get(rootObject);
		if (alreadyMapped) {
			return alreadyMapped;
		}

		parentName = parentName || "";

		if (!isArray) {
			// For atomic types, do a direct update on the observable
			if (!canHaveProperties(rootObject)) {
				switch (exports.getType(rootObject)) {
				case "function":
					if (hasUpdateCallback()) {
						if (ko.isWriteableObservable(rootObject)) {
							rootObject(updateCallback(rootObject));
							mappedRootObject = rootObject;
						} else {
							mappedRootObject = updateCallback(rootObject);
						}
					} else {
						mappedRootObject = rootObject;
					}
					break;
				default:
					if (ko.isWriteableObservable(mappedRootObject)) {
						if (hasUpdateCallback()) {
							var valueToWrite = updateCallback(mappedRootObject);
							mappedRootObject(valueToWrite);
							return valueToWrite;
						} else {
							var valueToWrite = ko.utils.unwrapObservable(rootObject);
							mappedRootObject(valueToWrite);
							return valueToWrite;
						}
					} else {
						var hasCreateOrUpdateCallback = hasCreateCallback() || hasUpdateCallback();
						
						if (hasCreateCallback()) {
							mappedRootObject = createCallback();
						} else {
							mappedRootObject = ko.observable(ko.utils.unwrapObservable(rootObject));
						}

						if (hasUpdateCallback()) {
							mappedRootObject(updateCallback(mappedRootObject));
						}
						
						if (hasCreateOrUpdateCallback) return mappedRootObject;
					}
				}

			} else {
				mappedRootObject = ko.utils.unwrapObservable(mappedRootObject);
				if (!mappedRootObject) {
					if (hasCreateCallback()) {
						var result = createCallback();

						if (hasUpdateCallback()) {
							result = updateCallback(result);
						}

						return result;
					} else {
						if (hasUpdateCallback()) {
							return updateCallback(result);
						}

						mappedRootObject = {};
					}
				}

				if (hasUpdateCallback()) {
					mappedRootObject = updateCallback(mappedRootObject);
				}

				visitedObjects.save(rootObject, mappedRootObject);
				if (hasUpdateCallback()) return mappedRootObject;

				// For non-atomic types, visit all properties and update recursively
				visitPropertiesOrArrayEntries(rootObject, function (indexer) {
					var fullPropertyName = parentPropertyName.length ? parentPropertyName + "." + indexer : indexer;

					if (ko.utils.arrayIndexOf(options.ignore, fullPropertyName) != -1) {
						return;
					}

					if (ko.utils.arrayIndexOf(options.copy, fullPropertyName) != -1) {
						mappedRootObject[indexer] = rootObject[indexer];
						return;
					}

					if(typeof rootObject[indexer] != "object" && typeof rootObject[indexer] != "array" && options.observe.length > 0 && ko.utils.arrayIndexOf(options.observe, fullPropertyName) == -1)
					{
						mappedRootObject[indexer] = rootObject[indexer];
						options.copiedProperties[fullPropertyName] = true;
						return;
					}
					
					// In case we are adding an already mapped property, fill it with the previously mapped property value to prevent recursion.
					// If this is a property that was generated by fromJS, we should use the options specified there
					var prevMappedProperty = visitedObjects.get(rootObject[indexer]);
					var retval = updateViewModel(mappedRootObject[indexer], rootObject[indexer], options, indexer, mappedRootObject, fullPropertyName, mappedRootObject);
					var value = prevMappedProperty || retval;
					
					if(options.observe.length > 0 && ko.utils.arrayIndexOf(options.observe, fullPropertyName) == -1)
					{
						mappedRootObject[indexer] = value();
						options.copiedProperties[fullPropertyName] = true;
						return;
					}
					
					if (ko.isWriteableObservable(mappedRootObject[indexer])) {
						value = ko.utils.unwrapObservable(value);
						if (mappedRootObject[indexer]() !== value) {
							mappedRootObject[indexer](value);
						}
					} else {
						value = mappedRootObject[indexer] === undefined ? value : ko.utils.unwrapObservable(value);
						mappedRootObject[indexer] = value;
					}

					options.mappedProperties[fullPropertyName] = true;
				});
			}
		} else { //mappedRootObject is an array
			var changes = [];

			var hasKeyCallback = false;
			var keyCallback = function (x) {
				return x;
			}
			if (options[parentName] && options[parentName].key) {
				keyCallback = options[parentName].key;
				hasKeyCallback = true;
			}

			if (!ko.isObservable(mappedRootObject)) {
				// When creating the new observable array, also add a bunch of utility functions that take the 'key' of the array items into account.
				mappedRootObject = ko.observableArray([]);

				mappedRootObject.mappedRemove = function (valueOrPredicate) {
					var predicate = typeof valueOrPredicate == "function" ? valueOrPredicate : function (value) {
							return value === keyCallback(valueOrPredicate);
						};
					return mappedRootObject.remove(function (item) {
						return predicate(keyCallback(item));
					});
				}

				mappedRootObject.mappedRemoveAll = function (arrayOfValues) {
					var arrayOfKeys = filterArrayByKey(arrayOfValues, keyCallback);
					return mappedRootObject.remove(function (item) {
						return ko.utils.arrayIndexOf(arrayOfKeys, keyCallback(item)) != -1;
					});
				}

				mappedRootObject.mappedDestroy = function (valueOrPredicate) {
					var predicate = typeof valueOrPredicate == "function" ? valueOrPredicate : function (value) {
							return value === keyCallback(valueOrPredicate);
						};
					return mappedRootObject.destroy(function (item) {
						return predicate(keyCallback(item));
					});
				}

				mappedRootObject.mappedDestroyAll = function (arrayOfValues) {
					var arrayOfKeys = filterArrayByKey(arrayOfValues, keyCallback);
					return mappedRootObject.destroy(function (item) {
						return ko.utils.arrayIndexOf(arrayOfKeys, keyCallback(item)) != -1;
					});
				}

				mappedRootObject.mappedIndexOf = function (item) {
					var keys = filterArrayByKey(mappedRootObject(), keyCallback);
					var key = keyCallback(item);
					return ko.utils.arrayIndexOf(keys, key);
				}

				mappedRootObject.mappedGet = function (item) {
					return mappedRootObject()[mappedRootObject.mappedIndexOf(item)];
				}

				mappedRootObject.mappedCreate = function (value) {
					if (mappedRootObject.mappedIndexOf(value) !== -1) {
						throw new Error("There already is an object with the key that you specified.");
					}

					var item = hasCreateCallback() ? createCallback(value) : value;
					if (hasUpdateCallback()) {
						var newValue = updateCallback(item, value);
						if (ko.isWriteableObservable(item)) {
							item(newValue);
						} else {
							item = newValue;
						}
					}
					mappedRootObject.push(item);
					return item;
				}
			}

			var currentArrayKeys = filterArrayByKey(ko.utils.unwrapObservable(mappedRootObject), keyCallback).sort();
			var newArrayKeys = filterArrayByKey(rootObject, keyCallback);
			if (hasKeyCallback) newArrayKeys.sort();
			var editScript = ko.utils.compareArrays(currentArrayKeys, newArrayKeys);

			var ignoreIndexOf = {};
			
			var i, j;

			var unwrappedRootObject = ko.utils.unwrapObservable(rootObject);
			var itemsByKey = {};
			var optimizedKeys = true;
			for (i = 0, j = unwrappedRootObject.length; i < j; i++) {
				var key = keyCallback(unwrappedRootObject[i]);
				if (key === undefined || key instanceof Object) {
					optimizedKeys = false;
					break;
				}
				itemsByKey[key] = unwrappedRootObject[i];
			}

			var newContents = [];
			var passedOver = 0;
			for (i = 0, j = editScript.length; i < j; i++) {
				var key = editScript[i];
				var mappedItem;
				var fullPropertyName = parentPropertyName + "[" + i + "]";
				switch (key.status) {
				case "added":
					var item = optimizedKeys ? itemsByKey[key.value] : getItemByKey(ko.utils.unwrapObservable(rootObject), key.value, keyCallback);
					mappedItem = updateViewModel(undefined, item, options, parentName, mappedRootObject, fullPropertyName, parent);
					if(!hasCreateCallback()) {
						mappedItem = ko.utils.unwrapObservable(mappedItem);
					}

					var index = ignorableIndexOf(ko.utils.unwrapObservable(rootObject), item, ignoreIndexOf);
					
					if (mappedItem === emptyReturn) {
						passedOver++;
					} else {
						newContents[index - passedOver] = mappedItem;
					}
						
					ignoreIndexOf[index] = true;
					break;
				case "retained":
					var item = optimizedKeys ? itemsByKey[key.value] : getItemByKey(ko.utils.unwrapObservable(rootObject), key.value, keyCallback);
					mappedItem = getItemByKey(mappedRootObject, key.value, keyCallback);
					updateViewModel(mappedItem, item, options, parentName, mappedRootObject, fullPropertyName, parent);

					var index = ignorableIndexOf(ko.utils.unwrapObservable(rootObject), item, ignoreIndexOf);
					newContents[index] = mappedItem;
					ignoreIndexOf[index] = true;
					break;
				case "deleted":
					mappedItem = getItemByKey(mappedRootObject, key.value, keyCallback);
					break;
				}

				changes.push({
					event: key.status,
					item: mappedItem
				});
			}

			mappedRootObject(newContents);

			if (options[parentName] && options[parentName].arrayChanged) {
				ko.utils.arrayForEach(changes, function (change) {
					options[parentName].arrayChanged(change.event, change.item);
				});
			}
		}

		return mappedRootObject;
	}

	function ignorableIndexOf(array, item, ignoreIndices) {
		for (var i = 0, j = array.length; i < j; i++) {
			if (ignoreIndices[i] === true) continue;
			if (array[i] === item) return i;
		}
		return null;
	}

	function mapKey(item, callback) {
		var mappedItem;
		if (callback) mappedItem = callback(item);
		if (exports.getType(mappedItem) === "undefined") mappedItem = item;

		return ko.utils.unwrapObservable(mappedItem);
	}

	function getItemByKey(array, key, callback) {
		array = ko.utils.unwrapObservable(array);
		for (var i = 0, j = array.length; i < j; i++) {
			var item = array[i];
			if (mapKey(item, callback) === key) return item;
		}

		throw new Error("When calling ko.update*, the key '" + key + "' was not found!");
	}

	function filterArrayByKey(array, callback) {
		return ko.utils.arrayMap(ko.utils.unwrapObservable(array), function (item) {
			if (callback) {
				return mapKey(item, callback);
			} else {
				return item;
			}
		});
	}

	function visitPropertiesOrArrayEntries(rootObject, visitorCallback) {
		if (exports.getType(rootObject) === "array") {
			for (var i = 0; i < rootObject.length; i++)
			visitorCallback(i);
		} else {
			for (var propertyName in rootObject)
			visitorCallback(propertyName);
		}
	};

	function canHaveProperties(object) {
		var type = exports.getType(object);
		return ((type === "object") || (type === "array")) && (object !== null);
	}

	// Based on the parentName, this creates a fully classified name of a property

	function getPropertyName(parentName, parent, indexer) {
		var propertyName = parentName || "";
		if (exports.getType(parent) === "array") {
			if (parentName) {
				propertyName += "[" + indexer + "]";
			}
		} else {
			if (parentName) {
				propertyName += ".";
			}
			propertyName += indexer;
		}
		return propertyName;
	}

	exports.visitModel = function (rootObject, callback, options) {
		options = options || {};
		options.visitedObjects = options.visitedObjects || new objectLookup();

		var mappedRootObject;
		var unwrappedRootObject = ko.utils.unwrapObservable(rootObject);

		if (!canHaveProperties(unwrappedRootObject)) {
			return callback(rootObject, options.parentName);
		} else {
			options = fillOptions(options, unwrappedRootObject[mappingProperty]);

			// Only do a callback, but ignore the results
			callback(rootObject, options.parentName);
			mappedRootObject = exports.getType(unwrappedRootObject) === "array" ? [] : {};
		}

		options.visitedObjects.save(rootObject, mappedRootObject);

		var parentName = options.parentName;
		visitPropertiesOrArrayEntries(unwrappedRootObject, function (indexer) {
			if (options.ignore && ko.utils.arrayIndexOf(options.ignore, indexer) != -1) return;

			var propertyValue = unwrappedRootObject[indexer];
			options.parentName = getPropertyName(parentName, unwrappedRootObject, indexer);

			// If we don't want to explicitly copy the unmapped property...
			if (ko.utils.arrayIndexOf(options.copy, indexer) === -1) {
				// ...find out if it's a property we want to explicitly include
				if (ko.utils.arrayIndexOf(options.include, indexer) === -1) {
					// The mapped properties object contains all the properties that were part of the original object.
					// If a property does not exist, and it is not because it is part of an array (e.g. "myProp[3]"), then it should not be unmapped.
				    if (unwrappedRootObject[mappingProperty]
				        && unwrappedRootObject[mappingProperty].mappedProperties && !unwrappedRootObject[mappingProperty].mappedProperties[indexer]
				        && unwrappedRootObject[mappingProperty].copiedProperties && !unwrappedRootObject[mappingProperty].copiedProperties[indexer]
				        && !(exports.getType(unwrappedRootObject) === "array")) {
						return;
					}
				}
			}

			var outputProperty;
			switch (exports.getType(ko.utils.unwrapObservable(propertyValue))) {
			case "object":
			case "array":
			case "undefined":
				var previouslyMappedValue = options.visitedObjects.get(propertyValue);
				mappedRootObject[indexer] = (exports.getType(previouslyMappedValue) !== "undefined") ? previouslyMappedValue : exports.visitModel(propertyValue, callback, options);
				break;
			default:
				mappedRootObject[indexer] = callback(propertyValue, options.parentName);
			}
		});

		return mappedRootObject;
	}

	function simpleObjectLookup() {
		var keys = [];
		var values = [];
		this.save = function (key, value) {
			var existingIndex = ko.utils.arrayIndexOf(keys, key);
			if (existingIndex >= 0) values[existingIndex] = value;
			else {
				keys.push(key);
				values.push(value);
			}
		};
		this.get = function (key) {
			var existingIndex = ko.utils.arrayIndexOf(keys, key);
			var value = (existingIndex >= 0) ? values[existingIndex] : undefined;
			return value;
		};
	};
	
	function objectLookup() {
		var buckets = {};
		
		var findBucket = function(key) {
			var bucketKey;
			try {
				bucketKey = key;//JSON.stringify(key);
			}
			catch (e) {
				bucketKey = "$$$";
			}

			var bucket = buckets[bucketKey];
			if (bucket === undefined) {
				bucket = new simpleObjectLookup();
				buckets[bucketKey] = bucket;
			}
			return bucket;
		};
		
		this.save = function (key, value) {
			findBucket(key).save(key, value);
		};
		this.get = function (key) {
			return findBucket(key).get(key);
		};
	};
}));
}).call(this,typeof global !== "undefined" ? global : typeof self !== "undefined" ? self : typeof window !== "undefined" ? window : {})

},{}],62:[function(require,module,exports){
(function (global){
// Knockout Fast Mapping v0.1
// License: MIT (http://www.opensource.org/licenses/mit-license.php)

(function (factory) {
	// Module systems magic dance.

	if (typeof require === "function" && typeof exports === "object" && typeof module === "object") {
		// CommonJS or Node: hard-coded dependency on "knockout"
		factory((typeof window !== "undefined" ? window['ko'] : typeof global !== "undefined" ? global['ko'] : null), exports);
	} else if (typeof define === "function" && define["amd"]) {
		// AMD anonymous module with hard-coded dependency on "knockout"
		define(["knockout", "exports"], factory);
	} else {
		// <script> tag: use the global `ko` object, attaching a `wrap` property
		factory(ko, ko.wrap = {});
	}
}(function (ko, exports) {
    
    // this function mimics ko.mapping
    exports.fromJS = function(jsObject, computedFunctions)
    {
        reset();
	return wrap(jsObject, computedFunctions);
    }

    // this function unwraps the outer for assigning the result to an observable
    // see https://github.com/SteveSanderson/knockout/issues/517
    exports.updateFromJS = function(observable, jsObject, computedFunctions)
    {
        reset();
	return observable(ko.utils.unwrapObservable(wrap(jsObject, computedFunctions)));
    }

    exports.fromJSON = function (jsonString, computedFunctions) {
	var parsed = ko.utils.parseJson(jsonString);
	arguments[0] = parsed;
	return exports.fromJS.apply(this, computedFunctions);
    };
    
    exports.toJS = function (observable) {
	return unwrap(observable);
    }

    exports.toJSON = function (observable) {
	var plainJavaScriptObject = exports.toJS(observable);
	return ko.utils.stringifyJson(plainJavaScriptObject);
    };

    function typeOf(value) {
	var s = typeof value;
	if (s === 'object') {
            if (value) {
                if (value.constructor == Date)
                    s = 'date';
		else if (Object.prototype.toString.call(value) == '[object Array]')
                    s = 'array';
            } else {
		s = 'null';
            }
	}
	return s;
    }

    // unwrapping
    function unwrapObject(o)
    {
	var t = {};

	for (var k in o)
	{
	    var v = o[k];

	    if (ko.isComputed(v))
		continue;

	    t[k] = unwrap(v);
	}

	return t;
    }

    function unwrapArray(a)
    {
	var r = [];

	if (!a || a.length == 0)
	    return r;
	
	for (var i = 0, l = a.length; i < l; ++i)
	    r.push(unwrap(a[i]));

	return r;
    }

    function unwrap(v)
    {
	var isObservable = ko.isObservable(v);

	if (isObservable)
	{
	    var val = v();

	    return unwrap(val);
	}
	else
	{
	    if (typeOf(v) == "array")
	    {
		return unwrapArray(v);
	    }
	    else if (typeOf(v) == "object")
	    {
		return unwrapObject(v);
	    }
	    else
	    {
		return v;
	    }
	}
    }

    function reset()
    {
        parents = [{obj: null, wrapped: null, lvl: ""}];
    }    
    
    // wrapping

    function wrapObject(o, computedFunctions)
    {
        // check for infinite recursion
        for (var i = 0; i < parents.length; ++i) {
            if (parents[i].obj === o) {
                return parents[i].wrapped;
            }
        }

	var t = {};

	for (var k in o)
	{
	    var v = o[k];

            parents.push({obj: o, wrapped: t, lvl: currentLvl() + "/" + k});

	    t[k] = wrap(v, computedFunctions);

            parents.pop();
	}

	if (computedFunctions && computedFunctions[currentLvl()])
	    t = computedFunctions[currentLvl()](t);

        if (hasES5Plugin())
            ko.track(t);

	return t;
    }

    function wrapArray(a, computedFunctions)
    {
	var r = ko.observableArray();

	if (!a || a.length == 0)
	    return r;

	for (var i = 0, l = a.length; i < l; ++i)
	    r.push(wrap(a[i], computedFunctions));

	return r;
    }

    // a stack, used for two purposes:
    //  - circular reference checking
    //  - computed functions
    var parents;

    function currentLvl()
    {
	return parents[parents.length-1].lvl;
    }

    function wrap(v, computedFunctions)
    {
	if (typeOf(v) == "array")
	{
	    return wrapArray(v, computedFunctions);
	}
	else if (typeOf(v) == "object")
	{
	    return wrapObject(v, computedFunctions);
	}
	else
	{
            if (!hasES5Plugin() && typeof v !== 'function')
            {
	        var t = ko.observable();
	        t(v);
	        return t;
            } else
                return v;
	}
    }

    function hasES5Plugin()
    {
        return ko.track != null;
    }
}));
}).call(this,typeof global !== "undefined" ? global : typeof self !== "undefined" ? self : typeof window !== "undefined" ? window : {})

},{}],63:[function(require,module,exports){
(function (global){
var $ = (typeof window !== "undefined" ? window['$'] : typeof global !== "undefined" ? global['$'] : null);
var HEROCALCULATOR = require('./app/main');
hc = new HEROCALCULATOR();
var lastUpdate = "#DEV_BUILD";
$('#last-update').text(lastUpdate);
hc.init("/media/js/herodata.json","/media/js/itemdata.json","/media/js/unitdata.json", hc.run);
}).call(this,typeof global !== "undefined" ? global : typeof self !== "undefined" ? self : typeof window !== "undefined" ? window : {})

},{"./app/main":42}]},{},[63])
//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJzb3VyY2VzIjpbIm5vZGVfbW9kdWxlcy9icm93c2VyLXBhY2svX3ByZWx1ZGUuanMiLCJub2RlX21vZHVsZXMvYm9vdHN0cmFwL2Rpc3QvanMvbnBtLmpzIiwibm9kZV9tb2R1bGVzL2Jvb3RzdHJhcC9qcy9hZmZpeC5qcyIsIm5vZGVfbW9kdWxlcy9ib290c3RyYXAvanMvYWxlcnQuanMiLCJub2RlX21vZHVsZXMvYm9vdHN0cmFwL2pzL2J1dHRvbi5qcyIsIm5vZGVfbW9kdWxlcy9ib290c3RyYXAvanMvY2Fyb3VzZWwuanMiLCJub2RlX21vZHVsZXMvYm9vdHN0cmFwL2pzL2NvbGxhcHNlLmpzIiwibm9kZV9tb2R1bGVzL2Jvb3RzdHJhcC9qcy9kcm9wZG93bi5qcyIsIm5vZGVfbW9kdWxlcy9ib290c3RyYXAvanMvbW9kYWwuanMiLCJub2RlX21vZHVsZXMvYm9vdHN0cmFwL2pzL3BvcG92ZXIuanMiLCJub2RlX21vZHVsZXMvYm9vdHN0cmFwL2pzL3Njcm9sbHNweS5qcyIsIm5vZGVfbW9kdWxlcy9ib290c3RyYXAvanMvdGFiLmpzIiwibm9kZV9tb2R1bGVzL2Jvb3RzdHJhcC9qcy90b29sdGlwLmpzIiwibm9kZV9tb2R1bGVzL2Jvb3RzdHJhcC9qcy90cmFuc2l0aW9uLmpzIiwibm9kZV9tb2R1bGVzL2pxdWVyeS11aS91aS9kYXRhLmpzIiwibm9kZV9tb2R1bGVzL2pxdWVyeS11aS91aS9kaXNhYmxlLXNlbGVjdGlvbi5qcyIsIm5vZGVfbW9kdWxlcy9qcXVlcnktdWkvdWkvZm9jdXNhYmxlLmpzIiwibm9kZV9tb2R1bGVzL2pxdWVyeS11aS91aS9pZS5qcyIsIm5vZGVfbW9kdWxlcy9qcXVlcnktdWkvdWkva2V5Y29kZS5qcyIsIm5vZGVfbW9kdWxlcy9qcXVlcnktdWkvdWkvcGx1Z2luLmpzIiwibm9kZV9tb2R1bGVzL2pxdWVyeS11aS91aS9wb3NpdGlvbi5qcyIsIm5vZGVfbW9kdWxlcy9qcXVlcnktdWkvdWkvc2FmZS1hY3RpdmUtZWxlbWVudC5qcyIsIm5vZGVfbW9kdWxlcy9qcXVlcnktdWkvdWkvc2FmZS1ibHVyLmpzIiwibm9kZV9tb2R1bGVzL2pxdWVyeS11aS91aS9zY3JvbGwtcGFyZW50LmpzIiwibm9kZV9tb2R1bGVzL2pxdWVyeS11aS91aS90YWJiYWJsZS5qcyIsIm5vZGVfbW9kdWxlcy9qcXVlcnktdWkvdWkvdW5pcXVlLWlkLmpzIiwibm9kZV9tb2R1bGVzL2pxdWVyeS11aS91aS92ZXJzaW9uLmpzIiwibm9kZV9tb2R1bGVzL2pxdWVyeS11aS91aS93aWRnZXQuanMiLCJub2RlX21vZHVsZXMvanF1ZXJ5LXVpL3VpL3dpZGdldHMvYXV0b2NvbXBsZXRlLmpzIiwibm9kZV9tb2R1bGVzL2pxdWVyeS11aS91aS93aWRnZXRzL2J1dHRvbi5qcyIsIm5vZGVfbW9kdWxlcy9qcXVlcnktdWkvdWkvd2lkZ2V0cy9kaWFsb2cuanMiLCJub2RlX21vZHVsZXMvanF1ZXJ5LXVpL3VpL3dpZGdldHMvZHJhZ2dhYmxlLmpzIiwibm9kZV9tb2R1bGVzL2pxdWVyeS11aS91aS93aWRnZXRzL21lbnUuanMiLCJub2RlX21vZHVsZXMvanF1ZXJ5LXVpL3VpL3dpZGdldHMvbW91c2UuanMiLCJub2RlX21vZHVsZXMvanF1ZXJ5LXVpL3VpL3dpZGdldHMvcmVzaXphYmxlLmpzIiwibm9kZV9tb2R1bGVzL2pxdWVyeS11aS91aS93aWRnZXRzL3NwaW5uZXIuanMiLCJ3d3cvanMvYXBwL2hlcm9jYWxjX2J1ZmZzLmFtcGxpZmljYXRpb24ucmVkdWN0aW9uLmpzIiwid3d3L2pzL2FwcC9oZXJvY2FsY19idWlsZGV4cGxvcmVyLmpzIiwid3d3L2pzL2FwcC9oZXJvY2FsY19oZXJvX2RhbWFnZWFtcC5qcyIsInd3dy9qcy9hcHAvaGVyb2NhbGNfa25vY2tvdXQuanMiLCJ3d3cvanMvYXBwL2hlcm92aWV3bW9kZWwuanMiLCJ3d3cvanMvYXBwL2pxdWVyeS11aS5jdXN0b20uanMiLCJ3d3cvanMvYXBwL21haW4uanMiLCJ3d3cvanMvY29tcG9uZW50cy9zaG9wLmpzIiwid3d3L2pzL2hlcm9jYWxjL2hlcm9jYWxjX2FiaWxpdGllcy5qcyIsInd3dy9qcy9oZXJvY2FsYy9oZXJvY2FsY19hYmlsaXR5ZGF0YS5qcyIsInd3dy9qcy9oZXJvY2FsYy9oZXJvY2FsY19idWZmcy5qcyIsInd3dy9qcy9oZXJvY2FsYy9oZXJvY2FsY19jb3JlLmpzIiwid3d3L2pzL2hlcm9jYWxjL2hlcm9jYWxjX2hlcm8uaWxsdXNpb24uanMiLCJ3d3cvanMvaGVyb2NhbGMvaGVyb2NhbGNfaGVyby5qcyIsInd3dy9qcy9oZXJvY2FsYy9oZXJvY2FsY19oZXJvLm1lZXBvLmpzIiwid3d3L2pzL2hlcm9jYWxjL2hlcm9jYWxjX2hlcm9fZGFtYWdlLmpzIiwid3d3L2pzL2hlcm9jYWxjL2hlcm9jYWxjX2ludmVudG9yeS5qcyIsInd3dy9qcy9oZXJvY2FsYy9oZXJvY2FsY19rbm9ja291dC5qcyIsInd3dy9qcy9oZXJvY2FsYy9oZXJvY2FsY190b29sdGlwc19hYmlsaXR5LmpzIiwid3d3L2pzL2hlcm9jYWxjL2hlcm9jYWxjX3Rvb2x0aXBzX2l0ZW0uanMiLCJ3d3cvanMvaGVyb2NhbGMvaGVyb2NhbGNfdW5pdC5qcyIsInd3dy9qcy9oZXJvY2FsYy9tYWluLmpzIiwid3d3L2pzL2hlcm9jYWxjL3BvbHlmaWxsLmpzIiwid3d3L2pzL2xpYi9DaGFydC5taW4uanMiLCJ3d3cvanMvbGliL0NoYXJ0LnNjYXR0ZXIuanMiLCJ3d3cvanMvbGliL2tub2Nrb3V0Lm1hcHBpbmcuanMiLCJ3d3cvanMvbGliL2tub2Nrb3V0LndyYXAuanMiLCJ3d3cvanMvbWFpbi5qcyJdLCJuYW1lcyI6W10sIm1hcHBpbmdzIjoiQUFBQTtBQ0FBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBOztBQ1pBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBOztBQ2xLQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBOztBQzlGQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7O0FDN0hBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBOztBQzdPQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7O0FDcE5BO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBOztBQ3JLQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTs7QUNuVkE7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7O0FDNUdBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7O0FDNUtBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTs7QUMzSkE7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTs7QUN4Z0JBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTs7QUMzREE7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7O0FDdkNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7O0FDOUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBOztBQ3BGQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTs7QUNmQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTs7QUM3Q0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBOztBQzVDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTs7QUM3Z0JBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7O0FDeENBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBOztBQ3JCQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTs7QUM3Q0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBOztBQ25DQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBOztBQ2pEQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7O0FDakJBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTs7QUN6c0JBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7O0FDMXFCQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7O0FDbFlBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBOztBQ2w2QkE7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7O0FDbnVDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBOztBQzlwQkE7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTs7QUNsT0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTs7QUNqckNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTs7QUMvakJBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTs7QUM1SUE7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTs7QUMxWUE7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBOzs7QUNyR0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBOzs7OztBQzFmQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTs7Ozs7QUN2RkE7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBOzs7OztBQ3JEQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTs7OztBQzFwQkE7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7O0FDckJBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7O0FDbDRFQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7O0FDMytHQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7O0FDdE9BO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBOztBQzVTQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7O0FDM1BBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBOztBQ2pqQkE7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTs7QUN0QkE7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBOztBQ3pwQkE7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7OztBQ3I0Q0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBOzs7OztBQ25DQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBOzs7OztBQ2xMQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTs7OztBQ2pJQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7O0FDN1RBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBOztBQ1pBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7O0FDdEJBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7O0FDVkE7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBOzs7QUN6RkE7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTs7Ozs7QUNyeUJBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7Ozs7O0FDaE5BO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQSIsImZpbGUiOiJnZW5lcmF0ZWQuanMiLCJzb3VyY2VSb290IjoiIiwic291cmNlc0NvbnRlbnQiOlsiKGZ1bmN0aW9uIGUodCxuLHIpe2Z1bmN0aW9uIHMobyx1KXtpZighbltvXSl7aWYoIXRbb10pe3ZhciBhPXR5cGVvZiByZXF1aXJlPT1cImZ1bmN0aW9uXCImJnJlcXVpcmU7aWYoIXUmJmEpcmV0dXJuIGEobywhMCk7aWYoaSlyZXR1cm4gaShvLCEwKTt2YXIgZj1uZXcgRXJyb3IoXCJDYW5ub3QgZmluZCBtb2R1bGUgJ1wiK28rXCInXCIpO3Rocm93IGYuY29kZT1cIk1PRFVMRV9OT1RfRk9VTkRcIixmfXZhciBsPW5bb109e2V4cG9ydHM6e319O3Rbb11bMF0uY2FsbChsLmV4cG9ydHMsZnVuY3Rpb24oZSl7dmFyIG49dFtvXVsxXVtlXTtyZXR1cm4gcyhuP246ZSl9LGwsbC5leHBvcnRzLGUsdCxuLHIpfXJldHVybiBuW29dLmV4cG9ydHN9dmFyIGk9dHlwZW9mIHJlcXVpcmU9PVwiZnVuY3Rpb25cIiYmcmVxdWlyZTtmb3IodmFyIG89MDtvPHIubGVuZ3RoO28rKylzKHJbb10pO3JldHVybiBzfSkiLCIvLyBUaGlzIGZpbGUgaXMgYXV0b2dlbmVyYXRlZCB2aWEgdGhlIGBjb21tb25qc2AgR3J1bnQgdGFzay4gWW91IGNhbiByZXF1aXJlKCkgdGhpcyBmaWxlIGluIGEgQ29tbW9uSlMgZW52aXJvbm1lbnQuXG5yZXF1aXJlKCcuLi8uLi9qcy90cmFuc2l0aW9uLmpzJylcbnJlcXVpcmUoJy4uLy4uL2pzL2FsZXJ0LmpzJylcbnJlcXVpcmUoJy4uLy4uL2pzL2J1dHRvbi5qcycpXG5yZXF1aXJlKCcuLi8uLi9qcy9jYXJvdXNlbC5qcycpXG5yZXF1aXJlKCcuLi8uLi9qcy9jb2xsYXBzZS5qcycpXG5yZXF1aXJlKCcuLi8uLi9qcy9kcm9wZG93bi5qcycpXG5yZXF1aXJlKCcuLi8uLi9qcy9tb2RhbC5qcycpXG5yZXF1aXJlKCcuLi8uLi9qcy90b29sdGlwLmpzJylcbnJlcXVpcmUoJy4uLy4uL2pzL3BvcG92ZXIuanMnKVxucmVxdWlyZSgnLi4vLi4vanMvc2Nyb2xsc3B5LmpzJylcbnJlcXVpcmUoJy4uLy4uL2pzL3RhYi5qcycpXG5yZXF1aXJlKCcuLi8uLi9qcy9hZmZpeC5qcycpIiwiLyogPT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09XG4gKiBCb290c3RyYXA6IGFmZml4LmpzIHYzLjMuN1xuICogaHR0cDovL2dldGJvb3RzdHJhcC5jb20vamF2YXNjcmlwdC8jYWZmaXhcbiAqID09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PVxuICogQ29weXJpZ2h0IDIwMTEtMjAxNiBUd2l0dGVyLCBJbmMuXG4gKiBMaWNlbnNlZCB1bmRlciBNSVQgKGh0dHBzOi8vZ2l0aHViLmNvbS90d2JzL2Jvb3RzdHJhcC9ibG9iL21hc3Rlci9MSUNFTlNFKVxuICogPT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09ICovXG5cblxuK2Z1bmN0aW9uICgkKSB7XG4gICd1c2Ugc3RyaWN0JztcblxuICAvLyBBRkZJWCBDTEFTUyBERUZJTklUSU9OXG4gIC8vID09PT09PT09PT09PT09PT09PT09PT1cblxuICB2YXIgQWZmaXggPSBmdW5jdGlvbiAoZWxlbWVudCwgb3B0aW9ucykge1xuICAgIHRoaXMub3B0aW9ucyA9ICQuZXh0ZW5kKHt9LCBBZmZpeC5ERUZBVUxUUywgb3B0aW9ucylcblxuICAgIHRoaXMuJHRhcmdldCA9ICQodGhpcy5vcHRpb25zLnRhcmdldClcbiAgICAgIC5vbignc2Nyb2xsLmJzLmFmZml4LmRhdGEtYXBpJywgJC5wcm94eSh0aGlzLmNoZWNrUG9zaXRpb24sIHRoaXMpKVxuICAgICAgLm9uKCdjbGljay5icy5hZmZpeC5kYXRhLWFwaScsICAkLnByb3h5KHRoaXMuY2hlY2tQb3NpdGlvbldpdGhFdmVudExvb3AsIHRoaXMpKVxuXG4gICAgdGhpcy4kZWxlbWVudCAgICAgPSAkKGVsZW1lbnQpXG4gICAgdGhpcy5hZmZpeGVkICAgICAgPSBudWxsXG4gICAgdGhpcy51bnBpbiAgICAgICAgPSBudWxsXG4gICAgdGhpcy5waW5uZWRPZmZzZXQgPSBudWxsXG5cbiAgICB0aGlzLmNoZWNrUG9zaXRpb24oKVxuICB9XG5cbiAgQWZmaXguVkVSU0lPTiAgPSAnMy4zLjcnXG5cbiAgQWZmaXguUkVTRVQgICAgPSAnYWZmaXggYWZmaXgtdG9wIGFmZml4LWJvdHRvbSdcblxuICBBZmZpeC5ERUZBVUxUUyA9IHtcbiAgICBvZmZzZXQ6IDAsXG4gICAgdGFyZ2V0OiB3aW5kb3dcbiAgfVxuXG4gIEFmZml4LnByb3RvdHlwZS5nZXRTdGF0ZSA9IGZ1bmN0aW9uIChzY3JvbGxIZWlnaHQsIGhlaWdodCwgb2Zmc2V0VG9wLCBvZmZzZXRCb3R0b20pIHtcbiAgICB2YXIgc2Nyb2xsVG9wICAgID0gdGhpcy4kdGFyZ2V0LnNjcm9sbFRvcCgpXG4gICAgdmFyIHBvc2l0aW9uICAgICA9IHRoaXMuJGVsZW1lbnQub2Zmc2V0KClcbiAgICB2YXIgdGFyZ2V0SGVpZ2h0ID0gdGhpcy4kdGFyZ2V0LmhlaWdodCgpXG5cbiAgICBpZiAob2Zmc2V0VG9wICE9IG51bGwgJiYgdGhpcy5hZmZpeGVkID09ICd0b3AnKSByZXR1cm4gc2Nyb2xsVG9wIDwgb2Zmc2V0VG9wID8gJ3RvcCcgOiBmYWxzZVxuXG4gICAgaWYgKHRoaXMuYWZmaXhlZCA9PSAnYm90dG9tJykge1xuICAgICAgaWYgKG9mZnNldFRvcCAhPSBudWxsKSByZXR1cm4gKHNjcm9sbFRvcCArIHRoaXMudW5waW4gPD0gcG9zaXRpb24udG9wKSA/IGZhbHNlIDogJ2JvdHRvbSdcbiAgICAgIHJldHVybiAoc2Nyb2xsVG9wICsgdGFyZ2V0SGVpZ2h0IDw9IHNjcm9sbEhlaWdodCAtIG9mZnNldEJvdHRvbSkgPyBmYWxzZSA6ICdib3R0b20nXG4gICAgfVxuXG4gICAgdmFyIGluaXRpYWxpemluZyAgID0gdGhpcy5hZmZpeGVkID09IG51bGxcbiAgICB2YXIgY29sbGlkZXJUb3AgICAgPSBpbml0aWFsaXppbmcgPyBzY3JvbGxUb3AgOiBwb3NpdGlvbi50b3BcbiAgICB2YXIgY29sbGlkZXJIZWlnaHQgPSBpbml0aWFsaXppbmcgPyB0YXJnZXRIZWlnaHQgOiBoZWlnaHRcblxuICAgIGlmIChvZmZzZXRUb3AgIT0gbnVsbCAmJiBzY3JvbGxUb3AgPD0gb2Zmc2V0VG9wKSByZXR1cm4gJ3RvcCdcbiAgICBpZiAob2Zmc2V0Qm90dG9tICE9IG51bGwgJiYgKGNvbGxpZGVyVG9wICsgY29sbGlkZXJIZWlnaHQgPj0gc2Nyb2xsSGVpZ2h0IC0gb2Zmc2V0Qm90dG9tKSkgcmV0dXJuICdib3R0b20nXG5cbiAgICByZXR1cm4gZmFsc2VcbiAgfVxuXG4gIEFmZml4LnByb3RvdHlwZS5nZXRQaW5uZWRPZmZzZXQgPSBmdW5jdGlvbiAoKSB7XG4gICAgaWYgKHRoaXMucGlubmVkT2Zmc2V0KSByZXR1cm4gdGhpcy5waW5uZWRPZmZzZXRcbiAgICB0aGlzLiRlbGVtZW50LnJlbW92ZUNsYXNzKEFmZml4LlJFU0VUKS5hZGRDbGFzcygnYWZmaXgnKVxuICAgIHZhciBzY3JvbGxUb3AgPSB0aGlzLiR0YXJnZXQuc2Nyb2xsVG9wKClcbiAgICB2YXIgcG9zaXRpb24gID0gdGhpcy4kZWxlbWVudC5vZmZzZXQoKVxuICAgIHJldHVybiAodGhpcy5waW5uZWRPZmZzZXQgPSBwb3NpdGlvbi50b3AgLSBzY3JvbGxUb3ApXG4gIH1cblxuICBBZmZpeC5wcm90b3R5cGUuY2hlY2tQb3NpdGlvbldpdGhFdmVudExvb3AgPSBmdW5jdGlvbiAoKSB7XG4gICAgc2V0VGltZW91dCgkLnByb3h5KHRoaXMuY2hlY2tQb3NpdGlvbiwgdGhpcyksIDEpXG4gIH1cblxuICBBZmZpeC5wcm90b3R5cGUuY2hlY2tQb3NpdGlvbiA9IGZ1bmN0aW9uICgpIHtcbiAgICBpZiAoIXRoaXMuJGVsZW1lbnQuaXMoJzp2aXNpYmxlJykpIHJldHVyblxuXG4gICAgdmFyIGhlaWdodCAgICAgICA9IHRoaXMuJGVsZW1lbnQuaGVpZ2h0KClcbiAgICB2YXIgb2Zmc2V0ICAgICAgID0gdGhpcy5vcHRpb25zLm9mZnNldFxuICAgIHZhciBvZmZzZXRUb3AgICAgPSBvZmZzZXQudG9wXG4gICAgdmFyIG9mZnNldEJvdHRvbSA9IG9mZnNldC5ib3R0b21cbiAgICB2YXIgc2Nyb2xsSGVpZ2h0ID0gTWF0aC5tYXgoJChkb2N1bWVudCkuaGVpZ2h0KCksICQoZG9jdW1lbnQuYm9keSkuaGVpZ2h0KCkpXG5cbiAgICBpZiAodHlwZW9mIG9mZnNldCAhPSAnb2JqZWN0JykgICAgICAgICBvZmZzZXRCb3R0b20gPSBvZmZzZXRUb3AgPSBvZmZzZXRcbiAgICBpZiAodHlwZW9mIG9mZnNldFRvcCA9PSAnZnVuY3Rpb24nKSAgICBvZmZzZXRUb3AgICAgPSBvZmZzZXQudG9wKHRoaXMuJGVsZW1lbnQpXG4gICAgaWYgKHR5cGVvZiBvZmZzZXRCb3R0b20gPT0gJ2Z1bmN0aW9uJykgb2Zmc2V0Qm90dG9tID0gb2Zmc2V0LmJvdHRvbSh0aGlzLiRlbGVtZW50KVxuXG4gICAgdmFyIGFmZml4ID0gdGhpcy5nZXRTdGF0ZShzY3JvbGxIZWlnaHQsIGhlaWdodCwgb2Zmc2V0VG9wLCBvZmZzZXRCb3R0b20pXG5cbiAgICBpZiAodGhpcy5hZmZpeGVkICE9IGFmZml4KSB7XG4gICAgICBpZiAodGhpcy51bnBpbiAhPSBudWxsKSB0aGlzLiRlbGVtZW50LmNzcygndG9wJywgJycpXG5cbiAgICAgIHZhciBhZmZpeFR5cGUgPSAnYWZmaXgnICsgKGFmZml4ID8gJy0nICsgYWZmaXggOiAnJylcbiAgICAgIHZhciBlICAgICAgICAgPSAkLkV2ZW50KGFmZml4VHlwZSArICcuYnMuYWZmaXgnKVxuXG4gICAgICB0aGlzLiRlbGVtZW50LnRyaWdnZXIoZSlcblxuICAgICAgaWYgKGUuaXNEZWZhdWx0UHJldmVudGVkKCkpIHJldHVyblxuXG4gICAgICB0aGlzLmFmZml4ZWQgPSBhZmZpeFxuICAgICAgdGhpcy51bnBpbiA9IGFmZml4ID09ICdib3R0b20nID8gdGhpcy5nZXRQaW5uZWRPZmZzZXQoKSA6IG51bGxcblxuICAgICAgdGhpcy4kZWxlbWVudFxuICAgICAgICAucmVtb3ZlQ2xhc3MoQWZmaXguUkVTRVQpXG4gICAgICAgIC5hZGRDbGFzcyhhZmZpeFR5cGUpXG4gICAgICAgIC50cmlnZ2VyKGFmZml4VHlwZS5yZXBsYWNlKCdhZmZpeCcsICdhZmZpeGVkJykgKyAnLmJzLmFmZml4JylcbiAgICB9XG5cbiAgICBpZiAoYWZmaXggPT0gJ2JvdHRvbScpIHtcbiAgICAgIHRoaXMuJGVsZW1lbnQub2Zmc2V0KHtcbiAgICAgICAgdG9wOiBzY3JvbGxIZWlnaHQgLSBoZWlnaHQgLSBvZmZzZXRCb3R0b21cbiAgICAgIH0pXG4gICAgfVxuICB9XG5cblxuICAvLyBBRkZJWCBQTFVHSU4gREVGSU5JVElPTlxuICAvLyA9PT09PT09PT09PT09PT09PT09PT09PVxuXG4gIGZ1bmN0aW9uIFBsdWdpbihvcHRpb24pIHtcbiAgICByZXR1cm4gdGhpcy5lYWNoKGZ1bmN0aW9uICgpIHtcbiAgICAgIHZhciAkdGhpcyAgID0gJCh0aGlzKVxuICAgICAgdmFyIGRhdGEgICAgPSAkdGhpcy5kYXRhKCdicy5hZmZpeCcpXG4gICAgICB2YXIgb3B0aW9ucyA9IHR5cGVvZiBvcHRpb24gPT0gJ29iamVjdCcgJiYgb3B0aW9uXG5cbiAgICAgIGlmICghZGF0YSkgJHRoaXMuZGF0YSgnYnMuYWZmaXgnLCAoZGF0YSA9IG5ldyBBZmZpeCh0aGlzLCBvcHRpb25zKSkpXG4gICAgICBpZiAodHlwZW9mIG9wdGlvbiA9PSAnc3RyaW5nJykgZGF0YVtvcHRpb25dKClcbiAgICB9KVxuICB9XG5cbiAgdmFyIG9sZCA9ICQuZm4uYWZmaXhcblxuICAkLmZuLmFmZml4ICAgICAgICAgICAgID0gUGx1Z2luXG4gICQuZm4uYWZmaXguQ29uc3RydWN0b3IgPSBBZmZpeFxuXG5cbiAgLy8gQUZGSVggTk8gQ09ORkxJQ1RcbiAgLy8gPT09PT09PT09PT09PT09PT1cblxuICAkLmZuLmFmZml4Lm5vQ29uZmxpY3QgPSBmdW5jdGlvbiAoKSB7XG4gICAgJC5mbi5hZmZpeCA9IG9sZFxuICAgIHJldHVybiB0aGlzXG4gIH1cblxuXG4gIC8vIEFGRklYIERBVEEtQVBJXG4gIC8vID09PT09PT09PT09PT09XG5cbiAgJCh3aW5kb3cpLm9uKCdsb2FkJywgZnVuY3Rpb24gKCkge1xuICAgICQoJ1tkYXRhLXNweT1cImFmZml4XCJdJykuZWFjaChmdW5jdGlvbiAoKSB7XG4gICAgICB2YXIgJHNweSA9ICQodGhpcylcbiAgICAgIHZhciBkYXRhID0gJHNweS5kYXRhKClcblxuICAgICAgZGF0YS5vZmZzZXQgPSBkYXRhLm9mZnNldCB8fCB7fVxuXG4gICAgICBpZiAoZGF0YS5vZmZzZXRCb3R0b20gIT0gbnVsbCkgZGF0YS5vZmZzZXQuYm90dG9tID0gZGF0YS5vZmZzZXRCb3R0b21cbiAgICAgIGlmIChkYXRhLm9mZnNldFRvcCAgICAhPSBudWxsKSBkYXRhLm9mZnNldC50b3AgICAgPSBkYXRhLm9mZnNldFRvcFxuXG4gICAgICBQbHVnaW4uY2FsbCgkc3B5LCBkYXRhKVxuICAgIH0pXG4gIH0pXG5cbn0oalF1ZXJ5KTtcbiIsIi8qID09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PVxuICogQm9vdHN0cmFwOiBhbGVydC5qcyB2My4zLjdcbiAqIGh0dHA6Ly9nZXRib290c3RyYXAuY29tL2phdmFzY3JpcHQvI2FsZXJ0c1xuICogPT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09XG4gKiBDb3B5cmlnaHQgMjAxMS0yMDE2IFR3aXR0ZXIsIEluYy5cbiAqIExpY2Vuc2VkIHVuZGVyIE1JVCAoaHR0cHM6Ly9naXRodWIuY29tL3R3YnMvYm9vdHN0cmFwL2Jsb2IvbWFzdGVyL0xJQ0VOU0UpXG4gKiA9PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT0gKi9cblxuXG4rZnVuY3Rpb24gKCQpIHtcbiAgJ3VzZSBzdHJpY3QnO1xuXG4gIC8vIEFMRVJUIENMQVNTIERFRklOSVRJT05cbiAgLy8gPT09PT09PT09PT09PT09PT09PT09PVxuXG4gIHZhciBkaXNtaXNzID0gJ1tkYXRhLWRpc21pc3M9XCJhbGVydFwiXSdcbiAgdmFyIEFsZXJ0ICAgPSBmdW5jdGlvbiAoZWwpIHtcbiAgICAkKGVsKS5vbignY2xpY2snLCBkaXNtaXNzLCB0aGlzLmNsb3NlKVxuICB9XG5cbiAgQWxlcnQuVkVSU0lPTiA9ICczLjMuNydcblxuICBBbGVydC5UUkFOU0lUSU9OX0RVUkFUSU9OID0gMTUwXG5cbiAgQWxlcnQucHJvdG90eXBlLmNsb3NlID0gZnVuY3Rpb24gKGUpIHtcbiAgICB2YXIgJHRoaXMgICAgPSAkKHRoaXMpXG4gICAgdmFyIHNlbGVjdG9yID0gJHRoaXMuYXR0cignZGF0YS10YXJnZXQnKVxuXG4gICAgaWYgKCFzZWxlY3Rvcikge1xuICAgICAgc2VsZWN0b3IgPSAkdGhpcy5hdHRyKCdocmVmJylcbiAgICAgIHNlbGVjdG9yID0gc2VsZWN0b3IgJiYgc2VsZWN0b3IucmVwbGFjZSgvLiooPz0jW15cXHNdKiQpLywgJycpIC8vIHN0cmlwIGZvciBpZTdcbiAgICB9XG5cbiAgICB2YXIgJHBhcmVudCA9ICQoc2VsZWN0b3IgPT09ICcjJyA/IFtdIDogc2VsZWN0b3IpXG5cbiAgICBpZiAoZSkgZS5wcmV2ZW50RGVmYXVsdCgpXG5cbiAgICBpZiAoISRwYXJlbnQubGVuZ3RoKSB7XG4gICAgICAkcGFyZW50ID0gJHRoaXMuY2xvc2VzdCgnLmFsZXJ0JylcbiAgICB9XG5cbiAgICAkcGFyZW50LnRyaWdnZXIoZSA9ICQuRXZlbnQoJ2Nsb3NlLmJzLmFsZXJ0JykpXG5cbiAgICBpZiAoZS5pc0RlZmF1bHRQcmV2ZW50ZWQoKSkgcmV0dXJuXG5cbiAgICAkcGFyZW50LnJlbW92ZUNsYXNzKCdpbicpXG5cbiAgICBmdW5jdGlvbiByZW1vdmVFbGVtZW50KCkge1xuICAgICAgLy8gZGV0YWNoIGZyb20gcGFyZW50LCBmaXJlIGV2ZW50IHRoZW4gY2xlYW4gdXAgZGF0YVxuICAgICAgJHBhcmVudC5kZXRhY2goKS50cmlnZ2VyKCdjbG9zZWQuYnMuYWxlcnQnKS5yZW1vdmUoKVxuICAgIH1cblxuICAgICQuc3VwcG9ydC50cmFuc2l0aW9uICYmICRwYXJlbnQuaGFzQ2xhc3MoJ2ZhZGUnKSA/XG4gICAgICAkcGFyZW50XG4gICAgICAgIC5vbmUoJ2JzVHJhbnNpdGlvbkVuZCcsIHJlbW92ZUVsZW1lbnQpXG4gICAgICAgIC5lbXVsYXRlVHJhbnNpdGlvbkVuZChBbGVydC5UUkFOU0lUSU9OX0RVUkFUSU9OKSA6XG4gICAgICByZW1vdmVFbGVtZW50KClcbiAgfVxuXG5cbiAgLy8gQUxFUlQgUExVR0lOIERFRklOSVRJT05cbiAgLy8gPT09PT09PT09PT09PT09PT09PT09PT1cblxuICBmdW5jdGlvbiBQbHVnaW4ob3B0aW9uKSB7XG4gICAgcmV0dXJuIHRoaXMuZWFjaChmdW5jdGlvbiAoKSB7XG4gICAgICB2YXIgJHRoaXMgPSAkKHRoaXMpXG4gICAgICB2YXIgZGF0YSAgPSAkdGhpcy5kYXRhKCdicy5hbGVydCcpXG5cbiAgICAgIGlmICghZGF0YSkgJHRoaXMuZGF0YSgnYnMuYWxlcnQnLCAoZGF0YSA9IG5ldyBBbGVydCh0aGlzKSkpXG4gICAgICBpZiAodHlwZW9mIG9wdGlvbiA9PSAnc3RyaW5nJykgZGF0YVtvcHRpb25dLmNhbGwoJHRoaXMpXG4gICAgfSlcbiAgfVxuXG4gIHZhciBvbGQgPSAkLmZuLmFsZXJ0XG5cbiAgJC5mbi5hbGVydCAgICAgICAgICAgICA9IFBsdWdpblxuICAkLmZuLmFsZXJ0LkNvbnN0cnVjdG9yID0gQWxlcnRcblxuXG4gIC8vIEFMRVJUIE5PIENPTkZMSUNUXG4gIC8vID09PT09PT09PT09PT09PT09XG5cbiAgJC5mbi5hbGVydC5ub0NvbmZsaWN0ID0gZnVuY3Rpb24gKCkge1xuICAgICQuZm4uYWxlcnQgPSBvbGRcbiAgICByZXR1cm4gdGhpc1xuICB9XG5cblxuICAvLyBBTEVSVCBEQVRBLUFQSVxuICAvLyA9PT09PT09PT09PT09PVxuXG4gICQoZG9jdW1lbnQpLm9uKCdjbGljay5icy5hbGVydC5kYXRhLWFwaScsIGRpc21pc3MsIEFsZXJ0LnByb3RvdHlwZS5jbG9zZSlcblxufShqUXVlcnkpO1xuIiwiLyogPT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09XG4gKiBCb290c3RyYXA6IGJ1dHRvbi5qcyB2My4zLjdcbiAqIGh0dHA6Ly9nZXRib290c3RyYXAuY29tL2phdmFzY3JpcHQvI2J1dHRvbnNcbiAqID09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PVxuICogQ29weXJpZ2h0IDIwMTEtMjAxNiBUd2l0dGVyLCBJbmMuXG4gKiBMaWNlbnNlZCB1bmRlciBNSVQgKGh0dHBzOi8vZ2l0aHViLmNvbS90d2JzL2Jvb3RzdHJhcC9ibG9iL21hc3Rlci9MSUNFTlNFKVxuICogPT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09ICovXG5cblxuK2Z1bmN0aW9uICgkKSB7XG4gICd1c2Ugc3RyaWN0JztcblxuICAvLyBCVVRUT04gUFVCTElDIENMQVNTIERFRklOSVRJT05cbiAgLy8gPT09PT09PT09PT09PT09PT09PT09PT09PT09PT09XG5cbiAgdmFyIEJ1dHRvbiA9IGZ1bmN0aW9uIChlbGVtZW50LCBvcHRpb25zKSB7XG4gICAgdGhpcy4kZWxlbWVudCAgPSAkKGVsZW1lbnQpXG4gICAgdGhpcy5vcHRpb25zICAgPSAkLmV4dGVuZCh7fSwgQnV0dG9uLkRFRkFVTFRTLCBvcHRpb25zKVxuICAgIHRoaXMuaXNMb2FkaW5nID0gZmFsc2VcbiAgfVxuXG4gIEJ1dHRvbi5WRVJTSU9OICA9ICczLjMuNydcblxuICBCdXR0b24uREVGQVVMVFMgPSB7XG4gICAgbG9hZGluZ1RleHQ6ICdsb2FkaW5nLi4uJ1xuICB9XG5cbiAgQnV0dG9uLnByb3RvdHlwZS5zZXRTdGF0ZSA9IGZ1bmN0aW9uIChzdGF0ZSkge1xuICAgIHZhciBkICAgID0gJ2Rpc2FibGVkJ1xuICAgIHZhciAkZWwgID0gdGhpcy4kZWxlbWVudFxuICAgIHZhciB2YWwgID0gJGVsLmlzKCdpbnB1dCcpID8gJ3ZhbCcgOiAnaHRtbCdcbiAgICB2YXIgZGF0YSA9ICRlbC5kYXRhKClcblxuICAgIHN0YXRlICs9ICdUZXh0J1xuXG4gICAgaWYgKGRhdGEucmVzZXRUZXh0ID09IG51bGwpICRlbC5kYXRhKCdyZXNldFRleHQnLCAkZWxbdmFsXSgpKVxuXG4gICAgLy8gcHVzaCB0byBldmVudCBsb29wIHRvIGFsbG93IGZvcm1zIHRvIHN1Ym1pdFxuICAgIHNldFRpbWVvdXQoJC5wcm94eShmdW5jdGlvbiAoKSB7XG4gICAgICAkZWxbdmFsXShkYXRhW3N0YXRlXSA9PSBudWxsID8gdGhpcy5vcHRpb25zW3N0YXRlXSA6IGRhdGFbc3RhdGVdKVxuXG4gICAgICBpZiAoc3RhdGUgPT0gJ2xvYWRpbmdUZXh0Jykge1xuICAgICAgICB0aGlzLmlzTG9hZGluZyA9IHRydWVcbiAgICAgICAgJGVsLmFkZENsYXNzKGQpLmF0dHIoZCwgZCkucHJvcChkLCB0cnVlKVxuICAgICAgfSBlbHNlIGlmICh0aGlzLmlzTG9hZGluZykge1xuICAgICAgICB0aGlzLmlzTG9hZGluZyA9IGZhbHNlXG4gICAgICAgICRlbC5yZW1vdmVDbGFzcyhkKS5yZW1vdmVBdHRyKGQpLnByb3AoZCwgZmFsc2UpXG4gICAgICB9XG4gICAgfSwgdGhpcyksIDApXG4gIH1cblxuICBCdXR0b24ucHJvdG90eXBlLnRvZ2dsZSA9IGZ1bmN0aW9uICgpIHtcbiAgICB2YXIgY2hhbmdlZCA9IHRydWVcbiAgICB2YXIgJHBhcmVudCA9IHRoaXMuJGVsZW1lbnQuY2xvc2VzdCgnW2RhdGEtdG9nZ2xlPVwiYnV0dG9uc1wiXScpXG5cbiAgICBpZiAoJHBhcmVudC5sZW5ndGgpIHtcbiAgICAgIHZhciAkaW5wdXQgPSB0aGlzLiRlbGVtZW50LmZpbmQoJ2lucHV0JylcbiAgICAgIGlmICgkaW5wdXQucHJvcCgndHlwZScpID09ICdyYWRpbycpIHtcbiAgICAgICAgaWYgKCRpbnB1dC5wcm9wKCdjaGVja2VkJykpIGNoYW5nZWQgPSBmYWxzZVxuICAgICAgICAkcGFyZW50LmZpbmQoJy5hY3RpdmUnKS5yZW1vdmVDbGFzcygnYWN0aXZlJylcbiAgICAgICAgdGhpcy4kZWxlbWVudC5hZGRDbGFzcygnYWN0aXZlJylcbiAgICAgIH0gZWxzZSBpZiAoJGlucHV0LnByb3AoJ3R5cGUnKSA9PSAnY2hlY2tib3gnKSB7XG4gICAgICAgIGlmICgoJGlucHV0LnByb3AoJ2NoZWNrZWQnKSkgIT09IHRoaXMuJGVsZW1lbnQuaGFzQ2xhc3MoJ2FjdGl2ZScpKSBjaGFuZ2VkID0gZmFsc2VcbiAgICAgICAgdGhpcy4kZWxlbWVudC50b2dnbGVDbGFzcygnYWN0aXZlJylcbiAgICAgIH1cbiAgICAgICRpbnB1dC5wcm9wKCdjaGVja2VkJywgdGhpcy4kZWxlbWVudC5oYXNDbGFzcygnYWN0aXZlJykpXG4gICAgICBpZiAoY2hhbmdlZCkgJGlucHV0LnRyaWdnZXIoJ2NoYW5nZScpXG4gICAgfSBlbHNlIHtcbiAgICAgIHRoaXMuJGVsZW1lbnQuYXR0cignYXJpYS1wcmVzc2VkJywgIXRoaXMuJGVsZW1lbnQuaGFzQ2xhc3MoJ2FjdGl2ZScpKVxuICAgICAgdGhpcy4kZWxlbWVudC50b2dnbGVDbGFzcygnYWN0aXZlJylcbiAgICB9XG4gIH1cblxuXG4gIC8vIEJVVFRPTiBQTFVHSU4gREVGSU5JVElPTlxuICAvLyA9PT09PT09PT09PT09PT09PT09PT09PT1cblxuICBmdW5jdGlvbiBQbHVnaW4ob3B0aW9uKSB7XG4gICAgcmV0dXJuIHRoaXMuZWFjaChmdW5jdGlvbiAoKSB7XG4gICAgICB2YXIgJHRoaXMgICA9ICQodGhpcylcbiAgICAgIHZhciBkYXRhICAgID0gJHRoaXMuZGF0YSgnYnMuYnV0dG9uJylcbiAgICAgIHZhciBvcHRpb25zID0gdHlwZW9mIG9wdGlvbiA9PSAnb2JqZWN0JyAmJiBvcHRpb25cblxuICAgICAgaWYgKCFkYXRhKSAkdGhpcy5kYXRhKCdicy5idXR0b24nLCAoZGF0YSA9IG5ldyBCdXR0b24odGhpcywgb3B0aW9ucykpKVxuXG4gICAgICBpZiAob3B0aW9uID09ICd0b2dnbGUnKSBkYXRhLnRvZ2dsZSgpXG4gICAgICBlbHNlIGlmIChvcHRpb24pIGRhdGEuc2V0U3RhdGUob3B0aW9uKVxuICAgIH0pXG4gIH1cblxuICB2YXIgb2xkID0gJC5mbi5idXR0b25cblxuICAkLmZuLmJ1dHRvbiAgICAgICAgICAgICA9IFBsdWdpblxuICAkLmZuLmJ1dHRvbi5Db25zdHJ1Y3RvciA9IEJ1dHRvblxuXG5cbiAgLy8gQlVUVE9OIE5PIENPTkZMSUNUXG4gIC8vID09PT09PT09PT09PT09PT09PVxuXG4gICQuZm4uYnV0dG9uLm5vQ29uZmxpY3QgPSBmdW5jdGlvbiAoKSB7XG4gICAgJC5mbi5idXR0b24gPSBvbGRcbiAgICByZXR1cm4gdGhpc1xuICB9XG5cblxuICAvLyBCVVRUT04gREFUQS1BUElcbiAgLy8gPT09PT09PT09PT09PT09XG5cbiAgJChkb2N1bWVudClcbiAgICAub24oJ2NsaWNrLmJzLmJ1dHRvbi5kYXRhLWFwaScsICdbZGF0YS10b2dnbGVePVwiYnV0dG9uXCJdJywgZnVuY3Rpb24gKGUpIHtcbiAgICAgIHZhciAkYnRuID0gJChlLnRhcmdldCkuY2xvc2VzdCgnLmJ0bicpXG4gICAgICBQbHVnaW4uY2FsbCgkYnRuLCAndG9nZ2xlJylcbiAgICAgIGlmICghKCQoZS50YXJnZXQpLmlzKCdpbnB1dFt0eXBlPVwicmFkaW9cIl0sIGlucHV0W3R5cGU9XCJjaGVja2JveFwiXScpKSkge1xuICAgICAgICAvLyBQcmV2ZW50IGRvdWJsZSBjbGljayBvbiByYWRpb3MsIGFuZCB0aGUgZG91YmxlIHNlbGVjdGlvbnMgKHNvIGNhbmNlbGxhdGlvbikgb24gY2hlY2tib3hlc1xuICAgICAgICBlLnByZXZlbnREZWZhdWx0KClcbiAgICAgICAgLy8gVGhlIHRhcmdldCBjb21wb25lbnQgc3RpbGwgcmVjZWl2ZSB0aGUgZm9jdXNcbiAgICAgICAgaWYgKCRidG4uaXMoJ2lucHV0LGJ1dHRvbicpKSAkYnRuLnRyaWdnZXIoJ2ZvY3VzJylcbiAgICAgICAgZWxzZSAkYnRuLmZpbmQoJ2lucHV0OnZpc2libGUsYnV0dG9uOnZpc2libGUnKS5maXJzdCgpLnRyaWdnZXIoJ2ZvY3VzJylcbiAgICAgIH1cbiAgICB9KVxuICAgIC5vbignZm9jdXMuYnMuYnV0dG9uLmRhdGEtYXBpIGJsdXIuYnMuYnV0dG9uLmRhdGEtYXBpJywgJ1tkYXRhLXRvZ2dsZV49XCJidXR0b25cIl0nLCBmdW5jdGlvbiAoZSkge1xuICAgICAgJChlLnRhcmdldCkuY2xvc2VzdCgnLmJ0bicpLnRvZ2dsZUNsYXNzKCdmb2N1cycsIC9eZm9jdXMoaW4pPyQvLnRlc3QoZS50eXBlKSlcbiAgICB9KVxuXG59KGpRdWVyeSk7XG4iLCIvKiA9PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT1cbiAqIEJvb3RzdHJhcDogY2Fyb3VzZWwuanMgdjMuMy43XG4gKiBodHRwOi8vZ2V0Ym9vdHN0cmFwLmNvbS9qYXZhc2NyaXB0LyNjYXJvdXNlbFxuICogPT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09XG4gKiBDb3B5cmlnaHQgMjAxMS0yMDE2IFR3aXR0ZXIsIEluYy5cbiAqIExpY2Vuc2VkIHVuZGVyIE1JVCAoaHR0cHM6Ly9naXRodWIuY29tL3R3YnMvYm9vdHN0cmFwL2Jsb2IvbWFzdGVyL0xJQ0VOU0UpXG4gKiA9PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT0gKi9cblxuXG4rZnVuY3Rpb24gKCQpIHtcbiAgJ3VzZSBzdHJpY3QnO1xuXG4gIC8vIENBUk9VU0VMIENMQVNTIERFRklOSVRJT05cbiAgLy8gPT09PT09PT09PT09PT09PT09PT09PT09PVxuXG4gIHZhciBDYXJvdXNlbCA9IGZ1bmN0aW9uIChlbGVtZW50LCBvcHRpb25zKSB7XG4gICAgdGhpcy4kZWxlbWVudCAgICA9ICQoZWxlbWVudClcbiAgICB0aGlzLiRpbmRpY2F0b3JzID0gdGhpcy4kZWxlbWVudC5maW5kKCcuY2Fyb3VzZWwtaW5kaWNhdG9ycycpXG4gICAgdGhpcy5vcHRpb25zICAgICA9IG9wdGlvbnNcbiAgICB0aGlzLnBhdXNlZCAgICAgID0gbnVsbFxuICAgIHRoaXMuc2xpZGluZyAgICAgPSBudWxsXG4gICAgdGhpcy5pbnRlcnZhbCAgICA9IG51bGxcbiAgICB0aGlzLiRhY3RpdmUgICAgID0gbnVsbFxuICAgIHRoaXMuJGl0ZW1zICAgICAgPSBudWxsXG5cbiAgICB0aGlzLm9wdGlvbnMua2V5Ym9hcmQgJiYgdGhpcy4kZWxlbWVudC5vbigna2V5ZG93bi5icy5jYXJvdXNlbCcsICQucHJveHkodGhpcy5rZXlkb3duLCB0aGlzKSlcblxuICAgIHRoaXMub3B0aW9ucy5wYXVzZSA9PSAnaG92ZXInICYmICEoJ29udG91Y2hzdGFydCcgaW4gZG9jdW1lbnQuZG9jdW1lbnRFbGVtZW50KSAmJiB0aGlzLiRlbGVtZW50XG4gICAgICAub24oJ21vdXNlZW50ZXIuYnMuY2Fyb3VzZWwnLCAkLnByb3h5KHRoaXMucGF1c2UsIHRoaXMpKVxuICAgICAgLm9uKCdtb3VzZWxlYXZlLmJzLmNhcm91c2VsJywgJC5wcm94eSh0aGlzLmN5Y2xlLCB0aGlzKSlcbiAgfVxuXG4gIENhcm91c2VsLlZFUlNJT04gID0gJzMuMy43J1xuXG4gIENhcm91c2VsLlRSQU5TSVRJT05fRFVSQVRJT04gPSA2MDBcblxuICBDYXJvdXNlbC5ERUZBVUxUUyA9IHtcbiAgICBpbnRlcnZhbDogNTAwMCxcbiAgICBwYXVzZTogJ2hvdmVyJyxcbiAgICB3cmFwOiB0cnVlLFxuICAgIGtleWJvYXJkOiB0cnVlXG4gIH1cblxuICBDYXJvdXNlbC5wcm90b3R5cGUua2V5ZG93biA9IGZ1bmN0aW9uIChlKSB7XG4gICAgaWYgKC9pbnB1dHx0ZXh0YXJlYS9pLnRlc3QoZS50YXJnZXQudGFnTmFtZSkpIHJldHVyblxuICAgIHN3aXRjaCAoZS53aGljaCkge1xuICAgICAgY2FzZSAzNzogdGhpcy5wcmV2KCk7IGJyZWFrXG4gICAgICBjYXNlIDM5OiB0aGlzLm5leHQoKTsgYnJlYWtcbiAgICAgIGRlZmF1bHQ6IHJldHVyblxuICAgIH1cblxuICAgIGUucHJldmVudERlZmF1bHQoKVxuICB9XG5cbiAgQ2Fyb3VzZWwucHJvdG90eXBlLmN5Y2xlID0gZnVuY3Rpb24gKGUpIHtcbiAgICBlIHx8ICh0aGlzLnBhdXNlZCA9IGZhbHNlKVxuXG4gICAgdGhpcy5pbnRlcnZhbCAmJiBjbGVhckludGVydmFsKHRoaXMuaW50ZXJ2YWwpXG5cbiAgICB0aGlzLm9wdGlvbnMuaW50ZXJ2YWxcbiAgICAgICYmICF0aGlzLnBhdXNlZFxuICAgICAgJiYgKHRoaXMuaW50ZXJ2YWwgPSBzZXRJbnRlcnZhbCgkLnByb3h5KHRoaXMubmV4dCwgdGhpcyksIHRoaXMub3B0aW9ucy5pbnRlcnZhbCkpXG5cbiAgICByZXR1cm4gdGhpc1xuICB9XG5cbiAgQ2Fyb3VzZWwucHJvdG90eXBlLmdldEl0ZW1JbmRleCA9IGZ1bmN0aW9uIChpdGVtKSB7XG4gICAgdGhpcy4kaXRlbXMgPSBpdGVtLnBhcmVudCgpLmNoaWxkcmVuKCcuaXRlbScpXG4gICAgcmV0dXJuIHRoaXMuJGl0ZW1zLmluZGV4KGl0ZW0gfHwgdGhpcy4kYWN0aXZlKVxuICB9XG5cbiAgQ2Fyb3VzZWwucHJvdG90eXBlLmdldEl0ZW1Gb3JEaXJlY3Rpb24gPSBmdW5jdGlvbiAoZGlyZWN0aW9uLCBhY3RpdmUpIHtcbiAgICB2YXIgYWN0aXZlSW5kZXggPSB0aGlzLmdldEl0ZW1JbmRleChhY3RpdmUpXG4gICAgdmFyIHdpbGxXcmFwID0gKGRpcmVjdGlvbiA9PSAncHJldicgJiYgYWN0aXZlSW5kZXggPT09IDApXG4gICAgICAgICAgICAgICAgfHwgKGRpcmVjdGlvbiA9PSAnbmV4dCcgJiYgYWN0aXZlSW5kZXggPT0gKHRoaXMuJGl0ZW1zLmxlbmd0aCAtIDEpKVxuICAgIGlmICh3aWxsV3JhcCAmJiAhdGhpcy5vcHRpb25zLndyYXApIHJldHVybiBhY3RpdmVcbiAgICB2YXIgZGVsdGEgPSBkaXJlY3Rpb24gPT0gJ3ByZXYnID8gLTEgOiAxXG4gICAgdmFyIGl0ZW1JbmRleCA9IChhY3RpdmVJbmRleCArIGRlbHRhKSAlIHRoaXMuJGl0ZW1zLmxlbmd0aFxuICAgIHJldHVybiB0aGlzLiRpdGVtcy5lcShpdGVtSW5kZXgpXG4gIH1cblxuICBDYXJvdXNlbC5wcm90b3R5cGUudG8gPSBmdW5jdGlvbiAocG9zKSB7XG4gICAgdmFyIHRoYXQgICAgICAgID0gdGhpc1xuICAgIHZhciBhY3RpdmVJbmRleCA9IHRoaXMuZ2V0SXRlbUluZGV4KHRoaXMuJGFjdGl2ZSA9IHRoaXMuJGVsZW1lbnQuZmluZCgnLml0ZW0uYWN0aXZlJykpXG5cbiAgICBpZiAocG9zID4gKHRoaXMuJGl0ZW1zLmxlbmd0aCAtIDEpIHx8IHBvcyA8IDApIHJldHVyblxuXG4gICAgaWYgKHRoaXMuc2xpZGluZykgICAgICAgcmV0dXJuIHRoaXMuJGVsZW1lbnQub25lKCdzbGlkLmJzLmNhcm91c2VsJywgZnVuY3Rpb24gKCkgeyB0aGF0LnRvKHBvcykgfSkgLy8geWVzLCBcInNsaWRcIlxuICAgIGlmIChhY3RpdmVJbmRleCA9PSBwb3MpIHJldHVybiB0aGlzLnBhdXNlKCkuY3ljbGUoKVxuXG4gICAgcmV0dXJuIHRoaXMuc2xpZGUocG9zID4gYWN0aXZlSW5kZXggPyAnbmV4dCcgOiAncHJldicsIHRoaXMuJGl0ZW1zLmVxKHBvcykpXG4gIH1cblxuICBDYXJvdXNlbC5wcm90b3R5cGUucGF1c2UgPSBmdW5jdGlvbiAoZSkge1xuICAgIGUgfHwgKHRoaXMucGF1c2VkID0gdHJ1ZSlcblxuICAgIGlmICh0aGlzLiRlbGVtZW50LmZpbmQoJy5uZXh0LCAucHJldicpLmxlbmd0aCAmJiAkLnN1cHBvcnQudHJhbnNpdGlvbikge1xuICAgICAgdGhpcy4kZWxlbWVudC50cmlnZ2VyKCQuc3VwcG9ydC50cmFuc2l0aW9uLmVuZClcbiAgICAgIHRoaXMuY3ljbGUodHJ1ZSlcbiAgICB9XG5cbiAgICB0aGlzLmludGVydmFsID0gY2xlYXJJbnRlcnZhbCh0aGlzLmludGVydmFsKVxuXG4gICAgcmV0dXJuIHRoaXNcbiAgfVxuXG4gIENhcm91c2VsLnByb3RvdHlwZS5uZXh0ID0gZnVuY3Rpb24gKCkge1xuICAgIGlmICh0aGlzLnNsaWRpbmcpIHJldHVyblxuICAgIHJldHVybiB0aGlzLnNsaWRlKCduZXh0JylcbiAgfVxuXG4gIENhcm91c2VsLnByb3RvdHlwZS5wcmV2ID0gZnVuY3Rpb24gKCkge1xuICAgIGlmICh0aGlzLnNsaWRpbmcpIHJldHVyblxuICAgIHJldHVybiB0aGlzLnNsaWRlKCdwcmV2JylcbiAgfVxuXG4gIENhcm91c2VsLnByb3RvdHlwZS5zbGlkZSA9IGZ1bmN0aW9uICh0eXBlLCBuZXh0KSB7XG4gICAgdmFyICRhY3RpdmUgICA9IHRoaXMuJGVsZW1lbnQuZmluZCgnLml0ZW0uYWN0aXZlJylcbiAgICB2YXIgJG5leHQgICAgID0gbmV4dCB8fCB0aGlzLmdldEl0ZW1Gb3JEaXJlY3Rpb24odHlwZSwgJGFjdGl2ZSlcbiAgICB2YXIgaXNDeWNsaW5nID0gdGhpcy5pbnRlcnZhbFxuICAgIHZhciBkaXJlY3Rpb24gPSB0eXBlID09ICduZXh0JyA/ICdsZWZ0JyA6ICdyaWdodCdcbiAgICB2YXIgdGhhdCAgICAgID0gdGhpc1xuXG4gICAgaWYgKCRuZXh0Lmhhc0NsYXNzKCdhY3RpdmUnKSkgcmV0dXJuICh0aGlzLnNsaWRpbmcgPSBmYWxzZSlcblxuICAgIHZhciByZWxhdGVkVGFyZ2V0ID0gJG5leHRbMF1cbiAgICB2YXIgc2xpZGVFdmVudCA9ICQuRXZlbnQoJ3NsaWRlLmJzLmNhcm91c2VsJywge1xuICAgICAgcmVsYXRlZFRhcmdldDogcmVsYXRlZFRhcmdldCxcbiAgICAgIGRpcmVjdGlvbjogZGlyZWN0aW9uXG4gICAgfSlcbiAgICB0aGlzLiRlbGVtZW50LnRyaWdnZXIoc2xpZGVFdmVudClcbiAgICBpZiAoc2xpZGVFdmVudC5pc0RlZmF1bHRQcmV2ZW50ZWQoKSkgcmV0dXJuXG5cbiAgICB0aGlzLnNsaWRpbmcgPSB0cnVlXG5cbiAgICBpc0N5Y2xpbmcgJiYgdGhpcy5wYXVzZSgpXG5cbiAgICBpZiAodGhpcy4kaW5kaWNhdG9ycy5sZW5ndGgpIHtcbiAgICAgIHRoaXMuJGluZGljYXRvcnMuZmluZCgnLmFjdGl2ZScpLnJlbW92ZUNsYXNzKCdhY3RpdmUnKVxuICAgICAgdmFyICRuZXh0SW5kaWNhdG9yID0gJCh0aGlzLiRpbmRpY2F0b3JzLmNoaWxkcmVuKClbdGhpcy5nZXRJdGVtSW5kZXgoJG5leHQpXSlcbiAgICAgICRuZXh0SW5kaWNhdG9yICYmICRuZXh0SW5kaWNhdG9yLmFkZENsYXNzKCdhY3RpdmUnKVxuICAgIH1cblxuICAgIHZhciBzbGlkRXZlbnQgPSAkLkV2ZW50KCdzbGlkLmJzLmNhcm91c2VsJywgeyByZWxhdGVkVGFyZ2V0OiByZWxhdGVkVGFyZ2V0LCBkaXJlY3Rpb246IGRpcmVjdGlvbiB9KSAvLyB5ZXMsIFwic2xpZFwiXG4gICAgaWYgKCQuc3VwcG9ydC50cmFuc2l0aW9uICYmIHRoaXMuJGVsZW1lbnQuaGFzQ2xhc3MoJ3NsaWRlJykpIHtcbiAgICAgICRuZXh0LmFkZENsYXNzKHR5cGUpXG4gICAgICAkbmV4dFswXS5vZmZzZXRXaWR0aCAvLyBmb3JjZSByZWZsb3dcbiAgICAgICRhY3RpdmUuYWRkQ2xhc3MoZGlyZWN0aW9uKVxuICAgICAgJG5leHQuYWRkQ2xhc3MoZGlyZWN0aW9uKVxuICAgICAgJGFjdGl2ZVxuICAgICAgICAub25lKCdic1RyYW5zaXRpb25FbmQnLCBmdW5jdGlvbiAoKSB7XG4gICAgICAgICAgJG5leHQucmVtb3ZlQ2xhc3MoW3R5cGUsIGRpcmVjdGlvbl0uam9pbignICcpKS5hZGRDbGFzcygnYWN0aXZlJylcbiAgICAgICAgICAkYWN0aXZlLnJlbW92ZUNsYXNzKFsnYWN0aXZlJywgZGlyZWN0aW9uXS5qb2luKCcgJykpXG4gICAgICAgICAgdGhhdC5zbGlkaW5nID0gZmFsc2VcbiAgICAgICAgICBzZXRUaW1lb3V0KGZ1bmN0aW9uICgpIHtcbiAgICAgICAgICAgIHRoYXQuJGVsZW1lbnQudHJpZ2dlcihzbGlkRXZlbnQpXG4gICAgICAgICAgfSwgMClcbiAgICAgICAgfSlcbiAgICAgICAgLmVtdWxhdGVUcmFuc2l0aW9uRW5kKENhcm91c2VsLlRSQU5TSVRJT05fRFVSQVRJT04pXG4gICAgfSBlbHNlIHtcbiAgICAgICRhY3RpdmUucmVtb3ZlQ2xhc3MoJ2FjdGl2ZScpXG4gICAgICAkbmV4dC5hZGRDbGFzcygnYWN0aXZlJylcbiAgICAgIHRoaXMuc2xpZGluZyA9IGZhbHNlXG4gICAgICB0aGlzLiRlbGVtZW50LnRyaWdnZXIoc2xpZEV2ZW50KVxuICAgIH1cblxuICAgIGlzQ3ljbGluZyAmJiB0aGlzLmN5Y2xlKClcblxuICAgIHJldHVybiB0aGlzXG4gIH1cblxuXG4gIC8vIENBUk9VU0VMIFBMVUdJTiBERUZJTklUSU9OXG4gIC8vID09PT09PT09PT09PT09PT09PT09PT09PT09XG5cbiAgZnVuY3Rpb24gUGx1Z2luKG9wdGlvbikge1xuICAgIHJldHVybiB0aGlzLmVhY2goZnVuY3Rpb24gKCkge1xuICAgICAgdmFyICR0aGlzICAgPSAkKHRoaXMpXG4gICAgICB2YXIgZGF0YSAgICA9ICR0aGlzLmRhdGEoJ2JzLmNhcm91c2VsJylcbiAgICAgIHZhciBvcHRpb25zID0gJC5leHRlbmQoe30sIENhcm91c2VsLkRFRkFVTFRTLCAkdGhpcy5kYXRhKCksIHR5cGVvZiBvcHRpb24gPT0gJ29iamVjdCcgJiYgb3B0aW9uKVxuICAgICAgdmFyIGFjdGlvbiAgPSB0eXBlb2Ygb3B0aW9uID09ICdzdHJpbmcnID8gb3B0aW9uIDogb3B0aW9ucy5zbGlkZVxuXG4gICAgICBpZiAoIWRhdGEpICR0aGlzLmRhdGEoJ2JzLmNhcm91c2VsJywgKGRhdGEgPSBuZXcgQ2Fyb3VzZWwodGhpcywgb3B0aW9ucykpKVxuICAgICAgaWYgKHR5cGVvZiBvcHRpb24gPT0gJ251bWJlcicpIGRhdGEudG8ob3B0aW9uKVxuICAgICAgZWxzZSBpZiAoYWN0aW9uKSBkYXRhW2FjdGlvbl0oKVxuICAgICAgZWxzZSBpZiAob3B0aW9ucy5pbnRlcnZhbCkgZGF0YS5wYXVzZSgpLmN5Y2xlKClcbiAgICB9KVxuICB9XG5cbiAgdmFyIG9sZCA9ICQuZm4uY2Fyb3VzZWxcblxuICAkLmZuLmNhcm91c2VsICAgICAgICAgICAgID0gUGx1Z2luXG4gICQuZm4uY2Fyb3VzZWwuQ29uc3RydWN0b3IgPSBDYXJvdXNlbFxuXG5cbiAgLy8gQ0FST1VTRUwgTk8gQ09ORkxJQ1RcbiAgLy8gPT09PT09PT09PT09PT09PT09PT1cblxuICAkLmZuLmNhcm91c2VsLm5vQ29uZmxpY3QgPSBmdW5jdGlvbiAoKSB7XG4gICAgJC5mbi5jYXJvdXNlbCA9IG9sZFxuICAgIHJldHVybiB0aGlzXG4gIH1cblxuXG4gIC8vIENBUk9VU0VMIERBVEEtQVBJXG4gIC8vID09PT09PT09PT09PT09PT09XG5cbiAgdmFyIGNsaWNrSGFuZGxlciA9IGZ1bmN0aW9uIChlKSB7XG4gICAgdmFyIGhyZWZcbiAgICB2YXIgJHRoaXMgICA9ICQodGhpcylcbiAgICB2YXIgJHRhcmdldCA9ICQoJHRoaXMuYXR0cignZGF0YS10YXJnZXQnKSB8fCAoaHJlZiA9ICR0aGlzLmF0dHIoJ2hyZWYnKSkgJiYgaHJlZi5yZXBsYWNlKC8uKig/PSNbXlxcc10rJCkvLCAnJykpIC8vIHN0cmlwIGZvciBpZTdcbiAgICBpZiAoISR0YXJnZXQuaGFzQ2xhc3MoJ2Nhcm91c2VsJykpIHJldHVyblxuICAgIHZhciBvcHRpb25zID0gJC5leHRlbmQoe30sICR0YXJnZXQuZGF0YSgpLCAkdGhpcy5kYXRhKCkpXG4gICAgdmFyIHNsaWRlSW5kZXggPSAkdGhpcy5hdHRyKCdkYXRhLXNsaWRlLXRvJylcbiAgICBpZiAoc2xpZGVJbmRleCkgb3B0aW9ucy5pbnRlcnZhbCA9IGZhbHNlXG5cbiAgICBQbHVnaW4uY2FsbCgkdGFyZ2V0LCBvcHRpb25zKVxuXG4gICAgaWYgKHNsaWRlSW5kZXgpIHtcbiAgICAgICR0YXJnZXQuZGF0YSgnYnMuY2Fyb3VzZWwnKS50byhzbGlkZUluZGV4KVxuICAgIH1cblxuICAgIGUucHJldmVudERlZmF1bHQoKVxuICB9XG5cbiAgJChkb2N1bWVudClcbiAgICAub24oJ2NsaWNrLmJzLmNhcm91c2VsLmRhdGEtYXBpJywgJ1tkYXRhLXNsaWRlXScsIGNsaWNrSGFuZGxlcilcbiAgICAub24oJ2NsaWNrLmJzLmNhcm91c2VsLmRhdGEtYXBpJywgJ1tkYXRhLXNsaWRlLXRvXScsIGNsaWNrSGFuZGxlcilcblxuICAkKHdpbmRvdykub24oJ2xvYWQnLCBmdW5jdGlvbiAoKSB7XG4gICAgJCgnW2RhdGEtcmlkZT1cImNhcm91c2VsXCJdJykuZWFjaChmdW5jdGlvbiAoKSB7XG4gICAgICB2YXIgJGNhcm91c2VsID0gJCh0aGlzKVxuICAgICAgUGx1Z2luLmNhbGwoJGNhcm91c2VsLCAkY2Fyb3VzZWwuZGF0YSgpKVxuICAgIH0pXG4gIH0pXG5cbn0oalF1ZXJ5KTtcbiIsIi8qID09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PVxuICogQm9vdHN0cmFwOiBjb2xsYXBzZS5qcyB2My4zLjdcbiAqIGh0dHA6Ly9nZXRib290c3RyYXAuY29tL2phdmFzY3JpcHQvI2NvbGxhcHNlXG4gKiA9PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT1cbiAqIENvcHlyaWdodCAyMDExLTIwMTYgVHdpdHRlciwgSW5jLlxuICogTGljZW5zZWQgdW5kZXIgTUlUIChodHRwczovL2dpdGh1Yi5jb20vdHdicy9ib290c3RyYXAvYmxvYi9tYXN0ZXIvTElDRU5TRSlcbiAqID09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PSAqL1xuXG4vKiBqc2hpbnQgbGF0ZWRlZjogZmFsc2UgKi9cblxuK2Z1bmN0aW9uICgkKSB7XG4gICd1c2Ugc3RyaWN0JztcblxuICAvLyBDT0xMQVBTRSBQVUJMSUMgQ0xBU1MgREVGSU5JVElPTlxuICAvLyA9PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PVxuXG4gIHZhciBDb2xsYXBzZSA9IGZ1bmN0aW9uIChlbGVtZW50LCBvcHRpb25zKSB7XG4gICAgdGhpcy4kZWxlbWVudCAgICAgID0gJChlbGVtZW50KVxuICAgIHRoaXMub3B0aW9ucyAgICAgICA9ICQuZXh0ZW5kKHt9LCBDb2xsYXBzZS5ERUZBVUxUUywgb3B0aW9ucylcbiAgICB0aGlzLiR0cmlnZ2VyICAgICAgPSAkKCdbZGF0YS10b2dnbGU9XCJjb2xsYXBzZVwiXVtocmVmPVwiIycgKyBlbGVtZW50LmlkICsgJ1wiXSwnICtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICdbZGF0YS10b2dnbGU9XCJjb2xsYXBzZVwiXVtkYXRhLXRhcmdldD1cIiMnICsgZWxlbWVudC5pZCArICdcIl0nKVxuICAgIHRoaXMudHJhbnNpdGlvbmluZyA9IG51bGxcblxuICAgIGlmICh0aGlzLm9wdGlvbnMucGFyZW50KSB7XG4gICAgICB0aGlzLiRwYXJlbnQgPSB0aGlzLmdldFBhcmVudCgpXG4gICAgfSBlbHNlIHtcbiAgICAgIHRoaXMuYWRkQXJpYUFuZENvbGxhcHNlZENsYXNzKHRoaXMuJGVsZW1lbnQsIHRoaXMuJHRyaWdnZXIpXG4gICAgfVxuXG4gICAgaWYgKHRoaXMub3B0aW9ucy50b2dnbGUpIHRoaXMudG9nZ2xlKClcbiAgfVxuXG4gIENvbGxhcHNlLlZFUlNJT04gID0gJzMuMy43J1xuXG4gIENvbGxhcHNlLlRSQU5TSVRJT05fRFVSQVRJT04gPSAzNTBcblxuICBDb2xsYXBzZS5ERUZBVUxUUyA9IHtcbiAgICB0b2dnbGU6IHRydWVcbiAgfVxuXG4gIENvbGxhcHNlLnByb3RvdHlwZS5kaW1lbnNpb24gPSBmdW5jdGlvbiAoKSB7XG4gICAgdmFyIGhhc1dpZHRoID0gdGhpcy4kZWxlbWVudC5oYXNDbGFzcygnd2lkdGgnKVxuICAgIHJldHVybiBoYXNXaWR0aCA/ICd3aWR0aCcgOiAnaGVpZ2h0J1xuICB9XG5cbiAgQ29sbGFwc2UucHJvdG90eXBlLnNob3cgPSBmdW5jdGlvbiAoKSB7XG4gICAgaWYgKHRoaXMudHJhbnNpdGlvbmluZyB8fCB0aGlzLiRlbGVtZW50Lmhhc0NsYXNzKCdpbicpKSByZXR1cm5cblxuICAgIHZhciBhY3RpdmVzRGF0YVxuICAgIHZhciBhY3RpdmVzID0gdGhpcy4kcGFyZW50ICYmIHRoaXMuJHBhcmVudC5jaGlsZHJlbignLnBhbmVsJykuY2hpbGRyZW4oJy5pbiwgLmNvbGxhcHNpbmcnKVxuXG4gICAgaWYgKGFjdGl2ZXMgJiYgYWN0aXZlcy5sZW5ndGgpIHtcbiAgICAgIGFjdGl2ZXNEYXRhID0gYWN0aXZlcy5kYXRhKCdicy5jb2xsYXBzZScpXG4gICAgICBpZiAoYWN0aXZlc0RhdGEgJiYgYWN0aXZlc0RhdGEudHJhbnNpdGlvbmluZykgcmV0dXJuXG4gICAgfVxuXG4gICAgdmFyIHN0YXJ0RXZlbnQgPSAkLkV2ZW50KCdzaG93LmJzLmNvbGxhcHNlJylcbiAgICB0aGlzLiRlbGVtZW50LnRyaWdnZXIoc3RhcnRFdmVudClcbiAgICBpZiAoc3RhcnRFdmVudC5pc0RlZmF1bHRQcmV2ZW50ZWQoKSkgcmV0dXJuXG5cbiAgICBpZiAoYWN0aXZlcyAmJiBhY3RpdmVzLmxlbmd0aCkge1xuICAgICAgUGx1Z2luLmNhbGwoYWN0aXZlcywgJ2hpZGUnKVxuICAgICAgYWN0aXZlc0RhdGEgfHwgYWN0aXZlcy5kYXRhKCdicy5jb2xsYXBzZScsIG51bGwpXG4gICAgfVxuXG4gICAgdmFyIGRpbWVuc2lvbiA9IHRoaXMuZGltZW5zaW9uKClcblxuICAgIHRoaXMuJGVsZW1lbnRcbiAgICAgIC5yZW1vdmVDbGFzcygnY29sbGFwc2UnKVxuICAgICAgLmFkZENsYXNzKCdjb2xsYXBzaW5nJylbZGltZW5zaW9uXSgwKVxuICAgICAgLmF0dHIoJ2FyaWEtZXhwYW5kZWQnLCB0cnVlKVxuXG4gICAgdGhpcy4kdHJpZ2dlclxuICAgICAgLnJlbW92ZUNsYXNzKCdjb2xsYXBzZWQnKVxuICAgICAgLmF0dHIoJ2FyaWEtZXhwYW5kZWQnLCB0cnVlKVxuXG4gICAgdGhpcy50cmFuc2l0aW9uaW5nID0gMVxuXG4gICAgdmFyIGNvbXBsZXRlID0gZnVuY3Rpb24gKCkge1xuICAgICAgdGhpcy4kZWxlbWVudFxuICAgICAgICAucmVtb3ZlQ2xhc3MoJ2NvbGxhcHNpbmcnKVxuICAgICAgICAuYWRkQ2xhc3MoJ2NvbGxhcHNlIGluJylbZGltZW5zaW9uXSgnJylcbiAgICAgIHRoaXMudHJhbnNpdGlvbmluZyA9IDBcbiAgICAgIHRoaXMuJGVsZW1lbnRcbiAgICAgICAgLnRyaWdnZXIoJ3Nob3duLmJzLmNvbGxhcHNlJylcbiAgICB9XG5cbiAgICBpZiAoISQuc3VwcG9ydC50cmFuc2l0aW9uKSByZXR1cm4gY29tcGxldGUuY2FsbCh0aGlzKVxuXG4gICAgdmFyIHNjcm9sbFNpemUgPSAkLmNhbWVsQ2FzZShbJ3Njcm9sbCcsIGRpbWVuc2lvbl0uam9pbignLScpKVxuXG4gICAgdGhpcy4kZWxlbWVudFxuICAgICAgLm9uZSgnYnNUcmFuc2l0aW9uRW5kJywgJC5wcm94eShjb21wbGV0ZSwgdGhpcykpXG4gICAgICAuZW11bGF0ZVRyYW5zaXRpb25FbmQoQ29sbGFwc2UuVFJBTlNJVElPTl9EVVJBVElPTilbZGltZW5zaW9uXSh0aGlzLiRlbGVtZW50WzBdW3Njcm9sbFNpemVdKVxuICB9XG5cbiAgQ29sbGFwc2UucHJvdG90eXBlLmhpZGUgPSBmdW5jdGlvbiAoKSB7XG4gICAgaWYgKHRoaXMudHJhbnNpdGlvbmluZyB8fCAhdGhpcy4kZWxlbWVudC5oYXNDbGFzcygnaW4nKSkgcmV0dXJuXG5cbiAgICB2YXIgc3RhcnRFdmVudCA9ICQuRXZlbnQoJ2hpZGUuYnMuY29sbGFwc2UnKVxuICAgIHRoaXMuJGVsZW1lbnQudHJpZ2dlcihzdGFydEV2ZW50KVxuICAgIGlmIChzdGFydEV2ZW50LmlzRGVmYXVsdFByZXZlbnRlZCgpKSByZXR1cm5cblxuICAgIHZhciBkaW1lbnNpb24gPSB0aGlzLmRpbWVuc2lvbigpXG5cbiAgICB0aGlzLiRlbGVtZW50W2RpbWVuc2lvbl0odGhpcy4kZWxlbWVudFtkaW1lbnNpb25dKCkpWzBdLm9mZnNldEhlaWdodFxuXG4gICAgdGhpcy4kZWxlbWVudFxuICAgICAgLmFkZENsYXNzKCdjb2xsYXBzaW5nJylcbiAgICAgIC5yZW1vdmVDbGFzcygnY29sbGFwc2UgaW4nKVxuICAgICAgLmF0dHIoJ2FyaWEtZXhwYW5kZWQnLCBmYWxzZSlcblxuICAgIHRoaXMuJHRyaWdnZXJcbiAgICAgIC5hZGRDbGFzcygnY29sbGFwc2VkJylcbiAgICAgIC5hdHRyKCdhcmlhLWV4cGFuZGVkJywgZmFsc2UpXG5cbiAgICB0aGlzLnRyYW5zaXRpb25pbmcgPSAxXG5cbiAgICB2YXIgY29tcGxldGUgPSBmdW5jdGlvbiAoKSB7XG4gICAgICB0aGlzLnRyYW5zaXRpb25pbmcgPSAwXG4gICAgICB0aGlzLiRlbGVtZW50XG4gICAgICAgIC5yZW1vdmVDbGFzcygnY29sbGFwc2luZycpXG4gICAgICAgIC5hZGRDbGFzcygnY29sbGFwc2UnKVxuICAgICAgICAudHJpZ2dlcignaGlkZGVuLmJzLmNvbGxhcHNlJylcbiAgICB9XG5cbiAgICBpZiAoISQuc3VwcG9ydC50cmFuc2l0aW9uKSByZXR1cm4gY29tcGxldGUuY2FsbCh0aGlzKVxuXG4gICAgdGhpcy4kZWxlbWVudFxuICAgICAgW2RpbWVuc2lvbl0oMClcbiAgICAgIC5vbmUoJ2JzVHJhbnNpdGlvbkVuZCcsICQucHJveHkoY29tcGxldGUsIHRoaXMpKVxuICAgICAgLmVtdWxhdGVUcmFuc2l0aW9uRW5kKENvbGxhcHNlLlRSQU5TSVRJT05fRFVSQVRJT04pXG4gIH1cblxuICBDb2xsYXBzZS5wcm90b3R5cGUudG9nZ2xlID0gZnVuY3Rpb24gKCkge1xuICAgIHRoaXNbdGhpcy4kZWxlbWVudC5oYXNDbGFzcygnaW4nKSA/ICdoaWRlJyA6ICdzaG93J10oKVxuICB9XG5cbiAgQ29sbGFwc2UucHJvdG90eXBlLmdldFBhcmVudCA9IGZ1bmN0aW9uICgpIHtcbiAgICByZXR1cm4gJCh0aGlzLm9wdGlvbnMucGFyZW50KVxuICAgICAgLmZpbmQoJ1tkYXRhLXRvZ2dsZT1cImNvbGxhcHNlXCJdW2RhdGEtcGFyZW50PVwiJyArIHRoaXMub3B0aW9ucy5wYXJlbnQgKyAnXCJdJylcbiAgICAgIC5lYWNoKCQucHJveHkoZnVuY3Rpb24gKGksIGVsZW1lbnQpIHtcbiAgICAgICAgdmFyICRlbGVtZW50ID0gJChlbGVtZW50KVxuICAgICAgICB0aGlzLmFkZEFyaWFBbmRDb2xsYXBzZWRDbGFzcyhnZXRUYXJnZXRGcm9tVHJpZ2dlcigkZWxlbWVudCksICRlbGVtZW50KVxuICAgICAgfSwgdGhpcykpXG4gICAgICAuZW5kKClcbiAgfVxuXG4gIENvbGxhcHNlLnByb3RvdHlwZS5hZGRBcmlhQW5kQ29sbGFwc2VkQ2xhc3MgPSBmdW5jdGlvbiAoJGVsZW1lbnQsICR0cmlnZ2VyKSB7XG4gICAgdmFyIGlzT3BlbiA9ICRlbGVtZW50Lmhhc0NsYXNzKCdpbicpXG5cbiAgICAkZWxlbWVudC5hdHRyKCdhcmlhLWV4cGFuZGVkJywgaXNPcGVuKVxuICAgICR0cmlnZ2VyXG4gICAgICAudG9nZ2xlQ2xhc3MoJ2NvbGxhcHNlZCcsICFpc09wZW4pXG4gICAgICAuYXR0cignYXJpYS1leHBhbmRlZCcsIGlzT3BlbilcbiAgfVxuXG4gIGZ1bmN0aW9uIGdldFRhcmdldEZyb21UcmlnZ2VyKCR0cmlnZ2VyKSB7XG4gICAgdmFyIGhyZWZcbiAgICB2YXIgdGFyZ2V0ID0gJHRyaWdnZXIuYXR0cignZGF0YS10YXJnZXQnKVxuICAgICAgfHwgKGhyZWYgPSAkdHJpZ2dlci5hdHRyKCdocmVmJykpICYmIGhyZWYucmVwbGFjZSgvLiooPz0jW15cXHNdKyQpLywgJycpIC8vIHN0cmlwIGZvciBpZTdcblxuICAgIHJldHVybiAkKHRhcmdldClcbiAgfVxuXG5cbiAgLy8gQ09MTEFQU0UgUExVR0lOIERFRklOSVRJT05cbiAgLy8gPT09PT09PT09PT09PT09PT09PT09PT09PT1cblxuICBmdW5jdGlvbiBQbHVnaW4ob3B0aW9uKSB7XG4gICAgcmV0dXJuIHRoaXMuZWFjaChmdW5jdGlvbiAoKSB7XG4gICAgICB2YXIgJHRoaXMgICA9ICQodGhpcylcbiAgICAgIHZhciBkYXRhICAgID0gJHRoaXMuZGF0YSgnYnMuY29sbGFwc2UnKVxuICAgICAgdmFyIG9wdGlvbnMgPSAkLmV4dGVuZCh7fSwgQ29sbGFwc2UuREVGQVVMVFMsICR0aGlzLmRhdGEoKSwgdHlwZW9mIG9wdGlvbiA9PSAnb2JqZWN0JyAmJiBvcHRpb24pXG5cbiAgICAgIGlmICghZGF0YSAmJiBvcHRpb25zLnRvZ2dsZSAmJiAvc2hvd3xoaWRlLy50ZXN0KG9wdGlvbikpIG9wdGlvbnMudG9nZ2xlID0gZmFsc2VcbiAgICAgIGlmICghZGF0YSkgJHRoaXMuZGF0YSgnYnMuY29sbGFwc2UnLCAoZGF0YSA9IG5ldyBDb2xsYXBzZSh0aGlzLCBvcHRpb25zKSkpXG4gICAgICBpZiAodHlwZW9mIG9wdGlvbiA9PSAnc3RyaW5nJykgZGF0YVtvcHRpb25dKClcbiAgICB9KVxuICB9XG5cbiAgdmFyIG9sZCA9ICQuZm4uY29sbGFwc2VcblxuICAkLmZuLmNvbGxhcHNlICAgICAgICAgICAgID0gUGx1Z2luXG4gICQuZm4uY29sbGFwc2UuQ29uc3RydWN0b3IgPSBDb2xsYXBzZVxuXG5cbiAgLy8gQ09MTEFQU0UgTk8gQ09ORkxJQ1RcbiAgLy8gPT09PT09PT09PT09PT09PT09PT1cblxuICAkLmZuLmNvbGxhcHNlLm5vQ29uZmxpY3QgPSBmdW5jdGlvbiAoKSB7XG4gICAgJC5mbi5jb2xsYXBzZSA9IG9sZFxuICAgIHJldHVybiB0aGlzXG4gIH1cblxuXG4gIC8vIENPTExBUFNFIERBVEEtQVBJXG4gIC8vID09PT09PT09PT09PT09PT09XG5cbiAgJChkb2N1bWVudCkub24oJ2NsaWNrLmJzLmNvbGxhcHNlLmRhdGEtYXBpJywgJ1tkYXRhLXRvZ2dsZT1cImNvbGxhcHNlXCJdJywgZnVuY3Rpb24gKGUpIHtcbiAgICB2YXIgJHRoaXMgICA9ICQodGhpcylcblxuICAgIGlmICghJHRoaXMuYXR0cignZGF0YS10YXJnZXQnKSkgZS5wcmV2ZW50RGVmYXVsdCgpXG5cbiAgICB2YXIgJHRhcmdldCA9IGdldFRhcmdldEZyb21UcmlnZ2VyKCR0aGlzKVxuICAgIHZhciBkYXRhICAgID0gJHRhcmdldC5kYXRhKCdicy5jb2xsYXBzZScpXG4gICAgdmFyIG9wdGlvbiAgPSBkYXRhID8gJ3RvZ2dsZScgOiAkdGhpcy5kYXRhKClcblxuICAgIFBsdWdpbi5jYWxsKCR0YXJnZXQsIG9wdGlvbilcbiAgfSlcblxufShqUXVlcnkpO1xuIiwiLyogPT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09XG4gKiBCb290c3RyYXA6IGRyb3Bkb3duLmpzIHYzLjMuN1xuICogaHR0cDovL2dldGJvb3RzdHJhcC5jb20vamF2YXNjcmlwdC8jZHJvcGRvd25zXG4gKiA9PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT1cbiAqIENvcHlyaWdodCAyMDExLTIwMTYgVHdpdHRlciwgSW5jLlxuICogTGljZW5zZWQgdW5kZXIgTUlUIChodHRwczovL2dpdGh1Yi5jb20vdHdicy9ib290c3RyYXAvYmxvYi9tYXN0ZXIvTElDRU5TRSlcbiAqID09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PSAqL1xuXG5cbitmdW5jdGlvbiAoJCkge1xuICAndXNlIHN0cmljdCc7XG5cbiAgLy8gRFJPUERPV04gQ0xBU1MgREVGSU5JVElPTlxuICAvLyA9PT09PT09PT09PT09PT09PT09PT09PT09XG5cbiAgdmFyIGJhY2tkcm9wID0gJy5kcm9wZG93bi1iYWNrZHJvcCdcbiAgdmFyIHRvZ2dsZSAgID0gJ1tkYXRhLXRvZ2dsZT1cImRyb3Bkb3duXCJdJ1xuICB2YXIgRHJvcGRvd24gPSBmdW5jdGlvbiAoZWxlbWVudCkge1xuICAgICQoZWxlbWVudCkub24oJ2NsaWNrLmJzLmRyb3Bkb3duJywgdGhpcy50b2dnbGUpXG4gIH1cblxuICBEcm9wZG93bi5WRVJTSU9OID0gJzMuMy43J1xuXG4gIGZ1bmN0aW9uIGdldFBhcmVudCgkdGhpcykge1xuICAgIHZhciBzZWxlY3RvciA9ICR0aGlzLmF0dHIoJ2RhdGEtdGFyZ2V0JylcblxuICAgIGlmICghc2VsZWN0b3IpIHtcbiAgICAgIHNlbGVjdG9yID0gJHRoaXMuYXR0cignaHJlZicpXG4gICAgICBzZWxlY3RvciA9IHNlbGVjdG9yICYmIC8jW0EtWmEtel0vLnRlc3Qoc2VsZWN0b3IpICYmIHNlbGVjdG9yLnJlcGxhY2UoLy4qKD89I1teXFxzXSokKS8sICcnKSAvLyBzdHJpcCBmb3IgaWU3XG4gICAgfVxuXG4gICAgdmFyICRwYXJlbnQgPSBzZWxlY3RvciAmJiAkKHNlbGVjdG9yKVxuXG4gICAgcmV0dXJuICRwYXJlbnQgJiYgJHBhcmVudC5sZW5ndGggPyAkcGFyZW50IDogJHRoaXMucGFyZW50KClcbiAgfVxuXG4gIGZ1bmN0aW9uIGNsZWFyTWVudXMoZSkge1xuICAgIGlmIChlICYmIGUud2hpY2ggPT09IDMpIHJldHVyblxuICAgICQoYmFja2Ryb3ApLnJlbW92ZSgpXG4gICAgJCh0b2dnbGUpLmVhY2goZnVuY3Rpb24gKCkge1xuICAgICAgdmFyICR0aGlzICAgICAgICAgPSAkKHRoaXMpXG4gICAgICB2YXIgJHBhcmVudCAgICAgICA9IGdldFBhcmVudCgkdGhpcylcbiAgICAgIHZhciByZWxhdGVkVGFyZ2V0ID0geyByZWxhdGVkVGFyZ2V0OiB0aGlzIH1cblxuICAgICAgaWYgKCEkcGFyZW50Lmhhc0NsYXNzKCdvcGVuJykpIHJldHVyblxuXG4gICAgICBpZiAoZSAmJiBlLnR5cGUgPT0gJ2NsaWNrJyAmJiAvaW5wdXR8dGV4dGFyZWEvaS50ZXN0KGUudGFyZ2V0LnRhZ05hbWUpICYmICQuY29udGFpbnMoJHBhcmVudFswXSwgZS50YXJnZXQpKSByZXR1cm5cblxuICAgICAgJHBhcmVudC50cmlnZ2VyKGUgPSAkLkV2ZW50KCdoaWRlLmJzLmRyb3Bkb3duJywgcmVsYXRlZFRhcmdldCkpXG5cbiAgICAgIGlmIChlLmlzRGVmYXVsdFByZXZlbnRlZCgpKSByZXR1cm5cblxuICAgICAgJHRoaXMuYXR0cignYXJpYS1leHBhbmRlZCcsICdmYWxzZScpXG4gICAgICAkcGFyZW50LnJlbW92ZUNsYXNzKCdvcGVuJykudHJpZ2dlcigkLkV2ZW50KCdoaWRkZW4uYnMuZHJvcGRvd24nLCByZWxhdGVkVGFyZ2V0KSlcbiAgICB9KVxuICB9XG5cbiAgRHJvcGRvd24ucHJvdG90eXBlLnRvZ2dsZSA9IGZ1bmN0aW9uIChlKSB7XG4gICAgdmFyICR0aGlzID0gJCh0aGlzKVxuXG4gICAgaWYgKCR0aGlzLmlzKCcuZGlzYWJsZWQsIDpkaXNhYmxlZCcpKSByZXR1cm5cblxuICAgIHZhciAkcGFyZW50ICA9IGdldFBhcmVudCgkdGhpcylcbiAgICB2YXIgaXNBY3RpdmUgPSAkcGFyZW50Lmhhc0NsYXNzKCdvcGVuJylcblxuICAgIGNsZWFyTWVudXMoKVxuXG4gICAgaWYgKCFpc0FjdGl2ZSkge1xuICAgICAgaWYgKCdvbnRvdWNoc3RhcnQnIGluIGRvY3VtZW50LmRvY3VtZW50RWxlbWVudCAmJiAhJHBhcmVudC5jbG9zZXN0KCcubmF2YmFyLW5hdicpLmxlbmd0aCkge1xuICAgICAgICAvLyBpZiBtb2JpbGUgd2UgdXNlIGEgYmFja2Ryb3AgYmVjYXVzZSBjbGljayBldmVudHMgZG9uJ3QgZGVsZWdhdGVcbiAgICAgICAgJChkb2N1bWVudC5jcmVhdGVFbGVtZW50KCdkaXYnKSlcbiAgICAgICAgICAuYWRkQ2xhc3MoJ2Ryb3Bkb3duLWJhY2tkcm9wJylcbiAgICAgICAgICAuaW5zZXJ0QWZ0ZXIoJCh0aGlzKSlcbiAgICAgICAgICAub24oJ2NsaWNrJywgY2xlYXJNZW51cylcbiAgICAgIH1cblxuICAgICAgdmFyIHJlbGF0ZWRUYXJnZXQgPSB7IHJlbGF0ZWRUYXJnZXQ6IHRoaXMgfVxuICAgICAgJHBhcmVudC50cmlnZ2VyKGUgPSAkLkV2ZW50KCdzaG93LmJzLmRyb3Bkb3duJywgcmVsYXRlZFRhcmdldCkpXG5cbiAgICAgIGlmIChlLmlzRGVmYXVsdFByZXZlbnRlZCgpKSByZXR1cm5cblxuICAgICAgJHRoaXNcbiAgICAgICAgLnRyaWdnZXIoJ2ZvY3VzJylcbiAgICAgICAgLmF0dHIoJ2FyaWEtZXhwYW5kZWQnLCAndHJ1ZScpXG5cbiAgICAgICRwYXJlbnRcbiAgICAgICAgLnRvZ2dsZUNsYXNzKCdvcGVuJylcbiAgICAgICAgLnRyaWdnZXIoJC5FdmVudCgnc2hvd24uYnMuZHJvcGRvd24nLCByZWxhdGVkVGFyZ2V0KSlcbiAgICB9XG5cbiAgICByZXR1cm4gZmFsc2VcbiAgfVxuXG4gIERyb3Bkb3duLnByb3RvdHlwZS5rZXlkb3duID0gZnVuY3Rpb24gKGUpIHtcbiAgICBpZiAoIS8oMzh8NDB8Mjd8MzIpLy50ZXN0KGUud2hpY2gpIHx8IC9pbnB1dHx0ZXh0YXJlYS9pLnRlc3QoZS50YXJnZXQudGFnTmFtZSkpIHJldHVyblxuXG4gICAgdmFyICR0aGlzID0gJCh0aGlzKVxuXG4gICAgZS5wcmV2ZW50RGVmYXVsdCgpXG4gICAgZS5zdG9wUHJvcGFnYXRpb24oKVxuXG4gICAgaWYgKCR0aGlzLmlzKCcuZGlzYWJsZWQsIDpkaXNhYmxlZCcpKSByZXR1cm5cblxuICAgIHZhciAkcGFyZW50ICA9IGdldFBhcmVudCgkdGhpcylcbiAgICB2YXIgaXNBY3RpdmUgPSAkcGFyZW50Lmhhc0NsYXNzKCdvcGVuJylcblxuICAgIGlmICghaXNBY3RpdmUgJiYgZS53aGljaCAhPSAyNyB8fCBpc0FjdGl2ZSAmJiBlLndoaWNoID09IDI3KSB7XG4gICAgICBpZiAoZS53aGljaCA9PSAyNykgJHBhcmVudC5maW5kKHRvZ2dsZSkudHJpZ2dlcignZm9jdXMnKVxuICAgICAgcmV0dXJuICR0aGlzLnRyaWdnZXIoJ2NsaWNrJylcbiAgICB9XG5cbiAgICB2YXIgZGVzYyA9ICcgbGk6bm90KC5kaXNhYmxlZCk6dmlzaWJsZSBhJ1xuICAgIHZhciAkaXRlbXMgPSAkcGFyZW50LmZpbmQoJy5kcm9wZG93bi1tZW51JyArIGRlc2MpXG5cbiAgICBpZiAoISRpdGVtcy5sZW5ndGgpIHJldHVyblxuXG4gICAgdmFyIGluZGV4ID0gJGl0ZW1zLmluZGV4KGUudGFyZ2V0KVxuXG4gICAgaWYgKGUud2hpY2ggPT0gMzggJiYgaW5kZXggPiAwKSAgICAgICAgICAgICAgICAgaW5kZXgtLSAgICAgICAgIC8vIHVwXG4gICAgaWYgKGUud2hpY2ggPT0gNDAgJiYgaW5kZXggPCAkaXRlbXMubGVuZ3RoIC0gMSkgaW5kZXgrKyAgICAgICAgIC8vIGRvd25cbiAgICBpZiAoIX5pbmRleCkgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBpbmRleCA9IDBcblxuICAgICRpdGVtcy5lcShpbmRleCkudHJpZ2dlcignZm9jdXMnKVxuICB9XG5cblxuICAvLyBEUk9QRE9XTiBQTFVHSU4gREVGSU5JVElPTlxuICAvLyA9PT09PT09PT09PT09PT09PT09PT09PT09PVxuXG4gIGZ1bmN0aW9uIFBsdWdpbihvcHRpb24pIHtcbiAgICByZXR1cm4gdGhpcy5lYWNoKGZ1bmN0aW9uICgpIHtcbiAgICAgIHZhciAkdGhpcyA9ICQodGhpcylcbiAgICAgIHZhciBkYXRhICA9ICR0aGlzLmRhdGEoJ2JzLmRyb3Bkb3duJylcblxuICAgICAgaWYgKCFkYXRhKSAkdGhpcy5kYXRhKCdicy5kcm9wZG93bicsIChkYXRhID0gbmV3IERyb3Bkb3duKHRoaXMpKSlcbiAgICAgIGlmICh0eXBlb2Ygb3B0aW9uID09ICdzdHJpbmcnKSBkYXRhW29wdGlvbl0uY2FsbCgkdGhpcylcbiAgICB9KVxuICB9XG5cbiAgdmFyIG9sZCA9ICQuZm4uZHJvcGRvd25cblxuICAkLmZuLmRyb3Bkb3duICAgICAgICAgICAgID0gUGx1Z2luXG4gICQuZm4uZHJvcGRvd24uQ29uc3RydWN0b3IgPSBEcm9wZG93blxuXG5cbiAgLy8gRFJPUERPV04gTk8gQ09ORkxJQ1RcbiAgLy8gPT09PT09PT09PT09PT09PT09PT1cblxuICAkLmZuLmRyb3Bkb3duLm5vQ29uZmxpY3QgPSBmdW5jdGlvbiAoKSB7XG4gICAgJC5mbi5kcm9wZG93biA9IG9sZFxuICAgIHJldHVybiB0aGlzXG4gIH1cblxuXG4gIC8vIEFQUExZIFRPIFNUQU5EQVJEIERST1BET1dOIEVMRU1FTlRTXG4gIC8vID09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09XG5cbiAgJChkb2N1bWVudClcbiAgICAub24oJ2NsaWNrLmJzLmRyb3Bkb3duLmRhdGEtYXBpJywgY2xlYXJNZW51cylcbiAgICAub24oJ2NsaWNrLmJzLmRyb3Bkb3duLmRhdGEtYXBpJywgJy5kcm9wZG93biBmb3JtJywgZnVuY3Rpb24gKGUpIHsgZS5zdG9wUHJvcGFnYXRpb24oKSB9KVxuICAgIC5vbignY2xpY2suYnMuZHJvcGRvd24uZGF0YS1hcGknLCB0b2dnbGUsIERyb3Bkb3duLnByb3RvdHlwZS50b2dnbGUpXG4gICAgLm9uKCdrZXlkb3duLmJzLmRyb3Bkb3duLmRhdGEtYXBpJywgdG9nZ2xlLCBEcm9wZG93bi5wcm90b3R5cGUua2V5ZG93bilcbiAgICAub24oJ2tleWRvd24uYnMuZHJvcGRvd24uZGF0YS1hcGknLCAnLmRyb3Bkb3duLW1lbnUnLCBEcm9wZG93bi5wcm90b3R5cGUua2V5ZG93bilcblxufShqUXVlcnkpO1xuIiwiLyogPT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09XG4gKiBCb290c3RyYXA6IG1vZGFsLmpzIHYzLjMuN1xuICogaHR0cDovL2dldGJvb3RzdHJhcC5jb20vamF2YXNjcmlwdC8jbW9kYWxzXG4gKiA9PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT1cbiAqIENvcHlyaWdodCAyMDExLTIwMTYgVHdpdHRlciwgSW5jLlxuICogTGljZW5zZWQgdW5kZXIgTUlUIChodHRwczovL2dpdGh1Yi5jb20vdHdicy9ib290c3RyYXAvYmxvYi9tYXN0ZXIvTElDRU5TRSlcbiAqID09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PSAqL1xuXG5cbitmdW5jdGlvbiAoJCkge1xuICAndXNlIHN0cmljdCc7XG5cbiAgLy8gTU9EQUwgQ0xBU1MgREVGSU5JVElPTlxuICAvLyA9PT09PT09PT09PT09PT09PT09PT09XG5cbiAgdmFyIE1vZGFsID0gZnVuY3Rpb24gKGVsZW1lbnQsIG9wdGlvbnMpIHtcbiAgICB0aGlzLm9wdGlvbnMgICAgICAgICAgICAgPSBvcHRpb25zXG4gICAgdGhpcy4kYm9keSAgICAgICAgICAgICAgID0gJChkb2N1bWVudC5ib2R5KVxuICAgIHRoaXMuJGVsZW1lbnQgICAgICAgICAgICA9ICQoZWxlbWVudClcbiAgICB0aGlzLiRkaWFsb2cgICAgICAgICAgICAgPSB0aGlzLiRlbGVtZW50LmZpbmQoJy5tb2RhbC1kaWFsb2cnKVxuICAgIHRoaXMuJGJhY2tkcm9wICAgICAgICAgICA9IG51bGxcbiAgICB0aGlzLmlzU2hvd24gICAgICAgICAgICAgPSBudWxsXG4gICAgdGhpcy5vcmlnaW5hbEJvZHlQYWQgICAgID0gbnVsbFxuICAgIHRoaXMuc2Nyb2xsYmFyV2lkdGggICAgICA9IDBcbiAgICB0aGlzLmlnbm9yZUJhY2tkcm9wQ2xpY2sgPSBmYWxzZVxuXG4gICAgaWYgKHRoaXMub3B0aW9ucy5yZW1vdGUpIHtcbiAgICAgIHRoaXMuJGVsZW1lbnRcbiAgICAgICAgLmZpbmQoJy5tb2RhbC1jb250ZW50JylcbiAgICAgICAgLmxvYWQodGhpcy5vcHRpb25zLnJlbW90ZSwgJC5wcm94eShmdW5jdGlvbiAoKSB7XG4gICAgICAgICAgdGhpcy4kZWxlbWVudC50cmlnZ2VyKCdsb2FkZWQuYnMubW9kYWwnKVxuICAgICAgICB9LCB0aGlzKSlcbiAgICB9XG4gIH1cblxuICBNb2RhbC5WRVJTSU9OICA9ICczLjMuNydcblxuICBNb2RhbC5UUkFOU0lUSU9OX0RVUkFUSU9OID0gMzAwXG4gIE1vZGFsLkJBQ0tEUk9QX1RSQU5TSVRJT05fRFVSQVRJT04gPSAxNTBcblxuICBNb2RhbC5ERUZBVUxUUyA9IHtcbiAgICBiYWNrZHJvcDogdHJ1ZSxcbiAgICBrZXlib2FyZDogdHJ1ZSxcbiAgICBzaG93OiB0cnVlXG4gIH1cblxuICBNb2RhbC5wcm90b3R5cGUudG9nZ2xlID0gZnVuY3Rpb24gKF9yZWxhdGVkVGFyZ2V0KSB7XG4gICAgcmV0dXJuIHRoaXMuaXNTaG93biA/IHRoaXMuaGlkZSgpIDogdGhpcy5zaG93KF9yZWxhdGVkVGFyZ2V0KVxuICB9XG5cbiAgTW9kYWwucHJvdG90eXBlLnNob3cgPSBmdW5jdGlvbiAoX3JlbGF0ZWRUYXJnZXQpIHtcbiAgICB2YXIgdGhhdCA9IHRoaXNcbiAgICB2YXIgZSAgICA9ICQuRXZlbnQoJ3Nob3cuYnMubW9kYWwnLCB7IHJlbGF0ZWRUYXJnZXQ6IF9yZWxhdGVkVGFyZ2V0IH0pXG5cbiAgICB0aGlzLiRlbGVtZW50LnRyaWdnZXIoZSlcblxuICAgIGlmICh0aGlzLmlzU2hvd24gfHwgZS5pc0RlZmF1bHRQcmV2ZW50ZWQoKSkgcmV0dXJuXG5cbiAgICB0aGlzLmlzU2hvd24gPSB0cnVlXG5cbiAgICB0aGlzLmNoZWNrU2Nyb2xsYmFyKClcbiAgICB0aGlzLnNldFNjcm9sbGJhcigpXG4gICAgdGhpcy4kYm9keS5hZGRDbGFzcygnbW9kYWwtb3BlbicpXG5cbiAgICB0aGlzLmVzY2FwZSgpXG4gICAgdGhpcy5yZXNpemUoKVxuXG4gICAgdGhpcy4kZWxlbWVudC5vbignY2xpY2suZGlzbWlzcy5icy5tb2RhbCcsICdbZGF0YS1kaXNtaXNzPVwibW9kYWxcIl0nLCAkLnByb3h5KHRoaXMuaGlkZSwgdGhpcykpXG5cbiAgICB0aGlzLiRkaWFsb2cub24oJ21vdXNlZG93bi5kaXNtaXNzLmJzLm1vZGFsJywgZnVuY3Rpb24gKCkge1xuICAgICAgdGhhdC4kZWxlbWVudC5vbmUoJ21vdXNldXAuZGlzbWlzcy5icy5tb2RhbCcsIGZ1bmN0aW9uIChlKSB7XG4gICAgICAgIGlmICgkKGUudGFyZ2V0KS5pcyh0aGF0LiRlbGVtZW50KSkgdGhhdC5pZ25vcmVCYWNrZHJvcENsaWNrID0gdHJ1ZVxuICAgICAgfSlcbiAgICB9KVxuXG4gICAgdGhpcy5iYWNrZHJvcChmdW5jdGlvbiAoKSB7XG4gICAgICB2YXIgdHJhbnNpdGlvbiA9ICQuc3VwcG9ydC50cmFuc2l0aW9uICYmIHRoYXQuJGVsZW1lbnQuaGFzQ2xhc3MoJ2ZhZGUnKVxuXG4gICAgICBpZiAoIXRoYXQuJGVsZW1lbnQucGFyZW50KCkubGVuZ3RoKSB7XG4gICAgICAgIHRoYXQuJGVsZW1lbnQuYXBwZW5kVG8odGhhdC4kYm9keSkgLy8gZG9uJ3QgbW92ZSBtb2RhbHMgZG9tIHBvc2l0aW9uXG4gICAgICB9XG5cbiAgICAgIHRoYXQuJGVsZW1lbnRcbiAgICAgICAgLnNob3coKVxuICAgICAgICAuc2Nyb2xsVG9wKDApXG5cbiAgICAgIHRoYXQuYWRqdXN0RGlhbG9nKClcblxuICAgICAgaWYgKHRyYW5zaXRpb24pIHtcbiAgICAgICAgdGhhdC4kZWxlbWVudFswXS5vZmZzZXRXaWR0aCAvLyBmb3JjZSByZWZsb3dcbiAgICAgIH1cblxuICAgICAgdGhhdC4kZWxlbWVudC5hZGRDbGFzcygnaW4nKVxuXG4gICAgICB0aGF0LmVuZm9yY2VGb2N1cygpXG5cbiAgICAgIHZhciBlID0gJC5FdmVudCgnc2hvd24uYnMubW9kYWwnLCB7IHJlbGF0ZWRUYXJnZXQ6IF9yZWxhdGVkVGFyZ2V0IH0pXG5cbiAgICAgIHRyYW5zaXRpb24gP1xuICAgICAgICB0aGF0LiRkaWFsb2cgLy8gd2FpdCBmb3IgbW9kYWwgdG8gc2xpZGUgaW5cbiAgICAgICAgICAub25lKCdic1RyYW5zaXRpb25FbmQnLCBmdW5jdGlvbiAoKSB7XG4gICAgICAgICAgICB0aGF0LiRlbGVtZW50LnRyaWdnZXIoJ2ZvY3VzJykudHJpZ2dlcihlKVxuICAgICAgICAgIH0pXG4gICAgICAgICAgLmVtdWxhdGVUcmFuc2l0aW9uRW5kKE1vZGFsLlRSQU5TSVRJT05fRFVSQVRJT04pIDpcbiAgICAgICAgdGhhdC4kZWxlbWVudC50cmlnZ2VyKCdmb2N1cycpLnRyaWdnZXIoZSlcbiAgICB9KVxuICB9XG5cbiAgTW9kYWwucHJvdG90eXBlLmhpZGUgPSBmdW5jdGlvbiAoZSkge1xuICAgIGlmIChlKSBlLnByZXZlbnREZWZhdWx0KClcblxuICAgIGUgPSAkLkV2ZW50KCdoaWRlLmJzLm1vZGFsJylcblxuICAgIHRoaXMuJGVsZW1lbnQudHJpZ2dlcihlKVxuXG4gICAgaWYgKCF0aGlzLmlzU2hvd24gfHwgZS5pc0RlZmF1bHRQcmV2ZW50ZWQoKSkgcmV0dXJuXG5cbiAgICB0aGlzLmlzU2hvd24gPSBmYWxzZVxuXG4gICAgdGhpcy5lc2NhcGUoKVxuICAgIHRoaXMucmVzaXplKClcblxuICAgICQoZG9jdW1lbnQpLm9mZignZm9jdXNpbi5icy5tb2RhbCcpXG5cbiAgICB0aGlzLiRlbGVtZW50XG4gICAgICAucmVtb3ZlQ2xhc3MoJ2luJylcbiAgICAgIC5vZmYoJ2NsaWNrLmRpc21pc3MuYnMubW9kYWwnKVxuICAgICAgLm9mZignbW91c2V1cC5kaXNtaXNzLmJzLm1vZGFsJylcblxuICAgIHRoaXMuJGRpYWxvZy5vZmYoJ21vdXNlZG93bi5kaXNtaXNzLmJzLm1vZGFsJylcblxuICAgICQuc3VwcG9ydC50cmFuc2l0aW9uICYmIHRoaXMuJGVsZW1lbnQuaGFzQ2xhc3MoJ2ZhZGUnKSA/XG4gICAgICB0aGlzLiRlbGVtZW50XG4gICAgICAgIC5vbmUoJ2JzVHJhbnNpdGlvbkVuZCcsICQucHJveHkodGhpcy5oaWRlTW9kYWwsIHRoaXMpKVxuICAgICAgICAuZW11bGF0ZVRyYW5zaXRpb25FbmQoTW9kYWwuVFJBTlNJVElPTl9EVVJBVElPTikgOlxuICAgICAgdGhpcy5oaWRlTW9kYWwoKVxuICB9XG5cbiAgTW9kYWwucHJvdG90eXBlLmVuZm9yY2VGb2N1cyA9IGZ1bmN0aW9uICgpIHtcbiAgICAkKGRvY3VtZW50KVxuICAgICAgLm9mZignZm9jdXNpbi5icy5tb2RhbCcpIC8vIGd1YXJkIGFnYWluc3QgaW5maW5pdGUgZm9jdXMgbG9vcFxuICAgICAgLm9uKCdmb2N1c2luLmJzLm1vZGFsJywgJC5wcm94eShmdW5jdGlvbiAoZSkge1xuICAgICAgICBpZiAoZG9jdW1lbnQgIT09IGUudGFyZ2V0ICYmXG4gICAgICAgICAgICB0aGlzLiRlbGVtZW50WzBdICE9PSBlLnRhcmdldCAmJlxuICAgICAgICAgICAgIXRoaXMuJGVsZW1lbnQuaGFzKGUudGFyZ2V0KS5sZW5ndGgpIHtcbiAgICAgICAgICB0aGlzLiRlbGVtZW50LnRyaWdnZXIoJ2ZvY3VzJylcbiAgICAgICAgfVxuICAgICAgfSwgdGhpcykpXG4gIH1cblxuICBNb2RhbC5wcm90b3R5cGUuZXNjYXBlID0gZnVuY3Rpb24gKCkge1xuICAgIGlmICh0aGlzLmlzU2hvd24gJiYgdGhpcy5vcHRpb25zLmtleWJvYXJkKSB7XG4gICAgICB0aGlzLiRlbGVtZW50Lm9uKCdrZXlkb3duLmRpc21pc3MuYnMubW9kYWwnLCAkLnByb3h5KGZ1bmN0aW9uIChlKSB7XG4gICAgICAgIGUud2hpY2ggPT0gMjcgJiYgdGhpcy5oaWRlKClcbiAgICAgIH0sIHRoaXMpKVxuICAgIH0gZWxzZSBpZiAoIXRoaXMuaXNTaG93bikge1xuICAgICAgdGhpcy4kZWxlbWVudC5vZmYoJ2tleWRvd24uZGlzbWlzcy5icy5tb2RhbCcpXG4gICAgfVxuICB9XG5cbiAgTW9kYWwucHJvdG90eXBlLnJlc2l6ZSA9IGZ1bmN0aW9uICgpIHtcbiAgICBpZiAodGhpcy5pc1Nob3duKSB7XG4gICAgICAkKHdpbmRvdykub24oJ3Jlc2l6ZS5icy5tb2RhbCcsICQucHJveHkodGhpcy5oYW5kbGVVcGRhdGUsIHRoaXMpKVxuICAgIH0gZWxzZSB7XG4gICAgICAkKHdpbmRvdykub2ZmKCdyZXNpemUuYnMubW9kYWwnKVxuICAgIH1cbiAgfVxuXG4gIE1vZGFsLnByb3RvdHlwZS5oaWRlTW9kYWwgPSBmdW5jdGlvbiAoKSB7XG4gICAgdmFyIHRoYXQgPSB0aGlzXG4gICAgdGhpcy4kZWxlbWVudC5oaWRlKClcbiAgICB0aGlzLmJhY2tkcm9wKGZ1bmN0aW9uICgpIHtcbiAgICAgIHRoYXQuJGJvZHkucmVtb3ZlQ2xhc3MoJ21vZGFsLW9wZW4nKVxuICAgICAgdGhhdC5yZXNldEFkanVzdG1lbnRzKClcbiAgICAgIHRoYXQucmVzZXRTY3JvbGxiYXIoKVxuICAgICAgdGhhdC4kZWxlbWVudC50cmlnZ2VyKCdoaWRkZW4uYnMubW9kYWwnKVxuICAgIH0pXG4gIH1cblxuICBNb2RhbC5wcm90b3R5cGUucmVtb3ZlQmFja2Ryb3AgPSBmdW5jdGlvbiAoKSB7XG4gICAgdGhpcy4kYmFja2Ryb3AgJiYgdGhpcy4kYmFja2Ryb3AucmVtb3ZlKClcbiAgICB0aGlzLiRiYWNrZHJvcCA9IG51bGxcbiAgfVxuXG4gIE1vZGFsLnByb3RvdHlwZS5iYWNrZHJvcCA9IGZ1bmN0aW9uIChjYWxsYmFjaykge1xuICAgIHZhciB0aGF0ID0gdGhpc1xuICAgIHZhciBhbmltYXRlID0gdGhpcy4kZWxlbWVudC5oYXNDbGFzcygnZmFkZScpID8gJ2ZhZGUnIDogJydcblxuICAgIGlmICh0aGlzLmlzU2hvd24gJiYgdGhpcy5vcHRpb25zLmJhY2tkcm9wKSB7XG4gICAgICB2YXIgZG9BbmltYXRlID0gJC5zdXBwb3J0LnRyYW5zaXRpb24gJiYgYW5pbWF0ZVxuXG4gICAgICB0aGlzLiRiYWNrZHJvcCA9ICQoZG9jdW1lbnQuY3JlYXRlRWxlbWVudCgnZGl2JykpXG4gICAgICAgIC5hZGRDbGFzcygnbW9kYWwtYmFja2Ryb3AgJyArIGFuaW1hdGUpXG4gICAgICAgIC5hcHBlbmRUbyh0aGlzLiRib2R5KVxuXG4gICAgICB0aGlzLiRlbGVtZW50Lm9uKCdjbGljay5kaXNtaXNzLmJzLm1vZGFsJywgJC5wcm94eShmdW5jdGlvbiAoZSkge1xuICAgICAgICBpZiAodGhpcy5pZ25vcmVCYWNrZHJvcENsaWNrKSB7XG4gICAgICAgICAgdGhpcy5pZ25vcmVCYWNrZHJvcENsaWNrID0gZmFsc2VcbiAgICAgICAgICByZXR1cm5cbiAgICAgICAgfVxuICAgICAgICBpZiAoZS50YXJnZXQgIT09IGUuY3VycmVudFRhcmdldCkgcmV0dXJuXG4gICAgICAgIHRoaXMub3B0aW9ucy5iYWNrZHJvcCA9PSAnc3RhdGljJ1xuICAgICAgICAgID8gdGhpcy4kZWxlbWVudFswXS5mb2N1cygpXG4gICAgICAgICAgOiB0aGlzLmhpZGUoKVxuICAgICAgfSwgdGhpcykpXG5cbiAgICAgIGlmIChkb0FuaW1hdGUpIHRoaXMuJGJhY2tkcm9wWzBdLm9mZnNldFdpZHRoIC8vIGZvcmNlIHJlZmxvd1xuXG4gICAgICB0aGlzLiRiYWNrZHJvcC5hZGRDbGFzcygnaW4nKVxuXG4gICAgICBpZiAoIWNhbGxiYWNrKSByZXR1cm5cblxuICAgICAgZG9BbmltYXRlID9cbiAgICAgICAgdGhpcy4kYmFja2Ryb3BcbiAgICAgICAgICAub25lKCdic1RyYW5zaXRpb25FbmQnLCBjYWxsYmFjaylcbiAgICAgICAgICAuZW11bGF0ZVRyYW5zaXRpb25FbmQoTW9kYWwuQkFDS0RST1BfVFJBTlNJVElPTl9EVVJBVElPTikgOlxuICAgICAgICBjYWxsYmFjaygpXG5cbiAgICB9IGVsc2UgaWYgKCF0aGlzLmlzU2hvd24gJiYgdGhpcy4kYmFja2Ryb3ApIHtcbiAgICAgIHRoaXMuJGJhY2tkcm9wLnJlbW92ZUNsYXNzKCdpbicpXG5cbiAgICAgIHZhciBjYWxsYmFja1JlbW92ZSA9IGZ1bmN0aW9uICgpIHtcbiAgICAgICAgdGhhdC5yZW1vdmVCYWNrZHJvcCgpXG4gICAgICAgIGNhbGxiYWNrICYmIGNhbGxiYWNrKClcbiAgICAgIH1cbiAgICAgICQuc3VwcG9ydC50cmFuc2l0aW9uICYmIHRoaXMuJGVsZW1lbnQuaGFzQ2xhc3MoJ2ZhZGUnKSA/XG4gICAgICAgIHRoaXMuJGJhY2tkcm9wXG4gICAgICAgICAgLm9uZSgnYnNUcmFuc2l0aW9uRW5kJywgY2FsbGJhY2tSZW1vdmUpXG4gICAgICAgICAgLmVtdWxhdGVUcmFuc2l0aW9uRW5kKE1vZGFsLkJBQ0tEUk9QX1RSQU5TSVRJT05fRFVSQVRJT04pIDpcbiAgICAgICAgY2FsbGJhY2tSZW1vdmUoKVxuXG4gICAgfSBlbHNlIGlmIChjYWxsYmFjaykge1xuICAgICAgY2FsbGJhY2soKVxuICAgIH1cbiAgfVxuXG4gIC8vIHRoZXNlIGZvbGxvd2luZyBtZXRob2RzIGFyZSB1c2VkIHRvIGhhbmRsZSBvdmVyZmxvd2luZyBtb2RhbHNcblxuICBNb2RhbC5wcm90b3R5cGUuaGFuZGxlVXBkYXRlID0gZnVuY3Rpb24gKCkge1xuICAgIHRoaXMuYWRqdXN0RGlhbG9nKClcbiAgfVxuXG4gIE1vZGFsLnByb3RvdHlwZS5hZGp1c3REaWFsb2cgPSBmdW5jdGlvbiAoKSB7XG4gICAgdmFyIG1vZGFsSXNPdmVyZmxvd2luZyA9IHRoaXMuJGVsZW1lbnRbMF0uc2Nyb2xsSGVpZ2h0ID4gZG9jdW1lbnQuZG9jdW1lbnRFbGVtZW50LmNsaWVudEhlaWdodFxuXG4gICAgdGhpcy4kZWxlbWVudC5jc3Moe1xuICAgICAgcGFkZGluZ0xlZnQ6ICAhdGhpcy5ib2R5SXNPdmVyZmxvd2luZyAmJiBtb2RhbElzT3ZlcmZsb3dpbmcgPyB0aGlzLnNjcm9sbGJhcldpZHRoIDogJycsXG4gICAgICBwYWRkaW5nUmlnaHQ6IHRoaXMuYm9keUlzT3ZlcmZsb3dpbmcgJiYgIW1vZGFsSXNPdmVyZmxvd2luZyA/IHRoaXMuc2Nyb2xsYmFyV2lkdGggOiAnJ1xuICAgIH0pXG4gIH1cblxuICBNb2RhbC5wcm90b3R5cGUucmVzZXRBZGp1c3RtZW50cyA9IGZ1bmN0aW9uICgpIHtcbiAgICB0aGlzLiRlbGVtZW50LmNzcyh7XG4gICAgICBwYWRkaW5nTGVmdDogJycsXG4gICAgICBwYWRkaW5nUmlnaHQ6ICcnXG4gICAgfSlcbiAgfVxuXG4gIE1vZGFsLnByb3RvdHlwZS5jaGVja1Njcm9sbGJhciA9IGZ1bmN0aW9uICgpIHtcbiAgICB2YXIgZnVsbFdpbmRvd1dpZHRoID0gd2luZG93LmlubmVyV2lkdGhcbiAgICBpZiAoIWZ1bGxXaW5kb3dXaWR0aCkgeyAvLyB3b3JrYXJvdW5kIGZvciBtaXNzaW5nIHdpbmRvdy5pbm5lcldpZHRoIGluIElFOFxuICAgICAgdmFyIGRvY3VtZW50RWxlbWVudFJlY3QgPSBkb2N1bWVudC5kb2N1bWVudEVsZW1lbnQuZ2V0Qm91bmRpbmdDbGllbnRSZWN0KClcbiAgICAgIGZ1bGxXaW5kb3dXaWR0aCA9IGRvY3VtZW50RWxlbWVudFJlY3QucmlnaHQgLSBNYXRoLmFicyhkb2N1bWVudEVsZW1lbnRSZWN0LmxlZnQpXG4gICAgfVxuICAgIHRoaXMuYm9keUlzT3ZlcmZsb3dpbmcgPSBkb2N1bWVudC5ib2R5LmNsaWVudFdpZHRoIDwgZnVsbFdpbmRvd1dpZHRoXG4gICAgdGhpcy5zY3JvbGxiYXJXaWR0aCA9IHRoaXMubWVhc3VyZVNjcm9sbGJhcigpXG4gIH1cblxuICBNb2RhbC5wcm90b3R5cGUuc2V0U2Nyb2xsYmFyID0gZnVuY3Rpb24gKCkge1xuICAgIHZhciBib2R5UGFkID0gcGFyc2VJbnQoKHRoaXMuJGJvZHkuY3NzKCdwYWRkaW5nLXJpZ2h0JykgfHwgMCksIDEwKVxuICAgIHRoaXMub3JpZ2luYWxCb2R5UGFkID0gZG9jdW1lbnQuYm9keS5zdHlsZS5wYWRkaW5nUmlnaHQgfHwgJydcbiAgICBpZiAodGhpcy5ib2R5SXNPdmVyZmxvd2luZykgdGhpcy4kYm9keS5jc3MoJ3BhZGRpbmctcmlnaHQnLCBib2R5UGFkICsgdGhpcy5zY3JvbGxiYXJXaWR0aClcbiAgfVxuXG4gIE1vZGFsLnByb3RvdHlwZS5yZXNldFNjcm9sbGJhciA9IGZ1bmN0aW9uICgpIHtcbiAgICB0aGlzLiRib2R5LmNzcygncGFkZGluZy1yaWdodCcsIHRoaXMub3JpZ2luYWxCb2R5UGFkKVxuICB9XG5cbiAgTW9kYWwucHJvdG90eXBlLm1lYXN1cmVTY3JvbGxiYXIgPSBmdW5jdGlvbiAoKSB7IC8vIHRoeCB3YWxzaFxuICAgIHZhciBzY3JvbGxEaXYgPSBkb2N1bWVudC5jcmVhdGVFbGVtZW50KCdkaXYnKVxuICAgIHNjcm9sbERpdi5jbGFzc05hbWUgPSAnbW9kYWwtc2Nyb2xsYmFyLW1lYXN1cmUnXG4gICAgdGhpcy4kYm9keS5hcHBlbmQoc2Nyb2xsRGl2KVxuICAgIHZhciBzY3JvbGxiYXJXaWR0aCA9IHNjcm9sbERpdi5vZmZzZXRXaWR0aCAtIHNjcm9sbERpdi5jbGllbnRXaWR0aFxuICAgIHRoaXMuJGJvZHlbMF0ucmVtb3ZlQ2hpbGQoc2Nyb2xsRGl2KVxuICAgIHJldHVybiBzY3JvbGxiYXJXaWR0aFxuICB9XG5cblxuICAvLyBNT0RBTCBQTFVHSU4gREVGSU5JVElPTlxuICAvLyA9PT09PT09PT09PT09PT09PT09PT09PVxuXG4gIGZ1bmN0aW9uIFBsdWdpbihvcHRpb24sIF9yZWxhdGVkVGFyZ2V0KSB7XG4gICAgcmV0dXJuIHRoaXMuZWFjaChmdW5jdGlvbiAoKSB7XG4gICAgICB2YXIgJHRoaXMgICA9ICQodGhpcylcbiAgICAgIHZhciBkYXRhICAgID0gJHRoaXMuZGF0YSgnYnMubW9kYWwnKVxuICAgICAgdmFyIG9wdGlvbnMgPSAkLmV4dGVuZCh7fSwgTW9kYWwuREVGQVVMVFMsICR0aGlzLmRhdGEoKSwgdHlwZW9mIG9wdGlvbiA9PSAnb2JqZWN0JyAmJiBvcHRpb24pXG5cbiAgICAgIGlmICghZGF0YSkgJHRoaXMuZGF0YSgnYnMubW9kYWwnLCAoZGF0YSA9IG5ldyBNb2RhbCh0aGlzLCBvcHRpb25zKSkpXG4gICAgICBpZiAodHlwZW9mIG9wdGlvbiA9PSAnc3RyaW5nJykgZGF0YVtvcHRpb25dKF9yZWxhdGVkVGFyZ2V0KVxuICAgICAgZWxzZSBpZiAob3B0aW9ucy5zaG93KSBkYXRhLnNob3coX3JlbGF0ZWRUYXJnZXQpXG4gICAgfSlcbiAgfVxuXG4gIHZhciBvbGQgPSAkLmZuLm1vZGFsXG5cbiAgJC5mbi5tb2RhbCAgICAgICAgICAgICA9IFBsdWdpblxuICAkLmZuLm1vZGFsLkNvbnN0cnVjdG9yID0gTW9kYWxcblxuXG4gIC8vIE1PREFMIE5PIENPTkZMSUNUXG4gIC8vID09PT09PT09PT09PT09PT09XG5cbiAgJC5mbi5tb2RhbC5ub0NvbmZsaWN0ID0gZnVuY3Rpb24gKCkge1xuICAgICQuZm4ubW9kYWwgPSBvbGRcbiAgICByZXR1cm4gdGhpc1xuICB9XG5cblxuICAvLyBNT0RBTCBEQVRBLUFQSVxuICAvLyA9PT09PT09PT09PT09PVxuXG4gICQoZG9jdW1lbnQpLm9uKCdjbGljay5icy5tb2RhbC5kYXRhLWFwaScsICdbZGF0YS10b2dnbGU9XCJtb2RhbFwiXScsIGZ1bmN0aW9uIChlKSB7XG4gICAgdmFyICR0aGlzICAgPSAkKHRoaXMpXG4gICAgdmFyIGhyZWYgICAgPSAkdGhpcy5hdHRyKCdocmVmJylcbiAgICB2YXIgJHRhcmdldCA9ICQoJHRoaXMuYXR0cignZGF0YS10YXJnZXQnKSB8fCAoaHJlZiAmJiBocmVmLnJlcGxhY2UoLy4qKD89I1teXFxzXSskKS8sICcnKSkpIC8vIHN0cmlwIGZvciBpZTdcbiAgICB2YXIgb3B0aW9uICA9ICR0YXJnZXQuZGF0YSgnYnMubW9kYWwnKSA/ICd0b2dnbGUnIDogJC5leHRlbmQoeyByZW1vdGU6ICEvIy8udGVzdChocmVmKSAmJiBocmVmIH0sICR0YXJnZXQuZGF0YSgpLCAkdGhpcy5kYXRhKCkpXG5cbiAgICBpZiAoJHRoaXMuaXMoJ2EnKSkgZS5wcmV2ZW50RGVmYXVsdCgpXG5cbiAgICAkdGFyZ2V0Lm9uZSgnc2hvdy5icy5tb2RhbCcsIGZ1bmN0aW9uIChzaG93RXZlbnQpIHtcbiAgICAgIGlmIChzaG93RXZlbnQuaXNEZWZhdWx0UHJldmVudGVkKCkpIHJldHVybiAvLyBvbmx5IHJlZ2lzdGVyIGZvY3VzIHJlc3RvcmVyIGlmIG1vZGFsIHdpbGwgYWN0dWFsbHkgZ2V0IHNob3duXG4gICAgICAkdGFyZ2V0Lm9uZSgnaGlkZGVuLmJzLm1vZGFsJywgZnVuY3Rpb24gKCkge1xuICAgICAgICAkdGhpcy5pcygnOnZpc2libGUnKSAmJiAkdGhpcy50cmlnZ2VyKCdmb2N1cycpXG4gICAgICB9KVxuICAgIH0pXG4gICAgUGx1Z2luLmNhbGwoJHRhcmdldCwgb3B0aW9uLCB0aGlzKVxuICB9KVxuXG59KGpRdWVyeSk7XG4iLCIvKiA9PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT1cbiAqIEJvb3RzdHJhcDogcG9wb3Zlci5qcyB2My4zLjdcbiAqIGh0dHA6Ly9nZXRib290c3RyYXAuY29tL2phdmFzY3JpcHQvI3BvcG92ZXJzXG4gKiA9PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT1cbiAqIENvcHlyaWdodCAyMDExLTIwMTYgVHdpdHRlciwgSW5jLlxuICogTGljZW5zZWQgdW5kZXIgTUlUIChodHRwczovL2dpdGh1Yi5jb20vdHdicy9ib290c3RyYXAvYmxvYi9tYXN0ZXIvTElDRU5TRSlcbiAqID09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PSAqL1xuXG5cbitmdW5jdGlvbiAoJCkge1xuICAndXNlIHN0cmljdCc7XG5cbiAgLy8gUE9QT1ZFUiBQVUJMSUMgQ0xBU1MgREVGSU5JVElPTlxuICAvLyA9PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09XG5cbiAgdmFyIFBvcG92ZXIgPSBmdW5jdGlvbiAoZWxlbWVudCwgb3B0aW9ucykge1xuICAgIHRoaXMuaW5pdCgncG9wb3ZlcicsIGVsZW1lbnQsIG9wdGlvbnMpXG4gIH1cblxuICBpZiAoISQuZm4udG9vbHRpcCkgdGhyb3cgbmV3IEVycm9yKCdQb3BvdmVyIHJlcXVpcmVzIHRvb2x0aXAuanMnKVxuXG4gIFBvcG92ZXIuVkVSU0lPTiAgPSAnMy4zLjcnXG5cbiAgUG9wb3Zlci5ERUZBVUxUUyA9ICQuZXh0ZW5kKHt9LCAkLmZuLnRvb2x0aXAuQ29uc3RydWN0b3IuREVGQVVMVFMsIHtcbiAgICBwbGFjZW1lbnQ6ICdyaWdodCcsXG4gICAgdHJpZ2dlcjogJ2NsaWNrJyxcbiAgICBjb250ZW50OiAnJyxcbiAgICB0ZW1wbGF0ZTogJzxkaXYgY2xhc3M9XCJwb3BvdmVyXCIgcm9sZT1cInRvb2x0aXBcIj48ZGl2IGNsYXNzPVwiYXJyb3dcIj48L2Rpdj48aDMgY2xhc3M9XCJwb3BvdmVyLXRpdGxlXCI+PC9oMz48ZGl2IGNsYXNzPVwicG9wb3Zlci1jb250ZW50XCI+PC9kaXY+PC9kaXY+J1xuICB9KVxuXG5cbiAgLy8gTk9URTogUE9QT1ZFUiBFWFRFTkRTIHRvb2x0aXAuanNcbiAgLy8gPT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT1cblxuICBQb3BvdmVyLnByb3RvdHlwZSA9ICQuZXh0ZW5kKHt9LCAkLmZuLnRvb2x0aXAuQ29uc3RydWN0b3IucHJvdG90eXBlKVxuXG4gIFBvcG92ZXIucHJvdG90eXBlLmNvbnN0cnVjdG9yID0gUG9wb3ZlclxuXG4gIFBvcG92ZXIucHJvdG90eXBlLmdldERlZmF1bHRzID0gZnVuY3Rpb24gKCkge1xuICAgIHJldHVybiBQb3BvdmVyLkRFRkFVTFRTXG4gIH1cblxuICBQb3BvdmVyLnByb3RvdHlwZS5zZXRDb250ZW50ID0gZnVuY3Rpb24gKCkge1xuICAgIHZhciAkdGlwICAgID0gdGhpcy50aXAoKVxuICAgIHZhciB0aXRsZSAgID0gdGhpcy5nZXRUaXRsZSgpXG4gICAgdmFyIGNvbnRlbnQgPSB0aGlzLmdldENvbnRlbnQoKVxuXG4gICAgJHRpcC5maW5kKCcucG9wb3Zlci10aXRsZScpW3RoaXMub3B0aW9ucy5odG1sID8gJ2h0bWwnIDogJ3RleHQnXSh0aXRsZSlcbiAgICAkdGlwLmZpbmQoJy5wb3BvdmVyLWNvbnRlbnQnKS5jaGlsZHJlbigpLmRldGFjaCgpLmVuZCgpWyAvLyB3ZSB1c2UgYXBwZW5kIGZvciBodG1sIG9iamVjdHMgdG8gbWFpbnRhaW4ganMgZXZlbnRzXG4gICAgICB0aGlzLm9wdGlvbnMuaHRtbCA/ICh0eXBlb2YgY29udGVudCA9PSAnc3RyaW5nJyA/ICdodG1sJyA6ICdhcHBlbmQnKSA6ICd0ZXh0J1xuICAgIF0oY29udGVudClcblxuICAgICR0aXAucmVtb3ZlQ2xhc3MoJ2ZhZGUgdG9wIGJvdHRvbSBsZWZ0IHJpZ2h0IGluJylcblxuICAgIC8vIElFOCBkb2Vzbid0IGFjY2VwdCBoaWRpbmcgdmlhIHRoZSBgOmVtcHR5YCBwc2V1ZG8gc2VsZWN0b3IsIHdlIGhhdmUgdG8gZG9cbiAgICAvLyB0aGlzIG1hbnVhbGx5IGJ5IGNoZWNraW5nIHRoZSBjb250ZW50cy5cbiAgICBpZiAoISR0aXAuZmluZCgnLnBvcG92ZXItdGl0bGUnKS5odG1sKCkpICR0aXAuZmluZCgnLnBvcG92ZXItdGl0bGUnKS5oaWRlKClcbiAgfVxuXG4gIFBvcG92ZXIucHJvdG90eXBlLmhhc0NvbnRlbnQgPSBmdW5jdGlvbiAoKSB7XG4gICAgcmV0dXJuIHRoaXMuZ2V0VGl0bGUoKSB8fCB0aGlzLmdldENvbnRlbnQoKVxuICB9XG5cbiAgUG9wb3Zlci5wcm90b3R5cGUuZ2V0Q29udGVudCA9IGZ1bmN0aW9uICgpIHtcbiAgICB2YXIgJGUgPSB0aGlzLiRlbGVtZW50XG4gICAgdmFyIG8gID0gdGhpcy5vcHRpb25zXG5cbiAgICByZXR1cm4gJGUuYXR0cignZGF0YS1jb250ZW50JylcbiAgICAgIHx8ICh0eXBlb2Ygby5jb250ZW50ID09ICdmdW5jdGlvbicgP1xuICAgICAgICAgICAgby5jb250ZW50LmNhbGwoJGVbMF0pIDpcbiAgICAgICAgICAgIG8uY29udGVudClcbiAgfVxuXG4gIFBvcG92ZXIucHJvdG90eXBlLmFycm93ID0gZnVuY3Rpb24gKCkge1xuICAgIHJldHVybiAodGhpcy4kYXJyb3cgPSB0aGlzLiRhcnJvdyB8fCB0aGlzLnRpcCgpLmZpbmQoJy5hcnJvdycpKVxuICB9XG5cblxuICAvLyBQT1BPVkVSIFBMVUdJTiBERUZJTklUSU9OXG4gIC8vID09PT09PT09PT09PT09PT09PT09PT09PT1cblxuICBmdW5jdGlvbiBQbHVnaW4ob3B0aW9uKSB7XG4gICAgcmV0dXJuIHRoaXMuZWFjaChmdW5jdGlvbiAoKSB7XG4gICAgICB2YXIgJHRoaXMgICA9ICQodGhpcylcbiAgICAgIHZhciBkYXRhICAgID0gJHRoaXMuZGF0YSgnYnMucG9wb3ZlcicpXG4gICAgICB2YXIgb3B0aW9ucyA9IHR5cGVvZiBvcHRpb24gPT0gJ29iamVjdCcgJiYgb3B0aW9uXG5cbiAgICAgIGlmICghZGF0YSAmJiAvZGVzdHJveXxoaWRlLy50ZXN0KG9wdGlvbikpIHJldHVyblxuICAgICAgaWYgKCFkYXRhKSAkdGhpcy5kYXRhKCdicy5wb3BvdmVyJywgKGRhdGEgPSBuZXcgUG9wb3Zlcih0aGlzLCBvcHRpb25zKSkpXG4gICAgICBpZiAodHlwZW9mIG9wdGlvbiA9PSAnc3RyaW5nJykgZGF0YVtvcHRpb25dKClcbiAgICB9KVxuICB9XG5cbiAgdmFyIG9sZCA9ICQuZm4ucG9wb3ZlclxuXG4gICQuZm4ucG9wb3ZlciAgICAgICAgICAgICA9IFBsdWdpblxuICAkLmZuLnBvcG92ZXIuQ29uc3RydWN0b3IgPSBQb3BvdmVyXG5cblxuICAvLyBQT1BPVkVSIE5PIENPTkZMSUNUXG4gIC8vID09PT09PT09PT09PT09PT09PT1cblxuICAkLmZuLnBvcG92ZXIubm9Db25mbGljdCA9IGZ1bmN0aW9uICgpIHtcbiAgICAkLmZuLnBvcG92ZXIgPSBvbGRcbiAgICByZXR1cm4gdGhpc1xuICB9XG5cbn0oalF1ZXJ5KTtcbiIsIi8qID09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PVxuICogQm9vdHN0cmFwOiBzY3JvbGxzcHkuanMgdjMuMy43XG4gKiBodHRwOi8vZ2V0Ym9vdHN0cmFwLmNvbS9qYXZhc2NyaXB0LyNzY3JvbGxzcHlcbiAqID09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PVxuICogQ29weXJpZ2h0IDIwMTEtMjAxNiBUd2l0dGVyLCBJbmMuXG4gKiBMaWNlbnNlZCB1bmRlciBNSVQgKGh0dHBzOi8vZ2l0aHViLmNvbS90d2JzL2Jvb3RzdHJhcC9ibG9iL21hc3Rlci9MSUNFTlNFKVxuICogPT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09ICovXG5cblxuK2Z1bmN0aW9uICgkKSB7XG4gICd1c2Ugc3RyaWN0JztcblxuICAvLyBTQ1JPTExTUFkgQ0xBU1MgREVGSU5JVElPTlxuICAvLyA9PT09PT09PT09PT09PT09PT09PT09PT09PVxuXG4gIGZ1bmN0aW9uIFNjcm9sbFNweShlbGVtZW50LCBvcHRpb25zKSB7XG4gICAgdGhpcy4kYm9keSAgICAgICAgICA9ICQoZG9jdW1lbnQuYm9keSlcbiAgICB0aGlzLiRzY3JvbGxFbGVtZW50ID0gJChlbGVtZW50KS5pcyhkb2N1bWVudC5ib2R5KSA/ICQod2luZG93KSA6ICQoZWxlbWVudClcbiAgICB0aGlzLm9wdGlvbnMgICAgICAgID0gJC5leHRlbmQoe30sIFNjcm9sbFNweS5ERUZBVUxUUywgb3B0aW9ucylcbiAgICB0aGlzLnNlbGVjdG9yICAgICAgID0gKHRoaXMub3B0aW9ucy50YXJnZXQgfHwgJycpICsgJyAubmF2IGxpID4gYSdcbiAgICB0aGlzLm9mZnNldHMgICAgICAgID0gW11cbiAgICB0aGlzLnRhcmdldHMgICAgICAgID0gW11cbiAgICB0aGlzLmFjdGl2ZVRhcmdldCAgID0gbnVsbFxuICAgIHRoaXMuc2Nyb2xsSGVpZ2h0ICAgPSAwXG5cbiAgICB0aGlzLiRzY3JvbGxFbGVtZW50Lm9uKCdzY3JvbGwuYnMuc2Nyb2xsc3B5JywgJC5wcm94eSh0aGlzLnByb2Nlc3MsIHRoaXMpKVxuICAgIHRoaXMucmVmcmVzaCgpXG4gICAgdGhpcy5wcm9jZXNzKClcbiAgfVxuXG4gIFNjcm9sbFNweS5WRVJTSU9OICA9ICczLjMuNydcblxuICBTY3JvbGxTcHkuREVGQVVMVFMgPSB7XG4gICAgb2Zmc2V0OiAxMFxuICB9XG5cbiAgU2Nyb2xsU3B5LnByb3RvdHlwZS5nZXRTY3JvbGxIZWlnaHQgPSBmdW5jdGlvbiAoKSB7XG4gICAgcmV0dXJuIHRoaXMuJHNjcm9sbEVsZW1lbnRbMF0uc2Nyb2xsSGVpZ2h0IHx8IE1hdGgubWF4KHRoaXMuJGJvZHlbMF0uc2Nyb2xsSGVpZ2h0LCBkb2N1bWVudC5kb2N1bWVudEVsZW1lbnQuc2Nyb2xsSGVpZ2h0KVxuICB9XG5cbiAgU2Nyb2xsU3B5LnByb3RvdHlwZS5yZWZyZXNoID0gZnVuY3Rpb24gKCkge1xuICAgIHZhciB0aGF0ICAgICAgICAgID0gdGhpc1xuICAgIHZhciBvZmZzZXRNZXRob2QgID0gJ29mZnNldCdcbiAgICB2YXIgb2Zmc2V0QmFzZSAgICA9IDBcblxuICAgIHRoaXMub2Zmc2V0cyAgICAgID0gW11cbiAgICB0aGlzLnRhcmdldHMgICAgICA9IFtdXG4gICAgdGhpcy5zY3JvbGxIZWlnaHQgPSB0aGlzLmdldFNjcm9sbEhlaWdodCgpXG5cbiAgICBpZiAoISQuaXNXaW5kb3codGhpcy4kc2Nyb2xsRWxlbWVudFswXSkpIHtcbiAgICAgIG9mZnNldE1ldGhvZCA9ICdwb3NpdGlvbidcbiAgICAgIG9mZnNldEJhc2UgICA9IHRoaXMuJHNjcm9sbEVsZW1lbnQuc2Nyb2xsVG9wKClcbiAgICB9XG5cbiAgICB0aGlzLiRib2R5XG4gICAgICAuZmluZCh0aGlzLnNlbGVjdG9yKVxuICAgICAgLm1hcChmdW5jdGlvbiAoKSB7XG4gICAgICAgIHZhciAkZWwgICA9ICQodGhpcylcbiAgICAgICAgdmFyIGhyZWYgID0gJGVsLmRhdGEoJ3RhcmdldCcpIHx8ICRlbC5hdHRyKCdocmVmJylcbiAgICAgICAgdmFyICRocmVmID0gL14jLi8udGVzdChocmVmKSAmJiAkKGhyZWYpXG5cbiAgICAgICAgcmV0dXJuICgkaHJlZlxuICAgICAgICAgICYmICRocmVmLmxlbmd0aFxuICAgICAgICAgICYmICRocmVmLmlzKCc6dmlzaWJsZScpXG4gICAgICAgICAgJiYgW1skaHJlZltvZmZzZXRNZXRob2RdKCkudG9wICsgb2Zmc2V0QmFzZSwgaHJlZl1dKSB8fCBudWxsXG4gICAgICB9KVxuICAgICAgLnNvcnQoZnVuY3Rpb24gKGEsIGIpIHsgcmV0dXJuIGFbMF0gLSBiWzBdIH0pXG4gICAgICAuZWFjaChmdW5jdGlvbiAoKSB7XG4gICAgICAgIHRoYXQub2Zmc2V0cy5wdXNoKHRoaXNbMF0pXG4gICAgICAgIHRoYXQudGFyZ2V0cy5wdXNoKHRoaXNbMV0pXG4gICAgICB9KVxuICB9XG5cbiAgU2Nyb2xsU3B5LnByb3RvdHlwZS5wcm9jZXNzID0gZnVuY3Rpb24gKCkge1xuICAgIHZhciBzY3JvbGxUb3AgICAgPSB0aGlzLiRzY3JvbGxFbGVtZW50LnNjcm9sbFRvcCgpICsgdGhpcy5vcHRpb25zLm9mZnNldFxuICAgIHZhciBzY3JvbGxIZWlnaHQgPSB0aGlzLmdldFNjcm9sbEhlaWdodCgpXG4gICAgdmFyIG1heFNjcm9sbCAgICA9IHRoaXMub3B0aW9ucy5vZmZzZXQgKyBzY3JvbGxIZWlnaHQgLSB0aGlzLiRzY3JvbGxFbGVtZW50LmhlaWdodCgpXG4gICAgdmFyIG9mZnNldHMgICAgICA9IHRoaXMub2Zmc2V0c1xuICAgIHZhciB0YXJnZXRzICAgICAgPSB0aGlzLnRhcmdldHNcbiAgICB2YXIgYWN0aXZlVGFyZ2V0ID0gdGhpcy5hY3RpdmVUYXJnZXRcbiAgICB2YXIgaVxuXG4gICAgaWYgKHRoaXMuc2Nyb2xsSGVpZ2h0ICE9IHNjcm9sbEhlaWdodCkge1xuICAgICAgdGhpcy5yZWZyZXNoKClcbiAgICB9XG5cbiAgICBpZiAoc2Nyb2xsVG9wID49IG1heFNjcm9sbCkge1xuICAgICAgcmV0dXJuIGFjdGl2ZVRhcmdldCAhPSAoaSA9IHRhcmdldHNbdGFyZ2V0cy5sZW5ndGggLSAxXSkgJiYgdGhpcy5hY3RpdmF0ZShpKVxuICAgIH1cblxuICAgIGlmIChhY3RpdmVUYXJnZXQgJiYgc2Nyb2xsVG9wIDwgb2Zmc2V0c1swXSkge1xuICAgICAgdGhpcy5hY3RpdmVUYXJnZXQgPSBudWxsXG4gICAgICByZXR1cm4gdGhpcy5jbGVhcigpXG4gICAgfVxuXG4gICAgZm9yIChpID0gb2Zmc2V0cy5sZW5ndGg7IGktLTspIHtcbiAgICAgIGFjdGl2ZVRhcmdldCAhPSB0YXJnZXRzW2ldXG4gICAgICAgICYmIHNjcm9sbFRvcCA+PSBvZmZzZXRzW2ldXG4gICAgICAgICYmIChvZmZzZXRzW2kgKyAxXSA9PT0gdW5kZWZpbmVkIHx8IHNjcm9sbFRvcCA8IG9mZnNldHNbaSArIDFdKVxuICAgICAgICAmJiB0aGlzLmFjdGl2YXRlKHRhcmdldHNbaV0pXG4gICAgfVxuICB9XG5cbiAgU2Nyb2xsU3B5LnByb3RvdHlwZS5hY3RpdmF0ZSA9IGZ1bmN0aW9uICh0YXJnZXQpIHtcbiAgICB0aGlzLmFjdGl2ZVRhcmdldCA9IHRhcmdldFxuXG4gICAgdGhpcy5jbGVhcigpXG5cbiAgICB2YXIgc2VsZWN0b3IgPSB0aGlzLnNlbGVjdG9yICtcbiAgICAgICdbZGF0YS10YXJnZXQ9XCInICsgdGFyZ2V0ICsgJ1wiXSwnICtcbiAgICAgIHRoaXMuc2VsZWN0b3IgKyAnW2hyZWY9XCInICsgdGFyZ2V0ICsgJ1wiXSdcblxuICAgIHZhciBhY3RpdmUgPSAkKHNlbGVjdG9yKVxuICAgICAgLnBhcmVudHMoJ2xpJylcbiAgICAgIC5hZGRDbGFzcygnYWN0aXZlJylcblxuICAgIGlmIChhY3RpdmUucGFyZW50KCcuZHJvcGRvd24tbWVudScpLmxlbmd0aCkge1xuICAgICAgYWN0aXZlID0gYWN0aXZlXG4gICAgICAgIC5jbG9zZXN0KCdsaS5kcm9wZG93bicpXG4gICAgICAgIC5hZGRDbGFzcygnYWN0aXZlJylcbiAgICB9XG5cbiAgICBhY3RpdmUudHJpZ2dlcignYWN0aXZhdGUuYnMuc2Nyb2xsc3B5JylcbiAgfVxuXG4gIFNjcm9sbFNweS5wcm90b3R5cGUuY2xlYXIgPSBmdW5jdGlvbiAoKSB7XG4gICAgJCh0aGlzLnNlbGVjdG9yKVxuICAgICAgLnBhcmVudHNVbnRpbCh0aGlzLm9wdGlvbnMudGFyZ2V0LCAnLmFjdGl2ZScpXG4gICAgICAucmVtb3ZlQ2xhc3MoJ2FjdGl2ZScpXG4gIH1cblxuXG4gIC8vIFNDUk9MTFNQWSBQTFVHSU4gREVGSU5JVElPTlxuICAvLyA9PT09PT09PT09PT09PT09PT09PT09PT09PT1cblxuICBmdW5jdGlvbiBQbHVnaW4ob3B0aW9uKSB7XG4gICAgcmV0dXJuIHRoaXMuZWFjaChmdW5jdGlvbiAoKSB7XG4gICAgICB2YXIgJHRoaXMgICA9ICQodGhpcylcbiAgICAgIHZhciBkYXRhICAgID0gJHRoaXMuZGF0YSgnYnMuc2Nyb2xsc3B5JylcbiAgICAgIHZhciBvcHRpb25zID0gdHlwZW9mIG9wdGlvbiA9PSAnb2JqZWN0JyAmJiBvcHRpb25cblxuICAgICAgaWYgKCFkYXRhKSAkdGhpcy5kYXRhKCdicy5zY3JvbGxzcHknLCAoZGF0YSA9IG5ldyBTY3JvbGxTcHkodGhpcywgb3B0aW9ucykpKVxuICAgICAgaWYgKHR5cGVvZiBvcHRpb24gPT0gJ3N0cmluZycpIGRhdGFbb3B0aW9uXSgpXG4gICAgfSlcbiAgfVxuXG4gIHZhciBvbGQgPSAkLmZuLnNjcm9sbHNweVxuXG4gICQuZm4uc2Nyb2xsc3B5ICAgICAgICAgICAgID0gUGx1Z2luXG4gICQuZm4uc2Nyb2xsc3B5LkNvbnN0cnVjdG9yID0gU2Nyb2xsU3B5XG5cblxuICAvLyBTQ1JPTExTUFkgTk8gQ09ORkxJQ1RcbiAgLy8gPT09PT09PT09PT09PT09PT09PT09XG5cbiAgJC5mbi5zY3JvbGxzcHkubm9Db25mbGljdCA9IGZ1bmN0aW9uICgpIHtcbiAgICAkLmZuLnNjcm9sbHNweSA9IG9sZFxuICAgIHJldHVybiB0aGlzXG4gIH1cblxuXG4gIC8vIFNDUk9MTFNQWSBEQVRBLUFQSVxuICAvLyA9PT09PT09PT09PT09PT09PT1cblxuICAkKHdpbmRvdykub24oJ2xvYWQuYnMuc2Nyb2xsc3B5LmRhdGEtYXBpJywgZnVuY3Rpb24gKCkge1xuICAgICQoJ1tkYXRhLXNweT1cInNjcm9sbFwiXScpLmVhY2goZnVuY3Rpb24gKCkge1xuICAgICAgdmFyICRzcHkgPSAkKHRoaXMpXG4gICAgICBQbHVnaW4uY2FsbCgkc3B5LCAkc3B5LmRhdGEoKSlcbiAgICB9KVxuICB9KVxuXG59KGpRdWVyeSk7XG4iLCIvKiA9PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT1cbiAqIEJvb3RzdHJhcDogdGFiLmpzIHYzLjMuN1xuICogaHR0cDovL2dldGJvb3RzdHJhcC5jb20vamF2YXNjcmlwdC8jdGFic1xuICogPT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09XG4gKiBDb3B5cmlnaHQgMjAxMS0yMDE2IFR3aXR0ZXIsIEluYy5cbiAqIExpY2Vuc2VkIHVuZGVyIE1JVCAoaHR0cHM6Ly9naXRodWIuY29tL3R3YnMvYm9vdHN0cmFwL2Jsb2IvbWFzdGVyL0xJQ0VOU0UpXG4gKiA9PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT0gKi9cblxuXG4rZnVuY3Rpb24gKCQpIHtcbiAgJ3VzZSBzdHJpY3QnO1xuXG4gIC8vIFRBQiBDTEFTUyBERUZJTklUSU9OXG4gIC8vID09PT09PT09PT09PT09PT09PT09XG5cbiAgdmFyIFRhYiA9IGZ1bmN0aW9uIChlbGVtZW50KSB7XG4gICAgLy8ganNjczpkaXNhYmxlIHJlcXVpcmVEb2xsYXJCZWZvcmVqUXVlcnlBc3NpZ25tZW50XG4gICAgdGhpcy5lbGVtZW50ID0gJChlbGVtZW50KVxuICAgIC8vIGpzY3M6ZW5hYmxlIHJlcXVpcmVEb2xsYXJCZWZvcmVqUXVlcnlBc3NpZ25tZW50XG4gIH1cblxuICBUYWIuVkVSU0lPTiA9ICczLjMuNydcblxuICBUYWIuVFJBTlNJVElPTl9EVVJBVElPTiA9IDE1MFxuXG4gIFRhYi5wcm90b3R5cGUuc2hvdyA9IGZ1bmN0aW9uICgpIHtcbiAgICB2YXIgJHRoaXMgICAgPSB0aGlzLmVsZW1lbnRcbiAgICB2YXIgJHVsICAgICAgPSAkdGhpcy5jbG9zZXN0KCd1bDpub3QoLmRyb3Bkb3duLW1lbnUpJylcbiAgICB2YXIgc2VsZWN0b3IgPSAkdGhpcy5kYXRhKCd0YXJnZXQnKVxuXG4gICAgaWYgKCFzZWxlY3Rvcikge1xuICAgICAgc2VsZWN0b3IgPSAkdGhpcy5hdHRyKCdocmVmJylcbiAgICAgIHNlbGVjdG9yID0gc2VsZWN0b3IgJiYgc2VsZWN0b3IucmVwbGFjZSgvLiooPz0jW15cXHNdKiQpLywgJycpIC8vIHN0cmlwIGZvciBpZTdcbiAgICB9XG5cbiAgICBpZiAoJHRoaXMucGFyZW50KCdsaScpLmhhc0NsYXNzKCdhY3RpdmUnKSkgcmV0dXJuXG5cbiAgICB2YXIgJHByZXZpb3VzID0gJHVsLmZpbmQoJy5hY3RpdmU6bGFzdCBhJylcbiAgICB2YXIgaGlkZUV2ZW50ID0gJC5FdmVudCgnaGlkZS5icy50YWInLCB7XG4gICAgICByZWxhdGVkVGFyZ2V0OiAkdGhpc1swXVxuICAgIH0pXG4gICAgdmFyIHNob3dFdmVudCA9ICQuRXZlbnQoJ3Nob3cuYnMudGFiJywge1xuICAgICAgcmVsYXRlZFRhcmdldDogJHByZXZpb3VzWzBdXG4gICAgfSlcblxuICAgICRwcmV2aW91cy50cmlnZ2VyKGhpZGVFdmVudClcbiAgICAkdGhpcy50cmlnZ2VyKHNob3dFdmVudClcblxuICAgIGlmIChzaG93RXZlbnQuaXNEZWZhdWx0UHJldmVudGVkKCkgfHwgaGlkZUV2ZW50LmlzRGVmYXVsdFByZXZlbnRlZCgpKSByZXR1cm5cblxuICAgIHZhciAkdGFyZ2V0ID0gJChzZWxlY3RvcilcblxuICAgIHRoaXMuYWN0aXZhdGUoJHRoaXMuY2xvc2VzdCgnbGknKSwgJHVsKVxuICAgIHRoaXMuYWN0aXZhdGUoJHRhcmdldCwgJHRhcmdldC5wYXJlbnQoKSwgZnVuY3Rpb24gKCkge1xuICAgICAgJHByZXZpb3VzLnRyaWdnZXIoe1xuICAgICAgICB0eXBlOiAnaGlkZGVuLmJzLnRhYicsXG4gICAgICAgIHJlbGF0ZWRUYXJnZXQ6ICR0aGlzWzBdXG4gICAgICB9KVxuICAgICAgJHRoaXMudHJpZ2dlcih7XG4gICAgICAgIHR5cGU6ICdzaG93bi5icy50YWInLFxuICAgICAgICByZWxhdGVkVGFyZ2V0OiAkcHJldmlvdXNbMF1cbiAgICAgIH0pXG4gICAgfSlcbiAgfVxuXG4gIFRhYi5wcm90b3R5cGUuYWN0aXZhdGUgPSBmdW5jdGlvbiAoZWxlbWVudCwgY29udGFpbmVyLCBjYWxsYmFjaykge1xuICAgIHZhciAkYWN0aXZlICAgID0gY29udGFpbmVyLmZpbmQoJz4gLmFjdGl2ZScpXG4gICAgdmFyIHRyYW5zaXRpb24gPSBjYWxsYmFja1xuICAgICAgJiYgJC5zdXBwb3J0LnRyYW5zaXRpb25cbiAgICAgICYmICgkYWN0aXZlLmxlbmd0aCAmJiAkYWN0aXZlLmhhc0NsYXNzKCdmYWRlJykgfHwgISFjb250YWluZXIuZmluZCgnPiAuZmFkZScpLmxlbmd0aClcblxuICAgIGZ1bmN0aW9uIG5leHQoKSB7XG4gICAgICAkYWN0aXZlXG4gICAgICAgIC5yZW1vdmVDbGFzcygnYWN0aXZlJylcbiAgICAgICAgLmZpbmQoJz4gLmRyb3Bkb3duLW1lbnUgPiAuYWN0aXZlJylcbiAgICAgICAgICAucmVtb3ZlQ2xhc3MoJ2FjdGl2ZScpXG4gICAgICAgIC5lbmQoKVxuICAgICAgICAuZmluZCgnW2RhdGEtdG9nZ2xlPVwidGFiXCJdJylcbiAgICAgICAgICAuYXR0cignYXJpYS1leHBhbmRlZCcsIGZhbHNlKVxuXG4gICAgICBlbGVtZW50XG4gICAgICAgIC5hZGRDbGFzcygnYWN0aXZlJylcbiAgICAgICAgLmZpbmQoJ1tkYXRhLXRvZ2dsZT1cInRhYlwiXScpXG4gICAgICAgICAgLmF0dHIoJ2FyaWEtZXhwYW5kZWQnLCB0cnVlKVxuXG4gICAgICBpZiAodHJhbnNpdGlvbikge1xuICAgICAgICBlbGVtZW50WzBdLm9mZnNldFdpZHRoIC8vIHJlZmxvdyBmb3IgdHJhbnNpdGlvblxuICAgICAgICBlbGVtZW50LmFkZENsYXNzKCdpbicpXG4gICAgICB9IGVsc2Uge1xuICAgICAgICBlbGVtZW50LnJlbW92ZUNsYXNzKCdmYWRlJylcbiAgICAgIH1cblxuICAgICAgaWYgKGVsZW1lbnQucGFyZW50KCcuZHJvcGRvd24tbWVudScpLmxlbmd0aCkge1xuICAgICAgICBlbGVtZW50XG4gICAgICAgICAgLmNsb3Nlc3QoJ2xpLmRyb3Bkb3duJylcbiAgICAgICAgICAgIC5hZGRDbGFzcygnYWN0aXZlJylcbiAgICAgICAgICAuZW5kKClcbiAgICAgICAgICAuZmluZCgnW2RhdGEtdG9nZ2xlPVwidGFiXCJdJylcbiAgICAgICAgICAgIC5hdHRyKCdhcmlhLWV4cGFuZGVkJywgdHJ1ZSlcbiAgICAgIH1cblxuICAgICAgY2FsbGJhY2sgJiYgY2FsbGJhY2soKVxuICAgIH1cblxuICAgICRhY3RpdmUubGVuZ3RoICYmIHRyYW5zaXRpb24gP1xuICAgICAgJGFjdGl2ZVxuICAgICAgICAub25lKCdic1RyYW5zaXRpb25FbmQnLCBuZXh0KVxuICAgICAgICAuZW11bGF0ZVRyYW5zaXRpb25FbmQoVGFiLlRSQU5TSVRJT05fRFVSQVRJT04pIDpcbiAgICAgIG5leHQoKVxuXG4gICAgJGFjdGl2ZS5yZW1vdmVDbGFzcygnaW4nKVxuICB9XG5cblxuICAvLyBUQUIgUExVR0lOIERFRklOSVRJT05cbiAgLy8gPT09PT09PT09PT09PT09PT09PT09XG5cbiAgZnVuY3Rpb24gUGx1Z2luKG9wdGlvbikge1xuICAgIHJldHVybiB0aGlzLmVhY2goZnVuY3Rpb24gKCkge1xuICAgICAgdmFyICR0aGlzID0gJCh0aGlzKVxuICAgICAgdmFyIGRhdGEgID0gJHRoaXMuZGF0YSgnYnMudGFiJylcblxuICAgICAgaWYgKCFkYXRhKSAkdGhpcy5kYXRhKCdicy50YWInLCAoZGF0YSA9IG5ldyBUYWIodGhpcykpKVxuICAgICAgaWYgKHR5cGVvZiBvcHRpb24gPT0gJ3N0cmluZycpIGRhdGFbb3B0aW9uXSgpXG4gICAgfSlcbiAgfVxuXG4gIHZhciBvbGQgPSAkLmZuLnRhYlxuXG4gICQuZm4udGFiICAgICAgICAgICAgID0gUGx1Z2luXG4gICQuZm4udGFiLkNvbnN0cnVjdG9yID0gVGFiXG5cblxuICAvLyBUQUIgTk8gQ09ORkxJQ1RcbiAgLy8gPT09PT09PT09PT09PT09XG5cbiAgJC5mbi50YWIubm9Db25mbGljdCA9IGZ1bmN0aW9uICgpIHtcbiAgICAkLmZuLnRhYiA9IG9sZFxuICAgIHJldHVybiB0aGlzXG4gIH1cblxuXG4gIC8vIFRBQiBEQVRBLUFQSVxuICAvLyA9PT09PT09PT09PT1cblxuICB2YXIgY2xpY2tIYW5kbGVyID0gZnVuY3Rpb24gKGUpIHtcbiAgICBlLnByZXZlbnREZWZhdWx0KClcbiAgICBQbHVnaW4uY2FsbCgkKHRoaXMpLCAnc2hvdycpXG4gIH1cblxuICAkKGRvY3VtZW50KVxuICAgIC5vbignY2xpY2suYnMudGFiLmRhdGEtYXBpJywgJ1tkYXRhLXRvZ2dsZT1cInRhYlwiXScsIGNsaWNrSGFuZGxlcilcbiAgICAub24oJ2NsaWNrLmJzLnRhYi5kYXRhLWFwaScsICdbZGF0YS10b2dnbGU9XCJwaWxsXCJdJywgY2xpY2tIYW5kbGVyKVxuXG59KGpRdWVyeSk7XG4iLCIvKiA9PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT1cbiAqIEJvb3RzdHJhcDogdG9vbHRpcC5qcyB2My4zLjdcbiAqIGh0dHA6Ly9nZXRib290c3RyYXAuY29tL2phdmFzY3JpcHQvI3Rvb2x0aXBcbiAqIEluc3BpcmVkIGJ5IHRoZSBvcmlnaW5hbCBqUXVlcnkudGlwc3kgYnkgSmFzb24gRnJhbWVcbiAqID09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PVxuICogQ29weXJpZ2h0IDIwMTEtMjAxNiBUd2l0dGVyLCBJbmMuXG4gKiBMaWNlbnNlZCB1bmRlciBNSVQgKGh0dHBzOi8vZ2l0aHViLmNvbS90d2JzL2Jvb3RzdHJhcC9ibG9iL21hc3Rlci9MSUNFTlNFKVxuICogPT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09ICovXG5cblxuK2Z1bmN0aW9uICgkKSB7XG4gICd1c2Ugc3RyaWN0JztcblxuICAvLyBUT09MVElQIFBVQkxJQyBDTEFTUyBERUZJTklUSU9OXG4gIC8vID09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT1cblxuICB2YXIgVG9vbHRpcCA9IGZ1bmN0aW9uIChlbGVtZW50LCBvcHRpb25zKSB7XG4gICAgdGhpcy50eXBlICAgICAgID0gbnVsbFxuICAgIHRoaXMub3B0aW9ucyAgICA9IG51bGxcbiAgICB0aGlzLmVuYWJsZWQgICAgPSBudWxsXG4gICAgdGhpcy50aW1lb3V0ICAgID0gbnVsbFxuICAgIHRoaXMuaG92ZXJTdGF0ZSA9IG51bGxcbiAgICB0aGlzLiRlbGVtZW50ICAgPSBudWxsXG4gICAgdGhpcy5pblN0YXRlICAgID0gbnVsbFxuXG4gICAgdGhpcy5pbml0KCd0b29sdGlwJywgZWxlbWVudCwgb3B0aW9ucylcbiAgfVxuXG4gIFRvb2x0aXAuVkVSU0lPTiAgPSAnMy4zLjcnXG5cbiAgVG9vbHRpcC5UUkFOU0lUSU9OX0RVUkFUSU9OID0gMTUwXG5cbiAgVG9vbHRpcC5ERUZBVUxUUyA9IHtcbiAgICBhbmltYXRpb246IHRydWUsXG4gICAgcGxhY2VtZW50OiAndG9wJyxcbiAgICBzZWxlY3RvcjogZmFsc2UsXG4gICAgdGVtcGxhdGU6ICc8ZGl2IGNsYXNzPVwidG9vbHRpcFwiIHJvbGU9XCJ0b29sdGlwXCI+PGRpdiBjbGFzcz1cInRvb2x0aXAtYXJyb3dcIj48L2Rpdj48ZGl2IGNsYXNzPVwidG9vbHRpcC1pbm5lclwiPjwvZGl2PjwvZGl2PicsXG4gICAgdHJpZ2dlcjogJ2hvdmVyIGZvY3VzJyxcbiAgICB0aXRsZTogJycsXG4gICAgZGVsYXk6IDAsXG4gICAgaHRtbDogZmFsc2UsXG4gICAgY29udGFpbmVyOiBmYWxzZSxcbiAgICB2aWV3cG9ydDoge1xuICAgICAgc2VsZWN0b3I6ICdib2R5JyxcbiAgICAgIHBhZGRpbmc6IDBcbiAgICB9XG4gIH1cblxuICBUb29sdGlwLnByb3RvdHlwZS5pbml0ID0gZnVuY3Rpb24gKHR5cGUsIGVsZW1lbnQsIG9wdGlvbnMpIHtcbiAgICB0aGlzLmVuYWJsZWQgICA9IHRydWVcbiAgICB0aGlzLnR5cGUgICAgICA9IHR5cGVcbiAgICB0aGlzLiRlbGVtZW50ICA9ICQoZWxlbWVudClcbiAgICB0aGlzLm9wdGlvbnMgICA9IHRoaXMuZ2V0T3B0aW9ucyhvcHRpb25zKVxuICAgIHRoaXMuJHZpZXdwb3J0ID0gdGhpcy5vcHRpb25zLnZpZXdwb3J0ICYmICQoJC5pc0Z1bmN0aW9uKHRoaXMub3B0aW9ucy52aWV3cG9ydCkgPyB0aGlzLm9wdGlvbnMudmlld3BvcnQuY2FsbCh0aGlzLCB0aGlzLiRlbGVtZW50KSA6ICh0aGlzLm9wdGlvbnMudmlld3BvcnQuc2VsZWN0b3IgfHwgdGhpcy5vcHRpb25zLnZpZXdwb3J0KSlcbiAgICB0aGlzLmluU3RhdGUgICA9IHsgY2xpY2s6IGZhbHNlLCBob3ZlcjogZmFsc2UsIGZvY3VzOiBmYWxzZSB9XG5cbiAgICBpZiAodGhpcy4kZWxlbWVudFswXSBpbnN0YW5jZW9mIGRvY3VtZW50LmNvbnN0cnVjdG9yICYmICF0aGlzLm9wdGlvbnMuc2VsZWN0b3IpIHtcbiAgICAgIHRocm93IG5ldyBFcnJvcignYHNlbGVjdG9yYCBvcHRpb24gbXVzdCBiZSBzcGVjaWZpZWQgd2hlbiBpbml0aWFsaXppbmcgJyArIHRoaXMudHlwZSArICcgb24gdGhlIHdpbmRvdy5kb2N1bWVudCBvYmplY3QhJylcbiAgICB9XG5cbiAgICB2YXIgdHJpZ2dlcnMgPSB0aGlzLm9wdGlvbnMudHJpZ2dlci5zcGxpdCgnICcpXG5cbiAgICBmb3IgKHZhciBpID0gdHJpZ2dlcnMubGVuZ3RoOyBpLS07KSB7XG4gICAgICB2YXIgdHJpZ2dlciA9IHRyaWdnZXJzW2ldXG5cbiAgICAgIGlmICh0cmlnZ2VyID09ICdjbGljaycpIHtcbiAgICAgICAgdGhpcy4kZWxlbWVudC5vbignY2xpY2suJyArIHRoaXMudHlwZSwgdGhpcy5vcHRpb25zLnNlbGVjdG9yLCAkLnByb3h5KHRoaXMudG9nZ2xlLCB0aGlzKSlcbiAgICAgIH0gZWxzZSBpZiAodHJpZ2dlciAhPSAnbWFudWFsJykge1xuICAgICAgICB2YXIgZXZlbnRJbiAgPSB0cmlnZ2VyID09ICdob3ZlcicgPyAnbW91c2VlbnRlcicgOiAnZm9jdXNpbidcbiAgICAgICAgdmFyIGV2ZW50T3V0ID0gdHJpZ2dlciA9PSAnaG92ZXInID8gJ21vdXNlbGVhdmUnIDogJ2ZvY3Vzb3V0J1xuXG4gICAgICAgIHRoaXMuJGVsZW1lbnQub24oZXZlbnRJbiAgKyAnLicgKyB0aGlzLnR5cGUsIHRoaXMub3B0aW9ucy5zZWxlY3RvciwgJC5wcm94eSh0aGlzLmVudGVyLCB0aGlzKSlcbiAgICAgICAgdGhpcy4kZWxlbWVudC5vbihldmVudE91dCArICcuJyArIHRoaXMudHlwZSwgdGhpcy5vcHRpb25zLnNlbGVjdG9yLCAkLnByb3h5KHRoaXMubGVhdmUsIHRoaXMpKVxuICAgICAgfVxuICAgIH1cblxuICAgIHRoaXMub3B0aW9ucy5zZWxlY3RvciA/XG4gICAgICAodGhpcy5fb3B0aW9ucyA9ICQuZXh0ZW5kKHt9LCB0aGlzLm9wdGlvbnMsIHsgdHJpZ2dlcjogJ21hbnVhbCcsIHNlbGVjdG9yOiAnJyB9KSkgOlxuICAgICAgdGhpcy5maXhUaXRsZSgpXG4gIH1cblxuICBUb29sdGlwLnByb3RvdHlwZS5nZXREZWZhdWx0cyA9IGZ1bmN0aW9uICgpIHtcbiAgICByZXR1cm4gVG9vbHRpcC5ERUZBVUxUU1xuICB9XG5cbiAgVG9vbHRpcC5wcm90b3R5cGUuZ2V0T3B0aW9ucyA9IGZ1bmN0aW9uIChvcHRpb25zKSB7XG4gICAgb3B0aW9ucyA9ICQuZXh0ZW5kKHt9LCB0aGlzLmdldERlZmF1bHRzKCksIHRoaXMuJGVsZW1lbnQuZGF0YSgpLCBvcHRpb25zKVxuXG4gICAgaWYgKG9wdGlvbnMuZGVsYXkgJiYgdHlwZW9mIG9wdGlvbnMuZGVsYXkgPT0gJ251bWJlcicpIHtcbiAgICAgIG9wdGlvbnMuZGVsYXkgPSB7XG4gICAgICAgIHNob3c6IG9wdGlvbnMuZGVsYXksXG4gICAgICAgIGhpZGU6IG9wdGlvbnMuZGVsYXlcbiAgICAgIH1cbiAgICB9XG5cbiAgICByZXR1cm4gb3B0aW9uc1xuICB9XG5cbiAgVG9vbHRpcC5wcm90b3R5cGUuZ2V0RGVsZWdhdGVPcHRpb25zID0gZnVuY3Rpb24gKCkge1xuICAgIHZhciBvcHRpb25zICA9IHt9XG4gICAgdmFyIGRlZmF1bHRzID0gdGhpcy5nZXREZWZhdWx0cygpXG5cbiAgICB0aGlzLl9vcHRpb25zICYmICQuZWFjaCh0aGlzLl9vcHRpb25zLCBmdW5jdGlvbiAoa2V5LCB2YWx1ZSkge1xuICAgICAgaWYgKGRlZmF1bHRzW2tleV0gIT0gdmFsdWUpIG9wdGlvbnNba2V5XSA9IHZhbHVlXG4gICAgfSlcblxuICAgIHJldHVybiBvcHRpb25zXG4gIH1cblxuICBUb29sdGlwLnByb3RvdHlwZS5lbnRlciA9IGZ1bmN0aW9uIChvYmopIHtcbiAgICB2YXIgc2VsZiA9IG9iaiBpbnN0YW5jZW9mIHRoaXMuY29uc3RydWN0b3IgP1xuICAgICAgb2JqIDogJChvYmouY3VycmVudFRhcmdldCkuZGF0YSgnYnMuJyArIHRoaXMudHlwZSlcblxuICAgIGlmICghc2VsZikge1xuICAgICAgc2VsZiA9IG5ldyB0aGlzLmNvbnN0cnVjdG9yKG9iai5jdXJyZW50VGFyZ2V0LCB0aGlzLmdldERlbGVnYXRlT3B0aW9ucygpKVxuICAgICAgJChvYmouY3VycmVudFRhcmdldCkuZGF0YSgnYnMuJyArIHRoaXMudHlwZSwgc2VsZilcbiAgICB9XG5cbiAgICBpZiAob2JqIGluc3RhbmNlb2YgJC5FdmVudCkge1xuICAgICAgc2VsZi5pblN0YXRlW29iai50eXBlID09ICdmb2N1c2luJyA/ICdmb2N1cycgOiAnaG92ZXInXSA9IHRydWVcbiAgICB9XG5cbiAgICBpZiAoc2VsZi50aXAoKS5oYXNDbGFzcygnaW4nKSB8fCBzZWxmLmhvdmVyU3RhdGUgPT0gJ2luJykge1xuICAgICAgc2VsZi5ob3ZlclN0YXRlID0gJ2luJ1xuICAgICAgcmV0dXJuXG4gICAgfVxuXG4gICAgY2xlYXJUaW1lb3V0KHNlbGYudGltZW91dClcblxuICAgIHNlbGYuaG92ZXJTdGF0ZSA9ICdpbidcblxuICAgIGlmICghc2VsZi5vcHRpb25zLmRlbGF5IHx8ICFzZWxmLm9wdGlvbnMuZGVsYXkuc2hvdykgcmV0dXJuIHNlbGYuc2hvdygpXG5cbiAgICBzZWxmLnRpbWVvdXQgPSBzZXRUaW1lb3V0KGZ1bmN0aW9uICgpIHtcbiAgICAgIGlmIChzZWxmLmhvdmVyU3RhdGUgPT0gJ2luJykgc2VsZi5zaG93KClcbiAgICB9LCBzZWxmLm9wdGlvbnMuZGVsYXkuc2hvdylcbiAgfVxuXG4gIFRvb2x0aXAucHJvdG90eXBlLmlzSW5TdGF0ZVRydWUgPSBmdW5jdGlvbiAoKSB7XG4gICAgZm9yICh2YXIga2V5IGluIHRoaXMuaW5TdGF0ZSkge1xuICAgICAgaWYgKHRoaXMuaW5TdGF0ZVtrZXldKSByZXR1cm4gdHJ1ZVxuICAgIH1cblxuICAgIHJldHVybiBmYWxzZVxuICB9XG5cbiAgVG9vbHRpcC5wcm90b3R5cGUubGVhdmUgPSBmdW5jdGlvbiAob2JqKSB7XG4gICAgdmFyIHNlbGYgPSBvYmogaW5zdGFuY2VvZiB0aGlzLmNvbnN0cnVjdG9yID9cbiAgICAgIG9iaiA6ICQob2JqLmN1cnJlbnRUYXJnZXQpLmRhdGEoJ2JzLicgKyB0aGlzLnR5cGUpXG5cbiAgICBpZiAoIXNlbGYpIHtcbiAgICAgIHNlbGYgPSBuZXcgdGhpcy5jb25zdHJ1Y3RvcihvYmouY3VycmVudFRhcmdldCwgdGhpcy5nZXREZWxlZ2F0ZU9wdGlvbnMoKSlcbiAgICAgICQob2JqLmN1cnJlbnRUYXJnZXQpLmRhdGEoJ2JzLicgKyB0aGlzLnR5cGUsIHNlbGYpXG4gICAgfVxuXG4gICAgaWYgKG9iaiBpbnN0YW5jZW9mICQuRXZlbnQpIHtcbiAgICAgIHNlbGYuaW5TdGF0ZVtvYmoudHlwZSA9PSAnZm9jdXNvdXQnID8gJ2ZvY3VzJyA6ICdob3ZlciddID0gZmFsc2VcbiAgICB9XG5cbiAgICBpZiAoc2VsZi5pc0luU3RhdGVUcnVlKCkpIHJldHVyblxuXG4gICAgY2xlYXJUaW1lb3V0KHNlbGYudGltZW91dClcblxuICAgIHNlbGYuaG92ZXJTdGF0ZSA9ICdvdXQnXG5cbiAgICBpZiAoIXNlbGYub3B0aW9ucy5kZWxheSB8fCAhc2VsZi5vcHRpb25zLmRlbGF5LmhpZGUpIHJldHVybiBzZWxmLmhpZGUoKVxuXG4gICAgc2VsZi50aW1lb3V0ID0gc2V0VGltZW91dChmdW5jdGlvbiAoKSB7XG4gICAgICBpZiAoc2VsZi5ob3ZlclN0YXRlID09ICdvdXQnKSBzZWxmLmhpZGUoKVxuICAgIH0sIHNlbGYub3B0aW9ucy5kZWxheS5oaWRlKVxuICB9XG5cbiAgVG9vbHRpcC5wcm90b3R5cGUuc2hvdyA9IGZ1bmN0aW9uICgpIHtcbiAgICB2YXIgZSA9ICQuRXZlbnQoJ3Nob3cuYnMuJyArIHRoaXMudHlwZSlcblxuICAgIGlmICh0aGlzLmhhc0NvbnRlbnQoKSAmJiB0aGlzLmVuYWJsZWQpIHtcbiAgICAgIHRoaXMuJGVsZW1lbnQudHJpZ2dlcihlKVxuXG4gICAgICB2YXIgaW5Eb20gPSAkLmNvbnRhaW5zKHRoaXMuJGVsZW1lbnRbMF0ub3duZXJEb2N1bWVudC5kb2N1bWVudEVsZW1lbnQsIHRoaXMuJGVsZW1lbnRbMF0pXG4gICAgICBpZiAoZS5pc0RlZmF1bHRQcmV2ZW50ZWQoKSB8fCAhaW5Eb20pIHJldHVyblxuICAgICAgdmFyIHRoYXQgPSB0aGlzXG5cbiAgICAgIHZhciAkdGlwID0gdGhpcy50aXAoKVxuXG4gICAgICB2YXIgdGlwSWQgPSB0aGlzLmdldFVJRCh0aGlzLnR5cGUpXG5cbiAgICAgIHRoaXMuc2V0Q29udGVudCgpXG4gICAgICAkdGlwLmF0dHIoJ2lkJywgdGlwSWQpXG4gICAgICB0aGlzLiRlbGVtZW50LmF0dHIoJ2FyaWEtZGVzY3JpYmVkYnknLCB0aXBJZClcblxuICAgICAgaWYgKHRoaXMub3B0aW9ucy5hbmltYXRpb24pICR0aXAuYWRkQ2xhc3MoJ2ZhZGUnKVxuXG4gICAgICB2YXIgcGxhY2VtZW50ID0gdHlwZW9mIHRoaXMub3B0aW9ucy5wbGFjZW1lbnQgPT0gJ2Z1bmN0aW9uJyA/XG4gICAgICAgIHRoaXMub3B0aW9ucy5wbGFjZW1lbnQuY2FsbCh0aGlzLCAkdGlwWzBdLCB0aGlzLiRlbGVtZW50WzBdKSA6XG4gICAgICAgIHRoaXMub3B0aW9ucy5wbGFjZW1lbnRcblxuICAgICAgdmFyIGF1dG9Ub2tlbiA9IC9cXHM/YXV0bz9cXHM/L2lcbiAgICAgIHZhciBhdXRvUGxhY2UgPSBhdXRvVG9rZW4udGVzdChwbGFjZW1lbnQpXG4gICAgICBpZiAoYXV0b1BsYWNlKSBwbGFjZW1lbnQgPSBwbGFjZW1lbnQucmVwbGFjZShhdXRvVG9rZW4sICcnKSB8fCAndG9wJ1xuXG4gICAgICAkdGlwXG4gICAgICAgIC5kZXRhY2goKVxuICAgICAgICAuY3NzKHsgdG9wOiAwLCBsZWZ0OiAwLCBkaXNwbGF5OiAnYmxvY2snIH0pXG4gICAgICAgIC5hZGRDbGFzcyhwbGFjZW1lbnQpXG4gICAgICAgIC5kYXRhKCdicy4nICsgdGhpcy50eXBlLCB0aGlzKVxuXG4gICAgICB0aGlzLm9wdGlvbnMuY29udGFpbmVyID8gJHRpcC5hcHBlbmRUbyh0aGlzLm9wdGlvbnMuY29udGFpbmVyKSA6ICR0aXAuaW5zZXJ0QWZ0ZXIodGhpcy4kZWxlbWVudClcbiAgICAgIHRoaXMuJGVsZW1lbnQudHJpZ2dlcignaW5zZXJ0ZWQuYnMuJyArIHRoaXMudHlwZSlcblxuICAgICAgdmFyIHBvcyAgICAgICAgICA9IHRoaXMuZ2V0UG9zaXRpb24oKVxuICAgICAgdmFyIGFjdHVhbFdpZHRoICA9ICR0aXBbMF0ub2Zmc2V0V2lkdGhcbiAgICAgIHZhciBhY3R1YWxIZWlnaHQgPSAkdGlwWzBdLm9mZnNldEhlaWdodFxuXG4gICAgICBpZiAoYXV0b1BsYWNlKSB7XG4gICAgICAgIHZhciBvcmdQbGFjZW1lbnQgPSBwbGFjZW1lbnRcbiAgICAgICAgdmFyIHZpZXdwb3J0RGltID0gdGhpcy5nZXRQb3NpdGlvbih0aGlzLiR2aWV3cG9ydClcblxuICAgICAgICBwbGFjZW1lbnQgPSBwbGFjZW1lbnQgPT0gJ2JvdHRvbScgJiYgcG9zLmJvdHRvbSArIGFjdHVhbEhlaWdodCA+IHZpZXdwb3J0RGltLmJvdHRvbSA/ICd0b3AnICAgIDpcbiAgICAgICAgICAgICAgICAgICAgcGxhY2VtZW50ID09ICd0b3AnICAgICYmIHBvcy50b3AgICAgLSBhY3R1YWxIZWlnaHQgPCB2aWV3cG9ydERpbS50b3AgICAgPyAnYm90dG9tJyA6XG4gICAgICAgICAgICAgICAgICAgIHBsYWNlbWVudCA9PSAncmlnaHQnICAmJiBwb3MucmlnaHQgICsgYWN0dWFsV2lkdGggID4gdmlld3BvcnREaW0ud2lkdGggID8gJ2xlZnQnICAgOlxuICAgICAgICAgICAgICAgICAgICBwbGFjZW1lbnQgPT0gJ2xlZnQnICAgJiYgcG9zLmxlZnQgICAtIGFjdHVhbFdpZHRoICA8IHZpZXdwb3J0RGltLmxlZnQgICA/ICdyaWdodCcgIDpcbiAgICAgICAgICAgICAgICAgICAgcGxhY2VtZW50XG5cbiAgICAgICAgJHRpcFxuICAgICAgICAgIC5yZW1vdmVDbGFzcyhvcmdQbGFjZW1lbnQpXG4gICAgICAgICAgLmFkZENsYXNzKHBsYWNlbWVudClcbiAgICAgIH1cblxuICAgICAgdmFyIGNhbGN1bGF0ZWRPZmZzZXQgPSB0aGlzLmdldENhbGN1bGF0ZWRPZmZzZXQocGxhY2VtZW50LCBwb3MsIGFjdHVhbFdpZHRoLCBhY3R1YWxIZWlnaHQpXG5cbiAgICAgIHRoaXMuYXBwbHlQbGFjZW1lbnQoY2FsY3VsYXRlZE9mZnNldCwgcGxhY2VtZW50KVxuXG4gICAgICB2YXIgY29tcGxldGUgPSBmdW5jdGlvbiAoKSB7XG4gICAgICAgIHZhciBwcmV2SG92ZXJTdGF0ZSA9IHRoYXQuaG92ZXJTdGF0ZVxuICAgICAgICB0aGF0LiRlbGVtZW50LnRyaWdnZXIoJ3Nob3duLmJzLicgKyB0aGF0LnR5cGUpXG4gICAgICAgIHRoYXQuaG92ZXJTdGF0ZSA9IG51bGxcblxuICAgICAgICBpZiAocHJldkhvdmVyU3RhdGUgPT0gJ291dCcpIHRoYXQubGVhdmUodGhhdClcbiAgICAgIH1cblxuICAgICAgJC5zdXBwb3J0LnRyYW5zaXRpb24gJiYgdGhpcy4kdGlwLmhhc0NsYXNzKCdmYWRlJykgP1xuICAgICAgICAkdGlwXG4gICAgICAgICAgLm9uZSgnYnNUcmFuc2l0aW9uRW5kJywgY29tcGxldGUpXG4gICAgICAgICAgLmVtdWxhdGVUcmFuc2l0aW9uRW5kKFRvb2x0aXAuVFJBTlNJVElPTl9EVVJBVElPTikgOlxuICAgICAgICBjb21wbGV0ZSgpXG4gICAgfVxuICB9XG5cbiAgVG9vbHRpcC5wcm90b3R5cGUuYXBwbHlQbGFjZW1lbnQgPSBmdW5jdGlvbiAob2Zmc2V0LCBwbGFjZW1lbnQpIHtcbiAgICB2YXIgJHRpcCAgID0gdGhpcy50aXAoKVxuICAgIHZhciB3aWR0aCAgPSAkdGlwWzBdLm9mZnNldFdpZHRoXG4gICAgdmFyIGhlaWdodCA9ICR0aXBbMF0ub2Zmc2V0SGVpZ2h0XG5cbiAgICAvLyBtYW51YWxseSByZWFkIG1hcmdpbnMgYmVjYXVzZSBnZXRCb3VuZGluZ0NsaWVudFJlY3QgaW5jbHVkZXMgZGlmZmVyZW5jZVxuICAgIHZhciBtYXJnaW5Ub3AgPSBwYXJzZUludCgkdGlwLmNzcygnbWFyZ2luLXRvcCcpLCAxMClcbiAgICB2YXIgbWFyZ2luTGVmdCA9IHBhcnNlSW50KCR0aXAuY3NzKCdtYXJnaW4tbGVmdCcpLCAxMClcblxuICAgIC8vIHdlIG11c3QgY2hlY2sgZm9yIE5hTiBmb3IgaWUgOC85XG4gICAgaWYgKGlzTmFOKG1hcmdpblRvcCkpICBtYXJnaW5Ub3AgID0gMFxuICAgIGlmIChpc05hTihtYXJnaW5MZWZ0KSkgbWFyZ2luTGVmdCA9IDBcblxuICAgIG9mZnNldC50b3AgICs9IG1hcmdpblRvcFxuICAgIG9mZnNldC5sZWZ0ICs9IG1hcmdpbkxlZnRcblxuICAgIC8vICQuZm4ub2Zmc2V0IGRvZXNuJ3Qgcm91bmQgcGl4ZWwgdmFsdWVzXG4gICAgLy8gc28gd2UgdXNlIHNldE9mZnNldCBkaXJlY3RseSB3aXRoIG91ciBvd24gZnVuY3Rpb24gQi0wXG4gICAgJC5vZmZzZXQuc2V0T2Zmc2V0KCR0aXBbMF0sICQuZXh0ZW5kKHtcbiAgICAgIHVzaW5nOiBmdW5jdGlvbiAocHJvcHMpIHtcbiAgICAgICAgJHRpcC5jc3Moe1xuICAgICAgICAgIHRvcDogTWF0aC5yb3VuZChwcm9wcy50b3ApLFxuICAgICAgICAgIGxlZnQ6IE1hdGgucm91bmQocHJvcHMubGVmdClcbiAgICAgICAgfSlcbiAgICAgIH1cbiAgICB9LCBvZmZzZXQpLCAwKVxuXG4gICAgJHRpcC5hZGRDbGFzcygnaW4nKVxuXG4gICAgLy8gY2hlY2sgdG8gc2VlIGlmIHBsYWNpbmcgdGlwIGluIG5ldyBvZmZzZXQgY2F1c2VkIHRoZSB0aXAgdG8gcmVzaXplIGl0c2VsZlxuICAgIHZhciBhY3R1YWxXaWR0aCAgPSAkdGlwWzBdLm9mZnNldFdpZHRoXG4gICAgdmFyIGFjdHVhbEhlaWdodCA9ICR0aXBbMF0ub2Zmc2V0SGVpZ2h0XG5cbiAgICBpZiAocGxhY2VtZW50ID09ICd0b3AnICYmIGFjdHVhbEhlaWdodCAhPSBoZWlnaHQpIHtcbiAgICAgIG9mZnNldC50b3AgPSBvZmZzZXQudG9wICsgaGVpZ2h0IC0gYWN0dWFsSGVpZ2h0XG4gICAgfVxuXG4gICAgdmFyIGRlbHRhID0gdGhpcy5nZXRWaWV3cG9ydEFkanVzdGVkRGVsdGEocGxhY2VtZW50LCBvZmZzZXQsIGFjdHVhbFdpZHRoLCBhY3R1YWxIZWlnaHQpXG5cbiAgICBpZiAoZGVsdGEubGVmdCkgb2Zmc2V0LmxlZnQgKz0gZGVsdGEubGVmdFxuICAgIGVsc2Ugb2Zmc2V0LnRvcCArPSBkZWx0YS50b3BcblxuICAgIHZhciBpc1ZlcnRpY2FsICAgICAgICAgID0gL3RvcHxib3R0b20vLnRlc3QocGxhY2VtZW50KVxuICAgIHZhciBhcnJvd0RlbHRhICAgICAgICAgID0gaXNWZXJ0aWNhbCA/IGRlbHRhLmxlZnQgKiAyIC0gd2lkdGggKyBhY3R1YWxXaWR0aCA6IGRlbHRhLnRvcCAqIDIgLSBoZWlnaHQgKyBhY3R1YWxIZWlnaHRcbiAgICB2YXIgYXJyb3dPZmZzZXRQb3NpdGlvbiA9IGlzVmVydGljYWwgPyAnb2Zmc2V0V2lkdGgnIDogJ29mZnNldEhlaWdodCdcblxuICAgICR0aXAub2Zmc2V0KG9mZnNldClcbiAgICB0aGlzLnJlcGxhY2VBcnJvdyhhcnJvd0RlbHRhLCAkdGlwWzBdW2Fycm93T2Zmc2V0UG9zaXRpb25dLCBpc1ZlcnRpY2FsKVxuICB9XG5cbiAgVG9vbHRpcC5wcm90b3R5cGUucmVwbGFjZUFycm93ID0gZnVuY3Rpb24gKGRlbHRhLCBkaW1lbnNpb24sIGlzVmVydGljYWwpIHtcbiAgICB0aGlzLmFycm93KClcbiAgICAgIC5jc3MoaXNWZXJ0aWNhbCA/ICdsZWZ0JyA6ICd0b3AnLCA1MCAqICgxIC0gZGVsdGEgLyBkaW1lbnNpb24pICsgJyUnKVxuICAgICAgLmNzcyhpc1ZlcnRpY2FsID8gJ3RvcCcgOiAnbGVmdCcsICcnKVxuICB9XG5cbiAgVG9vbHRpcC5wcm90b3R5cGUuc2V0Q29udGVudCA9IGZ1bmN0aW9uICgpIHtcbiAgICB2YXIgJHRpcCAgPSB0aGlzLnRpcCgpXG4gICAgdmFyIHRpdGxlID0gdGhpcy5nZXRUaXRsZSgpXG5cbiAgICAkdGlwLmZpbmQoJy50b29sdGlwLWlubmVyJylbdGhpcy5vcHRpb25zLmh0bWwgPyAnaHRtbCcgOiAndGV4dCddKHRpdGxlKVxuICAgICR0aXAucmVtb3ZlQ2xhc3MoJ2ZhZGUgaW4gdG9wIGJvdHRvbSBsZWZ0IHJpZ2h0JylcbiAgfVxuXG4gIFRvb2x0aXAucHJvdG90eXBlLmhpZGUgPSBmdW5jdGlvbiAoY2FsbGJhY2spIHtcbiAgICB2YXIgdGhhdCA9IHRoaXNcbiAgICB2YXIgJHRpcCA9ICQodGhpcy4kdGlwKVxuICAgIHZhciBlICAgID0gJC5FdmVudCgnaGlkZS5icy4nICsgdGhpcy50eXBlKVxuXG4gICAgZnVuY3Rpb24gY29tcGxldGUoKSB7XG4gICAgICBpZiAodGhhdC5ob3ZlclN0YXRlICE9ICdpbicpICR0aXAuZGV0YWNoKClcbiAgICAgIGlmICh0aGF0LiRlbGVtZW50KSB7IC8vIFRPRE86IENoZWNrIHdoZXRoZXIgZ3VhcmRpbmcgdGhpcyBjb2RlIHdpdGggdGhpcyBgaWZgIGlzIHJlYWxseSBuZWNlc3NhcnkuXG4gICAgICAgIHRoYXQuJGVsZW1lbnRcbiAgICAgICAgICAucmVtb3ZlQXR0cignYXJpYS1kZXNjcmliZWRieScpXG4gICAgICAgICAgLnRyaWdnZXIoJ2hpZGRlbi5icy4nICsgdGhhdC50eXBlKVxuICAgICAgfVxuICAgICAgY2FsbGJhY2sgJiYgY2FsbGJhY2soKVxuICAgIH1cblxuICAgIHRoaXMuJGVsZW1lbnQudHJpZ2dlcihlKVxuXG4gICAgaWYgKGUuaXNEZWZhdWx0UHJldmVudGVkKCkpIHJldHVyblxuXG4gICAgJHRpcC5yZW1vdmVDbGFzcygnaW4nKVxuXG4gICAgJC5zdXBwb3J0LnRyYW5zaXRpb24gJiYgJHRpcC5oYXNDbGFzcygnZmFkZScpID9cbiAgICAgICR0aXBcbiAgICAgICAgLm9uZSgnYnNUcmFuc2l0aW9uRW5kJywgY29tcGxldGUpXG4gICAgICAgIC5lbXVsYXRlVHJhbnNpdGlvbkVuZChUb29sdGlwLlRSQU5TSVRJT05fRFVSQVRJT04pIDpcbiAgICAgIGNvbXBsZXRlKClcblxuICAgIHRoaXMuaG92ZXJTdGF0ZSA9IG51bGxcblxuICAgIHJldHVybiB0aGlzXG4gIH1cblxuICBUb29sdGlwLnByb3RvdHlwZS5maXhUaXRsZSA9IGZ1bmN0aW9uICgpIHtcbiAgICB2YXIgJGUgPSB0aGlzLiRlbGVtZW50XG4gICAgaWYgKCRlLmF0dHIoJ3RpdGxlJykgfHwgdHlwZW9mICRlLmF0dHIoJ2RhdGEtb3JpZ2luYWwtdGl0bGUnKSAhPSAnc3RyaW5nJykge1xuICAgICAgJGUuYXR0cignZGF0YS1vcmlnaW5hbC10aXRsZScsICRlLmF0dHIoJ3RpdGxlJykgfHwgJycpLmF0dHIoJ3RpdGxlJywgJycpXG4gICAgfVxuICB9XG5cbiAgVG9vbHRpcC5wcm90b3R5cGUuaGFzQ29udGVudCA9IGZ1bmN0aW9uICgpIHtcbiAgICByZXR1cm4gdGhpcy5nZXRUaXRsZSgpXG4gIH1cblxuICBUb29sdGlwLnByb3RvdHlwZS5nZXRQb3NpdGlvbiA9IGZ1bmN0aW9uICgkZWxlbWVudCkge1xuICAgICRlbGVtZW50ICAgPSAkZWxlbWVudCB8fCB0aGlzLiRlbGVtZW50XG5cbiAgICB2YXIgZWwgICAgID0gJGVsZW1lbnRbMF1cbiAgICB2YXIgaXNCb2R5ID0gZWwudGFnTmFtZSA9PSAnQk9EWSdcblxuICAgIHZhciBlbFJlY3QgICAgPSBlbC5nZXRCb3VuZGluZ0NsaWVudFJlY3QoKVxuICAgIGlmIChlbFJlY3Qud2lkdGggPT0gbnVsbCkge1xuICAgICAgLy8gd2lkdGggYW5kIGhlaWdodCBhcmUgbWlzc2luZyBpbiBJRTgsIHNvIGNvbXB1dGUgdGhlbSBtYW51YWxseTsgc2VlIGh0dHBzOi8vZ2l0aHViLmNvbS90d2JzL2Jvb3RzdHJhcC9pc3N1ZXMvMTQwOTNcbiAgICAgIGVsUmVjdCA9ICQuZXh0ZW5kKHt9LCBlbFJlY3QsIHsgd2lkdGg6IGVsUmVjdC5yaWdodCAtIGVsUmVjdC5sZWZ0LCBoZWlnaHQ6IGVsUmVjdC5ib3R0b20gLSBlbFJlY3QudG9wIH0pXG4gICAgfVxuICAgIHZhciBpc1N2ZyA9IHdpbmRvdy5TVkdFbGVtZW50ICYmIGVsIGluc3RhbmNlb2Ygd2luZG93LlNWR0VsZW1lbnRcbiAgICAvLyBBdm9pZCB1c2luZyAkLm9mZnNldCgpIG9uIFNWR3Mgc2luY2UgaXQgZ2l2ZXMgaW5jb3JyZWN0IHJlc3VsdHMgaW4galF1ZXJ5IDMuXG4gICAgLy8gU2VlIGh0dHBzOi8vZ2l0aHViLmNvbS90d2JzL2Jvb3RzdHJhcC9pc3N1ZXMvMjAyODBcbiAgICB2YXIgZWxPZmZzZXQgID0gaXNCb2R5ID8geyB0b3A6IDAsIGxlZnQ6IDAgfSA6IChpc1N2ZyA/IG51bGwgOiAkZWxlbWVudC5vZmZzZXQoKSlcbiAgICB2YXIgc2Nyb2xsICAgID0geyBzY3JvbGw6IGlzQm9keSA/IGRvY3VtZW50LmRvY3VtZW50RWxlbWVudC5zY3JvbGxUb3AgfHwgZG9jdW1lbnQuYm9keS5zY3JvbGxUb3AgOiAkZWxlbWVudC5zY3JvbGxUb3AoKSB9XG4gICAgdmFyIG91dGVyRGltcyA9IGlzQm9keSA/IHsgd2lkdGg6ICQod2luZG93KS53aWR0aCgpLCBoZWlnaHQ6ICQod2luZG93KS5oZWlnaHQoKSB9IDogbnVsbFxuXG4gICAgcmV0dXJuICQuZXh0ZW5kKHt9LCBlbFJlY3QsIHNjcm9sbCwgb3V0ZXJEaW1zLCBlbE9mZnNldClcbiAgfVxuXG4gIFRvb2x0aXAucHJvdG90eXBlLmdldENhbGN1bGF0ZWRPZmZzZXQgPSBmdW5jdGlvbiAocGxhY2VtZW50LCBwb3MsIGFjdHVhbFdpZHRoLCBhY3R1YWxIZWlnaHQpIHtcbiAgICByZXR1cm4gcGxhY2VtZW50ID09ICdib3R0b20nID8geyB0b3A6IHBvcy50b3AgKyBwb3MuaGVpZ2h0LCAgIGxlZnQ6IHBvcy5sZWZ0ICsgcG9zLndpZHRoIC8gMiAtIGFjdHVhbFdpZHRoIC8gMiB9IDpcbiAgICAgICAgICAgcGxhY2VtZW50ID09ICd0b3AnICAgID8geyB0b3A6IHBvcy50b3AgLSBhY3R1YWxIZWlnaHQsIGxlZnQ6IHBvcy5sZWZ0ICsgcG9zLndpZHRoIC8gMiAtIGFjdHVhbFdpZHRoIC8gMiB9IDpcbiAgICAgICAgICAgcGxhY2VtZW50ID09ICdsZWZ0JyAgID8geyB0b3A6IHBvcy50b3AgKyBwb3MuaGVpZ2h0IC8gMiAtIGFjdHVhbEhlaWdodCAvIDIsIGxlZnQ6IHBvcy5sZWZ0IC0gYWN0dWFsV2lkdGggfSA6XG4gICAgICAgIC8qIHBsYWNlbWVudCA9PSAncmlnaHQnICovIHsgdG9wOiBwb3MudG9wICsgcG9zLmhlaWdodCAvIDIgLSBhY3R1YWxIZWlnaHQgLyAyLCBsZWZ0OiBwb3MubGVmdCArIHBvcy53aWR0aCB9XG5cbiAgfVxuXG4gIFRvb2x0aXAucHJvdG90eXBlLmdldFZpZXdwb3J0QWRqdXN0ZWREZWx0YSA9IGZ1bmN0aW9uIChwbGFjZW1lbnQsIHBvcywgYWN0dWFsV2lkdGgsIGFjdHVhbEhlaWdodCkge1xuICAgIHZhciBkZWx0YSA9IHsgdG9wOiAwLCBsZWZ0OiAwIH1cbiAgICBpZiAoIXRoaXMuJHZpZXdwb3J0KSByZXR1cm4gZGVsdGFcblxuICAgIHZhciB2aWV3cG9ydFBhZGRpbmcgPSB0aGlzLm9wdGlvbnMudmlld3BvcnQgJiYgdGhpcy5vcHRpb25zLnZpZXdwb3J0LnBhZGRpbmcgfHwgMFxuICAgIHZhciB2aWV3cG9ydERpbWVuc2lvbnMgPSB0aGlzLmdldFBvc2l0aW9uKHRoaXMuJHZpZXdwb3J0KVxuXG4gICAgaWYgKC9yaWdodHxsZWZ0Ly50ZXN0KHBsYWNlbWVudCkpIHtcbiAgICAgIHZhciB0b3BFZGdlT2Zmc2V0ICAgID0gcG9zLnRvcCAtIHZpZXdwb3J0UGFkZGluZyAtIHZpZXdwb3J0RGltZW5zaW9ucy5zY3JvbGxcbiAgICAgIHZhciBib3R0b21FZGdlT2Zmc2V0ID0gcG9zLnRvcCArIHZpZXdwb3J0UGFkZGluZyAtIHZpZXdwb3J0RGltZW5zaW9ucy5zY3JvbGwgKyBhY3R1YWxIZWlnaHRcbiAgICAgIGlmICh0b3BFZGdlT2Zmc2V0IDwgdmlld3BvcnREaW1lbnNpb25zLnRvcCkgeyAvLyB0b3Agb3ZlcmZsb3dcbiAgICAgICAgZGVsdGEudG9wID0gdmlld3BvcnREaW1lbnNpb25zLnRvcCAtIHRvcEVkZ2VPZmZzZXRcbiAgICAgIH0gZWxzZSBpZiAoYm90dG9tRWRnZU9mZnNldCA+IHZpZXdwb3J0RGltZW5zaW9ucy50b3AgKyB2aWV3cG9ydERpbWVuc2lvbnMuaGVpZ2h0KSB7IC8vIGJvdHRvbSBvdmVyZmxvd1xuICAgICAgICBkZWx0YS50b3AgPSB2aWV3cG9ydERpbWVuc2lvbnMudG9wICsgdmlld3BvcnREaW1lbnNpb25zLmhlaWdodCAtIGJvdHRvbUVkZ2VPZmZzZXRcbiAgICAgIH1cbiAgICB9IGVsc2Uge1xuICAgICAgdmFyIGxlZnRFZGdlT2Zmc2V0ICA9IHBvcy5sZWZ0IC0gdmlld3BvcnRQYWRkaW5nXG4gICAgICB2YXIgcmlnaHRFZGdlT2Zmc2V0ID0gcG9zLmxlZnQgKyB2aWV3cG9ydFBhZGRpbmcgKyBhY3R1YWxXaWR0aFxuICAgICAgaWYgKGxlZnRFZGdlT2Zmc2V0IDwgdmlld3BvcnREaW1lbnNpb25zLmxlZnQpIHsgLy8gbGVmdCBvdmVyZmxvd1xuICAgICAgICBkZWx0YS5sZWZ0ID0gdmlld3BvcnREaW1lbnNpb25zLmxlZnQgLSBsZWZ0RWRnZU9mZnNldFxuICAgICAgfSBlbHNlIGlmIChyaWdodEVkZ2VPZmZzZXQgPiB2aWV3cG9ydERpbWVuc2lvbnMucmlnaHQpIHsgLy8gcmlnaHQgb3ZlcmZsb3dcbiAgICAgICAgZGVsdGEubGVmdCA9IHZpZXdwb3J0RGltZW5zaW9ucy5sZWZ0ICsgdmlld3BvcnREaW1lbnNpb25zLndpZHRoIC0gcmlnaHRFZGdlT2Zmc2V0XG4gICAgICB9XG4gICAgfVxuXG4gICAgcmV0dXJuIGRlbHRhXG4gIH1cblxuICBUb29sdGlwLnByb3RvdHlwZS5nZXRUaXRsZSA9IGZ1bmN0aW9uICgpIHtcbiAgICB2YXIgdGl0bGVcbiAgICB2YXIgJGUgPSB0aGlzLiRlbGVtZW50XG4gICAgdmFyIG8gID0gdGhpcy5vcHRpb25zXG5cbiAgICB0aXRsZSA9ICRlLmF0dHIoJ2RhdGEtb3JpZ2luYWwtdGl0bGUnKVxuICAgICAgfHwgKHR5cGVvZiBvLnRpdGxlID09ICdmdW5jdGlvbicgPyBvLnRpdGxlLmNhbGwoJGVbMF0pIDogIG8udGl0bGUpXG5cbiAgICByZXR1cm4gdGl0bGVcbiAgfVxuXG4gIFRvb2x0aXAucHJvdG90eXBlLmdldFVJRCA9IGZ1bmN0aW9uIChwcmVmaXgpIHtcbiAgICBkbyBwcmVmaXggKz0gfn4oTWF0aC5yYW5kb20oKSAqIDEwMDAwMDApXG4gICAgd2hpbGUgKGRvY3VtZW50LmdldEVsZW1lbnRCeUlkKHByZWZpeCkpXG4gICAgcmV0dXJuIHByZWZpeFxuICB9XG5cbiAgVG9vbHRpcC5wcm90b3R5cGUudGlwID0gZnVuY3Rpb24gKCkge1xuICAgIGlmICghdGhpcy4kdGlwKSB7XG4gICAgICB0aGlzLiR0aXAgPSAkKHRoaXMub3B0aW9ucy50ZW1wbGF0ZSlcbiAgICAgIGlmICh0aGlzLiR0aXAubGVuZ3RoICE9IDEpIHtcbiAgICAgICAgdGhyb3cgbmV3IEVycm9yKHRoaXMudHlwZSArICcgYHRlbXBsYXRlYCBvcHRpb24gbXVzdCBjb25zaXN0IG9mIGV4YWN0bHkgMSB0b3AtbGV2ZWwgZWxlbWVudCEnKVxuICAgICAgfVxuICAgIH1cbiAgICByZXR1cm4gdGhpcy4kdGlwXG4gIH1cblxuICBUb29sdGlwLnByb3RvdHlwZS5hcnJvdyA9IGZ1bmN0aW9uICgpIHtcbiAgICByZXR1cm4gKHRoaXMuJGFycm93ID0gdGhpcy4kYXJyb3cgfHwgdGhpcy50aXAoKS5maW5kKCcudG9vbHRpcC1hcnJvdycpKVxuICB9XG5cbiAgVG9vbHRpcC5wcm90b3R5cGUuZW5hYmxlID0gZnVuY3Rpb24gKCkge1xuICAgIHRoaXMuZW5hYmxlZCA9IHRydWVcbiAgfVxuXG4gIFRvb2x0aXAucHJvdG90eXBlLmRpc2FibGUgPSBmdW5jdGlvbiAoKSB7XG4gICAgdGhpcy5lbmFibGVkID0gZmFsc2VcbiAgfVxuXG4gIFRvb2x0aXAucHJvdG90eXBlLnRvZ2dsZUVuYWJsZWQgPSBmdW5jdGlvbiAoKSB7XG4gICAgdGhpcy5lbmFibGVkID0gIXRoaXMuZW5hYmxlZFxuICB9XG5cbiAgVG9vbHRpcC5wcm90b3R5cGUudG9nZ2xlID0gZnVuY3Rpb24gKGUpIHtcbiAgICB2YXIgc2VsZiA9IHRoaXNcbiAgICBpZiAoZSkge1xuICAgICAgc2VsZiA9ICQoZS5jdXJyZW50VGFyZ2V0KS5kYXRhKCdicy4nICsgdGhpcy50eXBlKVxuICAgICAgaWYgKCFzZWxmKSB7XG4gICAgICAgIHNlbGYgPSBuZXcgdGhpcy5jb25zdHJ1Y3RvcihlLmN1cnJlbnRUYXJnZXQsIHRoaXMuZ2V0RGVsZWdhdGVPcHRpb25zKCkpXG4gICAgICAgICQoZS5jdXJyZW50VGFyZ2V0KS5kYXRhKCdicy4nICsgdGhpcy50eXBlLCBzZWxmKVxuICAgICAgfVxuICAgIH1cblxuICAgIGlmIChlKSB7XG4gICAgICBzZWxmLmluU3RhdGUuY2xpY2sgPSAhc2VsZi5pblN0YXRlLmNsaWNrXG4gICAgICBpZiAoc2VsZi5pc0luU3RhdGVUcnVlKCkpIHNlbGYuZW50ZXIoc2VsZilcbiAgICAgIGVsc2Ugc2VsZi5sZWF2ZShzZWxmKVxuICAgIH0gZWxzZSB7XG4gICAgICBzZWxmLnRpcCgpLmhhc0NsYXNzKCdpbicpID8gc2VsZi5sZWF2ZShzZWxmKSA6IHNlbGYuZW50ZXIoc2VsZilcbiAgICB9XG4gIH1cblxuICBUb29sdGlwLnByb3RvdHlwZS5kZXN0cm95ID0gZnVuY3Rpb24gKCkge1xuICAgIHZhciB0aGF0ID0gdGhpc1xuICAgIGNsZWFyVGltZW91dCh0aGlzLnRpbWVvdXQpXG4gICAgdGhpcy5oaWRlKGZ1bmN0aW9uICgpIHtcbiAgICAgIHRoYXQuJGVsZW1lbnQub2ZmKCcuJyArIHRoYXQudHlwZSkucmVtb3ZlRGF0YSgnYnMuJyArIHRoYXQudHlwZSlcbiAgICAgIGlmICh0aGF0LiR0aXApIHtcbiAgICAgICAgdGhhdC4kdGlwLmRldGFjaCgpXG4gICAgICB9XG4gICAgICB0aGF0LiR0aXAgPSBudWxsXG4gICAgICB0aGF0LiRhcnJvdyA9IG51bGxcbiAgICAgIHRoYXQuJHZpZXdwb3J0ID0gbnVsbFxuICAgICAgdGhhdC4kZWxlbWVudCA9IG51bGxcbiAgICB9KVxuICB9XG5cblxuICAvLyBUT09MVElQIFBMVUdJTiBERUZJTklUSU9OXG4gIC8vID09PT09PT09PT09PT09PT09PT09PT09PT1cblxuICBmdW5jdGlvbiBQbHVnaW4ob3B0aW9uKSB7XG4gICAgcmV0dXJuIHRoaXMuZWFjaChmdW5jdGlvbiAoKSB7XG4gICAgICB2YXIgJHRoaXMgICA9ICQodGhpcylcbiAgICAgIHZhciBkYXRhICAgID0gJHRoaXMuZGF0YSgnYnMudG9vbHRpcCcpXG4gICAgICB2YXIgb3B0aW9ucyA9IHR5cGVvZiBvcHRpb24gPT0gJ29iamVjdCcgJiYgb3B0aW9uXG5cbiAgICAgIGlmICghZGF0YSAmJiAvZGVzdHJveXxoaWRlLy50ZXN0KG9wdGlvbikpIHJldHVyblxuICAgICAgaWYgKCFkYXRhKSAkdGhpcy5kYXRhKCdicy50b29sdGlwJywgKGRhdGEgPSBuZXcgVG9vbHRpcCh0aGlzLCBvcHRpb25zKSkpXG4gICAgICBpZiAodHlwZW9mIG9wdGlvbiA9PSAnc3RyaW5nJykgZGF0YVtvcHRpb25dKClcbiAgICB9KVxuICB9XG5cbiAgdmFyIG9sZCA9ICQuZm4udG9vbHRpcFxuXG4gICQuZm4udG9vbHRpcCAgICAgICAgICAgICA9IFBsdWdpblxuICAkLmZuLnRvb2x0aXAuQ29uc3RydWN0b3IgPSBUb29sdGlwXG5cblxuICAvLyBUT09MVElQIE5PIENPTkZMSUNUXG4gIC8vID09PT09PT09PT09PT09PT09PT1cblxuICAkLmZuLnRvb2x0aXAubm9Db25mbGljdCA9IGZ1bmN0aW9uICgpIHtcbiAgICAkLmZuLnRvb2x0aXAgPSBvbGRcbiAgICByZXR1cm4gdGhpc1xuICB9XG5cbn0oalF1ZXJ5KTtcbiIsIi8qID09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PVxuICogQm9vdHN0cmFwOiB0cmFuc2l0aW9uLmpzIHYzLjMuN1xuICogaHR0cDovL2dldGJvb3RzdHJhcC5jb20vamF2YXNjcmlwdC8jdHJhbnNpdGlvbnNcbiAqID09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PVxuICogQ29weXJpZ2h0IDIwMTEtMjAxNiBUd2l0dGVyLCBJbmMuXG4gKiBMaWNlbnNlZCB1bmRlciBNSVQgKGh0dHBzOi8vZ2l0aHViLmNvbS90d2JzL2Jvb3RzdHJhcC9ibG9iL21hc3Rlci9MSUNFTlNFKVxuICogPT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09ICovXG5cblxuK2Z1bmN0aW9uICgkKSB7XG4gICd1c2Ugc3RyaWN0JztcblxuICAvLyBDU1MgVFJBTlNJVElPTiBTVVBQT1JUIChTaG91dG91dDogaHR0cDovL3d3dy5tb2Rlcm5penIuY29tLylcbiAgLy8gPT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09XG5cbiAgZnVuY3Rpb24gdHJhbnNpdGlvbkVuZCgpIHtcbiAgICB2YXIgZWwgPSBkb2N1bWVudC5jcmVhdGVFbGVtZW50KCdib290c3RyYXAnKVxuXG4gICAgdmFyIHRyYW5zRW5kRXZlbnROYW1lcyA9IHtcbiAgICAgIFdlYmtpdFRyYW5zaXRpb24gOiAnd2Via2l0VHJhbnNpdGlvbkVuZCcsXG4gICAgICBNb3pUcmFuc2l0aW9uICAgIDogJ3RyYW5zaXRpb25lbmQnLFxuICAgICAgT1RyYW5zaXRpb24gICAgICA6ICdvVHJhbnNpdGlvbkVuZCBvdHJhbnNpdGlvbmVuZCcsXG4gICAgICB0cmFuc2l0aW9uICAgICAgIDogJ3RyYW5zaXRpb25lbmQnXG4gICAgfVxuXG4gICAgZm9yICh2YXIgbmFtZSBpbiB0cmFuc0VuZEV2ZW50TmFtZXMpIHtcbiAgICAgIGlmIChlbC5zdHlsZVtuYW1lXSAhPT0gdW5kZWZpbmVkKSB7XG4gICAgICAgIHJldHVybiB7IGVuZDogdHJhbnNFbmRFdmVudE5hbWVzW25hbWVdIH1cbiAgICAgIH1cbiAgICB9XG5cbiAgICByZXR1cm4gZmFsc2UgLy8gZXhwbGljaXQgZm9yIGllOCAoICAuXy4pXG4gIH1cblxuICAvLyBodHRwOi8vYmxvZy5hbGV4bWFjY2F3LmNvbS9jc3MtdHJhbnNpdGlvbnNcbiAgJC5mbi5lbXVsYXRlVHJhbnNpdGlvbkVuZCA9IGZ1bmN0aW9uIChkdXJhdGlvbikge1xuICAgIHZhciBjYWxsZWQgPSBmYWxzZVxuICAgIHZhciAkZWwgPSB0aGlzXG4gICAgJCh0aGlzKS5vbmUoJ2JzVHJhbnNpdGlvbkVuZCcsIGZ1bmN0aW9uICgpIHsgY2FsbGVkID0gdHJ1ZSB9KVxuICAgIHZhciBjYWxsYmFjayA9IGZ1bmN0aW9uICgpIHsgaWYgKCFjYWxsZWQpICQoJGVsKS50cmlnZ2VyKCQuc3VwcG9ydC50cmFuc2l0aW9uLmVuZCkgfVxuICAgIHNldFRpbWVvdXQoY2FsbGJhY2ssIGR1cmF0aW9uKVxuICAgIHJldHVybiB0aGlzXG4gIH1cblxuICAkKGZ1bmN0aW9uICgpIHtcbiAgICAkLnN1cHBvcnQudHJhbnNpdGlvbiA9IHRyYW5zaXRpb25FbmQoKVxuXG4gICAgaWYgKCEkLnN1cHBvcnQudHJhbnNpdGlvbikgcmV0dXJuXG5cbiAgICAkLmV2ZW50LnNwZWNpYWwuYnNUcmFuc2l0aW9uRW5kID0ge1xuICAgICAgYmluZFR5cGU6ICQuc3VwcG9ydC50cmFuc2l0aW9uLmVuZCxcbiAgICAgIGRlbGVnYXRlVHlwZTogJC5zdXBwb3J0LnRyYW5zaXRpb24uZW5kLFxuICAgICAgaGFuZGxlOiBmdW5jdGlvbiAoZSkge1xuICAgICAgICBpZiAoJChlLnRhcmdldCkuaXModGhpcykpIHJldHVybiBlLmhhbmRsZU9iai5oYW5kbGVyLmFwcGx5KHRoaXMsIGFyZ3VtZW50cylcbiAgICAgIH1cbiAgICB9XG4gIH0pXG5cbn0oalF1ZXJ5KTtcbiIsIi8qIVxuICogalF1ZXJ5IFVJIDpkYXRhIDEuMTIuMFxuICogaHR0cDovL2pxdWVyeXVpLmNvbVxuICpcbiAqIENvcHlyaWdodCBqUXVlcnkgRm91bmRhdGlvbiBhbmQgb3RoZXIgY29udHJpYnV0b3JzXG4gKiBSZWxlYXNlZCB1bmRlciB0aGUgTUlUIGxpY2Vuc2UuXG4gKiBodHRwOi8vanF1ZXJ5Lm9yZy9saWNlbnNlXG4gKi9cblxuLy8+PmxhYmVsOiA6ZGF0YSBTZWxlY3RvclxuLy8+Pmdyb3VwOiBDb3JlXG4vLz4+ZGVzY3JpcHRpb246IFNlbGVjdHMgZWxlbWVudHMgd2hpY2ggaGF2ZSBkYXRhIHN0b3JlZCB1bmRlciB0aGUgc3BlY2lmaWVkIGtleS5cbi8vPj5kb2NzOiBodHRwOi8vYXBpLmpxdWVyeXVpLmNvbS9kYXRhLXNlbGVjdG9yL1xuXG4oIGZ1bmN0aW9uKCBmYWN0b3J5ICkge1xuXHRpZiAoIHR5cGVvZiBkZWZpbmUgPT09IFwiZnVuY3Rpb25cIiAmJiBkZWZpbmUuYW1kICkge1xuXG5cdFx0Ly8gQU1ELiBSZWdpc3RlciBhcyBhbiBhbm9ueW1vdXMgbW9kdWxlLlxuXHRcdGRlZmluZSggWyBcImpxdWVyeVwiLCBcIi4vdmVyc2lvblwiIF0sIGZhY3RvcnkgKTtcblx0fSBlbHNlIHtcblxuXHRcdC8vIEJyb3dzZXIgZ2xvYmFsc1xuXHRcdGZhY3RvcnkoIGpRdWVyeSApO1xuXHR9XG59ICggZnVuY3Rpb24oICQgKSB7XG5yZXR1cm4gJC5leHRlbmQoICQuZXhwclsgXCI6XCIgXSwge1xuXHRkYXRhOiAkLmV4cHIuY3JlYXRlUHNldWRvID9cblx0XHQkLmV4cHIuY3JlYXRlUHNldWRvKCBmdW5jdGlvbiggZGF0YU5hbWUgKSB7XG5cdFx0XHRyZXR1cm4gZnVuY3Rpb24oIGVsZW0gKSB7XG5cdFx0XHRcdHJldHVybiAhISQuZGF0YSggZWxlbSwgZGF0YU5hbWUgKTtcblx0XHRcdH07XG5cdFx0fSApIDpcblxuXHRcdC8vIFN1cHBvcnQ6IGpRdWVyeSA8MS44XG5cdFx0ZnVuY3Rpb24oIGVsZW0sIGksIG1hdGNoICkge1xuXHRcdFx0cmV0dXJuICEhJC5kYXRhKCBlbGVtLCBtYXRjaFsgMyBdICk7XG5cdFx0fVxufSApO1xufSApICk7XG4iLCIvKiFcbiAqIGpRdWVyeSBVSSBEaXNhYmxlIFNlbGVjdGlvbiAxLjEyLjBcbiAqIGh0dHA6Ly9qcXVlcnl1aS5jb21cbiAqXG4gKiBDb3B5cmlnaHQgalF1ZXJ5IEZvdW5kYXRpb24gYW5kIG90aGVyIGNvbnRyaWJ1dG9yc1xuICogUmVsZWFzZWQgdW5kZXIgdGhlIE1JVCBsaWNlbnNlLlxuICogaHR0cDovL2pxdWVyeS5vcmcvbGljZW5zZVxuICovXG5cbi8vPj5sYWJlbDogZGlzYWJsZVNlbGVjdGlvblxuLy8+Pmdyb3VwOiBDb3JlXG4vLz4+ZGVzY3JpcHRpb246IERpc2FibGUgc2VsZWN0aW9uIG9mIHRleHQgY29udGVudCB3aXRoaW4gdGhlIHNldCBvZiBtYXRjaGVkIGVsZW1lbnRzLlxuLy8+PmRvY3M6IGh0dHA6Ly9hcGkuanF1ZXJ5dWkuY29tL2Rpc2FibGVTZWxlY3Rpb24vXG5cbi8vIFRoaXMgZmlsZSBpcyBkZXByZWNhdGVkXG4oIGZ1bmN0aW9uKCBmYWN0b3J5ICkge1xuXHRpZiAoIHR5cGVvZiBkZWZpbmUgPT09IFwiZnVuY3Rpb25cIiAmJiBkZWZpbmUuYW1kICkge1xuXG5cdFx0Ly8gQU1ELiBSZWdpc3RlciBhcyBhbiBhbm9ueW1vdXMgbW9kdWxlLlxuXHRcdGRlZmluZSggWyBcImpxdWVyeVwiLCBcIi4vdmVyc2lvblwiIF0sIGZhY3RvcnkgKTtcblx0fSBlbHNlIHtcblxuXHRcdC8vIEJyb3dzZXIgZ2xvYmFsc1xuXHRcdGZhY3RvcnkoIGpRdWVyeSApO1xuXHR9XG59ICggZnVuY3Rpb24oICQgKSB7XG5cbnJldHVybiAkLmZuLmV4dGVuZCgge1xuXHRkaXNhYmxlU2VsZWN0aW9uOiAoIGZ1bmN0aW9uKCkge1xuXHRcdHZhciBldmVudFR5cGUgPSBcIm9uc2VsZWN0c3RhcnRcIiBpbiBkb2N1bWVudC5jcmVhdGVFbGVtZW50KCBcImRpdlwiICkgP1xuXHRcdFx0XCJzZWxlY3RzdGFydFwiIDpcblx0XHRcdFwibW91c2Vkb3duXCI7XG5cblx0XHRyZXR1cm4gZnVuY3Rpb24oKSB7XG5cdFx0XHRyZXR1cm4gdGhpcy5vbiggZXZlbnRUeXBlICsgXCIudWktZGlzYWJsZVNlbGVjdGlvblwiLCBmdW5jdGlvbiggZXZlbnQgKSB7XG5cdFx0XHRcdGV2ZW50LnByZXZlbnREZWZhdWx0KCk7XG5cdFx0XHR9ICk7XG5cdFx0fTtcblx0fSApKCksXG5cblx0ZW5hYmxlU2VsZWN0aW9uOiBmdW5jdGlvbigpIHtcblx0XHRyZXR1cm4gdGhpcy5vZmYoIFwiLnVpLWRpc2FibGVTZWxlY3Rpb25cIiApO1xuXHR9XG59ICk7XG5cbn0gKSApO1xuIiwiLyohXG4gKiBqUXVlcnkgVUkgRm9jdXNhYmxlIDEuMTIuMFxuICogaHR0cDovL2pxdWVyeXVpLmNvbVxuICpcbiAqIENvcHlyaWdodCBqUXVlcnkgRm91bmRhdGlvbiBhbmQgb3RoZXIgY29udHJpYnV0b3JzXG4gKiBSZWxlYXNlZCB1bmRlciB0aGUgTUlUIGxpY2Vuc2UuXG4gKiBodHRwOi8vanF1ZXJ5Lm9yZy9saWNlbnNlXG4gKi9cblxuLy8+PmxhYmVsOiA6Zm9jdXNhYmxlIFNlbGVjdG9yXG4vLz4+Z3JvdXA6IENvcmVcbi8vPj5kZXNjcmlwdGlvbjogU2VsZWN0cyBlbGVtZW50cyB3aGljaCBjYW4gYmUgZm9jdXNlZC5cbi8vPj5kb2NzOiBodHRwOi8vYXBpLmpxdWVyeXVpLmNvbS9mb2N1c2FibGUtc2VsZWN0b3IvXG5cbiggZnVuY3Rpb24oIGZhY3RvcnkgKSB7XG5cdGlmICggdHlwZW9mIGRlZmluZSA9PT0gXCJmdW5jdGlvblwiICYmIGRlZmluZS5hbWQgKSB7XG5cblx0XHQvLyBBTUQuIFJlZ2lzdGVyIGFzIGFuIGFub255bW91cyBtb2R1bGUuXG5cdFx0ZGVmaW5lKCBbIFwianF1ZXJ5XCIsIFwiLi92ZXJzaW9uXCIgXSwgZmFjdG9yeSApO1xuXHR9IGVsc2Uge1xuXG5cdFx0Ly8gQnJvd3NlciBnbG9iYWxzXG5cdFx0ZmFjdG9yeSggalF1ZXJ5ICk7XG5cdH1cbn0gKCBmdW5jdGlvbiggJCApIHtcblxuLy8gU2VsZWN0b3JzXG4kLnVpLmZvY3VzYWJsZSA9IGZ1bmN0aW9uKCBlbGVtZW50LCBoYXNUYWJpbmRleCApIHtcblx0dmFyIG1hcCwgbWFwTmFtZSwgaW1nLCBmb2N1c2FibGVJZlZpc2libGUsIGZpZWxkc2V0LFxuXHRcdG5vZGVOYW1lID0gZWxlbWVudC5ub2RlTmFtZS50b0xvd2VyQ2FzZSgpO1xuXG5cdGlmICggXCJhcmVhXCIgPT09IG5vZGVOYW1lICkge1xuXHRcdG1hcCA9IGVsZW1lbnQucGFyZW50Tm9kZTtcblx0XHRtYXBOYW1lID0gbWFwLm5hbWU7XG5cdFx0aWYgKCAhZWxlbWVudC5ocmVmIHx8ICFtYXBOYW1lIHx8IG1hcC5ub2RlTmFtZS50b0xvd2VyQ2FzZSgpICE9PSBcIm1hcFwiICkge1xuXHRcdFx0cmV0dXJuIGZhbHNlO1xuXHRcdH1cblx0XHRpbWcgPSAkKCBcImltZ1t1c2VtYXA9JyNcIiArIG1hcE5hbWUgKyBcIiddXCIgKTtcblx0XHRyZXR1cm4gaW1nLmxlbmd0aCA+IDAgJiYgaW1nLmlzKCBcIjp2aXNpYmxlXCIgKTtcblx0fVxuXG5cdGlmICggL14oaW5wdXR8c2VsZWN0fHRleHRhcmVhfGJ1dHRvbnxvYmplY3QpJC8udGVzdCggbm9kZU5hbWUgKSApIHtcblx0XHRmb2N1c2FibGVJZlZpc2libGUgPSAhZWxlbWVudC5kaXNhYmxlZDtcblxuXHRcdGlmICggZm9jdXNhYmxlSWZWaXNpYmxlICkge1xuXG5cdFx0XHQvLyBGb3JtIGNvbnRyb2xzIHdpdGhpbiBhIGRpc2FibGVkIGZpZWxkc2V0IGFyZSBkaXNhYmxlZC5cblx0XHRcdC8vIEhvd2V2ZXIsIGNvbnRyb2xzIHdpdGhpbiB0aGUgZmllbGRzZXQncyBsZWdlbmQgZG8gbm90IGdldCBkaXNhYmxlZC5cblx0XHRcdC8vIFNpbmNlIGNvbnRyb2xzIGdlbmVyYWxseSBhcmVuJ3QgcGxhY2VkIGluc2lkZSBsZWdlbmRzLCB3ZSBza2lwXG5cdFx0XHQvLyB0aGlzIHBvcnRpb24gb2YgdGhlIGNoZWNrLlxuXHRcdFx0ZmllbGRzZXQgPSAkKCBlbGVtZW50ICkuY2xvc2VzdCggXCJmaWVsZHNldFwiIClbIDAgXTtcblx0XHRcdGlmICggZmllbGRzZXQgKSB7XG5cdFx0XHRcdGZvY3VzYWJsZUlmVmlzaWJsZSA9ICFmaWVsZHNldC5kaXNhYmxlZDtcblx0XHRcdH1cblx0XHR9XG5cdH0gZWxzZSBpZiAoIFwiYVwiID09PSBub2RlTmFtZSApIHtcblx0XHRmb2N1c2FibGVJZlZpc2libGUgPSBlbGVtZW50LmhyZWYgfHwgaGFzVGFiaW5kZXg7XG5cdH0gZWxzZSB7XG5cdFx0Zm9jdXNhYmxlSWZWaXNpYmxlID0gaGFzVGFiaW5kZXg7XG5cdH1cblxuXHRyZXR1cm4gZm9jdXNhYmxlSWZWaXNpYmxlICYmICQoIGVsZW1lbnQgKS5pcyggXCI6dmlzaWJsZVwiICkgJiYgdmlzaWJsZSggJCggZWxlbWVudCApICk7XG59O1xuXG4vLyBTdXBwb3J0OiBJRSA4IG9ubHlcbi8vIElFIDggZG9lc24ndCByZXNvbHZlIGluaGVyaXQgdG8gdmlzaWJsZS9oaWRkZW4gZm9yIGNvbXB1dGVkIHZhbHVlc1xuZnVuY3Rpb24gdmlzaWJsZSggZWxlbWVudCApIHtcblx0dmFyIHZpc2liaWxpdHkgPSBlbGVtZW50LmNzcyggXCJ2aXNpYmlsaXR5XCIgKTtcblx0d2hpbGUgKCB2aXNpYmlsaXR5ID09PSBcImluaGVyaXRcIiApIHtcblx0XHRlbGVtZW50ID0gZWxlbWVudC5wYXJlbnQoKTtcblx0XHR2aXNpYmlsaXR5ID0gZWxlbWVudC5jc3MoIFwidmlzaWJpbGl0eVwiICk7XG5cdH1cblx0cmV0dXJuIHZpc2liaWxpdHkgIT09IFwiaGlkZGVuXCI7XG59XG5cbiQuZXh0ZW5kKCAkLmV4cHJbIFwiOlwiIF0sIHtcblx0Zm9jdXNhYmxlOiBmdW5jdGlvbiggZWxlbWVudCApIHtcblx0XHRyZXR1cm4gJC51aS5mb2N1c2FibGUoIGVsZW1lbnQsICQuYXR0ciggZWxlbWVudCwgXCJ0YWJpbmRleFwiICkgIT0gbnVsbCApO1xuXHR9XG59ICk7XG5cbnJldHVybiAkLnVpLmZvY3VzYWJsZTtcblxufSApICk7XG4iLCIoIGZ1bmN0aW9uKCBmYWN0b3J5ICkge1xuXHRpZiAoIHR5cGVvZiBkZWZpbmUgPT09IFwiZnVuY3Rpb25cIiAmJiBkZWZpbmUuYW1kICkge1xuXG5cdFx0Ly8gQU1ELiBSZWdpc3RlciBhcyBhbiBhbm9ueW1vdXMgbW9kdWxlLlxuXHRcdGRlZmluZSggWyBcImpxdWVyeVwiLCBcIi4vdmVyc2lvblwiIF0sIGZhY3RvcnkgKTtcblx0fSBlbHNlIHtcblxuXHRcdC8vIEJyb3dzZXIgZ2xvYmFsc1xuXHRcdGZhY3RvcnkoIGpRdWVyeSApO1xuXHR9XG59ICggZnVuY3Rpb24oICQgKSB7XG5cbi8vIFRoaXMgZmlsZSBpcyBkZXByZWNhdGVkXG5yZXR1cm4gJC51aS5pZSA9ICEhL21zaWUgW1xcdy5dKy8uZXhlYyggbmF2aWdhdG9yLnVzZXJBZ2VudC50b0xvd2VyQ2FzZSgpICk7XG59ICkgKTtcbiIsIi8qIVxuICogalF1ZXJ5IFVJIEtleWNvZGUgMS4xMi4wXG4gKiBodHRwOi8vanF1ZXJ5dWkuY29tXG4gKlxuICogQ29weXJpZ2h0IGpRdWVyeSBGb3VuZGF0aW9uIGFuZCBvdGhlciBjb250cmlidXRvcnNcbiAqIFJlbGVhc2VkIHVuZGVyIHRoZSBNSVQgbGljZW5zZS5cbiAqIGh0dHA6Ly9qcXVlcnkub3JnL2xpY2Vuc2VcbiAqL1xuXG4vLz4+bGFiZWw6IEtleWNvZGVcbi8vPj5ncm91cDogQ29yZVxuLy8+PmRlc2NyaXB0aW9uOiBQcm92aWRlIGtleWNvZGVzIGFzIGtleW5hbWVzXG4vLz4+ZG9jczogaHR0cDovL2FwaS5qcXVlcnl1aS5jb20valF1ZXJ5LnVpLmtleUNvZGUvXG5cbiggZnVuY3Rpb24oIGZhY3RvcnkgKSB7XG5cdGlmICggdHlwZW9mIGRlZmluZSA9PT0gXCJmdW5jdGlvblwiICYmIGRlZmluZS5hbWQgKSB7XG5cblx0XHQvLyBBTUQuIFJlZ2lzdGVyIGFzIGFuIGFub255bW91cyBtb2R1bGUuXG5cdFx0ZGVmaW5lKCBbIFwianF1ZXJ5XCIsIFwiLi92ZXJzaW9uXCIgXSwgZmFjdG9yeSApO1xuXHR9IGVsc2Uge1xuXG5cdFx0Ly8gQnJvd3NlciBnbG9iYWxzXG5cdFx0ZmFjdG9yeSggalF1ZXJ5ICk7XG5cdH1cbn0gKCBmdW5jdGlvbiggJCApIHtcbnJldHVybiAkLnVpLmtleUNvZGUgPSB7XG5cdEJBQ0tTUEFDRTogOCxcblx0Q09NTUE6IDE4OCxcblx0REVMRVRFOiA0Nixcblx0RE9XTjogNDAsXG5cdEVORDogMzUsXG5cdEVOVEVSOiAxMyxcblx0RVNDQVBFOiAyNyxcblx0SE9NRTogMzYsXG5cdExFRlQ6IDM3LFxuXHRQQUdFX0RPV046IDM0LFxuXHRQQUdFX1VQOiAzMyxcblx0UEVSSU9EOiAxOTAsXG5cdFJJR0hUOiAzOSxcblx0U1BBQ0U6IDMyLFxuXHRUQUI6IDksXG5cdFVQOiAzOFxufTtcblxufSApICk7XG4iLCIoIGZ1bmN0aW9uKCBmYWN0b3J5ICkge1xuXHRpZiAoIHR5cGVvZiBkZWZpbmUgPT09IFwiZnVuY3Rpb25cIiAmJiBkZWZpbmUuYW1kICkge1xuXG5cdFx0Ly8gQU1ELiBSZWdpc3RlciBhcyBhbiBhbm9ueW1vdXMgbW9kdWxlLlxuXHRcdGRlZmluZSggWyBcImpxdWVyeVwiLCBcIi4vdmVyc2lvblwiIF0sIGZhY3RvcnkgKTtcblx0fSBlbHNlIHtcblxuXHRcdC8vIEJyb3dzZXIgZ2xvYmFsc1xuXHRcdGZhY3RvcnkoIGpRdWVyeSApO1xuXHR9XG59ICggZnVuY3Rpb24oICQgKSB7XG5cbi8vICQudWkucGx1Z2luIGlzIGRlcHJlY2F0ZWQuIFVzZSAkLndpZGdldCgpIGV4dGVuc2lvbnMgaW5zdGVhZC5cbnJldHVybiAkLnVpLnBsdWdpbiA9IHtcblx0YWRkOiBmdW5jdGlvbiggbW9kdWxlLCBvcHRpb24sIHNldCApIHtcblx0XHR2YXIgaSxcblx0XHRcdHByb3RvID0gJC51aVsgbW9kdWxlIF0ucHJvdG90eXBlO1xuXHRcdGZvciAoIGkgaW4gc2V0ICkge1xuXHRcdFx0cHJvdG8ucGx1Z2luc1sgaSBdID0gcHJvdG8ucGx1Z2luc1sgaSBdIHx8IFtdO1xuXHRcdFx0cHJvdG8ucGx1Z2luc1sgaSBdLnB1c2goIFsgb3B0aW9uLCBzZXRbIGkgXSBdICk7XG5cdFx0fVxuXHR9LFxuXHRjYWxsOiBmdW5jdGlvbiggaW5zdGFuY2UsIG5hbWUsIGFyZ3MsIGFsbG93RGlzY29ubmVjdGVkICkge1xuXHRcdHZhciBpLFxuXHRcdFx0c2V0ID0gaW5zdGFuY2UucGx1Z2luc1sgbmFtZSBdO1xuXG5cdFx0aWYgKCAhc2V0ICkge1xuXHRcdFx0cmV0dXJuO1xuXHRcdH1cblxuXHRcdGlmICggIWFsbG93RGlzY29ubmVjdGVkICYmICggIWluc3RhbmNlLmVsZW1lbnRbIDAgXS5wYXJlbnROb2RlIHx8XG5cdFx0XHRcdGluc3RhbmNlLmVsZW1lbnRbIDAgXS5wYXJlbnROb2RlLm5vZGVUeXBlID09PSAxMSApICkge1xuXHRcdFx0cmV0dXJuO1xuXHRcdH1cblxuXHRcdGZvciAoIGkgPSAwOyBpIDwgc2V0Lmxlbmd0aDsgaSsrICkge1xuXHRcdFx0aWYgKCBpbnN0YW5jZS5vcHRpb25zWyBzZXRbIGkgXVsgMCBdIF0gKSB7XG5cdFx0XHRcdHNldFsgaSBdWyAxIF0uYXBwbHkoIGluc3RhbmNlLmVsZW1lbnQsIGFyZ3MgKTtcblx0XHRcdH1cblx0XHR9XG5cdH1cbn07XG5cbn0gKSApO1xuIiwiLyohXG4gKiBqUXVlcnkgVUkgUG9zaXRpb24gMS4xMi4wXG4gKiBodHRwOi8vanF1ZXJ5dWkuY29tXG4gKlxuICogQ29weXJpZ2h0IGpRdWVyeSBGb3VuZGF0aW9uIGFuZCBvdGhlciBjb250cmlidXRvcnNcbiAqIFJlbGVhc2VkIHVuZGVyIHRoZSBNSVQgbGljZW5zZS5cbiAqIGh0dHA6Ly9qcXVlcnkub3JnL2xpY2Vuc2VcbiAqXG4gKiBodHRwOi8vYXBpLmpxdWVyeXVpLmNvbS9wb3NpdGlvbi9cbiAqL1xuXG4vLz4+bGFiZWw6IFBvc2l0aW9uXG4vLz4+Z3JvdXA6IENvcmVcbi8vPj5kZXNjcmlwdGlvbjogUG9zaXRpb25zIGVsZW1lbnRzIHJlbGF0aXZlIHRvIG90aGVyIGVsZW1lbnRzLlxuLy8+PmRvY3M6IGh0dHA6Ly9hcGkuanF1ZXJ5dWkuY29tL3Bvc2l0aW9uL1xuLy8+PmRlbW9zOiBodHRwOi8vanF1ZXJ5dWkuY29tL3Bvc2l0aW9uL1xuXG4oIGZ1bmN0aW9uKCBmYWN0b3J5ICkge1xuXHRpZiAoIHR5cGVvZiBkZWZpbmUgPT09IFwiZnVuY3Rpb25cIiAmJiBkZWZpbmUuYW1kICkge1xuXG5cdFx0Ly8gQU1ELiBSZWdpc3RlciBhcyBhbiBhbm9ueW1vdXMgbW9kdWxlLlxuXHRcdGRlZmluZSggWyBcImpxdWVyeVwiLCBcIi4vdmVyc2lvblwiIF0sIGZhY3RvcnkgKTtcblx0fSBlbHNlIHtcblxuXHRcdC8vIEJyb3dzZXIgZ2xvYmFsc1xuXHRcdGZhY3RvcnkoIGpRdWVyeSApO1xuXHR9XG59KCBmdW5jdGlvbiggJCApIHtcbiggZnVuY3Rpb24oKSB7XG52YXIgY2FjaGVkU2Nyb2xsYmFyV2lkdGgsIHN1cHBvcnRzT2Zmc2V0RnJhY3Rpb25zLFxuXHRtYXggPSBNYXRoLm1heCxcblx0YWJzID0gTWF0aC5hYnMsXG5cdHJvdW5kID0gTWF0aC5yb3VuZCxcblx0cmhvcml6b250YWwgPSAvbGVmdHxjZW50ZXJ8cmlnaHQvLFxuXHRydmVydGljYWwgPSAvdG9wfGNlbnRlcnxib3R0b20vLFxuXHRyb2Zmc2V0ID0gL1tcXCtcXC1dXFxkKyhcXC5bXFxkXSspPyU/Lyxcblx0cnBvc2l0aW9uID0gL15cXHcrLyxcblx0cnBlcmNlbnQgPSAvJSQvLFxuXHRfcG9zaXRpb24gPSAkLmZuLnBvc2l0aW9uO1xuXG4vLyBTdXBwb3J0OiBJRSA8PTkgb25seVxuc3VwcG9ydHNPZmZzZXRGcmFjdGlvbnMgPSBmdW5jdGlvbigpIHtcblx0dmFyIGVsZW1lbnQgPSAkKCBcIjxkaXY+XCIgKVxuXHRcdFx0LmNzcyggXCJwb3NpdGlvblwiLCBcImFic29sdXRlXCIgKVxuXHRcdFx0LmFwcGVuZFRvKCBcImJvZHlcIiApXG5cdFx0XHQub2Zmc2V0KCB7XG5cdFx0XHRcdHRvcDogMS41LFxuXHRcdFx0XHRsZWZ0OiAxLjVcblx0XHRcdH0gKSxcblx0XHRzdXBwb3J0ID0gZWxlbWVudC5vZmZzZXQoKS50b3AgPT09IDEuNTtcblxuXHRlbGVtZW50LnJlbW92ZSgpO1xuXG5cdHN1cHBvcnRzT2Zmc2V0RnJhY3Rpb25zID0gZnVuY3Rpb24oKSB7XG5cdFx0cmV0dXJuIHN1cHBvcnQ7XG5cdH07XG5cblx0cmV0dXJuIHN1cHBvcnQ7XG59O1xuXG5mdW5jdGlvbiBnZXRPZmZzZXRzKCBvZmZzZXRzLCB3aWR0aCwgaGVpZ2h0ICkge1xuXHRyZXR1cm4gW1xuXHRcdHBhcnNlRmxvYXQoIG9mZnNldHNbIDAgXSApICogKCBycGVyY2VudC50ZXN0KCBvZmZzZXRzWyAwIF0gKSA/IHdpZHRoIC8gMTAwIDogMSApLFxuXHRcdHBhcnNlRmxvYXQoIG9mZnNldHNbIDEgXSApICogKCBycGVyY2VudC50ZXN0KCBvZmZzZXRzWyAxIF0gKSA/IGhlaWdodCAvIDEwMCA6IDEgKVxuXHRdO1xufVxuXG5mdW5jdGlvbiBwYXJzZUNzcyggZWxlbWVudCwgcHJvcGVydHkgKSB7XG5cdHJldHVybiBwYXJzZUludCggJC5jc3MoIGVsZW1lbnQsIHByb3BlcnR5ICksIDEwICkgfHwgMDtcbn1cblxuZnVuY3Rpb24gZ2V0RGltZW5zaW9ucyggZWxlbSApIHtcblx0dmFyIHJhdyA9IGVsZW1bIDAgXTtcblx0aWYgKCByYXcubm9kZVR5cGUgPT09IDkgKSB7XG5cdFx0cmV0dXJuIHtcblx0XHRcdHdpZHRoOiBlbGVtLndpZHRoKCksXG5cdFx0XHRoZWlnaHQ6IGVsZW0uaGVpZ2h0KCksXG5cdFx0XHRvZmZzZXQ6IHsgdG9wOiAwLCBsZWZ0OiAwIH1cblx0XHR9O1xuXHR9XG5cdGlmICggJC5pc1dpbmRvdyggcmF3ICkgKSB7XG5cdFx0cmV0dXJuIHtcblx0XHRcdHdpZHRoOiBlbGVtLndpZHRoKCksXG5cdFx0XHRoZWlnaHQ6IGVsZW0uaGVpZ2h0KCksXG5cdFx0XHRvZmZzZXQ6IHsgdG9wOiBlbGVtLnNjcm9sbFRvcCgpLCBsZWZ0OiBlbGVtLnNjcm9sbExlZnQoKSB9XG5cdFx0fTtcblx0fVxuXHRpZiAoIHJhdy5wcmV2ZW50RGVmYXVsdCApIHtcblx0XHRyZXR1cm4ge1xuXHRcdFx0d2lkdGg6IDAsXG5cdFx0XHRoZWlnaHQ6IDAsXG5cdFx0XHRvZmZzZXQ6IHsgdG9wOiByYXcucGFnZVksIGxlZnQ6IHJhdy5wYWdlWCB9XG5cdFx0fTtcblx0fVxuXHRyZXR1cm4ge1xuXHRcdHdpZHRoOiBlbGVtLm91dGVyV2lkdGgoKSxcblx0XHRoZWlnaHQ6IGVsZW0ub3V0ZXJIZWlnaHQoKSxcblx0XHRvZmZzZXQ6IGVsZW0ub2Zmc2V0KClcblx0fTtcbn1cblxuJC5wb3NpdGlvbiA9IHtcblx0c2Nyb2xsYmFyV2lkdGg6IGZ1bmN0aW9uKCkge1xuXHRcdGlmICggY2FjaGVkU2Nyb2xsYmFyV2lkdGggIT09IHVuZGVmaW5lZCApIHtcblx0XHRcdHJldHVybiBjYWNoZWRTY3JvbGxiYXJXaWR0aDtcblx0XHR9XG5cdFx0dmFyIHcxLCB3Mixcblx0XHRcdGRpdiA9ICQoIFwiPGRpdiBcIiArXG5cdFx0XHRcdFwic3R5bGU9J2Rpc3BsYXk6YmxvY2s7cG9zaXRpb246YWJzb2x1dGU7d2lkdGg6NTBweDtoZWlnaHQ6NTBweDtvdmVyZmxvdzpoaWRkZW47Jz5cIiArXG5cdFx0XHRcdFwiPGRpdiBzdHlsZT0naGVpZ2h0OjEwMHB4O3dpZHRoOmF1dG87Jz48L2Rpdj48L2Rpdj5cIiApLFxuXHRcdFx0aW5uZXJEaXYgPSBkaXYuY2hpbGRyZW4oKVsgMCBdO1xuXG5cdFx0JCggXCJib2R5XCIgKS5hcHBlbmQoIGRpdiApO1xuXHRcdHcxID0gaW5uZXJEaXYub2Zmc2V0V2lkdGg7XG5cdFx0ZGl2LmNzcyggXCJvdmVyZmxvd1wiLCBcInNjcm9sbFwiICk7XG5cblx0XHR3MiA9IGlubmVyRGl2Lm9mZnNldFdpZHRoO1xuXG5cdFx0aWYgKCB3MSA9PT0gdzIgKSB7XG5cdFx0XHR3MiA9IGRpdlsgMCBdLmNsaWVudFdpZHRoO1xuXHRcdH1cblxuXHRcdGRpdi5yZW1vdmUoKTtcblxuXHRcdHJldHVybiAoIGNhY2hlZFNjcm9sbGJhcldpZHRoID0gdzEgLSB3MiApO1xuXHR9LFxuXHRnZXRTY3JvbGxJbmZvOiBmdW5jdGlvbiggd2l0aGluICkge1xuXHRcdHZhciBvdmVyZmxvd1ggPSB3aXRoaW4uaXNXaW5kb3cgfHwgd2l0aGluLmlzRG9jdW1lbnQgPyBcIlwiIDpcblx0XHRcdFx0d2l0aGluLmVsZW1lbnQuY3NzKCBcIm92ZXJmbG93LXhcIiApLFxuXHRcdFx0b3ZlcmZsb3dZID0gd2l0aGluLmlzV2luZG93IHx8IHdpdGhpbi5pc0RvY3VtZW50ID8gXCJcIiA6XG5cdFx0XHRcdHdpdGhpbi5lbGVtZW50LmNzcyggXCJvdmVyZmxvdy15XCIgKSxcblx0XHRcdGhhc092ZXJmbG93WCA9IG92ZXJmbG93WCA9PT0gXCJzY3JvbGxcIiB8fFxuXHRcdFx0XHQoIG92ZXJmbG93WCA9PT0gXCJhdXRvXCIgJiYgd2l0aGluLndpZHRoIDwgd2l0aGluLmVsZW1lbnRbIDAgXS5zY3JvbGxXaWR0aCApLFxuXHRcdFx0aGFzT3ZlcmZsb3dZID0gb3ZlcmZsb3dZID09PSBcInNjcm9sbFwiIHx8XG5cdFx0XHRcdCggb3ZlcmZsb3dZID09PSBcImF1dG9cIiAmJiB3aXRoaW4uaGVpZ2h0IDwgd2l0aGluLmVsZW1lbnRbIDAgXS5zY3JvbGxIZWlnaHQgKTtcblx0XHRyZXR1cm4ge1xuXHRcdFx0d2lkdGg6IGhhc092ZXJmbG93WSA/ICQucG9zaXRpb24uc2Nyb2xsYmFyV2lkdGgoKSA6IDAsXG5cdFx0XHRoZWlnaHQ6IGhhc092ZXJmbG93WCA/ICQucG9zaXRpb24uc2Nyb2xsYmFyV2lkdGgoKSA6IDBcblx0XHR9O1xuXHR9LFxuXHRnZXRXaXRoaW5JbmZvOiBmdW5jdGlvbiggZWxlbWVudCApIHtcblx0XHR2YXIgd2l0aGluRWxlbWVudCA9ICQoIGVsZW1lbnQgfHwgd2luZG93ICksXG5cdFx0XHRpc1dpbmRvdyA9ICQuaXNXaW5kb3coIHdpdGhpbkVsZW1lbnRbIDAgXSApLFxuXHRcdFx0aXNEb2N1bWVudCA9ICEhd2l0aGluRWxlbWVudFsgMCBdICYmIHdpdGhpbkVsZW1lbnRbIDAgXS5ub2RlVHlwZSA9PT0gOSxcblx0XHRcdGhhc09mZnNldCA9ICFpc1dpbmRvdyAmJiAhaXNEb2N1bWVudDtcblx0XHRyZXR1cm4ge1xuXHRcdFx0ZWxlbWVudDogd2l0aGluRWxlbWVudCxcblx0XHRcdGlzV2luZG93OiBpc1dpbmRvdyxcblx0XHRcdGlzRG9jdW1lbnQ6IGlzRG9jdW1lbnQsXG5cdFx0XHRvZmZzZXQ6IGhhc09mZnNldCA/ICQoIGVsZW1lbnQgKS5vZmZzZXQoKSA6IHsgbGVmdDogMCwgdG9wOiAwIH0sXG5cdFx0XHRzY3JvbGxMZWZ0OiB3aXRoaW5FbGVtZW50LnNjcm9sbExlZnQoKSxcblx0XHRcdHNjcm9sbFRvcDogd2l0aGluRWxlbWVudC5zY3JvbGxUb3AoKSxcblx0XHRcdHdpZHRoOiB3aXRoaW5FbGVtZW50Lm91dGVyV2lkdGgoKSxcblx0XHRcdGhlaWdodDogd2l0aGluRWxlbWVudC5vdXRlckhlaWdodCgpXG5cdFx0fTtcblx0fVxufTtcblxuJC5mbi5wb3NpdGlvbiA9IGZ1bmN0aW9uKCBvcHRpb25zICkge1xuXHRpZiAoICFvcHRpb25zIHx8ICFvcHRpb25zLm9mICkge1xuXHRcdHJldHVybiBfcG9zaXRpb24uYXBwbHkoIHRoaXMsIGFyZ3VtZW50cyApO1xuXHR9XG5cblx0Ly8gTWFrZSBhIGNvcHksIHdlIGRvbid0IHdhbnQgdG8gbW9kaWZ5IGFyZ3VtZW50c1xuXHRvcHRpb25zID0gJC5leHRlbmQoIHt9LCBvcHRpb25zICk7XG5cblx0dmFyIGF0T2Zmc2V0LCB0YXJnZXRXaWR0aCwgdGFyZ2V0SGVpZ2h0LCB0YXJnZXRPZmZzZXQsIGJhc2VQb3NpdGlvbiwgZGltZW5zaW9ucyxcblx0XHR0YXJnZXQgPSAkKCBvcHRpb25zLm9mICksXG5cdFx0d2l0aGluID0gJC5wb3NpdGlvbi5nZXRXaXRoaW5JbmZvKCBvcHRpb25zLndpdGhpbiApLFxuXHRcdHNjcm9sbEluZm8gPSAkLnBvc2l0aW9uLmdldFNjcm9sbEluZm8oIHdpdGhpbiApLFxuXHRcdGNvbGxpc2lvbiA9ICggb3B0aW9ucy5jb2xsaXNpb24gfHwgXCJmbGlwXCIgKS5zcGxpdCggXCIgXCIgKSxcblx0XHRvZmZzZXRzID0ge307XG5cblx0ZGltZW5zaW9ucyA9IGdldERpbWVuc2lvbnMoIHRhcmdldCApO1xuXHRpZiAoIHRhcmdldFsgMCBdLnByZXZlbnREZWZhdWx0ICkge1xuXG5cdFx0Ly8gRm9yY2UgbGVmdCB0b3AgdG8gYWxsb3cgZmxpcHBpbmdcblx0XHRvcHRpb25zLmF0ID0gXCJsZWZ0IHRvcFwiO1xuXHR9XG5cdHRhcmdldFdpZHRoID0gZGltZW5zaW9ucy53aWR0aDtcblx0dGFyZ2V0SGVpZ2h0ID0gZGltZW5zaW9ucy5oZWlnaHQ7XG5cdHRhcmdldE9mZnNldCA9IGRpbWVuc2lvbnMub2Zmc2V0O1xuXG5cdC8vIENsb25lIHRvIHJldXNlIG9yaWdpbmFsIHRhcmdldE9mZnNldCBsYXRlclxuXHRiYXNlUG9zaXRpb24gPSAkLmV4dGVuZCgge30sIHRhcmdldE9mZnNldCApO1xuXG5cdC8vIEZvcmNlIG15IGFuZCBhdCB0byBoYXZlIHZhbGlkIGhvcml6b250YWwgYW5kIHZlcnRpY2FsIHBvc2l0aW9uc1xuXHQvLyBpZiBhIHZhbHVlIGlzIG1pc3Npbmcgb3IgaW52YWxpZCwgaXQgd2lsbCBiZSBjb252ZXJ0ZWQgdG8gY2VudGVyXG5cdCQuZWFjaCggWyBcIm15XCIsIFwiYXRcIiBdLCBmdW5jdGlvbigpIHtcblx0XHR2YXIgcG9zID0gKCBvcHRpb25zWyB0aGlzIF0gfHwgXCJcIiApLnNwbGl0KCBcIiBcIiApLFxuXHRcdFx0aG9yaXpvbnRhbE9mZnNldCxcblx0XHRcdHZlcnRpY2FsT2Zmc2V0O1xuXG5cdFx0aWYgKCBwb3MubGVuZ3RoID09PSAxICkge1xuXHRcdFx0cG9zID0gcmhvcml6b250YWwudGVzdCggcG9zWyAwIF0gKSA/XG5cdFx0XHRcdHBvcy5jb25jYXQoIFsgXCJjZW50ZXJcIiBdICkgOlxuXHRcdFx0XHRydmVydGljYWwudGVzdCggcG9zWyAwIF0gKSA/XG5cdFx0XHRcdFx0WyBcImNlbnRlclwiIF0uY29uY2F0KCBwb3MgKSA6XG5cdFx0XHRcdFx0WyBcImNlbnRlclwiLCBcImNlbnRlclwiIF07XG5cdFx0fVxuXHRcdHBvc1sgMCBdID0gcmhvcml6b250YWwudGVzdCggcG9zWyAwIF0gKSA/IHBvc1sgMCBdIDogXCJjZW50ZXJcIjtcblx0XHRwb3NbIDEgXSA9IHJ2ZXJ0aWNhbC50ZXN0KCBwb3NbIDEgXSApID8gcG9zWyAxIF0gOiBcImNlbnRlclwiO1xuXG5cdFx0Ly8gQ2FsY3VsYXRlIG9mZnNldHNcblx0XHRob3Jpem9udGFsT2Zmc2V0ID0gcm9mZnNldC5leGVjKCBwb3NbIDAgXSApO1xuXHRcdHZlcnRpY2FsT2Zmc2V0ID0gcm9mZnNldC5leGVjKCBwb3NbIDEgXSApO1xuXHRcdG9mZnNldHNbIHRoaXMgXSA9IFtcblx0XHRcdGhvcml6b250YWxPZmZzZXQgPyBob3Jpem9udGFsT2Zmc2V0WyAwIF0gOiAwLFxuXHRcdFx0dmVydGljYWxPZmZzZXQgPyB2ZXJ0aWNhbE9mZnNldFsgMCBdIDogMFxuXHRcdF07XG5cblx0XHQvLyBSZWR1Y2UgdG8ganVzdCB0aGUgcG9zaXRpb25zIHdpdGhvdXQgdGhlIG9mZnNldHNcblx0XHRvcHRpb25zWyB0aGlzIF0gPSBbXG5cdFx0XHRycG9zaXRpb24uZXhlYyggcG9zWyAwIF0gKVsgMCBdLFxuXHRcdFx0cnBvc2l0aW9uLmV4ZWMoIHBvc1sgMSBdIClbIDAgXVxuXHRcdF07XG5cdH0gKTtcblxuXHQvLyBOb3JtYWxpemUgY29sbGlzaW9uIG9wdGlvblxuXHRpZiAoIGNvbGxpc2lvbi5sZW5ndGggPT09IDEgKSB7XG5cdFx0Y29sbGlzaW9uWyAxIF0gPSBjb2xsaXNpb25bIDAgXTtcblx0fVxuXG5cdGlmICggb3B0aW9ucy5hdFsgMCBdID09PSBcInJpZ2h0XCIgKSB7XG5cdFx0YmFzZVBvc2l0aW9uLmxlZnQgKz0gdGFyZ2V0V2lkdGg7XG5cdH0gZWxzZSBpZiAoIG9wdGlvbnMuYXRbIDAgXSA9PT0gXCJjZW50ZXJcIiApIHtcblx0XHRiYXNlUG9zaXRpb24ubGVmdCArPSB0YXJnZXRXaWR0aCAvIDI7XG5cdH1cblxuXHRpZiAoIG9wdGlvbnMuYXRbIDEgXSA9PT0gXCJib3R0b21cIiApIHtcblx0XHRiYXNlUG9zaXRpb24udG9wICs9IHRhcmdldEhlaWdodDtcblx0fSBlbHNlIGlmICggb3B0aW9ucy5hdFsgMSBdID09PSBcImNlbnRlclwiICkge1xuXHRcdGJhc2VQb3NpdGlvbi50b3AgKz0gdGFyZ2V0SGVpZ2h0IC8gMjtcblx0fVxuXG5cdGF0T2Zmc2V0ID0gZ2V0T2Zmc2V0cyggb2Zmc2V0cy5hdCwgdGFyZ2V0V2lkdGgsIHRhcmdldEhlaWdodCApO1xuXHRiYXNlUG9zaXRpb24ubGVmdCArPSBhdE9mZnNldFsgMCBdO1xuXHRiYXNlUG9zaXRpb24udG9wICs9IGF0T2Zmc2V0WyAxIF07XG5cblx0cmV0dXJuIHRoaXMuZWFjaCggZnVuY3Rpb24oKSB7XG5cdFx0dmFyIGNvbGxpc2lvblBvc2l0aW9uLCB1c2luZyxcblx0XHRcdGVsZW0gPSAkKCB0aGlzICksXG5cdFx0XHRlbGVtV2lkdGggPSBlbGVtLm91dGVyV2lkdGgoKSxcblx0XHRcdGVsZW1IZWlnaHQgPSBlbGVtLm91dGVySGVpZ2h0KCksXG5cdFx0XHRtYXJnaW5MZWZ0ID0gcGFyc2VDc3MoIHRoaXMsIFwibWFyZ2luTGVmdFwiICksXG5cdFx0XHRtYXJnaW5Ub3AgPSBwYXJzZUNzcyggdGhpcywgXCJtYXJnaW5Ub3BcIiApLFxuXHRcdFx0Y29sbGlzaW9uV2lkdGggPSBlbGVtV2lkdGggKyBtYXJnaW5MZWZ0ICsgcGFyc2VDc3MoIHRoaXMsIFwibWFyZ2luUmlnaHRcIiApICtcblx0XHRcdFx0c2Nyb2xsSW5mby53aWR0aCxcblx0XHRcdGNvbGxpc2lvbkhlaWdodCA9IGVsZW1IZWlnaHQgKyBtYXJnaW5Ub3AgKyBwYXJzZUNzcyggdGhpcywgXCJtYXJnaW5Cb3R0b21cIiApICtcblx0XHRcdFx0c2Nyb2xsSW5mby5oZWlnaHQsXG5cdFx0XHRwb3NpdGlvbiA9ICQuZXh0ZW5kKCB7fSwgYmFzZVBvc2l0aW9uICksXG5cdFx0XHRteU9mZnNldCA9IGdldE9mZnNldHMoIG9mZnNldHMubXksIGVsZW0ub3V0ZXJXaWR0aCgpLCBlbGVtLm91dGVySGVpZ2h0KCkgKTtcblxuXHRcdGlmICggb3B0aW9ucy5teVsgMCBdID09PSBcInJpZ2h0XCIgKSB7XG5cdFx0XHRwb3NpdGlvbi5sZWZ0IC09IGVsZW1XaWR0aDtcblx0XHR9IGVsc2UgaWYgKCBvcHRpb25zLm15WyAwIF0gPT09IFwiY2VudGVyXCIgKSB7XG5cdFx0XHRwb3NpdGlvbi5sZWZ0IC09IGVsZW1XaWR0aCAvIDI7XG5cdFx0fVxuXG5cdFx0aWYgKCBvcHRpb25zLm15WyAxIF0gPT09IFwiYm90dG9tXCIgKSB7XG5cdFx0XHRwb3NpdGlvbi50b3AgLT0gZWxlbUhlaWdodDtcblx0XHR9IGVsc2UgaWYgKCBvcHRpb25zLm15WyAxIF0gPT09IFwiY2VudGVyXCIgKSB7XG5cdFx0XHRwb3NpdGlvbi50b3AgLT0gZWxlbUhlaWdodCAvIDI7XG5cdFx0fVxuXG5cdFx0cG9zaXRpb24ubGVmdCArPSBteU9mZnNldFsgMCBdO1xuXHRcdHBvc2l0aW9uLnRvcCArPSBteU9mZnNldFsgMSBdO1xuXG5cdFx0Ly8gSWYgdGhlIGJyb3dzZXIgZG9lc24ndCBzdXBwb3J0IGZyYWN0aW9ucywgdGhlbiByb3VuZCBmb3IgY29uc2lzdGVudCByZXN1bHRzXG5cdFx0aWYgKCAhc3VwcG9ydHNPZmZzZXRGcmFjdGlvbnMoKSApIHtcblx0XHRcdHBvc2l0aW9uLmxlZnQgPSByb3VuZCggcG9zaXRpb24ubGVmdCApO1xuXHRcdFx0cG9zaXRpb24udG9wID0gcm91bmQoIHBvc2l0aW9uLnRvcCApO1xuXHRcdH1cblxuXHRcdGNvbGxpc2lvblBvc2l0aW9uID0ge1xuXHRcdFx0bWFyZ2luTGVmdDogbWFyZ2luTGVmdCxcblx0XHRcdG1hcmdpblRvcDogbWFyZ2luVG9wXG5cdFx0fTtcblxuXHRcdCQuZWFjaCggWyBcImxlZnRcIiwgXCJ0b3BcIiBdLCBmdW5jdGlvbiggaSwgZGlyICkge1xuXHRcdFx0aWYgKCAkLnVpLnBvc2l0aW9uWyBjb2xsaXNpb25bIGkgXSBdICkge1xuXHRcdFx0XHQkLnVpLnBvc2l0aW9uWyBjb2xsaXNpb25bIGkgXSBdWyBkaXIgXSggcG9zaXRpb24sIHtcblx0XHRcdFx0XHR0YXJnZXRXaWR0aDogdGFyZ2V0V2lkdGgsXG5cdFx0XHRcdFx0dGFyZ2V0SGVpZ2h0OiB0YXJnZXRIZWlnaHQsXG5cdFx0XHRcdFx0ZWxlbVdpZHRoOiBlbGVtV2lkdGgsXG5cdFx0XHRcdFx0ZWxlbUhlaWdodDogZWxlbUhlaWdodCxcblx0XHRcdFx0XHRjb2xsaXNpb25Qb3NpdGlvbjogY29sbGlzaW9uUG9zaXRpb24sXG5cdFx0XHRcdFx0Y29sbGlzaW9uV2lkdGg6IGNvbGxpc2lvbldpZHRoLFxuXHRcdFx0XHRcdGNvbGxpc2lvbkhlaWdodDogY29sbGlzaW9uSGVpZ2h0LFxuXHRcdFx0XHRcdG9mZnNldDogWyBhdE9mZnNldFsgMCBdICsgbXlPZmZzZXRbIDAgXSwgYXRPZmZzZXQgWyAxIF0gKyBteU9mZnNldFsgMSBdIF0sXG5cdFx0XHRcdFx0bXk6IG9wdGlvbnMubXksXG5cdFx0XHRcdFx0YXQ6IG9wdGlvbnMuYXQsXG5cdFx0XHRcdFx0d2l0aGluOiB3aXRoaW4sXG5cdFx0XHRcdFx0ZWxlbTogZWxlbVxuXHRcdFx0XHR9ICk7XG5cdFx0XHR9XG5cdFx0fSApO1xuXG5cdFx0aWYgKCBvcHRpb25zLnVzaW5nICkge1xuXG5cdFx0XHQvLyBBZGRzIGZlZWRiYWNrIGFzIHNlY29uZCBhcmd1bWVudCB0byB1c2luZyBjYWxsYmFjaywgaWYgcHJlc2VudFxuXHRcdFx0dXNpbmcgPSBmdW5jdGlvbiggcHJvcHMgKSB7XG5cdFx0XHRcdHZhciBsZWZ0ID0gdGFyZ2V0T2Zmc2V0LmxlZnQgLSBwb3NpdGlvbi5sZWZ0LFxuXHRcdFx0XHRcdHJpZ2h0ID0gbGVmdCArIHRhcmdldFdpZHRoIC0gZWxlbVdpZHRoLFxuXHRcdFx0XHRcdHRvcCA9IHRhcmdldE9mZnNldC50b3AgLSBwb3NpdGlvbi50b3AsXG5cdFx0XHRcdFx0Ym90dG9tID0gdG9wICsgdGFyZ2V0SGVpZ2h0IC0gZWxlbUhlaWdodCxcblx0XHRcdFx0XHRmZWVkYmFjayA9IHtcblx0XHRcdFx0XHRcdHRhcmdldDoge1xuXHRcdFx0XHRcdFx0XHRlbGVtZW50OiB0YXJnZXQsXG5cdFx0XHRcdFx0XHRcdGxlZnQ6IHRhcmdldE9mZnNldC5sZWZ0LFxuXHRcdFx0XHRcdFx0XHR0b3A6IHRhcmdldE9mZnNldC50b3AsXG5cdFx0XHRcdFx0XHRcdHdpZHRoOiB0YXJnZXRXaWR0aCxcblx0XHRcdFx0XHRcdFx0aGVpZ2h0OiB0YXJnZXRIZWlnaHRcblx0XHRcdFx0XHRcdH0sXG5cdFx0XHRcdFx0XHRlbGVtZW50OiB7XG5cdFx0XHRcdFx0XHRcdGVsZW1lbnQ6IGVsZW0sXG5cdFx0XHRcdFx0XHRcdGxlZnQ6IHBvc2l0aW9uLmxlZnQsXG5cdFx0XHRcdFx0XHRcdHRvcDogcG9zaXRpb24udG9wLFxuXHRcdFx0XHRcdFx0XHR3aWR0aDogZWxlbVdpZHRoLFxuXHRcdFx0XHRcdFx0XHRoZWlnaHQ6IGVsZW1IZWlnaHRcblx0XHRcdFx0XHRcdH0sXG5cdFx0XHRcdFx0XHRob3Jpem9udGFsOiByaWdodCA8IDAgPyBcImxlZnRcIiA6IGxlZnQgPiAwID8gXCJyaWdodFwiIDogXCJjZW50ZXJcIixcblx0XHRcdFx0XHRcdHZlcnRpY2FsOiBib3R0b20gPCAwID8gXCJ0b3BcIiA6IHRvcCA+IDAgPyBcImJvdHRvbVwiIDogXCJtaWRkbGVcIlxuXHRcdFx0XHRcdH07XG5cdFx0XHRcdGlmICggdGFyZ2V0V2lkdGggPCBlbGVtV2lkdGggJiYgYWJzKCBsZWZ0ICsgcmlnaHQgKSA8IHRhcmdldFdpZHRoICkge1xuXHRcdFx0XHRcdGZlZWRiYWNrLmhvcml6b250YWwgPSBcImNlbnRlclwiO1xuXHRcdFx0XHR9XG5cdFx0XHRcdGlmICggdGFyZ2V0SGVpZ2h0IDwgZWxlbUhlaWdodCAmJiBhYnMoIHRvcCArIGJvdHRvbSApIDwgdGFyZ2V0SGVpZ2h0ICkge1xuXHRcdFx0XHRcdGZlZWRiYWNrLnZlcnRpY2FsID0gXCJtaWRkbGVcIjtcblx0XHRcdFx0fVxuXHRcdFx0XHRpZiAoIG1heCggYWJzKCBsZWZ0ICksIGFicyggcmlnaHQgKSApID4gbWF4KCBhYnMoIHRvcCApLCBhYnMoIGJvdHRvbSApICkgKSB7XG5cdFx0XHRcdFx0ZmVlZGJhY2suaW1wb3J0YW50ID0gXCJob3Jpem9udGFsXCI7XG5cdFx0XHRcdH0gZWxzZSB7XG5cdFx0XHRcdFx0ZmVlZGJhY2suaW1wb3J0YW50ID0gXCJ2ZXJ0aWNhbFwiO1xuXHRcdFx0XHR9XG5cdFx0XHRcdG9wdGlvbnMudXNpbmcuY2FsbCggdGhpcywgcHJvcHMsIGZlZWRiYWNrICk7XG5cdFx0XHR9O1xuXHRcdH1cblxuXHRcdGVsZW0ub2Zmc2V0KCAkLmV4dGVuZCggcG9zaXRpb24sIHsgdXNpbmc6IHVzaW5nIH0gKSApO1xuXHR9ICk7XG59O1xuXG4kLnVpLnBvc2l0aW9uID0ge1xuXHRmaXQ6IHtcblx0XHRsZWZ0OiBmdW5jdGlvbiggcG9zaXRpb24sIGRhdGEgKSB7XG5cdFx0XHR2YXIgd2l0aGluID0gZGF0YS53aXRoaW4sXG5cdFx0XHRcdHdpdGhpbk9mZnNldCA9IHdpdGhpbi5pc1dpbmRvdyA/IHdpdGhpbi5zY3JvbGxMZWZ0IDogd2l0aGluLm9mZnNldC5sZWZ0LFxuXHRcdFx0XHRvdXRlcldpZHRoID0gd2l0aGluLndpZHRoLFxuXHRcdFx0XHRjb2xsaXNpb25Qb3NMZWZ0ID0gcG9zaXRpb24ubGVmdCAtIGRhdGEuY29sbGlzaW9uUG9zaXRpb24ubWFyZ2luTGVmdCxcblx0XHRcdFx0b3ZlckxlZnQgPSB3aXRoaW5PZmZzZXQgLSBjb2xsaXNpb25Qb3NMZWZ0LFxuXHRcdFx0XHRvdmVyUmlnaHQgPSBjb2xsaXNpb25Qb3NMZWZ0ICsgZGF0YS5jb2xsaXNpb25XaWR0aCAtIG91dGVyV2lkdGggLSB3aXRoaW5PZmZzZXQsXG5cdFx0XHRcdG5ld092ZXJSaWdodDtcblxuXHRcdFx0Ly8gRWxlbWVudCBpcyB3aWRlciB0aGFuIHdpdGhpblxuXHRcdFx0aWYgKCBkYXRhLmNvbGxpc2lvbldpZHRoID4gb3V0ZXJXaWR0aCApIHtcblxuXHRcdFx0XHQvLyBFbGVtZW50IGlzIGluaXRpYWxseSBvdmVyIHRoZSBsZWZ0IHNpZGUgb2Ygd2l0aGluXG5cdFx0XHRcdGlmICggb3ZlckxlZnQgPiAwICYmIG92ZXJSaWdodCA8PSAwICkge1xuXHRcdFx0XHRcdG5ld092ZXJSaWdodCA9IHBvc2l0aW9uLmxlZnQgKyBvdmVyTGVmdCArIGRhdGEuY29sbGlzaW9uV2lkdGggLSBvdXRlcldpZHRoIC1cblx0XHRcdFx0XHRcdHdpdGhpbk9mZnNldDtcblx0XHRcdFx0XHRwb3NpdGlvbi5sZWZ0ICs9IG92ZXJMZWZ0IC0gbmV3T3ZlclJpZ2h0O1xuXG5cdFx0XHRcdC8vIEVsZW1lbnQgaXMgaW5pdGlhbGx5IG92ZXIgcmlnaHQgc2lkZSBvZiB3aXRoaW5cblx0XHRcdFx0fSBlbHNlIGlmICggb3ZlclJpZ2h0ID4gMCAmJiBvdmVyTGVmdCA8PSAwICkge1xuXHRcdFx0XHRcdHBvc2l0aW9uLmxlZnQgPSB3aXRoaW5PZmZzZXQ7XG5cblx0XHRcdFx0Ly8gRWxlbWVudCBpcyBpbml0aWFsbHkgb3ZlciBib3RoIGxlZnQgYW5kIHJpZ2h0IHNpZGVzIG9mIHdpdGhpblxuXHRcdFx0XHR9IGVsc2Uge1xuXHRcdFx0XHRcdGlmICggb3ZlckxlZnQgPiBvdmVyUmlnaHQgKSB7XG5cdFx0XHRcdFx0XHRwb3NpdGlvbi5sZWZ0ID0gd2l0aGluT2Zmc2V0ICsgb3V0ZXJXaWR0aCAtIGRhdGEuY29sbGlzaW9uV2lkdGg7XG5cdFx0XHRcdFx0fSBlbHNlIHtcblx0XHRcdFx0XHRcdHBvc2l0aW9uLmxlZnQgPSB3aXRoaW5PZmZzZXQ7XG5cdFx0XHRcdFx0fVxuXHRcdFx0XHR9XG5cblx0XHRcdC8vIFRvbyBmYXIgbGVmdCAtPiBhbGlnbiB3aXRoIGxlZnQgZWRnZVxuXHRcdFx0fSBlbHNlIGlmICggb3ZlckxlZnQgPiAwICkge1xuXHRcdFx0XHRwb3NpdGlvbi5sZWZ0ICs9IG92ZXJMZWZ0O1xuXG5cdFx0XHQvLyBUb28gZmFyIHJpZ2h0IC0+IGFsaWduIHdpdGggcmlnaHQgZWRnZVxuXHRcdFx0fSBlbHNlIGlmICggb3ZlclJpZ2h0ID4gMCApIHtcblx0XHRcdFx0cG9zaXRpb24ubGVmdCAtPSBvdmVyUmlnaHQ7XG5cblx0XHRcdC8vIEFkanVzdCBiYXNlZCBvbiBwb3NpdGlvbiBhbmQgbWFyZ2luXG5cdFx0XHR9IGVsc2Uge1xuXHRcdFx0XHRwb3NpdGlvbi5sZWZ0ID0gbWF4KCBwb3NpdGlvbi5sZWZ0IC0gY29sbGlzaW9uUG9zTGVmdCwgcG9zaXRpb24ubGVmdCApO1xuXHRcdFx0fVxuXHRcdH0sXG5cdFx0dG9wOiBmdW5jdGlvbiggcG9zaXRpb24sIGRhdGEgKSB7XG5cdFx0XHR2YXIgd2l0aGluID0gZGF0YS53aXRoaW4sXG5cdFx0XHRcdHdpdGhpbk9mZnNldCA9IHdpdGhpbi5pc1dpbmRvdyA/IHdpdGhpbi5zY3JvbGxUb3AgOiB3aXRoaW4ub2Zmc2V0LnRvcCxcblx0XHRcdFx0b3V0ZXJIZWlnaHQgPSBkYXRhLndpdGhpbi5oZWlnaHQsXG5cdFx0XHRcdGNvbGxpc2lvblBvc1RvcCA9IHBvc2l0aW9uLnRvcCAtIGRhdGEuY29sbGlzaW9uUG9zaXRpb24ubWFyZ2luVG9wLFxuXHRcdFx0XHRvdmVyVG9wID0gd2l0aGluT2Zmc2V0IC0gY29sbGlzaW9uUG9zVG9wLFxuXHRcdFx0XHRvdmVyQm90dG9tID0gY29sbGlzaW9uUG9zVG9wICsgZGF0YS5jb2xsaXNpb25IZWlnaHQgLSBvdXRlckhlaWdodCAtIHdpdGhpbk9mZnNldCxcblx0XHRcdFx0bmV3T3ZlckJvdHRvbTtcblxuXHRcdFx0Ly8gRWxlbWVudCBpcyB0YWxsZXIgdGhhbiB3aXRoaW5cblx0XHRcdGlmICggZGF0YS5jb2xsaXNpb25IZWlnaHQgPiBvdXRlckhlaWdodCApIHtcblxuXHRcdFx0XHQvLyBFbGVtZW50IGlzIGluaXRpYWxseSBvdmVyIHRoZSB0b3Agb2Ygd2l0aGluXG5cdFx0XHRcdGlmICggb3ZlclRvcCA+IDAgJiYgb3ZlckJvdHRvbSA8PSAwICkge1xuXHRcdFx0XHRcdG5ld092ZXJCb3R0b20gPSBwb3NpdGlvbi50b3AgKyBvdmVyVG9wICsgZGF0YS5jb2xsaXNpb25IZWlnaHQgLSBvdXRlckhlaWdodCAtXG5cdFx0XHRcdFx0XHR3aXRoaW5PZmZzZXQ7XG5cdFx0XHRcdFx0cG9zaXRpb24udG9wICs9IG92ZXJUb3AgLSBuZXdPdmVyQm90dG9tO1xuXG5cdFx0XHRcdC8vIEVsZW1lbnQgaXMgaW5pdGlhbGx5IG92ZXIgYm90dG9tIG9mIHdpdGhpblxuXHRcdFx0XHR9IGVsc2UgaWYgKCBvdmVyQm90dG9tID4gMCAmJiBvdmVyVG9wIDw9IDAgKSB7XG5cdFx0XHRcdFx0cG9zaXRpb24udG9wID0gd2l0aGluT2Zmc2V0O1xuXG5cdFx0XHRcdC8vIEVsZW1lbnQgaXMgaW5pdGlhbGx5IG92ZXIgYm90aCB0b3AgYW5kIGJvdHRvbSBvZiB3aXRoaW5cblx0XHRcdFx0fSBlbHNlIHtcblx0XHRcdFx0XHRpZiAoIG92ZXJUb3AgPiBvdmVyQm90dG9tICkge1xuXHRcdFx0XHRcdFx0cG9zaXRpb24udG9wID0gd2l0aGluT2Zmc2V0ICsgb3V0ZXJIZWlnaHQgLSBkYXRhLmNvbGxpc2lvbkhlaWdodDtcblx0XHRcdFx0XHR9IGVsc2Uge1xuXHRcdFx0XHRcdFx0cG9zaXRpb24udG9wID0gd2l0aGluT2Zmc2V0O1xuXHRcdFx0XHRcdH1cblx0XHRcdFx0fVxuXG5cdFx0XHQvLyBUb28gZmFyIHVwIC0+IGFsaWduIHdpdGggdG9wXG5cdFx0XHR9IGVsc2UgaWYgKCBvdmVyVG9wID4gMCApIHtcblx0XHRcdFx0cG9zaXRpb24udG9wICs9IG92ZXJUb3A7XG5cblx0XHRcdC8vIFRvbyBmYXIgZG93biAtPiBhbGlnbiB3aXRoIGJvdHRvbSBlZGdlXG5cdFx0XHR9IGVsc2UgaWYgKCBvdmVyQm90dG9tID4gMCApIHtcblx0XHRcdFx0cG9zaXRpb24udG9wIC09IG92ZXJCb3R0b207XG5cblx0XHRcdC8vIEFkanVzdCBiYXNlZCBvbiBwb3NpdGlvbiBhbmQgbWFyZ2luXG5cdFx0XHR9IGVsc2Uge1xuXHRcdFx0XHRwb3NpdGlvbi50b3AgPSBtYXgoIHBvc2l0aW9uLnRvcCAtIGNvbGxpc2lvblBvc1RvcCwgcG9zaXRpb24udG9wICk7XG5cdFx0XHR9XG5cdFx0fVxuXHR9LFxuXHRmbGlwOiB7XG5cdFx0bGVmdDogZnVuY3Rpb24oIHBvc2l0aW9uLCBkYXRhICkge1xuXHRcdFx0dmFyIHdpdGhpbiA9IGRhdGEud2l0aGluLFxuXHRcdFx0XHR3aXRoaW5PZmZzZXQgPSB3aXRoaW4ub2Zmc2V0LmxlZnQgKyB3aXRoaW4uc2Nyb2xsTGVmdCxcblx0XHRcdFx0b3V0ZXJXaWR0aCA9IHdpdGhpbi53aWR0aCxcblx0XHRcdFx0b2Zmc2V0TGVmdCA9IHdpdGhpbi5pc1dpbmRvdyA/IHdpdGhpbi5zY3JvbGxMZWZ0IDogd2l0aGluLm9mZnNldC5sZWZ0LFxuXHRcdFx0XHRjb2xsaXNpb25Qb3NMZWZ0ID0gcG9zaXRpb24ubGVmdCAtIGRhdGEuY29sbGlzaW9uUG9zaXRpb24ubWFyZ2luTGVmdCxcblx0XHRcdFx0b3ZlckxlZnQgPSBjb2xsaXNpb25Qb3NMZWZ0IC0gb2Zmc2V0TGVmdCxcblx0XHRcdFx0b3ZlclJpZ2h0ID0gY29sbGlzaW9uUG9zTGVmdCArIGRhdGEuY29sbGlzaW9uV2lkdGggLSBvdXRlcldpZHRoIC0gb2Zmc2V0TGVmdCxcblx0XHRcdFx0bXlPZmZzZXQgPSBkYXRhLm15WyAwIF0gPT09IFwibGVmdFwiID9cblx0XHRcdFx0XHQtZGF0YS5lbGVtV2lkdGggOlxuXHRcdFx0XHRcdGRhdGEubXlbIDAgXSA9PT0gXCJyaWdodFwiID9cblx0XHRcdFx0XHRcdGRhdGEuZWxlbVdpZHRoIDpcblx0XHRcdFx0XHRcdDAsXG5cdFx0XHRcdGF0T2Zmc2V0ID0gZGF0YS5hdFsgMCBdID09PSBcImxlZnRcIiA/XG5cdFx0XHRcdFx0ZGF0YS50YXJnZXRXaWR0aCA6XG5cdFx0XHRcdFx0ZGF0YS5hdFsgMCBdID09PSBcInJpZ2h0XCIgP1xuXHRcdFx0XHRcdFx0LWRhdGEudGFyZ2V0V2lkdGggOlxuXHRcdFx0XHRcdFx0MCxcblx0XHRcdFx0b2Zmc2V0ID0gLTIgKiBkYXRhLm9mZnNldFsgMCBdLFxuXHRcdFx0XHRuZXdPdmVyUmlnaHQsXG5cdFx0XHRcdG5ld092ZXJMZWZ0O1xuXG5cdFx0XHRpZiAoIG92ZXJMZWZ0IDwgMCApIHtcblx0XHRcdFx0bmV3T3ZlclJpZ2h0ID0gcG9zaXRpb24ubGVmdCArIG15T2Zmc2V0ICsgYXRPZmZzZXQgKyBvZmZzZXQgKyBkYXRhLmNvbGxpc2lvbldpZHRoIC1cblx0XHRcdFx0XHRvdXRlcldpZHRoIC0gd2l0aGluT2Zmc2V0O1xuXHRcdFx0XHRpZiAoIG5ld092ZXJSaWdodCA8IDAgfHwgbmV3T3ZlclJpZ2h0IDwgYWJzKCBvdmVyTGVmdCApICkge1xuXHRcdFx0XHRcdHBvc2l0aW9uLmxlZnQgKz0gbXlPZmZzZXQgKyBhdE9mZnNldCArIG9mZnNldDtcblx0XHRcdFx0fVxuXHRcdFx0fSBlbHNlIGlmICggb3ZlclJpZ2h0ID4gMCApIHtcblx0XHRcdFx0bmV3T3ZlckxlZnQgPSBwb3NpdGlvbi5sZWZ0IC0gZGF0YS5jb2xsaXNpb25Qb3NpdGlvbi5tYXJnaW5MZWZ0ICsgbXlPZmZzZXQgK1xuXHRcdFx0XHRcdGF0T2Zmc2V0ICsgb2Zmc2V0IC0gb2Zmc2V0TGVmdDtcblx0XHRcdFx0aWYgKCBuZXdPdmVyTGVmdCA+IDAgfHwgYWJzKCBuZXdPdmVyTGVmdCApIDwgb3ZlclJpZ2h0ICkge1xuXHRcdFx0XHRcdHBvc2l0aW9uLmxlZnQgKz0gbXlPZmZzZXQgKyBhdE9mZnNldCArIG9mZnNldDtcblx0XHRcdFx0fVxuXHRcdFx0fVxuXHRcdH0sXG5cdFx0dG9wOiBmdW5jdGlvbiggcG9zaXRpb24sIGRhdGEgKSB7XG5cdFx0XHR2YXIgd2l0aGluID0gZGF0YS53aXRoaW4sXG5cdFx0XHRcdHdpdGhpbk9mZnNldCA9IHdpdGhpbi5vZmZzZXQudG9wICsgd2l0aGluLnNjcm9sbFRvcCxcblx0XHRcdFx0b3V0ZXJIZWlnaHQgPSB3aXRoaW4uaGVpZ2h0LFxuXHRcdFx0XHRvZmZzZXRUb3AgPSB3aXRoaW4uaXNXaW5kb3cgPyB3aXRoaW4uc2Nyb2xsVG9wIDogd2l0aGluLm9mZnNldC50b3AsXG5cdFx0XHRcdGNvbGxpc2lvblBvc1RvcCA9IHBvc2l0aW9uLnRvcCAtIGRhdGEuY29sbGlzaW9uUG9zaXRpb24ubWFyZ2luVG9wLFxuXHRcdFx0XHRvdmVyVG9wID0gY29sbGlzaW9uUG9zVG9wIC0gb2Zmc2V0VG9wLFxuXHRcdFx0XHRvdmVyQm90dG9tID0gY29sbGlzaW9uUG9zVG9wICsgZGF0YS5jb2xsaXNpb25IZWlnaHQgLSBvdXRlckhlaWdodCAtIG9mZnNldFRvcCxcblx0XHRcdFx0dG9wID0gZGF0YS5teVsgMSBdID09PSBcInRvcFwiLFxuXHRcdFx0XHRteU9mZnNldCA9IHRvcCA/XG5cdFx0XHRcdFx0LWRhdGEuZWxlbUhlaWdodCA6XG5cdFx0XHRcdFx0ZGF0YS5teVsgMSBdID09PSBcImJvdHRvbVwiID9cblx0XHRcdFx0XHRcdGRhdGEuZWxlbUhlaWdodCA6XG5cdFx0XHRcdFx0XHQwLFxuXHRcdFx0XHRhdE9mZnNldCA9IGRhdGEuYXRbIDEgXSA9PT0gXCJ0b3BcIiA/XG5cdFx0XHRcdFx0ZGF0YS50YXJnZXRIZWlnaHQgOlxuXHRcdFx0XHRcdGRhdGEuYXRbIDEgXSA9PT0gXCJib3R0b21cIiA/XG5cdFx0XHRcdFx0XHQtZGF0YS50YXJnZXRIZWlnaHQgOlxuXHRcdFx0XHRcdFx0MCxcblx0XHRcdFx0b2Zmc2V0ID0gLTIgKiBkYXRhLm9mZnNldFsgMSBdLFxuXHRcdFx0XHRuZXdPdmVyVG9wLFxuXHRcdFx0XHRuZXdPdmVyQm90dG9tO1xuXHRcdFx0aWYgKCBvdmVyVG9wIDwgMCApIHtcblx0XHRcdFx0bmV3T3ZlckJvdHRvbSA9IHBvc2l0aW9uLnRvcCArIG15T2Zmc2V0ICsgYXRPZmZzZXQgKyBvZmZzZXQgKyBkYXRhLmNvbGxpc2lvbkhlaWdodCAtXG5cdFx0XHRcdFx0b3V0ZXJIZWlnaHQgLSB3aXRoaW5PZmZzZXQ7XG5cdFx0XHRcdGlmICggbmV3T3ZlckJvdHRvbSA8IDAgfHwgbmV3T3ZlckJvdHRvbSA8IGFicyggb3ZlclRvcCApICkge1xuXHRcdFx0XHRcdHBvc2l0aW9uLnRvcCArPSBteU9mZnNldCArIGF0T2Zmc2V0ICsgb2Zmc2V0O1xuXHRcdFx0XHR9XG5cdFx0XHR9IGVsc2UgaWYgKCBvdmVyQm90dG9tID4gMCApIHtcblx0XHRcdFx0bmV3T3ZlclRvcCA9IHBvc2l0aW9uLnRvcCAtIGRhdGEuY29sbGlzaW9uUG9zaXRpb24ubWFyZ2luVG9wICsgbXlPZmZzZXQgKyBhdE9mZnNldCArXG5cdFx0XHRcdFx0b2Zmc2V0IC0gb2Zmc2V0VG9wO1xuXHRcdFx0XHRpZiAoIG5ld092ZXJUb3AgPiAwIHx8IGFicyggbmV3T3ZlclRvcCApIDwgb3ZlckJvdHRvbSApIHtcblx0XHRcdFx0XHRwb3NpdGlvbi50b3AgKz0gbXlPZmZzZXQgKyBhdE9mZnNldCArIG9mZnNldDtcblx0XHRcdFx0fVxuXHRcdFx0fVxuXHRcdH1cblx0fSxcblx0ZmxpcGZpdDoge1xuXHRcdGxlZnQ6IGZ1bmN0aW9uKCkge1xuXHRcdFx0JC51aS5wb3NpdGlvbi5mbGlwLmxlZnQuYXBwbHkoIHRoaXMsIGFyZ3VtZW50cyApO1xuXHRcdFx0JC51aS5wb3NpdGlvbi5maXQubGVmdC5hcHBseSggdGhpcywgYXJndW1lbnRzICk7XG5cdFx0fSxcblx0XHR0b3A6IGZ1bmN0aW9uKCkge1xuXHRcdFx0JC51aS5wb3NpdGlvbi5mbGlwLnRvcC5hcHBseSggdGhpcywgYXJndW1lbnRzICk7XG5cdFx0XHQkLnVpLnBvc2l0aW9uLmZpdC50b3AuYXBwbHkoIHRoaXMsIGFyZ3VtZW50cyApO1xuXHRcdH1cblx0fVxufTtcblxufSApKCk7XG5cbnJldHVybiAkLnVpLnBvc2l0aW9uO1xuXG59ICkgKTtcbiIsIiggZnVuY3Rpb24oIGZhY3RvcnkgKSB7XG5cdGlmICggdHlwZW9mIGRlZmluZSA9PT0gXCJmdW5jdGlvblwiICYmIGRlZmluZS5hbWQgKSB7XG5cblx0XHQvLyBBTUQuIFJlZ2lzdGVyIGFzIGFuIGFub255bW91cyBtb2R1bGUuXG5cdFx0ZGVmaW5lKCBbIFwianF1ZXJ5XCIsIFwiLi92ZXJzaW9uXCIgXSwgZmFjdG9yeSApO1xuXHR9IGVsc2Uge1xuXG5cdFx0Ly8gQnJvd3NlciBnbG9iYWxzXG5cdFx0ZmFjdG9yeSggalF1ZXJ5ICk7XG5cdH1cbn0gKCBmdW5jdGlvbiggJCApIHtcbnJldHVybiAkLnVpLnNhZmVBY3RpdmVFbGVtZW50ID0gZnVuY3Rpb24oIGRvY3VtZW50ICkge1xuXHR2YXIgYWN0aXZlRWxlbWVudDtcblxuXHQvLyBTdXBwb3J0OiBJRSA5IG9ubHlcblx0Ly8gSUU5IHRocm93cyBhbiBcIlVuc3BlY2lmaWVkIGVycm9yXCIgYWNjZXNzaW5nIGRvY3VtZW50LmFjdGl2ZUVsZW1lbnQgZnJvbSBhbiA8aWZyYW1lPlxuXHR0cnkge1xuXHRcdGFjdGl2ZUVsZW1lbnQgPSBkb2N1bWVudC5hY3RpdmVFbGVtZW50O1xuXHR9IGNhdGNoICggZXJyb3IgKSB7XG5cdFx0YWN0aXZlRWxlbWVudCA9IGRvY3VtZW50LmJvZHk7XG5cdH1cblxuXHQvLyBTdXBwb3J0OiBJRSA5IC0gMTEgb25seVxuXHQvLyBJRSBtYXkgcmV0dXJuIG51bGwgaW5zdGVhZCBvZiBhbiBlbGVtZW50XG5cdC8vIEludGVyZXN0aW5nbHksIHRoaXMgb25seSBzZWVtcyB0byBvY2N1ciB3aGVuIE5PVCBpbiBhbiBpZnJhbWVcblx0aWYgKCAhYWN0aXZlRWxlbWVudCApIHtcblx0XHRhY3RpdmVFbGVtZW50ID0gZG9jdW1lbnQuYm9keTtcblx0fVxuXG5cdC8vIFN1cHBvcnQ6IElFIDExIG9ubHlcblx0Ly8gSUUxMSByZXR1cm5zIGEgc2VlbWluZ2x5IGVtcHR5IG9iamVjdCBpbiBzb21lIGNhc2VzIHdoZW4gYWNjZXNzaW5nXG5cdC8vIGRvY3VtZW50LmFjdGl2ZUVsZW1lbnQgZnJvbSBhbiA8aWZyYW1lPlxuXHRpZiAoICFhY3RpdmVFbGVtZW50Lm5vZGVOYW1lICkge1xuXHRcdGFjdGl2ZUVsZW1lbnQgPSBkb2N1bWVudC5ib2R5O1xuXHR9XG5cblx0cmV0dXJuIGFjdGl2ZUVsZW1lbnQ7XG59O1xuXG59ICkgKTtcbiIsIiggZnVuY3Rpb24oIGZhY3RvcnkgKSB7XG5cdGlmICggdHlwZW9mIGRlZmluZSA9PT0gXCJmdW5jdGlvblwiICYmIGRlZmluZS5hbWQgKSB7XG5cblx0XHQvLyBBTUQuIFJlZ2lzdGVyIGFzIGFuIGFub255bW91cyBtb2R1bGUuXG5cdFx0ZGVmaW5lKCBbIFwianF1ZXJ5XCIsIFwiLi92ZXJzaW9uXCIgXSwgZmFjdG9yeSApO1xuXHR9IGVsc2Uge1xuXG5cdFx0Ly8gQnJvd3NlciBnbG9iYWxzXG5cdFx0ZmFjdG9yeSggalF1ZXJ5ICk7XG5cdH1cbn0gKCBmdW5jdGlvbiggJCApIHtcbnJldHVybiAkLnVpLnNhZmVCbHVyID0gZnVuY3Rpb24oIGVsZW1lbnQgKSB7XG5cblx0Ly8gU3VwcG9ydDogSUU5IC0gMTAgb25seVxuXHQvLyBJZiB0aGUgPGJvZHk+IGlzIGJsdXJyZWQsIElFIHdpbGwgc3dpdGNoIHdpbmRvd3MsIHNlZSAjOTQyMFxuXHRpZiAoIGVsZW1lbnQgJiYgZWxlbWVudC5ub2RlTmFtZS50b0xvd2VyQ2FzZSgpICE9PSBcImJvZHlcIiApIHtcblx0XHQkKCBlbGVtZW50ICkudHJpZ2dlciggXCJibHVyXCIgKTtcblx0fVxufTtcblxufSApICk7XG4iLCIvKiFcbiAqIGpRdWVyeSBVSSBTY3JvbGwgUGFyZW50IDEuMTIuMFxuICogaHR0cDovL2pxdWVyeXVpLmNvbVxuICpcbiAqIENvcHlyaWdodCBqUXVlcnkgRm91bmRhdGlvbiBhbmQgb3RoZXIgY29udHJpYnV0b3JzXG4gKiBSZWxlYXNlZCB1bmRlciB0aGUgTUlUIGxpY2Vuc2UuXG4gKiBodHRwOi8vanF1ZXJ5Lm9yZy9saWNlbnNlXG4gKi9cblxuLy8+PmxhYmVsOiBzY3JvbGxQYXJlbnRcbi8vPj5ncm91cDogQ29yZVxuLy8+PmRlc2NyaXB0aW9uOiBHZXQgdGhlIGNsb3Nlc3QgYW5jZXN0b3IgZWxlbWVudCB0aGF0IGlzIHNjcm9sbGFibGUuXG4vLz4+ZG9jczogaHR0cDovL2FwaS5qcXVlcnl1aS5jb20vc2Nyb2xsUGFyZW50L1xuXG4oIGZ1bmN0aW9uKCBmYWN0b3J5ICkge1xuXHRpZiAoIHR5cGVvZiBkZWZpbmUgPT09IFwiZnVuY3Rpb25cIiAmJiBkZWZpbmUuYW1kICkge1xuXG5cdFx0Ly8gQU1ELiBSZWdpc3RlciBhcyBhbiBhbm9ueW1vdXMgbW9kdWxlLlxuXHRcdGRlZmluZSggWyBcImpxdWVyeVwiLCBcIi4vdmVyc2lvblwiIF0sIGZhY3RvcnkgKTtcblx0fSBlbHNlIHtcblxuXHRcdC8vIEJyb3dzZXIgZ2xvYmFsc1xuXHRcdGZhY3RvcnkoIGpRdWVyeSApO1xuXHR9XG59ICggZnVuY3Rpb24oICQgKSB7XG5cbnJldHVybiAkLmZuLnNjcm9sbFBhcmVudCA9IGZ1bmN0aW9uKCBpbmNsdWRlSGlkZGVuICkge1xuXHR2YXIgcG9zaXRpb24gPSB0aGlzLmNzcyggXCJwb3NpdGlvblwiICksXG5cdFx0ZXhjbHVkZVN0YXRpY1BhcmVudCA9IHBvc2l0aW9uID09PSBcImFic29sdXRlXCIsXG5cdFx0b3ZlcmZsb3dSZWdleCA9IGluY2x1ZGVIaWRkZW4gPyAvKGF1dG98c2Nyb2xsfGhpZGRlbikvIDogLyhhdXRvfHNjcm9sbCkvLFxuXHRcdHNjcm9sbFBhcmVudCA9IHRoaXMucGFyZW50cygpLmZpbHRlciggZnVuY3Rpb24oKSB7XG5cdFx0XHR2YXIgcGFyZW50ID0gJCggdGhpcyApO1xuXHRcdFx0aWYgKCBleGNsdWRlU3RhdGljUGFyZW50ICYmIHBhcmVudC5jc3MoIFwicG9zaXRpb25cIiApID09PSBcInN0YXRpY1wiICkge1xuXHRcdFx0XHRyZXR1cm4gZmFsc2U7XG5cdFx0XHR9XG5cdFx0XHRyZXR1cm4gb3ZlcmZsb3dSZWdleC50ZXN0KCBwYXJlbnQuY3NzKCBcIm92ZXJmbG93XCIgKSArIHBhcmVudC5jc3MoIFwib3ZlcmZsb3cteVwiICkgK1xuXHRcdFx0XHRwYXJlbnQuY3NzKCBcIm92ZXJmbG93LXhcIiApICk7XG5cdFx0fSApLmVxKCAwICk7XG5cblx0cmV0dXJuIHBvc2l0aW9uID09PSBcImZpeGVkXCIgfHwgIXNjcm9sbFBhcmVudC5sZW5ndGggP1xuXHRcdCQoIHRoaXNbIDAgXS5vd25lckRvY3VtZW50IHx8IGRvY3VtZW50ICkgOlxuXHRcdHNjcm9sbFBhcmVudDtcbn07XG5cbn0gKSApO1xuIiwiLyohXG4gKiBqUXVlcnkgVUkgVGFiYmFibGUgMS4xMi4wXG4gKiBodHRwOi8vanF1ZXJ5dWkuY29tXG4gKlxuICogQ29weXJpZ2h0IGpRdWVyeSBGb3VuZGF0aW9uIGFuZCBvdGhlciBjb250cmlidXRvcnNcbiAqIFJlbGVhc2VkIHVuZGVyIHRoZSBNSVQgbGljZW5zZS5cbiAqIGh0dHA6Ly9qcXVlcnkub3JnL2xpY2Vuc2VcbiAqL1xuXG4vLz4+bGFiZWw6IDp0YWJiYWJsZSBTZWxlY3RvclxuLy8+Pmdyb3VwOiBDb3JlXG4vLz4+ZGVzY3JpcHRpb246IFNlbGVjdHMgZWxlbWVudHMgd2hpY2ggY2FuIGJlIHRhYmJlZCB0by5cbi8vPj5kb2NzOiBodHRwOi8vYXBpLmpxdWVyeXVpLmNvbS90YWJiYWJsZS1zZWxlY3Rvci9cblxuKCBmdW5jdGlvbiggZmFjdG9yeSApIHtcblx0aWYgKCB0eXBlb2YgZGVmaW5lID09PSBcImZ1bmN0aW9uXCIgJiYgZGVmaW5lLmFtZCApIHtcblxuXHRcdC8vIEFNRC4gUmVnaXN0ZXIgYXMgYW4gYW5vbnltb3VzIG1vZHVsZS5cblx0XHRkZWZpbmUoIFsgXCJqcXVlcnlcIiwgXCIuL3ZlcnNpb25cIiwgXCIuL2ZvY3VzYWJsZVwiIF0sIGZhY3RvcnkgKTtcblx0fSBlbHNlIHtcblxuXHRcdC8vIEJyb3dzZXIgZ2xvYmFsc1xuXHRcdGZhY3RvcnkoIGpRdWVyeSApO1xuXHR9XG59ICggZnVuY3Rpb24oICQgKSB7XG5cbnJldHVybiAkLmV4dGVuZCggJC5leHByWyBcIjpcIiBdLCB7XG5cdHRhYmJhYmxlOiBmdW5jdGlvbiggZWxlbWVudCApIHtcblx0XHR2YXIgdGFiSW5kZXggPSAkLmF0dHIoIGVsZW1lbnQsIFwidGFiaW5kZXhcIiApLFxuXHRcdFx0aGFzVGFiaW5kZXggPSB0YWJJbmRleCAhPSBudWxsO1xuXHRcdHJldHVybiAoICFoYXNUYWJpbmRleCB8fCB0YWJJbmRleCA+PSAwICkgJiYgJC51aS5mb2N1c2FibGUoIGVsZW1lbnQsIGhhc1RhYmluZGV4ICk7XG5cdH1cbn0gKTtcblxufSApICk7XG4iLCIvKiFcbiAqIGpRdWVyeSBVSSBVbmlxdWUgSUQgMS4xMi4wXG4gKiBodHRwOi8vanF1ZXJ5dWkuY29tXG4gKlxuICogQ29weXJpZ2h0IGpRdWVyeSBGb3VuZGF0aW9uIGFuZCBvdGhlciBjb250cmlidXRvcnNcbiAqIFJlbGVhc2VkIHVuZGVyIHRoZSBNSVQgbGljZW5zZS5cbiAqIGh0dHA6Ly9qcXVlcnkub3JnL2xpY2Vuc2VcbiAqL1xuXG4vLz4+bGFiZWw6IHVuaXF1ZUlkXG4vLz4+Z3JvdXA6IENvcmVcbi8vPj5kZXNjcmlwdGlvbjogRnVuY3Rpb25zIHRvIGdlbmVyYXRlIGFuZCByZW1vdmUgdW5pcXVlSWQnc1xuLy8+PmRvY3M6IGh0dHA6Ly9hcGkuanF1ZXJ5dWkuY29tL3VuaXF1ZUlkL1xuXG4oIGZ1bmN0aW9uKCBmYWN0b3J5ICkge1xuXHRpZiAoIHR5cGVvZiBkZWZpbmUgPT09IFwiZnVuY3Rpb25cIiAmJiBkZWZpbmUuYW1kICkge1xuXG5cdFx0Ly8gQU1ELiBSZWdpc3RlciBhcyBhbiBhbm9ueW1vdXMgbW9kdWxlLlxuXHRcdGRlZmluZSggWyBcImpxdWVyeVwiLCBcIi4vdmVyc2lvblwiIF0sIGZhY3RvcnkgKTtcblx0fSBlbHNlIHtcblxuXHRcdC8vIEJyb3dzZXIgZ2xvYmFsc1xuXHRcdGZhY3RvcnkoIGpRdWVyeSApO1xuXHR9XG59ICggZnVuY3Rpb24oICQgKSB7XG5cbnJldHVybiAkLmZuLmV4dGVuZCgge1xuXHR1bmlxdWVJZDogKCBmdW5jdGlvbigpIHtcblx0XHR2YXIgdXVpZCA9IDA7XG5cblx0XHRyZXR1cm4gZnVuY3Rpb24oKSB7XG5cdFx0XHRyZXR1cm4gdGhpcy5lYWNoKCBmdW5jdGlvbigpIHtcblx0XHRcdFx0aWYgKCAhdGhpcy5pZCApIHtcblx0XHRcdFx0XHR0aGlzLmlkID0gXCJ1aS1pZC1cIiArICggKyt1dWlkICk7XG5cdFx0XHRcdH1cblx0XHRcdH0gKTtcblx0XHR9O1xuXHR9ICkoKSxcblxuXHRyZW1vdmVVbmlxdWVJZDogZnVuY3Rpb24oKSB7XG5cdFx0cmV0dXJuIHRoaXMuZWFjaCggZnVuY3Rpb24oKSB7XG5cdFx0XHRpZiAoIC9edWktaWQtXFxkKyQvLnRlc3QoIHRoaXMuaWQgKSApIHtcblx0XHRcdFx0JCggdGhpcyApLnJlbW92ZUF0dHIoIFwiaWRcIiApO1xuXHRcdFx0fVxuXHRcdH0gKTtcblx0fVxufSApO1xuXG59ICkgKTtcbiIsIiggZnVuY3Rpb24oIGZhY3RvcnkgKSB7XG5cdGlmICggdHlwZW9mIGRlZmluZSA9PT0gXCJmdW5jdGlvblwiICYmIGRlZmluZS5hbWQgKSB7XG5cblx0XHQvLyBBTUQuIFJlZ2lzdGVyIGFzIGFuIGFub255bW91cyBtb2R1bGUuXG5cdFx0ZGVmaW5lKCBbIFwianF1ZXJ5XCIgXSwgZmFjdG9yeSApO1xuXHR9IGVsc2Uge1xuXG5cdFx0Ly8gQnJvd3NlciBnbG9iYWxzXG5cdFx0ZmFjdG9yeSggalF1ZXJ5ICk7XG5cdH1cbn0gKCBmdW5jdGlvbiggJCApIHtcblxuJC51aSA9ICQudWkgfHwge307XG5cbnJldHVybiAkLnVpLnZlcnNpb24gPSBcIjEuMTIuMFwiO1xuXG59ICkgKTtcbiIsIi8qIVxuICogalF1ZXJ5IFVJIFdpZGdldCAxLjEyLjBcbiAqIGh0dHA6Ly9qcXVlcnl1aS5jb21cbiAqXG4gKiBDb3B5cmlnaHQgalF1ZXJ5IEZvdW5kYXRpb24gYW5kIG90aGVyIGNvbnRyaWJ1dG9yc1xuICogUmVsZWFzZWQgdW5kZXIgdGhlIE1JVCBsaWNlbnNlLlxuICogaHR0cDovL2pxdWVyeS5vcmcvbGljZW5zZVxuICovXG5cbi8vPj5sYWJlbDogV2lkZ2V0XG4vLz4+Z3JvdXA6IENvcmVcbi8vPj5kZXNjcmlwdGlvbjogUHJvdmlkZXMgYSBmYWN0b3J5IGZvciBjcmVhdGluZyBzdGF0ZWZ1bCB3aWRnZXRzIHdpdGggYSBjb21tb24gQVBJLlxuLy8+PmRvY3M6IGh0dHA6Ly9hcGkuanF1ZXJ5dWkuY29tL2pRdWVyeS53aWRnZXQvXG4vLz4+ZGVtb3M6IGh0dHA6Ly9qcXVlcnl1aS5jb20vd2lkZ2V0L1xuXG4oIGZ1bmN0aW9uKCBmYWN0b3J5ICkge1xuXHRpZiAoIHR5cGVvZiBkZWZpbmUgPT09IFwiZnVuY3Rpb25cIiAmJiBkZWZpbmUuYW1kICkge1xuXG5cdFx0Ly8gQU1ELiBSZWdpc3RlciBhcyBhbiBhbm9ueW1vdXMgbW9kdWxlLlxuXHRcdGRlZmluZSggWyBcImpxdWVyeVwiLCBcIi4vdmVyc2lvblwiIF0sIGZhY3RvcnkgKTtcblx0fSBlbHNlIHtcblxuXHRcdC8vIEJyb3dzZXIgZ2xvYmFsc1xuXHRcdGZhY3RvcnkoIGpRdWVyeSApO1xuXHR9XG59KCBmdW5jdGlvbiggJCApIHtcblxudmFyIHdpZGdldFV1aWQgPSAwO1xudmFyIHdpZGdldFNsaWNlID0gQXJyYXkucHJvdG90eXBlLnNsaWNlO1xuXG4kLmNsZWFuRGF0YSA9ICggZnVuY3Rpb24oIG9yaWcgKSB7XG5cdHJldHVybiBmdW5jdGlvbiggZWxlbXMgKSB7XG5cdFx0dmFyIGV2ZW50cywgZWxlbSwgaTtcblx0XHRmb3IgKCBpID0gMDsgKCBlbGVtID0gZWxlbXNbIGkgXSApICE9IG51bGw7IGkrKyApIHtcblx0XHRcdHRyeSB7XG5cblx0XHRcdFx0Ly8gT25seSB0cmlnZ2VyIHJlbW92ZSB3aGVuIG5lY2Vzc2FyeSB0byBzYXZlIHRpbWVcblx0XHRcdFx0ZXZlbnRzID0gJC5fZGF0YSggZWxlbSwgXCJldmVudHNcIiApO1xuXHRcdFx0XHRpZiAoIGV2ZW50cyAmJiBldmVudHMucmVtb3ZlICkge1xuXHRcdFx0XHRcdCQoIGVsZW0gKS50cmlnZ2VySGFuZGxlciggXCJyZW1vdmVcIiApO1xuXHRcdFx0XHR9XG5cblx0XHRcdC8vIEh0dHA6Ly9idWdzLmpxdWVyeS5jb20vdGlja2V0LzgyMzVcblx0XHRcdH0gY2F0Y2ggKCBlICkge31cblx0XHR9XG5cdFx0b3JpZyggZWxlbXMgKTtcblx0fTtcbn0gKSggJC5jbGVhbkRhdGEgKTtcblxuJC53aWRnZXQgPSBmdW5jdGlvbiggbmFtZSwgYmFzZSwgcHJvdG90eXBlICkge1xuXHR2YXIgZXhpc3RpbmdDb25zdHJ1Y3RvciwgY29uc3RydWN0b3IsIGJhc2VQcm90b3R5cGU7XG5cblx0Ly8gUHJveGllZFByb3RvdHlwZSBhbGxvd3MgdGhlIHByb3ZpZGVkIHByb3RvdHlwZSB0byByZW1haW4gdW5tb2RpZmllZFxuXHQvLyBzbyB0aGF0IGl0IGNhbiBiZSB1c2VkIGFzIGEgbWl4aW4gZm9yIG11bHRpcGxlIHdpZGdldHMgKCM4ODc2KVxuXHR2YXIgcHJveGllZFByb3RvdHlwZSA9IHt9O1xuXG5cdHZhciBuYW1lc3BhY2UgPSBuYW1lLnNwbGl0KCBcIi5cIiApWyAwIF07XG5cdG5hbWUgPSBuYW1lLnNwbGl0KCBcIi5cIiApWyAxIF07XG5cdHZhciBmdWxsTmFtZSA9IG5hbWVzcGFjZSArIFwiLVwiICsgbmFtZTtcblxuXHRpZiAoICFwcm90b3R5cGUgKSB7XG5cdFx0cHJvdG90eXBlID0gYmFzZTtcblx0XHRiYXNlID0gJC5XaWRnZXQ7XG5cdH1cblxuXHRpZiAoICQuaXNBcnJheSggcHJvdG90eXBlICkgKSB7XG5cdFx0cHJvdG90eXBlID0gJC5leHRlbmQuYXBwbHkoIG51bGwsIFsge30gXS5jb25jYXQoIHByb3RvdHlwZSApICk7XG5cdH1cblxuXHQvLyBDcmVhdGUgc2VsZWN0b3IgZm9yIHBsdWdpblxuXHQkLmV4cHJbIFwiOlwiIF1bIGZ1bGxOYW1lLnRvTG93ZXJDYXNlKCkgXSA9IGZ1bmN0aW9uKCBlbGVtICkge1xuXHRcdHJldHVybiAhISQuZGF0YSggZWxlbSwgZnVsbE5hbWUgKTtcblx0fTtcblxuXHQkWyBuYW1lc3BhY2UgXSA9ICRbIG5hbWVzcGFjZSBdIHx8IHt9O1xuXHRleGlzdGluZ0NvbnN0cnVjdG9yID0gJFsgbmFtZXNwYWNlIF1bIG5hbWUgXTtcblx0Y29uc3RydWN0b3IgPSAkWyBuYW1lc3BhY2UgXVsgbmFtZSBdID0gZnVuY3Rpb24oIG9wdGlvbnMsIGVsZW1lbnQgKSB7XG5cblx0XHQvLyBBbGxvdyBpbnN0YW50aWF0aW9uIHdpdGhvdXQgXCJuZXdcIiBrZXl3b3JkXG5cdFx0aWYgKCAhdGhpcy5fY3JlYXRlV2lkZ2V0ICkge1xuXHRcdFx0cmV0dXJuIG5ldyBjb25zdHJ1Y3Rvciggb3B0aW9ucywgZWxlbWVudCApO1xuXHRcdH1cblxuXHRcdC8vIEFsbG93IGluc3RhbnRpYXRpb24gd2l0aG91dCBpbml0aWFsaXppbmcgZm9yIHNpbXBsZSBpbmhlcml0YW5jZVxuXHRcdC8vIG11c3QgdXNlIFwibmV3XCIga2V5d29yZCAodGhlIGNvZGUgYWJvdmUgYWx3YXlzIHBhc3NlcyBhcmdzKVxuXHRcdGlmICggYXJndW1lbnRzLmxlbmd0aCApIHtcblx0XHRcdHRoaXMuX2NyZWF0ZVdpZGdldCggb3B0aW9ucywgZWxlbWVudCApO1xuXHRcdH1cblx0fTtcblxuXHQvLyBFeHRlbmQgd2l0aCB0aGUgZXhpc3RpbmcgY29uc3RydWN0b3IgdG8gY2Fycnkgb3ZlciBhbnkgc3RhdGljIHByb3BlcnRpZXNcblx0JC5leHRlbmQoIGNvbnN0cnVjdG9yLCBleGlzdGluZ0NvbnN0cnVjdG9yLCB7XG5cdFx0dmVyc2lvbjogcHJvdG90eXBlLnZlcnNpb24sXG5cblx0XHQvLyBDb3B5IHRoZSBvYmplY3QgdXNlZCB0byBjcmVhdGUgdGhlIHByb3RvdHlwZSBpbiBjYXNlIHdlIG5lZWQgdG9cblx0XHQvLyByZWRlZmluZSB0aGUgd2lkZ2V0IGxhdGVyXG5cdFx0X3Byb3RvOiAkLmV4dGVuZCgge30sIHByb3RvdHlwZSApLFxuXG5cdFx0Ly8gVHJhY2sgd2lkZ2V0cyB0aGF0IGluaGVyaXQgZnJvbSB0aGlzIHdpZGdldCBpbiBjYXNlIHRoaXMgd2lkZ2V0IGlzXG5cdFx0Ly8gcmVkZWZpbmVkIGFmdGVyIGEgd2lkZ2V0IGluaGVyaXRzIGZyb20gaXRcblx0XHRfY2hpbGRDb25zdHJ1Y3RvcnM6IFtdXG5cdH0gKTtcblxuXHRiYXNlUHJvdG90eXBlID0gbmV3IGJhc2UoKTtcblxuXHQvLyBXZSBuZWVkIHRvIG1ha2UgdGhlIG9wdGlvbnMgaGFzaCBhIHByb3BlcnR5IGRpcmVjdGx5IG9uIHRoZSBuZXcgaW5zdGFuY2Vcblx0Ly8gb3RoZXJ3aXNlIHdlJ2xsIG1vZGlmeSB0aGUgb3B0aW9ucyBoYXNoIG9uIHRoZSBwcm90b3R5cGUgdGhhdCB3ZSdyZVxuXHQvLyBpbmhlcml0aW5nIGZyb21cblx0YmFzZVByb3RvdHlwZS5vcHRpb25zID0gJC53aWRnZXQuZXh0ZW5kKCB7fSwgYmFzZVByb3RvdHlwZS5vcHRpb25zICk7XG5cdCQuZWFjaCggcHJvdG90eXBlLCBmdW5jdGlvbiggcHJvcCwgdmFsdWUgKSB7XG5cdFx0aWYgKCAhJC5pc0Z1bmN0aW9uKCB2YWx1ZSApICkge1xuXHRcdFx0cHJveGllZFByb3RvdHlwZVsgcHJvcCBdID0gdmFsdWU7XG5cdFx0XHRyZXR1cm47XG5cdFx0fVxuXHRcdHByb3hpZWRQcm90b3R5cGVbIHByb3AgXSA9ICggZnVuY3Rpb24oKSB7XG5cdFx0XHRmdW5jdGlvbiBfc3VwZXIoKSB7XG5cdFx0XHRcdHJldHVybiBiYXNlLnByb3RvdHlwZVsgcHJvcCBdLmFwcGx5KCB0aGlzLCBhcmd1bWVudHMgKTtcblx0XHRcdH1cblxuXHRcdFx0ZnVuY3Rpb24gX3N1cGVyQXBwbHkoIGFyZ3MgKSB7XG5cdFx0XHRcdHJldHVybiBiYXNlLnByb3RvdHlwZVsgcHJvcCBdLmFwcGx5KCB0aGlzLCBhcmdzICk7XG5cdFx0XHR9XG5cblx0XHRcdHJldHVybiBmdW5jdGlvbigpIHtcblx0XHRcdFx0dmFyIF9fc3VwZXIgPSB0aGlzLl9zdXBlcjtcblx0XHRcdFx0dmFyIF9fc3VwZXJBcHBseSA9IHRoaXMuX3N1cGVyQXBwbHk7XG5cdFx0XHRcdHZhciByZXR1cm5WYWx1ZTtcblxuXHRcdFx0XHR0aGlzLl9zdXBlciA9IF9zdXBlcjtcblx0XHRcdFx0dGhpcy5fc3VwZXJBcHBseSA9IF9zdXBlckFwcGx5O1xuXG5cdFx0XHRcdHJldHVyblZhbHVlID0gdmFsdWUuYXBwbHkoIHRoaXMsIGFyZ3VtZW50cyApO1xuXG5cdFx0XHRcdHRoaXMuX3N1cGVyID0gX19zdXBlcjtcblx0XHRcdFx0dGhpcy5fc3VwZXJBcHBseSA9IF9fc3VwZXJBcHBseTtcblxuXHRcdFx0XHRyZXR1cm4gcmV0dXJuVmFsdWU7XG5cdFx0XHR9O1xuXHRcdH0gKSgpO1xuXHR9ICk7XG5cdGNvbnN0cnVjdG9yLnByb3RvdHlwZSA9ICQud2lkZ2V0LmV4dGVuZCggYmFzZVByb3RvdHlwZSwge1xuXG5cdFx0Ly8gVE9ETzogcmVtb3ZlIHN1cHBvcnQgZm9yIHdpZGdldEV2ZW50UHJlZml4XG5cdFx0Ly8gYWx3YXlzIHVzZSB0aGUgbmFtZSArIGEgY29sb24gYXMgdGhlIHByZWZpeCwgZS5nLiwgZHJhZ2dhYmxlOnN0YXJ0XG5cdFx0Ly8gZG9uJ3QgcHJlZml4IGZvciB3aWRnZXRzIHRoYXQgYXJlbid0IERPTS1iYXNlZFxuXHRcdHdpZGdldEV2ZW50UHJlZml4OiBleGlzdGluZ0NvbnN0cnVjdG9yID8gKCBiYXNlUHJvdG90eXBlLndpZGdldEV2ZW50UHJlZml4IHx8IG5hbWUgKSA6IG5hbWVcblx0fSwgcHJveGllZFByb3RvdHlwZSwge1xuXHRcdGNvbnN0cnVjdG9yOiBjb25zdHJ1Y3Rvcixcblx0XHRuYW1lc3BhY2U6IG5hbWVzcGFjZSxcblx0XHR3aWRnZXROYW1lOiBuYW1lLFxuXHRcdHdpZGdldEZ1bGxOYW1lOiBmdWxsTmFtZVxuXHR9ICk7XG5cblx0Ly8gSWYgdGhpcyB3aWRnZXQgaXMgYmVpbmcgcmVkZWZpbmVkIHRoZW4gd2UgbmVlZCB0byBmaW5kIGFsbCB3aWRnZXRzIHRoYXRcblx0Ly8gYXJlIGluaGVyaXRpbmcgZnJvbSBpdCBhbmQgcmVkZWZpbmUgYWxsIG9mIHRoZW0gc28gdGhhdCB0aGV5IGluaGVyaXQgZnJvbVxuXHQvLyB0aGUgbmV3IHZlcnNpb24gb2YgdGhpcyB3aWRnZXQuIFdlJ3JlIGVzc2VudGlhbGx5IHRyeWluZyB0byByZXBsYWNlIG9uZVxuXHQvLyBsZXZlbCBpbiB0aGUgcHJvdG90eXBlIGNoYWluLlxuXHRpZiAoIGV4aXN0aW5nQ29uc3RydWN0b3IgKSB7XG5cdFx0JC5lYWNoKCBleGlzdGluZ0NvbnN0cnVjdG9yLl9jaGlsZENvbnN0cnVjdG9ycywgZnVuY3Rpb24oIGksIGNoaWxkICkge1xuXHRcdFx0dmFyIGNoaWxkUHJvdG90eXBlID0gY2hpbGQucHJvdG90eXBlO1xuXG5cdFx0XHQvLyBSZWRlZmluZSB0aGUgY2hpbGQgd2lkZ2V0IHVzaW5nIHRoZSBzYW1lIHByb3RvdHlwZSB0aGF0IHdhc1xuXHRcdFx0Ly8gb3JpZ2luYWxseSB1c2VkLCBidXQgaW5oZXJpdCBmcm9tIHRoZSBuZXcgdmVyc2lvbiBvZiB0aGUgYmFzZVxuXHRcdFx0JC53aWRnZXQoIGNoaWxkUHJvdG90eXBlLm5hbWVzcGFjZSArIFwiLlwiICsgY2hpbGRQcm90b3R5cGUud2lkZ2V0TmFtZSwgY29uc3RydWN0b3IsXG5cdFx0XHRcdGNoaWxkLl9wcm90byApO1xuXHRcdH0gKTtcblxuXHRcdC8vIFJlbW92ZSB0aGUgbGlzdCBvZiBleGlzdGluZyBjaGlsZCBjb25zdHJ1Y3RvcnMgZnJvbSB0aGUgb2xkIGNvbnN0cnVjdG9yXG5cdFx0Ly8gc28gdGhlIG9sZCBjaGlsZCBjb25zdHJ1Y3RvcnMgY2FuIGJlIGdhcmJhZ2UgY29sbGVjdGVkXG5cdFx0ZGVsZXRlIGV4aXN0aW5nQ29uc3RydWN0b3IuX2NoaWxkQ29uc3RydWN0b3JzO1xuXHR9IGVsc2Uge1xuXHRcdGJhc2UuX2NoaWxkQ29uc3RydWN0b3JzLnB1c2goIGNvbnN0cnVjdG9yICk7XG5cdH1cblxuXHQkLndpZGdldC5icmlkZ2UoIG5hbWUsIGNvbnN0cnVjdG9yICk7XG5cblx0cmV0dXJuIGNvbnN0cnVjdG9yO1xufTtcblxuJC53aWRnZXQuZXh0ZW5kID0gZnVuY3Rpb24oIHRhcmdldCApIHtcblx0dmFyIGlucHV0ID0gd2lkZ2V0U2xpY2UuY2FsbCggYXJndW1lbnRzLCAxICk7XG5cdHZhciBpbnB1dEluZGV4ID0gMDtcblx0dmFyIGlucHV0TGVuZ3RoID0gaW5wdXQubGVuZ3RoO1xuXHR2YXIga2V5O1xuXHR2YXIgdmFsdWU7XG5cblx0Zm9yICggOyBpbnB1dEluZGV4IDwgaW5wdXRMZW5ndGg7IGlucHV0SW5kZXgrKyApIHtcblx0XHRmb3IgKCBrZXkgaW4gaW5wdXRbIGlucHV0SW5kZXggXSApIHtcblx0XHRcdHZhbHVlID0gaW5wdXRbIGlucHV0SW5kZXggXVsga2V5IF07XG5cdFx0XHRpZiAoIGlucHV0WyBpbnB1dEluZGV4IF0uaGFzT3duUHJvcGVydHkoIGtleSApICYmIHZhbHVlICE9PSB1bmRlZmluZWQgKSB7XG5cblx0XHRcdFx0Ly8gQ2xvbmUgb2JqZWN0c1xuXHRcdFx0XHRpZiAoICQuaXNQbGFpbk9iamVjdCggdmFsdWUgKSApIHtcblx0XHRcdFx0XHR0YXJnZXRbIGtleSBdID0gJC5pc1BsYWluT2JqZWN0KCB0YXJnZXRbIGtleSBdICkgP1xuXHRcdFx0XHRcdFx0JC53aWRnZXQuZXh0ZW5kKCB7fSwgdGFyZ2V0WyBrZXkgXSwgdmFsdWUgKSA6XG5cblx0XHRcdFx0XHRcdC8vIERvbid0IGV4dGVuZCBzdHJpbmdzLCBhcnJheXMsIGV0Yy4gd2l0aCBvYmplY3RzXG5cdFx0XHRcdFx0XHQkLndpZGdldC5leHRlbmQoIHt9LCB2YWx1ZSApO1xuXG5cdFx0XHRcdC8vIENvcHkgZXZlcnl0aGluZyBlbHNlIGJ5IHJlZmVyZW5jZVxuXHRcdFx0XHR9IGVsc2Uge1xuXHRcdFx0XHRcdHRhcmdldFsga2V5IF0gPSB2YWx1ZTtcblx0XHRcdFx0fVxuXHRcdFx0fVxuXHRcdH1cblx0fVxuXHRyZXR1cm4gdGFyZ2V0O1xufTtcblxuJC53aWRnZXQuYnJpZGdlID0gZnVuY3Rpb24oIG5hbWUsIG9iamVjdCApIHtcblx0dmFyIGZ1bGxOYW1lID0gb2JqZWN0LnByb3RvdHlwZS53aWRnZXRGdWxsTmFtZSB8fCBuYW1lO1xuXHQkLmZuWyBuYW1lIF0gPSBmdW5jdGlvbiggb3B0aW9ucyApIHtcblx0XHR2YXIgaXNNZXRob2RDYWxsID0gdHlwZW9mIG9wdGlvbnMgPT09IFwic3RyaW5nXCI7XG5cdFx0dmFyIGFyZ3MgPSB3aWRnZXRTbGljZS5jYWxsKCBhcmd1bWVudHMsIDEgKTtcblx0XHR2YXIgcmV0dXJuVmFsdWUgPSB0aGlzO1xuXG5cdFx0aWYgKCBpc01ldGhvZENhbGwgKSB7XG5cdFx0XHR0aGlzLmVhY2goIGZ1bmN0aW9uKCkge1xuXHRcdFx0XHR2YXIgbWV0aG9kVmFsdWU7XG5cdFx0XHRcdHZhciBpbnN0YW5jZSA9ICQuZGF0YSggdGhpcywgZnVsbE5hbWUgKTtcblxuXHRcdFx0XHRpZiAoIG9wdGlvbnMgPT09IFwiaW5zdGFuY2VcIiApIHtcblx0XHRcdFx0XHRyZXR1cm5WYWx1ZSA9IGluc3RhbmNlO1xuXHRcdFx0XHRcdHJldHVybiBmYWxzZTtcblx0XHRcdFx0fVxuXG5cdFx0XHRcdGlmICggIWluc3RhbmNlICkge1xuXHRcdFx0XHRcdHJldHVybiAkLmVycm9yKCBcImNhbm5vdCBjYWxsIG1ldGhvZHMgb24gXCIgKyBuYW1lICtcblx0XHRcdFx0XHRcdFwiIHByaW9yIHRvIGluaXRpYWxpemF0aW9uOyBcIiArXG5cdFx0XHRcdFx0XHRcImF0dGVtcHRlZCB0byBjYWxsIG1ldGhvZCAnXCIgKyBvcHRpb25zICsgXCInXCIgKTtcblx0XHRcdFx0fVxuXG5cdFx0XHRcdGlmICggISQuaXNGdW5jdGlvbiggaW5zdGFuY2VbIG9wdGlvbnMgXSApIHx8IG9wdGlvbnMuY2hhckF0KCAwICkgPT09IFwiX1wiICkge1xuXHRcdFx0XHRcdHJldHVybiAkLmVycm9yKCBcIm5vIHN1Y2ggbWV0aG9kICdcIiArIG9wdGlvbnMgKyBcIicgZm9yIFwiICsgbmFtZSArXG5cdFx0XHRcdFx0XHRcIiB3aWRnZXQgaW5zdGFuY2VcIiApO1xuXHRcdFx0XHR9XG5cblx0XHRcdFx0bWV0aG9kVmFsdWUgPSBpbnN0YW5jZVsgb3B0aW9ucyBdLmFwcGx5KCBpbnN0YW5jZSwgYXJncyApO1xuXG5cdFx0XHRcdGlmICggbWV0aG9kVmFsdWUgIT09IGluc3RhbmNlICYmIG1ldGhvZFZhbHVlICE9PSB1bmRlZmluZWQgKSB7XG5cdFx0XHRcdFx0cmV0dXJuVmFsdWUgPSBtZXRob2RWYWx1ZSAmJiBtZXRob2RWYWx1ZS5qcXVlcnkgP1xuXHRcdFx0XHRcdFx0cmV0dXJuVmFsdWUucHVzaFN0YWNrKCBtZXRob2RWYWx1ZS5nZXQoKSApIDpcblx0XHRcdFx0XHRcdG1ldGhvZFZhbHVlO1xuXHRcdFx0XHRcdHJldHVybiBmYWxzZTtcblx0XHRcdFx0fVxuXHRcdFx0fSApO1xuXHRcdH0gZWxzZSB7XG5cblx0XHRcdC8vIEFsbG93IG11bHRpcGxlIGhhc2hlcyB0byBiZSBwYXNzZWQgb24gaW5pdFxuXHRcdFx0aWYgKCBhcmdzLmxlbmd0aCApIHtcblx0XHRcdFx0b3B0aW9ucyA9ICQud2lkZ2V0LmV4dGVuZC5hcHBseSggbnVsbCwgWyBvcHRpb25zIF0uY29uY2F0KCBhcmdzICkgKTtcblx0XHRcdH1cblxuXHRcdFx0dGhpcy5lYWNoKCBmdW5jdGlvbigpIHtcblx0XHRcdFx0dmFyIGluc3RhbmNlID0gJC5kYXRhKCB0aGlzLCBmdWxsTmFtZSApO1xuXHRcdFx0XHRpZiAoIGluc3RhbmNlICkge1xuXHRcdFx0XHRcdGluc3RhbmNlLm9wdGlvbiggb3B0aW9ucyB8fCB7fSApO1xuXHRcdFx0XHRcdGlmICggaW5zdGFuY2UuX2luaXQgKSB7XG5cdFx0XHRcdFx0XHRpbnN0YW5jZS5faW5pdCgpO1xuXHRcdFx0XHRcdH1cblx0XHRcdFx0fSBlbHNlIHtcblx0XHRcdFx0XHQkLmRhdGEoIHRoaXMsIGZ1bGxOYW1lLCBuZXcgb2JqZWN0KCBvcHRpb25zLCB0aGlzICkgKTtcblx0XHRcdFx0fVxuXHRcdFx0fSApO1xuXHRcdH1cblxuXHRcdHJldHVybiByZXR1cm5WYWx1ZTtcblx0fTtcbn07XG5cbiQuV2lkZ2V0ID0gZnVuY3Rpb24oIC8qIG9wdGlvbnMsIGVsZW1lbnQgKi8gKSB7fTtcbiQuV2lkZ2V0Ll9jaGlsZENvbnN0cnVjdG9ycyA9IFtdO1xuXG4kLldpZGdldC5wcm90b3R5cGUgPSB7XG5cdHdpZGdldE5hbWU6IFwid2lkZ2V0XCIsXG5cdHdpZGdldEV2ZW50UHJlZml4OiBcIlwiLFxuXHRkZWZhdWx0RWxlbWVudDogXCI8ZGl2PlwiLFxuXG5cdG9wdGlvbnM6IHtcblx0XHRjbGFzc2VzOiB7fSxcblx0XHRkaXNhYmxlZDogZmFsc2UsXG5cblx0XHQvLyBDYWxsYmFja3Ncblx0XHRjcmVhdGU6IG51bGxcblx0fSxcblxuXHRfY3JlYXRlV2lkZ2V0OiBmdW5jdGlvbiggb3B0aW9ucywgZWxlbWVudCApIHtcblx0XHRlbGVtZW50ID0gJCggZWxlbWVudCB8fCB0aGlzLmRlZmF1bHRFbGVtZW50IHx8IHRoaXMgKVsgMCBdO1xuXHRcdHRoaXMuZWxlbWVudCA9ICQoIGVsZW1lbnQgKTtcblx0XHR0aGlzLnV1aWQgPSB3aWRnZXRVdWlkKys7XG5cdFx0dGhpcy5ldmVudE5hbWVzcGFjZSA9IFwiLlwiICsgdGhpcy53aWRnZXROYW1lICsgdGhpcy51dWlkO1xuXG5cdFx0dGhpcy5iaW5kaW5ncyA9ICQoKTtcblx0XHR0aGlzLmhvdmVyYWJsZSA9ICQoKTtcblx0XHR0aGlzLmZvY3VzYWJsZSA9ICQoKTtcblx0XHR0aGlzLmNsYXNzZXNFbGVtZW50TG9va3VwID0ge307XG5cblx0XHRpZiAoIGVsZW1lbnQgIT09IHRoaXMgKSB7XG5cdFx0XHQkLmRhdGEoIGVsZW1lbnQsIHRoaXMud2lkZ2V0RnVsbE5hbWUsIHRoaXMgKTtcblx0XHRcdHRoaXMuX29uKCB0cnVlLCB0aGlzLmVsZW1lbnQsIHtcblx0XHRcdFx0cmVtb3ZlOiBmdW5jdGlvbiggZXZlbnQgKSB7XG5cdFx0XHRcdFx0aWYgKCBldmVudC50YXJnZXQgPT09IGVsZW1lbnQgKSB7XG5cdFx0XHRcdFx0XHR0aGlzLmRlc3Ryb3koKTtcblx0XHRcdFx0XHR9XG5cdFx0XHRcdH1cblx0XHRcdH0gKTtcblx0XHRcdHRoaXMuZG9jdW1lbnQgPSAkKCBlbGVtZW50LnN0eWxlID9cblxuXHRcdFx0XHQvLyBFbGVtZW50IHdpdGhpbiB0aGUgZG9jdW1lbnRcblx0XHRcdFx0ZWxlbWVudC5vd25lckRvY3VtZW50IDpcblxuXHRcdFx0XHQvLyBFbGVtZW50IGlzIHdpbmRvdyBvciBkb2N1bWVudFxuXHRcdFx0XHRlbGVtZW50LmRvY3VtZW50IHx8IGVsZW1lbnQgKTtcblx0XHRcdHRoaXMud2luZG93ID0gJCggdGhpcy5kb2N1bWVudFsgMCBdLmRlZmF1bHRWaWV3IHx8IHRoaXMuZG9jdW1lbnRbIDAgXS5wYXJlbnRXaW5kb3cgKTtcblx0XHR9XG5cblx0XHR0aGlzLm9wdGlvbnMgPSAkLndpZGdldC5leHRlbmQoIHt9LFxuXHRcdFx0dGhpcy5vcHRpb25zLFxuXHRcdFx0dGhpcy5fZ2V0Q3JlYXRlT3B0aW9ucygpLFxuXHRcdFx0b3B0aW9ucyApO1xuXG5cdFx0dGhpcy5fY3JlYXRlKCk7XG5cblx0XHRpZiAoIHRoaXMub3B0aW9ucy5kaXNhYmxlZCApIHtcblx0XHRcdHRoaXMuX3NldE9wdGlvbkRpc2FibGVkKCB0aGlzLm9wdGlvbnMuZGlzYWJsZWQgKTtcblx0XHR9XG5cblx0XHR0aGlzLl90cmlnZ2VyKCBcImNyZWF0ZVwiLCBudWxsLCB0aGlzLl9nZXRDcmVhdGVFdmVudERhdGEoKSApO1xuXHRcdHRoaXMuX2luaXQoKTtcblx0fSxcblxuXHRfZ2V0Q3JlYXRlT3B0aW9uczogZnVuY3Rpb24oKSB7XG5cdFx0cmV0dXJuIHt9O1xuXHR9LFxuXG5cdF9nZXRDcmVhdGVFdmVudERhdGE6ICQubm9vcCxcblxuXHRfY3JlYXRlOiAkLm5vb3AsXG5cblx0X2luaXQ6ICQubm9vcCxcblxuXHRkZXN0cm95OiBmdW5jdGlvbigpIHtcblx0XHR2YXIgdGhhdCA9IHRoaXM7XG5cblx0XHR0aGlzLl9kZXN0cm95KCk7XG5cdFx0JC5lYWNoKCB0aGlzLmNsYXNzZXNFbGVtZW50TG9va3VwLCBmdW5jdGlvbigga2V5LCB2YWx1ZSApIHtcblx0XHRcdHRoYXQuX3JlbW92ZUNsYXNzKCB2YWx1ZSwga2V5ICk7XG5cdFx0fSApO1xuXG5cdFx0Ly8gV2UgY2FuIHByb2JhYmx5IHJlbW92ZSB0aGUgdW5iaW5kIGNhbGxzIGluIDIuMFxuXHRcdC8vIGFsbCBldmVudCBiaW5kaW5ncyBzaG91bGQgZ28gdGhyb3VnaCB0aGlzLl9vbigpXG5cdFx0dGhpcy5lbGVtZW50XG5cdFx0XHQub2ZmKCB0aGlzLmV2ZW50TmFtZXNwYWNlIClcblx0XHRcdC5yZW1vdmVEYXRhKCB0aGlzLndpZGdldEZ1bGxOYW1lICk7XG5cdFx0dGhpcy53aWRnZXQoKVxuXHRcdFx0Lm9mZiggdGhpcy5ldmVudE5hbWVzcGFjZSApXG5cdFx0XHQucmVtb3ZlQXR0ciggXCJhcmlhLWRpc2FibGVkXCIgKTtcblxuXHRcdC8vIENsZWFuIHVwIGV2ZW50cyBhbmQgc3RhdGVzXG5cdFx0dGhpcy5iaW5kaW5ncy5vZmYoIHRoaXMuZXZlbnROYW1lc3BhY2UgKTtcblx0fSxcblxuXHRfZGVzdHJveTogJC5ub29wLFxuXG5cdHdpZGdldDogZnVuY3Rpb24oKSB7XG5cdFx0cmV0dXJuIHRoaXMuZWxlbWVudDtcblx0fSxcblxuXHRvcHRpb246IGZ1bmN0aW9uKCBrZXksIHZhbHVlICkge1xuXHRcdHZhciBvcHRpb25zID0ga2V5O1xuXHRcdHZhciBwYXJ0cztcblx0XHR2YXIgY3VyT3B0aW9uO1xuXHRcdHZhciBpO1xuXG5cdFx0aWYgKCBhcmd1bWVudHMubGVuZ3RoID09PSAwICkge1xuXG5cdFx0XHQvLyBEb24ndCByZXR1cm4gYSByZWZlcmVuY2UgdG8gdGhlIGludGVybmFsIGhhc2hcblx0XHRcdHJldHVybiAkLndpZGdldC5leHRlbmQoIHt9LCB0aGlzLm9wdGlvbnMgKTtcblx0XHR9XG5cblx0XHRpZiAoIHR5cGVvZiBrZXkgPT09IFwic3RyaW5nXCIgKSB7XG5cblx0XHRcdC8vIEhhbmRsZSBuZXN0ZWQga2V5cywgZS5nLiwgXCJmb28uYmFyXCIgPT4geyBmb286IHsgYmFyOiBfX18gfSB9XG5cdFx0XHRvcHRpb25zID0ge307XG5cdFx0XHRwYXJ0cyA9IGtleS5zcGxpdCggXCIuXCIgKTtcblx0XHRcdGtleSA9IHBhcnRzLnNoaWZ0KCk7XG5cdFx0XHRpZiAoIHBhcnRzLmxlbmd0aCApIHtcblx0XHRcdFx0Y3VyT3B0aW9uID0gb3B0aW9uc1sga2V5IF0gPSAkLndpZGdldC5leHRlbmQoIHt9LCB0aGlzLm9wdGlvbnNbIGtleSBdICk7XG5cdFx0XHRcdGZvciAoIGkgPSAwOyBpIDwgcGFydHMubGVuZ3RoIC0gMTsgaSsrICkge1xuXHRcdFx0XHRcdGN1ck9wdGlvblsgcGFydHNbIGkgXSBdID0gY3VyT3B0aW9uWyBwYXJ0c1sgaSBdIF0gfHwge307XG5cdFx0XHRcdFx0Y3VyT3B0aW9uID0gY3VyT3B0aW9uWyBwYXJ0c1sgaSBdIF07XG5cdFx0XHRcdH1cblx0XHRcdFx0a2V5ID0gcGFydHMucG9wKCk7XG5cdFx0XHRcdGlmICggYXJndW1lbnRzLmxlbmd0aCA9PT0gMSApIHtcblx0XHRcdFx0XHRyZXR1cm4gY3VyT3B0aW9uWyBrZXkgXSA9PT0gdW5kZWZpbmVkID8gbnVsbCA6IGN1ck9wdGlvblsga2V5IF07XG5cdFx0XHRcdH1cblx0XHRcdFx0Y3VyT3B0aW9uWyBrZXkgXSA9IHZhbHVlO1xuXHRcdFx0fSBlbHNlIHtcblx0XHRcdFx0aWYgKCBhcmd1bWVudHMubGVuZ3RoID09PSAxICkge1xuXHRcdFx0XHRcdHJldHVybiB0aGlzLm9wdGlvbnNbIGtleSBdID09PSB1bmRlZmluZWQgPyBudWxsIDogdGhpcy5vcHRpb25zWyBrZXkgXTtcblx0XHRcdFx0fVxuXHRcdFx0XHRvcHRpb25zWyBrZXkgXSA9IHZhbHVlO1xuXHRcdFx0fVxuXHRcdH1cblxuXHRcdHRoaXMuX3NldE9wdGlvbnMoIG9wdGlvbnMgKTtcblxuXHRcdHJldHVybiB0aGlzO1xuXHR9LFxuXG5cdF9zZXRPcHRpb25zOiBmdW5jdGlvbiggb3B0aW9ucyApIHtcblx0XHR2YXIga2V5O1xuXG5cdFx0Zm9yICgga2V5IGluIG9wdGlvbnMgKSB7XG5cdFx0XHR0aGlzLl9zZXRPcHRpb24oIGtleSwgb3B0aW9uc1sga2V5IF0gKTtcblx0XHR9XG5cblx0XHRyZXR1cm4gdGhpcztcblx0fSxcblxuXHRfc2V0T3B0aW9uOiBmdW5jdGlvbigga2V5LCB2YWx1ZSApIHtcblx0XHRpZiAoIGtleSA9PT0gXCJjbGFzc2VzXCIgKSB7XG5cdFx0XHR0aGlzLl9zZXRPcHRpb25DbGFzc2VzKCB2YWx1ZSApO1xuXHRcdH1cblxuXHRcdHRoaXMub3B0aW9uc1sga2V5IF0gPSB2YWx1ZTtcblxuXHRcdGlmICgga2V5ID09PSBcImRpc2FibGVkXCIgKSB7XG5cdFx0XHR0aGlzLl9zZXRPcHRpb25EaXNhYmxlZCggdmFsdWUgKTtcblx0XHR9XG5cblx0XHRyZXR1cm4gdGhpcztcblx0fSxcblxuXHRfc2V0T3B0aW9uQ2xhc3NlczogZnVuY3Rpb24oIHZhbHVlICkge1xuXHRcdHZhciBjbGFzc0tleSwgZWxlbWVudHMsIGN1cnJlbnRFbGVtZW50cztcblxuXHRcdGZvciAoIGNsYXNzS2V5IGluIHZhbHVlICkge1xuXHRcdFx0Y3VycmVudEVsZW1lbnRzID0gdGhpcy5jbGFzc2VzRWxlbWVudExvb2t1cFsgY2xhc3NLZXkgXTtcblx0XHRcdGlmICggdmFsdWVbIGNsYXNzS2V5IF0gPT09IHRoaXMub3B0aW9ucy5jbGFzc2VzWyBjbGFzc0tleSBdIHx8XG5cdFx0XHRcdFx0IWN1cnJlbnRFbGVtZW50cyB8fFxuXHRcdFx0XHRcdCFjdXJyZW50RWxlbWVudHMubGVuZ3RoICkge1xuXHRcdFx0XHRjb250aW51ZTtcblx0XHRcdH1cblxuXHRcdFx0Ly8gV2UgYXJlIGRvaW5nIHRoaXMgdG8gY3JlYXRlIGEgbmV3IGpRdWVyeSBvYmplY3QgYmVjYXVzZSB0aGUgX3JlbW92ZUNsYXNzKCkgY2FsbFxuXHRcdFx0Ly8gb24gdGhlIG5leHQgbGluZSBpcyBnb2luZyB0byBkZXN0cm95IHRoZSByZWZlcmVuY2UgdG8gdGhlIGN1cnJlbnQgZWxlbWVudHMgYmVpbmdcblx0XHRcdC8vIHRyYWNrZWQuIFdlIG5lZWQgdG8gc2F2ZSBhIGNvcHkgb2YgdGhpcyBjb2xsZWN0aW9uIHNvIHRoYXQgd2UgY2FuIGFkZCB0aGUgbmV3IGNsYXNzZXNcblx0XHRcdC8vIGJlbG93LlxuXHRcdFx0ZWxlbWVudHMgPSAkKCBjdXJyZW50RWxlbWVudHMuZ2V0KCkgKTtcblx0XHRcdHRoaXMuX3JlbW92ZUNsYXNzKCBjdXJyZW50RWxlbWVudHMsIGNsYXNzS2V5ICk7XG5cblx0XHRcdC8vIFdlIGRvbid0IHVzZSBfYWRkQ2xhc3MoKSBoZXJlLCBiZWNhdXNlIHRoYXQgdXNlcyB0aGlzLm9wdGlvbnMuY2xhc3Nlc1xuXHRcdFx0Ly8gZm9yIGdlbmVyYXRpbmcgdGhlIHN0cmluZyBvZiBjbGFzc2VzLiBXZSB3YW50IHRvIHVzZSB0aGUgdmFsdWUgcGFzc2VkIGluIGZyb21cblx0XHRcdC8vIF9zZXRPcHRpb24oKSwgdGhpcyBpcyB0aGUgbmV3IHZhbHVlIG9mIHRoZSBjbGFzc2VzIG9wdGlvbiB3aGljaCB3YXMgcGFzc2VkIHRvXG5cdFx0XHQvLyBfc2V0T3B0aW9uKCkuIFdlIHBhc3MgdGhpcyB2YWx1ZSBkaXJlY3RseSB0byBfY2xhc3NlcygpLlxuXHRcdFx0ZWxlbWVudHMuYWRkQ2xhc3MoIHRoaXMuX2NsYXNzZXMoIHtcblx0XHRcdFx0ZWxlbWVudDogZWxlbWVudHMsXG5cdFx0XHRcdGtleXM6IGNsYXNzS2V5LFxuXHRcdFx0XHRjbGFzc2VzOiB2YWx1ZSxcblx0XHRcdFx0YWRkOiB0cnVlXG5cdFx0XHR9ICkgKTtcblx0XHR9XG5cdH0sXG5cblx0X3NldE9wdGlvbkRpc2FibGVkOiBmdW5jdGlvbiggdmFsdWUgKSB7XG5cdFx0dGhpcy5fdG9nZ2xlQ2xhc3MoIHRoaXMud2lkZ2V0KCksIHRoaXMud2lkZ2V0RnVsbE5hbWUgKyBcIi1kaXNhYmxlZFwiLCBudWxsLCAhIXZhbHVlICk7XG5cblx0XHQvLyBJZiB0aGUgd2lkZ2V0IGlzIGJlY29taW5nIGRpc2FibGVkLCB0aGVuIG5vdGhpbmcgaXMgaW50ZXJhY3RpdmVcblx0XHRpZiAoIHZhbHVlICkge1xuXHRcdFx0dGhpcy5fcmVtb3ZlQ2xhc3MoIHRoaXMuaG92ZXJhYmxlLCBudWxsLCBcInVpLXN0YXRlLWhvdmVyXCIgKTtcblx0XHRcdHRoaXMuX3JlbW92ZUNsYXNzKCB0aGlzLmZvY3VzYWJsZSwgbnVsbCwgXCJ1aS1zdGF0ZS1mb2N1c1wiICk7XG5cdFx0fVxuXHR9LFxuXG5cdGVuYWJsZTogZnVuY3Rpb24oKSB7XG5cdFx0cmV0dXJuIHRoaXMuX3NldE9wdGlvbnMoIHsgZGlzYWJsZWQ6IGZhbHNlIH0gKTtcblx0fSxcblxuXHRkaXNhYmxlOiBmdW5jdGlvbigpIHtcblx0XHRyZXR1cm4gdGhpcy5fc2V0T3B0aW9ucyggeyBkaXNhYmxlZDogdHJ1ZSB9ICk7XG5cdH0sXG5cblx0X2NsYXNzZXM6IGZ1bmN0aW9uKCBvcHRpb25zICkge1xuXHRcdHZhciBmdWxsID0gW107XG5cdFx0dmFyIHRoYXQgPSB0aGlzO1xuXG5cdFx0b3B0aW9ucyA9ICQuZXh0ZW5kKCB7XG5cdFx0XHRlbGVtZW50OiB0aGlzLmVsZW1lbnQsXG5cdFx0XHRjbGFzc2VzOiB0aGlzLm9wdGlvbnMuY2xhc3NlcyB8fCB7fVxuXHRcdH0sIG9wdGlvbnMgKTtcblxuXHRcdGZ1bmN0aW9uIHByb2Nlc3NDbGFzc1N0cmluZyggY2xhc3NlcywgY2hlY2tPcHRpb24gKSB7XG5cdFx0XHR2YXIgY3VycmVudCwgaTtcblx0XHRcdGZvciAoIGkgPSAwOyBpIDwgY2xhc3Nlcy5sZW5ndGg7IGkrKyApIHtcblx0XHRcdFx0Y3VycmVudCA9IHRoYXQuY2xhc3Nlc0VsZW1lbnRMb29rdXBbIGNsYXNzZXNbIGkgXSBdIHx8ICQoKTtcblx0XHRcdFx0aWYgKCBvcHRpb25zLmFkZCApIHtcblx0XHRcdFx0XHRjdXJyZW50ID0gJCggJC51bmlxdWUoIGN1cnJlbnQuZ2V0KCkuY29uY2F0KCBvcHRpb25zLmVsZW1lbnQuZ2V0KCkgKSApICk7XG5cdFx0XHRcdH0gZWxzZSB7XG5cdFx0XHRcdFx0Y3VycmVudCA9ICQoIGN1cnJlbnQubm90KCBvcHRpb25zLmVsZW1lbnQgKS5nZXQoKSApO1xuXHRcdFx0XHR9XG5cdFx0XHRcdHRoYXQuY2xhc3Nlc0VsZW1lbnRMb29rdXBbIGNsYXNzZXNbIGkgXSBdID0gY3VycmVudDtcblx0XHRcdFx0ZnVsbC5wdXNoKCBjbGFzc2VzWyBpIF0gKTtcblx0XHRcdFx0aWYgKCBjaGVja09wdGlvbiAmJiBvcHRpb25zLmNsYXNzZXNbIGNsYXNzZXNbIGkgXSBdICkge1xuXHRcdFx0XHRcdGZ1bGwucHVzaCggb3B0aW9ucy5jbGFzc2VzWyBjbGFzc2VzWyBpIF0gXSApO1xuXHRcdFx0XHR9XG5cdFx0XHR9XG5cdFx0fVxuXG5cdFx0aWYgKCBvcHRpb25zLmtleXMgKSB7XG5cdFx0XHRwcm9jZXNzQ2xhc3NTdHJpbmcoIG9wdGlvbnMua2V5cy5tYXRjaCggL1xcUysvZyApIHx8IFtdLCB0cnVlICk7XG5cdFx0fVxuXHRcdGlmICggb3B0aW9ucy5leHRyYSApIHtcblx0XHRcdHByb2Nlc3NDbGFzc1N0cmluZyggb3B0aW9ucy5leHRyYS5tYXRjaCggL1xcUysvZyApIHx8IFtdICk7XG5cdFx0fVxuXG5cdFx0cmV0dXJuIGZ1bGwuam9pbiggXCIgXCIgKTtcblx0fSxcblxuXHRfcmVtb3ZlQ2xhc3M6IGZ1bmN0aW9uKCBlbGVtZW50LCBrZXlzLCBleHRyYSApIHtcblx0XHRyZXR1cm4gdGhpcy5fdG9nZ2xlQ2xhc3MoIGVsZW1lbnQsIGtleXMsIGV4dHJhLCBmYWxzZSApO1xuXHR9LFxuXG5cdF9hZGRDbGFzczogZnVuY3Rpb24oIGVsZW1lbnQsIGtleXMsIGV4dHJhICkge1xuXHRcdHJldHVybiB0aGlzLl90b2dnbGVDbGFzcyggZWxlbWVudCwga2V5cywgZXh0cmEsIHRydWUgKTtcblx0fSxcblxuXHRfdG9nZ2xlQ2xhc3M6IGZ1bmN0aW9uKCBlbGVtZW50LCBrZXlzLCBleHRyYSwgYWRkICkge1xuXHRcdGFkZCA9ICggdHlwZW9mIGFkZCA9PT0gXCJib29sZWFuXCIgKSA/IGFkZCA6IGV4dHJhO1xuXHRcdHZhciBzaGlmdCA9ICggdHlwZW9mIGVsZW1lbnQgPT09IFwic3RyaW5nXCIgfHwgZWxlbWVudCA9PT0gbnVsbCApLFxuXHRcdFx0b3B0aW9ucyA9IHtcblx0XHRcdFx0ZXh0cmE6IHNoaWZ0ID8ga2V5cyA6IGV4dHJhLFxuXHRcdFx0XHRrZXlzOiBzaGlmdCA/IGVsZW1lbnQgOiBrZXlzLFxuXHRcdFx0XHRlbGVtZW50OiBzaGlmdCA/IHRoaXMuZWxlbWVudCA6IGVsZW1lbnQsXG5cdFx0XHRcdGFkZDogYWRkXG5cdFx0XHR9O1xuXHRcdG9wdGlvbnMuZWxlbWVudC50b2dnbGVDbGFzcyggdGhpcy5fY2xhc3Nlcyggb3B0aW9ucyApLCBhZGQgKTtcblx0XHRyZXR1cm4gdGhpcztcblx0fSxcblxuXHRfb246IGZ1bmN0aW9uKCBzdXBwcmVzc0Rpc2FibGVkQ2hlY2ssIGVsZW1lbnQsIGhhbmRsZXJzICkge1xuXHRcdHZhciBkZWxlZ2F0ZUVsZW1lbnQ7XG5cdFx0dmFyIGluc3RhbmNlID0gdGhpcztcblxuXHRcdC8vIE5vIHN1cHByZXNzRGlzYWJsZWRDaGVjayBmbGFnLCBzaHVmZmxlIGFyZ3VtZW50c1xuXHRcdGlmICggdHlwZW9mIHN1cHByZXNzRGlzYWJsZWRDaGVjayAhPT0gXCJib29sZWFuXCIgKSB7XG5cdFx0XHRoYW5kbGVycyA9IGVsZW1lbnQ7XG5cdFx0XHRlbGVtZW50ID0gc3VwcHJlc3NEaXNhYmxlZENoZWNrO1xuXHRcdFx0c3VwcHJlc3NEaXNhYmxlZENoZWNrID0gZmFsc2U7XG5cdFx0fVxuXG5cdFx0Ly8gTm8gZWxlbWVudCBhcmd1bWVudCwgc2h1ZmZsZSBhbmQgdXNlIHRoaXMuZWxlbWVudFxuXHRcdGlmICggIWhhbmRsZXJzICkge1xuXHRcdFx0aGFuZGxlcnMgPSBlbGVtZW50O1xuXHRcdFx0ZWxlbWVudCA9IHRoaXMuZWxlbWVudDtcblx0XHRcdGRlbGVnYXRlRWxlbWVudCA9IHRoaXMud2lkZ2V0KCk7XG5cdFx0fSBlbHNlIHtcblx0XHRcdGVsZW1lbnQgPSBkZWxlZ2F0ZUVsZW1lbnQgPSAkKCBlbGVtZW50ICk7XG5cdFx0XHR0aGlzLmJpbmRpbmdzID0gdGhpcy5iaW5kaW5ncy5hZGQoIGVsZW1lbnQgKTtcblx0XHR9XG5cblx0XHQkLmVhY2goIGhhbmRsZXJzLCBmdW5jdGlvbiggZXZlbnQsIGhhbmRsZXIgKSB7XG5cdFx0XHRmdW5jdGlvbiBoYW5kbGVyUHJveHkoKSB7XG5cblx0XHRcdFx0Ly8gQWxsb3cgd2lkZ2V0cyB0byBjdXN0b21pemUgdGhlIGRpc2FibGVkIGhhbmRsaW5nXG5cdFx0XHRcdC8vIC0gZGlzYWJsZWQgYXMgYW4gYXJyYXkgaW5zdGVhZCBvZiBib29sZWFuXG5cdFx0XHRcdC8vIC0gZGlzYWJsZWQgY2xhc3MgYXMgbWV0aG9kIGZvciBkaXNhYmxpbmcgaW5kaXZpZHVhbCBwYXJ0c1xuXHRcdFx0XHRpZiAoICFzdXBwcmVzc0Rpc2FibGVkQ2hlY2sgJiZcblx0XHRcdFx0XHRcdCggaW5zdGFuY2Uub3B0aW9ucy5kaXNhYmxlZCA9PT0gdHJ1ZSB8fFxuXHRcdFx0XHRcdFx0JCggdGhpcyApLmhhc0NsYXNzKCBcInVpLXN0YXRlLWRpc2FibGVkXCIgKSApICkge1xuXHRcdFx0XHRcdHJldHVybjtcblx0XHRcdFx0fVxuXHRcdFx0XHRyZXR1cm4gKCB0eXBlb2YgaGFuZGxlciA9PT0gXCJzdHJpbmdcIiA/IGluc3RhbmNlWyBoYW5kbGVyIF0gOiBoYW5kbGVyIClcblx0XHRcdFx0XHQuYXBwbHkoIGluc3RhbmNlLCBhcmd1bWVudHMgKTtcblx0XHRcdH1cblxuXHRcdFx0Ly8gQ29weSB0aGUgZ3VpZCBzbyBkaXJlY3QgdW5iaW5kaW5nIHdvcmtzXG5cdFx0XHRpZiAoIHR5cGVvZiBoYW5kbGVyICE9PSBcInN0cmluZ1wiICkge1xuXHRcdFx0XHRoYW5kbGVyUHJveHkuZ3VpZCA9IGhhbmRsZXIuZ3VpZCA9XG5cdFx0XHRcdFx0aGFuZGxlci5ndWlkIHx8IGhhbmRsZXJQcm94eS5ndWlkIHx8ICQuZ3VpZCsrO1xuXHRcdFx0fVxuXG5cdFx0XHR2YXIgbWF0Y2ggPSBldmVudC5tYXRjaCggL14oW1xcdzotXSopXFxzKiguKikkLyApO1xuXHRcdFx0dmFyIGV2ZW50TmFtZSA9IG1hdGNoWyAxIF0gKyBpbnN0YW5jZS5ldmVudE5hbWVzcGFjZTtcblx0XHRcdHZhciBzZWxlY3RvciA9IG1hdGNoWyAyIF07XG5cblx0XHRcdGlmICggc2VsZWN0b3IgKSB7XG5cdFx0XHRcdGRlbGVnYXRlRWxlbWVudC5vbiggZXZlbnROYW1lLCBzZWxlY3RvciwgaGFuZGxlclByb3h5ICk7XG5cdFx0XHR9IGVsc2Uge1xuXHRcdFx0XHRlbGVtZW50Lm9uKCBldmVudE5hbWUsIGhhbmRsZXJQcm94eSApO1xuXHRcdFx0fVxuXHRcdH0gKTtcblx0fSxcblxuXHRfb2ZmOiBmdW5jdGlvbiggZWxlbWVudCwgZXZlbnROYW1lICkge1xuXHRcdGV2ZW50TmFtZSA9ICggZXZlbnROYW1lIHx8IFwiXCIgKS5zcGxpdCggXCIgXCIgKS5qb2luKCB0aGlzLmV2ZW50TmFtZXNwYWNlICsgXCIgXCIgKSArXG5cdFx0XHR0aGlzLmV2ZW50TmFtZXNwYWNlO1xuXHRcdGVsZW1lbnQub2ZmKCBldmVudE5hbWUgKS5vZmYoIGV2ZW50TmFtZSApO1xuXG5cdFx0Ly8gQ2xlYXIgdGhlIHN0YWNrIHRvIGF2b2lkIG1lbW9yeSBsZWFrcyAoIzEwMDU2KVxuXHRcdHRoaXMuYmluZGluZ3MgPSAkKCB0aGlzLmJpbmRpbmdzLm5vdCggZWxlbWVudCApLmdldCgpICk7XG5cdFx0dGhpcy5mb2N1c2FibGUgPSAkKCB0aGlzLmZvY3VzYWJsZS5ub3QoIGVsZW1lbnQgKS5nZXQoKSApO1xuXHRcdHRoaXMuaG92ZXJhYmxlID0gJCggdGhpcy5ob3ZlcmFibGUubm90KCBlbGVtZW50ICkuZ2V0KCkgKTtcblx0fSxcblxuXHRfZGVsYXk6IGZ1bmN0aW9uKCBoYW5kbGVyLCBkZWxheSApIHtcblx0XHRmdW5jdGlvbiBoYW5kbGVyUHJveHkoKSB7XG5cdFx0XHRyZXR1cm4gKCB0eXBlb2YgaGFuZGxlciA9PT0gXCJzdHJpbmdcIiA/IGluc3RhbmNlWyBoYW5kbGVyIF0gOiBoYW5kbGVyIClcblx0XHRcdFx0LmFwcGx5KCBpbnN0YW5jZSwgYXJndW1lbnRzICk7XG5cdFx0fVxuXHRcdHZhciBpbnN0YW5jZSA9IHRoaXM7XG5cdFx0cmV0dXJuIHNldFRpbWVvdXQoIGhhbmRsZXJQcm94eSwgZGVsYXkgfHwgMCApO1xuXHR9LFxuXG5cdF9ob3ZlcmFibGU6IGZ1bmN0aW9uKCBlbGVtZW50ICkge1xuXHRcdHRoaXMuaG92ZXJhYmxlID0gdGhpcy5ob3ZlcmFibGUuYWRkKCBlbGVtZW50ICk7XG5cdFx0dGhpcy5fb24oIGVsZW1lbnQsIHtcblx0XHRcdG1vdXNlZW50ZXI6IGZ1bmN0aW9uKCBldmVudCApIHtcblx0XHRcdFx0dGhpcy5fYWRkQ2xhc3MoICQoIGV2ZW50LmN1cnJlbnRUYXJnZXQgKSwgbnVsbCwgXCJ1aS1zdGF0ZS1ob3ZlclwiICk7XG5cdFx0XHR9LFxuXHRcdFx0bW91c2VsZWF2ZTogZnVuY3Rpb24oIGV2ZW50ICkge1xuXHRcdFx0XHR0aGlzLl9yZW1vdmVDbGFzcyggJCggZXZlbnQuY3VycmVudFRhcmdldCApLCBudWxsLCBcInVpLXN0YXRlLWhvdmVyXCIgKTtcblx0XHRcdH1cblx0XHR9ICk7XG5cdH0sXG5cblx0X2ZvY3VzYWJsZTogZnVuY3Rpb24oIGVsZW1lbnQgKSB7XG5cdFx0dGhpcy5mb2N1c2FibGUgPSB0aGlzLmZvY3VzYWJsZS5hZGQoIGVsZW1lbnQgKTtcblx0XHR0aGlzLl9vbiggZWxlbWVudCwge1xuXHRcdFx0Zm9jdXNpbjogZnVuY3Rpb24oIGV2ZW50ICkge1xuXHRcdFx0XHR0aGlzLl9hZGRDbGFzcyggJCggZXZlbnQuY3VycmVudFRhcmdldCApLCBudWxsLCBcInVpLXN0YXRlLWZvY3VzXCIgKTtcblx0XHRcdH0sXG5cdFx0XHRmb2N1c291dDogZnVuY3Rpb24oIGV2ZW50ICkge1xuXHRcdFx0XHR0aGlzLl9yZW1vdmVDbGFzcyggJCggZXZlbnQuY3VycmVudFRhcmdldCApLCBudWxsLCBcInVpLXN0YXRlLWZvY3VzXCIgKTtcblx0XHRcdH1cblx0XHR9ICk7XG5cdH0sXG5cblx0X3RyaWdnZXI6IGZ1bmN0aW9uKCB0eXBlLCBldmVudCwgZGF0YSApIHtcblx0XHR2YXIgcHJvcCwgb3JpZztcblx0XHR2YXIgY2FsbGJhY2sgPSB0aGlzLm9wdGlvbnNbIHR5cGUgXTtcblxuXHRcdGRhdGEgPSBkYXRhIHx8IHt9O1xuXHRcdGV2ZW50ID0gJC5FdmVudCggZXZlbnQgKTtcblx0XHRldmVudC50eXBlID0gKCB0eXBlID09PSB0aGlzLndpZGdldEV2ZW50UHJlZml4ID9cblx0XHRcdHR5cGUgOlxuXHRcdFx0dGhpcy53aWRnZXRFdmVudFByZWZpeCArIHR5cGUgKS50b0xvd2VyQ2FzZSgpO1xuXG5cdFx0Ly8gVGhlIG9yaWdpbmFsIGV2ZW50IG1heSBjb21lIGZyb20gYW55IGVsZW1lbnRcblx0XHQvLyBzbyB3ZSBuZWVkIHRvIHJlc2V0IHRoZSB0YXJnZXQgb24gdGhlIG5ldyBldmVudFxuXHRcdGV2ZW50LnRhcmdldCA9IHRoaXMuZWxlbWVudFsgMCBdO1xuXG5cdFx0Ly8gQ29weSBvcmlnaW5hbCBldmVudCBwcm9wZXJ0aWVzIG92ZXIgdG8gdGhlIG5ldyBldmVudFxuXHRcdG9yaWcgPSBldmVudC5vcmlnaW5hbEV2ZW50O1xuXHRcdGlmICggb3JpZyApIHtcblx0XHRcdGZvciAoIHByb3AgaW4gb3JpZyApIHtcblx0XHRcdFx0aWYgKCAhKCBwcm9wIGluIGV2ZW50ICkgKSB7XG5cdFx0XHRcdFx0ZXZlbnRbIHByb3AgXSA9IG9yaWdbIHByb3AgXTtcblx0XHRcdFx0fVxuXHRcdFx0fVxuXHRcdH1cblxuXHRcdHRoaXMuZWxlbWVudC50cmlnZ2VyKCBldmVudCwgZGF0YSApO1xuXHRcdHJldHVybiAhKCAkLmlzRnVuY3Rpb24oIGNhbGxiYWNrICkgJiZcblx0XHRcdGNhbGxiYWNrLmFwcGx5KCB0aGlzLmVsZW1lbnRbIDAgXSwgWyBldmVudCBdLmNvbmNhdCggZGF0YSApICkgPT09IGZhbHNlIHx8XG5cdFx0XHRldmVudC5pc0RlZmF1bHRQcmV2ZW50ZWQoKSApO1xuXHR9XG59O1xuXG4kLmVhY2goIHsgc2hvdzogXCJmYWRlSW5cIiwgaGlkZTogXCJmYWRlT3V0XCIgfSwgZnVuY3Rpb24oIG1ldGhvZCwgZGVmYXVsdEVmZmVjdCApIHtcblx0JC5XaWRnZXQucHJvdG90eXBlWyBcIl9cIiArIG1ldGhvZCBdID0gZnVuY3Rpb24oIGVsZW1lbnQsIG9wdGlvbnMsIGNhbGxiYWNrICkge1xuXHRcdGlmICggdHlwZW9mIG9wdGlvbnMgPT09IFwic3RyaW5nXCIgKSB7XG5cdFx0XHRvcHRpb25zID0geyBlZmZlY3Q6IG9wdGlvbnMgfTtcblx0XHR9XG5cblx0XHR2YXIgaGFzT3B0aW9ucztcblx0XHR2YXIgZWZmZWN0TmFtZSA9ICFvcHRpb25zID9cblx0XHRcdG1ldGhvZCA6XG5cdFx0XHRvcHRpb25zID09PSB0cnVlIHx8IHR5cGVvZiBvcHRpb25zID09PSBcIm51bWJlclwiID9cblx0XHRcdFx0ZGVmYXVsdEVmZmVjdCA6XG5cdFx0XHRcdG9wdGlvbnMuZWZmZWN0IHx8IGRlZmF1bHRFZmZlY3Q7XG5cblx0XHRvcHRpb25zID0gb3B0aW9ucyB8fCB7fTtcblx0XHRpZiAoIHR5cGVvZiBvcHRpb25zID09PSBcIm51bWJlclwiICkge1xuXHRcdFx0b3B0aW9ucyA9IHsgZHVyYXRpb246IG9wdGlvbnMgfTtcblx0XHR9XG5cblx0XHRoYXNPcHRpb25zID0gISQuaXNFbXB0eU9iamVjdCggb3B0aW9ucyApO1xuXHRcdG9wdGlvbnMuY29tcGxldGUgPSBjYWxsYmFjaztcblxuXHRcdGlmICggb3B0aW9ucy5kZWxheSApIHtcblx0XHRcdGVsZW1lbnQuZGVsYXkoIG9wdGlvbnMuZGVsYXkgKTtcblx0XHR9XG5cblx0XHRpZiAoIGhhc09wdGlvbnMgJiYgJC5lZmZlY3RzICYmICQuZWZmZWN0cy5lZmZlY3RbIGVmZmVjdE5hbWUgXSApIHtcblx0XHRcdGVsZW1lbnRbIG1ldGhvZCBdKCBvcHRpb25zICk7XG5cdFx0fSBlbHNlIGlmICggZWZmZWN0TmFtZSAhPT0gbWV0aG9kICYmIGVsZW1lbnRbIGVmZmVjdE5hbWUgXSApIHtcblx0XHRcdGVsZW1lbnRbIGVmZmVjdE5hbWUgXSggb3B0aW9ucy5kdXJhdGlvbiwgb3B0aW9ucy5lYXNpbmcsIGNhbGxiYWNrICk7XG5cdFx0fSBlbHNlIHtcblx0XHRcdGVsZW1lbnQucXVldWUoIGZ1bmN0aW9uKCBuZXh0ICkge1xuXHRcdFx0XHQkKCB0aGlzIClbIG1ldGhvZCBdKCk7XG5cdFx0XHRcdGlmICggY2FsbGJhY2sgKSB7XG5cdFx0XHRcdFx0Y2FsbGJhY2suY2FsbCggZWxlbWVudFsgMCBdICk7XG5cdFx0XHRcdH1cblx0XHRcdFx0bmV4dCgpO1xuXHRcdFx0fSApO1xuXHRcdH1cblx0fTtcbn0gKTtcblxucmV0dXJuICQud2lkZ2V0O1xuXG59ICkgKTtcbiIsIi8qIVxuICogalF1ZXJ5IFVJIEF1dG9jb21wbGV0ZSAxLjEyLjBcbiAqIGh0dHA6Ly9qcXVlcnl1aS5jb21cbiAqXG4gKiBDb3B5cmlnaHQgalF1ZXJ5IEZvdW5kYXRpb24gYW5kIG90aGVyIGNvbnRyaWJ1dG9yc1xuICogUmVsZWFzZWQgdW5kZXIgdGhlIE1JVCBsaWNlbnNlLlxuICogaHR0cDovL2pxdWVyeS5vcmcvbGljZW5zZVxuICovXG5cbi8vPj5sYWJlbDogQXV0b2NvbXBsZXRlXG4vLz4+Z3JvdXA6IFdpZGdldHNcbi8vPj5kZXNjcmlwdGlvbjogTGlzdHMgc3VnZ2VzdGVkIHdvcmRzIGFzIHRoZSB1c2VyIGlzIHR5cGluZy5cbi8vPj5kb2NzOiBodHRwOi8vYXBpLmpxdWVyeXVpLmNvbS9hdXRvY29tcGxldGUvXG4vLz4+ZGVtb3M6IGh0dHA6Ly9qcXVlcnl1aS5jb20vYXV0b2NvbXBsZXRlL1xuLy8+PmNzcy5zdHJ1Y3R1cmU6IC4uLy4uL3RoZW1lcy9iYXNlL2NvcmUuY3NzXG4vLz4+Y3NzLnN0cnVjdHVyZTogLi4vLi4vdGhlbWVzL2Jhc2UvYXV0b2NvbXBsZXRlLmNzc1xuLy8+PmNzcy50aGVtZTogLi4vLi4vdGhlbWVzL2Jhc2UvdGhlbWUuY3NzXG5cbiggZnVuY3Rpb24oIGZhY3RvcnkgKSB7XG5cdGlmICggdHlwZW9mIGRlZmluZSA9PT0gXCJmdW5jdGlvblwiICYmIGRlZmluZS5hbWQgKSB7XG5cblx0XHQvLyBBTUQuIFJlZ2lzdGVyIGFzIGFuIGFub255bW91cyBtb2R1bGUuXG5cdFx0ZGVmaW5lKCBbXG5cdFx0XHRcImpxdWVyeVwiLFxuXHRcdFx0XCIuL21lbnVcIixcblx0XHRcdFwiLi4va2V5Y29kZVwiLFxuXHRcdFx0XCIuLi9wb3NpdGlvblwiLFxuXHRcdFx0XCIuLi9zYWZlLWFjdGl2ZS1lbGVtZW50XCIsXG5cdFx0XHRcIi4uL3ZlcnNpb25cIixcblx0XHRcdFwiLi4vd2lkZ2V0XCJcblx0XHRdLCBmYWN0b3J5ICk7XG5cdH0gZWxzZSB7XG5cblx0XHQvLyBCcm93c2VyIGdsb2JhbHNcblx0XHRmYWN0b3J5KCBqUXVlcnkgKTtcblx0fVxufSggZnVuY3Rpb24oICQgKSB7XG5cbiQud2lkZ2V0KCBcInVpLmF1dG9jb21wbGV0ZVwiLCB7XG5cdHZlcnNpb246IFwiMS4xMi4wXCIsXG5cdGRlZmF1bHRFbGVtZW50OiBcIjxpbnB1dD5cIixcblx0b3B0aW9uczoge1xuXHRcdGFwcGVuZFRvOiBudWxsLFxuXHRcdGF1dG9Gb2N1czogZmFsc2UsXG5cdFx0ZGVsYXk6IDMwMCxcblx0XHRtaW5MZW5ndGg6IDEsXG5cdFx0cG9zaXRpb246IHtcblx0XHRcdG15OiBcImxlZnQgdG9wXCIsXG5cdFx0XHRhdDogXCJsZWZ0IGJvdHRvbVwiLFxuXHRcdFx0Y29sbGlzaW9uOiBcIm5vbmVcIlxuXHRcdH0sXG5cdFx0c291cmNlOiBudWxsLFxuXG5cdFx0Ly8gQ2FsbGJhY2tzXG5cdFx0Y2hhbmdlOiBudWxsLFxuXHRcdGNsb3NlOiBudWxsLFxuXHRcdGZvY3VzOiBudWxsLFxuXHRcdG9wZW46IG51bGwsXG5cdFx0cmVzcG9uc2U6IG51bGwsXG5cdFx0c2VhcmNoOiBudWxsLFxuXHRcdHNlbGVjdDogbnVsbFxuXHR9LFxuXG5cdHJlcXVlc3RJbmRleDogMCxcblx0cGVuZGluZzogMCxcblxuXHRfY3JlYXRlOiBmdW5jdGlvbigpIHtcblxuXHRcdC8vIFNvbWUgYnJvd3NlcnMgb25seSByZXBlYXQga2V5ZG93biBldmVudHMsIG5vdCBrZXlwcmVzcyBldmVudHMsXG5cdFx0Ly8gc28gd2UgdXNlIHRoZSBzdXBwcmVzc0tleVByZXNzIGZsYWcgdG8gZGV0ZXJtaW5lIGlmIHdlJ3ZlIGFscmVhZHlcblx0XHQvLyBoYW5kbGVkIHRoZSBrZXlkb3duIGV2ZW50LiAjNzI2OVxuXHRcdC8vIFVuZm9ydHVuYXRlbHkgdGhlIGNvZGUgZm9yICYgaW4ga2V5cHJlc3MgaXMgdGhlIHNhbWUgYXMgdGhlIHVwIGFycm93LFxuXHRcdC8vIHNvIHdlIHVzZSB0aGUgc3VwcHJlc3NLZXlQcmVzc1JlcGVhdCBmbGFnIHRvIGF2b2lkIGhhbmRsaW5nIGtleXByZXNzXG5cdFx0Ly8gZXZlbnRzIHdoZW4gd2Uga25vdyB0aGUga2V5ZG93biBldmVudCB3YXMgdXNlZCB0byBtb2RpZnkgdGhlXG5cdFx0Ly8gc2VhcmNoIHRlcm0uICM3Nzk5XG5cdFx0dmFyIHN1cHByZXNzS2V5UHJlc3MsIHN1cHByZXNzS2V5UHJlc3NSZXBlYXQsIHN1cHByZXNzSW5wdXQsXG5cdFx0XHRub2RlTmFtZSA9IHRoaXMuZWxlbWVudFsgMCBdLm5vZGVOYW1lLnRvTG93ZXJDYXNlKCksXG5cdFx0XHRpc1RleHRhcmVhID0gbm9kZU5hbWUgPT09IFwidGV4dGFyZWFcIixcblx0XHRcdGlzSW5wdXQgPSBub2RlTmFtZSA9PT0gXCJpbnB1dFwiO1xuXG5cdFx0Ly8gVGV4dGFyZWFzIGFyZSBhbHdheXMgbXVsdGktbGluZVxuXHRcdC8vIElucHV0cyBhcmUgYWx3YXlzIHNpbmdsZS1saW5lLCBldmVuIGlmIGluc2lkZSBhIGNvbnRlbnRFZGl0YWJsZSBlbGVtZW50XG5cdFx0Ly8gSUUgYWxzbyB0cmVhdHMgaW5wdXRzIGFzIGNvbnRlbnRFZGl0YWJsZVxuXHRcdC8vIEFsbCBvdGhlciBlbGVtZW50IHR5cGVzIGFyZSBkZXRlcm1pbmVkIGJ5IHdoZXRoZXIgb3Igbm90IHRoZXkncmUgY29udGVudEVkaXRhYmxlXG5cdFx0dGhpcy5pc011bHRpTGluZSA9IGlzVGV4dGFyZWEgfHwgIWlzSW5wdXQgJiYgdGhpcy5faXNDb250ZW50RWRpdGFibGUoIHRoaXMuZWxlbWVudCApO1xuXG5cdFx0dGhpcy52YWx1ZU1ldGhvZCA9IHRoaXMuZWxlbWVudFsgaXNUZXh0YXJlYSB8fCBpc0lucHV0ID8gXCJ2YWxcIiA6IFwidGV4dFwiIF07XG5cdFx0dGhpcy5pc05ld01lbnUgPSB0cnVlO1xuXG5cdFx0dGhpcy5fYWRkQ2xhc3MoIFwidWktYXV0b2NvbXBsZXRlLWlucHV0XCIgKTtcblx0XHR0aGlzLmVsZW1lbnQuYXR0ciggXCJhdXRvY29tcGxldGVcIiwgXCJvZmZcIiApO1xuXG5cdFx0dGhpcy5fb24oIHRoaXMuZWxlbWVudCwge1xuXHRcdFx0a2V5ZG93bjogZnVuY3Rpb24oIGV2ZW50ICkge1xuXHRcdFx0XHRpZiAoIHRoaXMuZWxlbWVudC5wcm9wKCBcInJlYWRPbmx5XCIgKSApIHtcblx0XHRcdFx0XHRzdXBwcmVzc0tleVByZXNzID0gdHJ1ZTtcblx0XHRcdFx0XHRzdXBwcmVzc0lucHV0ID0gdHJ1ZTtcblx0XHRcdFx0XHRzdXBwcmVzc0tleVByZXNzUmVwZWF0ID0gdHJ1ZTtcblx0XHRcdFx0XHRyZXR1cm47XG5cdFx0XHRcdH1cblxuXHRcdFx0XHRzdXBwcmVzc0tleVByZXNzID0gZmFsc2U7XG5cdFx0XHRcdHN1cHByZXNzSW5wdXQgPSBmYWxzZTtcblx0XHRcdFx0c3VwcHJlc3NLZXlQcmVzc1JlcGVhdCA9IGZhbHNlO1xuXHRcdFx0XHR2YXIga2V5Q29kZSA9ICQudWkua2V5Q29kZTtcblx0XHRcdFx0c3dpdGNoICggZXZlbnQua2V5Q29kZSApIHtcblx0XHRcdFx0Y2FzZSBrZXlDb2RlLlBBR0VfVVA6XG5cdFx0XHRcdFx0c3VwcHJlc3NLZXlQcmVzcyA9IHRydWU7XG5cdFx0XHRcdFx0dGhpcy5fbW92ZSggXCJwcmV2aW91c1BhZ2VcIiwgZXZlbnQgKTtcblx0XHRcdFx0XHRicmVhaztcblx0XHRcdFx0Y2FzZSBrZXlDb2RlLlBBR0VfRE9XTjpcblx0XHRcdFx0XHRzdXBwcmVzc0tleVByZXNzID0gdHJ1ZTtcblx0XHRcdFx0XHR0aGlzLl9tb3ZlKCBcIm5leHRQYWdlXCIsIGV2ZW50ICk7XG5cdFx0XHRcdFx0YnJlYWs7XG5cdFx0XHRcdGNhc2Uga2V5Q29kZS5VUDpcblx0XHRcdFx0XHRzdXBwcmVzc0tleVByZXNzID0gdHJ1ZTtcblx0XHRcdFx0XHR0aGlzLl9rZXlFdmVudCggXCJwcmV2aW91c1wiLCBldmVudCApO1xuXHRcdFx0XHRcdGJyZWFrO1xuXHRcdFx0XHRjYXNlIGtleUNvZGUuRE9XTjpcblx0XHRcdFx0XHRzdXBwcmVzc0tleVByZXNzID0gdHJ1ZTtcblx0XHRcdFx0XHR0aGlzLl9rZXlFdmVudCggXCJuZXh0XCIsIGV2ZW50ICk7XG5cdFx0XHRcdFx0YnJlYWs7XG5cdFx0XHRcdGNhc2Uga2V5Q29kZS5FTlRFUjpcblxuXHRcdFx0XHRcdC8vIHdoZW4gbWVudSBpcyBvcGVuIGFuZCBoYXMgZm9jdXNcblx0XHRcdFx0XHRpZiAoIHRoaXMubWVudS5hY3RpdmUgKSB7XG5cblx0XHRcdFx0XHRcdC8vICM2MDU1IC0gT3BlcmEgc3RpbGwgYWxsb3dzIHRoZSBrZXlwcmVzcyB0byBvY2N1clxuXHRcdFx0XHRcdFx0Ly8gd2hpY2ggY2F1c2VzIGZvcm1zIHRvIHN1Ym1pdFxuXHRcdFx0XHRcdFx0c3VwcHJlc3NLZXlQcmVzcyA9IHRydWU7XG5cdFx0XHRcdFx0XHRldmVudC5wcmV2ZW50RGVmYXVsdCgpO1xuXHRcdFx0XHRcdFx0dGhpcy5tZW51LnNlbGVjdCggZXZlbnQgKTtcblx0XHRcdFx0XHR9XG5cdFx0XHRcdFx0YnJlYWs7XG5cdFx0XHRcdGNhc2Uga2V5Q29kZS5UQUI6XG5cdFx0XHRcdFx0aWYgKCB0aGlzLm1lbnUuYWN0aXZlICkge1xuXHRcdFx0XHRcdFx0dGhpcy5tZW51LnNlbGVjdCggZXZlbnQgKTtcblx0XHRcdFx0XHR9XG5cdFx0XHRcdFx0YnJlYWs7XG5cdFx0XHRcdGNhc2Uga2V5Q29kZS5FU0NBUEU6XG5cdFx0XHRcdFx0aWYgKCB0aGlzLm1lbnUuZWxlbWVudC5pcyggXCI6dmlzaWJsZVwiICkgKSB7XG5cdFx0XHRcdFx0XHRpZiAoICF0aGlzLmlzTXVsdGlMaW5lICkge1xuXHRcdFx0XHRcdFx0XHR0aGlzLl92YWx1ZSggdGhpcy50ZXJtICk7XG5cdFx0XHRcdFx0XHR9XG5cdFx0XHRcdFx0XHR0aGlzLmNsb3NlKCBldmVudCApO1xuXG5cdFx0XHRcdFx0XHQvLyBEaWZmZXJlbnQgYnJvd3NlcnMgaGF2ZSBkaWZmZXJlbnQgZGVmYXVsdCBiZWhhdmlvciBmb3IgZXNjYXBlXG5cdFx0XHRcdFx0XHQvLyBTaW5nbGUgcHJlc3MgY2FuIG1lYW4gdW5kbyBvciBjbGVhclxuXHRcdFx0XHRcdFx0Ly8gRG91YmxlIHByZXNzIGluIElFIG1lYW5zIGNsZWFyIHRoZSB3aG9sZSBmb3JtXG5cdFx0XHRcdFx0XHRldmVudC5wcmV2ZW50RGVmYXVsdCgpO1xuXHRcdFx0XHRcdH1cblx0XHRcdFx0XHRicmVhaztcblx0XHRcdFx0ZGVmYXVsdDpcblx0XHRcdFx0XHRzdXBwcmVzc0tleVByZXNzUmVwZWF0ID0gdHJ1ZTtcblxuXHRcdFx0XHRcdC8vIHNlYXJjaCB0aW1lb3V0IHNob3VsZCBiZSB0cmlnZ2VyZWQgYmVmb3JlIHRoZSBpbnB1dCB2YWx1ZSBpcyBjaGFuZ2VkXG5cdFx0XHRcdFx0dGhpcy5fc2VhcmNoVGltZW91dCggZXZlbnQgKTtcblx0XHRcdFx0XHRicmVhaztcblx0XHRcdFx0fVxuXHRcdFx0fSxcblx0XHRcdGtleXByZXNzOiBmdW5jdGlvbiggZXZlbnQgKSB7XG5cdFx0XHRcdGlmICggc3VwcHJlc3NLZXlQcmVzcyApIHtcblx0XHRcdFx0XHRzdXBwcmVzc0tleVByZXNzID0gZmFsc2U7XG5cdFx0XHRcdFx0aWYgKCAhdGhpcy5pc011bHRpTGluZSB8fCB0aGlzLm1lbnUuZWxlbWVudC5pcyggXCI6dmlzaWJsZVwiICkgKSB7XG5cdFx0XHRcdFx0XHRldmVudC5wcmV2ZW50RGVmYXVsdCgpO1xuXHRcdFx0XHRcdH1cblx0XHRcdFx0XHRyZXR1cm47XG5cdFx0XHRcdH1cblx0XHRcdFx0aWYgKCBzdXBwcmVzc0tleVByZXNzUmVwZWF0ICkge1xuXHRcdFx0XHRcdHJldHVybjtcblx0XHRcdFx0fVxuXG5cdFx0XHRcdC8vIFJlcGxpY2F0ZSBzb21lIGtleSBoYW5kbGVycyB0byBhbGxvdyB0aGVtIHRvIHJlcGVhdCBpbiBGaXJlZm94IGFuZCBPcGVyYVxuXHRcdFx0XHR2YXIga2V5Q29kZSA9ICQudWkua2V5Q29kZTtcblx0XHRcdFx0c3dpdGNoICggZXZlbnQua2V5Q29kZSApIHtcblx0XHRcdFx0Y2FzZSBrZXlDb2RlLlBBR0VfVVA6XG5cdFx0XHRcdFx0dGhpcy5fbW92ZSggXCJwcmV2aW91c1BhZ2VcIiwgZXZlbnQgKTtcblx0XHRcdFx0XHRicmVhaztcblx0XHRcdFx0Y2FzZSBrZXlDb2RlLlBBR0VfRE9XTjpcblx0XHRcdFx0XHR0aGlzLl9tb3ZlKCBcIm5leHRQYWdlXCIsIGV2ZW50ICk7XG5cdFx0XHRcdFx0YnJlYWs7XG5cdFx0XHRcdGNhc2Uga2V5Q29kZS5VUDpcblx0XHRcdFx0XHR0aGlzLl9rZXlFdmVudCggXCJwcmV2aW91c1wiLCBldmVudCApO1xuXHRcdFx0XHRcdGJyZWFrO1xuXHRcdFx0XHRjYXNlIGtleUNvZGUuRE9XTjpcblx0XHRcdFx0XHR0aGlzLl9rZXlFdmVudCggXCJuZXh0XCIsIGV2ZW50ICk7XG5cdFx0XHRcdFx0YnJlYWs7XG5cdFx0XHRcdH1cblx0XHRcdH0sXG5cdFx0XHRpbnB1dDogZnVuY3Rpb24oIGV2ZW50ICkge1xuXHRcdFx0XHRpZiAoIHN1cHByZXNzSW5wdXQgKSB7XG5cdFx0XHRcdFx0c3VwcHJlc3NJbnB1dCA9IGZhbHNlO1xuXHRcdFx0XHRcdGV2ZW50LnByZXZlbnREZWZhdWx0KCk7XG5cdFx0XHRcdFx0cmV0dXJuO1xuXHRcdFx0XHR9XG5cdFx0XHRcdHRoaXMuX3NlYXJjaFRpbWVvdXQoIGV2ZW50ICk7XG5cdFx0XHR9LFxuXHRcdFx0Zm9jdXM6IGZ1bmN0aW9uKCkge1xuXHRcdFx0XHR0aGlzLnNlbGVjdGVkSXRlbSA9IG51bGw7XG5cdFx0XHRcdHRoaXMucHJldmlvdXMgPSB0aGlzLl92YWx1ZSgpO1xuXHRcdFx0fSxcblx0XHRcdGJsdXI6IGZ1bmN0aW9uKCBldmVudCApIHtcblx0XHRcdFx0aWYgKCB0aGlzLmNhbmNlbEJsdXIgKSB7XG5cdFx0XHRcdFx0ZGVsZXRlIHRoaXMuY2FuY2VsQmx1cjtcblx0XHRcdFx0XHRyZXR1cm47XG5cdFx0XHRcdH1cblxuXHRcdFx0XHRjbGVhclRpbWVvdXQoIHRoaXMuc2VhcmNoaW5nICk7XG5cdFx0XHRcdHRoaXMuY2xvc2UoIGV2ZW50ICk7XG5cdFx0XHRcdHRoaXMuX2NoYW5nZSggZXZlbnQgKTtcblx0XHRcdH1cblx0XHR9ICk7XG5cblx0XHR0aGlzLl9pbml0U291cmNlKCk7XG5cdFx0dGhpcy5tZW51ID0gJCggXCI8dWw+XCIgKVxuXHRcdFx0LmFwcGVuZFRvKCB0aGlzLl9hcHBlbmRUbygpIClcblx0XHRcdC5tZW51KCB7XG5cblx0XHRcdFx0Ly8gZGlzYWJsZSBBUklBIHN1cHBvcnQsIHRoZSBsaXZlIHJlZ2lvbiB0YWtlcyBjYXJlIG9mIHRoYXRcblx0XHRcdFx0cm9sZTogbnVsbFxuXHRcdFx0fSApXG5cdFx0XHQuaGlkZSgpXG5cdFx0XHQubWVudSggXCJpbnN0YW5jZVwiICk7XG5cblx0XHR0aGlzLl9hZGRDbGFzcyggdGhpcy5tZW51LmVsZW1lbnQsIFwidWktYXV0b2NvbXBsZXRlXCIsIFwidWktZnJvbnRcIiApO1xuXHRcdHRoaXMuX29uKCB0aGlzLm1lbnUuZWxlbWVudCwge1xuXHRcdFx0bW91c2Vkb3duOiBmdW5jdGlvbiggZXZlbnQgKSB7XG5cblx0XHRcdFx0Ly8gcHJldmVudCBtb3ZpbmcgZm9jdXMgb3V0IG9mIHRoZSB0ZXh0IGZpZWxkXG5cdFx0XHRcdGV2ZW50LnByZXZlbnREZWZhdWx0KCk7XG5cblx0XHRcdFx0Ly8gSUUgZG9lc24ndCBwcmV2ZW50IG1vdmluZyBmb2N1cyBldmVuIHdpdGggZXZlbnQucHJldmVudERlZmF1bHQoKVxuXHRcdFx0XHQvLyBzbyB3ZSBzZXQgYSBmbGFnIHRvIGtub3cgd2hlbiB3ZSBzaG91bGQgaWdub3JlIHRoZSBibHVyIGV2ZW50XG5cdFx0XHRcdHRoaXMuY2FuY2VsQmx1ciA9IHRydWU7XG5cdFx0XHRcdHRoaXMuX2RlbGF5KCBmdW5jdGlvbigpIHtcblx0XHRcdFx0XHRkZWxldGUgdGhpcy5jYW5jZWxCbHVyO1xuXG5cdFx0XHRcdFx0Ly8gU3VwcG9ydDogSUUgOCBvbmx5XG5cdFx0XHRcdFx0Ly8gUmlnaHQgY2xpY2tpbmcgYSBtZW51IGl0ZW0gb3Igc2VsZWN0aW5nIHRleHQgZnJvbSB0aGUgbWVudSBpdGVtcyB3aWxsXG5cdFx0XHRcdFx0Ly8gcmVzdWx0IGluIGZvY3VzIG1vdmluZyBvdXQgb2YgdGhlIGlucHV0LiBIb3dldmVyLCB3ZSd2ZSBhbHJlYWR5IHJlY2VpdmVkXG5cdFx0XHRcdFx0Ly8gYW5kIGlnbm9yZWQgdGhlIGJsdXIgZXZlbnQgYmVjYXVzZSBvZiB0aGUgY2FuY2VsQmx1ciBmbGFnIHNldCBhYm92ZS4gU29cblx0XHRcdFx0XHQvLyB3ZSByZXN0b3JlIGZvY3VzIHRvIGVuc3VyZSB0aGF0IHRoZSBtZW51IGNsb3NlcyBwcm9wZXJseSBiYXNlZCBvbiB0aGUgdXNlcidzXG5cdFx0XHRcdFx0Ly8gbmV4dCBhY3Rpb25zLlxuXHRcdFx0XHRcdGlmICggdGhpcy5lbGVtZW50WyAwIF0gIT09ICQudWkuc2FmZUFjdGl2ZUVsZW1lbnQoIHRoaXMuZG9jdW1lbnRbIDAgXSApICkge1xuXHRcdFx0XHRcdFx0dGhpcy5lbGVtZW50LnRyaWdnZXIoIFwiZm9jdXNcIiApO1xuXHRcdFx0XHRcdH1cblx0XHRcdFx0fSApO1xuXHRcdFx0fSxcblx0XHRcdG1lbnVmb2N1czogZnVuY3Rpb24oIGV2ZW50LCB1aSApIHtcblx0XHRcdFx0dmFyIGxhYmVsLCBpdGVtO1xuXG5cdFx0XHRcdC8vIHN1cHBvcnQ6IEZpcmVmb3hcblx0XHRcdFx0Ly8gUHJldmVudCBhY2NpZGVudGFsIGFjdGl2YXRpb24gb2YgbWVudSBpdGVtcyBpbiBGaXJlZm94ICgjNzAyNCAjOTExOClcblx0XHRcdFx0aWYgKCB0aGlzLmlzTmV3TWVudSApIHtcblx0XHRcdFx0XHR0aGlzLmlzTmV3TWVudSA9IGZhbHNlO1xuXHRcdFx0XHRcdGlmICggZXZlbnQub3JpZ2luYWxFdmVudCAmJiAvXm1vdXNlLy50ZXN0KCBldmVudC5vcmlnaW5hbEV2ZW50LnR5cGUgKSApIHtcblx0XHRcdFx0XHRcdHRoaXMubWVudS5ibHVyKCk7XG5cblx0XHRcdFx0XHRcdHRoaXMuZG9jdW1lbnQub25lKCBcIm1vdXNlbW92ZVwiLCBmdW5jdGlvbigpIHtcblx0XHRcdFx0XHRcdFx0JCggZXZlbnQudGFyZ2V0ICkudHJpZ2dlciggZXZlbnQub3JpZ2luYWxFdmVudCApO1xuXHRcdFx0XHRcdFx0fSApO1xuXG5cdFx0XHRcdFx0XHRyZXR1cm47XG5cdFx0XHRcdFx0fVxuXHRcdFx0XHR9XG5cblx0XHRcdFx0aXRlbSA9IHVpLml0ZW0uZGF0YSggXCJ1aS1hdXRvY29tcGxldGUtaXRlbVwiICk7XG5cdFx0XHRcdGlmICggZmFsc2UgIT09IHRoaXMuX3RyaWdnZXIoIFwiZm9jdXNcIiwgZXZlbnQsIHsgaXRlbTogaXRlbSB9ICkgKSB7XG5cblx0XHRcdFx0XHQvLyB1c2UgdmFsdWUgdG8gbWF0Y2ggd2hhdCB3aWxsIGVuZCB1cCBpbiB0aGUgaW5wdXQsIGlmIGl0IHdhcyBhIGtleSBldmVudFxuXHRcdFx0XHRcdGlmICggZXZlbnQub3JpZ2luYWxFdmVudCAmJiAvXmtleS8udGVzdCggZXZlbnQub3JpZ2luYWxFdmVudC50eXBlICkgKSB7XG5cdFx0XHRcdFx0XHR0aGlzLl92YWx1ZSggaXRlbS52YWx1ZSApO1xuXHRcdFx0XHRcdH1cblx0XHRcdFx0fVxuXG5cdFx0XHRcdC8vIEFubm91bmNlIHRoZSB2YWx1ZSBpbiB0aGUgbGl2ZVJlZ2lvblxuXHRcdFx0XHRsYWJlbCA9IHVpLml0ZW0uYXR0ciggXCJhcmlhLWxhYmVsXCIgKSB8fCBpdGVtLnZhbHVlO1xuXHRcdFx0XHRpZiAoIGxhYmVsICYmICQudHJpbSggbGFiZWwgKS5sZW5ndGggKSB7XG5cdFx0XHRcdFx0dGhpcy5saXZlUmVnaW9uLmNoaWxkcmVuKCkuaGlkZSgpO1xuXHRcdFx0XHRcdCQoIFwiPGRpdj5cIiApLnRleHQoIGxhYmVsICkuYXBwZW5kVG8oIHRoaXMubGl2ZVJlZ2lvbiApO1xuXHRcdFx0XHR9XG5cdFx0XHR9LFxuXHRcdFx0bWVudXNlbGVjdDogZnVuY3Rpb24oIGV2ZW50LCB1aSApIHtcblx0XHRcdFx0dmFyIGl0ZW0gPSB1aS5pdGVtLmRhdGEoIFwidWktYXV0b2NvbXBsZXRlLWl0ZW1cIiApLFxuXHRcdFx0XHRcdHByZXZpb3VzID0gdGhpcy5wcmV2aW91cztcblxuXHRcdFx0XHQvLyBPbmx5IHRyaWdnZXIgd2hlbiBmb2N1cyB3YXMgbG9zdCAoY2xpY2sgb24gbWVudSlcblx0XHRcdFx0aWYgKCB0aGlzLmVsZW1lbnRbIDAgXSAhPT0gJC51aS5zYWZlQWN0aXZlRWxlbWVudCggdGhpcy5kb2N1bWVudFsgMCBdICkgKSB7XG5cdFx0XHRcdFx0dGhpcy5lbGVtZW50LnRyaWdnZXIoIFwiZm9jdXNcIiApO1xuXHRcdFx0XHRcdHRoaXMucHJldmlvdXMgPSBwcmV2aW91cztcblxuXHRcdFx0XHRcdC8vICM2MTA5IC0gSUUgdHJpZ2dlcnMgdHdvIGZvY3VzIGV2ZW50cyBhbmQgdGhlIHNlY29uZFxuXHRcdFx0XHRcdC8vIGlzIGFzeW5jaHJvbm91cywgc28gd2UgbmVlZCB0byByZXNldCB0aGUgcHJldmlvdXNcblx0XHRcdFx0XHQvLyB0ZXJtIHN5bmNocm9ub3VzbHkgYW5kIGFzeW5jaHJvbm91c2x5IDotKFxuXHRcdFx0XHRcdHRoaXMuX2RlbGF5KCBmdW5jdGlvbigpIHtcblx0XHRcdFx0XHRcdHRoaXMucHJldmlvdXMgPSBwcmV2aW91cztcblx0XHRcdFx0XHRcdHRoaXMuc2VsZWN0ZWRJdGVtID0gaXRlbTtcblx0XHRcdFx0XHR9ICk7XG5cdFx0XHRcdH1cblxuXHRcdFx0XHRpZiAoIGZhbHNlICE9PSB0aGlzLl90cmlnZ2VyKCBcInNlbGVjdFwiLCBldmVudCwgeyBpdGVtOiBpdGVtIH0gKSApIHtcblx0XHRcdFx0XHR0aGlzLl92YWx1ZSggaXRlbS52YWx1ZSApO1xuXHRcdFx0XHR9XG5cblx0XHRcdFx0Ly8gcmVzZXQgdGhlIHRlcm0gYWZ0ZXIgdGhlIHNlbGVjdCBldmVudFxuXHRcdFx0XHQvLyB0aGlzIGFsbG93cyBjdXN0b20gc2VsZWN0IGhhbmRsaW5nIHRvIHdvcmsgcHJvcGVybHlcblx0XHRcdFx0dGhpcy50ZXJtID0gdGhpcy5fdmFsdWUoKTtcblxuXHRcdFx0XHR0aGlzLmNsb3NlKCBldmVudCApO1xuXHRcdFx0XHR0aGlzLnNlbGVjdGVkSXRlbSA9IGl0ZW07XG5cdFx0XHR9XG5cdFx0fSApO1xuXG5cdFx0dGhpcy5saXZlUmVnaW9uID0gJCggXCI8ZGl2PlwiLCB7XG5cdFx0XHRyb2xlOiBcInN0YXR1c1wiLFxuXHRcdFx0XCJhcmlhLWxpdmVcIjogXCJhc3NlcnRpdmVcIixcblx0XHRcdFwiYXJpYS1yZWxldmFudFwiOiBcImFkZGl0aW9uc1wiXG5cdFx0fSApXG5cdFx0XHQuYXBwZW5kVG8oIHRoaXMuZG9jdW1lbnRbIDAgXS5ib2R5ICk7XG5cblx0XHR0aGlzLl9hZGRDbGFzcyggdGhpcy5saXZlUmVnaW9uLCBudWxsLCBcInVpLWhlbHBlci1oaWRkZW4tYWNjZXNzaWJsZVwiICk7XG5cblx0XHQvLyBUdXJuaW5nIG9mZiBhdXRvY29tcGxldGUgcHJldmVudHMgdGhlIGJyb3dzZXIgZnJvbSByZW1lbWJlcmluZyB0aGVcblx0XHQvLyB2YWx1ZSB3aGVuIG5hdmlnYXRpbmcgdGhyb3VnaCBoaXN0b3J5LCBzbyB3ZSByZS1lbmFibGUgYXV0b2NvbXBsZXRlXG5cdFx0Ly8gaWYgdGhlIHBhZ2UgaXMgdW5sb2FkZWQgYmVmb3JlIHRoZSB3aWRnZXQgaXMgZGVzdHJveWVkLiAjNzc5MFxuXHRcdHRoaXMuX29uKCB0aGlzLndpbmRvdywge1xuXHRcdFx0YmVmb3JldW5sb2FkOiBmdW5jdGlvbigpIHtcblx0XHRcdFx0dGhpcy5lbGVtZW50LnJlbW92ZUF0dHIoIFwiYXV0b2NvbXBsZXRlXCIgKTtcblx0XHRcdH1cblx0XHR9ICk7XG5cdH0sXG5cblx0X2Rlc3Ryb3k6IGZ1bmN0aW9uKCkge1xuXHRcdGNsZWFyVGltZW91dCggdGhpcy5zZWFyY2hpbmcgKTtcblx0XHR0aGlzLmVsZW1lbnQucmVtb3ZlQXR0ciggXCJhdXRvY29tcGxldGVcIiApO1xuXHRcdHRoaXMubWVudS5lbGVtZW50LnJlbW92ZSgpO1xuXHRcdHRoaXMubGl2ZVJlZ2lvbi5yZW1vdmUoKTtcblx0fSxcblxuXHRfc2V0T3B0aW9uOiBmdW5jdGlvbigga2V5LCB2YWx1ZSApIHtcblx0XHR0aGlzLl9zdXBlcigga2V5LCB2YWx1ZSApO1xuXHRcdGlmICgga2V5ID09PSBcInNvdXJjZVwiICkge1xuXHRcdFx0dGhpcy5faW5pdFNvdXJjZSgpO1xuXHRcdH1cblx0XHRpZiAoIGtleSA9PT0gXCJhcHBlbmRUb1wiICkge1xuXHRcdFx0dGhpcy5tZW51LmVsZW1lbnQuYXBwZW5kVG8oIHRoaXMuX2FwcGVuZFRvKCkgKTtcblx0XHR9XG5cdFx0aWYgKCBrZXkgPT09IFwiZGlzYWJsZWRcIiAmJiB2YWx1ZSAmJiB0aGlzLnhociApIHtcblx0XHRcdHRoaXMueGhyLmFib3J0KCk7XG5cdFx0fVxuXHR9LFxuXG5cdF9pc0V2ZW50VGFyZ2V0SW5XaWRnZXQ6IGZ1bmN0aW9uKCBldmVudCApIHtcblx0XHR2YXIgbWVudUVsZW1lbnQgPSB0aGlzLm1lbnUuZWxlbWVudFsgMCBdO1xuXG5cdFx0cmV0dXJuIGV2ZW50LnRhcmdldCA9PT0gdGhpcy5lbGVtZW50WyAwIF0gfHxcblx0XHRcdGV2ZW50LnRhcmdldCA9PT0gbWVudUVsZW1lbnQgfHxcblx0XHRcdCQuY29udGFpbnMoIG1lbnVFbGVtZW50LCBldmVudC50YXJnZXQgKTtcblx0fSxcblxuXHRfY2xvc2VPbkNsaWNrT3V0c2lkZTogZnVuY3Rpb24oIGV2ZW50ICkge1xuXHRcdGlmICggIXRoaXMuX2lzRXZlbnRUYXJnZXRJbldpZGdldCggZXZlbnQgKSApIHtcblx0XHRcdHRoaXMuY2xvc2UoKTtcblx0XHR9XG5cdH0sXG5cblx0X2FwcGVuZFRvOiBmdW5jdGlvbigpIHtcblx0XHR2YXIgZWxlbWVudCA9IHRoaXMub3B0aW9ucy5hcHBlbmRUbztcblxuXHRcdGlmICggZWxlbWVudCApIHtcblx0XHRcdGVsZW1lbnQgPSBlbGVtZW50LmpxdWVyeSB8fCBlbGVtZW50Lm5vZGVUeXBlID9cblx0XHRcdFx0JCggZWxlbWVudCApIDpcblx0XHRcdFx0dGhpcy5kb2N1bWVudC5maW5kKCBlbGVtZW50ICkuZXEoIDAgKTtcblx0XHR9XG5cblx0XHRpZiAoICFlbGVtZW50IHx8ICFlbGVtZW50WyAwIF0gKSB7XG5cdFx0XHRlbGVtZW50ID0gdGhpcy5lbGVtZW50LmNsb3Nlc3QoIFwiLnVpLWZyb250LCBkaWFsb2dcIiApO1xuXHRcdH1cblxuXHRcdGlmICggIWVsZW1lbnQubGVuZ3RoICkge1xuXHRcdFx0ZWxlbWVudCA9IHRoaXMuZG9jdW1lbnRbIDAgXS5ib2R5O1xuXHRcdH1cblxuXHRcdHJldHVybiBlbGVtZW50O1xuXHR9LFxuXG5cdF9pbml0U291cmNlOiBmdW5jdGlvbigpIHtcblx0XHR2YXIgYXJyYXksIHVybCxcblx0XHRcdHRoYXQgPSB0aGlzO1xuXHRcdGlmICggJC5pc0FycmF5KCB0aGlzLm9wdGlvbnMuc291cmNlICkgKSB7XG5cdFx0XHRhcnJheSA9IHRoaXMub3B0aW9ucy5zb3VyY2U7XG5cdFx0XHR0aGlzLnNvdXJjZSA9IGZ1bmN0aW9uKCByZXF1ZXN0LCByZXNwb25zZSApIHtcblx0XHRcdFx0cmVzcG9uc2UoICQudWkuYXV0b2NvbXBsZXRlLmZpbHRlciggYXJyYXksIHJlcXVlc3QudGVybSApICk7XG5cdFx0XHR9O1xuXHRcdH0gZWxzZSBpZiAoIHR5cGVvZiB0aGlzLm9wdGlvbnMuc291cmNlID09PSBcInN0cmluZ1wiICkge1xuXHRcdFx0dXJsID0gdGhpcy5vcHRpb25zLnNvdXJjZTtcblx0XHRcdHRoaXMuc291cmNlID0gZnVuY3Rpb24oIHJlcXVlc3QsIHJlc3BvbnNlICkge1xuXHRcdFx0XHRpZiAoIHRoYXQueGhyICkge1xuXHRcdFx0XHRcdHRoYXQueGhyLmFib3J0KCk7XG5cdFx0XHRcdH1cblx0XHRcdFx0dGhhdC54aHIgPSAkLmFqYXgoIHtcblx0XHRcdFx0XHR1cmw6IHVybCxcblx0XHRcdFx0XHRkYXRhOiByZXF1ZXN0LFxuXHRcdFx0XHRcdGRhdGFUeXBlOiBcImpzb25cIixcblx0XHRcdFx0XHRzdWNjZXNzOiBmdW5jdGlvbiggZGF0YSApIHtcblx0XHRcdFx0XHRcdHJlc3BvbnNlKCBkYXRhICk7XG5cdFx0XHRcdFx0fSxcblx0XHRcdFx0XHRlcnJvcjogZnVuY3Rpb24oKSB7XG5cdFx0XHRcdFx0XHRyZXNwb25zZSggW10gKTtcblx0XHRcdFx0XHR9XG5cdFx0XHRcdH0gKTtcblx0XHRcdH07XG5cdFx0fSBlbHNlIHtcblx0XHRcdHRoaXMuc291cmNlID0gdGhpcy5vcHRpb25zLnNvdXJjZTtcblx0XHR9XG5cdH0sXG5cblx0X3NlYXJjaFRpbWVvdXQ6IGZ1bmN0aW9uKCBldmVudCApIHtcblx0XHRjbGVhclRpbWVvdXQoIHRoaXMuc2VhcmNoaW5nICk7XG5cdFx0dGhpcy5zZWFyY2hpbmcgPSB0aGlzLl9kZWxheSggZnVuY3Rpb24oKSB7XG5cblx0XHRcdC8vIFNlYXJjaCBpZiB0aGUgdmFsdWUgaGFzIGNoYW5nZWQsIG9yIGlmIHRoZSB1c2VyIHJldHlwZXMgdGhlIHNhbWUgdmFsdWUgKHNlZSAjNzQzNClcblx0XHRcdHZhciBlcXVhbFZhbHVlcyA9IHRoaXMudGVybSA9PT0gdGhpcy5fdmFsdWUoKSxcblx0XHRcdFx0bWVudVZpc2libGUgPSB0aGlzLm1lbnUuZWxlbWVudC5pcyggXCI6dmlzaWJsZVwiICksXG5cdFx0XHRcdG1vZGlmaWVyS2V5ID0gZXZlbnQuYWx0S2V5IHx8IGV2ZW50LmN0cmxLZXkgfHwgZXZlbnQubWV0YUtleSB8fCBldmVudC5zaGlmdEtleTtcblxuXHRcdFx0aWYgKCAhZXF1YWxWYWx1ZXMgfHwgKCBlcXVhbFZhbHVlcyAmJiAhbWVudVZpc2libGUgJiYgIW1vZGlmaWVyS2V5ICkgKSB7XG5cdFx0XHRcdHRoaXMuc2VsZWN0ZWRJdGVtID0gbnVsbDtcblx0XHRcdFx0dGhpcy5zZWFyY2goIG51bGwsIGV2ZW50ICk7XG5cdFx0XHR9XG5cdFx0fSwgdGhpcy5vcHRpb25zLmRlbGF5ICk7XG5cdH0sXG5cblx0c2VhcmNoOiBmdW5jdGlvbiggdmFsdWUsIGV2ZW50ICkge1xuXHRcdHZhbHVlID0gdmFsdWUgIT0gbnVsbCA/IHZhbHVlIDogdGhpcy5fdmFsdWUoKTtcblxuXHRcdC8vIEFsd2F5cyBzYXZlIHRoZSBhY3R1YWwgdmFsdWUsIG5vdCB0aGUgb25lIHBhc3NlZCBhcyBhbiBhcmd1bWVudFxuXHRcdHRoaXMudGVybSA9IHRoaXMuX3ZhbHVlKCk7XG5cblx0XHRpZiAoIHZhbHVlLmxlbmd0aCA8IHRoaXMub3B0aW9ucy5taW5MZW5ndGggKSB7XG5cdFx0XHRyZXR1cm4gdGhpcy5jbG9zZSggZXZlbnQgKTtcblx0XHR9XG5cblx0XHRpZiAoIHRoaXMuX3RyaWdnZXIoIFwic2VhcmNoXCIsIGV2ZW50ICkgPT09IGZhbHNlICkge1xuXHRcdFx0cmV0dXJuO1xuXHRcdH1cblxuXHRcdHJldHVybiB0aGlzLl9zZWFyY2goIHZhbHVlICk7XG5cdH0sXG5cblx0X3NlYXJjaDogZnVuY3Rpb24oIHZhbHVlICkge1xuXHRcdHRoaXMucGVuZGluZysrO1xuXHRcdHRoaXMuX2FkZENsYXNzKCBcInVpLWF1dG9jb21wbGV0ZS1sb2FkaW5nXCIgKTtcblx0XHR0aGlzLmNhbmNlbFNlYXJjaCA9IGZhbHNlO1xuXG5cdFx0dGhpcy5zb3VyY2UoIHsgdGVybTogdmFsdWUgfSwgdGhpcy5fcmVzcG9uc2UoKSApO1xuXHR9LFxuXG5cdF9yZXNwb25zZTogZnVuY3Rpb24oKSB7XG5cdFx0dmFyIGluZGV4ID0gKyt0aGlzLnJlcXVlc3RJbmRleDtcblxuXHRcdHJldHVybiAkLnByb3h5KCBmdW5jdGlvbiggY29udGVudCApIHtcblx0XHRcdGlmICggaW5kZXggPT09IHRoaXMucmVxdWVzdEluZGV4ICkge1xuXHRcdFx0XHR0aGlzLl9fcmVzcG9uc2UoIGNvbnRlbnQgKTtcblx0XHRcdH1cblxuXHRcdFx0dGhpcy5wZW5kaW5nLS07XG5cdFx0XHRpZiAoICF0aGlzLnBlbmRpbmcgKSB7XG5cdFx0XHRcdHRoaXMuX3JlbW92ZUNsYXNzKCBcInVpLWF1dG9jb21wbGV0ZS1sb2FkaW5nXCIgKTtcblx0XHRcdH1cblx0XHR9LCB0aGlzICk7XG5cdH0sXG5cblx0X19yZXNwb25zZTogZnVuY3Rpb24oIGNvbnRlbnQgKSB7XG5cdFx0aWYgKCBjb250ZW50ICkge1xuXHRcdFx0Y29udGVudCA9IHRoaXMuX25vcm1hbGl6ZSggY29udGVudCApO1xuXHRcdH1cblx0XHR0aGlzLl90cmlnZ2VyKCBcInJlc3BvbnNlXCIsIG51bGwsIHsgY29udGVudDogY29udGVudCB9ICk7XG5cdFx0aWYgKCAhdGhpcy5vcHRpb25zLmRpc2FibGVkICYmIGNvbnRlbnQgJiYgY29udGVudC5sZW5ndGggJiYgIXRoaXMuY2FuY2VsU2VhcmNoICkge1xuXHRcdFx0dGhpcy5fc3VnZ2VzdCggY29udGVudCApO1xuXHRcdFx0dGhpcy5fdHJpZ2dlciggXCJvcGVuXCIgKTtcblx0XHR9IGVsc2Uge1xuXG5cdFx0XHQvLyB1c2UgLl9jbG9zZSgpIGluc3RlYWQgb2YgLmNsb3NlKCkgc28gd2UgZG9uJ3QgY2FuY2VsIGZ1dHVyZSBzZWFyY2hlc1xuXHRcdFx0dGhpcy5fY2xvc2UoKTtcblx0XHR9XG5cdH0sXG5cblx0Y2xvc2U6IGZ1bmN0aW9uKCBldmVudCApIHtcblx0XHR0aGlzLmNhbmNlbFNlYXJjaCA9IHRydWU7XG5cdFx0dGhpcy5fY2xvc2UoIGV2ZW50ICk7XG5cdH0sXG5cblx0X2Nsb3NlOiBmdW5jdGlvbiggZXZlbnQgKSB7XG5cblx0XHQvLyBSZW1vdmUgdGhlIGhhbmRsZXIgdGhhdCBjbG9zZXMgdGhlIG1lbnUgb24gb3V0c2lkZSBjbGlja3Ncblx0XHR0aGlzLl9vZmYoIHRoaXMuZG9jdW1lbnQsIFwibW91c2Vkb3duXCIgKTtcblxuXHRcdGlmICggdGhpcy5tZW51LmVsZW1lbnQuaXMoIFwiOnZpc2libGVcIiApICkge1xuXHRcdFx0dGhpcy5tZW51LmVsZW1lbnQuaGlkZSgpO1xuXHRcdFx0dGhpcy5tZW51LmJsdXIoKTtcblx0XHRcdHRoaXMuaXNOZXdNZW51ID0gdHJ1ZTtcblx0XHRcdHRoaXMuX3RyaWdnZXIoIFwiY2xvc2VcIiwgZXZlbnQgKTtcblx0XHR9XG5cdH0sXG5cblx0X2NoYW5nZTogZnVuY3Rpb24oIGV2ZW50ICkge1xuXHRcdGlmICggdGhpcy5wcmV2aW91cyAhPT0gdGhpcy5fdmFsdWUoKSApIHtcblx0XHRcdHRoaXMuX3RyaWdnZXIoIFwiY2hhbmdlXCIsIGV2ZW50LCB7IGl0ZW06IHRoaXMuc2VsZWN0ZWRJdGVtIH0gKTtcblx0XHR9XG5cdH0sXG5cblx0X25vcm1hbGl6ZTogZnVuY3Rpb24oIGl0ZW1zICkge1xuXG5cdFx0Ly8gYXNzdW1lIGFsbCBpdGVtcyBoYXZlIHRoZSByaWdodCBmb3JtYXQgd2hlbiB0aGUgZmlyc3QgaXRlbSBpcyBjb21wbGV0ZVxuXHRcdGlmICggaXRlbXMubGVuZ3RoICYmIGl0ZW1zWyAwIF0ubGFiZWwgJiYgaXRlbXNbIDAgXS52YWx1ZSApIHtcblx0XHRcdHJldHVybiBpdGVtcztcblx0XHR9XG5cdFx0cmV0dXJuICQubWFwKCBpdGVtcywgZnVuY3Rpb24oIGl0ZW0gKSB7XG5cdFx0XHRpZiAoIHR5cGVvZiBpdGVtID09PSBcInN0cmluZ1wiICkge1xuXHRcdFx0XHRyZXR1cm4ge1xuXHRcdFx0XHRcdGxhYmVsOiBpdGVtLFxuXHRcdFx0XHRcdHZhbHVlOiBpdGVtXG5cdFx0XHRcdH07XG5cdFx0XHR9XG5cdFx0XHRyZXR1cm4gJC5leHRlbmQoIHt9LCBpdGVtLCB7XG5cdFx0XHRcdGxhYmVsOiBpdGVtLmxhYmVsIHx8IGl0ZW0udmFsdWUsXG5cdFx0XHRcdHZhbHVlOiBpdGVtLnZhbHVlIHx8IGl0ZW0ubGFiZWxcblx0XHRcdH0gKTtcblx0XHR9ICk7XG5cdH0sXG5cblx0X3N1Z2dlc3Q6IGZ1bmN0aW9uKCBpdGVtcyApIHtcblx0XHR2YXIgdWwgPSB0aGlzLm1lbnUuZWxlbWVudC5lbXB0eSgpO1xuXHRcdHRoaXMuX3JlbmRlck1lbnUoIHVsLCBpdGVtcyApO1xuXHRcdHRoaXMuaXNOZXdNZW51ID0gdHJ1ZTtcblx0XHR0aGlzLm1lbnUucmVmcmVzaCgpO1xuXG5cdFx0Ly8gU2l6ZSBhbmQgcG9zaXRpb24gbWVudVxuXHRcdHVsLnNob3coKTtcblx0XHR0aGlzLl9yZXNpemVNZW51KCk7XG5cdFx0dWwucG9zaXRpb24oICQuZXh0ZW5kKCB7XG5cdFx0XHRvZjogdGhpcy5lbGVtZW50XG5cdFx0fSwgdGhpcy5vcHRpb25zLnBvc2l0aW9uICkgKTtcblxuXHRcdGlmICggdGhpcy5vcHRpb25zLmF1dG9Gb2N1cyApIHtcblx0XHRcdHRoaXMubWVudS5uZXh0KCk7XG5cdFx0fVxuXG5cdFx0Ly8gTGlzdGVuIGZvciBpbnRlcmFjdGlvbnMgb3V0c2lkZSBvZiB0aGUgd2lkZ2V0ICgjNjY0Milcblx0XHR0aGlzLl9vbiggdGhpcy5kb2N1bWVudCwge1xuXHRcdFx0bW91c2Vkb3duOiBcIl9jbG9zZU9uQ2xpY2tPdXRzaWRlXCJcblx0XHR9ICk7XG5cdH0sXG5cblx0X3Jlc2l6ZU1lbnU6IGZ1bmN0aW9uKCkge1xuXHRcdHZhciB1bCA9IHRoaXMubWVudS5lbGVtZW50O1xuXHRcdHVsLm91dGVyV2lkdGgoIE1hdGgubWF4KFxuXG5cdFx0XHQvLyBGaXJlZm94IHdyYXBzIGxvbmcgdGV4dCAocG9zc2libHkgYSByb3VuZGluZyBidWcpXG5cdFx0XHQvLyBzbyB3ZSBhZGQgMXB4IHRvIGF2b2lkIHRoZSB3cmFwcGluZyAoIzc1MTMpXG5cdFx0XHR1bC53aWR0aCggXCJcIiApLm91dGVyV2lkdGgoKSArIDEsXG5cdFx0XHR0aGlzLmVsZW1lbnQub3V0ZXJXaWR0aCgpXG5cdFx0KSApO1xuXHR9LFxuXG5cdF9yZW5kZXJNZW51OiBmdW5jdGlvbiggdWwsIGl0ZW1zICkge1xuXHRcdHZhciB0aGF0ID0gdGhpcztcblx0XHQkLmVhY2goIGl0ZW1zLCBmdW5jdGlvbiggaW5kZXgsIGl0ZW0gKSB7XG5cdFx0XHR0aGF0Ll9yZW5kZXJJdGVtRGF0YSggdWwsIGl0ZW0gKTtcblx0XHR9ICk7XG5cdH0sXG5cblx0X3JlbmRlckl0ZW1EYXRhOiBmdW5jdGlvbiggdWwsIGl0ZW0gKSB7XG5cdFx0cmV0dXJuIHRoaXMuX3JlbmRlckl0ZW0oIHVsLCBpdGVtICkuZGF0YSggXCJ1aS1hdXRvY29tcGxldGUtaXRlbVwiLCBpdGVtICk7XG5cdH0sXG5cblx0X3JlbmRlckl0ZW06IGZ1bmN0aW9uKCB1bCwgaXRlbSApIHtcblx0XHRyZXR1cm4gJCggXCI8bGk+XCIgKVxuXHRcdFx0LmFwcGVuZCggJCggXCI8ZGl2PlwiICkudGV4dCggaXRlbS5sYWJlbCApIClcblx0XHRcdC5hcHBlbmRUbyggdWwgKTtcblx0fSxcblxuXHRfbW92ZTogZnVuY3Rpb24oIGRpcmVjdGlvbiwgZXZlbnQgKSB7XG5cdFx0aWYgKCAhdGhpcy5tZW51LmVsZW1lbnQuaXMoIFwiOnZpc2libGVcIiApICkge1xuXHRcdFx0dGhpcy5zZWFyY2goIG51bGwsIGV2ZW50ICk7XG5cdFx0XHRyZXR1cm47XG5cdFx0fVxuXHRcdGlmICggdGhpcy5tZW51LmlzRmlyc3RJdGVtKCkgJiYgL15wcmV2aW91cy8udGVzdCggZGlyZWN0aW9uICkgfHxcblx0XHRcdFx0dGhpcy5tZW51LmlzTGFzdEl0ZW0oKSAmJiAvXm5leHQvLnRlc3QoIGRpcmVjdGlvbiApICkge1xuXG5cdFx0XHRpZiAoICF0aGlzLmlzTXVsdGlMaW5lICkge1xuXHRcdFx0XHR0aGlzLl92YWx1ZSggdGhpcy50ZXJtICk7XG5cdFx0XHR9XG5cblx0XHRcdHRoaXMubWVudS5ibHVyKCk7XG5cdFx0XHRyZXR1cm47XG5cdFx0fVxuXHRcdHRoaXMubWVudVsgZGlyZWN0aW9uIF0oIGV2ZW50ICk7XG5cdH0sXG5cblx0d2lkZ2V0OiBmdW5jdGlvbigpIHtcblx0XHRyZXR1cm4gdGhpcy5tZW51LmVsZW1lbnQ7XG5cdH0sXG5cblx0X3ZhbHVlOiBmdW5jdGlvbigpIHtcblx0XHRyZXR1cm4gdGhpcy52YWx1ZU1ldGhvZC5hcHBseSggdGhpcy5lbGVtZW50LCBhcmd1bWVudHMgKTtcblx0fSxcblxuXHRfa2V5RXZlbnQ6IGZ1bmN0aW9uKCBrZXlFdmVudCwgZXZlbnQgKSB7XG5cdFx0aWYgKCAhdGhpcy5pc011bHRpTGluZSB8fCB0aGlzLm1lbnUuZWxlbWVudC5pcyggXCI6dmlzaWJsZVwiICkgKSB7XG5cdFx0XHR0aGlzLl9tb3ZlKCBrZXlFdmVudCwgZXZlbnQgKTtcblxuXHRcdFx0Ly8gUHJldmVudHMgbW92aW5nIGN1cnNvciB0byBiZWdpbm5pbmcvZW5kIG9mIHRoZSB0ZXh0IGZpZWxkIGluIHNvbWUgYnJvd3NlcnNcblx0XHRcdGV2ZW50LnByZXZlbnREZWZhdWx0KCk7XG5cdFx0fVxuXHR9LFxuXG5cdC8vIFN1cHBvcnQ6IENocm9tZSA8PTUwXG5cdC8vIFdlIHNob3VsZCBiZSBhYmxlIHRvIGp1c3QgdXNlIHRoaXMuZWxlbWVudC5wcm9wKCBcImlzQ29udGVudEVkaXRhYmxlXCIgKVxuXHQvLyBidXQgaGlkZGVuIGVsZW1lbnRzIGFsd2F5cyByZXBvcnQgZmFsc2UgaW4gQ2hyb21lLlxuXHQvLyBodHRwczovL2NvZGUuZ29vZ2xlLmNvbS9wL2Nocm9taXVtL2lzc3Vlcy9kZXRhaWw/aWQ9MzEzMDgyXG5cdF9pc0NvbnRlbnRFZGl0YWJsZTogZnVuY3Rpb24oIGVsZW1lbnQgKSB7XG5cdFx0aWYgKCAhZWxlbWVudC5sZW5ndGggKSB7XG5cdFx0XHRyZXR1cm4gZmFsc2U7XG5cdFx0fVxuXG5cdFx0dmFyIGVkaXRhYmxlID0gZWxlbWVudC5wcm9wKCBcImNvbnRlbnRFZGl0YWJsZVwiICk7XG5cblx0XHRpZiAoIGVkaXRhYmxlID09PSBcImluaGVyaXRcIiApIHtcblx0XHQgIHJldHVybiB0aGlzLl9pc0NvbnRlbnRFZGl0YWJsZSggZWxlbWVudC5wYXJlbnQoKSApO1xuXHRcdH1cblxuXHRcdHJldHVybiBlZGl0YWJsZSA9PT0gXCJ0cnVlXCI7XG5cdH1cbn0gKTtcblxuJC5leHRlbmQoICQudWkuYXV0b2NvbXBsZXRlLCB7XG5cdGVzY2FwZVJlZ2V4OiBmdW5jdGlvbiggdmFsdWUgKSB7XG5cdFx0cmV0dXJuIHZhbHVlLnJlcGxhY2UoIC9bXFwtXFxbXFxde30oKSorPy4sXFxcXFxcXiR8I1xcc10vZywgXCJcXFxcJCZcIiApO1xuXHR9LFxuXHRmaWx0ZXI6IGZ1bmN0aW9uKCBhcnJheSwgdGVybSApIHtcblx0XHR2YXIgbWF0Y2hlciA9IG5ldyBSZWdFeHAoICQudWkuYXV0b2NvbXBsZXRlLmVzY2FwZVJlZ2V4KCB0ZXJtICksIFwiaVwiICk7XG5cdFx0cmV0dXJuICQuZ3JlcCggYXJyYXksIGZ1bmN0aW9uKCB2YWx1ZSApIHtcblx0XHRcdHJldHVybiBtYXRjaGVyLnRlc3QoIHZhbHVlLmxhYmVsIHx8IHZhbHVlLnZhbHVlIHx8IHZhbHVlICk7XG5cdFx0fSApO1xuXHR9XG59ICk7XG5cbi8vIExpdmUgcmVnaW9uIGV4dGVuc2lvbiwgYWRkaW5nIGEgYG1lc3NhZ2VzYCBvcHRpb25cbi8vIE5PVEU6IFRoaXMgaXMgYW4gZXhwZXJpbWVudGFsIEFQSS4gV2UgYXJlIHN0aWxsIGludmVzdGlnYXRpbmdcbi8vIGEgZnVsbCBzb2x1dGlvbiBmb3Igc3RyaW5nIG1hbmlwdWxhdGlvbiBhbmQgaW50ZXJuYXRpb25hbGl6YXRpb24uXG4kLndpZGdldCggXCJ1aS5hdXRvY29tcGxldGVcIiwgJC51aS5hdXRvY29tcGxldGUsIHtcblx0b3B0aW9uczoge1xuXHRcdG1lc3NhZ2VzOiB7XG5cdFx0XHRub1Jlc3VsdHM6IFwiTm8gc2VhcmNoIHJlc3VsdHMuXCIsXG5cdFx0XHRyZXN1bHRzOiBmdW5jdGlvbiggYW1vdW50ICkge1xuXHRcdFx0XHRyZXR1cm4gYW1vdW50ICsgKCBhbW91bnQgPiAxID8gXCIgcmVzdWx0cyBhcmVcIiA6IFwiIHJlc3VsdCBpc1wiICkgK1xuXHRcdFx0XHRcdFwiIGF2YWlsYWJsZSwgdXNlIHVwIGFuZCBkb3duIGFycm93IGtleXMgdG8gbmF2aWdhdGUuXCI7XG5cdFx0XHR9XG5cdFx0fVxuXHR9LFxuXG5cdF9fcmVzcG9uc2U6IGZ1bmN0aW9uKCBjb250ZW50ICkge1xuXHRcdHZhciBtZXNzYWdlO1xuXHRcdHRoaXMuX3N1cGVyQXBwbHkoIGFyZ3VtZW50cyApO1xuXHRcdGlmICggdGhpcy5vcHRpb25zLmRpc2FibGVkIHx8IHRoaXMuY2FuY2VsU2VhcmNoICkge1xuXHRcdFx0cmV0dXJuO1xuXHRcdH1cblx0XHRpZiAoIGNvbnRlbnQgJiYgY29udGVudC5sZW5ndGggKSB7XG5cdFx0XHRtZXNzYWdlID0gdGhpcy5vcHRpb25zLm1lc3NhZ2VzLnJlc3VsdHMoIGNvbnRlbnQubGVuZ3RoICk7XG5cdFx0fSBlbHNlIHtcblx0XHRcdG1lc3NhZ2UgPSB0aGlzLm9wdGlvbnMubWVzc2FnZXMubm9SZXN1bHRzO1xuXHRcdH1cblx0XHR0aGlzLmxpdmVSZWdpb24uY2hpbGRyZW4oKS5oaWRlKCk7XG5cdFx0JCggXCI8ZGl2PlwiICkudGV4dCggbWVzc2FnZSApLmFwcGVuZFRvKCB0aGlzLmxpdmVSZWdpb24gKTtcblx0fVxufSApO1xuXG5yZXR1cm4gJC51aS5hdXRvY29tcGxldGU7XG5cbn0gKSApO1xuIiwiLyohXG4gKiBqUXVlcnkgVUkgQnV0dG9uIDEuMTIuMFxuICogaHR0cDovL2pxdWVyeXVpLmNvbVxuICpcbiAqIENvcHlyaWdodCBqUXVlcnkgRm91bmRhdGlvbiBhbmQgb3RoZXIgY29udHJpYnV0b3JzXG4gKiBSZWxlYXNlZCB1bmRlciB0aGUgTUlUIGxpY2Vuc2UuXG4gKiBodHRwOi8vanF1ZXJ5Lm9yZy9saWNlbnNlXG4gKi9cblxuLy8+PmxhYmVsOiBCdXR0b25cbi8vPj5ncm91cDogV2lkZ2V0c1xuLy8+PmRlc2NyaXB0aW9uOiBFbmhhbmNlcyBhIGZvcm0gd2l0aCB0aGVtZWFibGUgYnV0dG9ucy5cbi8vPj5kb2NzOiBodHRwOi8vYXBpLmpxdWVyeXVpLmNvbS9idXR0b24vXG4vLz4+ZGVtb3M6IGh0dHA6Ly9qcXVlcnl1aS5jb20vYnV0dG9uL1xuLy8+PmNzcy5zdHJ1Y3R1cmU6IC4uLy4uL3RoZW1lcy9iYXNlL2NvcmUuY3NzXG4vLz4+Y3NzLnN0cnVjdHVyZTogLi4vLi4vdGhlbWVzL2Jhc2UvYnV0dG9uLmNzc1xuLy8+PmNzcy50aGVtZTogLi4vLi4vdGhlbWVzL2Jhc2UvdGhlbWUuY3NzXG5cbiggZnVuY3Rpb24oIGZhY3RvcnkgKSB7XG5cdGlmICggdHlwZW9mIGRlZmluZSA9PT0gXCJmdW5jdGlvblwiICYmIGRlZmluZS5hbWQgKSB7XG5cblx0XHQvLyBBTUQuIFJlZ2lzdGVyIGFzIGFuIGFub255bW91cyBtb2R1bGUuXG5cdFx0ZGVmaW5lKCBbXG5cdFx0XHRcImpxdWVyeVwiLFxuXG5cdFx0XHQvLyBUaGVzZSBhcmUgb25seSBmb3IgYmFja2NvbXBhdFxuXHRcdFx0Ly8gVE9ETzogUmVtb3ZlIGFmdGVyIDEuMTJcblx0XHRcdFwiLi9jb250cm9sZ3JvdXBcIixcblx0XHRcdFwiLi9jaGVja2JveHJhZGlvXCIsXG5cblx0XHRcdFwiLi4va2V5Y29kZVwiLFxuXHRcdFx0XCIuLi93aWRnZXRcIlxuXHRcdF0sIGZhY3RvcnkgKTtcblx0fSBlbHNlIHtcblxuXHRcdC8vIEJyb3dzZXIgZ2xvYmFsc1xuXHRcdGZhY3RvcnkoIGpRdWVyeSApO1xuXHR9XG59KCBmdW5jdGlvbiggJCApIHtcblxuJC53aWRnZXQoIFwidWkuYnV0dG9uXCIsIHtcblx0dmVyc2lvbjogXCIxLjEyLjBcIixcblx0ZGVmYXVsdEVsZW1lbnQ6IFwiPGJ1dHRvbj5cIixcblx0b3B0aW9uczoge1xuXHRcdGNsYXNzZXM6IHtcblx0XHRcdFwidWktYnV0dG9uXCI6IFwidWktY29ybmVyLWFsbFwiXG5cdFx0fSxcblx0XHRkaXNhYmxlZDogbnVsbCxcblx0XHRpY29uOiBudWxsLFxuXHRcdGljb25Qb3NpdGlvbjogXCJiZWdpbm5pbmdcIixcblx0XHRsYWJlbDogbnVsbCxcblx0XHRzaG93TGFiZWw6IHRydWVcblx0fSxcblxuXHRfZ2V0Q3JlYXRlT3B0aW9uczogZnVuY3Rpb24oKSB7XG5cdFx0dmFyIGRpc2FibGVkLFxuXG5cdFx0XHQvLyBUaGlzIGlzIHRvIHN1cHBvcnQgY2FzZXMgbGlrZSBpbiBqUXVlcnkgTW9iaWxlIHdoZXJlIHRoZSBiYXNlIHdpZGdldCBkb2VzIGhhdmVcblx0XHRcdC8vIGFuIGltcGxlbWVudGF0aW9uIG9mIF9nZXRDcmVhdGVPcHRpb25zXG5cdFx0XHRvcHRpb25zID0gdGhpcy5fc3VwZXIoKSB8fCB7fTtcblxuXHRcdHRoaXMuaXNJbnB1dCA9IHRoaXMuZWxlbWVudC5pcyggXCJpbnB1dFwiICk7XG5cblx0XHRkaXNhYmxlZCA9IHRoaXMuZWxlbWVudFsgMCBdLmRpc2FibGVkO1xuXHRcdGlmICggZGlzYWJsZWQgIT0gbnVsbCApIHtcblx0XHRcdG9wdGlvbnMuZGlzYWJsZWQgPSBkaXNhYmxlZDtcblx0XHR9XG5cblx0XHR0aGlzLm9yaWdpbmFsTGFiZWwgPSB0aGlzLmlzSW5wdXQgPyB0aGlzLmVsZW1lbnQudmFsKCkgOiB0aGlzLmVsZW1lbnQuaHRtbCgpO1xuXHRcdGlmICggdGhpcy5vcmlnaW5hbExhYmVsICkge1xuXHRcdFx0b3B0aW9ucy5sYWJlbCA9IHRoaXMub3JpZ2luYWxMYWJlbDtcblx0XHR9XG5cblx0XHRyZXR1cm4gb3B0aW9ucztcblx0fSxcblxuXHRfY3JlYXRlOiBmdW5jdGlvbigpIHtcblx0XHRpZiAoICF0aGlzLm9wdGlvbi5zaG93TGFiZWwgJiAhdGhpcy5vcHRpb25zLmljb24gKSB7XG5cdFx0XHR0aGlzLm9wdGlvbnMuc2hvd0xhYmVsID0gdHJ1ZTtcblx0XHR9XG5cblx0XHQvLyBXZSBoYXZlIHRvIGNoZWNrIHRoZSBvcHRpb24gYWdhaW4gaGVyZSBldmVuIHRob3VnaCB3ZSBkaWQgaW4gX2dldENyZWF0ZU9wdGlvbnMsXG5cdFx0Ly8gYmVjYXVzZSBudWxsIG1heSBoYXZlIGJlZW4gcGFzc2VkIG9uIGluaXQgd2hpY2ggd291bGQgb3ZlcnJpZGUgd2hhdCB3YXMgc2V0IGluXG5cdFx0Ly8gX2dldENyZWF0ZU9wdGlvbnNcblx0XHRpZiAoIHRoaXMub3B0aW9ucy5kaXNhYmxlZCA9PSBudWxsICkge1xuXHRcdFx0dGhpcy5vcHRpb25zLmRpc2FibGVkID0gdGhpcy5lbGVtZW50WyAwIF0uZGlzYWJsZWQgfHwgZmFsc2U7XG5cdFx0fVxuXG5cdFx0dGhpcy5oYXNUaXRsZSA9ICEhdGhpcy5lbGVtZW50LmF0dHIoIFwidGl0bGVcIiApO1xuXG5cdFx0Ly8gQ2hlY2sgdG8gc2VlIGlmIHRoZSBsYWJlbCBuZWVkcyB0byBiZSBzZXQgb3IgaWYgaXRzIGFscmVhZHkgY29ycmVjdFxuXHRcdGlmICggdGhpcy5vcHRpb25zLmxhYmVsICYmIHRoaXMub3B0aW9ucy5sYWJlbCAhPT0gdGhpcy5vcmlnaW5hbExhYmVsICkge1xuXHRcdFx0aWYgKCB0aGlzLmlzSW5wdXQgKSB7XG5cdFx0XHRcdHRoaXMuZWxlbWVudC52YWwoIHRoaXMub3B0aW9ucy5sYWJlbCApO1xuXHRcdFx0fSBlbHNlIHtcblx0XHRcdFx0dGhpcy5lbGVtZW50Lmh0bWwoIHRoaXMub3B0aW9ucy5sYWJlbCApO1xuXHRcdFx0fVxuXHRcdH1cblx0XHR0aGlzLl9hZGRDbGFzcyggXCJ1aS1idXR0b25cIiwgXCJ1aS13aWRnZXRcIiApO1xuXHRcdHRoaXMuX3NldE9wdGlvbiggXCJkaXNhYmxlZFwiLCB0aGlzLm9wdGlvbnMuZGlzYWJsZWQgKTtcblx0XHR0aGlzLl9lbmhhbmNlKCk7XG5cblx0XHRpZiAoIHRoaXMuZWxlbWVudC5pcyggXCJhXCIgKSApIHtcblx0XHRcdHRoaXMuX29uKCB7XG5cdFx0XHRcdFwia2V5dXBcIjogZnVuY3Rpb24oIGV2ZW50ICkge1xuXHRcdFx0XHRcdGlmICggZXZlbnQua2V5Q29kZSA9PT0gJC51aS5rZXlDb2RlLlNQQUNFICkge1xuXHRcdFx0XHRcdFx0ZXZlbnQucHJldmVudERlZmF1bHQoKTtcblxuXHRcdFx0XHRcdFx0Ly8gU3VwcG9ydDogUGhhbnRvbUpTIDw9IDEuOSwgSUUgOCBPbmx5XG5cdFx0XHRcdFx0XHQvLyBJZiBhIG5hdGl2ZSBjbGljayBpcyBhdmFpbGFibGUgdXNlIGl0IHNvIHdlIGFjdHVhbGx5IGNhdXNlIG5hdmlnYXRpb25cblx0XHRcdFx0XHRcdC8vIG90aGVyd2lzZSBqdXN0IHRyaWdnZXIgYSBjbGljayBldmVudFxuXHRcdFx0XHRcdFx0aWYgKCB0aGlzLmVsZW1lbnRbIDAgXS5jbGljayApIHtcblx0XHRcdFx0XHRcdFx0dGhpcy5lbGVtZW50WyAwIF0uY2xpY2soKTtcblx0XHRcdFx0XHRcdH0gZWxzZSB7XG5cdFx0XHRcdFx0XHRcdHRoaXMuZWxlbWVudC50cmlnZ2VyKCBcImNsaWNrXCIgKTtcblx0XHRcdFx0XHRcdH1cblx0XHRcdFx0XHR9XG5cdFx0XHRcdH1cblx0XHRcdH0gKTtcblx0XHR9XG5cdH0sXG5cblx0X2VuaGFuY2U6IGZ1bmN0aW9uKCkge1xuXHRcdGlmICggIXRoaXMuZWxlbWVudC5pcyggXCJidXR0b25cIiApICkge1xuXHRcdFx0dGhpcy5lbGVtZW50LmF0dHIoIFwicm9sZVwiLCBcImJ1dHRvblwiICk7XG5cdFx0fVxuXG5cdFx0aWYgKCB0aGlzLm9wdGlvbnMuaWNvbiApIHtcblx0XHRcdHRoaXMuX3VwZGF0ZUljb24oIFwiaWNvblwiLCB0aGlzLm9wdGlvbnMuaWNvbiApO1xuXHRcdFx0dGhpcy5fdXBkYXRlVG9vbHRpcCgpO1xuXHRcdH1cblx0fSxcblxuXHRfdXBkYXRlVG9vbHRpcDogZnVuY3Rpb24oKSB7XG5cdFx0dGhpcy50aXRsZSA9IHRoaXMuZWxlbWVudC5hdHRyKCBcInRpdGxlXCIgKTtcblxuXHRcdGlmICggIXRoaXMub3B0aW9ucy5zaG93TGFiZWwgJiYgIXRoaXMudGl0bGUgKSB7XG5cdFx0XHR0aGlzLmVsZW1lbnQuYXR0ciggXCJ0aXRsZVwiLCB0aGlzLm9wdGlvbnMubGFiZWwgKTtcblx0XHR9XG5cdH0sXG5cblx0X3VwZGF0ZUljb246IGZ1bmN0aW9uKCBvcHRpb24sIHZhbHVlICkge1xuXHRcdHZhciBpY29uID0gb3B0aW9uICE9PSBcImljb25Qb3NpdGlvblwiLFxuXHRcdFx0cG9zaXRpb24gPSBpY29uID8gdGhpcy5vcHRpb25zLmljb25Qb3NpdGlvbiA6IHZhbHVlLFxuXHRcdFx0ZGlzcGxheUJsb2NrID0gcG9zaXRpb24gPT09IFwidG9wXCIgfHwgcG9zaXRpb24gPT09IFwiYm90dG9tXCI7XG5cblx0XHQvLyBDcmVhdGUgaWNvblxuXHRcdGlmICggIXRoaXMuaWNvbiApIHtcblx0XHRcdHRoaXMuaWNvbiA9ICQoIFwiPHNwYW4+XCIgKTtcblxuXHRcdFx0dGhpcy5fYWRkQ2xhc3MoIHRoaXMuaWNvbiwgXCJ1aS1idXR0b24taWNvblwiLCBcInVpLWljb25cIiApO1xuXG5cdFx0XHRpZiAoICF0aGlzLm9wdGlvbnMuc2hvd0xhYmVsICkge1xuXHRcdFx0XHR0aGlzLl9hZGRDbGFzcyggXCJ1aS1idXR0b24taWNvbi1vbmx5XCIgKTtcblx0XHRcdH1cblx0XHR9IGVsc2UgaWYgKCBpY29uICkge1xuXG5cdFx0XHQvLyBJZiB3ZSBhcmUgdXBkYXRpbmcgdGhlIGljb24gcmVtb3ZlIHRoZSBvbGQgaWNvbiBjbGFzc1xuXHRcdFx0dGhpcy5fcmVtb3ZlQ2xhc3MoIHRoaXMuaWNvbiwgbnVsbCwgdGhpcy5vcHRpb25zLmljb24gKTtcblx0XHR9XG5cblx0XHQvLyBJZiB3ZSBhcmUgdXBkYXRpbmcgdGhlIGljb24gYWRkIHRoZSBuZXcgaWNvbiBjbGFzc1xuXHRcdGlmICggaWNvbiApIHtcblx0XHRcdHRoaXMuX2FkZENsYXNzKCB0aGlzLmljb24sIG51bGwsIHZhbHVlICk7XG5cdFx0fVxuXG5cdFx0dGhpcy5fYXR0YWNoSWNvbiggcG9zaXRpb24gKTtcblxuXHRcdC8vIElmIHRoZSBpY29uIGlzIG9uIHRvcCBvciBib3R0b20gd2UgbmVlZCB0byBhZGQgdGhlIHVpLXdpZGdldC1pY29uLWJsb2NrIGNsYXNzIGFuZCByZW1vdmVcblx0XHQvLyB0aGUgaWNvblNwYWNlIGlmIHRoZXJlIGlzIG9uZS5cblx0XHRpZiAoIGRpc3BsYXlCbG9jayApIHtcblx0XHRcdHRoaXMuX2FkZENsYXNzKCB0aGlzLmljb24sIG51bGwsIFwidWktd2lkZ2V0LWljb24tYmxvY2tcIiApO1xuXHRcdFx0aWYgKCB0aGlzLmljb25TcGFjZSApIHtcblx0XHRcdFx0dGhpcy5pY29uU3BhY2UucmVtb3ZlKCk7XG5cdFx0XHR9XG5cdFx0fSBlbHNlIHtcblxuXHRcdFx0Ly8gUG9zaXRpb24gaXMgYmVnaW5uaW5nIG9yIGVuZCBzbyByZW1vdmUgdGhlIHVpLXdpZGdldC1pY29uLWJsb2NrIGNsYXNzIGFuZCBhZGQgdGhlXG5cdFx0XHQvLyBzcGFjZSBpZiBpdCBkb2VzIG5vdCBleGlzdFxuXHRcdFx0aWYgKCAhdGhpcy5pY29uU3BhY2UgKSB7XG5cdFx0XHRcdHRoaXMuaWNvblNwYWNlID0gJCggXCI8c3Bhbj4gPC9zcGFuPlwiICk7XG5cdFx0XHRcdHRoaXMuX2FkZENsYXNzKCB0aGlzLmljb25TcGFjZSwgXCJ1aS1idXR0b24taWNvbi1zcGFjZVwiICk7XG5cdFx0XHR9XG5cdFx0XHR0aGlzLl9yZW1vdmVDbGFzcyggdGhpcy5pY29uLCBudWxsLCBcInVpLXdpZ2V0LWljb24tYmxvY2tcIiApO1xuXHRcdFx0dGhpcy5fYXR0YWNoSWNvblNwYWNlKCBwb3NpdGlvbiApO1xuXHRcdH1cblx0fSxcblxuXHRfZGVzdHJveTogZnVuY3Rpb24oKSB7XG5cdFx0dGhpcy5lbGVtZW50LnJlbW92ZUF0dHIoIFwicm9sZVwiICk7XG5cblx0XHRpZiAoIHRoaXMuaWNvbiApIHtcblx0XHRcdHRoaXMuaWNvbi5yZW1vdmUoKTtcblx0XHR9XG5cdFx0aWYgKCB0aGlzLmljb25TcGFjZSApIHtcblx0XHRcdHRoaXMuaWNvblNwYWNlLnJlbW92ZSgpO1xuXHRcdH1cblx0XHRpZiAoICF0aGlzLmhhc1RpdGxlICkge1xuXHRcdFx0dGhpcy5lbGVtZW50LnJlbW92ZUF0dHIoIFwidGl0bGVcIiApO1xuXHRcdH1cblx0fSxcblxuXHRfYXR0YWNoSWNvblNwYWNlOiBmdW5jdGlvbiggaWNvblBvc2l0aW9uICkge1xuXHRcdHRoaXMuaWNvblsgL14oPzplbmR8Ym90dG9tKS8udGVzdCggaWNvblBvc2l0aW9uICkgPyBcImJlZm9yZVwiIDogXCJhZnRlclwiIF0oIHRoaXMuaWNvblNwYWNlICk7XG5cdH0sXG5cblx0X2F0dGFjaEljb246IGZ1bmN0aW9uKCBpY29uUG9zaXRpb24gKSB7XG5cdFx0dGhpcy5lbGVtZW50WyAvXig/OmVuZHxib3R0b20pLy50ZXN0KCBpY29uUG9zaXRpb24gKSA/IFwiYXBwZW5kXCIgOiBcInByZXBlbmRcIiBdKCB0aGlzLmljb24gKTtcblx0fSxcblxuXHRfc2V0T3B0aW9uczogZnVuY3Rpb24oIG9wdGlvbnMgKSB7XG5cdFx0dmFyIG5ld1Nob3dMYWJlbCA9IG9wdGlvbnMuc2hvd0xhYmVsID09PSB1bmRlZmluZWQgP1xuXHRcdFx0XHR0aGlzLm9wdGlvbnMuc2hvd0xhYmVsIDpcblx0XHRcdFx0b3B0aW9ucy5zaG93TGFiZWwsXG5cdFx0XHRuZXdJY29uID0gb3B0aW9ucy5pY29uID09PSB1bmRlZmluZWQgPyB0aGlzLm9wdGlvbnMuaWNvbiA6IG9wdGlvbnMuaWNvbjtcblxuXHRcdGlmICggIW5ld1Nob3dMYWJlbCAmJiAhbmV3SWNvbiApIHtcblx0XHRcdG9wdGlvbnMuc2hvd0xhYmVsID0gdHJ1ZTtcblx0XHR9XG5cdFx0dGhpcy5fc3VwZXIoIG9wdGlvbnMgKTtcblx0fSxcblxuXHRfc2V0T3B0aW9uOiBmdW5jdGlvbigga2V5LCB2YWx1ZSApIHtcblx0XHRpZiAoIGtleSA9PT0gXCJpY29uXCIgKSB7XG5cdFx0XHRpZiAoIHZhbHVlICkge1xuXHRcdFx0XHR0aGlzLl91cGRhdGVJY29uKCBrZXksIHZhbHVlICk7XG5cdFx0XHR9IGVsc2UgaWYgKCB0aGlzLmljb24gKSB7XG5cdFx0XHRcdHRoaXMuaWNvbi5yZW1vdmUoKTtcblx0XHRcdFx0aWYgKCB0aGlzLmljb25TcGFjZSApIHtcblx0XHRcdFx0XHR0aGlzLmljb25TcGFjZS5yZW1vdmUoKTtcblx0XHRcdFx0fVxuXHRcdFx0fVxuXHRcdH1cblxuXHRcdGlmICgga2V5ID09PSBcImljb25Qb3NpdGlvblwiICkge1xuXHRcdFx0dGhpcy5fdXBkYXRlSWNvbigga2V5LCB2YWx1ZSApO1xuXHRcdH1cblxuXHRcdC8vIE1ha2Ugc3VyZSB3ZSBjYW4ndCBlbmQgdXAgd2l0aCBhIGJ1dHRvbiB0aGF0IGhhcyBuZWl0aGVyIHRleHQgbm9yIGljb25cblx0XHRpZiAoIGtleSA9PT0gXCJzaG93TGFiZWxcIiApIHtcblx0XHRcdFx0dGhpcy5fdG9nZ2xlQ2xhc3MoIFwidWktYnV0dG9uLWljb24tb25seVwiLCBudWxsLCAhdmFsdWUgKTtcblx0XHRcdFx0dGhpcy5fdXBkYXRlVG9vbHRpcCgpO1xuXHRcdH1cblxuXHRcdGlmICgga2V5ID09PSBcImxhYmVsXCIgKSB7XG5cdFx0XHRpZiAoIHRoaXMuaXNJbnB1dCApIHtcblx0XHRcdFx0dGhpcy5lbGVtZW50LnZhbCggdmFsdWUgKTtcblx0XHRcdH0gZWxzZSB7XG5cblx0XHRcdFx0Ly8gSWYgdGhlcmUgaXMgYW4gaWNvbiwgYXBwZW5kIGl0LCBlbHNlIG5vdGhpbmcgdGhlbiBhcHBlbmQgdGhlIHZhbHVlXG5cdFx0XHRcdC8vIHRoaXMgYXZvaWRzIHJlbW92YWwgb2YgdGhlIGljb24gd2hlbiBzZXR0aW5nIGxhYmVsIHRleHRcblx0XHRcdFx0dGhpcy5lbGVtZW50Lmh0bWwoIHZhbHVlICk7XG5cdFx0XHRcdGlmICggdGhpcy5pY29uICkge1xuXHRcdFx0XHRcdHRoaXMuX2F0dGFjaEljb24oIHRoaXMub3B0aW9ucy5pY29uUG9zaXRpb24gKTtcblx0XHRcdFx0XHR0aGlzLl9hdHRhY2hJY29uU3BhY2UoIHRoaXMub3B0aW9ucy5pY29uUG9zaXRpb24gKTtcblx0XHRcdFx0fVxuXHRcdFx0fVxuXHRcdH1cblxuXHRcdHRoaXMuX3N1cGVyKCBrZXksIHZhbHVlICk7XG5cblx0XHRpZiAoIGtleSA9PT0gXCJkaXNhYmxlZFwiICkge1xuXHRcdFx0dGhpcy5fdG9nZ2xlQ2xhc3MoIG51bGwsIFwidWktc3RhdGUtZGlzYWJsZWRcIiwgdmFsdWUgKTtcblx0XHRcdHRoaXMuZWxlbWVudFsgMCBdLmRpc2FibGVkID0gdmFsdWU7XG5cdFx0XHRpZiAoIHZhbHVlICkge1xuXHRcdFx0XHR0aGlzLmVsZW1lbnQuYmx1cigpO1xuXHRcdFx0fVxuXHRcdH1cblx0fSxcblxuXHRyZWZyZXNoOiBmdW5jdGlvbigpIHtcblxuXHRcdC8vIE1ha2Ugc3VyZSB0byBvbmx5IGNoZWNrIGRpc2FibGVkIGlmIGl0cyBhbiBlbGVtZW50IHRoYXQgc3VwcG9ydHMgdGhpcyBvdGhlcndpc2Vcblx0XHQvLyBjaGVjayBmb3IgdGhlIGRpc2FibGVkIGNsYXNzIHRvIGRldGVybWluZSBzdGF0ZVxuXHRcdHZhciBpc0Rpc2FibGVkID0gdGhpcy5lbGVtZW50LmlzKCBcImlucHV0LCBidXR0b25cIiApID9cblx0XHRcdHRoaXMuZWxlbWVudFsgMCBdLmRpc2FibGVkIDogdGhpcy5lbGVtZW50Lmhhc0NsYXNzKCBcInVpLWJ1dHRvbi1kaXNhYmxlZFwiICk7XG5cblx0XHRpZiAoIGlzRGlzYWJsZWQgIT09IHRoaXMub3B0aW9ucy5kaXNhYmxlZCApIHtcblx0XHRcdHRoaXMuX3NldE9wdGlvbnMoIHsgZGlzYWJsZWQ6IGlzRGlzYWJsZWQgfSApO1xuXHRcdH1cblxuXHRcdHRoaXMuX3VwZGF0ZVRvb2x0aXAoKTtcblx0fVxufSApO1xuXG4vLyBERVBSRUNBVEVEXG5pZiAoICQudWlCYWNrQ29tcGF0ICE9PSBmYWxzZSApIHtcblxuXHQvLyBUZXh0IGFuZCBJY29ucyBvcHRpb25zXG5cdCQud2lkZ2V0KCBcInVpLmJ1dHRvblwiLCAkLnVpLmJ1dHRvbiwge1xuXHRcdG9wdGlvbnM6IHtcblx0XHRcdHRleHQ6IHRydWUsXG5cdFx0XHRpY29uczoge1xuXHRcdFx0XHRwcmltYXJ5OiBudWxsLFxuXHRcdFx0XHRzZWNvbmRhcnk6IG51bGxcblx0XHRcdH1cblx0XHR9LFxuXG5cdFx0X2NyZWF0ZTogZnVuY3Rpb24oKSB7XG5cdFx0XHRpZiAoIHRoaXMub3B0aW9ucy5zaG93TGFiZWwgJiYgIXRoaXMub3B0aW9ucy50ZXh0ICkge1xuXHRcdFx0XHR0aGlzLm9wdGlvbnMuc2hvd0xhYmVsID0gdGhpcy5vcHRpb25zLnRleHQ7XG5cdFx0XHR9XG5cdFx0XHRpZiAoICF0aGlzLm9wdGlvbnMuc2hvd0xhYmVsICYmIHRoaXMub3B0aW9ucy50ZXh0ICkge1xuXHRcdFx0XHR0aGlzLm9wdGlvbnMudGV4dCA9IHRoaXMub3B0aW9ucy5zaG93TGFiZWw7XG5cdFx0XHR9XG5cdFx0XHRpZiAoICF0aGlzLm9wdGlvbnMuaWNvbiAmJiAoIHRoaXMub3B0aW9ucy5pY29ucy5wcmltYXJ5IHx8XG5cdFx0XHRcdFx0dGhpcy5vcHRpb25zLmljb25zLnNlY29uZGFyeSApICkge1xuXHRcdFx0XHRpZiAoIHRoaXMub3B0aW9ucy5pY29ucy5wcmltYXJ5ICkge1xuXHRcdFx0XHRcdHRoaXMub3B0aW9ucy5pY29uID0gdGhpcy5vcHRpb25zLmljb25zLnByaW1hcnk7XG5cdFx0XHRcdH0gZWxzZSB7XG5cdFx0XHRcdFx0dGhpcy5vcHRpb25zLmljb24gPSB0aGlzLm9wdGlvbnMuaWNvbnMuc2Vjb25kYXJ5O1xuXHRcdFx0XHRcdHRoaXMub3B0aW9ucy5pY29uUG9zaXRpb24gPSBcImVuZFwiO1xuXHRcdFx0XHR9XG5cdFx0XHR9IGVsc2UgaWYgKCB0aGlzLm9wdGlvbnMuaWNvbiApIHtcblx0XHRcdFx0dGhpcy5vcHRpb25zLmljb25zLnByaW1hcnkgPSB0aGlzLm9wdGlvbnMuaWNvbjtcblx0XHRcdH1cblx0XHRcdHRoaXMuX3N1cGVyKCk7XG5cdFx0fSxcblxuXHRcdF9zZXRPcHRpb246IGZ1bmN0aW9uKCBrZXksIHZhbHVlICkge1xuXHRcdFx0aWYgKCBrZXkgPT09IFwidGV4dFwiICkge1xuXHRcdFx0XHR0aGlzLl9zdXBlciggXCJzaG93TGFiZWxcIiwgdmFsdWUgKTtcblx0XHRcdFx0cmV0dXJuO1xuXHRcdFx0fVxuXHRcdFx0aWYgKCBrZXkgPT09IFwic2hvd0xhYmVsXCIgKSB7XG5cdFx0XHRcdHRoaXMub3B0aW9ucy50ZXh0ID0gdmFsdWU7XG5cdFx0XHR9XG5cdFx0XHRpZiAoIGtleSA9PT0gXCJpY29uXCIgKSB7XG5cdFx0XHRcdHRoaXMub3B0aW9ucy5pY29ucy5wcmltYXJ5ID0gdmFsdWU7XG5cdFx0XHR9XG5cdFx0XHRpZiAoIGtleSA9PT0gXCJpY29uc1wiICkge1xuXHRcdFx0XHRpZiAoIHZhbHVlLnByaW1hcnkgKSB7XG5cdFx0XHRcdFx0dGhpcy5fc3VwZXIoIFwiaWNvblwiLCB2YWx1ZS5wcmltYXJ5ICk7XG5cdFx0XHRcdFx0dGhpcy5fc3VwZXIoIFwiaWNvblBvc2l0aW9uXCIsIFwiYmVnaW5uaW5nXCIgKTtcblx0XHRcdFx0fSBlbHNlIGlmICggdmFsdWUuc2Vjb25kYXJ5ICkge1xuXHRcdFx0XHRcdHRoaXMuX3N1cGVyKCBcImljb25cIiwgdmFsdWUuc2Vjb25kYXJ5ICk7XG5cdFx0XHRcdFx0dGhpcy5fc3VwZXIoIFwiaWNvblBvc2l0aW9uXCIsIFwiZW5kXCIgKTtcblx0XHRcdFx0fVxuXHRcdFx0fVxuXHRcdFx0dGhpcy5fc3VwZXJBcHBseSggYXJndW1lbnRzICk7XG5cdFx0fVxuXHR9ICk7XG5cblx0JC5mbi5idXR0b24gPSAoIGZ1bmN0aW9uKCBvcmlnICkge1xuXHRcdHJldHVybiBmdW5jdGlvbigpIHtcblx0XHRcdGlmICggIXRoaXMubGVuZ3RoIHx8ICggdGhpcy5sZW5ndGggJiYgdGhpc1sgMCBdLnRhZ05hbWUgIT09IFwiSU5QVVRcIiApIHx8XG5cdFx0XHRcdFx0KCB0aGlzLmxlbmd0aCAmJiB0aGlzWyAwIF0udGFnTmFtZSA9PT0gXCJJTlBVVFwiICYmIChcblx0XHRcdFx0XHRcdHRoaXMuYXR0ciggXCJ0eXBlXCIgKSAhPT0gXCJjaGVja2JveFwiICYmIHRoaXMuYXR0ciggXCJ0eXBlXCIgKSAhPT0gXCJyYWRpb1wiXG5cdFx0XHRcdFx0KSApICkge1xuXHRcdFx0XHRyZXR1cm4gb3JpZy5hcHBseSggdGhpcywgYXJndW1lbnRzICk7XG5cdFx0XHR9XG5cdFx0XHRpZiAoICEkLnVpLmNoZWNrYm94cmFkaW8gKSB7XG5cdFx0XHRcdCQuZXJyb3IoIFwiQ2hlY2tib3hyYWRpbyB3aWRnZXQgbWlzc2luZ1wiICk7XG5cdFx0XHR9XG5cdFx0XHRpZiAoIGFyZ3VtZW50cy5sZW5ndGggPT09IDAgKSB7XG5cdFx0XHRcdHJldHVybiB0aGlzLmNoZWNrYm94cmFkaW8oIHtcblx0XHRcdFx0XHRcImljb25cIjogZmFsc2Vcblx0XHRcdFx0fSApO1xuXHRcdFx0fVxuXHRcdFx0cmV0dXJuIHRoaXMuY2hlY2tib3hyYWRpby5hcHBseSggdGhpcywgYXJndW1lbnRzICk7XG5cdFx0fTtcblx0fSApKCAkLmZuLmJ1dHRvbiApO1xuXG5cdCQuZm4uYnV0dG9uc2V0ID0gZnVuY3Rpb24oKSB7XG5cdFx0aWYgKCAhJC51aS5jb250cm9sZ3JvdXAgKSB7XG5cdFx0XHQkLmVycm9yKCBcIkNvbnRyb2xncm91cCB3aWRnZXQgbWlzc2luZ1wiICk7XG5cdFx0fVxuXHRcdGlmICggYXJndW1lbnRzWyAwIF0gPT09IFwib3B0aW9uXCIgJiYgYXJndW1lbnRzWyAxIF0gPT09IFwiaXRlbXNcIiAmJiBhcmd1bWVudHNbIDIgXSApIHtcblx0XHRcdHJldHVybiB0aGlzLmNvbnRyb2xncm91cC5hcHBseSggdGhpcyxcblx0XHRcdFx0WyBhcmd1bWVudHNbIDAgXSwgXCJpdGVtcy5idXR0b25cIiwgYXJndW1lbnRzWyAyIF0gXSApO1xuXHRcdH1cblx0XHRpZiAoIGFyZ3VtZW50c1sgMCBdID09PSBcIm9wdGlvblwiICYmIGFyZ3VtZW50c1sgMSBdID09PSBcIml0ZW1zXCIgKSB7XG5cdFx0XHRyZXR1cm4gdGhpcy5jb250cm9sZ3JvdXAuYXBwbHkoIHRoaXMsIFsgYXJndW1lbnRzWyAwIF0sIFwiaXRlbXMuYnV0dG9uXCIgXSApO1xuXHRcdH1cblx0XHRpZiAoIHR5cGVvZiBhcmd1bWVudHNbIDAgXSA9PT0gXCJvYmplY3RcIiAmJiBhcmd1bWVudHNbIDAgXS5pdGVtcyApIHtcblx0XHRcdGFyZ3VtZW50c1sgMCBdLml0ZW1zID0ge1xuXHRcdFx0XHRidXR0b246IGFyZ3VtZW50c1sgMCBdLml0ZW1zXG5cdFx0XHR9O1xuXHRcdH1cblx0XHRyZXR1cm4gdGhpcy5jb250cm9sZ3JvdXAuYXBwbHkoIHRoaXMsIGFyZ3VtZW50cyApO1xuXHR9O1xufVxuXG5yZXR1cm4gJC51aS5idXR0b247XG5cbn0gKSApO1xuIiwiLyohXG4gKiBqUXVlcnkgVUkgRGlhbG9nIDEuMTIuMFxuICogaHR0cDovL2pxdWVyeXVpLmNvbVxuICpcbiAqIENvcHlyaWdodCBqUXVlcnkgRm91bmRhdGlvbiBhbmQgb3RoZXIgY29udHJpYnV0b3JzXG4gKiBSZWxlYXNlZCB1bmRlciB0aGUgTUlUIGxpY2Vuc2UuXG4gKiBodHRwOi8vanF1ZXJ5Lm9yZy9saWNlbnNlXG4gKi9cblxuLy8+PmxhYmVsOiBEaWFsb2dcbi8vPj5ncm91cDogV2lkZ2V0c1xuLy8+PmRlc2NyaXB0aW9uOiBEaXNwbGF5cyBjdXN0b21pemFibGUgZGlhbG9nIHdpbmRvd3MuXG4vLz4+ZG9jczogaHR0cDovL2FwaS5qcXVlcnl1aS5jb20vZGlhbG9nL1xuLy8+PmRlbW9zOiBodHRwOi8vanF1ZXJ5dWkuY29tL2RpYWxvZy9cbi8vPj5jc3Muc3RydWN0dXJlOiAuLi8uLi90aGVtZXMvYmFzZS9jb3JlLmNzc1xuLy8+PmNzcy5zdHJ1Y3R1cmU6IC4uLy4uL3RoZW1lcy9iYXNlL2RpYWxvZy5jc3Ncbi8vPj5jc3MudGhlbWU6IC4uLy4uL3RoZW1lcy9iYXNlL3RoZW1lLmNzc1xuXG4oIGZ1bmN0aW9uKCBmYWN0b3J5ICkge1xuXHRpZiAoIHR5cGVvZiBkZWZpbmUgPT09IFwiZnVuY3Rpb25cIiAmJiBkZWZpbmUuYW1kICkge1xuXG5cdFx0Ly8gQU1ELiBSZWdpc3RlciBhcyBhbiBhbm9ueW1vdXMgbW9kdWxlLlxuXHRcdGRlZmluZSggW1xuXHRcdFx0XCJqcXVlcnlcIixcblx0XHRcdFwiLi9idXR0b25cIixcblx0XHRcdFwiLi9kcmFnZ2FibGVcIixcblx0XHRcdFwiLi9tb3VzZVwiLFxuXHRcdFx0XCIuL3Jlc2l6YWJsZVwiLFxuXHRcdFx0XCIuLi9mb2N1c2FibGVcIixcblx0XHRcdFwiLi4va2V5Y29kZVwiLFxuXHRcdFx0XCIuLi9wb3NpdGlvblwiLFxuXHRcdFx0XCIuLi9zYWZlLWFjdGl2ZS1lbGVtZW50XCIsXG5cdFx0XHRcIi4uL3NhZmUtYmx1clwiLFxuXHRcdFx0XCIuLi90YWJiYWJsZVwiLFxuXHRcdFx0XCIuLi91bmlxdWUtaWRcIixcblx0XHRcdFwiLi4vdmVyc2lvblwiLFxuXHRcdFx0XCIuLi93aWRnZXRcIlxuXHRcdF0sIGZhY3RvcnkgKTtcblx0fSBlbHNlIHtcblxuXHRcdC8vIEJyb3dzZXIgZ2xvYmFsc1xuXHRcdGZhY3RvcnkoIGpRdWVyeSApO1xuXHR9XG59KCBmdW5jdGlvbiggJCApIHtcblxuJC53aWRnZXQoIFwidWkuZGlhbG9nXCIsIHtcblx0dmVyc2lvbjogXCIxLjEyLjBcIixcblx0b3B0aW9uczoge1xuXHRcdGFwcGVuZFRvOiBcImJvZHlcIixcblx0XHRhdXRvT3BlbjogdHJ1ZSxcblx0XHRidXR0b25zOiBbXSxcblx0XHRjbGFzc2VzOiB7XG5cdFx0XHRcInVpLWRpYWxvZ1wiOiBcInVpLWNvcm5lci1hbGxcIixcblx0XHRcdFwidWktZGlhbG9nLXRpdGxlYmFyXCI6IFwidWktY29ybmVyLWFsbFwiXG5cdFx0fSxcblx0XHRjbG9zZU9uRXNjYXBlOiB0cnVlLFxuXHRcdGNsb3NlVGV4dDogXCJDbG9zZVwiLFxuXHRcdGRyYWdnYWJsZTogdHJ1ZSxcblx0XHRoaWRlOiBudWxsLFxuXHRcdGhlaWdodDogXCJhdXRvXCIsXG5cdFx0bWF4SGVpZ2h0OiBudWxsLFxuXHRcdG1heFdpZHRoOiBudWxsLFxuXHRcdG1pbkhlaWdodDogMTUwLFxuXHRcdG1pbldpZHRoOiAxNTAsXG5cdFx0bW9kYWw6IGZhbHNlLFxuXHRcdHBvc2l0aW9uOiB7XG5cdFx0XHRteTogXCJjZW50ZXJcIixcblx0XHRcdGF0OiBcImNlbnRlclwiLFxuXHRcdFx0b2Y6IHdpbmRvdyxcblx0XHRcdGNvbGxpc2lvbjogXCJmaXRcIixcblxuXHRcdFx0Ly8gRW5zdXJlIHRoZSB0aXRsZWJhciBpcyBhbHdheXMgdmlzaWJsZVxuXHRcdFx0dXNpbmc6IGZ1bmN0aW9uKCBwb3MgKSB7XG5cdFx0XHRcdHZhciB0b3BPZmZzZXQgPSAkKCB0aGlzICkuY3NzKCBwb3MgKS5vZmZzZXQoKS50b3A7XG5cdFx0XHRcdGlmICggdG9wT2Zmc2V0IDwgMCApIHtcblx0XHRcdFx0XHQkKCB0aGlzICkuY3NzKCBcInRvcFwiLCBwb3MudG9wIC0gdG9wT2Zmc2V0ICk7XG5cdFx0XHRcdH1cblx0XHRcdH1cblx0XHR9LFxuXHRcdHJlc2l6YWJsZTogdHJ1ZSxcblx0XHRzaG93OiBudWxsLFxuXHRcdHRpdGxlOiBudWxsLFxuXHRcdHdpZHRoOiAzMDAsXG5cblx0XHQvLyBDYWxsYmFja3Ncblx0XHRiZWZvcmVDbG9zZTogbnVsbCxcblx0XHRjbG9zZTogbnVsbCxcblx0XHRkcmFnOiBudWxsLFxuXHRcdGRyYWdTdGFydDogbnVsbCxcblx0XHRkcmFnU3RvcDogbnVsbCxcblx0XHRmb2N1czogbnVsbCxcblx0XHRvcGVuOiBudWxsLFxuXHRcdHJlc2l6ZTogbnVsbCxcblx0XHRyZXNpemVTdGFydDogbnVsbCxcblx0XHRyZXNpemVTdG9wOiBudWxsXG5cdH0sXG5cblx0c2l6ZVJlbGF0ZWRPcHRpb25zOiB7XG5cdFx0YnV0dG9uczogdHJ1ZSxcblx0XHRoZWlnaHQ6IHRydWUsXG5cdFx0bWF4SGVpZ2h0OiB0cnVlLFxuXHRcdG1heFdpZHRoOiB0cnVlLFxuXHRcdG1pbkhlaWdodDogdHJ1ZSxcblx0XHRtaW5XaWR0aDogdHJ1ZSxcblx0XHR3aWR0aDogdHJ1ZVxuXHR9LFxuXG5cdHJlc2l6YWJsZVJlbGF0ZWRPcHRpb25zOiB7XG5cdFx0bWF4SGVpZ2h0OiB0cnVlLFxuXHRcdG1heFdpZHRoOiB0cnVlLFxuXHRcdG1pbkhlaWdodDogdHJ1ZSxcblx0XHRtaW5XaWR0aDogdHJ1ZVxuXHR9LFxuXG5cdF9jcmVhdGU6IGZ1bmN0aW9uKCkge1xuXHRcdHRoaXMub3JpZ2luYWxDc3MgPSB7XG5cdFx0XHRkaXNwbGF5OiB0aGlzLmVsZW1lbnRbIDAgXS5zdHlsZS5kaXNwbGF5LFxuXHRcdFx0d2lkdGg6IHRoaXMuZWxlbWVudFsgMCBdLnN0eWxlLndpZHRoLFxuXHRcdFx0bWluSGVpZ2h0OiB0aGlzLmVsZW1lbnRbIDAgXS5zdHlsZS5taW5IZWlnaHQsXG5cdFx0XHRtYXhIZWlnaHQ6IHRoaXMuZWxlbWVudFsgMCBdLnN0eWxlLm1heEhlaWdodCxcblx0XHRcdGhlaWdodDogdGhpcy5lbGVtZW50WyAwIF0uc3R5bGUuaGVpZ2h0XG5cdFx0fTtcblx0XHR0aGlzLm9yaWdpbmFsUG9zaXRpb24gPSB7XG5cdFx0XHRwYXJlbnQ6IHRoaXMuZWxlbWVudC5wYXJlbnQoKSxcblx0XHRcdGluZGV4OiB0aGlzLmVsZW1lbnQucGFyZW50KCkuY2hpbGRyZW4oKS5pbmRleCggdGhpcy5lbGVtZW50IClcblx0XHR9O1xuXHRcdHRoaXMub3JpZ2luYWxUaXRsZSA9IHRoaXMuZWxlbWVudC5hdHRyKCBcInRpdGxlXCIgKTtcblx0XHRpZiAoIHRoaXMub3B0aW9ucy50aXRsZSA9PSBudWxsICYmIHRoaXMub3JpZ2luYWxUaXRsZSAhPSBudWxsICkge1xuXHRcdFx0dGhpcy5vcHRpb25zLnRpdGxlID0gdGhpcy5vcmlnaW5hbFRpdGxlO1xuXHRcdH1cblxuXHRcdC8vIERpYWxvZ3MgY2FuJ3QgYmUgZGlzYWJsZWRcblx0XHRpZiAoIHRoaXMub3B0aW9ucy5kaXNhYmxlZCApIHtcblx0XHRcdHRoaXMub3B0aW9ucy5kaXNhYmxlZCA9IGZhbHNlO1xuXHRcdH1cblxuXHRcdHRoaXMuX2NyZWF0ZVdyYXBwZXIoKTtcblxuXHRcdHRoaXMuZWxlbWVudFxuXHRcdFx0LnNob3coKVxuXHRcdFx0LnJlbW92ZUF0dHIoIFwidGl0bGVcIiApXG5cdFx0XHQuYXBwZW5kVG8oIHRoaXMudWlEaWFsb2cgKTtcblxuXHRcdHRoaXMuX2FkZENsYXNzKCBcInVpLWRpYWxvZy1jb250ZW50XCIsIFwidWktd2lkZ2V0LWNvbnRlbnRcIiApO1xuXG5cdFx0dGhpcy5fY3JlYXRlVGl0bGViYXIoKTtcblx0XHR0aGlzLl9jcmVhdGVCdXR0b25QYW5lKCk7XG5cblx0XHRpZiAoIHRoaXMub3B0aW9ucy5kcmFnZ2FibGUgJiYgJC5mbi5kcmFnZ2FibGUgKSB7XG5cdFx0XHR0aGlzLl9tYWtlRHJhZ2dhYmxlKCk7XG5cdFx0fVxuXHRcdGlmICggdGhpcy5vcHRpb25zLnJlc2l6YWJsZSAmJiAkLmZuLnJlc2l6YWJsZSApIHtcblx0XHRcdHRoaXMuX21ha2VSZXNpemFibGUoKTtcblx0XHR9XG5cblx0XHR0aGlzLl9pc09wZW4gPSBmYWxzZTtcblxuXHRcdHRoaXMuX3RyYWNrRm9jdXMoKTtcblx0fSxcblxuXHRfaW5pdDogZnVuY3Rpb24oKSB7XG5cdFx0aWYgKCB0aGlzLm9wdGlvbnMuYXV0b09wZW4gKSB7XG5cdFx0XHR0aGlzLm9wZW4oKTtcblx0XHR9XG5cdH0sXG5cblx0X2FwcGVuZFRvOiBmdW5jdGlvbigpIHtcblx0XHR2YXIgZWxlbWVudCA9IHRoaXMub3B0aW9ucy5hcHBlbmRUbztcblx0XHRpZiAoIGVsZW1lbnQgJiYgKCBlbGVtZW50LmpxdWVyeSB8fCBlbGVtZW50Lm5vZGVUeXBlICkgKSB7XG5cdFx0XHRyZXR1cm4gJCggZWxlbWVudCApO1xuXHRcdH1cblx0XHRyZXR1cm4gdGhpcy5kb2N1bWVudC5maW5kKCBlbGVtZW50IHx8IFwiYm9keVwiICkuZXEoIDAgKTtcblx0fSxcblxuXHRfZGVzdHJveTogZnVuY3Rpb24oKSB7XG5cdFx0dmFyIG5leHQsXG5cdFx0XHRvcmlnaW5hbFBvc2l0aW9uID0gdGhpcy5vcmlnaW5hbFBvc2l0aW9uO1xuXG5cdFx0dGhpcy5fdW50cmFja0luc3RhbmNlKCk7XG5cdFx0dGhpcy5fZGVzdHJveU92ZXJsYXkoKTtcblxuXHRcdHRoaXMuZWxlbWVudFxuXHRcdFx0LnJlbW92ZVVuaXF1ZUlkKClcblx0XHRcdC5jc3MoIHRoaXMub3JpZ2luYWxDc3MgKVxuXG5cdFx0XHQvLyBXaXRob3V0IGRldGFjaGluZyBmaXJzdCwgdGhlIGZvbGxvd2luZyBiZWNvbWVzIHJlYWxseSBzbG93XG5cdFx0XHQuZGV0YWNoKCk7XG5cblx0XHR0aGlzLnVpRGlhbG9nLnJlbW92ZSgpO1xuXG5cdFx0aWYgKCB0aGlzLm9yaWdpbmFsVGl0bGUgKSB7XG5cdFx0XHR0aGlzLmVsZW1lbnQuYXR0ciggXCJ0aXRsZVwiLCB0aGlzLm9yaWdpbmFsVGl0bGUgKTtcblx0XHR9XG5cblx0XHRuZXh0ID0gb3JpZ2luYWxQb3NpdGlvbi5wYXJlbnQuY2hpbGRyZW4oKS5lcSggb3JpZ2luYWxQb3NpdGlvbi5pbmRleCApO1xuXG5cdFx0Ly8gRG9uJ3QgdHJ5IHRvIHBsYWNlIHRoZSBkaWFsb2cgbmV4dCB0byBpdHNlbGYgKCM4NjEzKVxuXHRcdGlmICggbmV4dC5sZW5ndGggJiYgbmV4dFsgMCBdICE9PSB0aGlzLmVsZW1lbnRbIDAgXSApIHtcblx0XHRcdG5leHQuYmVmb3JlKCB0aGlzLmVsZW1lbnQgKTtcblx0XHR9IGVsc2Uge1xuXHRcdFx0b3JpZ2luYWxQb3NpdGlvbi5wYXJlbnQuYXBwZW5kKCB0aGlzLmVsZW1lbnQgKTtcblx0XHR9XG5cdH0sXG5cblx0d2lkZ2V0OiBmdW5jdGlvbigpIHtcblx0XHRyZXR1cm4gdGhpcy51aURpYWxvZztcblx0fSxcblxuXHRkaXNhYmxlOiAkLm5vb3AsXG5cdGVuYWJsZTogJC5ub29wLFxuXG5cdGNsb3NlOiBmdW5jdGlvbiggZXZlbnQgKSB7XG5cdFx0dmFyIHRoYXQgPSB0aGlzO1xuXG5cdFx0aWYgKCAhdGhpcy5faXNPcGVuIHx8IHRoaXMuX3RyaWdnZXIoIFwiYmVmb3JlQ2xvc2VcIiwgZXZlbnQgKSA9PT0gZmFsc2UgKSB7XG5cdFx0XHRyZXR1cm47XG5cdFx0fVxuXG5cdFx0dGhpcy5faXNPcGVuID0gZmFsc2U7XG5cdFx0dGhpcy5fZm9jdXNlZEVsZW1lbnQgPSBudWxsO1xuXHRcdHRoaXMuX2Rlc3Ryb3lPdmVybGF5KCk7XG5cdFx0dGhpcy5fdW50cmFja0luc3RhbmNlKCk7XG5cblx0XHRpZiAoICF0aGlzLm9wZW5lci5maWx0ZXIoIFwiOmZvY3VzYWJsZVwiICkudHJpZ2dlciggXCJmb2N1c1wiICkubGVuZ3RoICkge1xuXG5cdFx0XHQvLyBIaWRpbmcgYSBmb2N1c2VkIGVsZW1lbnQgZG9lc24ndCB0cmlnZ2VyIGJsdXIgaW4gV2ViS2l0XG5cdFx0XHQvLyBzbyBpbiBjYXNlIHdlIGhhdmUgbm90aGluZyB0byBmb2N1cyBvbiwgZXhwbGljaXRseSBibHVyIHRoZSBhY3RpdmUgZWxlbWVudFxuXHRcdFx0Ly8gaHR0cHM6Ly9idWdzLndlYmtpdC5vcmcvc2hvd19idWcuY2dpP2lkPTQ3MTgyXG5cdFx0XHQkLnVpLnNhZmVCbHVyKCAkLnVpLnNhZmVBY3RpdmVFbGVtZW50KCB0aGlzLmRvY3VtZW50WyAwIF0gKSApO1xuXHRcdH1cblxuXHRcdHRoaXMuX2hpZGUoIHRoaXMudWlEaWFsb2csIHRoaXMub3B0aW9ucy5oaWRlLCBmdW5jdGlvbigpIHtcblx0XHRcdHRoYXQuX3RyaWdnZXIoIFwiY2xvc2VcIiwgZXZlbnQgKTtcblx0XHR9ICk7XG5cdH0sXG5cblx0aXNPcGVuOiBmdW5jdGlvbigpIHtcblx0XHRyZXR1cm4gdGhpcy5faXNPcGVuO1xuXHR9LFxuXG5cdG1vdmVUb1RvcDogZnVuY3Rpb24oKSB7XG5cdFx0dGhpcy5fbW92ZVRvVG9wKCk7XG5cdH0sXG5cblx0X21vdmVUb1RvcDogZnVuY3Rpb24oIGV2ZW50LCBzaWxlbnQgKSB7XG5cdFx0dmFyIG1vdmVkID0gZmFsc2UsXG5cdFx0XHR6SW5kaWNlcyA9IHRoaXMudWlEaWFsb2cuc2libGluZ3MoIFwiLnVpLWZyb250OnZpc2libGVcIiApLm1hcCggZnVuY3Rpb24oKSB7XG5cdFx0XHRcdHJldHVybiArJCggdGhpcyApLmNzcyggXCJ6LWluZGV4XCIgKTtcblx0XHRcdH0gKS5nZXQoKSxcblx0XHRcdHpJbmRleE1heCA9IE1hdGgubWF4LmFwcGx5KCBudWxsLCB6SW5kaWNlcyApO1xuXG5cdFx0aWYgKCB6SW5kZXhNYXggPj0gK3RoaXMudWlEaWFsb2cuY3NzKCBcInotaW5kZXhcIiApICkge1xuXHRcdFx0dGhpcy51aURpYWxvZy5jc3MoIFwiei1pbmRleFwiLCB6SW5kZXhNYXggKyAxICk7XG5cdFx0XHRtb3ZlZCA9IHRydWU7XG5cdFx0fVxuXG5cdFx0aWYgKCBtb3ZlZCAmJiAhc2lsZW50ICkge1xuXHRcdFx0dGhpcy5fdHJpZ2dlciggXCJmb2N1c1wiLCBldmVudCApO1xuXHRcdH1cblx0XHRyZXR1cm4gbW92ZWQ7XG5cdH0sXG5cblx0b3BlbjogZnVuY3Rpb24oKSB7XG5cdFx0dmFyIHRoYXQgPSB0aGlzO1xuXHRcdGlmICggdGhpcy5faXNPcGVuICkge1xuXHRcdFx0aWYgKCB0aGlzLl9tb3ZlVG9Ub3AoKSApIHtcblx0XHRcdFx0dGhpcy5fZm9jdXNUYWJiYWJsZSgpO1xuXHRcdFx0fVxuXHRcdFx0cmV0dXJuO1xuXHRcdH1cblxuXHRcdHRoaXMuX2lzT3BlbiA9IHRydWU7XG5cdFx0dGhpcy5vcGVuZXIgPSAkKCAkLnVpLnNhZmVBY3RpdmVFbGVtZW50KCB0aGlzLmRvY3VtZW50WyAwIF0gKSApO1xuXG5cdFx0dGhpcy5fc2l6ZSgpO1xuXHRcdHRoaXMuX3Bvc2l0aW9uKCk7XG5cdFx0dGhpcy5fY3JlYXRlT3ZlcmxheSgpO1xuXHRcdHRoaXMuX21vdmVUb1RvcCggbnVsbCwgdHJ1ZSApO1xuXG5cdFx0Ly8gRW5zdXJlIHRoZSBvdmVybGF5IGlzIG1vdmVkIHRvIHRoZSB0b3Agd2l0aCB0aGUgZGlhbG9nLCBidXQgb25seSB3aGVuXG5cdFx0Ly8gb3BlbmluZy4gVGhlIG92ZXJsYXkgc2hvdWxkbid0IG1vdmUgYWZ0ZXIgdGhlIGRpYWxvZyBpcyBvcGVuIHNvIHRoYXRcblx0XHQvLyBtb2RlbGVzcyBkaWFsb2dzIG9wZW5lZCBhZnRlciB0aGUgbW9kYWwgZGlhbG9nIHN0YWNrIHByb3Blcmx5LlxuXHRcdGlmICggdGhpcy5vdmVybGF5ICkge1xuXHRcdFx0dGhpcy5vdmVybGF5LmNzcyggXCJ6LWluZGV4XCIsIHRoaXMudWlEaWFsb2cuY3NzKCBcInotaW5kZXhcIiApIC0gMSApO1xuXHRcdH1cblxuXHRcdHRoaXMuX3Nob3coIHRoaXMudWlEaWFsb2csIHRoaXMub3B0aW9ucy5zaG93LCBmdW5jdGlvbigpIHtcblx0XHRcdHRoYXQuX2ZvY3VzVGFiYmFibGUoKTtcblx0XHRcdHRoYXQuX3RyaWdnZXIoIFwiZm9jdXNcIiApO1xuXHRcdH0gKTtcblxuXHRcdC8vIFRyYWNrIHRoZSBkaWFsb2cgaW1tZWRpYXRlbHkgdXBvbiBvcGVuZW5pbmcgaW4gY2FzZSBhIGZvY3VzIGV2ZW50XG5cdFx0Ly8gc29tZWhvdyBvY2N1cnMgb3V0c2lkZSBvZiB0aGUgZGlhbG9nIGJlZm9yZSBhbiBlbGVtZW50IGluc2lkZSB0aGVcblx0XHQvLyBkaWFsb2cgaXMgZm9jdXNlZCAoIzEwMTUyKVxuXHRcdHRoaXMuX21ha2VGb2N1c1RhcmdldCgpO1xuXG5cdFx0dGhpcy5fdHJpZ2dlciggXCJvcGVuXCIgKTtcblx0fSxcblxuXHRfZm9jdXNUYWJiYWJsZTogZnVuY3Rpb24oKSB7XG5cblx0XHQvLyBTZXQgZm9jdXMgdG8gdGhlIGZpcnN0IG1hdGNoOlxuXHRcdC8vIDEuIEFuIGVsZW1lbnQgdGhhdCB3YXMgZm9jdXNlZCBwcmV2aW91c2x5XG5cdFx0Ly8gMi4gRmlyc3QgZWxlbWVudCBpbnNpZGUgdGhlIGRpYWxvZyBtYXRjaGluZyBbYXV0b2ZvY3VzXVxuXHRcdC8vIDMuIFRhYmJhYmxlIGVsZW1lbnQgaW5zaWRlIHRoZSBjb250ZW50IGVsZW1lbnRcblx0XHQvLyA0LiBUYWJiYWJsZSBlbGVtZW50IGluc2lkZSB0aGUgYnV0dG9ucGFuZVxuXHRcdC8vIDUuIFRoZSBjbG9zZSBidXR0b25cblx0XHQvLyA2LiBUaGUgZGlhbG9nIGl0c2VsZlxuXHRcdHZhciBoYXNGb2N1cyA9IHRoaXMuX2ZvY3VzZWRFbGVtZW50O1xuXHRcdGlmICggIWhhc0ZvY3VzICkge1xuXHRcdFx0aGFzRm9jdXMgPSB0aGlzLmVsZW1lbnQuZmluZCggXCJbYXV0b2ZvY3VzXVwiICk7XG5cdFx0fVxuXHRcdGlmICggIWhhc0ZvY3VzLmxlbmd0aCApIHtcblx0XHRcdGhhc0ZvY3VzID0gdGhpcy5lbGVtZW50LmZpbmQoIFwiOnRhYmJhYmxlXCIgKTtcblx0XHR9XG5cdFx0aWYgKCAhaGFzRm9jdXMubGVuZ3RoICkge1xuXHRcdFx0aGFzRm9jdXMgPSB0aGlzLnVpRGlhbG9nQnV0dG9uUGFuZS5maW5kKCBcIjp0YWJiYWJsZVwiICk7XG5cdFx0fVxuXHRcdGlmICggIWhhc0ZvY3VzLmxlbmd0aCApIHtcblx0XHRcdGhhc0ZvY3VzID0gdGhpcy51aURpYWxvZ1RpdGxlYmFyQ2xvc2UuZmlsdGVyKCBcIjp0YWJiYWJsZVwiICk7XG5cdFx0fVxuXHRcdGlmICggIWhhc0ZvY3VzLmxlbmd0aCApIHtcblx0XHRcdGhhc0ZvY3VzID0gdGhpcy51aURpYWxvZztcblx0XHR9XG5cdFx0aGFzRm9jdXMuZXEoIDAgKS50cmlnZ2VyKCBcImZvY3VzXCIgKTtcblx0fSxcblxuXHRfa2VlcEZvY3VzOiBmdW5jdGlvbiggZXZlbnQgKSB7XG5cdFx0ZnVuY3Rpb24gY2hlY2tGb2N1cygpIHtcblx0XHRcdHZhciBhY3RpdmVFbGVtZW50ID0gJC51aS5zYWZlQWN0aXZlRWxlbWVudCggdGhpcy5kb2N1bWVudFsgMCBdICksXG5cdFx0XHRcdGlzQWN0aXZlID0gdGhpcy51aURpYWxvZ1sgMCBdID09PSBhY3RpdmVFbGVtZW50IHx8XG5cdFx0XHRcdFx0JC5jb250YWlucyggdGhpcy51aURpYWxvZ1sgMCBdLCBhY3RpdmVFbGVtZW50ICk7XG5cdFx0XHRpZiAoICFpc0FjdGl2ZSApIHtcblx0XHRcdFx0dGhpcy5fZm9jdXNUYWJiYWJsZSgpO1xuXHRcdFx0fVxuXHRcdH1cblx0XHRldmVudC5wcmV2ZW50RGVmYXVsdCgpO1xuXHRcdGNoZWNrRm9jdXMuY2FsbCggdGhpcyApO1xuXG5cdFx0Ly8gc3VwcG9ydDogSUVcblx0XHQvLyBJRSA8PSA4IGRvZXNuJ3QgcHJldmVudCBtb3ZpbmcgZm9jdXMgZXZlbiB3aXRoIGV2ZW50LnByZXZlbnREZWZhdWx0KClcblx0XHQvLyBzbyB3ZSBjaGVjayBhZ2FpbiBsYXRlclxuXHRcdHRoaXMuX2RlbGF5KCBjaGVja0ZvY3VzICk7XG5cdH0sXG5cblx0X2NyZWF0ZVdyYXBwZXI6IGZ1bmN0aW9uKCkge1xuXHRcdHRoaXMudWlEaWFsb2cgPSAkKCBcIjxkaXY+XCIgKVxuXHRcdFx0LmhpZGUoKVxuXHRcdFx0LmF0dHIoIHtcblxuXHRcdFx0XHQvLyBTZXR0aW5nIHRhYkluZGV4IG1ha2VzIHRoZSBkaXYgZm9jdXNhYmxlXG5cdFx0XHRcdHRhYkluZGV4OiAtMSxcblx0XHRcdFx0cm9sZTogXCJkaWFsb2dcIlxuXHRcdFx0fSApXG5cdFx0XHQuYXBwZW5kVG8oIHRoaXMuX2FwcGVuZFRvKCkgKTtcblxuXHRcdHRoaXMuX2FkZENsYXNzKCB0aGlzLnVpRGlhbG9nLCBcInVpLWRpYWxvZ1wiLCBcInVpLXdpZGdldCB1aS13aWRnZXQtY29udGVudCB1aS1mcm9udFwiICk7XG5cdFx0dGhpcy5fb24oIHRoaXMudWlEaWFsb2csIHtcblx0XHRcdGtleWRvd246IGZ1bmN0aW9uKCBldmVudCApIHtcblx0XHRcdFx0aWYgKCB0aGlzLm9wdGlvbnMuY2xvc2VPbkVzY2FwZSAmJiAhZXZlbnQuaXNEZWZhdWx0UHJldmVudGVkKCkgJiYgZXZlbnQua2V5Q29kZSAmJlxuXHRcdFx0XHRcdFx0ZXZlbnQua2V5Q29kZSA9PT0gJC51aS5rZXlDb2RlLkVTQ0FQRSApIHtcblx0XHRcdFx0XHRldmVudC5wcmV2ZW50RGVmYXVsdCgpO1xuXHRcdFx0XHRcdHRoaXMuY2xvc2UoIGV2ZW50ICk7XG5cdFx0XHRcdFx0cmV0dXJuO1xuXHRcdFx0XHR9XG5cblx0XHRcdFx0Ly8gUHJldmVudCB0YWJiaW5nIG91dCBvZiBkaWFsb2dzXG5cdFx0XHRcdGlmICggZXZlbnQua2V5Q29kZSAhPT0gJC51aS5rZXlDb2RlLlRBQiB8fCBldmVudC5pc0RlZmF1bHRQcmV2ZW50ZWQoKSApIHtcblx0XHRcdFx0XHRyZXR1cm47XG5cdFx0XHRcdH1cblx0XHRcdFx0dmFyIHRhYmJhYmxlcyA9IHRoaXMudWlEaWFsb2cuZmluZCggXCI6dGFiYmFibGVcIiApLFxuXHRcdFx0XHRcdGZpcnN0ID0gdGFiYmFibGVzLmZpbHRlciggXCI6Zmlyc3RcIiApLFxuXHRcdFx0XHRcdGxhc3QgPSB0YWJiYWJsZXMuZmlsdGVyKCBcIjpsYXN0XCIgKTtcblxuXHRcdFx0XHRpZiAoICggZXZlbnQudGFyZ2V0ID09PSBsYXN0WyAwIF0gfHwgZXZlbnQudGFyZ2V0ID09PSB0aGlzLnVpRGlhbG9nWyAwIF0gKSAmJlxuXHRcdFx0XHRcdFx0IWV2ZW50LnNoaWZ0S2V5ICkge1xuXHRcdFx0XHRcdHRoaXMuX2RlbGF5KCBmdW5jdGlvbigpIHtcblx0XHRcdFx0XHRcdGZpcnN0LnRyaWdnZXIoIFwiZm9jdXNcIiApO1xuXHRcdFx0XHRcdH0gKTtcblx0XHRcdFx0XHRldmVudC5wcmV2ZW50RGVmYXVsdCgpO1xuXHRcdFx0XHR9IGVsc2UgaWYgKCAoIGV2ZW50LnRhcmdldCA9PT0gZmlyc3RbIDAgXSB8fFxuXHRcdFx0XHRcdFx0ZXZlbnQudGFyZ2V0ID09PSB0aGlzLnVpRGlhbG9nWyAwIF0gKSAmJiBldmVudC5zaGlmdEtleSApIHtcblx0XHRcdFx0XHR0aGlzLl9kZWxheSggZnVuY3Rpb24oKSB7XG5cdFx0XHRcdFx0XHRsYXN0LnRyaWdnZXIoIFwiZm9jdXNcIiApO1xuXHRcdFx0XHRcdH0gKTtcblx0XHRcdFx0XHRldmVudC5wcmV2ZW50RGVmYXVsdCgpO1xuXHRcdFx0XHR9XG5cdFx0XHR9LFxuXHRcdFx0bW91c2Vkb3duOiBmdW5jdGlvbiggZXZlbnQgKSB7XG5cdFx0XHRcdGlmICggdGhpcy5fbW92ZVRvVG9wKCBldmVudCApICkge1xuXHRcdFx0XHRcdHRoaXMuX2ZvY3VzVGFiYmFibGUoKTtcblx0XHRcdFx0fVxuXHRcdFx0fVxuXHRcdH0gKTtcblxuXHRcdC8vIFdlIGFzc3VtZSB0aGF0IGFueSBleGlzdGluZyBhcmlhLWRlc2NyaWJlZGJ5IGF0dHJpYnV0ZSBtZWFuc1xuXHRcdC8vIHRoYXQgdGhlIGRpYWxvZyBjb250ZW50IGlzIG1hcmtlZCB1cCBwcm9wZXJseVxuXHRcdC8vIG90aGVyd2lzZSB3ZSBicnV0ZSBmb3JjZSB0aGUgY29udGVudCBhcyB0aGUgZGVzY3JpcHRpb25cblx0XHRpZiAoICF0aGlzLmVsZW1lbnQuZmluZCggXCJbYXJpYS1kZXNjcmliZWRieV1cIiApLmxlbmd0aCApIHtcblx0XHRcdHRoaXMudWlEaWFsb2cuYXR0cigge1xuXHRcdFx0XHRcImFyaWEtZGVzY3JpYmVkYnlcIjogdGhpcy5lbGVtZW50LnVuaXF1ZUlkKCkuYXR0ciggXCJpZFwiIClcblx0XHRcdH0gKTtcblx0XHR9XG5cdH0sXG5cblx0X2NyZWF0ZVRpdGxlYmFyOiBmdW5jdGlvbigpIHtcblx0XHR2YXIgdWlEaWFsb2dUaXRsZTtcblxuXHRcdHRoaXMudWlEaWFsb2dUaXRsZWJhciA9ICQoIFwiPGRpdj5cIiApO1xuXHRcdHRoaXMuX2FkZENsYXNzKCB0aGlzLnVpRGlhbG9nVGl0bGViYXIsXG5cdFx0XHRcInVpLWRpYWxvZy10aXRsZWJhclwiLCBcInVpLXdpZGdldC1oZWFkZXIgdWktaGVscGVyLWNsZWFyZml4XCIgKTtcblx0XHR0aGlzLl9vbiggdGhpcy51aURpYWxvZ1RpdGxlYmFyLCB7XG5cdFx0XHRtb3VzZWRvd246IGZ1bmN0aW9uKCBldmVudCApIHtcblxuXHRcdFx0XHQvLyBEb24ndCBwcmV2ZW50IGNsaWNrIG9uIGNsb3NlIGJ1dHRvbiAoIzg4MzgpXG5cdFx0XHRcdC8vIEZvY3VzaW5nIGEgZGlhbG9nIHRoYXQgaXMgcGFydGlhbGx5IHNjcm9sbGVkIG91dCBvZiB2aWV3XG5cdFx0XHRcdC8vIGNhdXNlcyB0aGUgYnJvd3NlciB0byBzY3JvbGwgaXQgaW50byB2aWV3LCBwcmV2ZW50aW5nIHRoZSBjbGljayBldmVudFxuXHRcdFx0XHRpZiAoICEkKCBldmVudC50YXJnZXQgKS5jbG9zZXN0KCBcIi51aS1kaWFsb2ctdGl0bGViYXItY2xvc2VcIiApICkge1xuXG5cdFx0XHRcdFx0Ly8gRGlhbG9nIGlzbid0IGdldHRpbmcgZm9jdXMgd2hlbiBkcmFnZ2luZyAoIzgwNjMpXG5cdFx0XHRcdFx0dGhpcy51aURpYWxvZy50cmlnZ2VyKCBcImZvY3VzXCIgKTtcblx0XHRcdFx0fVxuXHRcdFx0fVxuXHRcdH0gKTtcblxuXHRcdC8vIFN1cHBvcnQ6IElFXG5cdFx0Ly8gVXNlIHR5cGU9XCJidXR0b25cIiB0byBwcmV2ZW50IGVudGVyIGtleXByZXNzZXMgaW4gdGV4dGJveGVzIGZyb20gY2xvc2luZyB0aGVcblx0XHQvLyBkaWFsb2cgaW4gSUUgKCM5MzEyKVxuXHRcdHRoaXMudWlEaWFsb2dUaXRsZWJhckNsb3NlID0gJCggXCI8YnV0dG9uIHR5cGU9J2J1dHRvbic+PC9idXR0b24+XCIgKVxuXHRcdFx0LmJ1dHRvbigge1xuXHRcdFx0XHRsYWJlbDogJCggXCI8YT5cIiApLnRleHQoIHRoaXMub3B0aW9ucy5jbG9zZVRleHQgKS5odG1sKCksXG5cdFx0XHRcdGljb246IFwidWktaWNvbi1jbG9zZXRoaWNrXCIsXG5cdFx0XHRcdHNob3dMYWJlbDogZmFsc2Vcblx0XHRcdH0gKVxuXHRcdFx0LmFwcGVuZFRvKCB0aGlzLnVpRGlhbG9nVGl0bGViYXIgKTtcblxuXHRcdHRoaXMuX2FkZENsYXNzKCB0aGlzLnVpRGlhbG9nVGl0bGViYXJDbG9zZSwgXCJ1aS1kaWFsb2ctdGl0bGViYXItY2xvc2VcIiApO1xuXHRcdHRoaXMuX29uKCB0aGlzLnVpRGlhbG9nVGl0bGViYXJDbG9zZSwge1xuXHRcdFx0Y2xpY2s6IGZ1bmN0aW9uKCBldmVudCApIHtcblx0XHRcdFx0ZXZlbnQucHJldmVudERlZmF1bHQoKTtcblx0XHRcdFx0dGhpcy5jbG9zZSggZXZlbnQgKTtcblx0XHRcdH1cblx0XHR9ICk7XG5cblx0XHR1aURpYWxvZ1RpdGxlID0gJCggXCI8c3Bhbj5cIiApLnVuaXF1ZUlkKCkucHJlcGVuZFRvKCB0aGlzLnVpRGlhbG9nVGl0bGViYXIgKTtcblx0XHR0aGlzLl9hZGRDbGFzcyggdWlEaWFsb2dUaXRsZSwgXCJ1aS1kaWFsb2ctdGl0bGVcIiApO1xuXHRcdHRoaXMuX3RpdGxlKCB1aURpYWxvZ1RpdGxlICk7XG5cblx0XHR0aGlzLnVpRGlhbG9nVGl0bGViYXIucHJlcGVuZFRvKCB0aGlzLnVpRGlhbG9nICk7XG5cblx0XHR0aGlzLnVpRGlhbG9nLmF0dHIoIHtcblx0XHRcdFwiYXJpYS1sYWJlbGxlZGJ5XCI6IHVpRGlhbG9nVGl0bGUuYXR0ciggXCJpZFwiIClcblx0XHR9ICk7XG5cdH0sXG5cblx0X3RpdGxlOiBmdW5jdGlvbiggdGl0bGUgKSB7XG5cdFx0aWYgKCB0aGlzLm9wdGlvbnMudGl0bGUgKSB7XG5cdFx0XHR0aXRsZS50ZXh0KCB0aGlzLm9wdGlvbnMudGl0bGUgKTtcblx0XHR9IGVsc2Uge1xuXHRcdFx0dGl0bGUuaHRtbCggXCImIzE2MDtcIiApO1xuXHRcdH1cblx0fSxcblxuXHRfY3JlYXRlQnV0dG9uUGFuZTogZnVuY3Rpb24oKSB7XG5cdFx0dGhpcy51aURpYWxvZ0J1dHRvblBhbmUgPSAkKCBcIjxkaXY+XCIgKTtcblx0XHR0aGlzLl9hZGRDbGFzcyggdGhpcy51aURpYWxvZ0J1dHRvblBhbmUsIFwidWktZGlhbG9nLWJ1dHRvbnBhbmVcIixcblx0XHRcdFwidWktd2lkZ2V0LWNvbnRlbnQgdWktaGVscGVyLWNsZWFyZml4XCIgKTtcblxuXHRcdHRoaXMudWlCdXR0b25TZXQgPSAkKCBcIjxkaXY+XCIgKVxuXHRcdFx0LmFwcGVuZFRvKCB0aGlzLnVpRGlhbG9nQnV0dG9uUGFuZSApO1xuXHRcdHRoaXMuX2FkZENsYXNzKCB0aGlzLnVpQnV0dG9uU2V0LCBcInVpLWRpYWxvZy1idXR0b25zZXRcIiApO1xuXG5cdFx0dGhpcy5fY3JlYXRlQnV0dG9ucygpO1xuXHR9LFxuXG5cdF9jcmVhdGVCdXR0b25zOiBmdW5jdGlvbigpIHtcblx0XHR2YXIgdGhhdCA9IHRoaXMsXG5cdFx0XHRidXR0b25zID0gdGhpcy5vcHRpb25zLmJ1dHRvbnM7XG5cblx0XHQvLyBJZiB3ZSBhbHJlYWR5IGhhdmUgYSBidXR0b24gcGFuZSwgcmVtb3ZlIGl0XG5cdFx0dGhpcy51aURpYWxvZ0J1dHRvblBhbmUucmVtb3ZlKCk7XG5cdFx0dGhpcy51aUJ1dHRvblNldC5lbXB0eSgpO1xuXG5cdFx0aWYgKCAkLmlzRW1wdHlPYmplY3QoIGJ1dHRvbnMgKSB8fCAoICQuaXNBcnJheSggYnV0dG9ucyApICYmICFidXR0b25zLmxlbmd0aCApICkge1xuXHRcdFx0dGhpcy5fcmVtb3ZlQ2xhc3MoIHRoaXMudWlEaWFsb2csIFwidWktZGlhbG9nLWJ1dHRvbnNcIiApO1xuXHRcdFx0cmV0dXJuO1xuXHRcdH1cblxuXHRcdCQuZWFjaCggYnV0dG9ucywgZnVuY3Rpb24oIG5hbWUsIHByb3BzICkge1xuXHRcdFx0dmFyIGNsaWNrLCBidXR0b25PcHRpb25zO1xuXHRcdFx0cHJvcHMgPSAkLmlzRnVuY3Rpb24oIHByb3BzICkgP1xuXHRcdFx0XHR7IGNsaWNrOiBwcm9wcywgdGV4dDogbmFtZSB9IDpcblx0XHRcdFx0cHJvcHM7XG5cblx0XHRcdC8vIERlZmF1bHQgdG8gYSBub24tc3VibWl0dGluZyBidXR0b25cblx0XHRcdHByb3BzID0gJC5leHRlbmQoIHsgdHlwZTogXCJidXR0b25cIiB9LCBwcm9wcyApO1xuXG5cdFx0XHQvLyBDaGFuZ2UgdGhlIGNvbnRleHQgZm9yIHRoZSBjbGljayBjYWxsYmFjayB0byBiZSB0aGUgbWFpbiBlbGVtZW50XG5cdFx0XHRjbGljayA9IHByb3BzLmNsaWNrO1xuXHRcdFx0YnV0dG9uT3B0aW9ucyA9IHtcblx0XHRcdFx0aWNvbjogcHJvcHMuaWNvbixcblx0XHRcdFx0aWNvblBvc2l0aW9uOiBwcm9wcy5pY29uUG9zaXRpb24sXG5cdFx0XHRcdHNob3dMYWJlbDogcHJvcHMuc2hvd0xhYmVsXG5cdFx0XHR9O1xuXG5cdFx0XHRkZWxldGUgcHJvcHMuY2xpY2s7XG5cdFx0XHRkZWxldGUgcHJvcHMuaWNvbjtcblx0XHRcdGRlbGV0ZSBwcm9wcy5pY29uUG9zaXRpb247XG5cdFx0XHRkZWxldGUgcHJvcHMuc2hvd0xhYmVsO1xuXG5cdFx0XHQkKCBcIjxidXR0b24+PC9idXR0b24+XCIsIHByb3BzIClcblx0XHRcdFx0LmJ1dHRvbiggYnV0dG9uT3B0aW9ucyApXG5cdFx0XHRcdC5hcHBlbmRUbyggdGhhdC51aUJ1dHRvblNldCApXG5cdFx0XHRcdC5vbiggXCJjbGlja1wiLCBmdW5jdGlvbigpIHtcblx0XHRcdFx0XHRjbGljay5hcHBseSggdGhhdC5lbGVtZW50WyAwIF0sIGFyZ3VtZW50cyApO1xuXHRcdFx0XHR9ICk7XG5cdFx0fSApO1xuXHRcdHRoaXMuX2FkZENsYXNzKCB0aGlzLnVpRGlhbG9nLCBcInVpLWRpYWxvZy1idXR0b25zXCIgKTtcblx0XHR0aGlzLnVpRGlhbG9nQnV0dG9uUGFuZS5hcHBlbmRUbyggdGhpcy51aURpYWxvZyApO1xuXHR9LFxuXG5cdF9tYWtlRHJhZ2dhYmxlOiBmdW5jdGlvbigpIHtcblx0XHR2YXIgdGhhdCA9IHRoaXMsXG5cdFx0XHRvcHRpb25zID0gdGhpcy5vcHRpb25zO1xuXG5cdFx0ZnVuY3Rpb24gZmlsdGVyZWRVaSggdWkgKSB7XG5cdFx0XHRyZXR1cm4ge1xuXHRcdFx0XHRwb3NpdGlvbjogdWkucG9zaXRpb24sXG5cdFx0XHRcdG9mZnNldDogdWkub2Zmc2V0XG5cdFx0XHR9O1xuXHRcdH1cblxuXHRcdHRoaXMudWlEaWFsb2cuZHJhZ2dhYmxlKCB7XG5cdFx0XHRjYW5jZWw6IFwiLnVpLWRpYWxvZy1jb250ZW50LCAudWktZGlhbG9nLXRpdGxlYmFyLWNsb3NlXCIsXG5cdFx0XHRoYW5kbGU6IFwiLnVpLWRpYWxvZy10aXRsZWJhclwiLFxuXHRcdFx0Y29udGFpbm1lbnQ6IFwiZG9jdW1lbnRcIixcblx0XHRcdHN0YXJ0OiBmdW5jdGlvbiggZXZlbnQsIHVpICkge1xuXHRcdFx0XHR0aGF0Ll9hZGRDbGFzcyggJCggdGhpcyApLCBcInVpLWRpYWxvZy1kcmFnZ2luZ1wiICk7XG5cdFx0XHRcdHRoYXQuX2Jsb2NrRnJhbWVzKCk7XG5cdFx0XHRcdHRoYXQuX3RyaWdnZXIoIFwiZHJhZ1N0YXJ0XCIsIGV2ZW50LCBmaWx0ZXJlZFVpKCB1aSApICk7XG5cdFx0XHR9LFxuXHRcdFx0ZHJhZzogZnVuY3Rpb24oIGV2ZW50LCB1aSApIHtcblx0XHRcdFx0dGhhdC5fdHJpZ2dlciggXCJkcmFnXCIsIGV2ZW50LCBmaWx0ZXJlZFVpKCB1aSApICk7XG5cdFx0XHR9LFxuXHRcdFx0c3RvcDogZnVuY3Rpb24oIGV2ZW50LCB1aSApIHtcblx0XHRcdFx0dmFyIGxlZnQgPSB1aS5vZmZzZXQubGVmdCAtIHRoYXQuZG9jdW1lbnQuc2Nyb2xsTGVmdCgpLFxuXHRcdFx0XHRcdHRvcCA9IHVpLm9mZnNldC50b3AgLSB0aGF0LmRvY3VtZW50LnNjcm9sbFRvcCgpO1xuXG5cdFx0XHRcdG9wdGlvbnMucG9zaXRpb24gPSB7XG5cdFx0XHRcdFx0bXk6IFwibGVmdCB0b3BcIixcblx0XHRcdFx0XHRhdDogXCJsZWZ0XCIgKyAoIGxlZnQgPj0gMCA/IFwiK1wiIDogXCJcIiApICsgbGVmdCArIFwiIFwiICtcblx0XHRcdFx0XHRcdFwidG9wXCIgKyAoIHRvcCA+PSAwID8gXCIrXCIgOiBcIlwiICkgKyB0b3AsXG5cdFx0XHRcdFx0b2Y6IHRoYXQud2luZG93XG5cdFx0XHRcdH07XG5cdFx0XHRcdHRoYXQuX3JlbW92ZUNsYXNzKCAkKCB0aGlzICksIFwidWktZGlhbG9nLWRyYWdnaW5nXCIgKTtcblx0XHRcdFx0dGhhdC5fdW5ibG9ja0ZyYW1lcygpO1xuXHRcdFx0XHR0aGF0Ll90cmlnZ2VyKCBcImRyYWdTdG9wXCIsIGV2ZW50LCBmaWx0ZXJlZFVpKCB1aSApICk7XG5cdFx0XHR9XG5cdFx0fSApO1xuXHR9LFxuXG5cdF9tYWtlUmVzaXphYmxlOiBmdW5jdGlvbigpIHtcblx0XHR2YXIgdGhhdCA9IHRoaXMsXG5cdFx0XHRvcHRpb25zID0gdGhpcy5vcHRpb25zLFxuXHRcdFx0aGFuZGxlcyA9IG9wdGlvbnMucmVzaXphYmxlLFxuXG5cdFx0XHQvLyAudWktcmVzaXphYmxlIGhhcyBwb3NpdGlvbjogcmVsYXRpdmUgZGVmaW5lZCBpbiB0aGUgc3R5bGVzaGVldFxuXHRcdFx0Ly8gYnV0IGRpYWxvZ3MgaGF2ZSB0byB1c2UgYWJzb2x1dGUgb3IgZml4ZWQgcG9zaXRpb25pbmdcblx0XHRcdHBvc2l0aW9uID0gdGhpcy51aURpYWxvZy5jc3MoIFwicG9zaXRpb25cIiApLFxuXHRcdFx0cmVzaXplSGFuZGxlcyA9IHR5cGVvZiBoYW5kbGVzID09PSBcInN0cmluZ1wiID9cblx0XHRcdFx0aGFuZGxlcyA6XG5cdFx0XHRcdFwibixlLHMsdyxzZSxzdyxuZSxud1wiO1xuXG5cdFx0ZnVuY3Rpb24gZmlsdGVyZWRVaSggdWkgKSB7XG5cdFx0XHRyZXR1cm4ge1xuXHRcdFx0XHRvcmlnaW5hbFBvc2l0aW9uOiB1aS5vcmlnaW5hbFBvc2l0aW9uLFxuXHRcdFx0XHRvcmlnaW5hbFNpemU6IHVpLm9yaWdpbmFsU2l6ZSxcblx0XHRcdFx0cG9zaXRpb246IHVpLnBvc2l0aW9uLFxuXHRcdFx0XHRzaXplOiB1aS5zaXplXG5cdFx0XHR9O1xuXHRcdH1cblxuXHRcdHRoaXMudWlEaWFsb2cucmVzaXphYmxlKCB7XG5cdFx0XHRjYW5jZWw6IFwiLnVpLWRpYWxvZy1jb250ZW50XCIsXG5cdFx0XHRjb250YWlubWVudDogXCJkb2N1bWVudFwiLFxuXHRcdFx0YWxzb1Jlc2l6ZTogdGhpcy5lbGVtZW50LFxuXHRcdFx0bWF4V2lkdGg6IG9wdGlvbnMubWF4V2lkdGgsXG5cdFx0XHRtYXhIZWlnaHQ6IG9wdGlvbnMubWF4SGVpZ2h0LFxuXHRcdFx0bWluV2lkdGg6IG9wdGlvbnMubWluV2lkdGgsXG5cdFx0XHRtaW5IZWlnaHQ6IHRoaXMuX21pbkhlaWdodCgpLFxuXHRcdFx0aGFuZGxlczogcmVzaXplSGFuZGxlcyxcblx0XHRcdHN0YXJ0OiBmdW5jdGlvbiggZXZlbnQsIHVpICkge1xuXHRcdFx0XHR0aGF0Ll9hZGRDbGFzcyggJCggdGhpcyApLCBcInVpLWRpYWxvZy1yZXNpemluZ1wiICk7XG5cdFx0XHRcdHRoYXQuX2Jsb2NrRnJhbWVzKCk7XG5cdFx0XHRcdHRoYXQuX3RyaWdnZXIoIFwicmVzaXplU3RhcnRcIiwgZXZlbnQsIGZpbHRlcmVkVWkoIHVpICkgKTtcblx0XHRcdH0sXG5cdFx0XHRyZXNpemU6IGZ1bmN0aW9uKCBldmVudCwgdWkgKSB7XG5cdFx0XHRcdHRoYXQuX3RyaWdnZXIoIFwicmVzaXplXCIsIGV2ZW50LCBmaWx0ZXJlZFVpKCB1aSApICk7XG5cdFx0XHR9LFxuXHRcdFx0c3RvcDogZnVuY3Rpb24oIGV2ZW50LCB1aSApIHtcblx0XHRcdFx0dmFyIG9mZnNldCA9IHRoYXQudWlEaWFsb2cub2Zmc2V0KCksXG5cdFx0XHRcdFx0bGVmdCA9IG9mZnNldC5sZWZ0IC0gdGhhdC5kb2N1bWVudC5zY3JvbGxMZWZ0KCksXG5cdFx0XHRcdFx0dG9wID0gb2Zmc2V0LnRvcCAtIHRoYXQuZG9jdW1lbnQuc2Nyb2xsVG9wKCk7XG5cblx0XHRcdFx0b3B0aW9ucy5oZWlnaHQgPSB0aGF0LnVpRGlhbG9nLmhlaWdodCgpO1xuXHRcdFx0XHRvcHRpb25zLndpZHRoID0gdGhhdC51aURpYWxvZy53aWR0aCgpO1xuXHRcdFx0XHRvcHRpb25zLnBvc2l0aW9uID0ge1xuXHRcdFx0XHRcdG15OiBcImxlZnQgdG9wXCIsXG5cdFx0XHRcdFx0YXQ6IFwibGVmdFwiICsgKCBsZWZ0ID49IDAgPyBcIitcIiA6IFwiXCIgKSArIGxlZnQgKyBcIiBcIiArXG5cdFx0XHRcdFx0XHRcInRvcFwiICsgKCB0b3AgPj0gMCA/IFwiK1wiIDogXCJcIiApICsgdG9wLFxuXHRcdFx0XHRcdG9mOiB0aGF0LndpbmRvd1xuXHRcdFx0XHR9O1xuXHRcdFx0XHR0aGF0Ll9yZW1vdmVDbGFzcyggJCggdGhpcyApLCBcInVpLWRpYWxvZy1yZXNpemluZ1wiICk7XG5cdFx0XHRcdHRoYXQuX3VuYmxvY2tGcmFtZXMoKTtcblx0XHRcdFx0dGhhdC5fdHJpZ2dlciggXCJyZXNpemVTdG9wXCIsIGV2ZW50LCBmaWx0ZXJlZFVpKCB1aSApICk7XG5cdFx0XHR9XG5cdFx0fSApXG5cdFx0XHQuY3NzKCBcInBvc2l0aW9uXCIsIHBvc2l0aW9uICk7XG5cdH0sXG5cblx0X3RyYWNrRm9jdXM6IGZ1bmN0aW9uKCkge1xuXHRcdHRoaXMuX29uKCB0aGlzLndpZGdldCgpLCB7XG5cdFx0XHRmb2N1c2luOiBmdW5jdGlvbiggZXZlbnQgKSB7XG5cdFx0XHRcdHRoaXMuX21ha2VGb2N1c1RhcmdldCgpO1xuXHRcdFx0XHR0aGlzLl9mb2N1c2VkRWxlbWVudCA9ICQoIGV2ZW50LnRhcmdldCApO1xuXHRcdFx0fVxuXHRcdH0gKTtcblx0fSxcblxuXHRfbWFrZUZvY3VzVGFyZ2V0OiBmdW5jdGlvbigpIHtcblx0XHR0aGlzLl91bnRyYWNrSW5zdGFuY2UoKTtcblx0XHR0aGlzLl90cmFja2luZ0luc3RhbmNlcygpLnVuc2hpZnQoIHRoaXMgKTtcblx0fSxcblxuXHRfdW50cmFja0luc3RhbmNlOiBmdW5jdGlvbigpIHtcblx0XHR2YXIgaW5zdGFuY2VzID0gdGhpcy5fdHJhY2tpbmdJbnN0YW5jZXMoKSxcblx0XHRcdGV4aXN0cyA9ICQuaW5BcnJheSggdGhpcywgaW5zdGFuY2VzICk7XG5cdFx0aWYgKCBleGlzdHMgIT09IC0xICkge1xuXHRcdFx0aW5zdGFuY2VzLnNwbGljZSggZXhpc3RzLCAxICk7XG5cdFx0fVxuXHR9LFxuXG5cdF90cmFja2luZ0luc3RhbmNlczogZnVuY3Rpb24oKSB7XG5cdFx0dmFyIGluc3RhbmNlcyA9IHRoaXMuZG9jdW1lbnQuZGF0YSggXCJ1aS1kaWFsb2ctaW5zdGFuY2VzXCIgKTtcblx0XHRpZiAoICFpbnN0YW5jZXMgKSB7XG5cdFx0XHRpbnN0YW5jZXMgPSBbXTtcblx0XHRcdHRoaXMuZG9jdW1lbnQuZGF0YSggXCJ1aS1kaWFsb2ctaW5zdGFuY2VzXCIsIGluc3RhbmNlcyApO1xuXHRcdH1cblx0XHRyZXR1cm4gaW5zdGFuY2VzO1xuXHR9LFxuXG5cdF9taW5IZWlnaHQ6IGZ1bmN0aW9uKCkge1xuXHRcdHZhciBvcHRpb25zID0gdGhpcy5vcHRpb25zO1xuXG5cdFx0cmV0dXJuIG9wdGlvbnMuaGVpZ2h0ID09PSBcImF1dG9cIiA/XG5cdFx0XHRvcHRpb25zLm1pbkhlaWdodCA6XG5cdFx0XHRNYXRoLm1pbiggb3B0aW9ucy5taW5IZWlnaHQsIG9wdGlvbnMuaGVpZ2h0ICk7XG5cdH0sXG5cblx0X3Bvc2l0aW9uOiBmdW5jdGlvbigpIHtcblxuXHRcdC8vIE5lZWQgdG8gc2hvdyB0aGUgZGlhbG9nIHRvIGdldCB0aGUgYWN0dWFsIG9mZnNldCBpbiB0aGUgcG9zaXRpb24gcGx1Z2luXG5cdFx0dmFyIGlzVmlzaWJsZSA9IHRoaXMudWlEaWFsb2cuaXMoIFwiOnZpc2libGVcIiApO1xuXHRcdGlmICggIWlzVmlzaWJsZSApIHtcblx0XHRcdHRoaXMudWlEaWFsb2cuc2hvdygpO1xuXHRcdH1cblx0XHR0aGlzLnVpRGlhbG9nLnBvc2l0aW9uKCB0aGlzLm9wdGlvbnMucG9zaXRpb24gKTtcblx0XHRpZiAoICFpc1Zpc2libGUgKSB7XG5cdFx0XHR0aGlzLnVpRGlhbG9nLmhpZGUoKTtcblx0XHR9XG5cdH0sXG5cblx0X3NldE9wdGlvbnM6IGZ1bmN0aW9uKCBvcHRpb25zICkge1xuXHRcdHZhciB0aGF0ID0gdGhpcyxcblx0XHRcdHJlc2l6ZSA9IGZhbHNlLFxuXHRcdFx0cmVzaXphYmxlT3B0aW9ucyA9IHt9O1xuXG5cdFx0JC5lYWNoKCBvcHRpb25zLCBmdW5jdGlvbigga2V5LCB2YWx1ZSApIHtcblx0XHRcdHRoYXQuX3NldE9wdGlvbigga2V5LCB2YWx1ZSApO1xuXG5cdFx0XHRpZiAoIGtleSBpbiB0aGF0LnNpemVSZWxhdGVkT3B0aW9ucyApIHtcblx0XHRcdFx0cmVzaXplID0gdHJ1ZTtcblx0XHRcdH1cblx0XHRcdGlmICgga2V5IGluIHRoYXQucmVzaXphYmxlUmVsYXRlZE9wdGlvbnMgKSB7XG5cdFx0XHRcdHJlc2l6YWJsZU9wdGlvbnNbIGtleSBdID0gdmFsdWU7XG5cdFx0XHR9XG5cdFx0fSApO1xuXG5cdFx0aWYgKCByZXNpemUgKSB7XG5cdFx0XHR0aGlzLl9zaXplKCk7XG5cdFx0XHR0aGlzLl9wb3NpdGlvbigpO1xuXHRcdH1cblx0XHRpZiAoIHRoaXMudWlEaWFsb2cuaXMoIFwiOmRhdGEodWktcmVzaXphYmxlKVwiICkgKSB7XG5cdFx0XHR0aGlzLnVpRGlhbG9nLnJlc2l6YWJsZSggXCJvcHRpb25cIiwgcmVzaXphYmxlT3B0aW9ucyApO1xuXHRcdH1cblx0fSxcblxuXHRfc2V0T3B0aW9uOiBmdW5jdGlvbigga2V5LCB2YWx1ZSApIHtcblx0XHR2YXIgaXNEcmFnZ2FibGUsIGlzUmVzaXphYmxlLFxuXHRcdFx0dWlEaWFsb2cgPSB0aGlzLnVpRGlhbG9nO1xuXG5cdFx0aWYgKCBrZXkgPT09IFwiZGlzYWJsZWRcIiApIHtcblx0XHRcdHJldHVybjtcblx0XHR9XG5cblx0XHR0aGlzLl9zdXBlcigga2V5LCB2YWx1ZSApO1xuXG5cdFx0aWYgKCBrZXkgPT09IFwiYXBwZW5kVG9cIiApIHtcblx0XHRcdHRoaXMudWlEaWFsb2cuYXBwZW5kVG8oIHRoaXMuX2FwcGVuZFRvKCkgKTtcblx0XHR9XG5cblx0XHRpZiAoIGtleSA9PT0gXCJidXR0b25zXCIgKSB7XG5cdFx0XHR0aGlzLl9jcmVhdGVCdXR0b25zKCk7XG5cdFx0fVxuXG5cdFx0aWYgKCBrZXkgPT09IFwiY2xvc2VUZXh0XCIgKSB7XG5cdFx0XHR0aGlzLnVpRGlhbG9nVGl0bGViYXJDbG9zZS5idXR0b24oIHtcblxuXHRcdFx0XHQvLyBFbnN1cmUgdGhhdCB3ZSBhbHdheXMgcGFzcyBhIHN0cmluZ1xuXHRcdFx0XHRsYWJlbDogJCggXCI8YT5cIiApLnRleHQoIFwiXCIgKyB0aGlzLm9wdGlvbnMuY2xvc2VUZXh0ICkuaHRtbCgpXG5cdFx0XHR9ICk7XG5cdFx0fVxuXG5cdFx0aWYgKCBrZXkgPT09IFwiZHJhZ2dhYmxlXCIgKSB7XG5cdFx0XHRpc0RyYWdnYWJsZSA9IHVpRGlhbG9nLmlzKCBcIjpkYXRhKHVpLWRyYWdnYWJsZSlcIiApO1xuXHRcdFx0aWYgKCBpc0RyYWdnYWJsZSAmJiAhdmFsdWUgKSB7XG5cdFx0XHRcdHVpRGlhbG9nLmRyYWdnYWJsZSggXCJkZXN0cm95XCIgKTtcblx0XHRcdH1cblxuXHRcdFx0aWYgKCAhaXNEcmFnZ2FibGUgJiYgdmFsdWUgKSB7XG5cdFx0XHRcdHRoaXMuX21ha2VEcmFnZ2FibGUoKTtcblx0XHRcdH1cblx0XHR9XG5cblx0XHRpZiAoIGtleSA9PT0gXCJwb3NpdGlvblwiICkge1xuXHRcdFx0dGhpcy5fcG9zaXRpb24oKTtcblx0XHR9XG5cblx0XHRpZiAoIGtleSA9PT0gXCJyZXNpemFibGVcIiApIHtcblxuXHRcdFx0Ly8gY3VycmVudGx5IHJlc2l6YWJsZSwgYmVjb21pbmcgbm9uLXJlc2l6YWJsZVxuXHRcdFx0aXNSZXNpemFibGUgPSB1aURpYWxvZy5pcyggXCI6ZGF0YSh1aS1yZXNpemFibGUpXCIgKTtcblx0XHRcdGlmICggaXNSZXNpemFibGUgJiYgIXZhbHVlICkge1xuXHRcdFx0XHR1aURpYWxvZy5yZXNpemFibGUoIFwiZGVzdHJveVwiICk7XG5cdFx0XHR9XG5cblx0XHRcdC8vIEN1cnJlbnRseSByZXNpemFibGUsIGNoYW5naW5nIGhhbmRsZXNcblx0XHRcdGlmICggaXNSZXNpemFibGUgJiYgdHlwZW9mIHZhbHVlID09PSBcInN0cmluZ1wiICkge1xuXHRcdFx0XHR1aURpYWxvZy5yZXNpemFibGUoIFwib3B0aW9uXCIsIFwiaGFuZGxlc1wiLCB2YWx1ZSApO1xuXHRcdFx0fVxuXG5cdFx0XHQvLyBDdXJyZW50bHkgbm9uLXJlc2l6YWJsZSwgYmVjb21pbmcgcmVzaXphYmxlXG5cdFx0XHRpZiAoICFpc1Jlc2l6YWJsZSAmJiB2YWx1ZSAhPT0gZmFsc2UgKSB7XG5cdFx0XHRcdHRoaXMuX21ha2VSZXNpemFibGUoKTtcblx0XHRcdH1cblx0XHR9XG5cblx0XHRpZiAoIGtleSA9PT0gXCJ0aXRsZVwiICkge1xuXHRcdFx0dGhpcy5fdGl0bGUoIHRoaXMudWlEaWFsb2dUaXRsZWJhci5maW5kKCBcIi51aS1kaWFsb2ctdGl0bGVcIiApICk7XG5cdFx0fVxuXHR9LFxuXG5cdF9zaXplOiBmdW5jdGlvbigpIHtcblxuXHRcdC8vIElmIHRoZSB1c2VyIGhhcyByZXNpemVkIHRoZSBkaWFsb2csIHRoZSAudWktZGlhbG9nIGFuZCAudWktZGlhbG9nLWNvbnRlbnRcblx0XHQvLyBkaXZzIHdpbGwgYm90aCBoYXZlIHdpZHRoIGFuZCBoZWlnaHQgc2V0LCBzbyB3ZSBuZWVkIHRvIHJlc2V0IHRoZW1cblx0XHR2YXIgbm9uQ29udGVudEhlaWdodCwgbWluQ29udGVudEhlaWdodCwgbWF4Q29udGVudEhlaWdodCxcblx0XHRcdG9wdGlvbnMgPSB0aGlzLm9wdGlvbnM7XG5cblx0XHQvLyBSZXNldCBjb250ZW50IHNpemluZ1xuXHRcdHRoaXMuZWxlbWVudC5zaG93KCkuY3NzKCB7XG5cdFx0XHR3aWR0aDogXCJhdXRvXCIsXG5cdFx0XHRtaW5IZWlnaHQ6IDAsXG5cdFx0XHRtYXhIZWlnaHQ6IFwibm9uZVwiLFxuXHRcdFx0aGVpZ2h0OiAwXG5cdFx0fSApO1xuXG5cdFx0aWYgKCBvcHRpb25zLm1pbldpZHRoID4gb3B0aW9ucy53aWR0aCApIHtcblx0XHRcdG9wdGlvbnMud2lkdGggPSBvcHRpb25zLm1pbldpZHRoO1xuXHRcdH1cblxuXHRcdC8vIFJlc2V0IHdyYXBwZXIgc2l6aW5nXG5cdFx0Ly8gZGV0ZXJtaW5lIHRoZSBoZWlnaHQgb2YgYWxsIHRoZSBub24tY29udGVudCBlbGVtZW50c1xuXHRcdG5vbkNvbnRlbnRIZWlnaHQgPSB0aGlzLnVpRGlhbG9nLmNzcygge1xuXHRcdFx0aGVpZ2h0OiBcImF1dG9cIixcblx0XHRcdHdpZHRoOiBvcHRpb25zLndpZHRoXG5cdFx0fSApXG5cdFx0XHQub3V0ZXJIZWlnaHQoKTtcblx0XHRtaW5Db250ZW50SGVpZ2h0ID0gTWF0aC5tYXgoIDAsIG9wdGlvbnMubWluSGVpZ2h0IC0gbm9uQ29udGVudEhlaWdodCApO1xuXHRcdG1heENvbnRlbnRIZWlnaHQgPSB0eXBlb2Ygb3B0aW9ucy5tYXhIZWlnaHQgPT09IFwibnVtYmVyXCIgP1xuXHRcdFx0TWF0aC5tYXgoIDAsIG9wdGlvbnMubWF4SGVpZ2h0IC0gbm9uQ29udGVudEhlaWdodCApIDpcblx0XHRcdFwibm9uZVwiO1xuXG5cdFx0aWYgKCBvcHRpb25zLmhlaWdodCA9PT0gXCJhdXRvXCIgKSB7XG5cdFx0XHR0aGlzLmVsZW1lbnQuY3NzKCB7XG5cdFx0XHRcdG1pbkhlaWdodDogbWluQ29udGVudEhlaWdodCxcblx0XHRcdFx0bWF4SGVpZ2h0OiBtYXhDb250ZW50SGVpZ2h0LFxuXHRcdFx0XHRoZWlnaHQ6IFwiYXV0b1wiXG5cdFx0XHR9ICk7XG5cdFx0fSBlbHNlIHtcblx0XHRcdHRoaXMuZWxlbWVudC5oZWlnaHQoIE1hdGgubWF4KCAwLCBvcHRpb25zLmhlaWdodCAtIG5vbkNvbnRlbnRIZWlnaHQgKSApO1xuXHRcdH1cblxuXHRcdGlmICggdGhpcy51aURpYWxvZy5pcyggXCI6ZGF0YSh1aS1yZXNpemFibGUpXCIgKSApIHtcblx0XHRcdHRoaXMudWlEaWFsb2cucmVzaXphYmxlKCBcIm9wdGlvblwiLCBcIm1pbkhlaWdodFwiLCB0aGlzLl9taW5IZWlnaHQoKSApO1xuXHRcdH1cblx0fSxcblxuXHRfYmxvY2tGcmFtZXM6IGZ1bmN0aW9uKCkge1xuXHRcdHRoaXMuaWZyYW1lQmxvY2tzID0gdGhpcy5kb2N1bWVudC5maW5kKCBcImlmcmFtZVwiICkubWFwKCBmdW5jdGlvbigpIHtcblx0XHRcdHZhciBpZnJhbWUgPSAkKCB0aGlzICk7XG5cblx0XHRcdHJldHVybiAkKCBcIjxkaXY+XCIgKVxuXHRcdFx0XHQuY3NzKCB7XG5cdFx0XHRcdFx0cG9zaXRpb246IFwiYWJzb2x1dGVcIixcblx0XHRcdFx0XHR3aWR0aDogaWZyYW1lLm91dGVyV2lkdGgoKSxcblx0XHRcdFx0XHRoZWlnaHQ6IGlmcmFtZS5vdXRlckhlaWdodCgpXG5cdFx0XHRcdH0gKVxuXHRcdFx0XHQuYXBwZW5kVG8oIGlmcmFtZS5wYXJlbnQoKSApXG5cdFx0XHRcdC5vZmZzZXQoIGlmcmFtZS5vZmZzZXQoKSApWyAwIF07XG5cdFx0fSApO1xuXHR9LFxuXG5cdF91bmJsb2NrRnJhbWVzOiBmdW5jdGlvbigpIHtcblx0XHRpZiAoIHRoaXMuaWZyYW1lQmxvY2tzICkge1xuXHRcdFx0dGhpcy5pZnJhbWVCbG9ja3MucmVtb3ZlKCk7XG5cdFx0XHRkZWxldGUgdGhpcy5pZnJhbWVCbG9ja3M7XG5cdFx0fVxuXHR9LFxuXG5cdF9hbGxvd0ludGVyYWN0aW9uOiBmdW5jdGlvbiggZXZlbnQgKSB7XG5cdFx0aWYgKCAkKCBldmVudC50YXJnZXQgKS5jbG9zZXN0KCBcIi51aS1kaWFsb2dcIiApLmxlbmd0aCApIHtcblx0XHRcdHJldHVybiB0cnVlO1xuXHRcdH1cblxuXHRcdC8vIFRPRE86IFJlbW92ZSBoYWNrIHdoZW4gZGF0ZXBpY2tlciBpbXBsZW1lbnRzXG5cdFx0Ly8gdGhlIC51aS1mcm9udCBsb2dpYyAoIzg5ODkpXG5cdFx0cmV0dXJuICEhJCggZXZlbnQudGFyZ2V0ICkuY2xvc2VzdCggXCIudWktZGF0ZXBpY2tlclwiICkubGVuZ3RoO1xuXHR9LFxuXG5cdF9jcmVhdGVPdmVybGF5OiBmdW5jdGlvbigpIHtcblx0XHRpZiAoICF0aGlzLm9wdGlvbnMubW9kYWwgKSB7XG5cdFx0XHRyZXR1cm47XG5cdFx0fVxuXG5cdFx0Ly8gV2UgdXNlIGEgZGVsYXkgaW4gY2FzZSB0aGUgb3ZlcmxheSBpcyBjcmVhdGVkIGZyb20gYW5cblx0XHQvLyBldmVudCB0aGF0IHdlJ3JlIGdvaW5nIHRvIGJlIGNhbmNlbGxpbmcgKCMyODA0KVxuXHRcdHZhciBpc09wZW5pbmcgPSB0cnVlO1xuXHRcdHRoaXMuX2RlbGF5KCBmdW5jdGlvbigpIHtcblx0XHRcdGlzT3BlbmluZyA9IGZhbHNlO1xuXHRcdH0gKTtcblxuXHRcdGlmICggIXRoaXMuZG9jdW1lbnQuZGF0YSggXCJ1aS1kaWFsb2ctb3ZlcmxheXNcIiApICkge1xuXG5cdFx0XHQvLyBQcmV2ZW50IHVzZSBvZiBhbmNob3JzIGFuZCBpbnB1dHNcblx0XHRcdC8vIFVzaW5nIF9vbigpIGZvciBhbiBldmVudCBoYW5kbGVyIHNoYXJlZCBhY3Jvc3MgbWFueSBpbnN0YW5jZXMgaXNcblx0XHRcdC8vIHNhZmUgYmVjYXVzZSB0aGUgZGlhbG9ncyBzdGFjayBhbmQgbXVzdCBiZSBjbG9zZWQgaW4gcmV2ZXJzZSBvcmRlclxuXHRcdFx0dGhpcy5fb24oIHRoaXMuZG9jdW1lbnQsIHtcblx0XHRcdFx0Zm9jdXNpbjogZnVuY3Rpb24oIGV2ZW50ICkge1xuXHRcdFx0XHRcdGlmICggaXNPcGVuaW5nICkge1xuXHRcdFx0XHRcdFx0cmV0dXJuO1xuXHRcdFx0XHRcdH1cblxuXHRcdFx0XHRcdGlmICggIXRoaXMuX2FsbG93SW50ZXJhY3Rpb24oIGV2ZW50ICkgKSB7XG5cdFx0XHRcdFx0XHRldmVudC5wcmV2ZW50RGVmYXVsdCgpO1xuXHRcdFx0XHRcdFx0dGhpcy5fdHJhY2tpbmdJbnN0YW5jZXMoKVsgMCBdLl9mb2N1c1RhYmJhYmxlKCk7XG5cdFx0XHRcdFx0fVxuXHRcdFx0XHR9XG5cdFx0XHR9ICk7XG5cdFx0fVxuXG5cdFx0dGhpcy5vdmVybGF5ID0gJCggXCI8ZGl2PlwiIClcblx0XHRcdC5hcHBlbmRUbyggdGhpcy5fYXBwZW5kVG8oKSApO1xuXG5cdFx0dGhpcy5fYWRkQ2xhc3MoIHRoaXMub3ZlcmxheSwgbnVsbCwgXCJ1aS13aWRnZXQtb3ZlcmxheSB1aS1mcm9udFwiICk7XG5cdFx0dGhpcy5fb24oIHRoaXMub3ZlcmxheSwge1xuXHRcdFx0bW91c2Vkb3duOiBcIl9rZWVwRm9jdXNcIlxuXHRcdH0gKTtcblx0XHR0aGlzLmRvY3VtZW50LmRhdGEoIFwidWktZGlhbG9nLW92ZXJsYXlzXCIsXG5cdFx0XHQoIHRoaXMuZG9jdW1lbnQuZGF0YSggXCJ1aS1kaWFsb2ctb3ZlcmxheXNcIiApIHx8IDAgKSArIDEgKTtcblx0fSxcblxuXHRfZGVzdHJveU92ZXJsYXk6IGZ1bmN0aW9uKCkge1xuXHRcdGlmICggIXRoaXMub3B0aW9ucy5tb2RhbCApIHtcblx0XHRcdHJldHVybjtcblx0XHR9XG5cblx0XHRpZiAoIHRoaXMub3ZlcmxheSApIHtcblx0XHRcdHZhciBvdmVybGF5cyA9IHRoaXMuZG9jdW1lbnQuZGF0YSggXCJ1aS1kaWFsb2ctb3ZlcmxheXNcIiApIC0gMTtcblxuXHRcdFx0aWYgKCAhb3ZlcmxheXMgKSB7XG5cdFx0XHRcdHRoaXMuX29mZiggdGhpcy5kb2N1bWVudCwgXCJmb2N1c2luXCIgKTtcblx0XHRcdFx0dGhpcy5kb2N1bWVudC5yZW1vdmVEYXRhKCBcInVpLWRpYWxvZy1vdmVybGF5c1wiICk7XG5cdFx0XHR9IGVsc2Uge1xuXHRcdFx0XHR0aGlzLmRvY3VtZW50LmRhdGEoIFwidWktZGlhbG9nLW92ZXJsYXlzXCIsIG92ZXJsYXlzICk7XG5cdFx0XHR9XG5cblx0XHRcdHRoaXMub3ZlcmxheS5yZW1vdmUoKTtcblx0XHRcdHRoaXMub3ZlcmxheSA9IG51bGw7XG5cdFx0fVxuXHR9XG59ICk7XG5cbi8vIERFUFJFQ0FURURcbi8vIFRPRE86IHN3aXRjaCByZXR1cm4gYmFjayB0byB3aWRnZXQgZGVjbGFyYXRpb24gYXQgdG9wIG9mIGZpbGUgd2hlbiB0aGlzIGlzIHJlbW92ZWRcbmlmICggJC51aUJhY2tDb21wYXQgIT09IGZhbHNlICkge1xuXG5cdC8vIEJhY2tjb21wYXQgZm9yIGRpYWxvZ0NsYXNzIG9wdGlvblxuXHQkLndpZGdldCggXCJ1aS5kaWFsb2dcIiwgJC51aS5kaWFsb2csIHtcblx0XHRvcHRpb25zOiB7XG5cdFx0XHRkaWFsb2dDbGFzczogXCJcIlxuXHRcdH0sXG5cdFx0X2NyZWF0ZVdyYXBwZXI6IGZ1bmN0aW9uKCkge1xuXHRcdFx0dGhpcy5fc3VwZXIoKTtcblx0XHRcdHRoaXMudWlEaWFsb2cuYWRkQ2xhc3MoIHRoaXMub3B0aW9ucy5kaWFsb2dDbGFzcyApO1xuXHRcdH0sXG5cdFx0X3NldE9wdGlvbjogZnVuY3Rpb24oIGtleSwgdmFsdWUgKSB7XG5cdFx0XHRpZiAoIGtleSA9PT0gXCJkaWFsb2dDbGFzc1wiICkge1xuXHRcdFx0XHR0aGlzLnVpRGlhbG9nXG5cdFx0XHRcdFx0LnJlbW92ZUNsYXNzKCB0aGlzLm9wdGlvbnMuZGlhbG9nQ2xhc3MgKVxuXHRcdFx0XHRcdC5hZGRDbGFzcyggdmFsdWUgKTtcblx0XHRcdH1cblx0XHRcdHRoaXMuX3N1cGVyQXBwbHkoIGFyZ3VtZW50cyApO1xuXHRcdH1cblx0fSApO1xufVxuXG5yZXR1cm4gJC51aS5kaWFsb2c7XG5cbn0gKSApO1xuIiwiLyohXG4gKiBqUXVlcnkgVUkgRHJhZ2dhYmxlIDEuMTIuMFxuICogaHR0cDovL2pxdWVyeXVpLmNvbVxuICpcbiAqIENvcHlyaWdodCBqUXVlcnkgRm91bmRhdGlvbiBhbmQgb3RoZXIgY29udHJpYnV0b3JzXG4gKiBSZWxlYXNlZCB1bmRlciB0aGUgTUlUIGxpY2Vuc2UuXG4gKiBodHRwOi8vanF1ZXJ5Lm9yZy9saWNlbnNlXG4gKi9cblxuLy8+PmxhYmVsOiBEcmFnZ2FibGVcbi8vPj5ncm91cDogSW50ZXJhY3Rpb25zXG4vLz4+ZGVzY3JpcHRpb246IEVuYWJsZXMgZHJhZ2dpbmcgZnVuY3Rpb25hbGl0eSBmb3IgYW55IGVsZW1lbnQuXG4vLz4+ZG9jczogaHR0cDovL2FwaS5qcXVlcnl1aS5jb20vZHJhZ2dhYmxlL1xuLy8+PmRlbW9zOiBodHRwOi8vanF1ZXJ5dWkuY29tL2RyYWdnYWJsZS9cbi8vPj5jc3Muc3RydWN0dXJlOiAuLi8uLi90aGVtZXMvYmFzZS9kcmFnZ2FibGUuY3NzXG5cbiggZnVuY3Rpb24oIGZhY3RvcnkgKSB7XG5cdGlmICggdHlwZW9mIGRlZmluZSA9PT0gXCJmdW5jdGlvblwiICYmIGRlZmluZS5hbWQgKSB7XG5cblx0XHQvLyBBTUQuIFJlZ2lzdGVyIGFzIGFuIGFub255bW91cyBtb2R1bGUuXG5cdFx0ZGVmaW5lKCBbXG5cdFx0XHRcImpxdWVyeVwiLFxuXHRcdFx0XCIuL21vdXNlXCIsXG5cdFx0XHRcIi4uL2RhdGFcIixcblx0XHRcdFwiLi4vcGx1Z2luXCIsXG5cdFx0XHRcIi4uL3NhZmUtYWN0aXZlLWVsZW1lbnRcIixcblx0XHRcdFwiLi4vc2FmZS1ibHVyXCIsXG5cdFx0XHRcIi4uL3Njcm9sbC1wYXJlbnRcIixcblx0XHRcdFwiLi4vdmVyc2lvblwiLFxuXHRcdFx0XCIuLi93aWRnZXRcIlxuXHRcdF0sIGZhY3RvcnkgKTtcblx0fSBlbHNlIHtcblxuXHRcdC8vIEJyb3dzZXIgZ2xvYmFsc1xuXHRcdGZhY3RvcnkoIGpRdWVyeSApO1xuXHR9XG59KCBmdW5jdGlvbiggJCApIHtcblxuJC53aWRnZXQoIFwidWkuZHJhZ2dhYmxlXCIsICQudWkubW91c2UsIHtcblx0dmVyc2lvbjogXCIxLjEyLjBcIixcblx0d2lkZ2V0RXZlbnRQcmVmaXg6IFwiZHJhZ1wiLFxuXHRvcHRpb25zOiB7XG5cdFx0YWRkQ2xhc3NlczogdHJ1ZSxcblx0XHRhcHBlbmRUbzogXCJwYXJlbnRcIixcblx0XHRheGlzOiBmYWxzZSxcblx0XHRjb25uZWN0VG9Tb3J0YWJsZTogZmFsc2UsXG5cdFx0Y29udGFpbm1lbnQ6IGZhbHNlLFxuXHRcdGN1cnNvcjogXCJhdXRvXCIsXG5cdFx0Y3Vyc29yQXQ6IGZhbHNlLFxuXHRcdGdyaWQ6IGZhbHNlLFxuXHRcdGhhbmRsZTogZmFsc2UsXG5cdFx0aGVscGVyOiBcIm9yaWdpbmFsXCIsXG5cdFx0aWZyYW1lRml4OiBmYWxzZSxcblx0XHRvcGFjaXR5OiBmYWxzZSxcblx0XHRyZWZyZXNoUG9zaXRpb25zOiBmYWxzZSxcblx0XHRyZXZlcnQ6IGZhbHNlLFxuXHRcdHJldmVydER1cmF0aW9uOiA1MDAsXG5cdFx0c2NvcGU6IFwiZGVmYXVsdFwiLFxuXHRcdHNjcm9sbDogdHJ1ZSxcblx0XHRzY3JvbGxTZW5zaXRpdml0eTogMjAsXG5cdFx0c2Nyb2xsU3BlZWQ6IDIwLFxuXHRcdHNuYXA6IGZhbHNlLFxuXHRcdHNuYXBNb2RlOiBcImJvdGhcIixcblx0XHRzbmFwVG9sZXJhbmNlOiAyMCxcblx0XHRzdGFjazogZmFsc2UsXG5cdFx0ekluZGV4OiBmYWxzZSxcblxuXHRcdC8vIENhbGxiYWNrc1xuXHRcdGRyYWc6IG51bGwsXG5cdFx0c3RhcnQ6IG51bGwsXG5cdFx0c3RvcDogbnVsbFxuXHR9LFxuXHRfY3JlYXRlOiBmdW5jdGlvbigpIHtcblxuXHRcdGlmICggdGhpcy5vcHRpb25zLmhlbHBlciA9PT0gXCJvcmlnaW5hbFwiICkge1xuXHRcdFx0dGhpcy5fc2V0UG9zaXRpb25SZWxhdGl2ZSgpO1xuXHRcdH1cblx0XHRpZiAoIHRoaXMub3B0aW9ucy5hZGRDbGFzc2VzICkge1xuXHRcdFx0dGhpcy5fYWRkQ2xhc3MoIFwidWktZHJhZ2dhYmxlXCIgKTtcblx0XHR9XG5cdFx0dGhpcy5fc2V0SGFuZGxlQ2xhc3NOYW1lKCk7XG5cblx0XHR0aGlzLl9tb3VzZUluaXQoKTtcblx0fSxcblxuXHRfc2V0T3B0aW9uOiBmdW5jdGlvbigga2V5LCB2YWx1ZSApIHtcblx0XHR0aGlzLl9zdXBlcigga2V5LCB2YWx1ZSApO1xuXHRcdGlmICgga2V5ID09PSBcImhhbmRsZVwiICkge1xuXHRcdFx0dGhpcy5fcmVtb3ZlSGFuZGxlQ2xhc3NOYW1lKCk7XG5cdFx0XHR0aGlzLl9zZXRIYW5kbGVDbGFzc05hbWUoKTtcblx0XHR9XG5cdH0sXG5cblx0X2Rlc3Ryb3k6IGZ1bmN0aW9uKCkge1xuXHRcdGlmICggKCB0aGlzLmhlbHBlciB8fCB0aGlzLmVsZW1lbnQgKS5pcyggXCIudWktZHJhZ2dhYmxlLWRyYWdnaW5nXCIgKSApIHtcblx0XHRcdHRoaXMuZGVzdHJveU9uQ2xlYXIgPSB0cnVlO1xuXHRcdFx0cmV0dXJuO1xuXHRcdH1cblx0XHR0aGlzLl9yZW1vdmVIYW5kbGVDbGFzc05hbWUoKTtcblx0XHR0aGlzLl9tb3VzZURlc3Ryb3koKTtcblx0fSxcblxuXHRfbW91c2VDYXB0dXJlOiBmdW5jdGlvbiggZXZlbnQgKSB7XG5cdFx0dmFyIG8gPSB0aGlzLm9wdGlvbnM7XG5cblx0XHR0aGlzLl9ibHVyQWN0aXZlRWxlbWVudCggZXZlbnQgKTtcblxuXHRcdC8vIEFtb25nIG90aGVycywgcHJldmVudCBhIGRyYWcgb24gYSByZXNpemFibGUtaGFuZGxlXG5cdFx0aWYgKCB0aGlzLmhlbHBlciB8fCBvLmRpc2FibGVkIHx8XG5cdFx0XHRcdCQoIGV2ZW50LnRhcmdldCApLmNsb3Nlc3QoIFwiLnVpLXJlc2l6YWJsZS1oYW5kbGVcIiApLmxlbmd0aCA+IDAgKSB7XG5cdFx0XHRyZXR1cm4gZmFsc2U7XG5cdFx0fVxuXG5cdFx0Ly9RdWl0IGlmIHdlJ3JlIG5vdCBvbiBhIHZhbGlkIGhhbmRsZVxuXHRcdHRoaXMuaGFuZGxlID0gdGhpcy5fZ2V0SGFuZGxlKCBldmVudCApO1xuXHRcdGlmICggIXRoaXMuaGFuZGxlICkge1xuXHRcdFx0cmV0dXJuIGZhbHNlO1xuXHRcdH1cblxuXHRcdHRoaXMuX2Jsb2NrRnJhbWVzKCBvLmlmcmFtZUZpeCA9PT0gdHJ1ZSA/IFwiaWZyYW1lXCIgOiBvLmlmcmFtZUZpeCApO1xuXG5cdFx0cmV0dXJuIHRydWU7XG5cblx0fSxcblxuXHRfYmxvY2tGcmFtZXM6IGZ1bmN0aW9uKCBzZWxlY3RvciApIHtcblx0XHR0aGlzLmlmcmFtZUJsb2NrcyA9IHRoaXMuZG9jdW1lbnQuZmluZCggc2VsZWN0b3IgKS5tYXAoIGZ1bmN0aW9uKCkge1xuXHRcdFx0dmFyIGlmcmFtZSA9ICQoIHRoaXMgKTtcblxuXHRcdFx0cmV0dXJuICQoIFwiPGRpdj5cIiApXG5cdFx0XHRcdC5jc3MoIFwicG9zaXRpb25cIiwgXCJhYnNvbHV0ZVwiIClcblx0XHRcdFx0LmFwcGVuZFRvKCBpZnJhbWUucGFyZW50KCkgKVxuXHRcdFx0XHQub3V0ZXJXaWR0aCggaWZyYW1lLm91dGVyV2lkdGgoKSApXG5cdFx0XHRcdC5vdXRlckhlaWdodCggaWZyYW1lLm91dGVySGVpZ2h0KCkgKVxuXHRcdFx0XHQub2Zmc2V0KCBpZnJhbWUub2Zmc2V0KCkgKVsgMCBdO1xuXHRcdH0gKTtcblx0fSxcblxuXHRfdW5ibG9ja0ZyYW1lczogZnVuY3Rpb24oKSB7XG5cdFx0aWYgKCB0aGlzLmlmcmFtZUJsb2NrcyApIHtcblx0XHRcdHRoaXMuaWZyYW1lQmxvY2tzLnJlbW92ZSgpO1xuXHRcdFx0ZGVsZXRlIHRoaXMuaWZyYW1lQmxvY2tzO1xuXHRcdH1cblx0fSxcblxuXHRfYmx1ckFjdGl2ZUVsZW1lbnQ6IGZ1bmN0aW9uKCBldmVudCApIHtcblx0XHR2YXIgYWN0aXZlRWxlbWVudCA9ICQudWkuc2FmZUFjdGl2ZUVsZW1lbnQoIHRoaXMuZG9jdW1lbnRbIDAgXSApLFxuXHRcdFx0dGFyZ2V0ID0gJCggZXZlbnQudGFyZ2V0ICk7XG5cblx0XHQvLyBPbmx5IGJsdXIgaWYgdGhlIGV2ZW50IG9jY3VycmVkIG9uIGFuIGVsZW1lbnQgdGhhdCBpczpcblx0XHQvLyAxKSB3aXRoaW4gdGhlIGRyYWdnYWJsZSBoYW5kbGVcblx0XHQvLyAyKSBidXQgbm90IHdpdGhpbiB0aGUgY3VycmVudGx5IGZvY3VzZWQgZWxlbWVudFxuXHRcdC8vIFNlZSAjMTA1MjcsICMxMjQ3MlxuXHRcdGlmICggdGhpcy5fZ2V0SGFuZGxlKCBldmVudCApICYmIHRhcmdldC5jbG9zZXN0KCBhY3RpdmVFbGVtZW50ICkubGVuZ3RoICkge1xuXHRcdFx0cmV0dXJuO1xuXHRcdH1cblxuXHRcdC8vIEJsdXIgYW55IGVsZW1lbnQgdGhhdCBjdXJyZW50bHkgaGFzIGZvY3VzLCBzZWUgIzQyNjFcblx0XHQkLnVpLnNhZmVCbHVyKCBhY3RpdmVFbGVtZW50ICk7XG5cdH0sXG5cblx0X21vdXNlU3RhcnQ6IGZ1bmN0aW9uKCBldmVudCApIHtcblxuXHRcdHZhciBvID0gdGhpcy5vcHRpb25zO1xuXG5cdFx0Ly9DcmVhdGUgYW5kIGFwcGVuZCB0aGUgdmlzaWJsZSBoZWxwZXJcblx0XHR0aGlzLmhlbHBlciA9IHRoaXMuX2NyZWF0ZUhlbHBlciggZXZlbnQgKTtcblxuXHRcdHRoaXMuX2FkZENsYXNzKCB0aGlzLmhlbHBlciwgXCJ1aS1kcmFnZ2FibGUtZHJhZ2dpbmdcIiApO1xuXG5cdFx0Ly9DYWNoZSB0aGUgaGVscGVyIHNpemVcblx0XHR0aGlzLl9jYWNoZUhlbHBlclByb3BvcnRpb25zKCk7XG5cblx0XHQvL0lmIGRkbWFuYWdlciBpcyB1c2VkIGZvciBkcm9wcGFibGVzLCBzZXQgdGhlIGdsb2JhbCBkcmFnZ2FibGVcblx0XHRpZiAoICQudWkuZGRtYW5hZ2VyICkge1xuXHRcdFx0JC51aS5kZG1hbmFnZXIuY3VycmVudCA9IHRoaXM7XG5cdFx0fVxuXG5cdFx0Lypcblx0XHQgKiAtIFBvc2l0aW9uIGdlbmVyYXRpb24gLVxuXHRcdCAqIFRoaXMgYmxvY2sgZ2VuZXJhdGVzIGV2ZXJ5dGhpbmcgcG9zaXRpb24gcmVsYXRlZCAtIGl0J3MgdGhlIGNvcmUgb2YgZHJhZ2dhYmxlcy5cblx0XHQgKi9cblxuXHRcdC8vQ2FjaGUgdGhlIG1hcmdpbnMgb2YgdGhlIG9yaWdpbmFsIGVsZW1lbnRcblx0XHR0aGlzLl9jYWNoZU1hcmdpbnMoKTtcblxuXHRcdC8vU3RvcmUgdGhlIGhlbHBlcidzIGNzcyBwb3NpdGlvblxuXHRcdHRoaXMuY3NzUG9zaXRpb24gPSB0aGlzLmhlbHBlci5jc3MoIFwicG9zaXRpb25cIiApO1xuXHRcdHRoaXMuc2Nyb2xsUGFyZW50ID0gdGhpcy5oZWxwZXIuc2Nyb2xsUGFyZW50KCB0cnVlICk7XG5cdFx0dGhpcy5vZmZzZXRQYXJlbnQgPSB0aGlzLmhlbHBlci5vZmZzZXRQYXJlbnQoKTtcblx0XHR0aGlzLmhhc0ZpeGVkQW5jZXN0b3IgPSB0aGlzLmhlbHBlci5wYXJlbnRzKCkuZmlsdGVyKCBmdW5jdGlvbigpIHtcblx0XHRcdFx0cmV0dXJuICQoIHRoaXMgKS5jc3MoIFwicG9zaXRpb25cIiApID09PSBcImZpeGVkXCI7XG5cdFx0XHR9ICkubGVuZ3RoID4gMDtcblxuXHRcdC8vVGhlIGVsZW1lbnQncyBhYnNvbHV0ZSBwb3NpdGlvbiBvbiB0aGUgcGFnZSBtaW51cyBtYXJnaW5zXG5cdFx0dGhpcy5wb3NpdGlvbkFicyA9IHRoaXMuZWxlbWVudC5vZmZzZXQoKTtcblx0XHR0aGlzLl9yZWZyZXNoT2Zmc2V0cyggZXZlbnQgKTtcblxuXHRcdC8vR2VuZXJhdGUgdGhlIG9yaWdpbmFsIHBvc2l0aW9uXG5cdFx0dGhpcy5vcmlnaW5hbFBvc2l0aW9uID0gdGhpcy5wb3NpdGlvbiA9IHRoaXMuX2dlbmVyYXRlUG9zaXRpb24oIGV2ZW50LCBmYWxzZSApO1xuXHRcdHRoaXMub3JpZ2luYWxQYWdlWCA9IGV2ZW50LnBhZ2VYO1xuXHRcdHRoaXMub3JpZ2luYWxQYWdlWSA9IGV2ZW50LnBhZ2VZO1xuXG5cdFx0Ly9BZGp1c3QgdGhlIG1vdXNlIG9mZnNldCByZWxhdGl2ZSB0byB0aGUgaGVscGVyIGlmIFwiY3Vyc29yQXRcIiBpcyBzdXBwbGllZFxuXHRcdCggby5jdXJzb3JBdCAmJiB0aGlzLl9hZGp1c3RPZmZzZXRGcm9tSGVscGVyKCBvLmN1cnNvckF0ICkgKTtcblxuXHRcdC8vU2V0IGEgY29udGFpbm1lbnQgaWYgZ2l2ZW4gaW4gdGhlIG9wdGlvbnNcblx0XHR0aGlzLl9zZXRDb250YWlubWVudCgpO1xuXG5cdFx0Ly9UcmlnZ2VyIGV2ZW50ICsgY2FsbGJhY2tzXG5cdFx0aWYgKCB0aGlzLl90cmlnZ2VyKCBcInN0YXJ0XCIsIGV2ZW50ICkgPT09IGZhbHNlICkge1xuXHRcdFx0dGhpcy5fY2xlYXIoKTtcblx0XHRcdHJldHVybiBmYWxzZTtcblx0XHR9XG5cblx0XHQvL1JlY2FjaGUgdGhlIGhlbHBlciBzaXplXG5cdFx0dGhpcy5fY2FjaGVIZWxwZXJQcm9wb3J0aW9ucygpO1xuXG5cdFx0Ly9QcmVwYXJlIHRoZSBkcm9wcGFibGUgb2Zmc2V0c1xuXHRcdGlmICggJC51aS5kZG1hbmFnZXIgJiYgIW8uZHJvcEJlaGF2aW91ciApIHtcblx0XHRcdCQudWkuZGRtYW5hZ2VyLnByZXBhcmVPZmZzZXRzKCB0aGlzLCBldmVudCApO1xuXHRcdH1cblxuXHRcdC8vIEV4ZWN1dGUgdGhlIGRyYWcgb25jZSAtIHRoaXMgY2F1c2VzIHRoZSBoZWxwZXIgbm90IHRvIGJlIHZpc2libGUgYmVmb3JlIGdldHRpbmcgaXRzXG5cdFx0Ly8gY29ycmVjdCBwb3NpdGlvblxuXHRcdHRoaXMuX21vdXNlRHJhZyggZXZlbnQsIHRydWUgKTtcblxuXHRcdC8vIElmIHRoZSBkZG1hbmFnZXIgaXMgdXNlZCBmb3IgZHJvcHBhYmxlcywgaW5mb3JtIHRoZSBtYW5hZ2VyIHRoYXQgZHJhZ2dpbmcgaGFzIHN0YXJ0ZWRcblx0XHQvLyAoc2VlICM1MDAzKVxuXHRcdGlmICggJC51aS5kZG1hbmFnZXIgKSB7XG5cdFx0XHQkLnVpLmRkbWFuYWdlci5kcmFnU3RhcnQoIHRoaXMsIGV2ZW50ICk7XG5cdFx0fVxuXG5cdFx0cmV0dXJuIHRydWU7XG5cdH0sXG5cblx0X3JlZnJlc2hPZmZzZXRzOiBmdW5jdGlvbiggZXZlbnQgKSB7XG5cdFx0dGhpcy5vZmZzZXQgPSB7XG5cdFx0XHR0b3A6IHRoaXMucG9zaXRpb25BYnMudG9wIC0gdGhpcy5tYXJnaW5zLnRvcCxcblx0XHRcdGxlZnQ6IHRoaXMucG9zaXRpb25BYnMubGVmdCAtIHRoaXMubWFyZ2lucy5sZWZ0LFxuXHRcdFx0c2Nyb2xsOiBmYWxzZSxcblx0XHRcdHBhcmVudDogdGhpcy5fZ2V0UGFyZW50T2Zmc2V0KCksXG5cdFx0XHRyZWxhdGl2ZTogdGhpcy5fZ2V0UmVsYXRpdmVPZmZzZXQoKVxuXHRcdH07XG5cblx0XHR0aGlzLm9mZnNldC5jbGljayA9IHtcblx0XHRcdGxlZnQ6IGV2ZW50LnBhZ2VYIC0gdGhpcy5vZmZzZXQubGVmdCxcblx0XHRcdHRvcDogZXZlbnQucGFnZVkgLSB0aGlzLm9mZnNldC50b3Bcblx0XHR9O1xuXHR9LFxuXG5cdF9tb3VzZURyYWc6IGZ1bmN0aW9uKCBldmVudCwgbm9Qcm9wYWdhdGlvbiApIHtcblxuXHRcdC8vIHJlc2V0IGFueSBuZWNlc3NhcnkgY2FjaGVkIHByb3BlcnRpZXMgKHNlZSAjNTAwOSlcblx0XHRpZiAoIHRoaXMuaGFzRml4ZWRBbmNlc3RvciApIHtcblx0XHRcdHRoaXMub2Zmc2V0LnBhcmVudCA9IHRoaXMuX2dldFBhcmVudE9mZnNldCgpO1xuXHRcdH1cblxuXHRcdC8vQ29tcHV0ZSB0aGUgaGVscGVycyBwb3NpdGlvblxuXHRcdHRoaXMucG9zaXRpb24gPSB0aGlzLl9nZW5lcmF0ZVBvc2l0aW9uKCBldmVudCwgdHJ1ZSApO1xuXHRcdHRoaXMucG9zaXRpb25BYnMgPSB0aGlzLl9jb252ZXJ0UG9zaXRpb25UbyggXCJhYnNvbHV0ZVwiICk7XG5cblx0XHQvL0NhbGwgcGx1Z2lucyBhbmQgY2FsbGJhY2tzIGFuZCB1c2UgdGhlIHJlc3VsdGluZyBwb3NpdGlvbiBpZiBzb21ldGhpbmcgaXMgcmV0dXJuZWRcblx0XHRpZiAoICFub1Byb3BhZ2F0aW9uICkge1xuXHRcdFx0dmFyIHVpID0gdGhpcy5fdWlIYXNoKCk7XG5cdFx0XHRpZiAoIHRoaXMuX3RyaWdnZXIoIFwiZHJhZ1wiLCBldmVudCwgdWkgKSA9PT0gZmFsc2UgKSB7XG5cdFx0XHRcdHRoaXMuX21vdXNlVXAoIG5ldyAkLkV2ZW50KCBcIm1vdXNldXBcIiwgZXZlbnQgKSApO1xuXHRcdFx0XHRyZXR1cm4gZmFsc2U7XG5cdFx0XHR9XG5cdFx0XHR0aGlzLnBvc2l0aW9uID0gdWkucG9zaXRpb247XG5cdFx0fVxuXG5cdFx0dGhpcy5oZWxwZXJbIDAgXS5zdHlsZS5sZWZ0ID0gdGhpcy5wb3NpdGlvbi5sZWZ0ICsgXCJweFwiO1xuXHRcdHRoaXMuaGVscGVyWyAwIF0uc3R5bGUudG9wID0gdGhpcy5wb3NpdGlvbi50b3AgKyBcInB4XCI7XG5cblx0XHRpZiAoICQudWkuZGRtYW5hZ2VyICkge1xuXHRcdFx0JC51aS5kZG1hbmFnZXIuZHJhZyggdGhpcywgZXZlbnQgKTtcblx0XHR9XG5cblx0XHRyZXR1cm4gZmFsc2U7XG5cdH0sXG5cblx0X21vdXNlU3RvcDogZnVuY3Rpb24oIGV2ZW50ICkge1xuXG5cdFx0Ly9JZiB3ZSBhcmUgdXNpbmcgZHJvcHBhYmxlcywgaW5mb3JtIHRoZSBtYW5hZ2VyIGFib3V0IHRoZSBkcm9wXG5cdFx0dmFyIHRoYXQgPSB0aGlzLFxuXHRcdFx0ZHJvcHBlZCA9IGZhbHNlO1xuXHRcdGlmICggJC51aS5kZG1hbmFnZXIgJiYgIXRoaXMub3B0aW9ucy5kcm9wQmVoYXZpb3VyICkge1xuXHRcdFx0ZHJvcHBlZCA9ICQudWkuZGRtYW5hZ2VyLmRyb3AoIHRoaXMsIGV2ZW50ICk7XG5cdFx0fVxuXG5cdFx0Ly9pZiBhIGRyb3AgY29tZXMgZnJvbSBvdXRzaWRlIChhIHNvcnRhYmxlKVxuXHRcdGlmICggdGhpcy5kcm9wcGVkICkge1xuXHRcdFx0ZHJvcHBlZCA9IHRoaXMuZHJvcHBlZDtcblx0XHRcdHRoaXMuZHJvcHBlZCA9IGZhbHNlO1xuXHRcdH1cblxuXHRcdGlmICggKCB0aGlzLm9wdGlvbnMucmV2ZXJ0ID09PSBcImludmFsaWRcIiAmJiAhZHJvcHBlZCApIHx8XG5cdFx0XHRcdCggdGhpcy5vcHRpb25zLnJldmVydCA9PT0gXCJ2YWxpZFwiICYmIGRyb3BwZWQgKSB8fFxuXHRcdFx0XHR0aGlzLm9wdGlvbnMucmV2ZXJ0ID09PSB0cnVlIHx8ICggJC5pc0Z1bmN0aW9uKCB0aGlzLm9wdGlvbnMucmV2ZXJ0ICkgJiZcblx0XHRcdFx0dGhpcy5vcHRpb25zLnJldmVydC5jYWxsKCB0aGlzLmVsZW1lbnQsIGRyb3BwZWQgKSApXG5cdFx0KSB7XG5cdFx0XHQkKCB0aGlzLmhlbHBlciApLmFuaW1hdGUoXG5cdFx0XHRcdHRoaXMub3JpZ2luYWxQb3NpdGlvbixcblx0XHRcdFx0cGFyc2VJbnQoIHRoaXMub3B0aW9ucy5yZXZlcnREdXJhdGlvbiwgMTAgKSxcblx0XHRcdFx0ZnVuY3Rpb24oKSB7XG5cdFx0XHRcdFx0aWYgKCB0aGF0Ll90cmlnZ2VyKCBcInN0b3BcIiwgZXZlbnQgKSAhPT0gZmFsc2UgKSB7XG5cdFx0XHRcdFx0XHR0aGF0Ll9jbGVhcigpO1xuXHRcdFx0XHRcdH1cblx0XHRcdFx0fVxuXHRcdFx0KTtcblx0XHR9IGVsc2Uge1xuXHRcdFx0aWYgKCB0aGlzLl90cmlnZ2VyKCBcInN0b3BcIiwgZXZlbnQgKSAhPT0gZmFsc2UgKSB7XG5cdFx0XHRcdHRoaXMuX2NsZWFyKCk7XG5cdFx0XHR9XG5cdFx0fVxuXG5cdFx0cmV0dXJuIGZhbHNlO1xuXHR9LFxuXG5cdF9tb3VzZVVwOiBmdW5jdGlvbiggZXZlbnQgKSB7XG5cdFx0dGhpcy5fdW5ibG9ja0ZyYW1lcygpO1xuXG5cdFx0Ly8gSWYgdGhlIGRkbWFuYWdlciBpcyB1c2VkIGZvciBkcm9wcGFibGVzLCBpbmZvcm0gdGhlIG1hbmFnZXIgdGhhdCBkcmFnZ2luZyBoYXMgc3RvcHBlZFxuXHRcdC8vIChzZWUgIzUwMDMpXG5cdFx0aWYgKCAkLnVpLmRkbWFuYWdlciApIHtcblx0XHRcdCQudWkuZGRtYW5hZ2VyLmRyYWdTdG9wKCB0aGlzLCBldmVudCApO1xuXHRcdH1cblxuXHRcdC8vIE9ubHkgbmVlZCB0byBmb2N1cyBpZiB0aGUgZXZlbnQgb2NjdXJyZWQgb24gdGhlIGRyYWdnYWJsZSBpdHNlbGYsIHNlZSAjMTA1Mjdcblx0XHRpZiAoIHRoaXMuaGFuZGxlRWxlbWVudC5pcyggZXZlbnQudGFyZ2V0ICkgKSB7XG5cblx0XHRcdC8vIFRoZSBpbnRlcmFjdGlvbiBpcyBvdmVyOyB3aGV0aGVyIG9yIG5vdCB0aGUgY2xpY2sgcmVzdWx0ZWQgaW4gYSBkcmFnLFxuXHRcdFx0Ly8gZm9jdXMgdGhlIGVsZW1lbnRcblx0XHRcdHRoaXMuZWxlbWVudC50cmlnZ2VyKCBcImZvY3VzXCIgKTtcblx0XHR9XG5cblx0XHRyZXR1cm4gJC51aS5tb3VzZS5wcm90b3R5cGUuX21vdXNlVXAuY2FsbCggdGhpcywgZXZlbnQgKTtcblx0fSxcblxuXHRjYW5jZWw6IGZ1bmN0aW9uKCkge1xuXG5cdFx0aWYgKCB0aGlzLmhlbHBlci5pcyggXCIudWktZHJhZ2dhYmxlLWRyYWdnaW5nXCIgKSApIHtcblx0XHRcdHRoaXMuX21vdXNlVXAoIG5ldyAkLkV2ZW50KCBcIm1vdXNldXBcIiwgeyB0YXJnZXQ6IHRoaXMuZWxlbWVudFsgMCBdIH0gKSApO1xuXHRcdH0gZWxzZSB7XG5cdFx0XHR0aGlzLl9jbGVhcigpO1xuXHRcdH1cblxuXHRcdHJldHVybiB0aGlzO1xuXG5cdH0sXG5cblx0X2dldEhhbmRsZTogZnVuY3Rpb24oIGV2ZW50ICkge1xuXHRcdHJldHVybiB0aGlzLm9wdGlvbnMuaGFuZGxlID9cblx0XHRcdCEhJCggZXZlbnQudGFyZ2V0ICkuY2xvc2VzdCggdGhpcy5lbGVtZW50LmZpbmQoIHRoaXMub3B0aW9ucy5oYW5kbGUgKSApLmxlbmd0aCA6XG5cdFx0XHR0cnVlO1xuXHR9LFxuXG5cdF9zZXRIYW5kbGVDbGFzc05hbWU6IGZ1bmN0aW9uKCkge1xuXHRcdHRoaXMuaGFuZGxlRWxlbWVudCA9IHRoaXMub3B0aW9ucy5oYW5kbGUgP1xuXHRcdFx0dGhpcy5lbGVtZW50LmZpbmQoIHRoaXMub3B0aW9ucy5oYW5kbGUgKSA6IHRoaXMuZWxlbWVudDtcblx0XHR0aGlzLl9hZGRDbGFzcyggdGhpcy5oYW5kbGVFbGVtZW50LCBcInVpLWRyYWdnYWJsZS1oYW5kbGVcIiApO1xuXHR9LFxuXG5cdF9yZW1vdmVIYW5kbGVDbGFzc05hbWU6IGZ1bmN0aW9uKCkge1xuXHRcdHRoaXMuX3JlbW92ZUNsYXNzKCB0aGlzLmhhbmRsZUVsZW1lbnQsIFwidWktZHJhZ2dhYmxlLWhhbmRsZVwiICk7XG5cdH0sXG5cblx0X2NyZWF0ZUhlbHBlcjogZnVuY3Rpb24oIGV2ZW50ICkge1xuXG5cdFx0dmFyIG8gPSB0aGlzLm9wdGlvbnMsXG5cdFx0XHRoZWxwZXJJc0Z1bmN0aW9uID0gJC5pc0Z1bmN0aW9uKCBvLmhlbHBlciApLFxuXHRcdFx0aGVscGVyID0gaGVscGVySXNGdW5jdGlvbiA/XG5cdFx0XHRcdCQoIG8uaGVscGVyLmFwcGx5KCB0aGlzLmVsZW1lbnRbIDAgXSwgWyBldmVudCBdICkgKSA6XG5cdFx0XHRcdCggby5oZWxwZXIgPT09IFwiY2xvbmVcIiA/XG5cdFx0XHRcdFx0dGhpcy5lbGVtZW50LmNsb25lKCkucmVtb3ZlQXR0ciggXCJpZFwiICkgOlxuXHRcdFx0XHRcdHRoaXMuZWxlbWVudCApO1xuXG5cdFx0aWYgKCAhaGVscGVyLnBhcmVudHMoIFwiYm9keVwiICkubGVuZ3RoICkge1xuXHRcdFx0aGVscGVyLmFwcGVuZFRvKCAoIG8uYXBwZW5kVG8gPT09IFwicGFyZW50XCIgP1xuXHRcdFx0XHR0aGlzLmVsZW1lbnRbIDAgXS5wYXJlbnROb2RlIDpcblx0XHRcdFx0by5hcHBlbmRUbyApICk7XG5cdFx0fVxuXG5cdFx0Ly8gSHR0cDovL2J1Z3MuanF1ZXJ5dWkuY29tL3RpY2tldC85NDQ2XG5cdFx0Ly8gYSBoZWxwZXIgZnVuY3Rpb24gY2FuIHJldHVybiB0aGUgb3JpZ2luYWwgZWxlbWVudFxuXHRcdC8vIHdoaWNoIHdvdWxkbid0IGhhdmUgYmVlbiBzZXQgdG8gcmVsYXRpdmUgaW4gX2NyZWF0ZVxuXHRcdGlmICggaGVscGVySXNGdW5jdGlvbiAmJiBoZWxwZXJbIDAgXSA9PT0gdGhpcy5lbGVtZW50WyAwIF0gKSB7XG5cdFx0XHR0aGlzLl9zZXRQb3NpdGlvblJlbGF0aXZlKCk7XG5cdFx0fVxuXG5cdFx0aWYgKCBoZWxwZXJbIDAgXSAhPT0gdGhpcy5lbGVtZW50WyAwIF0gJiZcblx0XHRcdFx0ISggLyhmaXhlZHxhYnNvbHV0ZSkvICkudGVzdCggaGVscGVyLmNzcyggXCJwb3NpdGlvblwiICkgKSApIHtcblx0XHRcdGhlbHBlci5jc3MoIFwicG9zaXRpb25cIiwgXCJhYnNvbHV0ZVwiICk7XG5cdFx0fVxuXG5cdFx0cmV0dXJuIGhlbHBlcjtcblxuXHR9LFxuXG5cdF9zZXRQb3NpdGlvblJlbGF0aXZlOiBmdW5jdGlvbigpIHtcblx0XHRpZiAoICEoIC9eKD86cnxhfGYpLyApLnRlc3QoIHRoaXMuZWxlbWVudC5jc3MoIFwicG9zaXRpb25cIiApICkgKSB7XG5cdFx0XHR0aGlzLmVsZW1lbnRbIDAgXS5zdHlsZS5wb3NpdGlvbiA9IFwicmVsYXRpdmVcIjtcblx0XHR9XG5cdH0sXG5cblx0X2FkanVzdE9mZnNldEZyb21IZWxwZXI6IGZ1bmN0aW9uKCBvYmogKSB7XG5cdFx0aWYgKCB0eXBlb2Ygb2JqID09PSBcInN0cmluZ1wiICkge1xuXHRcdFx0b2JqID0gb2JqLnNwbGl0KCBcIiBcIiApO1xuXHRcdH1cblx0XHRpZiAoICQuaXNBcnJheSggb2JqICkgKSB7XG5cdFx0XHRvYmogPSB7IGxlZnQ6ICtvYmpbIDAgXSwgdG9wOiArb2JqWyAxIF0gfHwgMCB9O1xuXHRcdH1cblx0XHRpZiAoIFwibGVmdFwiIGluIG9iaiApIHtcblx0XHRcdHRoaXMub2Zmc2V0LmNsaWNrLmxlZnQgPSBvYmoubGVmdCArIHRoaXMubWFyZ2lucy5sZWZ0O1xuXHRcdH1cblx0XHRpZiAoIFwicmlnaHRcIiBpbiBvYmogKSB7XG5cdFx0XHR0aGlzLm9mZnNldC5jbGljay5sZWZ0ID0gdGhpcy5oZWxwZXJQcm9wb3J0aW9ucy53aWR0aCAtIG9iai5yaWdodCArIHRoaXMubWFyZ2lucy5sZWZ0O1xuXHRcdH1cblx0XHRpZiAoIFwidG9wXCIgaW4gb2JqICkge1xuXHRcdFx0dGhpcy5vZmZzZXQuY2xpY2sudG9wID0gb2JqLnRvcCArIHRoaXMubWFyZ2lucy50b3A7XG5cdFx0fVxuXHRcdGlmICggXCJib3R0b21cIiBpbiBvYmogKSB7XG5cdFx0XHR0aGlzLm9mZnNldC5jbGljay50b3AgPSB0aGlzLmhlbHBlclByb3BvcnRpb25zLmhlaWdodCAtIG9iai5ib3R0b20gKyB0aGlzLm1hcmdpbnMudG9wO1xuXHRcdH1cblx0fSxcblxuXHRfaXNSb290Tm9kZTogZnVuY3Rpb24oIGVsZW1lbnQgKSB7XG5cdFx0cmV0dXJuICggLyhodG1sfGJvZHkpL2kgKS50ZXN0KCBlbGVtZW50LnRhZ05hbWUgKSB8fCBlbGVtZW50ID09PSB0aGlzLmRvY3VtZW50WyAwIF07XG5cdH0sXG5cblx0X2dldFBhcmVudE9mZnNldDogZnVuY3Rpb24oKSB7XG5cblx0XHQvL0dldCB0aGUgb2Zmc2V0UGFyZW50IGFuZCBjYWNoZSBpdHMgcG9zaXRpb25cblx0XHR2YXIgcG8gPSB0aGlzLm9mZnNldFBhcmVudC5vZmZzZXQoKSxcblx0XHRcdGRvY3VtZW50ID0gdGhpcy5kb2N1bWVudFsgMCBdO1xuXG5cdFx0Ly8gVGhpcyBpcyBhIHNwZWNpYWwgY2FzZSB3aGVyZSB3ZSBuZWVkIHRvIG1vZGlmeSBhIG9mZnNldCBjYWxjdWxhdGVkIG9uIHN0YXJ0LCBzaW5jZSB0aGVcblx0XHQvLyBmb2xsb3dpbmcgaGFwcGVuZWQ6XG5cdFx0Ly8gMS4gVGhlIHBvc2l0aW9uIG9mIHRoZSBoZWxwZXIgaXMgYWJzb2x1dGUsIHNvIGl0J3MgcG9zaXRpb24gaXMgY2FsY3VsYXRlZCBiYXNlZCBvbiB0aGVcblx0XHQvLyBuZXh0IHBvc2l0aW9uZWQgcGFyZW50XG5cdFx0Ly8gMi4gVGhlIGFjdHVhbCBvZmZzZXQgcGFyZW50IGlzIGEgY2hpbGQgb2YgdGhlIHNjcm9sbCBwYXJlbnQsIGFuZCB0aGUgc2Nyb2xsIHBhcmVudCBpc24ndFxuXHRcdC8vIHRoZSBkb2N1bWVudCwgd2hpY2ggbWVhbnMgdGhhdCB0aGUgc2Nyb2xsIGlzIGluY2x1ZGVkIGluIHRoZSBpbml0aWFsIGNhbGN1bGF0aW9uIG9mIHRoZVxuXHRcdC8vIG9mZnNldCBvZiB0aGUgcGFyZW50LCBhbmQgbmV2ZXIgcmVjYWxjdWxhdGVkIHVwb24gZHJhZ1xuXHRcdGlmICggdGhpcy5jc3NQb3NpdGlvbiA9PT0gXCJhYnNvbHV0ZVwiICYmIHRoaXMuc2Nyb2xsUGFyZW50WyAwIF0gIT09IGRvY3VtZW50ICYmXG5cdFx0XHRcdCQuY29udGFpbnMoIHRoaXMuc2Nyb2xsUGFyZW50WyAwIF0sIHRoaXMub2Zmc2V0UGFyZW50WyAwIF0gKSApIHtcblx0XHRcdHBvLmxlZnQgKz0gdGhpcy5zY3JvbGxQYXJlbnQuc2Nyb2xsTGVmdCgpO1xuXHRcdFx0cG8udG9wICs9IHRoaXMuc2Nyb2xsUGFyZW50LnNjcm9sbFRvcCgpO1xuXHRcdH1cblxuXHRcdGlmICggdGhpcy5faXNSb290Tm9kZSggdGhpcy5vZmZzZXRQYXJlbnRbIDAgXSApICkge1xuXHRcdFx0cG8gPSB7IHRvcDogMCwgbGVmdDogMCB9O1xuXHRcdH1cblxuXHRcdHJldHVybiB7XG5cdFx0XHR0b3A6IHBvLnRvcCArICggcGFyc2VJbnQoIHRoaXMub2Zmc2V0UGFyZW50LmNzcyggXCJib3JkZXJUb3BXaWR0aFwiICksIDEwICkgfHwgMCApLFxuXHRcdFx0bGVmdDogcG8ubGVmdCArICggcGFyc2VJbnQoIHRoaXMub2Zmc2V0UGFyZW50LmNzcyggXCJib3JkZXJMZWZ0V2lkdGhcIiApLCAxMCApIHx8IDAgKVxuXHRcdH07XG5cblx0fSxcblxuXHRfZ2V0UmVsYXRpdmVPZmZzZXQ6IGZ1bmN0aW9uKCkge1xuXHRcdGlmICggdGhpcy5jc3NQb3NpdGlvbiAhPT0gXCJyZWxhdGl2ZVwiICkge1xuXHRcdFx0cmV0dXJuIHsgdG9wOiAwLCBsZWZ0OiAwIH07XG5cdFx0fVxuXG5cdFx0dmFyIHAgPSB0aGlzLmVsZW1lbnQucG9zaXRpb24oKSxcblx0XHRcdHNjcm9sbElzUm9vdE5vZGUgPSB0aGlzLl9pc1Jvb3ROb2RlKCB0aGlzLnNjcm9sbFBhcmVudFsgMCBdICk7XG5cblx0XHRyZXR1cm4ge1xuXHRcdFx0dG9wOiBwLnRvcCAtICggcGFyc2VJbnQoIHRoaXMuaGVscGVyLmNzcyggXCJ0b3BcIiApLCAxMCApIHx8IDAgKSArXG5cdFx0XHRcdCggIXNjcm9sbElzUm9vdE5vZGUgPyB0aGlzLnNjcm9sbFBhcmVudC5zY3JvbGxUb3AoKSA6IDAgKSxcblx0XHRcdGxlZnQ6IHAubGVmdCAtICggcGFyc2VJbnQoIHRoaXMuaGVscGVyLmNzcyggXCJsZWZ0XCIgKSwgMTAgKSB8fCAwICkgK1xuXHRcdFx0XHQoICFzY3JvbGxJc1Jvb3ROb2RlID8gdGhpcy5zY3JvbGxQYXJlbnQuc2Nyb2xsTGVmdCgpIDogMCApXG5cdFx0fTtcblxuXHR9LFxuXG5cdF9jYWNoZU1hcmdpbnM6IGZ1bmN0aW9uKCkge1xuXHRcdHRoaXMubWFyZ2lucyA9IHtcblx0XHRcdGxlZnQ6ICggcGFyc2VJbnQoIHRoaXMuZWxlbWVudC5jc3MoIFwibWFyZ2luTGVmdFwiICksIDEwICkgfHwgMCApLFxuXHRcdFx0dG9wOiAoIHBhcnNlSW50KCB0aGlzLmVsZW1lbnQuY3NzKCBcIm1hcmdpblRvcFwiICksIDEwICkgfHwgMCApLFxuXHRcdFx0cmlnaHQ6ICggcGFyc2VJbnQoIHRoaXMuZWxlbWVudC5jc3MoIFwibWFyZ2luUmlnaHRcIiApLCAxMCApIHx8IDAgKSxcblx0XHRcdGJvdHRvbTogKCBwYXJzZUludCggdGhpcy5lbGVtZW50LmNzcyggXCJtYXJnaW5Cb3R0b21cIiApLCAxMCApIHx8IDAgKVxuXHRcdH07XG5cdH0sXG5cblx0X2NhY2hlSGVscGVyUHJvcG9ydGlvbnM6IGZ1bmN0aW9uKCkge1xuXHRcdHRoaXMuaGVscGVyUHJvcG9ydGlvbnMgPSB7XG5cdFx0XHR3aWR0aDogdGhpcy5oZWxwZXIub3V0ZXJXaWR0aCgpLFxuXHRcdFx0aGVpZ2h0OiB0aGlzLmhlbHBlci5vdXRlckhlaWdodCgpXG5cdFx0fTtcblx0fSxcblxuXHRfc2V0Q29udGFpbm1lbnQ6IGZ1bmN0aW9uKCkge1xuXG5cdFx0dmFyIGlzVXNlclNjcm9sbGFibGUsIGMsIGNlLFxuXHRcdFx0byA9IHRoaXMub3B0aW9ucyxcblx0XHRcdGRvY3VtZW50ID0gdGhpcy5kb2N1bWVudFsgMCBdO1xuXG5cdFx0dGhpcy5yZWxhdGl2ZUNvbnRhaW5lciA9IG51bGw7XG5cblx0XHRpZiAoICFvLmNvbnRhaW5tZW50ICkge1xuXHRcdFx0dGhpcy5jb250YWlubWVudCA9IG51bGw7XG5cdFx0XHRyZXR1cm47XG5cdFx0fVxuXG5cdFx0aWYgKCBvLmNvbnRhaW5tZW50ID09PSBcIndpbmRvd1wiICkge1xuXHRcdFx0dGhpcy5jb250YWlubWVudCA9IFtcblx0XHRcdFx0JCggd2luZG93ICkuc2Nyb2xsTGVmdCgpIC0gdGhpcy5vZmZzZXQucmVsYXRpdmUubGVmdCAtIHRoaXMub2Zmc2V0LnBhcmVudC5sZWZ0LFxuXHRcdFx0XHQkKCB3aW5kb3cgKS5zY3JvbGxUb3AoKSAtIHRoaXMub2Zmc2V0LnJlbGF0aXZlLnRvcCAtIHRoaXMub2Zmc2V0LnBhcmVudC50b3AsXG5cdFx0XHRcdCQoIHdpbmRvdyApLnNjcm9sbExlZnQoKSArICQoIHdpbmRvdyApLndpZHRoKCkgLVxuXHRcdFx0XHRcdHRoaXMuaGVscGVyUHJvcG9ydGlvbnMud2lkdGggLSB0aGlzLm1hcmdpbnMubGVmdCxcblx0XHRcdFx0JCggd2luZG93ICkuc2Nyb2xsVG9wKCkgK1xuXHRcdFx0XHRcdCggJCggd2luZG93ICkuaGVpZ2h0KCkgfHwgZG9jdW1lbnQuYm9keS5wYXJlbnROb2RlLnNjcm9sbEhlaWdodCApIC1cblx0XHRcdFx0XHR0aGlzLmhlbHBlclByb3BvcnRpb25zLmhlaWdodCAtIHRoaXMubWFyZ2lucy50b3Bcblx0XHRcdF07XG5cdFx0XHRyZXR1cm47XG5cdFx0fVxuXG5cdFx0aWYgKCBvLmNvbnRhaW5tZW50ID09PSBcImRvY3VtZW50XCIgKSB7XG5cdFx0XHR0aGlzLmNvbnRhaW5tZW50ID0gW1xuXHRcdFx0XHQwLFxuXHRcdFx0XHQwLFxuXHRcdFx0XHQkKCBkb2N1bWVudCApLndpZHRoKCkgLSB0aGlzLmhlbHBlclByb3BvcnRpb25zLndpZHRoIC0gdGhpcy5tYXJnaW5zLmxlZnQsXG5cdFx0XHRcdCggJCggZG9jdW1lbnQgKS5oZWlnaHQoKSB8fCBkb2N1bWVudC5ib2R5LnBhcmVudE5vZGUuc2Nyb2xsSGVpZ2h0ICkgLVxuXHRcdFx0XHRcdHRoaXMuaGVscGVyUHJvcG9ydGlvbnMuaGVpZ2h0IC0gdGhpcy5tYXJnaW5zLnRvcFxuXHRcdFx0XTtcblx0XHRcdHJldHVybjtcblx0XHR9XG5cblx0XHRpZiAoIG8uY29udGFpbm1lbnQuY29uc3RydWN0b3IgPT09IEFycmF5ICkge1xuXHRcdFx0dGhpcy5jb250YWlubWVudCA9IG8uY29udGFpbm1lbnQ7XG5cdFx0XHRyZXR1cm47XG5cdFx0fVxuXG5cdFx0aWYgKCBvLmNvbnRhaW5tZW50ID09PSBcInBhcmVudFwiICkge1xuXHRcdFx0by5jb250YWlubWVudCA9IHRoaXMuaGVscGVyWyAwIF0ucGFyZW50Tm9kZTtcblx0XHR9XG5cblx0XHRjID0gJCggby5jb250YWlubWVudCApO1xuXHRcdGNlID0gY1sgMCBdO1xuXG5cdFx0aWYgKCAhY2UgKSB7XG5cdFx0XHRyZXR1cm47XG5cdFx0fVxuXG5cdFx0aXNVc2VyU2Nyb2xsYWJsZSA9IC8oc2Nyb2xsfGF1dG8pLy50ZXN0KCBjLmNzcyggXCJvdmVyZmxvd1wiICkgKTtcblxuXHRcdHRoaXMuY29udGFpbm1lbnQgPSBbXG5cdFx0XHQoIHBhcnNlSW50KCBjLmNzcyggXCJib3JkZXJMZWZ0V2lkdGhcIiApLCAxMCApIHx8IDAgKSArXG5cdFx0XHRcdCggcGFyc2VJbnQoIGMuY3NzKCBcInBhZGRpbmdMZWZ0XCIgKSwgMTAgKSB8fCAwICksXG5cdFx0XHQoIHBhcnNlSW50KCBjLmNzcyggXCJib3JkZXJUb3BXaWR0aFwiICksIDEwICkgfHwgMCApICtcblx0XHRcdFx0KCBwYXJzZUludCggYy5jc3MoIFwicGFkZGluZ1RvcFwiICksIDEwICkgfHwgMCApLFxuXHRcdFx0KCBpc1VzZXJTY3JvbGxhYmxlID8gTWF0aC5tYXgoIGNlLnNjcm9sbFdpZHRoLCBjZS5vZmZzZXRXaWR0aCApIDogY2Uub2Zmc2V0V2lkdGggKSAtXG5cdFx0XHRcdCggcGFyc2VJbnQoIGMuY3NzKCBcImJvcmRlclJpZ2h0V2lkdGhcIiApLCAxMCApIHx8IDAgKSAtXG5cdFx0XHRcdCggcGFyc2VJbnQoIGMuY3NzKCBcInBhZGRpbmdSaWdodFwiICksIDEwICkgfHwgMCApIC1cblx0XHRcdFx0dGhpcy5oZWxwZXJQcm9wb3J0aW9ucy53aWR0aCAtXG5cdFx0XHRcdHRoaXMubWFyZ2lucy5sZWZ0IC1cblx0XHRcdFx0dGhpcy5tYXJnaW5zLnJpZ2h0LFxuXHRcdFx0KCBpc1VzZXJTY3JvbGxhYmxlID8gTWF0aC5tYXgoIGNlLnNjcm9sbEhlaWdodCwgY2Uub2Zmc2V0SGVpZ2h0ICkgOiBjZS5vZmZzZXRIZWlnaHQgKSAtXG5cdFx0XHRcdCggcGFyc2VJbnQoIGMuY3NzKCBcImJvcmRlckJvdHRvbVdpZHRoXCIgKSwgMTAgKSB8fCAwICkgLVxuXHRcdFx0XHQoIHBhcnNlSW50KCBjLmNzcyggXCJwYWRkaW5nQm90dG9tXCIgKSwgMTAgKSB8fCAwICkgLVxuXHRcdFx0XHR0aGlzLmhlbHBlclByb3BvcnRpb25zLmhlaWdodCAtXG5cdFx0XHRcdHRoaXMubWFyZ2lucy50b3AgLVxuXHRcdFx0XHR0aGlzLm1hcmdpbnMuYm90dG9tXG5cdFx0XTtcblx0XHR0aGlzLnJlbGF0aXZlQ29udGFpbmVyID0gYztcblx0fSxcblxuXHRfY29udmVydFBvc2l0aW9uVG86IGZ1bmN0aW9uKCBkLCBwb3MgKSB7XG5cblx0XHRpZiAoICFwb3MgKSB7XG5cdFx0XHRwb3MgPSB0aGlzLnBvc2l0aW9uO1xuXHRcdH1cblxuXHRcdHZhciBtb2QgPSBkID09PSBcImFic29sdXRlXCIgPyAxIDogLTEsXG5cdFx0XHRzY3JvbGxJc1Jvb3ROb2RlID0gdGhpcy5faXNSb290Tm9kZSggdGhpcy5zY3JvbGxQYXJlbnRbIDAgXSApO1xuXG5cdFx0cmV0dXJuIHtcblx0XHRcdHRvcDogKFxuXG5cdFx0XHRcdC8vIFRoZSBhYnNvbHV0ZSBtb3VzZSBwb3NpdGlvblxuXHRcdFx0XHRwb3MudG9wXHQrXG5cblx0XHRcdFx0Ly8gT25seSBmb3IgcmVsYXRpdmUgcG9zaXRpb25lZCBub2RlczogUmVsYXRpdmUgb2Zmc2V0IGZyb20gZWxlbWVudCB0byBvZmZzZXQgcGFyZW50XG5cdFx0XHRcdHRoaXMub2Zmc2V0LnJlbGF0aXZlLnRvcCAqIG1vZCArXG5cblx0XHRcdFx0Ly8gVGhlIG9mZnNldFBhcmVudCdzIG9mZnNldCB3aXRob3V0IGJvcmRlcnMgKG9mZnNldCArIGJvcmRlcilcblx0XHRcdFx0dGhpcy5vZmZzZXQucGFyZW50LnRvcCAqIG1vZCAtXG5cdFx0XHRcdCggKCB0aGlzLmNzc1Bvc2l0aW9uID09PSBcImZpeGVkXCIgP1xuXHRcdFx0XHRcdC10aGlzLm9mZnNldC5zY3JvbGwudG9wIDpcblx0XHRcdFx0XHQoIHNjcm9sbElzUm9vdE5vZGUgPyAwIDogdGhpcy5vZmZzZXQuc2Nyb2xsLnRvcCApICkgKiBtb2QgKVxuXHRcdFx0KSxcblx0XHRcdGxlZnQ6IChcblxuXHRcdFx0XHQvLyBUaGUgYWJzb2x1dGUgbW91c2UgcG9zaXRpb25cblx0XHRcdFx0cG9zLmxlZnQgK1xuXG5cdFx0XHRcdC8vIE9ubHkgZm9yIHJlbGF0aXZlIHBvc2l0aW9uZWQgbm9kZXM6IFJlbGF0aXZlIG9mZnNldCBmcm9tIGVsZW1lbnQgdG8gb2Zmc2V0IHBhcmVudFxuXHRcdFx0XHR0aGlzLm9mZnNldC5yZWxhdGl2ZS5sZWZ0ICogbW9kICtcblxuXHRcdFx0XHQvLyBUaGUgb2Zmc2V0UGFyZW50J3Mgb2Zmc2V0IHdpdGhvdXQgYm9yZGVycyAob2Zmc2V0ICsgYm9yZGVyKVxuXHRcdFx0XHR0aGlzLm9mZnNldC5wYXJlbnQubGVmdCAqIG1vZFx0LVxuXHRcdFx0XHQoICggdGhpcy5jc3NQb3NpdGlvbiA9PT0gXCJmaXhlZFwiID9cblx0XHRcdFx0XHQtdGhpcy5vZmZzZXQuc2Nyb2xsLmxlZnQgOlxuXHRcdFx0XHRcdCggc2Nyb2xsSXNSb290Tm9kZSA/IDAgOiB0aGlzLm9mZnNldC5zY3JvbGwubGVmdCApICkgKiBtb2QgKVxuXHRcdFx0KVxuXHRcdH07XG5cblx0fSxcblxuXHRfZ2VuZXJhdGVQb3NpdGlvbjogZnVuY3Rpb24oIGV2ZW50LCBjb25zdHJhaW5Qb3NpdGlvbiApIHtcblxuXHRcdHZhciBjb250YWlubWVudCwgY28sIHRvcCwgbGVmdCxcblx0XHRcdG8gPSB0aGlzLm9wdGlvbnMsXG5cdFx0XHRzY3JvbGxJc1Jvb3ROb2RlID0gdGhpcy5faXNSb290Tm9kZSggdGhpcy5zY3JvbGxQYXJlbnRbIDAgXSApLFxuXHRcdFx0cGFnZVggPSBldmVudC5wYWdlWCxcblx0XHRcdHBhZ2VZID0gZXZlbnQucGFnZVk7XG5cblx0XHQvLyBDYWNoZSB0aGUgc2Nyb2xsXG5cdFx0aWYgKCAhc2Nyb2xsSXNSb290Tm9kZSB8fCAhdGhpcy5vZmZzZXQuc2Nyb2xsICkge1xuXHRcdFx0dGhpcy5vZmZzZXQuc2Nyb2xsID0ge1xuXHRcdFx0XHR0b3A6IHRoaXMuc2Nyb2xsUGFyZW50LnNjcm9sbFRvcCgpLFxuXHRcdFx0XHRsZWZ0OiB0aGlzLnNjcm9sbFBhcmVudC5zY3JvbGxMZWZ0KClcblx0XHRcdH07XG5cdFx0fVxuXG5cdFx0Lypcblx0XHQgKiAtIFBvc2l0aW9uIGNvbnN0cmFpbmluZyAtXG5cdFx0ICogQ29uc3RyYWluIHRoZSBwb3NpdGlvbiB0byBhIG1peCBvZiBncmlkLCBjb250YWlubWVudC5cblx0XHQgKi9cblxuXHRcdC8vIElmIHdlIGFyZSBub3QgZHJhZ2dpbmcgeWV0LCB3ZSB3b24ndCBjaGVjayBmb3Igb3B0aW9uc1xuXHRcdGlmICggY29uc3RyYWluUG9zaXRpb24gKSB7XG5cdFx0XHRpZiAoIHRoaXMuY29udGFpbm1lbnQgKSB7XG5cdFx0XHRcdGlmICggdGhpcy5yZWxhdGl2ZUNvbnRhaW5lciApIHtcblx0XHRcdFx0XHRjbyA9IHRoaXMucmVsYXRpdmVDb250YWluZXIub2Zmc2V0KCk7XG5cdFx0XHRcdFx0Y29udGFpbm1lbnQgPSBbXG5cdFx0XHRcdFx0XHR0aGlzLmNvbnRhaW5tZW50WyAwIF0gKyBjby5sZWZ0LFxuXHRcdFx0XHRcdFx0dGhpcy5jb250YWlubWVudFsgMSBdICsgY28udG9wLFxuXHRcdFx0XHRcdFx0dGhpcy5jb250YWlubWVudFsgMiBdICsgY28ubGVmdCxcblx0XHRcdFx0XHRcdHRoaXMuY29udGFpbm1lbnRbIDMgXSArIGNvLnRvcFxuXHRcdFx0XHRcdF07XG5cdFx0XHRcdH0gZWxzZSB7XG5cdFx0XHRcdFx0Y29udGFpbm1lbnQgPSB0aGlzLmNvbnRhaW5tZW50O1xuXHRcdFx0XHR9XG5cblx0XHRcdFx0aWYgKCBldmVudC5wYWdlWCAtIHRoaXMub2Zmc2V0LmNsaWNrLmxlZnQgPCBjb250YWlubWVudFsgMCBdICkge1xuXHRcdFx0XHRcdHBhZ2VYID0gY29udGFpbm1lbnRbIDAgXSArIHRoaXMub2Zmc2V0LmNsaWNrLmxlZnQ7XG5cdFx0XHRcdH1cblx0XHRcdFx0aWYgKCBldmVudC5wYWdlWSAtIHRoaXMub2Zmc2V0LmNsaWNrLnRvcCA8IGNvbnRhaW5tZW50WyAxIF0gKSB7XG5cdFx0XHRcdFx0cGFnZVkgPSBjb250YWlubWVudFsgMSBdICsgdGhpcy5vZmZzZXQuY2xpY2sudG9wO1xuXHRcdFx0XHR9XG5cdFx0XHRcdGlmICggZXZlbnQucGFnZVggLSB0aGlzLm9mZnNldC5jbGljay5sZWZ0ID4gY29udGFpbm1lbnRbIDIgXSApIHtcblx0XHRcdFx0XHRwYWdlWCA9IGNvbnRhaW5tZW50WyAyIF0gKyB0aGlzLm9mZnNldC5jbGljay5sZWZ0O1xuXHRcdFx0XHR9XG5cdFx0XHRcdGlmICggZXZlbnQucGFnZVkgLSB0aGlzLm9mZnNldC5jbGljay50b3AgPiBjb250YWlubWVudFsgMyBdICkge1xuXHRcdFx0XHRcdHBhZ2VZID0gY29udGFpbm1lbnRbIDMgXSArIHRoaXMub2Zmc2V0LmNsaWNrLnRvcDtcblx0XHRcdFx0fVxuXHRcdFx0fVxuXG5cdFx0XHRpZiAoIG8uZ3JpZCApIHtcblxuXHRcdFx0XHQvL0NoZWNrIGZvciBncmlkIGVsZW1lbnRzIHNldCB0byAwIHRvIHByZXZlbnQgZGl2aWRlIGJ5IDAgZXJyb3IgY2F1c2luZyBpbnZhbGlkXG5cdFx0XHRcdC8vIGFyZ3VtZW50IGVycm9ycyBpbiBJRSAoc2VlIHRpY2tldCAjNjk1MClcblx0XHRcdFx0dG9wID0gby5ncmlkWyAxIF0gPyB0aGlzLm9yaWdpbmFsUGFnZVkgKyBNYXRoLnJvdW5kKCAoIHBhZ2VZIC1cblx0XHRcdFx0XHR0aGlzLm9yaWdpbmFsUGFnZVkgKSAvIG8uZ3JpZFsgMSBdICkgKiBvLmdyaWRbIDEgXSA6IHRoaXMub3JpZ2luYWxQYWdlWTtcblx0XHRcdFx0cGFnZVkgPSBjb250YWlubWVudCA/ICggKCB0b3AgLSB0aGlzLm9mZnNldC5jbGljay50b3AgPj0gY29udGFpbm1lbnRbIDEgXSB8fFxuXHRcdFx0XHRcdHRvcCAtIHRoaXMub2Zmc2V0LmNsaWNrLnRvcCA+IGNvbnRhaW5tZW50WyAzIF0gKSA/XG5cdFx0XHRcdFx0XHR0b3AgOlxuXHRcdFx0XHRcdFx0KCAoIHRvcCAtIHRoaXMub2Zmc2V0LmNsaWNrLnRvcCA+PSBjb250YWlubWVudFsgMSBdICkgP1xuXHRcdFx0XHRcdFx0XHR0b3AgLSBvLmdyaWRbIDEgXSA6IHRvcCArIG8uZ3JpZFsgMSBdICkgKSA6IHRvcDtcblxuXHRcdFx0XHRsZWZ0ID0gby5ncmlkWyAwIF0gPyB0aGlzLm9yaWdpbmFsUGFnZVggK1xuXHRcdFx0XHRcdE1hdGgucm91bmQoICggcGFnZVggLSB0aGlzLm9yaWdpbmFsUGFnZVggKSAvIG8uZ3JpZFsgMCBdICkgKiBvLmdyaWRbIDAgXSA6XG5cdFx0XHRcdFx0dGhpcy5vcmlnaW5hbFBhZ2VYO1xuXHRcdFx0XHRwYWdlWCA9IGNvbnRhaW5tZW50ID8gKCAoIGxlZnQgLSB0aGlzLm9mZnNldC5jbGljay5sZWZ0ID49IGNvbnRhaW5tZW50WyAwIF0gfHxcblx0XHRcdFx0XHRsZWZ0IC0gdGhpcy5vZmZzZXQuY2xpY2subGVmdCA+IGNvbnRhaW5tZW50WyAyIF0gKSA/XG5cdFx0XHRcdFx0XHRsZWZ0IDpcblx0XHRcdFx0XHRcdCggKCBsZWZ0IC0gdGhpcy5vZmZzZXQuY2xpY2subGVmdCA+PSBjb250YWlubWVudFsgMCBdICkgP1xuXHRcdFx0XHRcdFx0XHRsZWZ0IC0gby5ncmlkWyAwIF0gOiBsZWZ0ICsgby5ncmlkWyAwIF0gKSApIDogbGVmdDtcblx0XHRcdH1cblxuXHRcdFx0aWYgKCBvLmF4aXMgPT09IFwieVwiICkge1xuXHRcdFx0XHRwYWdlWCA9IHRoaXMub3JpZ2luYWxQYWdlWDtcblx0XHRcdH1cblxuXHRcdFx0aWYgKCBvLmF4aXMgPT09IFwieFwiICkge1xuXHRcdFx0XHRwYWdlWSA9IHRoaXMub3JpZ2luYWxQYWdlWTtcblx0XHRcdH1cblx0XHR9XG5cblx0XHRyZXR1cm4ge1xuXHRcdFx0dG9wOiAoXG5cblx0XHRcdFx0Ly8gVGhlIGFic29sdXRlIG1vdXNlIHBvc2l0aW9uXG5cdFx0XHRcdHBhZ2VZIC1cblxuXHRcdFx0XHQvLyBDbGljayBvZmZzZXQgKHJlbGF0aXZlIHRvIHRoZSBlbGVtZW50KVxuXHRcdFx0XHR0aGlzLm9mZnNldC5jbGljay50b3AgLVxuXG5cdFx0XHRcdC8vIE9ubHkgZm9yIHJlbGF0aXZlIHBvc2l0aW9uZWQgbm9kZXM6IFJlbGF0aXZlIG9mZnNldCBmcm9tIGVsZW1lbnQgdG8gb2Zmc2V0IHBhcmVudFxuXHRcdFx0XHR0aGlzLm9mZnNldC5yZWxhdGl2ZS50b3AgLVxuXG5cdFx0XHRcdC8vIFRoZSBvZmZzZXRQYXJlbnQncyBvZmZzZXQgd2l0aG91dCBib3JkZXJzIChvZmZzZXQgKyBib3JkZXIpXG5cdFx0XHRcdHRoaXMub2Zmc2V0LnBhcmVudC50b3AgK1xuXHRcdFx0XHQoIHRoaXMuY3NzUG9zaXRpb24gPT09IFwiZml4ZWRcIiA/XG5cdFx0XHRcdFx0LXRoaXMub2Zmc2V0LnNjcm9sbC50b3AgOlxuXHRcdFx0XHRcdCggc2Nyb2xsSXNSb290Tm9kZSA/IDAgOiB0aGlzLm9mZnNldC5zY3JvbGwudG9wICkgKVxuXHRcdFx0KSxcblx0XHRcdGxlZnQ6IChcblxuXHRcdFx0XHQvLyBUaGUgYWJzb2x1dGUgbW91c2UgcG9zaXRpb25cblx0XHRcdFx0cGFnZVggLVxuXG5cdFx0XHRcdC8vIENsaWNrIG9mZnNldCAocmVsYXRpdmUgdG8gdGhlIGVsZW1lbnQpXG5cdFx0XHRcdHRoaXMub2Zmc2V0LmNsaWNrLmxlZnQgLVxuXG5cdFx0XHRcdC8vIE9ubHkgZm9yIHJlbGF0aXZlIHBvc2l0aW9uZWQgbm9kZXM6IFJlbGF0aXZlIG9mZnNldCBmcm9tIGVsZW1lbnQgdG8gb2Zmc2V0IHBhcmVudFxuXHRcdFx0XHR0aGlzLm9mZnNldC5yZWxhdGl2ZS5sZWZ0IC1cblxuXHRcdFx0XHQvLyBUaGUgb2Zmc2V0UGFyZW50J3Mgb2Zmc2V0IHdpdGhvdXQgYm9yZGVycyAob2Zmc2V0ICsgYm9yZGVyKVxuXHRcdFx0XHR0aGlzLm9mZnNldC5wYXJlbnQubGVmdCArXG5cdFx0XHRcdCggdGhpcy5jc3NQb3NpdGlvbiA9PT0gXCJmaXhlZFwiID9cblx0XHRcdFx0XHQtdGhpcy5vZmZzZXQuc2Nyb2xsLmxlZnQgOlxuXHRcdFx0XHRcdCggc2Nyb2xsSXNSb290Tm9kZSA/IDAgOiB0aGlzLm9mZnNldC5zY3JvbGwubGVmdCApIClcblx0XHRcdClcblx0XHR9O1xuXG5cdH0sXG5cblx0X2NsZWFyOiBmdW5jdGlvbigpIHtcblx0XHR0aGlzLl9yZW1vdmVDbGFzcyggdGhpcy5oZWxwZXIsIFwidWktZHJhZ2dhYmxlLWRyYWdnaW5nXCIgKTtcblx0XHRpZiAoIHRoaXMuaGVscGVyWyAwIF0gIT09IHRoaXMuZWxlbWVudFsgMCBdICYmICF0aGlzLmNhbmNlbEhlbHBlclJlbW92YWwgKSB7XG5cdFx0XHR0aGlzLmhlbHBlci5yZW1vdmUoKTtcblx0XHR9XG5cdFx0dGhpcy5oZWxwZXIgPSBudWxsO1xuXHRcdHRoaXMuY2FuY2VsSGVscGVyUmVtb3ZhbCA9IGZhbHNlO1xuXHRcdGlmICggdGhpcy5kZXN0cm95T25DbGVhciApIHtcblx0XHRcdHRoaXMuZGVzdHJveSgpO1xuXHRcdH1cblx0fSxcblxuXHQvLyBGcm9tIG5vdyBvbiBidWxrIHN0dWZmIC0gbWFpbmx5IGhlbHBlcnNcblxuXHRfdHJpZ2dlcjogZnVuY3Rpb24oIHR5cGUsIGV2ZW50LCB1aSApIHtcblx0XHR1aSA9IHVpIHx8IHRoaXMuX3VpSGFzaCgpO1xuXHRcdCQudWkucGx1Z2luLmNhbGwoIHRoaXMsIHR5cGUsIFsgZXZlbnQsIHVpLCB0aGlzIF0sIHRydWUgKTtcblxuXHRcdC8vIEFic29sdXRlIHBvc2l0aW9uIGFuZCBvZmZzZXQgKHNlZSAjNjg4NCApIGhhdmUgdG8gYmUgcmVjYWxjdWxhdGVkIGFmdGVyIHBsdWdpbnNcblx0XHRpZiAoIC9eKGRyYWd8c3RhcnR8c3RvcCkvLnRlc3QoIHR5cGUgKSApIHtcblx0XHRcdHRoaXMucG9zaXRpb25BYnMgPSB0aGlzLl9jb252ZXJ0UG9zaXRpb25UbyggXCJhYnNvbHV0ZVwiICk7XG5cdFx0XHR1aS5vZmZzZXQgPSB0aGlzLnBvc2l0aW9uQWJzO1xuXHRcdH1cblx0XHRyZXR1cm4gJC5XaWRnZXQucHJvdG90eXBlLl90cmlnZ2VyLmNhbGwoIHRoaXMsIHR5cGUsIGV2ZW50LCB1aSApO1xuXHR9LFxuXG5cdHBsdWdpbnM6IHt9LFxuXG5cdF91aUhhc2g6IGZ1bmN0aW9uKCkge1xuXHRcdHJldHVybiB7XG5cdFx0XHRoZWxwZXI6IHRoaXMuaGVscGVyLFxuXHRcdFx0cG9zaXRpb246IHRoaXMucG9zaXRpb24sXG5cdFx0XHRvcmlnaW5hbFBvc2l0aW9uOiB0aGlzLm9yaWdpbmFsUG9zaXRpb24sXG5cdFx0XHRvZmZzZXQ6IHRoaXMucG9zaXRpb25BYnNcblx0XHR9O1xuXHR9XG5cbn0gKTtcblxuJC51aS5wbHVnaW4uYWRkKCBcImRyYWdnYWJsZVwiLCBcImNvbm5lY3RUb1NvcnRhYmxlXCIsIHtcblx0c3RhcnQ6IGZ1bmN0aW9uKCBldmVudCwgdWksIGRyYWdnYWJsZSApIHtcblx0XHR2YXIgdWlTb3J0YWJsZSA9ICQuZXh0ZW5kKCB7fSwgdWksIHtcblx0XHRcdGl0ZW06IGRyYWdnYWJsZS5lbGVtZW50XG5cdFx0fSApO1xuXG5cdFx0ZHJhZ2dhYmxlLnNvcnRhYmxlcyA9IFtdO1xuXHRcdCQoIGRyYWdnYWJsZS5vcHRpb25zLmNvbm5lY3RUb1NvcnRhYmxlICkuZWFjaCggZnVuY3Rpb24oKSB7XG5cdFx0XHR2YXIgc29ydGFibGUgPSAkKCB0aGlzICkuc29ydGFibGUoIFwiaW5zdGFuY2VcIiApO1xuXG5cdFx0XHRpZiAoIHNvcnRhYmxlICYmICFzb3J0YWJsZS5vcHRpb25zLmRpc2FibGVkICkge1xuXHRcdFx0XHRkcmFnZ2FibGUuc29ydGFibGVzLnB1c2goIHNvcnRhYmxlICk7XG5cblx0XHRcdFx0Ly8gUmVmcmVzaFBvc2l0aW9ucyBpcyBjYWxsZWQgYXQgZHJhZyBzdGFydCB0byByZWZyZXNoIHRoZSBjb250YWluZXJDYWNoZVxuXHRcdFx0XHQvLyB3aGljaCBpcyB1c2VkIGluIGRyYWcuIFRoaXMgZW5zdXJlcyBpdCdzIGluaXRpYWxpemVkIGFuZCBzeW5jaHJvbml6ZWRcblx0XHRcdFx0Ly8gd2l0aCBhbnkgY2hhbmdlcyB0aGF0IG1pZ2h0IGhhdmUgaGFwcGVuZWQgb24gdGhlIHBhZ2Ugc2luY2UgaW5pdGlhbGl6YXRpb24uXG5cdFx0XHRcdHNvcnRhYmxlLnJlZnJlc2hQb3NpdGlvbnMoKTtcblx0XHRcdFx0c29ydGFibGUuX3RyaWdnZXIoIFwiYWN0aXZhdGVcIiwgZXZlbnQsIHVpU29ydGFibGUgKTtcblx0XHRcdH1cblx0XHR9ICk7XG5cdH0sXG5cdHN0b3A6IGZ1bmN0aW9uKCBldmVudCwgdWksIGRyYWdnYWJsZSApIHtcblx0XHR2YXIgdWlTb3J0YWJsZSA9ICQuZXh0ZW5kKCB7fSwgdWksIHtcblx0XHRcdGl0ZW06IGRyYWdnYWJsZS5lbGVtZW50XG5cdFx0fSApO1xuXG5cdFx0ZHJhZ2dhYmxlLmNhbmNlbEhlbHBlclJlbW92YWwgPSBmYWxzZTtcblxuXHRcdCQuZWFjaCggZHJhZ2dhYmxlLnNvcnRhYmxlcywgZnVuY3Rpb24oKSB7XG5cdFx0XHR2YXIgc29ydGFibGUgPSB0aGlzO1xuXG5cdFx0XHRpZiAoIHNvcnRhYmxlLmlzT3ZlciApIHtcblx0XHRcdFx0c29ydGFibGUuaXNPdmVyID0gMDtcblxuXHRcdFx0XHQvLyBBbGxvdyB0aGlzIHNvcnRhYmxlIHRvIGhhbmRsZSByZW1vdmluZyB0aGUgaGVscGVyXG5cdFx0XHRcdGRyYWdnYWJsZS5jYW5jZWxIZWxwZXJSZW1vdmFsID0gdHJ1ZTtcblx0XHRcdFx0c29ydGFibGUuY2FuY2VsSGVscGVyUmVtb3ZhbCA9IGZhbHNlO1xuXG5cdFx0XHRcdC8vIFVzZSBfc3RvcmVkQ1NTIFRvIHJlc3RvcmUgcHJvcGVydGllcyBpbiB0aGUgc29ydGFibGUsXG5cdFx0XHRcdC8vIGFzIHRoaXMgYWxzbyBoYW5kbGVzIHJldmVydCAoIzk2NzUpIHNpbmNlIHRoZSBkcmFnZ2FibGVcblx0XHRcdFx0Ly8gbWF5IGhhdmUgbW9kaWZpZWQgdGhlbSBpbiB1bmV4cGVjdGVkIHdheXMgKCM4ODA5KVxuXHRcdFx0XHRzb3J0YWJsZS5fc3RvcmVkQ1NTID0ge1xuXHRcdFx0XHRcdHBvc2l0aW9uOiBzb3J0YWJsZS5wbGFjZWhvbGRlci5jc3MoIFwicG9zaXRpb25cIiApLFxuXHRcdFx0XHRcdHRvcDogc29ydGFibGUucGxhY2Vob2xkZXIuY3NzKCBcInRvcFwiICksXG5cdFx0XHRcdFx0bGVmdDogc29ydGFibGUucGxhY2Vob2xkZXIuY3NzKCBcImxlZnRcIiApXG5cdFx0XHRcdH07XG5cblx0XHRcdFx0c29ydGFibGUuX21vdXNlU3RvcCggZXZlbnQgKTtcblxuXHRcdFx0XHQvLyBPbmNlIGRyYWcgaGFzIGVuZGVkLCB0aGUgc29ydGFibGUgc2hvdWxkIHJldHVybiB0byB1c2luZ1xuXHRcdFx0XHQvLyBpdHMgb3JpZ2luYWwgaGVscGVyLCBub3QgdGhlIHNoYXJlZCBoZWxwZXIgZnJvbSBkcmFnZ2FibGVcblx0XHRcdFx0c29ydGFibGUub3B0aW9ucy5oZWxwZXIgPSBzb3J0YWJsZS5vcHRpb25zLl9oZWxwZXI7XG5cdFx0XHR9IGVsc2Uge1xuXG5cdFx0XHRcdC8vIFByZXZlbnQgdGhpcyBTb3J0YWJsZSBmcm9tIHJlbW92aW5nIHRoZSBoZWxwZXIuXG5cdFx0XHRcdC8vIEhvd2V2ZXIsIGRvbid0IHNldCB0aGUgZHJhZ2dhYmxlIHRvIHJlbW92ZSB0aGUgaGVscGVyXG5cdFx0XHRcdC8vIGVpdGhlciBhcyBhbm90aGVyIGNvbm5lY3RlZCBTb3J0YWJsZSBtYXkgeWV0IGhhbmRsZSB0aGUgcmVtb3ZhbC5cblx0XHRcdFx0c29ydGFibGUuY2FuY2VsSGVscGVyUmVtb3ZhbCA9IHRydWU7XG5cblx0XHRcdFx0c29ydGFibGUuX3RyaWdnZXIoIFwiZGVhY3RpdmF0ZVwiLCBldmVudCwgdWlTb3J0YWJsZSApO1xuXHRcdFx0fVxuXHRcdH0gKTtcblx0fSxcblx0ZHJhZzogZnVuY3Rpb24oIGV2ZW50LCB1aSwgZHJhZ2dhYmxlICkge1xuXHRcdCQuZWFjaCggZHJhZ2dhYmxlLnNvcnRhYmxlcywgZnVuY3Rpb24oKSB7XG5cdFx0XHR2YXIgaW5uZXJtb3N0SW50ZXJzZWN0aW5nID0gZmFsc2UsXG5cdFx0XHRcdHNvcnRhYmxlID0gdGhpcztcblxuXHRcdFx0Ly8gQ29weSBvdmVyIHZhcmlhYmxlcyB0aGF0IHNvcnRhYmxlJ3MgX2ludGVyc2VjdHNXaXRoIHVzZXNcblx0XHRcdHNvcnRhYmxlLnBvc2l0aW9uQWJzID0gZHJhZ2dhYmxlLnBvc2l0aW9uQWJzO1xuXHRcdFx0c29ydGFibGUuaGVscGVyUHJvcG9ydGlvbnMgPSBkcmFnZ2FibGUuaGVscGVyUHJvcG9ydGlvbnM7XG5cdFx0XHRzb3J0YWJsZS5vZmZzZXQuY2xpY2sgPSBkcmFnZ2FibGUub2Zmc2V0LmNsaWNrO1xuXG5cdFx0XHRpZiAoIHNvcnRhYmxlLl9pbnRlcnNlY3RzV2l0aCggc29ydGFibGUuY29udGFpbmVyQ2FjaGUgKSApIHtcblx0XHRcdFx0aW5uZXJtb3N0SW50ZXJzZWN0aW5nID0gdHJ1ZTtcblxuXHRcdFx0XHQkLmVhY2goIGRyYWdnYWJsZS5zb3J0YWJsZXMsIGZ1bmN0aW9uKCkge1xuXG5cdFx0XHRcdFx0Ly8gQ29weSBvdmVyIHZhcmlhYmxlcyB0aGF0IHNvcnRhYmxlJ3MgX2ludGVyc2VjdHNXaXRoIHVzZXNcblx0XHRcdFx0XHR0aGlzLnBvc2l0aW9uQWJzID0gZHJhZ2dhYmxlLnBvc2l0aW9uQWJzO1xuXHRcdFx0XHRcdHRoaXMuaGVscGVyUHJvcG9ydGlvbnMgPSBkcmFnZ2FibGUuaGVscGVyUHJvcG9ydGlvbnM7XG5cdFx0XHRcdFx0dGhpcy5vZmZzZXQuY2xpY2sgPSBkcmFnZ2FibGUub2Zmc2V0LmNsaWNrO1xuXG5cdFx0XHRcdFx0aWYgKCB0aGlzICE9PSBzb3J0YWJsZSAmJlxuXHRcdFx0XHRcdFx0XHR0aGlzLl9pbnRlcnNlY3RzV2l0aCggdGhpcy5jb250YWluZXJDYWNoZSApICYmXG5cdFx0XHRcdFx0XHRcdCQuY29udGFpbnMoIHNvcnRhYmxlLmVsZW1lbnRbIDAgXSwgdGhpcy5lbGVtZW50WyAwIF0gKSApIHtcblx0XHRcdFx0XHRcdGlubmVybW9zdEludGVyc2VjdGluZyA9IGZhbHNlO1xuXHRcdFx0XHRcdH1cblxuXHRcdFx0XHRcdHJldHVybiBpbm5lcm1vc3RJbnRlcnNlY3Rpbmc7XG5cdFx0XHRcdH0gKTtcblx0XHRcdH1cblxuXHRcdFx0aWYgKCBpbm5lcm1vc3RJbnRlcnNlY3RpbmcgKSB7XG5cblx0XHRcdFx0Ly8gSWYgaXQgaW50ZXJzZWN0cywgd2UgdXNlIGEgbGl0dGxlIGlzT3ZlciB2YXJpYWJsZSBhbmQgc2V0IGl0IG9uY2UsXG5cdFx0XHRcdC8vIHNvIHRoYXQgdGhlIG1vdmUtaW4gc3R1ZmYgZ2V0cyBmaXJlZCBvbmx5IG9uY2UuXG5cdFx0XHRcdGlmICggIXNvcnRhYmxlLmlzT3ZlciApIHtcblx0XHRcdFx0XHRzb3J0YWJsZS5pc092ZXIgPSAxO1xuXG5cdFx0XHRcdFx0Ly8gU3RvcmUgZHJhZ2dhYmxlJ3MgcGFyZW50IGluIGNhc2Ugd2UgbmVlZCB0byByZWFwcGVuZCB0byBpdCBsYXRlci5cblx0XHRcdFx0XHRkcmFnZ2FibGUuX3BhcmVudCA9IHVpLmhlbHBlci5wYXJlbnQoKTtcblxuXHRcdFx0XHRcdHNvcnRhYmxlLmN1cnJlbnRJdGVtID0gdWkuaGVscGVyXG5cdFx0XHRcdFx0XHQuYXBwZW5kVG8oIHNvcnRhYmxlLmVsZW1lbnQgKVxuXHRcdFx0XHRcdFx0LmRhdGEoIFwidWktc29ydGFibGUtaXRlbVwiLCB0cnVlICk7XG5cblx0XHRcdFx0XHQvLyBTdG9yZSBoZWxwZXIgb3B0aW9uIHRvIGxhdGVyIHJlc3RvcmUgaXRcblx0XHRcdFx0XHRzb3J0YWJsZS5vcHRpb25zLl9oZWxwZXIgPSBzb3J0YWJsZS5vcHRpb25zLmhlbHBlcjtcblxuXHRcdFx0XHRcdHNvcnRhYmxlLm9wdGlvbnMuaGVscGVyID0gZnVuY3Rpb24oKSB7XG5cdFx0XHRcdFx0XHRyZXR1cm4gdWkuaGVscGVyWyAwIF07XG5cdFx0XHRcdFx0fTtcblxuXHRcdFx0XHRcdC8vIEZpcmUgdGhlIHN0YXJ0IGV2ZW50cyBvZiB0aGUgc29ydGFibGUgd2l0aCBvdXIgcGFzc2VkIGJyb3dzZXIgZXZlbnQsXG5cdFx0XHRcdFx0Ly8gYW5kIG91ciBvd24gaGVscGVyIChzbyBpdCBkb2Vzbid0IGNyZWF0ZSBhIG5ldyBvbmUpXG5cdFx0XHRcdFx0ZXZlbnQudGFyZ2V0ID0gc29ydGFibGUuY3VycmVudEl0ZW1bIDAgXTtcblx0XHRcdFx0XHRzb3J0YWJsZS5fbW91c2VDYXB0dXJlKCBldmVudCwgdHJ1ZSApO1xuXHRcdFx0XHRcdHNvcnRhYmxlLl9tb3VzZVN0YXJ0KCBldmVudCwgdHJ1ZSwgdHJ1ZSApO1xuXG5cdFx0XHRcdFx0Ly8gQmVjYXVzZSB0aGUgYnJvd3NlciBldmVudCBpcyB3YXkgb2ZmIHRoZSBuZXcgYXBwZW5kZWQgcG9ydGxldCxcblx0XHRcdFx0XHQvLyBtb2RpZnkgbmVjZXNzYXJ5IHZhcmlhYmxlcyB0byByZWZsZWN0IHRoZSBjaGFuZ2VzXG5cdFx0XHRcdFx0c29ydGFibGUub2Zmc2V0LmNsaWNrLnRvcCA9IGRyYWdnYWJsZS5vZmZzZXQuY2xpY2sudG9wO1xuXHRcdFx0XHRcdHNvcnRhYmxlLm9mZnNldC5jbGljay5sZWZ0ID0gZHJhZ2dhYmxlLm9mZnNldC5jbGljay5sZWZ0O1xuXHRcdFx0XHRcdHNvcnRhYmxlLm9mZnNldC5wYXJlbnQubGVmdCAtPSBkcmFnZ2FibGUub2Zmc2V0LnBhcmVudC5sZWZ0IC1cblx0XHRcdFx0XHRcdHNvcnRhYmxlLm9mZnNldC5wYXJlbnQubGVmdDtcblx0XHRcdFx0XHRzb3J0YWJsZS5vZmZzZXQucGFyZW50LnRvcCAtPSBkcmFnZ2FibGUub2Zmc2V0LnBhcmVudC50b3AgLVxuXHRcdFx0XHRcdFx0c29ydGFibGUub2Zmc2V0LnBhcmVudC50b3A7XG5cblx0XHRcdFx0XHRkcmFnZ2FibGUuX3RyaWdnZXIoIFwidG9Tb3J0YWJsZVwiLCBldmVudCApO1xuXG5cdFx0XHRcdFx0Ly8gSW5mb3JtIGRyYWdnYWJsZSB0aGF0IHRoZSBoZWxwZXIgaXMgaW4gYSB2YWxpZCBkcm9wIHpvbmUsXG5cdFx0XHRcdFx0Ly8gdXNlZCBzb2xlbHkgaW4gdGhlIHJldmVydCBvcHRpb24gdG8gaGFuZGxlIFwidmFsaWQvaW52YWxpZFwiLlxuXHRcdFx0XHRcdGRyYWdnYWJsZS5kcm9wcGVkID0gc29ydGFibGUuZWxlbWVudDtcblxuXHRcdFx0XHRcdC8vIE5lZWQgdG8gcmVmcmVzaFBvc2l0aW9ucyBvZiBhbGwgc29ydGFibGVzIGluIHRoZSBjYXNlIHRoYXRcblx0XHRcdFx0XHQvLyBhZGRpbmcgdG8gb25lIHNvcnRhYmxlIGNoYW5nZXMgdGhlIGxvY2F0aW9uIG9mIHRoZSBvdGhlciBzb3J0YWJsZXMgKCM5Njc1KVxuXHRcdFx0XHRcdCQuZWFjaCggZHJhZ2dhYmxlLnNvcnRhYmxlcywgZnVuY3Rpb24oKSB7XG5cdFx0XHRcdFx0XHR0aGlzLnJlZnJlc2hQb3NpdGlvbnMoKTtcblx0XHRcdFx0XHR9ICk7XG5cblx0XHRcdFx0XHQvLyBIYWNrIHNvIHJlY2VpdmUvdXBkYXRlIGNhbGxiYWNrcyB3b3JrIChtb3N0bHkpXG5cdFx0XHRcdFx0ZHJhZ2dhYmxlLmN1cnJlbnRJdGVtID0gZHJhZ2dhYmxlLmVsZW1lbnQ7XG5cdFx0XHRcdFx0c29ydGFibGUuZnJvbU91dHNpZGUgPSBkcmFnZ2FibGU7XG5cdFx0XHRcdH1cblxuXHRcdFx0XHRpZiAoIHNvcnRhYmxlLmN1cnJlbnRJdGVtICkge1xuXHRcdFx0XHRcdHNvcnRhYmxlLl9tb3VzZURyYWcoIGV2ZW50ICk7XG5cblx0XHRcdFx0XHQvLyBDb3B5IHRoZSBzb3J0YWJsZSdzIHBvc2l0aW9uIGJlY2F1c2UgdGhlIGRyYWdnYWJsZSdzIGNhbiBwb3RlbnRpYWxseSByZWZsZWN0XG5cdFx0XHRcdFx0Ly8gYSByZWxhdGl2ZSBwb3NpdGlvbiwgd2hpbGUgc29ydGFibGUgaXMgYWx3YXlzIGFic29sdXRlLCB3aGljaCB0aGUgZHJhZ2dlZFxuXHRcdFx0XHRcdC8vIGVsZW1lbnQgaGFzIG5vdyBiZWNvbWUuICgjODgwOSlcblx0XHRcdFx0XHR1aS5wb3NpdGlvbiA9IHNvcnRhYmxlLnBvc2l0aW9uO1xuXHRcdFx0XHR9XG5cdFx0XHR9IGVsc2Uge1xuXG5cdFx0XHRcdC8vIElmIGl0IGRvZXNuJ3QgaW50ZXJzZWN0IHdpdGggdGhlIHNvcnRhYmxlLCBhbmQgaXQgaW50ZXJzZWN0ZWQgYmVmb3JlLFxuXHRcdFx0XHQvLyB3ZSBmYWtlIHRoZSBkcmFnIHN0b3Agb2YgdGhlIHNvcnRhYmxlLCBidXQgbWFrZSBzdXJlIGl0IGRvZXNuJ3QgcmVtb3ZlXG5cdFx0XHRcdC8vIHRoZSBoZWxwZXIgYnkgdXNpbmcgY2FuY2VsSGVscGVyUmVtb3ZhbC5cblx0XHRcdFx0aWYgKCBzb3J0YWJsZS5pc092ZXIgKSB7XG5cblx0XHRcdFx0XHRzb3J0YWJsZS5pc092ZXIgPSAwO1xuXHRcdFx0XHRcdHNvcnRhYmxlLmNhbmNlbEhlbHBlclJlbW92YWwgPSB0cnVlO1xuXG5cdFx0XHRcdFx0Ly8gQ2FsbGluZyBzb3J0YWJsZSdzIG1vdXNlU3RvcCB3b3VsZCB0cmlnZ2VyIGEgcmV2ZXJ0LFxuXHRcdFx0XHRcdC8vIHNvIHJldmVydCBtdXN0IGJlIHRlbXBvcmFyaWx5IGZhbHNlIHVudGlsIGFmdGVyIG1vdXNlU3RvcCBpcyBjYWxsZWQuXG5cdFx0XHRcdFx0c29ydGFibGUub3B0aW9ucy5fcmV2ZXJ0ID0gc29ydGFibGUub3B0aW9ucy5yZXZlcnQ7XG5cdFx0XHRcdFx0c29ydGFibGUub3B0aW9ucy5yZXZlcnQgPSBmYWxzZTtcblxuXHRcdFx0XHRcdHNvcnRhYmxlLl90cmlnZ2VyKCBcIm91dFwiLCBldmVudCwgc29ydGFibGUuX3VpSGFzaCggc29ydGFibGUgKSApO1xuXHRcdFx0XHRcdHNvcnRhYmxlLl9tb3VzZVN0b3AoIGV2ZW50LCB0cnVlICk7XG5cblx0XHRcdFx0XHQvLyBSZXN0b3JlIHNvcnRhYmxlIGJlaGF2aW9ycyB0aGF0IHdlcmUgbW9kZmllZFxuXHRcdFx0XHRcdC8vIHdoZW4gdGhlIGRyYWdnYWJsZSBlbnRlcmVkIHRoZSBzb3J0YWJsZSBhcmVhICgjOTQ4MSlcblx0XHRcdFx0XHRzb3J0YWJsZS5vcHRpb25zLnJldmVydCA9IHNvcnRhYmxlLm9wdGlvbnMuX3JldmVydDtcblx0XHRcdFx0XHRzb3J0YWJsZS5vcHRpb25zLmhlbHBlciA9IHNvcnRhYmxlLm9wdGlvbnMuX2hlbHBlcjtcblxuXHRcdFx0XHRcdGlmICggc29ydGFibGUucGxhY2Vob2xkZXIgKSB7XG5cdFx0XHRcdFx0XHRzb3J0YWJsZS5wbGFjZWhvbGRlci5yZW1vdmUoKTtcblx0XHRcdFx0XHR9XG5cblx0XHRcdFx0XHQvLyBSZXN0b3JlIGFuZCByZWNhbGN1bGF0ZSB0aGUgZHJhZ2dhYmxlJ3Mgb2Zmc2V0IGNvbnNpZGVyaW5nIHRoZSBzb3J0YWJsZVxuXHRcdFx0XHRcdC8vIG1heSBoYXZlIG1vZGlmaWVkIHRoZW0gaW4gdW5leHBlY3RlZCB3YXlzLiAoIzg4MDksICMxMDY2OSlcblx0XHRcdFx0XHR1aS5oZWxwZXIuYXBwZW5kVG8oIGRyYWdnYWJsZS5fcGFyZW50ICk7XG5cdFx0XHRcdFx0ZHJhZ2dhYmxlLl9yZWZyZXNoT2Zmc2V0cyggZXZlbnQgKTtcblx0XHRcdFx0XHR1aS5wb3NpdGlvbiA9IGRyYWdnYWJsZS5fZ2VuZXJhdGVQb3NpdGlvbiggZXZlbnQsIHRydWUgKTtcblxuXHRcdFx0XHRcdGRyYWdnYWJsZS5fdHJpZ2dlciggXCJmcm9tU29ydGFibGVcIiwgZXZlbnQgKTtcblxuXHRcdFx0XHRcdC8vIEluZm9ybSBkcmFnZ2FibGUgdGhhdCB0aGUgaGVscGVyIGlzIG5vIGxvbmdlciBpbiBhIHZhbGlkIGRyb3Agem9uZVxuXHRcdFx0XHRcdGRyYWdnYWJsZS5kcm9wcGVkID0gZmFsc2U7XG5cblx0XHRcdFx0XHQvLyBOZWVkIHRvIHJlZnJlc2hQb3NpdGlvbnMgb2YgYWxsIHNvcnRhYmxlcyBqdXN0IGluIGNhc2UgcmVtb3Zpbmdcblx0XHRcdFx0XHQvLyBmcm9tIG9uZSBzb3J0YWJsZSBjaGFuZ2VzIHRoZSBsb2NhdGlvbiBvZiBvdGhlciBzb3J0YWJsZXMgKCM5Njc1KVxuXHRcdFx0XHRcdCQuZWFjaCggZHJhZ2dhYmxlLnNvcnRhYmxlcywgZnVuY3Rpb24oKSB7XG5cdFx0XHRcdFx0XHR0aGlzLnJlZnJlc2hQb3NpdGlvbnMoKTtcblx0XHRcdFx0XHR9ICk7XG5cdFx0XHRcdH1cblx0XHRcdH1cblx0XHR9ICk7XG5cdH1cbn0gKTtcblxuJC51aS5wbHVnaW4uYWRkKCBcImRyYWdnYWJsZVwiLCBcImN1cnNvclwiLCB7XG5cdHN0YXJ0OiBmdW5jdGlvbiggZXZlbnQsIHVpLCBpbnN0YW5jZSApIHtcblx0XHR2YXIgdCA9ICQoIFwiYm9keVwiICksXG5cdFx0XHRvID0gaW5zdGFuY2Uub3B0aW9ucztcblxuXHRcdGlmICggdC5jc3MoIFwiY3Vyc29yXCIgKSApIHtcblx0XHRcdG8uX2N1cnNvciA9IHQuY3NzKCBcImN1cnNvclwiICk7XG5cdFx0fVxuXHRcdHQuY3NzKCBcImN1cnNvclwiLCBvLmN1cnNvciApO1xuXHR9LFxuXHRzdG9wOiBmdW5jdGlvbiggZXZlbnQsIHVpLCBpbnN0YW5jZSApIHtcblx0XHR2YXIgbyA9IGluc3RhbmNlLm9wdGlvbnM7XG5cdFx0aWYgKCBvLl9jdXJzb3IgKSB7XG5cdFx0XHQkKCBcImJvZHlcIiApLmNzcyggXCJjdXJzb3JcIiwgby5fY3Vyc29yICk7XG5cdFx0fVxuXHR9XG59ICk7XG5cbiQudWkucGx1Z2luLmFkZCggXCJkcmFnZ2FibGVcIiwgXCJvcGFjaXR5XCIsIHtcblx0c3RhcnQ6IGZ1bmN0aW9uKCBldmVudCwgdWksIGluc3RhbmNlICkge1xuXHRcdHZhciB0ID0gJCggdWkuaGVscGVyICksXG5cdFx0XHRvID0gaW5zdGFuY2Uub3B0aW9ucztcblx0XHRpZiAoIHQuY3NzKCBcIm9wYWNpdHlcIiApICkge1xuXHRcdFx0by5fb3BhY2l0eSA9IHQuY3NzKCBcIm9wYWNpdHlcIiApO1xuXHRcdH1cblx0XHR0LmNzcyggXCJvcGFjaXR5XCIsIG8ub3BhY2l0eSApO1xuXHR9LFxuXHRzdG9wOiBmdW5jdGlvbiggZXZlbnQsIHVpLCBpbnN0YW5jZSApIHtcblx0XHR2YXIgbyA9IGluc3RhbmNlLm9wdGlvbnM7XG5cdFx0aWYgKCBvLl9vcGFjaXR5ICkge1xuXHRcdFx0JCggdWkuaGVscGVyICkuY3NzKCBcIm9wYWNpdHlcIiwgby5fb3BhY2l0eSApO1xuXHRcdH1cblx0fVxufSApO1xuXG4kLnVpLnBsdWdpbi5hZGQoIFwiZHJhZ2dhYmxlXCIsIFwic2Nyb2xsXCIsIHtcblx0c3RhcnQ6IGZ1bmN0aW9uKCBldmVudCwgdWksIGkgKSB7XG5cdFx0aWYgKCAhaS5zY3JvbGxQYXJlbnROb3RIaWRkZW4gKSB7XG5cdFx0XHRpLnNjcm9sbFBhcmVudE5vdEhpZGRlbiA9IGkuaGVscGVyLnNjcm9sbFBhcmVudCggZmFsc2UgKTtcblx0XHR9XG5cblx0XHRpZiAoIGkuc2Nyb2xsUGFyZW50Tm90SGlkZGVuWyAwIF0gIT09IGkuZG9jdW1lbnRbIDAgXSAmJlxuXHRcdFx0XHRpLnNjcm9sbFBhcmVudE5vdEhpZGRlblsgMCBdLnRhZ05hbWUgIT09IFwiSFRNTFwiICkge1xuXHRcdFx0aS5vdmVyZmxvd09mZnNldCA9IGkuc2Nyb2xsUGFyZW50Tm90SGlkZGVuLm9mZnNldCgpO1xuXHRcdH1cblx0fSxcblx0ZHJhZzogZnVuY3Rpb24oIGV2ZW50LCB1aSwgaSAgKSB7XG5cblx0XHR2YXIgbyA9IGkub3B0aW9ucyxcblx0XHRcdHNjcm9sbGVkID0gZmFsc2UsXG5cdFx0XHRzY3JvbGxQYXJlbnQgPSBpLnNjcm9sbFBhcmVudE5vdEhpZGRlblsgMCBdLFxuXHRcdFx0ZG9jdW1lbnQgPSBpLmRvY3VtZW50WyAwIF07XG5cblx0XHRpZiAoIHNjcm9sbFBhcmVudCAhPT0gZG9jdW1lbnQgJiYgc2Nyb2xsUGFyZW50LnRhZ05hbWUgIT09IFwiSFRNTFwiICkge1xuXHRcdFx0aWYgKCAhby5heGlzIHx8IG8uYXhpcyAhPT0gXCJ4XCIgKSB7XG5cdFx0XHRcdGlmICggKCBpLm92ZXJmbG93T2Zmc2V0LnRvcCArIHNjcm9sbFBhcmVudC5vZmZzZXRIZWlnaHQgKSAtIGV2ZW50LnBhZ2VZIDxcblx0XHRcdFx0XHRcdG8uc2Nyb2xsU2Vuc2l0aXZpdHkgKSB7XG5cdFx0XHRcdFx0c2Nyb2xsUGFyZW50LnNjcm9sbFRvcCA9IHNjcm9sbGVkID0gc2Nyb2xsUGFyZW50LnNjcm9sbFRvcCArIG8uc2Nyb2xsU3BlZWQ7XG5cdFx0XHRcdH0gZWxzZSBpZiAoIGV2ZW50LnBhZ2VZIC0gaS5vdmVyZmxvd09mZnNldC50b3AgPCBvLnNjcm9sbFNlbnNpdGl2aXR5ICkge1xuXHRcdFx0XHRcdHNjcm9sbFBhcmVudC5zY3JvbGxUb3AgPSBzY3JvbGxlZCA9IHNjcm9sbFBhcmVudC5zY3JvbGxUb3AgLSBvLnNjcm9sbFNwZWVkO1xuXHRcdFx0XHR9XG5cdFx0XHR9XG5cblx0XHRcdGlmICggIW8uYXhpcyB8fCBvLmF4aXMgIT09IFwieVwiICkge1xuXHRcdFx0XHRpZiAoICggaS5vdmVyZmxvd09mZnNldC5sZWZ0ICsgc2Nyb2xsUGFyZW50Lm9mZnNldFdpZHRoICkgLSBldmVudC5wYWdlWCA8XG5cdFx0XHRcdFx0XHRvLnNjcm9sbFNlbnNpdGl2aXR5ICkge1xuXHRcdFx0XHRcdHNjcm9sbFBhcmVudC5zY3JvbGxMZWZ0ID0gc2Nyb2xsZWQgPSBzY3JvbGxQYXJlbnQuc2Nyb2xsTGVmdCArIG8uc2Nyb2xsU3BlZWQ7XG5cdFx0XHRcdH0gZWxzZSBpZiAoIGV2ZW50LnBhZ2VYIC0gaS5vdmVyZmxvd09mZnNldC5sZWZ0IDwgby5zY3JvbGxTZW5zaXRpdml0eSApIHtcblx0XHRcdFx0XHRzY3JvbGxQYXJlbnQuc2Nyb2xsTGVmdCA9IHNjcm9sbGVkID0gc2Nyb2xsUGFyZW50LnNjcm9sbExlZnQgLSBvLnNjcm9sbFNwZWVkO1xuXHRcdFx0XHR9XG5cdFx0XHR9XG5cblx0XHR9IGVsc2Uge1xuXG5cdFx0XHRpZiAoICFvLmF4aXMgfHwgby5heGlzICE9PSBcInhcIiApIHtcblx0XHRcdFx0aWYgKCBldmVudC5wYWdlWSAtICQoIGRvY3VtZW50ICkuc2Nyb2xsVG9wKCkgPCBvLnNjcm9sbFNlbnNpdGl2aXR5ICkge1xuXHRcdFx0XHRcdHNjcm9sbGVkID0gJCggZG9jdW1lbnQgKS5zY3JvbGxUb3AoICQoIGRvY3VtZW50ICkuc2Nyb2xsVG9wKCkgLSBvLnNjcm9sbFNwZWVkICk7XG5cdFx0XHRcdH0gZWxzZSBpZiAoICQoIHdpbmRvdyApLmhlaWdodCgpIC0gKCBldmVudC5wYWdlWSAtICQoIGRvY3VtZW50ICkuc2Nyb2xsVG9wKCkgKSA8XG5cdFx0XHRcdFx0XHRvLnNjcm9sbFNlbnNpdGl2aXR5ICkge1xuXHRcdFx0XHRcdHNjcm9sbGVkID0gJCggZG9jdW1lbnQgKS5zY3JvbGxUb3AoICQoIGRvY3VtZW50ICkuc2Nyb2xsVG9wKCkgKyBvLnNjcm9sbFNwZWVkICk7XG5cdFx0XHRcdH1cblx0XHRcdH1cblxuXHRcdFx0aWYgKCAhby5heGlzIHx8IG8uYXhpcyAhPT0gXCJ5XCIgKSB7XG5cdFx0XHRcdGlmICggZXZlbnQucGFnZVggLSAkKCBkb2N1bWVudCApLnNjcm9sbExlZnQoKSA8IG8uc2Nyb2xsU2Vuc2l0aXZpdHkgKSB7XG5cdFx0XHRcdFx0c2Nyb2xsZWQgPSAkKCBkb2N1bWVudCApLnNjcm9sbExlZnQoXG5cdFx0XHRcdFx0XHQkKCBkb2N1bWVudCApLnNjcm9sbExlZnQoKSAtIG8uc2Nyb2xsU3BlZWRcblx0XHRcdFx0XHQpO1xuXHRcdFx0XHR9IGVsc2UgaWYgKCAkKCB3aW5kb3cgKS53aWR0aCgpIC0gKCBldmVudC5wYWdlWCAtICQoIGRvY3VtZW50ICkuc2Nyb2xsTGVmdCgpICkgPFxuXHRcdFx0XHRcdFx0by5zY3JvbGxTZW5zaXRpdml0eSApIHtcblx0XHRcdFx0XHRzY3JvbGxlZCA9ICQoIGRvY3VtZW50ICkuc2Nyb2xsTGVmdChcblx0XHRcdFx0XHRcdCQoIGRvY3VtZW50ICkuc2Nyb2xsTGVmdCgpICsgby5zY3JvbGxTcGVlZFxuXHRcdFx0XHRcdCk7XG5cdFx0XHRcdH1cblx0XHRcdH1cblxuXHRcdH1cblxuXHRcdGlmICggc2Nyb2xsZWQgIT09IGZhbHNlICYmICQudWkuZGRtYW5hZ2VyICYmICFvLmRyb3BCZWhhdmlvdXIgKSB7XG5cdFx0XHQkLnVpLmRkbWFuYWdlci5wcmVwYXJlT2Zmc2V0cyggaSwgZXZlbnQgKTtcblx0XHR9XG5cblx0fVxufSApO1xuXG4kLnVpLnBsdWdpbi5hZGQoIFwiZHJhZ2dhYmxlXCIsIFwic25hcFwiLCB7XG5cdHN0YXJ0OiBmdW5jdGlvbiggZXZlbnQsIHVpLCBpICkge1xuXG5cdFx0dmFyIG8gPSBpLm9wdGlvbnM7XG5cblx0XHRpLnNuYXBFbGVtZW50cyA9IFtdO1xuXG5cdFx0JCggby5zbmFwLmNvbnN0cnVjdG9yICE9PSBTdHJpbmcgPyAoIG8uc25hcC5pdGVtcyB8fCBcIjpkYXRhKHVpLWRyYWdnYWJsZSlcIiApIDogby5zbmFwIClcblx0XHRcdC5lYWNoKCBmdW5jdGlvbigpIHtcblx0XHRcdFx0dmFyICR0ID0gJCggdGhpcyApLFxuXHRcdFx0XHRcdCRvID0gJHQub2Zmc2V0KCk7XG5cdFx0XHRcdGlmICggdGhpcyAhPT0gaS5lbGVtZW50WyAwIF0gKSB7XG5cdFx0XHRcdFx0aS5zbmFwRWxlbWVudHMucHVzaCgge1xuXHRcdFx0XHRcdFx0aXRlbTogdGhpcyxcblx0XHRcdFx0XHRcdHdpZHRoOiAkdC5vdXRlcldpZHRoKCksIGhlaWdodDogJHQub3V0ZXJIZWlnaHQoKSxcblx0XHRcdFx0XHRcdHRvcDogJG8udG9wLCBsZWZ0OiAkby5sZWZ0XG5cdFx0XHRcdFx0fSApO1xuXHRcdFx0XHR9XG5cdFx0XHR9ICk7XG5cblx0fSxcblx0ZHJhZzogZnVuY3Rpb24oIGV2ZW50LCB1aSwgaW5zdCApIHtcblxuXHRcdHZhciB0cywgYnMsIGxzLCBycywgbCwgciwgdCwgYiwgaSwgZmlyc3QsXG5cdFx0XHRvID0gaW5zdC5vcHRpb25zLFxuXHRcdFx0ZCA9IG8uc25hcFRvbGVyYW5jZSxcblx0XHRcdHgxID0gdWkub2Zmc2V0LmxlZnQsIHgyID0geDEgKyBpbnN0LmhlbHBlclByb3BvcnRpb25zLndpZHRoLFxuXHRcdFx0eTEgPSB1aS5vZmZzZXQudG9wLCB5MiA9IHkxICsgaW5zdC5oZWxwZXJQcm9wb3J0aW9ucy5oZWlnaHQ7XG5cblx0XHRmb3IgKCBpID0gaW5zdC5zbmFwRWxlbWVudHMubGVuZ3RoIC0gMTsgaSA+PSAwOyBpLS0gKSB7XG5cblx0XHRcdGwgPSBpbnN0LnNuYXBFbGVtZW50c1sgaSBdLmxlZnQgLSBpbnN0Lm1hcmdpbnMubGVmdDtcblx0XHRcdHIgPSBsICsgaW5zdC5zbmFwRWxlbWVudHNbIGkgXS53aWR0aDtcblx0XHRcdHQgPSBpbnN0LnNuYXBFbGVtZW50c1sgaSBdLnRvcCAtIGluc3QubWFyZ2lucy50b3A7XG5cdFx0XHRiID0gdCArIGluc3Quc25hcEVsZW1lbnRzWyBpIF0uaGVpZ2h0O1xuXG5cdFx0XHRpZiAoIHgyIDwgbCAtIGQgfHwgeDEgPiByICsgZCB8fCB5MiA8IHQgLSBkIHx8IHkxID4gYiArIGQgfHxcblx0XHRcdFx0XHQhJC5jb250YWlucyggaW5zdC5zbmFwRWxlbWVudHNbIGkgXS5pdGVtLm93bmVyRG9jdW1lbnQsXG5cdFx0XHRcdFx0aW5zdC5zbmFwRWxlbWVudHNbIGkgXS5pdGVtICkgKSB7XG5cdFx0XHRcdGlmICggaW5zdC5zbmFwRWxlbWVudHNbIGkgXS5zbmFwcGluZyApIHtcblx0XHRcdFx0XHQoIGluc3Qub3B0aW9ucy5zbmFwLnJlbGVhc2UgJiZcblx0XHRcdFx0XHRcdGluc3Qub3B0aW9ucy5zbmFwLnJlbGVhc2UuY2FsbChcblx0XHRcdFx0XHRcdFx0aW5zdC5lbGVtZW50LFxuXHRcdFx0XHRcdFx0XHRldmVudCxcblx0XHRcdFx0XHRcdFx0JC5leHRlbmQoIGluc3QuX3VpSGFzaCgpLCB7IHNuYXBJdGVtOiBpbnN0LnNuYXBFbGVtZW50c1sgaSBdLml0ZW0gfSApXG5cdFx0XHRcdFx0XHQpICk7XG5cdFx0XHRcdH1cblx0XHRcdFx0aW5zdC5zbmFwRWxlbWVudHNbIGkgXS5zbmFwcGluZyA9IGZhbHNlO1xuXHRcdFx0XHRjb250aW51ZTtcblx0XHRcdH1cblxuXHRcdFx0aWYgKCBvLnNuYXBNb2RlICE9PSBcImlubmVyXCIgKSB7XG5cdFx0XHRcdHRzID0gTWF0aC5hYnMoIHQgLSB5MiApIDw9IGQ7XG5cdFx0XHRcdGJzID0gTWF0aC5hYnMoIGIgLSB5MSApIDw9IGQ7XG5cdFx0XHRcdGxzID0gTWF0aC5hYnMoIGwgLSB4MiApIDw9IGQ7XG5cdFx0XHRcdHJzID0gTWF0aC5hYnMoIHIgLSB4MSApIDw9IGQ7XG5cdFx0XHRcdGlmICggdHMgKSB7XG5cdFx0XHRcdFx0dWkucG9zaXRpb24udG9wID0gaW5zdC5fY29udmVydFBvc2l0aW9uVG8oIFwicmVsYXRpdmVcIiwge1xuXHRcdFx0XHRcdFx0dG9wOiB0IC0gaW5zdC5oZWxwZXJQcm9wb3J0aW9ucy5oZWlnaHQsXG5cdFx0XHRcdFx0XHRsZWZ0OiAwXG5cdFx0XHRcdFx0fSApLnRvcDtcblx0XHRcdFx0fVxuXHRcdFx0XHRpZiAoIGJzICkge1xuXHRcdFx0XHRcdHVpLnBvc2l0aW9uLnRvcCA9IGluc3QuX2NvbnZlcnRQb3NpdGlvblRvKCBcInJlbGF0aXZlXCIsIHtcblx0XHRcdFx0XHRcdHRvcDogYixcblx0XHRcdFx0XHRcdGxlZnQ6IDBcblx0XHRcdFx0XHR9ICkudG9wO1xuXHRcdFx0XHR9XG5cdFx0XHRcdGlmICggbHMgKSB7XG5cdFx0XHRcdFx0dWkucG9zaXRpb24ubGVmdCA9IGluc3QuX2NvbnZlcnRQb3NpdGlvblRvKCBcInJlbGF0aXZlXCIsIHtcblx0XHRcdFx0XHRcdHRvcDogMCxcblx0XHRcdFx0XHRcdGxlZnQ6IGwgLSBpbnN0LmhlbHBlclByb3BvcnRpb25zLndpZHRoXG5cdFx0XHRcdFx0fSApLmxlZnQ7XG5cdFx0XHRcdH1cblx0XHRcdFx0aWYgKCBycyApIHtcblx0XHRcdFx0XHR1aS5wb3NpdGlvbi5sZWZ0ID0gaW5zdC5fY29udmVydFBvc2l0aW9uVG8oIFwicmVsYXRpdmVcIiwge1xuXHRcdFx0XHRcdFx0dG9wOiAwLFxuXHRcdFx0XHRcdFx0bGVmdDogclxuXHRcdFx0XHRcdH0gKS5sZWZ0O1xuXHRcdFx0XHR9XG5cdFx0XHR9XG5cblx0XHRcdGZpcnN0ID0gKCB0cyB8fCBicyB8fCBscyB8fCBycyApO1xuXG5cdFx0XHRpZiAoIG8uc25hcE1vZGUgIT09IFwib3V0ZXJcIiApIHtcblx0XHRcdFx0dHMgPSBNYXRoLmFicyggdCAtIHkxICkgPD0gZDtcblx0XHRcdFx0YnMgPSBNYXRoLmFicyggYiAtIHkyICkgPD0gZDtcblx0XHRcdFx0bHMgPSBNYXRoLmFicyggbCAtIHgxICkgPD0gZDtcblx0XHRcdFx0cnMgPSBNYXRoLmFicyggciAtIHgyICkgPD0gZDtcblx0XHRcdFx0aWYgKCB0cyApIHtcblx0XHRcdFx0XHR1aS5wb3NpdGlvbi50b3AgPSBpbnN0Ll9jb252ZXJ0UG9zaXRpb25UbyggXCJyZWxhdGl2ZVwiLCB7XG5cdFx0XHRcdFx0XHR0b3A6IHQsXG5cdFx0XHRcdFx0XHRsZWZ0OiAwXG5cdFx0XHRcdFx0fSApLnRvcDtcblx0XHRcdFx0fVxuXHRcdFx0XHRpZiAoIGJzICkge1xuXHRcdFx0XHRcdHVpLnBvc2l0aW9uLnRvcCA9IGluc3QuX2NvbnZlcnRQb3NpdGlvblRvKCBcInJlbGF0aXZlXCIsIHtcblx0XHRcdFx0XHRcdHRvcDogYiAtIGluc3QuaGVscGVyUHJvcG9ydGlvbnMuaGVpZ2h0LFxuXHRcdFx0XHRcdFx0bGVmdDogMFxuXHRcdFx0XHRcdH0gKS50b3A7XG5cdFx0XHRcdH1cblx0XHRcdFx0aWYgKCBscyApIHtcblx0XHRcdFx0XHR1aS5wb3NpdGlvbi5sZWZ0ID0gaW5zdC5fY29udmVydFBvc2l0aW9uVG8oIFwicmVsYXRpdmVcIiwge1xuXHRcdFx0XHRcdFx0dG9wOiAwLFxuXHRcdFx0XHRcdFx0bGVmdDogbFxuXHRcdFx0XHRcdH0gKS5sZWZ0O1xuXHRcdFx0XHR9XG5cdFx0XHRcdGlmICggcnMgKSB7XG5cdFx0XHRcdFx0dWkucG9zaXRpb24ubGVmdCA9IGluc3QuX2NvbnZlcnRQb3NpdGlvblRvKCBcInJlbGF0aXZlXCIsIHtcblx0XHRcdFx0XHRcdHRvcDogMCxcblx0XHRcdFx0XHRcdGxlZnQ6IHIgLSBpbnN0LmhlbHBlclByb3BvcnRpb25zLndpZHRoXG5cdFx0XHRcdFx0fSApLmxlZnQ7XG5cdFx0XHRcdH1cblx0XHRcdH1cblxuXHRcdFx0aWYgKCAhaW5zdC5zbmFwRWxlbWVudHNbIGkgXS5zbmFwcGluZyAmJiAoIHRzIHx8IGJzIHx8IGxzIHx8IHJzIHx8IGZpcnN0ICkgKSB7XG5cdFx0XHRcdCggaW5zdC5vcHRpb25zLnNuYXAuc25hcCAmJlxuXHRcdFx0XHRcdGluc3Qub3B0aW9ucy5zbmFwLnNuYXAuY2FsbChcblx0XHRcdFx0XHRcdGluc3QuZWxlbWVudCxcblx0XHRcdFx0XHRcdGV2ZW50LFxuXHRcdFx0XHRcdFx0JC5leHRlbmQoIGluc3QuX3VpSGFzaCgpLCB7XG5cdFx0XHRcdFx0XHRcdHNuYXBJdGVtOiBpbnN0LnNuYXBFbGVtZW50c1sgaSBdLml0ZW1cblx0XHRcdFx0XHRcdH0gKSApICk7XG5cdFx0XHR9XG5cdFx0XHRpbnN0LnNuYXBFbGVtZW50c1sgaSBdLnNuYXBwaW5nID0gKCB0cyB8fCBicyB8fCBscyB8fCBycyB8fCBmaXJzdCApO1xuXG5cdFx0fVxuXG5cdH1cbn0gKTtcblxuJC51aS5wbHVnaW4uYWRkKCBcImRyYWdnYWJsZVwiLCBcInN0YWNrXCIsIHtcblx0c3RhcnQ6IGZ1bmN0aW9uKCBldmVudCwgdWksIGluc3RhbmNlICkge1xuXHRcdHZhciBtaW4sXG5cdFx0XHRvID0gaW5zdGFuY2Uub3B0aW9ucyxcblx0XHRcdGdyb3VwID0gJC5tYWtlQXJyYXkoICQoIG8uc3RhY2sgKSApLnNvcnQoIGZ1bmN0aW9uKCBhLCBiICkge1xuXHRcdFx0XHRyZXR1cm4gKCBwYXJzZUludCggJCggYSApLmNzcyggXCJ6SW5kZXhcIiApLCAxMCApIHx8IDAgKSAtXG5cdFx0XHRcdFx0KCBwYXJzZUludCggJCggYiApLmNzcyggXCJ6SW5kZXhcIiApLCAxMCApIHx8IDAgKTtcblx0XHRcdH0gKTtcblxuXHRcdGlmICggIWdyb3VwLmxlbmd0aCApIHsgcmV0dXJuOyB9XG5cblx0XHRtaW4gPSBwYXJzZUludCggJCggZ3JvdXBbIDAgXSApLmNzcyggXCJ6SW5kZXhcIiApLCAxMCApIHx8IDA7XG5cdFx0JCggZ3JvdXAgKS5lYWNoKCBmdW5jdGlvbiggaSApIHtcblx0XHRcdCQoIHRoaXMgKS5jc3MoIFwiekluZGV4XCIsIG1pbiArIGkgKTtcblx0XHR9ICk7XG5cdFx0dGhpcy5jc3MoIFwiekluZGV4XCIsICggbWluICsgZ3JvdXAubGVuZ3RoICkgKTtcblx0fVxufSApO1xuXG4kLnVpLnBsdWdpbi5hZGQoIFwiZHJhZ2dhYmxlXCIsIFwiekluZGV4XCIsIHtcblx0c3RhcnQ6IGZ1bmN0aW9uKCBldmVudCwgdWksIGluc3RhbmNlICkge1xuXHRcdHZhciB0ID0gJCggdWkuaGVscGVyICksXG5cdFx0XHRvID0gaW5zdGFuY2Uub3B0aW9ucztcblxuXHRcdGlmICggdC5jc3MoIFwiekluZGV4XCIgKSApIHtcblx0XHRcdG8uX3pJbmRleCA9IHQuY3NzKCBcInpJbmRleFwiICk7XG5cdFx0fVxuXHRcdHQuY3NzKCBcInpJbmRleFwiLCBvLnpJbmRleCApO1xuXHR9LFxuXHRzdG9wOiBmdW5jdGlvbiggZXZlbnQsIHVpLCBpbnN0YW5jZSApIHtcblx0XHR2YXIgbyA9IGluc3RhbmNlLm9wdGlvbnM7XG5cblx0XHRpZiAoIG8uX3pJbmRleCApIHtcblx0XHRcdCQoIHVpLmhlbHBlciApLmNzcyggXCJ6SW5kZXhcIiwgby5fekluZGV4ICk7XG5cdFx0fVxuXHR9XG59ICk7XG5cbnJldHVybiAkLnVpLmRyYWdnYWJsZTtcblxufSApICk7XG4iLCIvKiFcbiAqIGpRdWVyeSBVSSBNZW51IDEuMTIuMFxuICogaHR0cDovL2pxdWVyeXVpLmNvbVxuICpcbiAqIENvcHlyaWdodCBqUXVlcnkgRm91bmRhdGlvbiBhbmQgb3RoZXIgY29udHJpYnV0b3JzXG4gKiBSZWxlYXNlZCB1bmRlciB0aGUgTUlUIGxpY2Vuc2UuXG4gKiBodHRwOi8vanF1ZXJ5Lm9yZy9saWNlbnNlXG4gKi9cblxuLy8+PmxhYmVsOiBNZW51XG4vLz4+Z3JvdXA6IFdpZGdldHNcbi8vPj5kZXNjcmlwdGlvbjogQ3JlYXRlcyBuZXN0YWJsZSBtZW51cy5cbi8vPj5kb2NzOiBodHRwOi8vYXBpLmpxdWVyeXVpLmNvbS9tZW51L1xuLy8+PmRlbW9zOiBodHRwOi8vanF1ZXJ5dWkuY29tL21lbnUvXG4vLz4+Y3NzLnN0cnVjdHVyZTogLi4vLi4vdGhlbWVzL2Jhc2UvY29yZS5jc3Ncbi8vPj5jc3Muc3RydWN0dXJlOiAuLi8uLi90aGVtZXMvYmFzZS9tZW51LmNzc1xuLy8+PmNzcy50aGVtZTogLi4vLi4vdGhlbWVzL2Jhc2UvdGhlbWUuY3NzXG5cbiggZnVuY3Rpb24oIGZhY3RvcnkgKSB7XG5cdGlmICggdHlwZW9mIGRlZmluZSA9PT0gXCJmdW5jdGlvblwiICYmIGRlZmluZS5hbWQgKSB7XG5cblx0XHQvLyBBTUQuIFJlZ2lzdGVyIGFzIGFuIGFub255bW91cyBtb2R1bGUuXG5cdFx0ZGVmaW5lKCBbXG5cdFx0XHRcImpxdWVyeVwiLFxuXHRcdFx0XCIuLi9rZXljb2RlXCIsXG5cdFx0XHRcIi4uL3Bvc2l0aW9uXCIsXG5cdFx0XHRcIi4uL3NhZmUtYWN0aXZlLWVsZW1lbnRcIixcblx0XHRcdFwiLi4vdW5pcXVlLWlkXCIsXG5cdFx0XHRcIi4uL3ZlcnNpb25cIixcblx0XHRcdFwiLi4vd2lkZ2V0XCJcblx0XHRdLCBmYWN0b3J5ICk7XG5cdH0gZWxzZSB7XG5cblx0XHQvLyBCcm93c2VyIGdsb2JhbHNcblx0XHRmYWN0b3J5KCBqUXVlcnkgKTtcblx0fVxufSggZnVuY3Rpb24oICQgKSB7XG5cbnJldHVybiAkLndpZGdldCggXCJ1aS5tZW51XCIsIHtcblx0dmVyc2lvbjogXCIxLjEyLjBcIixcblx0ZGVmYXVsdEVsZW1lbnQ6IFwiPHVsPlwiLFxuXHRkZWxheTogMzAwLFxuXHRvcHRpb25zOiB7XG5cdFx0aWNvbnM6IHtcblx0XHRcdHN1Ym1lbnU6IFwidWktaWNvbi1jYXJldC0xLWVcIlxuXHRcdH0sXG5cdFx0aXRlbXM6IFwiPiAqXCIsXG5cdFx0bWVudXM6IFwidWxcIixcblx0XHRwb3NpdGlvbjoge1xuXHRcdFx0bXk6IFwibGVmdCB0b3BcIixcblx0XHRcdGF0OiBcInJpZ2h0IHRvcFwiXG5cdFx0fSxcblx0XHRyb2xlOiBcIm1lbnVcIixcblxuXHRcdC8vIENhbGxiYWNrc1xuXHRcdGJsdXI6IG51bGwsXG5cdFx0Zm9jdXM6IG51bGwsXG5cdFx0c2VsZWN0OiBudWxsXG5cdH0sXG5cblx0X2NyZWF0ZTogZnVuY3Rpb24oKSB7XG5cdFx0dGhpcy5hY3RpdmVNZW51ID0gdGhpcy5lbGVtZW50O1xuXG5cdFx0Ly8gRmxhZyB1c2VkIHRvIHByZXZlbnQgZmlyaW5nIG9mIHRoZSBjbGljayBoYW5kbGVyXG5cdFx0Ly8gYXMgdGhlIGV2ZW50IGJ1YmJsZXMgdXAgdGhyb3VnaCBuZXN0ZWQgbWVudXNcblx0XHR0aGlzLm1vdXNlSGFuZGxlZCA9IGZhbHNlO1xuXHRcdHRoaXMuZWxlbWVudFxuXHRcdFx0LnVuaXF1ZUlkKClcblx0XHRcdC5hdHRyKCB7XG5cdFx0XHRcdHJvbGU6IHRoaXMub3B0aW9ucy5yb2xlLFxuXHRcdFx0XHR0YWJJbmRleDogMFxuXHRcdFx0fSApO1xuXG5cdFx0dGhpcy5fYWRkQ2xhc3MoIFwidWktbWVudVwiLCBcInVpLXdpZGdldCB1aS13aWRnZXQtY29udGVudFwiICk7XG5cdFx0dGhpcy5fb24oIHtcblxuXHRcdFx0Ly8gUHJldmVudCBmb2N1cyBmcm9tIHN0aWNraW5nIHRvIGxpbmtzIGluc2lkZSBtZW51IGFmdGVyIGNsaWNraW5nXG5cdFx0XHQvLyB0aGVtIChmb2N1cyBzaG91bGQgYWx3YXlzIHN0YXkgb24gVUwgZHVyaW5nIG5hdmlnYXRpb24pLlxuXHRcdFx0XCJtb3VzZWRvd24gLnVpLW1lbnUtaXRlbVwiOiBmdW5jdGlvbiggZXZlbnQgKSB7XG5cdFx0XHRcdGV2ZW50LnByZXZlbnREZWZhdWx0KCk7XG5cdFx0XHR9LFxuXHRcdFx0XCJjbGljayAudWktbWVudS1pdGVtXCI6IGZ1bmN0aW9uKCBldmVudCApIHtcblx0XHRcdFx0dmFyIHRhcmdldCA9ICQoIGV2ZW50LnRhcmdldCApO1xuXHRcdFx0XHR2YXIgYWN0aXZlID0gJCggJC51aS5zYWZlQWN0aXZlRWxlbWVudCggdGhpcy5kb2N1bWVudFsgMCBdICkgKTtcblx0XHRcdFx0aWYgKCAhdGhpcy5tb3VzZUhhbmRsZWQgJiYgdGFyZ2V0Lm5vdCggXCIudWktc3RhdGUtZGlzYWJsZWRcIiApLmxlbmd0aCApIHtcblx0XHRcdFx0XHR0aGlzLnNlbGVjdCggZXZlbnQgKTtcblxuXHRcdFx0XHRcdC8vIE9ubHkgc2V0IHRoZSBtb3VzZUhhbmRsZWQgZmxhZyBpZiB0aGUgZXZlbnQgd2lsbCBidWJibGUsIHNlZSAjOTQ2OS5cblx0XHRcdFx0XHRpZiAoICFldmVudC5pc1Byb3BhZ2F0aW9uU3RvcHBlZCgpICkge1xuXHRcdFx0XHRcdFx0dGhpcy5tb3VzZUhhbmRsZWQgPSB0cnVlO1xuXHRcdFx0XHRcdH1cblxuXHRcdFx0XHRcdC8vIE9wZW4gc3VibWVudSBvbiBjbGlja1xuXHRcdFx0XHRcdGlmICggdGFyZ2V0LmhhcyggXCIudWktbWVudVwiICkubGVuZ3RoICkge1xuXHRcdFx0XHRcdFx0dGhpcy5leHBhbmQoIGV2ZW50ICk7XG5cdFx0XHRcdFx0fSBlbHNlIGlmICggIXRoaXMuZWxlbWVudC5pcyggXCI6Zm9jdXNcIiApICYmXG5cdFx0XHRcdFx0XHRcdGFjdGl2ZS5jbG9zZXN0KCBcIi51aS1tZW51XCIgKS5sZW5ndGggKSB7XG5cblx0XHRcdFx0XHRcdC8vIFJlZGlyZWN0IGZvY3VzIHRvIHRoZSBtZW51XG5cdFx0XHRcdFx0XHR0aGlzLmVsZW1lbnQudHJpZ2dlciggXCJmb2N1c1wiLCBbIHRydWUgXSApO1xuXG5cdFx0XHRcdFx0XHQvLyBJZiB0aGUgYWN0aXZlIGl0ZW0gaXMgb24gdGhlIHRvcCBsZXZlbCwgbGV0IGl0IHN0YXkgYWN0aXZlLlxuXHRcdFx0XHRcdFx0Ly8gT3RoZXJ3aXNlLCBibHVyIHRoZSBhY3RpdmUgaXRlbSBzaW5jZSBpdCBpcyBubyBsb25nZXIgdmlzaWJsZS5cblx0XHRcdFx0XHRcdGlmICggdGhpcy5hY3RpdmUgJiYgdGhpcy5hY3RpdmUucGFyZW50cyggXCIudWktbWVudVwiICkubGVuZ3RoID09PSAxICkge1xuXHRcdFx0XHRcdFx0XHRjbGVhclRpbWVvdXQoIHRoaXMudGltZXIgKTtcblx0XHRcdFx0XHRcdH1cblx0XHRcdFx0XHR9XG5cdFx0XHRcdH1cblx0XHRcdH0sXG5cdFx0XHRcIm1vdXNlZW50ZXIgLnVpLW1lbnUtaXRlbVwiOiBmdW5jdGlvbiggZXZlbnQgKSB7XG5cblx0XHRcdFx0Ly8gSWdub3JlIG1vdXNlIGV2ZW50cyB3aGlsZSB0eXBlYWhlYWQgaXMgYWN0aXZlLCBzZWUgIzEwNDU4LlxuXHRcdFx0XHQvLyBQcmV2ZW50cyBmb2N1c2luZyB0aGUgd3JvbmcgaXRlbSB3aGVuIHR5cGVhaGVhZCBjYXVzZXMgYSBzY3JvbGwgd2hpbGUgdGhlIG1vdXNlXG5cdFx0XHRcdC8vIGlzIG92ZXIgYW4gaXRlbSBpbiB0aGUgbWVudVxuXHRcdFx0XHRpZiAoIHRoaXMucHJldmlvdXNGaWx0ZXIgKSB7XG5cdFx0XHRcdFx0cmV0dXJuO1xuXHRcdFx0XHR9XG5cblx0XHRcdFx0dmFyIGFjdHVhbFRhcmdldCA9ICQoIGV2ZW50LnRhcmdldCApLmNsb3Nlc3QoIFwiLnVpLW1lbnUtaXRlbVwiICksXG5cdFx0XHRcdFx0dGFyZ2V0ID0gJCggZXZlbnQuY3VycmVudFRhcmdldCApO1xuXG5cdFx0XHRcdC8vIElnbm9yZSBidWJibGVkIGV2ZW50cyBvbiBwYXJlbnQgaXRlbXMsIHNlZSAjMTE2NDFcblx0XHRcdFx0aWYgKCBhY3R1YWxUYXJnZXRbIDAgXSAhPT0gdGFyZ2V0WyAwIF0gKSB7XG5cdFx0XHRcdFx0cmV0dXJuO1xuXHRcdFx0XHR9XG5cblx0XHRcdFx0Ly8gUmVtb3ZlIHVpLXN0YXRlLWFjdGl2ZSBjbGFzcyBmcm9tIHNpYmxpbmdzIG9mIHRoZSBuZXdseSBmb2N1c2VkIG1lbnUgaXRlbVxuXHRcdFx0XHQvLyB0byBhdm9pZCBhIGp1bXAgY2F1c2VkIGJ5IGFkamFjZW50IGVsZW1lbnRzIGJvdGggaGF2aW5nIGEgY2xhc3Mgd2l0aCBhIGJvcmRlclxuXHRcdFx0XHR0aGlzLl9yZW1vdmVDbGFzcyggdGFyZ2V0LnNpYmxpbmdzKCkuY2hpbGRyZW4oIFwiLnVpLXN0YXRlLWFjdGl2ZVwiICksXG5cdFx0XHRcdFx0bnVsbCwgXCJ1aS1zdGF0ZS1hY3RpdmVcIiApO1xuXHRcdFx0XHR0aGlzLmZvY3VzKCBldmVudCwgdGFyZ2V0ICk7XG5cdFx0XHR9LFxuXHRcdFx0bW91c2VsZWF2ZTogXCJjb2xsYXBzZUFsbFwiLFxuXHRcdFx0XCJtb3VzZWxlYXZlIC51aS1tZW51XCI6IFwiY29sbGFwc2VBbGxcIixcblx0XHRcdGZvY3VzOiBmdW5jdGlvbiggZXZlbnQsIGtlZXBBY3RpdmVJdGVtICkge1xuXG5cdFx0XHRcdC8vIElmIHRoZXJlJ3MgYWxyZWFkeSBhbiBhY3RpdmUgaXRlbSwga2VlcCBpdCBhY3RpdmVcblx0XHRcdFx0Ly8gSWYgbm90LCBhY3RpdmF0ZSB0aGUgZmlyc3QgaXRlbVxuXHRcdFx0XHR2YXIgaXRlbSA9IHRoaXMuYWN0aXZlIHx8IHRoaXMuZWxlbWVudC5maW5kKCB0aGlzLm9wdGlvbnMuaXRlbXMgKS5lcSggMCApO1xuXG5cdFx0XHRcdGlmICggIWtlZXBBY3RpdmVJdGVtICkge1xuXHRcdFx0XHRcdHRoaXMuZm9jdXMoIGV2ZW50LCBpdGVtICk7XG5cdFx0XHRcdH1cblx0XHRcdH0sXG5cdFx0XHRibHVyOiBmdW5jdGlvbiggZXZlbnQgKSB7XG5cdFx0XHRcdHRoaXMuX2RlbGF5KCBmdW5jdGlvbigpIHtcblx0XHRcdFx0XHR2YXIgbm90Q29udGFpbmVkID0gISQuY29udGFpbnMoXG5cdFx0XHRcdFx0XHR0aGlzLmVsZW1lbnRbIDAgXSxcblx0XHRcdFx0XHRcdCQudWkuc2FmZUFjdGl2ZUVsZW1lbnQoIHRoaXMuZG9jdW1lbnRbIDAgXSApXG5cdFx0XHRcdFx0KTtcblx0XHRcdFx0XHRpZiAoIG5vdENvbnRhaW5lZCApIHtcblx0XHRcdFx0XHRcdHRoaXMuY29sbGFwc2VBbGwoIGV2ZW50ICk7XG5cdFx0XHRcdFx0fVxuXHRcdFx0XHR9ICk7XG5cdFx0XHR9LFxuXHRcdFx0a2V5ZG93bjogXCJfa2V5ZG93blwiXG5cdFx0fSApO1xuXG5cdFx0dGhpcy5yZWZyZXNoKCk7XG5cblx0XHQvLyBDbGlja3Mgb3V0c2lkZSBvZiBhIG1lbnUgY29sbGFwc2UgYW55IG9wZW4gbWVudXNcblx0XHR0aGlzLl9vbiggdGhpcy5kb2N1bWVudCwge1xuXHRcdFx0Y2xpY2s6IGZ1bmN0aW9uKCBldmVudCApIHtcblx0XHRcdFx0aWYgKCB0aGlzLl9jbG9zZU9uRG9jdW1lbnRDbGljayggZXZlbnQgKSApIHtcblx0XHRcdFx0XHR0aGlzLmNvbGxhcHNlQWxsKCBldmVudCApO1xuXHRcdFx0XHR9XG5cblx0XHRcdFx0Ly8gUmVzZXQgdGhlIG1vdXNlSGFuZGxlZCBmbGFnXG5cdFx0XHRcdHRoaXMubW91c2VIYW5kbGVkID0gZmFsc2U7XG5cdFx0XHR9XG5cdFx0fSApO1xuXHR9LFxuXG5cdF9kZXN0cm95OiBmdW5jdGlvbigpIHtcblx0XHR2YXIgaXRlbXMgPSB0aGlzLmVsZW1lbnQuZmluZCggXCIudWktbWVudS1pdGVtXCIgKVxuXHRcdFx0XHQucmVtb3ZlQXR0ciggXCJyb2xlIGFyaWEtZGlzYWJsZWRcIiApLFxuXHRcdFx0c3VibWVudXMgPSBpdGVtcy5jaGlsZHJlbiggXCIudWktbWVudS1pdGVtLXdyYXBwZXJcIiApXG5cdFx0XHRcdC5yZW1vdmVVbmlxdWVJZCgpXG5cdFx0XHRcdC5yZW1vdmVBdHRyKCBcInRhYkluZGV4IHJvbGUgYXJpYS1oYXNwb3B1cFwiICk7XG5cblx0XHQvLyBEZXN0cm95IChzdWIpbWVudXNcblx0XHR0aGlzLmVsZW1lbnRcblx0XHRcdC5yZW1vdmVBdHRyKCBcImFyaWEtYWN0aXZlZGVzY2VuZGFudFwiIClcblx0XHRcdC5maW5kKCBcIi51aS1tZW51XCIgKS5hZGRCYWNrKClcblx0XHRcdFx0LnJlbW92ZUF0dHIoIFwicm9sZSBhcmlhLWxhYmVsbGVkYnkgYXJpYS1leHBhbmRlZCBhcmlhLWhpZGRlbiBhcmlhLWRpc2FibGVkIFwiICtcblx0XHRcdFx0XHRcInRhYkluZGV4XCIgKVxuXHRcdFx0XHQucmVtb3ZlVW5pcXVlSWQoKVxuXHRcdFx0XHQuc2hvdygpO1xuXG5cdFx0c3VibWVudXMuY2hpbGRyZW4oKS5lYWNoKCBmdW5jdGlvbigpIHtcblx0XHRcdHZhciBlbGVtID0gJCggdGhpcyApO1xuXHRcdFx0aWYgKCBlbGVtLmRhdGEoIFwidWktbWVudS1zdWJtZW51LWNhcmV0XCIgKSApIHtcblx0XHRcdFx0ZWxlbS5yZW1vdmUoKTtcblx0XHRcdH1cblx0XHR9ICk7XG5cdH0sXG5cblx0X2tleWRvd246IGZ1bmN0aW9uKCBldmVudCApIHtcblx0XHR2YXIgbWF0Y2gsIHByZXYsIGNoYXJhY3Rlciwgc2tpcCxcblx0XHRcdHByZXZlbnREZWZhdWx0ID0gdHJ1ZTtcblxuXHRcdHN3aXRjaCAoIGV2ZW50LmtleUNvZGUgKSB7XG5cdFx0Y2FzZSAkLnVpLmtleUNvZGUuUEFHRV9VUDpcblx0XHRcdHRoaXMucHJldmlvdXNQYWdlKCBldmVudCApO1xuXHRcdFx0YnJlYWs7XG5cdFx0Y2FzZSAkLnVpLmtleUNvZGUuUEFHRV9ET1dOOlxuXHRcdFx0dGhpcy5uZXh0UGFnZSggZXZlbnQgKTtcblx0XHRcdGJyZWFrO1xuXHRcdGNhc2UgJC51aS5rZXlDb2RlLkhPTUU6XG5cdFx0XHR0aGlzLl9tb3ZlKCBcImZpcnN0XCIsIFwiZmlyc3RcIiwgZXZlbnQgKTtcblx0XHRcdGJyZWFrO1xuXHRcdGNhc2UgJC51aS5rZXlDb2RlLkVORDpcblx0XHRcdHRoaXMuX21vdmUoIFwibGFzdFwiLCBcImxhc3RcIiwgZXZlbnQgKTtcblx0XHRcdGJyZWFrO1xuXHRcdGNhc2UgJC51aS5rZXlDb2RlLlVQOlxuXHRcdFx0dGhpcy5wcmV2aW91cyggZXZlbnQgKTtcblx0XHRcdGJyZWFrO1xuXHRcdGNhc2UgJC51aS5rZXlDb2RlLkRPV046XG5cdFx0XHR0aGlzLm5leHQoIGV2ZW50ICk7XG5cdFx0XHRicmVhaztcblx0XHRjYXNlICQudWkua2V5Q29kZS5MRUZUOlxuXHRcdFx0dGhpcy5jb2xsYXBzZSggZXZlbnQgKTtcblx0XHRcdGJyZWFrO1xuXHRcdGNhc2UgJC51aS5rZXlDb2RlLlJJR0hUOlxuXHRcdFx0aWYgKCB0aGlzLmFjdGl2ZSAmJiAhdGhpcy5hY3RpdmUuaXMoIFwiLnVpLXN0YXRlLWRpc2FibGVkXCIgKSApIHtcblx0XHRcdFx0dGhpcy5leHBhbmQoIGV2ZW50ICk7XG5cdFx0XHR9XG5cdFx0XHRicmVhaztcblx0XHRjYXNlICQudWkua2V5Q29kZS5FTlRFUjpcblx0XHRjYXNlICQudWkua2V5Q29kZS5TUEFDRTpcblx0XHRcdHRoaXMuX2FjdGl2YXRlKCBldmVudCApO1xuXHRcdFx0YnJlYWs7XG5cdFx0Y2FzZSAkLnVpLmtleUNvZGUuRVNDQVBFOlxuXHRcdFx0dGhpcy5jb2xsYXBzZSggZXZlbnQgKTtcblx0XHRcdGJyZWFrO1xuXHRcdGRlZmF1bHQ6XG5cdFx0XHRwcmV2ZW50RGVmYXVsdCA9IGZhbHNlO1xuXHRcdFx0cHJldiA9IHRoaXMucHJldmlvdXNGaWx0ZXIgfHwgXCJcIjtcblx0XHRcdGNoYXJhY3RlciA9IFN0cmluZy5mcm9tQ2hhckNvZGUoIGV2ZW50LmtleUNvZGUgKTtcblx0XHRcdHNraXAgPSBmYWxzZTtcblxuXHRcdFx0Y2xlYXJUaW1lb3V0KCB0aGlzLmZpbHRlclRpbWVyICk7XG5cblx0XHRcdGlmICggY2hhcmFjdGVyID09PSBwcmV2ICkge1xuXHRcdFx0XHRza2lwID0gdHJ1ZTtcblx0XHRcdH0gZWxzZSB7XG5cdFx0XHRcdGNoYXJhY3RlciA9IHByZXYgKyBjaGFyYWN0ZXI7XG5cdFx0XHR9XG5cblx0XHRcdG1hdGNoID0gdGhpcy5fZmlsdGVyTWVudUl0ZW1zKCBjaGFyYWN0ZXIgKTtcblx0XHRcdG1hdGNoID0gc2tpcCAmJiBtYXRjaC5pbmRleCggdGhpcy5hY3RpdmUubmV4dCgpICkgIT09IC0xID9cblx0XHRcdFx0dGhpcy5hY3RpdmUubmV4dEFsbCggXCIudWktbWVudS1pdGVtXCIgKSA6XG5cdFx0XHRcdG1hdGNoO1xuXG5cdFx0XHQvLyBJZiBubyBtYXRjaGVzIG9uIHRoZSBjdXJyZW50IGZpbHRlciwgcmVzZXQgdG8gdGhlIGxhc3QgY2hhcmFjdGVyIHByZXNzZWRcblx0XHRcdC8vIHRvIG1vdmUgZG93biB0aGUgbWVudSB0byB0aGUgZmlyc3QgaXRlbSB0aGF0IHN0YXJ0cyB3aXRoIHRoYXQgY2hhcmFjdGVyXG5cdFx0XHRpZiAoICFtYXRjaC5sZW5ndGggKSB7XG5cdFx0XHRcdGNoYXJhY3RlciA9IFN0cmluZy5mcm9tQ2hhckNvZGUoIGV2ZW50LmtleUNvZGUgKTtcblx0XHRcdFx0bWF0Y2ggPSB0aGlzLl9maWx0ZXJNZW51SXRlbXMoIGNoYXJhY3RlciApO1xuXHRcdFx0fVxuXG5cdFx0XHRpZiAoIG1hdGNoLmxlbmd0aCApIHtcblx0XHRcdFx0dGhpcy5mb2N1cyggZXZlbnQsIG1hdGNoICk7XG5cdFx0XHRcdHRoaXMucHJldmlvdXNGaWx0ZXIgPSBjaGFyYWN0ZXI7XG5cdFx0XHRcdHRoaXMuZmlsdGVyVGltZXIgPSB0aGlzLl9kZWxheSggZnVuY3Rpb24oKSB7XG5cdFx0XHRcdFx0ZGVsZXRlIHRoaXMucHJldmlvdXNGaWx0ZXI7XG5cdFx0XHRcdH0sIDEwMDAgKTtcblx0XHRcdH0gZWxzZSB7XG5cdFx0XHRcdGRlbGV0ZSB0aGlzLnByZXZpb3VzRmlsdGVyO1xuXHRcdFx0fVxuXHRcdH1cblxuXHRcdGlmICggcHJldmVudERlZmF1bHQgKSB7XG5cdFx0XHRldmVudC5wcmV2ZW50RGVmYXVsdCgpO1xuXHRcdH1cblx0fSxcblxuXHRfYWN0aXZhdGU6IGZ1bmN0aW9uKCBldmVudCApIHtcblx0XHRpZiAoIHRoaXMuYWN0aXZlICYmICF0aGlzLmFjdGl2ZS5pcyggXCIudWktc3RhdGUtZGlzYWJsZWRcIiApICkge1xuXHRcdFx0aWYgKCB0aGlzLmFjdGl2ZS5jaGlsZHJlbiggXCJbYXJpYS1oYXNwb3B1cD0ndHJ1ZSddXCIgKS5sZW5ndGggKSB7XG5cdFx0XHRcdHRoaXMuZXhwYW5kKCBldmVudCApO1xuXHRcdFx0fSBlbHNlIHtcblx0XHRcdFx0dGhpcy5zZWxlY3QoIGV2ZW50ICk7XG5cdFx0XHR9XG5cdFx0fVxuXHR9LFxuXG5cdHJlZnJlc2g6IGZ1bmN0aW9uKCkge1xuXHRcdHZhciBtZW51cywgaXRlbXMsIG5ld1N1Ym1lbnVzLCBuZXdJdGVtcywgbmV3V3JhcHBlcnMsXG5cdFx0XHR0aGF0ID0gdGhpcyxcblx0XHRcdGljb24gPSB0aGlzLm9wdGlvbnMuaWNvbnMuc3VibWVudSxcblx0XHRcdHN1Ym1lbnVzID0gdGhpcy5lbGVtZW50LmZpbmQoIHRoaXMub3B0aW9ucy5tZW51cyApO1xuXG5cdFx0dGhpcy5fdG9nZ2xlQ2xhc3MoIFwidWktbWVudS1pY29uc1wiLCBudWxsLCAhIXRoaXMuZWxlbWVudC5maW5kKCBcIi51aS1pY29uXCIgKS5sZW5ndGggKTtcblxuXHRcdC8vIEluaXRpYWxpemUgbmVzdGVkIG1lbnVzXG5cdFx0bmV3U3VibWVudXMgPSBzdWJtZW51cy5maWx0ZXIoIFwiOm5vdCgudWktbWVudSlcIiApXG5cdFx0XHQuaGlkZSgpXG5cdFx0XHQuYXR0cigge1xuXHRcdFx0XHRyb2xlOiB0aGlzLm9wdGlvbnMucm9sZSxcblx0XHRcdFx0XCJhcmlhLWhpZGRlblwiOiBcInRydWVcIixcblx0XHRcdFx0XCJhcmlhLWV4cGFuZGVkXCI6IFwiZmFsc2VcIlxuXHRcdFx0fSApXG5cdFx0XHQuZWFjaCggZnVuY3Rpb24oKSB7XG5cdFx0XHRcdHZhciBtZW51ID0gJCggdGhpcyApLFxuXHRcdFx0XHRcdGl0ZW0gPSBtZW51LnByZXYoKSxcblx0XHRcdFx0XHRzdWJtZW51Q2FyZXQgPSAkKCBcIjxzcGFuPlwiICkuZGF0YSggXCJ1aS1tZW51LXN1Ym1lbnUtY2FyZXRcIiwgdHJ1ZSApO1xuXG5cdFx0XHRcdHRoYXQuX2FkZENsYXNzKCBzdWJtZW51Q2FyZXQsIFwidWktbWVudS1pY29uXCIsIFwidWktaWNvbiBcIiArIGljb24gKTtcblx0XHRcdFx0aXRlbVxuXHRcdFx0XHRcdC5hdHRyKCBcImFyaWEtaGFzcG9wdXBcIiwgXCJ0cnVlXCIgKVxuXHRcdFx0XHRcdC5wcmVwZW5kKCBzdWJtZW51Q2FyZXQgKTtcblx0XHRcdFx0bWVudS5hdHRyKCBcImFyaWEtbGFiZWxsZWRieVwiLCBpdGVtLmF0dHIoIFwiaWRcIiApICk7XG5cdFx0XHR9ICk7XG5cblx0XHR0aGlzLl9hZGRDbGFzcyggbmV3U3VibWVudXMsIFwidWktbWVudVwiLCBcInVpLXdpZGdldCB1aS13aWRnZXQtY29udGVudCB1aS1mcm9udFwiICk7XG5cblx0XHRtZW51cyA9IHN1Ym1lbnVzLmFkZCggdGhpcy5lbGVtZW50ICk7XG5cdFx0aXRlbXMgPSBtZW51cy5maW5kKCB0aGlzLm9wdGlvbnMuaXRlbXMgKTtcblxuXHRcdC8vIEluaXRpYWxpemUgbWVudS1pdGVtcyBjb250YWluaW5nIHNwYWNlcyBhbmQvb3IgZGFzaGVzIG9ubHkgYXMgZGl2aWRlcnNcblx0XHRpdGVtcy5ub3QoIFwiLnVpLW1lbnUtaXRlbVwiICkuZWFjaCggZnVuY3Rpb24oKSB7XG5cdFx0XHR2YXIgaXRlbSA9ICQoIHRoaXMgKTtcblx0XHRcdGlmICggdGhhdC5faXNEaXZpZGVyKCBpdGVtICkgKSB7XG5cdFx0XHRcdHRoYXQuX2FkZENsYXNzKCBpdGVtLCBcInVpLW1lbnUtZGl2aWRlclwiLCBcInVpLXdpZGdldC1jb250ZW50XCIgKTtcblx0XHRcdH1cblx0XHR9ICk7XG5cblx0XHQvLyBEb24ndCByZWZyZXNoIGxpc3QgaXRlbXMgdGhhdCBhcmUgYWxyZWFkeSBhZGFwdGVkXG5cdFx0bmV3SXRlbXMgPSBpdGVtcy5ub3QoIFwiLnVpLW1lbnUtaXRlbSwgLnVpLW1lbnUtZGl2aWRlclwiICk7XG5cdFx0bmV3V3JhcHBlcnMgPSBuZXdJdGVtcy5jaGlsZHJlbigpXG5cdFx0XHQubm90KCBcIi51aS1tZW51XCIgKVxuXHRcdFx0XHQudW5pcXVlSWQoKVxuXHRcdFx0XHQuYXR0cigge1xuXHRcdFx0XHRcdHRhYkluZGV4OiAtMSxcblx0XHRcdFx0XHRyb2xlOiB0aGlzLl9pdGVtUm9sZSgpXG5cdFx0XHRcdH0gKTtcblx0XHR0aGlzLl9hZGRDbGFzcyggbmV3SXRlbXMsIFwidWktbWVudS1pdGVtXCIgKVxuXHRcdFx0Ll9hZGRDbGFzcyggbmV3V3JhcHBlcnMsIFwidWktbWVudS1pdGVtLXdyYXBwZXJcIiApO1xuXG5cdFx0Ly8gQWRkIGFyaWEtZGlzYWJsZWQgYXR0cmlidXRlIHRvIGFueSBkaXNhYmxlZCBtZW51IGl0ZW1cblx0XHRpdGVtcy5maWx0ZXIoIFwiLnVpLXN0YXRlLWRpc2FibGVkXCIgKS5hdHRyKCBcImFyaWEtZGlzYWJsZWRcIiwgXCJ0cnVlXCIgKTtcblxuXHRcdC8vIElmIHRoZSBhY3RpdmUgaXRlbSBoYXMgYmVlbiByZW1vdmVkLCBibHVyIHRoZSBtZW51XG5cdFx0aWYgKCB0aGlzLmFjdGl2ZSAmJiAhJC5jb250YWlucyggdGhpcy5lbGVtZW50WyAwIF0sIHRoaXMuYWN0aXZlWyAwIF0gKSApIHtcblx0XHRcdHRoaXMuYmx1cigpO1xuXHRcdH1cblx0fSxcblxuXHRfaXRlbVJvbGU6IGZ1bmN0aW9uKCkge1xuXHRcdHJldHVybiB7XG5cdFx0XHRtZW51OiBcIm1lbnVpdGVtXCIsXG5cdFx0XHRsaXN0Ym94OiBcIm9wdGlvblwiXG5cdFx0fVsgdGhpcy5vcHRpb25zLnJvbGUgXTtcblx0fSxcblxuXHRfc2V0T3B0aW9uOiBmdW5jdGlvbigga2V5LCB2YWx1ZSApIHtcblx0XHRpZiAoIGtleSA9PT0gXCJpY29uc1wiICkge1xuXHRcdFx0dmFyIGljb25zID0gdGhpcy5lbGVtZW50LmZpbmQoIFwiLnVpLW1lbnUtaWNvblwiICk7XG5cdFx0XHR0aGlzLl9yZW1vdmVDbGFzcyggaWNvbnMsIG51bGwsIHRoaXMub3B0aW9ucy5pY29ucy5zdWJtZW51IClcblx0XHRcdFx0Ll9hZGRDbGFzcyggaWNvbnMsIG51bGwsIHZhbHVlLnN1Ym1lbnUgKTtcblx0XHR9XG5cdFx0dGhpcy5fc3VwZXIoIGtleSwgdmFsdWUgKTtcblx0fSxcblxuXHRfc2V0T3B0aW9uRGlzYWJsZWQ6IGZ1bmN0aW9uKCB2YWx1ZSApIHtcblx0XHR0aGlzLl9zdXBlciggdmFsdWUgKTtcblxuXHRcdHRoaXMuZWxlbWVudC5hdHRyKCBcImFyaWEtZGlzYWJsZWRcIiwgU3RyaW5nKCB2YWx1ZSApICk7XG5cdFx0dGhpcy5fdG9nZ2xlQ2xhc3MoIG51bGwsIFwidWktc3RhdGUtZGlzYWJsZWRcIiwgISF2YWx1ZSApO1xuXHR9LFxuXG5cdGZvY3VzOiBmdW5jdGlvbiggZXZlbnQsIGl0ZW0gKSB7XG5cdFx0dmFyIG5lc3RlZCwgZm9jdXNlZCwgYWN0aXZlUGFyZW50O1xuXHRcdHRoaXMuYmx1ciggZXZlbnQsIGV2ZW50ICYmIGV2ZW50LnR5cGUgPT09IFwiZm9jdXNcIiApO1xuXG5cdFx0dGhpcy5fc2Nyb2xsSW50b1ZpZXcoIGl0ZW0gKTtcblxuXHRcdHRoaXMuYWN0aXZlID0gaXRlbS5maXJzdCgpO1xuXG5cdFx0Zm9jdXNlZCA9IHRoaXMuYWN0aXZlLmNoaWxkcmVuKCBcIi51aS1tZW51LWl0ZW0td3JhcHBlclwiICk7XG5cdFx0dGhpcy5fYWRkQ2xhc3MoIGZvY3VzZWQsIG51bGwsIFwidWktc3RhdGUtYWN0aXZlXCIgKTtcblxuXHRcdC8vIE9ubHkgdXBkYXRlIGFyaWEtYWN0aXZlZGVzY2VuZGFudCBpZiB0aGVyZSdzIGEgcm9sZVxuXHRcdC8vIG90aGVyd2lzZSB3ZSBhc3N1bWUgZm9jdXMgaXMgbWFuYWdlZCBlbHNld2hlcmVcblx0XHRpZiAoIHRoaXMub3B0aW9ucy5yb2xlICkge1xuXHRcdFx0dGhpcy5lbGVtZW50LmF0dHIoIFwiYXJpYS1hY3RpdmVkZXNjZW5kYW50XCIsIGZvY3VzZWQuYXR0ciggXCJpZFwiICkgKTtcblx0XHR9XG5cblx0XHQvLyBIaWdobGlnaHQgYWN0aXZlIHBhcmVudCBtZW51IGl0ZW0sIGlmIGFueVxuXHRcdGFjdGl2ZVBhcmVudCA9IHRoaXMuYWN0aXZlXG5cdFx0XHQucGFyZW50KClcblx0XHRcdFx0LmNsb3Nlc3QoIFwiLnVpLW1lbnUtaXRlbVwiIClcblx0XHRcdFx0XHQuY2hpbGRyZW4oIFwiLnVpLW1lbnUtaXRlbS13cmFwcGVyXCIgKTtcblx0XHR0aGlzLl9hZGRDbGFzcyggYWN0aXZlUGFyZW50LCBudWxsLCBcInVpLXN0YXRlLWFjdGl2ZVwiICk7XG5cblx0XHRpZiAoIGV2ZW50ICYmIGV2ZW50LnR5cGUgPT09IFwia2V5ZG93blwiICkge1xuXHRcdFx0dGhpcy5fY2xvc2UoKTtcblx0XHR9IGVsc2Uge1xuXHRcdFx0dGhpcy50aW1lciA9IHRoaXMuX2RlbGF5KCBmdW5jdGlvbigpIHtcblx0XHRcdFx0dGhpcy5fY2xvc2UoKTtcblx0XHRcdH0sIHRoaXMuZGVsYXkgKTtcblx0XHR9XG5cblx0XHRuZXN0ZWQgPSBpdGVtLmNoaWxkcmVuKCBcIi51aS1tZW51XCIgKTtcblx0XHRpZiAoIG5lc3RlZC5sZW5ndGggJiYgZXZlbnQgJiYgKCAvXm1vdXNlLy50ZXN0KCBldmVudC50eXBlICkgKSApIHtcblx0XHRcdHRoaXMuX3N0YXJ0T3BlbmluZyggbmVzdGVkICk7XG5cdFx0fVxuXHRcdHRoaXMuYWN0aXZlTWVudSA9IGl0ZW0ucGFyZW50KCk7XG5cblx0XHR0aGlzLl90cmlnZ2VyKCBcImZvY3VzXCIsIGV2ZW50LCB7IGl0ZW06IGl0ZW0gfSApO1xuXHR9LFxuXG5cdF9zY3JvbGxJbnRvVmlldzogZnVuY3Rpb24oIGl0ZW0gKSB7XG5cdFx0dmFyIGJvcmRlclRvcCwgcGFkZGluZ1RvcCwgb2Zmc2V0LCBzY3JvbGwsIGVsZW1lbnRIZWlnaHQsIGl0ZW1IZWlnaHQ7XG5cdFx0aWYgKCB0aGlzLl9oYXNTY3JvbGwoKSApIHtcblx0XHRcdGJvcmRlclRvcCA9IHBhcnNlRmxvYXQoICQuY3NzKCB0aGlzLmFjdGl2ZU1lbnVbIDAgXSwgXCJib3JkZXJUb3BXaWR0aFwiICkgKSB8fCAwO1xuXHRcdFx0cGFkZGluZ1RvcCA9IHBhcnNlRmxvYXQoICQuY3NzKCB0aGlzLmFjdGl2ZU1lbnVbIDAgXSwgXCJwYWRkaW5nVG9wXCIgKSApIHx8IDA7XG5cdFx0XHRvZmZzZXQgPSBpdGVtLm9mZnNldCgpLnRvcCAtIHRoaXMuYWN0aXZlTWVudS5vZmZzZXQoKS50b3AgLSBib3JkZXJUb3AgLSBwYWRkaW5nVG9wO1xuXHRcdFx0c2Nyb2xsID0gdGhpcy5hY3RpdmVNZW51LnNjcm9sbFRvcCgpO1xuXHRcdFx0ZWxlbWVudEhlaWdodCA9IHRoaXMuYWN0aXZlTWVudS5oZWlnaHQoKTtcblx0XHRcdGl0ZW1IZWlnaHQgPSBpdGVtLm91dGVySGVpZ2h0KCk7XG5cblx0XHRcdGlmICggb2Zmc2V0IDwgMCApIHtcblx0XHRcdFx0dGhpcy5hY3RpdmVNZW51LnNjcm9sbFRvcCggc2Nyb2xsICsgb2Zmc2V0ICk7XG5cdFx0XHR9IGVsc2UgaWYgKCBvZmZzZXQgKyBpdGVtSGVpZ2h0ID4gZWxlbWVudEhlaWdodCApIHtcblx0XHRcdFx0dGhpcy5hY3RpdmVNZW51LnNjcm9sbFRvcCggc2Nyb2xsICsgb2Zmc2V0IC0gZWxlbWVudEhlaWdodCArIGl0ZW1IZWlnaHQgKTtcblx0XHRcdH1cblx0XHR9XG5cdH0sXG5cblx0Ymx1cjogZnVuY3Rpb24oIGV2ZW50LCBmcm9tRm9jdXMgKSB7XG5cdFx0aWYgKCAhZnJvbUZvY3VzICkge1xuXHRcdFx0Y2xlYXJUaW1lb3V0KCB0aGlzLnRpbWVyICk7XG5cdFx0fVxuXG5cdFx0aWYgKCAhdGhpcy5hY3RpdmUgKSB7XG5cdFx0XHRyZXR1cm47XG5cdFx0fVxuXG5cdFx0dGhpcy5fcmVtb3ZlQ2xhc3MoIHRoaXMuYWN0aXZlLmNoaWxkcmVuKCBcIi51aS1tZW51LWl0ZW0td3JhcHBlclwiICksXG5cdFx0XHRudWxsLCBcInVpLXN0YXRlLWFjdGl2ZVwiICk7XG5cblx0XHR0aGlzLl90cmlnZ2VyKCBcImJsdXJcIiwgZXZlbnQsIHsgaXRlbTogdGhpcy5hY3RpdmUgfSApO1xuXHRcdHRoaXMuYWN0aXZlID0gbnVsbDtcblx0fSxcblxuXHRfc3RhcnRPcGVuaW5nOiBmdW5jdGlvbiggc3VibWVudSApIHtcblx0XHRjbGVhclRpbWVvdXQoIHRoaXMudGltZXIgKTtcblxuXHRcdC8vIERvbid0IG9wZW4gaWYgYWxyZWFkeSBvcGVuIGZpeGVzIGEgRmlyZWZveCBidWcgdGhhdCBjYXVzZWQgYSAuNSBwaXhlbFxuXHRcdC8vIHNoaWZ0IGluIHRoZSBzdWJtZW51IHBvc2l0aW9uIHdoZW4gbW91c2luZyBvdmVyIHRoZSBjYXJldCBpY29uXG5cdFx0aWYgKCBzdWJtZW51LmF0dHIoIFwiYXJpYS1oaWRkZW5cIiApICE9PSBcInRydWVcIiApIHtcblx0XHRcdHJldHVybjtcblx0XHR9XG5cblx0XHR0aGlzLnRpbWVyID0gdGhpcy5fZGVsYXkoIGZ1bmN0aW9uKCkge1xuXHRcdFx0dGhpcy5fY2xvc2UoKTtcblx0XHRcdHRoaXMuX29wZW4oIHN1Ym1lbnUgKTtcblx0XHR9LCB0aGlzLmRlbGF5ICk7XG5cdH0sXG5cblx0X29wZW46IGZ1bmN0aW9uKCBzdWJtZW51ICkge1xuXHRcdHZhciBwb3NpdGlvbiA9ICQuZXh0ZW5kKCB7XG5cdFx0XHRvZjogdGhpcy5hY3RpdmVcblx0XHR9LCB0aGlzLm9wdGlvbnMucG9zaXRpb24gKTtcblxuXHRcdGNsZWFyVGltZW91dCggdGhpcy50aW1lciApO1xuXHRcdHRoaXMuZWxlbWVudC5maW5kKCBcIi51aS1tZW51XCIgKS5ub3QoIHN1Ym1lbnUucGFyZW50cyggXCIudWktbWVudVwiICkgKVxuXHRcdFx0LmhpZGUoKVxuXHRcdFx0LmF0dHIoIFwiYXJpYS1oaWRkZW5cIiwgXCJ0cnVlXCIgKTtcblxuXHRcdHN1Ym1lbnVcblx0XHRcdC5zaG93KClcblx0XHRcdC5yZW1vdmVBdHRyKCBcImFyaWEtaGlkZGVuXCIgKVxuXHRcdFx0LmF0dHIoIFwiYXJpYS1leHBhbmRlZFwiLCBcInRydWVcIiApXG5cdFx0XHQucG9zaXRpb24oIHBvc2l0aW9uICk7XG5cdH0sXG5cblx0Y29sbGFwc2VBbGw6IGZ1bmN0aW9uKCBldmVudCwgYWxsICkge1xuXHRcdGNsZWFyVGltZW91dCggdGhpcy50aW1lciApO1xuXHRcdHRoaXMudGltZXIgPSB0aGlzLl9kZWxheSggZnVuY3Rpb24oKSB7XG5cblx0XHRcdC8vIElmIHdlIHdlcmUgcGFzc2VkIGFuIGV2ZW50LCBsb29rIGZvciB0aGUgc3VibWVudSB0aGF0IGNvbnRhaW5zIHRoZSBldmVudFxuXHRcdFx0dmFyIGN1cnJlbnRNZW51ID0gYWxsID8gdGhpcy5lbGVtZW50IDpcblx0XHRcdFx0JCggZXZlbnQgJiYgZXZlbnQudGFyZ2V0ICkuY2xvc2VzdCggdGhpcy5lbGVtZW50LmZpbmQoIFwiLnVpLW1lbnVcIiApICk7XG5cblx0XHRcdC8vIElmIHdlIGZvdW5kIG5vIHZhbGlkIHN1Ym1lbnUgYW5jZXN0b3IsIHVzZSB0aGUgbWFpbiBtZW51IHRvIGNsb3NlIGFsbFxuXHRcdFx0Ly8gc3ViIG1lbnVzIGFueXdheVxuXHRcdFx0aWYgKCAhY3VycmVudE1lbnUubGVuZ3RoICkge1xuXHRcdFx0XHRjdXJyZW50TWVudSA9IHRoaXMuZWxlbWVudDtcblx0XHRcdH1cblxuXHRcdFx0dGhpcy5fY2xvc2UoIGN1cnJlbnRNZW51ICk7XG5cblx0XHRcdHRoaXMuYmx1ciggZXZlbnQgKTtcblxuXHRcdFx0Ly8gV29yayBhcm91bmQgYWN0aXZlIGl0ZW0gc3RheWluZyBhY3RpdmUgYWZ0ZXIgbWVudSBpcyBibHVycmVkXG5cdFx0XHR0aGlzLl9yZW1vdmVDbGFzcyggY3VycmVudE1lbnUuZmluZCggXCIudWktc3RhdGUtYWN0aXZlXCIgKSwgbnVsbCwgXCJ1aS1zdGF0ZS1hY3RpdmVcIiApO1xuXG5cdFx0XHR0aGlzLmFjdGl2ZU1lbnUgPSBjdXJyZW50TWVudTtcblx0XHR9LCB0aGlzLmRlbGF5ICk7XG5cdH0sXG5cblx0Ly8gV2l0aCBubyBhcmd1bWVudHMsIGNsb3NlcyB0aGUgY3VycmVudGx5IGFjdGl2ZSBtZW51IC0gaWYgbm90aGluZyBpcyBhY3RpdmVcblx0Ly8gaXQgY2xvc2VzIGFsbCBtZW51cy4gIElmIHBhc3NlZCBhbiBhcmd1bWVudCwgaXQgd2lsbCBzZWFyY2ggZm9yIG1lbnVzIEJFTE9XXG5cdF9jbG9zZTogZnVuY3Rpb24oIHN0YXJ0TWVudSApIHtcblx0XHRpZiAoICFzdGFydE1lbnUgKSB7XG5cdFx0XHRzdGFydE1lbnUgPSB0aGlzLmFjdGl2ZSA/IHRoaXMuYWN0aXZlLnBhcmVudCgpIDogdGhpcy5lbGVtZW50O1xuXHRcdH1cblxuXHRcdHN0YXJ0TWVudS5maW5kKCBcIi51aS1tZW51XCIgKVxuXHRcdFx0LmhpZGUoKVxuXHRcdFx0LmF0dHIoIFwiYXJpYS1oaWRkZW5cIiwgXCJ0cnVlXCIgKVxuXHRcdFx0LmF0dHIoIFwiYXJpYS1leHBhbmRlZFwiLCBcImZhbHNlXCIgKTtcblx0fSxcblxuXHRfY2xvc2VPbkRvY3VtZW50Q2xpY2s6IGZ1bmN0aW9uKCBldmVudCApIHtcblx0XHRyZXR1cm4gISQoIGV2ZW50LnRhcmdldCApLmNsb3Nlc3QoIFwiLnVpLW1lbnVcIiApLmxlbmd0aDtcblx0fSxcblxuXHRfaXNEaXZpZGVyOiBmdW5jdGlvbiggaXRlbSApIHtcblxuXHRcdC8vIE1hdGNoIGh5cGhlbiwgZW0gZGFzaCwgZW4gZGFzaFxuXHRcdHJldHVybiAhL1teXFwtXFx1MjAxNFxcdTIwMTNcXHNdLy50ZXN0KCBpdGVtLnRleHQoKSApO1xuXHR9LFxuXG5cdGNvbGxhcHNlOiBmdW5jdGlvbiggZXZlbnQgKSB7XG5cdFx0dmFyIG5ld0l0ZW0gPSB0aGlzLmFjdGl2ZSAmJlxuXHRcdFx0dGhpcy5hY3RpdmUucGFyZW50KCkuY2xvc2VzdCggXCIudWktbWVudS1pdGVtXCIsIHRoaXMuZWxlbWVudCApO1xuXHRcdGlmICggbmV3SXRlbSAmJiBuZXdJdGVtLmxlbmd0aCApIHtcblx0XHRcdHRoaXMuX2Nsb3NlKCk7XG5cdFx0XHR0aGlzLmZvY3VzKCBldmVudCwgbmV3SXRlbSApO1xuXHRcdH1cblx0fSxcblxuXHRleHBhbmQ6IGZ1bmN0aW9uKCBldmVudCApIHtcblx0XHR2YXIgbmV3SXRlbSA9IHRoaXMuYWN0aXZlICYmXG5cdFx0XHR0aGlzLmFjdGl2ZVxuXHRcdFx0XHQuY2hpbGRyZW4oIFwiLnVpLW1lbnUgXCIgKVxuXHRcdFx0XHRcdC5maW5kKCB0aGlzLm9wdGlvbnMuaXRlbXMgKVxuXHRcdFx0XHRcdFx0LmZpcnN0KCk7XG5cblx0XHRpZiAoIG5ld0l0ZW0gJiYgbmV3SXRlbS5sZW5ndGggKSB7XG5cdFx0XHR0aGlzLl9vcGVuKCBuZXdJdGVtLnBhcmVudCgpICk7XG5cblx0XHRcdC8vIERlbGF5IHNvIEZpcmVmb3ggd2lsbCBub3QgaGlkZSBhY3RpdmVkZXNjZW5kYW50IGNoYW5nZSBpbiBleHBhbmRpbmcgc3VibWVudSBmcm9tIEFUXG5cdFx0XHR0aGlzLl9kZWxheSggZnVuY3Rpb24oKSB7XG5cdFx0XHRcdHRoaXMuZm9jdXMoIGV2ZW50LCBuZXdJdGVtICk7XG5cdFx0XHR9ICk7XG5cdFx0fVxuXHR9LFxuXG5cdG5leHQ6IGZ1bmN0aW9uKCBldmVudCApIHtcblx0XHR0aGlzLl9tb3ZlKCBcIm5leHRcIiwgXCJmaXJzdFwiLCBldmVudCApO1xuXHR9LFxuXG5cdHByZXZpb3VzOiBmdW5jdGlvbiggZXZlbnQgKSB7XG5cdFx0dGhpcy5fbW92ZSggXCJwcmV2XCIsIFwibGFzdFwiLCBldmVudCApO1xuXHR9LFxuXG5cdGlzRmlyc3RJdGVtOiBmdW5jdGlvbigpIHtcblx0XHRyZXR1cm4gdGhpcy5hY3RpdmUgJiYgIXRoaXMuYWN0aXZlLnByZXZBbGwoIFwiLnVpLW1lbnUtaXRlbVwiICkubGVuZ3RoO1xuXHR9LFxuXG5cdGlzTGFzdEl0ZW06IGZ1bmN0aW9uKCkge1xuXHRcdHJldHVybiB0aGlzLmFjdGl2ZSAmJiAhdGhpcy5hY3RpdmUubmV4dEFsbCggXCIudWktbWVudS1pdGVtXCIgKS5sZW5ndGg7XG5cdH0sXG5cblx0X21vdmU6IGZ1bmN0aW9uKCBkaXJlY3Rpb24sIGZpbHRlciwgZXZlbnQgKSB7XG5cdFx0dmFyIG5leHQ7XG5cdFx0aWYgKCB0aGlzLmFjdGl2ZSApIHtcblx0XHRcdGlmICggZGlyZWN0aW9uID09PSBcImZpcnN0XCIgfHwgZGlyZWN0aW9uID09PSBcImxhc3RcIiApIHtcblx0XHRcdFx0bmV4dCA9IHRoaXMuYWN0aXZlXG5cdFx0XHRcdFx0WyBkaXJlY3Rpb24gPT09IFwiZmlyc3RcIiA/IFwicHJldkFsbFwiIDogXCJuZXh0QWxsXCIgXSggXCIudWktbWVudS1pdGVtXCIgKVxuXHRcdFx0XHRcdC5lcSggLTEgKTtcblx0XHRcdH0gZWxzZSB7XG5cdFx0XHRcdG5leHQgPSB0aGlzLmFjdGl2ZVxuXHRcdFx0XHRcdFsgZGlyZWN0aW9uICsgXCJBbGxcIiBdKCBcIi51aS1tZW51LWl0ZW1cIiApXG5cdFx0XHRcdFx0LmVxKCAwICk7XG5cdFx0XHR9XG5cdFx0fVxuXHRcdGlmICggIW5leHQgfHwgIW5leHQubGVuZ3RoIHx8ICF0aGlzLmFjdGl2ZSApIHtcblx0XHRcdG5leHQgPSB0aGlzLmFjdGl2ZU1lbnUuZmluZCggdGhpcy5vcHRpb25zLml0ZW1zIClbIGZpbHRlciBdKCk7XG5cdFx0fVxuXG5cdFx0dGhpcy5mb2N1cyggZXZlbnQsIG5leHQgKTtcblx0fSxcblxuXHRuZXh0UGFnZTogZnVuY3Rpb24oIGV2ZW50ICkge1xuXHRcdHZhciBpdGVtLCBiYXNlLCBoZWlnaHQ7XG5cblx0XHRpZiAoICF0aGlzLmFjdGl2ZSApIHtcblx0XHRcdHRoaXMubmV4dCggZXZlbnQgKTtcblx0XHRcdHJldHVybjtcblx0XHR9XG5cdFx0aWYgKCB0aGlzLmlzTGFzdEl0ZW0oKSApIHtcblx0XHRcdHJldHVybjtcblx0XHR9XG5cdFx0aWYgKCB0aGlzLl9oYXNTY3JvbGwoKSApIHtcblx0XHRcdGJhc2UgPSB0aGlzLmFjdGl2ZS5vZmZzZXQoKS50b3A7XG5cdFx0XHRoZWlnaHQgPSB0aGlzLmVsZW1lbnQuaGVpZ2h0KCk7XG5cdFx0XHR0aGlzLmFjdGl2ZS5uZXh0QWxsKCBcIi51aS1tZW51LWl0ZW1cIiApLmVhY2goIGZ1bmN0aW9uKCkge1xuXHRcdFx0XHRpdGVtID0gJCggdGhpcyApO1xuXHRcdFx0XHRyZXR1cm4gaXRlbS5vZmZzZXQoKS50b3AgLSBiYXNlIC0gaGVpZ2h0IDwgMDtcblx0XHRcdH0gKTtcblxuXHRcdFx0dGhpcy5mb2N1cyggZXZlbnQsIGl0ZW0gKTtcblx0XHR9IGVsc2Uge1xuXHRcdFx0dGhpcy5mb2N1cyggZXZlbnQsIHRoaXMuYWN0aXZlTWVudS5maW5kKCB0aGlzLm9wdGlvbnMuaXRlbXMgKVxuXHRcdFx0XHRbICF0aGlzLmFjdGl2ZSA/IFwiZmlyc3RcIiA6IFwibGFzdFwiIF0oKSApO1xuXHRcdH1cblx0fSxcblxuXHRwcmV2aW91c1BhZ2U6IGZ1bmN0aW9uKCBldmVudCApIHtcblx0XHR2YXIgaXRlbSwgYmFzZSwgaGVpZ2h0O1xuXHRcdGlmICggIXRoaXMuYWN0aXZlICkge1xuXHRcdFx0dGhpcy5uZXh0KCBldmVudCApO1xuXHRcdFx0cmV0dXJuO1xuXHRcdH1cblx0XHRpZiAoIHRoaXMuaXNGaXJzdEl0ZW0oKSApIHtcblx0XHRcdHJldHVybjtcblx0XHR9XG5cdFx0aWYgKCB0aGlzLl9oYXNTY3JvbGwoKSApIHtcblx0XHRcdGJhc2UgPSB0aGlzLmFjdGl2ZS5vZmZzZXQoKS50b3A7XG5cdFx0XHRoZWlnaHQgPSB0aGlzLmVsZW1lbnQuaGVpZ2h0KCk7XG5cdFx0XHR0aGlzLmFjdGl2ZS5wcmV2QWxsKCBcIi51aS1tZW51LWl0ZW1cIiApLmVhY2goIGZ1bmN0aW9uKCkge1xuXHRcdFx0XHRpdGVtID0gJCggdGhpcyApO1xuXHRcdFx0XHRyZXR1cm4gaXRlbS5vZmZzZXQoKS50b3AgLSBiYXNlICsgaGVpZ2h0ID4gMDtcblx0XHRcdH0gKTtcblxuXHRcdFx0dGhpcy5mb2N1cyggZXZlbnQsIGl0ZW0gKTtcblx0XHR9IGVsc2Uge1xuXHRcdFx0dGhpcy5mb2N1cyggZXZlbnQsIHRoaXMuYWN0aXZlTWVudS5maW5kKCB0aGlzLm9wdGlvbnMuaXRlbXMgKS5maXJzdCgpICk7XG5cdFx0fVxuXHR9LFxuXG5cdF9oYXNTY3JvbGw6IGZ1bmN0aW9uKCkge1xuXHRcdHJldHVybiB0aGlzLmVsZW1lbnQub3V0ZXJIZWlnaHQoKSA8IHRoaXMuZWxlbWVudC5wcm9wKCBcInNjcm9sbEhlaWdodFwiICk7XG5cdH0sXG5cblx0c2VsZWN0OiBmdW5jdGlvbiggZXZlbnQgKSB7XG5cblx0XHQvLyBUT0RPOiBJdCBzaG91bGQgbmV2ZXIgYmUgcG9zc2libGUgdG8gbm90IGhhdmUgYW4gYWN0aXZlIGl0ZW0gYXQgdGhpc1xuXHRcdC8vIHBvaW50LCBidXQgdGhlIHRlc3RzIGRvbid0IHRyaWdnZXIgbW91c2VlbnRlciBiZWZvcmUgY2xpY2suXG5cdFx0dGhpcy5hY3RpdmUgPSB0aGlzLmFjdGl2ZSB8fCAkKCBldmVudC50YXJnZXQgKS5jbG9zZXN0KCBcIi51aS1tZW51LWl0ZW1cIiApO1xuXHRcdHZhciB1aSA9IHsgaXRlbTogdGhpcy5hY3RpdmUgfTtcblx0XHRpZiAoICF0aGlzLmFjdGl2ZS5oYXMoIFwiLnVpLW1lbnVcIiApLmxlbmd0aCApIHtcblx0XHRcdHRoaXMuY29sbGFwc2VBbGwoIGV2ZW50LCB0cnVlICk7XG5cdFx0fVxuXHRcdHRoaXMuX3RyaWdnZXIoIFwic2VsZWN0XCIsIGV2ZW50LCB1aSApO1xuXHR9LFxuXG5cdF9maWx0ZXJNZW51SXRlbXM6IGZ1bmN0aW9uKCBjaGFyYWN0ZXIgKSB7XG5cdFx0dmFyIGVzY2FwZWRDaGFyYWN0ZXIgPSBjaGFyYWN0ZXIucmVwbGFjZSggL1tcXC1cXFtcXF17fSgpKis/LixcXFxcXFxeJHwjXFxzXS9nLCBcIlxcXFwkJlwiICksXG5cdFx0XHRyZWdleCA9IG5ldyBSZWdFeHAoIFwiXlwiICsgZXNjYXBlZENoYXJhY3RlciwgXCJpXCIgKTtcblxuXHRcdHJldHVybiB0aGlzLmFjdGl2ZU1lbnVcblx0XHRcdC5maW5kKCB0aGlzLm9wdGlvbnMuaXRlbXMgKVxuXG5cdFx0XHRcdC8vIE9ubHkgbWF0Y2ggb24gaXRlbXMsIG5vdCBkaXZpZGVycyBvciBvdGhlciBjb250ZW50ICgjMTA1NzEpXG5cdFx0XHRcdC5maWx0ZXIoIFwiLnVpLW1lbnUtaXRlbVwiIClcblx0XHRcdFx0XHQuZmlsdGVyKCBmdW5jdGlvbigpIHtcblx0XHRcdFx0XHRcdHJldHVybiByZWdleC50ZXN0KFxuXHRcdFx0XHRcdFx0XHQkLnRyaW0oICQoIHRoaXMgKS5jaGlsZHJlbiggXCIudWktbWVudS1pdGVtLXdyYXBwZXJcIiApLnRleHQoKSApICk7XG5cdFx0XHRcdFx0fSApO1xuXHR9XG59ICk7XG5cbn0gKSApO1xuIiwiLyohXG4gKiBqUXVlcnkgVUkgTW91c2UgMS4xMi4wXG4gKiBodHRwOi8vanF1ZXJ5dWkuY29tXG4gKlxuICogQ29weXJpZ2h0IGpRdWVyeSBGb3VuZGF0aW9uIGFuZCBvdGhlciBjb250cmlidXRvcnNcbiAqIFJlbGVhc2VkIHVuZGVyIHRoZSBNSVQgbGljZW5zZS5cbiAqIGh0dHA6Ly9qcXVlcnkub3JnL2xpY2Vuc2VcbiAqL1xuXG4vLz4+bGFiZWw6IE1vdXNlXG4vLz4+Z3JvdXA6IFdpZGdldHNcbi8vPj5kZXNjcmlwdGlvbjogQWJzdHJhY3RzIG1vdXNlLWJhc2VkIGludGVyYWN0aW9ucyB0byBhc3Npc3QgaW4gY3JlYXRpbmcgY2VydGFpbiB3aWRnZXRzLlxuLy8+PmRvY3M6IGh0dHA6Ly9hcGkuanF1ZXJ5dWkuY29tL21vdXNlL1xuXG4oIGZ1bmN0aW9uKCBmYWN0b3J5ICkge1xuXHRpZiAoIHR5cGVvZiBkZWZpbmUgPT09IFwiZnVuY3Rpb25cIiAmJiBkZWZpbmUuYW1kICkge1xuXG5cdFx0Ly8gQU1ELiBSZWdpc3RlciBhcyBhbiBhbm9ueW1vdXMgbW9kdWxlLlxuXHRcdGRlZmluZSggW1xuXHRcdFx0XCJqcXVlcnlcIixcblx0XHRcdFwiLi4vaWVcIixcblx0XHRcdFwiLi4vdmVyc2lvblwiLFxuXHRcdFx0XCIuLi93aWRnZXRcIlxuXHRcdF0sIGZhY3RvcnkgKTtcblx0fSBlbHNlIHtcblxuXHRcdC8vIEJyb3dzZXIgZ2xvYmFsc1xuXHRcdGZhY3RvcnkoIGpRdWVyeSApO1xuXHR9XG59KCBmdW5jdGlvbiggJCApIHtcblxudmFyIG1vdXNlSGFuZGxlZCA9IGZhbHNlO1xuJCggZG9jdW1lbnQgKS5vbiggXCJtb3VzZXVwXCIsIGZ1bmN0aW9uKCkge1xuXHRtb3VzZUhhbmRsZWQgPSBmYWxzZTtcbn0gKTtcblxucmV0dXJuICQud2lkZ2V0KCBcInVpLm1vdXNlXCIsIHtcblx0dmVyc2lvbjogXCIxLjEyLjBcIixcblx0b3B0aW9uczoge1xuXHRcdGNhbmNlbDogXCJpbnB1dCwgdGV4dGFyZWEsIGJ1dHRvbiwgc2VsZWN0LCBvcHRpb25cIixcblx0XHRkaXN0YW5jZTogMSxcblx0XHRkZWxheTogMFxuXHR9LFxuXHRfbW91c2VJbml0OiBmdW5jdGlvbigpIHtcblx0XHR2YXIgdGhhdCA9IHRoaXM7XG5cblx0XHR0aGlzLmVsZW1lbnRcblx0XHRcdC5vbiggXCJtb3VzZWRvd24uXCIgKyB0aGlzLndpZGdldE5hbWUsIGZ1bmN0aW9uKCBldmVudCApIHtcblx0XHRcdFx0cmV0dXJuIHRoYXQuX21vdXNlRG93biggZXZlbnQgKTtcblx0XHRcdH0gKVxuXHRcdFx0Lm9uKCBcImNsaWNrLlwiICsgdGhpcy53aWRnZXROYW1lLCBmdW5jdGlvbiggZXZlbnQgKSB7XG5cdFx0XHRcdGlmICggdHJ1ZSA9PT0gJC5kYXRhKCBldmVudC50YXJnZXQsIHRoYXQud2lkZ2V0TmFtZSArIFwiLnByZXZlbnRDbGlja0V2ZW50XCIgKSApIHtcblx0XHRcdFx0XHQkLnJlbW92ZURhdGEoIGV2ZW50LnRhcmdldCwgdGhhdC53aWRnZXROYW1lICsgXCIucHJldmVudENsaWNrRXZlbnRcIiApO1xuXHRcdFx0XHRcdGV2ZW50LnN0b3BJbW1lZGlhdGVQcm9wYWdhdGlvbigpO1xuXHRcdFx0XHRcdHJldHVybiBmYWxzZTtcblx0XHRcdFx0fVxuXHRcdFx0fSApO1xuXG5cdFx0dGhpcy5zdGFydGVkID0gZmFsc2U7XG5cdH0sXG5cblx0Ly8gVE9ETzogbWFrZSBzdXJlIGRlc3Ryb3lpbmcgb25lIGluc3RhbmNlIG9mIG1vdXNlIGRvZXNuJ3QgbWVzcyB3aXRoXG5cdC8vIG90aGVyIGluc3RhbmNlcyBvZiBtb3VzZVxuXHRfbW91c2VEZXN0cm95OiBmdW5jdGlvbigpIHtcblx0XHR0aGlzLmVsZW1lbnQub2ZmKCBcIi5cIiArIHRoaXMud2lkZ2V0TmFtZSApO1xuXHRcdGlmICggdGhpcy5fbW91c2VNb3ZlRGVsZWdhdGUgKSB7XG5cdFx0XHR0aGlzLmRvY3VtZW50XG5cdFx0XHRcdC5vZmYoIFwibW91c2Vtb3ZlLlwiICsgdGhpcy53aWRnZXROYW1lLCB0aGlzLl9tb3VzZU1vdmVEZWxlZ2F0ZSApXG5cdFx0XHRcdC5vZmYoIFwibW91c2V1cC5cIiArIHRoaXMud2lkZ2V0TmFtZSwgdGhpcy5fbW91c2VVcERlbGVnYXRlICk7XG5cdFx0fVxuXHR9LFxuXG5cdF9tb3VzZURvd246IGZ1bmN0aW9uKCBldmVudCApIHtcblxuXHRcdC8vIGRvbid0IGxldCBtb3JlIHRoYW4gb25lIHdpZGdldCBoYW5kbGUgbW91c2VTdGFydFxuXHRcdGlmICggbW91c2VIYW5kbGVkICkge1xuXHRcdFx0cmV0dXJuO1xuXHRcdH1cblxuXHRcdHRoaXMuX21vdXNlTW92ZWQgPSBmYWxzZTtcblxuXHRcdC8vIFdlIG1heSBoYXZlIG1pc3NlZCBtb3VzZXVwIChvdXQgb2Ygd2luZG93KVxuXHRcdCggdGhpcy5fbW91c2VTdGFydGVkICYmIHRoaXMuX21vdXNlVXAoIGV2ZW50ICkgKTtcblxuXHRcdHRoaXMuX21vdXNlRG93bkV2ZW50ID0gZXZlbnQ7XG5cblx0XHR2YXIgdGhhdCA9IHRoaXMsXG5cdFx0XHRidG5Jc0xlZnQgPSAoIGV2ZW50LndoaWNoID09PSAxICksXG5cblx0XHRcdC8vIGV2ZW50LnRhcmdldC5ub2RlTmFtZSB3b3JrcyBhcm91bmQgYSBidWcgaW4gSUUgOCB3aXRoXG5cdFx0XHQvLyBkaXNhYmxlZCBpbnB1dHMgKCM3NjIwKVxuXHRcdFx0ZWxJc0NhbmNlbCA9ICggdHlwZW9mIHRoaXMub3B0aW9ucy5jYW5jZWwgPT09IFwic3RyaW5nXCIgJiYgZXZlbnQudGFyZ2V0Lm5vZGVOYW1lID9cblx0XHRcdFx0JCggZXZlbnQudGFyZ2V0ICkuY2xvc2VzdCggdGhpcy5vcHRpb25zLmNhbmNlbCApLmxlbmd0aCA6IGZhbHNlICk7XG5cdFx0aWYgKCAhYnRuSXNMZWZ0IHx8IGVsSXNDYW5jZWwgfHwgIXRoaXMuX21vdXNlQ2FwdHVyZSggZXZlbnQgKSApIHtcblx0XHRcdHJldHVybiB0cnVlO1xuXHRcdH1cblxuXHRcdHRoaXMubW91c2VEZWxheU1ldCA9ICF0aGlzLm9wdGlvbnMuZGVsYXk7XG5cdFx0aWYgKCAhdGhpcy5tb3VzZURlbGF5TWV0ICkge1xuXHRcdFx0dGhpcy5fbW91c2VEZWxheVRpbWVyID0gc2V0VGltZW91dCggZnVuY3Rpb24oKSB7XG5cdFx0XHRcdHRoYXQubW91c2VEZWxheU1ldCA9IHRydWU7XG5cdFx0XHR9LCB0aGlzLm9wdGlvbnMuZGVsYXkgKTtcblx0XHR9XG5cblx0XHRpZiAoIHRoaXMuX21vdXNlRGlzdGFuY2VNZXQoIGV2ZW50ICkgJiYgdGhpcy5fbW91c2VEZWxheU1ldCggZXZlbnQgKSApIHtcblx0XHRcdHRoaXMuX21vdXNlU3RhcnRlZCA9ICggdGhpcy5fbW91c2VTdGFydCggZXZlbnQgKSAhPT0gZmFsc2UgKTtcblx0XHRcdGlmICggIXRoaXMuX21vdXNlU3RhcnRlZCApIHtcblx0XHRcdFx0ZXZlbnQucHJldmVudERlZmF1bHQoKTtcblx0XHRcdFx0cmV0dXJuIHRydWU7XG5cdFx0XHR9XG5cdFx0fVxuXG5cdFx0Ly8gQ2xpY2sgZXZlbnQgbWF5IG5ldmVyIGhhdmUgZmlyZWQgKEdlY2tvICYgT3BlcmEpXG5cdFx0aWYgKCB0cnVlID09PSAkLmRhdGEoIGV2ZW50LnRhcmdldCwgdGhpcy53aWRnZXROYW1lICsgXCIucHJldmVudENsaWNrRXZlbnRcIiApICkge1xuXHRcdFx0JC5yZW1vdmVEYXRhKCBldmVudC50YXJnZXQsIHRoaXMud2lkZ2V0TmFtZSArIFwiLnByZXZlbnRDbGlja0V2ZW50XCIgKTtcblx0XHR9XG5cblx0XHQvLyBUaGVzZSBkZWxlZ2F0ZXMgYXJlIHJlcXVpcmVkIHRvIGtlZXAgY29udGV4dFxuXHRcdHRoaXMuX21vdXNlTW92ZURlbGVnYXRlID0gZnVuY3Rpb24oIGV2ZW50ICkge1xuXHRcdFx0cmV0dXJuIHRoYXQuX21vdXNlTW92ZSggZXZlbnQgKTtcblx0XHR9O1xuXHRcdHRoaXMuX21vdXNlVXBEZWxlZ2F0ZSA9IGZ1bmN0aW9uKCBldmVudCApIHtcblx0XHRcdHJldHVybiB0aGF0Ll9tb3VzZVVwKCBldmVudCApO1xuXHRcdH07XG5cblx0XHR0aGlzLmRvY3VtZW50XG5cdFx0XHQub24oIFwibW91c2Vtb3ZlLlwiICsgdGhpcy53aWRnZXROYW1lLCB0aGlzLl9tb3VzZU1vdmVEZWxlZ2F0ZSApXG5cdFx0XHQub24oIFwibW91c2V1cC5cIiArIHRoaXMud2lkZ2V0TmFtZSwgdGhpcy5fbW91c2VVcERlbGVnYXRlICk7XG5cblx0XHRldmVudC5wcmV2ZW50RGVmYXVsdCgpO1xuXG5cdFx0bW91c2VIYW5kbGVkID0gdHJ1ZTtcblx0XHRyZXR1cm4gdHJ1ZTtcblx0fSxcblxuXHRfbW91c2VNb3ZlOiBmdW5jdGlvbiggZXZlbnQgKSB7XG5cblx0XHQvLyBPbmx5IGNoZWNrIGZvciBtb3VzZXVwcyBvdXRzaWRlIHRoZSBkb2N1bWVudCBpZiB5b3UndmUgbW92ZWQgaW5zaWRlIHRoZSBkb2N1bWVudFxuXHRcdC8vIGF0IGxlYXN0IG9uY2UuIFRoaXMgcHJldmVudHMgdGhlIGZpcmluZyBvZiBtb3VzZXVwIGluIHRoZSBjYXNlIG9mIElFPDksIHdoaWNoIHdpbGxcblx0XHQvLyBmaXJlIGEgbW91c2Vtb3ZlIGV2ZW50IGlmIGNvbnRlbnQgaXMgcGxhY2VkIHVuZGVyIHRoZSBjdXJzb3IuIFNlZSAjNzc3OFxuXHRcdC8vIFN1cHBvcnQ6IElFIDw5XG5cdFx0aWYgKCB0aGlzLl9tb3VzZU1vdmVkICkge1xuXG5cdFx0XHQvLyBJRSBtb3VzZXVwIGNoZWNrIC0gbW91c2V1cCBoYXBwZW5lZCB3aGVuIG1vdXNlIHdhcyBvdXQgb2Ygd2luZG93XG5cdFx0XHRpZiAoICQudWkuaWUgJiYgKCAhZG9jdW1lbnQuZG9jdW1lbnRNb2RlIHx8IGRvY3VtZW50LmRvY3VtZW50TW9kZSA8IDkgKSAmJlxuXHRcdFx0XHRcdCFldmVudC5idXR0b24gKSB7XG5cdFx0XHRcdHJldHVybiB0aGlzLl9tb3VzZVVwKCBldmVudCApO1xuXG5cdFx0XHQvLyBJZnJhbWUgbW91c2V1cCBjaGVjayAtIG1vdXNldXAgb2NjdXJyZWQgaW4gYW5vdGhlciBkb2N1bWVudFxuXHRcdFx0fSBlbHNlIGlmICggIWV2ZW50LndoaWNoICkge1xuXG5cdFx0XHRcdC8vIFN1cHBvcnQ6IFNhZmFyaSA8PTggLSA5XG5cdFx0XHRcdC8vIFNhZmFyaSBzZXRzIHdoaWNoIHRvIDAgaWYgeW91IHByZXNzIGFueSBvZiB0aGUgZm9sbG93aW5nIGtleXNcblx0XHRcdFx0Ly8gZHVyaW5nIGEgZHJhZyAoIzE0NDYxKVxuXHRcdFx0XHRpZiAoIGV2ZW50Lm9yaWdpbmFsRXZlbnQuYWx0S2V5IHx8IGV2ZW50Lm9yaWdpbmFsRXZlbnQuY3RybEtleSB8fFxuXHRcdFx0XHRcdFx0ZXZlbnQub3JpZ2luYWxFdmVudC5tZXRhS2V5IHx8IGV2ZW50Lm9yaWdpbmFsRXZlbnQuc2hpZnRLZXkgKSB7XG5cdFx0XHRcdFx0dGhpcy5pZ25vcmVNaXNzaW5nV2hpY2ggPSB0cnVlO1xuXHRcdFx0XHR9IGVsc2UgaWYgKCAhdGhpcy5pZ25vcmVNaXNzaW5nV2hpY2ggKSB7XG5cdFx0XHRcdFx0cmV0dXJuIHRoaXMuX21vdXNlVXAoIGV2ZW50ICk7XG5cdFx0XHRcdH1cblx0XHRcdH1cblx0XHR9XG5cblx0XHRpZiAoIGV2ZW50LndoaWNoIHx8IGV2ZW50LmJ1dHRvbiApIHtcblx0XHRcdHRoaXMuX21vdXNlTW92ZWQgPSB0cnVlO1xuXHRcdH1cblxuXHRcdGlmICggdGhpcy5fbW91c2VTdGFydGVkICkge1xuXHRcdFx0dGhpcy5fbW91c2VEcmFnKCBldmVudCApO1xuXHRcdFx0cmV0dXJuIGV2ZW50LnByZXZlbnREZWZhdWx0KCk7XG5cdFx0fVxuXG5cdFx0aWYgKCB0aGlzLl9tb3VzZURpc3RhbmNlTWV0KCBldmVudCApICYmIHRoaXMuX21vdXNlRGVsYXlNZXQoIGV2ZW50ICkgKSB7XG5cdFx0XHR0aGlzLl9tb3VzZVN0YXJ0ZWQgPVxuXHRcdFx0XHQoIHRoaXMuX21vdXNlU3RhcnQoIHRoaXMuX21vdXNlRG93bkV2ZW50LCBldmVudCApICE9PSBmYWxzZSApO1xuXHRcdFx0KCB0aGlzLl9tb3VzZVN0YXJ0ZWQgPyB0aGlzLl9tb3VzZURyYWcoIGV2ZW50ICkgOiB0aGlzLl9tb3VzZVVwKCBldmVudCApICk7XG5cdFx0fVxuXG5cdFx0cmV0dXJuICF0aGlzLl9tb3VzZVN0YXJ0ZWQ7XG5cdH0sXG5cblx0X21vdXNlVXA6IGZ1bmN0aW9uKCBldmVudCApIHtcblx0XHR0aGlzLmRvY3VtZW50XG5cdFx0XHQub2ZmKCBcIm1vdXNlbW92ZS5cIiArIHRoaXMud2lkZ2V0TmFtZSwgdGhpcy5fbW91c2VNb3ZlRGVsZWdhdGUgKVxuXHRcdFx0Lm9mZiggXCJtb3VzZXVwLlwiICsgdGhpcy53aWRnZXROYW1lLCB0aGlzLl9tb3VzZVVwRGVsZWdhdGUgKTtcblxuXHRcdGlmICggdGhpcy5fbW91c2VTdGFydGVkICkge1xuXHRcdFx0dGhpcy5fbW91c2VTdGFydGVkID0gZmFsc2U7XG5cblx0XHRcdGlmICggZXZlbnQudGFyZ2V0ID09PSB0aGlzLl9tb3VzZURvd25FdmVudC50YXJnZXQgKSB7XG5cdFx0XHRcdCQuZGF0YSggZXZlbnQudGFyZ2V0LCB0aGlzLndpZGdldE5hbWUgKyBcIi5wcmV2ZW50Q2xpY2tFdmVudFwiLCB0cnVlICk7XG5cdFx0XHR9XG5cblx0XHRcdHRoaXMuX21vdXNlU3RvcCggZXZlbnQgKTtcblx0XHR9XG5cblx0XHRpZiAoIHRoaXMuX21vdXNlRGVsYXlUaW1lciApIHtcblx0XHRcdGNsZWFyVGltZW91dCggdGhpcy5fbW91c2VEZWxheVRpbWVyICk7XG5cdFx0XHRkZWxldGUgdGhpcy5fbW91c2VEZWxheVRpbWVyO1xuXHRcdH1cblxuXHRcdHRoaXMuaWdub3JlTWlzc2luZ1doaWNoID0gZmFsc2U7XG5cdFx0bW91c2VIYW5kbGVkID0gZmFsc2U7XG5cdFx0ZXZlbnQucHJldmVudERlZmF1bHQoKTtcblx0fSxcblxuXHRfbW91c2VEaXN0YW5jZU1ldDogZnVuY3Rpb24oIGV2ZW50ICkge1xuXHRcdHJldHVybiAoIE1hdGgubWF4KFxuXHRcdFx0XHRNYXRoLmFicyggdGhpcy5fbW91c2VEb3duRXZlbnQucGFnZVggLSBldmVudC5wYWdlWCApLFxuXHRcdFx0XHRNYXRoLmFicyggdGhpcy5fbW91c2VEb3duRXZlbnQucGFnZVkgLSBldmVudC5wYWdlWSApXG5cdFx0XHQpID49IHRoaXMub3B0aW9ucy5kaXN0YW5jZVxuXHRcdCk7XG5cdH0sXG5cblx0X21vdXNlRGVsYXlNZXQ6IGZ1bmN0aW9uKCAvKiBldmVudCAqLyApIHtcblx0XHRyZXR1cm4gdGhpcy5tb3VzZURlbGF5TWV0O1xuXHR9LFxuXG5cdC8vIFRoZXNlIGFyZSBwbGFjZWhvbGRlciBtZXRob2RzLCB0byBiZSBvdmVycmlkZW4gYnkgZXh0ZW5kaW5nIHBsdWdpblxuXHRfbW91c2VTdGFydDogZnVuY3Rpb24oIC8qIGV2ZW50ICovICkge30sXG5cdF9tb3VzZURyYWc6IGZ1bmN0aW9uKCAvKiBldmVudCAqLyApIHt9LFxuXHRfbW91c2VTdG9wOiBmdW5jdGlvbiggLyogZXZlbnQgKi8gKSB7fSxcblx0X21vdXNlQ2FwdHVyZTogZnVuY3Rpb24oIC8qIGV2ZW50ICovICkgeyByZXR1cm4gdHJ1ZTsgfVxufSApO1xuXG59ICkgKTtcbiIsIi8qIVxuICogalF1ZXJ5IFVJIFJlc2l6YWJsZSAxLjEyLjBcbiAqIGh0dHA6Ly9qcXVlcnl1aS5jb21cbiAqXG4gKiBDb3B5cmlnaHQgalF1ZXJ5IEZvdW5kYXRpb24gYW5kIG90aGVyIGNvbnRyaWJ1dG9yc1xuICogUmVsZWFzZWQgdW5kZXIgdGhlIE1JVCBsaWNlbnNlLlxuICogaHR0cDovL2pxdWVyeS5vcmcvbGljZW5zZVxuICovXG5cbi8vPj5sYWJlbDogUmVzaXphYmxlXG4vLz4+Z3JvdXA6IEludGVyYWN0aW9uc1xuLy8+PmRlc2NyaXB0aW9uOiBFbmFibGVzIHJlc2l6ZSBmdW5jdGlvbmFsaXR5IGZvciBhbnkgZWxlbWVudC5cbi8vPj5kb2NzOiBodHRwOi8vYXBpLmpxdWVyeXVpLmNvbS9yZXNpemFibGUvXG4vLz4+ZGVtb3M6IGh0dHA6Ly9qcXVlcnl1aS5jb20vcmVzaXphYmxlL1xuLy8+PmNzcy5zdHJ1Y3R1cmU6IC4uLy4uL3RoZW1lcy9iYXNlL2NvcmUuY3NzXG4vLz4+Y3NzLnN0cnVjdHVyZTogLi4vLi4vdGhlbWVzL2Jhc2UvcmVzaXphYmxlLmNzc1xuLy8+PmNzcy50aGVtZTogLi4vLi4vdGhlbWVzL2Jhc2UvdGhlbWUuY3NzXG5cbiggZnVuY3Rpb24oIGZhY3RvcnkgKSB7XG5cdGlmICggdHlwZW9mIGRlZmluZSA9PT0gXCJmdW5jdGlvblwiICYmIGRlZmluZS5hbWQgKSB7XG5cblx0XHQvLyBBTUQuIFJlZ2lzdGVyIGFzIGFuIGFub255bW91cyBtb2R1bGUuXG5cdFx0ZGVmaW5lKCBbXG5cdFx0XHRcImpxdWVyeVwiLFxuXHRcdFx0XCIuL21vdXNlXCIsXG5cdFx0XHRcIi4uL2Rpc2FibGUtc2VsZWN0aW9uXCIsXG5cdFx0XHRcIi4uL3BsdWdpblwiLFxuXHRcdFx0XCIuLi92ZXJzaW9uXCIsXG5cdFx0XHRcIi4uL3dpZGdldFwiXG5cdFx0XSwgZmFjdG9yeSApO1xuXHR9IGVsc2Uge1xuXG5cdFx0Ly8gQnJvd3NlciBnbG9iYWxzXG5cdFx0ZmFjdG9yeSggalF1ZXJ5ICk7XG5cdH1cbn0oIGZ1bmN0aW9uKCAkICkge1xuXG4kLndpZGdldCggXCJ1aS5yZXNpemFibGVcIiwgJC51aS5tb3VzZSwge1xuXHR2ZXJzaW9uOiBcIjEuMTIuMFwiLFxuXHR3aWRnZXRFdmVudFByZWZpeDogXCJyZXNpemVcIixcblx0b3B0aW9uczoge1xuXHRcdGFsc29SZXNpemU6IGZhbHNlLFxuXHRcdGFuaW1hdGU6IGZhbHNlLFxuXHRcdGFuaW1hdGVEdXJhdGlvbjogXCJzbG93XCIsXG5cdFx0YW5pbWF0ZUVhc2luZzogXCJzd2luZ1wiLFxuXHRcdGFzcGVjdFJhdGlvOiBmYWxzZSxcblx0XHRhdXRvSGlkZTogZmFsc2UsXG5cdFx0Y2xhc3Nlczoge1xuXHRcdFx0XCJ1aS1yZXNpemFibGUtc2VcIjogXCJ1aS1pY29uIHVpLWljb24tZ3JpcHNtYWxsLWRpYWdvbmFsLXNlXCJcblx0XHR9LFxuXHRcdGNvbnRhaW5tZW50OiBmYWxzZSxcblx0XHRnaG9zdDogZmFsc2UsXG5cdFx0Z3JpZDogZmFsc2UsXG5cdFx0aGFuZGxlczogXCJlLHMsc2VcIixcblx0XHRoZWxwZXI6IGZhbHNlLFxuXHRcdG1heEhlaWdodDogbnVsbCxcblx0XHRtYXhXaWR0aDogbnVsbCxcblx0XHRtaW5IZWlnaHQ6IDEwLFxuXHRcdG1pbldpZHRoOiAxMCxcblxuXHRcdC8vIFNlZSAjNzk2MFxuXHRcdHpJbmRleDogOTAsXG5cblx0XHQvLyBDYWxsYmFja3Ncblx0XHRyZXNpemU6IG51bGwsXG5cdFx0c3RhcnQ6IG51bGwsXG5cdFx0c3RvcDogbnVsbFxuXHR9LFxuXG5cdF9udW06IGZ1bmN0aW9uKCB2YWx1ZSApIHtcblx0XHRyZXR1cm4gcGFyc2VGbG9hdCggdmFsdWUgKSB8fCAwO1xuXHR9LFxuXG5cdF9pc051bWJlcjogZnVuY3Rpb24oIHZhbHVlICkge1xuXHRcdHJldHVybiAhaXNOYU4oIHBhcnNlRmxvYXQoIHZhbHVlICkgKTtcblx0fSxcblxuXHRfaGFzU2Nyb2xsOiBmdW5jdGlvbiggZWwsIGEgKSB7XG5cblx0XHRpZiAoICQoIGVsICkuY3NzKCBcIm92ZXJmbG93XCIgKSA9PT0gXCJoaWRkZW5cIiApIHtcblx0XHRcdHJldHVybiBmYWxzZTtcblx0XHR9XG5cblx0XHR2YXIgc2Nyb2xsID0gKCBhICYmIGEgPT09IFwibGVmdFwiICkgPyBcInNjcm9sbExlZnRcIiA6IFwic2Nyb2xsVG9wXCIsXG5cdFx0XHRoYXMgPSBmYWxzZTtcblxuXHRcdGlmICggZWxbIHNjcm9sbCBdID4gMCApIHtcblx0XHRcdHJldHVybiB0cnVlO1xuXHRcdH1cblxuXHRcdC8vIFRPRE86IGRldGVybWluZSB3aGljaCBjYXNlcyBhY3R1YWxseSBjYXVzZSB0aGlzIHRvIGhhcHBlblxuXHRcdC8vIGlmIHRoZSBlbGVtZW50IGRvZXNuJ3QgaGF2ZSB0aGUgc2Nyb2xsIHNldCwgc2VlIGlmIGl0J3MgcG9zc2libGUgdG9cblx0XHQvLyBzZXQgdGhlIHNjcm9sbFxuXHRcdGVsWyBzY3JvbGwgXSA9IDE7XG5cdFx0aGFzID0gKCBlbFsgc2Nyb2xsIF0gPiAwICk7XG5cdFx0ZWxbIHNjcm9sbCBdID0gMDtcblx0XHRyZXR1cm4gaGFzO1xuXHR9LFxuXG5cdF9jcmVhdGU6IGZ1bmN0aW9uKCkge1xuXG5cdFx0dmFyIG1hcmdpbnMsXG5cdFx0XHRvID0gdGhpcy5vcHRpb25zLFxuXHRcdFx0dGhhdCA9IHRoaXM7XG5cdFx0dGhpcy5fYWRkQ2xhc3MoIFwidWktcmVzaXphYmxlXCIgKTtcblxuXHRcdCQuZXh0ZW5kKCB0aGlzLCB7XG5cdFx0XHRfYXNwZWN0UmF0aW86ICEhKCBvLmFzcGVjdFJhdGlvICksXG5cdFx0XHRhc3BlY3RSYXRpbzogby5hc3BlY3RSYXRpbyxcblx0XHRcdG9yaWdpbmFsRWxlbWVudDogdGhpcy5lbGVtZW50LFxuXHRcdFx0X3Byb3BvcnRpb25hbGx5UmVzaXplRWxlbWVudHM6IFtdLFxuXHRcdFx0X2hlbHBlcjogby5oZWxwZXIgfHwgby5naG9zdCB8fCBvLmFuaW1hdGUgPyBvLmhlbHBlciB8fCBcInVpLXJlc2l6YWJsZS1oZWxwZXJcIiA6IG51bGxcblx0XHR9ICk7XG5cblx0XHQvLyBXcmFwIHRoZSBlbGVtZW50IGlmIGl0IGNhbm5vdCBob2xkIGNoaWxkIG5vZGVzXG5cdFx0aWYgKCB0aGlzLmVsZW1lbnRbIDAgXS5ub2RlTmFtZS5tYXRjaCggL14oY2FudmFzfHRleHRhcmVhfGlucHV0fHNlbGVjdHxidXR0b258aW1nKSQvaSApICkge1xuXG5cdFx0XHR0aGlzLmVsZW1lbnQud3JhcChcblx0XHRcdFx0JCggXCI8ZGl2IGNsYXNzPSd1aS13cmFwcGVyJyBzdHlsZT0nb3ZlcmZsb3c6IGhpZGRlbjsnPjwvZGl2PlwiICkuY3NzKCB7XG5cdFx0XHRcdFx0cG9zaXRpb246IHRoaXMuZWxlbWVudC5jc3MoIFwicG9zaXRpb25cIiApLFxuXHRcdFx0XHRcdHdpZHRoOiB0aGlzLmVsZW1lbnQub3V0ZXJXaWR0aCgpLFxuXHRcdFx0XHRcdGhlaWdodDogdGhpcy5lbGVtZW50Lm91dGVySGVpZ2h0KCksXG5cdFx0XHRcdFx0dG9wOiB0aGlzLmVsZW1lbnQuY3NzKCBcInRvcFwiICksXG5cdFx0XHRcdFx0bGVmdDogdGhpcy5lbGVtZW50LmNzcyggXCJsZWZ0XCIgKVxuXHRcdFx0XHR9IClcblx0XHRcdCk7XG5cblx0XHRcdHRoaXMuZWxlbWVudCA9IHRoaXMuZWxlbWVudC5wYXJlbnQoKS5kYXRhKFxuXHRcdFx0XHRcInVpLXJlc2l6YWJsZVwiLCB0aGlzLmVsZW1lbnQucmVzaXphYmxlKCBcImluc3RhbmNlXCIgKVxuXHRcdFx0KTtcblxuXHRcdFx0dGhpcy5lbGVtZW50SXNXcmFwcGVyID0gdHJ1ZTtcblxuXHRcdFx0bWFyZ2lucyA9IHtcblx0XHRcdFx0bWFyZ2luVG9wOiB0aGlzLm9yaWdpbmFsRWxlbWVudC5jc3MoIFwibWFyZ2luVG9wXCIgKSxcblx0XHRcdFx0bWFyZ2luUmlnaHQ6IHRoaXMub3JpZ2luYWxFbGVtZW50LmNzcyggXCJtYXJnaW5SaWdodFwiICksXG5cdFx0XHRcdG1hcmdpbkJvdHRvbTogdGhpcy5vcmlnaW5hbEVsZW1lbnQuY3NzKCBcIm1hcmdpbkJvdHRvbVwiICksXG5cdFx0XHRcdG1hcmdpbkxlZnQ6IHRoaXMub3JpZ2luYWxFbGVtZW50LmNzcyggXCJtYXJnaW5MZWZ0XCIgKVxuXHRcdFx0fTtcblxuXHRcdFx0dGhpcy5lbGVtZW50LmNzcyggbWFyZ2lucyApO1xuXHRcdFx0dGhpcy5vcmlnaW5hbEVsZW1lbnQuY3NzKCBcIm1hcmdpblwiLCAwICk7XG5cblx0XHRcdC8vIHN1cHBvcnQ6IFNhZmFyaVxuXHRcdFx0Ly8gUHJldmVudCBTYWZhcmkgdGV4dGFyZWEgcmVzaXplXG5cdFx0XHR0aGlzLm9yaWdpbmFsUmVzaXplU3R5bGUgPSB0aGlzLm9yaWdpbmFsRWxlbWVudC5jc3MoIFwicmVzaXplXCIgKTtcblx0XHRcdHRoaXMub3JpZ2luYWxFbGVtZW50LmNzcyggXCJyZXNpemVcIiwgXCJub25lXCIgKTtcblxuXHRcdFx0dGhpcy5fcHJvcG9ydGlvbmFsbHlSZXNpemVFbGVtZW50cy5wdXNoKCB0aGlzLm9yaWdpbmFsRWxlbWVudC5jc3MoIHtcblx0XHRcdFx0cG9zaXRpb246IFwic3RhdGljXCIsXG5cdFx0XHRcdHpvb206IDEsXG5cdFx0XHRcdGRpc3BsYXk6IFwiYmxvY2tcIlxuXHRcdFx0fSApICk7XG5cblx0XHRcdC8vIFN1cHBvcnQ6IElFOVxuXHRcdFx0Ly8gYXZvaWQgSUUganVtcCAoaGFyZCBzZXQgdGhlIG1hcmdpbilcblx0XHRcdHRoaXMub3JpZ2luYWxFbGVtZW50LmNzcyggbWFyZ2lucyApO1xuXG5cdFx0XHR0aGlzLl9wcm9wb3J0aW9uYWxseVJlc2l6ZSgpO1xuXHRcdH1cblxuXHRcdHRoaXMuX3NldHVwSGFuZGxlcygpO1xuXG5cdFx0aWYgKCBvLmF1dG9IaWRlICkge1xuXHRcdFx0JCggdGhpcy5lbGVtZW50IClcblx0XHRcdFx0Lm9uKCBcIm1vdXNlZW50ZXJcIiwgZnVuY3Rpb24oKSB7XG5cdFx0XHRcdFx0aWYgKCBvLmRpc2FibGVkICkge1xuXHRcdFx0XHRcdFx0cmV0dXJuO1xuXHRcdFx0XHRcdH1cblx0XHRcdFx0XHR0aGF0Ll9yZW1vdmVDbGFzcyggXCJ1aS1yZXNpemFibGUtYXV0b2hpZGVcIiApO1xuXHRcdFx0XHRcdHRoYXQuX2hhbmRsZXMuc2hvdygpO1xuXHRcdFx0XHR9IClcblx0XHRcdFx0Lm9uKCBcIm1vdXNlbGVhdmVcIiwgZnVuY3Rpb24oKSB7XG5cdFx0XHRcdFx0aWYgKCBvLmRpc2FibGVkICkge1xuXHRcdFx0XHRcdFx0cmV0dXJuO1xuXHRcdFx0XHRcdH1cblx0XHRcdFx0XHRpZiAoICF0aGF0LnJlc2l6aW5nICkge1xuXHRcdFx0XHRcdFx0dGhhdC5fYWRkQ2xhc3MoIFwidWktcmVzaXphYmxlLWF1dG9oaWRlXCIgKTtcblx0XHRcdFx0XHRcdHRoYXQuX2hhbmRsZXMuaGlkZSgpO1xuXHRcdFx0XHRcdH1cblx0XHRcdFx0fSApO1xuXHRcdH1cblxuXHRcdHRoaXMuX21vdXNlSW5pdCgpO1xuXHR9LFxuXG5cdF9kZXN0cm95OiBmdW5jdGlvbigpIHtcblxuXHRcdHRoaXMuX21vdXNlRGVzdHJveSgpO1xuXG5cdFx0dmFyIHdyYXBwZXIsXG5cdFx0XHRfZGVzdHJveSA9IGZ1bmN0aW9uKCBleHAgKSB7XG5cdFx0XHRcdCQoIGV4cCApXG5cdFx0XHRcdFx0LnJlbW92ZURhdGEoIFwicmVzaXphYmxlXCIgKVxuXHRcdFx0XHRcdC5yZW1vdmVEYXRhKCBcInVpLXJlc2l6YWJsZVwiIClcblx0XHRcdFx0XHQub2ZmKCBcIi5yZXNpemFibGVcIiApXG5cdFx0XHRcdFx0LmZpbmQoIFwiLnVpLXJlc2l6YWJsZS1oYW5kbGVcIiApXG5cdFx0XHRcdFx0XHQucmVtb3ZlKCk7XG5cdFx0XHR9O1xuXG5cdFx0Ly8gVE9ETzogVW53cmFwIGF0IHNhbWUgRE9NIHBvc2l0aW9uXG5cdFx0aWYgKCB0aGlzLmVsZW1lbnRJc1dyYXBwZXIgKSB7XG5cdFx0XHRfZGVzdHJveSggdGhpcy5lbGVtZW50ICk7XG5cdFx0XHR3cmFwcGVyID0gdGhpcy5lbGVtZW50O1xuXHRcdFx0dGhpcy5vcmlnaW5hbEVsZW1lbnQuY3NzKCB7XG5cdFx0XHRcdHBvc2l0aW9uOiB3cmFwcGVyLmNzcyggXCJwb3NpdGlvblwiICksXG5cdFx0XHRcdHdpZHRoOiB3cmFwcGVyLm91dGVyV2lkdGgoKSxcblx0XHRcdFx0aGVpZ2h0OiB3cmFwcGVyLm91dGVySGVpZ2h0KCksXG5cdFx0XHRcdHRvcDogd3JhcHBlci5jc3MoIFwidG9wXCIgKSxcblx0XHRcdFx0bGVmdDogd3JhcHBlci5jc3MoIFwibGVmdFwiIClcblx0XHRcdH0gKS5pbnNlcnRBZnRlciggd3JhcHBlciApO1xuXHRcdFx0d3JhcHBlci5yZW1vdmUoKTtcblx0XHR9XG5cblx0XHR0aGlzLm9yaWdpbmFsRWxlbWVudC5jc3MoIFwicmVzaXplXCIsIHRoaXMub3JpZ2luYWxSZXNpemVTdHlsZSApO1xuXHRcdF9kZXN0cm95KCB0aGlzLm9yaWdpbmFsRWxlbWVudCApO1xuXG5cdFx0cmV0dXJuIHRoaXM7XG5cdH0sXG5cblx0X3NldE9wdGlvbjogZnVuY3Rpb24oIGtleSwgdmFsdWUgKSB7XG5cdFx0dGhpcy5fc3VwZXIoIGtleSwgdmFsdWUgKTtcblxuXHRcdHN3aXRjaCAoIGtleSApIHtcblx0XHRjYXNlIFwiaGFuZGxlc1wiOlxuXHRcdFx0dGhpcy5fcmVtb3ZlSGFuZGxlcygpO1xuXHRcdFx0dGhpcy5fc2V0dXBIYW5kbGVzKCk7XG5cdFx0XHRicmVhaztcblx0XHRkZWZhdWx0OlxuXHRcdFx0YnJlYWs7XG5cdFx0fVxuXHR9LFxuXG5cdF9zZXR1cEhhbmRsZXM6IGZ1bmN0aW9uKCkge1xuXHRcdHZhciBvID0gdGhpcy5vcHRpb25zLCBoYW5kbGUsIGksIG4sIGhuYW1lLCBheGlzLCB0aGF0ID0gdGhpcztcblx0XHR0aGlzLmhhbmRsZXMgPSBvLmhhbmRsZXMgfHxcblx0XHRcdCggISQoIFwiLnVpLXJlc2l6YWJsZS1oYW5kbGVcIiwgdGhpcy5lbGVtZW50ICkubGVuZ3RoID9cblx0XHRcdFx0XCJlLHMsc2VcIiA6IHtcblx0XHRcdFx0XHRuOiBcIi51aS1yZXNpemFibGUtblwiLFxuXHRcdFx0XHRcdGU6IFwiLnVpLXJlc2l6YWJsZS1lXCIsXG5cdFx0XHRcdFx0czogXCIudWktcmVzaXphYmxlLXNcIixcblx0XHRcdFx0XHR3OiBcIi51aS1yZXNpemFibGUtd1wiLFxuXHRcdFx0XHRcdHNlOiBcIi51aS1yZXNpemFibGUtc2VcIixcblx0XHRcdFx0XHRzdzogXCIudWktcmVzaXphYmxlLXN3XCIsXG5cdFx0XHRcdFx0bmU6IFwiLnVpLXJlc2l6YWJsZS1uZVwiLFxuXHRcdFx0XHRcdG53OiBcIi51aS1yZXNpemFibGUtbndcIlxuXHRcdFx0XHR9ICk7XG5cblx0XHR0aGlzLl9oYW5kbGVzID0gJCgpO1xuXHRcdGlmICggdGhpcy5oYW5kbGVzLmNvbnN0cnVjdG9yID09PSBTdHJpbmcgKSB7XG5cblx0XHRcdGlmICggdGhpcy5oYW5kbGVzID09PSBcImFsbFwiICkge1xuXHRcdFx0XHR0aGlzLmhhbmRsZXMgPSBcIm4sZSxzLHcsc2Usc3csbmUsbndcIjtcblx0XHRcdH1cblxuXHRcdFx0biA9IHRoaXMuaGFuZGxlcy5zcGxpdCggXCIsXCIgKTtcblx0XHRcdHRoaXMuaGFuZGxlcyA9IHt9O1xuXG5cdFx0XHRmb3IgKCBpID0gMDsgaSA8IG4ubGVuZ3RoOyBpKysgKSB7XG5cblx0XHRcdFx0aGFuZGxlID0gJC50cmltKCBuWyBpIF0gKTtcblx0XHRcdFx0aG5hbWUgPSBcInVpLXJlc2l6YWJsZS1cIiArIGhhbmRsZTtcblx0XHRcdFx0YXhpcyA9ICQoIFwiPGRpdj5cIiApO1xuXHRcdFx0XHR0aGlzLl9hZGRDbGFzcyggYXhpcywgXCJ1aS1yZXNpemFibGUtaGFuZGxlIFwiICsgaG5hbWUgKTtcblxuXHRcdFx0XHRheGlzLmNzcyggeyB6SW5kZXg6IG8uekluZGV4IH0gKTtcblxuXHRcdFx0XHR0aGlzLmhhbmRsZXNbIGhhbmRsZSBdID0gXCIudWktcmVzaXphYmxlLVwiICsgaGFuZGxlO1xuXHRcdFx0XHR0aGlzLmVsZW1lbnQuYXBwZW5kKCBheGlzICk7XG5cdFx0XHR9XG5cblx0XHR9XG5cblx0XHR0aGlzLl9yZW5kZXJBeGlzID0gZnVuY3Rpb24oIHRhcmdldCApIHtcblxuXHRcdFx0dmFyIGksIGF4aXMsIHBhZFBvcywgcGFkV3JhcHBlcjtcblxuXHRcdFx0dGFyZ2V0ID0gdGFyZ2V0IHx8IHRoaXMuZWxlbWVudDtcblxuXHRcdFx0Zm9yICggaSBpbiB0aGlzLmhhbmRsZXMgKSB7XG5cblx0XHRcdFx0aWYgKCB0aGlzLmhhbmRsZXNbIGkgXS5jb25zdHJ1Y3RvciA9PT0gU3RyaW5nICkge1xuXHRcdFx0XHRcdHRoaXMuaGFuZGxlc1sgaSBdID0gdGhpcy5lbGVtZW50LmNoaWxkcmVuKCB0aGlzLmhhbmRsZXNbIGkgXSApLmZpcnN0KCkuc2hvdygpO1xuXHRcdFx0XHR9IGVsc2UgaWYgKCB0aGlzLmhhbmRsZXNbIGkgXS5qcXVlcnkgfHwgdGhpcy5oYW5kbGVzWyBpIF0ubm9kZVR5cGUgKSB7XG5cdFx0XHRcdFx0dGhpcy5oYW5kbGVzWyBpIF0gPSAkKCB0aGlzLmhhbmRsZXNbIGkgXSApO1xuXHRcdFx0XHRcdHRoaXMuX29uKCB0aGlzLmhhbmRsZXNbIGkgXSwgeyBcIm1vdXNlZG93blwiOiB0aGF0Ll9tb3VzZURvd24gfSApO1xuXHRcdFx0XHR9XG5cblx0XHRcdFx0aWYgKCB0aGlzLmVsZW1lbnRJc1dyYXBwZXIgJiZcblx0XHRcdFx0XHRcdHRoaXMub3JpZ2luYWxFbGVtZW50WyAwIF1cblx0XHRcdFx0XHRcdFx0Lm5vZGVOYW1lXG5cdFx0XHRcdFx0XHRcdC5tYXRjaCggL14odGV4dGFyZWF8aW5wdXR8c2VsZWN0fGJ1dHRvbikkL2kgKSApIHtcblx0XHRcdFx0XHRheGlzID0gJCggdGhpcy5oYW5kbGVzWyBpIF0sIHRoaXMuZWxlbWVudCApO1xuXG5cdFx0XHRcdFx0cGFkV3JhcHBlciA9IC9zd3xuZXxud3xzZXxufHMvLnRlc3QoIGkgKSA/XG5cdFx0XHRcdFx0XHRheGlzLm91dGVySGVpZ2h0KCkgOlxuXHRcdFx0XHRcdFx0YXhpcy5vdXRlcldpZHRoKCk7XG5cblx0XHRcdFx0XHRwYWRQb3MgPSBbIFwicGFkZGluZ1wiLFxuXHRcdFx0XHRcdFx0L25lfG53fG4vLnRlc3QoIGkgKSA/IFwiVG9wXCIgOlxuXHRcdFx0XHRcdFx0L3NlfHN3fHMvLnRlc3QoIGkgKSA/IFwiQm90dG9tXCIgOlxuXHRcdFx0XHRcdFx0L15lJC8udGVzdCggaSApID8gXCJSaWdodFwiIDogXCJMZWZ0XCIgXS5qb2luKCBcIlwiICk7XG5cblx0XHRcdFx0XHR0YXJnZXQuY3NzKCBwYWRQb3MsIHBhZFdyYXBwZXIgKTtcblxuXHRcdFx0XHRcdHRoaXMuX3Byb3BvcnRpb25hbGx5UmVzaXplKCk7XG5cdFx0XHRcdH1cblxuXHRcdFx0XHR0aGlzLl9oYW5kbGVzID0gdGhpcy5faGFuZGxlcy5hZGQoIHRoaXMuaGFuZGxlc1sgaSBdICk7XG5cdFx0XHR9XG5cdFx0fTtcblxuXHRcdC8vIFRPRE86IG1ha2UgcmVuZGVyQXhpcyBhIHByb3RvdHlwZSBmdW5jdGlvblxuXHRcdHRoaXMuX3JlbmRlckF4aXMoIHRoaXMuZWxlbWVudCApO1xuXG5cdFx0dGhpcy5faGFuZGxlcyA9IHRoaXMuX2hhbmRsZXMuYWRkKCB0aGlzLmVsZW1lbnQuZmluZCggXCIudWktcmVzaXphYmxlLWhhbmRsZVwiICkgKTtcblx0XHR0aGlzLl9oYW5kbGVzLmRpc2FibGVTZWxlY3Rpb24oKTtcblxuXHRcdHRoaXMuX2hhbmRsZXMub24oIFwibW91c2VvdmVyXCIsIGZ1bmN0aW9uKCkge1xuXHRcdFx0aWYgKCAhdGhhdC5yZXNpemluZyApIHtcblx0XHRcdFx0aWYgKCB0aGlzLmNsYXNzTmFtZSApIHtcblx0XHRcdFx0XHRheGlzID0gdGhpcy5jbGFzc05hbWUubWF0Y2goIC91aS1yZXNpemFibGUtKHNlfHN3fG5lfG53fG58ZXxzfHcpL2kgKTtcblx0XHRcdFx0fVxuXHRcdFx0XHR0aGF0LmF4aXMgPSBheGlzICYmIGF4aXNbIDEgXSA/IGF4aXNbIDEgXSA6IFwic2VcIjtcblx0XHRcdH1cblx0XHR9ICk7XG5cblx0XHRpZiAoIG8uYXV0b0hpZGUgKSB7XG5cdFx0XHR0aGlzLl9oYW5kbGVzLmhpZGUoKTtcblx0XHRcdHRoaXMuX2FkZENsYXNzKCBcInVpLXJlc2l6YWJsZS1hdXRvaGlkZVwiICk7XG5cdFx0fVxuXHR9LFxuXG5cdF9yZW1vdmVIYW5kbGVzOiBmdW5jdGlvbigpIHtcblx0XHR0aGlzLl9oYW5kbGVzLnJlbW92ZSgpO1xuXHR9LFxuXG5cdF9tb3VzZUNhcHR1cmU6IGZ1bmN0aW9uKCBldmVudCApIHtcblx0XHR2YXIgaSwgaGFuZGxlLFxuXHRcdFx0Y2FwdHVyZSA9IGZhbHNlO1xuXG5cdFx0Zm9yICggaSBpbiB0aGlzLmhhbmRsZXMgKSB7XG5cdFx0XHRoYW5kbGUgPSAkKCB0aGlzLmhhbmRsZXNbIGkgXSApWyAwIF07XG5cdFx0XHRpZiAoIGhhbmRsZSA9PT0gZXZlbnQudGFyZ2V0IHx8ICQuY29udGFpbnMoIGhhbmRsZSwgZXZlbnQudGFyZ2V0ICkgKSB7XG5cdFx0XHRcdGNhcHR1cmUgPSB0cnVlO1xuXHRcdFx0fVxuXHRcdH1cblxuXHRcdHJldHVybiAhdGhpcy5vcHRpb25zLmRpc2FibGVkICYmIGNhcHR1cmU7XG5cdH0sXG5cblx0X21vdXNlU3RhcnQ6IGZ1bmN0aW9uKCBldmVudCApIHtcblxuXHRcdHZhciBjdXJsZWZ0LCBjdXJ0b3AsIGN1cnNvcixcblx0XHRcdG8gPSB0aGlzLm9wdGlvbnMsXG5cdFx0XHRlbCA9IHRoaXMuZWxlbWVudDtcblxuXHRcdHRoaXMucmVzaXppbmcgPSB0cnVlO1xuXG5cdFx0dGhpcy5fcmVuZGVyUHJveHkoKTtcblxuXHRcdGN1cmxlZnQgPSB0aGlzLl9udW0oIHRoaXMuaGVscGVyLmNzcyggXCJsZWZ0XCIgKSApO1xuXHRcdGN1cnRvcCA9IHRoaXMuX251bSggdGhpcy5oZWxwZXIuY3NzKCBcInRvcFwiICkgKTtcblxuXHRcdGlmICggby5jb250YWlubWVudCApIHtcblx0XHRcdGN1cmxlZnQgKz0gJCggby5jb250YWlubWVudCApLnNjcm9sbExlZnQoKSB8fCAwO1xuXHRcdFx0Y3VydG9wICs9ICQoIG8uY29udGFpbm1lbnQgKS5zY3JvbGxUb3AoKSB8fCAwO1xuXHRcdH1cblxuXHRcdHRoaXMub2Zmc2V0ID0gdGhpcy5oZWxwZXIub2Zmc2V0KCk7XG5cdFx0dGhpcy5wb3NpdGlvbiA9IHsgbGVmdDogY3VybGVmdCwgdG9wOiBjdXJ0b3AgfTtcblxuXHRcdHRoaXMuc2l6ZSA9IHRoaXMuX2hlbHBlciA/IHtcblx0XHRcdFx0d2lkdGg6IHRoaXMuaGVscGVyLndpZHRoKCksXG5cdFx0XHRcdGhlaWdodDogdGhpcy5oZWxwZXIuaGVpZ2h0KClcblx0XHRcdH0gOiB7XG5cdFx0XHRcdHdpZHRoOiBlbC53aWR0aCgpLFxuXHRcdFx0XHRoZWlnaHQ6IGVsLmhlaWdodCgpXG5cdFx0XHR9O1xuXG5cdFx0dGhpcy5vcmlnaW5hbFNpemUgPSB0aGlzLl9oZWxwZXIgPyB7XG5cdFx0XHRcdHdpZHRoOiBlbC5vdXRlcldpZHRoKCksXG5cdFx0XHRcdGhlaWdodDogZWwub3V0ZXJIZWlnaHQoKVxuXHRcdFx0fSA6IHtcblx0XHRcdFx0d2lkdGg6IGVsLndpZHRoKCksXG5cdFx0XHRcdGhlaWdodDogZWwuaGVpZ2h0KClcblx0XHRcdH07XG5cblx0XHR0aGlzLnNpemVEaWZmID0ge1xuXHRcdFx0d2lkdGg6IGVsLm91dGVyV2lkdGgoKSAtIGVsLndpZHRoKCksXG5cdFx0XHRoZWlnaHQ6IGVsLm91dGVySGVpZ2h0KCkgLSBlbC5oZWlnaHQoKVxuXHRcdH07XG5cblx0XHR0aGlzLm9yaWdpbmFsUG9zaXRpb24gPSB7IGxlZnQ6IGN1cmxlZnQsIHRvcDogY3VydG9wIH07XG5cdFx0dGhpcy5vcmlnaW5hbE1vdXNlUG9zaXRpb24gPSB7IGxlZnQ6IGV2ZW50LnBhZ2VYLCB0b3A6IGV2ZW50LnBhZ2VZIH07XG5cblx0XHR0aGlzLmFzcGVjdFJhdGlvID0gKCB0eXBlb2Ygby5hc3BlY3RSYXRpbyA9PT0gXCJudW1iZXJcIiApID9cblx0XHRcdG8uYXNwZWN0UmF0aW8gOlxuXHRcdFx0KCAoIHRoaXMub3JpZ2luYWxTaXplLndpZHRoIC8gdGhpcy5vcmlnaW5hbFNpemUuaGVpZ2h0ICkgfHwgMSApO1xuXG5cdFx0Y3Vyc29yID0gJCggXCIudWktcmVzaXphYmxlLVwiICsgdGhpcy5heGlzICkuY3NzKCBcImN1cnNvclwiICk7XG5cdFx0JCggXCJib2R5XCIgKS5jc3MoIFwiY3Vyc29yXCIsIGN1cnNvciA9PT0gXCJhdXRvXCIgPyB0aGlzLmF4aXMgKyBcIi1yZXNpemVcIiA6IGN1cnNvciApO1xuXG5cdFx0dGhpcy5fYWRkQ2xhc3MoIFwidWktcmVzaXphYmxlLXJlc2l6aW5nXCIgKTtcblx0XHR0aGlzLl9wcm9wYWdhdGUoIFwic3RhcnRcIiwgZXZlbnQgKTtcblx0XHRyZXR1cm4gdHJ1ZTtcblx0fSxcblxuXHRfbW91c2VEcmFnOiBmdW5jdGlvbiggZXZlbnQgKSB7XG5cblx0XHR2YXIgZGF0YSwgcHJvcHMsXG5cdFx0XHRzbXAgPSB0aGlzLm9yaWdpbmFsTW91c2VQb3NpdGlvbixcblx0XHRcdGEgPSB0aGlzLmF4aXMsXG5cdFx0XHRkeCA9ICggZXZlbnQucGFnZVggLSBzbXAubGVmdCApIHx8IDAsXG5cdFx0XHRkeSA9ICggZXZlbnQucGFnZVkgLSBzbXAudG9wICkgfHwgMCxcblx0XHRcdHRyaWdnZXIgPSB0aGlzLl9jaGFuZ2VbIGEgXTtcblxuXHRcdHRoaXMuX3VwZGF0ZVByZXZQcm9wZXJ0aWVzKCk7XG5cblx0XHRpZiAoICF0cmlnZ2VyICkge1xuXHRcdFx0cmV0dXJuIGZhbHNlO1xuXHRcdH1cblxuXHRcdGRhdGEgPSB0cmlnZ2VyLmFwcGx5KCB0aGlzLCBbIGV2ZW50LCBkeCwgZHkgXSApO1xuXG5cdFx0dGhpcy5fdXBkYXRlVmlydHVhbEJvdW5kYXJpZXMoIGV2ZW50LnNoaWZ0S2V5ICk7XG5cdFx0aWYgKCB0aGlzLl9hc3BlY3RSYXRpbyB8fCBldmVudC5zaGlmdEtleSApIHtcblx0XHRcdGRhdGEgPSB0aGlzLl91cGRhdGVSYXRpbyggZGF0YSwgZXZlbnQgKTtcblx0XHR9XG5cblx0XHRkYXRhID0gdGhpcy5fcmVzcGVjdFNpemUoIGRhdGEsIGV2ZW50ICk7XG5cblx0XHR0aGlzLl91cGRhdGVDYWNoZSggZGF0YSApO1xuXG5cdFx0dGhpcy5fcHJvcGFnYXRlKCBcInJlc2l6ZVwiLCBldmVudCApO1xuXG5cdFx0cHJvcHMgPSB0aGlzLl9hcHBseUNoYW5nZXMoKTtcblxuXHRcdGlmICggIXRoaXMuX2hlbHBlciAmJiB0aGlzLl9wcm9wb3J0aW9uYWxseVJlc2l6ZUVsZW1lbnRzLmxlbmd0aCApIHtcblx0XHRcdHRoaXMuX3Byb3BvcnRpb25hbGx5UmVzaXplKCk7XG5cdFx0fVxuXG5cdFx0aWYgKCAhJC5pc0VtcHR5T2JqZWN0KCBwcm9wcyApICkge1xuXHRcdFx0dGhpcy5fdXBkYXRlUHJldlByb3BlcnRpZXMoKTtcblx0XHRcdHRoaXMuX3RyaWdnZXIoIFwicmVzaXplXCIsIGV2ZW50LCB0aGlzLnVpKCkgKTtcblx0XHRcdHRoaXMuX2FwcGx5Q2hhbmdlcygpO1xuXHRcdH1cblxuXHRcdHJldHVybiBmYWxzZTtcblx0fSxcblxuXHRfbW91c2VTdG9wOiBmdW5jdGlvbiggZXZlbnQgKSB7XG5cblx0XHR0aGlzLnJlc2l6aW5nID0gZmFsc2U7XG5cdFx0dmFyIHByLCBpc3RhLCBzb2Zmc2V0aCwgc29mZnNldHcsIHMsIGxlZnQsIHRvcCxcblx0XHRcdG8gPSB0aGlzLm9wdGlvbnMsIHRoYXQgPSB0aGlzO1xuXG5cdFx0aWYgKCB0aGlzLl9oZWxwZXIgKSB7XG5cblx0XHRcdHByID0gdGhpcy5fcHJvcG9ydGlvbmFsbHlSZXNpemVFbGVtZW50cztcblx0XHRcdGlzdGEgPSBwci5sZW5ndGggJiYgKCAvdGV4dGFyZWEvaSApLnRlc3QoIHByWyAwIF0ubm9kZU5hbWUgKTtcblx0XHRcdHNvZmZzZXRoID0gaXN0YSAmJiB0aGlzLl9oYXNTY3JvbGwoIHByWyAwIF0sIFwibGVmdFwiICkgPyAwIDogdGhhdC5zaXplRGlmZi5oZWlnaHQ7XG5cdFx0XHRzb2Zmc2V0dyA9IGlzdGEgPyAwIDogdGhhdC5zaXplRGlmZi53aWR0aDtcblxuXHRcdFx0cyA9IHtcblx0XHRcdFx0d2lkdGg6ICggdGhhdC5oZWxwZXIud2lkdGgoKSAgLSBzb2Zmc2V0dyApLFxuXHRcdFx0XHRoZWlnaHQ6ICggdGhhdC5oZWxwZXIuaGVpZ2h0KCkgLSBzb2Zmc2V0aCApXG5cdFx0XHR9O1xuXHRcdFx0bGVmdCA9ICggcGFyc2VGbG9hdCggdGhhdC5lbGVtZW50LmNzcyggXCJsZWZ0XCIgKSApICtcblx0XHRcdFx0KCB0aGF0LnBvc2l0aW9uLmxlZnQgLSB0aGF0Lm9yaWdpbmFsUG9zaXRpb24ubGVmdCApICkgfHwgbnVsbDtcblx0XHRcdHRvcCA9ICggcGFyc2VGbG9hdCggdGhhdC5lbGVtZW50LmNzcyggXCJ0b3BcIiApICkgK1xuXHRcdFx0XHQoIHRoYXQucG9zaXRpb24udG9wIC0gdGhhdC5vcmlnaW5hbFBvc2l0aW9uLnRvcCApICkgfHwgbnVsbDtcblxuXHRcdFx0aWYgKCAhby5hbmltYXRlICkge1xuXHRcdFx0XHR0aGlzLmVsZW1lbnQuY3NzKCAkLmV4dGVuZCggcywgeyB0b3A6IHRvcCwgbGVmdDogbGVmdCB9ICkgKTtcblx0XHRcdH1cblxuXHRcdFx0dGhhdC5oZWxwZXIuaGVpZ2h0KCB0aGF0LnNpemUuaGVpZ2h0ICk7XG5cdFx0XHR0aGF0LmhlbHBlci53aWR0aCggdGhhdC5zaXplLndpZHRoICk7XG5cblx0XHRcdGlmICggdGhpcy5faGVscGVyICYmICFvLmFuaW1hdGUgKSB7XG5cdFx0XHRcdHRoaXMuX3Byb3BvcnRpb25hbGx5UmVzaXplKCk7XG5cdFx0XHR9XG5cdFx0fVxuXG5cdFx0JCggXCJib2R5XCIgKS5jc3MoIFwiY3Vyc29yXCIsIFwiYXV0b1wiICk7XG5cblx0XHR0aGlzLl9yZW1vdmVDbGFzcyggXCJ1aS1yZXNpemFibGUtcmVzaXppbmdcIiApO1xuXG5cdFx0dGhpcy5fcHJvcGFnYXRlKCBcInN0b3BcIiwgZXZlbnQgKTtcblxuXHRcdGlmICggdGhpcy5faGVscGVyICkge1xuXHRcdFx0dGhpcy5oZWxwZXIucmVtb3ZlKCk7XG5cdFx0fVxuXG5cdFx0cmV0dXJuIGZhbHNlO1xuXG5cdH0sXG5cblx0X3VwZGF0ZVByZXZQcm9wZXJ0aWVzOiBmdW5jdGlvbigpIHtcblx0XHR0aGlzLnByZXZQb3NpdGlvbiA9IHtcblx0XHRcdHRvcDogdGhpcy5wb3NpdGlvbi50b3AsXG5cdFx0XHRsZWZ0OiB0aGlzLnBvc2l0aW9uLmxlZnRcblx0XHR9O1xuXHRcdHRoaXMucHJldlNpemUgPSB7XG5cdFx0XHR3aWR0aDogdGhpcy5zaXplLndpZHRoLFxuXHRcdFx0aGVpZ2h0OiB0aGlzLnNpemUuaGVpZ2h0XG5cdFx0fTtcblx0fSxcblxuXHRfYXBwbHlDaGFuZ2VzOiBmdW5jdGlvbigpIHtcblx0XHR2YXIgcHJvcHMgPSB7fTtcblxuXHRcdGlmICggdGhpcy5wb3NpdGlvbi50b3AgIT09IHRoaXMucHJldlBvc2l0aW9uLnRvcCApIHtcblx0XHRcdHByb3BzLnRvcCA9IHRoaXMucG9zaXRpb24udG9wICsgXCJweFwiO1xuXHRcdH1cblx0XHRpZiAoIHRoaXMucG9zaXRpb24ubGVmdCAhPT0gdGhpcy5wcmV2UG9zaXRpb24ubGVmdCApIHtcblx0XHRcdHByb3BzLmxlZnQgPSB0aGlzLnBvc2l0aW9uLmxlZnQgKyBcInB4XCI7XG5cdFx0fVxuXHRcdGlmICggdGhpcy5zaXplLndpZHRoICE9PSB0aGlzLnByZXZTaXplLndpZHRoICkge1xuXHRcdFx0cHJvcHMud2lkdGggPSB0aGlzLnNpemUud2lkdGggKyBcInB4XCI7XG5cdFx0fVxuXHRcdGlmICggdGhpcy5zaXplLmhlaWdodCAhPT0gdGhpcy5wcmV2U2l6ZS5oZWlnaHQgKSB7XG5cdFx0XHRwcm9wcy5oZWlnaHQgPSB0aGlzLnNpemUuaGVpZ2h0ICsgXCJweFwiO1xuXHRcdH1cblxuXHRcdHRoaXMuaGVscGVyLmNzcyggcHJvcHMgKTtcblxuXHRcdHJldHVybiBwcm9wcztcblx0fSxcblxuXHRfdXBkYXRlVmlydHVhbEJvdW5kYXJpZXM6IGZ1bmN0aW9uKCBmb3JjZUFzcGVjdFJhdGlvICkge1xuXHRcdHZhciBwTWluV2lkdGgsIHBNYXhXaWR0aCwgcE1pbkhlaWdodCwgcE1heEhlaWdodCwgYixcblx0XHRcdG8gPSB0aGlzLm9wdGlvbnM7XG5cblx0XHRiID0ge1xuXHRcdFx0bWluV2lkdGg6IHRoaXMuX2lzTnVtYmVyKCBvLm1pbldpZHRoICkgPyBvLm1pbldpZHRoIDogMCxcblx0XHRcdG1heFdpZHRoOiB0aGlzLl9pc051bWJlciggby5tYXhXaWR0aCApID8gby5tYXhXaWR0aCA6IEluZmluaXR5LFxuXHRcdFx0bWluSGVpZ2h0OiB0aGlzLl9pc051bWJlciggby5taW5IZWlnaHQgKSA/IG8ubWluSGVpZ2h0IDogMCxcblx0XHRcdG1heEhlaWdodDogdGhpcy5faXNOdW1iZXIoIG8ubWF4SGVpZ2h0ICkgPyBvLm1heEhlaWdodCA6IEluZmluaXR5XG5cdFx0fTtcblxuXHRcdGlmICggdGhpcy5fYXNwZWN0UmF0aW8gfHwgZm9yY2VBc3BlY3RSYXRpbyApIHtcblx0XHRcdHBNaW5XaWR0aCA9IGIubWluSGVpZ2h0ICogdGhpcy5hc3BlY3RSYXRpbztcblx0XHRcdHBNaW5IZWlnaHQgPSBiLm1pbldpZHRoIC8gdGhpcy5hc3BlY3RSYXRpbztcblx0XHRcdHBNYXhXaWR0aCA9IGIubWF4SGVpZ2h0ICogdGhpcy5hc3BlY3RSYXRpbztcblx0XHRcdHBNYXhIZWlnaHQgPSBiLm1heFdpZHRoIC8gdGhpcy5hc3BlY3RSYXRpbztcblxuXHRcdFx0aWYgKCBwTWluV2lkdGggPiBiLm1pbldpZHRoICkge1xuXHRcdFx0XHRiLm1pbldpZHRoID0gcE1pbldpZHRoO1xuXHRcdFx0fVxuXHRcdFx0aWYgKCBwTWluSGVpZ2h0ID4gYi5taW5IZWlnaHQgKSB7XG5cdFx0XHRcdGIubWluSGVpZ2h0ID0gcE1pbkhlaWdodDtcblx0XHRcdH1cblx0XHRcdGlmICggcE1heFdpZHRoIDwgYi5tYXhXaWR0aCApIHtcblx0XHRcdFx0Yi5tYXhXaWR0aCA9IHBNYXhXaWR0aDtcblx0XHRcdH1cblx0XHRcdGlmICggcE1heEhlaWdodCA8IGIubWF4SGVpZ2h0ICkge1xuXHRcdFx0XHRiLm1heEhlaWdodCA9IHBNYXhIZWlnaHQ7XG5cdFx0XHR9XG5cdFx0fVxuXHRcdHRoaXMuX3ZCb3VuZGFyaWVzID0gYjtcblx0fSxcblxuXHRfdXBkYXRlQ2FjaGU6IGZ1bmN0aW9uKCBkYXRhICkge1xuXHRcdHRoaXMub2Zmc2V0ID0gdGhpcy5oZWxwZXIub2Zmc2V0KCk7XG5cdFx0aWYgKCB0aGlzLl9pc051bWJlciggZGF0YS5sZWZ0ICkgKSB7XG5cdFx0XHR0aGlzLnBvc2l0aW9uLmxlZnQgPSBkYXRhLmxlZnQ7XG5cdFx0fVxuXHRcdGlmICggdGhpcy5faXNOdW1iZXIoIGRhdGEudG9wICkgKSB7XG5cdFx0XHR0aGlzLnBvc2l0aW9uLnRvcCA9IGRhdGEudG9wO1xuXHRcdH1cblx0XHRpZiAoIHRoaXMuX2lzTnVtYmVyKCBkYXRhLmhlaWdodCApICkge1xuXHRcdFx0dGhpcy5zaXplLmhlaWdodCA9IGRhdGEuaGVpZ2h0O1xuXHRcdH1cblx0XHRpZiAoIHRoaXMuX2lzTnVtYmVyKCBkYXRhLndpZHRoICkgKSB7XG5cdFx0XHR0aGlzLnNpemUud2lkdGggPSBkYXRhLndpZHRoO1xuXHRcdH1cblx0fSxcblxuXHRfdXBkYXRlUmF0aW86IGZ1bmN0aW9uKCBkYXRhICkge1xuXG5cdFx0dmFyIGNwb3MgPSB0aGlzLnBvc2l0aW9uLFxuXHRcdFx0Y3NpemUgPSB0aGlzLnNpemUsXG5cdFx0XHRhID0gdGhpcy5heGlzO1xuXG5cdFx0aWYgKCB0aGlzLl9pc051bWJlciggZGF0YS5oZWlnaHQgKSApIHtcblx0XHRcdGRhdGEud2lkdGggPSAoIGRhdGEuaGVpZ2h0ICogdGhpcy5hc3BlY3RSYXRpbyApO1xuXHRcdH0gZWxzZSBpZiAoIHRoaXMuX2lzTnVtYmVyKCBkYXRhLndpZHRoICkgKSB7XG5cdFx0XHRkYXRhLmhlaWdodCA9ICggZGF0YS53aWR0aCAvIHRoaXMuYXNwZWN0UmF0aW8gKTtcblx0XHR9XG5cblx0XHRpZiAoIGEgPT09IFwic3dcIiApIHtcblx0XHRcdGRhdGEubGVmdCA9IGNwb3MubGVmdCArICggY3NpemUud2lkdGggLSBkYXRhLndpZHRoICk7XG5cdFx0XHRkYXRhLnRvcCA9IG51bGw7XG5cdFx0fVxuXHRcdGlmICggYSA9PT0gXCJud1wiICkge1xuXHRcdFx0ZGF0YS50b3AgPSBjcG9zLnRvcCArICggY3NpemUuaGVpZ2h0IC0gZGF0YS5oZWlnaHQgKTtcblx0XHRcdGRhdGEubGVmdCA9IGNwb3MubGVmdCArICggY3NpemUud2lkdGggLSBkYXRhLndpZHRoICk7XG5cdFx0fVxuXG5cdFx0cmV0dXJuIGRhdGE7XG5cdH0sXG5cblx0X3Jlc3BlY3RTaXplOiBmdW5jdGlvbiggZGF0YSApIHtcblxuXHRcdHZhciBvID0gdGhpcy5fdkJvdW5kYXJpZXMsXG5cdFx0XHRhID0gdGhpcy5heGlzLFxuXHRcdFx0aXNtYXh3ID0gdGhpcy5faXNOdW1iZXIoIGRhdGEud2lkdGggKSAmJiBvLm1heFdpZHRoICYmICggby5tYXhXaWR0aCA8IGRhdGEud2lkdGggKSxcblx0XHRcdGlzbWF4aCA9IHRoaXMuX2lzTnVtYmVyKCBkYXRhLmhlaWdodCApICYmIG8ubWF4SGVpZ2h0ICYmICggby5tYXhIZWlnaHQgPCBkYXRhLmhlaWdodCApLFxuXHRcdFx0aXNtaW53ID0gdGhpcy5faXNOdW1iZXIoIGRhdGEud2lkdGggKSAmJiBvLm1pbldpZHRoICYmICggby5taW5XaWR0aCA+IGRhdGEud2lkdGggKSxcblx0XHRcdGlzbWluaCA9IHRoaXMuX2lzTnVtYmVyKCBkYXRhLmhlaWdodCApICYmIG8ubWluSGVpZ2h0ICYmICggby5taW5IZWlnaHQgPiBkYXRhLmhlaWdodCApLFxuXHRcdFx0ZHcgPSB0aGlzLm9yaWdpbmFsUG9zaXRpb24ubGVmdCArIHRoaXMub3JpZ2luYWxTaXplLndpZHRoLFxuXHRcdFx0ZGggPSB0aGlzLm9yaWdpbmFsUG9zaXRpb24udG9wICsgdGhpcy5vcmlnaW5hbFNpemUuaGVpZ2h0LFxuXHRcdFx0Y3cgPSAvc3d8bnd8dy8udGVzdCggYSApLCBjaCA9IC9ud3xuZXxuLy50ZXN0KCBhICk7XG5cdFx0aWYgKCBpc21pbncgKSB7XG5cdFx0XHRkYXRhLndpZHRoID0gby5taW5XaWR0aDtcblx0XHR9XG5cdFx0aWYgKCBpc21pbmggKSB7XG5cdFx0XHRkYXRhLmhlaWdodCA9IG8ubWluSGVpZ2h0O1xuXHRcdH1cblx0XHRpZiAoIGlzbWF4dyApIHtcblx0XHRcdGRhdGEud2lkdGggPSBvLm1heFdpZHRoO1xuXHRcdH1cblx0XHRpZiAoIGlzbWF4aCApIHtcblx0XHRcdGRhdGEuaGVpZ2h0ID0gby5tYXhIZWlnaHQ7XG5cdFx0fVxuXG5cdFx0aWYgKCBpc21pbncgJiYgY3cgKSB7XG5cdFx0XHRkYXRhLmxlZnQgPSBkdyAtIG8ubWluV2lkdGg7XG5cdFx0fVxuXHRcdGlmICggaXNtYXh3ICYmIGN3ICkge1xuXHRcdFx0ZGF0YS5sZWZ0ID0gZHcgLSBvLm1heFdpZHRoO1xuXHRcdH1cblx0XHRpZiAoIGlzbWluaCAmJiBjaCApIHtcblx0XHRcdGRhdGEudG9wID0gZGggLSBvLm1pbkhlaWdodDtcblx0XHR9XG5cdFx0aWYgKCBpc21heGggJiYgY2ggKSB7XG5cdFx0XHRkYXRhLnRvcCA9IGRoIC0gby5tYXhIZWlnaHQ7XG5cdFx0fVxuXG5cdFx0Ly8gRml4aW5nIGp1bXAgZXJyb3Igb24gdG9wL2xlZnQgLSBidWcgIzIzMzBcblx0XHRpZiAoICFkYXRhLndpZHRoICYmICFkYXRhLmhlaWdodCAmJiAhZGF0YS5sZWZ0ICYmIGRhdGEudG9wICkge1xuXHRcdFx0ZGF0YS50b3AgPSBudWxsO1xuXHRcdH0gZWxzZSBpZiAoICFkYXRhLndpZHRoICYmICFkYXRhLmhlaWdodCAmJiAhZGF0YS50b3AgJiYgZGF0YS5sZWZ0ICkge1xuXHRcdFx0ZGF0YS5sZWZ0ID0gbnVsbDtcblx0XHR9XG5cblx0XHRyZXR1cm4gZGF0YTtcblx0fSxcblxuXHRfZ2V0UGFkZGluZ1BsdXNCb3JkZXJEaW1lbnNpb25zOiBmdW5jdGlvbiggZWxlbWVudCApIHtcblx0XHR2YXIgaSA9IDAsXG5cdFx0XHR3aWR0aHMgPSBbXSxcblx0XHRcdGJvcmRlcnMgPSBbXG5cdFx0XHRcdGVsZW1lbnQuY3NzKCBcImJvcmRlclRvcFdpZHRoXCIgKSxcblx0XHRcdFx0ZWxlbWVudC5jc3MoIFwiYm9yZGVyUmlnaHRXaWR0aFwiICksXG5cdFx0XHRcdGVsZW1lbnQuY3NzKCBcImJvcmRlckJvdHRvbVdpZHRoXCIgKSxcblx0XHRcdFx0ZWxlbWVudC5jc3MoIFwiYm9yZGVyTGVmdFdpZHRoXCIgKVxuXHRcdFx0XSxcblx0XHRcdHBhZGRpbmdzID0gW1xuXHRcdFx0XHRlbGVtZW50LmNzcyggXCJwYWRkaW5nVG9wXCIgKSxcblx0XHRcdFx0ZWxlbWVudC5jc3MoIFwicGFkZGluZ1JpZ2h0XCIgKSxcblx0XHRcdFx0ZWxlbWVudC5jc3MoIFwicGFkZGluZ0JvdHRvbVwiICksXG5cdFx0XHRcdGVsZW1lbnQuY3NzKCBcInBhZGRpbmdMZWZ0XCIgKVxuXHRcdFx0XTtcblxuXHRcdGZvciAoIDsgaSA8IDQ7IGkrKyApIHtcblx0XHRcdHdpZHRoc1sgaSBdID0gKCBwYXJzZUZsb2F0KCBib3JkZXJzWyBpIF0gKSB8fCAwICk7XG5cdFx0XHR3aWR0aHNbIGkgXSArPSAoIHBhcnNlRmxvYXQoIHBhZGRpbmdzWyBpIF0gKSB8fCAwICk7XG5cdFx0fVxuXG5cdFx0cmV0dXJuIHtcblx0XHRcdGhlaWdodDogd2lkdGhzWyAwIF0gKyB3aWR0aHNbIDIgXSxcblx0XHRcdHdpZHRoOiB3aWR0aHNbIDEgXSArIHdpZHRoc1sgMyBdXG5cdFx0fTtcblx0fSxcblxuXHRfcHJvcG9ydGlvbmFsbHlSZXNpemU6IGZ1bmN0aW9uKCkge1xuXG5cdFx0aWYgKCAhdGhpcy5fcHJvcG9ydGlvbmFsbHlSZXNpemVFbGVtZW50cy5sZW5ndGggKSB7XG5cdFx0XHRyZXR1cm47XG5cdFx0fVxuXG5cdFx0dmFyIHByZWwsXG5cdFx0XHRpID0gMCxcblx0XHRcdGVsZW1lbnQgPSB0aGlzLmhlbHBlciB8fCB0aGlzLmVsZW1lbnQ7XG5cblx0XHRmb3IgKCA7IGkgPCB0aGlzLl9wcm9wb3J0aW9uYWxseVJlc2l6ZUVsZW1lbnRzLmxlbmd0aDsgaSsrICkge1xuXG5cdFx0XHRwcmVsID0gdGhpcy5fcHJvcG9ydGlvbmFsbHlSZXNpemVFbGVtZW50c1sgaSBdO1xuXG5cdFx0XHQvLyBUT0RPOiBTZWVtcyBsaWtlIGEgYnVnIHRvIGNhY2hlIHRoaXMub3V0ZXJEaW1lbnNpb25zXG5cdFx0XHQvLyBjb25zaWRlcmluZyB0aGF0IHdlIGFyZSBpbiBhIGxvb3AuXG5cdFx0XHRpZiAoICF0aGlzLm91dGVyRGltZW5zaW9ucyApIHtcblx0XHRcdFx0dGhpcy5vdXRlckRpbWVuc2lvbnMgPSB0aGlzLl9nZXRQYWRkaW5nUGx1c0JvcmRlckRpbWVuc2lvbnMoIHByZWwgKTtcblx0XHRcdH1cblxuXHRcdFx0cHJlbC5jc3MoIHtcblx0XHRcdFx0aGVpZ2h0OiAoIGVsZW1lbnQuaGVpZ2h0KCkgLSB0aGlzLm91dGVyRGltZW5zaW9ucy5oZWlnaHQgKSB8fCAwLFxuXHRcdFx0XHR3aWR0aDogKCBlbGVtZW50LndpZHRoKCkgLSB0aGlzLm91dGVyRGltZW5zaW9ucy53aWR0aCApIHx8IDBcblx0XHRcdH0gKTtcblxuXHRcdH1cblxuXHR9LFxuXG5cdF9yZW5kZXJQcm94eTogZnVuY3Rpb24oKSB7XG5cblx0XHR2YXIgZWwgPSB0aGlzLmVsZW1lbnQsIG8gPSB0aGlzLm9wdGlvbnM7XG5cdFx0dGhpcy5lbGVtZW50T2Zmc2V0ID0gZWwub2Zmc2V0KCk7XG5cblx0XHRpZiAoIHRoaXMuX2hlbHBlciApIHtcblxuXHRcdFx0dGhpcy5oZWxwZXIgPSB0aGlzLmhlbHBlciB8fCAkKCBcIjxkaXYgc3R5bGU9J292ZXJmbG93OmhpZGRlbjsnPjwvZGl2PlwiICk7XG5cblx0XHRcdHRoaXMuX2FkZENsYXNzKCB0aGlzLmhlbHBlciwgdGhpcy5faGVscGVyICk7XG5cdFx0XHR0aGlzLmhlbHBlci5jc3MoIHtcblx0XHRcdFx0d2lkdGg6IHRoaXMuZWxlbWVudC5vdXRlcldpZHRoKCksXG5cdFx0XHRcdGhlaWdodDogdGhpcy5lbGVtZW50Lm91dGVySGVpZ2h0KCksXG5cdFx0XHRcdHBvc2l0aW9uOiBcImFic29sdXRlXCIsXG5cdFx0XHRcdGxlZnQ6IHRoaXMuZWxlbWVudE9mZnNldC5sZWZ0ICsgXCJweFwiLFxuXHRcdFx0XHR0b3A6IHRoaXMuZWxlbWVudE9mZnNldC50b3AgKyBcInB4XCIsXG5cdFx0XHRcdHpJbmRleDogKytvLnpJbmRleCAvL1RPRE86IERvbid0IG1vZGlmeSBvcHRpb25cblx0XHRcdH0gKTtcblxuXHRcdFx0dGhpcy5oZWxwZXJcblx0XHRcdFx0LmFwcGVuZFRvKCBcImJvZHlcIiApXG5cdFx0XHRcdC5kaXNhYmxlU2VsZWN0aW9uKCk7XG5cblx0XHR9IGVsc2Uge1xuXHRcdFx0dGhpcy5oZWxwZXIgPSB0aGlzLmVsZW1lbnQ7XG5cdFx0fVxuXG5cdH0sXG5cblx0X2NoYW5nZToge1xuXHRcdGU6IGZ1bmN0aW9uKCBldmVudCwgZHggKSB7XG5cdFx0XHRyZXR1cm4geyB3aWR0aDogdGhpcy5vcmlnaW5hbFNpemUud2lkdGggKyBkeCB9O1xuXHRcdH0sXG5cdFx0dzogZnVuY3Rpb24oIGV2ZW50LCBkeCApIHtcblx0XHRcdHZhciBjcyA9IHRoaXMub3JpZ2luYWxTaXplLCBzcCA9IHRoaXMub3JpZ2luYWxQb3NpdGlvbjtcblx0XHRcdHJldHVybiB7IGxlZnQ6IHNwLmxlZnQgKyBkeCwgd2lkdGg6IGNzLndpZHRoIC0gZHggfTtcblx0XHR9LFxuXHRcdG46IGZ1bmN0aW9uKCBldmVudCwgZHgsIGR5ICkge1xuXHRcdFx0dmFyIGNzID0gdGhpcy5vcmlnaW5hbFNpemUsIHNwID0gdGhpcy5vcmlnaW5hbFBvc2l0aW9uO1xuXHRcdFx0cmV0dXJuIHsgdG9wOiBzcC50b3AgKyBkeSwgaGVpZ2h0OiBjcy5oZWlnaHQgLSBkeSB9O1xuXHRcdH0sXG5cdFx0czogZnVuY3Rpb24oIGV2ZW50LCBkeCwgZHkgKSB7XG5cdFx0XHRyZXR1cm4geyBoZWlnaHQ6IHRoaXMub3JpZ2luYWxTaXplLmhlaWdodCArIGR5IH07XG5cdFx0fSxcblx0XHRzZTogZnVuY3Rpb24oIGV2ZW50LCBkeCwgZHkgKSB7XG5cdFx0XHRyZXR1cm4gJC5leHRlbmQoIHRoaXMuX2NoYW5nZS5zLmFwcGx5KCB0aGlzLCBhcmd1bWVudHMgKSxcblx0XHRcdFx0dGhpcy5fY2hhbmdlLmUuYXBwbHkoIHRoaXMsIFsgZXZlbnQsIGR4LCBkeSBdICkgKTtcblx0XHR9LFxuXHRcdHN3OiBmdW5jdGlvbiggZXZlbnQsIGR4LCBkeSApIHtcblx0XHRcdHJldHVybiAkLmV4dGVuZCggdGhpcy5fY2hhbmdlLnMuYXBwbHkoIHRoaXMsIGFyZ3VtZW50cyApLFxuXHRcdFx0XHR0aGlzLl9jaGFuZ2Uudy5hcHBseSggdGhpcywgWyBldmVudCwgZHgsIGR5IF0gKSApO1xuXHRcdH0sXG5cdFx0bmU6IGZ1bmN0aW9uKCBldmVudCwgZHgsIGR5ICkge1xuXHRcdFx0cmV0dXJuICQuZXh0ZW5kKCB0aGlzLl9jaGFuZ2Uubi5hcHBseSggdGhpcywgYXJndW1lbnRzICksXG5cdFx0XHRcdHRoaXMuX2NoYW5nZS5lLmFwcGx5KCB0aGlzLCBbIGV2ZW50LCBkeCwgZHkgXSApICk7XG5cdFx0fSxcblx0XHRudzogZnVuY3Rpb24oIGV2ZW50LCBkeCwgZHkgKSB7XG5cdFx0XHRyZXR1cm4gJC5leHRlbmQoIHRoaXMuX2NoYW5nZS5uLmFwcGx5KCB0aGlzLCBhcmd1bWVudHMgKSxcblx0XHRcdFx0dGhpcy5fY2hhbmdlLncuYXBwbHkoIHRoaXMsIFsgZXZlbnQsIGR4LCBkeSBdICkgKTtcblx0XHR9XG5cdH0sXG5cblx0X3Byb3BhZ2F0ZTogZnVuY3Rpb24oIG4sIGV2ZW50ICkge1xuXHRcdCQudWkucGx1Z2luLmNhbGwoIHRoaXMsIG4sIFsgZXZlbnQsIHRoaXMudWkoKSBdICk7XG5cdFx0KCBuICE9PSBcInJlc2l6ZVwiICYmIHRoaXMuX3RyaWdnZXIoIG4sIGV2ZW50LCB0aGlzLnVpKCkgKSApO1xuXHR9LFxuXG5cdHBsdWdpbnM6IHt9LFxuXG5cdHVpOiBmdW5jdGlvbigpIHtcblx0XHRyZXR1cm4ge1xuXHRcdFx0b3JpZ2luYWxFbGVtZW50OiB0aGlzLm9yaWdpbmFsRWxlbWVudCxcblx0XHRcdGVsZW1lbnQ6IHRoaXMuZWxlbWVudCxcblx0XHRcdGhlbHBlcjogdGhpcy5oZWxwZXIsXG5cdFx0XHRwb3NpdGlvbjogdGhpcy5wb3NpdGlvbixcblx0XHRcdHNpemU6IHRoaXMuc2l6ZSxcblx0XHRcdG9yaWdpbmFsU2l6ZTogdGhpcy5vcmlnaW5hbFNpemUsXG5cdFx0XHRvcmlnaW5hbFBvc2l0aW9uOiB0aGlzLm9yaWdpbmFsUG9zaXRpb25cblx0XHR9O1xuXHR9XG5cbn0gKTtcblxuLypcbiAqIFJlc2l6YWJsZSBFeHRlbnNpb25zXG4gKi9cblxuJC51aS5wbHVnaW4uYWRkKCBcInJlc2l6YWJsZVwiLCBcImFuaW1hdGVcIiwge1xuXG5cdHN0b3A6IGZ1bmN0aW9uKCBldmVudCApIHtcblx0XHR2YXIgdGhhdCA9ICQoIHRoaXMgKS5yZXNpemFibGUoIFwiaW5zdGFuY2VcIiApLFxuXHRcdFx0byA9IHRoYXQub3B0aW9ucyxcblx0XHRcdHByID0gdGhhdC5fcHJvcG9ydGlvbmFsbHlSZXNpemVFbGVtZW50cyxcblx0XHRcdGlzdGEgPSBwci5sZW5ndGggJiYgKCAvdGV4dGFyZWEvaSApLnRlc3QoIHByWyAwIF0ubm9kZU5hbWUgKSxcblx0XHRcdHNvZmZzZXRoID0gaXN0YSAmJiB0aGF0Ll9oYXNTY3JvbGwoIHByWyAwIF0sIFwibGVmdFwiICkgPyAwIDogdGhhdC5zaXplRGlmZi5oZWlnaHQsXG5cdFx0XHRzb2Zmc2V0dyA9IGlzdGEgPyAwIDogdGhhdC5zaXplRGlmZi53aWR0aCxcblx0XHRcdHN0eWxlID0ge1xuXHRcdFx0XHR3aWR0aDogKCB0aGF0LnNpemUud2lkdGggLSBzb2Zmc2V0dyApLFxuXHRcdFx0XHRoZWlnaHQ6ICggdGhhdC5zaXplLmhlaWdodCAtIHNvZmZzZXRoIClcblx0XHRcdH0sXG5cdFx0XHRsZWZ0ID0gKCBwYXJzZUZsb2F0KCB0aGF0LmVsZW1lbnQuY3NzKCBcImxlZnRcIiApICkgK1xuXHRcdFx0XHQoIHRoYXQucG9zaXRpb24ubGVmdCAtIHRoYXQub3JpZ2luYWxQb3NpdGlvbi5sZWZ0ICkgKSB8fCBudWxsLFxuXHRcdFx0dG9wID0gKCBwYXJzZUZsb2F0KCB0aGF0LmVsZW1lbnQuY3NzKCBcInRvcFwiICkgKSArXG5cdFx0XHRcdCggdGhhdC5wb3NpdGlvbi50b3AgLSB0aGF0Lm9yaWdpbmFsUG9zaXRpb24udG9wICkgKSB8fCBudWxsO1xuXG5cdFx0dGhhdC5lbGVtZW50LmFuaW1hdGUoXG5cdFx0XHQkLmV4dGVuZCggc3R5bGUsIHRvcCAmJiBsZWZ0ID8geyB0b3A6IHRvcCwgbGVmdDogbGVmdCB9IDoge30gKSwge1xuXHRcdFx0XHRkdXJhdGlvbjogby5hbmltYXRlRHVyYXRpb24sXG5cdFx0XHRcdGVhc2luZzogby5hbmltYXRlRWFzaW5nLFxuXHRcdFx0XHRzdGVwOiBmdW5jdGlvbigpIHtcblxuXHRcdFx0XHRcdHZhciBkYXRhID0ge1xuXHRcdFx0XHRcdFx0d2lkdGg6IHBhcnNlRmxvYXQoIHRoYXQuZWxlbWVudC5jc3MoIFwid2lkdGhcIiApICksXG5cdFx0XHRcdFx0XHRoZWlnaHQ6IHBhcnNlRmxvYXQoIHRoYXQuZWxlbWVudC5jc3MoIFwiaGVpZ2h0XCIgKSApLFxuXHRcdFx0XHRcdFx0dG9wOiBwYXJzZUZsb2F0KCB0aGF0LmVsZW1lbnQuY3NzKCBcInRvcFwiICkgKSxcblx0XHRcdFx0XHRcdGxlZnQ6IHBhcnNlRmxvYXQoIHRoYXQuZWxlbWVudC5jc3MoIFwibGVmdFwiICkgKVxuXHRcdFx0XHRcdH07XG5cblx0XHRcdFx0XHRpZiAoIHByICYmIHByLmxlbmd0aCApIHtcblx0XHRcdFx0XHRcdCQoIHByWyAwIF0gKS5jc3MoIHsgd2lkdGg6IGRhdGEud2lkdGgsIGhlaWdodDogZGF0YS5oZWlnaHQgfSApO1xuXHRcdFx0XHRcdH1cblxuXHRcdFx0XHRcdC8vIFByb3BhZ2F0aW5nIHJlc2l6ZSwgYW5kIHVwZGF0aW5nIHZhbHVlcyBmb3IgZWFjaCBhbmltYXRpb24gc3RlcFxuXHRcdFx0XHRcdHRoYXQuX3VwZGF0ZUNhY2hlKCBkYXRhICk7XG5cdFx0XHRcdFx0dGhhdC5fcHJvcGFnYXRlKCBcInJlc2l6ZVwiLCBldmVudCApO1xuXG5cdFx0XHRcdH1cblx0XHRcdH1cblx0XHQpO1xuXHR9XG5cbn0gKTtcblxuJC51aS5wbHVnaW4uYWRkKCBcInJlc2l6YWJsZVwiLCBcImNvbnRhaW5tZW50XCIsIHtcblxuXHRzdGFydDogZnVuY3Rpb24oKSB7XG5cdFx0dmFyIGVsZW1lbnQsIHAsIGNvLCBjaCwgY3csIHdpZHRoLCBoZWlnaHQsXG5cdFx0XHR0aGF0ID0gJCggdGhpcyApLnJlc2l6YWJsZSggXCJpbnN0YW5jZVwiICksXG5cdFx0XHRvID0gdGhhdC5vcHRpb25zLFxuXHRcdFx0ZWwgPSB0aGF0LmVsZW1lbnQsXG5cdFx0XHRvYyA9IG8uY29udGFpbm1lbnQsXG5cdFx0XHRjZSA9ICggb2MgaW5zdGFuY2VvZiAkICkgP1xuXHRcdFx0XHRvYy5nZXQoIDAgKSA6XG5cdFx0XHRcdCggL3BhcmVudC8udGVzdCggb2MgKSApID8gZWwucGFyZW50KCkuZ2V0KCAwICkgOiBvYztcblxuXHRcdGlmICggIWNlICkge1xuXHRcdFx0cmV0dXJuO1xuXHRcdH1cblxuXHRcdHRoYXQuY29udGFpbmVyRWxlbWVudCA9ICQoIGNlICk7XG5cblx0XHRpZiAoIC9kb2N1bWVudC8udGVzdCggb2MgKSB8fCBvYyA9PT0gZG9jdW1lbnQgKSB7XG5cdFx0XHR0aGF0LmNvbnRhaW5lck9mZnNldCA9IHtcblx0XHRcdFx0bGVmdDogMCxcblx0XHRcdFx0dG9wOiAwXG5cdFx0XHR9O1xuXHRcdFx0dGhhdC5jb250YWluZXJQb3NpdGlvbiA9IHtcblx0XHRcdFx0bGVmdDogMCxcblx0XHRcdFx0dG9wOiAwXG5cdFx0XHR9O1xuXG5cdFx0XHR0aGF0LnBhcmVudERhdGEgPSB7XG5cdFx0XHRcdGVsZW1lbnQ6ICQoIGRvY3VtZW50ICksXG5cdFx0XHRcdGxlZnQ6IDAsXG5cdFx0XHRcdHRvcDogMCxcblx0XHRcdFx0d2lkdGg6ICQoIGRvY3VtZW50ICkud2lkdGgoKSxcblx0XHRcdFx0aGVpZ2h0OiAkKCBkb2N1bWVudCApLmhlaWdodCgpIHx8IGRvY3VtZW50LmJvZHkucGFyZW50Tm9kZS5zY3JvbGxIZWlnaHRcblx0XHRcdH07XG5cdFx0fSBlbHNlIHtcblx0XHRcdGVsZW1lbnQgPSAkKCBjZSApO1xuXHRcdFx0cCA9IFtdO1xuXHRcdFx0JCggWyBcIlRvcFwiLCBcIlJpZ2h0XCIsIFwiTGVmdFwiLCBcIkJvdHRvbVwiIF0gKS5lYWNoKCBmdW5jdGlvbiggaSwgbmFtZSApIHtcblx0XHRcdFx0cFsgaSBdID0gdGhhdC5fbnVtKCBlbGVtZW50LmNzcyggXCJwYWRkaW5nXCIgKyBuYW1lICkgKTtcblx0XHRcdH0gKTtcblxuXHRcdFx0dGhhdC5jb250YWluZXJPZmZzZXQgPSBlbGVtZW50Lm9mZnNldCgpO1xuXHRcdFx0dGhhdC5jb250YWluZXJQb3NpdGlvbiA9IGVsZW1lbnQucG9zaXRpb24oKTtcblx0XHRcdHRoYXQuY29udGFpbmVyU2l6ZSA9IHtcblx0XHRcdFx0aGVpZ2h0OiAoIGVsZW1lbnQuaW5uZXJIZWlnaHQoKSAtIHBbIDMgXSApLFxuXHRcdFx0XHR3aWR0aDogKCBlbGVtZW50LmlubmVyV2lkdGgoKSAtIHBbIDEgXSApXG5cdFx0XHR9O1xuXG5cdFx0XHRjbyA9IHRoYXQuY29udGFpbmVyT2Zmc2V0O1xuXHRcdFx0Y2ggPSB0aGF0LmNvbnRhaW5lclNpemUuaGVpZ2h0O1xuXHRcdFx0Y3cgPSB0aGF0LmNvbnRhaW5lclNpemUud2lkdGg7XG5cdFx0XHR3aWR0aCA9ICggdGhhdC5faGFzU2Nyb2xsICggY2UsIFwibGVmdFwiICkgPyBjZS5zY3JvbGxXaWR0aCA6IGN3ICk7XG5cdFx0XHRoZWlnaHQgPSAoIHRoYXQuX2hhc1Njcm9sbCAoIGNlICkgPyBjZS5zY3JvbGxIZWlnaHQgOiBjaCApIDtcblxuXHRcdFx0dGhhdC5wYXJlbnREYXRhID0ge1xuXHRcdFx0XHRlbGVtZW50OiBjZSxcblx0XHRcdFx0bGVmdDogY28ubGVmdCxcblx0XHRcdFx0dG9wOiBjby50b3AsXG5cdFx0XHRcdHdpZHRoOiB3aWR0aCxcblx0XHRcdFx0aGVpZ2h0OiBoZWlnaHRcblx0XHRcdH07XG5cdFx0fVxuXHR9LFxuXG5cdHJlc2l6ZTogZnVuY3Rpb24oIGV2ZW50ICkge1xuXHRcdHZhciB3b3NldCwgaG9zZXQsIGlzUGFyZW50LCBpc09mZnNldFJlbGF0aXZlLFxuXHRcdFx0dGhhdCA9ICQoIHRoaXMgKS5yZXNpemFibGUoIFwiaW5zdGFuY2VcIiApLFxuXHRcdFx0byA9IHRoYXQub3B0aW9ucyxcblx0XHRcdGNvID0gdGhhdC5jb250YWluZXJPZmZzZXQsXG5cdFx0XHRjcCA9IHRoYXQucG9zaXRpb24sXG5cdFx0XHRwUmF0aW8gPSB0aGF0Ll9hc3BlY3RSYXRpbyB8fCBldmVudC5zaGlmdEtleSxcblx0XHRcdGNvcCA9IHtcblx0XHRcdFx0dG9wOiAwLFxuXHRcdFx0XHRsZWZ0OiAwXG5cdFx0XHR9LFxuXHRcdFx0Y2UgPSB0aGF0LmNvbnRhaW5lckVsZW1lbnQsXG5cdFx0XHRjb250aW51ZVJlc2l6ZSA9IHRydWU7XG5cblx0XHRpZiAoIGNlWyAwIF0gIT09IGRvY3VtZW50ICYmICggL3N0YXRpYy8gKS50ZXN0KCBjZS5jc3MoIFwicG9zaXRpb25cIiApICkgKSB7XG5cdFx0XHRjb3AgPSBjbztcblx0XHR9XG5cblx0XHRpZiAoIGNwLmxlZnQgPCAoIHRoYXQuX2hlbHBlciA/IGNvLmxlZnQgOiAwICkgKSB7XG5cdFx0XHR0aGF0LnNpemUud2lkdGggPSB0aGF0LnNpemUud2lkdGggK1xuXHRcdFx0XHQoIHRoYXQuX2hlbHBlciA/XG5cdFx0XHRcdFx0KCB0aGF0LnBvc2l0aW9uLmxlZnQgLSBjby5sZWZ0ICkgOlxuXHRcdFx0XHRcdCggdGhhdC5wb3NpdGlvbi5sZWZ0IC0gY29wLmxlZnQgKSApO1xuXG5cdFx0XHRpZiAoIHBSYXRpbyApIHtcblx0XHRcdFx0dGhhdC5zaXplLmhlaWdodCA9IHRoYXQuc2l6ZS53aWR0aCAvIHRoYXQuYXNwZWN0UmF0aW87XG5cdFx0XHRcdGNvbnRpbnVlUmVzaXplID0gZmFsc2U7XG5cdFx0XHR9XG5cdFx0XHR0aGF0LnBvc2l0aW9uLmxlZnQgPSBvLmhlbHBlciA/IGNvLmxlZnQgOiAwO1xuXHRcdH1cblxuXHRcdGlmICggY3AudG9wIDwgKCB0aGF0Ll9oZWxwZXIgPyBjby50b3AgOiAwICkgKSB7XG5cdFx0XHR0aGF0LnNpemUuaGVpZ2h0ID0gdGhhdC5zaXplLmhlaWdodCArXG5cdFx0XHRcdCggdGhhdC5faGVscGVyID9cblx0XHRcdFx0XHQoIHRoYXQucG9zaXRpb24udG9wIC0gY28udG9wICkgOlxuXHRcdFx0XHRcdHRoYXQucG9zaXRpb24udG9wICk7XG5cblx0XHRcdGlmICggcFJhdGlvICkge1xuXHRcdFx0XHR0aGF0LnNpemUud2lkdGggPSB0aGF0LnNpemUuaGVpZ2h0ICogdGhhdC5hc3BlY3RSYXRpbztcblx0XHRcdFx0Y29udGludWVSZXNpemUgPSBmYWxzZTtcblx0XHRcdH1cblx0XHRcdHRoYXQucG9zaXRpb24udG9wID0gdGhhdC5faGVscGVyID8gY28udG9wIDogMDtcblx0XHR9XG5cblx0XHRpc1BhcmVudCA9IHRoYXQuY29udGFpbmVyRWxlbWVudC5nZXQoIDAgKSA9PT0gdGhhdC5lbGVtZW50LnBhcmVudCgpLmdldCggMCApO1xuXHRcdGlzT2Zmc2V0UmVsYXRpdmUgPSAvcmVsYXRpdmV8YWJzb2x1dGUvLnRlc3QoIHRoYXQuY29udGFpbmVyRWxlbWVudC5jc3MoIFwicG9zaXRpb25cIiApICk7XG5cblx0XHRpZiAoIGlzUGFyZW50ICYmIGlzT2Zmc2V0UmVsYXRpdmUgKSB7XG5cdFx0XHR0aGF0Lm9mZnNldC5sZWZ0ID0gdGhhdC5wYXJlbnREYXRhLmxlZnQgKyB0aGF0LnBvc2l0aW9uLmxlZnQ7XG5cdFx0XHR0aGF0Lm9mZnNldC50b3AgPSB0aGF0LnBhcmVudERhdGEudG9wICsgdGhhdC5wb3NpdGlvbi50b3A7XG5cdFx0fSBlbHNlIHtcblx0XHRcdHRoYXQub2Zmc2V0LmxlZnQgPSB0aGF0LmVsZW1lbnQub2Zmc2V0KCkubGVmdDtcblx0XHRcdHRoYXQub2Zmc2V0LnRvcCA9IHRoYXQuZWxlbWVudC5vZmZzZXQoKS50b3A7XG5cdFx0fVxuXG5cdFx0d29zZXQgPSBNYXRoLmFicyggdGhhdC5zaXplRGlmZi53aWR0aCArXG5cdFx0XHQoIHRoYXQuX2hlbHBlciA/XG5cdFx0XHRcdHRoYXQub2Zmc2V0LmxlZnQgLSBjb3AubGVmdCA6XG5cdFx0XHRcdCggdGhhdC5vZmZzZXQubGVmdCAtIGNvLmxlZnQgKSApICk7XG5cblx0XHRob3NldCA9IE1hdGguYWJzKCB0aGF0LnNpemVEaWZmLmhlaWdodCArXG5cdFx0XHQoIHRoYXQuX2hlbHBlciA/XG5cdFx0XHRcdHRoYXQub2Zmc2V0LnRvcCAtIGNvcC50b3AgOlxuXHRcdFx0XHQoIHRoYXQub2Zmc2V0LnRvcCAtIGNvLnRvcCApICkgKTtcblxuXHRcdGlmICggd29zZXQgKyB0aGF0LnNpemUud2lkdGggPj0gdGhhdC5wYXJlbnREYXRhLndpZHRoICkge1xuXHRcdFx0dGhhdC5zaXplLndpZHRoID0gdGhhdC5wYXJlbnREYXRhLndpZHRoIC0gd29zZXQ7XG5cdFx0XHRpZiAoIHBSYXRpbyApIHtcblx0XHRcdFx0dGhhdC5zaXplLmhlaWdodCA9IHRoYXQuc2l6ZS53aWR0aCAvIHRoYXQuYXNwZWN0UmF0aW87XG5cdFx0XHRcdGNvbnRpbnVlUmVzaXplID0gZmFsc2U7XG5cdFx0XHR9XG5cdFx0fVxuXG5cdFx0aWYgKCBob3NldCArIHRoYXQuc2l6ZS5oZWlnaHQgPj0gdGhhdC5wYXJlbnREYXRhLmhlaWdodCApIHtcblx0XHRcdHRoYXQuc2l6ZS5oZWlnaHQgPSB0aGF0LnBhcmVudERhdGEuaGVpZ2h0IC0gaG9zZXQ7XG5cdFx0XHRpZiAoIHBSYXRpbyApIHtcblx0XHRcdFx0dGhhdC5zaXplLndpZHRoID0gdGhhdC5zaXplLmhlaWdodCAqIHRoYXQuYXNwZWN0UmF0aW87XG5cdFx0XHRcdGNvbnRpbnVlUmVzaXplID0gZmFsc2U7XG5cdFx0XHR9XG5cdFx0fVxuXG5cdFx0aWYgKCAhY29udGludWVSZXNpemUgKSB7XG5cdFx0XHR0aGF0LnBvc2l0aW9uLmxlZnQgPSB0aGF0LnByZXZQb3NpdGlvbi5sZWZ0O1xuXHRcdFx0dGhhdC5wb3NpdGlvbi50b3AgPSB0aGF0LnByZXZQb3NpdGlvbi50b3A7XG5cdFx0XHR0aGF0LnNpemUud2lkdGggPSB0aGF0LnByZXZTaXplLndpZHRoO1xuXHRcdFx0dGhhdC5zaXplLmhlaWdodCA9IHRoYXQucHJldlNpemUuaGVpZ2h0O1xuXHRcdH1cblx0fSxcblxuXHRzdG9wOiBmdW5jdGlvbigpIHtcblx0XHR2YXIgdGhhdCA9ICQoIHRoaXMgKS5yZXNpemFibGUoIFwiaW5zdGFuY2VcIiApLFxuXHRcdFx0byA9IHRoYXQub3B0aW9ucyxcblx0XHRcdGNvID0gdGhhdC5jb250YWluZXJPZmZzZXQsXG5cdFx0XHRjb3AgPSB0aGF0LmNvbnRhaW5lclBvc2l0aW9uLFxuXHRcdFx0Y2UgPSB0aGF0LmNvbnRhaW5lckVsZW1lbnQsXG5cdFx0XHRoZWxwZXIgPSAkKCB0aGF0LmhlbHBlciApLFxuXHRcdFx0aG8gPSBoZWxwZXIub2Zmc2V0KCksXG5cdFx0XHR3ID0gaGVscGVyLm91dGVyV2lkdGgoKSAtIHRoYXQuc2l6ZURpZmYud2lkdGgsXG5cdFx0XHRoID0gaGVscGVyLm91dGVySGVpZ2h0KCkgLSB0aGF0LnNpemVEaWZmLmhlaWdodDtcblxuXHRcdGlmICggdGhhdC5faGVscGVyICYmICFvLmFuaW1hdGUgJiYgKCAvcmVsYXRpdmUvICkudGVzdCggY2UuY3NzKCBcInBvc2l0aW9uXCIgKSApICkge1xuXHRcdFx0JCggdGhpcyApLmNzcygge1xuXHRcdFx0XHRsZWZ0OiBoby5sZWZ0IC0gY29wLmxlZnQgLSBjby5sZWZ0LFxuXHRcdFx0XHR3aWR0aDogdyxcblx0XHRcdFx0aGVpZ2h0OiBoXG5cdFx0XHR9ICk7XG5cdFx0fVxuXG5cdFx0aWYgKCB0aGF0Ll9oZWxwZXIgJiYgIW8uYW5pbWF0ZSAmJiAoIC9zdGF0aWMvICkudGVzdCggY2UuY3NzKCBcInBvc2l0aW9uXCIgKSApICkge1xuXHRcdFx0JCggdGhpcyApLmNzcygge1xuXHRcdFx0XHRsZWZ0OiBoby5sZWZ0IC0gY29wLmxlZnQgLSBjby5sZWZ0LFxuXHRcdFx0XHR3aWR0aDogdyxcblx0XHRcdFx0aGVpZ2h0OiBoXG5cdFx0XHR9ICk7XG5cdFx0fVxuXHR9XG59ICk7XG5cbiQudWkucGx1Z2luLmFkZCggXCJyZXNpemFibGVcIiwgXCJhbHNvUmVzaXplXCIsIHtcblxuXHRzdGFydDogZnVuY3Rpb24oKSB7XG5cdFx0dmFyIHRoYXQgPSAkKCB0aGlzICkucmVzaXphYmxlKCBcImluc3RhbmNlXCIgKSxcblx0XHRcdG8gPSB0aGF0Lm9wdGlvbnM7XG5cblx0XHQkKCBvLmFsc29SZXNpemUgKS5lYWNoKCBmdW5jdGlvbigpIHtcblx0XHRcdHZhciBlbCA9ICQoIHRoaXMgKTtcblx0XHRcdGVsLmRhdGEoIFwidWktcmVzaXphYmxlLWFsc29yZXNpemVcIiwge1xuXHRcdFx0XHR3aWR0aDogcGFyc2VGbG9hdCggZWwud2lkdGgoKSApLCBoZWlnaHQ6IHBhcnNlRmxvYXQoIGVsLmhlaWdodCgpICksXG5cdFx0XHRcdGxlZnQ6IHBhcnNlRmxvYXQoIGVsLmNzcyggXCJsZWZ0XCIgKSApLCB0b3A6IHBhcnNlRmxvYXQoIGVsLmNzcyggXCJ0b3BcIiApIClcblx0XHRcdH0gKTtcblx0XHR9ICk7XG5cdH0sXG5cblx0cmVzaXplOiBmdW5jdGlvbiggZXZlbnQsIHVpICkge1xuXHRcdHZhciB0aGF0ID0gJCggdGhpcyApLnJlc2l6YWJsZSggXCJpbnN0YW5jZVwiICksXG5cdFx0XHRvID0gdGhhdC5vcHRpb25zLFxuXHRcdFx0b3MgPSB0aGF0Lm9yaWdpbmFsU2l6ZSxcblx0XHRcdG9wID0gdGhhdC5vcmlnaW5hbFBvc2l0aW9uLFxuXHRcdFx0ZGVsdGEgPSB7XG5cdFx0XHRcdGhlaWdodDogKCB0aGF0LnNpemUuaGVpZ2h0IC0gb3MuaGVpZ2h0ICkgfHwgMCxcblx0XHRcdFx0d2lkdGg6ICggdGhhdC5zaXplLndpZHRoIC0gb3Mud2lkdGggKSB8fCAwLFxuXHRcdFx0XHR0b3A6ICggdGhhdC5wb3NpdGlvbi50b3AgLSBvcC50b3AgKSB8fCAwLFxuXHRcdFx0XHRsZWZ0OiAoIHRoYXQucG9zaXRpb24ubGVmdCAtIG9wLmxlZnQgKSB8fCAwXG5cdFx0XHR9O1xuXG5cdFx0XHQkKCBvLmFsc29SZXNpemUgKS5lYWNoKCBmdW5jdGlvbigpIHtcblx0XHRcdFx0dmFyIGVsID0gJCggdGhpcyApLCBzdGFydCA9ICQoIHRoaXMgKS5kYXRhKCBcInVpLXJlc2l6YWJsZS1hbHNvcmVzaXplXCIgKSwgc3R5bGUgPSB7fSxcblx0XHRcdFx0XHRjc3MgPSBlbC5wYXJlbnRzKCB1aS5vcmlnaW5hbEVsZW1lbnRbIDAgXSApLmxlbmd0aCA/XG5cdFx0XHRcdFx0XHRcdFsgXCJ3aWR0aFwiLCBcImhlaWdodFwiIF0gOlxuXHRcdFx0XHRcdFx0XHRbIFwid2lkdGhcIiwgXCJoZWlnaHRcIiwgXCJ0b3BcIiwgXCJsZWZ0XCIgXTtcblxuXHRcdFx0XHQkLmVhY2goIGNzcywgZnVuY3Rpb24oIGksIHByb3AgKSB7XG5cdFx0XHRcdFx0dmFyIHN1bSA9ICggc3RhcnRbIHByb3AgXSB8fCAwICkgKyAoIGRlbHRhWyBwcm9wIF0gfHwgMCApO1xuXHRcdFx0XHRcdGlmICggc3VtICYmIHN1bSA+PSAwICkge1xuXHRcdFx0XHRcdFx0c3R5bGVbIHByb3AgXSA9IHN1bSB8fCBudWxsO1xuXHRcdFx0XHRcdH1cblx0XHRcdFx0fSApO1xuXG5cdFx0XHRcdGVsLmNzcyggc3R5bGUgKTtcblx0XHRcdH0gKTtcblx0fSxcblxuXHRzdG9wOiBmdW5jdGlvbigpIHtcblx0XHQkKCB0aGlzICkucmVtb3ZlRGF0YSggXCJ1aS1yZXNpemFibGUtYWxzb3Jlc2l6ZVwiICk7XG5cdH1cbn0gKTtcblxuJC51aS5wbHVnaW4uYWRkKCBcInJlc2l6YWJsZVwiLCBcImdob3N0XCIsIHtcblxuXHRzdGFydDogZnVuY3Rpb24oKSB7XG5cblx0XHR2YXIgdGhhdCA9ICQoIHRoaXMgKS5yZXNpemFibGUoIFwiaW5zdGFuY2VcIiApLCBjcyA9IHRoYXQuc2l6ZTtcblxuXHRcdHRoYXQuZ2hvc3QgPSB0aGF0Lm9yaWdpbmFsRWxlbWVudC5jbG9uZSgpO1xuXHRcdHRoYXQuZ2hvc3QuY3NzKCB7XG5cdFx0XHRvcGFjaXR5OiAwLjI1LFxuXHRcdFx0ZGlzcGxheTogXCJibG9ja1wiLFxuXHRcdFx0cG9zaXRpb246IFwicmVsYXRpdmVcIixcblx0XHRcdGhlaWdodDogY3MuaGVpZ2h0LFxuXHRcdFx0d2lkdGg6IGNzLndpZHRoLFxuXHRcdFx0bWFyZ2luOiAwLFxuXHRcdFx0bGVmdDogMCxcblx0XHRcdHRvcDogMFxuXHRcdH0gKTtcblxuXHRcdHRoYXQuX2FkZENsYXNzKCB0aGF0Lmdob3N0LCBcInVpLXJlc2l6YWJsZS1naG9zdFwiICk7XG5cblx0XHQvLyBERVBSRUNBVEVEXG5cdFx0Ly8gVE9ETzogcmVtb3ZlIGFmdGVyIDEuMTJcblx0XHRpZiAoICQudWlCYWNrQ29tcGF0ICE9PSBmYWxzZSAmJiB0eXBlb2YgdGhhdC5vcHRpb25zLmdob3N0ID09PSBcInN0cmluZ1wiICkge1xuXG5cdFx0XHQvLyBHaG9zdCBvcHRpb25cblx0XHRcdHRoYXQuZ2hvc3QuYWRkQ2xhc3MoIHRoaXMub3B0aW9ucy5naG9zdCApO1xuXHRcdH1cblxuXHRcdHRoYXQuZ2hvc3QuYXBwZW5kVG8oIHRoYXQuaGVscGVyICk7XG5cblx0fSxcblxuXHRyZXNpemU6IGZ1bmN0aW9uKCkge1xuXHRcdHZhciB0aGF0ID0gJCggdGhpcyApLnJlc2l6YWJsZSggXCJpbnN0YW5jZVwiICk7XG5cdFx0aWYgKCB0aGF0Lmdob3N0ICkge1xuXHRcdFx0dGhhdC5naG9zdC5jc3MoIHtcblx0XHRcdFx0cG9zaXRpb246IFwicmVsYXRpdmVcIixcblx0XHRcdFx0aGVpZ2h0OiB0aGF0LnNpemUuaGVpZ2h0LFxuXHRcdFx0XHR3aWR0aDogdGhhdC5zaXplLndpZHRoXG5cdFx0XHR9ICk7XG5cdFx0fVxuXHR9LFxuXG5cdHN0b3A6IGZ1bmN0aW9uKCkge1xuXHRcdHZhciB0aGF0ID0gJCggdGhpcyApLnJlc2l6YWJsZSggXCJpbnN0YW5jZVwiICk7XG5cdFx0aWYgKCB0aGF0Lmdob3N0ICYmIHRoYXQuaGVscGVyICkge1xuXHRcdFx0dGhhdC5oZWxwZXIuZ2V0KCAwICkucmVtb3ZlQ2hpbGQoIHRoYXQuZ2hvc3QuZ2V0KCAwICkgKTtcblx0XHR9XG5cdH1cblxufSApO1xuXG4kLnVpLnBsdWdpbi5hZGQoIFwicmVzaXphYmxlXCIsIFwiZ3JpZFwiLCB7XG5cblx0cmVzaXplOiBmdW5jdGlvbigpIHtcblx0XHR2YXIgb3V0ZXJEaW1lbnNpb25zLFxuXHRcdFx0dGhhdCA9ICQoIHRoaXMgKS5yZXNpemFibGUoIFwiaW5zdGFuY2VcIiApLFxuXHRcdFx0byA9IHRoYXQub3B0aW9ucyxcblx0XHRcdGNzID0gdGhhdC5zaXplLFxuXHRcdFx0b3MgPSB0aGF0Lm9yaWdpbmFsU2l6ZSxcblx0XHRcdG9wID0gdGhhdC5vcmlnaW5hbFBvc2l0aW9uLFxuXHRcdFx0YSA9IHRoYXQuYXhpcyxcblx0XHRcdGdyaWQgPSB0eXBlb2Ygby5ncmlkID09PSBcIm51bWJlclwiID8gWyBvLmdyaWQsIG8uZ3JpZCBdIDogby5ncmlkLFxuXHRcdFx0Z3JpZFggPSAoIGdyaWRbIDAgXSB8fCAxICksXG5cdFx0XHRncmlkWSA9ICggZ3JpZFsgMSBdIHx8IDEgKSxcblx0XHRcdG94ID0gTWF0aC5yb3VuZCggKCBjcy53aWR0aCAtIG9zLndpZHRoICkgLyBncmlkWCApICogZ3JpZFgsXG5cdFx0XHRveSA9IE1hdGgucm91bmQoICggY3MuaGVpZ2h0IC0gb3MuaGVpZ2h0ICkgLyBncmlkWSApICogZ3JpZFksXG5cdFx0XHRuZXdXaWR0aCA9IG9zLndpZHRoICsgb3gsXG5cdFx0XHRuZXdIZWlnaHQgPSBvcy5oZWlnaHQgKyBveSxcblx0XHRcdGlzTWF4V2lkdGggPSBvLm1heFdpZHRoICYmICggby5tYXhXaWR0aCA8IG5ld1dpZHRoICksXG5cdFx0XHRpc01heEhlaWdodCA9IG8ubWF4SGVpZ2h0ICYmICggby5tYXhIZWlnaHQgPCBuZXdIZWlnaHQgKSxcblx0XHRcdGlzTWluV2lkdGggPSBvLm1pbldpZHRoICYmICggby5taW5XaWR0aCA+IG5ld1dpZHRoICksXG5cdFx0XHRpc01pbkhlaWdodCA9IG8ubWluSGVpZ2h0ICYmICggby5taW5IZWlnaHQgPiBuZXdIZWlnaHQgKTtcblxuXHRcdG8uZ3JpZCA9IGdyaWQ7XG5cblx0XHRpZiAoIGlzTWluV2lkdGggKSB7XG5cdFx0XHRuZXdXaWR0aCArPSBncmlkWDtcblx0XHR9XG5cdFx0aWYgKCBpc01pbkhlaWdodCApIHtcblx0XHRcdG5ld0hlaWdodCArPSBncmlkWTtcblx0XHR9XG5cdFx0aWYgKCBpc01heFdpZHRoICkge1xuXHRcdFx0bmV3V2lkdGggLT0gZ3JpZFg7XG5cdFx0fVxuXHRcdGlmICggaXNNYXhIZWlnaHQgKSB7XG5cdFx0XHRuZXdIZWlnaHQgLT0gZ3JpZFk7XG5cdFx0fVxuXG5cdFx0aWYgKCAvXihzZXxzfGUpJC8udGVzdCggYSApICkge1xuXHRcdFx0dGhhdC5zaXplLndpZHRoID0gbmV3V2lkdGg7XG5cdFx0XHR0aGF0LnNpemUuaGVpZ2h0ID0gbmV3SGVpZ2h0O1xuXHRcdH0gZWxzZSBpZiAoIC9eKG5lKSQvLnRlc3QoIGEgKSApIHtcblx0XHRcdHRoYXQuc2l6ZS53aWR0aCA9IG5ld1dpZHRoO1xuXHRcdFx0dGhhdC5zaXplLmhlaWdodCA9IG5ld0hlaWdodDtcblx0XHRcdHRoYXQucG9zaXRpb24udG9wID0gb3AudG9wIC0gb3k7XG5cdFx0fSBlbHNlIGlmICggL14oc3cpJC8udGVzdCggYSApICkge1xuXHRcdFx0dGhhdC5zaXplLndpZHRoID0gbmV3V2lkdGg7XG5cdFx0XHR0aGF0LnNpemUuaGVpZ2h0ID0gbmV3SGVpZ2h0O1xuXHRcdFx0dGhhdC5wb3NpdGlvbi5sZWZ0ID0gb3AubGVmdCAtIG94O1xuXHRcdH0gZWxzZSB7XG5cdFx0XHRpZiAoIG5ld0hlaWdodCAtIGdyaWRZIDw9IDAgfHwgbmV3V2lkdGggLSBncmlkWCA8PSAwICkge1xuXHRcdFx0XHRvdXRlckRpbWVuc2lvbnMgPSB0aGF0Ll9nZXRQYWRkaW5nUGx1c0JvcmRlckRpbWVuc2lvbnMoIHRoaXMgKTtcblx0XHRcdH1cblxuXHRcdFx0aWYgKCBuZXdIZWlnaHQgLSBncmlkWSA+IDAgKSB7XG5cdFx0XHRcdHRoYXQuc2l6ZS5oZWlnaHQgPSBuZXdIZWlnaHQ7XG5cdFx0XHRcdHRoYXQucG9zaXRpb24udG9wID0gb3AudG9wIC0gb3k7XG5cdFx0XHR9IGVsc2Uge1xuXHRcdFx0XHRuZXdIZWlnaHQgPSBncmlkWSAtIG91dGVyRGltZW5zaW9ucy5oZWlnaHQ7XG5cdFx0XHRcdHRoYXQuc2l6ZS5oZWlnaHQgPSBuZXdIZWlnaHQ7XG5cdFx0XHRcdHRoYXQucG9zaXRpb24udG9wID0gb3AudG9wICsgb3MuaGVpZ2h0IC0gbmV3SGVpZ2h0O1xuXHRcdFx0fVxuXHRcdFx0aWYgKCBuZXdXaWR0aCAtIGdyaWRYID4gMCApIHtcblx0XHRcdFx0dGhhdC5zaXplLndpZHRoID0gbmV3V2lkdGg7XG5cdFx0XHRcdHRoYXQucG9zaXRpb24ubGVmdCA9IG9wLmxlZnQgLSBveDtcblx0XHRcdH0gZWxzZSB7XG5cdFx0XHRcdG5ld1dpZHRoID0gZ3JpZFggLSBvdXRlckRpbWVuc2lvbnMud2lkdGg7XG5cdFx0XHRcdHRoYXQuc2l6ZS53aWR0aCA9IG5ld1dpZHRoO1xuXHRcdFx0XHR0aGF0LnBvc2l0aW9uLmxlZnQgPSBvcC5sZWZ0ICsgb3Mud2lkdGggLSBuZXdXaWR0aDtcblx0XHRcdH1cblx0XHR9XG5cdH1cblxufSApO1xuXG5yZXR1cm4gJC51aS5yZXNpemFibGU7XG5cbn0gKSApO1xuIiwiLyohXG4gKiBqUXVlcnkgVUkgU3Bpbm5lciAxLjEyLjBcbiAqIGh0dHA6Ly9qcXVlcnl1aS5jb21cbiAqXG4gKiBDb3B5cmlnaHQgalF1ZXJ5IEZvdW5kYXRpb24gYW5kIG90aGVyIGNvbnRyaWJ1dG9yc1xuICogUmVsZWFzZWQgdW5kZXIgdGhlIE1JVCBsaWNlbnNlLlxuICogaHR0cDovL2pxdWVyeS5vcmcvbGljZW5zZVxuICovXG5cbi8vPj5sYWJlbDogU3Bpbm5lclxuLy8+Pmdyb3VwOiBXaWRnZXRzXG4vLz4+ZGVzY3JpcHRpb246IERpc3BsYXlzIGJ1dHRvbnMgdG8gZWFzaWx5IGlucHV0IG51bWJlcnMgdmlhIHRoZSBrZXlib2FyZCBvciBtb3VzZS5cbi8vPj5kb2NzOiBodHRwOi8vYXBpLmpxdWVyeXVpLmNvbS9zcGlubmVyL1xuLy8+PmRlbW9zOiBodHRwOi8vanF1ZXJ5dWkuY29tL3NwaW5uZXIvXG4vLz4+Y3NzLnN0cnVjdHVyZTogLi4vLi4vdGhlbWVzL2Jhc2UvY29yZS5jc3Ncbi8vPj5jc3Muc3RydWN0dXJlOiAuLi8uLi90aGVtZXMvYmFzZS9zcGlubmVyLmNzc1xuLy8+PmNzcy50aGVtZTogLi4vLi4vdGhlbWVzL2Jhc2UvdGhlbWUuY3NzXG5cbiggZnVuY3Rpb24oIGZhY3RvcnkgKSB7XG5cdGlmICggdHlwZW9mIGRlZmluZSA9PT0gXCJmdW5jdGlvblwiICYmIGRlZmluZS5hbWQgKSB7XG5cblx0XHQvLyBBTUQuIFJlZ2lzdGVyIGFzIGFuIGFub255bW91cyBtb2R1bGUuXG5cdFx0ZGVmaW5lKCBbXG5cdFx0XHRcImpxdWVyeVwiLFxuXHRcdFx0XCIuL2J1dHRvblwiLFxuXHRcdFx0XCIuLi92ZXJzaW9uXCIsXG5cdFx0XHRcIi4uL2tleWNvZGVcIixcblx0XHRcdFwiLi4vc2FmZS1hY3RpdmUtZWxlbWVudFwiLFxuXHRcdFx0XCIuLi93aWRnZXRcIlxuXHRcdF0sIGZhY3RvcnkgKTtcblx0fSBlbHNlIHtcblxuXHRcdC8vIEJyb3dzZXIgZ2xvYmFsc1xuXHRcdGZhY3RvcnkoIGpRdWVyeSApO1xuXHR9XG59KCBmdW5jdGlvbiggJCApIHtcblxuZnVuY3Rpb24gc3Bpbm5lck1vZGlmZXIoIGZuICkge1xuXHRyZXR1cm4gZnVuY3Rpb24oKSB7XG5cdFx0dmFyIHByZXZpb3VzID0gdGhpcy5lbGVtZW50LnZhbCgpO1xuXHRcdGZuLmFwcGx5KCB0aGlzLCBhcmd1bWVudHMgKTtcblx0XHR0aGlzLl9yZWZyZXNoKCk7XG5cdFx0aWYgKCBwcmV2aW91cyAhPT0gdGhpcy5lbGVtZW50LnZhbCgpICkge1xuXHRcdFx0dGhpcy5fdHJpZ2dlciggXCJjaGFuZ2VcIiApO1xuXHRcdH1cblx0fTtcbn1cblxuJC53aWRnZXQoIFwidWkuc3Bpbm5lclwiLCB7XG5cdHZlcnNpb246IFwiMS4xMi4wXCIsXG5cdGRlZmF1bHRFbGVtZW50OiBcIjxpbnB1dD5cIixcblx0d2lkZ2V0RXZlbnRQcmVmaXg6IFwic3BpblwiLFxuXHRvcHRpb25zOiB7XG5cdFx0Y2xhc3Nlczoge1xuXHRcdFx0XCJ1aS1zcGlubmVyXCI6IFwidWktY29ybmVyLWFsbFwiLFxuXHRcdFx0XCJ1aS1zcGlubmVyLWRvd25cIjogXCJ1aS1jb3JuZXItYnJcIixcblx0XHRcdFwidWktc3Bpbm5lci11cFwiOiBcInVpLWNvcm5lci10clwiXG5cdFx0fSxcblx0XHRjdWx0dXJlOiBudWxsLFxuXHRcdGljb25zOiB7XG5cdFx0XHRkb3duOiBcInVpLWljb24tdHJpYW5nbGUtMS1zXCIsXG5cdFx0XHR1cDogXCJ1aS1pY29uLXRyaWFuZ2xlLTEtblwiXG5cdFx0fSxcblx0XHRpbmNyZW1lbnRhbDogdHJ1ZSxcblx0XHRtYXg6IG51bGwsXG5cdFx0bWluOiBudWxsLFxuXHRcdG51bWJlckZvcm1hdDogbnVsbCxcblx0XHRwYWdlOiAxMCxcblx0XHRzdGVwOiAxLFxuXG5cdFx0Y2hhbmdlOiBudWxsLFxuXHRcdHNwaW46IG51bGwsXG5cdFx0c3RhcnQ6IG51bGwsXG5cdFx0c3RvcDogbnVsbFxuXHR9LFxuXG5cdF9jcmVhdGU6IGZ1bmN0aW9uKCkge1xuXG5cdFx0Ly8gaGFuZGxlIHN0cmluZyB2YWx1ZXMgdGhhdCBuZWVkIHRvIGJlIHBhcnNlZFxuXHRcdHRoaXMuX3NldE9wdGlvbiggXCJtYXhcIiwgdGhpcy5vcHRpb25zLm1heCApO1xuXHRcdHRoaXMuX3NldE9wdGlvbiggXCJtaW5cIiwgdGhpcy5vcHRpb25zLm1pbiApO1xuXHRcdHRoaXMuX3NldE9wdGlvbiggXCJzdGVwXCIsIHRoaXMub3B0aW9ucy5zdGVwICk7XG5cblx0XHQvLyBPbmx5IGZvcm1hdCBpZiB0aGVyZSBpcyBhIHZhbHVlLCBwcmV2ZW50cyB0aGUgZmllbGQgZnJvbSBiZWluZyBtYXJrZWRcblx0XHQvLyBhcyBpbnZhbGlkIGluIEZpcmVmb3gsIHNlZSAjOTU3My5cblx0XHRpZiAoIHRoaXMudmFsdWUoKSAhPT0gXCJcIiApIHtcblxuXHRcdFx0Ly8gRm9ybWF0IHRoZSB2YWx1ZSwgYnV0IGRvbid0IGNvbnN0cmFpbi5cblx0XHRcdHRoaXMuX3ZhbHVlKCB0aGlzLmVsZW1lbnQudmFsKCksIHRydWUgKTtcblx0XHR9XG5cblx0XHR0aGlzLl9kcmF3KCk7XG5cdFx0dGhpcy5fb24oIHRoaXMuX2V2ZW50cyApO1xuXHRcdHRoaXMuX3JlZnJlc2goKTtcblxuXHRcdC8vIFR1cm5pbmcgb2ZmIGF1dG9jb21wbGV0ZSBwcmV2ZW50cyB0aGUgYnJvd3NlciBmcm9tIHJlbWVtYmVyaW5nIHRoZVxuXHRcdC8vIHZhbHVlIHdoZW4gbmF2aWdhdGluZyB0aHJvdWdoIGhpc3RvcnksIHNvIHdlIHJlLWVuYWJsZSBhdXRvY29tcGxldGVcblx0XHQvLyBpZiB0aGUgcGFnZSBpcyB1bmxvYWRlZCBiZWZvcmUgdGhlIHdpZGdldCBpcyBkZXN0cm95ZWQuICM3NzkwXG5cdFx0dGhpcy5fb24oIHRoaXMud2luZG93LCB7XG5cdFx0XHRiZWZvcmV1bmxvYWQ6IGZ1bmN0aW9uKCkge1xuXHRcdFx0XHR0aGlzLmVsZW1lbnQucmVtb3ZlQXR0ciggXCJhdXRvY29tcGxldGVcIiApO1xuXHRcdFx0fVxuXHRcdH0gKTtcblx0fSxcblxuXHRfZ2V0Q3JlYXRlT3B0aW9uczogZnVuY3Rpb24oKSB7XG5cdFx0dmFyIG9wdGlvbnMgPSB0aGlzLl9zdXBlcigpO1xuXHRcdHZhciBlbGVtZW50ID0gdGhpcy5lbGVtZW50O1xuXG5cdFx0JC5lYWNoKCBbIFwibWluXCIsIFwibWF4XCIsIFwic3RlcFwiIF0sIGZ1bmN0aW9uKCBpLCBvcHRpb24gKSB7XG5cdFx0XHR2YXIgdmFsdWUgPSBlbGVtZW50LmF0dHIoIG9wdGlvbiApO1xuXHRcdFx0aWYgKCB2YWx1ZSAhPSBudWxsICYmIHZhbHVlLmxlbmd0aCApIHtcblx0XHRcdFx0b3B0aW9uc1sgb3B0aW9uIF0gPSB2YWx1ZTtcblx0XHRcdH1cblx0XHR9ICk7XG5cblx0XHRyZXR1cm4gb3B0aW9ucztcblx0fSxcblxuXHRfZXZlbnRzOiB7XG5cdFx0a2V5ZG93bjogZnVuY3Rpb24oIGV2ZW50ICkge1xuXHRcdFx0aWYgKCB0aGlzLl9zdGFydCggZXZlbnQgKSAmJiB0aGlzLl9rZXlkb3duKCBldmVudCApICkge1xuXHRcdFx0XHRldmVudC5wcmV2ZW50RGVmYXVsdCgpO1xuXHRcdFx0fVxuXHRcdH0sXG5cdFx0a2V5dXA6IFwiX3N0b3BcIixcblx0XHRmb2N1czogZnVuY3Rpb24oKSB7XG5cdFx0XHR0aGlzLnByZXZpb3VzID0gdGhpcy5lbGVtZW50LnZhbCgpO1xuXHRcdH0sXG5cdFx0Ymx1cjogZnVuY3Rpb24oIGV2ZW50ICkge1xuXHRcdFx0aWYgKCB0aGlzLmNhbmNlbEJsdXIgKSB7XG5cdFx0XHRcdGRlbGV0ZSB0aGlzLmNhbmNlbEJsdXI7XG5cdFx0XHRcdHJldHVybjtcblx0XHRcdH1cblxuXHRcdFx0dGhpcy5fc3RvcCgpO1xuXHRcdFx0dGhpcy5fcmVmcmVzaCgpO1xuXHRcdFx0aWYgKCB0aGlzLnByZXZpb3VzICE9PSB0aGlzLmVsZW1lbnQudmFsKCkgKSB7XG5cdFx0XHRcdHRoaXMuX3RyaWdnZXIoIFwiY2hhbmdlXCIsIGV2ZW50ICk7XG5cdFx0XHR9XG5cdFx0fSxcblx0XHRtb3VzZXdoZWVsOiBmdW5jdGlvbiggZXZlbnQsIGRlbHRhICkge1xuXHRcdFx0aWYgKCAhZGVsdGEgKSB7XG5cdFx0XHRcdHJldHVybjtcblx0XHRcdH1cblx0XHRcdGlmICggIXRoaXMuc3Bpbm5pbmcgJiYgIXRoaXMuX3N0YXJ0KCBldmVudCApICkge1xuXHRcdFx0XHRyZXR1cm4gZmFsc2U7XG5cdFx0XHR9XG5cblx0XHRcdHRoaXMuX3NwaW4oICggZGVsdGEgPiAwID8gMSA6IC0xICkgKiB0aGlzLm9wdGlvbnMuc3RlcCwgZXZlbnQgKTtcblx0XHRcdGNsZWFyVGltZW91dCggdGhpcy5tb3VzZXdoZWVsVGltZXIgKTtcblx0XHRcdHRoaXMubW91c2V3aGVlbFRpbWVyID0gdGhpcy5fZGVsYXkoIGZ1bmN0aW9uKCkge1xuXHRcdFx0XHRpZiAoIHRoaXMuc3Bpbm5pbmcgKSB7XG5cdFx0XHRcdFx0dGhpcy5fc3RvcCggZXZlbnQgKTtcblx0XHRcdFx0fVxuXHRcdFx0fSwgMTAwICk7XG5cdFx0XHRldmVudC5wcmV2ZW50RGVmYXVsdCgpO1xuXHRcdH0sXG5cdFx0XCJtb3VzZWRvd24gLnVpLXNwaW5uZXItYnV0dG9uXCI6IGZ1bmN0aW9uKCBldmVudCApIHtcblx0XHRcdHZhciBwcmV2aW91cztcblxuXHRcdFx0Ly8gV2UgbmV2ZXIgd2FudCB0aGUgYnV0dG9ucyB0byBoYXZlIGZvY3VzOyB3aGVuZXZlciB0aGUgdXNlciBpc1xuXHRcdFx0Ly8gaW50ZXJhY3Rpbmcgd2l0aCB0aGUgc3Bpbm5lciwgdGhlIGZvY3VzIHNob3VsZCBiZSBvbiB0aGUgaW5wdXQuXG5cdFx0XHQvLyBJZiB0aGUgaW5wdXQgaXMgZm9jdXNlZCB0aGVuIHRoaXMucHJldmlvdXMgaXMgcHJvcGVybHkgc2V0IGZyb21cblx0XHRcdC8vIHdoZW4gdGhlIGlucHV0IGZpcnN0IHJlY2VpdmVkIGZvY3VzLiBJZiB0aGUgaW5wdXQgaXMgbm90IGZvY3VzZWRcblx0XHRcdC8vIHRoZW4gd2UgbmVlZCB0byBzZXQgdGhpcy5wcmV2aW91cyBiYXNlZCBvbiB0aGUgdmFsdWUgYmVmb3JlIHNwaW5uaW5nLlxuXHRcdFx0cHJldmlvdXMgPSB0aGlzLmVsZW1lbnRbIDAgXSA9PT0gJC51aS5zYWZlQWN0aXZlRWxlbWVudCggdGhpcy5kb2N1bWVudFsgMCBdICkgP1xuXHRcdFx0XHR0aGlzLnByZXZpb3VzIDogdGhpcy5lbGVtZW50LnZhbCgpO1xuXHRcdFx0ZnVuY3Rpb24gY2hlY2tGb2N1cygpIHtcblx0XHRcdFx0dmFyIGlzQWN0aXZlID0gdGhpcy5lbGVtZW50WyAwIF0gPT09ICQudWkuc2FmZUFjdGl2ZUVsZW1lbnQoIHRoaXMuZG9jdW1lbnRbIDAgXSApO1xuXHRcdFx0XHRpZiAoICFpc0FjdGl2ZSApIHtcblx0XHRcdFx0XHR0aGlzLmVsZW1lbnQudHJpZ2dlciggXCJmb2N1c1wiICk7XG5cdFx0XHRcdFx0dGhpcy5wcmV2aW91cyA9IHByZXZpb3VzO1xuXG5cdFx0XHRcdFx0Ly8gc3VwcG9ydDogSUVcblx0XHRcdFx0XHQvLyBJRSBzZXRzIGZvY3VzIGFzeW5jaHJvbm91c2x5LCBzbyB3ZSBuZWVkIHRvIGNoZWNrIGlmIGZvY3VzXG5cdFx0XHRcdFx0Ly8gbW92ZWQgb2ZmIG9mIHRoZSBpbnB1dCBiZWNhdXNlIHRoZSB1c2VyIGNsaWNrZWQgb24gdGhlIGJ1dHRvbi5cblx0XHRcdFx0XHR0aGlzLl9kZWxheSggZnVuY3Rpb24oKSB7XG5cdFx0XHRcdFx0XHR0aGlzLnByZXZpb3VzID0gcHJldmlvdXM7XG5cdFx0XHRcdFx0fSApO1xuXHRcdFx0XHR9XG5cdFx0XHR9XG5cblx0XHRcdC8vIEVuc3VyZSBmb2N1cyBpcyBvbiAob3Igc3RheXMgb24pIHRoZSB0ZXh0IGZpZWxkXG5cdFx0XHRldmVudC5wcmV2ZW50RGVmYXVsdCgpO1xuXHRcdFx0Y2hlY2tGb2N1cy5jYWxsKCB0aGlzICk7XG5cblx0XHRcdC8vIFN1cHBvcnQ6IElFXG5cdFx0XHQvLyBJRSBkb2Vzbid0IHByZXZlbnQgbW92aW5nIGZvY3VzIGV2ZW4gd2l0aCBldmVudC5wcmV2ZW50RGVmYXVsdCgpXG5cdFx0XHQvLyBzbyB3ZSBzZXQgYSBmbGFnIHRvIGtub3cgd2hlbiB3ZSBzaG91bGQgaWdub3JlIHRoZSBibHVyIGV2ZW50XG5cdFx0XHQvLyBhbmQgY2hlY2sgKGFnYWluKSBpZiBmb2N1cyBtb3ZlZCBvZmYgb2YgdGhlIGlucHV0LlxuXHRcdFx0dGhpcy5jYW5jZWxCbHVyID0gdHJ1ZTtcblx0XHRcdHRoaXMuX2RlbGF5KCBmdW5jdGlvbigpIHtcblx0XHRcdFx0ZGVsZXRlIHRoaXMuY2FuY2VsQmx1cjtcblx0XHRcdFx0Y2hlY2tGb2N1cy5jYWxsKCB0aGlzICk7XG5cdFx0XHR9ICk7XG5cblx0XHRcdGlmICggdGhpcy5fc3RhcnQoIGV2ZW50ICkgPT09IGZhbHNlICkge1xuXHRcdFx0XHRyZXR1cm47XG5cdFx0XHR9XG5cblx0XHRcdHRoaXMuX3JlcGVhdCggbnVsbCwgJCggZXZlbnQuY3VycmVudFRhcmdldCApXG5cdFx0XHRcdC5oYXNDbGFzcyggXCJ1aS1zcGlubmVyLXVwXCIgKSA/IDEgOiAtMSwgZXZlbnQgKTtcblx0XHR9LFxuXHRcdFwibW91c2V1cCAudWktc3Bpbm5lci1idXR0b25cIjogXCJfc3RvcFwiLFxuXHRcdFwibW91c2VlbnRlciAudWktc3Bpbm5lci1idXR0b25cIjogZnVuY3Rpb24oIGV2ZW50ICkge1xuXG5cdFx0XHQvLyBidXR0b24gd2lsbCBhZGQgdWktc3RhdGUtYWN0aXZlIGlmIG1vdXNlIHdhcyBkb3duIHdoaWxlIG1vdXNlbGVhdmUgYW5kIGtlcHQgZG93blxuXHRcdFx0aWYgKCAhJCggZXZlbnQuY3VycmVudFRhcmdldCApLmhhc0NsYXNzKCBcInVpLXN0YXRlLWFjdGl2ZVwiICkgKSB7XG5cdFx0XHRcdHJldHVybjtcblx0XHRcdH1cblxuXHRcdFx0aWYgKCB0aGlzLl9zdGFydCggZXZlbnQgKSA9PT0gZmFsc2UgKSB7XG5cdFx0XHRcdHJldHVybiBmYWxzZTtcblx0XHRcdH1cblx0XHRcdHRoaXMuX3JlcGVhdCggbnVsbCwgJCggZXZlbnQuY3VycmVudFRhcmdldCApXG5cdFx0XHRcdC5oYXNDbGFzcyggXCJ1aS1zcGlubmVyLXVwXCIgKSA/IDEgOiAtMSwgZXZlbnQgKTtcblx0XHR9LFxuXG5cdFx0Ly8gVE9ETzogZG8gd2UgcmVhbGx5IHdhbnQgdG8gY29uc2lkZXIgdGhpcyBhIHN0b3A/XG5cdFx0Ly8gc2hvdWxkbid0IHdlIGp1c3Qgc3RvcCB0aGUgcmVwZWF0ZXIgYW5kIHdhaXQgdW50aWwgbW91c2V1cCBiZWZvcmVcblx0XHQvLyB3ZSB0cmlnZ2VyIHRoZSBzdG9wIGV2ZW50P1xuXHRcdFwibW91c2VsZWF2ZSAudWktc3Bpbm5lci1idXR0b25cIjogXCJfc3RvcFwiXG5cdH0sXG5cblx0Ly8gU3VwcG9ydCBtb2JpbGUgZW5oYW5jZWQgb3B0aW9uIGFuZCBtYWtlIGJhY2tjb21wYXQgbW9yZSBzYW5lXG5cdF9lbmhhbmNlOiBmdW5jdGlvbigpIHtcblx0XHR0aGlzLnVpU3Bpbm5lciA9IHRoaXMuZWxlbWVudFxuXHRcdFx0LmF0dHIoIFwiYXV0b2NvbXBsZXRlXCIsIFwib2ZmXCIgKVxuXHRcdFx0LndyYXAoIFwiPHNwYW4+XCIgKVxuXHRcdFx0LnBhcmVudCgpXG5cblx0XHRcdFx0Ly8gQWRkIGJ1dHRvbnNcblx0XHRcdFx0LmFwcGVuZChcblx0XHRcdFx0XHRcIjxhPjwvYT48YT48L2E+XCJcblx0XHRcdFx0KTtcblx0fSxcblxuXHRfZHJhdzogZnVuY3Rpb24oKSB7XG5cdFx0dGhpcy5fZW5oYW5jZSgpO1xuXG5cdFx0dGhpcy5fYWRkQ2xhc3MoIHRoaXMudWlTcGlubmVyLCBcInVpLXNwaW5uZXJcIiwgXCJ1aS13aWRnZXQgdWktd2lkZ2V0LWNvbnRlbnRcIiApO1xuXHRcdHRoaXMuX2FkZENsYXNzKCBcInVpLXNwaW5uZXItaW5wdXRcIiApO1xuXG5cdFx0dGhpcy5lbGVtZW50LmF0dHIoIFwicm9sZVwiLCBcInNwaW5idXR0b25cIiApO1xuXG5cdFx0Ly8gQnV0dG9uIGJpbmRpbmdzXG5cdFx0dGhpcy5idXR0b25zID0gdGhpcy51aVNwaW5uZXIuY2hpbGRyZW4oIFwiYVwiIClcblx0XHRcdC5hdHRyKCBcInRhYkluZGV4XCIsIC0xIClcblx0XHRcdC5hdHRyKCBcImFyaWEtaGlkZGVuXCIsIHRydWUgKVxuXHRcdFx0LmJ1dHRvbigge1xuXHRcdFx0XHRjbGFzc2VzOiB7XG5cdFx0XHRcdFx0XCJ1aS1idXR0b25cIjogXCJcIlxuXHRcdFx0XHR9XG5cdFx0XHR9ICk7XG5cblx0XHQvLyBUT0RPOiBSaWdodCBub3cgYnV0dG9uIGRvZXMgbm90IHN1cHBvcnQgY2xhc3NlcyB0aGlzIGlzIGFscmVhZHkgdXBkYXRlZCBpbiBidXR0b24gUFJcblx0XHR0aGlzLl9yZW1vdmVDbGFzcyggdGhpcy5idXR0b25zLCBcInVpLWNvcm5lci1hbGxcIiApO1xuXG5cdFx0dGhpcy5fYWRkQ2xhc3MoIHRoaXMuYnV0dG9ucy5maXJzdCgpLCBcInVpLXNwaW5uZXItYnV0dG9uIHVpLXNwaW5uZXItdXBcIiApO1xuXHRcdHRoaXMuX2FkZENsYXNzKCB0aGlzLmJ1dHRvbnMubGFzdCgpLCBcInVpLXNwaW5uZXItYnV0dG9uIHVpLXNwaW5uZXItZG93blwiICk7XG5cdFx0dGhpcy5idXR0b25zLmZpcnN0KCkuYnV0dG9uKCB7XG5cdFx0XHRcImljb25cIjogdGhpcy5vcHRpb25zLmljb25zLnVwLFxuXHRcdFx0XCJzaG93TGFiZWxcIjogZmFsc2Vcblx0XHR9ICk7XG5cdFx0dGhpcy5idXR0b25zLmxhc3QoKS5idXR0b24oIHtcblx0XHRcdFwiaWNvblwiOiB0aGlzLm9wdGlvbnMuaWNvbnMuZG93bixcblx0XHRcdFwic2hvd0xhYmVsXCI6IGZhbHNlXG5cdFx0fSApO1xuXG5cdFx0Ly8gSUUgNiBkb2Vzbid0IHVuZGVyc3RhbmQgaGVpZ2h0OiA1MCUgZm9yIHRoZSBidXR0b25zXG5cdFx0Ly8gdW5sZXNzIHRoZSB3cmFwcGVyIGhhcyBhbiBleHBsaWNpdCBoZWlnaHRcblx0XHRpZiAoIHRoaXMuYnV0dG9ucy5oZWlnaHQoKSA+IE1hdGguY2VpbCggdGhpcy51aVNwaW5uZXIuaGVpZ2h0KCkgKiAwLjUgKSAmJlxuXHRcdFx0XHR0aGlzLnVpU3Bpbm5lci5oZWlnaHQoKSA+IDAgKSB7XG5cdFx0XHR0aGlzLnVpU3Bpbm5lci5oZWlnaHQoIHRoaXMudWlTcGlubmVyLmhlaWdodCgpICk7XG5cdFx0fVxuXHR9LFxuXG5cdF9rZXlkb3duOiBmdW5jdGlvbiggZXZlbnQgKSB7XG5cdFx0dmFyIG9wdGlvbnMgPSB0aGlzLm9wdGlvbnMsXG5cdFx0XHRrZXlDb2RlID0gJC51aS5rZXlDb2RlO1xuXG5cdFx0c3dpdGNoICggZXZlbnQua2V5Q29kZSApIHtcblx0XHRjYXNlIGtleUNvZGUuVVA6XG5cdFx0XHR0aGlzLl9yZXBlYXQoIG51bGwsIDEsIGV2ZW50ICk7XG5cdFx0XHRyZXR1cm4gdHJ1ZTtcblx0XHRjYXNlIGtleUNvZGUuRE9XTjpcblx0XHRcdHRoaXMuX3JlcGVhdCggbnVsbCwgLTEsIGV2ZW50ICk7XG5cdFx0XHRyZXR1cm4gdHJ1ZTtcblx0XHRjYXNlIGtleUNvZGUuUEFHRV9VUDpcblx0XHRcdHRoaXMuX3JlcGVhdCggbnVsbCwgb3B0aW9ucy5wYWdlLCBldmVudCApO1xuXHRcdFx0cmV0dXJuIHRydWU7XG5cdFx0Y2FzZSBrZXlDb2RlLlBBR0VfRE9XTjpcblx0XHRcdHRoaXMuX3JlcGVhdCggbnVsbCwgLW9wdGlvbnMucGFnZSwgZXZlbnQgKTtcblx0XHRcdHJldHVybiB0cnVlO1xuXHRcdH1cblxuXHRcdHJldHVybiBmYWxzZTtcblx0fSxcblxuXHRfc3RhcnQ6IGZ1bmN0aW9uKCBldmVudCApIHtcblx0XHRpZiAoICF0aGlzLnNwaW5uaW5nICYmIHRoaXMuX3RyaWdnZXIoIFwic3RhcnRcIiwgZXZlbnQgKSA9PT0gZmFsc2UgKSB7XG5cdFx0XHRyZXR1cm4gZmFsc2U7XG5cdFx0fVxuXG5cdFx0aWYgKCAhdGhpcy5jb3VudGVyICkge1xuXHRcdFx0dGhpcy5jb3VudGVyID0gMTtcblx0XHR9XG5cdFx0dGhpcy5zcGlubmluZyA9IHRydWU7XG5cdFx0cmV0dXJuIHRydWU7XG5cdH0sXG5cblx0X3JlcGVhdDogZnVuY3Rpb24oIGksIHN0ZXBzLCBldmVudCApIHtcblx0XHRpID0gaSB8fCA1MDA7XG5cblx0XHRjbGVhclRpbWVvdXQoIHRoaXMudGltZXIgKTtcblx0XHR0aGlzLnRpbWVyID0gdGhpcy5fZGVsYXkoIGZ1bmN0aW9uKCkge1xuXHRcdFx0dGhpcy5fcmVwZWF0KCA0MCwgc3RlcHMsIGV2ZW50ICk7XG5cdFx0fSwgaSApO1xuXG5cdFx0dGhpcy5fc3Bpbiggc3RlcHMgKiB0aGlzLm9wdGlvbnMuc3RlcCwgZXZlbnQgKTtcblx0fSxcblxuXHRfc3BpbjogZnVuY3Rpb24oIHN0ZXAsIGV2ZW50ICkge1xuXHRcdHZhciB2YWx1ZSA9IHRoaXMudmFsdWUoKSB8fCAwO1xuXG5cdFx0aWYgKCAhdGhpcy5jb3VudGVyICkge1xuXHRcdFx0dGhpcy5jb3VudGVyID0gMTtcblx0XHR9XG5cblx0XHR2YWx1ZSA9IHRoaXMuX2FkanVzdFZhbHVlKCB2YWx1ZSArIHN0ZXAgKiB0aGlzLl9pbmNyZW1lbnQoIHRoaXMuY291bnRlciApICk7XG5cblx0XHRpZiAoICF0aGlzLnNwaW5uaW5nIHx8IHRoaXMuX3RyaWdnZXIoIFwic3BpblwiLCBldmVudCwgeyB2YWx1ZTogdmFsdWUgfSApICE9PSBmYWxzZSApIHtcblx0XHRcdHRoaXMuX3ZhbHVlKCB2YWx1ZSApO1xuXHRcdFx0dGhpcy5jb3VudGVyKys7XG5cdFx0fVxuXHR9LFxuXG5cdF9pbmNyZW1lbnQ6IGZ1bmN0aW9uKCBpICkge1xuXHRcdHZhciBpbmNyZW1lbnRhbCA9IHRoaXMub3B0aW9ucy5pbmNyZW1lbnRhbDtcblxuXHRcdGlmICggaW5jcmVtZW50YWwgKSB7XG5cdFx0XHRyZXR1cm4gJC5pc0Z1bmN0aW9uKCBpbmNyZW1lbnRhbCApID9cblx0XHRcdFx0aW5jcmVtZW50YWwoIGkgKSA6XG5cdFx0XHRcdE1hdGguZmxvb3IoIGkgKiBpICogaSAvIDUwMDAwIC0gaSAqIGkgLyA1MDAgKyAxNyAqIGkgLyAyMDAgKyAxICk7XG5cdFx0fVxuXG5cdFx0cmV0dXJuIDE7XG5cdH0sXG5cblx0X3ByZWNpc2lvbjogZnVuY3Rpb24oKSB7XG5cdFx0dmFyIHByZWNpc2lvbiA9IHRoaXMuX3ByZWNpc2lvbk9mKCB0aGlzLm9wdGlvbnMuc3RlcCApO1xuXHRcdGlmICggdGhpcy5vcHRpb25zLm1pbiAhPT0gbnVsbCApIHtcblx0XHRcdHByZWNpc2lvbiA9IE1hdGgubWF4KCBwcmVjaXNpb24sIHRoaXMuX3ByZWNpc2lvbk9mKCB0aGlzLm9wdGlvbnMubWluICkgKTtcblx0XHR9XG5cdFx0cmV0dXJuIHByZWNpc2lvbjtcblx0fSxcblxuXHRfcHJlY2lzaW9uT2Y6IGZ1bmN0aW9uKCBudW0gKSB7XG5cdFx0dmFyIHN0ciA9IG51bS50b1N0cmluZygpLFxuXHRcdFx0ZGVjaW1hbCA9IHN0ci5pbmRleE9mKCBcIi5cIiApO1xuXHRcdHJldHVybiBkZWNpbWFsID09PSAtMSA/IDAgOiBzdHIubGVuZ3RoIC0gZGVjaW1hbCAtIDE7XG5cdH0sXG5cblx0X2FkanVzdFZhbHVlOiBmdW5jdGlvbiggdmFsdWUgKSB7XG5cdFx0dmFyIGJhc2UsIGFib3ZlTWluLFxuXHRcdFx0b3B0aW9ucyA9IHRoaXMub3B0aW9ucztcblxuXHRcdC8vIE1ha2Ugc3VyZSB3ZSdyZSBhdCBhIHZhbGlkIHN0ZXBcblx0XHQvLyAtIGZpbmQgb3V0IHdoZXJlIHdlIGFyZSByZWxhdGl2ZSB0byB0aGUgYmFzZSAobWluIG9yIDApXG5cdFx0YmFzZSA9IG9wdGlvbnMubWluICE9PSBudWxsID8gb3B0aW9ucy5taW4gOiAwO1xuXHRcdGFib3ZlTWluID0gdmFsdWUgLSBiYXNlO1xuXG5cdFx0Ly8gLSByb3VuZCB0byB0aGUgbmVhcmVzdCBzdGVwXG5cdFx0YWJvdmVNaW4gPSBNYXRoLnJvdW5kKCBhYm92ZU1pbiAvIG9wdGlvbnMuc3RlcCApICogb3B0aW9ucy5zdGVwO1xuXG5cdFx0Ly8gLSByb3VuZGluZyBpcyBiYXNlZCBvbiAwLCBzbyBhZGp1c3QgYmFjayB0byBvdXIgYmFzZVxuXHRcdHZhbHVlID0gYmFzZSArIGFib3ZlTWluO1xuXG5cdFx0Ly8gRml4IHByZWNpc2lvbiBmcm9tIGJhZCBKUyBmbG9hdGluZyBwb2ludCBtYXRoXG5cdFx0dmFsdWUgPSBwYXJzZUZsb2F0KCB2YWx1ZS50b0ZpeGVkKCB0aGlzLl9wcmVjaXNpb24oKSApICk7XG5cblx0XHQvLyBDbGFtcCB0aGUgdmFsdWVcblx0XHRpZiAoIG9wdGlvbnMubWF4ICE9PSBudWxsICYmIHZhbHVlID4gb3B0aW9ucy5tYXggKSB7XG5cdFx0XHRyZXR1cm4gb3B0aW9ucy5tYXg7XG5cdFx0fVxuXHRcdGlmICggb3B0aW9ucy5taW4gIT09IG51bGwgJiYgdmFsdWUgPCBvcHRpb25zLm1pbiApIHtcblx0XHRcdHJldHVybiBvcHRpb25zLm1pbjtcblx0XHR9XG5cblx0XHRyZXR1cm4gdmFsdWU7XG5cdH0sXG5cblx0X3N0b3A6IGZ1bmN0aW9uKCBldmVudCApIHtcblx0XHRpZiAoICF0aGlzLnNwaW5uaW5nICkge1xuXHRcdFx0cmV0dXJuO1xuXHRcdH1cblxuXHRcdGNsZWFyVGltZW91dCggdGhpcy50aW1lciApO1xuXHRcdGNsZWFyVGltZW91dCggdGhpcy5tb3VzZXdoZWVsVGltZXIgKTtcblx0XHR0aGlzLmNvdW50ZXIgPSAwO1xuXHRcdHRoaXMuc3Bpbm5pbmcgPSBmYWxzZTtcblx0XHR0aGlzLl90cmlnZ2VyKCBcInN0b3BcIiwgZXZlbnQgKTtcblx0fSxcblxuXHRfc2V0T3B0aW9uOiBmdW5jdGlvbigga2V5LCB2YWx1ZSApIHtcblx0XHR2YXIgcHJldlZhbHVlLCBmaXJzdCwgbGFzdDtcblxuXHRcdGlmICgga2V5ID09PSBcImN1bHR1cmVcIiB8fCBrZXkgPT09IFwibnVtYmVyRm9ybWF0XCIgKSB7XG5cdFx0XHRwcmV2VmFsdWUgPSB0aGlzLl9wYXJzZSggdGhpcy5lbGVtZW50LnZhbCgpICk7XG5cdFx0XHR0aGlzLm9wdGlvbnNbIGtleSBdID0gdmFsdWU7XG5cdFx0XHR0aGlzLmVsZW1lbnQudmFsKCB0aGlzLl9mb3JtYXQoIHByZXZWYWx1ZSApICk7XG5cdFx0XHRyZXR1cm47XG5cdFx0fVxuXG5cdFx0aWYgKCBrZXkgPT09IFwibWF4XCIgfHwga2V5ID09PSBcIm1pblwiIHx8IGtleSA9PT0gXCJzdGVwXCIgKSB7XG5cdFx0XHRpZiAoIHR5cGVvZiB2YWx1ZSA9PT0gXCJzdHJpbmdcIiApIHtcblx0XHRcdFx0dmFsdWUgPSB0aGlzLl9wYXJzZSggdmFsdWUgKTtcblx0XHRcdH1cblx0XHR9XG5cdFx0aWYgKCBrZXkgPT09IFwiaWNvbnNcIiApIHtcblx0XHRcdGZpcnN0ID0gdGhpcy5idXR0b25zLmZpcnN0KCkuZmluZCggXCIudWktaWNvblwiICk7XG5cdFx0XHR0aGlzLl9yZW1vdmVDbGFzcyggZmlyc3QsIG51bGwsIHRoaXMub3B0aW9ucy5pY29ucy51cCApO1xuXHRcdFx0dGhpcy5fYWRkQ2xhc3MoIGZpcnN0LCBudWxsLCB2YWx1ZS51cCApO1xuXHRcdFx0bGFzdCA9IHRoaXMuYnV0dG9ucy5sYXN0KCkuZmluZCggXCIudWktaWNvblwiICk7XG5cdFx0XHR0aGlzLl9yZW1vdmVDbGFzcyggbGFzdCwgbnVsbCwgdGhpcy5vcHRpb25zLmljb25zLmRvd24gKTtcblx0XHRcdHRoaXMuX2FkZENsYXNzKCBsYXN0LCBudWxsLCB2YWx1ZS5kb3duICk7XG5cdFx0fVxuXG5cdFx0dGhpcy5fc3VwZXIoIGtleSwgdmFsdWUgKTtcblx0fSxcblxuXHRfc2V0T3B0aW9uRGlzYWJsZWQ6IGZ1bmN0aW9uKCB2YWx1ZSApIHtcblx0XHR0aGlzLl9zdXBlciggdmFsdWUgKTtcblxuXHRcdHRoaXMuX3RvZ2dsZUNsYXNzKCB0aGlzLnVpU3Bpbm5lciwgbnVsbCwgXCJ1aS1zdGF0ZS1kaXNhYmxlZFwiLCAhIXZhbHVlICk7XG5cdFx0dGhpcy5lbGVtZW50LnByb3AoIFwiZGlzYWJsZWRcIiwgISF2YWx1ZSApO1xuXHRcdHRoaXMuYnV0dG9ucy5idXR0b24oIHZhbHVlID8gXCJkaXNhYmxlXCIgOiBcImVuYWJsZVwiICk7XG5cdH0sXG5cblx0X3NldE9wdGlvbnM6IHNwaW5uZXJNb2RpZmVyKCBmdW5jdGlvbiggb3B0aW9ucyApIHtcblx0XHR0aGlzLl9zdXBlciggb3B0aW9ucyApO1xuXHR9ICksXG5cblx0X3BhcnNlOiBmdW5jdGlvbiggdmFsICkge1xuXHRcdGlmICggdHlwZW9mIHZhbCA9PT0gXCJzdHJpbmdcIiAmJiB2YWwgIT09IFwiXCIgKSB7XG5cdFx0XHR2YWwgPSB3aW5kb3cuR2xvYmFsaXplICYmIHRoaXMub3B0aW9ucy5udW1iZXJGb3JtYXQgP1xuXHRcdFx0XHRHbG9iYWxpemUucGFyc2VGbG9hdCggdmFsLCAxMCwgdGhpcy5vcHRpb25zLmN1bHR1cmUgKSA6ICt2YWw7XG5cdFx0fVxuXHRcdHJldHVybiB2YWwgPT09IFwiXCIgfHwgaXNOYU4oIHZhbCApID8gbnVsbCA6IHZhbDtcblx0fSxcblxuXHRfZm9ybWF0OiBmdW5jdGlvbiggdmFsdWUgKSB7XG5cdFx0aWYgKCB2YWx1ZSA9PT0gXCJcIiApIHtcblx0XHRcdHJldHVybiBcIlwiO1xuXHRcdH1cblx0XHRyZXR1cm4gd2luZG93Lkdsb2JhbGl6ZSAmJiB0aGlzLm9wdGlvbnMubnVtYmVyRm9ybWF0ID9cblx0XHRcdEdsb2JhbGl6ZS5mb3JtYXQoIHZhbHVlLCB0aGlzLm9wdGlvbnMubnVtYmVyRm9ybWF0LCB0aGlzLm9wdGlvbnMuY3VsdHVyZSApIDpcblx0XHRcdHZhbHVlO1xuXHR9LFxuXG5cdF9yZWZyZXNoOiBmdW5jdGlvbigpIHtcblx0XHR0aGlzLmVsZW1lbnQuYXR0cigge1xuXHRcdFx0XCJhcmlhLXZhbHVlbWluXCI6IHRoaXMub3B0aW9ucy5taW4sXG5cdFx0XHRcImFyaWEtdmFsdWVtYXhcIjogdGhpcy5vcHRpb25zLm1heCxcblxuXHRcdFx0Ly8gVE9ETzogd2hhdCBzaG91bGQgd2UgZG8gd2l0aCB2YWx1ZXMgdGhhdCBjYW4ndCBiZSBwYXJzZWQ/XG5cdFx0XHRcImFyaWEtdmFsdWVub3dcIjogdGhpcy5fcGFyc2UoIHRoaXMuZWxlbWVudC52YWwoKSApXG5cdFx0fSApO1xuXHR9LFxuXG5cdGlzVmFsaWQ6IGZ1bmN0aW9uKCkge1xuXHRcdHZhciB2YWx1ZSA9IHRoaXMudmFsdWUoKTtcblxuXHRcdC8vIE51bGwgaXMgaW52YWxpZFxuXHRcdGlmICggdmFsdWUgPT09IG51bGwgKSB7XG5cdFx0XHRyZXR1cm4gZmFsc2U7XG5cdFx0fVxuXG5cdFx0Ly8gSWYgdmFsdWUgZ2V0cyBhZGp1c3RlZCwgaXQncyBpbnZhbGlkXG5cdFx0cmV0dXJuIHZhbHVlID09PSB0aGlzLl9hZGp1c3RWYWx1ZSggdmFsdWUgKTtcblx0fSxcblxuXHQvLyBVcGRhdGUgdGhlIHZhbHVlIHdpdGhvdXQgdHJpZ2dlcmluZyBjaGFuZ2Vcblx0X3ZhbHVlOiBmdW5jdGlvbiggdmFsdWUsIGFsbG93QW55ICkge1xuXHRcdHZhciBwYXJzZWQ7XG5cdFx0aWYgKCB2YWx1ZSAhPT0gXCJcIiApIHtcblx0XHRcdHBhcnNlZCA9IHRoaXMuX3BhcnNlKCB2YWx1ZSApO1xuXHRcdFx0aWYgKCBwYXJzZWQgIT09IG51bGwgKSB7XG5cdFx0XHRcdGlmICggIWFsbG93QW55ICkge1xuXHRcdFx0XHRcdHBhcnNlZCA9IHRoaXMuX2FkanVzdFZhbHVlKCBwYXJzZWQgKTtcblx0XHRcdFx0fVxuXHRcdFx0XHR2YWx1ZSA9IHRoaXMuX2Zvcm1hdCggcGFyc2VkICk7XG5cdFx0XHR9XG5cdFx0fVxuXHRcdHRoaXMuZWxlbWVudC52YWwoIHZhbHVlICk7XG5cdFx0dGhpcy5fcmVmcmVzaCgpO1xuXHR9LFxuXG5cdF9kZXN0cm95OiBmdW5jdGlvbigpIHtcblx0XHR0aGlzLmVsZW1lbnRcblx0XHRcdC5wcm9wKCBcImRpc2FibGVkXCIsIGZhbHNlIClcblx0XHRcdC5yZW1vdmVBdHRyKCBcImF1dG9jb21wbGV0ZSByb2xlIGFyaWEtdmFsdWVtaW4gYXJpYS12YWx1ZW1heCBhcmlhLXZhbHVlbm93XCIgKTtcblxuXHRcdHRoaXMudWlTcGlubmVyLnJlcGxhY2VXaXRoKCB0aGlzLmVsZW1lbnQgKTtcblx0fSxcblxuXHRzdGVwVXA6IHNwaW5uZXJNb2RpZmVyKCBmdW5jdGlvbiggc3RlcHMgKSB7XG5cdFx0dGhpcy5fc3RlcFVwKCBzdGVwcyApO1xuXHR9ICksXG5cdF9zdGVwVXA6IGZ1bmN0aW9uKCBzdGVwcyApIHtcblx0XHRpZiAoIHRoaXMuX3N0YXJ0KCkgKSB7XG5cdFx0XHR0aGlzLl9zcGluKCAoIHN0ZXBzIHx8IDEgKSAqIHRoaXMub3B0aW9ucy5zdGVwICk7XG5cdFx0XHR0aGlzLl9zdG9wKCk7XG5cdFx0fVxuXHR9LFxuXG5cdHN0ZXBEb3duOiBzcGlubmVyTW9kaWZlciggZnVuY3Rpb24oIHN0ZXBzICkge1xuXHRcdHRoaXMuX3N0ZXBEb3duKCBzdGVwcyApO1xuXHR9ICksXG5cdF9zdGVwRG93bjogZnVuY3Rpb24oIHN0ZXBzICkge1xuXHRcdGlmICggdGhpcy5fc3RhcnQoKSApIHtcblx0XHRcdHRoaXMuX3NwaW4oICggc3RlcHMgfHwgMSApICogLXRoaXMub3B0aW9ucy5zdGVwICk7XG5cdFx0XHR0aGlzLl9zdG9wKCk7XG5cdFx0fVxuXHR9LFxuXG5cdHBhZ2VVcDogc3Bpbm5lck1vZGlmZXIoIGZ1bmN0aW9uKCBwYWdlcyApIHtcblx0XHR0aGlzLl9zdGVwVXAoICggcGFnZXMgfHwgMSApICogdGhpcy5vcHRpb25zLnBhZ2UgKTtcblx0fSApLFxuXG5cdHBhZ2VEb3duOiBzcGlubmVyTW9kaWZlciggZnVuY3Rpb24oIHBhZ2VzICkge1xuXHRcdHRoaXMuX3N0ZXBEb3duKCAoIHBhZ2VzIHx8IDEgKSAqIHRoaXMub3B0aW9ucy5wYWdlICk7XG5cdH0gKSxcblxuXHR2YWx1ZTogZnVuY3Rpb24oIG5ld1ZhbCApIHtcblx0XHRpZiAoICFhcmd1bWVudHMubGVuZ3RoICkge1xuXHRcdFx0cmV0dXJuIHRoaXMuX3BhcnNlKCB0aGlzLmVsZW1lbnQudmFsKCkgKTtcblx0XHR9XG5cdFx0c3Bpbm5lck1vZGlmZXIoIHRoaXMuX3ZhbHVlICkuY2FsbCggdGhpcywgbmV3VmFsICk7XG5cdH0sXG5cblx0d2lkZ2V0OiBmdW5jdGlvbigpIHtcblx0XHRyZXR1cm4gdGhpcy51aVNwaW5uZXI7XG5cdH1cbn0gKTtcblxuLy8gREVQUkVDQVRFRFxuLy8gVE9ETzogc3dpdGNoIHJldHVybiBiYWNrIHRvIHdpZGdldCBkZWNsYXJhdGlvbiBhdCB0b3Agb2YgZmlsZSB3aGVuIHRoaXMgaXMgcmVtb3ZlZFxuaWYgKCAkLnVpQmFja0NvbXBhdCAhPT0gZmFsc2UgKSB7XG5cblx0Ly8gQmFja2NvbXBhdCBmb3Igc3Bpbm5lciBodG1sIGV4dGVuc2lvbiBwb2ludHNcblx0JC53aWRnZXQoIFwidWkuc3Bpbm5lclwiLCAkLnVpLnNwaW5uZXIsIHtcblx0XHRfZW5oYW5jZTogZnVuY3Rpb24oKSB7XG5cdFx0XHR0aGlzLnVpU3Bpbm5lciA9IHRoaXMuZWxlbWVudFxuXHRcdFx0XHQuYXR0ciggXCJhdXRvY29tcGxldGVcIiwgXCJvZmZcIiApXG5cdFx0XHRcdC53cmFwKCB0aGlzLl91aVNwaW5uZXJIdG1sKCkgKVxuXHRcdFx0XHQucGFyZW50KClcblxuXHRcdFx0XHRcdC8vIEFkZCBidXR0b25zXG5cdFx0XHRcdFx0LmFwcGVuZCggdGhpcy5fYnV0dG9uSHRtbCgpICk7XG5cdFx0fSxcblx0XHRfdWlTcGlubmVySHRtbDogZnVuY3Rpb24oKSB7XG5cdFx0XHRyZXR1cm4gXCI8c3Bhbj5cIjtcblx0XHR9LFxuXG5cdFx0X2J1dHRvbkh0bWw6IGZ1bmN0aW9uKCkge1xuXHRcdFx0cmV0dXJuIFwiPGE+PC9hPjxhPjwvYT5cIjtcblx0XHR9XG5cdH0gKTtcbn1cblxucmV0dXJuICQudWkuc3Bpbm5lcjtcblxufSApICk7XG4iLCIndXNlIHN0cmljdCc7XG52YXIga28gPSByZXF1aXJlKCcuL2hlcm9jYWxjX2tub2Nrb3V0Jyk7XG4gICAgXG52YXIgbXkgPSByZXF1aXJlKFwiLi4vaGVyb2NhbGMvbWFpblwiKTtcblxubXkucHJvdG90eXBlLkRhbWFnZUFtcFZpZXdNb2RlbCA9IGZ1bmN0aW9uIChhKSB7XG4gICAgdmFyIHNlbGYgPSBuZXcgbXkucHJvdG90eXBlLkJ1ZmZWaWV3TW9kZWwoa28ub2JzZXJ2YWJsZUFycmF5KFtdKSk7XG4gICAgc2VsZi5hdmFpbGFibGVCdWZmcyA9IGtvLm9ic2VydmFibGVBcnJheShbXG4gICAgICAgIG5ldyBteS5wcm90b3R5cGUuQnVmZk9wdGlvbignc2xhcmRhcicsICdzbGFyZGFyX3NwcmludCcpLFxuICAgICAgICBuZXcgbXkucHJvdG90eXBlLkJ1ZmZPcHRpb24oJ3VuZHlpbmcnLCAndW5keWluZ19mbGVzaF9nb2xlbScpLFxuICAgICAgICBuZXcgbXkucHJvdG90eXBlLkJ1ZmZPcHRpb24oJ2NoZW4nLCAnY2hlbl9wZW5pdGVuY2UnKSxcbiAgICAgICAgbmV3IG15LnByb3RvdHlwZS5CdWZmT3B0aW9uKCdtZWR1c2EnLCAnbWVkdXNhX3N0b25lX2dhemUnKSxcbiAgICAgICAgbmV3IG15LnByb3RvdHlwZS5CdWZmT3B0aW9uKCdzaGFkb3dfZGVtb24nLCAnc2hhZG93X2RlbW9uX3NvdWxfY2F0Y2hlcicpXG4gICAgXSk7XG4gICAgc2VsZi5hdmFpbGFibGVEZWJ1ZmZzID0ga28ub2JzZXJ2YWJsZUFycmF5KFtcbiAgICAgICAgbmV3IG15LnByb3RvdHlwZS5CdWZmT3B0aW9uKCdtZWR1c2EnLCAnbWVkdXNhX21hbmFfc2hpZWxkJyksXG4gICAgICAgIC8vbmV3IG15LnByb3RvdHlwZS5CdWZmT3B0aW9uKCd0ZW1wbGFyX2Fzc2Fzc2luJywgJ3RlbXBsYXJfYXNzYXNzaW5fcmVmcmFjdGlvbicpLFxuICAgICAgICAvL25ldyBteS5wcm90b3R5cGUuQnVmZk9wdGlvbignZmFjZWxlc3Nfdm9pZCcsICdmYWNlbGVzc192b2lkX2JhY2t0cmFjaycpLFxuICAgICAgICAvL25ldyBteS5wcm90b3R5cGUuQnVmZk9wdGlvbignbnl4X2Fzc2Fzc2luJywgJ255eF9hc3Nhc3Npbl9zcGlrZWRfY2FyYXBhY2UnKSxcbiAgICAgICAgbmV3IG15LnByb3RvdHlwZS5CdWZmT3B0aW9uKCdzcGVjdHJlJywgJ3NwZWN0cmVfZGlzcGVyc2lvbicpLFxuICAgICAgICBuZXcgbXkucHJvdG90eXBlLkJ1ZmZPcHRpb24oJ3dpc3AnLCAnd2lzcF9vdmVyY2hhcmdlJyksXG4gICAgICAgIG5ldyBteS5wcm90b3R5cGUuQnVmZk9wdGlvbignYnJpc3RsZWJhY2snLCAnYnJpc3RsZWJhY2tfYnJpc3RsZWJhY2snKSxcbiAgICAgICAgLy9uZXcgbXkucHJvdG90eXBlLkJ1ZmZPcHRpb24oJ2FiYWRkb24nLCAnYWJhZGRvbl9ib3Jyb3dlZF90aW1lJyksXG4gICAgICAgIC8vbmV3IG15LnByb3RvdHlwZS5CdWZmT3B0aW9uKCdhYmFkZG9uJywgJ2FiYWRkb25fYXBob3RpY19zaGllbGQnKSxcbiAgICAgICAgLy9uZXcgbXkucHJvdG90eXBlLkJ1ZmZPcHRpb24oJ2RhenpsZScsICdkYXp6bGVfc2hhbGxvd19ncmF2ZScpLFxuICAgICAgICAvL25ldyBteS5wcm90b3R5cGUuQnVmZk9wdGlvbigndHJlYW50JywgJ3RyZWFudF9saXZpbmdfYXJtb3InKSxcbiAgICAgICAgbmV3IG15LnByb3RvdHlwZS5CdWZmT3B0aW9uKCdrdW5ra2EnLCAna3Vua2thX2dob3N0c2hpcCcpXG4gICAgXSk7XG4gICAgc2VsZi5zZWxlY3RlZEJ1ZmYgPSBrby5vYnNlcnZhYmxlKHNlbGYuYXZhaWxhYmxlQnVmZnMoKVswXSk7XG4gICAgXG4gICAgc2VsZi5idWZmcyA9IGtvLm9ic2VydmFibGVBcnJheShbXSk7XG5cbiAgICBzZWxmLmdldEFiaWxpdHlEYW1hZ2VBbXBWYWx1ZSA9IGZ1bmN0aW9uIChhYmlsaXR5TmFtZSwgYXR0cmlidXRlTmFtZSkge1xuICAgICAgICB2YXIgYSA9IG15LnByb3RvdHlwZS5maW5kV2hlcmUoc2VsZi5idWZmcygpLCB7bmFtZTogYWJpbGl0eU5hbWV9KTtcbiAgICAgICAgaWYgKGEgPT0gdW5kZWZpbmVkKSB7XG4gICAgICAgICAgICByZXR1cm4gMDtcbiAgICAgICAgfVxuICAgICAgICBlbHNlIHtcbiAgICAgICAgICAgIHZhciBhYmlsaXR5ID0gYS5kYXRhO1xuICAgICAgICAgICAgcmV0dXJuIHNlbGYuZ2V0QWJpbGl0eUF0dHJpYnV0ZVZhbHVlKGFiaWxpdHkuYXR0cmlidXRlcywgYXR0cmlidXRlTmFtZSwgYWJpbGl0eS5sZXZlbCgpKTtcbiAgICAgICAgfVxuICAgIH1cbiAgICBcbiAgICBzZWxmLmdldERhbWFnZU11bHRpcGxpZXJTb3VyY2VzID0ga28uY29tcHV0ZWQoZnVuY3Rpb24gKCkge1xuICAgICAgICB2YXIgc291cmNlcyA9IHt9O1xuICAgICAgICBmb3IgKHZhciBpID0gMDsgaSA8IHNlbGYuYWJpbGl0aWVzKCkubGVuZ3RoOyBpKyspIHtcbiAgICAgICAgICAgIHZhciBhYmlsaXR5ID0gc2VsZi5hYmlsaXRpZXMoKVtpXTtcbiAgICAgICAgICAgICAgICBpZiAoYWJpbGl0eS5sZXZlbCgpID4gMCAmJiAoYWJpbGl0eS5pc0FjdGl2ZSgpIHx8IChhYmlsaXR5LmJlaGF2aW9yLmluZGV4T2YoJ0RPVEFfQUJJTElUWV9CRUhBVklPUl9QQVNTSVZFJykgIT0gLTEpKSkge1xuICAgICAgICAgICAgICAgICAgICBzd2l0Y2ggKGFiaWxpdHkubmFtZSkge1xuICAgICAgICAgICAgICAgICAgICAgICAgY2FzZSAnYnJpc3RsZWJhY2tfYnJpc3RsZWJhY2snOlxuICAgICAgICAgICAgICAgICAgICAgICAgICAgIHNvdXJjZXNbYWJpbGl0eS5uYW1lXSA9IHtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgJ211bHRpcGxpZXInOiBhYmlsaXR5LmRhbWFnZVJlZHVjdGlvbigpIC8gMTAwLFxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAnZGFtYWdlVHlwZSc6ICdwaHlzaWNhbCcsXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICdkaXNwbGF5bmFtZSc6IGFiaWxpdHkuZGlzcGxheW5hbWVcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgICAgICAgICAgICBicmVhaztcbiAgICAgICAgICAgICAgICAgICAgICAgIGNhc2UgJ3NsYXJkYXJfc3ByaW50JzpcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICBzb3VyY2VzW2FiaWxpdHkubmFtZV0gPSB7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICdtdWx0aXBsaWVyJzogc2VsZi5nZXRBYmlsaXR5QXR0cmlidXRlVmFsdWUoYWJpbGl0eS5hdHRyaWJ1dGVzLCAnYm9udXNfZGFtYWdlJywgYWJpbGl0eS5sZXZlbCgpKSAvIDEwMCxcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgJ2RhbWFnZVR5cGUnOiAncGh5c2ljYWwnLFxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAnZGlzcGxheW5hbWUnOiBhYmlsaXR5LmRpc3BsYXluYW1lXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICAgICAgICAgICAgYnJlYWs7XG4gICAgICAgICAgICAgICAgICAgICAgICBjYXNlICd1bmR5aW5nX2ZsZXNoX2dvbGVtJzpcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICBzb3VyY2VzW2FiaWxpdHkubmFtZV0gPSB7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICdtdWx0aXBsaWVyJzogYWJpbGl0eS5kYW1hZ2VBbXBsaWZpY2F0aW9uKCkgLyAxMDAsXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICdkYW1hZ2VUeXBlJzogJ3BoeXNpY2FsJyxcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgJ2Rpc3BsYXluYW1lJzogYWJpbGl0eS5kaXNwbGF5bmFtZVxuICAgICAgICAgICAgICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgICAgICAgICAgIGJyZWFrO1xuICAgICAgICAgICAgICAgICAgICAgICAgY2FzZSAnbWVkdXNhX3N0b25lX2dhemUnOlxuICAgICAgICAgICAgICAgICAgICAgICAgICAgIHNvdXJjZXNbYWJpbGl0eS5uYW1lXSA9IHtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgJ211bHRpcGxpZXInOiBzZWxmLmdldEFiaWxpdHlBdHRyaWJ1dGVWYWx1ZShhYmlsaXR5LmF0dHJpYnV0ZXMsICdib251c19waHlzaWNhbF9kYW1hZ2UnLCBhYmlsaXR5LmxldmVsKCkpIC8gMTAwLFxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAnZGFtYWdlVHlwZSc6ICdwaHlzaWNhbCcsXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICdkaXNwbGF5bmFtZSc6IGFiaWxpdHkuZGlzcGxheW5hbWVcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgICAgICAgICAgICBicmVhaztcbiAgICAgICAgICAgICAgICAgICAgICAgIGNhc2UgJ2NoZW5fcGVuaXRlbmNlJzpcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICBzb3VyY2VzW2FiaWxpdHkubmFtZV0gPSB7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICdtdWx0aXBsaWVyJzogc2VsZi5nZXRBYmlsaXR5QXR0cmlidXRlVmFsdWUoYWJpbGl0eS5hdHRyaWJ1dGVzLCAnYm9udXNfZGFtYWdlX3Rha2VuJywgYWJpbGl0eS5sZXZlbCgpKSAvIDEwMCxcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgJ2RhbWFnZVR5cGUnOiAncGh5c2ljYWwnLFxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAnZGlzcGxheW5hbWUnOiBhYmlsaXR5LmRpc3BsYXluYW1lXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICAgICAgICAgICAgYnJlYWs7XG4gICAgICAgICAgICAgICAgICAgICAgICBjYXNlICdzaGFkb3dfZGVtb25fc291bF9jYXRjaGVyJzpcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICBzb3VyY2VzW2FiaWxpdHkubmFtZV0gPSB7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICdtdWx0aXBsaWVyJzogc2VsZi5nZXRBYmlsaXR5QXR0cmlidXRlVmFsdWUoYWJpbGl0eS5hdHRyaWJ1dGVzLCAnYm9udXNfZGFtYWdlX3Rha2VuJywgYWJpbGl0eS5sZXZlbCgpKSAvIDEwMCxcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgJ2RhbWFnZVR5cGUnOiAncHVyZScsXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICdkaXNwbGF5bmFtZSc6IGFiaWxpdHkuZGlzcGxheW5hbWVcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgICAgICAgICAgICBicmVhaztcbiAgICAgICAgICAgICAgICAgICAgICAgIGNhc2UgJ21lZHVzYV9tYW5hX3NoaWVsZCc6XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgc291cmNlc1thYmlsaXR5Lm5hbWVdID0ge1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAnbXVsdGlwbGllcic6IGFiaWxpdHkuZGFtYWdlUmVkdWN0aW9uKCkgLyAxMDAsXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICdkYW1hZ2VUeXBlJzogJ3BoeXNpY2FsJyxcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgJ2Rpc3BsYXluYW1lJzogYWJpbGl0eS5kaXNwbGF5bmFtZVxuICAgICAgICAgICAgICAgICAgICAgICAgICAgIH0gICAgICAgICAgICAgICAgICAgICAgICAgICAgXG4gICAgICAgICAgICAgICAgICAgICAgICBicmVhaztcbiAgICAgICAgICAgICAgICAgICAgICAgIGNhc2UgJ3NwZWN0cmVfZGlzcGVyc2lvbic6XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgc291cmNlc1thYmlsaXR5Lm5hbWVdID0ge1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAnbXVsdGlwbGllcic6IC1zZWxmLmdldEFiaWxpdHlBdHRyaWJ1dGVWYWx1ZShhYmlsaXR5LmF0dHJpYnV0ZXMsICdkYW1hZ2VfcmVmbGVjdGlvbl9wY3QnLCBhYmlsaXR5LmxldmVsKCkpIC8gMTAwLFxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAnZGFtYWdlVHlwZSc6ICdwZXJjZW50cmVkdWN0aW9uJyxcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgJ2Rpc3BsYXluYW1lJzogYWJpbGl0eS5kaXNwbGF5bmFtZVxuICAgICAgICAgICAgICAgICAgICAgICAgICAgIH0gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIFxuICAgICAgICAgICAgICAgICAgICAgICAgYnJlYWs7XG4gICAgICAgICAgICAgICAgICAgICAgICBjYXNlICdhYmFkZG9uX2FwaG90aWNfc2hpZWxkJzpcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICBzb3VyY2VzW2FiaWxpdHkubmFtZV0gPSB7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICdtdWx0aXBsaWVyJzogc2VsZi5nZXRBYmlsaXR5QXR0cmlidXRlVmFsdWUoYWJpbGl0eS5hdHRyaWJ1dGVzLCAnZGFtYWdlX2Fic29yYicsIGFiaWxpdHkubGV2ZWwoKSksXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICdkYW1hZ2VUeXBlJzogJ2ZsYXRyZWR1Y3Rpb24nLFxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAnZGlzcGxheW5hbWUnOiBhYmlsaXR5LmRpc3BsYXluYW1lXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgfSAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgXG4gICAgICAgICAgICAgICAgICAgICAgICBicmVhaztcbiAgICAgICAgICAgICAgICAgICAgICAgIGNhc2UgJ2t1bmtrYV9naG9zdHNoaXAnOlxuICAgICAgICAgICAgICAgICAgICAgICAgICAgIHNvdXJjZXNbYWJpbGl0eS5uYW1lXSA9IHtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgJ211bHRpcGxpZXInOiAtNTAgLyAxMDAsXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICdkYW1hZ2VUeXBlJzogJ3BlcmNlbnRyZWR1Y3Rpb24nLFxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAnZGlzcGxheW5hbWUnOiBhYmlsaXR5LmRpc3BsYXluYW1lXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgfSAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgXG4gICAgICAgICAgICAgICAgICAgICAgICBicmVhaztcbiAgICAgICAgICAgICAgICAgICAgICAgIGNhc2UgJ3dpc3Bfb3ZlcmNoYXJnZSc6XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgc291cmNlc1thYmlsaXR5Lm5hbWVdID0ge1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAnbXVsdGlwbGllcic6IHNlbGYuZ2V0QWJpbGl0eUF0dHJpYnV0ZVZhbHVlKGFiaWxpdHkuYXR0cmlidXRlcywgJ2JvbnVzX2RhbWFnZV9wY3QnLCBhYmlsaXR5LmxldmVsKCkpIC8gMTAwLFxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAnZGFtYWdlVHlwZSc6ICdwZXJjZW50cmVkdWN0aW9uJyxcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgJ2Rpc3BsYXluYW1lJzogYWJpbGl0eS5kaXNwbGF5bmFtZVxuICAgICAgICAgICAgICAgICAgICAgICAgICAgIH0gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIFxuICAgICAgICAgICAgICAgICAgICAgICAgYnJlYWs7XG4gICAgICAgICAgICAgICAgICAgICAgICAvKmNhc2UgJ2ZhY2VsZXNzX3ZvaWRfYmFja3RyYWNrJzpcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICBzb3VyY2VzW2FiaWxpdHkubmFtZV0gPSB7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICdtdWx0aXBsaWVyJzogLXNlbGYuZ2V0QWJpbGl0eUF0dHJpYnV0ZVZhbHVlKGFiaWxpdHkuYXR0cmlidXRlcywgJ2RvZGdlX2NoYW5jZV9wY3QnLCBhYmlsaXR5LmxldmVsKCkpIC8gMTAwLFxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAnZGFtYWdlVHlwZSc6ICdwZXJjZW50cmVkdWN0aW9uJyxcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgJ2Rpc3BsYXluYW1lJzogYWJpbGl0eS5kaXNwbGF5bmFtZVxuICAgICAgICAgICAgICAgICAgICAgICAgICAgIH0gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIFxuICAgICAgICAgICAgICAgICAgICAgICAgYnJlYWs7Ki9cbiAgICAgICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICAgIH1cbiAgICAgICAgfVxuICAgICAgICByZXR1cm4gc291cmNlcztcbiAgICB9KTtcbiAgICBcbiAgICByZXR1cm4gc2VsZjtcbn0iLCIndXNlIHN0cmljdCc7XG52YXIga28gPSByZXF1aXJlKCcuL2hlcm9jYWxjX2tub2Nrb3V0Jyk7XG4gICAgXG52YXIgbXkgPSByZXF1aXJlKFwiLi4vaGVyb2NhbGMvbWFpblwiKTtcblxubXkucHJvdG90eXBlLkdyYXBoUHJvcGVydHlPcHRpb24gPSBmdW5jdGlvbiAoaWQsIGxhYmVsKSB7XG4gICAgdGhpcy5pZCA9IGlkO1xuICAgIHRoaXMubGFiZWwgPSBsYWJlbDtcbn07XG5cbm15LnByb3RvdHlwZS5BYmlsaXR5TW9kZWwucHJvdG90eXBlLmlzUVdFUiA9IGZ1bmN0aW9uIChhYmlsaXR5KSB7XG4gICAgcmV0dXJuIChhYmlsaXR5LmRpc3BsYXluYW1lICE9ICdFbXB0eScgJiYgIChhYmlsaXR5LmJlaGF2aW9yLmluZGV4T2YoJ0RPVEFfQUJJTElUWV9CRUhBVklPUl9ISURERU4nKSA9PSAtMSB8fCBhYmlsaXR5Lm5hbWUuaW5kZXhPZignaW52b2tlcl8nKSAhPSAtMSkgJiYgYWJpbGl0eS5iZWhhdmlvci5pbmRleE9mKCdET1RBX0FCSUxJVFlfQkVIQVZJT1JfTk9UX0xFQVJOQUJMRScpID09IC0xKVxufVxuXG5teS5wcm90b3R5cGUuQnVpbGRFeHBsb3JlclZpZXdNb2RlbCA9IGZ1bmN0aW9uIChoKSB7XG52YXIgc2VsZiA9IHRoaXM7XG4gICAgc2VsZi5wYXJlbnQgPSBoO1xuXG4gICAgc2VsZi5pdGVtQnVpbGQgPSBrby5vYnNlcnZhYmxlQXJyYXkoW10pO1xuICAgIHNlbGYuc2tpbGxCdWlsZCA9IGtvLm9ic2VydmFibGVBcnJheShbXSk7XG4gICAgc2VsZi5ncmFwaERhdGFJdGVtUm93cyA9IFtdO1xuICAgIGZvciAodmFyIGkgPSAwOyBpIDwgMjU7IGkrKykge1xuICAgICAgICBzZWxmLml0ZW1CdWlsZC5wdXNoKG5ldyBteS5wcm90b3R5cGUuQmFzaWNJbnZlbnRvcnlWaWV3TW9kZWwoKSk7XG4gICAgICAgIHNlbGYuaXRlbUJ1aWxkKClbaV0uY2FycnlPdmVyID0ga28ub2JzZXJ2YWJsZSh0cnVlKTtcbiAgICAgICAgc2VsZi5za2lsbEJ1aWxkLnB1c2goa28ub2JzZXJ2YWJsZSgtMSkpO1xuICAgICAgICBzZWxmLmdyYXBoRGF0YUl0ZW1Sb3dzLnB1c2goa28ub2JzZXJ2YWJsZShmYWxzZSkpO1xuICAgIH1cbiAgICBzZWxmLnRvZ2dsZUl0ZW1CdWlsZENhcnJ5T3ZlciA9IGZ1bmN0aW9uIChpbmRleCkge1xuICAgICAgICBzZWxmLml0ZW1CdWlsZCgpW2luZGV4XS5jYXJyeU92ZXIoIXNlbGYuaXRlbUJ1aWxkKClbaW5kZXhdLmNhcnJ5T3ZlcigpKTtcbiAgICB9XG4gICAgXG4gICAgc2VsZi5hYmlsaXR5TWFwRGF0YSA9IFswLDEsMiwzLDRdO1xuICAgIHNlbGYuYWJpbGl0eU1hcEhlcm8gPSBzZWxmLnBhcmVudC5zZWxlY3RlZEhlcm8oKS5oZXJvTmFtZTtcbiAgICBzZWxmLmFiaWxpdHlNYXAgPSBrby5jb21wdXRlZChmdW5jdGlvbiAoKSB7XG4gICAgICAgIGlmIChzZWxmLmFiaWxpdHlNYXBIZXJvID09IHNlbGYucGFyZW50LnNlbGVjdGVkSGVybygpLmhlcm9OYW1lKSByZXR1cm47XG4gICAgICAgIHNlbGYuYWJpbGl0eU1hcEhlcm8gPSBzZWxmLnBhcmVudC5zZWxlY3RlZEhlcm8oKS5oZXJvTmFtZTtcbiAgICAgICAgdmFyIG5ld01hcCA9IHNlbGYucGFyZW50LmFiaWxpdHkoKS5hYmlsaXRpZXMoKS5tYXAoZnVuY3Rpb24oYWJpbGl0eSwgaW5kZXgpIHtcbiAgICAgICAgICAgIGlmIChzZWxmLnBhcmVudC5hYmlsaXR5KCkuaXNRV0VSKGFiaWxpdHkpKSB7XG4gICAgICAgICAgICAgICAgcmV0dXJuIGluZGV4O1xuICAgICAgICAgICAgfVxuICAgICAgICAgICAgZWxzZSB7XG4gICAgICAgICAgICAgICAgcmV0dXJuIC0xO1xuICAgICAgICAgICAgfVxuICAgICAgICB9KS5maWx0ZXIoZnVuY3Rpb24oZWxlbWVudCkgeyByZXR1cm4gZWxlbWVudCAhPSAtMTsgfSk7XG4gICAgICAgIGZvciAodmFyIGkgPSAwOyBpIDwgMjU7IGkrKykge1xuICAgICAgICAgICAgdmFyIGFiaWxpdHlWYWx1ZSA9IHNlbGYuc2tpbGxCdWlsZCgpW2ldKCk7XG4gICAgICAgICAgICBpZiAoYWJpbGl0eVZhbHVlID09IC0xKSBjb250aW51ZTtcbiAgICAgICAgICAgIFxuICAgICAgICAgICAgdmFyIGFiaWxpdHlJbmRleCA9IHNlbGYuYWJpbGl0eU1hcERhdGEuaW5kZXhPZihhYmlsaXR5VmFsdWUpO1xuICAgICAgICAgICAgdmFyIG5ld1ZhbHVlID0gbmV3TWFwW2FiaWxpdHlJbmRleF07XG4gICAgICAgICAgICBpZiAobmV3VmFsdWUgIT0gYWJpbGl0eVZhbHVlKSB7XG4gICAgICAgICAgICAgICAgc2VsZi5za2lsbEJ1aWxkKClbaV0obmV3VmFsdWUpO1xuICAgICAgICAgICAgfVxuICAgICAgICB9XG4gICAgICAgIHNlbGYuYWJpbGl0eU1hcERhdGEgPSBuZXdNYXA7XG4gICAgfSk7XG4gICAgXG4gICAgc2VsZi5hdmFpbGFibGVTa2lsbEJ1aWxkUG9pbnRzID0ga28uY29tcHV0ZWQoZnVuY3Rpb24gKCkge1xuICAgICAgICByZXR1cm4gc2VsZi5za2lsbEJ1aWxkKCkucmVkdWNlKGZ1bmN0aW9uKG1lbW8sIG51bSl7IHJldHVybiBtZW1vICsgKG51bSgpID09IC0xKTsgfSwgMCk7XG4gICAgfSk7XG4gICAgc2VsZi5nZXRTa2lsbEJ1aWxkQWJpbGl0eUxldmVsID0gZnVuY3Rpb24gKGluZGV4KSB7XG4gICAgICAgIHJldHVybiBzZWxmLnNraWxsQnVpbGQoKS5yZWR1Y2UoZnVuY3Rpb24obWVtbywgbnVtKXsgcmV0dXJuIG1lbW8gKyAobnVtKCkgPT0gaW5kZXgpOyB9LCAwKTtcbiAgICB9O1xuICAgIHNlbGYudG9nZ2xlQWJpbGl0eVNraWxsQnVpbGQgPSBmdW5jdGlvbiAoaW5kZXgsIGFiaWxpdHlJbmRleCwgZGF0YSwgZXZlbnQpIHtcbiAgICAgICAgaWYgKHNlbGYuc2tpbGxCdWlsZCgpW2luZGV4XSgpICE9IGFiaWxpdHlJbmRleCkge1xuICAgICAgICAgICAgdmFyIGFiaWxpdHkgPSBzZWxmLnBhcmVudC5hYmlsaXR5KCkuYWJpbGl0aWVzKClbYWJpbGl0eUluZGV4XSxcbiAgICAgICAgICAgICAgICBhYmlsaXR5VHlwZSA9IGFiaWxpdHkuYWJpbGl0eXR5cGUsXG4gICAgICAgICAgICAgICAgc2tpbGxCdWlsZFNsaWNlID0gc2VsZi5za2lsbEJ1aWxkKCkuc2xpY2UoMCwgaW5kZXgpLFxuICAgICAgICAgICAgICAgIGN1cnJlbnRBYmlsaXR5TGV2ZWwgPSBzZWxmLnNraWxsQnVpbGQoKS5yZWR1Y2UoZnVuY3Rpb24obWVtbywgbnVtKXsgcmV0dXJuIG1lbW8gKyAobnVtKCkgPT0gYWJpbGl0eUluZGV4KTsgfSwgMCksXG4gICAgICAgICAgICAgICAgbiA9IHNraWxsQnVpbGRTbGljZS5yZWR1Y2UoZnVuY3Rpb24obWVtbywgbnVtKXsgcmV0dXJuIG1lbW8gKyAobnVtKCkgPT0gYWJpbGl0eUluZGV4KTsgfSwgMCk7XG4gICAgICAgICAgICBcbiAgICAgICAgICAgIGlmIChzZWxmLklzVmFsaWRBYmlsaXR5TGV2ZWwoYWJpbGl0eSwgc2VsZi5wYXJlbnQuc2VsZWN0ZWRIZXJvKCkuaGVyb05hbWUsIGluZGV4ICsgMSwgbikpIHtcbiAgICAgICAgICAgICAgICBzZWxmLnNraWxsQnVpbGQoKVtpbmRleF0oYWJpbGl0eUluZGV4KTtcbiAgICAgICAgICAgICAgICBmb3IgKHZhciBpID0gaW5kZXggKyAxOyBpIDwgMjU7IGkrKykge1xuICAgICAgICAgICAgICAgICAgICBpZiAoc2VsZi5za2lsbEJ1aWxkKClbaV0oKSA9PSBhYmlsaXR5SW5kZXgpIHtcbiAgICAgICAgICAgICAgICAgICAgICAgIG4rKztcbiAgICAgICAgICAgICAgICAgICAgICAgIGlmICghc2VsZi5Jc1ZhbGlkQWJpbGl0eUxldmVsKGFiaWxpdHksIHNlbGYucGFyZW50LnNlbGVjdGVkSGVybygpLmhlcm9OYW1lLCBpICsgMSwgbikpIHtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICBzZWxmLnNraWxsQnVpbGQoKVtpXSgtMSk7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgbi0tO1xuICAgICAgICAgICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgfVxuICAgICAgICAgICAgZWxzZSBpZiAobiA+IDAgJiYgc2VsZi5Jc1ZhbGlkQWJpbGl0eUxldmVsKGFiaWxpdHksIHNlbGYucGFyZW50LnNlbGVjdGVkSGVybygpLmhlcm9OYW1lLCBpbmRleCArIDEsIG4gLSAxKSkge1xuICAgICAgICAgICAgICAgIGZvciAodmFyIGkgPSBza2lsbEJ1aWxkU2xpY2UubGVuZ3RoIC0gMTsgaSA+PSAwOyBpLS0pIHtcbiAgICAgICAgICAgICAgICAgICAgaWYgKHNraWxsQnVpbGRTbGljZVtpXSgpID09IGFiaWxpdHlJbmRleCkge1xuICAgICAgICAgICAgICAgICAgICAgICAgc2VsZi5za2lsbEJ1aWxkKClbaV0oLTEpO1xuICAgICAgICAgICAgICAgICAgICAgICAgc2VsZi5za2lsbEJ1aWxkKClbaW5kZXhdKGFiaWxpdHlJbmRleCk7XG4gICAgICAgICAgICAgICAgICAgICAgICBicmVhaztcbiAgICAgICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgIH1cbiAgICAgICAgfVxuICAgICAgICBlbHNlIHtcbiAgICAgICAgICAgIHNlbGYuc2tpbGxCdWlsZCgpW2luZGV4XSgtMSk7XG4gICAgICAgIH1cbiAgICB9O1xuICAgIHNlbGYuSXNWYWxpZEFiaWxpdHlMZXZlbCA9IGZ1bmN0aW9uIChhYmlsaXR5LCBoZXJvTmFtZSwgaGVyb0xldmVsLCBhYmlsaXR5TGV2ZWwpIHtcbiAgICAgICAgdmFyIGEgPSAxLCBiID0gMiwgbSA9IDQ7XG4gICAgICAgIGlmIChhYmlsaXR5Lm5hbWUgPT0gJ2F0dHJpYnV0ZV9ib251cycpIHtcbiAgICAgICAgICAgIG0gPSAxMDtcbiAgICAgICAgfVxuICAgICAgICBlbHNlIHtcbiAgICAgICAgICAgIGlmIChhYmlsaXR5LmFiaWxpdHl0eXBlID09ICdET1RBX0FCSUxJVFlfVFlQRV9VTFRJTUFURScpIHtcbiAgICAgICAgICAgICAgICBpZiAoaGVyb05hbWUgPT0gJ2ludm9rZXInKSB7XG4gICAgICAgICAgICAgICAgICAgIGEgPSAyO1xuICAgICAgICAgICAgICAgICAgICBiID0gNTtcbiAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgICAgZWxzZSBpZiAoaGVyb05hbWUgPT0gJ21lZXBvJykge1xuICAgICAgICAgICAgICAgICAgICBhID0gMztcbiAgICAgICAgICAgICAgICAgICAgYiA9IDc7XG4gICAgICAgICAgICAgICAgICAgIG0gPSAzO1xuICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgICBlbHNlIHtcbiAgICAgICAgICAgICAgICAgICAgYSA9IDY7XG4gICAgICAgICAgICAgICAgICAgIGIgPSA1O1xuICAgICAgICAgICAgICAgICAgICBtID0gMztcbiAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICB9XG4gICAgICAgICAgICBlbHNlIHtcbiAgICAgICAgICAgICAgICBpZiAoaGVyb05hbWUgPT0gJ2ludm9rZXInKSB7XG4gICAgICAgICAgICAgICAgICAgIG0gPSA3O1xuICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgIH0gICAgICAgICAgICAgICAgXG4gICAgICAgIH1cbiAgICAgICAgXG4gICAgICAgIHJldHVybiBoZXJvTGV2ZWwgPj0gYSArIGIgKiBhYmlsaXR5TGV2ZWwgJiYgYWJpbGl0eUxldmVsIDwgbTtcbiAgICB9XG4gICAgXG4gICAgc2VsZi5yZXNldEl0ZW1CdWlsZCA9IGZ1bmN0aW9uIChpbmRleCkge1xuICAgICAgICBzZWxmLml0ZW1CdWlsZCgpW2luZGV4XS5yZW1vdmVBbGwoKTtcbiAgICB9OyAgICAgICAgXG4gICAgc2VsZi5yZXNldEFsbEl0ZW1CdWlsZHMgPSBmdW5jdGlvbiAoKSB7XG4gICAgICAgIGZvciAodmFyIGkgPSAwOyBpIDwgMjU7IGkrKykge1xuICAgICAgICAgICAgc2VsZi5pdGVtQnVpbGQoKVtpXS5yZW1vdmVBbGwoKTtcbiAgICAgICAgICAgIHNlbGYuaXRlbUJ1aWxkKClbaV0uY2FycnlPdmVyKHRydWUpO1xuICAgICAgICB9XG4gICAgfTtcbiAgICBzZWxmLnJlc2V0U2tpbGxCdWlsZCA9IGZ1bmN0aW9uICgpIHtcbiAgICAgICAgZm9yICh2YXIgaSA9IDA7IGkgPCAyNTsgaSsrKSB7XG4gICAgICAgICAgICBzZWxmLnNraWxsQnVpbGQoKVtpXSgtMSk7XG4gICAgICAgIH1cbiAgICB9O1xuICAgIHNlbGYuZ3JhcGhEYXRhID0ga28ub2JzZXJ2YWJsZUFycmF5KFtdKTtcbiAgICBzZWxmLmdyYXBoRGF0YUhlYWRlciA9IGtvLm9ic2VydmFibGUoc2VsZi5wYXJlbnQuc2VsZWN0ZWRIZXJvKCkuaGVyb0Rpc3BsYXlOYW1lKTtcbiAgICBzZWxmLnBhcmVudC5zZWxlY3RlZEhlcm8uc3Vic2NyaWJlKGZ1bmN0aW9uIChuZXdWYWx1ZSkge1xuICAgICAgICBzZWxmLmdyYXBoRGF0YUhlYWRlcihzZWxmLnBhcmVudC5zZWxlY3RlZEhlcm8oKS5oZXJvRGlzcGxheU5hbWUpO1xuICAgIH0pO1xuICAgIHNlbGYuZ3JhcGhEYXRhRGVzY3JpcHRpb24gPSBrby5vYnNlcnZhYmxlKCcnKTtcbiAgICBzZWxmLmdyYXBoUHJvcGVydGllcyA9IGtvLm9ic2VydmFibGVBcnJheShbXG4gICAgICAgIG5ldyBteS5wcm90b3R5cGUuR3JhcGhQcm9wZXJ0eU9wdGlvbigndG90YWxBcm1vclBoeXNpY2FsJywgJ0FybW9yJyksXG4gICAgICAgIG5ldyBteS5wcm90b3R5cGUuR3JhcGhQcm9wZXJ0eU9wdGlvbigndG90YWxBcm1vclBoeXNpY2FsUmVkdWN0aW9uJywgJ1BoeXNpY2FsIERhbWFnZSBSZWR1Y3Rpb24nKSxcbiAgICAgICAgbmV3IG15LnByb3RvdHlwZS5HcmFwaFByb3BlcnR5T3B0aW9uKCd0b3RhbE1hZ2ljUmVzaXN0YW5jZScsICdNYWdpY2FsIFJlc2lzdGFuY2UnKSxcbiAgICAgICAgbmV3IG15LnByb3RvdHlwZS5HcmFwaFByb3BlcnR5T3B0aW9uKCdoZWFsdGgnLCAnSGVhbHRoJyksXG4gICAgICAgIG5ldyBteS5wcm90b3R5cGUuR3JhcGhQcm9wZXJ0eU9wdGlvbignaGVhbHRocmVnZW4nLCAnSGVhbHRoIFJlZ2VuZXJhdGlvbicpLFxuICAgICAgICBuZXcgbXkucHJvdG90eXBlLkdyYXBoUHJvcGVydHlPcHRpb24oJ21hbmEnLCAnTWFuYScpLFxuICAgICAgICBuZXcgbXkucHJvdG90eXBlLkdyYXBoUHJvcGVydHlPcHRpb24oJ21hbmFyZWdlbicsICdNYW5hIFJlZ2VuZXJhdGlvbicpLFxuICAgICAgICBuZXcgbXkucHJvdG90eXBlLkdyYXBoUHJvcGVydHlPcHRpb24oJ2VocFBoeXNpY2FsJywgJ0VIUCBQaHlzaWNhbCcpLFxuICAgICAgICBuZXcgbXkucHJvdG90eXBlLkdyYXBoUHJvcGVydHlPcHRpb24oJ2VocE1hZ2ljYWwnLCAnRUhQIE1hZ2ljYWwnKSxcbiAgICAgICAgbmV3IG15LnByb3RvdHlwZS5HcmFwaFByb3BlcnR5T3B0aW9uKCdkYW1hZ2UnLCAnRGFtYWdlIHBlciBhdHRhY2snKSxcbiAgICAgICAgbmV3IG15LnByb3RvdHlwZS5HcmFwaFByb3BlcnR5T3B0aW9uKCdkcHMnLCAnRGFtYWdlIHBlciBzZWNvbmQnKSxcbiAgICAgICAgbmV3IG15LnByb3RvdHlwZS5HcmFwaFByb3BlcnR5T3B0aW9uKCdhdHRhY2tzUGVyU2Vjb25kJywgJ0F0dGFja3MgcGVyIHNlY29uZCcpLFxuICAgICAgICBuZXcgbXkucHJvdG90eXBlLkdyYXBoUHJvcGVydHlPcHRpb24oJ2F0dGFja1RpbWUnLCAnVGltZSBwZXIgYXR0YWNrJylcbiAgICBdKTtcbiAgICBzZWxmLmdyYXBoID0gZnVuY3Rpb24oKSB7XG4gICAgICAgIHZhciBzYXZlZEFiaWxpdHlMZXZlbHMgPSBbXSxcbiAgICAgICAgICAgIHNhdmVkTGV2ZWwgPSBzZWxmLnBhcmVudC5zZWxlY3RlZEhlcm9MZXZlbCgpLFxuICAgICAgICAgICAgc2F2ZWRJdGVtcyA9IHNlbGYucGFyZW50LmludmVudG9yeS5pdGVtcygpLFxuICAgICAgICAgICAgc2F2ZWRBY3RpdmVJdGVtcyA9IHNlbGYucGFyZW50LmludmVudG9yeS5hY3RpdmVJdGVtcygpLFxuICAgICAgICAgICAgcyA9IGtvLnRvSlMoc2VsZi5za2lsbEJ1aWxkKSxcbiAgICAgICAgICAgIGNhcnJ5T3Zlckl0ZW1zID0gW10sXG4gICAgICAgICAgICBjYXJyeU92ZXJBY3RpdmVJdGVtcyA9IFtdLFxuICAgICAgICAgICAgZGF0YXNldCA9IFtdO1xuICAgICAgICBmb3IgKHZhciBpID0gMDsgaSA8IHNlbGYucGFyZW50LmFiaWxpdHkoKS5hYmlsaXRpZXMoKS5sZW5ndGg7IGkrKykge1xuICAgICAgICAgICAgc2F2ZWRBYmlsaXR5TGV2ZWxzLnB1c2goc2VsZi5wYXJlbnQuYWJpbGl0eSgpLmFiaWxpdGllcygpW2ldLmxldmVsKCkpO1xuICAgICAgICB9XG4gICAgICAgIGZvciAodmFyIGkgPSAxOyBpIDwgMjY7IGkrKykge1xuICAgICAgICAgICAgc2VsZi5wYXJlbnQuc2VsZWN0ZWRIZXJvTGV2ZWwoaSk7XG4gICAgICAgICAgICB2YXIgc2tpbGxCdWlsZFN1YnNldCA9IHMuc2xpY2UoMCwgaSk7XG4gICAgICAgICAgICBmb3IgKHZhciBqID0gMDsgaiA8IHNlbGYucGFyZW50LmFiaWxpdHkoKS5hYmlsaXRpZXMoKS5sZW5ndGg7IGorKykge1xuICAgICAgICAgICAgICAgIHZhciBhID0gc2VsZi5wYXJlbnQuYWJpbGl0eSgpLmFiaWxpdGllcygpW2pdLFxuICAgICAgICAgICAgICAgICAgICBjb3VudCA9IHNraWxsQnVpbGRTdWJzZXQucmVkdWNlKGZ1bmN0aW9uKG1lbW8sIG51bSkge1xuICAgICAgICAgICAgICAgICAgICAgICAgcmV0dXJuIG1lbW8gKyAobnVtID09IGopO1xuICAgICAgICAgICAgICAgICAgICB9LCAwKTtcbiAgICAgICAgICAgICAgICBhLmxldmVsKGNvdW50KTtcbiAgICAgICAgICAgIH1cblxuICAgICAgICAgICAgaWYgKCFzZWxmLml0ZW1CdWlsZCgpW2kgLSAxXS5jYXJyeU92ZXIoKSkge1xuICAgICAgICAgICAgICAgIGNhcnJ5T3Zlckl0ZW1zID0gW107XG4gICAgICAgICAgICAgICAgY2FycnlPdmVyQWN0aXZlSXRlbXMgPSBbXTtcbiAgICAgICAgICAgIH1cbiAgICAgICAgICAgIGNhcnJ5T3Zlckl0ZW1zID0gY2FycnlPdmVySXRlbXMuY29uY2F0KHNlbGYuaXRlbUJ1aWxkKClbaSAtIDFdLml0ZW1zKCkpO1xuICAgICAgICAgICAgY2FycnlPdmVyQWN0aXZlSXRlbXMgPSBjYXJyeU92ZXJBY3RpdmVJdGVtcy5jb25jYXQoc2VsZi5pdGVtQnVpbGQoKVtpIC0gMV0uYWN0aXZlSXRlbXMoKSk7XG5cbiAgICAgICAgICAgIHNlbGYucGFyZW50LmludmVudG9yeS5pdGVtcyhjYXJyeU92ZXJJdGVtcyk7XG4gICAgICAgICAgICBzZWxmLnBhcmVudC5pbnZlbnRvcnkuYWN0aXZlSXRlbXMoY2FycnlPdmVyQWN0aXZlSXRlbXMpO1xuICAgICAgICAgICAgdmFyIGRhdGFPYmogPSB7fTtcbiAgICAgICAgICAgIGZvciAodmFyIGogPSAwOyBqIDwgc2VsZi5ncmFwaFByb3BlcnRpZXMoKS5sZW5ndGg7IGorKykge1xuICAgICAgICAgICAgICAgIHZhciBwcm9wID0gc2VsZi5ncmFwaFByb3BlcnRpZXMoKVtqXTtcbiAgICAgICAgICAgICAgICBzd2l0Y2ggKHByb3AuaWQpIHtcbiAgICAgICAgICAgICAgICAgICAgY2FzZSAnZHBzJzpcbiAgICAgICAgICAgICAgICAgICAgICAgIGRhdGFPYmpbcHJvcC5pZF0gPSBzZWxmLnBhcmVudFsnZGFtYWdlVG90YWxJbmZvJ10oKS50b3RhbFJvd1syXSgpLnRvRml4ZWQoMik7XG4gICAgICAgICAgICAgICAgICAgICAgICBicmVhaztcbiAgICAgICAgICAgICAgICAgICAgY2FzZSAnZGFtYWdlJzpcbiAgICAgICAgICAgICAgICAgICAgICAgIGRhdGFPYmpbcHJvcC5pZF0gPSBzZWxmLnBhcmVudFsnZGFtYWdlVG90YWxJbmZvJ10oKS50b3RhbFJvd1swXSgpLnRvRml4ZWQoMik7XG4gICAgICAgICAgICAgICAgICAgICAgICBicmVhaztcbiAgICAgICAgICAgICAgICAgICAgZGVmYXVsdDpcbiAgICAgICAgICAgICAgICAgICAgICAgIGRhdGFPYmpbcHJvcC5pZF0gPSBzZWxmLnBhcmVudFtwcm9wLmlkXSgpO1xuICAgICAgICAgICAgICAgICAgICAgICAgYnJlYWs7XG4gICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgfVxuXG4gICAgICAgICAgICBkYXRhT2JqLml0ZW1zID0gY2FycnlPdmVySXRlbXMubWFwKGZ1bmN0aW9uKGl0ZW0pIHtcbiAgICAgICAgICAgICAgICByZXR1cm4ga28udG9KUyhpdGVtKTtcbiAgICAgICAgICAgIH0pO1xuICAgICAgICAgICAgZGF0YXNldC5wdXNoKGRhdGFPYmopO1xuICAgICAgICAgICAgaWYgKGNhcnJ5T3Zlckl0ZW1zID4gMCkge1xuICAgICAgICAgICAgICAgIHNlbGYuZ3JhcGhEYXRhSXRlbVJvd3NbaSAtIDFdKHRydWUpO1xuICAgICAgICAgICAgfVxuICAgICAgICB9XG4gICAgICAgIHZhciBkYXRhID0ge1xuICAgICAgICAgICAgaGVhZGVyOiBzZWxmLmdyYXBoRGF0YUhlYWRlcigpLFxuICAgICAgICAgICAgZGVzY3JpcHRpb246IHNlbGYuZ3JhcGhEYXRhRGVzY3JpcHRpb24oKSxcbiAgICAgICAgICAgIGl0ZW1zOiBzZWxmLnBhcmVudC5pbnZlbnRvcnkuaXRlbXMoKS5tYXAoZnVuY3Rpb24oaXRlbSkge1xuICAgICAgICAgICAgICAgIHJldHVybiBrby50b0pTKGl0ZW0pO1xuICAgICAgICAgICAgfSksXG4gICAgICAgICAgICBza2lsbEJ1aWxkOiBrby50b0pTKHNlbGYuc2tpbGxCdWlsZCksXG4gICAgICAgICAgICBkYXRhOiBkYXRhc2V0LFxuICAgICAgICAgICAgYWJpbGl0eU1hcDogc2VsZi5hYmlsaXR5TWFwRGF0YS5zbGljZSgwKSxcbiAgICAgICAgICAgIGN1bXVsYXRpdmVTa2lsbEJ1aWxkOiBbXSxcbiAgICAgICAgICAgIHZpc2libGU6IGtvLm9ic2VydmFibGUodHJ1ZSlcbiAgICAgICAgfVxuICAgICAgICBmb3IgKHZhciBpID0gMDsgaSA8IDI1OyBpKyspIHtcbiAgICAgICAgICAgIHZhciBza2lsbEJ1aWxkQXRMZXZlbCA9IFtdLFxuICAgICAgICAgICAgICAgIHNraWxsQnVpbGRTbGljZSA9IGRhdGEuc2tpbGxCdWlsZC5zbGljZSgwLCBpICsgMSk7XG4gICAgICAgICAgICBmb3IgKHZhciBqID0gMDsgaiA8IGRhdGEuYWJpbGl0eU1hcC5sZW5ndGg7IGorKykge1xuICAgICAgICAgICAgICAgIHZhciBhYmlsaXR5SW5kZXggPSBkYXRhLmFiaWxpdHlNYXBbal07XG4gICAgICAgICAgICAgICAgc2tpbGxCdWlsZEF0TGV2ZWwucHVzaChza2lsbEJ1aWxkU2xpY2UucmVkdWNlKGZ1bmN0aW9uKG1lbW8sIG51bSkge1xuICAgICAgICAgICAgICAgICAgICByZXR1cm4gbWVtbyArIChudW0gPT0gYWJpbGl0eUluZGV4KTtcbiAgICAgICAgICAgICAgICB9LCAwKSk7XG4gICAgICAgICAgICB9XG4gICAgICAgICAgICBkYXRhLmN1bXVsYXRpdmVTa2lsbEJ1aWxkLnB1c2goc2tpbGxCdWlsZEF0TGV2ZWwpO1xuICAgICAgICB9XG5cbiAgICAgICAgc2VsZi5ncmFwaERhdGEucHVzaChkYXRhKTtcbiAgICAgICAgc2VsZi5wYXJlbnQuc2VsZWN0ZWRIZXJvTGV2ZWwoc2F2ZWRMZXZlbCk7XG4gICAgICAgIGZvciAodmFyIGkgPSAwOyBpIDwgc2VsZi5wYXJlbnQuYWJpbGl0eSgpLmFiaWxpdGllcygpLmxlbmd0aDsgaSsrKSB7XG4gICAgICAgICAgICBzZWxmLnBhcmVudC5hYmlsaXR5KCkuYWJpbGl0aWVzKClbaV0ubGV2ZWwoc2F2ZWRBYmlsaXR5TGV2ZWxzW2ldKTtcbiAgICAgICAgfVxuICAgICAgICBzZWxmLnBhcmVudC5pbnZlbnRvcnkuaXRlbXMoc2F2ZWRJdGVtcyk7XG4gICAgICAgIHNlbGYucGFyZW50LmludmVudG9yeS5hY3RpdmVJdGVtcyhzYXZlZEFjdGl2ZUl0ZW1zKTtcbiAgICB9O1xuICAgIHNlbGYucmVtb3ZlR3JhcGhEYXRhU2V0ID0gZnVuY3Rpb24gKGRhdGEpIHtcbiAgICAgICAgc2VsZi5ncmFwaERhdGEucmVtb3ZlKGRhdGEpO1xuICAgIH1cbiAgICBzZWxmLnNlbGVjdGVkR3JhcGhQcm9wZXJ0eSA9IGtvLm9ic2VydmFibGUoc2VsZi5ncmFwaFByb3BlcnRpZXMoKVswXS5pZCk7XG4gICAgXG4gICAgc2VsZi5ncmFwaENoYXJ0T3B0aW9ucyA9IGtvLmNvbXB1dGVkKGZ1bmN0aW9uICgpIHtcbiAgICAgICAgLy92YXIgY29sb3IgPSBteS5wcm90b3R5cGUudGhlbWUoKSA9PSAnZGFyaycgPyAncmdiKDE1MSwgMTU0LCAxNjIpJyA6ICdyZ2IoNTEsIDUxLCA1MSknO1xuICAgICAgICB2YXIgY29sb3IgPSAncmdiKDE1MSwgMTU0LCAxNjIpJztcbiAgICAgICAgcmV0dXJuIHtcbiAgICAgICAgICAgIHJlc3BvbnNpdmU6IHRydWUsXG4gICAgICAgICAgICBkYXRhc2V0U3Ryb2tlOiBmYWxzZSxcbiAgICAgICAgICAgIGRhdGFzZXRTdHJva2VXaWR0aDogLTEsXG4gICAgICAgICAgICBkYXRhc2V0RmlsbDogZmFsc2UsXG4gICAgICAgICAgICBwb2ludEhpdERldGVjdGlvblJhZGl1cyA6IDEwLFxuICAgICAgICAgICAgc2NhbGVGb250Q29sb3I6IGNvbG9yLFxuICAgICAgICAgICAgc2NhbGVMaW5lQ29sb3I6IGNvbG9yLnJlcGxhY2UoJ3JnYicsICdyZ2JhJykucmVwbGFjZSgnKScsICcsIC4xKScpLFxuICAgICAgICAgICAgc2NhbGVHcmlkTGluZUNvbG9yOiBjb2xvci5yZXBsYWNlKCdyZ2InLCAncmdiYScpLnJlcGxhY2UoJyknLCAnLCAuMSknKVxuICAgICAgICB9XG4gICAgfSk7XG4gICAgc2VsZi5ncmFwaENoYXJ0RGF0YSA9IGtvLmNvbXB1dGVkKGZ1bmN0aW9uICgpIHtcbiAgICAgICAgdmFyIGRhdGEgPSB7XG4gICAgICAgICAgICBsYWJlbHM6IFtdLFxuICAgICAgICAgICAgZGF0YXNldHM6IFtdXG4gICAgICAgIH1cbiAgICAgICAgZm9yICh2YXIgaSA9IDA7IGkgPCAyNTsgaSsrKSB7XG4gICAgICAgICAgICBkYXRhLmxhYmVscy5wdXNoKChpKzEpLnRvU3RyaW5nKCkpO1xuICAgICAgICB9XG4gICAgICAgIGZvciAodmFyIGkgPSAwOyBpIDwgc2VsZi5ncmFwaERhdGEoKS5sZW5ndGg7IGkrKykge1xuICAgICAgICAgICAgdmFyIGRhdGFPYmogPSBzZWxmLmdyYXBoRGF0YSgpW2ldLFxuICAgICAgICAgICAgICAgIGRhdGFzZXQgPSB7XG4gICAgICAgICAgICAgICAgICAgIGxhYmVsOiBkYXRhT2JqLmhlYWRlcixcbiAgICAgICAgICAgICAgICAgICAgZmlsbENvbG9yOiBzZWxmLmdyYXBoRGlzdGluY3RDb2xvcihzZWxmLmdyYXBoRGF0YSgpLmxlbmd0aCwgaSwgLjEpLFxuICAgICAgICAgICAgICAgICAgICBzdHJva2VDb2xvcjogc2VsZi5ncmFwaERpc3RpbmN0Q29sb3Ioc2VsZi5ncmFwaERhdGEoKS5sZW5ndGgsIGksIDEpLFxuICAgICAgICAgICAgICAgICAgICBwb2ludENvbG9yOiBzZWxmLmdyYXBoRGlzdGluY3RDb2xvcihzZWxmLmdyYXBoRGF0YSgpLmxlbmd0aCwgaSwgMSksXG4gICAgICAgICAgICAgICAgICAgIHBvaW50U3Ryb2tlQ29sb3I6IHNlbGYuZ3JhcGhEaXN0aW5jdENvbG9yKHNlbGYuZ3JhcGhEYXRhKCkubGVuZ3RoLCBpLCAxKSxcbiAgICAgICAgICAgICAgICAgICAgcG9pbnRIaWdobGlnaHRGaWxsOiBzZWxmLmdyYXBoRGlzdGluY3RDb2xvcihzZWxmLmdyYXBoRGF0YSgpLmxlbmd0aCwgaSwgLjEpLFxuICAgICAgICAgICAgICAgICAgICBwb2ludEhpZ2hsaWdodFN0cm9rZTogc2VsZi5ncmFwaERpc3RpbmN0Q29sb3Ioc2VsZi5ncmFwaERhdGEoKS5sZW5ndGgsIGksIC41KSxcbiAgICAgICAgICAgICAgICAgICAgZGF0YTogZGF0YU9iai5kYXRhLm1hcChmdW5jdGlvbiAobykge1xuICAgICAgICAgICAgICAgICAgICAgICAgcmV0dXJuIG9bc2VsZi5zZWxlY3RlZEdyYXBoUHJvcGVydHkoKV1cbiAgICAgICAgICAgICAgICAgICAgfSlcbiAgICAgICAgICAgICAgICB9O1xuICAgICAgICAgICAgZGF0YS5kYXRhc2V0cy5wdXNoKGRhdGFzZXQpO1xuICAgICAgICB9XG4gICAgICAgIHJldHVybiBkYXRhO1xuICAgIH0pO1xuICAgIHNlbGYuZ3JhcGhEaXN0aW5jdENvbG9yID0gZnVuY3Rpb24gKG1heCwgaW5kZXgsIGFscGhhKSB7XG4gICAgICAgIHZhciBhbHBoYSA9IGFscGhhIHx8IDEsXG4gICAgICAgICAgICByZ2JhID0gc2VsZi5oc2xUb1JnYigoMSAvIG1heCkgKiBpbmRleCAlIDEsIDEsIC41KTtcbiAgICAgICAgcmdiYS5wdXNoKGFscGhhKTtcbiAgICAgICAgcmV0dXJuIFwicmdiYShcIiArIHJnYmEuam9pbigpICsgXCIpXCI7XG4gICAgfVxuICAgIHNlbGYuZ2V0RGlzdGluY3RDb2xvciA9IGZ1bmN0aW9uIChtYXgsIGluZGV4LCBhbHBoYSkge1xuICAgICAgICB2YXIgYWxwaGEgPSBhbHBoYSB8fCAxO1xuICAgICAgICByZ2JhID0gc2VsZi5oc2xUb1JnYigoMSAvIG1heCkgKiBpbmRleCAlIDEsIDEsIC41KTtcbiAgICAgICAgcmdiYS5wdXNoKGFscGhhKTtcbiAgICAgICAgcmV0dXJuIHJnYmE7XG4gICAgfVxuICAgIHNlbGYuaHNsVG9SZ2IgPSBmdW5jdGlvbihoLCBzLCBsKSB7XG4gICAgICAgIHZhciByLCBnLCBiO1xuICAgICAgICBpZiAocyA9PSAwKSB7XG4gICAgICAgICAgICByID0gZyA9IGIgPSBsOyAvLyBhY2hyb21hdGljXG4gICAgICAgIH1cbiAgICAgICAgZWxzZSB7XG4gICAgICAgICAgICB2YXIgaHVlMnJnYiA9IGZ1bmN0aW9uIGh1ZTJyZ2IocCwgcSwgdCkge1xuICAgICAgICAgICAgICAgIGlmICh0IDwgMCkgdCArPSAxO1xuICAgICAgICAgICAgICAgIGlmICh0ID4gMSkgdCAtPSAxO1xuICAgICAgICAgICAgICAgIGlmICh0IDwgMSAvIDYpIHJldHVybiBwICsgKHEgLSBwKSAqIDYgKiB0O1xuICAgICAgICAgICAgICAgIGlmICh0IDwgMSAvIDIpIHJldHVybiBxO1xuICAgICAgICAgICAgICAgIGlmICh0IDwgMiAvIDMpIHJldHVybiBwICsgKHEgLSBwKSAqICgyIC8gMyAtIHQpICogNjtcbiAgICAgICAgICAgICAgICByZXR1cm4gcDtcbiAgICAgICAgICAgIH1cblxuICAgICAgICAgICAgdmFyIHEgPSBsIDwgMC41ID8gbCAqICgxICsgcykgOiBsICsgcyAtIGwgKiBzO1xuICAgICAgICAgICAgdmFyIHAgPSAyICogbCAtIHE7XG4gICAgICAgICAgICByID0gaHVlMnJnYihwLCBxLCBoICsgMSAvIDMpO1xuICAgICAgICAgICAgZyA9IGh1ZTJyZ2IocCwgcSwgaCk7XG4gICAgICAgICAgICBiID0gaHVlMnJnYihwLCBxLCBoIC0gMSAvIDMpO1xuICAgICAgICB9XG5cbiAgICAgICAgcmV0dXJuIFtNYXRoLnJvdW5kKHIgKiAyNTUpLCBNYXRoLnJvdW5kKGcgKiAyNTUpLCBNYXRoLnJvdW5kKGIgKiAyNTUpXTtcbiAgICB9XG4gICAgXG4gICAgc2VsZi5zaG93R3JhcGhJdGVtQnVpbGRSb3dzID0ga28ub2JzZXJ2YWJsZShmYWxzZSk7XG4gICAgc2VsZi5zaG93R3JhcGhTa2lsbEJ1aWxkQ29sdW1ucyA9IGtvLm9ic2VydmFibGUoZmFsc2UpO1xuICAgIHNlbGYuZ3JhcGhSb3dIYXNJdGVtcyA9IGZ1bmN0aW9uIChpbmRleCkge1xuICAgICAgICByZXR1cm4gc2VsZi5ncmFwaERhdGEoKS5zb21lKGZ1bmN0aW9uIChkYXRhc2V0KSB7XG4gICAgICAgICAgICByZXR1cm4gZGF0YXNldC52aXNpYmxlKCkgJiYgZGF0YXNldC5kYXRhW2luZGV4XS5pdGVtcy5sZW5ndGggPiAwO1xuICAgICAgICB9KTtcbiAgICB9XG5cbiAgICBzZWxmLnNlbGVjdEludmVudG9yeSA9IGZ1bmN0aW9uIChpbmRleCkge1xuICAgICAgICBzZWxmLnBhcmVudC5zZWxlY3RlZEludmVudG9yeShzZWxmLnBhcmVudC5zZWxlY3RlZEludmVudG9yeSgpID09IGluZGV4ID8gLTEgOiBpbmRleCk7XG4gICAgfVxuICAgIHNlbGYuZ2V0U2VsZWN0ZWRJbnZlbnRvcnkgPSBrby5wdXJlQ29tcHV0ZWQoZnVuY3Rpb24gKCkge1xuICAgICAgICBpZiAoc2VsZi5wYXJlbnQuc2VsZWN0ZWRJbnZlbnRvcnkoKSA9PSAtMSkge1xuICAgICAgICAgICAgcmV0dXJuIHNlbGYucGFyZW50LmludmVudG9yeTtcbiAgICAgICAgfVxuICAgICAgICBlbHNlIHtcbiAgICAgICAgICAgIHJldHVybiBzZWxmLml0ZW1CdWlsZCgpW3NlbGYucGFyZW50LnNlbGVjdGVkSW52ZW50b3J5KCldO1xuICAgICAgICB9XG4gICAgfSk7XG4gICAgc2VsZi5jb3B5SW52ZW50b3J5ID0gZnVuY3Rpb24gKGluZGV4KSB7XG4gICAgICAgIGlmIChzZWxmLnBhcmVudC5zZWxlY3RlZEludmVudG9yeSgpICE9IC0xICYmIHNlbGYucGFyZW50LnNlbGVjdGVkSW52ZW50b3J5KCkgIT0gaW5kZXgpIHtcbiAgICAgICAgICAgIHNlbGYuaXRlbUJ1aWxkKClbc2VsZi5wYXJlbnQuc2VsZWN0ZWRJbnZlbnRvcnkoKV0uaXRlbXMoc2VsZi5pdGVtQnVpbGQoKVtzZWxmLnBhcmVudC5zZWxlY3RlZEludmVudG9yeSgpXS5pdGVtcygpLmNvbmNhdChzZWxmLml0ZW1CdWlsZCgpW2luZGV4XS5pdGVtcygpKSk7XG4gICAgICAgICAgICBzZWxmLml0ZW1CdWlsZCgpW3NlbGYucGFyZW50LnNlbGVjdGVkSW52ZW50b3J5KCldLmFjdGl2ZUl0ZW1zKG15LnByb3RvdHlwZS51bmlvbihzZWxmLml0ZW1CdWlsZCgpW3NlbGYucGFyZW50LnNlbGVjdGVkSW52ZW50b3J5KCldLmFjdGl2ZUl0ZW1zKCksIHNlbGYuaXRlbUJ1aWxkKClbaW5kZXhdLmFjdGl2ZUl0ZW1zKCkpKTtcbiAgICAgICAgfVxuICAgIH1cbiAgICBzZWxmLmNvcHlJbnZlbnRvcnlUb0NsaXBCb2FyZCA9IGZ1bmN0aW9uIChpbmRleCkge1xuICAgICAgICBpZiAoaW5kZXggPT0gLTEpIHtcbiAgICAgICAgICAgIG15LnByb3RvdHlwZS5pbnZlbnRvcnlDbGlwQm9hcmQuaXRlbXMgPSBzZWxmLnBhcmVudC5pbnZlbnRvcnkuaXRlbXMuc2xpY2UoMCk7XG4gICAgICAgICAgICBteS5wcm90b3R5cGUuaW52ZW50b3J5Q2xpcEJvYXJkLmFjdGl2ZUl0ZW1zID0gc2VsZi5wYXJlbnQuaW52ZW50b3J5LmFjdGl2ZUl0ZW1zLnNsaWNlKDApOyAgICAgICAgICAgIFxuICAgICAgICB9XG4gICAgICAgIGVsc2Uge1xuICAgICAgICAgICAgbXkucHJvdG90eXBlLmludmVudG9yeUNsaXBCb2FyZC5pdGVtcyA9IHNlbGYuaXRlbUJ1aWxkKClbaW5kZXhdLml0ZW1zLnNsaWNlKDApO1xuICAgICAgICAgICAgbXkucHJvdG90eXBlLmludmVudG9yeUNsaXBCb2FyZC5hY3RpdmVJdGVtcyA9IHNlbGYuaXRlbUJ1aWxkKClbaW5kZXhdLmFjdGl2ZUl0ZW1zLnNsaWNlKDApO1xuICAgICAgICB9XG4gICAgfVxuICAgIHNlbGYucGFzdGVJbnZlbnRvcnlGcm9tQ2xpcEJvYXJkID0gZnVuY3Rpb24gKGluZGV4KSB7XG4gICAgICAgIGlmIChteS5wcm90b3R5cGUuaW52ZW50b3J5Q2xpcEJvYXJkLml0ZW1zLmxlbmd0aCA+IDApIHtcbiAgICAgICAgICAgIGlmIChpbmRleCA9PSAtMSkge1xuICAgICAgICAgICAgICAgIHNlbGYucGFyZW50LmludmVudG9yeS5pdGVtcyhzZWxmLnBhcmVudC5pbnZlbnRvcnkuaXRlbXMoKS5jb25jYXQobXkucHJvdG90eXBlLmludmVudG9yeUNsaXBCb2FyZC5pdGVtcykpO1xuICAgICAgICAgICAgICAgIHNlbGYucGFyZW50LmludmVudG9yeS5hY3RpdmVJdGVtcyhteS5wcm90b3R5cGUudW5pb24oc2VsZi5wYXJlbnQuaW52ZW50b3J5LmFjdGl2ZUl0ZW1zKCksIG15LnByb3RvdHlwZS5pbnZlbnRvcnlDbGlwQm9hcmQuYWN0aXZlSXRlbXMpKTsgICAgXG4gICAgICAgICAgICB9XG4gICAgICAgICAgICBlbHNlIHtcbiAgICAgICAgICAgICAgICBzZWxmLml0ZW1CdWlsZCgpW2luZGV4XS5pdGVtcyhzZWxmLml0ZW1CdWlsZCgpW2luZGV4XS5pdGVtcygpLmNvbmNhdChteS5wcm90b3R5cGUuaW52ZW50b3J5Q2xpcEJvYXJkLml0ZW1zKSk7XG4gICAgICAgICAgICAgICAgc2VsZi5pdGVtQnVpbGQoKVtpbmRleF0uYWN0aXZlSXRlbXMobXkucHJvdG90eXBlLnVuaW9uKHNlbGYuaXRlbUJ1aWxkKClbaW5kZXhdLmFjdGl2ZUl0ZW1zKCksIG15LnByb3RvdHlwZS5pbnZlbnRvcnlDbGlwQm9hcmQuYWN0aXZlSXRlbXMpKTtcbiAgICAgICAgICAgIH1cbiAgICAgICAgfVxuICAgIH1cbiAgICBzZWxmLmxvYWRHcmFwaERhdGEgPSBmdW5jdGlvbiAoZGF0YSkge1xuICAgICAgICBzZWxmLnBhcmVudC5zZWN0aW9uRGlzcGxheSgpWydza2lsbGJ1aWxkJ10odHJ1ZSk7XG4gICAgICAgIGZvciAodmFyIGkgPSAwOyBpIDwgZGF0YS5sZW5ndGg7IGkrKykge1xuICAgICAgICAgICAgZGF0YVtpXS52aXNpYmxlID0ga28ub2JzZXJ2YWJsZShkYXRhW2ldLnZpc2libGUpO1xuICAgICAgICB9XG4gICAgICAgIHNlbGYuZ3JhcGhEYXRhKGRhdGEpO1xuICAgIH1cbiAgICBzZWxmLmdyYXBoQ2hhcnRDb250ZXh0ID0ga28ub2JzZXJ2YWJsZSgpO1xuICAgIHNlbGYuZXhwb3J0SW1hZ2UgPSBmdW5jdGlvbiAoKSB7XG4gICAgICAgIHZhciB3ID0gd2luZG93Lm9wZW4oKTtcbiAgICAgICAgdy5kb2N1bWVudC53cml0ZSgnPGltZyBzcmM9XCInKyBzZWxmLmdyYXBoQ2hhcnRDb250ZXh0KCkuY2FudmFzLnRvRGF0YVVSTCgpICsnXCIvPicpO1xuICAgIH1cbiAgICByZXR1cm4gc2VsZjtcbn0iLCIndXNlIHN0cmljdCc7XG52YXIga28gPSByZXF1aXJlKCcuL2hlcm9jYWxjX2tub2Nrb3V0Jyk7XG4gICAgXG52YXIgbXkgPSByZXF1aXJlKFwiLi4vaGVyb2NhbGMvbWFpblwiKTtcblxubXkucHJvdG90eXBlLkRhbWFnZUluc3RhbmNlID0gZnVuY3Rpb24gKGxhYmVsLCBkYW1hZ2VUeXBlLCB2YWx1ZSwgZGF0YSwgdG90YWwpIHtcbiAgICB0aGlzLmxhYmVsID0gbGFiZWwgfHwgJyc7XG4gICAgdGhpcy5kYW1hZ2VUeXBlID0gZGFtYWdlVHlwZSB8fCAnJztcbiAgICB0aGlzLnZhbHVlID0gcGFyc2VGbG9hdCh2YWx1ZSkgfHwgMDtcbiAgICB0aGlzLmRhdGEgPSBkYXRhIHx8IFtdO1xuICAgIHRoaXMudG90YWwgPSBwYXJzZUZsb2F0KHRvdGFsKSB8fCAwO1xufVxuXG5teS5wcm90b3R5cGUuSGVyb0RhbWFnZUFtcE1peGluID0gZnVuY3Rpb24gKHNlbGYpIHtcbiAgICBzZWxmLmRhbWFnZUJyYWNrZXRzID0gW1xuICAgICAgICBbJ21lZHVzYV9tYW5hX3NoaWVsZCcsICd0ZW1wbGFyX2Fzc2Fzc2luX3JlZnJhY3Rpb24nLCAnZmFjZWxlc3Nfdm9pZF9iYWNrdHJhY2snLCAnbnl4X2Fzc2Fzc2luX3NwaWtlZF9jYXJhcGFjZSddLFxuICAgICAgICBbJ3NwZWN0cmVfZGlzcGVyc2lvbicsICd3aXNwX292ZXJjaGFyZ2UnLCAnc2xhcmRhcl9zcHJpbnQnLCdicmlzdGxlYmFja19icmlzdGxlYmFjaycsICd1bmR5aW5nX2ZsZXNoX2dvbGVtJ10sXG4gICAgICAgIFsnYWJhZGRvbl9ib3Jyb3dlZF90aW1lJywgJ2FiYWRkb25fYXBob3RpY19zaGllbGQnLCAna3Vua2thX2dob3N0c2hpcCcsICd0cmVhbnRfbGl2aW5nX2FybW9yJ10sXG4gICAgICAgIFsnY2hlbl9wZW5pdGVuY2UnLCAnbWVkdXNhX3N0b25lX2dhemUnLCAnc2hhZG93X2RlbW9uX3NvdWxfY2F0Y2hlciddLFxuICAgICAgICBbJ2RhenpsZV9zaGFsbG93X2dyYXZlJ11cbiAgICBdO1xuICAgIFxuICAgIHNlbGYuZ2V0RGFtYWdlQWZ0ZXJCcmFja2V0ID0gZnVuY3Rpb24gKGluaXRpYWxEYW1hZ2UsaW5kZXgpIHtcbiAgICAgICAgdmFyIGJyYWNrZXQgPSBzZWxmLmRhbWFnZUJyYWNrZXRzW2luZGV4XTtcbiAgICAgICAgdmFyIG11bHRpcGxpZXIgPSAxO1xuICAgICAgICBmb3IgKHZhciBpID0gMDsgaSA8IGJyYWNrZXQubGVuZ3RoOyBpKyspIHtcbiAgICAgICAgICAgIGlmIChteS5wcm90b3R5cGUuZmluZFdoZXJlKHNlbGYuZGFtYWdlQW1wbGlmaWNhdGlvbi5idWZmcywge25hbWU6IGJyYWNrZXRbaV0ubmFtZX0pICE9IHVuZGVmaW5lZCB8fCBteS5wcm90b3R5cGUuZmluZFdoZXJlKHNlbGYuZGFtYWdlUmVkdWN0aW9uLmJ1ZmZzLCB7bmFtZTogYnJhY2tldFtpXS5uYW1lfSkgIT0gdW5kZWZpbmVkKSB7XG4gICAgICAgICAgICAgICAgbXVsdGlwbGllciArPSBicmFja2V0W2ldLnZhbHVlO1xuICAgICAgICAgICAgfVxuICAgICAgICB9O1xuICAgICAgICByZXR1cm4gaW5pdGlhbERhbWFnZSAqIG11bHRpcGxpZXI7XG4gICAgfTtcbiAgICBcbiAgICBzZWxmLnByb2Nlc3NEYW1hZ2VBbXBSZWR1Y0JyYWNrZXQgPSBmdW5jdGlvbiAoaW5kZXgsIHNvdXJjZXMsIGRhbWFnZSkge1xuICAgICAgICB2YXIgbXVsdGlwbGllciA9IDEsXG4gICAgICAgICAgICBkYXRhID0gW10sXG4gICAgICAgICAgICBkYW1hZ2UgPSBwYXJzZUZsb2F0KGRhbWFnZSksXG4gICAgICAgICAgICB0b3RhbCA9IHBhcnNlRmxvYXQoZGFtYWdlKTtcbiAgICAgICAgICAgIFxuICAgICAgICBmb3IgKHZhciBpID0gMDsgaSA8IHNlbGYuZGFtYWdlQnJhY2tldHNbaW5kZXhdLmxlbmd0aDsgaSsrKSB7XG4gICAgICAgICAgICBpZiAoc291cmNlc1tzZWxmLmRhbWFnZUJyYWNrZXRzW2luZGV4XVtpXV0gIT0gdW5kZWZpbmVkKSB7XG4gICAgICAgICAgICAgICAgbXVsdGlwbGllciA9IDEgKyBwYXJzZUZsb2F0KHNvdXJjZXNbc2VsZi5kYW1hZ2VCcmFja2V0c1tpbmRleF1baV1dLm11bHRpcGxpZXIpO1xuICAgICAgICAgICAgICAgIHRvdGFsICs9IChkYW1hZ2UgKiBtdWx0aXBsaWVyKSAtIGRhbWFnZTtcbiAgICAgICAgICAgICAgICBkYXRhLnB1c2gobmV3IG15LnByb3RvdHlwZS5EYW1hZ2VJbnN0YW5jZShcbiAgICAgICAgICAgICAgICAgICAgc291cmNlc1tzZWxmLmRhbWFnZUJyYWNrZXRzW2luZGV4XVtpXV0uZGlzcGxheW5hbWUsXG4gICAgICAgICAgICAgICAgICAgIHNvdXJjZXNbc2VsZi5kYW1hZ2VCcmFja2V0c1tpbmRleF1baV1dLmRhbWFnZVR5cGUsXG4gICAgICAgICAgICAgICAgICAgIChkYW1hZ2UgKiBtdWx0aXBsaWVyKSAtIGRhbWFnZSxcbiAgICAgICAgICAgICAgICAgICAgW10sXG4gICAgICAgICAgICAgICAgICAgIHRvdGFsXG4gICAgICAgICAgICAgICAgKSk7XG4gICAgICAgICAgICB9XG4gICAgICAgIH1cbiAgICAgICAgcmV0dXJuIGRhdGE7XG4gICAgfVxuICAgIFxuICAgIHNlbGYuZ2V0RGFtYWdlQW1wUmVkdWNJbnN0YW5jZSA9IGZ1bmN0aW9uKHNvdXJjZXMsIGluaXRpYWxEYW1hZ2UsIGFiaWxpdHksIGRhbWFnZVR5cGUpIHtcbiAgICAgICAgdmFyIGRhdGEgPSBbXSxcbiAgICAgICAgICAgIGRhbWFnZSA9IHBhcnNlRmxvYXQoaW5pdGlhbERhbWFnZSksXG4gICAgICAgICAgICBwcmV2RGFtYWdlID0gZGFtYWdlLFxuICAgICAgICAgICAgbGFiZWwgPSBhYmlsaXR5ID09ICdpbml0aWFsJyA/ICdJbml0aWFsJyA6IHNvdXJjZXNbYWJpbGl0eV0uZGlzcGxheW5hbWU7XG5cbiAgICAgICAgLy8gQnJhY2tldCAwXG4gICAgICAgIGRhdGEgPSBkYXRhLmNvbmNhdChzZWxmLnByb2Nlc3NEYW1hZ2VBbXBSZWR1Y0JyYWNrZXQoMCwgc291cmNlcywgZGFtYWdlKSk7XG4gICAgICAgIGRhbWFnZSA9IGRhdGFbZGF0YS5sZW5ndGggLSAxXSA/IGRhdGFbZGF0YS5sZW5ndGggLSAxXS50b3RhbCA6IGRhbWFnZTtcblxuICAgICAgICAvLyBCcmFja2V0IDFcbiAgICAgICAgZGF0YSA9IGRhdGEuY29uY2F0KHNlbGYucHJvY2Vzc0RhbWFnZUFtcFJlZHVjQnJhY2tldCgxLCBzb3VyY2VzLCBkYW1hZ2UpKTtcbiAgICAgICAgZGFtYWdlID0gZGF0YVtkYXRhLmxlbmd0aCAtIDFdID8gZGF0YVtkYXRhLmxlbmd0aCAtIDFdLnRvdGFsIDogZGFtYWdlO1xuICAgICAgICBcbiAgICAgICAgLy8gQnJhY2tldCAyXG4gICAgICAgIGRhdGEgPSBkYXRhLmNvbmNhdChzZWxmLnByb2Nlc3NEYW1hZ2VBbXBSZWR1Y0JyYWNrZXQoMiwgc291cmNlcywgZGFtYWdlKSk7XG4gICAgICAgIGRhbWFnZSA9IGRhdGFbZGF0YS5sZW5ndGggLSAxXSA/IGRhdGFbZGF0YS5sZW5ndGggLSAxXS50b3RhbCA6IGRhbWFnZTtcblxuICAgICAgICByZXR1cm4gbmV3IG15LnByb3RvdHlwZS5EYW1hZ2VJbnN0YW5jZShsYWJlbCwgZGFtYWdlVHlwZSwgaW5pdGlhbERhbWFnZSwgZGF0YSwgZGF0YVtkYXRhLmxlbmd0aCAtIDFdID8gZGF0YVtkYXRhLmxlbmd0aCAtIDFdLnRvdGFsIDogZGFtYWdlKTtcbiAgICB9XG4gICAgXG4gICAgc2VsZi5nZXREYW1hZ2VBbXBSZWR1YyA9IGZ1bmN0aW9uIChpbml0aWFsRGFtYWdlKSB7XG4gICAgICAgIHZhciBpbnN0YW5jZXMgPSBbXSxcbiAgICAgICAgICAgIHNvdXJjZXMgPSB7fSxcbiAgICAgICAgICAgIHNvdXJjZXNBbXAgPSBzZWxmLmRhbWFnZVJlZHVjdGlvbi5nZXREYW1hZ2VNdWx0aXBsaWVyU291cmNlcygpLFxuICAgICAgICAgICAgc291cmNlc1JlZHVjID0gc2VsZi5kYW1hZ2VBbXBsaWZpY2F0aW9uLmdldERhbWFnZU11bHRpcGxpZXJTb3VyY2VzKCk7XG4gICAgICAgIG15LnByb3RvdHlwZS5leHRlbmQoc291cmNlcywgc291cmNlc0FtcCk7XG4gICAgICAgIG15LnByb3RvdHlwZS5leHRlbmQoc291cmNlcywgc291cmNlc1JlZHVjKTtcbiAgICAgICAgLy8gSW5pdGlhbCBkYW1hZ2UgaW5zdGFuY2VcbiAgICAgICAgaW5zdGFuY2VzLnB1c2goc2VsZi5nZXREYW1hZ2VBbXBSZWR1Y0luc3RhbmNlKHNvdXJjZXMsIGluaXRpYWxEYW1hZ2UsICdpbml0aWFsJywgJ3BoeXNpY2FsJykpO1xuICAgICAgICBcbiAgICAgICAgLy8gQnJhY2tldCA0IGRhbWFnZSBpbnN0YW5jZXNcbiAgICAgICAgdmFyIGI0ID0gWydzaGFkb3dfZGVtb25fc291bF9jYXRjaGVyJywgJ21lZHVzYV9zdG9uZV9nYXplJywgJ2NoZW5fcGVuaXRlbmNlJ107XG4gICAgICAgIGZvciAodmFyIGkgPSAwOyBpIDwgYjQubGVuZ3RoOyBpKyspIHtcbiAgICAgICAgICAgIGlmIChzb3VyY2VzW2I0W2ldXSAhPSB1bmRlZmluZWQpIHtcbiAgICAgICAgICAgICAgICBpbnN0YW5jZXMucHVzaChzZWxmLmdldERhbWFnZUFtcFJlZHVjSW5zdGFuY2Uoc291cmNlcywgaW5pdGlhbERhbWFnZSAqIHNvdXJjZXNbYjRbaV1dLm11bHRpcGxpZXIsIGI0W2ldLCBzb3VyY2VzW2I0W2ldXS5kYW1hZ2VUeXBlKSk7XG4gICAgICAgICAgICB9XG4gICAgICAgIH1cbiAgICBcbiAgICAgICAgcmV0dXJuIG5ldyBteS5wcm90b3R5cGUuRGFtYWdlSW5zdGFuY2UoJ1RvdGFsJywgJ3BoeXNpY2FsJywgaW5pdGlhbERhbWFnZSwgaW5zdGFuY2VzLCBpbnN0YW5jZXMucmVkdWNlKGZ1bmN0aW9uKG1lbW8sIGkpIHtyZXR1cm4gcGFyc2VGbG9hdChtZW1vKSArIHBhcnNlRmxvYXQoaS50b3RhbCk7fSwgMCkpO1xuICAgIH07XG4gICAgXG4gICAgc2VsZi5kYW1hZ2VJbnB1dFZhbHVlID0ga28ub2JzZXJ2YWJsZSgwKTtcbiAgICBzZWxmLmRhbWFnZUlucHV0TW9kaWZpZWQgPSBrby5jb21wdXRlZChmdW5jdGlvbiAoKSB7XG4gICAgICAgIHJldHVybiBzZWxmLmdldERhbWFnZUFtcFJlZHVjKHNlbGYuZGFtYWdlSW5wdXRWYWx1ZSgpKTtcbiAgICB9KTtcbn0iLCIndXNlIHN0cmljdCc7XG52YXIga28gPSAodHlwZW9mIHdpbmRvdyAhPT0gXCJ1bmRlZmluZWRcIiA/IHdpbmRvd1sna28nXSA6IHR5cGVvZiBnbG9iYWwgIT09IFwidW5kZWZpbmVkXCIgPyBnbG9iYWxbJ2tvJ10gOiBudWxsKTtcbnZhciAkID0gKHR5cGVvZiB3aW5kb3cgIT09IFwidW5kZWZpbmVkXCIgPyB3aW5kb3dbJyQnXSA6IHR5cGVvZiBnbG9iYWwgIT09IFwidW5kZWZpbmVkXCIgPyBnbG9iYWxbJyQnXSA6IG51bGwpO1xuXG5rby5iaW5kaW5nSGFuZGxlcnMuc3RvcEJpbmRpbmcgPSB7XG4gICAgaW5pdDogZnVuY3Rpb24oKSB7XG4gICAgICAgIHJldHVybiB7IGNvbnRyb2xzRGVzY2VuZGFudEJpbmRpbmdzOiB0cnVlIH07XG4gICAgfVxufTtcblxua28udmlydHVhbEVsZW1lbnRzLmFsbG93ZWRCaW5kaW5ncy5zdG9wQmluZGluZyA9IHRydWU7XG5cbmtvLmJpbmRpbmdIYW5kbGVycy5sYXp5QmluZGluZyA9IHtcbiAgICBpbml0OiBmdW5jdGlvbihlbGVtZW50LCB2YWx1ZUFjY2Vzc29yLCBhbGxCaW5kaW5nc0FjY2Vzc29yLCB2aWV3TW9kZWwsIGJpbmRpbmdDb250ZXh0KSB7XG4gICAgICAgIGtvLnV0aWxzLmRvbURhdGEuc2V0KGVsZW1lbnQsICdpc0JvdW5kJywgZmFsc2UpXG4gICAgICAgIFxuICAgICAgICAvLyBBbHNvIHRlbGwgS08gKm5vdCogdG8gYmluZCB0aGUgZGVzY2VuZGFudHMgaXRzZWxmLCBvdGhlcndpc2UgdGhleSB3aWxsIGJlIGJvdW5kIHR3aWNlXG4gICAgICAgIHJldHVybiB7IGNvbnRyb2xzRGVzY2VuZGFudEJpbmRpbmdzOiB0cnVlIH07XG4gICAgfSxcbiAgICB1cGRhdGU6IGZ1bmN0aW9uKGVsZW1lbnQsIHZhbHVlQWNjZXNzb3IsIGFsbEJpbmRpbmdzQWNjZXNzb3IsIHZpZXdNb2RlbCwgYmluZGluZ0NvbnRleHQpIHtcbiAgICAgICAgdmFyIHZhbCA9IGtvLnVud3JhcCh2YWx1ZUFjY2Vzc29yKCkpLFxuICAgICAgICAgICAgaXNCb3VuZCA9IGtvLnV0aWxzLmRvbURhdGEuZ2V0KGVsZW1lbnQsICdpc0JvdW5kJyk7XG4gICAgICAgIGlmICh2YWwgJiYgIWlzQm91bmQpIHtcbiAgICAgICAgICAgIGtvLnV0aWxzLmRvbURhdGEuc2V0KGVsZW1lbnQsICdpc0JvdW5kJywgdHJ1ZSk7XG4gICAgICAgICAgICBrby5hcHBseUJpbmRpbmdzVG9EZXNjZW5kYW50cyhiaW5kaW5nQ29udGV4dCwgZWxlbWVudCk7XG4gICAgICAgIH1cbiAgICB9XG59O1xuXG5rby52aXJ0dWFsRWxlbWVudHMuYWxsb3dlZEJpbmRpbmdzLmxhenlCaW5kaW5nID0gdHJ1ZTtcblxua28uYmluZGluZ0hhbmRsZXJzLml0ZW1CdWlsZFRhYmxlID0ge1xuICAgIGluaXQ6IGZ1bmN0aW9uKGVsZW1lbnQsIHZhbHVlQWNjZXNzb3IsIGFsbEJpbmRpbmdzQWNjZXNzb3IsIHZpZXdNb2RlbCwgYmluZGluZ0NvbnRleHQpIHtcbiAgICAgICAgdmFyIGJ1aWxkRXhwbG9yZXIgPSBrby51bndyYXAodmFsdWVBY2Nlc3NvcigpKSxcbiAgICAgICAgICAgICRlbCA9ICQoZWxlbWVudCk7XG5cbiAgICAgICAgdmFyIHByZXNzZWRLZXlzID0ge307XG4gICAgICAgIGtvLnV0aWxzLmRvbURhdGEuc2V0KGVsZW1lbnQsICdwcmVzc2VkS2V5cycsIHByZXNzZWRLZXlzKTtcbiAgICAgICAgXG4gICAgICAgIHZhciBrZXlEb3duSGFuZGxlciA9IGZ1bmN0aW9uKGUpIHtcbiAgICAgICAgICAgIHZhciBwcmVzc2VkS2V5cyA9IGtvLnV0aWxzLmRvbURhdGEuZ2V0KGVsZW1lbnQsICdwcmVzc2VkS2V5cycpO1xuICAgICAgICAgICAgcHJlc3NlZEtleXNbZS53aGljaF0gPSB0cnVlO1xuICAgICAgICAgICAga28udXRpbHMuZG9tRGF0YS5zZXQoZWxlbWVudCwgJ3ByZXNzZWRLZXlzJywgcHJlc3NlZEtleXMpO1xuICAgICAgICB9XG4gICAgICAgIGtvLnV0aWxzLmRvbURhdGEuc2V0KGVsZW1lbnQsICdrZXlEb3duSGFuZGxlcicsIGtleURvd25IYW5kbGVyKTtcbiAgICAgICAgXG4gICAgICAgIHZhciBrZXlVcEhhbmRsZXIgPSBmdW5jdGlvbihlKSB7XG4gICAgICAgICAgICB2YXIgcHJlc3NlZEtleXMgPSBrby51dGlscy5kb21EYXRhLmdldChlbGVtZW50LCAncHJlc3NlZEtleXMnKTtcbiAgICAgICAgICAgIGlmICgocHJlc3NlZEtleXNbMTddICYmIHByZXNzZWRLZXlzWzY3XSkgfHwgKHByZXNzZWRLZXlzWzE3XSAmJiBwcmVzc2VkS2V5c1s4Nl0pKSB7IC8vIGN0cmwgKyBjXG4gICAgICAgICAgICAgICAgdmFyICRob3ZlcmVkUm93cyA9ICQoZWxlbWVudCkuZmluZCgnLmhvdmVyLWN1cnNvcjpob3ZlcicpO1xuICAgICAgICAgICAgICAgIGlmICgkaG92ZXJlZFJvd3MubGVuZ3RoID09IDEpIHtcbiAgICAgICAgICAgICAgICAgICAgaWYgKHByZXNzZWRLZXlzWzY3XSkge1xuICAgICAgICAgICAgICAgICAgICAgICAgYnVpbGRFeHBsb3Jlci5jb3B5SW52ZW50b3J5VG9DbGlwQm9hcmQoJChcInRyXCIsICQoZWxlbWVudCkpLmluZGV4KCRob3ZlcmVkUm93c1swXSkpO1xuICAgICAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgICAgICAgIGVsc2Uge1xuICAgICAgICAgICAgICAgICAgICAgICAgYnVpbGRFeHBsb3Jlci5wYXN0ZUludmVudG9yeUZyb21DbGlwQm9hcmQoJChcInRyXCIsICQoZWxlbWVudCkpLmluZGV4KCRob3ZlcmVkUm93c1swXSkpO1xuICAgICAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgICAgICAgICRob3ZlcmVkUm93cy5mYWRlT3V0KDUwKS5mYWRlSW4oNTApO1xuICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgIH1cbiAgICAgICAgICAgIGRlbGV0ZSBwcmVzc2VkS2V5c1tlLndoaWNoXTtcbiAgICAgICAgICAgIGtvLnV0aWxzLmRvbURhdGEuc2V0KGVsZW1lbnQsICdwcmVzc2VkS2V5cycsIHByZXNzZWRLZXlzKTtcbiAgICAgICAgfVxuICAgICAgICBrby51dGlscy5kb21EYXRhLnNldChlbGVtZW50LCAna2V5VXBIYW5kbGVyJywga2V5VXBIYW5kbGVyKTtcbiAgICAgICAgXG4gICAgICAgICQoZG9jdW1lbnQpLmJpbmQoIFwia2V5ZG93blwiLCBrZXlEb3duSGFuZGxlciApO1xuICAgICAgICAkKGRvY3VtZW50KS5iaW5kKCBcImtleXVwXCIsIGtleVVwSGFuZGxlciApO1xuXG4gICAgICAgIGtvLnV0aWxzLmRvbU5vZGVEaXNwb3NhbC5hZGREaXNwb3NlQ2FsbGJhY2soZWxlbWVudCwgZnVuY3Rpb24oKSB7XG4gICAgICAgICAgICB2YXIga2V5RG93bkhhbmRsZXIgPSBrby51dGlscy5kb21EYXRhLmdldChlbGVtZW50LCAna2V5RG93bkhhbmRsZXInKTtcbiAgICAgICAgICAgIHZhciBrZXlVcEhhbmRsZXIgPSBrby51dGlscy5kb21EYXRhLmdldChlbGVtZW50LCAna2V5VXBIYW5kbGVyJyk7XG4gICAgICAgICAgICAkKGRvY3VtZW50KS51bmJpbmQoIFwia2V5ZG93blwiLCBrZXlEb3duSGFuZGxlciApO1xuICAgICAgICAgICAgJChkb2N1bWVudCkudW5iaW5kKCBcImtleXVwXCIsIGtleVVwSGFuZGxlciApO1xuICAgICAgICB9KTtcbiAgICB9XG59O1xuXG5rby5iaW5kaW5nSGFuZGxlcnMucHJldmVudEJ1YmJsZSA9IHtcbiAgICBpbml0OiBmdW5jdGlvbihlbGVtZW50LCB2YWx1ZUFjY2Vzc29yKSB7XG4gICAgICAgIHZhciBldmVudE5hbWUgPSBrby51dGlscy51bndyYXBPYnNlcnZhYmxlKHZhbHVlQWNjZXNzb3IoKSk7XG4gICAgICAgIGtvLnV0aWxzLnJlZ2lzdGVyRXZlbnRIYW5kbGVyKGVsZW1lbnQsIGV2ZW50TmFtZSwgZnVuY3Rpb24oZXZlbnQpIHtcbiAgICAgICAgICAgZXZlbnQuY2FuY2VsQnViYmxlID0gdHJ1ZTtcbiAgICAgICAgICAgaWYgKGV2ZW50LnN0b3BQcm9wYWdhdGlvbikge1xuICAgICAgICAgICAgICAgIGV2ZW50LnN0b3BQcm9wYWdhdGlvbigpO1xuICAgICAgICAgICB9ICAgICAgICAgICAgICAgIFxuICAgICAgICB9KTtcbiAgICB9ICAgICAgICBcbn07XG5cbmtvLmJpbmRpbmdIYW5kbGVycy50b2dnbGUgPSB7XG4gICAgaW5pdDogZnVuY3Rpb24gKGVsZW1lbnQsIHZhbHVlQWNjZXNzb3IpIHtcbiAgICAgICAgdmFyIHZhbHVlID0gdmFsdWVBY2Nlc3NvcigpO1xuICAgICAgICBrby5hcHBseUJpbmRpbmdzVG9Ob2RlKGVsZW1lbnQsIHtcbiAgICAgICAgICAgIGNsaWNrOiBmdW5jdGlvbiAoKSB7XG4gICAgICAgICAgICAgICAgdmFsdWUoIXZhbHVlKCkpO1xuICAgICAgICAgICAgfVxuICAgICAgICB9KTtcbiAgICB9XG59O1xuXG5rby5iaW5kaW5nSGFuZGxlcnMuc2hvcERvY2tTdHlsZSA9IHtcbiAgICBpbml0OiBmdW5jdGlvbihlbGVtZW50LCB2YWx1ZUFjY2Vzc29yLCBhbGxCaW5kaW5nc0FjY2Vzc29yLCB2aWV3TW9kZWwsIGJpbmRpbmdDb250ZXh0KSB7XG4gICAgICAgIHZhciB2YWx1ZSA9IGtvLnV0aWxzLnVud3JhcE9ic2VydmFibGUodmFsdWVBY2Nlc3NvcigpKTtcbiAgICAgICAgaWYgKGJpbmRpbmdDb250ZXh0LiRkYXRhLnNob3BEb2NrKCkgJiYgIWJpbmRpbmdDb250ZXh0LiRkYXRhLnNob3BQb3BvdXQoKSkge1xuICAgICAgICAgICAga28uYXBwbHlCaW5kaW5nc1RvTm9kZShlbGVtZW50LCB7IHN0eWxlOiB7IGhlaWdodDogKGJpbmRpbmdDb250ZXh0LiRkYXRhLndpbmRvd0hlaWdodCgpIC0gNTIpICsgJ3B4JywgcG9zaXRpb246ICdmaXhlZCcsIHJpZ2h0OiAwLCB0b3A6ICc1MnB4JywgJ292ZXJmbG93LXknOiAnYXV0bycgfSB9KTtcbiAgICAgICAgfVxuICAgICAgICBlbHNlIHtcbiAgICAgICAgICAgIGtvLmFwcGx5QmluZGluZ3NUb05vZGUoZWxlbWVudCwgeyBzdHlsZTogeyBoZWlnaHQ6ICdhdXRvJywgcG9zaXRpb246ICdyZWxhdGl2ZScsIHJpZ2h0OiAnaW5pdGlhbCcsIHRvcDogJ2luaXRpYWwnLCAnb3ZlcmZsb3cteSc6ICdpbml0aWFsJyB9IH0pO1xuICAgICAgICB9XG4gICAgfSxcbiAgICB1cGRhdGU6IGZ1bmN0aW9uKGVsZW1lbnQsIHZhbHVlQWNjZXNzb3IsIGFsbEJpbmRpbmdzQWNjZXNzb3IsIHZpZXdNb2RlbCwgYmluZGluZ0NvbnRleHQpIHtcbiAgICAgICAgdmFyIHZhbHVlID0ga28udXRpbHMudW53cmFwT2JzZXJ2YWJsZSh2YWx1ZUFjY2Vzc29yKCkpO1xuICAgICAgICBpZiAoYmluZGluZ0NvbnRleHQuJGRhdGEuc2hvcERvY2soKSAmJiAhYmluZGluZ0NvbnRleHQuJGRhdGEuc2hvcFBvcG91dCgpKSB7XG4gICAgICAgICAgICBrby5hcHBseUJpbmRpbmdzVG9Ob2RlKGVsZW1lbnQsIHsgc3R5bGU6IHsgaGVpZ2h0OiAoYmluZGluZ0NvbnRleHQuJGRhdGEud2luZG93SGVpZ2h0KCkgLSA1MikgKyAncHgnLCBwb3NpdGlvbjogJ2ZpeGVkJywgcmlnaHQ6IDAsIHRvcDogJzUycHgnLCAnb3ZlcmZsb3cteSc6ICdhdXRvJyB9IH0pO1xuICAgICAgICB9XG4gICAgICAgIGVsc2Uge1xuICAgICAgICAgICAga28uYXBwbHlCaW5kaW5nc1RvTm9kZShlbGVtZW50LCB7IHN0eWxlOiB7IGhlaWdodDogJ2F1dG8nLCBwb3NpdGlvbjogJ3JlbGF0aXZlJywgcmlnaHQ6ICdpbml0aWFsJywgdG9wOiAnaW5pdGlhbCcsICdvdmVyZmxvdy15JzogJ2luaXRpYWwnIH0gfSk7XG4gICAgICAgIH1cbiAgICB9XG59O1xuXG5rby5iaW5kaW5nSGFuZGxlcnMubG9nZ2VyID0ge1xuICAgIHVwZGF0ZTogZnVuY3Rpb24oZWxlbWVudCwgdmFsdWVBY2Nlc3NvciwgYWxsQmluZGluZ3MpIHtcbiAgICAgICAgLy9zdG9yZSBhIGNvdW50ZXIgd2l0aCB0aGlzIGVsZW1lbnRcbiAgICAgICAgdmFyIGNvdW50ID0ga28udXRpbHMuZG9tRGF0YS5nZXQoZWxlbWVudCwgXCJfa29fbG9nZ2VyXCIpIHx8IDAsXG4gICAgICAgICAgICBkYXRhID0ga28udG9KUyh2YWx1ZUFjY2Vzc29yKCkgfHwgYWxsQmluZGluZ3MoKSk7XG5cbiAgICAgICAga28udXRpbHMuZG9tRGF0YS5zZXQoZWxlbWVudCwgXCJfa29fbG9nZ2VyXCIsICsrY291bnQpO1xuXG4gICAgICAgIGlmICh3aW5kb3cuY29uc29sZSAmJiBjb25zb2xlLmxvZykge1xuICAgICAgICAgICAgY29uc29sZS5sb2coY291bnQsIGVsZW1lbnQsIGRhdGEpO1xuICAgICAgICB9XG4gICAgfVxufTtcblxua28uYmluZGluZ0hhbmRsZXJzLnRvb2x0aXAgPSB7XG4gICAgdXBkYXRlOiBmdW5jdGlvbiAoZWxlbWVudCwgdmFsdWVBY2Nlc3NvciwgYWxsQmluZGluZ3NBY2Nlc3Nvciwgdmlld01vZGVsLCBiaW5kaW5nQ29udGV4dCkge1xuICAgICAgICB2YXIgJGVsZW1lbnQsIG9wdGlvbnMsIHRvb2x0aXA7XG4gICAgICAgIG9wdGlvbnMgPSBrby51dGlscy51bndyYXBPYnNlcnZhYmxlKHZhbHVlQWNjZXNzb3IoKSk7XG4gICAgICAgICRlbGVtZW50ID0gJChlbGVtZW50KTtcblxuICAgICAgICAvLyBJZiB0aGUgdGl0bGUgaXMgYW4gb2JzZXJ2YWJsZSwgbWFrZSBpdCBhdXRvLXVwZGF0aW5nLlxuICAgICAgICBpZiAoa28uaXNPYnNlcnZhYmxlKG9wdGlvbnMudGl0bGUpKSB7XG4gICAgICAgICAgICB2YXIgaXNUb29sVGlwVmlzaWJsZSA9IGZhbHNlO1xuXG4gICAgICAgICAgICAkZWxlbWVudC5vbignc2hvdy5icy50b29sdGlwJywgZnVuY3Rpb24gKCkge1xuICAgICAgICAgICAgICAgIGlzVG9vbFRpcFZpc2libGUgPSB0cnVlO1xuICAgICAgICAgICAgfSk7XG4gICAgICAgICAgICAkZWxlbWVudC5vbignaGlkZS5icy50b29sdGlwJywgZnVuY3Rpb24gKCkge1xuICAgICAgICAgICAgICAgIGlzVG9vbFRpcFZpc2libGUgPSBmYWxzZTtcbiAgICAgICAgICAgIH0pO1xuXG4gICAgICAgICAgICAvLyBcInRydWVcIiBpcyB0aGUgYm9vdHN0cmFwIGRlZmF1bHQuXG4gICAgICAgICAgICB2YXIgb3JpZ0FuaW1hdGlvbiA9IG9wdGlvbnMuYW5pbWF0aW9uIHx8IHRydWU7XG4gICAgICAgICAgICBvcHRpb25zLnRpdGxlLnN1YnNjcmliZShmdW5jdGlvbiAoKSB7XG4gICAgICAgICAgICAgICAgaWYgKGlzVG9vbFRpcFZpc2libGUpIHtcbiAgICAgICAgICAgICAgICAgICAgJGVsZW1lbnQuZGF0YSgnYnMudG9vbHRpcCcpLm9wdGlvbnMuYW5pbWF0aW9uID0gZmFsc2U7IC8vIHRlbXBvcmFyaWx5IGRpc2FibGUgYW5pbWF0aW9uIHRvIGF2b2lkIGZsaWNrZXJpbmcgb2YgdGhlIHRvb2x0aXBcbiAgICAgICAgICAgICAgICAgICAgJGVsZW1lbnQudG9vbHRpcCgnZml4VGl0bGUnKSAvLyBjYWxsIHRoaXMgbWV0aG9kIHRvIHVwZGF0ZSB0aGUgdGl0bGVcbiAgICAgICAgICAgICAgICAgICAgICAgIC50b29sdGlwKCdzaG93Jyk7XG4gICAgICAgICAgICAgICAgICAgICRlbGVtZW50LmRhdGEoJ2JzLnRvb2x0aXAnKS5vcHRpb25zLmFuaW1hdGlvbiA9IG9yaWdBbmltYXRpb247XG4gICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgfSk7XG4gICAgICAgIH1cblxuICAgICAgICB0b29sdGlwID0gJGVsZW1lbnQuZGF0YSgnYnMudG9vbHRpcCcpO1xuICAgICAgICBpZiAodG9vbHRpcCkge1xuICAgICAgICAgICAgJC5leHRlbmQodG9vbHRpcC5vcHRpb25zLCBvcHRpb25zKTtcbiAgICAgICAgfSBlbHNlIHtcbiAgICAgICAgICAgICRlbGVtZW50LnRvb2x0aXAob3B0aW9ucyk7XG4gICAgICAgIH1cbiAgICB9XG59O1xuXG5rby5iaW5kaW5nSGFuZGxlcnMucG9wb3ZlciA9IHtcbiAgICBpbml0OiBmdW5jdGlvbiAoZWxlbWVudCwgdmFsdWVBY2Nlc3NvciwgYWxsQmluZGluZ3NBY2Nlc3Nvciwgdmlld01vZGVsLCBiaW5kaW5nQ29udGV4dCkge1xuICAgICAgICB2YXIgJGVsZW1lbnQgPSAkKGVsZW1lbnQpO1xuICAgICAgICB2YXIgcG9wb3ZlckJpbmRpbmdWYWx1ZXMgPSBrby51dGlscy51bndyYXBPYnNlcnZhYmxlKHZhbHVlQWNjZXNzb3IoKSk7XG4gICAgICAgIHZhciB0ZW1wbGF0ZSA9IHBvcG92ZXJCaW5kaW5nVmFsdWVzLnRlbXBsYXRlIHx8IGZhbHNlO1xuICAgICAgICB2YXIgb3B0aW9ucyA9IHBvcG92ZXJCaW5kaW5nVmFsdWVzLm9wdGlvbnMgfHwge3RpdGxlOiAncG9wb3Zlcid9O1xuICAgICAgICB2YXIgZGF0YSA9IHBvcG92ZXJCaW5kaW5nVmFsdWVzLmRhdGEgfHwgZmFsc2U7XG4gICAgICAgIGlmICh0ZW1wbGF0ZSAhPT0gZmFsc2UpIHtcbiAgICAgICAgICAgIGlmIChkYXRhKSB7XG4gICAgICAgICAgICAgICAgb3B0aW9ucy5jb250ZW50ID0gXCI8IS0tIGtvIHRlbXBsYXRlOiB7IG5hbWU6IHRlbXBsYXRlLCBpZjogZGF0YSwgZGF0YTogZGF0YSB9IC0tPjwhLS0gL2tvIC0tPlwiO1xuICAgICAgICAgICAgfVxuICAgICAgICAgICAgZWxzZSB7XG4gICAgICAgICAgICAgICAgb3B0aW9ucy5jb250ZW50ID0gJCgnIycgKyB0ZW1wbGF0ZSkuaHRtbCgpO1xuICAgICAgICAgICAgfVxuICAgICAgICAgICAgb3B0aW9ucy5odG1sID0gdHJ1ZTtcbiAgICAgICAgfVxuICAgICAgICAkZWxlbWVudC5vbignc2hvd24uYnMucG9wb3ZlcicsIGZ1bmN0aW9uKGV2ZW50KSB7XG5cbiAgICAgICAgICAgIHZhciBwb3BvdmVyRGF0YSA9ICQoZXZlbnQudGFyZ2V0KS5kYXRhKCk7XG4gICAgICAgICAgICB2YXIgcG9wb3ZlckVsID0gcG9wb3ZlckRhdGFbJ2JzLnBvcG92ZXInXS4kdGlwO1xuICAgICAgICAgICAgdmFyIG9wdGlvbnMgPSBwb3BvdmVyRGF0YVsnYnMucG9wb3ZlciddLm9wdGlvbnMgfHwge307XG4gICAgICAgICAgICB2YXIgYnV0dG9uID0gJChldmVudC50YXJnZXQpO1xuICAgICAgICAgICAgdmFyIGJ1dHRvblBvc2l0aW9uID0gYnV0dG9uLnBvc2l0aW9uKCk7XG4gICAgICAgICAgICB2YXIgYnV0dG9uRGltZW5zaW9ucyA9IHtcbiAgICAgICAgICAgICAgICB4OiBidXR0b24ub3V0ZXJXaWR0aCgpLFxuICAgICAgICAgICAgICAgIHk6IGJ1dHRvbi5vdXRlckhlaWdodCgpXG4gICAgICAgICAgICB9O1xuXG4gICAgICAgICAgICBpZiAoZGF0YSkge1xuICAgICAgICAgICAgICAgIGtvLmFwcGx5QmluZGluZ3NUb05vZGUocG9wb3ZlckVsWzBdLCB7IHRlbXBsYXRlOiB7IG5hbWU6IHRlbXBsYXRlLCBkYXRhOiBkYXRhIH0gfSwgYmluZGluZ0NvbnRleHQpO1xuICAgICAgICAgICAgICAgIC8va28uYXBwbHlCaW5kaW5ncyh7dGVtcGxhdGU6IHRlbXBsYXRlLCBkYXRhOiBkYXRhfSwgcG9wb3ZlckVsWzBdKTtcbiAgICAgICAgICAgICAgICAvL2tvLnJlbmRlclRlbXBsYXRlKHRlbXBsYXRlLCBkYXRhLCB7fSwgcG9wb3ZlckVsWzBdLCAncmVwbGFjZUNoaWxkcmVuJyk7XG4gICAgICAgICAgICB9XG4gICAgICAgICAgICBlbHNlIHtcbiAgICAgICAgICAgICAgICAvL2tvLnJlbmRlclRlbXBsYXRlKHRlbXBsYXRlLCBkYXRhLCB7fSwgcG9wb3ZlckVsWzBdLCAncmVwbGFjZUNoaWxkcmVuJyk7XG4gICAgICAgICAgICAgICAgLy9rby5hcHBseUJpbmRpbmdzKHZpZXdNb2RlbCwgcG9wb3ZlckVsWzBdKTtcbiAgICAgICAgICAgIH1cblxuICAgICAgICAgICAgdmFyIHBvcG92ZXJEaW1lbnNpb25zID0ge1xuICAgICAgICAgICAgICAgIHg6IHBvcG92ZXJFbC5vdXRlcldpZHRoKCksXG4gICAgICAgICAgICAgICAgeTogcG9wb3ZlckVsLm91dGVySGVpZ2h0KClcbiAgICAgICAgICAgIH07XG5cbiAgICAgICAgICAgIHBvcG92ZXJFbC5maW5kKCdidXR0b25bZGF0YS1kaXNtaXNzPVwicG9wb3ZlclwiXScpLmNsaWNrKGZ1bmN0aW9uKCkge1xuICAgICAgICAgICAgICAgIGJ1dHRvbi5wb3BvdmVyKCdoaWRlJyk7XG4gICAgICAgICAgICB9KTtcblxuICAgICAgICAgICAgc3dpdGNoIChvcHRpb25zLnBsYWNlbWVudCkge1xuICAgICAgICAgICAgICAgIGNhc2UgJ3JpZ2h0JzpcbiAgICAgICAgICAgICAgICAgICAgcG9wb3ZlckVsLmNzcyh7XG4gICAgICAgICAgICAgICAgICAgICAgICBsZWZ0OiBidXR0b25EaW1lbnNpb25zLnggKyBidXR0b25Qb3NpdGlvbi5sZWZ0LFxuICAgICAgICAgICAgICAgICAgICAgICAgdG9wOiAoYnV0dG9uRGltZW5zaW9ucy55IC8gMiArIGJ1dHRvblBvc2l0aW9uLnRvcCkgLSBwb3BvdmVyRGltZW5zaW9ucy55IC8gMlxuICAgICAgICAgICAgICAgICAgICB9KTtcbiAgICAgICAgICAgICAgICAgICAgYnJlYWs7XG4gICAgICAgICAgICAgICAgY2FzZSAnbGVmdCc6XG4gICAgICAgICAgICAgICAgICAgIHBvcG92ZXJFbC5jc3Moe1xuICAgICAgICAgICAgICAgICAgICAgICAgbGVmdDogYnV0dG9uUG9zaXRpb24ubGVmdCAtIHBvcG92ZXJEaW1lbnNpb25zLngsXG4gICAgICAgICAgICAgICAgICAgICAgICB0b3A6IChidXR0b25EaW1lbnNpb25zLnkgLyAyICsgYnV0dG9uUG9zaXRpb24udG9wKSAtIHBvcG92ZXJEaW1lbnNpb25zLnkgLyAyXG4gICAgICAgICAgICAgICAgICAgIH0pO1xuICAgICAgICAgICAgICAgICAgICBicmVhaztcbiAgICAgICAgICAgICAgICBjYXNlICd0b3AnOlxuICAgICAgICAgICAgICAgICAgICBwb3BvdmVyRWwuY3NzKHtcbiAgICAgICAgICAgICAgICAgICAgICAgIGxlZnQ6IGJ1dHRvblBvc2l0aW9uLmxlZnQgKyAoYnV0dG9uRGltZW5zaW9ucy54IC8gMiAtIHBvcG92ZXJEaW1lbnNpb25zLnggLyAyKSxcbiAgICAgICAgICAgICAgICAgICAgICAgIHRvcDogYnV0dG9uUG9zaXRpb24udG9wIC0gcG9wb3ZlckRpbWVuc2lvbnMueVxuICAgICAgICAgICAgICAgICAgICB9KTtcbiAgICAgICAgICAgICAgICAgICAgYnJlYWs7XG4gICAgICAgICAgICAgICAgY2FzZSAnYm90dG9tJzpcbiAgICAgICAgICAgICAgICAgICAgcG9wb3ZlckVsLmNzcyh7XG4gICAgICAgICAgICAgICAgICAgICAgICBsZWZ0OiBidXR0b25Qb3NpdGlvbi5sZWZ0ICsgKGJ1dHRvbkRpbWVuc2lvbnMueCAvIDIgLSBwb3BvdmVyRGltZW5zaW9ucy54IC8gMiksXG4gICAgICAgICAgICAgICAgICAgICAgICB0b3A6IGJ1dHRvblBvc2l0aW9uLnRvcCArIGJ1dHRvbkRpbWVuc2lvbnMueVxuICAgICAgICAgICAgICAgICAgICB9KTtcbiAgICAgICAgICAgICAgICAgICAgYnJlYWs7XG4gICAgICAgICAgICB9XG4gICAgICAgIH0pO1xuXG4gICAgICAgICRlbGVtZW50LnBvcG92ZXIob3B0aW9ucyk7XG5cbiAgICAgICAgcmV0dXJuIHsgY29udHJvbHNEZXNjZW5kYW50QmluZGluZ3M6IHRydWUgfTtcblxuICAgIH1cbn07XG5cbmtvLmJpbmRpbmdIYW5kbGVycy5jaGFydCA9IHtcbiAgICBpbml0OiBmdW5jdGlvbihlbGVtZW50LCB2YWx1ZUFjY2Vzc29yLCBhbGxCaW5kaW5nc0FjY2Vzc29yLCB2aWV3TW9kZWwsIGJpbmRpbmdDb250ZXh0KSB7XG4gICAgICAgIHZhciBuZXdDYW52YXMgPSAkKCc8Y2FudmFzLz4nKSxcbiAgICAgIGRhdGEgPSBrby51dGlscy51bndyYXBPYnNlcnZhYmxlKHZhbHVlQWNjZXNzb3IoKSksXG4gICAgICBjdHggPSBuZXdDYW52YXNbMF0uZ2V0Q29udGV4dChcIjJkXCIpLFxuICAgICAgY2hhcnRUeXBlID0gYWxsQmluZGluZ3NBY2Nlc3NvcigpLmNoYXJ0VHlwZSxcbiAgICAgIG9wdGlvbnMgPSBhbGxCaW5kaW5nc0FjY2Vzc29yKCkuY2hhcnRPcHRpb25zIHx8IHt9LFxuICAgICAgY2hhcnRDb250ZXh0ID0gYWxsQmluZGluZ3NBY2Nlc3NvcigpLmNoYXJ0Q29udGV4dDtcbiAgICAgICAgICAgIFxuICAgICAgICAkKGVsZW1lbnQpLmFwcGVuZChuZXdDYW52YXMpO1xuICAgICAgICB2YXIgbXlDaGFydCA9IG5ldyBDaGFydChjdHgpW2NoYXJ0VHlwZV0oZGF0YSwgb3B0aW9ucyk7XG4gICAgICAgIGtvLnV0aWxzLmRvbURhdGEuc2V0KGVsZW1lbnQsICdteUNoYXJ0JywgbXlDaGFydCk7XG4gICAgICAgIFxuICAvL2hhbmRsZSBkaXNwb3NhbCAoaWYgS08gcmVtb3ZlcyBieSB0aGUgdGVtcGxhdGUgYmluZGluZylcbiAga28udXRpbHMuZG9tTm9kZURpc3Bvc2FsLmFkZERpc3Bvc2VDYWxsYmFjayhlbGVtZW50LCBmdW5jdGlvbigpIHtcbiAgICB2YXIgbXlDaGFydCA9IGtvLnV0aWxzLmRvbURhdGEuZ2V0KGVsZW1lbnQsICdteUNoYXJ0Jyk7XG4gICAgbXlDaGFydC5jbGVhcigpO1xuICAgIG15Q2hhcnQuZGVzdHJveSgpO1xuICB9KTtcbiAgICAgICAgXG4gIGlmIChjaGFydENvbnRleHQpIHtcbiAgICBjaGFydENvbnRleHQoY3R4KTtcbiAgfVxuICAgIH0sXG4gICAgdXBkYXRlOiBmdW5jdGlvbihlbGVtZW50LCB2YWx1ZUFjY2Vzc29yLCBhbGxCaW5kaW5nc0FjY2Vzc29yLCB2aWV3TW9kZWwsIGJpbmRpbmdDb250ZXh0KSB7XG4gICAgICAgIHZhciBuZXdDYW52YXMgPSAkKCc8Y2FudmFzLz4nKS53aWR0aCg3MzApLmhlaWdodCgzNjUpLFxuICAgICAgZGF0YSA9IGtvLnV0aWxzLnVud3JhcE9ic2VydmFibGUodmFsdWVBY2Nlc3NvcigpKSxcbiAgICAgIGN0eCA9IG5ld0NhbnZhc1swXS5nZXRDb250ZXh0KFwiMmRcIiksXG4gICAgICBjaGFydFR5cGUgPSBhbGxCaW5kaW5nc0FjY2Vzc29yKCkuY2hhcnRUeXBlLFxuICAgICAgb3B0aW9ucyA9IGFsbEJpbmRpbmdzQWNjZXNzb3IoKS5jaGFydE9wdGlvbnMgfHwge30sXG4gICAgICBjaGFydENvbnRleHQgPSBhbGxCaW5kaW5nc0FjY2Vzc29yKCkuY2hhcnRDb250ZXh0LFxuICAgICAgbXlDaGFydCA9IGtvLnV0aWxzLmRvbURhdGEuZ2V0KGVsZW1lbnQsICdteUNoYXJ0Jyk7XG4gICAgICAgIFxuICBpZiAobXlDaGFydCkge1xuICAgIG15Q2hhcnQuY2xlYXIoKTtcbiAgICBteUNoYXJ0LmRlc3Ryb3koKTtcbiAgfVxuICAgICAgICBiaW5kaW5nQ29udGV4dC4kcm9vdC5kaXNwbGF5U2hvcCgpO1xuICAgICAgICBiaW5kaW5nQ29udGV4dC4kcm9vdC5zaWRlVmlldygpO1xuICAgICAgICBiaW5kaW5nQ29udGV4dC4kcm9vdC5zaG9wRG9jaygpO1xuICAgICAgICAkKGVsZW1lbnQpLmVtcHR5KCk7XG4gICAgICAgICQoZWxlbWVudCkuYXBwZW5kKG5ld0NhbnZhcyk7XG4gIGlmIChkYXRhLmRhdGFzZXRzLmxlbmd0aCA+IDApIHtcbiAgICAgICAgICAgIG15Q2hhcnQgPSBuZXcgQ2hhcnQoY3R4KVtjaGFydFR5cGVdKGRhdGEsIG9wdGlvbnMpO1xuICAgICAgICAgICAga28udXRpbHMuZG9tRGF0YS5zZXQoZWxlbWVudCwgJ215Q2hhcnQnLCBteUNoYXJ0KTtcbiAgfVxuICBcbiAgaWYgKGNoYXJ0Q29udGV4dCkge1xuICAgIGNoYXJ0Q29udGV4dChjdHgpO1xuICB9XG4gICAgfVxufTtcblxua28uYmluZGluZ0hhbmRsZXJzLnNwaW5uZXIgPSB7XG4gICAgaW5pdDogZnVuY3Rpb24oZWxlbWVudCwgdmFsdWVBY2Nlc3NvciwgYWxsQmluZGluZ3NBY2Nlc3Nvcikge1xuICAgICAgICAvL2luaXRpYWxpemUgZGF0ZXBpY2tlciB3aXRoIHNvbWUgb3B0aW9uYWwgb3B0aW9uc1xuICAgICAgICB2YXIgb3B0aW9ucyA9IGFsbEJpbmRpbmdzQWNjZXNzb3IoKS5zcGlubmVyT3B0aW9ucyB8fCB7fTtcbiAgICAgICAgb3B0aW9ucy5pY29ucyA9IG9wdGlvbnMuaWNvbnMgfHwgeyBkb3duOiBcImdseXBoaWNvbiBnbHlwaGljb24tdHJpYW5nbGUtYm90dG9tXCIsIHVwOiBcImdseXBoaWNvbiBnbHlwaGljb24tdHJpYW5nbGUtdG9wXCIgfTtcbiAgICAgICAgJChlbGVtZW50KS5zcGlubmVyKG9wdGlvbnMpO1xuXG4gICAgICAgIC8vaGFuZGxlIHRoZSBmaWVsZCBjaGFuZ2luZ1xuICAgICAgICBrby51dGlscy5yZWdpc3RlckV2ZW50SGFuZGxlcihlbGVtZW50LCBcInNwaW5jaGFuZ2VcIiwgZnVuY3Rpb24gKCkge1xuICAgICAgICAgICAgdmFyIG9ic2VydmFibGUgPSB2YWx1ZUFjY2Vzc29yKCk7XG4gICAgICAgICAgICBvYnNlcnZhYmxlKCQoZWxlbWVudCkuc3Bpbm5lcihcInZhbHVlXCIpKTtcbiAgICAgICAgfSk7XG5cbiAgICAgICAgLy9oYW5kbGUgZGlzcG9zYWwgKGlmIEtPIHJlbW92ZXMgYnkgdGhlIHRlbXBsYXRlIGJpbmRpbmcpXG4gICAgICAgIGtvLnV0aWxzLmRvbU5vZGVEaXNwb3NhbC5hZGREaXNwb3NlQ2FsbGJhY2soZWxlbWVudCwgZnVuY3Rpb24oKSB7XG4gICAgICAgICAgICAkKGVsZW1lbnQpLnNwaW5uZXIoXCJkZXN0cm95XCIpO1xuICAgICAgICB9KTtcblxuICAgIH0sXG4gICAgdXBkYXRlOiBmdW5jdGlvbihlbGVtZW50LCB2YWx1ZUFjY2Vzc29yKSB7XG4gICAgICAgIHZhciB2YWx1ZSA9IGtvLnV0aWxzLnVud3JhcE9ic2VydmFibGUodmFsdWVBY2Nlc3NvcigpKSxcbiAgICAgICAgICAgIGN1cnJlbnQgPSAkKGVsZW1lbnQpLnNwaW5uZXIoXCJ2YWx1ZVwiKTtcblxuICAgICAgICBpZiAodmFsdWUgIT09IGN1cnJlbnQpIHtcbiAgICAgICAgICAgICQoZWxlbWVudCkuc3Bpbm5lcihcInZhbHVlXCIsIHZhbHVlKTtcbiAgICAgICAgfVxuICAgIH1cbn07XG5cbmtvLmJpbmRpbmdIYW5kbGVycy5zZWNvbmRUYWIgPSB7XG4gICAgdXBkYXRlOiBmdW5jdGlvbihlbGVtZW50LCB2YWx1ZUFjY2Vzc29yLCBhbGxCaW5kaW5nc0FjY2Vzc29yLCB2aWV3TW9kZWwsIGJpbmRpbmdDb250ZXh0KSB7XG4gICAgICAgIHZhciAkcm9vdCA9IGJpbmRpbmdDb250ZXh0LiRyb290LFxuICAgICAgICAgICAgdmFsdWUgPSBrby51dGlscy51bndyYXBPYnNlcnZhYmxlKHZhbHVlQWNjZXNzb3IoKSk7XG4gICAgICAgIGtvLmFwcGx5QmluZGluZ3NUb05vZGUoZWxlbWVudCwgeyBjc3M6IHsnc2Vjb25kLXRhYic6ICRyb290LmlzU2Vjb25kVGFiKHZhbHVlKSAmJiAkcm9vdC5zaWRlVmlldygpfSB9KTtcbiAgICB9XG59O1xuXG5rby5iaW5kaW5nSGFuZGxlcnMuaG92ZXJUYWIgPSB7XG4gICAgdXBkYXRlOiBmdW5jdGlvbihlbGVtZW50LCB2YWx1ZUFjY2Vzc29yLCBhbGxCaW5kaW5nc0FjY2Vzc29yLCB2aWV3TW9kZWwsIGJpbmRpbmdDb250ZXh0KSB7XG4gICAgICAgIHZhciAkcm9vdCA9IGJpbmRpbmdDb250ZXh0LiRyb290LFxuICAgICAgICAgICAgdmFsdWUgPSBrby51dGlscy51bndyYXBPYnNlcnZhYmxlKHZhbHVlQWNjZXNzb3IoKSk7XG4gICAgICAgICAgICBcbiAgICAgICAga28udXRpbHMucmVnaXN0ZXJFdmVudEhhbmRsZXIoZWxlbWVudCwgXCJtb3VzZW92ZXJcIiwgZnVuY3Rpb24oKSB7XG4gICAgICAgICAgICAkcm9vdC5oaWdobGlnaHRUYWIodmFsdWUpO1xuICAgICAgICB9KTsgIFxuXG4gICAgICAgIGtvLnV0aWxzLnJlZ2lzdGVyRXZlbnRIYW5kbGVyKGVsZW1lbnQsIFwibW91c2VvdXRcIiwgZnVuY3Rpb24oKSB7XG4gICAgICAgICAgICAkcm9vdC51bmhpZ2hsaWdodFRhYih2YWx1ZSk7XG4gICAgICAgIH0pOyAgICAgIFxuICAgIH1cbn07XG5cbmtvLmJpbmRpbmdIYW5kbGVycy5ob3ZlclBhbmVTdHlsZSA9IHtcbiAgICBpbml0OiBmdW5jdGlvbihlbGVtZW50LCB2YWx1ZUFjY2Vzc29yLCBhbGxCaW5kaW5nc0FjY2Vzc29yLCB2aWV3TW9kZWwsIGJpbmRpbmdDb250ZXh0KSB7XG4gICAgICAgIHZhciAkcm9vdCA9IGJpbmRpbmdDb250ZXh0LiRyb290LFxuICAgICAgICAgICAgdmFsdWUgPSBrby51dGlscy51bndyYXBPYnNlcnZhYmxlKHZhbHVlQWNjZXNzb3IoKSk7XG4gICAgICAgIGtvLmFwcGx5QmluZGluZ3NUb05vZGUoZWxlbWVudCwgeyBzdHlsZTogeyBvcGFjaXR5OiAhKCRyb290LnNpZGVWaWV3KCkpIHx8ICRyb290LmhpZ2hsaWdodGVkVGFiKCkgPT0gdmFsdWUgfHwgJHJvb3QuaGlnaGxpZ2h0ZWRUYWIoKSA9PSAnJyA/IDEgOiAuNSB9IH0pO1xuICAgIH0sXG4gICAgdXBkYXRlOiBmdW5jdGlvbihlbGVtZW50LCB2YWx1ZUFjY2Vzc29yLCBhbGxCaW5kaW5nc0FjY2Vzc29yLCB2aWV3TW9kZWwsIGJpbmRpbmdDb250ZXh0KSB7XG4gICAgICAgIHZhciAkcm9vdCA9IGJpbmRpbmdDb250ZXh0LiRyb290LFxuICAgICAgICAgICAgdmFsdWUgPSBrby51dGlscy51bndyYXBPYnNlcnZhYmxlKHZhbHVlQWNjZXNzb3IoKSk7XG4gICAgICAgIGtvLmFwcGx5QmluZGluZ3NUb05vZGUoZWxlbWVudCwgeyBzdHlsZTogeyBvcGFjaXR5OiAhKCRyb290LnNpZGVWaWV3KCkpIHx8ICRyb290LmhpZ2hsaWdodGVkVGFiKCkgPT0gdmFsdWUgfHwgJHJvb3QuaGlnaGxpZ2h0ZWRUYWIoKSA9PSAnJyA/IDEgOiAuNSB9IH0pO1xuICAgIH1cbn07XG5cbmtvLmJpbmRpbmdIYW5kbGVycy5kaWZmU3R5bGUgPSB7XG4gICAgaW5pdDogZnVuY3Rpb24oZWxlbWVudCwgdmFsdWVBY2Nlc3NvciwgYWxsQmluZGluZ3NBY2Nlc3Nvciwgdmlld01vZGVsKSB7XG4gICAgICAgIHZhciB2YWx1ZSA9IGtvLnV0aWxzLnVud3JhcE9ic2VydmFibGUodmFsdWVBY2Nlc3NvcigpKTtcbiAgICAgICAga28uYXBwbHlCaW5kaW5nc1RvTm9kZShlbGVtZW50LCB7IGNzczogeydkaWZmUG9zJzogdmFsdWUgPiAwLCAnZGlmZk5lZyc6IHZhbHVlIDwgMH0gfSk7XG4gICAgfSxcbiAgICB1cGRhdGU6IGZ1bmN0aW9uKGVsZW1lbnQsIHZhbHVlQWNjZXNzb3IsIGFsbEJpbmRpbmdzQWNjZXNzb3IsIHZpZXdNb2RlbCkge1xuICAgICAgICB2YXIgdmFsdWUgPSBrby51dGlscy51bndyYXBPYnNlcnZhYmxlKHZhbHVlQWNjZXNzb3IoKSk7XG4gICAgICAgIGtvLmFwcGx5QmluZGluZ3NUb05vZGUoZWxlbWVudCwgeyBjc3M6IHsnZGlmZlBvcyc6IHZhbHVlID4gMCwgJ2RpZmZOZWcnOiB2YWx1ZSA8IDB9IH0pO1xuICAgIH1cbn07XG5cbmtvLmJpbmRpbmdIYW5kbGVycy5kaWZmQ3NzID0ge1xuICAgIGluaXQ6IGZ1bmN0aW9uKGVsZW1lbnQsIHZhbHVlQWNjZXNzb3IsIGFsbEJpbmRpbmdzQWNjZXNzb3IsIHZpZXdNb2RlbCkge1xuICAgICAgICB2YXIgdmFsdWUgPSBrby51dGlscy51bndyYXBPYnNlcnZhYmxlKHZhbHVlQWNjZXNzb3IoKSksXG4gICAgICAgICAgICBzdGF0ID0gYWxsQmluZGluZ3NBY2Nlc3NvcigpLmRpZmZDc3NTdGF0O1xuICAgICAgICBpZiAoc3RhdCA9PSAnYXR0YWNrVGltZScgfHwgc3RhdCA9PSAnYmF0Jykge1xuICAgICAgICAgICAgdmFsdWUgPSAtdmFsdWU7XG4gICAgICAgIH1cbiAgICAgICAga28uYXBwbHlCaW5kaW5nc1RvTm9kZShlbGVtZW50LCB7IGNzczogeydkaWZmUG9zJzogdmFsdWUgPiAwLCAnZGlmZk5lZyc6IHZhbHVlIDwgMH0gfSk7XG4gICAgfSxcbiAgICB1cGRhdGU6IGZ1bmN0aW9uKGVsZW1lbnQsIHZhbHVlQWNjZXNzb3IsIGFsbEJpbmRpbmdzQWNjZXNzb3IsIHZpZXdNb2RlbCkge1xuICAgICAgICB2YXIgdmFsdWUgPSBrby51dGlscy51bndyYXBPYnNlcnZhYmxlKHZhbHVlQWNjZXNzb3IoKSksXG4gICAgICAgICAgICBzdGF0ID0gYWxsQmluZGluZ3NBY2Nlc3NvcigpLmRpZmZDc3NTdGF0O1xuICAgICAgICBpZiAoc3RhdCA9PSAnYXR0YWNrVGltZScgfHwgc3RhdCA9PSAnYmF0Jykge1xuICAgICAgICAgICAgdmFsdWUgPSAtdmFsdWU7XG4gICAgICAgIH1cbiAgICAgICAga28uYXBwbHlCaW5kaW5nc1RvTm9kZShlbGVtZW50LCB7IGNzczogeydkaWZmUG9zJzogdmFsdWUgPiAwLCAnZGlmZk5lZyc6IHZhbHVlIDwgMH0gfSk7XG4gICAgfVxufTtcblxua28uYmluZGluZ0hhbmRsZXJzLmpxQXV0byA9IHtcbiAgICBpbml0OiBmdW5jdGlvbihlbGVtZW50LCB2YWx1ZUFjY2Vzc29yLCBhbGxCaW5kaW5nc0FjY2Vzc29yLCB2aWV3TW9kZWwpIHtcbiAgICAgICAgdmFyIG9wdGlvbnMgPSB2YWx1ZUFjY2Vzc29yKCkgfHwge30sXG4gICAgICAgICAgICBhbGxCaW5kaW5ncyA9IGFsbEJpbmRpbmdzQWNjZXNzb3IoKSxcbiAgICAgICAgICAgIHVud3JhcCA9IGtvLnV0aWxzLnVud3JhcE9ic2VydmFibGUsXG4gICAgICAgICAgICBtb2RlbFZhbHVlID0gYWxsQmluZGluZ3MuanFBdXRvVmFsdWUsXG4gICAgICAgICAgICBzb3VyY2UgPSBhbGxCaW5kaW5ncy5qcUF1dG9Tb3VyY2UsXG4gICAgICAgICAgICB2YWx1ZVByb3AgPSBhbGxCaW5kaW5ncy5qcUF1dG9Tb3VyY2VWYWx1ZSxcbiAgICAgICAgICAgIGlucHV0VmFsdWVQcm9wID0gYWxsQmluZGluZ3MuanFBdXRvU291cmNlSW5wdXRWYWx1ZSB8fCB2YWx1ZVByb3AsXG4gICAgICAgICAgICBsYWJlbFByb3AgPSBhbGxCaW5kaW5ncy5qcUF1dG9Tb3VyY2VMYWJlbCB8fCB2YWx1ZVByb3A7XG5cbiAgICAgICAgLy9mdW5jdGlvbiB0aGF0IGlzIHNoYXJlZCBieSBib3RoIHNlbGVjdCBhbmQgY2hhbmdlIGV2ZW50IGhhbmRsZXJzXG4gICAgICAgIGZ1bmN0aW9uIHdyaXRlVmFsdWVUb01vZGVsKHZhbHVlVG9Xcml0ZSkge1xuICAgICAgICAgICAgaWYgKGtvLmlzV3JpdGVhYmxlT2JzZXJ2YWJsZShtb2RlbFZhbHVlKSkge1xuICAgICAgICAgICAgICAgbW9kZWxWYWx1ZSh2YWx1ZVRvV3JpdGUgKTsgIFxuICAgICAgICAgICAgfSBlbHNlIHsgIC8vd3JpdGUgdG8gbm9uLW9ic2VydmFibGVcbiAgICAgICAgICAgICAgIGlmIChhbGxCaW5kaW5nc1snX2tvX3Byb3BlcnR5X3dyaXRlcnMnXSAmJiBhbGxCaW5kaW5nc1snX2tvX3Byb3BlcnR5X3dyaXRlcnMnXVsnanFBdXRvVmFsdWUnXSlcbiAgICAgICAgICAgICAgICAgICAgICAgIGFsbEJpbmRpbmdzWydfa29fcHJvcGVydHlfd3JpdGVycyddWydqcUF1dG9WYWx1ZSddKHZhbHVlVG9Xcml0ZSApOyAgICBcbiAgICAgICAgICAgIH1cbiAgICAgICAgfVxuICAgICAgICBcbiAgICAgICAgLy9vbiBhIHNlbGVjdGlvbiB3cml0ZSB0aGUgcHJvcGVyIHZhbHVlIHRvIHRoZSBtb2RlbFxuICAgICAgICBvcHRpb25zLnNlbGVjdCA9IGZ1bmN0aW9uKGV2ZW50LCB1aSkge1xuICAgICAgICAgICAgd3JpdGVWYWx1ZVRvTW9kZWwodWkuaXRlbSA/IHVpLml0ZW0uYWN0dWFsVmFsdWUgOiBudWxsKTtcbiAgICAgICAgfTtcbiAgICAgICAgICAgIFxuICAgICAgICAvL29uIGEgY2hhbmdlLCBtYWtlIHN1cmUgdGhhdCBpdCBpcyBhIHZhbGlkIHZhbHVlIG9yIGNsZWFyIG91dCB0aGUgbW9kZWwgdmFsdWVcbiAgICAgICAgb3B0aW9ucy5jaGFuZ2UgPSBmdW5jdGlvbihldmVudCwgdWkpIHtcbiAgICAgICAgICAgIHZhciBjdXJyZW50VmFsdWUgPSAkKGVsZW1lbnQpLnZhbCgpO1xuICAgICAgICAgICAgdmFyIG1hdGNoaW5nSXRlbSA9ICBrby51dGlscy5hcnJheUZpcnN0KHVud3JhcChzb3VyY2UpLCBmdW5jdGlvbihpdGVtKSB7XG4gICAgICAgICAgICAgICByZXR1cm4gdW53cmFwKGl0ZW1baW5wdXRWYWx1ZVByb3BdKSA9PT0gY3VycmVudFZhbHVlOyAgXG4gICAgICAgICAgICB9KTtcbiAgICAgICAgICAgIFxuICAgICAgICAgICAgaWYgKCFtYXRjaGluZ0l0ZW0pIHtcbiAgICAgICAgICAgICAgIHdyaXRlVmFsdWVUb01vZGVsKG51bGwpO1xuICAgICAgICAgICAgfSAgICBcbiAgICAgICAgfVxuICAgICAgICBcbiAgICAgICAgXG4gICAgICAgIC8vaGFuZGxlIHRoZSBjaG9pY2VzIGJlaW5nIHVwZGF0ZWQgaW4gYSBETywgdG8gZGVjb3VwbGUgdmFsdWUgdXBkYXRlcyBmcm9tIHNvdXJjZSAob3B0aW9ucykgdXBkYXRlc1xuICAgICAgICB2YXIgbWFwcGVkU291cmNlID0ga28uZGVwZW5kZW50T2JzZXJ2YWJsZShmdW5jdGlvbigpIHtcbiAgICAgICAgICAgIHZhciBtYXBwZWQgPSBrby51dGlscy5hcnJheU1hcCh1bndyYXAoc291cmNlKSwgZnVuY3Rpb24oaXRlbSkge1xuICAgICAgICAgICAgICAgIHZhciByZXN1bHQgPSB7fTtcbiAgICAgICAgICAgICAgICByZXN1bHQubGFiZWwgPSBsYWJlbFByb3AgPyB1bndyYXAoaXRlbVtsYWJlbFByb3BdKSA6IHVud3JhcChpdGVtKS50b1N0cmluZygpOyAgLy9zaG93IGluIHBvcC11cCBjaG9pY2VzXG4gICAgICAgICAgICAgICAgcmVzdWx0LnZhbHVlID0gaW5wdXRWYWx1ZVByb3AgPyB1bndyYXAoaXRlbVtpbnB1dFZhbHVlUHJvcF0pIDogdW53cmFwKGl0ZW0pLnRvU3RyaW5nKCk7ICAvL3Nob3cgaW4gaW5wdXQgYm94XG4gICAgICAgICAgICAgICAgcmVzdWx0LmFjdHVhbFZhbHVlID0gdmFsdWVQcm9wID8gdW53cmFwKGl0ZW1bdmFsdWVQcm9wXSkgOiBpdGVtOyAgLy9zdG9yZSBpbiBtb2RlbFxuICAgICAgICAgICAgICAgIHJldHVybiByZXN1bHQ7XG4gICAgICAgICAgICB9KTtcbiAgICAgICAgICAgIHJldHVybiBtYXBwZWQ7ICAgICAgICAgICAgICAgIFxuICAgICAgICB9KTtcbiAgICAgICAgXG4gICAgICAgIC8vd2hlbmV2ZXIgdGhlIGl0ZW1zIHRoYXQgbWFrZSB1cCB0aGUgc291cmNlIGFyZSB1cGRhdGVkLCBtYWtlIHN1cmUgdGhhdCBhdXRvY29tcGxldGUga25vd3MgaXRcbiAgICAgICAgbWFwcGVkU291cmNlLnN1YnNjcmliZShmdW5jdGlvbihuZXdWYWx1ZSkge1xuICAgICAgICAgICAkKGVsZW1lbnQpLmF1dG9jb21wbGV0ZShcIm9wdGlvblwiLCBcInNvdXJjZVwiLCBuZXdWYWx1ZSk7IFxuICAgICAgICB9KTtcbiAgICAgICAgXG4gICAgICAgIG9wdGlvbnMuc291cmNlID0gbWFwcGVkU291cmNlKCk7XG4gICAgICAgIFxuICAgICAgICBvcHRpb25zLm1pbkxlbmd0aCA9IDE7XG4gICAgICAgIC8vaW5pdGlhbGl6ZSBhdXRvY29tcGxldGVcbiAgICAgICAgJChlbGVtZW50KS5hdXRvY29tcGxldGUob3B0aW9ucyk7XG4gICAgfSxcbiAgICB1cGRhdGU6IGZ1bmN0aW9uKGVsZW1lbnQsIHZhbHVlQWNjZXNzb3IsIGFsbEJpbmRpbmdzQWNjZXNzb3IsIHZpZXdNb2RlbCkge1xuICAgICAgIC8vdXBkYXRlIHZhbHVlIGJhc2VkIG9uIGEgbW9kZWwgY2hhbmdlXG4gICAgICAgdmFyIGFsbEJpbmRpbmdzID0gYWxsQmluZGluZ3NBY2Nlc3NvcigpLFxuICAgICAgICAgICB1bndyYXAgPSBrby51dGlscy51bndyYXBPYnNlcnZhYmxlLFxuICAgICAgICAgICBtb2RlbFZhbHVlID0gdW53cmFwKGFsbEJpbmRpbmdzLmpxQXV0b1ZhbHVlKSB8fCAnJywgXG4gICAgICAgICAgIHZhbHVlUHJvcCA9IGFsbEJpbmRpbmdzLmpxQXV0b1NvdXJjZVZhbHVlLFxuICAgICAgICAgICBpbnB1dFZhbHVlUHJvcCA9IGFsbEJpbmRpbmdzLmpxQXV0b1NvdXJjZUlucHV0VmFsdWUgfHwgdmFsdWVQcm9wO1xuICAgICAgICBcbiAgICAgICAvL2lmIHdlIGFyZSB3cml0aW5nIGEgZGlmZmVyZW50IHByb3BlcnR5IHRvIHRoZSBpbnB1dCB0aGFuIHdlIGFyZSB3cml0aW5nIHRvIHRoZSBtb2RlbCwgdGhlbiBsb2NhdGUgdGhlIG9iamVjdFxuICAgICAgIGlmICh2YWx1ZVByb3AgJiYgaW5wdXRWYWx1ZVByb3AgIT09IHZhbHVlUHJvcCkge1xuICAgICAgICAgICB2YXIgc291cmNlID0gdW53cmFwKGFsbEJpbmRpbmdzLmpxQXV0b1NvdXJjZSkgfHwgW107XG4gICAgICAgICAgIHZhciBtb2RlbFZhbHVlID0ga28udXRpbHMuYXJyYXlGaXJzdChzb3VyY2UsIGZ1bmN0aW9uKGl0ZW0pIHtcbiAgICAgICAgICAgICAgICAgcmV0dXJuIHVud3JhcChpdGVtW3ZhbHVlUHJvcF0pID09PSBtb2RlbFZhbHVlO1xuICAgICAgICAgICB9KSB8fCB7fTsgIC8vcHJvYmFibHkgZG9uJ3QgbmVlZCB0aGUgfHwge30sIGJ1dCBqdXN0IHByb3RlY3QgYWdhaW5zdCBhIGJhZCB2YWx1ZSAgICAgICAgICBcbiAgICAgICB9IFxuXG4gICAgICAgLy91cGRhdGUgdGhlIGVsZW1lbnQgd2l0aCB0aGUgdmFsdWUgdGhhdCBzaG91bGQgYmUgc2hvd24gaW4gdGhlIGlucHV0XG4gICAgICAgJChlbGVtZW50KS52YWwobW9kZWxWYWx1ZSAmJiBpbnB1dFZhbHVlUHJvcCAhPT0gdmFsdWVQcm9wID8gdW53cmFwKG1vZGVsVmFsdWVbaW5wdXRWYWx1ZVByb3BdKSA6IG1vZGVsVmFsdWUudG9TdHJpbmcoKSk7ICAgIFxuICAgIH1cbn07XG5cbmtvLmJpbmRpbmdIYW5kbGVycy5qcUF1dG9Db21ibyA9IHtcbiAgICBpbml0OiBmdW5jdGlvbihlbGVtZW50LCB2YWx1ZUFjY2Vzc29yKSB7XG4gICAgICAgdmFyIGF1dG9FbCA9ICQoXCIjXCIgKyB2YWx1ZUFjY2Vzc29yKCkpO1xuICAgICAgIFxuICAgICAgICAkKGVsZW1lbnQpLmNsaWNrKGZ1bmN0aW9uKCkge1xuICAgICAgICAgICAvLyBjbG9zZSBpZiBhbHJlYWR5IHZpc2libGVcbiAgICAgICAgICAgIGlmIChhdXRvRWwuYXV0b2NvbXBsZXRlKFwid2lkZ2V0XCIpLmlzKFwiOnZpc2libGVcIikpIHtcbiAgICAgICAgICAgICAgICBhdXRvRWwuYXV0b2NvbXBsZXRlKCBcImNsb3NlXCIgKTtcbiAgICAgICAgICAgICAgICByZXR1cm47XG4gICAgICAgICAgICB9XG5cbiAgICAgICAgICAgLy9hdXRvRWwuYmx1cigpO1xuICAgICAgICAgICAgYXV0b0VsLmF1dG9jb21wbGV0ZShcInNlYXJjaFwiLCBcIiBcIik7XG4gICAgICAgICAgICBhdXRvRWwuZm9jdXMoKTsgXG4gICAgICAgICAgICBcbiAgICAgICAgfSk7XG4gICAgICAgIFxuICAgIH0gIFxufVxuXG5tb2R1bGUuZXhwb3J0cyA9IGtvOyIsInZhciBrbyA9ICh0eXBlb2Ygd2luZG93ICE9PSBcInVuZGVmaW5lZFwiID8gd2luZG93WydrbyddIDogdHlwZW9mIGdsb2JhbCAhPT0gXCJ1bmRlZmluZWRcIiA/IGdsb2JhbFsna28nXSA6IG51bGwpO1xudmFyIG15ID0gcmVxdWlyZShcIi4uL2hlcm9jYWxjL21haW5cIik7XG5yZXF1aXJlKFwiLi9oZXJvY2FsY19oZXJvX2RhbWFnZWFtcFwiKTtcbnJlcXVpcmUoXCIuL2hlcm9jYWxjX2J1ZmZzLmFtcGxpZmljYXRpb24ucmVkdWN0aW9uXCIpO1xucmVxdWlyZShcIi4vaGVyb2NhbGNfYnVpbGRleHBsb3JlclwiKTtcblxubXkucHJvdG90eXBlLkhlcm9PcHRpb24yID0gZnVuY3Rpb24gKGhlcm8pIHtcbiAgICB0aGlzLmhlcm9OYW1lID0ga28uY29tcHV0ZWQoZnVuY3Rpb24gKCkge1xuICAgICAgICByZXR1cm4gaGVyby5zZWxlY3RlZEhlcm8oKS5oZXJvTmFtZTtcbiAgICB9KTtcbiAgICB0aGlzLmhlcm9EaXNwbGF5TmFtZSA9IGtvLmNvbXB1dGVkKGZ1bmN0aW9uICgpIHtcbiAgICAgICAgcmV0dXJuIGhlcm8uc2VsZWN0ZWRIZXJvKCkuaGVyb0Rpc3BsYXlOYW1lO1xuICAgIH0pO1xuICAgIHRoaXMuaGVybyA9IGhlcm87XG59O1xuXG5teS5wcm90b3R5cGUuSGVyb0NhbGN1bGF0b3JNb2RlbCA9IGZ1bmN0aW9uIChoKSB7XG4gICAgdmFyIHNlbGYgPSB0aGlzO1xuICAgIHNlbGYuaW5kZXggPSBrby5vYnNlcnZhYmxlKGgpO1xuICAgIHNlbGYuYXZhaWxhYmxlSGVyb2VzID0ga28ub2JzZXJ2YWJsZUFycmF5KG15LnByb3RvdHlwZS5IZXJvT3B0aW9ucyk7XG4gICAgc2VsZi5hdmFpbGFibGVIZXJvZXMuc29ydChmdW5jdGlvbiAobGVmdCwgcmlnaHQpIHtcbiAgICAgICAgcmV0dXJuIGxlZnQuaGVyb0Rpc3BsYXlOYW1lID09IHJpZ2h0Lmhlcm9EaXNwbGF5TmFtZSA/IDAgOiAobGVmdC5oZXJvRGlzcGxheU5hbWUgPCByaWdodC5oZXJvRGlzcGxheU5hbWUgPyAtMSA6IDEpO1xuICAgIH0pO1xuICAgIHNlbGYuc2VsZWN0ZWRIZXJvID0ga28ub2JzZXJ2YWJsZShzZWxmLmF2YWlsYWJsZUhlcm9lcygpW2hdKTtcbiAgICBcbiAgICBteS5wcm90b3R5cGUuSGVyb01vZGVsLmNhbGwodGhpcywgc2VsZi5zZWxlY3RlZEhlcm8oKS5oZXJvTmFtZSk7XG4gICAgXG4gICAgc2VsZi5zZWxlY3RlZEhlcm8uc3Vic2NyaWJlKGZ1bmN0aW9uIChuZXdWYWx1ZSkge1xuICAgICAgICBzZWxmLmhlcm9JZChuZXdWYWx1ZS5oZXJvTmFtZSk7XG4gICAgfSk7XG4gICAgXG4gICAgXG4gICAgc2VsZi5ib3VuZCA9IGtvLm9ic2VydmFibGUoZmFsc2UpO1xuICAgIHNlbGYucGxheWVyQ29sb3JDc3MgPSBrby5jb21wdXRlZChmdW5jdGlvbiAoKSB7XG4gICAgICAgIHJldHVybiAncGxheWVyLWNvbG9yLScgKyBzZWxmLmluZGV4KCk7XG4gICAgfSk7XG4gICAgc2VsZi5oZXJvT3B0aW9uID0gbmV3IG15LnByb3RvdHlwZS5IZXJvT3B0aW9uMihzZWxmKTtcbiAgICBzZWxmLm90aGVySGVyb2VzID0ga28ub2JzZXJ2YWJsZUFycmF5KFtdKTtcbiAgICBzZWxmLmF2YWlsYWJsZUNvbXBhcmUgPSBrby5jb21wdXRlZChmdW5jdGlvbiAoKSB7XG4gICAgICAgIHJldHVybiBzZWxmLm90aGVySGVyb2VzKCkubWFwKGZ1bmN0aW9uIChvKSB7XG4gICAgICAgICAgICByZXR1cm4gby5oZXJvT3B0aW9uO1xuICAgICAgICB9KTtcbiAgICB9KTtcbiAgICBzZWxmLnNlbGVjdGVkQ29tcGFyZSA9IGtvLm9ic2VydmFibGUoKTtcbiAgICBzZWxmLnNlbGVjdGVkQ29tcGFyZS5zdWJzY3JpYmUoZnVuY3Rpb24gKG5ld1ZhbHVlKSB7XG4gICAgICAgIHNlbGYuaGVyb0NvbXBhcmUobmV3VmFsdWUuaGVybyk7XG4gICAgfSk7XG4gICAgc2VsZi5lbmVtaWVzID0ga28ub2JzZXJ2YWJsZUFycmF5KFtdKTtcbiAgICBzZWxmLmF2YWlsYWJsZUVuZW1pZXMgPSBrby5jb21wdXRlZChmdW5jdGlvbiAoKSB7XG4gICAgICAgIHJldHVybiBzZWxmLmVuZW1pZXMoKS5tYXAoZnVuY3Rpb24gKG8pIHtcbiAgICAgICAgICAgIHJldHVybiBvLmhlcm9PcHRpb247XG4gICAgICAgIH0pO1xuICAgIH0pO1xuICAgIHNlbGYuc2VsZWN0ZWRFbmVteSA9IGtvLm9ic2VydmFibGUoKTtcbiAgICBzZWxmLnNlbGVjdGVkRW5lbXkuc3Vic2NyaWJlKGZ1bmN0aW9uIChuZXdWYWx1ZSkge1xuICAgICAgICBzZWxmLmVuZW15KG5ld1ZhbHVlLmhlcm8pO1xuICAgIH0pO1xuICAgIHNlbGYuc2V0SGVyb09wdGlvblN0eWxpbmcgPSBmdW5jdGlvbihvcHRpb24sIGl0ZW0pIHtcbiAgICAgICAga28uYXBwbHlCaW5kaW5nc1RvTm9kZShvcHRpb24sIHtjc3M6IGl0ZW0uaGVyby5wbGF5ZXJDb2xvckNzcygpIH0sIGl0ZW0pO1xuICAgIH1cbiAgICBzZWxmLnNlY3Rpb25EaXNwbGF5ID0ga28ub2JzZXJ2YWJsZSh7XG4gICAgICAgICdpbnZlbnRvcnknOiBrby5vYnNlcnZhYmxlKHRydWUpLFxuICAgICAgICAnYWJpbGl0eSc6IGtvLm9ic2VydmFibGUodHJ1ZSksXG4gICAgICAgICdidWZmJzoga28ub2JzZXJ2YWJsZSh0cnVlKSxcbiAgICAgICAgJ2RlYnVmZic6IGtvLm9ic2VydmFibGUodHJ1ZSksXG4gICAgICAgICdkYW1hZ2VhbXAnOiBrby5vYnNlcnZhYmxlKGZhbHNlKSxcbiAgICAgICAgJ2lsbHVzaW9uJzoga28ub2JzZXJ2YWJsZShmYWxzZSksXG4gICAgICAgICdza2lsbGJ1aWxkJzoga28ub2JzZXJ2YWJsZShmYWxzZSksXG4gICAgICAgICdza2lsbGJ1aWxkLXNraWxscyc6IGtvLm9ic2VydmFibGUodHJ1ZSksXG4gICAgICAgICdza2lsbGJ1aWxkLWl0ZW1zJzoga28ub2JzZXJ2YWJsZSh0cnVlKVxuICAgIH0pO1xuICAgIHNlbGYuc2VjdGlvbkRpc3BsYXlUb2dnbGUgPSBmdW5jdGlvbiAoc2VjdGlvbikge1xuICAgICAgICBzZWxmLnNlY3Rpb25EaXNwbGF5KClbc2VjdGlvbl0oIXNlbGYuc2VjdGlvbkRpc3BsYXkoKVtzZWN0aW9uXSgpKTtcbiAgICB9XG4gICAgc2VsZi5zaG93VW5pdFRhYiA9IGtvLm9ic2VydmFibGUoZmFsc2UpO1xuICAgIHNlbGYuc2hvd0RpZmYgPSBrby5vYnNlcnZhYmxlKGZhbHNlKTtcbiAgICBzZWxmLnNob3dDcml0aWNhbFN0cmlrZURldGFpbHMgPSBrby5vYnNlcnZhYmxlKGZhbHNlKTtcbiAgICBzZWxmLnNob3dEYW1hZ2VEZXRhaWxzID0ga28ub2JzZXJ2YWJsZShmYWxzZSk7XG4gICAgc2VsZi5zaG93U3RhdERldGFpbHMgPSBrby5vYnNlcnZhYmxlKGZhbHNlKTtcbiAgICBzZWxmLnNob3dEYW1hZ2VBbXBDYWxjRGV0YWlscyA9IGtvLm9ic2VydmFibGUoZmFsc2UpO1xuICAgIFxuICAgIHNlbGYuZGFtYWdlQW1wbGlmaWNhdGlvbiA9IG5ldyBteS5wcm90b3R5cGUuRGFtYWdlQW1wVmlld01vZGVsKCk7XG4gICAgc2VsZi5kYW1hZ2VSZWR1Y3Rpb24gPSBuZXcgbXkucHJvdG90eXBlLkRhbWFnZUFtcFZpZXdNb2RlbCgpO1xuICAgIHNlbGYuYnVpbGRFeHBsb3JlciA9IG5ldyBteS5wcm90b3R5cGUuQnVpbGRFeHBsb3JlclZpZXdNb2RlbChzZWxmKTtcbiAgICBteS5wcm90b3R5cGUuSGVyb0RhbWFnZUFtcE1peGluKHNlbGYpO1xufVxubXkucHJvdG90eXBlLkhlcm9DYWxjdWxhdG9yTW9kZWwucHJvdG90eXBlID0gT2JqZWN0LmNyZWF0ZShteS5wcm90b3R5cGUuSGVyb01vZGVsLnByb3RvdHlwZSk7XG5teS5wcm90b3R5cGUuSGVyb0NhbGN1bGF0b3JNb2RlbC5wcm90b3R5cGUuY29uc3RydWN0b3IgPSBteS5wcm90b3R5cGUuSGVyb0NhbGN1bGF0b3JNb2RlbDsiLCIndXNlIHN0cmljdCc7XG52YXIgJCA9ICh0eXBlb2Ygd2luZG93ICE9PSBcInVuZGVmaW5lZFwiID8gd2luZG93WyckJ10gOiB0eXBlb2YgZ2xvYmFsICE9PSBcInVuZGVmaW5lZFwiID8gZ2xvYmFsWyckJ10gOiBudWxsKTtcbnJlcXVpcmUoJ2pxdWVyeS11aScpO1xucmVxdWlyZSgnLi4vLi4vLi4vbm9kZV9tb2R1bGVzL2pxdWVyeS11aS91aS92ZXJzaW9uJyk7XG5yZXF1aXJlKCcuLi8uLi8uLi9ub2RlX21vZHVsZXMvanF1ZXJ5LXVpL3VpL3dpZGdldCcpO1xucmVxdWlyZSgnLi4vLi4vLi4vbm9kZV9tb2R1bGVzL2pxdWVyeS11aS91aS91bmlxdWUtaWQnKTtcbnJlcXVpcmUoJy4uLy4uLy4uL25vZGVfbW9kdWxlcy9qcXVlcnktdWkvdWkvc2FmZS1hY3RpdmUtZWxlbWVudCcpO1xucmVxdWlyZSgnLi4vLi4vLi4vbm9kZV9tb2R1bGVzL2pxdWVyeS11aS91aS9rZXljb2RlJyk7XG5yZXF1aXJlKCcuLi8uLi8uLi9ub2RlX21vZHVsZXMvanF1ZXJ5LXVpL3VpL3Bvc2l0aW9uJyk7XG5yZXF1aXJlKCcuLi8uLi8uLi9ub2RlX21vZHVsZXMvanF1ZXJ5LXVpL3VpL2ZvY3VzYWJsZScpO1xucmVxdWlyZSgnLi4vLi4vLi4vbm9kZV9tb2R1bGVzL2pxdWVyeS11aS91aS90YWJiYWJsZScpO1xucmVxdWlyZSgnLi4vLi4vLi4vbm9kZV9tb2R1bGVzL2pxdWVyeS11aS91aS9wbHVnaW4nKTtcbnJlcXVpcmUoJy4uLy4uLy4uL25vZGVfbW9kdWxlcy9qcXVlcnktdWkvdWkvaWUnKTtcbnJlcXVpcmUoJy4uLy4uLy4uL25vZGVfbW9kdWxlcy9qcXVlcnktdWkvdWkvZGF0YScpO1xucmVxdWlyZSgnLi4vLi4vLi4vbm9kZV9tb2R1bGVzL2pxdWVyeS11aS91aS9zY3JvbGwtcGFyZW50Jyk7XG5yZXF1aXJlKCcuLi8uLi8uLi9ub2RlX21vZHVsZXMvanF1ZXJ5LXVpL3VpL2Rpc2FibGUtc2VsZWN0aW9uJyk7XG5yZXF1aXJlKCcuLi8uLi8uLi9ub2RlX21vZHVsZXMvanF1ZXJ5LXVpL3VpL3NhZmUtYmx1cicpO1xucmVxdWlyZSgnLi4vLi4vLi4vbm9kZV9tb2R1bGVzL2pxdWVyeS11aS91aS93aWRnZXRzL2J1dHRvbicpO1xucmVxdWlyZSgnLi4vLi4vLi4vbm9kZV9tb2R1bGVzL2pxdWVyeS11aS91aS93aWRnZXRzL3NwaW5uZXInKTtcbnJlcXVpcmUoJy4uLy4uLy4uL25vZGVfbW9kdWxlcy9qcXVlcnktdWkvdWkvd2lkZ2V0cy9tZW51Jyk7XG5yZXF1aXJlKCcuLi8uLi8uLi9ub2RlX21vZHVsZXMvanF1ZXJ5LXVpL3VpL3dpZGdldHMvYXV0b2NvbXBsZXRlJyk7XG5yZXF1aXJlKCcuLi8uLi8uLi9ub2RlX21vZHVsZXMvanF1ZXJ5LXVpL3VpL3dpZGdldHMvbW91c2UnKTtcbnJlcXVpcmUoJy4uLy4uLy4uL25vZGVfbW9kdWxlcy9qcXVlcnktdWkvdWkvd2lkZ2V0cy9kcmFnZ2FibGUnKTtcbnJlcXVpcmUoJy4uLy4uLy4uL25vZGVfbW9kdWxlcy9qcXVlcnktdWkvdWkvd2lkZ2V0cy9yZXNpemFibGUnKTtcbnJlcXVpcmUoJy4uLy4uLy4uL25vZGVfbW9kdWxlcy9qcXVlcnktdWkvdWkvd2lkZ2V0cy9kaWFsb2cnKTtcblxudmFyIHByb3RvID0gJC51aS5hdXRvY29tcGxldGUucHJvdG90eXBlLFxuICAgIGluaXRTb3VyY2UgPSBwcm90by5faW5pdFNvdXJjZTtcblxuZnVuY3Rpb24gZmlsdGVyKCBhcnJheSwgdGVybSApIHtcbiAgICB2YXIgbWF0Y2hlciA9IG5ldyBSZWdFeHAoICQudWkuYXV0b2NvbXBsZXRlLmVzY2FwZVJlZ2V4KHRlcm0pLCBcImlcIiApO1xuICAgIHJldHVybiAkLmdyZXAoIGFycmF5LCBmdW5jdGlvbih2YWx1ZSkge1xuICAgICAgICByZXR1cm4gbWF0Y2hlci50ZXN0KCAkKCBcIjxkaXY+XCIgKS5odG1sKCB2YWx1ZS5sYWJlbCB8fCB2YWx1ZS52YWx1ZSB8fCB2YWx1ZSApLnRleHQoKSApO1xuICAgIH0pO1xufVxuXG4kLmV4dGVuZCggcHJvdG8sIHtcbiAgICBfaW5pdFNvdXJjZTogZnVuY3Rpb24oKSB7XG4gICAgICAgIGlmICggdGhpcy5vcHRpb25zLmh0bWwgJiYgJC5pc0FycmF5KHRoaXMub3B0aW9ucy5zb3VyY2UpICkge1xuICAgICAgICAgICAgdGhpcy5zb3VyY2UgPSBmdW5jdGlvbiggcmVxdWVzdCwgcmVzcG9uc2UgKSB7XG4gICAgICAgICAgICAgICAgcmVzcG9uc2UoIGZpbHRlciggdGhpcy5vcHRpb25zLnNvdXJjZSwgcmVxdWVzdC50ZXJtICkgKTtcbiAgICAgICAgICAgIH07XG4gICAgICAgIH0gZWxzZSB7XG4gICAgICAgICAgICBpbml0U291cmNlLmNhbGwoIHRoaXMgKTtcbiAgICAgICAgfVxuICAgIH0sXG5cbiAgICBfcmVuZGVySXRlbTogZnVuY3Rpb24oIHVsLCBpdGVtKSB7XG4gICAgICAgIHJldHVybiAkKCBcIjxsaT48L2xpPlwiIClcbiAgICAgICAgICAgIC5kYXRhKCBcIml0ZW0uYXV0b2NvbXBsZXRlXCIsIGl0ZW0gKVxuICAgICAgICAgICAgLmFwcGVuZCggJCggXCI8YT48L2E+XCIgKVsgdGhpcy5vcHRpb25zLmh0bWwgPyBcImh0bWxcIiA6IFwidGV4dFwiIF0oIGl0ZW0ubGFiZWwgKSApXG4gICAgICAgICAgICAuYXBwZW5kVG8oIHVsICk7XG4gICAgfVxufSk7IiwiJ3VzZSBzdHJpY3QnO1xudmFyIGtvID0gcmVxdWlyZSgnLi9oZXJvY2FsY19rbm9ja291dCcpO1xudmFyICQgPSAodHlwZW9mIHdpbmRvdyAhPT0gXCJ1bmRlZmluZWRcIiA/IHdpbmRvd1snJCddIDogdHlwZW9mIGdsb2JhbCAhPT0gXCJ1bmRlZmluZWRcIiA/IGdsb2JhbFsnJCddIDogbnVsbCk7XG5nbG9iYWwualF1ZXJ5ID0gJDtcbnJlcXVpcmUoJ2Jvb3RzdHJhcCcpO1xucmVxdWlyZSgnLi9qcXVlcnktdWkuY3VzdG9tJyk7XG5yZXF1aXJlKCcuLi9saWIvQ2hhcnQubWluJyk7XG5yZXF1aXJlKCcuLi9saWIvQ2hhcnQuc2NhdHRlcicpO1xuXG5rby5jb21wb25lbnRzLnJlZ2lzdGVyKCdoZXJvLXBhbmUnLCB7IHRlbXBsYXRlOiBcIjxkaXYgY2xhc3M9XFxcInJvd1xcXCI+XFxuICAgIDxkaXYgY2xhc3M9XFxcImNvbC1tZC0zXFxcIj5cXG4gICAgICAgIDxpbWcgY2xhc3M9XFxcImltZy1yb3VuZGVkIGhlcm8taW1hZ2VcXFwiIGRhdGEtYmluZD1cXFwiYXR0cjp7c3JjOiAnL21lZGlhL2ltYWdlcy9oZXJvZXMvJyArIHNlbGVjdGVkSGVybygpLmhlcm9OYW1lICsgJy5wbmcnfVxcXCIvPlxcbiAgICA8L2Rpdj5cXG4gICAgPGRpdiBjbGFzcz1cXFwiY29sLW1kLTlcXFwiPlxcbiAgICAgICAgPGRpdiBjbGFzcz1cXFwicm93IGZvcm0tZ3JvdXBcXFwiPlxcbiAgICAgICAgICAgIDxkaXYgY2xhc3M9XFxcImNvbC1tZC02XFxcIj5cXG4gICAgICAgICAgICAgICAgPGxhYmVsIGZvcj1cXFwiaGVyb3NlbGVjdFxcXCI+SGVybzwvbGFiZWw+XFxuICAgICAgICAgICAgICAgIDxzZWxlY3QgaWQ9XFxcImhlcm9zZWxlY3RcXFwiIGNsYXNzPVxcXCJmb3JtLWNvbnRyb2xcXFwiIGRhdGEtYmluZD1cXFwib3B0aW9uczogYXZhaWxhYmxlSGVyb2VzICwgb3B0aW9uc1RleHQ6ICdoZXJvRGlzcGxheU5hbWUnLCB2YWx1ZTogc2VsZWN0ZWRIZXJvXFxcIj48L3NlbGVjdD5cXG4gICAgICAgICAgICA8L2Rpdj5cXG4gICAgICAgICAgICA8ZGl2IGNsYXNzPVxcXCJjb2wtbWQtNlxcXCI+XFxuICAgICAgICAgICAgICAgIDxsYWJlbCBmb3I9XFxcImhlcm9sZXZlbFxcXCI+TGV2ZWw8L2xhYmVsPlxcbiAgICAgICAgICAgICAgICA8aW5wdXQgaWQ9XFxcImhlcm9sZXZlbFxcXCIgZGF0YS1iaW5kPVxcXCJzcGlubmVyOiBzZWxlY3RlZEhlcm9MZXZlbCwgc3Bpbm5lck9wdGlvbnM6IHsgbWluOiAxLCBtYXg6IDI1IH1cXFwiPlxcbiAgICAgICAgICAgIDwvZGl2PlxcbiAgICAgICAgPC9kaXY+XFxuICAgICAgICA8ZGl2IGNsYXNzPVxcXCJyb3dcXFwiPlxcbiAgICAgICAgICAgIDxkaXYgY2xhc3M9XFxcImNvbC1tZC02XFxcIj5cXG4gICAgICAgICAgICAgICAgPGxhYmVsIGZvcj1cXFwiZW5lbXlzZWxlY3RcXFwiPkVuZW15PC9sYWJlbD5cXG4gICAgICAgICAgICAgICAgPHNlbGVjdCBpZD1cXFwiZW5lbXlzZWxlY3RcXFwiIGNsYXNzPVxcXCJmb3JtLWNvbnRyb2xcXFwiIGRhdGEtYmluZD1cXFwiY3NzOiBlbmVteSgpLnBsYXllckNvbG9yQ3NzLCBvcHRpb25zOiBhdmFpbGFibGVFbmVtaWVzICwgb3B0aW9uc1RleHQ6ICdoZXJvRGlzcGxheU5hbWUnLCB2YWx1ZTogc2VsZWN0ZWRFbmVteSwgb3B0aW9uc0FmdGVyUmVuZGVyOiBzZXRIZXJvT3B0aW9uU3R5bGluZ1xcXCI+PC9zZWxlY3Q+XFxuICAgICAgICAgICAgPC9kaXY+XFxuICAgICAgICAgICAgPGRpdiBjbGFzcz1cXFwiY29sLW1kLTZcXFwiPlxcbiAgICAgICAgICAgICAgICA8bGFiZWwgZm9yPVxcXCJlbmVteXNlbGVjdFxcXCI+Q29tcGFyZSB0bzwvbGFiZWw+XFxuICAgICAgICAgICAgICAgIDxzZWxlY3QgaWQ9XFxcImVuZW15c2VsZWN0XFxcIiBjbGFzcz1cXFwiZm9ybS1jb250cm9sXFxcIiBkYXRhLWJpbmQ9XFxcImNzczogaGVyb0NvbXBhcmUoKS5wbGF5ZXJDb2xvckNzcywgb3B0aW9uczogYXZhaWxhYmxlQ29tcGFyZSAsIG9wdGlvbnNUZXh0OiAnaGVyb0Rpc3BsYXlOYW1lJywgdmFsdWU6IHNlbGVjdGVkQ29tcGFyZSwgb3B0aW9uc0FmdGVyUmVuZGVyOiBzZXRIZXJvT3B0aW9uU3R5bGluZ1xcXCI+PC9zZWxlY3Q+XFxuICAgICAgICAgICAgPC9kaXY+XFxuICAgICAgICAgICAgPGRpdiBjbGFzcz1cXFwiY29sLW1kLTEyIGNoZWNrYm94XFxcIiBzdHlsZT1cXFwibWFyZ2luLWJvdHRvbTowcHg7cGFkZGluZy1sZWZ0OjM0cHg7XFxcIiBkYXRhLWJpbmQ9XFxcInZpc2libGU6ICRyb290LmxheW91dCgpID09IDBcXFwiPlxcbiAgICAgICAgICAgICAgICA8bGFiZWw+PGlucHV0IHR5cGU9XFxcImNoZWNrYm94XFxcIiBzdHlsZT1cXFwiZmxvYXQ6bm9uZTttYXJnaW4tcmlnaHQ6NXB4O1xcXCIgZGF0YS1iaW5kPVxcXCJjaGVja2VkOiBzaG93RGlmZlxcXCI+PHNwYW4gc3R5bGU9XFxcImZvbnQtc2l6ZToxMnB4XFxcIj5TaG93IDxhYmJyIHRpdGxlPVxcXCJUaGUgZGlmZmVyZW5jZSBiZXR3ZWVuIHR3byBhZGphY2VudCBoZXJvIHRhYnMgc2hvd24gbmV4dCB0byBlYWNoIHN0YXQuXFxcIj5kZWx0YSB2YWx1ZXM8L2FiYnI+LiA8c3BhbiBkYXRhLWJpbmQ9XFxcInZpc2libGU6IHNob3dEaWZmXFxcIj5Db21wYXJpbmcgbGV2ZWwgPHNwYW4gZGF0YS1iaW5kPVxcXCJ0ZXh0OiBzZWxlY3RlZEhlcm9MZXZlbFxcXCI+PC9zcGFuPiA8c3BhbiBkYXRhLWJpbmQ9XFxcInRleHQ6IGhlcm9EYXRhKCkuZGlzcGxheW5hbWUsIGNzczogcGxheWVyQ29sb3JDc3NcXFwiPjwvc3Bhbj4gdG8gbGV2ZWwgPHNwYW4gZGF0YS1iaW5kPVxcXCJ0ZXh0OiBoZXJvQ29tcGFyZSgpLnNlbGVjdGVkSGVyb0xldmVsXFxcIj48L3NwYW4+IDxzcGFuIGRhdGEtYmluZD1cXFwidGV4dDogaGVyb0NvbXBhcmUoKS5oZXJvRGF0YSgpLmRpc3BsYXluYW1lLCBjc3M6IGhlcm9Db21wYXJlKCkucGxheWVyQ29sb3JDc3NcXFwiPjwvc3Bhbj4uPC9zcGFuPjwvc3Bhbj48L2xhYmVsPlxcbiAgICAgICAgICAgICAgICA8bGFiZWwgc3R5bGU9XFxcIm1hcmdpbi1sZWZ0OjI1cHg7Zm9udC1zaXplOjEycHg7XFxcIj48aW5wdXQgdHlwZT1cXFwiY2hlY2tib3hcXFwiIHN0eWxlPVxcXCJmbG9hdDpub25lO21hcmdpbi1yaWdodDo1cHg7XFxcIiBkYXRhLWJpbmQ9XFxcImNoZWNrZWQ6IHNob3dVbml0VGFiXFxcIj5TaG93IHVuaXQgdGFiPC9sYWJlbD5cXG4gICAgICAgICAgICA8L2Rpdj5cXG4gICAgICAgIDwvZGl2PlxcbiAgICA8L2Rpdj5cXG48L2Rpdj5cXG5cXG48ZGl2IGNsYXNzPVxcXCJyb3dcXFwiPlxcbiAgICA8ZGl2IGNsYXNzPVxcXCJjb2wtbWQtNFxcXCIgZGF0YS1iaW5kPVxcXCJjc3M6IHsnY29sLW1kLTQnOiAkcm9vdC5sYXlvdXQoKSA9PSAwLCAnY29sLW1kLTEyJzogJHJvb3QubGF5b3V0KCkgPT0gMX1cXFwiPlxcbiAgICAgICAgPGRpdiBjbGFzcz1cXFwicm93XFxcIj5cXG4gICAgICAgICAgICA8aDMgY2xhc3M9XFxcImNvbC1tZC0xMlxcXCI+U3RhdHMgPGEgY2xhc3M9XFxcImJ0biBidG4tZGVmYXVsdCBidG4teHNcXFwiIGRhdGEtYmluZD1cXFwidG9nZ2xlOiBzaG93U3RhdERldGFpbHMsIHRleHQ6ICFzaG93U3RhdERldGFpbHMoKSA/ICdTaG93IG1vcmUnIDogJ1Nob3cgbGVzcycsIGF0dHI6IHt0aXRsZTogIXNob3dTdGF0RGV0YWlscygpID8gJ0NsaWNrIHRvIHNob3cgYmFzZSBzdGF0cycgOiAnQ2xpY2sgdG8gaGlkZSBiYXNlIHN0YXRzJ31cXFwiPjwvYT5cXG4gICAgICAgICAgICAgICAgPGRpdiBzdHlsZT1cXFwibWFyZ2luLWxlZnQ6MTVweDtkaXNwbGF5OmlubGluZTtcXFwiIGRhdGEtYmluZD1cXFwic3R5bGU6IHsnZGlzcGxheSc6ICRyb290LmxheW91dCgpID09IDEgPyAnaW5saW5lJyA6ICdub25lJ31cXFwiPlxcbiAgICAgICAgICAgICAgICAgICAgPGxhYmVsPjxpbnB1dCB0eXBlPVxcXCJjaGVja2JveFxcXCIgc3R5bGU9XFxcImZsb2F0Om5vbmU7bWFyZ2luLXJpZ2h0OjVweDtcXFwiIGRhdGEtYmluZD1cXFwiY2hlY2tlZDogc2hvd0RpZmZcXFwiPjxzcGFuIHN0eWxlPVxcXCJmb250LXNpemU6MTJweFxcXCI+U2hvdyA8YWJiciB0aXRsZT1cXFwiVGhlIGRpZmZlcmVuY2UgYmV0d2VlbiB0d28gYWRqYWNlbnQgaGVybyB0YWJzIHNob3duIG5leHQgdG8gZWFjaCBzdGF0LlxcXCI+ZGVsdGEgdmFsdWVzPC9hYmJyPi4gPHNwYW4gZGF0YS1iaW5kPVxcXCJ2aXNpYmxlOiBzaG93RGlmZlxcXCI+Q29tcGFyaW5nIGxldmVsIDxzcGFuIGRhdGEtYmluZD1cXFwidGV4dDogc2VsZWN0ZWRIZXJvTGV2ZWxcXFwiPjwvc3Bhbj4gPHNwYW4gZGF0YS1iaW5kPVxcXCJ0ZXh0OiBoZXJvRGF0YSgpLmRpc3BsYXluYW1lLCBjc3M6IHBsYXllckNvbG9yQ3NzXFxcIj48L3NwYW4+IHRvIGxldmVsIDxzcGFuIGRhdGEtYmluZD1cXFwidGV4dDogaGVyb0NvbXBhcmUoKS5zZWxlY3RlZEhlcm9MZXZlbFxcXCI+PC9zcGFuPiA8c3BhbiBkYXRhLWJpbmQ9XFxcInRleHQ6IGhlcm9Db21wYXJlKCkuaGVyb0RhdGEoKS5kaXNwbGF5bmFtZSwgY3NzOiBoZXJvQ29tcGFyZSgpLnBsYXllckNvbG9yQ3NzXFxcIj48L3NwYW4+Ljwvc3Bhbj48L3NwYW4+PC9sYWJlbD5cXG4gICAgICAgICAgICAgICAgICAgIDxsYWJlbCBzdHlsZT1cXFwibWFyZ2luLWxlZnQ6MjVweDtmb250LXNpemU6MTJweDtcXFwiPjxpbnB1dCB0eXBlPVxcXCJjaGVja2JveFxcXCIgc3R5bGU9XFxcImZsb2F0Om5vbmU7bWFyZ2luLXJpZ2h0OjVweDtcXFwiIGRhdGEtYmluZD1cXFwiY2hlY2tlZDogc2hvd1VuaXRUYWJcXFwiPlNob3cgdW5pdCB0YWI8L2xhYmVsPlxcbiAgICAgICAgICAgICAgICA8L2Rpdj5cXG4gICAgICAgICAgICA8L2gzPlxcblxcbiAgICAgICAgICAgIDxkaXYgY2xhc3M9XFxcImNvbC1tZC0xMlxcXCIgZGF0YS1iaW5kPVxcXCJ2aXNpYmxlOiBzaG93U3RhdERldGFpbHMoKSwgY3NzOiB7J2NvbC1tZC0xMic6ICRyb290LmxheW91dCgpID09IDAsICdjb2wtbWQtMyc6ICRyb290LmxheW91dCgpID09IDF9LCBjb21wb25lbnQ6IHtuYW1lOiAnc3RhdHMtYWRkaXRpb25hbCcsIHBhcmFtczogJGRhdGF9XFxcIj48L2Rpdj5cXG5cXG4gICAgICAgICAgICA8ZGl2IGNsYXNzPVxcXCJzdGF0c2NvbnRhaW5lclxcXCIgZGF0YS1iaW5kPVxcXCJmb3JlYWNoOiAkcm9vdC5hbGxJdGVtc1xcXCI+XFxuICAgICAgICAgICAgICAgIDxkaXYgZGF0YS1iaW5kPVxcXCJjb21wb25lbnQ6IHsgbmFtZTogJGRhdGEudmFsdWUsIHBhcmFtczogJHBhcmVudENvbnRleHQuJGRhdGF9XFxcIj48L2Rpdj5cXG4gICAgICAgICAgICA8L2Rpdj5cXG4gICAgICAgIDwvZGl2PlxcbiAgICA8L2Rpdj5cXG4gICAgPGRpdiBjbGFzcz1cXFwiY29sLW1kLThcXFwiIGRhdGEtYmluZD1cXFwiY3NzOiB7J2NvbC1tZC04JzogJHJvb3QubGF5b3V0KCkgPT0gMCwgJ2NvbC1tZC0xMic6ICRyb290LmxheW91dCgpID09IDF9XFxcIj5cXG4gICAgICAgIDxkaXYgZGF0YS1iaW5kPVxcXCJjb21wb25lbnQ6IHsgbmFtZTogJ2RhbWFnZS1kZXRhaWxzJywgcGFyYW1zOiAkZGF0YX1cXFwiPjwvZGl2PlxcbiAgICBcXG4gICAgICAgIDxkaXYgY2xhc3M9XFxcInJvd1xcXCI+XFxuICAgICAgICAgICAgPGRpdiBjbGFzcz1cXFwiY29sLW1kLTEyXFxcIiBkYXRhLWJpbmQ9XFxcIml0ZW1CdWlsZFRhYmxlOiAkZGF0YS5idWlsZEV4cGxvcmVyXFxcIj5cXG4gICAgICAgICAgICAgICAgPGgzIGNsYXNzPVxcXCJzZWN0aW9uX2hlYWRlclxcXCIgZGF0YS1iaW5kPVxcXCJ0b2dnbGU6IHNlY3Rpb25EaXNwbGF5KCkuaW52ZW50b3J5LCBjc3M6IHsgc2VjdGlvbl9kaXNhYmxlZDogIXNlY3Rpb25EaXNwbGF5KCkuaW52ZW50b3J5KCkgfVxcXCI+SW52ZW50b3J5IDxzbWFsbCBzdHlsZT1cXFwiY29sb3I6Z29sZGVucm9kXFxcIiBkYXRhLWJpbmQ9XFxcImh0bWw6IGludmVudG9yeS50b3RhbENvc3QoKSA/ICc8aW1nIHNyYz1cXFxcJ2h0dHA6Ly9jZG4uZG90YTIuY29tL2FwcHMvZG90YTIvaW1hZ2VzL3Rvb2x0aXBzL2dvbGQucG5nXFxcXCcvPiAnICsgaW52ZW50b3J5LnRvdGFsQ29zdCgpIDogJycgXFxcIj48L3NtYWxsPjwvaDM+XFxuICAgICAgICAgICAgICAgIDxkaXYgaWQ9XFxcImludmVudG9yeVxcXCIgY2xhc3M9XFxcImludmVudG9yeSBob3Zlci1jdXJzb3JcXFwiIGRhdGEtYmluZD1cXFwiY2xpY2s6IGZ1bmN0aW9uIChkYXRhLCBldmVudCkgeyBidWlsZEV4cGxvcmVyLnNlbGVjdEludmVudG9yeSgtMSk7IH0sIGNzczogeydyb3ctaGlnaGxpZ2h0Jzogc2VsZWN0ZWRJbnZlbnRvcnkoKSA9PSAtMX0sIHRlbXBsYXRlOiB7IG5hbWU6ICdpdGVtLXRlbXBsYXRlJywgZm9yZWFjaDogaW52ZW50b3J5Lml0ZW1zIH0sIHZpc2libGU6IHNlY3Rpb25EaXNwbGF5KCkuaW52ZW50b3J5KClcXFwiPjwvZGl2PlxcbiAgICAgICAgICAgIDwvZGl2PlxcbiAgICAgICAgPC9kaXY+XFxuICAgICAgICBcXG4gICAgICAgIDxkaXYgY2xhc3M9XFxcInJvd1xcXCI+XFxuICAgICAgICAgICAgPGRpdiBjbGFzcz1cXFwiY29sLW1kLTEyXFxcIj5cXG4gICAgICAgICAgICAgICAgPGgzIGNsYXNzPVxcXCJzZWN0aW9uX2hlYWRlclxcXCIgZGF0YS1iaW5kPVxcXCJ0b2dnbGU6IHNlY3Rpb25EaXNwbGF5KCkuYWJpbGl0eSwgY3NzOiB7IHNlY3Rpb25fZGlzYWJsZWQ6ICFzZWN0aW9uRGlzcGxheSgpLmFiaWxpdHkoKSB9XFxcIj5BYmlsaXRpZXMgPHNtYWxsIHN0eWxlPVxcXCJjb2xvcjppbmhlcml0XFxcIiBkYXRhLWJpbmQ9XFxcInRleHQ6IGF2YWlsYWJsZVNraWxsUG9pbnRzKCkgPyAoYXZhaWxhYmxlU2tpbGxQb2ludHMoKSA9PSAxID8gJzEgdW5zcGVudCBza2lsbHBvaW50JyA6IGF2YWlsYWJsZVNraWxsUG9pbnRzKCkgKyAnIHVuc3BlbnQgc2tpbGxwb2ludHMnKSA6ICcnXFxcIj48L3NtYWxsPjwvaDM+XFxuICAgICAgICAgICAgICAgIDxkaXYgY2xhc3M9XFxcInJvd1xcXCIgZGF0YS1iaW5kPVxcXCJ2aXNpYmxlOiBzZWN0aW9uRGlzcGxheSgpLmFiaWxpdHkoKSwgZm9yZWFjaDogYWJpbGl0eSgpLmFiaWxpdGllcygpXFxcIj5cXG4gICAgICAgICAgICAgICAgICAgIDxkaXYgZGF0YS1iaW5kPVxcXCJjb21wb25lbnQ6IHsgbmFtZTogJ2FiaWxpdHknLCBwYXJhbXM6ICRkYXRhIH1cXFwiPjwvZGl2PlxcbiAgICAgICAgICAgICAgICA8L2Rpdj5cXG4gICAgICAgICAgICAgICAgPGRpdiBjbGFzcz1cXFwiZm9ybS1ob3Jpem9udGFsXFxcIiBkYXRhLWJpbmQ9XFxcImlmOiBzZWxlY3RlZEhlcm8oKS5oZXJvTmFtZSA9PSAnc2lsZW5jZXInLCB2aXNpYmxlOiBzZWN0aW9uRGlzcGxheSgpLmFiaWxpdHkoKVxcXCI+XFxuICAgICAgICAgICAgICAgICAgICA8ZGl2IGNsYXNzPVxcXCJmb3JtLWdyb3VwXFxcIj5cXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgPGRpdiBjbGFzcz1cXFwiY29sLW1kLTIgY29udHJvbC1sYWJlbFxcXCI+XFxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICA8bGFiZWwgZm9yPVxcXCJpbnRlbGxpZ2VuY2VzdG9sZW5cXFwiPkludGVsbGlnZW5jZSBTdG9sZW48L2xhYmVsPlxcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICA8L2Rpdj5cXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgPGRpdiBjbGFzcz1cXFwiY29sLW1kLTJcXFwiPlxcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgPGlucHV0IGNsYXNzPVxcXCJmb3JtLWNvbnRyb2xcXFwiIGlkPVxcXCJpbnRlbGxpZ2VuY2VzdG9sZW5cXFwiIGRhdGEtYmluZD1cXFwidmFsdWU6IGludFN0b2xlblxcXCIgLz5cXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgPC9kaXY+XFxuICAgICAgICAgICAgICAgICAgICA8L2Rpdj5cXG4gICAgICAgICAgICAgICAgPC9kaXY+XFxuICAgICAgICAgICAgPC9kaXY+XFxuICAgICAgICA8L2Rpdj5cXG5cXG4gICAgICAgIDxkaXYgZGF0YS1iaW5kPVxcXCJjb21wb25lbnQ6IHsgbmFtZTogJ2J1ZmYtc2VjdGlvbicsIHBhcmFtczogJGRhdGF9XFxcIj48L2Rpdj5cXG4gICAgICAgIFxcbiAgICAgICAgPGRpdiBjbGFzcz1cXFwicm93XFxcIiBkYXRhLWJpbmQ9XFxcImNvbXBvbmVudDogeyBuYW1lOiAnZGFtYWdlLWFtcCcsIHBhcmFtczogJGRhdGF9XFxcIj48L2Rpdj5cXG5cXG4gICAgICAgIDxkaXYgY2xhc3M9XFxcInJvd1xcXCI+XFxuICAgICAgICAgICAgPGRpdiBjbGFzcz1cXFwiY29sLW1kLTEyXFxcIj5cXG4gICAgICAgICAgICAgICAgPGgzIGNsYXNzPVxcXCJzZWN0aW9uX2hlYWRlclxcXCIgZGF0YS1iaW5kPVxcXCJ0b2dnbGU6IHNlY3Rpb25EaXNwbGF5KCkuaWxsdXNpb24sIGNzczogeyBzZWN0aW9uX2Rpc2FibGVkOiAhc2VjdGlvbkRpc3BsYXkoKS5pbGx1c2lvbigpIH1cXFwiPklsbHVzaW9uczwvaDM+XFxuICAgICAgICAgICAgICAgIDxkaXYgZGF0YS1iaW5kPVxcXCJ2aXNpYmxlOiBzZWN0aW9uRGlzcGxheSgpLmlsbHVzaW9uKCksIGxhenlCaW5kaW5nOiBzZWN0aW9uRGlzcGxheSgpLmlsbHVzaW9uXFxcIj5cXG4gICAgICAgICAgICAgICAgICAgIDxoNCBzdHlsZT1cXFwiY29sb3I6cmVkXFxcIj5VbmRlciBDb25zdHJ1Y3Rpb248L2g0PlxcbiAgICAgICAgICAgICAgICAgICAgPGRpdiBjbGFzcz1cXFwiZm9ybS1ob3Jpem9udGFsXFxcIj5cXG4gICAgICAgICAgICAgICAgICAgICAgICA8ZGl2IGNsYXNzPVxcXCJmb3JtLWdyb3VwXFxcIj5cXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIDxkaXYgY2xhc3M9XFxcImNvbC1tZC0yIGNvbnRyb2wtbGFiZWxcXFwiPlxcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIDxsYWJlbCBmb3I9XFxcImlsbHVzaW9uU2VsZWN0XFxcIj5UeXBlPC9sYWJlbD5cXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIDwvZGl2PlxcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgPGRpdiBjbGFzcz1cXFwiY29sLW1kLTEwXFxcIj5cXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICA8c2VsZWN0IGlkPVxcXCJpbGx1c2lvblNlbGVjdFxcXCIgY2xhc3M9XFxcImZvcm0tY29udHJvbFxcXCIgZGF0YS1iaW5kPVxcXCJvcHRpb25zOiBhdmFpbGFibGVJbGx1c2lvbnMgLCBvcHRpb25zVGV4dDogJ2lsbHVzaW9uRGlzcGxheU5hbWUnLCB2YWx1ZTogc2VsZWN0ZWRJbGx1c2lvblxcXCI+PC9zZWxlY3Q+XFxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICA8L2Rpdj5cXG4gICAgICAgICAgICAgICAgICAgICAgICA8L2Rpdj5cXG4gICAgICAgICAgICAgICAgICAgICAgICA8ZGl2IGNsYXNzPVxcXCJmb3JtLWdyb3VwXFxcIj5cXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIDxkaXYgY2xhc3M9XFxcImNvbC1tZC0yIGNvbnRyb2wtbGFiZWxcXFwiPlxcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIDxsYWJlbCBmb3I9XFxcImlsbHVzaW9uYWJpbGl0eWxldmVsXFxcIj5BYmlsaXR5IExldmVsPC9sYWJlbD5cXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIDwvZGl2PlxcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgPGRpdiBjbGFzcz1cXFwiY29sLW1kLTEwXFxcIj5cXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICA8c2VsZWN0IGlkPVxcXCJpbGx1c2lvbmFiaWxpdHlsZXZlbFxcXCIgY2xhc3M9XFxcImZvcm0tY29udHJvbFxcXCIgZGF0YS1iaW5kPVxcXCJ2YWx1ZTogaWxsdXNpb25BYmlsaXR5TGV2ZWwsIGZvcmVhY2g6IG5ldyBBcnJheShpbGx1c2lvbkFiaWxpdHlNYXhMZXZlbCgpKVxcXCI+XFxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIDxvcHRpb24gZGF0YS1iaW5kPVxcXCJ0ZXh0OiAkaW5kZXgoKSsxXFxcIj48L29wdGlvbj5cXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICA8L3NlbGVjdD5cXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIDwvZGl2PlxcbiAgICAgICAgICAgICAgICAgICAgICAgIDwvZGl2PlxcbiAgICAgICAgICAgICAgICAgICAgICAgIDxkaXYgY2xhc3M9XFxcImZvcm0tZ3JvdXBcXFwiPlxcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICA8ZGl2IGNsYXNzPVxcXCJjb2wtbWQtb2Zmc2V0LTIgY29sLW1kLTEwXFxcIj5cXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIDxidXR0b24gY2xhc3M9XFxcImJ0biBidG4tZGVmYXVsdFxcXCIgZGF0YS1iaW5kPVxcXCJjbGljazogYWRkSWxsdXNpb25cXFwiPkFkZCBJbGx1c2lvbjwvYnV0dG9uPlxcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICA8L2Rpdj5cXG4gICAgICAgICAgICAgICAgICAgICAgICA8L2Rpdj5cXG4gICAgICAgICAgICAgICAgICAgIDwvZGl2PlxcbiAgICAgICAgICAgICAgICA8L2Rpdj5cXG4gICAgICAgICAgICA8L2Rpdj5cXG4gICAgICAgIDwvZGl2PlxcbiAgICA8L2Rpdj5cXG4gICAgXFxuICAgIDxkaXYgY2xhc3M9XFxcImNvbC1tZC0xMlxcXCI+XFxuICAgICAgICA8aDMgY2xhc3M9XFxcInNlY3Rpb25faGVhZGVyXFxcIiBkYXRhLWJpbmQ9XFxcInRvZ2dsZTogc2VjdGlvbkRpc3BsYXkoKS5za2lsbGJ1aWxkLCBjc3M6IHsgc2VjdGlvbl9kaXNhYmxlZDogIXNlY3Rpb25EaXNwbGF5KCkuc2tpbGxidWlsZCgpIH1cXFwiPkJ1aWxkIEV4cGxvcmVyPC9oMz5cXG4gICAgICAgIDxkaXYgZGF0YS1iaW5kPVxcXCJ2aXNpYmxlOiBzZWN0aW9uRGlzcGxheSgpLnNraWxsYnVpbGQoKSwgYXR0cjoge2lkOiAnc2VjdGlvbi1idWlsZC1leHBsb3Jlci0nICsgaW5kZXgoKSB9LCBsYXp5QmluZGluZzogc2VjdGlvbkRpc3BsYXkoKS5za2lsbGJ1aWxkXFxcIj5cXG4gICAgICAgICAgICA8ZGl2IGNsYXNzPVxcXCJzZWN0aW9uLWNvbnRlbnRcXFwiPiAgICBcXG4gICAgICAgICAgICAgICAgPGRpdiBjbGFzcz1cXFwiY29sLW1kLTEyXFxcIj5cXG4gICAgICAgICAgICAgICAgICAgIDxoNCBjbGFzcz1cXFwic2VjdGlvbl9oZWFkZXJcXFwiIGRhdGEtYmluZD1cXFwidG9nZ2xlOiBzZWN0aW9uRGlzcGxheSgpWydza2lsbGJ1aWxkLXNraWxscyddLCBjc3M6IHsgc2VjdGlvbl9kaXNhYmxlZDogIXNlY3Rpb25EaXNwbGF5KClbJ3NraWxsYnVpbGQtc2tpbGxzJ10oKSB9XFxcIj5Ta2lsbCBCdWlsZCA8c21hbGwgc3R5bGU9XFxcImNvbG9yOmluaGVyaXRcXFwiIGRhdGEtYmluZD1cXFwidGV4dDogYnVpbGRFeHBsb3Jlci5hdmFpbGFibGVTa2lsbEJ1aWxkUG9pbnRzKCkgPyAoYnVpbGRFeHBsb3Jlci5hdmFpbGFibGVTa2lsbEJ1aWxkUG9pbnRzKCkgPT0gMSA/ICcxIHVuc3BlbnQgc2tpbGxwb2ludCcgOiBidWlsZEV4cGxvcmVyLmF2YWlsYWJsZVNraWxsQnVpbGRQb2ludHMoKSArICcgdW5zcGVudCBza2lsbHBvaW50cycpIDogJydcXFwiPjwvc21hbGw+PC9oND5cXG4gICAgICAgICAgICAgICAgICAgICAgICA8ZGl2IGRhdGEtYmluZD1cXFwidmlzaWJsZTogc2VjdGlvbkRpc3BsYXkoKVsnc2tpbGxidWlsZC1za2lsbHMnXVxcXCI+XFxuICAgICAgICAgICAgICAgICAgICAgICAgPHRhYmxlPlxcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICA8dGJvZHkgZGF0YS1iaW5kPVxcXCJ0ZW1wbGF0ZTogeyBuYW1lOiAnYWJpbGl0eS0zLXRlbXBsYXRlJywgZm9yZWFjaDogYWJpbGl0eSgpLmFiaWxpdGllcygpIH1cXFwiPjwvdGJvZHk+XFxuICAgICAgICAgICAgICAgICAgICAgICAgPC90YWJsZT5cXG4gICAgICAgICAgICAgICAgICAgICAgICA8ZGl2IGNsYXNzPVxcXCJmb3JtLWdyb3VwXFxcIj5cXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgPGJ1dHRvbiBjbGFzcz1cXFwiYnRuIGJ0bi1kZWZhdWx0XFxcIiBkYXRhLWJpbmQ9XFxcImNsaWNrOiBidWlsZEV4cGxvcmVyLnJlc2V0U2tpbGxCdWlsZFxcXCI+Q2xlYXI8L2J1dHRvbj5cXG4gICAgICAgICAgICAgICAgICAgICAgICA8L2Rpdj5cXG4gICAgICAgICAgICAgICAgICAgIDwvZGl2PlxcbiAgICAgICAgICAgICAgICA8L2Rpdj5cXG4gICAgICAgICAgICAgICAgPGRpdiBjbGFzcz1cXFwiY29sLW1kLTEyXFxcIj5cXG4gICAgICAgICAgICAgICAgICAgIDxoNCBjbGFzcz1cXFwic2VjdGlvbl9oZWFkZXJcXFwiIGRhdGEtYmluZD1cXFwidG9nZ2xlOiBzZWN0aW9uRGlzcGxheSgpWydza2lsbGJ1aWxkLWl0ZW1zJ10sIGNzczogeyBzZWN0aW9uX2Rpc2FibGVkOiAhc2VjdGlvbkRpc3BsYXkoKVsnc2tpbGxidWlsZC1pdGVtcyddKCkgfVxcXCI+SXRlbSBCdWlsZDwvaDQ+XFxuICAgICAgICAgICAgICAgICAgICA8ZGl2IGRhdGEtYmluZD1cXFwidmlzaWJsZTogc2VjdGlvbkRpc3BsYXkoKVsnc2tpbGxidWlsZC1pdGVtcyddXFxcIj5cXG4gICAgICAgICAgICAgICAgICAgICAgICA8dGFibGUgY2xhc3M9XFxcInRhYmxlXFxcIj5cXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgPHRoZWFkPlxcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgPHRyPlxcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIDx0aD5MZXZlbDwvdGg+XFxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgPHRoIGNsYXNzPVxcXCJ0ZXh0LWNlbnRlclxcXCI+SW52ZW50b3J5PC90aD5cXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICA8dGg+PC90aD5cXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICA8dGg+PC90aD5cXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICA8dGg+PC90aD5cXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIDwvdHI+XFxuICAgICAgICAgICAgICAgICAgICAgICAgICAgIDwvdGhlYWQ+XFxuICAgICAgICAgICAgICAgICAgICAgICAgICAgIDx0Ym9keSBkYXRhLWJpbmQ9XFxcImZvcmVhY2g6IG5ldyBBcnJheSgyNSksIGl0ZW1CdWlsZFRhYmxlOiBidWlsZEV4cGxvcmVyXFxcIj5cXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIDx0ciBjbGFzcz1cXFwiaG92ZXItY3Vyc29yXFxcIiBkYXRhLWJpbmQ9XFxcImNzczogeydyb3ctaGlnaGxpZ2h0JzogJHBhcmVudC5zZWxlY3RlZEludmVudG9yeSgpID09ICRpbmRleCgpfVxcXCI+XFxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgPHRkIGNsYXNzPVxcXCJjYXJyeS1vdmVyXFxcIiBkYXRhLWJpbmQ9XFxcImNsaWNrOiBmdW5jdGlvbiAoZGF0YSwgZXZlbnQpIHsgJHBhcmVudC5idWlsZEV4cGxvcmVyLnNlbGVjdEludmVudG9yeSgkaW5kZXgoKSk7IH1cXFwiPlxcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICA8c3Ryb25nIGRhdGEtYmluZD1cXFwidGV4dDogKCRpbmRleCgpICsgMSlcXFwiPjwvc3Ryb25nPlxcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICA8YSBjbGFzcz1cXFwiYnRuIGJ0bi1kZWZhdWx0IGJ0bi14cyBnbHlwaGljb25cXFwiIGRhdGEtYmluZD1cXFwidmlzaWJsZTogJGluZGV4KCkgPiAwLCB0b2dnbGU6ICRwYXJlbnQuYnVpbGRFeHBsb3Jlci5pdGVtQnVpbGQoKVskaW5kZXgoKV0uY2FycnlPdmVyLCBwcmV2ZW50QnViYmxlOiAnY2xpY2snLCBjc3M6IHsgJ2dseXBoaWNvbi1hcnJvdy1kb3duJzogJHBhcmVudC5idWlsZEV4cGxvcmVyLml0ZW1CdWlsZCgpWyRpbmRleCgpXS5jYXJyeU92ZXIoKSwgJ2dseXBoaWNvbi1zdG9wJzogISRwYXJlbnQuYnVpbGRFeHBsb3Jlci5pdGVtQnVpbGQoKVskaW5kZXgoKV0uY2FycnlPdmVyKCkgfVxcXCIgdGl0bGU9XFxcIkNhcnJ5IG92ZXIgaXRlbXMgdG8gbmV4dCBsZXZlbCdzIGludmVudG9yeVxcXCI+PC9hPlxcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIDwvdGQ+XFxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgPHRkIGNsYXNzPVxcXCJjb2wtbWQtMTBcXFwiIGRhdGEtYmluZD1cXFwiY2xpY2s6IGZ1bmN0aW9uIChkYXRhLCBldmVudCkgeyAkcGFyZW50LmJ1aWxkRXhwbG9yZXIuc2VsZWN0SW52ZW50b3J5KCRpbmRleCgpKTsgfVxcXCI+XFxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIDxkaXYgY2xhc3M9XFxcIml0ZW1CdWlsZC1pbnZlbnRvcnlcXFwiIGRhdGEtYmluZD1cXFwidGVtcGxhdGU6IHsgbmFtZTogJ2l0ZW1CdWlsZC1pdGVtLXRlbXBsYXRlJywgZm9yZWFjaDogJHBhcmVudC5idWlsZEV4cGxvcmVyLml0ZW1CdWlsZCgpWyRpbmRleCgpXS5pdGVtcyB9XFxcIj48L2Rpdj5cXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICA8L3RkPlxcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIDx0ZD5cXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgPGEgY2xhc3M9XFxcImJ0biBidG4tZGVmYXVsdCBidG4teHNcXFwiIGRhdGEtYmluZD1cXFwiY2xpY2s6IGZ1bmN0aW9uIChkYXRhLCBldmVudCkgeyAkcGFyZW50LmJ1aWxkRXhwbG9yZXIuY29weUludmVudG9yeVRvQ2xpcEJvYXJkKCRpbmRleCgpKTsgfVxcXCIgdGl0bGU9XFxcIkNvcHkgaXRlbXNcXFwiPkNvcHk8L2E+XFxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgPC90ZD5cXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICA8dGQ+XFxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIDxhIGNsYXNzPVxcXCJidG4gYnRuLWRlZmF1bHQgYnRuLXhzXFxcIiBkYXRhLWJpbmQ9XFxcImNsaWNrOiBmdW5jdGlvbiAoZGF0YSwgZXZlbnQpIHsgJHBhcmVudC5idWlsZEV4cGxvcmVyLnBhc3RlSW52ZW50b3J5RnJvbUNsaXBCb2FyZCgkaW5kZXgoKSk7IH1cXFwiIHRpdGxlPVxcXCJQYXN0ZSBpdGVtc1xcXCI+UGFzdGU8L2E+XFxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgPC90ZD5cXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICA8dGQ+XFxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIDxhIGNsYXNzPVxcXCJidG4gYnRuLWRlZmF1bHQgYnRuLXhzXFxcIiBkYXRhLWJpbmQ9XFxcImNsaWNrOiBmdW5jdGlvbiAoZGF0YSwgZXZlbnQpIHsgJHBhcmVudC5idWlsZEV4cGxvcmVyLnJlc2V0SXRlbUJ1aWxkKCRpbmRleCgpKTsgfVxcXCIgdGl0bGU9XFxcIkNsZWFyIGludmVudG9yeVxcXCI+Q2xlYXI8L2E+XFxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgPC90ZD5cXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIDwvdHI+XFxuICAgICAgICAgICAgICAgICAgICAgICAgICAgIDwvdGJvZHk+XFxuICAgICAgICAgICAgICAgICAgICAgICAgPC90YWJsZT5cXG4gICAgICAgICAgICAgICAgICAgICAgICA8ZGl2IGNsYXNzPVxcXCJmb3JtLWdyb3VwXFxcIj5cXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgPGJ1dHRvbiBjbGFzcz1cXFwiYnRuIGJ0bi1kZWZhdWx0XFxcIiBkYXRhLWJpbmQ9XFxcImNsaWNrOiBidWlsZEV4cGxvcmVyLnJlc2V0QWxsSXRlbUJ1aWxkc1xcXCI+Q2xlYXI8L2J1dHRvbj5cXG4gICAgICAgICAgICAgICAgICAgICAgICA8L2Rpdj5cXG4gICAgICAgICAgICAgICAgICAgIDwvZGl2PlxcbiAgICAgICAgICAgICAgICA8L2Rpdj5cXG4gICAgICAgICAgICAgICAgPGRpdiBjbGFzcz1cXFwiZm9ybS1ncm91cFxcXCI+XFxuICAgICAgICAgICAgICAgICAgICA8bGFiZWw+RGF0YSBzZXQgaGVhZGVyIGxhYmVsPC9sYWJlbD5cXG4gICAgICAgICAgICAgICAgICAgIDxpbnB1dCB0eXBlPVxcXCJ0ZXh0XFxcIiBjbGFzcz1cXFwiZm9ybS1jb250cm9sXFxcIiBkYXRhLWJpbmQ9XFxcInZhbHVlOiBidWlsZEV4cGxvcmVyLmdyYXBoRGF0YUhlYWRlclxcXCI+XFxuICAgICAgICAgICAgICAgIDwvZGl2PlxcbiAgICAgICAgICAgICAgICA8ZGl2IGNsYXNzPVxcXCJmb3JtLWdyb3VwXFxcIj5cXG4gICAgICAgICAgICAgICAgICAgIDxsYWJlbD5EYXRhIHNldCBkZXNjcmlwdGlvbjwvbGFiZWw+XFxuICAgICAgICAgICAgICAgICAgICA8aW5wdXQgdHlwZT1cXFwidGV4dFxcXCIgY2xhc3M9XFxcImZvcm0tY29udHJvbFxcXCIgZGF0YS1iaW5kPVxcXCJ2YWx1ZTogYnVpbGRFeHBsb3Jlci5ncmFwaERhdGFEZXNjcmlwdGlvblxcXCI+XFxuICAgICAgICAgICAgICAgIDwvZGl2PlxcbiAgICAgICAgICAgICAgICA8ZGl2IGNsYXNzPVxcXCJmb3JtLWdyb3VwXFxcIj5cXG4gICAgICAgICAgICAgICAgICAgIDxidXR0b24gY2xhc3M9XFxcImJ0biBidG4tZGVmYXVsdFxcXCIgZGF0YS1iaW5kPVxcXCJjbGljazogYnVpbGRFeHBsb3Jlci5ncmFwaFxcXCI+QWRkIGRhdGEgc2V0PC9idXR0b24+XFxuICAgICAgICAgICAgICAgIDwvZGl2PlxcbiAgICAgICAgICAgICAgICA8ZGl2IGNsYXNzPVxcXCJmb3JtLWdyb3VwXFxcIj5cXG4gICAgICAgICAgICAgICAgICAgIDxsYWJlbD5IZXJvIFByb3BlcnR5PC9sYWJlbD5cXG4gICAgICAgICAgICAgICAgICAgIDxzZWxlY3QgY2xhc3M9XFxcImZvcm0tY29udHJvbFxcXCIgZGF0YS1iaW5kPVxcXCJvcHRpb25zOiBidWlsZEV4cGxvcmVyLmdyYXBoUHJvcGVydGllcywgb3B0aW9uc1RleHQ6ICdsYWJlbCcsIG9wdGlvbnNWYWx1ZTogJ2lkJywgdmFsdWU6IGJ1aWxkRXhwbG9yZXIuc2VsZWN0ZWRHcmFwaFByb3BlcnR5XFxcIj48L3NlbGVjdD5cXG4gICAgICAgICAgICAgICAgPC9kaXY+XFxuICAgICAgICAgICAgICAgIDwhLS0ga28gaWY6IGJ1aWxkRXhwbG9yZXIuZ3JhcGhEYXRhKCkubGVuZ3RoID4gMCAtLT5cXG4gICAgICAgICAgICAgICAgPGRpdiBjbGFzcz1cXFwiZm9ybS1ncm91cFxcXCIgZGF0YS1iaW5kPVxcXCJjaGFydDogYnVpbGRFeHBsb3Jlci5ncmFwaENoYXJ0RGF0YSwgY2hhcnRUeXBlOiAnU2NhdHRlcicsIGNoYXJ0T3B0aW9uczogYnVpbGRFeHBsb3Jlci5ncmFwaENoYXJ0T3B0aW9ucygpLCBjaGFydENvbnRleHQ6IGJ1aWxkRXhwbG9yZXIuZ3JhcGhDaGFydENvbnRleHRcXFwiPjwvZGl2PlxcbiAgICAgICAgICAgICAgICA8ZGl2IGNsYXNzPVxcXCJmb3JtLWdyb3VwXFxcIj5cXG4gICAgICAgICAgICAgICAgICA8YnV0dG9uIGNsYXNzPVxcXCJidG4gYnRuLWRlZmF1bHRcXFwiIGRhdGEtYmluZD1cXFwiY2xpY2s6IGJ1aWxkRXhwbG9yZXIuZXhwb3J0SW1hZ2VcXFwiPjxzcGFuIGNsYXNzPVxcXCJnbHlwaGljb24gZ2x5cGhpY29uLWV4cG9ydFxcXCI+PC9zcGFuPiBFeHBvcnQgSW1hZ2U8L2J1dHRvbj5cXG4gICAgICAgICAgICAgICAgPC9kaXY+XFxuICAgICAgICAgICAgICAgIDxidXR0b24gY2xhc3M9XFxcImJ0biBidG4tZGVmYXVsdCBidG4teHNcXFwiIGRhdGEtYmluZD1cXFwidG9nZ2xlOiBidWlsZEV4cGxvcmVyLnNob3dHcmFwaEl0ZW1CdWlsZFJvd3MsIGNzczogeyd0b2dnbGVkJzogYnVpbGRFeHBsb3Jlci5zaG93R3JhcGhJdGVtQnVpbGRSb3dzfVxcXCI+U2hvdyBpdGVtIGJ1aWxkIHJvd3M8L2J1dHRvbj5cXG4gICAgICAgICAgICAgICAgPGJ1dHRvbiBjbGFzcz1cXFwiYnRuIGJ0bi1kZWZhdWx0IGJ0bi14c1xcXCIgZGF0YS1iaW5kPVxcXCJ0b2dnbGU6IGJ1aWxkRXhwbG9yZXIuc2hvd0dyYXBoU2tpbGxCdWlsZENvbHVtbnMsIGNzczogeyd0b2dnbGVkJzogYnVpbGRFeHBsb3Jlci5zaG93R3JhcGhTa2lsbEJ1aWxkQ29sdW1uc31cXFwiPlNob3cgc2tpbGwgYnVpbGQgY29sdW1uczwvYnV0dG9uPlxcbiAgICAgICAgICAgICAgICA8dGFibGUgY2xhc3M9XFxcInRhYmxlIGJ1aWxkLXRhYmxlXFxcIj5cXG4gICAgICAgICAgICAgICAgICAgIDx0aGVhZD5cXG4gICAgICAgICAgICAgICAgICAgICAgICA8dHI+XFxuICAgICAgICAgICAgICAgICAgICAgICAgICAgIDx0aCBjbGFzcz1cXFwicmlnaHQtYm9yZGVyXFxcIj5MZXZlbDwvdGg+XFxuICAgICAgICAgICAgICAgICAgICAgICAgICAgIDwhLS0ga28gZm9yZWFjaDogYnVpbGRFeHBsb3Jlci5ncmFwaERhdGEgLS0+XFxuICAgICAgICAgICAgICAgICAgICAgICAgICAgIDx0aCBjbGFzcz1cXFwidGV4dC1jZW50ZXJcXFwiIGRhdGEtYmluZD1cXFwiY3NzOiB7ICdyaWdodC1ib3JkZXInOiAhJHBhcmVudC5idWlsZEV4cGxvcmVyLnNob3dHcmFwaFNraWxsQnVpbGRDb2x1bW5zKCkgfHwgISRkYXRhLnZpc2libGUoKSB9XFxcIj5cXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIDxzcGFuIGRhdGEtYmluZD1cXFwiY3NzOiB7ICd0b29sdGlwLXVuZGVybGluZSc6ICRkYXRhLmRlc2NyaXB0aW9uIH0sIHRvb2x0aXA6IHt0aXRsZTogJGRhdGEuZGVzY3JpcHRpb24sIHBsYWNlbWVudDogJ2JvdHRvbSd9LCB2aXNpYmxlOiAkZGF0YS52aXNpYmxlKCksIHRleHQ6ICRkYXRhLmhlYWRlciwgc3R5bGU6IHsgY29sb3I6ICRwYXJlbnQuYnVpbGRFeHBsb3Jlci5ncmFwaERpc3RpbmN0Q29sb3IoJHBhcmVudC5idWlsZEV4cGxvcmVyLmdyYXBoRGF0YSgpLmxlbmd0aCwgJGluZGV4KCksIDEpIH1cXFwiPjwvc3Bhbj5cXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIDxzcGFuIGNsYXNzPVxcXCJidG4gYnRuLXhzIGdseXBoaWNvbiBnbHlwaGljb24taW5mby1zaWduXFxcIiBkYXRhLWJpbmQ9XFxcInZpc2libGU6ICRkYXRhLnZpc2libGUoKSwgcG9wb3Zlcjoge3RlbXBsYXRlOiAncG9wb3Zlci1ncmFwaERhdGEtdGVtcGxhdGUnLCBkYXRhOiAkZGF0YSwgb3B0aW9uczoge30gfVxcXCI+PC9zcGFuPlxcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgPGJ1dHRvbiBjbGFzcz1cXFwiYnRuIGJ0bi1kZWZhdWx0IGJ0bi14cyBzaG9wLWJ1dHRvbiBnbHlwaGljb24gZ2x5cGhpY29uLXJlbW92ZSBwdWxsLXJpZ2h0XFxcIiBjbGFzcz1cXFwiY2xvc2VcXFwiIGRhdGEtYmluZD1cXFwidmlzaWJsZTogISRwYXJlbnQuYnVpbGRFeHBsb3Jlci5zaG93R3JhcGhTa2lsbEJ1aWxkQ29sdW1ucygpIHx8ICEkZGF0YS52aXNpYmxlKCksIGNsaWNrOiBmdW5jdGlvbihkYXRhLCBldmVudCkgeyAkcGFyZW50LmJ1aWxkRXhwbG9yZXIucmVtb3ZlR3JhcGhEYXRhU2V0KCRkYXRhKTsgfVxcXCI+PC9idXR0b24+XFxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICA8YnV0dG9uIGNsYXNzPVxcXCJidG4gYnRuLWRlZmF1bHQgYnRuLXhzIHNob3AtYnV0dG9uIGdseXBoaWNvbiBwdWxsLXJpZ2h0XFxcIiBkYXRhLWJpbmQ9XFxcInZpc2libGU6ICEkcGFyZW50LmJ1aWxkRXhwbG9yZXIuc2hvd0dyYXBoU2tpbGxCdWlsZENvbHVtbnMoKSB8fCAhJGRhdGEudmlzaWJsZSgpLCB0b2dnbGU6ICRkYXRhLnZpc2libGUsIGNzczogeyAnZ2x5cGhpY29uLW1pbnVzJzogJGRhdGEudmlzaWJsZSgpLCAnZ2x5cGhpY29uLXBsdXMnOiAhJGRhdGEudmlzaWJsZSgpfVxcXCI+PC9idXR0b24+XFxuICAgICAgICAgICAgICAgICAgICAgICAgICAgIDwvdGg+XFxuICAgICAgICAgICAgICAgICAgICAgICAgICAgIDx0aCBjbGFzcz1cXFwidGV4dC1sZWZ0IHJpZ2h0LWJvcmRlclxcXCIgZGF0YS1iaW5kPVxcXCJ2aXNpYmxlOiAkZGF0YS52aXNpYmxlKCkgJiYgJHBhcmVudC5idWlsZEV4cGxvcmVyLnNob3dHcmFwaFNraWxsQnVpbGRDb2x1bW5zKClcXFwiPjxhYmJyIHRpdGxlPVxcXCJRLVctRS1SLVN0YXRzXFxcIj5Ta2lsbCBCdWlsZDwvYWJicj5cXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIDxidXR0b24gY2xhc3M9XFxcImJ0biBidG4tZGVmYXVsdCBidG4teHMgc2hvcC1idXR0b24gZ2x5cGhpY29uIGdseXBoaWNvbi1yZW1vdmUgcHVsbC1yaWdodFxcXCIgY2xhc3M9XFxcImNsb3NlXFxcIiBkYXRhLWJpbmQ9XFxcInZpc2libGU6ICRwYXJlbnQuYnVpbGRFeHBsb3Jlci5zaG93R3JhcGhTa2lsbEJ1aWxkQ29sdW1ucygpLCBjbGljazogZnVuY3Rpb24oZGF0YSwgZXZlbnQpIHsgJHBhcmVudC5idWlsZEV4cGxvcmVyLnJlbW92ZUdyYXBoRGF0YVNldCgkZGF0YSk7IH1cXFwiPjwvYnV0dG9uPlxcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgPGJ1dHRvbiBjbGFzcz1cXFwiYnRuIGJ0bi1kZWZhdWx0IGJ0bi14cyBzaG9wLWJ1dHRvbiBnbHlwaGljb24gcHVsbC1yaWdodFxcXCIgZGF0YS1iaW5kPVxcXCJ2aXNpYmxlOiAkcGFyZW50LmJ1aWxkRXhwbG9yZXIuc2hvd0dyYXBoU2tpbGxCdWlsZENvbHVtbnMoKSwgdG9nZ2xlOiAkZGF0YS52aXNpYmxlLCBjc3M6IHsgJ2dseXBoaWNvbi1taW51cyc6ICRkYXRhLnZpc2libGUoKSwgJ2dseXBoaWNvbi1wbHVzJzogISRkYXRhLnZpc2libGUoKX1cXFwiPjwvYnV0dG9uPlxcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICA8L3RoPlxcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICA8IS0tIC9rbyAtLT5cXG4gICAgICAgICAgICAgICAgICAgICAgICA8L3RyPlxcbiAgICAgICAgICAgICAgICAgICAgPC90aGVhZD5cXG4gICAgICAgICAgICAgICAgICAgIDx0Ym9keSBkYXRhLWJpbmQ9XFxcImZvcmVhY2g6IG5ldyBBcnJheShidWlsZEV4cGxvcmVyLmdyYXBoRGF0YSgpWzBdLmRhdGEubGVuZ3RoKVxcXCI+XFxuICAgICAgICAgICAgICAgICAgICAgICAgPHRyPlxcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICA8dGQgY2xhc3M9XFxcInJpZ2h0LWJvcmRlclxcXCI+XFxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICA8c3Ryb25nIGRhdGEtYmluZD1cXFwidGV4dDogKCRpbmRleCgpICsgMSlcXFwiPjwvc3Ryb25nPlxcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICA8L3RkPlxcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICA8IS0tIGtvIGZvcmVhY2g6IG5ldyBBcnJheSgkcGFyZW50LmJ1aWxkRXhwbG9yZXIuZ3JhcGhEYXRhKCkubGVuZ3RoKSAtLT5cXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgPHRkIGNsYXNzPVxcXCJ0ZXh0LXJpZ2h0XFxcIiBkYXRhLWJpbmQ9XFxcImNzczogeyAncmlnaHQtYm9yZGVyJzogISRwYXJlbnRzWzFdLmJ1aWxkRXhwbG9yZXIuc2hvd0dyYXBoU2tpbGxCdWlsZENvbHVtbnMoKSB8fCAhJHBhcmVudHNbMV0uYnVpbGRFeHBsb3Jlci5ncmFwaERhdGEoKVskaW5kZXgoKV0udmlzaWJsZSgpIH1cXFwiPlxcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgPHNwYW4gZGF0YS1iaW5kPVxcXCJ2aXNpYmxlOiAkcGFyZW50c1sxXS5idWlsZEV4cGxvcmVyLmdyYXBoRGF0YSgpWyRpbmRleCgpXS52aXNpYmxlKCksIHRleHQ6ICRwYXJlbnRzWzFdLmJ1aWxkRXhwbG9yZXIuZ3JhcGhEYXRhKClbJGluZGV4KCldLmRhdGFbJHBhcmVudENvbnRleHQuJGluZGV4KCldWyRwYXJlbnRzWzFdLmJ1aWxkRXhwbG9yZXIuc2VsZWN0ZWRHcmFwaFByb3BlcnR5KCldXFxcIj48L3NwYW4+XFxuICAgICAgICAgICAgICAgICAgICAgICAgICAgIDwvdGQ+XFxuICAgICAgICAgICAgICAgICAgICAgICAgICAgIDx0ZCBjbGFzcz1cXFwidGV4dC1sZWZ0IHJpZ2h0LWJvcmRlclxcXCIgZGF0YS1iaW5kPVxcXCJ2aXNpYmxlOiAkcGFyZW50c1sxXS5idWlsZEV4cGxvcmVyLmdyYXBoRGF0YSgpWyRpbmRleCgpXS52aXNpYmxlKCkgJiYgJHBhcmVudHNbMV0uYnVpbGRFeHBsb3Jlci5zaG93R3JhcGhTa2lsbEJ1aWxkQ29sdW1ucygpLCB0ZXh0OiAkcGFyZW50c1sxXS5idWlsZEV4cGxvcmVyLmdyYXBoRGF0YSgpWyRpbmRleCgpXS5jdW11bGF0aXZlU2tpbGxCdWlsZFskcGFyZW50Q29udGV4dC4kaW5kZXgoKV0uam9pbignLScpXFxcIj48L3RkPlxcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICA8IS0tIC9rbyAtLT5cXG4gICAgICAgICAgICAgICAgICAgICAgICA8L3RyPlxcbiAgICAgICAgICAgICAgICAgICAgICAgIDx0ciBjbGFzcz1cXFwiaXRlbUJ1aWxkLWludmVudG9yeVxcXCIgZGF0YS1iaW5kPVxcXCJ2aXNpYmxlOiAkcGFyZW50LmJ1aWxkRXhwbG9yZXIuc2hvd0dyYXBoSXRlbUJ1aWxkUm93cygpICYmICRwYXJlbnQuYnVpbGRFeHBsb3Jlci5ncmFwaFJvd0hhc0l0ZW1zKCRpbmRleCgpKVxcXCI+XFxuICAgICAgICAgICAgICAgICAgICAgICAgICAgIDx0ZCBjbGFzcz1cXFwicmlnaHQtYm9yZGVyLWl0ZW1yb3cgbm8tdG9wLWJvcmRlclxcXCI+PC90ZD5cXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgPCEtLSBrbyBmb3JlYWNoOiBuZXcgQXJyYXkoJHBhcmVudC5idWlsZEV4cGxvcmVyLmdyYXBoRGF0YSgpLmxlbmd0aCkgLS0+XFxuICAgICAgICAgICAgICAgICAgICAgICAgICAgIDx0ZCBjbGFzcz1cXFwicmlnaHQtYm9yZGVyLWl0ZW1yb3cgbm8tdG9wLWJvcmRlclxcXCIgZGF0YS1iaW5kPVxcXCJhdHRyOiB7IGNvbHNwYW46ICRwYXJlbnRzWzFdLmJ1aWxkRXhwbG9yZXIuZ3JhcGhEYXRhKClbJGluZGV4KCldLnZpc2libGUoKSAmJiAkcGFyZW50c1sxXS5idWlsZEV4cGxvcmVyLnNob3dHcmFwaFNraWxsQnVpbGRDb2x1bW5zKCkgPyAyIDogMSB9XFxcIj5cXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIDxkaXYgZGF0YS1iaW5kPVxcXCJ2aXNpYmxlOiAkcGFyZW50c1sxXS5idWlsZEV4cGxvcmVyLmdyYXBoRGF0YSgpWyRpbmRleCgpXS52aXNpYmxlKCksIGZvcmVhY2g6ICRwYXJlbnRzWzFdLmJ1aWxkRXhwbG9yZXIuZ3JhcGhEYXRhKClbJGluZGV4KCldLmRhdGFbJHBhcmVudENvbnRleHQuJGluZGV4KCldLml0ZW1zXFxcIj5cXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICA8aW1nIGNsYXNzPVxcXCJpdGVtQnVpbGQtaW1nLXNtIGltZy1yb3VuZGVkXFxcIiBkYXRhLWJpbmQ9XFxcImNzczogeyBpdGVtX2Rpc2FibGVkOiAhZW5hYmxlZCwgaXRlbV9hY3RpdmU6ICRwYXJlbnRzWzJdLmludmVudG9yeS5nZXRBY3RpdmVCb3JkZXIoJGRhdGEpID09IDEsIGl0ZW1faW5hY3RpdmU6ICRwYXJlbnRzWzJdLmludmVudG9yeS5nZXRBY3RpdmVCb3JkZXIoJGRhdGEpID09IDAgfSwgYXR0cjp7IHNyYzogJHBhcmVudHNbMl0uaW52ZW50b3J5LmdldEl0ZW1JbWFnZSgkZGF0YSkgfVxcXCIvPlxcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIDxkaXYgc3R5bGU9XFxcImZsb2F0OmxlZnRcXFwiIGRhdGEtYmluZD1cXFwidmlzaWJsZTogJHBhcmVudHNbMl0uaW52ZW50b3J5LmdldEl0ZW1TaXplTGFiZWwoJGRhdGEpICE9ICcnXFxcIj5cXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgPGRpdiBkYXRhLWJpbmQ9XFxcImh0bWw6ICRwYXJlbnRzWzJdLmludmVudG9yeS5nZXRJdGVtU2l6ZUxhYmVsKCRkYXRhKVxcXCIgc3R5bGU9XFxcInBvc2l0aW9uOmFic29sdXRlO2xlZnQ6MDtib3R0b206MDtjb2xvcjp3aGl0ZTtvcGFjaXR5Oi41O2JhY2tncm91bmQtY29sb3I6YmxhY2s7cGFkZGluZzowcHggMnB4XFxcIj48L2Rpdj5cXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgPGRpdiBkYXRhLWJpbmQ9XFxcImh0bWw6ICRwYXJlbnRzWzJdLmludmVudG9yeS5nZXRJdGVtU2l6ZUxhYmVsKCRkYXRhKVxcXCIgc3R5bGU9XFxcInBvc2l0aW9uOmFic29sdXRlO2xlZnQ6MDtib3R0b206MDtjb2xvcjp3aGl0ZTtwYWRkaW5nOjBweCAycHhcXFwiPjwvZGl2PlxcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIDwvZGl2PlxcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgPC9kaXY+XFxuICAgICAgICAgICAgICAgICAgICAgICAgICAgIDwvdGQ+XFxuICAgICAgICAgICAgICAgICAgICAgICAgICAgIDwhLS0gL2tvIC0tPlxcbiAgICAgICAgICAgICAgICAgICAgICAgIDwvdHI+XFxuICAgICAgICAgICAgICAgICAgICA8L3Rib2R5PlxcbiAgICAgICAgICAgICAgICA8L3RhYmxlPlxcbiAgICAgICAgICAgICAgICA8IS0tIC9rbyAtLT5cXG4gICAgICAgICAgICA8L2Rpdj5cXG4gICAgICAgIDwvZGl2PlxcbiAgICA8L2Rpdj5cXG5cXG48L2Rpdj5cIiB9KTtcbmtvLmNvbXBvbmVudHMucmVnaXN0ZXIoJ3VuaXQtcGFuZScsIHsgdGVtcGxhdGU6IFwiPGRpdiBjbGFzcz1cXFwicm93XFxcIj5cXG4gICAgPGRpdiBjbGFzcz1cXFwiY29sLW1kLTRcXFwiPlxcbiAgICAgICAgPGltZyBjbGFzcz1cXFwiaW1nLXJvdW5kZWRcXFwiIGRhdGEtYmluZD1cXFwiYXR0cjp7c3JjOiBzZWxlY3RlZFVuaXQoKS5pbWFnZX1cXFwiLz5cXG4gICAgPC9kaXY+XFxuICAgIDxkaXYgY2xhc3M9XFxcImNvbC1tZC00XFxcIj5cXG4gICAgICAgIDxsYWJlbCBmb3I9XFxcInVuaXRzZWxlY3RcXFwiPlVuaXQ8L2xhYmVsPlxcbiAgICAgICAgPHNlbGVjdCBpZD1cXFwidW5pdHNlbGVjdFxcXCIgY2xhc3M9XFxcImZvcm0tY29udHJvbFxcXCIgZGF0YS1iaW5kPVxcXCJvcHRpb25zOiBhdmFpbGFibGVVbml0cyAsIG9wdGlvbnNUZXh0OiAnaGVyb0Rpc3BsYXlOYW1lJywgdmFsdWU6IHNlbGVjdGVkVW5pdFxcXCI+PC9zZWxlY3Q+XFxuICAgIDwvZGl2PlxcbiAgICA8ZGl2IGNsYXNzPVxcXCJjb2wtbWQtNFxcXCI+XFxuICAgICAgICA8bGFiZWwgZm9yPVxcXCJ1bml0bGV2ZWxcXFwiPkxldmVsPC9sYWJlbD5cXG4gICAgICAgIDxwIGNsYXNzPVxcXCJmb3JtLWNvbnRyb2wtc3RhdGljXFxcIiBkYXRhLWJpbmQ9XFxcInZpc2libGU6IHNlbGVjdGVkVW5pdCgpLmxldmVscyA9PSAwLCB0ZXh0OiBoZXJvKCkubGV2ZWxcXFwiPjwvcD5cXG4gICAgICAgIDxzZWxlY3QgaWQ9XFxcImhlcm9sZXZlbFxcXCIgY2xhc3M9XFxcImZvcm0tY29udHJvbFxcXCIgZGF0YS1iaW5kPVxcXCJ2aXNpYmxlOiBzZWxlY3RlZFVuaXQoKS5sZXZlbHMgPiAwLCB2YWx1ZTogc2VsZWN0ZWRVbml0TGV2ZWwsIGZvcmVhY2g6IG5ldyBBcnJheShzZWxlY3RlZFVuaXQoKS5sZXZlbHMpXFxcIj5cXG4gICAgICAgICAgICA8b3B0aW9uIGRhdGEtYmluZD1cXFwidGV4dDogJGluZGV4KCkrMVxcXCI+PC9vcHRpb24+XFxuICAgICAgICA8L3NlbGVjdD5cXG4gICAgPC9kaXY+XFxuPC9kaXY+XFxuXFxuPGRpdiBjbGFzcz1cXFwicm93XFxcIj5cXG4gICAgPGRpdiBjbGFzcz1cXFwiY29sLW1kLTRcXFwiIGRhdGEtYmluZD1cXFwiY3NzOiB7J2NvbC1tZC00JzogJHJvb3QubGF5b3V0KCkgPT0gMCwgJ2NvbC1tZC0xMic6ICRyb290LmxheW91dCgpID09IDF9XFxcIj5cXG4gICAgICAgIDxkaXYgY2xhc3M9XFxcInJvd1xcXCI+XFxuICAgICAgICAgICAgPGgzIGNsYXNzPVxcXCJjb2wtbWQtMTJcXFwiPlN0YXRzIDxhIGNsYXNzPVxcXCJidG4gYnRuLWRlZmF1bHQgYnRuLXhzXFxcIiBkYXRhLWJpbmQ9XFxcInRvZ2dsZTogc2hvd1N0YXREZXRhaWxzLCB0ZXh0OiAhc2hvd1N0YXREZXRhaWxzKCkgPyAnU2hvdyBtb3JlJyA6ICdTaG93IGxlc3MnLCBhdHRyOiB7dGl0bGU6ICFzaG93U3RhdERldGFpbHMoKSA/ICdDbGljayB0byBzaG93IGJhc2Ugc3RhdHMnIDogJ0NsaWNrIHRvIGhpZGUgYmFzZSBzdGF0cyd9XFxcIj48L2E+PC9oMz5cXG5cXG4gICAgICAgICAgICA8ZGl2IGNsYXNzPVxcXCJjb2wtbWQtM1xcXCIgZGF0YS1iaW5kPVxcXCJ2aXNpYmxlOiBzaG93U3RhdERldGFpbHMoKSwgY29tcG9uZW50OiB7bmFtZTogJ3N0YXRzLWFkZGl0aW9uYWwnLCBwYXJhbXM6ICRkYXRhfVxcXCI+PC9kaXY+XFxuICAgICAgICAgICAgXFxuICAgICAgICAgICAgPGRpdiBjbGFzcz1cXFwiY29sLW1kLTEyXFxcIiBkYXRhLWJpbmQ9XFxcImNzczogeydjb2wtbWQtMTInOiAkcm9vdC5sYXlvdXQoKSA9PSAwLCAnY29sLW1kLTMnOiAkcm9vdC5sYXlvdXQoKSA9PSAxfVxcXCI+XFxuICAgICAgICAgICAgICAgIDx0YWJsZSBjbGFzcz1cXFwidGFibGUgdGFibGUtY29uZGVuc2VkXFxcIj5cXG4gICAgICAgICAgICAgICAgPHRib2R5PlxcbiAgICAgICAgICAgICAgICA8dHI+PHRkPkdvbGQ6PC90ZD48dGQgY2xhc3M9XFxcInRleHQtcmlnaHRcXFwiPjxzcGFuIGRhdGEtYmluZD1cXFwidGV4dDogaGVybygpLmJvdW50eWdvbGRtaW4oKSA9PSBoZXJvKCkuYm91bnR5Z29sZG1heCgpID8gaGVybygpLmJvdW50eWdvbGRtYXgoKSA6IGhlcm8oKS5ib3VudHlnb2xkbWluKCkgKyAnLScgKyBoZXJvKCkuYm91bnR5Z29sZG1heCgpXFxcIj48L3NwYW4+PC90ZD48L3RyPlxcbiAgICAgICAgICAgICAgICA8dHI+PHRkPkV4cGVyaWVuY2U6PC90ZD48dGQgY2xhc3M9XFxcInRleHQtcmlnaHRcXFwiPjxzcGFuIGRhdGEtYmluZD1cXFwidGV4dDogaGVybygpLmJvdW50eXhwKClcXFwiPjwvc3Bhbj48L3RkPjwvdHI+XFxuICAgICAgICAgICAgICAgIDx0cj48dGQ+TGV2ZWw6PC90ZD48dGQgY2xhc3M9XFxcInRleHQtcmlnaHRcXFwiPjxzcGFuIGRhdGEtYmluZD1cXFwidGV4dDogaGVybygpLmxldmVsKClcXFwiPjwvc3Bhbj48L3RkPjwvdHI+XFxuICAgICAgICAgICAgICAgIDx0cj48dGQ+PGFiYnIgdGl0bGU9XFxcIk1vdmVtZW50IFNwZWVkXFxcIj5NUzwvYWJicj46PC90ZD48dGQgY2xhc3M9XFxcInRleHQtcmlnaHRcXFwiPjxzcGFuIGRhdGEtYmluZD1cXFwidGV4dDogdG90YWxNb3ZlbWVudFNwZWVkXFxcIj48L3NwYW4+PC90ZD48L3RyPlxcbiAgICAgICAgICAgICAgICA8dHI+PHRkPlR1cm4gUmF0ZTo8L3RkPjx0ZCBjbGFzcz1cXFwidGV4dC1yaWdodFxcXCI+PHNwYW4gZGF0YS1iaW5kPVxcXCJ0ZXh0OiB0b3RhbFR1cm5SYXRlXFxcIj48L3NwYW4+PC90ZD48L3RyPlxcbiAgICAgICAgICAgICAgICA8dHI+PHRkPlNpZ2h0IFJhbmdlOjwvdGQ+PHRkIGNsYXNzPVxcXCJ0ZXh0LXJpZ2h0XFxcIj48c3BhbiBkYXRhLWJpbmQ9XFxcImh0bWw6ICc8YWJiciB0aXRsZT1cXFxcJ0RheVxcXFwnPicgKyB2aXNpb25yYW5nZWRheSgpICsgJzwvYWJicj4vPGFiYnIgdGl0bGU9XFxcXCdOaWdodFxcXFwnPicgKyB2aXNpb25yYW5nZW5pZ2h0KCkgKyAnPC9hYmJyPidcXFwiPjwvc3Bhbj48L3RkPjwvdHI+XFxuICAgICAgICAgICAgICAgIDwvdGJvZHk+XFxuICAgICAgICAgICAgICAgIDwvdGFibGU+XFxuICAgICAgICAgICAgPC9kaXY+XFxuXFxuXFxuICAgICAgICAgICAgPGRpdiBjbGFzcz1cXFwiY29sLW1kLTEyXFxcIiBkYXRhLWJpbmQ9XFxcImNzczogeydjb2wtbWQtMTInOiAkcm9vdC5sYXlvdXQoKSA9PSAwLCAnY29sLW1kLTMnOiAkcm9vdC5sYXlvdXQoKSA9PSAxfVxcXCI+XFxuICAgICAgICAgICAgICAgIDx0YWJsZSBjbGFzcz1cXFwidGFibGUgdGFibGUtY29uZGVuc2VkXFxcIj5cXG4gICAgICAgICAgICAgICAgPHRib2R5PlxcbiAgICAgICAgICAgICAgICA8dHI+PHRkPkhlYWx0aDo8L3RkPjx0ZCBjbGFzcz1cXFwidGV4dC1yaWdodFxcXCI+PHNwYW4gZGF0YS1iaW5kPVxcXCJ0ZXh0OiBoZWFsdGhcXFwiPjwvc3Bhbj48L3RkPjwvdHI+XFxuICAgICAgICAgICAgICAgIDx0cj48dGQ+SGVhbHRoIFJlZ2VuOjwvdGQ+PHRkIGNsYXNzPVxcXCJ0ZXh0LXJpZ2h0XFxcIj48c3BhbiBkYXRhLWJpbmQ9XFxcInRleHQ6IGhlYWx0aHJlZ2VuXFxcIj48L3NwYW4+PC90ZD48L3RyPlxcbiAgICAgICAgICAgICAgICA8dHI+PHRkPk1hbmE6PC90ZD48dGQgY2xhc3M9XFxcInRleHQtcmlnaHRcXFwiPjxzcGFuIGRhdGEtYmluZD1cXFwidGV4dDogbWFuYVxcXCI+PC9zcGFuPjwvdGQ+PC90cj5cXG4gICAgICAgICAgICAgICAgPHRyPjx0ZD5NYW5hIFJlZ2VuOjwvdGQ+PHRkIGNsYXNzPVxcXCJ0ZXh0LXJpZ2h0XFxcIj48c3BhbiBkYXRhLWJpbmQ9XFxcInRleHQ6IG1hbmFyZWdlblxcXCI+PC9zcGFuPjwvdGQ+PC90cj5cXG4gICAgICAgICAgICAgICAgPHRyPjx0ZD5QaHlzaWNhbCA8YWJiciB0aXRsZT1cXFwiRWZmZWN0aXZlIEhpdCBQb2ludHNcXFwiPkVIUDwvYWJicj46PC90ZD48dGQgY2xhc3M9XFxcInRleHQtcmlnaHRcXFwiPjxzcGFuIGRhdGEtYmluZD1cXFwidGV4dDogZWhwUGh5c2ljYWxcXFwiPjwvc3Bhbj48L3RkPjwvdHI+XFxuICAgICAgICAgICAgICAgIDx0cj48dGQ+TWFnaWNhbCA8YWJiciB0aXRsZT1cXFwiRWZmZWN0aXZlIEhpdCBQb2ludHNcXFwiPkVIUDwvYWJicj46PC90ZD48dGQgY2xhc3M9XFxcInRleHQtcmlnaHRcXFwiPjxzcGFuIGRhdGEtYmluZD1cXFwidGV4dDogZWhwTWFnaWNhbFxcXCI+PC9zcGFuPjwvdGQ+PC90cj5cXG4gICAgICAgICAgICAgICAgPC90Ym9keT5cXG4gICAgICAgICAgICAgICAgPC90YWJsZT5cXG4gICAgICAgICAgICA8L2Rpdj5cXG5cXG4gICAgICAgICAgICA8ZGl2IGNsYXNzPVxcXCJjb2wtbWQtMTJcXFwiIGRhdGEtYmluZD1cXFwiY3NzOiB7J2NvbC1tZC0xMic6ICRyb290LmxheW91dCgpID09IDAsICdjb2wtbWQtMyc6ICRyb290LmxheW91dCgpID09IDF9XFxcIj5cXG4gICAgICAgICAgICAgICAgPHRhYmxlIGNsYXNzPVxcXCJ0YWJsZSB0YWJsZS1jb25kZW5zZWRcXFwiPlxcbiAgICAgICAgICAgICAgICA8dGJvZHk+XFxuICAgICAgICAgICAgICAgIDx0cj48dGQ+QXJtb3I6PC90ZD48dGQgY2xhc3M9XFxcInRleHQtcmlnaHRcXFwiPjxzcGFuIGRhdGEtYmluZD1cXFwidGV4dDogdG90YWxBcm1vclBoeXNpY2FsXFxcIj48L3NwYW4+PC90ZD48L3RyPlxcbiAgICAgICAgICAgICAgICA8dHI+PHRkPk1hZ2ljIFJlczo8L3RkPjx0ZCBjbGFzcz1cXFwidGV4dC1yaWdodFxcXCI+PHNwYW4gZGF0YS1iaW5kPVxcXCJodG1sOiB0b3RhbE1hZ2ljUmVzaXN0YW5jZSgpLnRvRml4ZWQoMikgKyAnJSdcXFwiPjwvc3Bhbj48L3RkPjwvdHI+XFxuICAgICAgICAgICAgICAgIDx0cj48dGQ+TGlmZXN0ZWFsOjwvdGQ+PHRkIGNsYXNzPVxcXCJ0ZXh0LXJpZ2h0XFxcIj48c3BhbiBkYXRhLWJpbmQ9XFxcInRleHQ6IGxpZmVzdGVhbFxcXCI+PC9zcGFuPjwvdGQ+PC90cj5cXG4gICAgICAgICAgICAgICAgPHRyPjx0ZD5FdmFzaW9uOjwvdGQ+PHRkIGNsYXNzPVxcXCJ0ZXh0LXJpZ2h0XFxcIj48c3BhbiBkYXRhLWJpbmQ9XFxcInRleHQ6IGV2YXNpb25cXFwiPjwvc3Bhbj48L3RkPjwvdHI+XFxuICAgICAgICAgICAgICAgIDx0cj48dGQ+QmFzaDo8L3RkPjx0ZCBjbGFzcz1cXFwidGV4dC1yaWdodFxcXCI+PHNwYW4gZGF0YS1iaW5kPVxcXCJ0ZXh0OiBiYXNoXFxcIj48L3NwYW4+PC90ZD48L3RyPlxcbiAgICAgICAgICAgICAgICA8dHI+PHRkPk1pc3MgQ2hhbmNlOjwvdGQ+PHRkIGNsYXNzPVxcXCJ0ZXh0LXJpZ2h0XFxcIj48c3BhbiBkYXRhLWJpbmQ9XFxcInRleHQ6IG1pc3NDaGFuY2VcXFwiPjwvc3Bhbj48L3RkPjwvdHI+XFxuICAgICAgICAgICAgICAgIDwvdGJvZHk+XFxuICAgICAgICAgICAgICAgIDx0Ym9keSBjbGFzcz1cXFwidGFibGVkcm9wZG93blxcXCIgc3R5bGU9XFxcImJvcmRlci10b3A6MFxcXCIgZGF0YS1iaW5kPVxcXCJ2aXNpYmxlOiBzaG93Q3JpdGljYWxTdHJpa2VEZXRhaWxzKCksZm9yZWFjaDogY3JpdEluZm8oKS5zb3VyY2VzXFxcIj5cXG4gICAgICAgICAgICAgICAgPHRyPjx0ZCBjb2xzcGFuPTI+PHN0cm9uZyBkYXRhLWJpbmQ9XFxcInRleHQ6ICRkYXRhLm5hbWVcXFwiPjwvc3Ryb25nPjwvdGQ+PC90cj5cXG4gICAgICAgICAgICAgICAgPHRyPjx0ZD5Dcml0IENoYW5jZTo8L3RkPjx0ZCBjbGFzcz1cXFwidGV4dC1yaWdodFxcXCI+PHNwYW4gZGF0YS1iaW5kPVxcXCJ0ZXh0OiAoJGRhdGEudG90YWxjaGFuY2UgKiAxMDApLnRvRml4ZWQoMikgKyAnJSdcXFwiPjwvc3Bhbj48L3RkPjwvdHI+XFxuICAgICAgICAgICAgICAgIDx0cj48dGQ+Q3JpdCBNdWx0aXBsaWVyOjwvdGQ+PHRkIGNsYXNzPVxcXCJ0ZXh0LXJpZ2h0XFxcIj48c3BhbiBkYXRhLWJpbmQ9XFxcInRleHQ6ICgkZGF0YS5tdWx0aXBsaWVyICogMTAwKS50b0ZpeGVkKDIpICsgJyUnXFxcIj48L3NwYW4+PC90ZD48L3RyPlxcbiAgICAgICAgICAgICAgICA8L3Rib2R5PlxcbiAgICAgICAgICAgICAgICA8L3RhYmxlPlxcbiAgICAgICAgICAgIDwvZGl2PlxcblxcbiAgICAgICAgICAgIDxkaXYgY2xhc3M9XFxcImNvbC1tZC0xMlxcXCIgZGF0YS1iaW5kPVxcXCJjc3M6IHsnY29sLW1kLTEyJzogJHJvb3QubGF5b3V0KCkgPT0gMCwgJ2NvbC1tZC0zJzogJHJvb3QubGF5b3V0KCkgPT0gMX1cXFwiPlxcbiAgICAgICAgICAgICAgICA8dGFibGUgY2xhc3M9XFxcInRhYmxlIHRhYmxlLWNvbmRlbnNlZFxcXCI+XFxuICAgICAgICAgICAgICAgIDx0Ym9keT5cXG4gICAgICAgICAgICAgICAgPHRyPlxcbiAgICAgICAgICAgICAgICAgICAgPHRkPkRhbWFnZTo8L3RkPlxcbiAgICAgICAgICAgICAgICAgICAgPHRkIGNsYXNzPVxcXCJ0ZXh0LXJpZ2h0XFxcIj5cXG4gICAgICAgICAgICAgICAgICAgICAgICA8c3BhbiBkYXRhLWJpbmQ9XFxcImh0bWw6IGJhc2VEYW1hZ2UoKVswXSArICctJyArIGJhc2VEYW1hZ2UoKVsxXVxcXCI+PC9zcGFuPlxcbiAgICAgICAgICAgICAgICAgICAgICAgIDxzcGFuIHN0eWxlPVxcXCJjb2xvcjpncmVlblxcXCIgZGF0YS1iaW5kPVxcXCJ2aXNpYmxlOiBib251c0RhbWFnZSgpID4gMCwgdGV4dDogJyArICcgKyBib251c0RhbWFnZSgpXFxcIj48L3NwYW4+XFxuICAgICAgICAgICAgICAgICAgICAgICAgPHNwYW4gc3R5bGU9XFxcImNvbG9yOnJlZFxcXCIgZGF0YS1iaW5kPVxcXCJ2aXNpYmxlOiBib251c0RhbWFnZVJlZHVjdGlvbigpICE9IDAsIHRleHQ6ICcgLSAnICsgYm9udXNEYW1hZ2VSZWR1Y3Rpb24oKVxcXCI+PC9zcGFuPlxcbiAgICAgICAgICAgICAgICAgICAgPC90ZD5cXG4gICAgICAgICAgICAgICAgPC90cj5cXG4gICAgICAgICAgICAgICAgPHRyPjx0ZD48YWJiciB0aXRsZT1cXFwiSW5jcmVhc2VkIEF0dGFjayBTcGVlZFxcXCI+SUFTPC9hYmJyPjo8L3RkPjx0ZCBjbGFzcz1cXFwidGV4dC1yaWdodFxcXCI+PHNwYW4gZGF0YS1iaW5kPVxcXCJ0ZXh0OiBpYXNcXFwiPjwvc3Bhbj48L3RkPjwvdHI+XFxuICAgICAgICAgICAgICAgIDx0cj48dGQ+PGFiYnIgdGl0bGU9XFxcIkJhc2UgQXR0YWNrIFRpbWVcXFwiPkJBVDwvYWJicj46PC90ZD48dGQgY2xhc3M9XFxcInRleHQtcmlnaHRcXFwiPjxzcGFuIGRhdGEtYmluZD1cXFwidGV4dDogYmF0XFxcIj48L3NwYW4+PC90ZD48L3RyPlxcbiAgICAgICAgICAgICAgICA8dHI+PHRkPkF0dGFjayBUaW1lOjwvdGQ+PHRkIGNsYXNzPVxcXCJ0ZXh0LXJpZ2h0XFxcIj48c3BhbiBkYXRhLWJpbmQ9XFxcInRleHQ6IGF0dGFja1RpbWVcXFwiPjwvc3Bhbj48L3RkPjwvdHI+XFxuICAgICAgICAgICAgICAgIDx0cj48dGQ+QXR0YWNrIC8gU2VjOjwvdGQ+PHRkIGNsYXNzPVxcXCJ0ZXh0LXJpZ2h0XFxcIj48c3BhbiBkYXRhLWJpbmQ9XFxcInRleHQ6IGF0dGFja3NQZXJTZWNvbmQoKS50b0ZpeGVkKDIpXFxcIj48L3NwYW4+PC90ZD48L3RyPlxcbiAgICAgICAgICAgICAgICA8dHI+PHRkPkF0dGFjayBSYW5nZTo8L3RkPjx0ZCBjbGFzcz1cXFwidGV4dC1yaWdodFxcXCI+PHNwYW4gZGF0YS1iaW5kPVxcXCJ0ZXh0OiB0b3RhbGF0dGFja3JhbmdlXFxcIj48L3NwYW4+PC90ZD48L3RyPlxcbiAgICAgICAgICAgICAgICA8L3Rib2R5PlxcbiAgICAgICAgICAgICAgICA8L3RhYmxlPlxcbiAgICAgICAgICAgIDwvZGl2PlxcbiAgICAgICAgPC9kaXY+XFxuICAgIDwvZGl2PlxcbiAgICA8ZGl2IGNsYXNzPVxcXCJjb2wtbWQtOFxcXCIgZGF0YS1iaW5kPVxcXCJjc3M6IHsnY29sLW1kLTgnOiAkcm9vdC5sYXlvdXQoKSA9PSAwLCAnY29sLW1kLTEyJzogJHJvb3QubGF5b3V0KCkgPT0gMX1cXFwiPlxcbiAgICAgICAgPGRpdiBkYXRhLWJpbmQ9XFxcImNvbXBvbmVudDogeyBuYW1lOiAnZGFtYWdlLWRldGFpbHMnLCBwYXJhbXM6ICRkYXRhfVxcXCI+PC9kaXY+XFxuICAgICAgICBcXG4gICAgICAgIDxkaXYgY2xhc3M9XFxcInJvd1xcXCI+XFxuICAgICAgICAgICAgPGRpdiBjbGFzcz1cXFwiY29sLW1kLTEyXFxcIj5cXG4gICAgICAgICAgICAgICAgPGgzIGNsYXNzPVxcXCJzZWN0aW9uX2hlYWRlclxcXCIgZGF0YS1iaW5kPVxcXCJ0b2dnbGU6IHNlY3Rpb25EaXNwbGF5KCkuaW52ZW50b3J5LCBjc3M6IHsgc2VjdGlvbl9kaXNhYmxlZDogIXNlY3Rpb25EaXNwbGF5KCkuaW52ZW50b3J5KCkgfVxcXCI+SW52ZW50b3J5IDxzbWFsbCBzdHlsZT1cXFwiY29sb3I6Z29sZGVucm9kXFxcIiBkYXRhLWJpbmQ9XFxcImh0bWw6IGludmVudG9yeS50b3RhbENvc3QoKSA/ICc8aW1nIHNyYz1cXFxcJ2h0dHA6Ly9jZG4uZG90YTIuY29tL2FwcHMvZG90YTIvaW1hZ2VzL3Rvb2x0aXBzL2dvbGQucG5nXFxcXCcvPiAnICsgaW52ZW50b3J5LnRvdGFsQ29zdCgpIDogJycgXFxcIj48L3NtYWxsPjwvaDM+XFxuICAgICAgICAgICAgICAgIDxkaXYgaWQ9XFxcImludmVudG9yeVxcXCIgY2xhc3M9XFxcImludmVudG9yeSBob3Zlci1jdXJzb3JcXFwiIGRhdGEtYmluZD1cXFwiY2xpY2s6IGZ1bmN0aW9uIChkYXRhLCBldmVudCkgeyBidWlsZEV4cGxvcmVyLnNlbGVjdEludmVudG9yeSgtMSk7IH0sIGNzczogeydyb3ctaGlnaGxpZ2h0Jzogc2VsZWN0ZWRJbnZlbnRvcnkoKSA9PSAtMX0sIHRlbXBsYXRlOiB7IG5hbWU6ICdpdGVtLXRlbXBsYXRlJywgZm9yZWFjaDogaW52ZW50b3J5Lml0ZW1zIH0sIHZpc2libGU6IHNlY3Rpb25EaXNwbGF5KCkuaW52ZW50b3J5KClcXFwiPjwvZGl2PlxcbiAgICAgICAgICAgIDwvZGl2PlxcbiAgICAgICAgPC9kaXY+XFxuICAgICAgICBcXG4gICAgICAgIDxkaXYgY2xhc3M9XFxcInJvd1xcXCI+XFxuICAgICAgICAgICAgPGRpdiBjbGFzcz1cXFwiY29sLW1kLTEyXFxcIj5cXG4gICAgICAgICAgICAgICAgPGgzIGNsYXNzPVxcXCJzZWN0aW9uX2hlYWRlclxcXCIgZGF0YS1iaW5kPVxcXCJ0b2dnbGU6IHNlY3Rpb25EaXNwbGF5KCkuYWJpbGl0eSwgY3NzOiB7IHNlY3Rpb25fZGlzYWJsZWQ6ICFzZWN0aW9uRGlzcGxheSgpLmFiaWxpdHkoKSB9XFxcIj5BYmlsaXRpZXMgPHNtYWxsIHN0eWxlPVxcXCJjb2xvcjppbmhlcml0XFxcIiBkYXRhLWJpbmQ9XFxcInRleHQ6IGF2YWlsYWJsZVNraWxsUG9pbnRzKCkgPyAoYXZhaWxhYmxlU2tpbGxQb2ludHMoKSA9PSAxID8gJzEgdW5zcGVudCBza2lsbHBvaW50JyA6IGF2YWlsYWJsZVNraWxsUG9pbnRzKCkgKyAnIHVuc3BlbnQgc2tpbGxwb2ludHMnKSA6ICcnXFxcIj48L3NtYWxsPjwvaDM+XFxuICAgICAgICAgICAgICAgIDxkaXYgY2xhc3M9XFxcInJvd1xcXCIgZGF0YS1iaW5kPVxcXCJ2aXNpYmxlOiBzZWN0aW9uRGlzcGxheSgpLmFiaWxpdHkoKSwgZm9yZWFjaDogYWJpbGl0eSgpLmFiaWxpdGllcygpXFxcIj5cXG4gICAgICAgICAgICAgICAgICAgIDxkaXYgZGF0YS1iaW5kPVxcXCJjb21wb25lbnQ6IHsgbmFtZTogJ2FiaWxpdHknLCBwYXJhbXM6ICRkYXRhIH1cXFwiPjwvZGl2PlxcbiAgICAgICAgICAgICAgICA8L2Rpdj5cXG4gICAgICAgICAgICAgICAgPGRpdiBjbGFzcz1cXFwiZm9ybS1ob3Jpem9udGFsXFxcIiBkYXRhLWJpbmQ9XFxcImlmOiBzZWxlY3RlZEhlcm8oKS5oZXJvTmFtZSA9PSAnc2lsZW5jZXInLCB2aXNpYmxlOiBzZWN0aW9uRGlzcGxheSgpLmFiaWxpdHkoKVxcXCI+XFxuICAgICAgICAgICAgICAgICAgICA8ZGl2IGNsYXNzPVxcXCJmb3JtLWdyb3VwXFxcIj5cXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgPGRpdiBjbGFzcz1cXFwiY29sLW1kLTIgY29udHJvbC1sYWJlbFxcXCI+XFxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICA8bGFiZWwgZm9yPVxcXCJpbnRlbGxpZ2VuY2VzdG9sZW5cXFwiPkludGVsbGlnZW5jZSBTdG9sZW48L2xhYmVsPlxcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICA8L2Rpdj5cXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgPGRpdiBjbGFzcz1cXFwiY29sLW1kLTJcXFwiPlxcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgPGlucHV0IGNsYXNzPVxcXCJmb3JtLWNvbnRyb2xcXFwiIGlkPVxcXCJpbnRlbGxpZ2VuY2VzdG9sZW5cXFwiIGRhdGEtYmluZD1cXFwidmFsdWU6IGludFN0b2xlblxcXCIgLz5cXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgPC9kaXY+XFxuICAgICAgICAgICAgICAgICAgICA8L2Rpdj5cXG4gICAgICAgICAgICAgICAgPC9kaXY+XFxuICAgICAgICAgICAgPC9kaXY+XFxuICAgICAgICA8L2Rpdj5cXG5cXG4gICAgICAgIDxkaXYgZGF0YS1iaW5kPVxcXCJjb21wb25lbnQ6IHsgbmFtZTogJ2J1ZmYtc2VjdGlvbicsIHBhcmFtczogJGRhdGF9XFxcIj48L2Rpdj5cXG4gICAgPC9kaXY+XFxuPC9kaXY+XCIgfSk7XG5rby5jb21wb25lbnRzLnJlZ2lzdGVyKCdjbG9uZS1wYW5lJywgeyB0ZW1wbGF0ZTogXCI8ZGl2IGNsYXNzPVxcXCJyb3dcXFwiPlxcbiAgICA8ZGl2IGNsYXNzPVxcXCJjb2wtbWQtNFxcXCI+XFxuICAgICAgICA8aW1nIGNsYXNzPVxcXCJpbWctcm91bmRlZFxcXCIgZGF0YS1iaW5kPVxcXCJhdHRyOntzcmM6ICcvbWVkaWEvaW1hZ2VzL2hlcm9lcy9tZWVwby5wbmcnfVxcXCIvPlxcbiAgICA8L2Rpdj5cXG48L2Rpdj5cXG5cXG48ZGl2IGNsYXNzPVxcXCJyb3dcXFwiPlxcbiAgICA8ZGl2IGNsYXNzPVxcXCJjb2wtbWQtNFxcXCIgZGF0YS1iaW5kPVxcXCJjc3M6IHsnY29sLW1kLTQnOiAkcm9vdC5sYXlvdXQoKSA9PSAwLCAnY29sLW1kLTEyJzogJHJvb3QubGF5b3V0KCkgPT0gMX1cXFwiPlxcbiAgICAgICAgPGRpdiBjbGFzcz1cXFwicm93XFxcIj5cXG4gICAgICAgICAgICA8aDMgY2xhc3M9XFxcImNvbC1tZC0xMlxcXCI+U3RhdHMgPGEgY2xhc3M9XFxcImJ0biBidG4tZGVmYXVsdCBidG4teHNcXFwiIGRhdGEtYmluZD1cXFwidG9nZ2xlOiBzaG93U3RhdERldGFpbHMsIHRleHQ6ICFzaG93U3RhdERldGFpbHMoKSA/ICdTaG93IG1vcmUnIDogJ1Nob3cgbGVzcycsIGF0dHI6IHt0aXRsZTogIXNob3dTdGF0RGV0YWlscygpID8gJ0NsaWNrIHRvIHNob3cgYmFzZSBzdGF0cycgOiAnQ2xpY2sgdG8gaGlkZSBiYXNlIHN0YXRzJ31cXFwiPjwvYT48L2gzPlxcblxcbiAgICAgICAgICAgIDxkaXYgY2xhc3M9XFxcImNvbC1tZC0xMlxcXCIgZGF0YS1iaW5kPVxcXCJ2aXNpYmxlOiBzaG93U3RhdERldGFpbHMoKSwgY3NzOiB7J2NvbC1tZC0xMic6ICRyb290LmxheW91dCgpID09IDAsICdjb2wtbWQtMyc6ICRyb290LmxheW91dCgpID09IDF9LCBjb21wb25lbnQ6IHtuYW1lOiAnc3RhdHMtYWRkaXRpb25hbCcsIHBhcmFtczogJGRhdGF9XFxcIj48L2Rpdj5cXG5cXG4gICAgICAgICAgICA8ZGl2IGNsYXNzPVxcXCJzdGF0c2NvbnRhaW5lclxcXCIgZGF0YS1iaW5kPVxcXCJmb3JlYWNoOiAkcm9vdC5hbGxJdGVtc1xcXCI+XFxuICAgICAgICAgICAgICAgIDxkaXYgZGF0YS1iaW5kPVxcXCJjb21wb25lbnQ6IHsgbmFtZTogJGRhdGEudmFsdWUsIHBhcmFtczogJHJvb3QuaGVyb2VzWyRwYXJlbnRDb250ZXh0LiRpbmRleCgpXS5jbG9uZSgpfVxcXCI+PC9kaXY+XFxuICAgICAgICAgICAgPC9kaXY+XFxuICAgICAgICA8L2Rpdj5cXG4gICAgPC9kaXY+XFxuICAgIDxkaXYgY2xhc3M9XFxcImNvbC1tZC04XFxcIiBkYXRhLWJpbmQ9XFxcImNzczogeydjb2wtbWQtOCc6ICRyb290LmxheW91dCgpID09IDAsICdjb2wtbWQtMTInOiAkcm9vdC5sYXlvdXQoKSA9PSAxfVxcXCI+XFxuICAgICAgICA8ZGl2IGRhdGEtYmluZD1cXFwiY29tcG9uZW50OiB7IG5hbWU6ICdkYW1hZ2UtZGV0YWlscycsIHBhcmFtczogJGRhdGF9XFxcIj48L2Rpdj5cXG4gICAgICAgIFxcbiAgICAgICAgPGRpdiBjbGFzcz1cXFwicm93XFxcIj5cXG4gICAgICAgICAgICA8ZGl2IGNsYXNzPVxcXCJjb2wtbWQtMTJcXFwiPlxcbiAgICAgICAgICAgICAgICA8aDMgY2xhc3M9XFxcInNlY3Rpb25faGVhZGVyXFxcIiBkYXRhLWJpbmQ9XFxcInRvZ2dsZTogc2VjdGlvbkRpc3BsYXkoKS5pbnZlbnRvcnksIGNzczogeyBzZWN0aW9uX2Rpc2FibGVkOiAhc2VjdGlvbkRpc3BsYXkoKS5pbnZlbnRvcnkoKSB9XFxcIj5JbnZlbnRvcnkgPHNtYWxsIHN0eWxlPVxcXCJjb2xvcjpnb2xkZW5yb2RcXFwiIGRhdGEtYmluZD1cXFwiaHRtbDogaW52ZW50b3J5LnRvdGFsQ29zdCgpID8gJzxpbWcgc3JjPVxcXFwnaHR0cDovL2Nkbi5kb3RhMi5jb20vYXBwcy9kb3RhMi9pbWFnZXMvdG9vbHRpcHMvZ29sZC5wbmdcXFxcJy8+ICcgKyBpbnZlbnRvcnkudG90YWxDb3N0KCkgOiAnJyBcXFwiPjwvc21hbGw+PC9oMz5cXG4gICAgICAgICAgICAgICAgPGRpdiBpZD1cXFwiaW52ZW50b3J5XFxcIiBjbGFzcz1cXFwiaW52ZW50b3J5IGhvdmVyLWN1cnNvclxcXCIgZGF0YS1iaW5kPVxcXCJjbGljazogZnVuY3Rpb24gKGRhdGEsIGV2ZW50KSB7IGJ1aWxkRXhwbG9yZXIuc2VsZWN0SW52ZW50b3J5KC0xKTsgfSwgY3NzOiB7J3Jvdy1oaWdobGlnaHQnOiBzZWxlY3RlZEludmVudG9yeSgpID09IC0xfSwgdGVtcGxhdGU6IHsgbmFtZTogJ2l0ZW0tdGVtcGxhdGUnLCBmb3JlYWNoOiBpbnZlbnRvcnkuaXRlbXMgfSwgdmlzaWJsZTogc2VjdGlvbkRpc3BsYXkoKS5pbnZlbnRvcnkoKVxcXCI+PC9kaXY+XFxuICAgICAgICAgICAgPC9kaXY+XFxuICAgICAgICA8L2Rpdj5cXG5cXG4gICAgICAgIDxkaXYgY2xhc3M9XFxcInJvd1xcXCIgZGF0YS1iaW5kPVxcXCJjb21wb25lbnQ6IHsgbmFtZTogJ2RhbWFnZS1hbXAnLCBwYXJhbXM6ICRkYXRhfVxcXCI+PC9kaXY+XFxuICAgIDwvZGl2PlxcbjwvZGl2PlwiIH0pO1xua28uY29tcG9uZW50cy5yZWdpc3RlcignaWxsdXNpb24tcGFuZScsIHsgdGVtcGxhdGU6IFwiPGRpdiBjbGFzcz1cXFwicm93XFxcIj5cXG4gICAgPGRpdiBjbGFzcz1cXFwiY29sLW1kLTRcXFwiPlxcbiAgICAgICAgPGRpdiBjbGFzcz1cXFwiaW1nLXJvdW5kZWRcXFwiIHN0eWxlPVxcXCJiYWNrZ3JvdW5kLWNvbG9yOiM0MjhiY2E7ZGlzcGxheTppbmxpbmUtYmxvY2tcXFwiPlxcbiAgICAgICAgICAgIDxpbWcgY2xhc3M9XFxcImltZy1yb3VuZGVkXFxcIiBzdHlsZT1cXFwib3BhY2l0eTouNVxcXCIgZGF0YS1iaW5kPVxcXCJhdHRyOntzcmM6ICcvbWVkaWEvaW1hZ2VzL2hlcm9lcy8nICsgc2VsZWN0ZWRIZXJvKCkuaGVyb05hbWUgKyAnLnBuZyd9XFxcIi8+XFxuICAgICAgICA8L2Rpdj5cXG4gICAgPC9kaXY+XFxuICAgIDxkaXYgY2xhc3M9XFxcImNvbC1tZC00XFxcIj5cXG4gICAgICAgIDxsYWJlbCBmb3I9XFxcImlsbHVzaW9ubGV2ZWxcXFwiIGRhdGEtYmluZD1cXFwidGV4dDogaWxsdXNpb25EaXNwbGF5TmFtZVxcXCI+PC9sYWJlbD5cXG4gICAgICAgIDx0YWJsZSBjbGFzcz1cXFwidGFibGVcXFwiPlxcbiAgICAgICAgICAgIDx0Ym9keT5cXG4gICAgICAgICAgICA8dHI+XFxuICAgICAgICAgICAgICAgIDx0ZD5EYW1hZ2UgRGVhbHQ8L3RkPlxcbiAgICAgICAgICAgICAgICA8dGQgY2xhc3M9XFxcInRleHQtcmlnaHRcXFwiIGRhdGEtYmluZD1cXFwidGV4dDogKGdldE91dGdvaW5nRGFtYWdlTXVsdGlwbGllcihpbGx1c2lvblR5cGUoKSwgZmFsc2UsIGhlcm8oKS5hdHRhY2t0eXBlKCkpKjEwMCkudG9GaXhlZCgwKSsnJSdcXFwiPjwvdGQ+XFxuICAgICAgICAgICAgPC90cj5cXG4gICAgICAgICAgICA8dHI+XFxuICAgICAgICAgICAgICAgIDx0ZD5EYW1hZ2UgVGFrZW48L3RkPlxcbiAgICAgICAgICAgICAgICA8dGQgY2xhc3M9XFxcInRleHQtcmlnaHRcXFwiIGRhdGEtYmluZD1cXFwidGV4dDogKGdldEluY29taW5nRGFtYWdlTXVsdGlwbGllcihpbGx1c2lvblR5cGUoKSwgZmFsc2UsIGhlcm8oKS5hdHRhY2t0eXBlKCkpKjEwMCkudG9GaXhlZCgwKSsnJSdcXFwiPjwvdGQ+XFxuICAgICAgICAgICAgPC90cj5cXG4gICAgICAgICAgICA8L3Rib2R5PlxcbiAgICAgICAgPC90YWJsZT5cXG4gICAgPC9kaXY+XFxuICAgIDxkaXYgY2xhc3M9XFxcImNvbC1tZC00XFxcIj5cXG4gICAgICAgIDxkaXYgZGF0YS1iaW5kPVxcXCJ2aXNpYmxlOiBpbGx1c2lvblR5cGUoKSAhPSAnaXRlbV9tYW50YSdcXFwiPlxcbiAgICAgICAgICAgIDxsYWJlbCBmb3I9XFxcImlsbHVzaW9ubGV2ZWxcXFwiPkFiaWxpdHkgTGV2ZWw8L2xhYmVsPlxcbiAgICAgICAgICAgIDxzZWxlY3QgaWQ9XFxcImlsbHVzaW9ubGV2ZWxcXFwiIGNsYXNzPVxcXCJmb3JtLWNvbnRyb2xcXFwiIGRhdGEtYmluZD1cXFwidmFsdWU6IGlsbHVzaW9uQWJpbGl0eUxldmVsLCBmb3JlYWNoOiBuZXcgQXJyYXkoaWxsdXNpb25BYmlsaXR5TWF4TGV2ZWwoKSlcXFwiPlxcbiAgICAgICAgICAgICAgICA8b3B0aW9uIGRhdGEtYmluZD1cXFwidGV4dDogJGluZGV4KCkrMVxcXCI+PC9vcHRpb24+XFxuICAgICAgICAgICAgPC9zZWxlY3Q+XFxuICAgICAgICA8L2Rpdj5cXG4gICAgPC9kaXY+XFxuPC9kaXY+XFxuXFxuPGRpdiBjbGFzcz1cXFwicm93XFxcIj5cXG4gICAgPGRpdiBjbGFzcz1cXFwiY29sLW1kLTRcXFwiIGRhdGEtYmluZD1cXFwiY3NzOiB7J2NvbC1tZC00JzogJHJvb3QubGF5b3V0KCkgPT0gMCwgJ2NvbC1tZC0xMic6ICRyb290LmxheW91dCgpID09IDF9XFxcIj5cXG4gICAgICAgIDxkaXYgY2xhc3M9XFxcInJvd1xcXCI+XFxuICAgICAgICAgICAgPGgzIGNsYXNzPVxcXCJjb2wtbWQtMTJcXFwiPlN0YXRzIDxhIGNsYXNzPVxcXCJidG4gYnRuLWRlZmF1bHQgYnRuLXhzXFxcIiBkYXRhLWJpbmQ9XFxcInRvZ2dsZTogc2hvd1N0YXREZXRhaWxzLCB0ZXh0OiAhc2hvd1N0YXREZXRhaWxzKCkgPyAnU2hvdyBtb3JlJyA6ICdTaG93IGxlc3MnLCBhdHRyOiB7dGl0bGU6ICFzaG93U3RhdERldGFpbHMoKSA/ICdDbGljayB0byBzaG93IGJhc2Ugc3RhdHMnIDogJ0NsaWNrIHRvIGhpZGUgYmFzZSBzdGF0cyd9XFxcIj48L2E+PC9oMz5cXG5cXG4gICAgICAgICAgICA8ZGl2IGNsYXNzPVxcXCJjb2wtbWQtMTJcXFwiIGRhdGEtYmluZD1cXFwidmlzaWJsZTogc2hvd1N0YXREZXRhaWxzKCksIGNzczogeydjb2wtbWQtMTInOiAkcm9vdC5sYXlvdXQoKSA9PSAwLCAnY29sLW1kLTMnOiAkcm9vdC5sYXlvdXQoKSA9PSAxfSwgY29tcG9uZW50OiB7bmFtZTogJ3N0YXRzLWFkZGl0aW9uYWwnLCBwYXJhbXM6ICRkYXRhfVxcXCI+XFxuICAgICAgICAgICAgPC9kaXY+XFxuICAgICAgICAgICAgPGRpdiBjbGFzcz1cXFwic3RhdHNjb250YWluZXJcXFwiIGRhdGEtYmluZD1cXFwiZm9yZWFjaDogJHJvb3QuYWxsSXRlbXNcXFwiPlxcbiAgICAgICAgICAgICAgICA8ZGl2IGRhdGEtYmluZD1cXFwiY29tcG9uZW50OiB7IG5hbWU6ICRkYXRhLnZhbHVlLCBwYXJhbXM6ICRwYXJlbnRDb250ZXh0LiRkYXRhfVxcXCI+PC9kaXY+XFxuICAgICAgICAgICAgPC9kaXY+XFxuICAgICAgICA8L2Rpdj5cXG4gICAgPC9kaXY+XFxuICAgIDxkaXYgY2xhc3M9XFxcImNvbC1tZC04XFxcIiBkYXRhLWJpbmQ9XFxcImNzczogeydjb2wtbWQtNCc6ICRyb290LmxheW91dCgpID09IDAsICdjb2wtbWQtMTInOiAkcm9vdC5sYXlvdXQoKSA9PSAxfVxcXCI+XFxuICAgICAgICA8ZGl2IGNsYXNzPVxcXCJyb3dcXFwiPlxcbiAgICAgICAgICAgIDxkaXYgY2xhc3M9XFxcImNvbC1tZC0xMlxcXCI+XFxuICAgICAgICAgICAgICAgIDxoMyBjbGFzcz1cXFwic2VjdGlvbl9oZWFkZXJcXFwiIGRhdGEtYmluZD1cXFwidG9nZ2xlOiBzZWN0aW9uRGlzcGxheSgpLmludmVudG9yeSwgY3NzOiB7IHNlY3Rpb25fZGlzYWJsZWQ6ICFzZWN0aW9uRGlzcGxheSgpLmludmVudG9yeSgpIH1cXFwiPkludmVudG9yeSA8c21hbGwgc3R5bGU9XFxcImNvbG9yOmdvbGRlbnJvZFxcXCIgZGF0YS1iaW5kPVxcXCJodG1sOiBpbnZlbnRvcnkudG90YWxDb3N0KCkgPyAnPGltZyBzcmM9XFxcXCdodHRwOi8vY2RuLmRvdGEyLmNvbS9hcHBzL2RvdGEyL2ltYWdlcy90b29sdGlwcy9nb2xkLnBuZ1xcXFwnLz4gJyArIGludmVudG9yeS50b3RhbENvc3QoKSA6ICcnIFxcXCI+PC9zbWFsbD48L2gzPlxcbiAgICAgICAgICAgICAgICA8ZGl2IGlkPVxcXCJpbnZlbnRvcnlcXFwiIGNsYXNzPVxcXCJpbnZlbnRvcnkgaG92ZXItY3Vyc29yXFxcIiBkYXRhLWJpbmQ9XFxcImNsaWNrOiBmdW5jdGlvbiAoZGF0YSwgZXZlbnQpIHsgYnVpbGRFeHBsb3Jlci5zZWxlY3RJbnZlbnRvcnkoLTEpOyB9LCBjc3M6IHsncm93LWhpZ2hsaWdodCc6IHNlbGVjdGVkSW52ZW50b3J5KCkgPT0gLTF9LCBmb3JlYWNoOiBpbnZlbnRvcnkuaXRlbXMsIHZpc2libGU6IHNlY3Rpb25EaXNwbGF5KCkuaW52ZW50b3J5KClcXFwiPlxcbiAgICAgICAgICAgICAgICAgICAgPGRpdiBjbGFzcz1cXFwiYnRuLWdyb3VwXFxcIj5cXG4gICAgICAgICAgICAgICAgICAgICAgICA8aW1nIHN0eWxlPVxcXCJ3aWR0aDo3NXB4O1xcXCIgY2xhc3M9XFxcImltZy1yb3VuZGVkXFxcIiBkYXRhLWJpbmQ9XFxcImNzczogeyBpdGVtX2Rpc2FibGVkOiAhZW5hYmxlZCgpLCBpdGVtX2FjdGl2ZTogJHBhcmVudC5pbnZlbnRvcnkuZ2V0QWN0aXZlQm9yZGVyKCRkYXRhKSA9PSAxLCBpdGVtX2luYWN0aXZlOiAkcGFyZW50LmludmVudG9yeS5nZXRBY3RpdmVCb3JkZXIoJGRhdGEpID09IDAgfSwgYXR0cjp7IHNyYzogJHBhcmVudC5pbnZlbnRvcnkuZ2V0SXRlbUltYWdlKCRkYXRhKSB9LCBjbGljazogZnVuY3Rpb24oZGF0YSwgZXZlbnQpIHsgJHBhcmVudC5pbnZlbnRvcnkudG9nZ2xlSXRlbSgkaW5kZXgsIGRhdGEsIGV2ZW50KTsgfSwgZXZlbnQ6IHsgZGJsY2xpY2s6ICRwYXJlbnQuaW52ZW50b3J5LnJlbW92ZUl0ZW0gfVxcXCIvPlxcbiAgICAgICAgICAgICAgICAgICAgICAgIDxkaXYgc3R5bGU9XFxcImZsb2F0OmxlZnRcXFwiIGRhdGEtYmluZD1cXFwidmlzaWJsZTogJHBhcmVudC5pbnZlbnRvcnkuZ2V0SXRlbVNpemVMYWJlbCgkZGF0YSkgIT0gJydcXFwiPlxcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICA8ZGl2IGRhdGEtYmluZD1cXFwiaHRtbDogJHBhcmVudC5pbnZlbnRvcnkuZ2V0SXRlbVNpemVMYWJlbCgkZGF0YSlcXFwiIHN0eWxlPVxcXCJwb3NpdGlvbjphYnNvbHV0ZTtsZWZ0OjA7Ym90dG9tOjA7Y29sb3I6d2hpdGU7b3BhY2l0eTouNTtiYWNrZ3JvdW5kLWNvbG9yOmJsYWNrO3BhZGRpbmc6MHB4IDJweFxcXCI+PC9kaXY+XFxuICAgICAgICAgICAgICAgICAgICAgICAgICAgIDxkaXYgZGF0YS1iaW5kPVxcXCJodG1sOiAkcGFyZW50LmludmVudG9yeS5nZXRJdGVtU2l6ZUxhYmVsKCRkYXRhKVxcXCIgc3R5bGU9XFxcInBvc2l0aW9uOmFic29sdXRlO2xlZnQ6MDtib3R0b206MDtjb2xvcjp3aGl0ZTtwYWRkaW5nOjBweCAycHhcXFwiPjwvZGl2PlxcbiAgICAgICAgICAgICAgICAgICAgICAgIDwvZGl2PlxcbiAgICAgICAgICAgICAgICAgICAgPC9kaXY+XFxuICAgICAgICAgICAgICAgIDwvZGl2PlxcbiAgICAgICAgICAgIDwvZGl2PlxcbiAgICAgICAgPC9kaXY+XFxuICAgIDwvZGl2PlxcbjwvZGl2PlwiIH0pO1xua28uY29tcG9uZW50cy5yZWdpc3RlcignYnVmZi1zZXR0aW5ncycsIHsgdGVtcGxhdGU6IFwiPGRpdiBjbGFzcz1cXFwiZm9ybS1ob3Jpem9udGFsXFxcIj5cXG4gICAgPGRpdiBkYXRhLWJpbmQ9XFxcImZvcmVhY2g6IGRhdGFcXFwiPlxcbiAgICAgICAgPGRpdiBjbGFzcz1cXFwiZm9ybS1ncm91cFxcXCIgZGF0YS1iaW5kPVxcXCJ2aXNpYmxlOiAoZGlzcGxheSA9PSB1bmRlZmluZWQgfHwgZGlzcGxheSA9PSAnYnVmZicpXFxcIj5cXG4gICAgICAgICAgICA8bGFiZWwgY2xhc3M9XFxcImNvbC1tZC02IGNvbnRyb2wtbGFiZWxcXFwiIGRhdGEtYmluZD1cXFwiY3NzOiB7J2NoZWNrYm94LWxhYmVsJzogY29udHJvbFR5cGUgPT0gJ2NoZWNrYm94J30sIGF0dHI6IHsnZm9yJzogbGFiZWxOYW1lfSwgaHRtbDogbGFiZWxOYW1lXFxcIj48L2xhYmVsPlxcbiAgICAgICAgICAgIDxkaXYgZGF0YS1iaW5kPVxcXCJpZjogY29udHJvbFR5cGUgPT0gJ2lucHV0JyAmJiAoZGlzcGxheSA9PSB1bmRlZmluZWQgfHwgZGlzcGxheSA9PSAnYnVmZicgfHwgZGlzcGxheSA9PSAnaGlkZGVuJylcXFwiPlxcbiAgICAgICAgICAgICAgICA8ZGl2IGNsYXNzPVxcXCJjb2wtbWQtNlxcXCI+PGlucHV0IGNsYXNzPVxcXCJmb3JtLWNvbnRyb2xcXFwiIGRhdGEtYmluZD1cXFwiYXR0cjogeydpZCc6IGxhYmVsTmFtZX0sIHZhbHVlOiBjb250cm9sVmFsXFxcIj48L2Rpdj5cXG4gICAgICAgICAgICA8L2Rpdj5cXG4gICAgICAgICAgICA8ZGl2IGRhdGEtYmluZD1cXFwiaWY6IGNvbnRyb2xUeXBlID09ICdjaGVja2JveCcgJiYgKGRpc3BsYXkgPT0gdW5kZWZpbmVkIHx8IGRpc3BsYXkgPT0gJ2J1ZmYnIHx8IGRpc3BsYXkgPT0gJ2hpZGRlbicpXFxcIj5cXG4gICAgICAgICAgICAgICAgPGRpdiBjbGFzcz1cXFwiY29sLW1kLTZcXFwiPlxcbiAgICAgICAgICAgICAgICAgICAgPGRpdiBjbGFzcz1cXFwiY2hlY2tib3hcXFwiPlxcbiAgICAgICAgICAgICAgICAgICAgICAgIDxpbnB1dCB0eXBlPVxcXCJjaGVja2JveFxcXCIgZGF0YS1iaW5kPVxcXCJhdHRyOiB7J2lkJzogbGFiZWxOYW1lfSwgY2hlY2tlZDogY29udHJvbFZhbFxcXCI+XFxuICAgICAgICAgICAgICAgICAgICA8L2Rpdj5cXG4gICAgICAgICAgICAgICAgPC9kaXY+XFxuICAgICAgICAgICAgPC9kaXY+XFxuICAgICAgICAgICAgPGRpdiBkYXRhLWJpbmQ9XFxcImlmOiAoY29udHJvbFR5cGUgPT0gJ3RleHQnIHx8IGNvbnRyb2xUeXBlID09ICdtZXRob2QnKSAmJiAoZGlzcGxheSA9PSB1bmRlZmluZWQgfHwgZGlzcGxheSA9PSAnYnVmZicgfHwgZGlzcGxheSA9PSAnaGlkZGVuJylcXFwiPlxcbiAgICAgICAgICAgICAgICA8ZGl2IGNsYXNzPVxcXCJjb2wtbWQtNlxcXCI+PHAgY2xhc3M9XFxcImZvcm0tY29udHJvbC1zdGF0aWNcXFwiIGRhdGEtYmluZD1cXFwiaHRtbDogY29udHJvbFZhbFxcXCI+PC9wPjwvZGl2PlxcbiAgICAgICAgICAgIDwvZGl2PlxcbiAgICAgICAgICAgIDxkaXYgZGF0YS1iaW5kPVxcXCJpZjogY29udHJvbFR5cGUgPT0gJ3JhZGlvJyAmJiAoZGlzcGxheSA9PSB1bmRlZmluZWQgfHwgZGlzcGxheSA9PSAnYnVmZicgfHwgZGlzcGxheSA9PSAnaGlkZGVuJylcXFwiPlxcbiAgICAgICAgICAgICAgICA8ZGl2IGNsYXNzPVxcXCJjb2wtbWQtNlxcXCI+XFxuICAgICAgICAgICAgICAgICAgICA8IS0tIGtvIGZvcmVhY2g6IGNvbnRyb2xPcHRpb25zIC0tPlxcbiAgICAgICAgICAgICAgICAgICAgPGRpdiBjbGFzcz1cXFwicmFkaW9cXFwiPlxcbiAgICAgICAgICAgICAgICAgICAgICAgIDxsYWJlbD5cXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgPGlucHV0IHR5cGU9XFxcInJhZGlvXFxcIiBkYXRhLWJpbmQ9XFxcImF0dHI6IHsnaWQnOiAkcGFyZW50LmxhYmVsTmFtZSArIHZhbHVlLCB2YWx1ZTogdmFsdWV9LCBjaGVja2VkOiAkcGFyZW50LmNvbnRyb2xWYWxcXFwiPlxcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICA8c3BhbiBkYXRhLWJpbmQ9XFxcInRleHQ6IHRleHRcXFwiPjwvc3Bhbj5cXG4gICAgICAgICAgICAgICAgICAgICAgICA8L2xhYmVsPlxcbiAgICAgICAgICAgICAgICAgICAgPC9kaXY+XFxuICAgICAgICAgICAgICAgICAgICA8IS0tIC9rbyAtLT5cXG4gICAgICAgICAgICAgICAgPC9kaXY+XFxuICAgICAgICAgICAgPC9kaXY+XFxuICAgICAgICA8L2Rpdj5cXG4gICAgPC9kaXY+XFxuPC9kaXY+XCIgfSk7XG5rby5jb21wb25lbnRzLnJlZ2lzdGVyKCdpdGVtLWJ1ZmYnLCB7IHRlbXBsYXRlOiBcIjxkaXYgY2xhc3M9XFxcImJ0bi1ncm91cFxcXCI+XFxuICAgIDxpbWcgc3R5bGU9XFxcIndpZHRoOjc1cHg7XFxcIiBjbGFzcz1cXFwiaW1nLXJvdW5kZWRcXFwiIGRhdGEtYmluZD1cXFwiY3NzOiB7IGl0ZW1fZGlzYWJsZWQ6ICFlbmFibGVkKCksIGl0ZW1fYWN0aXZlOiAkcGFyZW50c1sxXS5idWZmcy5pdGVtQnVmZnMuZ2V0QWN0aXZlQm9yZGVyKCRkYXRhKSA9PSAxLCBpdGVtX2luYWN0aXZlOiAkcGFyZW50c1sxXS5idWZmcy5pdGVtQnVmZnMuZ2V0QWN0aXZlQm9yZGVyKCRkYXRhKSA9PSAwIH0sIGF0dHI6eyBzcmM6ICRwYXJlbnRzWzFdLmJ1ZmZzLml0ZW1CdWZmcy5nZXRJdGVtSW1hZ2UoJGRhdGEpIH0sIGNsaWNrOiBmdW5jdGlvbihkYXRhLCBldmVudCkgeyAkcGFyZW50c1sxXS5idWZmcy5pdGVtQnVmZnMudG9nZ2xlSXRlbSgkaW5kZXgsIGRhdGEsIGV2ZW50KTsgfSwgZXZlbnQ6IHsgZGJsY2xpY2s6ICRwYXJlbnRzWzFdLmJ1ZmZzLml0ZW1CdWZmcy5yZW1vdmVJdGVtIH1cXFwiLz5cXG4gICAgPGRpdiBjbGFzcz1cXFwiYnRuLWdyb3VwLXZlcnRpY2FsXFxcIj5cXG4gICAgICAgIDxidXR0b24gc3R5bGU9XFxcInBhZGRpbmc6M3B4IDEwcHg7XFxcIiBjbGFzcz1cXFwiYnRuIGJ0bi1kZWZhdWx0IGJ0bi14c1xcXCIgdGl0bGU9XFxcIlJlbW92ZSBJdGVtXFxcIiBkYXRhLWJpbmQ9XFxcImNsaWNrOiAkcGFyZW50c1sxXS5idWZmcy5pdGVtQnVmZnMucmVtb3ZlSXRlbVxcXCI+JnRpbWVzOzwvYnV0dG9uPlxcbiAgICAgICAgPGJ1dHRvbiBzdHlsZT1cXFwicGFkZGluZzozcHggMTBweDtcXFwiIGNsYXNzPVxcXCJidG4gYnRuLWRlZmF1bHQgYnRuLXhzXFxcIiB0aXRsZT1cXFwiRGlzYWJsZS9FbmFibGUgSXRlbVxcXCIgZGF0YS1iaW5kPVxcXCJjbGljazogJHBhcmVudHNbMV0uYnVmZnMuaXRlbUJ1ZmZzLnRvZ2dsZU11dGVJdGVtLCBodG1sOiBlbmFibGVkKCkgPyAnbycgOiAnLScsIGF0dHI6IHt0aXRsZTogZW5hYmxlZCgpID8gJ0Rpc2FibGUgSXRlbScgOiAnRW5hYmxlIEl0ZW0nfVxcXCI+bzwvYnV0dG9uPlxcbiAgICA8L2Rpdj5cXG48L2Rpdj5cIiB9KTtcbmtvLmNvbXBvbmVudHMucmVnaXN0ZXIoJ2l0ZW0tZGVidWZmJywgeyB0ZW1wbGF0ZTogXCI8ZGl2IGNsYXNzPVxcXCJidG4tZ3JvdXBcXFwiPlxcbiAgICA8aW1nIHN0eWxlPVxcXCJ3aWR0aDo3NXB4O1xcXCIgY2xhc3M9XFxcImltZy1yb3VuZGVkXFxcIiBkYXRhLWJpbmQ9XFxcImNzczogeyBpdGVtX2Rpc2FibGVkOiAhZW5hYmxlZCgpLCBpdGVtX2FjdGl2ZTogJHBhcmVudHNbMV0uZGVidWZmcy5pdGVtQnVmZnMuZ2V0QWN0aXZlQm9yZGVyKCRkYXRhKSA9PSAxLCBpdGVtX2luYWN0aXZlOiAkcGFyZW50c1sxXS5kZWJ1ZmZzLml0ZW1CdWZmcy5nZXRBY3RpdmVCb3JkZXIoJGRhdGEpID09IDAgfSwgYXR0cjp7IHNyYzogJHBhcmVudHNbMV0uZGVidWZmcy5pdGVtQnVmZnMuZ2V0SXRlbUltYWdlKCRkYXRhKSB9LCBjbGljazogZnVuY3Rpb24oZGF0YSwgZXZlbnQpIHsgJHBhcmVudHNbMV0uZGVidWZmcy5pdGVtQnVmZnMudG9nZ2xlSXRlbSgkaW5kZXgsIGRhdGEsIGV2ZW50KTsgfSwgZXZlbnQ6IHsgZGJsY2xpY2s6ICRwYXJlbnRzWzFdLmRlYnVmZnMuaXRlbUJ1ZmZzLnJlbW92ZUl0ZW0gfVxcXCIvPlxcbiAgICA8ZGl2IGNsYXNzPVxcXCJidG4tZ3JvdXAtdmVydGljYWxcXFwiPlxcbiAgICAgICAgPGJ1dHRvbiBzdHlsZT1cXFwicGFkZGluZzozcHggMTBweDtcXFwiIGNsYXNzPVxcXCJidG4gYnRuLWRlZmF1bHQgYnRuLXhzXFxcIiB0aXRsZT1cXFwiUmVtb3ZlIEl0ZW1cXFwiIGRhdGEtYmluZD1cXFwiY2xpY2s6ICRwYXJlbnRzWzFdLmRlYnVmZnMuaXRlbUJ1ZmZzLnJlbW92ZUl0ZW1cXFwiPiZ0aW1lczs8L2J1dHRvbj5cXG4gICAgICAgIDxidXR0b24gc3R5bGU9XFxcInBhZGRpbmc6M3B4IDEwcHg7XFxcIiBjbGFzcz1cXFwiYnRuIGJ0bi1kZWZhdWx0IGJ0bi14c1xcXCIgdGl0bGU9XFxcIkRpc2FibGUvRW5hYmxlIEl0ZW1cXFwiIGRhdGEtYmluZD1cXFwiY2xpY2s6ICRwYXJlbnRzWzFdLmRlYnVmZnMuaXRlbUJ1ZmZzLnRvZ2dsZU11dGVJdGVtLCBodG1sOiBlbmFibGVkKCkgPyAnbycgOiAnLScsIGF0dHI6IHt0aXRsZTogZW5hYmxlZCgpID8gJ0Rpc2FibGUgSXRlbScgOiAnRW5hYmxlIEl0ZW0nfVxcXCI+bzwvYnV0dG9uPlxcbiAgICA8L2Rpdj5cXG48L2Rpdj5cIiB9KTtcbmtvLmNvbXBvbmVudHMucmVnaXN0ZXIoJ2J1ZmYtc2VjdGlvbicsIHsgdGVtcGxhdGU6IFwiPGRpdiBjbGFzcz1cXFwicm93XFxcIj5cXG4gICAgPGRpdiBjbGFzcz1cXFwiY29sLW1kLTEyXFxcIj5cXG4gICAgICAgIDxoMyBjbGFzcz1cXFwic2VjdGlvbl9oZWFkZXJcXFwiIGRhdGEtYmluZD1cXFwidG9nZ2xlOiBzZWN0aW9uRGlzcGxheSgpLmJ1ZmYsIGNzczogeyBzZWN0aW9uX2Rpc2FibGVkOiAhc2VjdGlvbkRpc3BsYXkoKS5idWZmKCkgfVxcXCI+QnVmZnM8L2gzPlxcbiAgICAgICAgPGRpdiBjbGFzcz1cXFwiZm9ybS1ob3Jpem9udGFsXFxcIiBkYXRhLWJpbmQ9XFxcInZpc2libGU6IHNlY3Rpb25EaXNwbGF5KCkuYnVmZigpXFxcIj5cXG4gICAgICAgICAgICA8ZGl2IGNsYXNzPVxcXCJmb3JtLWdyb3VwXFxcIj5cXG4gICAgICAgICAgICAgICAgPGRpdiBjbGFzcz1cXFwiY29sLW1kLTZcXFwiPlxcbiAgICAgICAgICAgICAgICAgICAgPHNlbGVjdCBpZD1cXFwiYnVmZnNlbGVjdFxcXCIgY2xhc3M9XFxcImZvcm0tY29udHJvbFxcXCIgZGF0YS1iaW5kPVxcXCJvcHRpb25zOiBidWZmcy5hdmFpbGFibGVCdWZmcyAsIG9wdGlvbnNUZXh0OiAnYnVmZkRpc3BsYXlOYW1lJywgdmFsdWU6IGJ1ZmZzLnNlbGVjdGVkQnVmZlxcXCI+PC9zZWxlY3Q+XFxuICAgICAgICAgICAgICAgIDwvZGl2PlxcbiAgICAgICAgICAgICAgICA8ZGl2IGNsYXNzPVxcXCJjb2wtbWQtNlxcXCI+XFxuICAgICAgICAgICAgICAgICAgICA8YnV0dG9uIGNsYXNzPVxcXCJidG4gYnRuLWRlZmF1bHRcXFwiIGRhdGEtYmluZD1cXFwiY2xpY2s6IGJ1ZmZzLmFkZEJ1ZmZcXFwiPkFkZDwvYnV0dG9uPlxcbiAgICAgICAgICAgICAgICAgICAgPGJ1dHRvbiBjbGFzcz1cXFwiYnRuIGJ0bi1kZWZhdWx0XFxcIiBkYXRhLWJpbmQ9XFxcImNsaWNrOiBmdW5jdGlvbihkYXRhLGV2ZW50KSB7IGJ1ZmZzLnJlbW92ZUJ1ZmYoZGF0YSwgZXZlbnQsIGJ1ZmZzLnNlbGVjdGVkQnVmZigpLmJ1ZmZOYW1lKSB9XFxcIj5SZW1vdmU8L2J1dHRvbj5cXG4gICAgICAgICAgICAgICAgPC9kaXY+XFxuICAgICAgICAgICAgPC9kaXY+XFxuICAgICAgICA8L2Rpdj5cXG4gICAgICAgIDxkaXYgY2xhc3M9XFxcInJvd1xcXCIgZGF0YS1iaW5kPVxcXCJmb3JlYWNoOiBidWZmcy5idWZmcywgdmlzaWJsZTogc2VjdGlvbkRpc3BsYXkoKS5idWZmKClcXFwiPlxcbiAgICAgICAgICAgIDxkaXYgZGF0YS1iaW5kPVxcXCJjc3M6IHtyb3c6ICRkYXRhLmRhdGEuaXNEZXRhaWwoKSB8fCAoJGluZGV4KCkgPCAkcGFyZW50LmJ1ZmZzLmJ1ZmZzKCkubGVuZ3RoLTEgJiYgJHBhcmVudC5idWZmcy5idWZmcygpWyRpbmRleCgpKzFdLmRhdGEuaXNEZXRhaWwoKSksIHJvdzI6ICRkYXRhLmRhdGEuaXNEZXRhaWwoKSB8fCAoJGluZGV4KCkgPCAkcGFyZW50LmJ1ZmZzLmJ1ZmZzKCkubGVuZ3RoLTEgJiYgJHBhcmVudC5idWZmcy5idWZmcygpWyRpbmRleCgpKzFdLmRhdGEuaXNEZXRhaWwoKSkgfVxcXCI+XFxuICAgICAgICAgICAgICAgIDxkaXYgY2xhc3M9XFxcImNvbC1tZC0zIHRleHQtY2VudGVyIGJvdHRvbS1idWZmZXIyXFxcIiBkYXRhLWJpbmQ9XFxcImNzczogeydjb2wtbWQtMyc6ICRyb290LmxheW91dCgpID09IDAsICdjb2wtbWQtMic6ICRyb290LmxheW91dCgpID09IDF9XFxcIj5cXG4gICAgICAgICAgICAgICAgICAgIDxpbWcgc3R5bGU9XFxcInBhZGRpbmc6MHB4O21hcmdpbi1ib3R0b206MXB4O1xcXCIgY2xhc3M9XFxcImltZy1yb3VuZGVkIGFiaWxpdHlcXFwiIGRhdGEtYmluZD1cXFwiY3NzOiB7IGFiaWxpdHlfYWN0aXZlOiAkZGF0YS5kYXRhLmlzQWN0aXZlKCkgfHwgJGRhdGEuZGF0YS5iZWhhdmlvci5pbmRleE9mKCdET1RBX0FCSUxJVFlfQkVIQVZJT1JfUEFTU0lWRScpICE9IC0xLCBhYmlsaXR5X2luYWN0aXZlOiAhJGRhdGEuZGF0YS5pc0FjdGl2ZSgpICYmICRkYXRhLmRhdGEuYmVoYXZpb3IuaW5kZXhPZignRE9UQV9BQklMSVRZX0JFSEFWSU9SX1BBU1NJVkUnKSA9PSAtMSwgYnRuOiAkZGF0YS5kYXRhLmJlaGF2aW9yLmluZGV4T2YoJ0RPVEFfQUJJTElUWV9CRUhBVklPUl9QQVNTSVZFJykgPT0gLTEsICdidG4tZGVmYXVsdCc6ICRkYXRhLmRhdGEuYmVoYXZpb3IuaW5kZXhPZignRE9UQV9BQklMSVRZX0JFSEFWSU9SX1BBU1NJVkUnKSA9PSAtMX0sIGF0dHI6e3NyYzogJy9tZWRpYS9pbWFnZXMvc3BlbGxpY29ucy8nICsgJGRhdGEuZGF0YS5uYW1lICsgJy5wbmcnfSwgY2xpY2s6IGZ1bmN0aW9uKGRhdGEsIGV2ZW50KSB7ICRwYXJlbnQuYnVmZnMudG9nZ2xlQnVmZigkaW5kZXgsIGRhdGEuZGF0YSwgZXZlbnQpOyB9LCBldmVudDogeyBkYmxjbGljazogZnVuY3Rpb24oZGF0YSxldmVudCkgeyAkcGFyZW50LmJ1ZmZzLnJlbW92ZUJ1ZmYoZGF0YSwgZXZlbnQsICRkYXRhLmRhdGEubmFtZSkgfSB9XFxcIi8+XFxuICAgICAgICAgICAgICAgICAgICA8ZGl2IGNsYXNzPVxcXCJwcm9ncmVzc1xcXCIgc3R5bGU9XFxcInBvc2l0aW9uOnJlbGF0aXZlXFxcIj5cXG4gICAgICAgICAgICAgICAgICAgICAgICA8ZGl2IHN0eWxlPVxcXCJwb3NpdGlvbjphYnNvbHV0ZTt3aWR0aDoxMDAlO2NvbG9yOndoaXRlO1xcXCIgY2xhc3M9XFxcInRleHQtY2VudGVyXFxcIiBkYXRhLWJpbmQ9XFxcInZpc2libGU6ICRwYXJlbnQuZ2V0QWJpbGl0eUxldmVsTWF4KCRkYXRhLmRhdGEpID4gMCwgdGV4dDogJGRhdGEuZGF0YS5sZXZlbCgpICsgJy8nICsgJHBhcmVudC5nZXRBYmlsaXR5TGV2ZWxNYXgoJGRhdGEuZGF0YSlcXFwiPjwvZGl2PlxcbiAgICAgICAgICAgICAgICAgICAgICAgIDxkaXYgY2xhc3M9XFxcInByb2dyZXNzLWJhciBwcm9ncmVzcy1iYXItZGFuZ2VyXFxcIiByb2xlPVxcXCJwcm9ncmVzc2JhclxcXCIgYXJpYS12YWx1ZW5vdz1cXFwiNjBcXFwiIGFyaWEtdmFsdWVtaW49XFxcIjBcXFwiIGFyaWEtdmFsdWVtYXg9XFxcIjEwMFxcXCIgc3R5bGU9XFxcIndpZHRoOiA2MCU7XFxcIiBkYXRhLWJpbmQ9XFxcImF0dHI6IHsgJ2FyaWEtdmFsdWVub3cnOiAoJHBhcmVudC5nZXRBYmlsaXR5TGV2ZWxNYXgoJGRhdGEuZGF0YSkgPiAwID8gJGRhdGEuZGF0YS5sZXZlbCgpLyRwYXJlbnQuZ2V0QWJpbGl0eUxldmVsTWF4KCRkYXRhLmRhdGEpKjEwMCA6IDApIH0sIHN0eWxlOiB7IHdpZHRoOiAoJHBhcmVudC5nZXRBYmlsaXR5TGV2ZWxNYXgoJGRhdGEuZGF0YSkgPiAwID8gJGRhdGEuZGF0YS5sZXZlbCgpLyRwYXJlbnQuZ2V0QWJpbGl0eUxldmVsTWF4KCRkYXRhLmRhdGEpKjEwMCA6IDApICsgJyUnIH1cXFwiPjwvZGl2PlxcbiAgICAgICAgICAgICAgICAgICAgPC9kaXY+XFxuICAgICAgICAgICAgICAgICAgICA8ZGl2IGNsYXNzPVxcXCJidG4tZ3JvdXAgYnRuLWdyb3VwLWp1c3RpZmllZFxcXCIgZGF0YS1iaW5kPVxcXCJpZjogJGRhdGEuZGF0YS5iZWhhdmlvci5pbmRleE9mKCdET1RBX0FCSUxJVFlfQkVIQVZJT1JfTk9UX0xFQVJOQUJMRScpID09IC0xXFxcIj5cXG4gICAgICAgICAgICAgICAgICAgICAgICA8YSBjbGFzcz1cXFwiYnRuIGJ0bi1kZWZhdWx0IGJ0bi1zbVxcXCIgZGF0YS1iaW5kPVxcXCJjbGljazogZnVuY3Rpb24oZGF0YSwgZXZlbnQpIHsgJHBhcmVudC5idWZmcy5sZXZlbERvd25BYmlsaXR5KCRpbmRleCwgZGF0YS5kYXRhLCBldmVudCwgJHBhcmVudCk7IH1cXFwiPi08L2E+XFxuICAgICAgICAgICAgICAgICAgICAgICAgPGEgY2xhc3M9XFxcImJ0biBidG4tZGVmYXVsdCBidG4tc21cXFwiIGRhdGEtYmluZD1cXFwiY2xpY2s6IGZ1bmN0aW9uKGRhdGEsIGV2ZW50KSB7ICRwYXJlbnQuYnVmZnMubGV2ZWxVcEFiaWxpdHkoJGluZGV4LCBkYXRhLmRhdGEsIGV2ZW50LCAkcGFyZW50KTsgfVxcXCI+KzwvYT5cXG4gICAgICAgICAgICAgICAgICAgIDwvZGl2PlxcbiAgICAgICAgICAgICAgICAgICAgPGRpdiBjbGFzcz1cXFwiYnRuLWdyb3VwIGJ0bi1ncm91cC1qdXN0aWZpZWRcXFwiPlxcbiAgICAgICAgICAgICAgICAgICAgICAgIDxhIGNsYXNzPVxcXCJidG4gYnRuLWRlZmF1bHQgYnRuLXNtXFxcIiBkYXRhLWJpbmQ9XFxcImNsaWNrOiBmdW5jdGlvbihkYXRhLCBldmVudCkgeyAkcGFyZW50LmJ1ZmZzLnRvZ2dsZUJ1ZmZEZXRhaWwoJGluZGV4LCBkYXRhLCBldmVudCk7IH0sIGNzczogeyd0b2dnbGVkJzogJGRhdGEuZGF0YS5pc0RldGFpbH1cXFwiPkRldGFpbHM8L2E+XFxuICAgICAgICAgICAgICAgICAgICA8L2Rpdj5cXG4gICAgICAgICAgICAgICAgPC9kaXY+XFxuICAgICAgICAgICAgICAgIDxkaXYgY2xhc3M9XFxcImNvbC1tZC05IGJvdHRvbS1idWZmZXJcXFwiIGRhdGEtYmluZD1cXFwidmlzaWJsZTogJGRhdGEuZGF0YS5pc0RldGFpbCgpXFxcIj5cXG4gICAgICAgICAgICAgICAgICAgIDxidXR0b24gdHlwZT1cXFwiYnV0dG9uXFxcIiBjbGFzcz1cXFwiY2xvc2VcXFwiIGRhdGEtYmluZD1cXFwiY2xpY2s6IGZ1bmN0aW9uKGRhdGEsIGV2ZW50KSB7ICRwYXJlbnQuYnVmZnMudG9nZ2xlQnVmZkRldGFpbCgkaW5kZXgsIGRhdGEuZGF0YSwgZXZlbnQpOyB9XFxcIj4mdGltZXM7PC9idXR0b24+XFxuICAgICAgICAgICAgICAgICAgICA8ZGl2IGRhdGEtYmluZD1cXFwiaHRtbDogJHBhcmVudC5hYmlsaXR5KCkuZ2V0QWJpbGl0eVRvb2x0aXBEYXRhKCRkYXRhLmhlcm8sICRkYXRhLmRhdGEubmFtZSlcXFwiPjwvZGl2PlxcbiAgICAgICAgICAgICAgICAgICAgPGRpdiBkYXRhLWJpbmQ9XFxcImlmOiAkZGF0YS5kYXRhLm5hbWUgaW4gJHBhcmVudC5idWZmcy5hYmlsaXR5RGF0YSAmJiAkcGFyZW50LmJ1ZmZzLmJ1ZmZzKClbJGluZGV4KCldLmRhdGEubGV2ZWwoKSA+IDBcXFwiPlxcbiAgICAgICAgICAgICAgICAgICAgICAgIDxkaXYgY2xhc3M9XFxcImNvbC1tZC04XFxcIj5cXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgPGRpdiBkYXRhLWJpbmQ9XFxcImNvbXBvbmVudDogeyBuYW1lOiAnYnVmZi1zZXR0aW5ncycsIHBhcmFtczogJHBhcmVudC5idWZmcy5hYmlsaXR5U2V0dGluZ3NEYXRhKCRkYXRhLmRhdGEubmFtZSwgJHBhcmVudCwgJGluZGV4KCkpIH1cXFwiPjwvZGl2PlxcbiAgICAgICAgICAgICAgICAgICAgICAgIDwvZGl2PlxcbiAgICAgICAgICAgICAgICAgICAgPC9kaXY+XFxuICAgICAgICAgICAgICAgIDwvZGl2PlxcbiAgICAgICAgICAgIDwvZGl2PlxcbiAgICAgICAgPC9kaXY+XFxuICAgICAgICBcXG4gICAgICAgIDxkaXYgY2xhc3M9XFxcImZvcm0taG9yaXpvbnRhbFxcXCIgZGF0YS1iaW5kPVxcXCJ2aXNpYmxlOiBzZWN0aW9uRGlzcGxheSgpLmJ1ZmYoKVxcXCI+XFxuICAgICAgICAgICAgPGRpdiBjbGFzcz1cXFwiZm9ybS1ncm91cFxcXCI+XFxuICAgICAgICAgICAgICAgIDxkaXYgY2xhc3M9XFxcImNvbC1tZC02XFxcIj5cXG4gICAgICAgICAgICAgICAgICAgIDxkaXYgY2xhc3M9XFxcImlucHV0LWdyb3VwXFxcIj5cXG4gICAgICAgICAgICAgICAgICAgICAgICA8aW5wdXQgY2xhc3M9XFxcImZvcm0tY29udHJvbFxcXCIgaWQ9XFxcImF1dG8yXFxcIiBkYXRhLWJpbmQ9XFxcImF0dHI6IHtpZDogaWQoKSArICctYXV0bzInIH0sIGpxQXV0bzogeyBhdXRvRm9jdXM6IHRydWUsIGh0bWw6IHRydWUgfSwganFBdXRvU291cmNlOiBidWZmcy5pdGVtQnVmZnMuaXRlbUJ1ZmZPcHRpb25zLCBqcUF1dG9WYWx1ZTogYnVmZnMuaXRlbUJ1ZmZzLnNlbGVjdGVkSXRlbUJ1ZmYsIGpxQXV0b1NvdXJjZUxhYmVsOiAnZGlzcGxheW5hbWUnLCBqcUF1dG9Tb3VyY2VJbnB1dFZhbHVlOiAnbmFtZScsIGpxQXV0b1NvdXJjZVZhbHVlOiAndmFsdWUnXFxcIiAvPlxcbiAgICAgICAgICAgICAgICAgICAgICAgIDxzcGFuIGNsYXNzPVxcXCJpbnB1dC1ncm91cC1idG5cXFwiPlxcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICA8YnV0dG9uIGNsYXNzPVxcXCJidG4gYnRuLWRlZmF1bHRcXFwiIGRhdGEtYmluZD1cXFwianFBdXRvQ29tYm86IGlkKCkgKyAnLWF1dG8yJ1xcXCI+PHNwYW4gY2xhc3M9XFxcImdseXBoaWNvbiBnbHlwaGljb24tc2VhcmNoXFxcIj48L3NwYW4+PC9idXR0b24+XFxuICAgICAgICAgICAgICAgICAgICAgICAgPC9zcGFuPlxcbiAgICAgICAgICAgICAgICAgICAgPC9kaXY+XFxuICAgICAgICAgICAgICAgIDwvZGl2PlxcbiAgICAgICAgICAgICAgICA8ZGl2IGNsYXNzPVxcXCJjb2wtbWQtNlxcXCI+XFxuICAgICAgICAgICAgICAgICAgICA8YnV0dG9uIGNsYXNzPVxcXCJidG4gYnRuLWRlZmF1bHRcXFwiIGRhdGEtYmluZD1cXFwiY2xpY2s6IGJ1ZmZzLml0ZW1CdWZmcy5hZGRJdGVtQnVmZlxcXCI+QWRkPC9idXR0b24+XFxuICAgICAgICAgICAgICAgIDwvZGl2PlxcbiAgICAgICAgICAgIDwvZGl2PlxcbiAgICAgICAgPC9kaXY+XFxuICAgICAgICA8ZGl2IGRhdGEtYmluZD1cXFwiZm9yZWFjaDogYnVmZnMuaXRlbUJ1ZmZzLml0ZW1zLCB2aXNpYmxlOiBzZWN0aW9uRGlzcGxheSgpLmJ1ZmYoKVxcXCI+XFxuICAgICAgICAgICAgPGRpdiBjbGFzcz1cXFwicHVsbC1sZWZ0XFxcIiBzdHlsZT1cXFwibWFyZ2luLXJpZ2h0OjEwcHhcXFwiIGRhdGEtYmluZD1cXFwiY29tcG9uZW50OiB7IG5hbWU6ICdpdGVtLWJ1ZmYnLCBwYXJhbXM6ICRkYXRhfVxcXCI+PC9kaXY+XFxuICAgICAgICA8L2Rpdj5cXG4gICAgPC9kaXY+XFxuPC9kaXY+XFxuXFxuPGRpdiBjbGFzcz1cXFwicm93XFxcIj5cXG4gICAgPGRpdiBjbGFzcz1cXFwiY29sLW1kLTEyXFxcIj5cXG4gICAgICAgIDxoMyBjbGFzcz1cXFwic2VjdGlvbl9oZWFkZXJcXFwiIGRhdGEtYmluZD1cXFwidG9nZ2xlOiBzZWN0aW9uRGlzcGxheSgpLmRlYnVmZiwgY3NzOiB7IHNlY3Rpb25fZGlzYWJsZWQ6ICFzZWN0aW9uRGlzcGxheSgpLmRlYnVmZigpIH1cXFwiPkRlYnVmZnM8L2gzPlxcbiAgICAgICAgPGRpdiBjbGFzcz1cXFwiZm9ybS1ob3Jpem9udGFsXFxcIiBkYXRhLWJpbmQ9XFxcInZpc2libGU6IHNlY3Rpb25EaXNwbGF5KCkuZGVidWZmKClcXFwiPlxcbiAgICAgICAgICAgIDxkaXYgY2xhc3M9XFxcImZvcm0tZ3JvdXBcXFwiPlxcbiAgICAgICAgICAgICAgICA8ZGl2IGNsYXNzPVxcXCJjb2wtbWQtNlxcXCI+XFxuICAgICAgICAgICAgICAgICAgICA8c2VsZWN0IGlkPVxcXCJidWZmc2VsZWN0XFxcIiBjbGFzcz1cXFwiZm9ybS1jb250cm9sXFxcIiBkYXRhLWJpbmQ9XFxcIm9wdGlvbnM6IGRlYnVmZnMuYXZhaWxhYmxlRGVidWZmcyAsIG9wdGlvbnNUZXh0OiAnYnVmZkRpc3BsYXlOYW1lJywgdmFsdWU6IGRlYnVmZnMuc2VsZWN0ZWRCdWZmXFxcIj48L3NlbGVjdD5cXG4gICAgICAgICAgICAgICAgPC9kaXY+XFxuICAgICAgICAgICAgICAgIDxkaXYgY2xhc3M9XFxcImNvbC1tZC02XFxcIj5cXG4gICAgICAgICAgICAgICAgICAgIDxidXR0b24gY2xhc3M9XFxcImJ0biBidG4tZGVmYXVsdFxcXCIgZGF0YS1iaW5kPVxcXCJjbGljazogZGVidWZmcy5hZGRCdWZmXFxcIj5BZGQ8L2J1dHRvbj5cXG4gICAgICAgICAgICAgICAgICAgIDxidXR0b24gY2xhc3M9XFxcImJ0biBidG4tZGVmYXVsdFxcXCIgZGF0YS1iaW5kPVxcXCJjbGljazogZnVuY3Rpb24oZGF0YSxldmVudCkgeyBkZWJ1ZmZzLnJlbW92ZUJ1ZmYoZGF0YSwgZXZlbnQsIGRlYnVmZnMuc2VsZWN0ZWRCdWZmKCkuYnVmZk5hbWUpIH1cXFwiPlJlbW92ZTwvYnV0dG9uPlxcbiAgICAgICAgICAgICAgICA8L2Rpdj5cXG4gICAgICAgICAgICA8L2Rpdj5cXG4gICAgICAgIDwvZGl2PlxcblxcbiAgICAgICAgPGRpdiBjbGFzcz1cXFwicm93XFxcIiBkYXRhLWJpbmQ9XFxcImZvcmVhY2g6IGRlYnVmZnMuYnVmZnMsIHZpc2libGU6IHNlY3Rpb25EaXNwbGF5KCkuZGVidWZmKClcXFwiPlxcbiAgICAgICAgICAgIDxkaXYgZGF0YS1iaW5kPVxcXCJjc3M6IHtyb3c6ICRkYXRhLmRhdGEuaXNEZXRhaWwoKSB8fCAoJGluZGV4KCkgPCAkcGFyZW50LmRlYnVmZnMuYnVmZnMoKS5sZW5ndGgtMSAmJiAkcGFyZW50LmRlYnVmZnMuYnVmZnMoKVskaW5kZXgoKSsxXS5kYXRhLmlzRGV0YWlsKCkpLCByb3cyOiAkZGF0YS5kYXRhLmlzRGV0YWlsKCkgfHwgKCRpbmRleCgpIDwgJHBhcmVudC5kZWJ1ZmZzLmJ1ZmZzKCkubGVuZ3RoLTEgJiYgJHBhcmVudC5kZWJ1ZmZzLmJ1ZmZzKClbJGluZGV4KCkrMV0uZGF0YS5pc0RldGFpbCgpKSB9XFxcIj5cXG4gICAgICAgICAgICAgICAgPGRpdiBjbGFzcz1cXFwiY29sLW1kLTMgdGV4dC1jZW50ZXIgYm90dG9tLWJ1ZmZlcjJcXFwiIGRhdGEtYmluZD1cXFwiY3NzOiB7J2NvbC1tZC0zJzogJHJvb3QubGF5b3V0KCkgPT0gMCwgJ2NvbC1tZC0yJzogJHJvb3QubGF5b3V0KCkgPT0gMX1cXFwiPlxcbiAgICAgICAgICAgICAgICAgICAgPGltZyBzdHlsZT1cXFwicGFkZGluZzowcHg7bWFyZ2luLWJvdHRvbToxcHg7XFxcIiBjbGFzcz1cXFwiaW1nLXJvdW5kZWQgYWJpbGl0eVxcXCIgZGF0YS1iaW5kPVxcXCJjc3M6IHsgYWJpbGl0eV9hY3RpdmU6ICRkYXRhLmRhdGEuaXNBY3RpdmUoKSB8fCAkZGF0YS5kYXRhLmJlaGF2aW9yLmluZGV4T2YoJ0RPVEFfQUJJTElUWV9CRUhBVklPUl9QQVNTSVZFJykgIT0gLTEsIGFiaWxpdHlfaW5hY3RpdmU6ICEkZGF0YS5kYXRhLmlzQWN0aXZlKCkgJiYgJGRhdGEuZGF0YS5iZWhhdmlvci5pbmRleE9mKCdET1RBX0FCSUxJVFlfQkVIQVZJT1JfUEFTU0lWRScpID09IC0xLCBidG46ICRkYXRhLmRhdGEuYmVoYXZpb3IuaW5kZXhPZignRE9UQV9BQklMSVRZX0JFSEFWSU9SX1BBU1NJVkUnKSA9PSAtMSwgJ2J0bi1kZWZhdWx0JzogJGRhdGEuZGF0YS5iZWhhdmlvci5pbmRleE9mKCdET1RBX0FCSUxJVFlfQkVIQVZJT1JfUEFTU0lWRScpID09IC0xfSwgYXR0cjp7c3JjOiAnL21lZGlhL2ltYWdlcy9zcGVsbGljb25zLycgKyAkZGF0YS5kYXRhLm5hbWUgKyAnLnBuZyd9LCBjbGljazogZnVuY3Rpb24oZGF0YSwgZXZlbnQpIHsgJHBhcmVudC5kZWJ1ZmZzLnRvZ2dsZUJ1ZmYoJGluZGV4LCBkYXRhLmRhdGEsIGV2ZW50KTsgfSwgZXZlbnQ6IHsgZGJsY2xpY2s6IGZ1bmN0aW9uKGRhdGEsZXZlbnQpIHsgJHBhcmVudC5kZWJ1ZmZzLnJlbW92ZUJ1ZmYoZGF0YSwgZXZlbnQsICRkYXRhLmRhdGEubmFtZSkgfSB9XFxcIi8+XFxuICAgICAgICAgICAgICAgICAgICA8ZGl2IGNsYXNzPVxcXCJwcm9ncmVzc1xcXCIgc3R5bGU9XFxcInBvc2l0aW9uOnJlbGF0aXZlXFxcIj5cXG4gICAgICAgICAgICAgICAgICAgICAgICA8ZGl2IHN0eWxlPVxcXCJwb3NpdGlvbjphYnNvbHV0ZTt3aWR0aDoxMDAlO2NvbG9yOndoaXRlO1xcXCIgY2xhc3M9XFxcInRleHQtY2VudGVyXFxcIiBkYXRhLWJpbmQ9XFxcInZpc2libGU6ICRwYXJlbnQuZ2V0QWJpbGl0eUxldmVsTWF4KCRkYXRhLmRhdGEpID4gMCwgdGV4dDogJGRhdGEuZGF0YS5sZXZlbCgpICsgJy8nICsgJHBhcmVudC5nZXRBYmlsaXR5TGV2ZWxNYXgoJGRhdGEuZGF0YSlcXFwiPjwvZGl2PlxcbiAgICAgICAgICAgICAgICAgICAgICAgIDxkaXYgY2xhc3M9XFxcInByb2dyZXNzLWJhciBwcm9ncmVzcy1iYXItZGFuZ2VyXFxcIiByb2xlPVxcXCJwcm9ncmVzc2JhclxcXCIgYXJpYS12YWx1ZW5vdz1cXFwiNjBcXFwiIGFyaWEtdmFsdWVtaW49XFxcIjBcXFwiIGFyaWEtdmFsdWVtYXg9XFxcIjEwMFxcXCIgc3R5bGU9XFxcIndpZHRoOiA2MCU7XFxcIiBkYXRhLWJpbmQ9XFxcImF0dHI6IHsgJ2FyaWEtdmFsdWVub3cnOiAoJHBhcmVudC5nZXRBYmlsaXR5TGV2ZWxNYXgoJGRhdGEuZGF0YSkgPiAwID8gJGRhdGEuZGF0YS5sZXZlbCgpLyRwYXJlbnQuZ2V0QWJpbGl0eUxldmVsTWF4KCRkYXRhLmRhdGEpKjEwMCA6IDApIH0sIHN0eWxlOiB7IHdpZHRoOiAoJHBhcmVudC5nZXRBYmlsaXR5TGV2ZWxNYXgoJGRhdGEuZGF0YSkgPiAwID8gJGRhdGEuZGF0YS5sZXZlbCgpLyRwYXJlbnQuZ2V0QWJpbGl0eUxldmVsTWF4KCRkYXRhLmRhdGEpKjEwMCA6IDApICsgJyUnIH1cXFwiPjwvZGl2PlxcbiAgICAgICAgICAgICAgICAgICAgPC9kaXY+XFxuICAgICAgICAgICAgICAgICAgICA8ZGl2IGNsYXNzPVxcXCJidG4tZ3JvdXAgYnRuLWdyb3VwLWp1c3RpZmllZFxcXCIgZGF0YS1iaW5kPVxcXCJpZjogJGRhdGEuZGF0YS5iZWhhdmlvci5pbmRleE9mKCdET1RBX0FCSUxJVFlfQkVIQVZJT1JfTk9UX0xFQVJOQUJMRScpID09IC0xXFxcIj5cXG4gICAgICAgICAgICAgICAgICAgICAgICA8YSBjbGFzcz1cXFwiYnRuIGJ0bi1kZWZhdWx0IGJ0bi1zbVxcXCIgZGF0YS1iaW5kPVxcXCJjbGljazogZnVuY3Rpb24oZGF0YSwgZXZlbnQpIHsgJHBhcmVudC5kZWJ1ZmZzLmxldmVsRG93bkFiaWxpdHkoJGluZGV4LCBkYXRhLmRhdGEsIGV2ZW50LCAkcGFyZW50KTsgfVxcXCI+LTwvYT5cXG4gICAgICAgICAgICAgICAgICAgICAgICA8YSBjbGFzcz1cXFwiYnRuIGJ0bi1kZWZhdWx0IGJ0bi1zbVxcXCIgZGF0YS1iaW5kPVxcXCJjbGljazogZnVuY3Rpb24oZGF0YSwgZXZlbnQpIHsgJHBhcmVudC5kZWJ1ZmZzLmxldmVsVXBBYmlsaXR5KCRpbmRleCwgZGF0YS5kYXRhLCBldmVudCwgJHBhcmVudCk7IH1cXFwiPis8L2E+XFxuICAgICAgICAgICAgICAgICAgICA8L2Rpdj5cXG4gICAgICAgICAgICAgICAgICAgIDxkaXYgY2xhc3M9XFxcImJ0bi1ncm91cCBidG4tZ3JvdXAtanVzdGlmaWVkXFxcIj5cXG4gICAgICAgICAgICAgICAgICAgICAgICA8YSBjbGFzcz1cXFwiYnRuIGJ0bi1kZWZhdWx0IGJ0bi1zbVxcXCIgZGF0YS1iaW5kPVxcXCJjbGljazogZnVuY3Rpb24oZGF0YSwgZXZlbnQpIHsgJHBhcmVudC5kZWJ1ZmZzLnRvZ2dsZUJ1ZmZEZXRhaWwoJGluZGV4LCBkYXRhLCBldmVudCk7IH0sIGNzczogeyd0b2dnbGVkJzogJGRhdGEuZGF0YS5pc0RldGFpbH1cXFwiPkRldGFpbHM8L2E+XFxuICAgICAgICAgICAgICAgICAgICA8L2Rpdj5cXG4gICAgICAgICAgICAgICAgPC9kaXY+XFxuICAgICAgICAgICAgICAgIDxkaXYgY2xhc3M9XFxcImNvbC1tZC05IGJvdHRvbS1idWZmZXJcXFwiIGRhdGEtYmluZD1cXFwidmlzaWJsZTogJGRhdGEuZGF0YS5pc0RldGFpbCgpXFxcIj5cXG4gICAgICAgICAgICAgICAgICAgIDxidXR0b24gdHlwZT1cXFwiYnV0dG9uXFxcIiBjbGFzcz1cXFwiY2xvc2VcXFwiIGRhdGEtYmluZD1cXFwiY2xpY2s6IGZ1bmN0aW9uKGRhdGEsIGV2ZW50KSB7ICRwYXJlbnQuZGVidWZmcy50b2dnbGVCdWZmRGV0YWlsKCRpbmRleCwgZGF0YS5kYXRhLCBldmVudCk7IH1cXFwiPiZ0aW1lczs8L2J1dHRvbj5cXG4gICAgICAgICAgICAgICAgICAgIDxkaXYgZGF0YS1iaW5kPVxcXCJodG1sOiAkcGFyZW50LmFiaWxpdHkoKS5nZXRBYmlsaXR5VG9vbHRpcERhdGEoJGRhdGEuaGVybywgJGRhdGEuZGF0YS5uYW1lKVxcXCI+PC9kaXY+XFxuICAgICAgICAgICAgICAgICAgICA8ZGl2IGRhdGEtYmluZD1cXFwiaWY6ICRkYXRhLmRhdGEubmFtZSBpbiAkcGFyZW50LmRlYnVmZnMuYWJpbGl0eURhdGEgJiYgJHBhcmVudC5kZWJ1ZmZzLmJ1ZmZzKClbJGluZGV4KCldLmRhdGEubGV2ZWwoKSA+IDBcXFwiPlxcbiAgICAgICAgICAgICAgICAgICAgICAgIDxkaXYgY2xhc3M9XFxcImNvbC1tZC04XFxcIj5cXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgPGRpdiBkYXRhLWJpbmQ9XFxcImNvbXBvbmVudDogeyBuYW1lOiAnYnVmZi1zZXR0aW5ncycsIHBhcmFtczogJHBhcmVudC5kZWJ1ZmZzLmFiaWxpdHlTZXR0aW5nc0RhdGEoJGRhdGEuZGF0YS5uYW1lLCAkcGFyZW50LCAkaW5kZXgoKSkgfVxcXCI+PC9kaXY+XFxuICAgICAgICAgICAgICAgICAgICAgICAgPC9kaXY+XFxuICAgICAgICAgICAgICAgICAgICA8L2Rpdj5cXG4gICAgICAgICAgICAgICAgPC9kaXY+XFxuICAgICAgICAgICAgPC9kaXY+XFxuICAgICAgICA8L2Rpdj5cXG4gICAgICAgIFxcbiAgICAgICAgPGRpdiBjbGFzcz1cXFwiZm9ybS1ob3Jpem9udGFsXFxcIiBkYXRhLWJpbmQ9XFxcInZpc2libGU6IHNlY3Rpb25EaXNwbGF5KCkuZGVidWZmKClcXFwiPlxcbiAgICAgICAgICAgIDxkaXYgY2xhc3M9XFxcImZvcm0tZ3JvdXBcXFwiPlxcbiAgICAgICAgICAgICAgICA8ZGl2IGNsYXNzPVxcXCJjb2wtbWQtNlxcXCI+XFxuICAgICAgICAgICAgICAgICAgICA8ZGl2IGNsYXNzPVxcXCJpbnB1dC1ncm91cFxcXCI+XFxuICAgICAgICAgICAgICAgICAgICAgICAgPGlucHV0IGNsYXNzPVxcXCJmb3JtLWNvbnRyb2xcXFwiIGlkPVxcXCJhdXRvM1xcXCIgZGF0YS1iaW5kPVxcXCJhdHRyOiB7aWQ6IGlkKCkgKyAnLWF1dG8zJyB9LCBqcUF1dG86IHsgYXV0b0ZvY3VzOiB0cnVlLCBodG1sOiB0cnVlIH0sIGpxQXV0b1NvdXJjZTogZGVidWZmcy5pdGVtQnVmZnMuaXRlbURlYnVmZk9wdGlvbnMsIGpxQXV0b1ZhbHVlOiBkZWJ1ZmZzLml0ZW1CdWZmcy5zZWxlY3RlZEl0ZW1EZWJ1ZmYsIGpxQXV0b1NvdXJjZUxhYmVsOiAnZGlzcGxheW5hbWUnLCBqcUF1dG9Tb3VyY2VJbnB1dFZhbHVlOiAnbmFtZScsIGpxQXV0b1NvdXJjZVZhbHVlOiAndmFsdWUnXFxcIiAvPlxcbiAgICAgICAgICAgICAgICAgICAgICAgIDxzcGFuIGNsYXNzPVxcXCJpbnB1dC1ncm91cC1idG5cXFwiPlxcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICA8YnV0dG9uIGNsYXNzPVxcXCJidG4gYnRuLWRlZmF1bHRcXFwiIGRhdGEtYmluZD1cXFwianFBdXRvQ29tYm86IGlkKCkgKyAnLWF1dG8zJ1xcXCI+PHNwYW4gY2xhc3M9XFxcImdseXBoaWNvbiBnbHlwaGljb24tc2VhcmNoXFxcIj48L3NwYW4+PC9idXR0b24+XFxuICAgICAgICAgICAgICAgICAgICAgICAgPC9zcGFuPlxcbiAgICAgICAgICAgICAgICAgICAgPC9kaXY+XFxuICAgICAgICAgICAgICAgIDwvZGl2PlxcbiAgICAgICAgICAgICAgICA8ZGl2IGNsYXNzPVxcXCJjb2wtbWQtNlxcXCI+XFxuICAgICAgICAgICAgICAgICAgICA8YnV0dG9uIGNsYXNzPVxcXCJidG4gYnRuLWRlZmF1bHRcXFwiIGRhdGEtYmluZD1cXFwiY2xpY2s6IGRlYnVmZnMuaXRlbUJ1ZmZzLmFkZEl0ZW1EZWJ1ZmZcXFwiPkFkZDwvYnV0dG9uPlxcbiAgICAgICAgICAgICAgICA8L2Rpdj5cXG4gICAgICAgICAgICA8L2Rpdj5cXG4gICAgICAgIDwvZGl2PlxcbiAgICAgICAgPGRpdiBkYXRhLWJpbmQ9XFxcImZvcmVhY2g6IGRlYnVmZnMuaXRlbUJ1ZmZzLml0ZW1zLCB2aXNpYmxlOiBzZWN0aW9uRGlzcGxheSgpLmRlYnVmZigpXFxcIj5cXG4gICAgICAgICAgICA8ZGl2IGNsYXNzPVxcXCJwdWxsLWxlZnRcXFwiIHN0eWxlPVxcXCJtYXJnaW4tcmlnaHQ6MTBweFxcXCIgZGF0YS1iaW5kPVxcXCJjb21wb25lbnQ6IHsgbmFtZTogJ2l0ZW0tZGVidWZmJywgcGFyYW1zOiAkZGF0YX1cXFwiPjwvZGl2PlxcbiAgICAgICAgPC9kaXY+XFxuICAgIDwvZGl2PlxcbjwvZGl2PlwiIH0pO1xua28uY29tcG9uZW50cy5yZWdpc3RlcignZGFtYWdlLWRldGFpbHMnLCB7IHRlbXBsYXRlOiBcIjxkaXYgY2xhc3M9XFxcInJvd1xcXCI+XFxuICAgIDxkaXYgY2xhc3M9XFxcImNvbC1tZC0xMlxcXCI+XFxuICAgICAgICA8aDMgc3R5bGU9XFxcImRpc3BsYXk6YmxvY2s7XFxcIiBjbGFzcz1cXFwic2VjdGlvbl9oZWFkZXJcXFwiIGRhdGEtYmluZD1cXFwidG9nZ2xlOiBzaG93RGFtYWdlRGV0YWlscywgY3NzOiB7IHNlY3Rpb25fZGlzYWJsZWQ6ICFzaG93RGFtYWdlRGV0YWlscygpIH1cXFwiPkRhbWFnZSBEZXRhaWxzXFxuICAgICAgICAgICAgPHNwYW4gY2xhc3M9XFxcInB1bGwtcmlnaHRcXFwiIGRhdGEtYmluZD1cXFwidmlzaWJsZTogc2hvd0RhbWFnZURldGFpbHMoKVxcXCI+XFxuICAgICAgICAgICAgICAgIDxzbWFsbCBzdHlsZT1cXFwidGV4dC1hbGlnbjpjZW50ZXJcXFwiIGRhdGEtYmluZD1cXFwic3R5bGU6IHtjb2xvcjogZ2V0RGFtYWdlVHlwZUNvbG9yKCdwaHlzaWNhbCcpfVxcXCI+UGh5c2ljYWw8L3NtYWxsPlxcbiAgICAgICAgICAgICAgICA8c21hbGwgc3R5bGU9XFxcInRleHQtYWxpZ246Y2VudGVyXFxcIiBkYXRhLWJpbmQ9XFxcInN0eWxlOiB7Y29sb3I6IGdldERhbWFnZVR5cGVDb2xvcignbWFnaWMnKX1cXFwiPk1hZ2ljYWw8L3NtYWxsPlxcbiAgICAgICAgICAgICAgICA8c21hbGwgc3R5bGU9XFxcInRleHQtYWxpZ246Y2VudGVyXFxcIiBkYXRhLWJpbmQ9XFxcInN0eWxlOiB7Y29sb3I6IGdldERhbWFnZVR5cGVDb2xvcigncHVyZScpfVxcXCI+UHVyZTwvc21hbGw+XFxuICAgICAgICAgICAgPC9zcGFuPlxcbiAgICAgICAgPC9oMz5cXG4gICAgICAgIDx0YWJsZSBjbGFzcz1cXFwidGFibGUgZGFtYWdlLWRldGFpbHNcXFwiIGRhdGEtYmluZD1cXFwidmlzaWJsZTogc2hvd0RhbWFnZURldGFpbHMoKVxcXCI+XFxuICAgICAgICAgICAgPHRoZWFkPlxcbiAgICAgICAgICAgICAgICA8dHIgY2xhc3M9XFxcImRhbWFnZS1kZXRhaWxzLWhlYWRlci1yb3dcXFwiPlxcbiAgICAgICAgICAgICAgICAgICAgPHRkPjwvdGQ+XFxuICAgICAgICAgICAgICAgICAgICA8dGQgY2xhc3M9XFxcInRleHQtY2VudGVyXFxcIiBjb2xzcGFuPVxcXCIyXFxcIj48c3Ryb25nPkF0dGFjayBEYW1hZ2U8L3N0cm9uZz48aW1nIHNyYz1cXFwiaW1nL3JlZHVjX2ljb24ucG5nXFxcIiBjbGFzcz1cXFwicHVsbC1yaWdodFxcXCIgZGF0YS1iaW5kPVxcXCJhdHRyOiB7dGl0bGU6ICdBZnRlciByZWR1Y3Rpb25zIGZyb20gJyArIGVuZW15KCkuaGVyb0RhdGEoKS5kaXNwbGF5bmFtZX1cXFwiPjwvdGQ+XFxuICAgICAgICAgICAgICAgICAgICA8dGQgY2xhc3M9XFxcInRleHQtY2VudGVyXFxcIiBjb2xzcGFuPVxcXCIyXFxcIj48c3Ryb25nPkRQUzwvc3Ryb25nPjxpbWcgc3JjPVxcXCJpbWcvcmVkdWNfaWNvbi5wbmdcXFwiIGNsYXNzPVxcXCJwdWxsLXJpZ2h0XFxcIiBkYXRhLWJpbmQ9XFxcImF0dHI6IHt0aXRsZTogJ0FmdGVyIHJlZHVjdGlvbnMgZnJvbSAnICsgZW5lbXkoKS5oZXJvRGF0YSgpLmRpc3BsYXluYW1lfVxcXCI+PC90ZD5cXG4gICAgICAgICAgICAgICAgPC90cj5cXG4gICAgICAgICAgICAgICAgPHRyIGNsYXNzPVxcXCJkYW1hZ2UtZGV0YWlscy1oZWFkZXItcm93LTIgdG90YWwtcm93XFxcIj5cXG4gICAgICAgICAgICAgICAgICAgIDx0ZD48c3Ryb25nPlRvdGFsPC9zdHJvbmc+PC90ZD5cXG4gICAgICAgICAgICAgICAgICAgIDx0ZCBjbGFzcz1cXFwidGV4dC1yaWdodFxcXCIgZGF0YS1iaW5kPVxcXCJ0ZXh0OiBkYW1hZ2VUb3RhbEluZm8oKS50b3RhbFJvd1swXSgpLnRvRml4ZWQoMilcXFwiPjwvdGQ+XFxuICAgICAgICAgICAgICAgICAgICA8dGQgY2xhc3M9XFxcInRleHQtcmlnaHRcXFwiIGRhdGEtYmluZD1cXFwidGV4dDogZGFtYWdlVG90YWxJbmZvKCkudG90YWxSb3dbMV0oKS50b0ZpeGVkKDIpXFxcIj48L3RkPlxcbiAgICAgICAgICAgICAgICAgICAgPHRkIGNsYXNzPVxcXCJ0ZXh0LXJpZ2h0XFxcIiBkYXRhLWJpbmQ9XFxcInRleHQ6IGRhbWFnZVRvdGFsSW5mbygpLnRvdGFsUm93WzJdKCkudG9GaXhlZCgyKVxcXCI+PC90ZD5cXG4gICAgICAgICAgICAgICAgICAgIDx0ZCBjbGFzcz1cXFwidGV4dC1yaWdodFxcXCIgZGF0YS1iaW5kPVxcXCJ0ZXh0OiBkYW1hZ2VUb3RhbEluZm8oKS50b3RhbFJvd1szXSgpLnRvRml4ZWQoMilcXFwiPjwvdGQ+XFxuICAgICAgICAgICAgICAgIDwvdHI+XFxuICAgICAgICAgICAgPC90aGVhZD5cXG4gICAgICAgICAgICA8IS0tIGtvIGZvcmVhY2g6IGRhbWFnZVRvdGFsSW5mbygpLmF0dGFja3MgLS0+XFxuICAgICAgICAgICAgPHRib2R5PlxcbiAgICAgICAgICAgICAgICA8dHIgY2xhc3M9XFxcImluZGVudCBzdWJ0b3RhbC1yb3dcXFwiIGRhdGEtYmluZD1cXFwidG9nZ2xlOiAkZGF0YS5lbmFibGVkLCBjc3M6IHsgJ2luYWN0aXZlJzogISRkYXRhLmVuYWJsZWQoKSB9XFxcIj5cXG4gICAgICAgICAgICAgICAgICAgIDx0ZD5cXG4gICAgICAgICAgICAgICAgICAgICAgICA8YnV0dG9uIGNsYXNzPVxcXCJidG4gYnRuLWRlZmF1bHQgYnRuLXhzIGdseXBoaWNvbiBwdWxsLWxlZnRcXFwiIGRhdGEtYmluZD1cXFwidG9nZ2xlOiAkZGF0YS5lbmFibGVkLCBjc3M6IHsnZ2x5cGhpY29uLWV5ZS1vcGVuJzogJGRhdGEuZW5hYmxlZCgpLCAnZ2x5cGhpY29uLWV5ZS1jbG9zZSc6ICEkZGF0YS5lbmFibGVkKCl9LCBwcmV2ZW50QnViYmxlOiAnY2xpY2snXFxcIj48L2J1dHRvbj5cXG4gICAgICAgICAgICAgICAgICAgICAgICA8YnV0dG9uIGNsYXNzPVxcXCJidG4gYnRuLWRlZmF1bHQgYnRuLXhzIGdseXBoaWNvbiBwdWxsLXJpZ2h0XFxcIiBkYXRhLWJpbmQ9XFxcInRvZ2dsZTogJGRhdGEudmlzaWJsZSwgY3NzOiB7J2dseXBoaWNvbi1taW51cyc6ICRkYXRhLnZpc2libGUoKSwgJ2dseXBoaWNvbi1wbHVzJzogISRkYXRhLnZpc2libGUoKX0sIHByZXZlbnRCdWJibGU6ICdjbGljaydcXFwiPjwvYnV0dG9uPlxcbiAgICAgICAgICAgICAgICAgICAgICAgIDxzdHJvbmc+PHNwYW4gZGF0YS1iaW5kPVxcXCJ0ZXh0OiAkZGF0YS5uYW1lXFxcIj48L3NwYW4+PC9zdHJvbmc+XFxuICAgICAgICAgICAgICAgICAgICA8L3RkPlxcbiAgICAgICAgICAgICAgICAgICAgPHRkIGNsYXNzPVxcXCJ0ZXh0LXJpZ2h0XFxcIiBkYXRhLWJpbmQ9XFxcInRleHQ6ICRkYXRhLnRvdGFsUm93WzBdKCkudG9GaXhlZCgyKVxcXCI+PC90ZD5cXG4gICAgICAgICAgICAgICAgICAgIDx0ZCBjbGFzcz1cXFwidGV4dC1yaWdodFxcXCIgZGF0YS1iaW5kPVxcXCJ0ZXh0OiAkZGF0YS50b3RhbFJvd1sxXSgpLnRvRml4ZWQoMilcXFwiPjwvdGQ+XFxuICAgICAgICAgICAgICAgICAgICA8dGQgY2xhc3M9XFxcInRleHQtcmlnaHRcXFwiIGRhdGEtYmluZD1cXFwidGV4dDogJGRhdGEudG90YWxSb3dbMl0oKS50b0ZpeGVkKDIpXFxcIj48L3RkPlxcbiAgICAgICAgICAgICAgICAgICAgPHRkIGNsYXNzPVxcXCJ0ZXh0LXJpZ2h0XFxcIiBkYXRhLWJpbmQ9XFxcInRleHQ6ICRkYXRhLnRvdGFsUm93WzNdKCkudG9GaXhlZCgyKVxcXCI+PC90ZD5cXG4gICAgICAgICAgICAgICAgPC90cj5cXG4gICAgICAgICAgICA8L3Rib2R5PlxcbiAgICAgICAgICAgIDx0Ym9keSBjbGFzcz1cXFwiaW5kZW50XFxcIiBkYXRhLWJpbmQ9XFxcImZvcmVhY2g6ICRkYXRhLnNvdXJjZXMsIHZpc2libGU6ICRkYXRhLnZpc2libGVcXFwiPlxcbiAgICAgICAgICAgICAgICA8dHIgZGF0YS1iaW5kPVxcXCJ0b2dnbGU6ICRkYXRhLmVuYWJsZWQsIGNzczogeyAnaW5hY3RpdmUnOiAhJGRhdGEuZW5hYmxlZCgpIH1cXFwiPlxcbiAgICAgICAgICAgICAgICAgICAgPHRkIGNsYXNzPVxcXCJpbmRlbnRcXFwiPlxcbiAgICAgICAgICAgICAgICAgICAgICAgIDxzcGFuIGRhdGEtYmluZD1cXFwidGV4dDogJGRhdGEubmFtZVxcXCI+PC9zcGFuPlxcbiAgICAgICAgICAgICAgICAgICAgICAgIDxidXR0b24gY2xhc3M9XFxcImJ0biBidG4tZGVmYXVsdCBidG4teHMgZ2x5cGhpY29uIHB1bGwtbGVmdFxcXCIgZGF0YS1iaW5kPVxcXCJ0b2dnbGU6ICRkYXRhLmVuYWJsZWQsIGNzczogeydnbHlwaGljb24tZXllLW9wZW4nOiAkZGF0YS5lbmFibGVkKCksICdnbHlwaGljb24tZXllLWNsb3NlJzogISRkYXRhLmVuYWJsZWQoKX0sIHByZXZlbnRCdWJibGU6ICdjbGljaydcXFwiPjwvYnV0dG9uPlxcbiAgICAgICAgICAgICAgICAgICAgPC90ZD5cXG4gICAgICAgICAgICAgICAgICAgIDx0ZCBjbGFzcz1cXFwidGV4dC1yaWdodFxcXCI+PHNwYW4gZGF0YS1iaW5kPVxcXCJodG1sOiAkZGF0YS5kYW1hZ2UudG9GaXhlZCgyKSwgc3R5bGU6IHtjb2xvcjogJHBhcmVudHNbMV0uZ2V0RGFtYWdlVHlwZUNvbG9yKCRkYXRhLmRhbWFnZVR5cGUpfVxcXCI+PC9zcGFuPjwvdGQ+XFxuICAgICAgICAgICAgICAgICAgICA8dGQgY2xhc3M9XFxcInRleHQtcmlnaHRcXFwiPjxzcGFuIGRhdGEtYmluZD1cXFwiaHRtbDogJGRhdGEuZGFtYWdlUmVkdWNlZC50b0ZpeGVkKDIpLCBzdHlsZToge2NvbG9yOiAkcGFyZW50c1sxXS5nZXREYW1hZ2VUeXBlQ29sb3IoJGRhdGEuZGFtYWdlVHlwZSl9XFxcIj48L3NwYW4+PC90ZD5cXG4gICAgICAgICAgICAgICAgICAgIDx0ZCBjbGFzcz1cXFwidGV4dC1yaWdodFxcXCI+PHNwYW4gZGF0YS1iaW5kPVxcXCJodG1sOiAkZGF0YS5kcHMudG9GaXhlZCgyKSwgc3R5bGU6IHtjb2xvcjogJHBhcmVudHNbMV0uZ2V0RGFtYWdlVHlwZUNvbG9yKCRkYXRhLmRhbWFnZVR5cGUpfVxcXCI+PC9zcGFuPjwvdGQ+XFxuICAgICAgICAgICAgICAgICAgICA8dGQgY2xhc3M9XFxcInRleHQtcmlnaHRcXFwiPjxzcGFuIGRhdGEtYmluZD1cXFwiaHRtbDogJGRhdGEuZHBzUmVkdWNlZC50b0ZpeGVkKDIpLCBzdHlsZToge2NvbG9yOiAkcGFyZW50c1sxXS5nZXREYW1hZ2VUeXBlQ29sb3IoJGRhdGEuZGFtYWdlVHlwZSl9XFxcIj48L3NwYW4+PC90ZD5cXG4gICAgICAgICAgICAgICAgPC90cj5cXG4gICAgICAgICAgICA8L3Rib2R5PlxcbiAgICAgICAgICAgIDx0ciBjbGFzcz1cXFwiaW5kZW50IGNyaXRcXFwiIGRhdGEtYmluZD1cXFwidmlzaWJsZTogJGRhdGEudmlzaWJsZSgpICYmICRkYXRhLnNvdXJjZXNDcml0Lmxlbmd0aCA+IDBcXFwiPlxcbiAgICAgICAgICAgICAgICA8dGQgY2xhc3M9XFxcImluZGVudFxcXCI+Q3JpdGljYWwgU3RyaWtlIFByb2MsIDxzcGFuIGRhdGEtYmluZD1cXFwidGV4dDogKCRkYXRhLnRvdGFsQ3JpdENoYW5jZSAqIDEwMCkudG9GaXhlZCgxKSArICclJ1xcXCI+PC9zcGFuPjwvdGQ+XFxuICAgICAgICAgICAgICAgIDx0ZCBjbGFzcz1cXFwidGV4dC1yaWdodFxcXCIgZGF0YS1iaW5kPVxcXCJ0ZXh0OiAkZGF0YS50b3RhbENyaXRSb3dbMF0oKS50b0ZpeGVkKDIpXFxcIj48L3RkPlxcbiAgICAgICAgICAgICAgICA8dGQgY2xhc3M9XFxcInRleHQtcmlnaHRcXFwiIGRhdGEtYmluZD1cXFwidGV4dDogJGRhdGEudG90YWxDcml0Um93WzFdKCkudG9GaXhlZCgyKVxcXCI+PC90ZD5cXG4gICAgICAgICAgICAgICAgPHRkIGNsYXNzPVxcXCJ0ZXh0LXJpZ2h0XFxcIiBkYXRhLWJpbmQ9XFxcInRleHQ6ICRkYXRhLnRvdGFsQ3JpdFJvd1syXSgpLnRvRml4ZWQoMilcXFwiPjwvdGQ+XFxuICAgICAgICAgICAgICAgIDx0ZCBjbGFzcz1cXFwidGV4dC1yaWdodFxcXCIgZGF0YS1iaW5kPVxcXCJ0ZXh0OiAkZGF0YS50b3RhbENyaXRSb3dbM10oKS50b0ZpeGVkKDIpXFxcIj48L3RkPlxcbiAgICAgICAgICAgIDwvdHI+XFxuICAgICAgICAgICAgPHRib2R5IGNsYXNzPVxcXCJpbmRlbnRcXFwiIGRhdGEtYmluZD1cXFwidmlzaWJsZTogJGRhdGEudmlzaWJsZSwgZm9yZWFjaDogJGRhdGEuc291cmNlc0NyaXRcXFwiPlxcbiAgICAgICAgICAgICAgICA8dHIgY2xhc3M9XFxcImluZGVudCBjcml0XFxcIiBkYXRhLWJpbmQ9XFxcInRvZ2dsZTogJGRhdGEuZW5hYmxlZCwgY3NzOiB7ICdpbmFjdGl2ZSc6ICEkZGF0YS5lbmFibGVkKCkgfVxcXCI+XFxuICAgICAgICAgICAgICAgICAgICA8dGQgY2xhc3M9XFxcImluZGVudFxcXCI+XFxuICAgICAgICAgICAgICAgICAgICAgICAgPHNwYW4gZGF0YS1iaW5kPVxcXCJ0ZXh0OiAkZGF0YS5uYW1lXFxcIj48L3NwYW4+XFxuICAgICAgICAgICAgICAgICAgICAgICAgPGJ1dHRvbiBjbGFzcz1cXFwiYnRuIGJ0bi1kZWZhdWx0IGJ0bi14cyBnbHlwaGljb24gcHVsbC1sZWZ0XFxcIiBkYXRhLWJpbmQ9XFxcInRvZ2dsZTogJGRhdGEuZW5hYmxlZCwgY3NzOiB7J2dseXBoaWNvbi1leWUtb3Blbic6ICRkYXRhLmVuYWJsZWQoKSwgJ2dseXBoaWNvbi1leWUtY2xvc2UnOiAhJGRhdGEuZW5hYmxlZCgpfSwgcHJldmVudEJ1YmJsZTogJ2NsaWNrJ1xcXCI+PC9idXR0b24+XFxuICAgICAgICAgICAgICAgICAgICA8L3RkPlxcbiAgICAgICAgICAgICAgICAgICAgPHRkIGNsYXNzPVxcXCJ0ZXh0LXJpZ2h0XFxcIj48c3BhbiBkYXRhLWJpbmQ9XFxcImh0bWw6ICRkYXRhLmRhbWFnZS50b0ZpeGVkKDIpXFxcIj48L3NwYW4+PC90ZD5cXG4gICAgICAgICAgICAgICAgICAgIDx0ZCBjbGFzcz1cXFwidGV4dC1yaWdodFxcXCI+PHNwYW4gZGF0YS1iaW5kPVxcXCJodG1sOiAkZGF0YS5kYW1hZ2VSZWR1Y2VkLnRvRml4ZWQoMilcXFwiPjwvc3Bhbj48L3RkPlxcbiAgICAgICAgICAgICAgICAgICAgPHRkIGNsYXNzPVxcXCJ0ZXh0LXJpZ2h0XFxcIj48c3BhbiBkYXRhLWJpbmQ9XFxcImh0bWw6ICRkYXRhLmRwcy50b0ZpeGVkKDIpXFxcIj48L3NwYW4+PC90ZD5cXG4gICAgICAgICAgICAgICAgICAgIDx0ZCBjbGFzcz1cXFwidGV4dC1yaWdodFxcXCI+PHNwYW4gZGF0YS1iaW5kPVxcXCJodG1sOiAkZGF0YS5kcHNSZWR1Y2VkLnRvRml4ZWQoMilcXFwiPjwvc3Bhbj48L3RkPlxcbiAgICAgICAgICAgICAgICA8L3RyPlxcbiAgICAgICAgICAgIDwvdGJvZHk+XFxuICAgICAgICAgICAgPCEtLSAva28gLS0+XFxuICAgICAgICAgICAgPHRib2R5PlxcbiAgICAgICAgICAgICAgICA8dHIgZGF0YS1iaW5kPVxcXCJ2aXNpYmxlOiBjbGVhdmVJbmZvKCkubGVuZ3RoID4gMFxcXCI+XFxuICAgICAgICAgICAgICAgICAgICA8dGQgY29sc3Bhbj0zPjxzdHJvbmc+Q2xlYXZlPC9zdHJvbmc+PC90ZD5cXG4gICAgICAgICAgICAgICAgPC90cj5cXG4gICAgICAgICAgICA8L3Rib2R5PiAgICBcXG4gICAgICAgICAgICA8dGJvZHkgZGF0YS1iaW5kPVxcXCJmb3JlYWNoOiBjbGVhdmVJbmZvKClcXFwiPlxcbiAgICAgICAgICAgICAgICA8dHI+PHRkPlJhZGl1czo8L3RkPjx0ZCBjbGFzcz1cXFwidGV4dC1yaWdodFxcXCI+PHNwYW4gZGF0YS1iaW5kPVxcXCJodG1sOiAkZGF0YS5yYWRpdXNcXFwiPjwvc3Bhbj48L3RkPjwvdHI+XFxuICAgICAgICAgICAgICAgIDx0cj48dGQ+TWFnbml0dWRlOjwvdGQ+PHRkIGNsYXNzPVxcXCJ0ZXh0LXJpZ2h0XFxcIj48c3BhbiBkYXRhLWJpbmQ9XFxcImh0bWw6ICgkZGF0YS5tYWduaXR1ZGUgKiAxMDApLnRvRml4ZWQoMikgKyAnJSdcXFwiPjwvc3Bhbj48L3RkPjwvdHI+XFxuICAgICAgICAgICAgICAgIDx0cj5cXG4gICAgICAgICAgICAgICAgICAgIDx0ZD5DbGVhdmUgRGFtYWdlOjwvdGQ+XFxuICAgICAgICAgICAgICAgICAgICA8dGQgY2xhc3M9XFxcInRleHQtcmlnaHRcXFwiPjxzcGFuIGRhdGEtYmluZD1cXFwiaHRtbDogKCRkYXRhLm1hZ25pdHVkZSAqICRwYXJlbnQuZGFtYWdlVG90YWxJbmZvKCkudG90YWwpLnRvRml4ZWQoMilcXFwiPjwvc3Bhbj48L3RkPlxcbiAgICAgICAgICAgICAgICA8L3RyPlxcbiAgICAgICAgICAgIDwvdGJvZHk+XFxuICAgICAgICBcXG4gICAgICAgIDwvdGFibGU+XFxuICAgIDwvZGl2PlxcbjwvZGl2PlwiIH0pO1xua28uY29tcG9uZW50cy5yZWdpc3RlcignZGFtYWdlLWFtcCcsIHsgdGVtcGxhdGU6IFwiPGRpdiBjbGFzcz1cXFwiY29sLW1kLTEyXFxcIj5cXG4gICAgPGgzIGNsYXNzPVxcXCJzZWN0aW9uX2hlYWRlclxcXCIgZGF0YS1iaW5kPVxcXCJ0b2dnbGU6IHNlY3Rpb25EaXNwbGF5KCkuZGFtYWdlYW1wLCBjc3M6IHsgc2VjdGlvbl9kaXNhYmxlZDogIXNlY3Rpb25EaXNwbGF5KCkuZGFtYWdlYW1wKCkgfVxcXCI+RGFtYWdlIEFtcGxpZmljYXRpb24gJiBSZWR1Y3Rpb248L2gzPlxcbiAgICA8ZGl2IGRhdGEtYmluZD1cXFwidmlzaWJsZTogc2VjdGlvbkRpc3BsYXkoKS5kYW1hZ2VhbXAoKSwgbGF6eUJpbmRpbmc6IHNlY3Rpb25EaXNwbGF5KCkuZGFtYWdlYW1wXFxcIj5cXG4gICAgICAgIDxkaXYgY2xhc3M9XFxcImZvcm0taG9yaXpvbnRhbFxcXCI+XFxuICAgICAgICAgICAgPGRpdiBjbGFzcz1cXFwiZm9ybS1ncm91cFxcXCI+XFxuICAgICAgICAgICAgICAgICAgICA8ZGl2IGNsYXNzPVxcXCJjb2wtbWQtMyBjb250cm9sLWxhYmVsXFxcIj5cXG4gICAgICAgICAgICAgICAgICAgICAgICA8bGFiZWwgZm9yPVxcXCJkYW1hZ2VpbnB1dFxcXCI+RGFtYWdlPC9sYWJlbD5cXG4gICAgICAgICAgICAgICAgICAgIDwvZGl2PlxcbiAgICAgICAgICAgICAgICAgICAgPGRpdiBjbGFzcz1cXFwiY29sLW1kLTZcXFwiPlxcbiAgICAgICAgICAgICAgICAgICAgICAgIDxpbnB1dCBjbGFzcz1cXFwiZm9ybS1jb250cm9sXFxcIiBpZD1cXFwiZGFtYWdlaW5wdXRcXFwiIGRhdGEtYmluZD1cXFwidmFsdWU6IGRhbWFnZUlucHV0VmFsdWVcXFwiIC8+XFxuICAgICAgICAgICAgICAgICAgICA8L2Rpdj5cXG4gICAgICAgICAgICA8L2Rpdj5cXG4gICAgICAgIDwvZGl2PlxcbiAgICAgICAgPGRpdiBjbGFzcz1cXFwiZm9ybS1ob3Jpem9udGFsXFxcIj5cXG4gICAgICAgICAgICA8ZGl2IGNsYXNzPVxcXCJmb3JtLWdyb3VwXFxcIj5cXG4gICAgICAgICAgICAgICAgICAgIDxkaXYgY2xhc3M9XFxcImNvbC1tZC0zIGNvbnRyb2wtbGFiZWxcXFwiPlxcbiAgICAgICAgICAgICAgICAgICAgICAgIDxsYWJlbCBmb3I9XFxcImJ1ZmZhbXBzZWxlY3RcXFwiPkFtcGxpZmljYXRpb248L2xhYmVsPlxcbiAgICAgICAgICAgICAgICAgICAgPC9kaXY+XFxuICAgICAgICAgICAgICAgICAgICA8ZGl2IGNsYXNzPVxcXCJjb2wtbWQtNVxcXCI+XFxuICAgICAgICAgICAgICAgICAgICAgICAgPHNlbGVjdCBpZD1cXFwiYnVmZmFtcHNlbGVjdFxcXCIgY2xhc3M9XFxcImZvcm0tY29udHJvbFxcXCIgZGF0YS1iaW5kPVxcXCJvcHRpb25zOiBkYW1hZ2VBbXBsaWZpY2F0aW9uLmF2YWlsYWJsZUJ1ZmZzICwgb3B0aW9uc1RleHQ6ICdidWZmRGlzcGxheU5hbWUnLCB2YWx1ZTogZGFtYWdlQW1wbGlmaWNhdGlvbi5zZWxlY3RlZEJ1ZmZcXFwiPjwvc2VsZWN0PlxcbiAgICAgICAgICAgICAgICAgICAgPC9kaXY+XFxuICAgICAgICAgICAgICAgICAgICA8ZGl2IGNsYXNzPVxcXCJjb2wtbWQtNFxcXCI+XFxuICAgICAgICAgICAgICAgICAgICAgICAgPGJ1dHRvbiBjbGFzcz1cXFwiYnRuIGJ0bi1kZWZhdWx0XFxcIiBkYXRhLWJpbmQ9XFxcImNsaWNrOiBkYW1hZ2VBbXBsaWZpY2F0aW9uLmFkZEJ1ZmZcXFwiPkFkZDwvYnV0dG9uPlxcbiAgICAgICAgICAgICAgICAgICAgICAgIDxidXR0b24gY2xhc3M9XFxcImJ0biBidG4tZGVmYXVsdFxcXCIgZGF0YS1iaW5kPVxcXCJjbGljazogZnVuY3Rpb24oZGF0YSxldmVudCkgeyBkYW1hZ2VBbXBsaWZpY2F0aW9uLnJlbW92ZUJ1ZmYoZGF0YSwgZXZlbnQsIGRhbWFnZUFtcGxpZmljYXRpb24uc2VsZWN0ZWRCdWZmKCkuYnVmZk5hbWUpIH1cXFwiPlJlbW92ZTwvYnV0dG9uPlxcbiAgICAgICAgICAgICAgICAgICAgPC9kaXY+XFxuICAgICAgICAgICAgPC9kaXY+XFxuICAgICAgICA8L2Rpdj5cXG4gICAgICAgIDxkaXYgY2xhc3M9XFxcInJvd1xcXCIgZGF0YS1iaW5kPVxcXCJmb3JlYWNoOiBkYW1hZ2VBbXBsaWZpY2F0aW9uLmJ1ZmZzXFxcIj5cXG4gICAgICAgICAgICA8ZGl2IGRhdGEtYmluZD1cXFwiY3NzOiB7cm93OiAkZGF0YS5kYXRhLmlzRGV0YWlsKCkgfHwgKCRpbmRleCgpIDwgJHBhcmVudC5kYW1hZ2VBbXBsaWZpY2F0aW9uLmJ1ZmZzKCkubGVuZ3RoLTEgJiYgJHBhcmVudC5kYW1hZ2VBbXBsaWZpY2F0aW9uLmJ1ZmZzKClbJGluZGV4KCkrMV0uZGF0YS5pc0RldGFpbCgpKSwgcm93MjogJGRhdGEuZGF0YS5pc0RldGFpbCgpIHx8ICgkaW5kZXgoKSA8ICRwYXJlbnQuZGFtYWdlQW1wbGlmaWNhdGlvbi5idWZmcygpLmxlbmd0aC0xICYmICRwYXJlbnQuZGFtYWdlQW1wbGlmaWNhdGlvbi5idWZmcygpWyRpbmRleCgpKzFdLmRhdGEuaXNEZXRhaWwoKSkgfVxcXCI+XFxuICAgICAgICAgICAgICAgIDxkaXYgY2xhc3M9XFxcImNvbC1tZC0zIHRleHQtY2VudGVyIGJvdHRvbS1idWZmZXIgcm93MlxcXCIgZGF0YS1iaW5kPVxcXCJjc3M6IHsnY29sLW1kLTMnOiAkcm9vdC5sYXlvdXQoKSA9PSAwLCAnY29sLW1kLTInOiAkcm9vdC5sYXlvdXQoKSA9PSAxfVxcXCI+XFxuICAgICAgICAgICAgICAgICAgICA8aW1nIHN0eWxlPVxcXCJwYWRkaW5nOjBweDttYXJnaW4tYm90dG9tOjFweDtcXFwiIGNsYXNzPVxcXCJpbWctcm91bmRlZCBhYmlsaXR5XFxcIiBkYXRhLWJpbmQ9XFxcImNzczogeyBhYmlsaXR5X2FjdGl2ZTogJGRhdGEuZGF0YS5pc0FjdGl2ZSgpIHx8ICRkYXRhLmRhdGEuYmVoYXZpb3IuaW5kZXhPZignRE9UQV9BQklMSVRZX0JFSEFWSU9SX1BBU1NJVkUnKSAhPSAtMSwgYWJpbGl0eV9pbmFjdGl2ZTogISRkYXRhLmRhdGEuaXNBY3RpdmUoKSAmJiAkZGF0YS5kYXRhLmJlaGF2aW9yLmluZGV4T2YoJ0RPVEFfQUJJTElUWV9CRUhBVklPUl9QQVNTSVZFJykgPT0gLTEsIGJ0bjogJGRhdGEuZGF0YS5iZWhhdmlvci5pbmRleE9mKCdET1RBX0FCSUxJVFlfQkVIQVZJT1JfUEFTU0lWRScpID09IC0xLCAnYnRuLWRlZmF1bHQnOiAkZGF0YS5kYXRhLmJlaGF2aW9yLmluZGV4T2YoJ0RPVEFfQUJJTElUWV9CRUhBVklPUl9QQVNTSVZFJykgPT0gLTF9LCBhdHRyOntzcmM6ICcvbWVkaWEvaW1hZ2VzL3NwZWxsaWNvbnMvJyArICRkYXRhLmRhdGEubmFtZSArICcucG5nJ30sIGNsaWNrOiBmdW5jdGlvbihkYXRhLCBldmVudCkgeyAkcGFyZW50LmRhbWFnZUFtcGxpZmljYXRpb24udG9nZ2xlQnVmZigkaW5kZXgsIGRhdGEuZGF0YSwgZXZlbnQpOyB9LCBldmVudDogeyBkYmxjbGljazogZnVuY3Rpb24oZGF0YSxldmVudCkgeyAkcGFyZW50LmRhbWFnZUFtcGxpZmljYXRpb24ucmVtb3ZlQnVmZihkYXRhLCBldmVudCwgJGRhdGEuZGF0YS5uYW1lKSB9IH1cXFwiLz5cXG4gICAgICAgICAgICAgICAgICAgIDxkaXYgY2xhc3M9XFxcInByb2dyZXNzXFxcIiBzdHlsZT1cXFwicG9zaXRpb246cmVsYXRpdmVcXFwiPlxcbiAgICAgICAgICAgICAgICAgICAgICAgIDxkaXYgc3R5bGU9XFxcInBvc2l0aW9uOmFic29sdXRlO3dpZHRoOjEwMCU7Y29sb3I6d2hpdGU7XFxcIiBjbGFzcz1cXFwidGV4dC1jZW50ZXJcXFwiIGRhdGEtYmluZD1cXFwidmlzaWJsZTogJHBhcmVudC5nZXRBYmlsaXR5TGV2ZWxNYXgoJGRhdGEuZGF0YSkgPiAwLCB0ZXh0OiAkZGF0YS5kYXRhLmxldmVsKCkgKyAnLycgKyAkcGFyZW50LmdldEFiaWxpdHlMZXZlbE1heCgkZGF0YS5kYXRhKVxcXCI+PC9kaXY+XFxuICAgICAgICAgICAgICAgICAgICAgICAgPGRpdiBjbGFzcz1cXFwicHJvZ3Jlc3MtYmFyIHByb2dyZXNzLWJhci1kYW5nZXJcXFwiIHJvbGU9XFxcInByb2dyZXNzYmFyXFxcIiBhcmlhLXZhbHVlbm93PVxcXCI2MFxcXCIgYXJpYS12YWx1ZW1pbj1cXFwiMFxcXCIgYXJpYS12YWx1ZW1heD1cXFwiMTAwXFxcIiBzdHlsZT1cXFwid2lkdGg6IDYwJTtcXFwiIGRhdGEtYmluZD1cXFwiYXR0cjogeyAnYXJpYS12YWx1ZW5vdyc6ICgkcGFyZW50LmdldEFiaWxpdHlMZXZlbE1heCgkZGF0YS5kYXRhKSA+IDAgPyAkZGF0YS5kYXRhLmxldmVsKCkvJHBhcmVudC5nZXRBYmlsaXR5TGV2ZWxNYXgoJGRhdGEuZGF0YSkqMTAwIDogMCkgfSwgc3R5bGU6IHsgd2lkdGg6ICgkcGFyZW50LmdldEFiaWxpdHlMZXZlbE1heCgkZGF0YS5kYXRhKSA+IDAgPyAkZGF0YS5kYXRhLmxldmVsKCkvJHBhcmVudC5nZXRBYmlsaXR5TGV2ZWxNYXgoJGRhdGEuZGF0YSkqMTAwIDogMCkgKyAnJScgfVxcXCI+PC9kaXY+XFxuICAgICAgICAgICAgICAgICAgICA8L2Rpdj5cXG4gICAgICAgICAgICAgICAgICAgIDxkaXYgY2xhc3M9XFxcImJ0bi1ncm91cCBidG4tZ3JvdXAtanVzdGlmaWVkXFxcIiBkYXRhLWJpbmQ9XFxcImlmOiAkZGF0YS5kYXRhLmJlaGF2aW9yLmluZGV4T2YoJ0RPVEFfQUJJTElUWV9CRUhBVklPUl9OT1RfTEVBUk5BQkxFJykgPT0gLTFcXFwiPlxcbiAgICAgICAgICAgICAgICAgICAgICAgIDxhIGNsYXNzPVxcXCJidG4gYnRuLWRlZmF1bHQgYnRuLXNtXFxcIiBkYXRhLWJpbmQ9XFxcImNsaWNrOiBmdW5jdGlvbihkYXRhLCBldmVudCkgeyAkcGFyZW50LmRhbWFnZUFtcGxpZmljYXRpb24ubGV2ZWxEb3duQWJpbGl0eSgkaW5kZXgsIGRhdGEuZGF0YSwgZXZlbnQsICRwYXJlbnQpOyB9XFxcIj4tPC9hPlxcbiAgICAgICAgICAgICAgICAgICAgICAgIDxhIGNsYXNzPVxcXCJidG4gYnRuLWRlZmF1bHQgYnRuLXNtXFxcIiBkYXRhLWJpbmQ9XFxcImNsaWNrOiBmdW5jdGlvbihkYXRhLCBldmVudCkgeyAkcGFyZW50LmRhbWFnZUFtcGxpZmljYXRpb24ubGV2ZWxVcEFiaWxpdHkoJGluZGV4LCBkYXRhLmRhdGEsIGV2ZW50LCAkcGFyZW50KTsgfVxcXCI+KzwvYT5cXG4gICAgICAgICAgICAgICAgICAgIDwvZGl2PlxcbiAgICAgICAgICAgICAgICAgICAgPGRpdiBjbGFzcz1cXFwiYnRuLWdyb3VwIGJ0bi1ncm91cC1qdXN0aWZpZWRcXFwiPlxcbiAgICAgICAgICAgICAgICAgICAgICAgIDxhIGNsYXNzPVxcXCJidG4gYnRuLWRlZmF1bHQgYnRuLXNtXFxcIiBkYXRhLWJpbmQ9XFxcImNsaWNrOiBmdW5jdGlvbihkYXRhLCBldmVudCkgeyAkcGFyZW50LmRhbWFnZUFtcGxpZmljYXRpb24udG9nZ2xlQnVmZkRldGFpbCgkaW5kZXgsIGRhdGEsIGV2ZW50KTsgfSwgY3NzOiB7J3RvZ2dsZWQnOiAkZGF0YS5kYXRhLmlzRGV0YWlsfVxcXCI+RGV0YWlsczwvYT5cXG4gICAgICAgICAgICAgICAgICAgIDwvZGl2PlxcbiAgICAgICAgICAgICAgICA8L2Rpdj5cXG4gICAgICAgICAgICAgICAgPGRpdiBjbGFzcz1cXFwiY29sLW1kLTkgYm90dG9tLWJ1ZmZlclxcXCIgZGF0YS1iaW5kPVxcXCJ2aXNpYmxlOiAkZGF0YS5kYXRhLmlzRGV0YWlsKClcXFwiPlxcbiAgICAgICAgICAgICAgICAgICAgPGJ1dHRvbiB0eXBlPVxcXCJidXR0b25cXFwiIGNsYXNzPVxcXCJjbG9zZVxcXCIgZGF0YS1iaW5kPVxcXCJjbGljazogZnVuY3Rpb24oZGF0YSwgZXZlbnQpIHsgJHBhcmVudC5kYW1hZ2VBbXBsaWZpY2F0aW9uLnRvZ2dsZUJ1ZmZEZXRhaWwoJGluZGV4LCBkYXRhLmRhdGEsIGV2ZW50KTsgfVxcXCI+JnRpbWVzOzwvYnV0dG9uPlxcbiAgICAgICAgICAgICAgICAgICAgPGRpdiBkYXRhLWJpbmQ9XFxcImh0bWw6ICRwYXJlbnQuYWJpbGl0eSgpLmdldEFiaWxpdHlUb29sdGlwRGF0YSgkZGF0YS5oZXJvLCAkZGF0YS5kYXRhLm5hbWUpXFxcIj48L2Rpdj5cXG4gICAgICAgICAgICAgICAgICAgIDxkaXYgZGF0YS1iaW5kPVxcXCJpZjogJGRhdGEuZGF0YS5uYW1lIGluICRwYXJlbnQuZGFtYWdlQW1wbGlmaWNhdGlvbi5hYmlsaXR5RGF0YSAmJiAkcGFyZW50LmRhbWFnZUFtcGxpZmljYXRpb24uYnVmZnMoKVskaW5kZXgoKV0uZGF0YS5sZXZlbCgpID4gMFxcXCI+XFxuICAgICAgICAgICAgICAgICAgICAgICAgPGRpdiBjbGFzcz1cXFwiY29sLW1kLThcXFwiPlxcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICA8ZGl2IGRhdGEtYmluZD1cXFwiY29tcG9uZW50OiB7IG5hbWU6ICdidWZmLXNldHRpbmdzJywgcGFyYW1zOiAkcGFyZW50LmRhbWFnZUFtcGxpZmljYXRpb24uYWJpbGl0eVNldHRpbmdzRGF0YSgkZGF0YS5kYXRhLm5hbWUsICRwYXJlbnQsICRpbmRleCgpKSB9XFxcIj48L2Rpdj5cXG4gICAgICAgICAgICAgICAgICAgICAgICA8L2Rpdj5cXG4gICAgICAgICAgICAgICAgICAgIDwvZGl2PlxcbiAgICAgICAgICAgICAgICA8L2Rpdj5cXG4gICAgICAgICAgICA8L2Rpdj5cXG4gICAgICAgIDwvZGl2PlxcbiAgICAgICAgPGRpdiBjbGFzcz1cXFwiZm9ybS1ob3Jpem9udGFsXFxcIj5cXG4gICAgICAgICAgICA8ZGl2IGNsYXNzPVxcXCJmb3JtLWdyb3VwXFxcIj5cXG4gICAgICAgICAgICAgICAgICAgIDxkaXYgY2xhc3M9XFxcImNvbC1tZC0zIGNvbnRyb2wtbGFiZWxcXFwiPlxcbiAgICAgICAgICAgICAgICAgICAgICAgIDxsYWJlbCBmb3I9XFxcImJ1ZmZyZWR1Y3Rpb25zZWxlY3RcXFwiPlJlZHVjdGlvbjwvbGFiZWw+XFxuICAgICAgICAgICAgICAgICAgICA8L2Rpdj5cXG4gICAgICAgICAgICAgICAgICAgIDxkaXYgY2xhc3M9XFxcImNvbC1tZC01XFxcIj5cXG4gICAgICAgICAgICAgICAgICAgICAgICA8c2VsZWN0IGlkPVxcXCJidWZmcmVkdWN0aW9uc2VsZWN0XFxcIiBjbGFzcz1cXFwiZm9ybS1jb250cm9sXFxcIiBkYXRhLWJpbmQ9XFxcIm9wdGlvbnM6IGRhbWFnZVJlZHVjdGlvbi5hdmFpbGFibGVEZWJ1ZmZzICwgb3B0aW9uc1RleHQ6ICdidWZmRGlzcGxheU5hbWUnLCB2YWx1ZTogZGFtYWdlUmVkdWN0aW9uLnNlbGVjdGVkQnVmZlxcXCI+PC9zZWxlY3Q+XFxuICAgICAgICAgICAgICAgICAgICA8L2Rpdj5cXG4gICAgICAgICAgICAgICAgICAgIDxkaXYgY2xhc3M9XFxcImNvbC1tZC00XFxcIj5cXG4gICAgICAgICAgICAgICAgICAgICAgICA8YnV0dG9uIGNsYXNzPVxcXCJidG4gYnRuLWRlZmF1bHRcXFwiIGRhdGEtYmluZD1cXFwiY2xpY2s6IGRhbWFnZVJlZHVjdGlvbi5hZGRCdWZmXFxcIj5BZGQ8L2J1dHRvbj5cXG4gICAgICAgICAgICAgICAgICAgICAgICA8YnV0dG9uIGNsYXNzPVxcXCJidG4gYnRuLWRlZmF1bHRcXFwiIGRhdGEtYmluZD1cXFwiY2xpY2s6IGZ1bmN0aW9uKGRhdGEsZXZlbnQpIHsgZGFtYWdlUmVkdWN0aW9uLnJlbW92ZUJ1ZmYoZGF0YSwgZXZlbnQsIGRhbWFnZVJlZHVjdGlvbi5zZWxlY3RlZEJ1ZmYoKS5idWZmTmFtZSkgfVxcXCI+UmVtb3ZlPC9idXR0b24+XFxuICAgICAgICAgICAgICAgICAgICA8L2Rpdj5cXG4gICAgICAgICAgICA8L2Rpdj5cXG4gICAgICAgIDwvZGl2PlxcbiAgICAgICAgPGRpdiBjbGFzcz1cXFwicm93XFxcIiBkYXRhLWJpbmQ9XFxcImZvcmVhY2g6IGRhbWFnZVJlZHVjdGlvbi5idWZmc1xcXCI+XFxuICAgICAgICAgICAgPGRpdiBkYXRhLWJpbmQ9XFxcImNzczoge3JvdzogJGRhdGEuZGF0YS5pc0RldGFpbCgpIHx8ICgkaW5kZXgoKSA8ICRwYXJlbnQuZGFtYWdlUmVkdWN0aW9uLmJ1ZmZzKCkubGVuZ3RoLTEgJiYgJHBhcmVudC5kYW1hZ2VSZWR1Y3Rpb24uYnVmZnMoKVskaW5kZXgoKSsxXS5kYXRhLmlzRGV0YWlsKCkpLCByb3cyOiAkZGF0YS5kYXRhLmlzRGV0YWlsKCkgfHwgKCRpbmRleCgpIDwgJHBhcmVudC5kYW1hZ2VSZWR1Y3Rpb24uYnVmZnMoKS5sZW5ndGgtMSAmJiAkcGFyZW50LmRhbWFnZVJlZHVjdGlvbi5idWZmcygpWyRpbmRleCgpKzFdLmRhdGEuaXNEZXRhaWwoKSkgfVxcXCI+XFxuICAgICAgICAgICAgICAgIDxkaXYgY2xhc3M9XFxcImNvbC1tZC0zIHRleHQtY2VudGVyIGJvdHRvbS1idWZmZXIgcm93MlxcXCIgZGF0YS1iaW5kPVxcXCJjc3M6IHsnY29sLW1kLTMnOiAkcm9vdC5sYXlvdXQoKSA9PSAwLCAnY29sLW1kLTInOiAkcm9vdC5sYXlvdXQoKSA9PSAxfVxcXCI+XFxuICAgICAgICAgICAgICAgICAgICA8aW1nIHN0eWxlPVxcXCJwYWRkaW5nOjBweDttYXJnaW4tYm90dG9tOjFweDtcXFwiIGNsYXNzPVxcXCJpbWctcm91bmRlZCBhYmlsaXR5XFxcIiBkYXRhLWJpbmQ9XFxcImNzczogeyBhYmlsaXR5X2FjdGl2ZTogJGRhdGEuZGF0YS5pc0FjdGl2ZSgpIHx8ICRkYXRhLmRhdGEuYmVoYXZpb3IuaW5kZXhPZignRE9UQV9BQklMSVRZX0JFSEFWSU9SX1BBU1NJVkUnKSAhPSAtMSwgYWJpbGl0eV9pbmFjdGl2ZTogISRkYXRhLmRhdGEuaXNBY3RpdmUoKSAmJiAkZGF0YS5kYXRhLmJlaGF2aW9yLmluZGV4T2YoJ0RPVEFfQUJJTElUWV9CRUhBVklPUl9QQVNTSVZFJykgPT0gLTEsIGJ0bjogJGRhdGEuZGF0YS5iZWhhdmlvci5pbmRleE9mKCdET1RBX0FCSUxJVFlfQkVIQVZJT1JfUEFTU0lWRScpID09IC0xLCAnYnRuLWRlZmF1bHQnOiAkZGF0YS5kYXRhLmJlaGF2aW9yLmluZGV4T2YoJ0RPVEFfQUJJTElUWV9CRUhBVklPUl9QQVNTSVZFJykgPT0gLTF9LCBhdHRyOntzcmM6ICcvbWVkaWEvaW1hZ2VzL3NwZWxsaWNvbnMvJyArICRkYXRhLmRhdGEubmFtZSArICcucG5nJ30sIGNsaWNrOiBmdW5jdGlvbihkYXRhLCBldmVudCkgeyAkcGFyZW50LmRhbWFnZVJlZHVjdGlvbi50b2dnbGVCdWZmKCRpbmRleCwgZGF0YS5kYXRhLCBldmVudCk7IH0sIGV2ZW50OiB7IGRibGNsaWNrOiBmdW5jdGlvbihkYXRhLGV2ZW50KSB7ICRwYXJlbnQuZGFtYWdlUmVkdWN0aW9uLnJlbW92ZUJ1ZmYoZGF0YSwgZXZlbnQsICRkYXRhLmRhdGEubmFtZSkgfSB9XFxcIi8+XFxuICAgICAgICAgICAgICAgICAgICA8ZGl2IGNsYXNzPVxcXCJwcm9ncmVzc1xcXCIgc3R5bGU9XFxcInBvc2l0aW9uOnJlbGF0aXZlXFxcIj5cXG4gICAgICAgICAgICAgICAgICAgICAgICA8ZGl2IHN0eWxlPVxcXCJwb3NpdGlvbjphYnNvbHV0ZTt3aWR0aDoxMDAlO2NvbG9yOndoaXRlO1xcXCIgY2xhc3M9XFxcInRleHQtY2VudGVyXFxcIiBkYXRhLWJpbmQ9XFxcInZpc2libGU6ICRwYXJlbnQuZ2V0QWJpbGl0eUxldmVsTWF4KCRkYXRhLmRhdGEpID4gMCwgdGV4dDogJGRhdGEuZGF0YS5sZXZlbCgpICsgJy8nICsgJHBhcmVudC5nZXRBYmlsaXR5TGV2ZWxNYXgoJGRhdGEuZGF0YSlcXFwiPjwvZGl2PlxcbiAgICAgICAgICAgICAgICAgICAgICAgIDxkaXYgY2xhc3M9XFxcInByb2dyZXNzLWJhciBwcm9ncmVzcy1iYXItZGFuZ2VyXFxcIiByb2xlPVxcXCJwcm9ncmVzc2JhclxcXCIgYXJpYS12YWx1ZW5vdz1cXFwiNjBcXFwiIGFyaWEtdmFsdWVtaW49XFxcIjBcXFwiIGFyaWEtdmFsdWVtYXg9XFxcIjEwMFxcXCIgc3R5bGU9XFxcIndpZHRoOiA2MCU7XFxcIiBkYXRhLWJpbmQ9XFxcImF0dHI6IHsgJ2FyaWEtdmFsdWVub3cnOiAoJHBhcmVudC5nZXRBYmlsaXR5TGV2ZWxNYXgoJGRhdGEuZGF0YSkgPiAwID8gJGRhdGEuZGF0YS5sZXZlbCgpLyRwYXJlbnQuZ2V0QWJpbGl0eUxldmVsTWF4KCRkYXRhLmRhdGEpKjEwMCA6IDApIH0sIHN0eWxlOiB7IHdpZHRoOiAoJHBhcmVudC5nZXRBYmlsaXR5TGV2ZWxNYXgoJGRhdGEuZGF0YSkgPiAwID8gJGRhdGEuZGF0YS5sZXZlbCgpLyRwYXJlbnQuZ2V0QWJpbGl0eUxldmVsTWF4KCRkYXRhLmRhdGEpKjEwMCA6IDApICsgJyUnIH1cXFwiPjwvZGl2PlxcbiAgICAgICAgICAgICAgICAgICAgPC9kaXY+XFxuICAgICAgICAgICAgICAgICAgICA8ZGl2IGNsYXNzPVxcXCJidG4tZ3JvdXAgYnRuLWdyb3VwLWp1c3RpZmllZFxcXCIgZGF0YS1iaW5kPVxcXCJpZjogJGRhdGEuZGF0YS5iZWhhdmlvci5pbmRleE9mKCdET1RBX0FCSUxJVFlfQkVIQVZJT1JfTk9UX0xFQVJOQUJMRScpID09IC0xXFxcIj5cXG4gICAgICAgICAgICAgICAgICAgICAgICA8YSBjbGFzcz1cXFwiYnRuIGJ0bi1kZWZhdWx0IGJ0bi1zbVxcXCIgZGF0YS1iaW5kPVxcXCJjbGljazogZnVuY3Rpb24oZGF0YSwgZXZlbnQpIHsgJHBhcmVudC5kYW1hZ2VSZWR1Y3Rpb24ubGV2ZWxEb3duQWJpbGl0eSgkaW5kZXgsIGRhdGEuZGF0YSwgZXZlbnQsICRwYXJlbnQpOyB9XFxcIj4tPC9hPlxcbiAgICAgICAgICAgICAgICAgICAgICAgIDxhIGNsYXNzPVxcXCJidG4gYnRuLWRlZmF1bHQgYnRuLXNtXFxcIiBkYXRhLWJpbmQ9XFxcImNsaWNrOiBmdW5jdGlvbihkYXRhLCBldmVudCkgeyAkcGFyZW50LmRhbWFnZVJlZHVjdGlvbi5sZXZlbFVwQWJpbGl0eSgkaW5kZXgsIGRhdGEuZGF0YSwgZXZlbnQsICRwYXJlbnQpOyB9XFxcIj4rPC9hPlxcbiAgICAgICAgICAgICAgICAgICAgPC9kaXY+XFxuICAgICAgICAgICAgICAgICAgICA8ZGl2IGNsYXNzPVxcXCJidG4tZ3JvdXAgYnRuLWdyb3VwLWp1c3RpZmllZFxcXCI+XFxuICAgICAgICAgICAgICAgICAgICAgICAgPGEgY2xhc3M9XFxcImJ0biBidG4tZGVmYXVsdCBidG4tc21cXFwiIGRhdGEtYmluZD1cXFwiY2xpY2s6IGZ1bmN0aW9uKGRhdGEsIGV2ZW50KSB7ICRwYXJlbnQuZGFtYWdlUmVkdWN0aW9uLnRvZ2dsZUJ1ZmZEZXRhaWwoJGluZGV4LCBkYXRhLCBldmVudCk7IH0sIGNzczogeyd0b2dnbGVkJzogJGRhdGEuZGF0YS5pc0RldGFpbH1cXFwiPkRldGFpbHM8L2E+XFxuICAgICAgICAgICAgICAgICAgICA8L2Rpdj5cXG4gICAgICAgICAgICAgICAgPC9kaXY+XFxuICAgICAgICAgICAgICAgIDxkaXYgY2xhc3M9XFxcImNvbC1tZC05IGJvdHRvbS1idWZmZXJcXFwiIGRhdGEtYmluZD1cXFwidmlzaWJsZTogJGRhdGEuZGF0YS5pc0RldGFpbCgpXFxcIj5cXG4gICAgICAgICAgICAgICAgICAgIDxidXR0b24gdHlwZT1cXFwiYnV0dG9uXFxcIiBjbGFzcz1cXFwiY2xvc2VcXFwiIGRhdGEtYmluZD1cXFwiY2xpY2s6IGZ1bmN0aW9uKGRhdGEsIGV2ZW50KSB7ICRwYXJlbnQuZGFtYWdlUmVkdWN0aW9uLnRvZ2dsZUJ1ZmZEZXRhaWwoJGluZGV4LCBkYXRhLmRhdGEsIGV2ZW50KTsgfVxcXCI+JnRpbWVzOzwvYnV0dG9uPlxcbiAgICAgICAgICAgICAgICAgICAgPGRpdiBkYXRhLWJpbmQ9XFxcImh0bWw6ICRwYXJlbnQuYWJpbGl0eSgpLmdldEFiaWxpdHlUb29sdGlwRGF0YSgkZGF0YS5oZXJvLCAkZGF0YS5kYXRhLm5hbWUpXFxcIj48L2Rpdj5cXG4gICAgICAgICAgICAgICAgICAgIDxkaXYgZGF0YS1iaW5kPVxcXCJpZjogJGRhdGEuZGF0YS5uYW1lIGluICRwYXJlbnQuZGFtYWdlUmVkdWN0aW9uLmFiaWxpdHlEYXRhICYmICRwYXJlbnQuZGFtYWdlUmVkdWN0aW9uLmJ1ZmZzKClbJGluZGV4KCldLmRhdGEubGV2ZWwoKSA+IDBcXFwiPlxcbiAgICAgICAgICAgICAgICAgICAgICAgIDxkaXYgY2xhc3M9XFxcImNvbC1tZC04XFxcIj5cXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgPGRpdiBkYXRhLWJpbmQ9XFxcImNvbXBvbmVudDogeyBuYW1lOiAnYnVmZi1zZXR0aW5ncycsIHBhcmFtczogJHBhcmVudC5kYW1hZ2VSZWR1Y3Rpb24uYWJpbGl0eVNldHRpbmdzRGF0YSgkZGF0YS5kYXRhLm5hbWUsICRwYXJlbnQsICRpbmRleCgpKSB9XFxcIj48L2Rpdj5cXG4gICAgICAgICAgICAgICAgICAgICAgICA8L2Rpdj5cXG4gICAgICAgICAgICAgICAgICAgIDwvZGl2PlxcbiAgICAgICAgICAgICAgICA8L2Rpdj5cXG4gICAgICAgICAgICA8L2Rpdj5cXG4gICAgICAgIDwvZGl2PlxcbiAgICAgICAgXFxuICAgICAgICA8aDQ+Q2FsY3VsYXRpb25zIDxhIGNsYXNzPVxcXCJidG4gYnRuLWRlZmF1bHQgYnRuLXhzXFxcIiBkYXRhLWJpbmQ9XFxcInRvZ2dsZTogc2hvd0RhbWFnZUFtcENhbGNEZXRhaWxzLCB0ZXh0OiAhc2hvd0RhbWFnZUFtcENhbGNEZXRhaWxzKCkgPyAnU2hvdyBkZXRhaWxzJyA6ICdIaWRlIGRldGFpbHMnXFxcIj48L2E+PC9oND5cXG4gICAgICAgIDx0YWJsZSBjbGFzcz1cXFwidGFibGVcXFwiPlxcbiAgICAgICAgICAgIDx0Ym9keT5cXG4gICAgICAgICAgICAgICAgPCEtLSBrbyBmb3JlYWNoOiBkYW1hZ2VJbnB1dE1vZGlmaWVkKCkuZGF0YSAtLT5cXG4gICAgICAgICAgICAgICAgPHRyIGRhdGEtYmluZD1cXFwidmlzaWJsZTogJHBhcmVudC5zaG93RGFtYWdlQW1wQ2FsY0RldGFpbHMoKVxcXCI+XFxuICAgICAgICAgICAgICAgICAgICA8dGQ+PHNwYW4gc3R5bGU9XFxcInRleHQtZGVjb3JhdGlvbjogdW5kZXJsaW5lO1xcXCIgZGF0YS1iaW5kPVxcXCJ0ZXh0OiAkZGF0YS5sYWJlbCArICcgZGFtYWdlJ1xcXCI+PC9zcGFuPjwvdGQ+XFxuICAgICAgICAgICAgICAgICAgICA8dGQgY2xhc3M9XFxcInRleHQtcmlnaHRcXFwiPjxzcGFuIGRhdGEtYmluZD1cXFwiaHRtbDogTWF0aC5yb3VuZCgkZGF0YS52YWx1ZSAqIDEwMCkgLyAxMDAsIHN0eWxlOiB7Y29sb3I6ICRwYXJlbnQuZ2V0RGFtYWdlVHlwZUNvbG9yKCRkYXRhLmRhbWFnZVR5cGUpfVxcXCI+PC9zcGFuPjwvdGQ+XFxuICAgICAgICAgICAgICAgIDwvdHI+XFxuICAgICAgICAgICAgICAgICAgICA8IS0tIGtvIGZvcmVhY2g6ICRkYXRhLmRhdGEgLS0+XFxuICAgICAgICAgICAgICAgICAgICA8dHIgZGF0YS1iaW5kPVxcXCJ2aXNpYmxlOiAkcGFyZW50c1sxXS5zaG93RGFtYWdlQW1wQ2FsY0RldGFpbHMoKVxcXCI+XFxuICAgICAgICAgICAgICAgICAgICAgICAgPHRkPjxzcGFuIGRhdGEtYmluZD1cXFwidGV4dDogJGRhdGEubGFiZWxcXFwiPjwvc3Bhbj48L3RkPlxcbiAgICAgICAgICAgICAgICAgICAgICAgIDx0ZCBjbGFzcz1cXFwidGV4dC1yaWdodFxcXCI+PHNwYW4gZGF0YS1iaW5kPVxcXCJodG1sOiBNYXRoLnJvdW5kKCRkYXRhLnZhbHVlICogMTAwKSAvIDEwMCwgZGlmZlN0eWxlOiAkZGF0YS52YWx1ZVxcXCI+PC9zcGFuPjwvdGQ+XFxuICAgICAgICAgICAgICAgICAgICA8L3RyPlxcbiAgICAgICAgICAgICAgICAgICAgPCEtLSAva28gLS0+XFxuICAgICAgICAgICAgICAgIDx0ciBkYXRhLWJpbmQ9XFxcImNzczoge3N1YnRvdGFsOiAkcGFyZW50LnNob3dEYW1hZ2VBbXBDYWxjRGV0YWlscygpfVxcXCI+XFxuICAgICAgICAgICAgICAgICAgICA8dGQgZGF0YS1iaW5kPVxcXCJ2aXNpYmxlOiAkcGFyZW50LnNob3dEYW1hZ2VBbXBDYWxjRGV0YWlscygpXFxcIj48c3BhbiBkYXRhLWJpbmQ9XFxcInRleHQ6ICRkYXRhLmxhYmVsICsgJyBkYW1hZ2Ugc3VidG90YWwnXFxcIj48L3NwYW4+PC90ZD5cXG4gICAgICAgICAgICAgICAgICAgIDx0ZCBkYXRhLWJpbmQ9XFxcInZpc2libGU6ICEkcGFyZW50LnNob3dEYW1hZ2VBbXBDYWxjRGV0YWlscygpXFxcIj48c3BhbiBkYXRhLWJpbmQ9XFxcInRleHQ6ICRkYXRhLmxhYmVsICsgJyBkYW1hZ2UnXFxcIj48L3NwYW4+PC90ZD5cXG4gICAgICAgICAgICAgICAgICAgIDx0ZCBjbGFzcz1cXFwidGV4dC1yaWdodFxcXCI+PHNwYW4gZGF0YS1iaW5kPVxcXCJodG1sOiBNYXRoLnJvdW5kKCRkYXRhLnRvdGFsICogMTAwKSAvIDEwMCwgc3R5bGU6IHtjb2xvcjogJHBhcmVudC5nZXREYW1hZ2VUeXBlQ29sb3IoJGRhdGEuZGFtYWdlVHlwZSl9XFxcIj48L3NwYW4+PC90ZD5cXG4gICAgICAgICAgICAgICAgPC90cj5cXG4gICAgICAgICAgICAgICAgPCEtLSAva28gLS0+XFxuICAgICAgICAgICAgICAgIDx0cj5cXG4gICAgICAgICAgICAgICAgICAgIDx0ZD48c3Ryb25nIGRhdGEtYmluZD1cXFwidGV4dDogZGFtYWdlSW5wdXRNb2RpZmllZCgpLmxhYmVsICsgJyBkYW1hZ2UnXFxcIj48L3N0cm9uZz48L3RkPlxcbiAgICAgICAgICAgICAgICAgICAgPHRkIGNsYXNzPVxcXCJ0ZXh0LXJpZ2h0XFxcIj48c3Ryb25nIGRhdGEtYmluZD1cXFwiaHRtbDogTWF0aC5yb3VuZChkYW1hZ2VJbnB1dE1vZGlmaWVkKCkudG90YWwgKiAxMDApIC8gMTAwLCBzdHlsZToge2NvbG9yOiBnZXREYW1hZ2VUeXBlQ29sb3IoZGFtYWdlSW5wdXRNb2RpZmllZCgpLmRhbWFnZVR5cGUpfVxcXCI+PC9zdHJvbmc+PC90ZD5cXG4gICAgICAgICAgICAgICAgPC90cj5cXG4gICAgICAgICAgICA8L3Rib2R5PlxcbiAgICAgICAgPC90YWJsZT5cXG4gICAgPC9kaXY+XFxuPC9kaXY+XCIgfSk7XG5rby5jb21wb25lbnRzLnJlZ2lzdGVyKCdhYmlsaXR5JywgeyB0ZW1wbGF0ZTogXCI8ZGl2IGRhdGEtYmluZD1cXFwiaWY6ICRkYXRhLmRpc3BsYXluYW1lICE9ICdFbXB0eScgJiYgICgkZGF0YS5iZWhhdmlvci5pbmRleE9mKCdET1RBX0FCSUxJVFlfQkVIQVZJT1JfSElEREVOJykgPT0gLTEgfHwgJGRhdGEubmFtZS5pbmRleE9mKCdpbnZva2VyXycpICE9IC0xKSxcXG5zdHlsZToge2NsZWFyOiAkZGF0YS5uYW1lID09ICdpbnZva2VyX2NvbGRfc25hcCcgfHwgJGRhdGEubmFtZSA9PSAnaW52b2tlcl9jaGFvc19tZXRlb3InID8gJ2JvdGgnIDogJyd9LFxcbmNzczoge3JvdzogJGRhdGEuaXNEZXRhaWwoKSB8fCAoJGluZGV4KCkgPCAkcGFyZW50c1sxXS5hYmlsaXR5KCkuYWJpbGl0aWVzKCkubGVuZ3RoLTEgJiYgJHBhcmVudHNbMV0uYWJpbGl0eSgpLmFiaWxpdGllcygpWyRpbmRleCgpKzFdLmlzRGV0YWlsKCkpLCByb3czOiAkZGF0YS5pc0RldGFpbCgpIHx8ICgkaW5kZXgoKSA8ICRwYXJlbnRzWzFdLmFiaWxpdHkoKS5hYmlsaXRpZXMoKS5sZW5ndGgtMSAmJiAkcGFyZW50c1sxXS5hYmlsaXR5KCkuYWJpbGl0aWVzKClbJGluZGV4KCkrMV0uaXNEZXRhaWwoKSkgfVxcXCI+XFxuICAgIDxkaXYgY2xhc3M9XFxcImNvbC1tZC0zIHRleHQtY2VudGVyIGJvdHRvbS1idWZmZXIgcm93MlxcXCIgZGF0YS1iaW5kPVxcXCJjc3M6IHsnY29sLW1kLTMnOiAkcm9vdC5sYXlvdXQoKSA9PSAwLCAnY29sLW1kLTInOiAkcm9vdC5sYXlvdXQoKSA9PSAxfVxcXCI+XFxuICAgICAgICA8aW1nIHN0eWxlPVxcXCJwYWRkaW5nOjBweDttYXJnaW4tYm90dG9tOjFweDtcXFwiIGNsYXNzPVxcXCJpbWctcm91bmRlZCBhYmlsaXR5XFxcIiBkYXRhLWJpbmQ9XFxcImNzczogeyBhYmlsaXR5X2FjdGl2ZTogJGRhdGEuaXNBY3RpdmUoKSB8fCAkZGF0YS5iZWhhdmlvci5pbmRleE9mKCdET1RBX0FCSUxJVFlfQkVIQVZJT1JfUEFTU0lWRScpICE9IC0xLCBhYmlsaXR5X2luYWN0aXZlOiAhJGRhdGEuaXNBY3RpdmUoKSAmJiAkZGF0YS5iZWhhdmlvci5pbmRleE9mKCdET1RBX0FCSUxJVFlfQkVIQVZJT1JfUEFTU0lWRScpID09IC0xLCBidG46ICRkYXRhLmJlaGF2aW9yLmluZGV4T2YoJ0RPVEFfQUJJTElUWV9CRUhBVklPUl9QQVNTSVZFJykgPT0gLTEsICdidG4tZGVmYXVsdCc6ICRkYXRhLmJlaGF2aW9yLmluZGV4T2YoJ0RPVEFfQUJJTElUWV9CRUhBVklPUl9QQVNTSVZFJykgPT0gLTF9LCBhdHRyOntzcmM6ICcvbWVkaWEvaW1hZ2VzL3NwZWxsaWNvbnMvJyArICRkYXRhLm5hbWUgKyAnLnBuZyd9LCBjbGljazogZnVuY3Rpb24oZGF0YSwgZXZlbnQpIHsgJHBhcmVudHNbMV0uYWJpbGl0eSgpLnRvZ2dsZUFiaWxpdHkoJGluZGV4LCBkYXRhLCBldmVudCk7IH1cXFwiLz5cXG4gICAgICAgIDxkaXYgY2xhc3M9XFxcInByb2dyZXNzXFxcIiBzdHlsZT1cXFwicG9zaXRpb246cmVsYXRpdmVcXFwiPlxcbiAgICAgICAgICAgIDxkaXYgc3R5bGU9XFxcInBvc2l0aW9uOmFic29sdXRlO3dpZHRoOjEwMCU7Y29sb3I6d2hpdGU7XFxcIiBjbGFzcz1cXFwidGV4dC1jZW50ZXJcXFwiIGRhdGEtYmluZD1cXFwidmlzaWJsZTogJHBhcmVudHNbMV0uZ2V0QWJpbGl0eUxldmVsTWF4KCRkYXRhKSA+IDAsIHRleHQ6ICRkYXRhLmxldmVsKCkgKyAnLycgKyAkcGFyZW50c1sxXS5nZXRBYmlsaXR5TGV2ZWxNYXgoJGRhdGEpXFxcIj48L2Rpdj5cXG4gICAgICAgICAgICA8ZGl2IGNsYXNzPVxcXCJwcm9ncmVzcy1iYXIgcHJvZ3Jlc3MtYmFyLWRhbmdlclxcXCIgcm9sZT1cXFwicHJvZ3Jlc3NiYXJcXFwiIGFyaWEtdmFsdWVub3c9XFxcIjYwXFxcIiBhcmlhLXZhbHVlbWluPVxcXCIwXFxcIiBhcmlhLXZhbHVlbWF4PVxcXCIxMDBcXFwiIHN0eWxlPVxcXCJ3aWR0aDogNjAlO1xcXCIgZGF0YS1iaW5kPVxcXCJhdHRyOiB7ICdhcmlhLXZhbHVlbm93JzogKCRwYXJlbnRzWzFdLmdldEFiaWxpdHlMZXZlbE1heCgkZGF0YSkgPiAwID8gJGRhdGEubGV2ZWwoKS8kcGFyZW50c1sxXS5nZXRBYmlsaXR5TGV2ZWxNYXgoJGRhdGEpKjEwMCA6IDApIH0sIHN0eWxlOiB7IHdpZHRoOiAoJHBhcmVudHNbMV0uZ2V0QWJpbGl0eUxldmVsTWF4KCRkYXRhKSA+IDAgPyAkZGF0YS5sZXZlbCgpLyRwYXJlbnRzWzFdLmdldEFiaWxpdHlMZXZlbE1heCgkZGF0YSkqMTAwIDogMCkgKyAnJScgfVxcXCI+PC9kaXY+XFxuICAgICAgICA8L2Rpdj5cXG4gICAgICAgIDxkaXYgY2xhc3M9XFxcImJ0bi1ncm91cCBidG4tZ3JvdXAtanVzdGlmaWVkXFxcIiBkYXRhLWJpbmQ9XFxcImlmOiAkZGF0YS5iZWhhdmlvci5pbmRleE9mKCdET1RBX0FCSUxJVFlfQkVIQVZJT1JfTk9UX0xFQVJOQUJMRScpID09IC0xXFxcIj5cXG4gICAgICAgICAgICA8YSBjbGFzcz1cXFwiYnRuIGJ0bi1kZWZhdWx0IGJ0bi1zbVxcXCIgZGF0YS1iaW5kPVxcXCJjbGljazogZnVuY3Rpb24oZGF0YSwgZXZlbnQpIHsgJHBhcmVudHNbMV0uYWJpbGl0eSgpLmxldmVsRG93bkFiaWxpdHkoJGluZGV4LCBkYXRhLCBldmVudCwgJHBhcmVudHNbMV0pOyB9XFxcIj4tPC9hPlxcbiAgICAgICAgICAgIDxhIGNsYXNzPVxcXCJidG4gYnRuLWRlZmF1bHQgYnRuLXNtXFxcIiBkYXRhLWJpbmQ9XFxcImNsaWNrOiBmdW5jdGlvbihkYXRhLCBldmVudCkgeyAkcGFyZW50c1sxXS5hYmlsaXR5KCkubGV2ZWxVcEFiaWxpdHkoJGluZGV4LCBkYXRhLCBldmVudCwgJHBhcmVudHNbMV0pOyB9XFxcIj4rPC9hPlxcbiAgICAgICAgPC9kaXY+XFxuICAgICAgICA8ZGl2IGNsYXNzPVxcXCJidG4tZ3JvdXAgYnRuLWdyb3VwLWp1c3RpZmllZFxcXCI+XFxuICAgICAgICAgICAgPGEgY2xhc3M9XFxcImJ0biBidG4tZGVmYXVsdCBidG4tc21cXFwiIGRhdGEtYmluZD1cXFwiY2xpY2s6IGZ1bmN0aW9uKGRhdGEsIGV2ZW50KSB7ICRwYXJlbnRzWzFdLmFiaWxpdHkoKS50b2dnbGVBYmlsaXR5RGV0YWlsKCRpbmRleCwgZGF0YSwgZXZlbnQpOyB9LCBjc3M6IHsndG9nZ2xlZCc6ICRkYXRhLmlzRGV0YWlsfVxcXCI+RGV0YWlsczwvYT5cXG4gICAgICAgIDwvZGl2PlxcbiAgICAgICAgPGRpdiBjbGFzcz1cXFwiYnRuLWdyb3VwIGJ0bi1ncm91cC1qdXN0aWZpZWRcXFwiIGRhdGEtYmluZD1cXFwiaWY6ICRkYXRhLmJlaGF2aW9yLmluZGV4T2YoJ0RPVEFfQUJJTElUWV9CRUhBVklPUl9OT1RfTEVBUk5BQkxFJykgIT0gLTFcXFwiPlxcbiAgICAgICAgICAgIDxhIGNsYXNzPVxcXCJidG4gYnRuLWRlZmF1bHQgYnRuLXNtIGJ0bi1ibG9ja1xcXCIgc3R5bGU9XFxcInZpc2liaWxpdHk6aGlkZGVuO1xcXCI+Jm1kYXNoOzwvYT5cXG4gICAgICAgIDwvZGl2PlxcbiAgICA8L2Rpdj5cXG4gICAgPGRpdiBjbGFzcz1cXFwiY29sLW1kLTkgYm90dG9tLWJ1ZmZlcjJcXFwiIGRhdGEtYmluZD1cXFwidmlzaWJsZTogJGRhdGEuaXNEZXRhaWwoKVxcXCI+XFxuICAgICAgICA8YnV0dG9uIHR5cGU9XFxcImJ1dHRvblxcXCIgY2xhc3M9XFxcImNsb3NlXFxcIiBkYXRhLWJpbmQ9XFxcImNsaWNrOiBmdW5jdGlvbihkYXRhLCBldmVudCkgeyAkcGFyZW50c1sxXS5hYmlsaXR5KCkudG9nZ2xlQWJpbGl0eURldGFpbCgkaW5kZXgsIGRhdGEsIGV2ZW50KTsgfVxcXCI+JnRpbWVzOzwvYnV0dG9uPlxcbiAgICAgICAgPGRpdiBkYXRhLWJpbmQ9XFxcImh0bWw6ICRwYXJlbnRzWzFdLmFiaWxpdHkoKS5nZXRBYmlsaXR5VG9vbHRpcERhdGEoJ25wY19kb3RhX2hlcm9fJyArICRwYXJlbnRzWzFdLmhlcm9JZCgpLCAkZGF0YS5uYW1lKVxcXCI+PC9kaXY+XFxuICAgICAgICA8ZGl2IGRhdGEtYmluZD1cXFwiaWY6ICRkYXRhLm5hbWUgaW4gJHBhcmVudHNbMV0uYWJpbGl0eSgpLmFiaWxpdHlEYXRhICYmICRwYXJlbnRzWzFdLmFiaWxpdHkoKS5hYmlsaXRpZXMoKVskaW5kZXgoKV0ubGV2ZWwoKSA+IDBcXFwiPlxcbiAgICAgICAgICAgIDxkaXYgY2xhc3M9XFxcImNvbC1tZC0xMlxcXCIgc3R5bGU9XFxcIm1hcmdpbi10b3A6IDEwcHhcXFwiID5cXG4gICAgICAgICAgICAgICAgPGRpdiBkYXRhLWJpbmQ9XFxcInRlbXBsYXRlOiB7IG5hbWU6ICdhYmlsaXR5LXNldHRpbmdzLXRlbXBsYXRlJywgZGF0YTogJHBhcmVudHNbMV0uYWJpbGl0eSgpLmFiaWxpdHlTZXR0aW5nc0RhdGEoJGRhdGEubmFtZSwgJHBhcmVudHNbMV0sICRpbmRleCgpKSB9XFxcIj48L2Rpdj5cXG4gICAgICAgICAgICA8L2Rpdj5cXG4gICAgICAgIDwvZGl2PlxcbiAgICA8L2Rpdj5cXG48L2Rpdj5cIiB9KTtcbmtvLmNvbXBvbmVudHMucmVnaXN0ZXIoJ3Nob3AnLCByZXF1aXJlKCcuLi9jb21wb25lbnRzL3Nob3AnKSk7XG5rby5jb21wb25lbnRzLnJlZ2lzdGVyKCdzdGF0JywgeyB0ZW1wbGF0ZTogXCI8c3BhbiBkYXRhLWJpbmQ9XFxcInRleHQ6IHBhcnNlRmxvYXQoaGVyb1tzdGF0XSgpKS50b1N0cmluZygpXFxcIj48L3NwYW4+PHNwYW4gZGF0YS1iaW5kPVxcXCJodG1sOiAkcm9vdC5nZXREaWZmVGV4dChoZXJvLmRpZmZbc3RhdF0oKSksIGRpZmZDc3M6IGhlcm8uZGlmZltzdGF0XSwgZGlmZkNzc1N0YXQ6IHN0YXQsIHZpc2libGU6IGhlcm8uc2hvd0RpZmZcXFwiPjwvc3Bhbj5cIiB9KTtcbmtvLmNvbXBvbmVudHMucmVnaXN0ZXIoJ3N0YXRzMCcsIHsgdGVtcGxhdGU6IFwiPGRpdiBjbGFzcz1cXFwiY29sLW1kLTEyIHN0YXRzMFxcXCIgZGF0YS1iaW5kPVxcXCJjc3M6IHsnY29sLW1kLTEyJzogJHJvb3QubGF5b3V0KCkgPT0gMCwgJ2NvbC1tZC0zJzogJHJvb3QubGF5b3V0KCkgPT0gMX1cXFwiPlxcbiAgICA8dGFibGUgY2xhc3M9XFxcInRhYmxlIHRhYmxlLWNvbmRlbnNlZFxcXCI+XFxuICAgIDx0Ym9keT5cXG4gICAgPHRyPjx0ZD5TdHJlbmd0aDo8L3RkPjx0ZCBjbGFzcz1cXFwidGV4dC1yaWdodFxcXCIgZGF0YS1iaW5kPVxcXCJjb21wb25lbnQ6IHsgbmFtZTogJ3N0YXQnLCBwYXJhbXM6IHsnaGVybyc6ICRkYXRhLCAnc3RhdCc6ICd0b3RhbFN0cicgfSB9XFxcIj48L3RkPjwvdHI+XFxuICAgIDx0cj48dGQ+QWdpbGl0eTo8L3RkPjx0ZCBjbGFzcz1cXFwidGV4dC1yaWdodFxcXCIgZGF0YS1iaW5kPVxcXCJjb21wb25lbnQ6IHsgbmFtZTogJ3N0YXQnLCBwYXJhbXM6IHsnaGVybyc6ICRkYXRhLCAnc3RhdCc6ICd0b3RhbEFnaScgfSB9XFxcIj48L3RkPjwvdHI+XFxuICAgIDx0cj48dGQ+SW50ZWxsaWdlbmNlOjwvdGQ+PHRkIGNsYXNzPVxcXCJ0ZXh0LXJpZ2h0XFxcIiBkYXRhLWJpbmQ9XFxcImNvbXBvbmVudDogeyBuYW1lOiAnc3RhdCcsIHBhcmFtczogeydoZXJvJzogJGRhdGEsICdzdGF0JzogJ3RvdGFsSW50JyB9IH1cXFwiPjwvdGQ+PC90cj5cXG4gICAgPHRyPjx0ZD48YWJiciB0aXRsZT1cXFwiTW92ZW1lbnQgU3BlZWRcXFwiPk1TPC9hYmJyPjo8L3RkPjx0ZCBjbGFzcz1cXFwidGV4dC1yaWdodFxcXCIgZGF0YS1iaW5kPVxcXCJjb21wb25lbnQ6IHsgbmFtZTogJ3N0YXQnLCBwYXJhbXM6IHsnaGVybyc6ICRkYXRhLCAnc3RhdCc6ICd0b3RhbE1vdmVtZW50U3BlZWQnIH0gfVxcXCI+PC90ZD48L3RyPlxcbiAgICA8dHI+PHRkPlR1cm4gUmF0ZTo8L3RkPjx0ZCBjbGFzcz1cXFwidGV4dC1yaWdodFxcXCIgZGF0YS1iaW5kPVxcXCJjb21wb25lbnQ6IHsgbmFtZTogJ3N0YXQnLCBwYXJhbXM6IHsnaGVybyc6ICRkYXRhLCAnc3RhdCc6ICd0b3RhbFR1cm5SYXRlJyB9IH1cXFwiPjwvdGQ+PC90cj5cXG4gICAgPHRyPjx0ZD5TaWdodCBSYW5nZTo8L3RkPjx0ZCBjbGFzcz1cXFwidGV4dC1yaWdodFxcXCI+PHNwYW4gZGF0YS1iaW5kPVxcXCJodG1sOiAnPGFiYnIgdGl0bGU9XFxcXCdEYXlcXFxcJz4nICsgdmlzaW9ucmFuZ2VkYXkoKSArICc8L2FiYnI+LzxhYmJyIHRpdGxlPVxcXFwnTmlnaHRcXFxcJz4nICsgdmlzaW9ucmFuZ2VuaWdodCgpICsgJzwvYWJicj4nXFxcIj48L3NwYW4+PC90ZD48L3RyPlxcbiAgICA8L3Rib2R5PlxcbiAgICA8L3RhYmxlPlxcbjwvZGl2PlwiIH0pO1xua28uY29tcG9uZW50cy5yZWdpc3Rlcignc3RhdHMxJywgeyB0ZW1wbGF0ZTogXCI8ZGl2IGNsYXNzPVxcXCJjb2wtbWQtMTIgc3RhdHMxXFxcIiBkYXRhLWJpbmQ9XFxcImNzczogeydjb2wtbWQtMTInOiAkcm9vdC5sYXlvdXQoKSA9PSAwLCAnY29sLW1kLTMnOiAkcm9vdC5sYXlvdXQoKSA9PSAxfVxcXCI+XFxuICAgIDx0YWJsZSBjbGFzcz1cXFwidGFibGUgdGFibGUtY29uZGVuc2VkXFxcIj5cXG4gICAgPHRib2R5PlxcbiAgICA8dHI+PHRkPkFybW9yOjwvdGQ+PHRkIGNsYXNzPVxcXCJ0ZXh0LXJpZ2h0XFxcIiBkYXRhLWJpbmQ9XFxcImNvbXBvbmVudDogeyBuYW1lOiAnc3RhdCcsIHBhcmFtczogeydoZXJvJzogJGRhdGEsICdzdGF0JzogJ3RvdGFsQXJtb3JQaHlzaWNhbCcgfSB9XFxcIj48L3RkPjwvdHI+XFxuICAgIDx0cj48dGQ+SGVhbHRoOjwvdGQ+PHRkIGNsYXNzPVxcXCJ0ZXh0LXJpZ2h0XFxcIiBkYXRhLWJpbmQ9XFxcImNvbXBvbmVudDogeyBuYW1lOiAnc3RhdCcsIHBhcmFtczogeydoZXJvJzogJGRhdGEsICdzdGF0JzogJ2hlYWx0aCcgfSB9XFxcIj48L3RkPjwvdHI+XFxuICAgIDx0cj48dGQ+SGVhbHRoIFJlZ2VuOjwvdGQ+PHRkIGNsYXNzPVxcXCJ0ZXh0LXJpZ2h0XFxcIiBkYXRhLWJpbmQ9XFxcImNvbXBvbmVudDogeyBuYW1lOiAnc3RhdCcsIHBhcmFtczogeydoZXJvJzogJGRhdGEsICdzdGF0JzogJ2hlYWx0aHJlZ2VuJyB9IH1cXFwiPjwvdGQ+PC90cj5cXG4gICAgPHRyPjx0ZD5NYW5hOjwvdGQ+PHRkIGNsYXNzPVxcXCJ0ZXh0LXJpZ2h0XFxcIiBkYXRhLWJpbmQ9XFxcImNvbXBvbmVudDogeyBuYW1lOiAnc3RhdCcsIHBhcmFtczogeydoZXJvJzogJGRhdGEsICdzdGF0JzogJ21hbmEnIH0gfVxcXCI+PC90ZD48L3RyPlxcbiAgICA8dHI+PHRkPk1hbmEgUmVnZW46PC90ZD48dGQgY2xhc3M9XFxcInRleHQtcmlnaHRcXFwiIGRhdGEtYmluZD1cXFwiY29tcG9uZW50OiB7IG5hbWU6ICdzdGF0JywgcGFyYW1zOiB7J2hlcm8nOiAkZGF0YSwgJ3N0YXQnOiAnbWFuYXJlZ2VuJyB9IH1cXFwiPjwvdGQ+PC90cj5cXG4gICAgPHRyPjx0ZD5QaHlzaWNhbCA8YWJiciB0aXRsZT1cXFwiRWZmZWN0aXZlIEhpdCBQb2ludHNcXFwiPkVIUDwvYWJicj46PC90ZD48dGQgY2xhc3M9XFxcInRleHQtcmlnaHRcXFwiIGRhdGEtYmluZD1cXFwiY29tcG9uZW50OiB7IG5hbWU6ICdzdGF0JywgcGFyYW1zOiB7J2hlcm8nOiAkZGF0YSwgJ3N0YXQnOiAnZWhwUGh5c2ljYWwnIH0gfVxcXCI+PC90ZD48L3RyPlxcbiAgICA8dHI+PHRkPk1hZ2ljYWwgPGFiYnIgdGl0bGU9XFxcIkVmZmVjdGl2ZSBIaXQgUG9pbnRzXFxcIj5FSFA8L2FiYnI+OjwvdGQ+PHRkIGNsYXNzPVxcXCJ0ZXh0LXJpZ2h0XFxcIiBkYXRhLWJpbmQ9XFxcImNvbXBvbmVudDogeyBuYW1lOiAnc3RhdCcsIHBhcmFtczogeydoZXJvJzogJGRhdGEsICdzdGF0JzogJ2VocE1hZ2ljYWwnIH0gfVxcXCI+PC90ZD48L3RyPlxcbiAgICA8L3Rib2R5PlxcbiAgICA8L3RhYmxlPlxcbjwvZGl2PlwiIH0pO1xua28uY29tcG9uZW50cy5yZWdpc3Rlcignc3RhdHMyJywgeyB0ZW1wbGF0ZTogXCI8ZGl2IGNsYXNzPVxcXCJjb2wtbWQtMTIgc3RhdHMyXFxcIiBkYXRhLWJpbmQ9XFxcImNzczogeydjb2wtbWQtMTInOiAkcm9vdC5sYXlvdXQoKSA9PSAwLCAnY29sLW1kLTMnOiAkcm9vdC5sYXlvdXQoKSA9PSAxfVxcXCI+XFxuICAgIDx0YWJsZSBjbGFzcz1cXFwidGFibGUgdGFibGUtY29uZGVuc2VkXFxcIj5cXG4gICAgPHRib2R5PlxcbiAgICA8dHI+PHRkPiVQaHlzIFJlczo8L3RkPjx0ZCBjbGFzcz1cXFwidGV4dC1yaWdodFxcXCIgZGF0YS1iaW5kPVxcXCJjb21wb25lbnQ6IHsgbmFtZTogJ3N0YXQnLCBwYXJhbXM6IHsnaGVybyc6ICRkYXRhLCAnc3RhdCc6ICd0b3RhbEFybW9yUGh5c2ljYWxSZWR1Y3Rpb24nIH0gfVxcXCI+PC90ZD48L3RyPlxcbiAgICA8dHI+PHRkPiVNYWdpYyBSZXM6PC90ZD48dGQgY2xhc3M9XFxcInRleHQtcmlnaHRcXFwiIGRhdGEtYmluZD1cXFwiY29tcG9uZW50OiB7IG5hbWU6ICdzdGF0JywgcGFyYW1zOiB7J2hlcm8nOiAkZGF0YSwgJ3N0YXQnOiAndG90YWxNYWdpY1Jlc2lzdGFuY2UnIH0gfVxcXCI+PC90ZD48L3RyPlxcbiAgICA8dHI+PHRkPiVMaWZlc3RlYWw6PC90ZD48dGQgY2xhc3M9XFxcInRleHQtcmlnaHRcXFwiIGRhdGEtYmluZD1cXFwiY29tcG9uZW50OiB7IG5hbWU6ICdzdGF0JywgcGFyYW1zOiB7J2hlcm8nOiAkZGF0YSwgJ3N0YXQnOiAnbGlmZXN0ZWFsJyB9IH1cXFwiPjwvdGQ+PC90cj5cXG4gICAgPHRyPjx0ZD4lRXZhc2lvbjo8L3RkPjx0ZCBjbGFzcz1cXFwidGV4dC1yaWdodFxcXCIgZGF0YS1iaW5kPVxcXCJjb21wb25lbnQ6IHsgbmFtZTogJ3N0YXQnLCBwYXJhbXM6IHsnaGVybyc6ICRkYXRhLCAnc3RhdCc6ICdldmFzaW9uJyB9IH1cXFwiPjwvdGQ+PC90cj5cXG4gICAgPHRyPjx0ZD4lQmFzaDo8L3RkPjx0ZCBjbGFzcz1cXFwidGV4dC1yaWdodFxcXCIgZGF0YS1iaW5kPVxcXCJjb21wb25lbnQ6IHsgbmFtZTogJ3N0YXQnLCBwYXJhbXM6IHsnaGVybyc6ICRkYXRhLCAnc3RhdCc6ICdiYXNoJyB9IH1cXFwiPjwvdGQ+PC90cj5cXG4gICAgPHRyPjx0ZD4lTWlzcyBDaGFuY2U6PC90ZD48dGQgY2xhc3M9XFxcInRleHQtcmlnaHRcXFwiIGRhdGEtYmluZD1cXFwiY29tcG9uZW50OiB7IG5hbWU6ICdzdGF0JywgcGFyYW1zOiB7J2hlcm8nOiAkZGF0YSwgJ3N0YXQnOiAnbWlzc0NoYW5jZScgfSB9XFxcIj48L3RkPjwvdHI+XFxuICAgIDx0ciBzdHlsZT1cXFwiZGlzcGxheTogbm9uZVxcXCI+PHRkIGNvbHNwYW49Mj48YSBjbGFzcz1cXFwiYnRuIGJ0bi1kZWZhdWx0IGJ0bi1ibG9jayBidG4teHNcXFwiIGRhdGEtYmluZD1cXFwiY3NzOiB7ZGlzYWJsZWQ6IGNyaXRJbmZvKCkuc291cmNlcy5sZW5ndGggPT0gMCA/ICdkaXNhYmxlZCcgOiAnJywgJ3RvZ2dsZWQnOiBzaG93Q3JpdGljYWxTdHJpa2VEZXRhaWxzfSwgdG9nZ2xlOiBzaG93Q3JpdGljYWxTdHJpa2VEZXRhaWxzXFxcIj5Dcml0aWNhbCBTdHJpa2UgRGV0YWlsczwvYT48L3RkPjwvdHI+XFxuICAgIDwvdGJvZHk+XFxuICAgIDx0Ym9keSBjbGFzcz1cXFwidGFibGVkcm9wZG93blxcXCIgc3R5bGU9XFxcImJvcmRlci10b3A6MFxcXCIgZGF0YS1iaW5kPVxcXCJ2aXNpYmxlOiBzaG93Q3JpdGljYWxTdHJpa2VEZXRhaWxzKCksZm9yZWFjaDogY3JpdEluZm8oKS5zb3VyY2VzXFxcIj5cXG4gICAgPHRyPjx0ZCBjb2xzcGFuPTI+PHN0cm9uZyBkYXRhLWJpbmQ9XFxcInRleHQ6ICRkYXRhLm5hbWVcXFwiPjwvc3Ryb25nPjwvdGQ+PC90cj5cXG4gICAgPHRyPjx0ZD5Dcml0IENoYW5jZTo8L3RkPjx0ZCBjbGFzcz1cXFwidGV4dC1yaWdodFxcXCI+PHNwYW4gZGF0YS1iaW5kPVxcXCJ0ZXh0OiAoJGRhdGEudG90YWxjaGFuY2UgKiAxMDApLnRvRml4ZWQoMikgKyAnJSdcXFwiPjwvc3Bhbj48L3RkPjwvdHI+XFxuICAgIDx0cj48dGQ+Q3JpdCBNdWx0aXBsaWVyOjwvdGQ+PHRkIGNsYXNzPVxcXCJ0ZXh0LXJpZ2h0XFxcIj48c3BhbiBkYXRhLWJpbmQ9XFxcInRleHQ6ICgkZGF0YS5tdWx0aXBsaWVyICogMTAwKS50b0ZpeGVkKDIpICsgJyUnXFxcIj48L3NwYW4+PC90ZD48L3RyPlxcbiAgICA8L3Rib2R5PlxcbiAgICA8L3RhYmxlPlxcbjwvZGl2PlwiIH0pO1xua28uY29tcG9uZW50cy5yZWdpc3Rlcignc3RhdHMzJywgeyB0ZW1wbGF0ZTogXCI8ZGl2IGNsYXNzPVxcXCJjb2wtbWQtMTIgc3RhdHMzXFxcIiBkYXRhLWJpbmQ9XFxcImNzczogeydjb2wtbWQtMTInOiAkcm9vdC5sYXlvdXQoKSA9PSAwLCAnY29sLW1kLTMnOiAkcm9vdC5sYXlvdXQoKSA9PSAxfVxcXCI+XFxuICAgIDx0YWJsZSBjbGFzcz1cXFwidGFibGUgdGFibGUtY29uZGVuc2VkXFxcIj5cXG4gICAgPHRib2R5PlxcbiAgICA8dHI+XFxuICAgICAgICA8dGQ+RGFtYWdlOjwvdGQ+XFxuICAgICAgICA8dGQgY2xhc3M9XFxcInRleHQtcmlnaHRcXFwiPlxcbiAgICAgICAgICAgIDxzcGFuIGRhdGEtYmluZD1cXFwiaHRtbDogYmFzZURhbWFnZSgpWzBdLnRvRml4ZWQoMClcXFwiPjwvc3Bhbj5cXG4gICAgICAgICAgICA8c3BhbiBkYXRhLWJpbmQ9XFxcImh0bWw6ICRyb290LmdldERpZmZUZXh0KGRpZmZbJ2Jhc2VEYW1hZ2UnXSgpWzBdKSwgY3NzOiB7J2RpZmZQb3MnOiBkaWZmWydiYXNlRGFtYWdlJ10oKVswXSA+IDAsICdkaWZmTmVnJzogZGlmZlsnYmFzZURhbWFnZSddKClbMF0gPCAwfSwgdmlzaWJsZTogc2hvd0RpZmZcXFwiPjwvc3Bhbj5cXG4gICAgICAgICAgICA8c3Bhbj4mbmRhc2g7PC9zcGFuPlxcbiAgICAgICAgICAgIDxzcGFuIGRhdGEtYmluZD1cXFwiaHRtbDogYmFzZURhbWFnZSgpWzFdLnRvRml4ZWQoMClcXFwiPjwvc3Bhbj5cXG4gICAgICAgICAgICA8c3BhbiBkYXRhLWJpbmQ9XFxcImh0bWw6ICRyb290LmdldERpZmZUZXh0KGRpZmZbJ2Jhc2VEYW1hZ2UnXSgpWzFdKSwgY3NzOiB7J2RpZmZQb3MnOiBkaWZmWydiYXNlRGFtYWdlJ10oKVsxXSA+IDAsICdkaWZmTmVnJzogZGlmZlsnYmFzZURhbWFnZSddKClbMV0gPCAwfSwgdmlzaWJsZTogc2hvd0RpZmZcXFwiPjwvc3Bhbj5cXG4gICAgICAgICAgICA8c3BhbiBzdHlsZT1cXFwiY29sb3I6Z3JlZW5cXFwiIGRhdGEtYmluZD1cXFwidmlzaWJsZTogYm9udXNEYW1hZ2UoKSA+IDAsIGh0bWw6ICcgKyAnICsgYm9udXNEYW1hZ2UoKS50b0ZpeGVkKDApXFxcIj48L3NwYW4+XFxuICAgICAgICAgICAgPHNwYW4gZGF0YS1iaW5kPVxcXCJodG1sOiAkcm9vdC5nZXREaWZmVGV4dChkaWZmWydib251c0RhbWFnZSddKCkpLCBjc3M6IHsnZGlmZlBvcyc6IGRpZmZbJ2JvbnVzRGFtYWdlJ10oKSA+IDAsICdkaWZmTmVnJzogZGlmZlsnYm9udXNEYW1hZ2UnXSgpIDwgMH0sIHZpc2libGU6IHNob3dEaWZmXFxcIj48L3NwYW4+XFxuICAgICAgICAgICAgPHNwYW4gc3R5bGU9XFxcImNvbG9yOnJlZFxcXCIgZGF0YS1iaW5kPVxcXCJ2aXNpYmxlOiBib251c0RhbWFnZVJlZHVjdGlvbigpICE9IDAsIGh0bWw6ICcgLSAnICsgYm9udXNEYW1hZ2VSZWR1Y3Rpb24oKS50b0ZpeGVkKDApXFxcIj48L3NwYW4+XFxuICAgICAgICAgICAgPHNwYW4gZGF0YS1iaW5kPVxcXCJodG1sOiAkcm9vdC5nZXREaWZmVGV4dChkaWZmWydib251c0RhbWFnZVJlZHVjdGlvbiddKCkpLCBjc3M6IHsnZGlmZlBvcyc6IGRpZmZbJ2JvbnVzRGFtYWdlUmVkdWN0aW9uJ10oKSA+IDAsICdkaWZmTmVnJzogZGlmZlsnYm9udXNEYW1hZ2VSZWR1Y3Rpb24nXSgpIDwgMH0sIHZpc2libGU6IHNob3dEaWZmXFxcIj48L3NwYW4+XFxuICAgICAgICA8L3RkPlxcbiAgICA8L3RyPlxcbiAgICA8dHI+PHRkPjxhYmJyIHRpdGxlPVxcXCJJbmNyZWFzZWQgQXR0YWNrIFNwZWVkXFxcIj5JQVM8L2FiYnI+OjwvdGQ+PHRkIGNsYXNzPVxcXCJ0ZXh0LXJpZ2h0XFxcIiBkYXRhLWJpbmQ9XFxcImNvbXBvbmVudDogeyBuYW1lOiAnc3RhdCcsIHBhcmFtczogeydoZXJvJzogJGRhdGEsICdzdGF0JzogJ2lhcycgfSB9XFxcIj48L3RkPjwvdHI+XFxuICAgIDx0cj48dGQ+PGFiYnIgdGl0bGU9XFxcIkJhc2UgQXR0YWNrIFRpbWVcXFwiPkJBVDwvYWJicj46PC90ZD48dGQgY2xhc3M9XFxcInRleHQtcmlnaHRcXFwiIGRhdGEtYmluZD1cXFwiY29tcG9uZW50OiB7IG5hbWU6ICdzdGF0JywgcGFyYW1zOiB7J2hlcm8nOiAkZGF0YSwgJ3N0YXQnOiAnYmF0JyB9IH1cXFwiPjwvdGQ+PC90cj5cXG4gICAgPHRyPjx0ZD5BdHRhY2sgVGltZTo8L3RkPjx0ZCBjbGFzcz1cXFwidGV4dC1yaWdodFxcXCIgZGF0YS1iaW5kPVxcXCJjb21wb25lbnQ6IHsgbmFtZTogJ3N0YXQnLCBwYXJhbXM6IHsnaGVybyc6ICRkYXRhLCAnc3RhdCc6ICdhdHRhY2tUaW1lJyB9IH1cXFwiPjwvdGQ+PC90cj5cXG4gICAgPHRyPjx0ZD5BdHRhY2sgJmZyYXNsOyBTZWM6PC90ZD48dGQgY2xhc3M9XFxcInRleHQtcmlnaHRcXFwiIGRhdGEtYmluZD1cXFwiY29tcG9uZW50OiB7IG5hbWU6ICdzdGF0JywgcGFyYW1zOiB7J2hlcm8nOiAkZGF0YSwgJ3N0YXQnOiAnYXR0YWNrc1BlclNlY29uZCcgfSB9XFxcIj48L3RkPjwvdHI+XFxuICAgIDx0cj48dGQ+QXR0YWNrIFJhbmdlOjwvdGQ+PHRkIGNsYXNzPVxcXCJ0ZXh0LXJpZ2h0XFxcIiBkYXRhLWJpbmQ9XFxcImNvbXBvbmVudDogeyBuYW1lOiAnc3RhdCcsIHBhcmFtczogeydoZXJvJzogJGRhdGEsICdzdGF0JzogJ3RvdGFsYXR0YWNrcmFuZ2UnIH0gfVxcXCI+PC90ZD48L3RyPlxcbiAgICA8L3Rib2R5PlxcbiAgICA8L3RhYmxlPlxcbjwvZGl2PlwiIH0pO1xua28uY29tcG9uZW50cy5yZWdpc3Rlcignc3RhdHMtYWRkaXRpb25hbCcsIHsgdGVtcGxhdGU6IFwiPHRhYmxlIGNsYXNzPVxcXCJ0YWJsZSB0YWJsZS1jb25kZW5zZWRcXFwiPlxcbiAgICA8dGJvZHk+XFxuICAgICAgICA8dHI+PHRkPkJhc2UgU3RyZW5ndGg6PC90ZD48dGQgY2xhc3M9XFxcInRleHQtcmlnaHRcXFwiPjxzcGFuIGRhdGEtYmluZD1cXFwidGV4dDogaGVyb0RhdGEoKS5hdHRyaWJ1dGViYXNlc3RyZW5ndGhcXFwiPjwvc3Bhbj48L3RkPjwvdHI+XFxuICAgICAgICA8dHI+PHRkPlN0cmVuZ3RoIEdhaW46PC90ZD48dGQgY2xhc3M9XFxcInRleHQtcmlnaHRcXFwiPjxzcGFuIGRhdGEtYmluZD1cXFwidGV4dDogaGVyb0RhdGEoKS5hdHRyaWJ1dGVzdHJlbmd0aGdhaW5cXFwiPjwvc3Bhbj48L3RkPjwvdHI+XFxuICAgICAgICA8dHI+PHRkPkJhc2UgQWdpbGl0eTo8L3RkPjx0ZCBjbGFzcz1cXFwidGV4dC1yaWdodFxcXCI+PHNwYW4gZGF0YS1iaW5kPVxcXCJ0ZXh0OiBoZXJvRGF0YSgpLmF0dHJpYnV0ZWJhc2VhZ2lsaXR5XFxcIj48L3NwYW4+PC90ZD48L3RyPlxcbiAgICAgICAgPHRyPjx0ZD5BZ2lsaXR5IEdhaW46PC90ZD48dGQgY2xhc3M9XFxcInRleHQtcmlnaHRcXFwiPjxzcGFuIGRhdGEtYmluZD1cXFwidGV4dDogaGVyb0RhdGEoKS5hdHRyaWJ1dGVhZ2lsaXR5Z2FpblxcXCI+PC9zcGFuPjwvdGQ+PC90cj5cXG4gICAgICAgIDx0cj48dGQ+QmFzZSBJbnRlbGxpZ2VuY2U6PC90ZD48dGQgY2xhc3M9XFxcInRleHQtcmlnaHRcXFwiPjxzcGFuIGRhdGEtYmluZD1cXFwidGV4dDogaGVyb0RhdGEoKS5hdHRyaWJ1dGViYXNlaW50ZWxsaWdlbmNlXFxcIj48L3NwYW4+PC90ZD48L3RyPlxcbiAgICAgICAgPHRyPjx0ZD5JbnRlbGxpZ2VuY2UgR2Fpbjo8L3RkPjx0ZCBjbGFzcz1cXFwidGV4dC1yaWdodFxcXCI+PHNwYW4gZGF0YS1iaW5kPVxcXCJ0ZXh0OiBoZXJvRGF0YSgpLmF0dHJpYnV0ZWludGVsbGlnZW5jZWdhaW5cXFwiPjwvc3Bhbj48L3RkPjwvdHI+XFxuICAgICAgICA8dHI+PHRkPkJhc2UgQXJtb3I6PC90ZD48dGQgY2xhc3M9XFxcInRleHQtcmlnaHRcXFwiPjxzcGFuIGRhdGEtYmluZD1cXFwidGV4dDogaGVyb0RhdGEoKS5hcm1vcnBoeXNpY2FsXFxcIj48L3NwYW4+PC90ZD48L3RyPlxcbiAgICAgICAgPHRyPjx0ZD48YWJiciB0aXRsZT1cXFwiQmFzZSBBcm1vciArIGFybW9yIGZyb20gYmFzZSBhZ2lsaXR5XFxcIj5TdGFydGluZyBBcm1vcjo8L2FiYnI+PC90ZD48dGQgY2xhc3M9XFxcInRleHQtcmlnaHRcXFwiPjxzcGFuIGRhdGEtYmluZD1cXFwidGV4dDogcGFyc2VGbG9hdCgkZGF0YS5zdGFydGluZ0FybW9yKCkpLnRvU3RyaW5nKClcXFwiPjwvc3Bhbj48L3RkPjwvdHI+XFxuICAgICAgICA8dHI+PHRkPkJhc2UgTWFnaWMgUmVzOjwvdGQ+PHRkIGNsYXNzPVxcXCJ0ZXh0LXJpZ2h0XFxcIj48c3BhbiBkYXRhLWJpbmQ9XFxcInRleHQ6IGhlcm9EYXRhKCkubWFnaWNhbHJlc2lzdGFuY2UgKyAnJSdcXFwiPjwvc3Bhbj48L3RkPjwvdHI+XFxuICAgICAgICA8dHI+PHRkPkJhc2UgQXR0YWNrIFBvaW50OjwvdGQ+PHRkIGNsYXNzPVxcXCJ0ZXh0LXJpZ2h0XFxcIj48c3BhbiBkYXRhLWJpbmQ9XFxcInRleHQ6IGhlcm9EYXRhKCkuYXR0YWNrcG9pbnRcXFwiPjwvc3Bhbj48L3RkPjwvdHI+XFxuICAgICAgICA8dHI+PHRkPjxhYmJyIGRhdGEtYmluZD1cXFwiYXR0cjogeyB0aXRsZTogJ1RvdGFsIGV4cGVyaWVuY2UgcmVxdWlyZWQgdG8gcmVhY2ggbGV2ZWwgJyArICRkYXRhLnNlbGVjdGVkSGVyb0xldmVsKCkgfVxcXCI+VG90YWwgRXhwOjwvYWJicj48L3RkPjx0ZCBjbGFzcz1cXFwidGV4dC1yaWdodFxcXCI+PHNwYW4gZGF0YS1iaW5kPVxcXCJ0ZXh0OiAkZGF0YS50b3RhbEV4cCgpXFxcIj48L3NwYW4+PC9zcGFuPjwvdGQ+PC90cj5cXG4gICAgICAgIDx0cj48dGQ+PGFiYnIgdGl0bGU9XFxcIkV4cGVyaWVuY2UgcmVxdWlyZWQgZm9yIG5leHQgbGV2ZWxcXFwiPk5leHQgbGV2ZWwgZXhwOjwvYWJicj48L3RkPjx0ZCBjbGFzcz1cXFwidGV4dC1yaWdodFxcXCI+PHNwYW4gZGF0YS1iaW5kPVxcXCJodG1sOiAkZGF0YS5uZXh0TGV2ZWxFeHAoKVxcXCI+PC9zcGFuPjwvc3Bhbj48L3RkPjwvdHI+XFxuICAgICAgICA8dHI+PHRkPlJlc3Bhd24gVGltZTo8L3RkPjx0ZCBjbGFzcz1cXFwidGV4dC1yaWdodFxcXCI+PHNwYW4gZGF0YS1iaW5kPVxcXCJ0ZXh0OiAkZGF0YS5yZXNwYXduVGltZSgpXFxcIj48L3NwYW4+PC90ZD48L3RyPlxcbiAgICA8L3Rib2R5PlxcbjwvdGFibGU+XCIgfSk7XG5cbi8vIFRoZSBhcHAgZXh0ZW5kcyB0aGUgaGVyb2NhbGMgbGlicmFyeSwgcHJvdmlkZXMgYSBmcm9udGVuZFxudmFyIG15ID0gcmVxdWlyZShcIi4uL2hlcm9jYWxjL21haW5cIik7XG52YXIgZ2V0SXRlbVRvb2x0aXBEYXRhID0gcmVxdWlyZShcIi4uL2hlcm9jYWxjL2hlcm9jYWxjX3Rvb2x0aXBzX2l0ZW1cIik7XG52YXIgZ2V0QWJpbGl0eVRvb2x0aXBEYXRhID0gcmVxdWlyZShcIi4uL2hlcm9jYWxjL2hlcm9jYWxjX3Rvb2x0aXBzX2FiaWxpdHlcIik7XG5teS5wcm90b3R5cGUuQWJpbGl0eU1vZGVsLnByb3RvdHlwZS5nZXRBYmlsaXR5VG9vbHRpcERhdGEgPSBmdW5jdGlvbiAoaGVybywgZWwpIHtcbiAgICByZXR1cm4gZ2V0QWJpbGl0eVRvb2x0aXBEYXRhKG15LnByb3RvdHlwZS5oZXJvRGF0YSwgbXkucHJvdG90eXBlLnVuaXREYXRhLCBoZXJvLCBlbCk7XG59XG4vL3JlcXVpcmUoXCIuL2hlcm9jYWxjX3Rvb2x0aXBzXCIpO1xucmVxdWlyZShcIi4vaGVyb3ZpZXdtb2RlbFwiKTtcblxubXkucHJvdG90eXBlLlBsYXllckNvbG9ycyA9IFtcbiAgICBcIiMyRTZBRTZcIiwgLy9CbHVlXG4gICAgXCIjNURFNkFEXCIsIC8vVGVhbFxuICAgIFwiI0FEMDBBRFwiLCAvL1B1cnBsZVxuICAgIFwiI0RDRDkwQVwiLCAvL1llbGxvd1xuICAgIFwiI0U2NjIwMFwiLCAvL09yYW5nZVxuICAgIFwiI0U2N0FCMFwiLCAvL1BpbmtcbiAgICBcIiM5MkE0NDBcIiwgLy9QdXMgWWVsbG93XG4gICAgXCIjNUNDNUUwXCIsIC8vTGlnaHQgQmx1ZVxuICAgIFwiIzAwNzcxRlwiLCAvL0dyZWVuXG4gICAgXCIjOTU2MDAwXCIgLy9Ccm93blxuXTtcblxubXkucHJvdG90eXBlLlRhYiA9IGZ1bmN0aW9uIChpZCwgaHJlZiwgZGF0YSwgdGV4dCwgY29sb3IsIHRlbXBsYXRlKSB7XG4gICAgdmFyIHNlbGYgPSB0aGlzO1xuICAgIHNlbGYuaWQgPSBpZDtcbiAgICBzZWxmLmhyZWYgPSBocmVmO1xuICAgIHNlbGYuY29sb3IgPSBjb2xvcjtcbiAgICBzZWxmLmRhdGEgPSBkYXRhO1xuICAgIHNlbGYuZGF0YS5pZCA9IGtvLm9ic2VydmFibGUoc2VsZi5ocmVmKTtcbiAgICBzZWxmLnRleHQgPSB0ZXh0O1xuICAgIHNlbGYudGVtcGxhdGUgPSB0ZW1wbGF0ZTtcbiAgICByZXR1cm4gc2VsZjtcbn1cbm15LnByb3RvdHlwZS5UYWIucHJvdG90eXBlLnRvSlMgPSBmdW5jdGlvbiAoKSB7XG4gICAgcmV0dXJuIHtcbiAgICAgICAgaWQ6IHRoaXMuaWQsXG4gICAgICAgIGhyZWY6IHRoaXMuaHJlZixcbiAgICAgICAgY29sb3I6IHRoaXMuY29sb3IsXG4gICAgICAgIHRleHQ6IHRoaXMudGV4dCxcbiAgICAgICAgdGVtcGxhdGU6IHRoaXMudGVtcGxhdGVcbiAgICB9XG59XG5cbm15LnByb3RvdHlwZS5UYWJHcm91cCA9IGZ1bmN0aW9uIChoZXJvLCB1bml0LCBjbG9uZSkge1xuICAgIHZhciBzZWxmID0gdGhpcztcbiAgICBzZWxmLmhlcm8gPSBoZXJvO1xuICAgIHNlbGYudW5pdCA9IHVuaXQ7XG4gICAgc2VsZi5jbG9uZSA9IGNsb25lO1xuICAgIHNlbGYuaWxsdXNpb25zID0ga28ub2JzZXJ2YWJsZUFycmF5KFtdKTtcbiAgICByZXR1cm4gc2VsZjtcbn1cbm15LnByb3RvdHlwZS5UYWJHcm91cC5wcm90b3R5cGUudG9KUyA9IGZ1bmN0aW9uICgpIHtcbiAgICByZXR1cm4ge1xuICAgICAgICBoZXJvOiB0aGlzLmhlcm8udG9KUygpLFxuICAgICAgICB1bml0OiB0aGlzLnVuaXQudG9KUygpLFxuICAgICAgICBjbG9uZTogdGhpcy5jbG9uZS50b0pTKCksXG4gICAgICAgIGlsbHVzaW9uczogdGhpcy5pbGx1c2lvbnMoKS5tYXAoZnVuY3Rpb24gKGlsbHVzaW9uKSB7IHJldHVybiBpbGx1c2lvbi50b0pTKCk7IH0pXG4gICAgfVxufVxuXG5teS5wcm90b3R5cGUuSGVyb0NhbGN1bGF0b3JWaWV3TW9kZWwgPSBmdW5jdGlvbiAoKSB7XG4gICAgdmFyIHNlbGYgPSB0aGlzO1xuICAgIHNlbGYuaGVyb2VzID0gW107XG5cbiAgICBmb3IgKHZhciBpID0gMDsgaSA8IDEwOyBpKyspIHtcbiAgICAgICAgc2VsZi5oZXJvZXMucHVzaChuZXcgbXkucHJvdG90eXBlLkhlcm9DYWxjdWxhdG9yTW9kZWwoaSkpO1xuICAgIH1cbiAgICBcbiAgICBmb3IgKHZhciBpID0gMDsgaSA8IDU7IGkrKykge1xuICAgICAgICB2YXIgYXJyID0gW107XG4gICAgICAgIGZvciAodmFyIGogPSA1OyBqIDwgMTA7IGorKykge1xuICAgICAgICAgICAgYXJyLnB1c2goc2VsZi5oZXJvZXNbal0pO1xuICAgICAgICB9XG4gICAgICAgIHNlbGYuaGVyb2VzW2ldLmVuZW1pZXMucHVzaC5hcHBseShzZWxmLmhlcm9lc1tpXS5lbmVtaWVzLCBhcnIpO1xuICAgIH1cbiAgICBmb3IgKHZhciBpID0gNTsgaSA8IDEwOyBpKyspIHtcbiAgICAgICAgdmFyIGFyciA9IFtdO1xuICAgICAgICBmb3IgKHZhciBqID0gMDsgaiA8IDU7IGorKykge1xuICAgICAgICAgICAgYXJyLnB1c2goc2VsZi5oZXJvZXNbal0pO1xuICAgICAgICB9XG4gICAgICAgIHNlbGYuaGVyb2VzW2ldLmVuZW1pZXMucHVzaC5hcHBseShzZWxmLmhlcm9lc1tpXS5lbmVtaWVzLCBhcnIpO1xuICAgIH1cbiAgICBmb3IgKHZhciBpID0gMDsgaSA8IDEwOyBpKyspIHtcbiAgICAgICAgdmFyIGFyciA9IFtdO1xuICAgICAgICBmb3IgKHZhciBqID0gMDsgaiA8IDEwOyBqKyspIHtcbiAgICAgICAgICAgIGlmIChpICE9PSBqKSBhcnIucHVzaChzZWxmLmhlcm9lc1tqXSk7XG4gICAgICAgIH1cbiAgICAgICAgc2VsZi5oZXJvZXNbaV0ub3RoZXJIZXJvZXMucHVzaC5hcHBseShzZWxmLmhlcm9lc1tpXS5vdGhlckhlcm9lcywgYXJyKTtcbiAgICB9XG4gICAgXG4gICAgZm9yICh2YXIgaSA9IDA7IGkgPCAxMDsgaSsrKSB7XG4gICAgICAgIHNlbGYuaGVyb2VzW2ldLmNsb25lID0ga28ub2JzZXJ2YWJsZShuZXcgbXkucHJvdG90eXBlLkNsb25lVmlld01vZGVsKCdtZWVwbycsIHNlbGYuaGVyb2VzW2ldKSk7XG4gICAgICAgIHNlbGYuaGVyb2VzW2ldLnVuaXQgPSBrby5vYnNlcnZhYmxlKG5ldyBteS5wcm90b3R5cGUuVW5pdFZpZXdNb2RlbCgnYWJhZGRvbicsIHNlbGYuaGVyb2VzW2ldKSk7XG4gICAgICAgIFxuICAgICAgICBzZWxmLmhlcm9lc1tpXS5zZWxlY3RlZENvbXBhcmUoc2VsZi5oZXJvZXNbaV0uYXZhaWxhYmxlQ29tcGFyZSgpW2kgPCA1ID8gNCArIGkgOiBpIC0gNV0pO1xuICAgICAgICBzZWxmLmhlcm9lc1tpXS5zZWxlY3RlZEVuZW15KHNlbGYuaGVyb2VzW2ldLmF2YWlsYWJsZUVuZW1pZXMoKVtpICUgNV0pO1xuICAgICAgICAvL3NlbGYuaGVyb2VzW2ldLmVuZW15ID0ga28ub2JzZXJ2YWJsZShzZWxmLmhlcm9lc1tpIDwgMiA/IDIgOiAwXSk7XG4gICAgICAgIHNlbGYuaGVyb2VzW2ldLnVuaXQoKS5lbmVteShzZWxmLmhlcm9lc1tpXS5lbmVteSgpKTtcbiAgICAgICAgLy9zZWxmLmhlcm9lc1tpXS51bml0KCkuZW5lbXkgPSBrby5vYnNlcnZhYmxlKHNlbGYuaGVyb2VzW2kgPCAyID8gMiA6IDBdKTtcbiAgICAgICAgLy9zZWxmLmhlcm9lc1tpXS5oZXJvQ29tcGFyZSA9IGtvLm9ic2VydmFibGUoc2VsZi5oZXJvZXNbMSAtIChpICUgMikgKyAoaSA8IDIgPyAwIDogMildKTtcbiAgICAgICAgXG4gICAgICAgIHNlbGYuaGVyb2VzW2ldLnVuaXQoKS5zZWxlY3RlZFVuaXQoc2VsZi5oZXJvZXNbaV0udW5pdCgpLmF2YWlsYWJsZVVuaXRzKClbMF0pO1xuICAgICAgICAvL3NlbGYuaGVyb2VzW2ldLnNlbGVjdGVkSGVybyhzZWxmLmhlcm9lc1tpXS5hdmFpbGFibGVIZXJvZXMoKVtpIDwgMiA/IDAgOiAyXSk7XG4gICAgICAgIHNlbGYuaGVyb2VzW2ldLmlsbHVzaW9ucy5zdWJzY3JpYmUoZnVuY3Rpb24gKGNoYW5nZXMpIHtcbiAgICAgICAgICAgIGZvciAodmFyIGkgPSAwOyBpIDwgY2hhbmdlcy5sZW5ndGg7IGkrKykge1xuICAgICAgICAgICAgICAgIGlmIChjaGFuZ2VzW2ldLnN0YXR1cyA9PSAnYWRkZWQnKSB7XG4gICAgICAgICAgICAgICAgICAgIHZhciBjb2xvciA9IHRoaXMuaW5kZXggPCAyID8gJyM1Y2I4NWMnIDogJyNkOTUzNGYnLFxuICAgICAgICAgICAgICAgICAgICAgICAgaiA9IG15LnByb3RvdHlwZS51bmlxdWVJZCgpO1xuICAgICAgICAgICAgICAgICAgICBzZWxmLnRhYnMoKVt0aGlzLmluZGV4XS5pbGx1c2lvbnMucHVzaChcbiAgICAgICAgICAgICAgICAgICAgICAgIG5ldyBteS5wcm90b3R5cGUuVGFiKFxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICdpbGx1c2lvblRhYicgKyB0aGlzLmluZGV4ICsgJy0nICsgaixcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAnaWxsdXNpb25QYW5lJyArIHRoaXMuaW5kZXggKyAnLScgKyBqLFxuICAgICAgICAgICAgICAgICAgICAgICAgICAgIHNlbGYuaGVyb2VzW3RoaXMuaW5kZXhdLmlsbHVzaW9ucygpW3NlbGYudGFicygpW3RoaXMuaW5kZXhdLmlsbHVzaW9ucygpLmxlbmd0aF0oKSxcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAnSWxsdXNpb24gJyArIGosXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgY29sb3IsXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgJ2lsbHVzaW9uLXBhbmUnKVxuICAgICAgICAgICAgICAgICAgICApO1xuICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgIH1cbiAgICAgICAgfSwge3ZtOiB0aGlzLCBpbmRleDogaX0sIFwiYXJyYXlDaGFuZ2VcIik7XG4gICAgfVxuICAgIC8vc2VsZi5oZXJvZXNbMF0uc2hvd1VuaXRUYWIodHJ1ZSk7XG4gICAgc2VsZi5oZXJvZXNbMF0uYm91bmQodHJ1ZSk7XG4gICAgc2VsZi50YWJzID0ga28ub2JzZXJ2YWJsZUFycmF5KFtdKTtcbiAgICB2YXIgdGFic0FyciA9IFtdO1xuICAgIGZvciAodmFyIGkgPSAwOyBpIDwgMTA7IGkrKykge1xuICAgICAgICAvL3ZhciBjb2xvciA9IGkgPCA1ID8gJyM1Y2I4NWMnIDogJyNkOTUzNGYnO1xuICAgICAgICB2YXIgY29sb3IgPSBteS5wcm90b3R5cGUuUGxheWVyQ29sb3JzW2ldO1xuICAgICAgICB2YXIgdGFiR3JvdXAgPSBuZXcgbXkucHJvdG90eXBlLlRhYkdyb3VwKFxuICAgICAgICAgICAgbmV3IG15LnByb3RvdHlwZS5UYWIoJ2hlcm9UYWInICsgaSwgJ2hlcm9QYW5lJyArIGksIHNlbGYuaGVyb2VzW2ldLCAnSGVybyAnICsgaSwgY29sb3IsICdoZXJvLXBhbmUnKSxcbiAgICAgICAgICAgIG5ldyBteS5wcm90b3R5cGUuVGFiKCd1bml0VGFiJyArIGksICd1bml0UGFuZScgKyBpLCBzZWxmLmhlcm9lc1tpXS51bml0KCksICdVbml0ICcgKyBpLCBjb2xvciwgJ3VuaXQtcGFuZScpLFxuICAgICAgICAgICAgbmV3IG15LnByb3RvdHlwZS5UYWIoJ2Nsb25lVGFiJyArIGksICdjbG9uZVBhbmUnICsgaSwgc2VsZi5oZXJvZXNbaV0uY2xvbmUoKSwgJ01lZXBvIENsb25lICcgKyBpLCBjb2xvciwgJ2Nsb25lLXBhbmUnKVxuICAgICAgICApO1xuICAgICAgICAvL3NlbGYudGFicy5wdXNoKHRhYkdyb3VwKTtcbiAgICAgICAgdGFic0Fyci5wdXNoKHRhYkdyb3VwKTtcbiAgICB9XG4gICAgc2VsZi50YWJzLnB1c2guYXBwbHkoc2VsZi50YWJzLCB0YWJzQXJyKTsvLy5zbGljZSgwLCAxKSk7XG5cbiAgICBzZWxmLnNlbGVjdGVkSXRlbSA9IGtvLm9ic2VydmFibGUoKTtcbiAgICBzZWxmLmxheW91dCA9IGtvLm9ic2VydmFibGUoXCIxXCIpO1xuICAgIHNlbGYuZGlzcGxheVNob3AgPSBrby5vYnNlcnZhYmxlKHRydWUpO1xuICAgIHNlbGYuZGlzcGxheVNob3BJdGVtVG9vbHRpcCA9IGtvLm9ic2VydmFibGUodHJ1ZSk7XG4gICAgc2VsZi5hbGxJdGVtcyA9IGtvLm9ic2VydmFibGVBcnJheShbXG4gICAgICAgIHtuYW1lOiAnU3RyLCBBZ2ksIEludCwgTVMsIFR1cm4sIFNpZ2h0JywgdmFsdWU6ICdzdGF0czAnfSxcbiAgICAgICAge25hbWU6ICdBcm1vciwgSGVhbHRoLCBNYW5hLCBSZWdlbiwgRUhQJywgdmFsdWU6ICdzdGF0czEnfSxcbiAgICAgICAge25hbWU6ICdQaHlzIFJlcywgTWFnaWMgUmVzLCBMaWZlc3RlYWwsIEV2YXNpb24sIEJhc2gsIE1pc3MnLCB2YWx1ZTogJ3N0YXRzMid9LFxuICAgICAgICB7bmFtZTogJ0RhbWFnZSwgSUFTLCBCQVQsIEF0dGFjaycsIHZhbHVlOiAnc3RhdHMzJ31cbiAgICBdKTsgLy8gSW5pdGlhbCBpdGVtc1xuICAgIHNlbGYuc2VsZWN0ZWRJdGVtcyA9IGtvLm9ic2VydmFibGVBcnJheShbXSk7IFxuICAgIHNlbGYubW92ZVVwID0gZnVuY3Rpb24gKCkge1xuICAgICAgICB2YXIgc3RhcnQgPSBzZWxmLmFsbEl0ZW1zLmluZGV4T2Yoc2VsZi5zZWxlY3RlZEl0ZW1zKClbMF0pLFxuICAgICAgICAgICAgZW5kID0gc2VsZi5hbGxJdGVtcy5pbmRleE9mKHNlbGYuc2VsZWN0ZWRJdGVtcygpW3NlbGYuc2VsZWN0ZWRJdGVtcygpLmxlbmd0aCAtIDFdKTtcbiAgICAgICAgaWYgKHN0YXJ0ID4gMCkge1xuICAgICAgICAgICAgdmFyIGUgPSBzZWxmLmFsbEl0ZW1zLnNwbGljZShzdGFydCAtIDEsIDEpO1xuICAgICAgICAgICAgc2VsZi5hbGxJdGVtcy5zcGxpY2UoZW5kLCAwLCBlWzBdKTsgICAgICAgICAgICBcbiAgICAgICAgfVxuICAgIH07XG4gICAgc2VsZi5tb3ZlRG93biA9IGZ1bmN0aW9uICgpIHtcbiAgICAgICAgdmFyIHN0YXJ0ID0gc2VsZi5hbGxJdGVtcy5pbmRleE9mKHNlbGYuc2VsZWN0ZWRJdGVtcygpWzBdKSxcbiAgICAgICAgICAgIGVuZCA9IHNlbGYuYWxsSXRlbXMuaW5kZXhPZihzZWxmLnNlbGVjdGVkSXRlbXMoKVtzZWxmLnNlbGVjdGVkSXRlbXMoKS5sZW5ndGggLSAxXSk7ICAgICAgICBcbiAgICAgICAgaWYgKGVuZCA8IHNlbGYuYWxsSXRlbXMoKS5sZW5ndGggLSAxKSB7XG4gICAgICAgICAgICB2YXIgZSA9IHNlbGYuYWxsSXRlbXMuc3BsaWNlKGVuZCArIDEsIDEpO1xuICAgICAgICAgICAgc2VsZi5hbGxJdGVtcy5zcGxpY2Uoc3RhcnQsIDAsIGVbMF0pO1xuICAgICAgICB9XG4gICAgfTtcbiAgICBzZWxmLnNlbGVjdGVkVGFiSWQgPSBrby5vYnNlcnZhYmxlKCdoZXJvVGFiMCcpO1xuICAgIHNlbGYuZ2V0U2VsZWN0ZWRUYWIgPSBmdW5jdGlvbiAodGFiSWQpIHtcbiAgICAgICAgdmFyIGluZGljZXMgPSB0YWJJZC5yZXBsYWNlKCdoZXJvVGFiJywgJycpLnJlcGxhY2UoJ2Nsb25lVGFiJywgJycpLnJlcGxhY2UoJ3VuaXRUYWInLCAnJykucmVwbGFjZSgnaWxsdXNpb25UYWInLCAnJykuc3BsaXQoJy0nKSxcbiAgICAgICAgICAgIGluZGV4ID0gaW5kaWNlc1swXSxcbiAgICAgICAgICAgIHRhYiA9IHNlbGYudGFicygpW2luZGV4XTtcbiAgICAgICAgcmV0dXJuIHRhYjtcbiAgICB9XG4gICAgc2VsZi5zZWxlY3RlZFRhYiA9IGtvLmNvbXB1dGVkKGZ1bmN0aW9uICgpIHtcbiAgICAgICAgLyp2YXIgaW5kaWNlcyA9IHNlbGYuc2VsZWN0ZWRUYWJJZCgpLnJlcGxhY2UoJ2hlcm9UYWInLCAnJykucmVwbGFjZSgnY2xvbmVUYWInLCAnJykucmVwbGFjZSgndW5pdFRhYicsICcnKS5yZXBsYWNlKCdpbGx1c2lvblRhYicsICcnKS5zcGxpdCgnLScpLFxuICAgICAgICAgICAgaW5kZXggPSBpbmRpY2VzWzBdLFxuICAgICAgICAgICAgdGFiID0gc2VsZi50YWJzKClbaW5kZXhdOyovXG4gICAgICAgIHZhciB0YWIgPSBzZWxmLmdldFNlbGVjdGVkVGFiKHNlbGYuc2VsZWN0ZWRUYWJJZCgpKTtcbiAgICAgICAgaWYgKHNlbGYuc2VsZWN0ZWRUYWJJZCgpLmluZGV4T2YoJ2hlcm8nKSAhPSAtMSkge1xuICAgICAgICAgICAgcmV0dXJuIHRhYi5oZXJvO1xuICAgICAgICB9XG4gICAgICAgIGVsc2UgaWYgKHNlbGYuc2VsZWN0ZWRUYWJJZCgpLmluZGV4T2YoJ3VuaXQnKSAhPSAtMSkge1xuICAgICAgICAgICAgcmV0dXJuIHRhYi51bml0O1xuICAgICAgICB9XG4gICAgICAgIGVsc2UgaWYgKHNlbGYuc2VsZWN0ZWRUYWJJZCgpLmluZGV4T2YoJ2Nsb25lJykgIT0gLTEpIHtcbiAgICAgICAgICAgIHJldHVybiB0YWIuY2xvbmU7XG4gICAgICAgIH1cbiAgICAgICAgZWxzZSBpZiAoc2VsZi5zZWxlY3RlZFRhYklkKCkuaW5kZXhPZignaWxsdXNpb24nKSAhPSAtMSkge1xuICAgICAgICAgICAgcmV0dXJuIHRhYi5pbGx1c2lvbnMoKS5maW5kKGZ1bmN0aW9uICh0YWIpIHtcbiAgICAgICAgICAgICAgICByZXR1cm4gdGFiLmlkID09IHNlbGYuc2VsZWN0ZWRUYWJJZCgpO1xuICAgICAgICAgICAgfSk7XG4gICAgICAgIH1cbiAgICAgICAgZWxzZSB7XG4gICAgICAgICAgICByZXR1cm4gc2VsZi50YWJzKClbMF0uaGVybztcbiAgICAgICAgfVxuICAgIH0pO1xuICAgIHNlbGYuc2VsZWN0ZWRUYWJzID0ga28ub2JzZXJ2YWJsZUFycmF5KFsnaGVyb1RhYjAnLCAnaGVyb1RhYjEnXSk7XG4gICAgLy9zZWxmLnNlbGVjdGVkVGFicy5wdXNoKCdoZXJvVGFiMCcpO1xuICAgIC8vc2VsZi5zZWxlY3RlZFRhYnMucHVzaCgnaGVyb1RhYjEnKTtcbiAgICBzZWxmLmJvdW5kU2V0dGluZ3MgPSBrby5vYnNlcnZhYmxlKGZhbHNlKTtcbiAgICBzZWxmLmNsaWNrVGFiID0gZnVuY3Rpb24gKGRhdGEsIGV2ZW50LCBpbmRleCkge1xuICAgICAgICAvKmlmIChldmVudC50YXJnZXQuaWQgIT0gJ3NldHRpbmdzVGFiJykge1xuICAgICAgICAgICAgc2VsZi5zZWxlY3RlZFRhYklkKGV2ZW50LnRhcmdldC5pZCk7XG4gICAgICAgIH0qL1xuICAgICAgICBzZWxmLnNlbGVjdGVkVGFiSWQoZXZlbnQudGFyZ2V0LmlkKTtcbiAgICAgICAgaWYgKHNlbGYuc2VsZWN0ZWRUYWJzKClbMV0gIT0gZXZlbnQudGFyZ2V0LmlkKSB7XG4gICAgICAgICAgICBzZWxmLnNlbGVjdGVkVGFicy5zaGlmdCgpO1xuICAgICAgICAgICAgc2VsZi5zZWxlY3RlZFRhYnMucHVzaChldmVudC50YXJnZXQuaWQpO1xuICAgICAgICB9XG4gICAgICAgIGlmIChzZWxmLnNlbGVjdGVkVGFiKCkuZGF0YS5oYXNPd25Qcm9wZXJ0eSgnYm91bmQnKSkge1xuICAgICAgICAgICAgc2VsZi5zZWxlY3RlZFRhYigpLmRhdGEuYm91bmQodHJ1ZSk7XG5cbiAgICAgICAgICAgIC8vIG1ha2Ugc3VyZSBidWlsZCBleHBsb3JlciBncmFwaCByZW5kZXJzXG4gICAgICAgICAgICBzZXRUaW1lb3V0KGZ1bmN0aW9uICgpIHtcbiAgICAgICAgICAgICAgICBzZWxmLnNlbGVjdGVkVGFiKCkuZGF0YS5idWlsZEV4cGxvcmVyLmdyYXBoRGF0YS52YWx1ZUhhc011dGF0ZWQoKTtcbiAgICAgICAgICAgIH0sIDApO1xuICAgICAgICB9XG4gICAgICAgIGlmIChldmVudC50YXJnZXQuaWQgPT09ICdzZXR0aW5nc1RhYicpIHNlbGYuYm91bmRTZXR0aW5ncyh0cnVlKTtcbiAgICB9O1xuICAgIHNlbGYuaXNTZWNvbmRUYWIgPSBmdW5jdGlvbiAoaWQpIHtcbiAgICAgICAgcmV0dXJuIHNlbGYuc2VsZWN0ZWRUYWJzKCkuaW5kZXhPZihpZCkgPiAtMSAmJiBzZWxmLnNlbGVjdGVkVGFiSWQoKSAhPSBpZDtcbiAgICB9XG4gICAgXG4gICAgc2VsZi5zaG93U2lkZVRhYklkID0gZnVuY3Rpb24gKGlkKSB7XG4gICAgICAgIHJldHVybiBzZWxmLnNlbGVjdGVkVGFicygpLmluZGV4T2YoaWQpID4gLTEgJiYgc2VsZi5zaWRlVmlldygpO1xuICAgIH07XG4gICAgXG4gICAgc2VsZi5yZW1vdmVUYWIgPSBmdW5jdGlvbiAoaW5kZXgsIGRhdGEsIGV2ZW50LCB0YWIpIHtcbiAgICAgICAgaWYgKGRhdGEuaWQgPT0gc2VsZi5zZWxlY3RlZFRhYklkKCkpIHtcbiAgICAgICAgICAgIC8vc2VsZi5zZWxlY3RlZFRhYklkKCdoZXJvVGFiMCcpO1xuICAgICAgICAgICAgc2VsZi5jbGlja1RhYihudWxsLCB7dGFyZ2V0OiB7aWQ6ICdoZXJvVGFiMCd9fSk7XG4gICAgICAgICAgICAkKCcjaGVyb1RhYjAnKS50YWIoJ3Nob3cnKTtcbiAgICAgICAgfVxuICAgICAgICBzZWxmLnRhYnMoKVt0YWJdLmlsbHVzaW9ucy5yZW1vdmUoZnVuY3Rpb24gKGlsbHVzaW9uKSB7XG4gICAgICAgICAgICByZXR1cm4gaWxsdXNpb24gPT0gZGF0YTtcbiAgICAgICAgfSk7XG4gICAgICAgIHNlbGYuaGVyb2VzW3RhYl0uaWxsdXNpb25zLnJlbW92ZShmdW5jdGlvbiAoaWxsdXNpb24pIHtcbiAgICAgICAgICAgIHJldHVybiBpbGx1c2lvbigpID09IGRhdGEuZGF0YTtcbiAgICAgICAgfSk7XG4gICAgfTtcbiAgICBcbiAgICBzZWxmLnNpZGVWaWV3ID0ga28ub2JzZXJ2YWJsZShmYWxzZSk7XG4gICAgc2VsZi5zaWRlVmlldy5zdWJzY3JpYmUoZnVuY3Rpb24gKG5ld1ZhbHVlKSB7XG4gICAgICAgIGlmIChuZXdWYWx1ZSkge1xuICAgICAgICAgICAgaWYgKCFzZWxmLnNob3BQb3BvdXQoKSkge1xuICAgICAgICAgICAgICAgIHNlbGYuZGlzcGxheVNob3AoZmFsc2UpO1xuICAgICAgICAgICAgfVxuICAgICAgICAgICAgZm9yICh2YXIgaSA9IDA7IGkgPCBzZWxmLnNlbGVjdGVkVGFicygpLmxlbmd0aDsgaSsrKSB7XG4gICAgICAgICAgICAgICAgdmFyIHRhYiA9IHNlbGYuZ2V0U2VsZWN0ZWRUYWIoc2VsZi5zZWxlY3RlZFRhYnMoKVtpXSk7XG4gICAgICAgICAgICAgICAgaWYgKHRhYiAmJiB0YWIuaGVyby5kYXRhLmhhc093blByb3BlcnR5KCdib3VuZCcpKSB7XG4gICAgICAgICAgICAgICAgICAgIHRhYi5oZXJvLmRhdGEuYm91bmQodHJ1ZSk7XG4gICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgfVxuICAgICAgICAgICAgc2VsZi5sYXlvdXQoXCIwXCIpO1xuICAgICAgICB9XG4gICAgfSk7XG4gICAgdmFyICR3aW5kb3cgPSAkKHdpbmRvdyk7XG4gICAgc2VsZi53aW5kb3dXaWR0aCA9IGtvLm9ic2VydmFibGUoJHdpbmRvdy53aWR0aCgpKTtcbiAgICBzZWxmLndpbmRvd0hlaWdodCA9IGtvLm9ic2VydmFibGUoJHdpbmRvdy5oZWlnaHQoKSk7XG4gICAgJHdpbmRvdy5yZXNpemUoZnVuY3Rpb24gKCkgeyBcbiAgICAgICAgc2VsZi53aW5kb3dXaWR0aCgkd2luZG93LndpZHRoKCkpO1xuICAgICAgICBzZWxmLndpbmRvd0hlaWdodCgkd2luZG93LmhlaWdodCgpKTtcbiAgICB9KTtcbiAgICBzZWxmLnNob3BEb2NrID0ga28ub2JzZXJ2YWJsZShmYWxzZSk7XG4gICAgc2VsZi5zaG9wRG9jay5zdWJzY3JpYmUoZnVuY3Rpb24gKG5ld1ZhbHVlKSB7XG4gICAgICAgIGlmIChuZXdWYWx1ZSkge1xuICAgICAgICAgICAgc2VsZi5zaG9wUG9wb3V0KGZhbHNlKTtcbiAgICAgICAgfVxuICAgICAgICBlbHNlIHtcbiAgICAgICAgfVxuICAgIH0pO1xuXG4gICAgc2VsZi5zaG9wRG9ja1RyaWdnZXIgPSBrby5jb21wdXRlZChmdW5jdGlvbiAoKSB7XG4gICAgICAgIHNlbGYud2luZG93V2lkdGgoKTtcbiAgICAgICAgc2VsZi5zaG9wRG9jaygpO1xuICAgIH0pO1xuICAgIHNlbGYuc2hvcFBvcG91dCA9IGtvLm9ic2VydmFibGUoZmFsc2UpO1xuICAgIHNlbGYuc2hvcFBvcG91dC5zdWJzY3JpYmUoZnVuY3Rpb24gKG5ld1ZhbHVlKSB7XG4gICAgICAgIGlmIChuZXdWYWx1ZSkge1xuICAgICAgICAgICAgc2VsZi5kaXNwbGF5U2hvcCh0cnVlKTtcbiAgICAgICAgICAgICQoIFwiI3Nob3AtZGlhbG9nXCIgKS5kaWFsb2coe1xuICAgICAgICAgICAgICAgIG1pbldpZHRoOiAzODAsXG4gICAgICAgICAgICAgICAgbWluSGVpZ2h0OiAwLFxuICAgICAgICAgICAgICAgIGNsb3NlVGV4dDogXCJcIixcbiAgICAgICAgICAgICAgICBvcGVuOiBmdW5jdGlvbiAoIGV2ZW50LCB1aSApIHtcbiAgICAgICAgICAgICAgICAgICAgJChldmVudC50YXJnZXQub2Zmc2V0UGFyZW50KS5maW5kKCcudWktZGlhbG9nLXRpdGxlYmFyJykuZmluZCgnYnV0dG9uJylcbiAgICAgICAgICAgICAgICAgICAgICAgIC5hZGRDbGFzcygnY2xvc2UgZ2x5cGhpY29uIGdseXBoaWNvbi1yZW1vdmUgc2hvcC1idXR0b24gYnRuIGJ0bi1kZWZhdWx0IGJ0bi14cyBwdWxsLXJpZ2h0JylcbiAgICAgICAgICAgICAgICAgICAgICAgIC5yZW1vdmVDbGFzcygndWktYnV0dG9uIHVpLXdpZGdldCB1aS1zdGF0ZS1kZWZhdWx0IHVpLWNvcm5lci1hbGwgdWktYnV0dG9uLWljb24tb25seSB1aS1kaWFsb2ctdGl0bGViYXItY2xvc2UgY2xvc2UnKVxuICAgICAgICAgICAgICAgICAgICAgICAgLmNzcygnbWFyZ2luLXJpZ2h0JywnMHB4JylcbiAgICAgICAgICAgICAgICAgICAgICAgIC5wYXJlbnQoKVxuICAgICAgICAgICAgICAgICAgICAgICAgICAgIC5hcHBlbmQoJCgnI3Nob3AtbWluaW1pemUnKSlcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAuYXBwZW5kKCQoJyNzaG9wLW1heGltaXplJykpO1xuICAgICAgICAgICAgICAgICAgICAkKGV2ZW50LnRhcmdldC5vZmZzZXRQYXJlbnQpLmZpbmQoJy51aS1kaWFsb2ctdGl0bGViYXInKS5kYmxjbGljayhmdW5jdGlvbiAoKSB7XG4gICAgICAgICAgICAgICAgICAgICAgICBzZWxmLmRpc3BsYXlTaG9wKCFzZWxmLmRpc3BsYXlTaG9wKCkpO1xuICAgICAgICAgICAgICAgICAgICB9KTtcbiAgICAgICAgICAgICAgICB9LFxuICAgICAgICAgICAgICAgIGNsb3NlOiBmdW5jdGlvbiAoIGV2ZW50LCB1aSApIHtcbiAgICAgICAgICAgICAgICAgICAgc2VsZi5zaG9wUG9wb3V0KGZhbHNlKTtcbiAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICB9KTtcbiAgICAgICAgfVxuICAgICAgICBlbHNlIHtcbiAgICAgICAgICAgICQoJyNzaG9wLWNvbnRhaW5lcicpLnByZXBlbmQoJCgnI3Nob3AtbWluaW1pemUnKSkucHJlcGVuZCgkKCcjc2hvcC1tYXhpbWl6ZScpKTtcbiAgICAgICAgICAgICQoIFwiI3Nob3AtZGlhbG9nXCIgKS5kaWFsb2coXCJkZXN0cm95XCIpO1xuICAgICAgICB9XG4gICAgfSk7XG5cbiAgICBzZWxmLmFkZEl0ZW0gPSBmdW5jdGlvbiAoZGF0YSwgZXZlbnQpIHtcbiAgICAgICAgc2VsZi5zZWxlY3RlZFRhYigpLmRhdGEuYnVpbGRFeHBsb3Jlci5nZXRTZWxlY3RlZEludmVudG9yeSgpLmFkZEl0ZW0oZGF0YSwgZXZlbnQpO1xuICAgIH1cbiAgICBzZWxmLml0ZW1PcHRpb25zID0ga28uY29tcHV0ZWQoZnVuY3Rpb24gKCkge1xuICAgICAgICByZXR1cm4gc2VsZi5zZWxlY3RlZFRhYigpLmRhdGEuaW52ZW50b3J5Lml0ZW1PcHRpb25zKCk7XG4gICAgfSk7XG4gICAgXG4gICAgc2VsZi5jaGFuZ2VTZWxlY3RlZEl0ZW0gPSBmdW5jdGlvbiAoZGF0YSwgZXZlbnQpIHtcbiAgICAgICAgc2VsZi5pdGVtSW5wdXRWYWx1ZSgxKTtcbiAgICAgICAgc2VsZi5zZWxlY3RlZEl0ZW0oZXZlbnQudGFyZ2V0LmlkKTtcbiAgICB9XG4gICAgXG4gICAgc2VsZi5nZXRJdGVtVG9vbHRpcERhdGEgPSBrby5jb21wdXRlZChmdW5jdGlvbiAoKSB7XG4gICAgICAgIHJldHVybiBnZXRJdGVtVG9vbHRpcERhdGEobXkucHJvdG90eXBlLml0ZW1EYXRhLCBzZWxmLnNlbGVjdGVkSXRlbSgpKTtcbiAgICB9LCB0aGlzKTtcbiAgICBzZWxmLmdldEl0ZW1JbnB1dExhYmVsID0ga28uY29tcHV0ZWQoZnVuY3Rpb24gKCkge1xuICAgICAgICBpZiAobXkucHJvdG90eXBlLnN0YWNrYWJsZUl0ZW1zLmluZGV4T2Yoc2VsZi5zZWxlY3RlZEl0ZW0oKSkgIT0gLTEpIHtcbiAgICAgICAgICAgIHJldHVybiAnU3RhY2sgU2l6ZSdcbiAgICAgICAgfVxuICAgICAgICBlbHNlIGlmIChteS5wcm90b3R5cGUubGV2ZWxpdGVtcy5pbmRleE9mKHNlbGYuc2VsZWN0ZWRJdGVtKCkpICE9IC0xKSB7XG4gICAgICAgICAgICByZXR1cm4gJ1VwZ3JhZGUgTGV2ZWwnXG4gICAgICAgIH1cbiAgICAgICAgZWxzZSBpZiAoc2VsZi5zZWxlY3RlZEl0ZW0oKSA9PSAnYmxvb2RzdG9uZScpIHtcbiAgICAgICAgICAgIHJldHVybiAnQ2hhcmdlcydcbiAgICAgICAgfVxuICAgICAgICBlbHNlIHtcbiAgICAgICAgICAgIHJldHVybiAnJ1xuICAgICAgICB9XG4gICAgfSwgdGhpcyk7XG4gICAgc2VsZi5pdGVtSW5wdXRWYWx1ZSA9IGtvLm9ic2VydmFibGUoMSk7XG4gICAgc2VsZi5zYXZlTGluayA9IGtvLm9ic2VydmFibGUoKTtcbiAgICBzZWxmLmdldEFwcFN0YXRlID0gZnVuY3Rpb24gKCkge1xuICAgICAgICB2YXIgZGF0YSA9IHtcbiAgICAgICAgICAgIHNlbGVjdGVkSXRlbTogc2VsZi5zZWxlY3RlZEl0ZW0sXG4gICAgICAgICAgICBsYXlvdXQ6IHNlbGYubGF5b3V0LFxuICAgICAgICAgICAgZGlzcGxheVNob3A6IHNlbGYuZGlzcGxheVNob3AsXG4gICAgICAgICAgICBkaXNwbGF5U2hvcEl0ZW1Ub29sdGlwOiBzZWxmLmRpc3BsYXlTaG9wSXRlbVRvb2x0aXAsXG4gICAgICAgICAgICBhbGxJdGVtczogc2VsZi5hbGxJdGVtcyxcbiAgICAgICAgICAgIHNlbGVjdGVkSXRlbXM6IHNlbGYuc2VsZWN0ZWRJdGVtcyxcbiAgICAgICAgICAgIHNlbGVjdGVkVGFiSWQ6IHNlbGYuc2VsZWN0ZWRUYWJJZCxcbiAgICAgICAgICAgIHNlbGVjdGVkVGFiczogc2VsZi5zZWxlY3RlZFRhYnMsXG4gICAgICAgICAgICBib3VuZFNldHRpbmdzOiBzZWxmLmJvdW5kU2V0dGluZ3MsXG4gICAgICAgICAgICBzaWRlVmlldzogc2VsZi5zaWRlVmlldyxcbiAgICAgICAgICAgIHdpbmRvd1dpZHRoOiBzZWxmLndpbmRvd1dpZHRoLFxuICAgICAgICAgICAgd2luZG93SGVpZ2h0OiBzZWxmLndpbmRvd0hlaWdodCxcbiAgICAgICAgICAgIHNob3BEb2NrOiBzZWxmLnNob3BEb2NrLFxuICAgICAgICAgICAgc2hvcFBvcG91dDogc2VsZi5zaG9wUG9wb3V0LFxuICAgICAgICAgICAgaXRlbUlucHV0VmFsdWU6IHNlbGYuaXRlbUlucHV0VmFsdWUsXG4gICAgICAgICAgICBzYXZlTGluazogc2VsZi5zYXZlTGlua1xuICAgICAgICB9XG4gICAgICAgIGRhdGEudGFicyA9IHNlbGYudGFicygpLm1hcChmdW5jdGlvbiAodGFiKSB7IHJldHVybiB0YWIudG9KUygpIH0pO1xuICAgICAgICByZXR1cm4ga28udG9KUyhkYXRhKTtcbiAgICB9XG4gICAgc2VsZi5nZXRTYXZlRGF0YSA9IGZ1bmN0aW9uICgpIHtcbiAgICAgICAgdmFyIGRhdGEgPSB7XG4gICAgICAgICAgICB2ZXJzaW9uOiBcIjEuMy4wXCIsXG4gICAgICAgICAgICBoZXJvZXM6IFtdXG4gICAgICAgIH1cbiAgICAgICAgZm9yICh2YXIgaSA9IDA7IGkgPCAxMDsgaSsrKSB7XG4gICAgICAgICAgICB2YXIgaGVybyA9IHNlbGYuaGVyb2VzW2ldO1xuICAgICAgICAgICAgdmFyIGQgPSB7XG4gICAgICAgICAgICAgICAgaGVybzogaGVyby5zZWxlY3RlZEhlcm8oKS5oZXJvTmFtZSxcbiAgICAgICAgICAgICAgICBsZXZlbDogaGVyby5zZWxlY3RlZEhlcm9MZXZlbCgpLFxuICAgICAgICAgICAgICAgIGl0ZW1zOiBbXSxcbiAgICAgICAgICAgICAgICBhYmlsaXRpZXM6IFtdLFxuICAgICAgICAgICAgICAgIHNraWxsUG9pbnRIaXN0b3J5OiBoZXJvLnNraWxsUG9pbnRIaXN0b3J5KCksXG4gICAgICAgICAgICAgICAgYnVmZnM6IFtdLFxuICAgICAgICAgICAgICAgIGl0ZW1CdWZmczogW10sXG4gICAgICAgICAgICAgICAgZGVidWZmczogW10sXG4gICAgICAgICAgICAgICAgaXRlbURlYnVmZnM6IFtdLFxuICAgICAgICAgICAgICAgIGdyYXBoRGF0YTogW10sXG4gICAgICAgICAgICAgICAgZW5lbXlJbmRleDogaGVyby5lbmVteSgpLmluZGV4KCksXG4gICAgICAgICAgICAgICAgaGVyb0NvbXBhcmVJbmRleDogaGVyby5oZXJvQ29tcGFyZSgpLmluZGV4KClcbiAgICAgICAgICAgIH1cbiAgICAgICAgICAgIC8vIGl0ZW1zXG4gICAgICAgICAgICBmb3IgKHZhciBqID0gMDsgaiA8IGhlcm8uaW52ZW50b3J5Lml0ZW1zKCkubGVuZ3RoOyBqKyspIHtcbiAgICAgICAgICAgICAgICBkLml0ZW1zLnB1c2goa28udG9KUyhoZXJvLmludmVudG9yeS5pdGVtcygpW2pdKSk7XG4gICAgICAgICAgICB9XG4gICAgICAgICAgICAvLyBhYmlsaXRpZXNcbiAgICAgICAgICAgIGZvciAodmFyIGogPSAwOyBqIDwgaGVyby5hYmlsaXR5KCkuYWJpbGl0aWVzKCkubGVuZ3RoOyBqKyspIHtcbiAgICAgICAgICAgICAgICBkLmFiaWxpdGllcygpLnB1c2goe1xuICAgICAgICAgICAgICAgICAgICBsZXZlbDogaGVyby5hYmlsaXR5KCkuYWJpbGl0aWVzKClbal0ubGV2ZWwoKSxcbiAgICAgICAgICAgICAgICAgICAgaXNBY3RpdmU6IGhlcm8uYWJpbGl0eSgpLmFiaWxpdGllcygpW2pdLmlzQWN0aXZlKClcbiAgICAgICAgICAgICAgICB9KTtcbiAgICAgICAgICAgIH1cbiAgICAgICAgICAgIC8vIGJ1ZmZzXG4gICAgICAgICAgICBmb3IgKHZhciBqID0gMDsgaiA8IGhlcm8uYnVmZnMuYnVmZnMoKS5sZW5ndGg7IGorKykge1xuICAgICAgICAgICAgICAgIGQuYnVmZnMucHVzaCh7XG4gICAgICAgICAgICAgICAgICAgIG5hbWU6IGhlcm8uYnVmZnMuYnVmZnMoKVtqXS5uYW1lLFxuICAgICAgICAgICAgICAgICAgICBsZXZlbDogaGVyby5idWZmcy5idWZmcygpW2pdLmRhdGEubGV2ZWwoKSxcbiAgICAgICAgICAgICAgICAgICAgaXNBY3RpdmU6IGhlcm8uYnVmZnMuYnVmZnMoKVtqXS5kYXRhLmlzQWN0aXZlKClcbiAgICAgICAgICAgICAgICB9KTtcbiAgICAgICAgICAgIH1cbiAgICAgICAgICAgIFxuICAgICAgICAgICAgLy8gZGVidWZmc1xuICAgICAgICAgICAgZm9yICh2YXIgaiA9IDA7IGogPCBoZXJvLmRlYnVmZnMuYnVmZnMoKS5sZW5ndGg7IGorKykge1xuICAgICAgICAgICAgICAgIGQuZGVidWZmcy5wdXNoKHtcbiAgICAgICAgICAgICAgICAgICAgbmFtZTogaGVyby5kZWJ1ZmZzLmJ1ZmZzKClbal0ubmFtZSxcbiAgICAgICAgICAgICAgICAgICAgbGV2ZWw6IGhlcm8uZGVidWZmcy5idWZmcygpW2pdLmRhdGEubGV2ZWwoKSxcbiAgICAgICAgICAgICAgICAgICAgaXNBY3RpdmU6IGhlcm8uZGVidWZmcy5idWZmcygpW2pdLmRhdGEuaXNBY3RpdmUoKVxuICAgICAgICAgICAgICAgIH0pO1xuICAgICAgICAgICAgfVxuXG4gICAgICAgICAgICAvLyBpdGVtIGJ1ZmZzXG4gICAgICAgICAgICBmb3IgKHZhciBqID0gMDsgaiA8IGhlcm8uYnVmZnMuaXRlbUJ1ZmZzLml0ZW1zKCkubGVuZ3RoOyBqKyspIHtcbiAgICAgICAgICAgICAgICBkLml0ZW1CdWZmcy5wdXNoKGtvLnRvSlMoaGVyby5idWZmcy5pdGVtQnVmZnMuaXRlbXMoKVtqXSkpO1xuICAgICAgICAgICAgfVxuICAgICAgICAgICAgXG4gICAgICAgICAgICAvLyBpdGVtIGRlYnVmZnNcbiAgICAgICAgICAgIGZvciAodmFyIGogPSAwOyBqIDwgaGVyby5kZWJ1ZmZzLml0ZW1CdWZmcy5pdGVtcygpLmxlbmd0aDsgaisrKSB7XG4gICAgICAgICAgICAgICAgZC5pdGVtRGVidWZmcy5wdXNoKGtvLnRvSlMoaGVyby5kZWJ1ZmZzLml0ZW1CdWZmcy5pdGVtcygpW2pdKSk7XG4gICAgICAgICAgICB9XG4gICAgICAgICAgICBcbiAgICAgICAgICAgIC8vIGdyYXBoIGRhdGFcbiAgICAgICAgICAgIGQuZ3JhcGhEYXRhID0ga28udG9KUyhoZXJvLmJ1aWxkRXhwbG9yZXIuZ3JhcGhEYXRhKTtcbiAgICAgICAgICAgIFxuICAgICAgICAgICAgZGF0YS5oZXJvZXMucHVzaChkKTtcbiAgICAgICAgfVxuICAgICAgICByZXR1cm4gZGF0YTtcbiAgICB9XG4gICAgc2VsZi5zYXZlID0gZnVuY3Rpb24gKCkge1xuICAgICAgICB2YXIgZGF0YSA9IHNlbGYuZ2V0U2F2ZURhdGEoKTtcbiAgICAgICAgdmFyIHNlcmlhbGl6ZWQgPSBKU09OLnN0cmluZ2lmeShkYXRhKTtcbiAgICAgICAgJC5hamF4KHtcbiAgICAgICAgICAgIHR5cGU6IFwiUE9TVFwiLFxuICAgICAgICAgICAgdXJsOiBcInNhdmUucGhwXCIsXG4gICAgICAgICAgICBkYXRhOiB7J2RhdGEnOiBzZXJpYWxpemVkfSxcbiAgICAgICAgICAgIGRhdGFUeXBlOiBcImpzb25cIixcbiAgICAgICAgICAgIHN1Y2Nlc3M6IGZ1bmN0aW9uIChkYXRhKXtcbiAgICAgICAgICAgICAgICBzZWxmLnNhdmVMaW5rKFtsb2NhdGlvbi5wcm90b2NvbCwgJy8vJywgbG9jYXRpb24uaG9zdCwgbG9jYXRpb24ucGF0aG5hbWVdLmpvaW4oJycpICsgJz9pZD0nICsgZGF0YS5maWxlKTtcbiAgICAgICAgICAgIH0sXG4gICAgICAgICAgICBmYWlsdXJlOiBmdW5jdGlvbiAoZXJyTXNnKSB7XG4gICAgICAgICAgICAgICAgYWxlcnQoXCJTYXZlIHJlcXVlc3QgZmFpbGVkLlwiKTtcbiAgICAgICAgICAgIH1cbiAgICAgICAgfSk7XG4gICAgfVxuICAgIHNlbGYubG9hZCA9IGZ1bmN0aW9uIChkYXRhKSB7XG4gICAgICAgIGZvciAodmFyIGkgPSAwOyBpIDwgZGF0YS5oZXJvZXMubGVuZ3RoOyBpKyspIHtcbiAgICAgICAgICAgIHZhciBoZXJvID0gc2VsZi5oZXJvZXNbaV07XG4gICAgICAgICAgICBoZXJvLnNlbGVjdGVkSGVybyhteS5wcm90b3R5cGUuZmluZFdoZXJlKGhlcm8uYXZhaWxhYmxlSGVyb2VzKCksIHsnaGVyb05hbWUnOiBkYXRhLmhlcm9lc1tpXS5oZXJvfSkpO1xuICAgICAgICAgICAgaGVyby5zZWxlY3RlZEhlcm9MZXZlbChkYXRhLmhlcm9lc1tpXS5sZXZlbCk7XG4gICAgICAgICAgICBoZXJvLmludmVudG9yeS5pdGVtcy5yZW1vdmVBbGwoKTtcbiAgICAgICAgICAgIGhlcm8uaW52ZW50b3J5LmFjdGl2ZUl0ZW1zLnJlbW92ZUFsbCgpO1xuICAgICAgICAgICAgXG4gICAgICAgICAgICAvLyBsb2FkIGhlcm8gY29tcGFyZVxuICAgICAgICAgICAgaWYgKGRhdGEuaGVyb2VzW2ldLmhhc093blByb3BlcnR5KCdoZXJvQ29tcGFyZUluZGV4JykpIHtcbiAgICAgICAgICAgICAgICB2YXIgbyA9IGhlcm8uYXZhaWxhYmxlQ29tcGFyZSgpLmZpbHRlcihmdW5jdGlvbiAob3B0aW9uKSB7XG4gICAgICAgICAgICAgICAgICAgIHJldHVybiBvcHRpb24uaGVyby5pbmRleCgpID09IGRhdGEuaGVyb2VzW2ldLmhlcm9Db21wYXJlSW5kZXg7XG4gICAgICAgICAgICAgICAgfSk7XG4gICAgICAgICAgICAgICAgaWYgKG8ubGVuZ3RoKSB7XG4gICAgICAgICAgICAgICAgICAgIGhlcm8uc2VsZWN0ZWRDb21wYXJlKG9bMF0pO1xuICAgICAgICAgICAgICAgICAgICBoZXJvLmhlcm9Db21wYXJlKG9bMF0uaGVybyk7XG4gICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgfVxuICAgICAgICAgICAgXG4gICAgICAgICAgICAvLyBsb2FkIGVuZW15XG4gICAgICAgICAgICBpZiAoZGF0YS5oZXJvZXNbaV0uaGFzT3duUHJvcGVydHkoJ2VuZW15SW5kZXgnKSkge1xuICAgICAgICAgICAgICAgIHZhciBvID0gaGVyby5hdmFpbGFibGVFbmVtaWVzKCkuZmlsdGVyKGZ1bmN0aW9uIChvcHRpb24pIHtcbiAgICAgICAgICAgICAgICAgICAgcmV0dXJuIG9wdGlvbi5oZXJvLmluZGV4KCkgPT0gZGF0YS5oZXJvZXNbaV0uZW5lbXlJbmRleDtcbiAgICAgICAgICAgICAgICB9KTtcbiAgICAgICAgICAgICAgICBpZiAoby5sZW5ndGgpIHtcbiAgICAgICAgICAgICAgICAgICAgaGVyby5zZWxlY3RlZEVuZW15KG9bMF0pO1xuICAgICAgICAgICAgICAgICAgICBoZXJvLmVuZW15KG9bMF0uaGVybyk7XG4gICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgfVxuICAgICAgICAgICAgXG4gICAgICAgICAgICAvLyBsb2FkIGl0ZW1zXG4gICAgICAgICAgICBmb3IgKHZhciBqID0gMDsgaiA8IGRhdGEuaGVyb2VzW2ldLml0ZW1zLmxlbmd0aDsgaisrKSB7XG4gICAgICAgICAgICAgICAgdmFyIGl0ZW0gPSBkYXRhLmhlcm9lc1tpXS5pdGVtc1tqXTtcbiAgICAgICAgICAgICAgICB2YXIgbmV3X2l0ZW0gPSB7XG4gICAgICAgICAgICAgICAgICAgIGl0ZW06IGl0ZW0uaXRlbSxcbiAgICAgICAgICAgICAgICAgICAgc3RhdGU6IGtvLm9ic2VydmFibGUoaXRlbS5zdGF0ZSksXG4gICAgICAgICAgICAgICAgICAgIHNpemU6IGl0ZW0uc2l6ZSxcbiAgICAgICAgICAgICAgICAgICAgZW5hYmxlZDoga28ub2JzZXJ2YWJsZShpdGVtLmVuYWJsZWQpXG4gICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICAgIGhlcm8uaW52ZW50b3J5Lml0ZW1zLnB1c2gobmV3X2l0ZW0pO1xuICAgICAgICAgICAgfVxuXG4gICAgICAgICAgICAvLyBsb2FkIGFiaWxpdGllc1xuICAgICAgICAgICAgZm9yICh2YXIgaiA9IDA7IGogPCBkYXRhLmhlcm9lc1tpXS5hYmlsaXRpZXMoKS5sZW5ndGg7IGorKykge1xuICAgICAgICAgICAgICAgIGhlcm8uYWJpbGl0eSgpLmFiaWxpdGllcygpW2pdLmxldmVsKGRhdGEuaGVyb2VzW2ldLmFiaWxpdGllcygpW2pdLmxldmVsKTtcbiAgICAgICAgICAgICAgICBoZXJvLmFiaWxpdHkoKS5hYmlsaXRpZXMoKVtqXS5pc0FjdGl2ZShkYXRhLmhlcm9lc1tpXS5hYmlsaXRpZXMoKVtqXS5pc0FjdGl2ZSk7XG4gICAgICAgICAgICB9XG4gICAgICAgICAgICBoZXJvLnNraWxsUG9pbnRIaXN0b3J5KGRhdGEuaGVyb2VzW2ldLnNraWxsUG9pbnRIaXN0b3J5KTtcblxuICAgICAgICAgICAgLy8gbG9hZCBidWZmc1xuICAgICAgICAgICAgZm9yICh2YXIgaiA9IDA7IGogPCBkYXRhLmhlcm9lc1tpXS5idWZmcy5sZW5ndGg7IGorKykge1xuICAgICAgICAgICAgICAgIGhlcm8uYnVmZnMuc2VsZWN0ZWRCdWZmKG15LnByb3RvdHlwZS5maW5kV2hlcmUoaGVyby5idWZmcy5hdmFpbGFibGVCdWZmcygpLCB7YnVmZk5hbWU6IGRhdGEuaGVyb2VzW2ldLmJ1ZmZzW2pdLm5hbWV9KSk7XG4gICAgICAgICAgICAgICAgaGVyby5idWZmcy5hZGRCdWZmKGhlcm8sIHt9KTtcbiAgICAgICAgICAgICAgICB2YXIgYiA9IG15LnByb3RvdHlwZS5maW5kV2hlcmUoaGVyby5idWZmcy5idWZmcygpLCB7IG5hbWU6IGRhdGEuaGVyb2VzW2ldLmJ1ZmZzW2pdLm5hbWUgfSk7XG4gICAgICAgICAgICAgICAgYi5kYXRhLmxldmVsKGRhdGEuaGVyb2VzW2ldLmJ1ZmZzW2pdLmxldmVsKTtcbiAgICAgICAgICAgICAgICBiLmRhdGEuaXNBY3RpdmUoZGF0YS5oZXJvZXNbaV0uYnVmZnNbal0uaXNBY3RpdmUpO1xuICAgICAgICAgICAgfVxuXG4gICAgICAgICAgICAvLyBsb2FkIGRlYnVmZnNcbiAgICAgICAgICAgIGZvciAodmFyIGogPSAwOyBqIDwgZGF0YS5oZXJvZXNbaV0uZGVidWZmcy5sZW5ndGg7IGorKykge1xuICAgICAgICAgICAgICAgIGhlcm8uZGVidWZmcy5zZWxlY3RlZEJ1ZmYobXkucHJvdG90eXBlLmZpbmRXaGVyZShoZXJvLmRlYnVmZnMuYXZhaWxhYmxlRGVidWZmcygpLCB7YnVmZk5hbWU6IGRhdGEuaGVyb2VzW2ldLmRlYnVmZnNbal0ubmFtZX0pKTtcbiAgICAgICAgICAgICAgICBoZXJvLmRlYnVmZnMuYWRkQnVmZihoZXJvLCB7fSk7XG4gICAgICAgICAgICAgICAgdmFyIGIgPSBteS5wcm90b3R5cGUuZmluZFdoZXJlKGhlcm8uZGVidWZmcy5idWZmcygpLCB7IG5hbWU6IGRhdGEuaGVyb2VzW2ldLmRlYnVmZnNbal0ubmFtZSB9KTtcbiAgICAgICAgICAgICAgICBiLmRhdGEubGV2ZWwoZGF0YS5oZXJvZXNbaV0uZGVidWZmc1tqXS5sZXZlbCk7XG4gICAgICAgICAgICAgICAgYi5kYXRhLmlzQWN0aXZlKGRhdGEuaGVyb2VzW2ldLmRlYnVmZnNbal0uaXNBY3RpdmUpO1xuICAgICAgICAgICAgfVxuXG4gICAgICAgICAgICAvLyBsb2FkIGl0ZW0gYnVmZnNcbiAgICAgICAgICAgIGlmIChkYXRhLmhlcm9lc1tpXS5pdGVtQnVmZnMpIHtcbiAgICAgICAgICAgICAgICBmb3IgKHZhciBqID0gMDsgaiA8IGRhdGEuaGVyb2VzW2ldLml0ZW1CdWZmcy5sZW5ndGg7IGorKykge1xuICAgICAgICAgICAgICAgICAgICB2YXIgaXRlbSA9IGRhdGEuaGVyb2VzW2ldLml0ZW1CdWZmc1tqXTtcbiAgICAgICAgICAgICAgICAgICAgdmFyIG5ld19pdGVtID0ge1xuICAgICAgICAgICAgICAgICAgICAgICAgaXRlbTogaXRlbS5pdGVtLFxuICAgICAgICAgICAgICAgICAgICAgICAgc3RhdGU6IGtvLm9ic2VydmFibGUoaXRlbS5zdGF0ZSksXG4gICAgICAgICAgICAgICAgICAgICAgICBzaXplOiBpdGVtLnNpemUsXG4gICAgICAgICAgICAgICAgICAgICAgICBlbmFibGVkOiBrby5vYnNlcnZhYmxlKGl0ZW0uZW5hYmxlZClcbiAgICAgICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICAgICAgICBoZXJvLmJ1ZmZzLml0ZW1CdWZmcy5pdGVtcy5wdXNoKG5ld19pdGVtKTtcbiAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICB9XG5cbiAgICAgICAgICAgIC8vIGxvYWQgaXRlbSBkZWJ1ZmZzXG4gICAgICAgICAgICBpZiAoZGF0YS5oZXJvZXNbaV0uaXRlbURlYnVmZnMpIHtcbiAgICAgICAgICAgICAgICBmb3IgKHZhciBqID0gMDsgaiA8IGRhdGEuaGVyb2VzW2ldLml0ZW1EZWJ1ZmZzLmxlbmd0aDsgaisrKSB7XG4gICAgICAgICAgICAgICAgICAgIHZhciBpdGVtID0gZGF0YS5oZXJvZXNbaV0uaXRlbURlYnVmZnNbal07XG4gICAgICAgICAgICAgICAgICAgIHZhciBuZXdfaXRlbSA9IHtcbiAgICAgICAgICAgICAgICAgICAgICAgIGl0ZW06IGl0ZW0uaXRlbSxcbiAgICAgICAgICAgICAgICAgICAgICAgIHN0YXRlOiBrby5vYnNlcnZhYmxlKGl0ZW0uc3RhdGUpLFxuICAgICAgICAgICAgICAgICAgICAgICAgc2l6ZTogaXRlbS5zaXplLFxuICAgICAgICAgICAgICAgICAgICAgICAgZW5hYmxlZDoga28ub2JzZXJ2YWJsZShpdGVtLmVuYWJsZWQpXG4gICAgICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgICAgICAgaGVyby5kZWJ1ZmZzLml0ZW1CdWZmcy5pdGVtcy5wdXNoKG5ld19pdGVtKTtcbiAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICB9XG4gICAgICAgICAgICBcbiAgICAgICAgICAgIC8vIGxvYWQgZ3JhcGggZGF0YVxuICAgICAgICAgICAgaWYgKGRhdGEuaGVyb2VzW2ldLmdyYXBoRGF0YSkge1xuICAgICAgICAgICAgICAgIGhlcm8uYnVpbGRFeHBsb3Jlci5sb2FkR3JhcGhEYXRhKGRhdGEuaGVyb2VzW2ldLmdyYXBoRGF0YSk7XG4gICAgICAgICAgICB9XG4gICAgICAgIH1cbiAgICB9XG4gICAgXG4gICAgc2VsZi5zZW5kUmVwb3J0ID0gZnVuY3Rpb24gKCkge1xuICAgICAgICBpZiAoJCgnI0J1Z1JlcG9ydEZvcm1UZXh0JykudmFsKCkpIHtcbiAgICAgICAgICAgICQucG9zdCggXCJyZXBvcnQucGhwXCIsIHsgbmFtZTogJCgnI0J1Z1JlcG9ydEZvcm1OYW1lJykudmFsKCksIGVtYWlsOiAkKCcjQnVnUmVwb3J0Rm9ybUVtYWlsJykudmFsKCksIGJvZHk6ICQoJyNCdWdSZXBvcnRGb3JtVGV4dCcpLnZhbCgpIH0pXG4gICAgICAgICAgICAuZG9uZShmdW5jdGlvbiAoZGF0YSkge1xuICAgICAgICAgICAgICAgIGlmIChkYXRhID09ICdTdWNjZXNzJykge1xuICAgICAgICAgICAgICAgICAgICBhbGVydCgnUmVwb3J0IHN1Y2Nlc3NmdWxseSBzZW50LiBUaGFua3MhJyk7XG4gICAgICAgICAgICAgICAgICAgICQoJyNCdWdSZXBvcnRGb3JtVGV4dCcpLnZhbCgnJyk7XG4gICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICAgIGVsc2Uge1xuICAgICAgICAgICAgICAgICAgICBhbGVydCgnRmFpbGVkIHRvIHNlbmQgcmVwb3J0LiBUcnkgYWdhaW4gbGF0ZXIgb3IgZW1haWwgYWRtaW5AZGV2aWxlc2suY29tJyk7XG4gICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgfSk7XG4gICAgICAgICAgICAkKCcjbXlNb2RhbCcpLm1vZGFsKCdoaWRlJyk7XG4gICAgICAgIH1cbiAgICAgICAgZWxzZSB7XG4gICAgICAgICAgICBhbGVydCgnTWVzc2FnZSBpcyByZXF1aXJlZC4nKTtcbiAgICAgICAgfVxuICAgIH1cbiAgICBcbiAgICBzZWxmLmdldFByb3BlcnR5ID0gZnVuY3Rpb24gKG9iaiwgcHJvcGVydGllcykge1xuICAgICAgICB2YXIgcmVzdWx0ID0gb2JqO1xuICAgICAgICBmb3IgKHZhciBpID0gMDsgaSA8IHByb3BlcnRpZXMubGVuZ3RoOyBpKyspIHtcbiAgICAgICAgICAgIHJlc3VsdCA9IHJlc3VsdFtwcm9wZXJ0aWVzW2ldXTtcbiAgICAgICAgfVxuICAgICAgICByZXR1cm4gcmVzdWx0O1xuICAgIH07XG4gICAgXG4gICAgc2VsZi5nZXREaWZmVGV4dFdyYXBwZXIgPSBmdW5jdGlvbiAoaGVybywgcHJvcGVydHkpIHtcbiAgICAgICAgcmV0dXJuIHNlbGYuZ2V0RGlmZlRleHQoc2VsZi5nZXREaWZmTWFnbml0dWRlKGhlcm8sIHByb3BlcnR5KSk7XG4gICAgfVxuICAgIFxuICAgIHNlbGYuZ2V0RGlmZk1hZ25pdHVkZSA9IGZ1bmN0aW9uIChoZXJvLCBwcm9wZXJ0eSkge1xuICAgICAgICB2YXIgcHJvcGVydGllcyA9IHByb3BlcnR5LnNwbGl0KCcuJyk7XG4gICAgICAgIHJldHVybiBzZWxmLmdldFByb3BlcnR5KGhlcm8uZGFtYWdlVG90YWxJbmZvKCksIHByb3BlcnRpZXMpLnRvRml4ZWQoMikgLSBzZWxmLmdldFByb3BlcnR5KGhlcm8uaGVyb0NvbXBhcmUoKS5kYW1hZ2VUb3RhbEluZm8oKSwgcHJvcGVydGllcykudG9GaXhlZCgyKTtcbiAgICB9XG4gICAgXG4gICAgc2VsZi5nZXREaWZmVGV4dCA9IGZ1bmN0aW9uICh2YWx1ZSkge1xuICAgICAgICBpZiAodmFsdWUgPiAwKSB7XG4gICAgICAgICAgICByZXR1cm4gJysnICsgcGFyc2VGbG9hdCh2YWx1ZS50b0ZpeGVkKDIpKTtcbiAgICAgICAgfVxuICAgICAgICBlbHNlIGlmICh2YWx1ZSA8IDApIHtcbiAgICAgICAgICAgIHJldHVybiAnJm1pbnVzOycgKyBwYXJzZUZsb2F0KHZhbHVlLnRvRml4ZWQoMikqLTEpLnRvU3RyaW5nKCk7XG4gICAgICAgIH1cbiAgICAgICAgZWxzZSB7XG4gICAgICAgICAgICByZXR1cm4gJyc7XG4gICAgICAgIH1cbiAgICB9XG4gICAgc2VsZi5oaWdobGlnaHRlZFRhYkludGVybmFsID0ga28ub2JzZXJ2YWJsZSgnJyk7XG4gICAgc2VsZi5oaWdobGlnaHRlZFRhYiA9IGtvLmNvbXB1dGVkKGZ1bmN0aW9uICgpIHtcbiAgICAgICAgcmV0dXJuIHNlbGYuaGlnaGxpZ2h0ZWRUYWJJbnRlcm5hbCgpO1xuICAgIH0pLmV4dGVuZCh7IHRocm90dGxlOiAxMDAgfSk7XG4gICAgc2VsZi5oaWdobGlnaHRUYWIgPSBmdW5jdGlvbiAoZGF0YSkge1xuICAgICAgICBzZWxmLmhpZ2hsaWdodGVkVGFiSW50ZXJuYWwoZGF0YSk7XG4gICAgfVxuICAgIHNlbGYudW5oaWdobGlnaHRUYWIgPSBmdW5jdGlvbiAoZGF0YSkge1xuICAgICAgICBzZWxmLmhpZ2hsaWdodGVkVGFiSW50ZXJuYWwoJycpO1xuICAgIH1cbn1cblxubXkucHJvdG90eXBlLnRoZW1lID0ga28ub2JzZXJ2YWJsZSgnZGFyaycpOyAvL2tvLm9ic2VydmFibGUoJCgnI3RoZW1lLXNlbGVjdCcpLnZhbCgpKTtcbm15LnByb3RvdHlwZS5oZXJvQ2FsY3VsYXRvciA9IHt9O1xuXG5teS5wcm90b3R5cGUucnVuID0gZnVuY3Rpb24gKCkge1xuICAgIG15LnByb3RvdHlwZS5oZXJvQ2FsY3VsYXRvciA9IG5ldyBteS5wcm90b3R5cGUuSGVyb0NhbGN1bGF0b3JWaWV3TW9kZWwoKTtcbiAgICBrby5hcHBseUJpbmRpbmdzKG15LnByb3RvdHlwZS5oZXJvQ2FsY3VsYXRvcik7XG4gICAgLyokKCcjdGhlbWUtc2VsZWN0JykuY2hhbmdlKGZ1bmN0aW9uICgpIHtcbiAgICAgICAgbXkucHJvdG90eXBlLnRoZW1lKCQodGhpcykudmFsKCkpO1xuICAgIH0pOyovXG4gICAgJCgnI3NwaW5uZXInKS5oaWRlKCk7XG4gICAgJCgnLmluaXRpYWwtaGlkZGVuJykuY3NzKCdkaXNwbGF5JywgJ2lubGluZS1ibG9jaycpO1xuICAgICQoJyNwb3BIZXJvMCcpLmFkZENsYXNzKCdhY3RpdmUnKTtcbiAgICAkKCcjaGVyb1BhbmUwJykuYWRkQ2xhc3MoJ2FjdGl2ZScpO1xuICAgICQoJ1tkYXRhLXRvZ2dsZT1cInRvb2x0aXBcIl0nKS50b29sdGlwKCk7XG4gICAgdmFyIHNhdmVJZCA9IG15LnByb3RvdHlwZS5nZXRQYXJhbWV0ZXJCeU5hbWUoJ2lkJyk7XG4gICAgaWYgKHNhdmVJZCkge1xuICAgICAgICAkLmdldCgnc2F2ZS8nICsgc2F2ZUlkICsgJy5qc29uJywgZnVuY3Rpb24gKGRhdGEpIHtcbiAgICAgICAgICAgIG15LnByb3RvdHlwZS5oZXJvQ2FsY3VsYXRvci5sb2FkKGRhdGEpO1xuICAgICAgICB9KTtcbiAgICB9XG59XG5cbm15LnByb3RvdHlwZS5pbnZlbnRvcnlDbGlwQm9hcmQgPSB7XG4gICAgaXRlbXM6IFtdLFxuICAgIGFjdGl2ZUl0ZW1zOiBbXVxufTtcblxubXkucHJvdG90eXBlLmdldFBhcmFtZXRlckJ5TmFtZSA9IGZ1bmN0aW9uIChuYW1lKSB7XG4gICAgbmFtZSA9IG5hbWUucmVwbGFjZSgvW1xcW10vLCBcIlxcXFxbXCIpLnJlcGxhY2UoL1tcXF1dLywgXCJcXFxcXVwiKTtcbiAgICB2YXIgcmVnZXggPSBuZXcgUmVnRXhwKFwiW1xcXFw/Jl1cIiArIG5hbWUgKyBcIj0oW14mI10qKVwiKSxcbiAgICAgICAgcmVzdWx0cyA9IHJlZ2V4LmV4ZWMobG9jYXRpb24uc2VhcmNoKTtcbiAgICByZXR1cm4gcmVzdWx0cyA9PSBudWxsID8gXCJcIiA6IGRlY29kZVVSSUNvbXBvbmVudChyZXN1bHRzWzFdLnJlcGxhY2UoL1xcKy9nLCBcIiBcIikpO1xufVxuXG5tb2R1bGUuZXhwb3J0cyA9IG15OyIsImZ1bmN0aW9uIFZpZXdNb2RlbChwYXJhbXMpIHtcbiAgICB2YXIgc2VsZiA9IHRoaXM7XG4gICAgc2VsZi53aW5kb3dXaWR0aCA9IHBhcmFtcy53aW5kb3dXaWR0aDtcbiAgICBzZWxmLndpbmRvd0hlaWdodCA9IHBhcmFtcy53aW5kb3dIZWlnaHQ7XG4gICAgc2VsZi5kaXNwbGF5U2hvcCA9IHBhcmFtcy5kaXNwbGF5U2hvcDtcbiAgICBzZWxmLmRpc3BsYXlTaG9wSXRlbVRvb2x0aXAgPSBwYXJhbXMuZGlzcGxheVNob3BJdGVtVG9vbHRpcDtcbiAgICBzZWxmLnNob3BEb2NrID0gcGFyYW1zLnNob3BEb2NrO1xuICAgIHNlbGYuc2hvcERvY2tUcmlnZ2VyID0gcGFyYW1zLnNob3BEb2NrVHJpZ2dlcjtcbiAgICBzZWxmLnNob3BQb3BvdXQgPSBwYXJhbXMuc2hvcFBvcG91dDtcbiAgICBzZWxmLnNlbGVjdGVkSXRlbSA9IHBhcmFtcy5zZWxlY3RlZEl0ZW07XG4gICAgc2VsZi5hZGRJdGVtID0gcGFyYW1zLmFkZEl0ZW07XG4gICAgc2VsZi5jaGFuZ2VTZWxlY3RlZEl0ZW0gPSBwYXJhbXMuY2hhbmdlU2VsZWN0ZWRJdGVtO1xuICAgIHNlbGYuZ2V0SXRlbVRvb2x0aXBEYXRhID0gcGFyYW1zLmdldEl0ZW1Ub29sdGlwRGF0YTtcbiAgICBzZWxmLmdldEl0ZW1JbnB1dExhYmVsID0gcGFyYW1zLmdldEl0ZW1JbnB1dExhYmVsO1xuICAgIHNlbGYuaXRlbUlucHV0VmFsdWUgPSBwYXJhbXMuaXRlbUlucHV0VmFsdWU7XG4gICAgc2VsZi5pdGVtT3B0aW9ucyA9IHBhcmFtcy5pdGVtT3B0aW9ucztcbn1cblxubW9kdWxlLmV4cG9ydHMgPSB7XG4gICAgdmlld01vZGVsOiBWaWV3TW9kZWwsXG4gICAgdGVtcGxhdGU6IFwiICAgICAgICA8ZGl2IGlkPVxcXCJzaG9wLWNvbnRhaW5lclxcXCIgY2xhc3M9XFxcImNvbC1tZC0xMiBjb2wtbGctNFxcXCIgZGF0YS1iaW5kPVxcXCJzaG9wRG9ja1N0eWxlOiBzaG9wRG9ja1RyaWdnZXIsIHZpc2libGU6IGRpc3BsYXlTaG9wKCkgfHwgc2hvcFBvcG91dCgpLCBjc3M6IHsnY29sLWxnLTQnOiAhc2hvcFBvcG91dCgpfSwgc3R5bGU6IHsgJ3BhZGRpbmctdG9wJzogc2hvcFBvcG91dCgpID8gJzVweCcgOiAnMHB4J31cXFwiPlxcbiAgICAgICAgICAgICAgPGJ1dHRvbiBpZD1cXFwic2hvcC1taW5pbWl6ZVxcXCIgY2xhc3M9XFxcImJ0biBidG4tZGVmYXVsdCBidG4teHMgc2hvcC1idXR0b24gZ2x5cGhpY29uIGdseXBoaWNvbi1taW51cyBwdWxsLXJpZ2h0XFxcIiBkYXRhLWJpbmQ9XFxcInRvZ2dsZTogZGlzcGxheVNob3AsIHZpc2libGU6IGRpc3BsYXlTaG9wKClcXFwiIHRpdGxlPVxcXCJNaW5pbWl6ZSBzaG9wXFxcIj48L2J1dHRvbj5cXG4gICAgICAgICAgICAgIDxidXR0b24gaWQ9XFxcInNob3AtbWF4aW1pemVcXFwiIGNsYXNzPVxcXCJidG4gYnRuLWRlZmF1bHQgYnRuLXhzIHNob3AtYnV0dG9uIGdseXBoaWNvbiBnbHlwaGljb24tcGx1cyBwdWxsLXJpZ2h0XFxcIiBkYXRhLWJpbmQ9XFxcInRvZ2dsZTogZGlzcGxheVNob3AsIHZpc2libGU6ICFkaXNwbGF5U2hvcCgpXFxcIiB0aXRsZT1cXFwiTWF4aW1pemUgc2hvcFxcXCI+PC9idXR0b24+XFxuICAgICAgICAgICAgICA8YnV0dG9uIGNsYXNzPVxcXCJidG4gYnRuLWRlZmF1bHQgYnRuLXhzIHNob3AtYnV0dG9uIGdseXBoaWNvbiBnbHlwaGljb24tbmV3LXdpbmRvdyBwdWxsLXJpZ2h0IGhpZGRlbi14c1xcXCIgZGF0YS1iaW5kPVxcXCJjbGljazogc2hvcFBvcG91dCwgdmlzaWJsZTogIXNob3BQb3BvdXQoKVxcXCIgdGl0bGU9XFxcIlBvcG91dCBzaG9wXFxcIj48L2J1dHRvbj5cXG4gICAgICAgICAgICAgIDxidXR0b24gY2xhc3M9XFxcImJ0biBidG4tZGVmYXVsdCBidG4teHMgc2hvcC1idXR0b24gZ2x5cGhpY29uIGdseXBoaWNvbi1hbGlnbi1yaWdodCBwdWxsLXJpZ2h0IGhpZGRlbi14c1xcXCIgZGF0YS1iaW5kPVxcXCJ0b2dnbGU6IHNob3BEb2NrLCBhdHRyOiB7IHRpdGxlOiBzaG9wRG9jaygpID8gJ1VuZG9jayBzaG9wIHRvIHJpZ2h0IHNpZGUgb2Ygc2NyZWVuJyA6ICdEb2NrIHNob3AgdG8gcmlnaHQgc2lkZSBvZiBzY3JlZW4nIH1cXFwiID48L2J1dHRvbj5cXG4gICAgICAgICAgICA8dWwgaWQ9XFxcInNob3B0YWJzXFxcIiBjbGFzcz1cXFwibmF2IG5hdi10YWJzXFxcIiBkYXRhLWJpbmQ9XFxcInZpc2libGU6IGRpc3BsYXlTaG9wKClcXFwiPlxcbiAgICAgICAgICAgICAgPGxpPjxhIGhyZWY9XFxcIiNzaG9wX2Jhc2ljXFxcIiBkYXRhLXRvZ2dsZT1cXFwidGFiXFxcIj5CYXNpYzwvYT48L2xpPlxcbiAgICAgICAgICAgICAgPGxpPjxhIGhyZWY9XFxcIiNzaG9wX3VwZ3JhZGVcXFwiIGRhdGEtdG9nZ2xlPVxcXCJ0YWJcXFwiPlVwZ3JhZGU8L2E+PC9saT5cXG4gICAgICAgICAgICAgIDxsaT48YSBocmVmPVxcXCIjc2hvcF9zZWNyZXRcXFwiIGRhdGEtdG9nZ2xlPVxcXCJ0YWJcXFwiPlNlY3JldDwvYT48L2xpPlxcbiAgICAgICAgICAgIDwvdWw+XFxuICAgICAgICAgICAgPGRpdiBjbGFzcz1cXFwidGFiLWNvbnRlbnQgdGV4dC1jZW50ZXIgYm90dG9tLWJ1ZmZlcjJcXFwiIGRhdGEtYmluZD1cXFwidmlzaWJsZTogZGlzcGxheVNob3AoKVxcXCI+XFxuICAgICAgICAgICAgICAgIDxkaXYgY2xhc3M9XFxcInRhYi1wYW5lIGFjdGl2ZVxcXCIgaWQ9XFxcInNob3BfYmFzaWNcXFwiPlxcbjxkaXYgY2xhc3M9XFxcInNob3AtY29sdW1uXFxcIj5cXG4gIDxkaXYgY2xhc3M9XFxcImhjLXNob3AgaGMtc2hvcC1jb25zdW1hYmxlc1xcXCIgaWQ9XFxcImNvbnN1bWFibGVzXFxcIj48L2Rpdj5cXG4gIDxkaXYgY2xhc3M9XFxcImltZy1yb3VuZGVkIGhjLWl0ZW0gaGMtaXRlbS1jbGFyaXR5XFxcIiBpZD1cXFwiY2xhcml0eVxcXCIgZGF0YS1iaW5kPVxcXCJjbGljazogY2hhbmdlU2VsZWN0ZWRJdGVtLCBldmVudDogeyBkYmxjbGljazogYWRkSXRlbSB9XFxcIj48L2Rpdj5cXG4gIDxkaXYgY2xhc3M9XFxcImltZy1yb3VuZGVkIGhjLWl0ZW0gaGMtaXRlbS1mYWVyaWVfZmlyZVxcXCIgaWQ9XFxcImZhZXJpZV9maXJlXFxcIiBkYXRhLWJpbmQ9XFxcImNsaWNrOiBjaGFuZ2VTZWxlY3RlZEl0ZW0sIGV2ZW50OiB7IGRibGNsaWNrOiBhZGRJdGVtIH1cXFwiPjwvZGl2PlxcbiAgPGRpdiBjbGFzcz1cXFwiaW1nLXJvdW5kZWQgaGMtaXRlbSBoYy1pdGVtLWVuY2hhbnRlZF9tYW5nb1xcXCIgaWQ9XFxcImVuY2hhbnRlZF9tYW5nb1xcXCIgZGF0YS1iaW5kPVxcXCJjbGljazogY2hhbmdlU2VsZWN0ZWRJdGVtLCBldmVudDogeyBkYmxjbGljazogYWRkSXRlbSB9XFxcIj48L2Rpdj5cXG4gIDxkaXYgY2xhc3M9XFxcImltZy1yb3VuZGVkIGhjLWl0ZW0gaGMtaXRlbS10YW5nb1xcXCIgaWQ9XFxcInRhbmdvXFxcIiBkYXRhLWJpbmQ9XFxcImNsaWNrOiBjaGFuZ2VTZWxlY3RlZEl0ZW0sIGV2ZW50OiB7IGRibGNsaWNrOiBhZGRJdGVtIH1cXFwiPjwvZGl2PlxcbiAgPGRpdiBjbGFzcz1cXFwiaW1nLXJvdW5kZWQgaGMtaXRlbSBoYy1pdGVtLWZsYXNrXFxcIiBpZD1cXFwiZmxhc2tcXFwiIGRhdGEtYmluZD1cXFwiY2xpY2s6IGNoYW5nZVNlbGVjdGVkSXRlbSwgZXZlbnQ6IHsgZGJsY2xpY2s6IGFkZEl0ZW0gfVxcXCI+PC9kaXY+XFxuICA8ZGl2IGNsYXNzPVxcXCJpbWctcm91bmRlZCBoYy1pdGVtIGhjLWl0ZW0tc21va2Vfb2ZfZGVjZWl0XFxcIiBpZD1cXFwic21va2Vfb2ZfZGVjZWl0XFxcIiBkYXRhLWJpbmQ9XFxcImNsaWNrOiBjaGFuZ2VTZWxlY3RlZEl0ZW0sIGV2ZW50OiB7IGRibGNsaWNrOiBhZGRJdGVtIH1cXFwiPjwvZGl2PlxcbiAgPGRpdiBjbGFzcz1cXFwiaW1nLXJvdW5kZWQgaGMtaXRlbSBoYy1pdGVtLXRwc2Nyb2xsXFxcIiBpZD1cXFwidHBzY3JvbGxcXFwiIGRhdGEtYmluZD1cXFwiY2xpY2s6IGNoYW5nZVNlbGVjdGVkSXRlbSwgZXZlbnQ6IHsgZGJsY2xpY2s6IGFkZEl0ZW0gfVxcXCI+PC9kaXY+XFxuICA8ZGl2IGNsYXNzPVxcXCJpbWctcm91bmRlZCBoYy1pdGVtIGhjLWl0ZW0tZHVzdFxcXCIgaWQ9XFxcImR1c3RcXFwiIGRhdGEtYmluZD1cXFwiY2xpY2s6IGNoYW5nZVNlbGVjdGVkSXRlbSwgZXZlbnQ6IHsgZGJsY2xpY2s6IGFkZEl0ZW0gfVxcXCI+PC9kaXY+XFxuICA8ZGl2IGNsYXNzPVxcXCJpbWctcm91bmRlZCBoYy1pdGVtIGhjLWl0ZW0tY291cmllclxcXCIgaWQ9XFxcImNvdXJpZXJcXFwiIGRhdGEtYmluZD1cXFwiY2xpY2s6IGNoYW5nZVNlbGVjdGVkSXRlbSwgZXZlbnQ6IHsgZGJsY2xpY2s6IGFkZEl0ZW0gfVxcXCI+PC9kaXY+XFxuICA8ZGl2IGNsYXNzPVxcXCJpbWctcm91bmRlZCBoYy1pdGVtIGhjLWl0ZW0tZmx5aW5nX2NvdXJpZXJcXFwiIGlkPVxcXCJmbHlpbmdfY291cmllclxcXCIgZGF0YS1iaW5kPVxcXCJjbGljazogY2hhbmdlU2VsZWN0ZWRJdGVtLCBldmVudDogeyBkYmxjbGljazogYWRkSXRlbSB9XFxcIj48L2Rpdj5cXG4gIDxkaXYgY2xhc3M9XFxcImltZy1yb3VuZGVkIGhjLWl0ZW0gaGMtaXRlbS13YXJkX29ic2VydmVyXFxcIiBpZD1cXFwid2FyZF9vYnNlcnZlclxcXCIgZGF0YS1iaW5kPVxcXCJjbGljazogY2hhbmdlU2VsZWN0ZWRJdGVtLCBldmVudDogeyBkYmxjbGljazogYWRkSXRlbSB9XFxcIj48L2Rpdj5cXG4gIDxkaXYgY2xhc3M9XFxcImltZy1yb3VuZGVkIGhjLWl0ZW0gaGMtaXRlbS13YXJkX3NlbnRyeVxcXCIgaWQ9XFxcIndhcmRfc2VudHJ5XFxcIiBkYXRhLWJpbmQ9XFxcImNsaWNrOiBjaGFuZ2VTZWxlY3RlZEl0ZW0sIGV2ZW50OiB7IGRibGNsaWNrOiBhZGRJdGVtIH1cXFwiPjwvZGl2PlxcbiAgPGRpdiBjbGFzcz1cXFwiaW1nLXJvdW5kZWQgaGMtaXRlbSBoYy1pdGVtLXRvbWVfb2Zfa25vd2xlZGdlXFxcIiBpZD1cXFwidG9tZV9vZl9rbm93bGVkZ2VcXFwiIGRhdGEtYmluZD1cXFwiY2xpY2s6IGNoYW5nZVNlbGVjdGVkSXRlbSwgZXZlbnQ6IHsgZGJsY2xpY2s6IGFkZEl0ZW0gfVxcXCI+PC9kaXY+XFxuICA8ZGl2IGNsYXNzPVxcXCJpbWctcm91bmRlZCBoYy1pdGVtIGhjLWl0ZW0tYm90dGxlXFxcIiBpZD1cXFwiYm90dGxlXFxcIiBkYXRhLWJpbmQ9XFxcImNsaWNrOiBjaGFuZ2VTZWxlY3RlZEl0ZW0sIGV2ZW50OiB7IGRibGNsaWNrOiBhZGRJdGVtIH1cXFwiPjwvZGl2PlxcbjwvZGl2PlxcbjxkaXYgY2xhc3M9XFxcInNob3AtY29sdW1uXFxcIj5cXG4gIDxkaXYgY2xhc3M9XFxcImhjLXNob3AgaGMtc2hvcC1hdHRyaWJ1dGVzXFxcIiBpZD1cXFwiYXR0cmlidXRlc1xcXCI+PC9kaXY+XFxuICA8ZGl2IGNsYXNzPVxcXCJpbWctcm91bmRlZCBoYy1pdGVtIGhjLWl0ZW0tYnJhbmNoZXNcXFwiIGlkPVxcXCJicmFuY2hlc1xcXCIgZGF0YS1iaW5kPVxcXCJjbGljazogY2hhbmdlU2VsZWN0ZWRJdGVtLCBldmVudDogeyBkYmxjbGljazogYWRkSXRlbSB9XFxcIj48L2Rpdj5cXG4gIDxkaXYgY2xhc3M9XFxcImltZy1yb3VuZGVkIGhjLWl0ZW0gaGMtaXRlbS1nYXVudGxldHNcXFwiIGlkPVxcXCJnYXVudGxldHNcXFwiIGRhdGEtYmluZD1cXFwiY2xpY2s6IGNoYW5nZVNlbGVjdGVkSXRlbSwgZXZlbnQ6IHsgZGJsY2xpY2s6IGFkZEl0ZW0gfVxcXCI+PC9kaXY+XFxuICA8ZGl2IGNsYXNzPVxcXCJpbWctcm91bmRlZCBoYy1pdGVtIGhjLWl0ZW0tc2xpcHBlcnNcXFwiIGlkPVxcXCJzbGlwcGVyc1xcXCIgZGF0YS1iaW5kPVxcXCJjbGljazogY2hhbmdlU2VsZWN0ZWRJdGVtLCBldmVudDogeyBkYmxjbGljazogYWRkSXRlbSB9XFxcIj48L2Rpdj5cXG4gIDxkaXYgY2xhc3M9XFxcImltZy1yb3VuZGVkIGhjLWl0ZW0gaGMtaXRlbS1tYW50bGVcXFwiIGlkPVxcXCJtYW50bGVcXFwiIGRhdGEtYmluZD1cXFwiY2xpY2s6IGNoYW5nZVNlbGVjdGVkSXRlbSwgZXZlbnQ6IHsgZGJsY2xpY2s6IGFkZEl0ZW0gfVxcXCI+PC9kaXY+XFxuICA8ZGl2IGNsYXNzPVxcXCJpbWctcm91bmRlZCBoYy1pdGVtIGhjLWl0ZW0tY2lyY2xldFxcXCIgaWQ9XFxcImNpcmNsZXRcXFwiIGRhdGEtYmluZD1cXFwiY2xpY2s6IGNoYW5nZVNlbGVjdGVkSXRlbSwgZXZlbnQ6IHsgZGJsY2xpY2s6IGFkZEl0ZW0gfVxcXCI+PC9kaXY+XFxuICA8ZGl2IGNsYXNzPVxcXCJpbWctcm91bmRlZCBoYy1pdGVtIGhjLWl0ZW0tYmVsdF9vZl9zdHJlbmd0aFxcXCIgaWQ9XFxcImJlbHRfb2Zfc3RyZW5ndGhcXFwiIGRhdGEtYmluZD1cXFwiY2xpY2s6IGNoYW5nZVNlbGVjdGVkSXRlbSwgZXZlbnQ6IHsgZGJsY2xpY2s6IGFkZEl0ZW0gfVxcXCI+PC9kaXY+XFxuICA8ZGl2IGNsYXNzPVxcXCJpbWctcm91bmRlZCBoYy1pdGVtIGhjLWl0ZW0tYm9vdHNfb2ZfZWx2ZXNcXFwiIGlkPVxcXCJib290c19vZl9lbHZlc1xcXCIgZGF0YS1iaW5kPVxcXCJjbGljazogY2hhbmdlU2VsZWN0ZWRJdGVtLCBldmVudDogeyBkYmxjbGljazogYWRkSXRlbSB9XFxcIj48L2Rpdj5cXG4gIDxkaXYgY2xhc3M9XFxcImltZy1yb3VuZGVkIGhjLWl0ZW0gaGMtaXRlbS1yb2JlXFxcIiBpZD1cXFwicm9iZVxcXCIgZGF0YS1iaW5kPVxcXCJjbGljazogY2hhbmdlU2VsZWN0ZWRJdGVtLCBldmVudDogeyBkYmxjbGljazogYWRkSXRlbSB9XFxcIj48L2Rpdj5cXG4gIDxkaXYgY2xhc3M9XFxcImltZy1yb3VuZGVkIGhjLWl0ZW0gaGMtaXRlbS1vZ3JlX2F4ZVxcXCIgaWQ9XFxcIm9ncmVfYXhlXFxcIiBkYXRhLWJpbmQ9XFxcImNsaWNrOiBjaGFuZ2VTZWxlY3RlZEl0ZW0sIGV2ZW50OiB7IGRibGNsaWNrOiBhZGRJdGVtIH1cXFwiPjwvZGl2PlxcbiAgPGRpdiBjbGFzcz1cXFwiaW1nLXJvdW5kZWQgaGMtaXRlbSBoYy1pdGVtLWJsYWRlX29mX2FsYWNyaXR5XFxcIiBpZD1cXFwiYmxhZGVfb2ZfYWxhY3JpdHlcXFwiIGRhdGEtYmluZD1cXFwiY2xpY2s6IGNoYW5nZVNlbGVjdGVkSXRlbSwgZXZlbnQ6IHsgZGJsY2xpY2s6IGFkZEl0ZW0gfVxcXCI+PC9kaXY+XFxuICA8ZGl2IGNsYXNzPVxcXCJpbWctcm91bmRlZCBoYy1pdGVtIGhjLWl0ZW0tc3RhZmZfb2Zfd2l6YXJkcnlcXFwiIGlkPVxcXCJzdGFmZl9vZl93aXphcmRyeVxcXCIgZGF0YS1iaW5kPVxcXCJjbGljazogY2hhbmdlU2VsZWN0ZWRJdGVtLCBldmVudDogeyBkYmxjbGljazogYWRkSXRlbSB9XFxcIj48L2Rpdj5cXG4gIDxkaXYgY2xhc3M9XFxcImltZy1yb3VuZGVkIGhjLWl0ZW0gaGMtaXRlbS1lbXB0eWl0ZW1iZ1xcXCIgaWQ9XFxcImVtcHR5aXRlbWJnXFxcIj48L2Rpdj5cXG4gIDxkaXYgY2xhc3M9XFxcImltZy1yb3VuZGVkIGhjLWl0ZW0gaGMtaXRlbS1lbXB0eWl0ZW1iZ1xcXCIgaWQ9XFxcImVtcHR5aXRlbWJnXFxcIj48L2Rpdj5cXG4gIDxkaXYgY2xhc3M9XFxcImltZy1yb3VuZGVkIGhjLWl0ZW0gaGMtaXRlbS1lbXB0eWl0ZW1iZ1xcXCIgaWQ9XFxcImVtcHR5aXRlbWJnXFxcIj48L2Rpdj5cXG48L2Rpdj5cXG48ZGl2IGNsYXNzPVxcXCJzaG9wLWNvbHVtblxcXCI+XFxuICA8ZGl2IGNsYXNzPVxcXCJoYy1zaG9wIGhjLXNob3AtYXJtYW1lbnRzXFxcIiBpZD1cXFwiYXJtYW1lbnRzXFxcIj48L2Rpdj5cXG4gIDxkaXYgY2xhc3M9XFxcImltZy1yb3VuZGVkIGhjLWl0ZW0gaGMtaXRlbS1yaW5nX29mX3Byb3RlY3Rpb25cXFwiIGlkPVxcXCJyaW5nX29mX3Byb3RlY3Rpb25cXFwiIGRhdGEtYmluZD1cXFwiY2xpY2s6IGNoYW5nZVNlbGVjdGVkSXRlbSwgZXZlbnQ6IHsgZGJsY2xpY2s6IGFkZEl0ZW0gfVxcXCI+PC9kaXY+XFxuICA8ZGl2IGNsYXNzPVxcXCJpbWctcm91bmRlZCBoYy1pdGVtIGhjLWl0ZW0tc3RvdXRfc2hpZWxkXFxcIiBpZD1cXFwic3RvdXRfc2hpZWxkXFxcIiBkYXRhLWJpbmQ9XFxcImNsaWNrOiBjaGFuZ2VTZWxlY3RlZEl0ZW0sIGV2ZW50OiB7IGRibGNsaWNrOiBhZGRJdGVtIH1cXFwiPjwvZGl2PlxcbiAgPGRpdiBjbGFzcz1cXFwiaW1nLXJvdW5kZWQgaGMtaXRlbSBoYy1pdGVtLXF1ZWxsaW5nX2JsYWRlXFxcIiBpZD1cXFwicXVlbGxpbmdfYmxhZGVcXFwiIGRhdGEtYmluZD1cXFwiY2xpY2s6IGNoYW5nZVNlbGVjdGVkSXRlbSwgZXZlbnQ6IHsgZGJsY2xpY2s6IGFkZEl0ZW0gfVxcXCI+PC9kaXY+XFxuICA8ZGl2IGNsYXNzPVxcXCJpbWctcm91bmRlZCBoYy1pdGVtIGhjLWl0ZW0taW5mdXNlZF9yYWluZHJvcFxcXCIgaWQ9XFxcImluZnVzZWRfcmFpbmRyb3BcXFwiIGRhdGEtYmluZD1cXFwiY2xpY2s6IGNoYW5nZVNlbGVjdGVkSXRlbSwgZXZlbnQ6IHsgZGJsY2xpY2s6IGFkZEl0ZW0gfVxcXCI+PC9kaXY+XFxuICA8ZGl2IGNsYXNzPVxcXCJpbWctcm91bmRlZCBoYy1pdGVtIGhjLWl0ZW0tYmxpZ2h0X3N0b25lXFxcIiBpZD1cXFwiYmxpZ2h0X3N0b25lXFxcIiBkYXRhLWJpbmQ9XFxcImNsaWNrOiBjaGFuZ2VTZWxlY3RlZEl0ZW0sIGV2ZW50OiB7IGRibGNsaWNrOiBhZGRJdGVtIH1cXFwiPjwvZGl2PlxcbiAgPGRpdiBjbGFzcz1cXFwiaW1nLXJvdW5kZWQgaGMtaXRlbSBoYy1pdGVtLW9yYl9vZl92ZW5vbVxcXCIgaWQ9XFxcIm9yYl9vZl92ZW5vbVxcXCIgZGF0YS1iaW5kPVxcXCJjbGljazogY2hhbmdlU2VsZWN0ZWRJdGVtLCBldmVudDogeyBkYmxjbGljazogYWRkSXRlbSB9XFxcIj48L2Rpdj5cXG4gIDxkaXYgY2xhc3M9XFxcImltZy1yb3VuZGVkIGhjLWl0ZW0gaGMtaXRlbS1ibGFkZXNfb2ZfYXR0YWNrXFxcIiBpZD1cXFwiYmxhZGVzX29mX2F0dGFja1xcXCIgZGF0YS1iaW5kPVxcXCJjbGljazogY2hhbmdlU2VsZWN0ZWRJdGVtLCBldmVudDogeyBkYmxjbGljazogYWRkSXRlbSB9XFxcIj48L2Rpdj5cXG4gIDxkaXYgY2xhc3M9XFxcImltZy1yb3VuZGVkIGhjLWl0ZW0gaGMtaXRlbS1jaGFpbm1haWxcXFwiIGlkPVxcXCJjaGFpbm1haWxcXFwiIGRhdGEtYmluZD1cXFwiY2xpY2s6IGNoYW5nZVNlbGVjdGVkSXRlbSwgZXZlbnQ6IHsgZGJsY2xpY2s6IGFkZEl0ZW0gfVxcXCI+PC9kaXY+XFxuICA8ZGl2IGNsYXNzPVxcXCJpbWctcm91bmRlZCBoYy1pdGVtIGhjLWl0ZW0tcXVhcnRlcnN0YWZmXFxcIiBpZD1cXFwicXVhcnRlcnN0YWZmXFxcIiBkYXRhLWJpbmQ9XFxcImNsaWNrOiBjaGFuZ2VTZWxlY3RlZEl0ZW0sIGV2ZW50OiB7IGRibGNsaWNrOiBhZGRJdGVtIH1cXFwiPjwvZGl2PlxcbiAgPGRpdiBjbGFzcz1cXFwiaW1nLXJvdW5kZWQgaGMtaXRlbSBoYy1pdGVtLWhlbG1fb2ZfaXJvbl93aWxsXFxcIiBpZD1cXFwiaGVsbV9vZl9pcm9uX3dpbGxcXFwiIGRhdGEtYmluZD1cXFwiY2xpY2s6IGNoYW5nZVNlbGVjdGVkSXRlbSwgZXZlbnQ6IHsgZGJsY2xpY2s6IGFkZEl0ZW0gfVxcXCI+PC9kaXY+XFxuICA8ZGl2IGNsYXNzPVxcXCJpbWctcm91bmRlZCBoYy1pdGVtIGhjLWl0ZW0tYnJvYWRzd29yZFxcXCIgaWQ9XFxcImJyb2Fkc3dvcmRcXFwiIGRhdGEtYmluZD1cXFwiY2xpY2s6IGNoYW5nZVNlbGVjdGVkSXRlbSwgZXZlbnQ6IHsgZGJsY2xpY2s6IGFkZEl0ZW0gfVxcXCI+PC9kaXY+XFxuICA8ZGl2IGNsYXNzPVxcXCJpbWctcm91bmRlZCBoYy1pdGVtIGhjLWl0ZW0tY2xheW1vcmVcXFwiIGlkPVxcXCJjbGF5bW9yZVxcXCIgZGF0YS1iaW5kPVxcXCJjbGljazogY2hhbmdlU2VsZWN0ZWRJdGVtLCBldmVudDogeyBkYmxjbGljazogYWRkSXRlbSB9XFxcIj48L2Rpdj5cXG4gIDxkaXYgY2xhc3M9XFxcImltZy1yb3VuZGVkIGhjLWl0ZW0gaGMtaXRlbS1qYXZlbGluXFxcIiBpZD1cXFwiamF2ZWxpblxcXCIgZGF0YS1iaW5kPVxcXCJjbGljazogY2hhbmdlU2VsZWN0ZWRJdGVtLCBldmVudDogeyBkYmxjbGljazogYWRkSXRlbSB9XFxcIj48L2Rpdj5cXG4gIDxkaXYgY2xhc3M9XFxcImltZy1yb3VuZGVkIGhjLWl0ZW0gaGMtaXRlbS1taXRocmlsX2hhbW1lclxcXCIgaWQ9XFxcIm1pdGhyaWxfaGFtbWVyXFxcIiBkYXRhLWJpbmQ9XFxcImNsaWNrOiBjaGFuZ2VTZWxlY3RlZEl0ZW0sIGV2ZW50OiB7IGRibGNsaWNrOiBhZGRJdGVtIH1cXFwiPjwvZGl2PlxcbjwvZGl2PlxcbjxkaXYgY2xhc3M9XFxcInNob3AtY29sdW1uXFxcIj5cXG4gIDxkaXYgY2xhc3M9XFxcImhjLXNob3AgaGMtc2hvcC1hcmNhbmVcXFwiIGlkPVxcXCJhcmNhbmVcXFwiPjwvZGl2PlxcbiAgPGRpdiBjbGFzcz1cXFwiaW1nLXJvdW5kZWQgaGMtaXRlbSBoYy1pdGVtLXdpbmRfbGFjZVxcXCIgaWQ9XFxcIndpbmRfbGFjZVxcXCIgZGF0YS1iaW5kPVxcXCJjbGljazogY2hhbmdlU2VsZWN0ZWRJdGVtLCBldmVudDogeyBkYmxjbGljazogYWRkSXRlbSB9XFxcIj48L2Rpdj5cXG4gIDxkaXYgY2xhc3M9XFxcImltZy1yb3VuZGVkIGhjLWl0ZW0gaGMtaXRlbS1tYWdpY19zdGlja1xcXCIgaWQ9XFxcIm1hZ2ljX3N0aWNrXFxcIiBkYXRhLWJpbmQ9XFxcImNsaWNrOiBjaGFuZ2VTZWxlY3RlZEl0ZW0sIGV2ZW50OiB7IGRibGNsaWNrOiBhZGRJdGVtIH1cXFwiPjwvZGl2PlxcbiAgPGRpdiBjbGFzcz1cXFwiaW1nLXJvdW5kZWQgaGMtaXRlbSBoYy1pdGVtLXNvYmlfbWFza1xcXCIgaWQ9XFxcInNvYmlfbWFza1xcXCIgZGF0YS1iaW5kPVxcXCJjbGljazogY2hhbmdlU2VsZWN0ZWRJdGVtLCBldmVudDogeyBkYmxjbGljazogYWRkSXRlbSB9XFxcIj48L2Rpdj5cXG4gIDxkaXYgY2xhc3M9XFxcImltZy1yb3VuZGVkIGhjLWl0ZW0gaGMtaXRlbS1yaW5nX29mX3JlZ2VuXFxcIiBpZD1cXFwicmluZ19vZl9yZWdlblxcXCIgZGF0YS1iaW5kPVxcXCJjbGljazogY2hhbmdlU2VsZWN0ZWRJdGVtLCBldmVudDogeyBkYmxjbGljazogYWRkSXRlbSB9XFxcIj48L2Rpdj5cXG4gIDxkaXYgY2xhc3M9XFxcImltZy1yb3VuZGVkIGhjLWl0ZW0gaGMtaXRlbS1ib290c1xcXCIgaWQ9XFxcImJvb3RzXFxcIiBkYXRhLWJpbmQ9XFxcImNsaWNrOiBjaGFuZ2VTZWxlY3RlZEl0ZW0sIGV2ZW50OiB7IGRibGNsaWNrOiBhZGRJdGVtIH1cXFwiPjwvZGl2PlxcbiAgPGRpdiBjbGFzcz1cXFwiaW1nLXJvdW5kZWQgaGMtaXRlbSBoYy1pdGVtLWdsb3Zlc1xcXCIgaWQ9XFxcImdsb3Zlc1xcXCIgZGF0YS1iaW5kPVxcXCJjbGljazogY2hhbmdlU2VsZWN0ZWRJdGVtLCBldmVudDogeyBkYmxjbGljazogYWRkSXRlbSB9XFxcIj48L2Rpdj5cXG4gIDxkaXYgY2xhc3M9XFxcImltZy1yb3VuZGVkIGhjLWl0ZW0gaGMtaXRlbS1jbG9ha1xcXCIgaWQ9XFxcImNsb2FrXFxcIiBkYXRhLWJpbmQ9XFxcImNsaWNrOiBjaGFuZ2VTZWxlY3RlZEl0ZW0sIGV2ZW50OiB7IGRibGNsaWNrOiBhZGRJdGVtIH1cXFwiPjwvZGl2PlxcbiAgPGRpdiBjbGFzcz1cXFwiaW1nLXJvdW5kZWQgaGMtaXRlbSBoYy1pdGVtLXJpbmdfb2ZfaGVhbHRoXFxcIiBpZD1cXFwicmluZ19vZl9oZWFsdGhcXFwiIGRhdGEtYmluZD1cXFwiY2xpY2s6IGNoYW5nZVNlbGVjdGVkSXRlbSwgZXZlbnQ6IHsgZGJsY2xpY2s6IGFkZEl0ZW0gfVxcXCI+PC9kaXY+XFxuICA8ZGl2IGNsYXNzPVxcXCJpbWctcm91bmRlZCBoYy1pdGVtIGhjLWl0ZW0tdm9pZF9zdG9uZVxcXCIgaWQ9XFxcInZvaWRfc3RvbmVcXFwiIGRhdGEtYmluZD1cXFwiY2xpY2s6IGNoYW5nZVNlbGVjdGVkSXRlbSwgZXZlbnQ6IHsgZGJsY2xpY2s6IGFkZEl0ZW0gfVxcXCI+PC9kaXY+XFxuICA8ZGl2IGNsYXNzPVxcXCJpbWctcm91bmRlZCBoYy1pdGVtIGhjLWl0ZW0tZ2VtXFxcIiBpZD1cXFwiZ2VtXFxcIiBkYXRhLWJpbmQ9XFxcImNsaWNrOiBjaGFuZ2VTZWxlY3RlZEl0ZW0sIGV2ZW50OiB7IGRibGNsaWNrOiBhZGRJdGVtIH1cXFwiPjwvZGl2PlxcbiAgPGRpdiBjbGFzcz1cXFwiaW1nLXJvdW5kZWQgaGMtaXRlbSBoYy1pdGVtLWxpZmVzdGVhbFxcXCIgaWQ9XFxcImxpZmVzdGVhbFxcXCIgZGF0YS1iaW5kPVxcXCJjbGljazogY2hhbmdlU2VsZWN0ZWRJdGVtLCBldmVudDogeyBkYmxjbGljazogYWRkSXRlbSB9XFxcIj48L2Rpdj5cXG4gIDxkaXYgY2xhc3M9XFxcImltZy1yb3VuZGVkIGhjLWl0ZW0gaGMtaXRlbS1zaGFkb3dfYW11bGV0XFxcIiBpZD1cXFwic2hhZG93X2FtdWxldFxcXCIgZGF0YS1iaW5kPVxcXCJjbGljazogY2hhbmdlU2VsZWN0ZWRJdGVtLCBldmVudDogeyBkYmxjbGljazogYWRkSXRlbSB9XFxcIj48L2Rpdj5cXG4gIDxkaXYgY2xhc3M9XFxcImltZy1yb3VuZGVkIGhjLWl0ZW0gaGMtaXRlbS1naG9zdFxcXCIgaWQ9XFxcImdob3N0XFxcIiBkYXRhLWJpbmQ9XFxcImNsaWNrOiBjaGFuZ2VTZWxlY3RlZEl0ZW0sIGV2ZW50OiB7IGRibGNsaWNrOiBhZGRJdGVtIH1cXFwiPjwvZGl2PlxcbiAgPGRpdiBjbGFzcz1cXFwiaW1nLXJvdW5kZWQgaGMtaXRlbSBoYy1pdGVtLWJsaW5rXFxcIiBpZD1cXFwiYmxpbmtcXFwiIGRhdGEtYmluZD1cXFwiY2xpY2s6IGNoYW5nZVNlbGVjdGVkSXRlbSwgZXZlbnQ6IHsgZGJsY2xpY2s6IGFkZEl0ZW0gfVxcXCI+PC9kaXY+XFxuPC9kaXY+XFxuXFxuXFxuICAgICAgICAgICAgICAgIDwvZGl2PlxcbiAgICAgICAgICAgICAgICA8ZGl2IGNsYXNzPVxcXCJ0YWItcGFuZVxcXCIgaWQ9XFxcInNob3BfdXBncmFkZVxcXCI+XFxuPGRpdiBjbGFzcz1cXFwic2hvcC1jb2x1bW5cXFwiPlxcbiAgPGRpdiBjbGFzcz1cXFwiaGMtc2hvcCBoYy1zaG9wLWNvbW1vblxcXCIgaWQ9XFxcImNvbW1vblxcXCI+PC9kaXY+XFxuICA8ZGl2IGNsYXNzPVxcXCJpbWctcm91bmRlZCBoYy1pdGVtIGhjLWl0ZW0tbWFnaWNfd2FuZFxcXCIgaWQ9XFxcIm1hZ2ljX3dhbmRcXFwiIGRhdGEtYmluZD1cXFwiY2xpY2s6IGNoYW5nZVNlbGVjdGVkSXRlbSwgZXZlbnQ6IHsgZGJsY2xpY2s6IGFkZEl0ZW0gfVxcXCI+PC9kaXY+XFxuICA8ZGl2IGNsYXNzPVxcXCJpbWctcm91bmRlZCBoYy1pdGVtIGhjLWl0ZW0tbnVsbF90YWxpc21hblxcXCIgaWQ9XFxcIm51bGxfdGFsaXNtYW5cXFwiIGRhdGEtYmluZD1cXFwiY2xpY2s6IGNoYW5nZVNlbGVjdGVkSXRlbSwgZXZlbnQ6IHsgZGJsY2xpY2s6IGFkZEl0ZW0gfVxcXCI+PC9kaXY+XFxuICA8ZGl2IGNsYXNzPVxcXCJpbWctcm91bmRlZCBoYy1pdGVtIGhjLWl0ZW0td3JhaXRoX2JhbmRcXFwiIGlkPVxcXCJ3cmFpdGhfYmFuZFxcXCIgZGF0YS1iaW5kPVxcXCJjbGljazogY2hhbmdlU2VsZWN0ZWRJdGVtLCBldmVudDogeyBkYmxjbGljazogYWRkSXRlbSB9XFxcIj48L2Rpdj5cXG4gIDxkaXYgY2xhc3M9XFxcImltZy1yb3VuZGVkIGhjLWl0ZW0gaGMtaXRlbS1wb29yX21hbnNfc2hpZWxkXFxcIiBpZD1cXFwicG9vcl9tYW5zX3NoaWVsZFxcXCIgZGF0YS1iaW5kPVxcXCJjbGljazogY2hhbmdlU2VsZWN0ZWRJdGVtLCBldmVudDogeyBkYmxjbGljazogYWRkSXRlbSB9XFxcIj48L2Rpdj5cXG4gIDxkaXYgY2xhc3M9XFxcImltZy1yb3VuZGVkIGhjLWl0ZW0gaGMtaXRlbS1icmFjZXJcXFwiIGlkPVxcXCJicmFjZXJcXFwiIGRhdGEtYmluZD1cXFwiY2xpY2s6IGNoYW5nZVNlbGVjdGVkSXRlbSwgZXZlbnQ6IHsgZGJsY2xpY2s6IGFkZEl0ZW0gfVxcXCI+PC9kaXY+XFxuICA8ZGl2IGNsYXNzPVxcXCJpbWctcm91bmRlZCBoYy1pdGVtIGhjLWl0ZW0tc291bF9yaW5nXFxcIiBpZD1cXFwic291bF9yaW5nXFxcIiBkYXRhLWJpbmQ9XFxcImNsaWNrOiBjaGFuZ2VTZWxlY3RlZEl0ZW0sIGV2ZW50OiB7IGRibGNsaWNrOiBhZGRJdGVtIH1cXFwiPjwvZGl2PlxcbiAgPGRpdiBjbGFzcz1cXFwiaW1nLXJvdW5kZWQgaGMtaXRlbSBoYy1pdGVtLXBoYXNlX2Jvb3RzXFxcIiBpZD1cXFwicGhhc2VfYm9vdHNcXFwiIGRhdGEtYmluZD1cXFwiY2xpY2s6IGNoYW5nZVNlbGVjdGVkSXRlbSwgZXZlbnQ6IHsgZGJsY2xpY2s6IGFkZEl0ZW0gfVxcXCI+PC9kaXY+XFxuICA8ZGl2IGNsYXNzPVxcXCJpbWctcm91bmRlZCBoYy1pdGVtIGhjLWl0ZW0tcG93ZXJfdHJlYWRzXFxcIiBpZD1cXFwicG93ZXJfdHJlYWRzXFxcIiBkYXRhLWJpbmQ9XFxcImNsaWNrOiBjaGFuZ2VTZWxlY3RlZEl0ZW0sIGV2ZW50OiB7IGRibGNsaWNrOiBhZGRJdGVtIH1cXFwiPjwvZGl2PlxcbiAgPGRpdiBjbGFzcz1cXFwiaW1nLXJvdW5kZWQgaGMtaXRlbSBoYy1pdGVtLW9ibGl2aW9uX3N0YWZmXFxcIiBpZD1cXFwib2JsaXZpb25fc3RhZmZcXFwiIGRhdGEtYmluZD1cXFwiY2xpY2s6IGNoYW5nZVNlbGVjdGVkSXRlbSwgZXZlbnQ6IHsgZGJsY2xpY2s6IGFkZEl0ZW0gfVxcXCI+PC9kaXY+XFxuICA8ZGl2IGNsYXNzPVxcXCJpbWctcm91bmRlZCBoYy1pdGVtIGhjLWl0ZW0tcGVyc1xcXCIgaWQ9XFxcInBlcnNcXFwiIGRhdGEtYmluZD1cXFwiY2xpY2s6IGNoYW5nZVNlbGVjdGVkSXRlbSwgZXZlbnQ6IHsgZGJsY2xpY2s6IGFkZEl0ZW0gfVxcXCI+PC9kaXY+XFxuICA8ZGl2IGNsYXNzPVxcXCJpbWctcm91bmRlZCBoYy1pdGVtIGhjLWl0ZW0taGFuZF9vZl9taWRhc1xcXCIgaWQ9XFxcImhhbmRfb2ZfbWlkYXNcXFwiIGRhdGEtYmluZD1cXFwiY2xpY2s6IGNoYW5nZVNlbGVjdGVkSXRlbSwgZXZlbnQ6IHsgZGJsY2xpY2s6IGFkZEl0ZW0gfVxcXCI+PC9kaXY+XFxuICA8ZGl2IGNsYXNzPVxcXCJpbWctcm91bmRlZCBoYy1pdGVtIGhjLWl0ZW0tdHJhdmVsX2Jvb3RzXFxcIiBpZD1cXFwidHJhdmVsX2Jvb3RzXFxcIiBkYXRhLWJpbmQ9XFxcImNsaWNrOiBjaGFuZ2VTZWxlY3RlZEl0ZW0sIGV2ZW50OiB7IGRibGNsaWNrOiBhZGRJdGVtIH1cXFwiPjwvZGl2PlxcbiAgPGRpdiBjbGFzcz1cXFwiaW1nLXJvdW5kZWQgaGMtaXRlbSBoYy1pdGVtLW1vb25fc2hhcmRcXFwiIGlkPVxcXCJtb29uX3NoYXJkXFxcIiBkYXRhLWJpbmQ9XFxcImNsaWNrOiBjaGFuZ2VTZWxlY3RlZEl0ZW0sIGV2ZW50OiB7IGRibGNsaWNrOiBhZGRJdGVtIH1cXFwiPjwvZGl2PlxcbiAgPGRpdiBjbGFzcz1cXFwiaW1nLXJvdW5kZWQgaGMtaXRlbSBoYy1pdGVtLWVtcHR5aXRlbWJnXFxcIiBpZD1cXFwiZW1wdHlpdGVtYmdcXFwiPjwvZGl2PlxcbjwvZGl2PlxcbjxkaXYgY2xhc3M9XFxcInNob3AtY29sdW1uXFxcIj5cXG4gIDxkaXYgY2xhc3M9XFxcImhjLXNob3AgaGMtc2hvcC1zdXBwb3J0XFxcIiBpZD1cXFwic3VwcG9ydFxcXCI+PC9kaXY+XFxuICA8ZGl2IGNsYXNzPVxcXCJpbWctcm91bmRlZCBoYy1pdGVtIGhjLWl0ZW0tcmluZ19vZl9iYXNpbGl1c1xcXCIgaWQ9XFxcInJpbmdfb2ZfYmFzaWxpdXNcXFwiIGRhdGEtYmluZD1cXFwiY2xpY2s6IGNoYW5nZVNlbGVjdGVkSXRlbSwgZXZlbnQ6IHsgZGJsY2xpY2s6IGFkZEl0ZW0gfVxcXCI+PC9kaXY+XFxuICA8ZGl2IGNsYXNzPVxcXCJpbWctcm91bmRlZCBoYy1pdGVtIGhjLWl0ZW0taXJvbl90YWxvblxcXCIgaWQ9XFxcImlyb25fdGFsb25cXFwiIGRhdGEtYmluZD1cXFwiY2xpY2s6IGNoYW5nZVNlbGVjdGVkSXRlbSwgZXZlbnQ6IHsgZGJsY2xpY2s6IGFkZEl0ZW0gfVxcXCI+PC9kaXY+XFxuICA8ZGl2IGNsYXNzPVxcXCJpbWctcm91bmRlZCBoYy1pdGVtIGhjLWl0ZW0taGVhZGRyZXNzXFxcIiBpZD1cXFwiaGVhZGRyZXNzXFxcIiBkYXRhLWJpbmQ9XFxcImNsaWNrOiBjaGFuZ2VTZWxlY3RlZEl0ZW0sIGV2ZW50OiB7IGRibGNsaWNrOiBhZGRJdGVtIH1cXFwiPjwvZGl2PlxcbiAgPGRpdiBjbGFzcz1cXFwiaW1nLXJvdW5kZWQgaGMtaXRlbSBoYy1pdGVtLWJ1Y2tsZXJcXFwiIGlkPVxcXCJidWNrbGVyXFxcIiBkYXRhLWJpbmQ9XFxcImNsaWNrOiBjaGFuZ2VTZWxlY3RlZEl0ZW0sIGV2ZW50OiB7IGRibGNsaWNrOiBhZGRJdGVtIH1cXFwiPjwvZGl2PlxcbiAgPGRpdiBjbGFzcz1cXFwiaW1nLXJvdW5kZWQgaGMtaXRlbSBoYy1pdGVtLXVybl9vZl9zaGFkb3dzXFxcIiBpZD1cXFwidXJuX29mX3NoYWRvd3NcXFwiIGRhdGEtYmluZD1cXFwiY2xpY2s6IGNoYW5nZVNlbGVjdGVkSXRlbSwgZXZlbnQ6IHsgZGJsY2xpY2s6IGFkZEl0ZW0gfVxcXCI+PC9kaXY+XFxuICA8ZGl2IGNsYXNzPVxcXCJpbWctcm91bmRlZCBoYy1pdGVtIGhjLWl0ZW0tdHJhbnF1aWxfYm9vdHNcXFwiIGlkPVxcXCJ0cmFucXVpbF9ib290c1xcXCIgZGF0YS1iaW5kPVxcXCJjbGljazogY2hhbmdlU2VsZWN0ZWRJdGVtLCBldmVudDogeyBkYmxjbGljazogYWRkSXRlbSB9XFxcIj48L2Rpdj5cXG4gIDxkaXYgY2xhc3M9XFxcImltZy1yb3VuZGVkIGhjLWl0ZW0gaGMtaXRlbS1yaW5nX29mX2FxdWlsYVxcXCIgaWQ9XFxcInJpbmdfb2ZfYXF1aWxhXFxcIiBkYXRhLWJpbmQ9XFxcImNsaWNrOiBjaGFuZ2VTZWxlY3RlZEl0ZW0sIGV2ZW50OiB7IGRibGNsaWNrOiBhZGRJdGVtIH1cXFwiPjwvZGl2PlxcbiAgPGRpdiBjbGFzcz1cXFwiaW1nLXJvdW5kZWQgaGMtaXRlbSBoYy1pdGVtLW1lZGFsbGlvbl9vZl9jb3VyYWdlXFxcIiBpZD1cXFwibWVkYWxsaW9uX29mX2NvdXJhZ2VcXFwiIGRhdGEtYmluZD1cXFwiY2xpY2s6IGNoYW5nZVNlbGVjdGVkSXRlbSwgZXZlbnQ6IHsgZGJsY2xpY2s6IGFkZEl0ZW0gfVxcXCI+PC9kaXY+XFxuICA8ZGl2IGNsYXNzPVxcXCJpbWctcm91bmRlZCBoYy1pdGVtIGhjLWl0ZW0tYXJjYW5lX2Jvb3RzXFxcIiBpZD1cXFwiYXJjYW5lX2Jvb3RzXFxcIiBkYXRhLWJpbmQ9XFxcImNsaWNrOiBjaGFuZ2VTZWxlY3RlZEl0ZW0sIGV2ZW50OiB7IGRibGNsaWNrOiBhZGRJdGVtIH1cXFwiPjwvZGl2PlxcbiAgPGRpdiBjbGFzcz1cXFwiaW1nLXJvdW5kZWQgaGMtaXRlbSBoYy1pdGVtLWFuY2llbnRfamFuZ2dvXFxcIiBpZD1cXFwiYW5jaWVudF9qYW5nZ29cXFwiIGRhdGEtYmluZD1cXFwiY2xpY2s6IGNoYW5nZVNlbGVjdGVkSXRlbSwgZXZlbnQ6IHsgZGJsY2xpY2s6IGFkZEl0ZW0gfVxcXCI+PC9kaXY+XFxuICA8ZGl2IGNsYXNzPVxcXCJpbWctcm91bmRlZCBoYy1pdGVtIGhjLWl0ZW0tbWVrYW5zbVxcXCIgaWQ9XFxcIm1la2Fuc21cXFwiIGRhdGEtYmluZD1cXFwiY2xpY2s6IGNoYW5nZVNlbGVjdGVkSXRlbSwgZXZlbnQ6IHsgZGJsY2xpY2s6IGFkZEl0ZW0gfVxcXCI+PC9kaXY+XFxuICA8ZGl2IGNsYXNzPVxcXCJpbWctcm91bmRlZCBoYy1pdGVtIGhjLWl0ZW0tdmxhZG1pclxcXCIgaWQ9XFxcInZsYWRtaXJcXFwiIGRhdGEtYmluZD1cXFwiY2xpY2s6IGNoYW5nZVNlbGVjdGVkSXRlbSwgZXZlbnQ6IHsgZGJsY2xpY2s6IGFkZEl0ZW0gfVxcXCI+PC9kaXY+XFxuICA8ZGl2IGNsYXNzPVxcXCJpbWctcm91bmRlZCBoYy1pdGVtIGhjLWl0ZW0tcGlwZVxcXCIgaWQ9XFxcInBpcGVcXFwiIGRhdGEtYmluZD1cXFwiY2xpY2s6IGNoYW5nZVNlbGVjdGVkSXRlbSwgZXZlbnQ6IHsgZGJsY2xpY2s6IGFkZEl0ZW0gfVxcXCI+PC9kaXY+XFxuICA8ZGl2IGNsYXNzPVxcXCJpbWctcm91bmRlZCBoYy1pdGVtIGhjLWl0ZW0tZ3VhcmRpYW5fZ3JlYXZlc1xcXCIgaWQ9XFxcImd1YXJkaWFuX2dyZWF2ZXNcXFwiIGRhdGEtYmluZD1cXFwiY2xpY2s6IGNoYW5nZVNlbGVjdGVkSXRlbSwgZXZlbnQ6IHsgZGJsY2xpY2s6IGFkZEl0ZW0gfVxcXCI+PC9kaXY+XFxuPC9kaXY+XFxuPGRpdiBjbGFzcz1cXFwic2hvcC1jb2x1bW5cXFwiPlxcbiAgPGRpdiBjbGFzcz1cXFwiaGMtc2hvcCBoYy1zaG9wLWNhc3RlclxcXCIgaWQ9XFxcImNhc3RlclxcXCI+PC9kaXY+XFxuICA8ZGl2IGNsYXNzPVxcXCJpbWctcm91bmRlZCBoYy1pdGVtIGhjLWl0ZW0tZ2xpbW1lcl9jYXBlXFxcIiBpZD1cXFwiZ2xpbW1lcl9jYXBlXFxcIiBkYXRhLWJpbmQ9XFxcImNsaWNrOiBjaGFuZ2VTZWxlY3RlZEl0ZW0sIGV2ZW50OiB7IGRibGNsaWNrOiBhZGRJdGVtIH1cXFwiPjwvZGl2PlxcbiAgPGRpdiBjbGFzcz1cXFwiaW1nLXJvdW5kZWQgaGMtaXRlbSBoYy1pdGVtLWZvcmNlX3N0YWZmXFxcIiBpZD1cXFwiZm9yY2Vfc3RhZmZcXFwiIGRhdGEtYmluZD1cXFwiY2xpY2s6IGNoYW5nZVNlbGVjdGVkSXRlbSwgZXZlbnQ6IHsgZGJsY2xpY2s6IGFkZEl0ZW0gfVxcXCI+PC9kaXY+XFxuICA8ZGl2IGNsYXNzPVxcXCJpbWctcm91bmRlZCBoYy1pdGVtIGhjLWl0ZW0tdmVpbF9vZl9kaXNjb3JkXFxcIiBpZD1cXFwidmVpbF9vZl9kaXNjb3JkXFxcIiBkYXRhLWJpbmQ9XFxcImNsaWNrOiBjaGFuZ2VTZWxlY3RlZEl0ZW0sIGV2ZW50OiB7IGRibGNsaWNrOiBhZGRJdGVtIH1cXFwiPjwvZGl2PlxcbiAgPGRpdiBjbGFzcz1cXFwiaW1nLXJvdW5kZWQgaGMtaXRlbSBoYy1pdGVtLWFldGhlcl9sZW5zXFxcIiBpZD1cXFwiYWV0aGVyX2xlbnNcXFwiIGRhdGEtYmluZD1cXFwiY2xpY2s6IGNoYW5nZVNlbGVjdGVkSXRlbSwgZXZlbnQ6IHsgZGJsY2xpY2s6IGFkZEl0ZW0gfVxcXCI+PC9kaXY+XFxuICA8ZGl2IGNsYXNzPVxcXCJpbWctcm91bmRlZCBoYy1pdGVtIGhjLWl0ZW0tbmVjcm9ub21pY29uXFxcIiBpZD1cXFwibmVjcm9ub21pY29uXFxcIiBkYXRhLWJpbmQ9XFxcImNsaWNrOiBjaGFuZ2VTZWxlY3RlZEl0ZW0sIGV2ZW50OiB7IGRibGNsaWNrOiBhZGRJdGVtIH1cXFwiPjwvZGl2PlxcbiAgPGRpdiBjbGFzcz1cXFwiaW1nLXJvdW5kZWQgaGMtaXRlbSBoYy1pdGVtLWRhZ29uXFxcIiBpZD1cXFwiZGFnb25cXFwiIGRhdGEtYmluZD1cXFwiY2xpY2s6IGNoYW5nZVNlbGVjdGVkSXRlbSwgZXZlbnQ6IHsgZGJsY2xpY2s6IGFkZEl0ZW0gfVxcXCI+PC9kaXY+XFxuICA8ZGl2IGNsYXNzPVxcXCJpbWctcm91bmRlZCBoYy1pdGVtIGhjLWl0ZW0tY3ljbG9uZVxcXCIgaWQ9XFxcImN5Y2xvbmVcXFwiIGRhdGEtYmluZD1cXFwiY2xpY2s6IGNoYW5nZVNlbGVjdGVkSXRlbSwgZXZlbnQ6IHsgZGJsY2xpY2s6IGFkZEl0ZW0gfVxcXCI+PC9kaXY+XFxuICA8ZGl2IGNsYXNzPVxcXCJpbWctcm91bmRlZCBoYy1pdGVtIGhjLWl0ZW0tc29sYXJfY3Jlc3RcXFwiIGlkPVxcXCJzb2xhcl9jcmVzdFxcXCIgZGF0YS1iaW5kPVxcXCJjbGljazogY2hhbmdlU2VsZWN0ZWRJdGVtLCBldmVudDogeyBkYmxjbGljazogYWRkSXRlbSB9XFxcIj48L2Rpdj5cXG4gIDxkaXYgY2xhc3M9XFxcImltZy1yb3VuZGVkIGhjLWl0ZW0gaGMtaXRlbS1yb2Rfb2ZfYXRvc1xcXCIgaWQ9XFxcInJvZF9vZl9hdG9zXFxcIiBkYXRhLWJpbmQ9XFxcImNsaWNrOiBjaGFuZ2VTZWxlY3RlZEl0ZW0sIGV2ZW50OiB7IGRibGNsaWNrOiBhZGRJdGVtIH1cXFwiPjwvZGl2PlxcbiAgPGRpdiBjbGFzcz1cXFwiaW1nLXJvdW5kZWQgaGMtaXRlbSBoYy1pdGVtLW9yY2hpZFxcXCIgaWQ9XFxcIm9yY2hpZFxcXCIgZGF0YS1iaW5kPVxcXCJjbGljazogY2hhbmdlU2VsZWN0ZWRJdGVtLCBldmVudDogeyBkYmxjbGljazogYWRkSXRlbSB9XFxcIj48L2Rpdj5cXG4gIDxkaXYgY2xhc3M9XFxcImltZy1yb3VuZGVkIGhjLWl0ZW0gaGMtaXRlbS11bHRpbWF0ZV9zY2VwdGVyXFxcIiBpZD1cXFwidWx0aW1hdGVfc2NlcHRlclxcXCIgZGF0YS1iaW5kPVxcXCJjbGljazogY2hhbmdlU2VsZWN0ZWRJdGVtLCBldmVudDogeyBkYmxjbGljazogYWRkSXRlbSB9XFxcIj48L2Rpdj5cXG4gIDxkaXYgY2xhc3M9XFxcImltZy1yb3VuZGVkIGhjLWl0ZW0gaGMtaXRlbS1yZWZyZXNoZXJcXFwiIGlkPVxcXCJyZWZyZXNoZXJcXFwiIGRhdGEtYmluZD1cXFwiY2xpY2s6IGNoYW5nZVNlbGVjdGVkSXRlbSwgZXZlbnQ6IHsgZGJsY2xpY2s6IGFkZEl0ZW0gfVxcXCI+PC9kaXY+XFxuICA8ZGl2IGNsYXNzPVxcXCJpbWctcm91bmRlZCBoYy1pdGVtIGhjLWl0ZW0tc2hlZXBzdGlja1xcXCIgaWQ9XFxcInNoZWVwc3RpY2tcXFwiIGRhdGEtYmluZD1cXFwiY2xpY2s6IGNoYW5nZVNlbGVjdGVkSXRlbSwgZXZlbnQ6IHsgZGJsY2xpY2s6IGFkZEl0ZW0gfVxcXCI+PC9kaXY+XFxuICA8ZGl2IGNsYXNzPVxcXCJpbWctcm91bmRlZCBoYy1pdGVtIGhjLWl0ZW0tb2N0YXJpbmVfY29yZVxcXCIgaWQ9XFxcIm9jdGFyaW5lX2NvcmVcXFwiIGRhdGEtYmluZD1cXFwiY2xpY2s6IGNoYW5nZVNlbGVjdGVkSXRlbSwgZXZlbnQ6IHsgZGJsY2xpY2s6IGFkZEl0ZW0gfVxcXCI+PC9kaXY+XFxuPC9kaXY+XFxuPGRpdiBjbGFzcz1cXFwic2hvcC1jb2x1bW5cXFwiPlxcbiAgPGRpdiBjbGFzcz1cXFwiaGMtc2hvcCBoYy1zaG9wLXdlYXBvbnNcXFwiIGlkPVxcXCJ3ZWFwb25zXFxcIj48L2Rpdj5cXG4gIDxkaXYgY2xhc3M9XFxcImltZy1yb3VuZGVkIGhjLWl0ZW0gaGMtaXRlbS1sZXNzZXJfY3JpdFxcXCIgaWQ9XFxcImxlc3Nlcl9jcml0XFxcIiBkYXRhLWJpbmQ9XFxcImNsaWNrOiBjaGFuZ2VTZWxlY3RlZEl0ZW0sIGV2ZW50OiB7IGRibGNsaWNrOiBhZGRJdGVtIH1cXFwiPjwvZGl2PlxcbiAgPGRpdiBjbGFzcz1cXFwiaW1nLXJvdW5kZWQgaGMtaXRlbSBoYy1pdGVtLWFybWxldFxcXCIgaWQ9XFxcImFybWxldFxcXCIgZGF0YS1iaW5kPVxcXCJjbGljazogY2hhbmdlU2VsZWN0ZWRJdGVtLCBldmVudDogeyBkYmxjbGljazogYWRkSXRlbSB9XFxcIj48L2Rpdj5cXG4gIDxkaXYgY2xhc3M9XFxcImltZy1yb3VuZGVkIGhjLWl0ZW0gaGMtaXRlbS1pbnZpc19zd29yZFxcXCIgaWQ9XFxcImludmlzX3N3b3JkXFxcIiBkYXRhLWJpbmQ9XFxcImNsaWNrOiBjaGFuZ2VTZWxlY3RlZEl0ZW0sIGV2ZW50OiB7IGRibGNsaWNrOiBhZGRJdGVtIH1cXFwiPjwvZGl2PlxcbiAgPGRpdiBjbGFzcz1cXFwiaW1nLXJvdW5kZWQgaGMtaXRlbSBoYy1pdGVtLWJhc2hlclxcXCIgaWQ9XFxcImJhc2hlclxcXCIgZGF0YS1iaW5kPVxcXCJjbGljazogY2hhbmdlU2VsZWN0ZWRJdGVtLCBldmVudDogeyBkYmxjbGljazogYWRkSXRlbSB9XFxcIj48L2Rpdj5cXG4gIDxkaXYgY2xhc3M9XFxcImltZy1yb3VuZGVkIGhjLWl0ZW0gaGMtaXRlbS1iZnVyeVxcXCIgaWQ9XFxcImJmdXJ5XFxcIiBkYXRhLWJpbmQ9XFxcImNsaWNrOiBjaGFuZ2VTZWxlY3RlZEl0ZW0sIGV2ZW50OiB7IGRibGNsaWNrOiBhZGRJdGVtIH1cXFwiPjwvZGl2PlxcbiAgPGRpdiBjbGFzcz1cXFwiaW1nLXJvdW5kZWQgaGMtaXRlbSBoYy1pdGVtLWV0aGVyZWFsX2JsYWRlXFxcIiBpZD1cXFwiZXRoZXJlYWxfYmxhZGVcXFwiIGRhdGEtYmluZD1cXFwiY2xpY2s6IGNoYW5nZVNlbGVjdGVkSXRlbSwgZXZlbnQ6IHsgZGJsY2xpY2s6IGFkZEl0ZW0gfVxcXCI+PC9kaXY+XFxuICA8ZGl2IGNsYXNzPVxcXCJpbWctcm91bmRlZCBoYy1pdGVtIGhjLWl0ZW0tc2lsdmVyX2VkZ2VcXFwiIGlkPVxcXCJzaWx2ZXJfZWRnZVxcXCIgZGF0YS1iaW5kPVxcXCJjbGljazogY2hhbmdlU2VsZWN0ZWRJdGVtLCBldmVudDogeyBkYmxjbGljazogYWRkSXRlbSB9XFxcIj48L2Rpdj5cXG4gIDxkaXYgY2xhc3M9XFxcImltZy1yb3VuZGVkIGhjLWl0ZW0gaGMtaXRlbS1yYWRpYW5jZVxcXCIgaWQ9XFxcInJhZGlhbmNlXFxcIiBkYXRhLWJpbmQ9XFxcImNsaWNrOiBjaGFuZ2VTZWxlY3RlZEl0ZW0sIGV2ZW50OiB7IGRibGNsaWNrOiBhZGRJdGVtIH1cXFwiPjwvZGl2PlxcbiAgPGRpdiBjbGFzcz1cXFwiaW1nLXJvdW5kZWQgaGMtaXRlbSBoYy1pdGVtLW1vbmtleV9raW5nX2JhclxcXCIgaWQ9XFxcIm1vbmtleV9raW5nX2JhclxcXCIgZGF0YS1iaW5kPVxcXCJjbGljazogY2hhbmdlU2VsZWN0ZWRJdGVtLCBldmVudDogeyBkYmxjbGljazogYWRkSXRlbSB9XFxcIj48L2Rpdj5cXG4gIDxkaXYgY2xhc3M9XFxcImltZy1yb3VuZGVkIGhjLWl0ZW0gaGMtaXRlbS1ncmVhdGVyX2NyaXRcXFwiIGlkPVxcXCJncmVhdGVyX2NyaXRcXFwiIGRhdGEtYmluZD1cXFwiY2xpY2s6IGNoYW5nZVNlbGVjdGVkSXRlbSwgZXZlbnQ6IHsgZGJsY2xpY2s6IGFkZEl0ZW0gfVxcXCI+PC9kaXY+XFxuICA8ZGl2IGNsYXNzPVxcXCJpbWctcm91bmRlZCBoYy1pdGVtIGhjLWl0ZW0tYnV0dGVyZmx5XFxcIiBpZD1cXFwiYnV0dGVyZmx5XFxcIiBkYXRhLWJpbmQ9XFxcImNsaWNrOiBjaGFuZ2VTZWxlY3RlZEl0ZW0sIGV2ZW50OiB7IGRibGNsaWNrOiBhZGRJdGVtIH1cXFwiPjwvZGl2PlxcbiAgPGRpdiBjbGFzcz1cXFwiaW1nLXJvdW5kZWQgaGMtaXRlbSBoYy1pdGVtLXJhcGllclxcXCIgaWQ9XFxcInJhcGllclxcXCIgZGF0YS1iaW5kPVxcXCJjbGljazogY2hhbmdlU2VsZWN0ZWRJdGVtLCBldmVudDogeyBkYmxjbGljazogYWRkSXRlbSB9XFxcIj48L2Rpdj5cXG4gIDxkaXYgY2xhc3M9XFxcImltZy1yb3VuZGVkIGhjLWl0ZW0gaGMtaXRlbS1hYnlzc2FsX2JsYWRlXFxcIiBpZD1cXFwiYWJ5c3NhbF9ibGFkZVxcXCIgZGF0YS1iaW5kPVxcXCJjbGljazogY2hhbmdlU2VsZWN0ZWRJdGVtLCBldmVudDogeyBkYmxjbGljazogYWRkSXRlbSB9XFxcIj48L2Rpdj5cXG4gIDxkaXYgY2xhc3M9XFxcImltZy1yb3VuZGVkIGhjLWl0ZW0gaGMtaXRlbS1ibG9vZHRob3JuXFxcIiBpZD1cXFwiYmxvb2R0aG9yblxcXCIgZGF0YS1iaW5kPVxcXCJjbGljazogY2hhbmdlU2VsZWN0ZWRJdGVtLCBldmVudDogeyBkYmxjbGljazogYWRkSXRlbSB9XFxcIj48L2Rpdj5cXG48L2Rpdj5cXG48ZGl2IGNsYXNzPVxcXCJzaG9wLWNvbHVtblxcXCI+XFxuICA8ZGl2IGNsYXNzPVxcXCJoYy1zaG9wIGhjLXNob3AtYXJtb3JcXFwiIGlkPVxcXCJhcm1vclxcXCI+PC9kaXY+XFxuICA8ZGl2IGNsYXNzPVxcXCJpbWctcm91bmRlZCBoYy1pdGVtIGhjLWl0ZW0taG9vZF9vZl9kZWZpYW5jZVxcXCIgaWQ9XFxcImhvb2Rfb2ZfZGVmaWFuY2VcXFwiIGRhdGEtYmluZD1cXFwiY2xpY2s6IGNoYW5nZVNlbGVjdGVkSXRlbSwgZXZlbnQ6IHsgZGJsY2xpY2s6IGFkZEl0ZW0gfVxcXCI+PC9kaXY+XFxuICA8ZGl2IGNsYXNzPVxcXCJpbWctcm91bmRlZCBoYy1pdGVtIGhjLWl0ZW0tdmFuZ3VhcmRcXFwiIGlkPVxcXCJ2YW5ndWFyZFxcXCIgZGF0YS1iaW5kPVxcXCJjbGljazogY2hhbmdlU2VsZWN0ZWRJdGVtLCBldmVudDogeyBkYmxjbGljazogYWRkSXRlbSB9XFxcIj48L2Rpdj5cXG4gIDxkaXYgY2xhc3M9XFxcImltZy1yb3VuZGVkIGhjLWl0ZW0gaGMtaXRlbS1ibGFkZV9tYWlsXFxcIiBpZD1cXFwiYmxhZGVfbWFpbFxcXCIgZGF0YS1iaW5kPVxcXCJjbGljazogY2hhbmdlU2VsZWN0ZWRJdGVtLCBldmVudDogeyBkYmxjbGljazogYWRkSXRlbSB9XFxcIj48L2Rpdj5cXG4gIDxkaXYgY2xhc3M9XFxcImltZy1yb3VuZGVkIGhjLWl0ZW0gaGMtaXRlbS1zb3VsX2Jvb3N0ZXJcXFwiIGlkPVxcXCJzb3VsX2Jvb3N0ZXJcXFwiIGRhdGEtYmluZD1cXFwiY2xpY2s6IGNoYW5nZVNlbGVjdGVkSXRlbSwgZXZlbnQ6IHsgZGJsY2xpY2s6IGFkZEl0ZW0gfVxcXCI+PC9kaXY+XFxuICA8ZGl2IGNsYXNzPVxcXCJpbWctcm91bmRlZCBoYy1pdGVtIGhjLWl0ZW0tY3JpbXNvbl9ndWFyZFxcXCIgaWQ9XFxcImNyaW1zb25fZ3VhcmRcXFwiIGRhdGEtYmluZD1cXFwiY2xpY2s6IGNoYW5nZVNlbGVjdGVkSXRlbSwgZXZlbnQ6IHsgZGJsY2xpY2s6IGFkZEl0ZW0gfVxcXCI+PC9kaXY+XFxuICA8ZGl2IGNsYXNzPVxcXCJpbWctcm91bmRlZCBoYy1pdGVtIGhjLWl0ZW0tYmxhY2tfa2luZ19iYXJcXFwiIGlkPVxcXCJibGFja19raW5nX2JhclxcXCIgZGF0YS1iaW5kPVxcXCJjbGljazogY2hhbmdlU2VsZWN0ZWRJdGVtLCBldmVudDogeyBkYmxjbGljazogYWRkSXRlbSB9XFxcIj48L2Rpdj5cXG4gIDxkaXYgY2xhc3M9XFxcImltZy1yb3VuZGVkIGhjLWl0ZW0gaGMtaXRlbS1sb3R1c19vcmJcXFwiIGlkPVxcXCJsb3R1c19vcmJcXFwiIGRhdGEtYmluZD1cXFwiY2xpY2s6IGNoYW5nZVNlbGVjdGVkSXRlbSwgZXZlbnQ6IHsgZGJsY2xpY2s6IGFkZEl0ZW0gfVxcXCI+PC9kaXY+XFxuICA8ZGl2IGNsYXNzPVxcXCJpbWctcm91bmRlZCBoYy1pdGVtIGhjLWl0ZW0tc2hpdmFzX2d1YXJkXFxcIiBpZD1cXFwic2hpdmFzX2d1YXJkXFxcIiBkYXRhLWJpbmQ9XFxcImNsaWNrOiBjaGFuZ2VTZWxlY3RlZEl0ZW0sIGV2ZW50OiB7IGRibGNsaWNrOiBhZGRJdGVtIH1cXFwiPjwvZGl2PlxcbiAgPGRpdiBjbGFzcz1cXFwiaW1nLXJvdW5kZWQgaGMtaXRlbSBoYy1pdGVtLWJsb29kc3RvbmVcXFwiIGlkPVxcXCJibG9vZHN0b25lXFxcIiBkYXRhLWJpbmQ9XFxcImNsaWNrOiBjaGFuZ2VTZWxlY3RlZEl0ZW0sIGV2ZW50OiB7IGRibGNsaWNrOiBhZGRJdGVtIH1cXFwiPjwvZGl2PlxcbiAgPGRpdiBjbGFzcz1cXFwiaW1nLXJvdW5kZWQgaGMtaXRlbSBoYy1pdGVtLW1hbnRhXFxcIiBpZD1cXFwibWFudGFcXFwiIGRhdGEtYmluZD1cXFwiY2xpY2s6IGNoYW5nZVNlbGVjdGVkSXRlbSwgZXZlbnQ6IHsgZGJsY2xpY2s6IGFkZEl0ZW0gfVxcXCI+PC9kaXY+XFxuICA8ZGl2IGNsYXNzPVxcXCJpbWctcm91bmRlZCBoYy1pdGVtIGhjLWl0ZW0tc3BoZXJlXFxcIiBpZD1cXFwic3BoZXJlXFxcIiBkYXRhLWJpbmQ9XFxcImNsaWNrOiBjaGFuZ2VTZWxlY3RlZEl0ZW0sIGV2ZW50OiB7IGRibGNsaWNrOiBhZGRJdGVtIH1cXFwiPjwvZGl2PlxcbiAgPGRpdiBjbGFzcz1cXFwiaW1nLXJvdW5kZWQgaGMtaXRlbSBoYy1pdGVtLWh1cnJpY2FuZV9waWtlXFxcIiBpZD1cXFwiaHVycmljYW5lX3Bpa2VcXFwiIGRhdGEtYmluZD1cXFwiY2xpY2s6IGNoYW5nZVNlbGVjdGVkSXRlbSwgZXZlbnQ6IHsgZGJsY2xpY2s6IGFkZEl0ZW0gfVxcXCI+PC9kaXY+XFxuICA8ZGl2IGNsYXNzPVxcXCJpbWctcm91bmRlZCBoYy1pdGVtIGhjLWl0ZW0tYXNzYXVsdFxcXCIgaWQ9XFxcImFzc2F1bHRcXFwiIGRhdGEtYmluZD1cXFwiY2xpY2s6IGNoYW5nZVNlbGVjdGVkSXRlbSwgZXZlbnQ6IHsgZGJsY2xpY2s6IGFkZEl0ZW0gfVxcXCI+PC9kaXY+XFxuICA8ZGl2IGNsYXNzPVxcXCJpbWctcm91bmRlZCBoYy1pdGVtIGhjLWl0ZW0taGVhcnRcXFwiIGlkPVxcXCJoZWFydFxcXCIgZGF0YS1iaW5kPVxcXCJjbGljazogY2hhbmdlU2VsZWN0ZWRJdGVtLCBldmVudDogeyBkYmxjbGljazogYWRkSXRlbSB9XFxcIj48L2Rpdj5cXG48L2Rpdj5cXG48ZGl2IGNsYXNzPVxcXCJzaG9wLWNvbHVtblxcXCI+XFxuICA8ZGl2IGNsYXNzPVxcXCJoYy1zaG9wIGhjLXNob3AtYXJ0aWZhY3RzXFxcIiBpZD1cXFwiYXJ0aWZhY3RzXFxcIj48L2Rpdj5cXG4gIDxkaXYgY2xhc3M9XFxcImltZy1yb3VuZGVkIGhjLWl0ZW0gaGMtaXRlbS1tYXNrX29mX21hZG5lc3NcXFwiIGlkPVxcXCJtYXNrX29mX21hZG5lc3NcXFwiIGRhdGEtYmluZD1cXFwiY2xpY2s6IGNoYW5nZVNlbGVjdGVkSXRlbSwgZXZlbnQ6IHsgZGJsY2xpY2s6IGFkZEl0ZW0gfVxcXCI+PC9kaXY+XFxuICA8ZGl2IGNsYXNzPVxcXCJpbWctcm91bmRlZCBoYy1pdGVtIGhjLWl0ZW0taGVsbV9vZl90aGVfZG9taW5hdG9yXFxcIiBpZD1cXFwiaGVsbV9vZl90aGVfZG9taW5hdG9yXFxcIiBkYXRhLWJpbmQ9XFxcImNsaWNrOiBjaGFuZ2VTZWxlY3RlZEl0ZW0sIGV2ZW50OiB7IGRibGNsaWNrOiBhZGRJdGVtIH1cXFwiPjwvZGl2PlxcbiAgPGRpdiBjbGFzcz1cXFwiaW1nLXJvdW5kZWQgaGMtaXRlbSBoYy1pdGVtLWRyYWdvbl9sYW5jZVxcXCIgaWQ9XFxcImRyYWdvbl9sYW5jZVxcXCIgZGF0YS1iaW5kPVxcXCJjbGljazogY2hhbmdlU2VsZWN0ZWRJdGVtLCBldmVudDogeyBkYmxjbGljazogYWRkSXRlbSB9XFxcIj48L2Rpdj5cXG4gIDxkaXYgY2xhc3M9XFxcImltZy1yb3VuZGVkIGhjLWl0ZW0gaGMtaXRlbS1zYW5nZVxcXCIgaWQ9XFxcInNhbmdlXFxcIiBkYXRhLWJpbmQ9XFxcImNsaWNrOiBjaGFuZ2VTZWxlY3RlZEl0ZW0sIGV2ZW50OiB7IGRibGNsaWNrOiBhZGRJdGVtIH1cXFwiPjwvZGl2PlxcbiAgPGRpdiBjbGFzcz1cXFwiaW1nLXJvdW5kZWQgaGMtaXRlbSBoYy1pdGVtLXlhc2hhXFxcIiBpZD1cXFwieWFzaGFcXFwiIGRhdGEtYmluZD1cXFwiY2xpY2s6IGNoYW5nZVNlbGVjdGVkSXRlbSwgZXZlbnQ6IHsgZGJsY2xpY2s6IGFkZEl0ZW0gfVxcXCI+PC9kaXY+XFxuICA8ZGl2IGNsYXNzPVxcXCJpbWctcm91bmRlZCBoYy1pdGVtIGhjLWl0ZW0tZWNob19zYWJyZVxcXCIgaWQ9XFxcImVjaG9fc2FicmVcXFwiIGRhdGEtYmluZD1cXFwiY2xpY2s6IGNoYW5nZVNlbGVjdGVkSXRlbSwgZXZlbnQ6IHsgZGJsY2xpY2s6IGFkZEl0ZW0gfVxcXCI+PC9kaXY+XFxuICA8ZGl2IGNsYXNzPVxcXCJpbWctcm91bmRlZCBoYy1pdGVtIGhjLWl0ZW0tbWFlbHN0cm9tXFxcIiBpZD1cXFwibWFlbHN0cm9tXFxcIiBkYXRhLWJpbmQ9XFxcImNsaWNrOiBjaGFuZ2VTZWxlY3RlZEl0ZW0sIGV2ZW50OiB7IGRibGNsaWNrOiBhZGRJdGVtIH1cXFwiPjwvZGl2PlxcbiAgPGRpdiBjbGFzcz1cXFwiaW1nLXJvdW5kZWQgaGMtaXRlbSBoYy1pdGVtLWRpZmZ1c2FsX2JsYWRlXFxcIiBpZD1cXFwiZGlmZnVzYWxfYmxhZGVcXFwiIGRhdGEtYmluZD1cXFwiY2xpY2s6IGNoYW5nZVNlbGVjdGVkSXRlbSwgZXZlbnQ6IHsgZGJsY2xpY2s6IGFkZEl0ZW0gfVxcXCI+PC9kaXY+XFxuICA8ZGl2IGNsYXNzPVxcXCJpbWctcm91bmRlZCBoYy1pdGVtIGhjLWl0ZW0tZGVzb2xhdG9yXFxcIiBpZD1cXFwiZGVzb2xhdG9yXFxcIiBkYXRhLWJpbmQ9XFxcImNsaWNrOiBjaGFuZ2VTZWxlY3RlZEl0ZW0sIGV2ZW50OiB7IGRibGNsaWNrOiBhZGRJdGVtIH1cXFwiPjwvZGl2PlxcbiAgPGRpdiBjbGFzcz1cXFwiaW1nLXJvdW5kZWQgaGMtaXRlbSBoYy1pdGVtLWhlYXZlbnNfaGFsYmVyZFxcXCIgaWQ9XFxcImhlYXZlbnNfaGFsYmVyZFxcXCIgZGF0YS1iaW5kPVxcXCJjbGljazogY2hhbmdlU2VsZWN0ZWRJdGVtLCBldmVudDogeyBkYmxjbGljazogYWRkSXRlbSB9XFxcIj48L2Rpdj5cXG4gIDxkaXYgY2xhc3M9XFxcImltZy1yb3VuZGVkIGhjLWl0ZW0gaGMtaXRlbS1zYW5nZV9hbmRfeWFzaGFcXFwiIGlkPVxcXCJzYW5nZV9hbmRfeWFzaGFcXFwiIGRhdGEtYmluZD1cXFwiY2xpY2s6IGNoYW5nZVNlbGVjdGVkSXRlbSwgZXZlbnQ6IHsgZGJsY2xpY2s6IGFkZEl0ZW0gfVxcXCI+PC9kaXY+XFxuICA8ZGl2IGNsYXNzPVxcXCJpbWctcm91bmRlZCBoYy1pdGVtIGhjLWl0ZW0tc2thZGlcXFwiIGlkPVxcXCJza2FkaVxcXCIgZGF0YS1iaW5kPVxcXCJjbGljazogY2hhbmdlU2VsZWN0ZWRJdGVtLCBldmVudDogeyBkYmxjbGljazogYWRkSXRlbSB9XFxcIj48L2Rpdj5cXG4gIDxkaXYgY2xhc3M9XFxcImltZy1yb3VuZGVkIGhjLWl0ZW0gaGMtaXRlbS1tam9sbG5pclxcXCIgaWQ9XFxcIm1qb2xsbmlyXFxcIiBkYXRhLWJpbmQ9XFxcImNsaWNrOiBjaGFuZ2VTZWxlY3RlZEl0ZW0sIGV2ZW50OiB7IGRibGNsaWNrOiBhZGRJdGVtIH1cXFwiPjwvZGl2PlxcbiAgPGRpdiBjbGFzcz1cXFwiaW1nLXJvdW5kZWQgaGMtaXRlbSBoYy1pdGVtLXNhdGFuaWNcXFwiIGlkPVxcXCJzYXRhbmljXFxcIiBkYXRhLWJpbmQ9XFxcImNsaWNrOiBjaGFuZ2VTZWxlY3RlZEl0ZW0sIGV2ZW50OiB7IGRibGNsaWNrOiBhZGRJdGVtIH1cXFwiPjwvZGl2PlxcbjwvZGl2PlxcbiAgICAgICAgICAgICAgICA8L2Rpdj5cXG4gICAgICAgICAgICAgICAgPGRpdiBjbGFzcz1cXFwidGFiLXBhbmVcXFwiIGlkPVxcXCJzaG9wX3NlY3JldFxcXCI+XFxuPGRpdiBjbGFzcz1cXFwic2hvcC1jb2x1bW5cXFwiPlxcbiAgPGRpdiBjbGFzcz1cXFwiaGMtc2hvcCBoYy1zaG9wLXNlY3JldFxcXCIgaWQ9XFxcInNlY3JldFxcXCI+PC9kaXY+XFxuICA8ZGl2IGNsYXNzPVxcXCJpbWctcm91bmRlZCBoYy1pdGVtIGhjLWl0ZW0tZW5lcmd5X2Jvb3N0ZXJcXFwiIGlkPVxcXCJlbmVyZ3lfYm9vc3RlclxcXCIgZGF0YS1iaW5kPVxcXCJjbGljazogY2hhbmdlU2VsZWN0ZWRJdGVtLCBldmVudDogeyBkYmxjbGljazogYWRkSXRlbSB9XFxcIj48L2Rpdj5cXG4gIDxkaXYgY2xhc3M9XFxcImltZy1yb3VuZGVkIGhjLWl0ZW0gaGMtaXRlbS12aXRhbGl0eV9ib29zdGVyXFxcIiBpZD1cXFwidml0YWxpdHlfYm9vc3RlclxcXCIgZGF0YS1iaW5kPVxcXCJjbGljazogY2hhbmdlU2VsZWN0ZWRJdGVtLCBldmVudDogeyBkYmxjbGljazogYWRkSXRlbSB9XFxcIj48L2Rpdj5cXG4gIDxkaXYgY2xhc3M9XFxcImltZy1yb3VuZGVkIGhjLWl0ZW0gaGMtaXRlbS1wb2ludF9ib29zdGVyXFxcIiBpZD1cXFwicG9pbnRfYm9vc3RlclxcXCIgZGF0YS1iaW5kPVxcXCJjbGljazogY2hhbmdlU2VsZWN0ZWRJdGVtLCBldmVudDogeyBkYmxjbGljazogYWRkSXRlbSB9XFxcIj48L2Rpdj5cXG4gIDxkaXYgY2xhc3M9XFxcImltZy1yb3VuZGVkIGhjLWl0ZW0gaGMtaXRlbS1wbGF0ZW1haWxcXFwiIGlkPVxcXCJwbGF0ZW1haWxcXFwiIGRhdGEtYmluZD1cXFwiY2xpY2s6IGNoYW5nZVNlbGVjdGVkSXRlbSwgZXZlbnQ6IHsgZGJsY2xpY2s6IGFkZEl0ZW0gfVxcXCI+PC9kaXY+XFxuICA8ZGl2IGNsYXNzPVxcXCJpbWctcm91bmRlZCBoYy1pdGVtIGhjLWl0ZW0tdGFsaXNtYW5fb2ZfZXZhc2lvblxcXCIgaWQ9XFxcInRhbGlzbWFuX29mX2V2YXNpb25cXFwiIGRhdGEtYmluZD1cXFwiY2xpY2s6IGNoYW5nZVNlbGVjdGVkSXRlbSwgZXZlbnQ6IHsgZGJsY2xpY2s6IGFkZEl0ZW0gfVxcXCI+PC9kaXY+XFxuICA8ZGl2IGNsYXNzPVxcXCJpbWctcm91bmRlZCBoYy1pdGVtIGhjLWl0ZW0taHlwZXJzdG9uZVxcXCIgaWQ9XFxcImh5cGVyc3RvbmVcXFwiIGRhdGEtYmluZD1cXFwiY2xpY2s6IGNoYW5nZVNlbGVjdGVkSXRlbSwgZXZlbnQ6IHsgZGJsY2xpY2s6IGFkZEl0ZW0gfVxcXCI+PC9kaXY+XFxuICA8ZGl2IGNsYXNzPVxcXCJpbWctcm91bmRlZCBoYy1pdGVtIGhjLWl0ZW0tdWx0aW1hdGVfb3JiXFxcIiBpZD1cXFwidWx0aW1hdGVfb3JiXFxcIiBkYXRhLWJpbmQ9XFxcImNsaWNrOiBjaGFuZ2VTZWxlY3RlZEl0ZW0sIGV2ZW50OiB7IGRibGNsaWNrOiBhZGRJdGVtIH1cXFwiPjwvZGl2PlxcbiAgPGRpdiBjbGFzcz1cXFwiaW1nLXJvdW5kZWQgaGMtaXRlbSBoYy1pdGVtLWRlbW9uX2VkZ2VcXFwiIGlkPVxcXCJkZW1vbl9lZGdlXFxcIiBkYXRhLWJpbmQ9XFxcImNsaWNrOiBjaGFuZ2VTZWxlY3RlZEl0ZW0sIGV2ZW50OiB7IGRibGNsaWNrOiBhZGRJdGVtIH1cXFwiPjwvZGl2PlxcbiAgPGRpdiBjbGFzcz1cXFwiaW1nLXJvdW5kZWQgaGMtaXRlbSBoYy1pdGVtLW15c3RpY19zdGFmZlxcXCIgaWQ9XFxcIm15c3RpY19zdGFmZlxcXCIgZGF0YS1iaW5kPVxcXCJjbGljazogY2hhbmdlU2VsZWN0ZWRJdGVtLCBldmVudDogeyBkYmxjbGljazogYWRkSXRlbSB9XFxcIj48L2Rpdj5cXG4gIDxkaXYgY2xhc3M9XFxcImltZy1yb3VuZGVkIGhjLWl0ZW0gaGMtaXRlbS1lYWdsZVxcXCIgaWQ9XFxcImVhZ2xlXFxcIiBkYXRhLWJpbmQ9XFxcImNsaWNrOiBjaGFuZ2VTZWxlY3RlZEl0ZW0sIGV2ZW50OiB7IGRibGNsaWNrOiBhZGRJdGVtIH1cXFwiPjwvZGl2PlxcbiAgPGRpdiBjbGFzcz1cXFwiaW1nLXJvdW5kZWQgaGMtaXRlbSBoYy1pdGVtLXJlYXZlclxcXCIgaWQ9XFxcInJlYXZlclxcXCIgZGF0YS1iaW5kPVxcXCJjbGljazogY2hhbmdlU2VsZWN0ZWRJdGVtLCBldmVudDogeyBkYmxjbGljazogYWRkSXRlbSB9XFxcIj48L2Rpdj5cXG4gIDxkaXYgY2xhc3M9XFxcImltZy1yb3VuZGVkIGhjLWl0ZW0gaGMtaXRlbS1yZWxpY1xcXCIgaWQ9XFxcInJlbGljXFxcIiBkYXRhLWJpbmQ9XFxcImNsaWNrOiBjaGFuZ2VTZWxlY3RlZEl0ZW0sIGV2ZW50OiB7IGRibGNsaWNrOiBhZGRJdGVtIH1cXFwiPjwvZGl2PlxcbjwvZGl2PlxcbiAgICAgICAgICAgICAgICA8L2Rpdj5cXG4gICAgICAgICAgICA8L2Rpdj5cXG5cXG4gICAgICAgICAgICA8ZGl2IGNsYXNzPVxcXCJmb3JtLWdyb3VwXFxcIiBkYXRhLWJpbmQ9XFxcInZpc2libGU6IGRpc3BsYXlTaG9wKClcXFwiPlxcbiAgICAgICAgICAgICAgICA8ZGl2IGNsYXNzPVxcXCJpbnB1dC1ncm91cFxcXCI+XFxuICAgICAgICAgICAgICAgICAgICA8aW5wdXQgY2xhc3M9XFxcImZvcm0tY29udHJvbFxcXCIgaWQ9XFxcImF1dG9cXFwiIGRhdGEtYmluZD1cXFwianFBdXRvOiB7IGF1dG9Gb2N1czogdHJ1ZSwgaHRtbDogdHJ1ZSB9LCBqcUF1dG9Tb3VyY2U6IGl0ZW1PcHRpb25zLCBqcUF1dG9WYWx1ZTogc2VsZWN0ZWRJdGVtLCBqcUF1dG9Tb3VyY2VMYWJlbDogJ2Rpc3BsYXluYW1lJywganFBdXRvU291cmNlSW5wdXRWYWx1ZTogJ25hbWUnLCBqcUF1dG9Tb3VyY2VWYWx1ZTogJ3ZhbHVlJ1xcXCIgLz5cXG4gICAgICAgICAgICAgICAgICAgIDxzcGFuIGNsYXNzPVxcXCJpbnB1dC1ncm91cC1idG5cXFwiPlxcbiAgICAgICAgICAgICAgICAgICAgICAgIDxidXR0b24gY2xhc3M9XFxcImJ0biBidG4tZGVmYXVsdFxcXCIgZGF0YS1iaW5kPVxcXCJqcUF1dG9Db21ibzogJ2F1dG8nXFxcIj48c3BhbiBjbGFzcz1cXFwiZ2x5cGhpY29uIGdseXBoaWNvbi1zZWFyY2hcXFwiPjwvc3Bhbj48L2J1dHRvbj5cXG4gICAgICAgICAgICAgICAgICAgIDwvc3Bhbj5cXG4gICAgICAgICAgICAgICAgPC9kaXY+XFxuICAgICAgICAgICAgPC9kaXY+XFxuXFxuICAgICAgICAgICAgPGRpdiBkYXRhLWJpbmQ9XFxcInZpc2libGU6IHNlbGVjdGVkSXRlbSgpICYmIGRpc3BsYXlTaG9wKClcXFwiPlxcbiAgICAgICAgICAgICAgICA8YnV0dG9uIGNsYXNzPVxcXCJidG4gYnRuLWRlZmF1bHQgYnRuLXhzIGdseXBoaWNvbiBnbHlwaGljb24tbWludXMgcHVsbC1yaWdodFxcXCIgZGF0YS1iaW5kPVxcXCJ0b2dnbGU6IGRpc3BsYXlTaG9wSXRlbVRvb2x0aXAsIHZpc2libGU6IGRpc3BsYXlTaG9wSXRlbVRvb2x0aXAoKVxcXCIgdGl0bGU9XFxcIkhpZGUgaXRlbSBkZXNjcmlwdGlvblxcXCI+PC9idXR0b24+XFxuICAgICAgICAgICAgICAgIDxidXR0b24gY2xhc3M9XFxcImJ0biBidG4tZGVmYXVsdCBidG4teHMgZ2x5cGhpY29uIGdseXBoaWNvbi1wbHVzIHB1bGwtcmlnaHRcXFwiIGRhdGEtYmluZD1cXFwidG9nZ2xlOiBkaXNwbGF5U2hvcEl0ZW1Ub29sdGlwLCB2aXNpYmxlOiAhZGlzcGxheVNob3BJdGVtVG9vbHRpcCgpXFxcIiB0aXRsZT1cXFwiU2hvdyBpdGVtIGRlc2NyaXB0aW9uXFxcIj48L2J1dHRvbj5cXG4gICAgICAgICAgICAgICAgPGRpdiBkYXRhLWJpbmQ9XFxcImh0bWw6IGdldEl0ZW1Ub29sdGlwRGF0YSwgY3NzOiB7ICdoaWRlLXNob3AtaXRlbS1kZXRhaWxzJzogIWRpc3BsYXlTaG9wSXRlbVRvb2x0aXAoKSB9XFxcIj48L2Rpdj5cXG4gICAgICAgICAgICAgICAgPGRpdiBzdHlsZT1cXFwibWFyZ2luLXRvcDoxMHB4O21hcmdpbi1ib3R0b206MTBweDtcXFwiIGNsYXNzPVxcXCJmb3JtLWlubGluZVxcXCIgZGF0YS1iaW5kPVxcXCJ2aXNpYmxlOiBnZXRJdGVtSW5wdXRMYWJlbCgpICE9ICcnXFxcIj5cXG4gICAgICAgICAgICAgICAgICAgIDxkaXYgY2xhc3M9XFxcImZvcm0tZ3JvdXBcXFwiPlxcbiAgICAgICAgICAgICAgICAgICAgICAgIDxsYWJlbCBmb3I9XFxcIml0ZW1pbnB1dFxcXCIgZGF0YS1iaW5kPVxcXCJ0ZXh0OiBnZXRJdGVtSW5wdXRMYWJlbFxcXCI+PC9sYWJlbD5cXG4gICAgICAgICAgICAgICAgICAgICAgICA8aW5wdXQgY2xhc3M9XFxcImZvcm0tY29udHJvbFxcXCIgaWQ9XFxcIml0ZW1pbnB1dFxcXCIgZGF0YS1iaW5kPVxcXCJ2YWx1ZTogaXRlbUlucHV0VmFsdWVcXFwiIC8+XFxuICAgICAgICAgICAgICAgICAgICA8L2Rpdj5cXG4gICAgICAgICAgICAgICAgPC9kaXY+XFxuICAgICAgICAgICAgICAgIDxkaXYgY2xhc3M9XFxcImZvcm0tZ3JvdXAgdGV4dC1yaWdodFxcXCI+XFxuICAgICAgICAgICAgICAgICAgICA8YnV0dG9uIGNsYXNzPVxcXCJidG4gYnRuLWRlZmF1bHRcXFwiIGRhdGEtYmluZD1cXFwiY2xpY2s6IGFkZEl0ZW1cXFwiPkFkZCBJdGVtPC9idXR0b24+XFxuICAgICAgICAgICAgICAgIDwvZGl2PlxcbiAgICAgICAgICAgIDwvZGl2PlxcbiAgICAgICAgPC9kaXY+XCJcbn07IiwiJ3VzZSBzdHJpY3QnO1xudmFyIGtvID0gcmVxdWlyZSgnLi9oZXJvY2FsY19rbm9ja291dCcpO1xuICAgIFxudmFyIG15ID0gcmVxdWlyZShcIi4vaGVyb2NhbGNfY29yZVwiKTtcblxubXkucHJvdG90eXBlLkFiaWxpdHlNb2RlbCA9IGZ1bmN0aW9uIChhLCBoKSB7XG4gICAgdmFyIHNlbGYgPSB0aGlzO1xuICAgIHNlbGYuaGVybyA9IGg7XG4gICAgc2VsZi5hYmlsaXR5RGF0YSA9IG15LnByb3RvdHlwZS5hYmlsaXR5RGF0YTtcbiAgICBzZWxmLmhhc1NjZXB0ZXIgPSBrby5vYnNlcnZhYmxlKGZhbHNlKTtcbiAgICBzZWxmLmlzU2hhcGVTaGlmdEFjdGl2ZSA9IGtvLm9ic2VydmFibGUoZmFsc2UpO1xuICAgIHNlbGYuYWJpbGl0aWVzID0gYTtcbiAgICBmb3IgKHZhciBpID0gMDsgaSA8IHNlbGYuYWJpbGl0aWVzKCkubGVuZ3RoOyBpKyspIHtcbiAgICAgICAgc2VsZi5hYmlsaXRpZXMoKVtpXS5sZXZlbCA9IGtvLm9ic2VydmFibGUoMCk7XG4gICAgICAgIHNlbGYuYWJpbGl0aWVzKClbaV0uaXNBY3RpdmUgPSBrby5vYnNlcnZhYmxlKGZhbHNlKTtcbiAgICAgICAgc2VsZi5hYmlsaXRpZXMoKVtpXS5pc0RldGFpbCA9IGtvLm9ic2VydmFibGUoZmFsc2UpO1xuICAgICAgICBzZWxmLmFiaWxpdGllcygpW2ldLmJhc2VEYW1hZ2UgPSBrby5vYnNlcnZhYmxlKDApO1xuICAgICAgICBzZWxmLmFiaWxpdGllcygpW2ldLmJhc2VEYW1hZ2VSZWR1Y3Rpb25QY3QgPSBrby5vYnNlcnZhYmxlKDApO1xuICAgICAgICBzZWxmLmFiaWxpdGllcygpW2ldLmJhc2VEYW1hZ2VNdWx0aXBsaWVyID0ga28ub2JzZXJ2YWJsZSgwKTtcbiAgICAgICAgc2VsZi5hYmlsaXRpZXMoKVtpXS5iYXNoID0ga28ub2JzZXJ2YWJsZSgwKTtcbiAgICAgICAgc2VsZi5hYmlsaXRpZXMoKVtpXS5iYXNoQm9udXNEYW1hZ2UgPSBrby5vYnNlcnZhYmxlKDApO1xuICAgICAgICBzZWxmLmFiaWxpdGllcygpW2ldLmJvbnVzRGFtYWdlID0ga28ub2JzZXJ2YWJsZSgwKTtcbiAgICAgICAgc2VsZi5hYmlsaXRpZXMoKVtpXS5ib251c0RhbWFnZU9yYiA9IGtvLm9ic2VydmFibGUoMCk7XG4gICAgICAgIHNlbGYuYWJpbGl0aWVzKClbaV0uYm9udXNEYW1hZ2VQY3QgPSBrby5vYnNlcnZhYmxlKDApO1xuICAgICAgICBzZWxmLmFiaWxpdGllcygpW2ldLmJvbnVzRGFtYWdlUHJlY2lzaW9uQXVyYSA9IGtvLm9ic2VydmFibGUoMCk7XG4gICAgICAgIHNlbGYuYWJpbGl0aWVzKClbaV0uYm9udXNEYW1hZ2VSZWR1Y3Rpb24gPSBrby5vYnNlcnZhYmxlKDApO1xuICAgICAgICBzZWxmLmFiaWxpdGllcygpW2ldLmJvbnVzSGVhbHRoID0ga28ub2JzZXJ2YWJsZSgwKTtcbiAgICAgICAgc2VsZi5hYmlsaXRpZXMoKVtpXS5ib251c1N0cmVuZ3RoID0ga28ub2JzZXJ2YWJsZSgwKTtcbiAgICAgICAgc2VsZi5hYmlsaXRpZXMoKVtpXS5ib251c1N0cmVuZ3RoMiA9IGtvLm9ic2VydmFibGUoMCk7XG4gICAgICAgIHNlbGYuYWJpbGl0aWVzKClbaV0uYm9udXNBZ2lsaXR5ID0ga28ub2JzZXJ2YWJsZSgwKTtcbiAgICAgICAgc2VsZi5hYmlsaXRpZXMoKVtpXS5ib251c0FnaWxpdHkyID0ga28ub2JzZXJ2YWJsZSgwKTtcbiAgICAgICAgc2VsZi5hYmlsaXRpZXMoKVtpXS5ib251c0ludCA9IGtvLm9ic2VydmFibGUoMCk7XG4gICAgICAgIHNlbGYuYWJpbGl0aWVzKClbaV0uYm9udXNBbGxTdGF0c1JlZHVjdGlvbiA9IGtvLm9ic2VydmFibGUoMCk7XG4gICAgICAgIHNlbGYuYWJpbGl0aWVzKClbaV0uZGFtYWdlQW1wbGlmaWNhdGlvbiA9IGtvLm9ic2VydmFibGUoMCk7XG4gICAgICAgIHNlbGYuYWJpbGl0aWVzKClbaV0uZGFtYWdlUmVkdWN0aW9uID0ga28ub2JzZXJ2YWJsZSgwKTtcbiAgICAgICAgc2VsZi5hYmlsaXRpZXMoKVtpXS5ldmFzaW9uID0ga28ub2JzZXJ2YWJsZSgwKTtcbiAgICAgICAgc2VsZi5hYmlsaXRpZXMoKVtpXS5tYWdpY1Jlc2lzdCA9IGtvLm9ic2VydmFibGUoMCk7XG4gICAgICAgIHNlbGYuYWJpbGl0aWVzKClbaV0ubWFuYXJlZ2VuID0ga28ub2JzZXJ2YWJsZSgwKTtcbiAgICAgICAgc2VsZi5hYmlsaXRpZXMoKVtpXS5tYW5hcmVnZW5yZWR1Y3Rpb24gPSBrby5vYnNlcnZhYmxlKDApO1xuICAgICAgICBzZWxmLmFiaWxpdGllcygpW2ldLm1pc3NDaGFuY2UgPSBrby5vYnNlcnZhYmxlKDApO1xuICAgICAgICBzZWxmLmFiaWxpdGllcygpW2ldLm1vdmVtZW50U3BlZWRGbGF0ID0ga28ub2JzZXJ2YWJsZSgwKTtcbiAgICAgICAgc2VsZi5hYmlsaXRpZXMoKVtpXS5tb3ZlbWVudFNwZWVkUGN0ID0ga28ub2JzZXJ2YWJsZSgwKTtcbiAgICAgICAgc2VsZi5hYmlsaXRpZXMoKVtpXS5tb3ZlbWVudFNwZWVkUGN0UmVkdWN0aW9uID0ga28ub2JzZXJ2YWJsZSgwKTtcbiAgICAgICAgc2VsZi5hYmlsaXRpZXMoKVtpXS50dXJuUmF0ZVJlZHVjdGlvbiA9IGtvLm9ic2VydmFibGUoMCk7XG4gICAgICAgIHNlbGYuYWJpbGl0aWVzKClbaV0uYXR0YWNrcmFuZ2UgPSBrby5vYnNlcnZhYmxlKDApO1xuICAgICAgICBzZWxmLmFiaWxpdGllcygpW2ldLmF0dGFja3NwZWVkID0ga28ub2JzZXJ2YWJsZSgwKTtcbiAgICAgICAgc2VsZi5hYmlsaXRpZXMoKVtpXS5hdHRhY2tzcGVlZHJlZHVjdGlvbiA9IGtvLm9ic2VydmFibGUoMCk7XG4gICAgICAgIHNlbGYuYWJpbGl0aWVzKClbaV0uYXJtb3IgPSBrby5vYnNlcnZhYmxlKDApO1xuICAgICAgICBzZWxmLmFiaWxpdGllcygpW2ldLmFybW9yUmVkdWN0aW9uID0ga28ub2JzZXJ2YWJsZSgwKTtcbiAgICAgICAgc2VsZi5hYmlsaXRpZXMoKVtpXS5oZWFsdGhyZWdlbiA9IGtvLm9ic2VydmFibGUoMCk7XG4gICAgICAgIHNlbGYuYWJpbGl0aWVzKClbaV0ubGlmZXN0ZWFsID0ga28ub2JzZXJ2YWJsZSgwKTtcbiAgICAgICAgc2VsZi5hYmlsaXRpZXMoKVtpXS52aXNpb25uaWdodCA9IGtvLm9ic2VydmFibGUoMCk7XG4gICAgICAgIHNlbGYuYWJpbGl0aWVzKClbaV0udmlzaW9uZGF5ID0ga28ub2JzZXJ2YWJsZSgwKTtcbiAgICB9XG4gICAgc2VsZi5hYmlsaXR5Q29udHJvbERhdGEgPSB7fTtcbiAgICBzZWxmLmFiaWxpdHlTZXR0aW5nc0RhdGEgPSBmdW5jdGlvbiAoZGF0YSwgcGFyZW50LCBpbmRleCkge1xuICAgICAgICBpZiAoc2VsZi5hYmlsaXR5Q29udHJvbERhdGFbZGF0YV0gPT0gdW5kZWZpbmVkKSB7XG4gICAgICAgICAgICByZXR1cm4gc2VsZi5wcm9jZXNzQWJpbGl0eShkYXRhLCBwYXJlbnQsIGluZGV4LCBzZWxmLmFiaWxpdHlEYXRhW2RhdGFdKTtcbiAgICAgICAgfVxuICAgICAgICBlbHNlIHtcbiAgICAgICAgICAgIHJldHVybiBzZWxmLmFiaWxpdHlDb250cm9sRGF0YVtkYXRhXTtcbiAgICAgICAgfVxuICAgIH1cbiAgICBcbiAgICBzZWxmLnByb2Nlc3NBYmlsaXR5ID0gZnVuY3Rpb24gKGRhdGEsIHBhcmVudCwgaW5kZXgsIGFyZ3MpIHtcbiAgICAgICAgdmFyIHJlc3VsdCA9IHt9O1xuICAgICAgICByZXN1bHQuZGF0YSA9IFtdO1xuICAgICAgICB2YXIgdjtcbiAgICAgICAgdmFyIHZfbGlzdCA9IFtdO1xuICAgICAgICBmb3IgKHZhciBpPTA7IGkgPCBhcmdzLmxlbmd0aDsgaSsrKSB7XG4gICAgICAgICAgICBzd2l0Y2ggKGFyZ3NbaV0uY29udHJvbFR5cGUpIHtcbiAgICAgICAgICAgICAgICBjYXNlICdpbnB1dCc6XG4gICAgICAgICAgICAgICAgICAgIHYgPSBrby5vYnNlcnZhYmxlKDApLmV4dGVuZCh7IG51bWVyaWM6IDIgfSk7XG4gICAgICAgICAgICAgICAgICAgIHYuY29udHJvbFZhbHVlVHlwZSA9IGFyZ3NbaV0uY29udHJvbFZhbHVlVHlwZTtcbiAgICAgICAgICAgICAgICAgICAgdl9saXN0LnB1c2godik7XG4gICAgICAgICAgICAgICAgICAgIHJlc3VsdC5kYXRhLnB1c2goeyBsYWJlbE5hbWU6IGFyZ3NbaV0ubGFiZWwudG9VcHBlckNhc2UoKSArICc6JywgY29udHJvbFZhbDogdiwgY29udHJvbFR5cGU6IGFyZ3NbaV0uY29udHJvbFR5cGUsIGRpc3BsYXk6IGFyZ3NbaV0uZGlzcGxheSB9KTtcbiAgICAgICAgICAgICAgICBicmVhaztcbiAgICAgICAgICAgICAgICBjYXNlICdjaGVja2JveCc6XG4gICAgICAgICAgICAgICAgICAgIHYgPSBrby5vYnNlcnZhYmxlKGZhbHNlKTtcbiAgICAgICAgICAgICAgICAgICAgdi5jb250cm9sVmFsdWVUeXBlID0gYXJnc1tpXS5jb250cm9sVmFsdWVUeXBlO1xuICAgICAgICAgICAgICAgICAgICB2X2xpc3QucHVzaCh2KTtcbiAgICAgICAgICAgICAgICAgICAgcmVzdWx0LmRhdGEucHVzaCh7IGxhYmVsTmFtZTogYXJnc1tpXS5sYWJlbC50b1VwcGVyQ2FzZSgpICsgJz8nLCBjb250cm9sVmFsOiB2LCBjb250cm9sVHlwZTogYXJnc1tpXS5jb250cm9sVHlwZSwgZGlzcGxheTogYXJnc1tpXS5kaXNwbGF5IH0pO1xuICAgICAgICAgICAgICAgIGJyZWFrO1xuICAgICAgICAgICAgICAgIGNhc2UgJ3JhZGlvJzpcbiAgICAgICAgICAgICAgICAgICAgdiA9IGtvLm9ic2VydmFibGUoYXJnc1tpXS5jb250cm9sT3B0aW9uc1swXS52YWx1ZSk7XG4gICAgICAgICAgICAgICAgICAgIHYuY29udHJvbFZhbHVlVHlwZSA9IGFyZ3NbaV0uY29udHJvbFZhbHVlVHlwZTtcbiAgICAgICAgICAgICAgICAgICAgdl9saXN0LnB1c2godik7XG4gICAgICAgICAgICAgICAgICAgIHJlc3VsdC5kYXRhLnB1c2goeyBsYWJlbE5hbWU6IGFyZ3NbaV0ubGFiZWwudG9VcHBlckNhc2UoKSArICc/JywgY29udHJvbFZhbDogdiwgY29udHJvbFR5cGU6IGFyZ3NbaV0uY29udHJvbFR5cGUsIGRpc3BsYXk6IGFyZ3NbaV0uZGlzcGxheSwgY29udHJvbE9wdGlvbnM6IGFyZ3NbaV0uY29udHJvbE9wdGlvbnMgfSk7XG4gICAgICAgICAgICAgICAgYnJlYWs7XG4gICAgICAgICAgICAgICAgY2FzZSAnbWV0aG9kJzpcbiAgICAgICAgICAgICAgICBjYXNlICd0ZXh0JzpcbiAgICAgICAgICAgICAgICAgICAgLy8gc2luZ2xlIGlucHV0IGFiaWxpdGllc1xuICAgICAgICAgICAgICAgICAgICBpZiAoYXJnc1tpXS5jb250cm9scyA9PSB1bmRlZmluZWQpIHtcbiAgICAgICAgICAgICAgICAgICAgICAgIGlmIChhcmdzW2ldLm5vTGV2ZWwpIHtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICB2YXIgYXR0cmlidXRlVmFsdWUgPSBmdW5jdGlvbiAoYXR0cmlidXRlTmFtZSkge1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICByZXR1cm4ge2ZuOiBrby5jb21wdXRlZChmdW5jdGlvbiAoKSB7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICB2YXIgX2FiaWxpdHkgPSBzZWxmLmFiaWxpdGllcygpLmZpbmQoZnVuY3Rpb24oYikge1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIHJldHVybiBiLm5hbWUgPT0gZGF0YTtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIH0pO1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgcmV0dXJuIHNlbGYuZ2V0QWJpbGl0eUF0dHJpYnV0ZVZhbHVlKF9hYmlsaXR5LmF0dHJpYnV0ZXMsIGF0dHJpYnV0ZU5hbWUsIDApO1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICB9KX07XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgfTtcbiAgICAgICAgICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgICAgICAgICAgIGVsc2Uge1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgIHZhciBhdHRyaWJ1dGVWYWx1ZSA9IGZ1bmN0aW9uIChhdHRyaWJ1dGVOYW1lKSB7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIHJldHVybiB7Zm46IGtvLmNvbXB1dGVkKGZ1bmN0aW9uICgpIHtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIHZhciBfYWJpbGl0eSA9IHNlbGYuYWJpbGl0aWVzKCkuZmluZChmdW5jdGlvbihiKSB7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgcmV0dXJuIGIubmFtZSA9PSBkYXRhO1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgfSk7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICByZXR1cm4gc2VsZi5nZXRBYmlsaXR5QXR0cmlidXRlVmFsdWUoX2FiaWxpdHkuYXR0cmlidXRlcywgYXR0cmlidXRlTmFtZSwgX2FiaWxpdHkubGV2ZWwoKSk7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIH0pfTtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICB9O1xuICAgICAgICAgICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICAgICAgICAgICAgdmFyIGcgPSBhdHRyaWJ1dGVWYWx1ZShhcmdzW2ldLmF0dHJpYnV0ZU5hbWUpXG4gICAgICAgICAgICAgICAgICAgICAgICB2YXIgciA9IHNlbGYuZ2V0Q29tcHV0ZWRGdW5jdGlvbih2LCBnLmZuLCBhcmdzW2ldLmZuLCBwYXJlbnQsIGluZGV4LCBzZWxmLCBhcmdzW2ldLnJldHVyblByb3BlcnR5LCB1bmRlZmluZWQsIGRhdGEpO1xuICAgICAgICAgICAgICAgICAgICAgICAgaWYgKGFyZ3NbaV0uaWdub3JlVG9vbHRpcCkge1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgIHZhciB0b29sdGlwID0gYXJnc1tpXS5sYWJlbCB8fCBhcmdzW2ldLmF0dHJpYnV0ZU5hbWU7XG4gICAgICAgICAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgICAgICAgICAgICBlbHNlIHtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICB2YXIgdG9vbHRpcCA9IHNlbGYuZ2V0QWJpbGl0eUF0dHJpYnV0ZVRvb2x0aXAoc2VsZi5hYmlsaXRpZXMoKVtpbmRleF0uYXR0cmlidXRlcywgYXJnc1tpXS5hdHRyaWJ1dGVOYW1lKSB8fCBhcmdzW2ldLmxhYmVsIHx8IGFyZ3NbaV0uYXR0cmlidXRlTmFtZTtcbiAgICAgICAgICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgICAgICAgICAgIHJlc3VsdC5kYXRhLnB1c2goeyBsYWJlbE5hbWU6IHRvb2x0aXAudG9VcHBlckNhc2UoKSwgY29udHJvbFZhbDogciwgY29udHJvbFR5cGU6IGFyZ3NbaV0uY29udHJvbFR5cGUsIGRpc3BsYXk6IGFyZ3NbaV0uZGlzcGxheSwgY2xlYW46IGcuZm4gfSk7XG4gICAgICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgICAgICAgLy8gbXVsdGkgaW5wdXQgYWJpbGl0aWVzXG4gICAgICAgICAgICAgICAgICAgIGVsc2Uge1xuICAgICAgICAgICAgICAgICAgICAgICAgaWYgKGFyZ3NbaV0ubm9MZXZlbCkge1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgIHZhciBhdHRyaWJ1dGVWYWx1ZSA9IGZ1bmN0aW9uIChhdHRyaWJ1dGVOYW1lKSB7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIHJldHVybiB7Zm46IGtvLmNvbXB1dGVkKGZ1bmN0aW9uICgpIHtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIHJldHVybiBzZWxmLmdldEFiaWxpdHlBdHRyaWJ1dGVWYWx1ZShzZWxmLmFiaWxpdGllcygpW2luZGV4XS5hdHRyaWJ1dGVzLCBhdHRyaWJ1dGVOYW1lLCAwKTtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgfSl9O1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgIH07XG4gICAgICAgICAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgICAgICAgICAgICBlbHNlIHtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICB2YXIgYXR0cmlidXRlVmFsdWUgPSBmdW5jdGlvbiAoYXR0cmlidXRlTmFtZSkge1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICByZXR1cm4ge2ZuOiBrby5jb21wdXRlZChmdW5jdGlvbiAoKSB7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICByZXR1cm4gc2VsZi5nZXRBYmlsaXR5QXR0cmlidXRlVmFsdWUoc2VsZi5hYmlsaXRpZXMoKVtpbmRleF0uYXR0cmlidXRlcywgYXR0cmlidXRlTmFtZSwgc2VsZi5hYmlsaXRpZXMoKVtpbmRleF0ubGV2ZWwoKSk7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIH0pfTtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICB9O1xuICAgICAgICAgICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICAgICAgICAgICAgdmFyIGcgPSBhdHRyaWJ1dGVWYWx1ZShhcmdzW2ldLmF0dHJpYnV0ZU5hbWUpXG4gICAgICAgICAgICAgICAgICAgICAgICB2YXIgciA9IHNlbGYuZ2V0Q29tcHV0ZWRGdW5jdGlvbih2X2xpc3QsIGcuZm4sIGFyZ3NbaV0uZm4sIHBhcmVudCwgaW5kZXgsIHNlbGYsIGFyZ3NbaV0ucmV0dXJuUHJvcGVydHksIGFyZ3NbaV0uY29udHJvbHMsIGRhdGEpO1xuICAgICAgICAgICAgICAgICAgICAgICAgaWYgKGFyZ3NbaV0uaWdub3JlVG9vbHRpcCkge1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgIHZhciB0b29sdGlwID0gYXJnc1tpXS5sYWJlbCB8fCBhcmdzW2ldLmF0dHJpYnV0ZU5hbWU7XG4gICAgICAgICAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgICAgICAgICAgICBlbHNlIHtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICB2YXIgdG9vbHRpcCA9IHNlbGYuZ2V0QWJpbGl0eUF0dHJpYnV0ZVRvb2x0aXAoc2VsZi5hYmlsaXRpZXMoKVtpbmRleF0uYXR0cmlidXRlcywgYXJnc1tpXS5hdHRyaWJ1dGVOYW1lKSB8fCBhcmdzW2ldLmxhYmVsIHx8IGFyZ3NbaV0uYXR0cmlidXRlTmFtZTtcbiAgICAgICAgICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgICAgICAgICAgIHJlc3VsdC5kYXRhLnB1c2goeyBsYWJlbE5hbWU6IHRvb2x0aXAudG9VcHBlckNhc2UoKSwgY29udHJvbFZhbDogciwgY29udHJvbFR5cGU6IGFyZ3NbaV0uY29udHJvbFR5cGUsIGRpc3BsYXk6IGFyZ3NbaV0uZGlzcGxheSwgY2xlYW46IGcuZm4gfSk7XG4gICAgICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgICAgICAgXG4gICAgICAgICAgICAgICAgICAgIGlmIChhcmdzW2ldLmNvbnRyb2xUeXBlID09ICdtZXRob2QnKSB7XG4gICAgICAgICAgICAgICAgICAgICAgICB2X2xpc3QucHVzaChyKTtcbiAgICAgICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICAgIGJyZWFrO1xuICAgICAgICAgICAgfVxuICAgICAgICB9XG4gICAgICAgIHNlbGYuYWJpbGl0eUNvbnRyb2xEYXRhW2RhdGFdID0gcmVzdWx0O1xuICAgICAgICByZXR1cm4gcmVzdWx0O1xuICAgIH1cblxuICAgIHNlbGYuZ2V0Q29tcHV0ZWRGdW5jdGlvbiA9IGZ1bmN0aW9uICh2LCBhdHRyaWJ1dGVWYWx1ZSwgZm4sIHBhcmVudCwgaW5kZXgsIGFiaWxpdHlNb2RlbCwgcmV0dXJuUHJvcGVydHksIGNvbnRyb2xzLCBhYmlsaXR5TmFtZSkge1xuICAgICAgICB2YXIgX2FiaWxpdHkgPSBhYmlsaXR5TW9kZWwuYWJpbGl0aWVzKCkuZmluZChmdW5jdGlvbihiKSB7XG4gICAgICAgICAgICByZXR1cm4gYi5uYW1lID09IGFiaWxpdHlOYW1lO1xuICAgICAgICB9KTtcbiAgICAgICAgcmV0dXJuIGtvLnB1cmVDb21wdXRlZChmdW5jdGlvbiAoKSB7ICAgICAgICAgICAgICAgIFxuICAgICAgICAgICAgdmFyIGlucHV0VmFsdWU7XG4gICAgICAgICAgICBpZiAoY29udHJvbHMgPT0gdW5kZWZpbmVkKSB7XG4gICAgICAgICAgICAgICAgaWYgKHYgPT0gdW5kZWZpbmVkKSB7XG4gICAgICAgICAgICAgICAgICAgIGlucHV0VmFsdWUgPSB2O1xuICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgICBlbHNlIGlmICh0eXBlb2YgdigpID09ICdib29sZWFuJykge1xuICAgICAgICAgICAgICAgICAgICBpbnB1dFZhbHVlID0gdigpO1xuICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgICBlbHNlIGlmICh2LmNvbnRyb2xWYWx1ZVR5cGUgPT0gdW5kZWZpbmVkKSB7XG4gICAgICAgICAgICAgICAgICAgIGlucHV0VmFsdWUgPSBwYXJzZUZsb2F0KHYoKSk7XG4gICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICAgIGVsc2UgaWYgKHYuY29udHJvbFZhbHVlVHlwZSA9PSAnc3RyaW5nJykge1xuICAgICAgICAgICAgICAgICAgICBpbnB1dFZhbHVlID0gdigpO1xuICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgICBlbHNlIHtcbiAgICAgICAgICAgICAgICAgICAgaW5wdXRWYWx1ZSA9IHBhcnNlRmxvYXQodigpKTtcbiAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICB9XG4gICAgICAgICAgICBlbHNlIHtcbiAgICAgICAgICAgICAgICB2YXIgdl9saXN0ID0gW107XG4gICAgICAgICAgICAgICAgZm9yICh2YXIgaT0wO2k8Y29udHJvbHMubGVuZ3RoO2krKykge1xuICAgICAgICAgICAgICAgICAgICBzd2l0Y2ggKHR5cGVvZiB2W2NvbnRyb2xzW2ldXSgpKSB7XG4gICAgICAgICAgICAgICAgICAgICAgICBjYXNlICdib29sZWFuJzpcbiAgICAgICAgICAgICAgICAgICAgICAgIGNhc2UgJ29iamVjdCc6XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgdl9saXN0LnB1c2godltjb250cm9sc1tpXV0oKSk7XG4gICAgICAgICAgICAgICAgICAgICAgICBicmVhaztcbiAgICAgICAgICAgICAgICAgICAgICAgIGRlZmF1bHQ6XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgdl9saXN0LnB1c2gocGFyc2VGbG9hdCh2W2NvbnRyb2xzW2ldXSgpKSk7XG4gICAgICAgICAgICAgICAgICAgICAgICBicmVhaztcbiAgICAgICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgICBpbnB1dFZhbHVlID0gdl9saXN0O1xuICAgICAgICAgICAgfVxuICAgICAgICAgICAgXG4gICAgICAgICAgICB2YXIgcmV0dXJuVmFsID0gZm4uY2FsbCh0aGlzLCBpbnB1dFZhbHVlLCBhdHRyaWJ1dGVWYWx1ZSgpLCBwYXJlbnQsIGluZGV4LCBhYmlsaXR5TW9kZWwsIF9hYmlsaXR5KTtcbiAgICAgICAgICAgIGlmIChyZXR1cm5Qcm9wZXJ0eSAhPSB1bmRlZmluZWQpIHtcbiAgICAgICAgICAgICAgICBfYWJpbGl0eVtyZXR1cm5Qcm9wZXJ0eV0ocmV0dXJuVmFsKTtcbiAgICAgICAgICAgIH1cbiAgICAgICAgICAgIHJldHVybiByZXR1cm5WYWw7XG4gICAgICAgIH0sIHRoaXMpO1xuICAgIH1cblxuICAgIHNlbGYuZ2V0QWJpbGl0eUF0dHJpYnV0ZVZhbHVlID0gZnVuY3Rpb24gKGF0dHJpYnV0ZXMsIGF0dHJpYnV0ZU5hbWUsIGxldmVsKSB7XG4gICAgICAgIGZvciAodmFyIGk9MDsgaSA8IGF0dHJpYnV0ZXMubGVuZ3RoOyBpKyspIHtcbiAgICAgICAgICAgIGlmIChhdHRyaWJ1dGVzW2ldLm5hbWUgPT0gYXR0cmlidXRlTmFtZSkge1xuICAgICAgICAgICAgICAgIGlmIChsZXZlbCA9PSAwKSB7XG4gICAgICAgICAgICAgICAgICAgIHJldHVybiBwYXJzZUZsb2F0KGF0dHJpYnV0ZXNbaV0udmFsdWVbMF0pO1xuICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgICBlbHNlIGlmIChsZXZlbCA+IGF0dHJpYnV0ZXNbaV0udmFsdWUubGVuZ3RoKSB7XG4gICAgICAgICAgICAgICAgICAgIHJldHVybiBwYXJzZUZsb2F0KGF0dHJpYnV0ZXNbaV0udmFsdWVbMF0pO1xuICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgICBlbHNlIHtcbiAgICAgICAgICAgICAgICAgICAgcmV0dXJuIHBhcnNlRmxvYXQoYXR0cmlidXRlc1tpXS52YWx1ZVtsZXZlbC0xXSk7XG4gICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgfVxuICAgICAgICB9XG4gICAgfVxuXG4gICAgc2VsZi5nZXRBYmlsaXR5QXR0cmlidXRlVG9vbHRpcCA9IGZ1bmN0aW9uIChhdHRyaWJ1dGVzLCBhdHRyaWJ1dGVOYW1lKSB7XG4gICAgICAgIGZvciAodmFyIGk9MDsgaTxhdHRyaWJ1dGVzLmxlbmd0aDsgaSsrKSB7XG4gICAgICAgICAgICBpZiAoYXR0cmlidXRlc1tpXS5uYW1lID09IGF0dHJpYnV0ZU5hbWUpIHtcbiAgICAgICAgICAgICAgICBpZiAoYXR0cmlidXRlc1tpXS5oYXNPd25Qcm9wZXJ0eSgndG9vbHRpcCcpKSB7XG4gICAgICAgICAgICAgICAgICAgIHZhciBkID0gYXR0cmlidXRlc1tpXS50b29sdGlwLnJlcGxhY2UoL1xcXFxuL2csICcnKTtcbiAgICAgICAgICAgICAgICAgICAgcmV0dXJuIGQ7XG4gICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICAgIGVsc2Uge1xuICAgICAgICAgICAgICAgICAgICByZXR1cm4gJyc7XG4gICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgfVxuICAgICAgICB9XG4gICAgICAgIHJldHVybiAnJztcbiAgICB9XG4gICAgXG4gICAgc2VsZi5nZXRBYmlsaXR5TGV2ZWxCeUFiaWxpdHlOYW1lID0gZnVuY3Rpb24gKGFiaWxpdHlOYW1lKSB7XG4gICAgICAgIGZvciAodmFyIGkgPSAwOyBpIDwgc2VsZi5hYmlsaXRpZXMoKS5sZW5ndGg7IGkrKykge1xuICAgICAgICAgICAgaWYgKHNlbGYuYWJpbGl0aWVzKClbaV0ubmFtZSA9PSBhYmlsaXR5TmFtZSkge1xuICAgICAgICAgICAgICAgIHJldHVybiBzZWxmLmFiaWxpdGllcygpW2ldLmxldmVsKCk7XG4gICAgICAgICAgICB9XG4gICAgICAgIH1cbiAgICAgICAgcmV0dXJuIC0xO1xuICAgIH1cblxuICAgIHNlbGYuZ2V0QWJpbGl0eUJ5TmFtZSA9IGZ1bmN0aW9uIChhYmlsaXR5TmFtZSkge1xuICAgICAgICBmb3IgKHZhciBpID0gMDsgaSA8IHNlbGYuYWJpbGl0aWVzKCkubGVuZ3RoOyBpKyspIHtcbiAgICAgICAgICAgIGlmIChzZWxmLmFiaWxpdGllcygpW2ldLm5hbWUgPT0gYWJpbGl0eU5hbWUpIHtcbiAgICAgICAgICAgICAgICByZXR1cm4gc2VsZi5hYmlsaXRpZXMoKVtpXTtcbiAgICAgICAgICAgIH1cbiAgICAgICAgfVxuICAgICAgICByZXR1cm4gdW5kZWZpbmVkO1xuICAgIH1cblxuICAgIHNlbGYuZ2V0QWJpbGl0eVByb3BlcnR5VmFsdWUgPSBmdW5jdGlvbiAoYWJpbGl0eSwgcHJvcGVydHkpIHtcbiAgICAgICAgcmV0dXJuIHBhcnNlRmxvYXQoYWJpbGl0eVtwcm9wZXJ0eV0oKVthYmlsaXR5LmxldmVsKCktMV0pO1xuICAgIH1cbiAgICBcbiAgICBzZWxmLmdldEF0dHJpYnV0ZUJvbnVzTGV2ZWwgPSBmdW5jdGlvbiAoKSB7XG4gICAgICAgIGZvciAodmFyIGkgPSAwOyBpIDwgc2VsZi5hYmlsaXRpZXMoKS5sZW5ndGg7IGkrKykge1xuICAgICAgICAgICAgaWYgKHNlbGYuYWJpbGl0aWVzKClbaV0ubmFtZSA9PSAnYXR0cmlidXRlX2JvbnVzJykge1xuICAgICAgICAgICAgICAgIHJldHVybiBzZWxmLmFiaWxpdGllcygpW2ldLmxldmVsKCk7XG4gICAgICAgICAgICB9XG4gICAgICAgIH1cbiAgICAgICAgcmV0dXJuIDA7ICAgICAgICBcbiAgICB9XG4gICAgXG4gICAgc2VsZi5nZXRBbGxTdGF0c1JlZHVjdGlvbiA9IGtvLmNvbXB1dGVkKGZ1bmN0aW9uICgpIHtcbiAgICAgICAgdmFyIHRvdGFsQXR0cmlidXRlID0gMDtcbiAgICAgICAgZm9yICh2YXIgaSA9IDA7IGkgPCBzZWxmLmFiaWxpdGllcygpLmxlbmd0aDsgaSsrKSB7XG4gICAgICAgICAgICB2YXIgYWJpbGl0eSA9IHNlbGYuYWJpbGl0aWVzKClbaV07XG4gICAgICAgICAgICBpZiAoIShhYmlsaXR5Lm5hbWUgaW4gc2VsZi5hYmlsaXR5RGF0YSkpIHtcbiAgICAgICAgICAgICAgICBpZiAoYWJpbGl0eS5sZXZlbCgpID4gMCAmJiAoYWJpbGl0eS5pc0FjdGl2ZSgpIHx8IChhYmlsaXR5LmJlaGF2aW9yLmluZGV4T2YoJ0RPVEFfQUJJTElUWV9CRUhBVklPUl9QQVNTSVZFJykgIT0gLTEpKSkge1xuICAgICAgICAgICAgICAgICAgICBmb3IgKHZhciBqID0gMDsgaiA8IHNlbGYuYWJpbGl0aWVzKClbaV0uYXR0cmlidXRlcy5sZW5ndGg7IGorKykge1xuICAgICAgICAgICAgICAgICAgICAgICAgdmFyIGF0dHJpYnV0ZSA9IHNlbGYuYWJpbGl0aWVzKClbaV0uYXR0cmlidXRlc1tqXTtcbiAgICAgICAgICAgICAgICAgICAgICAgIC8qc3dpdGNoKGF0dHJpYnV0ZS5uYW1lKSB7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgLy8gaW52b2tlcl9xdWFzXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgY2FzZSAnYm9udXNfc3RyZW5ndGgnOlxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICB0b3RhbEF0dHJpYnV0ZSArPSBwYXJzZUludChhdHRyaWJ1dGUudmFsdWVbYWJpbGl0eS5sZXZlbCgpLTFdKTtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICBicmVhaztcbiAgICAgICAgICAgICAgICAgICAgICAgIH0qL1xuICAgICAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgfVxuICAgICAgICAgICAgZWxzZSBpZiAoYWJpbGl0eS5ib251c0FsbFN0YXRzUmVkdWN0aW9uICE9IHVuZGVmaW5lZCkge1xuICAgICAgICAgICAgICAgIGlmIChhYmlsaXR5LmxldmVsKCkgPiAwICYmIChhYmlsaXR5LmlzQWN0aXZlKCkgfHwgKGFiaWxpdHkuYmVoYXZpb3IuaW5kZXhPZignRE9UQV9BQklMSVRZX0JFSEFWSU9SX1BBU1NJVkUnKSAhPSAtMSkpKSB7XG4gICAgICAgICAgICAgICAgICAgIC8vIHNsYXJrX2Vzc2VuY2Vfc2hpZnRcbiAgICAgICAgICAgICAgICAgICAgdG90YWxBdHRyaWJ1dGUrPWFiaWxpdHkuYm9udXNBbGxTdGF0c1JlZHVjdGlvbigpO1xuICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgIH1cbiAgICAgICAgfVxuICAgICAgICByZXR1cm4gdG90YWxBdHRyaWJ1dGU7XG4gICAgfSk7XG4gICAgXG4gICAgc2VsZi5nZXRTdHJlbmd0aFJlZHVjdGlvbiA9IGtvLmNvbXB1dGVkKGZ1bmN0aW9uICgpIHtcbiAgICAgICAgdmFyIHRvdGFsQXR0cmlidXRlID0gMDtcbiAgICAgICAgZm9yICh2YXIgaSA9IDA7IGkgPCBzZWxmLmFiaWxpdGllcygpLmxlbmd0aDsgaSsrKSB7XG4gICAgICAgICAgICB2YXIgYWJpbGl0eSA9IHNlbGYuYWJpbGl0aWVzKClbaV07XG4gICAgICAgICAgICBpZiAoIShhYmlsaXR5Lm5hbWUgaW4gc2VsZi5hYmlsaXR5RGF0YSkpIHtcbiAgICAgICAgICAgICAgICBpZiAoYWJpbGl0eS5sZXZlbCgpID4gMCAmJiAoYWJpbGl0eS5pc0FjdGl2ZSgpIHx8IChhYmlsaXR5LmJlaGF2aW9yLmluZGV4T2YoJ0RPVEFfQUJJTElUWV9CRUhBVklPUl9QQVNTSVZFJykgIT0gLTEpKSkge1xuICAgICAgICAgICAgICAgICAgICBmb3IgKHZhciBqID0gMDsgaiA8IHNlbGYuYWJpbGl0aWVzKClbaV0uYXR0cmlidXRlcy5sZW5ndGg7IGorKykge1xuICAgICAgICAgICAgICAgICAgICAgICAgdmFyIGF0dHJpYnV0ZSA9IHNlbGYuYWJpbGl0aWVzKClbaV0uYXR0cmlidXRlc1tqXTtcbiAgICAgICAgICAgICAgICAgICAgICAgIC8qc3dpdGNoKGF0dHJpYnV0ZS5uYW1lKSB7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgLy8gaW52b2tlcl9xdWFzXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgY2FzZSAnYm9udXNfc3RyZW5ndGgnOlxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICB0b3RhbEF0dHJpYnV0ZSArPSBwYXJzZUludChhdHRyaWJ1dGUudmFsdWVbYWJpbGl0eS5sZXZlbCgpLTFdKTtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICBicmVhaztcbiAgICAgICAgICAgICAgICAgICAgICAgIH0qL1xuICAgICAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgfVxuICAgICAgICAgICAgZWxzZSBpZiAoYWJpbGl0eS5ib251c1N0cmVuZ3RoICE9IHVuZGVmaW5lZCAmJiBhYmlsaXR5Lm5hbWUgPT0gJ3VuZHlpbmdfZGVjYXknKSB7XG4gICAgICAgICAgICAgICAgaWYgKGFiaWxpdHkubGV2ZWwoKSA+IDAgJiYgKGFiaWxpdHkuaXNBY3RpdmUoKSB8fCAoYWJpbGl0eS5iZWhhdmlvci5pbmRleE9mKCdET1RBX0FCSUxJVFlfQkVIQVZJT1JfUEFTU0lWRScpICE9IC0xKSkpIHtcbiAgICAgICAgICAgICAgICAgICAgLy8gdW5keWluZ19kZWNheVxuICAgICAgICAgICAgICAgICAgICB0b3RhbEF0dHJpYnV0ZS09YWJpbGl0eS5ib251c1N0cmVuZ3RoKCk7XG4gICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgfVxuICAgICAgICB9XG4gICAgICAgIHJldHVybiB0b3RhbEF0dHJpYnV0ZTtcbiAgICB9KTtcbiAgICBcbiAgICBzZWxmLmdldFN0cmVuZ3RoID0ga28uY29tcHV0ZWQoZnVuY3Rpb24gKCkge1xuICAgICAgICB2YXIgdG90YWxBdHRyaWJ1dGUgPSAwO1xuICAgICAgICBmb3IgKHZhciBpID0gMDsgaSA8IHNlbGYuYWJpbGl0aWVzKCkubGVuZ3RoOyBpKyspIHtcbiAgICAgICAgICAgIHZhciBhYmlsaXR5ID0gc2VsZi5hYmlsaXRpZXMoKVtpXTtcbiAgICAgICAgICAgIGlmICghKGFiaWxpdHkubmFtZSBpbiBzZWxmLmFiaWxpdHlEYXRhKSkge1xuICAgICAgICAgICAgICAgIGlmIChhYmlsaXR5LmxldmVsKCkgPiAwICYmIChhYmlsaXR5LmlzQWN0aXZlKCkgfHwgKGFiaWxpdHkuYmVoYXZpb3IuaW5kZXhPZignRE9UQV9BQklMSVRZX0JFSEFWSU9SX1BBU1NJVkUnKSAhPSAtMSkpKSB7XG4gICAgICAgICAgICAgICAgICAgIGZvciAodmFyIGogPSAwOyBqIDwgc2VsZi5hYmlsaXRpZXMoKVtpXS5hdHRyaWJ1dGVzLmxlbmd0aDsgaisrKSB7XG4gICAgICAgICAgICAgICAgICAgICAgICB2YXIgYXR0cmlidXRlID0gc2VsZi5hYmlsaXRpZXMoKVtpXS5hdHRyaWJ1dGVzW2pdO1xuICAgICAgICAgICAgICAgICAgICAgICAgLypzd2l0Y2goYXR0cmlidXRlLm5hbWUpIHtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAvLyBpbnZva2VyX3F1YXNcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICBjYXNlICdib251c19zdHJlbmd0aCc6XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIHRvdGFsQXR0cmlidXRlICs9IHBhcnNlSW50KGF0dHJpYnV0ZS52YWx1ZVthYmlsaXR5LmxldmVsKCktMV0pO1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgIGJyZWFrO1xuICAgICAgICAgICAgICAgICAgICAgICAgfSovXG4gICAgICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICB9XG4gICAgICAgICAgICBlbHNlIHtcbiAgICAgICAgICAgICAgICBpZiAoYWJpbGl0eS5ib251c1N0cmVuZ3RoICE9IHVuZGVmaW5lZCkge1xuICAgICAgICAgICAgICAgICAgICBpZiAoYWJpbGl0eS5sZXZlbCgpID4gMCAmJiAoYWJpbGl0eS5pc0FjdGl2ZSgpIHx8IChhYmlsaXR5LmJlaGF2aW9yLmluZGV4T2YoJ0RPVEFfQUJJTElUWV9CRUhBVklPUl9QQVNTSVZFJykgIT0gLTEpIHx8IGFiaWxpdHkubmFtZSA9PSAnaW52b2tlcl9xdWFzJykpIHtcbiAgICAgICAgICAgICAgICAgICAgICAgIC8vIHB1ZGdlX2ZsZXNoX2hlYXAsaW52b2tlcl9xdWFzLG1vcnBobGluZ19tb3JwaF9zdHIsbW9ycGhsaW5nX21vcnBoX2FnaSx1bmR5aW5nX2RlY2F5XG4gICAgICAgICAgICAgICAgICAgICAgICB0b3RhbEF0dHJpYnV0ZSs9YWJpbGl0eS5ib251c1N0cmVuZ3RoKCk7XG4gICAgICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgICAgaWYgKGFiaWxpdHkuYm9udXNTdHJlbmd0aDIgIT0gdW5kZWZpbmVkKSB7XG4gICAgICAgICAgICAgICAgICAgIGlmIChhYmlsaXR5LmxldmVsKCkgPiAwICYmIChhYmlsaXR5LmlzQWN0aXZlKCkgfHwgKGFiaWxpdHkuYmVoYXZpb3IuaW5kZXhPZignRE9UQV9BQklMSVRZX0JFSEFWSU9SX1BBU1NJVkUnKSAhPSAtMSkpKSB7XG4gICAgICAgICAgICAgICAgICAgICAgICAvLyBtb3JwaGxpbmdfbW9ycGhfc3RyXG4gICAgICAgICAgICAgICAgICAgICAgICB0b3RhbEF0dHJpYnV0ZSs9YWJpbGl0eS5ib251c1N0cmVuZ3RoMigpO1xuICAgICAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgfVxuICAgICAgICB9XG4gICAgICAgIHJldHVybiB0b3RhbEF0dHJpYnV0ZTtcbiAgICB9KTtcbiAgICBcbiAgICBzZWxmLmdldEFnaWxpdHkgPSBrby5jb21wdXRlZChmdW5jdGlvbiAoKSB7XG4gICAgICAgIHZhciB0b3RhbEF0dHJpYnV0ZSA9IDA7XG4gICAgICAgIGZvciAodmFyIGkgPSAwOyBpIDwgc2VsZi5hYmlsaXRpZXMoKS5sZW5ndGg7IGkrKykge1xuICAgICAgICAgICAgdmFyIGFiaWxpdHkgPSBzZWxmLmFiaWxpdGllcygpW2ldO1xuICAgICAgICAgICAgaWYgKCEoYWJpbGl0eS5uYW1lIGluIHNlbGYuYWJpbGl0eURhdGEpKSB7XG4gICAgICAgICAgICAgICAgaWYgKGFiaWxpdHkubGV2ZWwoKSA+IDAgJiYgKGFiaWxpdHkuaXNBY3RpdmUoKSB8fCAoYWJpbGl0eS5iZWhhdmlvci5pbmRleE9mKCdET1RBX0FCSUxJVFlfQkVIQVZJT1JfUEFTU0lWRScpICE9IC0xKSkpIHtcbiAgICAgICAgICAgICAgICAgICAgZm9yICh2YXIgaiA9IDA7IGogPCBzZWxmLmFiaWxpdGllcygpW2ldLmF0dHJpYnV0ZXMubGVuZ3RoOyBqKyspIHtcbiAgICAgICAgICAgICAgICAgICAgICAgIHZhciBhdHRyaWJ1dGUgPSBzZWxmLmFiaWxpdGllcygpW2ldLmF0dHJpYnV0ZXNbal07XG4gICAgICAgICAgICAgICAgICAgICAgICBzd2l0Y2goYXR0cmlidXRlLm5hbWUpIHtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAvLyBkcm93X3Jhbmdlcl9tYXJrc21hbnNoaXBcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICBjYXNlICdtYXJrc21hbnNoaXBfYWdpbGl0eV9ib251cyc6XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIHRvdGFsQXR0cmlidXRlICs9IHNlbGYuZ2V0QWJpbGl0eUF0dHJpYnV0ZVZhbHVlKHNlbGYuYWJpbGl0aWVzKClbaV0uYXR0cmlidXRlcywgYXR0cmlidXRlLm5hbWUsIGFiaWxpdHkubGV2ZWwoKSk7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgYnJlYWs7XG4gICAgICAgICAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICB9XG4gICAgICAgICAgICBlbHNlIHtcbiAgICAgICAgICAgICAgICBpZiAoYWJpbGl0eS5ib251c0FnaWxpdHkgIT0gdW5kZWZpbmVkKSB7XG4gICAgICAgICAgICAgICAgICAgIGlmIChhYmlsaXR5LmxldmVsKCkgPiAwICYmIChhYmlsaXR5LmlzQWN0aXZlKCkgfHwgKGFiaWxpdHkuYmVoYXZpb3IuaW5kZXhPZignRE9UQV9BQklMSVRZX0JFSEFWSU9SX1BBU1NJVkUnKSAhPSAtMSkgfHwgYWJpbGl0eS5uYW1lID09ICdpbnZva2VyX3dleCcpKSB7XG4gICAgICAgICAgICAgICAgICAgICAgICAvLyBpbnZva2VyX3dleCxtb3JwaGxpbmdfbW9ycGhfYWdpLG1vcnBobGluZ19tb3JwaF9zdHJcbiAgICAgICAgICAgICAgICAgICAgICAgIHRvdGFsQXR0cmlidXRlKz1hYmlsaXR5LmJvbnVzQWdpbGl0eSgpO1xuICAgICAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICAgIGlmIChhYmlsaXR5LmJvbnVzQWdpbGl0eTIgIT0gdW5kZWZpbmVkKSB7XG4gICAgICAgICAgICAgICAgICAgIGlmIChhYmlsaXR5LmxldmVsKCkgPiAwICYmIChhYmlsaXR5LmlzQWN0aXZlKCkgfHwgKGFiaWxpdHkuYmVoYXZpb3IuaW5kZXhPZignRE9UQV9BQklMSVRZX0JFSEFWSU9SX1BBU1NJVkUnKSAhPSAtMSkpKSB7XG4gICAgICAgICAgICAgICAgICAgICAgICAvLyBpbnZva2VyX3dleCxtb3JwaGxpbmdfbW9ycGhfYWdpLG1vcnBobGluZ19tb3JwaF9zdHJcbiAgICAgICAgICAgICAgICAgICAgICAgIHRvdGFsQXR0cmlidXRlKz1hYmlsaXR5LmJvbnVzQWdpbGl0eTIoKTtcbiAgICAgICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgIH1cbiAgICAgICAgfVxuICAgICAgICByZXR1cm4gdG90YWxBdHRyaWJ1dGU7XG4gICAgfSk7XG5cbiAgICBzZWxmLmdldEludGVsbGlnZW5jZSA9IGtvLmNvbXB1dGVkKGZ1bmN0aW9uICgpIHtcbiAgICAgICAgdmFyIHRvdGFsQXR0cmlidXRlID0gMDtcbiAgICAgICAgZm9yICh2YXIgaSA9IDA7IGkgPCBzZWxmLmFiaWxpdGllcygpLmxlbmd0aDsgaSsrKSB7XG4gICAgICAgICAgICB2YXIgYWJpbGl0eSA9IHNlbGYuYWJpbGl0aWVzKClbaV07XG4gICAgICAgICAgICBpZiAoIShhYmlsaXR5Lm5hbWUgaW4gc2VsZi5hYmlsaXR5RGF0YSkpIHtcbiAgICAgICAgICAgICAgICBpZiAoYWJpbGl0eS5sZXZlbCgpID4gMCAmJiAoYWJpbGl0eS5pc0FjdGl2ZSgpIHx8IChhYmlsaXR5LmJlaGF2aW9yLmluZGV4T2YoJ0RPVEFfQUJJTElUWV9CRUhBVklPUl9QQVNTSVZFJykgIT0gLTEpKSkge1xuICAgICAgICAgICAgICAgICAgICBmb3IgKHZhciBqID0gMDsgaiA8IHNlbGYuYWJpbGl0aWVzKClbaV0uYXR0cmlidXRlcy5sZW5ndGg7IGorKykge1xuICAgICAgICAgICAgICAgICAgICAgICAgdmFyIGF0dHJpYnV0ZSA9IHNlbGYuYWJpbGl0aWVzKClbaV0uYXR0cmlidXRlc1tqXTtcbiAgICAgICAgICAgICAgICAgICAgICAgIHN3aXRjaChhdHRyaWJ1dGUubmFtZSkge1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgIC8vIGludm9rZXJfZXhvcnRcbiAgICAgICAgICAgICAgICAgICAgICAgIC8qICAgIGNhc2UgJ2JvbnVzX2ludGVsbGlnZW5jZSc6XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIHRvdGFsQXR0cmlidXRlICs9IHNlbGYuZ2V0QWJpbGl0eUF0dHJpYnV0ZVZhbHVlKHNlbGYuYWJpbGl0aWVzKClbaV0uYXR0cmlidXRlcywgYXR0cmlidXRlLm5hbWUsIGFiaWxpdHkubGV2ZWwoKSk7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgYnJlYWs7Ki9cbiAgICAgICAgICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgIH1cbiAgICAgICAgICAgIGVsc2UgaWYgKGFiaWxpdHkuYm9udXNJbnQgIT0gdW5kZWZpbmVkKSB7XG4gICAgICAgICAgICAgICAgaWYgKGFiaWxpdHkubGV2ZWwoKSA+IDAgJiYgKGFiaWxpdHkuaXNBY3RpdmUoKSB8fCAoYWJpbGl0eS5iZWhhdmlvci5pbmRleE9mKCdET1RBX0FCSUxJVFlfQkVIQVZJT1JfUEFTU0lWRScpICE9IC0xKSB8fCBhYmlsaXR5Lm5hbWUgPT0gJ2ludm9rZXJfZXhvcnQnKSkge1xuICAgICAgICAgICAgICAgICAgICAvLyBpbnZva2VyX2V4b3J0XG4gICAgICAgICAgICAgICAgICAgIHRvdGFsQXR0cmlidXRlKz1hYmlsaXR5LmJvbnVzSW50KCk7XG4gICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgfVxuICAgICAgICB9XG4gICAgICAgIHJldHVybiB0b3RhbEF0dHJpYnV0ZTtcbiAgICB9KTtcbiAgICBcbiAgICBzZWxmLmdldEFybW9yID0ga28uY29tcHV0ZWQoZnVuY3Rpb24gKCkge1xuICAgICAgICB2YXIgdG90YWxBdHRyaWJ1dGUgPSAwO1xuICAgICAgICBmb3IgKHZhciBpID0gMDsgaSA8IHNlbGYuYWJpbGl0aWVzKCkubGVuZ3RoOyBpKyspIHtcbiAgICAgICAgICAgIHZhciBhYmlsaXR5ID0gc2VsZi5hYmlsaXRpZXMoKVtpXTtcbiAgICAgICAgICAgIGlmICghKGFiaWxpdHkubmFtZSBpbiBzZWxmLmFiaWxpdHlEYXRhKSkge1xuICAgICAgICAgICAgICAgIGlmIChhYmlsaXR5LmxldmVsKCkgPiAwICYmIChhYmlsaXR5LmlzQWN0aXZlKCkgfHwgKGFiaWxpdHkuYmVoYXZpb3IuaW5kZXhPZignRE9UQV9BQklMSVRZX0JFSEFWSU9SX1BBU1NJVkUnKSAhPSAtMSkpKSB7XG4gICAgICAgICAgICAgICAgICAgIGZvciAodmFyIGogPSAwOyBqIDwgc2VsZi5hYmlsaXRpZXMoKVtpXS5hdHRyaWJ1dGVzLmxlbmd0aDsgaisrKSB7XG4gICAgICAgICAgICAgICAgICAgICAgICB2YXIgYXR0cmlidXRlID0gc2VsZi5hYmlsaXRpZXMoKVtpXS5hdHRyaWJ1dGVzW2pdO1xuICAgICAgICAgICAgICAgICAgICAgICAgc3dpdGNoKGF0dHJpYnV0ZS5uYW1lKSB7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgLy8gYXhlX2JlcnNlcmtlcnNfY2FsbCxkcmFnb25fa25pZ2h0X2RyYWdvbl9ibG9vZCx0cm9sbF93YXJsb3JkX2JlcnNlcmtlcnNfcmFnZSxseWNhbl9zaGFwZXNoaWZ0LGVucmFnZWRfd2lsZGtpbl90b3VnaG5lc3NfYXVyYVxuICAgICAgICAgICAgICAgICAgICAgICAgICAgIGNhc2UgJ2JvbnVzX2FybW9yJzpcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgaWYgKGFiaWxpdHkubmFtZSAhPSAndGVtcGxhcl9hc3Nhc3Npbl9tZWxkJykge1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgdG90YWxBdHRyaWJ1dGUgKz0gc2VsZi5nZXRBYmlsaXR5QXR0cmlidXRlVmFsdWUoc2VsZi5hYmlsaXRpZXMoKVtpXS5hdHRyaWJ1dGVzLCBhdHRyaWJ1dGUubmFtZSwgYWJpbGl0eS5sZXZlbCgpKTtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICAgICAgICAgICAgICAgIGJyZWFrO1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgIC8vIHN2ZW5fd2FyY3J5XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgY2FzZSAnd2FyY3J5X2FybW9yJzpcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgdG90YWxBdHRyaWJ1dGUgKz0gc2VsZi5nZXRBYmlsaXR5QXR0cmlidXRlVmFsdWUoc2VsZi5hYmlsaXRpZXMoKVtpXS5hdHRyaWJ1dGVzLCBhdHRyaWJ1dGUubmFtZSwgYWJpbGl0eS5sZXZlbCgpKTtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICBicmVhaztcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAvLyBsaWNoX2Zyb3N0X2FybW9yLG9ncmVfbWFnaV9mcm9zdF9hcm1vclxuICAgICAgICAgICAgICAgICAgICAgICAgICAgIGNhc2UgJ2FybW9yX2JvbnVzJzpcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgaWYgKGFiaWxpdHkubmFtZSA9PSAnbGljaF9mcm9zdF9hcm1vcicgfHwgYWJpbGl0eS5uYW1lID09ICdvZ3JlX21hZ2lfZnJvc3RfYXJtb3InKSB7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICB0b3RhbEF0dHJpYnV0ZSArPSBzZWxmLmdldEFiaWxpdHlBdHRyaWJ1dGVWYWx1ZShzZWxmLmFiaWxpdGllcygpW2ldLmF0dHJpYnV0ZXMsIGF0dHJpYnV0ZS5uYW1lLCBhYmlsaXR5LmxldmVsKCkpO1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgYnJlYWs7XG4gICAgICAgICAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICB9XG4gICAgICAgICAgICBlbHNlIGlmIChhYmlsaXR5LmFybW9yICE9IHVuZGVmaW5lZCkge1xuICAgICAgICAgICAgICAgIGlmIChhYmlsaXR5LmxldmVsKCkgPiAwICYmIChhYmlsaXR5LmlzQWN0aXZlKCkgfHwgKGFiaWxpdHkuYmVoYXZpb3IuaW5kZXhPZignRE9UQV9BQklMSVRZX0JFSEFWSU9SX1BBU1NJVkUnKSAhPSAtMSkpKSB7XG4gICAgICAgICAgICAgICAgICAgIC8vIHNocmVkZGVyX3JlYWN0aXZlX2FybW9yLHZpc2FnZV9ncmF2ZWtlZXBlcnNfY2xvYWtcbiAgICAgICAgICAgICAgICAgICAgdG90YWxBdHRyaWJ1dGUrPWFiaWxpdHkuYXJtb3IoKTtcbiAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICB9XG4gICAgICAgIH1cbiAgICAgICAgcmV0dXJuIHRvdGFsQXR0cmlidXRlO1xuICAgIH0pO1xuXG4gICAgc2VsZi5nZXRBcm1vckJhc2VSZWR1Y3Rpb24gPSBrby5jb21wdXRlZChmdW5jdGlvbiAoKSB7XG4gICAgICAgIHZhciB0b3RhbEF0dHJpYnV0ZSA9IDE7XG4gICAgICAgIGZvciAodmFyIGkgPSAwOyBpIDwgc2VsZi5hYmlsaXRpZXMoKS5sZW5ndGg7IGkrKykge1xuICAgICAgICAgICAgdmFyIGFiaWxpdHkgPSBzZWxmLmFiaWxpdGllcygpW2ldO1xuICAgICAgICAgICAgaWYgKCEoYWJpbGl0eS5uYW1lIGluIHNlbGYuYWJpbGl0eURhdGEpKSB7XG4gICAgICAgICAgICAgICAgaWYgKGFiaWxpdHkubGV2ZWwoKSA+IDAgJiYgKGFiaWxpdHkuaXNBY3RpdmUoKSB8fCAoYWJpbGl0eS5iZWhhdmlvci5pbmRleE9mKCdET1RBX0FCSUxJVFlfQkVIQVZJT1JfUEFTU0lWRScpICE9IC0xKSkpIHtcbiAgICAgICAgICAgICAgICAgICAgc3dpdGNoKGFiaWxpdHkubmFtZSkge1xuICAgICAgICAgICAgICAgICAgICAgICAgLy9lbGRlcl90aXRhbl9uYXR1cmFsX29yZGVyXG4gICAgICAgICAgICAgICAgICAgICAgICBjYXNlICdlbGRlcl90aXRhbl9uYXR1cmFsX29yZGVyJzpcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICB0b3RhbEF0dHJpYnV0ZSAqPSAoMS1zZWxmLmdldEFiaWxpdHlBdHRyaWJ1dGVWYWx1ZShzZWxmLmFiaWxpdGllcygpW2ldLmF0dHJpYnV0ZXMsICdhcm1vcl9yZWR1Y3Rpb25fcGN0JywgYWJpbGl0eS5sZXZlbCgpKS8xMDApO1xuICAgICAgICAgICAgICAgICAgICAgICAgYnJlYWs7XG4gICAgICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICB9XG4gICAgICAgIH1cbiAgICAgICAgcmV0dXJuIHRvdGFsQXR0cmlidXRlO1xuICAgIH0pO1xuICAgIFxuICAgIHNlbGYuZ2V0QXJtb3JSZWR1Y3Rpb24gPSBrby5jb21wdXRlZChmdW5jdGlvbiAoKSB7XG4gICAgICAgIHZhciB0b3RhbEF0dHJpYnV0ZSA9IDA7XG4gICAgICAgIGZvciAodmFyIGkgPSAwOyBpIDwgc2VsZi5hYmlsaXRpZXMoKS5sZW5ndGg7IGkrKykge1xuICAgICAgICAgICAgdmFyIGFiaWxpdHkgPSBzZWxmLmFiaWxpdGllcygpW2ldO1xuICAgICAgICAgICAgaWYgKCEoYWJpbGl0eS5uYW1lIGluIHNlbGYuYWJpbGl0eURhdGEpKSB7XG4gICAgICAgICAgICAgICAgaWYgKGFiaWxpdHkubGV2ZWwoKSA+IDAgJiYgKGFiaWxpdHkuaXNBY3RpdmUoKSB8fCAoYWJpbGl0eS5iZWhhdmlvci5pbmRleE9mKCdET1RBX0FCSUxJVFlfQkVIQVZJT1JfUEFTU0lWRScpICE9IC0xKSkpIHtcbiAgICAgICAgICAgICAgICAgICAgc3dpdGNoKGFiaWxpdHkubmFtZSkge1xuICAgICAgICAgICAgICAgICAgICAgICAgLy90ZW1wbGFyX2Fzc2Fzc2luX21lbGRcbiAgICAgICAgICAgICAgICAgICAgICAgIGNhc2UgJ3RlbXBsYXJfYXNzYXNzaW5fbWVsZCc6XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgdG90YWxBdHRyaWJ1dGUgKz0gc2VsZi5nZXRBYmlsaXR5QXR0cmlidXRlVmFsdWUoc2VsZi5hYmlsaXRpZXMoKVtpXS5hdHRyaWJ1dGVzLCAnYm9udXNfYXJtb3InLCBhYmlsaXR5LmxldmVsKCkpO1xuICAgICAgICAgICAgICAgICAgICAgICAgYnJlYWs7XG4gICAgICAgICAgICAgICAgICAgICAgICAvLyB0aWRlaHVudGVyX2d1c2hcbiAgICAgICAgICAgICAgICAgICAgICAgIGNhc2UgJ3RpZGVodW50ZXJfZ3VzaCc6XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgdG90YWxBdHRyaWJ1dGUgKz0gc2VsZi5nZXRBYmlsaXR5QXR0cmlidXRlVmFsdWUoc2VsZi5hYmlsaXRpZXMoKVtpXS5hdHRyaWJ1dGVzLCAnYXJtb3JfYm9udXMnLCBhYmlsaXR5LmxldmVsKCkpO1xuICAgICAgICAgICAgICAgICAgICAgICAgYnJlYWs7XG4gICAgICAgICAgICAgICAgICAgICAgICAvLyBuYWdhX3NpcmVuX3JpcF90aWRlXG4gICAgICAgICAgICAgICAgICAgICAgICBjYXNlICduYWdhX3NpcmVuX3JpcF90aWRlJzpcbiAgICAgICAgICAgICAgICAgICAgICAgIC8vIHNsYXJkYXJfYW1wbGlmeV9kYW1hZ2VcbiAgICAgICAgICAgICAgICAgICAgICAgIGNhc2UgJ3NsYXJkYXJfYW1wbGlmeV9kYW1hZ2UnOlxuICAgICAgICAgICAgICAgICAgICAgICAgLy8gdmVuZ2VmdWxzcGlyaXRfd2F2ZV9vZl90ZXJyb3JcbiAgICAgICAgICAgICAgICAgICAgICAgIGNhc2UgJ3ZlbmdlZnVsc3Bpcml0X3dhdmVfb2ZfdGVycm9yJzpcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICB0b3RhbEF0dHJpYnV0ZSArPSBzZWxmLmdldEFiaWxpdHlBdHRyaWJ1dGVWYWx1ZShzZWxmLmFiaWxpdGllcygpW2ldLmF0dHJpYnV0ZXMsICdhcm1vcl9yZWR1Y3Rpb24nLCBhYmlsaXR5LmxldmVsKCkpO1xuICAgICAgICAgICAgICAgICAgICAgICAgYnJlYWs7XG4gICAgICAgICAgICAgICAgICAgICAgICAvLyBuZXZlcm1vcmVfZGFya19sb3JkXG4gICAgICAgICAgICAgICAgICAgICAgICBjYXNlICduZXZlcm1vcmVfZGFya19sb3JkJzpcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICB0b3RhbEF0dHJpYnV0ZSArPSBzZWxmLmdldEFiaWxpdHlBdHRyaWJ1dGVWYWx1ZShzZWxmLmFiaWxpdGllcygpW2ldLmF0dHJpYnV0ZXMsICdwcmVzZW5jZV9hcm1vcl9yZWR1Y3Rpb24nLCBhYmlsaXR5LmxldmVsKCkpO1xuICAgICAgICAgICAgICAgICAgICAgICAgYnJlYWs7XG4gICAgICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICB9XG4gICAgICAgICAgICBlbHNlIGlmIChhYmlsaXR5LmFybW9yUmVkdWN0aW9uICE9IHVuZGVmaW5lZCkge1xuICAgICAgICAgICAgICAgIGlmIChhYmlsaXR5LmxldmVsKCkgPiAwICYmIChhYmlsaXR5LmlzQWN0aXZlKCkgfHwgKGFiaWxpdHkuYmVoYXZpb3IuaW5kZXhPZignRE9UQV9BQklMSVRZX0JFSEFWSU9SX1BBU1NJVkUnKSAhPSAtMSkpKSB7XG4gICAgICAgICAgICAgICAgICAgIC8vIGFsY2hlbWlzdF9hY2lkX3NwcmF5XG4gICAgICAgICAgICAgICAgICAgIHRvdGFsQXR0cmlidXRlKz1hYmlsaXR5LmFybW9yUmVkdWN0aW9uKCk7XG4gICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgfVxuICAgICAgICB9XG4gICAgICAgIHJldHVybiB0b3RhbEF0dHJpYnV0ZTtcbiAgICB9KTtcblxuICAgIHNlbGYuZ2V0SGVhbHRoID0ga28uY29tcHV0ZWQoZnVuY3Rpb24gKCkge1xuICAgICAgICB2YXIgdG90YWxBdHRyaWJ1dGUgPSAwO1xuICAgICAgICBmb3IgKHZhciBpID0gMDsgaSA8IHNlbGYuYWJpbGl0aWVzKCkubGVuZ3RoOyBpKyspIHtcbiAgICAgICAgICAgIHZhciBhYmlsaXR5ID0gc2VsZi5hYmlsaXRpZXMoKVtpXTtcbiAgICAgICAgICAgIGlmICghKGFiaWxpdHkubmFtZSBpbiBzZWxmLmFiaWxpdHlEYXRhKSkge1xuICAgICAgICAgICAgICAgIGlmIChhYmlsaXR5LmxldmVsKCkgPiAwICYmIChhYmlsaXR5LmlzQWN0aXZlKCkgfHwgKGFiaWxpdHkuYmVoYXZpb3IuaW5kZXhPZignRE9UQV9BQklMSVRZX0JFSEFWSU9SX1BBU1NJVkUnKSAhPSAtMSkpKSB7XG4gICAgICAgICAgICAgICAgICAgIGZvciAodmFyIGogPSAwOyBqIDwgc2VsZi5hYmlsaXRpZXMoKVtpXS5hdHRyaWJ1dGVzLmxlbmd0aDsgaisrKSB7XG4gICAgICAgICAgICAgICAgICAgICAgICB2YXIgYXR0cmlidXRlID0gc2VsZi5hYmlsaXRpZXMoKVtpXS5hdHRyaWJ1dGVzW2pdO1xuICAgICAgICAgICAgICAgICAgICAgICAgc3dpdGNoKGF0dHJpYnV0ZS5uYW1lKSB7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgLy8gbG9uZV9kcnVpZF90cnVlX2Zvcm0sbHljYW5fc2hhcGVzaGlmdCx0cm9sbF93YXJsb3JkX2JlcnNlcmtlcnNfcmFnZVxuICAgICAgICAgICAgICAgICAgICAgICAgICAgIGNhc2UgJ2JvbnVzX2hwJzpcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgdG90YWxBdHRyaWJ1dGUgKz0gc2VsZi5nZXRBYmlsaXR5QXR0cmlidXRlVmFsdWUoc2VsZi5hYmlsaXRpZXMoKVtpXS5hdHRyaWJ1dGVzLCBhdHRyaWJ1dGUubmFtZSwgYWJpbGl0eS5sZXZlbCgpKTtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICBicmVhaztcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAvLyBsb25lX2RydWlkX3N5bmVyZ3lcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICBjYXNlICd0cnVlX2Zvcm1faHBfYm9udXMnOlxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBpZiAoc2VsZi5pc1RydWVGb3JtQWN0aXZlKCkpIHtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIHRvdGFsQXR0cmlidXRlICs9IHNlbGYuZ2V0QWJpbGl0eUF0dHJpYnV0ZVZhbHVlKHNlbGYuYWJpbGl0aWVzKClbaV0uYXR0cmlidXRlcywgYXR0cmlidXRlLm5hbWUsIGFiaWxpdHkubGV2ZWwoKSk7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgICAgICAgICAgICAgICBicmVhaztcbiAgICAgICAgICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgIH1cbiAgICAgICAgICAgIGVsc2UgaWYgKGFiaWxpdHkuYm9udXNIZWFsdGggIT0gdW5kZWZpbmVkKSB7XG4gICAgICAgICAgICAgICAgaWYgKGFiaWxpdHkubGV2ZWwoKSA+IDAgJiYgKGFiaWxpdHkuaXNBY3RpdmUoKSB8fCAoYWJpbGl0eS5iZWhhdmlvci5pbmRleE9mKCdET1RBX0FCSUxJVFlfQkVIQVZJT1JfUEFTU0lWRScpICE9IC0xKSkpIHtcbiAgICAgICAgICAgICAgICAgICAgLy8gY2xpbmt6X2RlYXRoX3BhY3RcbiAgICAgICAgICAgICAgICAgICAgdG90YWxBdHRyaWJ1dGUrPWFiaWxpdHkuYm9udXNIZWFsdGgoKTtcbiAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICB9XG4gICAgICAgIH1cbiAgICAgICAgcmV0dXJuIHRvdGFsQXR0cmlidXRlO1xuICAgIH0pO1xuICAgIFxuICAgIHNlbGYuaXNUcnVlRm9ybUFjdGl2ZSA9IGZ1bmN0aW9uICgpIHtcbiAgICAgICAgZm9yICh2YXIgaSA9IDA7IGkgPCBzZWxmLmFiaWxpdGllcygpLmxlbmd0aDsgaSsrKSB7XG4gICAgICAgICAgICB2YXIgYWJpbGl0eSA9IHNlbGYuYWJpbGl0aWVzKClbaV07XG4gICAgICAgICAgICBpZiAoYWJpbGl0eS5pc0FjdGl2ZSgpICYmIGFiaWxpdHkubmFtZSA9PSAnbG9uZV9kcnVpZF90cnVlX2Zvcm0nKSB7XG4gICAgICAgICAgICAgICAgcmV0dXJuIHRydWU7XG4gICAgICAgICAgICB9XG4gICAgICAgIH1cbiAgICAgICAgcmV0dXJuIGZhbHNlO1xuICAgIH1cblxuICAgIHNlbGYuZ2V0SGVhbHRoUmVnZW4gPSBrby5jb21wdXRlZChmdW5jdGlvbiAoKSB7XG4gICAgICAgIHZhciB0b3RhbEF0dHJpYnV0ZSA9IDA7XG4gICAgICAgIGZvciAodmFyIGkgPSAwOyBpIDwgc2VsZi5hYmlsaXRpZXMoKS5sZW5ndGg7IGkrKykge1xuICAgICAgICAgICAgdmFyIGFiaWxpdHkgPSBzZWxmLmFiaWxpdGllcygpW2ldO1xuICAgICAgICAgICAgaWYgKCEoYWJpbGl0eS5uYW1lIGluIHNlbGYuYWJpbGl0eURhdGEpKSB7XG4gICAgICAgICAgICAgICAgaWYgKGFiaWxpdHkubGV2ZWwoKSA+IDAgJiYgKGFiaWxpdHkuaXNBY3RpdmUoKSB8fCAoYWJpbGl0eS5iZWhhdmlvci5pbmRleE9mKCdET1RBX0FCSUxJVFlfQkVIQVZJT1JfUEFTU0lWRScpICE9IC0xKSkpIHtcbiAgICAgICAgICAgICAgICAgICAgZm9yICh2YXIgaiA9IDA7IGogPCBzZWxmLmFiaWxpdGllcygpW2ldLmF0dHJpYnV0ZXMubGVuZ3RoOyBqKyspIHtcbiAgICAgICAgICAgICAgICAgICAgICAgIHZhciBhdHRyaWJ1dGUgPSBzZWxmLmFiaWxpdGllcygpW2ldLmF0dHJpYnV0ZXNbal07XG4gICAgICAgICAgICAgICAgICAgICAgICBzd2l0Y2goYXR0cmlidXRlLm5hbWUpIHtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAvLyBhbGNoZW1pc3RfY2hlbWljYWxfcmFnZSwgZHJhZ29uX2tuaWdodF9kcmFnb25fYmxvb2RcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICBjYXNlICdib251c19oZWFsdGhfcmVnZW4nOlxuICAgICAgICAgICAgICAgICAgICAgICAgICAgIC8vIGJyb29kbW90aGVyX3NwaW5fd2ViXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgY2FzZSAnaGVhdGhfcmVnZW4nOlxuICAgICAgICAgICAgICAgICAgICAgICAgICAgIC8vIG9tbmlrbmlnaHRfZ3VhcmRpYW5fYW5nZWwsdHJlYW50X2xpdmluZ19hcm1vcixzYXR5cl9oZWxsY2FsbGVyX3VuaG9seV9hdXJhXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgY2FzZSAnaGVhbHRoX3JlZ2VuJzpcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgdG90YWxBdHRyaWJ1dGUgKz0gc2VsZi5nZXRBYmlsaXR5QXR0cmlidXRlVmFsdWUoc2VsZi5hYmlsaXRpZXMoKVtpXS5hdHRyaWJ1dGVzLCBhdHRyaWJ1dGUubmFtZSwgYWJpbGl0eS5sZXZlbCgpKTtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICBicmVhaztcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAvLyBsZWdpb25fY29tbWFuZGVyX3ByZXNzX3RoZV9hdHRhY2tcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICBjYXNlICdocF9yZWdlbic6XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIHRvdGFsQXR0cmlidXRlICs9IHNlbGYuZ2V0QWJpbGl0eUF0dHJpYnV0ZVZhbHVlKHNlbGYuYWJpbGl0aWVzKClbaV0uYXR0cmlidXRlcywgYXR0cmlidXRlLm5hbWUsIGFiaWxpdHkubGV2ZWwoKSk7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgYnJlYWs7XG4gICAgICAgICAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICB9XG4gICAgICAgICAgICBlbHNlIGlmIChhYmlsaXR5LmhlYWx0aHJlZ2VuICE9IHVuZGVmaW5lZCkge1xuICAgICAgICAgICAgICAgIGlmIChhYmlsaXR5LmxldmVsKCkgPiAwICYmIChhYmlsaXR5LmlzQWN0aXZlKCkgfHwgKGFiaWxpdHkuYmVoYXZpb3IuaW5kZXhPZignRE9UQV9BQklMSVRZX0JFSEFWSU9SX1BBU1NJVkUnKSAhPSAtMSkpKSB7XG4gICAgICAgICAgICAgICAgICAgIC8vIHNocmVkZGVyX3JlYWN0aXZlX2FybW9yLGludm9rZXJfcXVhcyxuZWNyb2x5dGVfc2FkaXN0XG4gICAgICAgICAgICAgICAgICAgIHRvdGFsQXR0cmlidXRlKz1hYmlsaXR5LmhlYWx0aHJlZ2VuKCk7XG4gICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgfVxuICAgICAgICB9XG4gICAgICAgIHJldHVybiB0b3RhbEF0dHJpYnV0ZTtcbiAgICB9KTtcblxuICAgIHNlbGYuZ2V0TWFuYSA9IGtvLmNvbXB1dGVkKGZ1bmN0aW9uICgpIHtcbiAgICAgICAgdmFyIHRvdGFsQXR0cmlidXRlID0gMDtcbiAgICAgICAgZm9yICh2YXIgaSA9IDA7IGkgPCBzZWxmLmFiaWxpdGllcygpLmxlbmd0aDsgaSsrKSB7XG4gICAgICAgICAgICB2YXIgYWJpbGl0eSA9IHNlbGYuYWJpbGl0aWVzKClbaV07XG4gICAgICAgICAgICBpZiAoIShhYmlsaXR5Lm5hbWUgaW4gc2VsZi5hYmlsaXR5RGF0YSkpIHtcbiAgICAgICAgICAgICAgICBpZiAoYWJpbGl0eS5sZXZlbCgpID4gMCAmJiAoYWJpbGl0eS5pc0FjdGl2ZSgpIHx8IChhYmlsaXR5LmJlaGF2aW9yLmluZGV4T2YoJ0RPVEFfQUJJTElUWV9CRUhBVklPUl9QQVNTSVZFJykgIT0gLTEpKSkge1xuICAgICAgICAgICAgICAgICAgICBmb3IgKHZhciBqID0gMDsgaiA8IHNlbGYuYWJpbGl0aWVzKClbaV0uYXR0cmlidXRlcy5sZW5ndGg7IGorKykge1xuICAgICAgICAgICAgICAgICAgICAgICAgdmFyIGF0dHJpYnV0ZSA9IHNlbGYuYWJpbGl0aWVzKClbaV0uYXR0cmlidXRlc1tqXTtcbiAgICAgICAgICAgICAgICAgICAgICAgIHN3aXRjaChhdHRyaWJ1dGUubmFtZSkge1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgIC8vIG9ic2lkaWFuX2Rlc3Ryb3llcl9lc3NlbmNlX2F1cmFcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICBjYXNlICdib251c19tYW5hJzpcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgdG90YWxBdHRyaWJ1dGUgKz0gc2VsZi5nZXRBYmlsaXR5QXR0cmlidXRlVmFsdWUoc2VsZi5hYmlsaXRpZXMoKVtpXS5hdHRyaWJ1dGVzLCBhdHRyaWJ1dGUubmFtZSwgYWJpbGl0eS5sZXZlbCgpKTtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICBicmVhaztcbiAgICAgICAgICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgIH1cbiAgICAgICAgfVxuICAgICAgICByZXR1cm4gdG90YWxBdHRyaWJ1dGU7XG4gICAgfSk7XG4gICAgXG4gICAgc2VsZi5nZXRNYW5hUmVnZW4gPSBrby5jb21wdXRlZChmdW5jdGlvbiAoKSB7XG4gICAgICAgIHZhciB0b3RhbEF0dHJpYnV0ZSA9IDA7XG4gICAgICAgIGZvciAodmFyIGkgPSAwOyBpIDwgc2VsZi5hYmlsaXRpZXMoKS5sZW5ndGg7IGkrKykge1xuICAgICAgICAgICAgdmFyIGFiaWxpdHkgPSBzZWxmLmFiaWxpdGllcygpW2ldO1xuICAgICAgICAgICAgaWYgKCEoYWJpbGl0eS5uYW1lIGluIHNlbGYuYWJpbGl0eURhdGEpKSB7XG4gICAgICAgICAgICAgICAgaWYgKGFiaWxpdHkubGV2ZWwoKSA+IDAgJiYgKGFiaWxpdHkuaXNBY3RpdmUoKSB8fCAoYWJpbGl0eS5iZWhhdmlvci5pbmRleE9mKCdET1RBX0FCSUxJVFlfQkVIQVZJT1JfUEFTU0lWRScpICE9IC0xKSkpIHtcbiAgICAgICAgICAgICAgICAgICAgZm9yICh2YXIgaiA9IDA7IGogPCBzZWxmLmFiaWxpdGllcygpW2ldLmF0dHJpYnV0ZXMubGVuZ3RoOyBqKyspIHtcbiAgICAgICAgICAgICAgICAgICAgICAgIHZhciBhdHRyaWJ1dGUgPSBzZWxmLmFiaWxpdGllcygpW2ldLmF0dHJpYnV0ZXNbal07XG4gICAgICAgICAgICAgICAgICAgICAgICBzd2l0Y2goYXR0cmlidXRlLm5hbWUpIHtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAvLyBhbGNoZW1pc3RfY2hlbWljYWxfcmFnZVxuICAgICAgICAgICAgICAgICAgICAgICAgICAgIGNhc2UgJ2JvbnVzX21hbmFfcmVnZW4nOlxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICB0b3RhbEF0dHJpYnV0ZSArPSBzZWxmLmdldEFiaWxpdHlBdHRyaWJ1dGVWYWx1ZShzZWxmLmFiaWxpdGllcygpW2ldLmF0dHJpYnV0ZXMsIGF0dHJpYnV0ZS5uYW1lLCBhYmlsaXR5LmxldmVsKCkpO1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgIGJyZWFrO1xuICAgICAgICAgICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgfVxuICAgICAgICAgICAgZWxzZSBpZiAoYWJpbGl0eS5tYW5hcmVnZW4gIT0gdW5kZWZpbmVkKSB7XG4gICAgICAgICAgICAgICAgaWYgKGFiaWxpdHkubGV2ZWwoKSA+IDAgJiYgKGFiaWxpdHkuaXNBY3RpdmUoKSB8fCAoYWJpbGl0eS5iZWhhdmlvci5pbmRleE9mKCdET1RBX0FCSUxJVFlfQkVIQVZJT1JfUEFTU0lWRScpICE9IC0xKSkpIHtcbiAgICAgICAgICAgICAgICAgICAgLy8gbmVjcm9seXRlX3NhZGlzdFxuICAgICAgICAgICAgICAgICAgICB0b3RhbEF0dHJpYnV0ZSs9YWJpbGl0eS5tYW5hcmVnZW4oKTtcbiAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICB9XG4gICAgICAgIH1cbiAgICAgICAgcmV0dXJuIHRvdGFsQXR0cmlidXRlO1xuICAgIH0pO1xuICAgIFxuICAgIHNlbGYuZ2V0TWFuYVJlZ2VuQXJjYW5lQXVyYSA9IGtvLmNvbXB1dGVkKGZ1bmN0aW9uICgpIHtcbiAgICAgICAgdmFyIHRvdGFsQXR0cmlidXRlID0gMDtcbiAgICAgICAgZm9yICh2YXIgaSA9IDA7IGkgPCBzZWxmLmFiaWxpdGllcygpLmxlbmd0aDsgaSsrKSB7XG4gICAgICAgICAgICB2YXIgYWJpbGl0eSA9IHNlbGYuYWJpbGl0aWVzKClbaV07XG4gICAgICAgICAgICBpZiAoIShhYmlsaXR5Lm5hbWUgaW4gc2VsZi5hYmlsaXR5RGF0YSkpIHtcbiAgICAgICAgICAgICAgICBpZiAoYWJpbGl0eS5sZXZlbCgpID4gMCAmJiAoYWJpbGl0eS5pc0FjdGl2ZSgpIHx8IChhYmlsaXR5LmJlaGF2aW9yLmluZGV4T2YoJ0RPVEFfQUJJTElUWV9CRUhBVklPUl9QQVNTSVZFJykgIT0gLTEpKSkge1xuICAgICAgICAgICAgICAgICAgICBmb3IgKHZhciBqID0gMDsgaiA8IHNlbGYuYWJpbGl0aWVzKClbaV0uYXR0cmlidXRlcy5sZW5ndGg7IGorKykge1xuICAgICAgICAgICAgICAgICAgICAgICAgdmFyIGF0dHJpYnV0ZSA9IHNlbGYuYWJpbGl0aWVzKClbaV0uYXR0cmlidXRlc1tqXTtcbiAgICAgICAgICAgICAgICAgICAgICAgIHN3aXRjaChhdHRyaWJ1dGUubmFtZSkge1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgIC8vIGNyeXN0YWxfbWFpZGVuX2JyaWxsaWFuY2VfYXVyYVxuICAgICAgICAgICAgICAgICAgICAgICAgICAgIGNhc2UgJ21hbmFfcmVnZW4nOlxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBpZiAoYWJpbGl0eS5uYW1lID09ICdjcnlzdGFsX21haWRlbl9icmlsbGlhbmNlX2F1cmEnKSB7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICB0b3RhbEF0dHJpYnV0ZSArPSBzZWxmLmdldEFiaWxpdHlBdHRyaWJ1dGVWYWx1ZShzZWxmLmFiaWxpdGllcygpW2ldLmF0dHJpYnV0ZXMsIGF0dHJpYnV0ZS5uYW1lLCBhYmlsaXR5LmxldmVsKCkpO1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgYnJlYWs7XG4gICAgICAgICAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICB9XG4gICAgICAgIH1cbiAgICAgICAgcmV0dXJuIHRvdGFsQXR0cmlidXRlO1xuICAgIH0pO1xuXG4gICAgc2VsZi5nZXRNYW5hUmVnZW5SZWR1Y3Rpb24gPSBrby5jb21wdXRlZChmdW5jdGlvbiAoKSB7XG4gICAgICAgIHZhciB0b3RhbEF0dHJpYnV0ZSA9IDA7XG4gICAgICAgIGZvciAodmFyIGkgPSAwOyBpIDwgc2VsZi5hYmlsaXRpZXMoKS5sZW5ndGg7IGkrKykge1xuICAgICAgICAgICAgdmFyIGFiaWxpdHkgPSBzZWxmLmFiaWxpdGllcygpW2ldO1xuICAgICAgICAgICAgaWYgKCEoYWJpbGl0eS5uYW1lIGluIHNlbGYuYWJpbGl0eURhdGEpKSB7XG4gICAgICAgICAgICAgICAgaWYgKGFiaWxpdHkubGV2ZWwoKSA+IDAgJiYgKGFiaWxpdHkuaXNBY3RpdmUoKSB8fCAoYWJpbGl0eS5iZWhhdmlvci5pbmRleE9mKCdET1RBX0FCSUxJVFlfQkVIQVZJT1JfUEFTU0lWRScpICE9IC0xKSkpIHtcbiAgICAgICAgICAgICAgICAgICAgZm9yICh2YXIgaiA9IDA7IGogPCBzZWxmLmFiaWxpdGllcygpW2ldLmF0dHJpYnV0ZXMubGVuZ3RoOyBqKyspIHtcbiAgICAgICAgICAgICAgICAgICAgICAgIHZhciBhdHRyaWJ1dGUgPSBzZWxmLmFiaWxpdGllcygpW2ldLmF0dHJpYnV0ZXNbal07XG4gICAgICAgICAgICAgICAgICAgICAgICAvL3N3aXRjaChhdHRyaWJ1dGUubmFtZSkge1xuICAgICAgICAgICAgICAgICAgICAgICAgLy8gICAgLy8gXG4gICAgICAgICAgICAgICAgICAgICAgICAvLyAgICBjYXNlICcnOlxuICAgICAgICAgICAgICAgICAgICAgICAgLy8gICAgICAgIHRvdGFsQXR0cmlidXRlICs9IHBhcnNlSW50KGF0dHJpYnV0ZS52YWx1ZVthYmlsaXR5LmxldmVsKCktMV0pO1xuICAgICAgICAgICAgICAgICAgICAgICAgLy8gICAgYnJlYWs7XG4gICAgICAgICAgICAgICAgICAgICAgICAvL31cbiAgICAgICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgIH1cbiAgICAgICAgICAgIGVsc2UgaWYgKGFiaWxpdHkubWFuYXJlZ2VucmVkdWN0aW9uICE9IHVuZGVmaW5lZCkge1xuICAgICAgICAgICAgICAgIGlmIChhYmlsaXR5LmxldmVsKCkgPiAwICYmIChhYmlsaXR5LmlzQWN0aXZlKCkgfHwgKGFiaWxpdHkuYmVoYXZpb3IuaW5kZXhPZignRE9UQV9BQklMSVRZX0JFSEFWSU9SX1BBU1NJVkUnKSAhPSAtMSkpKSB7XG4gICAgICAgICAgICAgICAgICAgIC8vIHB1Z25hX25ldGhlcl93YXJkXG4gICAgICAgICAgICAgICAgICAgIHRvdGFsQXR0cmlidXRlKz1hYmlsaXR5Lm1hbmFyZWdlbnJlZHVjdGlvbigpO1xuICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgIH1cbiAgICAgICAgfVxuICAgICAgICByZXR1cm4gdG90YWxBdHRyaWJ1dGU7XG4gICAgfSk7XG4gICAgXG4gICAgc2VsZi5nZXRBdHRhY2tSYW5nZSA9IGtvLmNvbXB1dGVkKGZ1bmN0aW9uICgpIHtcbiAgICAgICAgdmFyIHRvdGFsQXR0cmlidXRlID0gMDtcbiAgICAgICAgZm9yICh2YXIgaSA9IDA7IGkgPCBzZWxmLmFiaWxpdGllcygpLmxlbmd0aDsgaSsrKSB7XG4gICAgICAgICAgICB2YXIgYWJpbGl0eSA9IHNlbGYuYWJpbGl0aWVzKClbaV07XG4gICAgICAgICAgICBpZiAoIShhYmlsaXR5Lm5hbWUgaW4gc2VsZi5hYmlsaXR5RGF0YSkpIHtcbiAgICAgICAgICAgICAgICBpZiAoYWJpbGl0eS5sZXZlbCgpID4gMCAmJiAoYWJpbGl0eS5pc0FjdGl2ZSgpIHx8IChhYmlsaXR5LmJlaGF2aW9yLmluZGV4T2YoJ0RPVEFfQUJJTElUWV9CRUhBVklPUl9QQVNTSVZFJykgIT0gLTEpKSkge1xuICAgICAgICAgICAgICAgICAgICBmb3IgKHZhciBqID0gMDsgaiA8IHNlbGYuYWJpbGl0aWVzKClbaV0uYXR0cmlidXRlcy5sZW5ndGg7IGorKykge1xuICAgICAgICAgICAgICAgICAgICAgICAgdmFyIGF0dHJpYnV0ZSA9IHNlbGYuYWJpbGl0aWVzKClbaV0uYXR0cmlidXRlc1tqXTtcbiAgICAgICAgICAgICAgICAgICAgICAgIHN3aXRjaChhdHRyaWJ1dGUubmFtZSkge1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgIC8vIHdpbnRlcl93eXZlcm5fYXJjdGljX2J1cm5cbiAgICAgICAgICAgICAgICAgICAgICAgICAgICBjYXNlICdhdHRhY2tfcmFuZ2VfYm9udXMnOlxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICB0b3RhbEF0dHJpYnV0ZSArPSBzZWxmLmdldEFiaWxpdHlBdHRyaWJ1dGVWYWx1ZShzZWxmLmFiaWxpdGllcygpW2ldLmF0dHJpYnV0ZXMsIGF0dHJpYnV0ZS5uYW1lLCBhYmlsaXR5LmxldmVsKCkpO1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgIGJyZWFrO1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgIC8vIHRlbXBsYXJfYXNzYXNzaW5fcHNpX2JsYWRlcyxzbmlwZXJfdGFrZV9haW1cbiAgICAgICAgICAgICAgICAgICAgICAgICAgICBjYXNlICdib251c19hdHRhY2tfcmFuZ2UnOlxuICAgICAgICAgICAgICAgICAgICAgICAgICAgIC8vIHRlcnJvcmJsYWRlX21ldGFtb3JwaG9zaXMsdHJvbGxfd2FybG9yZF9iZXJzZXJrZXJzX3JhZ2VcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICBjYXNlICdib251c19yYW5nZSc6XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIGlmIChhYmlsaXR5Lm5hbWUgPT0gJ3RlcnJvcmJsYWRlX21ldGFtb3JwaG9zaXMnKSB7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICB0b3RhbEF0dHJpYnV0ZSArPSBzZWxmLmdldEFiaWxpdHlBdHRyaWJ1dGVWYWx1ZShzZWxmLmFiaWxpdGllcygpW2ldLmF0dHJpYnV0ZXMsIGF0dHJpYnV0ZS5uYW1lLCBhYmlsaXR5LmxldmVsKCkpO1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIGlmIChhYmlsaXR5Lm5hbWUgPT0gJ3Ryb2xsX3dhcmxvcmRfYmVyc2Vya2Vyc19yYWdlJykge1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgdG90YWxBdHRyaWJ1dGUgLT0gc2VsZi5nZXRBYmlsaXR5QXR0cmlidXRlVmFsdWUoc2VsZi5hYmlsaXRpZXMoKVtpXS5hdHRyaWJ1dGVzLCBhdHRyaWJ1dGUubmFtZSwgYWJpbGl0eS5sZXZlbCgpKTtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICAgICAgICAgICAgICAgIGJyZWFrO1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgIC8vIHRpbnlfZ3Jvd1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgIGNhc2UgJ2JvbnVzX3JhbmdlX3NjZXB0ZXInOlxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBpZiAoYWJpbGl0eS5uYW1lID09ICd0aW55X2dyb3cnICYmIHNlbGYuaGFzU2NlcHRlcigpKSB7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICB0b3RhbEF0dHJpYnV0ZSArPSBzZWxmLmdldEFiaWxpdHlBdHRyaWJ1dGVWYWx1ZShzZWxmLmFiaWxpdGllcygpW2ldLmF0dHJpYnV0ZXMsIGF0dHJpYnV0ZS5uYW1lLCBhYmlsaXR5LmxldmVsKCkpO1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgYnJlYWs7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgLy8gZW5jaGFudHJlc3NfaW1wZXR1c1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgIGNhc2UgJ2JvbnVzX2F0dGFja19yYW5nZV9zY2VwdGVyJzpcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgaWYgKGFiaWxpdHkubmFtZSA9PSAnZW5jaGFudHJlc3NfaW1wZXR1cycgJiYgc2VsZi5oYXNTY2VwdGVyKCkpIHtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIHRvdGFsQXR0cmlidXRlICs9IHNlbGYuZ2V0QWJpbGl0eUF0dHJpYnV0ZVZhbHVlKHNlbGYuYWJpbGl0aWVzKClbaV0uYXR0cmlidXRlcywgYXR0cmlidXRlLm5hbWUsIGFiaWxpdHkubGV2ZWwoKSk7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgICAgICAgICAgICAgICBicmVhaztcbiAgICAgICAgICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICAgICAgICAvLyBsb25lX2RydWlkX3RydWVfZm9ybVxuICAgICAgICAgICAgICAgICAgICBpZiAoYWJpbGl0eS5uYW1lID09ICdsb25lX2RydWlkX3RydWVfZm9ybScpIHtcbiAgICAgICAgICAgICAgICAgICAgICAgIHRvdGFsQXR0cmlidXRlIC09IDQyMjtcbiAgICAgICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgICBlbHNlIGlmIChhYmlsaXR5LmxldmVsKCkgPiAwICYmIGFiaWxpdHkubmFtZSA9PSAnZW5jaGFudHJlc3NfaW1wZXR1cycgJiYgc2VsZi5oYXNTY2VwdGVyKCkpIHtcbiAgICAgICAgICAgICAgICAgICAgZm9yICh2YXIgaiA9IDA7IGogPCBzZWxmLmFiaWxpdGllcygpW2ldLmF0dHJpYnV0ZXMubGVuZ3RoOyBqKyspIHtcbiAgICAgICAgICAgICAgICAgICAgICAgIHZhciBhdHRyaWJ1dGUgPSBzZWxmLmFiaWxpdGllcygpW2ldLmF0dHJpYnV0ZXNbal07XG4gICAgICAgICAgICAgICAgICAgICAgICBzd2l0Y2goYXR0cmlidXRlLm5hbWUpIHtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgY2FzZSAnYm9udXNfYXR0YWNrX3JhbmdlX3NjZXB0ZXInOlxuICAgICAgICAgICAgICAgICAgICAgICAgICAgIHRvdGFsQXR0cmlidXRlICs9IHNlbGYuZ2V0QWJpbGl0eUF0dHJpYnV0ZVZhbHVlKHNlbGYuYWJpbGl0aWVzKClbaV0uYXR0cmlidXRlcywgYXR0cmlidXRlLm5hbWUsIGFiaWxpdHkubGV2ZWwoKSk7XG4gICAgICAgICAgICAgICAgICAgICAgICAgIGJyZWFrO1xuICAgICAgICAgICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgfVxuICAgICAgICAgICAgZWxzZSBpZiAoYWJpbGl0eS5hdHRhY2tyYW5nZSAhPSB1bmRlZmluZWQpIHtcbiAgICAgICAgICAgICAgICBpZiAoYWJpbGl0eS5sZXZlbCgpID4gMCAmJiAoYWJpbGl0eS5pc0FjdGl2ZSgpIHx8IChhYmlsaXR5LmJlaGF2aW9yLmluZGV4T2YoJ0RPVEFfQUJJTElUWV9CRUhBVklPUl9QQVNTSVZFJykgIT0gLTEpKSkge1xuICAgICAgICAgICAgICAgICAgICAvLyBkcmFnb25fa25pZ2h0X2VsZGVyX2RyYWdvbl9mb3JtXG4gICAgICAgICAgICAgICAgICAgIHRvdGFsQXR0cmlidXRlKz1hYmlsaXR5LmF0dGFja3JhbmdlKCk7XG4gICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgfVxuICAgICAgICB9XG4gICAgICAgIHJldHVybiB0b3RhbEF0dHJpYnV0ZTtcbiAgICB9KTtcbiAgICBcbiAgICBzZWxmLmdldEF0dGFja1NwZWVkID0ga28uY29tcHV0ZWQoZnVuY3Rpb24gKCkge1xuICAgICAgICB2YXIgdG90YWxBdHRyaWJ1dGUgPSAwO1xuICAgICAgICBmb3IgKHZhciBpID0gMDsgaSA8IHNlbGYuYWJpbGl0aWVzKCkubGVuZ3RoOyBpKyspIHtcbiAgICAgICAgICAgIHZhciBhYmlsaXR5ID0gc2VsZi5hYmlsaXRpZXMoKVtpXTtcbiAgICAgICAgICAgIGlmICghKGFiaWxpdHkubmFtZSBpbiBzZWxmLmFiaWxpdHlEYXRhKSkge1xuICAgICAgICAgICAgICAgIGlmIChhYmlsaXR5LmxldmVsKCkgPiAwICYmIChhYmlsaXR5LmlzQWN0aXZlKCkgfHwgKGFiaWxpdHkuYmVoYXZpb3IuaW5kZXhPZignRE9UQV9BQklMSVRZX0JFSEFWSU9SX1BBU1NJVkUnKSAhPSAtMSkpKSB7XG4gICAgICAgICAgICAgICAgICAgIGZvciAodmFyIGogPSAwOyBqIDwgc2VsZi5hYmlsaXRpZXMoKVtpXS5hdHRyaWJ1dGVzLmxlbmd0aDsgaisrKSB7XG4gICAgICAgICAgICAgICAgICAgICAgICB2YXIgYXR0cmlidXRlID0gc2VsZi5hYmlsaXRpZXMoKVtpXS5hdHRyaWJ1dGVzW2pdO1xuICAgICAgICAgICAgICAgICAgICAgICAgc3dpdGNoKGF0dHJpYnV0ZS5uYW1lKSB7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgLy8gYWJhZGRvbl9mcm9zdG1vdXJuZSx0cm9sbF93YXJsb3JkX2JhdHRsZV90cmFuY2VcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICBjYXNlICdhdHRhY2tfc3BlZWQnOlxuICAgICAgICAgICAgICAgICAgICAgICAgICAgIC8vIHZpc2FnZV9ncmF2ZV9jaGlsbFxuICAgICAgICAgICAgICAgICAgICAgICAgICAgIGNhc2UgJ2F0dGFja3NwZWVkX2JvbnVzJzpcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAvLyBtaXJhbmFfbGVhcFxuICAgICAgICAgICAgICAgICAgICAgICAgICAgIGNhc2UgJ2xlYXBfc3BlZWRib251c19hcyc6XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgLy8gbGlmZV9zdGVhbGVyXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgY2FzZSAnYXR0YWNrX3NwZWVkX2JvbnVzJzpcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgdG90YWxBdHRyaWJ1dGUgKz0gc2VsZi5nZXRBYmlsaXR5QXR0cmlidXRlVmFsdWUoc2VsZi5hYmlsaXRpZXMoKVtpXS5hdHRyaWJ1dGVzLCBhdHRyaWJ1dGUubmFtZSwgYWJpbGl0eS5sZXZlbCgpKTtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICBicmVhaztcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAvLyBjbGlua3pfc3RyYWZlLHVyc2Ffb3ZlcnBvd2VyXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgY2FzZSAnYXR0YWNrX3NwZWVkX2JvbnVzX3BjdCc6XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIGlmIChhYmlsaXR5Lm5hbWUgPT0gJ2NsaW5rel9zdHJhZmUnIHx8IGFiaWxpdHkubmFtZSA9PSAndXJzYV9vdmVycG93ZXInKSB7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICB0b3RhbEF0dHJpYnV0ZSArPSBzZWxmLmdldEFiaWxpdHlBdHRyaWJ1dGVWYWx1ZShzZWxmLmFiaWxpdGllcygpW2ldLmF0dHJpYnV0ZXMsIGF0dHJpYnV0ZS5uYW1lLCBhYmlsaXR5LmxldmVsKCkpO1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgYnJlYWs7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgLy8gYXhlX2N1bGxpbmdfYmxhZGUsbmVjcm9ub21pY29uX2FyY2hlcl9hb2VcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICBjYXNlICdzcGVlZF9ib251cyc6XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIGlmIChhYmlsaXR5Lm5hbWUgPT0gJ2F4ZV9jdWxsaW5nX2JsYWRlJyB8fCBhYmlsaXR5Lm5hbWUgPT0gJ25lY3Jvbm9taWNvbl9hcmNoZXJfYW9lJykge1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgdG90YWxBdHRyaWJ1dGUgKz0gc2VsZi5nZXRBYmlsaXR5QXR0cmlidXRlVmFsdWUoc2VsZi5hYmlsaXRpZXMoKVtpXS5hdHRyaWJ1dGVzLCBhdHRyaWJ1dGUubmFtZSwgYWJpbGl0eS5sZXZlbCgpKTtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICAgICAgICAgICAgICAgIGJyZWFrO1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgIC8vIGFuY2llbnRfYXBwYXJpdGlvbl9jaGlsbGluZ190b3VjaFxuICAgICAgICAgICAgICAgICAgICAgICAgICAgIGNhc2UgJ2F0dGFja19zcGVlZF9wY3QnOlxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBpZiAoYWJpbGl0eS5uYW1lID09ICdhbmNpZW50X2FwcGFyaXRpb25fY2hpbGxpbmdfdG91Y2gnKSB7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICB0b3RhbEF0dHJpYnV0ZSArPSBzZWxmLmdldEFiaWxpdHlBdHRyaWJ1dGVWYWx1ZShzZWxmLmFiaWxpdGllcygpW2ldLmF0dHJpYnV0ZXMsIGF0dHJpYnV0ZS5uYW1lLCBhYmlsaXR5LmxldmVsKCkpO1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgYnJlYWs7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgLy8gYmVhc3RtYXN0ZXJfaW5uZXJfYmVhc3QsbHljYW5fZmVyYWxfaW1wdWxzZSxsb25lX2RydWlkX3JhYmlkLHRpbnlfZ3JvdyxwaGFudG9tX2Fzc2Fzc2luX3BoYW50b21fc3RyaWtlLHdpbmRydW5uZXJfZm9jdXNmaXJlLG9ncmVfbWFnaV9ibG9vZGx1c3QsY2VudGF1cl9raGFuX2VuZHVyYW5jZV9hdXJhXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgY2FzZSAnYm9udXNfYXR0YWNrX3NwZWVkJzpcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgaWYgKGFiaWxpdHkubmFtZSA9PSAnYmVhc3RtYXN0ZXJfaW5uZXJfYmVhc3QnIFxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgfHwgYWJpbGl0eS5uYW1lID09ICdseWNhbl9mZXJhbF9pbXB1bHNlJyBcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIHx8IGFiaWxpdHkubmFtZSA9PSAnbG9uZV9kcnVpZF9yYWJpZCcgXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICB8fCBhYmlsaXR5Lm5hbWUgPT0gJ3RpbnlfZ3JvdycgXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICB8fCBhYmlsaXR5Lm5hbWUgPT0gJ3BoYW50b21fYXNzYXNzaW5fcGhhbnRvbV9zdHJpa2UnIFxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgfHwgYWJpbGl0eS5uYW1lID09ICd3aW5kcnVubmVyX2ZvY3VzZmlyZScgXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICB8fCBhYmlsaXR5Lm5hbWUgPT0gJ29ncmVfbWFnaV9ibG9vZGx1c3QnXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICB8fCBhYmlsaXR5Lm5hbWUgPT0gJ2NlbnRhdXJfa2hhbl9lbmR1cmFuY2VfYXVyYScpIHtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIHRvdGFsQXR0cmlidXRlICs9IHNlbGYuZ2V0QWJpbGl0eUF0dHJpYnV0ZVZhbHVlKHNlbGYuYWJpbGl0aWVzKClbaV0uYXR0cmlidXRlcywgYXR0cmlidXRlLm5hbWUsIGFiaWxpdHkubGV2ZWwoKSk7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgICAgICAgICAgICAgICBicmVhaztcbiAgICAgICAgICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgIH1cbiAgICAgICAgICAgIGVsc2UgaWYgKGFiaWxpdHkuYXR0YWNrc3BlZWQgIT0gdW5kZWZpbmVkKSB7XG4gICAgICAgICAgICAgICAgaWYgKGFiaWxpdHkubGV2ZWwoKSA+IDAgJiYgKGFiaWxpdHkuaXNBY3RpdmUoKSB8fCAoYWJpbGl0eS5iZWhhdmlvci5pbmRleE9mKCdET1RBX0FCSUxJVFlfQkVIQVZJT1JfUEFTU0lWRScpICE9IC0xKSkpIHtcbiAgICAgICAgICAgICAgICAgICAgLy8gdHJvbGxfd2FybG9yZF9mZXJ2b3Isd2lzcF9vdmVyY2hhcmdlLGxpbmFfZmllcnlfc291bCxpbnZva2VyX2FsYWNyaXR5LGludm9rZXJfd2V4LGh1c2thcl9iZXJzZXJrZXJzX2Jsb29kXG4gICAgICAgICAgICAgICAgICAgIHRvdGFsQXR0cmlidXRlKz1hYmlsaXR5LmF0dGFja3NwZWVkKCk7XG4gICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgfVxuICAgICAgICB9XG4gICAgICAgIHJldHVybiB0b3RhbEF0dHJpYnV0ZTtcbiAgICB9KTtcblxuICAgIHNlbGYuZ2V0QXR0YWNrU3BlZWRSZWR1Y3Rpb24gPSBrby5jb21wdXRlZChmdW5jdGlvbiAoKSB7XG4gICAgICAgIHZhciB0b3RhbEF0dHJpYnV0ZSA9IDA7XG4gICAgICAgIGZvciAodmFyIGkgPSAwOyBpIDwgc2VsZi5hYmlsaXRpZXMoKS5sZW5ndGg7IGkrKykge1xuICAgICAgICAgICAgdmFyIGFiaWxpdHkgPSBzZWxmLmFiaWxpdGllcygpW2ldO1xuICAgICAgICAgICAgaWYgKCEoYWJpbGl0eS5uYW1lIGluIHNlbGYuYWJpbGl0eURhdGEpKSB7XG4gICAgICAgICAgICAgICAgaWYgKGFiaWxpdHkubGV2ZWwoKSA+IDAgJiYgKGFiaWxpdHkuaXNBY3RpdmUoKSB8fCAoYWJpbGl0eS5iZWhhdmlvci5pbmRleE9mKCdET1RBX0FCSUxJVFlfQkVIQVZJT1JfUEFTU0lWRScpICE9IC0xKSkpIHtcbiAgICAgICAgICAgICAgICAgICAgZm9yICh2YXIgaiA9IDA7IGogPCBzZWxmLmFiaWxpdGllcygpW2ldLmF0dHJpYnV0ZXMubGVuZ3RoOyBqKyspIHtcbiAgICAgICAgICAgICAgICAgICAgICAgIHZhciBhdHRyaWJ1dGUgPSBzZWxmLmFiaWxpdGllcygpW2ldLmF0dHJpYnV0ZXNbal07XG4gICAgICAgICAgICAgICAgICAgICAgICBzd2l0Y2goYXR0cmlidXRlLm5hbWUpIHtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAvLyBuaWdodF9zdGFsa2VyX3ZvaWQsY3J5c3RhbF9tYWlkZW5fY3J5c3RhbF9ub3ZhLGdob3N0X2Zyb3N0X2F0dGFjayxvZ3JlX21hZ2lfZnJvc3RfYXJtb3IscG9sYXJfZnVyYm9sZ191cnNhX3dhcnJpb3JfdGh1bmRlcl9jbGFwXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgY2FzZSAnYXR0YWNrc3BlZWRfc2xvdyc6XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgLy8gbGljaF9mcm9zdF9hcm1vcixsaWNoX2Zyb3N0X25vdmEsZW5jaGFudHJlc3NfdW50b3VjaGFibGVcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICBjYXNlICdzbG93X2F0dGFja19zcGVlZCc6XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgLy8gYmVhc3RtYXN0ZXJfcHJpbWFsX3JvYXJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICBjYXNlICdzbG93X2F0dGFja19zcGVlZF9wY3QnOlxuICAgICAgICAgICAgICAgICAgICAgICAgICAgIC8vIHN0b3JtX3NwaXJpdF9vdmVybG9hZFxuICAgICAgICAgICAgICAgICAgICAgICAgICAgIGNhc2UgJ292ZXJsb2FkX2F0dGFja19zbG93JzpcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgdG90YWxBdHRyaWJ1dGUgKz0gc2VsZi5nZXRBYmlsaXR5QXR0cmlidXRlVmFsdWUoc2VsZi5hYmlsaXRpZXMoKVtpXS5hdHRyaWJ1dGVzLCBhdHRyaWJ1dGUubmFtZSwgYWJpbGl0eS5sZXZlbCgpKTtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICBicmVhaztcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAvLyBvbW5pa25pZ2h0X2RlZ2VuX2F1cmFcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICBjYXNlICdzcGVlZF9ib251cyc6XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIGlmIChhYmlsaXR5Lm5hbWUgPT0gJ29tbmlrbmlnaHRfZGVnZW5fYXVyYScpIHtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIHRvdGFsQXR0cmlidXRlICs9IHNlbGYuZ2V0QWJpbGl0eUF0dHJpYnV0ZVZhbHVlKHNlbGYuYWJpbGl0aWVzKClbaV0uYXR0cmlidXRlcywgYXR0cmlidXRlLm5hbWUsIGFiaWxpdHkubGV2ZWwoKSk7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgICAgICAgICAgICAgICBicmVhaztcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAvLyB0dXNrX2Zyb3plbl9zaWdpbCxjcnlzdGFsX21haWRlbl9mcmVlemluZ19maWVsZFxuICAgICAgICAgICAgICAgICAgICAgICAgICAgIGNhc2UgJ2F0dGFja19zbG93JzpcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgaWYgKGFiaWxpdHkubmFtZSA9PSAnY3J5c3RhbF9tYWlkZW5fZnJlZXppbmdfZmllbGQnICYmICFzZWxmLmhhc1NjZXB0ZXIoKSkge1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgdG90YWxBdHRyaWJ1dGUgKz0gc2VsZi5nZXRBYmlsaXR5QXR0cmlidXRlVmFsdWUoc2VsZi5hYmlsaXRpZXMoKVtpXS5hdHRyaWJ1dGVzLCBhdHRyaWJ1dGUubmFtZSwgYWJpbGl0eS5sZXZlbCgpKTtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBlbHNlIGlmIChhYmlsaXR5Lm5hbWUgPT0gJ3R1c2tfZnJvemVuX3NpZ2lsJykge1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgdG90YWxBdHRyaWJ1dGUgLT0gc2VsZi5nZXRBYmlsaXR5QXR0cmlidXRlVmFsdWUoc2VsZi5hYmlsaXRpZXMoKVtpXS5hdHRyaWJ1dGVzLCBhdHRyaWJ1dGUubmFtZSwgYWJpbGl0eS5sZXZlbCgpKTtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICAgICAgICAgICAgICAgIGJyZWFrO1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgIGNhc2UgJ2F0dGFja19zbG93X3NjZXB0ZXInOlxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBpZiAoYWJpbGl0eS5uYW1lID09ICdjcnlzdGFsX21haWRlbl9mcmVlemluZ19maWVsZCcgJiYgc2VsZi5oYXNTY2VwdGVyKCkpIHtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIHRvdGFsQXR0cmlidXRlICs9IHNlbGYuZ2V0QWJpbGl0eUF0dHJpYnV0ZVZhbHVlKHNlbGYuYWJpbGl0aWVzKClbaV0uYXR0cmlidXRlcywgYXR0cmlidXRlLm5hbWUsIGFiaWxpdHkubGV2ZWwoKSk7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgICAgICAgICAgICAgICBicmVhaztcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAvLyBmYWNlbGVzc192b2lkX3RpbWVfd2Fsa1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgIGNhc2UgJ2F0dGFja19zcGVlZF9wY3QnOlxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBpZiAoYWJpbGl0eS5uYW1lID09ICdmYWNlbGVzc192b2lkX3RpbWVfd2FsaycpIHtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIHRvdGFsQXR0cmlidXRlICs9IHNlbGYuZ2V0QWJpbGl0eUF0dHJpYnV0ZVZhbHVlKHNlbGYuYWJpbGl0aWVzKClbaV0uYXR0cmlidXRlcywgYXR0cmlidXRlLm5hbWUsIGFiaWxpdHkubGV2ZWwoKSk7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgICAgICAgICAgICAgICBicmVhaztcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAvLyBib3VudHlfaHVudGVyX2ppbmFkYVxuICAgICAgICAgICAgICAgICAgICAgICAgICAgIGNhc2UgJ2JvbnVzX2F0dGFja3NwZWVkJzpcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgaWYgKGFiaWxpdHkubmFtZSA9PSAnYm91bnR5X2h1bnRlcl9qaW5hZGEnKSB7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICB0b3RhbEF0dHJpYnV0ZSArPSBzZWxmLmdldEFiaWxpdHlBdHRyaWJ1dGVWYWx1ZShzZWxmLmFiaWxpdGllcygpW2ldLmF0dHJpYnV0ZXMsIGF0dHJpYnV0ZS5uYW1lLCBhYmlsaXR5LmxldmVsKCkpO1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgYnJlYWs7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgLy8gYnJld21hc3Rlcl90aHVuZGVyX2NsYXBcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICBjYXNlICdhdHRhY2tfc3BlZWRfc2xvdyc6XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIGlmIChhYmlsaXR5Lm5hbWUgPT0gJ2JyZXdtYXN0ZXJfdGh1bmRlcl9jbGFwJykge1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgdG90YWxBdHRyaWJ1dGUgLT0gc2VsZi5nZXRBYmlsaXR5QXR0cmlidXRlVmFsdWUoc2VsZi5hYmlsaXRpZXMoKVtpXS5hdHRyaWJ1dGVzLCBhdHRyaWJ1dGUubmFtZSwgYWJpbGl0eS5sZXZlbCgpKTtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICAgICAgICAgICAgICAgIGJyZWFrO1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgIC8vIG1lZHVzYV9zdG9uZV9nYXplXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgY2FzZSAnc2xvdyc6XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIGlmIChhYmlsaXR5Lm5hbWUgPT0gJ21lZHVzYV9zdG9uZV9nYXplJykge1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgdG90YWxBdHRyaWJ1dGUgLT0gc2VsZi5nZXRBYmlsaXR5QXR0cmlidXRlVmFsdWUoc2VsZi5hYmlsaXRpZXMoKVtpXS5hdHRyaWJ1dGVzLCBhdHRyaWJ1dGUubmFtZSwgYWJpbGl0eS5sZXZlbCgpKTtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICAgICAgICAgICAgICAgIGJyZWFrO1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgIC8vIHZpc2FnZV9ncmF2ZV9jaGlsbFxuICAgICAgICAgICAgICAgICAgICAgICAgICAgIGNhc2UgJ2F0dGFja3NwZWVkX2JvbnVzJzpcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgdG90YWxBdHRyaWJ1dGUgLT0gc2VsZi5nZXRBYmlsaXR5QXR0cmlidXRlVmFsdWUoc2VsZi5hYmlsaXRpZXMoKVtpXS5hdHRyaWJ1dGVzLCBhdHRyaWJ1dGUubmFtZSwgYWJpbGl0eS5sZXZlbCgpKTtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICBicmVhaztcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAvLyBhYmFkZG9uX2Zyb3N0bW91cm5lXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgY2FzZSAnYXR0YWNrX3Nsb3dfdG9vbHRpcCc6XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIGlmIChhYmlsaXR5Lm5hbWUgPT0gJ2FiYWRkb25fZnJvc3Rtb3VybmUnKSB7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICB0b3RhbEF0dHJpYnV0ZSAtPSBzZWxmLmdldEFiaWxpdHlBdHRyaWJ1dGVWYWx1ZShzZWxmLmFiaWxpdGllcygpW2ldLmF0dHJpYnV0ZXMsIGF0dHJpYnV0ZS5uYW1lLCBhYmlsaXR5LmxldmVsKCkpO1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgYnJlYWs7XG4gICAgICAgICAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgICAgICAgaWYgKGFiaWxpdHkubmFtZSA9PSAnZW5yYWdlZF93aWxka2luX3Rvcm5hZG8nKSB7XG4gICAgICAgICAgICAgICAgICAgICAgICB0b3RhbEF0dHJpYnV0ZSAtPSAxNTtcbiAgICAgICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgIH1cbiAgICAgICAgICAgIGVsc2UgaWYgKGFiaWxpdHkuYXR0YWNrc3BlZWRyZWR1Y3Rpb24gIT0gdW5kZWZpbmVkKSB7XG4gICAgICAgICAgICAgICAgaWYgKGFiaWxpdHkubGV2ZWwoKSA+IDAgJiYgKGFiaWxpdHkuaXNBY3RpdmUoKSB8fCAoYWJpbGl0eS5iZWhhdmlvci5pbmRleE9mKCdET1RBX0FCSUxJVFlfQkVIQVZJT1JfUEFTU0lWRScpICE9IC0xKSkpIHtcbiAgICAgICAgICAgICAgICAgICAgLy8gdmlwZXJfdmlwZXJfc3RyaWtlLHZpcGVyX2NvcnJvc2l2ZV9za2luLGpha2lyb19saXF1aWRfZmlyZSxsaWNoX2NoYWluX2Zyb3N0LHNhbmRraW5nX2VwaWNlbnRlcixlYXJ0aF9zcGlyaXRfcm9sbGluZ19ib3VsZGVyXG4gICAgICAgICAgICAgICAgICAgIHRvdGFsQXR0cmlidXRlKz1hYmlsaXR5LmF0dGFja3NwZWVkcmVkdWN0aW9uKCk7XG4gICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgfVxuICAgICAgICB9XG4gICAgICAgIHJldHVybiB0b3RhbEF0dHJpYnV0ZTtcbiAgICB9KTtcbiAgICBzZWxmLmdldEJhc2ggPSBrby5jb21wdXRlZChmdW5jdGlvbiAoKSB7XG4gICAgICAgIHZhciB0b3RhbEF0dHJpYnV0ZSA9IDE7XG4gICAgICAgIGZvciAodmFyIGkgPSAwOyBpIDwgc2VsZi5hYmlsaXRpZXMoKS5sZW5ndGg7IGkrKykge1xuICAgICAgICAgICAgdmFyIGFiaWxpdHkgPSBzZWxmLmFiaWxpdGllcygpW2ldO1xuICAgICAgICAgICAgaWYgKCEoYWJpbGl0eS5uYW1lIGluIHNlbGYuYWJpbGl0eURhdGEpKSB7XG4gICAgICAgICAgICAgICAgaWYgKGFiaWxpdHkubGV2ZWwoKSA+IDAgJiYgKGFiaWxpdHkuaXNBY3RpdmUoKSB8fCAoYWJpbGl0eS5iZWhhdmlvci5pbmRleE9mKCdET1RBX0FCSUxJVFlfQkVIQVZJT1JfUEFTU0lWRScpICE9IC0xKSkpIHtcbiAgICAgICAgICAgICAgICAgICAgZm9yICh2YXIgaiA9IDA7IGogPCBzZWxmLmFiaWxpdGllcygpW2ldLmF0dHJpYnV0ZXMubGVuZ3RoOyBqKyspIHtcbiAgICAgICAgICAgICAgICAgICAgICAgIHZhciBhdHRyaWJ1dGUgPSBzZWxmLmFiaWxpdGllcygpW2ldLmF0dHJpYnV0ZXNbal07XG4gICAgICAgICAgICAgICAgICAgICAgICBzd2l0Y2goYXR0cmlidXRlLm5hbWUpIHtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAvLyBzbGFyZGFyX2Jhc2hcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICBjYXNlICdjaGFuY2UnOlxuICAgICAgICAgICAgICAgICAgICAgICAgICAgIC8vIHNuaXBlcl9oZWFkc2hvdFxuICAgICAgICAgICAgICAgICAgICAgICAgICAgIGNhc2UgJ3Byb2NfY2hhbmNlJzpcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgdG90YWxBdHRyaWJ1dGUgKj0gKDEgLSBzZWxmLmdldEFiaWxpdHlBdHRyaWJ1dGVWYWx1ZShzZWxmLmFiaWxpdGllcygpW2ldLmF0dHJpYnV0ZXMsIGF0dHJpYnV0ZS5uYW1lLCBhYmlsaXR5LmxldmVsKCkpLzEwMCk7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgYnJlYWs7XG4gICAgICAgICAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICB9XG4gICAgICAgICAgICBlbHNlIGlmIChhYmlsaXR5LmJhc2ggIT0gdW5kZWZpbmVkKSB7XG4gICAgICAgICAgICAgICAgLy8gc3Bpcml0X2JyZWFrZXJfZ3JlYXRlcl9iYXNoLGZhY2VsZXNzX3ZvaWRfdGltZV9sb2NrXG4gICAgICAgICAgICAgICAgaWYgKGFiaWxpdHkubGV2ZWwoKSA+IDAgJiYgKGFiaWxpdHkuaXNBY3RpdmUoKSB8fCAoYWJpbGl0eS5iZWhhdmlvci5pbmRleE9mKCdET1RBX0FCSUxJVFlfQkVIQVZJT1JfUEFTU0lWRScpICE9IC0xKSkpIHtcbiAgICAgICAgICAgICAgICAgICAgdG90YWxBdHRyaWJ1dGUgKj0gKDEgLSBhYmlsaXR5LmJhc2goKS8xMDApO1xuICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgIH1cbiAgICAgICAgfVxuICAgICAgICByZXR1cm4gdG90YWxBdHRyaWJ1dGU7XG4gICAgfSk7ICAgIFxuICAgIHNlbGYuZ2V0QmFzZURhbWFnZSA9IGtvLmNvbXB1dGVkKGZ1bmN0aW9uICgpIHtcbiAgICAgICAgdmFyIHRvdGFsQXR0cmlidXRlID0gMDtcbiAgICAgICAgdmFyIHRvdGFsTXVsdGlwbGllciA9IDE7XG4gICAgICAgIHZhciBzb3VyY2VzID0ge307XG4gICAgICAgIGZvciAodmFyIGkgPSAwOyBpIDwgc2VsZi5hYmlsaXRpZXMoKS5sZW5ndGg7IGkrKykge1xuICAgICAgICAgICAgdmFyIGFiaWxpdHkgPSBzZWxmLmFiaWxpdGllcygpW2ldO1xuICAgICAgICAgICAgaWYgKCEoYWJpbGl0eS5uYW1lIGluIHNlbGYuYWJpbGl0eURhdGEpKSB7XG4gICAgICAgICAgICAgICAgaWYgKGFiaWxpdHkubGV2ZWwoKSA+IDAgJiYgKGFiaWxpdHkuaXNBY3RpdmUoKSB8fCAoYWJpbGl0eS5iZWhhdmlvci5pbmRleE9mKCdET1RBX0FCSUxJVFlfQkVIQVZJT1JfUEFTU0lWRScpICE9IC0xKSkpIHtcbiAgICAgICAgICAgICAgICAgICAgZm9yICh2YXIgaiA9IDA7IGogPCBzZWxmLmFiaWxpdGllcygpW2ldLmF0dHJpYnV0ZXMubGVuZ3RoOyBqKyspIHtcbiAgICAgICAgICAgICAgICAgICAgICAgIHZhciBhdHRyaWJ1dGUgPSBzZWxmLmFiaWxpdGllcygpW2ldLmF0dHJpYnV0ZXNbal07XG4gICAgICAgICAgICAgICAgICAgICAgICBzd2l0Y2goYXR0cmlidXRlLm5hbWUpIHtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAvLyB0aW55X2dyb3csdGVycm9yYmxhZGVfbWV0YW1vcnBob3Npc1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgIGNhc2UgJ2JvbnVzX2RhbWFnZSc6XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIGlmIChhYmlsaXR5Lm5hbWUgPT0gJ3RpbnlfZ3JvdycgfHwgYWJpbGl0eS5uYW1lID09ICd0ZXJyb3JibGFkZV9tZXRhbW9ycGhvc2lzJykge1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgdG90YWxBdHRyaWJ1dGUgKz0gc2VsZi5nZXRBYmlsaXR5QXR0cmlidXRlVmFsdWUoc2VsZi5hYmlsaXRpZXMoKVtpXS5hdHRyaWJ1dGVzLCBhdHRyaWJ1dGUubmFtZSwgYWJpbGl0eS5sZXZlbCgpKTtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIHNvdXJjZXNbYWJpbGl0eS5uYW1lXSA9IHtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAnZGFtYWdlJzogc2VsZi5nZXRBYmlsaXR5QXR0cmlidXRlVmFsdWUoc2VsZi5hYmlsaXRpZXMoKVtpXS5hdHRyaWJ1dGVzLCBhdHRyaWJ1dGUubmFtZSwgYWJpbGl0eS5sZXZlbCgpKSxcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAnZGFtYWdlVHlwZSc6ICdwaHlzaWNhbCcsXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgJ2Rpc3BsYXluYW1lJzogYWJpbGl0eS5kaXNwbGF5bmFtZVxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgYnJlYWs7XG4gICAgICAgICAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICB9XG4gICAgICAgICAgICBlbHNlIHtcbiAgICAgICAgICAgICAgICBpZiAoYWJpbGl0eS5iYXNlRGFtYWdlTXVsdGlwbGllciAhPSB1bmRlZmluZWQpIHtcbiAgICAgICAgICAgICAgICAgICAgLy8gZWFydGhzaGFrZXJfZW5jaGFudF90b3RlbVxuICAgICAgICAgICAgICAgICAgICBpZiAoYWJpbGl0eS5sZXZlbCgpID4gMCAmJiAoYWJpbGl0eS5pc0FjdGl2ZSgpIHx8IChhYmlsaXR5LmJlaGF2aW9yLmluZGV4T2YoJ0RPVEFfQUJJTElUWV9CRUhBVklPUl9QQVNTSVZFJykgIT0gLTEpKSkge1xuICAgICAgICAgICAgICAgICAgICAgICAgdG90YWxNdWx0aXBsaWVyICs9IGFiaWxpdHkuYmFzZURhbWFnZU11bHRpcGxpZXIoKS8xMDA7XG4gICAgICAgICAgICAgICAgICAgICAgICAvKnRvdGFsQXR0cmlidXRlICs9IGFiaWxpdHkuYmFzZURhbWFnZSgpO1xuICAgICAgICAgICAgICAgICAgICAgICAgc291cmNlc1thYmlsaXR5Lm5hbWVdID0ge1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgICdkYW1hZ2UnOiBhYmlsaXR5LmJhc2VEYW1hZ2UoKSxcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAnZGFtYWdlVHlwZSc6ICdwaHlzaWNhbCcsXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgJ2Rpc3BsYXluYW1lJzogYWJpbGl0eS5kaXNwbGF5bmFtZVxuICAgICAgICAgICAgICAgICAgICAgICAgfSovXG4gICAgICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgICAgaWYgKGFiaWxpdHkuYmFzZURhbWFnZSAhPSB1bmRlZmluZWQpIHtcbiAgICAgICAgICAgICAgICAgICAgLy8gY2xpbmt6X2RlYXRoX3BhY3RcbiAgICAgICAgICAgICAgICAgICAgaWYgKGFiaWxpdHkubGV2ZWwoKSA+IDAgJiYgKGFiaWxpdHkuaXNBY3RpdmUoKSB8fCAoYWJpbGl0eS5iZWhhdmlvci5pbmRleE9mKCdET1RBX0FCSUxJVFlfQkVIQVZJT1JfUEFTU0lWRScpICE9IC0xKSkpIHtcbiAgICAgICAgICAgICAgICAgICAgICAgIHRvdGFsQXR0cmlidXRlICs9IGFiaWxpdHkuYmFzZURhbWFnZSgpO1xuICAgICAgICAgICAgICAgICAgICAgICAgc291cmNlc1thYmlsaXR5Lm5hbWVdID0ge1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgICdkYW1hZ2UnOiBhYmlsaXR5LmJhc2VEYW1hZ2UoKSxcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAnZGFtYWdlVHlwZSc6ICdwaHlzaWNhbCcsXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgJ2Rpc3BsYXluYW1lJzogYWJpbGl0eS5kaXNwbGF5bmFtZVxuICAgICAgICAgICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgfVxuICAgICAgICB9XG4gICAgICAgIHJldHVybiB7IHNvdXJjZXM6IHNvdXJjZXMsIHRvdGFsOiB0b3RhbEF0dHJpYnV0ZSwgbXVsdGlwbGllcjogdG90YWxNdWx0aXBsaWVyIH07XG4gICAgfSk7XG4gICAgXG4gICAgc2VsZi5nZXRTZWxmQmFzZURhbWFnZVJlZHVjdGlvblBjdCA9IGtvLmNvbXB1dGVkKGZ1bmN0aW9uICgpIHtcbiAgICAgICAgdmFyIHRvdGFsQXR0cmlidXRlID0gMTtcbiAgICAgICAgZm9yICh2YXIgaSA9IDA7IGkgPCBzZWxmLmFiaWxpdGllcygpLmxlbmd0aDsgaSsrKSB7XG4gICAgICAgICAgICB2YXIgYWJpbGl0eSA9IHNlbGYuYWJpbGl0aWVzKClbaV07XG4gICAgICAgICAgICBpZiAoIShhYmlsaXR5Lm5hbWUgaW4gc2VsZi5hYmlsaXR5RGF0YSkpIHtcbiAgICAgICAgICAgICAgICBpZiAoYWJpbGl0eS5sZXZlbCgpID4gMCAmJiAoYWJpbGl0eS5pc0FjdGl2ZSgpIHx8IChhYmlsaXR5LmJlaGF2aW9yLmluZGV4T2YoJ0RPVEFfQUJJTElUWV9CRUhBVklPUl9QQVNTSVZFJykgIT0gLTEpKSkge1xuICAgICAgICAgICAgICAgICAgICBmb3IgKHZhciBqID0gMDsgaiA8IHNlbGYuYWJpbGl0aWVzKClbaV0uYXR0cmlidXRlcy5sZW5ndGg7IGorKykge1xuICAgICAgICAgICAgICAgICAgICAgICAgdmFyIGF0dHJpYnV0ZSA9IHNlbGYuYWJpbGl0aWVzKClbaV0uYXR0cmlidXRlc1tqXTtcbiAgICAgICAgICAgICAgICAgICAgICAgIHN3aXRjaChhdHRyaWJ1dGUubmFtZSkge1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgIC8vIG1lZHVzYV9zcGxpdF9zaG90XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgY2FzZSAnZGFtYWdlX21vZGlmaWVyJzpcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgdG90YWxBdHRyaWJ1dGUgKj0gKDEgKyBzZWxmLmdldEFiaWxpdHlBdHRyaWJ1dGVWYWx1ZShzZWxmLmFiaWxpdGllcygpW2ldLmF0dHJpYnV0ZXMsIGF0dHJpYnV0ZS5uYW1lLCBhYmlsaXR5LmxldmVsKCkpLzEwMCk7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgYnJlYWs7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgLy8gd2luZHJ1bm5lcl9mb2N1c2ZpcmVcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICBjYXNlICdmb2N1c2ZpcmVfZGFtYWdlX3JlZHVjdGlvbic6XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIGlmICghc2VsZi5oYXNTY2VwdGVyKCkpIHtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIHRvdGFsQXR0cmlidXRlICo9ICgxICsgc2VsZi5nZXRBYmlsaXR5QXR0cmlidXRlVmFsdWUoc2VsZi5hYmlsaXRpZXMoKVtpXS5hdHRyaWJ1dGVzLCBhdHRyaWJ1dGUubmFtZSwgYWJpbGl0eS5sZXZlbCgpKS8xMDApO1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgYnJlYWs7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgY2FzZSAnZm9jdXNmaXJlX2RhbWFnZV9yZWR1Y3Rpb25fc2NlcHRlcic6XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIGlmIChzZWxmLmhhc1NjZXB0ZXIoKSkge1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgdG90YWxBdHRyaWJ1dGUgKj0gKDEgKyBzZWxmLmdldEFiaWxpdHlBdHRyaWJ1dGVWYWx1ZShzZWxmLmFiaWxpdGllcygpW2ldLmF0dHJpYnV0ZXMsIGF0dHJpYnV0ZS5uYW1lLCBhYmlsaXR5LmxldmVsKCkpLzEwMCk7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgICAgICAgICAgICAgICBicmVhaztcbiAgICAgICAgICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgIH1cbiAgICAgICAgfVxuICAgICAgICByZXR1cm4gdG90YWxBdHRyaWJ1dGU7XG4gICAgfSk7XG4gICAgXG4gICAgc2VsZi5nZXRCYXNlRGFtYWdlUmVkdWN0aW9uUGN0ID0ga28uY29tcHV0ZWQoZnVuY3Rpb24gKCkge1xuICAgICAgICB2YXIgdG90YWxBdHRyaWJ1dGUgPSAxO1xuICAgICAgICBmb3IgKHZhciBpID0gMDsgaSA8IHNlbGYuYWJpbGl0aWVzKCkubGVuZ3RoOyBpKyspIHtcbiAgICAgICAgICAgIHZhciBhYmlsaXR5ID0gc2VsZi5hYmlsaXRpZXMoKVtpXTtcbiAgICAgICAgICAgIGlmICghKGFiaWxpdHkubmFtZSBpbiBzZWxmLmFiaWxpdHlEYXRhKSkge1xuICAgICAgICAgICAgICAgIGlmIChhYmlsaXR5LmxldmVsKCkgPiAwICYmIChhYmlsaXR5LmlzQWN0aXZlKCkgfHwgKGFiaWxpdHkuYmVoYXZpb3IuaW5kZXhPZignRE9UQV9BQklMSVRZX0JFSEFWSU9SX1BBU1NJVkUnKSAhPSAtMSkpKSB7XG4gICAgICAgICAgICAgICAgICAgIGZvciAodmFyIGogPSAwOyBqIDwgc2VsZi5hYmlsaXRpZXMoKVtpXS5hdHRyaWJ1dGVzLmxlbmd0aDsgaisrKSB7XG4gICAgICAgICAgICAgICAgICAgICAgICB2YXIgYXR0cmlidXRlID0gc2VsZi5hYmlsaXRpZXMoKVtpXS5hdHRyaWJ1dGVzW2pdO1xuICAgICAgICAgICAgICAgICAgICAgICAgc3dpdGNoKGF0dHJpYnV0ZS5uYW1lKSB7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgLy8gdmVuZ2VmdWxzcGlyaXRfY29tbWFuZF9hdXJhXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgY2FzZSAnYm9udXNfZGFtYWdlX3BjdCc6XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIGlmIChhYmlsaXR5Lm5hbWUgPT0gJ3ZlbmdlZnVsc3Bpcml0X2NvbW1hbmRfYXVyYScpIHtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIHRvdGFsQXR0cmlidXRlICo9ICgxIC0gc2VsZi5nZXRBYmlsaXR5QXR0cmlidXRlVmFsdWUoc2VsZi5hYmlsaXRpZXMoKVtpXS5hdHRyaWJ1dGVzLCBhdHRyaWJ1dGUubmFtZSwgYWJpbGl0eS5sZXZlbCgpKS8xMDApO1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgYnJlYWs7XG4gICAgICAgICAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICB9XG4gICAgICAgICAgICBlbHNlIGlmIChhYmlsaXR5LmJhc2VEYW1hZ2VSZWR1Y3Rpb25QY3QgIT0gdW5kZWZpbmVkKSB7XG4gICAgICAgICAgICAgICAgaWYgKGFiaWxpdHkubGV2ZWwoKSA+IDAgJiYgKGFiaWxpdHkuaXNBY3RpdmUoKSB8fCAoYWJpbGl0eS5iZWhhdmlvci5pbmRleE9mKCdET1RBX0FCSUxJVFlfQkVIQVZJT1JfUEFTU0lWRScpICE9IC0xKSkpIHtcbiAgICAgICAgICAgICAgICAgICAgLy8gbmV2ZXJtb3JlX3JlcXVpZW1cbiAgICAgICAgICAgICAgICAgICAgdG90YWxBdHRyaWJ1dGUgKj0gKDEgKyBhYmlsaXR5LmJhc2VEYW1hZ2VSZWR1Y3Rpb25QY3QoKS8xMDApO1xuICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgIH1cbiAgICAgICAgfVxuICAgICAgICByZXR1cm4gdG90YWxBdHRyaWJ1dGU7XG4gICAgfSk7XG4gICAgXG4gICAgc2VsZi5nZXRCQVQgPSBrby5jb21wdXRlZChmdW5jdGlvbiAoKSB7XG4gICAgICAgIHZhciB0b3RhbEF0dHJpYnV0ZSA9IDA7XG4gICAgICAgIGZvciAodmFyIGkgPSAwOyBpIDwgc2VsZi5hYmlsaXRpZXMoKS5sZW5ndGg7IGkrKykge1xuICAgICAgICAgICAgdmFyIGFiaWxpdHkgPSBzZWxmLmFiaWxpdGllcygpW2ldO1xuICAgICAgICAgICAgaWYgKCEoYWJpbGl0eS5uYW1lIGluIHNlbGYuYWJpbGl0eURhdGEpKSB7XG4gICAgICAgICAgICAgICAgaWYgKGFiaWxpdHkubGV2ZWwoKSA+IDAgJiYgKGFiaWxpdHkuaXNBY3RpdmUoKSB8fCAoYWJpbGl0eS5iZWhhdmlvci5pbmRleE9mKCdET1RBX0FCSUxJVFlfQkVIQVZJT1JfUEFTU0lWRScpICE9IC0xKSkpIHtcbiAgICAgICAgICAgICAgICAgICAgZm9yICh2YXIgaiA9IDA7IGogPCBzZWxmLmFiaWxpdGllcygpW2ldLmF0dHJpYnV0ZXMubGVuZ3RoOyBqKyspIHtcbiAgICAgICAgICAgICAgICAgICAgICAgIHZhciBhdHRyaWJ1dGUgPSBzZWxmLmFiaWxpdGllcygpW2ldLmF0dHJpYnV0ZXNbal07XG4gICAgICAgICAgICAgICAgICAgICAgICBzd2l0Y2goYXR0cmlidXRlLm5hbWUpIHtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAvLyB0cm9sbF93YXJsb3JkX2JlcnNlcmtlcnNfcmFnZSxhbGNoZW1pc3RfY2hlbWljYWxfcmFnZSxsb25lX2RydWlkX3RydWVfZm9ybSxseWNhbl9zaGFwZXNoaWZ0XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgY2FzZSAnYmFzZV9hdHRhY2tfdGltZSc6XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIHRvdGFsQXR0cmlidXRlICs9IHNlbGYuZ2V0QWJpbGl0eUF0dHJpYnV0ZVZhbHVlKHNlbGYuYWJpbGl0aWVzKClbaV0uYXR0cmlidXRlcywgYXR0cmlidXRlLm5hbWUsIGFiaWxpdHkubGV2ZWwoKSk7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgYnJlYWs7XG4gICAgICAgICAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICB9XG4gICAgICAgIH1cbiAgICAgICAgcmV0dXJuIHRvdGFsQXR0cmlidXRlO1xuICAgIH0pO1xuICAgIHNlbGYuZ2V0Qm9udXNEYW1hZ2UgPSBrby5jb21wdXRlZChmdW5jdGlvbiAoKSB7XG4gICAgICAgIHZhciB0b3RhbEF0dHJpYnV0ZSA9IDA7XG4gICAgICAgIHZhciBzb3VyY2VzID0ge307XG4gICAgICAgIGZvciAodmFyIGkgPSAwOyBpIDwgc2VsZi5hYmlsaXRpZXMoKS5sZW5ndGg7IGkrKykge1xuICAgICAgICAgICAgdmFyIGFiaWxpdHkgPSBzZWxmLmFiaWxpdGllcygpW2ldO1xuICAgICAgICAgICAgaWYgKCEoYWJpbGl0eS5uYW1lIGluIHNlbGYuYWJpbGl0eURhdGEpKSB7XG4gICAgICAgICAgICAgICAgaWYgKGFiaWxpdHkubGV2ZWwoKSA+IDAgJiYgKGFiaWxpdHkuaXNBY3RpdmUoKSB8fCAoYWJpbGl0eS5iZWhhdmlvci5pbmRleE9mKCdET1RBX0FCSUxJVFlfQkVIQVZJT1JfUEFTU0lWRScpICE9IC0xKSkpIHtcbiAgICAgICAgICAgICAgICAgICAgZm9yICh2YXIgaiA9IDA7IGogPCBzZWxmLmFiaWxpdGllcygpW2ldLmF0dHJpYnV0ZXMubGVuZ3RoOyBqKyspIHtcbiAgICAgICAgICAgICAgICAgICAgICAgIHZhciBhdHRyaWJ1dGUgPSBzZWxmLmFiaWxpdGllcygpW2ldLmF0dHJpYnV0ZXNbal07XG4gICAgICAgICAgICAgICAgICAgICAgICBzd2l0Y2goYXR0cmlidXRlLm5hbWUpIHtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAvLyBicm9vZG1vdGhlcl9pbnNhdGlhYmxlX2h1bmdlcixsdW5hX2x1bmFyX2JsZXNzaW5nLHRlbXBsYXJfYXNzYXNzaW5fcmVmcmFjdGlvbix0ZW1wbGFyX2Fzc2Fzc2luX21lbGQsdHJvbGxfd2FybG9yZF9iZXJzZXJrZXJzX3JhZ2UsbG9uZV9kcnVpZF90cnVlX2Zvcm1fYmF0dGxlX2NyeVxuICAgICAgICAgICAgICAgICAgICAgICAgICAgIGNhc2UgJ2JvbnVzX2RhbWFnZSc6XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIGlmIChhYmlsaXR5Lm5hbWUgPT0gJ2Jyb29kbW90aGVyX2luc2F0aWFibGVfaHVuZ2VyJyB8fCBhYmlsaXR5Lm5hbWUgPT0gJ2x1bmFfbHVuYXJfYmxlc3NpbmcnXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICB8fCBhYmlsaXR5Lm5hbWUgPT0gJ3RlbXBsYXJfYXNzYXNzaW5fcmVmcmFjdGlvbicgfHwgYWJpbGl0eS5uYW1lID09ICd0ZW1wbGFyX2Fzc2Fzc2luX21lbGQnXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICB8fCBhYmlsaXR5Lm5hbWUgPT0gJ3Ryb2xsX3dhcmxvcmRfYmVyc2Vya2Vyc19yYWdlJyB8fCBhYmlsaXR5Lm5hbWUgPT0gJ2xvbmVfZHJ1aWRfdHJ1ZV9mb3JtX2JhdHRsZV9jcnknKSB7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICB0b3RhbEF0dHJpYnV0ZSArPSBzZWxmLmdldEFiaWxpdHlBdHRyaWJ1dGVWYWx1ZShzZWxmLmFiaWxpdGllcygpW2ldLmF0dHJpYnV0ZXMsIGF0dHJpYnV0ZS5uYW1lLCBhYmlsaXR5LmxldmVsKCkpO1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgc291cmNlc1thYmlsaXR5Lm5hbWVdID0ge1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICdkYW1hZ2UnOiBzZWxmLmdldEFiaWxpdHlBdHRyaWJ1dGVWYWx1ZShzZWxmLmFiaWxpdGllcygpW2ldLmF0dHJpYnV0ZXMsIGF0dHJpYnV0ZS5uYW1lLCBhYmlsaXR5LmxldmVsKCkpLFxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICdkYW1hZ2VUeXBlJzogJ3BoeXNpY2FsJyxcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAnZGlzcGxheW5hbWUnOiBhYmlsaXR5LmRpc3BsYXluYW1lXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgICAgICAgICAgICAgICBicmVhaztcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAvLyBseWNhbl9ob3dsXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgY2FzZSAnaGVyb19ib251c19kYW1hZ2UnOlxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICB0b3RhbEF0dHJpYnV0ZSArPSBzZWxmLmdldEFiaWxpdHlBdHRyaWJ1dGVWYWx1ZShzZWxmLmFiaWxpdGllcygpW2ldLmF0dHJpYnV0ZXMsIGF0dHJpYnV0ZS5uYW1lLCBhYmlsaXR5LmxldmVsKCkpO1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBzb3VyY2VzW2FiaWxpdHkubmFtZV0gPSB7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAnZGFtYWdlJzogc2VsZi5nZXRBYmlsaXR5QXR0cmlidXRlVmFsdWUoc2VsZi5hYmlsaXRpZXMoKVtpXS5hdHRyaWJ1dGVzLCBhdHRyaWJ1dGUubmFtZSwgYWJpbGl0eS5sZXZlbCgpKSxcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICdkYW1hZ2VUeXBlJzogJ3BoeXNpY2FsJyxcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICdkaXNwbGF5bmFtZSc6IGFiaWxpdHkuZGlzcGxheW5hbWVcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICAgICAgICAgICAgICAgIGJyZWFrO1xuICAgICAgICAgICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgICAgICAgIGlmIChhYmlsaXR5Lm5hbWUgPT0gJ3N0b3JtX3NwaXJpdF9vdmVybG9hZCcpIHtcbiAgICAgICAgICAgICAgICAgICAgICAgIHRvdGFsQXR0cmlidXRlICs9IHNlbGYuZ2V0QWJpbGl0eVByb3BlcnR5VmFsdWUoYWJpbGl0eSwgJ2RhbWFnZScpO1xuICAgICAgICAgICAgICAgICAgICAgICAgc291cmNlc1thYmlsaXR5Lm5hbWVdID0ge1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgICdkYW1hZ2UnOiBzZWxmLmdldEFiaWxpdHlQcm9wZXJ0eVZhbHVlKGFiaWxpdHksICdkYW1hZ2UnKSxcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAnZGFtYWdlVHlwZSc6ICdtYWdpYycsXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgJ2Rpc3BsYXluYW1lJzogYWJpbGl0eS5kaXNwbGF5bmFtZVxuICAgICAgICAgICAgICAgICAgICAgICAgfSAgICAgICAgICAgICAgICAgICAgICAgIFxuICAgICAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgfVxuICAgICAgICAgICAgZWxzZSBpZiAoYWJpbGl0eS5ib251c0RhbWFnZSAhPSB1bmRlZmluZWQgJiYgYWJpbGl0eS5ib251c0RhbWFnZSgpICE9IDApIHtcbiAgICAgICAgICAgICAgICBpZiAoYWJpbGl0eS5sZXZlbCgpID4gMCAmJiAoYWJpbGl0eS5pc0FjdGl2ZSgpIHx8IChhYmlsaXR5LmJlaGF2aW9yLmluZGV4T2YoJ0RPVEFfQUJJTElUWV9CRUhBVklPUl9QQVNTSVZFJykgIT0gLTEpKSkge1xuICAgICAgICAgICAgICAgICAgICAvLyBuZXZlcm1vcmVfbmVjcm9tYXN0ZXJ5LHVyc2FfZnVyeV9zd2lwZXMsdXJzYV9lbnJhZ2UsaW52b2tlcl9hbGFjcml0eSxpbnZva2VyX2V4b3J0LGVsZGVyX3RpdGFuX2FuY2VzdHJhbF9zcGlyaXQsc3BlY3RyZV9kZXNvbGF0ZSxyYXpvcl9zdGF0aWNfbGlua1xuICAgICAgICAgICAgICAgICAgICB0b3RhbEF0dHJpYnV0ZSs9YWJpbGl0eS5ib251c0RhbWFnZSgpO1xuICAgICAgICAgICAgICAgICAgICBzb3VyY2VzW2FiaWxpdHkubmFtZV0gPSB7XG4gICAgICAgICAgICAgICAgICAgICAgICAnZGFtYWdlJzogYWJpbGl0eS5ib251c0RhbWFnZSgpLFxuICAgICAgICAgICAgICAgICAgICAgICAgJ2RhbWFnZVR5cGUnOiBhYmlsaXR5Lm5hbWUgPT0gJ3NwZWN0cmVfZGVzb2xhdGUnID8gJ3B1cmUnIDogJ3BoeXNpY2FsJyxcbiAgICAgICAgICAgICAgICAgICAgICAgICdkaXNwbGF5bmFtZSc6IGFiaWxpdHkuZGlzcGxheW5hbWVcbiAgICAgICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgIH1cbiAgICAgICAgfVxuICAgICAgICByZXR1cm4geyBzb3VyY2VzOiBzb3VyY2VzLCB0b3RhbDogdG90YWxBdHRyaWJ1dGUgfTtcbiAgICB9KTtcblxuICAgIHNlbGYuZ2V0Qm9udXNEYW1hZ2VQZXJjZW50ID0ga28uY29tcHV0ZWQoZnVuY3Rpb24gKCkge1xuICAgICAgICB2YXIgdG90YWxBdHRyaWJ1dGUgPSAwO1xuICAgICAgICB2YXIgc291cmNlcyA9IHt9O1xuICAgICAgICBmb3IgKHZhciBpID0gMDsgaSA8IHNlbGYuYWJpbGl0aWVzKCkubGVuZ3RoOyBpKyspIHtcbiAgICAgICAgICAgIHZhciBhYmlsaXR5ID0gc2VsZi5hYmlsaXRpZXMoKVtpXTtcbiAgICAgICAgICAgIGlmICghKGFiaWxpdHkubmFtZSBpbiBzZWxmLmFiaWxpdHlEYXRhKSkge1xuICAgICAgICAgICAgICAgIGlmIChhYmlsaXR5LmxldmVsKCkgPiAwICYmIChhYmlsaXR5LmlzQWN0aXZlKCkgfHwgKGFiaWxpdHkuYmVoYXZpb3IuaW5kZXhPZignRE9UQV9BQklMSVRZX0JFSEFWSU9SX1BBU1NJVkUnKSAhPSAtMSkpKSB7XG4gICAgICAgICAgICAgICAgICAgIGZvciAodmFyIGogPSAwOyBqIDwgc2VsZi5hYmlsaXRpZXMoKVtpXS5hdHRyaWJ1dGVzLmxlbmd0aDsgaisrKSB7XG4gICAgICAgICAgICAgICAgICAgICAgICB2YXIgYXR0cmlidXRlID0gc2VsZi5hYmlsaXRpZXMoKVtpXS5hdHRyaWJ1dGVzW2pdO1xuICAgICAgICAgICAgICAgICAgICAgICAgc3dpdGNoKGF0dHJpYnV0ZS5uYW1lKSB7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgLy8gYmxvb2RzZWVrZXJfYmxvb2RyYWdlXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgY2FzZSAnZGFtYWdlX2luY3JlYXNlX3BjdCc6XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIGlmIChhYmlsaXR5Lm5hbWUgPT0gJ2Jsb29kc2Vla2VyX2Jsb29kcmFnZScpIHtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIHRvdGFsQXR0cmlidXRlICs9IHNlbGYuZ2V0QWJpbGl0eUF0dHJpYnV0ZVZhbHVlKHNlbGYuYWJpbGl0aWVzKClbaV0uYXR0cmlidXRlcywgYXR0cmlidXRlLm5hbWUsIGFiaWxpdHkubGV2ZWwoKSkvMTAwO1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgc291cmNlc1thYmlsaXR5Lm5hbWVdID0ge1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICdkYW1hZ2UnOiBzZWxmLmdldEFiaWxpdHlBdHRyaWJ1dGVWYWx1ZShzZWxmLmFiaWxpdGllcygpW2ldLmF0dHJpYnV0ZXMsIGF0dHJpYnV0ZS5uYW1lLCBhYmlsaXR5LmxldmVsKCkpLzEwMCxcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAnZGFtYWdlVHlwZSc6ICdwaHlzaWNhbCcsXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgJ2Rpc3BsYXluYW1lJzogYWJpbGl0eS5kaXNwbGF5bmFtZVxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgYnJlYWs7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgLy8gbWFnbmF0YXVyX2VtcG93ZXIsdmVuZ2VmdWxzcGlyaXRfY29tbWFuZF9hdXJhLGFscGhhX3dvbGZfY29tbWFuZF9hdXJhXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgY2FzZSAnYm9udXNfZGFtYWdlX3BjdCc6XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIGlmIChhYmlsaXR5Lm5hbWUgPT0gJ21hZ25hdGF1cl9lbXBvd2VyJyB8fCBhYmlsaXR5Lm5hbWUgPT0gJ3ZlbmdlZnVsc3Bpcml0X2NvbW1hbmRfYXVyYScgfHwgYWJpbGl0eS5uYW1lID09ICdhbHBoYV93b2xmX2NvbW1hbmRfYXVyYScpIHtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIHRvdGFsQXR0cmlidXRlICs9IHNlbGYuZ2V0QWJpbGl0eUF0dHJpYnV0ZVZhbHVlKHNlbGYuYWJpbGl0aWVzKClbaV0uYXR0cmlidXRlcywgYXR0cmlidXRlLm5hbWUsIGFiaWxpdHkubGV2ZWwoKSkvMTAwO1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgc291cmNlc1thYmlsaXR5Lm5hbWVdID0ge1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICdkYW1hZ2UnOiBzZWxmLmdldEFiaWxpdHlBdHRyaWJ1dGVWYWx1ZShzZWxmLmFiaWxpdGllcygpW2ldLmF0dHJpYnV0ZXMsIGF0dHJpYnV0ZS5uYW1lLCBhYmlsaXR5LmxldmVsKCkpLzEwMCxcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAnZGFtYWdlVHlwZSc6ICdwaHlzaWNhbCcsXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgJ2Rpc3BsYXluYW1lJzogYWJpbGl0eS5kaXNwbGF5bmFtZVxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgYnJlYWs7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgLy8gc3Zlbl9nb2RzX3N0cmVuZ3RoXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgY2FzZSAnZ29kc19zdHJlbmd0aF9kYW1hZ2UnOlxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBpZiAoYWJpbGl0eS5uYW1lID09ICdzdmVuX2dvZHNfc3RyZW5ndGgnICYmIHNlbGYuaGVybyAhPSB1bmRlZmluZWQgJiYgc2VsZi5oZXJvLmhlcm9JZCgpID09ICdzdmVuJykge1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgdG90YWxBdHRyaWJ1dGUgKz0gc2VsZi5nZXRBYmlsaXR5QXR0cmlidXRlVmFsdWUoc2VsZi5hYmlsaXRpZXMoKVtpXS5hdHRyaWJ1dGVzLCBhdHRyaWJ1dGUubmFtZSwgYWJpbGl0eS5sZXZlbCgpKS8xMDA7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBzb3VyY2VzW2FiaWxpdHkubmFtZV0gPSB7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgJ2RhbWFnZSc6IHNlbGYuZ2V0QWJpbGl0eUF0dHJpYnV0ZVZhbHVlKHNlbGYuYWJpbGl0aWVzKClbaV0uYXR0cmlidXRlcywgYXR0cmlidXRlLm5hbWUsIGFiaWxpdHkubGV2ZWwoKSkvMTAwLFxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICdkYW1hZ2VUeXBlJzogJ3BoeXNpY2FsJyxcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAnZGlzcGxheW5hbWUnOiBhYmlsaXR5LmRpc3BsYXluYW1lXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgICAgICAgICAgICAgICBicmVhaztcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICBjYXNlICdnb2RzX3N0cmVuZ3RoX2RhbWFnZV9zY2VwdGVyJzpcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgaWYgKGFiaWxpdHkubmFtZSA9PSAnc3Zlbl9nb2RzX3N0cmVuZ3RoJyAmJiBzZWxmLmhlcm8gPT0gdW5kZWZpbmVkKSB7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICB0b3RhbEF0dHJpYnV0ZSArPSBzZWxmLmdldEFiaWxpdHlBdHRyaWJ1dGVWYWx1ZShzZWxmLmFiaWxpdGllcygpW2ldLmF0dHJpYnV0ZXMsIGF0dHJpYnV0ZS5uYW1lLCBhYmlsaXR5LmxldmVsKCkpLzEwMDtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIHNvdXJjZXNbYWJpbGl0eS5uYW1lXSA9IHtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAnZGFtYWdlJzogc2VsZi5nZXRBYmlsaXR5QXR0cmlidXRlVmFsdWUoc2VsZi5hYmlsaXRpZXMoKVtpXS5hdHRyaWJ1dGVzLCBhdHRyaWJ1dGUubmFtZSwgYWJpbGl0eS5sZXZlbCgpKS8xMDAsXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgJ2RhbWFnZVR5cGUnOiAncGh5c2ljYWwnLFxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICdkaXNwbGF5bmFtZSc6IGFiaWxpdHkuZGlzcGxheW5hbWVcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICAgICAgICAgICAgICAgIGJyZWFrO1xuICAgICAgICAgICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgfVxuICAgICAgICAgICAgZWxzZSBpZiAoYWJpbGl0eS5ib251c0RhbWFnZVBjdCAhPSB1bmRlZmluZWQgJiYgYWJpbGl0eS5ib251c0RhbWFnZVBjdCgpICE9IDApIHtcbiAgICAgICAgICAgICAgICBpZiAoYWJpbGl0eS5sZXZlbCgpID4gMCAmJiAoYWJpbGl0eS5pc0FjdGl2ZSgpIHx8IChhYmlsaXR5LmJlaGF2aW9yLmluZGV4T2YoJ0RPVEFfQUJJTElUWV9CRUhBVklPUl9QQVNTSVZFJykgIT0gLTEpKSkge1xuICAgICAgICAgICAgICAgICAgICAvLyBibG9vZHNlZWtlcl9ibG9vZHJhZ2VcbiAgICAgICAgICAgICAgICAgICAgLyp0b3RhbEF0dHJpYnV0ZSs9YWJpbGl0eS5ib251c0RhbWFnZVBjdCgpLzEwMDtcbiAgICAgICAgICAgICAgICAgICAgc291cmNlc1thYmlsaXR5Lm5hbWVdID0ge1xuICAgICAgICAgICAgICAgICAgICAgICAgJ2RhbWFnZSc6IGFiaWxpdHkuYm9udXNEYW1hZ2VQY3QoKS8xMDAsXG4gICAgICAgICAgICAgICAgICAgICAgICAnZGFtYWdlVHlwZSc6ICdwaHlzaWNhbCcsXG4gICAgICAgICAgICAgICAgICAgICAgICAnZGlzcGxheW5hbWUnOiBhYmlsaXR5LmRpc3BsYXluYW1lXG4gICAgICAgICAgICAgICAgICAgIH0qL1xuICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgIH1cbiAgICAgICAgfVxuICAgICAgICByZXR1cm4geyBzb3VyY2VzOiBzb3VyY2VzLCB0b3RhbDogdG90YWxBdHRyaWJ1dGUgfTtcbiAgICB9KTtcblxuICAgIHNlbGYuZ2V0Qm9udXNEYW1hZ2VCYWNrc3RhYiA9IGtvLmNvbXB1dGVkKGZ1bmN0aW9uICgpIHtcbiAgICAgICAgdmFyIHRvdGFsQXR0cmlidXRlMSA9IDA7XG4gICAgICAgIHZhciB0b3RhbEF0dHJpYnV0ZTIgPSAwO1xuICAgICAgICB2YXIgc291cmNlcyA9IFtdO1xuICAgICAgICBmb3IgKHZhciBpID0gMDsgaSA8IHNlbGYuYWJpbGl0aWVzKCkubGVuZ3RoOyBpKyspIHtcbiAgICAgICAgICAgIHZhciBhYmlsaXR5ID0gc2VsZi5hYmlsaXRpZXMoKVtpXTtcbiAgICAgICAgICAgIGlmIChhYmlsaXR5Lm5hbWUgPT0gJ3Jpa2lfYmFja3N0YWInKSB7XG4gICAgICAgICAgICAgICAgaWYgKGFiaWxpdHkubGV2ZWwoKSA+IDAgJiYgKGFiaWxpdHkuaXNBY3RpdmUoKSB8fCAoYWJpbGl0eS5iZWhhdmlvci5pbmRleE9mKCdET1RBX0FCSUxJVFlfQkVIQVZJT1JfUEFTU0lWRScpICE9IC0xKSkpIHtcbiAgICAgICAgICAgICAgICAgICAgZm9yICh2YXIgaiA9IDA7IGogPCBzZWxmLmFiaWxpdGllcygpW2ldLmF0dHJpYnV0ZXMubGVuZ3RoOyBqKyspIHtcbiAgICAgICAgICAgICAgICAgICAgICAgIHZhciBhdHRyaWJ1dGUgPSBzZWxmLmFiaWxpdGllcygpW2ldLmF0dHJpYnV0ZXNbal07XG4gICAgICAgICAgICAgICAgICAgICAgICBzd2l0Y2goYXR0cmlidXRlLm5hbWUpIHtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAvLyByaWtpX2JhY2tzdGFiXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgY2FzZSAnZGFtYWdlX211bHRpcGxpZXInOlxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICB0b3RhbEF0dHJpYnV0ZTEgKz0gc2VsZi5nZXRBYmlsaXR5QXR0cmlidXRlVmFsdWUoc2VsZi5hYmlsaXRpZXMoKVtpXS5hdHRyaWJ1dGVzLCBhdHRyaWJ1dGUubmFtZSwgYWJpbGl0eS5sZXZlbCgpKTtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgc291cmNlcy5wdXNoKHtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICdkYW1hZ2UnOiBzZWxmLmdldEFiaWxpdHlBdHRyaWJ1dGVWYWx1ZShzZWxmLmFiaWxpdGllcygpW2ldLmF0dHJpYnV0ZXMsIGF0dHJpYnV0ZS5uYW1lLCBhYmlsaXR5LmxldmVsKCkpLFxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgJ2RhbWFnZVR5cGUnOiAncGh5c2ljYWwnLFxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgJ2Rpc3BsYXluYW1lJzogYWJpbGl0eS5kaXNwbGF5bmFtZVxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICB9KTtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICBicmVhaztcbiAgICAgICAgICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgICAgICAgfS8qXG4gICAgICAgICAgICAgICAgICAgIGlmIChhYmlsaXR5LmJvbnVzRGFtYWdlQmFja3N0YWIgIT0gdW5kZWZpbmVkKSB7XG4gICAgICAgICAgICAgICAgICAgICAgICBjb25zb2xlLmxvZygnYm9udXNEYW1hZ2VCYWNrc3RhYicpO1xuICAgICAgICAgICAgICAgICAgICAgICAgLy8gZGFtYWdlX211bHRpcGxpZXJcbiAgICAgICAgICAgICAgICAgICAgICAgIHRvdGFsQXR0cmlidXRlMis9YWJpbGl0eS5ib251c0RhbWFnZUJhY2tzdGFiKCk7XG4gICAgICAgICAgICAgICAgICAgICAgICBzb3VyY2VzLnB1c2goe1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgICdkYW1hZ2UnOiBhYmlsaXR5LmJvbnVzRGFtYWdlQmFja3N0YWIoKSxcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAnZGFtYWdlVHlwZSc6ICdwaHlzaWNhbCcsXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgJ2Rpc3BsYXluYW1lJzogYWJpbGl0eS5kaXNwbGF5bmFtZVxuICAgICAgICAgICAgICAgICAgICAgICAgfSk7XG4gICAgICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgICAgICAgKi9cbiAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICB9XG4gICAgICAgIH1cbiAgICAgICAgcmV0dXJuIHsgc291cmNlczogc291cmNlcywgdG90YWw6IFt0b3RhbEF0dHJpYnV0ZTEsdG90YWxBdHRyaWJ1dGUyXSB9O1xuICAgIH0pO1xuICAgIFxuICAgIHNlbGYuZ2V0Qm9udXNEYW1hZ2VQcmVjaXNpb25BdXJhID0ga28uY29tcHV0ZWQoZnVuY3Rpb24gKCkge1xuICAgICAgICB2YXIgdG90YWxBdHRyaWJ1dGUxID0gMDtcbiAgICAgICAgdmFyIHRvdGFsQXR0cmlidXRlMiA9IDA7XG4gICAgICAgIHZhciBzb3VyY2VzID0gW107XG4gICAgICAgIGZvciAodmFyIGkgPSAwOyBpIDwgc2VsZi5hYmlsaXRpZXMoKS5sZW5ndGg7IGkrKykge1xuICAgICAgICAgICAgdmFyIGFiaWxpdHkgPSBzZWxmLmFiaWxpdGllcygpW2ldO1xuICAgICAgICAgICAgaWYgKGFiaWxpdHkubmFtZSA9PSAnZHJvd19yYW5nZXJfdHJ1ZXNob3QnKSB7XG4gICAgICAgICAgICAgICAgaWYgKGFiaWxpdHkubGV2ZWwoKSA+IDAgJiYgKGFiaWxpdHkuaXNBY3RpdmUoKSB8fCAoYWJpbGl0eS5iZWhhdmlvci5pbmRleE9mKCdET1RBX0FCSUxJVFlfQkVIQVZJT1JfUEFTU0lWRScpICE9IC0xKSkpIHtcbiAgICAgICAgICAgICAgICAgICAgZm9yICh2YXIgaiA9IDA7IGogPCBzZWxmLmFiaWxpdGllcygpW2ldLmF0dHJpYnV0ZXMubGVuZ3RoOyBqKyspIHtcbiAgICAgICAgICAgICAgICAgICAgICAgIHZhciBhdHRyaWJ1dGUgPSBzZWxmLmFiaWxpdGllcygpW2ldLmF0dHJpYnV0ZXNbal07XG4gICAgICAgICAgICAgICAgICAgICAgICBzd2l0Y2goYXR0cmlidXRlLm5hbWUpIHtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAvLyBkcm93X3Jhbmdlcl90cnVlc2hvdFxuICAgICAgICAgICAgICAgICAgICAgICAgICAgIGNhc2UgJ3RydWVzaG90X3JhbmdlZF9kYW1hZ2UnOlxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICB0b3RhbEF0dHJpYnV0ZTEgKz0gc2VsZi5nZXRBYmlsaXR5QXR0cmlidXRlVmFsdWUoc2VsZi5hYmlsaXRpZXMoKVtpXS5hdHRyaWJ1dGVzLCBhdHRyaWJ1dGUubmFtZSwgYWJpbGl0eS5sZXZlbCgpKS8xMDA7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIHNvdXJjZXMucHVzaCh7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAnZGFtYWdlJzogc2VsZi5nZXRBYmlsaXR5QXR0cmlidXRlVmFsdWUoc2VsZi5hYmlsaXRpZXMoKVtpXS5hdHRyaWJ1dGVzLCBhdHRyaWJ1dGUubmFtZSwgYWJpbGl0eS5sZXZlbCgpKS8xMDAsXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAnZGFtYWdlVHlwZSc6ICdwaHlzaWNhbCcsXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAnZGlzcGxheW5hbWUnOiBhYmlsaXR5LmRpc3BsYXluYW1lXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIH0pO1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgIGJyZWFrO1xuICAgICAgICAgICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgICAgICAgIGlmIChhYmlsaXR5LmJvbnVzRGFtYWdlUHJlY2lzaW9uQXVyYSAhPSB1bmRlZmluZWQpIHtcbiAgICAgICAgICAgICAgICAgICAgICAgIC8vIGRyb3dfcmFuZ2VyX3RydWVzaG90XG4gICAgICAgICAgICAgICAgICAgICAgICB0b3RhbEF0dHJpYnV0ZTIrPWFiaWxpdHkuYm9udXNEYW1hZ2VQcmVjaXNpb25BdXJhKCk7XG4gICAgICAgICAgICAgICAgICAgICAgICBzb3VyY2VzLnB1c2goe1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgICdkYW1hZ2UnOiBhYmlsaXR5LmJvbnVzRGFtYWdlUHJlY2lzaW9uQXVyYSgpLFxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICdkYW1hZ2VUeXBlJzogJ3BoeXNpY2FsJyxcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAnZGlzcGxheW5hbWUnOiBhYmlsaXR5LmRpc3BsYXluYW1lXG4gICAgICAgICAgICAgICAgICAgICAgICB9KTtcbiAgICAgICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgIH1cbiAgICAgICAgfVxuICAgICAgICByZXR1cm4geyBzb3VyY2VzOiBzb3VyY2VzLCB0b3RhbDogW3RvdGFsQXR0cmlidXRlMSx0b3RhbEF0dHJpYnV0ZTJdIH07XG4gICAgfSk7XG4gICAgXG4gICAgc2VsZi5nZXRCb251c0RhbWFnZVJlZHVjdGlvbiA9IGtvLmNvbXB1dGVkKGZ1bmN0aW9uICgpIHtcbiAgICAgICAgdmFyIHRvdGFsQXR0cmlidXRlID0gMDtcbiAgICAgICAgZm9yICh2YXIgaSA9IDA7IGkgPCBzZWxmLmFiaWxpdGllcygpLmxlbmd0aDsgaSsrKSB7XG4gICAgICAgICAgICB2YXIgYWJpbGl0eSA9IHNlbGYuYWJpbGl0aWVzKClbaV07XG4gICAgICAgICAgICBpZiAoIShhYmlsaXR5Lm5hbWUgaW4gc2VsZi5hYmlsaXR5RGF0YSkpIHtcbiAgICAgICAgICAgICAgICBpZiAoYWJpbGl0eS5sZXZlbCgpID4gMCAmJiAoYWJpbGl0eS5pc0FjdGl2ZSgpIHx8IChhYmlsaXR5LmJlaGF2aW9yLmluZGV4T2YoJ0RPVEFfQUJJTElUWV9CRUhBVklPUl9QQVNTSVZFJykgIT0gLTEpKSkge1xuICAgICAgICAgICAgICAgICAgICBmb3IgKHZhciBqID0gMDsgaiA8IHNlbGYuYWJpbGl0aWVzKClbaV0uYXR0cmlidXRlcy5sZW5ndGg7IGorKykge1xuICAgICAgICAgICAgICAgICAgICAgICAgdmFyIGF0dHJpYnV0ZSA9IHNlbGYuYWJpbGl0aWVzKClbaV0uYXR0cmlidXRlc1tqXTtcbiAgICAgICAgICAgICAgICAgICAgICAgIHN3aXRjaChhdHRyaWJ1dGUubmFtZSkge1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgIC8vIGJhbmVfZW5mZWVibGVcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICBjYXNlICdlbmZlZWJsZV9hdHRhY2tfcmVkdWN0aW9uJzpcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgdG90YWxBdHRyaWJ1dGUgKz0gc2VsZi5nZXRBYmlsaXR5QXR0cmlidXRlVmFsdWUoc2VsZi5hYmlsaXRpZXMoKVtpXS5hdHRyaWJ1dGVzLCBhdHRyaWJ1dGUubmFtZSwgYWJpbGl0eS5sZXZlbCgpKTtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICBicmVhaztcbiAgICAgICAgICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgIH1cbiAgICAgICAgICAgIGVsc2UgaWYgKGFiaWxpdHkuYm9udXNEYW1hZ2VSZWR1Y3Rpb24gIT0gdW5kZWZpbmVkKSB7XG4gICAgICAgICAgICAgICAgaWYgKGFiaWxpdHkubGV2ZWwoKSA+IDAgJiYgKGFiaWxpdHkuaXNBY3RpdmUoKSB8fCAoYWJpbGl0eS5iZWhhdmlvci5pbmRleE9mKCdET1RBX0FCSUxJVFlfQkVIQVZJT1JfUEFTU0lWRScpICE9IC0xKSkpIHtcbiAgICAgICAgICAgICAgICAgICAgLy8gcnViaWNrX2ZhZGVfYm9sdCxyYXpvcl9zdGF0aWNfbGlua1xuICAgICAgICAgICAgICAgICAgICB0b3RhbEF0dHJpYnV0ZSs9YWJpbGl0eS5ib251c0RhbWFnZVJlZHVjdGlvbigpO1xuICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgIH1cbiAgICAgICAgfVxuICAgICAgICByZXR1cm4gdG90YWxBdHRyaWJ1dGU7XG4gICAgfSk7XG4gICAgXG4gICAgc2VsZi5nZXRCb251c0RhbWFnZVJlZHVjdGlvblBjdCA9IGtvLmNvbXB1dGVkKGZ1bmN0aW9uICgpIHtcbiAgICAgICAgdmFyIHRvdGFsQXR0cmlidXRlID0gMTtcbiAgICAgICAgZm9yICh2YXIgaSA9IDA7IGkgPCBzZWxmLmFiaWxpdGllcygpLmxlbmd0aDsgaSsrKSB7XG4gICAgICAgICAgICB2YXIgYWJpbGl0eSA9IHNlbGYuYWJpbGl0aWVzKClbaV07XG4gICAgICAgICAgICBpZiAoIShhYmlsaXR5Lm5hbWUgaW4gc2VsZi5hYmlsaXR5RGF0YSkpIHtcbiAgICAgICAgICAgICAgICBpZiAoYWJpbGl0eS5sZXZlbCgpID4gMCAmJiAoYWJpbGl0eS5pc0FjdGl2ZSgpIHx8IChhYmlsaXR5LmJlaGF2aW9yLmluZGV4T2YoJ0RPVEFfQUJJTElUWV9CRUhBVklPUl9QQVNTSVZFJykgIT0gLTEpKSkge1xuICAgICAgICAgICAgICAgICAgICBmb3IgKHZhciBqID0gMDsgaiA8IHNlbGYuYWJpbGl0aWVzKClbaV0uYXR0cmlidXRlcy5sZW5ndGg7IGorKykge1xuICAgICAgICAgICAgICAgICAgICAgICAgdmFyIGF0dHJpYnV0ZSA9IHNlbGYuYWJpbGl0aWVzKClbaV0uYXR0cmlidXRlc1tqXTtcbiAgICAgICAgICAgICAgICAgICAgICAgIHN3aXRjaChhdHRyaWJ1dGUubmFtZSkge1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgIC8vIG1lZHVzYV9zcGxpdF9zaG90XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgY2FzZSAnZGFtYWdlX21vZGlmaWVyJzpcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgdG90YWxBdHRyaWJ1dGUgKj0gKDEgKyBzZWxmLmdldEFiaWxpdHlBdHRyaWJ1dGVWYWx1ZShzZWxmLmFiaWxpdGllcygpW2ldLmF0dHJpYnV0ZXMsIGF0dHJpYnV0ZS5uYW1lLCBhYmlsaXR5LmxldmVsKCkpLzEwMCk7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgYnJlYWs7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgLy8gd2luZHJ1bm5lcl9mb2N1c2ZpcmVcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICBjYXNlICdmb2N1c2ZpcmVfZGFtYWdlX3JlZHVjdGlvbic6XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIGlmICghc2VsZi5oYXNTY2VwdGVyKCkpIHtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIHRvdGFsQXR0cmlidXRlICo9ICgxICsgc2VsZi5nZXRBYmlsaXR5QXR0cmlidXRlVmFsdWUoc2VsZi5hYmlsaXRpZXMoKVtpXS5hdHRyaWJ1dGVzLCBhdHRyaWJ1dGUubmFtZSwgYWJpbGl0eS5sZXZlbCgpKS8xMDApO1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgYnJlYWs7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgY2FzZSAnZm9jdXNmaXJlX2RhbWFnZV9yZWR1Y3Rpb25fc2NlcHRlcic6XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIGlmIChzZWxmLmhhc1NjZXB0ZXIoKSkge1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgdG90YWxBdHRyaWJ1dGUgKj0gKDEgKyBzZWxmLmdldEFiaWxpdHlBdHRyaWJ1dGVWYWx1ZShzZWxmLmFiaWxpdGllcygpW2ldLmF0dHJpYnV0ZXMsIGF0dHJpYnV0ZS5uYW1lLCBhYmlsaXR5LmxldmVsKCkpLzEwMCk7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgICAgICAgICAgICAgICBicmVhaztcbiAgICAgICAgICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgIH1cbiAgICAgICAgfVxuICAgICAgICByZXR1cm4gdG90YWxBdHRyaWJ1dGU7XG4gICAgfSk7XG5cbiAgICBzZWxmLmdldERhbWFnZUFtcGxpZmljYXRpb24gPSBrby5jb21wdXRlZChmdW5jdGlvbiAoKSB7XG4gICAgICAgIHZhciB0b3RhbEF0dHJpYnV0ZSA9IDE7XG4gICAgICAgIGZvciAodmFyIGkgPSAwOyBpIDwgc2VsZi5hYmlsaXRpZXMoKS5sZW5ndGg7IGkrKykge1xuICAgICAgICAgICAgdmFyIGFiaWxpdHkgPSBzZWxmLmFiaWxpdGllcygpW2ldO1xuICAgICAgICAgICAgaWYgKCEoYWJpbGl0eS5uYW1lIGluIHNlbGYuYWJpbGl0eURhdGEpKSB7XG4gICAgICAgICAgICAgICAgLyppZiAoYWJpbGl0eS5sZXZlbCgpID4gMCAmJiAoYWJpbGl0eS5pc0FjdGl2ZSgpIHx8IChhYmlsaXR5LmJlaGF2aW9yLmluZGV4T2YoJ0RPVEFfQUJJTElUWV9CRUhBVklPUl9QQVNTSVZFJykgIT0gLTEpKSkge1xuICAgICAgICAgICAgICAgICAgICBmb3IgKHZhciBqID0gMDsgaiA8IHNlbGYuYWJpbGl0aWVzKClbaV0uYXR0cmlidXRlcy5sZW5ndGg7IGorKykge1xuICAgICAgICAgICAgICAgICAgICAgICAgdmFyIGF0dHJpYnV0ZSA9IHNlbGYuYWJpbGl0aWVzKClbaV0uYXR0cmlidXRlc1tqXTtcbiAgICAgICAgICAgICAgICAgICAgICAgIHN3aXRjaChhdHRyaWJ1dGUubmFtZSkge1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgIC8vIGJhbmVfZW5mZWVibGVcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICBjYXNlICdlbmZlZWJsZV9hdHRhY2tfcmVkdWN0aW9uJzpcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgdG90YWxBdHRyaWJ1dGUgKz0gc2VsZi5nZXRBYmlsaXR5QXR0cmlidXRlVmFsdWUoc2VsZi5hYmlsaXRpZXMoKVtpXS5hdHRyaWJ1dGVzLCBhdHRyaWJ1dGUubmFtZSwgYWJpbGl0eS5sZXZlbCgpKTtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICBicmVhaztcbiAgICAgICAgICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICAgIH0qL1xuICAgICAgICAgICAgfVxuICAgICAgICAgICAgZWxzZSBpZiAoYWJpbGl0eS5kYW1hZ2VBbXBsaWZpY2F0aW9uICE9IHVuZGVmaW5lZCkge1xuICAgICAgICAgICAgICAgIGlmIChhYmlsaXR5LmxldmVsKCkgPiAwICYmIChhYmlsaXR5LmlzQWN0aXZlKCkgfHwgKGFiaWxpdHkuYmVoYXZpb3IuaW5kZXhPZignRE9UQV9BQklMSVRZX0JFSEFWSU9SX1BBU1NJVkUnKSAhPSAtMSkpKSB7XG4gICAgICAgICAgICAgICAgICAgIC8vIHVuZHlpbmdfZmxlc2hfZ29sZW1cbiAgICAgICAgICAgICAgICAgICAgdG90YWxBdHRyaWJ1dGUgKj0gKDEgKyBhYmlsaXR5LmRhbWFnZUFtcGxpZmljYXRpb24oKS8xMDApO1xuICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgIH1cbiAgICAgICAgfVxuICAgICAgICByZXR1cm4gdG90YWxBdHRyaWJ1dGU7XG4gICAgfSk7XG4gICAgXG4gICAgc2VsZi5nZXREYW1hZ2VSZWR1Y3Rpb24gPSBrby5jb21wdXRlZChmdW5jdGlvbiAoKSB7XG4gICAgICAgIHZhciB0b3RhbEF0dHJpYnV0ZSA9IDE7XG4gICAgICAgIGZvciAodmFyIGkgPSAwOyBpIDwgc2VsZi5hYmlsaXRpZXMoKS5sZW5ndGg7IGkrKykge1xuICAgICAgICAgICAgdmFyIGFiaWxpdHkgPSBzZWxmLmFiaWxpdGllcygpW2ldO1xuICAgICAgICAgICAgaWYgKCEoYWJpbGl0eS5uYW1lIGluIHNlbGYuYWJpbGl0eURhdGEpKSB7XG4gICAgICAgICAgICAgICAgaWYgKGFiaWxpdHkubGV2ZWwoKSA+IDAgJiYgKGFiaWxpdHkuaXNBY3RpdmUoKSB8fCAoYWJpbGl0eS5iZWhhdmlvci5pbmRleE9mKCdET1RBX0FCSUxJVFlfQkVIQVZJT1JfUEFTU0lWRScpICE9IC0xKSkpIHtcbiAgICAgICAgICAgICAgICAgICAgZm9yICh2YXIgaiA9IDA7IGogPCBzZWxmLmFiaWxpdGllcygpW2ldLmF0dHJpYnV0ZXMubGVuZ3RoOyBqKyspIHtcbiAgICAgICAgICAgICAgICAgICAgICAgIHZhciBhdHRyaWJ1dGUgPSBzZWxmLmFiaWxpdGllcygpW2ldLmF0dHJpYnV0ZXNbal07XG4gICAgICAgICAgICAgICAgICAgICAgICBzd2l0Y2goYXR0cmlidXRlLm5hbWUpIHtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAvLyBibG9vZHNlZWtlcl9ibG9vZHJhZ2VcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICBjYXNlICdkYW1hZ2VfaW5jcmVhc2VfcGN0JzpcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgaWYgKGFiaWxpdHkubmFtZSA9PSAnYmxvb2RzZWVrZXJfYmxvb2RyYWdlJykge1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgdG90YWxBdHRyaWJ1dGUgKj0gKDEgKyBzZWxmLmdldEFiaWxpdHlBdHRyaWJ1dGVWYWx1ZShzZWxmLmFiaWxpdGllcygpW2ldLmF0dHJpYnV0ZXMsIGF0dHJpYnV0ZS5uYW1lLCBhYmlsaXR5LmxldmVsKCkpLzEwMCk7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgICAgICAgICAgICAgICBicmVhaztcbiAgICAgICAgICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICAgICAgICAvLyBrdW5ra2FfZ2hvc3RzaGlwXG4gICAgICAgICAgICAgICAgICAgIGlmIChhYmlsaXR5Lm5hbWUgPT0gJ2t1bmtrYV9naG9zdHNoaXAnKSB7XG4gICAgICAgICAgICAgICAgICAgICAgICB0b3RhbEF0dHJpYnV0ZSAqPSAoMSAtIDUwLzEwMCk7XG4gICAgICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICB9XG4gICAgICAgICAgICBlbHNlIGlmIChhYmlsaXR5LmRhbWFnZVJlZHVjdGlvbiAhPSB1bmRlZmluZWQpIHtcbiAgICAgICAgICAgICAgICBpZiAoYWJpbGl0eS5sZXZlbCgpID4gMCAmJiAoYWJpbGl0eS5pc0FjdGl2ZSgpIHx8IChhYmlsaXR5LmJlaGF2aW9yLmluZGV4T2YoJ0RPVEFfQUJJTElUWV9CRUhBVklPUl9QQVNTSVZFJykgIT0gLTEpKSkge1xuICAgICAgICAgICAgICAgICAgICAvLyB3aXNwX292ZXJjaGFyZ2UsYnJpc3RsZWJhY2tfYnJpc3RsZWJhY2ssc3BlY3RyZV9kaXNwZXJzaW9uLG1lZHVzYV9tYW5hX3NoaWVsZCx1cnNhX2VucmFnZVxuICAgICAgICAgICAgICAgICAgICB0b3RhbEF0dHJpYnV0ZSAqPSAoMSArIGFiaWxpdHkuZGFtYWdlUmVkdWN0aW9uKCkvMTAwKTtcbiAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICB9XG4gICAgICAgIH1cbiAgICAgICAgcmV0dXJuIHRvdGFsQXR0cmlidXRlO1xuICAgIH0pO1xuXG4gICAgc2VsZi5nZXRDcml0U291cmNlID0ga28uY29tcHV0ZWQoZnVuY3Rpb24gKCkge1xuICAgICAgICB2YXIgc291cmNlcyA9IHt9O1xuICAgICAgICBmb3IgKHZhciBpID0gMDsgaSA8IHNlbGYuYWJpbGl0aWVzKCkubGVuZ3RoOyBpKyspIHtcbiAgICAgICAgICAgIHZhciBhYmlsaXR5ID0gc2VsZi5hYmlsaXRpZXMoKVtpXTtcbiAgICAgICAgICAgIGlmICghKGFiaWxpdHkubmFtZSBpbiBzZWxmLmFiaWxpdHlEYXRhKSkge1xuICAgICAgICAgICAgICAgIGlmIChhYmlsaXR5LmxldmVsKCkgPiAwICYmIChhYmlsaXR5LmlzQWN0aXZlKCkgfHwgKGFiaWxpdHkuYmVoYXZpb3IuaW5kZXhPZignRE9UQV9BQklMSVRZX0JFSEFWSU9SX1BBU1NJVkUnKSAhPSAtMSkpKSB7XG4gICAgICAgICAgICAgICAgICAgIHN3aXRjaChhYmlsaXR5Lm5hbWUpIHtcbiAgICAgICAgICAgICAgICAgICAgICAgIC8vIHBoYW50b21fYXNzYXNzaW5fY291cF9kZV9ncmFjZSxicmV3bWFzdGVyX2RydW5rZW5fYnJhd2xlcixjaGFvc19rbmlnaHRfY2hhb3Nfc3RyaWtlLGx5Y2FuX3NoYXBlc2hpZnQsc2tlbGV0b25fa2luZ19tb3J0YWxfc3RyaWtlLGp1Z2dlcm5hdXRfYmxhZGVfZGFuY2UsYWxwaGFfd29sZl9jcml0aWNhbF9zdHJpa2UsZ2lhbnRfd29sZl9jcml0aWNhbF9zdHJpa2VcbiAgICAgICAgICAgICAgICAgICAgICAgIGNhc2UgJ3BoYW50b21fYXNzYXNzaW5fY291cF9kZV9ncmFjZSc6XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgaWYgKHNvdXJjZXNbYWJpbGl0eS5uYW1lXSA9PSB1bmRlZmluZWQpIHtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgc291cmNlc1thYmlsaXR5Lm5hbWVdID0ge1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgJ2NoYW5jZSc6IHNlbGYuZ2V0QWJpbGl0eUF0dHJpYnV0ZVZhbHVlKHNlbGYuYWJpbGl0aWVzKClbaV0uYXR0cmlidXRlcywgJ2NyaXRfY2hhbmNlJywgYWJpbGl0eS5sZXZlbCgpKS8xMDAsXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAnbXVsdGlwbGllcic6IHNlbGYuZ2V0QWJpbGl0eUF0dHJpYnV0ZVZhbHVlKHNlbGYuYWJpbGl0aWVzKClbaV0uYXR0cmlidXRlcywgJ2NyaXRfYm9udXMnLCBhYmlsaXR5LmxldmVsKCkpLzEwMCxcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICdjb3VudCc6IDEsXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAnZGlzcGxheW5hbWUnOiBhYmlsaXR5LmRpc3BsYXluYW1lXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgZWxzZSB7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIHNvdXJjZXNbYWJpbGl0eS5uYW1lXS5jb3VudCArPSAxO1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgICAgICAgICAgIGJyZWFrO1xuICAgICAgICAgICAgICAgICAgICAgICAgY2FzZSAnYnJld21hc3Rlcl9kcnVua2VuX2JyYXdsZXInOlxuICAgICAgICAgICAgICAgICAgICAgICAgICAgIGlmIChzb3VyY2VzW2FiaWxpdHkubmFtZV0gPT0gdW5kZWZpbmVkKSB7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIHNvdXJjZXNbYWJpbGl0eS5uYW1lXSA9IHtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICdjaGFuY2UnOiBzZWxmLmdldEFiaWxpdHlBdHRyaWJ1dGVWYWx1ZShzZWxmLmFiaWxpdGllcygpW2ldLmF0dHJpYnV0ZXMsICdjcml0X2NoYW5jZScsIGFiaWxpdHkubGV2ZWwoKSkvMTAwLFxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgJ211bHRpcGxpZXInOiBzZWxmLmdldEFiaWxpdHlBdHRyaWJ1dGVWYWx1ZShzZWxmLmFiaWxpdGllcygpW2ldLmF0dHJpYnV0ZXMsICdjcml0X211bHRpcGxpZXInLCBhYmlsaXR5LmxldmVsKCkpLzEwMCxcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICdjb3VudCc6IDEsXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAnZGlzcGxheW5hbWUnOiBhYmlsaXR5LmRpc3BsYXluYW1lXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgZWxzZSB7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIHNvdXJjZXNbYWJpbGl0eS5uYW1lXS5jb3VudCArPSAxO1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgICAgICAgICAgIGJyZWFrO1xuICAgICAgICAgICAgICAgICAgICAgICAgY2FzZSAnY2hhb3Nfa25pZ2h0X2NoYW9zX3N0cmlrZSc6XG4gICAgICAgICAgICAgICAgICAgICAgICBjYXNlICdseWNhbl9zaGFwZXNoaWZ0JzpcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICBpZiAoc291cmNlc1thYmlsaXR5Lm5hbWVdID09IHVuZGVmaW5lZCkge1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBzb3VyY2VzW2FiaWxpdHkubmFtZV0gPSB7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAnY2hhbmNlJzogc2VsZi5nZXRBYmlsaXR5QXR0cmlidXRlVmFsdWUoc2VsZi5hYmlsaXRpZXMoKVtpXS5hdHRyaWJ1dGVzLCAnY3JpdF9jaGFuY2UnLCBhYmlsaXR5LmxldmVsKCkpLzEwMCxcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICdtdWx0aXBsaWVyJzogc2VsZi5nZXRBYmlsaXR5QXR0cmlidXRlVmFsdWUoc2VsZi5hYmlsaXRpZXMoKVtpXS5hdHRyaWJ1dGVzLCAnY3JpdF9tdWx0aXBsaWVyJywgYWJpbGl0eS5sZXZlbCgpKS8xMDAsXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAnY291bnQnOiAxLFxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgJ2Rpc3BsYXluYW1lJzogYWJpbGl0eS5kaXNwbGF5bmFtZVxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICAgICAgICAgICAgICAgIGVsc2Uge1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBzb3VyY2VzW2FiaWxpdHkubmFtZV0uY291bnQgKz0gMTtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgICAgICAgICAgICBicmVhaztcbiAgICAgICAgICAgICAgICAgICAgICAgIGNhc2UgJ3NrZWxldG9uX2tpbmdfbW9ydGFsX3N0cmlrZSc6XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgaWYgKHNvdXJjZXNbYWJpbGl0eS5uYW1lXSA9PSB1bmRlZmluZWQpIHtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgc291cmNlc1thYmlsaXR5Lm5hbWVdID0ge1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgJ2NoYW5jZSc6IHNlbGYuZ2V0QWJpbGl0eUF0dHJpYnV0ZVZhbHVlKHNlbGYuYWJpbGl0aWVzKClbaV0uYXR0cmlidXRlcywgJ2NyaXRfY2hhbmNlJywgYWJpbGl0eS5sZXZlbCgpKS8xMDAsXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAnbXVsdGlwbGllcic6IHNlbGYuZ2V0QWJpbGl0eUF0dHJpYnV0ZVZhbHVlKHNlbGYuYWJpbGl0aWVzKClbaV0uYXR0cmlidXRlcywgJ2NyaXRfbXVsdCcsIGFiaWxpdHkubGV2ZWwoKSkvMTAwLFxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgJ2NvdW50JzogMSxcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICdkaXNwbGF5bmFtZSc6IGFiaWxpdHkuZGlzcGxheW5hbWVcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgICAgICAgICAgICAgICBlbHNlIHtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgc291cmNlc1thYmlsaXR5Lm5hbWVdLmNvdW50ICs9IDE7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICAgICAgICAgICAgYnJlYWs7XG4gICAgICAgICAgICAgICAgICAgICAgICBjYXNlICdqdWdnZXJuYXV0X2JsYWRlX2RhbmNlJzpcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICBpZiAoc291cmNlc1thYmlsaXR5Lm5hbWVdID09IHVuZGVmaW5lZCkge1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBzb3VyY2VzW2FiaWxpdHkubmFtZV0gPSB7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAnY2hhbmNlJzogc2VsZi5nZXRBYmlsaXR5QXR0cmlidXRlVmFsdWUoc2VsZi5hYmlsaXRpZXMoKVtpXS5hdHRyaWJ1dGVzLCAnYmxhZGVfZGFuY2VfY3JpdF9jaGFuY2UnLCBhYmlsaXR5LmxldmVsKCkpLzEwMCxcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICdtdWx0aXBsaWVyJzogc2VsZi5nZXRBYmlsaXR5QXR0cmlidXRlVmFsdWUoc2VsZi5hYmlsaXRpZXMoKVtpXS5hdHRyaWJ1dGVzLCAnYmxhZGVfZGFuY2VfY3JpdF9tdWx0JywgYWJpbGl0eS5sZXZlbCgpKS8xMDAsXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAnY291bnQnOiAxLFxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgJ2Rpc3BsYXluYW1lJzogYWJpbGl0eS5kaXNwbGF5bmFtZVxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICAgICAgICAgICAgICAgIGVsc2Uge1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBzb3VyY2VzW2FiaWxpdHkubmFtZV0uY291bnQgKz0gMTtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgICAgICAgICAgICBicmVhaztcbiAgICAgICAgICAgICAgICAgICAgICAgIGNhc2UgJ2FscGhhX3dvbGZfY3JpdGljYWxfc3RyaWtlJzpcbiAgICAgICAgICAgICAgICAgICAgICAgIGNhc2UgJ2dpYW50X3dvbGZfY3JpdGljYWxfc3RyaWtlJzpcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICBpZiAoc291cmNlc1thYmlsaXR5Lm5hbWVdID09IHVuZGVmaW5lZCkge1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBzb3VyY2VzW2FiaWxpdHkubmFtZV0gPSB7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAnY2hhbmNlJzogc2VsZi5nZXRBYmlsaXR5QXR0cmlidXRlVmFsdWUoc2VsZi5hYmlsaXRpZXMoKVtpXS5hdHRyaWJ1dGVzLCAnY3JpdF9jaGFuY2UnLCBhYmlsaXR5LmxldmVsKCkpLzEwMCxcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICdtdWx0aXBsaWVyJzogc2VsZi5nZXRBYmlsaXR5QXR0cmlidXRlVmFsdWUoc2VsZi5hYmlsaXRpZXMoKVtpXS5hdHRyaWJ1dGVzLCAnY3JpdF9tdWx0JywgYWJpbGl0eS5sZXZlbCgpKS8xMDAsXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAnY291bnQnOiAxLFxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgJ2Rpc3BsYXluYW1lJzogYWJpbGl0eS5kaXNwbGF5bmFtZVxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICAgICAgICAgICAgICAgIGVsc2Uge1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBzb3VyY2VzW2FiaWxpdHkubmFtZV0uY291bnQgKz0gMTtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgICAgICAgICAgICBicmVhaztcbiAgICAgICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgIH1cbiAgICAgICAgfVxuICAgICAgICByZXR1cm4gc291cmNlcztcbiAgICB9KTsgICAgXG5cbiAgICBzZWxmLmdldENsZWF2ZVNvdXJjZSA9IGtvLmNvbXB1dGVkKGZ1bmN0aW9uICgpIHtcbiAgICAgICAgdmFyIHNvdXJjZXMgPSB7fTtcbiAgICAgICAgZm9yICh2YXIgaSA9IDA7IGkgPCBzZWxmLmFiaWxpdGllcygpLmxlbmd0aDsgaSsrKSB7XG4gICAgICAgICAgICB2YXIgYWJpbGl0eSA9IHNlbGYuYWJpbGl0aWVzKClbaV07XG4gICAgICAgICAgICBpZiAoIShhYmlsaXR5Lm5hbWUgaW4gc2VsZi5hYmlsaXR5RGF0YSkpIHtcbiAgICAgICAgICAgICAgICBpZiAoYWJpbGl0eS5sZXZlbCgpID4gMCAmJiAoYWJpbGl0eS5pc0FjdGl2ZSgpIHx8IChhYmlsaXR5LmJlaGF2aW9yLmluZGV4T2YoJ0RPVEFfQUJJTElUWV9CRUhBVklPUl9QQVNTSVZFJykgIT0gLTEpKSkge1xuICAgICAgICAgICAgICAgICAgICBzd2l0Y2goYWJpbGl0eS5uYW1lKSB7XG4gICAgICAgICAgICAgICAgICAgICAgICAvLyBtYWduYXRhdXJfZW1wb3dlclxuICAgICAgICAgICAgICAgICAgICAgICAgY2FzZSAnbWFnbmF0YXVyX2VtcG93ZXInOlxuICAgICAgICAgICAgICAgICAgICAgICAgICAgIGlmIChzb3VyY2VzW2FiaWxpdHkubmFtZV0gPT0gdW5kZWZpbmVkKSB7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIHNvdXJjZXNbYWJpbGl0eS5uYW1lXSA9IHtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICdyYWRpdXMnOiBzZWxmLmdldEFiaWxpdHlBdHRyaWJ1dGVWYWx1ZShzZWxmLmFiaWxpdGllcygpW2ldLmF0dHJpYnV0ZXMsICdjbGVhdmVfcmFkaXVzJywgYWJpbGl0eS5sZXZlbCgpKSxcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICdtYWduaXR1ZGUnOiBzZWxmLmdldEFiaWxpdHlBdHRyaWJ1dGVWYWx1ZShzZWxmLmFiaWxpdGllcygpW2ldLmF0dHJpYnV0ZXMsICdjbGVhdmVfZGFtYWdlX3BjdCcsIGFiaWxpdHkubGV2ZWwoKSkvMTAwLFxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgJ2NvdW50JzogMSxcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICdkaXNwbGF5bmFtZSc6IGFiaWxpdHkuZGlzcGxheW5hbWVcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgICAgICAgICAgICAgICBlbHNlIHtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgc291cmNlc1thYmlsaXR5Lm5hbWVdLmNvdW50ICs9IDE7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICAgICAgICAgICAgYnJlYWs7XG4gICAgICAgICAgICAgICAgICAgICAgICAvLyBzdmVuX2dyZWF0X2NsZWF2ZVxuICAgICAgICAgICAgICAgICAgICAgICAgY2FzZSAnc3Zlbl9ncmVhdF9jbGVhdmUnOlxuICAgICAgICAgICAgICAgICAgICAgICAgICAgIGlmIChzb3VyY2VzW2FiaWxpdHkubmFtZV0gPT0gdW5kZWZpbmVkKSB7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIHNvdXJjZXNbYWJpbGl0eS5uYW1lXSA9IHtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICdyYWRpdXMnOiBzZWxmLmdldEFiaWxpdHlBdHRyaWJ1dGVWYWx1ZShzZWxmLmFiaWxpdGllcygpW2ldLmF0dHJpYnV0ZXMsICdncmVhdF9jbGVhdmVfcmFkaXVzJywgYWJpbGl0eS5sZXZlbCgpKSxcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICdtYWduaXR1ZGUnOiBzZWxmLmdldEFiaWxpdHlBdHRyaWJ1dGVWYWx1ZShzZWxmLmFiaWxpdGllcygpW2ldLmF0dHJpYnV0ZXMsICdncmVhdF9jbGVhdmVfZGFtYWdlJywgYWJpbGl0eS5sZXZlbCgpKS8xMDAsXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAnY291bnQnOiAxLFxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgJ2Rpc3BsYXluYW1lJzogYWJpbGl0eS5kaXNwbGF5bmFtZVxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICAgICAgICAgICAgICAgIGVsc2Uge1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBzb3VyY2VzW2FiaWxpdHkubmFtZV0uY291bnQgKz0gMTtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgICAgICAgICAgICBicmVhaztcbiAgICAgICAgICAgICAgICAgICAgICAgIC8vIGt1bmtrYV90aWRlYnJpbmdlclxuICAgICAgICAgICAgICAgICAgICAgICAgY2FzZSAna3Vua2thX3RpZGVicmluZ2VyJzpcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICBpZiAoc291cmNlc1thYmlsaXR5Lm5hbWVdID09IHVuZGVmaW5lZCkge1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBzb3VyY2VzW2FiaWxpdHkubmFtZV0gPSB7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAncmFkaXVzJzogc2VsZi5nZXRBYmlsaXR5QXR0cmlidXRlVmFsdWUoc2VsZi5hYmlsaXRpZXMoKVtpXS5hdHRyaWJ1dGVzLCAncmFkaXVzJywgYWJpbGl0eS5sZXZlbCgpKSxcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICdtYWduaXR1ZGUnOiAxLFxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgJ2NvdW50JzogMSxcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICdkaXNwbGF5bmFtZSc6IGFiaWxpdHkuZGlzcGxheW5hbWVcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgICAgICAgICAgICAgICBlbHNlIHtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgc291cmNlc1thYmlsaXR5Lm5hbWVdLmNvdW50ICs9IDE7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICAgICAgICAgICAgYnJlYWs7XG4gICAgICAgICAgICAgICAgICAgICAgICAvLyB0aW55X2dyb3dcbiAgICAgICAgICAgICAgICAgICAgICAgIGNhc2UgJ3RpbnlfZ3Jvdyc6XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgaWYgKHNlbGYuaGFzU2NlcHRlcigpKSB7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIGlmIChzb3VyY2VzW2FiaWxpdHkubmFtZV0gPT0gdW5kZWZpbmVkKSB7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBzb3VyY2VzW2FiaWxpdHkubmFtZV0gPSB7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgJ3JhZGl1cyc6IHNlbGYuZ2V0QWJpbGl0eUF0dHJpYnV0ZVZhbHVlKHNlbGYuYWJpbGl0aWVzKClbaV0uYXR0cmlidXRlcywgJ2JvbnVzX2NsZWF2ZV9yYWRpdXNfc2NlcHRlcicsIGFiaWxpdHkubGV2ZWwoKSksXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgJ21hZ25pdHVkZSc6IHNlbGYuZ2V0QWJpbGl0eUF0dHJpYnV0ZVZhbHVlKHNlbGYuYWJpbGl0aWVzKClbaV0uYXR0cmlidXRlcywgJ2JvbnVzX2NsZWF2ZV9kYW1hZ2Vfc2NlcHRlcicsIGFiaWxpdHkubGV2ZWwoKSkvMTAwLFxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICdjb3VudCc6IDEsXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgJ2Rpc3BsYXluYW1lJzogYWJpbGl0eS5kaXNwbGF5bmFtZVxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIGVsc2Uge1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgc291cmNlc1thYmlsaXR5Lm5hbWVdLmNvdW50ICs9IDE7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgICAgICAgICAgICBicmVhaztcbiAgICAgICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgIH1cbiAgICAgICAgfVxuICAgICAgICByZXR1cm4gc291cmNlcztcbiAgICB9KTsgICAgXG4gICAgXG4gICAgc2VsZi5nZXRDcml0Q2hhbmNlID0ga28uY29tcHV0ZWQoZnVuY3Rpb24gKCkge1xuICAgICAgICB2YXIgdG90YWxBdHRyaWJ1dGUgPSAxO1xuICAgICAgICBmb3IgKHZhciBpID0gMDsgaSA8IHNlbGYuYWJpbGl0aWVzKCkubGVuZ3RoOyBpKyspIHtcbiAgICAgICAgICAgIHZhciBhYmlsaXR5ID0gc2VsZi5hYmlsaXRpZXMoKVtpXTtcbiAgICAgICAgICAgIGlmICghKGFiaWxpdHkubmFtZSBpbiBzZWxmLmFiaWxpdHlEYXRhKSkge1xuICAgICAgICAgICAgICAgIGlmIChhYmlsaXR5LmxldmVsKCkgPiAwICYmIChhYmlsaXR5LmlzQWN0aXZlKCkgfHwgKGFiaWxpdHkuYmVoYXZpb3IuaW5kZXhPZignRE9UQV9BQklMSVRZX0JFSEFWSU9SX1BBU1NJVkUnKSAhPSAtMSkpKSB7XG4gICAgICAgICAgICAgICAgICAgIGZvciAodmFyIGogPSAwOyBqIDwgc2VsZi5hYmlsaXRpZXMoKVtpXS5hdHRyaWJ1dGVzLmxlbmd0aDsgaisrKSB7XG4gICAgICAgICAgICAgICAgICAgICAgICB2YXIgYXR0cmlidXRlID0gc2VsZi5hYmlsaXRpZXMoKVtpXS5hdHRyaWJ1dGVzW2pdO1xuICAgICAgICAgICAgICAgICAgICAgICAgc3dpdGNoKGF0dHJpYnV0ZS5uYW1lKSB7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgLy8gcGhhbnRvbV9hc3Nhc3Npbl9jb3VwX2RlX2dyYWNlLGJyZXdtYXN0ZXJfZHJ1bmtlbl9icmF3bGVyLGNoYW9zX2tuaWdodF9jaGFvc19zdHJpa2UsbHljYW5fc2hhcGVzaGlmdCxza2VsZXRvbl9raW5nX21vcnRhbF9zdHJpa2VcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICBjYXNlICdjcml0X2NoYW5jZSc6XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIHRvdGFsQXR0cmlidXRlICo9ICgxIC0gc2VsZi5nZXRBYmlsaXR5QXR0cmlidXRlVmFsdWUoc2VsZi5hYmlsaXRpZXMoKVtpXS5hdHRyaWJ1dGVzLCBhdHRyaWJ1dGUubmFtZSwgYWJpbGl0eS5sZXZlbCgpKS8xMDApO1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgIGJyZWFrO1xuICAgICAgICAgICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgfVxuICAgICAgICB9XG4gICAgICAgIHJldHVybiB0b3RhbEF0dHJpYnV0ZTtcbiAgICB9KTsgICAgICAgICAgICBcbiAgICBcbiAgICBzZWxmLmdldEV2YXNpb24gPSBrby5jb21wdXRlZChmdW5jdGlvbiAoKSB7XG4gICAgICAgIHZhciB0b3RhbEF0dHJpYnV0ZSA9IDE7XG4gICAgICAgIGZvciAodmFyIGkgPSAwOyBpIDwgc2VsZi5hYmlsaXRpZXMoKS5sZW5ndGg7IGkrKykge1xuICAgICAgICAgICAgdmFyIGFiaWxpdHkgPSBzZWxmLmFiaWxpdGllcygpW2ldO1xuICAgICAgICAgICAgaWYgKCEoYWJpbGl0eS5uYW1lIGluIHNlbGYuYWJpbGl0eURhdGEpKSB7XG4gICAgICAgICAgICAgICAgaWYgKGFiaWxpdHkubGV2ZWwoKSA+IDAgJiYgKGFiaWxpdHkuaXNBY3RpdmUoKSB8fCAoYWJpbGl0eS5iZWhhdmlvci5pbmRleE9mKCdET1RBX0FCSUxJVFlfQkVIQVZJT1JfUEFTU0lWRScpICE9IC0xKSkpIHtcbiAgICAgICAgICAgICAgICAgICAgZm9yICh2YXIgaiA9IDA7IGogPCBzZWxmLmFiaWxpdGllcygpW2ldLmF0dHJpYnV0ZXMubGVuZ3RoOyBqKyspIHtcbiAgICAgICAgICAgICAgICAgICAgICAgIHZhciBhdHRyaWJ1dGUgPSBzZWxmLmFiaWxpdGllcygpW2ldLmF0dHJpYnV0ZXNbal07XG4gICAgICAgICAgICAgICAgICAgICAgICBzd2l0Y2goYXR0cmlidXRlLm5hbWUpIHtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAvLyBwaGFudG9tX2Fzc2Fzc2luX2JsdXJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICBjYXNlICdib251c19ldmFzaW9uJzpcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAvLyBicmV3bWFzdGVyX2RydW5rZW5fYnJhd2xlclxuICAgICAgICAgICAgICAgICAgICAgICAgICAgIGNhc2UgJ2RvZGdlX2NoYW5jZSc6XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIHRvdGFsQXR0cmlidXRlICo9ICgxIC0gc2VsZi5nZXRBYmlsaXR5QXR0cmlidXRlVmFsdWUoc2VsZi5hYmlsaXRpZXMoKVtpXS5hdHRyaWJ1dGVzLCBhdHRyaWJ1dGUubmFtZSwgYWJpbGl0eS5sZXZlbCgpKS8xMDApO1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgIGJyZWFrO1xuICAgICAgICAgICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgfVxuICAgICAgICB9XG4gICAgICAgIHJldHVybiB0b3RhbEF0dHJpYnV0ZTtcbiAgICB9KTtcbiAgICBcbiAgICBzZWxmLmdldEV2YXNpb25CYWNrdHJhY2sgPSBrby5jb21wdXRlZChmdW5jdGlvbiAoKSB7XG4gICAgICAgIHZhciB0b3RhbEF0dHJpYnV0ZSA9IDE7XG4gICAgICAgIGZvciAodmFyIGkgPSAwOyBpIDwgc2VsZi5hYmlsaXRpZXMoKS5sZW5ndGg7IGkrKykge1xuICAgICAgICAgICAgdmFyIGFiaWxpdHkgPSBzZWxmLmFiaWxpdGllcygpW2ldO1xuICAgICAgICAgICAgaWYgKCEoYWJpbGl0eS5uYW1lIGluIHNlbGYuYWJpbGl0eURhdGEpKSB7XG4gICAgICAgICAgICAgICAgaWYgKGFiaWxpdHkubGV2ZWwoKSA+IDAgJiYgKGFiaWxpdHkuaXNBY3RpdmUoKSB8fCAoYWJpbGl0eS5iZWhhdmlvci5pbmRleE9mKCdET1RBX0FCSUxJVFlfQkVIQVZJT1JfUEFTU0lWRScpICE9IC0xKSkpIHtcbiAgICAgICAgICAgICAgICAgICAgZm9yICh2YXIgaiA9IDA7IGogPCBzZWxmLmFiaWxpdGllcygpW2ldLmF0dHJpYnV0ZXMubGVuZ3RoOyBqKyspIHtcbiAgICAgICAgICAgICAgICAgICAgICAgIHZhciBhdHRyaWJ1dGUgPSBzZWxmLmFiaWxpdGllcygpW2ldLmF0dHJpYnV0ZXNbal07XG4gICAgICAgICAgICAgICAgICAgICAgICBzd2l0Y2goYXR0cmlidXRlLm5hbWUpIHtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAvLyBmYWNlbGVzc192b2lkX2JhY2t0cmFja1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgIGNhc2UgJ2RvZGdlX2NoYW5jZV9wY3QnOlxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICB0b3RhbEF0dHJpYnV0ZSAqPSAoMSAtIHNlbGYuZ2V0QWJpbGl0eUF0dHJpYnV0ZVZhbHVlKHNlbGYuYWJpbGl0aWVzKClbaV0uYXR0cmlidXRlcywgYXR0cmlidXRlLm5hbWUsIGFiaWxpdHkubGV2ZWwoKSkvMTAwKTtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICBicmVhaztcbiAgICAgICAgICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgIH1cbiAgICAgICAgfVxuICAgICAgICByZXR1cm4gdG90YWxBdHRyaWJ1dGU7XG4gICAgfSk7XG4gICAgXG4gICAgc2VsZi5nZXRNaXNzQ2hhbmNlID0ga28uY29tcHV0ZWQoZnVuY3Rpb24gKCkge1xuICAgICAgICB2YXIgdG90YWxBdHRyaWJ1dGUgPSAxO1xuICAgICAgICBmb3IgKHZhciBpID0gMDsgaSA8IHNlbGYuYWJpbGl0aWVzKCkubGVuZ3RoOyBpKyspIHtcbiAgICAgICAgICAgIHZhciBhYmlsaXR5ID0gc2VsZi5hYmlsaXRpZXMoKVtpXTtcbiAgICAgICAgICAgIGlmICghKGFiaWxpdHkubmFtZSBpbiBzZWxmLmFiaWxpdHlEYXRhKSkge1xuICAgICAgICAgICAgICAgIGlmIChhYmlsaXR5LmxldmVsKCkgPiAwICYmIChhYmlsaXR5LmlzQWN0aXZlKCkgfHwgKGFiaWxpdHkuYmVoYXZpb3IuaW5kZXhPZignRE9UQV9BQklMSVRZX0JFSEFWSU9SX1BBU1NJVkUnKSAhPSAtMSkpKSB7XG4gICAgICAgICAgICAgICAgICAgIGZvciAodmFyIGogPSAwOyBqIDwgc2VsZi5hYmlsaXRpZXMoKVtpXS5hdHRyaWJ1dGVzLmxlbmd0aDsgaisrKSB7XG4gICAgICAgICAgICAgICAgICAgICAgICB2YXIgYXR0cmlidXRlID0gc2VsZi5hYmlsaXRpZXMoKVtpXS5hdHRyaWJ1dGVzW2pdO1xuICAgICAgICAgICAgICAgICAgICAgICAgc3dpdGNoKGF0dHJpYnV0ZS5uYW1lKSB7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgLy8gYnJvb2Rtb3RoZXJfaW5jYXBhY2l0YXRpbmdfYml0ZSxicmV3bWFzdGVyX2RydW5rZW5faGF6ZVxuICAgICAgICAgICAgICAgICAgICAgICAgICAgIGNhc2UgJ21pc3NfY2hhbmNlJzpcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAvLyByaWtpX3Ntb2tlX3NjcmVlbixrZWVwZXJfb2ZfdGhlX2xpZ2h0X2JsaW5kaW5nX2xpZ2h0LHRpbmtlcl9sYXNlclxuICAgICAgICAgICAgICAgICAgICAgICAgICAgIGNhc2UgJ21pc3NfcmF0ZSc6XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIHRvdGFsQXR0cmlidXRlICo9ICgxIC0gc2VsZi5nZXRBYmlsaXR5QXR0cmlidXRlVmFsdWUoc2VsZi5hYmlsaXRpZXMoKVtpXS5hdHRyaWJ1dGVzLCBhdHRyaWJ1dGUubmFtZSwgYWJpbGl0eS5sZXZlbCgpKS8xMDApO1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgIGJyZWFrO1xuICAgICAgICAgICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgfVxuICAgICAgICAgICAgZWxzZSBpZiAoYWJpbGl0eS5taXNzQ2hhbmNlICE9IHVuZGVmaW5lZCkge1xuICAgICAgICAgICAgICAgIGlmIChhYmlsaXR5LmxldmVsKCkgPiAwICYmIChhYmlsaXR5LmlzQWN0aXZlKCkgfHwgKGFiaWxpdHkuYmVoYXZpb3IuaW5kZXhPZignRE9UQV9BQklMSVRZX0JFSEFWSU9SX1BBU1NJVkUnKSAhPSAtMSkpKSB7XG4gICAgICAgICAgICAgICAgICAgIC8vIG5pZ2h0X3N0YWxrZXJfY3JpcHBsaW5nX2ZlYXJcbiAgICAgICAgICAgICAgICAgICAgdG90YWxBdHRyaWJ1dGUqPSgxLWFiaWxpdHkubWlzc0NoYW5jZSgpLzEwMCk7XG4gICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgfVxuICAgICAgICB9XG4gICAgICAgIHJldHVybiB0b3RhbEF0dHJpYnV0ZTtcbiAgICB9KTtcbiAgICBcbiAgICBzZWxmLmdldExpZmVzdGVhbCA9IGtvLmNvbXB1dGVkKGZ1bmN0aW9uICgpIHtcbiAgICAgICAgdmFyIHRvdGFsQXR0cmlidXRlID0gMDtcbiAgICAgICAgZm9yICh2YXIgaSA9IDA7IGkgPCBzZWxmLmFiaWxpdGllcygpLmxlbmd0aDsgaSsrKSB7XG4gICAgICAgICAgICB2YXIgYWJpbGl0eSA9IHNlbGYuYWJpbGl0aWVzKClbaV07XG4gICAgICAgICAgICBpZiAoIShhYmlsaXR5Lm5hbWUgaW4gc2VsZi5hYmlsaXR5RGF0YSkpIHtcbiAgICAgICAgICAgICAgICBpZiAoYWJpbGl0eS5sZXZlbCgpID4gMCAmJiAoYWJpbGl0eS5pc0FjdGl2ZSgpIHx8IChhYmlsaXR5LmJlaGF2aW9yLmluZGV4T2YoJ0RPVEFfQUJJTElUWV9CRUhBVklPUl9QQVNTSVZFJykgIT0gLTEpKSkge1xuICAgICAgICAgICAgICAgICAgICBmb3IgKHZhciBqID0gMDsgaiA8IHNlbGYuYWJpbGl0aWVzKClbaV0uYXR0cmlidXRlcy5sZW5ndGg7IGorKykge1xuICAgICAgICAgICAgICAgICAgICAgICAgdmFyIGF0dHJpYnV0ZSA9IHNlbGYuYWJpbGl0aWVzKClbaV0uYXR0cmlidXRlc1tqXTtcbiAgICAgICAgICAgICAgICAgICAgICAgIHN3aXRjaChhdHRyaWJ1dGUubmFtZSkge1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgIC8vIHNrZWxldG9uX2tpbmdfdmFtcGlyaWNfYXVyYVxuICAgICAgICAgICAgICAgICAgICAgICAgICAgIGNhc2UgJ3ZhbXBpcmljX2F1cmEnOlxuICAgICAgICAgICAgICAgICAgICAgICAgICAgIC8vIGJyb29kbW90aGVyX2luc2F0aWFibGVfaHVuZ2VyXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgY2FzZSAnbGlmZXN0ZWFsX3BjdCc6XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIHRvdGFsQXR0cmlidXRlICs9IHNlbGYuZ2V0QWJpbGl0eUF0dHJpYnV0ZVZhbHVlKHNlbGYuYWJpbGl0aWVzKClbaV0uYXR0cmlidXRlcywgYXR0cmlidXRlLm5hbWUsIGFiaWxpdHkubGV2ZWwoKSk7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgYnJlYWs7XG4gICAgICAgICAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICB9XG4gICAgICAgICAgICBlbHNlIGlmIChhYmlsaXR5LmxpZmVzdGVhbCAhPSB1bmRlZmluZWQpIHtcbiAgICAgICAgICAgICAgICBpZiAoYWJpbGl0eS5sZXZlbCgpID4gMCAmJiAoYWJpbGl0eS5pc0FjdGl2ZSgpIHx8IChhYmlsaXR5LmJlaGF2aW9yLmluZGV4T2YoJ0RPVEFfQUJJTElUWV9CRUhBVklPUl9QQVNTSVZFJykgIT0gLTEpKSkge1xuICAgICAgICAgICAgICAgICAgICAvLyBsaWZlX3N0ZWFsZXJfb3Blbl93b3VuZHNcbiAgICAgICAgICAgICAgICAgICAgdG90YWxBdHRyaWJ1dGUrPWFiaWxpdHkubGlmZXN0ZWFsKCk7XG4gICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgfVxuICAgICAgICB9XG4gICAgICAgIHJldHVybiB0b3RhbEF0dHJpYnV0ZTtcbiAgICB9KTtcbiAgICBcbiAgICBzZWxmLmdldE1hZ2ljUmVzaXN0ID0ga28uY29tcHV0ZWQoZnVuY3Rpb24gKCkge1xuICAgICAgICB2YXIgdG90YWxBdHRyaWJ1dGUgPSAxO1xuICAgICAgICBmb3IgKHZhciBpID0gMDsgaSA8IHNlbGYuYWJpbGl0aWVzKCkubGVuZ3RoOyBpKyspIHtcbiAgICAgICAgICAgIHZhciBhYmlsaXR5ID0gc2VsZi5hYmlsaXRpZXMoKVtpXTtcbiAgICAgICAgICAgIGlmICghKGFiaWxpdHkubmFtZSBpbiBzZWxmLmFiaWxpdHlEYXRhKSkge1xuICAgICAgICAgICAgICAgIGlmIChhYmlsaXR5LmxldmVsKCkgPiAwICYmIChhYmlsaXR5LmlzQWN0aXZlKCkgfHwgKGFiaWxpdHkuYmVoYXZpb3IuaW5kZXhPZignRE9UQV9BQklMSVRZX0JFSEFWSU9SX1BBU1NJVkUnKSAhPSAtMSkpKSB7XG4gICAgICAgICAgICAgICAgICAgIGZvciAodmFyIGogPSAwOyBqIDwgc2VsZi5hYmlsaXRpZXMoKVtpXS5hdHRyaWJ1dGVzLmxlbmd0aDsgaisrKSB7XG4gICAgICAgICAgICAgICAgICAgICAgICB2YXIgYXR0cmlidXRlID0gc2VsZi5hYmlsaXRpZXMoKVtpXS5hdHRyaWJ1dGVzW2pdO1xuICAgICAgICAgICAgICAgICAgICAgICAgc3dpdGNoKGF0dHJpYnV0ZS5uYW1lKSB7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgLy8gYW50aW1hZ2Vfc3BlbGxfc2hpZWxkXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgY2FzZSAnc3BlbGxfc2hpZWxkX3Jlc2lzdGFuY2UnOlxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICB0b3RhbEF0dHJpYnV0ZSAqPSAoMSAtIHNlbGYuZ2V0QWJpbGl0eUF0dHJpYnV0ZVZhbHVlKHNlbGYuYWJpbGl0aWVzKClbaV0uYXR0cmlidXRlcywgYXR0cmlidXRlLm5hbWUsIGFiaWxpdHkubGV2ZWwoKSkvMTAwKTtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICBicmVhaztcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAvLyBwaGFudG9tX2xhbmNlcl9waGFudG9tX2VkZ2VcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICBjYXNlICdtYWdpY19yZXNpc3RhbmNlX3BjdCc6XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIGlmIChhYmlsaXR5Lm5hbWUgPT0gJ3BoYW50b21fbGFuY2VyX3BoYW50b21fZWRnZScpIHtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIHRvdGFsQXR0cmlidXRlICo9ICgxIC0gc2VsZi5nZXRBYmlsaXR5QXR0cmlidXRlVmFsdWUoc2VsZi5hYmlsaXRpZXMoKVtpXS5hdHRyaWJ1dGVzLCBhdHRyaWJ1dGUubmFtZSwgYWJpbGl0eS5sZXZlbCgpKS8xMDApO1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgYnJlYWs7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgLy8gcnViaWNrX251bGxfZmllbGRcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICBjYXNlICdtYWdpY19kYW1hZ2VfcmVkdWN0aW9uX3BjdCc6XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIGlmIChhYmlsaXR5Lm5hbWUgPT0gJ3J1Ymlja19udWxsX2ZpZWxkJykge1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgdG90YWxBdHRyaWJ1dGUgKj0gKDEgLSBzZWxmLmdldEFiaWxpdHlBdHRyaWJ1dGVWYWx1ZShzZWxmLmFiaWxpdGllcygpW2ldLmF0dHJpYnV0ZXMsIGF0dHJpYnV0ZS5uYW1lLCBhYmlsaXR5LmxldmVsKCkpLzEwMCk7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgICAgICAgICAgICAgICBicmVhaztcbiAgICAgICAgICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgIH1cbiAgICAgICAgICAgIGVsc2UgaWYgKGFiaWxpdHkubWFnaWNSZXNpc3QgIT0gdW5kZWZpbmVkKSB7XG4gICAgICAgICAgICAgICAgaWYgKGFiaWxpdHkubGV2ZWwoKSA+IDAgJiYgKGFiaWxpdHkuaXNBY3RpdmUoKSB8fCAoYWJpbGl0eS5iZWhhdmlvci5pbmRleE9mKCdET1RBX0FCSUxJVFlfQkVIQVZJT1JfUEFTU0lWRScpICE9IC0xKSkpIHtcbiAgICAgICAgICAgICAgICAgICAgLy8gaHVza2FyX2JlcnNlcmtlcnNfYmxvb2QsdmlwZXJfY29ycm9zaXZlX3NraW4sdmlzYWdlX2dyYXZla2VlcGVyc19jbG9ha1xuICAgICAgICAgICAgICAgICAgICB0b3RhbEF0dHJpYnV0ZSAqPSAoMSAtIGFiaWxpdHkubWFnaWNSZXNpc3QoKS8xMDApO1xuICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgIH1cbiAgICAgICAgfVxuICAgICAgICByZXR1cm4gdG90YWxBdHRyaWJ1dGU7XG4gICAgfSk7XG5cbiAgICBzZWxmLmdldE1hZ2ljUmVzaXN0UmVkdWN0aW9uID0ga28uY29tcHV0ZWQoZnVuY3Rpb24gKCkge1xuICAgICAgICB2YXIgdG90YWxBdHRyaWJ1dGUgPSAxO1xuICAgICAgICBmb3IgKHZhciBpID0gMDsgaSA8IHNlbGYuYWJpbGl0aWVzKCkubGVuZ3RoOyBpKyspIHtcbiAgICAgICAgICAgIHZhciBhYmlsaXR5ID0gc2VsZi5hYmlsaXRpZXMoKVtpXTtcbiAgICAgICAgICAgIGlmICghKGFiaWxpdHkubmFtZSBpbiBzZWxmLmFiaWxpdHlEYXRhKSkge1xuICAgICAgICAgICAgICAgIGlmIChhYmlsaXR5LmxldmVsKCkgPiAwICYmIChhYmlsaXR5LmlzQWN0aXZlKCkgfHwgKGFiaWxpdHkuYmVoYXZpb3IuaW5kZXhPZignRE9UQV9BQklMSVRZX0JFSEFWSU9SX1BBU1NJVkUnKSAhPSAtMSkpKSB7XG4gICAgICAgICAgICAgICAgICAgIGZvciAodmFyIGogPSAwOyBqIDwgc2VsZi5hYmlsaXRpZXMoKVtpXS5hdHRyaWJ1dGVzLmxlbmd0aDsgaisrKSB7XG4gICAgICAgICAgICAgICAgICAgICAgICB2YXIgYXR0cmlidXRlID0gc2VsZi5hYmlsaXRpZXMoKVtpXS5hdHRyaWJ1dGVzW2pdO1xuICAgICAgICAgICAgICAgICAgICAgICAgc3dpdGNoKGF0dHJpYnV0ZS5uYW1lKSB7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgLy8gYW5jaWVudF9hcHBhcml0aW9uX2ljZV92b3J0ZXhcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICBjYXNlICdzcGVsbF9yZXNpc3RfcGN0JzpcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAvLyBwdWduYV9kZWNyZXBpZnlcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICBjYXNlICdib251c19zcGVsbF9kYW1hZ2VfcGN0JzpcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAvLyBza3l3cmF0aF9tYWdlX2FuY2llbnRfc2VhbFxuICAgICAgICAgICAgICAgICAgICAgICAgICAgIGNhc2UgJ3Jlc2lzdF9kZWJ1ZmYnOlxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICB0b3RhbEF0dHJpYnV0ZSAqPSAoMSAtIHNlbGYuZ2V0QWJpbGl0eUF0dHJpYnV0ZVZhbHVlKHNlbGYuYWJpbGl0aWVzKClbaV0uYXR0cmlidXRlcywgYXR0cmlidXRlLm5hbWUsIGFiaWxpdHkubGV2ZWwoKSkvMTAwKTtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICBicmVhaztcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAvLyBlbGRlcl90aXRhbl9uYXR1cmFsX29yZGVyXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgY2FzZSAnbWFnaWNfcmVzaXN0YW5jZV9wY3QnOlxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICB0b3RhbEF0dHJpYnV0ZSAqPSAoMSAtIHNlbGYuZ2V0QWJpbGl0eUF0dHJpYnV0ZVZhbHVlKHNlbGYuYWJpbGl0aWVzKClbaV0uYXR0cmlidXRlcywgYXR0cmlidXRlLm5hbWUsIGFiaWxpdHkubGV2ZWwoKSkvMTAwKTtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICBicmVhaztcbiAgICAgICAgICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgIH1cbiAgICAgICAgfVxuICAgICAgICByZXR1cm4gdG90YWxBdHRyaWJ1dGU7XG4gICAgfSk7XG4gICAgXG4gICAgc2VsZi5nZXRNb3ZlbWVudFNwZWVkRmxhdCA9IGtvLmNvbXB1dGVkKGZ1bmN0aW9uICgpIHtcbiAgICAgICAgdmFyIHRvdGFsQXR0cmlidXRlID0gMDtcbiAgICAgICAgZm9yICh2YXIgaSA9IDA7IGkgPCBzZWxmLmFiaWxpdGllcygpLmxlbmd0aDsgaSsrKSB7XG4gICAgICAgICAgICB2YXIgYWJpbGl0eSA9IHNlbGYuYWJpbGl0aWVzKClbaV07XG4gICAgICAgICAgICBpZiAoIShhYmlsaXR5Lm5hbWUgaW4gc2VsZi5hYmlsaXR5RGF0YSkpIHtcbiAgICAgICAgICAgICAgICBpZiAoYWJpbGl0eS5sZXZlbCgpID4gMCAmJiAoYWJpbGl0eS5pc0FjdGl2ZSgpIHx8IChhYmlsaXR5LmJlaGF2aW9yLmluZGV4T2YoJ0RPVEFfQUJJTElUWV9CRUhBVklPUl9QQVNTSVZFJykgIT0gLTEpKSkge1xuICAgICAgICAgICAgICAgICAgICBmb3IgKHZhciBqID0gMDsgaiA8IHNlbGYuYWJpbGl0aWVzKClbaV0uYXR0cmlidXRlcy5sZW5ndGg7IGorKykge1xuICAgICAgICAgICAgICAgICAgICAgICAgdmFyIGF0dHJpYnV0ZSA9IHNlbGYuYWJpbGl0aWVzKClbaV0uYXR0cmlidXRlc1tqXTtcbiAgICAgICAgICAgICAgICAgICAgICAgIHN3aXRjaChhdHRyaWJ1dGUubmFtZSkge1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgIC8vIGFsY2hlbWlzdF9jaGVtaWNhbF9yYWdlXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgY2FzZSAnYm9udXNfbW92ZXNwZWVkJzpcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgaWYgKGFiaWxpdHkubmFtZSA9PSAnYWxjaGVtaXN0X2NoZW1pY2FsX3JhZ2UnKSB7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICB0b3RhbEF0dHJpYnV0ZSArPSBzZWxmLmdldEFiaWxpdHlBdHRyaWJ1dGVWYWx1ZShzZWxmLmFiaWxpdGllcygpW2ldLmF0dHJpYnV0ZXMsIGF0dHJpYnV0ZS5uYW1lLCBhYmlsaXR5LmxldmVsKCkpO1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgYnJlYWs7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgLy8gdGlueV9ncm93XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgY2FzZSAnYm9udXNfbW92ZW1lbnRfc3BlZWQnOlxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBpZiAoYWJpbGl0eS5uYW1lID09ICd0aW55X2dyb3cnKSB7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICB0b3RhbEF0dHJpYnV0ZSArPSBzZWxmLmdldEFiaWxpdHlBdHRyaWJ1dGVWYWx1ZShzZWxmLmFiaWxpdGllcygpW2ldLmF0dHJpYnV0ZXMsIGF0dHJpYnV0ZS5uYW1lLCBhYmlsaXR5LmxldmVsKCkpO1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgYnJlYWs7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgLy8gdHJvbGxfd2FybG9yZF9iZXJzZXJrZXJzX3JhZ2VcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICBjYXNlICdib251c19tb3ZlX3NwZWVkJzpcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgaWYgKGFiaWxpdHkubmFtZSA9PSAndHJvbGxfd2FybG9yZF9iZXJzZXJrZXJzX3JhZ2UnKSB7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICB0b3RhbEF0dHJpYnV0ZSArPSBzZWxmLmdldEFiaWxpdHlBdHRyaWJ1dGVWYWx1ZShzZWxmLmFiaWxpdGllcygpW2ldLmF0dHJpYnV0ZXMsIGF0dHJpYnV0ZS5uYW1lLCBhYmlsaXR5LmxldmVsKCkpO1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICB9ICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICBicmVhaztcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAvLyBsb25lX2RydWlkX3RydWVfZm9ybVxuICAgICAgICAgICAgICAgICAgICAgICAgICAgIGNhc2UgJ3NwZWVkX2xvc3MnOlxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICB0b3RhbEF0dHJpYnV0ZSAtPSBzZWxmLmdldEFiaWxpdHlBdHRyaWJ1dGVWYWx1ZShzZWxmLmFiaWxpdGllcygpW2ldLmF0dHJpYnV0ZXMsIGF0dHJpYnV0ZS5uYW1lLCBhYmlsaXR5LmxldmVsKCkpO1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgIGJyZWFrO1xuICAgICAgICAgICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgfVxuICAgICAgICAgICAgZWxzZSBpZiAoYWJpbGl0eS5tb3ZlbWVudFNwZWVkRmxhdCAhPSB1bmRlZmluZWQpIHtcbiAgICAgICAgICAgICAgICAvLyBkcmFnb25fa25pZ2h0X2VsZGVyX2RyYWdvbl9mb3JtXG4gICAgICAgICAgICAgICAgaWYgKGFiaWxpdHkubGV2ZWwoKSA+IDAgJiYgKGFiaWxpdHkuaXNBY3RpdmUoKSB8fCAoYWJpbGl0eS5iZWhhdmlvci5pbmRleE9mKCdET1RBX0FCSUxJVFlfQkVIQVZJT1JfUEFTU0lWRScpICE9IC0xKSkpIHtcbiAgICAgICAgICAgICAgICAgICAgdG90YWxBdHRyaWJ1dGUrPWFiaWxpdHkubW92ZW1lbnRTcGVlZEZsYXQoKTtcbiAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICB9XG4gICAgICAgIH1cbiAgICAgICAgcmV0dXJuIHRvdGFsQXR0cmlidXRlO1xuICAgIH0pO1xuICAgIFxuICAgIHNlbGYuZ2V0TW92ZW1lbnRTcGVlZFBlcmNlbnQgPSBrby5jb21wdXRlZChmdW5jdGlvbiAoKSB7XG4gICAgICAgIHZhciB0b3RhbEF0dHJpYnV0ZSA9IDA7XG4gICAgICAgIGZvciAodmFyIGkgPSAwOyBpIDwgc2VsZi5hYmlsaXRpZXMoKS5sZW5ndGg7IGkrKykge1xuICAgICAgICAgICAgdmFyIGFiaWxpdHkgPSBzZWxmLmFiaWxpdGllcygpW2ldO1xuICAgICAgICAgICAgaWYgKCEoYWJpbGl0eS5uYW1lIGluIHNlbGYuYWJpbGl0eURhdGEpKSB7XG4gICAgICAgICAgICAgICAgaWYgKGFiaWxpdHkubGV2ZWwoKSA+IDAgJiYgKGFiaWxpdHkuaXNBY3RpdmUoKSB8fCAoYWJpbGl0eS5iZWhhdmlvci5pbmRleE9mKCdET1RBX0FCSUxJVFlfQkVIQVZJT1JfUEFTU0lWRScpICE9IC0xKSkpIHtcbiAgICAgICAgICAgICAgICAgICAgZm9yICh2YXIgaiA9IDA7IGogPCBzZWxmLmFiaWxpdGllcygpW2ldLmF0dHJpYnV0ZXMubGVuZ3RoOyBqKyspIHtcbiAgICAgICAgICAgICAgICAgICAgICAgIHZhciBhdHRyaWJ1dGUgPSBzZWxmLmFiaWxpdGllcygpW2ldLmF0dHJpYnV0ZXNbal07XG4gICAgICAgICAgICAgICAgICAgICAgICBzd2l0Y2goYXR0cmlidXRlLm5hbWUpIHtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAvLyBhYmFkZG9uX2Zyb3N0bW91cm5lIFxuICAgICAgICAgICAgICAgICAgICAgICAgICAgIGNhc2UgJ21vdmVfc3BlZWRfcGN0JzpcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAvLyBib3VudHlfaHVudGVyX3RyYWNrIFxuICAgICAgICAgICAgICAgICAgICAgICAgICAgIGNhc2UgJ2JvbnVzX21vdmVfc3BlZWRfcGN0JzpcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAvLyBtaXJhbmFfbGVhcCBcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICBjYXNlICdsZWFwX3NwZWVkYm9udXMnOlxuICAgICAgICAgICAgICAgICAgICAgICAgICAgIC8vIHN2ZW5fd2FyY3J5IFxuICAgICAgICAgICAgICAgICAgICAgICAgICAgIGNhc2UgJ3dhcmNyeV9tb3Zlc3BlZWQnOlxuICAgICAgICAgICAgICAgICAgICAgICAgICAgIC8vIGNsaW5rel93aW5kX3dhbGtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICBjYXNlICdtb3ZlX3NwZWVkX2JvbnVzX3BjdCc6XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgLy8gd2luZHJ1bm5lcl93aW5kcnVuXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgY2FzZSAnbW92ZXNwZWVkX2JvbnVzX3BjdCc6XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIHRvdGFsQXR0cmlidXRlICs9IHNlbGYuZ2V0QWJpbGl0eUF0dHJpYnV0ZVZhbHVlKHNlbGYuYWJpbGl0aWVzKClbaV0uYXR0cmlidXRlcywgYXR0cmlidXRlLm5hbWUsIGFiaWxpdHkubGV2ZWwoKSkvMTAwO1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgIGJyZWFrO1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgIC8vIGJyb29kbW90aGVyX3NwaW5fd2ViLHNwZWN0cmVfc3BlY3RyYWxfZGFnZ2VyXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgY2FzZSAnYm9udXNfbW92ZXNwZWVkJzpcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgaWYgKGFiaWxpdHkubmFtZSA9PSAnYnJvb2Rtb3RoZXJfc3Bpbl93ZWInIHx8IGFiaWxpdHkubmFtZSA9PSAnc3BlY3RyZV9zcGVjdHJhbF9kYWdnZXInKSB7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICB0b3RhbEF0dHJpYnV0ZSArPSBzZWxmLmdldEFiaWxpdHlBdHRyaWJ1dGVWYWx1ZShzZWxmLmFiaWxpdGllcygpW2ldLmF0dHJpYnV0ZXMsIGF0dHJpYnV0ZS5uYW1lLCBhYmlsaXR5LmxldmVsKCkpLzEwMDtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICAgICAgICAgICAgICAgIGJyZWFrO1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgIC8vIGF4ZV9jdWxsaW5nX2JsYWRlLG5lY3Jvbm9taWNvbl9hcmNoZXJfYW9lXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgY2FzZSAnc3BlZWRfYm9udXMnOlxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBpZiAoYWJpbGl0eS5uYW1lID09ICdheGVfY3VsbGluZ19ibGFkZScgfHwgYWJpbGl0eS5uYW1lID09ICduZWNyb25vbWljb25fYXJjaGVyX2FvZScpIHtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIHRvdGFsQXR0cmlidXRlICs9IHNlbGYuZ2V0QWJpbGl0eUF0dHJpYnV0ZVZhbHVlKHNlbGYuYWJpbGl0aWVzKClbaV0uYXR0cmlidXRlcywgYXR0cmlidXRlLm5hbWUsIGFiaWxpdHkubGV2ZWwoKSkvMTAwO1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgYnJlYWs7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgLy8gbnl4X2Fzc2Fzc2luX3ZlbmRldHRhIFxuICAgICAgICAgICAgICAgICAgICAgICAgICAgIGNhc2UgJ21vdmVtZW50X3NwZWVkJzpcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgaWYgKGFiaWxpdHkubmFtZSA9PSAnbnl4X2Fzc2Fzc2luX3ZlbmRldHRhJykge1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgdG90YWxBdHRyaWJ1dGUgKz0gc2VsZi5nZXRBYmlsaXR5QXR0cmlidXRlVmFsdWUoc2VsZi5hYmlsaXRpZXMoKVtpXS5hdHRyaWJ1dGVzLCBhdHRyaWJ1dGUubmFtZSwgYWJpbGl0eS5sZXZlbCgpKS8xMDA7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgICAgICAgICAgICAgICBicmVhaztcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAvLyBzcGlyaXRfYnJlYWtlcl9lbXBvd2VyaW5nX2hhc3RlXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgY2FzZSAnYm9udXNfbW92ZXNwZWVkX3BjdCc6XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIGlmIChhYmlsaXR5Lm5hbWUgPT0gJ3NwaXJpdF9icmVha2VyX2VtcG93ZXJpbmdfaGFzdGUnKSB7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICB0b3RhbEF0dHJpYnV0ZSArPSBzZWxmLmdldEFiaWxpdHlBdHRyaWJ1dGVWYWx1ZShzZWxmLmFiaWxpdGllcygpW2ldLmF0dHJpYnV0ZXMsIGF0dHJpYnV0ZS5uYW1lLCBhYmlsaXR5LmxldmVsKCkpLzEwMDtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICAgICAgICAgICAgICAgIGJyZWFrO1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgIC8vIG9ncmVfbWFnaV9ibG9vZGx1c3QsZGVhdGhfcHJvcGhldF93aXRjaGNyYWZ0LGtvYm9sZF90YXNrbWFzdGVyX3NwZWVkX2F1cmFcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICBjYXNlICdib251c19tb3ZlbWVudF9zcGVlZCc6XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIGlmIChhYmlsaXR5Lm5hbWUgPT0gJ29ncmVfbWFnaV9ibG9vZGx1c3QnIHx8IGFiaWxpdHkubmFtZSA9PSAnZGVhdGhfcHJvcGhldF93aXRjaGNyYWZ0JyB8fCBhYmlsaXR5Lm5hbWUgPT0gJ2tvYm9sZF90YXNrbWFzdGVyX3NwZWVkX2F1cmEnKSB7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICB0b3RhbEF0dHJpYnV0ZSArPSBzZWxmLmdldEFiaWxpdHlBdHRyaWJ1dGVWYWx1ZShzZWxmLmFiaWxpdGllcygpW2ldLmF0dHJpYnV0ZXMsIGF0dHJpYnV0ZS5uYW1lLCBhYmlsaXR5LmxldmVsKCkpLzEwMDtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICAgICAgICAgICAgICAgIGJyZWFrO1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgIC8vIHJhem9yX3Vuc3RhYmxlX2N1cnJlbnQscGhhbnRvbV9sYW5jZXJfZG9wcGVsd2Fsa1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgIGNhc2UgJ21vdmVtZW50X3NwZWVkX3BjdCc6XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIGlmIChhYmlsaXR5Lm5hbWUgPT0gJ3Jhem9yX3Vuc3RhYmxlX2N1cnJlbnQnIHx8IGFiaWxpdHkubmFtZSA9PSAncGhhbnRvbV9sYW5jZXJfZG9wcGVsd2FsaycpIHtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIHRvdGFsQXR0cmlidXRlICs9IHNlbGYuZ2V0QWJpbGl0eUF0dHJpYnV0ZVZhbHVlKHNlbGYuYWJpbGl0aWVzKClbaV0uYXR0cmlidXRlcywgYXR0cmlidXRlLm5hbWUsIGFiaWxpdHkubGV2ZWwoKSkvMTAwO1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgYnJlYWs7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgLy8gdHJlYW50X25hdHVyZXNfZ3Vpc2UsbG9uZV9kcnVpZF9yYWJpZFxuICAgICAgICAgICAgICAgICAgICAgICAgICAgIGNhc2UgJ2JvbnVzX21vdmVfc3BlZWQnOlxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBpZiAoYWJpbGl0eS5uYW1lID09ICd0cmVhbnRfbmF0dXJlc19ndWlzZScgfHwgYWJpbGl0eS5uYW1lID09ICdsb25lX2RydWlkX3JhYmlkJykge1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgdG90YWxBdHRyaWJ1dGUgKz0gc2VsZi5nZXRBYmlsaXR5QXR0cmlidXRlVmFsdWUoc2VsZi5hYmlsaXRpZXMoKVtpXS5hdHRyaWJ1dGVzLCBhdHRyaWJ1dGUubmFtZSwgYWJpbGl0eS5sZXZlbCgpKS8xMDA7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgICAgICAgICAgICAgICBicmVhaztcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAvLyB3aXNwX3RldGhlclxuICAgICAgICAgICAgICAgICAgICAgICAgICAgIGNhc2UgJ21vdmVzcGVlZCc6XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIGlmIChhYmlsaXR5Lm5hbWUgPT0gJ3dpc3BfdGV0aGVyJykge1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgdG90YWxBdHRyaWJ1dGUgKz0gc2VsZi5nZXRBYmlsaXR5QXR0cmlidXRlVmFsdWUoc2VsZi5hYmlsaXRpZXMoKVtpXS5hdHRyaWJ1dGVzLCBhdHRyaWJ1dGUubmFtZSwgYWJpbGl0eS5sZXZlbCgpKS8xMDA7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgICAgICAgICAgICAgICBicmVhaztcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAvLyBrdW5ra2FfZ2hvc3RzaGlwLHZpc2FnZV9ncmF2ZV9jaGlsbFxuICAgICAgICAgICAgICAgICAgICAgICAgICAgIGNhc2UgJ21vdmVzcGVlZF9ib251cyc6XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIGlmIChhYmlsaXR5Lm5hbWUgPT0gJ2t1bmtrYV9naG9zdHNoaXAnIHx8IGFiaWxpdHkubmFtZSA9PSAndmlzYWdlX2dyYXZlX2NoaWxsJykge1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgdG90YWxBdHRyaWJ1dGUgKz0gc2VsZi5nZXRBYmlsaXR5QXR0cmlidXRlVmFsdWUoc2VsZi5hYmlsaXRpZXMoKVtpXS5hdHRyaWJ1dGVzLCBhdHRyaWJ1dGUubmFtZSwgYWJpbGl0eS5sZXZlbCgpKS8xMDA7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIH0gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIFxuICAgICAgICAgICAgICAgICAgICAgICAgICAgIGJyZWFrO1xuICAgICAgICAgICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgfVxuICAgICAgICAgICAgZWxzZSBpZiAoYWJpbGl0eS5tb3ZlbWVudFNwZWVkUGN0ICE9IHVuZGVmaW5lZCkge1xuICAgICAgICAgICAgICAgIC8vIGF4ZV9iYXR0bGVfaHVuZ2VyLGJyaXN0bGViYWNrX3dhcnBhdGgsc3Bpcml0X2JyZWFrZXJfZ3JlYXRlcl9iYXNoLGxpbmFfZmllcnlfc291bCxpbnZva2VyX2dob3N0X3dhbGssaW52b2tlcl93ZXgsZWxkZXJfdGl0YW5fYW5jZXN0cmFsX3NwaXJpdFxuICAgICAgICAgICAgICAgIGlmIChhYmlsaXR5LmxldmVsKCkgPiAwICYmIChhYmlsaXR5LmlzQWN0aXZlKCkgfHwgKGFiaWxpdHkuYmVoYXZpb3IuaW5kZXhPZignRE9UQV9BQklMSVRZX0JFSEFWSU9SX1BBU1NJVkUnKSAhPSAtMSkpKSB7XG4gICAgICAgICAgICAgICAgICAgIHRvdGFsQXR0cmlidXRlKz1hYmlsaXR5Lm1vdmVtZW50U3BlZWRQY3QoKS8xMDA7XG4gICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgfVxuICAgICAgICB9XG4gICAgICAgIHJldHVybiB0b3RhbEF0dHJpYnV0ZTtcbiAgICB9KTtcblxuICAgIHNlbGYuZ2V0TW92ZW1lbnRTcGVlZFBlcmNlbnRSZWR1Y3Rpb24gPSBrby5jb21wdXRlZChmdW5jdGlvbiAoKSB7XG4gICAgICAgIHZhciB0b3RhbEF0dHJpYnV0ZSA9IDA7XG4gICAgICAgIGZvciAodmFyIGkgPSAwOyBpIDwgc2VsZi5hYmlsaXRpZXMoKS5sZW5ndGg7IGkrKykge1xuICAgICAgICAgICAgdmFyIGFiaWxpdHkgPSBzZWxmLmFiaWxpdGllcygpW2ldO1xuICAgICAgICAgICAgaWYgKCEoYWJpbGl0eS5uYW1lIGluIHNlbGYuYWJpbGl0eURhdGEpKSB7XG4gICAgICAgICAgICAgICAgaWYgKGFiaWxpdHkubGV2ZWwoKSA+IDAgJiYgKGFiaWxpdHkuaXNBY3RpdmUoKSB8fCAoYWJpbGl0eS5iZWhhdmlvci5pbmRleE9mKCdET1RBX0FCSUxJVFlfQkVIQVZJT1JfUEFTU0lWRScpICE9IC0xKSkpIHtcbiAgICAgICAgICAgICAgICAgICAgZm9yICh2YXIgaiA9IDA7IGogPCBzZWxmLmFiaWxpdGllcygpW2ldLmF0dHJpYnV0ZXMubGVuZ3RoOyBqKyspIHtcbiAgICAgICAgICAgICAgICAgICAgICAgIHZhciBhdHRyaWJ1dGUgPSBzZWxmLmFiaWxpdGllcygpW2ldLmF0dHJpYnV0ZXNbal07XG4gICAgICAgICAgICAgICAgICAgICAgICBzd2l0Y2goYXR0cmlidXRlLm5hbWUpIHtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAvLyBjcnlzdGFsX21haWRlbl9mcmVlemluZ19maWVsZFxuICAgICAgICAgICAgICAgICAgICAgICAgICAgIGNhc2UgJ21vdmVzcGVlZF9zbG93JzpcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgaWYgKGFiaWxpdHkubmFtZSA9PSAnY3J5c3RhbF9tYWlkZW5fZnJlZXppbmdfZmllbGQnICYmICFzZWxmLmhhc1NjZXB0ZXIoKSkge1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgdG90YWxBdHRyaWJ1dGUgKz0gc2VsZi5nZXRBYmlsaXR5QXR0cmlidXRlVmFsdWUoc2VsZi5hYmlsaXRpZXMoKVtpXS5hdHRyaWJ1dGVzLCBhdHRyaWJ1dGUubmFtZSwgYWJpbGl0eS5sZXZlbCgpKS8xMDA7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgICAgICAgICAgICAgICBicmVhaztcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICBjYXNlICdtb3Zlc3BlZWRfc2xvd19zY2VwdGVyJzpcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgaWYgKGFiaWxpdHkubmFtZSA9PSAnY3J5c3RhbF9tYWlkZW5fZnJlZXppbmdfZmllbGQnICYmIHNlbGYuaGFzU2NlcHRlcigpKSB7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICB0b3RhbEF0dHJpYnV0ZSArPSBzZWxmLmdldEFiaWxpdHlBdHRyaWJ1dGVWYWx1ZShzZWxmLmFiaWxpdGllcygpW2ldLmF0dHJpYnV0ZXMsIGF0dHJpYnV0ZS5uYW1lLCBhYmlsaXR5LmxldmVsKCkpLzEwMDtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICAgICAgICAgICAgICAgIGJyZWFrO1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgIC8vIGVsZGVyX3RpdGFuX2VhcnRoX3NwbGl0dGVyLG1hZ25hdGF1cl9za2V3ZXIsYWJhZGRvbl9mcm9zdG1vdXJuZSBcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICBjYXNlICdzbG93X3BjdCc6XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIHRvdGFsQXR0cmlidXRlIC09IHNlbGYuZ2V0QWJpbGl0eUF0dHJpYnV0ZVZhbHVlKHNlbGYuYWJpbGl0aWVzKClbaV0uYXR0cmlidXRlcywgYXR0cmlidXRlLm5hbWUsIGFiaWxpdHkubGV2ZWwoKSkvMTAwO1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgIGJyZWFrO1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgIC8vIG5pZ2h0X3N0YWxrZXJfdm9pZCxjcnlzdGFsX21haWRlbl9jcnlzdGFsX25vdmEsZ2hvc3RfZnJvc3RfYXR0YWNrLG9ncmVfbWFnaV9mcm9zdF9hcm1vcixwb2xhcl9mdXJib2xnX3Vyc2Ffd2Fycmlvcl90aHVuZGVyX2NsYXBcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICBjYXNlICdtb3Zlc3BlZWRfc2xvdyc6XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIGlmIChhYmlsaXR5Lm5hbWUgIT0gJ2NyeXN0YWxfbWFpZGVuX2ZyZWV6aW5nX2ZpZWxkJykge1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgdG90YWxBdHRyaWJ1dGUgKz0gc2VsZi5nZXRBYmlsaXR5QXR0cmlidXRlVmFsdWUoc2VsZi5hYmlsaXRpZXMoKVtpXS5hdHRyaWJ1dGVzLCBhdHRyaWJ1dGUubmFtZSwgYWJpbGl0eS5sZXZlbCgpKS8xMDA7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgICAgICAgICAgICAgICBicmVhaztcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAvLyBsaWNoX2Zyb3N0X2FybW9yLGxpY2hfZnJvc3Rfbm92YSxlbmNoYW50cmVzc19lbmNoYW50XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgY2FzZSAnc2xvd19tb3ZlbWVudF9zcGVlZCc6XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgLy8gYmVhc3RtYXN0ZXJfcHJpbWFsX3JvYXJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICBjYXNlICdzbG93X21vdmVtZW50X3NwZWVkX3BjdCc6XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgLy8gZHJvd19yYW5nZXJfZnJvc3RfYXJyb3dzXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgY2FzZSAnZnJvc3RfYXJyb3dzX21vdmVtZW50X3NwZWVkJzpcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAvLyBza2VsZXRvbl9raW5nX2hlbGxmaXJlX2JsYXN0XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgY2FzZSAnYmxhc3Rfc2xvdyc6XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgLy8gc2xhcmRhcl9zbGl0aGVyZWVuX2NydXNoXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgY2FzZSAnY3J1c2hfZXh0cmFfc2xvdyc6XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgLy8gc3Rvcm1fc3Bpcml0X292ZXJsb2FkOlxuICAgICAgICAgICAgICAgICAgICAgICAgICAgIGNhc2UgJ292ZXJsb2FkX21vdmVfc2xvdyc6XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgLy8gd2luZHJ1bm5lcl93aW5kcnVuXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgY2FzZSAnZW5lbXlfbW92ZXNwZWVkX2JvbnVzX3BjdCc6XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIHRvdGFsQXR0cmlidXRlICs9IHNlbGYuZ2V0QWJpbGl0eUF0dHJpYnV0ZVZhbHVlKHNlbGYuYWJpbGl0aWVzKClbaV0uYXR0cmlidXRlcywgYXR0cmlidXRlLm5hbWUsIGFiaWxpdHkubGV2ZWwoKSkvMTAwO1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgIGJyZWFrO1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgIC8vIHBoYW50b21fYXNzYXNzaW5fc3RpZmxpbmdfZGFnZ2VyLHR1c2tfZnJvemVuX3NpZ2lsXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgY2FzZSAnbW92ZV9zbG93JzpcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgaWYgKGFiaWxpdHkubmFtZSA9PSAncGhhbnRvbV9hc3Nhc3Npbl9zdGlmbGluZ19kYWdnZXInKSB7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICB0b3RhbEF0dHJpYnV0ZSArPSBzZWxmLmdldEFiaWxpdHlBdHRyaWJ1dGVWYWx1ZShzZWxmLmFiaWxpdGllcygpW2ldLmF0dHJpYnV0ZXMsIGF0dHJpYnV0ZS5uYW1lLCBhYmlsaXR5LmxldmVsKCkpLzEwMDtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBlbHNlIGlmIChhYmlsaXR5Lm5hbWUgPT0gJ3R1c2tfZnJvemVuX3NpZ2lsJykge1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgdG90YWxBdHRyaWJ1dGUgLT0gc2VsZi5nZXRBYmlsaXR5QXR0cmlidXRlVmFsdWUoc2VsZi5hYmlsaXRpZXMoKVtpXS5hdHRyaWJ1dGVzLCBhdHRyaWJ1dGUubmFtZSwgYWJpbGl0eS5sZXZlbCgpKS8xMDA7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgICAgICAgICAgICAgICBicmVhaztcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAvLyBpbnZva2VyX2ljZV93YWxsLG1lZHVzYV9zdG9uZV9nYXplLHdpc3BfdGV0aGVyXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgY2FzZSAnc2xvdyc6XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIGlmIChhYmlsaXR5Lm5hbWUgPT0gJ21lZHVzYV9zdG9uZV9nYXplJykge1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgdG90YWxBdHRyaWJ1dGUgLT0gc2VsZi5nZXRBYmlsaXR5QXR0cmlidXRlVmFsdWUoc2VsZi5hYmlsaXRpZXMoKVtpXS5hdHRyaWJ1dGVzLCBhdHRyaWJ1dGUubmFtZSwgYWJpbGl0eS5sZXZlbCgpKS8xMDA7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgZWxzZSB7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICB0b3RhbEF0dHJpYnV0ZSArPSBzZWxmLmdldEFiaWxpdHlBdHRyaWJ1dGVWYWx1ZShzZWxmLmFiaWxpdGllcygpW2ldLmF0dHJpYnV0ZXMsIGF0dHJpYnV0ZS5uYW1lLCBhYmlsaXR5LmxldmVsKCkpLzEwMDtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICAgICAgICAgICAgICAgIGJyZWFrO1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgIC8vIGJyb29kbW90aGVyX2luY2FwYWNpdGF0aW5nX2JpdGUsYm91bnR5X2h1bnRlcl9qaW5hZGEsc3BlY3RyZV9zcGVjdHJhbF9kYWdnZXIsd2ludGVyX3d5dmVybl9hcmN0aWNfYnVyblxuICAgICAgICAgICAgICAgICAgICAgICAgICAgIGNhc2UgJ2JvbnVzX21vdmVzcGVlZCc6XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIGlmIChhYmlsaXR5Lm5hbWUgPT0gJ2Jyb29kbW90aGVyX2luY2FwYWNpdGF0aW5nX2JpdGUnIHx8IGFiaWxpdHkubmFtZSA9PSAnYm91bnR5X2h1bnRlcl9qaW5hZGEnIHx8IGFiaWxpdHkubmFtZSA9PSAnd2ludGVyX3d5dmVybl9hcmN0aWNfYnVybicgfHwgYWJpbGl0eS5uYW1lID09ICd3aW50ZXJfd3l2ZXJuX3NwbGludGVyX2JsYXN0Jykge1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgdG90YWxBdHRyaWJ1dGUgKz0gc2VsZi5nZXRBYmlsaXR5QXR0cmlidXRlVmFsdWUoc2VsZi5hYmlsaXRpZXMoKVtpXS5hdHRyaWJ1dGVzLCBhdHRyaWJ1dGUubmFtZSwgYWJpbGl0eS5sZXZlbCgpKS8xMDA7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgZWxzZSBpZiAoYWJpbGl0eS5uYW1lID09ICdzcGVjdHJlX3NwZWN0cmFsX2RhZ2dlcicpIHtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIHRvdGFsQXR0cmlidXRlIC09IHNlbGYuZ2V0QWJpbGl0eUF0dHJpYnV0ZVZhbHVlKHNlbGYuYWJpbGl0aWVzKClbaV0uYXR0cmlidXRlcywgYXR0cmlidXRlLm5hbWUsIGFiaWxpdHkubGV2ZWwoKSkvMTAwO1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgYnJlYWs7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgLy8gb21uaWtuaWdodF9kZWdlbl9hdXJhXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgY2FzZSAnc3BlZWRfYm9udXMnOlxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBpZiAoYWJpbGl0eS5uYW1lID09ICdvbW5pa25pZ2h0X2RlZ2VuX2F1cmEnKSB7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICB0b3RhbEF0dHJpYnV0ZSArPSBzZWxmLmdldEFiaWxpdHlBdHRyaWJ1dGVWYWx1ZShzZWxmLmFiaWxpdGllcygpW2ldLmF0dHJpYnV0ZXMsIGF0dHJpYnV0ZS5uYW1lLCBhYmlsaXR5LmxldmVsKCkpLzEwMDtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICAgICAgICAgICAgICAgIGJyZWFrO1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgIC8vIHRpZGVodW50ZXJfZ3VzaFxuICAgICAgICAgICAgICAgICAgICAgICAgICAgIGNhc2UgJ21vdmVtZW50X3NwZWVkJzpcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgaWYgKGFiaWxpdHkubmFtZSA9PSAndGlkZWh1bnRlcl9ndXNoJykge1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgdG90YWxBdHRyaWJ1dGUgKz0gc2VsZi5nZXRBYmlsaXR5QXR0cmlidXRlVmFsdWUoc2VsZi5hYmlsaXRpZXMoKVtpXS5hdHRyaWJ1dGVzLCBhdHRyaWJ1dGUubmFtZSwgYWJpbGl0eS5sZXZlbCgpKS8xMDA7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgICAgICAgICAgICAgICBicmVhaztcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAvLyBwdWduYV9kZWNyZXBpZnksY2hlbl9wZW5pdGVuY2VcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICBjYXNlICdib251c19tb3ZlbWVudF9zcGVlZCc6XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIGlmIChhYmlsaXR5Lm5hbWUgPT0gJ3B1Z25hX2RlY3JlcGlmeScgfHwgYWJpbGl0eS5uYW1lID09ICdjaGVuX3Blbml0ZW5jZScpIHtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIHRvdGFsQXR0cmlidXRlICs9IHNlbGYuZ2V0QWJpbGl0eUF0dHJpYnV0ZVZhbHVlKHNlbGYuYWJpbGl0aWVzKClbaV0uYXR0cmlidXRlcywgYXR0cmlidXRlLm5hbWUsIGFiaWxpdHkubGV2ZWwoKSkvMTAwO1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgYnJlYWs7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgLy8gYW5jaWVudF9hcHBhcml0aW9uX2ljZV92b3J0ZXgscGhhbnRvbV9sYW5jZXJfc3Bpcml0X2xhbmNlLHNreXdyYXRoX21hZ2VfY29uY3Vzc2l2ZV9zaG90LGZhY2VsZXNzX3ZvaWRfdGltZV93YWxrXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgY2FzZSAnbW92ZW1lbnRfc3BlZWRfcGN0JzpcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgaWYgKGFiaWxpdHkubmFtZSA9PSAnYW5jaWVudF9hcHBhcml0aW9uX2ljZV92b3J0ZXgnIHx8IGFiaWxpdHkubmFtZSA9PSAncGhhbnRvbV9sYW5jZXJfc3Bpcml0X2xhbmNlJyB8fCBhYmlsaXR5Lm5hbWUgPT0gJ2ZhY2VsZXNzX3ZvaWRfdGltZV93YWxrJykge1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgdG90YWxBdHRyaWJ1dGUgKz0gc2VsZi5nZXRBYmlsaXR5QXR0cmlidXRlVmFsdWUoc2VsZi5hYmlsaXRpZXMoKVtpXS5hdHRyaWJ1dGVzLCBhdHRyaWJ1dGUubmFtZSwgYWJpbGl0eS5sZXZlbCgpKS8xMDA7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgZWxzZSBpZiAoYWJpbGl0eS5uYW1lID09ICdza3l3cmF0aF9tYWdlX2NvbmN1c3NpdmVfc2hvdCcpIHtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIHRvdGFsQXR0cmlidXRlIC09IHNlbGYuZ2V0QWJpbGl0eUF0dHJpYnV0ZVZhbHVlKHNlbGYuYWJpbGl0aWVzKClbaV0uYXR0cmlidXRlcywgYXR0cmlidXRlLm5hbWUsIGFiaWxpdHkubGV2ZWwoKSkvMTAwO1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgYnJlYWs7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgLy8gcmF6b3JfdW5zdGFibGVfY3VycmVudFxuICAgICAgICAgICAgICAgICAgICAgICAgICAgIGNhc2UgJ3Nsb3dfYW1vdW50JzpcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgaWYgKGFiaWxpdHkubmFtZSA9PSAncmF6b3JfdW5zdGFibGVfY3VycmVudCcpIHtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIHRvdGFsQXR0cmlidXRlICs9IHNlbGYuZ2V0QWJpbGl0eUF0dHJpYnV0ZVZhbHVlKHNlbGYuYWJpbGl0aWVzKClbaV0uYXR0cmlidXRlcywgYXR0cmlidXRlLm5hbWUsIGFiaWxpdHkubGV2ZWwoKSkvMTAwO1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgYnJlYWs7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgLy8gYnJld21hc3Rlcl9kcnVua2VuX2hhemUsYnJld21hc3Rlcl90aHVuZGVyX2NsYXAsdHJlYW50X2xlZWNoX3NlZWRcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICBjYXNlICdtb3ZlbWVudF9zbG93JzpcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgaWYgKGFiaWxpdHkubmFtZSA9PSAnYnJld21hc3Rlcl9kcnVua2VuX2hhemUnIHx8IGFiaWxpdHkubmFtZSA9PSAnYnJld21hc3Rlcl90aHVuZGVyX2NsYXAnKSB7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICB0b3RhbEF0dHJpYnV0ZSAtPSBzZWxmLmdldEFiaWxpdHlBdHRyaWJ1dGVWYWx1ZShzZWxmLmFiaWxpdGllcygpW2ldLmF0dHJpYnV0ZXMsIGF0dHJpYnV0ZS5uYW1lLCBhYmlsaXR5LmxldmVsKCkpLzEwMDtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBlbHNlIGlmIChhYmlsaXR5Lm5hbWUgPT0gJ3Vyc2FfZWFydGhzaG9jaycgfHwgYWJpbGl0eS5uYW1lID09ICd0cmVhbnRfbGVlY2hfc2VlZCcpIHtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIHRvdGFsQXR0cmlidXRlICs9IHNlbGYuZ2V0QWJpbGl0eUF0dHJpYnV0ZVZhbHVlKHNlbGYuYWJpbGl0aWVzKClbaV0uYXR0cmlidXRlcywgYXR0cmlidXRlLm5hbWUsIGFiaWxpdHkubGV2ZWwoKSkvMTAwO1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgYnJlYWs7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgLy8gc2tlbGV0b25fa2luZ19yZWluY2FybmF0aW9uXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgY2FzZSAnbW92ZXNwZWVkJzpcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgaWYgKGFiaWxpdHkubmFtZSA9PSAnc2tlbGV0b25fa2luZ19yZWluY2FybmF0aW9uJykge1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgdG90YWxBdHRyaWJ1dGUgKz0gc2VsZi5nZXRBYmlsaXR5QXR0cmlidXRlVmFsdWUoc2VsZi5hYmlsaXRpZXMoKVtpXS5hdHRyaWJ1dGVzLCBhdHRyaWJ1dGUubmFtZSwgYWJpbGl0eS5sZXZlbCgpKS8xMDA7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgICAgICAgICAgICAgICBicmVhaztcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAvLyBrdW5ra2FfdG9ycmVudCx2aXNhZ2VfZ3JhdmVfY2hpbGxcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICBjYXNlICdtb3Zlc3BlZWRfYm9udXMnOlxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBpZiAoYWJpbGl0eS5uYW1lID09ICdrdW5ra2FfdG9ycmVudCcpIHtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIHRvdGFsQXR0cmlidXRlICs9IHNlbGYuZ2V0QWJpbGl0eUF0dHJpYnV0ZVZhbHVlKHNlbGYuYWJpbGl0aWVzKClbaV0uYXR0cmlidXRlcywgYXR0cmlidXRlLm5hbWUsIGFiaWxpdHkubGV2ZWwoKSkvMTAwO1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIGVsc2UgaWYgKGFiaWxpdHkubmFtZSA9PSAndmlzYWdlX2dyYXZlX2NoaWxsJykge1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgdG90YWxBdHRyaWJ1dGUgLT0gc2VsZi5nZXRBYmlsaXR5QXR0cmlidXRlVmFsdWUoc2VsZi5hYmlsaXRpZXMoKVtpXS5hdHRyaWJ1dGVzLCBhdHRyaWJ1dGUubmFtZSwgYWJpbGl0eS5sZXZlbCgpKS8xMDA7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgICAgICAgICAgICAgICBicmVhaztcbiAgICAgICAgICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICAgICAgICBpZiAoYWJpbGl0eS5uYW1lID09ICdzYXR5cl90cmlja3N0ZXJfcHVyZ2UnKSB7XG4gICAgICAgICAgICAgICAgICAgICAgICB0b3RhbEF0dHJpYnV0ZSAtPSA4MC8xMDA7XG4gICAgICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgICAgICAgZWxzZSBpZiAoYWJpbGl0eS5uYW1lID09ICdlbnJhZ2VkX3dpbGRraW5fdG9ybmFkbycpIHtcbiAgICAgICAgICAgICAgICAgICAgICAgIHRvdGFsQXR0cmlidXRlIC09IDE1LzEwMDtcbiAgICAgICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgIH1cbiAgICAgICAgICAgIGVsc2UgaWYgKGFiaWxpdHkubW92ZW1lbnRTcGVlZFBjdFJlZHVjdGlvbiAhPSB1bmRlZmluZWQpIHtcbiAgICAgICAgICAgICAgICBpZiAoYWJpbGl0eS5sZXZlbCgpID4gMCAmJiAoYWJpbGl0eS5pc0FjdGl2ZSgpIHx8IChhYmlsaXR5LmJlaGF2aW9yLmluZGV4T2YoJ0RPVEFfQUJJTElUWV9CRUhBVklPUl9QQVNTSVZFJykgIT0gLTEpKSkge1xuICAgICAgICAgICAgICAgICAgICAvLyBheGVfYmF0dGxlX2h1bmdlcixiYXRyaWRlcl9zdGlja3lfbmFwYWxtLHNocmVkZGVyX2NoYWtyYW0sbWVlcG9fZ2Vvc3RyaWtlLGxpZmVfc3RlYWxlcl9vcGVuX3dvdW5kcyxcbiAgICAgICAgICAgICAgICAgICAgLy8gdmVub21hbmNlcl9wb2lzb25fc3RpbmcsdmlwZXJfdmlwZXJfc3RyaWtlLHZpcGVyX2NvcnJvc2l2ZV9za2luLHZpcGVyX3BvaXNvbl9hdHRhY2ssdmVub21hbmNlcl92ZW5vbW91c19nYWxlLHRyZWFudF9sZWVjaF9zZWVkXG4gICAgICAgICAgICAgICAgICAgIC8vIGxpY2hfY2hhaW5fZnJvc3Qsc25pcGVyX3NocmFwbmVsLGNlbnRhdXJfc3RhbXBlZGUsaHVza2FyX2xpZmVfYnJlYWssamFraXJvX2R1YWxfYnJlYXRoLG1lZXBvX2dlb3N0cmlrZSxzYW5ka2luZ19lcGljZW50ZXJcbiAgICAgICAgICAgICAgICAgICAgLy8gZWFydGhfc3Bpcml0X3JvbGxpbmdfYm91bGRlcixpbnZva2VyX2dob3N0X3dhbGssaW52b2tlcl9pY2Vfd2FsbCxlbGRlcl90aXRhbl9lYXJ0aF9zcGxpdHRlclxuICAgICAgICAgICAgICAgICAgICAvLyB1bmR5aW5nX2ZsZXNoX2dvbGVtLHRlbXBsYXJfYXNzYXNzaW5fcHNpb25pY190cmFwLG5ldmVybW9yZV9yZXF1aWVtLHF1ZWVub2ZwYWluX3NoYWRvd19zdHJpa2VcbiAgICAgICAgICAgICAgICAgICAgdG90YWxBdHRyaWJ1dGUrPWFiaWxpdHkubW92ZW1lbnRTcGVlZFBjdFJlZHVjdGlvbigpLzEwMDtcbiAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICB9XG4gICAgICAgIH1cbiAgICAgICAgcmV0dXJuIHRvdGFsQXR0cmlidXRlO1xuICAgIH0pO1xuXG4gICAgc2VsZi5nZXRUdXJuUmF0ZVJlZHVjdGlvbiA9IGtvLmNvbXB1dGVkKGZ1bmN0aW9uICgpIHtcbiAgICAgICAgdmFyIHRvdGFsQXR0cmlidXRlID0gMDtcbiAgICAgICAgZm9yICh2YXIgaSA9IDA7IGkgPCBzZWxmLmFiaWxpdGllcygpLmxlbmd0aDsgaSsrKSB7XG4gICAgICAgICAgICB2YXIgYWJpbGl0eSA9IHNlbGYuYWJpbGl0aWVzKClbaV07XG4gICAgICAgICAgICBpZiAoIShhYmlsaXR5Lm5hbWUgaW4gc2VsZi5hYmlsaXR5RGF0YSkpIHtcbiAgICAgICAgICAgICAgICBpZiAoYWJpbGl0eS5sZXZlbCgpID4gMCAmJiAoYWJpbGl0eS5pc0FjdGl2ZSgpIHx8IChhYmlsaXR5LmJlaGF2aW9yLmluZGV4T2YoJ0RPVEFfQUJJTElUWV9CRUhBVklPUl9QQVNTSVZFJykgIT0gLTEpKSkge1xuICAgICAgICAgICAgICAgICAgICBmb3IgKHZhciBqID0gMDsgaiA8IHNlbGYuYWJpbGl0aWVzKClbaV0uYXR0cmlidXRlcy5sZW5ndGg7IGorKykge1xuICAgICAgICAgICAgICAgICAgICAgICAgdmFyIGF0dHJpYnV0ZSA9IHNlbGYuYWJpbGl0aWVzKClbaV0uYXR0cmlidXRlc1tqXTtcbiAgICAgICAgICAgICAgICAgICAgICAgIHN3aXRjaChhdHRyaWJ1dGUubmFtZSkge1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgIC8vIG1lZHVzYV9zdG9uZV9nYXplXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgY2FzZSAnc2xvdyc6XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIGlmIChhYmlsaXR5Lm5hbWUgPT0gJ21lZHVzYV9zdG9uZV9nYXplJykge1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgdG90YWxBdHRyaWJ1dGUgLT0gc2VsZi5nZXRBYmlsaXR5QXR0cmlidXRlVmFsdWUoc2VsZi5hYmlsaXRpZXMoKVtpXS5hdHRyaWJ1dGVzLCBhdHRyaWJ1dGUubmFtZSwgYWJpbGl0eS5sZXZlbCgpKS8xMDA7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgICAgICAgICAgICAgICBicmVhaztcbiAgICAgICAgICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgIH1cbiAgICAgICAgICAgIGVsc2UgaWYgKGFiaWxpdHkudHVyblJhdGVSZWR1Y3Rpb24gIT0gdW5kZWZpbmVkKSB7XG4gICAgICAgICAgICAgICAgaWYgKGFiaWxpdHkubGV2ZWwoKSA+IDAgJiYgKGFiaWxpdHkuaXNBY3RpdmUoKSB8fCAoYWJpbGl0eS5iZWhhdmlvci5pbmRleE9mKCdET1RBX0FCSUxJVFlfQkVIQVZJT1JfUEFTU0lWRScpICE9IC0xKSkpIHtcbiAgICAgICAgICAgICAgICAgICAgLy8gYmF0cmlkZXJfc3RpY2t5X25hcGFsbVxuICAgICAgICAgICAgICAgICAgICB0b3RhbEF0dHJpYnV0ZSs9YWJpbGl0eS50dXJuUmF0ZVJlZHVjdGlvbigpLzEwMDtcbiAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICB9XG4gICAgICAgIH1cbiAgICAgICAgcmV0dXJuIHRvdGFsQXR0cmlidXRlO1xuICAgIH0pO1xuICAgIFxuICAgIHNlbGYuZ2V0VmlzaW9uUmFuZ2VOaWdodCA9IGtvLmNvbXB1dGVkKGZ1bmN0aW9uICgpIHtcbiAgICAgICAgdmFyIHRvdGFsQXR0cmlidXRlID0gMDtcbiAgICAgICAgZm9yICh2YXIgaSA9IDA7IGkgPCBzZWxmLmFiaWxpdGllcygpLmxlbmd0aDsgaSsrKSB7XG4gICAgICAgICAgICB2YXIgYWJpbGl0eSA9IHNlbGYuYWJpbGl0aWVzKClbaV07XG4gICAgICAgICAgICBpZiAoIShhYmlsaXR5Lm5hbWUgaW4gc2VsZi5hYmlsaXR5RGF0YSkpIHtcbiAgICAgICAgICAgICAgICBpZiAoYWJpbGl0eS5sZXZlbCgpID4gMCAmJiAoYWJpbGl0eS5pc0FjdGl2ZSgpIHx8IChhYmlsaXR5LmJlaGF2aW9yLmluZGV4T2YoJ0RPVEFfQUJJTElUWV9CRUhBVklPUl9QQVNTSVZFJykgIT0gLTEpKSkge1xuICAgICAgICAgICAgICAgICAgICBmb3IgKHZhciBqID0gMDsgaiA8IHNlbGYuYWJpbGl0aWVzKClbaV0uYXR0cmlidXRlcy5sZW5ndGg7IGorKykge1xuICAgICAgICAgICAgICAgICAgICAgICAgdmFyIGF0dHJpYnV0ZSA9IHNlbGYuYWJpbGl0aWVzKClbaV0uYXR0cmlidXRlc1tqXTtcbiAgICAgICAgICAgICAgICAgICAgICAgIHN3aXRjaChhdHRyaWJ1dGUubmFtZSkge1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgIC8vIHdpbnRlcl93eXZlcm5fYXJjdGljX2J1cm5cbiAgICAgICAgICAgICAgICAgICAgICAgICAgICBjYXNlICduaWdodF92aXNpb25fYm9udXMnOlxuICAgICAgICAgICAgICAgICAgICAgICAgICAgIC8vIGx5Y2FuX3NoYXBlc2hpZnQsbHVuYV9sdW5hcl9ibGVzc2luZ1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgIGNhc2UgJ2JvbnVzX25pZ2h0X3Zpc2lvbic6XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIHRvdGFsQXR0cmlidXRlICs9IHNlbGYuZ2V0QWJpbGl0eUF0dHJpYnV0ZVZhbHVlKHNlbGYuYWJpbGl0aWVzKClbaV0uYXR0cmlidXRlcywgYXR0cmlidXRlLm5hbWUsIGFiaWxpdHkubGV2ZWwoKSk7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgYnJlYWs7XG4gICAgICAgICAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICB9XG4gICAgICAgICAgICBlbHNlIGlmIChhYmlsaXR5LnZpc2lvbm5pZ2h0ICE9IHVuZGVmaW5lZCkge1xuICAgICAgICAgICAgICAgIGlmIChhYmlsaXR5LmxldmVsKCkgPiAwICYmIChhYmlsaXR5LmlzQWN0aXZlKCkgfHwgKGFiaWxpdHkuYmVoYXZpb3IuaW5kZXhPZignRE9UQV9BQklMSVRZX0JFSEFWSU9SX1BBU1NJVkUnKSAhPSAtMSkpKSB7XG4gICAgICAgICAgICAgICAgICAgIC8vIFxuICAgICAgICAgICAgICAgICAgICB0b3RhbEF0dHJpYnV0ZSs9YWJpbGl0eS52aXNpb25uaWdodCgpO1xuICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgIH1cbiAgICAgICAgfVxuICAgICAgICByZXR1cm4gdG90YWxBdHRyaWJ1dGU7XG4gICAgfSk7XG5cbiAgICBzZWxmLmdldFZpc2lvblJhbmdlUGN0UmVkdWN0aW9uID0ga28uY29tcHV0ZWQoZnVuY3Rpb24gKCkge1xuICAgICAgICB2YXIgdG90YWxBdHRyaWJ1dGUgPSAwO1xuICAgICAgICBmb3IgKHZhciBpID0gMDsgaSA8IHNlbGYuYWJpbGl0aWVzKCkubGVuZ3RoOyBpKyspIHtcbiAgICAgICAgICAgIHZhciBhYmlsaXR5ID0gc2VsZi5hYmlsaXRpZXMoKVtpXTtcbiAgICAgICAgICAgIGlmICghKGFiaWxpdHkubmFtZSBpbiBzZWxmLmFiaWxpdHlEYXRhKSkge1xuICAgICAgICAgICAgICAgIGlmIChhYmlsaXR5LmxldmVsKCkgPiAwICYmIChhYmlsaXR5LmlzQWN0aXZlKCkgfHwgKGFiaWxpdHkuYmVoYXZpb3IuaW5kZXhPZignRE9UQV9BQklMSVRZX0JFSEFWSU9SX1BBU1NJVkUnKSAhPSAtMSkpKSB7XG4gICAgICAgICAgICAgICAgICAgIGZvciAodmFyIGogPSAwOyBqIDwgc2VsZi5hYmlsaXRpZXMoKVtpXS5hdHRyaWJ1dGVzLmxlbmd0aDsgaisrKSB7XG4gICAgICAgICAgICAgICAgICAgICAgICB2YXIgYXR0cmlidXRlID0gc2VsZi5hYmlsaXRpZXMoKVtpXS5hdHRyaWJ1dGVzW2pdO1xuICAgICAgICAgICAgICAgICAgICAgICAgc3dpdGNoKGF0dHJpYnV0ZS5uYW1lKSB7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgLy8gbmlnaHRfc3RhbGtlcl9kYXJrbmVzc1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgIGNhc2UgJ2JsaW5kX3BlcmNlbnRhZ2UnOlxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICB0b3RhbEF0dHJpYnV0ZSArPSBzZWxmLmdldEFiaWxpdHlBdHRyaWJ1dGVWYWx1ZShzZWxmLmFiaWxpdGllcygpW2ldLmF0dHJpYnV0ZXMsIGF0dHJpYnV0ZS5uYW1lLCBhYmlsaXR5LmxldmVsKCkpLzEwMDtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICBicmVhaztcbiAgICAgICAgICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgIH1cbiAgICAgICAgfVxuICAgICAgICByZXR1cm4gdG90YWxBdHRyaWJ1dGU7XG4gICAgfSk7XG5cbiAgICBzZWxmLnNldEV2YXNpb24gPSBrby5jb21wdXRlZChmdW5jdGlvbiAoKSB7XG4gICAgICAgIHZhciB0b3RhbEF0dHJpYnV0ZSA9IDA7XG4gICAgICAgIGZvciAodmFyIGkgPSAwOyBpIDwgc2VsZi5hYmlsaXRpZXMoKS5sZW5ndGg7IGkrKykge1xuICAgICAgICAgICAgdmFyIGFiaWxpdHkgPSBzZWxmLmFiaWxpdGllcygpW2ldO1xuICAgICAgICAgICAgaWYgKGFiaWxpdHkubGV2ZWwoKSA+IDAgJiYgKGFiaWxpdHkuaXNBY3RpdmUoKSB8fCAoYWJpbGl0eS5iZWhhdmlvci5pbmRleE9mKCdET1RBX0FCSUxJVFlfQkVIQVZJT1JfUEFTU0lWRScpICE9IC0xKSkpIHtcbiAgICAgICAgICAgICAgICBpZiAoYWJpbGl0eS5uYW1lID09ICd3aW5kcnVubmVyX3dpbmRydW4nKSB7XG4gICAgICAgICAgICAgICAgICAgIHJldHVybiAxO1xuICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgIH1cbiAgICAgICAgfVxuICAgICAgICByZXR1cm4gdG90YWxBdHRyaWJ1dGU7XG4gICAgfSk7XG4gICAgXG4gICAgc2VsZi5zZXRNb3ZlbWVudFNwZWVkID0ga28uY29tcHV0ZWQoZnVuY3Rpb24gKCkge1xuICAgICAgICB2YXIgTUFYX01PVkVTUEVFRCA9IDUyMjtcbiAgICAgICAgdmFyIE1JTl9NT1ZFU1BFRUQgPSAxMDA7XG4gICAgICAgIHZhciB0b3RhbEF0dHJpYnV0ZSA9IDA7XG4gICAgICAgIGZvciAodmFyIGkgPSAwOyBpIDwgc2VsZi5hYmlsaXRpZXMoKS5sZW5ndGg7IGkrKykge1xuICAgICAgICAgICAgdmFyIGFiaWxpdHkgPSBzZWxmLmFiaWxpdGllcygpW2ldO1xuICAgICAgICAgICAgaWYgKGFiaWxpdHkubGV2ZWwoKSA+IDAgJiYgKGFiaWxpdHkuaXNBY3RpdmUoKSB8fCAoYWJpbGl0eS5iZWhhdmlvci5pbmRleE9mKCdET1RBX0FCSUxJVFlfQkVIQVZJT1JfUEFTU0lWRScpICE9IC0xKSkpIHtcbiAgICAgICAgICAgICAgICBpZiAoYWJpbGl0eS5uYW1lID09ICdzcGlyaXRfYnJlYWtlcl9jaGFyZ2Vfb2ZfZGFya25lc3MnKSB7XG4gICAgICAgICAgICAgICAgICAgIHJldHVybiBzZWxmLmdldEFiaWxpdHlBdHRyaWJ1dGVWYWx1ZShhYmlsaXR5LmF0dHJpYnV0ZXMsICdtb3ZlbWVudF9zcGVlZCcsIGFiaWxpdHkubGV2ZWwoKSk7XG4gICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICAgIGlmIChhYmlsaXR5Lm5hbWUgPT0gJ2Rhcmtfc2Vlcl9zdXJnZScpIHtcbiAgICAgICAgICAgICAgICAgICAgcmV0dXJuIE1BWF9NT1ZFU1BFRUQ7XG4gICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICAgIGlmIChhYmlsaXR5Lm5hbWUgPT0gJ2NlbnRhdXJfc3RhbXBlZGUnKSB7XG4gICAgICAgICAgICAgICAgICAgIHJldHVybiBNQVhfTU9WRVNQRUVEO1xuICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgICBpZiAoYWJpbGl0eS5uYW1lID09ICdseWNhbl9zaGFwZXNoaWZ0Jykge1xuICAgICAgICAgICAgICAgICAgICByZXR1cm4gTUFYX01PVkVTUEVFRDtcbiAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgICAgaWYgKGFiaWxpdHkubmFtZSA9PSAnbGlvbl92b29kb28nIHx8IGFiaWxpdHkubmFtZSA9PSAnc2hhZG93X3NoYW1hbl92b29kb28nKSB7XG4gICAgICAgICAgICAgICAgICAgIHJldHVybiBNSU5fTU9WRVNQRUVEO1xuICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgIH1cbiAgICAgICAgfVxuICAgICAgICByZXR1cm4gdG90YWxBdHRyaWJ1dGU7XG4gICAgfSk7XG5cbiAgICBzZWxmLmdldEJhc2hTb3VyY2UgPSBmdW5jdGlvbiAoYXR0YWNrdHlwZSkge1xuICAgICAgICB2YXIgc291cmNlcyA9IHt9O1xuICAgICAgICBmb3IgKHZhciBpID0gMDsgaSA8IHNlbGYuYWJpbGl0aWVzKCkubGVuZ3RoOyBpKyspIHtcbiAgICAgICAgICAgIHZhciBhYmlsaXR5ID0gc2VsZi5hYmlsaXRpZXMoKVtpXTtcbiAgICAgICAgICAgIGlmICghKGFiaWxpdHkubmFtZSBpbiBzZWxmLmFiaWxpdHlEYXRhKSkge1xuICAgICAgICAgICAgICAgIGlmIChhYmlsaXR5LmxldmVsKCkgPiAwICYmIChhYmlsaXR5LmlzQWN0aXZlKCkgfHwgKGFiaWxpdHkuYmVoYXZpb3IuaW5kZXhPZignRE9UQV9BQklMSVRZX0JFSEFWSU9SX1BBU1NJVkUnKSAhPSAtMSkpKSB7XG4gICAgICAgICAgICAgICAgICAgIGZvciAodmFyIGogPSAwOyBqIDwgc2VsZi5hYmlsaXRpZXMoKVtpXS5hdHRyaWJ1dGVzLmxlbmd0aDsgaisrKSB7XG4gICAgICAgICAgICAgICAgICAgICAgICB2YXIgYXR0cmlidXRlID0gc2VsZi5hYmlsaXRpZXMoKVtpXS5hdHRyaWJ1dGVzW2pdO1xuICAgICAgICAgICAgICAgICAgICAgICAgc3dpdGNoKGF0dHJpYnV0ZS5uYW1lKSB7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgLy8gc25pcGVyX2hlYWRzaG90XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgY2FzZSAncHJvY19jaGFuY2UnOlxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBpZiAoc291cmNlc1thYmlsaXR5Lm5hbWVdID09IHVuZGVmaW5lZCAmJiBhYmlsaXR5Lm5hbWUgPT0gJ3NuaXBlcl9oZWFkc2hvdCcpIHtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIHNvdXJjZXNbYWJpbGl0eS5uYW1lXSA9IHtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAnY2hhbmNlJzogc2VsZi5nZXRBYmlsaXR5QXR0cmlidXRlVmFsdWUoYWJpbGl0eS5hdHRyaWJ1dGVzLCBhdHRyaWJ1dGUubmFtZSwgYWJpbGl0eS5sZXZlbCgpKS8xMDAsXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgJ2RhbWFnZSc6IHNlbGYuZ2V0QWJpbGl0eVByb3BlcnR5VmFsdWUoYWJpbGl0eSwgJ2RhbWFnZScpLFxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICdjb3VudCc6IDEsXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgJ2RhbWFnZVR5cGUnOiAncGh5c2ljYWwnLFxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICdkaXNwbGF5bmFtZSc6IGFiaWxpdHkuZGlzcGxheW5hbWVcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICAgICAgICAgICAgICAgIGJyZWFrO1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgIC8vIHNsYXJkYXJfYmFzaFxuICAgICAgICAgICAgICAgICAgICAgICAgICAgIGNhc2UgJ2NoYW5jZSc6XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIGlmIChzb3VyY2VzW2FiaWxpdHkubmFtZV0gPT0gdW5kZWZpbmVkICYmIGFiaWxpdHkubmFtZSA9PSAnc2xhcmRhcl9iYXNoJykge1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgc291cmNlc1thYmlsaXR5Lm5hbWVdID0ge1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICdjaGFuY2UnOiBzZWxmLmdldEFiaWxpdHlBdHRyaWJ1dGVWYWx1ZShhYmlsaXR5LmF0dHJpYnV0ZXMsIGF0dHJpYnV0ZS5uYW1lLCBhYmlsaXR5LmxldmVsKCkpLzEwMCxcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAnZGFtYWdlJzogc2VsZi5nZXRBYmlsaXR5QXR0cmlidXRlVmFsdWUoYWJpbGl0eS5hdHRyaWJ1dGVzLCAnYm9udXNfZGFtYWdlJywgYWJpbGl0eS5sZXZlbCgpKSxcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAnY291bnQnOiAxLFxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICdkYW1hZ2VUeXBlJzogJ3BoeXNpY2FsJyxcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAnZGlzcGxheW5hbWUnOiBhYmlsaXR5LmRpc3BsYXluYW1lXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgICAgICAgICAgICAgICBicmVhaztcbiAgICAgICAgICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgIH1cbiAgICAgICAgICAgIGVsc2UgaWYgKGFiaWxpdHkuYmFzaEJvbnVzRGFtYWdlICE9IHVuZGVmaW5lZCkge1xuICAgICAgICAgICAgICAgIGlmIChhYmlsaXR5LmxldmVsKCkgPiAwICYmIChhYmlsaXR5LmlzQWN0aXZlKCkgfHwgKGFiaWxpdHkuYmVoYXZpb3IuaW5kZXhPZignRE9UQV9BQklMSVRZX0JFSEFWSU9SX1BBU1NJVkUnKSAhPSAtMSkpKSB7XG4gICAgICAgICAgICAgICAgICAgIC8vIGZhY2VsZXNzX3ZvaWRfdGltZV9sb2NrXG4gICAgICAgICAgICAgICAgICAgIGlmIChzb3VyY2VzW2FiaWxpdHkubmFtZV0gPT0gdW5kZWZpbmVkICYmIGFiaWxpdHkubmFtZSA9PSAnZmFjZWxlc3Nfdm9pZF90aW1lX2xvY2snKSB7XG4gICAgICAgICAgICAgICAgICAgICAgICBzb3VyY2VzW2FiaWxpdHkubmFtZV0gPSB7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgJ2NoYW5jZSc6IGFiaWxpdHkuYmFzaCgpLzEwMCxcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAnZGFtYWdlJzogYWJpbGl0eS5iYXNoQm9udXNEYW1hZ2UoKSxcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAnY291bnQnOiAxLFxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICdkYW1hZ2VUeXBlJzogJ21hZ2ljJyxcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAnZGlzcGxheW5hbWUnOiBhYmlsaXR5LmRpc3BsYXluYW1lXG4gICAgICAgICAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgICAgICAgLy8gc3Bpcml0X2JyZWFrZXJfZ3JlYXRlcl9iYXNoXG4gICAgICAgICAgICAgICAgICAgIGlmIChzb3VyY2VzW2FiaWxpdHkubmFtZV0gPT0gdW5kZWZpbmVkICYmIGFiaWxpdHkubmFtZSA9PSAnc3Bpcml0X2JyZWFrZXJfZ3JlYXRlcl9iYXNoJykge1xuICAgICAgICAgICAgICAgICAgICAgICAgc291cmNlc1thYmlsaXR5Lm5hbWVdID0ge1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgICdjaGFuY2UnOiBhYmlsaXR5LmJhc2goKS8xMDAsXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgJ2RhbWFnZSc6IGFiaWxpdHkuYmFzaEJvbnVzRGFtYWdlKCkvMTAwLFxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICdjb3VudCc6IDEsXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgJ2RhbWFnZVR5cGUnOiAnbWFnaWMnLFxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICdkaXNwbGF5bmFtZSc6IGFiaWxpdHkuZGlzcGxheW5hbWVcbiAgICAgICAgICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgIH1cbiAgICAgICAgfVxuXG4gICAgICAgIHJldHVybiBzb3VyY2VzO1xuICAgIH07XG4gICAgXG4gICAgc2VsZi5nZXRPcmJTb3VyY2UgPSBmdW5jdGlvbiAoKSB7XG4gICAgICAgIHZhciBzb3VyY2VzID0ge307XG4gICAgICAgIGZvciAodmFyIGkgPSAwOyBpIDwgc2VsZi5hYmlsaXRpZXMoKS5sZW5ndGg7IGkrKykge1xuICAgICAgICAgICAgdmFyIGFiaWxpdHkgPSBzZWxmLmFiaWxpdGllcygpW2ldO1xuICAgICAgICAgICAgaWYgKCEoYWJpbGl0eS5uYW1lIGluIHNlbGYuYWJpbGl0eURhdGEpKSB7XG4gICAgICAgICAgICAgICAgaWYgKGFiaWxpdHkubGV2ZWwoKSA+IDAgJiYgKGFiaWxpdHkuaXNBY3RpdmUoKSB8fCAoYWJpbGl0eS5iZWhhdmlvci5pbmRleE9mKCdET1RBX0FCSUxJVFlfQkVIQVZJT1JfUEFTU0lWRScpICE9IC0xKSkpIHtcbiAgICAgICAgICAgICAgICAgICAgZm9yICh2YXIgaiA9IDA7IGogPCBzZWxmLmFiaWxpdGllcygpW2ldLmF0dHJpYnV0ZXMubGVuZ3RoOyBqKyspIHtcbiAgICAgICAgICAgICAgICAgICAgICAgIHZhciBhdHRyaWJ1dGUgPSBzZWxmLmFiaWxpdGllcygpW2ldLmF0dHJpYnV0ZXNbal07XG4gICAgICAgICAgICAgICAgICAgICAgICBzd2l0Y2goYXR0cmlidXRlLm5hbWUpIHtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAvLyBhbnRpbWFnZV9tYW5hX2JyZWFrXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgY2FzZSAnbWFuYV9wZXJfaGl0JzpcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgaWYgKHNvdXJjZXNbYWJpbGl0eS5uYW1lXSA9PSB1bmRlZmluZWQgJiYgYWJpbGl0eS5uYW1lID09ICdhbnRpbWFnZV9tYW5hX2JyZWFrJykge1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgc291cmNlc1thYmlsaXR5Lm5hbWVdID0ge1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICdkYW1hZ2UnOiBzZWxmLmdldEFiaWxpdHlBdHRyaWJ1dGVWYWx1ZShhYmlsaXR5LmF0dHJpYnV0ZXMsIGF0dHJpYnV0ZS5uYW1lLCBhYmlsaXR5LmxldmVsKCkpIFxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgKiBzZWxmLmdldEFiaWxpdHlBdHRyaWJ1dGVWYWx1ZShhYmlsaXR5LmF0dHJpYnV0ZXMsICdkYW1hZ2VfcGVyX2J1cm4nLCBhYmlsaXR5LmxldmVsKCkpLFxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICdkYW1hZ2VUeXBlJzogJ3BoeXNpY2FsJyxcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAnZGlzcGxheW5hbWUnOiBhYmlsaXR5LmRpc3BsYXluYW1lXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgICAgICAgICAgICAgICBicmVhaztcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAvLyBjbGlua3pfc2VhcmluZ19hcnJvd3NcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICBjYXNlICdkYW1hZ2VfYm9udXMnOlxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBpZiAoc291cmNlc1thYmlsaXR5Lm5hbWVdID09IHVuZGVmaW5lZCAmJiBhYmlsaXR5Lm5hbWUgPT0gJ2NsaW5rel9zZWFyaW5nX2Fycm93cycpIHtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIHNvdXJjZXNbYWJpbGl0eS5uYW1lXSA9IHtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAnZGFtYWdlJzogc2VsZi5nZXRBYmlsaXR5QXR0cmlidXRlVmFsdWUoYWJpbGl0eS5hdHRyaWJ1dGVzLCBhdHRyaWJ1dGUubmFtZSwgYWJpbGl0eS5sZXZlbCgpKSxcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAnZGFtYWdlVHlwZSc6ICdwaHlzaWNhbCcsXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgJ2Rpc3BsYXluYW1lJzogYWJpbGl0eS5kaXNwbGF5bmFtZVxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgLy8gc2lsZW5jZXJfZ2xhaXZlc19vZl93aXNkb21cbiAgICAgICAgICAgICAgICAgICAgICAgICAgICBjYXNlICdpbnRlbGxlY3RfZGFtYWdlX3BjdCc6XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIGlmIChzb3VyY2VzW2FiaWxpdHkubmFtZV0gPT0gdW5kZWZpbmVkICYmIGFiaWxpdHkubmFtZSA9PSAnc2lsZW5jZXJfZ2xhaXZlc19vZl93aXNkb20nKSB7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBzb3VyY2VzW2FiaWxpdHkubmFtZV0gPSB7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgJ2RhbWFnZSc6IHNlbGYuZ2V0QWJpbGl0eUF0dHJpYnV0ZVZhbHVlKGFiaWxpdHkuYXR0cmlidXRlcywgYXR0cmlidXRlLm5hbWUsIGFiaWxpdHkubGV2ZWwoKSkvMTAwICogc2VsZi5oZXJvLnRvdGFsSW50KCksXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgJ2RhbWFnZVR5cGUnOiAncHVyZScsXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgJ2Rpc3BsYXluYW1lJzogYWJpbGl0eS5kaXNwbGF5bmFtZVxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgYnJlYWs7XG4gICAgICAgICAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICB9XG4gICAgICAgICAgICBlbHNlIGlmIChhYmlsaXR5LmJvbnVzRGFtYWdlT3JiICE9IHVuZGVmaW5lZCkge1xuICAgICAgICAgICAgICAgIGlmIChhYmlsaXR5LmxldmVsKCkgPiAwICYmIChhYmlsaXR5LmlzQWN0aXZlKCkgfHwgKGFiaWxpdHkuYmVoYXZpb3IuaW5kZXhPZignRE9UQV9BQklMSVRZX0JFSEFWSU9SX1BBU1NJVkUnKSAhPSAtMSkpKSB7XG4gICAgICAgICAgICAgICAgICAgIC8vIG9ic2lkaWFuX2Rlc3Ryb3llcl9hcmNhbmVfb3JiXG4gICAgICAgICAgICAgICAgICAgIGlmIChzb3VyY2VzW2FiaWxpdHkubmFtZV0gPT0gdW5kZWZpbmVkICYmIGFiaWxpdHkubmFtZSA9PSAnb2JzaWRpYW5fZGVzdHJveWVyX2FyY2FuZV9vcmInKSB7XG4gICAgICAgICAgICAgICAgICAgICAgICBzb3VyY2VzW2FiaWxpdHkubmFtZV0gPSB7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgJ2RhbWFnZSc6IGFiaWxpdHkuYm9udXNEYW1hZ2VPcmIoKSxcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAnZGFtYWdlVHlwZSc6ICdwdXJlJyxcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAnZGlzcGxheW5hbWUnOiBhYmlsaXR5LmRpc3BsYXluYW1lXG4gICAgICAgICAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICB9XG4gICAgICAgIH1cbiAgICAgICAgXG4gICAgICAgIHJldHVybiBzb3VyY2VzO1xuICAgIH07XG4gICAgXG4gICAgc2VsZi50b2dnbGVBYmlsaXR5ID0gZnVuY3Rpb24gKGluZGV4LCBkYXRhLCBldmVudCkge1xuICAgICAgICBpZiAoc2VsZi5hYmlsaXRpZXMoKVtpbmRleCgpXS5iZWhhdmlvci5pbmRleE9mKCdET1RBX0FCSUxJVFlfQkVIQVZJT1JfUEFTU0lWRScpIDwgMCkge1xuICAgICAgICAgICAgaWYgKHNlbGYuYWJpbGl0aWVzKClbaW5kZXgoKV0uaXNBY3RpdmUoKSkge1xuICAgICAgICAgICAgICAgIHNlbGYuYWJpbGl0aWVzKClbaW5kZXgoKV0uaXNBY3RpdmUoZmFsc2UpO1xuICAgICAgICAgICAgfVxuICAgICAgICAgICAgZWxzZSB7XG4gICAgICAgICAgICAgICAgc2VsZi5hYmlsaXRpZXMoKVtpbmRleCgpXS5pc0FjdGl2ZSh0cnVlKTtcbiAgICAgICAgICAgIH1cbiAgICAgICAgICAgIFxuICAgICAgICAgICAgaWYgKHNlbGYuYWJpbGl0aWVzKClbaW5kZXgoKV0ubmFtZSA9PSAnbHljYW5fc2hhcGVzaGlmdCcpIHtcbiAgICAgICAgICAgICAgICBzZWxmLmlzU2hhcGVTaGlmdEFjdGl2ZShzZWxmLmFiaWxpdGllcygpW2luZGV4KCldLmlzQWN0aXZlKCkpO1xuICAgICAgICAgICAgfVxuICAgICAgICB9XG4gICAgfS5iaW5kKHRoaXMpO1xuXG4gICAgc2VsZi50b2dnbGVBYmlsaXR5RGV0YWlsID0gZnVuY3Rpb24gKGluZGV4LCBkYXRhLCBldmVudCkge1xuICAgICAgICBpZiAoc2VsZi5hYmlsaXRpZXMoKVtpbmRleCgpXS5pc0RldGFpbCgpKSB7XG4gICAgICAgICAgICBzZWxmLmFiaWxpdGllcygpW2luZGV4KCldLmlzRGV0YWlsKGZhbHNlKTtcbiAgICAgICAgfVxuICAgICAgICBlbHNlIHtcbiAgICAgICAgICAgIHNlbGYuYWJpbGl0aWVzKClbaW5kZXgoKV0uaXNEZXRhaWwodHJ1ZSk7XG4gICAgICAgIH1cbiAgICB9LmJpbmQodGhpcyk7XG4gICAgXG4gICAgc2VsZi5nZXRBYmlsaXR5ID0gZnVuY3Rpb24gKGFiaWxpdHlOYW1lKSB7XG4gICAgICAgIHJldHVybiBzZWxmLmFiaWxpdGllcygpLmZpbmQoZnVuY3Rpb24oYikge1xuICAgICAgICAgICAgcmV0dXJuIGIubmFtZSA9PSBhYmlsaXR5TmFtZTtcbiAgICAgICAgfSk7XG4gICAgfVxufVxuXG5teS5wcm90b3R5cGUuQWJpbGl0eU1vZGVsLnByb3RvdHlwZS5sZXZlbFVwQWJpbGl0eSA9IGZ1bmN0aW9uIChpbmRleCwgZGF0YSwgZXZlbnQsIGhlcm8pIHtcbiAgICB2YXIgc2VsZiA9IHRoaXM7XG4gICAgaWYgKHNlbGYuYWJpbGl0aWVzKClbaW5kZXgoKV0ubGV2ZWwoKSA8IGhlcm8uZ2V0QWJpbGl0eUxldmVsTWF4KGRhdGEpICYmIGhlcm8uYXZhaWxhYmxlU2tpbGxQb2ludHMoKSA+IDAgKSB7XG4gICAgICAgIHN3aXRjaChzZWxmLmFiaWxpdGllcygpW2luZGV4KCldLmFiaWxpdHl0eXBlKSB7XG4gICAgICAgICAgICBjYXNlICdET1RBX0FCSUxJVFlfVFlQRV9VTFRJTUFURSc6XG4gICAgICAgICAgICAgICAgaWYgKGhlcm8uaGVyb0lkKCkgPT0gJ2ludm9rZXInKSB7XG4gICAgICAgICAgICAgICAgICAgIGlmIChcbiAgICAgICAgICAgICAgICAgICAgICAgIChzZWxmLmFiaWxpdGllcygpW2luZGV4KCldLmxldmVsKCkgPT0gMCkgJiYgKHBhcnNlSW50KGhlcm8uc2VsZWN0ZWRIZXJvTGV2ZWwoKSkgPj0gMikgfHxcbiAgICAgICAgICAgICAgICAgICAgICAgIChzZWxmLmFiaWxpdGllcygpW2luZGV4KCldLmxldmVsKCkgPT0gMSkgJiYgKHBhcnNlSW50KGhlcm8uc2VsZWN0ZWRIZXJvTGV2ZWwoKSkgPj0gNykgfHxcbiAgICAgICAgICAgICAgICAgICAgICAgIChzZWxmLmFiaWxpdGllcygpW2luZGV4KCldLmxldmVsKCkgPT0gMikgJiYgKHBhcnNlSW50KGhlcm8uc2VsZWN0ZWRIZXJvTGV2ZWwoKSkgPj0gMTEpIHx8XG4gICAgICAgICAgICAgICAgICAgICAgICAoc2VsZi5hYmlsaXRpZXMoKVtpbmRleCgpXS5sZXZlbCgpID09IDMpICYmIChwYXJzZUludChoZXJvLnNlbGVjdGVkSGVyb0xldmVsKCkpID49IDE3KVxuICAgICAgICAgICAgICAgICAgICApIHtcbiAgICAgICAgICAgICAgICAgICAgICAgIHNlbGYuYWJpbGl0aWVzKClbaW5kZXgoKV0ubGV2ZWwoc2VsZi5hYmlsaXRpZXMoKVtpbmRleCgpXS5sZXZlbCgpKzEpO1xuICAgICAgICAgICAgICAgICAgICAgICAgaGVyby5za2lsbFBvaW50SGlzdG9yeS5wdXNoKGluZGV4KCkpO1xuICAgICAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICAgIGVsc2UgaWYgKGhlcm8uaGVyb0lkKCkgPT0gJ21lZXBvJykge1xuICAgICAgICAgICAgICAgICAgICBpZiAoc2VsZi5hYmlsaXRpZXMoKVtpbmRleCgpXS5sZXZlbCgpICogNyArIDMgPD0gcGFyc2VJbnQoaGVyby5zZWxlY3RlZEhlcm9MZXZlbCgpKSkge1xuICAgICAgICAgICAgICAgICAgICAgICAgc2VsZi5hYmlsaXRpZXMoKVtpbmRleCgpXS5sZXZlbChzZWxmLmFiaWxpdGllcygpW2luZGV4KCldLmxldmVsKCkrMSk7XG4gICAgICAgICAgICAgICAgICAgICAgICBoZXJvLnNraWxsUG9pbnRIaXN0b3J5LnB1c2goaW5kZXgoKSk7XG4gICAgICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgICAgZWxzZSB7XG4gICAgICAgICAgICAgICAgICAgIGlmICgoc2VsZi5hYmlsaXRpZXMoKVtpbmRleCgpXS5sZXZlbCgpKzEpICogNSArIDEgPD0gcGFyc2VJbnQoaGVyby5zZWxlY3RlZEhlcm9MZXZlbCgpKSkge1xuICAgICAgICAgICAgICAgICAgICAgICAgc2VsZi5hYmlsaXRpZXMoKVtpbmRleCgpXS5sZXZlbChzZWxmLmFiaWxpdGllcygpW2luZGV4KCldLmxldmVsKCkrMSk7XG4gICAgICAgICAgICAgICAgICAgICAgICBoZXJvLnNraWxsUG9pbnRIaXN0b3J5LnB1c2goaW5kZXgoKSk7XG4gICAgICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICBicmVhaztcbiAgICAgICAgICAgIGRlZmF1bHQ6XG4gICAgICAgICAgICAgICAgaWYgKHNlbGYuYWJpbGl0aWVzKClbaW5kZXgoKV0ubGV2ZWwoKSAqIDIgKyAxIDw9IHBhcnNlSW50KGhlcm8uc2VsZWN0ZWRIZXJvTGV2ZWwoKSkpIHtcbiAgICAgICAgICAgICAgICAgICAgc2VsZi5hYmlsaXRpZXMoKVtpbmRleCgpXS5sZXZlbChzZWxmLmFiaWxpdGllcygpW2luZGV4KCldLmxldmVsKCkrMSk7XG4gICAgICAgICAgICAgICAgICAgIGhlcm8uc2tpbGxQb2ludEhpc3RvcnkucHVzaChpbmRleCgpKTtcbiAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICBicmVhaztcbiAgICAgICAgfVxuICAgICAgICBzd2l0Y2ggKHNlbGYuYWJpbGl0aWVzKClbaW5kZXgoKV0ubmFtZSkge1xuICAgICAgICAgICAgY2FzZSAnYmVhc3RtYXN0ZXJfY2FsbF9vZl90aGVfd2lsZCc6XG4gICAgICAgICAgICBjYXNlICdjaGVuX3Rlc3Rfb2ZfZmFpdGgnOlxuICAgICAgICAgICAgY2FzZSAnbW9ycGhsaW5nX21vcnBoX2FnaSc6XG4gICAgICAgICAgICBjYXNlICdzaGFkb3dfZGVtb25fc2hhZG93X3BvaXNvbic6XG4gICAgICAgICAgICAgICAgc2VsZi5hYmlsaXRpZXMoKVtpbmRleCgpICsgMV0ubGV2ZWwoc2VsZi5hYmlsaXRpZXMoKVtpbmRleCgpXS5sZXZlbCgpKTtcbiAgICAgICAgICAgIGJyZWFrO1xuICAgICAgICAgICAgY2FzZSAnbW9ycGhsaW5nX21vcnBoX3N0cic6XG4gICAgICAgICAgICAgICAgc2VsZi5hYmlsaXRpZXMoKVtpbmRleCgpIC0gMV0ubGV2ZWwoc2VsZi5hYmlsaXRpZXMoKVtpbmRleCgpXS5sZXZlbCgpKTtcbiAgICAgICAgICAgIGJyZWFrO1xuICAgICAgICAgICAgY2FzZSAna2VlcGVyX29mX3RoZV9saWdodF9zcGlyaXRfZm9ybSc6XG4gICAgICAgICAgICAgICAgc2VsZi5hYmlsaXRpZXMoKVtpbmRleCgpIC0gMV0ubGV2ZWwoc2VsZi5hYmlsaXRpZXMoKVtpbmRleCgpXS5sZXZlbCgpKTtcbiAgICAgICAgICAgICAgICBzZWxmLmFiaWxpdGllcygpW2luZGV4KCkgLSAyXS5sZXZlbChzZWxmLmFiaWxpdGllcygpW2luZGV4KCldLmxldmVsKCkpO1xuICAgICAgICAgICAgYnJlYWs7XG4gICAgICAgICAgICBjYXNlICduZXZlcm1vcmVfc2hhZG93cmF6ZTEnOlxuICAgICAgICAgICAgICAgIHNlbGYuYWJpbGl0aWVzKClbaW5kZXgoKSArIDFdLmxldmVsKHNlbGYuYWJpbGl0aWVzKClbaW5kZXgoKV0ubGV2ZWwoKSk7XG4gICAgICAgICAgICAgICAgc2VsZi5hYmlsaXRpZXMoKVtpbmRleCgpICsgMl0ubGV2ZWwoc2VsZi5hYmlsaXRpZXMoKVtpbmRleCgpXS5sZXZlbCgpKTtcbiAgICAgICAgICAgIGJyZWFrO1xuICAgICAgICAgICAgY2FzZSAnbmV2ZXJtb3JlX3NoYWRvd3JhemUyJzpcbiAgICAgICAgICAgICAgICBzZWxmLmFiaWxpdGllcygpW2luZGV4KCkgLSAxXS5sZXZlbChzZWxmLmFiaWxpdGllcygpW2luZGV4KCldLmxldmVsKCkpO1xuICAgICAgICAgICAgICAgIHNlbGYuYWJpbGl0aWVzKClbaW5kZXgoKSArIDFdLmxldmVsKHNlbGYuYWJpbGl0aWVzKClbaW5kZXgoKV0ubGV2ZWwoKSk7XG4gICAgICAgICAgICBicmVhaztcbiAgICAgICAgICAgIGNhc2UgJ25ldmVybW9yZV9zaGFkb3dyYXplMyc6XG4gICAgICAgICAgICAgICAgc2VsZi5hYmlsaXRpZXMoKVtpbmRleCgpIC0gMV0ubGV2ZWwoc2VsZi5hYmlsaXRpZXMoKVtpbmRleCgpXS5sZXZlbCgpKTtcbiAgICAgICAgICAgICAgICBzZWxmLmFiaWxpdGllcygpW2luZGV4KCkgLSAyXS5sZXZlbChzZWxmLmFiaWxpdGllcygpW2luZGV4KCldLmxldmVsKCkpO1xuICAgICAgICAgICAgYnJlYWs7XG4gICAgICAgICAgICBjYXNlICdlbWJlcl9zcGlyaXRfZmlyZV9yZW1uYW50JzpcbiAgICAgICAgICAgICAgICBzZWxmLmFiaWxpdGllcygpW2luZGV4KCkgLSAxXS5sZXZlbChzZWxmLmFiaWxpdGllcygpW2luZGV4KCldLmxldmVsKCkpO1xuICAgICAgICAgICAgYnJlYWs7XG4gICAgICAgICAgICBjYXNlICdsb25lX2RydWlkX3RydWVfZm9ybSc6XG4gICAgICAgICAgICAgICAgc2VsZi5hYmlsaXRpZXMoKVtpbmRleCgpIC0gMV0ubGV2ZWwoc2VsZi5hYmlsaXRpZXMoKVtpbmRleCgpXS5sZXZlbCgpKTtcbiAgICAgICAgICAgIGJyZWFrO1xuICAgICAgICB9XG4gICAgfVxufTtcbm15LnByb3RvdHlwZS5BYmlsaXR5TW9kZWwucHJvdG90eXBlLmxldmVsRG93bkFiaWxpdHkgPSBmdW5jdGlvbiAoaW5kZXgsIGRhdGEsIGV2ZW50LCBoZXJvKSB7XG4gICAgdmFyIHNlbGYgPSB0aGlzO1xuICAgIGlmIChzZWxmLmFiaWxpdGllcygpW2luZGV4KCldLmxldmVsKCkgPiAwKSB7XG4gICAgICAgIHNlbGYuYWJpbGl0aWVzKClbaW5kZXgoKV0ubGV2ZWwoc2VsZi5hYmlsaXRpZXMoKVtpbmRleCgpXS5sZXZlbCgpIC0gMSk7XG4gICAgICAgIGhlcm8uc2tpbGxQb2ludEhpc3Rvcnkuc3BsaWNlKGhlcm8uc2tpbGxQb2ludEhpc3RvcnkoKS5sYXN0SW5kZXhPZihpbmRleCgpKSwgMSk7XG4gICAgICAgIHN3aXRjaCAoc2VsZi5hYmlsaXRpZXMoKVtpbmRleCgpXS5uYW1lKSB7XG4gICAgICAgICAgICBjYXNlICdiZWFzdG1hc3Rlcl9jYWxsX29mX3RoZV93aWxkJzpcbiAgICAgICAgICAgIGNhc2UgJ2NoZW5fdGVzdF9vZl9mYWl0aCc6XG4gICAgICAgICAgICBjYXNlICdtb3JwaGxpbmdfbW9ycGhfYWdpJzpcbiAgICAgICAgICAgIGNhc2UgJ3NoYWRvd19kZW1vbl9zaGFkb3dfcG9pc29uJzpcbiAgICAgICAgICAgICAgICBzZWxmLmFiaWxpdGllcygpW2luZGV4KCkgKyAxXS5sZXZlbChzZWxmLmFiaWxpdGllcygpW2luZGV4KCldLmxldmVsKCkpO1xuICAgICAgICAgICAgYnJlYWs7XG4gICAgICAgICAgICBjYXNlICdtb3JwaGxpbmdfbW9ycGhfc3RyJzpcbiAgICAgICAgICAgICAgICBzZWxmLmFiaWxpdGllcygpW2luZGV4KCkgLSAxXS5sZXZlbChzZWxmLmFiaWxpdGllcygpW2luZGV4KCldLmxldmVsKCkpO1xuICAgICAgICAgICAgYnJlYWs7XG4gICAgICAgICAgICBjYXNlICdrZWVwZXJfb2ZfdGhlX2xpZ2h0X3NwaXJpdF9mb3JtJzpcbiAgICAgICAgICAgICAgICBzZWxmLmFiaWxpdGllcygpW2luZGV4KCkgLSAxXS5sZXZlbChzZWxmLmFiaWxpdGllcygpW2luZGV4KCldLmxldmVsKCkpO1xuICAgICAgICAgICAgICAgIHNlbGYuYWJpbGl0aWVzKClbaW5kZXgoKSAtIDJdLmxldmVsKHNlbGYuYWJpbGl0aWVzKClbaW5kZXgoKV0ubGV2ZWwoKSk7XG4gICAgICAgICAgICBicmVhaztcbiAgICAgICAgICAgIGNhc2UgJ25ldmVybW9yZV9zaGFkb3dyYXplMSc6XG4gICAgICAgICAgICAgICAgc2VsZi5hYmlsaXRpZXMoKVtpbmRleCgpICsgMV0ubGV2ZWwoc2VsZi5hYmlsaXRpZXMoKVtpbmRleCgpXS5sZXZlbCgpKTtcbiAgICAgICAgICAgICAgICBzZWxmLmFiaWxpdGllcygpW2luZGV4KCkgKyAyXS5sZXZlbChzZWxmLmFiaWxpdGllcygpW2luZGV4KCldLmxldmVsKCkpO1xuICAgICAgICAgICAgYnJlYWs7XG4gICAgICAgICAgICBjYXNlICduZXZlcm1vcmVfc2hhZG93cmF6ZTInOlxuICAgICAgICAgICAgICAgIHNlbGYuYWJpbGl0aWVzKClbaW5kZXgoKSAtIDFdLmxldmVsKHNlbGYuYWJpbGl0aWVzKClbaW5kZXgoKV0ubGV2ZWwoKSk7XG4gICAgICAgICAgICAgICAgc2VsZi5hYmlsaXRpZXMoKVtpbmRleCgpICsgMV0ubGV2ZWwoc2VsZi5hYmlsaXRpZXMoKVtpbmRleCgpXS5sZXZlbCgpKTtcbiAgICAgICAgICAgIGJyZWFrO1xuICAgICAgICAgICAgY2FzZSAnbmV2ZXJtb3JlX3NoYWRvd3JhemUzJzpcbiAgICAgICAgICAgICAgICBzZWxmLmFiaWxpdGllcygpW2luZGV4KCkgLSAxXS5sZXZlbChzZWxmLmFiaWxpdGllcygpW2luZGV4KCldLmxldmVsKCkpO1xuICAgICAgICAgICAgICAgIHNlbGYuYWJpbGl0aWVzKClbaW5kZXgoKSAtIDJdLmxldmVsKHNlbGYuYWJpbGl0aWVzKClbaW5kZXgoKV0ubGV2ZWwoKSk7XG4gICAgICAgICAgICBicmVhaztcbiAgICAgICAgICAgIGNhc2UgJ2VtYmVyX3NwaXJpdF9maXJlX3JlbW5hbnQnOlxuICAgICAgICAgICAgICAgIHNlbGYuYWJpbGl0aWVzKClbaW5kZXgoKSAtIDFdLmxldmVsKHNlbGYuYWJpbGl0aWVzKClbaW5kZXgoKV0ubGV2ZWwoKSk7XG4gICAgICAgICAgICBicmVhaztcbiAgICAgICAgICAgIGNhc2UgJ2xvbmVfZHJ1aWRfdHJ1ZV9mb3JtJzpcbiAgICAgICAgICAgICAgICBzZWxmLmFiaWxpdGllcygpW2luZGV4KCkgLSAxXS5sZXZlbChzZWxmLmFiaWxpdGllcygpW2luZGV4KCldLmxldmVsKCkpO1xuICAgICAgICAgICAgYnJlYWs7XG4gICAgICAgIH1cbiAgICB9XG59OyIsIid1c2Ugc3RyaWN0JztcbiAgICBcbnZhciBteSA9IHJlcXVpcmUoXCIuL2hlcm9jYWxjX2NvcmVcIik7XG5cbm15LnByb3RvdHlwZS5hYmlsaXR5RGF0YSA9IHtcbiAgICAnYWxjaGVtaXN0X2FjaWRfc3ByYXknOiBbXG4gICAgICAgIHtcbiAgICAgICAgICAgIGxhYmVsOiAnRHVyYXRpb24nLFxuICAgICAgICAgICAgY29udHJvbFR5cGU6ICdpbnB1dCdcbiAgICAgICAgfSxcbiAgICAgICAge1xuICAgICAgICAgICAgYXR0cmlidXRlTmFtZTogJ2RhbWFnZScsXG4gICAgICAgICAgICBsYWJlbDogJ1RvdGFsIERhbWFnZScsXG4gICAgICAgICAgICBjb250cm9sVHlwZTogJ3RleHQnLFxuICAgICAgICAgICAgZm46IGZ1bmN0aW9uICh2LCBhLCBwYXJlbnQsIGluZGV4LCBhYmlsaXR5TW9kZWwsIGFiaWxpdHkpIHtcbiAgICAgICAgICAgICAgICByZXR1cm4gdiphO1xuICAgICAgICAgICAgfVxuICAgICAgICB9LFxuICAgICAgICB7XG4gICAgICAgICAgICBhdHRyaWJ1dGVOYW1lOiAnYXJtb3JfcmVkdWN0aW9uJyxcbiAgICAgICAgICAgIGxhYmVsOiAnVG90YWwgRGFtYWdlJyxcbiAgICAgICAgICAgIGNvbnRyb2xUeXBlOiAndGV4dCcsXG4gICAgICAgICAgICBmbjogZnVuY3Rpb24gKHYsIGEsIHBhcmVudCwgaW5kZXgsIGFiaWxpdHlNb2RlbCwgYWJpbGl0eSkge1xuICAgICAgICAgICAgICAgIHJldHVybiAtYTtcbiAgICAgICAgICAgIH0sXG4gICAgICAgICAgICByZXR1cm5Qcm9wZXJ0eTogJ2FybW9yUmVkdWN0aW9uJ1xuICAgICAgICB9XG4gICAgXSxcbiAgICAnYWxjaGVtaXN0X3Vuc3RhYmxlX2NvbmNvY3Rpb24nOiBbXG4gICAgICAgIHtcbiAgICAgICAgICAgIGxhYmVsOiAnQnJldyBUaW1lJyxcbiAgICAgICAgICAgIGNvbnRyb2xUeXBlOiAnaW5wdXQnXG4gICAgICAgIH0sXG4gICAgICAgIHtcbiAgICAgICAgICAgIGF0dHJpYnV0ZU5hbWU6ICdtYXhfZGFtYWdlJyxcbiAgICAgICAgICAgIGxhYmVsOiAnVG90YWwgRGFtYWdlJyxcbiAgICAgICAgICAgIGNvbnRyb2xUeXBlOiAndGV4dCcsXG4gICAgICAgICAgICBmbjogZnVuY3Rpb24gKHYsIGEsIHBhcmVudCwgaW5kZXgsIGFiaWxpdHlNb2RlbCwgYWJpbGl0eSkge1xuICAgICAgICAgICAgICAgIHJldHVybiB2KmEvNTtcbiAgICAgICAgICAgIH1cbiAgICAgICAgfSxcbiAgICAgICAge1xuICAgICAgICAgICAgYXR0cmlidXRlTmFtZTogJ21heF9zdHVuJyxcbiAgICAgICAgICAgIGxhYmVsOiAnVG90YWwgU3R1bicsXG4gICAgICAgICAgICBjb250cm9sVHlwZTogJ3RleHQnLFxuICAgICAgICAgICAgZm46IGZ1bmN0aW9uICh2LCBhLCBwYXJlbnQsIGluZGV4LCBhYmlsaXR5TW9kZWwsIGFiaWxpdHkpIHtcbiAgICAgICAgICAgICAgICByZXR1cm4gdiphLzU7XG4gICAgICAgICAgICB9XG4gICAgICAgIH1cbiAgICBdLFxuICAgICdhbmNpZW50X2FwcGFyaXRpb25fY29sZF9mZWV0JzogW1xuICAgICAgICB7XG4gICAgICAgICAgICBsYWJlbDogJ0R1cmF0aW9uJyxcbiAgICAgICAgICAgIGNvbnRyb2xUeXBlOiAnaW5wdXQnXG4gICAgICAgIH0sXG4gICAgICAgIHtcbiAgICAgICAgICAgIGF0dHJpYnV0ZU5hbWU6ICdkYW1hZ2UnLFxuICAgICAgICAgICAgbGFiZWw6ICdUb3RhbCBEYW1hZ2UnLFxuICAgICAgICAgICAgY29udHJvbFR5cGU6ICd0ZXh0JyxcbiAgICAgICAgICAgIGZuOiBmdW5jdGlvbiAodiwgYSwgcGFyZW50LCBpbmRleCwgYWJpbGl0eU1vZGVsLCBhYmlsaXR5KSB7XG4gICAgICAgICAgICAgICAgcmV0dXJuIHYqYTtcbiAgICAgICAgICAgIH1cbiAgICAgICAgfSxcbiAgICAgICAge1xuICAgICAgICAgICAgYXR0cmlidXRlTmFtZTogJ3N0dW5fZHVyYXRpb24nLFxuICAgICAgICAgICAgbGFiZWw6ICdUb3RhbCBTdHVuJyxcbiAgICAgICAgICAgIGNvbnRyb2xUeXBlOiAndGV4dCcsXG4gICAgICAgICAgICBmbjogZnVuY3Rpb24gKHYsIGEsIHBhcmVudCwgaW5kZXgsIGFiaWxpdHlNb2RlbCwgYWJpbGl0eSkge1xuICAgICAgICAgICAgICAgIHJldHVybiBhO1xuICAgICAgICAgICAgfVxuICAgICAgICB9XG4gICAgXSxcbiAgICAnYW5jaWVudF9hcHBhcml0aW9uX2ljZV9ibGFzdCc6IFtcbiAgICAgICAge1xuICAgICAgICAgICAgbGFiZWw6ICdEdXJhdGlvbicsXG4gICAgICAgICAgICBjb250cm9sVHlwZTogJ2lucHV0J1xuICAgICAgICB9LFxuICAgICAgICB7XG4gICAgICAgICAgICBhdHRyaWJ1dGVOYW1lOiAnZG90X2RhbWFnZScsXG4gICAgICAgICAgICBsYWJlbDogJ1RvdGFsIERhbWFnZScsXG4gICAgICAgICAgICBjb250cm9sVHlwZTogJ3RleHQnLFxuICAgICAgICAgICAgZm46IGZ1bmN0aW9uICh2LCBhLCBwYXJlbnQsIGluZGV4LCBhYmlsaXR5TW9kZWwsIGFiaWxpdHkpIHtcbiAgICAgICAgICAgICAgICByZXR1cm4gYWJpbGl0eU1vZGVsLmdldEFiaWxpdHlQcm9wZXJ0eVZhbHVlKGFiaWxpdHksICdkYW1hZ2UnKSt2KmE7XG4gICAgICAgICAgICB9XG4gICAgICAgIH1cbiAgICBdLFxuICAgICdhbnRpbWFnZV9tYW5hX3ZvaWQnOiBbXG4gICAgICAgIHtcbiAgICAgICAgICAgIGxhYmVsOiAnRW5lbXkgTWlzc2luZyBNYW5hJyxcbiAgICAgICAgICAgIGNvbnRyb2xUeXBlOiAnaW5wdXQnXG4gICAgICAgIH0sXG4gICAgICAgIHtcbiAgICAgICAgICAgIGF0dHJpYnV0ZU5hbWU6ICdtYW5hX3ZvaWRfZGFtYWdlX3Blcl9tYW5hJyxcbiAgICAgICAgICAgIGxhYmVsOiAnVG90YWwgRGFtYWdlJyxcbiAgICAgICAgICAgIGNvbnRyb2xUeXBlOiAndGV4dCcsXG4gICAgICAgICAgICBmbjogZnVuY3Rpb24gKHYsIGEsIHBhcmVudCwgaW5kZXgsIGFiaWxpdHlNb2RlbCwgYWJpbGl0eSkge1xuICAgICAgICAgICAgICAgIHJldHVybiB2KmE7XG4gICAgICAgICAgICB9XG4gICAgICAgIH1cbiAgICBdLFxuICAgICdheGVfYmF0dGxlX2h1bmdlcic6IFtcbiAgICAgICAge1xuICAgICAgICAgICAgbGFiZWw6ICdCYXR0bGUgSHVuZ2VyZWQgRW5lbWllcycsXG4gICAgICAgICAgICBjb250cm9sVHlwZTogJ2lucHV0J1xuICAgICAgICB9LFxuICAgICAgICB7XG4gICAgICAgICAgICBhdHRyaWJ1dGVOYW1lOiAnc3BlZWRfYm9udXMnLFxuICAgICAgICAgICAgbGFiZWw6ICdNb3ZlbWVudCBTcGVlZCBCb251cycsXG4gICAgICAgICAgICBjb250cm9sVHlwZTogJ3RleHQnLFxuICAgICAgICAgICAgbm9MZXZlbDogdHJ1ZSxcbiAgICAgICAgICAgIGZuOiBmdW5jdGlvbiAodiwgYSwgcGFyZW50LCBpbmRleCwgYWJpbGl0eU1vZGVsLCBhYmlsaXR5KSB7XG4gICAgICAgICAgICAgICAgcmV0dXJuIHYqYTtcbiAgICAgICAgICAgIH0sXG4gICAgICAgICAgICByZXR1cm5Qcm9wZXJ0eTogJ21vdmVtZW50U3BlZWRQY3QnXG4gICAgICAgIH0sXG4gICAgICAgIHtcbiAgICAgICAgICAgIGF0dHJpYnV0ZU5hbWU6ICdzbG93JyxcbiAgICAgICAgICAgIGxhYmVsOiAnTW92ZW1lbnQgU3BlZWQgQm9udXMnLFxuICAgICAgICAgICAgY29udHJvbFR5cGU6ICd0ZXh0JyxcbiAgICAgICAgICAgIG5vTGV2ZWw6IHRydWUsXG4gICAgICAgICAgICBmbjogZnVuY3Rpb24gKHYsIGEsIHBhcmVudCwgaW5kZXgsIGFiaWxpdHlNb2RlbCwgYWJpbGl0eSkge1xuICAgICAgICAgICAgICAgIHJldHVybiBhO1xuICAgICAgICAgICAgfSxcbiAgICAgICAgICAgIHJldHVyblByb3BlcnR5OiAnbW92ZW1lbnRTcGVlZFBjdFJlZHVjdGlvbidcbiAgICAgICAgfVxuICAgIF0sXG4gICAgJ2JhbmVfbmlnaHRtYXJlJzogW1xuICAgICAgICB7XG4gICAgICAgICAgICBsYWJlbDogJ0R1cmF0aW9uJyxcbiAgICAgICAgICAgIGNvbnRyb2xUeXBlOiAnaW5wdXQnXG4gICAgICAgIH0sXG4gICAgICAgIHtcbiAgICAgICAgICAgIGxhYmVsOiAnREFNQUdFOicsXG4gICAgICAgICAgICBjb250cm9sVHlwZTogJ3RleHQnLFxuICAgICAgICAgICAgZm46IGZ1bmN0aW9uICh2LCBhLCBwYXJlbnQsIGluZGV4LCBhYmlsaXR5TW9kZWwsIGFiaWxpdHkpIHtcbiAgICAgICAgICAgICAgICByZXR1cm4gYWJpbGl0eU1vZGVsLmdldEFiaWxpdHlQcm9wZXJ0eVZhbHVlKGFiaWxpdHksICdkYW1hZ2UnKSp2O1xuICAgICAgICAgICAgfVxuICAgICAgICB9XG4gICAgXSxcbiAgICAnYmFuZV9maWVuZHNfZ3JpcCc6IFtcbiAgICAgICAge1xuICAgICAgICAgICAgbGFiZWw6ICdEdXJhdGlvbicsXG4gICAgICAgICAgICBjb250cm9sVHlwZTogJ2lucHV0J1xuICAgICAgICB9LFxuICAgICAgICB7XG4gICAgICAgICAgICBsYWJlbDogJ0VuZW15IE1heCBNYW5hJyxcbiAgICAgICAgICAgIGNvbnRyb2xUeXBlOiAnaW5wdXQnXG4gICAgICAgIH0sXG4gICAgICAgIHtcbiAgICAgICAgICAgIGF0dHJpYnV0ZU5hbWU6ICdmaWVuZF9ncmlwX2RhbWFnZScsXG4gICAgICAgICAgICBsYWJlbDogJ1RvdGFsIERhbWFnZScsXG4gICAgICAgICAgICBjb250cm9sVHlwZTogJ3RleHQnLFxuICAgICAgICAgICAgY29udHJvbHM6IFswLDFdLFxuICAgICAgICAgICAgZm46IGZ1bmN0aW9uICh2LCBhLCBwYXJlbnQsIGluZGV4LCBhYmlsaXR5TW9kZWwsIGFiaWxpdHkpIHtcbiAgICAgICAgICAgICAgICBpZiAocGFyZW50LmludmVudG9yeS5oYXNTY2VwdGVyKCkpIHtcbiAgICAgICAgICAgICAgICAgICAgcmV0dXJuIHZbMF0qYWJpbGl0eU1vZGVsLmdldEFiaWxpdHlBdHRyaWJ1dGVWYWx1ZShhYmlsaXR5LmF0dHJpYnV0ZXMsICdmaWVuZF9ncmlwX2RhbWFnZV9zY2VwdGVyJyxhYmlsaXR5LmxldmVsKCkpO1xuICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgICBlbHNlIHtcbiAgICAgICAgICAgICAgICAgICAgcmV0dXJuIHZbMF0qYTtcbiAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICB9XG4gICAgICAgIH0sXG4gICAgICAgIHtcbiAgICAgICAgICAgIGF0dHJpYnV0ZU5hbWU6ICdmaWVuZF9ncmlwX21hbmFfZHJhaW4nLFxuICAgICAgICAgICAgbGFiZWw6ICdUb3RhbCBNYW5hIERyYWluJyxcbiAgICAgICAgICAgIGNvbnRyb2xUeXBlOiAndGV4dCcsXG4gICAgICAgICAgICBjb250cm9sczogWzAsMV0sXG4gICAgICAgICAgICBub0xldmVsOiB0cnVlLFxuICAgICAgICAgICAgZm46IGZ1bmN0aW9uICh2LCBhLCBwYXJlbnQsIGluZGV4LCBhYmlsaXR5TW9kZWwsIGFiaWxpdHkpIHtcbiAgICAgICAgICAgICAgICBpZiAocGFyZW50LmludmVudG9yeS5oYXNTY2VwdGVyKCkpIHtcbiAgICAgICAgICAgICAgICAgICAgcmV0dXJuIHZbMF0qdlsxXSphYmlsaXR5TW9kZWwuZ2V0QWJpbGl0eUF0dHJpYnV0ZVZhbHVlKGFiaWxpdHkuYXR0cmlidXRlcywgJ2ZpZW5kX2dyaXBfbWFuYV9kcmFpbl9zY2VwdGVyJyxhYmlsaXR5LmxldmVsKCkpLzEwMDtcbiAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgICAgZWxzZSB7XG4gICAgICAgICAgICAgICAgICAgIHJldHVybiB2WzBdKnZbMV0qYS8xMDA7XG4gICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgfVxuICAgICAgICB9XG4gICAgXSxcbiAgICAnYmF0cmlkZXJfc3RpY2t5X25hcGFsbSc6IFtcbiAgICAgICAge1xuICAgICAgICAgICAgbGFiZWw6ICdTdGFja3MnLFxuICAgICAgICAgICAgY29udHJvbFR5cGU6ICdpbnB1dCdcbiAgICAgICAgfSxcbiAgICAgICAge1xuICAgICAgICAgICAgYXR0cmlidXRlTmFtZTogJ2RhbWFnZScsXG4gICAgICAgICAgICBsYWJlbDogJ1RvdGFsIEJvbnVzIERhbWFnZScsXG4gICAgICAgICAgICBjb250cm9sVHlwZTogJ3RleHQnLFxuICAgICAgICAgICAgZm46IGZ1bmN0aW9uICh2LCBhLCBwYXJlbnQsIGluZGV4LCBhYmlsaXR5TW9kZWwsIGFiaWxpdHkpIHtcbiAgICAgICAgICAgICAgICByZXR1cm4gdiphO1xuICAgICAgICAgICAgfSxcbiAgICAgICAgICAgIHJldHVyblByb3BlcnR5OiAnYm9udXNEYW1hZ2UnXG4gICAgICAgIH0sXG4gICAgICAgIHtcbiAgICAgICAgICAgIGF0dHJpYnV0ZU5hbWU6ICdtb3ZlbWVudF9zcGVlZF9wY3QnLFxuICAgICAgICAgICAgbGFiZWw6ICdFbmVteSBNb3ZlbWVudCBTcGVlZCBTbG93JyxcbiAgICAgICAgICAgIGNvbnRyb2xUeXBlOiAndGV4dCcsXG4gICAgICAgICAgICBmbjogZnVuY3Rpb24gKHYsIGEsIHBhcmVudCwgaW5kZXgsIGFiaWxpdHlNb2RlbCwgYWJpbGl0eSkge1xuICAgICAgICAgICAgICAgIHJldHVybiB2KmE7XG4gICAgICAgICAgICB9LFxuICAgICAgICAgICAgcmV0dXJuUHJvcGVydHk6ICdtb3ZlbWVudFNwZWVkUGN0UmVkdWN0aW9uJ1xuICAgICAgICB9LFxuICAgICAgICB7XG4gICAgICAgICAgICBhdHRyaWJ1dGVOYW1lOiAndHVybl9yYXRlX3BjdCcsXG4gICAgICAgICAgICBsYWJlbDogJ0VuZW15IFR1cm4gUmF0ZSBTbG93JyxcbiAgICAgICAgICAgIGNvbnRyb2xUeXBlOiAndGV4dCcsXG4gICAgICAgICAgICBmbjogZnVuY3Rpb24gKHYsIGEsIHBhcmVudCwgaW5kZXgsIGFiaWxpdHlNb2RlbCwgYWJpbGl0eSkge1xuICAgICAgICAgICAgICAgIHJldHVybiBhO1xuICAgICAgICAgICAgfSxcbiAgICAgICAgICAgIHJldHVyblByb3BlcnR5OiAndHVyblJhdGVSZWR1Y3Rpb24nXG4gICAgICAgIH1cbiAgICBdLFxuICAgICdiYXRyaWRlcl9maXJlZmx5JzogW1xuICAgICAgICB7XG4gICAgICAgICAgICBsYWJlbDogJ0R1cmF0aW9uJyxcbiAgICAgICAgICAgIGNvbnRyb2xUeXBlOiAnaW5wdXQnXG4gICAgICAgIH0sXG4gICAgICAgIHtcbiAgICAgICAgICAgIGF0dHJpYnV0ZU5hbWU6ICdkYW1hZ2VfcGVyX3NlY29uZCcsXG4gICAgICAgICAgICBsYWJlbDogJ1RvdGFsIERhbWFnZScsXG4gICAgICAgICAgICBjb250cm9sVHlwZTogJ3RleHQnLFxuICAgICAgICAgICAgZm46IGZ1bmN0aW9uICh2LCBhLCBwYXJlbnQsIGluZGV4LCBhYmlsaXR5TW9kZWwsIGFiaWxpdHkpIHtcbiAgICAgICAgICAgICAgICByZXR1cm4gdiphO1xuICAgICAgICAgICAgfVxuICAgICAgICB9XG4gICAgXSxcbiAgICAnYmxvb2RzZWVrZXJfcnVwdHVyZSc6IFtcbiAgICAgICAge1xuICAgICAgICAgICAgbGFiZWw6ICdFbmVteSBEaXN0YW5jZSBUcmF2ZWxlZCcsXG4gICAgICAgICAgICBjb250cm9sVHlwZTogJ2lucHV0J1xuICAgICAgICB9LFxuICAgICAgICB7XG4gICAgICAgICAgICBhdHRyaWJ1dGVOYW1lOiAnbW92ZW1lbnRfZGFtYWdlX3BjdCcsXG4gICAgICAgICAgICBsYWJlbDogJ0RBTUFHRTonLFxuICAgICAgICAgICAgaWdub3JlVG9vbHRpcDogdHJ1ZSxcbiAgICAgICAgICAgIGNvbnRyb2xUeXBlOiAndGV4dCcsXG4gICAgICAgICAgICBmbjogZnVuY3Rpb24gKHYsIGEsIHBhcmVudCwgaW5kZXgsIGFiaWxpdHlNb2RlbCwgYWJpbGl0eSkge1xuICAgICAgICAgICAgICAgIHJldHVybiBhYmlsaXR5TW9kZWwuZ2V0QWJpbGl0eVByb3BlcnR5VmFsdWUoYWJpbGl0eSwgJ2RhbWFnZScpICsgdiphLzEwMDtcbiAgICAgICAgICAgIH1cbiAgICAgICAgfVxuICAgIF0sXG4gICAgJ2JyaXN0bGViYWNrX3Zpc2NvdXNfbmFzYWxfZ29vJzogW1xuICAgICAgICB7XG4gICAgICAgICAgICBsYWJlbDogJ1N0YWNrcycsXG4gICAgICAgICAgICBjb250cm9sVHlwZTogJ2lucHV0J1xuICAgICAgICB9LFxuICAgICAgICB7XG4gICAgICAgICAgICBhdHRyaWJ1dGVOYW1lOiAnYXJtb3JfcGVyX3N0YWNrJyxcbiAgICAgICAgICAgIGxhYmVsOiAnRW5lbXkgQXJtb3IgUmVkdWN0aW9uJyxcbiAgICAgICAgICAgIGNvbnRyb2xUeXBlOiAndGV4dCcsXG4gICAgICAgICAgICBmbjogZnVuY3Rpb24gKHYsIGEsIHBhcmVudCwgaW5kZXgsIGFiaWxpdHlNb2RlbCwgYWJpbGl0eSkge1xuICAgICAgICAgICAgICAgIHJldHVybiAtdiphO1xuICAgICAgICAgICAgfSxcbiAgICAgICAgICAgIHJldHVyblByb3BlcnR5OiAnYXJtb3JSZWR1Y3Rpb24nXG4gICAgICAgIH0sXG4gICAgICAgIHtcbiAgICAgICAgICAgIGF0dHJpYnV0ZU5hbWU6ICdtb3ZlX3Nsb3dfcGVyX3N0YWNrJyxcbiAgICAgICAgICAgIGxhYmVsOiAnJVNMT1c6JyxcbiAgICAgICAgICAgIGlnbm9yZVRvb2x0aXA6IHRydWUsXG4gICAgICAgICAgICBjb250cm9sVHlwZTogJ3RleHQnLFxuICAgICAgICAgICAgZm46IGZ1bmN0aW9uICh2LCBhLCBwYXJlbnQsIGluZGV4LCBhYmlsaXR5TW9kZWwsIGFiaWxpdHkpIHtcbiAgICAgICAgICAgICAgICByZXR1cm4gLShhYmlsaXR5TW9kZWwuZ2V0QWJpbGl0eUF0dHJpYnV0ZVZhbHVlKGFiaWxpdHkuYXR0cmlidXRlcywgJ2Jhc2VfbW92ZV9zbG93JywwKSt2KmEpO1xuICAgICAgICAgICAgfSxcbiAgICAgICAgICAgIHJldHVyblByb3BlcnR5OiAnbW92ZW1lbnRTcGVlZFBjdFJlZHVjdGlvbidcbiAgICAgICAgfVxuICAgIF0sXG4gICAgJ2JyaXN0bGViYWNrX3F1aWxsX3NwcmF5JzogW1xuICAgICAgICB7XG4gICAgICAgICAgICBsYWJlbDogJ1N0YWNrcycsXG4gICAgICAgICAgICBjb250cm9sVHlwZTogJ2lucHV0J1xuICAgICAgICB9LFxuICAgICAgICB7XG4gICAgICAgICAgICBhdHRyaWJ1dGVOYW1lOiAncXVpbGxfc3RhY2tfZGFtYWdlJyxcbiAgICAgICAgICAgIGxhYmVsOiAnREFNQUdFJyxcbiAgICAgICAgICAgIGNvbnRyb2xUeXBlOiAndGV4dCcsXG4gICAgICAgICAgICBmbjogZnVuY3Rpb24gKHYsIGEsIHBhcmVudCwgaW5kZXgsIGFiaWxpdHlNb2RlbCwgYWJpbGl0eSkge1xuICAgICAgICAgICAgICAgIHZhciB0b3RhbCA9IGFiaWxpdHlNb2RlbC5nZXRBYmlsaXR5QXR0cmlidXRlVmFsdWUoYWJpbGl0eS5hdHRyaWJ1dGVzLCAncXVpbGxfYmFzZV9kYW1hZ2UnLGFiaWxpdHkubGV2ZWwoKSkrdiphLFxuICAgICAgICAgICAgICAgIGRhbWFnZV9jYXAgPSBhYmlsaXR5TW9kZWwuZ2V0QWJpbGl0eUF0dHJpYnV0ZVZhbHVlKGFiaWxpdHkuYXR0cmlidXRlcywgJ21heF9kYW1hZ2UnLDApO1xuICAgICAgICAgICAgICAgIGlmICh0b3RhbCA+IGRhbWFnZV9jYXApIHtcbiAgICAgICAgICAgICAgICAgICAgdG90YWwgPSBkYW1hZ2VfY2FwO1xuICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgICByZXR1cm4gdG90YWw7XG4gICAgICAgICAgICB9XG4gICAgICAgIH1cbiAgICBdLFxuICAgICdicmlzdGxlYmFja19icmlzdGxlYmFjayc6IFtcbiAgICAgICAge1xuICAgICAgICAgICAgbGFiZWw6ICdEYW1hZ2UgRnJvbScsXG4gICAgICAgICAgICBjb250cm9sVHlwZTogJ3JhZGlvJyxcbiAgICAgICAgICAgIGNvbnRyb2xWYWx1ZVR5cGU6ICdzdHJpbmcnLFxuICAgICAgICAgICAgY29udHJvbE9wdGlvbnM6IFtcbiAgICAgICAgICAgICAgICB7dGV4dDogJ0JhY2snLCB2YWx1ZTogJ2JhY2snfSxcbiAgICAgICAgICAgICAgICB7dGV4dDogJ1NpZGUnLCB2YWx1ZTogJ3NpZGUnfVxuICAgICAgICAgICAgXVxuICAgICAgICB9LFxuICAgICAgICB7XG4gICAgICAgICAgICBhdHRyaWJ1dGVOYW1lOiAnYmFja19kYW1hZ2VfcmVkdWN0aW9uJyxcbiAgICAgICAgICAgIGxhYmVsOiAnJURBTUFHRSBSRURVQ1RJT046JyxcbiAgICAgICAgICAgIGlnbm9yZVRvb2x0aXA6IHRydWUsXG4gICAgICAgICAgICBjb250cm9sVHlwZTogJ3RleHQnLFxuICAgICAgICAgICAgZm46IGZ1bmN0aW9uICh2LCBhLCBwYXJlbnQsIGluZGV4LCBhYmlsaXR5TW9kZWwsIGFiaWxpdHkpIHtcbiAgICAgICAgICAgICAgICB2YXIgYWJpbGl0eSA9IGFiaWxpdHlNb2RlbC5hYmlsaXRpZXMoKS5maW5kKGZ1bmN0aW9uKGIpIHtcbiAgICAgICAgICAgICAgICAgICAgcmV0dXJuIGIubmFtZSA9PSAnYnJpc3RsZWJhY2tfYnJpc3RsZWJhY2snO1xuICAgICAgICAgICAgICAgIH0pO1xuICAgICAgICAgICAgICAgIGlmICh2ID09ICdiYWNrJykge1xuICAgICAgICAgICAgICAgICAgICB2YXIgdG90YWwgPSBhYmlsaXR5TW9kZWwuZ2V0QWJpbGl0eUF0dHJpYnV0ZVZhbHVlKGFiaWxpdHkuYXR0cmlidXRlcywgJ2JhY2tfZGFtYWdlX3JlZHVjdGlvbicsIGFiaWxpdHkubGV2ZWwoKSk7XG4gICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICAgIGVsc2Uge1xuICAgICAgICAgICAgICAgICAgICB2YXIgdG90YWwgPSBhYmlsaXR5TW9kZWwuZ2V0QWJpbGl0eUF0dHJpYnV0ZVZhbHVlKGFiaWxpdHkuYXR0cmlidXRlcywgJ3NpZGVfZGFtYWdlX3JlZHVjdGlvbicsIGFiaWxpdHkubGV2ZWwoKSk7XG4gICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICAgIHJldHVybiAtdG90YWw7XG4gICAgICAgICAgICB9LFxuICAgICAgICAgICAgcmV0dXJuUHJvcGVydHk6ICdkYW1hZ2VSZWR1Y3Rpb24nXG4gICAgICAgIH1cbiAgICBdLFxuICAgICdicmlzdGxlYmFja193YXJwYXRoJzogW1xuICAgICAgICB7XG4gICAgICAgICAgICBsYWJlbDogJ1N0YWNrcycsXG4gICAgICAgICAgICBjb250cm9sVHlwZTogJ2lucHV0J1xuICAgICAgICB9LFxuICAgICAgICB7XG4gICAgICAgICAgICBhdHRyaWJ1dGVOYW1lOiAnZGFtYWdlX3Blcl9zdGFjaycsXG4gICAgICAgICAgICBsYWJlbDogJ0JPTlVTIERBTUFHRTonLFxuICAgICAgICAgICAgaWdub3JlVG9vbHRpcDogdHJ1ZSxcbiAgICAgICAgICAgIGNvbnRyb2xUeXBlOiAndGV4dCcsXG4gICAgICAgICAgICBmbjogZnVuY3Rpb24gKHYsIGEsIHBhcmVudCwgaW5kZXgsIGFiaWxpdHlNb2RlbCwgYWJpbGl0eSkge1xuICAgICAgICAgICAgICAgIGlmICh2IDwgMSkge1xuICAgICAgICAgICAgICAgICAgICByZXR1cm4gMDtcbiAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgICAgZWxzZSB7XG4gICAgICAgICAgICAgICAgICAgIHJldHVybiBhYmlsaXR5TW9kZWwuZ2V0QWJpbGl0eUF0dHJpYnV0ZVZhbHVlKGFiaWxpdHkuYXR0cmlidXRlcywgJ2Jhc2VfZGFtYWdlJyxhYmlsaXR5LmxldmVsKCkpKyh2LTEpKmE7XG4gICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgfVxuICAgICAgICB9LFxuICAgICAgICB7XG4gICAgICAgICAgICBhdHRyaWJ1dGVOYW1lOiAnbW92ZV9zcGVlZF9wZXJfc3RhY2snLFxuICAgICAgICAgICAgbGFiZWw6ICclTU9WRU1FTlQ6JyxcbiAgICAgICAgICAgIGlnbm9yZVRvb2x0aXA6IHRydWUsXG4gICAgICAgICAgICBjb250cm9sVHlwZTogJ3RleHQnLFxuICAgICAgICAgICAgZm46IGZ1bmN0aW9uICh2LCBhLCBwYXJlbnQsIGluZGV4LCBhYmlsaXR5TW9kZWwsIGFiaWxpdHkpIHtcbiAgICAgICAgICAgICAgICBpZiAodiA8IDEpIHtcbiAgICAgICAgICAgICAgICAgICAgcmV0dXJuIDA7XG4gICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICAgIGVsc2Uge1xuICAgICAgICAgICAgICAgICAgICByZXR1cm4gYWJpbGl0eU1vZGVsLmdldEFiaWxpdHlBdHRyaWJ1dGVWYWx1ZShhYmlsaXR5LmF0dHJpYnV0ZXMsICdiYXNlX21vdmVfc3BlZWQnLGFiaWxpdHkubGV2ZWwoKSkrKHYtMSkqYTtcbiAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICB9LFxuICAgICAgICAgICAgcmV0dXJuUHJvcGVydHk6ICdtb3ZlbWVudFNwZWVkUGN0J1xuICAgICAgICB9XG4gICAgXSxcbiAgICAnY2VudGF1cl9yZXR1cm4nOiBbXG4gICAgICAgIHtcbiAgICAgICAgICAgIGxhYmVsOiAnU3RyZW5ndGgnLFxuICAgICAgICAgICAgY29udHJvbFR5cGU6ICdpbnB1dCdcbiAgICAgICAgfSxcbiAgICAgICAge1xuICAgICAgICAgICAgYXR0cmlidXRlTmFtZTogJ3N0cmVuZ3RoX3BjdCcsXG4gICAgICAgICAgICBsYWJlbDogJ0RBTUFHRTonLFxuICAgICAgICAgICAgY29udHJvbFR5cGU6ICd0ZXh0JyxcbiAgICAgICAgICAgIGZuOiBmdW5jdGlvbiAodiwgYSwgcGFyZW50LCBpbmRleCwgYWJpbGl0eU1vZGVsLCBhYmlsaXR5KSB7XG4gICAgICAgICAgICAgICAgcmV0dXJuIGFiaWxpdHlNb2RlbC5nZXRBYmlsaXR5QXR0cmlidXRlVmFsdWUoYWJpbGl0eS5hdHRyaWJ1dGVzLCAncmV0dXJuX2RhbWFnZScsYWJpbGl0eS5sZXZlbCgpKSArIHYqYS8xMDA7XG4gICAgICAgICAgICB9XG4gICAgICAgIH1cbiAgICBdLFxuICAgICdjZW50YXVyX3N0YW1wZWRlJzogW1xuICAgICAgICB7XG4gICAgICAgICAgICBsYWJlbDogJ1N0cmVuZ3RoJyxcbiAgICAgICAgICAgIGNvbnRyb2xUeXBlOiAnaW5wdXQnXG4gICAgICAgIH0sXG4gICAgICAgIHtcbiAgICAgICAgICAgIGF0dHJpYnV0ZU5hbWU6ICdzdHJlbmd0aF9kYW1hZ2UnLFxuICAgICAgICAgICAgbGFiZWw6ICdEQU1BR0U6JyxcbiAgICAgICAgICAgIGlnbm9yZVRvb2x0aXA6IHRydWUsXG4gICAgICAgICAgICBjb250cm9sVHlwZTogJ3RleHQnLFxuICAgICAgICAgICAgZm46IGZ1bmN0aW9uICh2LCBhLCBwYXJlbnQsIGluZGV4LCBhYmlsaXR5TW9kZWwsIGFiaWxpdHkpIHtcbiAgICAgICAgICAgICAgICByZXR1cm4gdiphO1xuICAgICAgICAgICAgfVxuICAgICAgICB9LFxuICAgICAgICB7XG4gICAgICAgICAgICBhdHRyaWJ1dGVOYW1lOiAnc2xvd19tb3ZlbWVudF9zcGVlZCcsXG4gICAgICAgICAgICBsYWJlbDogJ0VuZW15IE1vdmVtZW50IFNwZWVkIFNsb3cnLFxuICAgICAgICAgICAgY29udHJvbFR5cGU6ICd0ZXh0JyxcbiAgICAgICAgICAgIGZuOiBmdW5jdGlvbiAodiwgYSwgcGFyZW50LCBpbmRleCwgYWJpbGl0eU1vZGVsLCBhYmlsaXR5KSB7XG4gICAgICAgICAgICAgICAgcmV0dXJuIC1hO1xuICAgICAgICAgICAgfSxcbiAgICAgICAgICAgIHJldHVyblByb3BlcnR5OiAnbW92ZW1lbnRTcGVlZFBjdFJlZHVjdGlvbidcbiAgICAgICAgfVxuICAgIF0sXG4gICAgJ2NsaW5rel9kZWF0aF9wYWN0JzogW1xuICAgICAgICB7XG4gICAgICAgICAgICBsYWJlbDogJ0NvbnN1bWVkIFVuaXQgSFAnLFxuICAgICAgICAgICAgY29udHJvbFR5cGU6ICdpbnB1dCdcbiAgICAgICAgfSxcbiAgICAgICAge1xuICAgICAgICAgICAgYXR0cmlidXRlTmFtZTogJ2RhbWFnZV9nYWluX3BjdCcsXG4gICAgICAgICAgICBsYWJlbDogJ0JBU0UgREFNQUdFIEdBSU46JyxcbiAgICAgICAgICAgIGlnbm9yZVRvb2x0aXA6IHRydWUsXG4gICAgICAgICAgICBjb250cm9sVHlwZTogJ3RleHQnLFxuICAgICAgICAgICAgZm46IGZ1bmN0aW9uICh2LCBhLCBwYXJlbnQsIGluZGV4LCBhYmlsaXR5TW9kZWwsIGFiaWxpdHkpIHtcbiAgICAgICAgICAgICAgICByZXR1cm4gdiphLzEwMDtcbiAgICAgICAgICAgIH0sXG4gICAgICAgICAgICByZXR1cm5Qcm9wZXJ0eTogJ2Jhc2VEYW1hZ2UnXG4gICAgICAgIH0sXG4gICAgICAgIHtcbiAgICAgICAgICAgIGF0dHJpYnV0ZU5hbWU6ICdoZWFsdGhfZ2Fpbl9wY3QnLFxuICAgICAgICAgICAgbGFiZWw6ICdIRUFMVEggR0FJTjonLFxuICAgICAgICAgICAgaWdub3JlVG9vbHRpcDogdHJ1ZSxcbiAgICAgICAgICAgIGNvbnRyb2xUeXBlOiAndGV4dCcsXG4gICAgICAgICAgICBmbjogZnVuY3Rpb24gKHYsIGEsIHBhcmVudCwgaW5kZXgsIGFiaWxpdHlNb2RlbCwgYWJpbGl0eSkge1xuICAgICAgICAgICAgICAgIHJldHVybiB2KmEvMTAwO1xuICAgICAgICAgICAgfSxcbiAgICAgICAgICAgIHJldHVyblByb3BlcnR5OiAnYm9udXNIZWFsdGgnXG4gICAgICAgIH1cbiAgICBdLFxuICAgICdjcnlzdGFsX21haWRlbl9mcm9zdGJpdGUnOiBbXG4gICAgICAgIHtcbiAgICAgICAgICAgIGxhYmVsOiAnRHVyYXRpb24nLFxuICAgICAgICAgICAgY29udHJvbFR5cGU6ICdpbnB1dCdcbiAgICAgICAgfSxcbiAgICAgICAge1xuICAgICAgICAgICAgbGFiZWw6ICdEQU1BR0U6JyxcbiAgICAgICAgICAgIGNvbnRyb2xUeXBlOiAndGV4dCcsXG4gICAgICAgICAgICBmbjogZnVuY3Rpb24gKHYsIGEsIHBhcmVudCwgaW5kZXgsIGFiaWxpdHlNb2RlbCwgYWJpbGl0eSkge1xuICAgICAgICAgICAgICAgIHJldHVybiBhYmlsaXR5TW9kZWwuZ2V0QWJpbGl0eVByb3BlcnR5VmFsdWUoYWJpbGl0eSwgJ2RhbWFnZScpKnY7XG4gICAgICAgICAgICB9XG4gICAgICAgIH1cbiAgICBdLFxuICAgICdkYXJrX3NlZXJfaW9uX3NoZWxsJzogW1xuICAgICAgICB7XG4gICAgICAgICAgICBsYWJlbDogJ0R1cmF0aW9uJyxcbiAgICAgICAgICAgIGNvbnRyb2xUeXBlOiAnaW5wdXQnXG4gICAgICAgIH0sXG4gICAgICAgIHtcbiAgICAgICAgICAgIGF0dHJpYnV0ZU5hbWU6ICdkYW1hZ2VfcGVyX3NlY29uZCcsXG4gICAgICAgICAgICBsYWJlbDogJ1RvdGFsIERhbWFnZScsXG4gICAgICAgICAgICBjb250cm9sVHlwZTogJ3RleHQnLFxuICAgICAgICAgICAgZm46IGZ1bmN0aW9uICh2LCBhLCBwYXJlbnQsIGluZGV4LCBhYmlsaXR5TW9kZWwsIGFiaWxpdHkpIHtcbiAgICAgICAgICAgICAgICByZXR1cm4gdiphO1xuICAgICAgICAgICAgfVxuICAgICAgICB9XG4gICAgXSxcbiAgICAnZGF6emxlX3NoYWRvd193YXZlJzogW1xuICAgICAgICB7XG4gICAgICAgICAgICBsYWJlbDogJ1RhcmdldHMnLFxuICAgICAgICAgICAgY29udHJvbFR5cGU6ICdpbnB1dCdcbiAgICAgICAgfSxcbiAgICAgICAge1xuICAgICAgICAgICAgbGFiZWw6ICdEQU1BR0U6JyxcbiAgICAgICAgICAgIGNvbnRyb2xUeXBlOiAndGV4dCcsXG4gICAgICAgICAgICBmbjogZnVuY3Rpb24gKHYsIGEsIHBhcmVudCwgaW5kZXgsIGFiaWxpdHlNb2RlbCwgYWJpbGl0eSkge1xuICAgICAgICAgICAgICAgIHJldHVybiBhYmlsaXR5TW9kZWwuZ2V0QWJpbGl0eVByb3BlcnR5VmFsdWUoYWJpbGl0eSwgJ2RhbWFnZScpKnY7XG4gICAgICAgICAgICB9XG4gICAgICAgIH1cbiAgICBdLFxuICAgICdkYXp6bGVfd2VhdmUnOiBbXG4gICAgICAgIHtcbiAgICAgICAgICAgIGxhYmVsOiAnRHVyYXRpb24nLFxuICAgICAgICAgICAgY29udHJvbFR5cGU6ICdpbnB1dCdcbiAgICAgICAgfSxcbiAgICAgICAge1xuICAgICAgICAgICAgYXR0cmlidXRlTmFtZTogJ2FybW9yX3Blcl9zZWNvbmQnLFxuICAgICAgICAgICAgbGFiZWw6ICdBUk1PUicsXG4gICAgICAgICAgICBpZ25vcmVUb29sdGlwOiB0cnVlLFxuICAgICAgICAgICAgY29udHJvbFR5cGU6ICd0ZXh0JyxcbiAgICAgICAgICAgIGZuOiBmdW5jdGlvbiAodiwgYSwgcGFyZW50LCBpbmRleCwgYWJpbGl0eU1vZGVsLCBhYmlsaXR5KSB7XG4gICAgICAgICAgICAgICAgcmV0dXJuIHYqYTtcbiAgICAgICAgICAgIH0sXG4gICAgICAgICAgICByZXR1cm5Qcm9wZXJ0eTogJ2FybW9yJ1xuICAgICAgICB9LFxuICAgICAgICB7XG4gICAgICAgICAgICBhdHRyaWJ1dGVOYW1lOiAnYXJtb3JfcGVyX3NlY29uZCcsXG4gICAgICAgICAgICBsYWJlbDogJ0FSTU9SIFJFRFVDVElPTjonLFxuICAgICAgICAgICAgaWdub3JlVG9vbHRpcDogdHJ1ZSxcbiAgICAgICAgICAgIGNvbnRyb2xUeXBlOiAndGV4dCcsXG4gICAgICAgICAgICBmbjogZnVuY3Rpb24gKHYsIGEsIHBhcmVudCwgaW5kZXgsIGFiaWxpdHlNb2RlbCwgYWJpbGl0eSkge1xuICAgICAgICAgICAgICAgIHJldHVybiAtdiphO1xuICAgICAgICAgICAgfSxcbiAgICAgICAgICAgIHJldHVyblByb3BlcnR5OiAnYXJtb3JSZWR1Y3Rpb24nXG4gICAgICAgIH1cbiAgICBdLFxuICAgICdkZWF0aF9wcm9waGV0X2V4b3JjaXNtJzogW1xuICAgICAgICB7XG4gICAgICAgICAgICBsYWJlbDogJ0RhbWFnZSBEZWFsdCcsXG4gICAgICAgICAgICBjb250cm9sVHlwZTogJ2lucHV0J1xuICAgICAgICB9LFxuICAgICAgICB7XG4gICAgICAgICAgICBhdHRyaWJ1dGVOYW1lOiAnaGVhbF9wZXJjZW50JyxcbiAgICAgICAgICAgIGxhYmVsOiAnVG90YWwgQXJtb3InLFxuICAgICAgICAgICAgY29udHJvbFR5cGU6ICd0ZXh0JyxcbiAgICAgICAgICAgIGZuOiBmdW5jdGlvbiAodiwgYSwgcGFyZW50LCBpbmRleCwgYWJpbGl0eU1vZGVsLCBhYmlsaXR5KSB7XG4gICAgICAgICAgICAgICAgcmV0dXJuIHYqYS8xMDA7XG4gICAgICAgICAgICB9XG4gICAgICAgIH1cbiAgICBdLFxuICAgICdkaXNydXB0b3Jfc3RhdGljX3N0b3JtJzogW1xuICAgICAgICB7XG4gICAgICAgICAgICBsYWJlbDogJ0R1cmF0aW9uJyxcbiAgICAgICAgICAgIGNvbnRyb2xUeXBlOiAnaW5wdXQnXG4gICAgICAgIH0sXG4gICAgICAgIHtcbiAgICAgICAgICAgIGxhYmVsOiAnREFNQUdFOicsXG4gICAgICAgICAgICBjb250cm9sVHlwZTogJ3RleHQnLFxuICAgICAgICAgICAgZm46IGZ1bmN0aW9uICh2LCBhLCBwYXJlbnQsIGluZGV4LCBhYmlsaXR5TW9kZWwsIGFiaWxpdHkpIHtcbiAgICAgICAgICAgICAgICB2YXIgZGFtYWdldmFsdWUgPSAwLjI1ICogKDEzMCArIDQwICogYWJpbGl0eS5sZXZlbCgpKSAqICgxLzIwKSxcbiAgICAgICAgICAgICAgICBtdWx0ID0gKHYqNCkqKCh2KjQpKzEpLzI7XG4gICAgICAgICAgICAgICAgcmV0dXJuIGRhbWFnZXZhbHVlICogbXVsdDtcbiAgICAgICAgICAgIH1cbiAgICAgICAgfVxuICAgIF0sXG4gICAgJ2Rvb21fYnJpbmdlcl9zY29yY2hlZF9lYXJ0aCc6IFtcbiAgICAgICAge1xuICAgICAgICAgICAgbGFiZWw6ICdEdXJhdGlvbicsXG4gICAgICAgICAgICBjb250cm9sVHlwZTogJ2lucHV0J1xuICAgICAgICB9LFxuICAgICAgICB7XG4gICAgICAgICAgICBhdHRyaWJ1dGVOYW1lOiAnZGFtYWdlX3Blcl9zZWNvbmQnLFxuICAgICAgICAgICAgbGFiZWw6ICdUb3RhbCBEYW1hZ2UnLFxuICAgICAgICAgICAgY29udHJvbFR5cGU6ICd0ZXh0JyxcbiAgICAgICAgICAgIGZuOiBmdW5jdGlvbiAodiwgYSwgcGFyZW50LCBpbmRleCwgYWJpbGl0eU1vZGVsLCBhYmlsaXR5KSB7XG4gICAgICAgICAgICAgICAgcmV0dXJuIHYqYTtcbiAgICAgICAgICAgIH1cbiAgICAgICAgfSxcbiAgICAgICAge1xuICAgICAgICAgICAgYXR0cmlidXRlTmFtZTogJ2JvbnVzX21vdmVtZW50X3NwZWVkX3BjdCcsXG4gICAgICAgICAgICBsYWJlbDogJ1RvdGFsIERhbWFnZScsXG4gICAgICAgICAgICBjb250cm9sVHlwZTogJ3RleHQnLFxuICAgICAgICAgICAgZm46IGZ1bmN0aW9uICh2LCBhLCBwYXJlbnQsIGluZGV4LCBhYmlsaXR5TW9kZWwsIGFiaWxpdHkpIHtcbiAgICAgICAgICAgICAgICByZXR1cm4gYTtcbiAgICAgICAgICAgIH0sXG4gICAgICAgICAgICByZXR1cm5Qcm9wZXJ0eTogJ21vdmVtZW50U3BlZWRQY3QnXG4gICAgICAgIH0sXG4gICAgICAgIHtcbiAgICAgICAgICAgIGF0dHJpYnV0ZU5hbWU6ICdkYW1hZ2VfcGVyX3NlY29uZCcsXG4gICAgICAgICAgICBsYWJlbDogJ0hQIFJFR0VOOicsXG4gICAgICAgICAgICBpZ25vcmVUb29sdGlwOiB0cnVlLFxuICAgICAgICAgICAgY29udHJvbFR5cGU6ICd0ZXh0JyxcbiAgICAgICAgICAgIGZuOiBmdW5jdGlvbiAodiwgYSwgcGFyZW50LCBpbmRleCwgYWJpbGl0eU1vZGVsLCBhYmlsaXR5KSB7XG4gICAgICAgICAgICAgICAgcmV0dXJuIGE7XG4gICAgICAgICAgICB9LFxuICAgICAgICAgICAgcmV0dXJuUHJvcGVydHk6ICdoZWFsdGhyZWdlbidcbiAgICAgICAgfVxuICAgIF0sXG4gICAgJ2Rvb21fYnJpbmdlcl9kb29tJzogW1xuICAgICAgICB7XG4gICAgICAgICAgICBsYWJlbDogJ0R1cmF0aW9uJyxcbiAgICAgICAgICAgIGNvbnRyb2xUeXBlOiAnaW5wdXQnXG4gICAgICAgIH0sXG4gICAgICAgIHtcbiAgICAgICAgICAgIGF0dHJpYnV0ZU5hbWU6ICdkYW1hZ2UnLFxuICAgICAgICAgICAgbGFiZWw6ICdUb3RhbCBEYW1hZ2UnLFxuICAgICAgICAgICAgY29udHJvbFR5cGU6ICd0ZXh0JyxcbiAgICAgICAgICAgIGZuOiBmdW5jdGlvbiAodiwgYSwgcGFyZW50LCBpbmRleCwgYWJpbGl0eU1vZGVsLCBhYmlsaXR5KSB7XG4gICAgICAgICAgICAgICAgaWYgKHBhcmVudC5pbnZlbnRvcnkuaGFzU2NlcHRlcigpKSB7XG4gICAgICAgICAgICAgICAgICAgIHJldHVybiB2KmFiaWxpdHlNb2RlbC5nZXRBYmlsaXR5QXR0cmlidXRlVmFsdWUoYWJpbGl0eS5hdHRyaWJ1dGVzLCAnZGFtYWdlX3NjZXB0ZXInLGFiaWxpdHkubGV2ZWwoKSk7XG4gICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICAgIGVsc2Uge1xuICAgICAgICAgICAgICAgICAgICByZXR1cm4gdiphO1xuICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgIH1cbiAgICAgICAgfVxuICAgIF0sXG4gICAgJ2RyYWdvbl9rbmlnaHRfZWxkZXJfZHJhZ29uX2Zvcm0nOiBbXG4gICAgICAgIHtcbiAgICAgICAgICAgIGxhYmVsOiAnRHVyYXRpb24nLFxuICAgICAgICAgICAgY29udHJvbFR5cGU6ICdpbnB1dCdcbiAgICAgICAgfSxcbiAgICAgICAge1xuICAgICAgICAgICAgYXR0cmlidXRlTmFtZTogJ2JvbnVzX2F0dGFja19yYW5nZScsXG4gICAgICAgICAgICBsYWJlbDogJ1RvdGFsIERhbWFnZScsXG4gICAgICAgICAgICBjb250cm9sVHlwZTogJ3RleHQnLFxuICAgICAgICAgICAgZm46IGZ1bmN0aW9uICh2LCBhLCBwYXJlbnQsIGluZGV4LCBhYmlsaXR5TW9kZWwsIGFiaWxpdHkpIHtcbiAgICAgICAgICAgICAgICByZXR1cm4gYTtcbiAgICAgICAgICAgIH0sXG4gICAgICAgICAgICByZXR1cm5Qcm9wZXJ0eTogJ2F0dGFja3JhbmdlJ1xuICAgICAgICB9LFxuICAgICAgICB7XG4gICAgICAgICAgICBhdHRyaWJ1dGVOYW1lOiAnYm9udXNfbW92ZW1lbnRfc3BlZWQnLFxuICAgICAgICAgICAgbGFiZWw6ICdUb3RhbCBEYW1hZ2UnLFxuICAgICAgICAgICAgY29udHJvbFR5cGU6ICd0ZXh0JyxcbiAgICAgICAgICAgIGZuOiBmdW5jdGlvbiAodiwgYSwgcGFyZW50LCBpbmRleCwgYWJpbGl0eU1vZGVsLCBhYmlsaXR5KSB7XG4gICAgICAgICAgICAgICAgcmV0dXJuIGE7XG4gICAgICAgICAgICB9LFxuICAgICAgICAgICAgcmV0dXJuUHJvcGVydHk6ICdtb3ZlbWVudFNwZWVkRmxhdCdcbiAgICAgICAgfVxuICAgIF0sXG4gICAgJ2Ryb3dfcmFuZ2VyX3RydWVzaG90JzogW1xuICAgICAgICB7XG4gICAgICAgICAgICBsYWJlbDogJ0Ryb3dcXCdzIEFnaWxpdHknLFxuICAgICAgICAgICAgY29udHJvbFR5cGU6ICdpbnB1dCcsXG4gICAgICAgICAgICBkaXNwbGF5OiAnYnVmZidcbiAgICAgICAgfSxcbiAgICAgICAge1xuICAgICAgICAgICAgYXR0cmlidXRlTmFtZTogJ3RydWVzaG90X3JhbmdlZF9kYW1hZ2UnLFxuICAgICAgICAgICAgbGFiZWw6ICdEQU1BR0UgQk9OVVM6JyxcbiAgICAgICAgICAgIGlnbm9yZVRvb2x0aXA6IHRydWUsXG4gICAgICAgICAgICBjb250cm9sVHlwZTogJ3RleHQnLFxuICAgICAgICAgICAgZGlzcGxheTogJ2J1ZmYnLFxuICAgICAgICAgICAgZm46IGZ1bmN0aW9uICh2LCBhLCBwYXJlbnQsIGluZGV4LCBhYmlsaXR5TW9kZWwsIGFiaWxpdHkpIHtcbiAgICAgICAgICAgICAgICByZXR1cm4gdiphLzEwMDtcbiAgICAgICAgICAgIH0sXG4gICAgICAgICAgICByZXR1cm5Qcm9wZXJ0eTogJ2JvbnVzRGFtYWdlUHJlY2lzaW9uQXVyYSdcbiAgICAgICAgfVxuICAgIF0sXG4gICAgJ2VhcnRoX3NwaXJpdF9yb2xsaW5nX2JvdWxkZXInOiBbXG4gICAgICAgIHtcbiAgICAgICAgICAgIGxhYmVsOiAnVXNpbmcgU3RvbmUnLFxuICAgICAgICAgICAgY29udHJvbFR5cGU6ICdjaGVja2JveCdcbiAgICAgICAgfSxcbiAgICAgICAge1xuICAgICAgICAgICAgYXR0cmlidXRlTmFtZTogJ21vdmVfc2xvdycsXG4gICAgICAgICAgICBsYWJlbDogJ1RvdGFsIERhbWFnZScsXG4gICAgICAgICAgICBjb250cm9sVHlwZTogJ3RleHQnLFxuICAgICAgICAgICAgZm46IGZ1bmN0aW9uICh2LCBhLCBwYXJlbnQsIGluZGV4LCBhYmlsaXR5TW9kZWwsIGFiaWxpdHkpIHtcbiAgICAgICAgICAgICAgICBpZiAodikge1xuICAgICAgICAgICAgICAgICAgICByZXR1cm4gLWE7XG4gICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICAgIGVsc2Uge1xuICAgICAgICAgICAgICAgICAgICByZXR1cm4gMDtcbiAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICB9LFxuICAgICAgICAgICAgcmV0dXJuUHJvcGVydHk6ICdtb3ZlbWVudFNwZWVkUGN0UmVkdWN0aW9uJ1xuICAgICAgICB9XG4gICAgXSxcbiAgICAnZWFydGhzaGFrZXJfZW5jaGFudF90b3RlbSc6IFtcbiAgICAgICAge1xuICAgICAgICAgICAgbGFiZWw6ICdBY3RpdmF0ZWQnLFxuICAgICAgICAgICAgY29udHJvbFR5cGU6ICdjaGVja2JveCdcbiAgICAgICAgfSxcbiAgICAgICAge1xuICAgICAgICAgICAgYXR0cmlidXRlTmFtZTogJ3RvdGVtX2RhbWFnZV9wZXJjZW50YWdlJyxcbiAgICAgICAgICAgIGxhYmVsOiAnREFNQUdFJyxcbiAgICAgICAgICAgIGNvbnRyb2xUeXBlOiAndGV4dCcsXG4gICAgICAgICAgICBmbjogZnVuY3Rpb24gKHYsIGEsIHBhcmVudCwgaW5kZXgsIGFiaWxpdHlNb2RlbCwgYWJpbGl0eSkge1xuICAgICAgICAgICAgICAgIGlmICh2KSB7XG4gICAgICAgICAgICAgICAgICAgIHJldHVybiBhO1xuICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgICBlbHNlIHtcbiAgICAgICAgICAgICAgICAgICAgcmV0dXJuIDA7XG4gICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgfSxcbiAgICAgICAgICAgIHJldHVyblByb3BlcnR5OiAnYmFzZURhbWFnZU11bHRpcGxpZXInXG4gICAgICAgIH1cbiAgICBdLFxuICAgICdlYXJ0aHNoYWtlcl9lY2hvX3NsYW0nOiBbXG4gICAgICAgIHtcbiAgICAgICAgICAgIGxhYmVsOiAnRW5lbWllcyBpbiBSYW5nZScsXG4gICAgICAgICAgICBjb250cm9sVHlwZTogJ2lucHV0J1xuICAgICAgICB9LFxuICAgICAgICB7XG4gICAgICAgICAgICBhdHRyaWJ1dGVOYW1lOiAnZWNob19zbGFtX2VjaG9fZGFtYWdlJyxcbiAgICAgICAgICAgIGxhYmVsOiAnVG90YWwgRGFtYWdlJyxcbiAgICAgICAgICAgIGNvbnRyb2xUeXBlOiAndGV4dCcsXG4gICAgICAgICAgICBmbjogZnVuY3Rpb24gKHYsIGEsIHBhcmVudCwgaW5kZXgsIGFiaWxpdHlNb2RlbCwgYWJpbGl0eSkge1xuICAgICAgICAgICAgICAgIHJldHVybiB2KmE7XG4gICAgICAgICAgICB9XG4gICAgICAgIH1cbiAgICBdLFxuICAgICdlbGRlcl90aXRhbl9hbmNlc3RyYWxfc3Bpcml0JzogW1xuICAgICAgICB7XG4gICAgICAgICAgICBsYWJlbDogJ0hFUk9FUyBQQVNTRUQgVEhST1VHSCcsXG4gICAgICAgICAgICBjb250cm9sVHlwZTogJ2lucHV0J1xuICAgICAgICB9LFxuICAgICAgICB7XG4gICAgICAgICAgICBsYWJlbDogJ0NSRUVQUyBQQVNTRUQgVEhST1VHSCcsXG4gICAgICAgICAgICBjb250cm9sVHlwZTogJ2lucHV0J1xuICAgICAgICB9LFxuICAgICAgICB7XG4gICAgICAgICAgICBhdHRyaWJ1dGVOYW1lOiAnZGFtYWdlX2NyZWVwcycsXG4gICAgICAgICAgICBsYWJlbDogJ0RBTUFHRTonLFxuICAgICAgICAgICAgaWdub3JlVG9vbHRpcDogdHJ1ZSxcbiAgICAgICAgICAgIGNvbnRyb2xUeXBlOiAndGV4dCcsXG4gICAgICAgICAgICBjb250cm9sczogWzAsMV0sXG4gICAgICAgICAgICBmbjogZnVuY3Rpb24gKHYsIGEsIHBhcmVudCwgaW5kZXgsIGFiaWxpdHlNb2RlbCwgYWJpbGl0eSkge1xuICAgICAgICAgICAgICAgIHJldHVybiB2WzBdKmFiaWxpdHlNb2RlbC5nZXRBYmlsaXR5QXR0cmlidXRlVmFsdWUoYWJpbGl0eS5hdHRyaWJ1dGVzLCAnZGFtYWdlX2hlcm9lcycsYWJpbGl0eS5sZXZlbCgpKSArIHZbMV0qYTtcbiAgICAgICAgICAgIH0sXG4gICAgICAgICAgICByZXR1cm5Qcm9wZXJ0eTogJ2JvbnVzRGFtYWdlJ1xuICAgICAgICB9LFxuICAgICAgICB7XG4gICAgICAgICAgICBhdHRyaWJ1dGVOYW1lOiAnbW92ZV9wY3RfY3JlZXBzJyxcbiAgICAgICAgICAgIGxhYmVsOiAnJUJPTlVTIFNQRUVEOicsXG4gICAgICAgICAgICBpZ25vcmVUb29sdGlwOiB0cnVlLFxuICAgICAgICAgICAgY29udHJvbFR5cGU6ICd0ZXh0JyxcbiAgICAgICAgICAgIGNvbnRyb2xzOiBbMCwxXSxcbiAgICAgICAgICAgIGZuOiBmdW5jdGlvbiAodiwgYSwgcGFyZW50LCBpbmRleCwgYWJpbGl0eU1vZGVsLCBhYmlsaXR5KSB7XG4gICAgICAgICAgICAgICAgcmV0dXJuIHZbMF0qYWJpbGl0eU1vZGVsLmdldEFiaWxpdHlBdHRyaWJ1dGVWYWx1ZShhYmlsaXR5LmF0dHJpYnV0ZXMsICdtb3ZlX3BjdF9oZXJvZXMnLGFiaWxpdHkubGV2ZWwoKSkgKyB2WzFdKmE7XG4gICAgICAgICAgICB9LFxuICAgICAgICAgICAgcmV0dXJuUHJvcGVydHk6ICdtb3ZlbWVudFNwZWVkUGN0J1xuICAgICAgICB9XG4gICAgXSxcbiAgICAnZWxkZXJfdGl0YW5fZWFydGhfc3BsaXR0ZXInOiBbXG4gICAgICAgIHtcbiAgICAgICAgICAgIGxhYmVsOiAnRW5lbXkgTWF4IEhlYWx0aCcsXG4gICAgICAgICAgICBjb250cm9sVHlwZTogJ2lucHV0J1xuICAgICAgICB9LFxuICAgICAgICB7XG4gICAgICAgICAgICBhdHRyaWJ1dGVOYW1lOiAnZGFtYWdlX3BjdCcsXG4gICAgICAgICAgICBsYWJlbDogJ1RvdGFsIERhbWFnZScsXG4gICAgICAgICAgICBjb250cm9sVHlwZTogJ3RleHQnLFxuICAgICAgICAgICAgZm46IGZ1bmN0aW9uICh2LCBhLCBwYXJlbnQsIGluZGV4LCBhYmlsaXR5TW9kZWwsIGFiaWxpdHkpIHtcbiAgICAgICAgICAgICAgICByZXR1cm4gdiphLzEwMDtcbiAgICAgICAgICAgIH1cbiAgICAgICAgfSxcbiAgICAgICAge1xuICAgICAgICAgICAgYXR0cmlidXRlTmFtZTogJ3Nsb3dfcGN0JyxcbiAgICAgICAgICAgIGxhYmVsOiAnVG90YWwgRGFtYWdlJyxcbiAgICAgICAgICAgIGNvbnRyb2xUeXBlOiAndGV4dCcsXG4gICAgICAgICAgICBmbjogZnVuY3Rpb24gKHYsIGEsIHBhcmVudCwgaW5kZXgsIGFiaWxpdHlNb2RlbCwgYWJpbGl0eSkge1xuICAgICAgICAgICAgICAgIHJldHVybiAtYTtcbiAgICAgICAgICAgIH0sXG4gICAgICAgICAgICByZXR1cm5Qcm9wZXJ0eTogJ21vdmVtZW50U3BlZWRQY3RSZWR1Y3Rpb24nXG4gICAgICAgIH1cbiAgICBdLFxuICAgICdlbmNoYW50cmVzc19uYXR1cmVzX2F0dGVuZGFudHMnOiBbXG4gICAgICAgIHtcbiAgICAgICAgICAgIGxhYmVsOiAnRHVyYXRpb24nLFxuICAgICAgICAgICAgY29udHJvbFR5cGU6ICdpbnB1dCdcbiAgICAgICAgfSxcbiAgICAgICAge1xuICAgICAgICAgICAgYXR0cmlidXRlTmFtZTogJ2hlYWwnLFxuICAgICAgICAgICAgbGFiZWw6ICdIRUFMOicsXG4gICAgICAgICAgICBpZ25vcmVUb29sdGlwOiB0cnVlLFxuICAgICAgICAgICAgY29udHJvbFR5cGU6ICd0ZXh0JyxcbiAgICAgICAgICAgIGZuOiBmdW5jdGlvbiAodiwgYSwgcGFyZW50LCBpbmRleCwgYWJpbGl0eU1vZGVsLCBhYmlsaXR5KSB7XG4gICAgICAgICAgICAgICAgcmV0dXJuIGFiaWxpdHlNb2RlbC5nZXRBYmlsaXR5QXR0cmlidXRlVmFsdWUoYWJpbGl0eS5hdHRyaWJ1dGVzLCAnd2lzcF9jb3VudCcsYWJpbGl0eS5sZXZlbCgpKSp2KmE7XG4gICAgICAgICAgICB9XG4gICAgICAgIH1cbiAgICBdLFxuICAgICdlbmlnbWFfbWFsZWZpY2UnOiBbXG4gICAgICAgIHtcbiAgICAgICAgICAgIGxhYmVsOiAnSGl0cycsXG4gICAgICAgICAgICBjb250cm9sVHlwZTogJ2lucHV0J1xuICAgICAgICB9LFxuICAgICAgICB7XG4gICAgICAgICAgICBhdHRyaWJ1dGVOYW1lOiAnZGFtYWdlJyxcbiAgICAgICAgICAgIGxhYmVsOiAnREFNQUdFOicsXG4gICAgICAgICAgICBpZ25vcmVUb29sdGlwOiB0cnVlLFxuICAgICAgICAgICAgY29udHJvbFR5cGU6ICd0ZXh0JyxcbiAgICAgICAgICAgIGZuOiBmdW5jdGlvbiAodiwgYSwgcGFyZW50LCBpbmRleCwgYWJpbGl0eU1vZGVsLCBhYmlsaXR5KSB7XG4gICAgICAgICAgICAgICAgcmV0dXJuIHYqYTtcbiAgICAgICAgICAgIH1cbiAgICAgICAgfSxcbiAgICAgICAge1xuICAgICAgICAgICAgYXR0cmlidXRlTmFtZTogJ3N0dW5fZHVyYXRpb24nLFxuICAgICAgICAgICAgbGFiZWw6ICdUb3RhbCBEYW1hZ2UnLFxuICAgICAgICAgICAgY29udHJvbFR5cGU6ICd0ZXh0JyxcbiAgICAgICAgICAgIGZuOiBmdW5jdGlvbiAodiwgYSwgcGFyZW50LCBpbmRleCwgYWJpbGl0eU1vZGVsLCBhYmlsaXR5KSB7XG4gICAgICAgICAgICAgICAgcmV0dXJuIHYqYTtcbiAgICAgICAgICAgIH1cbiAgICAgICAgfVxuICAgIF0sXG4gICAgJ2VuaWdtYV9taWRuaWdodF9wdWxzZSc6IFtcbiAgICAgICAge1xuICAgICAgICAgICAgbGFiZWw6ICdEdXJhdGlvbicsXG4gICAgICAgICAgICBjb250cm9sVHlwZTogJ2lucHV0J1xuICAgICAgICB9LFxuICAgICAgICB7XG4gICAgICAgICAgICBsYWJlbDogJ0VuZW15IE1heCBIZWFsdGgnLFxuICAgICAgICAgICAgY29udHJvbFR5cGU6ICdpbnB1dCdcbiAgICAgICAgfSxcbiAgICAgICAge1xuICAgICAgICAgICAgYXR0cmlidXRlTmFtZTogJ2RhbWFnZV9wZXJjZW50JyxcbiAgICAgICAgICAgIGxhYmVsOiAnREFNQUdFOicsXG4gICAgICAgICAgICBpZ25vcmVUb29sdGlwOiB0cnVlLFxuICAgICAgICAgICAgY29udHJvbFR5cGU6ICd0ZXh0JyxcbiAgICAgICAgICAgIGNvbnRyb2xzOiBbMCwxXSxcbiAgICAgICAgICAgIGZuOiBmdW5jdGlvbiAodiwgYSwgcGFyZW50LCBpbmRleCwgYWJpbGl0eU1vZGVsLCBhYmlsaXR5KSB7XG4gICAgICAgICAgICAgICAgcmV0dXJuIHZbMF0qdlsxXSphLzEwMDtcbiAgICAgICAgICAgIH1cbiAgICAgICAgfVxuICAgIF0sXG4gICAgJ2VuaWdtYV9ibGFja19ob2xlJzogW1xuICAgICAgICB7XG4gICAgICAgICAgICBsYWJlbDogJ0R1cmF0aW9uJyxcbiAgICAgICAgICAgIGNvbnRyb2xUeXBlOiAnaW5wdXQnXG4gICAgICAgIH0sXG4gICAgICAgIHtcbiAgICAgICAgICAgIGF0dHJpYnV0ZU5hbWU6ICdmYXJfZGFtYWdlJyxcbiAgICAgICAgICAgIGxhYmVsOiAnVG90YWwgRGFtYWdlJyxcbiAgICAgICAgICAgIGNvbnRyb2xUeXBlOiAndGV4dCcsXG4gICAgICAgICAgICBmbjogZnVuY3Rpb24gKHYsIGEsIHBhcmVudCwgaW5kZXgsIGFiaWxpdHlNb2RlbCwgYWJpbGl0eSkge1xuICAgICAgICAgICAgICAgIHJldHVybiB2KmE7XG4gICAgICAgICAgICB9XG4gICAgICAgIH0sXG4gICAgICAgIHtcbiAgICAgICAgICAgIGF0dHJpYnV0ZU5hbWU6ICduZWFyX2RhbWFnZScsXG4gICAgICAgICAgICBsYWJlbDogJ1RvdGFsIERhbWFnZScsXG4gICAgICAgICAgICBjb250cm9sVHlwZTogJ3RleHQnLFxuICAgICAgICAgICAgZm46IGZ1bmN0aW9uICh2LCBhLCBwYXJlbnQsIGluZGV4LCBhYmlsaXR5TW9kZWwsIGFiaWxpdHkpIHtcbiAgICAgICAgICAgICAgICByZXR1cm4gdiphO1xuICAgICAgICAgICAgfVxuICAgICAgICB9XG4gICAgXSxcbiAgICAnZmFjZWxlc3Nfdm9pZF90aW1lX2xvY2snOiBbXG4gICAgICAgIHtcbiAgICAgICAgICAgIGxhYmVsOiAnSW4gQ2hyb25vc3BoZXJlJyxcbiAgICAgICAgICAgIGNvbnRyb2xUeXBlOiAnY2hlY2tib3gnXG4gICAgICAgIH0sXG4gICAgICAgIHtcbiAgICAgICAgICAgIGF0dHJpYnV0ZU5hbWU6ICdib251c19kYW1hZ2UnLFxuICAgICAgICAgICAgbGFiZWw6ICclTU9WRVNQRUVEIEFTIERBTUFHRScsXG4gICAgICAgICAgICBjb250cm9sVHlwZTogJ3RleHQnLFxuICAgICAgICAgICAgZm46IGZ1bmN0aW9uICh2LCBhLCBwYXJlbnQsIGluZGV4LCBhYmlsaXR5TW9kZWwsIGFiaWxpdHkpIHtcbiAgICAgICAgICAgICAgICBpZiAodikge1xuICAgICAgICAgICAgICAgICAgICByZXR1cm4gYSoyO1xuICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgICBlbHNlIHtcbiAgICAgICAgICAgICAgICAgICAgcmV0dXJuIGE7XG4gICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgfSxcbiAgICAgICAgICAgIHJldHVyblByb3BlcnR5OiAnYmFzaEJvbnVzRGFtYWdlJ1xuICAgICAgICB9LFxuICAgICAgICB7XG4gICAgICAgICAgICBhdHRyaWJ1dGVOYW1lOiAnZHVyYXRpb24nLFxuICAgICAgICAgICAgbGFiZWw6ICdUb3RhbCBEYW1hZ2UnLFxuICAgICAgICAgICAgY29udHJvbFR5cGU6ICd0ZXh0JyxcbiAgICAgICAgICAgIGZuOiBmdW5jdGlvbiAodiwgYSwgcGFyZW50LCBpbmRleCwgYWJpbGl0eU1vZGVsLCBhYmlsaXR5KSB7XG4gICAgICAgICAgICAgICAgcmV0dXJuIGE7XG4gICAgICAgICAgICB9XG4gICAgICAgIH0sXG4gICAgICAgIHtcbiAgICAgICAgICAgIGF0dHJpYnV0ZU5hbWU6ICdjaGFuY2VfcGN0JyxcbiAgICAgICAgICAgIGxhYmVsOiAnVG90YWwgRGFtYWdlJyxcbiAgICAgICAgICAgIGNvbnRyb2xUeXBlOiAndGV4dCcsXG4gICAgICAgICAgICBmbjogZnVuY3Rpb24gKHYsIGEsIHBhcmVudCwgaW5kZXgsIGFiaWxpdHlNb2RlbCwgYWJpbGl0eSkge1xuICAgICAgICAgICAgICAgIHJldHVybiBhO1xuICAgICAgICAgICAgfSxcbiAgICAgICAgICAgIHJldHVyblByb3BlcnR5OiAnYmFzaCdcbiAgICAgICAgfVxuICAgIF0sXG4gICAgJ2d5cm9jb3B0ZXJfcm9ja2V0X2JhcnJhZ2UnOiBbXG4gICAgICAgIHtcbiAgICAgICAgICAgIGxhYmVsOiAnUm9ja2V0cycsXG4gICAgICAgICAgICBjb250cm9sVHlwZTogJ2lucHV0J1xuICAgICAgICB9LFxuICAgICAgICB7XG4gICAgICAgICAgICBhdHRyaWJ1dGVOYW1lOiAncm9ja2V0c19wZXJfc2Vjb25kJyxcbiAgICAgICAgICAgIGxhYmVsOiAnVG90YWwgRGFtYWdlJyxcbiAgICAgICAgICAgIGNvbnRyb2xUeXBlOiAndGV4dCcsXG4gICAgICAgICAgICBmbjogZnVuY3Rpb24gKHYsIGEsIHBhcmVudCwgaW5kZXgsIGFiaWxpdHlNb2RlbCwgYWJpbGl0eSkge1xuICAgICAgICAgICAgICAgIHJldHVybiBhO1xuICAgICAgICAgICAgfVxuICAgICAgICB9LFxuICAgICAgICB7XG4gICAgICAgICAgICBsYWJlbDogJ0RBTUFHRTonLFxuICAgICAgICAgICAgY29udHJvbFR5cGU6ICd0ZXh0JyxcbiAgICAgICAgICAgIGZuOiBmdW5jdGlvbiAodiwgYSwgcGFyZW50LCBpbmRleCwgYWJpbGl0eU1vZGVsLCBhYmlsaXR5KSB7XG4gICAgICAgICAgICAgICAgcmV0dXJuIGFiaWxpdHlNb2RlbC5nZXRBYmlsaXR5UHJvcGVydHlWYWx1ZShhYmlsaXR5LCAnZGFtYWdlJykqdjtcbiAgICAgICAgICAgIH1cbiAgICAgICAgfVxuICAgIF0sXG4vKiAgICAgICAgJ2d5cm9jb3B0ZXJfaG9taW5nX21pc3NpbGUnOiBbXG4gICAgICAgIHtcbiAgICAgICAgICAgIGxhYmVsOiAnRGlzdGFuY2UgVHJhdmVsZWQnLFxuICAgICAgICAgICAgY29udHJvbFR5cGU6ICdpbnB1dCdcbiAgICAgICAgfSxcbiAgICAgICAge1xuICAgICAgICAgICAgYXR0cmlidXRlTmFtZTogJ2RhbWFnZScsXG4gICAgICAgICAgICBsYWJlbDogJ1RvdGFsIERhbWFnZScsXG4gICAgICAgICAgICBjb250cm9sVHlwZTogJ3RleHQnLFxuICAgICAgICAgICAgZm46IGZ1bmN0aW9uICh2LCBhLCBwYXJlbnQsIGluZGV4LCBhYmlsaXR5TW9kZWwsIGFiaWxpdHkpIHtcbiAgICAgICAgICAgICAgICByZXR1cm4gdiphO1xuICAgICAgICAgICAgfVxuICAgICAgICB9XG4gICAgXSxcbiAgICAnZ3lyb2NvcHRlcl9mbGFrX2Nhbm5vbic6IFtcbiAgICAgICAge1xuICAgICAgICAgICAgbGFiZWw6ICdBdHRhY2tzJyxcbiAgICAgICAgICAgIGNvbnRyb2xUeXBlOiAnaW5wdXQnXG4gICAgICAgIH0sXG4gICAgICAgIHtcbiAgICAgICAgICAgIGF0dHJpYnV0ZU5hbWU6ICdkYW1hZ2UnLFxuICAgICAgICAgICAgbGFiZWw6ICdUb3RhbCBEYW1hZ2UnLFxuICAgICAgICAgICAgY29udHJvbFR5cGU6ICd0ZXh0JyxcbiAgICAgICAgICAgIGZuOiBmdW5jdGlvbiAodiwgYSwgcGFyZW50LCBpbmRleCwgYWJpbGl0eU1vZGVsLCBhYmlsaXR5KSB7XG4gICAgICAgICAgICAgICAgcmV0dXJuIHYqYTtcbiAgICAgICAgICAgIH1cbiAgICAgICAgfVxuICAgIF0sKi9cbiAgICAnaHVza2FyX2J1cm5pbmdfc3BlYXInOiBbXG4gICAgICAgIHtcbiAgICAgICAgICAgIGxhYmVsOiAnU3RhY2tzJyxcbiAgICAgICAgICAgIGNvbnRyb2xUeXBlOiAnaW5wdXQnXG4gICAgICAgIH0sXG4gICAgICAgIHtcbiAgICAgICAgICAgIGF0dHJpYnV0ZU5hbWU6ICdoZWFsdGhfY29zdCcsXG4gICAgICAgICAgICBsYWJlbDogJ1RvdGFsIERhbWFnZScsXG4gICAgICAgICAgICBjb250cm9sVHlwZTogJ3RleHQnLFxuICAgICAgICAgICAgZm46IGZ1bmN0aW9uICh2LCBhLCBwYXJlbnQsIGluZGV4LCBhYmlsaXR5TW9kZWwsIGFiaWxpdHkpIHtcbiAgICAgICAgICAgICAgICByZXR1cm4gdiphO1xuICAgICAgICAgICAgfVxuICAgICAgICB9LFxuICAgICAgICB7XG4gICAgICAgICAgICBsYWJlbDogJ0RBTUFHRTonLFxuICAgICAgICAgICAgY29udHJvbFR5cGU6ICd0ZXh0JyxcbiAgICAgICAgICAgIGZuOiBmdW5jdGlvbiAodiwgYSwgcGFyZW50LCBpbmRleCwgYWJpbGl0eU1vZGVsLCBhYmlsaXR5KSB7XG4gICAgICAgICAgICAgICAgcmV0dXJuIGFiaWxpdHlNb2RlbC5nZXRBYmlsaXR5UHJvcGVydHlWYWx1ZShhYmlsaXR5LCAnZGFtYWdlJykqdjtcbiAgICAgICAgICAgIH1cbiAgICAgICAgfVxuICAgIF0sXG4gICAgJ2h1c2thcl9iZXJzZXJrZXJzX2Jsb29kJzogW1xuICAgICAgICB7XG4gICAgICAgICAgICBsYWJlbDogJyVIUCcsXG4gICAgICAgICAgICBjb250cm9sVHlwZTogJ2lucHV0J1xuICAgICAgICB9LFxuICAgICAgICB7XG4gICAgICAgICAgICBhdHRyaWJ1dGVOYW1lOiAnaHBfdGhyZXNob2xkX21heCcsXG4gICAgICAgICAgICBsYWJlbDogJ0hlYWx0aCBhdCBnaXZlbiAlSFA6JyxcbiAgICAgICAgICAgIGlnbm9yZVRvb2x0aXA6IHRydWUsXG4gICAgICAgICAgICBjb250cm9sVHlwZTogJ3RleHQnLFxuICAgICAgICAgICAgZm46IGZ1bmN0aW9uICh2LCBhLCBwYXJlbnQsIGluZGV4LCBhYmlsaXR5TW9kZWwsIGFiaWxpdHkpIHtcbiAgICAgICAgICAgICAgICByZXR1cm4gcGFyZW50LmhlYWx0aCgpKnYvMTAwO1xuICAgICAgICAgICAgfVxuICAgICAgICB9LFxuICAgICAgICB7XG4gICAgICAgICAgICBhdHRyaWJ1dGVOYW1lOiAnaHBfdGhyZXNob2xkX21heCcsXG4gICAgICAgICAgICBsYWJlbDogJ1RvdGFsIERhbWFnZScsXG4gICAgICAgICAgICBjb250cm9sVHlwZTogJ3RleHQnLFxuICAgICAgICAgICAgZm46IGZ1bmN0aW9uICh2LCBhLCBwYXJlbnQsIGluZGV4LCBhYmlsaXR5TW9kZWwsIGFiaWxpdHkpIHtcbiAgICAgICAgICAgICAgICByZXR1cm4gYTtcbiAgICAgICAgICAgIH1cbiAgICAgICAgfSxcbiAgICAgICAge1xuICAgICAgICAgICAgYXR0cmlidXRlTmFtZTogJ21heGltdW1fcmVzaXN0YW5jZScsXG4gICAgICAgICAgICBsYWJlbDogJ01BR0lDIFJFU0lTVEFOQ0UgQk9OVVM6JyxcbiAgICAgICAgICAgIGlnbm9yZVRvb2x0aXA6IHRydWUsXG4gICAgICAgICAgICBjb250cm9sVHlwZTogJ3RleHQnLFxuICAgICAgICAgICAgZm46IGZ1bmN0aW9uICh2LCBhLCBwYXJlbnQsIGluZGV4LCBhYmlsaXR5TW9kZWwsIGFiaWxpdHkpIHtcbiAgICAgICAgICAgICAgICB2YXIgdiA9IE1hdGgubWluKHYsIDEwMCk7XG4gICAgICAgICAgICAgICAgdiA9IE1hdGgubWF4KHYsIDEwKTtcbiAgICAgICAgICAgICAgICB2YXIgaHBfdGhyZXNob2xkX21heCA9IGFiaWxpdHlNb2RlbC5nZXRBYmlsaXR5QXR0cmlidXRlVmFsdWUoYWJpbGl0eS5hdHRyaWJ1dGVzLCAnaHBfdGhyZXNob2xkX21heCcsMCk7XG4gICAgICAgICAgICAgICAgdmFyIGQgPSAxMDAgLSBocF90aHJlc2hvbGRfbWF4O1xuICAgICAgICAgICAgICAgIHZhciBjID0gKHYgLSBocF90aHJlc2hvbGRfbWF4KSAvIGQ7XG4gICAgICAgICAgICAgICAgYyA9IDEgLSBjO1xuICAgICAgICAgICAgICAgIHJldHVybiBjKmE7XG4gICAgICAgICAgICB9LFxuICAgICAgICAgICAgcmV0dXJuUHJvcGVydHk6ICdtYWdpY1Jlc2lzdCdcbiAgICAgICAgfSxcbiAgICAgICAge1xuICAgICAgICAgICAgYXR0cmlidXRlTmFtZTogJ21heGltdW1fYXR0YWNrX3NwZWVkJyxcbiAgICAgICAgICAgIGxhYmVsOiAnQVRUQUNLIFNQRUVEIEJPTlVTOicsXG4gICAgICAgICAgICBpZ25vcmVUb29sdGlwOiB0cnVlLFxuICAgICAgICAgICAgY29udHJvbFR5cGU6ICd0ZXh0JyxcbiAgICAgICAgICAgIGZuOiBmdW5jdGlvbiAodiwgYSwgcGFyZW50LCBpbmRleCwgYWJpbGl0eU1vZGVsLCBhYmlsaXR5KSB7XG4gICAgICAgICAgICAgICAgdmFyIHYgPSBNYXRoLm1pbih2LCAxMDApO1xuICAgICAgICAgICAgICAgIHYgPSBNYXRoLm1heCh2LCAxMCk7XG4gICAgICAgICAgICAgICAgdmFyIGhwX3RocmVzaG9sZF9tYXggPSBhYmlsaXR5TW9kZWwuZ2V0QWJpbGl0eUF0dHJpYnV0ZVZhbHVlKGFiaWxpdHkuYXR0cmlidXRlcywgJ2hwX3RocmVzaG9sZF9tYXgnLDApO1xuICAgICAgICAgICAgICAgIHZhciBkID0gMTAwIC0gaHBfdGhyZXNob2xkX21heDtcbiAgICAgICAgICAgICAgICB2YXIgYyA9ICh2IC0gaHBfdGhyZXNob2xkX21heCkgLyBkO1xuICAgICAgICAgICAgICAgIGMgPSAxIC0gYztcbiAgICAgICAgICAgICAgICByZXR1cm4gYyphO1xuICAgICAgICAgICAgfSxcbiAgICAgICAgICAgIHJldHVyblByb3BlcnR5OiAnYXR0YWNrc3BlZWQnXG4gICAgICAgIH1cbiAgICBdLFxuICAgICdodXNrYXJfbGlmZV9icmVhayc6IFtcbiAgICAgICAge1xuICAgICAgICAgICAgbGFiZWw6ICdFbmVteSBDdXJyZW50IEhQJyxcbiAgICAgICAgICAgIGNvbnRyb2xUeXBlOiAnaW5wdXQnXG4gICAgICAgIH0sXG4gICAgICAgIHtcbiAgICAgICAgICAgIGF0dHJpYnV0ZU5hbWU6ICdoZWFsdGhfZGFtYWdlJyxcbiAgICAgICAgICAgIGxhYmVsOiAnREFNQUdFOicsXG4gICAgICAgICAgICBpZ25vcmVUb29sdGlwOiB0cnVlLFxuICAgICAgICAgICAgY29udHJvbFR5cGU6ICd0ZXh0JyxcbiAgICAgICAgICAgIGZuOiBmdW5jdGlvbiAodiwgYSwgcGFyZW50LCBpbmRleCwgYWJpbGl0eU1vZGVsLCBhYmlsaXR5KSB7XG4gICAgICAgICAgICAgICAgcmV0dXJuIHYqYTtcbiAgICAgICAgICAgIH1cbiAgICAgICAgfSxcbiAgICAgICAge1xuICAgICAgICAgICAgbGFiZWw6ICdIdXNrYXIgQ3VycmVudCBIUCcsXG4gICAgICAgICAgICBjb250cm9sVHlwZTogJ2lucHV0J1xuICAgICAgICB9LFxuICAgICAgICB7XG4gICAgICAgICAgICBhdHRyaWJ1dGVOYW1lOiAnaGVhbHRoX2Nvc3RfcGVyY2VudCcsXG4gICAgICAgICAgICBsYWJlbDogJ0RBTUFHRSBUQUtFTjonLFxuICAgICAgICAgICAgaWdub3JlVG9vbHRpcDogdHJ1ZSxcbiAgICAgICAgICAgIGNvbnRyb2xUeXBlOiAndGV4dCcsXG4gICAgICAgICAgICBmbjogZnVuY3Rpb24gKHYsIGEsIHBhcmVudCwgaW5kZXgsIGFiaWxpdHlNb2RlbCwgYWJpbGl0eSkge1xuICAgICAgICAgICAgICAgIHJldHVybiB2KmE7XG4gICAgICAgICAgICB9XG4gICAgICAgIH0sXG4gICAgICAgIHtcbiAgICAgICAgICAgIGF0dHJpYnV0ZU5hbWU6ICdtb3Zlc3BlZWQnLFxuICAgICAgICAgICAgbGFiZWw6ICdUb3RhbCBEYW1hZ2UnLFxuICAgICAgICAgICAgY29udHJvbFR5cGU6ICd0ZXh0JyxcbiAgICAgICAgICAgIGZuOiBmdW5jdGlvbiAodiwgYSwgcGFyZW50LCBpbmRleCwgYWJpbGl0eU1vZGVsLCBhYmlsaXR5KSB7XG4gICAgICAgICAgICAgICAgcmV0dXJuIGE7XG4gICAgICAgICAgICB9LFxuICAgICAgICAgICAgcmV0dXJuUHJvcGVydHk6ICdtb3ZlbWVudFNwZWVkUGN0UmVkdWN0aW9uJ1xuICAgICAgICB9XG4gICAgXSxcbiAgICAnaW52b2tlcl9xdWFzJzogW1xuICAgICAgICB7XG4gICAgICAgICAgICBsYWJlbDogJ0luc3RhbmNlcycsXG4gICAgICAgICAgICBjb250cm9sVHlwZTogJ2lucHV0J1xuICAgICAgICB9LFxuICAgICAgICB7XG4gICAgICAgICAgICBhdHRyaWJ1dGVOYW1lOiAnYm9udXNfc3RyZW5ndGgnLFxuICAgICAgICAgICAgbGFiZWw6ICdUb3RhbCBEYW1hZ2UnLFxuICAgICAgICAgICAgY29udHJvbFR5cGU6ICd0ZXh0JyxcbiAgICAgICAgICAgIGZuOiBmdW5jdGlvbiAodiwgYSwgcGFyZW50LCBpbmRleCwgYWJpbGl0eU1vZGVsLCBhYmlsaXR5KSB7XG4gICAgICAgICAgICAgICAgcmV0dXJuIGE7XG4gICAgICAgICAgICB9LFxuICAgICAgICAgICAgcmV0dXJuUHJvcGVydHk6ICdib251c1N0cmVuZ3RoJ1xuICAgICAgICB9LFxuICAgICAgICB7XG4gICAgICAgICAgICBhdHRyaWJ1dGVOYW1lOiAnaGVhbHRoX3JlZ2VuX3Blcl9pbnN0YW5jZScsXG4gICAgICAgICAgICBsYWJlbDogJ0hQIFJFR0VOOicsXG4gICAgICAgICAgICBpZ25vcmVUb29sdGlwOiB0cnVlLFxuICAgICAgICAgICAgY29udHJvbFR5cGU6ICd0ZXh0JyxcbiAgICAgICAgICAgIGZuOiBmdW5jdGlvbiAodiwgYSwgcGFyZW50LCBpbmRleCwgYWJpbGl0eU1vZGVsLCBhYmlsaXR5KSB7XG4gICAgICAgICAgICAgICAgcmV0dXJuIHYqYTtcbiAgICAgICAgICAgIH0sXG4gICAgICAgICAgICByZXR1cm5Qcm9wZXJ0eTogJ2hlYWx0aHJlZ2VuJ1xuICAgICAgICB9XG4gICAgXSxcbiAgICAnaW52b2tlcl93ZXgnOiBbXG4gICAgICAgIHtcbiAgICAgICAgICAgIGxhYmVsOiAnSW5zdGFuY2VzJyxcbiAgICAgICAgICAgIGNvbnRyb2xUeXBlOiAnaW5wdXQnXG4gICAgICAgIH0sXG4gICAgICAgIHtcbiAgICAgICAgICAgIGF0dHJpYnV0ZU5hbWU6ICdib251c19hZ2lsaXR5JyxcbiAgICAgICAgICAgIGxhYmVsOiAnVG90YWwgRGFtYWdlJyxcbiAgICAgICAgICAgIGNvbnRyb2xUeXBlOiAndGV4dCcsXG4gICAgICAgICAgICBmbjogZnVuY3Rpb24gKHYsIGEsIHBhcmVudCwgaW5kZXgsIGFiaWxpdHlNb2RlbCwgYWJpbGl0eSkge1xuICAgICAgICAgICAgICAgIHJldHVybiBhO1xuICAgICAgICAgICAgfSxcbiAgICAgICAgICAgIHJldHVyblByb3BlcnR5OiAnYm9udXNBZ2lsaXR5J1xuICAgICAgICB9LFxuICAgICAgICB7XG4gICAgICAgICAgICBhdHRyaWJ1dGVOYW1lOiAnbW92ZV9zcGVlZF9wZXJfaW5zdGFuY2UnLFxuICAgICAgICAgICAgbGFiZWw6ICclTU9WRSBTUEVFRDonLFxuICAgICAgICAgICAgaWdub3JlVG9vbHRpcDogdHJ1ZSxcbiAgICAgICAgICAgIGNvbnRyb2xUeXBlOiAndGV4dCcsXG4gICAgICAgICAgICBmbjogZnVuY3Rpb24gKHYsIGEsIHBhcmVudCwgaW5kZXgsIGFiaWxpdHlNb2RlbCwgYWJpbGl0eSkge1xuICAgICAgICAgICAgICAgIHJldHVybiB2KmE7XG4gICAgICAgICAgICB9LFxuICAgICAgICAgICAgcmV0dXJuUHJvcGVydHk6ICdtb3ZlbWVudFNwZWVkUGN0J1xuICAgICAgICB9LFxuICAgICAgICB7XG4gICAgICAgICAgICBhdHRyaWJ1dGVOYW1lOiAnYXR0YWNrX3NwZWVkX3Blcl9pbnN0YW5jZScsXG4gICAgICAgICAgICBsYWJlbDogJyVBVFRBQ0sgU1BFRUQ6JyxcbiAgICAgICAgICAgIGlnbm9yZVRvb2x0aXA6IHRydWUsXG4gICAgICAgICAgICBjb250cm9sVHlwZTogJ3RleHQnLFxuICAgICAgICAgICAgZm46IGZ1bmN0aW9uICh2LCBhLCBwYXJlbnQsIGluZGV4LCBhYmlsaXR5TW9kZWwsIGFiaWxpdHkpIHtcbiAgICAgICAgICAgICAgICByZXR1cm4gdiphO1xuICAgICAgICAgICAgfSxcbiAgICAgICAgICAgIHJldHVyblByb3BlcnR5OiAnYXR0YWNrc3BlZWQnXG4gICAgICAgIH1cbiAgICBdLFxuICAgICdpbnZva2VyX2V4b3J0JzogW1xuICAgICAgICB7XG4gICAgICAgICAgICBsYWJlbDogJ0luc3RhbmNlcycsXG4gICAgICAgICAgICBjb250cm9sVHlwZTogJ2lucHV0J1xuICAgICAgICB9LFxuICAgICAgICB7XG4gICAgICAgICAgICBhdHRyaWJ1dGVOYW1lOiAnYm9udXNfaW50ZWxsaWdlbmNlJyxcbiAgICAgICAgICAgIGxhYmVsOiAnVG90YWwgRGFtYWdlJyxcbiAgICAgICAgICAgIGNvbnRyb2xUeXBlOiAndGV4dCcsXG4gICAgICAgICAgICBmbjogZnVuY3Rpb24gKHYsIGEsIHBhcmVudCwgaW5kZXgsIGFiaWxpdHlNb2RlbCwgYWJpbGl0eSkge1xuICAgICAgICAgICAgICAgIHJldHVybiBhO1xuICAgICAgICAgICAgfSxcbiAgICAgICAgICAgIHJldHVyblByb3BlcnR5OiAnYm9udXNJbnQnXG4gICAgICAgIH0sXG4gICAgICAgIHtcbiAgICAgICAgICAgIGF0dHJpYnV0ZU5hbWU6ICdib251c19kYW1hZ2VfcGVyX2luc3RhbmNlJyxcbiAgICAgICAgICAgIGxhYmVsOiAnREFNQUdFOicsXG4gICAgICAgICAgICBpZ25vcmVUb29sdGlwOiB0cnVlLFxuICAgICAgICAgICAgY29udHJvbFR5cGU6ICd0ZXh0JyxcbiAgICAgICAgICAgIGZuOiBmdW5jdGlvbiAodiwgYSwgcGFyZW50LCBpbmRleCwgYWJpbGl0eU1vZGVsLCBhYmlsaXR5KSB7XG4gICAgICAgICAgICAgICAgcmV0dXJuIHYqYTtcbiAgICAgICAgICAgIH0sXG4gICAgICAgICAgICByZXR1cm5Qcm9wZXJ0eTogJ2JvbnVzRGFtYWdlJ1xuICAgICAgICB9XG4gICAgXSxcbiAgICAnaW52b2tlcl9naG9zdF93YWxrJzogW1xuICAgICAgICB7XG4gICAgICAgICAgICBsYWJlbDogJ1F1YXMgTGV2ZWwnLFxuICAgICAgICAgICAgY29udHJvbFR5cGU6ICdpbnB1dCdcbiAgICAgICAgfSxcbiAgICAgICAge1xuICAgICAgICAgICAgYXR0cmlidXRlTmFtZTogJ2VuZW15X3Nsb3cnLFxuICAgICAgICAgICAgbGFiZWw6ICdUb3RhbCBEYW1hZ2UnLFxuICAgICAgICAgICAgY29udHJvbFR5cGU6ICd0ZXh0JyxcbiAgICAgICAgICAgIGZuOiBmdW5jdGlvbiAodiwgYSwgcGFyZW50LCBpbmRleCwgYWJpbGl0eU1vZGVsLCBhYmlsaXR5KSB7XG4gICAgICAgICAgICAgICAgaWYgKHYgPT0gMCkge1xuICAgICAgICAgICAgICAgICAgICByZXR1cm4gMDtcbiAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgICAgcmV0dXJuIGFiaWxpdHlNb2RlbC5nZXRBYmlsaXR5QXR0cmlidXRlVmFsdWUoYWJpbGl0eS5hdHRyaWJ1dGVzLCAnZW5lbXlfc2xvdycsdik7XG4gICAgICAgICAgICB9LFxuICAgICAgICAgICAgcmV0dXJuUHJvcGVydHk6ICdtb3ZlbWVudFNwZWVkUGN0UmVkdWN0aW9uJ1xuICAgICAgICB9LFxuICAgICAgICB7XG4gICAgICAgICAgICBsYWJlbDogJ1dleCBMZXZlbCcsXG4gICAgICAgICAgICBjb250cm9sVHlwZTogJ2lucHV0JyxcbiAgICAgICAgICAgIGRpc3BsYXk6ICdhYmlsaXR5J1xuICAgICAgICB9LFxuICAgICAgICB7XG4gICAgICAgICAgICBhdHRyaWJ1dGVOYW1lOiAnc2VsZl9zbG93JyxcbiAgICAgICAgICAgIGxhYmVsOiAnVG90YWwgRGFtYWdlJyxcbiAgICAgICAgICAgIGNvbnRyb2xUeXBlOiAndGV4dCcsXG4gICAgICAgICAgICBkaXNwbGF5OiAnYWJpbGl0eScsXG4gICAgICAgICAgICBmbjogZnVuY3Rpb24gKHYsIGEsIHBhcmVudCwgaW5kZXgsIGFiaWxpdHlNb2RlbCwgYWJpbGl0eSkge1xuICAgICAgICAgICAgICAgIGlmICh2ID09IDApIHtcbiAgICAgICAgICAgICAgICAgICAgcmV0dXJuIDA7XG4gICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICAgIHJldHVybiBhYmlsaXR5TW9kZWwuZ2V0QWJpbGl0eUF0dHJpYnV0ZVZhbHVlKGFiaWxpdHkuYXR0cmlidXRlcywgJ3NlbGZfc2xvdycsdik7XG4gICAgICAgICAgICB9LFxuICAgICAgICAgICAgcmV0dXJuUHJvcGVydHk6ICdtb3ZlbWVudFNwZWVkUGN0J1xuICAgICAgICB9XG4gICAgXSxcbiAgICAnaW52b2tlcl9hbGFjcml0eSc6IFtcbiAgICAgICAge1xuICAgICAgICAgICAgbGFiZWw6ICdXZXggTGV2ZWwnLFxuICAgICAgICAgICAgY29udHJvbFR5cGU6ICdpbnB1dCdcbiAgICAgICAgfSxcbiAgICAgICAge1xuICAgICAgICAgICAgYXR0cmlidXRlTmFtZTogJ2JvbnVzX2F0dGFja19zcGVlZCcsXG4gICAgICAgICAgICBsYWJlbDogJ1RvdGFsIERhbWFnZScsXG4gICAgICAgICAgICBjb250cm9sVHlwZTogJ3RleHQnLFxuICAgICAgICAgICAgZm46IGZ1bmN0aW9uICh2LCBhLCBwYXJlbnQsIGluZGV4LCBhYmlsaXR5TW9kZWwsIGFiaWxpdHkpIHtcbiAgICAgICAgICAgICAgICBpZiAodiA9PSAwKSB7XG4gICAgICAgICAgICAgICAgICAgIHJldHVybiAwO1xuICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgICByZXR1cm4gYWJpbGl0eU1vZGVsLmdldEFiaWxpdHlBdHRyaWJ1dGVWYWx1ZShhYmlsaXR5LmF0dHJpYnV0ZXMsICdib251c19hdHRhY2tfc3BlZWQnLHYpO1xuICAgICAgICAgICAgfSxcbiAgICAgICAgICAgIHJldHVyblByb3BlcnR5OiAnYXR0YWNrc3BlZWQnXG4gICAgICAgIH0sXG4gICAgICAgIHtcbiAgICAgICAgICAgIGxhYmVsOiAnRXhvcnQgTGV2ZWwnLFxuICAgICAgICAgICAgY29udHJvbFR5cGU6ICdpbnB1dCcsXG4gICAgICAgIH0sXG4gICAgICAgIHtcbiAgICAgICAgICAgIGF0dHJpYnV0ZU5hbWU6ICdib251c19kYW1hZ2UnLFxuICAgICAgICAgICAgbGFiZWw6ICdUb3RhbCBEYW1hZ2UnLFxuICAgICAgICAgICAgY29udHJvbFR5cGU6ICd0ZXh0JyxcbiAgICAgICAgICAgIGZuOiBmdW5jdGlvbiAodiwgYSwgcGFyZW50LCBpbmRleCwgYWJpbGl0eU1vZGVsLCBhYmlsaXR5KSB7XG4gICAgICAgICAgICAgICAgaWYgKHYgPT0gMCkge1xuICAgICAgICAgICAgICAgICAgICByZXR1cm4gMDtcbiAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgICAgcmV0dXJuIGFiaWxpdHlNb2RlbC5nZXRBYmlsaXR5QXR0cmlidXRlVmFsdWUoYWJpbGl0eS5hdHRyaWJ1dGVzLCAnYm9udXNfZGFtYWdlJyx2KTtcbiAgICAgICAgICAgIH0sXG4gICAgICAgICAgICByZXR1cm5Qcm9wZXJ0eTogJ2JvbnVzRGFtYWdlJ1xuICAgICAgICB9XG4gICAgXSxcbiAgICAnaW52b2tlcl9pY2Vfd2FsbCc6IFtcbiAgICAgICAge1xuICAgICAgICAgICAgbGFiZWw6ICdRdWFzIExldmVsJyxcbiAgICAgICAgICAgIGNvbnRyb2xUeXBlOiAnaW5wdXQnXG4gICAgICAgIH0sXG4gICAgICAgIHtcbiAgICAgICAgICAgIGF0dHJpYnV0ZU5hbWU6ICdzbG93JyxcbiAgICAgICAgICAgIGxhYmVsOiAnVG90YWwgRGFtYWdlJyxcbiAgICAgICAgICAgIGNvbnRyb2xUeXBlOiAndGV4dCcsXG4gICAgICAgICAgICBmbjogZnVuY3Rpb24gKHYsIGEsIHBhcmVudCwgaW5kZXgsIGFiaWxpdHlNb2RlbCwgYWJpbGl0eSkge1xuICAgICAgICAgICAgICAgIGlmICh2ID09IDApIHtcbiAgICAgICAgICAgICAgICAgICAgcmV0dXJuIDA7XG4gICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICAgIHJldHVybiBhYmlsaXR5TW9kZWwuZ2V0QWJpbGl0eUF0dHJpYnV0ZVZhbHVlKGFiaWxpdHkuYXR0cmlidXRlcywgJ3Nsb3cnLHYpO1xuICAgICAgICAgICAgfSxcbiAgICAgICAgICAgIHJldHVyblByb3BlcnR5OiAnbW92ZW1lbnRTcGVlZFBjdFJlZHVjdGlvbidcbiAgICAgICAgfSxcbiAgICAgICAge1xuICAgICAgICAgICAgbGFiZWw6ICdFeG9ydCBMZXZlbCcsXG4gICAgICAgICAgICBjb250cm9sVHlwZTogJ2lucHV0JyxcbiAgICAgICAgICAgIGRpc3BsYXk6ICdhYmlsaXR5J1xuICAgICAgICB9LFxuICAgICAgICB7XG4gICAgICAgICAgICBsYWJlbDogJ0R1cmF0aW9uJyxcbiAgICAgICAgICAgIGNvbnRyb2xUeXBlOiAnaW5wdXQnLFxuICAgICAgICAgICAgZGlzcGxheTogJ2FiaWxpdHknXG4gICAgICAgIH0sXG4gICAgICAgIHtcbiAgICAgICAgICAgIGF0dHJpYnV0ZU5hbWU6ICdkYW1hZ2VfcGVyX3NlY29uZCcsXG4gICAgICAgICAgICBsYWJlbDogJ0RBTUFHRTonLFxuICAgICAgICAgICAgaWdub3JlVG9vbHRpcDogdHJ1ZSxcbiAgICAgICAgICAgIGNvbnRyb2xUeXBlOiAndGV4dCcsXG4gICAgICAgICAgICBkaXNwbGF5OiAnYWJpbGl0eScsXG4gICAgICAgICAgICBjb250cm9sczogWzEsMl0sXG4gICAgICAgICAgICBmbjogZnVuY3Rpb24gKHYsIGEsIHBhcmVudCwgaW5kZXgsIGFiaWxpdHlNb2RlbCwgYWJpbGl0eSkge1xuICAgICAgICAgICAgICAgIGlmICh2WzBdID09IDApIHtcbiAgICAgICAgICAgICAgICAgICAgcmV0dXJuIDA7XG4gICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICAgIHJldHVybiBhYmlsaXR5TW9kZWwuZ2V0QWJpbGl0eUF0dHJpYnV0ZVZhbHVlKGFiaWxpdHkuYXR0cmlidXRlcywgJ2RhbWFnZV9wZXJfc2Vjb25kJyx2WzBdKSp2WzFdO1xuICAgICAgICAgICAgfVxuICAgICAgICB9XG4gICAgXSxcbiAgICAnamFraXJvX2R1YWxfYnJlYXRoJzogW1xuICAgICAgICB7XG4gICAgICAgICAgICBsYWJlbDogJ0R1cmF0aW9uJyxcbiAgICAgICAgICAgIGNvbnRyb2xUeXBlOiAnaW5wdXQnXG4gICAgICAgIH0sXG4gICAgICAgIHtcbiAgICAgICAgICAgIGxhYmVsOiAnREFNQUdFOicsXG4gICAgICAgICAgICBjb250cm9sVHlwZTogJ3RleHQnLFxuICAgICAgICAgICAgZm46IGZ1bmN0aW9uICh2LCBhLCBwYXJlbnQsIGluZGV4LCBhYmlsaXR5TW9kZWwsIGFiaWxpdHkpIHtcbiAgICAgICAgICAgICAgICByZXR1cm4gYWJpbGl0eU1vZGVsLmdldEFiaWxpdHlQcm9wZXJ0eVZhbHVlKGFiaWxpdHksICdkYW1hZ2UnKSoyICsgXG4gICAgICAgICAgICAgICAgYWJpbGl0eU1vZGVsLmdldEFiaWxpdHlBdHRyaWJ1dGVWYWx1ZShhYmlsaXR5LmF0dHJpYnV0ZXMsICdidXJuX2RhbWFnZScsYWJpbGl0eS5sZXZlbCgpKSp2O1xuICAgICAgICAgICAgfVxuICAgICAgICB9LFxuICAgICAgICB7XG4gICAgICAgICAgICBhdHRyaWJ1dGVOYW1lOiAnc2xvd19tb3ZlbWVudF9zcGVlZF9wY3QnLFxuICAgICAgICAgICAgbGFiZWw6ICdUb3RhbCBEYW1hZ2UnLFxuICAgICAgICAgICAgY29udHJvbFR5cGU6ICd0ZXh0JyxcbiAgICAgICAgICAgIGZuOiBmdW5jdGlvbiAodiwgYSwgcGFyZW50LCBpbmRleCwgYWJpbGl0eU1vZGVsLCBhYmlsaXR5KSB7XG4gICAgICAgICAgICAgICAgcmV0dXJuIGE7XG4gICAgICAgICAgICB9LFxuICAgICAgICAgICAgcmV0dXJuUHJvcGVydHk6ICdtb3ZlbWVudFNwZWVkUGN0UmVkdWN0aW9uJ1xuICAgICAgICB9LFxuICAgICAgICB7XG4gICAgICAgICAgICBhdHRyaWJ1dGVOYW1lOiAnc2xvd19hdHRhY2tfc3BlZWRfcGN0JyxcbiAgICAgICAgICAgIGxhYmVsOiAnJUFUVEFDSyBTTE9XOicsXG4gICAgICAgICAgICBpZ25vcmVUb29sdGlwOiB0cnVlLFxuICAgICAgICAgICAgY29udHJvbFR5cGU6ICd0ZXh0JyxcbiAgICAgICAgICAgIGZuOiBmdW5jdGlvbiAodiwgYSwgcGFyZW50LCBpbmRleCwgYWJpbGl0eU1vZGVsLCBhYmlsaXR5KSB7XG4gICAgICAgICAgICAgICAgcmV0dXJuIGE7XG4gICAgICAgICAgICB9LFxuICAgICAgICAgICAgcmV0dXJuUHJvcGVydHk6ICdhdHRhY2tzcGVlZHJlZHVjdGlvbidcbiAgICAgICAgfVxuICAgIF0sXG4gICAgJ2pha2lyb19saXF1aWRfZmlyZSc6IFtcbiAgICAgICAge1xuICAgICAgICAgICAgbGFiZWw6ICdEdXJhdGlvbicsXG4gICAgICAgICAgICBjb250cm9sVHlwZTogJ2lucHV0J1xuICAgICAgICB9LFxuICAgICAgICB7XG4gICAgICAgICAgICBhdHRyaWJ1dGVOYW1lOiAnZGFtYWdlJyxcbiAgICAgICAgICAgIGxhYmVsOiAnVG90YWwgRGFtYWdlJyxcbiAgICAgICAgICAgIGNvbnRyb2xUeXBlOiAndGV4dCcsXG4gICAgICAgICAgICBmbjogZnVuY3Rpb24gKHYsIGEsIHBhcmVudCwgaW5kZXgsIGFiaWxpdHlNb2RlbCwgYWJpbGl0eSkge1xuICAgICAgICAgICAgICAgIHJldHVybiB2KmE7XG4gICAgICAgICAgICB9XG4gICAgICAgIH0sXG4gICAgICAgIHtcbiAgICAgICAgICAgIGF0dHJpYnV0ZU5hbWU6ICdzbG93X2F0dGFja19zcGVlZF9wY3QnLFxuICAgICAgICAgICAgbGFiZWw6ICdUb3RhbCBEYW1hZ2UnLFxuICAgICAgICAgICAgY29udHJvbFR5cGU6ICd0ZXh0JyxcbiAgICAgICAgICAgIGZuOiBmdW5jdGlvbiAodiwgYSwgcGFyZW50LCBpbmRleCwgYWJpbGl0eU1vZGVsLCBhYmlsaXR5KSB7XG4gICAgICAgICAgICAgICAgcmV0dXJuIGE7XG4gICAgICAgICAgICB9LFxuICAgICAgICAgICAgcmV0dXJuUHJvcGVydHk6ICdhdHRhY2tzcGVlZHJlZHVjdGlvbidcbiAgICAgICAgfVxuICAgIF0sXG4gICAgJ2pha2lyb19tYWNyb3B5cmUnOiBbXG4gICAgICAgIHtcbiAgICAgICAgICAgIGxhYmVsOiAnRHVyYXRpb24nLFxuICAgICAgICAgICAgY29udHJvbFR5cGU6ICdpbnB1dCdcbiAgICAgICAgfSxcbiAgICAgICAge1xuICAgICAgICAgICAgYXR0cmlidXRlTmFtZTogJ2RhbWFnZScsXG4gICAgICAgICAgICBsYWJlbDogJ1RvdGFsIERhbWFnZScsXG4gICAgICAgICAgICBjb250cm9sVHlwZTogJ3RleHQnLFxuICAgICAgICAgICAgZm46IGZ1bmN0aW9uICh2LCBhLCBwYXJlbnQsIGluZGV4LCBhYmlsaXR5TW9kZWwsIGFiaWxpdHkpIHtcbiAgICAgICAgICAgICAgICByZXR1cm4gdiphO1xuICAgICAgICAgICAgfVxuICAgICAgICB9XG4gICAgXSxcbiAgICAnanVnZ2VybmF1dF9ibGFkZV9mdXJ5JzogW1xuICAgICAgICB7XG4gICAgICAgICAgICBsYWJlbDogJ0R1cmF0aW9uJyxcbiAgICAgICAgICAgIGNvbnRyb2xUeXBlOiAnaW5wdXQnXG4gICAgICAgIH0sXG4gICAgICAgIHtcbiAgICAgICAgICAgIGxhYmVsOiAnREFNQUdFOicsXG4gICAgICAgICAgICBjb250cm9sVHlwZTogJ3RleHQnLFxuICAgICAgICAgICAgZm46IGZ1bmN0aW9uICh2LCBhLCBwYXJlbnQsIGluZGV4LCBhYmlsaXR5TW9kZWwsIGFiaWxpdHkpIHtcbiAgICAgICAgICAgICAgICByZXR1cm4gYWJpbGl0eU1vZGVsLmdldEFiaWxpdHlQcm9wZXJ0eVZhbHVlKGFiaWxpdHksICdkYW1hZ2UnKSp2O1xuICAgICAgICAgICAgfVxuICAgICAgICB9XG4gICAgXSxcbiAgICAnanVnZ2VybmF1dF9oZWFsaW5nX3dhcmQnOiBbXG4gICAgICAgIHtcbiAgICAgICAgICAgIGxhYmVsOiAnRHVyYXRpb24nLFxuICAgICAgICAgICAgY29udHJvbFR5cGU6ICdpbnB1dCdcbiAgICAgICAgfSxcbiAgICAgICAge1xuICAgICAgICAgICAgbGFiZWw6ICdNYXggSGVhbHRoJyxcbiAgICAgICAgICAgIGNvbnRyb2xUeXBlOiAnaW5wdXQnXG4gICAgICAgIH0sXG4gICAgICAgIHtcbiAgICAgICAgICAgIGF0dHJpYnV0ZU5hbWU6ICdoZWFsaW5nX3dhcmRfaGVhbF9hbW91bnQnLFxuICAgICAgICAgICAgbGFiZWw6ICdIRUFMIE9WRVIgVElNRTonLFxuICAgICAgICAgICAgaWdub3JlVG9vbHRpcDogdHJ1ZSxcbiAgICAgICAgICAgIGNvbnRyb2xUeXBlOiAndGV4dCcsXG4gICAgICAgICAgICBjb250cm9sczogWzAsMV0sXG4gICAgICAgICAgICBmbjogZnVuY3Rpb24gKHYsIGEsIHBhcmVudCwgaW5kZXgsIGFiaWxpdHlNb2RlbCwgYWJpbGl0eSkge1xuICAgICAgICAgICAgICAgIHJldHVybiB2WzBdKnZbMV0qYS8xMDA7XG4gICAgICAgICAgICB9XG4gICAgICAgIH1cbiAgICBdLFxuICAgICdqdWdnZXJuYXV0X29tbmlfc2xhc2gnOiBbXG4gICAgICAgIHtcbiAgICAgICAgICAgIGxhYmVsOiAnSnVtcHMnLFxuICAgICAgICAgICAgY29udHJvbFR5cGU6ICdpbnB1dCdcbiAgICAgICAgfSxcbiAgICAgICAge1xuICAgICAgICAgICAgbGFiZWw6ICdNSU4gREFNQUdFOicsXG4gICAgICAgICAgICBpZ25vcmVUb29sdGlwOiB0cnVlLFxuICAgICAgICAgICAgY29udHJvbFR5cGU6ICd0ZXh0JyxcbiAgICAgICAgICAgIGZuOiBmdW5jdGlvbiAodiwgYSwgcGFyZW50LCBpbmRleCwgYWJpbGl0eU1vZGVsLCBhYmlsaXR5KSB7XG4gICAgICAgICAgICAgICAgcmV0dXJuIGFiaWxpdHlNb2RlbC5nZXRBYmlsaXR5QXR0cmlidXRlVmFsdWUoYWJpbGl0eS5hdHRyaWJ1dGVzLCAnb21uaV9zbGFzaF9kYW1hZ2UnLDEpKnY7XG4gICAgICAgICAgICB9XG4gICAgICAgIH0sXG4gICAgICAgIHtcbiAgICAgICAgICAgIGxhYmVsOiAnTUFYIERBTUFHRTonLFxuICAgICAgICAgICAgaWdub3JlVG9vbHRpcDogdHJ1ZSxcbiAgICAgICAgICAgIGNvbnRyb2xUeXBlOiAndGV4dCcsXG4gICAgICAgICAgICBmbjogZnVuY3Rpb24gKHYsIGEsIHBhcmVudCwgaW5kZXgsIGFiaWxpdHlNb2RlbCwgYWJpbGl0eSkge1xuICAgICAgICAgICAgICAgIHJldHVybiBhYmlsaXR5TW9kZWwuZ2V0QWJpbGl0eUF0dHJpYnV0ZVZhbHVlKGFiaWxpdHkuYXR0cmlidXRlcywgJ29tbmlfc2xhc2hfZGFtYWdlJywyKSp2O1xuICAgICAgICAgICAgfVxuICAgICAgICB9XG4gICAgXSxcbiAgICAna2VlcGVyX29mX3RoZV9saWdodF9pbGx1bWluYXRlJzogW1xuICAgICAgICB7XG4gICAgICAgICAgICBsYWJlbDogJ0R1cmF0aW9uJyxcbiAgICAgICAgICAgIGNvbnRyb2xUeXBlOiAnaW5wdXQnXG4gICAgICAgIH0sXG4gICAgICAgIHtcbiAgICAgICAgICAgIGF0dHJpYnV0ZU5hbWU6ICdkYW1hZ2VfcGVyX3NlY29uZCcsXG4gICAgICAgICAgICBsYWJlbDogJ0RBTUFHRTonLFxuICAgICAgICAgICAgaWdub3JlVG9vbHRpcDogdHJ1ZSxcbiAgICAgICAgICAgIGNvbnRyb2xUeXBlOiAndGV4dCcsXG4gICAgICAgICAgICBmbjogZnVuY3Rpb24gKHYsIGEsIHBhcmVudCwgaW5kZXgsIGFiaWxpdHlNb2RlbCwgYWJpbGl0eSkge1xuICAgICAgICAgICAgICAgIHJldHVybiB2KmE7XG4gICAgICAgICAgICB9XG4gICAgICAgIH1cbiAgICBdLFxuICAgICdrZWVwZXJfb2ZfdGhlX2xpZ2h0X21hbmFfbGVhayc6IFtcbiAgICAgICAge1xuICAgICAgICAgICAgbGFiZWw6ICdEaXN0YW5jZSBNb3ZlZCcsXG4gICAgICAgICAgICBjb250cm9sVHlwZTogJ2lucHV0J1xuICAgICAgICB9LFxuICAgICAgICB7XG4gICAgICAgICAgICBsYWJlbDogJ0VuZW15IE1heCBNYW5hJyxcbiAgICAgICAgICAgIGNvbnRyb2xUeXBlOiAnaW5wdXQnXG4gICAgICAgIH0sXG4gICAgICAgIHtcbiAgICAgICAgICAgIGF0dHJpYnV0ZU5hbWU6ICdtYW5hX2xlYWtfcGN0JyxcbiAgICAgICAgICAgIGxhYmVsOiAnTUFOQSBMRUFLRUQ6JyxcbiAgICAgICAgICAgIGlnbm9yZVRvb2x0aXA6IHRydWUsXG4gICAgICAgICAgICBjb250cm9sVHlwZTogJ3RleHQnLFxuICAgICAgICAgICAgY29udHJvbHM6IFswLDFdLFxuICAgICAgICAgICAgZm46IGZ1bmN0aW9uICh2LCBhLCBwYXJlbnQsIGluZGV4LCBhYmlsaXR5TW9kZWwsIGFiaWxpdHkpIHtcbiAgICAgICAgICAgICAgICByZXR1cm4gdlswXS8xMDAqdlsxXSphLzEwMDtcbiAgICAgICAgICAgIH1cbiAgICAgICAgfVxuICAgIF0sXG4gICAgJ2xlZ2lvbl9jb21tYW5kZXJfZHVlbCc6IFtcbiAgICAgICAge1xuICAgICAgICAgICAgbGFiZWw6ICdEdWVsIFdpbnMnLFxuICAgICAgICAgICAgY29udHJvbFR5cGU6ICdpbnB1dCdcbiAgICAgICAgfSxcbiAgICAgICAge1xuICAgICAgICAgICAgYXR0cmlidXRlTmFtZTogJ3Jld2FyZF9kYW1hZ2UnLFxuICAgICAgICAgICAgbGFiZWw6ICdUb3RhbCBEYW1hZ2U6JyxcbiAgICAgICAgICAgIGlnbm9yZVRvb2x0aXA6IHRydWUsXG4gICAgICAgICAgICBjb250cm9sVHlwZTogJ3RleHQnLFxuICAgICAgICAgICAgZm46IGZ1bmN0aW9uICh2LCBhLCBwYXJlbnQsIGluZGV4LCBhYmlsaXR5TW9kZWwsIGFiaWxpdHkpIHtcbiAgICAgICAgICAgICAgICByZXR1cm4gdiphO1xuICAgICAgICAgICAgfSxcbiAgICAgICAgICAgIHJldHVyblByb3BlcnR5OiAnYm9udXNEYW1hZ2UnXG4gICAgICAgIH1cbiAgICBdLFxuICAgICdsZXNocmFjX3B1bHNlX25vdmEnOiBbXG4gICAgICAgIHtcbiAgICAgICAgICAgIGxhYmVsOiAnRHVyYXRpb24nLFxuICAgICAgICAgICAgY29udHJvbFR5cGU6ICdpbnB1dCdcbiAgICAgICAgfSxcbiAgICAgICAge1xuICAgICAgICAgICAgYXR0cmlidXRlTmFtZTogJ2RhbWFnZScsXG4gICAgICAgICAgICBsYWJlbDogJ1RvdGFsIERhbWFnZScsXG4gICAgICAgICAgICBjb250cm9sVHlwZTogJ3RleHQnLFxuICAgICAgICAgICAgZm46IGZ1bmN0aW9uICh2LCBhLCBwYXJlbnQsIGluZGV4LCBhYmlsaXR5TW9kZWwsIGFiaWxpdHkpIHtcbiAgICAgICAgICAgICAgICByZXR1cm4gdiphO1xuICAgICAgICAgICAgfVxuICAgICAgICB9LFxuICAgICAgICB7XG4gICAgICAgICAgICBhdHRyaWJ1dGVOYW1lOiAnbWFuYV9jb3N0X3Blcl9zZWNvbmQnLFxuICAgICAgICAgICAgbGFiZWw6ICdNQU5BIENPU1Q6JyxcbiAgICAgICAgICAgIGlnbm9yZVRvb2x0aXA6IHRydWUsXG4gICAgICAgICAgICBjb250cm9sVHlwZTogJ3RleHQnLFxuICAgICAgICAgICAgZm46IGZ1bmN0aW9uICh2LCBhLCBwYXJlbnQsIGluZGV4LCBhYmlsaXR5TW9kZWwsIGFiaWxpdHkpIHtcbiAgICAgICAgICAgICAgICByZXR1cm4gdiphO1xuICAgICAgICAgICAgfVxuICAgICAgICB9XG4gICAgXSxcbiAgICAnbGljaF9jaGFpbl9mcm9zdCc6IFtcbiAgICAgICAge1xuICAgICAgICAgICAgbGFiZWw6ICdCb3VuY2UgSGl0cycsXG4gICAgICAgICAgICBjb250cm9sVHlwZTogJ2lucHV0J1xuICAgICAgICB9LFxuICAgICAgICB7XG4gICAgICAgICAgICBhdHRyaWJ1dGVOYW1lOiAnZGFtYWdlJyxcbiAgICAgICAgICAgIGxhYmVsOiAnVG90YWwgRGFtYWdlJyxcbiAgICAgICAgICAgIGNvbnRyb2xUeXBlOiAndGV4dCcsXG4gICAgICAgICAgICBmbjogZnVuY3Rpb24gKHYsIGEsIHBhcmVudCwgaW5kZXgsIGFiaWxpdHlNb2RlbCwgYWJpbGl0eSkge1xuICAgICAgICAgICAgICAgIHJldHVybiB2KmE7XG4gICAgICAgICAgICB9XG4gICAgICAgIH0sXG4gICAgICAgIHtcbiAgICAgICAgICAgIGF0dHJpYnV0ZU5hbWU6ICdzbG93X21vdmVtZW50X3NwZWVkJyxcbiAgICAgICAgICAgIGxhYmVsOiAnRW5lbXkgTW92ZW1lbnQgU3BlZWQgU2xvdycsXG4gICAgICAgICAgICBjb250cm9sVHlwZTogJ3RleHQnLFxuICAgICAgICAgICAgZm46IGZ1bmN0aW9uICh2LCBhLCBwYXJlbnQsIGluZGV4LCBhYmlsaXR5TW9kZWwsIGFiaWxpdHkpIHtcbiAgICAgICAgICAgICAgICByZXR1cm4gYTtcbiAgICAgICAgICAgIH0sXG4gICAgICAgICAgICByZXR1cm5Qcm9wZXJ0eTogJ21vdmVtZW50U3BlZWRQY3RSZWR1Y3Rpb24nXG4gICAgICAgIH0sXG4gICAgICAgIHtcbiAgICAgICAgICAgIGF0dHJpYnV0ZU5hbWU6ICdzbG93X2F0dGFja19zcGVlZCcsXG4gICAgICAgICAgICBsYWJlbDogJ1RvdGFsIERhbWFnZScsXG4gICAgICAgICAgICBjb250cm9sVHlwZTogJ3RleHQnLFxuICAgICAgICAgICAgZm46IGZ1bmN0aW9uICh2LCBhLCBwYXJlbnQsIGluZGV4LCBhYmlsaXR5TW9kZWwsIGFiaWxpdHkpIHtcbiAgICAgICAgICAgICAgICByZXR1cm4gYTtcbiAgICAgICAgICAgIH0sXG4gICAgICAgICAgICByZXR1cm5Qcm9wZXJ0eTogJ2F0dGFja3NwZWVkcmVkdWN0aW9uJ1xuICAgICAgICB9XG4gICAgXSxcbiAgICAnbGlmZV9zdGVhbGVyX2ZlYXN0JzogW1xuICAgICAgICB7XG4gICAgICAgICAgICBsYWJlbDogJ0VuZW15IEN1cnJlbnQgSFAnLFxuICAgICAgICAgICAgY29udHJvbFR5cGU6ICdpbnB1dCdcbiAgICAgICAgfSxcbiAgICAgICAge1xuICAgICAgICAgICAgYXR0cmlidXRlTmFtZTogJ2hwX2xlZWNoX3BlcmNlbnQnLFxuICAgICAgICAgICAgbGFiZWw6ICdUb3RhbCBEYW1hZ2UnLFxuICAgICAgICAgICAgY29udHJvbFR5cGU6ICd0ZXh0JyxcbiAgICAgICAgICAgIGZuOiBmdW5jdGlvbiAodiwgYSwgcGFyZW50LCBpbmRleCwgYWJpbGl0eU1vZGVsLCBhYmlsaXR5KSB7XG4gICAgICAgICAgICAgICAgcmV0dXJuIHYqYS8xMDA7XG4gICAgICAgICAgICB9LFxuICAgICAgICAgICAgcmV0dXJuUHJvcGVydHk6ICdib251c0RhbWFnZSdcbiAgICAgICAgfVxuICAgIF0sXG4gICAgJ2xpZmVfc3RlYWxlcl9vcGVuX3dvdW5kcyc6IFtcbiAgICAgICAge1xuICAgICAgICAgICAgbGFiZWw6ICdEdXJhdGlvbicsXG4gICAgICAgICAgICBjb250cm9sVHlwZTogJ2lucHV0J1xuICAgICAgICB9LFxuICAgICAgICB7XG4gICAgICAgICAgICBhdHRyaWJ1dGVOYW1lOiAnaGVhbF9wZXJjZW50JyxcbiAgICAgICAgICAgIGxhYmVsOiAnVG90YWwgRGFtYWdlJyxcbiAgICAgICAgICAgIGNvbnRyb2xUeXBlOiAndGV4dCcsXG4gICAgICAgICAgICBmbjogZnVuY3Rpb24gKHYsIGEsIHBhcmVudCwgaW5kZXgsIGFiaWxpdHlNb2RlbCwgYWJpbGl0eSkge1xuICAgICAgICAgICAgICAgIHJldHVybiBhO1xuICAgICAgICAgICAgfSxcbiAgICAgICAgICAgIHJldHVyblByb3BlcnR5OiAnbGlmZXN0ZWFsJ1xuICAgICAgICB9LFxuICAgICAgICB7XG4gICAgICAgICAgICBhdHRyaWJ1dGVOYW1lOiAnc2xvd19zdGVwcycsXG4gICAgICAgICAgICBsYWJlbDogJyVTTE9XOicsXG4gICAgICAgICAgICBpZ25vcmVUb29sdGlwOiB0cnVlLFxuICAgICAgICAgICAgY29udHJvbFR5cGU6ICd0ZXh0JyxcbiAgICAgICAgICAgIG5vTGV2ZWw6IHRydWUsXG4gICAgICAgICAgICBmbjogZnVuY3Rpb24gKHYsIGEsIHBhcmVudCwgaW5kZXgsIGFiaWxpdHlNb2RlbCwgYWJpbGl0eSkge1xuICAgICAgICAgICAgICAgIHJldHVybiBhYmlsaXR5TW9kZWwuZ2V0QWJpbGl0eUF0dHJpYnV0ZVZhbHVlKGFiaWxpdHkuYXR0cmlidXRlcywgJ3Nsb3dfc3RlcHMnLHYrMSk7XG4gICAgICAgICAgICB9LFxuICAgICAgICAgICAgcmV0dXJuUHJvcGVydHk6ICdtb3ZlbWVudFNwZWVkUGN0UmVkdWN0aW9uJ1xuICAgICAgICB9XG4gICAgXSxcbiAgICAnbGluYV9maWVyeV9zb3VsJzogW1xuICAgICAgICB7XG4gICAgICAgICAgICBsYWJlbDogJ0R1cmF0aW9uJyxcbiAgICAgICAgICAgIGNvbnRyb2xUeXBlOiAnaW5wdXQnXG4gICAgICAgIH0sXG4gICAgICAgIHtcbiAgICAgICAgICAgIGF0dHJpYnV0ZU5hbWU6ICdmaWVyeV9zb3VsX21vdmVfc3BlZWRfYm9udXMnLFxuICAgICAgICAgICAgbGFiZWw6ICdFbmVteSBNb3ZlbWVudCBTcGVlZCBTbG93JyxcbiAgICAgICAgICAgIGNvbnRyb2xUeXBlOiAndGV4dCcsXG4gICAgICAgICAgICBmbjogZnVuY3Rpb24gKHYsIGEsIHBhcmVudCwgaW5kZXgsIGFiaWxpdHlNb2RlbCwgYWJpbGl0eSkge1xuICAgICAgICAgICAgICAgIHJldHVybiB2KmE7XG4gICAgICAgICAgICB9LFxuICAgICAgICAgICAgcmV0dXJuUHJvcGVydHk6ICdtb3ZlbWVudFNwZWVkUGN0J1xuICAgICAgICB9LFxuICAgICAgICB7XG4gICAgICAgICAgICBhdHRyaWJ1dGVOYW1lOiAnZmllcnlfc291bF9hdHRhY2tfc3BlZWRfYm9udXMnLFxuICAgICAgICAgICAgbGFiZWw6ICdUb3RhbCBEYW1hZ2UnLFxuICAgICAgICAgICAgY29udHJvbFR5cGU6ICd0ZXh0JyxcbiAgICAgICAgICAgIGZuOiBmdW5jdGlvbiAodiwgYSwgcGFyZW50LCBpbmRleCwgYWJpbGl0eU1vZGVsLCBhYmlsaXR5KSB7XG4gICAgICAgICAgICAgICAgcmV0dXJuIHYqYTtcbiAgICAgICAgICAgIH0sXG4gICAgICAgICAgICByZXR1cm5Qcm9wZXJ0eTogJ2F0dGFja3NwZWVkJ1xuICAgICAgICB9XG4gICAgXSxcbiAgICAnbGlvbl9tYW5hX2RyYWluJzogW1xuICAgICAgICB7XG4gICAgICAgICAgICBsYWJlbDogJ0R1cmF0aW9uJyxcbiAgICAgICAgICAgIGNvbnRyb2xUeXBlOiAnaW5wdXQnXG4gICAgICAgIH0sXG4gICAgICAgIHtcbiAgICAgICAgICAgIGF0dHJpYnV0ZU5hbWU6ICdtYW5hX3Blcl9zZWNvbmQnLFxuICAgICAgICAgICAgbGFiZWw6ICdNQU5BIERSQUlORUQ6JyxcbiAgICAgICAgICAgIGlnbm9yZVRvb2x0aXA6IHRydWUsXG4gICAgICAgICAgICBjb250cm9sVHlwZTogJ3RleHQnLFxuICAgICAgICAgICAgZm46IGZ1bmN0aW9uICh2LCBhLCBwYXJlbnQsIGluZGV4LCBhYmlsaXR5TW9kZWwsIGFiaWxpdHkpIHtcbiAgICAgICAgICAgICAgICByZXR1cm4gdiphO1xuICAgICAgICAgICAgfVxuICAgICAgICB9XG4gICAgXSxcbiAgICAnbHVuYV9tb29uX2dsYWl2ZSc6IFtcbiAgICAgICAge1xuICAgICAgICAgICAgbGFiZWw6ICdEYW1hZ2UnLFxuICAgICAgICAgICAgY29udHJvbFR5cGU6ICdpbnB1dCdcbiAgICAgICAgfSxcbiAgICAgICAge1xuICAgICAgICAgICAgYXR0cmlidXRlTmFtZTogJ2RhbWFnZV9yZWR1Y3Rpb25fcGVyY2VudCcsXG4gICAgICAgICAgICBsYWJlbDogJ0JPVU5DRSBEQU1BR0U6JyxcbiAgICAgICAgICAgIGlnbm9yZVRvb2x0aXA6IHRydWUsXG4gICAgICAgICAgICBjb250cm9sVHlwZTogJ3RleHQnLFxuICAgICAgICAgICAgZm46IGZ1bmN0aW9uICh2LCBhLCBwYXJlbnQsIGluZGV4LCBhYmlsaXR5TW9kZWwsIGFiaWxpdHkpIHtcbiAgICAgICAgICAgICAgICB2YXIgcmVzdWx0ID0gW107XG4gICAgICAgICAgICAgICAgZm9yICh2YXIgaSA9IDE7IGkgPCA2OyBpKyspIHtcbiAgICAgICAgICAgICAgICAgICAgcmVzdWx0LnB1c2goKHYqTWF0aC5wb3coYS8xMDAsaSkpLnRvRml4ZWQoMikpXG4gICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICAgIHJldHVybiByZXN1bHQuam9pbignPGJyPicpO1xuICAgICAgICAgICAgfVxuICAgICAgICB9XG4gICAgXSxcbiAgICAnbHVuYV9lY2xpcHNlJzogW1xuICAgICAgICB7XG4gICAgICAgICAgICBsYWJlbDogJ0JlYW0gQ291bnQnLFxuICAgICAgICAgICAgY29udHJvbFR5cGU6ICdpbnB1dCdcbiAgICAgICAgfSxcbiAgICAgICAge1xuICAgICAgICAgICAgYXR0cmlidXRlTmFtZTogJ2JlYW1zJyxcbiAgICAgICAgICAgIGxhYmVsOiAnVG90YWwgRGFtYWdlJyxcbiAgICAgICAgICAgIGNvbnRyb2xUeXBlOiAndGV4dCcsXG4gICAgICAgICAgICBmbjogZnVuY3Rpb24gKHYsIGEsIHBhcmVudCwgaW5kZXgsIGFiaWxpdHlNb2RlbCwgYWJpbGl0eSkge1xuICAgICAgICAgICAgICAgIHZhciBsdWNlbnRCZWFtQWJpbGl0eSA9IGFiaWxpdHlNb2RlbC5hYmlsaXRpZXMoKS5maW5kKGZ1bmN0aW9uKGIpIHtcbiAgICAgICAgICAgICAgICAgICAgcmV0dXJuIGIubmFtZSA9PSAnbHVuYV9sdWNlbnRfYmVhbSc7XG4gICAgICAgICAgICAgICAgfSk7XG4gICAgICAgICAgICAgICAgaWYgKGx1Y2VudEJlYW1BYmlsaXR5LmxldmVsKCkgPT0gMCkgcmV0dXJuIDA7XG4gICAgICAgICAgICAgICAgdmFyIGRhbWFnZSA9IGFiaWxpdHlNb2RlbC5nZXRBYmlsaXR5UHJvcGVydHlWYWx1ZShsdWNlbnRCZWFtQWJpbGl0eSwgJ2RhbWFnZScpO1xuICAgICAgICAgICAgICAgIHJldHVybiB2KmRhbWFnZTtcbiAgICAgICAgICAgIH1cbiAgICAgICAgfVxuICAgIF0sXG4gICAgJ21lZHVzYV9teXN0aWNfc25ha2UnOiBbXG4gICAgICAgIHtcbiAgICAgICAgICAgIGxhYmVsOiAnSnVtcCBDb3VudCcsXG4gICAgICAgICAgICBjb250cm9sVHlwZTogJ2lucHV0J1xuICAgICAgICB9LFxuICAgICAgICB7XG4gICAgICAgICAgICBhdHRyaWJ1dGVOYW1lOiAnc25ha2VfZGFtYWdlJyxcbiAgICAgICAgICAgIGxhYmVsOiAnRGFtYWdlIFBlciBKdW1wOicsXG4gICAgICAgICAgICBpZ25vcmVUb29sdGlwOiB0cnVlLFxuICAgICAgICAgICAgY29udHJvbFR5cGU6ICdtZXRob2QnLFxuICAgICAgICAgICAgZGlzcGxheTogJ25vbmUnLFxuICAgICAgICAgICAgZm46IGZ1bmN0aW9uICh2LCBhLCBwYXJlbnQsIGluZGV4LCBhYmlsaXR5TW9kZWwsIGFiaWxpdHkpIHtcbiAgICAgICAgICAgICAgICB2YXIgc25ha2VfanVtcHMgPSBhYmlsaXR5TW9kZWwuZ2V0QWJpbGl0eUF0dHJpYnV0ZVZhbHVlKGFiaWxpdHkuYXR0cmlidXRlcywgJ3NuYWtlX2p1bXBzJyxhYmlsaXR5LmxldmVsKCkpO1xuICAgICAgICAgICAgICAgIHZhciBzbmFrZV9zY2FsZSA9IGFiaWxpdHlNb2RlbC5nZXRBYmlsaXR5QXR0cmlidXRlVmFsdWUoYWJpbGl0eS5hdHRyaWJ1dGVzLCAnc25ha2Vfc2NhbGUnLDApO1xuICAgICAgICAgICAgICAgIHZhciBkYW1hZ2UgPSBbXTtcbiAgICAgICAgICAgICAgICBmb3IgKHZhciBpID0gMDsgaSA8IHNuYWtlX2p1bXBzOyBpKyspIHtcbiAgICAgICAgICAgICAgICAgICAgZGFtYWdlLnB1c2goYSArIGEgKiBpICogc25ha2Vfc2NhbGUvMTAwKTtcbiAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgICAgcmV0dXJuIGRhbWFnZTtcbiAgICAgICAgICAgIH1cbiAgICAgICAgfSxcbiAgICAgICAge1xuICAgICAgICAgICAgYXR0cmlidXRlTmFtZTogJ3NuYWtlX2RhbWFnZScsXG4gICAgICAgICAgICBsYWJlbDogJ0RhbWFnZSBQZXIgSnVtcDonLFxuICAgICAgICAgICAgaWdub3JlVG9vbHRpcDogdHJ1ZSxcbiAgICAgICAgICAgIGNvbnRyb2xUeXBlOiAndGV4dCcsXG4gICAgICAgICAgICBjb250cm9sczogWzAsMV0sXG4gICAgICAgICAgICBmbjogZnVuY3Rpb24gKHYsIGEsIHBhcmVudCwgaW5kZXgsIGFiaWxpdHlNb2RlbCwgYWJpbGl0eSkge1xuICAgICAgICAgICAgICAgIHJldHVybiB2WzFdLmpvaW4oJyAvICcpO1xuICAgICAgICAgICAgfVxuICAgICAgICB9LFxuICAgICAgICB7XG4gICAgICAgICAgICBhdHRyaWJ1dGVOYW1lOiAnc25ha2VfZGFtYWdlJyxcbiAgICAgICAgICAgIGxhYmVsOiAnVG90YWwgRGFtYWdlOicsXG4gICAgICAgICAgICBpZ25vcmVUb29sdGlwOiB0cnVlLFxuICAgICAgICAgICAgY29udHJvbFR5cGU6ICd0ZXh0JyxcbiAgICAgICAgICAgIGNvbnRyb2xzOiBbMCwxXSxcbiAgICAgICAgICAgIGZuOiBmdW5jdGlvbiAodiwgYSwgcGFyZW50LCBpbmRleCwgYWJpbGl0eU1vZGVsLCBhYmlsaXR5KSB7XG4gICAgICAgICAgICAgICAgcmV0dXJuIHZbMV0uc2xpY2UoMCwgdlswXSkucmVkdWNlKGZ1bmN0aW9uIChtZW1vLCBvKSB7IHJldHVybiBtZW1vICsgbyB9LCAwKTtcbiAgICAgICAgICAgIH1cbiAgICAgICAgfSxcbiAgICAgICAge1xuICAgICAgICAgICAgYXR0cmlidXRlTmFtZTogJ3NuYWtlX2RhbWFnZScsXG4gICAgICAgICAgICBsYWJlbDogJ01heCBEYW1hZ2U6JyxcbiAgICAgICAgICAgIGlnbm9yZVRvb2x0aXA6IHRydWUsXG4gICAgICAgICAgICBjb250cm9sVHlwZTogJ3RleHQnLFxuICAgICAgICAgICAgY29udHJvbHM6IFswLDFdLFxuICAgICAgICAgICAgZm46IGZ1bmN0aW9uICh2LCBhLCBwYXJlbnQsIGluZGV4LCBhYmlsaXR5TW9kZWwsIGFiaWxpdHkpIHtcbiAgICAgICAgICAgICAgICByZXR1cm4gdlsxXS5yZWR1Y2UoZnVuY3Rpb24gKG1lbW8sIG8pIHsgcmV0dXJuIG1lbW8gKyBvIH0sIDApO1xuICAgICAgICAgICAgfVxuICAgICAgICB9XG4gICAgXSxcbiAgICAnbWVkdXNhX21hbmFfc2hpZWxkJzogW1xuICAgICAgICB7XG4gICAgICAgICAgICBsYWJlbDogJ0RhbWFnZScsXG4gICAgICAgICAgICBjb250cm9sVHlwZTogJ2lucHV0J1xuICAgICAgICB9LFxuICAgICAgICB7XG4gICAgICAgICAgICBhdHRyaWJ1dGVOYW1lOiAnZGFtYWdlX3Blcl9tYW5hJyxcbiAgICAgICAgICAgIGxhYmVsOiAnTUFOQSBVU0VEOicsXG4gICAgICAgICAgICBpZ25vcmVUb29sdGlwOiB0cnVlLFxuICAgICAgICAgICAgY29udHJvbFR5cGU6ICd0ZXh0JyxcbiAgICAgICAgICAgIGZuOiBmdW5jdGlvbiAodiwgYSwgcGFyZW50LCBpbmRleCwgYWJpbGl0eU1vZGVsLCBhYmlsaXR5KSB7XG4gICAgICAgICAgICAgICAgcmV0dXJuICh2L2EpLnRvRml4ZWQoMik7XG4gICAgICAgICAgICB9XG4gICAgICAgIH0sXG4gICAgICAgIHtcbiAgICAgICAgICAgIGF0dHJpYnV0ZU5hbWU6ICdhYnNvcnB0aW9uX3Rvb2x0aXAnLFxuICAgICAgICAgICAgbGFiZWw6ICclREFNQUdFIFJFRFVDVElPTjonLFxuICAgICAgICAgICAgaWdub3JlVG9vbHRpcDogdHJ1ZSxcbiAgICAgICAgICAgIGNvbnRyb2xUeXBlOiAndGV4dCcsXG4gICAgICAgICAgICBmbjogZnVuY3Rpb24gKHYsIGEsIHBhcmVudCwgaW5kZXgsIGFiaWxpdHlNb2RlbCwgYWJpbGl0eSkge1xuICAgICAgICAgICAgICAgIHJldHVybiAtYTtcbiAgICAgICAgICAgIH0sXG4gICAgICAgICAgICByZXR1cm5Qcm9wZXJ0eTogJ2RhbWFnZVJlZHVjdGlvbidcbiAgICAgICAgfVxuICAgIF0sXG4gICAgJ21lZXBvX3Bvb2YnOiBbXG4gICAgICAgIHtcbiAgICAgICAgICAgIGxhYmVsOiAnTWVlcG8gQ291bnQnLFxuICAgICAgICAgICAgY29udHJvbFR5cGU6ICdpbnB1dCdcbiAgICAgICAgfSxcbiAgICAgICAge1xuICAgICAgICAgICAgbGFiZWw6ICdEQU1BR0U6JyxcbiAgICAgICAgICAgIGNvbnRyb2xUeXBlOiAndGV4dCcsXG4gICAgICAgICAgICBmbjogZnVuY3Rpb24gKHYsIGEsIHBhcmVudCwgaW5kZXgsIGFiaWxpdHlNb2RlbCwgYWJpbGl0eSkge1xuICAgICAgICAgICAgICAgIHJldHVybiBhYmlsaXR5TW9kZWwuZ2V0QWJpbGl0eVByb3BlcnR5VmFsdWUoYWJpbGl0eSwgJ2RhbWFnZScpKnY7XG4gICAgICAgICAgICB9XG4gICAgICAgIH1cbiAgICBdLFxuICAgICdtZWVwb19nZW9zdHJpa2UnOiBbXG4gICAgICAgIHtcbiAgICAgICAgICAgIGxhYmVsOiAnU3RhY2tzJyxcbiAgICAgICAgICAgIGNvbnRyb2xUeXBlOiAnaW5wdXQnXG4gICAgICAgIH0sXG4gICAgICAgIHtcbiAgICAgICAgICAgIGxhYmVsOiAnREFNQUdFOicsXG4gICAgICAgICAgICBpZ25vcmVUb29sdGlwOiB0cnVlLFxuICAgICAgICAgICAgY29udHJvbFR5cGU6ICd0ZXh0JyxcbiAgICAgICAgICAgIGZuOiBmdW5jdGlvbiAodiwgYSwgcGFyZW50LCBpbmRleCwgYWJpbGl0eU1vZGVsLCBhYmlsaXR5KSB7XG4gICAgICAgICAgICAgICAgcmV0dXJuIGFiaWxpdHlNb2RlbC5nZXRBYmlsaXR5UHJvcGVydHlWYWx1ZShhYmlsaXR5LCAnZGFtYWdlJykqdjtcbiAgICAgICAgICAgIH1cbiAgICAgICAgfSxcbiAgICAgICAge1xuICAgICAgICAgICAgYXR0cmlidXRlTmFtZTogJ3Nsb3cnLFxuICAgICAgICAgICAgbGFiZWw6ICclU0xPVzonLFxuICAgICAgICAgICAgaWdub3JlVG9vbHRpcDogdHJ1ZSxcbiAgICAgICAgICAgIGNvbnRyb2xUeXBlOiAndGV4dCcsXG4gICAgICAgICAgICBub0xldmVsOiB0cnVlLFxuICAgICAgICAgICAgZm46IGZ1bmN0aW9uICh2LCBhLCBwYXJlbnQsIGluZGV4LCBhYmlsaXR5TW9kZWwsIGFiaWxpdHkpIHtcbiAgICAgICAgICAgICAgICByZXR1cm4gYWJpbGl0eU1vZGVsLmdldEFiaWxpdHlBdHRyaWJ1dGVWYWx1ZShhYmlsaXR5LmF0dHJpYnV0ZXMsICdzbG93JyxhYmlsaXR5LmxldmVsKCkpKnY7XG4gICAgICAgICAgICB9LFxuICAgICAgICAgICAgcmV0dXJuUHJvcGVydHk6ICdtb3ZlbWVudFNwZWVkUGN0UmVkdWN0aW9uJ1xuICAgICAgICB9XG4gICAgXSxcbiAgICAnbWlyYW5hX2Fycm93JzogW1xuICAgICAgICB7XG4gICAgICAgICAgICBsYWJlbDogJ0Fycm93IFRyYXZlbCBEaXN0YW5jZScsXG4gICAgICAgICAgICBjb250cm9sVHlwZTogJ2lucHV0J1xuICAgICAgICB9LFxuICAgICAgICB7XG4gICAgICAgICAgICBhdHRyaWJ1dGVOYW1lOiAnYXJyb3dfbWF4X3N0dW4nLFxuICAgICAgICAgICAgbGFiZWw6ICdTVFVOIERVUkFUSU9OOicsXG4gICAgICAgICAgICBpZ25vcmVUb29sdGlwOiB0cnVlLFxuICAgICAgICAgICAgY29udHJvbFR5cGU6ICd0ZXh0JyxcbiAgICAgICAgICAgIGZuOiBmdW5jdGlvbiAodiwgYSwgcGFyZW50LCBpbmRleCwgYWJpbGl0eU1vZGVsLCBhYmlsaXR5KSB7XG4gICAgICAgICAgICAgICAgdmFyIGFycm93X21pbl9zdHVuID0gYWJpbGl0eU1vZGVsLmdldEFiaWxpdHlBdHRyaWJ1dGVWYWx1ZShhYmlsaXR5LmF0dHJpYnV0ZXMsICdhcnJvd19taW5fc3R1bicsMCk7XG4gICAgICAgICAgICAgICAgdmFyIGFycm93X21heF9zdHVucmFuZ2UgPSBhYmlsaXR5TW9kZWwuZ2V0QWJpbGl0eUF0dHJpYnV0ZVZhbHVlKGFiaWxpdHkuYXR0cmlidXRlcywgJ2Fycm93X21heF9zdHVucmFuZ2UnLDApO1xuICAgICAgICAgICAgICAgIHZhciBzY2FsZSA9IE1hdGgubWluKHYsIGFycm93X21heF9zdHVucmFuZ2UpIC8gYXJyb3dfbWF4X3N0dW5yYW5nZTtcbiAgICAgICAgICAgICAgICByZXR1cm4gTWF0aC5tYXgoYXJyb3dfbWluX3N0dW4sIE1hdGguZmxvb3IoYSAqIHNjYWxlIC8gMC4xKSAqIDAuMSk7XG4gICAgICAgICAgICB9XG4gICAgICAgIH0sXG4gICAgICAgIHtcbiAgICAgICAgICAgIGF0dHJpYnV0ZU5hbWU6ICdhcnJvd19ib251c19kYW1hZ2UnLFxuICAgICAgICAgICAgbGFiZWw6ICdUT1RBTCBEQU1BR0U6JyxcbiAgICAgICAgICAgIGlnbm9yZVRvb2x0aXA6IHRydWUsXG4gICAgICAgICAgICBjb250cm9sVHlwZTogJ3RleHQnLFxuICAgICAgICAgICAgZm46IGZ1bmN0aW9uICh2LCBhLCBwYXJlbnQsIGluZGV4LCBhYmlsaXR5TW9kZWwsIGFiaWxpdHkpIHtcbiAgICAgICAgICAgICAgICB2YXIgYWJpbGl0eSA9IGFiaWxpdHk7XG4gICAgICAgICAgICAgICAgdmFyIGRhbWFnZSA9IGFiaWxpdHkuZGFtYWdlKClbYWJpbGl0eS5sZXZlbCgpLTFdO1xuICAgICAgICAgICAgICAgIHZhciBhcnJvd19tYXhfc3R1bnJhbmdlID0gYWJpbGl0eU1vZGVsLmdldEFiaWxpdHlBdHRyaWJ1dGVWYWx1ZShhYmlsaXR5LmF0dHJpYnV0ZXMsICdhcnJvd19tYXhfc3R1bnJhbmdlJywwKTtcbiAgICAgICAgICAgICAgICB2YXIgc2NhbGUgPSBNYXRoLm1pbih2LCBhcnJvd19tYXhfc3R1bnJhbmdlKSAvIGFycm93X21heF9zdHVucmFuZ2U7XG4gICAgICAgICAgICAgICAgdmFyIGJvbnVzX2RhbWFnZSA9IE1hdGguZmxvb3IoYSAqIHNjYWxlIC8gMi44KSAqIDIuODtcbiAgICAgICAgICAgICAgICByZXR1cm4gZGFtYWdlICsgJyArICcgKyBib251c19kYW1hZ2UgKyAnID0gJyArIChkYW1hZ2UgKyBib251c19kYW1hZ2UpO1xuICAgICAgICAgICAgfVxuICAgICAgICB9XG4gICAgXSxcbiAgICAnbW9ycGhsaW5nX21vcnBoX2FnaSc6IFtcbiAgICAgICAge1xuICAgICAgICAgICAgbGFiZWw6ICdTaGlmdHMnLFxuICAgICAgICAgICAgY29udHJvbFR5cGU6ICdpbnB1dCdcbiAgICAgICAgfSxcbiAgICAgICAge1xuICAgICAgICAgICAgYXR0cmlidXRlTmFtZTogJ3BvaW50c19wZXJfdGljaycsXG4gICAgICAgICAgICBsYWJlbDogJ0FHSSBTSElGVCBHQUlOOicsXG4gICAgICAgICAgICBpZ25vcmVUb29sdGlwOiB0cnVlLFxuICAgICAgICAgICAgY29udHJvbFR5cGU6ICd0ZXh0JyxcbiAgICAgICAgICAgIGZuOiBmdW5jdGlvbiAodiwgYSwgcGFyZW50LCBpbmRleCwgYWJpbGl0eU1vZGVsLCBhYmlsaXR5KSB7XG4gICAgICAgICAgICAgICAgcmV0dXJuIHYqYTtcbiAgICAgICAgICAgIH0sXG4gICAgICAgICAgICByZXR1cm5Qcm9wZXJ0eTogJ2JvbnVzQWdpbGl0eSdcbiAgICAgICAgfSxcbiAgICAgICAge1xuICAgICAgICAgICAgYXR0cmlidXRlTmFtZTogJ3BvaW50c19wZXJfdGljaycsXG4gICAgICAgICAgICBsYWJlbDogJ1NUUiBTSElGVCBMT1NTOicsXG4gICAgICAgICAgICBpZ25vcmVUb29sdGlwOiB0cnVlLFxuICAgICAgICAgICAgY29udHJvbFR5cGU6ICd0ZXh0JyxcbiAgICAgICAgICAgIGZuOiBmdW5jdGlvbiAodiwgYSwgcGFyZW50LCBpbmRleCwgYWJpbGl0eU1vZGVsLCBhYmlsaXR5KSB7XG4gICAgICAgICAgICAgICAgcmV0dXJuIC12KmE7XG4gICAgICAgICAgICB9LFxuICAgICAgICAgICAgcmV0dXJuUHJvcGVydHk6ICdib251c1N0cmVuZ3RoJ1xuICAgICAgICB9LFxuICAgICAgICB7XG4gICAgICAgICAgICBhdHRyaWJ1dGVOYW1lOiAnYm9udXNfYXR0cmlidXRlcycsXG4gICAgICAgICAgICBsYWJlbDogJ1NISUZUIFRJTUU6JyxcbiAgICAgICAgICAgIGNvbnRyb2xUeXBlOiAndGV4dCcsXG4gICAgICAgICAgICBmbjogZnVuY3Rpb24gKHYsIGEsIHBhcmVudCwgaW5kZXgsIGFiaWxpdHlNb2RlbCwgYWJpbGl0eSkge1xuICAgICAgICAgICAgICAgIHJldHVybiBhO1xuICAgICAgICAgICAgfSxcbiAgICAgICAgICAgIHJldHVyblByb3BlcnR5OiAnYm9udXNBZ2lsaXR5MidcbiAgICAgICAgfSxcbiAgICAgICAge1xuICAgICAgICAgICAgYXR0cmlidXRlTmFtZTogJ21vcnBoX2Nvb2xkb3duJyxcbiAgICAgICAgICAgIGxhYmVsOiAnU0hJRlQgVElNRTonLFxuICAgICAgICAgICAgaWdub3JlVG9vbHRpcDogdHJ1ZSxcbiAgICAgICAgICAgIGNvbnRyb2xUeXBlOiAndGV4dCcsXG4gICAgICAgICAgICBmbjogZnVuY3Rpb24gKHYsIGEsIHBhcmVudCwgaW5kZXgsIGFiaWxpdHlNb2RlbCwgYWJpbGl0eSkge1xuICAgICAgICAgICAgICAgIHJldHVybiB2KmE7XG4gICAgICAgICAgICB9XG4gICAgICAgIH0sXG4gICAgICAgIHtcbiAgICAgICAgICAgIGF0dHJpYnV0ZU5hbWU6ICdtYW5hX2Nvc3QnLFxuICAgICAgICAgICAgbGFiZWw6ICdTSElGVCBNQU5BIENPU1Q6JyxcbiAgICAgICAgICAgIGlnbm9yZVRvb2x0aXA6IHRydWUsXG4gICAgICAgICAgICBjb250cm9sVHlwZTogJ3RleHQnLFxuICAgICAgICAgICAgZm46IGZ1bmN0aW9uICh2LCBhLCBwYXJlbnQsIGluZGV4LCBhYmlsaXR5TW9kZWwsIGFiaWxpdHkpIHtcbiAgICAgICAgICAgICAgICByZXR1cm4gdiphKmFiaWxpdHlNb2RlbC5nZXRBYmlsaXR5QXR0cmlidXRlVmFsdWUoYWJpbGl0eS5hdHRyaWJ1dGVzLCAnbW9ycGhfY29vbGRvd24nLGFiaWxpdHkubGV2ZWwoKSk7XG4gICAgICAgICAgICB9XG4gICAgICAgIH1cbiAgICBdLFxuICAgICdtb3JwaGxpbmdfbW9ycGhfc3RyJzogW1xuICAgICAgICB7XG4gICAgICAgICAgICBsYWJlbDogJ1NoaWZ0cycsXG4gICAgICAgICAgICBjb250cm9sVHlwZTogJ2lucHV0J1xuICAgICAgICB9LFxuICAgICAgICB7XG4gICAgICAgICAgICBhdHRyaWJ1dGVOYW1lOiAncG9pbnRzX3Blcl90aWNrJyxcbiAgICAgICAgICAgIGxhYmVsOiAnU1RSIFNISUZUIEdBSU46JyxcbiAgICAgICAgICAgIGlnbm9yZVRvb2x0aXA6IHRydWUsXG4gICAgICAgICAgICBjb250cm9sVHlwZTogJ3RleHQnLFxuICAgICAgICAgICAgZm46IGZ1bmN0aW9uICh2LCBhLCBwYXJlbnQsIGluZGV4LCBhYmlsaXR5TW9kZWwsIGFiaWxpdHkpIHtcbiAgICAgICAgICAgICAgICByZXR1cm4gdiphO1xuICAgICAgICAgICAgfSxcbiAgICAgICAgICAgIHJldHVyblByb3BlcnR5OiAnYm9udXNTdHJlbmd0aCdcbiAgICAgICAgfSxcbiAgICAgICAge1xuICAgICAgICAgICAgYXR0cmlidXRlTmFtZTogJ3BvaW50c19wZXJfdGljaycsXG4gICAgICAgICAgICBsYWJlbDogJ0FHSSBTSElGVCBMT1NTOicsXG4gICAgICAgICAgICBpZ25vcmVUb29sdGlwOiB0cnVlLFxuICAgICAgICAgICAgY29udHJvbFR5cGU6ICd0ZXh0JyxcbiAgICAgICAgICAgIGZuOiBmdW5jdGlvbiAodiwgYSwgcGFyZW50LCBpbmRleCwgYWJpbGl0eU1vZGVsLCBhYmlsaXR5KSB7XG4gICAgICAgICAgICAgICAgcmV0dXJuIC12KmE7XG4gICAgICAgICAgICB9LFxuICAgICAgICAgICAgcmV0dXJuUHJvcGVydHk6ICdib251c0FnaWxpdHknXG4gICAgICAgIH0sXG4gICAgICAgIHtcbiAgICAgICAgICAgIGF0dHJpYnV0ZU5hbWU6ICdib251c19hdHRyaWJ1dGVzJyxcbiAgICAgICAgICAgIGxhYmVsOiAnU0hJRlQgVElNRTonLFxuICAgICAgICAgICAgY29udHJvbFR5cGU6ICd0ZXh0JyxcbiAgICAgICAgICAgIGZuOiBmdW5jdGlvbiAodiwgYSwgcGFyZW50LCBpbmRleCwgYWJpbGl0eU1vZGVsLCBhYmlsaXR5KSB7XG4gICAgICAgICAgICAgICAgcmV0dXJuIGE7XG4gICAgICAgICAgICB9LFxuICAgICAgICAgICAgcmV0dXJuUHJvcGVydHk6ICdib251c1N0cmVuZ3RoMidcbiAgICAgICAgfSxcbiAgICAgICAge1xuICAgICAgICAgICAgYXR0cmlidXRlTmFtZTogJ21vcnBoX2Nvb2xkb3duJyxcbiAgICAgICAgICAgIGxhYmVsOiAnU0hJRlQgVElNRTonLFxuICAgICAgICAgICAgaWdub3JlVG9vbHRpcDogdHJ1ZSxcbiAgICAgICAgICAgIGNvbnRyb2xUeXBlOiAndGV4dCcsXG4gICAgICAgICAgICBmbjogZnVuY3Rpb24gKHYsIGEsIHBhcmVudCwgaW5kZXgsIGFiaWxpdHlNb2RlbCwgYWJpbGl0eSkge1xuICAgICAgICAgICAgICAgIHJldHVybiB2KmE7XG4gICAgICAgICAgICB9XG4gICAgICAgIH0sXG4gICAgICAgIHtcbiAgICAgICAgICAgIGF0dHJpYnV0ZU5hbWU6ICdtYW5hX2Nvc3QnLFxuICAgICAgICAgICAgbGFiZWw6ICdTSElGVCBNQU5BIENPU1Q6JyxcbiAgICAgICAgICAgIGlnbm9yZVRvb2x0aXA6IHRydWUsXG4gICAgICAgICAgICBjb250cm9sVHlwZTogJ3RleHQnLFxuICAgICAgICAgICAgZm46IGZ1bmN0aW9uICh2LCBhLCBwYXJlbnQsIGluZGV4LCBhYmlsaXR5TW9kZWwsIGFiaWxpdHkpIHtcbiAgICAgICAgICAgICAgICByZXR1cm4gdiphKmFiaWxpdHlNb2RlbC5nZXRBYmlsaXR5QXR0cmlidXRlVmFsdWUoYWJpbGl0eS5hdHRyaWJ1dGVzLCAnbW9ycGhfY29vbGRvd24nLGFiaWxpdHkubGV2ZWwoKSk7XG4gICAgICAgICAgICB9XG4gICAgICAgIH1cbiAgICBdLFxuICAgICdmdXJpb25fd3JhdGhfb2ZfbmF0dXJlJzogW1xuICAgICAgICB7XG4gICAgICAgICAgICBsYWJlbDogJ0R1cmF0aW9uJyxcbiAgICAgICAgICAgIGNvbnRyb2xUeXBlOiAnaW5wdXQnXG4gICAgICAgIH0sXG4gICAgICAgIHtcbiAgICAgICAgICAgIGF0dHJpYnV0ZU5hbWU6ICdkYW1hZ2UnLFxuICAgICAgICAgICAgbGFiZWw6ICdUb3RhbCBEYW1hZ2UnLFxuICAgICAgICAgICAgY29udHJvbFR5cGU6ICd0ZXh0JyxcbiAgICAgICAgICAgIGZuOiBmdW5jdGlvbiAodiwgYSwgcGFyZW50LCBpbmRleCwgYWJpbGl0eU1vZGVsLCBhYmlsaXR5KSB7XG4gICAgICAgICAgICAgICAgcmV0dXJuIHYqYTtcbiAgICAgICAgICAgIH1cbiAgICAgICAgfVxuICAgIF0sXG4gICAgJ25lY3JvbHl0ZV9oZWFydHN0b3BwZXJfYXVyYSc6IFtcbiAgICAgICAge1xuICAgICAgICAgICAgbGFiZWw6ICdEdXJhdGlvbicsXG4gICAgICAgICAgICBjb250cm9sVHlwZTogJ2lucHV0J1xuICAgICAgICB9LFxuICAgICAgICB7XG4gICAgICAgICAgICBsYWJlbDogJ0VuZW15IE1heCBIZWFsdGgnLFxuICAgICAgICAgICAgY29udHJvbFR5cGU6ICdpbnB1dCdcbiAgICAgICAgfSxcbiAgICAgICAge1xuICAgICAgICAgICAgYXR0cmlidXRlTmFtZTogJ2F1cmFfZGFtYWdlJyxcbiAgICAgICAgICAgIGxhYmVsOiAnSEVBTFRIIExPU1Q6JyxcbiAgICAgICAgICAgIGlnbm9yZVRvb2x0aXA6IHRydWUsXG4gICAgICAgICAgICBjb250cm9sVHlwZTogJ3RleHQnLFxuICAgICAgICAgICAgY29udHJvbHM6IFswLDFdLFxuICAgICAgICAgICAgZm46IGZ1bmN0aW9uICh2LCBhLCBwYXJlbnQsIGluZGV4LCBhYmlsaXR5TW9kZWwsIGFiaWxpdHkpIHtcbiAgICAgICAgICAgICAgICByZXR1cm4gdlswXSp2WzFdKmEvMTAwO1xuICAgICAgICAgICAgfVxuICAgICAgICB9XG4gICAgXSxcbiAgICAnbmVjcm9seXRlX3NhZGlzdCc6IFtcbiAgICAgICAge1xuICAgICAgICAgICAgbGFiZWw6ICdVbml0IEtpbGxzJyxcbiAgICAgICAgICAgIGNvbnRyb2xUeXBlOiAnaW5wdXQnXG4gICAgICAgIH0sXG4gICAgICAgIHtcbiAgICAgICAgICAgIGxhYmVsOiAnSGVybyBLaWxscycsXG4gICAgICAgICAgICBjb250cm9sVHlwZTogJ2lucHV0J1xuICAgICAgICB9LFxuICAgICAgICB7XG4gICAgICAgICAgICBhdHRyaWJ1dGVOYW1lOiAnaGVhbHRoX3JlZ2VuJyxcbiAgICAgICAgICAgIGxhYmVsOiAnVG90YWwgRGFtYWdlJyxcbiAgICAgICAgICAgIGNvbnRyb2xUeXBlOiAndGV4dCcsXG4gICAgICAgICAgICBjb250cm9sczogWzAsMV0sXG4gICAgICAgICAgICBmbjogZnVuY3Rpb24gKHYsIGEsIHBhcmVudCwgaW5kZXgsIGFiaWxpdHlNb2RlbCwgYWJpbGl0eSkge1xuICAgICAgICAgICAgICAgIHZhciBoZXJvX211bHRpcGxpZXIgPSBhYmlsaXR5TW9kZWwuZ2V0QWJpbGl0eUF0dHJpYnV0ZVZhbHVlKGFiaWxpdHkuYXR0cmlidXRlcywgJ2hlcm9fbXVsdGlwbGllcicsMClcbiAgICAgICAgICAgICAgICByZXR1cm4gKHZbMF0rdlsxXSpoZXJvX211bHRpcGxpZXIpKmE7XG4gICAgICAgICAgICB9LFxuICAgICAgICAgICAgcmV0dXJuUHJvcGVydHk6ICdoZWFsdGhyZWdlbidcbiAgICAgICAgfSxcbiAgICAgICAge1xuICAgICAgICAgICAgYXR0cmlidXRlTmFtZTogJ21hbmFfcmVnZW4nLFxuICAgICAgICAgICAgbGFiZWw6ICdUb3RhbCBEYW1hZ2UnLFxuICAgICAgICAgICAgY29udHJvbFR5cGU6ICd0ZXh0JyxcbiAgICAgICAgICAgIGNvbnRyb2xzOiBbMCwxXSxcbiAgICAgICAgICAgIGZuOiBmdW5jdGlvbiAodiwgYSwgcGFyZW50LCBpbmRleCwgYWJpbGl0eU1vZGVsLCBhYmlsaXR5KSB7XG4gICAgICAgICAgICAgICAgdmFyIGhlcm9fbXVsdGlwbGllciA9IGFiaWxpdHlNb2RlbC5nZXRBYmlsaXR5QXR0cmlidXRlVmFsdWUoYWJpbGl0eS5hdHRyaWJ1dGVzLCAnaGVyb19tdWx0aXBsaWVyJywwKVxuICAgICAgICAgICAgICAgIHJldHVybiAodlswXSt2WzFdKmhlcm9fbXVsdGlwbGllcikqYTtcbiAgICAgICAgICAgIH0sXG4gICAgICAgICAgICByZXR1cm5Qcm9wZXJ0eTogJ21hbmFyZWdlbidcbiAgICAgICAgfVxuICAgIF0sXG4gICAgJ25pZ2h0X3N0YWxrZXJfY3JpcHBsaW5nX2ZlYXInOiBbXG4gICAgICAgIHtcbiAgICAgICAgICAgIGxhYmVsOiAnSXMgTmlnaHQnLFxuICAgICAgICAgICAgY29udHJvbFR5cGU6ICdjaGVja2JveCdcbiAgICAgICAgfSxcbiAgICAgICAge1xuICAgICAgICAgICAgYXR0cmlidXRlTmFtZTogJ21pc3NfcmF0ZV9uaWdodCcsXG4gICAgICAgICAgICBsYWJlbDogJyVDSEFOQ0UgVE8gTUlTUzonLFxuICAgICAgICAgICAgaWdub3JlVG9vbHRpcDogdHJ1ZSxcbiAgICAgICAgICAgIGNvbnRyb2xUeXBlOiAndGV4dCcsXG4gICAgICAgICAgICBmbjogZnVuY3Rpb24gKHYsIGEsIHBhcmVudCwgaW5kZXgsIGFiaWxpdHlNb2RlbCwgYWJpbGl0eSkge1xuICAgICAgICAgICAgICAgIGlmICh2KSB7XG4gICAgICAgICAgICAgICAgICAgIHJldHVybiBhYmlsaXR5TW9kZWwuZ2V0QWJpbGl0eUF0dHJpYnV0ZVZhbHVlKGFiaWxpdHkuYXR0cmlidXRlcywgJ21pc3NfcmF0ZV9uaWdodCcsYWJpbGl0eS5sZXZlbCgpKTtcbiAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgICAgZWxzZSB7XG4gICAgICAgICAgICAgICAgICAgIHJldHVybiBhYmlsaXR5TW9kZWwuZ2V0QWJpbGl0eUF0dHJpYnV0ZVZhbHVlKGFiaWxpdHkuYXR0cmlidXRlcywgJ21pc3NfcmF0ZV9kYXknLGFiaWxpdHkubGV2ZWwoKSk7XG4gICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgfSxcbiAgICAgICAgICAgIHJldHVyblByb3BlcnR5OiAnbWlzc0NoYW5jZSdcbiAgICAgICAgfVxuICAgIF0sICAgIFxuICAgICduaWdodF9zdGFsa2VyX2h1bnRlcl9pbl90aGVfbmlnaHQnOiBbXG4gICAgICAgIHtcbiAgICAgICAgICAgIGxhYmVsOiAnSXMgTmlnaHQnLFxuICAgICAgICAgICAgY29udHJvbFR5cGU6ICdjaGVja2JveCdcbiAgICAgICAgfSxcbiAgICAgICAge1xuICAgICAgICAgICAgYXR0cmlidXRlTmFtZTogJ2JvbnVzX2F0dGFja19zcGVlZF9uaWdodCcsXG4gICAgICAgICAgICBsYWJlbDogJ1RvdGFsIERhbWFnZScsXG4gICAgICAgICAgICBjb250cm9sVHlwZTogJ3RleHQnLFxuICAgICAgICAgICAgZm46IGZ1bmN0aW9uICh2LCBhLCBwYXJlbnQsIGluZGV4LCBhYmlsaXR5TW9kZWwsIGFiaWxpdHkpIHtcbiAgICAgICAgICAgICAgICBpZiAodikge1xuICAgICAgICAgICAgICAgICAgICByZXR1cm4gYTtcbiAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgICAgZWxzZSB7XG4gICAgICAgICAgICAgICAgICAgIHJldHVybiAwO1xuICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgIH0sXG4gICAgICAgICAgICByZXR1cm5Qcm9wZXJ0eTogJ2F0dGFja3NwZWVkJ1xuICAgICAgICB9LFxuICAgICAgICB7XG4gICAgICAgICAgICBhdHRyaWJ1dGVOYW1lOiAnYm9udXNfbW92ZW1lbnRfc3BlZWRfcGN0X25pZ2h0JyxcbiAgICAgICAgICAgIGxhYmVsOiAnVG90YWwgRGFtYWdlJyxcbiAgICAgICAgICAgIGNvbnRyb2xUeXBlOiAndGV4dCcsXG4gICAgICAgICAgICBmbjogZnVuY3Rpb24gKHYsIGEsIHBhcmVudCwgaW5kZXgsIGFiaWxpdHlNb2RlbCwgYWJpbGl0eSkge1xuICAgICAgICAgICAgICAgIGlmICh2KSB7XG4gICAgICAgICAgICAgICAgICAgIHJldHVybiBhO1xuICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgICBlbHNlIHtcbiAgICAgICAgICAgICAgICAgICAgcmV0dXJuIDA7XG4gICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgfSxcbiAgICAgICAgICAgIHJldHVyblByb3BlcnR5OiAnbW92ZW1lbnRTcGVlZFBjdCdcbiAgICAgICAgfVxuICAgIF0sICAgIFxuICAgICdvYnNpZGlhbl9kZXN0cm95ZXJfYXJjYW5lX29yYic6IFtcbiAgICAgICAge1xuICAgICAgICAgICAgbGFiZWw6ICdDdXJyZW50IE1hbmEnLFxuICAgICAgICAgICAgY29udHJvbFR5cGU6ICdpbnB1dCdcbiAgICAgICAgfSxcbiAgICAgICAge1xuICAgICAgICAgICAgYXR0cmlidXRlTmFtZTogJ21hbmFfcG9vbF9kYW1hZ2VfcGN0JyxcbiAgICAgICAgICAgIGxhYmVsOiAnVG90YWwgRGFtYWdlJyxcbiAgICAgICAgICAgIGNvbnRyb2xUeXBlOiAndGV4dCcsXG4gICAgICAgICAgICBmbjogZnVuY3Rpb24gKHYsIGEsIHBhcmVudCwgaW5kZXgsIGFiaWxpdHlNb2RlbCwgYWJpbGl0eSkge1xuICAgICAgICAgICAgICAgIHJldHVybiB2KmEvMTAwO1xuICAgICAgICAgICAgfSxcbiAgICAgICAgICAgIHJldHVyblByb3BlcnR5OiAnYm9udXNEYW1hZ2VPcmInXG4gICAgICAgIH1cbiAgICBdLFxuICAgICdvZ3JlX21hZ2lfaWduaXRlJzogW1xuICAgICAgICB7XG4gICAgICAgICAgICBsYWJlbDogJ0R1cmF0aW9uJyxcbiAgICAgICAgICAgIGNvbnRyb2xUeXBlOiAnaW5wdXQnXG4gICAgICAgIH0sXG4gICAgICAgIHtcbiAgICAgICAgICAgIGF0dHJpYnV0ZU5hbWU6ICdidXJuX2RhbWFnZScsXG4gICAgICAgICAgICBsYWJlbDogJ1RvdGFsIERhbWFnZScsXG4gICAgICAgICAgICBjb250cm9sVHlwZTogJ3RleHQnLFxuICAgICAgICAgICAgZm46IGZ1bmN0aW9uICh2LCBhLCBwYXJlbnQsIGluZGV4LCBhYmlsaXR5TW9kZWwsIGFiaWxpdHkpIHtcbiAgICAgICAgICAgICAgICByZXR1cm4gdiphO1xuICAgICAgICAgICAgfVxuICAgICAgICB9LFxuICAgICAgICB7XG4gICAgICAgICAgICBhdHRyaWJ1dGVOYW1lOiAnc2xvd19tb3ZlbWVudF9zcGVlZF9wY3QnLFxuICAgICAgICAgICAgbGFiZWw6ICdUb3RhbCBEYW1hZ2UnLFxuICAgICAgICAgICAgY29udHJvbFR5cGU6ICd0ZXh0JyxcbiAgICAgICAgICAgIGZuOiBmdW5jdGlvbiAodiwgYSwgcGFyZW50LCBpbmRleCwgYWJpbGl0eU1vZGVsLCBhYmlsaXR5KSB7XG4gICAgICAgICAgICAgICAgcmV0dXJuIGE7XG4gICAgICAgICAgICB9LFxuICAgICAgICAgICAgcmV0dXJuUHJvcGVydHk6ICdtb3ZlbWVudFNwZWVkUGN0UmVkdWN0aW9uJ1xuICAgICAgICB9XG4gICAgXSxcbiAgICAncHVkZ2Vfcm90JzogW1xuICAgICAgICB7XG4gICAgICAgICAgICBsYWJlbDogJ0R1cmF0aW9uJyxcbiAgICAgICAgICAgIGNvbnRyb2xUeXBlOiAnaW5wdXQnXG4gICAgICAgIH0sXG4gICAgICAgIHtcbiAgICAgICAgICAgIGxhYmVsOiAnREFNQUdFOicsXG4gICAgICAgICAgICBjb250cm9sVHlwZTogJ3RleHQnLFxuICAgICAgICAgICAgZm46IGZ1bmN0aW9uICh2LCBhLCBwYXJlbnQsIGluZGV4LCBhYmlsaXR5TW9kZWwsIGFiaWxpdHkpIHtcbiAgICAgICAgICAgICAgICByZXR1cm4gYWJpbGl0eU1vZGVsLmdldEFiaWxpdHlQcm9wZXJ0eVZhbHVlKGFiaWxpdHksICdkYW1hZ2UnKSp2O1xuICAgICAgICAgICAgfVxuICAgICAgICB9LFxuICAgICAgICB7XG4gICAgICAgICAgICBhdHRyaWJ1dGVOYW1lOiAncm90X3Nsb3cnLFxuICAgICAgICAgICAgbGFiZWw6ICdUb3RhbCBEYW1hZ2UnLFxuICAgICAgICAgICAgY29udHJvbFR5cGU6ICd0ZXh0JyxcbiAgICAgICAgICAgIGZuOiBmdW5jdGlvbiAodiwgYSwgcGFyZW50LCBpbmRleCwgYWJpbGl0eU1vZGVsLCBhYmlsaXR5KSB7XG4gICAgICAgICAgICAgICAgcmV0dXJuIGE7XG4gICAgICAgICAgICB9LFxuICAgICAgICAgICAgcmV0dXJuUHJvcGVydHk6ICdtb3ZlbWVudFNwZWVkUGN0UmVkdWN0aW9uJ1xuICAgICAgICB9XG4gICAgXSxcbiAgICAncHVkZ2VfZmxlc2hfaGVhcCc6IFtcbiAgICAgICAge1xuICAgICAgICAgICAgbGFiZWw6ICdTdGFja3MnLFxuICAgICAgICAgICAgY29udHJvbFR5cGU6ICdpbnB1dCdcbiAgICAgICAgfSxcbiAgICAgICAge1xuICAgICAgICAgICAgYXR0cmlidXRlTmFtZTogJ2ZsZXNoX2hlYXBfc3RyZW5ndGhfYnVmZl9hbW91bnQnLFxuICAgICAgICAgICAgbGFiZWw6ICdUb3RhbCBEYW1hZ2UnLFxuICAgICAgICAgICAgY29udHJvbFR5cGU6ICd0ZXh0JyxcbiAgICAgICAgICAgIGZuOiBmdW5jdGlvbiAodiwgYSwgcGFyZW50LCBpbmRleCwgYWJpbGl0eU1vZGVsLCBhYmlsaXR5KSB7XG4gICAgICAgICAgICAgICAgcmV0dXJuIHYqYTtcbiAgICAgICAgICAgIH0sXG4gICAgICAgICAgICByZXR1cm5Qcm9wZXJ0eTogJ2JvbnVzU3RyZW5ndGgnXG4gICAgICAgIH0sXG4gICAgICAgIHtcbiAgICAgICAgICAgIGF0dHJpYnV0ZU5hbWU6ICdmbGVzaF9oZWFwX21hZ2ljX3Jlc2lzdCcsXG4gICAgICAgICAgICBsYWJlbDogJ1RvdGFsIERhbWFnZScsXG4gICAgICAgICAgICBjb250cm9sVHlwZTogJ3RleHQnLFxuICAgICAgICAgICAgZm46IGZ1bmN0aW9uICh2LCBhLCBwYXJlbnQsIGluZGV4LCBhYmlsaXR5TW9kZWwsIGFiaWxpdHkpIHtcbiAgICAgICAgICAgICAgICByZXR1cm4gYTtcbiAgICAgICAgICAgIH0sXG4gICAgICAgICAgICByZXR1cm5Qcm9wZXJ0eTogJ21hZ2ljUmVzaXN0J1xuICAgICAgICB9XG4gICAgXSxcbiAgICAncHVkZ2VfZGlzbWVtYmVyJzogW1xuICAgICAgICB7XG4gICAgICAgICAgICBsYWJlbDogJ0R1cmF0aW9uJyxcbiAgICAgICAgICAgIGNvbnRyb2xUeXBlOiAnaW5wdXQnXG4gICAgICAgIH0sXG4gICAgICAgIHtcbiAgICAgICAgICAgIGF0dHJpYnV0ZU5hbWU6ICdkaXNtZW1iZXJfZGFtYWdlJyxcbiAgICAgICAgICAgIGxhYmVsOiAnVG90YWwgRGFtYWdlJyxcbiAgICAgICAgICAgIGNvbnRyb2xUeXBlOiAndGV4dCcsXG4gICAgICAgICAgICBmbjogZnVuY3Rpb24gKHYsIGEsIHBhcmVudCwgaW5kZXgsIGFiaWxpdHlNb2RlbCwgYWJpbGl0eSkge1xuICAgICAgICAgICAgICAgIHJldHVybiB2KmE7XG4gICAgICAgICAgICB9XG4gICAgICAgIH1cbiAgICBdLFxuICAgICdwdWduYV9uZXRoZXJfd2FyZCc6IFtcbiAgICAgICAge1xuICAgICAgICAgICAgbGFiZWw6ICdFbmVteSBNYW5hIFNwZW50JyxcbiAgICAgICAgICAgIGNvbnRyb2xUeXBlOiAnaW5wdXQnXG4gICAgICAgIH0sXG4gICAgICAgIHtcbiAgICAgICAgICAgIGF0dHJpYnV0ZU5hbWU6ICdtYW5hX211bHRpcGxpZXInLFxuICAgICAgICAgICAgbGFiZWw6ICdEQU1BR0U6JyxcbiAgICAgICAgICAgIGlnbm9yZVRvb2x0aXA6IHRydWUsXG4gICAgICAgICAgICBjb250cm9sVHlwZTogJ3RleHQnLFxuICAgICAgICAgICAgZm46IGZ1bmN0aW9uICh2LCBhLCBwYXJlbnQsIGluZGV4LCBhYmlsaXR5TW9kZWwsIGFiaWxpdHkpIHtcbiAgICAgICAgICAgICAgICByZXR1cm4gdiphO1xuICAgICAgICAgICAgfVxuICAgICAgICB9LFxuICAgICAgICB7XG4gICAgICAgICAgICBhdHRyaWJ1dGVOYW1lOiAnbWFuYV9yZWdlbicsXG4gICAgICAgICAgICBsYWJlbDogJ1RvdGFsIERhbWFnZScsXG4gICAgICAgICAgICBjb250cm9sVHlwZTogJ3RleHQnLFxuICAgICAgICAgICAgZm46IGZ1bmN0aW9uICh2LCBhLCBwYXJlbnQsIGluZGV4LCBhYmlsaXR5TW9kZWwsIGFiaWxpdHkpIHtcbiAgICAgICAgICAgICAgICByZXR1cm4gYTtcbiAgICAgICAgICAgIH0sXG4gICAgICAgICAgICByZXR1cm5Qcm9wZXJ0eTogJ21hbmFyZWdlbnJlZHVjdGlvbidcbiAgICAgICAgfVxuICAgIF0sXG4gICAgJ3B1Z25hX2xpZmVfZHJhaW4nOiBbXG4gICAgICAgIHtcbiAgICAgICAgICAgIGxhYmVsOiAnRHVyYXRpb24nLFxuICAgICAgICAgICAgY29udHJvbFR5cGU6ICdpbnB1dCdcbiAgICAgICAgfSxcbiAgICAgICAge1xuICAgICAgICAgICAgYXR0cmlidXRlTmFtZTogJ2hlYWx0aF9kcmFpbicsXG4gICAgICAgICAgICBsYWJlbDogJ0hFQUxUSCBEUkFJTkVEOicsXG4gICAgICAgICAgICBpZ25vcmVUb29sdGlwOiB0cnVlLFxuICAgICAgICAgICAgY29udHJvbFR5cGU6ICd0ZXh0JyxcbiAgICAgICAgICAgIGZuOiBmdW5jdGlvbiAodiwgYSwgcGFyZW50LCBpbmRleCwgYWJpbGl0eU1vZGVsLCBhYmlsaXR5KSB7XG4gICAgICAgICAgICAgICAgcmV0dXJuIHYqYTtcbiAgICAgICAgICAgIH1cbiAgICAgICAgfVxuICAgIF0sXG4gICAgJ3F1ZWVub2ZwYWluX3NoYWRvd19zdHJpa2UnOiBbXG4gICAgICAgIHtcbiAgICAgICAgICAgIGxhYmVsOiAnRHVyYXRpb24nLFxuICAgICAgICAgICAgY29udHJvbFR5cGU6ICdpbnB1dCdcbiAgICAgICAgfSxcbiAgICAgICAge1xuICAgICAgICAgICAgYXR0cmlidXRlTmFtZTogJ21vdmVtZW50X3Nsb3cnLFxuICAgICAgICAgICAgbGFiZWw6ICdUb3RhbCBEYW1hZ2UnLFxuICAgICAgICAgICAgY29udHJvbFR5cGU6ICd0ZXh0JyxcbiAgICAgICAgICAgIGZuOiBmdW5jdGlvbiAodiwgYSwgcGFyZW50LCBpbmRleCwgYWJpbGl0eU1vZGVsLCBhYmlsaXR5KSB7XG4gICAgICAgICAgICAgICAgcmV0dXJuIGE7XG4gICAgICAgICAgICB9LFxuICAgICAgICAgICAgcmV0dXJuUHJvcGVydHk6ICdtb3ZlbWVudFNwZWVkUGN0UmVkdWN0aW9uJ1xuICAgICAgICB9LFxuICAgICAgICB7XG4gICAgICAgICAgICBhdHRyaWJ1dGVOYW1lOiAnc3RyaWtlX2RhbWFnZScsXG4gICAgICAgICAgICBsYWJlbDogJ1RvdGFsIERhbWFnZTonLFxuICAgICAgICAgICAgaWdub3JlVG9vbHRpcDogdHJ1ZSxcbiAgICAgICAgICAgIGNvbnRyb2xUeXBlOiAndGV4dCcsXG4gICAgICAgICAgICBmbjogZnVuY3Rpb24gKHYsIGEsIHBhcmVudCwgaW5kZXgsIGFiaWxpdHlNb2RlbCwgYWJpbGl0eSkge1xuICAgICAgICAgICAgICAgIHZhciBkdXJhdGlvbl9kYW1hZ2UgPSBhYmlsaXR5TW9kZWwuZ2V0QWJpbGl0eUF0dHJpYnV0ZVZhbHVlKGFiaWxpdHkuYXR0cmlidXRlcywgJ2R1cmF0aW9uX2RhbWFnZScsYWJpbGl0eS5sZXZlbCgpKTtcbiAgICAgICAgICAgICAgICB2YXIgdGlja3MgPSBNYXRoLmZsb29yKHYvMyk7XG4gICAgICAgICAgICAgICAgcmV0dXJuIGEgKyBkdXJhdGlvbl9kYW1hZ2UgKiB0aWNrcztcbiAgICAgICAgICAgIH1cbiAgICAgICAgfVxuICAgIF0sXG4gICAgJ3Jhem9yX3BsYXNtYV9maWVsZCc6IFtcbiAgICAgICAge1xuICAgICAgICAgICAgbGFiZWw6ICdEaXN0YW5jZScsXG4gICAgICAgICAgICBjb250cm9sVHlwZTogJ2lucHV0J1xuICAgICAgICB9LFxuICAgICAgICB7XG4gICAgICAgICAgICBhdHRyaWJ1dGVOYW1lOiAncmFkaXVzJyxcbiAgICAgICAgICAgIGxhYmVsOiAnTUlOIERJU1RBTkNFOicsXG4gICAgICAgICAgICBpZ25vcmVUb29sdGlwOiB0cnVlLFxuICAgICAgICAgICAgY29udHJvbFR5cGU6ICd0ZXh0JyxcbiAgICAgICAgICAgIGZuOiBmdW5jdGlvbiAodiwgYSwgcGFyZW50LCBpbmRleCwgYWJpbGl0eU1vZGVsLCBhYmlsaXR5KSB7XG4gICAgICAgICAgICAgICAgcmV0dXJuIDIwMDtcbiAgICAgICAgICAgIH1cbiAgICAgICAgfSxcbiAgICAgICAge1xuICAgICAgICAgICAgYXR0cmlidXRlTmFtZTogJ3JhZGl1cycsXG4gICAgICAgICAgICBsYWJlbDogJ01BWCBESVNUQU5DRTonLFxuICAgICAgICAgICAgaWdub3JlVG9vbHRpcDogdHJ1ZSxcbiAgICAgICAgICAgIGNvbnRyb2xUeXBlOiAndGV4dCcsXG4gICAgICAgICAgICBmbjogZnVuY3Rpb24gKHYsIGEsIHBhcmVudCwgaW5kZXgsIGFiaWxpdHlNb2RlbCwgYWJpbGl0eSkge1xuICAgICAgICAgICAgICAgIHJldHVybiAyMDAgKyBhO1xuICAgICAgICAgICAgfVxuICAgICAgICB9LFxuICAgICAgICB7XG4gICAgICAgICAgICBhdHRyaWJ1dGVOYW1lOiAncmFkaXVzJyxcbiAgICAgICAgICAgIGxhYmVsOiAnSW5zdGFuY2UgRGFtYWdlJyxcbiAgICAgICAgICAgIGlnbm9yZVRvb2x0aXA6IHRydWUsXG4gICAgICAgICAgICBjb250cm9sVHlwZTogJ3RleHQnLFxuICAgICAgICAgICAgZm46IGZ1bmN0aW9uICh2LCBhLCBwYXJlbnQsIGluZGV4LCBhYmlsaXR5TW9kZWwsIGFiaWxpdHkpIHtcbiAgICAgICAgICAgICAgICB2YXIgbWF4X3JhZGl1cyA9IGEgKyAyMDA7XG4gICAgICAgICAgICAgICAgdmFyIHNjYWxlID0gKE1hdGgubWluKE1hdGgubWF4KHYsIDIwMCksIG1heF9yYWRpdXMpIC0gMjAwKSAvIChtYXhfcmFkaXVzIC0gMjAwKTtcbiAgICAgICAgICAgICAgICB2YXIgZGFtYWdlX21pbiA9IGFiaWxpdHlNb2RlbC5nZXRBYmlsaXR5QXR0cmlidXRlVmFsdWUoYWJpbGl0eS5hdHRyaWJ1dGVzLCAnZGFtYWdlX21pbicsYWJpbGl0eS5sZXZlbCgpKTtcbiAgICAgICAgICAgICAgICB2YXIgZGFtYWdlX21heCA9IGFiaWxpdHlNb2RlbC5nZXRBYmlsaXR5QXR0cmlidXRlVmFsdWUoYWJpbGl0eS5hdHRyaWJ1dGVzLCAnZGFtYWdlX21heCcsYWJpbGl0eS5sZXZlbCgpKTtcbiAgICAgICAgICAgICAgICByZXR1cm4gZGFtYWdlX21pbiArIChkYW1hZ2VfbWF4IC0gZGFtYWdlX21pbikgKiBzY2FsZTtcbiAgICAgICAgICAgIH1cbiAgICAgICAgfVxuICAgIF0sXG4gICAgJ3Jhem9yX3N0YXRpY19saW5rJzogW1xuICAgICAgICB7XG4gICAgICAgICAgICBsYWJlbDogJ0R1cmF0aW9uJyxcbiAgICAgICAgICAgIGNvbnRyb2xUeXBlOiAnaW5wdXQnXG4gICAgICAgIH0sXG4gICAgICAgIHtcbiAgICAgICAgICAgIGF0dHJpYnV0ZU5hbWU6ICdkcmFpbl9sZW5ndGgnLFxuICAgICAgICAgICAgbGFiZWw6ICdEYW1hZ2UgRHJhaW5lZDonLFxuICAgICAgICAgICAgaWdub3JlVG9vbHRpcDogdHJ1ZSxcbiAgICAgICAgICAgIGNvbnRyb2xUeXBlOiAndGV4dCcsXG4gICAgICAgICAgICBmbjogZnVuY3Rpb24gKHYsIGEsIHBhcmVudCwgaW5kZXgsIGFiaWxpdHlNb2RlbCwgYWJpbGl0eSkge1xuICAgICAgICAgICAgICAgIHZhciB0aWNrX2R1cmF0aW9uID0gTWF0aC5mbG9vcih2ICogNCkgKyAxO1xuICAgICAgICAgICAgICAgIHZhciB0aWNrcyA9IE1hdGgubWluKGEgKiA0ICsgMSwgdGlja19kdXJhdGlvbik7XG4gICAgICAgICAgICAgICAgdmFyIGRyYWluX3JhdGUgPSBhYmlsaXR5TW9kZWwuZ2V0QWJpbGl0eUF0dHJpYnV0ZVZhbHVlKGFiaWxpdHkuYXR0cmlidXRlcywgJ2RyYWluX3JhdGUnLGFiaWxpdHkubGV2ZWwoKSk7XG4gICAgICAgICAgICAgICAgcmV0dXJuIHRpY2tzICogZHJhaW5fcmF0ZS80O1xuICAgICAgICAgICAgfSxcbiAgICAgICAgICAgIHJldHVyblByb3BlcnR5OiAnYm9udXNEYW1hZ2UnXG4gICAgICAgIH0sXG4gICAgICAgIHtcbiAgICAgICAgICAgIGF0dHJpYnV0ZU5hbWU6ICdkcmFpbl9sZW5ndGgnLFxuICAgICAgICAgICAgbGFiZWw6ICdFbmVteSBEYW1hZ2UgTG9zdDonLFxuICAgICAgICAgICAgaWdub3JlVG9vbHRpcDogdHJ1ZSxcbiAgICAgICAgICAgIGNvbnRyb2xUeXBlOiAndGV4dCcsXG4gICAgICAgICAgICBkaXNwbGF5OiAnaGlkZGVuJyxcbiAgICAgICAgICAgIGZuOiBmdW5jdGlvbiAodiwgYSwgcGFyZW50LCBpbmRleCwgYWJpbGl0eU1vZGVsLCBhYmlsaXR5KSB7XG4gICAgICAgICAgICAgICAgdmFyIHRpY2tfZHVyYXRpb24gPSBNYXRoLmZsb29yKHYgKiA0KSArIDE7XG4gICAgICAgICAgICAgICAgdmFyIHRpY2tzID0gTWF0aC5taW4oYSAqIDQgKyAxLCB0aWNrX2R1cmF0aW9uKTtcbiAgICAgICAgICAgICAgICB2YXIgZHJhaW5fcmF0ZSA9IGFiaWxpdHlNb2RlbC5nZXRBYmlsaXR5QXR0cmlidXRlVmFsdWUoYWJpbGl0eS5hdHRyaWJ1dGVzLCAnZHJhaW5fcmF0ZScsYWJpbGl0eS5sZXZlbCgpKTtcbiAgICAgICAgICAgICAgICByZXR1cm4gdGlja3MgKiBkcmFpbl9yYXRlLzQ7XG4gICAgICAgICAgICB9LFxuICAgICAgICAgICAgcmV0dXJuUHJvcGVydHk6ICdib251c0RhbWFnZVJlZHVjdGlvbidcbiAgICAgICAgfVxuICAgIF0sXG4gICAgJ3Jhem9yX2V5ZV9vZl90aGVfc3Rvcm0nOiBbXG4gICAgICAgIHtcbiAgICAgICAgICAgIGxhYmVsOiAnRHVyYXRpb24nLFxuICAgICAgICAgICAgY29udHJvbFR5cGU6ICdpbnB1dCdcbiAgICAgICAgfSxcbiAgICAgICAge1xuICAgICAgICAgICAgYXR0cmlidXRlTmFtZTogJ2RhbWFnZScsXG4gICAgICAgICAgICBsYWJlbDogJ1RvdGFsIERhbWFnZScsXG4gICAgICAgICAgICBjb250cm9sVHlwZTogJ3RleHQnLFxuICAgICAgICAgICAgZm46IGZ1bmN0aW9uICh2LCBhLCBwYXJlbnQsIGluZGV4LCBhYmlsaXR5TW9kZWwsIGFiaWxpdHkpIHtcbiAgICAgICAgICAgICAgICByZXR1cm4gdiphO1xuICAgICAgICAgICAgfVxuICAgICAgICB9XG4gICAgXSxcbiAgICAncnViaWNrX2ZhZGVfYm9sdCc6IFtcbiAgICAgICAge1xuICAgICAgICAgICAgbGFiZWw6ICdKdW1wcycsXG4gICAgICAgICAgICBjb250cm9sVHlwZTogJ2lucHV0J1xuICAgICAgICB9LFxuICAgICAgICB7XG4gICAgICAgICAgICBhdHRyaWJ1dGVOYW1lOiAnZGFtYWdlJyxcbiAgICAgICAgICAgIGxhYmVsOiAnVG90YWwgRGFtYWdlJyxcbiAgICAgICAgICAgIGNvbnRyb2xUeXBlOiAndGV4dCcsXG4gICAgICAgICAgICBmbjogZnVuY3Rpb24gKHYsIGEsIHBhcmVudCwgaW5kZXgsIGFiaWxpdHlNb2RlbCwgYWJpbGl0eSkge1xuICAgICAgICAgICAgICAgIHJldHVybiBhICogKDEgLSB2KmFiaWxpdHlNb2RlbC5nZXRBYmlsaXR5QXR0cmlidXRlVmFsdWUoYWJpbGl0eS5hdHRyaWJ1dGVzLCAnanVtcF9kYW1hZ2VfcmVkdWN0aW9uX3BjdCcsYWJpbGl0eS5sZXZlbCgpKS8xMDApO1xuICAgICAgICAgICAgfVxuICAgICAgICB9LFxuICAgICAgICB7XG4gICAgICAgICAgICBhdHRyaWJ1dGVOYW1lOiAnaGVyb19hdHRhY2tfZGFtYWdlX3JlZHVjdGlvbicsXG4gICAgICAgICAgICBsYWJlbDogJ1RvdGFsIERhbWFnZScsXG4gICAgICAgICAgICBjb250cm9sVHlwZTogJ3RleHQnLFxuICAgICAgICAgICAgZm46IGZ1bmN0aW9uICh2LCBhLCBwYXJlbnQsIGluZGV4LCBhYmlsaXR5TW9kZWwsIGFiaWxpdHkpIHtcbiAgICAgICAgICAgICAgICByZXR1cm4gYTtcbiAgICAgICAgICAgIH0sXG4gICAgICAgICAgICByZXR1cm5Qcm9wZXJ0eTogJ2JvbnVzRGFtYWdlUmVkdWN0aW9uJ1xuICAgICAgICB9XG4gICAgXSxcbiAgICAnc2FuZGtpbmdfc2FuZF9zdG9ybSc6IFtcbiAgICAgICAge1xuICAgICAgICAgICAgbGFiZWw6ICdEdXJhdGlvbicsXG4gICAgICAgICAgICBjb250cm9sVHlwZTogJ2lucHV0J1xuICAgICAgICB9LFxuICAgICAgICB7XG4gICAgICAgICAgICBsYWJlbDogJ0RBTUFHRTonLFxuICAgICAgICAgICAgY29udHJvbFR5cGU6ICd0ZXh0JyxcbiAgICAgICAgICAgIGZuOiBmdW5jdGlvbiAodiwgYSwgcGFyZW50LCBpbmRleCwgYWJpbGl0eU1vZGVsLCBhYmlsaXR5KSB7XG4gICAgICAgICAgICAgICAgcmV0dXJuIGFiaWxpdHlNb2RlbC5nZXRBYmlsaXR5UHJvcGVydHlWYWx1ZShhYmlsaXR5LCAnZGFtYWdlJykqdjtcbiAgICAgICAgICAgIH1cbiAgICAgICAgfVxuICAgIF0sXG4gICAgJ3NhbmRraW5nX2VwaWNlbnRlcic6IFtcbiAgICAgICAge1xuICAgICAgICAgICAgbGFiZWw6ICdQdWxzZXMnLFxuICAgICAgICAgICAgY29udHJvbFR5cGU6ICdpbnB1dCdcbiAgICAgICAgfSxcbiAgICAgICAge1xuICAgICAgICAgICAgYXR0cmlidXRlTmFtZTogJ2VwaWNlbnRlcl9kYW1hZ2UnLFxuICAgICAgICAgICAgbGFiZWw6ICdEQU1BR0U6JyxcbiAgICAgICAgICAgIGlnbm9yZVRvb2x0aXA6IHRydWUsXG4gICAgICAgICAgICBjb250cm9sVHlwZTogJ3RleHQnLFxuICAgICAgICAgICAgZm46IGZ1bmN0aW9uICh2LCBhLCBwYXJlbnQsIGluZGV4LCBhYmlsaXR5TW9kZWwsIGFiaWxpdHkpIHtcbiAgICAgICAgICAgICAgICByZXR1cm4gdiphO1xuICAgICAgICAgICAgfVxuICAgICAgICB9LFxuICAgICAgICB7XG4gICAgICAgICAgICBhdHRyaWJ1dGVOYW1lOiAnZXBpY2VudGVyX3Nsb3cnLFxuICAgICAgICAgICAgbGFiZWw6ICdUb3RhbCBEYW1hZ2UnLFxuICAgICAgICAgICAgY29udHJvbFR5cGU6ICd0ZXh0JyxcbiAgICAgICAgICAgIGZuOiBmdW5jdGlvbiAodiwgYSwgcGFyZW50LCBpbmRleCwgYWJpbGl0eU1vZGVsLCBhYmlsaXR5KSB7XG4gICAgICAgICAgICAgICAgcmV0dXJuIGE7XG4gICAgICAgICAgICB9LFxuICAgICAgICAgICAgcmV0dXJuUHJvcGVydHk6ICdtb3ZlbWVudFNwZWVkUGN0UmVkdWN0aW9uJ1xuICAgICAgICB9LFxuICAgICAgICB7XG4gICAgICAgICAgICBhdHRyaWJ1dGVOYW1lOiAnZXBpY2VudGVyX3Nsb3dfYXMnLFxuICAgICAgICAgICAgbGFiZWw6ICclQVRUQUNLIFNMT1c6JyxcbiAgICAgICAgICAgIGlnbm9yZVRvb2x0aXA6IHRydWUsXG4gICAgICAgICAgICBjb250cm9sVHlwZTogJ3RleHQnLFxuICAgICAgICAgICAgZm46IGZ1bmN0aW9uICh2LCBhLCBwYXJlbnQsIGluZGV4LCBhYmlsaXR5TW9kZWwsIGFiaWxpdHkpIHtcbiAgICAgICAgICAgICAgICByZXR1cm4gYTtcbiAgICAgICAgICAgIH0sXG4gICAgICAgICAgICByZXR1cm5Qcm9wZXJ0eTogJ2F0dGFja3NwZWVkcmVkdWN0aW9uJ1xuICAgICAgICB9XG4gICAgXSxcbiAgICAnc2hhZG93X2RlbW9uX3NoYWRvd19wb2lzb24nOiBbXG4gICAgICAgIHtcbiAgICAgICAgICAgIGxhYmVsOiAnRHVyYXRpb24nLFxuICAgICAgICAgICAgY29udHJvbFR5cGU6ICdpbnB1dCdcbiAgICAgICAgfSxcbiAgICAgICAge1xuICAgICAgICAgICAgYXR0cmlidXRlTmFtZTogJ3N0YWNrX2RhbWFnZScsXG4gICAgICAgICAgICBsYWJlbDogJ1RvdGFsIERhbWFnZScsXG4gICAgICAgICAgICBjb250cm9sVHlwZTogJ3RleHQnLFxuICAgICAgICAgICAgZm46IGZ1bmN0aW9uICh2LCBhLCBwYXJlbnQsIGluZGV4LCBhYmlsaXR5TW9kZWwsIGFiaWxpdHkpIHtcbiAgICAgICAgICAgICAgICB2YXIgc3RhY2ttdWx0ID0gWzEsMiw0LDhdO1xuICAgICAgICAgICAgICAgIGlmICh2ID4gNCkge1xuICAgICAgICAgICAgICAgICAgICByZXR1cm4gYSAqIHN0YWNrbXVsdFszXSArIDUwICogKHYgLSA0KTtcbiAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgICAgZWxzZSBpZiAodiA8PSAwKSB7XG4gICAgICAgICAgICAgICAgICAgIHJldHVybiAwXG4gICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICAgIGVsc2Uge1xuICAgICAgICAgICAgICAgICAgICByZXR1cm4gYSAqIHN0YWNrbXVsdFt2LTFdXG4gICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgfVxuICAgICAgICB9XG4gICAgXSxcbiAgICAnbmV2ZXJtb3JlX25lY3JvbWFzdGVyeSc6IFtcbiAgICAgICAge1xuICAgICAgICAgICAgbGFiZWw6ICdTb3VscycsXG4gICAgICAgICAgICBjb250cm9sVHlwZTogJ2lucHV0J1xuICAgICAgICB9LFxuICAgICAgICB7XG4gICAgICAgICAgICBhdHRyaWJ1dGVOYW1lOiAnbmVjcm9tYXN0ZXJ5X2RhbWFnZV9wZXJfc291bCcsXG4gICAgICAgICAgICBsYWJlbDogJ0RBTUFHRTonLFxuICAgICAgICAgICAgaWdub3JlVG9vbHRpcDogdHJ1ZSxcbiAgICAgICAgICAgIGNvbnRyb2xUeXBlOiAndGV4dCcsXG4gICAgICAgICAgICBmbjogZnVuY3Rpb24gKHYsIGEsIHBhcmVudCwgaW5kZXgsIGFiaWxpdHlNb2RlbCwgYWJpbGl0eSkge1xuICAgICAgICAgICAgICAgIHJldHVybiB2KmE7XG4gICAgICAgICAgICB9LFxuICAgICAgICAgICAgcmV0dXJuUHJvcGVydHk6ICdib251c0RhbWFnZSdcbiAgICAgICAgfVxuICAgIF0sXG4gICAgJ25ldmVybW9yZV9yZXF1aWVtJzogW1xuICAgICAgICB7XG4gICAgICAgICAgICBsYWJlbDogJ0xpbmUgSGl0IENvdW50JyxcbiAgICAgICAgICAgIGNvbnRyb2xUeXBlOiAnaW5wdXQnXG4gICAgICAgIH0sXG4gICAgICAgIHtcbiAgICAgICAgICAgIGF0dHJpYnV0ZU5hbWU6ICdyZXF1aWVtX3JlZHVjdGlvbl9kYW1hZ2UnLFxuICAgICAgICAgICAgbGFiZWw6ICdEYW1hZ2U6JyxcbiAgICAgICAgICAgIGlnbm9yZVRvb2x0aXA6IHRydWUsXG4gICAgICAgICAgICBjb250cm9sVHlwZTogJ3RleHQnLFxuICAgICAgICAgICAgZm46IGZ1bmN0aW9uICh2LCBhLCBwYXJlbnQsIGluZGV4LCBhYmlsaXR5TW9kZWwsIGFiaWxpdHkpIHtcbiAgICAgICAgICAgICAgICByZXR1cm4gYWJpbGl0eU1vZGVsLmdldEFiaWxpdHlQcm9wZXJ0eVZhbHVlKGFiaWxpdHksICdkYW1hZ2UnKSp2O1xuICAgICAgICAgICAgfVxuICAgICAgICB9LFxuICAgICAgICB7XG4gICAgICAgICAgICBsYWJlbDogJ1JldHVybiBMaW5lIEhpdCBDb3VudCAoU2NlcHRlciknLFxuICAgICAgICAgICAgY29udHJvbFR5cGU6ICdpbnB1dCdcbiAgICAgICAgfSxcbiAgICAgICAge1xuICAgICAgICAgICAgYXR0cmlidXRlTmFtZTogJ3JlcXVpZW1fZGFtYWdlX3BjdF9zY2VwdGVyJyxcbiAgICAgICAgICAgIGxhYmVsOiAnRGFtYWdlL0hlYWw6JyxcbiAgICAgICAgICAgIGlnbm9yZVRvb2x0aXA6IHRydWUsXG4gICAgICAgICAgICBjb250cm9sVHlwZTogJ3RleHQnLFxuICAgICAgICAgICAgZm46IGZ1bmN0aW9uICh2LCBhLCBwYXJlbnQsIGluZGV4LCBhYmlsaXR5TW9kZWwsIGFiaWxpdHkpIHtcbiAgICAgICAgICAgICAgICByZXR1cm4gYWJpbGl0eU1vZGVsLmdldEFiaWxpdHlQcm9wZXJ0eVZhbHVlKGFiaWxpdHksICdkYW1hZ2UnKSp2KmEvMTAwO1xuICAgICAgICAgICAgfVxuICAgICAgICB9LFxuICAgICAgICB7XG4gICAgICAgICAgICBhdHRyaWJ1dGVOYW1lOiAncmVxdWllbV9kYW1hZ2VfcGN0X3NjZXB0ZXInLFxuICAgICAgICAgICAgbGFiZWw6ICdUb3RhbCBEYW1hZ2U6JyxcbiAgICAgICAgICAgIGlnbm9yZVRvb2x0aXA6IHRydWUsXG4gICAgICAgICAgICBjb250cm9sVHlwZTogJ3RleHQnLFxuICAgICAgICAgICAgY29udHJvbHM6IFswLDFdLFxuICAgICAgICAgICAgZm46IGZ1bmN0aW9uICh2LCBhLCBwYXJlbnQsIGluZGV4LCBhYmlsaXR5TW9kZWwsIGFiaWxpdHkpIHtcbiAgICAgICAgICAgICAgICB2YXIgZGFtYWdlID0gYWJpbGl0eU1vZGVsLmdldEFiaWxpdHlQcm9wZXJ0eVZhbHVlKGFiaWxpdHksICdkYW1hZ2UnKTtcbiAgICAgICAgICAgICAgICByZXR1cm4gZGFtYWdlKnZbMF0gKyBkYW1hZ2UqdlsxXSphLzEwMDtcbiAgICAgICAgICAgIH1cbiAgICAgICAgfSxcbiAgICAgICAge1xuICAgICAgICAgICAgYXR0cmlidXRlTmFtZTogJ3JlcXVpZW1fcmVkdWN0aW9uX2RhbWFnZScsXG4gICAgICAgICAgICBsYWJlbDogJyVEQU1BR0UgUkVEVUNUSU9OOicsXG4gICAgICAgICAgICBpZ25vcmVUb29sdGlwOiB0cnVlLFxuICAgICAgICAgICAgY29udHJvbFR5cGU6ICd0ZXh0JyxcbiAgICAgICAgICAgIGZuOiBmdW5jdGlvbiAodiwgYSwgcGFyZW50LCBpbmRleCwgYWJpbGl0eU1vZGVsLCBhYmlsaXR5KSB7XG4gICAgICAgICAgICAgICAgcmV0dXJuIGE7XG4gICAgICAgICAgICB9LFxuICAgICAgICAgICAgcmV0dXJuUHJvcGVydHk6ICdiYXNlRGFtYWdlUmVkdWN0aW9uUGN0J1xuICAgICAgICB9LFxuICAgICAgICB7XG4gICAgICAgICAgICBhdHRyaWJ1dGVOYW1lOiAncmVxdWllbV9yZWR1Y3Rpb25fbXMnLFxuICAgICAgICAgICAgbGFiZWw6ICclREFNQUdFIFJFRFVDVElPTjonLFxuICAgICAgICAgICAgY29udHJvbFR5cGU6ICd0ZXh0JyxcbiAgICAgICAgICAgIGZuOiBmdW5jdGlvbiAodiwgYSwgcGFyZW50LCBpbmRleCwgYWJpbGl0eU1vZGVsLCBhYmlsaXR5KSB7XG4gICAgICAgICAgICAgICAgcmV0dXJuIGE7XG4gICAgICAgICAgICB9LFxuICAgICAgICAgICAgcmV0dXJuUHJvcGVydHk6ICdtb3ZlbWVudFNwZWVkUGN0UmVkdWN0aW9uJ1xuICAgICAgICB9XG4gICAgXSxcbiAgICAnc2hhZG93X3NoYW1hbl9zaGFja2xlcyc6IFtcbiAgICAgICAge1xuICAgICAgICAgICAgbGFiZWw6ICdEdXJhdGlvbicsXG4gICAgICAgICAgICBjb250cm9sVHlwZTogJ2lucHV0J1xuICAgICAgICB9LFxuICAgICAgICB7XG4gICAgICAgICAgICBsYWJlbDogJ0RBTUFHRTonLFxuICAgICAgICAgICAgY29udHJvbFR5cGU6ICd0ZXh0JyxcbiAgICAgICAgICAgIGZuOiBmdW5jdGlvbiAodiwgYSwgcGFyZW50LCBpbmRleCwgYWJpbGl0eU1vZGVsLCBhYmlsaXR5KSB7XG4gICAgICAgICAgICAgICAgcmV0dXJuIGFiaWxpdHlNb2RlbC5nZXRBYmlsaXR5UHJvcGVydHlWYWx1ZShhYmlsaXR5LCAnZGFtYWdlJykqdjtcbiAgICAgICAgICAgIH1cbiAgICAgICAgfVxuICAgIF0sXG4gICAgJ3NpbGVuY2VyX2N1cnNlX29mX3RoZV9zaWxlbnQnOiBbXG4gICAgICAgIHtcbiAgICAgICAgICAgIGxhYmVsOiAnRHVyYXRpb24nLFxuICAgICAgICAgICAgY29udHJvbFR5cGU6ICdpbnB1dCdcbiAgICAgICAgfSxcbiAgICAgICAge1xuICAgICAgICAgICAgYXR0cmlidXRlTmFtZTogJ2RhbWFnZScsXG4gICAgICAgICAgICBsYWJlbDogJ1RvdGFsIERhbWFnZScsXG4gICAgICAgICAgICBjb250cm9sVHlwZTogJ3RleHQnLFxuICAgICAgICAgICAgZm46IGZ1bmN0aW9uICh2LCBhLCBwYXJlbnQsIGluZGV4LCBhYmlsaXR5TW9kZWwsIGFiaWxpdHkpIHtcbiAgICAgICAgICAgICAgICByZXR1cm4gTWF0aC5mbG9vcih2KSphO1xuICAgICAgICAgICAgfVxuICAgICAgICB9LFxuICAgICAgICB7XG4gICAgICAgICAgICBhdHRyaWJ1dGVOYW1lOiAnbW92ZXNwZWVkJyxcbiAgICAgICAgICAgIGxhYmVsOiAnVG90YWwgRGFtYWdlJyxcbiAgICAgICAgICAgIGNvbnRyb2xUeXBlOiAndGV4dCcsXG4gICAgICAgICAgICBmbjogZnVuY3Rpb24gKHYsIGEsIHBhcmVudCwgaW5kZXgsIGFiaWxpdHlNb2RlbCwgYWJpbGl0eSkge1xuICAgICAgICAgICAgICAgIHJldHVybiBhO1xuICAgICAgICAgICAgfSxcbiAgICAgICAgICAgIHJldHVyblByb3BlcnR5OiAnbW92ZW1lbnRTcGVlZFBjdFJlZHVjdGlvbidcbiAgICAgICAgfVxuICAgIF0sXG4vKiAgICAgICAgJ3NpbGVuY2VyX2dsYWl2ZXNfb2Zfd2lzZG9tJzogW1xuICAgICAgICB7XG4gICAgICAgICAgICBsYWJlbDogJ0R1cmF0aW9uJyxcbiAgICAgICAgICAgIGNvbnRyb2xUeXBlOiAnaW5wdXQnXG4gICAgICAgIH0sXG4gICAgICAgIHtcbiAgICAgICAgICAgIGF0dHJpYnV0ZU5hbWU6ICdkYW1hZ2UnLFxuICAgICAgICAgICAgbGFiZWw6ICdUb3RhbCBEYW1hZ2UnLFxuICAgICAgICAgICAgY29udHJvbFR5cGU6ICd0ZXh0JyxcbiAgICAgICAgICAgIGZuOiBmdW5jdGlvbiAodiwgYSwgcGFyZW50LCBpbmRleCwgYWJpbGl0eU1vZGVsLCBhYmlsaXR5KSB7XG4gICAgICAgICAgICAgICAgcmV0dXJuIHYqYTtcbiAgICAgICAgICAgIH1cbiAgICAgICAgfVxuICAgIF0sKi9cbiAgICAnc2t5d3JhdGhfbWFnZV9teXN0aWNfZmxhcmUnOiBbXG4gICAgICAgIHtcbiAgICAgICAgICAgIGxhYmVsOiAnRHVyYXRpb24nLFxuICAgICAgICAgICAgY29udHJvbFR5cGU6ICdpbnB1dCdcbiAgICAgICAgfSxcbiAgICAgICAge1xuICAgICAgICAgICAgYXR0cmlidXRlTmFtZTogJ2RhbWFnZScsXG4gICAgICAgICAgICBsYWJlbDogJ1RvdGFsIERhbWFnZScsXG4gICAgICAgICAgICBjb250cm9sVHlwZTogJ3RleHQnLFxuICAgICAgICAgICAgZm46IGZ1bmN0aW9uICh2LCBhLCBwYXJlbnQsIGluZGV4LCBhYmlsaXR5TW9kZWwsIGFiaWxpdHkpIHtcbiAgICAgICAgICAgICAgICByZXR1cm4gdiphO1xuICAgICAgICAgICAgfVxuICAgICAgICB9XG4gICAgXSxcbiAgICAnc2xhcmtfZXNzZW5jZV9zaGlmdCc6IFtcbiAgICAgICAge1xuICAgICAgICAgICAgbGFiZWw6ICdBdHRhY2tzJyxcbiAgICAgICAgICAgIGNvbnRyb2xUeXBlOiAnaW5wdXQnXG4gICAgICAgIH0sXG4gICAgICAgIHtcbiAgICAgICAgICAgIGF0dHJpYnV0ZU5hbWU6ICdhZ2lfZ2FpbicsXG4gICAgICAgICAgICBsYWJlbDogJ1RvdGFsIERhbWFnZScsXG4gICAgICAgICAgICBjb250cm9sVHlwZTogJ3RleHQnLFxuICAgICAgICAgICAgZGlzcGxheTogJ2FiaWxpdHknLFxuICAgICAgICAgICAgZm46IGZ1bmN0aW9uICh2LCBhLCBwYXJlbnQsIGluZGV4LCBhYmlsaXR5TW9kZWwsIGFiaWxpdHkpIHtcbiAgICAgICAgICAgICAgICByZXR1cm4gdiphO1xuICAgICAgICAgICAgfSxcbiAgICAgICAgICAgIHJldHVyblByb3BlcnR5OiAnYm9udXNBZ2lsaXR5J1xuICAgICAgICB9LFxuICAgICAgICB7XG4gICAgICAgICAgICBhdHRyaWJ1dGVOYW1lOiAnc3RhdF9sb3NzJyxcbiAgICAgICAgICAgIGxhYmVsOiAnVG90YWwgRGFtYWdlJyxcbiAgICAgICAgICAgIGNvbnRyb2xUeXBlOiAndGV4dCcsXG4gICAgICAgICAgICBmbjogZnVuY3Rpb24gKHYsIGEsIHBhcmVudCwgaW5kZXgsIGFiaWxpdHlNb2RlbCwgYWJpbGl0eSkge1xuICAgICAgICAgICAgICAgIHJldHVybiAtdiphO1xuICAgICAgICAgICAgfSxcbiAgICAgICAgICAgIHJldHVyblByb3BlcnR5OiAnYm9udXNBbGxTdGF0c1JlZHVjdGlvbidcbiAgICAgICAgfVxuICAgIF0sXG4gICAgJ3NsYXJrX3NoYWRvd19kYW5jZSc6IFtcbiAgICAgICAge1xuICAgICAgICAgICAgbGFiZWw6ICdEdXJhdGlvbicsXG4gICAgICAgICAgICBjb250cm9sVHlwZTogJ2lucHV0J1xuICAgICAgICB9LFxuICAgICAgICB7XG4gICAgICAgICAgICBhdHRyaWJ1dGVOYW1lOiAnYm9udXNfcmVnZW5fcGN0JyxcbiAgICAgICAgICAgIGxhYmVsOiAnVE9UQUwgSEVBTFRIIFJFR0VORVJBVEVEOicsXG4gICAgICAgICAgICBpZ25vcmVUb29sdGlwOiB0cnVlLFxuICAgICAgICAgICAgY29udHJvbFR5cGU6ICd0ZXh0JyxcbiAgICAgICAgICAgIGZuOiBmdW5jdGlvbiAodiwgYSwgcGFyZW50LCBpbmRleCwgYWJpbGl0eU1vZGVsLCBhYmlsaXR5KSB7XG4gICAgICAgICAgICAgICAgcmV0dXJuIHYqcGFyZW50LmhlYWx0aCgpKmEvMTAwO1xuICAgICAgICAgICAgfVxuICAgICAgICB9LFxuICAgICAgICB7XG4gICAgICAgICAgICBhdHRyaWJ1dGVOYW1lOiAnYm9udXNfcmVnZW5fcGN0JyxcbiAgICAgICAgICAgIGxhYmVsOiAnSEVBTFRIIEdBSU5FRCBQRVIgU0VDT05EOicsXG4gICAgICAgICAgICBpZ25vcmVUb29sdGlwOiB0cnVlLFxuICAgICAgICAgICAgY29udHJvbFR5cGU6ICd0ZXh0JyxcbiAgICAgICAgICAgIGZuOiBmdW5jdGlvbiAodiwgYSwgcGFyZW50LCBpbmRleCwgYWJpbGl0eU1vZGVsLCBhYmlsaXR5KSB7XG4gICAgICAgICAgICAgICAgcmV0dXJuIHBhcmVudC5oZWFsdGgoKSphLzEwMDtcbiAgICAgICAgICAgIH0sXG4gICAgICAgICAgICByZXR1cm5Qcm9wZXJ0eTogJ2hlYWx0aHJlZ2VuJ1xuICAgICAgICB9LFxuICAgICAgICB7XG4gICAgICAgICAgICBhdHRyaWJ1dGVOYW1lOiAnYm9udXNfbW92ZW1lbnRfc3BlZWQnLFxuICAgICAgICAgICAgbGFiZWw6ICclTU9WRSBTUEVFRDonLFxuICAgICAgICAgICAgaWdub3JlVG9vbHRpcDogdHJ1ZSxcbiAgICAgICAgICAgIGNvbnRyb2xUeXBlOiAndGV4dCcsXG4gICAgICAgICAgICBmbjogZnVuY3Rpb24gKHYsIGEsIHBhcmVudCwgaW5kZXgsIGFiaWxpdHlNb2RlbCwgYWJpbGl0eSkge1xuICAgICAgICAgICAgICAgIHJldHVybiBhO1xuICAgICAgICAgICAgfSxcbiAgICAgICAgICAgIHJldHVyblByb3BlcnR5OiAnbW92ZW1lbnRTcGVlZFBjdCdcbiAgICAgICAgfVxuICAgIF0sXG4gICAgJ3NuaXBlcl9zaHJhcG5lbCc6IFtcbiAgICAgICAge1xuICAgICAgICAgICAgbGFiZWw6ICdEdXJhdGlvbicsXG4gICAgICAgICAgICBjb250cm9sVHlwZTogJ2lucHV0J1xuICAgICAgICB9LFxuICAgICAgICB7XG4gICAgICAgICAgICBsYWJlbDogJ0RBTUFHRTonLFxuICAgICAgICAgICAgaWdub3JlVG9vbHRpcDogdHJ1ZSxcbiAgICAgICAgICAgIGNvbnRyb2xUeXBlOiAndGV4dCcsXG4gICAgICAgICAgICBmbjogZnVuY3Rpb24gKHYsIGEsIHBhcmVudCwgaW5kZXgsIGFiaWxpdHlNb2RlbCwgYWJpbGl0eSkge1xuICAgICAgICAgICAgICAgIHJldHVybiBhYmlsaXR5TW9kZWwuZ2V0QWJpbGl0eVByb3BlcnR5VmFsdWUoYWJpbGl0eSwgJ2RhbWFnZScpKnY7XG4gICAgICAgICAgICB9XG4gICAgICAgIH0sXG4gICAgICAgIHtcbiAgICAgICAgICAgIGF0dHJpYnV0ZU5hbWU6ICdidWlsZGluZ19kYW1hZ2UnLFxuICAgICAgICAgICAgbGFiZWw6ICdCVUlMRElORyBEQU1BR0U6JyxcbiAgICAgICAgICAgIGlnbm9yZVRvb2x0aXA6IHRydWUsXG4gICAgICAgICAgICBjb250cm9sVHlwZTogJ3RleHQnLFxuICAgICAgICAgICAgZm46IGZ1bmN0aW9uICh2LCBhLCBwYXJlbnQsIGluZGV4LCBhYmlsaXR5TW9kZWwsIGFiaWxpdHkpIHtcbiAgICAgICAgICAgICAgICByZXR1cm4gdiphO1xuICAgICAgICAgICAgfVxuICAgICAgICB9LFxuICAgICAgICB7XG4gICAgICAgICAgICBhdHRyaWJ1dGVOYW1lOiAnc2xvd19tb3ZlbWVudF9zcGVlZCcsXG4gICAgICAgICAgICBsYWJlbDogJ0VuZW15IE1vdmVtZW50IFNwZWVkIFNsb3cnLFxuICAgICAgICAgICAgY29udHJvbFR5cGU6ICd0ZXh0JyxcbiAgICAgICAgICAgIGZuOiBmdW5jdGlvbiAodiwgYSwgcGFyZW50LCBpbmRleCwgYWJpbGl0eU1vZGVsLCBhYmlsaXR5KSB7XG4gICAgICAgICAgICAgICAgcmV0dXJuIGE7XG4gICAgICAgICAgICB9LFxuICAgICAgICAgICAgcmV0dXJuUHJvcGVydHk6ICdtb3ZlbWVudFNwZWVkUGN0UmVkdWN0aW9uJ1xuICAgICAgICB9XG4gICAgXSxcbiAgICAnc3BlY3RyZV9kZXNvbGF0ZSc6IFtcbiAgICAgICAge1xuICAgICAgICAgICAgbGFiZWw6ICdFbmVteSBBbG9uZScsXG4gICAgICAgICAgICBjb250cm9sVHlwZTogJ2NoZWNrYm94J1xuICAgICAgICB9LFxuICAgICAgICB7XG4gICAgICAgICAgICBhdHRyaWJ1dGVOYW1lOiAnYm9udXNfZGFtYWdlJyxcbiAgICAgICAgICAgIGxhYmVsOiAnVG90YWwgRGFtYWdlJyxcbiAgICAgICAgICAgIGNvbnRyb2xUeXBlOiAndGV4dCcsXG4gICAgICAgICAgICBmbjogZnVuY3Rpb24gKHYsIGEsIHBhcmVudCwgaW5kZXgsIGFiaWxpdHlNb2RlbCwgYWJpbGl0eSkge1xuICAgICAgICAgICAgICAgIGlmICh2KSB7XG4gICAgICAgICAgICAgICAgICAgIHJldHVybiBhO1xuICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgICBlbHNlIHtcbiAgICAgICAgICAgICAgICAgICAgcmV0dXJuIDA7XG4gICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgfSxcbiAgICAgICAgICAgIHJldHVyblByb3BlcnR5OiAnYm9udXNEYW1hZ2UnXG4gICAgICAgIH1cbiAgICBdLFxuICAgICdzcGVjdHJlX2Rpc3BlcnNpb24nOiBbXG4gICAgICAgIHtcbiAgICAgICAgICAgIGxhYmVsOiAnRGFtYWdlIFRha2VuJyxcbiAgICAgICAgICAgIGNvbnRyb2xUeXBlOiAnaW5wdXQnXG4gICAgICAgIH0sXG4gICAgICAgIHtcbiAgICAgICAgICAgIGF0dHJpYnV0ZU5hbWU6ICdkYW1hZ2VfcmVmbGVjdGlvbl9wY3QnLFxuICAgICAgICAgICAgbGFiZWw6ICdEQU1BR0UgUkVGTEVDVEVEOicsXG4gICAgICAgICAgICBjb250cm9sVHlwZTogJ3RleHQnLFxuICAgICAgICAgICAgZm46IGZ1bmN0aW9uICh2LCBhLCBwYXJlbnQsIGluZGV4LCBhYmlsaXR5TW9kZWwsIGFiaWxpdHkpIHtcbiAgICAgICAgICAgICAgICByZXR1cm4gLWE7XG4gICAgICAgICAgICB9LFxuICAgICAgICAgICAgcmV0dXJuUHJvcGVydHk6ICdkYW1hZ2VSZWR1Y3Rpb24nXG4gICAgICAgIH0sXG4gICAgICAgIHtcbiAgICAgICAgICAgIGF0dHJpYnV0ZU5hbWU6ICdkYW1hZ2VfcmVmbGVjdGlvbl9wY3QnLFxuICAgICAgICAgICAgbGFiZWw6ICdEQU1BR0UgUkVGTEVDVEVEOicsXG4gICAgICAgICAgICBpZ25vcmVUb29sdGlwOiB0cnVlLFxuICAgICAgICAgICAgY29udHJvbFR5cGU6ICd0ZXh0JyxcbiAgICAgICAgICAgIGZuOiBmdW5jdGlvbiAodiwgYSwgcGFyZW50LCBpbmRleCwgYWJpbGl0eU1vZGVsLCBhYmlsaXR5KSB7XG4gICAgICAgICAgICAgICAgcmV0dXJuIHYqYS8xMDA7XG4gICAgICAgICAgICB9XG4gICAgICAgIH1cbiAgICBdLFxuICAgICdzdG9ybV9zcGlyaXRfYmFsbF9saWdodG5pbmcnOiBbXG4gICAgICAgIHtcbiAgICAgICAgICAgIGxhYmVsOiAnTUFYIE1BTkEnLFxuICAgICAgICAgICAgY29udHJvbFR5cGU6ICdpbnB1dCdcbiAgICAgICAgfSxcbiAgICAgICAge1xuICAgICAgICAgICAgbGFiZWw6ICdEaXN0YW5jZScsXG4gICAgICAgICAgICBjb250cm9sVHlwZTogJ2lucHV0J1xuICAgICAgICB9LFxuICAgICAgICB7XG4gICAgICAgICAgICBhdHRyaWJ1dGVOYW1lOiAnYmFsbF9saWdodG5pbmdfaW5pdGlhbF9tYW5hX2Jhc2UnLFxuICAgICAgICAgICAgbGFiZWw6ICdUb3RhbCBEYW1hZ2U6JyxcbiAgICAgICAgICAgIGlnbm9yZVRvb2x0aXA6IHRydWUsXG4gICAgICAgICAgICBjb250cm9sVHlwZTogJ3RleHQnLFxuICAgICAgICAgICAgY29udHJvbHM6IFswLCAxXSxcbiAgICAgICAgICAgIGZuOiBmdW5jdGlvbiAodiwgYSwgcGFyZW50LCBpbmRleCwgYWJpbGl0eU1vZGVsLCBhYmlsaXR5KSB7XG4gICAgICAgICAgICAgICAgcmV0dXJuIGFiaWxpdHlNb2RlbC5nZXRBYmlsaXR5UHJvcGVydHlWYWx1ZShhYmlsaXR5LCAnZGFtYWdlJykvMTAwKnZbMV07XG4gICAgICAgICAgICB9XG4gICAgICAgIH0sXG4gICAgICAgIHtcbiAgICAgICAgICAgIGF0dHJpYnV0ZU5hbWU6ICdiYWxsX2xpZ2h0bmluZ19pbml0aWFsX21hbmFfYmFzZScsXG4gICAgICAgICAgICBsYWJlbDogJ0ZMQVQgTUFOQSBDT1NUOicsXG4gICAgICAgICAgICBpZ25vcmVUb29sdGlwOiB0cnVlLFxuICAgICAgICAgICAgY29udHJvbFR5cGU6ICdtZXRob2QnLFxuICAgICAgICAgICAgY29udHJvbHM6IFswLCAxXSxcbiAgICAgICAgICAgIGZuOiBmdW5jdGlvbiAodiwgYSwgcGFyZW50LCBpbmRleCwgYWJpbGl0eU1vZGVsLCBhYmlsaXR5KSB7XG4gICAgICAgICAgICAgICAgdmFyIGRpc3RhbmNlX2ludGVydmFscyA9IE1hdGguZmxvb3IodlsxXS8xMDApO1xuICAgICAgICAgICAgICAgIHZhciB0cmF2ZWxfY29zdF9iYXNlID0gYWJpbGl0eU1vZGVsLmdldEFiaWxpdHlBdHRyaWJ1dGVWYWx1ZShhYmlsaXR5LmF0dHJpYnV0ZXMsICdiYWxsX2xpZ2h0bmluZ190cmF2ZWxfY29zdF9iYXNlJywwKTtcbiAgICAgICAgICAgICAgICByZXR1cm4gYSArIGRpc3RhbmNlX2ludGVydmFscyAqIHRyYXZlbF9jb3N0X2Jhc2U7XG4gICAgICAgICAgICB9XG4gICAgICAgIH0sXG4gICAgICAgIHtcbiAgICAgICAgICAgIGF0dHJpYnV0ZU5hbWU6ICdiYWxsX2xpZ2h0bmluZ19pbml0aWFsX21hbmFfcGVyY2VudGFnZScsXG4gICAgICAgICAgICBsYWJlbDogJyVNQVggTUFOQSBDT1NUOicsXG4gICAgICAgICAgICBpZ25vcmVUb29sdGlwOiB0cnVlLFxuICAgICAgICAgICAgY29udHJvbFR5cGU6ICdtZXRob2QnLFxuICAgICAgICAgICAgY29udHJvbHM6IFswLCAxXSxcbiAgICAgICAgICAgIGZuOiBmdW5jdGlvbiAodiwgYSwgcGFyZW50LCBpbmRleCwgYWJpbGl0eU1vZGVsLCBhYmlsaXR5KSB7XG4gICAgICAgICAgICAgICAgdmFyIGRpc3RhbmNlX2ludGVydmFscyA9IE1hdGguZmxvb3IodlsxXS8xMDApO1xuICAgICAgICAgICAgICAgIHZhciB0cmF2ZWxfY29zdF9wZXJjZW50ID0gYWJpbGl0eU1vZGVsLmdldEFiaWxpdHlBdHRyaWJ1dGVWYWx1ZShhYmlsaXR5LmF0dHJpYnV0ZXMsICdiYWxsX2xpZ2h0bmluZ190cmF2ZWxfY29zdF9wZXJjZW50JywwKTtcbiAgICAgICAgICAgICAgICByZXR1cm4gYSArIGRpc3RhbmNlX2ludGVydmFscyAqIHRyYXZlbF9jb3N0X3BlcmNlbnQ7XG4gICAgICAgICAgICB9XG4gICAgICAgIH0sXG4gICAgICAgIHtcbiAgICAgICAgICAgIGF0dHJpYnV0ZU5hbWU6ICdiYWxsX2xpZ2h0bmluZ19pbml0aWFsX21hbmFfYmFzZScsXG4gICAgICAgICAgICBsYWJlbDogJ1RPVEFMIE1BTkEgQ09TVDonLFxuICAgICAgICAgICAgaWdub3JlVG9vbHRpcDogdHJ1ZSxcbiAgICAgICAgICAgIGNvbnRyb2xUeXBlOiAndGV4dCcsXG4gICAgICAgICAgICBjb250cm9sczogWzAsIDEsIDIsIDNdLFxuICAgICAgICAgICAgZm46IGZ1bmN0aW9uICh2LCBhLCBwYXJlbnQsIGluZGV4LCBhYmlsaXR5TW9kZWwsIGFiaWxpdHkpIHtcbiAgICAgICAgICAgICAgICByZXR1cm4gdlsyXSArICcgKyAnICsgKHZbM10vMTAwICogdlswXSkgKyAnICgnICsgdlszXSArICclIG9mIG1heCkgPSAnICsgKHZbMl0gKyB2WzNdLzEwMCAqIHZbMF0pO1xuICAgICAgICAgICAgfVxuICAgICAgICB9XG4gICAgXSxcbiAgICAndGVtcGxhcl9hc3Nhc3Npbl9wc2lvbmljX3RyYXAnOiBbXG4gICAgICAgIHtcbiAgICAgICAgICAgIGxhYmVsOiAnQ2hhcmdlIFRpbWUnLFxuICAgICAgICAgICAgY29udHJvbFR5cGU6ICdpbnB1dCdcbiAgICAgICAgfSxcbiAgICAgICAge1xuICAgICAgICAgICAgYXR0cmlidXRlTmFtZTogJ21vdmVtZW50X3NwZWVkX21pbl90b29sdGlwJyxcbiAgICAgICAgICAgIGxhYmVsOiAnJU1PVkUgU0xPVzonLFxuICAgICAgICAgICAgaWdub3JlVG9vbHRpcDogdHJ1ZSxcbiAgICAgICAgICAgIGNvbnRyb2xUeXBlOiAndGV4dCcsXG4gICAgICAgICAgICBmbjogZnVuY3Rpb24gKHYsIGEsIHBhcmVudCwgaW5kZXgsIGFiaWxpdHlNb2RlbCwgYWJpbGl0eSkge1xuICAgICAgICAgICAgICAgIHZhciBtYXhfc2xvdyA9IGFiaWxpdHlNb2RlbC5nZXRBYmlsaXR5QXR0cmlidXRlVmFsdWUoYWJpbGl0eS5hdHRyaWJ1dGVzLCAnbW92ZW1lbnRfc3BlZWRfbWF4X3Rvb2x0aXAnLDApO1xuICAgICAgICAgICAgICAgIHZhciBzbG93X3Blcl90aWNrID0gKG1heF9zbG93IC0gYSkvNDA7XG4gICAgICAgICAgICAgICAgcmV0dXJuIC0oYSArIHNsb3dfcGVyX3RpY2sgKiBNYXRoLm1pbihNYXRoLm1heCgwLCB2KSwgNCkgKiAxMCk7XG4gICAgICAgICAgICB9LFxuICAgICAgICAgICAgcmV0dXJuUHJvcGVydHk6ICdtb3ZlbWVudFNwZWVkUGN0UmVkdWN0aW9uJ1xuICAgICAgICB9XG4gICAgXSxcbiAgICAnc2hyZWRkZXJfcmVhY3RpdmVfYXJtb3InOiBbXG4gICAgICAgIHtcbiAgICAgICAgICAgIGxhYmVsOiAnU3RhY2tzJyxcbiAgICAgICAgICAgIGNvbnRyb2xUeXBlOiAnaW5wdXQnXG4gICAgICAgIH0sXG4gICAgICAgIHtcbiAgICAgICAgICAgIGF0dHJpYnV0ZU5hbWU6ICdib251c19hcm1vcicsXG4gICAgICAgICAgICBsYWJlbDogJ1RvdGFsIEFybW9yIEJvbnVzJyxcbiAgICAgICAgICAgIGNvbnRyb2xUeXBlOiAndGV4dCcsXG4gICAgICAgICAgICBub0xldmVsOiB0cnVlLFxuICAgICAgICAgICAgZm46IGZ1bmN0aW9uICh2LCBhLCBwYXJlbnQsIGluZGV4LCBhYmlsaXR5TW9kZWwsIGFiaWxpdHkpIHtcbiAgICAgICAgICAgICAgICByZXR1cm4gdiphO1xuICAgICAgICAgICAgfSxcbiAgICAgICAgICAgIHJldHVyblByb3BlcnR5OiAnYXJtb3InXG4gICAgICAgIH0sXG4gICAgICAgIHtcbiAgICAgICAgICAgIGF0dHJpYnV0ZU5hbWU6ICdib251c19ocF9yZWdlbicsXG4gICAgICAgICAgICBsYWJlbDogJ1RvdGFsIEhQIFJlZ2VuIEJvbnVzJyxcbiAgICAgICAgICAgIGNvbnRyb2xUeXBlOiAndGV4dCcsXG4gICAgICAgICAgICBub0xldmVsOiB0cnVlLFxuICAgICAgICAgICAgZm46IGZ1bmN0aW9uICh2LCBhLCBwYXJlbnQsIGluZGV4LCBhYmlsaXR5TW9kZWwsIGFiaWxpdHkpIHtcbiAgICAgICAgICAgICAgICByZXR1cm4gdiphO1xuICAgICAgICAgICAgfSxcbiAgICAgICAgICAgIHJldHVyblByb3BlcnR5OiAnaGVhbHRocmVnZW4nXG4gICAgICAgIH1cbiAgICBdLFxuICAgICdzaHJlZGRlcl9jaGFrcmFtJzogW1xuICAgICAgICB7XG4gICAgICAgICAgICBsYWJlbDogJ0R1cmF0aW9uJyxcbiAgICAgICAgICAgIGNvbnRyb2xUeXBlOiAnaW5wdXQnXG4gICAgICAgIH0sXG4gICAgICAgIHtcbiAgICAgICAgICAgIGF0dHJpYnV0ZU5hbWU6ICdkYW1hZ2VfcGVyX3NlY29uZCcsXG4gICAgICAgICAgICBsYWJlbDogJ0RBTUFHRTonLFxuICAgICAgICAgICAgaWdub3JlVG9vbHRpcDogdHJ1ZSxcbiAgICAgICAgICAgIGNvbnRyb2xUeXBlOiAndGV4dCcsXG4gICAgICAgICAgICBmbjogZnVuY3Rpb24gKHYsIGEsIHBhcmVudCwgaW5kZXgsIGFiaWxpdHlNb2RlbCwgYWJpbGl0eSkge1xuICAgICAgICAgICAgICAgIHZhciBpbnRlcnZhbCA9IGFiaWxpdHlNb2RlbC5nZXRBYmlsaXR5QXR0cmlidXRlVmFsdWUoYWJpbGl0eS5hdHRyaWJ1dGVzLCAnZGFtYWdlX2ludGVydmFsJywwKTtcbiAgICAgICAgICAgICAgICB2YXIgdGlja3MgPSBNYXRoLmZsb29yKHYgLyBpbnRlcnZhbCk7XG4gICAgICAgICAgICAgICAgcmV0dXJuIGEqaW50ZXJ2YWwqdGlja3M7XG4gICAgICAgICAgICB9XG4gICAgICAgIH0sXG4gICAgICAgIHtcbiAgICAgICAgICAgIGF0dHJpYnV0ZU5hbWU6ICdtYW5hX3Blcl9zZWNvbmQnLFxuICAgICAgICAgICAgbGFiZWw6ICdNQU5BIENPU1Q6JyxcbiAgICAgICAgICAgIGlnbm9yZVRvb2x0aXA6IHRydWUsXG4gICAgICAgICAgICBjb250cm9sVHlwZTogJ3RleHQnLFxuICAgICAgICAgICAgZm46IGZ1bmN0aW9uICh2LCBhLCBwYXJlbnQsIGluZGV4LCBhYmlsaXR5TW9kZWwsIGFiaWxpdHkpIHtcbiAgICAgICAgICAgICAgICB2YXIgaW50ZXJ2YWwgPSBhYmlsaXR5TW9kZWwuZ2V0QWJpbGl0eUF0dHJpYnV0ZVZhbHVlKGFiaWxpdHkuYXR0cmlidXRlcywgJ2RhbWFnZV9pbnRlcnZhbCcsMCk7XG4gICAgICAgICAgICAgICAgdmFyIHRpY2tzID0gTWF0aC5mbG9vcih2IC8gaW50ZXJ2YWwpO1xuICAgICAgICAgICAgICAgIHJldHVybiBhKmludGVydmFsKnRpY2tzO1xuICAgICAgICAgICAgfVxuICAgICAgICB9LFxuICAgICAgICB7XG4gICAgICAgICAgICBsYWJlbDogJ0VORU1ZICVIUCcsXG4gICAgICAgICAgICBjb250cm9sVHlwZTogJ2lucHV0J1xuICAgICAgICB9LFxuICAgICAgICB7XG4gICAgICAgICAgICBhdHRyaWJ1dGVOYW1lOiAnc2xvdycsXG4gICAgICAgICAgICBsYWJlbDogJ01BTkEgQ09TVDonLFxuICAgICAgICAgICAgY29udHJvbFR5cGU6ICd0ZXh0JyxcbiAgICAgICAgICAgIGZuOiBmdW5jdGlvbiAodiwgYSwgcGFyZW50LCBpbmRleCwgYWJpbGl0eU1vZGVsLCBhYmlsaXR5KSB7XG4gICAgICAgICAgICAgICAgdmFyIHRpY2tzID0gMjAgLSBNYXRoLmZsb29yKE1hdGgubWluKE1hdGgubWF4KHYtMSwgMCksIDk5KSAvIDUpO1xuICAgICAgICAgICAgICAgIHJldHVybiAtYSp0aWNrcztcbiAgICAgICAgICAgIH0sXG4gICAgICAgICAgICByZXR1cm5Qcm9wZXJ0eTogJ21vdmVtZW50U3BlZWRQY3RSZWR1Y3Rpb24nXG4gICAgICAgIH1cbiAgICBdLFxuICAgICdzcGlyaXRfYnJlYWtlcl9ncmVhdGVyX2Jhc2gnOiBbXG4gICAgICAgIHtcbiAgICAgICAgICAgIGxhYmVsOiAnQmFzaCBQcm9jJyxcbiAgICAgICAgICAgIGNvbnRyb2xUeXBlOiAnY2hlY2tib3gnXG4gICAgICAgIH0sXG4gICAgICAgIHtcbiAgICAgICAgICAgIGF0dHJpYnV0ZU5hbWU6ICdkYW1hZ2UnLFxuICAgICAgICAgICAgbGFiZWw6ICclTU9WRVNQRUVEIEFTIERBTUFHRScsXG4gICAgICAgICAgICBjb250cm9sVHlwZTogJ3RleHQnLFxuICAgICAgICAgICAgZm46IGZ1bmN0aW9uICh2LCBhLCBwYXJlbnQsIGluZGV4LCBhYmlsaXR5TW9kZWwsIGFiaWxpdHkpIHtcbiAgICAgICAgICAgICAgICBpZiAodikge1xuICAgICAgICAgICAgICAgICAgICByZXR1cm4gYTtcbiAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgICAgZWxzZSB7XG4gICAgICAgICAgICAgICAgICAgIHJldHVybiAwO1xuICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgIH0sXG4gICAgICAgICAgICByZXR1cm5Qcm9wZXJ0eTogJ2Jhc2hCb251c0RhbWFnZSdcbiAgICAgICAgfSxcbiAgICAgICAge1xuICAgICAgICAgICAgYXR0cmlidXRlTmFtZTogJ2JvbnVzX21vdmVzcGVlZF9wY3QnLFxuICAgICAgICAgICAgbGFiZWw6ICdUb3RhbCBEYW1hZ2UnLFxuICAgICAgICAgICAgY29udHJvbFR5cGU6ICd0ZXh0JyxcbiAgICAgICAgICAgIGZuOiBmdW5jdGlvbiAodiwgYSwgcGFyZW50LCBpbmRleCwgYWJpbGl0eU1vZGVsLCBhYmlsaXR5KSB7XG4gICAgICAgICAgICAgICAgaWYgKHYpIHtcbiAgICAgICAgICAgICAgICAgICAgcmV0dXJuIGE7XG4gICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICAgIGVsc2Uge1xuICAgICAgICAgICAgICAgICAgICByZXR1cm4gMDtcbiAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICB9LFxuICAgICAgICAgICAgcmV0dXJuUHJvcGVydHk6ICdtb3ZlbWVudFNwZWVkUGN0J1xuICAgICAgICB9LFxuICAgICAgICB7XG4gICAgICAgICAgICBhdHRyaWJ1dGVOYW1lOiAnY2hhbmNlX3BjdCcsXG4gICAgICAgICAgICBsYWJlbDogJ1RvdGFsIERhbWFnZScsXG4gICAgICAgICAgICBjb250cm9sVHlwZTogJ3RleHQnLFxuICAgICAgICAgICAgZm46IGZ1bmN0aW9uICh2LCBhLCBwYXJlbnQsIGluZGV4LCBhYmlsaXR5TW9kZWwsIGFiaWxpdHkpIHtcbiAgICAgICAgICAgICAgICByZXR1cm4gYVxuICAgICAgICAgICAgfSxcbiAgICAgICAgICAgIHJldHVyblByb3BlcnR5OiAnYmFzaCdcbiAgICAgICAgfVxuICAgIF0sXG4gICAgJ3RlY2hpZXNfbGFuZF9taW5lcyc6IFtcbiAgICAgICAge1xuICAgICAgICAgICAgbGFiZWw6ICdOdW1iZXIgb2YgTWluZXMnLFxuICAgICAgICAgICAgY29udHJvbFR5cGU6ICdpbnB1dCdcbiAgICAgICAgfSxcbiAgICAgICAge1xuICAgICAgICAgICAgYXR0cmlidXRlTmFtZTogJ2RhbWFnZScsXG4gICAgICAgICAgICBsYWJlbDogJ1RvdGFsIERhbWFnZScsXG4gICAgICAgICAgICBjb250cm9sVHlwZTogJ3RleHQnLFxuICAgICAgICAgICAgZm46IGZ1bmN0aW9uICh2LCBhLCBwYXJlbnQsIGluZGV4LCBhYmlsaXR5TW9kZWwsIGFiaWxpdHkpIHtcbiAgICAgICAgICAgICAgICByZXR1cm4gdiphO1xuICAgICAgICAgICAgfVxuICAgICAgICB9LFxuICAgICAgICB7XG4gICAgICAgICAgICBhdHRyaWJ1dGVOYW1lOiAnZGFtYWdlJyxcbiAgICAgICAgICAgIGxhYmVsOiAnQUZURVIgUkVEVUNUSU9OUzonLFxuICAgICAgICAgICAgaWdub3JlVG9vbHRpcDogdHJ1ZSxcbiAgICAgICAgICAgIGNvbnRyb2xUeXBlOiAndGV4dCcsXG4gICAgICAgICAgICBmbjogZnVuY3Rpb24gKHYsIGEsIHBhcmVudCwgaW5kZXgsIGFiaWxpdHlNb2RlbCwgYWJpbGl0eSkge1xuICAgICAgICAgICAgICAgIHZhciBwaHlzX3JlZHVjdGlvbiA9IHBhcmVudC5lbmVteSgpLnRvdGFsQXJtb3JQaHlzaWNhbFJlZHVjdGlvbigpLFxuICAgICAgICAgICAgICAgICAgICBtYWdpY19yZWR1Y3Rpb24gPSBwYXJlbnQuZW5lbXkoKS50b3RhbE1hZ2ljUmVzaXN0YW5jZSgpO1xuICAgICAgICAgICAgICAgIHJldHVybiAodiAqIGEgKiAoMSAtIHBoeXNfcmVkdWN0aW9uIC8gMTAwKSAqICgxIC0gbWFnaWNfcmVkdWN0aW9uIC8gMTAwKSkudG9GaXhlZCgyKTtcbiAgICAgICAgICAgIH1cbiAgICAgICAgfVxuICAgIF0sXG4gICAgJ3RlY2hpZXNfc3VpY2lkZSc6IFtcbiAgICAgICAge1xuICAgICAgICAgICAgYXR0cmlidXRlTmFtZTogJ2RhbWFnZScsXG4gICAgICAgICAgICBsYWJlbDogJ0ZVTEwgREFNQUdFIEFGVEVSIFJFRFVDVElPTlM6JyxcbiAgICAgICAgICAgIGlnbm9yZVRvb2x0aXA6IHRydWUsXG4gICAgICAgICAgICBjb250cm9sVHlwZTogJ3RleHQnLFxuICAgICAgICAgICAgZm46IGZ1bmN0aW9uICh2LCBhLCBwYXJlbnQsIGluZGV4LCBhYmlsaXR5TW9kZWwsIGFiaWxpdHkpIHtcbiAgICAgICAgICAgICAgICB2YXIgcGh5c19yZWR1Y3Rpb24gPSBwYXJlbnQuZW5lbXkoKS50b3RhbEFybW9yUGh5c2ljYWxSZWR1Y3Rpb24oKSxcbiAgICAgICAgICAgICAgICAgICAgbWFnaWNfcmVkdWN0aW9uID0gcGFyZW50LmVuZW15KCkudG90YWxNYWdpY1Jlc2lzdGFuY2UoKTtcbiAgICAgICAgICAgICAgICByZXR1cm4gKGEgKiAoMSAtIHBoeXNfcmVkdWN0aW9uIC8gMTAwKSAqICgxIC0gbWFnaWNfcmVkdWN0aW9uIC8gMTAwKSkudG9GaXhlZCgyKTtcbiAgICAgICAgICAgIH1cbiAgICAgICAgfSxcbiAgICAgICAge1xuICAgICAgICAgICAgYXR0cmlidXRlTmFtZTogJ3BhcnRpYWxfZGFtYWdlJyxcbiAgICAgICAgICAgIGxhYmVsOiAnUEFSVElBTCBEQU1BR0UgQUZURVIgUkVEVUNUSU9OUzonLFxuICAgICAgICAgICAgaWdub3JlVG9vbHRpcDogdHJ1ZSxcbiAgICAgICAgICAgIGNvbnRyb2xUeXBlOiAndGV4dCcsXG4gICAgICAgICAgICBmbjogZnVuY3Rpb24gKHYsIGEsIHBhcmVudCwgaW5kZXgsIGFiaWxpdHlNb2RlbCwgYWJpbGl0eSkge1xuICAgICAgICAgICAgICAgIHZhciBwaHlzX3JlZHVjdGlvbiA9IHBhcmVudC5lbmVteSgpLnRvdGFsQXJtb3JQaHlzaWNhbFJlZHVjdGlvbigpLFxuICAgICAgICAgICAgICAgICAgICBtYWdpY19yZWR1Y3Rpb24gPSBwYXJlbnQuZW5lbXkoKS50b3RhbE1hZ2ljUmVzaXN0YW5jZSgpO1xuICAgICAgICAgICAgICAgIHJldHVybiAoYSAqICgxIC0gcGh5c19yZWR1Y3Rpb24gLyAxMDApICogKDEgLSBtYWdpY19yZWR1Y3Rpb24gLyAxMDApKS50b0ZpeGVkKDIpO1xuICAgICAgICAgICAgfVxuICAgICAgICB9LFxuICAgICAgICB7XG4gICAgICAgICAgICBhdHRyaWJ1dGVOYW1lOiAnZGFtYWdlJyxcbiAgICAgICAgICAgIGxhYmVsOiAnUkVTUEFXTiBUSU1FOicsXG4gICAgICAgICAgICBpZ25vcmVUb29sdGlwOiB0cnVlLFxuICAgICAgICAgICAgY29udHJvbFR5cGU6ICd0ZXh0JyxcbiAgICAgICAgICAgIGZuOiBmdW5jdGlvbiAodiwgYSwgcGFyZW50LCBpbmRleCwgYWJpbGl0eU1vZGVsLCBhYmlsaXR5KSB7XG4gICAgICAgICAgICAgICAgcmV0dXJuIChwYXJlbnQucmVzcGF3blRpbWUoKSAvIDIpLnRvRml4ZWQoMCkgKyAnIHNlY29uZHMnO1xuICAgICAgICAgICAgfVxuICAgICAgICB9XG4gICAgXSxcbiAgICAndGVjaGllc19yZW1vdGVfbWluZXMnOiBbXG4gICAgICAgIHtcbiAgICAgICAgICAgIGxhYmVsOiAnTnVtYmVyIG9mIE1pbmVzJyxcbiAgICAgICAgICAgIGNvbnRyb2xUeXBlOiAnaW5wdXQnXG4gICAgICAgIH0sXG4gICAgICAgIHtcbiAgICAgICAgICAgIGF0dHJpYnV0ZU5hbWU6ICdkYW1hZ2UnLFxuICAgICAgICAgICAgbGFiZWw6ICdUb3RhbCBEYW1hZ2UnLFxuICAgICAgICAgICAgY29udHJvbFR5cGU6ICd0ZXh0JyxcbiAgICAgICAgICAgIGZuOiBmdW5jdGlvbiAodiwgYSwgcGFyZW50LCBpbmRleCwgYWJpbGl0eU1vZGVsLCBhYmlsaXR5KSB7XG4gICAgICAgICAgICAgICAgcmV0dXJuIHYqYTtcbiAgICAgICAgICAgIH1cbiAgICAgICAgfSxcbiAgICAgICAge1xuICAgICAgICAgICAgYXR0cmlidXRlTmFtZTogJ2RhbWFnZScsXG4gICAgICAgICAgICBsYWJlbDogJ0FGVEVSIFJFRFVDVElPTlM6JyxcbiAgICAgICAgICAgIGlnbm9yZVRvb2x0aXA6IHRydWUsXG4gICAgICAgICAgICBjb250cm9sVHlwZTogJ3RleHQnLFxuICAgICAgICAgICAgZm46IGZ1bmN0aW9uICh2LCBhLCBwYXJlbnQsIGluZGV4LCBhYmlsaXR5TW9kZWwsIGFiaWxpdHkpIHtcbiAgICAgICAgICAgICAgICB2YXIgbWFnaWNfcmVkdWN0aW9uID0gcGFyZW50LmVuZW15KCkudG90YWxNYWdpY1Jlc2lzdGFuY2UoKTtcbiAgICAgICAgICAgICAgICByZXR1cm4gKHYgKiBhICogKDEgLSBtYWdpY19yZWR1Y3Rpb24gLyAxMDApKS50b0ZpeGVkKDIpO1xuICAgICAgICAgICAgfVxuICAgICAgICB9XG4gICAgXSxcbiAgICAndGlua2VyX21hcmNoX29mX3RoZV9tYWNoaW5lcyc6IFtcbiAgICAgICAge1xuICAgICAgICAgICAgbGFiZWw6ICdSb2JvdCBFeHBsb3Npb25zJyxcbiAgICAgICAgICAgIGNvbnRyb2xUeXBlOiAnaW5wdXQnXG4gICAgICAgIH0sXG4gICAgICAgIHtcbiAgICAgICAgICAgIGF0dHJpYnV0ZU5hbWU6ICdtYWNoaW5lc19wZXJfc2VjJyxcbiAgICAgICAgICAgIGxhYmVsOiAnVE9UQUwgREFNQUdFOicsXG4gICAgICAgICAgICBpZ25vcmVUb29sdGlwOiB0cnVlLFxuICAgICAgICAgICAgY29udHJvbFR5cGU6ICd0ZXh0JyxcbiAgICAgICAgICAgIGZuOiBmdW5jdGlvbiAodiwgYSwgcGFyZW50LCBpbmRleCwgYWJpbGl0eU1vZGVsLCBhYmlsaXR5KSB7XG4gICAgICAgICAgICAgICAgcmV0dXJuIGFiaWxpdHlNb2RlbC5nZXRBYmlsaXR5UHJvcGVydHlWYWx1ZShhYmlsaXR5LCAnZGFtYWdlJykqdjtcbiAgICAgICAgICAgIH1cbiAgICAgICAgfVxuICAgIF0sXG4gICAgJ3RyZWFudF9sZWVjaF9zZWVkJzogW1xuICAgICAgICB7XG4gICAgICAgICAgICBsYWJlbDogJ1B1bHNlcycsXG4gICAgICAgICAgICBjb250cm9sVHlwZTogJ2lucHV0J1xuICAgICAgICB9LFxuICAgICAgICB7XG4gICAgICAgICAgICBhdHRyaWJ1dGVOYW1lOiAnbGVlY2hfZGFtYWdlJyxcbiAgICAgICAgICAgIGxhYmVsOiAnREFNQUdFL0hFQUw6JyxcbiAgICAgICAgICAgIGlnbm9yZVRvb2x0aXA6IHRydWUsXG4gICAgICAgICAgICBjb250cm9sVHlwZTogJ3RleHQnLFxuICAgICAgICAgICAgZm46IGZ1bmN0aW9uICh2LCBhLCBwYXJlbnQsIGluZGV4LCBhYmlsaXR5TW9kZWwsIGFiaWxpdHkpIHtcbiAgICAgICAgICAgICAgICByZXR1cm4gdiphO1xuICAgICAgICAgICAgfVxuICAgICAgICB9LFxuICAgICAgICB7XG4gICAgICAgICAgICBhdHRyaWJ1dGVOYW1lOiAnbW92ZW1lbnRfc2xvdycsXG4gICAgICAgICAgICBsYWJlbDogJ1RvdGFsIERhbWFnZScsXG4gICAgICAgICAgICBjb250cm9sVHlwZTogJ3RleHQnLFxuICAgICAgICAgICAgZm46IGZ1bmN0aW9uICh2LCBhLCBwYXJlbnQsIGluZGV4LCBhYmlsaXR5TW9kZWwsIGFiaWxpdHkpIHtcbiAgICAgICAgICAgICAgICByZXR1cm4gYTtcbiAgICAgICAgICAgIH0sXG4gICAgICAgICAgICByZXR1cm5Qcm9wZXJ0eTogJ21vdmVtZW50U3BlZWRQY3RSZWR1Y3Rpb24nXG4gICAgICAgIH1cbiAgICBdLFxuICAgICd0cm9sbF93YXJsb3JkX2ZlcnZvcic6IFtcbiAgICAgICAge1xuICAgICAgICAgICAgbGFiZWw6ICdTdGFja3MnLFxuICAgICAgICAgICAgY29udHJvbFR5cGU6ICdpbnB1dCdcbiAgICAgICAgfSxcbiAgICAgICAge1xuICAgICAgICAgICAgYXR0cmlidXRlTmFtZTogJ2F0dGFja19zcGVlZCcsXG4gICAgICAgICAgICBsYWJlbDogJ0FUVEFDSyBTUEVFRDonLFxuICAgICAgICAgICAgaWdub3JlVG9vbHRpcDogdHJ1ZSxcbiAgICAgICAgICAgIGNvbnRyb2xUeXBlOiAndGV4dCcsXG4gICAgICAgICAgICBmbjogZnVuY3Rpb24gKHYsIGEsIHBhcmVudCwgaW5kZXgsIGFiaWxpdHlNb2RlbCwgYWJpbGl0eSkge1xuICAgICAgICAgICAgICAgIHJldHVybiB2KmE7XG4gICAgICAgICAgICB9LFxuICAgICAgICAgICAgcmV0dXJuUHJvcGVydHk6ICdhdHRhY2tzcGVlZCdcbiAgICAgICAgfVxuICAgIF0sXG4gICAgJ3VuZHlpbmdfZGVjYXknOiBbXG4gICAgICAgIHtcbiAgICAgICAgICAgIGxhYmVsOiAnU3RhY2tzJyxcbiAgICAgICAgICAgIGNvbnRyb2xUeXBlOiAnaW5wdXQnXG4gICAgICAgIH0sXG4gICAgICAgIHtcbiAgICAgICAgICAgIGF0dHJpYnV0ZU5hbWU6ICdzdHJfc3RlYWwnLFxuICAgICAgICAgICAgbGFiZWw6ICdTVFJFTkdUSCBTVE9MRU46JyxcbiAgICAgICAgICAgIGlnbm9yZVRvb2x0aXA6IHRydWUsXG4gICAgICAgICAgICBjb250cm9sVHlwZTogJ3RleHQnLFxuICAgICAgICAgICAgZm46IGZ1bmN0aW9uICh2LCBhLCBwYXJlbnQsIGluZGV4LCBhYmlsaXR5TW9kZWwsIGFiaWxpdHkpIHtcbiAgICAgICAgICAgICAgICBpZiAocGFyZW50LmludmVudG9yeS5oYXNTY2VwdGVyKCkpIHtcbiAgICAgICAgICAgICAgICAgICAgdmFyIHN0cl9zdGVhbF9zY2VwdGVyID0gYWJpbGl0eU1vZGVsLmdldEFiaWxpdHlBdHRyaWJ1dGVWYWx1ZShhYmlsaXR5LmF0dHJpYnV0ZXMsICdzdHJfc3RlYWxfc2NlcHRlcicsMCk7XG4gICAgICAgICAgICAgICAgICAgIHJldHVybiB2KnN0cl9zdGVhbF9zY2VwdGVyO1xuICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgICBlbHNlIHtcbiAgICAgICAgICAgICAgICAgICAgcmV0dXJuIHYqYTtcbiAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICB9LFxuICAgICAgICAgICAgcmV0dXJuUHJvcGVydHk6ICdib251c1N0cmVuZ3RoJ1xuICAgICAgICB9LFxuICAgIF0sXG4gICAgJ3VuZHlpbmdfc291bF9yaXAnOiBbXG4gICAgICAgIHtcbiAgICAgICAgICAgIGxhYmVsOiAnVW5pdHMnLFxuICAgICAgICAgICAgY29udHJvbFR5cGU6ICdpbnB1dCdcbiAgICAgICAgfSxcbiAgICAgICAge1xuICAgICAgICAgICAgYXR0cmlidXRlTmFtZTogJ2RhbWFnZV9wZXJfdW5pdCcsXG4gICAgICAgICAgICBsYWJlbDogJ0RBTUFHRS9IRUFMOicsXG4gICAgICAgICAgICBpZ25vcmVUb29sdGlwOiB0cnVlLFxuICAgICAgICAgICAgY29udHJvbFR5cGU6ICd0ZXh0JyxcbiAgICAgICAgICAgIGZuOiBmdW5jdGlvbiAodiwgYSwgcGFyZW50LCBpbmRleCwgYWJpbGl0eU1vZGVsLCBhYmlsaXR5KSB7XG4gICAgICAgICAgICAgICAgcmV0dXJuIHYqYTtcbiAgICAgICAgICAgIH1cbiAgICAgICAgfVxuICAgIF0sXG4gICAgJ3VuZHlpbmdfZmxlc2hfZ29sZW0nOiBbXG4gICAgICAgIHtcbiAgICAgICAgICAgIGxhYmVsOiAnRGlzdGFuY2UnLFxuICAgICAgICAgICAgY29udHJvbFR5cGU6ICdpbnB1dCdcbiAgICAgICAgfSxcbiAgICAgICAge1xuICAgICAgICAgICAgYXR0cmlidXRlTmFtZTogJ21heF9zcGVlZF9zbG93JyxcbiAgICAgICAgICAgIGxhYmVsOiAnJU1PVkUgU0xPVzonLFxuICAgICAgICAgICAgaWdub3JlVG9vbHRpcDogdHJ1ZSxcbiAgICAgICAgICAgIGNvbnRyb2xUeXBlOiAndGV4dCcsXG4gICAgICAgICAgICBmbjogZnVuY3Rpb24gKHYsIGEsIHBhcmVudCwgaW5kZXgsIGFiaWxpdHlNb2RlbCwgYWJpbGl0eSkge1xuICAgICAgICAgICAgICAgIHZhciBtaW5fc3BlZWRfc2xvdyA9IGFiaWxpdHlNb2RlbC5nZXRBYmlsaXR5QXR0cmlidXRlVmFsdWUoYWJpbGl0eS5hdHRyaWJ1dGVzLCAnbWluX3NwZWVkX3Nsb3cnLCAwKTtcbiAgICAgICAgICAgICAgICB2YXIgcmFkaXVzID0gYWJpbGl0eU1vZGVsLmdldEFiaWxpdHlBdHRyaWJ1dGVWYWx1ZShhYmlsaXR5LmF0dHJpYnV0ZXMsICdyYWRpdXMnLCAwKTtcbiAgICAgICAgICAgICAgICB2YXIgZnVsbF9wb3dlcl9yYWRpdXMgPSBhYmlsaXR5TW9kZWwuZ2V0QWJpbGl0eUF0dHJpYnV0ZVZhbHVlKGFiaWxpdHkuYXR0cmlidXRlcywgJ2Z1bGxfcG93ZXJfcmFkaXVzJywgMCk7XG4gICAgICAgICAgICAgICAgdmFyIGRpc3RhbmNlID0gTWF0aC5taW4oTWF0aC5tYXgodiwgZnVsbF9wb3dlcl9yYWRpdXMpLCByYWRpdXMpO1xuICAgICAgICAgICAgICAgIHZhciBzY2FsZSA9IDEgLSAoZGlzdGFuY2UgLSBmdWxsX3Bvd2VyX3JhZGl1cykgLyAocmFkaXVzIC0gZnVsbF9wb3dlcl9yYWRpdXMpO1xuICAgICAgICAgICAgICAgIHJldHVybiAtTWF0aC5tYXgoc2NhbGUgKiBhLCBtaW5fc3BlZWRfc2xvdyk7XG4gICAgICAgICAgICB9LFxuICAgICAgICAgICAgcmV0dXJuUHJvcGVydHk6ICdtb3ZlbWVudFNwZWVkUGN0UmVkdWN0aW9uJ1xuICAgICAgICB9LFxuICAgICAgICB7XG4gICAgICAgICAgICBhdHRyaWJ1dGVOYW1lOiAnbWF4X2RhbWFnZV9hbXAnLFxuICAgICAgICAgICAgbGFiZWw6ICclREFNQUdFIEFNUDonLFxuICAgICAgICAgICAgaWdub3JlVG9vbHRpcDogdHJ1ZSxcbiAgICAgICAgICAgIGNvbnRyb2xUeXBlOiAndGV4dCcsXG4gICAgICAgICAgICBmbjogZnVuY3Rpb24gKHYsIGEsIHBhcmVudCwgaW5kZXgsIGFiaWxpdHlNb2RlbCwgYWJpbGl0eSkge1xuICAgICAgICAgICAgICAgIHZhciBtaW5fZGFtYWdlX2FtcCA9IGFiaWxpdHlNb2RlbC5nZXRBYmlsaXR5QXR0cmlidXRlVmFsdWUoYWJpbGl0eS5hdHRyaWJ1dGVzLCAnbWluX2RhbWFnZV9hbXAnLCAwKTtcbiAgICAgICAgICAgICAgICB2YXIgcmFkaXVzID0gYWJpbGl0eU1vZGVsLmdldEFiaWxpdHlBdHRyaWJ1dGVWYWx1ZShhYmlsaXR5LmF0dHJpYnV0ZXMsICdyYWRpdXMnLCAwKTtcbiAgICAgICAgICAgICAgICB2YXIgZnVsbF9wb3dlcl9yYWRpdXMgPSBhYmlsaXR5TW9kZWwuZ2V0QWJpbGl0eUF0dHJpYnV0ZVZhbHVlKGFiaWxpdHkuYXR0cmlidXRlcywgJ2Z1bGxfcG93ZXJfcmFkaXVzJywgMCk7XG4gICAgICAgICAgICAgICAgdmFyIGRpc3RhbmNlID0gTWF0aC5taW4oTWF0aC5tYXgodiwgZnVsbF9wb3dlcl9yYWRpdXMpLCByYWRpdXMpO1xuICAgICAgICAgICAgICAgIHZhciBzY2FsZSA9IDEgLSAoZGlzdGFuY2UgLSBmdWxsX3Bvd2VyX3JhZGl1cykgLyAocmFkaXVzIC0gZnVsbF9wb3dlcl9yYWRpdXMpO1xuICAgICAgICAgICAgICAgIHJldHVybiBNYXRoLm1heChzY2FsZSAqIGEsIG1pbl9kYW1hZ2VfYW1wKTtcbiAgICAgICAgICAgIH0sXG4gICAgICAgICAgICByZXR1cm5Qcm9wZXJ0eTogJ2RhbWFnZUFtcGxpZmljYXRpb24nXG4gICAgICAgIH0sXG4gICAgICAgIHtcbiAgICAgICAgICAgIGxhYmVsOiAnTUFYIEhQJyxcbiAgICAgICAgICAgIGNvbnRyb2xUeXBlOiAnaW5wdXQnXG4gICAgICAgIH0sXG4gICAgICAgIHtcbiAgICAgICAgICAgIGxhYmVsOiAnSGVybyBEZWF0aCBDb3VudCcsXG4gICAgICAgICAgICBjb250cm9sVHlwZTogJ2lucHV0J1xuICAgICAgICB9LFxuICAgICAgICB7XG4gICAgICAgICAgICBsYWJlbDogJ0NyZWVwIERlYXRoIENvdW50JyxcbiAgICAgICAgICAgIGNvbnRyb2xUeXBlOiAnaW5wdXQnXG4gICAgICAgIH0sXG4gICAgICAgIHtcbiAgICAgICAgICAgIGF0dHJpYnV0ZU5hbWU6ICdkZWF0aF9oZWFsJyxcbiAgICAgICAgICAgIGxhYmVsOiAnREVBVEggSEVBTCAoSEVST0VTKTonLFxuICAgICAgICAgICAgaWdub3JlVG9vbHRpcDogdHJ1ZSxcbiAgICAgICAgICAgIGNvbnRyb2xUeXBlOiAnbWV0aG9kJyxcbiAgICAgICAgICAgIGNvbnRyb2xzOiBbMSwgMl0sXG4gICAgICAgICAgICBmbjogZnVuY3Rpb24gKHYsIGEsIHBhcmVudCwgaW5kZXgsIGFiaWxpdHlNb2RlbCwgYWJpbGl0eSkge1xuICAgICAgICAgICAgICAgIHJldHVybiB2WzBdKnZbMV0qYS8xMDA7XG4gICAgICAgICAgICB9XG4gICAgICAgIH0sXG4gICAgICAgIHtcbiAgICAgICAgICAgIGF0dHJpYnV0ZU5hbWU6ICdkZWF0aF9oZWFsX2NyZWVwJyxcbiAgICAgICAgICAgIGxhYmVsOiAnREVBVEggSEVBTCAoQ1JFRVBTKTonLFxuICAgICAgICAgICAgaWdub3JlVG9vbHRpcDogdHJ1ZSxcbiAgICAgICAgICAgIGNvbnRyb2xUeXBlOiAnbWV0aG9kJyxcbiAgICAgICAgICAgIGNvbnRyb2xzOiBbMSwgM10sXG4gICAgICAgICAgICBmbjogZnVuY3Rpb24gKHYsIGEsIHBhcmVudCwgaW5kZXgsIGFiaWxpdHlNb2RlbCwgYWJpbGl0eSkge1xuICAgICAgICAgICAgICAgIHJldHVybiB2WzBdKnZbMV0qYS8xMDA7XG4gICAgICAgICAgICB9XG4gICAgICAgIH0sXG4gICAgICAgIHtcbiAgICAgICAgICAgIGF0dHJpYnV0ZU5hbWU6ICdkZWF0aF9oZWFsX2NyZWVwJyxcbiAgICAgICAgICAgIGxhYmVsOiAnVE9UQUwgREVBVEggSEVBTDonLFxuICAgICAgICAgICAgaWdub3JlVG9vbHRpcDogdHJ1ZSxcbiAgICAgICAgICAgIGNvbnRyb2xUeXBlOiAndGV4dCcsXG4gICAgICAgICAgICBjb250cm9sczogWzQsIDVdLFxuICAgICAgICAgICAgZm46IGZ1bmN0aW9uICh2LCBhLCBwYXJlbnQsIGluZGV4LCBhYmlsaXR5TW9kZWwsIGFiaWxpdHkpIHtcbiAgICAgICAgICAgICAgICByZXR1cm4gdlswXSt2WzFdO1xuICAgICAgICAgICAgfVxuICAgICAgICB9XG4gICAgXSxcbiAgICAndXJzYV9mdXJ5X3N3aXBlcyc6IFtcbiAgICAgICAge1xuICAgICAgICAgICAgbGFiZWw6ICdTdGFja3MnLFxuICAgICAgICAgICAgY29udHJvbFR5cGU6ICdpbnB1dCdcbiAgICAgICAgfSxcbiAgICAgICAge1xuICAgICAgICAgICAgYXR0cmlidXRlTmFtZTogJ2RhbWFnZV9wZXJfc3RhY2snLFxuICAgICAgICAgICAgbGFiZWw6ICdUb3RhbCBEYW1hZ2UnLFxuICAgICAgICAgICAgY29udHJvbFR5cGU6ICd0ZXh0JyxcbiAgICAgICAgICAgIGZuOiBmdW5jdGlvbiAodiwgYSwgcGFyZW50LCBpbmRleCwgYWJpbGl0eU1vZGVsLCBhYmlsaXR5KSB7XG4gICAgICAgICAgICAgICAgdmFyIGVucmFnZUFiaWxpdHkgPSBhYmlsaXR5TW9kZWwuYWJpbGl0aWVzKCkuZmluZChmdW5jdGlvbihiKSB7XG4gICAgICAgICAgICAgICAgICAgIHJldHVybiBiLm5hbWUgPT0gJ3Vyc2FfZW5yYWdlJztcbiAgICAgICAgICAgICAgICB9KTtcbiAgICAgICAgICAgICAgICBpZiAoZW5yYWdlQWJpbGl0eS5pc0FjdGl2ZSgpICYmIGVucmFnZUFiaWxpdHkubGV2ZWwoKSA+IDApIHtcbiAgICAgICAgICAgICAgICAgICAgdmFyIGVucmFnZV9tdWx0aXBsaWVyID0gYWJpbGl0eU1vZGVsLmdldEFiaWxpdHlBdHRyaWJ1dGVWYWx1ZShlbnJhZ2VBYmlsaXR5LmF0dHJpYnV0ZXMsICdlbnJhZ2VfbXVsdGlwbGllcicsIGVucmFnZUFiaWxpdHkubGV2ZWwoKSk7XG4gICAgICAgICAgICAgICAgICAgIHJldHVybiB2KmEqZW5yYWdlX211bHRpcGxpZXI7XG4gICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICAgIHJldHVybiB2KmE7XG4gICAgICAgICAgICB9LFxuICAgICAgICAgICAgcmV0dXJuUHJvcGVydHk6ICdib251c0RhbWFnZSdcbiAgICAgICAgfVxuICAgIF0sXG4gICAgJ3Vyc2FfZW5yYWdlJzogW1xuICAgICAgICB7XG4gICAgICAgICAgICBhdHRyaWJ1dGVOYW1lOiAnZGFtYWdlX3JlZHVjdGlvbicsXG4gICAgICAgICAgICBsYWJlbDogJ1RvdGFsIERhbWFnZScsXG4gICAgICAgICAgICBjb250cm9sVHlwZTogJ3RleHQnLFxuICAgICAgICAgICAgZm46IGZ1bmN0aW9uICh2LCBhLCBwYXJlbnQsIGluZGV4LCBhYmlsaXR5TW9kZWwsIGFiaWxpdHkpIHtcbiAgICAgICAgICAgICAgICByZXR1cm4gLWE7XG4gICAgICAgICAgICB9LFxuICAgICAgICAgICAgcmV0dXJuUHJvcGVydHk6ICdkYW1hZ2VSZWR1Y3Rpb24nXG4gICAgICAgIH1cbiAgICBdLFxuICAgICd2ZW5vbWFuY2VyX3Zlbm9tb3VzX2dhbGUnOiBbXG4gICAgICAgIHtcbiAgICAgICAgICAgIGxhYmVsOiAnRHVyYXRpb24nLFxuICAgICAgICAgICAgY29udHJvbFR5cGU6ICdpbnB1dCdcbiAgICAgICAgfSxcbiAgICAgICAge1xuICAgICAgICAgICAgYXR0cmlidXRlTmFtZTogJ3RpY2tfZGFtYWdlJyxcbiAgICAgICAgICAgIGxhYmVsOiAnVG90YWwgRGFtYWdlJyxcbiAgICAgICAgICAgIGNvbnRyb2xUeXBlOiAndGV4dCcsXG4gICAgICAgICAgICBmbjogZnVuY3Rpb24gKHYsIGEsIHBhcmVudCwgaW5kZXgsIGFiaWxpdHlNb2RlbCwgYWJpbGl0eSkge1xuICAgICAgICAgICAgICAgIHJldHVybiBhYmlsaXR5TW9kZWwuZ2V0QWJpbGl0eUF0dHJpYnV0ZVZhbHVlKGFiaWxpdHkuYXR0cmlidXRlcywgJ3N0cmlrZV9kYW1hZ2UnLGFiaWxpdHkubGV2ZWwoKSkgKyBNYXRoLmZsb29yKHYvMykqYTtcbiAgICAgICAgICAgIH1cbiAgICAgICAgfSxcbiAgICAgICAge1xuICAgICAgICAgICAgYXR0cmlidXRlTmFtZTogJ21vdmVtZW50X3Nsb3cnLFxuICAgICAgICAgICAgbGFiZWw6ICdUb3RhbCBEYW1hZ2UnLFxuICAgICAgICAgICAgY29udHJvbFR5cGU6ICd0ZXh0JyxcbiAgICAgICAgICAgIGZuOiBmdW5jdGlvbiAodiwgYSwgcGFyZW50LCBpbmRleCwgYWJpbGl0eU1vZGVsLCBhYmlsaXR5KSB7XG4gICAgICAgICAgICAgICAgcmV0dXJuIGE7XG4gICAgICAgICAgICB9LFxuICAgICAgICAgICAgcmV0dXJuUHJvcGVydHk6ICdtb3ZlbWVudFNwZWVkUGN0UmVkdWN0aW9uJ1xuICAgICAgICB9XG4gICAgXSxcbiAgICAndmVub21hbmNlcl9wb2lzb25fc3RpbmcnOiBbXG4gICAgICAgIHtcbiAgICAgICAgICAgIGxhYmVsOiAnRHVyYXRpb24nLFxuICAgICAgICAgICAgY29udHJvbFR5cGU6ICdpbnB1dCdcbiAgICAgICAgfSxcbiAgICAgICAge1xuICAgICAgICAgICAgYXR0cmlidXRlTmFtZTogJ2RhbWFnZScsXG4gICAgICAgICAgICBsYWJlbDogJ1RvdGFsIERhbWFnZScsXG4gICAgICAgICAgICBjb250cm9sVHlwZTogJ3RleHQnLFxuICAgICAgICAgICAgZm46IGZ1bmN0aW9uICh2LCBhLCBwYXJlbnQsIGluZGV4LCBhYmlsaXR5TW9kZWwsIGFiaWxpdHkpIHtcbiAgICAgICAgICAgICAgICByZXR1cm4gdiphO1xuICAgICAgICAgICAgfVxuICAgICAgICB9LFxuICAgICAgICB7XG4gICAgICAgICAgICBhdHRyaWJ1dGVOYW1lOiAnbW92ZW1lbnRfc3BlZWQnLFxuICAgICAgICAgICAgbGFiZWw6ICdUb3RhbCBEYW1hZ2UnLFxuICAgICAgICAgICAgY29udHJvbFR5cGU6ICd0ZXh0JyxcbiAgICAgICAgICAgIGZuOiBmdW5jdGlvbiAodiwgYSwgcGFyZW50LCBpbmRleCwgYWJpbGl0eU1vZGVsLCBhYmlsaXR5KSB7XG4gICAgICAgICAgICAgICAgcmV0dXJuIGE7XG4gICAgICAgICAgICB9LFxuICAgICAgICAgICAgcmV0dXJuUHJvcGVydHk6ICdtb3ZlbWVudFNwZWVkUGN0UmVkdWN0aW9uJ1xuICAgICAgICB9XG4gICAgXSxcbiAgICAndmVub21hbmNlcl9wb2lzb25fbm92YSc6IFtcbiAgICAgICAge1xuICAgICAgICAgICAgbGFiZWw6ICdEdXJhdGlvbicsXG4gICAgICAgICAgICBjb250cm9sVHlwZTogJ2lucHV0J1xuICAgICAgICB9LFxuICAgICAgICB7XG4gICAgICAgICAgICBhdHRyaWJ1dGVOYW1lOiAnZGFtYWdlJyxcbiAgICAgICAgICAgIGxhYmVsOiAnVG90YWwgRGFtYWdlJyxcbiAgICAgICAgICAgIGNvbnRyb2xUeXBlOiAndGV4dCcsXG4gICAgICAgICAgICBmbjogZnVuY3Rpb24gKHYsIGEsIHBhcmVudCwgaW5kZXgsIGFiaWxpdHlNb2RlbCwgYWJpbGl0eSkge1xuICAgICAgICAgICAgICAgIHJldHVybiB2KmE7XG4gICAgICAgICAgICB9XG4gICAgICAgIH1cbiAgICBdLFxuICAgICd2aXBlcl9wb2lzb25fYXR0YWNrJzogW1xuICAgICAgICB7XG4gICAgICAgICAgICBsYWJlbDogJ0R1cmF0aW9uJyxcbiAgICAgICAgICAgIGNvbnRyb2xUeXBlOiAnaW5wdXQnXG4gICAgICAgIH0sXG4gICAgICAgIHtcbiAgICAgICAgICAgIGF0dHJpYnV0ZU5hbWU6ICdkYW1hZ2UnLFxuICAgICAgICAgICAgbGFiZWw6ICdUb3RhbCBEYW1hZ2UnLFxuICAgICAgICAgICAgY29udHJvbFR5cGU6ICd0ZXh0JyxcbiAgICAgICAgICAgIGZuOiBmdW5jdGlvbiAodiwgYSwgcGFyZW50LCBpbmRleCwgYWJpbGl0eU1vZGVsLCBhYmlsaXR5KSB7XG4gICAgICAgICAgICAgICAgcmV0dXJuIHYqYTtcbiAgICAgICAgICAgIH1cbiAgICAgICAgfSxcbiAgICAgICAge1xuICAgICAgICAgICAgYXR0cmlidXRlTmFtZTogJ2JvbnVzX21vdmVtZW50X3NwZWVkJyxcbiAgICAgICAgICAgIGxhYmVsOiAnVG90YWwgRGFtYWdlJyxcbiAgICAgICAgICAgIGNvbnRyb2xUeXBlOiAndGV4dCcsXG4gICAgICAgICAgICBmbjogZnVuY3Rpb24gKHYsIGEsIHBhcmVudCwgaW5kZXgsIGFiaWxpdHlNb2RlbCwgYWJpbGl0eSkge1xuICAgICAgICAgICAgICAgIHJldHVybiBhO1xuICAgICAgICAgICAgfSxcbiAgICAgICAgICAgIHJldHVyblByb3BlcnR5OiAnbW92ZW1lbnRTcGVlZFBjdFJlZHVjdGlvbidcbiAgICAgICAgfSxcbiAgICAgICAge1xuICAgICAgICAgICAgYXR0cmlidXRlTmFtZTogJ2JvbnVzX2F0dGFja19zcGVlZCcsXG4gICAgICAgICAgICBsYWJlbDogJ1RvdGFsIERhbWFnZScsXG4gICAgICAgICAgICBjb250cm9sVHlwZTogJ3RleHQnLFxuICAgICAgICAgICAgZm46IGZ1bmN0aW9uICh2LCBhLCBwYXJlbnQsIGluZGV4LCBhYmlsaXR5TW9kZWwsIGFiaWxpdHkpIHtcbiAgICAgICAgICAgICAgICByZXR1cm4gYTtcbiAgICAgICAgICAgIH0sXG4gICAgICAgICAgICByZXR1cm5Qcm9wZXJ0eTogJ2F0dGFja3NwZWVkcmVkdWN0aW9uJ1xuICAgICAgICB9XG4gICAgXSxcbiAgICAndmlwZXJfY29ycm9zaXZlX3NraW4nOiBbXG4gICAgICAgIHtcbiAgICAgICAgICAgIGxhYmVsOiAnRHVyYXRpb24nLFxuICAgICAgICAgICAgY29udHJvbFR5cGU6ICdpbnB1dCdcbiAgICAgICAgfSxcbiAgICAgICAge1xuICAgICAgICAgICAgYXR0cmlidXRlTmFtZTogJ2RhbWFnZScsXG4gICAgICAgICAgICBsYWJlbDogJ1RvdGFsIERhbWFnZScsXG4gICAgICAgICAgICBjb250cm9sVHlwZTogJ3RleHQnLFxuICAgICAgICAgICAgZm46IGZ1bmN0aW9uICh2LCBhLCBwYXJlbnQsIGluZGV4LCBhYmlsaXR5TW9kZWwsIGFiaWxpdHkpIHtcbiAgICAgICAgICAgICAgICByZXR1cm4gdiphO1xuICAgICAgICAgICAgfVxuICAgICAgICB9LFxuICAgICAgICB7XG4gICAgICAgICAgICBhdHRyaWJ1dGVOYW1lOiAnYm9udXNfbW92ZW1lbnRfc3BlZWQnLFxuICAgICAgICAgICAgbGFiZWw6ICdUb3RhbCBEYW1hZ2UnLFxuICAgICAgICAgICAgY29udHJvbFR5cGU6ICd0ZXh0JyxcbiAgICAgICAgICAgIGZuOiBmdW5jdGlvbiAodiwgYSwgcGFyZW50LCBpbmRleCwgYWJpbGl0eU1vZGVsLCBhYmlsaXR5KSB7XG4gICAgICAgICAgICAgICAgcmV0dXJuIGE7XG4gICAgICAgICAgICB9LFxuICAgICAgICAgICAgcmV0dXJuUHJvcGVydHk6ICdtb3ZlbWVudFNwZWVkUGN0UmVkdWN0aW9uJ1xuICAgICAgICB9LFxuICAgICAgICB7XG4gICAgICAgICAgICBhdHRyaWJ1dGVOYW1lOiAnYm9udXNfYXR0YWNrX3NwZWVkJyxcbiAgICAgICAgICAgIGxhYmVsOiAnVG90YWwgRGFtYWdlJyxcbiAgICAgICAgICAgIGNvbnRyb2xUeXBlOiAndGV4dCcsXG4gICAgICAgICAgICBmbjogZnVuY3Rpb24gKHYsIGEsIHBhcmVudCwgaW5kZXgsIGFiaWxpdHlNb2RlbCwgYWJpbGl0eSkge1xuICAgICAgICAgICAgICAgIHJldHVybiBhO1xuICAgICAgICAgICAgfSxcbiAgICAgICAgICAgIHJldHVyblByb3BlcnR5OiAnYXR0YWNrc3BlZWRyZWR1Y3Rpb24nXG4gICAgICAgIH0sXG4gICAgICAgIHtcbiAgICAgICAgICAgIGF0dHJpYnV0ZU5hbWU6ICdib251c19tYWdpY19yZXNpc3RhbmNlJyxcbiAgICAgICAgICAgIGxhYmVsOiAnVG90YWwgRGFtYWdlJyxcbiAgICAgICAgICAgIGNvbnRyb2xUeXBlOiAndGV4dCcsXG4gICAgICAgICAgICBmbjogZnVuY3Rpb24gKHYsIGEsIHBhcmVudCwgaW5kZXgsIGFiaWxpdHlNb2RlbCwgYWJpbGl0eSkge1xuICAgICAgICAgICAgICAgIHJldHVybiBhO1xuICAgICAgICAgICAgfSxcbiAgICAgICAgICAgIHJldHVyblByb3BlcnR5OiAnbWFnaWNSZXNpc3QnXG4gICAgICAgIH1cbiAgICBdLFxuICAgICd2aXBlcl92aXBlcl9zdHJpa2UnOiBbXG4gICAgICAgIHtcbiAgICAgICAgICAgIGxhYmVsOiAnRHVyYXRpb24nLFxuICAgICAgICAgICAgY29udHJvbFR5cGU6ICdpbnB1dCdcbiAgICAgICAgfSxcbiAgICAgICAge1xuICAgICAgICAgICAgYXR0cmlidXRlTmFtZTogJ2RhbWFnZScsXG4gICAgICAgICAgICBsYWJlbDogJ1RvdGFsIERhbWFnZScsXG4gICAgICAgICAgICBjb250cm9sVHlwZTogJ3RleHQnLFxuICAgICAgICAgICAgZm46IGZ1bmN0aW9uICh2LCBhLCBwYXJlbnQsIGluZGV4LCBhYmlsaXR5TW9kZWwsIGFiaWxpdHkpIHtcbiAgICAgICAgICAgICAgICByZXR1cm4gdiphO1xuICAgICAgICAgICAgfVxuICAgICAgICB9LFxuICAgICAgICB7XG4gICAgICAgICAgICBhdHRyaWJ1dGVOYW1lOiAnYm9udXNfbW92ZW1lbnRfc3BlZWQnLFxuICAgICAgICAgICAgbGFiZWw6ICdUb3RhbCBEYW1hZ2UnLFxuICAgICAgICAgICAgY29udHJvbFR5cGU6ICd0ZXh0JyxcbiAgICAgICAgICAgIGZuOiBmdW5jdGlvbiAodiwgYSwgcGFyZW50LCBpbmRleCwgYWJpbGl0eU1vZGVsLCBhYmlsaXR5KSB7XG4gICAgICAgICAgICAgICAgcmV0dXJuIGE7XG4gICAgICAgICAgICB9LFxuICAgICAgICAgICAgcmV0dXJuUHJvcGVydHk6ICdtb3ZlbWVudFNwZWVkUGN0UmVkdWN0aW9uJ1xuICAgICAgICB9LFxuICAgICAgICB7XG4gICAgICAgICAgICBhdHRyaWJ1dGVOYW1lOiAnYm9udXNfYXR0YWNrX3NwZWVkJyxcbiAgICAgICAgICAgIGxhYmVsOiAnVG90YWwgRGFtYWdlJyxcbiAgICAgICAgICAgIGNvbnRyb2xUeXBlOiAndGV4dCcsXG4gICAgICAgICAgICBmbjogZnVuY3Rpb24gKHYsIGEsIHBhcmVudCwgaW5kZXgsIGFiaWxpdHlNb2RlbCwgYWJpbGl0eSkge1xuICAgICAgICAgICAgICAgIHJldHVybiBhO1xuICAgICAgICAgICAgfSxcbiAgICAgICAgICAgIHJldHVyblByb3BlcnR5OiAnYXR0YWNrc3BlZWRyZWR1Y3Rpb24nXG4gICAgICAgIH1cbiAgICBdLFxuICAgICd2aXNhZ2Vfc291bF9hc3N1bXB0aW9uJzogW1xuICAgICAgICB7XG4gICAgICAgICAgICBsYWJlbDogJ0NoYXJnZXMnLFxuICAgICAgICAgICAgY29udHJvbFR5cGU6ICdpbnB1dCdcbiAgICAgICAgfSxcbiAgICAgICAge1xuICAgICAgICAgICAgYXR0cmlidXRlTmFtZTogJ3NvdWxfY2hhcmdlX2RhbWFnZScsXG4gICAgICAgICAgICBsYWJlbDogJ1RvdGFsIERhbWFnZTonLFxuICAgICAgICAgICAgaWdub3JlVG9vbHRpcDogdHJ1ZSxcbiAgICAgICAgICAgIGNvbnRyb2xUeXBlOiAndGV4dCcsXG4gICAgICAgICAgICBmbjogZnVuY3Rpb24gKHYsIGEsIHBhcmVudCwgaW5kZXgsIGFiaWxpdHlNb2RlbCwgYWJpbGl0eSkge1xuICAgICAgICAgICAgICAgIHZhciBzb3VsX2Jhc2VfZGFtYWdlID0gYWJpbGl0eU1vZGVsLmdldEFiaWxpdHlBdHRyaWJ1dGVWYWx1ZShhYmlsaXR5LmF0dHJpYnV0ZXMsICdzb3VsX2Jhc2VfZGFtYWdlJywwKTtcbiAgICAgICAgICAgICAgICB2YXIgc3RhY2tfbGltaXQgPSBhYmlsaXR5TW9kZWwuZ2V0QWJpbGl0eUF0dHJpYnV0ZVZhbHVlKGFiaWxpdHkuYXR0cmlidXRlcywgJ3N0YWNrX2xpbWl0JywgYWJpbGl0eS5sZXZlbCgpKTtcbiAgICAgICAgICAgICAgICBzdGFja19saW1pdCA9IE1hdGgubWF4KE1hdGgubWluKHYsIHN0YWNrX2xpbWl0KSwgMCk7XG4gICAgICAgICAgICAgICAgcmV0dXJuIHNvdWxfYmFzZV9kYW1hZ2UgKyBzdGFja19saW1pdCphO1xuICAgICAgICAgICAgfVxuICAgICAgICB9XG4gICAgXSxcbiAgICAndmlzYWdlX2dyYXZla2VlcGVyc19jbG9hayc6IFtcbiAgICAgICAge1xuICAgICAgICAgICAgbGFiZWw6ICdMYXllcnMnLFxuICAgICAgICAgICAgY29udHJvbFR5cGU6ICdpbnB1dCdcbiAgICAgICAgfSxcbiAgICAgICAge1xuICAgICAgICAgICAgYXR0cmlidXRlTmFtZTogJ2JvbnVzX2FybW9yJyxcbiAgICAgICAgICAgIGxhYmVsOiAnQVJNT1I6JyxcbiAgICAgICAgICAgIGlnbm9yZVRvb2x0aXA6IHRydWUsXG4gICAgICAgICAgICBjb250cm9sVHlwZTogJ3RleHQnLFxuICAgICAgICAgICAgZm46IGZ1bmN0aW9uICh2LCBhLCBwYXJlbnQsIGluZGV4LCBhYmlsaXR5TW9kZWwsIGFiaWxpdHkpIHtcbiAgICAgICAgICAgICAgICByZXR1cm4gdiphO1xuICAgICAgICAgICAgfSxcbiAgICAgICAgICAgIHJldHVyblByb3BlcnR5OiAnYXJtb3InXG4gICAgICAgIH0sXG4gICAgICAgIHtcbiAgICAgICAgICAgIGF0dHJpYnV0ZU5hbWU6ICdib251c19yZXNpc3QnLFxuICAgICAgICAgICAgbGFiZWw6ICclUkVTSVNUOicsXG4gICAgICAgICAgICBpZ25vcmVUb29sdGlwOiB0cnVlLFxuICAgICAgICAgICAgY29udHJvbFR5cGU6ICd0ZXh0JyxcbiAgICAgICAgICAgIGZuOiBmdW5jdGlvbiAodiwgYSwgcGFyZW50LCBpbmRleCwgYWJpbGl0eU1vZGVsLCBhYmlsaXR5KSB7XG4gICAgICAgICAgICAgICAgcmV0dXJuIHYqYTtcbiAgICAgICAgICAgIH0sXG4gICAgICAgICAgICByZXR1cm5Qcm9wZXJ0eTogJ21hZ2ljUmVzaXN0J1xuICAgICAgICB9XG4gICAgXSxcbiAgICAnd2FybG9ja19zaGFkb3dfd29yZCc6IFtcbiAgICAgICAge1xuICAgICAgICAgICAgbGFiZWw6ICdEdXJhdGlvbicsXG4gICAgICAgICAgICBjb250cm9sVHlwZTogJ2lucHV0J1xuICAgICAgICB9LFxuICAgICAgICB7XG4gICAgICAgICAgICBsYWJlbDogJ0RBTUFHRTonLFxuICAgICAgICAgICAgaWdub3JlVG9vbHRpcDogdHJ1ZSxcbiAgICAgICAgICAgIGNvbnRyb2xUeXBlOiAndGV4dCcsXG4gICAgICAgICAgICBmbjogZnVuY3Rpb24gKHYsIGEsIHBhcmVudCwgaW5kZXgsIGFiaWxpdHlNb2RlbCwgYWJpbGl0eSkge1xuICAgICAgICAgICAgICAgIHJldHVybiBhYmlsaXR5TW9kZWwuZ2V0QWJpbGl0eVByb3BlcnR5VmFsdWUoYWJpbGl0eSwgJ2RhbWFnZScpKnY7XG4gICAgICAgICAgICB9XG4gICAgICAgIH1cbiAgICBdLFxuICAgICd3YXJsb2NrX3VwaGVhdmFsJzogW1xuICAgICAgICB7XG4gICAgICAgICAgICBsYWJlbDogJ0NoYW5uZWwgRHVyYXRpb24nLFxuICAgICAgICAgICAgY29udHJvbFR5cGU6ICdpbnB1dCdcbiAgICAgICAgfSxcbiAgICAgICAge1xuICAgICAgICAgICAgYXR0cmlidXRlTmFtZTogJ3Nsb3dfcmF0ZV9kdXJhdGlvbicsXG4gICAgICAgICAgICBsYWJlbDogJyVNT1ZFIFNMT1c6JyxcbiAgICAgICAgICAgIGlnbm9yZVRvb2x0aXA6IHRydWUsXG4gICAgICAgICAgICBjb250cm9sVHlwZTogJ3RleHQnLFxuICAgICAgICAgICAgZm46IGZ1bmN0aW9uICh2LCBhLCBwYXJlbnQsIGluZGV4LCBhYmlsaXR5TW9kZWwsIGFiaWxpdHkpIHtcbiAgICAgICAgICAgICAgICB2YXIgbWF4X3Nsb3cgPSBhYmlsaXR5TW9kZWwuZ2V0QWJpbGl0eUF0dHJpYnV0ZVZhbHVlKGFiaWxpdHkuYXR0cmlidXRlcywgJ21heF9zbG93JywwKTtcbiAgICAgICAgICAgICAgICB2YXIgc2xvd19wZXJfdGljayA9IG1heF9zbG93IC8gKGEgLSAwLjUpIC8gMjtcbiAgICAgICAgICAgICAgICB2YXIgdGlja3MgPSBNYXRoLm1heChNYXRoLmZsb29yKHYgKiAyKSAtIDEsIDApO1xuICAgICAgICAgICAgICAgIHJldHVybiAtTWF0aC5taW4odGlja3MgKiBzbG93X3Blcl90aWNrLCBtYXhfc2xvdyk7XG4gICAgICAgICAgICB9LFxuICAgICAgICAgICAgcmV0dXJuUHJvcGVydHk6ICdtb3ZlbWVudFNwZWVkUGN0UmVkdWN0aW9uJ1xuICAgICAgICB9XG4gICAgXSxcbiAgICAnd2VhdmVyX3RoZV9zd2FybSc6IFtcbiAgICAgICAge1xuICAgICAgICAgICAgbGFiZWw6ICdBdHRhY2tzJyxcbiAgICAgICAgICAgIGNvbnRyb2xUeXBlOiAnaW5wdXQnXG4gICAgICAgIH0sXG4gICAgICAgIHtcbiAgICAgICAgICAgIGF0dHJpYnV0ZU5hbWU6ICdkYW1hZ2UnLFxuICAgICAgICAgICAgbGFiZWw6ICdEQU1BR0U6JyxcbiAgICAgICAgICAgIGNvbnRyb2xUeXBlOiAndGV4dCcsXG4gICAgICAgICAgICBmbjogZnVuY3Rpb24gKHYsIGEsIHBhcmVudCwgaW5kZXgsIGFiaWxpdHlNb2RlbCwgYWJpbGl0eSkge1xuICAgICAgICAgICAgICAgIHJldHVybiB2KmE7XG4gICAgICAgICAgICB9XG4gICAgICAgIH0sXG4gICAgICAgIHtcbiAgICAgICAgICAgIGF0dHJpYnV0ZU5hbWU6ICdhcm1vcl9yZWR1Y3Rpb24nLFxuICAgICAgICAgICAgbGFiZWw6ICdEQU1BR0U6JyxcbiAgICAgICAgICAgIGNvbnRyb2xUeXBlOiAndGV4dCcsXG4gICAgICAgICAgICBmbjogZnVuY3Rpb24gKHYsIGEsIHBhcmVudCwgaW5kZXgsIGFiaWxpdHlNb2RlbCwgYWJpbGl0eSkge1xuICAgICAgICAgICAgICAgIHJldHVybiAtdiphO1xuICAgICAgICAgICAgfSxcbiAgICAgICAgICAgIHJldHVyblByb3BlcnR5OiAnYXJtb3JSZWR1Y3Rpb24nXG4gICAgICAgIH1cbiAgICBdLFxuICAgICd3aW5kcnVubmVyX3Bvd2Vyc2hvdCc6IFtcbiAgICAgICAge1xuICAgICAgICAgICAgbGFiZWw6ICdEdXJhdGlvbicsXG4gICAgICAgICAgICBjb250cm9sVHlwZTogJ2lucHV0J1xuICAgICAgICB9LFxuICAgICAgICB7XG4gICAgICAgICAgICBsYWJlbDogJ0RBTUFHRTonLFxuICAgICAgICAgICAgaWdub3JlVG9vbHRpcDogdHJ1ZSxcbiAgICAgICAgICAgIGNvbnRyb2xUeXBlOiAndGV4dCcsXG4gICAgICAgICAgICBmbjogZnVuY3Rpb24gKHYsIGEsIHBhcmVudCwgaW5kZXgsIGFiaWxpdHlNb2RlbCwgYWJpbGl0eSkge1xuICAgICAgICAgICAgICAgIHJldHVybiBhYmlsaXR5TW9kZWwuZ2V0QWJpbGl0eVByb3BlcnR5VmFsdWUoYWJpbGl0eSwgJ2RhbWFnZScpKnY7XG4gICAgICAgICAgICB9XG4gICAgICAgIH1cbiAgICBdLFxuICAgICd3aW50ZXJfd3l2ZXJuX2NvbGRfZW1icmFjZSc6IFtcbiAgICAgICAge1xuICAgICAgICAgICAgbGFiZWw6ICdEdXJhdGlvbicsXG4gICAgICAgICAgICBjb250cm9sVHlwZTogJ2lucHV0J1xuICAgICAgICB9LFxuICAgICAgICB7XG4gICAgICAgICAgICBsYWJlbDogJ0FsbHkgTWF4IEhlYWx0aCcsXG4gICAgICAgICAgICBjb250cm9sVHlwZTogJ2lucHV0J1xuICAgICAgICB9LFxuICAgICAgICB7XG4gICAgICAgICAgICBhdHRyaWJ1dGVOYW1lOiAnaGVhbF9wZXJjZW50YWdlJyxcbiAgICAgICAgICAgIGxhYmVsOiAnVE9UQUwgSEVBTDonLFxuICAgICAgICAgICAgaWdub3JlVG9vbHRpcDogdHJ1ZSxcbiAgICAgICAgICAgIGNvbnRyb2xUeXBlOiAndGV4dCcsXG4gICAgICAgICAgICBjb250cm9sczogWzAsMV0sXG4gICAgICAgICAgICBmbjogZnVuY3Rpb24gKHYsIGEsIHBhcmVudCwgaW5kZXgsIGFiaWxpdHlNb2RlbCwgYWJpbGl0eSkge1xuICAgICAgICAgICAgICAgIHZhciBiYXNlX2hlYWwgPSBhYmlsaXR5TW9kZWwuZ2V0QWJpbGl0eUF0dHJpYnV0ZVZhbHVlKGFiaWxpdHkuYXR0cmlidXRlcywgJ2hlYWxfYWRkaXRpdmUnLGFiaWxpdHkubGV2ZWwoKSk7XG4gICAgICAgICAgICAgICAgcmV0dXJuIChiYXNlX2hlYWwgKyB2WzFdICogYS8xMDApICogdlswXTtcbiAgICAgICAgICAgIH1cbiAgICAgICAgfVxuICAgIF0sXG4gICAgJ3dpc3Bfc3Bpcml0cyc6IFtcbiAgICAgICAge1xuICAgICAgICAgICAgbGFiZWw6ICdDb2xsaXNpb24gQ291bnQnLFxuICAgICAgICAgICAgY29udHJvbFR5cGU6ICdpbnB1dCdcbiAgICAgICAgfSxcbiAgICAgICAge1xuICAgICAgICAgICAgYXR0cmlidXRlTmFtZTogJ2hlcm9fZGFtYWdlJyxcbiAgICAgICAgICAgIGxhYmVsOiAnVG90YWwgRGFtYWdlJyxcbiAgICAgICAgICAgIGNvbnRyb2xUeXBlOiAndGV4dCcsXG4gICAgICAgICAgICBmbjogZnVuY3Rpb24gKHYsIGEsIHBhcmVudCwgaW5kZXgsIGFiaWxpdHlNb2RlbCwgYWJpbGl0eSkge1xuICAgICAgICAgICAgICAgIHJldHVybiB2KmE7XG4gICAgICAgICAgICB9XG4gICAgICAgIH0sXG4gICAgICAgIHtcbiAgICAgICAgICAgIGF0dHJpYnV0ZU5hbWU6ICdjcmVlcF9kYW1hZ2UnLFxuICAgICAgICAgICAgbGFiZWw6ICdUb3RhbCBEYW1hZ2UnLFxuICAgICAgICAgICAgY29udHJvbFR5cGU6ICd0ZXh0JyxcbiAgICAgICAgICAgIGZuOiBmdW5jdGlvbiAodiwgYSwgcGFyZW50LCBpbmRleCwgYWJpbGl0eU1vZGVsLCBhYmlsaXR5KSB7XG4gICAgICAgICAgICAgICAgcmV0dXJuIHYqYTtcbiAgICAgICAgICAgIH1cbiAgICAgICAgfVxuICAgIF0sXG4gICAgJ3dpc3Bfb3ZlcmNoYXJnZSc6IFtcbiAgICAgICAge1xuICAgICAgICAgICAgbGFiZWw6ICdDdXJyZW50IEhQJyxcbiAgICAgICAgICAgIGNvbnRyb2xUeXBlOiAnaW5wdXQnXG4gICAgICAgIH0sXG4gICAgICAgIHtcbiAgICAgICAgICAgIGF0dHJpYnV0ZU5hbWU6ICdkcmFpbl9wY3QnLFxuICAgICAgICAgICAgbGFiZWw6ICdIUCBEUkFJTkVEOicsXG4gICAgICAgICAgICBpZ25vcmVUb29sdGlwOiB0cnVlLCBcbiAgICAgICAgICAgIGNvbnRyb2xUeXBlOiAndGV4dCcsXG4gICAgICAgICAgICBmbjogZnVuY3Rpb24gKHYsIGEsIHBhcmVudCwgaW5kZXgsIGFiaWxpdHlNb2RlbCwgYWJpbGl0eSkge1xuICAgICAgICAgICAgICAgIHJldHVybiB2KmE7XG4gICAgICAgICAgICB9XG4gICAgICAgIH0sXG4gICAgICAgIHtcbiAgICAgICAgICAgIGxhYmVsOiAnQ3VycmVudCBNUCcsXG4gICAgICAgICAgICBjb250cm9sVHlwZTogJ2lucHV0J1xuICAgICAgICB9LFxuICAgICAgICB7XG4gICAgICAgICAgICBhdHRyaWJ1dGVOYW1lOiAnZHJhaW5fcGN0JyxcbiAgICAgICAgICAgIGxhYmVsOiAnTVAgRFJBSU5FRDonLFxuICAgICAgICAgICAgaWdub3JlVG9vbHRpcDogdHJ1ZSwgXG4gICAgICAgICAgICBjb250cm9sVHlwZTogJ3RleHQnLFxuICAgICAgICAgICAgZm46IGZ1bmN0aW9uICh2LCBhLCBwYXJlbnQsIGluZGV4LCBhYmlsaXR5TW9kZWwsIGFiaWxpdHkpIHtcbiAgICAgICAgICAgICAgICByZXR1cm4gdiphO1xuICAgICAgICAgICAgfVxuICAgICAgICB9LFxuICAgICAgICB7XG4gICAgICAgICAgICBhdHRyaWJ1dGVOYW1lOiAnYm9udXNfYXR0YWNrX3NwZWVkJyxcbiAgICAgICAgICAgIGxhYmVsOiAnVG90YWwgRGFtYWdlJyxcbiAgICAgICAgICAgIGNvbnRyb2xUeXBlOiAndGV4dCcsXG4gICAgICAgICAgICBmbjogZnVuY3Rpb24gKHYsIGEsIHBhcmVudCwgaW5kZXgsIGFiaWxpdHlNb2RlbCwgYWJpbGl0eSkge1xuICAgICAgICAgICAgICAgIHJldHVybiBhO1xuICAgICAgICAgICAgfSxcbiAgICAgICAgICAgIHJldHVyblByb3BlcnR5OiAnYXR0YWNrc3BlZWQnXG4gICAgICAgIH0sXG4gICAgICAgIHtcbiAgICAgICAgICAgIGF0dHJpYnV0ZU5hbWU6ICdib251c19kYW1hZ2VfcGN0JyxcbiAgICAgICAgICAgIGxhYmVsOiAnVG90YWwgRGFtYWdlJyxcbiAgICAgICAgICAgIGNvbnRyb2xUeXBlOiAndGV4dCcsXG4gICAgICAgICAgICBmbjogZnVuY3Rpb24gKHYsIGEsIHBhcmVudCwgaW5kZXgsIGFiaWxpdHlNb2RlbCwgYWJpbGl0eSkge1xuICAgICAgICAgICAgICAgIHJldHVybiBhO1xuICAgICAgICAgICAgfSxcbiAgICAgICAgICAgIHJldHVyblByb3BlcnR5OiAnZGFtYWdlUmVkdWN0aW9uJ1xuICAgICAgICB9XG4gICAgXSxcbiAgICAnd2l0Y2hfZG9jdG9yX3BhcmFseXppbmdfY2Fzayc6IFtcbiAgICAgICAge1xuICAgICAgICAgICAgbGFiZWw6ICdIZXJvIEJvdW5jZSBDb3VudCcsXG4gICAgICAgICAgICBjb250cm9sVHlwZTogJ2lucHV0J1xuICAgICAgICB9LFxuICAgICAgICB7XG4gICAgICAgICAgICBhdHRyaWJ1dGVOYW1lOiAnaGVyb19kYW1hZ2UnLFxuICAgICAgICAgICAgbGFiZWw6ICdUb3RhbCBEYW1hZ2UnLFxuICAgICAgICAgICAgY29udHJvbFR5cGU6ICd0ZXh0JyxcbiAgICAgICAgICAgIGZuOiBmdW5jdGlvbiAodiwgYSwgcGFyZW50LCBpbmRleCwgYWJpbGl0eU1vZGVsLCBhYmlsaXR5KSB7XG4gICAgICAgICAgICAgICAgdmFyIGJvdW5jZXMgPSBhYmlsaXR5TW9kZWwuZ2V0QWJpbGl0eUF0dHJpYnV0ZVZhbHVlKGFiaWxpdHkuYXR0cmlidXRlcywgJ2JvdW5jZXMnLGFiaWxpdHkubGV2ZWwoKSk7XG4gICAgICAgICAgICAgICAgcmV0dXJuIE1hdGgubWluKE1hdGgubWF4KHYsIDApLCBib3VuY2VzKSphO1xuICAgICAgICAgICAgfVxuICAgICAgICB9LFxuICAgICAgICB7XG4gICAgICAgICAgICBsYWJlbDogJ0NyZWVwIEJvdW5jZSBDb3VudCcsXG4gICAgICAgICAgICBjb250cm9sVHlwZTogJ2lucHV0J1xuICAgICAgICB9LFxuICAgICAgICB7XG4gICAgICAgICAgICBhdHRyaWJ1dGVOYW1lOiAnaGVyb19kYW1hZ2UnLFxuICAgICAgICAgICAgbGFiZWw6ICdDUkVFUCBEQU1BR0U6JyxcbiAgICAgICAgICAgIGlnbm9yZVRvb2x0aXA6IHRydWUsXG4gICAgICAgICAgICBjb250cm9sVHlwZTogJ3RleHQnLFxuICAgICAgICAgICAgZm46IGZ1bmN0aW9uICh2LCBhLCBwYXJlbnQsIGluZGV4LCBhYmlsaXR5TW9kZWwsIGFiaWxpdHkpIHtcbiAgICAgICAgICAgICAgICB2YXIgYm91bmNlcyA9IGFiaWxpdHlNb2RlbC5nZXRBYmlsaXR5QXR0cmlidXRlVmFsdWUoYWJpbGl0eS5hdHRyaWJ1dGVzLCAnYm91bmNlcycsYWJpbGl0eS5sZXZlbCgpKTtcbiAgICAgICAgICAgICAgICB2YXIgZGFtYWdlID0gYWJpbGl0eU1vZGVsLmdldEFiaWxpdHlQcm9wZXJ0eVZhbHVlKGFiaWxpdHksICdkYW1hZ2UnKTtcbiAgICAgICAgICAgICAgICByZXR1cm4gTWF0aC5taW4oTWF0aC5tYXgodiwgMCksIGJvdW5jZXMpKmRhbWFnZTtcbiAgICAgICAgICAgIH1cbiAgICAgICAgfVxuICAgIF0sXG4gICAgJ3dpdGNoX2RvY3Rvcl92b29kb29fcmVzdG9yYXRpb24nOiBbXG4gICAgICAgIHtcbiAgICAgICAgICAgIGxhYmVsOiAnRHVyYXRpb24nLFxuICAgICAgICAgICAgY29udHJvbFR5cGU6ICdpbnB1dCdcbiAgICAgICAgfSxcbiAgICAgICAge1xuICAgICAgICAgICAgYXR0cmlidXRlTmFtZTogJ2hlYWwnLFxuICAgICAgICAgICAgbGFiZWw6ICdUb3RhbCBEYW1hZ2UnLFxuICAgICAgICAgICAgY29udHJvbFR5cGU6ICd0ZXh0JyxcbiAgICAgICAgICAgIGZuOiBmdW5jdGlvbiAodiwgYSwgcGFyZW50LCBpbmRleCwgYWJpbGl0eU1vZGVsLCBhYmlsaXR5KSB7XG4gICAgICAgICAgICAgICAgdmFyIGludGVydmFsID0gYWJpbGl0eU1vZGVsLmdldEFiaWxpdHlBdHRyaWJ1dGVWYWx1ZShhYmlsaXR5LmF0dHJpYnV0ZXMsICdoZWFsX2ludGVydmFsJyxhYmlsaXR5LmxldmVsKCkpO1xuICAgICAgICAgICAgICAgIHZhciBoZWFsX3Blcl90aWNrID0gYSAqIGludGVydmFsO1xuICAgICAgICAgICAgICAgIHZhciB0aWNrcyA9IE1hdGgubWF4KE1hdGguZmxvb3IodiAvIGludGVydmFsKSAtIDEsIDApO1xuICAgICAgICAgICAgICAgIHJldHVybiBoZWFsX3Blcl90aWNrICogdGlja3M7XG4gICAgICAgICAgICB9XG4gICAgICAgIH0sXG4gICAgICAgIHtcbiAgICAgICAgICAgIGF0dHJpYnV0ZU5hbWU6ICdtYW5hX3Blcl9zZWNvbmQnLFxuICAgICAgICAgICAgbGFiZWw6ICdNQU5BIENPU1Q6JyxcbiAgICAgICAgICAgIGlnbm9yZVRvb2x0aXA6IHRydWUsXG4gICAgICAgICAgICBjb250cm9sVHlwZTogJ3RleHQnLFxuICAgICAgICAgICAgZm46IGZ1bmN0aW9uICh2LCBhLCBwYXJlbnQsIGluZGV4LCBhYmlsaXR5TW9kZWwsIGFiaWxpdHkpIHtcbiAgICAgICAgICAgICAgICB2YXIgaW50ZXJ2YWwgPSBhYmlsaXR5TW9kZWwuZ2V0QWJpbGl0eUF0dHJpYnV0ZVZhbHVlKGFiaWxpdHkuYXR0cmlidXRlcywgJ2hlYWxfaW50ZXJ2YWwnLGFiaWxpdHkubGV2ZWwoKSk7XG4gICAgICAgICAgICAgICAgdmFyIG1hbmFfcGVyX3RpY2sgPSBhICogaW50ZXJ2YWw7XG4gICAgICAgICAgICAgICAgdmFyIHRpY2tzID0gTWF0aC5tYXgoTWF0aC5mbG9vcih2IC8gaW50ZXJ2YWwpIC0gMSwgMCk7XG4gICAgICAgICAgICAgICAgcmV0dXJuIG1hbmFfcGVyX3RpY2sgKiB0aWNrcztcbiAgICAgICAgICAgIH1cbiAgICAgICAgfVxuICAgIF0sXG4gICAgJ3dpdGNoX2RvY3Rvcl9tYWxlZGljdCc6IFtcbiAgICAgICAge1xuICAgICAgICAgICAgbGFiZWw6ICdkYW1hZ2UgMC00cycsXG4gICAgICAgICAgICBjb250cm9sVHlwZTogJ2lucHV0J1xuICAgICAgICB9LFxuICAgICAgICB7XG4gICAgICAgICAgICBsYWJlbDogJ2RhbWFnZSA0LThzJyxcbiAgICAgICAgICAgIGNvbnRyb2xUeXBlOiAnaW5wdXQnXG4gICAgICAgIH0sXG4gICAgICAgIHtcbiAgICAgICAgICAgIGxhYmVsOiAnZGFtYWdlIDgtMTJzJyxcbiAgICAgICAgICAgIGNvbnRyb2xUeXBlOiAnaW5wdXQnXG4gICAgICAgIH0sXG4gICAgICAgIHtcbiAgICAgICAgICAgIGF0dHJpYnV0ZU5hbWU6ICdib251c19kYW1hZ2UnLFxuICAgICAgICAgICAgbGFiZWw6ICdEb3QgRGFtYWdlIGFmdGVyIDNzOicsXG4gICAgICAgICAgICBpZ25vcmVUb29sdGlwOiB0cnVlLFxuICAgICAgICAgICAgY29udHJvbFR5cGU6ICdtZXRob2QnLFxuICAgICAgICAgICAgZm46IGZ1bmN0aW9uICh2LCBhLCBwYXJlbnQsIGluZGV4LCBhYmlsaXR5TW9kZWwsIGFiaWxpdHkpIHtcbiAgICAgICAgICAgICAgICB2YXIgZGFtYWdlID0gYWJpbGl0eU1vZGVsLmdldEFiaWxpdHlQcm9wZXJ0eVZhbHVlKGFiaWxpdHksICdkYW1hZ2UnKTtcbiAgICAgICAgICAgICAgICByZXR1cm4gMypkYW1hZ2U7XG4gICAgICAgICAgICB9XG4gICAgICAgIH0sXG4gICAgICAgIHtcbiAgICAgICAgICAgIGF0dHJpYnV0ZU5hbWU6ICdib251c19kYW1hZ2UnLFxuICAgICAgICAgICAgbGFiZWw6ICdCdXJzdCBEYW1hZ2UgYXQgNHM6JyxcbiAgICAgICAgICAgIGlnbm9yZVRvb2x0aXA6IHRydWUsXG4gICAgICAgICAgICBjb250cm9sVHlwZTogJ21ldGhvZCcsXG4gICAgICAgICAgICBjb250cm9sczogWzAsIDNdLFxuICAgICAgICAgICAgZm46IGZ1bmN0aW9uICh2LCBhLCBwYXJlbnQsIGluZGV4LCBhYmlsaXR5TW9kZWwsIGFiaWxpdHkpIHtcbiAgICAgICAgICAgICAgICB2YXIgZGFtYWdlID0gYWJpbGl0eU1vZGVsLmdldEFiaWxpdHlQcm9wZXJ0eVZhbHVlKGFiaWxpdHksICdkYW1hZ2UnKTtcbiAgICAgICAgICAgICAgICB2YXIgZCA9IHYucmVkdWNlKGZ1bmN0aW9uIChtZW1vLCBvKSB7IHJldHVybiBtZW1vICsgbyB9LCAwKTtcbiAgICAgICAgICAgICAgICByZXR1cm4gTWF0aC5tYXgoZCwgMCkgKiBhLzEwMDtcbiAgICAgICAgICAgIH1cbiAgICAgICAgfSxcbiAgICAgICAge1xuICAgICAgICAgICAgYXR0cmlidXRlTmFtZTogJ2JvbnVzX2RhbWFnZScsXG4gICAgICAgICAgICBsYWJlbDogJ0RvdCBEYW1hZ2UgYWZ0ZXIgN3M6JyxcbiAgICAgICAgICAgIGlnbm9yZVRvb2x0aXA6IHRydWUsXG4gICAgICAgICAgICBjb250cm9sVHlwZTogJ21ldGhvZCcsXG4gICAgICAgICAgICBmbjogZnVuY3Rpb24gKHYsIGEsIHBhcmVudCwgaW5kZXgsIGFiaWxpdHlNb2RlbCwgYWJpbGl0eSkge1xuICAgICAgICAgICAgICAgIHZhciBkYW1hZ2UgPSBhYmlsaXR5TW9kZWwuZ2V0QWJpbGl0eVByb3BlcnR5VmFsdWUoYWJpbGl0eSwgJ2RhbWFnZScpO1xuICAgICAgICAgICAgICAgIHJldHVybiA3KmRhbWFnZTtcbiAgICAgICAgICAgIH1cbiAgICAgICAgfSxcbiAgICAgICAge1xuICAgICAgICAgICAgYXR0cmlidXRlTmFtZTogJ2JvbnVzX2RhbWFnZScsXG4gICAgICAgICAgICBsYWJlbDogJ0J1cnN0IERhbWFnZSBhdCA4czonLFxuICAgICAgICAgICAgaWdub3JlVG9vbHRpcDogdHJ1ZSxcbiAgICAgICAgICAgIGNvbnRyb2xUeXBlOiAnbWV0aG9kJyxcbiAgICAgICAgICAgIGNvbnRyb2xzOiBbMCwgMSwgNCwgNV0sXG4gICAgICAgICAgICBmbjogZnVuY3Rpb24gKHYsIGEsIHBhcmVudCwgaW5kZXgsIGFiaWxpdHlNb2RlbCwgYWJpbGl0eSkge1xuICAgICAgICAgICAgICAgIHZhciBkYW1hZ2UgPSBhYmlsaXR5TW9kZWwuZ2V0QWJpbGl0eVByb3BlcnR5VmFsdWUoYWJpbGl0eSwgJ2RhbWFnZScpO1xuICAgICAgICAgICAgICAgIHZhciBkID0gdi5yZWR1Y2UoZnVuY3Rpb24gKG1lbW8sIG8pIHsgcmV0dXJuIG1lbW8gKyBvIH0sIDApO1xuICAgICAgICAgICAgICAgIHJldHVybiBNYXRoLm1heChkLCAwKSAqIGEvMTAwO1xuICAgICAgICAgICAgfVxuICAgICAgICB9LFxuICAgICAgICB7XG4gICAgICAgICAgICBhdHRyaWJ1dGVOYW1lOiAnYm9udXNfZGFtYWdlJyxcbiAgICAgICAgICAgIGxhYmVsOiAnRG90IERhbWFnZSBhZnRlciAxMXM6JyxcbiAgICAgICAgICAgIGlnbm9yZVRvb2x0aXA6IHRydWUsXG4gICAgICAgICAgICBjb250cm9sVHlwZTogJ21ldGhvZCcsXG4gICAgICAgICAgICBmbjogZnVuY3Rpb24gKHYsIGEsIHBhcmVudCwgaW5kZXgsIGFiaWxpdHlNb2RlbCwgYWJpbGl0eSkge1xuICAgICAgICAgICAgICAgIHZhciBkYW1hZ2UgPSBhYmlsaXR5TW9kZWwuZ2V0QWJpbGl0eVByb3BlcnR5VmFsdWUoYWJpbGl0eSwgJ2RhbWFnZScpO1xuICAgICAgICAgICAgICAgIHJldHVybiAxMSpkYW1hZ2U7XG4gICAgICAgICAgICB9XG4gICAgICAgIH0sXG4gICAgICAgIHtcbiAgICAgICAgICAgIGF0dHJpYnV0ZU5hbWU6ICdib251c19kYW1hZ2UnLFxuICAgICAgICAgICAgbGFiZWw6ICdCdXJzdCBEYW1hZ2UgYXQgMTJzOicsXG4gICAgICAgICAgICBpZ25vcmVUb29sdGlwOiB0cnVlLFxuICAgICAgICAgICAgY29udHJvbFR5cGU6ICdtZXRob2QnLFxuICAgICAgICAgICAgY29udHJvbHM6IFswLCAxLCAyLCA0LCA2LCA3XSxcbiAgICAgICAgICAgIGZuOiBmdW5jdGlvbiAodiwgYSwgcGFyZW50LCBpbmRleCwgYWJpbGl0eU1vZGVsLCBhYmlsaXR5KSB7XG4gICAgICAgICAgICAgICAgdmFyIGRhbWFnZSA9IGFiaWxpdHlNb2RlbC5nZXRBYmlsaXR5UHJvcGVydHlWYWx1ZShhYmlsaXR5LCAnZGFtYWdlJyk7XG4gICAgICAgICAgICAgICAgdmFyIGQgPSB2LnJlZHVjZShmdW5jdGlvbiAobWVtbywgbykgeyByZXR1cm4gbWVtbyArIG8gfSwgMCk7XG4gICAgICAgICAgICAgICAgcmV0dXJuIE1hdGgubWF4KGQsIDApICogYS8xMDA7XG4gICAgICAgICAgICB9XG4gICAgICAgIH0sXG4gICAgICAgIHtcbiAgICAgICAgICAgIGF0dHJpYnV0ZU5hbWU6ICdib251c19kYW1hZ2UnLFxuICAgICAgICAgICAgbGFiZWw6ICdUb3RhbCBCdXJzdCBEYW1hZ2U6JyxcbiAgICAgICAgICAgIGlnbm9yZVRvb2x0aXA6IHRydWUsXG4gICAgICAgICAgICBjb250cm9sVHlwZTogJ21ldGhvZCcsXG4gICAgICAgICAgICBjb250cm9sczogWzQsIDYsIDhdLFxuICAgICAgICAgICAgZm46IGZ1bmN0aW9uICh2LCBhLCBwYXJlbnQsIGluZGV4LCBhYmlsaXR5TW9kZWwsIGFiaWxpdHkpIHtcbiAgICAgICAgICAgICAgICByZXR1cm4gdi5yZWR1Y2UoZnVuY3Rpb24gKG1lbW8sIG8pIHsgcmV0dXJuIG1lbW8gKyBvIH0sIDApO1xuICAgICAgICAgICAgfVxuICAgICAgICB9LFxuICAgICAgICB7XG4gICAgICAgICAgICBhdHRyaWJ1dGVOYW1lOiAnYm9udXNfZGFtYWdlJyxcbiAgICAgICAgICAgIGxhYmVsOiAnVG90YWwgTWFsZWRpY3QgRGFtYWdlOicsXG4gICAgICAgICAgICBpZ25vcmVUb29sdGlwOiB0cnVlLFxuICAgICAgICAgICAgY29udHJvbFR5cGU6ICdtZXRob2QnLFxuICAgICAgICAgICAgY29udHJvbHM6IFs5XSxcbiAgICAgICAgICAgIGZuOiBmdW5jdGlvbiAodiwgYSwgcGFyZW50LCBpbmRleCwgYWJpbGl0eU1vZGVsLCBhYmlsaXR5KSB7XG4gICAgICAgICAgICAgICAgdmFyIGR1cmF0aW9uID0gYWJpbGl0eU1vZGVsLmdldEFiaWxpdHlBdHRyaWJ1dGVWYWx1ZShhYmlsaXR5LmF0dHJpYnV0ZXMsICdkdXJhdGlvbl90b29sdGlwJywwKTtcbiAgICAgICAgICAgICAgICB2YXIgZGFtYWdlID0gYWJpbGl0eU1vZGVsLmdldEFiaWxpdHlQcm9wZXJ0eVZhbHVlKGFiaWxpdHksICdkYW1hZ2UnKTtcbiAgICAgICAgICAgICAgICByZXR1cm4gZGFtYWdlICogZHVyYXRpb24gKyB2WzBdO1xuICAgICAgICAgICAgfVxuICAgICAgICB9LFxuICAgICAgICB7XG4gICAgICAgICAgICBsYWJlbDogJ0R1cmF0aW9uJyxcbiAgICAgICAgICAgIGNvbnRyb2xUeXBlOiAnaW5wdXQnXG4gICAgICAgIH0sXG4gICAgICAgIHtcbiAgICAgICAgICAgIGF0dHJpYnV0ZU5hbWU6ICdib251c19kYW1hZ2UnLFxuICAgICAgICAgICAgbGFiZWw6ICdET1QgRGFtYWdlJyxcbiAgICAgICAgICAgIGNvbnRyb2xUeXBlOiAndGV4dCcsXG4gICAgICAgICAgICBmbjogZnVuY3Rpb24gKHYsIGEsIHBhcmVudCwgaW5kZXgsIGFiaWxpdHlNb2RlbCwgYWJpbGl0eSkge1xuICAgICAgICAgICAgICAgIHZhciBkdXJhdGlvbiA9IGFiaWxpdHlNb2RlbC5nZXRBYmlsaXR5QXR0cmlidXRlVmFsdWUoYWJpbGl0eS5hdHRyaWJ1dGVzLCAnZHVyYXRpb25fdG9vbHRpcCcsMCk7XG4gICAgICAgICAgICAgICAgcmV0dXJuIGFiaWxpdHlNb2RlbC5nZXRBYmlsaXR5UHJvcGVydHlWYWx1ZShhYmlsaXR5LCAnZGFtYWdlJykqTWF0aC5taW4oTWF0aC5tYXgodiwgMCksIGR1cmF0aW9uKTtcbiAgICAgICAgICAgIH1cbiAgICAgICAgfVxuICAgIF0sXG4gICAgJ3dpdGNoX2RvY3Rvcl9kZWF0aF93YXJkJzogW1xuICAgICAgICB7XG4gICAgICAgICAgICBsYWJlbDogJ0R1cmF0aW9uJyxcbiAgICAgICAgICAgIGNvbnRyb2xUeXBlOiAnaW5wdXQnXG4gICAgICAgIH0sXG4gICAgICAgIHtcbiAgICAgICAgICAgIGF0dHJpYnV0ZU5hbWU6ICdkYW1hZ2UnLFxuICAgICAgICAgICAgbGFiZWw6ICdUb3RhbCBEYW1hZ2UnLFxuICAgICAgICAgICAgY29udHJvbFR5cGU6ICd0ZXh0JyxcbiAgICAgICAgICAgIGZuOiBmdW5jdGlvbiAodiwgYSwgcGFyZW50LCBpbmRleCwgYWJpbGl0eU1vZGVsLCBhYmlsaXR5KSB7XG4gICAgICAgICAgICAgICAgcmV0dXJuIHYqYTtcbiAgICAgICAgICAgIH1cbiAgICAgICAgfVxuICAgIF0sXG4gICAgJ3p1dXNfc3RhdGljX2ZpZWxkJzogW1xuICAgICAgICB7XG4gICAgICAgICAgICBsYWJlbDogJ0VuZW15IEhQJyxcbiAgICAgICAgICAgIGNvbnRyb2xUeXBlOiAnaW5wdXQnXG4gICAgICAgIH0sXG4gICAgICAgIHtcbiAgICAgICAgICAgIGF0dHJpYnV0ZU5hbWU6ICdkYW1hZ2VfaGVhbHRoX3BjdCcsXG4gICAgICAgICAgICBsYWJlbDogJ0RBTUFHRTonLFxuICAgICAgICAgICAgaWdub3JlVG9vbHRpcDogdHJ1ZSxcbiAgICAgICAgICAgIGNvbnRyb2xUeXBlOiAndGV4dCcsXG4gICAgICAgICAgICBmbjogZnVuY3Rpb24gKHYsIGEsIHBhcmVudCwgaW5kZXgsIGFiaWxpdHlNb2RlbCwgYWJpbGl0eSkge1xuICAgICAgICAgICAgICAgIHJldHVybiB2KmEvMTAwO1xuICAgICAgICAgICAgfVxuICAgICAgICB9XG4gICAgXVxufSIsIid1c2Ugc3RyaWN0JztcbnZhciBrbyA9IHJlcXVpcmUoJy4vaGVyb2NhbGNfa25vY2tvdXQnKTtcbiAgICBcbnZhciBteSA9IHJlcXVpcmUoXCIuL2hlcm9jYWxjX2NvcmVcIik7XG5cbm15LnByb3RvdHlwZS5CdWZmT3B0aW9uID0gZnVuY3Rpb24gKGhlcm8sIGFiaWxpdHkpIHtcbiAgICB0aGlzLmJ1ZmZOYW1lID0gYWJpbGl0eTtcbiAgICBpZiAobXkucHJvdG90eXBlLmhlcm9EYXRhWyducGNfZG90YV9oZXJvXycgKyBoZXJvXSA9PSB1bmRlZmluZWQpIHtcbiAgICAgICAgdGhpcy5oZXJvID0gaGVybztcbiAgICAgICAgdGhpcy5hYmlsaXR5RGF0YSA9IG15LnByb3RvdHlwZS5maW5kV2hlcmUobXkucHJvdG90eXBlLnVuaXREYXRhW2hlcm9dLmFiaWxpdGllcywge25hbWU6IGFiaWxpdHl9KVxuICAgICAgICB0aGlzLmJ1ZmZEaXNwbGF5TmFtZSA9IG15LnByb3RvdHlwZS51bml0RGF0YVtoZXJvXS5kaXNwbGF5bmFtZSArICcgLSAnICsgdGhpcy5hYmlsaXR5RGF0YS5kaXNwbGF5bmFtZTtcbiAgICB9XG4gICAgZWxzZSB7XG4gICAgICAgIHRoaXMuaGVybyA9ICducGNfZG90YV9oZXJvXycgKyBoZXJvO1xuICAgICAgICB0aGlzLmFiaWxpdHlEYXRhID0gbXkucHJvdG90eXBlLmZpbmRXaGVyZShteS5wcm90b3R5cGUuaGVyb0RhdGFbJ25wY19kb3RhX2hlcm9fJyArIGhlcm9dLmFiaWxpdGllcywge25hbWU6IGFiaWxpdHl9KVxuICAgICAgICB0aGlzLmJ1ZmZEaXNwbGF5TmFtZSA9IG15LnByb3RvdHlwZS5oZXJvRGF0YVsnbnBjX2RvdGFfaGVyb18nICsgaGVyb10uZGlzcGxheW5hbWUgKyAnIC0gJyArIHRoaXMuYWJpbGl0eURhdGEuZGlzcGxheW5hbWU7ICAgICAgICBcbiAgICAgICAgaWYgKGFiaWxpdHkgPT0gJ3N2ZW5fZ29kc19zdHJlbmd0aCcpIHtcbiAgICAgICAgICAgIHRoaXMuYnVmZkRpc3BsYXlOYW1lICs9ICcgKEF1cmEgZm9yIGFsbGllcyknO1xuICAgICAgICB9XG4gICAgfVxuXG59O1xuXG5teS5wcm90b3R5cGUuSXRlbUJ1ZmZPcHRpb24gPSBmdW5jdGlvbiAoaXRlbSkge1xuICAgIHRoaXMuYnVmZk5hbWUgPSBpdGVtO1xuICAgIGlmIChteS5wcm90b3R5cGUuaGVyb0RhdGFbJ25wY19kb3RhX2hlcm9fJyArIGhlcm9dID09IHVuZGVmaW5lZCkge1xuICAgICAgICB0aGlzLmhlcm8gPSBoZXJvO1xuICAgICAgICB0aGlzLmFiaWxpdHlEYXRhID0gbXkucHJvdG90eXBlLmZpbmRXaGVyZShteS5wcm90b3R5cGUudW5pdERhdGFbaGVyb10uYWJpbGl0aWVzLCB7bmFtZTogaXRlbX0pXG4gICAgICAgIHRoaXMuYnVmZkRpc3BsYXlOYW1lID0gbXkucHJvdG90eXBlLnVuaXREYXRhW2hlcm9dLmRpc3BsYXluYW1lICsgJyAtICcgKyB0aGlzLmFiaWxpdHlEYXRhLmRpc3BsYXluYW1lOyAgICAgICAgXG4gICAgfVxuICAgIGVsc2Uge1xuICAgICAgICB0aGlzLmhlcm8gPSAnbnBjX2RvdGFfaGVyb18nICsgaGVybztcbiAgICAgICAgdGhpcy5hYmlsaXR5RGF0YSA9IG15LnByb3RvdHlwZS5maW5kV2hlcmUobXkucHJvdG90eXBlLmhlcm9EYXRhWyducGNfZG90YV9oZXJvXycgKyBoZXJvXS5hYmlsaXRpZXMsIHtuYW1lOiBpdGVtfSlcbiAgICAgICAgdGhpcy5idWZmRGlzcGxheU5hbWUgPSBteS5wcm90b3R5cGUuaGVyb0RhdGFbJ25wY19kb3RhX2hlcm9fJyArIGhlcm9dLmRpc3BsYXluYW1lICsgJyAtICcgKyB0aGlzLmFiaWxpdHlEYXRhLmRpc3BsYXluYW1lOyAgICAgICAgXG4gICAgfVxuXG59O1xuXG5teS5wcm90b3R5cGUuQnVmZlZpZXdNb2RlbCA9IGZ1bmN0aW9uIChhKSB7XG4gICAgdmFyIHNlbGYgPSBuZXcgbXkucHJvdG90eXBlLkFiaWxpdHlNb2RlbChrby5vYnNlcnZhYmxlQXJyYXkoW10pKTtcbiAgICBzZWxmLmF2YWlsYWJsZUJ1ZmZzID0ga28ub2JzZXJ2YWJsZUFycmF5KG15LnByb3RvdHlwZS5hdmFpbGFibGVCdWZmcyk7XG4gICAgc2VsZi5hdmFpbGFibGVEZWJ1ZmZzID0ga28ub2JzZXJ2YWJsZUFycmF5KG15LnByb3RvdHlwZS5hdmFpbGFibGVEZWJ1ZmZzKTtcbiAgICBzZWxmLnNlbGVjdGVkQnVmZiA9IGtvLm9ic2VydmFibGUoc2VsZi5hdmFpbGFibGVCdWZmcygpWzBdKTtcbiAgICBcbiAgICBzZWxmLmJ1ZmZzID0ga28ub2JzZXJ2YWJsZUFycmF5KFtdKTtcbiAgICBzZWxmLml0ZW1CdWZmcyA9IG5ldyBteS5wcm90b3R5cGUuSW52ZW50b3J5Vmlld01vZGVsKCk7XG4gICAgXG4gICAgc2VsZi5hZGRCdWZmID0gZnVuY3Rpb24gKGRhdGEsIGV2ZW50KSB7XG4gICAgICAgIGlmIChteS5wcm90b3R5cGUuZmluZFdoZXJlKHNlbGYuYnVmZnMoKSwgeyBuYW1lOiBzZWxmLnNlbGVjdGVkQnVmZigpLmJ1ZmZOYW1lIH0pICA9PSB1bmRlZmluZWQpIHtcbiAgICAgICAgICAgIHZhciBhID0gSlNPTi5wYXJzZShKU09OLnN0cmluZ2lmeShzZWxmLnNlbGVjdGVkQnVmZigpLmFiaWxpdHlEYXRhKSk7XG4gICAgICAgICAgICBhLmxldmVsID0ga28ub2JzZXJ2YWJsZSgwKTtcbiAgICAgICAgICAgIGEuaXNBY3RpdmUgPSBrby5vYnNlcnZhYmxlKGZhbHNlKTtcbiAgICAgICAgICAgIGEuaXNEZXRhaWwgPSBrby5vYnNlcnZhYmxlKGZhbHNlKTtcbiAgICAgICAgICAgIGEuYmFzZURhbWFnZSA9IGtvLm9ic2VydmFibGUoMCk7XG4gICAgICAgICAgICBhLmJhc2ggPSBrby5vYnNlcnZhYmxlKDApO1xuICAgICAgICAgICAgYS5iYXNoQm9udXNEYW1hZ2UgPSBrby5vYnNlcnZhYmxlKDApO1xuICAgICAgICAgICAgYS5ib251c0RhbWFnZSA9IGtvLm9ic2VydmFibGUoMCk7XG4gICAgICAgICAgICBhLmJvbnVzRGFtYWdlT3JiID0ga28ub2JzZXJ2YWJsZSgwKTtcbiAgICAgICAgICAgIGEuYm9udXNEYW1hZ2VQY3QgPSBrby5vYnNlcnZhYmxlKDApO1xuICAgICAgICAgICAgYS5ib251c0RhbWFnZVByZWNpc2lvbkF1cmEgPSBrby5vYnNlcnZhYmxlKDApO1xuICAgICAgICAgICAgYS5ib251c0RhbWFnZVJlZHVjdGlvbiA9IGtvLm9ic2VydmFibGUoMCk7XG4gICAgICAgICAgICBhLmJvbnVzSGVhbHRoID0ga28ub2JzZXJ2YWJsZSgwKTtcbiAgICAgICAgICAgIGEuYm9udXNTdHJlbmd0aCA9IGtvLm9ic2VydmFibGUoMCk7XG4gICAgICAgICAgICBhLmJvbnVzU3RyZW5ndGgyID0ga28ub2JzZXJ2YWJsZSgwKTtcbiAgICAgICAgICAgIGEuYm9udXNBZ2lsaXR5ID0ga28ub2JzZXJ2YWJsZSgwKTtcbiAgICAgICAgICAgIGEuYm9udXNBZ2lsaXR5MiA9IGtvLm9ic2VydmFibGUoMCk7XG4gICAgICAgICAgICBhLmJvbnVzSW50ID0ga28ub2JzZXJ2YWJsZSgwKTtcbiAgICAgICAgICAgIGEuYm9udXNBbGxTdGF0c1JlZHVjdGlvbiA9IGtvLm9ic2VydmFibGUoMCk7XG4gICAgICAgICAgICBhLmRhbWFnZUFtcGxpZmljYXRpb24gPSBrby5vYnNlcnZhYmxlKDApO1xuICAgICAgICAgICAgYS5kYW1hZ2VSZWR1Y3Rpb24gPSBrby5vYnNlcnZhYmxlKDApO1xuICAgICAgICAgICAgYS5ldmFzaW9uID0ga28ub2JzZXJ2YWJsZSgwKTtcbiAgICAgICAgICAgIGEubWFnaWNSZXNpc3QgPSBrby5vYnNlcnZhYmxlKDApO1xuICAgICAgICAgICAgYS5tYW5hcmVnZW4gPSBrby5vYnNlcnZhYmxlKDApO1xuICAgICAgICAgICAgYS5tYW5hcmVnZW5yZWR1Y3Rpb24gPSBrby5vYnNlcnZhYmxlKDApO1xuICAgICAgICAgICAgYS5taXNzQ2hhbmNlID0ga28ub2JzZXJ2YWJsZSgwKTtcbiAgICAgICAgICAgIGEubW92ZW1lbnRTcGVlZEZsYXQgPSBrby5vYnNlcnZhYmxlKDApO1xuICAgICAgICAgICAgYS5tb3ZlbWVudFNwZWVkUGN0ID0ga28ub2JzZXJ2YWJsZSgwKTtcbiAgICAgICAgICAgIGEubW92ZW1lbnRTcGVlZFBjdFJlZHVjdGlvbiA9IGtvLm9ic2VydmFibGUoMCk7XG4gICAgICAgICAgICBhLnR1cm5SYXRlUmVkdWN0aW9uID0ga28ub2JzZXJ2YWJsZSgwKTtcbiAgICAgICAgICAgIGEuYXR0YWNrcmFuZ2UgPSBrby5vYnNlcnZhYmxlKDApO1xuICAgICAgICAgICAgYS5hdHRhY2tzcGVlZCA9IGtvLm9ic2VydmFibGUoMCk7XG4gICAgICAgICAgICBhLmF0dGFja3NwZWVkcmVkdWN0aW9uID0ga28ub2JzZXJ2YWJsZSgwKTtcbiAgICAgICAgICAgIGEuYXJtb3IgPSBrby5vYnNlcnZhYmxlKDApO1xuICAgICAgICAgICAgYS5hcm1vclJlZHVjdGlvbiA9IGtvLm9ic2VydmFibGUoMCk7XG4gICAgICAgICAgICBhLmhlYWx0aHJlZ2VuID0ga28ub2JzZXJ2YWJsZSgwKTtcbiAgICAgICAgICAgIGEubGlmZXN0ZWFsID0ga28ub2JzZXJ2YWJsZSgwKTtcbiAgICAgICAgICAgIGEudmlzaW9ubmlnaHQgPSBrby5vYnNlcnZhYmxlKDApO1xuICAgICAgICAgICAgYS52aXNpb25kYXkgPSBrby5vYnNlcnZhYmxlKDApO1xuICAgICAgICAgICAgc3dpdGNoIChhLm5hbWUpIHtcbiAgICAgICAgICAgICAgICBjYXNlICdpbnZva2VyX2NvbGRfc25hcCc6XG4gICAgICAgICAgICAgICAgY2FzZSAnaW52b2tlcl9naG9zdF93YWxrJzpcbiAgICAgICAgICAgICAgICBjYXNlICdpbnZva2VyX3Rvcm5hZG8nOlxuICAgICAgICAgICAgICAgIGNhc2UgJ2ludm9rZXJfZW1wJzpcbiAgICAgICAgICAgICAgICBjYXNlICdpbnZva2VyX2FsYWNyaXR5JzpcbiAgICAgICAgICAgICAgICBjYXNlICdpbnZva2VyX2NoYW9zX21ldGVvcic6XG4gICAgICAgICAgICAgICAgY2FzZSAnaW52b2tlcl9zdW5fc3RyaWtlJzpcbiAgICAgICAgICAgICAgICBjYXNlICdpbnZva2VyX2ZvcmdlX3NwaXJpdCc6XG4gICAgICAgICAgICAgICAgY2FzZSAnaW52b2tlcl9pY2Vfd2FsbCc6XG4gICAgICAgICAgICAgICAgY2FzZSAnaW52b2tlcl9kZWFmZW5pbmdfYmxhc3QnOlxuICAgICAgICAgICAgICAgICAgICBhLmxldmVsKDEpO1xuICAgICAgICAgICAgICAgIGJyZWFrO1xuICAgICAgICAgICAgfVxuICAgICAgICAgICAgc2VsZi5hYmlsaXRpZXMucHVzaChhKTtcbiAgICAgICAgICAgIHNlbGYuYnVmZnMucHVzaCh7IG5hbWU6IHNlbGYuc2VsZWN0ZWRCdWZmKCkuYnVmZk5hbWUsIGhlcm86IHNlbGYuc2VsZWN0ZWRCdWZmKCkuaGVybywgZGF0YTogYSB9KTtcbiAgICAgICAgfVxuICAgIH07XG4gICAgXG4gICAgc2VsZi5yZW1vdmVCdWZmID0gZnVuY3Rpb24gKGRhdGEsIGV2ZW50LCBhYmlsaXR5TmFtZSkge1xuICAgICAgICBpZiAobXkucHJvdG90eXBlLmZpbmRXaGVyZShzZWxmLmJ1ZmZzKCksIHsgbmFtZTogYWJpbGl0eU5hbWUgfSkgICE9IHVuZGVmaW5lZCkge1xuICAgICAgICAgICAgICAgIHNlbGYuYnVmZnMucmVtb3ZlKG15LnByb3RvdHlwZS5maW5kV2hlcmUoc2VsZi5idWZmcygpLCB7IG5hbWU6IGFiaWxpdHlOYW1lIH0pKTtcbiAgICAgICAgICAgICAgICBpZiAoc2VsZi5hYmlsaXR5Q29udHJvbERhdGFbYWJpbGl0eU5hbWVdICE9IHVuZGVmaW5lZCkge1xuICAgICAgICAgICAgICAgICAgICBmb3IgKHZhciBpID0gMDsgaSA8IHNlbGYuYWJpbGl0eUNvbnRyb2xEYXRhW2FiaWxpdHlOYW1lXS5kYXRhLmxlbmd0aDsgaSsrKSB7XG4gICAgICAgICAgICAgICAgICAgICAgICBpZiAoc2VsZi5hYmlsaXR5Q29udHJvbERhdGFbYWJpbGl0eU5hbWVdLmRhdGFbaV0uY29udHJvbFZhbC5kaXNwb3NlICE9IHVuZGVmaW5lZCkge1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgIHNlbGYuYWJpbGl0eUNvbnRyb2xEYXRhW2FiaWxpdHlOYW1lXS5kYXRhW2ldLmNvbnRyb2xWYWwuZGlzcG9zZSgpO1xuICAgICAgICAgICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICAgICAgICAgICAgaWYgKHNlbGYuYWJpbGl0eUNvbnRyb2xEYXRhW2FiaWxpdHlOYW1lXS5kYXRhW2ldLmNsZWFuICE9IHVuZGVmaW5lZCkge1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgIHNlbGYuYWJpbGl0eUNvbnRyb2xEYXRhW2FiaWxpdHlOYW1lXS5kYXRhW2ldLmNsZWFuLmRpc3Bvc2UoKTtcbiAgICAgICAgICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICAgICAgICBzZWxmLmFiaWxpdHlDb250cm9sRGF0YVthYmlsaXR5TmFtZV0gPSB1bmRlZmluZWQ7XG4gICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICAgIGZvciAodmFyIGkgPSAwOyBpIDwgc2VsZi5hYmlsaXRpZXMoKS5sZW5ndGg7IGkrKykge1xuICAgICAgICAgICAgICAgICAgICBpZiAoc2VsZi5hYmlsaXRpZXMoKVtpXS5uYW1lID09IGFiaWxpdHlOYW1lKSB7XG4gICAgICAgICAgICAgICAgICAgICAgICBzZWxmLmFiaWxpdGllcygpW2ldLmxldmVsKDApO1xuICAgICAgICAgICAgICAgICAgICAgICAgc2VsZi5hYmlsaXRpZXMucmVtb3ZlKHNlbGYuYWJpbGl0aWVzKClbaV0pO1xuICAgICAgICAgICAgICAgICAgICAgICAgYnJlYWs7XG4gICAgICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgICB9XG4gICAgICAgIH1cbiAgICB9O1xuICAgIHNlbGYudG9nZ2xlQnVmZiA9IGZ1bmN0aW9uIChpbmRleCwgZGF0YSwgZXZlbnQpIHtcbiAgICAgICAgaWYgKHNlbGYuYnVmZnMoKVtpbmRleCgpXS5kYXRhLmJlaGF2aW9yLmluZGV4T2YoJ0RPVEFfQUJJTElUWV9CRUhBVklPUl9QQVNTSVZFJykgPCAwKSB7XG4gICAgICAgICAgICBpZiAoc2VsZi5idWZmcygpW2luZGV4KCldLmRhdGEuaXNBY3RpdmUoKSkge1xuICAgICAgICAgICAgICAgIHNlbGYuYnVmZnMoKVtpbmRleCgpXS5kYXRhLmlzQWN0aXZlKGZhbHNlKTtcbiAgICAgICAgICAgICAgICBzZWxmLmFiaWxpdGllcygpW2luZGV4KCldLmlzQWN0aXZlKGZhbHNlKTtcbiAgICAgICAgICAgIH1cbiAgICAgICAgICAgIGVsc2Uge1xuICAgICAgICAgICAgICAgIHNlbGYuYnVmZnMoKVtpbmRleCgpXS5kYXRhLmlzQWN0aXZlKHRydWUpO1xuICAgICAgICAgICAgICAgIHNlbGYuYWJpbGl0aWVzKClbaW5kZXgoKV0uaXNBY3RpdmUodHJ1ZSk7XG4gICAgICAgICAgICB9XG4gICAgICAgIH1cbiAgICB9LmJpbmQodGhpcyk7XG5cbiAgICBzZWxmLnRvZ2dsZUJ1ZmZEZXRhaWwgPSBmdW5jdGlvbiAoaW5kZXgsIGRhdGEsIGV2ZW50KSB7XG4gICAgICAgIGlmIChzZWxmLmJ1ZmZzKClbaW5kZXgoKV0uZGF0YS5pc0RldGFpbCgpKSB7XG4gICAgICAgICAgICBzZWxmLmJ1ZmZzKClbaW5kZXgoKV0uZGF0YS5pc0RldGFpbChmYWxzZSk7XG4gICAgICAgIH1cbiAgICAgICAgZWxzZSB7XG4gICAgICAgICAgICBzZWxmLmJ1ZmZzKClbaW5kZXgoKV0uZGF0YS5pc0RldGFpbCh0cnVlKTtcbiAgICAgICAgfVxuICAgIH0uYmluZCh0aGlzKTtcblxuICAgIC8vIE92ZXJyaWRlcyB0aGUgYWJpbGl0eSBtb2R1bGUgZnVuY3Rpb24gdG8gcmVtb3ZlIGF2YWlsYWJsZSBza2lsbCBwb2ludCBjaGVja1xuICAgIHNlbGYubGV2ZWxVcEFiaWxpdHkgPSBmdW5jdGlvbiAoaW5kZXgsIGRhdGEsIGV2ZW50LCBoZXJvKSB7XG4gICAgICAgIGlmIChzZWxmLmFiaWxpdGllcygpW2luZGV4KCldLmxldmVsKCkgPCBoZXJvLmdldEFiaWxpdHlMZXZlbE1heChkYXRhKSkge1xuICAgICAgICAgICAgc3dpdGNoKHNlbGYuYWJpbGl0aWVzKClbaW5kZXgoKV0uYWJpbGl0eXR5cGUpIHtcbiAgICAgICAgICAgICAgICBjYXNlICdET1RBX0FCSUxJVFlfVFlQRV9VTFRJTUFURSc6XG4gICAgICAgICAgICAgICAgICAgIHNlbGYuYWJpbGl0aWVzKClbaW5kZXgoKV0ubGV2ZWwoc2VsZi5hYmlsaXRpZXMoKVtpbmRleCgpXS5sZXZlbCgpICsgMSk7XG4gICAgICAgICAgICAgICAgYnJlYWs7XG4gICAgICAgICAgICAgICAgZGVmYXVsdDpcbiAgICAgICAgICAgICAgICAgICAgc2VsZi5hYmlsaXRpZXMoKVtpbmRleCgpXS5sZXZlbChzZWxmLmFiaWxpdGllcygpW2luZGV4KCldLmxldmVsKCkgKyAxKTtcbiAgICAgICAgICAgICAgICBicmVhaztcbiAgICAgICAgICAgIH1cbiAgICAgICAgICAgIHN3aXRjaCAoc2VsZi5hYmlsaXRpZXMoKVtpbmRleCgpXS5uYW1lKSB7XG4gICAgICAgICAgICAgICAgY2FzZSAnYmVhc3RtYXN0ZXJfY2FsbF9vZl90aGVfd2lsZCc6XG4gICAgICAgICAgICAgICAgY2FzZSAnY2hlbl90ZXN0X29mX2ZhaXRoJzpcbiAgICAgICAgICAgICAgICBjYXNlICdtb3JwaGxpbmdfbW9ycGhfYWdpJzpcbiAgICAgICAgICAgICAgICBjYXNlICdzaGFkb3dfZGVtb25fc2hhZG93X3BvaXNvbic6XG4gICAgICAgICAgICAgICAgICAgIHNlbGYuYWJpbGl0aWVzKClbaW5kZXgoKSArIDFdLmxldmVsKHNlbGYuYWJpbGl0aWVzKClbaW5kZXgoKV0ubGV2ZWwoKSk7XG4gICAgICAgICAgICAgICAgYnJlYWs7XG4gICAgICAgICAgICAgICAgY2FzZSAnbW9ycGhsaW5nX21vcnBoX3N0cic6XG4gICAgICAgICAgICAgICAgICAgIHNlbGYuYWJpbGl0aWVzKClbaW5kZXgoKSAtIDFdLmxldmVsKHNlbGYuYWJpbGl0aWVzKClbaW5kZXgoKV0ubGV2ZWwoKSk7XG4gICAgICAgICAgICAgICAgYnJlYWs7XG4gICAgICAgICAgICAgICAgY2FzZSAna2VlcGVyX29mX3RoZV9saWdodF9zcGlyaXRfZm9ybSc6XG4gICAgICAgICAgICAgICAgICAgIHNlbGYuYWJpbGl0aWVzKClbaW5kZXgoKSAtIDFdLmxldmVsKHNlbGYuYWJpbGl0aWVzKClbaW5kZXgoKV0ubGV2ZWwoKSk7XG4gICAgICAgICAgICAgICAgICAgIHNlbGYuYWJpbGl0aWVzKClbaW5kZXgoKSAtIDJdLmxldmVsKHNlbGYuYWJpbGl0aWVzKClbaW5kZXgoKV0ubGV2ZWwoKSk7XG4gICAgICAgICAgICAgICAgY2FzZSAnbmV2ZXJtb3JlX3NoYWRvd3JhemUxJzpcbiAgICAgICAgICAgICAgICAgICAgc2VsZi5hYmlsaXRpZXMoKVtpbmRleCgpICsgMV0ubGV2ZWwoc2VsZi5hYmlsaXRpZXMoKVtpbmRleCgpXS5sZXZlbCgpKTtcbiAgICAgICAgICAgICAgICAgICAgc2VsZi5hYmlsaXRpZXMoKVtpbmRleCgpICsgMl0ubGV2ZWwoc2VsZi5hYmlsaXRpZXMoKVtpbmRleCgpXS5sZXZlbCgpKTtcbiAgICAgICAgICAgICAgICBicmVhaztcbiAgICAgICAgICAgICAgICBjYXNlICduZXZlcm1vcmVfc2hhZG93cmF6ZTInOlxuICAgICAgICAgICAgICAgICAgICBzZWxmLmFiaWxpdGllcygpW2luZGV4KCkgLSAxXS5sZXZlbChzZWxmLmFiaWxpdGllcygpW2luZGV4KCldLmxldmVsKCkpO1xuICAgICAgICAgICAgICAgICAgICBzZWxmLmFiaWxpdGllcygpW2luZGV4KCkgKyAxXS5sZXZlbChzZWxmLmFiaWxpdGllcygpW2luZGV4KCldLmxldmVsKCkpO1xuICAgICAgICAgICAgICAgIGJyZWFrO1xuICAgICAgICAgICAgICAgIGNhc2UgJ25ldmVybW9yZV9zaGFkb3dyYXplMyc6XG4gICAgICAgICAgICAgICAgICAgIHNlbGYuYWJpbGl0aWVzKClbaW5kZXgoKSAtIDFdLmxldmVsKHNlbGYuYWJpbGl0aWVzKClbaW5kZXgoKV0ubGV2ZWwoKSk7XG4gICAgICAgICAgICAgICAgICAgIHNlbGYuYWJpbGl0aWVzKClbaW5kZXgoKSAtIDJdLmxldmVsKHNlbGYuYWJpbGl0aWVzKClbaW5kZXgoKV0ubGV2ZWwoKSk7XG4gICAgICAgICAgICAgICAgYnJlYWs7XG4gICAgICAgICAgICB9XG4gICAgICAgIH1cbiAgICB9O1xuICAgIHNlbGYubGV2ZWxEb3duQWJpbGl0eSA9IGZ1bmN0aW9uIChpbmRleCwgZGF0YSwgZXZlbnQsIGhlcm8pIHtcbiAgICAgICAgaWYgKHNlbGYuYWJpbGl0aWVzKClbaW5kZXgoKV0ubGV2ZWwoKSA+IDApIHtcbiAgICAgICAgICAgIHNlbGYuYWJpbGl0aWVzKClbaW5kZXgoKV0ubGV2ZWwoc2VsZi5hYmlsaXRpZXMoKVtpbmRleCgpXS5sZXZlbCgpIC0gMSk7XG4gICAgICAgICAgICBzd2l0Y2ggKHNlbGYuYWJpbGl0aWVzKClbaW5kZXgoKV0ubmFtZSkge1xuICAgICAgICAgICAgICAgIGNhc2UgJ2JlYXN0bWFzdGVyX2NhbGxfb2ZfdGhlX3dpbGQnOlxuICAgICAgICAgICAgICAgIGNhc2UgJ2NoZW5fdGVzdF9vZl9mYWl0aCc6XG4gICAgICAgICAgICAgICAgY2FzZSAnbW9ycGhsaW5nX21vcnBoX2FnaSc6XG4gICAgICAgICAgICAgICAgY2FzZSAnc2hhZG93X2RlbW9uX3NoYWRvd19wb2lzb24nOlxuICAgICAgICAgICAgICAgICAgICBzZWxmLmFiaWxpdGllcygpW2luZGV4KCkgKyAxXS5sZXZlbChzZWxmLmFiaWxpdGllcygpW2luZGV4KCldLmxldmVsKCkpO1xuICAgICAgICAgICAgICAgIGJyZWFrO1xuICAgICAgICAgICAgICAgIGNhc2UgJ21vcnBobGluZ19tb3JwaF9zdHInOlxuICAgICAgICAgICAgICAgICAgICBzZWxmLmFiaWxpdGllcygpW2luZGV4KCkgLSAxXS5sZXZlbChzZWxmLmFiaWxpdGllcygpW2luZGV4KCldLmxldmVsKCkpO1xuICAgICAgICAgICAgICAgIGJyZWFrO1xuICAgICAgICAgICAgICAgIGNhc2UgJ2tlZXBlcl9vZl90aGVfbGlnaHRfc3Bpcml0X2Zvcm0nOlxuICAgICAgICAgICAgICAgICAgICBzZWxmLmFiaWxpdGllcygpW2luZGV4KCkgLSAxXS5sZXZlbChzZWxmLmFiaWxpdGllcygpW2luZGV4KCldLmxldmVsKCkpO1xuICAgICAgICAgICAgICAgICAgICBzZWxmLmFiaWxpdGllcygpW2luZGV4KCkgLSAyXS5sZXZlbChzZWxmLmFiaWxpdGllcygpW2luZGV4KCldLmxldmVsKCkpO1xuICAgICAgICAgICAgICAgIGNhc2UgJ25ldmVybW9yZV9zaGFkb3dyYXplMSc6XG4gICAgICAgICAgICAgICAgICAgIHNlbGYuYWJpbGl0aWVzKClbaW5kZXgoKSArIDFdLmxldmVsKHNlbGYuYWJpbGl0aWVzKClbaW5kZXgoKV0ubGV2ZWwoKSk7XG4gICAgICAgICAgICAgICAgICAgIHNlbGYuYWJpbGl0aWVzKClbaW5kZXgoKSArIDJdLmxldmVsKHNlbGYuYWJpbGl0aWVzKClbaW5kZXgoKV0ubGV2ZWwoKSk7XG4gICAgICAgICAgICAgICAgYnJlYWs7XG4gICAgICAgICAgICAgICAgY2FzZSAnbmV2ZXJtb3JlX3NoYWRvd3JhemUyJzpcbiAgICAgICAgICAgICAgICAgICAgc2VsZi5hYmlsaXRpZXMoKVtpbmRleCgpIC0gMV0ubGV2ZWwoc2VsZi5hYmlsaXRpZXMoKVtpbmRleCgpXS5sZXZlbCgpKTtcbiAgICAgICAgICAgICAgICAgICAgc2VsZi5hYmlsaXRpZXMoKVtpbmRleCgpICsgMV0ubGV2ZWwoc2VsZi5hYmlsaXRpZXMoKVtpbmRleCgpXS5sZXZlbCgpKTtcbiAgICAgICAgICAgICAgICBicmVhaztcbiAgICAgICAgICAgICAgICBjYXNlICduZXZlcm1vcmVfc2hhZG93cmF6ZTMnOlxuICAgICAgICAgICAgICAgICAgICBzZWxmLmFiaWxpdGllcygpW2luZGV4KCkgLSAxXS5sZXZlbChzZWxmLmFiaWxpdGllcygpW2luZGV4KCldLmxldmVsKCkpO1xuICAgICAgICAgICAgICAgICAgICBzZWxmLmFiaWxpdGllcygpW2luZGV4KCkgLSAyXS5sZXZlbChzZWxmLmFiaWxpdGllcygpW2luZGV4KCldLmxldmVsKCkpO1xuICAgICAgICAgICAgICAgIGJyZWFrO1xuICAgICAgICAgICAgICAgIGNhc2UgJ2VtYmVyX3NwaXJpdF9maXJlX3JlbW5hbnQnOlxuICAgICAgICAgICAgICAgICAgICBzZWxmLmFiaWxpdGllcygpW2luZGV4KCkgLSAxXS5sZXZlbChzZWxmLmFiaWxpdGllcygpW2luZGV4KCldLmxldmVsKCkpO1xuICAgICAgICAgICAgICAgIGJyZWFrO1xuICAgICAgICAgICAgICAgIGNhc2UgJ2xvbmVfZHJ1aWRfdHJ1ZV9mb3JtJzpcbiAgICAgICAgICAgICAgICAgICAgc2VsZi5hYmlsaXRpZXMoKVtpbmRleCgpIC0gMV0ubGV2ZWwoc2VsZi5hYmlsaXRpZXMoKVtpbmRleCgpXS5sZXZlbCgpKTtcbiAgICAgICAgICAgICAgICBicmVhaztcbiAgICAgICAgICAgIH1cbiAgICAgICAgfVxuICAgIH07XG4gICAgXG4gICAgcmV0dXJuIHNlbGY7XG59IiwiJ3VzZSBzdHJpY3QnO1xucmVxdWlyZSgnLi9wb2x5ZmlsbCcpO1xuXG5mdW5jdGlvbiBIRVJPQ0FMQ1VMQVRPUiAoKSB7XG4gICAvLyAuLi5cbn1cblxudmFyIG15ID0gSEVST0NBTENVTEFUT1I7XG5cbm15LnByb3RvdHlwZS5oZXJvRGF0YSA9IHt9O1xubXkucHJvdG90eXBlLml0ZW1EYXRhID0ge307XG5teS5wcm90b3R5cGUudW5pdERhdGEgPSB7fTtcbm15LnByb3RvdHlwZS5hYmlsaXR5RGF0YSA9IHt9O1xuXG5teS5wcm90b3R5cGUuSGVyb09wdGlvbnMgPSBbXTtcblxubXkucHJvdG90eXBlLkhlcm9PcHRpb24gPSBmdW5jdGlvbiAobmFtZSwgZGlzcGxheW5hbWUsIGhlcm8pIHtcbiAgICB0aGlzLmhlcm9OYW1lID0gbmFtZTtcbiAgICB0aGlzLmhlcm9EaXNwbGF5TmFtZSA9IGRpc3BsYXluYW1lO1xuICAgIHRoaXMuaGVybyA9IGhlcm87XG59O1xuXG5teS5wcm90b3R5cGUuaWRDb3VudGVyID0gMDtcbm15LnByb3RvdHlwZS51bmlxdWVJZCA9IGZ1bmN0aW9uIChwcmVmaXgpIHtcbiAgICB2YXIgaWQgPSArK215LnByb3RvdHlwZS5pZENvdW50ZXIgKyAnJztcbiAgICByZXR1cm4gcHJlZml4ID8gcHJlZml4ICsgaWQgOiBpZDtcbn07XG5teS5wcm90b3R5cGUuZmluZFdoZXJlID0gZnVuY3Rpb24gKGFyciwgb2JqKSB7XG4gICAgYXJyTG9vcDogZm9yICh2YXIgaSA9IDA7IGkgPCBhcnIubGVuZ3RoOyBpKyspIHtcbiAgICAgICAgb2JqTG9vcDogZm9yICh2YXIga2V5IGluIG9iaikge1xuICAgICAgICAgICAgaWYgKGFycltpXVtrZXldICE9IG9ialtrZXldKSB7XG4gICAgICAgICAgICAgICAgY29udGludWUgYXJyTG9vcDtcbiAgICAgICAgICAgIH1cbiAgICAgICAgfVxuICAgICAgICByZXR1cm4gYXJyW2ldO1xuICAgIH1cbn1cbm15LnByb3RvdHlwZS51bmlxdWVzID0gZnVuY3Rpb24gKGFycikge1xuICAgIHZhciBhID0gW107XG4gICAgZm9yICh2YXIgaT0wLCBsPWFyci5sZW5ndGg7IGk8bDsgaSsrKVxuICAgICAgICBpZiAoYS5pbmRleE9mKGFycltpXSkgPT09IC0xICYmIGFycltpXSAhPT0gJycpXG4gICAgICAgICAgICBhLnB1c2goYXJyW2ldKTtcbiAgICByZXR1cm4gYTtcbn1cbm15LnByb3RvdHlwZS51bmlvbiA9IGZ1bmN0aW9uIChhLCBiKSB7XG4gICAgdmFyIGFyciA9IGEuY29uY2F0KGIpO1xuICAgIHJldHVybiBteS5wcm90b3R5cGUudW5pcXVlcyhhcnIpO1xufVxuXG5teS5wcm90b3R5cGUudG90YWxSZXNvdXJjZXMgPSAzO1xubXkucHJvdG90eXBlLm51bVJlc291cmNlc0xvYWRlZCA9IDA7XG5teS5wcm90b3R5cGUub25SZXNvdXJjZUxvYWRlZCA9IGZ1bmN0aW9uIChjYWxsYmFjaykge1xuICAgIG15LnByb3RvdHlwZS5udW1SZXNvdXJjZXNMb2FkZWQrKztcbiAgICBpZiAobXkucHJvdG90eXBlLm51bVJlc291cmNlc0xvYWRlZCA9PSBteS5wcm90b3R5cGUudG90YWxSZXNvdXJjZXMpIHtcbiAgICAgICAgXG4gICAgICAgIG15LnByb3RvdHlwZS5hdmFpbGFibGVCdWZmcyA9IFtcbiAgICAgICAgICAgIG5ldyBteS5wcm90b3R5cGUuQnVmZk9wdGlvbignYWJhZGRvbicsICdhYmFkZG9uX2Zyb3N0bW91cm5lJyksXG4gICAgICAgICAgICBuZXcgbXkucHJvdG90eXBlLkJ1ZmZPcHRpb24oJ2F4ZScsICdheGVfY3VsbGluZ19ibGFkZScpLFxuICAgICAgICAgICAgbmV3IG15LnByb3RvdHlwZS5CdWZmT3B0aW9uKCdiZWFzdG1hc3RlcicsICdiZWFzdG1hc3Rlcl9pbm5lcl9iZWFzdCcpLFxuICAgICAgICAgICAgbmV3IG15LnByb3RvdHlwZS5CdWZmT3B0aW9uKCdibG9vZHNlZWtlcicsICdibG9vZHNlZWtlcl9ibG9vZHJhZ2UnKSxcbiAgICAgICAgICAgIG5ldyBteS5wcm90b3R5cGUuQnVmZk9wdGlvbignYm91bnR5X2h1bnRlcicsICdib3VudHlfaHVudGVyX3RyYWNrJyksXG4gICAgICAgICAgICBuZXcgbXkucHJvdG90eXBlLkJ1ZmZPcHRpb24oJ2NlbnRhdXInLCAnY2VudGF1cl9zdGFtcGVkZScpLFxuICAgICAgICAgICAgbmV3IG15LnByb3RvdHlwZS5CdWZmT3B0aW9uKCdjcnlzdGFsX21haWRlbicsICdjcnlzdGFsX21haWRlbl9icmlsbGlhbmNlX2F1cmEnKSxcbiAgICAgICAgICAgIG5ldyBteS5wcm90b3R5cGUuQnVmZk9wdGlvbignZGFya19zZWVyJywgJ2Rhcmtfc2Vlcl9zdXJnZScpLFxuICAgICAgICAgICAgbmV3IG15LnByb3RvdHlwZS5CdWZmT3B0aW9uKCdkYXp6bGUnLCAnZGF6emxlX3dlYXZlJyksXG4gICAgICAgICAgICBuZXcgbXkucHJvdG90eXBlLkJ1ZmZPcHRpb24oJ2Ryb3dfcmFuZ2VyJywgJ2Ryb3dfcmFuZ2VyX3RydWVzaG90JyksXG4gICAgICAgICAgICBuZXcgbXkucHJvdG90eXBlLkJ1ZmZPcHRpb24oJ2ludm9rZXInLCAnaW52b2tlcl9hbGFjcml0eScpLFxuICAgICAgICAgICAgbmV3IG15LnByb3RvdHlwZS5CdWZmT3B0aW9uKCd3aXNwJywgJ3dpc3BfdGV0aGVyJyksXG4gICAgICAgICAgICBuZXcgbXkucHJvdG90eXBlLkJ1ZmZPcHRpb24oJ3dpc3AnLCAnd2lzcF9vdmVyY2hhcmdlJyksXG4gICAgICAgICAgICBuZXcgbXkucHJvdG90eXBlLkJ1ZmZPcHRpb24oJ2t1bmtrYScsICdrdW5ra2FfZ2hvc3RzaGlwJyksXG4gICAgICAgICAgICBuZXcgbXkucHJvdG90eXBlLkJ1ZmZPcHRpb24oJ2xpY2gnLCAnbGljaF9mcm9zdF9hcm1vcicpLFxuICAgICAgICAgICAgbmV3IG15LnByb3RvdHlwZS5CdWZmT3B0aW9uKCdsaWZlX3N0ZWFsZXInLCAnbGlmZV9zdGVhbGVyX29wZW5fd291bmRzJyksXG4gICAgICAgICAgICBuZXcgbXkucHJvdG90eXBlLkJ1ZmZPcHRpb24oJ2x1bmEnLCAnbHVuYV9sdW5hcl9ibGVzc2luZycpLFxuICAgICAgICAgICAgbmV3IG15LnByb3RvdHlwZS5CdWZmT3B0aW9uKCdseWNhbicsICdseWNhbl9ob3dsJyksXG4gICAgICAgICAgICBuZXcgbXkucHJvdG90eXBlLkJ1ZmZPcHRpb24oJ21hZ25hdGF1cicsICdtYWduYXRhdXJfZW1wb3dlcicpLFxuICAgICAgICAgICAgbmV3IG15LnByb3RvdHlwZS5CdWZmT3B0aW9uKCdtaXJhbmEnLCAnbWlyYW5hX2xlYXAnKSxcbiAgICAgICAgICAgIG5ldyBteS5wcm90b3R5cGUuQnVmZk9wdGlvbignb2dyZV9tYWdpJywgJ29ncmVfbWFnaV9ibG9vZGx1c3QnKSxcbiAgICAgICAgICAgIG5ldyBteS5wcm90b3R5cGUuQnVmZk9wdGlvbignb21uaWtuaWdodCcsICdvbW5pa25pZ2h0X2d1YXJkaWFuX2FuZ2VsJyksXG4gICAgICAgICAgICBuZXcgbXkucHJvdG90eXBlLkJ1ZmZPcHRpb24oJ3J1YmljaycsICdydWJpY2tfbnVsbF9maWVsZCcpLFxuICAgICAgICAgICAgbmV3IG15LnByb3RvdHlwZS5CdWZmT3B0aW9uKCdza2VsZXRvbl9raW5nJywgJ3NrZWxldG9uX2tpbmdfdmFtcGlyaWNfYXVyYScpLFxuICAgICAgICAgICAgbmV3IG15LnByb3RvdHlwZS5CdWZmT3B0aW9uKCdzcGlyaXRfYnJlYWtlcicsICdzcGlyaXRfYnJlYWtlcl9lbXBvd2VyaW5nX2hhc3RlJyksXG4gICAgICAgICAgICBuZXcgbXkucHJvdG90eXBlLkJ1ZmZPcHRpb24oJ3N2ZW4nLCAnc3Zlbl93YXJjcnknKSxcbiAgICAgICAgICAgIG5ldyBteS5wcm90b3R5cGUuQnVmZk9wdGlvbignc3ZlbicsICdzdmVuX2dvZHNfc3RyZW5ndGgnKSxcbiAgICAgICAgICAgIG5ldyBteS5wcm90b3R5cGUuQnVmZk9wdGlvbigndHJlYW50JywgJ3RyZWFudF9saXZpbmdfYXJtb3InKSxcbiAgICAgICAgICAgIG5ldyBteS5wcm90b3R5cGUuQnVmZk9wdGlvbigndHJvbGxfd2FybG9yZCcsICd0cm9sbF93YXJsb3JkX2JhdHRsZV90cmFuY2UnKSxcbiAgICAgICAgICAgIG5ldyBteS5wcm90b3R5cGUuQnVmZk9wdGlvbigndmVuZ2VmdWxzcGlyaXQnLCAndmVuZ2VmdWxzcGlyaXRfY29tbWFuZF9hdXJhJyksXG4gICAgICAgICAgICBuZXcgbXkucHJvdG90eXBlLkJ1ZmZPcHRpb24oJ25wY19kb3RhX25ldXRyYWxfYWxwaGFfd29sZicsICdhbHBoYV93b2xmX2NyaXRpY2FsX3N0cmlrZScpLFxuICAgICAgICAgICAgbmV3IG15LnByb3RvdHlwZS5CdWZmT3B0aW9uKCducGNfZG90YV9uZXV0cmFsX2FscGhhX3dvbGYnLCAnYWxwaGFfd29sZl9jb21tYW5kX2F1cmEnKSxcbiAgICAgICAgICAgIG5ldyBteS5wcm90b3R5cGUuQnVmZk9wdGlvbignbnBjX2RvdGFfbmV1dHJhbF9wb2xhcl9mdXJib2xnX3Vyc2Ffd2FycmlvcicsICdjZW50YXVyX2toYW5fZW5kdXJhbmNlX2F1cmEnKSxcbiAgICAgICAgICAgIG5ldyBteS5wcm90b3R5cGUuQnVmZk9wdGlvbignbnBjX2RvdGFfbmV1dHJhbF9naWFudF93b2xmJywgJ2dpYW50X3dvbGZfY3JpdGljYWxfc3RyaWtlJyksXG4gICAgICAgICAgICBuZXcgbXkucHJvdG90eXBlLkJ1ZmZPcHRpb24oJ25wY19kb3RhX25ldXRyYWxfa29ib2xkX3Rhc2ttYXN0ZXInLCAna29ib2xkX3Rhc2ttYXN0ZXJfc3BlZWRfYXVyYScpLFxuICAgICAgICAgICAgbmV3IG15LnByb3RvdHlwZS5CdWZmT3B0aW9uKCducGNfZG90YV9uZXV0cmFsX29ncmVfbWFnaScsICdvZ3JlX21hZ2lfZnJvc3RfYXJtb3InKSxcbiAgICAgICAgICAgIG5ldyBteS5wcm90b3R5cGUuQnVmZk9wdGlvbignbnBjX2RvdGFfbmV1dHJhbF9zYXR5cl9oZWxsY2FsbGVyJywgJ3NhdHlyX2hlbGxjYWxsZXJfdW5ob2x5X2F1cmEnKSxcbiAgICAgICAgICAgIG5ldyBteS5wcm90b3R5cGUuQnVmZk9wdGlvbignbnBjX2RvdGFfbmV1dHJhbF9lbnJhZ2VkX3dpbGRraW4nLCAnZW5yYWdlZF93aWxka2luX3RvdWdobmVzc19hdXJhJyksXG4gICAgICAgICAgICBuZXcgbXkucHJvdG90eXBlLkJ1ZmZPcHRpb24oJ25wY19kb3RhX25lY3Jvbm9taWNvbl9hcmNoZXJfMScsICduZWNyb25vbWljb25fYXJjaGVyX2FvZScpXG4gICAgICAgIF07XG5cbiAgICAgICAgbXkucHJvdG90eXBlLmF2YWlsYWJsZURlYnVmZnMgPSBbXG4gICAgICAgICAgICBuZXcgbXkucHJvdG90eXBlLkJ1ZmZPcHRpb24oJ2FiYWRkb24nLCAnYWJhZGRvbl9mcm9zdG1vdXJuZScpLFxuICAgICAgICAgICAgbmV3IG15LnByb3RvdHlwZS5CdWZmT3B0aW9uKCdhbGNoZW1pc3QnLCAnYWxjaGVtaXN0X2FjaWRfc3ByYXknKSxcbiAgICAgICAgICAgIG5ldyBteS5wcm90b3R5cGUuQnVmZk9wdGlvbignYW5jaWVudF9hcHBhcml0aW9uJywgJ2FuY2llbnRfYXBwYXJpdGlvbl9pY2Vfdm9ydGV4JyksXG4gICAgICAgICAgICBuZXcgbXkucHJvdG90eXBlLkJ1ZmZPcHRpb24oJ2F4ZScsICdheGVfYmF0dGxlX2h1bmdlcicpLFxuICAgICAgICAgICAgbmV3IG15LnByb3RvdHlwZS5CdWZmT3B0aW9uKCdiYW5lJywgJ2JhbmVfZW5mZWVibGUnKSxcbiAgICAgICAgICAgIG5ldyBteS5wcm90b3R5cGUuQnVmZk9wdGlvbignYmF0cmlkZXInLCAnYmF0cmlkZXJfc3RpY2t5X25hcGFsbScpLFxuICAgICAgICAgICAgbmV3IG15LnByb3RvdHlwZS5CdWZmT3B0aW9uKCdiZWFzdG1hc3RlcicsICdiZWFzdG1hc3Rlcl9wcmltYWxfcm9hcicpLFxuICAgICAgICAgICAgbmV3IG15LnByb3RvdHlwZS5CdWZmT3B0aW9uKCdib3VudHlfaHVudGVyJywgJ2JvdW50eV9odW50ZXJfamluYWRhJyksXG4gICAgICAgICAgICBuZXcgbXkucHJvdG90eXBlLkJ1ZmZPcHRpb24oJ2JyZXdtYXN0ZXInLCAnYnJld21hc3Rlcl90aHVuZGVyX2NsYXAnKSxcbiAgICAgICAgICAgIG5ldyBteS5wcm90b3R5cGUuQnVmZk9wdGlvbignYnJld21hc3RlcicsICdicmV3bWFzdGVyX2RydW5rZW5faGF6ZScpLFxuICAgICAgICAgICAgbmV3IG15LnByb3RvdHlwZS5CdWZmT3B0aW9uKCdicmlzdGxlYmFjaycsICdicmlzdGxlYmFja192aXNjb3VzX25hc2FsX2dvbycpLFxuICAgICAgICAgICAgbmV3IG15LnByb3RvdHlwZS5CdWZmT3B0aW9uKCdicm9vZG1vdGhlcicsICdicm9vZG1vdGhlcl9pbmNhcGFjaXRhdGluZ19iaXRlJyksXG4gICAgICAgICAgICBuZXcgbXkucHJvdG90eXBlLkJ1ZmZPcHRpb24oJ2NlbnRhdXInLCAnY2VudGF1cl9zdGFtcGVkZScpLFxuICAgICAgICAgICAgbmV3IG15LnByb3RvdHlwZS5CdWZmT3B0aW9uKCdjaGVuJywgJ2NoZW5fcGVuaXRlbmNlJyksXG4gICAgICAgICAgICBuZXcgbXkucHJvdG90eXBlLkJ1ZmZPcHRpb24oJ2NyeXN0YWxfbWFpZGVuJywgJ2NyeXN0YWxfbWFpZGVuX2NyeXN0YWxfbm92YScpLFxuICAgICAgICAgICAgbmV3IG15LnByb3RvdHlwZS5CdWZmT3B0aW9uKCdjcnlzdGFsX21haWRlbicsICdjcnlzdGFsX21haWRlbl9mcmVlemluZ19maWVsZCcpLFxuICAgICAgICAgICAgbmV3IG15LnByb3RvdHlwZS5CdWZmT3B0aW9uKCdkYXp6bGUnLCAnZGF6emxlX3dlYXZlJyksXG4gICAgICAgICAgICBuZXcgbXkucHJvdG90eXBlLkJ1ZmZPcHRpb24oJ2Ryb3dfcmFuZ2VyJywgJ2Ryb3dfcmFuZ2VyX2Zyb3N0X2Fycm93cycpLFxuICAgICAgICAgICAgbmV3IG15LnByb3RvdHlwZS5CdWZmT3B0aW9uKCdlYXJ0aF9zcGlyaXQnLCAnZWFydGhfc3Bpcml0X3JvbGxpbmdfYm91bGRlcicpLFxuICAgICAgICAgICAgbmV3IG15LnByb3RvdHlwZS5CdWZmT3B0aW9uKCdlbGRlcl90aXRhbicsICdlbGRlcl90aXRhbl9uYXR1cmFsX29yZGVyJyksXG4gICAgICAgICAgICBuZXcgbXkucHJvdG90eXBlLkJ1ZmZPcHRpb24oJ2VsZGVyX3RpdGFuJywgJ2VsZGVyX3RpdGFuX2VhcnRoX3NwbGl0dGVyJyksXG4gICAgICAgICAgICBuZXcgbXkucHJvdG90eXBlLkJ1ZmZPcHRpb24oJ2VuY2hhbnRyZXNzJywgJ2VuY2hhbnRyZXNzX3VudG91Y2hhYmxlJyksXG4gICAgICAgICAgICBuZXcgbXkucHJvdG90eXBlLkJ1ZmZPcHRpb24oJ2VuY2hhbnRyZXNzJywgJ2VuY2hhbnRyZXNzX2VuY2hhbnQnKSxcbiAgICAgICAgICAgIG5ldyBteS5wcm90b3R5cGUuQnVmZk9wdGlvbignZmFjZWxlc3Nfdm9pZCcsICdmYWNlbGVzc192b2lkX3RpbWVfd2FsaycpLFxuICAgICAgICAgICAgbmV3IG15LnByb3RvdHlwZS5CdWZmT3B0aW9uKCdodXNrYXInLCAnaHVza2FyX2xpZmVfYnJlYWsnKSxcbiAgICAgICAgICAgIG5ldyBteS5wcm90b3R5cGUuQnVmZk9wdGlvbignaW52b2tlcicsICdpbnZva2VyX2dob3N0X3dhbGsnKSxcbiAgICAgICAgICAgIG5ldyBteS5wcm90b3R5cGUuQnVmZk9wdGlvbignaW52b2tlcicsICdpbnZva2VyX2ljZV93YWxsJyksXG4gICAgICAgICAgICBuZXcgbXkucHJvdG90eXBlLkJ1ZmZPcHRpb24oJ3dpc3AnLCAnd2lzcF90ZXRoZXInKSxcbiAgICAgICAgICAgIG5ldyBteS5wcm90b3R5cGUuQnVmZk9wdGlvbignamFraXJvJywgJ2pha2lyb19kdWFsX2JyZWF0aCcpLFxuICAgICAgICAgICAgbmV3IG15LnByb3RvdHlwZS5CdWZmT3B0aW9uKCdqYWtpcm8nLCAnamFraXJvX2xpcXVpZF9maXJlJyksXG4gICAgICAgICAgICBuZXcgbXkucHJvdG90eXBlLkJ1ZmZPcHRpb24oJ2tlZXBlcl9vZl90aGVfbGlnaHQnLCAna2VlcGVyX29mX3RoZV9saWdodF9ibGluZGluZ19saWdodCcpLFxuICAgICAgICAgICAgbmV3IG15LnByb3RvdHlwZS5CdWZmT3B0aW9uKCdrdW5ra2EnLCAna3Vua2thX3RvcnJlbnQnKSxcbiAgICAgICAgICAgIG5ldyBteS5wcm90b3R5cGUuQnVmZk9wdGlvbignbGljaCcsICdsaWNoX2Zyb3N0X25vdmEnKSxcbiAgICAgICAgICAgIG5ldyBteS5wcm90b3R5cGUuQnVmZk9wdGlvbignbGljaCcsICdsaWNoX2Zyb3N0X2FybW9yJyksXG4gICAgICAgICAgICBuZXcgbXkucHJvdG90eXBlLkJ1ZmZPcHRpb24oJ2xpY2gnLCAnbGljaF9jaGFpbl9mcm9zdCcpLFxuICAgICAgICAgICAgbmV3IG15LnByb3RvdHlwZS5CdWZmT3B0aW9uKCdsaWZlX3N0ZWFsZXInLCAnbGlmZV9zdGVhbGVyX29wZW5fd291bmRzJyksXG4gICAgICAgICAgICBuZXcgbXkucHJvdG90eXBlLkJ1ZmZPcHRpb24oJ2xpb24nLCAnbGlvbl92b29kb28nKSxcbiAgICAgICAgICAgIG5ldyBteS5wcm90b3R5cGUuQnVmZk9wdGlvbignbWFnbmF0YXVyJywgJ21hZ25hdGF1cl9za2V3ZXInKSxcbiAgICAgICAgICAgIG5ldyBteS5wcm90b3R5cGUuQnVmZk9wdGlvbignbWVkdXNhJywgJ21lZHVzYV9zdG9uZV9nYXplJyksXG4gICAgICAgICAgICBuZXcgbXkucHJvdG90eXBlLkJ1ZmZPcHRpb24oJ21lZXBvJywgJ21lZXBvX2dlb3N0cmlrZScpLFxuICAgICAgICAgICAgbmV3IG15LnByb3RvdHlwZS5CdWZmT3B0aW9uKCduYWdhX3NpcmVuJywgJ25hZ2Ffc2lyZW5fcmlwX3RpZGUnKSxcbiAgICAgICAgICAgIG5ldyBteS5wcm90b3R5cGUuQnVmZk9wdGlvbignbmlnaHRfc3RhbGtlcicsICduaWdodF9zdGFsa2VyX3ZvaWQnKSxcbiAgICAgICAgICAgIG5ldyBteS5wcm90b3R5cGUuQnVmZk9wdGlvbignbmlnaHRfc3RhbGtlcicsICduaWdodF9zdGFsa2VyX2NyaXBwbGluZ19mZWFyJyksXG4gICAgICAgICAgICBuZXcgbXkucHJvdG90eXBlLkJ1ZmZPcHRpb24oJ25pZ2h0X3N0YWxrZXInLCAnbmlnaHRfc3RhbGtlcl9kYXJrbmVzcycpLFxuICAgICAgICAgICAgbmV3IG15LnByb3RvdHlwZS5CdWZmT3B0aW9uKCdvZ3JlX21hZ2knLCAnb2dyZV9tYWdpX2lnbml0ZScpLFxuICAgICAgICAgICAgbmV3IG15LnByb3RvdHlwZS5CdWZmT3B0aW9uKCdvbW5pa25pZ2h0JywgJ29tbmlrbmlnaHRfZGVnZW5fYXVyYScpLFxuICAgICAgICAgICAgbmV3IG15LnByb3RvdHlwZS5CdWZmT3B0aW9uKCdwaGFudG9tX2Fzc2Fzc2luJywgJ3BoYW50b21fYXNzYXNzaW5fc3RpZmxpbmdfZGFnZ2VyJyksXG4gICAgICAgICAgICBuZXcgbXkucHJvdG90eXBlLkJ1ZmZPcHRpb24oJ3BoYW50b21fbGFuY2VyJywgJ3BoYW50b21fbGFuY2VyX3NwaXJpdF9sYW5jZScpLFxuICAgICAgICAgICAgbmV3IG15LnByb3RvdHlwZS5CdWZmT3B0aW9uKCdwdWRnZScsICdwdWRnZV9yb3QnKSxcbiAgICAgICAgICAgIG5ldyBteS5wcm90b3R5cGUuQnVmZk9wdGlvbigncHVnbmEnLCAncHVnbmFfZGVjcmVwaWZ5JyksXG4gICAgICAgICAgICBuZXcgbXkucHJvdG90eXBlLkJ1ZmZPcHRpb24oJ3F1ZWVub2ZwYWluJywgJ3F1ZWVub2ZwYWluX3NoYWRvd19zdHJpa2UnKSxcbiAgICAgICAgICAgIG5ldyBteS5wcm90b3R5cGUuQnVmZk9wdGlvbigncmlraScsICdyaWtpX3Ntb2tlX3NjcmVlbicpLFxuICAgICAgICAgICAgbmV3IG15LnByb3RvdHlwZS5CdWZmT3B0aW9uKCdydWJpY2snLCAncnViaWNrX2ZhZGVfYm9sdCcpLFxuICAgICAgICAgICAgbmV3IG15LnByb3RvdHlwZS5CdWZmT3B0aW9uKCdzYW5kX2tpbmcnLCAnc2FuZGtpbmdfZXBpY2VudGVyJyksXG4gICAgICAgICAgICBuZXcgbXkucHJvdG90eXBlLkJ1ZmZPcHRpb24oJ25ldmVybW9yZScsICduZXZlcm1vcmVfZGFya19sb3JkJyksXG4gICAgICAgICAgICBuZXcgbXkucHJvdG90eXBlLkJ1ZmZPcHRpb24oJ3NoYWRvd19zaGFtYW4nLCAnc2hhZG93X3NoYW1hbl92b29kb28nKSxcbiAgICAgICAgICAgIG5ldyBteS5wcm90b3R5cGUuQnVmZk9wdGlvbignc2tlbGV0b25fa2luZycsICdza2VsZXRvbl9raW5nX2hlbGxmaXJlX2JsYXN0JyksXG4gICAgICAgICAgICBuZXcgbXkucHJvdG90eXBlLkJ1ZmZPcHRpb24oJ3NrZWxldG9uX2tpbmcnLCAnc2tlbGV0b25fa2luZ19yZWluY2FybmF0aW9uJyksXG4gICAgICAgICAgICBuZXcgbXkucHJvdG90eXBlLkJ1ZmZPcHRpb24oJ3NreXdyYXRoX21hZ2UnLCAnc2t5d3JhdGhfbWFnZV9jb25jdXNzaXZlX3Nob3QnKSxcbiAgICAgICAgICAgIG5ldyBteS5wcm90b3R5cGUuQnVmZk9wdGlvbignc2t5d3JhdGhfbWFnZScsICdza3l3cmF0aF9tYWdlX2FuY2llbnRfc2VhbCcpLFxuICAgICAgICAgICAgbmV3IG15LnByb3RvdHlwZS5CdWZmT3B0aW9uKCdzbGFyZGFyJywgJ3NsYXJkYXJfc2xpdGhlcmVlbl9jcnVzaCcpLFxuICAgICAgICAgICAgbmV3IG15LnByb3RvdHlwZS5CdWZmT3B0aW9uKCdzbGFyZGFyJywgJ3NsYXJkYXJfYW1wbGlmeV9kYW1hZ2UnKSxcbiAgICAgICAgICAgIG5ldyBteS5wcm90b3R5cGUuQnVmZk9wdGlvbignc2xhcmsnLCAnc2xhcmtfZXNzZW5jZV9zaGlmdCcpLFxuICAgICAgICAgICAgbmV3IG15LnByb3RvdHlwZS5CdWZmT3B0aW9uKCdzbmlwZXInLCAnc25pcGVyX3NocmFwbmVsJyksXG4gICAgICAgICAgICBuZXcgbXkucHJvdG90eXBlLkJ1ZmZPcHRpb24oJ3NwZWN0cmUnLCAnc3BlY3RyZV9zcGVjdHJhbF9kYWdnZXInKSxcbiAgICAgICAgICAgIG5ldyBteS5wcm90b3R5cGUuQnVmZk9wdGlvbignc3Rvcm1fc3Bpcml0JywgJ3N0b3JtX3NwaXJpdF9vdmVybG9hZCcpLFxuICAgICAgICAgICAgbmV3IG15LnByb3RvdHlwZS5CdWZmT3B0aW9uKCd0ZW1wbGFyX2Fzc2Fzc2luJywgJ3RlbXBsYXJfYXNzYXNzaW5fbWVsZCcpLFxuICAgICAgICAgICAgbmV3IG15LnByb3RvdHlwZS5CdWZmT3B0aW9uKCd0aWRlaHVudGVyJywgJ3RpZGVodW50ZXJfZ3VzaCcpLFxuICAgICAgICAgICAgbmV3IG15LnByb3RvdHlwZS5CdWZmT3B0aW9uKCd0aW5rZXInLCAndGlua2VyX2xhc2VyJyksXG4gICAgICAgICAgICBuZXcgbXkucHJvdG90eXBlLkJ1ZmZPcHRpb24oJ3RyZWFudCcsICd0cmVhbnRfbGVlY2hfc2VlZCcpLFxuICAgICAgICAgICAgbmV3IG15LnByb3RvdHlwZS5CdWZmT3B0aW9uKCd0dXNrJywgJ3R1c2tfZnJvemVuX3NpZ2lsJyksXG4gICAgICAgICAgICBuZXcgbXkucHJvdG90eXBlLkJ1ZmZPcHRpb24oJ3VuZHlpbmcnLCAndW5keWluZ19mbGVzaF9nb2xlbScpLFxuICAgICAgICAgICAgbmV3IG15LnByb3RvdHlwZS5CdWZmT3B0aW9uKCd1cnNhJywgJ3Vyc2FfZWFydGhzaG9jaycpLFxuICAgICAgICAgICAgbmV3IG15LnByb3RvdHlwZS5CdWZmT3B0aW9uKCd2ZW5nZWZ1bHNwaXJpdCcsICd2ZW5nZWZ1bHNwaXJpdF93YXZlX29mX3RlcnJvcicpLFxuICAgICAgICAgICAgbmV3IG15LnByb3RvdHlwZS5CdWZmT3B0aW9uKCd2ZW5nZWZ1bHNwaXJpdCcsICd2ZW5nZWZ1bHNwaXJpdF9jb21tYW5kX2F1cmEnKSxcbiAgICAgICAgICAgIG5ldyBteS5wcm90b3R5cGUuQnVmZk9wdGlvbigndmVub21hbmNlcicsICd2ZW5vbWFuY2VyX3Zlbm9tb3VzX2dhbGUnKSxcbiAgICAgICAgICAgIG5ldyBteS5wcm90b3R5cGUuQnVmZk9wdGlvbigndmVub21hbmNlcicsICd2ZW5vbWFuY2VyX3BvaXNvbl9zdGluZycpLFxuICAgICAgICAgICAgbmV3IG15LnByb3RvdHlwZS5CdWZmT3B0aW9uKCd2aXBlcicsICd2aXBlcl9wb2lzb25fYXR0YWNrJyksXG4gICAgICAgICAgICBuZXcgbXkucHJvdG90eXBlLkJ1ZmZPcHRpb24oJ3ZpcGVyJywgJ3ZpcGVyX2NvcnJvc2l2ZV9za2luJyksXG4gICAgICAgICAgICBuZXcgbXkucHJvdG90eXBlLkJ1ZmZPcHRpb24oJ3ZpcGVyJywgJ3ZpcGVyX3ZpcGVyX3N0cmlrZScpLFxuICAgICAgICAgICAgbmV3IG15LnByb3RvdHlwZS5CdWZmT3B0aW9uKCd2aXNhZ2UnLCAndmlzYWdlX2dyYXZlX2NoaWxsJyksXG4gICAgICAgICAgICBuZXcgbXkucHJvdG90eXBlLkJ1ZmZPcHRpb24oJ3dhcmxvY2snLCAnd2FybG9ja191cGhlYXZhbCcpLFxuICAgICAgICAgICAgbmV3IG15LnByb3RvdHlwZS5CdWZmT3B0aW9uKCd3ZWF2ZXInLCAnd2VhdmVyX3RoZV9zd2FybScpLFxuICAgICAgICAgICAgbmV3IG15LnByb3RvdHlwZS5CdWZmT3B0aW9uKCd3aW5kcnVubmVyJywgJ3dpbmRydW5uZXJfd2luZHJ1bicpLFxuICAgICAgICAgICAgbmV3IG15LnByb3RvdHlwZS5CdWZmT3B0aW9uKCd3aW50ZXJfd3l2ZXJuJywgJ3dpbnRlcl93eXZlcm5fYXJjdGljX2J1cm4nKSxcbiAgICAgICAgICAgIG5ldyBteS5wcm90b3R5cGUuQnVmZk9wdGlvbignd2ludGVyX3d5dmVybicsICd3aW50ZXJfd3l2ZXJuX3NwbGludGVyX2JsYXN0JyksXG4gICAgICAgICAgICBuZXcgbXkucHJvdG90eXBlLkJ1ZmZPcHRpb24oJ25wY19kb3RhX25ldXRyYWxfZ2hvc3QnLCAnZ2hvc3RfZnJvc3RfYXR0YWNrJyksXG4gICAgICAgICAgICBuZXcgbXkucHJvdG90eXBlLkJ1ZmZPcHRpb24oJ25wY19kb3RhX25ldXRyYWxfcG9sYXJfZnVyYm9sZ191cnNhX3dhcnJpb3InLCAncG9sYXJfZnVyYm9sZ191cnNhX3dhcnJpb3JfdGh1bmRlcl9jbGFwJyksXG4gICAgICAgICAgICBuZXcgbXkucHJvdG90eXBlLkJ1ZmZPcHRpb24oJ25wY19kb3RhX25ldXRyYWxfb2dyZV9tYWdpJywgJ29ncmVfbWFnaV9mcm9zdF9hcm1vcicpLFxuICAgICAgICAgICAgbmV3IG15LnByb3RvdHlwZS5CdWZmT3B0aW9uKCducGNfZG90YV9uZXV0cmFsX3NhdHlyX3RyaWNrc3RlcicsICdzYXR5cl90cmlja3N0ZXJfcHVyZ2UnKSxcbiAgICAgICAgICAgIG5ldyBteS5wcm90b3R5cGUuQnVmZk9wdGlvbignbnBjX2RvdGFfbmV1dHJhbF9lbnJhZ2VkX3dpbGRraW4nLCAnZW5yYWdlZF93aWxka2luX3Rvcm5hZG8nKVxuICAgICAgICBdO1xuICAgICAgICBcbiAgICAgICAgbXkucHJvdG90eXBlLml0ZW1PcHRpb25zQXJyID0gW107XG4gICAgICAgIGZvciAodmFyIGkgPSAwOyBpIDwgbXkucHJvdG90eXBlLnZhbGlkSXRlbXMubGVuZ3RoOyBpKyspIHtcbiAgICAgICAgICAgIG15LnByb3RvdHlwZS5pdGVtT3B0aW9uc0Fyci5wdXNoKG5ldyBteS5wcm90b3R5cGUuSXRlbUlucHV0KG15LnByb3RvdHlwZS52YWxpZEl0ZW1zW2ldLCBteS5wcm90b3R5cGUuaXRlbURhdGFbJ2l0ZW1fJyArIG15LnByb3RvdHlwZS52YWxpZEl0ZW1zW2ldXS5kaXNwbGF5bmFtZSkpO1xuICAgICAgICB9XG4gICAgICAgIFxuICAgICAgICB2YXIgaXRlbUJ1ZmZzID0gWydhc3NhdWx0JywgJ2FuY2llbnRfamFuZ2dvJywgJ2hlYWRkcmVzcycsICdtZWthbnNtJywgJ3BpcGUnLCAncmluZ19vZl9hcXVpbGEnLCAndmxhZG1pcicsICdyaW5nX29mX2Jhc2lsaXVzJywgJ2J1Y2tsZXInLCAnc29sYXJfY3Jlc3QnXTtcbiAgICAgICAgbXkucHJvdG90eXBlLml0ZW1CdWZmT3B0aW9ucyA9IGl0ZW1CdWZmcy5tYXAoZnVuY3Rpb24oaXRlbSkge1xuICAgICAgICAgICAgcmV0dXJuIG5ldyBteS5wcm90b3R5cGUuSXRlbUlucHV0KGl0ZW0sIG15LnByb3RvdHlwZS5pdGVtRGF0YVsnaXRlbV8nICsgaXRlbV0uZGlzcGxheW5hbWUpO1xuICAgICAgICB9KTtcbiAgICAgICAgXG4gICAgICAgIHZhciBpdGVtRGVidWZmcyA9IFtcbiAgICAgICAgICAgIHtpdGVtOiAnYXNzYXVsdCcsIGRlYnVmZjogbnVsbH0sXG4gICAgICAgICAgICB7aXRlbTogJ3NoaXZhc19ndWFyZCcsIGRlYnVmZjogbnVsbH0sXG4gICAgICAgICAgICB7aXRlbTogJ2Rlc29sYXRvcicsIGRlYnVmZjogbnVsbH0sXG4gICAgICAgICAgICB7aXRlbTogJ21lZGFsbGlvbl9vZl9jb3VyYWdlJywgZGVidWZmOiBudWxsfSxcbiAgICAgICAgICAgIHtpdGVtOiAncmFkaWFuY2UnLCBkZWJ1ZmY6IG51bGx9LFxuICAgICAgICAgICAge2l0ZW06ICdzaGVlcHN0aWNrJywgZGVidWZmOiBudWxsfSxcbiAgICAgICAgICAgIHtpdGVtOiAndmVpbF9vZl9kaXNjb3JkJywgZGVidWZmOiBudWxsfSxcbiAgICAgICAgICAgIHtpdGVtOiAnc29sYXJfY3Jlc3QnLCBkZWJ1ZmY6IG51bGx9LFxuICAgICAgICAgICAge2l0ZW06ICdzaWx2ZXJfZWRnZScsIGRlYnVmZjoge2lkOiAnc2hhZG93X3dhbGsnLCBuYW1lOiAnU2hhZG93IFdhbGsnfX0sXG4gICAgICAgICAgICB7aXRlbTogJ3NpbHZlcl9lZGdlJywgZGVidWZmOiB7aWQ6ICdtYWltJywgbmFtZTogJ0xlc3NlciBNYWltJ319XG4gICAgICAgIF1cbiAgICAgICAgbXkucHJvdG90eXBlLml0ZW1EZWJ1ZmZPcHRpb25zID0gaXRlbURlYnVmZnMubWFwKGZ1bmN0aW9uKGl0ZW0pIHtcbiAgICAgICAgICAgIHJldHVybiBuZXcgbXkucHJvdG90eXBlLkl0ZW1JbnB1dChpdGVtLml0ZW0sIG15LnByb3RvdHlwZS5pdGVtRGF0YVsnaXRlbV8nICsgaXRlbS5pdGVtXS5kaXNwbGF5bmFtZSwgaXRlbS5kZWJ1ZmYpO1xuICAgICAgICB9KTtcbiAgICAgICAgaWYgKGNhbGxiYWNrKSBjYWxsYmFjaygpO1xuICAgIH1cbn1cblxubXkucHJvdG90eXBlLmluaXQgPSBmdW5jdGlvbiAoSEVST0RBVEFfUEFUSCxJVEVNREFUQV9QQVRILFVOSVREQVRBX1BBVEgsIGNhbGxiYWNrKSB7XG4gICAgbXkucHJvdG90eXBlLm51bVJlc291cmNlc0xvYWRlZCA9IDA7XG4gICAgbXkucHJvdG90eXBlLmdldEpTT04oSEVST0RBVEFfUEFUSCwgZnVuY3Rpb24gKGRhdGEpIHtcbiAgICAgICAgbXkucHJvdG90eXBlLmhlcm9EYXRhID0gZGF0YTtcbiAgICAgICAgbXkucHJvdG90eXBlLmhlcm9EYXRhWyducGNfZG90YV9oZXJvX2NoZW4nXS5hYmlsaXRpZXNbMl0uYmVoYXZpb3IucHVzaCgnRE9UQV9BQklMSVRZX0JFSEFWSU9SX05PVF9MRUFSTkFCTEUnKTtcbiAgICAgICAgbXkucHJvdG90eXBlLmhlcm9EYXRhWyducGNfZG90YV9oZXJvX25ldmVybW9yZSddLmFiaWxpdGllc1sxXS5iZWhhdmlvci5wdXNoKCdET1RBX0FCSUxJVFlfQkVIQVZJT1JfTk9UX0xFQVJOQUJMRScpO1xuICAgICAgICBteS5wcm90b3R5cGUuaGVyb0RhdGFbJ25wY19kb3RhX2hlcm9fbmV2ZXJtb3JlJ10uYWJpbGl0aWVzWzJdLmJlaGF2aW9yLnB1c2goJ0RPVEFfQUJJTElUWV9CRUhBVklPUl9OT1RfTEVBUk5BQkxFJyk7XG4gICAgICAgIG15LnByb3RvdHlwZS5oZXJvRGF0YVsnbnBjX2RvdGFfaGVyb19tb3JwaGxpbmcnXS5hYmlsaXRpZXNbM10uYmVoYXZpb3IucHVzaCgnRE9UQV9BQklMSVRZX0JFSEFWSU9SX05PVF9MRUFSTkFCTEUnKTtcbiAgICAgICAgbXkucHJvdG90eXBlLmhlcm9EYXRhWyducGNfZG90YV9oZXJvX29ncmVfbWFnaSddLmFiaWxpdGllc1szXS5iZWhhdmlvci5wdXNoKCdET1RBX0FCSUxJVFlfQkVIQVZJT1JfTk9UX0xFQVJOQUJMRScpO1xuICAgICAgICBteS5wcm90b3R5cGUuaGVyb0RhdGFbJ25wY19kb3RhX2hlcm9fdGVjaGllcyddLmFiaWxpdGllc1s0XS5iZWhhdmlvci5wdXNoKCdET1RBX0FCSUxJVFlfQkVIQVZJT1JfTk9UX0xFQVJOQUJMRScpO1xuICAgICAgICBteS5wcm90b3R5cGUuaGVyb0RhdGFbJ25wY19kb3RhX2hlcm9fYmVhc3RtYXN0ZXInXS5hYmlsaXRpZXNbMl0uYmVoYXZpb3IucHVzaCgnRE9UQV9BQklMSVRZX0JFSEFWSU9SX05PVF9MRUFSTkFCTEUnKTtcbiAgICAgICAgdmFyIGluZGV4ID0gbXkucHJvdG90eXBlLmhlcm9EYXRhWyducGNfZG90YV9oZXJvX2xvbmVfZHJ1aWQnXS5hYmlsaXRpZXNbM10uYmVoYXZpb3IuaW5kZXhPZignRE9UQV9BQklMSVRZX0JFSEFWSU9SX0hJRERFTicpO1xuICAgICAgICBteS5wcm90b3R5cGUuaGVyb0RhdGFbJ25wY19kb3RhX2hlcm9fbG9uZV9kcnVpZCddLmFiaWxpdGllc1szXS5iZWhhdmlvci5zcGxpY2UoaW5kZXgsIDEpO1xuICAgICAgICBcbiAgICAgICAgaW5kZXggPSBteS5wcm90b3R5cGUuaGVyb0RhdGFbJ25wY19kb3RhX2hlcm9fYWJhZGRvbiddLmFiaWxpdGllc1syXS5iZWhhdmlvci5pbmRleE9mKCdET1RBX0FCSUxJVFlfQkVIQVZJT1JfUEFTU0lWRScpO1xuICAgICAgICBteS5wcm90b3R5cGUuaGVyb0RhdGFbJ25wY19kb3RhX2hlcm9fYWJhZGRvbiddLmFiaWxpdGllc1syXS5iZWhhdmlvci5zcGxpY2UoaW5kZXgsIDEpO1xuICAgICAgICBcbiAgICAgICAgaW5kZXggPSBteS5wcm90b3R5cGUuaGVyb0RhdGFbJ25wY19kb3RhX2hlcm9fcmlraSddLmFiaWxpdGllc1syXS5iZWhhdmlvci5pbmRleE9mKCdET1RBX0FCSUxJVFlfQkVIQVZJT1JfUEFTU0lWRScpO1xuICAgICAgICBteS5wcm90b3R5cGUuaGVyb0RhdGFbJ25wY19kb3RhX2hlcm9fcmlraSddLmFiaWxpdGllc1syXS5iZWhhdmlvci5zcGxpY2UoaW5kZXgsIDEpO1xuICAgICAgICBcbiAgICAgICAgZm9yICh2YXIgaCBpbiBteS5wcm90b3R5cGUuaGVyb0RhdGEpIHtcbiAgICAgICAgICAgIG15LnByb3RvdHlwZS5IZXJvT3B0aW9ucy5wdXNoKG5ldyBteS5wcm90b3R5cGUuSGVyb09wdGlvbihoLnJlcGxhY2UoJ25wY19kb3RhX2hlcm9fJywgJycpLCBteS5wcm90b3R5cGUuaGVyb0RhdGFbaF0uZGlzcGxheW5hbWUpKTtcbiAgICAgICAgfVxuICAgICAgICAgICAgXG4gICAgICAgIG15LnByb3RvdHlwZS5vblJlc291cmNlTG9hZGVkKGNhbGxiYWNrKTtcbiAgICB9KTtcbiAgICBteS5wcm90b3R5cGUuZ2V0SlNPTihJVEVNREFUQV9QQVRILCBmdW5jdGlvbiAoZGF0YSkge1xuICAgICAgICBteS5wcm90b3R5cGUuaXRlbURhdGEgPSBkYXRhO1xuICAgICAgICBteS5wcm90b3R5cGUub25SZXNvdXJjZUxvYWRlZChjYWxsYmFjayk7XG4gICAgfSk7XG4gICAgbXkucHJvdG90eXBlLmdldEpTT04oVU5JVERBVEFfUEFUSCwgZnVuY3Rpb24gKGRhdGEpIHtcbiAgICAgICAgbXkucHJvdG90eXBlLnVuaXREYXRhID0gZGF0YTtcbiAgICAgICAgbXkucHJvdG90eXBlLm9uUmVzb3VyY2VMb2FkZWQoY2FsbGJhY2spO1xuICAgIH0pO1xufVxuXG5teS5wcm90b3R5cGUuZXh0ZW5kID0gZnVuY3Rpb24gKG91dCkge1xuICAgIG91dCA9IG91dCB8fCB7fTtcblxuICAgIGZvciAodmFyIGkgPSAxOyBpIDwgYXJndW1lbnRzLmxlbmd0aDsgaSsrKSB7XG4gICAgICAgIHZhciBvYmogPSBhcmd1bWVudHNbaV07XG5cbiAgICAgICAgaWYgKCFvYmopXG4gICAgICAgICAgICBjb250aW51ZTtcblxuICAgICAgICBmb3IgKHZhciBrZXkgaW4gb2JqKSB7XG4gICAgICAgICAgICBpZiAob2JqLmhhc093blByb3BlcnR5KGtleSkpIHtcbiAgICAgICAgICAgICAgICBpZiAodHlwZW9mIG9ialtrZXldID09PSAnb2JqZWN0JylcbiAgICAgICAgICAgICAgICAgICAgb3V0W2tleV0gPSBteS5wcm90b3R5cGUuZXh0ZW5kKG91dFtrZXldLCBvYmpba2V5XSk7XG4gICAgICAgICAgICAgICAgZWxzZVxuICAgICAgICAgICAgICAgICAgICBvdXRba2V5XSA9IG9ialtrZXldO1xuICAgICAgICAgICAgfVxuICAgICAgICB9XG4gICAgfVxuXG4gICAgcmV0dXJuIG91dDtcbn07XG5cbm15LnByb3RvdHlwZS5nZXRKU09OID0gZnVuY3Rpb24gKHVybCwgc3VjY2Vzc0NhbGxiYWNrLCBlcnJvckNhbGxiYWNrKSB7XG4gICAgdmFyIHJlcXVlc3QgPSBuZXcgWE1MSHR0cFJlcXVlc3QoKTtcbiAgICByZXF1ZXN0Lm9wZW4oJ0dFVCcsIHVybCwgdHJ1ZSk7XG5cbiAgICByZXF1ZXN0Lm9ubG9hZCA9IGZ1bmN0aW9uKCkge1xuICAgICAgICBpZiAocmVxdWVzdC5zdGF0dXMgPj0gMjAwICYmIHJlcXVlc3Quc3RhdHVzIDwgNDAwKSB7XG4gICAgICAgICAgICAvLyBTdWNjZXNzIVxuICAgICAgICAgICAgdmFyIGRhdGEgPSBKU09OLnBhcnNlKHJlcXVlc3QucmVzcG9uc2VUZXh0KTtcbiAgICAgICAgICAgIHN1Y2Nlc3NDYWxsYmFjayhkYXRhKTtcbiAgICAgICAgfSBlbHNlIHtcbiAgICAgICAgICAgIC8vIFdlIHJlYWNoZWQgb3VyIHRhcmdldCBzZXJ2ZXIsIGJ1dCBpdCByZXR1cm5lZCBhbiBlcnJvclxuICAgICAgICAgICAgZXJyb3JDYWxsYmFjaygpO1xuICAgICAgICB9XG4gICAgfTtcblxuICAgIHJlcXVlc3Qub25lcnJvciA9IGZ1bmN0aW9uKCkge1xuICAgICAgICAvLyBUaGVyZSB3YXMgYSBjb25uZWN0aW9uIGVycm9yIG9mIHNvbWUgc29ydFxuICAgICAgICBlcnJvckNhbGxiYWNrKCk7XG4gICAgfTtcblxuICAgIHJlcXVlc3Quc2VuZCgpO1xufVxubW9kdWxlLmV4cG9ydHMgPSBIRVJPQ0FMQ1VMQVRPUjsiLCIndXNlIHN0cmljdCc7XG52YXIga28gPSByZXF1aXJlKCcuL2hlcm9jYWxjX2tub2Nrb3V0Jyk7XG4gICAgXG52YXIgbXkgPSByZXF1aXJlKFwiLi9oZXJvY2FsY19jb3JlXCIpO1xuXG5teS5wcm90b3R5cGUuaWxsdXNpb25EYXRhID0ge1xuICAgIGNoYW9zX2tuaWdodF9waGFudGFzbToge1xuICAgICAgICBoZXJvOiAnY2hhb3Nfa25pZ2h0JyxcbiAgICAgICAgZGlzcGxheU5hbWU6ICdDaGFvcyBLbmlnaHQgUGhhbnRhc20nLFxuICAgICAgICB1c2Vfc2VsZWN0ZWRfaGVybzogZmFsc2UsXG4gICAgICAgIG1heF9sZXZlbDogMyxcbiAgICAgICAgb3V0Z29pbmdfZGFtYWdlOiAnb3V0Z29pbmdfZGFtYWdlJyxcbiAgICAgICAgaW5jb21pbmdfZGFtYWdlOiAnaW5jb21pbmdfZGFtYWdlJ1xuICAgIH0sXG4gICAgbmFnYV9zaXJlbl9taXJyb3JfaW1hZ2U6IHtcbiAgICAgICAgaGVybzogJ25hZ2Ffc2lyZW4nLFxuICAgICAgICBkaXNwbGF5TmFtZTogJ05hZ2EgU2lyZW4gTWlycm9yIEltYWdlJyxcbiAgICAgICAgdXNlX3NlbGVjdGVkX2hlcm86IGZhbHNlLFxuICAgICAgICBtYXhfbGV2ZWw6IDQsXG4gICAgICAgIG91dGdvaW5nX2RhbWFnZTogJ291dGdvaW5nX2RhbWFnZScsXG4gICAgICAgIGluY29taW5nX2RhbWFnZTogJ2luY29taW5nX2RhbWFnZSdcbiAgICB9LFxuICAgIGRhcmtfc2Vlcl93YWxsX29mX3JlcGxpY2E6IHtcbiAgICAgICAgaGVybzogJ2Rhcmtfc2VlcicsXG4gICAgICAgIGRpc3BsYXlOYW1lOiAnRGFyayBTZWVyIFdhbGwgb2YgUmVwbGljYScsXG4gICAgICAgIHVzZV9zZWxlY3RlZF9oZXJvOiB0cnVlLFxuICAgICAgICBtYXhfbGV2ZWw6IDMsXG4gICAgICAgIG91dGdvaW5nX2RhbWFnZTogJ3JlcGxpY2FfZGFtYWdlX291dGdvaW5nJyxcbiAgICAgICAgaW5jb21pbmdfZGFtYWdlOiAncmVwbGljYV9kYW1hZ2VfaW5jb21pbmcnLFxuICAgICAgICBvdXRnb2luZ19kYW1hZ2Vfc2NlcHRlcjogJ3JlcGxpY2FfZGFtYWdlX291dGdvaW5nX3NjZXB0ZXInXG4gICAgfSxcbiAgICBtb3JwaGxpbmdfcmVwbGljYXRlOiB7XG4gICAgICAgIGhlcm86ICdtb3JwaGxpbmcnLFxuICAgICAgICBkaXNwbGF5TmFtZTogJ01vcnBobGluZyBSZXBsaWNhdGUnLFxuICAgICAgICB1c2Vfc2VsZWN0ZWRfaGVybzogdHJ1ZSxcbiAgICAgICAgbWF4X2xldmVsOiAzLFxuICAgICAgICBvdXRnb2luZ19kYW1hZ2U6ICdpbGx1c2lvbl9kYW1hZ2Vfb3V0X3BjdCcsXG4gICAgICAgIGluY29taW5nX2RhbWFnZTogJ2lsbHVzaW9uX2RhbWFnZV9pbl9wY3QnXG4gICAgfSxcbiAgICBwaGFudG9tX2xhbmNlcl9kb3BwZWx3YWxrOiB7XG4gICAgICAgIGhlcm86ICdwaGFudG9tX2xhbmNlcicsXG4gICAgICAgIGRpc3BsYXlOYW1lOiAnUGhhbnRvbSBMYW5jZXIgRG9wcGVsd2FsaycsXG4gICAgICAgIHVzZV9zZWxlY3RlZF9oZXJvOiBmYWxzZSxcbiAgICAgICAgbWF4X2xldmVsOiA0LFxuICAgICAgICBvdXRnb2luZ19kYW1hZ2U6ICdpbGx1c2lvbl9kYW1hZ2Vfb3V0X3BjdCcsXG4gICAgICAgIGluY29taW5nX2RhbWFnZTogJ2lsbHVzaW9uX2RhbWFnZV9pbl9wY3QnICAgICAgICBcbiAgICB9LFxuICAgIHBoYW50b21fbGFuY2VyX2p1eHRhcG9zZToge1xuICAgICAgICBoZXJvOiAncGhhbnRvbV9sYW5jZXInLFxuICAgICAgICBkaXNwbGF5TmFtZTogJ1BoYW50b20gTGFuY2VyIEp1eHRhcG9zZScsXG4gICAgICAgIHVzZV9zZWxlY3RlZF9oZXJvOiBmYWxzZSxcbiAgICAgICAgbWF4X2xldmVsOiA0LFxuICAgICAgICBvdXRnb2luZ19kYW1hZ2U6ICdpbGx1c2lvbl9kYW1hZ2Vfb3V0X3BjdCcsXG4gICAgICAgIGluY29taW5nX2RhbWFnZTogJ2lsbHVzaW9uX2RhbWFnZV9pbl9wY3QnICAgICAgICBcbiAgICB9LFxuICAgIHBoYW50b21fbGFuY2VyX3NwaXJpdF9sYW5jZToge1xuICAgICAgICBoZXJvOiAncGhhbnRvbV9sYW5jZXInLFxuICAgICAgICBkaXNwbGF5TmFtZTogJ1BoYW50b20gTGFuY2VyIFNwaXJpdCBMYW5jZScsXG4gICAgICAgIHVzZV9zZWxlY3RlZF9oZXJvOiBmYWxzZSxcbiAgICAgICAgbWF4X2xldmVsOiA0LFxuICAgICAgICBvdXRnb2luZ19kYW1hZ2U6ICdpbGx1c2lvbl9kYW1hZ2Vfb3V0X3BjdCcsXG4gICAgICAgIGluY29taW5nX2RhbWFnZTogJ2lsbHVzaW9uX2RhbWFnZV9pbl9wY3QnICAgICAgICBcbiAgICB9LFxuICAgIHNoYWRvd19kZW1vbl9kaXNydXB0aW9uOiB7XG4gICAgICAgIGhlcm86ICdzaGFkb3dfZGVtb24nLFxuICAgICAgICBkaXNwbGF5TmFtZTogJ1NoYWRvdyBEZW1vbiBEaXNydXB0aW9uJyxcbiAgICAgICAgdXNlX3NlbGVjdGVkX2hlcm86IHRydWUsXG4gICAgICAgIG1heF9sZXZlbDogNCxcbiAgICAgICAgb3V0Z29pbmdfZGFtYWdlOiAnaWxsdXNpb25fb3V0Z29pbmdfZGFtYWdlJyxcbiAgICAgICAgaW5jb21pbmdfZGFtYWdlOiAnaWxsdXNpb25faW5jb21pbmdfZGFtYWdlJyAgICAgICAgXG4gICAgfSxcbiAgICBzcGVjdHJlX2hhdW50OiB7XG4gICAgICAgIGhlcm86ICdzcGVjdHJlJyxcbiAgICAgICAgZGlzcGxheU5hbWU6ICdTcGVjdHJlIEhhdW50JyxcbiAgICAgICAgdXNlX3NlbGVjdGVkX2hlcm86IGZhbHNlLFxuICAgICAgICBtYXhfbGV2ZWw6IDMsXG4gICAgICAgIG91dGdvaW5nX2RhbWFnZTogJ2lsbHVzaW9uX2RhbWFnZV9vdXRnb2luZycsXG4gICAgICAgIGluY29taW5nX2RhbWFnZTogJ2lsbHVzaW9uX2RhbWFnZV9pbmNvbWluZycgICAgICAgIFxuICAgIH0sXG4gICAgdGVycm9yYmxhZGVfY29uanVyZV9pbWFnZToge1xuICAgICAgICBoZXJvOiAndGVycm9yYmxhZGUnLFxuICAgICAgICBkaXNwbGF5TmFtZTogJ1RlcnJvcmJsYWRlIENvbmp1cmUgSW1hZ2UnLFxuICAgICAgICB1c2Vfc2VsZWN0ZWRfaGVybzogZmFsc2UsXG4gICAgICAgIG1heF9sZXZlbDogNCxcbiAgICAgICAgb3V0Z29pbmdfZGFtYWdlOiAnaWxsdXNpb25fb3V0Z29pbmdfZGFtYWdlJyxcbiAgICAgICAgaW5jb21pbmdfZGFtYWdlOiAnaWxsdXNpb25faW5jb21pbmdfZGFtYWdlJyAgICAgICAgXG4gICAgfSxcbiAgICB0ZXJyb3JibGFkZV9yZWZsZWN0aW9uOiB7XG4gICAgICAgIGhlcm86ICd0ZXJyb3JibGFkZScsXG4gICAgICAgIGRpc3BsYXlOYW1lOiAnVGVycm9yYmxhZGUgUmVmbGVjdGlvbicsXG4gICAgICAgIHVzZV9zZWxlY3RlZF9oZXJvOiB0cnVlLFxuICAgICAgICBtYXhfbGV2ZWw6IDQsXG4gICAgICAgIG91dGdvaW5nX2RhbWFnZTogJ2lsbHVzaW9uX291dGdvaW5nX2RhbWFnZScgICAgIFxuICAgIH0sXG4gICAgaXRlbV9tYW50YToge1xuICAgICAgICBoZXJvOiAnJyxcbiAgICAgICAgaXNfaXRlbTogdHJ1ZSxcbiAgICAgICAgZGlzcGxheU5hbWU6ICdNYW50YSBTdHlsZSBJbGx1c2lvbicsXG4gICAgICAgIHVzZV9zZWxlY3RlZF9oZXJvOiB0cnVlLFxuICAgICAgICBtYXhfbGV2ZWw6IDEsXG4gICAgICAgIG91dGdvaW5nX2RhbWFnZV9tZWxlZTogJ2ltYWdlc19kb19kYW1hZ2VfcGVyY2VudF9tZWxlZScsXG4gICAgICAgIGluY29taW5nX2RhbWFnZV9tZWxlZTogJ2ltYWdlc190YWtlX2RhbWFnZV9wZXJjZW50X21lbGVlJyxcbiAgICAgICAgb3V0Z29pbmdfZGFtYWdlX3JhbmdlZDogJ2ltYWdlc19kb19kYW1hZ2VfcGVyY2VudF9yYW5nZWQnLFxuICAgICAgICBpbmNvbWluZ19kYW1hZ2VfcmFuZ2VkOiAnaW1hZ2VzX3Rha2VfZGFtYWdlX3BlcmNlbnRfcmFuZ2VkJ1xuICAgIH1cbn1cblxubXkucHJvdG90eXBlLklsbHVzaW9uVmlld01vZGVsID0gZnVuY3Rpb24gKGgsIHAsIGFiaWxpdHlMZXZlbCkge1xuICAgIHZhciBzZWxmID0gbmV3IG15LnByb3RvdHlwZS5IZXJvQ2FsY3VsYXRvck1vZGVsKDApO1xuICAgIHNlbGYucGFyZW50ID0gcDtcbiAgICBzZWxmLmludmVudG9yeSA9IHNlbGYucGFyZW50LmludmVudG9yeTtcbiAgICBzZWxmLmlsbHVzaW9uVHlwZSA9IGtvLm9ic2VydmFibGUoc2VsZi5wYXJlbnQuc2VsZWN0ZWRJbGx1c2lvbigpLmlsbHVzaW9uTmFtZSk7XG4gICAgc2VsZi5pbGx1c2lvbkRpc3BsYXlOYW1lID0ga28ub2JzZXJ2YWJsZShzZWxmLnBhcmVudC5zZWxlY3RlZElsbHVzaW9uKCkuaWxsdXNpb25EaXNwbGF5TmFtZSk7XG4gICAgc2VsZi5pbGx1c2lvbkFiaWxpdHlMZXZlbChhYmlsaXR5TGV2ZWwpO1xuICAgIHNlbGYuaWxsdXNpb25BYmlsaXR5TWF4TGV2ZWwgPSBrby5vYnNlcnZhYmxlKG15LnByb3RvdHlwZS5pbGx1c2lvbkRhdGFbc2VsZi5wYXJlbnQuc2VsZWN0ZWRJbGx1c2lvbigpLmlsbHVzaW9uTmFtZV0ubWF4X2xldmVsKTtcbiAgICBpZiAoIW15LnByb3RvdHlwZS5pbGx1c2lvbkRhdGFbc2VsZi5pbGx1c2lvblR5cGUoKV0udXNlX3NlbGVjdGVkX2hlcm8pIHtcbiAgICAgICAgc2VsZi5zZWxlY3RlZEhlcm8obXkucHJvdG90eXBlLmZpbmRXaGVyZShzZWxmLmF2YWlsYWJsZUhlcm9lcygpLCB7aGVyb05hbWU6IHNlbGYucGFyZW50LnNlbGVjdGVkSWxsdXNpb24oKS5iYXNlSGVyb30pKTtcbiAgICB9XG4gICAgZWxzZSB7XG4gICAgICAgIHNlbGYuc2VsZWN0ZWRIZXJvKHNlbGYucGFyZW50LnNlbGVjdGVkSGVybygpKTtcbiAgICB9XG4gICAgc2VsZi5zZWxlY3RlZEhlcm9MZXZlbChzZWxmLnBhcmVudC5zZWxlY3RlZEhlcm9MZXZlbCgpKTtcbiAgICBzZWxmLmhlcm8gPSBrby5jb21wdXRlZChmdW5jdGlvbigpIHtcbiAgICAgICAgcmV0dXJuIGtvLndyYXAuZnJvbUpTKG15LnByb3RvdHlwZS5oZXJvRGF0YVsnbnBjX2RvdGFfaGVyb18nICsgc2VsZi5zZWxlY3RlZEhlcm8oKS5oZXJvTmFtZV0pO1xuICAgIH0pO1xuICAgIFxuICAgIHNlbGYuYWJpbGl0eSgpLmdldEF0dHJpYnV0ZUJvbnVzTGV2ZWwgPSBzZWxmLnBhcmVudC5hYmlsaXR5KCkuZ2V0QXR0cmlidXRlQm9udXNMZXZlbDtcbiAgICBzZWxmLnRvdGFsQWdpID0ga28uY29tcHV0ZWQoZnVuY3Rpb24gKCkge1xuICAgICAgICByZXR1cm4gKHNlbGYuaGVyb0RhdGEoKS5hdHRyaWJ1dGViYXNlYWdpbGl0eVxuICAgICAgICAgICAgICAgICsgc2VsZi5oZXJvRGF0YSgpLmF0dHJpYnV0ZWFnaWxpdHlnYWluICogKHNlbGYuc2VsZWN0ZWRIZXJvTGV2ZWwoKSAtIDEpIFxuICAgICAgICAgICAgICAgICsgc2VsZi5pbnZlbnRvcnkuZ2V0QXR0cmlidXRlcygnYWdpJykgXG4gICAgICAgICAgICAgICAgKyBzZWxmLmFiaWxpdHkoKS5nZXRBdHRyaWJ1dGVCb251c0xldmVsKCkgKiAyXG4gICAgICAgICAgICAgICAgKyBzZWxmLmFiaWxpdHkoKS5nZXRBZ2lsaXR5KClcbiAgICAgICAgICAgICAgICArIHNlbGYuZW5lbXkoKS5hYmlsaXR5KCkuZ2V0QWxsU3RhdHNSZWR1Y3Rpb24oKVxuICAgICAgICAgICAgICAgICsgc2VsZi5kZWJ1ZmZzLmdldEFsbFN0YXRzUmVkdWN0aW9uKClcbiAgICAgICAgICAgICAgICkudG9GaXhlZCgyKTtcbiAgICB9KTtcbiAgICBzZWxmLmludFN0b2xlbiA9IGtvLm9ic2VydmFibGUoMCkuZXh0ZW5kKHsgbnVtZXJpYzogMCB9KTtcbiAgICBzZWxmLnRvdGFsSW50ID0ga28uY29tcHV0ZWQoZnVuY3Rpb24gKCkge1xuICAgICAgICByZXR1cm4gKHNlbGYuaGVyb0RhdGEoKS5hdHRyaWJ1dGViYXNlaW50ZWxsaWdlbmNlIFxuICAgICAgICAgICAgICAgICsgc2VsZi5oZXJvRGF0YSgpLmF0dHJpYnV0ZWludGVsbGlnZW5jZWdhaW4gKiAoc2VsZi5zZWxlY3RlZEhlcm9MZXZlbCgpIC0gMSkgXG4gICAgICAgICAgICAgICAgKyBzZWxmLmludmVudG9yeS5nZXRBdHRyaWJ1dGVzKCdpbnQnKSBcbiAgICAgICAgICAgICAgICArIHNlbGYuYWJpbGl0eSgpLmdldEF0dHJpYnV0ZUJvbnVzTGV2ZWwoKSAqIDJcbiAgICAgICAgICAgICAgICArIHNlbGYuYWJpbGl0eSgpLmdldEludGVsbGlnZW5jZSgpXG4gICAgICAgICAgICAgICAgKyBzZWxmLmVuZW15KCkuYWJpbGl0eSgpLmdldEFsbFN0YXRzUmVkdWN0aW9uKClcbiAgICAgICAgICAgICAgICArIHNlbGYuZGVidWZmcy5nZXRBbGxTdGF0c1JlZHVjdGlvbigpICsgc2VsZi5pbnRTdG9sZW4oKVxuICAgICAgICAgICAgICAgKS50b0ZpeGVkKDIpO1xuICAgIH0pO1xuICAgIHNlbGYudG90YWxTdHIgPSBrby5jb21wdXRlZChmdW5jdGlvbiAoKSB7XG4gICAgICAgIHJldHVybiAoc2VsZi5oZXJvRGF0YSgpLmF0dHJpYnV0ZWJhc2VzdHJlbmd0aCBcbiAgICAgICAgICAgICAgICArIHNlbGYuaGVyb0RhdGEoKS5hdHRyaWJ1dGVzdHJlbmd0aGdhaW4gKiAoc2VsZi5zZWxlY3RlZEhlcm9MZXZlbCgpIC0gMSkgXG4gICAgICAgICAgICAgICAgKyBzZWxmLmludmVudG9yeS5nZXRBdHRyaWJ1dGVzKCdzdHInKSBcbiAgICAgICAgICAgICAgICArIHNlbGYuYWJpbGl0eSgpLmdldEF0dHJpYnV0ZUJvbnVzTGV2ZWwoKSAqIDJcbiAgICAgICAgICAgICAgICArIHNlbGYuYWJpbGl0eSgpLmdldFN0cmVuZ3RoKClcbiAgICAgICAgICAgICAgICArIHNlbGYuZW5lbXkoKS5hYmlsaXR5KCkuZ2V0QWxsU3RhdHNSZWR1Y3Rpb24oKVxuICAgICAgICAgICAgICAgICsgc2VsZi5kZWJ1ZmZzLmdldEFsbFN0YXRzUmVkdWN0aW9uKClcbiAgICAgICAgICAgICAgICkudG9GaXhlZCgyKTtcbiAgICB9KTtcbiAgICBcbiAgICBzZWxmLmdldEFiaWxpdHlBdHRyaWJ1dGVWYWx1ZSA9IGZ1bmN0aW9uKGhlcm8sIGFiaWxpdHksIGF0dHJpYnV0ZU5hbWUsIGxldmVsKSB7XG4gICAgICAgIGlmIChhYmlsaXR5ID09ICdpdGVtX21hbnRhJykge1xuICAgICAgICAgICAgdmFyIGFiaWxpdHlPYmogPSBteS5wcm90b3R5cGUuaXRlbURhdGFbYWJpbGl0eV07XG4gICAgICAgIH1cbiAgICAgICAgZWxzZSB7XG4gICAgICAgICAgICB2YXIgYWJpbGl0eU9iaiA9IG15LnByb3RvdHlwZS5maW5kV2hlcmUobXkucHJvdG90eXBlLmhlcm9EYXRhWyducGNfZG90YV9oZXJvXycgKyBoZXJvXS5hYmlsaXRpZXMsIHtuYW1lOiBhYmlsaXR5fSk7XG4gICAgICAgIH1cbiAgICAgICAgdmFyIGF0dHJpYnV0ZSA9IG15LnByb3RvdHlwZS5maW5kV2hlcmUoYWJpbGl0eU9iai5hdHRyaWJ1dGVzLCB7bmFtZTogYXR0cmlidXRlTmFtZX0pO1xuICAgICAgICBpZiAobGV2ZWwgPT0gMCkge1xuICAgICAgICAgICAgcmV0dXJuIHBhcnNlRmxvYXQoYXR0cmlidXRlLnZhbHVlWzBdKTtcbiAgICAgICAgfVxuICAgICAgICBlbHNlIGlmIChsZXZlbCA+IGF0dHJpYnV0ZS5sZW5ndGgpIHtcbiAgICAgICAgICAgIHJldHVybiBwYXJzZUZsb2F0KGF0dHJpYnV0ZS52YWx1ZVswXSk7XG4gICAgICAgIH1cbiAgICAgICAgZWxzZSB7XG4gICAgICAgICAgICByZXR1cm4gcGFyc2VGbG9hdChhdHRyaWJ1dGUudmFsdWVbbGV2ZWwgLSAxXSk7XG4gICAgICAgIH1cbiAgICB9XG4gICAgXG4gICAgc2VsZi5nZXRJbmNvbWluZ0RhbWFnZU11bHRpcGxpZXIgPSBmdW5jdGlvbihpbGx1c2lvblR5cGUsIGhhc1NjZXB0ZXIsIGF0dGFja1R5cGUpIHtcbiAgICAgICAgaWYgKGlsbHVzaW9uVHlwZSA9PSAnaXRlbV9tYW50YScpIHtcbiAgICAgICAgICAgIGlmIChhdHRhY2tUeXBlID09ICdET1RBX1VOSVRfQ0FQX01FTEVFX0FUVEFDSycpIHtcbiAgICAgICAgICAgICAgICByZXR1cm4gKDEgKyBzZWxmLmdldEFiaWxpdHlBdHRyaWJ1dGVWYWx1ZShteS5wcm90b3R5cGUuaWxsdXNpb25EYXRhW3NlbGYuaWxsdXNpb25UeXBlKCldLmhlcm8sIHNlbGYuaWxsdXNpb25UeXBlKCksIG15LnByb3RvdHlwZS5pbGx1c2lvbkRhdGFbaWxsdXNpb25UeXBlXS5pbmNvbWluZ19kYW1hZ2VfbWVsZWUsIHNlbGYuaWxsdXNpb25BYmlsaXR5TGV2ZWwoKSkvMTAwKVxuICAgICAgICAgICAgfVxuICAgICAgICAgICAgZWxzZSB7XG4gICAgICAgICAgICAgICAgcmV0dXJuICgxICsgc2VsZi5nZXRBYmlsaXR5QXR0cmlidXRlVmFsdWUobXkucHJvdG90eXBlLmlsbHVzaW9uRGF0YVtzZWxmLmlsbHVzaW9uVHlwZSgpXS5oZXJvLCBzZWxmLmlsbHVzaW9uVHlwZSgpLCBteS5wcm90b3R5cGUuaWxsdXNpb25EYXRhW2lsbHVzaW9uVHlwZV0uaW5jb21pbmdfZGFtYWdlX3JhbmdlZCwgc2VsZi5pbGx1c2lvbkFiaWxpdHlMZXZlbCgpKS8xMDApXG4gICAgICAgICAgICB9XG4gICAgICAgIH1cbiAgICAgICAgZWxzZSB7XG4gICAgICAgICAgICByZXR1cm4gKDEgKyBzZWxmLmdldEFiaWxpdHlBdHRyaWJ1dGVWYWx1ZShteS5wcm90b3R5cGUuaWxsdXNpb25EYXRhW3NlbGYuaWxsdXNpb25UeXBlKCldLmhlcm8sIHNlbGYuaWxsdXNpb25UeXBlKCksIG15LnByb3RvdHlwZS5pbGx1c2lvbkRhdGFbaWxsdXNpb25UeXBlXS5pbmNvbWluZ19kYW1hZ2UsIHNlbGYuaWxsdXNpb25BYmlsaXR5TGV2ZWwoKSkvMTAwKVxuICAgICAgICB9XG4gICAgfVxuICAgIHNlbGYuZ2V0T3V0Z29pbmdEYW1hZ2VNdWx0aXBsaWVyID0gZnVuY3Rpb24oaWxsdXNpb25UeXBlLCBoYXNTY2VwdGVyLCBhdHRhY2tUeXBlKSB7XG4gICAgICAgIGlmIChpbGx1c2lvblR5cGUgPT0gJ2l0ZW1fbWFudGEnKSB7XG4gICAgICAgICAgICBpZiAoYXR0YWNrVHlwZSA9PSAnRE9UQV9VTklUX0NBUF9NRUxFRV9BVFRBQ0snKSB7XG4gICAgICAgICAgICAgICAgcmV0dXJuICgxICsgc2VsZi5nZXRBYmlsaXR5QXR0cmlidXRlVmFsdWUobXkucHJvdG90eXBlLmlsbHVzaW9uRGF0YVtzZWxmLmlsbHVzaW9uVHlwZSgpXS5oZXJvLCBzZWxmLmlsbHVzaW9uVHlwZSgpLCBteS5wcm90b3R5cGUuaWxsdXNpb25EYXRhW2lsbHVzaW9uVHlwZV0ub3V0Z29pbmdfZGFtYWdlX21lbGVlLCBzZWxmLmlsbHVzaW9uQWJpbGl0eUxldmVsKCkpLzEwMCk7XG4gICAgICAgICAgICB9XG4gICAgICAgICAgICBlbHNlIHtcbiAgICAgICAgICAgICAgICByZXR1cm4gKDEgKyBzZWxmLmdldEFiaWxpdHlBdHRyaWJ1dGVWYWx1ZShteS5wcm90b3R5cGUuaWxsdXNpb25EYXRhW3NlbGYuaWxsdXNpb25UeXBlKCldLmhlcm8sIHNlbGYuaWxsdXNpb25UeXBlKCksIG15LnByb3RvdHlwZS5pbGx1c2lvbkRhdGFbaWxsdXNpb25UeXBlXS5vdXRnb2luZ19kYW1hZ2VfcmFuZ2VkLCBzZWxmLmlsbHVzaW9uQWJpbGl0eUxldmVsKCkpLzEwMCk7XG4gICAgICAgICAgICB9XG4gICAgICAgIH1cbiAgICAgICAgZWxzZSB7XG4gICAgICAgICAgICByZXR1cm4gKDEgKyBzZWxmLmdldEFiaWxpdHlBdHRyaWJ1dGVWYWx1ZShteS5wcm90b3R5cGUuaWxsdXNpb25EYXRhW3NlbGYuaWxsdXNpb25UeXBlKCldLmhlcm8sIHNlbGYuaWxsdXNpb25UeXBlKCksIG15LnByb3RvdHlwZS5pbGx1c2lvbkRhdGFbaWxsdXNpb25UeXBlXS5vdXRnb2luZ19kYW1hZ2UsIHNlbGYuaWxsdXNpb25BYmlsaXR5TGV2ZWwoKSkvMTAwKTtcbiAgICAgICAgfVxuICAgIH1cblxuICAgIHNlbGYuYmFzZURhbWFnZSA9IGtvLmNvbXB1dGVkKGZ1bmN0aW9uKCkge1xuICAgICAgICByZXR1cm4gW01hdGguZmxvb3IobXkucHJvdG90eXBlLmhlcm9EYXRhWyducGNfZG90YV9oZXJvXycgKyBzZWxmLnNlbGVjdGVkSGVybygpLmhlcm9OYW1lXS5hdHRhY2tkYW1hZ2VtaW4gKyBzZWxmLnRvdGFsQXR0cmlidXRlKHNlbGYucHJpbWFyeUF0dHJpYnV0ZSgpKSArIHNlbGYuYWJpbGl0eSgpLmdldEJhc2VEYW1hZ2UoKS50b3RhbClcbiAgICAgICAgICAgICAgICAqIHNlbGYuZ2V0T3V0Z29pbmdEYW1hZ2VNdWx0aXBsaWVyKHNlbGYuaWxsdXNpb25UeXBlKCksIGZhbHNlLCBzZWxmLmhlcm8oKS5hdHRhY2t0eXBlKCkpLFxuICAgICAgICAgICAgICAgIE1hdGguZmxvb3IobXkucHJvdG90eXBlLmhlcm9EYXRhWyducGNfZG90YV9oZXJvXycgKyBzZWxmLnNlbGVjdGVkSGVybygpLmhlcm9OYW1lXS5hdHRhY2tkYW1hZ2VtYXggKyBzZWxmLnRvdGFsQXR0cmlidXRlKHNlbGYucHJpbWFyeUF0dHJpYnV0ZSgpKSArIHNlbGYuYWJpbGl0eSgpLmdldEJhc2VEYW1hZ2UoKS50b3RhbClcbiAgICAgICAgICAgICAgICAqIHNlbGYuZ2V0T3V0Z29pbmdEYW1hZ2VNdWx0aXBsaWVyKHNlbGYuaWxsdXNpb25UeXBlKCksIGZhbHNlLCBzZWxmLmhlcm8oKS5hdHRhY2t0eXBlKCkpXTtcbiAgICB9KTtcbiAgICBcbiAgICBzZWxmLmRhbWFnZSA9IGtvLmNvbXB1dGVkKGZ1bmN0aW9uKCkge1xuICAgICAgICByZXR1cm4gW3NlbGYuYmFzZURhbWFnZSgpWzBdLFxuICAgICAgICAgICAgICAgIHNlbGYuYmFzZURhbWFnZSgpWzFdXTtcbiAgICB9KTtcbiAgICBcbiAgICBzZWxmLmVocFBoeXNpY2FsID0ga28uY29tcHV0ZWQoZnVuY3Rpb24oKSB7XG4gICAgICAgIHZhciBlaHAgPSAoc2VsZi5oZWFsdGgoKSAqICgxICsgLjA2ICogc2VsZi50b3RhbEFybW9yUGh5c2ljYWwoKSkpIC8gKDEgLSAoMSAtIChzZWxmLmludmVudG9yeS5nZXRFdmFzaW9uKCkgKiBzZWxmLmFiaWxpdHkoKS5nZXRFdmFzaW9uKCkpKSlcbiAgICAgICAgZWhwICo9IChzZWxmLmludmVudG9yeS5hY3RpdmVJdGVtcygpLnNvbWUoZnVuY3Rpb24oaXRlbSkge3JldHVybiBpdGVtLml0ZW0gPT0gJ21hc2tfb2ZfbWFkbmVzcyc7fSkgPyAoMSAvIDEuMykgOiAxKTtcbiAgICAgICAgZWhwICo9ICgxIC8gc2VsZi5nZXRJbmNvbWluZ0RhbWFnZU11bHRpcGxpZXIoc2VsZi5pbGx1c2lvblR5cGUoKSwgZmFsc2UsIHNlbGYuaGVybygpLmF0dGFja3R5cGUoKSkpO1xuICAgICAgICByZXR1cm4gZWhwLnRvRml4ZWQoMik7XG4gICAgfSk7XG4gICAgc2VsZi5laHBNYWdpY2FsID0ga28uY29tcHV0ZWQoZnVuY3Rpb24oKSB7XG4gICAgICAgIHZhciBlaHAgPSBzZWxmLmhlYWx0aCgpIC8gc2VsZi50b3RhbE1hZ2ljUmVzaXN0YW5jZVByb2R1Y3QoKTtcbiAgICAgICAgZWhwICo9ICgxIC8gc2VsZi5nZXRJbmNvbWluZ0RhbWFnZU11bHRpcGxpZXIoc2VsZi5pbGx1c2lvblR5cGUoKSwgZmFsc2UsIHNlbGYuaGVybygpLmF0dGFja3R5cGUoKSkpO1xuICAgICAgICByZXR1cm4gZWhwLnRvRml4ZWQoMik7XG4gICAgfSk7XG4gICAgXG4gICAgc2VsZi50b3RhbEFybW9yUGh5c2ljYWwgPSBrby5jb21wdXRlZChmdW5jdGlvbigpIHtcbiAgICAgICAgcmV0dXJuIChzZWxmLmVuZW15KCkuYWJpbGl0eSgpLmdldEFybW9yQmFzZVJlZHVjdGlvbigpICogc2VsZi5kZWJ1ZmZzLmdldEFybW9yQmFzZVJlZHVjdGlvbigpICogKG15LnByb3RvdHlwZS5oZXJvRGF0YVsnbnBjX2RvdGFfaGVyb18nICsgc2VsZi5zZWxlY3RlZEhlcm8oKS5oZXJvTmFtZV0uYXJtb3JwaHlzaWNhbCArIHNlbGYudG90YWxBZ2koKSAqIC4xNClcbiAgICAgICAgICAgICAgICArIHNlbGYuYWJpbGl0eSgpLmdldEFybW9yKCkgKyBzZWxmLmVuZW15KCkuYWJpbGl0eSgpLmdldEFybW9yUmVkdWN0aW9uKCkgKyBzZWxmLmJ1ZmZzLmdldEFybW9yKCkgKyBzZWxmLmRlYnVmZnMuZ2V0QXJtb3JSZWR1Y3Rpb24oKSkudG9GaXhlZCgyKTtcbiAgICB9KTtcbiAgICBcbiAgICBzZWxmLmlhcyA9IGtvLmNvbXB1dGVkKGZ1bmN0aW9uKCkge1xuICAgICAgICB2YXIgdmFsID0gcGFyc2VGbG9hdChzZWxmLnRvdGFsQWdpKCkpIFxuICAgICAgICAgICAgICAgICsgc2VsZi5hYmlsaXR5KCkuZ2V0QXR0YWNrU3BlZWQoKSBcbiAgICAgICAgICAgICAgICArIHNlbGYuZW5lbXkoKS5hYmlsaXR5KCkuZ2V0QXR0YWNrU3BlZWRSZWR1Y3Rpb24oKSBcbiAgICAgICAgICAgICAgICArIHNlbGYuYnVmZnMuZ2V0QXR0YWNrU3BlZWQoKSBcbiAgICAgICAgICAgICAgICArIHNlbGYuZGVidWZmcy5nZXRBdHRhY2tTcGVlZFJlZHVjdGlvbigpXG4gICAgICAgICAgICAgICAgKyBzZWxmLnVuaXQoKS5hYmlsaXR5KCkuZ2V0QXR0YWNrU3BlZWQoKTsgXG4gICAgICAgIGlmICh2YWwgPCAtODApIHtcbiAgICAgICAgICAgIHJldHVybiAtODA7XG4gICAgICAgIH1cbiAgICAgICAgZWxzZSBpZiAodmFsID4gNDAwKSB7XG4gICAgICAgICAgICByZXR1cm4gNDAwO1xuICAgICAgICB9XG4gICAgICAgIHJldHVybiB2YWwudG9GaXhlZCgyKTtcbiAgICB9KTtcbiAgICBcbiAgICByZXR1cm4gc2VsZjtcbn0iLCIndXNlIHN0cmljdCc7XG52YXIga28gPSByZXF1aXJlKCcuL2hlcm9jYWxjX2tub2Nrb3V0Jyk7XG5cbnZhciBteSA9IHJlcXVpcmUoXCIuL2hlcm9jYWxjX2NvcmVcIik7XG5yZXF1aXJlKFwiLi9oZXJvY2FsY19oZXJvX2RhbWFnZVwiKTtcblxubXkucHJvdG90eXBlLnRvdGFsRXhwID0gWzAsIDIwMCwgNTAwLCA5MDAsIDE0MDAsIDIwMDAsIDI2MDAsIDM0MDAsIDQ0MDAsIDU0MDAsIDYwMDAsIDgyMDAsIDkwMDAsIDEwNDAwLCAxMTkwMCwgMTM1MDAsIDE1MjAwLCAxNzAwMCwgMTg5MDAsIDIwOTAwLCAyMzAwMCwgMjUyMDAsIDI3NTAwLCAyOTkwMCwgMzI0MDBdO1xubXkucHJvdG90eXBlLm5leHRMZXZlbEV4cCA9IFsyMDAsIDMwMCwgNDAwLCA1MDAsIDYwMCwgNjAwLCA4MDAsIDEwMDAsIDEwMDAsIDYwMCwgMjIwMCwgODAwLCAxNDAwLCAxNTAwLCAxNjAwLCAxNzAwLCAxODAwLCAxOTAwLCAyMDAwLCAyMTAwLCAyMjAwLCAyMzAwLCAyNDAwLCAyNTAwLCAnJm1kYXNoOyddO1xubXkucHJvdG90eXBlLmRpZmZQcm9wZXJ0aWVzID0gW1xuICAgICd0b3RhbEFnaScsXG4gICAgJ3RvdGFsSW50JyxcbiAgICAndG90YWxTdHInLFxuICAgICdoZWFsdGgnLFxuICAgICdoZWFsdGhyZWdlbicsXG4gICAgJ21hbmEnLFxuICAgICdtYW5hcmVnZW4nLFxuICAgICd0b3RhbEFybW9yUGh5c2ljYWwnLFxuICAgICd0b3RhbEFybW9yUGh5c2ljYWxSZWR1Y3Rpb24nLFxuICAgICd0b3RhbE1vdmVtZW50U3BlZWQnLFxuICAgICd0b3RhbFR1cm5SYXRlJyxcbiAgICAnYmFzZURhbWFnZScsXG4gICAgJ2JvbnVzRGFtYWdlJyxcbiAgICAnYm9udXNEYW1hZ2VSZWR1Y3Rpb24nLFxuICAgICdkYW1hZ2UnLFxuICAgICd0b3RhbE1hZ2ljUmVzaXN0YW5jZVByb2R1Y3QnLFxuICAgICd0b3RhbE1hZ2ljUmVzaXN0YW5jZScsXG4gICAgJ2JhdCcsXG4gICAgJ2lhcycsXG4gICAgJ2F0dGFja1RpbWUnLFxuICAgICdhdHRhY2tzUGVyU2Vjb25kJyxcbiAgICAnZXZhc2lvbicsXG4gICAgJ2VocFBoeXNpY2FsJyxcbiAgICAnZWhwTWFnaWNhbCcsXG4gICAgJ2Jhc2gnLFxuICAgICdjcml0Q2hhbmNlJyxcbiAgICAvLydjcml0RGFtYWdlJyxcbiAgICAnbWlzc0NoYW5jZScsXG4gICAgJ3RvdGFsYXR0YWNrcmFuZ2UnLFxuICAgICd2aXNpb25yYW5nZWRheScsXG4gICAgJ3Zpc2lvbnJhbmdlbmlnaHQnLFxuICAgICdsaWZlc3RlYWwnXG5dO1xuXG5teS5wcm90b3R5cGUuSWxsdXNpb25PcHRpb24gPSBmdW5jdGlvbiAobmFtZSwgZGlzcGxheW5hbWUsIGJhc2VIZXJvKSB7XG4gICAgdGhpcy5pbGx1c2lvbk5hbWUgPSBuYW1lO1xuICAgIHRoaXMuaWxsdXNpb25EaXNwbGF5TmFtZSA9IGRpc3BsYXluYW1lO1xuICAgIHRoaXMuYmFzZUhlcm8gPSBiYXNlSGVybztcbn07XG5cbm15LnByb3RvdHlwZS5jcmVhdGVJbGx1c2lvbk9wdGlvbnMgPSBmdW5jdGlvbiAoKSB7XG4gICAgdmFyIG9wdGlvbnMgPSBbXTtcbiAgICBmb3IgKHZhciBoIGluIG15LnByb3RvdHlwZS5pbGx1c2lvbkRhdGEpIHtcbiAgICAgICAgb3B0aW9ucy5wdXNoKG5ldyBteS5wcm90b3R5cGUuSWxsdXNpb25PcHRpb24oaCwgbXkucHJvdG90eXBlLmlsbHVzaW9uRGF0YVtoXS5kaXNwbGF5TmFtZSwgbXkucHJvdG90eXBlLmlsbHVzaW9uRGF0YVtoXS5oZXJvKSk7XG4gICAgfVxuICAgIHJldHVybiBvcHRpb25zO1xufVxuXG5teS5wcm90b3R5cGUuSGVyb01vZGVsID0gZnVuY3Rpb24gKGgpIHtcbiAgICB2YXIgc2VsZiA9IHRoaXM7XG4gICAgc2VsZi5oZXJvSWQgPSBrby5vYnNlcnZhYmxlKGgpO1xuICAgIHNlbGYuc2VsZWN0ZWRIZXJvTGV2ZWwgPSBrby5vYnNlcnZhYmxlKDEpO1xuICAgIHNlbGYuaW52ZW50b3J5ID0gbmV3IG15LnByb3RvdHlwZS5JbnZlbnRvcnlWaWV3TW9kZWwoc2VsZik7XG4gICAgc2VsZi5zZWxlY3RlZEludmVudG9yeSA9IGtvLm9ic2VydmFibGUoLTEpO1xuICAgIHNlbGYuYnVmZnMgPSBuZXcgbXkucHJvdG90eXBlLkJ1ZmZWaWV3TW9kZWwoKTtcbiAgICBzZWxmLmJ1ZmZzLmhhc1NjZXB0ZXIgPSBzZWxmLmludmVudG9yeS5oYXNTY2VwdGVyO1xuICAgIHNlbGYuZGVidWZmcyA9IG5ldyBteS5wcm90b3R5cGUuQnVmZlZpZXdNb2RlbCgpO1xuICAgIC8qc2VsZi5oZXJvID0ga28uY29tcHV0ZWQoZnVuY3Rpb24gKCkge1xuICAgICAgICByZXR1cm4ga28ubWFwcGluZy5mcm9tSlMobXkucHJvdG90eXBlLmhlcm9EYXRhWyducGNfZG90YV9oZXJvXycgKyBzZWxmLmhlcm9JZCgpXSk7XG4gICAgfSk7Ki9cbiAgICBzZWxmLmhlcm9EYXRhID0ga28uY29tcHV0ZWQoZnVuY3Rpb24gKCkge1xuICAgICAgcmV0dXJuIG15LnByb3RvdHlwZS5oZXJvRGF0YVsnbnBjX2RvdGFfaGVyb18nICsgc2VsZi5oZXJvSWQoKV07XG4gICAgfSk7XG4gICAgc2VsZi5oZXJvQ29tcGFyZSA9IGtvLm9ic2VydmFibGUoc2VsZik7XG4gICAgc2VsZi5lbmVteSA9IGtvLm9ic2VydmFibGUoc2VsZik7XG4gICAgc2VsZi51bml0ID0ga28ub2JzZXJ2YWJsZShzZWxmKTtcbiAgICBzZWxmLmNsb25lID0ga28ub2JzZXJ2YWJsZShzZWxmKTtcbiAgICBzZWxmLmlsbHVzaW9ucyA9IGtvLm9ic2VydmFibGVBcnJheShbXSk7XG4gICAgc2VsZi5hdmFpbGFibGVJbGx1c2lvbnMgPSBrby5vYnNlcnZhYmxlQXJyYXkobXkucHJvdG90eXBlLmNyZWF0ZUlsbHVzaW9uT3B0aW9ucygpKTtcbiAgICBzZWxmLnNlbGVjdGVkSWxsdXNpb24gPSBrby5vYnNlcnZhYmxlKHNlbGYuYXZhaWxhYmxlSWxsdXNpb25zKClbMF0pO1xuICAgIHNlbGYuaWxsdXNpb25BYmlsaXR5TGV2ZWwgPSBrby5vYnNlcnZhYmxlKDEpO1xuICAgIHNlbGYuaWxsdXNpb25BYmlsaXR5TWF4TGV2ZWwgPSBrby5jb21wdXRlZChmdW5jdGlvbiAoKSB7XG4gICAgICAgIHJldHVybiBteS5wcm90b3R5cGUuaWxsdXNpb25EYXRhW3NlbGYuc2VsZWN0ZWRJbGx1c2lvbigpLmlsbHVzaW9uTmFtZV0ubWF4X2xldmVsO1xuICAgIH0pO1xuICAgIFxuICAgIHNlbGYuc2tpbGxQb2ludEhpc3RvcnkgPSBrby5vYnNlcnZhYmxlQXJyYXkoKTtcbiAgICBcbiAgICBzZWxmLmFiaWxpdHkgPSBrby5jb21wdXRlZChmdW5jdGlvbiAoKSB7XG4gICAgICAgIHZhciBhID0gbmV3IG15LnByb3RvdHlwZS5BYmlsaXR5TW9kZWwoa28ub2JzZXJ2YWJsZUFycmF5KEpTT04ucGFyc2UoSlNPTi5zdHJpbmdpZnkoc2VsZi5oZXJvRGF0YSgpLmFiaWxpdGllcykpKSwgc2VsZik7XG4gICAgICAgIGlmIChzZWxmLmhlcm9JZCgpID09PSAnZWFydGhfc3Bpcml0JyB8fCBzZWxmLmhlcm9JZCgpID09PSAnb2dyZV9tYWdpJykge1xuICAgICAgICAgICAgYS5hYmlsaXRpZXMoKVszXS5sZXZlbCgxKTtcbiAgICAgICAgfVxuICAgICAgICBlbHNlIGlmIChzZWxmLmhlcm9JZCgpID09PSAnaW52b2tlcicpIHtcbiAgICAgICAgICAgIGZvciAodmFyIGkgPSA2OyBpIDwgMTY7IGkrKykge1xuICAgICAgICAgICAgICAgIGEuYWJpbGl0aWVzKClbaV0ubGV2ZWwoMSk7XG4gICAgICAgICAgICB9XG4gICAgICAgIH1cbiAgICAgICAgc2VsZi5za2lsbFBvaW50SGlzdG9yeS5yZW1vdmVBbGwoKTtcbiAgICAgICAgYS5oYXNTY2VwdGVyID0gc2VsZi5pbnZlbnRvcnkuaGFzU2NlcHRlclxuICAgICAgICByZXR1cm4gYTtcbiAgICB9KTtcblxuICAgIHNlbGYuYXZhaWxhYmxlU2tpbGxQb2ludHMgPSBrby5jb21wdXRlZChmdW5jdGlvbiAoKSB7XG4gICAgICAgIHZhciBjID0gc2VsZi5zZWxlY3RlZEhlcm9MZXZlbCgpO1xuICAgICAgICBmb3IgKHZhciBpID0gMDsgaSA8IHNlbGYuYWJpbGl0eSgpLmFiaWxpdGllcygpLmxlbmd0aDsgaSsrKSB7XG4gICAgICAgICAgICB2YXIgZ2V0SW5kZXggPSBmdW5jdGlvbiAoKSB7XG4gICAgICAgICAgICAgICAgcmV0dXJuIGk7XG4gICAgICAgICAgICB9O1xuICAgICAgICAgICAgc3dpdGNoKHNlbGYuYWJpbGl0eSgpLmFiaWxpdGllcygpW2ldLmFiaWxpdHl0eXBlKSB7XG4gICAgICAgICAgICAgICAgY2FzZSAnRE9UQV9BQklMSVRZX1RZUEVfVUxUSU1BVEUnOlxuICAgICAgICAgICAgICAgICAgICBpZiAoc2VsZi5oZXJvSWQoKSA9PT0gJ2ludm9rZXInKSB7XG4gICAgICAgICAgICAgICAgICAgICAgICB3aGlsZSAoXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgKChzZWxmLmFiaWxpdHkoKS5hYmlsaXRpZXMoKVtpXS5sZXZlbCgpID09IDEpICYmIChwYXJzZUludChzZWxmLnNlbGVjdGVkSGVyb0xldmVsKCkpIDwgMikpIHx8XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgKChzZWxmLmFiaWxpdHkoKS5hYmlsaXRpZXMoKVtpXS5sZXZlbCgpID09IDIpICYmIChwYXJzZUludChzZWxmLnNlbGVjdGVkSGVyb0xldmVsKCkpIDwgNykpIHx8XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgKChzZWxmLmFiaWxpdHkoKS5hYmlsaXRpZXMoKVtpXS5sZXZlbCgpID09IDMpICYmIChwYXJzZUludChzZWxmLnNlbGVjdGVkSGVyb0xldmVsKCkpIDwgMTEpKSB8fFxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICgoc2VsZi5hYmlsaXR5KCkuYWJpbGl0aWVzKClbaV0ubGV2ZWwoKSA9PSA0KSAmJiAocGFyc2VJbnQoc2VsZi5zZWxlY3RlZEhlcm9MZXZlbCgpKSA8IDE3KSlcbiAgICAgICAgICAgICAgICAgICAgICAgICkge1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgIHNlbGYuYWJpbGl0eSgpLmxldmVsRG93bkFiaWxpdHkoZ2V0SW5kZXgsIG51bGwsIG51bGwsIHNlbGYpO1xuICAgICAgICAgICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgICAgICAgIGVsc2UgaWYgKHNlbGYuaGVyb0lkKCkgPT09ICdtZWVwbycpIHtcbiAgICAgICAgICAgICAgICAgICAgICAgIHdoaWxlICgoc2VsZi5hYmlsaXR5KCkuYWJpbGl0aWVzKClbaV0ubGV2ZWwoKS0xKSAqIDcgKyAzID4gcGFyc2VJbnQoc2VsZi5zZWxlY3RlZEhlcm9MZXZlbCgpKSkge1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgIHNlbGYuYWJpbGl0eSgpLmxldmVsRG93bkFiaWxpdHkoZ2V0SW5kZXgsIG51bGwsIG51bGwsIHNlbGYpO1xuICAgICAgICAgICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgICAgICAgIGVsc2Uge1xuICAgICAgICAgICAgICAgICAgICAgICAgd2hpbGUgKHNlbGYuYWJpbGl0eSgpLmFiaWxpdGllcygpW2ldLmxldmVsKCkgKiA1ICsgMSA+IHBhcnNlSW50KHNlbGYuc2VsZWN0ZWRIZXJvTGV2ZWwoKSkpIHtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICBzZWxmLmFiaWxpdHkoKS5sZXZlbERvd25BYmlsaXR5KGdldEluZGV4LCBudWxsLCBudWxsLCBzZWxmKTtcbiAgICAgICAgICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICAgIGJyZWFrO1xuICAgICAgICAgICAgICAgIGRlZmF1bHQ6XG4gICAgICAgICAgICAgICAgICAgIHdoaWxlIChzZWxmLmFiaWxpdHkoKS5hYmlsaXRpZXMoKVtpXS5sZXZlbCgpICogMiAtIDEgPiBwYXJzZUludChzZWxmLnNlbGVjdGVkSGVyb0xldmVsKCkpKSB7XG4gICAgICAgICAgICAgICAgICAgICAgICBzZWxmLmFiaWxpdHkoKS5sZXZlbERvd25BYmlsaXR5KGdldEluZGV4LCBudWxsLCBudWxsLCBzZWxmKTtcbiAgICAgICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICAgIGJyZWFrO1xuICAgICAgICAgICAgfVxuICAgICAgICB9XG4gICAgICAgIHZhciBnZXRJbmRleCA9IGZ1bmN0aW9uICgpIHtcbiAgICAgICAgICAgIHJldHVybiBzZWxmLnNraWxsUG9pbnRIaXN0b3J5KClbc2VsZi5za2lsbFBvaW50SGlzdG9yeSgpLmxlbmd0aC0xXTtcbiAgICAgICAgfTtcbiAgICAgICAgd2hpbGUgKHNlbGYuc2tpbGxQb2ludEhpc3RvcnkoKS5sZW5ndGggPiBjKSB7XG4gICAgICAgICAgICBzZWxmLmFiaWxpdHkoKS5sZXZlbERvd25BYmlsaXR5KGdldEluZGV4LCBudWxsLCBudWxsLCBzZWxmKTtcbiAgICAgICAgfVxuICAgICAgICByZXR1cm4gYy1zZWxmLnNraWxsUG9pbnRIaXN0b3J5KCkubGVuZ3RoO1xuICAgIH0sIHRoaXMpO1xuICAgIHNlbGYucHJpbWFyeUF0dHJpYnV0ZSA9IGtvLnB1cmVDb21wdXRlZChmdW5jdGlvbiAoKSB7XG4gICAgICAgIHZhciB2ID0gc2VsZi5oZXJvRGF0YSgpLmF0dHJpYnV0ZXByaW1hcnk7XG4gICAgICAgIGlmICh2ID09PSAnRE9UQV9BVFRSSUJVVEVfQUdJTElUWScpIHJldHVybiAnYWdpJztcbiAgICAgICAgaWYgKHYgPT09ICdET1RBX0FUVFJJQlVURV9JTlRFTExFQ1QnKSByZXR1cm4gJ2ludCc7XG4gICAgICAgIGlmICh2ID09PSAnRE9UQV9BVFRSSUJVVEVfU1RSRU5HVEgnKSByZXR1cm4gJ3N0cic7XG4gICAgICAgIHJldHVybiAnJztcbiAgICB9KTtcbiAgICBzZWxmLnRvdGFsRXhwID0ga28ucHVyZUNvbXB1dGVkKGZ1bmN0aW9uICgpIHtcbiAgICAgICAgcmV0dXJuIG15LnByb3RvdHlwZS50b3RhbEV4cFtzZWxmLnNlbGVjdGVkSGVyb0xldmVsKCkgLSAxXTtcbiAgICB9KTtcbiAgICBzZWxmLm5leHRMZXZlbEV4cCA9IGtvLnB1cmVDb21wdXRlZChmdW5jdGlvbiAoKSB7XG4gICAgICAgIHJldHVybiBteS5wcm90b3R5cGUubmV4dExldmVsRXhwW3NlbGYuc2VsZWN0ZWRIZXJvTGV2ZWwoKSAtIDFdO1xuICAgIH0pO1xuICAgIHNlbGYuc3RhcnRpbmdBcm1vciA9IGtvLnB1cmVDb21wdXRlZChmdW5jdGlvbiAoKSB7XG4gICAgICAgIHJldHVybiAoc2VsZi5oZXJvRGF0YSgpLmF0dHJpYnV0ZWJhc2VhZ2lsaXR5ICogLjE0ICsgc2VsZi5oZXJvRGF0YSgpLmFybW9ycGh5c2ljYWwpLnRvRml4ZWQoMik7XG4gICAgfSk7XG4gICAgc2VsZi5yZXNwYXduVGltZSA9IGtvLnB1cmVDb21wdXRlZChmdW5jdGlvbiAoKSB7XG4gICAgICAgIHJldHVybiA1ICsgMy44ICogc2VsZi5zZWxlY3RlZEhlcm9MZXZlbCgpO1xuICAgIH0pO1xuICAgIHNlbGYudG90YWxBdHRyaWJ1dGUgPSBmdW5jdGlvbiAoYSkge1xuICAgICAgICBpZiAoYSA9PT0gJ2FnaScpIHJldHVybiBwYXJzZUZsb2F0KHNlbGYudG90YWxBZ2koKSk7XG4gICAgICAgIGlmIChhID09PSAnaW50JykgcmV0dXJuIHBhcnNlRmxvYXQoc2VsZi50b3RhbEludCgpKTtcbiAgICAgICAgaWYgKGEgPT09ICdzdHInKSByZXR1cm4gcGFyc2VGbG9hdChzZWxmLnRvdGFsU3RyKCkpO1xuICAgICAgICByZXR1cm4gMDtcbiAgICB9O1xuICAgIHNlbGYudG90YWxBZ2kgPSBrby5wdXJlQ29tcHV0ZWQoZnVuY3Rpb24gKCkge1xuICAgICAgICByZXR1cm4gKHNlbGYuaGVyb0RhdGEoKS5hdHRyaWJ1dGViYXNlYWdpbGl0eVxuICAgICAgICAgICAgICAgICsgc2VsZi5oZXJvRGF0YSgpLmF0dHJpYnV0ZWFnaWxpdHlnYWluICogKHNlbGYuc2VsZWN0ZWRIZXJvTGV2ZWwoKSAtIDEpIFxuICAgICAgICAgICAgICAgICsgc2VsZi5pbnZlbnRvcnkuZ2V0QXR0cmlidXRlcygnYWdpJykgXG4gICAgICAgICAgICAgICAgKyBzZWxmLmFiaWxpdHkoKS5nZXRBdHRyaWJ1dGVCb251c0xldmVsKCkgKiAyXG4gICAgICAgICAgICAgICAgKyBzZWxmLmFiaWxpdHkoKS5nZXRBZ2lsaXR5KClcbiAgICAgICAgICAgICAgICArIHNlbGYuZW5lbXkoKS5hYmlsaXR5KCkuZ2V0QWxsU3RhdHNSZWR1Y3Rpb24oKVxuICAgICAgICAgICAgICAgICsgc2VsZi5kZWJ1ZmZzLmdldEFsbFN0YXRzUmVkdWN0aW9uKClcbiAgICAgICAgICAgICAgICkudG9GaXhlZCgyKTtcbiAgICB9KTtcbiAgICBzZWxmLmludFN0b2xlbiA9IGtvLm9ic2VydmFibGUoMCkuZXh0ZW5kKHsgbnVtZXJpYzogMCB9KTtcbiAgICBzZWxmLnRvdGFsSW50ID0ga28ucHVyZUNvbXB1dGVkKGZ1bmN0aW9uICgpIHtcbiAgICAgICAgcmV0dXJuIChzZWxmLmhlcm9EYXRhKCkuYXR0cmlidXRlYmFzZWludGVsbGlnZW5jZSBcbiAgICAgICAgICAgICAgICArIHNlbGYuaGVyb0RhdGEoKS5hdHRyaWJ1dGVpbnRlbGxpZ2VuY2VnYWluICogKHNlbGYuc2VsZWN0ZWRIZXJvTGV2ZWwoKSAtIDEpIFxuICAgICAgICAgICAgICAgICsgc2VsZi5pbnZlbnRvcnkuZ2V0QXR0cmlidXRlcygnaW50JykgXG4gICAgICAgICAgICAgICAgKyBzZWxmLmFiaWxpdHkoKS5nZXRBdHRyaWJ1dGVCb251c0xldmVsKCkgKiAyXG4gICAgICAgICAgICAgICAgKyBzZWxmLmFiaWxpdHkoKS5nZXRJbnRlbGxpZ2VuY2UoKVxuICAgICAgICAgICAgICAgICsgc2VsZi5lbmVteSgpLmFiaWxpdHkoKS5nZXRBbGxTdGF0c1JlZHVjdGlvbigpXG4gICAgICAgICAgICAgICAgKyBzZWxmLmRlYnVmZnMuZ2V0QWxsU3RhdHNSZWR1Y3Rpb24oKSArIHNlbGYuaW50U3RvbGVuKClcbiAgICAgICAgICAgICAgICkudG9GaXhlZCgyKTtcbiAgICB9KTtcbiAgICBzZWxmLnRvdGFsU3RyID0ga28ucHVyZUNvbXB1dGVkKGZ1bmN0aW9uICgpIHtcbiAgICAgICAgcmV0dXJuIChzZWxmLmhlcm9EYXRhKCkuYXR0cmlidXRlYmFzZXN0cmVuZ3RoIFxuICAgICAgICAgICAgICAgICsgc2VsZi5oZXJvRGF0YSgpLmF0dHJpYnV0ZXN0cmVuZ3RoZ2FpbiAqIChzZWxmLnNlbGVjdGVkSGVyb0xldmVsKCkgLSAxKSBcbiAgICAgICAgICAgICAgICArIHNlbGYuaW52ZW50b3J5LmdldEF0dHJpYnV0ZXMoJ3N0cicpIFxuICAgICAgICAgICAgICAgICsgc2VsZi5hYmlsaXR5KCkuZ2V0QXR0cmlidXRlQm9udXNMZXZlbCgpICogMlxuICAgICAgICAgICAgICAgICsgc2VsZi5hYmlsaXR5KCkuZ2V0U3RyZW5ndGgoKVxuICAgICAgICAgICAgICAgICsgc2VsZi5lbmVteSgpLmFiaWxpdHkoKS5nZXRTdHJlbmd0aFJlZHVjdGlvbigpXG4gICAgICAgICAgICAgICAgKyBzZWxmLmVuZW15KCkuYWJpbGl0eSgpLmdldEFsbFN0YXRzUmVkdWN0aW9uKClcbiAgICAgICAgICAgICAgICArIHNlbGYuZGVidWZmcy5nZXRBbGxTdGF0c1JlZHVjdGlvbigpXG4gICAgICAgICAgICAgICApLnRvRml4ZWQoMik7XG4gICAgfSk7XG4gICAgc2VsZi5oZWFsdGggPSBrby5wdXJlQ29tcHV0ZWQoZnVuY3Rpb24gKCkge1xuICAgICAgICByZXR1cm4gKHNlbGYuaGVyb0RhdGEoKS5zdGF0dXNoZWFsdGggKyBNYXRoLmZsb29yKHNlbGYudG90YWxTdHIoKSkgKiAyMCBcbiAgICAgICAgICAgICAgICArIHNlbGYuaW52ZW50b3J5LmdldEhlYWx0aCgpXG4gICAgICAgICAgICAgICAgKyBzZWxmLmFiaWxpdHkoKS5nZXRIZWFsdGgoKSkudG9GaXhlZCgyKTtcbiAgICB9KTtcbiAgICBzZWxmLmhlYWx0aHJlZ2VuID0ga28ucHVyZUNvbXB1dGVkKGZ1bmN0aW9uICgpIHtcbiAgICAgICAgdmFyIGhlYWx0aFJlZ2VuQXVyYSA9IFtzZWxmLmludmVudG9yeS5nZXRIZWFsdGhSZWdlbkF1cmEsIHNlbGYuYnVmZnMuaXRlbUJ1ZmZzLmdldEhlYWx0aFJlZ2VuQXVyYV0ucmVkdWNlKGZ1bmN0aW9uIChtZW1vLCBmbikge1xuICAgICAgICAgICAgdmFyIG9iaiA9IGZuKG1lbW8uZXhjbHVkZUxpc3QpO1xuICAgICAgICAgICAgb2JqLnZhbHVlICs9IG1lbW8udmFsdWU7XG4gICAgICAgICAgICByZXR1cm4gb2JqO1xuICAgICAgICB9LCB7dmFsdWU6IDAsIGV4Y2x1ZGVMaXN0OiBbXX0pO1xuICAgICAgICByZXR1cm4gKHNlbGYuaGVyb0RhdGEoKS5zdGF0dXNoZWFsdGhyZWdlbiArIHNlbGYudG90YWxTdHIoKSAqIC4wMyBcbiAgICAgICAgICAgICAgICArIHNlbGYuaW52ZW50b3J5LmdldEhlYWx0aFJlZ2VuKCkgXG4gICAgICAgICAgICAgICAgKyBzZWxmLmFiaWxpdHkoKS5nZXRIZWFsdGhSZWdlbigpXG4gICAgICAgICAgICAgICAgKyBzZWxmLmJ1ZmZzLmdldEhlYWx0aFJlZ2VuKClcbiAgICAgICAgICAgICAgICArIGhlYWx0aFJlZ2VuQXVyYS52YWx1ZVxuICAgICAgICAgICAgICAgICkudG9GaXhlZCgyKTtcbiAgICB9KTtcbiAgICBzZWxmLm1hbmEgPSBrby5wdXJlQ29tcHV0ZWQoZnVuY3Rpb24gKCkge1xuICAgICAgICByZXR1cm4gKHNlbGYuaGVyb0RhdGEoKS5zdGF0dXNtYW5hXG4gICAgICAgICAgICAgICAgKyBzZWxmLnRvdGFsSW50KCkgKiAxMlxuICAgICAgICAgICAgICAgICsgc2VsZi5pbnZlbnRvcnkuZ2V0TWFuYSgpXG4gICAgICAgICAgICAgICAgKyBzZWxmLmFiaWxpdHkoKS5nZXRNYW5hKCkpLnRvRml4ZWQoMik7XG4gICAgfSk7XG4gICAgc2VsZi5tYW5hcmVnZW4gPSBrby5wdXJlQ29tcHV0ZWQoZnVuY3Rpb24gKCkge1xuICAgICAgICByZXR1cm4gKChzZWxmLmhlcm9EYXRhKCkuc3RhdHVzbWFuYXJlZ2VuIFxuICAgICAgICAgICAgICAgICsgc2VsZi50b3RhbEludCgpICogLjA0IFxuICAgICAgICAgICAgICAgICsgc2VsZi5hYmlsaXR5KCkuZ2V0TWFuYVJlZ2VuKCkpIFxuICAgICAgICAgICAgICAgICogKDEgKyBzZWxmLmludmVudG9yeS5nZXRNYW5hUmVnZW5QZXJjZW50KCkpIFxuICAgICAgICAgICAgICAgICsgKHNlbGYuaGVyb0lkKCkgPT09ICdjcnlzdGFsX21haWRlbicgPyBzZWxmLmFiaWxpdHkoKS5nZXRNYW5hUmVnZW5BcmNhbmVBdXJhKCkgKiAyIDogc2VsZi5idWZmcy5nZXRNYW5hUmVnZW5BcmNhbmVBdXJhKCkpXG4gICAgICAgICAgICAgICAgKyBzZWxmLmludmVudG9yeS5nZXRNYW5hUmVnZW5CbG9vZHN0b25lKClcbiAgICAgICAgICAgICAgICArIHNlbGYuaW52ZW50b3J5LmdldE1hbmFSZWdlbigpXG4gICAgICAgICAgICAgICAgLSBzZWxmLmVuZW15KCkuYWJpbGl0eSgpLmdldE1hbmFSZWdlblJlZHVjdGlvbigpKS50b0ZpeGVkKDIpO1xuICAgIH0pO1xuICAgIHNlbGYudG90YWxBcm1vclBoeXNpY2FsID0ga28ucHVyZUNvbXB1dGVkKGZ1bmN0aW9uICgpIHtcbiAgICAgICAgdmFyIGFybW9yQXVyYSA9IFtzZWxmLmludmVudG9yeS5nZXRBcm1vckF1cmEsIHNlbGYuYnVmZnMuaXRlbUJ1ZmZzLmdldEFybW9yQXVyYV0ucmVkdWNlKGZ1bmN0aW9uIChtZW1vLCBmbikge1xuICAgICAgICAgICAgdmFyIG9iaiA9IGZuKG1lbW8uYXR0cmlidXRlcyk7XG4gICAgICAgICAgICByZXR1cm4gb2JqO1xuICAgICAgICB9LCB7dmFsdWU6MCwgYXR0cmlidXRlczpbXX0pO1xuICAgICAgICB2YXIgYXJtb3JSZWR1Y3Rpb24gPSBbc2VsZi5lbmVteSgpLmludmVudG9yeS5nZXRBcm1vclJlZHVjdGlvbiwgc2VsZi5kZWJ1ZmZzLml0ZW1CdWZmcy5nZXRBcm1vclJlZHVjdGlvbl0ucmVkdWNlKGZ1bmN0aW9uIChtZW1vLCBmbikge1xuICAgICAgICAgICAgdmFyIG9iaiA9IGZuKG1lbW8uZXhjbHVkZUxpc3QpO1xuICAgICAgICAgICAgb2JqLnZhbHVlICs9IG1lbW8udmFsdWU7XG4gICAgICAgICAgICByZXR1cm4gb2JqO1xuICAgICAgICB9LCB7dmFsdWU6IDAsIGV4Y2x1ZGVMaXN0OiBbXX0pO1xuICAgICAgICByZXR1cm4gKHNlbGYuZW5lbXkoKS5hYmlsaXR5KCkuZ2V0QXJtb3JCYXNlUmVkdWN0aW9uKCkgKiBzZWxmLmRlYnVmZnMuZ2V0QXJtb3JCYXNlUmVkdWN0aW9uKCkgKiAoc2VsZi5oZXJvRGF0YSgpLmFybW9ycGh5c2ljYWwgKyBzZWxmLnRvdGFsQWdpKCkgKiAuMTQpXG4gICAgICAgICAgICAgICAgKyBzZWxmLmludmVudG9yeS5nZXRBcm1vcigpXG4gICAgICAgICAgICAgICAgLy8rIHNlbGYuaW52ZW50b3J5LmdldEFybW9yQXVyYSgpLnZhbHVlXG4gICAgICAgICAgICAgICAgLy8rIHNlbGYuZW5lbXkoKS5pbnZlbnRvcnkuZ2V0QXJtb3JSZWR1Y3Rpb24oKVxuICAgICAgICAgICAgICAgICsgc2VsZi5hYmlsaXR5KCkuZ2V0QXJtb3IoKVxuICAgICAgICAgICAgICAgICsgc2VsZi5lbmVteSgpLmFiaWxpdHkoKS5nZXRBcm1vclJlZHVjdGlvbigpXG4gICAgICAgICAgICAgICAgKyBzZWxmLmJ1ZmZzLmdldEFybW9yKClcbiAgICAgICAgICAgICAgICArIHNlbGYuYnVmZnMuaXRlbUJ1ZmZzLmdldEFybW9yKClcbiAgICAgICAgICAgICAgICArIHNlbGYuZGVidWZmcy5nZXRBcm1vclJlZHVjdGlvbigpXG4gICAgICAgICAgICAgICAgLy8rIHNlbGYuYnVmZnMuaXRlbUJ1ZmZzLmdldEFybW9yQXVyYSgpLnZhbHVlXG4gICAgICAgICAgICAgICAgKyBhcm1vckF1cmEudmFsdWVcbiAgICAgICAgICAgICAgICArIGFybW9yUmVkdWN0aW9uLnZhbHVlXG4gICAgICAgICAgICAgICAgLy8rIHNlbGYuZGVidWZmcy5nZXRBcm1vclJlZHVjdGlvbigpXG4gICAgICAgICAgICAgICAgKS50b0ZpeGVkKDIpO1xuICAgIH0pO1xuICAgIHNlbGYudG90YWxBcm1vclBoeXNpY2FsUmVkdWN0aW9uID0ga28ucHVyZUNvbXB1dGVkKGZ1bmN0aW9uICgpIHtcbiAgICAgICAgdmFyIHRvdGFsQXJtb3IgPSBzZWxmLnRvdGFsQXJtb3JQaHlzaWNhbCgpO1xuICAgICAgICBpZiAodG90YWxBcm1vciA+PSAwKSB7XG4gICAgICAgICAgICByZXR1cm4gKCgwLjA2ICogc2VsZi50b3RhbEFybW9yUGh5c2ljYWwoKSkgLyAoMSArIDAuMDYgKiBzZWxmLnRvdGFsQXJtb3JQaHlzaWNhbCgpKSAqIDEwMCkudG9GaXhlZCgyKTtcbiAgICAgICAgfVxuICAgICAgICBlbHNlIHtcbiAgICAgICAgICAgIHJldHVybiAtKCgwLjA2ICogLXNlbGYudG90YWxBcm1vclBoeXNpY2FsKCkpIC8gKDEgKyAwLjA2ICogLXNlbGYudG90YWxBcm1vclBoeXNpY2FsKCkpICogMTAwKS50b0ZpeGVkKDIpO1xuICAgICAgICB9XG4gICAgfSk7XG4gICAgc2VsZi50b3RhbE1vdmVtZW50U3BlZWQgPSBrby5wdXJlQ29tcHV0ZWQoZnVuY3Rpb24gKCkge1xuICAgICAgICB2YXIgTUlOX01PVkVTUEVFRCA9IDEwMDtcbiAgICAgICAgdmFyIG1zID0gKHNlbGYuYWJpbGl0eSgpLnNldE1vdmVtZW50U3BlZWQoKSA+IDAgPyBzZWxmLmFiaWxpdHkoKS5zZXRNb3ZlbWVudFNwZWVkKCkgOiBzZWxmLmJ1ZmZzLnNldE1vdmVtZW50U3BlZWQoKSk7XG4gICAgICAgIGlmIChtcyA+IDApIHtcbiAgICAgICAgICAgIHJldHVybiBtcztcbiAgICAgICAgfVxuICAgICAgICBlbHNlIHtcbiAgICAgICAgICAgIHZhciBtb3ZlbWVudFNwZWVkUGVyY2VudCA9IFtzZWxmLmludmVudG9yeS5nZXRNb3ZlbWVudFNwZWVkUGVyY2VudCwgc2VsZi5idWZmcy5pdGVtQnVmZnMuZ2V0TW92ZW1lbnRTcGVlZFBlcmNlbnRdLnJlZHVjZShmdW5jdGlvbiAobWVtbywgZm4pIHtcbiAgICAgICAgICAgICAgICB2YXIgb2JqID0gZm4obWVtby5leGNsdWRlTGlzdCk7XG4gICAgICAgICAgICAgICAgb2JqLnZhbHVlICs9IG1lbW8udmFsdWU7XG4gICAgICAgICAgICAgICAgcmV0dXJuIG9iajtcbiAgICAgICAgICAgIH0sIHt2YWx1ZTowLCBleGNsdWRlTGlzdDpbXX0pO1xuICAgICAgICAgICAgdmFyIG1vdmVtZW50U3BlZWRQZXJjZW50UmVkdWN0aW9uID0gW3NlbGYuZW5lbXkoKS5pbnZlbnRvcnkuZ2V0TW92ZW1lbnRTcGVlZFBlcmNlbnRSZWR1Y3Rpb24sIHNlbGYuZGVidWZmcy5pdGVtQnVmZnMuZ2V0TW92ZW1lbnRTcGVlZFBlcmNlbnRSZWR1Y3Rpb25dLnJlZHVjZShmdW5jdGlvbiAobWVtbywgZm4pIHtcbiAgICAgICAgICAgICAgICB2YXIgb2JqID0gZm4obWVtby5leGNsdWRlTGlzdCk7XG4gICAgICAgICAgICAgICAgb2JqLnZhbHVlICs9IG1lbW8udmFsdWU7XG4gICAgICAgICAgICAgICAgcmV0dXJuIG9iajtcbiAgICAgICAgICAgIH0sIHt2YWx1ZTowLCBleGNsdWRlTGlzdDpbXX0pO1xuICAgICAgICAgICAgcmV0dXJuIE1hdGgubWF4KFxuICAgICAgICAgICAgICAgIHNlbGYuZW5lbXkoKS5pbnZlbnRvcnkuaXNTaGVlcGVkKCkgfHwgc2VsZi5kZWJ1ZmZzLml0ZW1CdWZmcy5pc1NoZWVwZWQoKSA/IDE0MCA6XG4gICAgICAgICAgICAgICAgKHNlbGYuaGVyb0RhdGEoKS5tb3ZlbWVudHNwZWVkICsgc2VsZi5pbnZlbnRvcnkuZ2V0TW92ZW1lbnRTcGVlZEZsYXQoKSsgc2VsZi5hYmlsaXR5KCkuZ2V0TW92ZW1lbnRTcGVlZEZsYXQoKSkgKiBcbiAgICAgICAgICAgICAgICAoMSAvLysgc2VsZi5pbnZlbnRvcnkuZ2V0TW92ZW1lbnRTcGVlZFBlcmNlbnQoKSBcbiAgICAgICAgICAgICAgICAgICArIG1vdmVtZW50U3BlZWRQZXJjZW50LnZhbHVlXG4gICAgICAgICAgICAgICAgICAgKyBtb3ZlbWVudFNwZWVkUGVyY2VudFJlZHVjdGlvbi52YWx1ZVxuICAgICAgICAgICAgICAgICAgICsgc2VsZi5hYmlsaXR5KCkuZ2V0TW92ZW1lbnRTcGVlZFBlcmNlbnQoKSBcbiAgICAgICAgICAgICAgICAgICAvLysgc2VsZi5lbmVteSgpLmludmVudG9yeS5nZXRNb3ZlbWVudFNwZWVkUGVyY2VudFJlZHVjdGlvbigpIFxuICAgICAgICAgICAgICAgICAgICsgc2VsZi5lbmVteSgpLmFiaWxpdHkoKS5nZXRNb3ZlbWVudFNwZWVkUGVyY2VudFJlZHVjdGlvbigpIFxuICAgICAgICAgICAgICAgICAgICsgc2VsZi5idWZmcy5nZXRNb3ZlbWVudFNwZWVkUGVyY2VudCgpIFxuICAgICAgICAgICAgICAgICAgICsgc2VsZi5kZWJ1ZmZzLmdldE1vdmVtZW50U3BlZWRQZXJjZW50UmVkdWN0aW9uKClcbiAgICAgICAgICAgICAgICAgICArIHNlbGYudW5pdCgpLmFiaWxpdHkoKS5nZXRNb3ZlbWVudFNwZWVkUGVyY2VudCgpIFxuICAgICAgICAgICAgICAgIClcbiAgICAgICAgICAgICwgTUlOX01PVkVTUEVFRCkudG9GaXhlZCgyKTtcbiAgICAgICAgfVxuICAgIH0pO1xuICAgIHNlbGYudG90YWxUdXJuUmF0ZSA9IGtvLnB1cmVDb21wdXRlZChmdW5jdGlvbiAoKSB7XG4gICAgICAgIHJldHVybiAoc2VsZi5oZXJvRGF0YSgpLm1vdmVtZW50dHVybnJhdGUgXG4gICAgICAgICAgICAgICAgKiAoMSArIHNlbGYuZW5lbXkoKS5hYmlsaXR5KCkuZ2V0VHVyblJhdGVSZWR1Y3Rpb24oKVxuICAgICAgICAgICAgICAgICAgICAgKyBzZWxmLmRlYnVmZnMuZ2V0VHVyblJhdGVSZWR1Y3Rpb24oKSkpLnRvRml4ZWQoMik7XG4gICAgfSk7XG4gICAgc2VsZi5iYXNlRGFtYWdlID0ga28ucHVyZUNvbXB1dGVkKGZ1bmN0aW9uICgpIHtcbiAgICAgICAgdmFyIHRvdGFsQXR0cmlidXRlID0gc2VsZi50b3RhbEF0dHJpYnV0ZShzZWxmLnByaW1hcnlBdHRyaWJ1dGUoKSksXG4gICAgICAgICAgICBhYmlsaXR5QmFzZURhbWFnZSA9IHNlbGYuYWJpbGl0eSgpLmdldEJhc2VEYW1hZ2UoKSxcbiAgICAgICAgICAgIG1pbkRhbWFnZSA9IHNlbGYuaGVyb0RhdGEoKS5hdHRhY2tkYW1hZ2VtaW4sXG4gICAgICAgICAgICBtYXhEYW1hZ2UgPSBzZWxmLmhlcm9EYXRhKCkuYXR0YWNrZGFtYWdlbWF4O1xuICAgICAgICByZXR1cm4gW01hdGguZmxvb3IoKG1pbkRhbWFnZSArIHRvdGFsQXR0cmlidXRlICsgYWJpbGl0eUJhc2VEYW1hZ2UudG90YWwpICogc2VsZi5hYmlsaXR5KCkuZ2V0U2VsZkJhc2VEYW1hZ2VSZWR1Y3Rpb25QY3QoKSAqIHNlbGYuZW5lbXkoKS5hYmlsaXR5KCkuZ2V0QmFzZURhbWFnZVJlZHVjdGlvblBjdCgpICogc2VsZi5kZWJ1ZmZzLmdldEJhc2VEYW1hZ2VSZWR1Y3Rpb25QY3QoKSAqIHNlbGYuZGVidWZmcy5pdGVtQnVmZnMuZ2V0QmFzZURhbWFnZVJlZHVjdGlvblBjdCgpICogYWJpbGl0eUJhc2VEYW1hZ2UubXVsdGlwbGllciksXG4gICAgICAgICAgICAgICAgTWF0aC5mbG9vcigobWF4RGFtYWdlICsgdG90YWxBdHRyaWJ1dGUgKyBhYmlsaXR5QmFzZURhbWFnZS50b3RhbCkgKiBzZWxmLmFiaWxpdHkoKS5nZXRTZWxmQmFzZURhbWFnZVJlZHVjdGlvblBjdCgpICogc2VsZi5lbmVteSgpLmFiaWxpdHkoKS5nZXRCYXNlRGFtYWdlUmVkdWN0aW9uUGN0KCkgKiBzZWxmLmRlYnVmZnMuZ2V0QmFzZURhbWFnZVJlZHVjdGlvblBjdCgpICogc2VsZi5kZWJ1ZmZzLml0ZW1CdWZmcy5nZXRCYXNlRGFtYWdlUmVkdWN0aW9uUGN0KCkgKiBhYmlsaXR5QmFzZURhbWFnZS5tdWx0aXBsaWVyKV07XG4gICAgfSk7XG4gICAgc2VsZi5iYXNlRGFtYWdlQXZnID0ga28ucHVyZUNvbXB1dGVkKGZ1bmN0aW9uICgpIHtcbiAgICAgICAgcmV0dXJuIChzZWxmLmJhc2VEYW1hZ2UoKVswXSArIHNlbGYuYmFzZURhbWFnZSgpWzFdKSAvIDI7XG4gICAgfSk7XG4gICAgc2VsZi5iYXNlRGFtYWdlTWluID0ga28ucHVyZUNvbXB1dGVkKGZ1bmN0aW9uICgpIHtcbiAgICAgICAgcmV0dXJuIHNlbGYuYmFzZURhbWFnZSgpWzBdO1xuICAgIH0pO1xuICAgIHNlbGYuYmFzZURhbWFnZU1heCA9IGtvLnB1cmVDb21wdXRlZChmdW5jdGlvbiAoKSB7XG4gICAgICAgIHJldHVybiBzZWxmLmJhc2VEYW1hZ2UoKVsxXTtcbiAgICB9KTtcbiAgICBzZWxmLmJvbnVzRGFtYWdlID0ga28ucHVyZUNvbXB1dGVkKGZ1bmN0aW9uICgpIHtcbiAgICAgICAgcmV0dXJuICgoc2VsZi5pbnZlbnRvcnkuZ2V0Qm9udXNEYW1hZ2UoKS50b3RhbFxuICAgICAgICAgICAgICAgICsgc2VsZi5hYmlsaXR5KCkuZ2V0Qm9udXNEYW1hZ2UoKS50b3RhbFxuICAgICAgICAgICAgICAgICsgc2VsZi5idWZmcy5nZXRCb251c0RhbWFnZSgpLnRvdGFsXG4gICAgICAgICAgICAgICAgKyBNYXRoLmZsb29yKChzZWxmLmJhc2VEYW1hZ2UoKVswXSArIHNlbGYuYmFzZURhbWFnZSgpWzFdKSAvIDIgXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAqIChzZWxmLmJ1ZmZzLml0ZW1CdWZmcy5nZXRCb251c0RhbWFnZVBlcmNlbnQoc2VsZi5pbnZlbnRvcnkuZ2V0Qm9udXNEYW1hZ2VQZXJjZW50KCkpLnRvdGFsXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICArIHNlbGYuYWJpbGl0eSgpLmdldEJvbnVzRGFtYWdlUGVyY2VudCgpLnRvdGFsXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICArIHNlbGYuYnVmZnMuZ2V0Qm9udXNEYW1hZ2VQZXJjZW50KCkudG90YWxcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgKVxuICAgICAgICAgICAgICAgICAgICAgICAgICAgIClcbiAgICAgICAgICAgICAgICArIE1hdGguZmxvb3IoXG4gICAgICAgICAgICAgICAgICAgIChzZWxmLmhlcm9EYXRhKCkuYXR0YWNrdHlwZSA9PSAnRE9UQV9VTklUX0NBUF9SQU5HRURfQVRUQUNLJyBcbiAgICAgICAgICAgICAgICAgICAgICAgID8gKChzZWxmLmhlcm9JZCgpID09ICdkcm93X3JhbmdlcicpID8gc2VsZi5hYmlsaXR5KCkuZ2V0Qm9udXNEYW1hZ2VQcmVjaXNpb25BdXJhKCkudG90YWxbMF0gKiBzZWxmLnRvdGFsQWdpKCkgOiBzZWxmLmJ1ZmZzLmdldEJvbnVzRGFtYWdlUHJlY2lzaW9uQXVyYSgpLnRvdGFsWzFdKVxuICAgICAgICAgICAgICAgICAgICAgICAgOiAwKVxuICAgICAgICAgICAgICAgICAgKVxuICAgICAgICAgICAgICAgICsgTWF0aC5mbG9vcihcbiAgICAgICAgICAgICAgICAgICAgKChzZWxmLmhlcm9JZCgpID09ICdyaWtpJykgPyBzZWxmLmFiaWxpdHkoKS5nZXRCb251c0RhbWFnZUJhY2tzdGFiKCkudG90YWxbMF0gKiBzZWxmLnRvdGFsQWdpKCkgOiAwKVxuICAgICAgICAgICAgICAgICAgKVxuICAgICAgICAgICAgICAgICkgKiBzZWxmLmFiaWxpdHkoKS5nZXRTZWxmQmFzZURhbWFnZVJlZHVjdGlvblBjdCgpXG4gICAgICAgICAgICAgICAgICAqIHNlbGYuZW5lbXkoKS5hYmlsaXR5KCkuZ2V0QmFzZURhbWFnZVJlZHVjdGlvblBjdCgpXG4gICAgICAgICAgICAgICAgICAqIHNlbGYuZGVidWZmcy5pdGVtQnVmZnMuZ2V0QmFzZURhbWFnZVJlZHVjdGlvblBjdCgpKTtcbiAgICB9KTtcbiAgICBzZWxmLmJvbnVzRGFtYWdlUmVkdWN0aW9uID0ga28ucHVyZUNvbXB1dGVkKGZ1bmN0aW9uICgpIHtcbiAgICAgICAgcmV0dXJuIE1hdGguYWJzKHNlbGYuZW5lbXkoKS5hYmlsaXR5KCkuZ2V0Qm9udXNEYW1hZ2VSZWR1Y3Rpb24oKSArIHNlbGYuZGVidWZmcy5nZXRCb251c0RhbWFnZVJlZHVjdGlvbigpKTtcbiAgICB9KTtcbiAgICBzZWxmLmRhbWFnZUF2ZyA9IGtvLnB1cmVDb21wdXRlZChmdW5jdGlvbiAoKSB7XG4gICAgICAgIHJldHVybiAoc2VsZi5iYXNlRGFtYWdlKClbMF0gKyBzZWxmLmJhc2VEYW1hZ2UoKVsxXSkgLyAyICsgc2VsZi5ib251c0RhbWFnZSgpO1xuICAgIH0pO1xuICAgIHNlbGYuZGFtYWdlTWluID0ga28ucHVyZUNvbXB1dGVkKGZ1bmN0aW9uICgpIHtcbiAgICAgICAgcmV0dXJuIHNlbGYuYmFzZURhbWFnZSgpWzBdICsgc2VsZi5ib251c0RhbWFnZSgpO1xuICAgIH0pO1xuICAgIHNlbGYuZGFtYWdlTWF4ID0ga28ucHVyZUNvbXB1dGVkKGZ1bmN0aW9uICgpIHtcbiAgICAgICAgcmV0dXJuIHNlbGYuYmFzZURhbWFnZSgpWzFdICsgc2VsZi5ib251c0RhbWFnZSgpO1xuICAgIH0pO1xuICAgIHNlbGYuZGFtYWdlID0ga28ucHVyZUNvbXB1dGVkKGZ1bmN0aW9uICgpIHtcbiAgICAgICAgcmV0dXJuIFtzZWxmLmJhc2VEYW1hZ2UoKVswXSArIHNlbGYuYm9udXNEYW1hZ2UoKSxcbiAgICAgICAgICAgICAgICBzZWxmLmJhc2VEYW1hZ2UoKVsxXSArIHNlbGYuYm9udXNEYW1hZ2UoKV07XG4gICAgfSk7XG4gICAgc2VsZi50b3RhbE1hZ2ljUmVzaXN0YW5jZVByb2R1Y3QgPSBrby5wdXJlQ29tcHV0ZWQoZnVuY3Rpb24gKCkge1xuICAgICAgICByZXR1cm4gKDEgLSBzZWxmLmhlcm9EYXRhKCkubWFnaWNhbHJlc2lzdGFuY2UgLyAxMDApIFxuICAgICAgICAgICAgICAgICogc2VsZi5pbnZlbnRvcnkuZ2V0TWFnaWNSZXNpc3QoKVxuICAgICAgICAgICAgICAgICogc2VsZi5hYmlsaXR5KCkuZ2V0TWFnaWNSZXNpc3QoKVxuICAgICAgICAgICAgICAgICogc2VsZi5idWZmcy5nZXRNYWdpY1Jlc2lzdCgpXG4gICAgICAgICAgICAgICAgKiBzZWxmLmludmVudG9yeS5nZXRNYWdpY1Jlc2lzdFJlZHVjdGlvblNlbGYoKVxuICAgICAgICAgICAgICAgICogc2VsZi5lbmVteSgpLmludmVudG9yeS5nZXRNYWdpY1Jlc2lzdFJlZHVjdGlvbigpXG4gICAgICAgICAgICAgICAgKiBzZWxmLmVuZW15KCkuYWJpbGl0eSgpLmdldE1hZ2ljUmVzaXN0UmVkdWN0aW9uKClcbiAgICAgICAgICAgICAgICAqIHNlbGYuZGVidWZmcy5nZXRNYWdpY1Jlc2lzdFJlZHVjdGlvbigpXG4gICAgICAgICAgICAgICAgKiBzZWxmLmRlYnVmZnMuaXRlbUJ1ZmZzLmdldE1hZ2ljUmVzaXN0UmVkdWN0aW9uKCk7XG4gICAgfSk7XG4gICAgc2VsZi50b3RhbE1hZ2ljUmVzaXN0YW5jZSA9IGtvLnB1cmVDb21wdXRlZChmdW5jdGlvbiAoKSB7XG4gICAgICAgIHJldHVybiAoKDEgLSBzZWxmLnRvdGFsTWFnaWNSZXNpc3RhbmNlUHJvZHVjdCgpKSAqIDEwMCkudG9GaXhlZCgyKTtcbiAgICB9KTtcbiAgICBzZWxmLmJhdCA9IGtvLnB1cmVDb21wdXRlZChmdW5jdGlvbiAoKSB7XG4gICAgICAgIHZhciBhYmlsaXR5QkFUID0gc2VsZi5hYmlsaXR5KCkuZ2V0QkFUKCk7XG4gICAgICAgIGlmIChhYmlsaXR5QkFUID4gMCkge1xuICAgICAgICAgICAgcmV0dXJuIGFiaWxpdHlCQVQ7XG4gICAgICAgIH1cbiAgICAgICAgcmV0dXJuIHNlbGYuaGVyb0RhdGEoKS5hdHRhY2tyYXRlO1xuICAgIH0pO1xuICAgIHNlbGYuaWFzID0ga28ucHVyZUNvbXB1dGVkKGZ1bmN0aW9uICgpIHtcbiAgICAgICAgdmFyIGF0dGFja1NwZWVkID0gW3NlbGYuaW52ZW50b3J5LmdldEF0dGFja1NwZWVkLCBzZWxmLmJ1ZmZzLml0ZW1CdWZmcy5nZXRBdHRhY2tTcGVlZF0ucmVkdWNlKGZ1bmN0aW9uIChtZW1vLCBmbikge1xuICAgICAgICAgICAgdmFyIG9iaiA9IGZuKG1lbW8uZXhjbHVkZUxpc3QpO1xuICAgICAgICAgICAgb2JqLnZhbHVlICs9IG1lbW8udmFsdWU7XG4gICAgICAgICAgICByZXR1cm4gb2JqO1xuICAgICAgICB9LCB7dmFsdWU6MCwgZXhjbHVkZUxpc3Q6W119KTtcbiAgICAgICAgdmFyIGF0dGFja1NwZWVkUmVkdWN0aW9uID0gW3NlbGYuZW5lbXkoKS5pbnZlbnRvcnkuZ2V0QXR0YWNrU3BlZWRSZWR1Y3Rpb24sIHNlbGYuZGVidWZmcy5pdGVtQnVmZnMuZ2V0QXR0YWNrU3BlZWRSZWR1Y3Rpb25dLnJlZHVjZShmdW5jdGlvbiAobWVtbywgZm4pIHtcbiAgICAgICAgICAgIHZhciBvYmogPSBmbihtZW1vLmV4Y2x1ZGVMaXN0KTtcbiAgICAgICAgICAgIG9iai52YWx1ZSArPSBtZW1vLnZhbHVlO1xuICAgICAgICAgICAgcmV0dXJuIG9iajtcbiAgICAgICAgfSwge3ZhbHVlOjAsIGV4Y2x1ZGVMaXN0OiBbXX0pO1xuICAgICAgICB2YXIgdmFsID0gcGFyc2VGbG9hdChzZWxmLnRvdGFsQWdpKCkpIFxuICAgICAgICAgICAgICAgIC8vKyBzZWxmLmludmVudG9yeS5nZXRBdHRhY2tTcGVlZCgpIFxuICAgICAgICAgICAgICAgICsgYXR0YWNrU3BlZWQudmFsdWVcbiAgICAgICAgICAgICAgICArIGF0dGFja1NwZWVkUmVkdWN0aW9uLnZhbHVlXG4gICAgICAgICAgICAgICAgLy8rIHNlbGYuZW5lbXkoKS5pbnZlbnRvcnkuZ2V0QXR0YWNrU3BlZWRSZWR1Y3Rpb24oKSBcbiAgICAgICAgICAgICAgICArIHNlbGYuYWJpbGl0eSgpLmdldEF0dGFja1NwZWVkKCkgXG4gICAgICAgICAgICAgICAgKyBzZWxmLmVuZW15KCkuYWJpbGl0eSgpLmdldEF0dGFja1NwZWVkUmVkdWN0aW9uKCkgXG4gICAgICAgICAgICAgICAgKyBzZWxmLmJ1ZmZzLmdldEF0dGFja1NwZWVkKCkgXG4gICAgICAgICAgICAgICAgKyBzZWxmLmRlYnVmZnMuZ2V0QXR0YWNrU3BlZWRSZWR1Y3Rpb24oKVxuICAgICAgICAgICAgICAgICsgc2VsZi51bml0KCkuYWJpbGl0eSgpLmdldEF0dGFja1NwZWVkKCk7IFxuICAgICAgICBpZiAodmFsIDwgLTgwKSB7XG4gICAgICAgICAgICByZXR1cm4gLTgwO1xuICAgICAgICB9XG4gICAgICAgIGVsc2UgaWYgKHZhbCA+IDUwMCkge1xuICAgICAgICAgICAgcmV0dXJuIDUwMDtcbiAgICAgICAgfVxuICAgICAgICByZXR1cm4gdmFsLnRvRml4ZWQoMik7XG4gICAgfSk7XG4gICAgc2VsZi5hdHRhY2tUaW1lID0ga28ucHVyZUNvbXB1dGVkKGZ1bmN0aW9uICgpIHtcbiAgICAgICAgcmV0dXJuIChzZWxmLmJhdCgpIC8gKDEgKyBzZWxmLmlhcygpIC8gMTAwKSkudG9GaXhlZCgyKTtcbiAgICB9KTtcbiAgICBzZWxmLmF0dGFja3NQZXJTZWNvbmQgPSBrby5wdXJlQ29tcHV0ZWQoZnVuY3Rpb24gKCkge1xuICAgICAgICByZXR1cm4gKCgxICsgc2VsZi5pYXMoKSAvIDEwMCkgLyBzZWxmLmJhdCgpKS50b0ZpeGVkKDIpO1xuICAgIH0pO1xuICAgIHNlbGYuZXZhc2lvbiA9IGtvLnB1cmVDb21wdXRlZChmdW5jdGlvbiAoKSB7XG4gICAgICAgIGlmIChzZWxmLmVuZW15KCkuaW52ZW50b3J5LmlzU2hlZXBlZCgpIHx8IHNlbGYuZGVidWZmcy5pdGVtQnVmZnMuaXNTaGVlcGVkKCkpIHJldHVybiAwO1xuICAgICAgICB2YXIgZSA9IHNlbGYuYWJpbGl0eSgpLnNldEV2YXNpb24oKTtcbiAgICAgICAgaWYgKGUpIHtcbiAgICAgICAgICAgIHJldHVybiAoZSAqIDEwMCkudG9GaXhlZCgyKTtcbiAgICAgICAgfVxuICAgICAgICBlbHNlIHtcbiAgICAgICAgICAgIHJldHVybiAoKDEtKHNlbGYuaW52ZW50b3J5LmdldEV2YXNpb24oKSAqIHNlbGYuYWJpbGl0eSgpLmdldEV2YXNpb24oKSAqIHNlbGYuYWJpbGl0eSgpLmdldEV2YXNpb25CYWNrdHJhY2soKSAqIHNlbGYuYnVmZnMuaXRlbUJ1ZmZzLmdldEV2YXNpb24oKSkpICogMTAwKS50b0ZpeGVkKDIpO1xuICAgICAgICB9XG4gICAgfSk7XG4gICAgc2VsZi5laHBQaHlzaWNhbCA9IGtvLnB1cmVDb21wdXRlZChmdW5jdGlvbiAoKSB7XG4gICAgICAgIHZhciBldmFzaW9uID0gc2VsZi5lbmVteSgpLmludmVudG9yeS5pc1NoZWVwZWQoKSB8fCBzZWxmLmRlYnVmZnMuaXRlbUJ1ZmZzLmlzU2hlZXBlZCgpID8gMSA6IHNlbGYuaW52ZW50b3J5LmdldEV2YXNpb24oKSAqIHNlbGYuYWJpbGl0eSgpLmdldEV2YXNpb24oKSAqIHNlbGYuYnVmZnMuaXRlbUJ1ZmZzLmdldEV2YXNpb24oKTtcbiAgICAgICAgaWYgKHNlbGYudG90YWxBcm1vclBoeXNpY2FsKCkgPj0gMCkge1xuICAgICAgICAgICAgdmFyIGVocCA9IHNlbGYuaGVhbHRoKCkgKiAoMSArIC4wNiAqIHNlbGYudG90YWxBcm1vclBoeXNpY2FsKCkpO1xuICAgICAgICB9XG4gICAgICAgIGVsc2Uge1xuICAgICAgICAgICAgdmFyIGVocCA9IHNlbGYuaGVhbHRoKCkgKiAoMSAtIC4wNiAqIHNlbGYudG90YWxBcm1vclBoeXNpY2FsKCkpIC8gKDEgLSAuMTIgKiBzZWxmLnRvdGFsQXJtb3JQaHlzaWNhbCgpKTtcbiAgICAgICAgfVxuICAgICAgICBlaHAgLz0gKDEgLSAoMSAtIChldmFzaW9uICogc2VsZi5hYmlsaXR5KCkuZ2V0RXZhc2lvbkJhY2t0cmFjaygpKSkpO1xuICAgICAgICBlaHAgLz0gKDEgLSBwYXJzZUZsb2F0KHNlbGYuZW5lbXkoKS5taXNzQ2hhbmNlKCkpIC8gMTAwKTtcbiAgICAgICAgZWhwICo9IChzZWxmLmludmVudG9yeS5hY3RpdmVJdGVtcygpLnNvbWUoZnVuY3Rpb24gKGl0ZW0pIHtyZXR1cm4gaXRlbS5pdGVtID09ICdtYXNrX29mX21hZG5lc3MnO30pID8gKDEgLyAxLjMpIDogMSk7XG4gICAgICAgIGVocCAqPSAoMSAvIHNlbGYuYWJpbGl0eSgpLmdldERhbWFnZVJlZHVjdGlvbigpKTtcbiAgICAgICAgZWhwICo9ICgxIC8gc2VsZi5idWZmcy5nZXREYW1hZ2VSZWR1Y3Rpb24oKSk7XG4gICAgICAgIGVocCAqPSAoMSAvIHNlbGYuZW5lbXkoKS5hYmlsaXR5KCkuZ2V0RGFtYWdlQW1wbGlmaWNhdGlvbigpKTtcbiAgICAgICAgZWhwICo9ICgxIC8gc2VsZi5kZWJ1ZmZzLmdldERhbWFnZUFtcGxpZmljYXRpb24oKSk7XG4gICAgICAgIHJldHVybiBlaHAudG9GaXhlZCgyKTtcbiAgICB9KTtcbiAgICBzZWxmLmVocE1hZ2ljYWwgPSBrby5wdXJlQ29tcHV0ZWQoZnVuY3Rpb24gKCkge1xuICAgICAgICB2YXIgZWhwID0gc2VsZi5oZWFsdGgoKSAvIHNlbGYudG90YWxNYWdpY1Jlc2lzdGFuY2VQcm9kdWN0KCk7XG4gICAgICAgIGVocCAqPSAoc2VsZi5pbnZlbnRvcnkuYWN0aXZlSXRlbXMoKS5zb21lKGZ1bmN0aW9uIChpdGVtKSB7cmV0dXJuIGl0ZW0uaXRlbSA9PSAnbWFza19vZl9tYWRuZXNzJzt9KSA/ICgxIC8gMS4zKSA6IDEpO1xuICAgICAgICBlaHAgKj0gKDEgLyBzZWxmLmFiaWxpdHkoKS5nZXREYW1hZ2VSZWR1Y3Rpb24oKSk7XG4gICAgICAgIGVocCAqPSAoMSAvIHNlbGYuYnVmZnMuZ2V0RGFtYWdlUmVkdWN0aW9uKCkpO1xuICAgICAgICBlaHAgKj0gKDEgLyBzZWxmLmFiaWxpdHkoKS5nZXRFdmFzaW9uQmFja3RyYWNrKCkpO1xuICAgICAgICBlaHAgKj0gKDEgLyBzZWxmLmVuZW15KCkuYWJpbGl0eSgpLmdldERhbWFnZUFtcGxpZmljYXRpb24oKSk7XG4gICAgICAgIGVocCAqPSAoMSAvIHNlbGYuZGVidWZmcy5nZXREYW1hZ2VBbXBsaWZpY2F0aW9uKCkpO1xuICAgICAgICByZXR1cm4gZWhwLnRvRml4ZWQoMik7XG4gICAgfSk7XG4gICAgc2VsZi5iYXNoID0ga28ucHVyZUNvbXB1dGVkKGZ1bmN0aW9uICgpIHtcbiAgICAgICAgdmFyIGF0dGFja3R5cGUgPSBzZWxmLmhlcm9EYXRhKCkuYXR0YWNrdHlwZTtcbiAgICAgICAgcmV0dXJuICgoMSAtIChzZWxmLmludmVudG9yeS5nZXRCYXNoKGF0dGFja3R5cGUpICogc2VsZi5hYmlsaXR5KCkuZ2V0QmFzaCgpKSkgKiAxMDApLnRvRml4ZWQoMik7XG4gICAgfSk7XG4gICAgXG4gICAgc2VsZi5jcml0Q2hhbmNlID0ga28ucHVyZUNvbXB1dGVkKGZ1bmN0aW9uICgpIHtcbiAgICAgICAgcmV0dXJuICgoMSAtIChzZWxmLmludmVudG9yeS5nZXRDcml0Q2hhbmNlKCkgKiBzZWxmLmFiaWxpdHkoKS5nZXRDcml0Q2hhbmNlKCkpKSAqIDEwMCkudG9GaXhlZCgyKTtcbiAgICB9KTtcblxuICAgIG15LnByb3RvdHlwZS5IZXJvRGFtYWdlTWl4aW4oc2VsZik7XG4gICAgXG4gICAgLypzZWxmLmNyaXREYW1hZ2UgPSBrby5jb21wdXRlZChmdW5jdGlvbiAoKSB7XG4gICAgICAgIHNlbGYuY3JpdEluZm8oKTtcbiAgICAgICAgcmV0dXJuIDA7XG4gICAgfSk7Ki9cbiAgICBzZWxmLm1pc3NDaGFuY2UgPSBrby5wdXJlQ29tcHV0ZWQoZnVuY3Rpb24gKCkge1xuICAgICAgICB2YXIgbWlzc0RlYnVmZiA9IFtzZWxmLmVuZW15KCkuaW52ZW50b3J5LmdldE1pc3NDaGFuY2UsIHNlbGYuZGVidWZmcy5pdGVtQnVmZnMuZ2V0TWlzc0NoYW5jZV0ucmVkdWNlKGZ1bmN0aW9uIChtZW1vLCBmbikge1xuICAgICAgICAgICAgdmFyIG9iaiA9IGZuKG1lbW8uZXhjbHVkZUxpc3QpO1xuICAgICAgICAgICAgb2JqLnZhbHVlICo9IG1lbW8udmFsdWU7XG4gICAgICAgICAgICByZXR1cm4gb2JqO1xuICAgICAgICB9LCB7dmFsdWU6MSwgZXhjbHVkZUxpc3Q6W119KTtcbiAgICAgICAgcmV0dXJuICgoMSAtIChzZWxmLmVuZW15KCkuYWJpbGl0eSgpLmdldE1pc3NDaGFuY2UoKSAqIHNlbGYuZGVidWZmcy5nZXRNaXNzQ2hhbmNlKCkgKiBtaXNzRGVidWZmLnZhbHVlKSkgKiAxMDApLnRvRml4ZWQoMik7XG4gICAgfSk7XG4gICAgc2VsZi50b3RhbGF0dGFja3JhbmdlID0ga28ucHVyZUNvbXB1dGVkKGZ1bmN0aW9uICgpIHtcbiAgICAgICAgdmFyIGF0dGFja3R5cGUgPSBzZWxmLmhlcm9EYXRhKCkuYXR0YWNrdHlwZTtcbiAgICAgICAgcmV0dXJuIHNlbGYuaGVyb0RhdGEoKS5hdHRhY2tyYW5nZSArIHNlbGYuYWJpbGl0eSgpLmdldEF0dGFja1JhbmdlKCkgKyBzZWxmLmludmVudG9yeS5nZXRBdHRhY2tSYW5nZShhdHRhY2t0eXBlKS52YWx1ZTtcbiAgICB9KTtcbiAgICBzZWxmLnZpc2lvbnJhbmdlZGF5ID0ga28ucHVyZUNvbXB1dGVkKGZ1bmN0aW9uICgpIHtcbiAgICAgICAgcmV0dXJuIChzZWxmLmhlcm9EYXRhKCkudmlzaW9uZGF5dGltZXJhbmdlKSAqICgxICsgc2VsZi5lbmVteSgpLmFiaWxpdHkoKS5nZXRWaXNpb25SYW5nZVBjdFJlZHVjdGlvbigpICsgc2VsZi5kZWJ1ZmZzLmdldFZpc2lvblJhbmdlUGN0UmVkdWN0aW9uKCkpO1xuICAgIH0pO1xuICAgIHNlbGYudmlzaW9ucmFuZ2VuaWdodCA9IGtvLnB1cmVDb21wdXRlZChmdW5jdGlvbiAoKSB7XG4gICAgICAgIHJldHVybiAoc2VsZi5oZXJvRGF0YSgpLnZpc2lvbm5pZ2h0dGltZXJhbmdlICsgc2VsZi5pbnZlbnRvcnkuZ2V0VmlzaW9uUmFuZ2VOaWdodCgpICsgc2VsZi5hYmlsaXR5KCkuZ2V0VmlzaW9uUmFuZ2VOaWdodCgpKSAqICgxICsgc2VsZi5lbmVteSgpLmFiaWxpdHkoKS5nZXRWaXNpb25SYW5nZVBjdFJlZHVjdGlvbigpICsgc2VsZi5kZWJ1ZmZzLmdldFZpc2lvblJhbmdlUGN0UmVkdWN0aW9uKCkpO1xuICAgIH0pO1xuICAgIHNlbGYubGlmZXN0ZWFsID0ga28ucHVyZUNvbXB1dGVkKGZ1bmN0aW9uICgpIHtcbiAgICAgICAgdmFyIHRvdGFsID0gc2VsZi5pbnZlbnRvcnkuZ2V0TGlmZXN0ZWFsKCkgKyBzZWxmLmFiaWxpdHkoKS5nZXRMaWZlc3RlYWwoKSArIHNlbGYuYnVmZnMuZ2V0TGlmZXN0ZWFsKCk7XG4gICAgICAgIGlmIChzZWxmLmhlcm9EYXRhKCkuYXR0YWNrdHlwZSA9PSAnRE9UQV9VTklUX0NBUF9NRUxFRV9BVFRBQ0snKSB7XG4gICAgICAgICAgICB2YXIgbGlmZXN0ZWFsQXVyYSA9IFtzZWxmLmludmVudG9yeS5nZXRMaWZlc3RlYWxBdXJhLCBzZWxmLmJ1ZmZzLml0ZW1CdWZmcy5nZXRMaWZlc3RlYWxBdXJhXS5yZWR1Y2UoZnVuY3Rpb24gKG1lbW8sIGZuKSB7XG4gICAgICAgICAgICAgICAgdmFyIG9iaiA9IGZuKG1lbW8uZXhjbHVkZUxpc3QpO1xuICAgICAgICAgICAgICAgIG9iai52YWx1ZSArPSBtZW1vLnZhbHVlO1xuICAgICAgICAgICAgICAgIHJldHVybiBvYmo7XG4gICAgICAgICAgICB9LCB7dmFsdWU6IDAsIGV4Y2x1ZGVMaXN0OiBbXX0pO1xuICAgICAgICAgICAgdG90YWwgKz0gbGlmZXN0ZWFsQXVyYS52YWx1ZTtcbiAgICAgICAgfVxuICAgICAgICByZXR1cm4gKHRvdGFsKS50b0ZpeGVkKDIpO1xuICAgIH0pO1xuICAgIFxuICAgIHNlbGYuYWRkSWxsdXNpb24gPSBmdW5jdGlvbiAoZGF0YSwgZXZlbnQpIHtcbiAgICAgICAgc2VsZi5pbGx1c2lvbnMucHVzaChrby5vYnNlcnZhYmxlKG5ldyBteS5wcm90b3R5cGUuSWxsdXNpb25WaWV3TW9kZWwoMCwgc2VsZiwgc2VsZi5pbGx1c2lvbkFiaWxpdHlMZXZlbCgpKSkpO1xuICAgIH07XG4gICAgXG4gICAgc2VsZi5kaWZmUHJvcGVydGllcyA9IG15LnByb3RvdHlwZS5kaWZmUHJvcGVydGllcztcbiAgICBzZWxmLmRpZmYgPSB7fTtcblxuICAgIGZvciAodmFyIGkgPSAwOyBpIDwgc2VsZi5kaWZmUHJvcGVydGllcy5sZW5ndGg7IGkrKykge1xuICAgICAgICB2YXIgaW5kZXggPSBpO1xuICAgICAgICBzZWxmLmRpZmZbc2VsZi5kaWZmUHJvcGVydGllc1tpbmRleF1dID0gc2VsZi5nZXREaWZmRnVuY3Rpb24oc2VsZi5kaWZmUHJvcGVydGllc1tpbmRleF0pO1xuICAgIH1cbn07XG5cbm15LnByb3RvdHlwZS5IZXJvTW9kZWwucHJvdG90eXBlLmdldERpZmZGdW5jdGlvbiA9IGZ1bmN0aW9uIChwcm9wKSB7XG4gICAgdmFyIHNlbGYgPSB0aGlzO1xuICAgIHJldHVybiBrby5jb21wdXRlZChmdW5jdGlvbiAoKSB7XG4gICAgICAgIGlmIChwcm9wID09ICdiYXNlRGFtYWdlJykge1xuICAgICAgICAgICAgcmV0dXJuIFtzZWxmW3Byb3BdKClbMF0gLSBzZWxmLmhlcm9Db21wYXJlKClbcHJvcF0oKVswXSwgc2VsZltwcm9wXSgpWzFdIC0gc2VsZi5oZXJvQ29tcGFyZSgpW3Byb3BdKClbMV1dO1xuICAgICAgICB9XG4gICAgICAgIGVsc2Uge1xuICAgICAgICAgICAgcmV0dXJuIHNlbGZbcHJvcF0oKSAtIHNlbGYuaGVyb0NvbXBhcmUoKVtwcm9wXSgpO1xuICAgICAgICB9XG4gICAgfSwgdGhpcywgeyBkZWZlckV2YWx1YXRpb246IHRydWUgfSk7XG59XG5cbm15LnByb3RvdHlwZS5IZXJvTW9kZWwucHJvdG90eXBlLmdldEFiaWxpdHlMZXZlbE1heCA9IGZ1bmN0aW9uIChkYXRhKSB7XG4gICAgaWYgKGRhdGEuYWJpbGl0eXR5cGUgPT09ICdET1RBX0FCSUxJVFlfVFlQRV9BVFRSSUJVVEVTJykge1xuICAgICAgICByZXR1cm4gMTA7XG4gICAgfVxuICAgIGVsc2UgaWYgKGRhdGEubmFtZSA9PT0gJ2ludm9rZXJfcXVhcycgfHwgZGF0YS5uYW1lID09PSAnaW52b2tlcl93ZXgnIHx8IGRhdGEubmFtZSA9PT0gJ2ludm9rZXJfZXhvcnQnKSB7XG4gICAgICAgIHJldHVybiA3O1xuICAgIH1cbiAgICBlbHNlIGlmIChkYXRhLm5hbWUgPT09ICdpbnZva2VyX2ludm9rZScpIHtcbiAgICAgICAgcmV0dXJuIDQ7XG4gICAgfVxuICAgIGVsc2UgaWYgKGRhdGEubmFtZSA9PT0gJ2VhcnRoX3NwaXJpdF9zdG9uZV9jYWxsZXInIHx8IGRhdGEubmFtZSA9PT0gJ29ncmVfbWFnaV91bnJlZmluZWRfZmlyZWJsYXN0Jykge1xuICAgICAgICByZXR1cm4gMTtcbiAgICB9XG4gICAgZWxzZSBpZiAoZGF0YS5hYmlsaXR5dHlwZSA9PT0gJ0RPVEFfQUJJTElUWV9UWVBFX1VMVElNQVRFJyB8fCBkYXRhLm5hbWUgPT09ICdrZWVwZXJfb2ZfdGhlX2xpZ2h0X3JlY2FsbCcgfHxcbiAgICAgICAgICAgICBkYXRhLm5hbWUgPT09ICdrZWVwZXJfb2ZfdGhlX2xpZ2h0X2JsaW5kaW5nX2xpZ2h0JyB8fCBkYXRhLm5hbWUgPT09ICdlbWJlcl9zcGlyaXRfYWN0aXZhdGVfZmlyZV9yZW1uYW50JyB8fFxuICAgICAgICAgICAgIGRhdGEubmFtZSA9PT0gJ2xvbmVfZHJ1aWRfdHJ1ZV9mb3JtX2JhdHRsZV9jcnknKSB7XG4gICAgICAgIHJldHVybiAzO1xuICAgIH1cbiAgICBlbHNlIGlmIChkYXRhLm5hbWUgPT09ICdwdWNrX2V0aGVyZWFsX2phdW50JyAgfHwgZGF0YS5uYW1lID09PSAnc2hhZG93X2RlbW9uX3NoYWRvd19wb2lzb25fcmVsZWFzZScgfHxcbiAgICAgICAgICAgICBkYXRhLm5hbWUgPT09ICd0ZW1wbGFyX2Fzc2Fzc2luX3RyYXAnIHx8IGRhdGEubmFtZSA9PT0gJ3NwZWN0cmVfcmVhbGl0eScpIHtcbiAgICAgICAgcmV0dXJuIDA7XG4gICAgfVxuICAgIGVsc2UgaWYgKGRhdGEubmFtZSA9PT0gJ2ludm9rZXJfY29sZF9zbmFwJyAgfHwgZGF0YS5uYW1lID09PSAnaW52b2tlcl9naG9zdF93YWxrJyB8fCBkYXRhLm5hbWUgPT09ICdpbnZva2VyX3Rvcm5hZG8nIHx8IFxuICAgICAgICAgICAgIGRhdGEubmFtZSA9PT0gJ2ludm9rZXJfZW1wJyB8fCBkYXRhLm5hbWUgPT09ICdpbnZva2VyX2FsYWNyaXR5JyB8fCBkYXRhLm5hbWUgPT09ICdpbnZva2VyX2NoYW9zX21ldGVvcicgfHwgXG4gICAgICAgICAgICAgZGF0YS5uYW1lID09PSAnaW52b2tlcl9zdW5fc3RyaWtlJyB8fCBkYXRhLm5hbWUgPT09ICdpbnZva2VyX2ZvcmdlX3NwaXJpdCcgfHwgZGF0YS5uYW1lID09PSAnaW52b2tlcl9pY2Vfd2FsbCcgfHwgXG4gICAgICAgICAgICAgZGF0YS5uYW1lID09PSAnaW52b2tlcl9kZWFmZW5pbmdfYmxhc3QnKSB7XG4gICAgICAgIHJldHVybiAwO1xuICAgIH1cbiAgICBlbHNlIGlmIChkYXRhLm5hbWUgPT09ICd0ZWNoaWVzX21pbmVmaWVsZF9zaWduJyB8fCBkYXRhLm5hbWUgPT09ICd0ZWNoaWVzX2ZvY3VzZWRfZGV0b25hdGUnKSB7XG4gICAgICAgIHJldHVybiAwO1xuICAgIH1cbiAgICBlbHNlIHtcbiAgICAgICAgcmV0dXJuIDQ7XG4gICAgfVxufTsiLCIndXNlIHN0cmljdCc7XG52YXIga28gPSByZXF1aXJlKCcuL2hlcm9jYWxjX2tub2Nrb3V0Jyk7XG5cbnZhciBteSA9IHJlcXVpcmUoXCIuL2hlcm9jYWxjX2NvcmVcIik7XG5cbm15LnByb3RvdHlwZS5DbG9uZU9wdGlvbiA9IGZ1bmN0aW9uIChuYW1lLCBkaXNwbGF5bmFtZSwgbGV2ZWxzLCBpbWFnZSwgbGV2ZWwpIHtcbiAgICB0aGlzLmhlcm9OYW1lID0ga28uY29tcHV0ZWQoZnVuY3Rpb24oKSB7XG4gICAgICAgIHJldHVybiAobGV2ZWxzID4gMCkgPyBuYW1lICsgKGxldmVsKCkgPD0gbGV2ZWxzID8gbGV2ZWwoKSA6IDEpIDogbmFtZTtcbiAgICB9KTtcbiAgICB0aGlzLmhlcm9EaXNwbGF5TmFtZSA9IGRpc3BsYXluYW1lO1xuICAgIHRoaXMuaW1hZ2UgPSBpbWFnZTtcbiAgICB0aGlzLmxldmVscyA9IGxldmVscztcbn07XG5cbm15LnByb3RvdHlwZS5DbG9uZVZpZXdNb2RlbCA9IGZ1bmN0aW9uIChoLHApIHtcbiAgICB2YXIgc2VsZiA9IG5ldyBteS5wcm90b3R5cGUuSGVyb01vZGVsKGgpO1xuICAgIHNlbGYucGFyZW50ID0gcDtcbiAgICAvKnNlbGYuc2VsZWN0ZWRIZXJvKG15LnByb3RvdHlwZS5maW5kV2hlcmUoc2VsZi5hdmFpbGFibGVIZXJvZXMoKSwge2hlcm9OYW1lOiAnbWVlcG8nfSkpO1xuICAgIHNlbGYuaGVybyA9IGtvLmNvbXB1dGVkKGZ1bmN0aW9uKCkge1xuICAgICAgICByZXR1cm4ga28ud3JhcC5mcm9tSlMobXkucHJvdG90eXBlLmhlcm9EYXRhWyducGNfZG90YV9oZXJvX21lZXBvJ10pO1xuICAgIH0pOyovXG4gICAgcmV0dXJuIHNlbGY7XG59IiwiJ3VzZSBzdHJpY3QnO1xudmFyIGtvID0gcmVxdWlyZSgnLi9oZXJvY2FsY19rbm9ja291dCcpO1xuICAgIFxudmFyIG15ID0gcmVxdWlyZShcIi4vaGVyb2NhbGNfY29yZVwiKTtcblxubXkucHJvdG90eXBlLkRhbWFnZVR5cGVDb2xvciA9IHtcbiAgICAncGh5c2ljYWwnOiAnIzk3OWFhMicsXG4gICAgJ3B1cmUnOiAnZ29sZGVucm9kJyxcbiAgICAnbWFnaWMnOiAnIzQyOGJjYScsXG4gICAgJ2RlZmF1bHQnOiAnIzk3OWFhMidcbn1cblxubXkucHJvdG90eXBlLkhlcm9EYW1hZ2VNaXhpbiA9IGZ1bmN0aW9uIChzZWxmKSB7XG4gICAgc2VsZi5jcml0SW5mbyA9IGtvLnB1cmVDb21wdXRlZChmdW5jdGlvbiAoKSB7XG4gICAgICAgIHZhciBjcml0U291cmNlcyA9IHNlbGYuaW52ZW50b3J5LmdldENyaXRTb3VyY2UoKTtcbiAgICAgICAgbXkucHJvdG90eXBlLmV4dGVuZChjcml0U291cmNlcywgc2VsZi5hYmlsaXR5KCkuZ2V0Q3JpdFNvdXJjZSgpKTtcbiAgICAgICAgbXkucHJvdG90eXBlLmV4dGVuZChjcml0U291cmNlcywgc2VsZi5idWZmcy5nZXRDcml0U291cmNlKCkpO1xuICAgICAgICB2YXIgY3JpdFNvdXJjZXNBcnJheSA9IFtdO1xuICAgICAgICBmb3IgKHZhciBwcm9wIGluIGNyaXRTb3VyY2VzKSB7XG4gICAgICAgICAgICB2YXIgZWwgPSBjcml0U291cmNlc1twcm9wXTtcbiAgICAgICAgICAgIGVsLm5hbWUgPSBwcm9wXG4gICAgICAgICAgICBjcml0U291cmNlc0FycmF5LnB1c2goZWwpO1xuICAgICAgICB9XG4gICAgICAgIGZ1bmN0aW9uIGNvbXBhcmVCeU11bHRpcGxpZXIoYSxiKSB7XG4gICAgICAgICAgICBpZiAoYS5tdWx0aXBsaWVyIDwgYi5tdWx0aXBsaWVyKVxuICAgICAgICAgICAgICAgIHJldHVybiAxO1xuICAgICAgICAgICAgaWYgKGEubXVsdGlwbGllciA+IGIubXVsdGlwbGllcilcbiAgICAgICAgICAgICAgICByZXR1cm4gLTE7XG4gICAgICAgICAgICByZXR1cm4gMDtcbiAgICAgICAgfVxuXG4gICAgICAgIGNyaXRTb3VyY2VzQXJyYXkuc29ydChjb21wYXJlQnlNdWx0aXBsaWVyKTtcbiAgICAgICAgXG4gICAgICAgIHZhciByZXN1bHQgPSBbXTtcbiAgICAgICAgdmFyIGNyaXRUb3RhbCA9IDA7XG4gICAgICAgIGZvciAodmFyIGkgPSAwOyBpIDwgY3JpdFNvdXJjZXNBcnJheS5sZW5ndGg7IGkrKykge1xuICAgICAgICAgICAgdmFyIHRvdGFsID0gMTtcbiAgICAgICAgICAgIGZvciAodmFyIGogPSAwOyBqIDwgaTsgaisrKSB7XG4gICAgICAgICAgICAgICAgZm9yICh2YXIgayA9IDA7IGsgPGNyaXRTb3VyY2VzQXJyYXlbal0uY291bnQ7IGsrKykge1xuICAgICAgICAgICAgICAgICAgICB0b3RhbCAqPSAoMSAtIGNyaXRTb3VyY2VzQXJyYXlbal0uY2hhbmNlKTtcbiAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICB9XG4gICAgICAgICAgICB2YXIgdG90YWwyID0gMTtcbiAgICAgICAgICAgIGZvciAodmFyIGsgPSAwOyBrIDwgY3JpdFNvdXJjZXNBcnJheVtpXS5jb3VudDsgaysrKSB7XG4gICAgICAgICAgICAgICAgdG90YWwyICo9ICgxIC0gY3JpdFNvdXJjZXNBcnJheVtpXS5jaGFuY2UpO1xuICAgICAgICAgICAgfVxuICAgICAgICAgICAgdG90YWwgKj0gKDEgLSB0b3RhbDIpO1xuICAgICAgICAgICAgY3JpdFRvdGFsICs9IHRvdGFsO1xuICAgICAgICAgICAgaWYgKGNyaXRTb3VyY2VzQXJyYXlbaV0uY291bnQgPiAxKSB7XG4gICAgICAgICAgICAgICAgcmVzdWx0LnB1c2goe1xuICAgICAgICAgICAgICAgICAgICAnbmFtZSc6Y3JpdFNvdXJjZXNBcnJheVtpXS5kaXNwbGF5bmFtZSArICcgeCcgKyBjcml0U291cmNlc0FycmF5W2ldLmNvdW50LFxuICAgICAgICAgICAgICAgICAgICAnY2hhbmNlJzpjcml0U291cmNlc0FycmF5W2ldLmNoYW5jZSxcbiAgICAgICAgICAgICAgICAgICAgJ211bHRpcGxpZXInOmNyaXRTb3VyY2VzQXJyYXlbaV0ubXVsdGlwbGllcixcbiAgICAgICAgICAgICAgICAgICAgJ2NvdW50Jzpjcml0U291cmNlc0FycmF5W2ldLmNvdW50LFxuICAgICAgICAgICAgICAgICAgICAndG90YWxDaGFuY2UnOnRvdGFsXG4gICAgICAgICAgICAgICAgfSk7XG4gICAgICAgICAgICB9XG4gICAgICAgICAgICBlbHNlIHtcbiAgICAgICAgICAgICAgICByZXN1bHQucHVzaCh7XG4gICAgICAgICAgICAgICAgICAgICduYW1lJzpjcml0U291cmNlc0FycmF5W2ldLmRpc3BsYXluYW1lLFxuICAgICAgICAgICAgICAgICAgICAnY2hhbmNlJzpjcml0U291cmNlc0FycmF5W2ldLmNoYW5jZSxcbiAgICAgICAgICAgICAgICAgICAgJ211bHRpcGxpZXInOmNyaXRTb3VyY2VzQXJyYXlbaV0ubXVsdGlwbGllcixcbiAgICAgICAgICAgICAgICAgICAgJ2NvdW50Jzpjcml0U291cmNlc0FycmF5W2ldLmNvdW50LFxuICAgICAgICAgICAgICAgICAgICAndG90YWxDaGFuY2UnOnRvdGFsXG4gICAgICAgICAgICAgICAgfSk7XG4gICAgICAgICAgICB9XG4gICAgICAgIH1cbiAgICAgICAgcmV0dXJuIHsgc291cmNlczogcmVzdWx0LCB0b3RhbDogY3JpdFRvdGFsIH07XG4gICAgfSk7XG5cbiAgICBzZWxmLmNsZWF2ZUluZm8gPSBrby5wdXJlQ29tcHV0ZWQoZnVuY3Rpb24gKCkge1xuICAgICAgICB2YXIgY2xlYXZlU291cmNlcyA9IHNlbGYuaW52ZW50b3J5LmdldENsZWF2ZVNvdXJjZSgpO1xuICAgICAgICBteS5wcm90b3R5cGUuZXh0ZW5kKGNsZWF2ZVNvdXJjZXMsIHNlbGYuYWJpbGl0eSgpLmdldENsZWF2ZVNvdXJjZSgpKTtcbiAgICAgICAgbXkucHJvdG90eXBlLmV4dGVuZChjbGVhdmVTb3VyY2VzLCBzZWxmLmJ1ZmZzLmdldENsZWF2ZVNvdXJjZSgpKTtcbiAgICAgICAgdmFyIGNsZWF2ZVNvdXJjZXNBcnJheSA9IFtdO1xuICAgICAgICBmb3IgKHZhciBwcm9wIGluIGNsZWF2ZVNvdXJjZXMpIHtcbiAgICAgICAgICAgIHZhciBlbCA9IGNsZWF2ZVNvdXJjZXNbcHJvcF07XG4gICAgICAgICAgICBlbC5uYW1lID0gcHJvcFxuICAgICAgICAgICAgY2xlYXZlU291cmNlc0FycmF5LnB1c2goZWwpO1xuICAgICAgICB9XG4gICAgICAgIGZ1bmN0aW9uIGNvbXBhcmVCeVJhZGl1cyhhLGIpIHtcbiAgICAgICAgICAgIGlmIChhLnJhZGl1cyA8IGIucmFkaXVzKVxuICAgICAgICAgICAgICAgIHJldHVybiAxO1xuICAgICAgICAgICAgaWYgKGEucmFkaXVzID4gYi5yYWRpdXMpXG4gICAgICAgICAgICAgICAgcmV0dXJuIC0xO1xuICAgICAgICAgICAgcmV0dXJuIDA7XG4gICAgICAgIH1cblxuICAgICAgICBjbGVhdmVTb3VyY2VzQXJyYXkuc29ydChjb21wYXJlQnlSYWRpdXMpO1xuICAgICAgICB2YXIgY2xlYXZlU291cmNlc0J5UmFkaXVzID0ge307XG4gICAgICAgIGZvciAodmFyIGkgPSAwOyBpIDwgY2xlYXZlU291cmNlc0FycmF5Lmxlbmd0aDsgaSsrKSB7XG4gICAgICAgICAgICB2YXIgdG90YWwgPSAwO1xuICAgICAgICAgICAgZm9yICh2YXIgaiA9IDA7IGogPGNsZWF2ZVNvdXJjZXNBcnJheS5sZW5ndGg7IGorKykge1xuICAgICAgICAgICAgICAgIGlmIChjbGVhdmVTb3VyY2VzQXJyYXlbal0ucmFkaXVzID49IGNsZWF2ZVNvdXJjZXNBcnJheVtpXS5yYWRpdXMpIHtcbiAgICAgICAgICAgICAgICAgICAgdG90YWwgKz0gY2xlYXZlU291cmNlc0FycmF5W2pdLm1hZ25pdHVkZSAqIGNsZWF2ZVNvdXJjZXNBcnJheVtqXS5jb3VudDtcbiAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICB9XG4gICAgICAgICAgICBjbGVhdmVTb3VyY2VzQnlSYWRpdXNbY2xlYXZlU291cmNlc0FycmF5W2ldLnJhZGl1c10gPSB0b3RhbDtcbiAgICAgICAgfVxuICAgICAgICB2YXIgcmVzdWx0ID0gW107XG4gICAgICAgIGZvciAodmFyIHByb3AgaW4gY2xlYXZlU291cmNlc0J5UmFkaXVzKSB7XG4gICAgICAgICAgICByZXN1bHQucHVzaCh7XG4gICAgICAgICAgICAgICAgJ3JhZGl1cyc6cHJvcCxcbiAgICAgICAgICAgICAgICAnbWFnbml0dWRlJzpjbGVhdmVTb3VyY2VzQnlSYWRpdXNbcHJvcF1cbiAgICAgICAgICAgIH0pO1xuICAgICAgICB9XG4gICAgICAgIHJldHVybiByZXN1bHQ7XG4gICAgfSk7XG4gICAgXG4gICAgc2VsZi5iYXNoSW5mbyA9IGtvLnB1cmVDb21wdXRlZChmdW5jdGlvbiAoKSB7XG4gICAgICAgIHZhciBhdHRhY2t0eXBlID0gc2VsZi5oZXJvRGF0YSgpLmF0dGFja3R5cGU7XG4gICAgICAgIHZhciBiYXNoU291cmNlcyA9IHNlbGYuaW52ZW50b3J5LmdldEJhc2hTb3VyY2UoYXR0YWNrdHlwZSk7XG4gICAgICAgIG15LnByb3RvdHlwZS5leHRlbmQoYmFzaFNvdXJjZXMsIHNlbGYuYWJpbGl0eSgpLmdldEJhc2hTb3VyY2UoKSk7XG4gICAgICAgIHZhciBiYXNoU291cmNlc0FycmF5ID0gW107XG4gICAgICAgIGZvciAodmFyIHByb3AgaW4gYmFzaFNvdXJjZXMpIHtcbiAgICAgICAgICAgIHZhciBlbCA9IGJhc2hTb3VyY2VzW3Byb3BdO1xuICAgICAgICAgICAgZWwubmFtZSA9IHByb3BcbiAgICAgICAgICAgIGJhc2hTb3VyY2VzQXJyYXkucHVzaChlbCk7XG4gICAgICAgIH1cbiAgICAgICAgZnVuY3Rpb24gY29tcGFyZUJ5RHVyYXRpb24oYSwgYikge1xuICAgICAgICAgICAgaWYgKGEuZHVyYXRpb24gPCBiLmR1cmF0aW9uKVxuICAgICAgICAgICAgICAgIHJldHVybiAxO1xuICAgICAgICAgICAgaWYgKGEuZHVyYXRpb24gPiBiLmR1cmF0aW9uKVxuICAgICAgICAgICAgICAgIHJldHVybiAtMTtcbiAgICAgICAgICAgIHJldHVybiAwO1xuICAgICAgICB9XG5cbiAgICAgICAgLy9iYXNoU291cmNlc0FycmF5LnNvcnQoY29tcGFyZUJ5RHVyYXRpb24pO1xuICAgICAgICBcbiAgICAgICAgdmFyIHJlc3VsdCA9IFtdO1xuICAgICAgICB2YXIgYmFzaFRvdGFsID0gMDtcbiAgICAgICAgZm9yICh2YXIgaSA9IDA7aSA8IGJhc2hTb3VyY2VzQXJyYXkubGVuZ3RoOyBpKyspIHtcbiAgICAgICAgICAgIHZhciB0b3RhbCA9IDE7XG4gICAgICAgICAgICBmb3IgKHZhciBqID0gMDsgaiA8IGk7IGorKykge1xuICAgICAgICAgICAgICAgIGZvciAodmFyIGsgPSAwOyBrIDwgYmFzaFNvdXJjZXNBcnJheVtqXS5jb3VudDsgaysrKSB7XG4gICAgICAgICAgICAgICAgICAgIHRvdGFsICo9ICgxIC0gYmFzaFNvdXJjZXNBcnJheVtqXS5jaGFuY2UpO1xuICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgIH1cbiAgICAgICAgICAgIHZhciB0b3RhbDIgPSAxO1xuICAgICAgICAgICAgZm9yICh2YXIgayA9IDA7IGsgPCBiYXNoU291cmNlc0FycmF5W2ldLmNvdW50OyBrKyspIHtcbiAgICAgICAgICAgICAgICB0b3RhbDIgKj0gKDEgLSBiYXNoU291cmNlc0FycmF5W2ldLmNoYW5jZSk7XG4gICAgICAgICAgICB9XG4gICAgICAgICAgICB0b3RhbCAqPSAoMSAtIHRvdGFsMik7XG4gICAgICAgICAgICBiYXNoVG90YWwgKz0gdG90YWw7XG4gICAgICAgICAgICBpZiAoYmFzaFNvdXJjZXNBcnJheVtpXS5uYW1lID09PSAnc3Bpcml0X2JyZWFrZXJfZ3JlYXRlcl9iYXNoJykge1xuICAgICAgICAgICAgICAgIHZhciBkID0gYmFzaFNvdXJjZXNBcnJheVtpXS5kYW1hZ2UgKiBzZWxmLnRvdGFsTW92ZW1lbnRTcGVlZCgpO1xuICAgICAgICAgICAgfVxuICAgICAgICAgICAgZWxzZSB7XG4gICAgICAgICAgICAgICAgdmFyIGQgPSBiYXNoU291cmNlc0FycmF5W2ldLmRhbWFnZTtcbiAgICAgICAgICAgIH1cbiAgICAgICAgICAgIGlmIChiYXNoU291cmNlc0FycmF5W2ldLmNvdW50ID4gMSkge1xuICAgICAgICAgICAgICAgIHJlc3VsdC5wdXNoKHtcbiAgICAgICAgICAgICAgICAgICAgJ25hbWUnOmJhc2hTb3VyY2VzQXJyYXlbaV0uZGlzcGxheW5hbWUsIC8vICsgJyB4JyArIGJhc2hTb3VyY2VzQXJyYXlbaV0uY291bnQsXG4gICAgICAgICAgICAgICAgICAgICdjaGFuY2UnOmJhc2hTb3VyY2VzQXJyYXlbaV0uY2hhbmNlLFxuICAgICAgICAgICAgICAgICAgICAnZGFtYWdlJzpkLFxuICAgICAgICAgICAgICAgICAgICAnY291bnQnOmJhc2hTb3VyY2VzQXJyYXlbaV0uY291bnQsXG4gICAgICAgICAgICAgICAgICAgICdkYW1hZ2VUeXBlJzpiYXNoU291cmNlc0FycmF5W2ldLmRhbWFnZVR5cGUsXG4gICAgICAgICAgICAgICAgICAgICd0b3RhbENoYW5jZSc6dG90YWxcbiAgICAgICAgICAgICAgICB9KTtcbiAgICAgICAgICAgIH1cbiAgICAgICAgICAgIGVsc2Uge1xuICAgICAgICAgICAgICAgIHJlc3VsdC5wdXNoKHtcbiAgICAgICAgICAgICAgICAgICAgJ25hbWUnOmJhc2hTb3VyY2VzQXJyYXlbaV0uZGlzcGxheW5hbWUsXG4gICAgICAgICAgICAgICAgICAgICdjaGFuY2UnOmJhc2hTb3VyY2VzQXJyYXlbaV0uY2hhbmNlLFxuICAgICAgICAgICAgICAgICAgICAnZGFtYWdlJzpkLFxuICAgICAgICAgICAgICAgICAgICAnY291bnQnOmJhc2hTb3VyY2VzQXJyYXlbaV0uY291bnQsXG4gICAgICAgICAgICAgICAgICAgICdkYW1hZ2VUeXBlJzpiYXNoU291cmNlc0FycmF5W2ldLmRhbWFnZVR5cGUsXG4gICAgICAgICAgICAgICAgICAgICd0b3RhbENoYW5jZSc6dG90YWxcbiAgICAgICAgICAgICAgICB9KTtcbiAgICAgICAgICAgIH1cblxuICAgICAgICB9XG4gICAgICAgIHJldHVybiB7IHNvdXJjZXM6IHJlc3VsdCwgdG90YWw6IGJhc2hUb3RhbCB9O1xuICAgIH0pO1xuICAgIFxuICAgIHNlbGYub3JiUHJvY0luZm8gPSBrby5wdXJlQ29tcHV0ZWQoZnVuY3Rpb24gKCkge1xuICAgICAgICB2YXIgYXR0YWNrdHlwZSA9IHNlbGYuaGVyb0RhdGEoKS5hdHRhY2t0eXBlO1xuICAgICAgICB2YXIgZGFtYWdlU291cmNlcyA9IHNlbGYuaW52ZW50b3J5LmdldE9yYlByb2NTb3VyY2UoKTtcbiAgICAgICAgdmFyIGRhbWFnZVNvdXJjZXNBcnJheSA9IFtdO1xuICAgICAgICBmb3IgKHZhciBwcm9wIGluIGRhbWFnZVNvdXJjZXMpIHtcbiAgICAgICAgICAgIHZhciBlbCA9IGRhbWFnZVNvdXJjZXNbcHJvcF07XG4gICAgICAgICAgICBlbC5uYW1lID0gcHJvcFxuICAgICAgICAgICAgZGFtYWdlU291cmNlc0FycmF5LnB1c2goZWwpO1xuICAgICAgICB9XG4gICAgICAgIGZ1bmN0aW9uIGNvbXBhcmVCeURhbWFnZShhLCBiKSB7XG4gICAgICAgICAgICBpZiAoYS5wcmlvcml0eSA+IGIucHJpb3JpdHkpIHtcbiAgICAgICAgICAgICAgICByZXR1cm4gMTtcbiAgICAgICAgICAgIH1cbiAgICAgICAgICAgIGlmIChhLnByaW9yaXR5IDwgYi5wcmlvcml0eSkge1xuICAgICAgICAgICAgICAgIHJldHVybiAtMTtcbiAgICAgICAgICAgIH1cbiAgICAgICAgICAgIGlmIChhLmRhbWFnZSA8IGIuZGFtYWdlKVxuICAgICAgICAgICAgICAgIHJldHVybiAxO1xuICAgICAgICAgICAgaWYgKGEuZGFtYWdlID4gYi5kYW1hZ2UpXG4gICAgICAgICAgICAgICAgcmV0dXJuIC0xO1xuICAgICAgICAgICAgcmV0dXJuIDA7XG4gICAgICAgIH1cblxuICAgICAgICBkYW1hZ2VTb3VyY2VzQXJyYXkuc29ydChjb21wYXJlQnlEYW1hZ2UpO1xuICAgICAgICBcbiAgICAgICAgdmFyIHJlc3VsdCA9IFtdO1xuICAgICAgICB2YXIgZGFtYWdlVG90YWwgPSAwO1xuICAgICAgICBmb3IgKHZhciBpPTAgOyBpIDwgZGFtYWdlU291cmNlc0FycmF5Lmxlbmd0aDsgaSsrKSB7XG4gICAgICAgICAgICB2YXIgdG90YWwgPSAxO1xuICAgICAgICAgICAgZm9yICh2YXIgaiA9IDA7IGogPCBpOyBqKyspIHtcbiAgICAgICAgICAgICAgICBmb3IgKHZhciBrID0gMDsgayA8IGRhbWFnZVNvdXJjZXNBcnJheVtqXS5jb3VudDsgaysrKSB7XG4gICAgICAgICAgICAgICAgICAgIHRvdGFsICo9ICgxIC0gZGFtYWdlU291cmNlc0FycmF5W2pdLmNoYW5jZSk7XG4gICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgfVxuICAgICAgICAgICAgdmFyIHRvdGFsMiA9IDE7XG4gICAgICAgICAgICBmb3IgKHZhciBrID0gMDsgayA8IGRhbWFnZVNvdXJjZXNBcnJheVtpXS5jb3VudDsgaysrKSB7XG4gICAgICAgICAgICAgICAgdG90YWwyICo9ICgxIC0gZGFtYWdlU291cmNlc0FycmF5W2ldLmNoYW5jZSk7XG4gICAgICAgICAgICB9XG4gICAgICAgICAgICB0b3RhbCAqPSAoMSAtIHRvdGFsMik7XG4gICAgICAgICAgICBkYW1hZ2VUb3RhbCArPSB0b3RhbDtcbiAgICAgICAgICAgIGlmIChkYW1hZ2VTb3VyY2VzQXJyYXlbaV0uY291bnQgPiAxKSB7XG4gICAgICAgICAgICAgICAgcmVzdWx0LnB1c2goe1xuICAgICAgICAgICAgICAgICAgICAnbmFtZSc6ZGFtYWdlU291cmNlc0FycmF5W2ldLmRpc3BsYXluYW1lICsgJyB4JyArIGRhbWFnZVNvdXJjZXNBcnJheVtpXS5jb3VudCxcbiAgICAgICAgICAgICAgICAgICAgJ2NoYW5jZSc6ZGFtYWdlU291cmNlc0FycmF5W2ldLmNoYW5jZSxcbiAgICAgICAgICAgICAgICAgICAgJ2RhbWFnZSc6ZGFtYWdlU291cmNlc0FycmF5W2ldLmRhbWFnZSxcbiAgICAgICAgICAgICAgICAgICAgJ2NvdW50JzpkYW1hZ2VTb3VyY2VzQXJyYXlbaV0uY291bnQsXG4gICAgICAgICAgICAgICAgICAgICdkYW1hZ2VUeXBlJzpkYW1hZ2VTb3VyY2VzQXJyYXlbaV0uZGFtYWdlVHlwZSxcbiAgICAgICAgICAgICAgICAgICAgJ3RvdGFsQ2hhbmNlJzp0b3RhbFxuICAgICAgICAgICAgICAgIH0pO1xuICAgICAgICAgICAgfVxuICAgICAgICAgICAgZWxzZSB7XG4gICAgICAgICAgICAgICAgcmVzdWx0LnB1c2goe1xuICAgICAgICAgICAgICAgICAgICAnbmFtZSc6ZGFtYWdlU291cmNlc0FycmF5W2ldLmRpc3BsYXluYW1lLFxuICAgICAgICAgICAgICAgICAgICAnY2hhbmNlJzpkYW1hZ2VTb3VyY2VzQXJyYXlbaV0uY2hhbmNlLFxuICAgICAgICAgICAgICAgICAgICAnZGFtYWdlJzpkYW1hZ2VTb3VyY2VzQXJyYXlbaV0uZGFtYWdlLFxuICAgICAgICAgICAgICAgICAgICAnY291bnQnOmRhbWFnZVNvdXJjZXNBcnJheVtpXS5jb3VudCxcbiAgICAgICAgICAgICAgICAgICAgJ2RhbWFnZVR5cGUnOmRhbWFnZVNvdXJjZXNBcnJheVtpXS5kYW1hZ2VUeXBlLFxuICAgICAgICAgICAgICAgICAgICAndG90YWxDaGFuY2UnOnRvdGFsXG4gICAgICAgICAgICAgICAgfSk7XG4gICAgICAgICAgICB9XG4gICAgICAgIH1cbiAgICAgICAgcmV0dXJuIHsgc291cmNlczogcmVzdWx0LCB0b3RhbDogZGFtYWdlVG90YWwgfTtcbiAgICB9KTtcbiAgICBcbiAgICBzZWxmLmdldFJlZHVjZWREYW1hZ2UgPSBmdW5jdGlvbiAodmFsdWUsIHR5cGUpIHtcbiAgICAgICAgdmFyIHJlc3VsdCA9IHZhbHVlO1xuICAgICAgICBzd2l0Y2ggKHR5cGUpIHtcbiAgICAgICAgICAgIGNhc2UgJ3BoeXNpY2FsJzpcbiAgICAgICAgICAgICAgICByZXN1bHQgPSB2YWx1ZSAqICgxIC0gKDAuMDYgKiBzZWxmLmVuZW15KCkudG90YWxBcm1vclBoeXNpY2FsKCkpIC8gKDEgKyAwLjA2ICogTWF0aC5hYnMoc2VsZi5lbmVteSgpLnRvdGFsQXJtb3JQaHlzaWNhbCgpKSkpO1xuICAgICAgICAgICAgYnJlYWs7XG4gICAgICAgICAgICBjYXNlICdtYWdpYyc6XG4gICAgICAgICAgICAgICAgcmVzdWx0ID0gdmFsdWUgKiAoMSAtIHNlbGYuZW5lbXkoKS50b3RhbE1hZ2ljUmVzaXN0YW5jZSgpIC8gMTAwKTtcbiAgICAgICAgICAgIGJyZWFrO1xuICAgICAgICAgICAgY2FzZSAncHVyZSc6XG4gICAgICAgICAgICAgICAgcmVzdWx0ID0gdmFsdWU7XG4gICAgICAgICAgICBicmVhaztcbiAgICAgICAgICAgIGNhc2UgJ2NvbXBvc2l0ZSc6XG4gICAgICAgICAgICAgICAgcmVzdWx0ID0gdmFsdWUgKiAoMSAtICgwLjA2ICogc2VsZi5lbmVteSgpLnRvdGFsQXJtb3JQaHlzaWNhbCgpKSAvICgxICsgMC4wNiAqIE1hdGguYWJzKHNlbGYuZW5lbXkoKS50b3RhbEFybW9yUGh5c2ljYWwoKSkpKTtcbiAgICAgICAgICAgICAgICByZXN1bHQgKj0gKDEgLSBzZWxmLmVuZW15KCkudG90YWxNYWdpY1Jlc2lzdGFuY2UoKSAvIDEwMCk7XG4gICAgICAgICAgICBicmVhaztcbiAgICAgICAgfVxuICAgICAgICByZXN1bHQgKj0gc2VsZi5hYmlsaXR5KCkuZ2V0RGFtYWdlQW1wbGlmaWNhdGlvbigpICogc2VsZi5kZWJ1ZmZzLmdldERhbWFnZUFtcGxpZmljYXRpb24oKTtcbiAgICAgICAgcmVzdWx0ICo9IHNlbGYuZW5lbXkoKS5hYmlsaXR5KCkuZ2V0RGFtYWdlUmVkdWN0aW9uKCkgKiBzZWxmLmVuZW15KCkuYnVmZnMuZ2V0RGFtYWdlUmVkdWN0aW9uKCk7XG4gICAgICAgIHJldHVybiByZXN1bHQ7XG4gICAgfVxuICAgIFxuICAgIHNlbGYuZGFtYWdlVG90YWxJbmZvID0ga28ucHVyZUNvbXB1dGVkKGZ1bmN0aW9uICgpIHtcbiAgICAgICAgdmFyIGJvbnVzRGFtYWdlQXJyYXkgPSBbXG4gICAgICAgICAgICBzZWxmLmFiaWxpdHkoKS5nZXRCb251c0RhbWFnZSgpLnNvdXJjZXMsXG4gICAgICAgICAgICBzZWxmLmJ1ZmZzLmdldEJvbnVzRGFtYWdlKCkuc291cmNlc1xuICAgICAgICBdLFxuICAgICAgICBib251c0RhbWFnZVBjdEFycmF5ID0gW1xuICAgICAgICAgICAgc2VsZi5hYmlsaXR5KCkuZ2V0Qm9udXNEYW1hZ2VQZXJjZW50KCkuc291cmNlcyxcbiAgICAgICAgICAgIHNlbGYuYnVmZnMuZ2V0Qm9udXNEYW1hZ2VQZXJjZW50KCkuc291cmNlc1xuICAgICAgICBdLFxuICAgICAgICBpdGVtQm9udXNEYW1hZ2UgPSBzZWxmLmludmVudG9yeS5nZXRCb251c0RhbWFnZSgpLnNvdXJjZXMsXG4gICAgICAgIGl0ZW1Cb251c0RhbWFnZVBjdCA9IHNlbGYuYnVmZnMuaXRlbUJ1ZmZzLmdldEJvbnVzRGFtYWdlUGVyY2VudChzZWxmLmludmVudG9yeS5nZXRCb251c0RhbWFnZVBlcmNlbnQoKSkuc291cmNlcyxcbiAgICAgICAgY3JpdFNvdXJjZXMgPSBzZWxmLmNyaXRJbmZvKCksXG4gICAgICAgIGFiaWxpdHlPcmJTb3VyY2VzID0gc2VsZi5hYmlsaXR5KCkuZ2V0T3JiU291cmNlKCksXG4gICAgICAgIGl0ZW1PcmJTb3VyY2VzID0gc2VsZi5pbnZlbnRvcnkuZ2V0T3JiU291cmNlKCksXG4gICAgICAgIGl0ZW1Qcm9jT3JiU291cmNlcyA9IHNlbGYub3JiUHJvY0luZm8oKSxcbiAgICAgICAgYmFzaFNvdXJjZXMgPSBzZWxmLmJhc2hJbmZvKCksXG4gICAgICAgIFxuICAgICAgICBhdHRhY2tTb3VyY2VzID0gW107XG4gICAgICAgIFxuICAgICAgICBhdHRhY2tTb3VyY2VzLnB1c2goe1xuICAgICAgICAgICAgbmFtZTogJ0Jhc2UgQXR0YWNrJyxcbiAgICAgICAgICAgIGNvb2xkb3duOiAxXG4gICAgICAgIH0pO1xuICAgICAgICBcbiAgICAgICAgLy8gd2VhdmVyX2dlbWluYXRlX2F0dGFja1xuICAgICAgICBpZiAoc2VsZi5oZXJvSWQoKSA9PT0gJ3dlYXZlcicpIHtcbiAgICAgICAgICAgIHZhciBhID0gc2VsZi5hYmlsaXR5KCkuYWJpbGl0aWVzKCkuZmluZChmdW5jdGlvbiAoYWJpbGl0eSkge1xuICAgICAgICAgICAgICAgIHJldHVybiBhYmlsaXR5Lm5hbWUgPT09ICd3ZWF2ZXJfZ2VtaW5hdGVfYXR0YWNrJztcbiAgICAgICAgICAgIH0pO1xuICAgICAgICAgICAgaWYgKGEpIHtcbiAgICAgICAgICAgICAgICBpZiAoYS5sZXZlbCgpID4gMCkge1xuICAgICAgICAgICAgICAgICAgICB2YXIgY2QgPSBhLmNvb2xkb3duW2EubGV2ZWwoKSAtIDFdO1xuICAgICAgICAgICAgICAgICAgICBhdHRhY2tTb3VyY2VzLnB1c2goe1xuICAgICAgICAgICAgICAgICAgICAgICAgbmFtZTogYS5kaXNwbGF5bmFtZSxcbiAgICAgICAgICAgICAgICAgICAgICAgIGNvb2xkb3duOiAoMS9jZClcbiAgICAgICAgICAgICAgICAgICAgfSk7XG4gICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgfVxuICAgICAgICB9XG4gICAgICAgIFxuICAgICAgICAvLyBlY2hvX3NhYnJlXG4gICAgICAgIHZhciBpdGVtID0gc2VsZi5pbnZlbnRvcnkuaXRlbXMoKS5maW5kKGZ1bmN0aW9uIChvKSB7IHJldHVybiBvLml0ZW0gPT09IFwiZWNob19zYWJyZVwiICYmIG8uZW5hYmxlZCgpOyB9KTtcbiAgICAgICAgaWYgKGl0ZW0gJiYgc2VsZi5oZXJvRGF0YSgpLmF0dGFja3R5cGUgPT09ICdET1RBX1VOSVRfQ0FQX01FTEVFX0FUVEFDSycpIHtcbiAgICAgICAgICAgIHZhciBpdGVtX2VjaG9fc2FicmUgPSBteS5wcm90b3R5cGUuaXRlbURhdGFbJ2l0ZW1fZWNob19zYWJyZSddO1xuICAgICAgICAgICAgYXR0YWNrU291cmNlcy5wdXNoKHtcbiAgICAgICAgICAgICAgICBuYW1lOiBpdGVtX2VjaG9fc2FicmUuZGlzcGxheW5hbWUsXG4gICAgICAgICAgICAgICAgY29vbGRvd246ICgxL2l0ZW1fZWNob19zYWJyZS5jb29sZG93bilcbiAgICAgICAgICAgIH0pO1xuICAgICAgICB9XG5cbiAgICAgICAgdmFyIGF0dGFja3MgPSBhdHRhY2tTb3VyY2VzLm1hcChmdW5jdGlvbiAoYSkge1xuICAgICAgICAgICAgdmFyIGJhc2VEYW1hZ2UgPSAoc2VsZi5iYXNlRGFtYWdlKClbMF0gKyBzZWxmLmJhc2VEYW1hZ2UoKVsxXSkgLyAyLFxuICAgICAgICAgICAgdG90YWxEYW1hZ2UgPSAwLFxuICAgICAgICAgICAgdG90YWxDcml0YWJsZURhbWFnZSA9IDAsXG4gICAgICAgICAgICB0b3RhbENyaXQgPSAwLFxuICAgICAgICAgICAgZ2VtaW5hdGVBdHRhY2sgPSB7IGRhbWFnZTogMCwgZGFtYWdlUmVkdWNlZDogMCwgY29vbGRvd246IDYsIGFjdGl2ZTogZmFsc2UgfSxcbiAgICAgICAgICAgIGVjaG9TYWJyZUF0dGFjayA9IHsgZGFtYWdlOiAwLCBkYW1hZ2VSZWR1Y2VkOiAwLCBjb29sZG93bjogbXkucHJvdG90eXBlLml0ZW1EYXRhWydpdGVtX2VjaG9fc2FicmUnXS5jb29sZG93blswXSwgYWN0aXZlOiBmYWxzZSB9LFxuICAgICAgICAgICAgZGFtYWdlID0ge1xuICAgICAgICAgICAgICAgIHB1cmU6IDAsXG4gICAgICAgICAgICAgICAgcGh5c2ljYWw6IDAsXG4gICAgICAgICAgICAgICAgbWFnaWM6IDBcbiAgICAgICAgICAgIH0sXG4gICAgICAgICAgICByZXN1bHQgPSBbXSxcbiAgICAgICAgICAgIGNyaXRzID0gW107XG4gICAgICAgICAgICBcbiAgICAgICAgICAgIC8vIGJhc2UgZGFtYWdlXG4gICAgICAgICAgICByZXN1bHQucHVzaCh7XG4gICAgICAgICAgICAgICAgbmFtZTogJ0Jhc2UgRGFtYWdlJyxcbiAgICAgICAgICAgICAgICBkYW1hZ2U6IGJhc2VEYW1hZ2UsXG4gICAgICAgICAgICAgICAgZGFtYWdlVHlwZTogJ3BoeXNpY2FsJyxcbiAgICAgICAgICAgICAgICBkYW1hZ2VSZWR1Y2VkOiBzZWxmLmdldFJlZHVjZWREYW1hZ2UoYmFzZURhbWFnZSwgJ3BoeXNpY2FsJyksXG4gICAgICAgICAgICAgICAgZW5hYmxlZDoga28ub2JzZXJ2YWJsZSh0cnVlKVxuICAgICAgICAgICAgfSk7XG4gICAgICAgICAgICB0b3RhbERhbWFnZSArPSBiYXNlRGFtYWdlO1xuICAgICAgICAgICAgdG90YWxDcml0YWJsZURhbWFnZSArPSBiYXNlRGFtYWdlO1xuICAgICAgICAgICAgZGFtYWdlLnBoeXNpY2FsICs9IGJhc2VEYW1hZ2U7XG4gICAgICAgICAgICBcbiAgICAgICAgICAgIC8vIGJvbnVzIGRhbWFnZSBmcm9tIGl0ZW1zXG4gICAgICAgICAgICBmb3IgKGkgaW4gaXRlbUJvbnVzRGFtYWdlKSB7XG4gICAgICAgICAgICAgICAgdmFyIGQgPSBpdGVtQm9udXNEYW1hZ2VbaV0uZGFtYWdlKml0ZW1Cb251c0RhbWFnZVtpXS5jb3VudCAqIHNlbGYuYWJpbGl0eSgpLmdldFNlbGZCYXNlRGFtYWdlUmVkdWN0aW9uUGN0KCkgKiBzZWxmLmVuZW15KCkuYWJpbGl0eSgpLmdldEJhc2VEYW1hZ2VSZWR1Y3Rpb25QY3QoKSAqIHNlbGYuZGVidWZmcy5pdGVtQnVmZnMuZ2V0QmFzZURhbWFnZVJlZHVjdGlvblBjdCgpO1xuICAgICAgICAgICAgICAgIHJlc3VsdC5wdXNoKHtcbiAgICAgICAgICAgICAgICAgICAgbmFtZTogaXRlbUJvbnVzRGFtYWdlW2ldLmRpc3BsYXluYW1lICsgKGl0ZW1Cb251c0RhbWFnZVtpXS5jb3VudCA+IDEgPyAnIHgnICsgaXRlbUJvbnVzRGFtYWdlW2ldLmNvdW50IDogJycpLFxuICAgICAgICAgICAgICAgICAgICBkYW1hZ2U6IGQsXG4gICAgICAgICAgICAgICAgICAgIGRhbWFnZVR5cGU6IGl0ZW1Cb251c0RhbWFnZVtpXS5kYW1hZ2VUeXBlLFxuICAgICAgICAgICAgICAgICAgICBkYW1hZ2VSZWR1Y2VkOiBzZWxmLmdldFJlZHVjZWREYW1hZ2UoZCwgaXRlbUJvbnVzRGFtYWdlW2ldLmRhbWFnZVR5cGUpLFxuICAgICAgICAgICAgICAgICAgICBlbmFibGVkOiBrby5vYnNlcnZhYmxlKHRydWUpXG4gICAgICAgICAgICAgICAgfSk7XG4gICAgICAgICAgICAgICAgdG90YWxEYW1hZ2UgKz0gZDtcbiAgICAgICAgICAgICAgICB0b3RhbENyaXRhYmxlRGFtYWdlICs9IGQ7XG4gICAgICAgICAgICAgICAgZGFtYWdlW2l0ZW1Cb251c0RhbWFnZVtpXS5kYW1hZ2VUeXBlXSArPSBkO1xuICAgICAgICAgICAgfVxuXG4gICAgICAgICAgICAvLyBib251cyBkYW1hZ2UgcGVyY2VudCBmcm9tIGl0ZW1zXG4gICAgICAgICAgICBmb3IgKGkgaW4gaXRlbUJvbnVzRGFtYWdlUGN0KSB7XG4gICAgICAgICAgICAgICAgdmFyIGQgPSBiYXNlRGFtYWdlICogaXRlbUJvbnVzRGFtYWdlUGN0W2ldLmRhbWFnZTtcbiAgICAgICAgICAgICAgICByZXN1bHQucHVzaCh7XG4gICAgICAgICAgICAgICAgICAgIG5hbWU6IGl0ZW1Cb251c0RhbWFnZVBjdFtpXS5kaXNwbGF5bmFtZSxcbiAgICAgICAgICAgICAgICAgICAgZGFtYWdlOiBkLFxuICAgICAgICAgICAgICAgICAgICBkYW1hZ2VUeXBlOiBpdGVtQm9udXNEYW1hZ2VQY3RbaV0uZGFtYWdlVHlwZSxcbiAgICAgICAgICAgICAgICAgICAgZGFtYWdlUmVkdWNlZDogc2VsZi5nZXRSZWR1Y2VkRGFtYWdlKGQsIGl0ZW1Cb251c0RhbWFnZVBjdFtpXS5kYW1hZ2VUeXBlKSxcbiAgICAgICAgICAgICAgICAgICAgZW5hYmxlZDoga28ub2JzZXJ2YWJsZSh0cnVlKVxuICAgICAgICAgICAgICAgIH0pO1xuICAgICAgICAgICAgICAgIHRvdGFsRGFtYWdlICs9IGQ7XG4gICAgICAgICAgICAgICAgdG90YWxDcml0YWJsZURhbWFnZSArPSBkO1xuICAgICAgICAgICAgICAgIGRhbWFnZVtpdGVtQm9udXNEYW1hZ2VQY3RbaV0uZGFtYWdlVHlwZV0gKz0gZDtcbiAgICAgICAgICAgIH1cbiAgICAgICAgICAgIFxuICAgICAgICAgICAgLy8gYm9udXMgZGFtYWdlIGZyb20gYWJpbGl0aWVzIGFuZCBidWZmc1xuICAgICAgICAgICAgZm9yICh2YXIgaSA9IDA7IGkgPCBib251c0RhbWFnZUFycmF5Lmxlbmd0aDsgaSsrKSB7XG4gICAgICAgICAgICAgICAgZm9yIChqIGluIGJvbnVzRGFtYWdlQXJyYXlbaV0pIHtcbiAgICAgICAgICAgICAgICAgICAgdmFyIGQgPSBib251c0RhbWFnZUFycmF5W2ldW2pdLmRhbWFnZTtcbiAgICAgICAgICAgICAgICAgICAgcmVzdWx0LnB1c2goe1xuICAgICAgICAgICAgICAgICAgICAgICAgbmFtZTogYm9udXNEYW1hZ2VBcnJheVtpXVtqXS5kaXNwbGF5bmFtZSxcbiAgICAgICAgICAgICAgICAgICAgICAgIGRhbWFnZTogZCxcbiAgICAgICAgICAgICAgICAgICAgICAgIGRhbWFnZVR5cGU6IGJvbnVzRGFtYWdlQXJyYXlbaV1bal0uZGFtYWdlVHlwZSxcbiAgICAgICAgICAgICAgICAgICAgICAgIGRhbWFnZVJlZHVjZWQ6IHNlbGYuZ2V0UmVkdWNlZERhbWFnZShkLCBib251c0RhbWFnZUFycmF5W2ldW2pdLmRhbWFnZVR5cGUpLFxuICAgICAgICAgICAgICAgICAgICAgICAgZW5hYmxlZDoga28ub2JzZXJ2YWJsZSh0cnVlKVxuICAgICAgICAgICAgICAgICAgICB9KTtcbiAgICAgICAgICAgICAgICAgICAgdG90YWxEYW1hZ2UgKz0gZDtcbiAgICAgICAgICAgICAgICAgICAgdG90YWxDcml0YWJsZURhbWFnZSArPSBkO1xuICAgICAgICAgICAgICAgICAgICBkYW1hZ2VbYm9udXNEYW1hZ2VBcnJheVtpXVtqXS5kYW1hZ2VUeXBlXSArPSBkO1xuICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgIH1cbiAgICAgICAgICAgIFxuICAgICAgICAgICAgLy8gYm9udXMgZGFtYWdlIHBlcmNlbnQgZnJvbSBhYmlsaXRpZXMgYW5kIGJ1ZmZzXG4gICAgICAgICAgICBmb3IgKHZhciBpID0gMDsgaSA8IGJvbnVzRGFtYWdlUGN0QXJyYXkubGVuZ3RoOyBpKyspIHtcbiAgICAgICAgICAgICAgICBmb3IgKGogaW4gYm9udXNEYW1hZ2VQY3RBcnJheVtpXSkge1xuICAgICAgICAgICAgICAgICAgICB2YXIgZCA9IGJhc2VEYW1hZ2UgKiBib251c0RhbWFnZVBjdEFycmF5W2ldW2pdLmRhbWFnZTtcbiAgICAgICAgICAgICAgICAgICAgcmVzdWx0LnB1c2goe1xuICAgICAgICAgICAgICAgICAgICAgICAgbmFtZTogYm9udXNEYW1hZ2VQY3RBcnJheVtpXVtqXS5kaXNwbGF5bmFtZSxcbiAgICAgICAgICAgICAgICAgICAgICAgIGRhbWFnZTogZCxcbiAgICAgICAgICAgICAgICAgICAgICAgIGRhbWFnZVR5cGU6IGJvbnVzRGFtYWdlUGN0QXJyYXlbaV1bal0uZGFtYWdlVHlwZSxcbiAgICAgICAgICAgICAgICAgICAgICAgIGRhbWFnZVJlZHVjZWQ6IHNlbGYuZ2V0UmVkdWNlZERhbWFnZShkLCBib251c0RhbWFnZVBjdEFycmF5W2ldW2pdLmRhbWFnZVR5cGUpLFxuICAgICAgICAgICAgICAgICAgICAgICAgZW5hYmxlZDoga28ub2JzZXJ2YWJsZSh0cnVlKVxuICAgICAgICAgICAgICAgICAgICB9KTtcbiAgICAgICAgICAgICAgICAgICAgdG90YWxEYW1hZ2UgKz0gZDtcbiAgICAgICAgICAgICAgICAgICAgdG90YWxDcml0YWJsZURhbWFnZSArPSBkO1xuICAgICAgICAgICAgICAgICAgICBkYW1hZ2VbYm9udXNEYW1hZ2VQY3RBcnJheVtpXVtqXS5kYW1hZ2VUeXBlXSArPSBkO1xuICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgIH1cbiAgICAgICAgICAgIC8vIGRyb3dfcmFuZ2VyX3RydWVzaG90XG4gICAgICAgICAgICBpZiAoc2VsZi5oZXJvRGF0YSgpLmF0dGFja3R5cGUgPT09ICdET1RBX1VOSVRfQ0FQX1JBTkdFRF9BVFRBQ0snKSB7XG4gICAgICAgICAgICAgICAgaWYgKHNlbGYuaGVyb0lkKCkgPT09ICdkcm93X3JhbmdlcicpIHtcbiAgICAgICAgICAgICAgICAgICAgdmFyIHMgPSBzZWxmLmFiaWxpdHkoKS5nZXRCb251c0RhbWFnZVByZWNpc2lvbkF1cmEoKS5zb3VyY2VzO1xuICAgICAgICAgICAgICAgICAgICB2YXIgaW5kZXggPSAwO1xuICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgICBlbHNlIHtcbiAgICAgICAgICAgICAgICAgICAgdmFyIHMgPSBzZWxmLmJ1ZmZzLmdldEJvbnVzRGFtYWdlUHJlY2lzaW9uQXVyYSgpLnNvdXJjZXM7XG4gICAgICAgICAgICAgICAgICAgIHZhciBpbmRleCA9IDE7XG4gICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICAgIGlmIChzW2luZGV4XSAhPSB1bmRlZmluZWQpIHtcbiAgICAgICAgICAgICAgICAgICAgaWYgKHNlbGYuaGVyb0lkKCkgPT09ICdkcm93X3JhbmdlcicpIHtcbiAgICAgICAgICAgICAgICAgICAgICAgIHZhciBkID0gc1tpbmRleF0uZGFtYWdlICogc2VsZi50b3RhbEFnaSgpO1xuICAgICAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgICAgICAgIGVsc2Uge1xuICAgICAgICAgICAgICAgICAgICAgICAgdmFyIGQgPSBzW2luZGV4XS5kYW1hZ2U7XG4gICAgICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgICAgICAgcmVzdWx0LnB1c2goe1xuICAgICAgICAgICAgICAgICAgICAgICAgbmFtZTogc1tpbmRleF0uZGlzcGxheW5hbWUsXG4gICAgICAgICAgICAgICAgICAgICAgICBkYW1hZ2U6IGQsXG4gICAgICAgICAgICAgICAgICAgICAgICBkYW1hZ2VUeXBlOiAncGh5c2ljYWwnLFxuICAgICAgICAgICAgICAgICAgICAgICAgZGFtYWdlUmVkdWNlZDogc2VsZi5nZXRSZWR1Y2VkRGFtYWdlKGQsICdwaHlzaWNhbCcpLFxuICAgICAgICAgICAgICAgICAgICAgICAgZW5hYmxlZDoga28ub2JzZXJ2YWJsZSh0cnVlKVxuICAgICAgICAgICAgICAgICAgICB9KTtcbiAgICAgICAgICAgICAgICAgICAgdG90YWxEYW1hZ2UgKz0gZDtcbiAgICAgICAgICAgICAgICAgICAgdG90YWxDcml0YWJsZURhbWFnZSArPSBkO1xuICAgICAgICAgICAgICAgICAgICBkYW1hZ2UucGh5c2ljYWwgKz0gZDsgICAgICAgICAgICAgICAgICAgIFxuICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgIH1cbiAgICAgICAgICAgIFxuICAgICAgICAgICAgLy8gcmlraV9iYWNrc3RhYlxuICAgICAgICAgICAgaWYgKHNlbGYuaGVyb0lkKCkgPT09ICdyaWtpJykge1xuICAgICAgICAgICAgICAgIHZhciBzID0gc2VsZi5hYmlsaXR5KCkuZ2V0Qm9udXNEYW1hZ2VCYWNrc3RhYigpLnNvdXJjZXM7XG4gICAgICAgICAgICAgICAgdmFyIGluZGV4ID0gMDtcbiAgICAgICAgICAgIH1cbiAgICAgICAgICAgIGVsc2Uge1xuICAgICAgICAgICAgICAgIHZhciBzID0gc2VsZi5idWZmcy5nZXRCb251c0RhbWFnZUJhY2tzdGFiKCkuc291cmNlcztcbiAgICAgICAgICAgICAgICB2YXIgaW5kZXggPSAxO1xuICAgICAgICAgICAgfVxuICAgICAgICAgICAgaWYgKHNbaW5kZXhdICE9IHVuZGVmaW5lZCkge1xuICAgICAgICAgICAgICAgIGlmIChzZWxmLmhlcm9JZCgpID09PSAncmlraScpIHtcbiAgICAgICAgICAgICAgICAgICAgdmFyIGQgPSBzW2luZGV4XS5kYW1hZ2UgKiBzZWxmLnRvdGFsQWdpKCk7XG4gICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICAgIGVsc2Uge1xuICAgICAgICAgICAgICAgICAgICB2YXIgZCA9IHNbaW5kZXhdLmRhbWFnZTtcbiAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgICAgcmVzdWx0LnB1c2goe1xuICAgICAgICAgICAgICAgICAgICBuYW1lOiBzW2luZGV4XS5kaXNwbGF5bmFtZSxcbiAgICAgICAgICAgICAgICAgICAgZGFtYWdlOiBkLFxuICAgICAgICAgICAgICAgICAgICBkYW1hZ2VUeXBlOiAncGh5c2ljYWwnLFxuICAgICAgICAgICAgICAgICAgICBkYW1hZ2VSZWR1Y2VkOiBzZWxmLmdldFJlZHVjZWREYW1hZ2UoZCwgJ3BoeXNpY2FsJyksXG4gICAgICAgICAgICAgICAgICAgIGVuYWJsZWQ6IGtvLm9ic2VydmFibGUodHJ1ZSlcbiAgICAgICAgICAgICAgICB9KTtcbiAgICAgICAgICAgICAgICB0b3RhbERhbWFnZSArPSBkO1xuICAgICAgICAgICAgICAgIC8vdG90YWxDcml0YWJsZURhbWFnZSArPSBkO1xuICAgICAgICAgICAgICAgIGRhbWFnZS5waHlzaWNhbCArPSBkOyAgICAgICAgICAgICAgICAgICAgXG4gICAgICAgICAgICB9XG5cbiAgICAgICAgICAgIC8vIGJhc2ggZGFtYWdlXG4gICAgICAgICAgICBmb3IgKHZhciBpID0gMDsgaSA8IGJhc2hTb3VyY2VzLnNvdXJjZXMubGVuZ3RoOyBpKyspIHtcbiAgICAgICAgICAgICAgICB2YXIgbyA9IGJhc2hTb3VyY2VzLnNvdXJjZXNbaV07XG4gICAgICAgICAgICAgICAgdmFyIGQgPSBiYXNoU291cmNlcy5zb3VyY2VzW2ldLmRhbWFnZTtcbiAgICAgICAgICAgICAgICB2YXIgY2QgPSBzZWxmLmF0dGFja3NQZXJTZWNvbmQoKTtcbiAgICAgICAgICAgICAgICBpZiAoby5jb29sZG93bikge1xuICAgICAgICAgICAgICAgICAgICBjZCA9IE1hdGgubWF4KDEvby5jb29sZG93biwgY2QpO1xuICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgICBmb3IgKHZhciBqID0gMDsgaiA8IGJhc2hTb3VyY2VzLnNvdXJjZXNbaV0uY291bnQ7IGorKykge1xuICAgICAgICAgICAgICAgICAgICByZXN1bHQucHVzaCh7XG4gICAgICAgICAgICAgICAgICAgICAgICBuYW1lOiBiYXNoU291cmNlcy5zb3VyY2VzW2ldLm5hbWUsXG4gICAgICAgICAgICAgICAgICAgICAgICBkYW1hZ2U6IGQsXG4gICAgICAgICAgICAgICAgICAgICAgICBkYW1hZ2VUeXBlOiBiYXNoU291cmNlcy5zb3VyY2VzW2ldLmRhbWFnZVR5cGUsXG4gICAgICAgICAgICAgICAgICAgICAgICBkYW1hZ2VSZWR1Y2VkOiBzZWxmLmdldFJlZHVjZWREYW1hZ2UoZCwgYmFzaFNvdXJjZXMuc291cmNlc1tpXS5kYW1hZ2VUeXBlKSxcbiAgICAgICAgICAgICAgICAgICAgICAgIGRwczogZCAqIGNkICogYmFzaFNvdXJjZXMuc291cmNlc1tpXS5jaGFuY2UsXG4gICAgICAgICAgICAgICAgICAgICAgICBkcHNSZWR1Y2VkOiBzZWxmLmdldFJlZHVjZWREYW1hZ2UoZCwgYmFzaFNvdXJjZXMuc291cmNlc1tpXS5kYW1hZ2VUeXBlKSAqIGNkICogYmFzaFNvdXJjZXMuc291cmNlc1tpXS5jaGFuY2UsXG4gICAgICAgICAgICAgICAgICAgICAgICBlbmFibGVkOiBrby5vYnNlcnZhYmxlKHRydWUpXG4gICAgICAgICAgICAgICAgICAgIH0pO1xuICAgICAgICAgICAgICAgICAgICB0b3RhbERhbWFnZSArPSBkO1xuICAgICAgICAgICAgICAgICAgICBkYW1hZ2VbYmFzaFNvdXJjZXMuc291cmNlc1tpXS5kYW1hZ2VUeXBlXSArPSBkO1xuICAgICAgICAgICAgICAgIH1cblxuICAgICAgICAgICAgfVxuICAgICAgICAgICAgXG4gICAgICAgICAgICAvLyAlLWJhc2VkIG9yYnNcbiAgICAgICAgICAgIGZvciAodmFyIGkgPSAwOyBpIDwgaXRlbVByb2NPcmJTb3VyY2VzLnNvdXJjZXMubGVuZ3RoOyBpKyspIHtcbiAgICAgICAgICAgICAgICB2YXIgZCA9IGl0ZW1Qcm9jT3JiU291cmNlcy5zb3VyY2VzW2ldLmRhbWFnZSAqICgxIC0gTWF0aC5wb3coMSAtIGl0ZW1Qcm9jT3JiU291cmNlcy5zb3VyY2VzW2ldLmNoYW5jZSwgaXRlbVByb2NPcmJTb3VyY2VzLnNvdXJjZXNbaV0uY291bnQpKTtcbiAgICAgICAgICAgICAgICByZXN1bHQucHVzaCh7XG4gICAgICAgICAgICAgICAgICAgIG5hbWU6IGl0ZW1Qcm9jT3JiU291cmNlcy5zb3VyY2VzW2ldLm5hbWUsXG4gICAgICAgICAgICAgICAgICAgIGRhbWFnZTogZCxcbiAgICAgICAgICAgICAgICAgICAgZGFtYWdlVHlwZTogaXRlbVByb2NPcmJTb3VyY2VzLnNvdXJjZXNbaV0uZGFtYWdlVHlwZSxcbiAgICAgICAgICAgICAgICAgICAgZGFtYWdlUmVkdWNlZDogc2VsZi5nZXRSZWR1Y2VkRGFtYWdlKGQsIGl0ZW1Qcm9jT3JiU291cmNlcy5zb3VyY2VzW2ldLmRhbWFnZVR5cGUpLFxuICAgICAgICAgICAgICAgICAgICBlbmFibGVkOiBrby5vYnNlcnZhYmxlKHRydWUpXG4gICAgICAgICAgICAgICAgfSk7XG4gICAgICAgICAgICAgICAgdG90YWxEYW1hZ2UgKz0gZDtcbiAgICAgICAgICAgICAgICBkYW1hZ2VbaXRlbVByb2NPcmJTb3VyY2VzLnNvdXJjZXNbaV0uZGFtYWdlVHlwZV0gKz0gZDtcbiAgICAgICAgICAgIH1cbiAgICAgICAgICAgIFxuICAgICAgICAgICAgLy8gYWJpbGl0eSBvcmJzXG4gICAgICAgICAgICBmb3IgKHZhciBvcmIgaW4gYWJpbGl0eU9yYlNvdXJjZXMpIHtcbiAgICAgICAgICAgICAgICB2YXIgZCA9IGFiaWxpdHlPcmJTb3VyY2VzW29yYl0uZGFtYWdlICogKDEgLSBpdGVtUHJvY09yYlNvdXJjZXMudG90YWwpO1xuICAgICAgICAgICAgICAgIHJlc3VsdC5wdXNoKHtcbiAgICAgICAgICAgICAgICAgICAgbmFtZTogYWJpbGl0eU9yYlNvdXJjZXNbb3JiXS5kaXNwbGF5bmFtZSxcbiAgICAgICAgICAgICAgICAgICAgZGFtYWdlOiBkLFxuICAgICAgICAgICAgICAgICAgICBkYW1hZ2VUeXBlOiBhYmlsaXR5T3JiU291cmNlc1tvcmJdLmRhbWFnZVR5cGUsXG4gICAgICAgICAgICAgICAgICAgIGRhbWFnZVJlZHVjZWQ6IHNlbGYuZ2V0UmVkdWNlZERhbWFnZShkLCBhYmlsaXR5T3JiU291cmNlc1tvcmJdLmRhbWFnZVR5cGUpLFxuICAgICAgICAgICAgICAgICAgICBlbmFibGVkOiBrby5vYnNlcnZhYmxlKHRydWUpXG4gICAgICAgICAgICAgICAgfSk7XG4gICAgICAgICAgICAgICAgdG90YWxEYW1hZ2UgKz0gZDtcbiAgICAgICAgICAgICAgICBkYW1hZ2VbYWJpbGl0eU9yYlNvdXJjZXNbb3JiXS5kYW1hZ2VUeXBlXSArPSBkO1xuICAgICAgICAgICAgfVxuICAgICAgICAgICAgXG4gICAgICAgICAgICAvLyBpdGVtIG9yYnNcbiAgICAgICAgICAgIGlmIChPYmplY3Qua2V5cyhhYmlsaXR5T3JiU291cmNlcykubGVuZ3RoID09PSAwKSB7XG4gICAgICAgICAgICAgICAgZm9yICh2YXIgb3JiIGluIGl0ZW1PcmJTb3VyY2VzKSB7XG4gICAgICAgICAgICAgICAgICAgIHZhciBkID0gaXRlbU9yYlNvdXJjZXNbb3JiXS5kYW1hZ2UgKiAoMSAtIGl0ZW1Qcm9jT3JiU291cmNlcy50b3RhbCk7XG4gICAgICAgICAgICAgICAgICAgIHJlc3VsdC5wdXNoKHtcbiAgICAgICAgICAgICAgICAgICAgICAgIG5hbWU6IGl0ZW1PcmJTb3VyY2VzW29yYl0uZGlzcGxheW5hbWUsXG4gICAgICAgICAgICAgICAgICAgICAgICBkYW1hZ2U6IGQsXG4gICAgICAgICAgICAgICAgICAgICAgICBkYW1hZ2VUeXBlOiBpdGVtT3JiU291cmNlc1tvcmJdLmRhbWFnZVR5cGUsXG4gICAgICAgICAgICAgICAgICAgICAgICBkYW1hZ2VSZWR1Y2VkOiBzZWxmLmdldFJlZHVjZWREYW1hZ2UoZCwgaXRlbU9yYlNvdXJjZXNbb3JiXS5kYW1hZ2VUeXBlKSxcbiAgICAgICAgICAgICAgICAgICAgICAgIGVuYWJsZWQ6IGtvLm9ic2VydmFibGUodHJ1ZSlcbiAgICAgICAgICAgICAgICAgICAgfSk7XG4gICAgICAgICAgICAgICAgICAgIHRvdGFsRGFtYWdlICs9IGQ7XG4gICAgICAgICAgICAgICAgICAgIGRhbWFnZVtpdGVtT3JiU291cmNlc1tvcmJdLmRhbWFnZVR5cGVdICs9IGQ7XG4gICAgICAgICAgICAgICAgfSAgICAgICAgICAgIFxuICAgICAgICAgICAgfVxuICAgICAgICAgICAgXG4gICAgICAgICAgICAvLyBjcml0IGRhbWFnZVxuICAgICAgICAgICAgZm9yICh2YXIgaSA9IDA7IGkgPCBjcml0U291cmNlcy5zb3VyY2VzLmxlbmd0aDsgaSsrKSB7XG4gICAgICAgICAgICAgICAgdmFyIGQgPSB0b3RhbENyaXRhYmxlRGFtYWdlICogKGNyaXRTb3VyY2VzLnNvdXJjZXNbaV0ubXVsdGlwbGllciAtIDEpOy8vICogY3JpdFNvdXJjZXMuc291cmNlc1tpXS50b3RhbENoYW5jZTtcbiAgICAgICAgICAgICAgICBjcml0cy5wdXNoKHtcbiAgICAgICAgICAgICAgICAgICAgbmFtZTogY3JpdFNvdXJjZXMuc291cmNlc1tpXS5uYW1lICsgJywgJyArIGNyaXRTb3VyY2VzLnNvdXJjZXNbaV0ubXVsdGlwbGllciArICd4LCAnICsgKGNyaXRTb3VyY2VzLnNvdXJjZXNbaV0udG90YWxDaGFuY2UgKiAxMDApLnRvRml4ZWQoMSkgKyAnJScsXG4gICAgICAgICAgICAgICAgICAgIGRhbWFnZTogZCxcbiAgICAgICAgICAgICAgICAgICAgZGFtYWdlVHlwZTogJ3BoeXNpY2FsJyxcbiAgICAgICAgICAgICAgICAgICAgZGFtYWdlUmVkdWNlZDogc2VsZi5nZXRSZWR1Y2VkRGFtYWdlKGQsICdwaHlzaWNhbCcpLFxuICAgICAgICAgICAgICAgICAgICBlbmFibGVkOiBrby5vYnNlcnZhYmxlKHRydWUpLFxuICAgICAgICAgICAgICAgICAgICBjaGFuY2U6IGNyaXRTb3VyY2VzLnNvdXJjZXNbaV0udG90YWxDaGFuY2VcbiAgICAgICAgICAgICAgICB9KTtcbiAgICAgICAgICAgICAgICB0b3RhbENyaXQgKz0gZDtcbiAgICAgICAgICAgIH1cblxuICAgICAgICAgICAgdmFyIHRvdGFsUmVkdWNlZCA9IHNlbGYuZ2V0UmVkdWNlZERhbWFnZShkYW1hZ2UucHVyZSwgJ3B1cmUnKSBcbiAgICAgICAgICAgICAgICAgICAgKyBzZWxmLmdldFJlZHVjZWREYW1hZ2UoZGFtYWdlLnBoeXNpY2FsLCAncGh5c2ljYWwnKVxuICAgICAgICAgICAgICAgICAgICArIHNlbGYuZ2V0UmVkdWNlZERhbWFnZShkYW1hZ2UubWFnaWMsICdtYWdpYycpLFxuICAgICAgICAgICAgICAgIHRvdGFsQ3JpdFJlZHVjZWQgPSBzZWxmLmdldFJlZHVjZWREYW1hZ2UodG90YWxDcml0LCAncGh5c2ljYWwnKSxcbiAgICAgICAgICAgICAgICBkcHMgPSB7XG4gICAgICAgICAgICAgICAgICAgIGJhc2U6IHRvdGFsRGFtYWdlICogc2VsZi5hdHRhY2tzUGVyU2Vjb25kKCksXG4gICAgICAgICAgICAgICAgICAgIGNyaXQ6IHRvdGFsQ3JpdCAqIHNlbGYuYXR0YWNrc1BlclNlY29uZCgpLFxuICAgICAgICAgICAgICAgICAgICBnZW1pbmF0ZUF0dGFjazogZ2VtaW5hdGVBdHRhY2suYWN0aXZlID8gZ2VtaW5hdGVBdHRhY2suZGFtYWdlIC8gZ2VtaW5hdGVBdHRhY2suY29vbGRvd24gOiAwLFxuICAgICAgICAgICAgICAgICAgICByZWR1Y2VkOiB7XG4gICAgICAgICAgICAgICAgICAgICAgICBiYXNlOiB0b3RhbFJlZHVjZWQgKiBzZWxmLmF0dGFja3NQZXJTZWNvbmQoKSxcbiAgICAgICAgICAgICAgICAgICAgICAgIGNyaXQ6IHRvdGFsQ3JpdFJlZHVjZWQgKiBzZWxmLmF0dGFja3NQZXJTZWNvbmQoKSxcbiAgICAgICAgICAgICAgICAgICAgICAgIGdlbWluYXRlQXR0YWNrOiBnZW1pbmF0ZUF0dGFjay5hY3RpdmUgPyBzZWxmLmdldFJlZHVjZWREYW1hZ2UoZ2VtaW5hdGVBdHRhY2suZGFtYWdlLCAncGh5c2ljYWwnKSAvIGdlbWluYXRlQXR0YWNrLmNvb2xkb3duIDogMCxcbiAgICAgICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgICBcbiAgICAgICAgICAgIGNyaXRzLmZvckVhY2goZnVuY3Rpb24gKG8pIHtcbiAgICAgICAgICAgICAgICBpZiAoIW8uZHBzKSB7XG4gICAgICAgICAgICAgICAgICAgIG8uZHBzID0gby5kYW1hZ2UgKiAoby5jb29sZG93biB8fCBzZWxmLmF0dGFja3NQZXJTZWNvbmQoKSkgKiBvLmNoYW5jZTtcbiAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgICAgaWYgKCFvLmRwc1JlZHVjZWQpIHtcbiAgICAgICAgICAgICAgICAgICAgby5kcHNSZWR1Y2VkID0gby5kYW1hZ2VSZWR1Y2VkICogKG8uY29vbGRvd24gfHwgc2VsZi5hdHRhY2tzUGVyU2Vjb25kKCkpICogby5jaGFuY2U7XG4gICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgfSk7XG4gICAgICAgICAgICAgICAgXG4gICAgICAgICAgICByZXN1bHQuZm9yRWFjaChmdW5jdGlvbiAobykge1xuICAgICAgICAgICAgICAgIGlmICghby5kcHMpIHtcbiAgICAgICAgICAgICAgICAgICAgby5kcHMgPSBvLmRhbWFnZSAqIChvLmNvb2xkb3duIHx8IHNlbGYuYXR0YWNrc1BlclNlY29uZCgpKTtcbiAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgICAgaWYgKCFvLmRwc1JlZHVjZWQpIHtcbiAgICAgICAgICAgICAgICAgICAgby5kcHNSZWR1Y2VkID0gby5kYW1hZ2VSZWR1Y2VkICogKG8uY29vbGRvd24gfHwgc2VsZi5hdHRhY2tzUGVyU2Vjb25kKCkpO1xuICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgIH0pO1xuICAgICAgICAgICAgXG4gICAgICAgICAgICB2YXIgdG90YWxDcml0Q2hhbmNlID0gY3JpdHMucmVkdWNlKGZ1bmN0aW9uIChtZW1vLCBvKSB7IHJldHVybiBtZW1vICsgby5jaGFuY2UgfSwgMCk7XG4gICAgICAgICAgICAgICAgXG4gICAgICAgICAgICB2YXIgdDFDcml0ID0ga28uY29tcHV0ZWQoZnVuY3Rpb24gKCkge1xuICAgICAgICAgICAgICAgIHZhciBjID0gY3JpdHMuZmluZChmdW5jdGlvbiAobykgeyByZXR1cm4gby5lbmFibGVkKCk7IH0pO1xuICAgICAgICAgICAgICAgIHJldHVybiBjID8gYy5kYW1hZ2UgOiAwO1xuICAgICAgICAgICAgfSk7XG4gICAgICAgICAgICB2YXIgdDJDcml0ID0ga28uY29tcHV0ZWQoZnVuY3Rpb24gKCkge1xuICAgICAgICAgICAgICAgIHZhciBjID0gY3JpdHMuZmluZChmdW5jdGlvbiAobykgeyByZXR1cm4gby5lbmFibGVkKCk7IH0pO1xuICAgICAgICAgICAgICAgIHJldHVybiBjID8gYy5kYW1hZ2VSZWR1Y2VkIDogMDtcbiAgICAgICAgICAgIH0pO1xuICAgICAgICAgICAgdmFyIHQzQ3JpdCA9IGtvLmNvbXB1dGVkKGZ1bmN0aW9uICgpIHtcbiAgICAgICAgICAgICAgICByZXR1cm4gY3JpdHMuZmlsdGVyKGZ1bmN0aW9uIChvKSB7IHJldHVybiBvLmVuYWJsZWQoKTsgfSkucmVkdWNlKGZ1bmN0aW9uIChtZW1vLCBvKSB7IHJldHVybiBtZW1vICsgby5kcHMgfSwgMCk7XG4gICAgICAgICAgICB9KTtcbiAgICAgICAgICAgIHZhciB0NENyaXQgPSBrby5jb21wdXRlZChmdW5jdGlvbiAoKSB7XG4gICAgICAgICAgICAgICAgcmV0dXJuIGNyaXRzLmZpbHRlcihmdW5jdGlvbiAobykgeyByZXR1cm4gby5lbmFibGVkKCk7IH0pLnJlZHVjZShmdW5jdGlvbiAobWVtbywgbykgeyByZXR1cm4gbWVtbyArIG8uZHBzUmVkdWNlZCB9LCAwKTtcbiAgICAgICAgICAgIH0pO1xuICAgICAgICAgICAgICAgIFxuICAgICAgICAgICAgdmFyIHQxID0ga28uY29tcHV0ZWQoZnVuY3Rpb24gKCkge1xuICAgICAgICAgICAgICAgIHJldHVybiByZXN1bHQuZmlsdGVyKGZ1bmN0aW9uIChvKSB7IHJldHVybiBvLmVuYWJsZWQoKTsgfSkucmVkdWNlKGZ1bmN0aW9uIChtZW1vLCBvKSB7IHJldHVybiBtZW1vICsgby5kYW1hZ2UgfSwgMCkgKyB0MUNyaXQoKTtcbiAgICAgICAgICAgIH0pO1xuICAgICAgICAgICAgdmFyIHQyID0ga28uY29tcHV0ZWQoZnVuY3Rpb24gKCkge1xuICAgICAgICAgICAgICAgIHJldHVybiByZXN1bHQuZmlsdGVyKGZ1bmN0aW9uIChvKSB7IHJldHVybiBvLmVuYWJsZWQoKTsgfSkucmVkdWNlKGZ1bmN0aW9uIChtZW1vLCBvKSB7IHJldHVybiBtZW1vICsgby5kYW1hZ2VSZWR1Y2VkIH0sIDApICsgdDJDcml0KCk7XG4gICAgICAgICAgICB9KTtcbiAgICAgICAgICAgIHZhciB0MyA9IGtvLmNvbXB1dGVkKGZ1bmN0aW9uICgpIHtcbiAgICAgICAgICAgICAgICByZXR1cm4gKHJlc3VsdC5maWx0ZXIoZnVuY3Rpb24gKG8pIHsgcmV0dXJuIG8uZW5hYmxlZCgpOyB9KS5yZWR1Y2UoZnVuY3Rpb24gKG1lbW8sIG8pIHsgcmV0dXJuIG1lbW8gKyBvLmRwcyB9LCAwKSArIHQzQ3JpdCgpKSAqIGEuY29vbGRvd247XG4gICAgICAgICAgICB9KTtcbiAgICAgICAgICAgIHZhciB0NCA9IGtvLmNvbXB1dGVkKGZ1bmN0aW9uICgpIHtcbiAgICAgICAgICAgICAgICByZXR1cm4gKHJlc3VsdC5maWx0ZXIoZnVuY3Rpb24gKG8pIHsgcmV0dXJuIG8uZW5hYmxlZCgpOyB9KS5yZWR1Y2UoZnVuY3Rpb24gKG1lbW8sIG8pIHsgcmV0dXJuIG1lbW8gKyBvLmRwc1JlZHVjZWQgfSwgMCkgKyB0NENyaXQoKSkgKiBhLmNvb2xkb3duO1xuICAgICAgICAgICAgfSk7XG4gICAgICAgICAgICBcbiAgICAgICAgICAgIHZhciB0b3RhbENyaXRSb3cgPSBbdDFDcml0LCB0MkNyaXQsIHQzQ3JpdCwgdDRDcml0XTtcbiAgICAgICAgICAgIFxuICAgICAgICAgICAgdmFyIHRvdGFsUm93ID0gW3QxLCB0MiwgdDMsIHQ0XTtcblxuICAgICAgICAgICAgcmV0dXJuIHtcbiAgICAgICAgICAgICAgICBuYW1lOiBhLm5hbWUgKyAnIFN1YnRvdGFsJyxcbiAgICAgICAgICAgICAgICBjb29sZG93bjogYS5jb29sZG93bixcbiAgICAgICAgICAgICAgICBlbmFibGVkOiBrby5vYnNlcnZhYmxlKHRydWUpLFxuICAgICAgICAgICAgICAgIHZpc2libGU6IGtvLm9ic2VydmFibGUodHJ1ZSksXG4gICAgICAgICAgICAgICAgdG90YWxDcml0Q2hhbmNlOiB0b3RhbENyaXRDaGFuY2UsXG4gICAgICAgICAgICAgICAgdG90YWxDcml0Um93OiB0b3RhbENyaXRSb3csXG4gICAgICAgICAgICAgICAgdG90YWxSb3c6IHRvdGFsUm93LFxuICAgICAgICAgICAgICAgIHNvdXJjZXM6IHJlc3VsdCxcbiAgICAgICAgICAgICAgICBzb3VyY2VzQ3JpdDogY3JpdHMsXG4gICAgICAgICAgICAgICAgdG90YWw6IHRvdGFsRGFtYWdlLFxuICAgICAgICAgICAgICAgIHRvdGFsQ3JpdDogdG90YWxDcml0LFxuICAgICAgICAgICAgICAgIHRvdGFsR2VtaW5hdGVBdHRhY2s6IHRvdGFsRGFtYWdlICsgZ2VtaW5hdGVBdHRhY2suZGFtYWdlLFxuICAgICAgICAgICAgICAgIHRvdGFsR2VtaW5hdGVBdHRhY2tSZWR1Y2VkOiB0b3RhbFJlZHVjZWQgKyBnZW1pbmF0ZUF0dGFjay5kYW1hZ2VSZWR1Y2VkLFxuICAgICAgICAgICAgICAgIGdlbWluYXRlQXR0YWNrOiBnZW1pbmF0ZUF0dGFjayxcbiAgICAgICAgICAgICAgICB0b3RhbENyaXRSZWR1Y2VkOiB0b3RhbENyaXRSZWR1Y2VkLFxuICAgICAgICAgICAgICAgIHRvdGFsUmVkdWNlZDogdG90YWxSZWR1Y2VkLFxuICAgICAgICAgICAgICAgIHN1bVRvdGFsOiB0b3RhbERhbWFnZSArIHRvdGFsQ3JpdCxcbiAgICAgICAgICAgICAgICBzdW1Ub3RhbFJlZHVjZWQ6IHRvdGFsUmVkdWNlZCArIHRvdGFsQ3JpdFJlZHVjZWQsXG4gICAgICAgICAgICAgICAgZHBzOiB7XG4gICAgICAgICAgICAgICAgICAgIGJhc2U6IGRwcy5iYXNlLFxuICAgICAgICAgICAgICAgICAgICBjcml0OiBkcHMuYmFzZSArIGRwcy5jcml0LFxuICAgICAgICAgICAgICAgICAgICBnZW1pbmF0ZUF0dGFjazogZHBzLmJhc2UgKyBkcHMuZ2VtaW5hdGVBdHRhY2ssXG4gICAgICAgICAgICAgICAgICAgIHRvdGFsOiBkcHMuYmFzZSArIGRwcy5jcml0ICsgZHBzLmdlbWluYXRlQXR0YWNrLFxuICAgICAgICAgICAgICAgICAgICByZWR1Y2VkOiB7XG4gICAgICAgICAgICAgICAgICAgICAgICBiYXNlOiBkcHMucmVkdWNlZC5iYXNlLFxuICAgICAgICAgICAgICAgICAgICAgICAgY3JpdDogZHBzLnJlZHVjZWQuYmFzZSArIGRwcy5yZWR1Y2VkLmNyaXQsXG4gICAgICAgICAgICAgICAgICAgICAgICBnZW1pbmF0ZUF0dGFjazogZHBzLnJlZHVjZWQuYmFzZSArIGRwcy5yZWR1Y2VkLmdlbWluYXRlQXR0YWNrLFxuICAgICAgICAgICAgICAgICAgICAgICAgdG90YWw6IGRwcy5yZWR1Y2VkLmJhc2UgKyBkcHMucmVkdWNlZC5jcml0ICsgZHBzLnJlZHVjZWQuZ2VtaW5hdGVBdHRhY2tcbiAgICAgICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgIH07XG4gICAgICAgIH0pO1xuICAgICAgICBcbiAgICAgICAgdmFyIHQxID0ga28uY29tcHV0ZWQoZnVuY3Rpb24gKCkge1xuICAgICAgICAgICAgcmV0dXJuIGF0dGFja3MuZmlsdGVyKGZ1bmN0aW9uIChvKSB7IHJldHVybiBvLmVuYWJsZWQoKTsgfSkucmVkdWNlKGZ1bmN0aW9uIChtZW1vLCBvKSB7IHJldHVybiBtZW1vICsgby50b3RhbFJvd1swXSgpIH0sIDApO1xuICAgICAgICB9KTtcbiAgICAgICAgdmFyIHQyID0ga28uY29tcHV0ZWQoZnVuY3Rpb24gKCkge1xuICAgICAgICAgICAgcmV0dXJuIGF0dGFja3MuZmlsdGVyKGZ1bmN0aW9uIChvKSB7IHJldHVybiBvLmVuYWJsZWQoKTsgfSkucmVkdWNlKGZ1bmN0aW9uIChtZW1vLCBvKSB7IHJldHVybiBtZW1vICsgby50b3RhbFJvd1sxXSgpIH0sIDApO1xuICAgICAgICB9KTtcbiAgICAgICAgdmFyIHQzID0ga28uY29tcHV0ZWQoZnVuY3Rpb24gKCkge1xuICAgICAgICAgICAgcmV0dXJuIGF0dGFja3MuZmlsdGVyKGZ1bmN0aW9uIChvKSB7IHJldHVybiBvLmVuYWJsZWQoKTsgfSkucmVkdWNlKGZ1bmN0aW9uIChtZW1vLCBvKSB7IHJldHVybiBtZW1vICsgby50b3RhbFJvd1syXSgpIH0sIDApO1xuICAgICAgICB9KTtcbiAgICAgICAgdmFyIHQ0ID0ga28uY29tcHV0ZWQoZnVuY3Rpb24gKCkge1xuICAgICAgICAgICAgcmV0dXJuIGF0dGFja3MuZmlsdGVyKGZ1bmN0aW9uIChvKSB7IHJldHVybiBvLmVuYWJsZWQoKTsgfSkucmVkdWNlKGZ1bmN0aW9uIChtZW1vLCBvKSB7IHJldHVybiBtZW1vICsgby50b3RhbFJvd1szXSgpIH0sIDApO1xuICAgICAgICB9KTtcbiAgICAgICAgICAgIFxuICAgICAgICByZXR1cm4ge1xuICAgICAgICAgICAgYXR0YWNrczogYXR0YWNrcyxcbiAgICAgICAgICAgIHRvdGFsUm93OiBbdDEsIHQyLCB0MywgdDRdXG4gICAgICAgIH1cbiAgICB9KTtcbiAgICBcbiAgICBzZWxmLmdldERhbWFnZVR5cGVDb2xvciA9IGZ1bmN0aW9uIChkYW1hZ2VUeXBlKSB7XG4gICAgICAgIHJldHVybiBteS5wcm90b3R5cGUuRGFtYWdlVHlwZUNvbG9yW2RhbWFnZVR5cGVdIHx8IG15LnByb3RvdHlwZS5EYW1hZ2VUeXBlQ29sb3JbJ2RlZmF1bHQnXTtcbiAgICB9XG4gICAgXG59IiwiJ3VzZSBzdHJpY3QnO1xudmFyIGtvID0gcmVxdWlyZSgnLi9oZXJvY2FsY19rbm9ja291dCcpO1xudmFyIG15ID0gcmVxdWlyZShcIi4vaGVyb2NhbGNfY29yZVwiKTtcblxubXkucHJvdG90eXBlLnN0YWNrYWJsZUl0ZW1zID0gWydjbGFyaXR5JywnZmxhc2snLCdkdXN0Jywnd2FyZF9vYnNlcnZlcicsJ3dhcmRfc2VudHJ5JywndGFuZ28nLCd0cHNjcm9sbCcsJ3Ntb2tlX29mX2RlY2VpdCddLFxubXkucHJvdG90eXBlLmxldmVsaXRlbXMgPSBbJ25lY3Jvbm9taWNvbicsJ2RhZ29uJywnZGlmZnVzYWxfYmxhZGUnLCd0cmF2ZWxfYm9vdHMnXSxcbm15LnByb3RvdHlwZS52YWxpZEl0ZW1zID0gW1wiYWJ5c3NhbF9ibGFkZVwiLFwidWx0aW1hdGVfc2NlcHRlclwiLFwiY291cmllclwiLFwiYXJjYW5lX2Jvb3RzXCIsXCJhcm1sZXRcIixcImFzc2F1bHRcIixcImJvb3RzX29mX2VsdmVzXCIsXCJiZnVyeVwiLFwiYmVsdF9vZl9zdHJlbmd0aFwiLFwiYmxhY2tfa2luZ19iYXJcIixcImJsYWRlX21haWxcIixcImJsYWRlX29mX2FsYWNyaXR5XCIsXCJibGFkZXNfb2ZfYXR0YWNrXCIsXCJibGlua1wiLFwiYmxvb2RzdG9uZVwiLFwiYm9vdHNcIixcInRyYXZlbF9ib290c1wiLFwiYm90dGxlXCIsXCJicmFjZXJcIixcImJyb2Fkc3dvcmRcIixcImJ1Y2tsZXJcIixcImJ1dHRlcmZseVwiLFwiY2hhaW5tYWlsXCIsXCJjaXJjbGV0XCIsXCJjbGFyaXR5XCIsXCJjbGF5bW9yZVwiLFwiY2xvYWtcIixcImxlc3Nlcl9jcml0XCIsXCJncmVhdGVyX2NyaXRcIixcImRhZ29uXCIsXCJkZW1vbl9lZGdlXCIsXCJkZXNvbGF0b3JcIixcImRpZmZ1c2FsX2JsYWRlXCIsXCJyYXBpZXJcIixcImFuY2llbnRfamFuZ2dvXCIsXCJkdXN0XCIsXCJlYWdsZVwiLFwiZW5lcmd5X2Jvb3N0ZXJcIixcImV0aGVyZWFsX2JsYWRlXCIsXCJjeWNsb25lXCIsXCJza2FkaVwiLFwiZmx5aW5nX2NvdXJpZXJcIixcImZvcmNlX3N0YWZmXCIsXCJnYXVudGxldHNcIixcImdlbVwiLFwiZ2hvc3RcIixcImdsb3Zlc1wiLFwiaGFuZF9vZl9taWRhc1wiLFwiaGVhZGRyZXNzXCIsXCJmbGFza1wiLFwiaGVhcnRcIixcImhlYXZlbnNfaGFsYmVyZFwiLFwiaGVsbV9vZl9pcm9uX3dpbGxcIixcImhlbG1fb2ZfdGhlX2RvbWluYXRvclwiLFwiaG9vZF9vZl9kZWZpYW5jZVwiLFwiaHlwZXJzdG9uZVwiLFwiYnJhbmNoZXNcIixcImphdmVsaW5cIixcInNwaGVyZVwiLFwibWFlbHN0cm9tXCIsXCJtYWdpY19zdGlja1wiLFwibWFnaWNfd2FuZFwiLFwibWFudGFcIixcIm1hbnRsZVwiLFwibWFza19vZl9tYWRuZXNzXCIsXCJtZWRhbGxpb25fb2ZfY291cmFnZVwiLFwibWVrYW5zbVwiLFwibWl0aHJpbF9oYW1tZXJcIixcIm1qb2xsbmlyXCIsXCJtb25rZXlfa2luZ19iYXJcIixcImxpZmVzdGVhbFwiLFwibXlzdGljX3N0YWZmXCIsXCJuZWNyb25vbWljb25cIixcIm51bGxfdGFsaXNtYW5cIixcIm9ibGl2aW9uX3N0YWZmXCIsXCJ3YXJkX29ic2VydmVyXCIsXCJvZ3JlX2F4ZVwiLFwib3JiX29mX3Zlbm9tXCIsXCJvcmNoaWRcIixcInBlcnNcIixcInBoYXNlX2Jvb3RzXCIsXCJwaXBlXCIsXCJwbGF0ZW1haWxcIixcInBvaW50X2Jvb3N0ZXJcIixcInBvb3JfbWFuc19zaGllbGRcIixcInBvd2VyX3RyZWFkc1wiLFwicXVhcnRlcnN0YWZmXCIsXCJxdWVsbGluZ19ibGFkZVwiLFwicmFkaWFuY2VcIixcInJlYXZlclwiLFwicmVmcmVzaGVyXCIsXCJyaW5nX29mX2FxdWlsYVwiLFwicmluZ19vZl9iYXNpbGl1c1wiLFwicmluZ19vZl9oZWFsdGhcIixcInJpbmdfb2ZfcHJvdGVjdGlvblwiLFwicmluZ19vZl9yZWdlblwiLFwicm9iZVwiLFwicm9kX29mX2F0b3NcIixcInJlbGljXCIsXCJzb2JpX21hc2tcIixcInNhbmdlXCIsXCJzYW5nZV9hbmRfeWFzaGFcIixcInNhdGFuaWNcIixcInNoZWVwc3RpY2tcIixcIndhcmRfc2VudHJ5XCIsXCJzaGFkb3dfYW11bGV0XCIsXCJpbnZpc19zd29yZFwiLFwic2hpdmFzX2d1YXJkXCIsXCJiYXNoZXJcIixcInNsaXBwZXJzXCIsXCJzbW9rZV9vZl9kZWNlaXRcIixcInNvdWxfYm9vc3RlclwiLFwic291bF9yaW5nXCIsXCJzdGFmZl9vZl93aXphcmRyeVwiLFwic3RvdXRfc2hpZWxkXCIsXCJ0YWxpc21hbl9vZl9ldmFzaW9uXCIsXCJ0YW5nb1wiLFwidHBzY3JvbGxcIixcInRyYW5xdWlsX2Jvb3RzXCIsXCJ1bHRpbWF0ZV9vcmJcIixcInVybl9vZl9zaGFkb3dzXCIsXCJ2YW5ndWFyZFwiLFwidmVpbF9vZl9kaXNjb3JkXCIsXCJ2aXRhbGl0eV9ib29zdGVyXCIsXCJ2bGFkbWlyXCIsXCJ2b2lkX3N0b25lXCIsXCJ3cmFpdGhfYmFuZFwiLFwieWFzaGFcIixcImNyaW1zb25fZ3VhcmRcIixcImVuY2hhbnRlZF9tYW5nb1wiLFwibG90dXNfb3JiXCIsXCJnbGltbWVyX2NhcGVcIixcImd1YXJkaWFuX2dyZWF2ZXNcIixcIm1vb25fc2hhcmRcIixcInNpbHZlcl9lZGdlXCIsXCJzb2xhcl9jcmVzdFwiLFwib2N0YXJpbmVfY29yZVwiLFwiYWV0aGVyX2xlbnNcIixcImZhZXJpZV9maXJlXCIsXCJpcm9uX3RhbG9uXCIsXCJkcmFnb25fbGFuY2VcIixcImVjaG9fc2FicmVcIixcImluZnVzZWRfcmFpbmRyb3BcIixcImJsaWdodF9zdG9uZVwiLFwid2luZF9sYWNlXCIsXCJ0b21lX29mX2tub3dsZWRnZVwiLFwiYmxvb2R0aG9yblwiLFwiaHVycmljYW5lX3Bpa2VcIl0sXG5teS5wcm90b3R5cGUuaXRlbXNXaXRoQWN0aXZlID0gWydoZWFydCcsJ3Ntb2tlX29mX2RlY2VpdCcsJ2R1c3QnLCdnaG9zdCcsJ3RyYW5xdWlsX2Jvb3RzJywncGhhc2VfYm9vdHMnLCdwb3dlcl90cmVhZHMnLCdidWNrbGVyJywnbWVkYWxsaW9uX29mX2NvdXJhZ2UnLCdhbmNpZW50X2phbmdnbycsJ21la2Fuc20nLCdwaXBlJywndmVpbF9vZl9kaXNjb3JkJywncm9kX29mX2F0b3MnLCdvcmNoaWQnLCdzaGVlcHN0aWNrJywnYXJtbGV0JywnaW52aXNfc3dvcmQnLCdldGhlcmVhbF9ibGFkZScsJ3NoaXZhc19ndWFyZCcsJ21hbnRhJywnbWFza19vZl9tYWRuZXNzJywnZGlmZnVzYWxfYmxhZGUnLCdtam9sbG5pcicsJ3NhdGFuaWMnLCdyaW5nX29mX2Jhc2lsaXVzJywncmluZ19vZl9hcXVpbGEnLCAnYnV0dGVyZmx5JywgJ21vb25fc2hhcmQnLCAnc2lsdmVyX2VkZ2UnLCdibG9vZHRob3JuJ107XG5cbm15LnByb3RvdHlwZS5JdGVtSW5wdXQgPSBmdW5jdGlvbiAodmFsdWUsIG5hbWUsIGRlYnVmZikge1xuICAgIGlmIChteS5wcm90b3R5cGUuaXRlbURhdGFbJ2l0ZW1fJyArIHZhbHVlXS5JdGVtQWxpYXNlcyBpbnN0YW5jZW9mIEFycmF5KSB7XG4gICAgICAgIHZhciBpdGVtQWxpYXMgPSBteS5wcm90b3R5cGUuaXRlbURhdGFbJ2l0ZW1fJyArIHZhbHVlXS5JdGVtQWxpYXNlcy5qb2luKCcgJyk7XG4gICAgfVxuICAgIGVsc2Uge1xuICAgICAgICB2YXIgaXRlbUFsaWFzID0gbXkucHJvdG90eXBlLml0ZW1EYXRhWydpdGVtXycgKyB2YWx1ZV0uSXRlbUFsaWFzZXM7XG4gICAgfVxuICAgIHRoaXMudmFsdWUgPSBrby5vYnNlcnZhYmxlKHZhbHVlKTtcbiAgICB0aGlzLmRlYnVmZiA9IGtvLm9ic2VydmFibGUoZGVidWZmKTtcbiAgICBpZiAodGhpcy5kZWJ1ZmYoKSkge1xuICAgICAgICB0aGlzLnZhbHVlID0ga28ub2JzZXJ2YWJsZSh2YWx1ZSArICd8JyArIGRlYnVmZi5pZCk7XG4gICAgICAgIHRoaXMubmFtZSA9IGtvLm9ic2VydmFibGUobmFtZSArICcgKCcgKyBkZWJ1ZmYubmFtZSArICcpJyk7XG4gICAgICAgIHRoaXMuZGlzcGxheW5hbWUgPSBrby5vYnNlcnZhYmxlKG5hbWUgKyAnICgnICsgZGVidWZmLm5hbWUgKyAnKSA8c3BhbiBzdHlsZT1cImRpc3BsYXk6bm9uZVwiPicgKyAnOycgKyBpdGVtQWxpYXMgKyAnPC9zcGFuPicpO1xuICAgIH1cbiAgICBlbHNlIHtcbiAgICAgICAgdGhpcy52YWx1ZSA9IGtvLm9ic2VydmFibGUodmFsdWUpO1xuICAgICAgICB0aGlzLm5hbWUgPSBrby5vYnNlcnZhYmxlKG5hbWUpO1xuICAgICAgICB0aGlzLmRpc3BsYXluYW1lID0ga28ub2JzZXJ2YWJsZShuYW1lICsgJyA8c3BhbiBzdHlsZT1cImRpc3BsYXk6bm9uZVwiPicgKyAnOycgKyBpdGVtQWxpYXMgKyAnPC9zcGFuPicpO1xuICAgIH1cbn07XG5cbm15LnByb3RvdHlwZS5CYXNpY0ludmVudG9yeVZpZXdNb2RlbCA9IGZ1bmN0aW9uIChoKSB7XG4gICAgdmFyIHNlbGYgPSB0aGlzO1xuICAgIHNlbGYuaXRlbXMgPSBrby5vYnNlcnZhYmxlQXJyYXkoW10pO1xuICAgIHNlbGYuYWN0aXZlSXRlbXMgPSBrby5vYnNlcnZhYmxlQXJyYXkoW10pO1xuICAgIHNlbGYuYWRkSXRlbSA9IGZ1bmN0aW9uIChkYXRhLCBldmVudCkge1xuICAgICAgICBpZiAoZGF0YS5zZWxlY3RlZEl0ZW0oKSAhPSB1bmRlZmluZWQpIHtcbiAgICAgICAgICAgIHZhciBuZXdfaXRlbSA9IHtcbiAgICAgICAgICAgICAgICBpdGVtOiBkYXRhLnNlbGVjdGVkSXRlbSgpLnNwbGl0KCd8JylbMF0sXG4gICAgICAgICAgICAgICAgc3RhdGU6IGtvLm9ic2VydmFibGUoMCksXG4gICAgICAgICAgICAgICAgc2l6ZTogZGF0YS5pdGVtSW5wdXRWYWx1ZSgpLFxuICAgICAgICAgICAgICAgIGVuYWJsZWQ6IGtvLm9ic2VydmFibGUodHJ1ZSlcbiAgICAgICAgICAgIH1cbiAgICAgICAgICAgIHN3aXRjaCAobmV3X2l0ZW0uaXRlbSkge1xuICAgICAgICAgICAgICAgIGNhc2UgJ2RhZ29uJzpcbiAgICAgICAgICAgICAgICAgICAgbmV3X2l0ZW0uc2l6ZSA9IE1hdGgubWluKG5ld19pdGVtLnNpemUsIDUpO1xuICAgICAgICAgICAgICAgIGJyZWFrO1xuICAgICAgICAgICAgICAgIGJyZWFrO1xuICAgICAgICAgICAgICAgIGNhc2UgJ3RyYXZlbF9ib290cyc6XG4gICAgICAgICAgICAgICAgY2FzZSAnZGlmZnVzYWxfYmxhZGUnOlxuICAgICAgICAgICAgICAgICAgICBuZXdfaXRlbS5zaXplID0gTWF0aC5taW4obmV3X2l0ZW0uc2l6ZSwgMik7XG4gICAgICAgICAgICAgICAgYnJlYWs7XG4gICAgICAgICAgICAgICAgY2FzZSAnbmVjcm9ub21pY29uJzpcbiAgICAgICAgICAgICAgICAgICAgbmV3X2l0ZW0uc2l6ZSA9IE1hdGgubWluKG5ld19pdGVtLnNpemUsIDMpO1xuICAgICAgICAgICAgICAgIGJyZWFrO1xuICAgICAgICAgICAgfVxuICAgICAgICAgICAgc2VsZi5pdGVtcy5wdXNoKG5ld19pdGVtKTtcbiAgICAgICAgICAgIGlmIChkYXRhLnNlbGVjdGVkSXRlbSgpID09PSAncmluZ19vZl9hcXVpbGEnIHx8IGRhdGEuc2VsZWN0ZWRJdGVtKCkgPT09ICdyaW5nX29mX2Jhc2lsaXVzJyB8fCBkYXRhLnNlbGVjdGVkSXRlbSgpID09PSAnaGVhcnQnKSB7XG4gICAgICAgICAgICAgICAgc2VsZi50b2dnbGVJdGVtKHVuZGVmaW5lZCwgbmV3X2l0ZW0sIHVuZGVmaW5lZCk7XG4gICAgICAgICAgICB9XG4gICAgICAgIH1cbiAgICB9O1xuICAgIHNlbGYudG9nZ2xlSXRlbSA9IGZ1bmN0aW9uIChpbmRleCwgZGF0YSwgZXZlbnQpIHtcbiAgICAgICAgaWYgKG15LnByb3RvdHlwZS5pdGVtc1dpdGhBY3RpdmUuaW5kZXhPZihkYXRhLml0ZW0pID49IDApIHtcbiAgICAgICAgICAgIGlmIChzZWxmLmFjdGl2ZUl0ZW1zLmluZGV4T2YoZGF0YSkgPCAwKSB7XG4gICAgICAgICAgICAgICAgc2VsZi5hY3RpdmVJdGVtcy5wdXNoKGRhdGEpO1xuICAgICAgICAgICAgfVxuICAgICAgICAgICAgZWxzZSB7XG4gICAgICAgICAgICAgICAgc2VsZi5hY3RpdmVJdGVtcy5yZW1vdmUoZGF0YSk7XG4gICAgICAgICAgICB9XG4gICAgICAgICAgICBzd2l0Y2ggKGRhdGEuaXRlbSkge1xuICAgICAgICAgICAgICAgIGNhc2UgJ3Bvd2VyX3RyZWFkcyc6XG4gICAgICAgICAgICAgICAgICAgIGlmIChkYXRhLnN0YXRlKCkgPCAyKSB7XG4gICAgICAgICAgICAgICAgICAgICAgICBkYXRhLnN0YXRlKGRhdGEuc3RhdGUoKSArIDEpO1xuICAgICAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgICAgICAgIGVsc2Uge1xuICAgICAgICAgICAgICAgICAgICAgICAgZGF0YS5zdGF0ZSgwKTtcbiAgICAgICAgICAgICAgICAgICAgfSAgICAgICAgICAgICAgICBcbiAgICAgICAgICAgICAgICBicmVhaztcbiAgICAgICAgICAgICAgICBkZWZhdWx0OlxuICAgICAgICAgICAgICAgICAgICBpZiAoZGF0YS5zdGF0ZSgpID09IDApIHtcbiAgICAgICAgICAgICAgICAgICAgICAgIGRhdGEuc3RhdGUoMSk7XG4gICAgICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgICAgICAgZWxzZSB7XG4gICAgICAgICAgICAgICAgICAgICAgICBkYXRhLnN0YXRlKDApO1xuICAgICAgICAgICAgICAgICAgICB9ICAgICAgICAgICAgICAgIFxuICAgICAgICAgICAgICAgIGJyZWFrO1xuICAgICAgICAgICAgfVxuICAgICAgICB9XG4gICAgfS5iaW5kKHRoaXMpO1xuICAgIHNlbGYucmVtb3ZlSXRlbSA9IGZ1bmN0aW9uIChpdGVtKSB7XG4gICAgICAgIHNlbGYuYWN0aXZlSXRlbXMucmVtb3ZlKGl0ZW0pO1xuICAgICAgICBzZWxmLml0ZW1zLnJlbW92ZShpdGVtKTtcbiAgICB9LmJpbmQodGhpcyk7XG4gICAgc2VsZi50b2dnbGVNdXRlSXRlbSA9IGZ1bmN0aW9uIChpdGVtKSB7XG4gICAgICAgIGl0ZW0uZW5hYmxlZCghaXRlbS5lbmFibGVkKCkpO1xuICAgIH0uYmluZCh0aGlzKTsgICAgICBcbiAgICBzZWxmLnJlbW92ZUFsbCA9IGZ1bmN0aW9uICgpIHtcbiAgICAgICAgc2VsZi5hY3RpdmVJdGVtcy5yZW1vdmVBbGwoKTtcbiAgICAgICAgc2VsZi5pdGVtcy5yZW1vdmVBbGwoKTtcbiAgICB9LmJpbmQodGhpcyk7XG59XG5teS5wcm90b3R5cGUuQmFzaWNJbnZlbnRvcnlWaWV3TW9kZWwucHJvdG90eXBlLmdldEl0ZW1JbWFnZSA9IGZ1bmN0aW9uIChkYXRhKSB7XG4gICAgdmFyIHN0YXRlID0ga28udXRpbHMudW53cmFwT2JzZXJ2YWJsZShkYXRhLnN0YXRlKTtcbiAgICBzd2l0Y2ggKGRhdGEuaXRlbSkge1xuICAgICAgICBjYXNlICdwb3dlcl90cmVhZHMnOlxuICAgICAgICAgICAgaWYgKHN0YXRlID09IDApIHtcbiAgICAgICAgICAgICAgICByZXR1cm4gJy9tZWRpYS9pbWFnZXMvaXRlbXMvJyArIGRhdGEuaXRlbSArICdfc3RyLnBuZyc7XG4gICAgICAgICAgICB9XG4gICAgICAgICAgICBlbHNlIGlmIChzdGF0ZSA9PSAxKSB7XG4gICAgICAgICAgICAgICAgcmV0dXJuICcvbWVkaWEvaW1hZ2VzL2l0ZW1zLycgKyBkYXRhLml0ZW0gKyAnX2ludC5wbmcnO1xuICAgICAgICAgICAgfVxuICAgICAgICAgICAgZWxzZSB7XG4gICAgICAgICAgICAgICAgcmV0dXJuICcvbWVkaWEvaW1hZ2VzL2l0ZW1zLycgKyBkYXRhLml0ZW0gKyAnX2FnaS5wbmcnO1xuICAgICAgICAgICAgfVxuICAgICAgICBicmVhaztcbiAgICAgICAgY2FzZSAndHJhbnF1aWxfYm9vdHMnOlxuICAgICAgICBjYXNlICdyaW5nX29mX2Jhc2lsaXVzJzpcbiAgICAgICAgICAgIGlmIChzdGF0ZSA9PSAwKSB7XG4gICAgICAgICAgICAgICAgcmV0dXJuICcvbWVkaWEvaW1hZ2VzL2l0ZW1zLycgKyBkYXRhLml0ZW0gKyAnLnBuZyc7XG4gICAgICAgICAgICB9XG4gICAgICAgICAgICBlbHNlIHtcbiAgICAgICAgICAgICAgICByZXR1cm4gJy9tZWRpYS9pbWFnZXMvaXRlbXMvJyArIGRhdGEuaXRlbSArICdfYWN0aXZlLnBuZyc7XG4gICAgICAgICAgICB9XG4gICAgICAgIGJyZWFrO1xuICAgICAgICBjYXNlICdhcm1sZXQnOlxuICAgICAgICAgICAgaWYgKHN0YXRlID09IDApIHtcbiAgICAgICAgICAgICAgICByZXR1cm4gJy9tZWRpYS9pbWFnZXMvaXRlbXMvJyArIGRhdGEuaXRlbSArICcucG5nJztcbiAgICAgICAgICAgIH1cbiAgICAgICAgICAgIGVsc2Uge1xuICAgICAgICAgICAgICAgIHJldHVybiAnL21lZGlhL2ltYWdlcy9pdGVtcy8nICsgZGF0YS5pdGVtICsgJ19hY3RpdmUucG5nJztcbiAgICAgICAgICAgIH1cbiAgICAgICAgYnJlYWs7XG4gICAgICAgIGNhc2UgJ3Jpbmdfb2ZfYXF1aWxhJzpcbiAgICAgICAgICAgIGlmIChzdGF0ZSA9PSAwKSB7XG4gICAgICAgICAgICAgICAgcmV0dXJuICcvbWVkaWEvaW1hZ2VzL2l0ZW1zLycgKyBkYXRhLml0ZW0gKyAnX2FjdGl2ZS5wbmcnO1xuICAgICAgICAgICAgfVxuICAgICAgICAgICAgZWxzZSB7XG4gICAgICAgICAgICAgICAgcmV0dXJuICcvbWVkaWEvaW1hZ2VzL2l0ZW1zLycgKyBkYXRhLml0ZW0gKyAnLnBuZyc7XG4gICAgICAgICAgICB9XG4gICAgICAgIGJyZWFrO1xuICAgICAgICBjYXNlICdkYWdvbic6XG4gICAgICAgIGNhc2UgJ2RpZmZ1c2FsX2JsYWRlJzpcbiAgICAgICAgY2FzZSAndHJhdmVsX2Jvb3RzJzpcbiAgICAgICAgY2FzZSAnbmVjcm9ub21pY29uJzpcbiAgICAgICAgICAgIGlmIChkYXRhLnNpemUgPiAxKSB7XG4gICAgICAgICAgICAgICAgcmV0dXJuICcvbWVkaWEvaW1hZ2VzL2l0ZW1zLycgKyBkYXRhLml0ZW0gKyAnXycgKyBkYXRhLnNpemUgKyAnLnBuZyc7XG4gICAgICAgICAgICB9XG4gICAgICAgICAgICBlbHNlIHtcbiAgICAgICAgICAgICAgICByZXR1cm4gJy9tZWRpYS9pbWFnZXMvaXRlbXMvJyArIGRhdGEuaXRlbSArICcucG5nJztcbiAgICAgICAgICAgIH1cbiAgICAgICAgYnJlYWs7XG4gICAgICAgIGRlZmF1bHQ6XG4gICAgICAgICAgICByZXR1cm4gJy9tZWRpYS9pbWFnZXMvaXRlbXMvJyArIGRhdGEuaXRlbSArICcucG5nJzsgICAgICAgICAgICBcbiAgICAgICAgYnJlYWs7XG4gICAgfVxufTtcbm15LnByb3RvdHlwZS5CYXNpY0ludmVudG9yeVZpZXdNb2RlbC5wcm90b3R5cGUuZ2V0SXRlbVNpemVMYWJlbCA9IGZ1bmN0aW9uIChkYXRhKSB7XG4gICAgaWYgKG15LnByb3RvdHlwZS5zdGFja2FibGVJdGVtcy5pbmRleE9mKGRhdGEuaXRlbSkgIT0gLTEpIHtcbiAgICAgICAgcmV0dXJuICc8c3BhbiBzdHlsZT1cImZvbnQtc2l6ZToxMHB4XCI+UXR5OiA8L3NwYW4+JyArIGRhdGEuc2l6ZTtcbiAgICB9XG4gICAgZWxzZSBpZiAobXkucHJvdG90eXBlLmxldmVsaXRlbXMuaW5kZXhPZihkYXRhLml0ZW0pICE9IC0xKSB7XG4gICAgICAgIHJldHVybiAnPHNwYW4gc3R5bGU9XCJmb250LXNpemU6MTBweFwiPkx2bDogPC9zcGFuPicgKyBkYXRhLnNpemU7XG4gICAgfVxuICAgIGVsc2UgaWYgKGRhdGEuaXRlbSA9PSAnYmxvb2RzdG9uZScpIHtcbiAgICAgICAgcmV0dXJuICc8c3BhbiBzdHlsZT1cImZvbnQtc2l6ZToxMHB4XCI+Q2hhcmdlczogPC9zcGFuPicgKyBkYXRhLnNpemU7XG4gICAgfVxuICAgIGVsc2Uge1xuICAgICAgICByZXR1cm4gJyc7XG4gICAgfVxufTtcbm15LnByb3RvdHlwZS5CYXNpY0ludmVudG9yeVZpZXdNb2RlbC5wcm90b3R5cGUuZ2V0QWN0aXZlQm9yZGVyID0gZnVuY3Rpb24gKGRhdGEpIHtcbiAgICBzd2l0Y2ggKGRhdGEuaXRlbSkge1xuICAgICAgICBjYXNlICdwb3dlcl90cmVhZHMnOlxuICAgICAgICBjYXNlICd0cmFucXVpbF9ib290cyc6XG4gICAgICAgIGNhc2UgJ3Jpbmdfb2ZfYmFzaWxpdXMnOlxuICAgICAgICBjYXNlICdyaW5nX29mX2FxdWlsYSc6XG4gICAgICAgIGNhc2UgJ2FybWxldCc6XG4gICAgICAgICAgICByZXR1cm4gMDtcbiAgICAgICAgYnJlYWs7XG4gICAgICAgIGRlZmF1bHQ6XG4gICAgICAgICAgICByZXR1cm4ga28udXRpbHMudW53cmFwT2JzZXJ2YWJsZShkYXRhLnN0YXRlKTsgICAgXG4gICAgICAgIGJyZWFrO1xuICAgIH1cbn1cbm15LnByb3RvdHlwZS5CYXNpY0ludmVudG9yeVZpZXdNb2RlbC5wcm90b3R5cGUuZ2V0SXRlbUF0dHJpYnV0ZVZhbHVlID0gZnVuY3Rpb24gKGF0dHJpYnV0ZXMsIGF0dHJpYnV0ZU5hbWUsIGxldmVsKSB7XG4gICAgZm9yICh2YXIgaSA9IDA7IGkgPCBhdHRyaWJ1dGVzLmxlbmd0aDsgaSsrKSB7XG4gICAgICAgIGlmIChhdHRyaWJ1dGVzW2ldLm5hbWUgPT0gYXR0cmlidXRlTmFtZSkge1xuICAgICAgICAgICAgaWYgKGxldmVsID09IDApIHtcbiAgICAgICAgICAgICAgICByZXR1cm4gcGFyc2VGbG9hdChhdHRyaWJ1dGVzW2ldLnZhbHVlWzBdKTtcbiAgICAgICAgICAgIH1cbiAgICAgICAgICAgIGVsc2UgaWYgKGxldmVsID4gYXR0cmlidXRlc1tpXS52YWx1ZS5sZW5ndGgpIHtcbiAgICAgICAgICAgICAgICByZXR1cm4gcGFyc2VGbG9hdChhdHRyaWJ1dGVzW2ldLnZhbHVlWzBdKTtcbiAgICAgICAgICAgIH1cbiAgICAgICAgICAgIGVsc2Uge1xuICAgICAgICAgICAgICAgIHJldHVybiBwYXJzZUZsb2F0KGF0dHJpYnV0ZXNbaV0udmFsdWVbbGV2ZWwgLSAxXSk7XG4gICAgICAgICAgICB9XG4gICAgICAgIH1cbiAgICB9XG59XG5cbm15LnByb3RvdHlwZS5JbnZlbnRvcnlWaWV3TW9kZWwgPSBmdW5jdGlvbiAoaCkge1xuICAgIHZhciBzZWxmID0gbmV3IG15LnByb3RvdHlwZS5CYXNpY0ludmVudG9yeVZpZXdNb2RlbCgpO1xuICAgIHNlbGYuaGVybyA9IGg7XG4gICAgc2VsZi5oYXNJbnZlbnRvcnkgPSBrby5vYnNlcnZhYmxlKHRydWUpO1xuICAgIHNlbGYuaXRlbXMgPSBrby5vYnNlcnZhYmxlQXJyYXkoW10pO1xuICAgIHNlbGYuYWN0aXZlSXRlbXMgPSBrby5vYnNlcnZhYmxlQXJyYXkoW10pO1xuICAgIHNlbGYuaGFzU2NlcHRlciA9IGtvLmNvbXB1dGVkKGZ1bmN0aW9uICgpIHtcbiAgICAgICAgZm9yICh2YXIgaSA9IDA7IGkgPCBzZWxmLml0ZW1zKCkubGVuZ3RoOyBpKyspIHtcbiAgICAgICAgICAgIHZhciBpdGVtID0gc2VsZi5pdGVtcygpW2ldLml0ZW07XG4gICAgICAgICAgICBpZiAoaXRlbSA9PT0gJ3VsdGltYXRlX3NjZXB0ZXInICYmIHNlbGYuaXRlbXMoKVtpXS5lbmFibGVkKCkpIHtcbiAgICAgICAgICAgICAgICByZXR1cm4gdHJ1ZTtcbiAgICAgICAgICAgIH1cbiAgICAgICAgICAgIFxuICAgICAgICB9XG4gICAgICAgIHJldHVybiBmYWxzZTtcbiAgICB9LCB0aGlzKTtcbiAgICBzZWxmLmlzRXRoZXJlYWwgPSBrby5jb21wdXRlZChmdW5jdGlvbiAoKSB7XG4gICAgICAgIGZvciAodmFyIGkgPSAwOyBpIDwgc2VsZi5pdGVtcygpLmxlbmd0aDsgaSsrKSB7XG4gICAgICAgICAgICB2YXIgaXRlbSA9IHNlbGYuaXRlbXMoKVtpXS5pdGVtO1xuICAgICAgICAgICAgdmFyIGlzQWN0aXZlID0gc2VsZi5hY3RpdmVJdGVtcy5pbmRleE9mKHNlbGYuaXRlbXMoKVtpXSkgPj0gMCA/IHRydWUgOiBmYWxzZTtcbiAgICAgICAgICAgIGlmICgoaXRlbSA9PT0gJ2dob3N0JyB8fCBpdGVtID09PSAnZXRoZXJlYWxfYmxhZGUnKSAmJiBzZWxmLml0ZW1zKClbaV0uZW5hYmxlZCgpICYmIGlzQWN0aXZlKSB7XG4gICAgICAgICAgICAgICAgcmV0dXJuIHRydWU7XG4gICAgICAgICAgICB9XG4gICAgICAgIH1cbiAgICAgICAgcmV0dXJuIGZhbHNlO1xuICAgIH0sIHRoaXMpO1xuICAgIHNlbGYuaXNTaGVlcGVkID0ga28uY29tcHV0ZWQoZnVuY3Rpb24gKCkge1xuICAgICAgICBmb3IgKHZhciBpID0gMDsgaSA8IHNlbGYuaXRlbXMoKS5sZW5ndGg7IGkrKykge1xuICAgICAgICAgICAgdmFyIGl0ZW0gPSBzZWxmLml0ZW1zKClbaV0uaXRlbTtcbiAgICAgICAgICAgIHZhciBpc0FjdGl2ZSA9IHNlbGYuYWN0aXZlSXRlbXMuaW5kZXhPZihzZWxmLml0ZW1zKClbaV0pID49IDAgPyB0cnVlIDogZmFsc2U7XG4gICAgICAgICAgICBpZiAoaXRlbSA9PT0gJ3NoZWVwc3RpY2snICYmIHNlbGYuaXRlbXMoKVtpXS5lbmFibGVkKCkgJiYgaXNBY3RpdmUpIHtcbiAgICAgICAgICAgICAgICByZXR1cm4gdHJ1ZTtcbiAgICAgICAgICAgIH1cbiAgICAgICAgfVxuICAgICAgICByZXR1cm4gZmFsc2U7XG4gICAgfSwgdGhpcyk7XG4gICAgc2VsZi50b3RhbENvc3QgPSBrby5jb21wdXRlZChmdW5jdGlvbiAoKSB7XG4gICAgICAgIHZhciBjID0gMDtcbiAgICAgICAgZm9yICh2YXIgaSA9IDA7IGkgPCBzZWxmLml0ZW1zKCkubGVuZ3RoOyBpKyspIHtcbiAgICAgICAgICAgIHZhciBpdGVtID0gc2VsZi5pdGVtcygpW2ldLml0ZW07XG4gICAgICAgICAgICBpZiAoIXNlbGYuaXRlbXMoKVtpXS5lbmFibGVkKCkpIGNvbnRpbnVlO1xuICAgICAgICAgICAgaWYgKG15LnByb3RvdHlwZS5zdGFja2FibGVJdGVtcy5pbmRleE9mKGl0ZW0pICE9IC0xKSB7XG4gICAgICAgICAgICAgICAgYyArPSBteS5wcm90b3R5cGUuaXRlbURhdGFbJ2l0ZW1fJyArIGl0ZW1dLml0ZW1jb3N0ICogc2VsZi5pdGVtcygpW2ldLnNpemU7XG4gICAgICAgICAgICB9XG4gICAgICAgICAgICBlbHNlIGlmIChteS5wcm90b3R5cGUubGV2ZWxpdGVtcy5pbmRleE9mKGl0ZW0pICE9IC0xKSB7XG4gICAgICAgICAgICAgICAgc3dpdGNoKGl0ZW0pIHtcbiAgICAgICAgICAgICAgICAgICAgY2FzZSAnZGlmZnVzYWxfYmxhZGUnOlxuICAgICAgICAgICAgICAgICAgICAgICAgYyArPSBteS5wcm90b3R5cGUuaXRlbURhdGFbJ2l0ZW1fJyArIGl0ZW1dLml0ZW1jb3N0ICsgKHNlbGYuaXRlbXMoKVtpXS5zaXplIC0gMSkgKiA3MDA7XG4gICAgICAgICAgICAgICAgICAgIGJyZWFrO1xuICAgICAgICAgICAgICAgICAgICBjYXNlICduZWNyb25vbWljb24nOlxuICAgICAgICAgICAgICAgICAgICBjYXNlICdkYWdvbic6XG4gICAgICAgICAgICAgICAgICAgICAgICBjICs9IG15LnByb3RvdHlwZS5pdGVtRGF0YVsnaXRlbV8nICsgaXRlbV0uaXRlbWNvc3QgKyAoc2VsZi5pdGVtcygpW2ldLnNpemUgLSAxKSAqIDEyNTA7XG4gICAgICAgICAgICAgICAgICAgIGJyZWFrO1xuICAgICAgICAgICAgICAgICAgICBkZWZhdWx0OlxuICAgICAgICAgICAgICAgICAgICAgICAgYyArPSBteS5wcm90b3R5cGUuaXRlbURhdGFbJ2l0ZW1fJyArIGl0ZW1dLml0ZW1jb3N0O1xuICAgICAgICAgICAgICAgICAgICBicmVhaztcbiAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICB9XG4gICAgICAgICAgICBlbHNlIHtcbiAgICAgICAgICAgICAgICBjICs9IG15LnByb3RvdHlwZS5pdGVtRGF0YVsnaXRlbV8nICsgaXRlbV0uaXRlbWNvc3Q7XG4gICAgICAgICAgICB9XG4gICAgICAgICAgICBcbiAgICAgICAgfVxuICAgICAgICByZXR1cm4gYztcbiAgICB9LCB0aGlzKTtcbiAgICBzZWxmLmFkZEl0ZW1CdWZmID0gZnVuY3Rpb24gKGRhdGEsIGV2ZW50KSB7XG4gICAgICAgIGlmIChzZWxmLmhhc0ludmVudG9yeSgpICYmIHNlbGYuc2VsZWN0ZWRJdGVtQnVmZigpICE9IHVuZGVmaW5lZCkge1xuICAgICAgICAgICAgdmFyIG5ld19pdGVtID0ge1xuICAgICAgICAgICAgICAgIGl0ZW06IHNlbGYuc2VsZWN0ZWRJdGVtQnVmZigpLFxuICAgICAgICAgICAgICAgIHN0YXRlOiBrby5vYnNlcnZhYmxlKDApLFxuICAgICAgICAgICAgICAgIHNpemU6IDEsXG4gICAgICAgICAgICAgICAgZW5hYmxlZDoga28ub2JzZXJ2YWJsZSh0cnVlKVxuICAgICAgICAgICAgfVxuICAgICAgICAgICAgc2VsZi5pdGVtcy5wdXNoKG5ld19pdGVtKTtcbiAgICAgICAgICAgIGlmIChzZWxmLnNlbGVjdGVkSXRlbUJ1ZmYoKSA9PT0gJ3Jpbmdfb2ZfYXF1aWxhJyB8fCBzZWxmLnNlbGVjdGVkSXRlbUJ1ZmYoKSA9PT0gJ3Jpbmdfb2ZfYmFzaWxpdXMnKSB7XG4gICAgICAgICAgICAgICAgc2VsZi50b2dnbGVJdGVtKHVuZGVmaW5lZCwgbmV3X2l0ZW0sIHVuZGVmaW5lZCk7XG4gICAgICAgICAgICB9XG4gICAgICAgIH1cbiAgICB9O1xuICAgIHNlbGYuYWRkSXRlbURlYnVmZiA9IGZ1bmN0aW9uIChkYXRhLCBldmVudCkge1xuICAgICAgICBpZiAoc2VsZi5oYXNJbnZlbnRvcnkoKSAmJiBzZWxmLnNlbGVjdGVkSXRlbURlYnVmZigpICE9IHVuZGVmaW5lZCkge1xuICAgICAgICAgICAgdmFyIG5ld19pdGVtID0ge1xuICAgICAgICAgICAgICAgIGl0ZW06IHNlbGYuc2VsZWN0ZWRJdGVtRGVidWZmKCkuc3BsaXQoJ3wnKVswXSxcbiAgICAgICAgICAgICAgICBzdGF0ZToga28ub2JzZXJ2YWJsZSgwKSxcbiAgICAgICAgICAgICAgICBzaXplOiAxLFxuICAgICAgICAgICAgICAgIGVuYWJsZWQ6IGtvLm9ic2VydmFibGUodHJ1ZSlcbiAgICAgICAgICAgIH1cbiAgICAgICAgICAgIGlmIChzZWxmLnNlbGVjdGVkSXRlbURlYnVmZigpLnNwbGl0KCd8JykubGVuZ3RoID09IDIpIHtcbiAgICAgICAgICAgICAgICBuZXdfaXRlbS5kZWJ1ZmYgPSBzZWxmLnNlbGVjdGVkSXRlbURlYnVmZigpLnNwbGl0KCd8JylbMV1cbiAgICAgICAgICAgIH1cbiAgICAgICAgICAgIHNlbGYuaXRlbXMucHVzaChuZXdfaXRlbSk7XG4gICAgICAgICAgICBpZiAoc2VsZi5zZWxlY3RlZEl0ZW1EZWJ1ZmYoKSA9PT0gJ3Jpbmdfb2ZfYXF1aWxhJyB8fCBzZWxmLnNlbGVjdGVkSXRlbURlYnVmZigpID09PSAncmluZ19vZl9iYXNpbGl1cycpIHtcbiAgICAgICAgICAgICAgICBzZWxmLnRvZ2dsZUl0ZW0odW5kZWZpbmVkLCBuZXdfaXRlbSwgdW5kZWZpbmVkKTtcbiAgICAgICAgICAgIH1cbiAgICAgICAgfVxuICAgIH07XG4gICAgXG4gICAgc2VsZi5nZXRBdHRyaWJ1dGVzID0gZnVuY3Rpb24gKGF0dHJpYnV0ZXR5cGUpIHtcbiAgICAgICAgdmFyIHRvdGFsQXR0cmlidXRlID0gMDtcbiAgICAgICAgZm9yICh2YXIgaSA9IDA7IGkgPCBzZWxmLml0ZW1zKCkubGVuZ3RoOyBpKyspIHtcbiAgICAgICAgICAgIHZhciBpdGVtID0gc2VsZi5pdGVtcygpW2ldLml0ZW07XG4gICAgICAgICAgICB2YXIgaXNBY3RpdmUgPSBzZWxmLmFjdGl2ZUl0ZW1zLmluZGV4T2Yoc2VsZi5pdGVtcygpW2ldKSA+PSAwID8gdHJ1ZSA6IGZhbHNlO1xuICAgICAgICAgICAgaWYgKCFzZWxmLml0ZW1zKClbaV0uZW5hYmxlZCgpKSBjb250aW51ZTtcbiAgICAgICAgICAgIHZhciBzaXplID0gc2VsZi5pdGVtcygpW2ldLnNpemU7XG4gICAgICAgICAgICBmb3IgKHZhciBqID0gMDsgaiA8IG15LnByb3RvdHlwZS5pdGVtRGF0YVsnaXRlbV8nICsgaXRlbV0uYXR0cmlidXRlcy5sZW5ndGg7IGorKykge1xuICAgICAgICAgICAgICAgIHZhciBhdHRyaWJ1dGUgPSBteS5wcm90b3R5cGUuaXRlbURhdGFbJ2l0ZW1fJyArIGl0ZW1dLmF0dHJpYnV0ZXNbal07XG4gICAgICAgICAgICAgICAgc3dpdGNoKGF0dHJpYnV0ZS5uYW1lKSB7XG4gICAgICAgICAgICAgICAgICAgIGNhc2UgJ2JvbnVzX2FsbF9zdGF0cyc6XG4gICAgICAgICAgICAgICAgICAgICAgICB0b3RhbEF0dHJpYnV0ZSArPSBwYXJzZUludChhdHRyaWJ1dGUudmFsdWVbMF0pO1xuICAgICAgICAgICAgICAgICAgICBicmVhaztcbiAgICAgICAgICAgICAgICAgICAgY2FzZSAnYm9udXNfc3RhdHMnOlxuICAgICAgICAgICAgICAgICAgICAgICAgdG90YWxBdHRyaWJ1dGUgKz0gcGFyc2VJbnQoYXR0cmlidXRlLnZhbHVlWzBdKTtcbiAgICAgICAgICAgICAgICAgICAgYnJlYWs7XG4gICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICAgIHN3aXRjaChhdHRyaWJ1dGV0eXBlKSB7XG4gICAgICAgICAgICAgICAgICAgIGNhc2UgJ2FnaSc6XG4gICAgICAgICAgICAgICAgICAgICAgICBpZiAoYXR0cmlidXRlLm5hbWUgPT0gJ2JvbnVzX2FnaWxpdHknKSB7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgaWYgKGl0ZW0gPT0gJ2RpZmZ1c2FsX2JsYWRlJykge1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICB0b3RhbEF0dHJpYnV0ZSArPSBwYXJzZUludChhdHRyaWJ1dGUudmFsdWVbc2l6ZS0xXSk7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICAgICAgICAgICAgICAgIGVsc2Uge1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICB0b3RhbEF0dHJpYnV0ZSArPSBwYXJzZUludChhdHRyaWJ1dGUudmFsdWVbMF0pO1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgICAgICAgICAgIGlmIChhdHRyaWJ1dGUubmFtZSA9PSAnYm9udXNfc3RhdCcgJiYgc2VsZi5pdGVtcygpW2ldLnN0YXRlKCkgPT0gMikge3RvdGFsQXR0cmlidXRlICs9IHBhcnNlSW50KGF0dHJpYnV0ZS52YWx1ZVswXSk7fTtcbiAgICAgICAgICAgICAgICAgICAgICAgIGlmIChhdHRyaWJ1dGUubmFtZSA9PSAnYm9udXNfYWdpJykge3RvdGFsQXR0cmlidXRlICs9IHBhcnNlSW50KGF0dHJpYnV0ZS52YWx1ZVswXSk7fTtcbiAgICAgICAgICAgICAgICAgICAgYnJlYWs7XG4gICAgICAgICAgICAgICAgICAgIGNhc2UgJ2ludCc6XG4gICAgICAgICAgICAgICAgICAgICAgICBpZiAoYXR0cmlidXRlLm5hbWUgPT0gJ2JvbnVzX2ludGVsbGVjdCcpIHtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICBpZiAoaXRlbSA9PSAnbmVjcm9ub21pY29uJykge1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICB0b3RhbEF0dHJpYnV0ZSArPSBwYXJzZUludChhdHRyaWJ1dGUudmFsdWVbc2l6ZS0xXSk7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICAgICAgICAgICAgICAgIGVsc2UgaWYgKGl0ZW0gPT0gJ2RpZmZ1c2FsX2JsYWRlJykge1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICB0b3RhbEF0dHJpYnV0ZSArPSBwYXJzZUludChhdHRyaWJ1dGUudmFsdWVbc2l6ZS0xXSk7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICAgICAgICAgICAgICAgIGVsc2UgaWYgKGl0ZW0gPT0gJ2RhZ29uJykge1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICB0b3RhbEF0dHJpYnV0ZSArPSBwYXJzZUludChhdHRyaWJ1dGUudmFsdWVbc2l6ZS0xXSk7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICAgICAgICAgICAgICAgIGVsc2Uge1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICB0b3RhbEF0dHJpYnV0ZSArPSBwYXJzZUludChhdHRyaWJ1dGUudmFsdWVbMF0pO1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgICAgICAgICAgIGlmIChhdHRyaWJ1dGUubmFtZSA9PSAnYm9udXNfaW50ZWxsaWdlbmNlJykge3RvdGFsQXR0cmlidXRlICs9IHBhcnNlSW50KGF0dHJpYnV0ZS52YWx1ZVswXSk7fTtcbiAgICAgICAgICAgICAgICAgICAgICAgIGlmIChhdHRyaWJ1dGUubmFtZSA9PSAnYm9udXNfaW50Jykge3RvdGFsQXR0cmlidXRlICs9IHBhcnNlSW50KGF0dHJpYnV0ZS52YWx1ZVswXSk7fTtcbiAgICAgICAgICAgICAgICAgICAgICAgIGlmIChhdHRyaWJ1dGUubmFtZSA9PSAnYm9udXNfc3RhdCcgJiYgc2VsZi5pdGVtcygpW2ldLnN0YXRlKCkgPT0gMSkge3RvdGFsQXR0cmlidXRlICs9IHBhcnNlSW50KGF0dHJpYnV0ZS52YWx1ZVswXSk7fTtcbiAgICAgICAgICAgICAgICAgICAgYnJlYWs7XG4gICAgICAgICAgICAgICAgICAgIGNhc2UgJ3N0cic6XG4gICAgICAgICAgICAgICAgICAgICAgICBpZiAoYXR0cmlidXRlLm5hbWUgPT0gJ2JvbnVzX3N0cmVuZ3RoJykge1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgIGlmIChpdGVtID09ICduZWNyb25vbWljb24nKSB7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIHRvdGFsQXR0cmlidXRlICs9IHBhcnNlSW50KGF0dHJpYnV0ZS52YWx1ZVtzaXplLTFdKTtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgZWxzZSB7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIHRvdGFsQXR0cmlidXRlICs9IHBhcnNlSW50KGF0dHJpYnV0ZS52YWx1ZVswXSk7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICAgICAgICAgICAgaWYgKGF0dHJpYnV0ZS5uYW1lID09ICdib251c19zdGF0JyAmJiBzZWxmLml0ZW1zKClbaV0uc3RhdGUoKSA9PSAwKSB7dG90YWxBdHRyaWJ1dGUgKz0gcGFyc2VJbnQoYXR0cmlidXRlLnZhbHVlWzBdKTt9O1xuICAgICAgICAgICAgICAgICAgICAgICAgaWYgKGF0dHJpYnV0ZS5uYW1lID09ICdib251c19zdHInKSB7dG90YWxBdHRyaWJ1dGUgKz0gcGFyc2VJbnQoYXR0cmlidXRlLnZhbHVlWzBdKTt9O1xuICAgICAgICAgICAgICAgICAgICAgICAgaWYgKGF0dHJpYnV0ZS5uYW1lID09ICd1bmhvbHlfYm9udXNfc3RyZW5ndGgnICYmIGlzQWN0aXZlKSB7dG90YWxBdHRyaWJ1dGUgKz0gcGFyc2VJbnQoYXR0cmlidXRlLnZhbHVlWzBdKTt9O1xuICAgICAgICAgICAgICAgICAgICBicmVhaztcbiAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICB9XG4gICAgICAgIH1cbiAgICAgICAgcmV0dXJuIHRvdGFsQXR0cmlidXRlO1xuICAgIH07XG4gICAgc2VsZi5nZXRCYXNoID0gZnVuY3Rpb24gKGF0dGFja3R5cGUpIHtcbiAgICAgICAgdmFyIHRvdGFsQXR0cmlidXRlID0gMTtcbiAgICAgICAgZm9yICh2YXIgaSA9IDA7IGkgPCBzZWxmLml0ZW1zKCkubGVuZ3RoOyBpKyspIHtcbiAgICAgICAgICAgIHZhciBpdGVtID0gc2VsZi5pdGVtcygpW2ldLml0ZW07XG4gICAgICAgICAgICBpZiAoIXNlbGYuaXRlbXMoKVtpXS5lbmFibGVkKCkpIGNvbnRpbnVlO1xuICAgICAgICAgICAgZm9yICh2YXIgaiA9IDA7IGogPCBteS5wcm90b3R5cGUuaXRlbURhdGFbJ2l0ZW1fJyArIGl0ZW1dLmF0dHJpYnV0ZXMubGVuZ3RoOyBqKyspIHtcbiAgICAgICAgICAgICAgICB2YXIgYXR0cmlidXRlID0gbXkucHJvdG90eXBlLml0ZW1EYXRhWydpdGVtXycgKyBpdGVtXS5hdHRyaWJ1dGVzW2pdO1xuICAgICAgICAgICAgICAgIHN3aXRjaChhdHRyaWJ1dGUubmFtZSkge1xuICAgICAgICAgICAgICAgICAgICBjYXNlICdiYXNoX2NoYW5jZSc6XG4gICAgICAgICAgICAgICAgICAgICAgICB0b3RhbEF0dHJpYnV0ZSAqPSAoMSAtIHBhcnNlSW50KGF0dHJpYnV0ZS52YWx1ZVswXSkgLyAxMDApO1xuICAgICAgICAgICAgICAgICAgICBicmVhaztcbiAgICAgICAgICAgICAgICAgICAgY2FzZSAnYmFzaF9jaGFuY2VfbWVsZWUnOlxuICAgICAgICAgICAgICAgICAgICAgICAgaWYgKGF0dGFja3R5cGUgPT0gJ0RPVEFfVU5JVF9DQVBfTUVMRUVfQVRUQUNLJykgeyB0b3RhbEF0dHJpYnV0ZSAqPSAoMSAtIHBhcnNlSW50KGF0dHJpYnV0ZS52YWx1ZVswXSkgLyAxMDApOyB9O1xuICAgICAgICAgICAgICAgICAgICBicmVhaztcbiAgICAgICAgICAgICAgICAgICAgY2FzZSAnYmFzaF9jaGFuY2VfcmFuZ2VkJzpcbiAgICAgICAgICAgICAgICAgICAgICAgIGlmIChhdHRhY2t0eXBlID09ICdET1RBX1VOSVRfQ0FQX1JBTkdFRF9BVFRBQ0snKSB7IHRvdGFsQXR0cmlidXRlICo9ICgxIC0gcGFyc2VJbnQoYXR0cmlidXRlLnZhbHVlWzBdKSAvIDEwMCk7IH07XG4gICAgICAgICAgICAgICAgICAgIGJyZWFrO1xuICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgIH1cbiAgICAgICAgfVxuICAgICAgICByZXR1cm4gdG90YWxBdHRyaWJ1dGU7XG4gICAgfTtcbiAgICBcbiAgICBzZWxmLmdldENyaXRDaGFuY2UgPSBmdW5jdGlvbiAoKSB7XG4gICAgICAgIHZhciB0b3RhbEF0dHJpYnV0ZSA9IDE7XG4gICAgICAgIGZvciAodmFyIGkgPSAwOyBpIDwgc2VsZi5pdGVtcygpLmxlbmd0aDsgaSsrKSB7XG4gICAgICAgICAgICB2YXIgaXRlbSA9IHNlbGYuaXRlbXMoKVtpXS5pdGVtO1xuICAgICAgICAgICAgdmFyIGlzQWN0aXZlID0gc2VsZi5hY3RpdmVJdGVtcy5pbmRleE9mKHNlbGYuaXRlbXMoKVtpXSkgPj0gMCA/IHRydWUgOiBmYWxzZTtcbiAgICAgICAgICAgIGlmICghc2VsZi5pdGVtcygpW2ldLmVuYWJsZWQoKSkgY29udGludWU7XG4gICAgICAgICAgICBmb3IgKHZhciBqID0gMDsgaiA8IG15LnByb3RvdHlwZS5pdGVtRGF0YVsnaXRlbV8nICsgaXRlbV0uYXR0cmlidXRlcy5sZW5ndGg7IGorKykge1xuICAgICAgICAgICAgICAgIHZhciBhdHRyaWJ1dGUgPSBteS5wcm90b3R5cGUuaXRlbURhdGFbJ2l0ZW1fJyArIGl0ZW1dLmF0dHJpYnV0ZXNbal07XG4gICAgICAgICAgICAgICAgc3dpdGNoKGF0dHJpYnV0ZS5uYW1lKSB7XG4gICAgICAgICAgICAgICAgICAgIGNhc2UgJ2NyaXRfY2hhbmNlJzpcbiAgICAgICAgICAgICAgICAgICAgICAgIHRvdGFsQXR0cmlidXRlICo9ICgxIC0gcGFyc2VJbnQoYXR0cmlidXRlLnZhbHVlWzBdKSAvIDEwMCk7XG4gICAgICAgICAgICAgICAgICAgIGJyZWFrO1xuICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgIH1cbiAgICAgICAgfVxuICAgICAgICByZXR1cm4gdG90YWxBdHRyaWJ1dGU7XG4gICAgfTtcbiAgICBcbiAgICBzZWxmLmdldENyaXRTb3VyY2UgPSBmdW5jdGlvbiAoKSB7XG4gICAgICAgIHZhciBzb3VyY2VzID0ge307XG4gICAgICAgIGZvciAodmFyIGkgPSAwOyBpIDwgc2VsZi5pdGVtcygpLmxlbmd0aDsgaSsrKSB7XG4gICAgICAgICAgICB2YXIgaXRlbSA9IHNlbGYuaXRlbXMoKVtpXS5pdGVtO1xuICAgICAgICAgICAgdmFyIGlzQWN0aXZlID0gc2VsZi5hY3RpdmVJdGVtcy5pbmRleE9mKHNlbGYuaXRlbXMoKVtpXSkgPj0gMCA/IHRydWUgOiBmYWxzZTtcbiAgICAgICAgICAgIGlmICghc2VsZi5pdGVtcygpW2ldLmVuYWJsZWQoKSkgY29udGludWU7XG4gICAgICAgICAgICBzd2l0Y2ggKGl0ZW0pIHtcbiAgICAgICAgICAgICAgICBjYXNlICdsZXNzZXJfY3JpdCc6XG4gICAgICAgICAgICAgICAgY2FzZSAnZ3JlYXRlcl9jcml0JzpcbiAgICAgICAgICAgICAgICBjYXNlICdibG9vZHRob3JuJzpcbiAgICAgICAgICAgICAgICAgICAgaWYgKHNvdXJjZXNbaXRlbV0gPT0gdW5kZWZpbmVkKSB7XG4gICAgICAgICAgICAgICAgICAgICAgICBzb3VyY2VzW2l0ZW1dID0ge1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgICdjaGFuY2UnOiBzZWxmLmdldEl0ZW1BdHRyaWJ1dGVWYWx1ZShteS5wcm90b3R5cGUuaXRlbURhdGFbJ2l0ZW1fJyArIGl0ZW1dLmF0dHJpYnV0ZXMsICdjcml0X2NoYW5jZScsIDApIC8gMTAwLFxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICdtdWx0aXBsaWVyJzogc2VsZi5nZXRJdGVtQXR0cmlidXRlVmFsdWUobXkucHJvdG90eXBlLml0ZW1EYXRhWydpdGVtXycgKyBpdGVtXS5hdHRyaWJ1dGVzLCAnY3JpdF9tdWx0aXBsaWVyJywgMCkgLyAxMDAsXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgJ2NvdW50JzogMSxcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAnZGlzcGxheW5hbWUnOiBteS5wcm90b3R5cGUuaXRlbURhdGFbJ2l0ZW1fJyArIGl0ZW1dLmRpc3BsYXluYW1lXG4gICAgICAgICAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgICAgICAgZWxzZSB7XG4gICAgICAgICAgICAgICAgICAgICAgICBzb3VyY2VzW2l0ZW1dLmNvdW50ICs9IDE7XG4gICAgICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgICBicmVhaztcbiAgICAgICAgICAgIH1cbiAgICAgICAgICAgIGlmIChpdGVtID09PSAnYmxvb2R0aG9ybicgJiYgaXNBY3RpdmUpIHtcbiAgICAgICAgICAgICAgICBpZiAoc291cmNlc1snc291bF9yZW5kJ10gPT0gdW5kZWZpbmVkKSB7XG4gICAgICAgICAgICAgICAgICAgIHNvdXJjZXNbJ3NvdWxfcmVuZCddID0ge1xuICAgICAgICAgICAgICAgICAgICAgICAgJ2NoYW5jZSc6IDEsXG4gICAgICAgICAgICAgICAgICAgICAgICAnbXVsdGlwbGllcic6IHNlbGYuZ2V0SXRlbUF0dHJpYnV0ZVZhbHVlKG15LnByb3RvdHlwZS5pdGVtRGF0YVsnaXRlbV8nICsgaXRlbV0uYXR0cmlidXRlcywgJ3RhcmdldF9jcml0X211bHRpcGxpZXInLCAwKSAvIDEwMCxcbiAgICAgICAgICAgICAgICAgICAgICAgICdjb3VudCc6IDEsXG4gICAgICAgICAgICAgICAgICAgICAgICAnZGlzcGxheW5hbWUnOiAnU291bCBSZW5kJ1xuICAgICAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICAgIGVsc2Uge1xuICAgICAgICAgICAgICAgICAgICBzb3VyY2VzWydzb3VsX3JlbmQnXS5jb3VudCArPSAxO1xuICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgIH1cbiAgICAgICAgfVxuICAgICAgICByZXR1cm4gc291cmNlcztcbiAgICB9O1xuXG4gICAgc2VsZi5nZXRDbGVhdmVTb3VyY2UgPSBmdW5jdGlvbiAoKSB7XG4gICAgICAgIHZhciBzb3VyY2VzID0ge307XG4gICAgICAgIGZvciAodmFyIGkgPSAwOyBpIDwgc2VsZi5pdGVtcygpLmxlbmd0aDsgaSsrKSB7XG4gICAgICAgICAgICB2YXIgaXRlbSA9IHNlbGYuaXRlbXMoKVtpXS5pdGVtO1xuICAgICAgICAgICAgdmFyIGlzQWN0aXZlID0gc2VsZi5hY3RpdmVJdGVtcy5pbmRleE9mKHNlbGYuaXRlbXMoKVtpXSkgPj0gMCA/IHRydWUgOiBmYWxzZTtcbiAgICAgICAgICAgIGlmICghc2VsZi5pdGVtcygpW2ldLmVuYWJsZWQoKSkgY29udGludWU7XG4gICAgICAgICAgICBzd2l0Y2ggKGl0ZW0pIHtcbiAgICAgICAgICAgICAgICBjYXNlICdiZnVyeSc6XG4gICAgICAgICAgICAgICAgICAgIGlmIChzb3VyY2VzW2l0ZW1dID09IHVuZGVmaW5lZCkge1xuICAgICAgICAgICAgICAgICAgICAgICAgc291cmNlc1tpdGVtXSA9IHtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAncmFkaXVzJzogc2VsZi5nZXRJdGVtQXR0cmlidXRlVmFsdWUobXkucHJvdG90eXBlLml0ZW1EYXRhWydpdGVtXycgKyBpdGVtXS5hdHRyaWJ1dGVzLCAnY2xlYXZlX3JhZGl1cycsIDApLFxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICdtYWduaXR1ZGUnOiBzZWxmLmdldEl0ZW1BdHRyaWJ1dGVWYWx1ZShteS5wcm90b3R5cGUuaXRlbURhdGFbJ2l0ZW1fJyArIGl0ZW1dLmF0dHJpYnV0ZXMsICdjbGVhdmVfZGFtYWdlX3BlcmNlbnQnLCAwKSAvIDEwMCxcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAnY291bnQnOiAxLFxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICdkaXNwbGF5bmFtZSc6IG15LnByb3RvdHlwZS5pdGVtRGF0YVsnaXRlbV8nICsgaXRlbV0uZGlzcGxheW5hbWVcbiAgICAgICAgICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICAgICAgICBlbHNlIHtcbiAgICAgICAgICAgICAgICAgICAgICAgIHNvdXJjZXNbaXRlbV0uY291bnQgKz0gMTtcbiAgICAgICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICAgIGJyZWFrO1xuICAgICAgICAgICAgfVxuXG4gICAgICAgIH1cbiAgICAgICAgcmV0dXJuIHNvdXJjZXM7XG4gICAgfTtcbiAgICBcbiAgICBzZWxmLmdldEJhc2hTb3VyY2UgPSBmdW5jdGlvbiAoYXR0YWNrdHlwZSkge1xuICAgICAgICB2YXIgc291cmNlcyA9IHt9O1xuICAgICAgICBmb3IgKHZhciBpID0gMDsgaSA8IHNlbGYuaXRlbXMoKS5sZW5ndGg7IGkrKykge1xuICAgICAgICAgICAgdmFyIGl0ZW0gPSBzZWxmLml0ZW1zKClbaV0uaXRlbTtcbiAgICAgICAgICAgIHZhciBpc0FjdGl2ZSA9IHNlbGYuYWN0aXZlSXRlbXMuaW5kZXhPZihzZWxmLml0ZW1zKClbaV0pID49IDAgPyB0cnVlIDogZmFsc2U7XG4gICAgICAgICAgICBpZiAoIXNlbGYuaXRlbXMoKVtpXS5lbmFibGVkKCkpIGNvbnRpbnVlO1xuICAgICAgICAgICAgc3dpdGNoIChpdGVtKSB7XG4gICAgICAgICAgICAgICAgY2FzZSAnamF2ZWxpbic6XG4gICAgICAgICAgICAgICAgICAgIGlmIChzb3VyY2VzW2l0ZW1dID09IHVuZGVmaW5lZCkge1xuICAgICAgICAgICAgICAgICAgICAgICAgc291cmNlc1tpdGVtXSA9IHtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAnZGFtYWdlJzogc2VsZi5nZXRJdGVtQXR0cmlidXRlVmFsdWUobXkucHJvdG90eXBlLml0ZW1EYXRhWydpdGVtXycgKyBpdGVtXS5hdHRyaWJ1dGVzLCAnYm9udXNfY2hhbmNlX2RhbWFnZScsIDEpLFxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICdkYW1hZ2VUeXBlJzogJ21hZ2ljJyxcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAnY291bnQnOiAxLFxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICdjaGFuY2UnOiBzZWxmLmdldEl0ZW1BdHRyaWJ1dGVWYWx1ZShteS5wcm90b3R5cGUuaXRlbURhdGFbJ2l0ZW1fJyArIGl0ZW1dLmF0dHJpYnV0ZXMsICdib251c19jaGFuY2UnLCAxKSAvIDEwMCxcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAnZGlzcGxheW5hbWUnOiBteS5wcm90b3R5cGUuaXRlbURhdGFbJ2l0ZW1fJyArIGl0ZW1dLmRpc3BsYXluYW1lICsgJyBQaWVyY2UnXG4gICAgICAgICAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgICAgICAgZWxzZSB7XG4gICAgICAgICAgICAgICAgICAgICAgICBzb3VyY2VzW2l0ZW1dLmNvdW50ICs9IDE7XG4gICAgICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgICBicmVhaztcbiAgICAgICAgICAgICAgICBjYXNlICdtb25rZXlfa2luZ19iYXInOlxuICAgICAgICAgICAgICAgICAgICBpZiAoc291cmNlc1tpdGVtXSA9PSB1bmRlZmluZWQpIHtcbiAgICAgICAgICAgICAgICAgICAgICAgIHNvdXJjZXNbaXRlbV0gPSB7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgJ2l0ZW0nOiBpdGVtLFxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICdjaGFuY2UnOiBzZWxmLmdldEl0ZW1BdHRyaWJ1dGVWYWx1ZShteS5wcm90b3R5cGUuaXRlbURhdGFbJ2l0ZW1fJyArIGl0ZW1dLmF0dHJpYnV0ZXMsICdiYXNoX2NoYW5jZScsIDApIC8gMTAwLFxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICdkYW1hZ2UnOiBzZWxmLmdldEl0ZW1BdHRyaWJ1dGVWYWx1ZShteS5wcm90b3R5cGUuaXRlbURhdGFbJ2l0ZW1fJyArIGl0ZW1dLmF0dHJpYnV0ZXMsICdiYXNoX2RhbWFnZScsIDApLFxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICdkdXJhdGlvbic6IHNlbGYuZ2V0SXRlbUF0dHJpYnV0ZVZhbHVlKG15LnByb3RvdHlwZS5pdGVtRGF0YVsnaXRlbV8nICsgaXRlbV0uYXR0cmlidXRlcywgJ2Jhc2hfc3R1bicsIDApLFxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICdjb3VudCc6IDEsXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgJ2RhbWFnZVR5cGUnOiAnbWFnaWMnLFxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICdkaXNwbGF5bmFtZSc6ICdNaW5pLUJhc2gnIC8vbXkucHJvdG90eXBlLml0ZW1EYXRhWydpdGVtXycgKyBpdGVtXS5kaXNwbGF5bmFtZVxuICAgICAgICAgICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgICAgICAgIGVsc2Uge1xuICAgICAgICAgICAgICAgICAgICAgICAgc291cmNlc1tpdGVtXS5jb3VudCArPSAxO1xuICAgICAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgICAgYnJlYWs7XG4gICAgICAgICAgICAgICAgY2FzZSAnYWJ5c3NhbF9ibGFkZSc6XG4gICAgICAgICAgICAgICAgY2FzZSAnYmFzaGVyJzpcbiAgICAgICAgICAgICAgICAgICAgaWYgKCFzb3VyY2VzLmhhc093blByb3BlcnR5KCdiYXNoJykpIHtcbiAgICAgICAgICAgICAgICAgICAgICAgIHNvdXJjZXNbJ2Jhc2gnXSA9IHtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAnaXRlbSc6IGl0ZW0sXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgJ2NoYW5jZSc6IHNlbGYuZ2V0SXRlbUF0dHJpYnV0ZVZhbHVlKG15LnByb3RvdHlwZS5pdGVtRGF0YVsnaXRlbV8nICsgaXRlbV0uYXR0cmlidXRlcywgKGF0dGFja3R5cGUgPT0gJ0RPVEFfVU5JVF9DQVBfTUVMRUVfQVRUQUNLJykgPydiYXNoX2NoYW5jZV9tZWxlZScgOiAnYmFzaF9jaGFuY2VfcmFuZ2VkJywgMCkgLyAxMDAsXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgJ2RhbWFnZSc6IHNlbGYuZ2V0SXRlbUF0dHJpYnV0ZVZhbHVlKG15LnByb3RvdHlwZS5pdGVtRGF0YVsnaXRlbV8nICsgaXRlbV0uYXR0cmlidXRlcywgJ2JvbnVzX2NoYW5jZV9kYW1hZ2UnLCAwKSxcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAnZHVyYXRpb24nOiBzZWxmLmdldEl0ZW1BdHRyaWJ1dGVWYWx1ZShteS5wcm90b3R5cGUuaXRlbURhdGFbJ2l0ZW1fJyArIGl0ZW1dLmF0dHJpYnV0ZXMsICdiYXNoX2R1cmF0aW9uJywgMCksXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgJ2NvdW50JzogMSxcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAnZGFtYWdlVHlwZSc6ICdwaHlzaWNhbCcsXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgJ2Rpc3BsYXluYW1lJzogJ0Jhc2gnIC8vbXkucHJvdG90eXBlLml0ZW1EYXRhWydpdGVtXycgKyBpdGVtXS5kaXNwbGF5bmFtZVxuICAgICAgICAgICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgICAgICAgIGVsc2Uge1xuICAgICAgICAgICAgICAgICAgICAgICAgLy9zb3VyY2VzW2l0ZW1dLmNvdW50ICs9IDE7XG4gICAgICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgICBicmVhaztcbiAgICAgICAgICAgIH1cblxuICAgICAgICB9XG4gICAgICAgIHJldHVybiBzb3VyY2VzO1xuICAgIH07XG4gICAgXG4gICAgc2VsZi5nZXRPcmJQcm9jU291cmNlID0gZnVuY3Rpb24gKCkge1xuICAgICAgICB2YXIgc291cmNlcyA9IHt9O1xuICAgICAgICBmb3IgKHZhciBpID0gMDsgaSA8IHNlbGYuaXRlbXMoKS5sZW5ndGg7IGkrKykge1xuICAgICAgICAgICAgdmFyIGl0ZW0gPSBzZWxmLml0ZW1zKClbaV0uaXRlbTtcbiAgICAgICAgICAgIHZhciBpc0FjdGl2ZSA9IHNlbGYuYWN0aXZlSXRlbXMuaW5kZXhPZihzZWxmLml0ZW1zKClbaV0pID49IDAgPyB0cnVlIDogZmFsc2U7XG4gICAgICAgICAgICBpZiAoIXNlbGYuaXRlbXMoKVtpXS5lbmFibGVkKCkpIGNvbnRpbnVlO1xuICAgICAgICAgICAgc3dpdGNoIChpdGVtKSB7XG4gICAgICAgICAgICAgICAgY2FzZSAnbWFlbHN0cm9tJzpcbiAgICAgICAgICAgICAgICBjYXNlICdtam9sbG5pcic6XG4gICAgICAgICAgICAgICAgICAgIGlmIChzb3VyY2VzW2l0ZW1dID09IHVuZGVmaW5lZCkge1xuICAgICAgICAgICAgICAgICAgICAgICAgc291cmNlc1tpdGVtXSA9IHtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAnY2hhbmNlJzogc2VsZi5nZXRJdGVtQXR0cmlidXRlVmFsdWUobXkucHJvdG90eXBlLml0ZW1EYXRhWydpdGVtXycgKyBpdGVtXS5hdHRyaWJ1dGVzLCAnY2hhaW5fY2hhbmNlJywgMCkgLyAxMDAsXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgJ2RhbWFnZSc6IHNlbGYuZ2V0SXRlbUF0dHJpYnV0ZVZhbHVlKG15LnByb3RvdHlwZS5pdGVtRGF0YVsnaXRlbV8nICsgaXRlbV0uYXR0cmlidXRlcywgJ2NoYWluX2RhbWFnZScsIDApLFxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICdjb3VudCc6IDEsXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgJ2RhbWFnZVR5cGUnOiAnbWFnaWMnLFxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICdkaXNwbGF5bmFtZSc6IG15LnByb3RvdHlwZS5pdGVtRGF0YVsnaXRlbV8nICsgaXRlbV0uZGlzcGxheW5hbWVcbiAgICAgICAgICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICAgICAgICBlbHNlIHtcbiAgICAgICAgICAgICAgICAgICAgICAgIHNvdXJjZXNbaXRlbV0uY291bnQgKz0gMTtcbiAgICAgICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICAgIGJyZWFrO1xuICAgICAgICAgICAgfVxuXG4gICAgICAgIH1cbiAgICAgICAgcmV0dXJuIHNvdXJjZXM7XG4gICAgfTtcblxuICAgIHNlbGYuZ2V0T3JiU291cmNlID0gZnVuY3Rpb24gKCkge1xuICAgICAgICB2YXIgc291cmNlcyA9IHt9O1xuICAgICAgICBmb3IgKHZhciBpID0gMDsgaSA8IHNlbGYuaXRlbXMoKS5sZW5ndGg7IGkrKykge1xuICAgICAgICAgICAgdmFyIGl0ZW0gPSBzZWxmLml0ZW1zKClbaV0uaXRlbTtcbiAgICAgICAgICAgIHZhciBpc0FjdGl2ZSA9IHNlbGYuYWN0aXZlSXRlbXMuaW5kZXhPZihzZWxmLml0ZW1zKClbaV0pID49IDAgPyB0cnVlIDogZmFsc2U7XG4gICAgICAgICAgICBpZiAoIXNlbGYuaXRlbXMoKVtpXS5lbmFibGVkKCkpIGNvbnRpbnVlO1xuICAgICAgICAgICAgc3dpdGNoIChpdGVtKSB7XG4gICAgICAgICAgICAgICAgY2FzZSAnZGlmZnVzYWxfYmxhZGUnOlxuICAgICAgICAgICAgICAgICAgICBpZiAoc291cmNlc1tpdGVtXSA9PSB1bmRlZmluZWQpIHtcbiAgICAgICAgICAgICAgICAgICAgICAgIHNvdXJjZXNbaXRlbV0gPSB7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgJ2NoYW5jZSc6IDEsXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgJ2RhbWFnZSc6IHNlbGYuZ2V0SXRlbUF0dHJpYnV0ZVZhbHVlKG15LnByb3RvdHlwZS5pdGVtRGF0YVsnaXRlbV8nICsgaXRlbV0uYXR0cmlidXRlcywgJ2ZlZWRiYWNrX21hbmFfYnVybicsIHNlbGYuaXRlbXMoKVtpXS5zaXplKSxcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAnY291bnQnOiAxLFxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICdkYW1hZ2VUeXBlJzogJ3BoeXNpY2FsJyxcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAnZGlzcGxheW5hbWUnOiBteS5wcm90b3R5cGUuaXRlbURhdGFbJ2l0ZW1fJyArIGl0ZW1dLmRpc3BsYXluYW1lXG4gICAgICAgICAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgICAgICAgZWxzZSB7XG4gICAgICAgICAgICAgICAgICAgICAgICBzb3VyY2VzW2l0ZW1dLmNvdW50ICs9IDE7XG4gICAgICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgICBicmVhaztcbiAgICAgICAgICAgIH1cblxuICAgICAgICB9XG4gICAgICAgIHJldHVybiBzb3VyY2VzO1xuICAgIH07XG4gICAgXG4gICAgc2VsZi5nZXRIZWFsdGggPSBmdW5jdGlvbiAoKSB7XG4gICAgICAgIHZhciB0b3RhbEF0dHJpYnV0ZSA9IDA7XG4gICAgICAgIGZvciAodmFyIGkgPSAwOyBpIDwgc2VsZi5pdGVtcygpLmxlbmd0aDsgaSsrKSB7XG4gICAgICAgICAgICB2YXIgaXRlbSA9IHNlbGYuaXRlbXMoKVtpXS5pdGVtO1xuICAgICAgICAgICAgaWYgKCFzZWxmLml0ZW1zKClbaV0uZW5hYmxlZCgpKSBjb250aW51ZTtcbiAgICAgICAgICAgIGZvciAodmFyIGogPSAwOyBqIDwgbXkucHJvdG90eXBlLml0ZW1EYXRhWydpdGVtXycgKyBpdGVtXS5hdHRyaWJ1dGVzLmxlbmd0aDsgaisrKSB7XG4gICAgICAgICAgICAgICAgdmFyIGF0dHJpYnV0ZSA9IG15LnByb3RvdHlwZS5pdGVtRGF0YVsnaXRlbV8nICsgaXRlbV0uYXR0cmlidXRlc1tqXTtcbiAgICAgICAgICAgICAgICBzd2l0Y2goYXR0cmlidXRlLm5hbWUpIHtcbiAgICAgICAgICAgICAgICAgICAgY2FzZSAnYm9udXNfaGVhbHRoJzpcbiAgICAgICAgICAgICAgICAgICAgICAgIHRvdGFsQXR0cmlidXRlICs9IHBhcnNlSW50KGF0dHJpYnV0ZS52YWx1ZVswXSk7XG4gICAgICAgICAgICAgICAgICAgIGJyZWFrO1xuICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgIH1cbiAgICAgICAgfVxuICAgICAgICByZXR1cm4gdG90YWxBdHRyaWJ1dGU7XG4gICAgfTtcbiAgICBzZWxmLmdldEhlYWx0aFJlZ2VuID0gZnVuY3Rpb24gKCkge1xuICAgICAgICB2YXIgdG90YWxBdHRyaWJ1dGUgPSAwO1xuICAgICAgICBmb3IgKHZhciBpID0gMDsgaSA8IHNlbGYuaXRlbXMoKS5sZW5ndGg7IGkrKykge1xuICAgICAgICAgICAgdmFyIGl0ZW0gPSBzZWxmLml0ZW1zKClbaV0uaXRlbTtcbiAgICAgICAgICAgIHZhciBpc0FjdGl2ZSA9IHNlbGYuYWN0aXZlSXRlbXMuaW5kZXhPZihzZWxmLml0ZW1zKClbaV0pID49IDAgPyB0cnVlIDogZmFsc2U7XG4gICAgICAgICAgICBpZiAoIXNlbGYuaXRlbXMoKVtpXS5lbmFibGVkKCkpIGNvbnRpbnVlO1xuICAgICAgICAgICAgZm9yICh2YXIgaiA9IDA7IGogPCBteS5wcm90b3R5cGUuaXRlbURhdGFbJ2l0ZW1fJyArIGl0ZW1dLmF0dHJpYnV0ZXMubGVuZ3RoOyBqKyspIHtcbiAgICAgICAgICAgICAgICB2YXIgYXR0cmlidXRlID0gbXkucHJvdG90eXBlLml0ZW1EYXRhWydpdGVtXycgKyBpdGVtXS5hdHRyaWJ1dGVzW2pdO1xuICAgICAgICAgICAgICAgIHN3aXRjaChhdHRyaWJ1dGUubmFtZSkge1xuICAgICAgICAgICAgICAgICAgICBjYXNlICdoZWFsdGhfcmVnZW4nOlxuICAgICAgICAgICAgICAgICAgICBjYXNlICdib251c19yZWdlbic6XG4gICAgICAgICAgICAgICAgICAgICAgICB0b3RhbEF0dHJpYnV0ZSArPSBwYXJzZUludChhdHRyaWJ1dGUudmFsdWVbMF0pO1xuICAgICAgICAgICAgICAgICAgICBicmVhaztcbiAgICAgICAgICAgICAgICAgICAgY2FzZSAnYm9udXNfaGVhbHRoX3JlZ2VuJzpcbiAgICAgICAgICAgICAgICAgICAgICAgIGlmIChpdGVtID09ICd0cmFucXVpbF9ib290cycgJiYgIWlzQWN0aXZlKSB7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgdG90YWxBdHRyaWJ1dGUgKz0gcGFyc2VJbnQoYXR0cmlidXRlLnZhbHVlWzBdKTtcbiAgICAgICAgICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgICAgICAgICAgIGVsc2UgaWYgKGl0ZW0gIT0gJ3RyYW5xdWlsX2Jvb3RzJykge1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgIHRvdGFsQXR0cmlidXRlICs9IHBhcnNlSW50KGF0dHJpYnV0ZS52YWx1ZVswXSk7XG4gICAgICAgICAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgICAgICAgIGJyZWFrO1xuICAgICAgICAgICAgICAgICAgICBjYXNlICdocF9yZWdlbic6XG4gICAgICAgICAgICAgICAgICAgICAgICB0b3RhbEF0dHJpYnV0ZSArPSBwYXJzZUludChhdHRyaWJ1dGUudmFsdWVbMF0pO1xuICAgICAgICAgICAgICAgICAgICBicmVhaztcbiAgICAgICAgICAgICAgICAgICAgY2FzZSAnaGVhbHRoX3JlZ2VuX3JhdGUnOlxuICAgICAgICAgICAgICAgICAgICAgICAgaWYgKGl0ZW0gPT0gJ2hlYXJ0JyAmJiBpc0FjdGl2ZSkge1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgIHRvdGFsQXR0cmlidXRlICs9IChwYXJzZUludChhdHRyaWJ1dGUudmFsdWVbMF0pIC8gMTAwKSAqIHNlbGYuaGVyby5oZWFsdGgoKTtcbiAgICAgICAgICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgICAgICAgYnJlYWs7XG4gICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgfVxuICAgICAgICB9XG4gICAgICAgIHJldHVybiB0b3RhbEF0dHJpYnV0ZTtcbiAgICB9O1xuICAgIHNlbGYuZ2V0SGVhbHRoUmVnZW5BdXJhID0gZnVuY3Rpb24gKGUpIHtcbiAgICAgICAgdmFyIHRvdGFsQXR0cmlidXRlID0gMCxcbiAgICAgICAgICAgIGV4Y2x1ZGVMaXN0ID0gZSB8fCBbXTtcbiAgICAgICAgZm9yICh2YXIgaSA9IDA7IGkgPCBzZWxmLml0ZW1zKCkubGVuZ3RoOyBpKyspIHtcbiAgICAgICAgICAgIHZhciBpdGVtID0gc2VsZi5pdGVtcygpW2ldLml0ZW07XG4gICAgICAgICAgICB2YXIgaXNBY3RpdmUgPSBzZWxmLmFjdGl2ZUl0ZW1zLmluZGV4T2Yoc2VsZi5pdGVtcygpW2ldKSA+PSAwID8gdHJ1ZSA6IGZhbHNlO1xuICAgICAgICAgICAgaWYgKCFzZWxmLml0ZW1zKClbaV0uZW5hYmxlZCgpKSBjb250aW51ZTtcbiAgICAgICAgICAgIGZvciAodmFyIGogPSAwOyBqIDwgbXkucHJvdG90eXBlLml0ZW1EYXRhWydpdGVtXycgKyBpdGVtXS5hdHRyaWJ1dGVzLmxlbmd0aDsgaisrKSB7XG4gICAgICAgICAgICAgICAgdmFyIGF0dHJpYnV0ZSA9IG15LnByb3RvdHlwZS5pdGVtRGF0YVsnaXRlbV8nICsgaXRlbV0uYXR0cmlidXRlc1tqXTtcbiAgICAgICAgICAgICAgICBpZiAoZXhjbHVkZUxpc3QuaW5kZXhPZihpdGVtICsgYXR0cmlidXRlLm5hbWUpID4gLTEpIGNvbnRpbnVlO1xuICAgICAgICAgICAgICAgIHN3aXRjaChhdHRyaWJ1dGUubmFtZSkge1xuICAgICAgICAgICAgICAgICAgICBjYXNlICdhdXJhX2hlYWx0aF9yZWdlbic6XG4gICAgICAgICAgICAgICAgICAgICAgICB0b3RhbEF0dHJpYnV0ZSArPSBwYXJzZUludChhdHRyaWJ1dGUudmFsdWVbMF0pO1xuICAgICAgICAgICAgICAgICAgICAgICAgZXhjbHVkZUxpc3QucHVzaChpdGVtICsgYXR0cmlidXRlLm5hbWUpO1xuICAgICAgICAgICAgICAgICAgICBicmVhaztcbiAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICB9XG4gICAgICAgIH1cbiAgICAgICAgcmV0dXJuIHt2YWx1ZTogdG90YWxBdHRyaWJ1dGUsIGV4Y2x1ZGVMaXN0OiBleGNsdWRlTGlzdH07XG4gICAgfTtcbiAgICBcbiAgICBzZWxmLmdldE1hbmEgPSBmdW5jdGlvbiAoKSB7XG4gICAgICAgIHZhciB0b3RhbEF0dHJpYnV0ZSA9IDA7XG4gICAgICAgIGZvciAodmFyIGkgPSAwOyBpIDwgc2VsZi5pdGVtcygpLmxlbmd0aDsgaSsrKSB7XG4gICAgICAgICAgICB2YXIgaXRlbSA9IHNlbGYuaXRlbXMoKVtpXS5pdGVtO1xuICAgICAgICAgICAgaWYgKCFzZWxmLml0ZW1zKClbaV0uZW5hYmxlZCgpKSBjb250aW51ZTtcbiAgICAgICAgICAgIGZvciAodmFyIGogPSAwOyBqIDwgbXkucHJvdG90eXBlLml0ZW1EYXRhWydpdGVtXycgKyBpdGVtXS5hdHRyaWJ1dGVzLmxlbmd0aDsgaisrKSB7XG4gICAgICAgICAgICAgICAgdmFyIGF0dHJpYnV0ZSA9IG15LnByb3RvdHlwZS5pdGVtRGF0YVsnaXRlbV8nICsgaXRlbV0uYXR0cmlidXRlc1tqXTtcbiAgICAgICAgICAgICAgICBzd2l0Y2goYXR0cmlidXRlLm5hbWUpIHtcbiAgICAgICAgICAgICAgICAgICAgY2FzZSAnYm9udXNfbWFuYSc6XG4gICAgICAgICAgICAgICAgICAgICAgICB0b3RhbEF0dHJpYnV0ZSArPSBwYXJzZUludChhdHRyaWJ1dGUudmFsdWVbMF0pO1xuICAgICAgICAgICAgICAgICAgICBicmVhaztcbiAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICB9XG4gICAgICAgIH1cbiAgICAgICAgcmV0dXJuIHRvdGFsQXR0cmlidXRlO1xuICAgIH07XG4gICAgXG4gICAgc2VsZi5nZXRNYW5hUmVnZW4gPSBmdW5jdGlvbiAoKSB7XG4gICAgICAgIHZhciB0b3RhbEF0dHJpYnV0ZSA9IDA7XG4gICAgICAgIGZvciAodmFyIGkgPSAwOyBpIDwgc2VsZi5pdGVtcygpLmxlbmd0aDsgaSsrKSB7XG4gICAgICAgICAgICB2YXIgaXRlbSA9IHNlbGYuaXRlbXMoKVtpXS5pdGVtO1xuICAgICAgICAgICAgaWYgKCFzZWxmLml0ZW1zKClbaV0uZW5hYmxlZCgpKSBjb250aW51ZTtcbiAgICAgICAgICAgIGZvciAodmFyIGogPSAwOyBqIDwgbXkucHJvdG90eXBlLml0ZW1EYXRhWydpdGVtXycgKyBpdGVtXS5hdHRyaWJ1dGVzLmxlbmd0aDsgaisrKSB7XG4gICAgICAgICAgICAgICAgdmFyIGF0dHJpYnV0ZSA9IG15LnByb3RvdHlwZS5pdGVtRGF0YVsnaXRlbV8nICsgaXRlbV0uYXR0cmlidXRlc1tqXTtcbiAgICAgICAgICAgICAgICBzd2l0Y2goYXR0cmlidXRlLm5hbWUpIHtcbiAgICAgICAgICAgICAgICAgICAgY2FzZSAnYXVyYV9tYW5hX3JlZ2VuJzpcbiAgICAgICAgICAgICAgICAgICAgY2FzZSAnbWFuYV9yZWdlbl9hdXJhJzpcbiAgICAgICAgICAgICAgICAgICAgICAgIHRvdGFsQXR0cmlidXRlICs9IHBhcnNlRmxvYXQoYXR0cmlidXRlLnZhbHVlWzBdKTtcbiAgICAgICAgICAgICAgICAgICAgYnJlYWs7XG4gICAgICAgICAgICAgICAgICAgIGNhc2UgJ21hbmFfcmVnZW4nOlxuICAgICAgICAgICAgICAgICAgICAgICAgaWYgKGl0ZW0gPT0gJ2luZnVzZWRfcmFpbmRyb3AnKSB0b3RhbEF0dHJpYnV0ZSArPSBwYXJzZUZsb2F0KGF0dHJpYnV0ZS52YWx1ZVswXSk7XG4gICAgICAgICAgICAgICAgICAgIGJyZWFrO1xuICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgIH1cbiAgICAgICAgfVxuICAgICAgICByZXR1cm4gdG90YWxBdHRyaWJ1dGU7ICAgIFxuICAgIH07XG4gICAgc2VsZi5nZXRNYW5hUmVnZW5QZXJjZW50ID0gZnVuY3Rpb24gKCkge1xuICAgICAgICB2YXIgdG90YWxBdHRyaWJ1dGUgPSAwO1xuICAgICAgICBmb3IgKHZhciBpID0gMDsgaSA8IHNlbGYuaXRlbXMoKS5sZW5ndGg7IGkrKykge1xuICAgICAgICAgICAgdmFyIGl0ZW0gPSBzZWxmLml0ZW1zKClbaV0uaXRlbTtcbiAgICAgICAgICAgIGlmICghc2VsZi5pdGVtcygpW2ldLmVuYWJsZWQoKSkgY29udGludWU7XG4gICAgICAgICAgICBmb3IgKHZhciBqID0gMDsgaiA8IG15LnByb3RvdHlwZS5pdGVtRGF0YVsnaXRlbV8nICsgaXRlbV0uYXR0cmlidXRlcy5sZW5ndGg7IGorKykge1xuICAgICAgICAgICAgICAgIHZhciBhdHRyaWJ1dGUgPSBteS5wcm90b3R5cGUuaXRlbURhdGFbJ2l0ZW1fJyArIGl0ZW1dLmF0dHJpYnV0ZXNbal07XG4gICAgICAgICAgICAgICAgc3dpdGNoKGF0dHJpYnV0ZS5uYW1lKSB7XG4gICAgICAgICAgICAgICAgICAgIGNhc2UgJ2JvbnVzX21hbmFfcmVnZW4nOlxuICAgICAgICAgICAgICAgICAgICBjYXNlICdtYW5hX3JlZ2VuJzpcbiAgICAgICAgICAgICAgICAgICAgY2FzZSAnYm9udXNfbWFuYV9yZWdlbl9wY3QnOlxuICAgICAgICAgICAgICAgICAgICAgICAgaWYgKGl0ZW0gIT0gJ2luZnVzZWRfcmFpbmRyb3AnKSB0b3RhbEF0dHJpYnV0ZSArPSBwYXJzZUZsb2F0KGF0dHJpYnV0ZS52YWx1ZVswXSk7XG4gICAgICAgICAgICAgICAgICAgIGJyZWFrO1xuICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgIH1cbiAgICAgICAgfVxuICAgICAgICByZXR1cm4gdG90YWxBdHRyaWJ1dGUgLyAxMDA7ICAgIFxuICAgIH07XG4gICAgc2VsZi5nZXRNYW5hUmVnZW5CbG9vZHN0b25lID0gZnVuY3Rpb24gKCkge1xuICAgICAgICBmb3IgKHZhciBpID0gMDsgaSA8IHNlbGYuaXRlbXMoKS5sZW5ndGg7IGkrKykge1xuICAgICAgICAgICAgdmFyIGl0ZW0gPSBzZWxmLml0ZW1zKClbaV0uaXRlbTtcbiAgICAgICAgICAgIGlmICghc2VsZi5pdGVtcygpW2ldLmVuYWJsZWQoKSkgY29udGludWU7XG4gICAgICAgICAgICBpZiAoaXRlbS5pbmRleE9mKCdibG9vZHN0b25lJykgIT0gLTEpIHtcbiAgICAgICAgICAgICAgICByZXR1cm4gcGFyc2VJbnQoc2VsZi5pdGVtcygpW2ldLnNpemUpO1xuICAgICAgICAgICAgfVxuICAgICAgICB9XG4gICAgICAgIHJldHVybiAwO1xuICAgIH07XG4gICAgXG4gICAgc2VsZi5nZXRBcm1vciA9IGZ1bmN0aW9uICgpIHtcbiAgICAgICAgdmFyIHRvdGFsQXR0cmlidXRlID0gMDtcbiAgICAgICAgZm9yICh2YXIgaSA9IDA7IGkgPCBzZWxmLml0ZW1zKCkubGVuZ3RoOyBpKyspIHtcbiAgICAgICAgICAgIHZhciBpdGVtID0gc2VsZi5pdGVtcygpW2ldLml0ZW07XG4gICAgICAgICAgICB2YXIgaXNBY3RpdmUgPSBzZWxmLmFjdGl2ZUl0ZW1zLmluZGV4T2Yoc2VsZi5pdGVtcygpW2ldKSA+PSAwID8gdHJ1ZSA6IGZhbHNlO1xuICAgICAgICAgICAgaWYgKCFzZWxmLml0ZW1zKClbaV0uZW5hYmxlZCgpKSBjb250aW51ZTtcbiAgICAgICAgICAgIGZvciAodmFyIGogPSAwOyBqIDwgbXkucHJvdG90eXBlLml0ZW1EYXRhWydpdGVtXycgKyBpdGVtXS5hdHRyaWJ1dGVzLmxlbmd0aDsgaisrKSB7XG4gICAgICAgICAgICAgICAgdmFyIGF0dHJpYnV0ZSA9IG15LnByb3RvdHlwZS5pdGVtRGF0YVsnaXRlbV8nICsgaXRlbV0uYXR0cmlidXRlc1tqXTtcbiAgICAgICAgICAgICAgICBzd2l0Y2goYXR0cmlidXRlLm5hbWUpIHtcbiAgICAgICAgICAgICAgICAgICAgY2FzZSAnYm9udXNfYXJtb3InOlxuICAgICAgICAgICAgICAgICAgICAgICAgaWYgKCFpc0FjdGl2ZSB8fCBpdGVtICE9ICdtZWRhbGxpb25fb2ZfY291cmFnZScpIHsgdG90YWxBdHRyaWJ1dGUgKz0gcGFyc2VJbnQoYXR0cmlidXRlLnZhbHVlWzBdKTsgfTtcbiAgICAgICAgICAgICAgICAgICAgYnJlYWs7XG4gICAgICAgICAgICAgICAgICAgIGNhc2UgJ3VuaG9seV9ib251c19hcm1vcic6XG4gICAgICAgICAgICAgICAgICAgICAgICBpZiAoaXNBY3RpdmUgJiYgaXRlbSA9PSAnYXJtbGV0JykgeyB0b3RhbEF0dHJpYnV0ZSArPSBwYXJzZUludChhdHRyaWJ1dGUudmFsdWVbMF0pOyB9O1xuICAgICAgICAgICAgICAgICAgICBicmVhaztcbiAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICB9XG4gICAgICAgIH1cbiAgICAgICAgcmV0dXJuIHRvdGFsQXR0cmlidXRlO1xuICAgIH07XG4gICAgXG4gICAgc2VsZi5nZXRBcm1vckF1cmEgPSBmdW5jdGlvbiAoYUxpc3QpIHtcbiAgICAgICAgdmFyIHRvdGFsQXR0cmlidXRlID0gMCxcbiAgICAgICAgICAgIGF0dHJpYnV0ZUxpc3QgPSBhTGlzdCB8fCBbXTtcbiAgICAgICAgZm9yICh2YXIgaSA9IDA7IGkgPCBzZWxmLml0ZW1zKCkubGVuZ3RoOyBpKyspIHtcbiAgICAgICAgICAgIHZhciBpdGVtID0gc2VsZi5pdGVtcygpW2ldLml0ZW07XG4gICAgICAgICAgICB2YXIgaXNBY3RpdmUgPSBzZWxmLmFjdGl2ZUl0ZW1zLmluZGV4T2Yoc2VsZi5pdGVtcygpW2ldKSA+PSAwID8gdHJ1ZSA6IGZhbHNlO1xuICAgICAgICAgICAgaWYgKCFzZWxmLml0ZW1zKClbaV0uZW5hYmxlZCgpKSBjb250aW51ZTtcbiAgICAgICAgICAgIGZvciAodmFyIGogPSAwO2ogPCBteS5wcm90b3R5cGUuaXRlbURhdGFbJ2l0ZW1fJyArIGl0ZW1dLmF0dHJpYnV0ZXMubGVuZ3RoOyBqKyspIHtcbiAgICAgICAgICAgICAgICB2YXIgYXR0cmlidXRlID0gbXkucHJvdG90eXBlLml0ZW1EYXRhWydpdGVtXycgKyBpdGVtXS5hdHRyaWJ1dGVzW2pdO1xuICAgICAgICAgICAgICAgIGlmIChhdHRyaWJ1dGVMaXN0LmZpbmQoZnVuY3Rpb24gKGEpIHsgcmV0dXJuIGF0dHJpYnV0ZS5uYW1lID09IGEubmFtZTsgfSkpIGNvbnRpbnVlO1xuICAgICAgICAgICAgICAgIHN3aXRjaChhdHRyaWJ1dGUubmFtZSkge1xuICAgICAgICAgICAgICAgICAgICAvLyBidWNrbGVyXG4gICAgICAgICAgICAgICAgICAgIGNhc2UgJ2JvbnVzX2FvZV9hcm1vcic6XG4gICAgICAgICAgICAgICAgICAgICAgICBpZiAoaXNBY3RpdmUpIHtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICBhdHRyaWJ1dGVMaXN0LnB1c2goeyduYW1lJzphdHRyaWJ1dGUubmFtZSwgJ3ZhbHVlJzogcGFyc2VJbnQoYXR0cmlidXRlLnZhbHVlWzBdKX0pO1xuICAgICAgICAgICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICAgICAgICBicmVhaztcbiAgICAgICAgICAgICAgICAgICAgLy8gYXNzYXVsdFxuICAgICAgICAgICAgICAgICAgICBjYXNlICdhdXJhX3Bvc2l0aXZlX2FybW9yJzpcbiAgICAgICAgICAgICAgICAgICAgICAgIGF0dHJpYnV0ZUxpc3QucHVzaCh7J25hbWUnOmF0dHJpYnV0ZS5uYW1lLCAndmFsdWUnOiBwYXJzZUludChhdHRyaWJ1dGUudmFsdWVbMF0pfSk7XG4gICAgICAgICAgICAgICAgICAgIGJyZWFrO1xuICAgICAgICAgICAgICAgICAgICAvLyByaW5nX29mX2FxdWlsYSxyaW5nX29mX2Jhc2lsaXVzXG4gICAgICAgICAgICAgICAgICAgIGNhc2UgJ2F1cmFfYm9udXNfYXJtb3InOlxuICAgICAgICAgICAgICAgICAgICAgICAgaWYgKGlzQWN0aXZlKSB7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgYXR0cmlidXRlTGlzdC5wdXNoKHsnbmFtZSc6YXR0cmlidXRlLm5hbWUsICd2YWx1ZSc6IHBhcnNlSW50KGF0dHJpYnV0ZS52YWx1ZVswXSl9KTtcbiAgICAgICAgICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgICAgICAgYnJlYWs7XG4gICAgICAgICAgICAgICAgICAgIC8vIHZsYWRtaXJcbiAgICAgICAgICAgICAgICAgICAgY2FzZSAnYXJtb3JfYXVyYSc6XG4gICAgICAgICAgICAgICAgICAgICAgICBhdHRyaWJ1dGVMaXN0LnB1c2goeyduYW1lJzphdHRyaWJ1dGUubmFtZSwgJ3ZhbHVlJzogcGFyc2VJbnQoYXR0cmlidXRlLnZhbHVlWzBdKX0pO1xuICAgICAgICAgICAgICAgICAgICBicmVhaztcbiAgICAgICAgICAgICAgICAgICAgLy8gbWVrYW5zbVxuICAgICAgICAgICAgICAgICAgICBjYXNlICdoZWFsX2JvbnVzX2FybW9yJzpcbiAgICAgICAgICAgICAgICAgICAgICAgIGlmIChpc0FjdGl2ZSkge1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgIGF0dHJpYnV0ZUxpc3QucHVzaCh7J25hbWUnOmF0dHJpYnV0ZS5uYW1lLCAndmFsdWUnOiBwYXJzZUludChhdHRyaWJ1dGUudmFsdWVbMF0pfSk7XG4gICAgICAgICAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgICAgICAgIGJyZWFrO1xuICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgIH1cbiAgICAgICAgfVxuICAgICAgICAvLyByZW1vdmUgYnVja2xlciBpZiB0aGVyZSBpcyBhIG1la2Fuc21cbiAgICAgICAgaWYgKGF0dHJpYnV0ZUxpc3QuZmluZChmdW5jdGlvbiAoYXR0cmlidXRlKSB7IHJldHVybiBhdHRyaWJ1dGUubmFtZSA9PSAnaGVhbF9ib251c19hcm1vcic7IH0pKSB7XG4gICAgICAgICAgICBhdHRyaWJ1dGVMaXN0ID0gYXR0cmlidXRlTGlzdC5maWx0ZXIoZnVuY3Rpb24gKGF0dHJpYnV0ZSkge1xuICAgICAgICAgICAgICAgIHJldHVybiBhdHRyaWJ1dGUubmFtZSAhPT0gJ2JvbnVzX2FvZV9hcm1vcic7XG4gICAgICAgICAgICB9KTtcbiAgICAgICAgfVxuICAgICAgICAvLyByZW1vdmUgcmluZ19vZl9hcXVpbGEscmluZ19vZl9iYXNpbGl1cyBpZiB0aGVyZSBpcyBhIHZsYWRtaXJcbiAgICAgICAgaWYgKGF0dHJpYnV0ZUxpc3QuZmluZChmdW5jdGlvbiAoYXR0cmlidXRlKSB7IHJldHVybiBhdHRyaWJ1dGUubmFtZSA9PSAnYXJtb3JfYXVyYSc7IH0pKSB7XG4gICAgICAgICAgICBhdHRyaWJ1dGVMaXN0ID0gYXR0cmlidXRlTGlzdC5maWx0ZXIoZnVuY3Rpb24gKGF0dHJpYnV0ZSkge1xuICAgICAgICAgICAgICAgIHJldHVybiBhdHRyaWJ1dGUubmFtZSAhPT0gJ2F1cmFfYm9udXNfYXJtb3InO1xuICAgICAgICAgICAgfSk7XG4gICAgICAgIH1cbiAgICAgICAgXG4gICAgICAgIHRvdGFsQXR0cmlidXRlID0gYXR0cmlidXRlTGlzdC5yZWR1Y2UoZnVuY3Rpb24gKG1lbW8sIGF0dHJpYnV0ZSkge1xuICAgICAgICAgICAgcmV0dXJuIG1lbW8gKz0gYXR0cmlidXRlLnZhbHVlO1xuICAgICAgICB9LCAwKTtcbiAgICAgICAgcmV0dXJuIHt2YWx1ZTogdG90YWxBdHRyaWJ1dGUsIGF0dHJpYnV0ZXM6IGF0dHJpYnV0ZUxpc3R9O1xuICAgIH07XG4gICAgc2VsZi5nZXRBcm1vclJlZHVjdGlvbiA9IGZ1bmN0aW9uIChlKSB7XG4gICAgICAgIHZhciB0b3RhbEF0dHJpYnV0ZSA9IDAsXG4gICAgICAgICAgICBleGNsdWRlTGlzdCA9IGUgfHwgW107XG4gICAgICAgIGZvciAodmFyIGkgPSAwOyBpIDwgc2VsZi5pdGVtcygpLmxlbmd0aDsgaSsrKSB7XG4gICAgICAgICAgICB2YXIgaXRlbSA9IHNlbGYuaXRlbXMoKVtpXS5pdGVtO1xuICAgICAgICAgICAgdmFyIGlzQWN0aXZlID0gc2VsZi5hY3RpdmVJdGVtcy5pbmRleE9mKHNlbGYuaXRlbXMoKVtpXSkgPj0gMCA/IHRydWUgOiBmYWxzZTtcbiAgICAgICAgICAgIGlmICghc2VsZi5pdGVtcygpW2ldLmVuYWJsZWQoKSkgY29udGludWU7XG4gICAgICAgICAgICBmb3IgKHZhciBqID0gMDsgaiA8IG15LnByb3RvdHlwZS5pdGVtRGF0YVsnaXRlbV8nICsgaXRlbV0uYXR0cmlidXRlcy5sZW5ndGg7IGorKykge1xuICAgICAgICAgICAgICAgIHZhciBhdHRyaWJ1dGUgPSBteS5wcm90b3R5cGUuaXRlbURhdGFbJ2l0ZW1fJyArIGl0ZW1dLmF0dHJpYnV0ZXNbal07XG4gICAgICAgICAgICAgICAgaWYgKGV4Y2x1ZGVMaXN0LmluZGV4T2YoYXR0cmlidXRlLm5hbWUpID4gLTEgfHwgZXhjbHVkZUxpc3QuaW5kZXhPZihpdGVtICsgJ18nICsgYXR0cmlidXRlLm5hbWUpID4gLTEpIGNvbnRpbnVlO1xuICAgICAgICAgICAgICAgIHN3aXRjaChhdHRyaWJ1dGUubmFtZSkge1xuICAgICAgICAgICAgICAgICAgICBjYXNlICdhcm1vcl9yZWR1Y3Rpb24nOlxuICAgICAgICAgICAgICAgICAgICAgICAgdG90YWxBdHRyaWJ1dGUgKz0gcGFyc2VJbnQoYXR0cmlidXRlLnZhbHVlWzBdKTtcbiAgICAgICAgICAgICAgICAgICAgICAgIGV4Y2x1ZGVMaXN0LnB1c2goaXRlbSArICdfJyArIGF0dHJpYnV0ZS5uYW1lKTtcbiAgICAgICAgICAgICAgICAgICAgYnJlYWs7XG4gICAgICAgICAgICAgICAgICAgIGNhc2UgJ2F1cmFfbmVnYXRpdmVfYXJtb3InOlxuICAgICAgICAgICAgICAgICAgICAgICAgdG90YWxBdHRyaWJ1dGUgKz0gcGFyc2VJbnQoYXR0cmlidXRlLnZhbHVlWzBdKTtcbiAgICAgICAgICAgICAgICAgICAgICAgIGV4Y2x1ZGVMaXN0LnB1c2goYXR0cmlidXRlLm5hbWUpO1xuICAgICAgICAgICAgICAgICAgICBicmVhaztcbiAgICAgICAgICAgICAgICAgICAgY2FzZSAnY29ycnVwdGlvbl9hcm1vcic6XG4gICAgICAgICAgICAgICAgICAgICAgICB0b3RhbEF0dHJpYnV0ZSArPSBwYXJzZUludChhdHRyaWJ1dGUudmFsdWVbMF0pO1xuICAgICAgICAgICAgICAgICAgICAgICAgZXhjbHVkZUxpc3QucHVzaChhdHRyaWJ1dGUubmFtZSk7XG4gICAgICAgICAgICAgICAgICAgIGJyZWFrO1xuICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgIH1cbiAgICAgICAgfVxuICAgICAgICByZXR1cm4ge3ZhbHVlOiB0b3RhbEF0dHJpYnV0ZSwgZXhjbHVkZUxpc3Q6IGV4Y2x1ZGVMaXN0fTtcbiAgICB9O1xuICAgIHNlbGYuZ2V0RXZhc2lvbiA9IGZ1bmN0aW9uICgpIHtcbiAgICAgICAgdmFyIHRvdGFsQXR0cmlidXRlID0gMTtcbiAgICAgICAgZm9yICh2YXIgaSA9IDA7IGkgPCBzZWxmLml0ZW1zKCkubGVuZ3RoOyBpKyspIHtcbiAgICAgICAgICAgIHZhciBpdGVtID0gc2VsZi5pdGVtcygpW2ldLml0ZW07XG4gICAgICAgICAgICB2YXIgaXNBY3RpdmUgPSBzZWxmLmFjdGl2ZUl0ZW1zLmluZGV4T2Yoc2VsZi5pdGVtcygpW2ldKSA+PSAwID8gdHJ1ZSA6IGZhbHNlO1xuICAgICAgICAgICAgaWYgKCFzZWxmLml0ZW1zKClbaV0uZW5hYmxlZCgpKSBjb250aW51ZTtcbiAgICAgICAgICAgIGZvciAodmFyIGogPSAwOyBqIDwgbXkucHJvdG90eXBlLml0ZW1EYXRhWydpdGVtXycgKyBpdGVtXS5hdHRyaWJ1dGVzLmxlbmd0aDsgaisrKSB7XG4gICAgICAgICAgICAgICAgdmFyIGF0dHJpYnV0ZSA9IG15LnByb3RvdHlwZS5pdGVtRGF0YVsnaXRlbV8nICsgaXRlbV0uYXR0cmlidXRlc1tqXTtcbiAgICAgICAgICAgICAgICBzd2l0Y2goYXR0cmlidXRlLm5hbWUpIHtcbiAgICAgICAgICAgICAgICAgICAgY2FzZSAnYm9udXNfZXZhc2lvbic6XG4gICAgICAgICAgICAgICAgICAgICAgICBpZiAoaXRlbSAhPSAnYnV0dGVyZmx5JyB8fCAhaXNBY3RpdmUpIHRvdGFsQXR0cmlidXRlICo9ICgxIC0gcGFyc2VJbnQoYXR0cmlidXRlLnZhbHVlWzBdKSAvIDEwMCk7XG4gICAgICAgICAgICAgICAgICAgIGJyZWFrO1xuICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgIH1cbiAgICAgICAgfVxuICAgICAgICByZXR1cm4gdG90YWxBdHRyaWJ1dGU7XG4gICAgfTtcbiAgICBzZWxmLmdldE1vdmVtZW50U3BlZWRGbGF0ID0gZnVuY3Rpb24gKCkge1xuICAgICAgICB2YXIgdG90YWxBdHRyaWJ1dGUgPSAwLFxuICAgICAgICBoYXNCb290cyA9IGZhbHNlLFxuICAgICAgICBoYXNFdWxzID0gZmFsc2UsXG4gICAgICAgIGhhc1dpbmRMYWNlID0gZmFsc2UsXG4gICAgICAgIGJvb3RJdGVtcyA9IFsnYm9vdHMnLCdwaGFzZV9ib290cycsJ2FyY2FuZV9ib290cycsJ3RyYXZlbF9ib290cycsJ3Bvd2VyX3RyZWFkcycsJ3RyYW5xdWlsX2Jvb3RzJywnZ3VhcmRpYW5fZ3JlYXZlcyddO1xuICAgICAgICBmb3IgKHZhciBpID0gMDsgaSA8IHNlbGYuaXRlbXMoKS5sZW5ndGg7IGkrKykge1xuICAgICAgICAgICAgdmFyIGl0ZW0gPSBzZWxmLml0ZW1zKClbaV0uaXRlbTtcbiAgICAgICAgICAgIHZhciBpc0FjdGl2ZSA9IHNlbGYuYWN0aXZlSXRlbXMuaW5kZXhPZihzZWxmLml0ZW1zKClbaV0pID49IDAgPyB0cnVlIDogZmFsc2U7XG4gICAgICAgICAgICBpZiAoIXNlbGYuaXRlbXMoKVtpXS5lbmFibGVkKCkpIGNvbnRpbnVlO1xuICAgICAgICAgICAgZm9yICh2YXIgaiA9IDA7IGogPCBteS5wcm90b3R5cGUuaXRlbURhdGFbJ2l0ZW1fJyArIGl0ZW1dLmF0dHJpYnV0ZXMubGVuZ3RoOyBqKyspIHtcbiAgICAgICAgICAgICAgICB2YXIgYXR0cmlidXRlID0gbXkucHJvdG90eXBlLml0ZW1EYXRhWydpdGVtXycgKyBpdGVtXS5hdHRyaWJ1dGVzW2pdO1xuICAgICAgICAgICAgICAgIHN3aXRjaChhdHRyaWJ1dGUubmFtZSkge1xuICAgICAgICAgICAgICAgICAgICBjYXNlICdib251c19tb3ZlbWVudF9zcGVlZCc6XG4gICAgICAgICAgICAgICAgICAgICAgICBpZiAoIWhhc0Jvb3RzICYmIGJvb3RJdGVtcy5pbmRleE9mKGl0ZW0pID49IDApIHtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICBpZiAoaXRlbSAhPSAndHJhbnF1aWxfYm9vdHMnIHx8IChpdGVtID09ICd0cmFucXVpbF9ib290cycgJiYgIWlzQWN0aXZlKSkge1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICB0b3RhbEF0dHJpYnV0ZSArPSBwYXJzZUludChhdHRyaWJ1dGUudmFsdWVbMF0pO1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBoYXNCb290cyA9IHRydWU7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICAgICAgICAgICAgLy9lbHNlIGlmICghaGFzRXVscyAmJiBpdGVtID09ICdjeWNsb25lJykge1xuICAgICAgICAgICAgICAgICAgICAgICAgZWxzZSBpZiAoaXRlbSA9PSAnY3ljbG9uZScpIHtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICB0b3RhbEF0dHJpYnV0ZSArPSBwYXJzZUludChhdHRyaWJ1dGUudmFsdWVbMF0pO1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgIGhhc0V1bHMgPSB0cnVlO1xuICAgICAgICAgICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICAgICAgICBicmVhaztcbiAgICAgICAgICAgICAgICAgICAgY2FzZSAnYnJva2VuX21vdmVtZW50X3NwZWVkJzpcbiAgICAgICAgICAgICAgICAgICAgICAgIGlmICghaGFzQm9vdHMgJiYgYm9vdEl0ZW1zLmluZGV4T2YoaXRlbSkgPj0gMCkge1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgIGlmIChpdGVtID09ICd0cmFucXVpbF9ib290cycgJiYgaXNBY3RpdmUpIHtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgdG90YWxBdHRyaWJ1dGUgKz0gcGFyc2VJbnQoYXR0cmlidXRlLnZhbHVlWzBdKTtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgaGFzQm9vdHMgPSB0cnVlO1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgICAgICAgYnJlYWs7XG4gICAgICAgICAgICAgICAgICAgIGNhc2UgJ2JvbnVzX21vdmVtZW50JzpcbiAgICAgICAgICAgICAgICAgICAgICAgIGlmICghaGFzQm9vdHMgJiYgYm9vdEl0ZW1zLmluZGV4T2YoaXRlbSkgPj0gMCkge1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgIHRvdGFsQXR0cmlidXRlICs9IHBhcnNlSW50KGF0dHJpYnV0ZS52YWx1ZVswXSk7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgaGFzQm9vdHMgPSB0cnVlO1xuICAgICAgICAgICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICAgICAgICBicmVhaztcbiAgICAgICAgICAgICAgICAgICAgY2FzZSAnbW92ZW1lbnRfc3BlZWQnOlxuICAgICAgICAgICAgICAgICAgICAgICAgaWYgKCFoYXNXaW5kTGFjZSAmJiBpdGVtID09ICd3aW5kX2xhY2UnKSB7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgdG90YWxBdHRyaWJ1dGUgKz0gcGFyc2VJbnQoYXR0cmlidXRlLnZhbHVlWzBdKTtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICBoYXNXaW5kTGFjZSA9IHRydWU7XG4gICAgICAgICAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgICAgICAgIGJyZWFrO1xuICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgIH1cbiAgICAgICAgfVxuICAgICAgICByZXR1cm4gdG90YWxBdHRyaWJ1dGU7XG4gICAgfTtcbiAgICBzZWxmLmdldE1vdmVtZW50U3BlZWRQZXJjZW50ID0gZnVuY3Rpb24gKGUpIHtcbiAgICAgICAgdmFyIHRvdGFsQXR0cmlidXRlID0gMCxcbiAgICAgICAgICAgIGV4Y2x1ZGVMaXN0ID0gZSB8fCBbXSxcbiAgICAgICAgICAgIGhhc1lhc2hhID0gZmFsc2UsXG4gICAgICAgICAgICBoYXNEcnVtcyA9IGZhbHNlLFxuICAgICAgICAgICAgaGFzRHJ1bXNBY3RpdmUgPSBmYWxzZSxcbiAgICAgICAgICAgIGhhc1BoYXNlQWN0aXZlID0gZmFsc2UsXG4gICAgICAgICAgICBoYXNTaGFkb3dCbGFkZUFjdGl2ZSA9IGZhbHNlLFxuICAgICAgICAgICAgaGFzQnV0dGVyZmx5QWN0aXZlID0gZmFsc2UsXG4gICAgICAgICAgICBoYXNNb01BY3RpdmUgPSBmYWxzZSxcbiAgICAgICAgICAgIHlhc2hhSXRlbXMgPSBbJ21hbnRhJywneWFzaGEnLCdzYW5nZV9hbmRfeWFzaGEnXTtcbiAgICAgICAgZm9yICh2YXIgaSA9IDA7IGkgPCBzZWxmLml0ZW1zKCkubGVuZ3RoOyBpKyspIHtcbiAgICAgICAgICAgIHZhciBpdGVtID0gc2VsZi5pdGVtcygpW2ldLml0ZW07XG4gICAgICAgICAgICB2YXIgaXNBY3RpdmUgPSBzZWxmLmFjdGl2ZUl0ZW1zLmluZGV4T2Yoc2VsZi5pdGVtcygpW2ldKSA+PSAwID8gdHJ1ZSA6IGZhbHNlO1xuICAgICAgICAgICAgaWYgKCFzZWxmLml0ZW1zKClbaV0uZW5hYmxlZCgpKSBjb250aW51ZTtcbiAgICAgICAgICAgIGZvciAodmFyIGogPSAwOyBqIDwgbXkucHJvdG90eXBlLml0ZW1EYXRhWydpdGVtXycgKyBpdGVtXS5hdHRyaWJ1dGVzLmxlbmd0aDsgaisrKSB7XG4gICAgICAgICAgICAgICAgdmFyIGF0dHJpYnV0ZSA9IG15LnByb3RvdHlwZS5pdGVtRGF0YVsnaXRlbV8nICsgaXRlbV0uYXR0cmlidXRlc1tqXTtcbiAgICAgICAgICAgICAgICBpZiAoZXhjbHVkZUxpc3QuaW5kZXhPZihhdHRyaWJ1dGUubmFtZSkgPiAtMSkgY29udGludWU7XG4gICAgICAgICAgICAgICAgc3dpdGNoKGF0dHJpYnV0ZS5uYW1lKSB7XG4gICAgICAgICAgICAgICAgICAgIGNhc2UgJ21vdmVtZW50X3NwZWVkX3BlcmNlbnRfYm9udXMnOlxuICAgICAgICAgICAgICAgICAgICAgICAgaWYgKCFoYXNZYXNoYSAmJiB5YXNoYUl0ZW1zLmluZGV4T2YoaXRlbSkgPj0gMCkge1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgIHRvdGFsQXR0cmlidXRlICs9IHBhcnNlSW50KGF0dHJpYnV0ZS52YWx1ZVswXSk7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgaGFzWWFzaGEgPSB0cnVlO1xuICAgICAgICAgICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICAgICAgICBicmVhaztcbiAgICAgICAgICAgICAgICAgICAgY2FzZSAnYm9udXNfYXVyYV9tb3ZlbWVudF9zcGVlZF9wY3QnOlxuICAgICAgICAgICAgICAgICAgICAgICAgaWYgKCFoYXNEcnVtcyAmJiBpdGVtID09ICdhbmNpZW50X2phbmdnbycpIHtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICB0b3RhbEF0dHJpYnV0ZSArPSBwYXJzZUludChhdHRyaWJ1dGUudmFsdWVbMF0pO1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgIGhhc0RydW1zID0gdHJ1ZTtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICBleGNsdWRlTGlzdC5wdXNoKGF0dHJpYnV0ZS5uYW1lKTtcbiAgICAgICAgICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgICAgICAgYnJlYWs7XG4gICAgICAgICAgICAgICAgICAgIGNhc2UgJ3BoYXNlX21vdmVtZW50X3NwZWVkJzpcbiAgICAgICAgICAgICAgICAgICAgICAgIGlmIChpc0FjdGl2ZSAmJiAhaGFzUGhhc2VBY3RpdmUpIHtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICB0b3RhbEF0dHJpYnV0ZSArPSBwYXJzZUludChhdHRyaWJ1dGUudmFsdWVbMF0pO1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgIGhhc1BoYXNlQWN0aXZlID0gdHJ1ZTtcbiAgICAgICAgICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgICAgICAgYnJlYWs7XG4gICAgICAgICAgICAgICAgICAgIGNhc2UgJ2JvbnVzX21vdmVtZW50X3NwZWVkX3BjdCc6XG4gICAgICAgICAgICAgICAgICAgICAgICBpZiAoaXNBY3RpdmUgJiYgIWhhc0RydW1zQWN0aXZlICYmIGl0ZW0gPT0gJ2FuY2llbnRfamFuZ2dvJykge1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgIHRvdGFsQXR0cmlidXRlICs9IHBhcnNlSW50KGF0dHJpYnV0ZS52YWx1ZVswXSk7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgaGFzRHJ1bXNBY3RpdmUgPSB0cnVlO1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgIGV4Y2x1ZGVMaXN0LnB1c2goYXR0cmlidXRlLm5hbWUpO1xuICAgICAgICAgICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICAgICAgICBicmVhaztcbiAgICAgICAgICAgICAgICAgICAgY2FzZSAnd2luZHdhbGtfbW92ZW1lbnRfc3BlZWQnOlxuICAgICAgICAgICAgICAgICAgICAgICAgaWYgKGlzQWN0aXZlICYmICFoYXNTaGFkb3dCbGFkZUFjdGl2ZSAmJiAoaXRlbSA9PSAnaW52aXNfc3dvcmQnIHx8IGl0ZW0gPT0gJ3NpbHZlcl9lZGdlJykpIHtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICB0b3RhbEF0dHJpYnV0ZSArPSBwYXJzZUludChhdHRyaWJ1dGUudmFsdWVbMF0pO1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgIGhhc1NoYWRvd0JsYWRlQWN0aXZlID0gdHJ1ZTtcbiAgICAgICAgICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgICAgICAgYnJlYWs7XG4gICAgICAgICAgICAgICAgICAgIGNhc2UgJ2JlcnNlcmtfYm9udXNfbW92ZW1lbnRfc3BlZWQnOlxuICAgICAgICAgICAgICAgICAgICAgICAgaWYgKGlzQWN0aXZlICYmICFoYXNNb01BY3RpdmUgJiYgaXRlbSA9PSAnbWFza19vZl9tYWRuZXNzJykge1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgIHRvdGFsQXR0cmlidXRlICs9IHBhcnNlSW50KGF0dHJpYnV0ZS52YWx1ZVswXSk7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgaGFzTW9NQWN0aXZlID0gdHJ1ZTtcbiAgICAgICAgICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgICAgICAgYnJlYWs7XG4gICAgICAgICAgICAgICAgICAgIGNhc2UgJ2JvbnVzX21vdmVtZW50X3NwZWVkJzogLy9tYW50YVxuICAgICAgICAgICAgICAgICAgICAgICAgaWYgKCFoYXNZYXNoYSAmJiBpdGVtID09ICdtYW50YScpIHtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICB0b3RhbEF0dHJpYnV0ZSArPSBwYXJzZUludChhdHRyaWJ1dGUudmFsdWVbMF0pO1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgIGhhc1lhc2hhID0gdHJ1ZTtcbiAgICAgICAgICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgICAgICAgICAgIGVsc2UgaWYgKGl0ZW0gPT0gJ3Ntb2tlX29mX2RlY2VpdCcgJiYgaXNBY3RpdmUpIHtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICB0b3RhbEF0dHJpYnV0ZSArPSBwYXJzZUludChhdHRyaWJ1dGUudmFsdWVbMF0pO1xuICAgICAgICAgICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICAgICAgICBicmVhaztcbiAgICAgICAgICAgICAgICAgICAgY2FzZSAnYm9udXNfbW92ZV9zcGVlZCc6XG4gICAgICAgICAgICAgICAgICAgICAgICBpZiAoaXNBY3RpdmUgJiYgIWhhc0J1dHRlcmZseUFjdGl2ZSAmJiBpdGVtID09ICdidXR0ZXJmbHknKSB7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgdG90YWxBdHRyaWJ1dGUgKz0gcGFyc2VJbnQoYXR0cmlidXRlLnZhbHVlWzBdKTtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICBoYXNCdXR0ZXJmbHlBY3RpdmUgPSB0cnVlO1xuICAgICAgICAgICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICAgICAgICBicmVhaztcbiAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICB9XG4gICAgICAgIH1cbiAgICAgICAgcmV0dXJuIHt2YWx1ZTogdG90YWxBdHRyaWJ1dGUvMTAwLCBleGNsdWRlTGlzdDogZXhjbHVkZUxpc3R9O1xuICAgIH07XG4gICAgXG4gICAgc2VsZi5nZXRNb3ZlbWVudFNwZWVkUGVyY2VudFJlZHVjdGlvbiA9IGZ1bmN0aW9uIChlKSB7XG4gICAgICAgIHZhciB0b3RhbEF0dHJpYnV0ZSA9IDAsXG4gICAgICAgICAgICBleGNsdWRlTGlzdCA9IGUgfHwgW107XG4gICAgICAgIGZvciAodmFyIGkgPSAwOyBpIDwgc2VsZi5pdGVtcygpLmxlbmd0aDsgaSsrKSB7XG4gICAgICAgICAgICB2YXIgaXRlbSA9IHNlbGYuaXRlbXMoKVtpXS5pdGVtO1xuICAgICAgICAgICAgdmFyIGlzQWN0aXZlID0gc2VsZi5hY3RpdmVJdGVtcy5pbmRleE9mKHNlbGYuaXRlbXMoKVtpXSkgPj0gMCA/IHRydWUgOiBmYWxzZTtcbiAgICAgICAgICAgIGlmICghc2VsZi5pdGVtcygpW2ldLmVuYWJsZWQoKSkgY29udGludWU7XG4gICAgICAgICAgICBmb3IgKHZhciBqID0gMDsgaiA8IG15LnByb3RvdHlwZS5pdGVtRGF0YVsnaXRlbV8nICsgaXRlbV0uYXR0cmlidXRlcy5sZW5ndGg7IGorKykge1xuICAgICAgICAgICAgICAgIHZhciBhdHRyaWJ1dGUgPSBteS5wcm90b3R5cGUuaXRlbURhdGFbJ2l0ZW1fJyArIGl0ZW1dLmF0dHJpYnV0ZXNbal07XG4gICAgICAgICAgICAgICAgaWYgKGV4Y2x1ZGVMaXN0LmluZGV4T2YoYXR0cmlidXRlLm5hbWUpID4gLTEpIGNvbnRpbnVlO1xuICAgICAgICAgICAgICAgIHN3aXRjaChhdHRyaWJ1dGUubmFtZSkge1xuICAgICAgICAgICAgICAgICAgICBjYXNlICdtb3Zlc3BlZWQnOlxuICAgICAgICAgICAgICAgICAgICAgICAgaWYgKGl0ZW0gPT0gJ2R1c3QnICYmIGlzQWN0aXZlKSB7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgdG90YWxBdHRyaWJ1dGUgKz0gcGFyc2VJbnQoYXR0cmlidXRlLnZhbHVlWzBdKTtcbiAgICAgICAgICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgICAgICAgY2FzZSAnYmxhc3RfbW92ZW1lbnRfc3BlZWQnOlxuICAgICAgICAgICAgICAgICAgICAgICAgaWYgKGl0ZW0gPT0gJ3NoaXZhc19ndWFyZCcgJiYgaXNBY3RpdmUpIHtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICB0b3RhbEF0dHJpYnV0ZSArPSBwYXJzZUludChhdHRyaWJ1dGUudmFsdWVbMF0pO1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgIGV4Y2x1ZGVMaXN0LnB1c2goYXR0cmlidXRlLm5hbWUpO1xuICAgICAgICAgICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICAgICAgICBjYXNlICdjb2xkX21vdmVtZW50X3NwZWVkJzpcbiAgICAgICAgICAgICAgICAgICAgICAgIGlmIChpdGVtID09ICdza2FkaScpIHtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICB0b3RhbEF0dHJpYnV0ZSArPSBwYXJzZUludChhdHRyaWJ1dGUudmFsdWVbMF0pO1xuICAgICAgICAgICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICAgICAgICBicmVhaztcbiAgICAgICAgICAgICAgICAgICAgY2FzZSAnbWFpbV9tb3ZlbWVudF9zcGVlZCc6XG4gICAgICAgICAgICAgICAgICAgICAgICBpZiAoc2VsZi5pdGVtcygpW2ldLmRlYnVmZiAmJiBzZWxmLml0ZW1zKClbaV0uZGVidWZmID09ICdtYWltJykge1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgIHRvdGFsQXR0cmlidXRlICs9IHBhcnNlSW50KGF0dHJpYnV0ZS52YWx1ZVswXSk7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgZXhjbHVkZUxpc3QucHVzaChhdHRyaWJ1dGUubmFtZSk7XG4gICAgICAgICAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgICAgICAgIGJyZWFrO1xuICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgIH1cbiAgICAgICAgfVxuICAgICAgICByZXR1cm4ge3ZhbHVlOiB0b3RhbEF0dHJpYnV0ZS8xMDAsIGV4Y2x1ZGVMaXN0OiBleGNsdWRlTGlzdH07XG4gICAgfTtcbiAgICBcbiAgICBzZWxmLmdldEJvbnVzRGFtYWdlID0gZnVuY3Rpb24gKCkge1xuICAgICAgICB2YXIgdG90YWxBdHRyaWJ1dGUgPSAwO1xuICAgICAgICB2YXIgc291cmNlcyA9IHt9O1xuICAgICAgICBmb3IgKHZhciBpID0gMDsgaSA8IHNlbGYuaXRlbXMoKS5sZW5ndGg7IGkrKykge1xuICAgICAgICAgICAgdmFyIGl0ZW0gPSBzZWxmLml0ZW1zKClbaV0uaXRlbTtcbiAgICAgICAgICAgIHZhciBpc0FjdGl2ZSA9IHNlbGYuYWN0aXZlSXRlbXMuaW5kZXhPZihzZWxmLml0ZW1zKClbaV0pID49IDAgPyB0cnVlIDogZmFsc2U7XG4gICAgICAgICAgICBpZiAoIXNlbGYuaXRlbXMoKVtpXS5lbmFibGVkKCkpIGNvbnRpbnVlO1xuICAgICAgICAgICAgZm9yICh2YXIgaiA9IDA7IGogPCBteS5wcm90b3R5cGUuaXRlbURhdGFbJ2l0ZW1fJyArIGl0ZW1dLmF0dHJpYnV0ZXMubGVuZ3RoOyBqKyspIHtcbiAgICAgICAgICAgICAgICB2YXIgYXR0cmlidXRlID0gbXkucHJvdG90eXBlLml0ZW1EYXRhWydpdGVtXycgKyBpdGVtXS5hdHRyaWJ1dGVzW2pdO1xuICAgICAgICAgICAgICAgIHN3aXRjaChhdHRyaWJ1dGUubmFtZSkge1xuICAgICAgICAgICAgICAgICAgICBjYXNlICdib251c19kYW1hZ2UnOlxuICAgICAgICAgICAgICAgICAgICAgICAgdG90YWxBdHRyaWJ1dGUgKz0gcGFyc2VJbnQoYXR0cmlidXRlLnZhbHVlWzBdKTtcbiAgICAgICAgICAgICAgICAgICAgICAgIGlmIChzb3VyY2VzW2l0ZW1dID09IHVuZGVmaW5lZCkge1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgIHNvdXJjZXNbaXRlbV0gPSB7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICdkYW1hZ2UnOiBwYXJzZUludChhdHRyaWJ1dGUudmFsdWVbMF0pLFxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAnZGFtYWdlVHlwZSc6ICdwaHlzaWNhbCcsXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICdjb3VudCc6MSxcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgJ2Rpc3BsYXluYW1lJzogbXkucHJvdG90eXBlLml0ZW1EYXRhWydpdGVtXycgKyBpdGVtXS5kaXNwbGF5bmFtZVxuICAgICAgICAgICAgICAgICAgICAgICAgICAgIH0gICAgICAgICAgICAgICAgICAgICAgICAgICAgXG4gICAgICAgICAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgICAgICAgICAgICBlbHNlIHtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICBzb3VyY2VzW2l0ZW1dLmNvdW50ICs9IDE7XG4gICAgICAgICAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgICAgICAgIGJyZWFrO1xuICAgICAgICAgICAgICAgICAgICBjYXNlICd1bmhvbHlfYm9udXNfZGFtYWdlJzpcbiAgICAgICAgICAgICAgICAgICAgICAgIGlmIChpc0FjdGl2ZSkge1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgIHRvdGFsQXR0cmlidXRlICs9IHBhcnNlSW50KGF0dHJpYnV0ZS52YWx1ZVswXSk7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgaWYgKHNvdXJjZXNbaXRlbSArICdfYWN0aXZlJ10gPT0gdW5kZWZpbmVkKSB7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIHNvdXJjZXNbaXRlbSArICdfYWN0aXZlJ10gPSB7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAnZGFtYWdlJzogcGFyc2VJbnQoYXR0cmlidXRlLnZhbHVlWzBdKSxcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICdkYW1hZ2VUeXBlJzogJ3BoeXNpY2FsJyxcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICdjb3VudCc6MSxcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICdkaXNwbGF5bmFtZSc6IG15LnByb3RvdHlwZS5pdGVtRGF0YVsnaXRlbV8nICsgaXRlbV0uZGlzcGxheW5hbWUgKyAnIFVuaG9seSBTdHJlbmd0aCdcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgfSAgICAgICAgICAgICAgICAgICAgICAgICAgICBcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgZWxzZSB7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIHNvdXJjZXNbaXRlbV0uY291bnQgKz0gMTtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgICAgICAgIGJyZWFrO1xuICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgIH1cbiAgICAgICAgfVxuICAgICAgICByZXR1cm4geyBzb3VyY2VzOiBzb3VyY2VzLCB0b3RhbDogdG90YWxBdHRyaWJ1dGUgfTtcbiAgICB9O1xuICAgIHNlbGYuZ2V0Qm9udXNEYW1hZ2VQZXJjZW50ID0gZnVuY3Rpb24gKHMpIHtcbiAgICAgICAgcyA9IHMgfHwge3NvdXJjZXM6e30sdG90YWw6MH07XG4gICAgICAgIHZhciB0b3RhbEF0dHJpYnV0ZSA9IHMudG90YWwgfHwgMDtcbiAgICAgICAgdmFyIHNvdXJjZXMgPSBzLnNvdXJjZXMgfHwge307XG4gICAgICAgIGZvciAodmFyIGkgPSAwOyBpIDwgc2VsZi5pdGVtcygpLmxlbmd0aDsgaSsrKSB7XG4gICAgICAgICAgICB2YXIgaXRlbSA9IHNlbGYuaXRlbXMoKVtpXS5pdGVtO1xuICAgICAgICAgICAgdmFyIGlzQWN0aXZlID0gc2VsZi5hY3RpdmVJdGVtcy5pbmRleE9mKHNlbGYuaXRlbXMoKVtpXSkgPj0gMCA/IHRydWUgOiBmYWxzZTtcbiAgICAgICAgICAgIGlmICghc2VsZi5pdGVtcygpW2ldLmVuYWJsZWQoKSkgY29udGludWU7XG4gICAgICAgICAgICBmb3IgKHZhciBqID0gMDsgaiA8IG15LnByb3RvdHlwZS5pdGVtRGF0YVsnaXRlbV8nICsgaXRlbV0uYXR0cmlidXRlcy5sZW5ndGg7IGorKykge1xuICAgICAgICAgICAgICAgIHZhciBhdHRyaWJ1dGUgPSBteS5wcm90b3R5cGUuaXRlbURhdGFbJ2l0ZW1fJyArIGl0ZW1dLmF0dHJpYnV0ZXNbal07XG4gICAgICAgICAgICAgICAgc3dpdGNoKGF0dHJpYnV0ZS5uYW1lKSB7XG4gICAgICAgICAgICAgICAgICAgIGNhc2UgJ2RhbWFnZV9hdXJhJzpcbiAgICAgICAgICAgICAgICAgICAgICAgIGlmIChzb3VyY2VzW2l0ZW1dID09IHVuZGVmaW5lZCkge1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgIHRvdGFsQXR0cmlidXRlICs9IHBhcnNlSW50KGF0dHJpYnV0ZS52YWx1ZVswXSkgLyAxMDA7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgc291cmNlc1tpdGVtXSA9IHtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgJ2RhbWFnZSc6IHBhcnNlSW50KGF0dHJpYnV0ZS52YWx1ZVswXSkgLyAxMDAsXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICdkYW1hZ2VUeXBlJzogJ3BoeXNpY2FsJyxcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgJ2NvdW50JzoxLFxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAnZGlzcGxheW5hbWUnOiBteS5wcm90b3R5cGUuaXRlbURhdGFbJ2l0ZW1fJyArIGl0ZW1dLmRpc3BsYXluYW1lXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICAgICAgICAgICAgLy8gZWxzZSB7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgLy8gc291cmNlc1tpdGVtXS5jb3VudCArPSAxO1xuICAgICAgICAgICAgICAgICAgICAgICAgLy8gfVxuICAgICAgICAgICAgICAgICAgICBicmVhaztcbiAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICB9XG4gICAgICAgIH1cbiAgICAgICAgcmV0dXJuIHsgc291cmNlczogc291cmNlcywgdG90YWw6IHRvdGFsQXR0cmlidXRlIH07XG4gICAgfTtcbiAgICBzZWxmLmdldEF0dGFja1NwZWVkID0gZnVuY3Rpb24gKGUpIHtcbiAgICAgICAgdmFyIHRvdGFsQXR0cmlidXRlID0gMCxcbiAgICAgICAgICAgIGhhc1Bvd2VyVHJlYWRzID0gZmFsc2UsXG4gICAgICAgICAgICBleGNsdWRlTGlzdCA9IGUgfHwgW107XG4gICAgICAgIGZvciAodmFyIGkgPSAwOyBpIDwgc2VsZi5pdGVtcygpLmxlbmd0aDsgaSsrKSB7XG4gICAgICAgICAgICB2YXIgaXRlbSA9IHNlbGYuaXRlbXMoKVtpXS5pdGVtO1xuICAgICAgICAgICAgdmFyIGlzQWN0aXZlID0gc2VsZi5hY3RpdmVJdGVtcy5pbmRleE9mKHNlbGYuaXRlbXMoKVtpXSkgPj0gMCA/IHRydWUgOiBmYWxzZTtcbiAgICAgICAgICAgIGlmICghc2VsZi5pdGVtcygpW2ldLmVuYWJsZWQoKSkgY29udGludWU7XG4gICAgICAgICAgICBmb3IgKHZhciBqID0gMDsgaiA8IG15LnByb3RvdHlwZS5pdGVtRGF0YVsnaXRlbV8nICsgaXRlbV0uYXR0cmlidXRlcy5sZW5ndGg7IGorKykge1xuICAgICAgICAgICAgICAgIHZhciBhdHRyaWJ1dGUgPSBteS5wcm90b3R5cGUuaXRlbURhdGFbJ2l0ZW1fJyArIGl0ZW1dLmF0dHJpYnV0ZXNbal07XG4gICAgICAgICAgICAgICAgaWYgKGV4Y2x1ZGVMaXN0LmluZGV4T2YoYXR0cmlidXRlLm5hbWUpID4gLTEpIGNvbnRpbnVlO1xuICAgICAgICAgICAgICAgIHN3aXRjaChhdHRyaWJ1dGUubmFtZSkge1xuICAgICAgICAgICAgICAgICAgICBjYXNlICdib251c19hdHRhY2tfc3BlZWQnOlxuICAgICAgICAgICAgICAgICAgICAgICAgaWYgKGl0ZW0gPT0gJ3Bvd2VyX3RyZWFkcycpIHtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICBpZiAoIWhhc1Bvd2VyVHJlYWRzKSB7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIHRvdGFsQXR0cmlidXRlICs9IHBhcnNlSW50KGF0dHJpYnV0ZS52YWx1ZVswXSk7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIGhhc1Bvd2VyVHJlYWRzID0gdHJ1ZTtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgICAgICAgICAgICBlbHNlIGlmIChpdGVtID09ICdtb29uX3NoYXJkJykge1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgIGlmICghaXNBY3RpdmUpIHtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgdG90YWxBdHRyaWJ1dGUgKz0gcGFyc2VJbnQoYXR0cmlidXRlLnZhbHVlWzBdKTtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgICAgICAgICAgICBlbHNlIHtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICB0b3RhbEF0dHJpYnV0ZSArPSBwYXJzZUludChhdHRyaWJ1dGUudmFsdWVbMF0pO1xuICAgICAgICAgICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICAgICAgICBicmVhaztcbiAgICAgICAgICAgICAgICAgICAgY2FzZSAnY29uc3VtZWRfYm9udXMnOlxuICAgICAgICAgICAgICAgICAgICAgICAgaWYgKGl0ZW0gPT0gJ21vb25fc2hhcmQnICYmIGlzQWN0aXZlKSB7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgdG90YWxBdHRyaWJ1dGUgKz0gcGFyc2VJbnQoYXR0cmlidXRlLnZhbHVlWzBdKTtcbiAgICAgICAgICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgICAgICAgYnJlYWs7XG4gICAgICAgICAgICAgICAgICAgIGJyZWFrO1xuICAgICAgICAgICAgICAgICAgICBjYXNlICdib251c19zcGVlZCc6XG4gICAgICAgICAgICAgICAgICAgICAgICB0b3RhbEF0dHJpYnV0ZSArPSBwYXJzZUludChhdHRyaWJ1dGUudmFsdWVbMF0pO1xuICAgICAgICAgICAgICAgICAgICBicmVhaztcbiAgICAgICAgICAgICAgICAgICAgY2FzZSAnYXVyYV9hdHRhY2tfc3BlZWQnOlxuICAgICAgICAgICAgICAgICAgICAgICAgaWYgKGl0ZW0gIT0gJ3NoaXZhc19ndWFyZCcpIHsgdG90YWxBdHRyaWJ1dGUgKz0gcGFyc2VJbnQoYXR0cmlidXRlLnZhbHVlWzBdKTsgfTtcbiAgICAgICAgICAgICAgICAgICAgYnJlYWs7XG4gICAgICAgICAgICAgICAgICAgIC8vIGFuY2llbnRfamFuZ2dvXG4gICAgICAgICAgICAgICAgICAgIGNhc2UgJ2JvbnVzX2F1cmFfYXR0YWNrX3NwZWVkX3BjdCc6XG4gICAgICAgICAgICAgICAgICAgICAgICB0b3RhbEF0dHJpYnV0ZSArPSBwYXJzZUludChhdHRyaWJ1dGUudmFsdWVbMF0pO1xuICAgICAgICAgICAgICAgICAgICAgICAgZXhjbHVkZUxpc3QucHVzaChhdHRyaWJ1dGUubmFtZSk7XG4gICAgICAgICAgICAgICAgICAgIGJyZWFrO1xuICAgICAgICAgICAgICAgICAgICAvLyBhbmNpZW50X2phbmdnb1xuICAgICAgICAgICAgICAgICAgICBjYXNlICdib251c19hdHRhY2tfc3BlZWRfcGN0JzpcbiAgICAgICAgICAgICAgICAgICAgICAgIGlmIChpc0FjdGl2ZSkge1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgIHRvdGFsQXR0cmlidXRlICs9IHBhcnNlSW50KGF0dHJpYnV0ZS52YWx1ZVswXSk7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgZXhjbHVkZUxpc3QucHVzaChhdHRyaWJ1dGUubmFtZSk7XG4gICAgICAgICAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgICAgICAgIGJyZWFrO1xuICAgICAgICAgICAgICAgICAgICBjYXNlICd1bmhvbHlfYm9udXNfYXR0YWNrX3NwZWVkJzpcbiAgICAgICAgICAgICAgICAgICAgICAgIGlmIChpc0FjdGl2ZSkgeyB0b3RhbEF0dHJpYnV0ZSArPSBwYXJzZUludChhdHRyaWJ1dGUudmFsdWVbMF0pOyB9O1xuICAgICAgICAgICAgICAgICAgICBicmVhaztcbiAgICAgICAgICAgICAgICAgICAgY2FzZSAnYmVyc2Vya19ib251c19hdHRhY2tfc3BlZWQnOlxuICAgICAgICAgICAgICAgICAgICAgICAgaWYgKGlzQWN0aXZlKSB7IHRvdGFsQXR0cmlidXRlICs9IHBhcnNlSW50KGF0dHJpYnV0ZS52YWx1ZVswXSk7IH07XG4gICAgICAgICAgICAgICAgICAgIGJyZWFrO1xuICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgIH1cbiAgICAgICAgfVxuICAgICAgICByZXR1cm4ge3ZhbHVlOiB0b3RhbEF0dHJpYnV0ZSwgZXhjbHVkZUxpc3Q6IGV4Y2x1ZGVMaXN0fTtcbiAgICB9O1xuICAgIHNlbGYuZ2V0QXR0YWNrU3BlZWRSZWR1Y3Rpb24gPSBmdW5jdGlvbiAoZSkge1xuICAgICAgICB2YXIgdG90YWxBdHRyaWJ1dGUgPSAwLFxuICAgICAgICAgICAgZXhjbHVkZUxpc3QgPSBlIHx8IFtdO1xuICAgICAgICBmb3IgKHZhciBpID0gMDsgaSA8IHNlbGYuaXRlbXMoKS5sZW5ndGg7IGkrKykge1xuICAgICAgICAgICAgdmFyIGl0ZW0gPSBzZWxmLml0ZW1zKClbaV0uaXRlbTtcbiAgICAgICAgICAgIHZhciBpc0FjdGl2ZSA9IHNlbGYuYWN0aXZlSXRlbXMuaW5kZXhPZihzZWxmLml0ZW1zKClbaV0pID49IDAgPyB0cnVlIDogZmFsc2U7XG4gICAgICAgICAgICBpZiAoIXNlbGYuaXRlbXMoKVtpXS5lbmFibGVkKCkpIGNvbnRpbnVlO1xuICAgICAgICAgICAgZm9yICh2YXIgaiA9IDA7IGogPCBteS5wcm90b3R5cGUuaXRlbURhdGFbJ2l0ZW1fJyArIGl0ZW1dLmF0dHJpYnV0ZXMubGVuZ3RoOyBqKyspIHtcbiAgICAgICAgICAgICAgICB2YXIgYXR0cmlidXRlID0gbXkucHJvdG90eXBlLml0ZW1EYXRhWydpdGVtXycgKyBpdGVtXS5hdHRyaWJ1dGVzW2pdO1xuICAgICAgICAgICAgICAgIGlmIChleGNsdWRlTGlzdC5pbmRleE9mKGF0dHJpYnV0ZS5uYW1lKSA+IC0xKSBjb250aW51ZTtcbiAgICAgICAgICAgICAgICBzd2l0Y2goYXR0cmlidXRlLm5hbWUpIHtcbiAgICAgICAgICAgICAgICAgICAgY2FzZSAnYXVyYV9hdHRhY2tfc3BlZWQnOlxuICAgICAgICAgICAgICAgICAgICAgICAgaWYgKGl0ZW0gPT0gJ3NoaXZhc19ndWFyZCcpIHtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICB0b3RhbEF0dHJpYnV0ZSArPSBwYXJzZUludChhdHRyaWJ1dGUudmFsdWVbMF0pO1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgIGV4Y2x1ZGVMaXN0LnB1c2goYXR0cmlidXRlLm5hbWUpO1xuICAgICAgICAgICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICAgICAgICBicmVhaztcbiAgICAgICAgICAgICAgICAgICAgY2FzZSAnY29sZF9hdHRhY2tfc3BlZWQnOlxuICAgICAgICAgICAgICAgICAgICAgICAgaWYgKGl0ZW0gPT0gJ3NrYWRpJykge1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgIHRvdGFsQXR0cmlidXRlICs9IHBhcnNlSW50KGF0dHJpYnV0ZS52YWx1ZVswXSk7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgZXhjbHVkZUxpc3QucHVzaChhdHRyaWJ1dGUubmFtZSk7XG4gICAgICAgICAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgICAgICAgIGJyZWFrO1xuICAgICAgICAgICAgICAgICAgICBjYXNlICdtYWltX2F0dGFja19zcGVlZCc6XG4gICAgICAgICAgICAgICAgICAgICAgICBpZiAoc2VsZi5pdGVtcygpW2ldLmRlYnVmZiAmJiBzZWxmLml0ZW1zKClbaV0uZGVidWZmID09ICdtYWltJykge1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgIHRvdGFsQXR0cmlidXRlICs9IHBhcnNlSW50KGF0dHJpYnV0ZS52YWx1ZVswXSk7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgZXhjbHVkZUxpc3QucHVzaChhdHRyaWJ1dGUubmFtZSk7XG4gICAgICAgICAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgICAgICAgIGJyZWFrO1xuICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgIH1cbiAgICAgICAgfVxuICAgICAgICByZXR1cm4ge3ZhbHVlOiB0b3RhbEF0dHJpYnV0ZSwgZXhjbHVkZUxpc3Q6IGV4Y2x1ZGVMaXN0fTtcbiAgICB9O1xuICAgIHNlbGYuZ2V0TGlmZXN0ZWFsID0gZnVuY3Rpb24gKCkge1xuICAgICAgICB2YXIgdG90YWxBdHRyaWJ1dGUgPSAwO1xuICAgICAgICBmb3IgKHZhciBpID0gMDsgaSA8IHNlbGYuaXRlbXMoKS5sZW5ndGg7IGkrKykge1xuICAgICAgICAgICAgdmFyIGl0ZW0gPSBzZWxmLml0ZW1zKClbaV0uaXRlbTtcbiAgICAgICAgICAgIHZhciBpc0FjdGl2ZSA9IHNlbGYuYWN0aXZlSXRlbXMuaW5kZXhPZihzZWxmLml0ZW1zKClbaV0pID49IDAgPyB0cnVlIDogZmFsc2U7XG4gICAgICAgICAgICBpZiAoIXNlbGYuaXRlbXMoKVtpXS5lbmFibGVkKCkpIGNvbnRpbnVlO1xuICAgICAgICAgICAgZm9yICh2YXIgaiA9IDA7IGogPCBteS5wcm90b3R5cGUuaXRlbURhdGFbJ2l0ZW1fJyArIGl0ZW1dLmF0dHJpYnV0ZXMubGVuZ3RoOyBqKyspIHtcbiAgICAgICAgICAgICAgICB2YXIgYXR0cmlidXRlID0gbXkucHJvdG90eXBlLml0ZW1EYXRhWydpdGVtXycgKyBpdGVtXS5hdHRyaWJ1dGVzW2pdO1xuICAgICAgICAgICAgICAgIHN3aXRjaChhdHRyaWJ1dGUubmFtZSkge1xuICAgICAgICAgICAgICAgICAgICBjYXNlICdsaWZlc3RlYWxfcGVyY2VudCc6XG4gICAgICAgICAgICAgICAgICAgICAgICBpZiAoaXRlbSA9PSAnc2F0YW5pYycpIHtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICBpZiAoIWlzQWN0aXZlKSB7IHJldHVybiBwYXJzZUludChhdHRyaWJ1dGUudmFsdWVbMF0pOyB9O1xuICAgICAgICAgICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICAgICAgICAgICAgZWxzZSB7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgcmV0dXJuIHBhcnNlSW50KGF0dHJpYnV0ZS52YWx1ZVswXSk7XG4gICAgICAgICAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgICAgICAgIGJyZWFrO1xuICAgICAgICAgICAgICAgICAgICBjYXNlICd1bmhvbHlfbGlmZXN0ZWFsX3BlcmNlbnQnOlxuICAgICAgICAgICAgICAgICAgICAgICAgaWYgKGlzQWN0aXZlKSB7IHJldHVybiBwYXJzZUludChhdHRyaWJ1dGUudmFsdWVbMF0pOyB9O1xuICAgICAgICAgICAgICAgICAgICBicmVhaztcbiAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICB9XG4gICAgICAgIH1cbiAgICAgICAgcmV0dXJuIHRvdGFsQXR0cmlidXRlO1xuICAgIH07XG4gICAgc2VsZi5nZXRMaWZlc3RlYWxBdXJhID0gZnVuY3Rpb24gKGUpIHtcbiAgICAgICAgdmFyIHRvdGFsQXR0cmlidXRlID0gMCxcbiAgICAgICAgICAgIGV4Y2x1ZGVMaXN0ID0gZSB8fCBbXTtcbiAgICAgICAgZm9yICh2YXIgaSA9IDA7IGkgPCBzZWxmLml0ZW1zKCkubGVuZ3RoOyBpKyspIHtcbiAgICAgICAgICAgIHZhciBpdGVtID0gc2VsZi5pdGVtcygpW2ldLml0ZW07XG4gICAgICAgICAgICB2YXIgaXNBY3RpdmUgPSBzZWxmLmFjdGl2ZUl0ZW1zLmluZGV4T2Yoc2VsZi5pdGVtcygpW2ldKSA+PSAwID8gdHJ1ZSA6IGZhbHNlO1xuICAgICAgICAgICAgaWYgKCFzZWxmLml0ZW1zKClbaV0uZW5hYmxlZCgpKSBjb250aW51ZTtcbiAgICAgICAgICAgIGZvciAodmFyIGogPSAwOyBqIDwgbXkucHJvdG90eXBlLml0ZW1EYXRhWydpdGVtXycgKyBpdGVtXS5hdHRyaWJ1dGVzLmxlbmd0aDsgaisrKSB7XG4gICAgICAgICAgICAgICAgdmFyIGF0dHJpYnV0ZSA9IG15LnByb3RvdHlwZS5pdGVtRGF0YVsnaXRlbV8nICsgaXRlbV0uYXR0cmlidXRlc1tqXTtcbiAgICAgICAgICAgICAgICBpZiAoZXhjbHVkZUxpc3QuaW5kZXhPZihhdHRyaWJ1dGUubmFtZSkgPiAtMSkgY29udGludWU7XG4gICAgICAgICAgICAgICAgc3dpdGNoKGF0dHJpYnV0ZS5uYW1lKSB7XG4gICAgICAgICAgICAgICAgICAgIGNhc2UgJ3ZhbXBpcmljX2F1cmEnOlxuICAgICAgICAgICAgICAgICAgICAgICAgdG90YWxBdHRyaWJ1dGUgKz0gcGFyc2VJbnQoYXR0cmlidXRlLnZhbHVlWzBdKTtcbiAgICAgICAgICAgICAgICAgICAgICAgIGV4Y2x1ZGVMaXN0LnB1c2goYXR0cmlidXRlLm5hbWUpO1xuICAgICAgICAgICAgICAgICAgICBicmVhaztcbiAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICB9XG4gICAgICAgIH1cbiAgICAgICAgcmV0dXJuIHt2YWx1ZTogdG90YWxBdHRyaWJ1dGUsIGV4Y2x1ZGVMaXN0OiBleGNsdWRlTGlzdH07XG4gICAgfTtcbiAgICBzZWxmLmdldE1hZ2ljUmVzaXN0ID0gZnVuY3Rpb24gKCkge1xuICAgICAgICB2YXIgdG90YWxBdHRyaWJ1dGUgPSAxO1xuICAgICAgICBmb3IgKHZhciBpID0gMDsgaSA8IHNlbGYuaXRlbXMoKS5sZW5ndGg7IGkrKykge1xuICAgICAgICAgICAgdmFyIGl0ZW0gPSBzZWxmLml0ZW1zKClbaV0uaXRlbTtcbiAgICAgICAgICAgIHZhciBpc0FjdGl2ZSA9IHNlbGYuYWN0aXZlSXRlbXMuaW5kZXhPZihzZWxmLml0ZW1zKClbaV0pID49IDAgPyB0cnVlIDogZmFsc2U7XG4gICAgICAgICAgICBpZiAoIXNlbGYuaXRlbXMoKVtpXS5lbmFibGVkKCkpIGNvbnRpbnVlO1xuICAgICAgICAgICAgZm9yICh2YXIgaiA9IDA7IGogPCBteS5wcm90b3R5cGUuaXRlbURhdGFbJ2l0ZW1fJyArIGl0ZW1dLmF0dHJpYnV0ZXMubGVuZ3RoOyBqKyspIHtcbiAgICAgICAgICAgICAgICB2YXIgYXR0cmlidXRlID0gbXkucHJvdG90eXBlLml0ZW1EYXRhWydpdGVtXycgKyBpdGVtXS5hdHRyaWJ1dGVzW2pdO1xuICAgICAgICAgICAgICAgIHN3aXRjaChhdHRyaWJ1dGUubmFtZSkge1xuICAgICAgICAgICAgICAgICAgICBjYXNlICdib251c19tYWdpY2FsX2FybW9yJzpcbiAgICAgICAgICAgICAgICAgICAgICAgIHRvdGFsQXR0cmlidXRlICo9ICgxIC0gcGFyc2VJbnQoYXR0cmlidXRlLnZhbHVlWzBdKSAvIDEwMCk7XG4gICAgICAgICAgICAgICAgICAgIGJyZWFrO1xuICAgICAgICAgICAgICAgICAgICBjYXNlICdib251c19zcGVsbF9yZXNpc3QnOlxuICAgICAgICAgICAgICAgICAgICAgICAgdG90YWxBdHRyaWJ1dGUgKj0gKDEgLSBwYXJzZUludChhdHRyaWJ1dGUudmFsdWVbMF0pIC8gMTAwKTtcbiAgICAgICAgICAgICAgICAgICAgYnJlYWs7XG4gICAgICAgICAgICAgICAgICAgIGNhc2UgJ21hZ2ljX3Jlc2lzdGFuY2UnOlxuICAgICAgICAgICAgICAgICAgICAgICAgdG90YWxBdHRyaWJ1dGUgKj0gKDEgLSBwYXJzZUludChhdHRyaWJ1dGUudmFsdWVbMF0pIC8gMTAwKTtcbiAgICAgICAgICAgICAgICAgICAgYnJlYWs7XG4gICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgfVxuICAgICAgICB9XG4gICAgICAgIHJldHVybiB0b3RhbEF0dHJpYnV0ZTtcbiAgICB9O1xuICAgIHNlbGYuZ2V0TWFnaWNSZXNpc3RSZWR1Y3Rpb25TZWxmID0gZnVuY3Rpb24gKCkge1xuICAgICAgICB2YXIgdG90YWxBdHRyaWJ1dGUgPSAxO1xuICAgICAgICBmb3IgKHZhciBpID0gMDsgaSA8IHNlbGYuaXRlbXMoKS5sZW5ndGg7IGkrKykge1xuICAgICAgICAgICAgdmFyIGl0ZW0gPSBzZWxmLml0ZW1zKClbaV0uaXRlbTtcbiAgICAgICAgICAgIHZhciBpc0FjdGl2ZSA9IHNlbGYuYWN0aXZlSXRlbXMuaW5kZXhPZihzZWxmLml0ZW1zKClbaV0pID49IDAgPyB0cnVlIDogZmFsc2U7XG4gICAgICAgICAgICBpZiAoIXNlbGYuaXRlbXMoKVtpXS5lbmFibGVkKCkpIGNvbnRpbnVlO1xuICAgICAgICAgICAgaWYgKGlzQWN0aXZlKSB7XG4gICAgICAgICAgICAgICAgZm9yICh2YXIgaiA9IDA7IGogPCBteS5wcm90b3R5cGUuaXRlbURhdGFbJ2l0ZW1fJyArIGl0ZW1dLmF0dHJpYnV0ZXMubGVuZ3RoOyBqKyspIHtcbiAgICAgICAgICAgICAgICAgICAgdmFyIGF0dHJpYnV0ZSA9IG15LnByb3RvdHlwZS5pdGVtRGF0YVsnaXRlbV8nICsgaXRlbV0uYXR0cmlidXRlc1tqXTtcbiAgICAgICAgICAgICAgICAgICAgc3dpdGNoKGF0dHJpYnV0ZS5uYW1lKSB7XG4gICAgICAgICAgICAgICAgICAgICAgICBjYXNlICdleHRyYV9zcGVsbF9kYW1hZ2VfcGVyY2VudCc6XG4gICAgICAgICAgICAgICAgICAgICAgICBjYXNlICdldGhlcmVhbF9kYW1hZ2VfYm9udXMnOlxuICAgICAgICAgICAgICAgICAgICAgICAgICAgIHJldHVybiAoMSAtIHBhcnNlSW50KGF0dHJpYnV0ZS52YWx1ZVswXSkgLyAxMDApO1xuICAgICAgICAgICAgICAgICAgICAgICAgYnJlYWs7XG4gICAgICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICB9XG4gICAgICAgIH1cbiAgICAgICAgcmV0dXJuIHRvdGFsQXR0cmlidXRlO1xuICAgIH07ICAgXG4gICAgc2VsZi5nZXRNYWdpY1Jlc2lzdFJlZHVjdGlvbiA9IGZ1bmN0aW9uICgpIHtcbiAgICAgICAgdmFyIHRvdGFsQXR0cmlidXRlID0gMTtcbiAgICAgICAgZm9yICh2YXIgaSA9IDA7IGkgPCBzZWxmLml0ZW1zKCkubGVuZ3RoOyBpKyspIHtcbiAgICAgICAgICAgIHZhciBpdGVtID0gc2VsZi5pdGVtcygpW2ldLml0ZW07XG4gICAgICAgICAgICB2YXIgaXNBY3RpdmUgPSBzZWxmLmFjdGl2ZUl0ZW1zLmluZGV4T2Yoc2VsZi5pdGVtcygpW2ldKSA+PSAwID8gdHJ1ZSA6IGZhbHNlO1xuICAgICAgICAgICAgaWYgKCFzZWxmLml0ZW1zKClbaV0uZW5hYmxlZCgpKSBjb250aW51ZTtcbiAgICAgICAgICAgIGlmIChpc0FjdGl2ZSkge1xuICAgICAgICAgICAgICAgIGZvciAodmFyIGogPSAwOyBqIDwgbXkucHJvdG90eXBlLml0ZW1EYXRhWydpdGVtXycgKyBpdGVtXS5hdHRyaWJ1dGVzLmxlbmd0aDsgaisrKSB7XG4gICAgICAgICAgICAgICAgICAgIHZhciBhdHRyaWJ1dGUgPSBteS5wcm90b3R5cGUuaXRlbURhdGFbJ2l0ZW1fJyArIGl0ZW1dLmF0dHJpYnV0ZXNbal07XG4gICAgICAgICAgICAgICAgICAgIHN3aXRjaChhdHRyaWJ1dGUubmFtZSkge1xuICAgICAgICAgICAgICAgICAgICAgICAgY2FzZSAnZXRoZXJlYWxfZGFtYWdlX2JvbnVzJzpcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICBpZiAoIXNlbGYuaXNFdGhlcmVhbCgpKSB0b3RhbEF0dHJpYnV0ZSAqPSAoMSAtIHBhcnNlSW50KGF0dHJpYnV0ZS52YWx1ZVswXSkgLyAxMDApO1xuICAgICAgICAgICAgICAgICAgICAgICAgY2FzZSAncmVzaXN0X2RlYnVmZic6XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgdG90YWxBdHRyaWJ1dGUgKj0gKDEgLSBwYXJzZUludChhdHRyaWJ1dGUudmFsdWVbMF0pIC8gMTAwKTtcbiAgICAgICAgICAgICAgICAgICAgICAgIGJyZWFrO1xuICAgICAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgfVxuICAgICAgICB9XG4gICAgICAgIHJldHVybiB0b3RhbEF0dHJpYnV0ZTtcbiAgICB9OyAgICAgICAgXG5cbiAgICBzZWxmLmdldFZpc2lvblJhbmdlTmlnaHQgPSBrby5jb21wdXRlZChmdW5jdGlvbiAoKSB7XG4gICAgICAgIHZhciB0b3RhbEF0dHJpYnV0ZSA9IDA7XG4gICAgICAgIGZvciAodmFyIGkgPSAwOyBpIDwgc2VsZi5pdGVtcygpLmxlbmd0aDsgaSsrKSB7XG4gICAgICAgICAgICB2YXIgaXRlbSA9IHNlbGYuaXRlbXMoKVtpXS5pdGVtO1xuICAgICAgICAgICAgdmFyIGlzQWN0aXZlID0gc2VsZi5hY3RpdmVJdGVtcy5pbmRleE9mKHNlbGYuaXRlbXMoKVtpXSkgPj0gMCA/IHRydWUgOiBmYWxzZTtcbiAgICAgICAgICAgIGlmICghc2VsZi5pdGVtcygpW2ldLmVuYWJsZWQoKSkgY29udGludWU7XG4gICAgICAgICAgICBmb3IgKHZhciBqID0gMDsgaiA8IG15LnByb3RvdHlwZS5pdGVtRGF0YVsnaXRlbV8nICsgaXRlbV0uYXR0cmlidXRlcy5sZW5ndGg7IGorKykge1xuICAgICAgICAgICAgICAgIHZhciBhdHRyaWJ1dGUgPSBteS5wcm90b3R5cGUuaXRlbURhdGFbJ2l0ZW1fJyArIGl0ZW1dLmF0dHJpYnV0ZXNbal07XG4gICAgICAgICAgICAgICAgc3dpdGNoKGF0dHJpYnV0ZS5uYW1lKSB7XG4gICAgICAgICAgICAgICAgICAgIGNhc2UgJ2JvbnVzX25pZ2h0X3Zpc2lvbic6XG4gICAgICAgICAgICAgICAgICAgICAgICBpZiAoaXRlbSAhPSAnbW9vbl9zaGFyZCcgfHwgIWlzQWN0aXZlKSB7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgdG90YWxBdHRyaWJ1dGUgKz0gcGFyc2VJbnQoYXR0cmlidXRlLnZhbHVlWzBdKTtcbiAgICAgICAgICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgICAgICAgYnJlYWs7XG4gICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgfVxuICAgICAgICB9XG4gICAgICAgIHJldHVybiB0b3RhbEF0dHJpYnV0ZTtcbiAgICB9KTtcbiAgICBcbiAgICBzZWxmLmdldEF0dGFja1JhbmdlID0gZnVuY3Rpb24gKGF0dGFja3R5cGUsIGFMaXN0KSB7XG4gICAgICAgIHZhciB0b3RhbEF0dHJpYnV0ZSA9IDAsXG4gICAgICAgICAgICBhdHRyaWJ1dGVMaXN0ID0gYUxpc3QgfHwgW107XG4gICAgICAgIGZvciAodmFyIGkgPSAwOyBpIDwgc2VsZi5pdGVtcygpLmxlbmd0aDsgaSsrKSB7XG4gICAgICAgICAgICB2YXIgaXRlbSA9IHNlbGYuaXRlbXMoKVtpXS5pdGVtO1xuICAgICAgICAgICAgdmFyIGlzQWN0aXZlID0gc2VsZi5hY3RpdmVJdGVtcy5pbmRleE9mKHNlbGYuaXRlbXMoKVtpXSkgPj0gMCA/IHRydWUgOiBmYWxzZTtcbiAgICAgICAgICAgIGlmICghc2VsZi5pdGVtcygpW2ldLmVuYWJsZWQoKSkgY29udGludWU7XG4gICAgICAgICAgICBmb3IgKHZhciBqID0gMDtqIDwgbXkucHJvdG90eXBlLml0ZW1EYXRhWydpdGVtXycgKyBpdGVtXS5hdHRyaWJ1dGVzLmxlbmd0aDsgaisrKSB7XG4gICAgICAgICAgICAgICAgdmFyIGF0dHJpYnV0ZSA9IG15LnByb3RvdHlwZS5pdGVtRGF0YVsnaXRlbV8nICsgaXRlbV0uYXR0cmlidXRlc1tqXTtcbiAgICAgICAgICAgICAgICBpZiAoYXR0cmlidXRlTGlzdC5maW5kKGZ1bmN0aW9uIChhKSB7IHJldHVybiBhdHRyaWJ1dGUubmFtZSA9PSBhLm5hbWU7IH0pKSBjb250aW51ZTtcbiAgICAgICAgICAgICAgICBzd2l0Y2goYXR0cmlidXRlLm5hbWUpIHtcbiAgICAgICAgICAgICAgICAgICAgLy8gZHJhZ29uX2xhbmNlXG4gICAgICAgICAgICAgICAgICAgIGNhc2UgJ2Jhc2VfYXR0YWNrX3JhbmdlJzpcbiAgICAgICAgICAgICAgICAgICAgICAgIGlmIChhdHRhY2t0eXBlID09ICdET1RBX1VOSVRfQ0FQX1JBTkdFRF9BVFRBQ0snKSBhdHRyaWJ1dGVMaXN0LnB1c2goeyduYW1lJzphdHRyaWJ1dGUubmFtZSwgJ3ZhbHVlJzogcGFyc2VJbnQoYXR0cmlidXRlLnZhbHVlWzBdKX0pO1xuICAgICAgICAgICAgICAgICAgICBicmVhaztcbiAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICB9XG4gICAgICAgIH1cbiAgICAgICAgXG4gICAgICAgIHRvdGFsQXR0cmlidXRlID0gYXR0cmlidXRlTGlzdC5yZWR1Y2UoZnVuY3Rpb24gKG1lbW8sIGF0dHJpYnV0ZSkge1xuICAgICAgICAgICAgcmV0dXJuIG1lbW8gKz0gYXR0cmlidXRlLnZhbHVlO1xuICAgICAgICB9LCAwKTtcbiAgICAgICAgcmV0dXJuIHt2YWx1ZTogdG90YWxBdHRyaWJ1dGUsIGF0dHJpYnV0ZXM6IGF0dHJpYnV0ZUxpc3R9O1xuICAgIH07XG4gICAgXG4gICAgc2VsZi5nZXRNaXNzQ2hhbmNlID0gZnVuY3Rpb24gKGUpIHtcbiAgICAgICAgdmFyIHRvdGFsQXR0cmlidXRlID0gMSxcbiAgICAgICAgICAgIGV4Y2x1ZGVMaXN0ID0gZSB8fCBbXTtcbiAgICAgICAgZm9yICh2YXIgaSA9IDA7IGkgPCBzZWxmLml0ZW1zKCkubGVuZ3RoOyBpKyspIHtcbiAgICAgICAgICAgIHZhciBpdGVtID0gc2VsZi5pdGVtcygpW2ldLml0ZW07XG4gICAgICAgICAgICB2YXIgaXNBY3RpdmUgPSBzZWxmLmFjdGl2ZUl0ZW1zLmluZGV4T2Yoc2VsZi5pdGVtcygpW2ldKSA+PSAwID8gdHJ1ZSA6IGZhbHNlO1xuICAgICAgICAgICAgaWYgKCFzZWxmLml0ZW1zKClbaV0uZW5hYmxlZCgpKSBjb250aW51ZTtcbiAgICAgICAgICAgIGZvciAodmFyIGogPSAwOyBqIDwgbXkucHJvdG90eXBlLml0ZW1EYXRhWydpdGVtXycgKyBpdGVtXS5hdHRyaWJ1dGVzLmxlbmd0aDsgaisrKSB7XG4gICAgICAgICAgICAgICAgdmFyIGF0dHJpYnV0ZSA9IG15LnByb3RvdHlwZS5pdGVtRGF0YVsnaXRlbV8nICsgaXRlbV0uYXR0cmlidXRlc1tqXTtcbiAgICAgICAgICAgICAgICBpZiAoZXhjbHVkZUxpc3QuaW5kZXhPZihhdHRyaWJ1dGUubmFtZSkgPiAtMSkgY29udGludWU7XG4gICAgICAgICAgICAgICAgc3dpdGNoKGF0dHJpYnV0ZS5uYW1lKSB7XG4gICAgICAgICAgICAgICAgICAgIGNhc2UgJ21pc3NfY2hhbmNlJzpcbiAgICAgICAgICAgICAgICAgICAgICAgIHRvdGFsQXR0cmlidXRlICo9ICgxIC0gcGFyc2VJbnQoYXR0cmlidXRlLnZhbHVlWzBdKSAvIDEwMCk7XG4gICAgICAgICAgICAgICAgICAgICAgICBleGNsdWRlTGlzdC5wdXNoKGF0dHJpYnV0ZS5uYW1lKTtcbiAgICAgICAgICAgICAgICAgICAgYnJlYWs7XG4gICAgICAgICAgICAgICAgICAgIGNhc2UgJ2JsaW5kX3BjdCc6XG4gICAgICAgICAgICAgICAgICAgICAgICB0b3RhbEF0dHJpYnV0ZSAqPSAoMSAtIHBhcnNlSW50KGF0dHJpYnV0ZS52YWx1ZVswXSkgLyAxMDApO1xuICAgICAgICAgICAgICAgICAgICAgICAgZXhjbHVkZUxpc3QucHVzaChhdHRyaWJ1dGUubmFtZSk7XG4gICAgICAgICAgICAgICAgICAgIGJyZWFrO1xuICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgIH1cbiAgICAgICAgfVxuICAgICAgICByZXR1cm4ge3ZhbHVlOiB0b3RhbEF0dHJpYnV0ZSwgZXhjbHVkZUxpc3Q6IGV4Y2x1ZGVMaXN0fTtcbiAgICB9O1xuICAgIFxuICAgIHNlbGYuZ2V0QmFzZURhbWFnZVJlZHVjdGlvblBjdCA9IGZ1bmN0aW9uICgpIHtcbiAgICAgICAgdmFyIHRvdGFsQXR0cmlidXRlID0gMTtcbiAgICAgICAgZm9yICh2YXIgaSA9IDA7IGkgPCBzZWxmLml0ZW1zKCkubGVuZ3RoOyBpKyspIHtcbiAgICAgICAgICAgIHZhciBpdGVtID0gc2VsZi5pdGVtcygpW2ldLml0ZW07XG4gICAgICAgICAgICB2YXIgaXNBY3RpdmUgPSBzZWxmLmFjdGl2ZUl0ZW1zLmluZGV4T2Yoc2VsZi5pdGVtcygpW2ldKSA+PSAwID8gdHJ1ZSA6IGZhbHNlO1xuICAgICAgICAgICAgaWYgKCFzZWxmLml0ZW1zKClbaV0uZW5hYmxlZCgpKSBjb250aW51ZTtcbiAgICAgICAgICAgIGZvciAodmFyIGogPSAwOyBqIDwgbXkucHJvdG90eXBlLml0ZW1EYXRhWydpdGVtXycgKyBpdGVtXS5hdHRyaWJ1dGVzLmxlbmd0aDsgaisrKSB7XG4gICAgICAgICAgICAgICAgdmFyIGF0dHJpYnV0ZSA9IG15LnByb3RvdHlwZS5pdGVtRGF0YVsnaXRlbV8nICsgaXRlbV0uYXR0cmlidXRlc1tqXTtcbiAgICAgICAgICAgICAgICBzd2l0Y2goYXR0cmlidXRlLm5hbWUpIHtcbiAgICAgICAgICAgICAgICAgICAgY2FzZSAnYmFja3N0YWJfcmVkdWN0aW9uJzpcbiAgICAgICAgICAgICAgICAgICAgICAgIGlmIChzZWxmLml0ZW1zKClbaV0uZGVidWZmICYmIHNlbGYuaXRlbXMoKVtpXS5kZWJ1ZmYgPT0gJ3NoYWRvd193YWxrJykge1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgIHRvdGFsQXR0cmlidXRlICo9ICgxICsgcGFyc2VJbnQoYXR0cmlidXRlLnZhbHVlWzBdKSAvIDEwMCk7XG4gICAgICAgICAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgICAgICAgIGJyZWFrO1xuICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgIH1cbiAgICAgICAgfVxuICAgICAgICByZXR1cm4gdG90YWxBdHRyaWJ1dGU7XG4gICAgfTsgICAgXG4gICAgc2VsZi5nZXRCb251c0RhbWFnZVJlZHVjdGlvblBjdCA9IGZ1bmN0aW9uICgpIHtcbiAgICAgICAgdmFyIHRvdGFsQXR0cmlidXRlID0gMTtcbiAgICAgICAgZm9yICh2YXIgaSA9IDA7IGkgPCBzZWxmLml0ZW1zKCkubGVuZ3RoOyBpKyspIHtcbiAgICAgICAgICAgIHZhciBpdGVtID0gc2VsZi5pdGVtcygpW2ldLml0ZW07XG4gICAgICAgICAgICB2YXIgaXNBY3RpdmUgPSBzZWxmLmFjdGl2ZUl0ZW1zLmluZGV4T2Yoc2VsZi5pdGVtcygpW2ldKSA+PSAwID8gdHJ1ZSA6IGZhbHNlO1xuICAgICAgICAgICAgaWYgKCFzZWxmLml0ZW1zKClbaV0uZW5hYmxlZCgpKSBjb250aW51ZTtcbiAgICAgICAgICAgIGZvciAodmFyIGogPSAwOyBqIDwgbXkucHJvdG90eXBlLml0ZW1EYXRhWydpdGVtXycgKyBpdGVtXS5hdHRyaWJ1dGVzLmxlbmd0aDsgaisrKSB7XG4gICAgICAgICAgICAgICAgdmFyIGF0dHJpYnV0ZSA9IG15LnByb3RvdHlwZS5pdGVtRGF0YVsnaXRlbV8nICsgaXRlbV0uYXR0cmlidXRlc1tqXTtcbiAgICAgICAgICAgICAgICBzd2l0Y2goYXR0cmlidXRlLm5hbWUpIHtcbiAgICAgICAgICAgICAgICAgICAgY2FzZSAnYmFja3N0YWJfcmVkdWN0aW9uJzpcbiAgICAgICAgICAgICAgICAgICAgICAgIGlmIChzZWxmLml0ZW1zKClbaV0uZGVidWZmICYmIHNlbGYuaXRlbXMoKVtpXS5kZWJ1ZmYgPT0gJ3NoYWRvd193YWxrJykge1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgIHRvdGFsQXR0cmlidXRlICo9ICgxICsgcGFyc2VJbnQoYXR0cmlidXRlLnZhbHVlWzBdKSAvIDEwMCk7XG4gICAgICAgICAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgICAgICAgIGJyZWFrO1xuICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgIH1cbiAgICAgICAgfVxuICAgICAgICByZXR1cm4gdG90YWxBdHRyaWJ1dGU7XG4gICAgfTsgICAgXG4gICAgXG4gICAgc2VsZi5pdGVtT3B0aW9ucyA9IGtvLm9ic2VydmFibGVBcnJheShteS5wcm90b3R5cGUuaXRlbU9wdGlvbnNBcnIpO1xuICAgIFxuICAgIHNlbGYuaXRlbUJ1ZmZPcHRpb25zID0ga28ub2JzZXJ2YWJsZUFycmF5KG15LnByb3RvdHlwZS5pdGVtQnVmZk9wdGlvbnMpO1xuICAgIHNlbGYuc2VsZWN0ZWRJdGVtQnVmZiA9IGtvLm9ic2VydmFibGUoJ2Fzc2F1bHQnKTtcblxuICAgIHNlbGYuaXRlbURlYnVmZk9wdGlvbnMgPSBrby5vYnNlcnZhYmxlQXJyYXkobXkucHJvdG90eXBlLml0ZW1EZWJ1ZmZPcHRpb25zKTtcbiAgICBzZWxmLnNlbGVjdGVkSXRlbURlYnVmZiA9IGtvLm9ic2VydmFibGUoJ2Fzc2F1bHQnKTtcbiAgICBcbiAgICByZXR1cm4gc2VsZjtcbn07IiwiJ3VzZSBzdHJpY3QnO1xudmFyIGtvID0gKHR5cGVvZiB3aW5kb3cgIT09IFwidW5kZWZpbmVkXCIgPyB3aW5kb3dbJ2tvJ10gOiB0eXBlb2YgZ2xvYmFsICE9PSBcInVuZGVmaW5lZFwiID8gZ2xvYmFsWydrbyddIDogbnVsbCk7XG5cbmtvLm1hcHBpbmcgPSByZXF1aXJlKCcuLi9saWIva25vY2tvdXQubWFwcGluZycpO1xua28ud3JhcCA9IHJlcXVpcmUoJy4uL2xpYi9rbm9ja291dC53cmFwJyk7XG5cbmtvLmV4dGVuZGVycy5udW1lcmljID0gZnVuY3Rpb24odGFyZ2V0LCBwcmVjaXNpb24pIHtcbiAgICAvL2NyZWF0ZSBhIHdyaXRlYWJsZSBjb21wdXRlZCBvYnNlcnZhYmxlIHRvIGludGVyY2VwdCB3cml0ZXMgdG8gb3VyIG9ic2VydmFibGVcbiAgICB2YXIgcmVzdWx0ID0ga28uY29tcHV0ZWQoe1xuICAgICAgICByZWFkOiB0YXJnZXQsICAvL2Fsd2F5cyByZXR1cm4gdGhlIG9yaWdpbmFsIG9ic2VydmFibGVzIHZhbHVlXG4gICAgICAgIHdyaXRlOiBmdW5jdGlvbihuZXdWYWx1ZSkge1xuICAgICAgICAgICAgdmFyIGN1cnJlbnQgPSB0YXJnZXQoKSxcbiAgICAgICAgICAgICAgICByb3VuZGluZ011bHRpcGxpZXIgPSBNYXRoLnBvdygxMCwgcHJlY2lzaW9uKSxcbiAgICAgICAgICAgICAgICBuZXdWYWx1ZUFzTnVtID0gaXNOYU4obmV3VmFsdWUpID8gMCA6IHBhcnNlRmxvYXQoK25ld1ZhbHVlKSxcbiAgICAgICAgICAgICAgICB2YWx1ZVRvV3JpdGUgPSBNYXRoLnJvdW5kKG5ld1ZhbHVlQXNOdW0gKiByb3VuZGluZ011bHRpcGxpZXIpIC8gcm91bmRpbmdNdWx0aXBsaWVyO1xuIFxuICAgICAgICAgICAgLy9vbmx5IHdyaXRlIGlmIGl0IGNoYW5nZWRcbiAgICAgICAgICAgIGlmICh2YWx1ZVRvV3JpdGUgIT09IGN1cnJlbnQpIHtcbiAgICAgICAgICAgICAgICB0YXJnZXQodmFsdWVUb1dyaXRlKTtcbiAgICAgICAgICAgIH0gZWxzZSB7XG4gICAgICAgICAgICAgICAgLy9pZiB0aGUgcm91bmRlZCB2YWx1ZSBpcyB0aGUgc2FtZSwgYnV0IGEgZGlmZmVyZW50IHZhbHVlIHdhcyB3cml0dGVuLCBmb3JjZSBhIG5vdGlmaWNhdGlvbiBmb3IgdGhlIGN1cnJlbnQgZmllbGRcbiAgICAgICAgICAgICAgICBpZiAobmV3VmFsdWUgIT09IGN1cnJlbnQpIHtcbiAgICAgICAgICAgICAgICAgICAgdGFyZ2V0Lm5vdGlmeVN1YnNjcmliZXJzKHZhbHVlVG9Xcml0ZSk7XG4gICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgfVxuICAgICAgICB9XG4gICAgfSkuZXh0ZW5kKHsgbm90aWZ5OiAnYWx3YXlzJyB9KTtcbiBcbiAgICAvL2luaXRpYWxpemUgd2l0aCBjdXJyZW50IHZhbHVlIHRvIG1ha2Ugc3VyZSBpdCBpcyByb3VuZGVkIGFwcHJvcHJpYXRlbHlcbiAgICByZXN1bHQodGFyZ2V0KCkpO1xuIFxuICAgIC8vcmV0dXJuIHRoZSBuZXcgY29tcHV0ZWQgb2JzZXJ2YWJsZVxuICAgIHJldHVybiByZXN1bHQ7XG59O1xuXG5tb2R1bGUuZXhwb3J0cyA9IGtvOyIsIid1c2Ugc3RyaWN0JztcbnZhciAkID0gKHR5cGVvZiB3aW5kb3cgIT09IFwidW5kZWZpbmVkXCIgPyB3aW5kb3dbJyQnXSA6IHR5cGVvZiBnbG9iYWwgIT09IFwidW5kZWZpbmVkXCIgPyBnbG9iYWxbJyQnXSA6IG51bGwpO1xuXG52YXIgYWJpbGl0eV92YXJzID0ge1xuICAgICckaGVhbHRoJzogJ0hlYWx0aCcsXG4gICAgJyRtYW5hJzogJ01hbmEnLFxuICAgICckYXJtb3InOiAnQXJtb3InLFxuICAgICckZGFtYWdlJzogJ0RhbWFnZScsXG4gICAgJyRzdHInOiAnU3RyZW5ndGgnLFxuICAgICckaW50JzogJ0ludGVsbGlnZW5jZScsXG4gICAgJyRhZ2knOiAnQWdpbGl0eScsXG4gICAgJyRhbGwnOiAnQWxsIEF0dHJpYnV0ZXMnLFxuICAgICckYXR0YWNrJzogJ0F0dGFjayBTcGVlZCcsXG4gICAgJyRocF9yZWdlbic6ICdIUCBSZWdlbmVyYXRpb24nLFxuICAgICckbWFuYV9yZWdlbic6ICdNYW5hIFJlZ2VuZXJhdGlvbicsXG4gICAgJyRtb3ZlX3NwZWVkJzogJ01vdmVtZW50IFNwZWVkJyxcbiAgICAnJGV2YXNpb24nOiAnRXZhc2lvbicsXG4gICAgJyRzcGVsbF9yZXNpc3QnOiAnU3BlbGwgUmVzaXN0YW5jZScsXG4gICAgJyRzZWxlY3RlZF9hdHRyaWJ1dGUnOiAnU2VsZWN0ZWQgQXR0cmlidXRlJyxcbiAgICAnJHNlbGVjdGVkX2F0dHJpYic6ICdTZWxlY3RlZCBBdHRyaWJ1dGUnLFxuICAgICckY2FzdF9yYW5nZSc6ICdDYXN0IFJhbmdlJyxcbiAgICAnJGF0dGFja19yYW5nZSc6ICdBdHRhY2sgUmFuZ2UnXG59XG52YXIgYWJpbGl0eVRvb2x0aXBEYXRhID0ge307XG52YXIgYWJpbGl0eURhbWFnZVR5cGVzID0ge1xuICAgICdEQU1BR0VfVFlQRV9NQUdJQ0FMJzogJ01hZ2ljYWwnLFxuICAgICdEQU1BR0VfVFlQRV9QVVJFJzogJ1B1cmUnLFxuICAgICdEQU1BR0VfVFlQRV9QSFlTSUNBTCc6ICdQaHlzaWNhbCcsXG4gICAgJ0RBTUFHRV9UWVBFX0NPTVBPU0lURSc6ICdDb21wb3NpdGUnLFxuICAgICdEQU1BR0VfVFlQRV9IUF9SRU1PVkFMJzogJ0hQIFJlbW92YWwnXG59XG5cbnZhciBnZXRUb29sdGlwQWJpbGl0eURlc2NyaXB0aW9uID0gZnVuY3Rpb24gKGl0ZW0pIHtcbiAgICB2YXIgZCA9IGl0ZW0uZGVzY3JpcHRpb247XG4gICAgZm9yICh2YXIgaSA9IDA7IGkgPCBpdGVtLmF0dHJpYnV0ZXMubGVuZ3RoOyBpKyspIHtcbiAgICAgICAgaWYgKGl0ZW0uYXR0cmlidXRlc1tpXS5uYW1lICE9IG51bGwpIHtcbiAgICAgICAgICAgIHZhciBhdHRyaWJ1dGVOYW1lID0gaXRlbS5hdHRyaWJ1dGVzW2ldLm5hbWU7XG4gICAgICAgICAgICB2YXIgYXR0cmlidXRlVmFsdWUgPSBpdGVtLmF0dHJpYnV0ZXNbaV0udmFsdWVbMF07XG4gICAgICAgICAgICBmb3IgKHZhciBqID0gMTsgaiA8IGl0ZW0uYXR0cmlidXRlc1tpXS52YWx1ZS5sZW5ndGg7IGorKykge1xuICAgICAgICAgICAgICAgIGF0dHJpYnV0ZVZhbHVlICs9ICcgLyAnICsgaXRlbS5hdHRyaWJ1dGVzW2ldLnZhbHVlW2pdO1xuICAgICAgICAgICAgfVxuICAgICAgICAgICAgcmVnZXhwID0gbmV3IFJlZ0V4cCgnJScgKyBhdHRyaWJ1dGVOYW1lICsgJyUnLCAnZ2knKTtcbiAgICAgICAgICAgIGQgPSBkLnJlcGxhY2UocmVnZXhwLCBhdHRyaWJ1dGVWYWx1ZSk7XG4gICAgICAgIH1cbiAgICB9XG4gICAgdmFyIHJlZ2V4cCA9IG5ldyBSZWdFeHAoJyUlJywgJ2dpJyk7XG4gICAgZCA9IGQucmVwbGFjZShyZWdleHAsICclJyk7XG4gICAgcmVnZXhwID0gbmV3IFJlZ0V4cCgnXFxuJywgJ2dpJyk7XG4gICAgZCA9IGQucmVwbGFjZSgvXFxcXG4vZywgJzxicj4nKTtcbiAgICByZXR1cm4gZDtcbn1cblxudmFyIGdldFRvb2x0aXBBYmlsaXR5QXR0cmlidXRlcyA9IGZ1bmN0aW9uIChpdGVtKSB7XG4gICAgdmFyIGEgPSAnJztcbiAgICBpZiAoaXRlbS5kYW1hZ2UubGVuZ3RoID4gMCAmJiBpdGVtLmRhbWFnZS5yZWR1Y2UoZnVuY3Rpb24obWVtbywgbnVtKXsgcmV0dXJuIG1lbW8gKyBudW07IH0sIDApID4gMCkge1xuICAgICAgICB2YXIgYXR0cmlidXRlVG9vbHRpcCA9ICdEQU1BR0U6ICc7XG4gICAgICAgIHZhciBhdHRyaWJ1dGVWYWx1ZSA9IGl0ZW0uZGFtYWdlWzBdO1xuICAgICAgICBmb3IgKHZhciBqID0gMTsgaiA8IGl0ZW0uZGFtYWdlLmxlbmd0aDsgaisrKSB7XG4gICAgICAgICAgICBhdHRyaWJ1dGVWYWx1ZSArPSAnIC8gJyArIGl0ZW0uZGFtYWdlW2pdO1xuICAgICAgICB9XG4gICAgICAgIGEgPSBhICsgYXR0cmlidXRlVG9vbHRpcCArICcgJyArIGF0dHJpYnV0ZVZhbHVlICsgJzxicj4nO1xuICAgIH1cbiAgICBmb3IgKHZhciBpID0gMDsgaSA8IGl0ZW0uYXR0cmlidXRlcy5sZW5ndGg7IGkrKykge1xuICAgICAgICBpZiAoaXRlbS5hdHRyaWJ1dGVzW2ldLnRvb2x0aXAgIT0gbnVsbCkge1xuICAgICAgICAgICAgdmFyIGF0dHJpYnV0ZVRvb2x0aXAgPSBpdGVtLmF0dHJpYnV0ZXNbaV0udG9vbHRpcDtcbiAgICAgICAgICAgIGF0dHJpYnV0ZVRvb2x0aXAgPSBhdHRyaWJ1dGVUb29sdGlwLnJlcGxhY2UoL1xcXFxuL2csICcnKTtcbiAgICAgICAgICAgIHZhciBhdHRyaWJ1dGVWYWx1ZSA9IGl0ZW0uYXR0cmlidXRlc1tpXS52YWx1ZVswXTtcbiAgICAgICAgICAgIGZvciAodmFyIGogPSAxOyBqIDwgaXRlbS5hdHRyaWJ1dGVzW2ldLnZhbHVlLmxlbmd0aDsgaisrKSB7XG4gICAgICAgICAgICAgICAgYXR0cmlidXRlVmFsdWUgKz0gJyAvICcgKyBpdGVtLmF0dHJpYnV0ZXNbaV0udmFsdWVbal07XG4gICAgICAgICAgICB9XG4gICAgICAgICAgICB2YXIgcCA9IGF0dHJpYnV0ZVRvb2x0aXAuaW5kZXhPZignJScpO1xuICAgICAgICAgICAgaWYgKHAgPT0gMCkge1xuICAgICAgICAgICAgICAgIGlmIChhdHRyaWJ1dGVWYWx1ZS50b1N0cmluZygpLmluZGV4T2YoJy8nKSA9PSAtMSkge1xuICAgICAgICAgICAgICAgICAgICBhdHRyaWJ1dGVWYWx1ZSA9IGF0dHJpYnV0ZVZhbHVlLnRvU3RyaW5nKCkudHJpbSgpICsgJyUnO1xuICAgICAgICAgICAgICAgIH0gZWxzZSB7XG4gICAgICAgICAgICAgICAgICAgIC8vdmFyIHJlZ2V4cDIgPSBuZXcgUmVnRXhwKCcvJywgJ2dpJyk7XG4gICAgICAgICAgICAgICAgICAgIC8vYXR0cmlidXRlVmFsdWUgPSBhdHRyaWJ1dGVWYWx1ZS5yZXBsYWNlKHJlZ2V4cDIsICclLycpICsgJyUnO1xuICAgICAgICAgICAgICAgICAgICB2YXIgYXR0cmlidXRlVmFsdWVzID0gYXR0cmlidXRlVmFsdWUuc3BsaXQoJy8nKTtcbiAgICAgICAgICAgICAgICAgICAgdmFyIHRyaW1tZWRBdHRyaWJ1dGVWYWx1ZXMgPSBhdHRyaWJ1dGVWYWx1ZXMubWFwKGZ1bmN0aW9uKHYpIHtcbiAgICAgICAgICAgICAgICAgICAgICAgIHJldHVybiB2LnRyaW0oKTtcbiAgICAgICAgICAgICAgICAgICAgfSk7XG4gICAgICAgICAgICAgICAgICAgIGF0dHJpYnV0ZVZhbHVlID0gdHJpbW1lZEF0dHJpYnV0ZVZhbHVlcy5qb2luKCclIC8gJykgKyAnJSc7XG4gICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICAgIGF0dHJpYnV0ZVRvb2x0aXAgPSBhdHRyaWJ1dGVUb29sdGlwLnNsaWNlKDEpO1xuICAgICAgICAgICAgfVxuICAgICAgICAgICAgdmFyIGQgPSBhdHRyaWJ1dGVUb29sdGlwLmluZGV4T2YoJyQnKTtcbiAgICAgICAgICAgIGEgPSBhICsgYXR0cmlidXRlVG9vbHRpcCArICcgJyArIGF0dHJpYnV0ZVZhbHVlICsgJzxicj4nO1xuICAgICAgICB9XG4gICAgfVxuICAgIHJldHVybiBhLnRyaW0oJzxicj4nKTtcbn1cblxudmFyIGdldFRvb2x0aXBBYmlsaXR5TWFuYUNvc3QgPSBmdW5jdGlvbiAoaXRlbSkge1xuICAgIHZhciBjID0gJyc7XG4gICAgaWYgKGl0ZW0ubWFuYWNvc3QucmVkdWNlKGZ1bmN0aW9uKG1lbW8sIG51bSl7IHJldHVybiBtZW1vICsgbnVtOyB9LCAwKSA9PSAwKSB7XG4gICAgICAgIHJldHVybiBjO1xuICAgIH1cbiAgICBpZiAoaXRlbS5tYW5hY29zdC5ldmVyeShmdW5jdGlvbihudW0pIHsgcmV0dXJuIG51bSA9PSBpdGVtLm1hbmFjb3N0WzBdOyB9KSkge1xuICAgICAgICByZXR1cm4gaXRlbS5tYW5hY29zdFswXS50b1N0cmluZygpO1xuICAgIH1cbiAgICBmb3IgKHZhciBpID0gMDsgaSA8IDQ7IGkrKykge1xuICAgICAgICBpZiAoaXRlbS5tYW5hY29zdFtpXSAhPSBudWxsKSB7XG4gICAgICAgICAgICBjID0gYyArICcgJyArIGl0ZW0ubWFuYWNvc3RbaV07XG4gICAgICAgIH1cbiAgICB9XG4gICAgcmV0dXJuIGM7XG59XG5cbnZhciBnZXRUb29sdGlwQWJpbGl0eUNvb2xkb3duID0gZnVuY3Rpb24gKGl0ZW0pIHtcbiAgICB2YXIgYyA9ICcnO1xuICAgIGlmIChpdGVtLmNvb2xkb3duLnJlZHVjZShmdW5jdGlvbihtZW1vLCBudW0peyByZXR1cm4gbWVtbyArIG51bTsgfSwgMCkgPT0gMCkge1xuICAgICAgICByZXR1cm4gYztcbiAgICB9XG4gICAgaWYgKGl0ZW0uY29vbGRvd24uZXZlcnkoZnVuY3Rpb24obnVtKSB7IHJldHVybiBudW0gPT0gaXRlbS5jb29sZG93blswXTsgfSkpIHtcbiAgICAgICAgcmV0dXJuIGl0ZW0uY29vbGRvd25bMF0udG9TdHJpbmcoKTtcbiAgICB9XG4gICAgZm9yICh2YXIgaSA9IDA7IGkgPCA0OyBpKyspIHtcbiAgICAgICAgaWYgKGl0ZW0uY29vbGRvd25baV0gIT0gbnVsbCkge1xuICAgICAgICAgICAgYyA9IGMgKyAnICcgKyBpdGVtLmNvb2xkb3duW2ldO1xuICAgICAgICB9XG4gICAgfVxuICAgIHJldHVybiBjO1xufVxuICAgIFxudmFyIGdldEFiaWxpdHlUb29sdGlwRGF0YSA9IGZ1bmN0aW9uKGhlcm9EYXRhLCB1bml0RGF0YSwgaGVybywgZWwpIHtcbiAgICBpZiAoYWJpbGl0eVRvb2x0aXBEYXRhW2VsXSA9PSB1bmRlZmluZWQpIHtcbiAgICAgICAgdmFyIGFiaWxpdHlOYW1lID0gZWxcbiAgICAgICAgdmFyIGFiaWxpdHkgPSB7fTtcbiAgICAgICAgaWYgKGhlcm9EYXRhW2hlcm9dID09IHVuZGVmaW5lZCkge1xuICAgICAgICAgICAgZm9yICh2YXIgaSA9IDA7IGkgPCB1bml0RGF0YVtoZXJvXS5hYmlsaXRpZXMubGVuZ3RoOyBpKyspIHtcbiAgICAgICAgICAgICAgICBpZiAodW5pdERhdGFbaGVyb10uYWJpbGl0aWVzW2ldLm5hbWUgPT0gZWwpIHtcbiAgICAgICAgICAgICAgICAgICAgYWJpbGl0eSA9IHVuaXREYXRhW2hlcm9dLmFiaWxpdGllc1tpXTtcbiAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICB9ICAgICAgICAgICAgXG4gICAgICAgIH1cbiAgICAgICAgZWxzZSB7XG4gICAgICAgICAgICBmb3IgKHZhciBpID0gMDsgaSA8IGhlcm9EYXRhW2hlcm9dLmFiaWxpdGllcy5sZW5ndGg7IGkrKykge1xuICAgICAgICAgICAgICAgIGlmIChoZXJvRGF0YVtoZXJvXS5hYmlsaXRpZXNbaV0ubmFtZSA9PSBlbCkge1xuICAgICAgICAgICAgICAgICAgICBhYmlsaXR5ID0gaGVyb0RhdGFbaGVyb10uYWJpbGl0aWVzW2ldO1xuICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgIH1cbiAgICAgICAgfVxuICAgICAgICB2YXIgZGF0YSA9ICQoJzxkaXY+JylcbiAgICAgICAgZGF0YS5hcHBlbmQoJCgnPHNwYW4+JykuaHRtbChhYmlsaXR5LmRpc3BsYXluYW1lKS5hZGRDbGFzcygnaXRlbV9maWVsZCBwdWxsLWxlZnQgaXRlbV9uYW1lJykpO1xuICAgICAgICBpZiAoYWJpbGl0eS5hYmlsaXR5dW5pdGRhbWFnZXR5cGUpIHtcbiAgICAgICAgICAgIGRhdGEuYXBwZW5kKCQoJzxzcGFuPicpLmh0bWwoYWJpbGl0eURhbWFnZVR5cGVzW2FiaWxpdHkuYWJpbGl0eXVuaXRkYW1hZ2V0eXBlXSkuYWRkQ2xhc3MoJ2l0ZW1fZmllbGQgcHVsbC1yaWdodCBpdGVtX2FiaWxpdHlfZGFtYWdlX3R5cGUnKS5jc3MoJ21hcmdpbi1yaWdodCcsJzEwcHgnKSk7XG4gICAgICAgIH1cbiAgICAgICAgZGF0YS5hcHBlbmQoJCgnPGhyPicpLmNzcygnY2xlYXInLCAnYm90aCcpKTtcbiAgICAgICAgaWYgKGFiaWxpdHkuZGVzY3JpcHRpb24gIT0gbnVsbCkge1xuICAgICAgICAgICAgZGF0YS5hcHBlbmQoJCgnPGRpdj4nKS5odG1sKGdldFRvb2x0aXBBYmlsaXR5RGVzY3JpcHRpb24oYWJpbGl0eSkpLmFkZENsYXNzKCdpdGVtX2ZpZWxkIGl0ZW1fZGVzY3JpcHRpb24nKSk7XG4gICAgICAgIH1cbiAgICAgICAgdmFyIGF0dHJpYnV0ZWRhdGEgPSBnZXRUb29sdGlwQWJpbGl0eUF0dHJpYnV0ZXMoYWJpbGl0eSk7XG4gICAgICAgIGlmIChhdHRyaWJ1dGVkYXRhICE9ICcnKSB7XG4gICAgICAgICAgICBkYXRhLmFwcGVuZCgkKCc8ZGl2PicpLmh0bWwoYXR0cmlidXRlZGF0YSkuYWRkQ2xhc3MoJ2l0ZW1fZmllbGQgaXRlbV9hdHRyaWJ1dGVzJykpO1xuICAgICAgICB9XG4gICAgICAgIHZhciBjZCA9IGdldFRvb2x0aXBBYmlsaXR5Q29vbGRvd24oYWJpbGl0eSk7XG4gICAgICAgIHZhciBtYW5hID0gZ2V0VG9vbHRpcEFiaWxpdHlNYW5hQ29zdChhYmlsaXR5KTtcbiAgICAgICAgaWYgKGNkICE9ICcnIHx8IG1hbmEgIT0gJycpIHtcbiAgICAgICAgICAgIHZhciBjZG1hbmFjb3N0ID0gJCgnPGRpdj4nKS5hZGRDbGFzcygnaXRlbV9jZG1hbmEnKTtcbiAgICAgICAgICAgIGlmIChtYW5hICE9ICcnKSB7XG4gICAgICAgICAgICAgICAgY2RtYW5hY29zdC5hcHBlbmQoJCgnPHNwYW4+JykuaHRtbChtYW5hLnRyaW0oKSkuYWRkQ2xhc3MoJ2l0ZW1fZmllbGQgaXRlbV9tYW5hY29zdCcpKTtcbiAgICAgICAgICAgIH1cbiAgICAgICAgICAgIGlmIChjZCAhPSAnJykge1xuICAgICAgICAgICAgICAgIGNkbWFuYWNvc3QuYXBwZW5kKCQoJzxzcGFuPicpLmh0bWwoY2QudHJpbSgpKS5hZGRDbGFzcygnaXRlbV9maWVsZCBpdGVtX2Nvb2xkb3duJykpO1xuICAgICAgICAgICAgfVxuICAgICAgICAgICAgZGF0YS5hcHBlbmQoY2RtYW5hY29zdCk7XG4gICAgICAgIH1cbiAgICAgICAgaWYgKGFiaWxpdHkubG9yZSAhPSBudWxsKSB7XG4gICAgICAgICAgICBkYXRhLmFwcGVuZCgkKCc8ZGl2PicpLmh0bWwoYWJpbGl0eS5sb3JlKS5hZGRDbGFzcygnaXRlbV9maWVsZCBpdGVtX2xvcmUnKSk7XG4gICAgICAgIH1cbiAgICAgICAgYWJpbGl0eVRvb2x0aXBEYXRhW2VsXSA9IGRhdGEuaHRtbCgpO1xuICAgICAgICByZXR1cm4gZGF0YS5odG1sKCk7XG4gICAgfVxuICAgIGVsc2Uge1xuICAgICAgICByZXR1cm4gYWJpbGl0eVRvb2x0aXBEYXRhW2VsXTtcbiAgICB9XG59XG5cbm1vZHVsZS5leHBvcnRzID0gZ2V0QWJpbGl0eVRvb2x0aXBEYXRhOyIsIid1c2Ugc3RyaWN0JztcbnZhciAkID0gKHR5cGVvZiB3aW5kb3cgIT09IFwidW5kZWZpbmVkXCIgPyB3aW5kb3dbJyQnXSA6IHR5cGVvZiBnbG9iYWwgIT09IFwidW5kZWZpbmVkXCIgPyBnbG9iYWxbJyQnXSA6IG51bGwpO1xuXG52YXIgaXRlbXRvb2x0aXBkYXRhID0ge307XG52YXIgYWJpbGl0eV92YXJzID0ge1xuICAgICckaGVhbHRoJzogJ0hlYWx0aCcsXG4gICAgJyRtYW5hJzogJ01hbmEnLFxuICAgICckYXJtb3InOiAnQXJtb3InLFxuICAgICckZGFtYWdlJzogJ0RhbWFnZScsXG4gICAgJyRzdHInOiAnU3RyZW5ndGgnLFxuICAgICckaW50JzogJ0ludGVsbGlnZW5jZScsXG4gICAgJyRhZ2knOiAnQWdpbGl0eScsXG4gICAgJyRhbGwnOiAnQWxsIEF0dHJpYnV0ZXMnLFxuICAgICckYXR0YWNrJzogJ0F0dGFjayBTcGVlZCcsXG4gICAgJyRocF9yZWdlbic6ICdIUCBSZWdlbmVyYXRpb24nLFxuICAgICckbWFuYV9yZWdlbic6ICdNYW5hIFJlZ2VuZXJhdGlvbicsXG4gICAgJyRtb3ZlX3NwZWVkJzogJ01vdmVtZW50IFNwZWVkJyxcbiAgICAnJGV2YXNpb24nOiAnRXZhc2lvbicsXG4gICAgJyRzcGVsbF9yZXNpc3QnOiAnU3BlbGwgUmVzaXN0YW5jZScsXG4gICAgJyRzZWxlY3RlZF9hdHRyaWJ1dGUnOiAnU2VsZWN0ZWQgQXR0cmlidXRlJyxcbiAgICAnJHNlbGVjdGVkX2F0dHJpYic6ICdTZWxlY3RlZCBBdHRyaWJ1dGUnLFxuICAgICckY2FzdF9yYW5nZSc6ICdDYXN0IFJhbmdlJyxcbiAgICAnJGF0dGFja19yYW5nZSc6ICdBdHRhY2sgUmFuZ2UnXG59XG5cbnZhciBnZXRUb29sdGlwSXRlbURlc2NyaXB0aW9uID0gZnVuY3Rpb24gKGl0ZW0pIHtcbiAgICB2YXIgZCA9IGl0ZW0uZGVzY3JpcHRpb247XG4gICAgZm9yICh2YXIgaSA9IDA7IGkgPCBpdGVtLmF0dHJpYnV0ZXMubGVuZ3RoOyBpKyspIHtcbiAgICAgICAgaWYgKGl0ZW0uYXR0cmlidXRlc1tpXS5uYW1lICE9IG51bGwpIHtcbiAgICAgICAgICAgIHZhciBhdHRyaWJ1dGVOYW1lID0gaXRlbS5hdHRyaWJ1dGVzW2ldLm5hbWU7XG4gICAgICAgICAgICB2YXIgYXR0cmlidXRlVmFsdWUgPSBpdGVtLmF0dHJpYnV0ZXNbaV0udmFsdWVbMF07XG4gICAgICAgICAgICBmb3IgKHZhciBqID0gMTsgaiA8IGl0ZW0uYXR0cmlidXRlc1tpXS52YWx1ZS5sZW5ndGg7IGorKykge1xuICAgICAgICAgICAgICAgIGF0dHJpYnV0ZVZhbHVlICs9ICcgLyAnICsgaXRlbS5hdHRyaWJ1dGVzW2ldLnZhbHVlW2pdO1xuICAgICAgICAgICAgfVxuICAgICAgICAgICAgdmFyIHJlZ2V4cCA9IG5ldyBSZWdFeHAoJyUnICsgYXR0cmlidXRlTmFtZSArICclJywgJ2dpJyk7XG4gICAgICAgICAgICBkID0gZC5yZXBsYWNlKHJlZ2V4cCwgYXR0cmlidXRlVmFsdWUgKTtcbiAgICAgICAgfVxuICAgIH1cbiAgICB2YXIgcmVnZXhwID0gbmV3IFJlZ0V4cCgnJSUnLCAnZ2knKTtcbiAgICBkID0gZC5yZXBsYWNlKHJlZ2V4cCwnJScpO1xuICAgIHJlZ2V4cCA9IG5ldyBSZWdFeHAoJ1xcbicsICdnaScpO1xuICAgIGQgPSBkLnJlcGxhY2UoL1xcXFxuL2csICc8YnI+Jyk7XG4gICAgcmV0dXJuIGQ7XG59XG5cbnZhciBnZXRUb29sdGlwSXRlbUF0dHJpYnV0ZXMgPSBmdW5jdGlvbiAoaXRlbSkge1xuICAgIHZhciBhID0gJyc7XG4gICAgZm9yICh2YXIgaSA9IDA7IGkgPCBpdGVtLmF0dHJpYnV0ZXMubGVuZ3RoOyBpKyspIHtcbiAgICAgICAgaWYgKGl0ZW0uYXR0cmlidXRlc1tpXS50b29sdGlwICE9IG51bGwpIHtcbiAgICAgICAgICAgIHZhciBhdHRyaWJ1dGVUb29sdGlwID0gaXRlbS5hdHRyaWJ1dGVzW2ldLnRvb2x0aXA7XG4gICAgICAgICAgICB2YXIgYXR0cmlidXRlVmFsdWUgPSBpdGVtLmF0dHJpYnV0ZXNbaV0udmFsdWVbMF07XG4gICAgICAgICAgICBmb3IgKHZhciBqID0gMTsgaiA8IGl0ZW0uYXR0cmlidXRlc1tpXS52YWx1ZS5sZW5ndGg7IGorKykge1xuICAgICAgICAgICAgICAgIGF0dHJpYnV0ZVZhbHVlICs9ICcgLyAnICsgaXRlbS5hdHRyaWJ1dGVzW2ldLnZhbHVlW2pdO1xuICAgICAgICAgICAgfVxuICAgICAgICAgICAgdmFyIHAgPSBhdHRyaWJ1dGVUb29sdGlwLmluZGV4T2YoJyUnKTtcbiAgICAgICAgICAgIGlmIChwID09IDApIHtcbiAgICAgICAgICAgICAgICBhdHRyaWJ1dGVWYWx1ZSA9IGF0dHJpYnV0ZVZhbHVlICsgJyUnO1xuICAgICAgICAgICAgICAgIGF0dHJpYnV0ZVRvb2x0aXAgPSBhdHRyaWJ1dGVUb29sdGlwLnNsaWNlKDEpO1xuICAgICAgICAgICAgfVxuICAgICAgICAgICAgdmFyIGQgPSBhdHRyaWJ1dGVUb29sdGlwLmluZGV4T2YoJyQnKTtcbiAgICAgICAgICAgIGlmIChkICE9IC0xKSB7XG4gICAgICAgICAgICAgICAgYSA9IGEgKyBhdHRyaWJ1dGVUb29sdGlwLnNsaWNlKDAsIGQpICsgJyAnICsgYXR0cmlidXRlVmFsdWUgKyAnICcgKyBhYmlsaXR5X3ZhcnNbYXR0cmlidXRlVG9vbHRpcC5zbGljZShkKV0gKyAnPGJyPic7XG4gICAgICAgICAgICB9XG4gICAgICAgICAgICBlbHNlIHtcbiAgICAgICAgICAgICAgICBhID0gYSArIGF0dHJpYnV0ZVRvb2x0aXAgKyAnICcgKyBhdHRyaWJ1dGVWYWx1ZSArICc8YnI+JztcbiAgICAgICAgICAgIH1cbiAgICAgICAgfVxuICAgIH1cbiAgICByZXR1cm4gYS50cmltKCc8YnI+Jyk7XG59XG5cbnZhciBnZXRUb29sdGlwSXRlbUNvb2xkb3duID0gZnVuY3Rpb24gKGl0ZW0pIHtcbiAgICB2YXIgYyA9ICcnO1xuICAgIGZvciAodmFyIGkgPSAwOyBpIDwgaXRlbS5jb29sZG93bi5sZW5ndGg7IGkrKykge1xuICAgICAgICBjID0gYyArICcgJyArIGl0ZW0uY29vbGRvd25baV07XG4gICAgfVxuICAgIHJldHVybiBjO1xufVxuXG52YXIgZ2V0VG9vbHRpcEl0ZW1NYW5hQ29zdCA9IGZ1bmN0aW9uIChpdGVtKSB7XG4gICAgdmFyIGMgPSAnJztcbiAgICBmb3IgKHZhciBpID0gMDsgaSA8IGl0ZW0ubWFuYWNvc3QubGVuZ3RoOyBpKyspIHtcbiAgICAgICAgaWYgKGl0ZW0ubWFuYWNvc3RbaV0gPiAwKSB7XG4gICAgICAgICAgICBjID0gYyArICcgJyArIGl0ZW0ubWFuYWNvc3RbaV07XG4gICAgICAgIH1cbiAgICB9XG4gICAgcmV0dXJuIGM7XG59XG5cbnZhciBnZXRJdGVtVG9vbHRpcERhdGEgPSBmdW5jdGlvbihpdGVtRGF0YSwgZWwpIHtcbiAgICBpZiAoaXRlbURhdGFbJ2l0ZW1fJyArIGVsXSA9PSB1bmRlZmluZWQpIHtcbiAgICAgICAgcmV0dXJuIHVuZGVmaW5lZDtcbiAgICB9XG4gICAgaWYgKGl0ZW10b29sdGlwZGF0YVtlbF0gPT0gdW5kZWZpbmVkKSB7XG4gICAgICAgIHZhciBpdGVtID0gaXRlbURhdGFbJ2l0ZW1fJyArIGVsXTtcbiAgICAgICAgdmFyIGRhdGEgPSAkKCc8ZGl2PicpO1xuICAgICAgICBkYXRhLmFwcGVuZCgkKCc8c3Bhbj4nKS5odG1sKGl0ZW0uZGlzcGxheW5hbWUpLmFkZENsYXNzKCdpdGVtX2ZpZWxkIGl0ZW1fbmFtZScpKTtcbiAgICAgICAgZGF0YS5hcHBlbmQoJCgnPHNwYW4+JykuaHRtbChpdGVtLml0ZW1jb3N0KS5hZGRDbGFzcygnaXRlbV9maWVsZCBpdGVtX2Nvc3QnKSk7XG4gICAgICAgIGRhdGEuYXBwZW5kKCQoJzxocj4nKSk7XG4gICAgICAgIGlmIChpdGVtLmRlc2NyaXB0aW9uICE9IG51bGwpIHtcbiAgICAgICAgICAgIGRhdGEuYXBwZW5kKCQoJzxkaXY+JykuaHRtbChnZXRUb29sdGlwSXRlbURlc2NyaXB0aW9uKGl0ZW0pKS5hZGRDbGFzcygnaXRlbV9maWVsZCBpdGVtX2Rlc2NyaXB0aW9uJykpO1xuICAgICAgICB9XG4gICAgICAgIHZhciBhdHRyaWJ1dGVkYXRhID0gZ2V0VG9vbHRpcEl0ZW1BdHRyaWJ1dGVzKGl0ZW0pO1xuICAgICAgICBpZiAoYXR0cmlidXRlZGF0YSAhPSAnJykge1xuICAgICAgICAgICAgZGF0YS5hcHBlbmQoJCgnPGRpdj4nKS5odG1sKGF0dHJpYnV0ZWRhdGEpLmFkZENsYXNzKCdpdGVtX2ZpZWxkIGl0ZW1fYXR0cmlidXRlcycpKTtcbiAgICAgICAgfVxuICAgICAgICB2YXIgY2QgPSBnZXRUb29sdGlwSXRlbUNvb2xkb3duKGl0ZW0pO1xuICAgICAgICB2YXIgbWFuYSA9IGdldFRvb2x0aXBJdGVtTWFuYUNvc3QoaXRlbSk7XG4gICAgICAgIGlmIChjZCAhPSAnJyB8fCBtYW5hICE9ICcnKSB7XG4gICAgICAgICAgICB2YXIgY2RtYW5hY29zdCA9ICQoJzxkaXY+JykuYWRkQ2xhc3MoJ2l0ZW1fY2RtYW5hJyk7XG4gICAgICAgICAgICBpZiAoY2QgIT0gJycpIHtcbiAgICAgICAgICAgICAgICBjZG1hbmFjb3N0LmFwcGVuZCgkKCc8c3Bhbj4nKS5odG1sKGNkKS5hZGRDbGFzcygnaXRlbV9maWVsZCBpdGVtX2Nvb2xkb3duJykpO1xuICAgICAgICAgICAgfVxuICAgICAgICAgICAgaWYgKG1hbmEgIT0gJycpIHtcbiAgICAgICAgICAgICAgICBjZG1hbmFjb3N0LmFwcGVuZCgkKCc8c3Bhbj4nKS5odG1sKG1hbmEpLmFkZENsYXNzKCdpdGVtX2ZpZWxkIGl0ZW1fbWFuYWNvc3QnKSk7XG4gICAgICAgICAgICB9XG4gICAgICAgICAgICBkYXRhLmFwcGVuZChjZG1hbmFjb3N0KTtcbiAgICAgICAgfVxuICAgICAgICBpZiAoaXRlbS5sb3JlICE9IG51bGwpIHtcbiAgICAgICAgICAgIGRhdGEuYXBwZW5kKCQoJzxkaXY+JykuaHRtbChpdGVtLmxvcmUpLmFkZENsYXNzKCdpdGVtX2ZpZWxkIGl0ZW1fbG9yZScpKTtcbiAgICAgICAgfVxuICAgICAgICBpdGVtdG9vbHRpcGRhdGFbZWxdID0gZGF0YS5odG1sKCk7XG4gICAgICAgIHJldHVybiBkYXRhLmh0bWwoKTtcbiAgICB9XG4gICAgZWxzZSB7XG4gICAgICAgIHJldHVybiBpdGVtdG9vbHRpcGRhdGFbZWxdO1xuICAgIH1cbn1cblxubW9kdWxlLmV4cG9ydHMgPSBnZXRJdGVtVG9vbHRpcERhdGE7IiwiJ3VzZSBzdHJpY3QnO1xudmFyIGtvID0gcmVxdWlyZSgnLi9oZXJvY2FsY19rbm9ja291dCcpO1xuICAgIFxudmFyIG15ID0gcmVxdWlyZShcIi4vaGVyb2NhbGNfY29yZVwiKTtcblxubXkucHJvdG90eXBlLlVuaXRPcHRpb24gPSBmdW5jdGlvbiAobmFtZSwgZGlzcGxheW5hbWUsIGxldmVscywgaW1hZ2UsIGxldmVsKSB7XG4gICAgdGhpcy5oZXJvTmFtZSA9IGtvLmNvbXB1dGVkKGZ1bmN0aW9uKCkge1xuICAgICAgICByZXR1cm4gKGxldmVscyA+IDApID8gbmFtZSArIChsZXZlbCgpIDw9IGxldmVscyA/IGxldmVsKCkgOiAxKSA6IG5hbWU7XG4gICAgfSk7XG4gICAgdGhpcy5oZXJvRGlzcGxheU5hbWUgPSBkaXNwbGF5bmFtZTtcbiAgICB0aGlzLmltYWdlID0gaW1hZ2U7XG4gICAgdGhpcy5sZXZlbHMgPSBsZXZlbHM7XG59O1xuXG5teS5wcm90b3R5cGUuVW5pdFZpZXdNb2RlbCA9IGZ1bmN0aW9uIChoLHApIHtcbiAgICB2YXIgc2VsZiA9IG5ldyBteS5wcm90b3R5cGUuSGVyb01vZGVsKGgpO1xuICAgIHNlbGYucGFyZW50ID0gcDtcbiAgICBzZWxmLnNlbGVjdGVkVW5pdExldmVsID0ga28ub2JzZXJ2YWJsZSgxKTtcbiAgICBzZWxmLmF2YWlsYWJsZVVuaXRzID0ga28ub2JzZXJ2YWJsZUFycmF5KFtcbiAgICAgICAgbmV3IG15LnByb3RvdHlwZS5Vbml0T3B0aW9uKCducGNfZG90YV9sb25lX2RydWlkX2JlYXInLCAnTG9uZSBEcnVpZCBTcGlyaXQgQmVhcicsNCwnL21lZGlhL2ltYWdlcy91bml0cy9zcGlyaXRfYmVhci5wbmcnLCBzZWxmLnNlbGVjdGVkVW5pdExldmVsKSxcbiAgICAgICAgbmV3IG15LnByb3RvdHlwZS5Vbml0T3B0aW9uKCducGNfZG90YV9icmV3bWFzdGVyX2VhcnRoXycsJ0JyZXdtYXN0ZXIgRWFydGggV2FycmlvcicsMywnL21lZGlhL2ltYWdlcy91bml0cy9ucGNfZG90YV9icmV3bWFzdGVyX2VhcnRoLnBuZycsIHNlbGYuc2VsZWN0ZWRVbml0TGV2ZWwpLFxuICAgICAgICBuZXcgbXkucHJvdG90eXBlLlVuaXRPcHRpb24oJ25wY19kb3RhX2JyZXdtYXN0ZXJfZmlyZV8nLCdCcmV3bWFzdGVyIEZpcmUgV2FycmlvcicsMywnL21lZGlhL2ltYWdlcy91bml0cy9ucGNfZG90YV9icmV3bWFzdGVyX2ZpcmUucG5nJywgc2VsZi5zZWxlY3RlZFVuaXRMZXZlbCksXG4gICAgICAgIG5ldyBteS5wcm90b3R5cGUuVW5pdE9wdGlvbignbnBjX2RvdGFfYnJld21hc3Rlcl9zdG9ybV8nLCdCcmV3bWFzdGVyIFN0b3JtIFdhcnJpb3InLDMsJy9tZWRpYS9pbWFnZXMvdW5pdHMvbnBjX2RvdGFfYnJld21hc3Rlcl9zdG9ybS5wbmcnLCBzZWxmLnNlbGVjdGVkVW5pdExldmVsKSxcbiAgICAgICAgbmV3IG15LnByb3RvdHlwZS5Vbml0T3B0aW9uKCducGNfZG90YV9uZWNyb25vbWljb25fYXJjaGVyXycsJ05lY3Jvbm9taWNvbiBBcmNoZXInLDMsJy9tZWRpYS9pbWFnZXMvdW5pdHMvbnBjX2RvdGFfbmVjcm9ub21pY29uX2FyY2hlci5wbmcnLCBzZWxmLnNlbGVjdGVkVW5pdExldmVsKSxcbiAgICAgICAgbmV3IG15LnByb3RvdHlwZS5Vbml0T3B0aW9uKCducGNfZG90YV9uZWNyb25vbWljb25fd2Fycmlvcl8nLCdOZWNyb25vbWljb24gV2FycmlvcicsMywnL21lZGlhL2ltYWdlcy91bml0cy9ucGNfZG90YV9uZWNyb25vbWljb25fd2Fycmlvci5wbmcnLCBzZWxmLnNlbGVjdGVkVW5pdExldmVsKSxcbiAgICAgICAgbmV3IG15LnByb3RvdHlwZS5Vbml0T3B0aW9uKCducGNfZG90YV9seWNhbl93b2xmJywnTHljYW4gV29sZicsNCwnL21lZGlhL2ltYWdlcy91bml0cy9ucGNfZG90YV9seWNhbl93b2xmLnBuZycsIHNlbGYuc2VsZWN0ZWRVbml0TGV2ZWwpLFxuICAgICAgICBuZXcgbXkucHJvdG90eXBlLlVuaXRPcHRpb24oJ25wY19kb3RhX3Zpc2FnZV9mYW1pbGlhcicsJ1Zpc2FnZSBGYW1pbGlhcicsMywnL21lZGlhL2ltYWdlcy91bml0cy9ucGNfZG90YV92aXNhZ2VfZmFtaWxpYXIucG5nJywgc2VsZi5zZWxlY3RlZFVuaXRMZXZlbClcbiAgICBdKTtcbiAgICBzZWxmLnNlbGVjdGVkVW5pdCA9IGtvLm9ic2VydmFibGUoc2VsZi5hdmFpbGFibGVVbml0cygpWzBdKTtcbiAgICBzZWxmLnNlbGVjdGVkVW5pdC5zdWJzY3JpYmUoZnVuY3Rpb24obmV3VmFsdWUpIHtcbiAgICAgICAgaWYgKG5ld1ZhbHVlLmhlcm9OYW1lKCkuaW5kZXhPZignbnBjX2RvdGFfbG9uZV9kcnVpZF9iZWFyJykgIT0gLTEpIHtcbiAgICAgICAgICAgIHNlbGYuaW52ZW50b3J5Lmhhc0ludmVudG9yeSh0cnVlKTtcbiAgICAgICAgICAgIHNlbGYuaW52ZW50b3J5Lml0ZW1zLnJlbW92ZUFsbCgpO1xuICAgICAgICAgICAgc2VsZi5pbnZlbnRvcnkuYWN0aXZlSXRlbXMucmVtb3ZlQWxsKCk7XG4gICAgICAgIH1cbiAgICAgICAgZWxzZSB7XG4gICAgICAgICAgICBzZWxmLmludmVudG9yeS5oYXNJbnZlbnRvcnkoZmFsc2UpO1xuICAgICAgICAgICAgc2VsZi5pbnZlbnRvcnkuaXRlbXMucmVtb3ZlQWxsKCk7XG4gICAgICAgICAgICBzZWxmLmludmVudG9yeS5hY3RpdmVJdGVtcy5yZW1vdmVBbGwoKTtcbiAgICAgICAgfVxuICAgIH0pO1xuICAgIHNlbGYuaGVybyA9IGtvLmNvbXB1dGVkKGZ1bmN0aW9uKCkge1xuICAgICAgICByZXR1cm4ga28ud3JhcC5mcm9tSlMobXkucHJvdG90eXBlLnVuaXREYXRhW3NlbGYuc2VsZWN0ZWRVbml0KCkuaGVyb05hbWUoKV0pO1xuICAgIH0pO1xuICAgIHNlbGYuaGVyb0RhdGEgPSBrby5jb21wdXRlZChmdW5jdGlvbigpIHtcbiAgICAgICAgcmV0dXJuIG15LnByb3RvdHlwZS51bml0RGF0YVtzZWxmLnNlbGVjdGVkVW5pdCgpLmhlcm9OYW1lKCldO1xuICAgIH0pO1xuICAgIHNlbGYuZ2V0QWJpbGl0eUxldmVsTWF4ID0gZnVuY3Rpb24oZGF0YSkge1xuICAgICAgICBpZiAoZGF0YS5hYmlsaXR5dHlwZSA9PSAnRE9UQV9BQklMSVRZX1RZUEVfQVRUUklCVVRFUycpIHtcbiAgICAgICAgICAgIHJldHVybiAxMDtcbiAgICAgICAgfVxuICAgICAgICBlbHNlIGlmIChkYXRhLm5hbWUgPT0gJ25lY3Jvbm9taWNvbl9hcmNoZXJfbWFuYV9idXJuJyB8fCBkYXRhLm5hbWUgPT0gJ25lY3Jvbm9taWNvbl9hcmNoZXJfYW9lJ1xuICAgICAgICAgICAgfHwgZGF0YS5uYW1lID09ICduZWNyb25vbWljb25fd2Fycmlvcl9tYW5hX2J1cm4nIHx8IGRhdGEubmFtZSA9PSAnbmVjcm9ub21pY29uX3dhcnJpb3JfbGFzdF93aWxsJykge1xuICAgICAgICAgICAgcmV0dXJuIDM7XG4gICAgICAgIH1cbiAgICAgICAgZWxzZSBpZiAoZGF0YS5uYW1lID09ICduZWNyb25vbWljb25fd2Fycmlvcl9zaWdodCcpIHtcbiAgICAgICAgICAgIHJldHVybiAxO1xuICAgICAgICB9XG4gICAgICAgIGVsc2Uge1xuICAgICAgICAgICAgcmV0dXJuIDQ7XG4gICAgICAgIH1cbiAgICB9O1xuICAgIHNlbGYuYWJpbGl0eSA9IGtvLmNvbXB1dGVkKGZ1bmN0aW9uKCkge1xuICAgICAgICB2YXIgYSA9IG5ldyBteS5wcm90b3R5cGUuQWJpbGl0eU1vZGVsKGtvLm1hcHBpbmcuZnJvbUpTKG15LnByb3RvdHlwZS51bml0RGF0YVtzZWxmLnNlbGVjdGVkVW5pdCgpLmhlcm9OYW1lKCldLmFiaWxpdGllcykpO1xuICAgICAgICBhLmhhc1NjZXB0ZXIgPSBzZWxmLmludmVudG9yeS5oYXNTY2VwdGVyXG4gICAgICAgIHN3aXRjaCAoc2VsZi5zZWxlY3RlZFVuaXQoKS5oZXJvTmFtZSgpKSB7XG4gICAgICAgICAgICBjYXNlICducGNfZG90YV9uZWNyb25vbWljb25fYXJjaGVyXzEnOlxuICAgICAgICAgICAgY2FzZSAnbnBjX2RvdGFfbmVjcm9ub21pY29uX3dhcnJpb3JfMSc6XG4gICAgICAgICAgICAgICAgYS5hYmlsaXRpZXMoKVswXS5sZXZlbCgxKTtcbiAgICAgICAgICAgICAgICBhLmFiaWxpdGllcygpWzFdLmxldmVsKDEpO1xuICAgICAgICAgICAgYnJlYWs7XG4gICAgICAgICAgICBjYXNlICducGNfZG90YV9uZWNyb25vbWljb25fYXJjaGVyXzInOlxuICAgICAgICAgICAgY2FzZSAnbnBjX2RvdGFfbmVjcm9ub21pY29uX3dhcnJpb3JfMic6XG4gICAgICAgICAgICAgICAgYS5hYmlsaXRpZXMoKVswXS5sZXZlbCgyKTtcbiAgICAgICAgICAgICAgICBhLmFiaWxpdGllcygpWzFdLmxldmVsKDIpO1xuICAgICAgICAgICAgYnJlYWs7XG4gICAgICAgICAgICBjYXNlICducGNfZG90YV9uZWNyb25vbWljb25fYXJjaGVyXzMnOlxuICAgICAgICAgICAgICAgIGEuYWJpbGl0aWVzKClbMF0ubGV2ZWwoMyk7XG4gICAgICAgICAgICAgICAgYS5hYmlsaXRpZXMoKVsxXS5sZXZlbCgzKTtcbiAgICAgICAgICAgIGJyZWFrO1xuICAgICAgICAgICAgY2FzZSAnbnBjX2RvdGFfbmVjcm9ub21pY29uX3dhcnJpb3JfMyc6XG4gICAgICAgICAgICAgICAgYS5hYmlsaXRpZXMoKVswXS5sZXZlbCgzKTtcbiAgICAgICAgICAgICAgICBhLmFiaWxpdGllcygpWzFdLmxldmVsKDMpO1xuICAgICAgICAgICAgICAgIGEuYWJpbGl0aWVzKClbMl0ubGV2ZWwoMSk7XG4gICAgICAgICAgICBicmVhaztcbiAgICAgICAgfVxuICAgICAgICBhLmxldmVsVXBBYmlsaXR5ID0gZnVuY3Rpb24oaW5kZXgsIGRhdGEsIGV2ZW50LCBoZXJvKSB7XG4gICAgICAgICAgICBzd2l0Y2ggKGEuYWJpbGl0aWVzKClbaW5kZXgoKV0ubmFtZSkge1xuICAgICAgICAgICAgICAgIGNhc2UgJ25lY3Jvbm9taWNvbl9hcmNoZXJfbWFuYV9idXJuJzpcbiAgICAgICAgICAgICAgICBjYXNlICduZWNyb25vbWljb25fYXJjaGVyX2FvZSc6XG4gICAgICAgICAgICAgICAgY2FzZSAnbmVjcm9ub21pY29uX3dhcnJpb3JfbWFuYV9idXJuJzpcbiAgICAgICAgICAgICAgICBjYXNlICduZWNyb25vbWljb25fd2Fycmlvcl9sYXN0X3dpbGwnOlxuICAgICAgICAgICAgICAgIGNhc2UgJ25lY3Jvbm9taWNvbl93YXJyaW9yX3NpZ2h0JzpcbiAgICAgICAgICAgICAgICBicmVhaztcbiAgICAgICAgICAgICAgICBkZWZhdWx0OlxuICAgICAgICAgICAgICAgICAgICBpZiAoYS5hYmlsaXRpZXMoKVtpbmRleCgpXS5sZXZlbCgpIDwgaGVyby5nZXRBYmlsaXR5TGV2ZWxNYXgoZGF0YSkpIHtcbiAgICAgICAgICAgICAgICAgICAgICAgIGEuYWJpbGl0aWVzKClbaW5kZXgoKV0ubGV2ZWwoYS5hYmlsaXRpZXMoKVtpbmRleCgpXS5sZXZlbCgpKzEpO1xuICAgICAgICAgICAgICAgICAgICB9ICAgICAgICAgICAgICAgICAgICBcbiAgICAgICAgICAgICAgICBicmVhaztcbiAgICAgICAgICAgIH1cblxuICAgICAgICB9O1xuICAgICAgICBhLmxldmVsRG93bkFiaWxpdHkgPSBmdW5jdGlvbihpbmRleCwgZGF0YSwgZXZlbnQsIGhlcm8pIHsgICAgICAgICAgICBcbiAgICAgICAgICAgIHN3aXRjaCAoYS5hYmlsaXRpZXMoKVtpbmRleCgpXS5uYW1lKSB7XG4gICAgICAgICAgICAgICAgY2FzZSAnbmVjcm9ub21pY29uX2FyY2hlcl9tYW5hX2J1cm4nOlxuICAgICAgICAgICAgICAgIGNhc2UgJ25lY3Jvbm9taWNvbl9hcmNoZXJfYW9lJzpcbiAgICAgICAgICAgICAgICBjYXNlICduZWNyb25vbWljb25fd2Fycmlvcl9tYW5hX2J1cm4nOlxuICAgICAgICAgICAgICAgIGNhc2UgJ25lY3Jvbm9taWNvbl93YXJyaW9yX2xhc3Rfd2lsbCc6XG4gICAgICAgICAgICAgICAgY2FzZSAnbmVjcm9ub21pY29uX3dhcnJpb3Jfc2lnaHQnOlxuICAgICAgICAgICAgICAgIGJyZWFrO1xuICAgICAgICAgICAgICAgIGRlZmF1bHQ6XG4gICAgICAgICAgICAgICAgICAgIGlmIChhLmFiaWxpdGllcygpW2luZGV4KCldLmxldmVsKCk+MCkge1xuICAgICAgICAgICAgICAgICAgICAgICAgYS5hYmlsaXRpZXMoKVtpbmRleCgpXS5sZXZlbChhLmFiaWxpdGllcygpW2luZGV4KCldLmxldmVsKCktMSk7XG4gICAgICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgICBicmVhaztcbiAgICAgICAgICAgIH1cbiAgICAgICAgfTtcbiAgICAgICAgcmV0dXJuIGE7XG4gICAgfSk7ICAgICAgICBcbiAgICBzZWxmLnByaW1hcnlBdHRyaWJ1dGUgPSBrby5jb21wdXRlZChmdW5jdGlvbigpIHtcbiAgICAgICAgLy92YXIgdiA9IG15LnByb3RvdHlwZS51bml0RGF0YVtzZWxmLnNlbGVjdGVkVW5pdCgpLmhlcm9OYW1lKCldLmF0dHJpYnV0ZXByaW1hcnk7XG4gICAgICAgIHZhciB2ID0gMDtcbiAgICAgICAgaWYgKHYgPT0gJ0RPVEFfQVRUUklCVVRFX0FHSUxJVFknKSB7XG4gICAgICAgICAgICByZXR1cm4gJ2FnaSdcbiAgICAgICAgfVxuICAgICAgICBlbHNlIGlmICh2ID09ICdET1RBX0FUVFJJQlVURV9JTlRFTExFQ1QnKSB7XG4gICAgICAgICAgICByZXR1cm4gJ2ludCdcbiAgICAgICAgfVxuICAgICAgICBlbHNlIGlmICh2ID09ICdET1RBX0FUVFJJQlVURV9TVFJFTkdUSCcpIHtcbiAgICAgICAgICAgIHJldHVybiAnc3RyJ1xuICAgICAgICB9XG4gICAgICAgIGVsc2Uge1xuICAgICAgICAgICAgcmV0dXJuICcnXG4gICAgICAgIH1cbiAgICB9KTtcbiAgICBzZWxmLnRvdGFsQXR0cmlidXRlID0gZnVuY3Rpb24oYSkge1xuICAgICAgICBpZiAoYSA9PSAnYWdpJykge1xuICAgICAgICAgICAgcmV0dXJuIHBhcnNlRmxvYXQoc2VsZi50b3RhbEFnaSgpKTtcbiAgICAgICAgfVxuICAgICAgICBpZiAoYSA9PSAnaW50Jykge1xuICAgICAgICAgICAgcmV0dXJuIHBhcnNlRmxvYXQoc2VsZi50b3RhbEludCgpKTtcbiAgICAgICAgfVxuICAgICAgICBpZiAoYSA9PSAnc3RyJykge1xuICAgICAgICAgICAgcmV0dXJuIHBhcnNlRmxvYXQoc2VsZi50b3RhbFN0cigpKTtcbiAgICAgICAgfVxuICAgICAgICByZXR1cm4gMDtcbiAgICB9O1xuICAgIHNlbGYudG90YWxBZ2kgPSBrby5jb21wdXRlZChmdW5jdGlvbigpIHtcbiAgICAgICAgcmV0dXJuIChteS5wcm90b3R5cGUudW5pdERhdGFbc2VsZi5zZWxlY3RlZFVuaXQoKS5oZXJvTmFtZSgpXS5hdHRyaWJ1dGViYXNlYWdpbGl0eVxuICAgICAgICAgICAgICAgICsgbXkucHJvdG90eXBlLnVuaXREYXRhW3NlbGYuc2VsZWN0ZWRVbml0KCkuaGVyb05hbWUoKV0uYXR0cmlidXRlYWdpbGl0eWdhaW4gKiAoc2VsZi5zZWxlY3RlZEhlcm9MZXZlbCgpIC0gMSkgXG4gICAgICAgICAgICAgICAgLy8rIHNlbGYuaW52ZW50b3J5LmdldEF0dHJpYnV0ZXMoJ2FnaScpIFxuICAgICAgICAgICAgICAgICsgc2VsZi5hYmlsaXR5KCkuZ2V0QXR0cmlidXRlQm9udXNMZXZlbCgpKjJcbiAgICAgICAgICAgICAgICArIHNlbGYuYWJpbGl0eSgpLmdldEFnaWxpdHkoKVxuICAgICAgICAgICAgICAgICsgc2VsZi5lbmVteSgpLmFiaWxpdHkoKS5nZXRBbGxTdGF0c1JlZHVjdGlvbigpXG4gICAgICAgICAgICAgICAgKyBzZWxmLmRlYnVmZnMuZ2V0QWxsU3RhdHNSZWR1Y3Rpb24oKVxuICAgICAgICAgICAgICAgKS50b0ZpeGVkKDIpO1xuICAgIH0pO1xuICAgIHNlbGYudG90YWxJbnQgPSBrby5jb21wdXRlZChmdW5jdGlvbigpIHtcbiAgICAgICAgcmV0dXJuIChteS5wcm90b3R5cGUudW5pdERhdGFbc2VsZi5zZWxlY3RlZFVuaXQoKS5oZXJvTmFtZSgpXS5hdHRyaWJ1dGViYXNlaW50ZWxsaWdlbmNlIFxuICAgICAgICAgICAgICAgICsgbXkucHJvdG90eXBlLnVuaXREYXRhW3NlbGYuc2VsZWN0ZWRVbml0KCkuaGVyb05hbWUoKV0uYXR0cmlidXRlaW50ZWxsaWdlbmNlZ2FpbiAqIChzZWxmLnNlbGVjdGVkSGVyb0xldmVsKCkgLSAxKSBcbiAgICAgICAgICAgICAgICAvLysgc2VsZi5pbnZlbnRvcnkuZ2V0QXR0cmlidXRlcygnaW50JykgXG4gICAgICAgICAgICAgICAgKyBzZWxmLmFiaWxpdHkoKS5nZXRBdHRyaWJ1dGVCb251c0xldmVsKCkqMlxuICAgICAgICAgICAgICAgICsgc2VsZi5hYmlsaXR5KCkuZ2V0SW50ZWxsaWdlbmNlKClcbiAgICAgICAgICAgICAgICArIHNlbGYuZW5lbXkoKS5hYmlsaXR5KCkuZ2V0QWxsU3RhdHNSZWR1Y3Rpb24oKVxuICAgICAgICAgICAgICAgICsgc2VsZi5kZWJ1ZmZzLmdldEFsbFN0YXRzUmVkdWN0aW9uKClcbiAgICAgICAgICAgICAgICkudG9GaXhlZCgyKTtcbiAgICB9KTtcbiAgICBzZWxmLnRvdGFsU3RyID0ga28uY29tcHV0ZWQoZnVuY3Rpb24oKSB7XG4gICAgICAgIHJldHVybiAobXkucHJvdG90eXBlLnVuaXREYXRhW3NlbGYuc2VsZWN0ZWRVbml0KCkuaGVyb05hbWUoKV0uYXR0cmlidXRlYmFzZXN0cmVuZ3RoIFxuICAgICAgICAgICAgICAgICsgbXkucHJvdG90eXBlLnVuaXREYXRhW3NlbGYuc2VsZWN0ZWRVbml0KCkuaGVyb05hbWUoKV0uYXR0cmlidXRlc3RyZW5ndGhnYWluICogKHNlbGYuc2VsZWN0ZWRIZXJvTGV2ZWwoKSAtIDEpIFxuICAgICAgICAgICAgICAgIC8vKyBzZWxmLmludmVudG9yeS5nZXRBdHRyaWJ1dGVzKCdzdHInKSBcbiAgICAgICAgICAgICAgICArIHNlbGYuYWJpbGl0eSgpLmdldEF0dHJpYnV0ZUJvbnVzTGV2ZWwoKSoyXG4gICAgICAgICAgICAgICAgKyBzZWxmLmFiaWxpdHkoKS5nZXRTdHJlbmd0aCgpXG4gICAgICAgICAgICAgICAgKyBzZWxmLmVuZW15KCkuYWJpbGl0eSgpLmdldEFsbFN0YXRzUmVkdWN0aW9uKClcbiAgICAgICAgICAgICAgICArIHNlbGYuZGVidWZmcy5nZXRBbGxTdGF0c1JlZHVjdGlvbigpXG4gICAgICAgICAgICAgICApLnRvRml4ZWQoMik7XG4gICAgfSk7XG4gICAgLypzZWxmLmhlYWx0aCA9IGtvLmNvbXB1dGVkKGZ1bmN0aW9uKCkge1xuICAgICAgICByZXR1cm4gKG15LnByb3RvdHlwZS51bml0RGF0YVtzZWxmLnNlbGVjdGVkVW5pdCgpLmhlcm9OYW1lKCldLnN0YXR1c2hlYWx0aCArIHNlbGYudG90YWxTdHIoKSoxOSBcbiAgICAgICAgICAgICAgICArIHNlbGYuaW52ZW50b3J5LmdldEhlYWx0aCgpXG4gICAgICAgICAgICAgICAgKyBzZWxmLmFiaWxpdHkoKS5nZXRIZWFsdGgoKSkudG9GaXhlZCgyKTtcbiAgICB9KTtcbiAgICBzZWxmLmhlYWx0aHJlZ2VuID0ga28uY29tcHV0ZWQoZnVuY3Rpb24oKSB7XG4gICAgICAgIHJldHVybiAobXkucHJvdG90eXBlLnVuaXREYXRhW3NlbGYuc2VsZWN0ZWRVbml0KCkuaGVyb05hbWUoKV0uc3RhdHVzaGVhbHRocmVnZW4gKyBzZWxmLnRvdGFsU3RyKCkqLjAzIFxuICAgICAgICAgICAgICAgICsgc2VsZi5pbnZlbnRvcnkuZ2V0SGVhbHRoUmVnZW4oKSBcbiAgICAgICAgICAgICAgICArIHNlbGYuYWJpbGl0eSgpLmdldEhlYWx0aFJlZ2VuKClcbiAgICAgICAgICAgICAgICArIHNlbGYuYnVmZnMuZ2V0SGVhbHRoUmVnZW4oKSkudG9GaXhlZCgyKTtcbiAgICB9KTtcbiAgICBzZWxmLm1hbmEgPSBrby5jb21wdXRlZChmdW5jdGlvbigpIHtcbiAgICAgICAgcmV0dXJuIChteS5wcm90b3R5cGUudW5pdERhdGFbc2VsZi5zZWxlY3RlZFVuaXQoKS5oZXJvTmFtZSgpXS5zdGF0dXNtYW5hICsgc2VsZi50b3RhbEludCgpKjEzICsgc2VsZi5pbnZlbnRvcnkuZ2V0TWFuYSgpKS50b0ZpeGVkKDIpO1xuICAgIH0pO1xuICAgIHNlbGYubWFuYXJlZ2VuID0ga28uY29tcHV0ZWQoZnVuY3Rpb24oKSB7XG4gICAgICAgIHJldHVybiAoKG15LnByb3RvdHlwZS51bml0RGF0YVtzZWxmLnNlbGVjdGVkVW5pdCgpLmhlcm9OYW1lKCldLnN0YXR1c21hbmFyZWdlbiBcbiAgICAgICAgICAgICAgICArIHNlbGYudG90YWxJbnQoKSouMDQgXG4gICAgICAgICAgICAgICAgKyBzZWxmLmFiaWxpdHkoKS5nZXRNYW5hUmVnZW4oKSkgXG4gICAgICAgICAgICAgICAgKiAoMSArIHNlbGYuaW52ZW50b3J5LmdldE1hbmFSZWdlblBlcmNlbnQoKSkgXG4gICAgICAgICAgICAgICAgKyAoc2VsZi5zZWxlY3RlZEhlcm8oKS5oZXJvTmFtZSA9PSAnY3J5c3RhbF9tYWlkZW4nID8gc2VsZi5hYmlsaXR5KCkuZ2V0TWFuYVJlZ2VuQXJjYW5lQXVyYSgpICogMiA6IHNlbGYuYnVmZnMuZ2V0TWFuYVJlZ2VuQXJjYW5lQXVyYSgpKVxuICAgICAgICAgICAgICAgICsgc2VsZi5pbnZlbnRvcnkuZ2V0TWFuYVJlZ2VuQmxvb2RzdG9uZSgpXG4gICAgICAgICAgICAgICAgLSBzZWxmLmVuZW15KCkuYWJpbGl0eSgpLmdldE1hbmFSZWdlblJlZHVjdGlvbigpKS50b0ZpeGVkKDIpO1xuICAgIH0pO1xuICAgIHNlbGYudG90YWxBcm1vclBoeXNpY2FsID0ga28uY29tcHV0ZWQoZnVuY3Rpb24oKSB7XG4gICAgICAgIHJldHVybiAoc2VsZi5lbmVteSgpLmFiaWxpdHkoKS5nZXRBcm1vckJhc2VSZWR1Y3Rpb24oKSAqIHNlbGYuZGVidWZmcy5nZXRBcm1vckJhc2VSZWR1Y3Rpb24oKSAqIChteS5wcm90b3R5cGUudW5pdERhdGFbc2VsZi5zZWxlY3RlZFVuaXQoKS5oZXJvTmFtZSgpXS5hcm1vcnBoeXNpY2FsICsgc2VsZi50b3RhbEFnaSgpKi4xNClcbiAgICAgICAgICAgICAgICArIHNlbGYuaW52ZW50b3J5LmdldEFybW9yKCkgKyBzZWxmLmFiaWxpdHkoKS5nZXRBcm1vcigpICsgc2VsZi5lbmVteSgpLmFiaWxpdHkoKS5nZXRBcm1vclJlZHVjdGlvbigpICsgc2VsZi5idWZmcy5nZXRBcm1vcigpICsgc2VsZi5kZWJ1ZmZzLmdldEFybW9yUmVkdWN0aW9uKCkpLnRvRml4ZWQoMik7XG4gICAgfSk7XG4gICAgc2VsZi50b3RhbEFybW9yUGh5c2ljYWxSZWR1Y3Rpb24gPSBrby5jb21wdXRlZChmdW5jdGlvbigpIHtcbiAgICAgICAgcmV0dXJuICgoMC4wNiAqIHNlbGYudG90YWxBcm1vclBoeXNpY2FsKCkpIC8gKDEgKyAwLjA2ICogc2VsZi50b3RhbEFybW9yUGh5c2ljYWwoKSkgKiAxMDApLnRvRml4ZWQoMik7XG4gICAgfSk7XG4gICAgc2VsZi50b3RhbE1vdmVtZW50U3BlZWQgPSBrby5jb21wdXRlZChmdW5jdGlvbigpIHtcbiAgICAgICAgaWYgKHNlbGYucGFyZW50LmFiaWxpdHkoKS5pc1NoYXBlU2hpZnRBY3RpdmUoKSkge1xuICAgICAgICAgICAgcmV0dXJuIDUyMjtcbiAgICAgICAgfVxuICAgICAgICB2YXIgbXMgPSAoc2VsZi5hYmlsaXR5KCkuc2V0TW92ZW1lbnRTcGVlZCgpID4gMCA/IHNlbGYuYWJpbGl0eSgpLnNldE1vdmVtZW50U3BlZWQoKSA6IHNlbGYuYnVmZnMuc2V0TW92ZW1lbnRTcGVlZCgpKTtcbiAgICAgICAgaWYgKG1zID4gMCkge1xuICAgICAgICAgICAgcmV0dXJuIG1zO1xuICAgICAgICB9XG4gICAgICAgIGVsc2Uge1xuICAgICAgICAgICAgcmV0dXJuICgobXkucHJvdG90eXBlLnVuaXREYXRhW3NlbGYuc2VsZWN0ZWRVbml0KCkuaGVyb05hbWUoKV0ubW92ZW1lbnRzcGVlZCArIHNlbGYuaW52ZW50b3J5LmdldE1vdmVtZW50U3BlZWRGbGF0KCkrIHNlbGYuYWJpbGl0eSgpLmdldE1vdmVtZW50U3BlZWRGbGF0KCkpICogXG4gICAgICAgICAgICAgICAgICAgICgxICsgc2VsZi5pbnZlbnRvcnkuZ2V0TW92ZW1lbnRTcGVlZFBlcmNlbnQoKSBcbiAgICAgICAgICAgICAgICAgICAgICAgKyBzZWxmLmFiaWxpdHkoKS5nZXRNb3ZlbWVudFNwZWVkUGVyY2VudCgpIFxuICAgICAgICAgICAgICAgICAgICAgICArIHNlbGYuZW5lbXkoKS5pbnZlbnRvcnkuZ2V0TW92ZW1lbnRTcGVlZFBlcmNlbnRSZWR1Y3Rpb24oKSBcbiAgICAgICAgICAgICAgICAgICAgICAgKyBzZWxmLmVuZW15KCkuYWJpbGl0eSgpLmdldE1vdmVtZW50U3BlZWRQZXJjZW50UmVkdWN0aW9uKCkgXG4gICAgICAgICAgICAgICAgICAgICAgICsgc2VsZi5idWZmcy5nZXRNb3ZlbWVudFNwZWVkUGVyY2VudCgpIFxuICAgICAgICAgICAgICAgICAgICAgICArIHNlbGYuZGVidWZmcy5nZXRNb3ZlbWVudFNwZWVkUGVyY2VudFJlZHVjdGlvbigpXG4gICAgICAgICAgICAgICAgICAgICkpLnRvRml4ZWQoMik7XG4gICAgICAgIH1cbiAgICB9KTtcbiAgICBzZWxmLnRvdGFsVHVyblJhdGUgPSBrby5jb21wdXRlZChmdW5jdGlvbigpIHtcbiAgICAgICAgcmV0dXJuIChteS5wcm90b3R5cGUudW5pdERhdGFbc2VsZi5zZWxlY3RlZFVuaXQoKS5oZXJvTmFtZSgpXS5tb3ZlbWVudHR1cm5yYXRlIFxuICAgICAgICAgICAgICAgICogKDEgKyBzZWxmLmVuZW15KCkuYWJpbGl0eSgpLmdldFR1cm5SYXRlUmVkdWN0aW9uKClcbiAgICAgICAgICAgICAgICAgICAgICsgc2VsZi5kZWJ1ZmZzLmdldFR1cm5SYXRlUmVkdWN0aW9uKCkpKS50b0ZpeGVkKDIpO1xuICAgIH0pO1xuICAgICovXG4gICAgc2VsZi5iYXNlRGFtYWdlID0ga28uY29tcHV0ZWQoZnVuY3Rpb24oKSB7XG4gICAgICAgIHJldHVybiBbTWF0aC5mbG9vcihteS5wcm90b3R5cGUudW5pdERhdGFbc2VsZi5zZWxlY3RlZFVuaXQoKS5oZXJvTmFtZSgpXS5hdHRhY2tkYW1hZ2VtaW4gKyBzZWxmLnRvdGFsQXR0cmlidXRlKHNlbGYucHJpbWFyeUF0dHJpYnV0ZSgpKSArIHNlbGYuYWJpbGl0eSgpLmdldEJhc2VEYW1hZ2UoKS50b3RhbCksXG4gICAgICAgICAgICAgICAgTWF0aC5mbG9vcihteS5wcm90b3R5cGUudW5pdERhdGFbc2VsZi5zZWxlY3RlZFVuaXQoKS5oZXJvTmFtZSgpXS5hdHRhY2tkYW1hZ2VtYXggKyBzZWxmLnRvdGFsQXR0cmlidXRlKHNlbGYucHJpbWFyeUF0dHJpYnV0ZSgpKSArIHNlbGYuYWJpbGl0eSgpLmdldEJhc2VEYW1hZ2UoKS50b3RhbCldO1xuICAgIH0pO1xuICAgIC8qc2VsZi5ib251c0RhbWFnZSA9IGtvLmNvbXB1dGVkKGZ1bmN0aW9uKCkge1xuICAgICAgICByZXR1cm4gc2VsZi5pbnZlbnRvcnkuZ2V0Qm9udXNEYW1hZ2UoKS50b3RhbFxuICAgICAgICAgICAgICAgICsgc2VsZi5hYmlsaXR5KCkuZ2V0Qm9udXNEYW1hZ2UoKS50b3RhbFxuICAgICAgICAgICAgICAgICsgc2VsZi5idWZmcy5nZXRCb251c0RhbWFnZSgpLnRvdGFsXG4gICAgICAgICAgICAgICAgKyBNYXRoLmZsb29yKChzZWxmLmJhc2VEYW1hZ2UoKVswXSArIHNlbGYuYmFzZURhbWFnZSgpWzFdKS8yIFxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgKiAoc2VsZi5pbnZlbnRvcnkuZ2V0Qm9udXNEYW1hZ2VQZXJjZW50KCkudG90YWxcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICsgc2VsZi5hYmlsaXR5KCkuZ2V0Qm9udXNEYW1hZ2VQZXJjZW50KCkudG90YWxcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICsgc2VsZi5idWZmcy5nZXRCb251c0RhbWFnZVBlcmNlbnQoKS50b3RhbFxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICApXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgKVxuICAgICAgICAgICAgICAgICsgTWF0aC5mbG9vcihcbiAgICAgICAgICAgICAgICAgICAgKHNlbGYuaGVybygpLmF0dGFja3R5cGUoKSA9PSAnRE9UQV9VTklUX0NBUF9SQU5HRURfQVRUQUNLJyBcbiAgICAgICAgICAgICAgICAgICAgICAgID8gKChzZWxmLnNlbGVjdGVkSGVybygpLmhlcm9OYW1lID09ICdkcm93X3JhbmdlcicpID8gc2VsZi5hYmlsaXR5KCkuZ2V0Qm9udXNEYW1hZ2VQcmVjaXNpb25BdXJhKCkudG90YWxbMF0gKiBzZWxmLnRvdGFsQWdpKCkgOiBzZWxmLmJ1ZmZzLmdldEJvbnVzRGFtYWdlUHJlY2lzaW9uQXVyYSgpLnRvdGFsWzFdKVxuICAgICAgICAgICAgICAgICAgICAgICAgOiAwKVxuICAgICAgICAgICAgICAgICAgKTtcbiAgICB9KTsqL1xuICAgIC8qc2VsZi5ib251c0RhbWFnZVJlZHVjdGlvbiA9IGtvLmNvbXB1dGVkKGZ1bmN0aW9uKCkge1xuICAgICAgICByZXR1cm4gTWF0aC5hYnMoc2VsZi5lbmVteSgpLmFiaWxpdHkoKS5nZXRCb251c0RhbWFnZVJlZHVjdGlvbigpICsgc2VsZi5kZWJ1ZmZzLmdldEJvbnVzRGFtYWdlUmVkdWN0aW9uKCkpO1xuICAgIH0pO1xuICAgIHNlbGYuZGFtYWdlID0ga28uY29tcHV0ZWQoZnVuY3Rpb24oKSB7XG4gICAgICAgIHJldHVybiBbc2VsZi5iYXNlRGFtYWdlKClbMF0gKyBzZWxmLmJvbnVzRGFtYWdlKClbMF0sXG4gICAgICAgICAgICAgICAgc2VsZi5iYXNlRGFtYWdlKClbMV0gKyBzZWxmLmJvbnVzRGFtYWdlKClbMV1dO1xuICAgIH0pOyovXG4gICAgc2VsZi50b3RhbE1hZ2ljUmVzaXN0YW5jZVByb2R1Y3QgPSBrby5jb21wdXRlZChmdW5jdGlvbigpIHtcbiAgICAgICAgcmV0dXJuICgxIC0gbXkucHJvdG90eXBlLnVuaXREYXRhW3NlbGYuc2VsZWN0ZWRVbml0KCkuaGVyb05hbWUoKV0ubWFnaWNhbHJlc2lzdGFuY2UgLyAxMDApIFxuICAgICAgICAgICAgICAgICAgICogKDEgLSBzZWxmLmludmVudG9yeS5nZXRNYWdpY1Jlc2lzdCgpIC8gMTAwKSBcbiAgICAgICAgICAgICAgICAgICAqICgxIC0gc2VsZi5hYmlsaXR5KCkuZ2V0TWFnaWNSZXNpc3QoKSAvIDEwMCkgXG4gICAgICAgICAgICAgICAgICAgKiAoMSAtIHNlbGYuYnVmZnMuZ2V0TWFnaWNSZXNpc3QoKSAvIDEwMCkgXG4gICAgICAgICAgICAgICAgICAgKiBzZWxmLmVuZW15KCkuaW52ZW50b3J5LmdldE1hZ2ljUmVzaXN0UmVkdWN0aW9uKClcbiAgICAgICAgICAgICAgICAgICAqIHNlbGYuZW5lbXkoKS5hYmlsaXR5KCkuZ2V0TWFnaWNSZXNpc3RSZWR1Y3Rpb24oKSBcbiAgICAgICAgICAgICAgICAgICAqIHNlbGYuZGVidWZmcy5nZXRNYWdpY1Jlc2lzdFJlZHVjdGlvbigpO1xuICAgIH0pO1xuICAgIHNlbGYudG90YWxNYWdpY1Jlc2lzdGFuY2UgPSBrby5jb21wdXRlZChmdW5jdGlvbigpIHtcbiAgICAgICAgcmV0dXJuICgxIC0gc2VsZi50b3RhbE1hZ2ljUmVzaXN0YW5jZVByb2R1Y3QoKSk7XG4gICAgfSk7XG4gICAgc2VsZi5iYXQgPSBrby5jb21wdXRlZChmdW5jdGlvbigpIHtcbiAgICAgICAgdmFyIGFiaWxpdHlCQVQgPSBzZWxmLmFiaWxpdHkoKS5nZXRCQVQoKTtcbiAgICAgICAgaWYgKGFiaWxpdHlCQVQgPiAwKSB7XG4gICAgICAgICAgICByZXR1cm4gYWJpbGl0eUJBVDtcbiAgICAgICAgfVxuICAgICAgICByZXR1cm4gbXkucHJvdG90eXBlLnVuaXREYXRhW3NlbGYuc2VsZWN0ZWRVbml0KCkuaGVyb05hbWUoKV0uYXR0YWNrcmF0ZTtcbiAgICB9KTtcbiAgICAvKlxuICAgIHNlbGYuaWFzID0ga28uY29tcHV0ZWQoZnVuY3Rpb24oKSB7XG4gICAgICAgIHZhciB2YWwgPSBwYXJzZUZsb2F0KHNlbGYudG90YWxBZ2koKSkgXG4gICAgICAgICAgICAgICAgKyBzZWxmLmludmVudG9yeS5nZXRBdHRhY2tTcGVlZCgpIFxuICAgICAgICAgICAgICAgICsgc2VsZi5hYmlsaXR5KCkuZ2V0QXR0YWNrU3BlZWQoKSBcbiAgICAgICAgICAgICAgICArIHNlbGYuZW5lbXkoKS5hYmlsaXR5KCkuZ2V0QXR0YWNrU3BlZWRSZWR1Y3Rpb24oKSBcbiAgICAgICAgICAgICAgICArIHNlbGYuYnVmZnMuZ2V0QXR0YWNrU3BlZWQoKSBcbiAgICAgICAgICAgICAgICArIHNlbGYuZGVidWZmcy5nZXRBdHRhY2tTcGVlZFJlZHVjdGlvbigpO1xuICAgICAgICBpZiAodmFsIDwgLTgwKSB7XG4gICAgICAgICAgICByZXR1cm4gLTgwO1xuICAgICAgICB9XG4gICAgICAgIGVsc2UgaWYgKHZhbCA+IDQwMCkge1xuICAgICAgICAgICAgcmV0dXJuIDQwMDtcbiAgICAgICAgfVxuICAgICAgICByZXR1cm4gKHZhbCkudG9GaXhlZCgyKTtcbiAgICB9KTsqL1xuICAgIHNlbGYuYXR0YWNrVGltZSA9IGtvLmNvbXB1dGVkKGZ1bmN0aW9uKCkge1xuICAgICAgICByZXR1cm4gKHNlbGYuYmF0KCkgLyAoMSArIHNlbGYuaWFzKCkgLyAxMDApKS50b0ZpeGVkKDIpO1xuICAgIH0pO1xuICAgIHNlbGYuYXR0YWNrc1BlclNlY29uZCA9IGtvLmNvbXB1dGVkKGZ1bmN0aW9uKCkge1xuICAgICAgICByZXR1cm4gKDEgKyBzZWxmLmlhcygpIC8gMTAwKSAvIHNlbGYuYmF0KCk7XG4gICAgfSk7XG4gICAgc2VsZi5ldmFzaW9uID0ga28uY29tcHV0ZWQoZnVuY3Rpb24oKSB7XG4gICAgICAgIHZhciBlID0gc2VsZi5hYmlsaXR5KCkuc2V0RXZhc2lvbigpO1xuICAgICAgICBpZiAoZSkge1xuICAgICAgICAgICAgcmV0dXJuIChlICogMTAwKS50b0ZpeGVkKDIpICsgJyUnO1xuICAgICAgICB9XG4gICAgICAgIGVsc2Uge1xuICAgICAgICAgICAgcmV0dXJuICgoMS0oc2VsZi5pbnZlbnRvcnkuZ2V0RXZhc2lvbigpICogc2VsZi5hYmlsaXR5KCkuZ2V0RXZhc2lvbigpKSkgKiAxMDApLnRvRml4ZWQoMikgKyAnJSc7XG4gICAgICAgIH1cbiAgICB9KTtcbiAgICBzZWxmLmVocFBoeXNpY2FsID0ga28uY29tcHV0ZWQoZnVuY3Rpb24oKSB7XG4gICAgICAgIHJldHVybiAoKHNlbGYuaGVhbHRoKCkgKiAoMSArIC4wNiAqIHNlbGYudG90YWxBcm1vclBoeXNpY2FsKCkpKSAvICgxLSgxLShzZWxmLmludmVudG9yeS5nZXRFdmFzaW9uKCkgKiBzZWxmLmFiaWxpdHkoKS5nZXRFdmFzaW9uKCkpKSkpLnRvRml4ZWQoMik7XG4gICAgfSk7XG4gICAgc2VsZi5laHBNYWdpY2FsID0ga28uY29tcHV0ZWQoZnVuY3Rpb24oKSB7XG4gICAgICAgIHJldHVybiAoc2VsZi5oZWFsdGgoKSAvIHNlbGYudG90YWxNYWdpY1Jlc2lzdGFuY2VQcm9kdWN0KCkpLnRvRml4ZWQoMik7XG4gICAgfSk7XG4gICAgXG4gICAgcmV0dXJuIHNlbGY7XG59IiwiJ3VzZSBzdHJpY3QnO1xuXG52YXIgY29yZSA9IHJlcXVpcmUoXCIuL2hlcm9jYWxjX2NvcmVcIik7XG5yZXF1aXJlKFwiLi9oZXJvY2FsY19pbnZlbnRvcnlcIik7XG5yZXF1aXJlKFwiLi9oZXJvY2FsY19hYmlsaXR5ZGF0YVwiKTtcbnJlcXVpcmUoXCIuL2hlcm9jYWxjX2FiaWxpdGllc1wiKTtcbnJlcXVpcmUoXCIuL2hlcm9jYWxjX2J1ZmZzXCIpO1xucmVxdWlyZShcIi4vaGVyb2NhbGNfaGVyb1wiKTtcbnJlcXVpcmUoXCIuL2hlcm9jYWxjX2hlcm8uaWxsdXNpb25cIik7XG5yZXF1aXJlKFwiLi9oZXJvY2FsY19oZXJvLm1lZXBvXCIpO1xucmVxdWlyZShcIi4vaGVyb2NhbGNfdW5pdFwiKTtcblxubW9kdWxlLmV4cG9ydHMgPSBjb3JlOyIsImlmICghQXJyYXkucHJvdG90eXBlLmZpbmQpIHtcbiAgQXJyYXkucHJvdG90eXBlLmZpbmQgPSBmdW5jdGlvbihwcmVkaWNhdGUpIHtcbiAgICAndXNlIHN0cmljdCc7XG4gICAgaWYgKHRoaXMgPT0gbnVsbCkge1xuICAgICAgdGhyb3cgbmV3IFR5cGVFcnJvcignQXJyYXkucHJvdG90eXBlLmZpbmQgY2FsbGVkIG9uIG51bGwgb3IgdW5kZWZpbmVkJyk7XG4gICAgfVxuICAgIGlmICh0eXBlb2YgcHJlZGljYXRlICE9PSAnZnVuY3Rpb24nKSB7XG4gICAgICB0aHJvdyBuZXcgVHlwZUVycm9yKCdwcmVkaWNhdGUgbXVzdCBiZSBhIGZ1bmN0aW9uJyk7XG4gICAgfVxuICAgIHZhciBsaXN0ID0gT2JqZWN0KHRoaXMpO1xuICAgIHZhciBsZW5ndGggPSBsaXN0Lmxlbmd0aCA+Pj4gMDtcbiAgICB2YXIgdGhpc0FyZyA9IGFyZ3VtZW50c1sxXTtcbiAgICB2YXIgdmFsdWU7XG5cbiAgICBmb3IgKHZhciBpID0gMDsgaSA8IGxlbmd0aDsgaSsrKSB7XG4gICAgICB2YWx1ZSA9IGxpc3RbaV07XG4gICAgICBpZiAocHJlZGljYXRlLmNhbGwodGhpc0FyZywgdmFsdWUsIGksIGxpc3QpKSB7XG4gICAgICAgIHJldHVybiB2YWx1ZTtcbiAgICAgIH1cbiAgICB9XG4gICAgcmV0dXJuIHVuZGVmaW5lZDtcbiAgfTtcbn0iLCIvKiFcbiAqIENoYXJ0LmpzXG4gKiBodHRwOi8vY2hhcnRqcy5vcmcvXG4gKiBWZXJzaW9uOiAxLjAuMVxuICpcbiAqIENvcHlyaWdodCAyMDE1IE5pY2sgRG93bmllXG4gKiBSZWxlYXNlZCB1bmRlciB0aGUgTUlUIGxpY2Vuc2VcbiAqIGh0dHBzOi8vZ2l0aHViLmNvbS9ubm5pY2svQ2hhcnQuanMvYmxvYi9tYXN0ZXIvTElDRU5TRS5tZFxuICovXG4oZnVuY3Rpb24oKXtcInVzZSBzdHJpY3RcIjt2YXIgdD10aGlzLGk9dC5DaGFydCxlPWZ1bmN0aW9uKHQpe3RoaXMuY2FudmFzPXQuY2FudmFzLHRoaXMuY3R4PXQ7dGhpcy53aWR0aD10LmNhbnZhcy53aWR0aCx0aGlzLmhlaWdodD10LmNhbnZhcy5oZWlnaHQ7cmV0dXJuIHRoaXMuYXNwZWN0UmF0aW89dGhpcy53aWR0aC90aGlzLmhlaWdodCxzLnJldGluYVNjYWxlKHRoaXMpLHRoaXN9O2UuZGVmYXVsdHM9e2dsb2JhbDp7YW5pbWF0aW9uOiEwLGFuaW1hdGlvblN0ZXBzOjYwLGFuaW1hdGlvbkVhc2luZzpcImVhc2VPdXRRdWFydFwiLHNob3dTY2FsZTohMCxzY2FsZU92ZXJyaWRlOiExLHNjYWxlU3RlcHM6bnVsbCxzY2FsZVN0ZXBXaWR0aDpudWxsLHNjYWxlU3RhcnRWYWx1ZTpudWxsLHNjYWxlTGluZUNvbG9yOlwicmdiYSgwLDAsMCwuMSlcIixzY2FsZUxpbmVXaWR0aDoxLHNjYWxlU2hvd0xhYmVsczohMCxzY2FsZUxhYmVsOlwiPCU9dmFsdWUlPlwiLHNjYWxlSW50ZWdlcnNPbmx5OiEwLHNjYWxlQmVnaW5BdFplcm86ITEsc2NhbGVGb250RmFtaWx5OlwiJ0hlbHZldGljYSBOZXVlJywgJ0hlbHZldGljYScsICdBcmlhbCcsIHNhbnMtc2VyaWZcIixzY2FsZUZvbnRTaXplOjEyLHNjYWxlRm9udFN0eWxlOlwibm9ybWFsXCIsc2NhbGVGb250Q29sb3I6XCIjNjY2XCIscmVzcG9uc2l2ZTohMSxtYWludGFpbkFzcGVjdFJhdGlvOiEwLHNob3dUb29sdGlwczohMCxjdXN0b21Ub29sdGlwczohMSx0b29sdGlwRXZlbnRzOltcIm1vdXNlbW92ZVwiLFwidG91Y2hzdGFydFwiLFwidG91Y2htb3ZlXCIsXCJtb3VzZW91dFwiXSx0b29sdGlwRmlsbENvbG9yOlwicmdiYSgwLDAsMCwwLjgpXCIsdG9vbHRpcEZvbnRGYW1pbHk6XCInSGVsdmV0aWNhIE5ldWUnLCAnSGVsdmV0aWNhJywgJ0FyaWFsJywgc2Fucy1zZXJpZlwiLHRvb2x0aXBGb250U2l6ZToxNCx0b29sdGlwRm9udFN0eWxlOlwibm9ybWFsXCIsdG9vbHRpcEZvbnRDb2xvcjpcIiNmZmZcIix0b29sdGlwVGl0bGVGb250RmFtaWx5OlwiJ0hlbHZldGljYSBOZXVlJywgJ0hlbHZldGljYScsICdBcmlhbCcsIHNhbnMtc2VyaWZcIix0b29sdGlwVGl0bGVGb250U2l6ZToxNCx0b29sdGlwVGl0bGVGb250U3R5bGU6XCJib2xkXCIsdG9vbHRpcFRpdGxlRm9udENvbG9yOlwiI2ZmZlwiLHRvb2x0aXBZUGFkZGluZzo2LHRvb2x0aXBYUGFkZGluZzo2LHRvb2x0aXBDYXJldFNpemU6OCx0b29sdGlwQ29ybmVyUmFkaXVzOjYsdG9vbHRpcFhPZmZzZXQ6MTAsdG9vbHRpcFRlbXBsYXRlOlwiPCVpZiAobGFiZWwpeyU+PCU9bGFiZWwlPjogPCV9JT48JT0gdmFsdWUgJT5cIixtdWx0aVRvb2x0aXBUZW1wbGF0ZTpcIjwlPSB2YWx1ZSAlPlwiLG11bHRpVG9vbHRpcEtleUJhY2tncm91bmQ6XCIjZmZmXCIsb25BbmltYXRpb25Qcm9ncmVzczpmdW5jdGlvbigpe30sb25BbmltYXRpb25Db21wbGV0ZTpmdW5jdGlvbigpe319fSxlLnR5cGVzPXt9O3ZhciBzPWUuaGVscGVycz17fSxuPXMuZWFjaD1mdW5jdGlvbih0LGksZSl7dmFyIHM9QXJyYXkucHJvdG90eXBlLnNsaWNlLmNhbGwoYXJndW1lbnRzLDMpO2lmKHQpaWYodC5sZW5ndGg9PT0rdC5sZW5ndGgpe3ZhciBuO2ZvcihuPTA7bjx0Lmxlbmd0aDtuKyspaS5hcHBseShlLFt0W25dLG5dLmNvbmNhdChzKSl9ZWxzZSBmb3IodmFyIG8gaW4gdClpLmFwcGx5KGUsW3Rbb10sb10uY29uY2F0KHMpKX0sbz1zLmNsb25lPWZ1bmN0aW9uKHQpe3ZhciBpPXt9O3JldHVybiBuKHQsZnVuY3Rpb24oZSxzKXt0Lmhhc093blByb3BlcnR5KHMpJiYoaVtzXT1lKX0pLGl9LGE9cy5leHRlbmQ9ZnVuY3Rpb24odCl7cmV0dXJuIG4oQXJyYXkucHJvdG90eXBlLnNsaWNlLmNhbGwoYXJndW1lbnRzLDEpLGZ1bmN0aW9uKGkpe24oaSxmdW5jdGlvbihlLHMpe2kuaGFzT3duUHJvcGVydHkocykmJih0W3NdPWUpfSl9KSx0fSxoPXMubWVyZ2U9ZnVuY3Rpb24oKXt2YXIgdD1BcnJheS5wcm90b3R5cGUuc2xpY2UuY2FsbChhcmd1bWVudHMsMCk7cmV0dXJuIHQudW5zaGlmdCh7fSksYS5hcHBseShudWxsLHQpfSxsPXMuaW5kZXhPZj1mdW5jdGlvbih0LGkpe2lmKEFycmF5LnByb3RvdHlwZS5pbmRleE9mKXJldHVybiB0LmluZGV4T2YoaSk7Zm9yKHZhciBlPTA7ZTx0Lmxlbmd0aDtlKyspaWYodFtlXT09PWkpcmV0dXJuIGU7cmV0dXJuLTF9LHI9KHMud2hlcmU9ZnVuY3Rpb24odCxpKXt2YXIgZT1bXTtyZXR1cm4gcy5lYWNoKHQsZnVuY3Rpb24odCl7aSh0KSYmZS5wdXNoKHQpfSksZX0scy5maW5kTmV4dFdoZXJlPWZ1bmN0aW9uKHQsaSxlKXtlfHwoZT0tMSk7Zm9yKHZhciBzPWUrMTtzPHQubGVuZ3RoO3MrKyl7dmFyIG49dFtzXTtpZihpKG4pKXJldHVybiBufX0scy5maW5kUHJldmlvdXNXaGVyZT1mdW5jdGlvbih0LGksZSl7ZXx8KGU9dC5sZW5ndGgpO2Zvcih2YXIgcz1lLTE7cz49MDtzLS0pe3ZhciBuPXRbc107aWYoaShuKSlyZXR1cm4gbn19LHMuaW5oZXJpdHM9ZnVuY3Rpb24odCl7dmFyIGk9dGhpcyxlPXQmJnQuaGFzT3duUHJvcGVydHkoXCJjb25zdHJ1Y3RvclwiKT90LmNvbnN0cnVjdG9yOmZ1bmN0aW9uKCl7cmV0dXJuIGkuYXBwbHkodGhpcyxhcmd1bWVudHMpfSxzPWZ1bmN0aW9uKCl7dGhpcy5jb25zdHJ1Y3Rvcj1lfTtyZXR1cm4gcy5wcm90b3R5cGU9aS5wcm90b3R5cGUsZS5wcm90b3R5cGU9bmV3IHMsZS5leHRlbmQ9cix0JiZhKGUucHJvdG90eXBlLHQpLGUuX19zdXBlcl9fPWkucHJvdG90eXBlLGV9KSxjPXMubm9vcD1mdW5jdGlvbigpe30sdT1zLnVpZD1mdW5jdGlvbigpe3ZhciB0PTA7cmV0dXJuIGZ1bmN0aW9uKCl7cmV0dXJuXCJjaGFydC1cIit0Kyt9fSgpLGQ9cy53YXJuPWZ1bmN0aW9uKHQpe3dpbmRvdy5jb25zb2xlJiZcImZ1bmN0aW9uXCI9PXR5cGVvZiB3aW5kb3cuY29uc29sZS53YXJuJiZjb25zb2xlLndhcm4odCl9LHA9cy5hbWQ9XCJmdW5jdGlvblwiPT10eXBlb2YgZGVmaW5lJiZkZWZpbmUuYW1kLGY9cy5pc051bWJlcj1mdW5jdGlvbih0KXtyZXR1cm4haXNOYU4ocGFyc2VGbG9hdCh0KSkmJmlzRmluaXRlKHQpfSxnPXMubWF4PWZ1bmN0aW9uKHQpe3JldHVybiBNYXRoLm1heC5hcHBseShNYXRoLHQpfSxtPXMubWluPWZ1bmN0aW9uKHQpe3JldHVybiBNYXRoLm1pbi5hcHBseShNYXRoLHQpfSx2PShzLmNhcD1mdW5jdGlvbih0LGksZSl7aWYoZihpKSl7aWYodD5pKXJldHVybiBpfWVsc2UgaWYoZihlKSYmZT50KXJldHVybiBlO3JldHVybiB0fSxzLmdldERlY2ltYWxQbGFjZXM9ZnVuY3Rpb24odCl7cmV0dXJuIHQlMSE9PTAmJmYodCk/dC50b1N0cmluZygpLnNwbGl0KFwiLlwiKVsxXS5sZW5ndGg6MH0pLFM9cy5yYWRpYW5zPWZ1bmN0aW9uKHQpe3JldHVybiB0KihNYXRoLlBJLzE4MCl9LHg9KHMuZ2V0QW5nbGVGcm9tUG9pbnQ9ZnVuY3Rpb24odCxpKXt2YXIgZT1pLngtdC54LHM9aS55LXQueSxuPU1hdGguc3FydChlKmUrcypzKSxvPTIqTWF0aC5QSStNYXRoLmF0YW4yKHMsZSk7cmV0dXJuIDA+ZSYmMD5zJiYobys9MipNYXRoLlBJKSx7YW5nbGU6byxkaXN0YW5jZTpufX0scy5hbGlhc1BpeGVsPWZ1bmN0aW9uKHQpe3JldHVybiB0JTI9PT0wPzA6LjV9KSx5PShzLnNwbGluZUN1cnZlPWZ1bmN0aW9uKHQsaSxlLHMpe3ZhciBuPU1hdGguc3FydChNYXRoLnBvdyhpLngtdC54LDIpK01hdGgucG93KGkueS10LnksMikpLG89TWF0aC5zcXJ0KE1hdGgucG93KGUueC1pLngsMikrTWF0aC5wb3coZS55LWkueSwyKSksYT1zKm4vKG4rbyksaD1zKm8vKG4rbyk7cmV0dXJue2lubmVyOnt4OmkueC1hKihlLngtdC54KSx5OmkueS1hKihlLnktdC55KX0sb3V0ZXI6e3g6aS54K2gqKGUueC10LngpLHk6aS55K2gqKGUueS10LnkpfX19LHMuY2FsY3VsYXRlT3JkZXJPZk1hZ25pdHVkZT1mdW5jdGlvbih0KXtyZXR1cm4gTWF0aC5mbG9vcihNYXRoLmxvZyh0KS9NYXRoLkxOMTApfSksQz0ocy5jYWxjdWxhdGVTY2FsZVJhbmdlPWZ1bmN0aW9uKHQsaSxlLHMsbil7dmFyIG89MixhPU1hdGguZmxvb3IoaS8oMS41KmUpKSxoPW8+PWEsbD1nKHQpLHI9bSh0KTtsPT09ciYmKGwrPS41LHI+PS41JiYhcz9yLT0uNTpsKz0uNSk7Zm9yKHZhciBjPU1hdGguYWJzKGwtciksdT15KGMpLGQ9TWF0aC5jZWlsKGwvKDEqTWF0aC5wb3coMTAsdSkpKSpNYXRoLnBvdygxMCx1KSxwPXM/MDpNYXRoLmZsb29yKHIvKDEqTWF0aC5wb3coMTAsdSkpKSpNYXRoLnBvdygxMCx1KSxmPWQtcCx2PU1hdGgucG93KDEwLHUpLFM9TWF0aC5yb3VuZChmL3YpOyhTPmF8fGE+MipTKSYmIWg7KWlmKFM+YSl2Kj0yLFM9TWF0aC5yb3VuZChmL3YpLFMlMSE9PTAmJihoPSEwKTtlbHNlIGlmKG4mJnU+PTApe2lmKHYvMiUxIT09MClicmVhazt2Lz0yLFM9TWF0aC5yb3VuZChmL3YpfWVsc2Ugdi89MixTPU1hdGgucm91bmQoZi92KTtyZXR1cm4gaCYmKFM9byx2PWYvUykse3N0ZXBzOlMsc3RlcFZhbHVlOnYsbWluOnAsbWF4OnArUyp2fX0scy50ZW1wbGF0ZT1mdW5jdGlvbih0LGkpe2Z1bmN0aW9uIGUodCxpKXt2YXIgZT0vXFxXLy50ZXN0KHQpP25ldyBGdW5jdGlvbihcIm9ialwiLFwidmFyIHA9W10scHJpbnQ9ZnVuY3Rpb24oKXtwLnB1c2guYXBwbHkocCxhcmd1bWVudHMpO307d2l0aChvYmope3AucHVzaCgnXCIrdC5yZXBsYWNlKC9bXFxyXFx0XFxuXS9nLFwiIFwiKS5zcGxpdChcIjwlXCIpLmpvaW4oXCJcdFwiKS5yZXBsYWNlKC8oKF58JT4pW15cXHRdKiknL2csXCIkMVxcclwiKS5yZXBsYWNlKC9cXHQ9KC4qPyklPi9nLFwiJywkMSwnXCIpLnNwbGl0KFwiXHRcIikuam9pbihcIicpO1wiKS5zcGxpdChcIiU+XCIpLmpvaW4oXCJwLnB1c2goJ1wiKS5zcGxpdChcIlxcclwiKS5qb2luKFwiXFxcXCdcIikrXCInKTt9cmV0dXJuIHAuam9pbignJyk7XCIpOnNbdF09c1t0XTtyZXR1cm4gaT9lKGkpOmV9aWYodCBpbnN0YW5jZW9mIEZ1bmN0aW9uKXJldHVybiB0KGkpO3ZhciBzPXt9O3JldHVybiBlKHQsaSl9KSx3PShzLmdlbmVyYXRlTGFiZWxzPWZ1bmN0aW9uKHQsaSxlLHMpe3ZhciBvPW5ldyBBcnJheShpKTtyZXR1cm4gbGFiZWxUZW1wbGF0ZVN0cmluZyYmbihvLGZ1bmN0aW9uKGksbil7b1tuXT1DKHQse3ZhbHVlOmUrcyoobisxKX0pfSksb30scy5lYXNpbmdFZmZlY3RzPXtsaW5lYXI6ZnVuY3Rpb24odCl7cmV0dXJuIHR9LGVhc2VJblF1YWQ6ZnVuY3Rpb24odCl7cmV0dXJuIHQqdH0sZWFzZU91dFF1YWQ6ZnVuY3Rpb24odCl7cmV0dXJuLTEqdCoodC0yKX0sZWFzZUluT3V0UXVhZDpmdW5jdGlvbih0KXtyZXR1cm4odC89LjUpPDE/LjUqdCp0Oi0wLjUqKC0tdCoodC0yKS0xKX0sZWFzZUluQ3ViaWM6ZnVuY3Rpb24odCl7cmV0dXJuIHQqdCp0fSxlYXNlT3V0Q3ViaWM6ZnVuY3Rpb24odCl7cmV0dXJuIDEqKCh0PXQvMS0xKSp0KnQrMSl9LGVhc2VJbk91dEN1YmljOmZ1bmN0aW9uKHQpe3JldHVybih0Lz0uNSk8MT8uNSp0KnQqdDouNSooKHQtPTIpKnQqdCsyKX0sZWFzZUluUXVhcnQ6ZnVuY3Rpb24odCl7cmV0dXJuIHQqdCp0KnR9LGVhc2VPdXRRdWFydDpmdW5jdGlvbih0KXtyZXR1cm4tMSooKHQ9dC8xLTEpKnQqdCp0LTEpfSxlYXNlSW5PdXRRdWFydDpmdW5jdGlvbih0KXtyZXR1cm4odC89LjUpPDE/LjUqdCp0KnQqdDotMC41KigodC09MikqdCp0KnQtMil9LGVhc2VJblF1aW50OmZ1bmN0aW9uKHQpe3JldHVybiAxKih0Lz0xKSp0KnQqdCp0fSxlYXNlT3V0UXVpbnQ6ZnVuY3Rpb24odCl7cmV0dXJuIDEqKCh0PXQvMS0xKSp0KnQqdCp0KzEpfSxlYXNlSW5PdXRRdWludDpmdW5jdGlvbih0KXtyZXR1cm4odC89LjUpPDE/LjUqdCp0KnQqdCp0Oi41KigodC09MikqdCp0KnQqdCsyKX0sZWFzZUluU2luZTpmdW5jdGlvbih0KXtyZXR1cm4tMSpNYXRoLmNvcyh0LzEqKE1hdGguUEkvMikpKzF9LGVhc2VPdXRTaW5lOmZ1bmN0aW9uKHQpe3JldHVybiAxKk1hdGguc2luKHQvMSooTWF0aC5QSS8yKSl9LGVhc2VJbk91dFNpbmU6ZnVuY3Rpb24odCl7cmV0dXJuLTAuNSooTWF0aC5jb3MoTWF0aC5QSSp0LzEpLTEpfSxlYXNlSW5FeHBvOmZ1bmN0aW9uKHQpe3JldHVybiAwPT09dD8xOjEqTWF0aC5wb3coMiwxMCoodC8xLTEpKX0sZWFzZU91dEV4cG86ZnVuY3Rpb24odCl7cmV0dXJuIDE9PT10PzE6MSooLU1hdGgucG93KDIsLTEwKnQvMSkrMSl9LGVhc2VJbk91dEV4cG86ZnVuY3Rpb24odCl7cmV0dXJuIDA9PT10PzA6MT09PXQ/MToodC89LjUpPDE/LjUqTWF0aC5wb3coMiwxMCoodC0xKSk6LjUqKC1NYXRoLnBvdygyLC0xMCotLXQpKzIpfSxlYXNlSW5DaXJjOmZ1bmN0aW9uKHQpe3JldHVybiB0Pj0xP3Q6LTEqKE1hdGguc3FydCgxLSh0Lz0xKSp0KS0xKX0sZWFzZU91dENpcmM6ZnVuY3Rpb24odCl7cmV0dXJuIDEqTWF0aC5zcXJ0KDEtKHQ9dC8xLTEpKnQpfSxlYXNlSW5PdXRDaXJjOmZ1bmN0aW9uKHQpe3JldHVybih0Lz0uNSk8MT8tMC41KihNYXRoLnNxcnQoMS10KnQpLTEpOi41KihNYXRoLnNxcnQoMS0odC09MikqdCkrMSl9LGVhc2VJbkVsYXN0aWM6ZnVuY3Rpb24odCl7dmFyIGk9MS43MDE1OCxlPTAscz0xO3JldHVybiAwPT09dD8wOjE9PSh0Lz0xKT8xOihlfHwoZT0uMyksczxNYXRoLmFicygxKT8ocz0xLGk9ZS80KTppPWUvKDIqTWF0aC5QSSkqTWF0aC5hc2luKDEvcyksLShzKk1hdGgucG93KDIsMTAqKHQtPTEpKSpNYXRoLnNpbigyKigxKnQtaSkqTWF0aC5QSS9lKSkpfSxlYXNlT3V0RWxhc3RpYzpmdW5jdGlvbih0KXt2YXIgaT0xLjcwMTU4LGU9MCxzPTE7cmV0dXJuIDA9PT10PzA6MT09KHQvPTEpPzE6KGV8fChlPS4zKSxzPE1hdGguYWJzKDEpPyhzPTEsaT1lLzQpOmk9ZS8oMipNYXRoLlBJKSpNYXRoLmFzaW4oMS9zKSxzKk1hdGgucG93KDIsLTEwKnQpKk1hdGguc2luKDIqKDEqdC1pKSpNYXRoLlBJL2UpKzEpfSxlYXNlSW5PdXRFbGFzdGljOmZ1bmN0aW9uKHQpe3ZhciBpPTEuNzAxNTgsZT0wLHM9MTtyZXR1cm4gMD09PXQ/MDoyPT0odC89LjUpPzE6KGV8fChlPS4zKjEuNSksczxNYXRoLmFicygxKT8ocz0xLGk9ZS80KTppPWUvKDIqTWF0aC5QSSkqTWF0aC5hc2luKDEvcyksMT50Py0uNSpzKk1hdGgucG93KDIsMTAqKHQtPTEpKSpNYXRoLnNpbigyKigxKnQtaSkqTWF0aC5QSS9lKTpzKk1hdGgucG93KDIsLTEwKih0LT0xKSkqTWF0aC5zaW4oMiooMSp0LWkpKk1hdGguUEkvZSkqLjUrMSl9LGVhc2VJbkJhY2s6ZnVuY3Rpb24odCl7dmFyIGk9MS43MDE1ODtyZXR1cm4gMSoodC89MSkqdCooKGkrMSkqdC1pKX0sZWFzZU91dEJhY2s6ZnVuY3Rpb24odCl7dmFyIGk9MS43MDE1ODtyZXR1cm4gMSooKHQ9dC8xLTEpKnQqKChpKzEpKnQraSkrMSl9LGVhc2VJbk91dEJhY2s6ZnVuY3Rpb24odCl7dmFyIGk9MS43MDE1ODtyZXR1cm4odC89LjUpPDE/LjUqdCp0KigoKGkqPTEuNTI1KSsxKSp0LWkpOi41KigodC09MikqdCooKChpKj0xLjUyNSkrMSkqdCtpKSsyKX0sZWFzZUluQm91bmNlOmZ1bmN0aW9uKHQpe3JldHVybiAxLXcuZWFzZU91dEJvdW5jZSgxLXQpfSxlYXNlT3V0Qm91bmNlOmZ1bmN0aW9uKHQpe3JldHVybih0Lz0xKTwxLzIuNzU/Ny41NjI1KnQqdDoyLzIuNzU+dD8xKig3LjU2MjUqKHQtPTEuNS8yLjc1KSp0Ky43NSk6Mi41LzIuNzU+dD8xKig3LjU2MjUqKHQtPTIuMjUvMi43NSkqdCsuOTM3NSk6MSooNy41NjI1Kih0LT0yLjYyNS8yLjc1KSp0Ky45ODQzNzUpfSxlYXNlSW5PdXRCb3VuY2U6ZnVuY3Rpb24odCl7cmV0dXJuLjU+dD8uNSp3LmVhc2VJbkJvdW5jZSgyKnQpOi41KncuZWFzZU91dEJvdW5jZSgyKnQtMSkrLjV9fSksYj1zLnJlcXVlc3RBbmltRnJhbWU9ZnVuY3Rpb24oKXtyZXR1cm4gd2luZG93LnJlcXVlc3RBbmltYXRpb25GcmFtZXx8d2luZG93LndlYmtpdFJlcXVlc3RBbmltYXRpb25GcmFtZXx8d2luZG93Lm1velJlcXVlc3RBbmltYXRpb25GcmFtZXx8d2luZG93Lm9SZXF1ZXN0QW5pbWF0aW9uRnJhbWV8fHdpbmRvdy5tc1JlcXVlc3RBbmltYXRpb25GcmFtZXx8ZnVuY3Rpb24odCl7cmV0dXJuIHdpbmRvdy5zZXRUaW1lb3V0KHQsMWUzLzYwKX19KCksUD0ocy5jYW5jZWxBbmltRnJhbWU9ZnVuY3Rpb24oKXtyZXR1cm4gd2luZG93LmNhbmNlbEFuaW1hdGlvbkZyYW1lfHx3aW5kb3cud2Via2l0Q2FuY2VsQW5pbWF0aW9uRnJhbWV8fHdpbmRvdy5tb3pDYW5jZWxBbmltYXRpb25GcmFtZXx8d2luZG93Lm9DYW5jZWxBbmltYXRpb25GcmFtZXx8d2luZG93Lm1zQ2FuY2VsQW5pbWF0aW9uRnJhbWV8fGZ1bmN0aW9uKHQpe3JldHVybiB3aW5kb3cuY2xlYXJUaW1lb3V0KHQsMWUzLzYwKX19KCkscy5hbmltYXRpb25Mb29wPWZ1bmN0aW9uKHQsaSxlLHMsbixvKXt2YXIgYT0wLGg9d1tlXXx8dy5saW5lYXIsbD1mdW5jdGlvbigpe2ErKzt2YXIgZT1hL2kscj1oKGUpO3QuY2FsbChvLHIsZSxhKSxzLmNhbGwobyxyLGUpLGk+YT9vLmFuaW1hdGlvbkZyYW1lPWIobCk6bi5hcHBseShvKX07YihsKX0scy5nZXRSZWxhdGl2ZVBvc2l0aW9uPWZ1bmN0aW9uKHQpe3ZhciBpLGUscz10Lm9yaWdpbmFsRXZlbnR8fHQsbj10LmN1cnJlbnRUYXJnZXR8fHQuc3JjRWxlbWVudCxvPW4uZ2V0Qm91bmRpbmdDbGllbnRSZWN0KCk7cmV0dXJuIHMudG91Y2hlcz8oaT1zLnRvdWNoZXNbMF0uY2xpZW50WC1vLmxlZnQsZT1zLnRvdWNoZXNbMF0uY2xpZW50WS1vLnRvcCk6KGk9cy5jbGllbnRYLW8ubGVmdCxlPXMuY2xpZW50WS1vLnRvcCkse3g6aSx5OmV9fSxzLmFkZEV2ZW50PWZ1bmN0aW9uKHQsaSxlKXt0LmFkZEV2ZW50TGlzdGVuZXI/dC5hZGRFdmVudExpc3RlbmVyKGksZSk6dC5hdHRhY2hFdmVudD90LmF0dGFjaEV2ZW50KFwib25cIitpLGUpOnRbXCJvblwiK2ldPWV9KSxMPXMucmVtb3ZlRXZlbnQ9ZnVuY3Rpb24odCxpLGUpe3QucmVtb3ZlRXZlbnRMaXN0ZW5lcj90LnJlbW92ZUV2ZW50TGlzdGVuZXIoaSxlLCExKTp0LmRldGFjaEV2ZW50P3QuZGV0YWNoRXZlbnQoXCJvblwiK2ksZSk6dFtcIm9uXCIraV09Y30saz0ocy5iaW5kRXZlbnRzPWZ1bmN0aW9uKHQsaSxlKXt0LmV2ZW50c3x8KHQuZXZlbnRzPXt9KSxuKGksZnVuY3Rpb24oaSl7dC5ldmVudHNbaV09ZnVuY3Rpb24oKXtlLmFwcGx5KHQsYXJndW1lbnRzKX0sUCh0LmNoYXJ0LmNhbnZhcyxpLHQuZXZlbnRzW2ldKX0pfSxzLnVuYmluZEV2ZW50cz1mdW5jdGlvbih0LGkpe24oaSxmdW5jdGlvbihpLGUpe0wodC5jaGFydC5jYW52YXMsZSxpKX0pfSksRj1zLmdldE1heGltdW1XaWR0aD1mdW5jdGlvbih0KXt2YXIgaT10LnBhcmVudE5vZGU7cmV0dXJuIGkuY2xpZW50V2lkdGh9LFI9cy5nZXRNYXhpbXVtSGVpZ2h0PWZ1bmN0aW9uKHQpe3ZhciBpPXQucGFyZW50Tm9kZTtyZXR1cm4gaS5jbGllbnRIZWlnaHR9LFQ9KHMuZ2V0TWF4aW11bVNpemU9cy5nZXRNYXhpbXVtV2lkdGgscy5yZXRpbmFTY2FsZT1mdW5jdGlvbih0KXt2YXIgaT10LmN0eCxlPXQuY2FudmFzLndpZHRoLHM9dC5jYW52YXMuaGVpZ2h0O3dpbmRvdy5kZXZpY2VQaXhlbFJhdGlvJiYoaS5jYW52YXMuc3R5bGUud2lkdGg9ZStcInB4XCIsaS5jYW52YXMuc3R5bGUuaGVpZ2h0PXMrXCJweFwiLGkuY2FudmFzLmhlaWdodD1zKndpbmRvdy5kZXZpY2VQaXhlbFJhdGlvLGkuY2FudmFzLndpZHRoPWUqd2luZG93LmRldmljZVBpeGVsUmF0aW8saS5zY2FsZSh3aW5kb3cuZGV2aWNlUGl4ZWxSYXRpbyx3aW5kb3cuZGV2aWNlUGl4ZWxSYXRpbykpfSksQT1zLmNsZWFyPWZ1bmN0aW9uKHQpe3QuY3R4LmNsZWFyUmVjdCgwLDAsdC53aWR0aCx0LmhlaWdodCl9LE09cy5mb250U3RyaW5nPWZ1bmN0aW9uKHQsaSxlKXtyZXR1cm4gaStcIiBcIit0K1wicHggXCIrZX0sVz1zLmxvbmdlc3RUZXh0PWZ1bmN0aW9uKHQsaSxlKXt0LmZvbnQ9aTt2YXIgcz0wO3JldHVybiBuKGUsZnVuY3Rpb24oaSl7dmFyIGU9dC5tZWFzdXJlVGV4dChpKS53aWR0aDtzPWU+cz9lOnN9KSxzfSx6PXMuZHJhd1JvdW5kZWRSZWN0YW5nbGU9ZnVuY3Rpb24odCxpLGUscyxuLG8pe3QuYmVnaW5QYXRoKCksdC5tb3ZlVG8oaStvLGUpLHQubGluZVRvKGkrcy1vLGUpLHQucXVhZHJhdGljQ3VydmVUbyhpK3MsZSxpK3MsZStvKSx0LmxpbmVUbyhpK3MsZStuLW8pLHQucXVhZHJhdGljQ3VydmVUbyhpK3MsZStuLGkrcy1vLGUrbiksdC5saW5lVG8oaStvLGUrbiksdC5xdWFkcmF0aWNDdXJ2ZVRvKGksZStuLGksZStuLW8pLHQubGluZVRvKGksZStvKSx0LnF1YWRyYXRpY0N1cnZlVG8oaSxlLGkrbyxlKSx0LmNsb3NlUGF0aCgpfTtlLmluc3RhbmNlcz17fSxlLlR5cGU9ZnVuY3Rpb24odCxpLHMpe3RoaXMub3B0aW9ucz1pLHRoaXMuY2hhcnQ9cyx0aGlzLmlkPXUoKSxlLmluc3RhbmNlc1t0aGlzLmlkXT10aGlzLGkucmVzcG9uc2l2ZSYmdGhpcy5yZXNpemUoKSx0aGlzLmluaXRpYWxpemUuY2FsbCh0aGlzLHQpfSxhKGUuVHlwZS5wcm90b3R5cGUse2luaXRpYWxpemU6ZnVuY3Rpb24oKXtyZXR1cm4gdGhpc30sY2xlYXI6ZnVuY3Rpb24oKXtyZXR1cm4gQSh0aGlzLmNoYXJ0KSx0aGlzfSxzdG9wOmZ1bmN0aW9uKCl7cmV0dXJuIHMuY2FuY2VsQW5pbUZyYW1lLmNhbGwodCx0aGlzLmFuaW1hdGlvbkZyYW1lKSx0aGlzfSxyZXNpemU6ZnVuY3Rpb24odCl7dGhpcy5zdG9wKCk7dmFyIGk9dGhpcy5jaGFydC5jYW52YXMsZT1GKHRoaXMuY2hhcnQuY2FudmFzKSxzPXRoaXMub3B0aW9ucy5tYWludGFpbkFzcGVjdFJhdGlvP2UvdGhpcy5jaGFydC5hc3BlY3RSYXRpbzpSKHRoaXMuY2hhcnQuY2FudmFzKTtyZXR1cm4gaS53aWR0aD10aGlzLmNoYXJ0LndpZHRoPWUsaS5oZWlnaHQ9dGhpcy5jaGFydC5oZWlnaHQ9cyxUKHRoaXMuY2hhcnQpLFwiZnVuY3Rpb25cIj09dHlwZW9mIHQmJnQuYXBwbHkodGhpcyxBcnJheS5wcm90b3R5cGUuc2xpY2UuY2FsbChhcmd1bWVudHMsMSkpLHRoaXN9LHJlZmxvdzpjLHJlbmRlcjpmdW5jdGlvbih0KXtyZXR1cm4gdCYmdGhpcy5yZWZsb3coKSx0aGlzLm9wdGlvbnMuYW5pbWF0aW9uJiYhdD9zLmFuaW1hdGlvbkxvb3AodGhpcy5kcmF3LHRoaXMub3B0aW9ucy5hbmltYXRpb25TdGVwcyx0aGlzLm9wdGlvbnMuYW5pbWF0aW9uRWFzaW5nLHRoaXMub3B0aW9ucy5vbkFuaW1hdGlvblByb2dyZXNzLHRoaXMub3B0aW9ucy5vbkFuaW1hdGlvbkNvbXBsZXRlLHRoaXMpOih0aGlzLmRyYXcoKSx0aGlzLm9wdGlvbnMub25BbmltYXRpb25Db21wbGV0ZS5jYWxsKHRoaXMpKSx0aGlzfSxnZW5lcmF0ZUxlZ2VuZDpmdW5jdGlvbigpe3JldHVybiBDKHRoaXMub3B0aW9ucy5sZWdlbmRUZW1wbGF0ZSx0aGlzKX0sZGVzdHJveTpmdW5jdGlvbigpe3RoaXMuY2xlYXIoKSxrKHRoaXMsdGhpcy5ldmVudHMpO3ZhciB0PXRoaXMuY2hhcnQuY2FudmFzO3Qud2lkdGg9dGhpcy5jaGFydC53aWR0aCx0LmhlaWdodD10aGlzLmNoYXJ0LmhlaWdodCx0LnN0eWxlLnJlbW92ZVByb3BlcnR5Pyh0LnN0eWxlLnJlbW92ZVByb3BlcnR5KFwid2lkdGhcIiksdC5zdHlsZS5yZW1vdmVQcm9wZXJ0eShcImhlaWdodFwiKSk6KHQuc3R5bGUucmVtb3ZlQXR0cmlidXRlKFwid2lkdGhcIiksdC5zdHlsZS5yZW1vdmVBdHRyaWJ1dGUoXCJoZWlnaHRcIikpLGRlbGV0ZSBlLmluc3RhbmNlc1t0aGlzLmlkXX0sc2hvd1Rvb2x0aXA6ZnVuY3Rpb24odCxpKXtcInVuZGVmaW5lZFwiPT10eXBlb2YgdGhpcy5hY3RpdmVFbGVtZW50cyYmKHRoaXMuYWN0aXZlRWxlbWVudHM9W10pO3ZhciBvPWZ1bmN0aW9uKHQpe3ZhciBpPSExO3JldHVybiB0Lmxlbmd0aCE9PXRoaXMuYWN0aXZlRWxlbWVudHMubGVuZ3RoP2k9ITA6KG4odCxmdW5jdGlvbih0LGUpe3QhPT10aGlzLmFjdGl2ZUVsZW1lbnRzW2VdJiYoaT0hMCl9LHRoaXMpLGkpfS5jYWxsKHRoaXMsdCk7aWYob3x8aSl7aWYodGhpcy5hY3RpdmVFbGVtZW50cz10LHRoaXMuZHJhdygpLHRoaXMub3B0aW9ucy5jdXN0b21Ub29sdGlwcyYmdGhpcy5vcHRpb25zLmN1c3RvbVRvb2x0aXBzKCExKSx0Lmxlbmd0aD4wKWlmKHRoaXMuZGF0YXNldHMmJnRoaXMuZGF0YXNldHMubGVuZ3RoPjEpe2Zvcih2YXIgYSxoLHI9dGhpcy5kYXRhc2V0cy5sZW5ndGgtMTtyPj0wJiYoYT10aGlzLmRhdGFzZXRzW3JdLnBvaW50c3x8dGhpcy5kYXRhc2V0c1tyXS5iYXJzfHx0aGlzLmRhdGFzZXRzW3JdLnNlZ21lbnRzLGg9bChhLHRbMF0pLC0xPT09aCk7ci0tKTt2YXIgYz1bXSx1PVtdLGQ9ZnVuY3Rpb24oKXt2YXIgdCxpLGUsbixvLGE9W10sbD1bXSxyPVtdO3JldHVybiBzLmVhY2godGhpcy5kYXRhc2V0cyxmdW5jdGlvbihpKXt0PWkucG9pbnRzfHxpLmJhcnN8fGkuc2VnbWVudHMsdFtoXSYmdFtoXS5oYXNWYWx1ZSgpJiZhLnB1c2godFtoXSl9KSxzLmVhY2goYSxmdW5jdGlvbih0KXtsLnB1c2godC54KSxyLnB1c2godC55KSxjLnB1c2gocy50ZW1wbGF0ZSh0aGlzLm9wdGlvbnMubXVsdGlUb29sdGlwVGVtcGxhdGUsdCkpLHUucHVzaCh7ZmlsbDp0Ll9zYXZlZC5maWxsQ29sb3J8fHQuZmlsbENvbG9yLHN0cm9rZTp0Ll9zYXZlZC5zdHJva2VDb2xvcnx8dC5zdHJva2VDb2xvcn0pfSx0aGlzKSxvPW0ociksZT1nKHIpLG49bShsKSxpPWcobCkse3g6bj50aGlzLmNoYXJ0LndpZHRoLzI/bjppLHk6KG8rZSkvMn19LmNhbGwodGhpcyxoKTtuZXcgZS5NdWx0aVRvb2x0aXAoe3g6ZC54LHk6ZC55LHhQYWRkaW5nOnRoaXMub3B0aW9ucy50b29sdGlwWFBhZGRpbmcseVBhZGRpbmc6dGhpcy5vcHRpb25zLnRvb2x0aXBZUGFkZGluZyx4T2Zmc2V0OnRoaXMub3B0aW9ucy50b29sdGlwWE9mZnNldCxmaWxsQ29sb3I6dGhpcy5vcHRpb25zLnRvb2x0aXBGaWxsQ29sb3IsdGV4dENvbG9yOnRoaXMub3B0aW9ucy50b29sdGlwRm9udENvbG9yLGZvbnRGYW1pbHk6dGhpcy5vcHRpb25zLnRvb2x0aXBGb250RmFtaWx5LGZvbnRTdHlsZTp0aGlzLm9wdGlvbnMudG9vbHRpcEZvbnRTdHlsZSxmb250U2l6ZTp0aGlzLm9wdGlvbnMudG9vbHRpcEZvbnRTaXplLHRpdGxlVGV4dENvbG9yOnRoaXMub3B0aW9ucy50b29sdGlwVGl0bGVGb250Q29sb3IsdGl0bGVGb250RmFtaWx5OnRoaXMub3B0aW9ucy50b29sdGlwVGl0bGVGb250RmFtaWx5LHRpdGxlRm9udFN0eWxlOnRoaXMub3B0aW9ucy50b29sdGlwVGl0bGVGb250U3R5bGUsdGl0bGVGb250U2l6ZTp0aGlzLm9wdGlvbnMudG9vbHRpcFRpdGxlRm9udFNpemUsY29ybmVyUmFkaXVzOnRoaXMub3B0aW9ucy50b29sdGlwQ29ybmVyUmFkaXVzLGxhYmVsczpjLGxlZ2VuZENvbG9yczp1LGxlZ2VuZENvbG9yQmFja2dyb3VuZDp0aGlzLm9wdGlvbnMubXVsdGlUb29sdGlwS2V5QmFja2dyb3VuZCx0aXRsZTp0WzBdLmxhYmVsLGNoYXJ0OnRoaXMuY2hhcnQsY3R4OnRoaXMuY2hhcnQuY3R4LGN1c3RvbTp0aGlzLm9wdGlvbnMuY3VzdG9tVG9vbHRpcHN9KS5kcmF3KCl9ZWxzZSBuKHQsZnVuY3Rpb24odCl7dmFyIGk9dC50b29sdGlwUG9zaXRpb24oKTtuZXcgZS5Ub29sdGlwKHt4Ok1hdGgucm91bmQoaS54KSx5Ok1hdGgucm91bmQoaS55KSx4UGFkZGluZzp0aGlzLm9wdGlvbnMudG9vbHRpcFhQYWRkaW5nLHlQYWRkaW5nOnRoaXMub3B0aW9ucy50b29sdGlwWVBhZGRpbmcsZmlsbENvbG9yOnRoaXMub3B0aW9ucy50b29sdGlwRmlsbENvbG9yLHRleHRDb2xvcjp0aGlzLm9wdGlvbnMudG9vbHRpcEZvbnRDb2xvcixmb250RmFtaWx5OnRoaXMub3B0aW9ucy50b29sdGlwRm9udEZhbWlseSxmb250U3R5bGU6dGhpcy5vcHRpb25zLnRvb2x0aXBGb250U3R5bGUsZm9udFNpemU6dGhpcy5vcHRpb25zLnRvb2x0aXBGb250U2l6ZSxjYXJldEhlaWdodDp0aGlzLm9wdGlvbnMudG9vbHRpcENhcmV0U2l6ZSxjb3JuZXJSYWRpdXM6dGhpcy5vcHRpb25zLnRvb2x0aXBDb3JuZXJSYWRpdXMsdGV4dDpDKHRoaXMub3B0aW9ucy50b29sdGlwVGVtcGxhdGUsdCksY2hhcnQ6dGhpcy5jaGFydCxjdXN0b206dGhpcy5vcHRpb25zLmN1c3RvbVRvb2x0aXBzfSkuZHJhdygpfSx0aGlzKTtyZXR1cm4gdGhpc319LHRvQmFzZTY0SW1hZ2U6ZnVuY3Rpb24oKXtyZXR1cm4gdGhpcy5jaGFydC5jYW52YXMudG9EYXRhVVJMLmFwcGx5KHRoaXMuY2hhcnQuY2FudmFzLGFyZ3VtZW50cyl9fSksZS5UeXBlLmV4dGVuZD1mdW5jdGlvbih0KXt2YXIgaT10aGlzLHM9ZnVuY3Rpb24oKXtyZXR1cm4gaS5hcHBseSh0aGlzLGFyZ3VtZW50cyl9O2lmKHMucHJvdG90eXBlPW8oaS5wcm90b3R5cGUpLGEocy5wcm90b3R5cGUsdCkscy5leHRlbmQ9ZS5UeXBlLmV4dGVuZCx0Lm5hbWV8fGkucHJvdG90eXBlLm5hbWUpe3ZhciBuPXQubmFtZXx8aS5wcm90b3R5cGUubmFtZSxsPWUuZGVmYXVsdHNbaS5wcm90b3R5cGUubmFtZV0/byhlLmRlZmF1bHRzW2kucHJvdG90eXBlLm5hbWVdKTp7fTtlLmRlZmF1bHRzW25dPWEobCx0LmRlZmF1bHRzKSxlLnR5cGVzW25dPXMsZS5wcm90b3R5cGVbbl09ZnVuY3Rpb24odCxpKXt2YXIgbz1oKGUuZGVmYXVsdHMuZ2xvYmFsLGUuZGVmYXVsdHNbbl0saXx8e30pO3JldHVybiBuZXcgcyh0LG8sdGhpcyl9fWVsc2UgZChcIk5hbWUgbm90IHByb3ZpZGVkIGZvciB0aGlzIGNoYXJ0LCBzbyBpdCBoYXNuJ3QgYmVlbiByZWdpc3RlcmVkXCIpO3JldHVybiBpfSxlLkVsZW1lbnQ9ZnVuY3Rpb24odCl7YSh0aGlzLHQpLHRoaXMuaW5pdGlhbGl6ZS5hcHBseSh0aGlzLGFyZ3VtZW50cyksdGhpcy5zYXZlKCl9LGEoZS5FbGVtZW50LnByb3RvdHlwZSx7aW5pdGlhbGl6ZTpmdW5jdGlvbigpe30scmVzdG9yZTpmdW5jdGlvbih0KXtyZXR1cm4gdD9uKHQsZnVuY3Rpb24odCl7dGhpc1t0XT10aGlzLl9zYXZlZFt0XX0sdGhpcyk6YSh0aGlzLHRoaXMuX3NhdmVkKSx0aGlzfSxzYXZlOmZ1bmN0aW9uKCl7cmV0dXJuIHRoaXMuX3NhdmVkPW8odGhpcyksZGVsZXRlIHRoaXMuX3NhdmVkLl9zYXZlZCx0aGlzfSx1cGRhdGU6ZnVuY3Rpb24odCl7cmV0dXJuIG4odCxmdW5jdGlvbih0LGkpe3RoaXMuX3NhdmVkW2ldPXRoaXNbaV0sdGhpc1tpXT10fSx0aGlzKSx0aGlzfSx0cmFuc2l0aW9uOmZ1bmN0aW9uKHQsaSl7cmV0dXJuIG4odCxmdW5jdGlvbih0LGUpe3RoaXNbZV09KHQtdGhpcy5fc2F2ZWRbZV0pKmkrdGhpcy5fc2F2ZWRbZV19LHRoaXMpLHRoaXN9LHRvb2x0aXBQb3NpdGlvbjpmdW5jdGlvbigpe3JldHVybnt4OnRoaXMueCx5OnRoaXMueX19LGhhc1ZhbHVlOmZ1bmN0aW9uKCl7cmV0dXJuIGYodGhpcy52YWx1ZSl9fSksZS5FbGVtZW50LmV4dGVuZD1yLGUuUG9pbnQ9ZS5FbGVtZW50LmV4dGVuZCh7ZGlzcGxheTohMCxpblJhbmdlOmZ1bmN0aW9uKHQsaSl7dmFyIGU9dGhpcy5oaXREZXRlY3Rpb25SYWRpdXMrdGhpcy5yYWRpdXM7cmV0dXJuIE1hdGgucG93KHQtdGhpcy54LDIpK01hdGgucG93KGktdGhpcy55LDIpPE1hdGgucG93KGUsMil9LGRyYXc6ZnVuY3Rpb24oKXtpZih0aGlzLmRpc3BsYXkpe3ZhciB0PXRoaXMuY3R4O3QuYmVnaW5QYXRoKCksdC5hcmModGhpcy54LHRoaXMueSx0aGlzLnJhZGl1cywwLDIqTWF0aC5QSSksdC5jbG9zZVBhdGgoKSx0LnN0cm9rZVN0eWxlPXRoaXMuc3Ryb2tlQ29sb3IsdC5saW5lV2lkdGg9dGhpcy5zdHJva2VXaWR0aCx0LmZpbGxTdHlsZT10aGlzLmZpbGxDb2xvcix0LmZpbGwoKSx0LnN0cm9rZSgpfX19KSxlLkFyYz1lLkVsZW1lbnQuZXh0ZW5kKHtpblJhbmdlOmZ1bmN0aW9uKHQsaSl7dmFyIGU9cy5nZXRBbmdsZUZyb21Qb2ludCh0aGlzLHt4OnQseTppfSksbj1lLmFuZ2xlPj10aGlzLnN0YXJ0QW5nbGUmJmUuYW5nbGU8PXRoaXMuZW5kQW5nbGUsbz1lLmRpc3RhbmNlPj10aGlzLmlubmVyUmFkaXVzJiZlLmRpc3RhbmNlPD10aGlzLm91dGVyUmFkaXVzO3JldHVybiBuJiZvfSx0b29sdGlwUG9zaXRpb246ZnVuY3Rpb24oKXt2YXIgdD10aGlzLnN0YXJ0QW5nbGUrKHRoaXMuZW5kQW5nbGUtdGhpcy5zdGFydEFuZ2xlKS8yLGk9KHRoaXMub3V0ZXJSYWRpdXMtdGhpcy5pbm5lclJhZGl1cykvMit0aGlzLmlubmVyUmFkaXVzO3JldHVybnt4OnRoaXMueCtNYXRoLmNvcyh0KSppLHk6dGhpcy55K01hdGguc2luKHQpKml9fSxkcmF3OmZ1bmN0aW9uKHQpe3ZhciBpPXRoaXMuY3R4O2kuYmVnaW5QYXRoKCksaS5hcmModGhpcy54LHRoaXMueSx0aGlzLm91dGVyUmFkaXVzLHRoaXMuc3RhcnRBbmdsZSx0aGlzLmVuZEFuZ2xlKSxpLmFyYyh0aGlzLngsdGhpcy55LHRoaXMuaW5uZXJSYWRpdXMsdGhpcy5lbmRBbmdsZSx0aGlzLnN0YXJ0QW5nbGUsITApLGkuY2xvc2VQYXRoKCksaS5zdHJva2VTdHlsZT10aGlzLnN0cm9rZUNvbG9yLGkubGluZVdpZHRoPXRoaXMuc3Ryb2tlV2lkdGgsaS5maWxsU3R5bGU9dGhpcy5maWxsQ29sb3IsaS5maWxsKCksaS5saW5lSm9pbj1cImJldmVsXCIsdGhpcy5zaG93U3Ryb2tlJiZpLnN0cm9rZSgpfX0pLGUuUmVjdGFuZ2xlPWUuRWxlbWVudC5leHRlbmQoe2RyYXc6ZnVuY3Rpb24oKXt2YXIgdD10aGlzLmN0eCxpPXRoaXMud2lkdGgvMixlPXRoaXMueC1pLHM9dGhpcy54K2ksbj10aGlzLmJhc2UtKHRoaXMuYmFzZS10aGlzLnkpLG89dGhpcy5zdHJva2VXaWR0aC8yO3RoaXMuc2hvd1N0cm9rZSYmKGUrPW8scy09byxuKz1vKSx0LmJlZ2luUGF0aCgpLHQuZmlsbFN0eWxlPXRoaXMuZmlsbENvbG9yLHQuc3Ryb2tlU3R5bGU9dGhpcy5zdHJva2VDb2xvcix0LmxpbmVXaWR0aD10aGlzLnN0cm9rZVdpZHRoLHQubW92ZVRvKGUsdGhpcy5iYXNlKSx0LmxpbmVUbyhlLG4pLHQubGluZVRvKHMsbiksdC5saW5lVG8ocyx0aGlzLmJhc2UpLHQuZmlsbCgpLHRoaXMuc2hvd1N0cm9rZSYmdC5zdHJva2UoKX0saGVpZ2h0OmZ1bmN0aW9uKCl7cmV0dXJuIHRoaXMuYmFzZS10aGlzLnl9LGluUmFuZ2U6ZnVuY3Rpb24odCxpKXtyZXR1cm4gdD49dGhpcy54LXRoaXMud2lkdGgvMiYmdDw9dGhpcy54K3RoaXMud2lkdGgvMiYmaT49dGhpcy55JiZpPD10aGlzLmJhc2V9fSksZS5Ub29sdGlwPWUuRWxlbWVudC5leHRlbmQoe2RyYXc6ZnVuY3Rpb24oKXt2YXIgdD10aGlzLmNoYXJ0LmN0eDt0LmZvbnQ9TSh0aGlzLmZvbnRTaXplLHRoaXMuZm9udFN0eWxlLHRoaXMuZm9udEZhbWlseSksdGhpcy54QWxpZ249XCJjZW50ZXJcIix0aGlzLnlBbGlnbj1cImFib3ZlXCI7dmFyIGk9dGhpcy5jYXJldFBhZGRpbmc9MixlPXQubWVhc3VyZVRleHQodGhpcy50ZXh0KS53aWR0aCsyKnRoaXMueFBhZGRpbmcscz10aGlzLmZvbnRTaXplKzIqdGhpcy55UGFkZGluZyxuPXMrdGhpcy5jYXJldEhlaWdodCtpO3RoaXMueCtlLzI+dGhpcy5jaGFydC53aWR0aD90aGlzLnhBbGlnbj1cImxlZnRcIjp0aGlzLngtZS8yPDAmJih0aGlzLnhBbGlnbj1cInJpZ2h0XCIpLHRoaXMueS1uPDAmJih0aGlzLnlBbGlnbj1cImJlbG93XCIpO3ZhciBvPXRoaXMueC1lLzIsYT10aGlzLnktbjtpZih0LmZpbGxTdHlsZT10aGlzLmZpbGxDb2xvcix0aGlzLmN1c3RvbSl0aGlzLmN1c3RvbSh0aGlzKTtlbHNle3N3aXRjaCh0aGlzLnlBbGlnbil7Y2FzZVwiYWJvdmVcIjp0LmJlZ2luUGF0aCgpLHQubW92ZVRvKHRoaXMueCx0aGlzLnktaSksdC5saW5lVG8odGhpcy54K3RoaXMuY2FyZXRIZWlnaHQsdGhpcy55LShpK3RoaXMuY2FyZXRIZWlnaHQpKSx0LmxpbmVUbyh0aGlzLngtdGhpcy5jYXJldEhlaWdodCx0aGlzLnktKGkrdGhpcy5jYXJldEhlaWdodCkpLHQuY2xvc2VQYXRoKCksdC5maWxsKCk7YnJlYWs7Y2FzZVwiYmVsb3dcIjphPXRoaXMueStpK3RoaXMuY2FyZXRIZWlnaHQsdC5iZWdpblBhdGgoKSx0Lm1vdmVUbyh0aGlzLngsdGhpcy55K2kpLHQubGluZVRvKHRoaXMueCt0aGlzLmNhcmV0SGVpZ2h0LHRoaXMueStpK3RoaXMuY2FyZXRIZWlnaHQpLHQubGluZVRvKHRoaXMueC10aGlzLmNhcmV0SGVpZ2h0LHRoaXMueStpK3RoaXMuY2FyZXRIZWlnaHQpLHQuY2xvc2VQYXRoKCksdC5maWxsKCl9c3dpdGNoKHRoaXMueEFsaWduKXtjYXNlXCJsZWZ0XCI6bz10aGlzLngtZSsodGhpcy5jb3JuZXJSYWRpdXMrdGhpcy5jYXJldEhlaWdodCk7YnJlYWs7Y2FzZVwicmlnaHRcIjpvPXRoaXMueC0odGhpcy5jb3JuZXJSYWRpdXMrdGhpcy5jYXJldEhlaWdodCl9eih0LG8sYSxlLHMsdGhpcy5jb3JuZXJSYWRpdXMpLHQuZmlsbCgpLHQuZmlsbFN0eWxlPXRoaXMudGV4dENvbG9yLHQudGV4dEFsaWduPVwiY2VudGVyXCIsdC50ZXh0QmFzZWxpbmU9XCJtaWRkbGVcIix0LmZpbGxUZXh0KHRoaXMudGV4dCxvK2UvMixhK3MvMil9fX0pLGUuTXVsdGlUb29sdGlwPWUuRWxlbWVudC5leHRlbmQoe2luaXRpYWxpemU6ZnVuY3Rpb24oKXt0aGlzLmZvbnQ9TSh0aGlzLmZvbnRTaXplLHRoaXMuZm9udFN0eWxlLHRoaXMuZm9udEZhbWlseSksdGhpcy50aXRsZUZvbnQ9TSh0aGlzLnRpdGxlRm9udFNpemUsdGhpcy50aXRsZUZvbnRTdHlsZSx0aGlzLnRpdGxlRm9udEZhbWlseSksdGhpcy5oZWlnaHQ9dGhpcy5sYWJlbHMubGVuZ3RoKnRoaXMuZm9udFNpemUrKHRoaXMubGFiZWxzLmxlbmd0aC0xKSoodGhpcy5mb250U2l6ZS8yKSsyKnRoaXMueVBhZGRpbmcrMS41KnRoaXMudGl0bGVGb250U2l6ZSx0aGlzLmN0eC5mb250PXRoaXMudGl0bGVGb250O3ZhciB0PXRoaXMuY3R4Lm1lYXN1cmVUZXh0KHRoaXMudGl0bGUpLndpZHRoLGk9Vyh0aGlzLmN0eCx0aGlzLmZvbnQsdGhpcy5sYWJlbHMpK3RoaXMuZm9udFNpemUrMyxlPWcoW2ksdF0pO3RoaXMud2lkdGg9ZSsyKnRoaXMueFBhZGRpbmc7dmFyIHM9dGhpcy5oZWlnaHQvMjt0aGlzLnktczwwP3RoaXMueT1zOnRoaXMueStzPnRoaXMuY2hhcnQuaGVpZ2h0JiYodGhpcy55PXRoaXMuY2hhcnQuaGVpZ2h0LXMpLHRoaXMueD50aGlzLmNoYXJ0LndpZHRoLzI/dGhpcy54LT10aGlzLnhPZmZzZXQrdGhpcy53aWR0aDp0aGlzLngrPXRoaXMueE9mZnNldH0sZ2V0TGluZUhlaWdodDpmdW5jdGlvbih0KXt2YXIgaT10aGlzLnktdGhpcy5oZWlnaHQvMit0aGlzLnlQYWRkaW5nLGU9dC0xO3JldHVybiAwPT09dD9pK3RoaXMudGl0bGVGb250U2l6ZS8yOmkrKDEuNSp0aGlzLmZvbnRTaXplKmUrdGhpcy5mb250U2l6ZS8yKSsxLjUqdGhpcy50aXRsZUZvbnRTaXplfSxkcmF3OmZ1bmN0aW9uKCl7aWYodGhpcy5jdXN0b20pdGhpcy5jdXN0b20odGhpcyk7ZWxzZXt6KHRoaXMuY3R4LHRoaXMueCx0aGlzLnktdGhpcy5oZWlnaHQvMix0aGlzLndpZHRoLHRoaXMuaGVpZ2h0LHRoaXMuY29ybmVyUmFkaXVzKTt2YXIgdD10aGlzLmN0eDt0LmZpbGxTdHlsZT10aGlzLmZpbGxDb2xvcix0LmZpbGwoKSx0LmNsb3NlUGF0aCgpLHQudGV4dEFsaWduPVwibGVmdFwiLHQudGV4dEJhc2VsaW5lPVwibWlkZGxlXCIsdC5maWxsU3R5bGU9dGhpcy50aXRsZVRleHRDb2xvcix0LmZvbnQ9dGhpcy50aXRsZUZvbnQsdC5maWxsVGV4dCh0aGlzLnRpdGxlLHRoaXMueCt0aGlzLnhQYWRkaW5nLHRoaXMuZ2V0TGluZUhlaWdodCgwKSksdC5mb250PXRoaXMuZm9udCxzLmVhY2godGhpcy5sYWJlbHMsZnVuY3Rpb24oaSxlKXt0LmZpbGxTdHlsZT10aGlzLnRleHRDb2xvcix0LmZpbGxUZXh0KGksdGhpcy54K3RoaXMueFBhZGRpbmcrdGhpcy5mb250U2l6ZSszLHRoaXMuZ2V0TGluZUhlaWdodChlKzEpKSx0LmZpbGxTdHlsZT10aGlzLmxlZ2VuZENvbG9yQmFja2dyb3VuZCx0LmZpbGxSZWN0KHRoaXMueCt0aGlzLnhQYWRkaW5nLHRoaXMuZ2V0TGluZUhlaWdodChlKzEpLXRoaXMuZm9udFNpemUvMix0aGlzLmZvbnRTaXplLHRoaXMuZm9udFNpemUpLHQuZmlsbFN0eWxlPXRoaXMubGVnZW5kQ29sb3JzW2VdLmZpbGwsdC5maWxsUmVjdCh0aGlzLngrdGhpcy54UGFkZGluZyx0aGlzLmdldExpbmVIZWlnaHQoZSsxKS10aGlzLmZvbnRTaXplLzIsdGhpcy5mb250U2l6ZSx0aGlzLmZvbnRTaXplKX0sdGhpcyl9fX0pLGUuU2NhbGU9ZS5FbGVtZW50LmV4dGVuZCh7aW5pdGlhbGl6ZTpmdW5jdGlvbigpe3RoaXMuZml0KCl9LGJ1aWxkWUxhYmVsczpmdW5jdGlvbigpe3RoaXMueUxhYmVscz1bXTtmb3IodmFyIHQ9dih0aGlzLnN0ZXBWYWx1ZSksaT0wO2k8PXRoaXMuc3RlcHM7aSsrKXRoaXMueUxhYmVscy5wdXNoKEModGhpcy50ZW1wbGF0ZVN0cmluZyx7dmFsdWU6KHRoaXMubWluK2kqdGhpcy5zdGVwVmFsdWUpLnRvRml4ZWQodCl9KSk7dGhpcy55TGFiZWxXaWR0aD10aGlzLmRpc3BsYXkmJnRoaXMuc2hvd0xhYmVscz9XKHRoaXMuY3R4LHRoaXMuZm9udCx0aGlzLnlMYWJlbHMpOjB9LGFkZFhMYWJlbDpmdW5jdGlvbih0KXt0aGlzLnhMYWJlbHMucHVzaCh0KSx0aGlzLnZhbHVlc0NvdW50KyssdGhpcy5maXQoKX0scmVtb3ZlWExhYmVsOmZ1bmN0aW9uKCl7dGhpcy54TGFiZWxzLnNoaWZ0KCksdGhpcy52YWx1ZXNDb3VudC0tLHRoaXMuZml0KCl9LGZpdDpmdW5jdGlvbigpe3RoaXMuc3RhcnRQb2ludD10aGlzLmRpc3BsYXk/dGhpcy5mb250U2l6ZTowLHRoaXMuZW5kUG9pbnQ9dGhpcy5kaXNwbGF5P3RoaXMuaGVpZ2h0LTEuNSp0aGlzLmZvbnRTaXplLTU6dGhpcy5oZWlnaHQsdGhpcy5zdGFydFBvaW50Kz10aGlzLnBhZGRpbmcsdGhpcy5lbmRQb2ludC09dGhpcy5wYWRkaW5nO3ZhciB0LGk9dGhpcy5lbmRQb2ludC10aGlzLnN0YXJ0UG9pbnQ7Zm9yKHRoaXMuY2FsY3VsYXRlWVJhbmdlKGkpLHRoaXMuYnVpbGRZTGFiZWxzKCksdGhpcy5jYWxjdWxhdGVYTGFiZWxSb3RhdGlvbigpO2k+dGhpcy5lbmRQb2ludC10aGlzLnN0YXJ0UG9pbnQ7KWk9dGhpcy5lbmRQb2ludC10aGlzLnN0YXJ0UG9pbnQsdD10aGlzLnlMYWJlbFdpZHRoLHRoaXMuY2FsY3VsYXRlWVJhbmdlKGkpLHRoaXMuYnVpbGRZTGFiZWxzKCksdDx0aGlzLnlMYWJlbFdpZHRoJiZ0aGlzLmNhbGN1bGF0ZVhMYWJlbFJvdGF0aW9uKCl9LGNhbGN1bGF0ZVhMYWJlbFJvdGF0aW9uOmZ1bmN0aW9uKCl7dGhpcy5jdHguZm9udD10aGlzLmZvbnQ7dmFyIHQsaSxlPXRoaXMuY3R4Lm1lYXN1cmVUZXh0KHRoaXMueExhYmVsc1swXSkud2lkdGgscz10aGlzLmN0eC5tZWFzdXJlVGV4dCh0aGlzLnhMYWJlbHNbdGhpcy54TGFiZWxzLmxlbmd0aC0xXSkud2lkdGg7aWYodGhpcy54U2NhbGVQYWRkaW5nUmlnaHQ9cy8yKzMsdGhpcy54U2NhbGVQYWRkaW5nTGVmdD1lLzI+dGhpcy55TGFiZWxXaWR0aCsxMD9lLzI6dGhpcy55TGFiZWxXaWR0aCsxMCx0aGlzLnhMYWJlbFJvdGF0aW9uPTAsdGhpcy5kaXNwbGF5KXt2YXIgbixvPVcodGhpcy5jdHgsdGhpcy5mb250LHRoaXMueExhYmVscyk7dGhpcy54TGFiZWxXaWR0aD1vO2Zvcih2YXIgYT1NYXRoLmZsb29yKHRoaXMuY2FsY3VsYXRlWCgxKS10aGlzLmNhbGN1bGF0ZVgoMCkpLTY7dGhpcy54TGFiZWxXaWR0aD5hJiYwPT09dGhpcy54TGFiZWxSb3RhdGlvbnx8dGhpcy54TGFiZWxXaWR0aD5hJiZ0aGlzLnhMYWJlbFJvdGF0aW9uPD05MCYmdGhpcy54TGFiZWxSb3RhdGlvbj4wOyluPU1hdGguY29zKFModGhpcy54TGFiZWxSb3RhdGlvbikpLHQ9biplLGk9bipzLHQrdGhpcy5mb250U2l6ZS8yPnRoaXMueUxhYmVsV2lkdGgrOCYmKHRoaXMueFNjYWxlUGFkZGluZ0xlZnQ9dCt0aGlzLmZvbnRTaXplLzIpLHRoaXMueFNjYWxlUGFkZGluZ1JpZ2h0PXRoaXMuZm9udFNpemUvMix0aGlzLnhMYWJlbFJvdGF0aW9uKyssdGhpcy54TGFiZWxXaWR0aD1uKm87dGhpcy54TGFiZWxSb3RhdGlvbj4wJiYodGhpcy5lbmRQb2ludC09TWF0aC5zaW4oUyh0aGlzLnhMYWJlbFJvdGF0aW9uKSkqbyszKX1lbHNlIHRoaXMueExhYmVsV2lkdGg9MCx0aGlzLnhTY2FsZVBhZGRpbmdSaWdodD10aGlzLnBhZGRpbmcsdGhpcy54U2NhbGVQYWRkaW5nTGVmdD10aGlzLnBhZGRpbmd9LGNhbGN1bGF0ZVlSYW5nZTpjLGRyYXdpbmdBcmVhOmZ1bmN0aW9uKCl7cmV0dXJuIHRoaXMuc3RhcnRQb2ludC10aGlzLmVuZFBvaW50fSxjYWxjdWxhdGVZOmZ1bmN0aW9uKHQpe3ZhciBpPXRoaXMuZHJhd2luZ0FyZWEoKS8odGhpcy5taW4tdGhpcy5tYXgpO3JldHVybiB0aGlzLmVuZFBvaW50LWkqKHQtdGhpcy5taW4pfSxjYWxjdWxhdGVYOmZ1bmN0aW9uKHQpe3ZhciBpPSh0aGlzLnhMYWJlbFJvdGF0aW9uPjAsdGhpcy53aWR0aC0odGhpcy54U2NhbGVQYWRkaW5nTGVmdCt0aGlzLnhTY2FsZVBhZGRpbmdSaWdodCkpLGU9aS8odGhpcy52YWx1ZXNDb3VudC0odGhpcy5vZmZzZXRHcmlkTGluZXM/MDoxKSkscz1lKnQrdGhpcy54U2NhbGVQYWRkaW5nTGVmdDtyZXR1cm4gdGhpcy5vZmZzZXRHcmlkTGluZXMmJihzKz1lLzIpLE1hdGgucm91bmQocyl9LHVwZGF0ZTpmdW5jdGlvbih0KXtzLmV4dGVuZCh0aGlzLHQpLHRoaXMuZml0KCl9LGRyYXc6ZnVuY3Rpb24oKXt2YXIgdD10aGlzLmN0eCxpPSh0aGlzLmVuZFBvaW50LXRoaXMuc3RhcnRQb2ludCkvdGhpcy5zdGVwcyxlPU1hdGgucm91bmQodGhpcy54U2NhbGVQYWRkaW5nTGVmdCk7dGhpcy5kaXNwbGF5JiYodC5maWxsU3R5bGU9dGhpcy50ZXh0Q29sb3IsdC5mb250PXRoaXMuZm9udCxuKHRoaXMueUxhYmVscyxmdW5jdGlvbihuLG8pe3ZhciBhPXRoaXMuZW5kUG9pbnQtaSpvLGg9TWF0aC5yb3VuZChhKSxsPXRoaXMuc2hvd0hvcml6b250YWxMaW5lczt0LnRleHRBbGlnbj1cInJpZ2h0XCIsdC50ZXh0QmFzZWxpbmU9XCJtaWRkbGVcIix0aGlzLnNob3dMYWJlbHMmJnQuZmlsbFRleHQobixlLTEwLGEpLDAhPT1vfHxsfHwobD0hMCksbCYmdC5iZWdpblBhdGgoKSxvPjA/KHQubGluZVdpZHRoPXRoaXMuZ3JpZExpbmVXaWR0aCx0LnN0cm9rZVN0eWxlPXRoaXMuZ3JpZExpbmVDb2xvcik6KHQubGluZVdpZHRoPXRoaXMubGluZVdpZHRoLHQuc3Ryb2tlU3R5bGU9dGhpcy5saW5lQ29sb3IpLGgrPXMuYWxpYXNQaXhlbCh0LmxpbmVXaWR0aCksbCYmKHQubW92ZVRvKGUsaCksdC5saW5lVG8odGhpcy53aWR0aCxoKSx0LnN0cm9rZSgpLHQuY2xvc2VQYXRoKCkpLHQubGluZVdpZHRoPXRoaXMubGluZVdpZHRoLHQuc3Ryb2tlU3R5bGU9dGhpcy5saW5lQ29sb3IsdC5iZWdpblBhdGgoKSx0Lm1vdmVUbyhlLTUsaCksdC5saW5lVG8oZSxoKSx0LnN0cm9rZSgpLHQuY2xvc2VQYXRoKCl9LHRoaXMpLG4odGhpcy54TGFiZWxzLGZ1bmN0aW9uKGksZSl7dmFyIHM9dGhpcy5jYWxjdWxhdGVYKGUpK3godGhpcy5saW5lV2lkdGgpLG49dGhpcy5jYWxjdWxhdGVYKGUtKHRoaXMub2Zmc2V0R3JpZExpbmVzPy41OjApKSt4KHRoaXMubGluZVdpZHRoKSxvPXRoaXMueExhYmVsUm90YXRpb24+MCxhPXRoaXMuc2hvd1ZlcnRpY2FsTGluZXM7MCE9PWV8fGF8fChhPSEwKSxhJiZ0LmJlZ2luUGF0aCgpLGU+MD8odC5saW5lV2lkdGg9dGhpcy5ncmlkTGluZVdpZHRoLHQuc3Ryb2tlU3R5bGU9dGhpcy5ncmlkTGluZUNvbG9yKToodC5saW5lV2lkdGg9dGhpcy5saW5lV2lkdGgsdC5zdHJva2VTdHlsZT10aGlzLmxpbmVDb2xvciksYSYmKHQubW92ZVRvKG4sdGhpcy5lbmRQb2ludCksdC5saW5lVG8obix0aGlzLnN0YXJ0UG9pbnQtMyksdC5zdHJva2UoKSx0LmNsb3NlUGF0aCgpKSx0LmxpbmVXaWR0aD10aGlzLmxpbmVXaWR0aCx0LnN0cm9rZVN0eWxlPXRoaXMubGluZUNvbG9yLHQuYmVnaW5QYXRoKCksdC5tb3ZlVG8obix0aGlzLmVuZFBvaW50KSx0LmxpbmVUbyhuLHRoaXMuZW5kUG9pbnQrNSksdC5zdHJva2UoKSx0LmNsb3NlUGF0aCgpLHQuc2F2ZSgpLHQudHJhbnNsYXRlKHMsbz90aGlzLmVuZFBvaW50KzEyOnRoaXMuZW5kUG9pbnQrOCksdC5yb3RhdGUoLTEqUyh0aGlzLnhMYWJlbFJvdGF0aW9uKSksdC5mb250PXRoaXMuZm9udCx0LnRleHRBbGlnbj1vP1wicmlnaHRcIjpcImNlbnRlclwiLHQudGV4dEJhc2VsaW5lPW8/XCJtaWRkbGVcIjpcInRvcFwiLHQuZmlsbFRleHQoaSwwLDApLHQucmVzdG9yZSgpfSx0aGlzKSl9fSksZS5SYWRpYWxTY2FsZT1lLkVsZW1lbnQuZXh0ZW5kKHtpbml0aWFsaXplOmZ1bmN0aW9uKCl7dGhpcy5zaXplPW0oW3RoaXMuaGVpZ2h0LHRoaXMud2lkdGhdKSx0aGlzLmRyYXdpbmdBcmVhPXRoaXMuZGlzcGxheT90aGlzLnNpemUvMi0odGhpcy5mb250U2l6ZS8yK3RoaXMuYmFja2Ryb3BQYWRkaW5nWSk6dGhpcy5zaXplLzJ9LGNhbGN1bGF0ZUNlbnRlck9mZnNldDpmdW5jdGlvbih0KXt2YXIgaT10aGlzLmRyYXdpbmdBcmVhLyh0aGlzLm1heC10aGlzLm1pbik7cmV0dXJuKHQtdGhpcy5taW4pKml9LHVwZGF0ZTpmdW5jdGlvbigpe3RoaXMubGluZUFyYz90aGlzLmRyYXdpbmdBcmVhPXRoaXMuZGlzcGxheT90aGlzLnNpemUvMi0odGhpcy5mb250U2l6ZS8yK3RoaXMuYmFja2Ryb3BQYWRkaW5nWSk6dGhpcy5zaXplLzI6dGhpcy5zZXRTY2FsZVNpemUoKSx0aGlzLmJ1aWxkWUxhYmVscygpfSxidWlsZFlMYWJlbHM6ZnVuY3Rpb24oKXt0aGlzLnlMYWJlbHM9W107Zm9yKHZhciB0PXYodGhpcy5zdGVwVmFsdWUpLGk9MDtpPD10aGlzLnN0ZXBzO2krKyl0aGlzLnlMYWJlbHMucHVzaChDKHRoaXMudGVtcGxhdGVTdHJpbmcse3ZhbHVlOih0aGlzLm1pbitpKnRoaXMuc3RlcFZhbHVlKS50b0ZpeGVkKHQpfSkpfSxnZXRDaXJjdW1mZXJlbmNlOmZ1bmN0aW9uKCl7cmV0dXJuIDIqTWF0aC5QSS90aGlzLnZhbHVlc0NvdW50fSxzZXRTY2FsZVNpemU6ZnVuY3Rpb24oKXt2YXIgdCxpLGUscyxuLG8sYSxoLGwscixjLHUsZD1tKFt0aGlzLmhlaWdodC8yLXRoaXMucG9pbnRMYWJlbEZvbnRTaXplLTUsdGhpcy53aWR0aC8yXSkscD10aGlzLndpZHRoLGc9MDtmb3IodGhpcy5jdHguZm9udD1NKHRoaXMucG9pbnRMYWJlbEZvbnRTaXplLHRoaXMucG9pbnRMYWJlbEZvbnRTdHlsZSx0aGlzLnBvaW50TGFiZWxGb250RmFtaWx5KSxpPTA7aTx0aGlzLnZhbHVlc0NvdW50O2krKyl0PXRoaXMuZ2V0UG9pbnRQb3NpdGlvbihpLGQpLGU9dGhpcy5jdHgubWVhc3VyZVRleHQoQyh0aGlzLnRlbXBsYXRlU3RyaW5nLHt2YWx1ZTp0aGlzLmxhYmVsc1tpXX0pKS53aWR0aCs1LDA9PT1pfHxpPT09dGhpcy52YWx1ZXNDb3VudC8yPyhzPWUvMix0Lngrcz5wJiYocD10LngrcyxuPWkpLHQueC1zPGcmJihnPXQueC1zLGE9aSkpOmk8dGhpcy52YWx1ZXNDb3VudC8yP3QueCtlPnAmJihwPXQueCtlLG49aSk6aT50aGlzLnZhbHVlc0NvdW50LzImJnQueC1lPGcmJihnPXQueC1lLGE9aSk7bD1nLHI9TWF0aC5jZWlsKHAtdGhpcy53aWR0aCksbz10aGlzLmdldEluZGV4QW5nbGUobiksaD10aGlzLmdldEluZGV4QW5nbGUoYSksYz1yL01hdGguc2luKG8rTWF0aC5QSS8yKSx1PWwvTWF0aC5zaW4oaCtNYXRoLlBJLzIpLGM9ZihjKT9jOjAsdT1mKHUpP3U6MCx0aGlzLmRyYXdpbmdBcmVhPWQtKHUrYykvMix0aGlzLnNldENlbnRlclBvaW50KHUsYyl9LHNldENlbnRlclBvaW50OmZ1bmN0aW9uKHQsaSl7dmFyIGU9dGhpcy53aWR0aC1pLXRoaXMuZHJhd2luZ0FyZWEscz10K3RoaXMuZHJhd2luZ0FyZWE7dGhpcy54Q2VudGVyPShzK2UpLzIsdGhpcy55Q2VudGVyPXRoaXMuaGVpZ2h0LzJ9LGdldEluZGV4QW5nbGU6ZnVuY3Rpb24odCl7dmFyIGk9MipNYXRoLlBJL3RoaXMudmFsdWVzQ291bnQ7cmV0dXJuIHQqaS1NYXRoLlBJLzJ9LGdldFBvaW50UG9zaXRpb246ZnVuY3Rpb24odCxpKXt2YXIgZT10aGlzLmdldEluZGV4QW5nbGUodCk7cmV0dXJue3g6TWF0aC5jb3MoZSkqaSt0aGlzLnhDZW50ZXIseTpNYXRoLnNpbihlKSppK3RoaXMueUNlbnRlcn19LGRyYXc6ZnVuY3Rpb24oKXtpZih0aGlzLmRpc3BsYXkpe3ZhciB0PXRoaXMuY3R4O2lmKG4odGhpcy55TGFiZWxzLGZ1bmN0aW9uKGksZSl7aWYoZT4wKXt2YXIgcyxuPWUqKHRoaXMuZHJhd2luZ0FyZWEvdGhpcy5zdGVwcyksbz10aGlzLnlDZW50ZXItbjtpZih0aGlzLmxpbmVXaWR0aD4wKWlmKHQuc3Ryb2tlU3R5bGU9dGhpcy5saW5lQ29sb3IsdC5saW5lV2lkdGg9dGhpcy5saW5lV2lkdGgsdGhpcy5saW5lQXJjKXQuYmVnaW5QYXRoKCksdC5hcmModGhpcy54Q2VudGVyLHRoaXMueUNlbnRlcixuLDAsMipNYXRoLlBJKSx0LmNsb3NlUGF0aCgpLHQuc3Ryb2tlKCk7ZWxzZXt0LmJlZ2luUGF0aCgpO2Zvcih2YXIgYT0wO2E8dGhpcy52YWx1ZXNDb3VudDthKyspcz10aGlzLmdldFBvaW50UG9zaXRpb24oYSx0aGlzLmNhbGN1bGF0ZUNlbnRlck9mZnNldCh0aGlzLm1pbitlKnRoaXMuc3RlcFZhbHVlKSksMD09PWE/dC5tb3ZlVG8ocy54LHMueSk6dC5saW5lVG8ocy54LHMueSk7dC5jbG9zZVBhdGgoKSx0LnN0cm9rZSgpfWlmKHRoaXMuc2hvd0xhYmVscyl7aWYodC5mb250PU0odGhpcy5mb250U2l6ZSx0aGlzLmZvbnRTdHlsZSx0aGlzLmZvbnRGYW1pbHkpLHRoaXMuc2hvd0xhYmVsQmFja2Ryb3Ape3ZhciBoPXQubWVhc3VyZVRleHQoaSkud2lkdGg7dC5maWxsU3R5bGU9dGhpcy5iYWNrZHJvcENvbG9yLHQuZmlsbFJlY3QodGhpcy54Q2VudGVyLWgvMi10aGlzLmJhY2tkcm9wUGFkZGluZ1gsby10aGlzLmZvbnRTaXplLzItdGhpcy5iYWNrZHJvcFBhZGRpbmdZLGgrMip0aGlzLmJhY2tkcm9wUGFkZGluZ1gsdGhpcy5mb250U2l6ZSsyKnRoaXMuYmFja2Ryb3BQYWRkaW5nWSl9dC50ZXh0QWxpZ249XCJjZW50ZXJcIix0LnRleHRCYXNlbGluZT1cIm1pZGRsZVwiLHQuZmlsbFN0eWxlPXRoaXMuZm9udENvbG9yLHQuZmlsbFRleHQoaSx0aGlzLnhDZW50ZXIsbyl9fX0sdGhpcyksIXRoaXMubGluZUFyYyl7dC5saW5lV2lkdGg9dGhpcy5hbmdsZUxpbmVXaWR0aCx0LnN0cm9rZVN0eWxlPXRoaXMuYW5nbGVMaW5lQ29sb3I7Zm9yKHZhciBpPXRoaXMudmFsdWVzQ291bnQtMTtpPj0wO2ktLSl7aWYodGhpcy5hbmdsZUxpbmVXaWR0aD4wKXt2YXIgZT10aGlzLmdldFBvaW50UG9zaXRpb24oaSx0aGlzLmNhbGN1bGF0ZUNlbnRlck9mZnNldCh0aGlzLm1heCkpO3QuYmVnaW5QYXRoKCksdC5tb3ZlVG8odGhpcy54Q2VudGVyLHRoaXMueUNlbnRlciksdC5saW5lVG8oZS54LGUueSksdC5zdHJva2UoKSx0LmNsb3NlUGF0aCgpfXZhciBzPXRoaXMuZ2V0UG9pbnRQb3NpdGlvbihpLHRoaXMuY2FsY3VsYXRlQ2VudGVyT2Zmc2V0KHRoaXMubWF4KSs1KTt0LmZvbnQ9TSh0aGlzLnBvaW50TGFiZWxGb250U2l6ZSx0aGlzLnBvaW50TGFiZWxGb250U3R5bGUsdGhpcy5wb2ludExhYmVsRm9udEZhbWlseSksdC5maWxsU3R5bGU9dGhpcy5wb2ludExhYmVsRm9udENvbG9yO3ZhciBvPXRoaXMubGFiZWxzLmxlbmd0aCxhPXRoaXMubGFiZWxzLmxlbmd0aC8yLGg9YS8yLGw9aD5pfHxpPm8taCxyPWk9PT1ofHxpPT09by1oO3QudGV4dEFsaWduPTA9PT1pP1wiY2VudGVyXCI6aT09PWE/XCJjZW50ZXJcIjphPmk/XCJsZWZ0XCI6XCJyaWdodFwiLHQudGV4dEJhc2VsaW5lPXI/XCJtaWRkbGVcIjpsP1wiYm90dG9tXCI6XCJ0b3BcIix0LmZpbGxUZXh0KHRoaXMubGFiZWxzW2ldLHMueCxzLnkpfX19fX0pLHMuYWRkRXZlbnQod2luZG93LFwicmVzaXplXCIsZnVuY3Rpb24oKXt2YXIgdDtyZXR1cm4gZnVuY3Rpb24oKXtjbGVhclRpbWVvdXQodCksdD1zZXRUaW1lb3V0KGZ1bmN0aW9uKCl7bihlLmluc3RhbmNlcyxmdW5jdGlvbih0KXt0Lm9wdGlvbnMucmVzcG9uc2l2ZSYmdC5yZXNpemUodC5yZW5kZXIsITApfSl9LDUwKX19KCkpLHA/ZGVmaW5lKGZ1bmN0aW9uKCl7cmV0dXJuIGV9KTpcIm9iamVjdFwiPT10eXBlb2YgbW9kdWxlJiZtb2R1bGUuZXhwb3J0cyYmKG1vZHVsZS5leHBvcnRzPWUpLHQuQ2hhcnQ9ZSxlLm5vQ29uZmxpY3Q9ZnVuY3Rpb24oKXtyZXR1cm4gdC5DaGFydD1pLGV9fSkuY2FsbCh0aGlzKSxmdW5jdGlvbigpe1widXNlIHN0cmljdFwiO3ZhciB0PXRoaXMsaT10LkNoYXJ0LGU9aS5oZWxwZXJzLHM9e3NjYWxlQmVnaW5BdFplcm86ITAsc2NhbGVTaG93R3JpZExpbmVzOiEwLHNjYWxlR3JpZExpbmVDb2xvcjpcInJnYmEoMCwwLDAsLjA1KVwiLHNjYWxlR3JpZExpbmVXaWR0aDoxLHNjYWxlU2hvd0hvcml6b250YWxMaW5lczohMCxzY2FsZVNob3dWZXJ0aWNhbExpbmVzOiEwLGJhclNob3dTdHJva2U6ITAsYmFyU3Ryb2tlV2lkdGg6MixiYXJWYWx1ZVNwYWNpbmc6NSxiYXJEYXRhc2V0U3BhY2luZzoxLGxlZ2VuZFRlbXBsYXRlOic8dWwgY2xhc3M9XCI8JT1uYW1lLnRvTG93ZXJDYXNlKCklPi1sZWdlbmRcIj48JSBmb3IgKHZhciBpPTA7IGk8ZGF0YXNldHMubGVuZ3RoOyBpKyspeyU+PGxpPjxzcGFuIHN0eWxlPVwiYmFja2dyb3VuZC1jb2xvcjo8JT1kYXRhc2V0c1tpXS5maWxsQ29sb3IlPlwiPjwvc3Bhbj48JWlmKGRhdGFzZXRzW2ldLmxhYmVsKXslPjwlPWRhdGFzZXRzW2ldLmxhYmVsJT48JX0lPjwvbGk+PCV9JT48L3VsPid9O2kuVHlwZS5leHRlbmQoe25hbWU6XCJCYXJcIixkZWZhdWx0czpzLGluaXRpYWxpemU6ZnVuY3Rpb24odCl7dmFyIHM9dGhpcy5vcHRpb25zO3RoaXMuU2NhbGVDbGFzcz1pLlNjYWxlLmV4dGVuZCh7b2Zmc2V0R3JpZExpbmVzOiEwLGNhbGN1bGF0ZUJhclg6ZnVuY3Rpb24odCxpLGUpe3ZhciBuPXRoaXMuY2FsY3VsYXRlQmFzZVdpZHRoKCksbz10aGlzLmNhbGN1bGF0ZVgoZSktbi8yLGE9dGhpcy5jYWxjdWxhdGVCYXJXaWR0aCh0KTtyZXR1cm4gbythKmkraSpzLmJhckRhdGFzZXRTcGFjaW5nK2EvMn0sY2FsY3VsYXRlQmFzZVdpZHRoOmZ1bmN0aW9uKCl7cmV0dXJuIHRoaXMuY2FsY3VsYXRlWCgxKS10aGlzLmNhbGN1bGF0ZVgoMCktMipzLmJhclZhbHVlU3BhY2luZ30sY2FsY3VsYXRlQmFyV2lkdGg6ZnVuY3Rpb24odCl7dmFyIGk9dGhpcy5jYWxjdWxhdGVCYXNlV2lkdGgoKS0odC0xKSpzLmJhckRhdGFzZXRTcGFjaW5nO3JldHVybiBpL3R9fSksdGhpcy5kYXRhc2V0cz1bXSx0aGlzLm9wdGlvbnMuc2hvd1Rvb2x0aXBzJiZlLmJpbmRFdmVudHModGhpcyx0aGlzLm9wdGlvbnMudG9vbHRpcEV2ZW50cyxmdW5jdGlvbih0KXt2YXIgaT1cIm1vdXNlb3V0XCIhPT10LnR5cGU/dGhpcy5nZXRCYXJzQXRFdmVudCh0KTpbXTt0aGlzLmVhY2hCYXJzKGZ1bmN0aW9uKHQpe3QucmVzdG9yZShbXCJmaWxsQ29sb3JcIixcInN0cm9rZUNvbG9yXCJdKX0pLGUuZWFjaChpLGZ1bmN0aW9uKHQpe3QuZmlsbENvbG9yPXQuaGlnaGxpZ2h0RmlsbCx0LnN0cm9rZUNvbG9yPXQuaGlnaGxpZ2h0U3Ryb2tlfSksdGhpcy5zaG93VG9vbHRpcChpKX0pLHRoaXMuQmFyQ2xhc3M9aS5SZWN0YW5nbGUuZXh0ZW5kKHtzdHJva2VXaWR0aDp0aGlzLm9wdGlvbnMuYmFyU3Ryb2tlV2lkdGgsc2hvd1N0cm9rZTp0aGlzLm9wdGlvbnMuYmFyU2hvd1N0cm9rZSxjdHg6dGhpcy5jaGFydC5jdHh9KSxlLmVhY2godC5kYXRhc2V0cyxmdW5jdGlvbihpKXt2YXIgcz17bGFiZWw6aS5sYWJlbHx8bnVsbCxmaWxsQ29sb3I6aS5maWxsQ29sb3Isc3Ryb2tlQ29sb3I6aS5zdHJva2VDb2xvcixiYXJzOltdfTt0aGlzLmRhdGFzZXRzLnB1c2gocyksZS5lYWNoKGkuZGF0YSxmdW5jdGlvbihlLG4pe3MuYmFycy5wdXNoKG5ldyB0aGlzLkJhckNsYXNzKHt2YWx1ZTplLGxhYmVsOnQubGFiZWxzW25dLGRhdGFzZXRMYWJlbDppLmxhYmVsLHN0cm9rZUNvbG9yOmkuc3Ryb2tlQ29sb3IsZmlsbENvbG9yOmkuZmlsbENvbG9yLGhpZ2hsaWdodEZpbGw6aS5oaWdobGlnaHRGaWxsfHxpLmZpbGxDb2xvcixoaWdobGlnaHRTdHJva2U6aS5oaWdobGlnaHRTdHJva2V8fGkuc3Ryb2tlQ29sb3J9KSl9LHRoaXMpfSx0aGlzKSx0aGlzLmJ1aWxkU2NhbGUodC5sYWJlbHMpLHRoaXMuQmFyQ2xhc3MucHJvdG90eXBlLmJhc2U9dGhpcy5zY2FsZS5lbmRQb2ludCx0aGlzLmVhY2hCYXJzKGZ1bmN0aW9uKHQsaSxzKXtlLmV4dGVuZCh0LHt3aWR0aDp0aGlzLnNjYWxlLmNhbGN1bGF0ZUJhcldpZHRoKHRoaXMuZGF0YXNldHMubGVuZ3RoKSx4OnRoaXMuc2NhbGUuY2FsY3VsYXRlQmFyWCh0aGlzLmRhdGFzZXRzLmxlbmd0aCxzLGkpLHk6dGhpcy5zY2FsZS5lbmRQb2ludH0pLHQuc2F2ZSgpfSx0aGlzKSx0aGlzLnJlbmRlcigpfSx1cGRhdGU6ZnVuY3Rpb24oKXt0aGlzLnNjYWxlLnVwZGF0ZSgpLGUuZWFjaCh0aGlzLmFjdGl2ZUVsZW1lbnRzLGZ1bmN0aW9uKHQpe3QucmVzdG9yZShbXCJmaWxsQ29sb3JcIixcInN0cm9rZUNvbG9yXCJdKX0pLHRoaXMuZWFjaEJhcnMoZnVuY3Rpb24odCl7dC5zYXZlKCl9KSx0aGlzLnJlbmRlcigpfSxlYWNoQmFyczpmdW5jdGlvbih0KXtlLmVhY2godGhpcy5kYXRhc2V0cyxmdW5jdGlvbihpLHMpe2UuZWFjaChpLmJhcnMsdCx0aGlzLHMpfSx0aGlzKX0sZ2V0QmFyc0F0RXZlbnQ6ZnVuY3Rpb24odCl7Zm9yKHZhciBpLHM9W10sbj1lLmdldFJlbGF0aXZlUG9zaXRpb24odCksbz1mdW5jdGlvbih0KXtzLnB1c2godC5iYXJzW2ldKX0sYT0wO2E8dGhpcy5kYXRhc2V0cy5sZW5ndGg7YSsrKWZvcihpPTA7aTx0aGlzLmRhdGFzZXRzW2FdLmJhcnMubGVuZ3RoO2krKylpZih0aGlzLmRhdGFzZXRzW2FdLmJhcnNbaV0uaW5SYW5nZShuLngsbi55KSlyZXR1cm4gZS5lYWNoKHRoaXMuZGF0YXNldHMsbykscztyZXR1cm4gc30sYnVpbGRTY2FsZTpmdW5jdGlvbih0KXt2YXIgaT10aGlzLHM9ZnVuY3Rpb24oKXt2YXIgdD1bXTtyZXR1cm4gaS5lYWNoQmFycyhmdW5jdGlvbihpKXt0LnB1c2goaS52YWx1ZSl9KSx0fSxuPXt0ZW1wbGF0ZVN0cmluZzp0aGlzLm9wdGlvbnMuc2NhbGVMYWJlbCxoZWlnaHQ6dGhpcy5jaGFydC5oZWlnaHQsd2lkdGg6dGhpcy5jaGFydC53aWR0aCxjdHg6dGhpcy5jaGFydC5jdHgsdGV4dENvbG9yOnRoaXMub3B0aW9ucy5zY2FsZUZvbnRDb2xvcixmb250U2l6ZTp0aGlzLm9wdGlvbnMuc2NhbGVGb250U2l6ZSxmb250U3R5bGU6dGhpcy5vcHRpb25zLnNjYWxlRm9udFN0eWxlLGZvbnRGYW1pbHk6dGhpcy5vcHRpb25zLnNjYWxlRm9udEZhbWlseSx2YWx1ZXNDb3VudDp0Lmxlbmd0aCxiZWdpbkF0WmVybzp0aGlzLm9wdGlvbnMuc2NhbGVCZWdpbkF0WmVybyxpbnRlZ2Vyc09ubHk6dGhpcy5vcHRpb25zLnNjYWxlSW50ZWdlcnNPbmx5LGNhbGN1bGF0ZVlSYW5nZTpmdW5jdGlvbih0KXt2YXIgaT1lLmNhbGN1bGF0ZVNjYWxlUmFuZ2UocygpLHQsdGhpcy5mb250U2l6ZSx0aGlzLmJlZ2luQXRaZXJvLHRoaXMuaW50ZWdlcnNPbmx5KTtlLmV4dGVuZCh0aGlzLGkpfSx4TGFiZWxzOnQsZm9udDplLmZvbnRTdHJpbmcodGhpcy5vcHRpb25zLnNjYWxlRm9udFNpemUsdGhpcy5vcHRpb25zLnNjYWxlRm9udFN0eWxlLHRoaXMub3B0aW9ucy5zY2FsZUZvbnRGYW1pbHkpLGxpbmVXaWR0aDp0aGlzLm9wdGlvbnMuc2NhbGVMaW5lV2lkdGgsbGluZUNvbG9yOnRoaXMub3B0aW9ucy5zY2FsZUxpbmVDb2xvcixzaG93SG9yaXpvbnRhbExpbmVzOnRoaXMub3B0aW9ucy5zY2FsZVNob3dIb3Jpem9udGFsTGluZXMsc2hvd1ZlcnRpY2FsTGluZXM6dGhpcy5vcHRpb25zLnNjYWxlU2hvd1ZlcnRpY2FsTGluZXMsZ3JpZExpbmVXaWR0aDp0aGlzLm9wdGlvbnMuc2NhbGVTaG93R3JpZExpbmVzP3RoaXMub3B0aW9ucy5zY2FsZUdyaWRMaW5lV2lkdGg6MCxncmlkTGluZUNvbG9yOnRoaXMub3B0aW9ucy5zY2FsZVNob3dHcmlkTGluZXM/dGhpcy5vcHRpb25zLnNjYWxlR3JpZExpbmVDb2xvcjpcInJnYmEoMCwwLDAsMClcIixwYWRkaW5nOnRoaXMub3B0aW9ucy5zaG93U2NhbGU/MDp0aGlzLm9wdGlvbnMuYmFyU2hvd1N0cm9rZT90aGlzLm9wdGlvbnMuYmFyU3Ryb2tlV2lkdGg6MCxzaG93TGFiZWxzOnRoaXMub3B0aW9ucy5zY2FsZVNob3dMYWJlbHMsZGlzcGxheTp0aGlzLm9wdGlvbnMuc2hvd1NjYWxlfTt0aGlzLm9wdGlvbnMuc2NhbGVPdmVycmlkZSYmZS5leHRlbmQobix7Y2FsY3VsYXRlWVJhbmdlOmUubm9vcCxzdGVwczp0aGlzLm9wdGlvbnMuc2NhbGVTdGVwcyxzdGVwVmFsdWU6dGhpcy5vcHRpb25zLnNjYWxlU3RlcFdpZHRoLG1pbjp0aGlzLm9wdGlvbnMuc2NhbGVTdGFydFZhbHVlLG1heDp0aGlzLm9wdGlvbnMuc2NhbGVTdGFydFZhbHVlK3RoaXMub3B0aW9ucy5zY2FsZVN0ZXBzKnRoaXMub3B0aW9ucy5zY2FsZVN0ZXBXaWR0aH0pLHRoaXMuc2NhbGU9bmV3IHRoaXMuU2NhbGVDbGFzcyhuKX0sYWRkRGF0YTpmdW5jdGlvbih0LGkpe2UuZWFjaCh0LGZ1bmN0aW9uKHQsZSl7dGhpcy5kYXRhc2V0c1tlXS5iYXJzLnB1c2gobmV3IHRoaXMuQmFyQ2xhc3Moe3ZhbHVlOnQsbGFiZWw6aSx4OnRoaXMuc2NhbGUuY2FsY3VsYXRlQmFyWCh0aGlzLmRhdGFzZXRzLmxlbmd0aCxlLHRoaXMuc2NhbGUudmFsdWVzQ291bnQrMSkseTp0aGlzLnNjYWxlLmVuZFBvaW50LHdpZHRoOnRoaXMuc2NhbGUuY2FsY3VsYXRlQmFyV2lkdGgodGhpcy5kYXRhc2V0cy5sZW5ndGgpLGJhc2U6dGhpcy5zY2FsZS5lbmRQb2ludCxzdHJva2VDb2xvcjp0aGlzLmRhdGFzZXRzW2VdLnN0cm9rZUNvbG9yLGZpbGxDb2xvcjp0aGlzLmRhdGFzZXRzW2VdLmZpbGxDb2xvcn0pKX0sdGhpcyksdGhpcy5zY2FsZS5hZGRYTGFiZWwoaSksdGhpcy51cGRhdGUoKX0scmVtb3ZlRGF0YTpmdW5jdGlvbigpe3RoaXMuc2NhbGUucmVtb3ZlWExhYmVsKCksZS5lYWNoKHRoaXMuZGF0YXNldHMsZnVuY3Rpb24odCl7dC5iYXJzLnNoaWZ0KCl9LHRoaXMpLHRoaXMudXBkYXRlKCl9LHJlZmxvdzpmdW5jdGlvbigpe2UuZXh0ZW5kKHRoaXMuQmFyQ2xhc3MucHJvdG90eXBlLHt5OnRoaXMuc2NhbGUuZW5kUG9pbnQsYmFzZTp0aGlzLnNjYWxlLmVuZFBvaW50fSk7XG52YXIgdD1lLmV4dGVuZCh7aGVpZ2h0OnRoaXMuY2hhcnQuaGVpZ2h0LHdpZHRoOnRoaXMuY2hhcnQud2lkdGh9KTt0aGlzLnNjYWxlLnVwZGF0ZSh0KX0sZHJhdzpmdW5jdGlvbih0KXt2YXIgaT10fHwxO3RoaXMuY2xlYXIoKTt0aGlzLmNoYXJ0LmN0eDt0aGlzLnNjYWxlLmRyYXcoaSksZS5lYWNoKHRoaXMuZGF0YXNldHMsZnVuY3Rpb24odCxzKXtlLmVhY2godC5iYXJzLGZ1bmN0aW9uKHQsZSl7dC5oYXNWYWx1ZSgpJiYodC5iYXNlPXRoaXMuc2NhbGUuZW5kUG9pbnQsdC50cmFuc2l0aW9uKHt4OnRoaXMuc2NhbGUuY2FsY3VsYXRlQmFyWCh0aGlzLmRhdGFzZXRzLmxlbmd0aCxzLGUpLHk6dGhpcy5zY2FsZS5jYWxjdWxhdGVZKHQudmFsdWUpLHdpZHRoOnRoaXMuc2NhbGUuY2FsY3VsYXRlQmFyV2lkdGgodGhpcy5kYXRhc2V0cy5sZW5ndGgpfSxpKS5kcmF3KCkpfSx0aGlzKX0sdGhpcyl9fSl9LmNhbGwodGhpcyksZnVuY3Rpb24oKXtcInVzZSBzdHJpY3RcIjt2YXIgdD10aGlzLGk9dC5DaGFydCxlPWkuaGVscGVycyxzPXtzZWdtZW50U2hvd1N0cm9rZTohMCxzZWdtZW50U3Ryb2tlQ29sb3I6XCIjZmZmXCIsc2VnbWVudFN0cm9rZVdpZHRoOjIscGVyY2VudGFnZUlubmVyQ3V0b3V0OjUwLGFuaW1hdGlvblN0ZXBzOjEwMCxhbmltYXRpb25FYXNpbmc6XCJlYXNlT3V0Qm91bmNlXCIsYW5pbWF0ZVJvdGF0ZTohMCxhbmltYXRlU2NhbGU6ITEsbGVnZW5kVGVtcGxhdGU6Jzx1bCBjbGFzcz1cIjwlPW5hbWUudG9Mb3dlckNhc2UoKSU+LWxlZ2VuZFwiPjwlIGZvciAodmFyIGk9MDsgaTxzZWdtZW50cy5sZW5ndGg7IGkrKyl7JT48bGk+PHNwYW4gc3R5bGU9XCJiYWNrZ3JvdW5kLWNvbG9yOjwlPXNlZ21lbnRzW2ldLmZpbGxDb2xvciU+XCI+PC9zcGFuPjwlaWYoc2VnbWVudHNbaV0ubGFiZWwpeyU+PCU9c2VnbWVudHNbaV0ubGFiZWwlPjwlfSU+PC9saT48JX0lPjwvdWw+J307aS5UeXBlLmV4dGVuZCh7bmFtZTpcIkRvdWdobnV0XCIsZGVmYXVsdHM6cyxpbml0aWFsaXplOmZ1bmN0aW9uKHQpe3RoaXMuc2VnbWVudHM9W10sdGhpcy5vdXRlclJhZGl1cz0oZS5taW4oW3RoaXMuY2hhcnQud2lkdGgsdGhpcy5jaGFydC5oZWlnaHRdKS10aGlzLm9wdGlvbnMuc2VnbWVudFN0cm9rZVdpZHRoLzIpLzIsdGhpcy5TZWdtZW50QXJjPWkuQXJjLmV4dGVuZCh7Y3R4OnRoaXMuY2hhcnQuY3R4LHg6dGhpcy5jaGFydC53aWR0aC8yLHk6dGhpcy5jaGFydC5oZWlnaHQvMn0pLHRoaXMub3B0aW9ucy5zaG93VG9vbHRpcHMmJmUuYmluZEV2ZW50cyh0aGlzLHRoaXMub3B0aW9ucy50b29sdGlwRXZlbnRzLGZ1bmN0aW9uKHQpe3ZhciBpPVwibW91c2VvdXRcIiE9PXQudHlwZT90aGlzLmdldFNlZ21lbnRzQXRFdmVudCh0KTpbXTtlLmVhY2godGhpcy5zZWdtZW50cyxmdW5jdGlvbih0KXt0LnJlc3RvcmUoW1wiZmlsbENvbG9yXCJdKX0pLGUuZWFjaChpLGZ1bmN0aW9uKHQpe3QuZmlsbENvbG9yPXQuaGlnaGxpZ2h0Q29sb3J9KSx0aGlzLnNob3dUb29sdGlwKGkpfSksdGhpcy5jYWxjdWxhdGVUb3RhbCh0KSxlLmVhY2godCxmdW5jdGlvbih0LGkpe3RoaXMuYWRkRGF0YSh0LGksITApfSx0aGlzKSx0aGlzLnJlbmRlcigpfSxnZXRTZWdtZW50c0F0RXZlbnQ6ZnVuY3Rpb24odCl7dmFyIGk9W10scz1lLmdldFJlbGF0aXZlUG9zaXRpb24odCk7cmV0dXJuIGUuZWFjaCh0aGlzLnNlZ21lbnRzLGZ1bmN0aW9uKHQpe3QuaW5SYW5nZShzLngscy55KSYmaS5wdXNoKHQpfSx0aGlzKSxpfSxhZGREYXRhOmZ1bmN0aW9uKHQsaSxlKXt2YXIgcz1pfHx0aGlzLnNlZ21lbnRzLmxlbmd0aDt0aGlzLnNlZ21lbnRzLnNwbGljZShzLDAsbmV3IHRoaXMuU2VnbWVudEFyYyh7dmFsdWU6dC52YWx1ZSxvdXRlclJhZGl1czp0aGlzLm9wdGlvbnMuYW5pbWF0ZVNjYWxlPzA6dGhpcy5vdXRlclJhZGl1cyxpbm5lclJhZGl1czp0aGlzLm9wdGlvbnMuYW5pbWF0ZVNjYWxlPzA6dGhpcy5vdXRlclJhZGl1cy8xMDAqdGhpcy5vcHRpb25zLnBlcmNlbnRhZ2VJbm5lckN1dG91dCxmaWxsQ29sb3I6dC5jb2xvcixoaWdobGlnaHRDb2xvcjp0LmhpZ2hsaWdodHx8dC5jb2xvcixzaG93U3Ryb2tlOnRoaXMub3B0aW9ucy5zZWdtZW50U2hvd1N0cm9rZSxzdHJva2VXaWR0aDp0aGlzLm9wdGlvbnMuc2VnbWVudFN0cm9rZVdpZHRoLHN0cm9rZUNvbG9yOnRoaXMub3B0aW9ucy5zZWdtZW50U3Ryb2tlQ29sb3Isc3RhcnRBbmdsZToxLjUqTWF0aC5QSSxjaXJjdW1mZXJlbmNlOnRoaXMub3B0aW9ucy5hbmltYXRlUm90YXRlPzA6dGhpcy5jYWxjdWxhdGVDaXJjdW1mZXJlbmNlKHQudmFsdWUpLGxhYmVsOnQubGFiZWx9KSksZXx8KHRoaXMucmVmbG93KCksdGhpcy51cGRhdGUoKSl9LGNhbGN1bGF0ZUNpcmN1bWZlcmVuY2U6ZnVuY3Rpb24odCl7cmV0dXJuIDIqTWF0aC5QSSoodC90aGlzLnRvdGFsKX0sY2FsY3VsYXRlVG90YWw6ZnVuY3Rpb24odCl7dGhpcy50b3RhbD0wLGUuZWFjaCh0LGZ1bmN0aW9uKHQpe3RoaXMudG90YWwrPXQudmFsdWV9LHRoaXMpfSx1cGRhdGU6ZnVuY3Rpb24oKXt0aGlzLmNhbGN1bGF0ZVRvdGFsKHRoaXMuc2VnbWVudHMpLGUuZWFjaCh0aGlzLmFjdGl2ZUVsZW1lbnRzLGZ1bmN0aW9uKHQpe3QucmVzdG9yZShbXCJmaWxsQ29sb3JcIl0pfSksZS5lYWNoKHRoaXMuc2VnbWVudHMsZnVuY3Rpb24odCl7dC5zYXZlKCl9KSx0aGlzLnJlbmRlcigpfSxyZW1vdmVEYXRhOmZ1bmN0aW9uKHQpe3ZhciBpPWUuaXNOdW1iZXIodCk/dDp0aGlzLnNlZ21lbnRzLmxlbmd0aC0xO3RoaXMuc2VnbWVudHMuc3BsaWNlKGksMSksdGhpcy5yZWZsb3coKSx0aGlzLnVwZGF0ZSgpfSxyZWZsb3c6ZnVuY3Rpb24oKXtlLmV4dGVuZCh0aGlzLlNlZ21lbnRBcmMucHJvdG90eXBlLHt4OnRoaXMuY2hhcnQud2lkdGgvMix5OnRoaXMuY2hhcnQuaGVpZ2h0LzJ9KSx0aGlzLm91dGVyUmFkaXVzPShlLm1pbihbdGhpcy5jaGFydC53aWR0aCx0aGlzLmNoYXJ0LmhlaWdodF0pLXRoaXMub3B0aW9ucy5zZWdtZW50U3Ryb2tlV2lkdGgvMikvMixlLmVhY2godGhpcy5zZWdtZW50cyxmdW5jdGlvbih0KXt0LnVwZGF0ZSh7b3V0ZXJSYWRpdXM6dGhpcy5vdXRlclJhZGl1cyxpbm5lclJhZGl1czp0aGlzLm91dGVyUmFkaXVzLzEwMCp0aGlzLm9wdGlvbnMucGVyY2VudGFnZUlubmVyQ3V0b3V0fSl9LHRoaXMpfSxkcmF3OmZ1bmN0aW9uKHQpe3ZhciBpPXQ/dDoxO3RoaXMuY2xlYXIoKSxlLmVhY2godGhpcy5zZWdtZW50cyxmdW5jdGlvbih0LGUpe3QudHJhbnNpdGlvbih7Y2lyY3VtZmVyZW5jZTp0aGlzLmNhbGN1bGF0ZUNpcmN1bWZlcmVuY2UodC52YWx1ZSksb3V0ZXJSYWRpdXM6dGhpcy5vdXRlclJhZGl1cyxpbm5lclJhZGl1czp0aGlzLm91dGVyUmFkaXVzLzEwMCp0aGlzLm9wdGlvbnMucGVyY2VudGFnZUlubmVyQ3V0b3V0fSxpKSx0LmVuZEFuZ2xlPXQuc3RhcnRBbmdsZSt0LmNpcmN1bWZlcmVuY2UsdC5kcmF3KCksMD09PWUmJih0LnN0YXJ0QW5nbGU9MS41Kk1hdGguUEkpLGU8dGhpcy5zZWdtZW50cy5sZW5ndGgtMSYmKHRoaXMuc2VnbWVudHNbZSsxXS5zdGFydEFuZ2xlPXQuZW5kQW5nbGUpfSx0aGlzKX19KSxpLnR5cGVzLkRvdWdobnV0LmV4dGVuZCh7bmFtZTpcIlBpZVwiLGRlZmF1bHRzOmUubWVyZ2Uocyx7cGVyY2VudGFnZUlubmVyQ3V0b3V0OjB9KX0pfS5jYWxsKHRoaXMpLGZ1bmN0aW9uKCl7XCJ1c2Ugc3RyaWN0XCI7dmFyIHQ9dGhpcyxpPXQuQ2hhcnQsZT1pLmhlbHBlcnMscz17c2NhbGVTaG93R3JpZExpbmVzOiEwLHNjYWxlR3JpZExpbmVDb2xvcjpcInJnYmEoMCwwLDAsLjA1KVwiLHNjYWxlR3JpZExpbmVXaWR0aDoxLHNjYWxlU2hvd0hvcml6b250YWxMaW5lczohMCxzY2FsZVNob3dWZXJ0aWNhbExpbmVzOiEwLGJlemllckN1cnZlOiEwLGJlemllckN1cnZlVGVuc2lvbjouNCxwb2ludERvdDohMCxwb2ludERvdFJhZGl1czo0LHBvaW50RG90U3Ryb2tlV2lkdGg6MSxwb2ludEhpdERldGVjdGlvblJhZGl1czoyMCxkYXRhc2V0U3Ryb2tlOiEwLGRhdGFzZXRTdHJva2VXaWR0aDoyLGRhdGFzZXRGaWxsOiEwLGxlZ2VuZFRlbXBsYXRlOic8dWwgY2xhc3M9XCI8JT1uYW1lLnRvTG93ZXJDYXNlKCklPi1sZWdlbmRcIj48JSBmb3IgKHZhciBpPTA7IGk8ZGF0YXNldHMubGVuZ3RoOyBpKyspeyU+PGxpPjxzcGFuIHN0eWxlPVwiYmFja2dyb3VuZC1jb2xvcjo8JT1kYXRhc2V0c1tpXS5zdHJva2VDb2xvciU+XCI+PC9zcGFuPjwlaWYoZGF0YXNldHNbaV0ubGFiZWwpeyU+PCU9ZGF0YXNldHNbaV0ubGFiZWwlPjwlfSU+PC9saT48JX0lPjwvdWw+J307aS5UeXBlLmV4dGVuZCh7bmFtZTpcIkxpbmVcIixkZWZhdWx0czpzLGluaXRpYWxpemU6ZnVuY3Rpb24odCl7dGhpcy5Qb2ludENsYXNzPWkuUG9pbnQuZXh0ZW5kKHtzdHJva2VXaWR0aDp0aGlzLm9wdGlvbnMucG9pbnREb3RTdHJva2VXaWR0aCxyYWRpdXM6dGhpcy5vcHRpb25zLnBvaW50RG90UmFkaXVzLGRpc3BsYXk6dGhpcy5vcHRpb25zLnBvaW50RG90LGhpdERldGVjdGlvblJhZGl1czp0aGlzLm9wdGlvbnMucG9pbnRIaXREZXRlY3Rpb25SYWRpdXMsY3R4OnRoaXMuY2hhcnQuY3R4LGluUmFuZ2U6ZnVuY3Rpb24odCl7cmV0dXJuIE1hdGgucG93KHQtdGhpcy54LDIpPE1hdGgucG93KHRoaXMucmFkaXVzK3RoaXMuaGl0RGV0ZWN0aW9uUmFkaXVzLDIpfX0pLHRoaXMuZGF0YXNldHM9W10sdGhpcy5vcHRpb25zLnNob3dUb29sdGlwcyYmZS5iaW5kRXZlbnRzKHRoaXMsdGhpcy5vcHRpb25zLnRvb2x0aXBFdmVudHMsZnVuY3Rpb24odCl7dmFyIGk9XCJtb3VzZW91dFwiIT09dC50eXBlP3RoaXMuZ2V0UG9pbnRzQXRFdmVudCh0KTpbXTt0aGlzLmVhY2hQb2ludHMoZnVuY3Rpb24odCl7dC5yZXN0b3JlKFtcImZpbGxDb2xvclwiLFwic3Ryb2tlQ29sb3JcIl0pfSksZS5lYWNoKGksZnVuY3Rpb24odCl7dC5maWxsQ29sb3I9dC5oaWdobGlnaHRGaWxsLHQuc3Ryb2tlQ29sb3I9dC5oaWdobGlnaHRTdHJva2V9KSx0aGlzLnNob3dUb29sdGlwKGkpfSksZS5lYWNoKHQuZGF0YXNldHMsZnVuY3Rpb24oaSl7dmFyIHM9e2xhYmVsOmkubGFiZWx8fG51bGwsZmlsbENvbG9yOmkuZmlsbENvbG9yLHN0cm9rZUNvbG9yOmkuc3Ryb2tlQ29sb3IscG9pbnRDb2xvcjppLnBvaW50Q29sb3IscG9pbnRTdHJva2VDb2xvcjppLnBvaW50U3Ryb2tlQ29sb3IscG9pbnRzOltdfTt0aGlzLmRhdGFzZXRzLnB1c2gocyksZS5lYWNoKGkuZGF0YSxmdW5jdGlvbihlLG4pe3MucG9pbnRzLnB1c2gobmV3IHRoaXMuUG9pbnRDbGFzcyh7dmFsdWU6ZSxsYWJlbDp0LmxhYmVsc1tuXSxkYXRhc2V0TGFiZWw6aS5sYWJlbCxzdHJva2VDb2xvcjppLnBvaW50U3Ryb2tlQ29sb3IsZmlsbENvbG9yOmkucG9pbnRDb2xvcixoaWdobGlnaHRGaWxsOmkucG9pbnRIaWdobGlnaHRGaWxsfHxpLnBvaW50Q29sb3IsaGlnaGxpZ2h0U3Ryb2tlOmkucG9pbnRIaWdobGlnaHRTdHJva2V8fGkucG9pbnRTdHJva2VDb2xvcn0pKX0sdGhpcyksdGhpcy5idWlsZFNjYWxlKHQubGFiZWxzKSx0aGlzLmVhY2hQb2ludHMoZnVuY3Rpb24odCxpKXtlLmV4dGVuZCh0LHt4OnRoaXMuc2NhbGUuY2FsY3VsYXRlWChpKSx5OnRoaXMuc2NhbGUuZW5kUG9pbnR9KSx0LnNhdmUoKX0sdGhpcyl9LHRoaXMpLHRoaXMucmVuZGVyKCl9LHVwZGF0ZTpmdW5jdGlvbigpe3RoaXMuc2NhbGUudXBkYXRlKCksZS5lYWNoKHRoaXMuYWN0aXZlRWxlbWVudHMsZnVuY3Rpb24odCl7dC5yZXN0b3JlKFtcImZpbGxDb2xvclwiLFwic3Ryb2tlQ29sb3JcIl0pfSksdGhpcy5lYWNoUG9pbnRzKGZ1bmN0aW9uKHQpe3Quc2F2ZSgpfSksdGhpcy5yZW5kZXIoKX0sZWFjaFBvaW50czpmdW5jdGlvbih0KXtlLmVhY2godGhpcy5kYXRhc2V0cyxmdW5jdGlvbihpKXtlLmVhY2goaS5wb2ludHMsdCx0aGlzKX0sdGhpcyl9LGdldFBvaW50c0F0RXZlbnQ6ZnVuY3Rpb24odCl7dmFyIGk9W10scz1lLmdldFJlbGF0aXZlUG9zaXRpb24odCk7cmV0dXJuIGUuZWFjaCh0aGlzLmRhdGFzZXRzLGZ1bmN0aW9uKHQpe2UuZWFjaCh0LnBvaW50cyxmdW5jdGlvbih0KXt0LmluUmFuZ2Uocy54LHMueSkmJmkucHVzaCh0KX0pfSx0aGlzKSxpfSxidWlsZFNjYWxlOmZ1bmN0aW9uKHQpe3ZhciBzPXRoaXMsbj1mdW5jdGlvbigpe3ZhciB0PVtdO3JldHVybiBzLmVhY2hQb2ludHMoZnVuY3Rpb24oaSl7dC5wdXNoKGkudmFsdWUpfSksdH0sbz17dGVtcGxhdGVTdHJpbmc6dGhpcy5vcHRpb25zLnNjYWxlTGFiZWwsaGVpZ2h0OnRoaXMuY2hhcnQuaGVpZ2h0LHdpZHRoOnRoaXMuY2hhcnQud2lkdGgsY3R4OnRoaXMuY2hhcnQuY3R4LHRleHRDb2xvcjp0aGlzLm9wdGlvbnMuc2NhbGVGb250Q29sb3IsZm9udFNpemU6dGhpcy5vcHRpb25zLnNjYWxlRm9udFNpemUsZm9udFN0eWxlOnRoaXMub3B0aW9ucy5zY2FsZUZvbnRTdHlsZSxmb250RmFtaWx5OnRoaXMub3B0aW9ucy5zY2FsZUZvbnRGYW1pbHksdmFsdWVzQ291bnQ6dC5sZW5ndGgsYmVnaW5BdFplcm86dGhpcy5vcHRpb25zLnNjYWxlQmVnaW5BdFplcm8saW50ZWdlcnNPbmx5OnRoaXMub3B0aW9ucy5zY2FsZUludGVnZXJzT25seSxjYWxjdWxhdGVZUmFuZ2U6ZnVuY3Rpb24odCl7dmFyIGk9ZS5jYWxjdWxhdGVTY2FsZVJhbmdlKG4oKSx0LHRoaXMuZm9udFNpemUsdGhpcy5iZWdpbkF0WmVybyx0aGlzLmludGVnZXJzT25seSk7ZS5leHRlbmQodGhpcyxpKX0seExhYmVsczp0LGZvbnQ6ZS5mb250U3RyaW5nKHRoaXMub3B0aW9ucy5zY2FsZUZvbnRTaXplLHRoaXMub3B0aW9ucy5zY2FsZUZvbnRTdHlsZSx0aGlzLm9wdGlvbnMuc2NhbGVGb250RmFtaWx5KSxsaW5lV2lkdGg6dGhpcy5vcHRpb25zLnNjYWxlTGluZVdpZHRoLGxpbmVDb2xvcjp0aGlzLm9wdGlvbnMuc2NhbGVMaW5lQ29sb3Isc2hvd0hvcml6b250YWxMaW5lczp0aGlzLm9wdGlvbnMuc2NhbGVTaG93SG9yaXpvbnRhbExpbmVzLHNob3dWZXJ0aWNhbExpbmVzOnRoaXMub3B0aW9ucy5zY2FsZVNob3dWZXJ0aWNhbExpbmVzLGdyaWRMaW5lV2lkdGg6dGhpcy5vcHRpb25zLnNjYWxlU2hvd0dyaWRMaW5lcz90aGlzLm9wdGlvbnMuc2NhbGVHcmlkTGluZVdpZHRoOjAsZ3JpZExpbmVDb2xvcjp0aGlzLm9wdGlvbnMuc2NhbGVTaG93R3JpZExpbmVzP3RoaXMub3B0aW9ucy5zY2FsZUdyaWRMaW5lQ29sb3I6XCJyZ2JhKDAsMCwwLDApXCIscGFkZGluZzp0aGlzLm9wdGlvbnMuc2hvd1NjYWxlPzA6dGhpcy5vcHRpb25zLnBvaW50RG90UmFkaXVzK3RoaXMub3B0aW9ucy5wb2ludERvdFN0cm9rZVdpZHRoLHNob3dMYWJlbHM6dGhpcy5vcHRpb25zLnNjYWxlU2hvd0xhYmVscyxkaXNwbGF5OnRoaXMub3B0aW9ucy5zaG93U2NhbGV9O3RoaXMub3B0aW9ucy5zY2FsZU92ZXJyaWRlJiZlLmV4dGVuZChvLHtjYWxjdWxhdGVZUmFuZ2U6ZS5ub29wLHN0ZXBzOnRoaXMub3B0aW9ucy5zY2FsZVN0ZXBzLHN0ZXBWYWx1ZTp0aGlzLm9wdGlvbnMuc2NhbGVTdGVwV2lkdGgsbWluOnRoaXMub3B0aW9ucy5zY2FsZVN0YXJ0VmFsdWUsbWF4OnRoaXMub3B0aW9ucy5zY2FsZVN0YXJ0VmFsdWUrdGhpcy5vcHRpb25zLnNjYWxlU3RlcHMqdGhpcy5vcHRpb25zLnNjYWxlU3RlcFdpZHRofSksdGhpcy5zY2FsZT1uZXcgaS5TY2FsZShvKX0sYWRkRGF0YTpmdW5jdGlvbih0LGkpe2UuZWFjaCh0LGZ1bmN0aW9uKHQsZSl7dGhpcy5kYXRhc2V0c1tlXS5wb2ludHMucHVzaChuZXcgdGhpcy5Qb2ludENsYXNzKHt2YWx1ZTp0LGxhYmVsOmkseDp0aGlzLnNjYWxlLmNhbGN1bGF0ZVgodGhpcy5zY2FsZS52YWx1ZXNDb3VudCsxKSx5OnRoaXMuc2NhbGUuZW5kUG9pbnQsc3Ryb2tlQ29sb3I6dGhpcy5kYXRhc2V0c1tlXS5wb2ludFN0cm9rZUNvbG9yLGZpbGxDb2xvcjp0aGlzLmRhdGFzZXRzW2VdLnBvaW50Q29sb3J9KSl9LHRoaXMpLHRoaXMuc2NhbGUuYWRkWExhYmVsKGkpLHRoaXMudXBkYXRlKCl9LHJlbW92ZURhdGE6ZnVuY3Rpb24oKXt0aGlzLnNjYWxlLnJlbW92ZVhMYWJlbCgpLGUuZWFjaCh0aGlzLmRhdGFzZXRzLGZ1bmN0aW9uKHQpe3QucG9pbnRzLnNoaWZ0KCl9LHRoaXMpLHRoaXMudXBkYXRlKCl9LHJlZmxvdzpmdW5jdGlvbigpe3ZhciB0PWUuZXh0ZW5kKHtoZWlnaHQ6dGhpcy5jaGFydC5oZWlnaHQsd2lkdGg6dGhpcy5jaGFydC53aWR0aH0pO3RoaXMuc2NhbGUudXBkYXRlKHQpfSxkcmF3OmZ1bmN0aW9uKHQpe3ZhciBpPXR8fDE7dGhpcy5jbGVhcigpO3ZhciBzPXRoaXMuY2hhcnQuY3R4LG49ZnVuY3Rpb24odCl7cmV0dXJuIG51bGwhPT10LnZhbHVlfSxvPWZ1bmN0aW9uKHQsaSxzKXtyZXR1cm4gZS5maW5kTmV4dFdoZXJlKGksbixzKXx8dH0sYT1mdW5jdGlvbih0LGkscyl7cmV0dXJuIGUuZmluZFByZXZpb3VzV2hlcmUoaSxuLHMpfHx0fTt0aGlzLnNjYWxlLmRyYXcoaSksZS5lYWNoKHRoaXMuZGF0YXNldHMsZnVuY3Rpb24odCl7dmFyIGg9ZS53aGVyZSh0LnBvaW50cyxuKTtlLmVhY2godC5wb2ludHMsZnVuY3Rpb24odCxlKXt0Lmhhc1ZhbHVlKCkmJnQudHJhbnNpdGlvbih7eTp0aGlzLnNjYWxlLmNhbGN1bGF0ZVkodC52YWx1ZSkseDp0aGlzLnNjYWxlLmNhbGN1bGF0ZVgoZSl9LGkpfSx0aGlzKSx0aGlzLm9wdGlvbnMuYmV6aWVyQ3VydmUmJmUuZWFjaChoLGZ1bmN0aW9uKHQsaSl7dmFyIHM9aT4wJiZpPGgubGVuZ3RoLTE/dGhpcy5vcHRpb25zLmJlemllckN1cnZlVGVuc2lvbjowO3QuY29udHJvbFBvaW50cz1lLnNwbGluZUN1cnZlKGEodCxoLGkpLHQsbyh0LGgsaSkscyksdC5jb250cm9sUG9pbnRzLm91dGVyLnk+dGhpcy5zY2FsZS5lbmRQb2ludD90LmNvbnRyb2xQb2ludHMub3V0ZXIueT10aGlzLnNjYWxlLmVuZFBvaW50OnQuY29udHJvbFBvaW50cy5vdXRlci55PHRoaXMuc2NhbGUuc3RhcnRQb2ludCYmKHQuY29udHJvbFBvaW50cy5vdXRlci55PXRoaXMuc2NhbGUuc3RhcnRQb2ludCksdC5jb250cm9sUG9pbnRzLmlubmVyLnk+dGhpcy5zY2FsZS5lbmRQb2ludD90LmNvbnRyb2xQb2ludHMuaW5uZXIueT10aGlzLnNjYWxlLmVuZFBvaW50OnQuY29udHJvbFBvaW50cy5pbm5lci55PHRoaXMuc2NhbGUuc3RhcnRQb2ludCYmKHQuY29udHJvbFBvaW50cy5pbm5lci55PXRoaXMuc2NhbGUuc3RhcnRQb2ludCl9LHRoaXMpLHMubGluZVdpZHRoPXRoaXMub3B0aW9ucy5kYXRhc2V0U3Ryb2tlV2lkdGgscy5zdHJva2VTdHlsZT10LnN0cm9rZUNvbG9yLHMuYmVnaW5QYXRoKCksZS5lYWNoKGgsZnVuY3Rpb24odCxpKXtpZigwPT09aSlzLm1vdmVUbyh0LngsdC55KTtlbHNlIGlmKHRoaXMub3B0aW9ucy5iZXppZXJDdXJ2ZSl7dmFyIGU9YSh0LGgsaSk7cy5iZXppZXJDdXJ2ZVRvKGUuY29udHJvbFBvaW50cy5vdXRlci54LGUuY29udHJvbFBvaW50cy5vdXRlci55LHQuY29udHJvbFBvaW50cy5pbm5lci54LHQuY29udHJvbFBvaW50cy5pbm5lci55LHQueCx0LnkpfWVsc2Ugcy5saW5lVG8odC54LHQueSl9LHRoaXMpLHMuc3Ryb2tlKCksdGhpcy5vcHRpb25zLmRhdGFzZXRGaWxsJiZoLmxlbmd0aD4wJiYocy5saW5lVG8oaFtoLmxlbmd0aC0xXS54LHRoaXMuc2NhbGUuZW5kUG9pbnQpLHMubGluZVRvKGhbMF0ueCx0aGlzLnNjYWxlLmVuZFBvaW50KSxzLmZpbGxTdHlsZT10LmZpbGxDb2xvcixzLmNsb3NlUGF0aCgpLHMuZmlsbCgpKSxlLmVhY2goaCxmdW5jdGlvbih0KXt0LmRyYXcoKX0pfSx0aGlzKX19KX0uY2FsbCh0aGlzKSxmdW5jdGlvbigpe1widXNlIHN0cmljdFwiO3ZhciB0PXRoaXMsaT10LkNoYXJ0LGU9aS5oZWxwZXJzLHM9e3NjYWxlU2hvd0xhYmVsQmFja2Ryb3A6ITAsc2NhbGVCYWNrZHJvcENvbG9yOlwicmdiYSgyNTUsMjU1LDI1NSwwLjc1KVwiLHNjYWxlQmVnaW5BdFplcm86ITAsc2NhbGVCYWNrZHJvcFBhZGRpbmdZOjIsc2NhbGVCYWNrZHJvcFBhZGRpbmdYOjIsc2NhbGVTaG93TGluZTohMCxzZWdtZW50U2hvd1N0cm9rZTohMCxzZWdtZW50U3Ryb2tlQ29sb3I6XCIjZmZmXCIsc2VnbWVudFN0cm9rZVdpZHRoOjIsYW5pbWF0aW9uU3RlcHM6MTAwLGFuaW1hdGlvbkVhc2luZzpcImVhc2VPdXRCb3VuY2VcIixhbmltYXRlUm90YXRlOiEwLGFuaW1hdGVTY2FsZTohMSxsZWdlbmRUZW1wbGF0ZTonPHVsIGNsYXNzPVwiPCU9bmFtZS50b0xvd2VyQ2FzZSgpJT4tbGVnZW5kXCI+PCUgZm9yICh2YXIgaT0wOyBpPHNlZ21lbnRzLmxlbmd0aDsgaSsrKXslPjxsaT48c3BhbiBzdHlsZT1cImJhY2tncm91bmQtY29sb3I6PCU9c2VnbWVudHNbaV0uZmlsbENvbG9yJT5cIj48L3NwYW4+PCVpZihzZWdtZW50c1tpXS5sYWJlbCl7JT48JT1zZWdtZW50c1tpXS5sYWJlbCU+PCV9JT48L2xpPjwlfSU+PC91bD4nfTtpLlR5cGUuZXh0ZW5kKHtuYW1lOlwiUG9sYXJBcmVhXCIsZGVmYXVsdHM6cyxpbml0aWFsaXplOmZ1bmN0aW9uKHQpe3RoaXMuc2VnbWVudHM9W10sdGhpcy5TZWdtZW50QXJjPWkuQXJjLmV4dGVuZCh7c2hvd1N0cm9rZTp0aGlzLm9wdGlvbnMuc2VnbWVudFNob3dTdHJva2Usc3Ryb2tlV2lkdGg6dGhpcy5vcHRpb25zLnNlZ21lbnRTdHJva2VXaWR0aCxzdHJva2VDb2xvcjp0aGlzLm9wdGlvbnMuc2VnbWVudFN0cm9rZUNvbG9yLGN0eDp0aGlzLmNoYXJ0LmN0eCxpbm5lclJhZGl1czowLHg6dGhpcy5jaGFydC53aWR0aC8yLHk6dGhpcy5jaGFydC5oZWlnaHQvMn0pLHRoaXMuc2NhbGU9bmV3IGkuUmFkaWFsU2NhbGUoe2Rpc3BsYXk6dGhpcy5vcHRpb25zLnNob3dTY2FsZSxmb250U3R5bGU6dGhpcy5vcHRpb25zLnNjYWxlRm9udFN0eWxlLGZvbnRTaXplOnRoaXMub3B0aW9ucy5zY2FsZUZvbnRTaXplLGZvbnRGYW1pbHk6dGhpcy5vcHRpb25zLnNjYWxlRm9udEZhbWlseSxmb250Q29sb3I6dGhpcy5vcHRpb25zLnNjYWxlRm9udENvbG9yLHNob3dMYWJlbHM6dGhpcy5vcHRpb25zLnNjYWxlU2hvd0xhYmVscyxzaG93TGFiZWxCYWNrZHJvcDp0aGlzLm9wdGlvbnMuc2NhbGVTaG93TGFiZWxCYWNrZHJvcCxiYWNrZHJvcENvbG9yOnRoaXMub3B0aW9ucy5zY2FsZUJhY2tkcm9wQ29sb3IsYmFja2Ryb3BQYWRkaW5nWTp0aGlzLm9wdGlvbnMuc2NhbGVCYWNrZHJvcFBhZGRpbmdZLGJhY2tkcm9wUGFkZGluZ1g6dGhpcy5vcHRpb25zLnNjYWxlQmFja2Ryb3BQYWRkaW5nWCxsaW5lV2lkdGg6dGhpcy5vcHRpb25zLnNjYWxlU2hvd0xpbmU/dGhpcy5vcHRpb25zLnNjYWxlTGluZVdpZHRoOjAsbGluZUNvbG9yOnRoaXMub3B0aW9ucy5zY2FsZUxpbmVDb2xvcixsaW5lQXJjOiEwLHdpZHRoOnRoaXMuY2hhcnQud2lkdGgsaGVpZ2h0OnRoaXMuY2hhcnQuaGVpZ2h0LHhDZW50ZXI6dGhpcy5jaGFydC53aWR0aC8yLHlDZW50ZXI6dGhpcy5jaGFydC5oZWlnaHQvMixjdHg6dGhpcy5jaGFydC5jdHgsdGVtcGxhdGVTdHJpbmc6dGhpcy5vcHRpb25zLnNjYWxlTGFiZWwsdmFsdWVzQ291bnQ6dC5sZW5ndGh9KSx0aGlzLnVwZGF0ZVNjYWxlUmFuZ2UodCksdGhpcy5zY2FsZS51cGRhdGUoKSxlLmVhY2godCxmdW5jdGlvbih0LGkpe3RoaXMuYWRkRGF0YSh0LGksITApfSx0aGlzKSx0aGlzLm9wdGlvbnMuc2hvd1Rvb2x0aXBzJiZlLmJpbmRFdmVudHModGhpcyx0aGlzLm9wdGlvbnMudG9vbHRpcEV2ZW50cyxmdW5jdGlvbih0KXt2YXIgaT1cIm1vdXNlb3V0XCIhPT10LnR5cGU/dGhpcy5nZXRTZWdtZW50c0F0RXZlbnQodCk6W107ZS5lYWNoKHRoaXMuc2VnbWVudHMsZnVuY3Rpb24odCl7dC5yZXN0b3JlKFtcImZpbGxDb2xvclwiXSl9KSxlLmVhY2goaSxmdW5jdGlvbih0KXt0LmZpbGxDb2xvcj10LmhpZ2hsaWdodENvbG9yfSksdGhpcy5zaG93VG9vbHRpcChpKX0pLHRoaXMucmVuZGVyKCl9LGdldFNlZ21lbnRzQXRFdmVudDpmdW5jdGlvbih0KXt2YXIgaT1bXSxzPWUuZ2V0UmVsYXRpdmVQb3NpdGlvbih0KTtyZXR1cm4gZS5lYWNoKHRoaXMuc2VnbWVudHMsZnVuY3Rpb24odCl7dC5pblJhbmdlKHMueCxzLnkpJiZpLnB1c2godCl9LHRoaXMpLGl9LGFkZERhdGE6ZnVuY3Rpb24odCxpLGUpe3ZhciBzPWl8fHRoaXMuc2VnbWVudHMubGVuZ3RoO3RoaXMuc2VnbWVudHMuc3BsaWNlKHMsMCxuZXcgdGhpcy5TZWdtZW50QXJjKHtmaWxsQ29sb3I6dC5jb2xvcixoaWdobGlnaHRDb2xvcjp0LmhpZ2hsaWdodHx8dC5jb2xvcixsYWJlbDp0LmxhYmVsLHZhbHVlOnQudmFsdWUsb3V0ZXJSYWRpdXM6dGhpcy5vcHRpb25zLmFuaW1hdGVTY2FsZT8wOnRoaXMuc2NhbGUuY2FsY3VsYXRlQ2VudGVyT2Zmc2V0KHQudmFsdWUpLGNpcmN1bWZlcmVuY2U6dGhpcy5vcHRpb25zLmFuaW1hdGVSb3RhdGU/MDp0aGlzLnNjYWxlLmdldENpcmN1bWZlcmVuY2UoKSxzdGFydEFuZ2xlOjEuNSpNYXRoLlBJfSkpLGV8fCh0aGlzLnJlZmxvdygpLHRoaXMudXBkYXRlKCkpfSxyZW1vdmVEYXRhOmZ1bmN0aW9uKHQpe3ZhciBpPWUuaXNOdW1iZXIodCk/dDp0aGlzLnNlZ21lbnRzLmxlbmd0aC0xO3RoaXMuc2VnbWVudHMuc3BsaWNlKGksMSksdGhpcy5yZWZsb3coKSx0aGlzLnVwZGF0ZSgpfSxjYWxjdWxhdGVUb3RhbDpmdW5jdGlvbih0KXt0aGlzLnRvdGFsPTAsZS5lYWNoKHQsZnVuY3Rpb24odCl7dGhpcy50b3RhbCs9dC52YWx1ZX0sdGhpcyksdGhpcy5zY2FsZS52YWx1ZXNDb3VudD10aGlzLnNlZ21lbnRzLmxlbmd0aH0sdXBkYXRlU2NhbGVSYW5nZTpmdW5jdGlvbih0KXt2YXIgaT1bXTtlLmVhY2godCxmdW5jdGlvbih0KXtpLnB1c2godC52YWx1ZSl9KTt2YXIgcz10aGlzLm9wdGlvbnMuc2NhbGVPdmVycmlkZT97c3RlcHM6dGhpcy5vcHRpb25zLnNjYWxlU3RlcHMsc3RlcFZhbHVlOnRoaXMub3B0aW9ucy5zY2FsZVN0ZXBXaWR0aCxtaW46dGhpcy5vcHRpb25zLnNjYWxlU3RhcnRWYWx1ZSxtYXg6dGhpcy5vcHRpb25zLnNjYWxlU3RhcnRWYWx1ZSt0aGlzLm9wdGlvbnMuc2NhbGVTdGVwcyp0aGlzLm9wdGlvbnMuc2NhbGVTdGVwV2lkdGh9OmUuY2FsY3VsYXRlU2NhbGVSYW5nZShpLGUubWluKFt0aGlzLmNoYXJ0LndpZHRoLHRoaXMuY2hhcnQuaGVpZ2h0XSkvMix0aGlzLm9wdGlvbnMuc2NhbGVGb250U2l6ZSx0aGlzLm9wdGlvbnMuc2NhbGVCZWdpbkF0WmVybyx0aGlzLm9wdGlvbnMuc2NhbGVJbnRlZ2Vyc09ubHkpO2UuZXh0ZW5kKHRoaXMuc2NhbGUscyx7c2l6ZTplLm1pbihbdGhpcy5jaGFydC53aWR0aCx0aGlzLmNoYXJ0LmhlaWdodF0pLHhDZW50ZXI6dGhpcy5jaGFydC53aWR0aC8yLHlDZW50ZXI6dGhpcy5jaGFydC5oZWlnaHQvMn0pfSx1cGRhdGU6ZnVuY3Rpb24oKXt0aGlzLmNhbGN1bGF0ZVRvdGFsKHRoaXMuc2VnbWVudHMpLGUuZWFjaCh0aGlzLnNlZ21lbnRzLGZ1bmN0aW9uKHQpe3Quc2F2ZSgpfSksdGhpcy5yZW5kZXIoKX0scmVmbG93OmZ1bmN0aW9uKCl7ZS5leHRlbmQodGhpcy5TZWdtZW50QXJjLnByb3RvdHlwZSx7eDp0aGlzLmNoYXJ0LndpZHRoLzIseTp0aGlzLmNoYXJ0LmhlaWdodC8yfSksdGhpcy51cGRhdGVTY2FsZVJhbmdlKHRoaXMuc2VnbWVudHMpLHRoaXMuc2NhbGUudXBkYXRlKCksZS5leHRlbmQodGhpcy5zY2FsZSx7eENlbnRlcjp0aGlzLmNoYXJ0LndpZHRoLzIseUNlbnRlcjp0aGlzLmNoYXJ0LmhlaWdodC8yfSksZS5lYWNoKHRoaXMuc2VnbWVudHMsZnVuY3Rpb24odCl7dC51cGRhdGUoe291dGVyUmFkaXVzOnRoaXMuc2NhbGUuY2FsY3VsYXRlQ2VudGVyT2Zmc2V0KHQudmFsdWUpfSl9LHRoaXMpfSxkcmF3OmZ1bmN0aW9uKHQpe3ZhciBpPXR8fDE7dGhpcy5jbGVhcigpLGUuZWFjaCh0aGlzLnNlZ21lbnRzLGZ1bmN0aW9uKHQsZSl7dC50cmFuc2l0aW9uKHtjaXJjdW1mZXJlbmNlOnRoaXMuc2NhbGUuZ2V0Q2lyY3VtZmVyZW5jZSgpLG91dGVyUmFkaXVzOnRoaXMuc2NhbGUuY2FsY3VsYXRlQ2VudGVyT2Zmc2V0KHQudmFsdWUpfSxpKSx0LmVuZEFuZ2xlPXQuc3RhcnRBbmdsZSt0LmNpcmN1bWZlcmVuY2UsMD09PWUmJih0LnN0YXJ0QW5nbGU9MS41Kk1hdGguUEkpLGU8dGhpcy5zZWdtZW50cy5sZW5ndGgtMSYmKHRoaXMuc2VnbWVudHNbZSsxXS5zdGFydEFuZ2xlPXQuZW5kQW5nbGUpLHQuZHJhdygpfSx0aGlzKSx0aGlzLnNjYWxlLmRyYXcoKX19KX0uY2FsbCh0aGlzKSxmdW5jdGlvbigpe1widXNlIHN0cmljdFwiO3ZhciB0PXRoaXMsaT10LkNoYXJ0LGU9aS5oZWxwZXJzO2kuVHlwZS5leHRlbmQoe25hbWU6XCJSYWRhclwiLGRlZmF1bHRzOntzY2FsZVNob3dMaW5lOiEwLGFuZ2xlU2hvd0xpbmVPdXQ6ITAsc2NhbGVTaG93TGFiZWxzOiExLHNjYWxlQmVnaW5BdFplcm86ITAsYW5nbGVMaW5lQ29sb3I6XCJyZ2JhKDAsMCwwLC4xKVwiLGFuZ2xlTGluZVdpZHRoOjEscG9pbnRMYWJlbEZvbnRGYW1pbHk6XCInQXJpYWwnXCIscG9pbnRMYWJlbEZvbnRTdHlsZTpcIm5vcm1hbFwiLHBvaW50TGFiZWxGb250U2l6ZToxMCxwb2ludExhYmVsRm9udENvbG9yOlwiIzY2NlwiLHBvaW50RG90OiEwLHBvaW50RG90UmFkaXVzOjMscG9pbnREb3RTdHJva2VXaWR0aDoxLHBvaW50SGl0RGV0ZWN0aW9uUmFkaXVzOjIwLGRhdGFzZXRTdHJva2U6ITAsZGF0YXNldFN0cm9rZVdpZHRoOjIsZGF0YXNldEZpbGw6ITAsbGVnZW5kVGVtcGxhdGU6Jzx1bCBjbGFzcz1cIjwlPW5hbWUudG9Mb3dlckNhc2UoKSU+LWxlZ2VuZFwiPjwlIGZvciAodmFyIGk9MDsgaTxkYXRhc2V0cy5sZW5ndGg7IGkrKyl7JT48bGk+PHNwYW4gc3R5bGU9XCJiYWNrZ3JvdW5kLWNvbG9yOjwlPWRhdGFzZXRzW2ldLnN0cm9rZUNvbG9yJT5cIj48L3NwYW4+PCVpZihkYXRhc2V0c1tpXS5sYWJlbCl7JT48JT1kYXRhc2V0c1tpXS5sYWJlbCU+PCV9JT48L2xpPjwlfSU+PC91bD4nfSxpbml0aWFsaXplOmZ1bmN0aW9uKHQpe3RoaXMuUG9pbnRDbGFzcz1pLlBvaW50LmV4dGVuZCh7c3Ryb2tlV2lkdGg6dGhpcy5vcHRpb25zLnBvaW50RG90U3Ryb2tlV2lkdGgscmFkaXVzOnRoaXMub3B0aW9ucy5wb2ludERvdFJhZGl1cyxkaXNwbGF5OnRoaXMub3B0aW9ucy5wb2ludERvdCxoaXREZXRlY3Rpb25SYWRpdXM6dGhpcy5vcHRpb25zLnBvaW50SGl0RGV0ZWN0aW9uUmFkaXVzLGN0eDp0aGlzLmNoYXJ0LmN0eH0pLHRoaXMuZGF0YXNldHM9W10sdGhpcy5idWlsZFNjYWxlKHQpLHRoaXMub3B0aW9ucy5zaG93VG9vbHRpcHMmJmUuYmluZEV2ZW50cyh0aGlzLHRoaXMub3B0aW9ucy50b29sdGlwRXZlbnRzLGZ1bmN0aW9uKHQpe3ZhciBpPVwibW91c2VvdXRcIiE9PXQudHlwZT90aGlzLmdldFBvaW50c0F0RXZlbnQodCk6W107dGhpcy5lYWNoUG9pbnRzKGZ1bmN0aW9uKHQpe3QucmVzdG9yZShbXCJmaWxsQ29sb3JcIixcInN0cm9rZUNvbG9yXCJdKX0pLGUuZWFjaChpLGZ1bmN0aW9uKHQpe3QuZmlsbENvbG9yPXQuaGlnaGxpZ2h0RmlsbCx0LnN0cm9rZUNvbG9yPXQuaGlnaGxpZ2h0U3Ryb2tlfSksdGhpcy5zaG93VG9vbHRpcChpKX0pLGUuZWFjaCh0LmRhdGFzZXRzLGZ1bmN0aW9uKGkpe3ZhciBzPXtsYWJlbDppLmxhYmVsfHxudWxsLGZpbGxDb2xvcjppLmZpbGxDb2xvcixzdHJva2VDb2xvcjppLnN0cm9rZUNvbG9yLHBvaW50Q29sb3I6aS5wb2ludENvbG9yLHBvaW50U3Ryb2tlQ29sb3I6aS5wb2ludFN0cm9rZUNvbG9yLHBvaW50czpbXX07dGhpcy5kYXRhc2V0cy5wdXNoKHMpLGUuZWFjaChpLmRhdGEsZnVuY3Rpb24oZSxuKXt2YXIgbzt0aGlzLnNjYWxlLmFuaW1hdGlvbnx8KG89dGhpcy5zY2FsZS5nZXRQb2ludFBvc2l0aW9uKG4sdGhpcy5zY2FsZS5jYWxjdWxhdGVDZW50ZXJPZmZzZXQoZSkpKSxzLnBvaW50cy5wdXNoKG5ldyB0aGlzLlBvaW50Q2xhc3Moe3ZhbHVlOmUsbGFiZWw6dC5sYWJlbHNbbl0sZGF0YXNldExhYmVsOmkubGFiZWwseDp0aGlzLm9wdGlvbnMuYW5pbWF0aW9uP3RoaXMuc2NhbGUueENlbnRlcjpvLngseTp0aGlzLm9wdGlvbnMuYW5pbWF0aW9uP3RoaXMuc2NhbGUueUNlbnRlcjpvLnksc3Ryb2tlQ29sb3I6aS5wb2ludFN0cm9rZUNvbG9yLGZpbGxDb2xvcjppLnBvaW50Q29sb3IsaGlnaGxpZ2h0RmlsbDppLnBvaW50SGlnaGxpZ2h0RmlsbHx8aS5wb2ludENvbG9yLGhpZ2hsaWdodFN0cm9rZTppLnBvaW50SGlnaGxpZ2h0U3Ryb2tlfHxpLnBvaW50U3Ryb2tlQ29sb3J9KSl9LHRoaXMpfSx0aGlzKSx0aGlzLnJlbmRlcigpfSxlYWNoUG9pbnRzOmZ1bmN0aW9uKHQpe2UuZWFjaCh0aGlzLmRhdGFzZXRzLGZ1bmN0aW9uKGkpe2UuZWFjaChpLnBvaW50cyx0LHRoaXMpfSx0aGlzKX0sZ2V0UG9pbnRzQXRFdmVudDpmdW5jdGlvbih0KXt2YXIgaT1lLmdldFJlbGF0aXZlUG9zaXRpb24odCkscz1lLmdldEFuZ2xlRnJvbVBvaW50KHt4OnRoaXMuc2NhbGUueENlbnRlcix5OnRoaXMuc2NhbGUueUNlbnRlcn0saSksbj0yKk1hdGguUEkvdGhpcy5zY2FsZS52YWx1ZXNDb3VudCxvPU1hdGgucm91bmQoKHMuYW5nbGUtMS41Kk1hdGguUEkpL24pLGE9W107cmV0dXJuKG8+PXRoaXMuc2NhbGUudmFsdWVzQ291bnR8fDA+bykmJihvPTApLHMuZGlzdGFuY2U8PXRoaXMuc2NhbGUuZHJhd2luZ0FyZWEmJmUuZWFjaCh0aGlzLmRhdGFzZXRzLGZ1bmN0aW9uKHQpe2EucHVzaCh0LnBvaW50c1tvXSl9KSxhfSxidWlsZFNjYWxlOmZ1bmN0aW9uKHQpe3RoaXMuc2NhbGU9bmV3IGkuUmFkaWFsU2NhbGUoe2Rpc3BsYXk6dGhpcy5vcHRpb25zLnNob3dTY2FsZSxmb250U3R5bGU6dGhpcy5vcHRpb25zLnNjYWxlRm9udFN0eWxlLGZvbnRTaXplOnRoaXMub3B0aW9ucy5zY2FsZUZvbnRTaXplLGZvbnRGYW1pbHk6dGhpcy5vcHRpb25zLnNjYWxlRm9udEZhbWlseSxmb250Q29sb3I6dGhpcy5vcHRpb25zLnNjYWxlRm9udENvbG9yLHNob3dMYWJlbHM6dGhpcy5vcHRpb25zLnNjYWxlU2hvd0xhYmVscyxzaG93TGFiZWxCYWNrZHJvcDp0aGlzLm9wdGlvbnMuc2NhbGVTaG93TGFiZWxCYWNrZHJvcCxiYWNrZHJvcENvbG9yOnRoaXMub3B0aW9ucy5zY2FsZUJhY2tkcm9wQ29sb3IsYmFja2Ryb3BQYWRkaW5nWTp0aGlzLm9wdGlvbnMuc2NhbGVCYWNrZHJvcFBhZGRpbmdZLGJhY2tkcm9wUGFkZGluZ1g6dGhpcy5vcHRpb25zLnNjYWxlQmFja2Ryb3BQYWRkaW5nWCxsaW5lV2lkdGg6dGhpcy5vcHRpb25zLnNjYWxlU2hvd0xpbmU/dGhpcy5vcHRpb25zLnNjYWxlTGluZVdpZHRoOjAsbGluZUNvbG9yOnRoaXMub3B0aW9ucy5zY2FsZUxpbmVDb2xvcixhbmdsZUxpbmVDb2xvcjp0aGlzLm9wdGlvbnMuYW5nbGVMaW5lQ29sb3IsYW5nbGVMaW5lV2lkdGg6dGhpcy5vcHRpb25zLmFuZ2xlU2hvd0xpbmVPdXQ/dGhpcy5vcHRpb25zLmFuZ2xlTGluZVdpZHRoOjAscG9pbnRMYWJlbEZvbnRDb2xvcjp0aGlzLm9wdGlvbnMucG9pbnRMYWJlbEZvbnRDb2xvcixwb2ludExhYmVsRm9udFNpemU6dGhpcy5vcHRpb25zLnBvaW50TGFiZWxGb250U2l6ZSxwb2ludExhYmVsRm9udEZhbWlseTp0aGlzLm9wdGlvbnMucG9pbnRMYWJlbEZvbnRGYW1pbHkscG9pbnRMYWJlbEZvbnRTdHlsZTp0aGlzLm9wdGlvbnMucG9pbnRMYWJlbEZvbnRTdHlsZSxoZWlnaHQ6dGhpcy5jaGFydC5oZWlnaHQsd2lkdGg6dGhpcy5jaGFydC53aWR0aCx4Q2VudGVyOnRoaXMuY2hhcnQud2lkdGgvMix5Q2VudGVyOnRoaXMuY2hhcnQuaGVpZ2h0LzIsY3R4OnRoaXMuY2hhcnQuY3R4LHRlbXBsYXRlU3RyaW5nOnRoaXMub3B0aW9ucy5zY2FsZUxhYmVsLGxhYmVsczp0LmxhYmVscyx2YWx1ZXNDb3VudDp0LmRhdGFzZXRzWzBdLmRhdGEubGVuZ3RofSksdGhpcy5zY2FsZS5zZXRTY2FsZVNpemUoKSx0aGlzLnVwZGF0ZVNjYWxlUmFuZ2UodC5kYXRhc2V0cyksdGhpcy5zY2FsZS5idWlsZFlMYWJlbHMoKX0sdXBkYXRlU2NhbGVSYW5nZTpmdW5jdGlvbih0KXt2YXIgaT1mdW5jdGlvbigpe3ZhciBpPVtdO3JldHVybiBlLmVhY2godCxmdW5jdGlvbih0KXt0LmRhdGE/aT1pLmNvbmNhdCh0LmRhdGEpOmUuZWFjaCh0LnBvaW50cyxmdW5jdGlvbih0KXtpLnB1c2godC52YWx1ZSl9KX0pLGl9KCkscz10aGlzLm9wdGlvbnMuc2NhbGVPdmVycmlkZT97c3RlcHM6dGhpcy5vcHRpb25zLnNjYWxlU3RlcHMsc3RlcFZhbHVlOnRoaXMub3B0aW9ucy5zY2FsZVN0ZXBXaWR0aCxtaW46dGhpcy5vcHRpb25zLnNjYWxlU3RhcnRWYWx1ZSxtYXg6dGhpcy5vcHRpb25zLnNjYWxlU3RhcnRWYWx1ZSt0aGlzLm9wdGlvbnMuc2NhbGVTdGVwcyp0aGlzLm9wdGlvbnMuc2NhbGVTdGVwV2lkdGh9OmUuY2FsY3VsYXRlU2NhbGVSYW5nZShpLGUubWluKFt0aGlzLmNoYXJ0LndpZHRoLHRoaXMuY2hhcnQuaGVpZ2h0XSkvMix0aGlzLm9wdGlvbnMuc2NhbGVGb250U2l6ZSx0aGlzLm9wdGlvbnMuc2NhbGVCZWdpbkF0WmVybyx0aGlzLm9wdGlvbnMuc2NhbGVJbnRlZ2Vyc09ubHkpO2UuZXh0ZW5kKHRoaXMuc2NhbGUscyl9LGFkZERhdGE6ZnVuY3Rpb24odCxpKXt0aGlzLnNjYWxlLnZhbHVlc0NvdW50KyssZS5lYWNoKHQsZnVuY3Rpb24odCxlKXt2YXIgcz10aGlzLnNjYWxlLmdldFBvaW50UG9zaXRpb24odGhpcy5zY2FsZS52YWx1ZXNDb3VudCx0aGlzLnNjYWxlLmNhbGN1bGF0ZUNlbnRlck9mZnNldCh0KSk7dGhpcy5kYXRhc2V0c1tlXS5wb2ludHMucHVzaChuZXcgdGhpcy5Qb2ludENsYXNzKHt2YWx1ZTp0LGxhYmVsOmkseDpzLngseTpzLnksc3Ryb2tlQ29sb3I6dGhpcy5kYXRhc2V0c1tlXS5wb2ludFN0cm9rZUNvbG9yLGZpbGxDb2xvcjp0aGlzLmRhdGFzZXRzW2VdLnBvaW50Q29sb3J9KSl9LHRoaXMpLHRoaXMuc2NhbGUubGFiZWxzLnB1c2goaSksdGhpcy5yZWZsb3coKSx0aGlzLnVwZGF0ZSgpfSxyZW1vdmVEYXRhOmZ1bmN0aW9uKCl7dGhpcy5zY2FsZS52YWx1ZXNDb3VudC0tLHRoaXMuc2NhbGUubGFiZWxzLnNoaWZ0KCksZS5lYWNoKHRoaXMuZGF0YXNldHMsZnVuY3Rpb24odCl7dC5wb2ludHMuc2hpZnQoKX0sdGhpcyksdGhpcy5yZWZsb3coKSx0aGlzLnVwZGF0ZSgpfSx1cGRhdGU6ZnVuY3Rpb24oKXt0aGlzLmVhY2hQb2ludHMoZnVuY3Rpb24odCl7dC5zYXZlKCl9KSx0aGlzLnJlZmxvdygpLHRoaXMucmVuZGVyKCl9LHJlZmxvdzpmdW5jdGlvbigpe2UuZXh0ZW5kKHRoaXMuc2NhbGUse3dpZHRoOnRoaXMuY2hhcnQud2lkdGgsaGVpZ2h0OnRoaXMuY2hhcnQuaGVpZ2h0LHNpemU6ZS5taW4oW3RoaXMuY2hhcnQud2lkdGgsdGhpcy5jaGFydC5oZWlnaHRdKSx4Q2VudGVyOnRoaXMuY2hhcnQud2lkdGgvMix5Q2VudGVyOnRoaXMuY2hhcnQuaGVpZ2h0LzJ9KSx0aGlzLnVwZGF0ZVNjYWxlUmFuZ2UodGhpcy5kYXRhc2V0cyksdGhpcy5zY2FsZS5zZXRTY2FsZVNpemUoKSx0aGlzLnNjYWxlLmJ1aWxkWUxhYmVscygpfSxkcmF3OmZ1bmN0aW9uKHQpe3ZhciBpPXR8fDEscz10aGlzLmNoYXJ0LmN0eDt0aGlzLmNsZWFyKCksdGhpcy5zY2FsZS5kcmF3KCksZS5lYWNoKHRoaXMuZGF0YXNldHMsZnVuY3Rpb24odCl7ZS5lYWNoKHQucG9pbnRzLGZ1bmN0aW9uKHQsZSl7dC5oYXNWYWx1ZSgpJiZ0LnRyYW5zaXRpb24odGhpcy5zY2FsZS5nZXRQb2ludFBvc2l0aW9uKGUsdGhpcy5zY2FsZS5jYWxjdWxhdGVDZW50ZXJPZmZzZXQodC52YWx1ZSkpLGkpfSx0aGlzKSxzLmxpbmVXaWR0aD10aGlzLm9wdGlvbnMuZGF0YXNldFN0cm9rZVdpZHRoLHMuc3Ryb2tlU3R5bGU9dC5zdHJva2VDb2xvcixzLmJlZ2luUGF0aCgpLGUuZWFjaCh0LnBvaW50cyxmdW5jdGlvbih0LGkpezA9PT1pP3MubW92ZVRvKHQueCx0LnkpOnMubGluZVRvKHQueCx0LnkpfSx0aGlzKSxzLmNsb3NlUGF0aCgpLHMuc3Ryb2tlKCkscy5maWxsU3R5bGU9dC5maWxsQ29sb3Iscy5maWxsKCksZS5lYWNoKHQucG9pbnRzLGZ1bmN0aW9uKHQpe3QuaGFzVmFsdWUoKSYmdC5kcmF3KCl9KX0sdGhpcyl9fSl9LmNhbGwodGhpcyk7IiwidmFyIENoYXJ0ID0gcmVxdWlyZSgnLi9DaGFydC5taW4nKTtcbkNoYXJ0LnR5cGVzLkxpbmUuZXh0ZW5kKHtcbiAgICAvLyBQYXNzaW5nIGluIGEgbmFtZSByZWdpc3RlcnMgdGhpcyBjaGFydCBpbiB0aGUgQ2hhcnQgbmFtZXNwYWNlIGluIHRoZSBzYW1lIHdheVxuICAgIG5hbWU6IFwiU2NhdHRlclwiLFxuICAgIGRyYXcgOiBmdW5jdGlvbihlYXNlKXtcbiAgICAgICAgICAgIHZhciBlYXNpbmdEZWNpbWFsID0gZWFzZSB8fCAxO1xuICAgICAgICAgICAgdGhpcy5jbGVhcigpO1xuXG4gICAgICAgICAgICB2YXIgY3R4ID0gdGhpcy5jaGFydC5jdHg7XG5cbiAgICAgICAgICAgIC8vIFNvbWUgaGVscGVyIG1ldGhvZHMgZm9yIGdldHRpbmcgdGhlIG5leHQvcHJldiBwb2ludHNcbiAgICAgICAgICAgIHZhciBoYXNWYWx1ZSA9IGZ1bmN0aW9uKGl0ZW0pe1xuICAgICAgICAgICAgICAgIHJldHVybiBpdGVtLnZhbHVlICE9PSBudWxsO1xuICAgICAgICAgICAgfSxcbiAgICAgICAgICAgIG5leHRQb2ludCA9IGZ1bmN0aW9uKHBvaW50LCBjb2xsZWN0aW9uLCBpbmRleCl7XG4gICAgICAgICAgICAgICAgcmV0dXJuIENoYXJ0LmhlbHBlcnMuZmluZE5leHRXaGVyZShjb2xsZWN0aW9uLCBoYXNWYWx1ZSwgaW5kZXgpIHx8IHBvaW50O1xuICAgICAgICAgICAgfSxcbiAgICAgICAgICAgIHByZXZpb3VzUG9pbnQgPSBmdW5jdGlvbihwb2ludCwgY29sbGVjdGlvbiwgaW5kZXgpe1xuICAgICAgICAgICAgICAgIHJldHVybiBDaGFydC5oZWxwZXJzLmZpbmRQcmV2aW91c1doZXJlKGNvbGxlY3Rpb24sIGhhc1ZhbHVlLCBpbmRleCkgfHwgcG9pbnQ7XG4gICAgICAgICAgICB9O1xuXG4gICAgICAgICAgICB0aGlzLnNjYWxlLmRyYXcoZWFzaW5nRGVjaW1hbCk7XG5cblxuICAgICAgICAgICAgQ2hhcnQuaGVscGVycy5lYWNoKHRoaXMuZGF0YXNldHMsZnVuY3Rpb24oZGF0YXNldCl7XG4gICAgICAgICAgICAgICAgdmFyIHBvaW50c1dpdGhWYWx1ZXMgPSBDaGFydC5oZWxwZXJzLndoZXJlKGRhdGFzZXQucG9pbnRzLCBoYXNWYWx1ZSk7XG5cbiAgICAgICAgICAgICAgICAvL1RyYW5zaXRpb24gZWFjaCBwb2ludCBmaXJzdCBzbyB0aGF0IHRoZSBsaW5lIGFuZCBwb2ludCBkcmF3aW5nIGlzbid0IG91dCBvZiBzeW5jXG4gICAgICAgICAgICAgICAgLy9XZSBjYW4gdXNlIHRoaXMgZXh0cmEgbG9vcCB0byBjYWxjdWxhdGUgdGhlIGNvbnRyb2wgcG9pbnRzIG9mIHRoaXMgZGF0YXNldCBhbHNvIGluIHRoaXMgbG9vcFxuXG4gICAgICAgICAgICAgICAgQ2hhcnQuaGVscGVycy5lYWNoKGRhdGFzZXQucG9pbnRzLCBmdW5jdGlvbihwb2ludCwgaW5kZXgpe1xuICAgICAgICAgICAgICAgICAgICBpZiAocG9pbnQuaGFzVmFsdWUoKSl7XG4gICAgICAgICAgICAgICAgICAgICAgICBwb2ludC50cmFuc2l0aW9uKHtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICB5IDogdGhpcy5zY2FsZS5jYWxjdWxhdGVZKHBvaW50LnZhbHVlKSxcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICB4IDogdGhpcy5zY2FsZS5jYWxjdWxhdGVYKGluZGV4KVxuICAgICAgICAgICAgICAgICAgICAgICAgfSwgZWFzaW5nRGVjaW1hbCk7XG4gICAgICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgICB9LHRoaXMpO1xuXG5cbiAgICAgICAgICAgICAgICAvLyBDb250cm9sIHBvaW50cyBuZWVkIHRvIGJlIGNhbGN1bGF0ZWQgaW4gYSBzZXBlcmF0ZSBsb29wLCBiZWNhdXNlIHdlIG5lZWQgdG8ga25vdyB0aGUgY3VycmVudCB4L3kgb2YgdGhlIHBvaW50XG4gICAgICAgICAgICAgICAgLy8gVGhpcyB3b3VsZCBjYXVzZSBpc3N1ZXMgd2hlbiB0aGVyZSBpcyBubyBhbmltYXRpb24sIGJlY2F1c2UgdGhlIHkgb2YgdGhlIG5leHQgcG9pbnQgd291bGQgYmUgMCwgc28gYmV6aWVycyB3b3VsZCBiZSBza2V3ZWRcbiAgICAgICAgICAgICAgICBpZiAodGhpcy5vcHRpb25zLmJlemllckN1cnZlKXtcbiAgICAgICAgICAgICAgICAgICAgQ2hhcnQuaGVscGVycy5lYWNoKHBvaW50c1dpdGhWYWx1ZXMsIGZ1bmN0aW9uKHBvaW50LCBpbmRleCl7XG4gICAgICAgICAgICAgICAgICAgICAgICB2YXIgdGVuc2lvbiA9IChpbmRleCA+IDAgJiYgaW5kZXggPCBwb2ludHNXaXRoVmFsdWVzLmxlbmd0aCAtIDEpID8gdGhpcy5vcHRpb25zLmJlemllckN1cnZlVGVuc2lvbiA6IDA7XG4gICAgICAgICAgICAgICAgICAgICAgICBwb2ludC5jb250cm9sUG9pbnRzID0gQ2hhcnQuaGVscGVycy5zcGxpbmVDdXJ2ZShcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICBwcmV2aW91c1BvaW50KHBvaW50LCBwb2ludHNXaXRoVmFsdWVzLCBpbmRleCksXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgcG9pbnQsXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgbmV4dFBvaW50KHBvaW50LCBwb2ludHNXaXRoVmFsdWVzLCBpbmRleCksXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgdGVuc2lvblxuICAgICAgICAgICAgICAgICAgICAgICAgKTtcblxuICAgICAgICAgICAgICAgICAgICAgICAgLy8gUHJldmVudCB0aGUgYmV6aWVyIGdvaW5nIG91dHNpZGUgb2YgdGhlIGJvdW5kcyBvZiB0aGUgZ3JhcGhcblxuICAgICAgICAgICAgICAgICAgICAgICAgLy8gQ2FwIHB1dGVyIGJlemllciBoYW5kbGVzIHRvIHRoZSB1cHBlci9sb3dlciBzY2FsZSBib3VuZHNcbiAgICAgICAgICAgICAgICAgICAgICAgIGlmIChwb2ludC5jb250cm9sUG9pbnRzLm91dGVyLnkgPiB0aGlzLnNjYWxlLmVuZFBvaW50KXtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICBwb2ludC5jb250cm9sUG9pbnRzLm91dGVyLnkgPSB0aGlzLnNjYWxlLmVuZFBvaW50O1xuICAgICAgICAgICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICAgICAgICAgICAgZWxzZSBpZiAocG9pbnQuY29udHJvbFBvaW50cy5vdXRlci55IDwgdGhpcy5zY2FsZS5zdGFydFBvaW50KXtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICBwb2ludC5jb250cm9sUG9pbnRzLm91dGVyLnkgPSB0aGlzLnNjYWxlLnN0YXJ0UG9pbnQ7XG4gICAgICAgICAgICAgICAgICAgICAgICB9XG5cbiAgICAgICAgICAgICAgICAgICAgICAgIC8vIENhcCBpbm5lciBiZXppZXIgaGFuZGxlcyB0byB0aGUgdXBwZXIvbG93ZXIgc2NhbGUgYm91bmRzXG4gICAgICAgICAgICAgICAgICAgICAgICBpZiAocG9pbnQuY29udHJvbFBvaW50cy5pbm5lci55ID4gdGhpcy5zY2FsZS5lbmRQb2ludCl7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgcG9pbnQuY29udHJvbFBvaW50cy5pbm5lci55ID0gdGhpcy5zY2FsZS5lbmRQb2ludDtcbiAgICAgICAgICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgICAgICAgICAgIGVsc2UgaWYgKHBvaW50LmNvbnRyb2xQb2ludHMuaW5uZXIueSA8IHRoaXMuc2NhbGUuc3RhcnRQb2ludCl7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgcG9pbnQuY29udHJvbFBvaW50cy5pbm5lci55ID0gdGhpcy5zY2FsZS5zdGFydFBvaW50O1xuICAgICAgICAgICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICAgICAgICB9LHRoaXMpO1xuICAgICAgICAgICAgICAgIH1cblxuICAgICAgICAgICAgICAgIGlmICh0aGlzLm9wdGlvbnMuZGF0YXNldEZpbGwgJiYgcG9pbnRzV2l0aFZhbHVlcy5sZW5ndGggPiAwKXtcbiAgICAgICAgICAgICAgICAgICAgLy9Sb3VuZCBvZmYgdGhlIGxpbmUgYnkgZ29pbmcgdG8gdGhlIGJhc2Ugb2YgdGhlIGNoYXJ0LCBiYWNrIHRvIHRoZSBzdGFydCwgdGhlbiBmaWxsLlxuICAgICAgICAgICAgICAgICAgICBjdHgubGluZVRvKHBvaW50c1dpdGhWYWx1ZXNbcG9pbnRzV2l0aFZhbHVlcy5sZW5ndGggLSAxXS54LCB0aGlzLnNjYWxlLmVuZFBvaW50KTtcbiAgICAgICAgICAgICAgICAgICAgY3R4LmxpbmVUbyhwb2ludHNXaXRoVmFsdWVzWzBdLngsIHRoaXMuc2NhbGUuZW5kUG9pbnQpO1xuICAgICAgICAgICAgICAgICAgICBjdHguZmlsbFN0eWxlID0gZGF0YXNldC5maWxsQ29sb3I7XG4gICAgICAgICAgICAgICAgICAgIGN0eC5jbG9zZVBhdGgoKTtcbiAgICAgICAgICAgICAgICAgICAgY3R4LmZpbGwoKTtcbiAgICAgICAgICAgICAgICB9XG5cbiAgICAgICAgICAgICAgICAvL05vdyBkcmF3IHRoZSBwb2ludHMgb3ZlciB0aGUgbGluZVxuICAgICAgICAgICAgICAgIC8vQSBsaXR0bGUgaW5lZmZpY2llbnQgZG91YmxlIGxvb3BpbmcsIGJ1dCBiZXR0ZXIgdGhhbiB0aGUgbGluZVxuICAgICAgICAgICAgICAgIC8vbGFnZ2luZyBiZWhpbmQgdGhlIHBvaW50IHBvc2l0aW9uc1xuICAgICAgICAgICAgICAgIENoYXJ0LmhlbHBlcnMuZWFjaChwb2ludHNXaXRoVmFsdWVzLGZ1bmN0aW9uKHBvaW50KXtcbiAgICAgICAgICAgICAgICAgICAgcG9pbnQuZHJhdygpO1xuICAgICAgICAgICAgICAgIH0pO1xuICAgICAgICAgICAgfSx0aGlzKTtcbiAgICAgICAgfVxufSk7IiwiKGZ1bmN0aW9uIChmYWN0b3J5KSB7XG5cdC8vIE1vZHVsZSBzeXN0ZW1zIG1hZ2ljIGRhbmNlLlxuXG5cdGlmICh0eXBlb2YgcmVxdWlyZSA9PT0gXCJmdW5jdGlvblwiICYmIHR5cGVvZiBleHBvcnRzID09PSBcIm9iamVjdFwiICYmIHR5cGVvZiBtb2R1bGUgPT09IFwib2JqZWN0XCIpIHtcblx0XHQvLyBDb21tb25KUyBvciBOb2RlOiBoYXJkLWNvZGVkIGRlcGVuZGVuY3kgb24gXCJrbm9ja291dFwiXG5cdFx0ZmFjdG9yeSgodHlwZW9mIHdpbmRvdyAhPT0gXCJ1bmRlZmluZWRcIiA/IHdpbmRvd1sna28nXSA6IHR5cGVvZiBnbG9iYWwgIT09IFwidW5kZWZpbmVkXCIgPyBnbG9iYWxbJ2tvJ10gOiBudWxsKSwgZXhwb3J0cyk7XG5cdH0gZWxzZSBpZiAodHlwZW9mIGRlZmluZSA9PT0gXCJmdW5jdGlvblwiICYmIGRlZmluZVtcImFtZFwiXSkge1xuXHRcdC8vIEFNRCBhbm9ueW1vdXMgbW9kdWxlIHdpdGggaGFyZC1jb2RlZCBkZXBlbmRlbmN5IG9uIFwia25vY2tvdXRcIlxuXHRcdGRlZmluZShbXCJrbm9ja291dFwiLCBcImV4cG9ydHNcIl0sIGZhY3RvcnkpO1xuXHR9IGVsc2Uge1xuXHRcdC8vIDxzY3JpcHQ+IHRhZzogdXNlIHRoZSBnbG9iYWwgYGtvYCBvYmplY3QsIGF0dGFjaGluZyBhIGBtYXBwaW5nYCBwcm9wZXJ0eVxuXHRcdGZhY3Rvcnkoa28sIGtvLm1hcHBpbmcgPSB7fSk7XG5cdH1cbn0oZnVuY3Rpb24gKGtvLCBleHBvcnRzKSB7XG5cdHZhciBERUJVRz10cnVlO1xuXHR2YXIgbWFwcGluZ1Byb3BlcnR5ID0gXCJfX2tvX21hcHBpbmdfX1wiO1xuXHR2YXIgcmVhbEtvRGVwZW5kZW50T2JzZXJ2YWJsZSA9IGtvLmRlcGVuZGVudE9ic2VydmFibGU7XG5cdHZhciBtYXBwaW5nTmVzdGluZyA9IDA7XG5cdHZhciBkZXBlbmRlbnRPYnNlcnZhYmxlcztcblx0dmFyIHZpc2l0ZWRPYmplY3RzO1xuXHR2YXIgcmVjb2duaXplZFJvb3RQcm9wZXJ0aWVzID0gW1wiY3JlYXRlXCIsIFwidXBkYXRlXCIsIFwia2V5XCIsIFwiYXJyYXlDaGFuZ2VkXCJdO1xuXHR2YXIgZW1wdHlSZXR1cm4gPSB7fTtcblxuXHR2YXIgX2RlZmF1bHRPcHRpb25zID0ge1xuXHRcdGluY2x1ZGU6IFtcIl9kZXN0cm95XCJdLFxuXHRcdGlnbm9yZTogW10sXG5cdFx0Y29weTogW10sXG5cdFx0b2JzZXJ2ZTogW11cblx0fTtcblx0dmFyIGRlZmF1bHRPcHRpb25zID0gX2RlZmF1bHRPcHRpb25zO1xuXG5cdC8vIEF1dGhvcjogS2VubnlUTSBAIFN0YWNrT3ZlcmZsb3dcblx0ZnVuY3Rpb24gdW5pb25BcnJheXMgKHgsIHkpIHtcblx0XHR2YXIgb2JqID0ge307XG5cdFx0Zm9yICh2YXIgaSA9IHgubGVuZ3RoIC0gMTsgaSA+PSAwOyAtLSBpKSBvYmpbeFtpXV0gPSB4W2ldO1xuXHRcdGZvciAodmFyIGkgPSB5Lmxlbmd0aCAtIDE7IGkgPj0gMDsgLS0gaSkgb2JqW3lbaV1dID0geVtpXTtcblx0XHR2YXIgcmVzID0gW107XG5cblx0XHRmb3IgKHZhciBrIGluIG9iaikge1xuXHRcdFx0cmVzLnB1c2gob2JqW2tdKTtcblx0XHR9O1xuXG5cdFx0cmV0dXJuIHJlcztcblx0fVxuXG5cdGZ1bmN0aW9uIGV4dGVuZE9iamVjdChkZXN0aW5hdGlvbiwgc291cmNlKSB7XG5cdFx0dmFyIGRlc3RUeXBlO1xuXG5cdFx0Zm9yICh2YXIga2V5IGluIHNvdXJjZSkge1xuXHRcdFx0aWYgKHNvdXJjZS5oYXNPd25Qcm9wZXJ0eShrZXkpICYmIHNvdXJjZVtrZXldKSB7XG5cdFx0XHRcdGRlc3RUeXBlID0gZXhwb3J0cy5nZXRUeXBlKGRlc3RpbmF0aW9uW2tleV0pO1xuXHRcdFx0XHRpZiAoa2V5ICYmIGRlc3RpbmF0aW9uW2tleV0gJiYgZGVzdFR5cGUgIT09IFwiYXJyYXlcIiAmJiBkZXN0VHlwZSAhPT0gXCJzdHJpbmdcIikge1xuXHRcdFx0XHRcdGV4dGVuZE9iamVjdChkZXN0aW5hdGlvbltrZXldLCBzb3VyY2Vba2V5XSk7XG5cdFx0XHRcdH0gZWxzZSB7XG5cdFx0XHRcdFx0dmFyIGJvdGhBcnJheXMgPSBleHBvcnRzLmdldFR5cGUoZGVzdGluYXRpb25ba2V5XSkgPT09IFwiYXJyYXlcIiAmJiBleHBvcnRzLmdldFR5cGUoc291cmNlW2tleV0pID09PSBcImFycmF5XCI7XG5cdFx0XHRcdFx0aWYgKGJvdGhBcnJheXMpIHtcblx0XHRcdFx0XHRcdGRlc3RpbmF0aW9uW2tleV0gPSB1bmlvbkFycmF5cyhkZXN0aW5hdGlvbltrZXldLCBzb3VyY2Vba2V5XSk7XG5cdFx0XHRcdFx0fSBlbHNlIHtcblx0XHRcdFx0XHRcdGRlc3RpbmF0aW9uW2tleV0gPSBzb3VyY2Vba2V5XTtcblx0XHRcdFx0XHR9XG5cdFx0XHRcdH1cblx0XHRcdH1cblx0XHR9XG5cdH1cblxuXHRmdW5jdGlvbiBtZXJnZShvYmoxLCBvYmoyKSB7XG5cdFx0dmFyIG1lcmdlZCA9IHt9O1xuXHRcdGV4dGVuZE9iamVjdChtZXJnZWQsIG9iajEpO1xuXHRcdGV4dGVuZE9iamVjdChtZXJnZWQsIG9iajIpO1xuXG5cdFx0cmV0dXJuIG1lcmdlZDtcblx0fVxuXG5cdGV4cG9ydHMuaXNNYXBwZWQgPSBmdW5jdGlvbiAodmlld01vZGVsKSB7XG5cdFx0dmFyIHVud3JhcHBlZCA9IGtvLnV0aWxzLnVud3JhcE9ic2VydmFibGUodmlld01vZGVsKTtcblx0XHRyZXR1cm4gdW53cmFwcGVkICYmIHVud3JhcHBlZFttYXBwaW5nUHJvcGVydHldO1xuXHR9XG5cblx0ZXhwb3J0cy5mcm9tSlMgPSBmdW5jdGlvbiAoanNPYmplY3QgLyosIGlucHV0T3B0aW9ucywgdGFyZ2V0Ki8gKSB7XG5cdFx0aWYgKGFyZ3VtZW50cy5sZW5ndGggPT0gMCkgdGhyb3cgbmV3IEVycm9yKFwiV2hlbiBjYWxsaW5nIGtvLmZyb21KUywgcGFzcyB0aGUgb2JqZWN0IHlvdSB3YW50IHRvIGNvbnZlcnQuXCIpO1xuXG5cdFx0dHJ5IHtcblx0XHRcdGlmICghbWFwcGluZ05lc3RpbmcrKykge1xuXHRcdFx0XHRkZXBlbmRlbnRPYnNlcnZhYmxlcyA9IFtdO1xuXHRcdFx0XHR2aXNpdGVkT2JqZWN0cyA9IG5ldyBvYmplY3RMb29rdXAoKTtcblx0XHRcdH1cblxuXHRcdFx0dmFyIG9wdGlvbnM7XG5cdFx0XHR2YXIgdGFyZ2V0O1xuXG5cdFx0XHRpZiAoYXJndW1lbnRzLmxlbmd0aCA9PSAyKSB7XG5cdFx0XHRcdGlmIChhcmd1bWVudHNbMV1bbWFwcGluZ1Byb3BlcnR5XSkge1xuXHRcdFx0XHRcdHRhcmdldCA9IGFyZ3VtZW50c1sxXTtcblx0XHRcdFx0fSBlbHNlIHtcblx0XHRcdFx0XHRvcHRpb25zID0gYXJndW1lbnRzWzFdO1xuXHRcdFx0XHR9XG5cdFx0XHR9XG5cdFx0XHRpZiAoYXJndW1lbnRzLmxlbmd0aCA9PSAzKSB7XG5cdFx0XHRcdG9wdGlvbnMgPSBhcmd1bWVudHNbMV07XG5cdFx0XHRcdHRhcmdldCA9IGFyZ3VtZW50c1syXTtcblx0XHRcdH1cblxuXHRcdFx0aWYgKHRhcmdldCkge1xuXHRcdFx0XHRvcHRpb25zID0gbWVyZ2Uob3B0aW9ucywgdGFyZ2V0W21hcHBpbmdQcm9wZXJ0eV0pO1xuXHRcdFx0fVxuXHRcdFx0b3B0aW9ucyA9IGZpbGxPcHRpb25zKG9wdGlvbnMpO1xuXG5cdFx0XHR2YXIgcmVzdWx0ID0gdXBkYXRlVmlld01vZGVsKHRhcmdldCwganNPYmplY3QsIG9wdGlvbnMpO1xuXHRcdFx0aWYgKHRhcmdldCkge1xuXHRcdFx0XHRyZXN1bHQgPSB0YXJnZXQ7XG5cdFx0XHR9XG5cblx0XHRcdC8vIEV2YWx1YXRlIGFueSBkZXBlbmRlbnQgb2JzZXJ2YWJsZXMgdGhhdCB3ZXJlIHByb3hpZWQuXG5cdFx0XHQvLyBEbyB0aGlzIGFmdGVyIHRoZSBtb2RlbCdzIG9ic2VydmFibGVzIGhhdmUgYmVlbiBjcmVhdGVkXG5cdFx0XHRpZiAoIS0tbWFwcGluZ05lc3RpbmcpIHtcblx0XHRcdFx0d2hpbGUgKGRlcGVuZGVudE9ic2VydmFibGVzLmxlbmd0aCkge1xuXHRcdFx0XHRcdHZhciBETyA9IGRlcGVuZGVudE9ic2VydmFibGVzLnBvcCgpO1xuXHRcdFx0XHRcdGlmIChETykge1xuXHRcdFx0XHRcdFx0RE8oKTtcblx0XHRcdFx0XHRcdFxuXHRcdFx0XHRcdFx0Ly8gTW92ZSB0aGlzIG1hZ2ljIHByb3BlcnR5IHRvIHRoZSB1bmRlcmx5aW5nIGRlcGVuZGVudCBvYnNlcnZhYmxlXG5cdFx0XHRcdFx0XHRETy5fX0RPW1widGhyb3R0bGVFdmFsdWF0aW9uXCJdID0gRE9bXCJ0aHJvdHRsZUV2YWx1YXRpb25cIl07XG5cdFx0XHRcdFx0fVxuXHRcdFx0XHR9XG5cdFx0XHR9XG5cblx0XHRcdC8vIFNhdmUgYW55IG5ldyBtYXBwaW5nIG9wdGlvbnMgaW4gdGhlIHZpZXcgbW9kZWwsIHNvIHRoYXQgdXBkYXRlRnJvbUpTIGNhbiB1c2UgdGhlbSBsYXRlci5cblx0XHRcdHJlc3VsdFttYXBwaW5nUHJvcGVydHldID0gbWVyZ2UocmVzdWx0W21hcHBpbmdQcm9wZXJ0eV0sIG9wdGlvbnMpO1xuXG5cdFx0XHRyZXR1cm4gcmVzdWx0O1xuXHRcdH0gY2F0Y2goZSkge1xuXHRcdFx0bWFwcGluZ05lc3RpbmcgPSAwO1xuXHRcdFx0dGhyb3cgZTtcblx0XHR9XG5cdH07XG5cblx0ZXhwb3J0cy5mcm9tSlNPTiA9IGZ1bmN0aW9uIChqc29uU3RyaW5nIC8qLCBvcHRpb25zLCB0YXJnZXQqLyApIHtcblx0XHR2YXIgcGFyc2VkID0ga28udXRpbHMucGFyc2VKc29uKGpzb25TdHJpbmcpO1xuXHRcdGFyZ3VtZW50c1swXSA9IHBhcnNlZDtcblx0XHRyZXR1cm4gZXhwb3J0cy5mcm9tSlMuYXBwbHkodGhpcywgYXJndW1lbnRzKTtcblx0fTtcblxuXHRleHBvcnRzLnVwZGF0ZUZyb21KUyA9IGZ1bmN0aW9uICh2aWV3TW9kZWwpIHtcblx0XHR0aHJvdyBuZXcgRXJyb3IoXCJrby5tYXBwaW5nLnVwZGF0ZUZyb21KUywgdXNlIGtvLm1hcHBpbmcuZnJvbUpTIGluc3RlYWQuIFBsZWFzZSBub3RlIHRoYXQgdGhlIG9yZGVyIG9mIHBhcmFtZXRlcnMgaXMgZGlmZmVyZW50IVwiKTtcblx0fTtcblxuXHRleHBvcnRzLnVwZGF0ZUZyb21KU09OID0gZnVuY3Rpb24gKHZpZXdNb2RlbCkge1xuXHRcdHRocm93IG5ldyBFcnJvcihcImtvLm1hcHBpbmcudXBkYXRlRnJvbUpTT04sIHVzZSBrby5tYXBwaW5nLmZyb21KU09OIGluc3RlYWQuIFBsZWFzZSBub3RlIHRoYXQgdGhlIG9yZGVyIG9mIHBhcmFtZXRlcnMgaXMgZGlmZmVyZW50IVwiKTtcblx0fTtcblxuXHRleHBvcnRzLnRvSlMgPSBmdW5jdGlvbiAocm9vdE9iamVjdCwgb3B0aW9ucykge1xuXHRcdGlmICghZGVmYXVsdE9wdGlvbnMpIGV4cG9ydHMucmVzZXREZWZhdWx0T3B0aW9ucygpO1xuXG5cdFx0aWYgKGFyZ3VtZW50cy5sZW5ndGggPT0gMCkgdGhyb3cgbmV3IEVycm9yKFwiV2hlbiBjYWxsaW5nIGtvLm1hcHBpbmcudG9KUywgcGFzcyB0aGUgb2JqZWN0IHlvdSB3YW50IHRvIGNvbnZlcnQuXCIpO1xuXHRcdGlmIChleHBvcnRzLmdldFR5cGUoZGVmYXVsdE9wdGlvbnMuaWdub3JlKSAhPT0gXCJhcnJheVwiKSB0aHJvdyBuZXcgRXJyb3IoXCJrby5tYXBwaW5nLmRlZmF1bHRPcHRpb25zKCkuaWdub3JlIHNob3VsZCBiZSBhbiBhcnJheS5cIik7XG5cdFx0aWYgKGV4cG9ydHMuZ2V0VHlwZShkZWZhdWx0T3B0aW9ucy5pbmNsdWRlKSAhPT0gXCJhcnJheVwiKSB0aHJvdyBuZXcgRXJyb3IoXCJrby5tYXBwaW5nLmRlZmF1bHRPcHRpb25zKCkuaW5jbHVkZSBzaG91bGQgYmUgYW4gYXJyYXkuXCIpO1xuXHRcdGlmIChleHBvcnRzLmdldFR5cGUoZGVmYXVsdE9wdGlvbnMuY29weSkgIT09IFwiYXJyYXlcIikgdGhyb3cgbmV3IEVycm9yKFwia28ubWFwcGluZy5kZWZhdWx0T3B0aW9ucygpLmNvcHkgc2hvdWxkIGJlIGFuIGFycmF5LlwiKTtcblxuXHRcdC8vIE1lcmdlIGluIHRoZSBvcHRpb25zIHVzZWQgaW4gZnJvbUpTXG5cdFx0b3B0aW9ucyA9IGZpbGxPcHRpb25zKG9wdGlvbnMsIHJvb3RPYmplY3RbbWFwcGluZ1Byb3BlcnR5XSk7XG5cblx0XHQvLyBXZSBqdXN0IHVud3JhcCBldmVyeXRoaW5nIGF0IGV2ZXJ5IGxldmVsIGluIHRoZSBvYmplY3QgZ3JhcGhcblx0XHRyZXR1cm4gZXhwb3J0cy52aXNpdE1vZGVsKHJvb3RPYmplY3QsIGZ1bmN0aW9uICh4KSB7XG5cdFx0XHRyZXR1cm4ga28udXRpbHMudW53cmFwT2JzZXJ2YWJsZSh4KVxuXHRcdH0sIG9wdGlvbnMpO1xuXHR9O1xuXG5cdGV4cG9ydHMudG9KU09OID0gZnVuY3Rpb24gKHJvb3RPYmplY3QsIG9wdGlvbnMpIHtcblx0XHR2YXIgcGxhaW5KYXZhU2NyaXB0T2JqZWN0ID0gZXhwb3J0cy50b0pTKHJvb3RPYmplY3QsIG9wdGlvbnMpO1xuXHRcdHJldHVybiBrby51dGlscy5zdHJpbmdpZnlKc29uKHBsYWluSmF2YVNjcmlwdE9iamVjdCk7XG5cdH07XG5cblx0ZXhwb3J0cy5kZWZhdWx0T3B0aW9ucyA9IGZ1bmN0aW9uICgpIHtcblx0XHRpZiAoYXJndW1lbnRzLmxlbmd0aCA+IDApIHtcblx0XHRcdGRlZmF1bHRPcHRpb25zID0gYXJndW1lbnRzWzBdO1xuXHRcdH0gZWxzZSB7XG5cdFx0XHRyZXR1cm4gZGVmYXVsdE9wdGlvbnM7XG5cdFx0fVxuXHR9O1xuXG5cdGV4cG9ydHMucmVzZXREZWZhdWx0T3B0aW9ucyA9IGZ1bmN0aW9uICgpIHtcblx0XHRkZWZhdWx0T3B0aW9ucyA9IHtcblx0XHRcdGluY2x1ZGU6IF9kZWZhdWx0T3B0aW9ucy5pbmNsdWRlLnNsaWNlKDApLFxuXHRcdFx0aWdub3JlOiBfZGVmYXVsdE9wdGlvbnMuaWdub3JlLnNsaWNlKDApLFxuXHRcdFx0Y29weTogX2RlZmF1bHRPcHRpb25zLmNvcHkuc2xpY2UoMClcblx0XHR9O1xuXHR9O1xuXG5cdGV4cG9ydHMuZ2V0VHlwZSA9IGZ1bmN0aW9uKHgpIHtcblx0XHRpZiAoKHgpICYmICh0eXBlb2YgKHgpID09PSBcIm9iamVjdFwiKSkge1xuXHRcdFx0aWYgKHguY29uc3RydWN0b3IgPT09IERhdGUpIHJldHVybiBcImRhdGVcIjtcblx0XHRcdGlmICh4LmNvbnN0cnVjdG9yID09PSBBcnJheSkgcmV0dXJuIFwiYXJyYXlcIjtcblx0XHR9XG5cdFx0cmV0dXJuIHR5cGVvZiB4O1xuXHR9XG5cblx0ZnVuY3Rpb24gZmlsbE9wdGlvbnMocmF3T3B0aW9ucywgb3RoZXJPcHRpb25zKSB7XG5cdFx0dmFyIG9wdGlvbnMgPSBtZXJnZSh7fSwgcmF3T3B0aW9ucyk7XG5cblx0XHQvLyBNb3ZlIHJlY29nbml6ZWQgcm9vdC1sZXZlbCBwcm9wZXJ0aWVzIGludG8gYSByb290IG5hbWVzcGFjZVxuXHRcdGZvciAodmFyIGkgPSByZWNvZ25pemVkUm9vdFByb3BlcnRpZXMubGVuZ3RoIC0gMTsgaSA+PSAwOyBpLS0pIHtcblx0XHRcdHZhciBwcm9wZXJ0eSA9IHJlY29nbml6ZWRSb290UHJvcGVydGllc1tpXTtcblx0XHRcdFxuXHRcdFx0Ly8gQ2Fycnkgb24sIHVubGVzcyB0aGlzIHByb3BlcnR5IGlzIHByZXNlbnRcblx0XHRcdGlmICghb3B0aW9uc1twcm9wZXJ0eV0pIGNvbnRpbnVlO1xuXHRcdFx0XG5cdFx0XHQvLyBNb3ZlIHRoZSBwcm9wZXJ0eSBpbnRvIHRoZSByb290IG5hbWVzcGFjZVxuXHRcdFx0aWYgKCEob3B0aW9uc1tcIlwiXSBpbnN0YW5jZW9mIE9iamVjdCkpIG9wdGlvbnNbXCJcIl0gPSB7fTtcblx0XHRcdG9wdGlvbnNbXCJcIl1bcHJvcGVydHldID0gb3B0aW9uc1twcm9wZXJ0eV07XG5cdFx0XHRkZWxldGUgb3B0aW9uc1twcm9wZXJ0eV07XG5cdFx0fVxuXG5cdFx0aWYgKG90aGVyT3B0aW9ucykge1xuXHRcdFx0b3B0aW9ucy5pZ25vcmUgPSBtZXJnZUFycmF5cyhvdGhlck9wdGlvbnMuaWdub3JlLCBvcHRpb25zLmlnbm9yZSk7XG5cdFx0XHRvcHRpb25zLmluY2x1ZGUgPSBtZXJnZUFycmF5cyhvdGhlck9wdGlvbnMuaW5jbHVkZSwgb3B0aW9ucy5pbmNsdWRlKTtcblx0XHRcdG9wdGlvbnMuY29weSA9IG1lcmdlQXJyYXlzKG90aGVyT3B0aW9ucy5jb3B5LCBvcHRpb25zLmNvcHkpO1xuXHRcdFx0b3B0aW9ucy5vYnNlcnZlID0gbWVyZ2VBcnJheXMob3RoZXJPcHRpb25zLm9ic2VydmUsIG9wdGlvbnMub2JzZXJ2ZSk7XG5cdFx0fVxuXHRcdG9wdGlvbnMuaWdub3JlID0gbWVyZ2VBcnJheXMob3B0aW9ucy5pZ25vcmUsIGRlZmF1bHRPcHRpb25zLmlnbm9yZSk7XG5cdFx0b3B0aW9ucy5pbmNsdWRlID0gbWVyZ2VBcnJheXMob3B0aW9ucy5pbmNsdWRlLCBkZWZhdWx0T3B0aW9ucy5pbmNsdWRlKTtcblx0XHRvcHRpb25zLmNvcHkgPSBtZXJnZUFycmF5cyhvcHRpb25zLmNvcHksIGRlZmF1bHRPcHRpb25zLmNvcHkpO1xuXHRcdG9wdGlvbnMub2JzZXJ2ZSA9IG1lcmdlQXJyYXlzKG9wdGlvbnMub2JzZXJ2ZSwgZGVmYXVsdE9wdGlvbnMub2JzZXJ2ZSk7XG5cblx0XHRvcHRpb25zLm1hcHBlZFByb3BlcnRpZXMgPSBvcHRpb25zLm1hcHBlZFByb3BlcnRpZXMgfHwge307XG5cdFx0b3B0aW9ucy5jb3BpZWRQcm9wZXJ0aWVzID0gb3B0aW9ucy5jb3BpZWRQcm9wZXJ0aWVzIHx8IHt9O1xuXHRcdHJldHVybiBvcHRpb25zO1xuXHR9XG5cblx0ZnVuY3Rpb24gbWVyZ2VBcnJheXMoYSwgYikge1xuXHRcdGlmIChleHBvcnRzLmdldFR5cGUoYSkgIT09IFwiYXJyYXlcIikge1xuXHRcdFx0aWYgKGV4cG9ydHMuZ2V0VHlwZShhKSA9PT0gXCJ1bmRlZmluZWRcIikgYSA9IFtdO1xuXHRcdFx0ZWxzZSBhID0gW2FdO1xuXHRcdH1cblx0XHRpZiAoZXhwb3J0cy5nZXRUeXBlKGIpICE9PSBcImFycmF5XCIpIHtcblx0XHRcdGlmIChleHBvcnRzLmdldFR5cGUoYikgPT09IFwidW5kZWZpbmVkXCIpIGIgPSBbXTtcblx0XHRcdGVsc2UgYiA9IFtiXTtcblx0XHR9XG5cblx0XHRyZXR1cm4ga28udXRpbHMuYXJyYXlHZXREaXN0aW5jdFZhbHVlcyhhLmNvbmNhdChiKSk7XG5cdH1cblxuXHQvLyBXaGVuIHVzaW5nIGEgJ2NyZWF0ZScgY2FsbGJhY2ssIHdlIHByb3h5IHRoZSBkZXBlbmRlbnQgb2JzZXJ2YWJsZSBzbyB0aGF0IGl0IGRvZXNuJ3QgaW1tZWRpYXRlbHkgZXZhbHVhdGUgb24gY3JlYXRpb24uXG5cdC8vIFRoZSByZWFzb24gaXMgdGhhdCB0aGUgZGVwZW5kZW50IG9ic2VydmFibGVzIGluIHRoZSB1c2VyLXNwZWNpZmllZCBjYWxsYmFjayBtYXkgY29udGFpbiByZWZlcmVuY2VzIHRvIHByb3BlcnRpZXMgdGhhdCBoYXZlIG5vdCBiZWVuIG1hcHBlZCB5ZXQuXG5cdGZ1bmN0aW9uIHdpdGhQcm94eURlcGVuZGVudE9ic2VydmFibGUoZGVwZW5kZW50T2JzZXJ2YWJsZXMsIGNhbGxiYWNrKSB7XG5cdFx0dmFyIGxvY2FsRE8gPSBrby5kZXBlbmRlbnRPYnNlcnZhYmxlO1xuXHRcdGtvLmRlcGVuZGVudE9ic2VydmFibGUgPSBmdW5jdGlvbiAocmVhZCwgb3duZXIsIG9wdGlvbnMpIHtcblx0XHRcdG9wdGlvbnMgPSBvcHRpb25zIHx8IHt9O1xuXG5cdFx0XHRpZiAocmVhZCAmJiB0eXBlb2YgcmVhZCA9PSBcIm9iamVjdFwiKSB7IC8vIG1pcnJvcnMgY29uZGl0aW9uIGluIGtub2Nrb3V0IGltcGxlbWVudGF0aW9uIG9mIERPJ3Ncblx0XHRcdFx0b3B0aW9ucyA9IHJlYWQ7XG5cdFx0XHR9XG5cblx0XHRcdHZhciByZWFsRGVmZXJFdmFsdWF0aW9uID0gb3B0aW9ucy5kZWZlckV2YWx1YXRpb247XG5cblx0XHRcdHZhciBpc1JlbW92ZWQgPSBmYWxzZTtcblxuXHRcdFx0Ly8gV2Ugd3JhcCB0aGUgb3JpZ2luYWwgZGVwZW5kZW50IG9ic2VydmFibGUgc28gdGhhdCB3ZSBjYW4gcmVtb3ZlIGl0IGZyb20gdGhlICdkZXBlbmRlbnRPYnNlcnZhYmxlcycgbGlzdCB3ZSBuZWVkIHRvIGV2YWx1YXRlIGFmdGVyIG1hcHBpbmcgaGFzXG5cdFx0XHQvLyBjb21wbGV0ZWQgaWYgdGhlIHVzZXIgYWxyZWFkeSBldmFsdWF0ZWQgdGhlIERPIHRoZW1zZWx2ZXMgaW4gdGhlIG1lYW50aW1lLlxuXHRcdFx0dmFyIHdyYXAgPSBmdW5jdGlvbiAoRE8pIHtcblx0XHRcdFx0Ly8gVGVtcG9yYXJpbHkgcmV2ZXJ0IGtvLmRlcGVuZGVudE9ic2VydmFibGUsIHNpbmNlIGl0IGlzIHVzZWQgaW4ga28uaXNXcml0ZWFibGVPYnNlcnZhYmxlXG5cdFx0XHRcdHZhciB0bXAgPSBrby5kZXBlbmRlbnRPYnNlcnZhYmxlO1xuXHRcdFx0XHRrby5kZXBlbmRlbnRPYnNlcnZhYmxlID0gcmVhbEtvRGVwZW5kZW50T2JzZXJ2YWJsZTtcblx0XHRcdFx0dmFyIGlzV3JpdGVhYmxlID0ga28uaXNXcml0ZWFibGVPYnNlcnZhYmxlKERPKTtcblx0XHRcdFx0a28uZGVwZW5kZW50T2JzZXJ2YWJsZSA9IHRtcDtcblxuXHRcdFx0XHR2YXIgd3JhcHBlZCA9IHJlYWxLb0RlcGVuZGVudE9ic2VydmFibGUoe1xuXHRcdFx0XHRcdHJlYWQ6IGZ1bmN0aW9uICgpIHtcblx0XHRcdFx0XHRcdGlmICghaXNSZW1vdmVkKSB7XG5cdFx0XHRcdFx0XHRcdGtvLnV0aWxzLmFycmF5UmVtb3ZlSXRlbShkZXBlbmRlbnRPYnNlcnZhYmxlcywgRE8pO1xuXHRcdFx0XHRcdFx0XHRpc1JlbW92ZWQgPSB0cnVlO1xuXHRcdFx0XHRcdFx0fVxuXHRcdFx0XHRcdFx0cmV0dXJuIERPLmFwcGx5KERPLCBhcmd1bWVudHMpO1xuXHRcdFx0XHRcdH0sXG5cdFx0XHRcdFx0d3JpdGU6IGlzV3JpdGVhYmxlICYmIGZ1bmN0aW9uICh2YWwpIHtcblx0XHRcdFx0XHRcdHJldHVybiBETyh2YWwpO1xuXHRcdFx0XHRcdH0sXG5cdFx0XHRcdFx0ZGVmZXJFdmFsdWF0aW9uOiB0cnVlXG5cdFx0XHRcdH0pO1xuXHRcdFx0XHRpZiAoREVCVUcpIHdyYXBwZWQuX3dyYXBwZXIgPSB0cnVlO1xuXHRcdFx0XHR3cmFwcGVkLl9fRE8gPSBETztcblx0XHRcdFx0cmV0dXJuIHdyYXBwZWQ7XG5cdFx0XHR9O1xuXHRcdFx0XG5cdFx0XHRvcHRpb25zLmRlZmVyRXZhbHVhdGlvbiA9IHRydWU7IC8vIHdpbGwgZWl0aGVyIHNldCBmb3IganVzdCBvcHRpb25zLCBvciBib3RoIHJlYWQvb3B0aW9ucy5cblx0XHRcdHZhciByZWFsRGVwZW5kZW50T2JzZXJ2YWJsZSA9IG5ldyByZWFsS29EZXBlbmRlbnRPYnNlcnZhYmxlKHJlYWQsIG93bmVyLCBvcHRpb25zKTtcblxuXHRcdFx0aWYgKCFyZWFsRGVmZXJFdmFsdWF0aW9uKSB7XG5cdFx0XHRcdHJlYWxEZXBlbmRlbnRPYnNlcnZhYmxlID0gd3JhcChyZWFsRGVwZW5kZW50T2JzZXJ2YWJsZSk7XG5cdFx0XHRcdGRlcGVuZGVudE9ic2VydmFibGVzLnB1c2gocmVhbERlcGVuZGVudE9ic2VydmFibGUpO1xuXHRcdFx0fVxuXG5cdFx0XHRyZXR1cm4gcmVhbERlcGVuZGVudE9ic2VydmFibGU7XG5cdFx0fVxuXHRcdGtvLmRlcGVuZGVudE9ic2VydmFibGUuZm4gPSByZWFsS29EZXBlbmRlbnRPYnNlcnZhYmxlLmZuO1xuXHRcdGtvLmNvbXB1dGVkID0ga28uZGVwZW5kZW50T2JzZXJ2YWJsZTtcblx0XHR2YXIgcmVzdWx0ID0gY2FsbGJhY2soKTtcblx0XHRrby5kZXBlbmRlbnRPYnNlcnZhYmxlID0gbG9jYWxETztcblx0XHRrby5jb21wdXRlZCA9IGtvLmRlcGVuZGVudE9ic2VydmFibGU7XG5cdFx0cmV0dXJuIHJlc3VsdDtcblx0fVxuXG5cdGZ1bmN0aW9uIHVwZGF0ZVZpZXdNb2RlbChtYXBwZWRSb290T2JqZWN0LCByb290T2JqZWN0LCBvcHRpb25zLCBwYXJlbnROYW1lLCBwYXJlbnQsIHBhcmVudFByb3BlcnR5TmFtZSwgbWFwcGVkUGFyZW50KSB7XG5cdFx0dmFyIGlzQXJyYXkgPSBleHBvcnRzLmdldFR5cGUoa28udXRpbHMudW53cmFwT2JzZXJ2YWJsZShyb290T2JqZWN0KSkgPT09IFwiYXJyYXlcIjtcblxuXHRcdHBhcmVudFByb3BlcnR5TmFtZSA9IHBhcmVudFByb3BlcnR5TmFtZSB8fCBcIlwiO1xuXG5cdFx0Ly8gSWYgdGhpcyBvYmplY3Qgd2FzIGFscmVhZHkgbWFwcGVkIHByZXZpb3VzbHksIHRha2UgdGhlIG9wdGlvbnMgZnJvbSB0aGVyZSBhbmQgbWVyZ2UgdGhlbSB3aXRoIG91ciBleGlzdGluZyBvbmVzLlxuXHRcdGlmIChleHBvcnRzLmlzTWFwcGVkKG1hcHBlZFJvb3RPYmplY3QpKSB7XG5cdFx0XHR2YXIgcHJldmlvdXNNYXBwaW5nID0ga28udXRpbHMudW53cmFwT2JzZXJ2YWJsZShtYXBwZWRSb290T2JqZWN0KVttYXBwaW5nUHJvcGVydHldO1xuXHRcdFx0b3B0aW9ucyA9IG1lcmdlKHByZXZpb3VzTWFwcGluZywgb3B0aW9ucyk7XG5cdFx0fVxuXG5cdFx0dmFyIGNhbGxiYWNrUGFyYW1zID0ge1xuXHRcdFx0ZGF0YTogcm9vdE9iamVjdCxcblx0XHRcdHBhcmVudDogbWFwcGVkUGFyZW50IHx8IHBhcmVudFxuXHRcdH07XG5cblx0XHR2YXIgaGFzQ3JlYXRlQ2FsbGJhY2sgPSBmdW5jdGlvbiAoKSB7XG5cdFx0XHRyZXR1cm4gb3B0aW9uc1twYXJlbnROYW1lXSAmJiBvcHRpb25zW3BhcmVudE5hbWVdLmNyZWF0ZSBpbnN0YW5jZW9mIEZ1bmN0aW9uO1xuXHRcdH07XG5cblx0XHR2YXIgY3JlYXRlQ2FsbGJhY2sgPSBmdW5jdGlvbiAoZGF0YSkge1xuXHRcdFx0cmV0dXJuIHdpdGhQcm94eURlcGVuZGVudE9ic2VydmFibGUoZGVwZW5kZW50T2JzZXJ2YWJsZXMsIGZ1bmN0aW9uICgpIHtcblx0XHRcdFx0XG5cdFx0XHRcdGlmIChrby51dGlscy51bndyYXBPYnNlcnZhYmxlKHBhcmVudCkgaW5zdGFuY2VvZiBBcnJheSkge1xuXHRcdFx0XHRcdHJldHVybiBvcHRpb25zW3BhcmVudE5hbWVdLmNyZWF0ZSh7XG5cdFx0XHRcdFx0XHRkYXRhOiBkYXRhIHx8IGNhbGxiYWNrUGFyYW1zLmRhdGEsXG5cdFx0XHRcdFx0XHRwYXJlbnQ6IGNhbGxiYWNrUGFyYW1zLnBhcmVudCxcblx0XHRcdFx0XHRcdHNraXA6IGVtcHR5UmV0dXJuXG5cdFx0XHRcdFx0fSk7XG5cdFx0XHRcdH0gZWxzZSB7XG5cdFx0XHRcdFx0cmV0dXJuIG9wdGlvbnNbcGFyZW50TmFtZV0uY3JlYXRlKHtcblx0XHRcdFx0XHRcdGRhdGE6IGRhdGEgfHwgY2FsbGJhY2tQYXJhbXMuZGF0YSxcblx0XHRcdFx0XHRcdHBhcmVudDogY2FsbGJhY2tQYXJhbXMucGFyZW50XG5cdFx0XHRcdFx0fSk7XG5cdFx0XHRcdH1cdFx0XHRcdFxuXHRcdFx0fSk7XG5cdFx0fTtcblxuXHRcdHZhciBoYXNVcGRhdGVDYWxsYmFjayA9IGZ1bmN0aW9uICgpIHtcblx0XHRcdHJldHVybiBvcHRpb25zW3BhcmVudE5hbWVdICYmIG9wdGlvbnNbcGFyZW50TmFtZV0udXBkYXRlIGluc3RhbmNlb2YgRnVuY3Rpb247XG5cdFx0fTtcblxuXHRcdHZhciB1cGRhdGVDYWxsYmFjayA9IGZ1bmN0aW9uIChvYmosIGRhdGEpIHtcblx0XHRcdHZhciBwYXJhbXMgPSB7XG5cdFx0XHRcdGRhdGE6IGRhdGEgfHwgY2FsbGJhY2tQYXJhbXMuZGF0YSxcblx0XHRcdFx0cGFyZW50OiBjYWxsYmFja1BhcmFtcy5wYXJlbnQsXG5cdFx0XHRcdHRhcmdldDoga28udXRpbHMudW53cmFwT2JzZXJ2YWJsZShvYmopXG5cdFx0XHR9O1xuXG5cdFx0XHRpZiAoa28uaXNXcml0ZWFibGVPYnNlcnZhYmxlKG9iaikpIHtcblx0XHRcdFx0cGFyYW1zLm9ic2VydmFibGUgPSBvYmo7XG5cdFx0XHR9XG5cblx0XHRcdHJldHVybiBvcHRpb25zW3BhcmVudE5hbWVdLnVwZGF0ZShwYXJhbXMpO1xuXHRcdH1cblxuXHRcdHZhciBhbHJlYWR5TWFwcGVkID0gdmlzaXRlZE9iamVjdHMuZ2V0KHJvb3RPYmplY3QpO1xuXHRcdGlmIChhbHJlYWR5TWFwcGVkKSB7XG5cdFx0XHRyZXR1cm4gYWxyZWFkeU1hcHBlZDtcblx0XHR9XG5cblx0XHRwYXJlbnROYW1lID0gcGFyZW50TmFtZSB8fCBcIlwiO1xuXG5cdFx0aWYgKCFpc0FycmF5KSB7XG5cdFx0XHQvLyBGb3IgYXRvbWljIHR5cGVzLCBkbyBhIGRpcmVjdCB1cGRhdGUgb24gdGhlIG9ic2VydmFibGVcblx0XHRcdGlmICghY2FuSGF2ZVByb3BlcnRpZXMocm9vdE9iamVjdCkpIHtcblx0XHRcdFx0c3dpdGNoIChleHBvcnRzLmdldFR5cGUocm9vdE9iamVjdCkpIHtcblx0XHRcdFx0Y2FzZSBcImZ1bmN0aW9uXCI6XG5cdFx0XHRcdFx0aWYgKGhhc1VwZGF0ZUNhbGxiYWNrKCkpIHtcblx0XHRcdFx0XHRcdGlmIChrby5pc1dyaXRlYWJsZU9ic2VydmFibGUocm9vdE9iamVjdCkpIHtcblx0XHRcdFx0XHRcdFx0cm9vdE9iamVjdCh1cGRhdGVDYWxsYmFjayhyb290T2JqZWN0KSk7XG5cdFx0XHRcdFx0XHRcdG1hcHBlZFJvb3RPYmplY3QgPSByb290T2JqZWN0O1xuXHRcdFx0XHRcdFx0fSBlbHNlIHtcblx0XHRcdFx0XHRcdFx0bWFwcGVkUm9vdE9iamVjdCA9IHVwZGF0ZUNhbGxiYWNrKHJvb3RPYmplY3QpO1xuXHRcdFx0XHRcdFx0fVxuXHRcdFx0XHRcdH0gZWxzZSB7XG5cdFx0XHRcdFx0XHRtYXBwZWRSb290T2JqZWN0ID0gcm9vdE9iamVjdDtcblx0XHRcdFx0XHR9XG5cdFx0XHRcdFx0YnJlYWs7XG5cdFx0XHRcdGRlZmF1bHQ6XG5cdFx0XHRcdFx0aWYgKGtvLmlzV3JpdGVhYmxlT2JzZXJ2YWJsZShtYXBwZWRSb290T2JqZWN0KSkge1xuXHRcdFx0XHRcdFx0aWYgKGhhc1VwZGF0ZUNhbGxiYWNrKCkpIHtcblx0XHRcdFx0XHRcdFx0dmFyIHZhbHVlVG9Xcml0ZSA9IHVwZGF0ZUNhbGxiYWNrKG1hcHBlZFJvb3RPYmplY3QpO1xuXHRcdFx0XHRcdFx0XHRtYXBwZWRSb290T2JqZWN0KHZhbHVlVG9Xcml0ZSk7XG5cdFx0XHRcdFx0XHRcdHJldHVybiB2YWx1ZVRvV3JpdGU7XG5cdFx0XHRcdFx0XHR9IGVsc2Uge1xuXHRcdFx0XHRcdFx0XHR2YXIgdmFsdWVUb1dyaXRlID0ga28udXRpbHMudW53cmFwT2JzZXJ2YWJsZShyb290T2JqZWN0KTtcblx0XHRcdFx0XHRcdFx0bWFwcGVkUm9vdE9iamVjdCh2YWx1ZVRvV3JpdGUpO1xuXHRcdFx0XHRcdFx0XHRyZXR1cm4gdmFsdWVUb1dyaXRlO1xuXHRcdFx0XHRcdFx0fVxuXHRcdFx0XHRcdH0gZWxzZSB7XG5cdFx0XHRcdFx0XHR2YXIgaGFzQ3JlYXRlT3JVcGRhdGVDYWxsYmFjayA9IGhhc0NyZWF0ZUNhbGxiYWNrKCkgfHwgaGFzVXBkYXRlQ2FsbGJhY2soKTtcblx0XHRcdFx0XHRcdFxuXHRcdFx0XHRcdFx0aWYgKGhhc0NyZWF0ZUNhbGxiYWNrKCkpIHtcblx0XHRcdFx0XHRcdFx0bWFwcGVkUm9vdE9iamVjdCA9IGNyZWF0ZUNhbGxiYWNrKCk7XG5cdFx0XHRcdFx0XHR9IGVsc2Uge1xuXHRcdFx0XHRcdFx0XHRtYXBwZWRSb290T2JqZWN0ID0ga28ub2JzZXJ2YWJsZShrby51dGlscy51bndyYXBPYnNlcnZhYmxlKHJvb3RPYmplY3QpKTtcblx0XHRcdFx0XHRcdH1cblxuXHRcdFx0XHRcdFx0aWYgKGhhc1VwZGF0ZUNhbGxiYWNrKCkpIHtcblx0XHRcdFx0XHRcdFx0bWFwcGVkUm9vdE9iamVjdCh1cGRhdGVDYWxsYmFjayhtYXBwZWRSb290T2JqZWN0KSk7XG5cdFx0XHRcdFx0XHR9XG5cdFx0XHRcdFx0XHRcblx0XHRcdFx0XHRcdGlmIChoYXNDcmVhdGVPclVwZGF0ZUNhbGxiYWNrKSByZXR1cm4gbWFwcGVkUm9vdE9iamVjdDtcblx0XHRcdFx0XHR9XG5cdFx0XHRcdH1cblxuXHRcdFx0fSBlbHNlIHtcblx0XHRcdFx0bWFwcGVkUm9vdE9iamVjdCA9IGtvLnV0aWxzLnVud3JhcE9ic2VydmFibGUobWFwcGVkUm9vdE9iamVjdCk7XG5cdFx0XHRcdGlmICghbWFwcGVkUm9vdE9iamVjdCkge1xuXHRcdFx0XHRcdGlmIChoYXNDcmVhdGVDYWxsYmFjaygpKSB7XG5cdFx0XHRcdFx0XHR2YXIgcmVzdWx0ID0gY3JlYXRlQ2FsbGJhY2soKTtcblxuXHRcdFx0XHRcdFx0aWYgKGhhc1VwZGF0ZUNhbGxiYWNrKCkpIHtcblx0XHRcdFx0XHRcdFx0cmVzdWx0ID0gdXBkYXRlQ2FsbGJhY2socmVzdWx0KTtcblx0XHRcdFx0XHRcdH1cblxuXHRcdFx0XHRcdFx0cmV0dXJuIHJlc3VsdDtcblx0XHRcdFx0XHR9IGVsc2Uge1xuXHRcdFx0XHRcdFx0aWYgKGhhc1VwZGF0ZUNhbGxiYWNrKCkpIHtcblx0XHRcdFx0XHRcdFx0cmV0dXJuIHVwZGF0ZUNhbGxiYWNrKHJlc3VsdCk7XG5cdFx0XHRcdFx0XHR9XG5cblx0XHRcdFx0XHRcdG1hcHBlZFJvb3RPYmplY3QgPSB7fTtcblx0XHRcdFx0XHR9XG5cdFx0XHRcdH1cblxuXHRcdFx0XHRpZiAoaGFzVXBkYXRlQ2FsbGJhY2soKSkge1xuXHRcdFx0XHRcdG1hcHBlZFJvb3RPYmplY3QgPSB1cGRhdGVDYWxsYmFjayhtYXBwZWRSb290T2JqZWN0KTtcblx0XHRcdFx0fVxuXG5cdFx0XHRcdHZpc2l0ZWRPYmplY3RzLnNhdmUocm9vdE9iamVjdCwgbWFwcGVkUm9vdE9iamVjdCk7XG5cdFx0XHRcdGlmIChoYXNVcGRhdGVDYWxsYmFjaygpKSByZXR1cm4gbWFwcGVkUm9vdE9iamVjdDtcblxuXHRcdFx0XHQvLyBGb3Igbm9uLWF0b21pYyB0eXBlcywgdmlzaXQgYWxsIHByb3BlcnRpZXMgYW5kIHVwZGF0ZSByZWN1cnNpdmVseVxuXHRcdFx0XHR2aXNpdFByb3BlcnRpZXNPckFycmF5RW50cmllcyhyb290T2JqZWN0LCBmdW5jdGlvbiAoaW5kZXhlcikge1xuXHRcdFx0XHRcdHZhciBmdWxsUHJvcGVydHlOYW1lID0gcGFyZW50UHJvcGVydHlOYW1lLmxlbmd0aCA/IHBhcmVudFByb3BlcnR5TmFtZSArIFwiLlwiICsgaW5kZXhlciA6IGluZGV4ZXI7XG5cblx0XHRcdFx0XHRpZiAoa28udXRpbHMuYXJyYXlJbmRleE9mKG9wdGlvbnMuaWdub3JlLCBmdWxsUHJvcGVydHlOYW1lKSAhPSAtMSkge1xuXHRcdFx0XHRcdFx0cmV0dXJuO1xuXHRcdFx0XHRcdH1cblxuXHRcdFx0XHRcdGlmIChrby51dGlscy5hcnJheUluZGV4T2Yob3B0aW9ucy5jb3B5LCBmdWxsUHJvcGVydHlOYW1lKSAhPSAtMSkge1xuXHRcdFx0XHRcdFx0bWFwcGVkUm9vdE9iamVjdFtpbmRleGVyXSA9IHJvb3RPYmplY3RbaW5kZXhlcl07XG5cdFx0XHRcdFx0XHRyZXR1cm47XG5cdFx0XHRcdFx0fVxuXG5cdFx0XHRcdFx0aWYodHlwZW9mIHJvb3RPYmplY3RbaW5kZXhlcl0gIT0gXCJvYmplY3RcIiAmJiB0eXBlb2Ygcm9vdE9iamVjdFtpbmRleGVyXSAhPSBcImFycmF5XCIgJiYgb3B0aW9ucy5vYnNlcnZlLmxlbmd0aCA+IDAgJiYga28udXRpbHMuYXJyYXlJbmRleE9mKG9wdGlvbnMub2JzZXJ2ZSwgZnVsbFByb3BlcnR5TmFtZSkgPT0gLTEpXG5cdFx0XHRcdFx0e1xuXHRcdFx0XHRcdFx0bWFwcGVkUm9vdE9iamVjdFtpbmRleGVyXSA9IHJvb3RPYmplY3RbaW5kZXhlcl07XG5cdFx0XHRcdFx0XHRvcHRpb25zLmNvcGllZFByb3BlcnRpZXNbZnVsbFByb3BlcnR5TmFtZV0gPSB0cnVlO1xuXHRcdFx0XHRcdFx0cmV0dXJuO1xuXHRcdFx0XHRcdH1cblx0XHRcdFx0XHRcblx0XHRcdFx0XHQvLyBJbiBjYXNlIHdlIGFyZSBhZGRpbmcgYW4gYWxyZWFkeSBtYXBwZWQgcHJvcGVydHksIGZpbGwgaXQgd2l0aCB0aGUgcHJldmlvdXNseSBtYXBwZWQgcHJvcGVydHkgdmFsdWUgdG8gcHJldmVudCByZWN1cnNpb24uXG5cdFx0XHRcdFx0Ly8gSWYgdGhpcyBpcyBhIHByb3BlcnR5IHRoYXQgd2FzIGdlbmVyYXRlZCBieSBmcm9tSlMsIHdlIHNob3VsZCB1c2UgdGhlIG9wdGlvbnMgc3BlY2lmaWVkIHRoZXJlXG5cdFx0XHRcdFx0dmFyIHByZXZNYXBwZWRQcm9wZXJ0eSA9IHZpc2l0ZWRPYmplY3RzLmdldChyb290T2JqZWN0W2luZGV4ZXJdKTtcblx0XHRcdFx0XHR2YXIgcmV0dmFsID0gdXBkYXRlVmlld01vZGVsKG1hcHBlZFJvb3RPYmplY3RbaW5kZXhlcl0sIHJvb3RPYmplY3RbaW5kZXhlcl0sIG9wdGlvbnMsIGluZGV4ZXIsIG1hcHBlZFJvb3RPYmplY3QsIGZ1bGxQcm9wZXJ0eU5hbWUsIG1hcHBlZFJvb3RPYmplY3QpO1xuXHRcdFx0XHRcdHZhciB2YWx1ZSA9IHByZXZNYXBwZWRQcm9wZXJ0eSB8fCByZXR2YWw7XG5cdFx0XHRcdFx0XG5cdFx0XHRcdFx0aWYob3B0aW9ucy5vYnNlcnZlLmxlbmd0aCA+IDAgJiYga28udXRpbHMuYXJyYXlJbmRleE9mKG9wdGlvbnMub2JzZXJ2ZSwgZnVsbFByb3BlcnR5TmFtZSkgPT0gLTEpXG5cdFx0XHRcdFx0e1xuXHRcdFx0XHRcdFx0bWFwcGVkUm9vdE9iamVjdFtpbmRleGVyXSA9IHZhbHVlKCk7XG5cdFx0XHRcdFx0XHRvcHRpb25zLmNvcGllZFByb3BlcnRpZXNbZnVsbFByb3BlcnR5TmFtZV0gPSB0cnVlO1xuXHRcdFx0XHRcdFx0cmV0dXJuO1xuXHRcdFx0XHRcdH1cblx0XHRcdFx0XHRcblx0XHRcdFx0XHRpZiAoa28uaXNXcml0ZWFibGVPYnNlcnZhYmxlKG1hcHBlZFJvb3RPYmplY3RbaW5kZXhlcl0pKSB7XG5cdFx0XHRcdFx0XHR2YWx1ZSA9IGtvLnV0aWxzLnVud3JhcE9ic2VydmFibGUodmFsdWUpO1xuXHRcdFx0XHRcdFx0aWYgKG1hcHBlZFJvb3RPYmplY3RbaW5kZXhlcl0oKSAhPT0gdmFsdWUpIHtcblx0XHRcdFx0XHRcdFx0bWFwcGVkUm9vdE9iamVjdFtpbmRleGVyXSh2YWx1ZSk7XG5cdFx0XHRcdFx0XHR9XG5cdFx0XHRcdFx0fSBlbHNlIHtcblx0XHRcdFx0XHRcdHZhbHVlID0gbWFwcGVkUm9vdE9iamVjdFtpbmRleGVyXSA9PT0gdW5kZWZpbmVkID8gdmFsdWUgOiBrby51dGlscy51bndyYXBPYnNlcnZhYmxlKHZhbHVlKTtcblx0XHRcdFx0XHRcdG1hcHBlZFJvb3RPYmplY3RbaW5kZXhlcl0gPSB2YWx1ZTtcblx0XHRcdFx0XHR9XG5cblx0XHRcdFx0XHRvcHRpb25zLm1hcHBlZFByb3BlcnRpZXNbZnVsbFByb3BlcnR5TmFtZV0gPSB0cnVlO1xuXHRcdFx0XHR9KTtcblx0XHRcdH1cblx0XHR9IGVsc2UgeyAvL21hcHBlZFJvb3RPYmplY3QgaXMgYW4gYXJyYXlcblx0XHRcdHZhciBjaGFuZ2VzID0gW107XG5cblx0XHRcdHZhciBoYXNLZXlDYWxsYmFjayA9IGZhbHNlO1xuXHRcdFx0dmFyIGtleUNhbGxiYWNrID0gZnVuY3Rpb24gKHgpIHtcblx0XHRcdFx0cmV0dXJuIHg7XG5cdFx0XHR9XG5cdFx0XHRpZiAob3B0aW9uc1twYXJlbnROYW1lXSAmJiBvcHRpb25zW3BhcmVudE5hbWVdLmtleSkge1xuXHRcdFx0XHRrZXlDYWxsYmFjayA9IG9wdGlvbnNbcGFyZW50TmFtZV0ua2V5O1xuXHRcdFx0XHRoYXNLZXlDYWxsYmFjayA9IHRydWU7XG5cdFx0XHR9XG5cblx0XHRcdGlmICgha28uaXNPYnNlcnZhYmxlKG1hcHBlZFJvb3RPYmplY3QpKSB7XG5cdFx0XHRcdC8vIFdoZW4gY3JlYXRpbmcgdGhlIG5ldyBvYnNlcnZhYmxlIGFycmF5LCBhbHNvIGFkZCBhIGJ1bmNoIG9mIHV0aWxpdHkgZnVuY3Rpb25zIHRoYXQgdGFrZSB0aGUgJ2tleScgb2YgdGhlIGFycmF5IGl0ZW1zIGludG8gYWNjb3VudC5cblx0XHRcdFx0bWFwcGVkUm9vdE9iamVjdCA9IGtvLm9ic2VydmFibGVBcnJheShbXSk7XG5cblx0XHRcdFx0bWFwcGVkUm9vdE9iamVjdC5tYXBwZWRSZW1vdmUgPSBmdW5jdGlvbiAodmFsdWVPclByZWRpY2F0ZSkge1xuXHRcdFx0XHRcdHZhciBwcmVkaWNhdGUgPSB0eXBlb2YgdmFsdWVPclByZWRpY2F0ZSA9PSBcImZ1bmN0aW9uXCIgPyB2YWx1ZU9yUHJlZGljYXRlIDogZnVuY3Rpb24gKHZhbHVlKSB7XG5cdFx0XHRcdFx0XHRcdHJldHVybiB2YWx1ZSA9PT0ga2V5Q2FsbGJhY2sodmFsdWVPclByZWRpY2F0ZSk7XG5cdFx0XHRcdFx0XHR9O1xuXHRcdFx0XHRcdHJldHVybiBtYXBwZWRSb290T2JqZWN0LnJlbW92ZShmdW5jdGlvbiAoaXRlbSkge1xuXHRcdFx0XHRcdFx0cmV0dXJuIHByZWRpY2F0ZShrZXlDYWxsYmFjayhpdGVtKSk7XG5cdFx0XHRcdFx0fSk7XG5cdFx0XHRcdH1cblxuXHRcdFx0XHRtYXBwZWRSb290T2JqZWN0Lm1hcHBlZFJlbW92ZUFsbCA9IGZ1bmN0aW9uIChhcnJheU9mVmFsdWVzKSB7XG5cdFx0XHRcdFx0dmFyIGFycmF5T2ZLZXlzID0gZmlsdGVyQXJyYXlCeUtleShhcnJheU9mVmFsdWVzLCBrZXlDYWxsYmFjayk7XG5cdFx0XHRcdFx0cmV0dXJuIG1hcHBlZFJvb3RPYmplY3QucmVtb3ZlKGZ1bmN0aW9uIChpdGVtKSB7XG5cdFx0XHRcdFx0XHRyZXR1cm4ga28udXRpbHMuYXJyYXlJbmRleE9mKGFycmF5T2ZLZXlzLCBrZXlDYWxsYmFjayhpdGVtKSkgIT0gLTE7XG5cdFx0XHRcdFx0fSk7XG5cdFx0XHRcdH1cblxuXHRcdFx0XHRtYXBwZWRSb290T2JqZWN0Lm1hcHBlZERlc3Ryb3kgPSBmdW5jdGlvbiAodmFsdWVPclByZWRpY2F0ZSkge1xuXHRcdFx0XHRcdHZhciBwcmVkaWNhdGUgPSB0eXBlb2YgdmFsdWVPclByZWRpY2F0ZSA9PSBcImZ1bmN0aW9uXCIgPyB2YWx1ZU9yUHJlZGljYXRlIDogZnVuY3Rpb24gKHZhbHVlKSB7XG5cdFx0XHRcdFx0XHRcdHJldHVybiB2YWx1ZSA9PT0ga2V5Q2FsbGJhY2sodmFsdWVPclByZWRpY2F0ZSk7XG5cdFx0XHRcdFx0XHR9O1xuXHRcdFx0XHRcdHJldHVybiBtYXBwZWRSb290T2JqZWN0LmRlc3Ryb3koZnVuY3Rpb24gKGl0ZW0pIHtcblx0XHRcdFx0XHRcdHJldHVybiBwcmVkaWNhdGUoa2V5Q2FsbGJhY2soaXRlbSkpO1xuXHRcdFx0XHRcdH0pO1xuXHRcdFx0XHR9XG5cblx0XHRcdFx0bWFwcGVkUm9vdE9iamVjdC5tYXBwZWREZXN0cm95QWxsID0gZnVuY3Rpb24gKGFycmF5T2ZWYWx1ZXMpIHtcblx0XHRcdFx0XHR2YXIgYXJyYXlPZktleXMgPSBmaWx0ZXJBcnJheUJ5S2V5KGFycmF5T2ZWYWx1ZXMsIGtleUNhbGxiYWNrKTtcblx0XHRcdFx0XHRyZXR1cm4gbWFwcGVkUm9vdE9iamVjdC5kZXN0cm95KGZ1bmN0aW9uIChpdGVtKSB7XG5cdFx0XHRcdFx0XHRyZXR1cm4ga28udXRpbHMuYXJyYXlJbmRleE9mKGFycmF5T2ZLZXlzLCBrZXlDYWxsYmFjayhpdGVtKSkgIT0gLTE7XG5cdFx0XHRcdFx0fSk7XG5cdFx0XHRcdH1cblxuXHRcdFx0XHRtYXBwZWRSb290T2JqZWN0Lm1hcHBlZEluZGV4T2YgPSBmdW5jdGlvbiAoaXRlbSkge1xuXHRcdFx0XHRcdHZhciBrZXlzID0gZmlsdGVyQXJyYXlCeUtleShtYXBwZWRSb290T2JqZWN0KCksIGtleUNhbGxiYWNrKTtcblx0XHRcdFx0XHR2YXIga2V5ID0ga2V5Q2FsbGJhY2soaXRlbSk7XG5cdFx0XHRcdFx0cmV0dXJuIGtvLnV0aWxzLmFycmF5SW5kZXhPZihrZXlzLCBrZXkpO1xuXHRcdFx0XHR9XG5cblx0XHRcdFx0bWFwcGVkUm9vdE9iamVjdC5tYXBwZWRHZXQgPSBmdW5jdGlvbiAoaXRlbSkge1xuXHRcdFx0XHRcdHJldHVybiBtYXBwZWRSb290T2JqZWN0KClbbWFwcGVkUm9vdE9iamVjdC5tYXBwZWRJbmRleE9mKGl0ZW0pXTtcblx0XHRcdFx0fVxuXG5cdFx0XHRcdG1hcHBlZFJvb3RPYmplY3QubWFwcGVkQ3JlYXRlID0gZnVuY3Rpb24gKHZhbHVlKSB7XG5cdFx0XHRcdFx0aWYgKG1hcHBlZFJvb3RPYmplY3QubWFwcGVkSW5kZXhPZih2YWx1ZSkgIT09IC0xKSB7XG5cdFx0XHRcdFx0XHR0aHJvdyBuZXcgRXJyb3IoXCJUaGVyZSBhbHJlYWR5IGlzIGFuIG9iamVjdCB3aXRoIHRoZSBrZXkgdGhhdCB5b3Ugc3BlY2lmaWVkLlwiKTtcblx0XHRcdFx0XHR9XG5cblx0XHRcdFx0XHR2YXIgaXRlbSA9IGhhc0NyZWF0ZUNhbGxiYWNrKCkgPyBjcmVhdGVDYWxsYmFjayh2YWx1ZSkgOiB2YWx1ZTtcblx0XHRcdFx0XHRpZiAoaGFzVXBkYXRlQ2FsbGJhY2soKSkge1xuXHRcdFx0XHRcdFx0dmFyIG5ld1ZhbHVlID0gdXBkYXRlQ2FsbGJhY2soaXRlbSwgdmFsdWUpO1xuXHRcdFx0XHRcdFx0aWYgKGtvLmlzV3JpdGVhYmxlT2JzZXJ2YWJsZShpdGVtKSkge1xuXHRcdFx0XHRcdFx0XHRpdGVtKG5ld1ZhbHVlKTtcblx0XHRcdFx0XHRcdH0gZWxzZSB7XG5cdFx0XHRcdFx0XHRcdGl0ZW0gPSBuZXdWYWx1ZTtcblx0XHRcdFx0XHRcdH1cblx0XHRcdFx0XHR9XG5cdFx0XHRcdFx0bWFwcGVkUm9vdE9iamVjdC5wdXNoKGl0ZW0pO1xuXHRcdFx0XHRcdHJldHVybiBpdGVtO1xuXHRcdFx0XHR9XG5cdFx0XHR9XG5cblx0XHRcdHZhciBjdXJyZW50QXJyYXlLZXlzID0gZmlsdGVyQXJyYXlCeUtleShrby51dGlscy51bndyYXBPYnNlcnZhYmxlKG1hcHBlZFJvb3RPYmplY3QpLCBrZXlDYWxsYmFjaykuc29ydCgpO1xuXHRcdFx0dmFyIG5ld0FycmF5S2V5cyA9IGZpbHRlckFycmF5QnlLZXkocm9vdE9iamVjdCwga2V5Q2FsbGJhY2spO1xuXHRcdFx0aWYgKGhhc0tleUNhbGxiYWNrKSBuZXdBcnJheUtleXMuc29ydCgpO1xuXHRcdFx0dmFyIGVkaXRTY3JpcHQgPSBrby51dGlscy5jb21wYXJlQXJyYXlzKGN1cnJlbnRBcnJheUtleXMsIG5ld0FycmF5S2V5cyk7XG5cblx0XHRcdHZhciBpZ25vcmVJbmRleE9mID0ge307XG5cdFx0XHRcblx0XHRcdHZhciBpLCBqO1xuXG5cdFx0XHR2YXIgdW53cmFwcGVkUm9vdE9iamVjdCA9IGtvLnV0aWxzLnVud3JhcE9ic2VydmFibGUocm9vdE9iamVjdCk7XG5cdFx0XHR2YXIgaXRlbXNCeUtleSA9IHt9O1xuXHRcdFx0dmFyIG9wdGltaXplZEtleXMgPSB0cnVlO1xuXHRcdFx0Zm9yIChpID0gMCwgaiA9IHVud3JhcHBlZFJvb3RPYmplY3QubGVuZ3RoOyBpIDwgajsgaSsrKSB7XG5cdFx0XHRcdHZhciBrZXkgPSBrZXlDYWxsYmFjayh1bndyYXBwZWRSb290T2JqZWN0W2ldKTtcblx0XHRcdFx0aWYgKGtleSA9PT0gdW5kZWZpbmVkIHx8IGtleSBpbnN0YW5jZW9mIE9iamVjdCkge1xuXHRcdFx0XHRcdG9wdGltaXplZEtleXMgPSBmYWxzZTtcblx0XHRcdFx0XHRicmVhaztcblx0XHRcdFx0fVxuXHRcdFx0XHRpdGVtc0J5S2V5W2tleV0gPSB1bndyYXBwZWRSb290T2JqZWN0W2ldO1xuXHRcdFx0fVxuXG5cdFx0XHR2YXIgbmV3Q29udGVudHMgPSBbXTtcblx0XHRcdHZhciBwYXNzZWRPdmVyID0gMDtcblx0XHRcdGZvciAoaSA9IDAsIGogPSBlZGl0U2NyaXB0Lmxlbmd0aDsgaSA8IGo7IGkrKykge1xuXHRcdFx0XHR2YXIga2V5ID0gZWRpdFNjcmlwdFtpXTtcblx0XHRcdFx0dmFyIG1hcHBlZEl0ZW07XG5cdFx0XHRcdHZhciBmdWxsUHJvcGVydHlOYW1lID0gcGFyZW50UHJvcGVydHlOYW1lICsgXCJbXCIgKyBpICsgXCJdXCI7XG5cdFx0XHRcdHN3aXRjaCAoa2V5LnN0YXR1cykge1xuXHRcdFx0XHRjYXNlIFwiYWRkZWRcIjpcblx0XHRcdFx0XHR2YXIgaXRlbSA9IG9wdGltaXplZEtleXMgPyBpdGVtc0J5S2V5W2tleS52YWx1ZV0gOiBnZXRJdGVtQnlLZXkoa28udXRpbHMudW53cmFwT2JzZXJ2YWJsZShyb290T2JqZWN0KSwga2V5LnZhbHVlLCBrZXlDYWxsYmFjayk7XG5cdFx0XHRcdFx0bWFwcGVkSXRlbSA9IHVwZGF0ZVZpZXdNb2RlbCh1bmRlZmluZWQsIGl0ZW0sIG9wdGlvbnMsIHBhcmVudE5hbWUsIG1hcHBlZFJvb3RPYmplY3QsIGZ1bGxQcm9wZXJ0eU5hbWUsIHBhcmVudCk7XG5cdFx0XHRcdFx0aWYoIWhhc0NyZWF0ZUNhbGxiYWNrKCkpIHtcblx0XHRcdFx0XHRcdG1hcHBlZEl0ZW0gPSBrby51dGlscy51bndyYXBPYnNlcnZhYmxlKG1hcHBlZEl0ZW0pO1xuXHRcdFx0XHRcdH1cblxuXHRcdFx0XHRcdHZhciBpbmRleCA9IGlnbm9yYWJsZUluZGV4T2Yoa28udXRpbHMudW53cmFwT2JzZXJ2YWJsZShyb290T2JqZWN0KSwgaXRlbSwgaWdub3JlSW5kZXhPZik7XG5cdFx0XHRcdFx0XG5cdFx0XHRcdFx0aWYgKG1hcHBlZEl0ZW0gPT09IGVtcHR5UmV0dXJuKSB7XG5cdFx0XHRcdFx0XHRwYXNzZWRPdmVyKys7XG5cdFx0XHRcdFx0fSBlbHNlIHtcblx0XHRcdFx0XHRcdG5ld0NvbnRlbnRzW2luZGV4IC0gcGFzc2VkT3Zlcl0gPSBtYXBwZWRJdGVtO1xuXHRcdFx0XHRcdH1cblx0XHRcdFx0XHRcdFxuXHRcdFx0XHRcdGlnbm9yZUluZGV4T2ZbaW5kZXhdID0gdHJ1ZTtcblx0XHRcdFx0XHRicmVhaztcblx0XHRcdFx0Y2FzZSBcInJldGFpbmVkXCI6XG5cdFx0XHRcdFx0dmFyIGl0ZW0gPSBvcHRpbWl6ZWRLZXlzID8gaXRlbXNCeUtleVtrZXkudmFsdWVdIDogZ2V0SXRlbUJ5S2V5KGtvLnV0aWxzLnVud3JhcE9ic2VydmFibGUocm9vdE9iamVjdCksIGtleS52YWx1ZSwga2V5Q2FsbGJhY2spO1xuXHRcdFx0XHRcdG1hcHBlZEl0ZW0gPSBnZXRJdGVtQnlLZXkobWFwcGVkUm9vdE9iamVjdCwga2V5LnZhbHVlLCBrZXlDYWxsYmFjayk7XG5cdFx0XHRcdFx0dXBkYXRlVmlld01vZGVsKG1hcHBlZEl0ZW0sIGl0ZW0sIG9wdGlvbnMsIHBhcmVudE5hbWUsIG1hcHBlZFJvb3RPYmplY3QsIGZ1bGxQcm9wZXJ0eU5hbWUsIHBhcmVudCk7XG5cblx0XHRcdFx0XHR2YXIgaW5kZXggPSBpZ25vcmFibGVJbmRleE9mKGtvLnV0aWxzLnVud3JhcE9ic2VydmFibGUocm9vdE9iamVjdCksIGl0ZW0sIGlnbm9yZUluZGV4T2YpO1xuXHRcdFx0XHRcdG5ld0NvbnRlbnRzW2luZGV4XSA9IG1hcHBlZEl0ZW07XG5cdFx0XHRcdFx0aWdub3JlSW5kZXhPZltpbmRleF0gPSB0cnVlO1xuXHRcdFx0XHRcdGJyZWFrO1xuXHRcdFx0XHRjYXNlIFwiZGVsZXRlZFwiOlxuXHRcdFx0XHRcdG1hcHBlZEl0ZW0gPSBnZXRJdGVtQnlLZXkobWFwcGVkUm9vdE9iamVjdCwga2V5LnZhbHVlLCBrZXlDYWxsYmFjayk7XG5cdFx0XHRcdFx0YnJlYWs7XG5cdFx0XHRcdH1cblxuXHRcdFx0XHRjaGFuZ2VzLnB1c2goe1xuXHRcdFx0XHRcdGV2ZW50OiBrZXkuc3RhdHVzLFxuXHRcdFx0XHRcdGl0ZW06IG1hcHBlZEl0ZW1cblx0XHRcdFx0fSk7XG5cdFx0XHR9XG5cblx0XHRcdG1hcHBlZFJvb3RPYmplY3QobmV3Q29udGVudHMpO1xuXG5cdFx0XHRpZiAob3B0aW9uc1twYXJlbnROYW1lXSAmJiBvcHRpb25zW3BhcmVudE5hbWVdLmFycmF5Q2hhbmdlZCkge1xuXHRcdFx0XHRrby51dGlscy5hcnJheUZvckVhY2goY2hhbmdlcywgZnVuY3Rpb24gKGNoYW5nZSkge1xuXHRcdFx0XHRcdG9wdGlvbnNbcGFyZW50TmFtZV0uYXJyYXlDaGFuZ2VkKGNoYW5nZS5ldmVudCwgY2hhbmdlLml0ZW0pO1xuXHRcdFx0XHR9KTtcblx0XHRcdH1cblx0XHR9XG5cblx0XHRyZXR1cm4gbWFwcGVkUm9vdE9iamVjdDtcblx0fVxuXG5cdGZ1bmN0aW9uIGlnbm9yYWJsZUluZGV4T2YoYXJyYXksIGl0ZW0sIGlnbm9yZUluZGljZXMpIHtcblx0XHRmb3IgKHZhciBpID0gMCwgaiA9IGFycmF5Lmxlbmd0aDsgaSA8IGo7IGkrKykge1xuXHRcdFx0aWYgKGlnbm9yZUluZGljZXNbaV0gPT09IHRydWUpIGNvbnRpbnVlO1xuXHRcdFx0aWYgKGFycmF5W2ldID09PSBpdGVtKSByZXR1cm4gaTtcblx0XHR9XG5cdFx0cmV0dXJuIG51bGw7XG5cdH1cblxuXHRmdW5jdGlvbiBtYXBLZXkoaXRlbSwgY2FsbGJhY2spIHtcblx0XHR2YXIgbWFwcGVkSXRlbTtcblx0XHRpZiAoY2FsbGJhY2spIG1hcHBlZEl0ZW0gPSBjYWxsYmFjayhpdGVtKTtcblx0XHRpZiAoZXhwb3J0cy5nZXRUeXBlKG1hcHBlZEl0ZW0pID09PSBcInVuZGVmaW5lZFwiKSBtYXBwZWRJdGVtID0gaXRlbTtcblxuXHRcdHJldHVybiBrby51dGlscy51bndyYXBPYnNlcnZhYmxlKG1hcHBlZEl0ZW0pO1xuXHR9XG5cblx0ZnVuY3Rpb24gZ2V0SXRlbUJ5S2V5KGFycmF5LCBrZXksIGNhbGxiYWNrKSB7XG5cdFx0YXJyYXkgPSBrby51dGlscy51bndyYXBPYnNlcnZhYmxlKGFycmF5KTtcblx0XHRmb3IgKHZhciBpID0gMCwgaiA9IGFycmF5Lmxlbmd0aDsgaSA8IGo7IGkrKykge1xuXHRcdFx0dmFyIGl0ZW0gPSBhcnJheVtpXTtcblx0XHRcdGlmIChtYXBLZXkoaXRlbSwgY2FsbGJhY2spID09PSBrZXkpIHJldHVybiBpdGVtO1xuXHRcdH1cblxuXHRcdHRocm93IG5ldyBFcnJvcihcIldoZW4gY2FsbGluZyBrby51cGRhdGUqLCB0aGUga2V5ICdcIiArIGtleSArIFwiJyB3YXMgbm90IGZvdW5kIVwiKTtcblx0fVxuXG5cdGZ1bmN0aW9uIGZpbHRlckFycmF5QnlLZXkoYXJyYXksIGNhbGxiYWNrKSB7XG5cdFx0cmV0dXJuIGtvLnV0aWxzLmFycmF5TWFwKGtvLnV0aWxzLnVud3JhcE9ic2VydmFibGUoYXJyYXkpLCBmdW5jdGlvbiAoaXRlbSkge1xuXHRcdFx0aWYgKGNhbGxiYWNrKSB7XG5cdFx0XHRcdHJldHVybiBtYXBLZXkoaXRlbSwgY2FsbGJhY2spO1xuXHRcdFx0fSBlbHNlIHtcblx0XHRcdFx0cmV0dXJuIGl0ZW07XG5cdFx0XHR9XG5cdFx0fSk7XG5cdH1cblxuXHRmdW5jdGlvbiB2aXNpdFByb3BlcnRpZXNPckFycmF5RW50cmllcyhyb290T2JqZWN0LCB2aXNpdG9yQ2FsbGJhY2spIHtcblx0XHRpZiAoZXhwb3J0cy5nZXRUeXBlKHJvb3RPYmplY3QpID09PSBcImFycmF5XCIpIHtcblx0XHRcdGZvciAodmFyIGkgPSAwOyBpIDwgcm9vdE9iamVjdC5sZW5ndGg7IGkrKylcblx0XHRcdHZpc2l0b3JDYWxsYmFjayhpKTtcblx0XHR9IGVsc2Uge1xuXHRcdFx0Zm9yICh2YXIgcHJvcGVydHlOYW1lIGluIHJvb3RPYmplY3QpXG5cdFx0XHR2aXNpdG9yQ2FsbGJhY2socHJvcGVydHlOYW1lKTtcblx0XHR9XG5cdH07XG5cblx0ZnVuY3Rpb24gY2FuSGF2ZVByb3BlcnRpZXMob2JqZWN0KSB7XG5cdFx0dmFyIHR5cGUgPSBleHBvcnRzLmdldFR5cGUob2JqZWN0KTtcblx0XHRyZXR1cm4gKCh0eXBlID09PSBcIm9iamVjdFwiKSB8fCAodHlwZSA9PT0gXCJhcnJheVwiKSkgJiYgKG9iamVjdCAhPT0gbnVsbCk7XG5cdH1cblxuXHQvLyBCYXNlZCBvbiB0aGUgcGFyZW50TmFtZSwgdGhpcyBjcmVhdGVzIGEgZnVsbHkgY2xhc3NpZmllZCBuYW1lIG9mIGEgcHJvcGVydHlcblxuXHRmdW5jdGlvbiBnZXRQcm9wZXJ0eU5hbWUocGFyZW50TmFtZSwgcGFyZW50LCBpbmRleGVyKSB7XG5cdFx0dmFyIHByb3BlcnR5TmFtZSA9IHBhcmVudE5hbWUgfHwgXCJcIjtcblx0XHRpZiAoZXhwb3J0cy5nZXRUeXBlKHBhcmVudCkgPT09IFwiYXJyYXlcIikge1xuXHRcdFx0aWYgKHBhcmVudE5hbWUpIHtcblx0XHRcdFx0cHJvcGVydHlOYW1lICs9IFwiW1wiICsgaW5kZXhlciArIFwiXVwiO1xuXHRcdFx0fVxuXHRcdH0gZWxzZSB7XG5cdFx0XHRpZiAocGFyZW50TmFtZSkge1xuXHRcdFx0XHRwcm9wZXJ0eU5hbWUgKz0gXCIuXCI7XG5cdFx0XHR9XG5cdFx0XHRwcm9wZXJ0eU5hbWUgKz0gaW5kZXhlcjtcblx0XHR9XG5cdFx0cmV0dXJuIHByb3BlcnR5TmFtZTtcblx0fVxuXG5cdGV4cG9ydHMudmlzaXRNb2RlbCA9IGZ1bmN0aW9uIChyb290T2JqZWN0LCBjYWxsYmFjaywgb3B0aW9ucykge1xuXHRcdG9wdGlvbnMgPSBvcHRpb25zIHx8IHt9O1xuXHRcdG9wdGlvbnMudmlzaXRlZE9iamVjdHMgPSBvcHRpb25zLnZpc2l0ZWRPYmplY3RzIHx8IG5ldyBvYmplY3RMb29rdXAoKTtcblxuXHRcdHZhciBtYXBwZWRSb290T2JqZWN0O1xuXHRcdHZhciB1bndyYXBwZWRSb290T2JqZWN0ID0ga28udXRpbHMudW53cmFwT2JzZXJ2YWJsZShyb290T2JqZWN0KTtcblxuXHRcdGlmICghY2FuSGF2ZVByb3BlcnRpZXModW53cmFwcGVkUm9vdE9iamVjdCkpIHtcblx0XHRcdHJldHVybiBjYWxsYmFjayhyb290T2JqZWN0LCBvcHRpb25zLnBhcmVudE5hbWUpO1xuXHRcdH0gZWxzZSB7XG5cdFx0XHRvcHRpb25zID0gZmlsbE9wdGlvbnMob3B0aW9ucywgdW53cmFwcGVkUm9vdE9iamVjdFttYXBwaW5nUHJvcGVydHldKTtcblxuXHRcdFx0Ly8gT25seSBkbyBhIGNhbGxiYWNrLCBidXQgaWdub3JlIHRoZSByZXN1bHRzXG5cdFx0XHRjYWxsYmFjayhyb290T2JqZWN0LCBvcHRpb25zLnBhcmVudE5hbWUpO1xuXHRcdFx0bWFwcGVkUm9vdE9iamVjdCA9IGV4cG9ydHMuZ2V0VHlwZSh1bndyYXBwZWRSb290T2JqZWN0KSA9PT0gXCJhcnJheVwiID8gW10gOiB7fTtcblx0XHR9XG5cblx0XHRvcHRpb25zLnZpc2l0ZWRPYmplY3RzLnNhdmUocm9vdE9iamVjdCwgbWFwcGVkUm9vdE9iamVjdCk7XG5cblx0XHR2YXIgcGFyZW50TmFtZSA9IG9wdGlvbnMucGFyZW50TmFtZTtcblx0XHR2aXNpdFByb3BlcnRpZXNPckFycmF5RW50cmllcyh1bndyYXBwZWRSb290T2JqZWN0LCBmdW5jdGlvbiAoaW5kZXhlcikge1xuXHRcdFx0aWYgKG9wdGlvbnMuaWdub3JlICYmIGtvLnV0aWxzLmFycmF5SW5kZXhPZihvcHRpb25zLmlnbm9yZSwgaW5kZXhlcikgIT0gLTEpIHJldHVybjtcblxuXHRcdFx0dmFyIHByb3BlcnR5VmFsdWUgPSB1bndyYXBwZWRSb290T2JqZWN0W2luZGV4ZXJdO1xuXHRcdFx0b3B0aW9ucy5wYXJlbnROYW1lID0gZ2V0UHJvcGVydHlOYW1lKHBhcmVudE5hbWUsIHVud3JhcHBlZFJvb3RPYmplY3QsIGluZGV4ZXIpO1xuXG5cdFx0XHQvLyBJZiB3ZSBkb24ndCB3YW50IHRvIGV4cGxpY2l0bHkgY29weSB0aGUgdW5tYXBwZWQgcHJvcGVydHkuLi5cblx0XHRcdGlmIChrby51dGlscy5hcnJheUluZGV4T2Yob3B0aW9ucy5jb3B5LCBpbmRleGVyKSA9PT0gLTEpIHtcblx0XHRcdFx0Ly8gLi4uZmluZCBvdXQgaWYgaXQncyBhIHByb3BlcnR5IHdlIHdhbnQgdG8gZXhwbGljaXRseSBpbmNsdWRlXG5cdFx0XHRcdGlmIChrby51dGlscy5hcnJheUluZGV4T2Yob3B0aW9ucy5pbmNsdWRlLCBpbmRleGVyKSA9PT0gLTEpIHtcblx0XHRcdFx0XHQvLyBUaGUgbWFwcGVkIHByb3BlcnRpZXMgb2JqZWN0IGNvbnRhaW5zIGFsbCB0aGUgcHJvcGVydGllcyB0aGF0IHdlcmUgcGFydCBvZiB0aGUgb3JpZ2luYWwgb2JqZWN0LlxuXHRcdFx0XHRcdC8vIElmIGEgcHJvcGVydHkgZG9lcyBub3QgZXhpc3QsIGFuZCBpdCBpcyBub3QgYmVjYXVzZSBpdCBpcyBwYXJ0IG9mIGFuIGFycmF5IChlLmcuIFwibXlQcm9wWzNdXCIpLCB0aGVuIGl0IHNob3VsZCBub3QgYmUgdW5tYXBwZWQuXG5cdFx0XHRcdCAgICBpZiAodW53cmFwcGVkUm9vdE9iamVjdFttYXBwaW5nUHJvcGVydHldXG5cdFx0XHRcdCAgICAgICAgJiYgdW53cmFwcGVkUm9vdE9iamVjdFttYXBwaW5nUHJvcGVydHldLm1hcHBlZFByb3BlcnRpZXMgJiYgIXVud3JhcHBlZFJvb3RPYmplY3RbbWFwcGluZ1Byb3BlcnR5XS5tYXBwZWRQcm9wZXJ0aWVzW2luZGV4ZXJdXG5cdFx0XHRcdCAgICAgICAgJiYgdW53cmFwcGVkUm9vdE9iamVjdFttYXBwaW5nUHJvcGVydHldLmNvcGllZFByb3BlcnRpZXMgJiYgIXVud3JhcHBlZFJvb3RPYmplY3RbbWFwcGluZ1Byb3BlcnR5XS5jb3BpZWRQcm9wZXJ0aWVzW2luZGV4ZXJdXG5cdFx0XHRcdCAgICAgICAgJiYgIShleHBvcnRzLmdldFR5cGUodW53cmFwcGVkUm9vdE9iamVjdCkgPT09IFwiYXJyYXlcIikpIHtcblx0XHRcdFx0XHRcdHJldHVybjtcblx0XHRcdFx0XHR9XG5cdFx0XHRcdH1cblx0XHRcdH1cblxuXHRcdFx0dmFyIG91dHB1dFByb3BlcnR5O1xuXHRcdFx0c3dpdGNoIChleHBvcnRzLmdldFR5cGUoa28udXRpbHMudW53cmFwT2JzZXJ2YWJsZShwcm9wZXJ0eVZhbHVlKSkpIHtcblx0XHRcdGNhc2UgXCJvYmplY3RcIjpcblx0XHRcdGNhc2UgXCJhcnJheVwiOlxuXHRcdFx0Y2FzZSBcInVuZGVmaW5lZFwiOlxuXHRcdFx0XHR2YXIgcHJldmlvdXNseU1hcHBlZFZhbHVlID0gb3B0aW9ucy52aXNpdGVkT2JqZWN0cy5nZXQocHJvcGVydHlWYWx1ZSk7XG5cdFx0XHRcdG1hcHBlZFJvb3RPYmplY3RbaW5kZXhlcl0gPSAoZXhwb3J0cy5nZXRUeXBlKHByZXZpb3VzbHlNYXBwZWRWYWx1ZSkgIT09IFwidW5kZWZpbmVkXCIpID8gcHJldmlvdXNseU1hcHBlZFZhbHVlIDogZXhwb3J0cy52aXNpdE1vZGVsKHByb3BlcnR5VmFsdWUsIGNhbGxiYWNrLCBvcHRpb25zKTtcblx0XHRcdFx0YnJlYWs7XG5cdFx0XHRkZWZhdWx0OlxuXHRcdFx0XHRtYXBwZWRSb290T2JqZWN0W2luZGV4ZXJdID0gY2FsbGJhY2socHJvcGVydHlWYWx1ZSwgb3B0aW9ucy5wYXJlbnROYW1lKTtcblx0XHRcdH1cblx0XHR9KTtcblxuXHRcdHJldHVybiBtYXBwZWRSb290T2JqZWN0O1xuXHR9XG5cblx0ZnVuY3Rpb24gc2ltcGxlT2JqZWN0TG9va3VwKCkge1xuXHRcdHZhciBrZXlzID0gW107XG5cdFx0dmFyIHZhbHVlcyA9IFtdO1xuXHRcdHRoaXMuc2F2ZSA9IGZ1bmN0aW9uIChrZXksIHZhbHVlKSB7XG5cdFx0XHR2YXIgZXhpc3RpbmdJbmRleCA9IGtvLnV0aWxzLmFycmF5SW5kZXhPZihrZXlzLCBrZXkpO1xuXHRcdFx0aWYgKGV4aXN0aW5nSW5kZXggPj0gMCkgdmFsdWVzW2V4aXN0aW5nSW5kZXhdID0gdmFsdWU7XG5cdFx0XHRlbHNlIHtcblx0XHRcdFx0a2V5cy5wdXNoKGtleSk7XG5cdFx0XHRcdHZhbHVlcy5wdXNoKHZhbHVlKTtcblx0XHRcdH1cblx0XHR9O1xuXHRcdHRoaXMuZ2V0ID0gZnVuY3Rpb24gKGtleSkge1xuXHRcdFx0dmFyIGV4aXN0aW5nSW5kZXggPSBrby51dGlscy5hcnJheUluZGV4T2Yoa2V5cywga2V5KTtcblx0XHRcdHZhciB2YWx1ZSA9IChleGlzdGluZ0luZGV4ID49IDApID8gdmFsdWVzW2V4aXN0aW5nSW5kZXhdIDogdW5kZWZpbmVkO1xuXHRcdFx0cmV0dXJuIHZhbHVlO1xuXHRcdH07XG5cdH07XG5cdFxuXHRmdW5jdGlvbiBvYmplY3RMb29rdXAoKSB7XG5cdFx0dmFyIGJ1Y2tldHMgPSB7fTtcblx0XHRcblx0XHR2YXIgZmluZEJ1Y2tldCA9IGZ1bmN0aW9uKGtleSkge1xuXHRcdFx0dmFyIGJ1Y2tldEtleTtcblx0XHRcdHRyeSB7XG5cdFx0XHRcdGJ1Y2tldEtleSA9IGtleTsvL0pTT04uc3RyaW5naWZ5KGtleSk7XG5cdFx0XHR9XG5cdFx0XHRjYXRjaCAoZSkge1xuXHRcdFx0XHRidWNrZXRLZXkgPSBcIiQkJFwiO1xuXHRcdFx0fVxuXG5cdFx0XHR2YXIgYnVja2V0ID0gYnVja2V0c1tidWNrZXRLZXldO1xuXHRcdFx0aWYgKGJ1Y2tldCA9PT0gdW5kZWZpbmVkKSB7XG5cdFx0XHRcdGJ1Y2tldCA9IG5ldyBzaW1wbGVPYmplY3RMb29rdXAoKTtcblx0XHRcdFx0YnVja2V0c1tidWNrZXRLZXldID0gYnVja2V0O1xuXHRcdFx0fVxuXHRcdFx0cmV0dXJuIGJ1Y2tldDtcblx0XHR9O1xuXHRcdFxuXHRcdHRoaXMuc2F2ZSA9IGZ1bmN0aW9uIChrZXksIHZhbHVlKSB7XG5cdFx0XHRmaW5kQnVja2V0KGtleSkuc2F2ZShrZXksIHZhbHVlKTtcblx0XHR9O1xuXHRcdHRoaXMuZ2V0ID0gZnVuY3Rpb24gKGtleSkge1xuXHRcdFx0cmV0dXJuIGZpbmRCdWNrZXQoa2V5KS5nZXQoa2V5KTtcblx0XHR9O1xuXHR9O1xufSkpOyIsIi8vIEtub2Nrb3V0IEZhc3QgTWFwcGluZyB2MC4xXG4vLyBMaWNlbnNlOiBNSVQgKGh0dHA6Ly93d3cub3BlbnNvdXJjZS5vcmcvbGljZW5zZXMvbWl0LWxpY2Vuc2UucGhwKVxuXG4oZnVuY3Rpb24gKGZhY3RvcnkpIHtcblx0Ly8gTW9kdWxlIHN5c3RlbXMgbWFnaWMgZGFuY2UuXG5cblx0aWYgKHR5cGVvZiByZXF1aXJlID09PSBcImZ1bmN0aW9uXCIgJiYgdHlwZW9mIGV4cG9ydHMgPT09IFwib2JqZWN0XCIgJiYgdHlwZW9mIG1vZHVsZSA9PT0gXCJvYmplY3RcIikge1xuXHRcdC8vIENvbW1vbkpTIG9yIE5vZGU6IGhhcmQtY29kZWQgZGVwZW5kZW5jeSBvbiBcImtub2Nrb3V0XCJcblx0XHRmYWN0b3J5KCh0eXBlb2Ygd2luZG93ICE9PSBcInVuZGVmaW5lZFwiID8gd2luZG93WydrbyddIDogdHlwZW9mIGdsb2JhbCAhPT0gXCJ1bmRlZmluZWRcIiA/IGdsb2JhbFsna28nXSA6IG51bGwpLCBleHBvcnRzKTtcblx0fSBlbHNlIGlmICh0eXBlb2YgZGVmaW5lID09PSBcImZ1bmN0aW9uXCIgJiYgZGVmaW5lW1wiYW1kXCJdKSB7XG5cdFx0Ly8gQU1EIGFub255bW91cyBtb2R1bGUgd2l0aCBoYXJkLWNvZGVkIGRlcGVuZGVuY3kgb24gXCJrbm9ja291dFwiXG5cdFx0ZGVmaW5lKFtcImtub2Nrb3V0XCIsIFwiZXhwb3J0c1wiXSwgZmFjdG9yeSk7XG5cdH0gZWxzZSB7XG5cdFx0Ly8gPHNjcmlwdD4gdGFnOiB1c2UgdGhlIGdsb2JhbCBga29gIG9iamVjdCwgYXR0YWNoaW5nIGEgYHdyYXBgIHByb3BlcnR5XG5cdFx0ZmFjdG9yeShrbywga28ud3JhcCA9IHt9KTtcblx0fVxufShmdW5jdGlvbiAoa28sIGV4cG9ydHMpIHtcbiAgICBcbiAgICAvLyB0aGlzIGZ1bmN0aW9uIG1pbWljcyBrby5tYXBwaW5nXG4gICAgZXhwb3J0cy5mcm9tSlMgPSBmdW5jdGlvbihqc09iamVjdCwgY29tcHV0ZWRGdW5jdGlvbnMpXG4gICAge1xuICAgICAgICByZXNldCgpO1xuXHRyZXR1cm4gd3JhcChqc09iamVjdCwgY29tcHV0ZWRGdW5jdGlvbnMpO1xuICAgIH1cblxuICAgIC8vIHRoaXMgZnVuY3Rpb24gdW53cmFwcyB0aGUgb3V0ZXIgZm9yIGFzc2lnbmluZyB0aGUgcmVzdWx0IHRvIGFuIG9ic2VydmFibGVcbiAgICAvLyBzZWUgaHR0cHM6Ly9naXRodWIuY29tL1N0ZXZlU2FuZGVyc29uL2tub2Nrb3V0L2lzc3Vlcy81MTdcbiAgICBleHBvcnRzLnVwZGF0ZUZyb21KUyA9IGZ1bmN0aW9uKG9ic2VydmFibGUsIGpzT2JqZWN0LCBjb21wdXRlZEZ1bmN0aW9ucylcbiAgICB7XG4gICAgICAgIHJlc2V0KCk7XG5cdHJldHVybiBvYnNlcnZhYmxlKGtvLnV0aWxzLnVud3JhcE9ic2VydmFibGUod3JhcChqc09iamVjdCwgY29tcHV0ZWRGdW5jdGlvbnMpKSk7XG4gICAgfVxuXG4gICAgZXhwb3J0cy5mcm9tSlNPTiA9IGZ1bmN0aW9uIChqc29uU3RyaW5nLCBjb21wdXRlZEZ1bmN0aW9ucykge1xuXHR2YXIgcGFyc2VkID0ga28udXRpbHMucGFyc2VKc29uKGpzb25TdHJpbmcpO1xuXHRhcmd1bWVudHNbMF0gPSBwYXJzZWQ7XG5cdHJldHVybiBleHBvcnRzLmZyb21KUy5hcHBseSh0aGlzLCBjb21wdXRlZEZ1bmN0aW9ucyk7XG4gICAgfTtcbiAgICBcbiAgICBleHBvcnRzLnRvSlMgPSBmdW5jdGlvbiAob2JzZXJ2YWJsZSkge1xuXHRyZXR1cm4gdW53cmFwKG9ic2VydmFibGUpO1xuICAgIH1cblxuICAgIGV4cG9ydHMudG9KU09OID0gZnVuY3Rpb24gKG9ic2VydmFibGUpIHtcblx0dmFyIHBsYWluSmF2YVNjcmlwdE9iamVjdCA9IGV4cG9ydHMudG9KUyhvYnNlcnZhYmxlKTtcblx0cmV0dXJuIGtvLnV0aWxzLnN0cmluZ2lmeUpzb24ocGxhaW5KYXZhU2NyaXB0T2JqZWN0KTtcbiAgICB9O1xuXG4gICAgZnVuY3Rpb24gdHlwZU9mKHZhbHVlKSB7XG5cdHZhciBzID0gdHlwZW9mIHZhbHVlO1xuXHRpZiAocyA9PT0gJ29iamVjdCcpIHtcbiAgICAgICAgICAgIGlmICh2YWx1ZSkge1xuICAgICAgICAgICAgICAgIGlmICh2YWx1ZS5jb25zdHJ1Y3RvciA9PSBEYXRlKVxuICAgICAgICAgICAgICAgICAgICBzID0gJ2RhdGUnO1xuXHRcdGVsc2UgaWYgKE9iamVjdC5wcm90b3R5cGUudG9TdHJpbmcuY2FsbCh2YWx1ZSkgPT0gJ1tvYmplY3QgQXJyYXldJylcbiAgICAgICAgICAgICAgICAgICAgcyA9ICdhcnJheSc7XG4gICAgICAgICAgICB9IGVsc2Uge1xuXHRcdHMgPSAnbnVsbCc7XG4gICAgICAgICAgICB9XG5cdH1cblx0cmV0dXJuIHM7XG4gICAgfVxuXG4gICAgLy8gdW53cmFwcGluZ1xuICAgIGZ1bmN0aW9uIHVud3JhcE9iamVjdChvKVxuICAgIHtcblx0dmFyIHQgPSB7fTtcblxuXHRmb3IgKHZhciBrIGluIG8pXG5cdHtcblx0ICAgIHZhciB2ID0gb1trXTtcblxuXHQgICAgaWYgKGtvLmlzQ29tcHV0ZWQodikpXG5cdFx0Y29udGludWU7XG5cblx0ICAgIHRba10gPSB1bndyYXAodik7XG5cdH1cblxuXHRyZXR1cm4gdDtcbiAgICB9XG5cbiAgICBmdW5jdGlvbiB1bndyYXBBcnJheShhKVxuICAgIHtcblx0dmFyIHIgPSBbXTtcblxuXHRpZiAoIWEgfHwgYS5sZW5ndGggPT0gMClcblx0ICAgIHJldHVybiByO1xuXHRcblx0Zm9yICh2YXIgaSA9IDAsIGwgPSBhLmxlbmd0aDsgaSA8IGw7ICsraSlcblx0ICAgIHIucHVzaCh1bndyYXAoYVtpXSkpO1xuXG5cdHJldHVybiByO1xuICAgIH1cblxuICAgIGZ1bmN0aW9uIHVud3JhcCh2KVxuICAgIHtcblx0dmFyIGlzT2JzZXJ2YWJsZSA9IGtvLmlzT2JzZXJ2YWJsZSh2KTtcblxuXHRpZiAoaXNPYnNlcnZhYmxlKVxuXHR7XG5cdCAgICB2YXIgdmFsID0gdigpO1xuXG5cdCAgICByZXR1cm4gdW53cmFwKHZhbCk7XG5cdH1cblx0ZWxzZVxuXHR7XG5cdCAgICBpZiAodHlwZU9mKHYpID09IFwiYXJyYXlcIilcblx0ICAgIHtcblx0XHRyZXR1cm4gdW53cmFwQXJyYXkodik7XG5cdCAgICB9XG5cdCAgICBlbHNlIGlmICh0eXBlT2YodikgPT0gXCJvYmplY3RcIilcblx0ICAgIHtcblx0XHRyZXR1cm4gdW53cmFwT2JqZWN0KHYpO1xuXHQgICAgfVxuXHQgICAgZWxzZVxuXHQgICAge1xuXHRcdHJldHVybiB2O1xuXHQgICAgfVxuXHR9XG4gICAgfVxuXG4gICAgZnVuY3Rpb24gcmVzZXQoKVxuICAgIHtcbiAgICAgICAgcGFyZW50cyA9IFt7b2JqOiBudWxsLCB3cmFwcGVkOiBudWxsLCBsdmw6IFwiXCJ9XTtcbiAgICB9ICAgIFxuICAgIFxuICAgIC8vIHdyYXBwaW5nXG5cbiAgICBmdW5jdGlvbiB3cmFwT2JqZWN0KG8sIGNvbXB1dGVkRnVuY3Rpb25zKVxuICAgIHtcbiAgICAgICAgLy8gY2hlY2sgZm9yIGluZmluaXRlIHJlY3Vyc2lvblxuICAgICAgICBmb3IgKHZhciBpID0gMDsgaSA8IHBhcmVudHMubGVuZ3RoOyArK2kpIHtcbiAgICAgICAgICAgIGlmIChwYXJlbnRzW2ldLm9iaiA9PT0gbykge1xuICAgICAgICAgICAgICAgIHJldHVybiBwYXJlbnRzW2ldLndyYXBwZWQ7XG4gICAgICAgICAgICB9XG4gICAgICAgIH1cblxuXHR2YXIgdCA9IHt9O1xuXG5cdGZvciAodmFyIGsgaW4gbylcblx0e1xuXHQgICAgdmFyIHYgPSBvW2tdO1xuXG4gICAgICAgICAgICBwYXJlbnRzLnB1c2goe29iajogbywgd3JhcHBlZDogdCwgbHZsOiBjdXJyZW50THZsKCkgKyBcIi9cIiArIGt9KTtcblxuXHQgICAgdFtrXSA9IHdyYXAodiwgY29tcHV0ZWRGdW5jdGlvbnMpO1xuXG4gICAgICAgICAgICBwYXJlbnRzLnBvcCgpO1xuXHR9XG5cblx0aWYgKGNvbXB1dGVkRnVuY3Rpb25zICYmIGNvbXB1dGVkRnVuY3Rpb25zW2N1cnJlbnRMdmwoKV0pXG5cdCAgICB0ID0gY29tcHV0ZWRGdW5jdGlvbnNbY3VycmVudEx2bCgpXSh0KTtcblxuICAgICAgICBpZiAoaGFzRVM1UGx1Z2luKCkpXG4gICAgICAgICAgICBrby50cmFjayh0KTtcblxuXHRyZXR1cm4gdDtcbiAgICB9XG5cbiAgICBmdW5jdGlvbiB3cmFwQXJyYXkoYSwgY29tcHV0ZWRGdW5jdGlvbnMpXG4gICAge1xuXHR2YXIgciA9IGtvLm9ic2VydmFibGVBcnJheSgpO1xuXG5cdGlmICghYSB8fCBhLmxlbmd0aCA9PSAwKVxuXHQgICAgcmV0dXJuIHI7XG5cblx0Zm9yICh2YXIgaSA9IDAsIGwgPSBhLmxlbmd0aDsgaSA8IGw7ICsraSlcblx0ICAgIHIucHVzaCh3cmFwKGFbaV0sIGNvbXB1dGVkRnVuY3Rpb25zKSk7XG5cblx0cmV0dXJuIHI7XG4gICAgfVxuXG4gICAgLy8gYSBzdGFjaywgdXNlZCBmb3IgdHdvIHB1cnBvc2VzOlxuICAgIC8vICAtIGNpcmN1bGFyIHJlZmVyZW5jZSBjaGVja2luZ1xuICAgIC8vICAtIGNvbXB1dGVkIGZ1bmN0aW9uc1xuICAgIHZhciBwYXJlbnRzO1xuXG4gICAgZnVuY3Rpb24gY3VycmVudEx2bCgpXG4gICAge1xuXHRyZXR1cm4gcGFyZW50c1twYXJlbnRzLmxlbmd0aC0xXS5sdmw7XG4gICAgfVxuXG4gICAgZnVuY3Rpb24gd3JhcCh2LCBjb21wdXRlZEZ1bmN0aW9ucylcbiAgICB7XG5cdGlmICh0eXBlT2YodikgPT0gXCJhcnJheVwiKVxuXHR7XG5cdCAgICByZXR1cm4gd3JhcEFycmF5KHYsIGNvbXB1dGVkRnVuY3Rpb25zKTtcblx0fVxuXHRlbHNlIGlmICh0eXBlT2YodikgPT0gXCJvYmplY3RcIilcblx0e1xuXHQgICAgcmV0dXJuIHdyYXBPYmplY3QodiwgY29tcHV0ZWRGdW5jdGlvbnMpO1xuXHR9XG5cdGVsc2Vcblx0e1xuICAgICAgICAgICAgaWYgKCFoYXNFUzVQbHVnaW4oKSAmJiB0eXBlb2YgdiAhPT0gJ2Z1bmN0aW9uJylcbiAgICAgICAgICAgIHtcblx0ICAgICAgICB2YXIgdCA9IGtvLm9ic2VydmFibGUoKTtcblx0ICAgICAgICB0KHYpO1xuXHQgICAgICAgIHJldHVybiB0O1xuICAgICAgICAgICAgfSBlbHNlXG4gICAgICAgICAgICAgICAgcmV0dXJuIHY7XG5cdH1cbiAgICB9XG5cbiAgICBmdW5jdGlvbiBoYXNFUzVQbHVnaW4oKVxuICAgIHtcbiAgICAgICAgcmV0dXJuIGtvLnRyYWNrICE9IG51bGw7XG4gICAgfVxufSkpOyIsInZhciAkID0gKHR5cGVvZiB3aW5kb3cgIT09IFwidW5kZWZpbmVkXCIgPyB3aW5kb3dbJyQnXSA6IHR5cGVvZiBnbG9iYWwgIT09IFwidW5kZWZpbmVkXCIgPyBnbG9iYWxbJyQnXSA6IG51bGwpO1xudmFyIEhFUk9DQUxDVUxBVE9SID0gcmVxdWlyZSgnLi9hcHAvbWFpbicpO1xuaGMgPSBuZXcgSEVST0NBTENVTEFUT1IoKTtcbnZhciBsYXN0VXBkYXRlID0gXCIjREVWX0JVSUxEXCI7XG4kKCcjbGFzdC11cGRhdGUnKS50ZXh0KGxhc3RVcGRhdGUpO1xuaGMuaW5pdChcIi9tZWRpYS9qcy9oZXJvZGF0YS5qc29uXCIsXCIvbWVkaWEvanMvaXRlbWRhdGEuanNvblwiLFwiL21lZGlhL2pzL3VuaXRkYXRhLmpzb25cIiwgaGMucnVuKTsiXX0=
