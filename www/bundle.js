(function(f){if(typeof exports==="object"&&typeof module!=="undefined"){module.exports=f()}else if(typeof define==="function"&&define.amd){define([],f)}else{var g;if(typeof window!=="undefined"){g=window}else if(typeof global!=="undefined"){g=global}else if(typeof self!=="undefined"){g=self}else{g=this}g.DotaHeroCalculator = f()}})(function(){var define,module,exports;return (function e(t,n,r){function s(o,u){if(!n[o]){if(!t[o]){var a=typeof require=="function"&&require;if(!u&&a)return a(o,!0);if(i)return i(o,!0);var f=new Error("Cannot find module '"+o+"'");throw f.code="MODULE_NOT_FOUND",f}var l=n[o]={exports:{}};t[o][0].call(l.exports,function(e){var n=t[o][1][e];return s(n?n:e)},l,l.exports,e,t,n,r)}return n[o].exports}var i=typeof require=="function"&&require;for(var o=0;o<r.length;o++)s(r[o]);return s})({1:[function(require,module,exports){
'use strict';
var ko = require('./herocalc_knockout');
var abilityData = require("./herocalc_abilitydata");

var AbilityModel = function (a, h) {
    var self = this;
    self.hero = h;
    self.abilityData = abilityData;
    self.hasScepter = ko.observable(false);
    self.isShapeShiftActive = ko.observable(false);
    self.abilities = a;
    self._abilities = self.abilities();
    for (var i = 0; i < self.abilities().length; i++) {
        self._abilities[i].level = ko.observable(0);
        self._abilities[i].isActive = ko.observable(false);
        self._abilities[i].isDetail = ko.observable(false);
        self._abilities[i].baseDamage = ko.observable(0);
        self._abilities[i].baseDamageReductionPct = ko.observable(0);
        self._abilities[i].baseDamageMultiplier = ko.observable(0);
        self._abilities[i].bash = ko.observable(0);
        self._abilities[i].bashBonusDamage = ko.observable(0);
        self._abilities[i].bonusDamage = ko.observable(0);
        self._abilities[i].bonusDamageOrb = ko.observable(0);
        self._abilities[i].bonusDamagePct = ko.observable(0);
        self._abilities[i].bonusDamagePrecisionAura = ko.observable(0);
        self._abilities[i].bonusDamageReduction = ko.observable(0);
        self._abilities[i].bonusHealth = ko.observable(0);
        self._abilities[i].bonusStrength = ko.observable(0);
        self._abilities[i].bonusStrength2 = ko.observable(0);
        self._abilities[i].bonusAgility = ko.observable(0);
        self._abilities[i].bonusAgility2 = ko.observable(0);
        self._abilities[i].bonusInt = ko.observable(0);
        self._abilities[i].bonusAllStatsReduction = ko.observable(0);
        self._abilities[i].damageAmplification = ko.observable(0);
        self._abilities[i].damageReduction = ko.observable(0);
        self._abilities[i].evasion = ko.observable(0);
        self._abilities[i].magicResist = ko.observable(0);
        self._abilities[i].manaregen = ko.observable(0);
        self._abilities[i].manaregenreduction = ko.observable(0);
        self._abilities[i].missChance = ko.observable(0);
        self._abilities[i].movementSpeedFlat = ko.observable(0);
        self._abilities[i].movementSpeedPct = ko.observable(0);
        self._abilities[i].movementSpeedPctReduction = ko.observable(0);
        self._abilities[i].turnRateReduction = ko.observable(0);
        self._abilities[i].attackrange = ko.observable(0);
        self._abilities[i].attackspeed = ko.observable(0);
        self._abilities[i].attackspeedreduction = ko.observable(0);
        self._abilities[i].armor = ko.observable(0);
        self._abilities[i].armorReduction = ko.observable(0);
        self._abilities[i].healthregen = ko.observable(0);
        self._abilities[i].lifesteal = ko.observable(0);
        self._abilities[i].visionnight = ko.observable(0);
        self._abilities[i].visionday = ko.observable(0);
    }
    self.abilityControlData = {};
    self.abilitySettingsData = function (data, parent, index) {
        if (self.abilityControlData[data] == undefined) {
            return self.processAbility(data, parent, index, self.abilityData[data]);
        }
        else {
            return self.abilityControlData[data];
        }
    }
    
    self.processAbility = function (data, parent, index, args) {
        var result = {};
        result.data = [];
        var v;
        var v_list = [];
        for (var i=0; i < args.length; i++) {
            switch (args[i].controlType) {
                case 'input':
                    v = ko.observable(0).extend({ numeric: 2 });
                    v.controlValueType = args[i].controlValueType;
                    v_list.push(v);
                    result.data.push({ labelName: args[i].label.toUpperCase() + ':', controlVal: v, controlType: args[i].controlType, display: args[i].display });
                break;
                case 'checkbox':
                    v = ko.observable(false);
                    v.controlValueType = args[i].controlValueType;
                    v_list.push(v);
                    result.data.push({ labelName: args[i].label.toUpperCase() + '?', controlVal: v, controlType: args[i].controlType, display: args[i].display });
                break;
                case 'radio':
                    v = ko.observable(args[i].controlOptions[0].value);
                    v.controlValueType = args[i].controlValueType;
                    v_list.push(v);
                    result.data.push({ labelName: args[i].label.toUpperCase() + '?', controlVal: v, controlType: args[i].controlType, display: args[i].display, controlOptions: args[i].controlOptions });
                break;
                case 'method':
                case 'text':
                    // single input abilities
                    if (args[i].controls == undefined) {
                        if (args[i].noLevel) {
                            var attributeValue = function (attributeName) {
                                return {fn: ko.computed(function () {
                                    var _ability = self.abilities().find(function(b) {
                                        return b.name == data;
                                    });
                                    return self.getAbilityAttributeValue(_ability.attributes, attributeName, 0);
                                })};
                            };
                        }
                        else {
                            var attributeValue = function (attributeName) {
                                return {fn: ko.computed(function () {
                                    var _ability = self.abilities().find(function(b) {
                                        return b.name == data;
                                    });
                                    return self.getAbilityAttributeValue(_ability.attributes, attributeName, _ability.level());
                                })};
                            };
                        }
                        var g = attributeValue(args[i].attributeName)
                        var r = self.getComputedFunction(v, g.fn, args[i].fn, parent, index, self, args[i].returnProperty, undefined, data);
                        if (args[i].ignoreTooltip) {
                            var tooltip = args[i].label || args[i].attributeName;
                        }
                        else {
                            var tooltip = self.getAbilityAttributeTooltip(self.abilities()[index].attributes, args[i].attributeName) || args[i].label || args[i].attributeName;
                        }
                        result.data.push({ labelName: tooltip.toUpperCase(), controlVal: r, controlType: args[i].controlType, display: args[i].display, clean: g.fn });
                    }
                    // multi input abilities
                    else {
                        if (args[i].noLevel) {
                            var attributeValue = function (attributeName) {
                                return {fn: ko.computed(function () {
                                    return self.getAbilityAttributeValue(self.abilities()[index].attributes, attributeName, 0);
                                })};
                            };
                        }
                        else {
                            var attributeValue = function (attributeName) {
                                return {fn: ko.computed(function () {
                                    return self.getAbilityAttributeValue(self.abilities()[index].attributes, attributeName, self.abilities()[index].level());
                                })};
                            };
                        }
                        var g = attributeValue(args[i].attributeName)
                        var r = self.getComputedFunction(v_list, g.fn, args[i].fn, parent, index, self, args[i].returnProperty, args[i].controls, data);
                        if (args[i].ignoreTooltip) {
                            var tooltip = args[i].label || args[i].attributeName;
                        }
                        else {
                            var tooltip = self.getAbilityAttributeTooltip(self.abilities()[index].attributes, args[i].attributeName) || args[i].label || args[i].attributeName;
                        }
                        result.data.push({ labelName: tooltip.toUpperCase(), controlVal: r, controlType: args[i].controlType, display: args[i].display, clean: g.fn });
                    }
                    
                    if (args[i].controlType == 'method') {
                        v_list.push(r);
                    }
                break;
            }
        }
        self.abilityControlData[data] = result;
        return result;
    }

    self.getComputedFunction = function (v, attributeValue, fn, parent, index, abilityModel, returnProperty, controls, abilityName) {
        var _ability = abilityModel.abilities().find(function(b) {
            return b.name == abilityName;
        });
        return ko.pureComputed(function () {                
            var inputValue;
            if (controls == undefined) {
                if (v == undefined) {
                    inputValue = v;
                }
                else if (typeof v() == 'boolean') {
                    inputValue = v();
                }
                else if (v.controlValueType == undefined) {
                    inputValue = parseFloat(v());
                }
                else if (v.controlValueType == 'string') {
                    inputValue = v();
                }
                else {
                    inputValue = parseFloat(v());
                }
            }
            else {
                var v_list = [];
                for (var i=0;i<controls.length;i++) {
                    switch (typeof v[controls[i]]()) {
                        case 'boolean':
                        case 'object':
                            v_list.push(v[controls[i]]());
                        break;
                        default:
                            v_list.push(parseFloat(v[controls[i]]()));
                        break;
                    }
                }
                inputValue = v_list;
            }
            
            var returnVal = fn.call(this, inputValue, attributeValue(), parent, index, abilityModel, _ability);
            if (returnProperty != undefined) {
                _ability[returnProperty](returnVal);
            }
            return returnVal;
        }, this);
    }
    
    self.getAbilityLevelByAbilityName = function (abilityName) {
        for (var i = 0; i < self.abilities().length; i++) {
            if (self._abilities[i].name == abilityName) {
                return self._abilities[i].level();
            }
        }
        return -1;
    }

    self.getAbilityByName = function (abilityName) {
        for (var i = 0; i < self.abilities().length; i++) {
            if (self._abilities[i].name == abilityName) {
                return self._abilities[i];
            }
        }
        return undefined;
    }

    self.getAbilityPropertyValue = function (ability, property) {
        return parseFloat(ability[property]()[ability.level()-1]);
    }
    
    self.getAttributeBonusLevel = function () {
        for (var i = 0; i < self.abilities().length; i++) {
            if (self._abilities[i].name == 'attribute_bonus') {
                return self._abilities[i].level();
            }
        }
        return 0;        
    }
    
    self.getAllStatsReduction = ko.computed(function () {
        var totalAttribute = 0;
        for (var i = 0; i < self.abilities().length; i++) {
            var ability = self._abilities[i];
            if (ability.level() > 0 && (ability.isActive() || (ability.behavior.indexOf('DOTA_ABILITY_BEHAVIOR_PASSIVE') != -1))) {
                if (!(ability.name in self.abilityData)) {                    
                    for (var j = 0; j < self._abilities[i].attributes.length; j++) {
                        var attribute = self._abilities[i].attributes[j];
                        /*switch(attribute.name) {
                            // invoker_quas
                            case 'bonus_strength':
                                totalAttribute += parseInt(attribute.value[ability.level()-1]);
                            break;
                        }*/
                    }
                }
                else if (ability.bonusAllStatsReduction != undefined) {
                    // slark_essence_shift
                    totalAttribute+=ability.bonusAllStatsReduction();
                }
            }
        }
        return totalAttribute;
    });
    
    self.getStrengthReduction = ko.computed(function () {
        var totalAttribute = 0;
        for (var i = 0; i < self.abilities().length; i++) {
            var ability = self._abilities[i];
            if (ability.level() > 0 && (ability.isActive() || (ability.behavior.indexOf('DOTA_ABILITY_BEHAVIOR_PASSIVE') != -1))) {
                if (!(ability.name in self.abilityData)) {                    
                    for (var j = 0; j < self._abilities[i].attributes.length; j++) {
                        var attribute = self._abilities[i].attributes[j];
                        /*switch(attribute.name) {
                            // invoker_quas
                            case 'bonus_strength':
                                totalAttribute += parseInt(attribute.value[ability.level()-1]);
                            break;
                        }*/
                    }
                }
                else if (ability.bonusStrength != undefined && ability.name == 'undying_decay') {
                    // undying_decay
                    totalAttribute-=ability.bonusStrength();
                }
            }
        }
        return totalAttribute;
    });
    
    self.getStrength = ko.computed(function () {
        var totalAttribute = 0;
        for (var i = 0; i < self.abilities().length; i++) {
            var ability = self._abilities[i];
            if (ability.level() > 0) {
                if (!(ability.name in self.abilityData)) {
                    if (ability.isActive() || (ability.behavior.indexOf('DOTA_ABILITY_BEHAVIOR_PASSIVE') != -1)) {
                        for (var j = 0; j < self._abilities[i].attributes.length; j++) {
                            var attribute = self._abilities[i].attributes[j];
                            /*switch(attribute.name) {
                                // invoker_quas
                                case 'bonus_strength':
                                    totalAttribute += parseInt(attribute.value[ability.level()-1]);
                                break;
                            }*/
                        }
                    }
                }
                else {
                    if (ability.bonusStrength != undefined) {
                        if (ability.isActive() || (ability.behavior.indexOf('DOTA_ABILITY_BEHAVIOR_PASSIVE') != -1)) {
                            // pudge_flesh_heap,morphling_morph_str,morphling_morph_agi,undying_decay
                            totalAttribute+=ability.bonusStrength();
                        }
                    }
                    if (ability.bonusStrength2 != undefined) {
                        if (ability.isActive() || (ability.behavior.indexOf('DOTA_ABILITY_BEHAVIOR_PASSIVE') != -1)) {
                            // morphling_morph_str
                            totalAttribute+=ability.bonusStrength2();
                        }
                    }
                }
            }
        }
        return totalAttribute;
    });
    
    self.getAgility = ko.computed(function () {
        var totalAttribute = 0;
        for (var i = 0; i < self.abilities().length; i++) {
            var ability = self._abilities[i];
            if (ability.level() > 0) {
                if (!(ability.name in self.abilityData)) {
                    if (ability.isActive() || (ability.behavior.indexOf('DOTA_ABILITY_BEHAVIOR_PASSIVE') != -1)) {
                        for (var j = 0; j < self._abilities[i].attributes.length; j++) {
                            var attribute = self._abilities[i].attributes[j];
                            switch(attribute.name) {
                                // drow_ranger_marksmanship
                                case 'marksmanship_agility_bonus':
                                    totalAttribute += self.getAbilityAttributeValue(self._abilities[i].attributes, attribute.name, ability.level());
                                break;
                            }
                        }
                    }
                }
                else {
                    if (ability.bonusAgility != undefined) {
                        if (ability.isActive() || (ability.behavior.indexOf('DOTA_ABILITY_BEHAVIOR_PASSIVE') != -1)) {
                            // morphling_morph_agi,morphling_morph_str
                            totalAttribute+=ability.bonusAgility();
                        }
                    }
                    if (ability.bonusAgility2 != undefined) {
                        if (ability.isActive() || (ability.behavior.indexOf('DOTA_ABILITY_BEHAVIOR_PASSIVE') != -1)) {
                            // morphling_morph_agi,morphling_morph_str
                            totalAttribute+=ability.bonusAgility2();
                        }
                    }
                }
            }
        }
        return totalAttribute;
    });

    self.getIntelligence = ko.computed(function () {
        var totalAttribute = 0;
        for (var i = 0; i < self.abilities().length; i++) {
            var ability = self._abilities[i];
            if (ability.level() > 0) {
                if (!(ability.name in self.abilityData)) {
                    if (ability.isActive() || (ability.behavior.indexOf('DOTA_ABILITY_BEHAVIOR_PASSIVE') != -1)) {
                        for (var j = 0; j < self._abilities[i].attributes.length; j++) {
                            var attribute = self._abilities[i].attributes[j];
                            switch(attribute.name) {
                                // invoker_exort
                            /*    case 'bonus_intelligence':
                                    totalAttribute += self.getAbilityAttributeValue(self._abilities[i].attributes, attribute.name, ability.level());
                                break;*/
                            }
                        }
                    }
                }
                /*else if (ability.bonusInt != undefined) {
                    if (ability.isActive() || (ability.behavior.indexOf('DOTA_ABILITY_BEHAVIOR_PASSIVE') != -1) || ability.name == 'invoker_exort') {
                        // invoker_exort
                        totalAttribute+=ability.bonusInt();
                    }
                }*/
            }
        }
        return totalAttribute;
    });
    
    self.getArmor = ko.computed(function () {
        var totalAttribute = 0;
        for (var i = 0; i < self.abilities().length; i++) {
            var ability = self._abilities[i];
            if (ability.level() > 0 && (ability.isActive() || (ability.behavior.indexOf('DOTA_ABILITY_BEHAVIOR_PASSIVE') != -1))) {
                if (!(ability.name in self.abilityData)) {
                    for (var j = 0; j < self._abilities[i].attributes.length; j++) {
                        var attribute = self._abilities[i].attributes[j];
                        switch(attribute.name) {
                            // axe_berserkers_call,dragon_knight_dragon_blood,troll_warlord_berserkers_rage,lycan_shapeshift,enraged_wildkin_toughness_aura
                            case 'bonus_armor':
                                if (ability.name != 'templar_assassin_meld') {
                                    totalAttribute += self.getAbilityAttributeValue(self._abilities[i].attributes, attribute.name, ability.level());
                                }
                            break;
                            // sven_warcry
                            case 'warcry_armor':
                                totalAttribute += self.getAbilityAttributeValue(self._abilities[i].attributes, attribute.name, ability.level());
                            break;
                            // lich_frost_armor,ogre_magi_frost_armor
                            case 'armor_bonus':
                                if (ability.name == 'lich_frost_armor' || ability.name == 'ogre_magi_frost_armor') {
                                    totalAttribute += self.getAbilityAttributeValue(self._abilities[i].attributes, attribute.name, ability.level());
                                }
                            break;
                        }
                    }
                }
                else if (ability.armor != undefined) {
                    // shredder_reactive_armor,visage_gravekeepers_cloak
                    totalAttribute+=ability.armor();
                }
            }
        }
        return totalAttribute;
    });

    self.getArmorBaseReduction = ko.computed(function () {
        var totalAttribute = 1;
        for (var i = 0; i < self.abilities().length; i++) {
            var ability = self._abilities[i];
            if (ability.level() > 0 && (ability.isActive() || (ability.behavior.indexOf('DOTA_ABILITY_BEHAVIOR_PASSIVE') != -1))) {
                //if (!(ability.name in self.abilityData)) {
                    switch(ability.name) {
                        //elder_titan_natural_order
                        case 'elder_titan_natural_order':
                            totalAttribute *= (1-self.getAbilityAttributeValue(self._abilities[i].attributes, 'armor_reduction_pct', ability.level())/100);
                        break;
                    }
                //}
            }
        }
        return totalAttribute;
    });
    
    self.getArmorReduction = ko.computed(function () {
        var totalAttribute = 0;
        for (var i = 0; i < self.abilities().length; i++) {
            var ability = self._abilities[i];
            if (ability.level() > 0 && (ability.isActive() || (ability.behavior.indexOf('DOTA_ABILITY_BEHAVIOR_PASSIVE') != -1))) {
                if (!(ability.name in self.abilityData)) {
                    switch(ability.name) {
                        //templar_assassin_meld
                        case 'templar_assassin_meld':
                            totalAttribute += self.getAbilityAttributeValue(self._abilities[i].attributes, 'bonus_armor', ability.level());
                        break;
                        // tidehunter_gush
                        case 'tidehunter_gush':
                            totalAttribute += self.getAbilityAttributeValue(self._abilities[i].attributes, 'armor_bonus', ability.level());
                        break;
                        // naga_siren_rip_tide
                        case 'naga_siren_rip_tide':
                        // slardar_amplify_damage
                        case 'slardar_amplify_damage':
                        // vengefulspirit_wave_of_terror
                        case 'vengefulspirit_wave_of_terror':
                            totalAttribute += self.getAbilityAttributeValue(self._abilities[i].attributes, 'armor_reduction', ability.level());
                        break;
                        // nevermore_dark_lord
                        case 'nevermore_dark_lord':
                            totalAttribute += self.getAbilityAttributeValue(self._abilities[i].attributes, 'presence_armor_reduction', ability.level());
                        break;
                    }
                }
                else if (ability.armorReduction != undefined) {
                    // alchemist_acid_spray
                    totalAttribute+=ability.armorReduction();
                }
            }
        }
        return totalAttribute;
    });

    self.getHealth = ko.computed(function () {
        var totalAttribute = 0;
        for (var i = 0; i < self.abilities().length; i++) {
            var ability = self._abilities[i];
            if (ability.level() > 0 && (ability.isActive() || (ability.behavior.indexOf('DOTA_ABILITY_BEHAVIOR_PASSIVE') != -1))) {
                if (!(ability.name in self.abilityData)) {
                    for (var j = 0; j < self._abilities[i].attributes.length; j++) {
                        var attribute = self._abilities[i].attributes[j];
                        switch(attribute.name) {
                            // lone_druid_true_form,lycan_shapeshift,troll_warlord_berserkers_rage
                            case 'bonus_hp':
                                totalAttribute += self.getAbilityAttributeValue(self._abilities[i].attributes, attribute.name, ability.level());
                            break;
                            // lone_druid_synergy
                            case 'true_form_hp_bonus':
                                if (self.isTrueFormActive()) {
                                    totalAttribute += self.getAbilityAttributeValue(self._abilities[i].attributes, attribute.name, ability.level());
                                }
                            break;
                        }
                    }
                }
                else if (ability.bonusHealth != undefined) {
                    // clinkz_death_pact
                    totalAttribute+=ability.bonusHealth();
                }
            }
        }
        return totalAttribute;
    });
    
    self.isTrueFormActive = function () {
        for (var i = 0; i < self.abilities().length; i++) {
            var ability = self._abilities[i];
            if (ability.isActive() && ability.name == 'lone_druid_true_form') {
                return true;
            }
        }
        return false;
    }

    self.getHealthRegen = ko.computed(function () {
        var totalAttribute = 0;
        for (var i = 0; i < self.abilities().length; i++) {
            var ability = self._abilities[i];
            if (ability.level() > 0 && (ability.isActive() || (ability.behavior.indexOf('DOTA_ABILITY_BEHAVIOR_PASSIVE') != -1))) {
                if (!(ability.name in self.abilityData)) {
                    for (var j = 0; j < self._abilities[i].attributes.length; j++) {
                        var attribute = self._abilities[i].attributes[j];
                        switch(attribute.name) {
                            // alchemist_chemical_rage, dragon_knight_dragon_blood
                            case 'bonus_health_regen':
                            // broodmother_spin_web
                            case 'heath_regen':
                            // omniknight_guardian_angel,treant_living_armor,satyr_hellcaller_unholy_aura
                            case 'health_regen':
                                totalAttribute += self.getAbilityAttributeValue(self._abilities[i].attributes, attribute.name, ability.level());
                            break;
                            // legion_commander_press_the_attack
                            case 'hp_regen':
                                totalAttribute += self.getAbilityAttributeValue(self._abilities[i].attributes, attribute.name, ability.level());
                            break;
                        }
                    }
                }
                else if (ability.healthregen != undefined) {
                    // shredder_reactive_armor,invoker_quas,necrolyte_sadist
                    totalAttribute+=ability.healthregen();
                }
            }
        }
        return totalAttribute;
    });

    self.getMana = ko.computed(function () {
        var totalAttribute = 0;
        for (var i = 0; i < self.abilities().length; i++) {
            var ability = self._abilities[i];
            if (ability.level() > 0 && (ability.isActive() || (ability.behavior.indexOf('DOTA_ABILITY_BEHAVIOR_PASSIVE') != -1))) {
                //if (!(ability.name in self.abilityData)) {
                    for (var j = 0; j < self._abilities[i].attributes.length; j++) {
                        var attribute = self._abilities[i].attributes[j];
                        switch(attribute.name) {
                            // obsidian_destroyer_essence_aura
                            case 'bonus_mana':
                                totalAttribute += self.getAbilityAttributeValue(self._abilities[i].attributes, attribute.name, ability.level());
                            break;
                        }
                    }
                //}
            }
        }
        return totalAttribute;
    });
    
    self.getManaRegen = ko.computed(function () {
        var totalAttribute = 0;
        for (var i = 0; i < self.abilities().length; i++) {
            var ability = self._abilities[i];
            if (ability.level() > 0 && (ability.isActive() || (ability.behavior.indexOf('DOTA_ABILITY_BEHAVIOR_PASSIVE') != -1))) {
                if (!(ability.name in self.abilityData)) {
                    for (var j = 0; j < self._abilities[i].attributes.length; j++) {
                        var attribute = self._abilities[i].attributes[j];
                        switch(attribute.name) {
                            // alchemist_chemical_rage
                            case 'bonus_mana_regen':
                                totalAttribute += self.getAbilityAttributeValue(self._abilities[i].attributes, attribute.name, ability.level());
                            break;
                        }
                    }
                }
                else if (ability.manaregen != undefined) {
                    // necrolyte_sadist
                    totalAttribute+=ability.manaregen();
                }
            }
        }
        return totalAttribute;
    });
    
    self.getManaRegenArcaneAura = ko.computed(function () {
        var totalAttribute = 0;
        for (var i = 0; i < self.abilities().length; i++) {
            var ability = self._abilities[i];
            if (ability.level() > 0 && (ability.isActive() || (ability.behavior.indexOf('DOTA_ABILITY_BEHAVIOR_PASSIVE') != -1))) {
                //if (!(ability.name in self.abilityData)) {
                    for (var j = 0; j < self._abilities[i].attributes.length; j++) {
                        var attribute = self._abilities[i].attributes[j];
                        switch(attribute.name) {
                            // crystal_maiden_brilliance_aura
                            case 'mana_regen':
                                if (ability.name == 'crystal_maiden_brilliance_aura') {
                                    totalAttribute += self.getAbilityAttributeValue(self._abilities[i].attributes, attribute.name, ability.level());
                                }
                            break;
                        }
                    }
                //}
            }
        }
        return totalAttribute;
    });

    self.getManaRegenReduction = ko.computed(function () {
        var totalAttribute = 0;
        for (var i = 0; i < self.abilities().length; i++) {
            var ability = self._abilities[i];
            if (ability.level() > 0 && (ability.isActive() || (ability.behavior.indexOf('DOTA_ABILITY_BEHAVIOR_PASSIVE') != -1))) {
                /*if (!(ability.name in self.abilityData)) {
                    for (var j = 0; j < self._abilities[i].attributes.length; j++) {
                        var attribute = self._abilities[i].attributes[j];
                        //switch(attribute.name) {
                        //    // 
                        //    case '':
                        //        totalAttribute += parseInt(attribute.value[ability.level()-1]);
                        //    break;
                        //}
                    }
                }
                else*/ if (ability.manaregenreduction != undefined) {
                    // pugna_nether_ward
                    totalAttribute+=ability.manaregenreduction();
                }
            }
        }
        return totalAttribute;
    });
    
    self.getAttackRange = ko.computed(function () {
        var totalAttribute = 0;
        for (var i = 0; i < self.abilities().length; i++) {
            var ability = self._abilities[i];
            if (ability.level() > 0) {
                if (!(ability.name in self.abilityData)) {
                    if (ability.isActive() || (ability.behavior.indexOf('DOTA_ABILITY_BEHAVIOR_PASSIVE') != -1)) {
                        for (var j = 0; j < self._abilities[i].attributes.length; j++) {
                            var attribute = self._abilities[i].attributes[j];
                            switch(attribute.name) {
                                // winter_wyvern_arctic_burn
                                case 'attack_range_bonus':
                                // templar_assassin_psi_blades,sniper_take_aim
                                case 'bonus_attack_range':
                                    totalAttribute += self.getAbilityAttributeValue(self._abilities[i].attributes, attribute.name, ability.level());
                                break;
                                // terrorblade_metamorphosis,troll_warlord_berserkers_rage
                                case 'bonus_range':
                                    if (ability.name == 'terrorblade_metamorphosis') {
                                        totalAttribute += self.getAbilityAttributeValue(self._abilities[i].attributes, attribute.name, ability.level());
                                    }
                                    if (ability.name == 'troll_warlord_berserkers_rage') {
                                        totalAttribute -= self.getAbilityAttributeValue(self._abilities[i].attributes, attribute.name, ability.level());
                                    }
                                break;
                                // tiny_grow
                                case 'bonus_range_scepter':
                                    if (ability.name == 'tiny_grow' && self.hasScepter()) {
                                        totalAttribute += self.getAbilityAttributeValue(self._abilities[i].attributes, attribute.name, ability.level());
                                    }
                                break;
                                // enchantress_impetus
                                case 'bonus_attack_range_scepter':
                                    if (ability.name == 'enchantress_impetus' && self.hasScepter()) {
                                        totalAttribute += self.getAbilityAttributeValue(self._abilities[i].attributes, attribute.name, ability.level());
                                    }
                                break;
                            }
                        }
                        // lone_druid_true_form
                        if (ability.name == 'lone_druid_true_form') {
                            totalAttribute -= 422;
                        }
                    }
                    else if (ability.name == 'enchantress_impetus' && self.hasScepter()) {
                        for (var j = 0; j < self._abilities[i].attributes.length; j++) {
                            var attribute = self._abilities[i].attributes[j];
                            switch(attribute.name) {
                              case 'bonus_attack_range_scepter':
                                totalAttribute += self.getAbilityAttributeValue(self._abilities[i].attributes, attribute.name, ability.level());
                              break;
                            }
                        }
                    }
                }
                else if (ability.attackrange != undefined) {
                    if (ability.isActive() || (ability.behavior.indexOf('DOTA_ABILITY_BEHAVIOR_PASSIVE') != -1)) {
                        // dragon_knight_elder_dragon_form
                        totalAttribute+=ability.attackrange();
                    }
                }
            }
        }
        return totalAttribute;
    });
    
    self.getAttackSpeed = ko.computed(function () {
        var totalAttribute = 0;
        for (var i = 0; i < self.abilities().length; i++) {
            var ability = self._abilities[i];
            if (ability.level() > 0 && (ability.isActive() || (ability.behavior.indexOf('DOTA_ABILITY_BEHAVIOR_PASSIVE') != -1))) {
                if (!(ability.name in self.abilityData)) {
                    for (var j = 0; j < self._abilities[i].attributes.length; j++) {
                        var attribute = self._abilities[i].attributes[j];
                        switch(attribute.name) {
                            // abaddon_frostmourne,troll_warlord_battle_trance
                            case 'attack_speed':
                            // visage_grave_chill
                            case 'attackspeed_bonus':
                            // mirana_leap
                            case 'leap_speedbonus_as':
                            // life_stealer
                            case 'attack_speed_bonus':
                                totalAttribute += self.getAbilityAttributeValue(self._abilities[i].attributes, attribute.name, ability.level());
                            break;
                            // clinkz_strafe,ursa_overpower
                            case 'attack_speed_bonus_pct':
                                if (ability.name == 'clinkz_strafe' || ability.name == 'ursa_overpower') {
                                    totalAttribute += self.getAbilityAttributeValue(self._abilities[i].attributes, attribute.name, ability.level());
                                }
                            break;
                            // axe_culling_blade,necronomicon_archer_aoe
                            case 'speed_bonus':
                                if (ability.name == 'axe_culling_blade' || ability.name == 'necronomicon_archer_aoe') {
                                    totalAttribute += self.getAbilityAttributeValue(self._abilities[i].attributes, attribute.name, ability.level());
                                }
                            break;
                            // ancient_apparition_chilling_touch
                            case 'attack_speed_pct':
                                if (ability.name == 'ancient_apparition_chilling_touch') {
                                    totalAttribute += self.getAbilityAttributeValue(self._abilities[i].attributes, attribute.name, ability.level());
                                }
                            break;
                            // beastmaster_inner_beast,lycan_feral_impulse,lone_druid_rabid,tiny_grow,phantom_assassin_phantom_strike,windrunner_focusfire,ogre_magi_bloodlust,centaur_khan_endurance_aura
                            case 'bonus_attack_speed':
                                if (ability.name == 'beastmaster_inner_beast' 
                                 || ability.name == 'lycan_feral_impulse' 
                                 || ability.name == 'lone_druid_rabid' 
                                 || ability.name == 'tiny_grow' 
                                 || ability.name == 'phantom_assassin_phantom_strike' 
                                 || ability.name == 'windrunner_focusfire' 
                                 || ability.name == 'ogre_magi_bloodlust'
                                 || ability.name == 'centaur_khan_endurance_aura') {
                                    totalAttribute += self.getAbilityAttributeValue(self._abilities[i].attributes, attribute.name, ability.level());
                                }
                            break;
                        }
                    }
                }
                else if (ability.attackspeed != undefined) {
                    // troll_warlord_fervor,wisp_overcharge,lina_fiery_soul,invoker_alacrity,invoker_wex,huskar_berserkers_blood
                    totalAttribute+=ability.attackspeed();
                }
            }
        }
        return totalAttribute;
    });

    self.getAttackSpeedReduction = ko.computed(function () {
        var totalAttribute = 0;
        for (var i = 0; i < self.abilities().length; i++) {
            var ability = self._abilities[i];
            if (ability.level() > 0 && (ability.isActive() || (ability.behavior.indexOf('DOTA_ABILITY_BEHAVIOR_PASSIVE') != -1))) {
                if (!(ability.name in self.abilityData)) {
                    for (var j = 0; j < self._abilities[i].attributes.length; j++) {
                        var attribute = self._abilities[i].attributes[j];
                        switch(attribute.name) {
                            // night_stalker_void,crystal_maiden_crystal_nova,ghost_frost_attack,ogre_magi_frost_armor,polar_furbolg_ursa_warrior_thunder_clap
                            case 'attackspeed_slow':
                            // lich_frost_armor,lich_frost_nova,enchantress_untouchable
                            case 'slow_attack_speed':
                            // beastmaster_primal_roar
                            case 'slow_attack_speed_pct':
                            // storm_spirit_overload
                            case 'overload_attack_slow':
                                totalAttribute += self.getAbilityAttributeValue(self._abilities[i].attributes, attribute.name, ability.level());
                            break;
                            // omniknight_degen_aura
                            case 'speed_bonus':
                                if (ability.name == 'omniknight_degen_aura') {
                                    totalAttribute += self.getAbilityAttributeValue(self._abilities[i].attributes, attribute.name, ability.level());
                                }
                            break;
                            // tusk_frozen_sigil,crystal_maiden_freezing_field
                            case 'attack_slow':
                                if (ability.name == 'crystal_maiden_freezing_field' && !self.hasScepter()) {
                                    totalAttribute += self.getAbilityAttributeValue(self._abilities[i].attributes, attribute.name, ability.level());
                                }
                                else if (ability.name == 'tusk_frozen_sigil') {
                                    totalAttribute -= self.getAbilityAttributeValue(self._abilities[i].attributes, attribute.name, ability.level());
                                }
                            break;
                            case 'attack_slow_scepter':
                                if (ability.name == 'crystal_maiden_freezing_field' && self.hasScepter()) {
                                    totalAttribute += self.getAbilityAttributeValue(self._abilities[i].attributes, attribute.name, ability.level());
                                }
                            break;
                            // faceless_void_time_walk
                            case 'attack_speed_pct':
                                if (ability.name == 'faceless_void_time_walk') {
                                    totalAttribute += self.getAbilityAttributeValue(self._abilities[i].attributes, attribute.name, ability.level());
                                }
                            break;
                            // bounty_hunter_jinada
                            case 'bonus_attackspeed':
                                if (ability.name == 'bounty_hunter_jinada') {
                                    totalAttribute += self.getAbilityAttributeValue(self._abilities[i].attributes, attribute.name, ability.level());
                                }
                            break;
                            // brewmaster_thunder_clap
                            case 'attack_speed_slow':
                                if (ability.name == 'brewmaster_thunder_clap') {
                                    totalAttribute -= self.getAbilityAttributeValue(self._abilities[i].attributes, attribute.name, ability.level());
                                }
                            break;
                            // medusa_stone_gaze
                            case 'slow':
                                if (ability.name == 'medusa_stone_gaze') {
                                    totalAttribute -= self.getAbilityAttributeValue(self._abilities[i].attributes, attribute.name, ability.level());
                                }
                            break;
                            // visage_grave_chill
                            case 'attackspeed_bonus':
                                totalAttribute -= self.getAbilityAttributeValue(self._abilities[i].attributes, attribute.name, ability.level());
                            break;
                            // abaddon_frostmourne
                            case 'attack_slow_tooltip':
                                if (ability.name == 'abaddon_frostmourne') {
                                    totalAttribute -= self.getAbilityAttributeValue(self._abilities[i].attributes, attribute.name, ability.level());
                                }
                            break;
                        }
                    }
                    if (ability.name == 'enraged_wildkin_tornado') {
                        totalAttribute -= 15;
                    }
                }
                else if (ability.attackspeedreduction != undefined) {
                    // viper_viper_strike,viper_corrosive_skin,jakiro_liquid_fire,lich_chain_frost,sandking_epicenter,earth_spirit_rolling_boulder
                    totalAttribute+=ability.attackspeedreduction();
                }
            }
        }
        return totalAttribute;
    });
    self.getBash = ko.computed(function () {
        var totalAttribute = 1;
        for (var i = 0; i < self.abilities().length; i++) {
            var ability = self._abilities[i];
            if (ability.level() > 0 && (ability.isActive() || (ability.behavior.indexOf('DOTA_ABILITY_BEHAVIOR_PASSIVE') != -1))) {
                if (!(ability.name in self.abilityData)) {
                    for (var j = 0; j < self._abilities[i].attributes.length; j++) {
                        var attribute = self._abilities[i].attributes[j];
                        switch(attribute.name) {
                            // slardar_bash
                            case 'chance':
                            // sniper_headshot
                            case 'proc_chance':
                                totalAttribute *= (1 - self.getAbilityAttributeValue(self._abilities[i].attributes, attribute.name, ability.level())/100);
                            break;
                        }
                    }
                }
                else if (ability.bash != undefined) {
                    // spirit_breaker_greater_bash,faceless_void_time_lock
                    totalAttribute *= (1 - ability.bash()/100);
                }
            }
        }
        return totalAttribute;
    });    
    self.getBaseDamage = ko.computed(function () {
        var totalAttribute = 0;
        var totalMultiplier = 1;
        var sources = {};
        for (var i = 0; i < self.abilities().length; i++) {
            var ability = self._abilities[i];
            if (ability.level() > 0 && (ability.isActive() || (ability.behavior.indexOf('DOTA_ABILITY_BEHAVIOR_PASSIVE') != -1))) {
                if (!(ability.name in self.abilityData)) {
                    for (var j = 0; j < self._abilities[i].attributes.length; j++) {
                        var attribute = self._abilities[i].attributes[j];
                        switch(attribute.name) {
                            // tiny_grow,terrorblade_metamorphosis
                            case 'bonus_damage':
                                if (ability.name == 'tiny_grow' || ability.name == 'terrorblade_metamorphosis') {
                                    totalAttribute += self.getAbilityAttributeValue(self._abilities[i].attributes, attribute.name, ability.level());
                                    sources[ability.name] = {
                                        'damage': self.getAbilityAttributeValue(self._abilities[i].attributes, attribute.name, ability.level()),
                                        'damageType': 'physical',
                                        'displayname': ability.displayname
                                    }
                                }
                            break;
                        }
                    }
                }
                else {
                    if (ability.baseDamageMultiplier != undefined) {
                        // earthshaker_enchant_totem
                        totalMultiplier += ability.baseDamageMultiplier()/100;
                        /*totalAttribute += ability.baseDamage();
                        sources[ability.name] = {
                            'damage': ability.baseDamage(),
                            'damageType': 'physical',
                            'displayname': ability.displayname
                        }*/
                    }
                    if (ability.baseDamage != undefined) {
                        // clinkz_death_pact
                        totalAttribute += ability.baseDamage();
                        sources[ability.name] = {
                            'damage': ability.baseDamage(),
                            'damageType': 'physical',
                            'displayname': ability.displayname
                        }
                    }
                }
            }
        }
        return { sources: sources, total: totalAttribute, multiplier: totalMultiplier };
    });
    
    self.getSelfBaseDamageReductionPct = ko.computed(function () {
        var totalAttribute = 1;
        for (var i = 0; i < self.abilities().length; i++) {
            var ability = self._abilities[i];
            if (ability.level() > 0 && (ability.isActive() || (ability.behavior.indexOf('DOTA_ABILITY_BEHAVIOR_PASSIVE') != -1))) {
                if (!(ability.name in self.abilityData)) {
                    for (var j = 0; j < self._abilities[i].attributes.length; j++) {
                        var attribute = self._abilities[i].attributes[j];
                        switch(attribute.name) {
                            // medusa_split_shot
                            case 'damage_modifier':
                                totalAttribute *= (1 + self.getAbilityAttributeValue(self._abilities[i].attributes, attribute.name, ability.level())/100);
                            break;
                            // windrunner_focusfire
                            case 'focusfire_damage_reduction':
                                if (!self.hasScepter()) {
                                    totalAttribute *= (1 + self.getAbilityAttributeValue(self._abilities[i].attributes, attribute.name, ability.level())/100);
                                }
                            break;
                            case 'focusfire_damage_reduction_scepter':
                                if (self.hasScepter()) {
                                    totalAttribute *= (1 + self.getAbilityAttributeValue(self._abilities[i].attributes, attribute.name, ability.level())/100);
                                }
                            break;
                        }
                    }
                }
            }
        }
        return totalAttribute;
    });
    
    self.getBaseDamageReductionPct = ko.computed(function () {
        var totalAttribute = 1;
        for (var i = 0; i < self.abilities().length; i++) {
            var ability = self._abilities[i];
            if (ability.level() > 0 && (ability.isActive() || (ability.behavior.indexOf('DOTA_ABILITY_BEHAVIOR_PASSIVE') != -1))) {
                if (!(ability.name in self.abilityData)) {
                    for (var j = 0; j < self._abilities[i].attributes.length; j++) {
                        var attribute = self._abilities[i].attributes[j];
                        switch(attribute.name) {
                            // vengefulspirit_command_aura
                            case 'bonus_damage_pct':
                                if (ability.name == 'vengefulspirit_command_aura') {
                                    totalAttribute *= (1 - self.getAbilityAttributeValue(self._abilities[i].attributes, attribute.name, ability.level())/100);
                                }
                            break;
                        }
                    }
                }
                else if (ability.baseDamageReductionPct != undefined) {
                    // nevermore_requiem
                    totalAttribute *= (1 + ability.baseDamageReductionPct()/100);
                }
            }
        }
        return totalAttribute;
    });
    
    self.getBAT = ko.computed(function () {
        var totalAttribute = 0;
        for (var i = 0; i < self.abilities().length; i++) {
            var ability = self._abilities[i];
            if (ability.level() > 0 && (ability.isActive() || (ability.behavior.indexOf('DOTA_ABILITY_BEHAVIOR_PASSIVE') != -1))) {
                if (!(ability.name in self.abilityData)) {
                    for (var j = 0; j < self._abilities[i].attributes.length; j++) {
                        var attribute = self._abilities[i].attributes[j];
                        switch(attribute.name) {
                            // troll_warlord_berserkers_rage,alchemist_chemical_rage,lone_druid_true_form,lycan_shapeshift
                            case 'base_attack_time':
                                totalAttribute += self.getAbilityAttributeValue(self._abilities[i].attributes, attribute.name, ability.level());
                            break;
                        }
                    }
                }
            }
        }
        return totalAttribute;
    });
    self.getBonusDamage = ko.computed(function () {
        var totalAttribute = 0;
        var sources = {};
        for (var i = 0; i < self.abilities().length; i++) {
            var ability = self._abilities[i];
            if (ability.level() > 0 && (ability.isActive() || (ability.behavior.indexOf('DOTA_ABILITY_BEHAVIOR_PASSIVE') != -1))) {
                if (!(ability.name in self.abilityData)) {
                    for (var j = 0; j < self._abilities[i].attributes.length; j++) {
                        var attribute = self._abilities[i].attributes[j];
                        switch(attribute.name) {
                            // broodmother_insatiable_hunger,luna_lunar_blessing,templar_assassin_refraction,templar_assassin_meld,troll_warlord_berserkers_rage,lone_druid_true_form_battle_cry
                            case 'bonus_damage':
                                if (ability.name == 'broodmother_insatiable_hunger' || ability.name == 'luna_lunar_blessing'
                                 || ability.name == 'templar_assassin_refraction' || ability.name == 'templar_assassin_meld'
                                 || ability.name == 'troll_warlord_berserkers_rage' || ability.name == 'lone_druid_true_form_battle_cry') {
                                    totalAttribute += self.getAbilityAttributeValue(self._abilities[i].attributes, attribute.name, ability.level());
                                    sources[ability.name] = {
                                        'damage': self.getAbilityAttributeValue(self._abilities[i].attributes, attribute.name, ability.level()),
                                        'damageType': 'physical',
                                        'displayname': ability.displayname
                                    }
                                }
                            break;
                            // lycan_howl
                            case 'hero_bonus_damage':
                                totalAttribute += self.getAbilityAttributeValue(self._abilities[i].attributes, attribute.name, ability.level());
                                sources[ability.name] = {
                                    'damage': self.getAbilityAttributeValue(self._abilities[i].attributes, attribute.name, ability.level()),
                                    'damageType': 'physical',
                                    'displayname': ability.displayname
                                }
                            break;
                        }
                    }
                    if (ability.name == 'storm_spirit_overload') {
                        totalAttribute += self.getAbilityPropertyValue(ability, 'damage');
                        sources[ability.name] = {
                            'damage': self.getAbilityPropertyValue(ability, 'damage'),
                            'damageType': 'magic',
                            'displayname': ability.displayname
                        }                        
                    }
                }
                else if (ability.bonusDamage != undefined && ability.bonusDamage() != 0) {
                    // nevermore_necromastery,ursa_fury_swipes,ursa_enrage,invoker_alacrity,invoker_exort,elder_titan_ancestral_spirit,spectre_desolate,razor_static_link
                    totalAttribute+=ability.bonusDamage();
                    sources[ability.name] = {
                        'damage': ability.bonusDamage(),
                        'damageType': ability.name == 'spectre_desolate' ? 'pure' : 'physical',
                        'displayname': ability.displayname
                    }
                }
            }
        }
        return { sources: sources, total: totalAttribute };
    });

    self.getBonusDamagePercent = ko.computed(function () {
        var totalAttribute = 0;
        var sources = {};
        for (var i = 0; i < self.abilities().length; i++) {
            var ability = self._abilities[i];
            if (ability.level() > 0 && (ability.isActive() || (ability.behavior.indexOf('DOTA_ABILITY_BEHAVIOR_PASSIVE') != -1))) {
                if (!(ability.name in self.abilityData)) {
                    for (var j = 0; j < self._abilities[i].attributes.length; j++) {
                        var attribute = self._abilities[i].attributes[j];
                        switch(attribute.name) {
                            // bloodseeker_bloodrage
                            case 'damage_increase_pct':
                                if (ability.name == 'bloodseeker_bloodrage') {
                                    totalAttribute += self.getAbilityAttributeValue(self._abilities[i].attributes, attribute.name, ability.level())/100;
                                    sources[ability.name] = {
                                        'damage': self.getAbilityAttributeValue(self._abilities[i].attributes, attribute.name, ability.level())/100,
                                        'damageType': 'physical',
                                        'displayname': ability.displayname
                                    }
                                }
                            break;
                            // magnataur_empower,vengefulspirit_command_aura,alpha_wolf_command_aura
                            case 'bonus_damage_pct':
                                if (ability.name == 'magnataur_empower' || ability.name == 'vengefulspirit_command_aura' || ability.name == 'alpha_wolf_command_aura') {
                                    totalAttribute += self.getAbilityAttributeValue(self._abilities[i].attributes, attribute.name, ability.level())/100;
                                    sources[ability.name] = {
                                        'damage': self.getAbilityAttributeValue(self._abilities[i].attributes, attribute.name, ability.level())/100,
                                        'damageType': 'physical',
                                        'displayname': ability.displayname
                                    }
                                }
                            break;
                            // sven_gods_strength
                            case 'gods_strength_damage':
                                if (ability.name == 'sven_gods_strength' && self.hero != undefined && self.hero.heroId() == 'sven') {
                                    totalAttribute += self.getAbilityAttributeValue(self._abilities[i].attributes, attribute.name, ability.level())/100;
                                    sources[ability.name] = {
                                        'damage': self.getAbilityAttributeValue(self._abilities[i].attributes, attribute.name, ability.level())/100,
                                        'damageType': 'physical',
                                        'displayname': ability.displayname
                                    }
                                }
                            break;
                            case 'gods_strength_damage_scepter':
                                if (ability.name == 'sven_gods_strength' && self.hero == undefined) {
                                    totalAttribute += self.getAbilityAttributeValue(self._abilities[i].attributes, attribute.name, ability.level())/100;
                                    sources[ability.name] = {
                                        'damage': self.getAbilityAttributeValue(self._abilities[i].attributes, attribute.name, ability.level())/100,
                                        'damageType': 'physical',
                                        'displayname': ability.displayname
                                    }
                                }
                            break;
                        }
                    }
                }
                /*else if (ability.bonusDamagePct != undefined && ability.bonusDamagePct() != 0) {
                    // bloodseeker_bloodrage
                    // totalAttribute+=ability.bonusDamagePct()/100;
                    // sources[ability.name] = {
                        // 'damage': ability.bonusDamagePct()/100,
                        // 'damageType': 'physical',
                        // 'displayname': ability.displayname
                    // }
                }*/
            }
        }
        return { sources: sources, total: totalAttribute };
    });

    self.getBonusDamageBackstab = ko.computed(function () {
        var totalAttribute1 = 0;
        var totalAttribute2 = 0;
        var sources = [];
        for (var i = 0; i < self.abilities().length; i++) {
            var ability = self._abilities[i];
            if (ability.name == 'riki_backstab') {
                if (ability.level() > 0 && (ability.isActive() || (ability.behavior.indexOf('DOTA_ABILITY_BEHAVIOR_PASSIVE') != -1))) {
                    for (var j = 0; j < self._abilities[i].attributes.length; j++) {
                        var attribute = self._abilities[i].attributes[j];
                        switch(attribute.name) {
                            // riki_backstab
                            case 'damage_multiplier':
                                totalAttribute1 += self.getAbilityAttributeValue(self._abilities[i].attributes, attribute.name, ability.level());
                                sources.push({
                                    'damage': self.getAbilityAttributeValue(self._abilities[i].attributes, attribute.name, ability.level()),
                                    'damageType': 'physical',
                                    'displayname': ability.displayname
                                });
                            break;
                        }
                    }/*
                    if (ability.bonusDamageBackstab != undefined) {
                        console.log('bonusDamageBackstab');
                        // damage_multiplier
                        totalAttribute2+=ability.bonusDamageBackstab();
                        sources.push({
                            'damage': ability.bonusDamageBackstab(),
                            'damageType': 'physical',
                            'displayname': ability.displayname
                        });
                    }
                    */
                }
            }
        }
        return { sources: sources, total: [totalAttribute1,totalAttribute2] };
    });
    
    self.getBonusDamagePrecisionAura = ko.computed(function () {
        var totalAttribute1 = 0;
        var totalAttribute2 = 0;
        var sources = [];
        for (var i = 0; i < self.abilities().length; i++) {
            var ability = self._abilities[i];
            if (ability.name == 'drow_ranger_trueshot') {
                if (ability.level() > 0 && (ability.isActive() || (ability.behavior.indexOf('DOTA_ABILITY_BEHAVIOR_PASSIVE') != -1))) {
                    for (var j = 0; j < self._abilities[i].attributes.length; j++) {
                        var attribute = self._abilities[i].attributes[j];
                        switch(attribute.name) {
                            // drow_ranger_trueshot
                            case 'trueshot_ranged_damage':
                                totalAttribute1 += self.getAbilityAttributeValue(self._abilities[i].attributes, attribute.name, ability.level())/100;
                                sources.push({
                                    'damage': self.getAbilityAttributeValue(self._abilities[i].attributes, attribute.name, ability.level())/100,
                                    'damageType': 'physical',
                                    'displayname': ability.displayname
                                });
                            break;
                        }
                    }
                    if (ability.bonusDamagePrecisionAura != undefined) {
                        // drow_ranger_trueshot
                        totalAttribute2+=ability.bonusDamagePrecisionAura();
                        sources.push({
                            'damage': ability.bonusDamagePrecisionAura(),
                            'damageType': 'physical',
                            'displayname': ability.displayname
                        });
                    }
                }
            }
        }
        return { sources: sources, total: [totalAttribute1,totalAttribute2] };
    });
    
    self.getBonusDamageReduction = ko.computed(function () {
        var totalAttribute = 0;
        for (var i = 0; i < self.abilities().length; i++) {
            var ability = self._abilities[i];
            if (ability.level() > 0 && (ability.isActive() || (ability.behavior.indexOf('DOTA_ABILITY_BEHAVIOR_PASSIVE') != -1))) {
                if (!(ability.name in self.abilityData)) {
                    for (var j = 0; j < self._abilities[i].attributes.length; j++) {
                        var attribute = self._abilities[i].attributes[j];
                        switch(attribute.name) {
                            // bane_enfeeble
                            case 'enfeeble_attack_reduction':
                                totalAttribute += self.getAbilityAttributeValue(self._abilities[i].attributes, attribute.name, ability.level());
                            break;
                        }
                    }
                }
                else if (ability.bonusDamageReduction != undefined) {
                    // rubick_fade_bolt,razor_static_link
                    totalAttribute+=ability.bonusDamageReduction();
                }
            }
        }
        return totalAttribute;
    });
    
    self.getBonusDamageReductionPct = ko.computed(function () {
        var totalAttribute = 1;
        for (var i = 0; i < self.abilities().length; i++) {
            var ability = self._abilities[i];
            if (ability.level() > 0 && (ability.isActive() || (ability.behavior.indexOf('DOTA_ABILITY_BEHAVIOR_PASSIVE') != -1))) {
                if (!(ability.name in self.abilityData)) {
                    for (var j = 0; j < self._abilities[i].attributes.length; j++) {
                        var attribute = self._abilities[i].attributes[j];
                        switch(attribute.name) {
                            // medusa_split_shot
                            case 'damage_modifier':
                                totalAttribute *= (1 + self.getAbilityAttributeValue(self._abilities[i].attributes, attribute.name, ability.level())/100);
                            break;
                            // windrunner_focusfire
                            case 'focusfire_damage_reduction':
                                if (!self.hasScepter()) {
                                    totalAttribute *= (1 + self.getAbilityAttributeValue(self._abilities[i].attributes, attribute.name, ability.level())/100);
                                }
                            break;
                            case 'focusfire_damage_reduction_scepter':
                                if (self.hasScepter()) {
                                    totalAttribute *= (1 + self.getAbilityAttributeValue(self._abilities[i].attributes, attribute.name, ability.level())/100);
                                }
                            break;
                        }
                    }
                }
            }
        }
        return totalAttribute;
    });

    self.getDamageAmplification = ko.computed(function () {
        var totalAttribute = 1;
        for (var i = 0; i < self.abilities().length; i++) {
            var ability = self._abilities[i];
            if (ability.level() > 0 && (ability.isActive() || (ability.behavior.indexOf('DOTA_ABILITY_BEHAVIOR_PASSIVE') != -1))) {
                /*if (!(ability.name in self.abilityData)) {
                    if (ability.level() > 0 && (ability.isActive() || (ability.behavior.indexOf('DOTA_ABILITY_BEHAVIOR_PASSIVE') != -1))) {
                        for (var j = 0; j < self._abilities[i].attributes.length; j++) {
                            var attribute = self._abilities[i].attributes[j];
                            switch(attribute.name) {
                                // bane_enfeeble
                                case 'enfeeble_attack_reduction':
                                    totalAttribute += self.getAbilityAttributeValue(self._abilities[i].attributes, attribute.name, ability.level());
                                break;
                            }
                        }
                    }
                }
                else*/ if (ability.damageAmplification != undefined) {
                        // undying_flesh_golem
                        totalAttribute *= (1 + ability.damageAmplification()/100);
                }
            }
        }
        return totalAttribute;
    });
    
    self.getDamageReduction = ko.computed(function () {
        var totalAttribute = 1;
        for (var i = 0; i < self.abilities().length; i++) {
            var ability = self._abilities[i];
            if (ability.level() > 0 && (ability.isActive() || (ability.behavior.indexOf('DOTA_ABILITY_BEHAVIOR_PASSIVE') != -1))) {
                if (!(ability.name in self.abilityData)) {
                    for (var j = 0; j < self._abilities[i].attributes.length; j++) {
                        var attribute = self._abilities[i].attributes[j];
                        switch(attribute.name) {
                            // bloodseeker_bloodrage
                            case 'damage_increase_pct':
                                if (ability.name == 'bloodseeker_bloodrage') {
                                    totalAttribute *= (1 + self.getAbilityAttributeValue(self._abilities[i].attributes, attribute.name, ability.level())/100);
                                }
                            break;
                        }
                    }
                    // kunkka_ghostship
                    if (ability.name == 'kunkka_ghostship') {
                        totalAttribute *= (1 - 50/100);
                    }
                }
                else if (ability.damageReduction != undefined) {
                    // wisp_overcharge,bristleback_bristleback,spectre_dispersion,medusa_mana_shield,ursa_enrage
                    totalAttribute *= (1 + ability.damageReduction()/100);
                }
            }
        }
        return totalAttribute;
    });

    self.getCritSource = ko.computed(function () {
        var sources = {};
        for (var i = 0; i < self.abilities().length; i++) {
            var ability = self._abilities[i];
            if (ability.level() > 0 && (ability.isActive() || (ability.behavior.indexOf('DOTA_ABILITY_BEHAVIOR_PASSIVE') != -1))) {
                if (!(ability.name in self.abilityData)) {
                    switch(ability.name) {
                        // phantom_assassin_coup_de_grace,brewmaster_drunken_brawler,chaos_knight_chaos_strike,lycan_shapeshift,skeleton_king_mortal_strike,juggernaut_blade_dance,alpha_wolf_critical_strike,giant_wolf_critical_strike
                        case 'phantom_assassin_coup_de_grace':
                            if (sources[ability.name] == undefined) {
                                sources[ability.name] = {
                                    'chance': self.getAbilityAttributeValue(self._abilities[i].attributes, 'crit_chance', ability.level())/100,
                                    'multiplier': self.getAbilityAttributeValue(self._abilities[i].attributes, 'crit_bonus', ability.level())/100,
                                    'count': 1,
                                    'displayname': ability.displayname
                                }
                            }
                            else {
                                sources[ability.name].count += 1;
                            }
                        break;
                        case 'brewmaster_drunken_brawler':
                            if (sources[ability.name] == undefined) {
                                sources[ability.name] = {
                                    'chance': self.getAbilityAttributeValue(self._abilities[i].attributes, 'crit_chance', ability.level())/100,
                                    'multiplier': self.getAbilityAttributeValue(self._abilities[i].attributes, 'crit_multiplier', ability.level())/100,
                                    'count': 1,
                                    'displayname': ability.displayname
                                }
                            }
                            else {
                                sources[ability.name].count += 1;
                            }
                        break;
                        case 'chaos_knight_chaos_strike':
                        case 'lycan_shapeshift':
                            if (sources[ability.name] == undefined) {
                                sources[ability.name] = {
                                    'chance': self.getAbilityAttributeValue(self._abilities[i].attributes, 'crit_chance', ability.level())/100,
                                    'multiplier': self.getAbilityAttributeValue(self._abilities[i].attributes, 'crit_multiplier', ability.level())/100,
                                    'count': 1,
                                    'displayname': ability.displayname
                                }
                            }
                            else {
                                sources[ability.name].count += 1;
                            }
                        break;
                        case 'skeleton_king_mortal_strike':
                            if (sources[ability.name] == undefined) {
                                sources[ability.name] = {
                                    'chance': self.getAbilityAttributeValue(self._abilities[i].attributes, 'crit_chance', ability.level())/100,
                                    'multiplier': self.getAbilityAttributeValue(self._abilities[i].attributes, 'crit_mult', ability.level())/100,
                                    'count': 1,
                                    'displayname': ability.displayname
                                }
                            }
                            else {
                                sources[ability.name].count += 1;
                            }
                        break;
                        case 'juggernaut_blade_dance':
                            if (sources[ability.name] == undefined) {
                                sources[ability.name] = {
                                    'chance': self.getAbilityAttributeValue(self._abilities[i].attributes, 'blade_dance_crit_chance', ability.level())/100,
                                    'multiplier': self.getAbilityAttributeValue(self._abilities[i].attributes, 'blade_dance_crit_mult', ability.level())/100,
                                    'count': 1,
                                    'displayname': ability.displayname
                                }
                            }
                            else {
                                sources[ability.name].count += 1;
                            }
                        break;
                        case 'alpha_wolf_critical_strike':
                        case 'giant_wolf_critical_strike':
                            if (sources[ability.name] == undefined) {
                                sources[ability.name] = {
                                    'chance': self.getAbilityAttributeValue(self._abilities[i].attributes, 'crit_chance', ability.level())/100,
                                    'multiplier': self.getAbilityAttributeValue(self._abilities[i].attributes, 'crit_mult', ability.level())/100,
                                    'count': 1,
                                    'displayname': ability.displayname
                                }
                            }
                            else {
                                sources[ability.name].count += 1;
                            }
                        break;
                    }
                }
            }
        }
        return sources;
    });    

    self.getCleaveSource = ko.computed(function () {
        var sources = {};
        for (var i = 0; i < self.abilities().length; i++) {
            var ability = self._abilities[i];
            if (ability.level() > 0 && (ability.isActive() || (ability.behavior.indexOf('DOTA_ABILITY_BEHAVIOR_PASSIVE') != -1))) {
                if (!(ability.name in self.abilityData)) {
                    switch(ability.name) {
                        // magnataur_empower
                        case 'magnataur_empower':
                            if (sources[ability.name] == undefined) {
                                sources[ability.name] = {
                                    'radius': self.getAbilityAttributeValue(self._abilities[i].attributes, 'cleave_radius', ability.level()),
                                    'magnitude': self.getAbilityAttributeValue(self._abilities[i].attributes, 'cleave_damage_pct', ability.level())/100,
                                    'count': 1,
                                    'displayname': ability.displayname
                                }
                            }
                            else {
                                sources[ability.name].count += 1;
                            }
                        break;
                        // sven_great_cleave
                        case 'sven_great_cleave':
                            if (sources[ability.name] == undefined) {
                                sources[ability.name] = {
                                    'radius': self.getAbilityAttributeValue(self._abilities[i].attributes, 'great_cleave_radius', ability.level()),
                                    'magnitude': self.getAbilityAttributeValue(self._abilities[i].attributes, 'great_cleave_damage', ability.level())/100,
                                    'count': 1,
                                    'displayname': ability.displayname
                                }
                            }
                            else {
                                sources[ability.name].count += 1;
                            }
                        break;
                        // kunkka_tidebringer
                        case 'kunkka_tidebringer':
                            if (sources[ability.name] == undefined) {
                                sources[ability.name] = {
                                    'radius': self.getAbilityAttributeValue(self._abilities[i].attributes, 'radius', ability.level()),
                                    'magnitude': 1,
                                    'count': 1,
                                    'displayname': ability.displayname
                                }
                            }
                            else {
                                sources[ability.name].count += 1;
                            }
                        break;
                        // tiny_grow
                        case 'tiny_grow':
                            if (self.hasScepter()) {
                                if (sources[ability.name] == undefined) {
                                    sources[ability.name] = {
                                        'radius': self.getAbilityAttributeValue(self._abilities[i].attributes, 'bonus_cleave_radius_scepter', ability.level()),
                                        'magnitude': self.getAbilityAttributeValue(self._abilities[i].attributes, 'bonus_cleave_damage_scepter', ability.level())/100,
                                        'count': 1,
                                        'displayname': ability.displayname
                                    }
                                }
                                else {
                                    sources[ability.name].count += 1;
                                }
                            }
                        break;
                    }
                }
            }
        }
        return sources;
    });    
    
    self.getCritChance = ko.computed(function () {
        var totalAttribute = 1;
        for (var i = 0; i < self.abilities().length; i++) {
            var ability = self._abilities[i];
            if (ability.level() > 0 && (ability.isActive() || (ability.behavior.indexOf('DOTA_ABILITY_BEHAVIOR_PASSIVE') != -1))) {
                if (!(ability.name in self.abilityData)) {
                    for (var j = 0; j < self._abilities[i].attributes.length; j++) {
                        var attribute = self._abilities[i].attributes[j];
                        switch(attribute.name) {
                            // phantom_assassin_coup_de_grace,brewmaster_drunken_brawler,chaos_knight_chaos_strike,lycan_shapeshift,skeleton_king_mortal_strike
                            case 'crit_chance':
                                totalAttribute *= (1 - self.getAbilityAttributeValue(self._abilities[i].attributes, attribute.name, ability.level())/100);
                            break;
                        }
                    }
                }
            }
        }
        return totalAttribute;
    });            
    
    self.getEvasion = ko.computed(function () {
        var totalAttribute = 1;
        for (var i = 0; i < self.abilities().length; i++) {
            var ability = self._abilities[i];
            if (ability.level() > 0 && (ability.isActive() || (ability.behavior.indexOf('DOTA_ABILITY_BEHAVIOR_PASSIVE') != -1))) {
                if (!(ability.name in self.abilityData)) {
                    for (var j = 0; j < self._abilities[i].attributes.length; j++) {
                        var attribute = self._abilities[i].attributes[j];
                        switch(attribute.name) {
                            // phantom_assassin_blur
                            case 'bonus_evasion':
                            // brewmaster_drunken_brawler
                            case 'dodge_chance':
                                totalAttribute *= (1 - self.getAbilityAttributeValue(self._abilities[i].attributes, attribute.name, ability.level())/100);
                            break;
                        }
                    }
                }
            }
        }
        return totalAttribute;
    });
    
    self.getEvasionBacktrack = ko.computed(function () {
        var totalAttribute = 1;
        for (var i = 0; i < self.abilities().length; i++) {
            var ability = self._abilities[i];
            if (ability.level() > 0 && (ability.isActive() || (ability.behavior.indexOf('DOTA_ABILITY_BEHAVIOR_PASSIVE') != -1))) {
                if (!(ability.name in self.abilityData)) {
                    for (var j = 0; j < self._abilities[i].attributes.length; j++) {
                        var attribute = self._abilities[i].attributes[j];
                        switch(attribute.name) {
                            // faceless_void_backtrack
                            case 'dodge_chance_pct':
                                totalAttribute *= (1 - self.getAbilityAttributeValue(self._abilities[i].attributes, attribute.name, ability.level())/100);
                            break;
                        }
                    }
                }
            }
        }
        return totalAttribute;
    });
    
    self.getMissChance = ko.computed(function () {
        var totalAttribute = 1;
        for (var i = 0; i < self.abilities().length; i++) {
            var ability = self._abilities[i];
            if (ability.level() > 0 && (ability.isActive() || (ability.behavior.indexOf('DOTA_ABILITY_BEHAVIOR_PASSIVE') != -1))) {
                if (!(ability.name in self.abilityData)) {
                    for (var j = 0; j < self._abilities[i].attributes.length; j++) {
                        var attribute = self._abilities[i].attributes[j];
                        switch(attribute.name) {
                            // broodmother_incapacitating_bite,brewmaster_drunken_haze
                            case 'miss_chance':
                            // riki_smoke_screen,keeper_of_the_light_blinding_light,tinker_laser
                            case 'miss_rate':
                                totalAttribute *= (1 - self.getAbilityAttributeValue(self._abilities[i].attributes, attribute.name, ability.level())/100);
                            break;
                        }
                    }
                }
                else if (ability.missChance != undefined) {
                    // night_stalker_crippling_fear
                    totalAttribute*=(1-ability.missChance()/100);
                }
            }
        }
        return totalAttribute;
    });
    
    self.getLifesteal = ko.computed(function () {
        var totalAttribute = 0;
        for (var i = 0; i < self.abilities().length; i++) {
            var ability = self._abilities[i];
            if (ability.level() > 0 && (ability.isActive() || (ability.behavior.indexOf('DOTA_ABILITY_BEHAVIOR_PASSIVE') != -1))) {
                if (!(ability.name in self.abilityData)) {
                    for (var j = 0; j < self._abilities[i].attributes.length; j++) {
                        var attribute = self._abilities[i].attributes[j];
                        switch(attribute.name) {
                            // skeleton_king_vampiric_aura
                            case 'vampiric_aura':
                            // broodmother_insatiable_hunger
                            case 'lifesteal_pct':
                                totalAttribute += self.getAbilityAttributeValue(self._abilities[i].attributes, attribute.name, ability.level());
                            break;
                        }
                    }
                }
                else if (ability.lifesteal != undefined) {
                    // life_stealer_open_wounds
                    totalAttribute+=ability.lifesteal();
                }
            }
        }
        return totalAttribute;
    });
    
    self.getMagicResist = ko.computed(function () {
        var totalAttribute = 1;
        for (var i = 0; i < self.abilities().length; i++) {
            var ability = self._abilities[i];
            if (ability.level() > 0 && (ability.isActive() || (ability.behavior.indexOf('DOTA_ABILITY_BEHAVIOR_PASSIVE') != -1))) {
                if (!(ability.name in self.abilityData)) {
                    for (var j = 0; j < self._abilities[i].attributes.length; j++) {
                        var attribute = self._abilities[i].attributes[j];
                        switch(attribute.name) {
                            // antimage_spell_shield
                            case 'spell_shield_resistance':
                                totalAttribute *= (1 - self.getAbilityAttributeValue(self._abilities[i].attributes, attribute.name, ability.level())/100);
                            break;
                            // phantom_lancer_phantom_edge
                            case 'magic_resistance_pct':
                                if (ability.name == 'phantom_lancer_phantom_edge') {
                                    totalAttribute *= (1 - self.getAbilityAttributeValue(self._abilities[i].attributes, attribute.name, ability.level())/100);
                                }
                            break;
                            // rubick_null_field
                            case 'magic_damage_reduction_pct':
                                if (ability.name == 'rubick_null_field') {
                                    totalAttribute *= (1 - self.getAbilityAttributeValue(self._abilities[i].attributes, attribute.name, ability.level())/100);
                                }
                            break;
                        }
                    }
                }
                else if (ability.magicResist != undefined) {
                    // huskar_berserkers_blood,viper_corrosive_skin,visage_gravekeepers_cloak
                    totalAttribute *= (1 - ability.magicResist()/100);
                }
            }
        }
        return totalAttribute;
    });

    self.getMagicResistReduction = ko.computed(function () {
        var totalAttribute = 1;
        for (var i = 0; i < self.abilities().length; i++) {
            var ability = self._abilities[i];
            if (ability.level() > 0 && (ability.isActive() || (ability.behavior.indexOf('DOTA_ABILITY_BEHAVIOR_PASSIVE') != -1))) {
                if (!(ability.name in self.abilityData)) {
                    for (var j = 0; j < self._abilities[i].attributes.length; j++) {
                        var attribute = self._abilities[i].attributes[j];
                        switch(attribute.name) {
                            // ancient_apparition_ice_vortex
                            case 'spell_resist_pct':
                            // pugna_decrepify
                            case 'bonus_spell_damage_pct':
                            // skywrath_mage_ancient_seal
                            case 'resist_debuff':
                                totalAttribute *= (1 - self.getAbilityAttributeValue(self._abilities[i].attributes, attribute.name, ability.level())/100);
                            break;
                            // elder_titan_natural_order
                            case 'magic_resistance_pct':
                                totalAttribute *= (1 - self.getAbilityAttributeValue(self._abilities[i].attributes, attribute.name, ability.level())/100);
                            break;
                        }
                    }
                }
            }
        }
        return totalAttribute;
    });
    
    self.getMovementSpeedFlat = ko.computed(function () {
        var totalAttribute = 0;
        for (var i = 0; i < self.abilities().length; i++) {
            var ability = self._abilities[i];
            if (ability.level() > 0 && (ability.isActive() || (ability.behavior.indexOf('DOTA_ABILITY_BEHAVIOR_PASSIVE') != -1))) {
                if (!(ability.name in self.abilityData)) {
                    for (var j = 0; j < self._abilities[i].attributes.length; j++) {
                        var attribute = self._abilities[i].attributes[j];
                        switch(attribute.name) {
                            // alchemist_chemical_rage
                            case 'bonus_movespeed':
                                if (ability.name == 'alchemist_chemical_rage') {
                                    totalAttribute += self.getAbilityAttributeValue(self._abilities[i].attributes, attribute.name, ability.level());
                                }
                            break;
                            // tiny_grow
                            case 'bonus_movement_speed':
                                if (ability.name == 'tiny_grow') {
                                    totalAttribute += self.getAbilityAttributeValue(self._abilities[i].attributes, attribute.name, ability.level());
                                }
                            break;
                            // troll_warlord_berserkers_rage
                            case 'bonus_move_speed':
                                if (ability.name == 'troll_warlord_berserkers_rage') {
                                    totalAttribute += self.getAbilityAttributeValue(self._abilities[i].attributes, attribute.name, ability.level());
                                }                                
                            break;
                            // lone_druid_true_form
                            case 'speed_loss':
                                totalAttribute -= self.getAbilityAttributeValue(self._abilities[i].attributes, attribute.name, ability.level());
                            break;
                        }
                    }
                }
                else if (ability.movementSpeedFlat != undefined) {
                // dragon_knight_elder_dragon_form
                    totalAttribute+=ability.movementSpeedFlat();
                }
            }
        }
        return totalAttribute;
    });
    
    self.getMovementSpeedPercent = ko.computed(function () {
        var totalAttribute = 0;
        for (var i = 0; i < self.abilities().length; i++) {
            var ability = self._abilities[i];
            if (ability.level() > 0 && (ability.isActive() || (ability.behavior.indexOf('DOTA_ABILITY_BEHAVIOR_PASSIVE') != -1))) {
                if (!(ability.name in self.abilityData)) {
                    for (var j = 0; j < self._abilities[i].attributes.length; j++) {
                        var attribute = self._abilities[i].attributes[j];
                        switch(attribute.name) {
                            // abaddon_frostmourne 
                            case 'move_speed_pct':
                            // bounty_hunter_track 
                            case 'bonus_move_speed_pct':
                            // mirana_leap 
                            case 'leap_speedbonus':
                            // sven_warcry 
                            case 'warcry_movespeed':
                            // clinkz_wind_walk
                            case 'move_speed_bonus_pct':
                            // windrunner_windrun
                            case 'movespeed_bonus_pct':
                                totalAttribute += self.getAbilityAttributeValue(self._abilities[i].attributes, attribute.name, ability.level())/100;
                            break;
                            // broodmother_spin_web,spectre_spectral_dagger
                            case 'bonus_movespeed':
                                if (ability.name == 'broodmother_spin_web' || ability.name == 'spectre_spectral_dagger') {
                                    totalAttribute += self.getAbilityAttributeValue(self._abilities[i].attributes, attribute.name, ability.level())/100;
                                }
                            break;
                            // axe_culling_blade,necronomicon_archer_aoe
                            case 'speed_bonus':
                                if (ability.name == 'axe_culling_blade' || ability.name == 'necronomicon_archer_aoe') {
                                    totalAttribute += self.getAbilityAttributeValue(self._abilities[i].attributes, attribute.name, ability.level())/100;
                                }
                            break;
                            // nyx_assassin_vendetta 
                            case 'movement_speed':
                                if (ability.name == 'nyx_assassin_vendetta') {
                                    totalAttribute += self.getAbilityAttributeValue(self._abilities[i].attributes, attribute.name, ability.level())/100;
                                }
                            break;
                            // spirit_breaker_empowering_haste
                            case 'bonus_movespeed_pct':
                                if (ability.name == 'spirit_breaker_empowering_haste') {
                                    totalAttribute += self.getAbilityAttributeValue(self._abilities[i].attributes, attribute.name, ability.level())/100;
                                }
                            break;
                            // ogre_magi_bloodlust,death_prophet_witchcraft,kobold_taskmaster_speed_aura
                            case 'bonus_movement_speed':
                                if (ability.name == 'ogre_magi_bloodlust' || ability.name == 'death_prophet_witchcraft' || ability.name == 'kobold_taskmaster_speed_aura') {
                                    totalAttribute += self.getAbilityAttributeValue(self._abilities[i].attributes, attribute.name, ability.level())/100;
                                }
                            break;
                            // razor_unstable_current,phantom_lancer_doppelwalk
                            case 'movement_speed_pct':
                                if (ability.name == 'razor_unstable_current' || ability.name == 'phantom_lancer_doppelwalk') {
                                    totalAttribute += self.getAbilityAttributeValue(self._abilities[i].attributes, attribute.name, ability.level())/100;
                                }
                            break;
                            // treant_natures_guise,lone_druid_rabid
                            case 'bonus_move_speed':
                                if (ability.name == 'treant_natures_guise' || ability.name == 'lone_druid_rabid') {
                                    totalAttribute += self.getAbilityAttributeValue(self._abilities[i].attributes, attribute.name, ability.level())/100;
                                }
                            break;
                            // wisp_tether
                            case 'movespeed':
                                if (ability.name == 'wisp_tether') {
                                    totalAttribute += self.getAbilityAttributeValue(self._abilities[i].attributes, attribute.name, ability.level())/100;
                                }
                            break;
                            // kunkka_ghostship,visage_grave_chill
                            case 'movespeed_bonus':
                                if (ability.name == 'kunkka_ghostship' || ability.name == 'visage_grave_chill') {
                                    totalAttribute += self.getAbilityAttributeValue(self._abilities[i].attributes, attribute.name, ability.level())/100;
                                }                                
                            break;
                        }
                    }
                }
                else if (ability.movementSpeedPct != undefined) {
                // axe_battle_hunger,bristleback_warpath,spirit_breaker_greater_bash,lina_fiery_soul,invoker_ghost_walk,invoker_wex,elder_titan_ancestral_spirit
                    totalAttribute+=ability.movementSpeedPct()/100;
                }
            }
        }
        return totalAttribute;
    });

    self.getMovementSpeedPercentReduction = ko.computed(function () {
        var totalAttribute = 0;
        for (var i = 0; i < self.abilities().length; i++) {
            var ability = self._abilities[i];
            if (ability.level() > 0 && (ability.isActive() || (ability.behavior.indexOf('DOTA_ABILITY_BEHAVIOR_PASSIVE') != -1))) {
                if (!(ability.name in self.abilityData)) {
                    for (var j = 0; j < self._abilities[i].attributes.length; j++) {
                        var attribute = self._abilities[i].attributes[j];
                        switch(attribute.name) {
                            // crystal_maiden_freezing_field
                            case 'movespeed_slow':
                                if (ability.name == 'crystal_maiden_freezing_field' && !self.hasScepter()) {
                                    totalAttribute += self.getAbilityAttributeValue(self._abilities[i].attributes, attribute.name, ability.level())/100;
                                }
                            break;
                            case 'movespeed_slow_scepter':
                                if (ability.name == 'crystal_maiden_freezing_field' && self.hasScepter()) {
                                    totalAttribute += self.getAbilityAttributeValue(self._abilities[i].attributes, attribute.name, ability.level())/100;
                                }
                            break;
                            // elder_titan_earth_splitter,magnataur_skewer,abaddon_frostmourne 
                            case 'slow_pct':
                                totalAttribute -= self.getAbilityAttributeValue(self._abilities[i].attributes, attribute.name, ability.level())/100;
                            break;
                            // night_stalker_void,crystal_maiden_crystal_nova,ghost_frost_attack,ogre_magi_frost_armor,polar_furbolg_ursa_warrior_thunder_clap
                            case 'movespeed_slow':
                                if (ability.name != 'crystal_maiden_freezing_field') {
                                    totalAttribute += self.getAbilityAttributeValue(self._abilities[i].attributes, attribute.name, ability.level())/100;
                                }
                            break;
                            // lich_frost_armor,lich_frost_nova,enchantress_enchant
                            case 'slow_movement_speed':
                            // beastmaster_primal_roar
                            case 'slow_movement_speed_pct':
                            // drow_ranger_frost_arrows
                            case 'frost_arrows_movement_speed':
                            // skeleton_king_hellfire_blast
                            case 'blast_slow':
                            // slardar_slithereen_crush
                            case 'crush_extra_slow':
                            // storm_spirit_overload:
                            case 'overload_move_slow':
                            // windrunner_windrun
                            case 'enemy_movespeed_bonus_pct':
                                totalAttribute += self.getAbilityAttributeValue(self._abilities[i].attributes, attribute.name, ability.level())/100;
                            break;
                            // phantom_assassin_stifling_dagger,tusk_frozen_sigil
                            case 'move_slow':
                                if (ability.name == 'phantom_assassin_stifling_dagger') {
                                    totalAttribute += self.getAbilityAttributeValue(self._abilities[i].attributes, attribute.name, ability.level())/100;
                                }
                                else if (ability.name == 'tusk_frozen_sigil') {
                                    totalAttribute -= self.getAbilityAttributeValue(self._abilities[i].attributes, attribute.name, ability.level())/100;
                                }
                            break;
                            // invoker_ice_wall,medusa_stone_gaze,wisp_tether
                            case 'slow':
                                if (ability.name == 'medusa_stone_gaze') {
                                    totalAttribute -= self.getAbilityAttributeValue(self._abilities[i].attributes, attribute.name, ability.level())/100;
                                }
                                else {
                                    totalAttribute += self.getAbilityAttributeValue(self._abilities[i].attributes, attribute.name, ability.level())/100;
                                }
                            break;
                            // broodmother_incapacitating_bite,bounty_hunter_jinada,spectre_spectral_dagger,winter_wyvern_arctic_burn
                            case 'bonus_movespeed':
                                if (ability.name == 'broodmother_incapacitating_bite' || ability.name == 'bounty_hunter_jinada' || ability.name == 'winter_wyvern_arctic_burn' || ability.name == 'winter_wyvern_splinter_blast') {
                                    totalAttribute += self.getAbilityAttributeValue(self._abilities[i].attributes, attribute.name, ability.level())/100;
                                }
                                else if (ability.name == 'spectre_spectral_dagger') {
                                    totalAttribute -= self.getAbilityAttributeValue(self._abilities[i].attributes, attribute.name, ability.level())/100;
                                }
                            break;
                            // omniknight_degen_aura
                            case 'speed_bonus':
                                if (ability.name == 'omniknight_degen_aura') {
                                    totalAttribute += self.getAbilityAttributeValue(self._abilities[i].attributes, attribute.name, ability.level())/100;
                                }
                            break;
                            // tidehunter_gush
                            case 'movement_speed':
                                if (ability.name == 'tidehunter_gush') {
                                    totalAttribute += self.getAbilityAttributeValue(self._abilities[i].attributes, attribute.name, ability.level())/100;
                                }
                            break;
                            // pugna_decrepify,chen_penitence
                            case 'bonus_movement_speed':
                                if (ability.name == 'pugna_decrepify' || ability.name == 'chen_penitence') {
                                    totalAttribute += self.getAbilityAttributeValue(self._abilities[i].attributes, attribute.name, ability.level())/100;
                                }
                            break;
                            // ancient_apparition_ice_vortex,phantom_lancer_spirit_lance,skywrath_mage_concussive_shot,faceless_void_time_walk
                            case 'movement_speed_pct':
                                if (ability.name == 'ancient_apparition_ice_vortex' || ability.name == 'phantom_lancer_spirit_lance' || ability.name == 'faceless_void_time_walk') {
                                    totalAttribute += self.getAbilityAttributeValue(self._abilities[i].attributes, attribute.name, ability.level())/100;
                                }
                                else if (ability.name == 'skywrath_mage_concussive_shot') {
                                    totalAttribute -= self.getAbilityAttributeValue(self._abilities[i].attributes, attribute.name, ability.level())/100;
                                }
                            break;
                            // razor_unstable_current
                            case 'slow_amount':
                                if (ability.name == 'razor_unstable_current') {
                                    totalAttribute += self.getAbilityAttributeValue(self._abilities[i].attributes, attribute.name, ability.level())/100;
                                }
                            break;
                            // brewmaster_drunken_haze,brewmaster_thunder_clap,treant_leech_seed
                            case 'movement_slow':
                                if (ability.name == 'brewmaster_drunken_haze' || ability.name == 'brewmaster_thunder_clap') {
                                    totalAttribute -= self.getAbilityAttributeValue(self._abilities[i].attributes, attribute.name, ability.level())/100;
                                }
                                else if (ability.name == 'ursa_earthshock' || ability.name == 'treant_leech_seed') {
                                    totalAttribute += self.getAbilityAttributeValue(self._abilities[i].attributes, attribute.name, ability.level())/100;
                                }
                            break;
                            // skeleton_king_reincarnation
                            case 'movespeed':
                                if (ability.name == 'skeleton_king_reincarnation') {
                                    totalAttribute += self.getAbilityAttributeValue(self._abilities[i].attributes, attribute.name, ability.level())/100;
                                }
                            break;
                            // kunkka_torrent,visage_grave_chill
                            case 'movespeed_bonus':
                                if (ability.name == 'kunkka_torrent') {
                                    totalAttribute += self.getAbilityAttributeValue(self._abilities[i].attributes, attribute.name, ability.level())/100;
                                }
                                else if (ability.name == 'visage_grave_chill') {
                                    totalAttribute -= self.getAbilityAttributeValue(self._abilities[i].attributes, attribute.name, ability.level())/100;
                                }
                            break;
                        }
                    }
                    if (ability.name == 'satyr_trickster_purge') {
                        totalAttribute -= 80/100;
                    }
                    else if (ability.name == 'enraged_wildkin_tornado') {
                        totalAttribute -= 15/100;
                    }
                }
                else if (ability.movementSpeedPctReduction != undefined) {
                    // axe_battle_hunger,batrider_sticky_napalm,shredder_chakram,meepo_geostrike,life_stealer_open_wounds,
                    // venomancer_poison_sting,viper_viper_strike,viper_corrosive_skin,viper_poison_attack,venomancer_venomous_gale,treant_leech_seed
                    // lich_chain_frost,sniper_shrapnel,centaur_stampede,huskar_life_break,jakiro_dual_breath,meepo_geostrike,sandking_epicenter
                    // earth_spirit_rolling_boulder,invoker_ghost_walk,invoker_ice_wall,elder_titan_earth_splitter
                    // undying_flesh_golem,templar_assassin_psionic_trap,nevermore_requiem,queenofpain_shadow_strike
                    totalAttribute+=ability.movementSpeedPctReduction()/100;
                }
            }
        }
        return totalAttribute;
    });

    self.getTurnRateReduction = ko.computed(function () {
        var totalAttribute = 0;
        for (var i = 0; i < self.abilities().length; i++) {
            var ability = self._abilities[i];
            if (ability.level() > 0 && (ability.isActive() || (ability.behavior.indexOf('DOTA_ABILITY_BEHAVIOR_PASSIVE') != -1))) {
                if (!(ability.name in self.abilityData)) {
                    for (var j = 0; j < self._abilities[i].attributes.length; j++) {
                        var attribute = self._abilities[i].attributes[j];
                        switch(attribute.name) {
                            // medusa_stone_gaze
                            case 'slow':
                                if (ability.name == 'medusa_stone_gaze') {
                                    totalAttribute -= self.getAbilityAttributeValue(self._abilities[i].attributes, attribute.name, ability.level())/100;
                                }
                            break;
                        }
                    }
                }
                else if (ability.turnRateReduction != undefined) {
                    // batrider_sticky_napalm
                    totalAttribute+=ability.turnRateReduction()/100;
                }
            }
        }
        return totalAttribute;
    });
    
    self.getVisionRangeNight = ko.computed(function () {
        var totalAttribute = 0;
        for (var i = 0; i < self.abilities().length; i++) {
            var ability = self._abilities[i];
            if (ability.level() > 0 && (ability.isActive() || (ability.behavior.indexOf('DOTA_ABILITY_BEHAVIOR_PASSIVE') != -1))) {
                if (!(ability.name in self.abilityData)) {
                    for (var j = 0; j < self._abilities[i].attributes.length; j++) {
                        var attribute = self._abilities[i].attributes[j];
                        switch(attribute.name) {
                            // winter_wyvern_arctic_burn
                            case 'night_vision_bonus':
                            // lycan_shapeshift,luna_lunar_blessing
                            case 'bonus_night_vision':
                                totalAttribute += self.getAbilityAttributeValue(self._abilities[i].attributes, attribute.name, ability.level());
                            break;
                        }
                    }
                }
                else if (ability.visionnight != undefined) {
                    // 
                    totalAttribute+=ability.visionnight();
                }
            }
        }
        return totalAttribute;
    });

    self.getVisionRangePctReduction = ko.computed(function () {
        var totalAttribute = 0;
        for (var i = 0; i < self.abilities().length; i++) {
            var ability = self._abilities[i];
            if (ability.level() > 0 && (ability.isActive() || (ability.behavior.indexOf('DOTA_ABILITY_BEHAVIOR_PASSIVE') != -1))) {
                if (!(ability.name in self.abilityData)) {
                    for (var j = 0; j < self._abilities[i].attributes.length; j++) {
                        var attribute = self._abilities[i].attributes[j];
                        switch(attribute.name) {
                            // night_stalker_darkness
                            case 'blind_percentage':
                                totalAttribute += self.getAbilityAttributeValue(self._abilities[i].attributes, attribute.name, ability.level())/100;
                            break;
                        }
                    }
                }
            }
        }
        return totalAttribute;
    });

    self.setEvasion = ko.computed(function () {
        var totalAttribute = 0;
        for (var i = 0; i < self.abilities().length; i++) {
            var ability = self._abilities[i];
            if (ability.level() > 0 && (ability.isActive() || (ability.behavior.indexOf('DOTA_ABILITY_BEHAVIOR_PASSIVE') != -1))) {
                if (ability.name == 'windrunner_windrun') {
                    return 1;
                }
            }
        }
        return totalAttribute;
    });
    
    self.setMovementSpeed = ko.computed(function () {
        var MAX_MOVESPEED = 522;
        var MIN_MOVESPEED = 100;
        var totalAttribute = 0;
        for (var i = 0; i < self.abilities().length; i++) {
            var ability = self._abilities[i];
            if (ability.level() > 0 && (ability.isActive() || (ability.behavior.indexOf('DOTA_ABILITY_BEHAVIOR_PASSIVE') != -1))) {
                if (ability.name == 'spirit_breaker_charge_of_darkness') {
                    return self.getAbilityAttributeValue(ability.attributes, 'movement_speed', ability.level());
                }
                if (ability.name == 'dark_seer_surge') {
                    return MAX_MOVESPEED;
                }
                if (ability.name == 'centaur_stampede') {
                    return MAX_MOVESPEED;
                }
                if (ability.name == 'lycan_shapeshift') {
                    return MAX_MOVESPEED;
                }
                if (ability.name == 'lion_voodoo' || ability.name == 'shadow_shaman_voodoo') {
                    return MIN_MOVESPEED;
                }
            }
        }
        return totalAttribute;
    });

    self.getBashSource = function (attacktype) {
        var sources = {};
        for (var i = 0; i < self.abilities().length; i++) {
            var ability = self._abilities[i];
            if (ability.level() > 0 && (ability.isActive() || (ability.behavior.indexOf('DOTA_ABILITY_BEHAVIOR_PASSIVE') != -1))) {
                if (!(ability.name in self.abilityData)) {
                    for (var j = 0; j < self._abilities[i].attributes.length; j++) {
                        var attribute = self._abilities[i].attributes[j];
                        switch(attribute.name) {
                            // sniper_headshot
                            case 'proc_chance':
                                if (sources[ability.name] == undefined && ability.name == 'sniper_headshot') {
                                    sources[ability.name] = {
                                        'chance': self.getAbilityAttributeValue(ability.attributes, attribute.name, ability.level())/100,
                                        'damage': self.getAbilityPropertyValue(ability, 'damage'),
                                        'count': 1,
                                        'damageType': 'physical',
                                        'displayname': ability.displayname
                                    }
                                }
                            break;
                            // slardar_bash
                            case 'chance':
                                if (sources[ability.name] == undefined && ability.name == 'slardar_bash') {
                                    sources[ability.name] = {
                                        'chance': self.getAbilityAttributeValue(ability.attributes, attribute.name, ability.level())/100,
                                        'damage': self.getAbilityAttributeValue(ability.attributes, 'bonus_damage', ability.level()),
                                        'count': 1,
                                        'damageType': 'physical',
                                        'displayname': ability.displayname
                                    }
                                }
                            break;
                        }
                    }
                }
                else if (ability.bashBonusDamage != undefined) {
                    // faceless_void_time_lock
                    if (sources[ability.name] == undefined && ability.name == 'faceless_void_time_lock') {
                        sources[ability.name] = {
                            'chance': ability.bash()/100,
                            'damage': ability.bashBonusDamage(),
                            'count': 1,
                            'damageType': 'magic',
                            'displayname': ability.displayname
                        }
                    }
                    // spirit_breaker_greater_bash
                    if (sources[ability.name] == undefined && ability.name == 'spirit_breaker_greater_bash') {
                        sources[ability.name] = {
                            'chance': ability.bash()/100,
                            'damage': ability.bashBonusDamage()/100,
                            'count': 1,
                            'damageType': 'magic',
                            'displayname': ability.displayname
                        }
                    }
                }
            }
        }

        return sources;
    };
    
    self.getOrbSource = function () {
        var sources = {};
        for (var i = 0; i < self.abilities().length; i++) {
            var ability = self._abilities[i];
            if (ability.level() > 0 && (ability.isActive() || (ability.behavior.indexOf('DOTA_ABILITY_BEHAVIOR_PASSIVE') != -1))) {
                if (!(ability.name in self.abilityData)) {
                    for (var j = 0; j < self._abilities[i].attributes.length; j++) {
                        var attribute = self._abilities[i].attributes[j];
                        switch(attribute.name) {
                            // antimage_mana_break
                            case 'mana_per_hit':
                                if (sources[ability.name] == undefined && ability.name == 'antimage_mana_break') {
                                    sources[ability.name] = {
                                        'damage': self.getAbilityAttributeValue(ability.attributes, attribute.name, ability.level()) 
                                                * self.getAbilityAttributeValue(ability.attributes, 'damage_per_burn', ability.level()),
                                        'damageType': 'physical',
                                        'displayname': ability.displayname
                                    }
                                }
                            break;
                            // clinkz_searing_arrows
                            case 'damage_bonus':
                                if (sources[ability.name] == undefined && ability.name == 'clinkz_searing_arrows') {
                                    sources[ability.name] = {
                                        'damage': self.getAbilityAttributeValue(ability.attributes, attribute.name, ability.level()),
                                        'damageType': 'physical',
                                        'displayname': ability.displayname
                                    }
                                }
                            // silencer_glaives_of_wisdom
                            case 'intellect_damage_pct':
                                if (sources[ability.name] == undefined && ability.name == 'silencer_glaives_of_wisdom') {
                                    sources[ability.name] = {
                                        'damage': self.getAbilityAttributeValue(ability.attributes, attribute.name, ability.level())/100 * self.hero.totalInt(),
                                        'damageType': 'pure',
                                        'displayname': ability.displayname
                                    }
                                }
                            break;
                        }
                    }
                }
                else if (ability.bonusDamageOrb != undefined) {
                    // obsidian_destroyer_arcane_orb
                    if (sources[ability.name] == undefined && ability.name == 'obsidian_destroyer_arcane_orb') {
                        sources[ability.name] = {
                            'damage': ability.bonusDamageOrb(),
                            'damageType': 'pure',
                            'displayname': ability.displayname
                        }
                    }
                }
            }
        }
        
        return sources;
    };
    
    self.toggleAbility = function (index, data, event) {
        if (self.abilities()[index()].behavior.indexOf('DOTA_ABILITY_BEHAVIOR_PASSIVE') < 0) {
            if (self.abilities()[index()].isActive()) {
                self.abilities()[index()].isActive(false);
            }
            else {
                self.abilities()[index()].isActive(true);
            }
            
            if (self.abilities()[index()].name == 'lycan_shapeshift') {
                self.isShapeShiftActive(self.abilities()[index()].isActive());
            }
        }
    }.bind(this);

    self.toggleAbilityDetail = function (index, data, event) {
        if (self.abilities()[index()].isDetail()) {
            self.abilities()[index()].isDetail(false);
        }
        else {
            self.abilities()[index()].isDetail(true);
        }
    }.bind(this);
    
    self.getAbility = function (abilityName) {
        return self.abilities().find(function(b) {
            return b.name == abilityName;
        });
    }
}

AbilityModel.prototype.levelUpAbility = function (index, data, event, hero) {
    var self = this;
    if (self.abilities()[index()].level() < hero.getAbilityLevelMax(data) && hero.availableSkillPoints() > 0 ) {
        switch(self.abilities()[index()].abilitytype) {
            case 'DOTA_ABILITY_TYPE_ULTIMATE':
                if (hero.heroId() == 'invoker') {
                    if (
                        (self.abilities()[index()].level() == 0) && (parseInt(hero.selectedHeroLevel()) >= 2) ||
                        (self.abilities()[index()].level() == 1) && (parseInt(hero.selectedHeroLevel()) >= 7) ||
                        (self.abilities()[index()].level() == 2) && (parseInt(hero.selectedHeroLevel()) >= 11) ||
                        (self.abilities()[index()].level() == 3) && (parseInt(hero.selectedHeroLevel()) >= 17)
                    ) {
                        self.abilities()[index()].level(self.abilities()[index()].level()+1);
                        hero.skillPointHistory.push(index());
                    }
                }
                else if (hero.heroId() == 'meepo') {
                    if (self.abilities()[index()].level() * 7 + 3 <= parseInt(hero.selectedHeroLevel())) {
                        self.abilities()[index()].level(self.abilities()[index()].level()+1);
                        hero.skillPointHistory.push(index());
                    }
                }
                else {
                    if ((self.abilities()[index()].level()+1) * 5 + 1 <= parseInt(hero.selectedHeroLevel())) {
                        self.abilities()[index()].level(self.abilities()[index()].level()+1);
                        hero.skillPointHistory.push(index());
                    }
                }
            break;
            default:
                if (self.abilities()[index()].level() * 2 + 1 <= parseInt(hero.selectedHeroLevel())) {
                    self.abilities()[index()].level(self.abilities()[index()].level()+1);
                    hero.skillPointHistory.push(index());
                }
            break;
        }
        switch (self.abilities()[index()].name) {
            case 'beastmaster_call_of_the_wild':
            case 'chen_test_of_faith':
            case 'morphling_morph_agi':
            case 'shadow_demon_shadow_poison':
                self.abilities()[index() + 1].level(self.abilities()[index()].level());
            break;
            case 'morphling_morph_str':
                self.abilities()[index() - 1].level(self.abilities()[index()].level());
            break;
            case 'keeper_of_the_light_spirit_form':
                self.abilities()[index() - 1].level(self.abilities()[index()].level());
                self.abilities()[index() - 2].level(self.abilities()[index()].level());
            break;
            case 'nevermore_shadowraze1':
                self.abilities()[index() + 1].level(self.abilities()[index()].level());
                self.abilities()[index() + 2].level(self.abilities()[index()].level());
            break;
            case 'nevermore_shadowraze2':
                self.abilities()[index() - 1].level(self.abilities()[index()].level());
                self.abilities()[index() + 1].level(self.abilities()[index()].level());
            break;
            case 'nevermore_shadowraze3':
                self.abilities()[index() - 1].level(self.abilities()[index()].level());
                self.abilities()[index() - 2].level(self.abilities()[index()].level());
            break;
            case 'ember_spirit_fire_remnant':
                self.abilities()[index() - 1].level(self.abilities()[index()].level());
            break;
            case 'lone_druid_true_form':
                self.abilities()[index() - 1].level(self.abilities()[index()].level());
            break;
        }
    }
};
AbilityModel.prototype.levelDownAbility = function (index, data, event, hero) {
    var i = ko.utils.unwrapObservable(index);
    var self = this;
    if (self.abilities()[i].level() > 0) {
        self.abilities()[i].level(self.abilities()[i].level() - 1);
        hero.skillPointHistory.splice(hero.skillPointHistory().lastIndexOf(i), 1);
        switch (self.abilities()[i].name) {
            case 'beastmaster_call_of_the_wild':
            case 'chen_test_of_faith':
            case 'morphling_morph_agi':
            case 'shadow_demon_shadow_poison':
                self.abilities()[i + 1].level(self.abilities()[i].level());
            break;
            case 'morphling_morph_str':
                self.abilities()[i - 1].level(self.abilities()[i].level());
            break;
            case 'keeper_of_the_light_spirit_form':
                self.abilities()[i - 1].level(self.abilities()[i].level());
                self.abilities()[i - 2].level(self.abilities()[i].level());
            break;
            case 'nevermore_shadowraze1':
                self.abilities()[i + 1].level(self.abilities()[i].level());
                self.abilities()[i + 2].level(self.abilities()[i].level());
            break;
            case 'nevermore_shadowraze2':
                self.abilities()[i - 1].level(self.abilities()[i].level());
                self.abilities()[i + 1].level(self.abilities()[i].level());
            break;
            case 'nevermore_shadowraze3':
                self.abilities()[i - 1].level(self.abilities()[i].level());
                self.abilities()[i - 2].level(self.abilities()[i].level());
            break;
            case 'ember_spirit_fire_remnant':
                self.abilities()[i - 1].level(self.abilities()[i].level());
            break;
            case 'lone_druid_true_form':
                self.abilities()[i - 1].level(self.abilities()[i].level());
            break;
        }
    }
};
AbilityModel.prototype.getAbilityAttributeValue = function (attributes, attributeName, level) {
    for (var i=0; i < attributes.length; i++) {
        if (attributes[i].name == attributeName) {
            if (level == 0) {
                return parseFloat(attributes[i].value[0]);
            }
            else if (level > attributes[i].value.length) {
                return parseFloat(attributes[i].value[0]);
            }
            else {
                return parseFloat(attributes[i].value[level-1]);
            }
        }
    }
}
AbilityModel.prototype.getAbilityAttributeTooltip = function (attributes, attributeName) {
    for (var i=0; i<attributes.length; i++) {
        if (attributes[i].name == attributeName) {
            if (attributes[i].hasOwnProperty('tooltip')) {
                var d = attributes[i].tooltip.replace(/\\n/g, '');
                return d;
            }
            else {
                return '';
            }
        }
    }
    return '';
}

module.exports = AbilityModel;
},{"./herocalc_abilitydata":20,"./herocalc_knockout":21}],2:[function(require,module,exports){
'use strict';
var ko = require('./herocalc_knockout');

var AbilityModel = require("./AbilityModel");
var InventoryViewModel = require("./inventory/InventoryViewModel");
var findWhere = require("./util/findWhere");
var buffOptionsArray = require("./buffs/buffOptionsArray");
var debuffOptionsArray = require("./buffs/debuffOptionsArray");

var BuffViewModel = function (itemData, a) {
    var self = this;
    AbilityModel.call(this, ko.observableArray([]));
    self.availableBuffs = ko.observableArray(buffOptionsArray.items);
    self.availableDebuffs = ko.observableArray(debuffOptionsArray.items);
    self.selectedBuff = ko.observable(self.availableBuffs()[0]);
    
    self.buffs = ko.observableArray([]);
    self.itemBuffs = new InventoryViewModel(itemData);
    
    self.addBuff = function (data, event) {
        if (findWhere(self.buffs(), { name: self.selectedBuff().buffName }) == undefined) {
            var a = JSON.parse(JSON.stringify(self.selectedBuff().abilityData));
            a.level = ko.observable(0);
            a.isActive = ko.observable(false);
            a.isDetail = ko.observable(false);
            a.baseDamage = ko.observable(0);
            a.bash = ko.observable(0);
            a.bashBonusDamage = ko.observable(0);
            a.bonusDamage = ko.observable(0);
            a.bonusDamageOrb = ko.observable(0);
            a.bonusDamagePct = ko.observable(0);
            a.bonusDamagePrecisionAura = ko.observable(0);
            a.bonusDamageReduction = ko.observable(0);
            a.bonusHealth = ko.observable(0);
            a.bonusStrength = ko.observable(0);
            a.bonusStrength2 = ko.observable(0);
            a.bonusAgility = ko.observable(0);
            a.bonusAgility2 = ko.observable(0);
            a.bonusInt = ko.observable(0);
            a.bonusAllStatsReduction = ko.observable(0);
            a.damageAmplification = ko.observable(0);
            a.damageReduction = ko.observable(0);
            a.evasion = ko.observable(0);
            a.magicResist = ko.observable(0);
            a.manaregen = ko.observable(0);
            a.manaregenreduction = ko.observable(0);
            a.missChance = ko.observable(0);
            a.movementSpeedFlat = ko.observable(0);
            a.movementSpeedPct = ko.observable(0);
            a.movementSpeedPctReduction = ko.observable(0);
            a.turnRateReduction = ko.observable(0);
            a.attackrange = ko.observable(0);
            a.attackspeed = ko.observable(0);
            a.attackspeedreduction = ko.observable(0);
            a.armor = ko.observable(0);
            a.armorReduction = ko.observable(0);
            a.healthregen = ko.observable(0);
            a.lifesteal = ko.observable(0);
            a.visionnight = ko.observable(0);
            a.visionday = ko.observable(0);
            switch (a.name) {
                case 'invoker_cold_snap':
                case 'invoker_ghost_walk':
                case 'invoker_tornado':
                case 'invoker_emp':
                case 'invoker_alacrity':
                case 'invoker_chaos_meteor':
                case 'invoker_sun_strike':
                case 'invoker_forge_spirit':
                case 'invoker_ice_wall':
                case 'invoker_deafening_blast':
                    a.level(1);
                break;
            }
            self.abilities.push(a);
            self.buffs.push({ name: self.selectedBuff().buffName, hero: self.selectedBuff().hero, data: a });
        }
    };
    
    self.removeBuff = function (data, event, abilityName) {
        if (findWhere(self.buffs(), { name: abilityName })  != undefined) {
                self.buffs.remove(findWhere(self.buffs(), { name: abilityName }));
                if (self.abilityControlData[abilityName] != undefined) {
                    for (var i = 0; i < self.abilityControlData[abilityName].data.length; i++) {
                        if (self.abilityControlData[abilityName].data[i].controlVal.dispose != undefined) {
                            self.abilityControlData[abilityName].data[i].controlVal.dispose();
                        }
                        if (self.abilityControlData[abilityName].data[i].clean != undefined) {
                            self.abilityControlData[abilityName].data[i].clean.dispose();
                        }
                    }
                    self.abilityControlData[abilityName] = undefined;
                }
                for (var i = 0; i < self.abilities().length; i++) {
                    if (self.abilities()[i].name == abilityName) {
                        self.abilities()[i].level(0);
                        self.abilities.remove(self.abilities()[i]);
                        break;
                    }
                }
        }
    };
    self.toggleBuff = function (index, data, event) {
        if (self.buffs()[index()].data.behavior.indexOf('DOTA_ABILITY_BEHAVIOR_PASSIVE') < 0) {
            if (self.buffs()[index()].data.isActive()) {
                self.buffs()[index()].data.isActive(false);
                self.abilities()[index()].isActive(false);
            }
            else {
                self.buffs()[index()].data.isActive(true);
                self.abilities()[index()].isActive(true);
            }
        }
    }.bind(this);

    self.toggleBuffDetail = function (index, data, event) {
        if (self.buffs()[index()].data.isDetail()) {
            self.buffs()[index()].data.isDetail(false);
        }
        else {
            self.buffs()[index()].data.isDetail(true);
        }
    }.bind(this);

    // Overrides the ability module function to remove available skill point check
    self.levelUpAbility = function (index, data, event, hero) {
        if (self.abilities()[index()].level() < hero.getAbilityLevelMax(data)) {
            switch(self.abilities()[index()].abilitytype) {
                case 'DOTA_ABILITY_TYPE_ULTIMATE':
                    self.abilities()[index()].level(self.abilities()[index()].level() + 1);
                break;
                default:
                    self.abilities()[index()].level(self.abilities()[index()].level() + 1);
                break;
            }
            switch (self.abilities()[index()].name) {
                case 'beastmaster_call_of_the_wild':
                case 'chen_test_of_faith':
                case 'morphling_morph_agi':
                case 'shadow_demon_shadow_poison':
                    self.abilities()[index() + 1].level(self.abilities()[index()].level());
                break;
                case 'morphling_morph_str':
                    self.abilities()[index() - 1].level(self.abilities()[index()].level());
                break;
                case 'keeper_of_the_light_spirit_form':
                    self.abilities()[index() - 1].level(self.abilities()[index()].level());
                    self.abilities()[index() - 2].level(self.abilities()[index()].level());
                case 'nevermore_shadowraze1':
                    self.abilities()[index() + 1].level(self.abilities()[index()].level());
                    self.abilities()[index() + 2].level(self.abilities()[index()].level());
                break;
                case 'nevermore_shadowraze2':
                    self.abilities()[index() - 1].level(self.abilities()[index()].level());
                    self.abilities()[index() + 1].level(self.abilities()[index()].level());
                break;
                case 'nevermore_shadowraze3':
                    self.abilities()[index() - 1].level(self.abilities()[index()].level());
                    self.abilities()[index() - 2].level(self.abilities()[index()].level());
                break;
            }
        }
    };
    self.levelDownAbility = function (index, data, event, hero) {
        if (self.abilities()[index()].level() > 0) {
            self.abilities()[index()].level(self.abilities()[index()].level() - 1);
            switch (self.abilities()[index()].name) {
                case 'beastmaster_call_of_the_wild':
                case 'chen_test_of_faith':
                case 'morphling_morph_agi':
                case 'shadow_demon_shadow_poison':
                    self.abilities()[index() + 1].level(self.abilities()[index()].level());
                break;
                case 'morphling_morph_str':
                    self.abilities()[index() - 1].level(self.abilities()[index()].level());
                break;
                case 'keeper_of_the_light_spirit_form':
                    self.abilities()[index() - 1].level(self.abilities()[index()].level());
                    self.abilities()[index() - 2].level(self.abilities()[index()].level());
                case 'nevermore_shadowraze1':
                    self.abilities()[index() + 1].level(self.abilities()[index()].level());
                    self.abilities()[index() + 2].level(self.abilities()[index()].level());
                break;
                case 'nevermore_shadowraze2':
                    self.abilities()[index() - 1].level(self.abilities()[index()].level());
                    self.abilities()[index() + 1].level(self.abilities()[index()].level());
                break;
                case 'nevermore_shadowraze3':
                    self.abilities()[index() - 1].level(self.abilities()[index()].level());
                    self.abilities()[index() - 2].level(self.abilities()[index()].level());
                break;
                case 'ember_spirit_fire_remnant':
                    self.abilities()[index() - 1].level(self.abilities()[index()].level());
                break;
                case 'lone_druid_true_form':
                    self.abilities()[index() - 1].level(self.abilities()[index()].level());
                break;
            }
        }
    };
    
    return self;
}
BuffViewModel.prototype = Object.create(AbilityModel.prototype);
BuffViewModel.prototype.constructor = BuffViewModel;

module.exports = BuffViewModel;
},{"./AbilityModel":1,"./buffs/buffOptionsArray":4,"./buffs/debuffOptionsArray":5,"./herocalc_knockout":21,"./inventory/InventoryViewModel":26,"./util/findWhere":37}],3:[function(require,module,exports){
var findWhere = require("../util/findWhere");

var BuffModel = function (heroData, unitData, hero, ability) {
    this.buffName = ability;
    if (heroData['npc_dota_hero_' + hero] == undefined) {
        this.hero = hero;
        this.abilityData = findWhere(unitData[hero].abilities, {name: ability})
        this.buffDisplayName = unitData[hero].displayname + ' - ' + this.abilityData.displayname;
    }
    else {
        this.hero = 'npc_dota_hero_' + hero;
        this.abilityData = findWhere(heroData['npc_dota_hero_' + hero].abilities, {name: ability})
        this.buffDisplayName = heroData['npc_dota_hero_' + hero].displayname + ' - ' + this.abilityData.displayname;        
        if (ability == 'sven_gods_strength') {
            this.buffDisplayName += ' (Aura for allies)';
        }
    }

};

module.exports = BuffModel;
},{"../util/findWhere":37}],4:[function(require,module,exports){
var BuffModel = require("./BuffModel");

var buffOptionsArray = {};

var init = function (heroData, unitData) {
    buffOptionsArray.items = [
        new BuffModel(heroData, unitData, 'abaddon', 'abaddon_frostmourne'),
        new BuffModel(heroData, unitData, 'axe', 'axe_culling_blade'),
        new BuffModel(heroData, unitData, 'beastmaster', 'beastmaster_inner_beast'),
        new BuffModel(heroData, unitData, 'bloodseeker', 'bloodseeker_bloodrage'),
        new BuffModel(heroData, unitData, 'bounty_hunter', 'bounty_hunter_track'),
        new BuffModel(heroData, unitData, 'centaur', 'centaur_stampede'),
        new BuffModel(heroData, unitData, 'crystal_maiden', 'crystal_maiden_brilliance_aura'),
        new BuffModel(heroData, unitData, 'dark_seer', 'dark_seer_surge'),
        new BuffModel(heroData, unitData, 'dazzle', 'dazzle_weave'),
        new BuffModel(heroData, unitData, 'drow_ranger', 'drow_ranger_trueshot'),
        new BuffModel(heroData, unitData, 'invoker', 'invoker_alacrity'),
        new BuffModel(heroData, unitData, 'wisp', 'wisp_tether'),
        new BuffModel(heroData, unitData, 'wisp', 'wisp_overcharge'),
        new BuffModel(heroData, unitData, 'kunkka', 'kunkka_ghostship'),
        new BuffModel(heroData, unitData, 'lich', 'lich_frost_armor'),
        new BuffModel(heroData, unitData, 'life_stealer', 'life_stealer_open_wounds'),
        new BuffModel(heroData, unitData, 'luna', 'luna_lunar_blessing'),
        new BuffModel(heroData, unitData, 'lycan', 'lycan_howl'),
        new BuffModel(heroData, unitData, 'magnataur', 'magnataur_empower'),
        new BuffModel(heroData, unitData, 'mirana', 'mirana_leap'),
        new BuffModel(heroData, unitData, 'ogre_magi', 'ogre_magi_bloodlust'),
        new BuffModel(heroData, unitData, 'omniknight', 'omniknight_guardian_angel'),
        new BuffModel(heroData, unitData, 'rubick', 'rubick_null_field'),
        new BuffModel(heroData, unitData, 'skeleton_king', 'skeleton_king_vampiric_aura'),
        new BuffModel(heroData, unitData, 'spirit_breaker', 'spirit_breaker_empowering_haste'),
        new BuffModel(heroData, unitData, 'sven', 'sven_warcry'),
        new BuffModel(heroData, unitData, 'sven', 'sven_gods_strength'),
        new BuffModel(heroData, unitData, 'treant', 'treant_living_armor'),
        new BuffModel(heroData, unitData, 'troll_warlord', 'troll_warlord_battle_trance'),
        new BuffModel(heroData, unitData, 'vengefulspirit', 'vengefulspirit_command_aura'),
        new BuffModel(heroData, unitData, 'npc_dota_neutral_alpha_wolf', 'alpha_wolf_critical_strike'),
        new BuffModel(heroData, unitData, 'npc_dota_neutral_alpha_wolf', 'alpha_wolf_command_aura'),
        new BuffModel(heroData, unitData, 'npc_dota_neutral_polar_furbolg_ursa_warrior', 'centaur_khan_endurance_aura'),
        new BuffModel(heroData, unitData, 'npc_dota_neutral_giant_wolf', 'giant_wolf_critical_strike'),
        new BuffModel(heroData, unitData, 'npc_dota_neutral_kobold_taskmaster', 'kobold_taskmaster_speed_aura'),
        new BuffModel(heroData, unitData, 'npc_dota_neutral_ogre_magi', 'ogre_magi_frost_armor'),
        new BuffModel(heroData, unitData, 'npc_dota_neutral_satyr_hellcaller', 'satyr_hellcaller_unholy_aura'),
        new BuffModel(heroData, unitData, 'npc_dota_neutral_enraged_wildkin', 'enraged_wildkin_toughness_aura'),
        new BuffModel(heroData, unitData, 'npc_dota_necronomicon_archer_1', 'necronomicon_archer_aoe')
    ];
    return buffOptionsArray.items;
}

buffOptionsArray.init = init;

module.exports = buffOptionsArray;
},{"./BuffModel":3}],5:[function(require,module,exports){
var BuffModel = require("./BuffModel");

var debuffOptionsArray = {};

var init = function (heroData, unitData) {
    debuffOptionsArray.items = [
        new BuffModel(heroData, unitData, 'abaddon', 'abaddon_frostmourne'),
        new BuffModel(heroData, unitData, 'alchemist', 'alchemist_acid_spray'),
        new BuffModel(heroData, unitData, 'ancient_apparition', 'ancient_apparition_ice_vortex'),
        new BuffModel(heroData, unitData, 'axe', 'axe_battle_hunger'),
        new BuffModel(heroData, unitData, 'bane', 'bane_enfeeble'),
        new BuffModel(heroData, unitData, 'batrider', 'batrider_sticky_napalm'),
        new BuffModel(heroData, unitData, 'beastmaster', 'beastmaster_primal_roar'),
        new BuffModel(heroData, unitData, 'bounty_hunter', 'bounty_hunter_jinada'),
        new BuffModel(heroData, unitData, 'brewmaster', 'brewmaster_thunder_clap'),
        new BuffModel(heroData, unitData, 'brewmaster', 'brewmaster_drunken_haze'),
        new BuffModel(heroData, unitData, 'bristleback', 'bristleback_viscous_nasal_goo'),
        new BuffModel(heroData, unitData, 'broodmother', 'broodmother_incapacitating_bite'),
        new BuffModel(heroData, unitData, 'centaur', 'centaur_stampede'),
        new BuffModel(heroData, unitData, 'chen', 'chen_penitence'),
        new BuffModel(heroData, unitData, 'crystal_maiden', 'crystal_maiden_crystal_nova'),
        new BuffModel(heroData, unitData, 'crystal_maiden', 'crystal_maiden_freezing_field'),
        new BuffModel(heroData, unitData, 'dazzle', 'dazzle_weave'),
        new BuffModel(heroData, unitData, 'drow_ranger', 'drow_ranger_frost_arrows'),
        new BuffModel(heroData, unitData, 'earth_spirit', 'earth_spirit_rolling_boulder'),
        new BuffModel(heroData, unitData, 'elder_titan', 'elder_titan_natural_order'),
        new BuffModel(heroData, unitData, 'elder_titan', 'elder_titan_earth_splitter'),
        new BuffModel(heroData, unitData, 'enchantress', 'enchantress_untouchable'),
        new BuffModel(heroData, unitData, 'enchantress', 'enchantress_enchant'),
        new BuffModel(heroData, unitData, 'faceless_void', 'faceless_void_time_walk'),
        new BuffModel(heroData, unitData, 'huskar', 'huskar_life_break'),
        new BuffModel(heroData, unitData, 'invoker', 'invoker_ghost_walk'),
        new BuffModel(heroData, unitData, 'invoker', 'invoker_ice_wall'),
        new BuffModel(heroData, unitData, 'wisp', 'wisp_tether'),
        new BuffModel(heroData, unitData, 'jakiro', 'jakiro_dual_breath'),
        new BuffModel(heroData, unitData, 'jakiro', 'jakiro_liquid_fire'),
        new BuffModel(heroData, unitData, 'keeper_of_the_light', 'keeper_of_the_light_blinding_light'),
        new BuffModel(heroData, unitData, 'kunkka', 'kunkka_torrent'),
        new BuffModel(heroData, unitData, 'lich', 'lich_frost_nova'),
        new BuffModel(heroData, unitData, 'lich', 'lich_frost_armor'),
        new BuffModel(heroData, unitData, 'lich', 'lich_chain_frost'),
        new BuffModel(heroData, unitData, 'life_stealer', 'life_stealer_open_wounds'),
        new BuffModel(heroData, unitData, 'lion', 'lion_voodoo'),
        new BuffModel(heroData, unitData, 'magnataur', 'magnataur_skewer'),
        new BuffModel(heroData, unitData, 'medusa', 'medusa_stone_gaze'),
        new BuffModel(heroData, unitData, 'meepo', 'meepo_geostrike'),
        new BuffModel(heroData, unitData, 'naga_siren', 'naga_siren_rip_tide'),
        new BuffModel(heroData, unitData, 'night_stalker', 'night_stalker_void'),
        new BuffModel(heroData, unitData, 'night_stalker', 'night_stalker_crippling_fear'),
        new BuffModel(heroData, unitData, 'night_stalker', 'night_stalker_darkness'),
        new BuffModel(heroData, unitData, 'ogre_magi', 'ogre_magi_ignite'),
        new BuffModel(heroData, unitData, 'omniknight', 'omniknight_degen_aura'),
        new BuffModel(heroData, unitData, 'phantom_assassin', 'phantom_assassin_stifling_dagger'),
        new BuffModel(heroData, unitData, 'phantom_lancer', 'phantom_lancer_spirit_lance'),
        new BuffModel(heroData, unitData, 'pudge', 'pudge_rot'),
        new BuffModel(heroData, unitData, 'pugna', 'pugna_decrepify'),
        new BuffModel(heroData, unitData, 'queenofpain', 'queenofpain_shadow_strike'),
        new BuffModel(heroData, unitData, 'riki', 'riki_smoke_screen'),
        new BuffModel(heroData, unitData, 'rubick', 'rubick_fade_bolt'),
        new BuffModel(heroData, unitData, 'sand_king', 'sandking_epicenter'),
        new BuffModel(heroData, unitData, 'nevermore', 'nevermore_dark_lord'),
        new BuffModel(heroData, unitData, 'shadow_shaman', 'shadow_shaman_voodoo'),
        new BuffModel(heroData, unitData, 'skeleton_king', 'skeleton_king_hellfire_blast'),
        new BuffModel(heroData, unitData, 'skeleton_king', 'skeleton_king_reincarnation'),
        new BuffModel(heroData, unitData, 'skywrath_mage', 'skywrath_mage_concussive_shot'),
        new BuffModel(heroData, unitData, 'skywrath_mage', 'skywrath_mage_ancient_seal'),
        new BuffModel(heroData, unitData, 'slardar', 'slardar_slithereen_crush'),
        new BuffModel(heroData, unitData, 'slardar', 'slardar_amplify_damage'),
        new BuffModel(heroData, unitData, 'slark', 'slark_essence_shift'),
        new BuffModel(heroData, unitData, 'sniper', 'sniper_shrapnel'),
        new BuffModel(heroData, unitData, 'spectre', 'spectre_spectral_dagger'),
        new BuffModel(heroData, unitData, 'storm_spirit', 'storm_spirit_overload'),
        new BuffModel(heroData, unitData, 'templar_assassin', 'templar_assassin_meld'),
        new BuffModel(heroData, unitData, 'tidehunter', 'tidehunter_gush'),
        new BuffModel(heroData, unitData, 'tinker', 'tinker_laser'),
        new BuffModel(heroData, unitData, 'treant', 'treant_leech_seed'),
        new BuffModel(heroData, unitData, 'tusk', 'tusk_frozen_sigil'),
        new BuffModel(heroData, unitData, 'undying', 'undying_flesh_golem'),
        new BuffModel(heroData, unitData, 'ursa', 'ursa_earthshock'),
        new BuffModel(heroData, unitData, 'vengefulspirit', 'vengefulspirit_wave_of_terror'),
        new BuffModel(heroData, unitData, 'vengefulspirit', 'vengefulspirit_command_aura'),
        new BuffModel(heroData, unitData, 'venomancer', 'venomancer_venomous_gale'),
        new BuffModel(heroData, unitData, 'venomancer', 'venomancer_poison_sting'),
        new BuffModel(heroData, unitData, 'viper', 'viper_poison_attack'),
        new BuffModel(heroData, unitData, 'viper', 'viper_corrosive_skin'),
        new BuffModel(heroData, unitData, 'viper', 'viper_viper_strike'),
        new BuffModel(heroData, unitData, 'visage', 'visage_grave_chill'),
        new BuffModel(heroData, unitData, 'warlock', 'warlock_upheaval'),
        new BuffModel(heroData, unitData, 'weaver', 'weaver_the_swarm'),
        new BuffModel(heroData, unitData, 'windrunner', 'windrunner_windrun'),
        new BuffModel(heroData, unitData, 'winter_wyvern', 'winter_wyvern_arctic_burn'),
        new BuffModel(heroData, unitData, 'winter_wyvern', 'winter_wyvern_splinter_blast'),
        new BuffModel(heroData, unitData, 'npc_dota_neutral_ghost', 'ghost_frost_attack'),
        new BuffModel(heroData, unitData, 'npc_dota_neutral_polar_furbolg_ursa_warrior', 'polar_furbolg_ursa_warrior_thunder_clap'),
        new BuffModel(heroData, unitData, 'npc_dota_neutral_ogre_magi', 'ogre_magi_frost_armor'),
        new BuffModel(heroData, unitData, 'npc_dota_neutral_satyr_trickster', 'satyr_trickster_purge'),
        new BuffModel(heroData, unitData, 'npc_dota_neutral_enraged_wildkin', 'enraged_wildkin_tornado')
    ];
    return debuffOptionsArray.items;
}

debuffOptionsArray.init = init;

module.exports = debuffOptionsArray;
},{"./BuffModel":3}],6:[function(require,module,exports){
(function (global){
var HeroCalcData = (typeof window !== "undefined" ? window['HeroCalcData'] : typeof global !== "undefined" ? global['HeroCalcData'] : null) || {};
var getJSON = require("../util/getJSON");
var isEmpty = require("../util/isEmpty");
var extend = function(out) {
  out = out || {};

  for (var i = 1; i < arguments.length; i++) {
    if (!arguments[i])
      continue;

    for (var key in arguments[i]) {
      if (arguments[i].hasOwnProperty(key))
        out[key] = arguments[i][key];
    }
  }

  return out;
};

var resourceCounter = 0;

var onResourceLoaded = function (callback) {
    resourceCounter--;
    if (resourceCounter === 0) {
        fixHeroData(HeroCalcData.heroData);
        if (callback) callback();
    }
}

var fixHeroData = function (heroData) {
    heroData['npc_dota_hero_invoker'].abilities[5].behavior.push('DOTA_ABILITY_BEHAVIOR_NOT_LEARNABLE');
    heroData['npc_dota_hero_chen'].abilities[2].behavior.push('DOTA_ABILITY_BEHAVIOR_NOT_LEARNABLE');
    heroData['npc_dota_hero_nevermore'].abilities[1].behavior.push('DOTA_ABILITY_BEHAVIOR_NOT_LEARNABLE');
    heroData['npc_dota_hero_nevermore'].abilities[2].behavior.push('DOTA_ABILITY_BEHAVIOR_NOT_LEARNABLE');
    heroData['npc_dota_hero_morphling'].abilities[3].behavior.push('DOTA_ABILITY_BEHAVIOR_NOT_LEARNABLE');
    heroData['npc_dota_hero_ogre_magi'].abilities[3].behavior.push('DOTA_ABILITY_BEHAVIOR_NOT_LEARNABLE');
    heroData['npc_dota_hero_techies'].abilities[4].behavior.push('DOTA_ABILITY_BEHAVIOR_NOT_LEARNABLE');
    heroData['npc_dota_hero_beastmaster'].abilities[2].behavior.push('DOTA_ABILITY_BEHAVIOR_NOT_LEARNABLE');

    var index = heroData['npc_dota_hero_lone_druid'].abilities[3].behavior.indexOf('DOTA_ABILITY_BEHAVIOR_HIDDEN');
    heroData['npc_dota_hero_lone_druid'].abilities[3].behavior.splice(index, 1);

    index = heroData['npc_dota_hero_abaddon'].abilities[2].behavior.indexOf('DOTA_ABILITY_BEHAVIOR_PASSIVE');
    heroData['npc_dota_hero_abaddon'].abilities[2].behavior.splice(index, 1);

    index = heroData['npc_dota_hero_riki'].abilities[2].behavior.indexOf('DOTA_ABILITY_BEHAVIOR_PASSIVE');
    heroData['npc_dota_hero_riki'].abilities[2].behavior.splice(index, 1);
}

var init = function (HERODATA_PATH, ITEMDATA_PATH, UNITDATA_PATH, callback) {
    resourceCounter = 3;
    
    if (!HeroCalcData.heroData || isEmpty(HeroCalcData.heroData)) {
        if (HERODATA_PATH) {
            getJSON(HERODATA_PATH, function (data) {
                HeroCalcData.heroData = data;
                onResourceLoaded(callback);
            });
        }
    }
    else {
        onResourceLoaded(callback);
    }
    
    if (!HeroCalcData.itemData || isEmpty(HeroCalcData.itemData)) {
        if (ITEMDATA_PATH) {
            getJSON(ITEMDATA_PATH, function (data) {
                HeroCalcData.itemData = data;
                onResourceLoaded(callback);
            });
        }
    }
    else {
        onResourceLoaded(callback);
    }
    
    if (!HeroCalcData.unitData || isEmpty(HeroCalcData.unitData)) {
        if (UNITDATA_PATH) {
            getJSON(UNITDATA_PATH, function (data) {
                HeroCalcData.unitData = data;
                onResourceLoaded(callback);
            });
        }
    }
    else {
        onResourceLoaded(callback);
    }
}
    
HeroCalcData.init = init;

module.exports = HeroCalcData;
}).call(this,typeof global !== "undefined" ? global : typeof self !== "undefined" ? self : typeof window !== "undefined" ? window : {})

},{"../util/getJSON":38,"../util/isEmpty":39}],7:[function(require,module,exports){
'use strict';
var HeroModel = require("./HeroModel");

var CloneModel = function (heroData, itemData, h,p) {
    var self = this;
    HeroModel.call(this, heroData, itemData, h);
    self.parent = p;
    return self;
}
CloneModel.prototype = Object.create(HeroModel.prototype);
CloneModel.prototype.constructor = CloneModel;

module.exports = CloneModel;
},{"./HeroModel":10}],8:[function(require,module,exports){
var DamageTypeColor = {
    'physical': '#979aa2',
    'pure': 'goldenrod',
    'magic': '#428bca',
    'default': '#979aa2'
}

module.exports = DamageTypeColor;
},{}],9:[function(require,module,exports){
'use strict';
var ko = require('../herocalc_knockout');
    
var DamageTypeColor = require("./DamageTypeColor");
var extend = require("../util/extend");

var HeroDamageMixin = function (self, itemData) {
    self.critInfo = ko.pureComputed(function () {
        var critSources = self.inventory.getCritSource();
        extend(critSources, self.ability().getCritSource());
        extend(critSources, self.buffs.getCritSource());
        var critSourcesArray = [];
        for (var prop in critSources) {
            var el = critSources[prop];
            el.name = prop
            critSourcesArray.push(el);
        }
        function compareByMultiplier(a,b) {
            if (a.multiplier < b.multiplier)
                return 1;
            if (a.multiplier > b.multiplier)
                return -1;
            return 0;
        }

        critSourcesArray.sort(compareByMultiplier);
        
        var result = [];
        var critTotal = 0;
        for (var i = 0; i < critSourcesArray.length; i++) {
            var total = 1;
            for (var j = 0; j < i; j++) {
                for (var k = 0; k <critSourcesArray[j].count; k++) {
                    total *= (1 - critSourcesArray[j].chance);
                }
            }
            var total2 = 1;
            for (var k = 0; k < critSourcesArray[i].count; k++) {
                total2 *= (1 - critSourcesArray[i].chance);
            }
            total *= (1 - total2);
            critTotal += total;
            if (critSourcesArray[i].count > 1) {
                result.push({
                    'name':critSourcesArray[i].displayname + ' x' + critSourcesArray[i].count,
                    'chance':critSourcesArray[i].chance,
                    'multiplier':critSourcesArray[i].multiplier,
                    'count':critSourcesArray[i].count,
                    'totalChance':total
                });
            }
            else {
                result.push({
                    'name':critSourcesArray[i].displayname,
                    'chance':critSourcesArray[i].chance,
                    'multiplier':critSourcesArray[i].multiplier,
                    'count':critSourcesArray[i].count,
                    'totalChance':total
                });
            }
        }
        return { sources: result, total: critTotal };
    });

    self.cleaveInfo = ko.pureComputed(function () {
        var cleaveSources = self.inventory.getCleaveSource();
        extend(cleaveSources, self.ability().getCleaveSource());
        extend(cleaveSources, self.buffs.getCleaveSource());
        var cleaveSourcesArray = [];
        for (var prop in cleaveSources) {
            var el = cleaveSources[prop];
            el.name = prop
            cleaveSourcesArray.push(el);
        }
        function compareByRadius(a,b) {
            if (a.radius < b.radius)
                return 1;
            if (a.radius > b.radius)
                return -1;
            return 0;
        }

        cleaveSourcesArray.sort(compareByRadius);
        var cleaveSourcesByRadius = {};
        for (var i = 0; i < cleaveSourcesArray.length; i++) {
            var total = 0;
            for (var j = 0; j <cleaveSourcesArray.length; j++) {
                if (cleaveSourcesArray[j].radius >= cleaveSourcesArray[i].radius) {
                    total += cleaveSourcesArray[j].magnitude * cleaveSourcesArray[j].count;
                }
            }
            cleaveSourcesByRadius[cleaveSourcesArray[i].radius] = total;
        }
        var result = [];
        for (var prop in cleaveSourcesByRadius) {
            result.push({
                'radius':prop,
                'magnitude':cleaveSourcesByRadius[prop]
            });
        }
        return result;
    });
    
    self.bashInfo = ko.pureComputed(function () {
        var attacktype = self.heroData().attacktype;
        var bashSources = self.inventory.getBashSource(attacktype);
        extend(bashSources, self.ability().getBashSource());
        var bashSourcesArray = [];
        for (var prop in bashSources) {
            var el = bashSources[prop];
            el.name = prop
            bashSourcesArray.push(el);
        }
        function compareByDuration(a, b) {
            if (a.duration < b.duration)
                return 1;
            if (a.duration > b.duration)
                return -1;
            return 0;
        }

        //bashSourcesArray.sort(compareByDuration);
        
        var result = [];
        var bashTotal = 0;
        for (var i = 0;i < bashSourcesArray.length; i++) {
            var total = 1;
            for (var j = 0; j < i; j++) {
                for (var k = 0; k < bashSourcesArray[j].count; k++) {
                    total *= (1 - bashSourcesArray[j].chance);
                }
            }
            var total2 = 1;
            for (var k = 0; k < bashSourcesArray[i].count; k++) {
                total2 *= (1 - bashSourcesArray[i].chance);
            }
            total *= (1 - total2);
            bashTotal += total;
            if (bashSourcesArray[i].name === 'spirit_breaker_greater_bash') {
                var d = bashSourcesArray[i].damage * self.totalMovementSpeed();
            }
            else {
                var d = bashSourcesArray[i].damage;
            }
            if (bashSourcesArray[i].count > 1) {
                result.push({
                    'name':bashSourcesArray[i].displayname, // + ' x' + bashSourcesArray[i].count,
                    'chance':bashSourcesArray[i].chance,
                    'damage':d,
                    'count':bashSourcesArray[i].count,
                    'damageType':bashSourcesArray[i].damageType,
                    'totalChance':total
                });
            }
            else {
                result.push({
                    'name':bashSourcesArray[i].displayname,
                    'chance':bashSourcesArray[i].chance,
                    'damage':d,
                    'count':bashSourcesArray[i].count,
                    'damageType':bashSourcesArray[i].damageType,
                    'totalChance':total
                });
            }

        }
        return { sources: result, total: bashTotal };
    });
    
    self.orbProcInfo = ko.pureComputed(function () {
        var attacktype = self.heroData().attacktype;
        var damageSources = self.inventory.getOrbProcSource();
        var damageSourcesArray = [];
        for (var prop in damageSources) {
            var el = damageSources[prop];
            el.name = prop
            damageSourcesArray.push(el);
        }
        function compareByDamage(a, b) {
            if (a.priority > b.priority) {
                return 1;
            }
            if (a.priority < b.priority) {
                return -1;
            }
            if (a.damage < b.damage)
                return 1;
            if (a.damage > b.damage)
                return -1;
            return 0;
        }

        damageSourcesArray.sort(compareByDamage);
        
        var result = [];
        var damageTotal = 0;
        for (var i=0 ; i < damageSourcesArray.length; i++) {
            var total = 1;
            for (var j = 0; j < i; j++) {
                for (var k = 0; k < damageSourcesArray[j].count; k++) {
                    total *= (1 - damageSourcesArray[j].chance);
                }
            }
            var total2 = 1;
            for (var k = 0; k < damageSourcesArray[i].count; k++) {
                total2 *= (1 - damageSourcesArray[i].chance);
            }
            total *= (1 - total2);
            damageTotal += total;
            if (damageSourcesArray[i].count > 1) {
                result.push({
                    'name':damageSourcesArray[i].displayname + ' x' + damageSourcesArray[i].count,
                    'chance':damageSourcesArray[i].chance,
                    'damage':damageSourcesArray[i].damage,
                    'count':damageSourcesArray[i].count,
                    'damageType':damageSourcesArray[i].damageType,
                    'totalChance':total
                });
            }
            else {
                result.push({
                    'name':damageSourcesArray[i].displayname,
                    'chance':damageSourcesArray[i].chance,
                    'damage':damageSourcesArray[i].damage,
                    'count':damageSourcesArray[i].count,
                    'damageType':damageSourcesArray[i].damageType,
                    'totalChance':total
                });
            }
        }
        return { sources: result, total: damageTotal };
    });
    
    self.getReducedDamage = function (value, type) {
        var result = value;
        switch (type) {
            case 'physical':
                result = value * (1 - (0.06 * self.enemy().totalArmorPhysical()) / (1 + 0.06 * Math.abs(self.enemy().totalArmorPhysical())));
            break;
            case 'magic':
                result = value * (1 - self.enemy().totalMagicResistance() / 100);
            break;
            case 'pure':
                result = value;
            break;
            case 'composite':
                result = value * (1 - (0.06 * self.enemy().totalArmorPhysical()) / (1 + 0.06 * Math.abs(self.enemy().totalArmorPhysical())));
                result *= (1 - self.enemy().totalMagicResistance() / 100);
            break;
        }
        result *= self.ability().getDamageAmplification() * self.debuffs.getDamageAmplification();
        result *= self.enemy().ability().getDamageReduction() * self.enemy().buffs.getDamageReduction();
        return result;
    }
    
    self.damageTotalInfo = ko.pureComputed(function () {
        var bonusDamageArray = [
            self.ability().getBonusDamage().sources,
            self.buffs.getBonusDamage().sources
        ],
        bonusDamagePctArray = [
            self.ability().getBonusDamagePercent().sources,
            self.buffs.getBonusDamagePercent().sources
        ],
        itemBonusDamage = self.inventory.getBonusDamage().sources,
        itemBonusDamagePct = self.buffs.itemBuffs.getBonusDamagePercent(self.inventory.getBonusDamagePercent()).sources,
        critSources = self.critInfo(),
        abilityOrbSources = self.ability().getOrbSource(),
        itemOrbSources = self.inventory.getOrbSource(),
        itemProcOrbSources = self.orbProcInfo(),
        bashSources = self.bashInfo(),
        
        attackSources = [];
        
        attackSources.push({
            name: 'Base Attack',
            cooldown: 1
        });
        
        // weaver_geminate_attack
        if (self.heroId() === 'weaver') {
            var a = self.ability().abilities().find(function (ability) {
                return ability.name === 'weaver_geminate_attack';
            });
            if (a) {
                if (a.level() > 0) {
                    var cd = a.cooldown[a.level() - 1];
                    attackSources.push({
                        name: a.displayname,
                        cooldown: (1/cd)
                    });
                }
            }
        }
        
        // echo_sabre
        var item = self.inventory.items().find(function (o) { return o.item === "echo_sabre" && o.enabled(); });
        if (item && self.heroData().attacktype === 'DOTA_UNIT_CAP_MELEE_ATTACK') {
            var item_echo_sabre = itemData['item_echo_sabre'];
            attackSources.push({
                name: item_echo_sabre.displayname,
                cooldown: (1/item_echo_sabre.cooldown)
            });
        }

        var attacks = attackSources.map(function (a) {
            var baseDamage = (self.baseDamage()[0] + self.baseDamage()[1]) / 2,
            totalDamage = 0,
            totalCritableDamage = 0,
            totalCrit = 0,
            geminateAttack = { damage: 0, damageReduced: 0, cooldown: 6, active: false },
            echoSabreAttack = { damage: 0, damageReduced: 0, cooldown: itemData['item_echo_sabre'].cooldown[0], active: false },
            damage = {
                pure: 0,
                physical: 0,
                magic: 0
            },
            result = [],
            crits = [];
            
            // base damage
            result.push({
                name: 'Base Damage',
                damage: baseDamage,
                damageType: 'physical',
                damageReduced: self.getReducedDamage(baseDamage, 'physical'),
                enabled: ko.observable(true)
            });
            totalDamage += baseDamage;
            totalCritableDamage += baseDamage;
            damage.physical += baseDamage;
            
            // bonus damage from items
            for (i in itemBonusDamage) {
                var d = itemBonusDamage[i].damage*itemBonusDamage[i].count * self.ability().getSelfBaseDamageReductionPct() * self.enemy().ability().getBaseDamageReductionPct() * self.debuffs.itemBuffs.getBaseDamageReductionPct();
                result.push({
                    name: itemBonusDamage[i].displayname + (itemBonusDamage[i].count > 1 ? ' x' + itemBonusDamage[i].count : ''),
                    damage: d,
                    damageType: itemBonusDamage[i].damageType,
                    damageReduced: self.getReducedDamage(d, itemBonusDamage[i].damageType),
                    enabled: ko.observable(true)
                });
                totalDamage += d;
                totalCritableDamage += d;
                damage[itemBonusDamage[i].damageType] += d;
            }

            // bonus damage percent from items
            for (i in itemBonusDamagePct) {
                var d = baseDamage * itemBonusDamagePct[i].damage;
                result.push({
                    name: itemBonusDamagePct[i].displayname,
                    damage: d,
                    damageType: itemBonusDamagePct[i].damageType,
                    damageReduced: self.getReducedDamage(d, itemBonusDamagePct[i].damageType),
                    enabled: ko.observable(true)
                });
                totalDamage += d;
                totalCritableDamage += d;
                damage[itemBonusDamagePct[i].damageType] += d;
            }
            
            // bonus damage from abilities and buffs
            for (var i = 0; i < bonusDamageArray.length; i++) {
                for (j in bonusDamageArray[i]) {
                    var d = bonusDamageArray[i][j].damage;
                    result.push({
                        name: bonusDamageArray[i][j].displayname,
                        damage: d,
                        damageType: bonusDamageArray[i][j].damageType,
                        damageReduced: self.getReducedDamage(d, bonusDamageArray[i][j].damageType),
                        enabled: ko.observable(true)
                    });
                    totalDamage += d;
                    totalCritableDamage += d;
                    damage[bonusDamageArray[i][j].damageType] += d;
                }
            }
            
            // bonus damage percent from abilities and buffs
            for (var i = 0; i < bonusDamagePctArray.length; i++) {
                for (j in bonusDamagePctArray[i]) {
                    var d = baseDamage * bonusDamagePctArray[i][j].damage;
                    result.push({
                        name: bonusDamagePctArray[i][j].displayname,
                        damage: d,
                        damageType: bonusDamagePctArray[i][j].damageType,
                        damageReduced: self.getReducedDamage(d, bonusDamagePctArray[i][j].damageType),
                        enabled: ko.observable(true)
                    });
                    totalDamage += d;
                    totalCritableDamage += d;
                    damage[bonusDamagePctArray[i][j].damageType] += d;
                }
            }
            // drow_ranger_trueshot
            if (self.heroData().attacktype === 'DOTA_UNIT_CAP_RANGED_ATTACK') {
                if (self.heroId() === 'drow_ranger') {
                    var s = self.ability().getBonusDamagePrecisionAura().sources;
                    var index = 0;
                }
                else {
                    var s = self.buffs.getBonusDamagePrecisionAura().sources;
                    var index = 1;
                }
                if (s[index] != undefined) {
                    if (self.heroId() === 'drow_ranger') {
                        var d = s[index].damage * self.totalAgi();
                    }
                    else {
                        var d = s[index].damage;
                    }
                    result.push({
                        name: s[index].displayname,
                        damage: d,
                        damageType: 'physical',
                        damageReduced: self.getReducedDamage(d, 'physical'),
                        enabled: ko.observable(true)
                    });
                    totalDamage += d;
                    totalCritableDamage += d;
                    damage.physical += d;                    
                }
            }
            
            // riki_backstab
            if (self.heroId() === 'riki') {
                var s = self.ability().getBonusDamageBackstab().sources;
                var index = 0;
            }
            else {
                var s = self.buffs.getBonusDamageBackstab().sources;
                var index = 1;
            }
            if (s[index] != undefined) {
                if (self.heroId() === 'riki') {
                    var d = s[index].damage * self.totalAgi();
                }
                else {
                    var d = s[index].damage;
                }
                result.push({
                    name: s[index].displayname,
                    damage: d,
                    damageType: 'physical',
                    damageReduced: self.getReducedDamage(d, 'physical'),
                    enabled: ko.observable(true)
                });
                totalDamage += d;
                //totalCritableDamage += d;
                damage.physical += d;                    
            }

            // bash damage
            for (var i = 0; i < bashSources.sources.length; i++) {
                var o = bashSources.sources[i];
                var d = bashSources.sources[i].damage;
                var cd = self.attacksPerSecond();
                if (o.cooldown) {
                    cd = Math.max(1/o.cooldown, cd);
                }
                for (var j = 0; j < bashSources.sources[i].count; j++) {
                    result.push({
                        name: bashSources.sources[i].name,
                        damage: d,
                        damageType: bashSources.sources[i].damageType,
                        damageReduced: self.getReducedDamage(d, bashSources.sources[i].damageType),
                        dps: d * cd * bashSources.sources[i].chance,
                        dpsReduced: self.getReducedDamage(d, bashSources.sources[i].damageType) * cd * bashSources.sources[i].chance,
                        enabled: ko.observable(true)
                    });
                    totalDamage += d;
                    damage[bashSources.sources[i].damageType] += d;
                }

            }
            
            // %-based orbs
            for (var i = 0; i < itemProcOrbSources.sources.length; i++) {
                var d = itemProcOrbSources.sources[i].damage * (1 - Math.pow(1 - itemProcOrbSources.sources[i].chance, itemProcOrbSources.sources[i].count));
                result.push({
                    name: itemProcOrbSources.sources[i].name,
                    damage: d,
                    damageType: itemProcOrbSources.sources[i].damageType,
                    damageReduced: self.getReducedDamage(d, itemProcOrbSources.sources[i].damageType),
                    enabled: ko.observable(true)
                });
                totalDamage += d;
                damage[itemProcOrbSources.sources[i].damageType] += d;
            }
            
            // ability orbs
            for (var orb in abilityOrbSources) {
                var d = abilityOrbSources[orb].damage * (1 - itemProcOrbSources.total);
                result.push({
                    name: abilityOrbSources[orb].displayname,
                    damage: d,
                    damageType: abilityOrbSources[orb].damageType,
                    damageReduced: self.getReducedDamage(d, abilityOrbSources[orb].damageType),
                    enabled: ko.observable(true)
                });
                totalDamage += d;
                damage[abilityOrbSources[orb].damageType] += d;
            }
            
            // item orbs
            if (Object.keys(abilityOrbSources).length === 0) {
                for (var orb in itemOrbSources) {
                    var d = itemOrbSources[orb].damage * (1 - itemProcOrbSources.total);
                    result.push({
                        name: itemOrbSources[orb].displayname,
                        damage: d,
                        damageType: itemOrbSources[orb].damageType,
                        damageReduced: self.getReducedDamage(d, itemOrbSources[orb].damageType),
                        enabled: ko.observable(true)
                    });
                    totalDamage += d;
                    damage[itemOrbSources[orb].damageType] += d;
                }            
            }
            
            // crit damage
            for (var i = 0; i < critSources.sources.length; i++) {
                var d = totalCritableDamage * (critSources.sources[i].multiplier - 1);// * critSources.sources[i].totalChance;
                crits.push({
                    name: critSources.sources[i].name + ', ' + critSources.sources[i].multiplier + 'x, ' + (critSources.sources[i].totalChance * 100).toFixed(1) + '%',
                    damage: d,
                    damageType: 'physical',
                    damageReduced: self.getReducedDamage(d, 'physical'),
                    enabled: ko.observable(true),
                    chance: critSources.sources[i].totalChance
                });
                totalCrit += d;
            }

            var totalReduced = self.getReducedDamage(damage.pure, 'pure') 
                    + self.getReducedDamage(damage.physical, 'physical')
                    + self.getReducedDamage(damage.magic, 'magic'),
                totalCritReduced = self.getReducedDamage(totalCrit, 'physical'),
                dps = {
                    base: totalDamage * self.attacksPerSecond(),
                    crit: totalCrit * self.attacksPerSecond(),
                    geminateAttack: geminateAttack.active ? geminateAttack.damage / geminateAttack.cooldown : 0,
                    reduced: {
                        base: totalReduced * self.attacksPerSecond(),
                        crit: totalCritReduced * self.attacksPerSecond(),
                        geminateAttack: geminateAttack.active ? self.getReducedDamage(geminateAttack.damage, 'physical') / geminateAttack.cooldown : 0,
                    }
                }
                
            crits.forEach(function (o) {
                if (!o.dps) {
                    o.dps = o.damage * (o.cooldown || self.attacksPerSecond()) * o.chance;
                }
                if (!o.dpsReduced) {
                    o.dpsReduced = o.damageReduced * (o.cooldown || self.attacksPerSecond()) * o.chance;
                }
            });
                
            result.forEach(function (o) {
                if (!o.dps) {
                    o.dps = o.damage * (o.cooldown || self.attacksPerSecond());
                }
                if (!o.dpsReduced) {
                    o.dpsReduced = o.damageReduced * (o.cooldown || self.attacksPerSecond());
                }
            });
            
            var totalCritChance = crits.reduce(function (memo, o) { return memo + o.chance }, 0);
                
            var t1Crit = ko.computed(function () {
                var c = crits.find(function (o) { return o.enabled(); });
                return c ? c.damage : 0;
            });
            var t2Crit = ko.computed(function () {
                var c = crits.find(function (o) { return o.enabled(); });
                return c ? c.damageReduced : 0;
            });
            var t3Crit = ko.computed(function () {
                return crits.filter(function (o) { return o.enabled(); }).reduce(function (memo, o) { return memo + o.dps }, 0);
            });
            var t4Crit = ko.computed(function () {
                return crits.filter(function (o) { return o.enabled(); }).reduce(function (memo, o) { return memo + o.dpsReduced }, 0);
            });
                
            var t1 = ko.computed(function () {
                return result.filter(function (o) { return o.enabled(); }).reduce(function (memo, o) { return memo + o.damage }, 0) + t1Crit();
            });
            var t2 = ko.computed(function () {
                return result.filter(function (o) { return o.enabled(); }).reduce(function (memo, o) { return memo + o.damageReduced }, 0) + t2Crit();
            });
            var t3 = ko.computed(function () {
                return (result.filter(function (o) { return o.enabled(); }).reduce(function (memo, o) { return memo + o.dps }, 0) + t3Crit()) * a.cooldown;
            });
            var t4 = ko.computed(function () {
                return (result.filter(function (o) { return o.enabled(); }).reduce(function (memo, o) { return memo + o.dpsReduced }, 0) + t4Crit()) * a.cooldown;
            });
            
            var totalCritRow = [t1Crit, t2Crit, t3Crit, t4Crit];
            
            var totalRow = [t1, t2, t3, t4];

            return {
                name: a.name + ' Subtotal',
                cooldown: a.cooldown,
                enabled: ko.observable(true),
                visible: ko.observable(true),
                totalCritChance: totalCritChance,
                totalCritRow: totalCritRow,
                totalRow: totalRow,
                sources: result,
                sourcesCrit: crits,
                total: totalDamage,
                totalCrit: totalCrit,
                totalGeminateAttack: totalDamage + geminateAttack.damage,
                totalGeminateAttackReduced: totalReduced + geminateAttack.damageReduced,
                geminateAttack: geminateAttack,
                totalCritReduced: totalCritReduced,
                totalReduced: totalReduced,
                sumTotal: totalDamage + totalCrit,
                sumTotalReduced: totalReduced + totalCritReduced,
                dps: {
                    base: dps.base,
                    crit: dps.base + dps.crit,
                    geminateAttack: dps.base + dps.geminateAttack,
                    total: dps.base + dps.crit + dps.geminateAttack,
                    reduced: {
                        base: dps.reduced.base,
                        crit: dps.reduced.base + dps.reduced.crit,
                        geminateAttack: dps.reduced.base + dps.reduced.geminateAttack,
                        total: dps.reduced.base + dps.reduced.crit + dps.reduced.geminateAttack
                    }
                }
            };
        });
        
        var t1 = ko.computed(function () {
            return attacks.filter(function (o) { return o.enabled(); }).reduce(function (memo, o) { return memo + o.totalRow[0]() }, 0);
        });
        var t2 = ko.computed(function () {
            return attacks.filter(function (o) { return o.enabled(); }).reduce(function (memo, o) { return memo + o.totalRow[1]() }, 0);
        });
        var t3 = ko.computed(function () {
            return attacks.filter(function (o) { return o.enabled(); }).reduce(function (memo, o) { return memo + o.totalRow[2]() }, 0);
        });
        var t4 = ko.computed(function () {
            return attacks.filter(function (o) { return o.enabled(); }).reduce(function (memo, o) { return memo + o.totalRow[3]() }, 0);
        });
            
        return {
            attacks: attacks,
            totalRow: [t1, t2, t3, t4]
        }
    });
    
    self.getDamageTypeColor = function (damageType) {
        return DamageTypeColor[damageType] || DamageTypeColor['default'];
    }
    
}

module.exports = HeroDamageMixin;
},{"../herocalc_knockout":21,"../util/extend":36,"./DamageTypeColor":8}],10:[function(require,module,exports){
'use strict';
var ko = require('../herocalc_knockout');

var AbilityModel = require("../AbilityModel");
var BuffViewModel = require("../BuffViewModel");
var InventoryViewModel = require("../inventory/InventoryViewModel");
var diffProperties = require("./diffProperties");
var HeroDamageMixin = require("./HeroDamageMixin");
var TalentController = require("./TalentController");
var totalExp = require("./totalExp");
var nextLevelExp = require("./nextLevelExp");

var HeroModel = function (heroData, itemData, h) {
    var self = this;
    self.heroId = ko.observable(h);
    self.selectedHeroLevel = ko.observable(1);
    self.inventory = new InventoryViewModel(itemData, self);
    self.selectedInventory = ko.observable(-1);
    self.buffs = new BuffViewModel(itemData);
    self.buffs.hasScepter = self.inventory.hasScepter;
    self.debuffs = new BuffViewModel(itemData);
    self.heroData = ko.computed(function () {
      return heroData['npc_dota_hero_' + self.heroId()];
    });
    self.heroCompare = ko.observable(self);
    self.enemy = ko.observable(self);
    self.unit = ko.observable(self);
    self.clone = ko.observable(self);
    
    self.talents = [
        ko.observable(-1),
        ko.observable(-1),
        ko.observable(-1),
        ko.observable(-1)
    ];
    
    self.selectedTalents = ko.computed(function () {
        var arr = [];
        for (var i = 0; i < 4; i++) {
            if (self.talents[i]() !== -1) {
                arr.push(self.heroData().talents[i][self.talents[i]()]);
            }
        }
        return arr;
    });
    
    self.skillPointHistory = ko.observableArray();
    
    self.ability = ko.computed(function () {
        var a = new AbilityModel(ko.observableArray(JSON.parse(JSON.stringify(self.heroData().abilities))), self);
        switch (self.heroId()) {
            case 'earth_spirit':
            case 'ogre_magi':
                a._abilities[3].level(1);
            break;
            case 'invoker':
                for (var i = 5; i < 16; i++) {
                    console.log(a._abilities[i]);
                    a._abilities[i].level(1);
                }
            break;
        }
        self.skillPointHistory.removeAll();
        a.hasScepter = self.inventory.hasScepter
        return a;
    });

    self.availableSkillPoints = ko.computed(function () {
        var c = self.selectedHeroLevel();
        for (var i = 0; i < 4; i++) {
            if (self.selectedHeroLevel() < i * 5 + 10) self.talents[i](-1);
        }
        c -= self.talents.filter(function (talent) { return talent() !== -1 }).length;
        for (var i = 0; i < self.ability().abilities().length; i++) {
            switch(self.ability().abilities()[i].abilitytype) {
                case 'DOTA_ABILITY_TYPE_ULTIMATE':
                    if (self.heroId() === 'invoker') {
                        /*while (
                            ((self.ability().abilities()[i].level() == 1) && (parseInt(self.selectedHeroLevel()) < 2)) ||
                            ((self.ability().abilities()[i].level() == 2) && (parseInt(self.selectedHeroLevel()) < 7)) ||
                            ((self.ability().abilities()[i].level() == 3) && (parseInt(self.selectedHeroLevel()) < 11)) ||
                            ((self.ability().abilities()[i].level() == 4) && (parseInt(self.selectedHeroLevel()) < 17))
                        ) {
                            self.ability().levelDownAbility(i, null, null, self);
                        }*/
                    }
                    else if (self.heroId() === 'meepo') {
                        while ((self.ability().abilities()[i].level()-1) * 7 + 3 > parseInt(self.selectedHeroLevel())) {
                            self.ability().levelDownAbility(i, null, null, self);
                        }
                    }
                    else {
                        while (self.ability().abilities()[i].level() * 5 + 1 > parseInt(self.selectedHeroLevel())) {
                            self.ability().levelDownAbility(i, null, null, self);
                        }
                    }
                break;
                default:
                    while (self.ability().abilities()[i].level() * 2 - 1 > parseInt(self.selectedHeroLevel())) {
                        self.ability().levelDownAbility(i, null, null, self);
                    }
                break;
            }
        }
        while (self.skillPointHistory().length > c) {
            self.ability().levelDownAbility(self.skillPointHistory()[self.skillPointHistory().length-1], null, null, self);
        }
        return c-self.skillPointHistory().length;
    }, this);
    self.primaryAttribute = ko.pureComputed(function () {
        var v = self.heroData().attributeprimary;
        if (v === 'DOTA_ATTRIBUTE_AGILITY') return 'agi';
        if (v === 'DOTA_ATTRIBUTE_INTELLECT') return 'int';
        if (v === 'DOTA_ATTRIBUTE_STRENGTH') return 'str';
        return '';
    });
    self.totalExp = ko.pureComputed(function () {
        return totalExp[self.selectedHeroLevel() - 1];
    });
    self.nextLevelExp = ko.pureComputed(function () {
        return nextLevelExp[self.selectedHeroLevel() - 1];
    });
    self.startingArmor = ko.pureComputed(function () {
        return (self.heroData().attributebaseagility * .14 + self.heroData().armorphysical).toFixed(2);
    });
    self.respawnTime = ko.pureComputed(function () {
        var level = self.selectedHeroLevel();
        var reduction = TalentController.getRespawnReduction(self.selectedTalents());
        if (level >= 1 && level <= 5) {
            return (level - 1) * 2 + 8 - reduction;
        }
        else if (level >= 6 && level <= 11) {
            return (level - 6) * 2 + 26 - reduction;
        }
        else if (level >= 12 && level <= 17) {
            return (level - 12) * 2 + 46 - reduction;
        }
        else if (level >= 18 && level <= 24) {
            return (level - 18) * 4 + 66 - reduction;
        }
        else if (level == 25) {
            return 100 - reduction;
        }
    });
    self.totalAttribute = function (a) {
        if (a === 'agi') return parseFloat(self.totalAgi());
        if (a === 'int') return parseFloat(self.totalInt());
        if (a === 'str') return parseFloat(self.totalStr());
        return 0;
    };
    self.totalAgi = ko.pureComputed(function () {
        return (self.heroData().attributebaseagility
                + self.heroData().attributeagilitygain * (self.selectedHeroLevel() - 1) 
                + self.inventory.getAttributes('agi') 
                + self.ability().getAttributeBonusLevel() * 2
                + self.ability().getAgility()
                + TalentController.getAgility(self.selectedTalents())
                + self.enemy().ability().getAllStatsReduction()
                + self.debuffs.getAllStatsReduction()
               ).toFixed(2);
    });
    self.intStolen = ko.observable(0).extend({ numeric: 0 });
    self.totalInt = ko.pureComputed(function () {
        return (self.heroData().attributebaseintelligence 
                + self.heroData().attributeintelligencegain * (self.selectedHeroLevel() - 1) 
                + self.inventory.getAttributes('int') 
                + self.ability().getAttributeBonusLevel() * 2
                + self.ability().getIntelligence()
                + TalentController.getIntelligence(self.selectedTalents())
                + self.enemy().ability().getAllStatsReduction()
                + self.debuffs.getAllStatsReduction() + self.intStolen()
               ).toFixed(2);
    });
    self.totalStr = ko.pureComputed(function () {
        return (self.heroData().attributebasestrength 
                + self.heroData().attributestrengthgain * (self.selectedHeroLevel() - 1) 
                + self.inventory.getAttributes('str') 
                + self.ability().getAttributeBonusLevel() * 2
                + self.ability().getStrength()
                + TalentController.getStrength(self.selectedTalents())
                + self.enemy().ability().getStrengthReduction()
                + self.enemy().ability().getAllStatsReduction()
                + self.debuffs.getAllStatsReduction()
               ).toFixed(2);
    });
    self.health = ko.pureComputed(function () {
        return (self.heroData().statushealth + Math.floor(self.totalStr()) * 20 
                + self.inventory.getHealth()
                + self.ability().getHealth()
                + TalentController.getHealth(self.selectedTalents())
                ).toFixed(2);
    });
    self.healthregen = ko.pureComputed(function () {
        var healthRegenAura = [self.inventory.getHealthRegenAura, self.buffs.itemBuffs.getHealthRegenAura].reduce(function (memo, fn) {
            var obj = fn(memo.excludeList);
            obj.value += memo.value;
            return obj;
        }, {value: 0, excludeList: []});
        return (self.heroData().statushealthregen + self.totalStr() * .03 
                + self.inventory.getHealthRegen() 
                + self.ability().getHealthRegen()
                + TalentController.getHealthRegen(self.selectedTalents())
                + self.buffs.getHealthRegen()
                + healthRegenAura.value
                ).toFixed(2);
    });
    self.mana = ko.pureComputed(function () {
        return (self.heroData().statusmana
                + self.totalInt() * 12
                + self.inventory.getMana()
                + TalentController.getMana(self.selectedTalents())
                + self.ability().getMana()).toFixed(2);
    });
    self.manaregen = ko.pureComputed(function () {
        return ((self.heroData().statusmanaregen 
                + self.totalInt() * .04 
                + self.ability().getManaRegen()
                + TalentController.getManaRegen(self.selectedTalents())
                ) 
                * (1 + self.inventory.getManaRegenPercent()) 
                + (self.heroId() === 'crystal_maiden' ? self.ability().getManaRegenArcaneAura() * 2 : self.buffs.getManaRegenArcaneAura())
                + self.inventory.getManaRegenBloodstone()
                + self.inventory.getManaRegen()
                - self.enemy().ability().getManaRegenReduction()).toFixed(2);
    });
    self.totalArmorPhysical = ko.pureComputed(function () {
        var armorAura = [self.inventory.getArmorAura, self.buffs.itemBuffs.getArmorAura].reduce(function (memo, fn) {
            var obj = fn(memo.attributes);
            return obj;
        }, {value:0, attributes:[]});
        var armorReduction = [self.enemy().inventory.getArmorReduction, self.debuffs.itemBuffs.getArmorReduction].reduce(function (memo, fn) {
            var obj = fn(memo.excludeList);
            obj.value += memo.value;
            return obj;
        }, {value: 0, excludeList: []});
        return (self.enemy().ability().getArmorBaseReduction() * self.debuffs.getArmorBaseReduction() * (self.heroData().armorphysical + self.totalAgi() * .14)
                + self.inventory.getArmor()
                //+ self.inventory.getArmorAura().value
                //+ self.enemy().inventory.getArmorReduction()
                + self.ability().getArmor()
                + TalentController.getArmor(self.selectedTalents())
                + self.enemy().ability().getArmorReduction()
                + self.buffs.getArmor()
                + self.buffs.itemBuffs.getArmor()
                + self.debuffs.getArmorReduction()
                //+ self.buffs.itemBuffs.getArmorAura().value
                + armorAura.value
                + armorReduction.value
                //+ self.debuffs.getArmorReduction()
                ).toFixed(2);
    });
    self.totalArmorPhysicalReduction = ko.pureComputed(function () {
        var totalArmor = self.totalArmorPhysical();
        if (totalArmor >= 0) {
            return ((0.06 * self.totalArmorPhysical()) / (1 + 0.06 * self.totalArmorPhysical()) * 100).toFixed(2);
        }
        else {
            return -((0.06 * -self.totalArmorPhysical()) / (1 + 0.06 * -self.totalArmorPhysical()) * 100).toFixed(2);
        }
    });
    self.totalMovementSpeed = ko.pureComputed(function () {
        var MIN_MOVESPEED = 100;
        var ms = (self.ability().setMovementSpeed() > 0 ? self.ability().setMovementSpeed() : self.buffs.setMovementSpeed());
        if (ms > 0) {
            return ms;
        }
        else {
            var movementSpeedPercent = [self.inventory.getMovementSpeedPercent, self.buffs.itemBuffs.getMovementSpeedPercent].reduce(function (memo, fn) {
                var obj = fn(memo.excludeList);
                obj.value += memo.value;
                return obj;
            }, {value:0, excludeList:[]});
            var movementSpeedPercentReduction = [self.enemy().inventory.getMovementSpeedPercentReduction, self.debuffs.itemBuffs.getMovementSpeedPercentReduction].reduce(function (memo, fn) {
                var obj = fn(memo.excludeList);
                obj.value += memo.value;
                return obj;
            }, {value:0, excludeList:[]});
            return Math.max(
                self.enemy().inventory.isSheeped() || self.debuffs.itemBuffs.isSheeped() ? 140 :
                (self.heroData().movementspeed + self.inventory.getMovementSpeedFlat() + self.ability().getMovementSpeedFlat() + TalentController.getMovementSpeedFlat(self.selectedTalents())) * 
                (1 //+ self.inventory.getMovementSpeedPercent() 
                   + movementSpeedPercent.value
                   + movementSpeedPercentReduction.value
                   + self.ability().getMovementSpeedPercent() 
                   //+ self.enemy().inventory.getMovementSpeedPercentReduction() 
                   + self.enemy().ability().getMovementSpeedPercentReduction() 
                   + self.buffs.getMovementSpeedPercent() 
                   + self.debuffs.getMovementSpeedPercentReduction()
                   + self.unit().ability().getMovementSpeedPercent() 
                )
            , MIN_MOVESPEED).toFixed(2);
        }
    });
    self.totalTurnRate = ko.pureComputed(function () {
        return (self.heroData().movementturnrate 
                * (1 + self.enemy().ability().getTurnRateReduction()
                     + self.debuffs.getTurnRateReduction())).toFixed(2);
    });
    self.baseDamage = ko.pureComputed(function () {
        var totalAttribute = self.totalAttribute(self.primaryAttribute()),
            abilityBaseDamage = self.ability().getBaseDamage(),
            minDamage = self.heroData().attackdamagemin,
            maxDamage = self.heroData().attackdamagemax;
        return [Math.floor((minDamage + totalAttribute + abilityBaseDamage.total) * self.ability().getSelfBaseDamageReductionPct() * self.enemy().ability().getBaseDamageReductionPct() * self.debuffs.getBaseDamageReductionPct() * self.debuffs.itemBuffs.getBaseDamageReductionPct() * abilityBaseDamage.multiplier),
                Math.floor((maxDamage + totalAttribute + abilityBaseDamage.total) * self.ability().getSelfBaseDamageReductionPct() * self.enemy().ability().getBaseDamageReductionPct() * self.debuffs.getBaseDamageReductionPct() * self.debuffs.itemBuffs.getBaseDamageReductionPct() * abilityBaseDamage.multiplier)];
    });
    self.baseDamageAvg = ko.pureComputed(function () {
        return (self.baseDamage()[0] + self.baseDamage()[1]) / 2;
    });
    self.baseDamageMin = ko.pureComputed(function () {
        return self.baseDamage()[0];
    });
    self.baseDamageMax = ko.pureComputed(function () {
        return self.baseDamage()[1];
    });
    self.bonusDamage = ko.pureComputed(function () {
        return ((self.inventory.getBonusDamage().total
                + self.ability().getBonusDamage().total
                + TalentController.getBonusDamage(self.selectedTalents()).total
                + self.buffs.getBonusDamage().total
                + Math.floor((self.baseDamage()[0] + self.baseDamage()[1]) / 2 
                              * (self.buffs.itemBuffs.getBonusDamagePercent(self.inventory.getBonusDamagePercent()).total
                                 + self.ability().getBonusDamagePercent().total
                                 + self.buffs.getBonusDamagePercent().total
                                )
                            )
                + Math.floor(
                    (self.heroData().attacktype == 'DOTA_UNIT_CAP_RANGED_ATTACK' 
                        ? ((self.heroId() == 'drow_ranger') ? self.ability().getBonusDamagePrecisionAura().total[0] * self.totalAgi() : self.buffs.getBonusDamagePrecisionAura().total[1])
                        : 0)
                  )
                + Math.floor(
                    ((self.heroId() == 'riki') ? self.ability().getBonusDamageBackstab().total[0] * self.totalAgi() : 0)
                  )
                ) * self.ability().getSelfBaseDamageReductionPct()
                  * self.enemy().ability().getBaseDamageReductionPct()
                  * self.debuffs.itemBuffs.getBaseDamageReductionPct());
    });
    self.bonusDamageReduction = ko.pureComputed(function () {
        return Math.abs(self.enemy().ability().getBonusDamageReduction() + self.debuffs.getBonusDamageReduction());
    });
    self.damageAvg = ko.pureComputed(function () {
        return (self.baseDamage()[0] + self.baseDamage()[1]) / 2 + self.bonusDamage();
    });
    self.damageMin = ko.pureComputed(function () {
        return self.baseDamage()[0] + self.bonusDamage();
    });
    self.damageMax = ko.pureComputed(function () {
        return self.baseDamage()[1] + self.bonusDamage();
    });
    self.damage = ko.pureComputed(function () {
        return [self.baseDamage()[0] + self.bonusDamage(),
                self.baseDamage()[1] + self.bonusDamage()];
    });
    self.totalMagicResistanceProduct = ko.pureComputed(function () {
        return (1 - self.heroData().magicalresistance / 100) 
                * self.inventory.getMagicResist()
                * self.ability().getMagicResist()
                * TalentController.getMagicResist(self.selectedTalents())
                * self.buffs.getMagicResist()
                * self.inventory.getMagicResistReductionSelf()
                * self.enemy().inventory.getMagicResistReduction()
                * self.enemy().ability().getMagicResistReduction()
                * self.debuffs.getMagicResistReduction()
                * self.debuffs.itemBuffs.getMagicResistReduction();
    });
    self.totalMagicResistance = ko.pureComputed(function () {
        return ((1 - self.totalMagicResistanceProduct()) * 100).toFixed(2);
    });
    self.bat = ko.pureComputed(function () {
        var abilityBAT = self.ability().getBAT();
        if (abilityBAT > 0) {
            return abilityBAT;
        }
        return self.heroData().attackrate;
    });
    self.ias = ko.pureComputed(function () {
        var attackSpeed = [self.inventory.getAttackSpeed, self.buffs.itemBuffs.getAttackSpeed].reduce(function (memo, fn) {
            var obj = fn(memo.excludeList);
            obj.value += memo.value;
            return obj;
        }, {value:0, excludeList:[]});
        var attackSpeedReduction = [self.enemy().inventory.getAttackSpeedReduction, self.debuffs.itemBuffs.getAttackSpeedReduction].reduce(function (memo, fn) {
            var obj = fn(memo.excludeList);
            obj.value += memo.value;
            return obj;
        }, {value:0, excludeList: []});
        var val = parseFloat(self.totalAgi()) 
                //+ self.inventory.getAttackSpeed() 
                + attackSpeed.value
                + attackSpeedReduction.value
                //+ self.enemy().inventory.getAttackSpeedReduction() 
                + self.ability().getAttackSpeed() 
                + TalentController.getAttackSpeed(self.selectedTalents()) 
                + self.enemy().ability().getAttackSpeedReduction() 
                + self.buffs.getAttackSpeed() 
                + self.debuffs.getAttackSpeedReduction()
                + self.unit().ability().getAttackSpeed(); 
        if (val < -80) {
            return -80;
        }
        else if (val > 500) {
            return 500;
        }
        return val.toFixed(2);
    });
    self.attackTime = ko.pureComputed(function () {
        return (self.bat() / (1 + self.ias() / 100)).toFixed(2);
    });
    self.attacksPerSecond = ko.pureComputed(function () {
        return ((1 + self.ias() / 100) / self.bat()).toFixed(2);
    });
    self.evasion = ko.pureComputed(function () {
        if (self.enemy().inventory.isSheeped() || self.debuffs.itemBuffs.isSheeped()) return 0;
        var e = self.ability().setEvasion();
        if (e) {
            return (e * 100).toFixed(2);
        }
        else {
            return (
                (
                    1 - (
                        self.inventory.getEvasion()
                        * self.ability().getEvasion()
                        * self.ability().getEvasionBacktrack()
                        * TalentController.getEvasion(self.selectedTalents())
                        * self.buffs.itemBuffs.getEvasion()
                    )
                ) * 100
            ).toFixed(2);
        }
    });
    self.ehpPhysical = ko.pureComputed(function () {
        var evasion = self.enemy().inventory.isSheeped() || self.debuffs.itemBuffs.isSheeped() ? 1 : self.inventory.getEvasion() * self.ability().getEvasion() * self.buffs.itemBuffs.getEvasion();
        if (self.totalArmorPhysical() >= 0) {
            var ehp = self.health() * (1 + .06 * self.totalArmorPhysical());
        }
        else {
            var ehp = self.health() * (1 - .06 * self.totalArmorPhysical()) / (1 - .12 * self.totalArmorPhysical());
        }
        ehp /= (1 - (1 - (evasion * self.ability().getEvasionBacktrack())));
        ehp /= (1 - parseFloat(self.enemy().missChance()) / 100);
        ehp *= (self.inventory.activeItems().some(function (item) {return item.item == 'mask_of_madness';}) ? (1 / 1.3) : 1);
        ehp *= (1 / self.ability().getDamageReduction());
        ehp *= (1 / self.buffs.getDamageReduction());
        ehp *= (1 / self.enemy().ability().getDamageAmplification());
        ehp *= (1 / self.debuffs.getDamageAmplification());
        return ehp.toFixed(2);
    });
    self.ehpMagical = ko.pureComputed(function () {
        var ehp = self.health() / self.totalMagicResistanceProduct();
        ehp *= (self.inventory.activeItems().some(function (item) {return item.item == 'mask_of_madness';}) ? (1 / 1.3) : 1);
        ehp *= (1 / self.ability().getDamageReduction());
        ehp *= (1 / self.buffs.getDamageReduction());
        ehp *= (1 / self.ability().getEvasionBacktrack());
        ehp *= (1 / self.enemy().ability().getDamageAmplification());
        ehp *= (1 / self.debuffs.getDamageAmplification());
        return ehp.toFixed(2);
    });
    self.bash = ko.pureComputed(function () {
        var attacktype = self.heroData().attacktype;
        return ((1 - (self.inventory.getBash(attacktype) * self.ability().getBash())) * 100).toFixed(2);
    });
    
    self.critChance = ko.pureComputed(function () {
        return ((1 - (self.inventory.getCritChance() * self.ability().getCritChance())) * 100).toFixed(2);
    });

    HeroDamageMixin(self, itemData);
    
    /*self.critDamage = ko.computed(function () {
        self.critInfo();
        return 0;
    });*/
    self.missChance = ko.pureComputed(function () {
        var missDebuff = [self.enemy().inventory.getMissChance, self.debuffs.itemBuffs.getMissChance].reduce(function (memo, fn) {
            var obj = fn(memo.excludeList);
            obj.value *= memo.value;
            return obj;
        }, {value:1, excludeList:[]});
        return ((1 - (self.enemy().ability().getMissChance() * self.debuffs.getMissChance() * missDebuff.value)) * 100).toFixed(2);
    });
    self.totalattackrange = ko.pureComputed(function () {
        var attacktype = self.heroData().attacktype;
        return self.heroData().attackrange
             + self.ability().getAttackRange()
             + TalentController.getAttackRange(self.selectedTalents())
             + self.inventory.getAttackRange(attacktype).value;
    });
    self.visionrangeday = ko.pureComputed(function () {
        return (self.heroData().visiondaytimerange) * (1 + self.enemy().ability().getVisionRangePctReduction() + self.debuffs.getVisionRangePctReduction());
    });
    self.visionrangenight = ko.pureComputed(function () {
        return (self.heroData().visionnighttimerange + self.inventory.getVisionRangeNight() + self.ability().getVisionRangeNight()) * (1 + self.enemy().ability().getVisionRangePctReduction() + self.debuffs.getVisionRangePctReduction());
    });
    self.lifesteal = ko.pureComputed(function () {
        var total = self.inventory.getLifesteal()
                  + self.ability().getLifesteal()
                  + TalentController.getLifesteal(self.selectedTalents())
                  + self.buffs.getLifesteal();
        if (self.heroData().attacktype == 'DOTA_UNIT_CAP_MELEE_ATTACK') {
            var lifestealAura = [self.inventory.getLifestealAura, self.buffs.itemBuffs.getLifestealAura].reduce(function (memo, fn) {
                var obj = fn(memo.excludeList);
                obj.value += memo.value;
                return obj;
            }, {value: 0, excludeList: []});
            total += lifestealAura.value;
        }
        return (total).toFixed(2);
    });
    
    self.diffProperties = diffProperties;
    self.diff = {};

    for (var i = 0; i < self.diffProperties.length; i++) {
        var index = i;
        self.diff[self.diffProperties[index]] = self.getDiffFunction(self.diffProperties[index]);
    }
};

HeroModel.prototype.getDiffFunction = function (prop) {
    var self = this;
    return ko.computed(function () {
        if (prop == 'baseDamage') {
            return [self[prop]()[0] - self.heroCompare()[prop]()[0], self[prop]()[1] - self.heroCompare()[prop]()[1]];
        }
        else {
            return self[prop]() - self.heroCompare()[prop]();
        }
    }, this, { deferEvaluation: true });
}

HeroModel.prototype.getAbilityLevelMax = function (data) {
    if (data.abilitytype === 'DOTA_ABILITY_TYPE_ATTRIBUTES') {
        return 1;
    }
    else if (data.name === 'invoker_quas' || data.name === 'invoker_wex' || data.name === 'invoker_exort') {
        return 7;
    }
    else if (data.name === 'invoker_invoke') {
        return 1;
    }
    else if (data.name === 'earth_spirit_stone_caller' || data.name === 'ogre_magi_unrefined_fireblast') {
        return 1;
    }
    else if (data.abilitytype === 'DOTA_ABILITY_TYPE_ULTIMATE' || data.name === 'keeper_of_the_light_recall' ||
             data.name === 'keeper_of_the_light_blinding_light' || data.name === 'ember_spirit_activate_fire_remnant' ||
             data.name === 'lone_druid_true_form_battle_cry') {
        return 3;
    }
    else if (data.name === 'puck_ethereal_jaunt'  || data.name === 'shadow_demon_shadow_poison_release' ||
             data.name === 'templar_assassin_trap' || data.name === 'spectre_reality') {
        return 0;
    }
    else if (data.name === 'invoker_cold_snap'  || data.name === 'invoker_ghost_walk' || data.name === 'invoker_tornado' || 
             data.name === 'invoker_emp' || data.name === 'invoker_alacrity' || data.name === 'invoker_chaos_meteor' || 
             data.name === 'invoker_sun_strike' || data.name === 'invoker_forge_spirit' || data.name === 'invoker_ice_wall' || 
             data.name === 'invoker_deafening_blast') {
        return 0;
    }
    else if (data.name === 'techies_minefield_sign' || data.name === 'techies_focused_detonate') {
        return 0;
    }
    else {
        return 4;
    }
};

HeroModel.prototype.toggleTalent = function (talentTier, talentIndex) {
    if (this.talents[talentTier]() === talentIndex) {
        this.talents[talentTier](-1);
    }
    else if (this.availableSkillPoints() > 0 || this.talents[talentTier]() == 1 - talentIndex) {
        if (parseInt(this.selectedHeroLevel()) >= talentTier * 5 + 10) {
            this.talents[talentTier](talentIndex);
        }
    }
}

module.exports = HeroModel;
},{"../AbilityModel":1,"../BuffViewModel":2,"../herocalc_knockout":21,"../inventory/InventoryViewModel":26,"./HeroDamageMixin":9,"./TalentController":13,"./diffProperties":16,"./nextLevelExp":18,"./totalExp":19}],11:[function(require,module,exports){
var HeroOption = function (name, displayname, hero) {
    this.heroName = name;
    this.heroDisplayName = displayname;
    this.hero = hero;
};

module.exports = HeroOption;
},{}],12:[function(require,module,exports){
'use strict';
var HeroModel = require("./HeroModel");
var illusionData = require("../illusion/illusionData");
var findWhere = require("../util/findWhere");

var IllusionModel = function (heroData, itemData, h,p, abilityLevel) {
    var self = this;
    HeroModel.call(this, heroData, itemData, h);
    self.illusionAbilityLevel = ko.observable(abilityLevel);
    self.parent = p;
    
    self.totalAgi = ko.computed(function () {
        return (self.heroData().attributebaseagility
                + self.heroData().attributeagilitygain * (self.selectedHeroLevel() - 1) 
                + self.inventory.getAttributes('agi') 
                + self.ability().getAttributeBonusLevel() * 2
                + self.ability().getAgility()
                + self.enemy().ability().getAllStatsReduction()
                + self.debuffs.getAllStatsReduction()
               ).toFixed(2);
    });
    self.intStolen = ko.observable(0).extend({ numeric: 0 });
    self.totalInt = ko.computed(function () {
        return (self.heroData().attributebaseintelligence 
                + self.heroData().attributeintelligencegain * (self.selectedHeroLevel() - 1) 
                + self.inventory.getAttributes('int') 
                + self.ability().getAttributeBonusLevel() * 2
                + self.ability().getIntelligence()
                + self.enemy().ability().getAllStatsReduction()
                + self.debuffs.getAllStatsReduction() + self.intStolen()
               ).toFixed(2);
    });
    self.totalStr = ko.computed(function () {
        return (self.heroData().attributebasestrength 
                + self.heroData().attributestrengthgain * (self.selectedHeroLevel() - 1) 
                + self.inventory.getAttributes('str') 
                + self.ability().getAttributeBonusLevel() * 2
                + self.ability().getStrength()
                + self.enemy().ability().getAllStatsReduction()
                + self.debuffs.getAllStatsReduction()
               ).toFixed(2);
    });
    
    self.getAbilityAttributeValue = function(hero, ability, attributeName, level) {
        if (ability == 'item_manta') {
            var abilityObj = itemData[ability];
        }
        else {
            var abilityObj = findWhere(heroData['npc_dota_hero_' + hero].abilities, {name: ability});
        }
        var attribute = findWhere(abilityObj.attributes, {name: attributeName});
        if (level == 0) {
            return parseFloat(attribute.value[0]);
        }
        else if (level > attribute.length) {
            return parseFloat(attribute.value[0]);
        }
        else {
            return parseFloat(attribute.value[level - 1]);
        }
    }
    
    self.getIncomingDamageMultiplier = function(illusionType, hasScepter, attackType) {
        if (illusionType == 'item_manta') {
            if (attackType == 'DOTA_UNIT_CAP_MELEE_ATTACK') {
                return (1 + self.getAbilityAttributeValue(illusionData[self.illusionType()].hero, self.illusionType(), illusionData[illusionType].incoming_damage_melee, self.illusionAbilityLevel())/100)
            }
            else {
                return (1 + self.getAbilityAttributeValue(illusionData[self.illusionType()].hero, self.illusionType(), illusionData[illusionType].incoming_damage_ranged, self.illusionAbilityLevel())/100)
            }
        }
        else {
            return (1 + self.getAbilityAttributeValue(illusionData[self.illusionType()].hero, self.illusionType(), illusionData[illusionType].incoming_damage, self.illusionAbilityLevel())/100)
        }
    }
    self.getOutgoingDamageMultiplier = function(illusionType, hasScepter, attackType) {
        if (illusionType == 'item_manta') {
            if (attackType == 'DOTA_UNIT_CAP_MELEE_ATTACK') {
                return (1 + self.getAbilityAttributeValue(illusionData[self.illusionType()].hero, self.illusionType(), illusionData[illusionType].outgoing_damage_melee, self.illusionAbilityLevel())/100);
            }
            else {
                return (1 + self.getAbilityAttributeValue(illusionData[self.illusionType()].hero, self.illusionType(), illusionData[illusionType].outgoing_damage_ranged, self.illusionAbilityLevel())/100);
            }
        }
        else {
            return (1 + self.getAbilityAttributeValue(illusionData[self.illusionType()].hero, self.illusionType(), illusionData[illusionType].outgoing_damage, self.illusionAbilityLevel())/100);
        }
    }

    self.baseDamage = ko.computed(function() {
        return [Math.floor(heroData['npc_dota_hero_' + self.heroId()].attackdamagemin + self.totalAttribute(self.primaryAttribute()) + self.ability().getBaseDamage().total)
                * self.getOutgoingDamageMultiplier(self.illusionType(), false, self.heroData().attacktype),
                Math.floor(heroData['npc_dota_hero_' + self.heroId()].attackdamagemax + self.totalAttribute(self.primaryAttribute()) + self.ability().getBaseDamage().total)
                * self.getOutgoingDamageMultiplier(self.illusionType(), false, self.heroData().attacktype)];
    });
    
    self.damage = ko.computed(function() {
        return [self.baseDamage()[0],
                self.baseDamage()[1]];
    });
    
    self.ehpPhysical = ko.computed(function() {
        var ehp = (self.health() * (1 + .06 * self.totalArmorPhysical())) / (1 - (1 - (self.inventory.getEvasion() * self.ability().getEvasion())))
        ehp *= (self.inventory.activeItems().some(function(item) {return item.item == 'mask_of_madness';}) ? (1 / 1.3) : 1);
        ehp *= (1 / self.getIncomingDamageMultiplier(self.illusionType(), false, self.heroData().attacktype));
        return ehp.toFixed(2);
    });
    self.ehpMagical = ko.computed(function() {
        var ehp = self.health() / self.totalMagicResistanceProduct();
        ehp *= (1 / self.getIncomingDamageMultiplier(self.illusionType(), false, self.heroData().attacktype));
        return ehp.toFixed(2);
    });
    
    self.totalArmorPhysical = ko.computed(function() {
        return (self.enemy().ability().getArmorBaseReduction() * self.debuffs.getArmorBaseReduction() * (heroData['npc_dota_hero_' + self.heroId()].armorphysical + self.totalAgi() * .14)
                + self.ability().getArmor() + self.enemy().ability().getArmorReduction() + self.buffs.getArmor() + self.debuffs.getArmorReduction()).toFixed(2);
    });
    
    self.ias = ko.computed(function() {
        var val = parseFloat(self.totalAgi()) 
                + self.ability().getAttackSpeed() 
                + self.enemy().ability().getAttackSpeedReduction() 
                + self.buffs.getAttackSpeed() 
                + self.debuffs.getAttackSpeedReduction()
                + self.unit().ability().getAttackSpeed(); 
        if (val < -80) {
            return -80;
        }
        else if (val > 400) {
            return 400;
        }
        return val.toFixed(2);
    });
    
    return self;
}
IllusionModel.prototype = Object.create(HeroModel.prototype);
IllusionModel.prototype.constructor = IllusionModel;

module.exports = IllusionModel;
},{"../illusion/illusionData":23,"../util/findWhere":37,"./HeroModel":10}],13:[function(require,module,exports){
module.exports = {
    getBonusDamage: function (talents) {
        var totalAttribute = 0;
        var sources = {};
        for (var i = 0; i < talents.length; i++) {
            var ability = talents[i];
            if (ability.name.startsWith('special_bonus_attack_damage_')) {
                totalAttribute += ability.attributes[0].value[0];
                sources[ability.name] = {
                    'damage': ability.attributes[0].value[0],
                    'damageType': 'physical',
                    'displayname': ability.displayname
                }
            }
        }
        return { sources: sources, total: totalAttribute };
    },
    getHealth: function (talents) {
        var totalAttribute = 0;
        for (var i = 0; i < talents.length; i++) {
            var ability = talents[i];
            if (ability.name.startsWith('special_bonus_hp_') && !ability.name.startsWith('special_bonus_hp_regen_')) {
                totalAttribute += ability.attributes[0].value[0];
            }
        }
        return totalAttribute;
    },
    getHealthRegen: function (talents) {
        var totalAttribute = 0;
        for (var i = 0; i < talents.length; i++) {
            var ability = talents[i];
            if (ability.name.startsWith('special_bonus_hp_regen_')) {
                totalAttribute += ability.attributes[0].value[0];
            }
        }
        return totalAttribute;
    },
    getMana: function (talents) {
        var totalAttribute = 0;
        for (var i = 0; i < talents.length; i++) {
            var ability = talents[i];
            if (ability.name.startsWith('special_bonus_mp_') && !ability.name.startsWith('special_bonus_mp_regen_')) {
                totalAttribute += ability.attributes[0].value[0];
            }
        }
        return totalAttribute;
    },
    getManaRegen: function (talents) {
        var totalAttribute = 0;
        for (var i = 0; i < talents.length; i++) {
            var ability = talents[i];
            if (ability.name.startsWith('special_bonus_mp_regen_')) {
                totalAttribute += ability.attributes[0].value[0];
            }
        }
        return totalAttribute;
    },
    getArmor: function (talents) {
        var totalAttribute = 0;
        for (var i = 0; i < talents.length; i++) {
            var ability = talents[i];
            if (ability.name.startsWith('special_bonus_armor_')) {
                totalAttribute += ability.attributes[0].value[0];
            }
        }
        return totalAttribute;
    },
    getMovementSpeedFlat: function (talents) {
        var totalAttribute = 0;
        for (var i = 0; i < talents.length; i++) {
            var ability = talents[i];
            if (ability.name.startsWith('special_bonus_movement_speed_')) {
                totalAttribute += ability.attributes[0].value[0];
            }
        }
        return totalAttribute;
    },
    getAttackRange: function (talents) {
        var totalAttribute = 0;
        for (var i = 0; i < talents.length; i++) {
            var ability = talents[i];
            if (ability.name.startsWith('special_bonus_attack_range_')) {
                totalAttribute += ability.attributes[0].value[0];
            }
        }
        return totalAttribute;
    },
    getAttackSpeed: function (talents) {
        var totalAttribute = 0;
        for (var i = 0; i < talents.length; i++) {
            var ability = talents[i];
            if (ability.name.startsWith('special_bonus_attack_speed_')) {
                totalAttribute += ability.attributes[0].value[0];
            }
        }
        return totalAttribute;
    },
    getLifesteal: function (talents) {
        var totalAttribute = 0;
        for (var i = 0; i < talents.length; i++) {
            var ability = talents[i];
            if (ability.name.startsWith('special_bonus_lifesteal_')) {
                totalAttribute += ability.attributes[0].value[0];
            }
        }
        return totalAttribute;
    },
    getEvasion: function (talents) {
        var totalAttribute = 1;
        for (var i = 0; i < talents.length; i++) {
            var ability = talents[i];
            if (ability.name.startsWith('special_bonus_evasion_')) {
                totalAttribute *= (1 - ability.attributes[0].value[0]/100);
            }
        }
        return totalAttribute;
    },
    getMagicResist: function (talents) {
        var totalAttribute = 1;
        for (var i = 0; i < talents.length; i++) {
            var ability = talents[i];
            if (ability.name.startsWith('special_bonus_magic_resistance_')) {
                totalAttribute *= (1 - ability.attributes[0].value[0]/100);
            }
        }
        return totalAttribute;
    },
    getRespawnReduction: function (talents) {
        var totalAttribute = 0;
        for (var i = 0; i < talents.length; i++) {
            var ability = talents[i];
            if (ability.name.startsWith('special_bonus_respawn_reduction_')) {
                totalAttribute += ability.attributes[0].value[0];
            }
        }
        return totalAttribute;
    },
    getStrength: function (talents) {
        var totalAttribute = 0;
        for (var i = 0; i < talents.length; i++) {
            var ability = talents[i];
            if (ability.name.startsWith('special_bonus_strength_')) {
                totalAttribute += ability.attributes[0].value[0];
            }
            else if (ability.name.startsWith('special_bonus_all_stats_')) {
                totalAttribute += ability.attributes[0].value[0];
            }
        }
        return totalAttribute;
    },
    getAgility: function (talents) {
        var totalAttribute = 0;
        for (var i = 0; i < talents.length; i++) {
            var ability = talents[i];
            if (ability.name.startsWith('special_bonus_agility_')) {
                totalAttribute += ability.attributes[0].value[0];
            }
            else if (ability.name.startsWith('special_bonus_all_stats_')) {
                totalAttribute += ability.attributes[0].value[0];
            }
        }
        return totalAttribute;
    },
    getIntelligence: function (talents) {
        var totalAttribute = 0;
        for (var i = 0; i < talents.length; i++) {
            var ability = talents[i];
            if (ability.name.startsWith('special_bonus_intelligence_')) {
                totalAttribute += ability.attributes[0].value[0];
            }
            else if (ability.name.startsWith('special_bonus_all_stats_')) {
                totalAttribute += ability.attributes[0].value[0];
            }
        }
        return totalAttribute;
    }
}
},{}],14:[function(require,module,exports){
'use strict';
var ko = require('../herocalc_knockout');

var AbilityModel = require("../AbilityModel");
var HeroModel = require("./HeroModel");

var UnitModel = function (heroData, itemData, unitData, h, p) {
    var self = this;
    HeroModel.call(this, heroData, itemData, 'abaddon');
    self.parent = p;
    self.unitId = ko.observable(h);
    self.unitLevel = ko.observable(1);

    self.heroData = ko.computed(function() {
        return unitData[self.unitId()];
    });
    self.getAbilityLevelMax = function(data) {
        if (data.abilitytype == 'DOTA_ABILITY_TYPE_ATTRIBUTES') {
            return 10;
        }
        else if (data.name == 'necronomicon_archer_mana_burn' || data.name == 'necronomicon_archer_aoe'
            || data.name == 'necronomicon_warrior_mana_burn' || data.name == 'necronomicon_warrior_last_will') {
            return 3;
        }
        else if (data.name == 'necronomicon_warrior_sight') {
            return 1;
        }
        else {
            return 4;
        }
    };
    self.availableSkillPoints.dispose();
    self.ability = ko.computed(function() {
        var a = new AbilityModel(ko.observableArray(JSON.parse(JSON.stringify(self.heroData().abilities))), self);
        a.hasScepter = self.inventory.hasScepter
        switch (self.unitId()) {
            case 'npc_dota_necronomicon_archer_1':
            case 'npc_dota_necronomicon_warrior_1':
                a.abilities()[0].level(1);
                a.abilities()[1].level(1);
            break;
            case 'npc_dota_necronomicon_archer_2':
            case 'npc_dota_necronomicon_warrior_2':
                a.abilities()[0].level(2);
                a.abilities()[1].level(2);
            break;
            case 'npc_dota_necronomicon_archer_3':
                a.abilities()[0].level(3);
                a.abilities()[1].level(3);
            break;
            case 'npc_dota_necronomicon_warrior_3':
                a.abilities()[0].level(3);
                a.abilities()[1].level(3);
                a.abilities()[2].level(1);
            break;
        }
        a.levelUpAbility = function(index, data, event, hero) {
            var i = ko.utils.unwrapObservable(index);
            switch (a.abilities()[i].name) {
                case 'necronomicon_archer_mana_burn':
                case 'necronomicon_archer_aoe':
                case 'necronomicon_warrior_mana_burn':
                case 'necronomicon_warrior_last_will':
                case 'necronomicon_warrior_sight':
                break;
                default:
                    if (a.abilities()[i].level() < hero.getAbilityLevelMax(data)) {
                        a.abilities()[i].level(a.abilities()[i].level()+1);
                    }                    
                break;
            }

        };
        a.levelDownAbility = function(index, data, event, hero) {            
            var i = ko.utils.unwrapObservable(index);
            switch (a.abilities()[i].name) {
                case 'necronomicon_archer_mana_burn':
                case 'necronomicon_archer_aoe':
                case 'necronomicon_warrior_mana_burn':
                case 'necronomicon_warrior_last_will':
                case 'necronomicon_warrior_sight':
                break;
                default:
                    if (a.abilities()[i].level()>0) {
                        a.abilities()[i].level(a.abilities()[i].level()-1);
                    }
                break;
            }
        };
        return a;
    });        
    self.primaryAttribute = ko.computed(function() {
        //var v = unitData[self.unitId()].attributeprimary;
        var v = 0;
        if (v == 'DOTA_ATTRIBUTE_AGILITY') {
            return 'agi'
        }
        else if (v == 'DOTA_ATTRIBUTE_INTELLECT') {
            return 'int'
        }
        else if (v == 'DOTA_ATTRIBUTE_STRENGTH') {
            return 'str'
        }
        else {
            return ''
        }
    });
    self.totalAttribute = function(a) {
        if (a == 'agi') {
            return parseFloat(self.totalAgi());
        }
        if (a == 'int') {
            return parseFloat(self.totalInt());
        }
        if (a == 'str') {
            return parseFloat(self.totalStr());
        }
        return 0;
    };
    self.totalAgi = ko.computed(function() {
        return (unitData[self.unitId()].attributebaseagility
                + unitData[self.unitId()].attributeagilitygain * (self.selectedHeroLevel() - 1) 
                //+ self.inventory.getAttributes('agi') 
                + self.ability().getAttributeBonusLevel()*2
                + self.ability().getAgility()
                + self.enemy().ability().getAllStatsReduction()
                + self.debuffs.getAllStatsReduction()
               ).toFixed(2);
    });
    self.totalInt = ko.computed(function() {
        return (unitData[self.unitId()].attributebaseintelligence 
                + unitData[self.unitId()].attributeintelligencegain * (self.selectedHeroLevel() - 1) 
                //+ self.inventory.getAttributes('int') 
                + self.ability().getAttributeBonusLevel()*2
                + self.ability().getIntelligence()
                + self.enemy().ability().getAllStatsReduction()
                + self.debuffs.getAllStatsReduction()
               ).toFixed(2);
    });
    self.totalStr = ko.computed(function() {
        return (unitData[self.unitId()].attributebasestrength 
                + unitData[self.unitId()].attributestrengthgain * (self.selectedHeroLevel() - 1) 
                //+ self.inventory.getAttributes('str') 
                + self.ability().getAttributeBonusLevel()*2
                + self.ability().getStrength()
                + self.enemy().ability().getAllStatsReduction()
                + self.debuffs.getAllStatsReduction()
               ).toFixed(2);
    });
    /*self.health = ko.computed(function() {
        return (unitData[self.unitId()].statushealth + self.totalStr()*19 
                + self.inventory.getHealth()
                + self.ability().getHealth()).toFixed(2);
    });
    self.healthregen = ko.computed(function() {
        return (unitData[self.unitId()].statushealthregen + self.totalStr()*.03 
                + self.inventory.getHealthRegen() 
                + self.ability().getHealthRegen()
                + self.buffs.getHealthRegen()).toFixed(2);
    });
    self.mana = ko.computed(function() {
        return (unitData[self.unitId()].statusmana + self.totalInt()*13 + self.inventory.getMana()).toFixed(2);
    });
    self.manaregen = ko.computed(function() {
        return ((unitData[self.unitId()].statusmanaregen 
                + self.totalInt()*.04 
                + self.ability().getManaRegen()) 
                * (1 + self.inventory.getManaRegenPercent()) 
                + (self.selectedHero().heroName == 'crystal_maiden' ? self.ability().getManaRegenArcaneAura() * 2 : self.buffs.getManaRegenArcaneAura())
                + self.inventory.getManaRegenBloodstone()
                - self.enemy().ability().getManaRegenReduction()).toFixed(2);
    });
    self.totalArmorPhysical = ko.computed(function() {
        return (self.enemy().ability().getArmorBaseReduction() * self.debuffs.getArmorBaseReduction() * (unitData[self.unitId()].armorphysical + self.totalAgi()*.14)
                + self.inventory.getArmor() + self.ability().getArmor() + self.enemy().ability().getArmorReduction() + self.buffs.getArmor() + self.debuffs.getArmorReduction()).toFixed(2);
    });
    self.totalArmorPhysicalReduction = ko.computed(function() {
        return ((0.06 * self.totalArmorPhysical()) / (1 + 0.06 * self.totalArmorPhysical()) * 100).toFixed(2);
    });
    self.totalMovementSpeed = ko.computed(function() {
        if (self.parent.ability().isShapeShiftActive()) {
            return 522;
        }
        var ms = (self.ability().setMovementSpeed() > 0 ? self.ability().setMovementSpeed() : self.buffs.setMovementSpeed());
        if (ms > 0) {
            return ms;
        }
        else {
            return ((unitData[self.unitId()].movementspeed + self.inventory.getMovementSpeedFlat()+ self.ability().getMovementSpeedFlat()) * 
                    (1 + self.inventory.getMovementSpeedPercent() 
                       + self.ability().getMovementSpeedPercent() 
                       + self.enemy().inventory.getMovementSpeedPercentReduction() 
                       + self.enemy().ability().getMovementSpeedPercentReduction() 
                       + self.buffs.getMovementSpeedPercent() 
                       + self.debuffs.getMovementSpeedPercentReduction()
                    )).toFixed(2);
        }
    });
    self.totalTurnRate = ko.computed(function() {
        return (unitData[self.unitId()].movementturnrate 
                * (1 + self.enemy().ability().getTurnRateReduction()
                     + self.debuffs.getTurnRateReduction())).toFixed(2);
    });
    */
    self.baseDamage = ko.computed(function() {
        return [Math.floor(unitData[self.unitId()].attackdamagemin + self.totalAttribute(self.primaryAttribute()) + self.ability().getBaseDamage().total),
                Math.floor(unitData[self.unitId()].attackdamagemax + self.totalAttribute(self.primaryAttribute()) + self.ability().getBaseDamage().total)];
    });
    /*self.bonusDamage = ko.computed(function() {
        return self.inventory.getBonusDamage().total
                + self.ability().getBonusDamage().total
                + self.buffs.getBonusDamage().total
                + Math.floor((self.baseDamage()[0] + self.baseDamage()[1])/2 
                              * (self.inventory.getBonusDamagePercent().total
                                 + self.ability().getBonusDamagePercent().total
                                 + self.buffs.getBonusDamagePercent().total
                                )
                            )
                + Math.floor(
                    (self.hero().attacktype() == 'DOTA_UNIT_CAP_RANGED_ATTACK' 
                        ? ((self.selectedHero().heroName == 'drow_ranger') ? self.ability().getBonusDamagePrecisionAura().total[0] * self.totalAgi() : self.buffs.getBonusDamagePrecisionAura().total[1])
                        : 0)
                  );
    });*/
    /*self.bonusDamageReduction = ko.computed(function() {
        return Math.abs(self.enemy().ability().getBonusDamageReduction() + self.debuffs.getBonusDamageReduction());
    });
    self.damage = ko.computed(function() {
        return [self.baseDamage()[0] + self.bonusDamage()[0],
                self.baseDamage()[1] + self.bonusDamage()[1]];
    });*/
    self.totalMagicResistanceProduct = ko.computed(function() {
        return (1 - unitData[self.unitId()].magicalresistance / 100) 
                   * (1 - self.inventory.getMagicResist() / 100) 
                   * (1 - self.ability().getMagicResist() / 100) 
                   * (1 - self.buffs.getMagicResist() / 100) 
                   * self.enemy().inventory.getMagicResistReduction()
                   * self.enemy().ability().getMagicResistReduction() 
                   * self.debuffs.getMagicResistReduction();
    });
    self.totalMagicResistance = ko.computed(function() {
        return (1 - self.totalMagicResistanceProduct());
    });
    self.bat = ko.computed(function() {
        var abilityBAT = self.ability().getBAT();
        if (abilityBAT > 0) {
            return abilityBAT;
        }
        return unitData[self.unitId()].attackrate;
    });
    /*
    self.ias = ko.computed(function() {
        var val = parseFloat(self.totalAgi()) 
                + self.inventory.getAttackSpeed() 
                + self.ability().getAttackSpeed() 
                + self.enemy().ability().getAttackSpeedReduction() 
                + self.buffs.getAttackSpeed() 
                + self.debuffs.getAttackSpeedReduction();
        if (val < -80) {
            return -80;
        }
        else if (val > 400) {
            return 400;
        }
        return (val).toFixed(2);
    });*/
    self.attackTime = ko.computed(function() {
        return (self.bat() / (1 + self.ias() / 100)).toFixed(2);
    });
    self.attacksPerSecond = ko.computed(function() {
        return (1 + self.ias() / 100) / self.bat();
    });
    self.evasion = ko.computed(function() {
        var e = self.ability().setEvasion();
        if (e) {
            return (e * 100).toFixed(2) + '%';
        }
        else {
            return ((1-(self.inventory.getEvasion() * self.ability().getEvasion())) * 100).toFixed(2) + '%';
        }
    });
    self.ehpPhysical = ko.computed(function() {
        return ((self.health() * (1 + .06 * self.totalArmorPhysical())) / (1-(1-(self.inventory.getEvasion() * self.ability().getEvasion())))).toFixed(2);
    });
    self.ehpMagical = ko.computed(function() {
        return (self.health() / self.totalMagicResistanceProduct()).toFixed(2);
    });
    self.heroId(h);
    self.unitId.subscribe(function (newValue) {
        self.heroId(newValue);
    });
    return self;
}
UnitModel.prototype = Object.create(HeroModel.prototype);
UnitModel.prototype.constructor = UnitModel;

module.exports = UnitModel;
},{"../AbilityModel":1,"../herocalc_knockout":21,"./HeroModel":10}],15:[function(require,module,exports){
var UnitOption = function (name, displayname, levels, image, level) {
    this.heroName = ko.computed(function() {
        return (levels > 0) ? name + (level() <= levels ? level() : 1) : name;
    });
    this.heroDisplayName = displayname;
    this.image = image;
    this.levels = levels;
};

module.exports = UnitOption;
},{}],16:[function(require,module,exports){
var diffProperties = [
    'totalAgi',
    'totalInt',
    'totalStr',
    'health',
    'healthregen',
    'mana',
    'manaregen',
    'totalArmorPhysical',
    'totalArmorPhysicalReduction',
    'totalMovementSpeed',
    'totalTurnRate',
    'baseDamage',
    'bonusDamage',
    'bonusDamageReduction',
    'damage',
    'totalMagicResistanceProduct',
    'totalMagicResistance',
    'bat',
    'ias',
    'attackTime',
    'attacksPerSecond',
    'evasion',
    'ehpPhysical',
    'ehpMagical',
    'bash',
    'critChance',
    //'critDamage',
    'missChance',
    'totalattackrange',
    'visionrangeday',
    'visionrangenight',
    'lifesteal'
];

module.exports = diffProperties;
},{}],17:[function(require,module,exports){
var HeroOption = require("./HeroOption");

var heroOptionsArray = {};

var init = function (heroData) {
    heroOptionsArray.items = [];
    for (var h in heroData) {
        heroOptionsArray.items.push(new HeroOption(h.replace('npc_dota_hero_', ''), heroData[h].displayname));
    }
    return heroOptionsArray.items;
}

heroOptionsArray.init = init;

module.exports = heroOptionsArray;
},{"./HeroOption":11}],18:[function(require,module,exports){
var nextLevelExp = [200, 300, 400, 500, 600, 600, 800, 1000, 1000, 600, 2200, 800, 1400, 1500, 1600, 1700, 1800, 1900, 2000, 2100, 2200, 2300, 2400, 2500, '&mdash;'];

module.exports = nextLevelExp;
},{}],19:[function(require,module,exports){
var totalExp = [0, 200, 500, 900, 1400, 2000, 2600, 3400, 4400, 5400, 6000, 8200, 9000, 10400, 11900, 13500, 15200, 17000, 18900, 20900, 23000, 25200, 27500, 29900, 32400];

module.exports = totalExp;
},{}],20:[function(require,module,exports){
var abilityData = {
    'alchemist_acid_spray': [
        {
            label: 'Duration',
            controlType: 'input'
        },
        {
            attributeName: 'damage',
            label: 'Total Damage',
            controlType: 'text',
            fn: function (v, a, parent, index, abilityModel, ability) {
                return v*a;
            }
        },
        {
            attributeName: 'armor_reduction',
            label: 'Total Damage',
            controlType: 'text',
            fn: function (v, a, parent, index, abilityModel, ability) {
                return -a;
            },
            returnProperty: 'armorReduction'
        }
    ],
    'alchemist_unstable_concoction': [
        {
            label: 'Brew Time',
            controlType: 'input'
        },
        {
            attributeName: 'max_damage',
            label: 'Total Damage',
            controlType: 'text',
            fn: function (v, a, parent, index, abilityModel, ability) {
                return v*a/5;
            }
        },
        {
            attributeName: 'max_stun',
            label: 'Total Stun',
            controlType: 'text',
            fn: function (v, a, parent, index, abilityModel, ability) {
                return v*a/5;
            }
        }
    ],
    'ancient_apparition_cold_feet': [
        {
            label: 'Duration',
            controlType: 'input'
        },
        {
            attributeName: 'damage',
            label: 'Total Damage',
            controlType: 'text',
            fn: function (v, a, parent, index, abilityModel, ability) {
                return v*a;
            }
        },
        {
            attributeName: 'stun_duration',
            label: 'Total Stun',
            controlType: 'text',
            fn: function (v, a, parent, index, abilityModel, ability) {
                return a;
            }
        }
    ],
    'ancient_apparition_ice_blast': [
        {
            label: 'Duration',
            controlType: 'input'
        },
        {
            attributeName: 'dot_damage',
            label: 'Total Damage',
            controlType: 'text',
            fn: function (v, a, parent, index, abilityModel, ability) {
                return abilityModel.getAbilityPropertyValue(ability, 'damage')+v*a;
            }
        }
    ],
    'antimage_mana_void': [
        {
            label: 'Enemy Missing Mana',
            controlType: 'input'
        },
        {
            attributeName: 'mana_void_damage_per_mana',
            label: 'Total Damage',
            controlType: 'text',
            fn: function (v, a, parent, index, abilityModel, ability) {
                return v*a;
            }
        }
    ],
    'axe_battle_hunger': [
        {
            label: 'Battle Hungered Enemies',
            controlType: 'input'
        },
        {
            attributeName: 'speed_bonus',
            label: 'Movement Speed Bonus',
            controlType: 'text',
            noLevel: true,
            fn: function (v, a, parent, index, abilityModel, ability) {
                return v*a;
            },
            returnProperty: 'movementSpeedPct'
        },
        {
            attributeName: 'slow',
            label: 'Movement Speed Bonus',
            controlType: 'text',
            noLevel: true,
            fn: function (v, a, parent, index, abilityModel, ability) {
                return a;
            },
            returnProperty: 'movementSpeedPctReduction'
        }
    ],
    'bane_nightmare': [
        {
            label: 'Duration',
            controlType: 'input'
        },
        {
            label: 'DAMAGE:',
            controlType: 'text',
            fn: function (v, a, parent, index, abilityModel, ability) {
                return abilityModel.getAbilityPropertyValue(ability, 'damage')*v;
            }
        }
    ],
    'bane_fiends_grip': [
        {
            label: 'Duration',
            controlType: 'input'
        },
        {
            label: 'Enemy Max Mana',
            controlType: 'input'
        },
        {
            attributeName: 'fiend_grip_damage',
            label: 'Total Damage',
            controlType: 'text',
            controls: [0,1],
            fn: function (v, a, parent, index, abilityModel, ability) {
                if (parent.inventory.hasScepter()) {
                    return v[0]*abilityModel.getAbilityAttributeValue(ability.attributes, 'fiend_grip_damage_scepter',ability.level());
                }
                else {
                    return v[0]*a;
                }
            }
        },
        {
            attributeName: 'fiend_grip_mana_drain',
            label: 'Total Mana Drain',
            controlType: 'text',
            controls: [0,1],
            noLevel: true,
            fn: function (v, a, parent, index, abilityModel, ability) {
                if (parent.inventory.hasScepter()) {
                    return v[0]*v[1]*abilityModel.getAbilityAttributeValue(ability.attributes, 'fiend_grip_mana_drain_scepter',ability.level())/100;
                }
                else {
                    return v[0]*v[1]*a/100;
                }
            }
        }
    ],
    'batrider_sticky_napalm': [
        {
            label: 'Stacks',
            controlType: 'input'
        },
        {
            attributeName: 'damage',
            label: 'Total Bonus Damage',
            controlType: 'text',
            fn: function (v, a, parent, index, abilityModel, ability) {
                return v*a;
            },
            returnProperty: 'bonusDamage'
        },
        {
            attributeName: 'movement_speed_pct',
            label: 'Enemy Movement Speed Slow',
            controlType: 'text',
            fn: function (v, a, parent, index, abilityModel, ability) {
                return v*a;
            },
            returnProperty: 'movementSpeedPctReduction'
        },
        {
            attributeName: 'turn_rate_pct',
            label: 'Enemy Turn Rate Slow',
            controlType: 'text',
            fn: function (v, a, parent, index, abilityModel, ability) {
                return a;
            },
            returnProperty: 'turnRateReduction'
        }
    ],
    'batrider_firefly': [
        {
            label: 'Duration',
            controlType: 'input'
        },
        {
            attributeName: 'damage_per_second',
            label: 'Total Damage',
            controlType: 'text',
            fn: function (v, a, parent, index, abilityModel, ability) {
                return v*a;
            }
        }
    ],
    'bloodseeker_rupture': [
        {
            label: 'Enemy Distance Traveled',
            controlType: 'input'
        },
        {
            attributeName: 'movement_damage_pct',
            label: 'DAMAGE:',
            ignoreTooltip: true,
            controlType: 'text',
            fn: function (v, a, parent, index, abilityModel, ability) {
                return abilityModel.getAbilityPropertyValue(ability, 'damage') + v*a/100;
            }
        }
    ],
    'bristleback_viscous_nasal_goo': [
        {
            label: 'Stacks',
            controlType: 'input'
        },
        {
            attributeName: 'armor_per_stack',
            label: 'Enemy Armor Reduction',
            controlType: 'text',
            fn: function (v, a, parent, index, abilityModel, ability) {
                return -v*a;
            },
            returnProperty: 'armorReduction'
        },
        {
            attributeName: 'move_slow_per_stack',
            label: '%SLOW:',
            ignoreTooltip: true,
            controlType: 'text',
            fn: function (v, a, parent, index, abilityModel, ability) {
                return -(abilityModel.getAbilityAttributeValue(ability.attributes, 'base_move_slow',0)+v*a);
            },
            returnProperty: 'movementSpeedPctReduction'
        }
    ],
    'bristleback_quill_spray': [
        {
            label: 'Stacks',
            controlType: 'input'
        },
        {
            attributeName: 'quill_stack_damage',
            label: 'DAMAGE',
            controlType: 'text',
            fn: function (v, a, parent, index, abilityModel, ability) {
                var total = abilityModel.getAbilityAttributeValue(ability.attributes, 'quill_base_damage',ability.level())+v*a,
                damage_cap = abilityModel.getAbilityAttributeValue(ability.attributes, 'max_damage',0);
                if (total > damage_cap) {
                    total = damage_cap;
                }
                return total;
            }
        }
    ],
    'bristleback_bristleback': [
        {
            label: 'Damage From',
            controlType: 'radio',
            controlValueType: 'string',
            controlOptions: [
                {text: 'Back', value: 'back'},
                {text: 'Side', value: 'side'}
            ]
        },
        {
            attributeName: 'back_damage_reduction',
            label: '%DAMAGE REDUCTION:',
            ignoreTooltip: true,
            controlType: 'text',
            fn: function (v, a, parent, index, abilityModel, ability) {
                var ability = abilityModel.abilities().find(function(b) {
                    return b.name == 'bristleback_bristleback';
                });
                if (v == 'back') {
                    var total = abilityModel.getAbilityAttributeValue(ability.attributes, 'back_damage_reduction', ability.level());
                }
                else {
                    var total = abilityModel.getAbilityAttributeValue(ability.attributes, 'side_damage_reduction', ability.level());
                }
                return -total;
            },
            returnProperty: 'damageReduction'
        }
    ],
    'bristleback_warpath': [
        {
            label: 'Stacks',
            controlType: 'input'
        },
        {
            attributeName: 'damage_per_stack',
            label: 'BONUS DAMAGE:',
            ignoreTooltip: true,
            controlType: 'text',
            fn: function (v, a, parent, index, abilityModel, ability) {
                if (v < 1) {
                    return 0;
                }
                else {
                    return abilityModel.getAbilityAttributeValue(ability.attributes, 'base_damage',ability.level())+(v-1)*a;
                }
            }
        },
        {
            attributeName: 'move_speed_per_stack',
            label: '%MOVEMENT:',
            ignoreTooltip: true,
            controlType: 'text',
            fn: function (v, a, parent, index, abilityModel, ability) {
                if (v < 1) {
                    return 0;
                }
                else {
                    return abilityModel.getAbilityAttributeValue(ability.attributes, 'base_move_speed',ability.level())+(v-1)*a;
                }
            },
            returnProperty: 'movementSpeedPct'
        }
    ],
    'centaur_return': [
        {
            label: 'Strength',
            controlType: 'input'
        },
        {
            attributeName: 'strength_pct',
            label: 'DAMAGE:',
            controlType: 'text',
            fn: function (v, a, parent, index, abilityModel, ability) {
                return abilityModel.getAbilityAttributeValue(ability.attributes, 'return_damage',ability.level()) + v*a/100;
            }
        }
    ],
    'centaur_stampede': [
        {
            label: 'Strength',
            controlType: 'input'
        },
        {
            attributeName: 'strength_damage',
            label: 'DAMAGE:',
            ignoreTooltip: true,
            controlType: 'text',
            fn: function (v, a, parent, index, abilityModel, ability) {
                return v*a;
            }
        },
        {
            attributeName: 'slow_movement_speed',
            label: 'Enemy Movement Speed Slow',
            controlType: 'text',
            fn: function (v, a, parent, index, abilityModel, ability) {
                return -a;
            },
            returnProperty: 'movementSpeedPctReduction'
        }
    ],
    'clinkz_death_pact': [
        {
            label: 'Consumed Unit HP',
            controlType: 'input'
        },
        {
            attributeName: 'damage_gain_pct',
            label: 'BASE DAMAGE GAIN:',
            ignoreTooltip: true,
            controlType: 'text',
            fn: function (v, a, parent, index, abilityModel, ability) {
                return v*a/100;
            },
            returnProperty: 'baseDamage'
        },
        {
            attributeName: 'health_gain_pct',
            label: 'HEALTH GAIN:',
            ignoreTooltip: true,
            controlType: 'text',
            fn: function (v, a, parent, index, abilityModel, ability) {
                return v*a/100;
            },
            returnProperty: 'bonusHealth'
        }
    ],
    'crystal_maiden_frostbite': [
        {
            label: 'Duration',
            controlType: 'input'
        },
        {
            label: 'DAMAGE:',
            controlType: 'text',
            fn: function (v, a, parent, index, abilityModel, ability) {
                return abilityModel.getAbilityPropertyValue(ability, 'damage')*v;
            }
        }
    ],
    'dark_seer_ion_shell': [
        {
            label: 'Duration',
            controlType: 'input'
        },
        {
            attributeName: 'damage_per_second',
            label: 'Total Damage',
            controlType: 'text',
            fn: function (v, a, parent, index, abilityModel, ability) {
                return v*a;
            }
        }
    ],
    'dazzle_shadow_wave': [
        {
            label: 'Targets',
            controlType: 'input'
        },
        {
            label: 'DAMAGE:',
            controlType: 'text',
            fn: function (v, a, parent, index, abilityModel, ability) {
                return abilityModel.getAbilityPropertyValue(ability, 'damage')*v;
            }
        }
    ],
    'dazzle_weave': [
        {
            label: 'Duration',
            controlType: 'input'
        },
        {
            attributeName: 'armor_per_second',
            label: 'ARMOR',
            ignoreTooltip: true,
            controlType: 'text',
            fn: function (v, a, parent, index, abilityModel, ability) {
                return v*a;
            },
            returnProperty: 'armor'
        },
        {
            attributeName: 'armor_per_second',
            label: 'ARMOR REDUCTION:',
            ignoreTooltip: true,
            controlType: 'text',
            fn: function (v, a, parent, index, abilityModel, ability) {
                return -v*a;
            },
            returnProperty: 'armorReduction'
        }
    ],
    'death_prophet_exorcism': [
        {
            label: 'Damage Dealt',
            controlType: 'input'
        },
        {
            attributeName: 'heal_percent',
            label: 'Total Armor',
            controlType: 'text',
            fn: function (v, a, parent, index, abilityModel, ability) {
                return v*a/100;
            }
        }
    ],
    'disruptor_static_storm': [
        {
            label: 'Duration',
            controlType: 'input'
        },
        {
            label: 'DAMAGE:',
            controlType: 'text',
            fn: function (v, a, parent, index, abilityModel, ability) {
                var damagevalue = 0.25 * (130 + 40 * ability.level()) * (1/20),
                mult = (v*4)*((v*4)+1)/2;
                return damagevalue * mult;
            }
        }
    ],
    'doom_bringer_scorched_earth': [
        {
            label: 'Duration',
            controlType: 'input'
        },
        {
            attributeName: 'damage_per_second',
            label: 'Total Damage',
            controlType: 'text',
            fn: function (v, a, parent, index, abilityModel, ability) {
                return v*a;
            }
        },
        {
            attributeName: 'bonus_movement_speed_pct',
            label: 'Total Damage',
            controlType: 'text',
            fn: function (v, a, parent, index, abilityModel, ability) {
                return a;
            },
            returnProperty: 'movementSpeedPct'
        },
        {
            attributeName: 'damage_per_second',
            label: 'HP REGEN:',
            ignoreTooltip: true,
            controlType: 'text',
            fn: function (v, a, parent, index, abilityModel, ability) {
                return a;
            },
            returnProperty: 'healthregen'
        }
    ],
    'doom_bringer_doom': [
        {
            label: 'Duration',
            controlType: 'input'
        },
        {
            attributeName: 'damage',
            label: 'Total Damage',
            controlType: 'text',
            fn: function (v, a, parent, index, abilityModel, ability) {
                if (parent.inventory.hasScepter()) {
                    return v*abilityModel.getAbilityAttributeValue(ability.attributes, 'damage_scepter',ability.level());
                }
                else {
                    return v*a;
                }
            }
        }
    ],
    'dragon_knight_elder_dragon_form': [
        {
            label: 'Duration',
            controlType: 'input'
        },
        {
            attributeName: 'bonus_attack_range',
            label: 'Total Damage',
            controlType: 'text',
            fn: function (v, a, parent, index, abilityModel, ability) {
                return a;
            },
            returnProperty: 'attackrange'
        },
        {
            attributeName: 'bonus_movement_speed',
            label: 'Total Damage',
            controlType: 'text',
            fn: function (v, a, parent, index, abilityModel, ability) {
                return a;
            },
            returnProperty: 'movementSpeedFlat'
        }
    ],
    'drow_ranger_trueshot': [
        {
            label: 'Drow\'s Agility',
            controlType: 'input',
            display: 'buff'
        },
        {
            attributeName: 'trueshot_ranged_damage',
            label: 'DAMAGE BONUS:',
            ignoreTooltip: true,
            controlType: 'text',
            display: 'buff',
            fn: function (v, a, parent, index, abilityModel, ability) {
                return v*a/100;
            },
            returnProperty: 'bonusDamagePrecisionAura'
        }
    ],
    'earth_spirit_rolling_boulder': [
        {
            label: 'Using Stone',
            controlType: 'checkbox'
        },
        {
            attributeName: 'move_slow',
            label: 'Total Damage',
            controlType: 'text',
            fn: function (v, a, parent, index, abilityModel, ability) {
                if (v) {
                    return -a;
                }
                else {
                    return 0;
                }
            },
            returnProperty: 'movementSpeedPctReduction'
        }
    ],
    'earthshaker_enchant_totem': [
        {
            label: 'Activated',
            controlType: 'checkbox'
        },
        {
            attributeName: 'totem_damage_percentage',
            label: 'DAMAGE',
            controlType: 'text',
            fn: function (v, a, parent, index, abilityModel, ability) {
                if (v) {
                    return a;
                }
                else {
                    return 0;
                }
            },
            returnProperty: 'baseDamageMultiplier'
        }
    ],
    'earthshaker_echo_slam': [
        {
            label: 'Enemies in Range',
            controlType: 'input'
        },
        {
            attributeName: 'echo_slam_echo_damage',
            label: 'Total Damage',
            controlType: 'text',
            fn: function (v, a, parent, index, abilityModel, ability) {
                return v*a;
            }
        }
    ],
    'elder_titan_ancestral_spirit': [
        {
            label: 'HEROES PASSED THROUGH',
            controlType: 'input'
        },
        {
            label: 'CREEPS PASSED THROUGH',
            controlType: 'input'
        },
        {
            attributeName: 'damage_creeps',
            label: 'DAMAGE:',
            ignoreTooltip: true,
            controlType: 'text',
            controls: [0,1],
            fn: function (v, a, parent, index, abilityModel, ability) {
                return v[0]*abilityModel.getAbilityAttributeValue(ability.attributes, 'damage_heroes',ability.level()) + v[1]*a;
            },
            returnProperty: 'bonusDamage'
        },
        {
            attributeName: 'move_pct_creeps',
            label: '%BONUS SPEED:',
            ignoreTooltip: true,
            controlType: 'text',
            controls: [0,1],
            fn: function (v, a, parent, index, abilityModel, ability) {
                return v[0]*abilityModel.getAbilityAttributeValue(ability.attributes, 'move_pct_heroes',ability.level()) + v[1]*a;
            },
            returnProperty: 'movementSpeedPct'
        }
    ],
    'elder_titan_earth_splitter': [
        {
            label: 'Enemy Max Health',
            controlType: 'input'
        },
        {
            attributeName: 'damage_pct',
            label: 'Total Damage',
            controlType: 'text',
            fn: function (v, a, parent, index, abilityModel, ability) {
                return v*a/100;
            }
        },
        {
            attributeName: 'slow_pct',
            label: 'Total Damage',
            controlType: 'text',
            fn: function (v, a, parent, index, abilityModel, ability) {
                return -a;
            },
            returnProperty: 'movementSpeedPctReduction'
        }
    ],
    'enchantress_natures_attendants': [
        {
            label: 'Duration',
            controlType: 'input'
        },
        {
            attributeName: 'heal',
            label: 'HEAL:',
            ignoreTooltip: true,
            controlType: 'text',
            fn: function (v, a, parent, index, abilityModel, ability) {
                return abilityModel.getAbilityAttributeValue(ability.attributes, 'wisp_count',ability.level())*v*a;
            }
        }
    ],
    'enigma_malefice': [
        {
            label: 'Hits',
            controlType: 'input'
        },
        {
            attributeName: 'damage',
            label: 'DAMAGE:',
            ignoreTooltip: true,
            controlType: 'text',
            fn: function (v, a, parent, index, abilityModel, ability) {
                return v*a;
            }
        },
        {
            attributeName: 'stun_duration',
            label: 'Total Damage',
            controlType: 'text',
            fn: function (v, a, parent, index, abilityModel, ability) {
                return v*a;
            }
        }
    ],
    'enigma_midnight_pulse': [
        {
            label: 'Duration',
            controlType: 'input'
        },
        {
            label: 'Enemy Max Health',
            controlType: 'input'
        },
        {
            attributeName: 'damage_percent',
            label: 'DAMAGE:',
            ignoreTooltip: true,
            controlType: 'text',
            controls: [0,1],
            fn: function (v, a, parent, index, abilityModel, ability) {
                return v[0]*v[1]*a/100;
            }
        }
    ],
    'enigma_black_hole': [
        {
            label: 'Duration',
            controlType: 'input'
        },
        {
            attributeName: 'far_damage',
            label: 'Total Damage',
            controlType: 'text',
            fn: function (v, a, parent, index, abilityModel, ability) {
                return v*a;
            }
        },
        {
            attributeName: 'near_damage',
            label: 'Total Damage',
            controlType: 'text',
            fn: function (v, a, parent, index, abilityModel, ability) {
                return v*a;
            }
        }
    ],
    'faceless_void_time_lock': [
        {
            label: 'In Chronosphere',
            controlType: 'checkbox'
        },
        {
            attributeName: 'bonus_damage',
            label: '%MOVESPEED AS DAMAGE',
            controlType: 'text',
            fn: function (v, a, parent, index, abilityModel, ability) {
                if (v) {
                    return a*2;
                }
                else {
                    return a;
                }
            },
            returnProperty: 'bashBonusDamage'
        },
        {
            attributeName: 'duration',
            label: 'Total Damage',
            controlType: 'text',
            fn: function (v, a, parent, index, abilityModel, ability) {
                return a;
            }
        },
        {
            attributeName: 'chance_pct',
            label: 'Total Damage',
            controlType: 'text',
            fn: function (v, a, parent, index, abilityModel, ability) {
                return a;
            },
            returnProperty: 'bash'
        }
    ],
    'gyrocopter_rocket_barrage': [
        {
            label: 'Rockets',
            controlType: 'input'
        },
        {
            attributeName: 'rockets_per_second',
            label: 'Total Damage',
            controlType: 'text',
            fn: function (v, a, parent, index, abilityModel, ability) {
                return a;
            }
        },
        {
            label: 'DAMAGE:',
            controlType: 'text',
            fn: function (v, a, parent, index, abilityModel, ability) {
                return abilityModel.getAbilityPropertyValue(ability, 'damage')*v;
            }
        }
    ],
/*        'gyrocopter_homing_missile': [
        {
            label: 'Distance Traveled',
            controlType: 'input'
        },
        {
            attributeName: 'damage',
            label: 'Total Damage',
            controlType: 'text',
            fn: function (v, a, parent, index, abilityModel, ability) {
                return v*a;
            }
        }
    ],
    'gyrocopter_flak_cannon': [
        {
            label: 'Attacks',
            controlType: 'input'
        },
        {
            attributeName: 'damage',
            label: 'Total Damage',
            controlType: 'text',
            fn: function (v, a, parent, index, abilityModel, ability) {
                return v*a;
            }
        }
    ],*/
    'huskar_burning_spear': [
        {
            label: 'Stacks',
            controlType: 'input'
        },
        {
            attributeName: 'health_cost',
            label: 'Total Damage',
            controlType: 'text',
            fn: function (v, a, parent, index, abilityModel, ability) {
                return v*a;
            }
        },
        {
            label: 'DAMAGE:',
            controlType: 'text',
            fn: function (v, a, parent, index, abilityModel, ability) {
                return abilityModel.getAbilityPropertyValue(ability, 'damage')*v;
            }
        }
    ],
    'huskar_berserkers_blood': [
        {
            label: '%HP',
            controlType: 'input'
        },
        {
            attributeName: 'hp_threshold_max',
            label: 'Health at given %HP:',
            ignoreTooltip: true,
            controlType: 'text',
            fn: function (v, a, parent, index, abilityModel, ability) {
                return parent.health()*v/100;
            }
        },
        {
            attributeName: 'hp_threshold_max',
            label: 'Total Damage',
            controlType: 'text',
            fn: function (v, a, parent, index, abilityModel, ability) {
                return a;
            }
        },
        {
            attributeName: 'maximum_resistance',
            label: 'MAGIC RESISTANCE BONUS:',
            ignoreTooltip: true,
            controlType: 'text',
            fn: function (v, a, parent, index, abilityModel, ability) {
                var v = Math.min(v, 100);
                v = Math.max(v, 10);
                var hp_threshold_max = abilityModel.getAbilityAttributeValue(ability.attributes, 'hp_threshold_max',0);
                var d = 100 - hp_threshold_max;
                var c = (v - hp_threshold_max) / d;
                c = 1 - c;
                return c*a;
            },
            returnProperty: 'magicResist'
        },
        {
            attributeName: 'maximum_attack_speed',
            label: 'ATTACK SPEED BONUS:',
            ignoreTooltip: true,
            controlType: 'text',
            fn: function (v, a, parent, index, abilityModel, ability) {
                var v = Math.min(v, 100);
                v = Math.max(v, 10);
                var hp_threshold_max = abilityModel.getAbilityAttributeValue(ability.attributes, 'hp_threshold_max',0);
                var d = 100 - hp_threshold_max;
                var c = (v - hp_threshold_max) / d;
                c = 1 - c;
                return c*a;
            },
            returnProperty: 'attackspeed'
        }
    ],
    'huskar_life_break': [
        {
            label: 'Enemy Current HP',
            controlType: 'input'
        },
        {
            attributeName: 'health_damage',
            label: 'DAMAGE:',
            ignoreTooltip: true,
            controlType: 'text',
            fn: function (v, a, parent, index, abilityModel, ability) {
                return v*a;
            }
        },
        {
            label: 'Huskar Current HP',
            controlType: 'input'
        },
        {
            attributeName: 'health_cost_percent',
            label: 'DAMAGE TAKEN:',
            ignoreTooltip: true,
            controlType: 'text',
            fn: function (v, a, parent, index, abilityModel, ability) {
                return v*a;
            }
        },
        {
            attributeName: 'movespeed',
            label: 'Total Damage',
            controlType: 'text',
            fn: function (v, a, parent, index, abilityModel, ability) {
                return a;
            },
            returnProperty: 'movementSpeedPctReduction'
        }
    ],
    'invoker_quas': [
        {
            label: 'Instances',
            controlType: 'input'
        },
        /*{
            attributeName: 'bonus_strength',
            label: 'Total Damage',
            controlType: 'text',
            fn: function (v, a, parent, index, abilityModel, ability) {
                return a;
            },
            returnProperty: 'bonusStrength'
        },*/
        {
            attributeName: 'health_regen_per_instance',
            label: 'HP REGEN:',
            ignoreTooltip: true,
            controlType: 'text',
            fn: function (v, a, parent, index, abilityModel, ability) {
                return v*a;
            },
            returnProperty: 'healthregen'
        }
    ],
    'invoker_wex': [
        {
            label: 'Instances',
            controlType: 'input'
        },
        /*{
            attributeName: 'bonus_agility',
            label: 'Total Damage',
            controlType: 'text',
            fn: function (v, a, parent, index, abilityModel, ability) {
                return a;
            },
            returnProperty: 'bonusAgility'
        },*/
        {
            attributeName: 'move_speed_per_instance',
            label: '%MOVE SPEED:',
            ignoreTooltip: true,
            controlType: 'text',
            fn: function (v, a, parent, index, abilityModel, ability) {
                return v*a;
            },
            returnProperty: 'movementSpeedPct'
        },
        {
            attributeName: 'attack_speed_per_instance',
            label: '%ATTACK SPEED:',
            ignoreTooltip: true,
            controlType: 'text',
            fn: function (v, a, parent, index, abilityModel, ability) {
                return v*a;
            },
            returnProperty: 'attackspeed'
        }
    ],
    'invoker_exort': [
        {
            label: 'Instances',
            controlType: 'input'
        },
        /*{
            attributeName: 'bonus_intelligence',
            label: 'Total Damage',
            controlType: 'text',
            fn: function (v, a, parent, index, abilityModel, ability) {
                return a;
            },
            returnProperty: 'bonusInt'
        },*/
        {
            attributeName: 'bonus_damage_per_instance',
            label: 'DAMAGE:',
            ignoreTooltip: true,
            controlType: 'text',
            fn: function (v, a, parent, index, abilityModel, ability) {
                return v*a;
            },
            returnProperty: 'bonusDamage'
        }
    ],
    'invoker_ghost_walk': [
        {
            label: 'Quas Level',
            controlType: 'input'
        },
        {
            attributeName: 'enemy_slow',
            label: 'Total Damage',
            controlType: 'text',
            fn: function (v, a, parent, index, abilityModel, ability) {
                if (v == 0) {
                    return 0;
                }
                return abilityModel.getAbilityAttributeValue(ability.attributes, 'enemy_slow',v);
            },
            returnProperty: 'movementSpeedPctReduction'
        },
        {
            label: 'Wex Level',
            controlType: 'input',
            display: 'ability'
        },
        {
            attributeName: 'self_slow',
            label: 'Total Damage',
            controlType: 'text',
            display: 'ability',
            fn: function (v, a, parent, index, abilityModel, ability) {
                if (v == 0) {
                    return 0;
                }
                return abilityModel.getAbilityAttributeValue(ability.attributes, 'self_slow',v);
            },
            returnProperty: 'movementSpeedPct'
        }
    ],
    'invoker_alacrity': [
        {
            label: 'Wex Level',
            controlType: 'input'
        },
        {
            attributeName: 'bonus_attack_speed',
            label: 'Total Damage',
            controlType: 'text',
            fn: function (v, a, parent, index, abilityModel, ability) {
                if (v == 0) {
                    return 0;
                }
                return abilityModel.getAbilityAttributeValue(ability.attributes, 'bonus_attack_speed',v);
            },
            returnProperty: 'attackspeed'
        },
        {
            label: 'Exort Level',
            controlType: 'input',
        },
        {
            attributeName: 'bonus_damage',
            label: 'Total Damage',
            controlType: 'text',
            fn: function (v, a, parent, index, abilityModel, ability) {
                if (v == 0) {
                    return 0;
                }
                return abilityModel.getAbilityAttributeValue(ability.attributes, 'bonus_damage',v);
            },
            returnProperty: 'bonusDamage'
        }
    ],
    'invoker_ice_wall': [
        {
            label: 'Quas Level',
            controlType: 'input'
        },
        {
            attributeName: 'slow',
            label: 'Total Damage',
            controlType: 'text',
            fn: function (v, a, parent, index, abilityModel, ability) {
                if (v == 0) {
                    return 0;
                }
                return abilityModel.getAbilityAttributeValue(ability.attributes, 'slow',v);
            },
            returnProperty: 'movementSpeedPctReduction'
        },
        {
            label: 'Exort Level',
            controlType: 'input',
            display: 'ability'
        },
        {
            label: 'Duration',
            controlType: 'input',
            display: 'ability'
        },
        {
            attributeName: 'damage_per_second',
            label: 'DAMAGE:',
            ignoreTooltip: true,
            controlType: 'text',
            display: 'ability',
            controls: [1,2],
            fn: function (v, a, parent, index, abilityModel, ability) {
                if (v[0] == 0) {
                    return 0;
                }
                return abilityModel.getAbilityAttributeValue(ability.attributes, 'damage_per_second',v[0])*v[1];
            }
        }
    ],
    'jakiro_dual_breath': [
        {
            label: 'Duration',
            controlType: 'input'
        },
        {
            label: 'DAMAGE:',
            controlType: 'text',
            fn: function (v, a, parent, index, abilityModel, ability) {
                return abilityModel.getAbilityPropertyValue(ability, 'damage')*2 + 
                abilityModel.getAbilityAttributeValue(ability.attributes, 'burn_damage',ability.level())*v;
            }
        },
        {
            attributeName: 'slow_movement_speed_pct',
            label: 'Total Damage',
            controlType: 'text',
            fn: function (v, a, parent, index, abilityModel, ability) {
                return a;
            },
            returnProperty: 'movementSpeedPctReduction'
        },
        {
            attributeName: 'slow_attack_speed_pct',
            label: '%ATTACK SLOW:',
            ignoreTooltip: true,
            controlType: 'text',
            fn: function (v, a, parent, index, abilityModel, ability) {
                return a;
            },
            returnProperty: 'attackspeedreduction'
        }
    ],
    'jakiro_liquid_fire': [
        {
            label: 'Duration',
            controlType: 'input'
        },
        {
            attributeName: 'damage',
            label: 'Total Damage',
            controlType: 'text',
            fn: function (v, a, parent, index, abilityModel, ability) {
                return v*a;
            }
        },
        {
            attributeName: 'slow_attack_speed_pct',
            label: 'Total Damage',
            controlType: 'text',
            fn: function (v, a, parent, index, abilityModel, ability) {
                return a;
            },
            returnProperty: 'attackspeedreduction'
        }
    ],
    'jakiro_macropyre': [
        {
            label: 'Duration',
            controlType: 'input'
        },
        {
            attributeName: 'damage',
            label: 'Total Damage',
            controlType: 'text',
            fn: function (v, a, parent, index, abilityModel, ability) {
                return v*a;
            }
        }
    ],
    'juggernaut_blade_fury': [
        {
            label: 'Duration',
            controlType: 'input'
        },
        {
            label: 'DAMAGE:',
            controlType: 'text',
            fn: function (v, a, parent, index, abilityModel, ability) {
                return abilityModel.getAbilityPropertyValue(ability, 'damage')*v;
            }
        }
    ],
    'juggernaut_healing_ward': [
        {
            label: 'Duration',
            controlType: 'input'
        },
        {
            label: 'Max Health',
            controlType: 'input'
        },
        {
            attributeName: 'healing_ward_heal_amount',
            label: 'HEAL OVER TIME:',
            ignoreTooltip: true,
            controlType: 'text',
            controls: [0,1],
            fn: function (v, a, parent, index, abilityModel, ability) {
                return v[0]*v[1]*a/100;
            }
        }
    ],
    'juggernaut_omni_slash': [
        {
            label: 'Jumps',
            controlType: 'input'
        },
        {
            label: 'MIN DAMAGE:',
            ignoreTooltip: true,
            controlType: 'text',
            fn: function (v, a, parent, index, abilityModel, ability) {
                return abilityModel.getAbilityAttributeValue(ability.attributes, 'omni_slash_damage',1)*v;
            }
        },
        {
            label: 'MAX DAMAGE:',
            ignoreTooltip: true,
            controlType: 'text',
            fn: function (v, a, parent, index, abilityModel, ability) {
                return abilityModel.getAbilityAttributeValue(ability.attributes, 'omni_slash_damage',2)*v;
            }
        }
    ],
    'keeper_of_the_light_illuminate': [
        {
            label: 'Duration',
            controlType: 'input'
        },
        {
            attributeName: 'damage_per_second',
            label: 'DAMAGE:',
            ignoreTooltip: true,
            controlType: 'text',
            fn: function (v, a, parent, index, abilityModel, ability) {
                return v*a;
            }
        }
    ],
    'keeper_of_the_light_mana_leak': [
        {
            label: 'Distance Moved',
            controlType: 'input'
        },
        {
            label: 'Enemy Max Mana',
            controlType: 'input'
        },
        {
            attributeName: 'mana_leak_pct',
            label: 'MANA LEAKED:',
            ignoreTooltip: true,
            controlType: 'text',
            controls: [0,1],
            fn: function (v, a, parent, index, abilityModel, ability) {
                return v[0]/100*v[1]*a/100;
            }
        }
    ],
    'legion_commander_duel': [
        {
            label: 'Duel Wins',
            controlType: 'input'
        },
        {
            attributeName: 'reward_damage',
            label: 'Total Damage:',
            ignoreTooltip: true,
            controlType: 'text',
            fn: function (v, a, parent, index, abilityModel, ability) {
                return v*a;
            },
            returnProperty: 'bonusDamage'
        }
    ],
    'leshrac_pulse_nova': [
        {
            label: 'Duration',
            controlType: 'input'
        },
        {
            attributeName: 'damage',
            label: 'Total Damage',
            controlType: 'text',
            fn: function (v, a, parent, index, abilityModel, ability) {
                return v*a;
            }
        },
        {
            attributeName: 'mana_cost_per_second',
            label: 'MANA COST:',
            ignoreTooltip: true,
            controlType: 'text',
            fn: function (v, a, parent, index, abilityModel, ability) {
                return v*a;
            }
        }
    ],
    'lich_chain_frost': [
        {
            label: 'Bounce Hits',
            controlType: 'input'
        },
        {
            attributeName: 'damage',
            label: 'Total Damage',
            controlType: 'text',
            fn: function (v, a, parent, index, abilityModel, ability) {
                return v*a;
            }
        },
        {
            attributeName: 'slow_movement_speed',
            label: 'Enemy Movement Speed Slow',
            controlType: 'text',
            fn: function (v, a, parent, index, abilityModel, ability) {
                return a;
            },
            returnProperty: 'movementSpeedPctReduction'
        },
        {
            attributeName: 'slow_attack_speed',
            label: 'Total Damage',
            controlType: 'text',
            fn: function (v, a, parent, index, abilityModel, ability) {
                return a;
            },
            returnProperty: 'attackspeedreduction'
        }
    ],
    'life_stealer_feast': [
        {
            label: 'Enemy Current HP',
            controlType: 'input'
        },
        {
            attributeName: 'hp_leech_percent',
            label: 'Total Damage',
            controlType: 'text',
            fn: function (v, a, parent, index, abilityModel, ability) {
                return v*a/100;
            },
            returnProperty: 'bonusDamage'
        }
    ],
    'life_stealer_open_wounds': [
        {
            label: 'Duration',
            controlType: 'input'
        },
        {
            attributeName: 'heal_percent',
            label: 'Total Damage',
            controlType: 'text',
            fn: function (v, a, parent, index, abilityModel, ability) {
                return a;
            },
            returnProperty: 'lifesteal'
        },
        {
            attributeName: 'slow_steps',
            label: '%SLOW:',
            ignoreTooltip: true,
            controlType: 'text',
            noLevel: true,
            fn: function (v, a, parent, index, abilityModel, ability) {
                return abilityModel.getAbilityAttributeValue(ability.attributes, 'slow_steps',v+1);
            },
            returnProperty: 'movementSpeedPctReduction'
        }
    ],
    'lina_fiery_soul': [
        {
            label: 'Duration',
            controlType: 'input'
        },
        {
            attributeName: 'fiery_soul_move_speed_bonus',
            label: 'Enemy Movement Speed Slow',
            controlType: 'text',
            fn: function (v, a, parent, index, abilityModel, ability) {
                return v*a;
            },
            returnProperty: 'movementSpeedPct'
        },
        {
            attributeName: 'fiery_soul_attack_speed_bonus',
            label: 'Total Damage',
            controlType: 'text',
            fn: function (v, a, parent, index, abilityModel, ability) {
                return v*a;
            },
            returnProperty: 'attackspeed'
        }
    ],
    'lion_mana_drain': [
        {
            label: 'Duration',
            controlType: 'input'
        },
        {
            attributeName: 'mana_per_second',
            label: 'MANA DRAINED:',
            ignoreTooltip: true,
            controlType: 'text',
            fn: function (v, a, parent, index, abilityModel, ability) {
                return v*a;
            }
        }
    ],
    'luna_moon_glaive': [
        {
            label: 'Damage',
            controlType: 'input'
        },
        {
            attributeName: 'damage_reduction_percent',
            label: 'BOUNCE DAMAGE:',
            ignoreTooltip: true,
            controlType: 'text',
            fn: function (v, a, parent, index, abilityModel, ability) {
                var result = [];
                for (var i = 1; i < 6; i++) {
                    result.push((v*Math.pow(a/100,i)).toFixed(2))
                }
                return result.join('<br>');
            }
        }
    ],
    'luna_eclipse': [
        {
            label: 'Beam Count',
            controlType: 'input'
        },
        {
            attributeName: 'beams',
            label: 'Total Damage',
            controlType: 'text',
            fn: function (v, a, parent, index, abilityModel, ability) {
                var lucentBeamAbility = abilityModel.abilities().find(function(b) {
                    return b.name == 'luna_lucent_beam';
                });
                if (lucentBeamAbility.level() == 0) return 0;
                var damage = abilityModel.getAbilityPropertyValue(lucentBeamAbility, 'damage');
                return v*damage;
            }
        }
    ],
    'medusa_mystic_snake': [
        {
            label: 'Jump Count',
            controlType: 'input'
        },
        {
            attributeName: 'snake_damage',
            label: 'Damage Per Jump:',
            ignoreTooltip: true,
            controlType: 'method',
            display: 'none',
            fn: function (v, a, parent, index, abilityModel, ability) {
                var snake_jumps = abilityModel.getAbilityAttributeValue(ability.attributes, 'snake_jumps',ability.level());
                var snake_scale = abilityModel.getAbilityAttributeValue(ability.attributes, 'snake_scale',0);
                var damage = [];
                for (var i = 0; i < snake_jumps; i++) {
                    damage.push(a + a * i * snake_scale/100);
                }
                return damage;
            }
        },
        {
            attributeName: 'snake_damage',
            label: 'Damage Per Jump:',
            ignoreTooltip: true,
            controlType: 'text',
            controls: [0,1],
            fn: function (v, a, parent, index, abilityModel, ability) {
                return v[1].join(' / ');
            }
        },
        {
            attributeName: 'snake_damage',
            label: 'Total Damage:',
            ignoreTooltip: true,
            controlType: 'text',
            controls: [0,1],
            fn: function (v, a, parent, index, abilityModel, ability) {
                return v[1].slice(0, v[0]).reduce(function (memo, o) { return memo + o }, 0);
            }
        },
        {
            attributeName: 'snake_damage',
            label: 'Max Damage:',
            ignoreTooltip: true,
            controlType: 'text',
            controls: [0,1],
            fn: function (v, a, parent, index, abilityModel, ability) {
                return v[1].reduce(function (memo, o) { return memo + o }, 0);
            }
        }
    ],
    'medusa_mana_shield': [
        {
            label: 'Damage',
            controlType: 'input'
        },
        {
            attributeName: 'damage_per_mana',
            label: 'MANA USED:',
            ignoreTooltip: true,
            controlType: 'text',
            fn: function (v, a, parent, index, abilityModel, ability) {
                return (v/a).toFixed(2);
            }
        },
        {
            attributeName: 'absorption_tooltip',
            label: '%DAMAGE REDUCTION:',
            ignoreTooltip: true,
            controlType: 'text',
            fn: function (v, a, parent, index, abilityModel, ability) {
                return -a;
            },
            returnProperty: 'damageReduction'
        }
    ],
    'meepo_poof': [
        {
            label: 'Meepo Count',
            controlType: 'input'
        },
        {
            label: 'DAMAGE:',
            controlType: 'text',
            fn: function (v, a, parent, index, abilityModel, ability) {
                return abilityModel.getAbilityPropertyValue(ability, 'damage')*v;
            }
        }
    ],
    'meepo_geostrike': [
        {
            label: 'Stacks',
            controlType: 'input'
        },
        {
            label: 'DAMAGE:',
            ignoreTooltip: true,
            controlType: 'text',
            fn: function (v, a, parent, index, abilityModel, ability) {
                return abilityModel.getAbilityPropertyValue(ability, 'damage')*v;
            }
        },
        {
            attributeName: 'slow',
            label: '%SLOW:',
            ignoreTooltip: true,
            controlType: 'text',
            noLevel: true,
            fn: function (v, a, parent, index, abilityModel, ability) {
                return abilityModel.getAbilityAttributeValue(ability.attributes, 'slow',ability.level())*v;
            },
            returnProperty: 'movementSpeedPctReduction'
        }
    ],
    'mirana_arrow': [
        {
            label: 'Arrow Travel Distance',
            controlType: 'input'
        },
        {
            attributeName: 'arrow_max_stun',
            label: 'STUN DURATION:',
            ignoreTooltip: true,
            controlType: 'text',
            fn: function (v, a, parent, index, abilityModel, ability) {
                var arrow_min_stun = abilityModel.getAbilityAttributeValue(ability.attributes, 'arrow_min_stun',0);
                var arrow_max_stunrange = abilityModel.getAbilityAttributeValue(ability.attributes, 'arrow_max_stunrange',0);
                var scale = Math.min(v, arrow_max_stunrange) / arrow_max_stunrange;
                return Math.max(arrow_min_stun, Math.floor(a * scale / 0.1) * 0.1);
            }
        },
        {
            attributeName: 'arrow_bonus_damage',
            label: 'TOTAL DAMAGE:',
            ignoreTooltip: true,
            controlType: 'text',
            fn: function (v, a, parent, index, abilityModel, ability) {
                var ability = ability;
                var damage = ability.damage()[ability.level()-1];
                var arrow_max_stunrange = abilityModel.getAbilityAttributeValue(ability.attributes, 'arrow_max_stunrange',0);
                var scale = Math.min(v, arrow_max_stunrange) / arrow_max_stunrange;
                var bonus_damage = Math.floor(a * scale / 2.8) * 2.8;
                return damage + ' + ' + bonus_damage + ' = ' + (damage + bonus_damage);
            }
        }
    ],
    'morphling_morph_agi': [
        {
            label: 'Shifts',
            controlType: 'input'
        },
        {
            attributeName: 'points_per_tick',
            label: 'AGI SHIFT GAIN:',
            ignoreTooltip: true,
            controlType: 'text',
            fn: function (v, a, parent, index, abilityModel, ability) {
                return v*a;
            },
            returnProperty: 'bonusAgility'
        },
        {
            attributeName: 'points_per_tick',
            label: 'STR SHIFT LOSS:',
            ignoreTooltip: true,
            controlType: 'text',
            fn: function (v, a, parent, index, abilityModel, ability) {
                return -v*a;
            },
            returnProperty: 'bonusStrength'
        },
        {
            attributeName: 'bonus_attributes',
            label: 'SHIFT TIME:',
            controlType: 'text',
            fn: function (v, a, parent, index, abilityModel, ability) {
                return a;
            },
            returnProperty: 'bonusAgility2'
        },
        {
            attributeName: 'morph_cooldown',
            label: 'SHIFT TIME:',
            ignoreTooltip: true,
            controlType: 'text',
            fn: function (v, a, parent, index, abilityModel, ability) {
                return v*a;
            }
        },
        {
            attributeName: 'mana_cost',
            label: 'SHIFT MANA COST:',
            ignoreTooltip: true,
            controlType: 'text',
            fn: function (v, a, parent, index, abilityModel, ability) {
                return v*a*abilityModel.getAbilityAttributeValue(ability.attributes, 'morph_cooldown',ability.level());
            }
        }
    ],
    'morphling_morph_str': [
        {
            label: 'Shifts',
            controlType: 'input'
        },
        {
            attributeName: 'points_per_tick',
            label: 'STR SHIFT GAIN:',
            ignoreTooltip: true,
            controlType: 'text',
            fn: function (v, a, parent, index, abilityModel, ability) {
                return v*a;
            },
            returnProperty: 'bonusStrength'
        },
        {
            attributeName: 'points_per_tick',
            label: 'AGI SHIFT LOSS:',
            ignoreTooltip: true,
            controlType: 'text',
            fn: function (v, a, parent, index, abilityModel, ability) {
                return -v*a;
            },
            returnProperty: 'bonusAgility'
        },
        {
            attributeName: 'bonus_attributes',
            label: 'SHIFT TIME:',
            controlType: 'text',
            fn: function (v, a, parent, index, abilityModel, ability) {
                return a;
            },
            returnProperty: 'bonusStrength2'
        },
        {
            attributeName: 'morph_cooldown',
            label: 'SHIFT TIME:',
            ignoreTooltip: true,
            controlType: 'text',
            fn: function (v, a, parent, index, abilityModel, ability) {
                return v*a;
            }
        },
        {
            attributeName: 'mana_cost',
            label: 'SHIFT MANA COST:',
            ignoreTooltip: true,
            controlType: 'text',
            fn: function (v, a, parent, index, abilityModel, ability) {
                return v*a*abilityModel.getAbilityAttributeValue(ability.attributes, 'morph_cooldown',ability.level());
            }
        }
    ],
    'furion_wrath_of_nature': [
        {
            label: 'Duration',
            controlType: 'input'
        },
        {
            attributeName: 'damage',
            label: 'Total Damage',
            controlType: 'text',
            fn: function (v, a, parent, index, abilityModel, ability) {
                return v*a;
            }
        }
    ],
    'necrolyte_heartstopper_aura': [
        {
            label: 'Duration',
            controlType: 'input'
        },
        {
            label: 'Enemy Max Health',
            controlType: 'input'
        },
        {
            attributeName: 'aura_damage',
            label: 'HEALTH LOST:',
            ignoreTooltip: true,
            controlType: 'text',
            controls: [0,1],
            fn: function (v, a, parent, index, abilityModel, ability) {
                return v[0]*v[1]*a/100;
            }
        }
    ],
    'necrolyte_sadist': [
        {
            label: 'Unit Kills',
            controlType: 'input'
        },
        {
            label: 'Hero Kills',
            controlType: 'input'
        },
        {
            attributeName: 'health_regen',
            label: 'Total Damage',
            controlType: 'text',
            controls: [0,1],
            fn: function (v, a, parent, index, abilityModel, ability) {
                var hero_multiplier = abilityModel.getAbilityAttributeValue(ability.attributes, 'hero_multiplier',0)
                return (v[0]+v[1]*hero_multiplier)*a;
            },
            returnProperty: 'healthregen'
        },
        {
            attributeName: 'mana_regen',
            label: 'Total Damage',
            controlType: 'text',
            controls: [0,1],
            fn: function (v, a, parent, index, abilityModel, ability) {
                var hero_multiplier = abilityModel.getAbilityAttributeValue(ability.attributes, 'hero_multiplier',0)
                return (v[0]+v[1]*hero_multiplier)*a;
            },
            returnProperty: 'manaregen'
        }
    ],
    'night_stalker_crippling_fear': [
        {
            label: 'Is Night',
            controlType: 'checkbox'
        },
        {
            attributeName: 'miss_rate_night',
            label: '%CHANCE TO MISS:',
            ignoreTooltip: true,
            controlType: 'text',
            fn: function (v, a, parent, index, abilityModel, ability) {
                if (v) {
                    return abilityModel.getAbilityAttributeValue(ability.attributes, 'miss_rate_night',ability.level());
                }
                else {
                    return abilityModel.getAbilityAttributeValue(ability.attributes, 'miss_rate_day',ability.level());
                }
            },
            returnProperty: 'missChance'
        }
    ],    
    'night_stalker_hunter_in_the_night': [
        {
            label: 'Is Night',
            controlType: 'checkbox'
        },
        {
            attributeName: 'bonus_attack_speed_night',
            label: 'Total Damage',
            controlType: 'text',
            fn: function (v, a, parent, index, abilityModel, ability) {
                if (v) {
                    return a;
                }
                else {
                    return 0;
                }
            },
            returnProperty: 'attackspeed'
        },
        {
            attributeName: 'bonus_movement_speed_pct_night',
            label: 'Total Damage',
            controlType: 'text',
            fn: function (v, a, parent, index, abilityModel, ability) {
                if (v) {
                    return a;
                }
                else {
                    return 0;
                }
            },
            returnProperty: 'movementSpeedPct'
        }
    ],    
    'obsidian_destroyer_arcane_orb': [
        {
            label: 'Current Mana',
            controlType: 'input'
        },
        {
            attributeName: 'mana_pool_damage_pct',
            label: 'Total Damage',
            controlType: 'text',
            fn: function (v, a, parent, index, abilityModel, ability) {
                return v*a/100;
            },
            returnProperty: 'bonusDamageOrb'
        }
    ],
    'ogre_magi_ignite': [
        {
            label: 'Duration',
            controlType: 'input'
        },
        {
            attributeName: 'burn_damage',
            label: 'Total Damage',
            controlType: 'text',
            fn: function (v, a, parent, index, abilityModel, ability) {
                return v*a;
            }
        },
        {
            attributeName: 'slow_movement_speed_pct',
            label: 'Total Damage',
            controlType: 'text',
            fn: function (v, a, parent, index, abilityModel, ability) {
                return a;
            },
            returnProperty: 'movementSpeedPctReduction'
        }
    ],
    'pudge_rot': [
        {
            label: 'Duration',
            controlType: 'input'
        },
        {
            label: 'DAMAGE:',
            controlType: 'text',
            fn: function (v, a, parent, index, abilityModel, ability) {
                return abilityModel.getAbilityPropertyValue(ability, 'damage')*v;
            }
        },
        {
            attributeName: 'rot_slow',
            label: 'Total Damage',
            controlType: 'text',
            fn: function (v, a, parent, index, abilityModel, ability) {
                return a;
            },
            returnProperty: 'movementSpeedPctReduction'
        }
    ],
    'pudge_flesh_heap': [
        {
            label: 'Stacks',
            controlType: 'input'
        },
        {
            attributeName: 'flesh_heap_strength_buff_amount',
            label: 'Total Damage',
            controlType: 'text',
            fn: function (v, a, parent, index, abilityModel, ability) {
                return v*a;
            },
            returnProperty: 'bonusStrength'
        },
        {
            attributeName: 'flesh_heap_magic_resist',
            label: 'Total Damage',
            controlType: 'text',
            fn: function (v, a, parent, index, abilityModel, ability) {
                return a;
            },
            returnProperty: 'magicResist'
        }
    ],
    'pudge_dismember': [
        {
            label: 'Duration',
            controlType: 'input'
        },
        {
            attributeName: 'dismember_damage',
            label: 'Total Damage',
            controlType: 'text',
            fn: function (v, a, parent, index, abilityModel, ability) {
                return v*a;
            }
        }
    ],
    'pugna_nether_ward': [
        {
            label: 'Enemy Mana Spent',
            controlType: 'input'
        },
        {
            attributeName: 'mana_multiplier',
            label: 'DAMAGE:',
            ignoreTooltip: true,
            controlType: 'text',
            fn: function (v, a, parent, index, abilityModel, ability) {
                return v*a;
            }
        },
        {
            attributeName: 'mana_regen',
            label: 'Total Damage',
            controlType: 'text',
            fn: function (v, a, parent, index, abilityModel, ability) {
                return a;
            },
            returnProperty: 'manaregenreduction'
        }
    ],
    'pugna_life_drain': [
        {
            label: 'Duration',
            controlType: 'input'
        },
        {
            attributeName: 'health_drain',
            label: 'HEALTH DRAINED:',
            ignoreTooltip: true,
            controlType: 'text',
            fn: function (v, a, parent, index, abilityModel, ability) {
                return v*a;
            }
        }
    ],
    'queenofpain_shadow_strike': [
        {
            label: 'Duration',
            controlType: 'input'
        },
        {
            attributeName: 'movement_slow',
            label: 'Total Damage',
            controlType: 'text',
            fn: function (v, a, parent, index, abilityModel, ability) {
                return a;
            },
            returnProperty: 'movementSpeedPctReduction'
        },
        {
            attributeName: 'strike_damage',
            label: 'Total Damage:',
            ignoreTooltip: true,
            controlType: 'text',
            fn: function (v, a, parent, index, abilityModel, ability) {
                var duration_damage = abilityModel.getAbilityAttributeValue(ability.attributes, 'duration_damage',ability.level());
                var ticks = Math.floor(v/3);
                return a + duration_damage * ticks;
            }
        }
    ],
    'razor_plasma_field': [
        {
            label: 'Distance',
            controlType: 'input'
        },
        {
            attributeName: 'radius',
            label: 'MIN DISTANCE:',
            ignoreTooltip: true,
            controlType: 'text',
            fn: function (v, a, parent, index, abilityModel, ability) {
                return 200;
            }
        },
        {
            attributeName: 'radius',
            label: 'MAX DISTANCE:',
            ignoreTooltip: true,
            controlType: 'text',
            fn: function (v, a, parent, index, abilityModel, ability) {
                return 200 + a;
            }
        },
        {
            attributeName: 'radius',
            label: 'Instance Damage',
            ignoreTooltip: true,
            controlType: 'text',
            fn: function (v, a, parent, index, abilityModel, ability) {
                var max_radius = a + 200;
                var scale = (Math.min(Math.max(v, 200), max_radius) - 200) / (max_radius - 200);
                var damage_min = abilityModel.getAbilityAttributeValue(ability.attributes, 'damage_min',ability.level());
                var damage_max = abilityModel.getAbilityAttributeValue(ability.attributes, 'damage_max',ability.level());
                return damage_min + (damage_max - damage_min) * scale;
            }
        }
    ],
    'razor_static_link': [
        {
            label: 'Duration',
            controlType: 'input'
        },
        {
            attributeName: 'drain_length',
            label: 'Damage Drained:',
            ignoreTooltip: true,
            controlType: 'text',
            fn: function (v, a, parent, index, abilityModel, ability) {
                var tick_duration = Math.floor(v * 4) + 1;
                var ticks = Math.min(a * 4 + 1, tick_duration);
                var drain_rate = abilityModel.getAbilityAttributeValue(ability.attributes, 'drain_rate',ability.level());
                return ticks * drain_rate/4;
            },
            returnProperty: 'bonusDamage'
        },
        {
            attributeName: 'drain_length',
            label: 'Enemy Damage Lost:',
            ignoreTooltip: true,
            controlType: 'text',
            display: 'hidden',
            fn: function (v, a, parent, index, abilityModel, ability) {
                var tick_duration = Math.floor(v * 4) + 1;
                var ticks = Math.min(a * 4 + 1, tick_duration);
                var drain_rate = abilityModel.getAbilityAttributeValue(ability.attributes, 'drain_rate',ability.level());
                return ticks * drain_rate/4;
            },
            returnProperty: 'bonusDamageReduction'
        }
    ],
    'razor_eye_of_the_storm': [
        {
            label: 'Duration',
            controlType: 'input'
        },
        {
            attributeName: 'damage',
            label: 'Total Damage',
            controlType: 'text',
            fn: function (v, a, parent, index, abilityModel, ability) {
                return v*a;
            }
        }
    ],
    'rubick_fade_bolt': [
        {
            label: 'Jumps',
            controlType: 'input'
        },
        {
            attributeName: 'damage',
            label: 'Total Damage',
            controlType: 'text',
            fn: function (v, a, parent, index, abilityModel, ability) {
                return a * (1 - v*abilityModel.getAbilityAttributeValue(ability.attributes, 'jump_damage_reduction_pct',ability.level())/100);
            }
        },
        {
            attributeName: 'hero_attack_damage_reduction',
            label: 'Total Damage',
            controlType: 'text',
            fn: function (v, a, parent, index, abilityModel, ability) {
                return a;
            },
            returnProperty: 'bonusDamageReduction'
        }
    ],
    'sandking_sand_storm': [
        {
            label: 'Duration',
            controlType: 'input'
        },
        {
            label: 'DAMAGE:',
            controlType: 'text',
            fn: function (v, a, parent, index, abilityModel, ability) {
                return abilityModel.getAbilityPropertyValue(ability, 'damage')*v;
            }
        }
    ],
    'sandking_epicenter': [
        {
            label: 'Pulses',
            controlType: 'input'
        },
        {
            attributeName: 'epicenter_damage',
            label: 'DAMAGE:',
            ignoreTooltip: true,
            controlType: 'text',
            fn: function (v, a, parent, index, abilityModel, ability) {
                return v*a;
            }
        },
        {
            attributeName: 'epicenter_slow',
            label: 'Total Damage',
            controlType: 'text',
            fn: function (v, a, parent, index, abilityModel, ability) {
                return a;
            },
            returnProperty: 'movementSpeedPctReduction'
        },
        {
            attributeName: 'epicenter_slow_as',
            label: '%ATTACK SLOW:',
            ignoreTooltip: true,
            controlType: 'text',
            fn: function (v, a, parent, index, abilityModel, ability) {
                return a;
            },
            returnProperty: 'attackspeedreduction'
        }
    ],
    'shadow_demon_shadow_poison': [
        {
            label: 'Duration',
            controlType: 'input'
        },
        {
            attributeName: 'stack_damage',
            label: 'Total Damage',
            controlType: 'text',
            fn: function (v, a, parent, index, abilityModel, ability) {
                var stackmult = [1,2,4,8];
                if (v > 4) {
                    return a * stackmult[3] + 50 * (v - 4);
                }
                else if (v <= 0) {
                    return 0
                }
                else {
                    return a * stackmult[v-1]
                }
            }
        }
    ],
    'nevermore_necromastery': [
        {
            label: 'Souls',
            controlType: 'input'
        },
        {
            attributeName: 'necromastery_damage_per_soul',
            label: 'DAMAGE:',
            ignoreTooltip: true,
            controlType: 'text',
            fn: function (v, a, parent, index, abilityModel, ability) {
                return v*a;
            },
            returnProperty: 'bonusDamage'
        }
    ],
    'nevermore_requiem': [
        {
            label: 'Line Hit Count',
            controlType: 'input'
        },
        {
            attributeName: 'requiem_reduction_damage',
            label: 'Damage:',
            ignoreTooltip: true,
            controlType: 'text',
            fn: function (v, a, parent, index, abilityModel, ability) {
                return abilityModel.getAbilityPropertyValue(ability, 'damage')*v;
            }
        },
        {
            label: 'Return Line Hit Count (Scepter)',
            controlType: 'input'
        },
        {
            attributeName: 'requiem_damage_pct_scepter',
            label: 'Damage/Heal:',
            ignoreTooltip: true,
            controlType: 'text',
            fn: function (v, a, parent, index, abilityModel, ability) {
                return abilityModel.getAbilityPropertyValue(ability, 'damage')*v*a/100;
            }
        },
        {
            attributeName: 'requiem_damage_pct_scepter',
            label: 'Total Damage:',
            ignoreTooltip: true,
            controlType: 'text',
            controls: [0,1],
            fn: function (v, a, parent, index, abilityModel, ability) {
                var damage = abilityModel.getAbilityPropertyValue(ability, 'damage');
                return damage*v[0] + damage*v[1]*a/100;
            }
        },
        {
            attributeName: 'requiem_reduction_damage',
            label: '%DAMAGE REDUCTION:',
            ignoreTooltip: true,
            controlType: 'text',
            fn: function (v, a, parent, index, abilityModel, ability) {
                return a;
            },
            returnProperty: 'baseDamageReductionPct'
        },
        {
            attributeName: 'requiem_reduction_ms',
            label: '%DAMAGE REDUCTION:',
            controlType: 'text',
            fn: function (v, a, parent, index, abilityModel, ability) {
                return a;
            },
            returnProperty: 'movementSpeedPctReduction'
        }
    ],
    'shadow_shaman_shackles': [
        {
            label: 'Duration',
            controlType: 'input'
        },
        {
            label: 'DAMAGE:',
            controlType: 'text',
            fn: function (v, a, parent, index, abilityModel, ability) {
                return abilityModel.getAbilityPropertyValue(ability, 'damage')*v;
            }
        }
    ],
    'silencer_curse_of_the_silent': [
        {
            label: 'Duration',
            controlType: 'input'
        },
        {
            attributeName: 'damage',
            label: 'Total Damage',
            controlType: 'text',
            fn: function (v, a, parent, index, abilityModel, ability) {
                return Math.floor(v)*a;
            }
        },
        {
            attributeName: 'movespeed',
            label: 'Total Damage',
            controlType: 'text',
            fn: function (v, a, parent, index, abilityModel, ability) {
                return a;
            },
            returnProperty: 'movementSpeedPctReduction'
        }
    ],
/*        'silencer_glaives_of_wisdom': [
        {
            label: 'Duration',
            controlType: 'input'
        },
        {
            attributeName: 'damage',
            label: 'Total Damage',
            controlType: 'text',
            fn: function (v, a, parent, index, abilityModel, ability) {
                return v*a;
            }
        }
    ],*/
    'skywrath_mage_mystic_flare': [
        {
            label: 'Duration',
            controlType: 'input'
        },
        {
            attributeName: 'damage',
            label: 'Total Damage',
            controlType: 'text',
            fn: function (v, a, parent, index, abilityModel, ability) {
                return v*a;
            }
        }
    ],
    'slark_essence_shift': [
        {
            label: 'Attacks',
            controlType: 'input'
        },
        {
            attributeName: 'agi_gain',
            label: 'Total Damage',
            controlType: 'text',
            display: 'ability',
            fn: function (v, a, parent, index, abilityModel, ability) {
                return v*a;
            },
            returnProperty: 'bonusAgility'
        },
        {
            attributeName: 'stat_loss',
            label: 'Total Damage',
            controlType: 'text',
            fn: function (v, a, parent, index, abilityModel, ability) {
                return -v*a;
            },
            returnProperty: 'bonusAllStatsReduction'
        }
    ],
    'slark_shadow_dance': [
        {
            label: 'Duration',
            controlType: 'input'
        },
        {
            attributeName: 'bonus_regen_pct',
            label: 'TOTAL HEALTH REGENERATED:',
            ignoreTooltip: true,
            controlType: 'text',
            fn: function (v, a, parent, index, abilityModel, ability) {
                return v*parent.health()*a/100;
            }
        },
        {
            attributeName: 'bonus_regen_pct',
            label: 'HEALTH GAINED PER SECOND:',
            ignoreTooltip: true,
            controlType: 'text',
            fn: function (v, a, parent, index, abilityModel, ability) {
                return parent.health()*a/100;
            },
            returnProperty: 'healthregen'
        },
        {
            attributeName: 'bonus_movement_speed',
            label: '%MOVE SPEED:',
            ignoreTooltip: true,
            controlType: 'text',
            fn: function (v, a, parent, index, abilityModel, ability) {
                return a;
            },
            returnProperty: 'movementSpeedPct'
        }
    ],
    'sniper_shrapnel': [
        {
            label: 'Duration',
            controlType: 'input'
        },
        {
            label: 'DAMAGE:',
            ignoreTooltip: true,
            controlType: 'text',
            fn: function (v, a, parent, index, abilityModel, ability) {
                return abilityModel.getAbilityPropertyValue(ability, 'damage')*v;
            }
        },
        {
            attributeName: 'building_damage',
            label: 'BUILDING DAMAGE:',
            ignoreTooltip: true,
            controlType: 'text',
            fn: function (v, a, parent, index, abilityModel, ability) {
                return v*a;
            }
        },
        {
            attributeName: 'slow_movement_speed',
            label: 'Enemy Movement Speed Slow',
            controlType: 'text',
            fn: function (v, a, parent, index, abilityModel, ability) {
                return a;
            },
            returnProperty: 'movementSpeedPctReduction'
        }
    ],
    'spectre_desolate': [
        {
            label: 'Enemy Alone',
            controlType: 'checkbox'
        },
        {
            attributeName: 'bonus_damage',
            label: 'Total Damage',
            controlType: 'text',
            fn: function (v, a, parent, index, abilityModel, ability) {
                if (v) {
                    return a;
                }
                else {
                    return 0;
                }
            },
            returnProperty: 'bonusDamage'
        }
    ],
    'spectre_dispersion': [
        {
            label: 'Damage Taken',
            controlType: 'input'
        },
        {
            attributeName: 'damage_reflection_pct',
            label: 'DAMAGE REFLECTED:',
            controlType: 'text',
            fn: function (v, a, parent, index, abilityModel, ability) {
                return -a;
            },
            returnProperty: 'damageReduction'
        },
        {
            attributeName: 'damage_reflection_pct',
            label: 'DAMAGE REFLECTED:',
            ignoreTooltip: true,
            controlType: 'text',
            fn: function (v, a, parent, index, abilityModel, ability) {
                return v*a/100;
            }
        }
    ],
    'storm_spirit_ball_lightning': [
        {
            label: 'MAX MANA',
            controlType: 'input'
        },
        {
            label: 'Distance',
            controlType: 'input'
        },
        {
            attributeName: 'ball_lightning_initial_mana_base',
            label: 'Total Damage:',
            ignoreTooltip: true,
            controlType: 'text',
            controls: [0, 1],
            fn: function (v, a, parent, index, abilityModel, ability) {
                return abilityModel.getAbilityPropertyValue(ability, 'damage')/100*v[1];
            }
        },
        {
            attributeName: 'ball_lightning_initial_mana_base',
            label: 'FLAT MANA COST:',
            ignoreTooltip: true,
            controlType: 'method',
            controls: [0, 1],
            fn: function (v, a, parent, index, abilityModel, ability) {
                var distance_intervals = Math.floor(v[1]/100);
                var travel_cost_base = abilityModel.getAbilityAttributeValue(ability.attributes, 'ball_lightning_travel_cost_base',0);
                return a + distance_intervals * travel_cost_base;
            }
        },
        {
            attributeName: 'ball_lightning_initial_mana_percentage',
            label: '%MAX MANA COST:',
            ignoreTooltip: true,
            controlType: 'method',
            controls: [0, 1],
            fn: function (v, a, parent, index, abilityModel, ability) {
                var distance_intervals = Math.floor(v[1]/100);
                var travel_cost_percent = abilityModel.getAbilityAttributeValue(ability.attributes, 'ball_lightning_travel_cost_percent',0);
                return a + distance_intervals * travel_cost_percent;
            }
        },
        {
            attributeName: 'ball_lightning_initial_mana_base',
            label: 'TOTAL MANA COST:',
            ignoreTooltip: true,
            controlType: 'text',
            controls: [0, 1, 2, 3],
            fn: function (v, a, parent, index, abilityModel, ability) {
                return v[2] + ' + ' + (v[3]/100 * v[0]) + ' (' + v[3] + '% of max) = ' + (v[2] + v[3]/100 * v[0]);
            }
        }
    ],
    'templar_assassin_psionic_trap': [
        {
            label: 'Charge Time',
            controlType: 'input'
        },
        {
            attributeName: 'movement_speed_min_tooltip',
            label: '%MOVE SLOW:',
            ignoreTooltip: true,
            controlType: 'text',
            fn: function (v, a, parent, index, abilityModel, ability) {
                var max_slow = abilityModel.getAbilityAttributeValue(ability.attributes, 'movement_speed_max_tooltip',0);
                var slow_per_tick = (max_slow - a)/40;
                return -(a + slow_per_tick * Math.min(Math.max(0, v), 4) * 10);
            },
            returnProperty: 'movementSpeedPctReduction'
        }
    ],
    'shredder_reactive_armor': [
        {
            label: 'Stacks',
            controlType: 'input'
        },
        {
            attributeName: 'bonus_armor',
            label: 'Total Armor Bonus',
            controlType: 'text',
            fn: function (v, a, parent, index, abilityModel, ability) {
                return v*a;
            },
            returnProperty: 'armor'
        },
        {
            attributeName: 'bonus_hp_regen',
            label: 'Total HP Regen Bonus',
            controlType: 'text',
            fn: function (v, a, parent, index, abilityModel, ability) {
                return v*a;
            },
            returnProperty: 'healthregen'
        }
    ],
    'shredder_chakram': [
        {
            label: 'Duration',
            controlType: 'input'
        },
        {
            attributeName: 'damage_per_second',
            label: 'DAMAGE:',
            ignoreTooltip: true,
            controlType: 'text',
            fn: function (v, a, parent, index, abilityModel, ability) {
                var interval = abilityModel.getAbilityAttributeValue(ability.attributes, 'damage_interval',0);
                var ticks = Math.floor(v / interval);
                return a*interval*ticks;
            }
        },
        {
            attributeName: 'mana_per_second',
            label: 'MANA COST:',
            ignoreTooltip: true,
            controlType: 'text',
            fn: function (v, a, parent, index, abilityModel, ability) {
                var interval = abilityModel.getAbilityAttributeValue(ability.attributes, 'damage_interval',0);
                var ticks = Math.floor(v / interval);
                return a*interval*ticks;
            }
        },
        {
            label: 'ENEMY %HP',
            controlType: 'input'
        },
        {
            attributeName: 'slow',
            label: 'MANA COST:',
            controlType: 'text',
            fn: function (v, a, parent, index, abilityModel, ability) {
                var ticks = 20 - Math.floor(Math.min(Math.max(v-1, 0), 99) / 5);
                return -a*ticks;
            },
            returnProperty: 'movementSpeedPctReduction'
        }
    ],
    'spirit_breaker_greater_bash': [
        {
            label: 'Bash Proc',
            controlType: 'checkbox'
        },
        {
            attributeName: 'damage',
            label: '%MOVESPEED AS DAMAGE',
            controlType: 'text',
            fn: function (v, a, parent, index, abilityModel, ability) {
                if (v) {
                    return a;
                }
                else {
                    return 0;
                }
            },
            returnProperty: 'bashBonusDamage'
        },
        {
            attributeName: 'bonus_movespeed_pct',
            label: 'Total Damage',
            controlType: 'text',
            fn: function (v, a, parent, index, abilityModel, ability) {
                if (v) {
                    return a;
                }
                else {
                    return 0;
                }
            },
            returnProperty: 'movementSpeedPct'
        },
        {
            attributeName: 'chance_pct',
            label: 'Total Damage',
            controlType: 'text',
            fn: function (v, a, parent, index, abilityModel, ability) {
                return a
            },
            returnProperty: 'bash'
        }
    ],
    'techies_land_mines': [
        {
            label: 'Number of Mines',
            controlType: 'input'
        },
        {
            attributeName: 'damage',
            label: 'Total Damage',
            controlType: 'text',
            fn: function (v, a, parent, index, abilityModel, ability) {
                return v*a;
            }
        },
        {
            attributeName: 'damage',
            label: 'AFTER REDUCTIONS:',
            ignoreTooltip: true,
            controlType: 'text',
            fn: function (v, a, parent, index, abilityModel, ability) {
                var phys_reduction = parent.enemy().totalArmorPhysicalReduction(),
                    magic_reduction = parent.enemy().totalMagicResistance();
                return (v * a * (1 - phys_reduction / 100) * (1 - magic_reduction / 100)).toFixed(2);
            }
        }
    ],
    'techies_suicide': [
        {
            attributeName: 'damage',
            label: 'FULL DAMAGE AFTER REDUCTIONS:',
            ignoreTooltip: true,
            controlType: 'text',
            fn: function (v, a, parent, index, abilityModel, ability) {
                var phys_reduction = parent.enemy().totalArmorPhysicalReduction(),
                    magic_reduction = parent.enemy().totalMagicResistance();
                return (a * (1 - phys_reduction / 100) * (1 - magic_reduction / 100)).toFixed(2);
            }
        },
        {
            attributeName: 'partial_damage',
            label: 'PARTIAL DAMAGE AFTER REDUCTIONS:',
            ignoreTooltip: true,
            controlType: 'text',
            fn: function (v, a, parent, index, abilityModel, ability) {
                var phys_reduction = parent.enemy().totalArmorPhysicalReduction(),
                    magic_reduction = parent.enemy().totalMagicResistance();
                return (a * (1 - phys_reduction / 100) * (1 - magic_reduction / 100)).toFixed(2);
            }
        },
        {
            attributeName: 'damage',
            label: 'RESPAWN TIME:',
            ignoreTooltip: true,
            controlType: 'text',
            fn: function (v, a, parent, index, abilityModel, ability) {
                return (parent.respawnTime() / 2).toFixed(0) + ' seconds';
            }
        }
    ],
    'techies_remote_mines': [
        {
            label: 'Number of Mines',
            controlType: 'input'
        },
        {
            attributeName: 'damage',
            label: 'Total Damage',
            controlType: 'text',
            fn: function (v, a, parent, index, abilityModel, ability) {
                return v*a;
            }
        },
        {
            attributeName: 'damage',
            label: 'AFTER REDUCTIONS:',
            ignoreTooltip: true,
            controlType: 'text',
            fn: function (v, a, parent, index, abilityModel, ability) {
                var magic_reduction = parent.enemy().totalMagicResistance();
                return (v * a * (1 - magic_reduction / 100)).toFixed(2);
            }
        }
    ],
    'tinker_march_of_the_machines': [
        {
            label: 'Robot Explosions',
            controlType: 'input'
        },
        {
            attributeName: 'machines_per_sec',
            label: 'TOTAL DAMAGE:',
            ignoreTooltip: true,
            controlType: 'text',
            fn: function (v, a, parent, index, abilityModel, ability) {
                return abilityModel.getAbilityPropertyValue(ability, 'damage')*v;
            }
        }
    ],
    'treant_leech_seed': [
        {
            label: 'Pulses',
            controlType: 'input'
        },
        {
            attributeName: 'leech_damage',
            label: 'DAMAGE/HEAL:',
            ignoreTooltip: true,
            controlType: 'text',
            fn: function (v, a, parent, index, abilityModel, ability) {
                return v*a;
            }
        },
        {
            attributeName: 'movement_slow',
            label: 'Total Damage',
            controlType: 'text',
            fn: function (v, a, parent, index, abilityModel, ability) {
                return a;
            },
            returnProperty: 'movementSpeedPctReduction'
        }
    ],
    'troll_warlord_fervor': [
        {
            label: 'Stacks',
            controlType: 'input'
        },
        {
            attributeName: 'attack_speed',
            label: 'ATTACK SPEED:',
            ignoreTooltip: true,
            controlType: 'text',
            fn: function (v, a, parent, index, abilityModel, ability) {
                return v*a;
            },
            returnProperty: 'attackspeed'
        }
    ],
    'undying_decay': [
        {
            label: 'Stacks',
            controlType: 'input'
        },
        {
            attributeName: 'str_steal',
            label: 'STRENGTH STOLEN:',
            ignoreTooltip: true,
            controlType: 'text',
            fn: function (v, a, parent, index, abilityModel, ability) {
                if (parent.inventory.hasScepter()) {
                    var str_steal_scepter = abilityModel.getAbilityAttributeValue(ability.attributes, 'str_steal_scepter',0);
                    return v*str_steal_scepter;
                }
                else {
                    return v*a;
                }
            },
            returnProperty: 'bonusStrength'
        },
    ],
    'undying_soul_rip': [
        {
            label: 'Units',
            controlType: 'input'
        },
        {
            attributeName: 'damage_per_unit',
            label: 'DAMAGE/HEAL:',
            ignoreTooltip: true,
            controlType: 'text',
            fn: function (v, a, parent, index, abilityModel, ability) {
                return v*a;
            }
        }
    ],
    'undying_flesh_golem': [
        {
            label: 'Distance',
            controlType: 'input'
        },
        {
            attributeName: 'max_speed_slow',
            label: '%MOVE SLOW:',
            ignoreTooltip: true,
            controlType: 'text',
            fn: function (v, a, parent, index, abilityModel, ability) {
                var min_speed_slow = abilityModel.getAbilityAttributeValue(ability.attributes, 'min_speed_slow', 0);
                var radius = abilityModel.getAbilityAttributeValue(ability.attributes, 'radius', 0);
                var full_power_radius = abilityModel.getAbilityAttributeValue(ability.attributes, 'full_power_radius', 0);
                var distance = Math.min(Math.max(v, full_power_radius), radius);
                var scale = 1 - (distance - full_power_radius) / (radius - full_power_radius);
                return -Math.max(scale * a, min_speed_slow);
            },
            returnProperty: 'movementSpeedPctReduction'
        },
        {
            attributeName: 'max_damage_amp',
            label: '%DAMAGE AMP:',
            ignoreTooltip: true,
            controlType: 'text',
            fn: function (v, a, parent, index, abilityModel, ability) {
                var min_damage_amp = abilityModel.getAbilityAttributeValue(ability.attributes, 'min_damage_amp', 0);
                var radius = abilityModel.getAbilityAttributeValue(ability.attributes, 'radius', 0);
                var full_power_radius = abilityModel.getAbilityAttributeValue(ability.attributes, 'full_power_radius', 0);
                var distance = Math.min(Math.max(v, full_power_radius), radius);
                var scale = 1 - (distance - full_power_radius) / (radius - full_power_radius);
                return Math.max(scale * a, min_damage_amp);
            },
            returnProperty: 'damageAmplification'
        },
        {
            label: 'MAX HP',
            controlType: 'input'
        },
        {
            label: 'Hero Death Count',
            controlType: 'input'
        },
        {
            label: 'Creep Death Count',
            controlType: 'input'
        },
        {
            attributeName: 'death_heal',
            label: 'DEATH HEAL (HEROES):',
            ignoreTooltip: true,
            controlType: 'method',
            controls: [1, 2],
            fn: function (v, a, parent, index, abilityModel, ability) {
                return v[0]*v[1]*a/100;
            }
        },
        {
            attributeName: 'death_heal_creep',
            label: 'DEATH HEAL (CREEPS):',
            ignoreTooltip: true,
            controlType: 'method',
            controls: [1, 3],
            fn: function (v, a, parent, index, abilityModel, ability) {
                return v[0]*v[1]*a/100;
            }
        },
        {
            attributeName: 'death_heal_creep',
            label: 'TOTAL DEATH HEAL:',
            ignoreTooltip: true,
            controlType: 'text',
            controls: [4, 5],
            fn: function (v, a, parent, index, abilityModel, ability) {
                return v[0]+v[1];
            }
        }
    ],
    'ursa_fury_swipes': [
        {
            label: 'Stacks',
            controlType: 'input'
        },
        {
            attributeName: 'damage_per_stack',
            label: 'Total Damage',
            controlType: 'text',
            fn: function (v, a, parent, index, abilityModel, ability) {
                var enrageAbility = abilityModel.abilities().find(function(b) {
                    return b.name == 'ursa_enrage';
                });
                if (enrageAbility.isActive() && enrageAbility.level() > 0) {
                    var enrage_multiplier = abilityModel.getAbilityAttributeValue(enrageAbility.attributes, 'enrage_multiplier', enrageAbility.level());
                    return v*a*enrage_multiplier;
                }
                return v*a;
            },
            returnProperty: 'bonusDamage'
        }
    ],
    'ursa_enrage': [
        {
            attributeName: 'damage_reduction',
            label: 'Total Damage',
            controlType: 'text',
            fn: function (v, a, parent, index, abilityModel, ability) {
                return -a;
            },
            returnProperty: 'damageReduction'
        }
    ],
    'venomancer_venomous_gale': [
        {
            label: 'Duration',
            controlType: 'input'
        },
        {
            attributeName: 'tick_damage',
            label: 'Total Damage',
            controlType: 'text',
            fn: function (v, a, parent, index, abilityModel, ability) {
                return abilityModel.getAbilityAttributeValue(ability.attributes, 'strike_damage',ability.level()) + Math.floor(v/3)*a;
            }
        },
        {
            attributeName: 'movement_slow',
            label: 'Total Damage',
            controlType: 'text',
            fn: function (v, a, parent, index, abilityModel, ability) {
                return a;
            },
            returnProperty: 'movementSpeedPctReduction'
        }
    ],
    'venomancer_poison_sting': [
        {
            label: 'Duration',
            controlType: 'input'
        },
        {
            attributeName: 'damage',
            label: 'Total Damage',
            controlType: 'text',
            fn: function (v, a, parent, index, abilityModel, ability) {
                return v*a;
            }
        },
        {
            attributeName: 'movement_speed',
            label: 'Total Damage',
            controlType: 'text',
            fn: function (v, a, parent, index, abilityModel, ability) {
                return a;
            },
            returnProperty: 'movementSpeedPctReduction'
        }
    ],
    'venomancer_poison_nova': [
        {
            label: 'Duration',
            controlType: 'input'
        },
        {
            attributeName: 'damage',
            label: 'Total Damage',
            controlType: 'text',
            fn: function (v, a, parent, index, abilityModel, ability) {
                return v*a;
            }
        }
    ],
    'viper_poison_attack': [
        {
            label: 'Duration',
            controlType: 'input'
        },
        {
            attributeName: 'damage',
            label: 'Total Damage',
            controlType: 'text',
            fn: function (v, a, parent, index, abilityModel, ability) {
                return v*a;
            }
        },
        {
            attributeName: 'bonus_movement_speed',
            label: 'Total Damage',
            controlType: 'text',
            fn: function (v, a, parent, index, abilityModel, ability) {
                return a;
            },
            returnProperty: 'movementSpeedPctReduction'
        },
        {
            attributeName: 'bonus_attack_speed',
            label: 'Total Damage',
            controlType: 'text',
            fn: function (v, a, parent, index, abilityModel, ability) {
                return a;
            },
            returnProperty: 'attackspeedreduction'
        }
    ],
    'viper_corrosive_skin': [
        {
            label: 'Duration',
            controlType: 'input'
        },
        {
            attributeName: 'damage',
            label: 'Total Damage',
            controlType: 'text',
            fn: function (v, a, parent, index, abilityModel, ability) {
                return v*a;
            }
        },
        {
            attributeName: 'bonus_movement_speed',
            label: 'Total Damage',
            controlType: 'text',
            fn: function (v, a, parent, index, abilityModel, ability) {
                return a;
            },
            returnProperty: 'movementSpeedPctReduction'
        },
        {
            attributeName: 'bonus_attack_speed',
            label: 'Total Damage',
            controlType: 'text',
            fn: function (v, a, parent, index, abilityModel, ability) {
                return a;
            },
            returnProperty: 'attackspeedreduction'
        },
        {
            attributeName: 'bonus_magic_resistance',
            label: 'Total Damage',
            controlType: 'text',
            fn: function (v, a, parent, index, abilityModel, ability) {
                return a;
            },
            returnProperty: 'magicResist'
        }
    ],
    'viper_viper_strike': [
        {
            label: 'Duration',
            controlType: 'input'
        },
        {
            attributeName: 'damage',
            label: 'Total Damage',
            controlType: 'text',
            fn: function (v, a, parent, index, abilityModel, ability) {
                return v*a;
            }
        },
        {
            attributeName: 'bonus_movement_speed',
            label: 'Total Damage',
            controlType: 'text',
            fn: function (v, a, parent, index, abilityModel, ability) {
                return a;
            },
            returnProperty: 'movementSpeedPctReduction'
        },
        {
            attributeName: 'bonus_attack_speed',
            label: 'Total Damage',
            controlType: 'text',
            fn: function (v, a, parent, index, abilityModel, ability) {
                return a;
            },
            returnProperty: 'attackspeedreduction'
        }
    ],
    'visage_soul_assumption': [
        {
            label: 'Charges',
            controlType: 'input'
        },
        {
            attributeName: 'soul_charge_damage',
            label: 'Total Damage:',
            ignoreTooltip: true,
            controlType: 'text',
            fn: function (v, a, parent, index, abilityModel, ability) {
                var soul_base_damage = abilityModel.getAbilityAttributeValue(ability.attributes, 'soul_base_damage',0);
                var stack_limit = abilityModel.getAbilityAttributeValue(ability.attributes, 'stack_limit', ability.level());
                stack_limit = Math.max(Math.min(v, stack_limit), 0);
                return soul_base_damage + stack_limit*a;
            }
        }
    ],
    'visage_gravekeepers_cloak': [
        {
            label: 'Layers',
            controlType: 'input'
        },
        {
            attributeName: 'bonus_armor',
            label: 'ARMOR:',
            ignoreTooltip: true,
            controlType: 'text',
            fn: function (v, a, parent, index, abilityModel, ability) {
                return v*a;
            },
            returnProperty: 'armor'
        },
        {
            attributeName: 'bonus_resist',
            label: '%RESIST:',
            ignoreTooltip: true,
            controlType: 'text',
            fn: function (v, a, parent, index, abilityModel, ability) {
                return v*a;
            },
            returnProperty: 'magicResist'
        }
    ],
    'warlock_shadow_word': [
        {
            label: 'Duration',
            controlType: 'input'
        },
        {
            label: 'DAMAGE:',
            ignoreTooltip: true,
            controlType: 'text',
            fn: function (v, a, parent, index, abilityModel, ability) {
                return abilityModel.getAbilityPropertyValue(ability, 'damage')*v;
            }
        }
    ],
    'warlock_upheaval': [
        {
            label: 'Channel Duration',
            controlType: 'input'
        },
        {
            attributeName: 'slow_rate_duration',
            label: '%MOVE SLOW:',
            ignoreTooltip: true,
            controlType: 'text',
            fn: function (v, a, parent, index, abilityModel, ability) {
                var max_slow = abilityModel.getAbilityAttributeValue(ability.attributes, 'max_slow',0);
                var slow_per_tick = max_slow / (a - 0.5) / 2;
                var ticks = Math.max(Math.floor(v * 2) - 1, 0);
                return -Math.min(ticks * slow_per_tick, max_slow);
            },
            returnProperty: 'movementSpeedPctReduction'
        }
    ],
    'weaver_the_swarm': [
        {
            label: 'Attacks',
            controlType: 'input'
        },
        {
            attributeName: 'damage',
            label: 'DAMAGE:',
            controlType: 'text',
            fn: function (v, a, parent, index, abilityModel, ability) {
                return v*a;
            }
        },
        {
            attributeName: 'armor_reduction',
            label: 'DAMAGE:',
            controlType: 'text',
            fn: function (v, a, parent, index, abilityModel, ability) {
                return -v*a;
            },
            returnProperty: 'armorReduction'
        }
    ],
    'windrunner_powershot': [
        {
            label: 'Duration',
            controlType: 'input'
        },
        {
            label: 'DAMAGE:',
            ignoreTooltip: true,
            controlType: 'text',
            fn: function (v, a, parent, index, abilityModel, ability) {
                return abilityModel.getAbilityPropertyValue(ability, 'damage')*v;
            }
        }
    ],
    'winter_wyvern_cold_embrace': [
        {
            label: 'Duration',
            controlType: 'input'
        },
        {
            label: 'Ally Max Health',
            controlType: 'input'
        },
        {
            attributeName: 'heal_percentage',
            label: 'TOTAL HEAL:',
            ignoreTooltip: true,
            controlType: 'text',
            controls: [0,1],
            fn: function (v, a, parent, index, abilityModel, ability) {
                var base_heal = abilityModel.getAbilityAttributeValue(ability.attributes, 'heal_additive',ability.level());
                return (base_heal + v[1] * a/100) * v[0];
            }
        }
    ],
    'wisp_spirits': [
        {
            label: 'Collision Count',
            controlType: 'input'
        },
        {
            attributeName: 'hero_damage',
            label: 'Total Damage',
            controlType: 'text',
            fn: function (v, a, parent, index, abilityModel, ability) {
                return v*a;
            }
        },
        {
            attributeName: 'creep_damage',
            label: 'Total Damage',
            controlType: 'text',
            fn: function (v, a, parent, index, abilityModel, ability) {
                return v*a;
            }
        }
    ],
    'wisp_overcharge': [
        {
            label: 'Current HP',
            controlType: 'input'
        },
        {
            attributeName: 'drain_pct',
            label: 'HP DRAINED:',
            ignoreTooltip: true, 
            controlType: 'text',
            fn: function (v, a, parent, index, abilityModel, ability) {
                return v*a;
            }
        },
        {
            label: 'Current MP',
            controlType: 'input'
        },
        {
            attributeName: 'drain_pct',
            label: 'MP DRAINED:',
            ignoreTooltip: true, 
            controlType: 'text',
            fn: function (v, a, parent, index, abilityModel, ability) {
                return v*a;
            }
        },
        {
            attributeName: 'bonus_attack_speed',
            label: 'Total Damage',
            controlType: 'text',
            fn: function (v, a, parent, index, abilityModel, ability) {
                return a;
            },
            returnProperty: 'attackspeed'
        },
        {
            attributeName: 'bonus_damage_pct',
            label: 'Total Damage',
            controlType: 'text',
            fn: function (v, a, parent, index, abilityModel, ability) {
                return a;
            },
            returnProperty: 'damageReduction'
        }
    ],
    'witch_doctor_paralyzing_cask': [
        {
            label: 'Hero Bounce Count',
            controlType: 'input'
        },
        {
            attributeName: 'hero_damage',
            label: 'Total Damage',
            controlType: 'text',
            fn: function (v, a, parent, index, abilityModel, ability) {
                var bounces = abilityModel.getAbilityAttributeValue(ability.attributes, 'bounces',ability.level());
                return Math.min(Math.max(v, 0), bounces)*a;
            }
        },
        {
            label: 'Creep Bounce Count',
            controlType: 'input'
        },
        {
            attributeName: 'hero_damage',
            label: 'CREEP DAMAGE:',
            ignoreTooltip: true,
            controlType: 'text',
            fn: function (v, a, parent, index, abilityModel, ability) {
                var bounces = abilityModel.getAbilityAttributeValue(ability.attributes, 'bounces',ability.level());
                var damage = abilityModel.getAbilityPropertyValue(ability, 'damage');
                return Math.min(Math.max(v, 0), bounces)*damage;
            }
        }
    ],
    'witch_doctor_voodoo_restoration': [
        {
            label: 'Duration',
            controlType: 'input'
        },
        {
            attributeName: 'heal',
            label: 'Total Damage',
            controlType: 'text',
            fn: function (v, a, parent, index, abilityModel, ability) {
                var interval = abilityModel.getAbilityAttributeValue(ability.attributes, 'heal_interval',ability.level());
                var heal_per_tick = a * interval;
                var ticks = Math.max(Math.floor(v / interval) - 1, 0);
                return heal_per_tick * ticks;
            }
        },
        {
            attributeName: 'mana_per_second',
            label: 'MANA COST:',
            ignoreTooltip: true,
            controlType: 'text',
            fn: function (v, a, parent, index, abilityModel, ability) {
                var interval = abilityModel.getAbilityAttributeValue(ability.attributes, 'heal_interval',ability.level());
                var mana_per_tick = a * interval;
                var ticks = Math.max(Math.floor(v / interval) - 1, 0);
                return mana_per_tick * ticks;
            }
        }
    ],
    'witch_doctor_maledict': [
        {
            label: 'damage 0-4s',
            controlType: 'input'
        },
        {
            label: 'damage 4-8s',
            controlType: 'input'
        },
        {
            label: 'damage 8-12s',
            controlType: 'input'
        },
        {
            attributeName: 'bonus_damage',
            label: 'Dot Damage after 3s:',
            ignoreTooltip: true,
            controlType: 'method',
            fn: function (v, a, parent, index, abilityModel, ability) {
                var damage = abilityModel.getAbilityPropertyValue(ability, 'damage');
                return 3*damage;
            }
        },
        {
            attributeName: 'bonus_damage',
            label: 'Burst Damage at 4s:',
            ignoreTooltip: true,
            controlType: 'method',
            controls: [0, 3],
            fn: function (v, a, parent, index, abilityModel, ability) {
                var damage = abilityModel.getAbilityPropertyValue(ability, 'damage');
                var d = v.reduce(function (memo, o) { return memo + o }, 0);
                return Math.max(d, 0) * a/100;
            }
        },
        {
            attributeName: 'bonus_damage',
            label: 'Dot Damage after 7s:',
            ignoreTooltip: true,
            controlType: 'method',
            fn: function (v, a, parent, index, abilityModel, ability) {
                var damage = abilityModel.getAbilityPropertyValue(ability, 'damage');
                return 7*damage;
            }
        },
        {
            attributeName: 'bonus_damage',
            label: 'Burst Damage at 8s:',
            ignoreTooltip: true,
            controlType: 'method',
            controls: [0, 1, 4, 5],
            fn: function (v, a, parent, index, abilityModel, ability) {
                var damage = abilityModel.getAbilityPropertyValue(ability, 'damage');
                var d = v.reduce(function (memo, o) { return memo + o }, 0);
                return Math.max(d, 0) * a/100;
            }
        },
        {
            attributeName: 'bonus_damage',
            label: 'Dot Damage after 11s:',
            ignoreTooltip: true,
            controlType: 'method',
            fn: function (v, a, parent, index, abilityModel, ability) {
                var damage = abilityModel.getAbilityPropertyValue(ability, 'damage');
                return 11*damage;
            }
        },
        {
            attributeName: 'bonus_damage',
            label: 'Burst Damage at 12s:',
            ignoreTooltip: true,
            controlType: 'method',
            controls: [0, 1, 2, 4, 6, 7],
            fn: function (v, a, parent, index, abilityModel, ability) {
                var damage = abilityModel.getAbilityPropertyValue(ability, 'damage');
                var d = v.reduce(function (memo, o) { return memo + o }, 0);
                return Math.max(d, 0) * a/100;
            }
        },
        {
            attributeName: 'bonus_damage',
            label: 'Total Burst Damage:',
            ignoreTooltip: true,
            controlType: 'method',
            controls: [4, 6, 8],
            fn: function (v, a, parent, index, abilityModel, ability) {
                return v.reduce(function (memo, o) { return memo + o }, 0);
            }
        },
        {
            attributeName: 'bonus_damage',
            label: 'Total Maledict Damage:',
            ignoreTooltip: true,
            controlType: 'method',
            controls: [9],
            fn: function (v, a, parent, index, abilityModel, ability) {
                var duration = abilityModel.getAbilityAttributeValue(ability.attributes, 'duration_tooltip',0);
                var damage = abilityModel.getAbilityPropertyValue(ability, 'damage');
                return damage * duration + v[0];
            }
        },
        {
            label: 'Duration',
            controlType: 'input'
        },
        {
            attributeName: 'bonus_damage',
            label: 'DOT Damage',
            controlType: 'text',
            fn: function (v, a, parent, index, abilityModel, ability) {
                var duration = abilityModel.getAbilityAttributeValue(ability.attributes, 'duration_tooltip',0);
                return abilityModel.getAbilityPropertyValue(ability, 'damage')*Math.min(Math.max(v, 0), duration);
            }
        }
    ],
    'witch_doctor_death_ward': [
        {
            label: 'Duration',
            controlType: 'input'
        },
        {
            attributeName: 'damage',
            label: 'Total Damage',
            controlType: 'text',
            fn: function (v, a, parent, index, abilityModel, ability) {
                return v*a;
            }
        }
    ],
    'zuus_static_field': [
        {
            label: 'Enemy HP',
            controlType: 'input'
        },
        {
            attributeName: 'damage_health_pct',
            label: 'DAMAGE:',
            ignoreTooltip: true,
            controlType: 'text',
            fn: function (v, a, parent, index, abilityModel, ability) {
                return v*a/100;
            }
        }
    ]
}

module.exports = abilityData;
},{}],21:[function(require,module,exports){
(function (global){
'use strict';
var ko = (typeof window !== "undefined" ? window['ko'] : typeof global !== "undefined" ? global['ko'] : null);

ko.mapping = require('../lib/knockout.mapping');
ko.wrap = require('../lib/knockout.wrap');

ko.extenders.numeric = function(target, opts) {
    //create a writable computed observable to intercept writes to our observable
    var result = ko.pureComputed({
        read: target,  //always return the original observables value
        write: function(newValue) {
            var current = target(),
                roundingMultiplier = Math.pow(10, (opts === Object(opts) ? opts.precision : opts) || 0),
                newValueAsNum = isNaN(newValue) ? (opts.defaultValue || 0) : +newValue,
                valueToWrite = Math.round(newValueAsNum * roundingMultiplier) / roundingMultiplier;
 
            //only write if it changed
            if (valueToWrite !== current) {
                target(valueToWrite);
            } else {
                //if the rounded value is the same, but a different value was written, force a notification for the current field
                if (newValue !== current) {
                    target.notifySubscribers(valueToWrite);
                }
            }
        }
    }).extend({ notify: 'always' });
 
    //initialize with current value to make sure it is rounded appropriately
    result(target());
 
    //return the new computed observable
    return result;
};

module.exports = ko;
}).call(this,typeof global !== "undefined" ? global : typeof self !== "undefined" ? self : typeof window !== "undefined" ? window : {})

},{"../lib/knockout.mapping":44,"../lib/knockout.wrap":45}],22:[function(require,module,exports){
var IllusionOption = function (name, displayname, baseHero) {
    this.illusionName = name;
    this.illusionDisplayName = displayname;
    this.baseHero = baseHero;
};

module.exports = IllusionOption;
},{}],23:[function(require,module,exports){
var illusionData = {
    chaos_knight_phantasm: {
        hero: 'chaos_knight',
        displayName: 'Chaos Knight Phantasm',
        use_selected_hero: false,
        max_level: 3,
        outgoing_damage: 'outgoing_damage',
        incoming_damage: 'incoming_damage'
    },
    naga_siren_mirror_image: {
        hero: 'naga_siren',
        displayName: 'Naga Siren Mirror Image',
        use_selected_hero: false,
        max_level: 4,
        outgoing_damage: 'outgoing_damage',
        incoming_damage: 'incoming_damage'
    },
    dark_seer_wall_of_replica: {
        hero: 'dark_seer',
        displayName: 'Dark Seer Wall of Replica',
        use_selected_hero: true,
        max_level: 3,
        outgoing_damage: 'replica_damage_outgoing',
        incoming_damage: 'replica_damage_incoming',
        outgoing_damage_scepter: 'replica_damage_outgoing_scepter'
    },
    morphling_replicate: {
        hero: 'morphling',
        displayName: 'Morphling Replicate',
        use_selected_hero: true,
        max_level: 3,
        outgoing_damage: 'illusion_damage_out_pct',
        incoming_damage: 'illusion_damage_in_pct'
    },
    phantom_lancer_doppelwalk: {
        hero: 'phantom_lancer',
        displayName: 'Phantom Lancer Doppelwalk',
        use_selected_hero: false,
        max_level: 4,
        outgoing_damage: 'illusion_damage_out_pct',
        incoming_damage: 'illusion_damage_in_pct'        
    },
    phantom_lancer_juxtapose: {
        hero: 'phantom_lancer',
        displayName: 'Phantom Lancer Juxtapose',
        use_selected_hero: false,
        max_level: 4,
        outgoing_damage: 'illusion_damage_out_pct',
        incoming_damage: 'illusion_damage_in_pct'        
    },
    phantom_lancer_spirit_lance: {
        hero: 'phantom_lancer',
        displayName: 'Phantom Lancer Spirit Lance',
        use_selected_hero: false,
        max_level: 4,
        outgoing_damage: 'illusion_damage_out_pct',
        incoming_damage: 'illusion_damage_in_pct'        
    },
    shadow_demon_disruption: {
        hero: 'shadow_demon',
        displayName: 'Shadow Demon Disruption',
        use_selected_hero: true,
        max_level: 4,
        outgoing_damage: 'illusion_outgoing_damage',
        incoming_damage: 'illusion_incoming_damage'        
    },
    spectre_haunt: {
        hero: 'spectre',
        displayName: 'Spectre Haunt',
        use_selected_hero: false,
        max_level: 3,
        outgoing_damage: 'illusion_damage_outgoing',
        incoming_damage: 'illusion_damage_incoming'        
    },
    terrorblade_conjure_image: {
        hero: 'terrorblade',
        displayName: 'Terrorblade Conjure Image',
        use_selected_hero: false,
        max_level: 4,
        outgoing_damage: 'illusion_outgoing_damage',
        incoming_damage: 'illusion_incoming_damage'        
    },
    terrorblade_reflection: {
        hero: 'terrorblade',
        displayName: 'Terrorblade Reflection',
        use_selected_hero: true,
        max_level: 4,
        outgoing_damage: 'illusion_outgoing_damage'     
    },
    item_manta: {
        hero: '',
        is_item: true,
        displayName: 'Manta Style Illusion',
        use_selected_hero: true,
        max_level: 1,
        outgoing_damage_melee: 'images_do_damage_percent_melee',
        incoming_damage_melee: 'images_take_damage_percent_melee',
        outgoing_damage_ranged: 'images_do_damage_percent_ranged',
        incoming_damage_ranged: 'images_take_damage_percent_ranged'
    }
}

module.exports = illusionData;
},{}],24:[function(require,module,exports){
var IllusionOption = require("./IllusionOption");
var illusionData = require("./illusionData");

var illusionOptionsArray = [];
for (var h in illusionData) {
    illusionOptionsArray.push(new IllusionOption(h, illusionData[h].displayName, illusionData[h].hero));
}

module.exports = illusionOptionsArray;
},{"./IllusionOption":22,"./illusionData":23}],25:[function(require,module,exports){
var stackableItems = require("./stackableItems");
var levelItems = require("./levelItems");
var itemsWithActive = require("./itemsWithActive");

var BasicInventoryViewModel = function (h) {
    var self = this;
    self.items = ko.observableArray([]);
    self.activeItems = ko.observableArray([]);
    self.addItem = function (data, event) {
        if (data.selectedItem() != undefined) {
            var new_item = {
                item: data.selectedItem().split('|')[0],
                state: ko.observable(0),
                size: data.itemInputValue(),
                enabled: ko.observable(true)
            }
            switch (new_item.item) {
                case 'dagon':
                    new_item.size = Math.min(new_item.size, 5);
                break;
                break;
                case 'travel_boots':
                case 'diffusal_blade':
                    new_item.size = Math.min(new_item.size, 2);
                break;
                case 'necronomicon':
                    new_item.size = Math.min(new_item.size, 3);
                break;
            }
            this.items.push(new_item);
            if (data.selectedItem() === 'ring_of_aquila' || data.selectedItem() === 'ring_of_basilius' || data.selectedItem() === 'heart') {
                this.toggleItem(undefined, new_item, undefined);
            }
        }
    }.bind(this);
    self.toggleItem = function (index, data, event) {
        if (itemsWithActive.indexOf(data.item) >= 0) {
            if (this.activeItems.indexOf(data) < 0) {
                this.activeItems.push(data);
            }
            else {
                this.activeItems.remove(data);
            }
            switch (data.item) {
                case 'power_treads':
                    if (data.state() < 2) {
                        data.state(data.state() + 1);
                    }
                    else {
                        data.state(0);
                    }                
                break;
                default:
                    if (data.state() == 0) {
                        data.state(1);
                    }
                    else {
                        data.state(0);
                    }                
                break;
            }
        }
    }.bind(this);
    self.removeItem = function (item) {
        this.activeItems.remove(item);
        this.items.remove(item);
    }.bind(this);
    self.toggleMuteItem = function (item) {
        item.enabled(!item.enabled());
    }.bind(this);
    self.removeAll = function () {
        this.activeItems.removeAll();
        this.items.removeAll();
    }.bind(this);
}
BasicInventoryViewModel.prototype.getItemImage = function (data) {
    var state = ko.utils.unwrapObservable(data.state);
    switch (data.item) {
        case 'power_treads':
            if (state == 0) {
                return '/media/images/items/' + data.item + '_str.png';
            }
            else if (state == 1) {
                return '/media/images/items/' + data.item + '_int.png';
            }
            else {
                return '/media/images/items/' + data.item + '_agi.png';
            }
        break;
        case 'tranquil_boots':
        case 'ring_of_basilius':
            if (state == 0) {
                return '/media/images/items/' + data.item + '.png';
            }
            else {
                return '/media/images/items/' + data.item + '_active.png';
            }
        break;
        case 'armlet':
            if (state == 0) {
                return '/media/images/items/' + data.item + '.png';
            }
            else {
                return '/media/images/items/' + data.item + '_active.png';
            }
        break;
        case 'ring_of_aquila':
            if (state == 0) {
                return '/media/images/items/' + data.item + '_active.png';
            }
            else {
                return '/media/images/items/' + data.item + '.png';
            }
        break;
        case 'dagon':
        case 'diffusal_blade':
        case 'travel_boots':
        case 'necronomicon':
            if (data.size > 1) {
                return '/media/images/items/' + data.item + '_' + data.size + '.png';
            }
            else {
                return '/media/images/items/' + data.item + '.png';
            }
        break;
        default:
            return '/media/images/items/' + data.item + '.png';            
        break;
    }
};
BasicInventoryViewModel.prototype.getItemSizeLabel = function (data) {
    if (stackableItems.indexOf(data.item) != -1) {
        return '<span style="font-size:10px">Qty: </span>' + data.size;
    }
    else if (levelItems.indexOf(data.item) != -1) {
        return '<span style="font-size:10px">Lvl: </span>' + data.size;
    }
    else if (data.item == 'bloodstone') {
        return '<span style="font-size:10px">Charges: </span>' + data.size;
    }
    else {
        return '';
    }
};
BasicInventoryViewModel.prototype.getActiveBorder = function (data) {
    switch (data.item) {
        case 'power_treads':
        case 'tranquil_boots':
        case 'ring_of_basilius':
        case 'ring_of_aquila':
        case 'armlet':
            return 0;
        break;
        default:
            return ko.utils.unwrapObservable(data.state);    
        break;
    }
}
BasicInventoryViewModel.prototype.getItemAttributeValue = function (attributes, attributeName, level) {
    for (var i = 0; i < attributes.length; i++) {
        if (attributes[i].name == attributeName) {
            if (level == 0) {
                return parseFloat(attributes[i].value[0]);
            }
            else if (level > attributes[i].value.length) {
                return parseFloat(attributes[i].value[0]);
            }
            else {
                return parseFloat(attributes[i].value[level - 1]);
            }
        }
    }
}

module.exports = BasicInventoryViewModel;
},{"./itemsWithActive":31,"./levelItems":32,"./stackableItems":33}],26:[function(require,module,exports){
'use strict';
var ko = require('../herocalc_knockout');

var stackableItems = require("./stackableItems");
var levelItems = require("./levelItems");
var BasicInventoryViewModel = require("./BasicInventoryViewModel");
var itemOptionsArray = require("./itemOptionsArray");
var itemBuffOptions = require("./itemBuffOptions");
var itemDebuffOptions = require("./itemDebuffOptions");

var InventoryViewModel = function (itemData, h) {
    var self = this;
    BasicInventoryViewModel.call(this, h);
    self.hero = h;
    self.hasInventory = ko.observable(true);
    self.items = ko.observableArray([]);
    self.activeItems = ko.observableArray([]);
    self.hasScepter = ko.computed(function () {
        for (var i = 0; i < self.items().length; i++) {
            var item = self.items()[i].item;
            if (item === 'ultimate_scepter' && self.items()[i].enabled()) {
                return true;
            }
            
        }
        return false;
    }, this);
    self.isEthereal = ko.computed(function () {
        for (var i = 0; i < self.items().length; i++) {
            var item = self.items()[i].item;
            var isActive = self.activeItems.indexOf(self.items()[i]) >= 0 ? true : false;
            if ((item === 'ghost' || item === 'ethereal_blade') && self.items()[i].enabled() && isActive) {
                return true;
            }
        }
        return false;
    }, this);
    self.isSheeped = ko.computed(function () {
        for (var i = 0; i < self.items().length; i++) {
            var item = self.items()[i].item;
            var isActive = self.activeItems.indexOf(self.items()[i]) >= 0 ? true : false;
            if (item === 'sheepstick' && self.items()[i].enabled() && isActive) {
                return true;
            }
        }
        return false;
    }, this);
    self.totalCost = ko.computed(function () {
        var c = 0;
        for (var i = 0; i < self.items().length; i++) {
            var item = self.items()[i].item;
            if (!self.items()[i].enabled()) continue;
            if (stackableItems.indexOf(item) != -1) {
                c += itemData['item_' + item].itemcost * self.items()[i].size;
            }
            else if (levelItems.indexOf(item) != -1) {
                switch(item) {
                    case 'diffusal_blade':
                        c += itemData['item_' + item].itemcost + (self.items()[i].size - 1) * 700;
                    break;
                    case 'necronomicon':
                    case 'dagon':
                        c += itemData['item_' + item].itemcost + (self.items()[i].size - 1) * 1250;
                    break;
                    default:
                        c += itemData['item_' + item].itemcost;
                    break;
                }
            }
            else {
                c += itemData['item_' + item].itemcost;
            }
            
        }
        return c;
    }, this);
    self.addItemBuff = function (data, event) {
        if (self.hasInventory() && self.selectedItemBuff() != undefined) {
            var new_item = {
                item: self.selectedItemBuff(),
                state: ko.observable(0),
                size: 1,
                enabled: ko.observable(true)
            }
            self.items.push(new_item);
            if (self.selectedItemBuff() === 'ring_of_aquila' || self.selectedItemBuff() === 'ring_of_basilius') {
                self.toggleItem(undefined, new_item, undefined);
            }
        }
    };
    self.addItemDebuff = function (data, event) {
        if (self.hasInventory() && self.selectedItemDebuff() != undefined) {
            var new_item = {
                item: self.selectedItemDebuff().split('|')[0],
                state: ko.observable(0),
                size: 1,
                enabled: ko.observable(true)
            }
            if (self.selectedItemDebuff().split('|').length == 2) {
                new_item.debuff = self.selectedItemDebuff().split('|')[1]
            }
            self.items.push(new_item);
            if (self.selectedItemDebuff() === 'ring_of_aquila' || self.selectedItemDebuff() === 'ring_of_basilius') {
                self.toggleItem(undefined, new_item, undefined);
            }
        }
    };
    
    self.getAttributes = function (attributetype) {
        var totalAttribute = 0;
        for (var i = 0; i < self.items().length; i++) {
            var item = self.items()[i].item;
            var isActive = self.activeItems.indexOf(self.items()[i]) >= 0 ? true : false;
            if (!self.items()[i].enabled()) continue;
            var size = self.items()[i].size;
            for (var j = 0; j < itemData['item_' + item].attributes.length; j++) {
                var attribute = itemData['item_' + item].attributes[j];
                switch(attribute.name) {
                    case 'bonus_all_stats':
                        totalAttribute += parseInt(attribute.value[0]);
                    break;
                    case 'bonus_stats':
                        totalAttribute += parseInt(attribute.value[0]);
                    break;
                }
                switch(attributetype) {
                    case 'agi':
                        if (attribute.name == 'bonus_agility') {
                            if (item == 'diffusal_blade') {
                                totalAttribute += parseInt(attribute.value[size-1]);
                            }
                            else {
                                totalAttribute += parseInt(attribute.value[0]);
                            }
                        }
                        if (attribute.name == 'bonus_stat' && self.items()[i].state() == 2) {totalAttribute += parseInt(attribute.value[0]);};
                        if (attribute.name == 'bonus_agi') {totalAttribute += parseInt(attribute.value[0]);};
                    break;
                    case 'int':
                        if (attribute.name == 'bonus_intellect') {
                            if (item == 'necronomicon') {
                                totalAttribute += parseInt(attribute.value[size-1]);
                            }
                            else if (item == 'diffusal_blade') {
                                totalAttribute += parseInt(attribute.value[size-1]);
                            }
                            else if (item == 'dagon') {
                                totalAttribute += parseInt(attribute.value[size-1]);
                            }
                            else {
                                totalAttribute += parseInt(attribute.value[0]);
                            }
                        }
                        if (attribute.name == 'bonus_intelligence') {totalAttribute += parseInt(attribute.value[0]);};
                        if (attribute.name == 'bonus_int') {totalAttribute += parseInt(attribute.value[0]);};
                        if (attribute.name == 'bonus_stat' && self.items()[i].state() == 1) {totalAttribute += parseInt(attribute.value[0]);};
                    break;
                    case 'str':
                        if (attribute.name == 'bonus_strength') {
                            if (item == 'necronomicon') {
                                totalAttribute += parseInt(attribute.value[size-1]);
                            }
                            else {
                                totalAttribute += parseInt(attribute.value[0]);
                            }
                        }
                        if (attribute.name == 'bonus_stat' && self.items()[i].state() == 0) {totalAttribute += parseInt(attribute.value[0]);};
                        if (attribute.name == 'bonus_str') {totalAttribute += parseInt(attribute.value[0]);};
                        if (attribute.name == 'unholy_bonus_strength' && isActive) {totalAttribute += parseInt(attribute.value[0]);};
                    break;
                }
            }
        }
        return totalAttribute;
    };
    self.getBash = function (attacktype) {
        var totalAttribute = 1;
        for (var i = 0; i < self.items().length; i++) {
            var item = self.items()[i].item;
            if (!self.items()[i].enabled()) continue;
            for (var j = 0; j < itemData['item_' + item].attributes.length; j++) {
                var attribute = itemData['item_' + item].attributes[j];
                switch(attribute.name) {
                    case 'bash_chance':
                        totalAttribute *= (1 - parseInt(attribute.value[0]) / 100);
                    break;
                    case 'bash_chance_melee':
                        if (attacktype == 'DOTA_UNIT_CAP_MELEE_ATTACK') { totalAttribute *= (1 - parseInt(attribute.value[0]) / 100); };
                    break;
                    case 'bash_chance_ranged':
                        if (attacktype == 'DOTA_UNIT_CAP_RANGED_ATTACK') { totalAttribute *= (1 - parseInt(attribute.value[0]) / 100); };
                    break;
                }
            }
        }
        return totalAttribute;
    };
    
    self.getCritChance = function () {
        var totalAttribute = 1;
        for (var i = 0; i < self.items().length; i++) {
            var item = self.items()[i].item;
            var isActive = self.activeItems.indexOf(self.items()[i]) >= 0 ? true : false;
            if (!self.items()[i].enabled()) continue;
            for (var j = 0; j < itemData['item_' + item].attributes.length; j++) {
                var attribute = itemData['item_' + item].attributes[j];
                switch(attribute.name) {
                    case 'crit_chance':
                        totalAttribute *= (1 - parseInt(attribute.value[0]) / 100);
                    break;
                }
            }
        }
        return totalAttribute;
    };
    
    self.getCritSource = function () {
        var sources = {};
        for (var i = 0; i < self.items().length; i++) {
            var item = self.items()[i].item;
            var isActive = self.activeItems.indexOf(self.items()[i]) >= 0 ? true : false;
            if (!self.items()[i].enabled()) continue;
            switch (item) {
                case 'lesser_crit':
                case 'greater_crit':
                case 'bloodthorn':
                    if (sources[item] == undefined) {
                        sources[item] = {
                            'chance': self.getItemAttributeValue(itemData['item_' + item].attributes, 'crit_chance', 0) / 100,
                            'multiplier': self.getItemAttributeValue(itemData['item_' + item].attributes, 'crit_multiplier', 0) / 100,
                            'count': 1,
                            'displayname': itemData['item_' + item].displayname
                        }
                    }
                    else {
                        sources[item].count += 1;
                    }
                break;
            }
            if (item === 'bloodthorn' && isActive) {
                if (sources['soul_rend'] == undefined) {
                    sources['soul_rend'] = {
                        'chance': 1,
                        'multiplier': self.getItemAttributeValue(itemData['item_' + item].attributes, 'target_crit_multiplier', 0) / 100,
                        'count': 1,
                        'displayname': 'Soul Rend'
                    }
                }
                else {
                    sources['soul_rend'].count += 1;
                }
            }
        }
        return sources;
    };

    self.getCleaveSource = function () {
        var sources = {};
        for (var i = 0; i < self.items().length; i++) {
            var item = self.items()[i].item;
            var isActive = self.activeItems.indexOf(self.items()[i]) >= 0 ? true : false;
            if (!self.items()[i].enabled()) continue;
            switch (item) {
                case 'bfury':
                    if (sources[item] == undefined) {
                        sources[item] = {
                            'radius': self.getItemAttributeValue(itemData['item_' + item].attributes, 'cleave_radius', 0),
                            'magnitude': self.getItemAttributeValue(itemData['item_' + item].attributes, 'cleave_damage_percent', 0) / 100,
                            'count': 1,
                            'displayname': itemData['item_' + item].displayname
                        }
                    }
                    else {
                        sources[item].count += 1;
                    }
                break;
            }

        }
        return sources;
    };
    
    self.getBashSource = function (attacktype) {
        var sources = {};
        for (var i = 0; i < self.items().length; i++) {
            var item = self.items()[i].item;
            var isActive = self.activeItems.indexOf(self.items()[i]) >= 0 ? true : false;
            if (!self.items()[i].enabled()) continue;
            switch (item) {
                case 'javelin':
                    if (sources[item] == undefined) {
                        sources[item] = {
                            'damage': self.getItemAttributeValue(itemData['item_' + item].attributes, 'bonus_chance_damage', 1),
                            'damageType': 'magic',
                            'count': 1,
                            'chance': self.getItemAttributeValue(itemData['item_' + item].attributes, 'bonus_chance', 1) / 100,
                            'displayname': itemData['item_' + item].displayname + ' Pierce'
                        }
                    }
                    else {
                        sources[item].count += 1;
                    }
                break;
                case 'monkey_king_bar':
                    if (sources[item] == undefined) {
                        sources[item] = {
                            'item': item,
                            'chance': self.getItemAttributeValue(itemData['item_' + item].attributes, 'bash_chance', 0) / 100,
                            'damage': self.getItemAttributeValue(itemData['item_' + item].attributes, 'bash_damage', 0),
                            'duration': self.getItemAttributeValue(itemData['item_' + item].attributes, 'bash_stun', 0),
                            'count': 1,
                            'damageType': 'magic',
                            'displayname': 'Mini-Bash' //itemData['item_' + item].displayname
                        }
                    }
                    else {
                        sources[item].count += 1;
                    }
                break;
                case 'abyssal_blade':
                case 'basher':
                    if (!sources.hasOwnProperty('bash')) {
                        sources['bash'] = {
                            'item': item,
                            'chance': self.getItemAttributeValue(itemData['item_' + item].attributes, (attacktype == 'DOTA_UNIT_CAP_MELEE_ATTACK') ?'bash_chance_melee' : 'bash_chance_ranged', 0) / 100,
                            'damage': self.getItemAttributeValue(itemData['item_' + item].attributes, 'bonus_chance_damage', 0),
                            'duration': self.getItemAttributeValue(itemData['item_' + item].attributes, 'bash_duration', 0),
                            'count': 1,
                            'damageType': 'physical',
                            'displayname': 'Bash' //itemData['item_' + item].displayname
                        }
                    }
                    else {
                        //sources[item].count += 1;
                    }
                break;
            }

        }
        return sources;
    };
    
    self.getOrbProcSource = function () {
        var sources = {};
        for (var i = 0; i < self.items().length; i++) {
            var item = self.items()[i].item;
            var isActive = self.activeItems.indexOf(self.items()[i]) >= 0 ? true : false;
            if (!self.items()[i].enabled()) continue;
            switch (item) {
                case 'maelstrom':
                case 'mjollnir':
                    if (sources[item] == undefined) {
                        sources[item] = {
                            'chance': self.getItemAttributeValue(itemData['item_' + item].attributes, 'chain_chance', 0) / 100,
                            'damage': self.getItemAttributeValue(itemData['item_' + item].attributes, 'chain_damage', 0),
                            'count': 1,
                            'damageType': 'magic',
                            'displayname': itemData['item_' + item].displayname
                        }
                    }
                    else {
                        sources[item].count += 1;
                    }
                break;
            }

        }
        return sources;
    };

    self.getOrbSource = function () {
        var sources = {};
        for (var i = 0; i < self.items().length; i++) {
            var item = self.items()[i].item;
            var isActive = self.activeItems.indexOf(self.items()[i]) >= 0 ? true : false;
            if (!self.items()[i].enabled()) continue;
            switch (item) {
                case 'diffusal_blade':
                    if (sources[item] == undefined) {
                        sources[item] = {
                            'chance': 1,
                            'damage': self.getItemAttributeValue(itemData['item_' + item].attributes, 'feedback_mana_burn', self.items()[i].size),
                            'count': 1,
                            'damageType': 'physical',
                            'displayname': itemData['item_' + item].displayname
                        }
                    }
                    else {
                        sources[item].count += 1;
                    }
                break;
            }

        }
        return sources;
    };
    
    self.getHealth = function () {
        var totalAttribute = 0;
        for (var i = 0; i < self.items().length; i++) {
            var item = self.items()[i].item;
            if (!self.items()[i].enabled()) continue;
            for (var j = 0; j < itemData['item_' + item].attributes.length; j++) {
                var attribute = itemData['item_' + item].attributes[j];
                switch(attribute.name) {
                    case 'bonus_health':
                        totalAttribute += parseInt(attribute.value[0]);
                    break;
                }
            }
        }
        return totalAttribute;
    };
    self.getHealthRegen = function () {
        var totalAttribute = 0;
        for (var i = 0; i < self.items().length; i++) {
            var item = self.items()[i].item;
            var isActive = self.activeItems.indexOf(self.items()[i]) >= 0 ? true : false;
            if (!self.items()[i].enabled()) continue;
            for (var j = 0; j < itemData['item_' + item].attributes.length; j++) {
                var attribute = itemData['item_' + item].attributes[j];
                switch(attribute.name) {
                    case 'health_regen':
                    case 'bonus_regen':
                        totalAttribute += parseInt(attribute.value[0]);
                    break;
                    case 'bonus_health_regen':
                        if (item == 'tranquil_boots' && !isActive) {
                            totalAttribute += parseInt(attribute.value[0]);
                        }
                        else if (item != 'tranquil_boots') {
                            totalAttribute += parseInt(attribute.value[0]);
                        }
                    break;
                    case 'hp_regen':
                        totalAttribute += parseInt(attribute.value[0]);
                    break;
                    case 'health_regen_rate':
                        if (item == 'heart' && isActive) {
                            totalAttribute += (parseInt(attribute.value[0]) / 100) * self.hero.health();
                        }
                    break;
                }
            }
        }
        return totalAttribute;
    };
    self.getHealthRegenAura = function (e) {
        var totalAttribute = 0,
            excludeList = e || [];
        for (var i = 0; i < self.items().length; i++) {
            var item = self.items()[i].item;
            var isActive = self.activeItems.indexOf(self.items()[i]) >= 0 ? true : false;
            if (!self.items()[i].enabled()) continue;
            for (var j = 0; j < itemData['item_' + item].attributes.length; j++) {
                var attribute = itemData['item_' + item].attributes[j];
                if (excludeList.indexOf(item + attribute.name) > -1) continue;
                switch(attribute.name) {
                    case 'aura_health_regen':
                        totalAttribute += parseInt(attribute.value[0]);
                        excludeList.push(item + attribute.name);
                    break;
                }
            }
        }
        return {value: totalAttribute, excludeList: excludeList};
    };
    
    self.getMana = function () {
        var totalAttribute = 0;
        for (var i = 0; i < self.items().length; i++) {
            var item = self.items()[i].item;
            if (!self.items()[i].enabled()) continue;
            for (var j = 0; j < itemData['item_' + item].attributes.length; j++) {
                var attribute = itemData['item_' + item].attributes[j];
                switch(attribute.name) {
                    case 'bonus_mana':
                        totalAttribute += parseInt(attribute.value[0]);
                    break;
                }
            }
        }
        return totalAttribute;
    };
    
    self.getManaRegen = function () {
        var totalAttribute = 0;
        for (var i = 0; i < self.items().length; i++) {
            var item = self.items()[i].item;
            if (!self.items()[i].enabled()) continue;
            for (var j = 0; j < itemData['item_' + item].attributes.length; j++) {
                var attribute = itemData['item_' + item].attributes[j];
                switch(attribute.name) {
                    case 'aura_mana_regen':
                    case 'mana_regen_aura':
                        totalAttribute += parseFloat(attribute.value[0]);
                    break;
                    case 'mana_regen':
                        if (item == 'infused_raindrop') totalAttribute += parseFloat(attribute.value[0]);
                    break;
                }
            }
        }
        return totalAttribute;    
    };
    self.getManaRegenPercent = function () {
        var totalAttribute = 0;
        for (var i = 0; i < self.items().length; i++) {
            var item = self.items()[i].item;
            if (!self.items()[i].enabled()) continue;
            for (var j = 0; j < itemData['item_' + item].attributes.length; j++) {
                var attribute = itemData['item_' + item].attributes[j];
                switch(attribute.name) {
                    case 'bonus_mana_regen':
                    case 'mana_regen':
                    case 'bonus_mana_regen_pct':
                        if (item != 'infused_raindrop') totalAttribute += parseFloat(attribute.value[0]);
                    break;
                }
            }
        }
        return totalAttribute / 100;    
    };
    self.getManaRegenBloodstone = function () {
        for (var i = 0; i < self.items().length; i++) {
            var item = self.items()[i].item;
            if (!self.items()[i].enabled()) continue;
            if (item.indexOf('bloodstone') != -1) {
                return parseInt(self.items()[i].size);
            }
        }
        return 0;
    };
    
    self.getArmor = function () {
        var totalAttribute = 0;
        for (var i = 0; i < self.items().length; i++) {
            var item = self.items()[i].item;
            var isActive = self.activeItems.indexOf(self.items()[i]) >= 0 ? true : false;
            if (!self.items()[i].enabled()) continue;
            for (var j = 0; j < itemData['item_' + item].attributes.length; j++) {
                var attribute = itemData['item_' + item].attributes[j];
                switch(attribute.name) {
                    case 'bonus_armor':
                        if (!isActive || (item != 'medallion_of_courage' && item != 'solar_crest')) { totalAttribute += parseInt(attribute.value[0]); };
                    break;
                    case 'unholy_bonus_armor':
                        if (isActive && item == 'armlet') { totalAttribute += parseInt(attribute.value[0]); };
                    break;
                }
            }
        }
        return totalAttribute;
    };
    
    self.getArmorAura = function (aList) {
        var totalAttribute = 0,
            attributeList = aList || [];
        for (var i = 0; i < self.items().length; i++) {
            var item = self.items()[i].item;
            var isActive = self.activeItems.indexOf(self.items()[i]) >= 0 ? true : false;
            if (!self.items()[i].enabled()) continue;
            for (var j = 0;j < itemData['item_' + item].attributes.length; j++) {
                var attribute = itemData['item_' + item].attributes[j];
                if (attributeList.find(function (a) { return attribute.name == a.name; })) continue;
                switch(attribute.name) {
                    // buckler
                    case 'bonus_aoe_armor':
                        if (isActive) {
                            attributeList.push({'name':attribute.name, 'value': parseInt(attribute.value[0])});
                        }
                    break;
                    // assault
                    case 'aura_positive_armor':
                        attributeList.push({'name':attribute.name, 'value': parseInt(attribute.value[0])});
                    break;
                    // ring_of_aquila,ring_of_basilius
                    case 'aura_bonus_armor':
                        if (isActive) {
                            attributeList.push({'name':attribute.name, 'value': parseInt(attribute.value[0])});
                        }
                    break;
                    // vladmir
                    case 'armor_aura':
                        attributeList.push({'name':attribute.name, 'value': parseInt(attribute.value[0])});
                    break;
                    // mekansm
                    case 'heal_bonus_armor':
                        if (isActive) {
                            attributeList.push({'name':attribute.name, 'value': parseInt(attribute.value[0])});
                        }
                    break;
                }
            }
        }
        // remove buckler if there is a mekansm
        if (attributeList.find(function (attribute) { return attribute.name == 'heal_bonus_armor'; })) {
            attributeList = attributeList.filter(function (attribute) {
                return attribute.name !== 'bonus_aoe_armor';
            });
        }
        // remove ring_of_aquila,ring_of_basilius if there is a vladmir
        if (attributeList.find(function (attribute) { return attribute.name == 'armor_aura'; })) {
            attributeList = attributeList.filter(function (attribute) {
                return attribute.name !== 'aura_bonus_armor';
            });
        }
        
        totalAttribute = attributeList.reduce(function (memo, attribute) {
            return memo += attribute.value;
        }, 0);
        return {value: totalAttribute, attributes: attributeList};
    };
    self.getArmorReduction = function (e) {
        var totalAttribute = 0,
            excludeList = e || [];
        for (var i = 0; i < self.items().length; i++) {
            var item = self.items()[i].item;
            var isActive = self.activeItems.indexOf(self.items()[i]) >= 0 ? true : false;
            if (!self.items()[i].enabled()) continue;
            for (var j = 0; j < itemData['item_' + item].attributes.length; j++) {
                var attribute = itemData['item_' + item].attributes[j];
                if (excludeList.indexOf(attribute.name) > -1 || excludeList.indexOf(item + '_' + attribute.name) > -1) continue;
                switch(attribute.name) {
                    case 'armor_reduction':
                        if (isActive || (item != 'medallion_of_courage' && item != 'solar_crest')) {
                            totalAttribute += parseInt(attribute.value[0]);
                            excludeList.push(item + '_' + attribute.name);
                        }
                    break;
                    case 'aura_negative_armor':
                        totalAttribute += parseInt(attribute.value[0]);
                        excludeList.push(attribute.name);
                    break;
                    case 'corruption_armor':
                        totalAttribute += parseInt(attribute.value[0]);
                        excludeList.push(attribute.name);
                    break;
                }
            }
        }
        return {value: totalAttribute, excludeList: excludeList};
    };
    self.getEvasion = function () {
        var totalAttribute = 1;
        for (var i = 0; i < self.items().length; i++) {
            var item = self.items()[i].item;
            var isActive = self.activeItems.indexOf(self.items()[i]) >= 0 ? true : false;
            if (!self.items()[i].enabled()) continue;
            for (var j = 0; j < itemData['item_' + item].attributes.length; j++) {
                var attribute = itemData['item_' + item].attributes[j];
                switch(attribute.name) {
                    case 'bonus_evasion':
                        if (!isActive || (item != 'butterfly' && item != 'solar_crest')) { totalAttribute *= (1 - parseInt(attribute.value[0]) / 100); }
                    break;
                }
            }
        }
        return totalAttribute;
    };
    self.getMovementSpeedFlat = function () {
        var totalAttribute = 0,
        hasBoots = false,
        hasEuls = false,
        hasWindLace = false,
        bootItems = ['boots','phase_boots','arcane_boots','travel_boots','power_treads','tranquil_boots','guardian_greaves'];
        for (var i = 0; i < self.items().length; i++) {
            var item = self.items()[i].item;
            var isActive = self.activeItems.indexOf(self.items()[i]) >= 0 ? true : false;
            if (!self.items()[i].enabled()) continue;
            for (var j = 0; j < itemData['item_' + item].attributes.length; j++) {
                var attribute = itemData['item_' + item].attributes[j];
                switch(attribute.name) {
                    case 'bonus_movement_speed':
                        if (!hasBoots && bootItems.indexOf(item) >= 0) {
                            if (item != 'tranquil_boots' || (item == 'tranquil_boots' && !isActive)) {
                                totalAttribute += parseInt(attribute.value[0]);
                                hasBoots = true;
                            }
                        }
                        //else if (!hasEuls && item == 'cyclone') {
                        else if (item == 'cyclone') {
                            totalAttribute += parseInt(attribute.value[0]);
                            hasEuls = true;
                        }
                    break;
                    case 'broken_movement_speed':
                        if (!hasBoots && bootItems.indexOf(item) >= 0) {
                            if (item == 'tranquil_boots' && isActive) {
                                totalAttribute += parseInt(attribute.value[0]);
                                hasBoots = true;
                            }
                        }
                    break;
                    case 'bonus_movement':
                        if (!hasBoots && bootItems.indexOf(item) >= 0) {
                            totalAttribute += parseInt(attribute.value[0]);
                            hasBoots = true;
                        }
                    break;
                    case 'movement_speed':
                        if (!hasWindLace && item == 'wind_lace') {
                            totalAttribute += parseInt(attribute.value[0]);
                            hasWindLace = true;
                        }
                    break;
                }
            }
        }
        return totalAttribute;
    };
    self.getMovementSpeedPercent = function (e) {
        var totalAttribute = 0,
            excludeList = e || [],
            hasYasha = false,
            hasDrums = false,
            hasDrumsActive = false,
            hasPhaseActive = false,
            hasShadowBladeActive = false,
            hasButterflyActive = false,
            hasMoMActive = false,
            yashaItems = ['manta','yasha','sange_and_yasha'];
        for (var i = 0; i < self.items().length; i++) {
            var item = self.items()[i].item;
            var isActive = self.activeItems.indexOf(self.items()[i]) >= 0 ? true : false;
            if (!self.items()[i].enabled()) continue;
            for (var j = 0; j < itemData['item_' + item].attributes.length; j++) {
                var attribute = itemData['item_' + item].attributes[j];
                if (excludeList.indexOf(attribute.name) > -1) continue;
                switch(attribute.name) {
                    case 'movement_speed_percent_bonus':
                        if (!hasYasha && yashaItems.indexOf(item) >= 0) {
                            totalAttribute += parseInt(attribute.value[0]);
                            hasYasha = true;
                        }
                    break;
                    case 'bonus_aura_movement_speed_pct':
                        if (!hasDrums && item == 'ancient_janggo') {
                            totalAttribute += parseInt(attribute.value[0]);
                            hasDrums = true;
                            excludeList.push(attribute.name);
                        }
                    break;
                    case 'phase_movement_speed':
                        if (isActive && !hasPhaseActive) {
                            totalAttribute += parseInt(attribute.value[0]);
                            hasPhaseActive = true;
                        }
                    break;
                    case 'bonus_movement_speed_pct':
                        if (isActive && !hasDrumsActive && item == 'ancient_janggo') {
                            totalAttribute += parseInt(attribute.value[0]);
                            hasDrumsActive = true;
                            excludeList.push(attribute.name);
                        }
                    break;
                    case 'windwalk_movement_speed':
                        if (isActive && !hasShadowBladeActive && (item == 'invis_sword' || item == 'silver_edge')) {
                            totalAttribute += parseInt(attribute.value[0]);
                            hasShadowBladeActive = true;
                        }
                    break;
                    case 'berserk_bonus_movement_speed':
                        if (isActive && !hasMoMActive && item == 'mask_of_madness') {
                            totalAttribute += parseInt(attribute.value[0]);
                            hasMoMActive = true;
                        }
                    break;
                    case 'bonus_movement_speed': //manta
                        if (!hasYasha && item == 'manta') {
                            totalAttribute += parseInt(attribute.value[0]);
                            hasYasha = true;
                        }
                        else if (item == 'smoke_of_deceit' && isActive) {
                            totalAttribute += parseInt(attribute.value[0]);
                        }
                    break;
                    case 'bonus_move_speed':
                        if (isActive && !hasButterflyActive && item == 'butterfly') {
                            totalAttribute += parseInt(attribute.value[0]);
                            hasButterflyActive = true;
                        }
                    break;
                }
            }
        }
        return {value: totalAttribute/100, excludeList: excludeList};
    };
    
    self.getMovementSpeedPercentReduction = function (e) {
        var totalAttribute = 0,
            excludeList = e || [];
        for (var i = 0; i < self.items().length; i++) {
            var item = self.items()[i].item;
            var isActive = self.activeItems.indexOf(self.items()[i]) >= 0 ? true : false;
            if (!self.items()[i].enabled()) continue;
            for (var j = 0; j < itemData['item_' + item].attributes.length; j++) {
                var attribute = itemData['item_' + item].attributes[j];
                if (excludeList.indexOf(attribute.name) > -1) continue;
                switch(attribute.name) {
                    case 'movespeed':
                        if (item == 'dust' && isActive) {
                            totalAttribute += parseInt(attribute.value[0]);
                        }
                    case 'blast_movement_speed':
                        if (item == 'shivas_guard' && isActive) {
                            totalAttribute += parseInt(attribute.value[0]);
                            excludeList.push(attribute.name);
                        }
                    case 'cold_movement_speed':
                        if (item == 'skadi') {
                            totalAttribute += parseInt(attribute.value[0]);
                        }
                    break;
                    case 'maim_movement_speed':
                        if (self.items()[i].debuff && self.items()[i].debuff == 'maim') {
                            totalAttribute += parseInt(attribute.value[0]);
                            excludeList.push(attribute.name);
                        }
                    break;
                }
            }
        }
        return {value: totalAttribute/100, excludeList: excludeList};
    };
    
    self.getBonusDamage = function () {
        var totalAttribute = 0;
        var sources = {};
        for (var i = 0; i < self.items().length; i++) {
            var item = self.items()[i].item;
            var isActive = self.activeItems.indexOf(self.items()[i]) >= 0 ? true : false;
            if (!self.items()[i].enabled()) continue;
            for (var j = 0; j < itemData['item_' + item].attributes.length; j++) {
                var attribute = itemData['item_' + item].attributes[j];
                switch(attribute.name) {
                    case 'bonus_damage':
                        totalAttribute += parseInt(attribute.value[0]);
                        if (sources[item] == undefined) {
                            sources[item] = {
                                'damage': parseInt(attribute.value[0]),
                                'damageType': 'physical',
                                'count':1,
                                'displayname': itemData['item_' + item].displayname
                            }                            
                        }
                        else {
                            sources[item].count += 1;
                        }
                    break;
                    case 'unholy_bonus_damage':
                        if (isActive) {
                            totalAttribute += parseInt(attribute.value[0]);
                            if (sources[item + '_active'] == undefined) {
                                sources[item + '_active'] = {
                                    'damage': parseInt(attribute.value[0]),
                                    'damageType': 'physical',
                                    'count':1,
                                    'displayname': itemData['item_' + item].displayname + ' Unholy Strength'
                                }                            
                            }
                            else {
                                sources[item].count += 1;
                            }
                        }
                    break;
                }
            }
        }
        return { sources: sources, total: totalAttribute };
    };
    self.getBonusDamagePercent = function (s) {
        s = s || {sources:{},total:0};
        var totalAttribute = s.total || 0;
        var sources = s.sources || {};
        for (var i = 0; i < self.items().length; i++) {
            var item = self.items()[i].item;
            var isActive = self.activeItems.indexOf(self.items()[i]) >= 0 ? true : false;
            if (!self.items()[i].enabled()) continue;
            for (var j = 0; j < itemData['item_' + item].attributes.length; j++) {
                var attribute = itemData['item_' + item].attributes[j];
                switch(attribute.name) {
                    case 'damage_aura':
                        if (sources[item] == undefined) {
                            totalAttribute += parseInt(attribute.value[0]) / 100;
                            sources[item] = {
                                'damage': parseInt(attribute.value[0]) / 100,
                                'damageType': 'physical',
                                'count':1,
                                'displayname': itemData['item_' + item].displayname
                            }
                        }
                        // else {
                            // sources[item].count += 1;
                        // }
                    break;
                }
            }
        }
        return { sources: sources, total: totalAttribute };
    };
    self.getAttackSpeed = function (e) {
        var totalAttribute = 0,
            hasPowerTreads = false,
            excludeList = e || [];
        for (var i = 0; i < self.items().length; i++) {
            var item = self.items()[i].item;
            var isActive = self.activeItems.indexOf(self.items()[i]) >= 0 ? true : false;
            if (!self.items()[i].enabled()) continue;
            for (var j = 0; j < itemData['item_' + item].attributes.length; j++) {
                var attribute = itemData['item_' + item].attributes[j];
                if (excludeList.indexOf(attribute.name) > -1) continue;
                switch(attribute.name) {
                    case 'bonus_attack_speed':
                        if (item == 'power_treads') {
                            if (!hasPowerTreads) {
                                totalAttribute += parseInt(attribute.value[0]);
                                hasPowerTreads = true;
                            }
                        }
                        else if (item == 'moon_shard') {
                            if (!isActive) {
                                totalAttribute += parseInt(attribute.value[0]);
                            }
                        }
                        else if (item == 'hurricane_pike') {
                            if (isActive) {
                                totalAttribute += parseInt(attribute.value[0]);
                            }
                        }
                        else {
                            totalAttribute += parseInt(attribute.value[0]);
                        }
                    break;
                    case 'consumed_bonus':
                        if (item == 'moon_shard' && isActive) {
                            totalAttribute += parseInt(attribute.value[0]);
                        }
                    break;
                    break;
                    case 'bonus_speed':
                        totalAttribute += parseInt(attribute.value[0]);
                    break;
                    case 'aura_attack_speed':
                        if (item != 'shivas_guard') { totalAttribute += parseInt(attribute.value[0]); };
                    break;
                    // ancient_janggo
                    case 'bonus_aura_attack_speed_pct':
                        totalAttribute += parseInt(attribute.value[0]);
                        excludeList.push(attribute.name);
                    break;
                    // ancient_janggo
                    case 'bonus_attack_speed_pct':
                        if (isActive) {
                            totalAttribute += parseInt(attribute.value[0]);
                            excludeList.push(attribute.name);
                        }
                    break;
                    case 'unholy_bonus_attack_speed':
                        if (isActive) { totalAttribute += parseInt(attribute.value[0]); };
                    break;
                    case 'berserk_bonus_attack_speed':
                        if (isActive) { totalAttribute += parseInt(attribute.value[0]); };
                    break;
                }
            }
        }
        return {value: totalAttribute, excludeList: excludeList};
    };
    self.getAttackSpeedReduction = function (e) {
        var totalAttribute = 0,
            excludeList = e || [];
        for (var i = 0; i < self.items().length; i++) {
            var item = self.items()[i].item;
            var isActive = self.activeItems.indexOf(self.items()[i]) >= 0 ? true : false;
            if (!self.items()[i].enabled()) continue;
            for (var j = 0; j < itemData['item_' + item].attributes.length; j++) {
                var attribute = itemData['item_' + item].attributes[j];
                if (excludeList.indexOf(attribute.name) > -1) continue;
                switch(attribute.name) {
                    case 'aura_attack_speed':
                        if (item == 'shivas_guard') {
                            totalAttribute += parseInt(attribute.value[0]);
                            excludeList.push(attribute.name);
                        }
                    break;
                    case 'cold_attack_speed':
                        if (item == 'skadi') {
                            totalAttribute += parseInt(attribute.value[0]);
                            excludeList.push(attribute.name);
                        }
                    break;
                    case 'maim_attack_speed':
                        if (self.items()[i].debuff && self.items()[i].debuff == 'maim') {
                            totalAttribute += parseInt(attribute.value[0]);
                            excludeList.push(attribute.name);
                        }
                    break;
                }
            }
        }
        return {value: totalAttribute, excludeList: excludeList};
    };
    self.getLifesteal = function () {
        var totalAttribute = 0;
        for (var i = 0; i < self.items().length; i++) {
            var item = self.items()[i].item;
            var isActive = self.activeItems.indexOf(self.items()[i]) >= 0 ? true : false;
            if (!self.items()[i].enabled()) continue;
            for (var j = 0; j < itemData['item_' + item].attributes.length; j++) {
                var attribute = itemData['item_' + item].attributes[j];
                switch(attribute.name) {
                    case 'lifesteal_percent':
                        if (item == 'satanic') {
                            if (!isActive) { return parseInt(attribute.value[0]); };
                        }
                        else {
                            return parseInt(attribute.value[0]);
                        }
                    break;
                    case 'unholy_lifesteal_percent':
                        if (isActive) { return parseInt(attribute.value[0]); };
                    break;
                }
            }
        }
        return totalAttribute;
    };
    self.getLifestealAura = function (e) {
        var totalAttribute = 0,
            excludeList = e || [];
        for (var i = 0; i < self.items().length; i++) {
            var item = self.items()[i].item;
            var isActive = self.activeItems.indexOf(self.items()[i]) >= 0 ? true : false;
            if (!self.items()[i].enabled()) continue;
            for (var j = 0; j < itemData['item_' + item].attributes.length; j++) {
                var attribute = itemData['item_' + item].attributes[j];
                if (excludeList.indexOf(attribute.name) > -1) continue;
                switch(attribute.name) {
                    case 'vampiric_aura':
                        totalAttribute += parseInt(attribute.value[0]);
                        excludeList.push(attribute.name);
                    break;
                }
            }
        }
        return {value: totalAttribute, excludeList: excludeList};
    };
    self.getMagicResist = function () {
        var totalAttribute = 1;
        for (var i = 0; i < self.items().length; i++) {
            var item = self.items()[i].item;
            var isActive = self.activeItems.indexOf(self.items()[i]) >= 0 ? true : false;
            if (!self.items()[i].enabled()) continue;
            for (var j = 0; j < itemData['item_' + item].attributes.length; j++) {
                var attribute = itemData['item_' + item].attributes[j];
                switch(attribute.name) {
                    case 'bonus_magical_armor':
                        totalAttribute *= (1 - parseInt(attribute.value[0]) / 100);
                    break;
                    case 'bonus_spell_resist':
                        totalAttribute *= (1 - parseInt(attribute.value[0]) / 100);
                    break;
                    case 'magic_resistance':
                        totalAttribute *= (1 - parseInt(attribute.value[0]) / 100);
                    break;
                }
            }
        }
        return totalAttribute;
    };
    self.getMagicResistReductionSelf = function () {
        var totalAttribute = 1;
        for (var i = 0; i < self.items().length; i++) {
            var item = self.items()[i].item;
            var isActive = self.activeItems.indexOf(self.items()[i]) >= 0 ? true : false;
            if (!self.items()[i].enabled()) continue;
            if (isActive) {
                for (var j = 0; j < itemData['item_' + item].attributes.length; j++) {
                    var attribute = itemData['item_' + item].attributes[j];
                    switch(attribute.name) {
                        case 'extra_spell_damage_percent':
                        case 'ethereal_damage_bonus':
                            return (1 - parseInt(attribute.value[0]) / 100);
                        break;
                    }
                }
            }
        }
        return totalAttribute;
    };   
    self.getMagicResistReduction = function () {
        var totalAttribute = 1;
        for (var i = 0; i < self.items().length; i++) {
            var item = self.items()[i].item;
            var isActive = self.activeItems.indexOf(self.items()[i]) >= 0 ? true : false;
            if (!self.items()[i].enabled()) continue;
            if (isActive) {
                for (var j = 0; j < itemData['item_' + item].attributes.length; j++) {
                    var attribute = itemData['item_' + item].attributes[j];
                    switch(attribute.name) {
                        case 'ethereal_damage_bonus':
                            if (!self.isEthereal()) totalAttribute *= (1 - parseInt(attribute.value[0]) / 100);
                        case 'resist_debuff':
                            totalAttribute *= (1 - parseInt(attribute.value[0]) / 100);
                        break;
                    }
                }
            }
        }
        return totalAttribute;
    };        

    self.getVisionRangeNight = ko.computed(function () {
        var totalAttribute = 0;
        for (var i = 0; i < self.items().length; i++) {
            var item = self.items()[i].item;
            var isActive = self.activeItems.indexOf(self.items()[i]) >= 0 ? true : false;
            if (!self.items()[i].enabled()) continue;
            for (var j = 0; j < itemData['item_' + item].attributes.length; j++) {
                var attribute = itemData['item_' + item].attributes[j];
                switch(attribute.name) {
                    case 'bonus_night_vision':
                        if (item != 'moon_shard' || !isActive) {
                            totalAttribute += parseInt(attribute.value[0]);
                        }
                    break;
                }
            }
        }
        return totalAttribute;
    });
    
    self.getAttackRange = function (attacktype, aList) {
        var totalAttribute = 0,
            attributeList = aList || [];
        for (var i = 0; i < self.items().length; i++) {
            var item = self.items()[i].item;
            var isActive = self.activeItems.indexOf(self.items()[i]) >= 0 ? true : false;
            if (!self.items()[i].enabled()) continue;
            for (var j = 0;j < itemData['item_' + item].attributes.length; j++) {
                var attribute = itemData['item_' + item].attributes[j];
                if (attributeList.find(function (a) { return attribute.name == a.name; })) continue;
                switch(attribute.name) {
                    // dragon_lance
                    case 'base_attack_range':
                        if (attacktype == 'DOTA_UNIT_CAP_RANGED_ATTACK') attributeList.push({'name':attribute.name, 'value': parseInt(attribute.value[0])});
                    break;
                }
            }
        }
        
        totalAttribute = attributeList.reduce(function (memo, attribute) {
            return memo += attribute.value;
        }, 0);
        return {value: totalAttribute, attributes: attributeList};
    };
    
    self.getMissChance = function (e) {
        var totalAttribute = 1,
            excludeList = e || [];
        for (var i = 0; i < self.items().length; i++) {
            var item = self.items()[i].item;
            var isActive = self.activeItems.indexOf(self.items()[i]) >= 0 ? true : false;
            if (!self.items()[i].enabled()) continue;
            for (var j = 0; j < itemData['item_' + item].attributes.length; j++) {
                var attribute = itemData['item_' + item].attributes[j];
                if (excludeList.indexOf(attribute.name) > -1) continue;
                switch(attribute.name) {
                    case 'miss_chance':
                        if (item === 'solar_crest' && isActive) {
                            totalAttribute *= (1 - parseInt(attribute.value[0]) / 100);
                            excludeList.push(attribute.name);
                        }
                    break;
                    case 'blind_pct':
                        totalAttribute *= (1 - parseInt(attribute.value[0]) / 100);
                        excludeList.push(attribute.name);
                    break;
                }
            }
        }
        return {value: totalAttribute, excludeList: excludeList};
    };
    
    self.getBaseDamageReductionPct = function () {
        var totalAttribute = 1;
        for (var i = 0; i < self.items().length; i++) {
            var item = self.items()[i].item;
            var isActive = self.activeItems.indexOf(self.items()[i]) >= 0 ? true : false;
            if (!self.items()[i].enabled()) continue;
            for (var j = 0; j < itemData['item_' + item].attributes.length; j++) {
                var attribute = itemData['item_' + item].attributes[j];
                switch(attribute.name) {
                    case 'backstab_reduction':
                        if (self.items()[i].debuff && self.items()[i].debuff == 'shadow_walk') {
                            totalAttribute *= (1 + parseInt(attribute.value[0]) / 100);
                        }
                    break;
                }
            }
        }
        return totalAttribute;
    };    
    self.getBonusDamageReductionPct = function () {
        var totalAttribute = 1;
        for (var i = 0; i < self.items().length; i++) {
            var item = self.items()[i].item;
            var isActive = self.activeItems.indexOf(self.items()[i]) >= 0 ? true : false;
            if (!self.items()[i].enabled()) continue;
            for (var j = 0; j < itemData['item_' + item].attributes.length; j++) {
                var attribute = itemData['item_' + item].attributes[j];
                switch(attribute.name) {
                    case 'backstab_reduction':
                        if (self.items()[i].debuff && self.items()[i].debuff == 'shadow_walk') {
                            totalAttribute *= (1 + parseInt(attribute.value[0]) / 100);
                        }
                    break;
                }
            }
        }
        return totalAttribute;
    };
    
    self.itemOptions = ko.observableArray(itemOptionsArray.items);
    
    self.itemBuffOptions = ko.observableArray(itemBuffOptions.items);
    self.selectedItemBuff = ko.observable('assault');

    self.itemDebuffOptions = ko.observableArray(itemDebuffOptions.items);
    self.selectedItemDebuff = ko.observable('assault');
    
    return self;
};
InventoryViewModel.prototype = Object.create(BasicInventoryViewModel.prototype);
InventoryViewModel.prototype.constructor = InventoryViewModel;

module.exports = InventoryViewModel;
},{"../herocalc_knockout":21,"./BasicInventoryViewModel":25,"./itemBuffOptions":28,"./itemDebuffOptions":29,"./itemOptionsArray":30,"./levelItems":32,"./stackableItems":33}],27:[function(require,module,exports){
var ItemInput = function (itemData, value, name, debuff) {
    if (itemData['item_' + value].ItemAliases instanceof Array) {
        var itemAlias = itemData['item_' + value].ItemAliases.join(' ');
    }
    else {
        var itemAlias = itemData['item_' + value].ItemAliases;
    }
    this.value = ko.observable(value);
    this.debuff = ko.observable(debuff);
    if (this.debuff()) {
        this.value = ko.observable(value + '|' + debuff.id);
        this.name = ko.observable(name + ' (' + debuff.name + ')');
        this.displayname = ko.observable(name + ' (' + debuff.name + ') <span style="display:none">' + ';' + itemAlias + '</span>');
    }
    else {
        this.value = ko.observable(value);
        this.name = ko.observable(name);
        this.displayname = ko.observable(name + ' <span style="display:none">' + ';' + itemAlias + '</span>');
    }
};

module.exports = ItemInput;
},{}],28:[function(require,module,exports){
var ItemInput = require("./ItemInput");
var itemBuffs = ['assault', 'ancient_janggo', 'headdress', 'mekansm', 'pipe', 'ring_of_aquila', 'vladmir', 'ring_of_basilius', 'buckler', 'solar_crest'];
var itemBuffOptions = {};

var init = function (itemData) {
    itemBuffOptions.items = itemBuffs.map(function(item) {
        return new ItemInput(itemData, item, itemData['item_' + item].displayname);
    });
    return itemBuffOptions.items;
}

itemBuffOptions.init = init;

module.exports = itemBuffOptions;
},{"./ItemInput":27}],29:[function(require,module,exports){
var ItemInput = require("./ItemInput");
var itemDebuffs = [
    {item: 'assault', debuff: null},
    {item: 'shivas_guard', debuff: null},
    {item: 'desolator', debuff: null},
    {item: 'medallion_of_courage', debuff: null},
    {item: 'radiance', debuff: null},
    {item: 'sheepstick', debuff: null},
    {item: 'veil_of_discord', debuff: null},
    {item: 'solar_crest', debuff: null},
    {item: 'silver_edge', debuff: {id: 'shadow_walk', name: 'Shadow Walk'}},
    {item: 'silver_edge', debuff: {id: 'maim', name: 'Lesser Maim'}}
]
var itemDebuffOptions = {};

var init = function (itemData) {
    itemDebuffOptions.items = itemDebuffs.map(function(item) {
        return new ItemInput(itemData, item.item, itemData['item_' + item.item].displayname, item.debuff);
    });
    return itemDebuffOptions.items;
}

itemDebuffOptions.init = init;

module.exports = itemDebuffOptions;
},{"./ItemInput":27}],30:[function(require,module,exports){
var validItems = require("./validItems");
var ItemInput = require("./ItemInput");

var itemOptionsArray = {};

var init = function (itemData) {
    itemOptionsArray.items = [];
    for (var i = 0; i < validItems.length; i++) {
        itemOptionsArray.items.push(new ItemInput(itemData, validItems[i], itemData['item_' + validItems[i]].displayname));
    }
    return itemOptionsArray.items;
}

itemOptionsArray.init = init;

module.exports = itemOptionsArray;
},{"./ItemInput":27,"./validItems":34}],31:[function(require,module,exports){
module.exports = ['solar_crest', 'heart','smoke_of_deceit','dust','ghost','tranquil_boots','phase_boots','power_treads','buckler','medallion_of_courage','ancient_janggo','mekansm','pipe','veil_of_discord','rod_of_atos','orchid','sheepstick','armlet','invis_sword','ethereal_blade','shivas_guard','manta','mask_of_madness','diffusal_blade','mjollnir','satanic','ring_of_basilius','ring_of_aquila', 'butterfly', 'moon_shard', 'silver_edge','bloodthorn','hurricane_pike'];
},{}],32:[function(require,module,exports){
module.exports = ['necronomicon','dagon','diffusal_blade','travel_boots'];
},{}],33:[function(require,module,exports){
module.exports = ['clarity','flask','dust','ward_observer','ward_sentry','tango','tpscroll','smoke_of_deceit'];
},{}],34:[function(require,module,exports){
module.exports = ["abyssal_blade","ultimate_scepter","courier","arcane_boots","armlet","assault","boots_of_elves","bfury","belt_of_strength","black_king_bar","blade_mail","blade_of_alacrity","blades_of_attack","blink","bloodstone","boots","travel_boots","bottle","bracer","broadsword","buckler","butterfly","chainmail","circlet","clarity","claymore","cloak","lesser_crit","greater_crit","dagon","demon_edge","desolator","diffusal_blade","rapier","ancient_janggo","dust","eagle","energy_booster","ethereal_blade","cyclone","skadi","flying_courier","force_staff","gauntlets","gem","ghost","gloves","hand_of_midas","headdress","flask","heart","heavens_halberd","helm_of_iron_will","helm_of_the_dominator","hood_of_defiance","hyperstone","branches","javelin","sphere","maelstrom","magic_stick","magic_wand","manta","mantle","mask_of_madness","medallion_of_courage","mekansm","mithril_hammer","mjollnir","monkey_king_bar","lifesteal","mystic_staff","necronomicon","null_talisman","oblivion_staff","ward_observer","ogre_axe","orb_of_venom","orchid","pers","phase_boots","pipe","platemail","point_booster","poor_mans_shield","power_treads","quarterstaff","quelling_blade","radiance","reaver","refresher","ring_of_aquila","ring_of_basilius","ring_of_health","ring_of_protection","ring_of_regen","robe","rod_of_atos","relic","sobi_mask","sange","sange_and_yasha","satanic","sheepstick","ward_sentry","shadow_amulet","invis_sword","shivas_guard","basher","slippers","smoke_of_deceit","soul_booster","soul_ring","staff_of_wizardry","stout_shield","talisman_of_evasion","tango","tpscroll","tranquil_boots","ultimate_orb","urn_of_shadows","vanguard","veil_of_discord","vitality_booster","vladmir","void_stone","wraith_band","yasha","crimson_guard","enchanted_mango","lotus_orb","glimmer_cape","guardian_greaves","moon_shard","silver_edge","solar_crest","octarine_core","aether_lens","faerie_fire","iron_talon","dragon_lance","echo_sabre","infused_raindrop","blight_stone","wind_lace","tome_of_knowledge","bloodthorn","hurricane_pike"];
},{}],35:[function(require,module,exports){
'use strict';

var core = {};
core.InventoryViewModel = require("./inventory/InventoryViewModel");
core.AbilityModel = require("./AbilityModel");
core.BuffViewModel = require("./BuffViewModel");
core.HeroModel = require("./hero/HeroModel");
core.CloneModel = require("./hero/CloneModel");
core.UnitModel = require("./hero/UnitModel");
core.IllusionModel = require("./hero/IllusionModel");
core.Data = require("./data/main");
core.Util = require("./util/main");

core.init = function (HERODATA_PATH, ITEMDATA_PATH, UNITDATA_PATH, callback) {
    core.Data.init(HERODATA_PATH, ITEMDATA_PATH, UNITDATA_PATH, function () {
        core.HeroOptions = require("./hero/heroOptionsArray").init(core.Data.heroData);
        core.BuffOptions = require("./buffs/buffOptionsArray").init(core.Data.heroData, core.Data.unitData);
        core.DebuffOptions = require("./buffs/debuffOptionsArray").init(core.Data.heroData, core.Data.unitData);
        core.ItemOptions = require("./inventory/itemOptionsArray").init(core.Data.itemData);
        core.ItemBuffOptions = require("./inventory/itemBuffOptions").init(core.Data.itemData);
        core.ItemDebuffOptions = require("./inventory/itemDebuffOptions").init(core.Data.itemData);
        callback();
    });
}

module.exports = core;
},{"./AbilityModel":1,"./BuffViewModel":2,"./buffs/buffOptionsArray":4,"./buffs/debuffOptionsArray":5,"./data/main":6,"./hero/CloneModel":7,"./hero/HeroModel":10,"./hero/IllusionModel":12,"./hero/UnitModel":14,"./hero/heroOptionsArray":17,"./inventory/InventoryViewModel":26,"./inventory/itemBuffOptions":28,"./inventory/itemDebuffOptions":29,"./inventory/itemOptionsArray":30,"./util/main":40}],36:[function(require,module,exports){
var extend = function (out) {
    out = out || {};

    for (var i = 1; i < arguments.length; i++) {
        var obj = arguments[i];

        if (!obj)
            continue;

        for (var key in obj) {
            if (obj.hasOwnProperty(key)) {
                if (typeof obj[key] === 'object')
                    out[key] = extend(out[key], obj[key]);
                else
                    out[key] = obj[key];
            }
        }
    }

    return out;
};

module.exports = extend;
},{}],37:[function(require,module,exports){
var findWhere = function (arr, obj) {
    arrLoop: for (var i = 0; i < arr.length; i++) {
        objLoop: for (var key in obj) {
            if (arr[i][key] != obj[key]) {
                continue arrLoop;
            }
        }
        return arr[i];
    }
}

module.exports = findWhere;
},{}],38:[function(require,module,exports){
"use strict";

var getJSON = function (url, successCallback, errorCallback) {
    var request = new XMLHttpRequest();
    request.open('GET', url, true);

    request.onload = function() {
        if (request.status >= 200 && request.status < 400) {
            // Success!
            var data = JSON.parse(request.responseText);
            successCallback(data);
        } else {
            // We reached our target server, but it returned an error
            errorCallback();
        }
    };

    request.onerror = function() {
        // There was a connection error of some sort
        errorCallback();
    };

    request.send();
}

module.exports = getJSON;
},{}],39:[function(require,module,exports){
var isEmpty = function (obj) {
    return Object.keys(obj).length === 0 && obj.constructor === Object;
}

module.exports = isEmpty;
},{}],40:[function(require,module,exports){
'use strict';

var util = {};
util.extend = require("./extend");
util.findWhere = require("./findWhere");
util.getJSON = require("./getJSON");
util.union = require("./union");
util.uniqueId = require("./uniqueId");
util.uniques = require("./uniques");

module.exports = util;
},{"./extend":36,"./findWhere":37,"./getJSON":38,"./union":41,"./uniqueId":42,"./uniques":43}],41:[function(require,module,exports){
"use strict";
var uniques = require("./uniques");

var union = function (a, b) {
    var arr = a.concat(b);
    return uniques(arr);
}

module.exports = union;
},{"./uniques":43}],42:[function(require,module,exports){
"use strict";

var idCounter = 0;
var uniqueId = function (prefix) {
    var id = ++idCounter + '';
    return prefix ? prefix + id : id;
};

module.exports = uniqueId;
},{}],43:[function(require,module,exports){
"use strict";
var uniques = function (arr) {
    var a = [];
    for (var i=0, l=arr.length; i<l; i++)
        if (a.indexOf(arr[i]) === -1 && arr[i] !== '')
            a.push(arr[i]);
    return a;
}

module.exports = uniques;
},{}],44:[function(require,module,exports){
(function (global){
(function (factory) {
	// Module systems magic dance.

	if (typeof require === "function" && typeof exports === "object" && typeof module === "object") {
		// CommonJS or Node: hard-coded dependency on "knockout"
		factory((typeof window !== "undefined" ? window['ko'] : typeof global !== "undefined" ? global['ko'] : null), exports);
	} else if (typeof define === "function" && define["amd"]) {
		// AMD anonymous module with hard-coded dependency on "knockout"
		define(["knockout", "exports"], factory);
	} else {
		// <script> tag: use the global `ko` object, attaching a `mapping` property
		factory(ko, ko.mapping = {});
	}
}(function (ko, exports) {
	var DEBUG=true;
	var mappingProperty = "__ko_mapping__";
	var realKoDependentObservable = ko.dependentObservable;
	var mappingNesting = 0;
	var dependentObservables;
	var visitedObjects;
	var recognizedRootProperties = ["create", "update", "key", "arrayChanged"];
	var emptyReturn = {};

	var _defaultOptions = {
		include: ["_destroy"],
		ignore: [],
		copy: [],
		observe: []
	};
	var defaultOptions = _defaultOptions;

	// Author: KennyTM @ StackOverflow
	function unionArrays (x, y) {
		var obj = {};
		for (var i = x.length - 1; i >= 0; -- i) obj[x[i]] = x[i];
		for (var i = y.length - 1; i >= 0; -- i) obj[y[i]] = y[i];
		var res = [];

		for (var k in obj) {
			res.push(obj[k]);
		};

		return res;
	}

	function extendObject(destination, source) {
		var destType;

		for (var key in source) {
			if (source.hasOwnProperty(key) && source[key]) {
				destType = exports.getType(destination[key]);
				if (key && destination[key] && destType !== "array" && destType !== "string") {
					extendObject(destination[key], source[key]);
				} else {
					var bothArrays = exports.getType(destination[key]) === "array" && exports.getType(source[key]) === "array";
					if (bothArrays) {
						destination[key] = unionArrays(destination[key], source[key]);
					} else {
						destination[key] = source[key];
					}
				}
			}
		}
	}

	function merge(obj1, obj2) {
		var merged = {};
		extendObject(merged, obj1);
		extendObject(merged, obj2);

		return merged;
	}

	exports.isMapped = function (viewModel) {
		var unwrapped = ko.utils.unwrapObservable(viewModel);
		return unwrapped && unwrapped[mappingProperty];
	}

	exports.fromJS = function (jsObject /*, inputOptions, target*/ ) {
		if (arguments.length == 0) throw new Error("When calling ko.fromJS, pass the object you want to convert.");

		try {
			if (!mappingNesting++) {
				dependentObservables = [];
				visitedObjects = new objectLookup();
			}

			var options;
			var target;

			if (arguments.length == 2) {
				if (arguments[1][mappingProperty]) {
					target = arguments[1];
				} else {
					options = arguments[1];
				}
			}
			if (arguments.length == 3) {
				options = arguments[1];
				target = arguments[2];
			}

			if (target) {
				options = merge(options, target[mappingProperty]);
			}
			options = fillOptions(options);

			var result = updateViewModel(target, jsObject, options);
			if (target) {
				result = target;
			}

			// Evaluate any dependent observables that were proxied.
			// Do this after the model's observables have been created
			if (!--mappingNesting) {
				while (dependentObservables.length) {
					var DO = dependentObservables.pop();
					if (DO) {
						DO();
						
						// Move this magic property to the underlying dependent observable
						DO.__DO["throttleEvaluation"] = DO["throttleEvaluation"];
					}
				}
			}

			// Save any new mapping options in the view model, so that updateFromJS can use them later.
			result[mappingProperty] = merge(result[mappingProperty], options);

			return result;
		} catch(e) {
			mappingNesting = 0;
			throw e;
		}
	};

	exports.fromJSON = function (jsonString /*, options, target*/ ) {
		var parsed = ko.utils.parseJson(jsonString);
		arguments[0] = parsed;
		return exports.fromJS.apply(this, arguments);
	};

	exports.updateFromJS = function (viewModel) {
		throw new Error("ko.mapping.updateFromJS, use ko.mapping.fromJS instead. Please note that the order of parameters is different!");
	};

	exports.updateFromJSON = function (viewModel) {
		throw new Error("ko.mapping.updateFromJSON, use ko.mapping.fromJSON instead. Please note that the order of parameters is different!");
	};

	exports.toJS = function (rootObject, options) {
		if (!defaultOptions) exports.resetDefaultOptions();

		if (arguments.length == 0) throw new Error("When calling ko.mapping.toJS, pass the object you want to convert.");
		if (exports.getType(defaultOptions.ignore) !== "array") throw new Error("ko.mapping.defaultOptions().ignore should be an array.");
		if (exports.getType(defaultOptions.include) !== "array") throw new Error("ko.mapping.defaultOptions().include should be an array.");
		if (exports.getType(defaultOptions.copy) !== "array") throw new Error("ko.mapping.defaultOptions().copy should be an array.");

		// Merge in the options used in fromJS
		options = fillOptions(options, rootObject[mappingProperty]);

		// We just unwrap everything at every level in the object graph
		return exports.visitModel(rootObject, function (x) {
			return ko.utils.unwrapObservable(x)
		}, options);
	};

	exports.toJSON = function (rootObject, options) {
		var plainJavaScriptObject = exports.toJS(rootObject, options);
		return ko.utils.stringifyJson(plainJavaScriptObject);
	};

	exports.defaultOptions = function () {
		if (arguments.length > 0) {
			defaultOptions = arguments[0];
		} else {
			return defaultOptions;
		}
	};

	exports.resetDefaultOptions = function () {
		defaultOptions = {
			include: _defaultOptions.include.slice(0),
			ignore: _defaultOptions.ignore.slice(0),
			copy: _defaultOptions.copy.slice(0)
		};
	};

	exports.getType = function(x) {
		if ((x) && (typeof (x) === "object")) {
			if (x.constructor === Date) return "date";
			if (x.constructor === Array) return "array";
		}
		return typeof x;
	}

	function fillOptions(rawOptions, otherOptions) {
		var options = merge({}, rawOptions);

		// Move recognized root-level properties into a root namespace
		for (var i = recognizedRootProperties.length - 1; i >= 0; i--) {
			var property = recognizedRootProperties[i];
			
			// Carry on, unless this property is present
			if (!options[property]) continue;
			
			// Move the property into the root namespace
			if (!(options[""] instanceof Object)) options[""] = {};
			options[""][property] = options[property];
			delete options[property];
		}

		if (otherOptions) {
			options.ignore = mergeArrays(otherOptions.ignore, options.ignore);
			options.include = mergeArrays(otherOptions.include, options.include);
			options.copy = mergeArrays(otherOptions.copy, options.copy);
			options.observe = mergeArrays(otherOptions.observe, options.observe);
		}
		options.ignore = mergeArrays(options.ignore, defaultOptions.ignore);
		options.include = mergeArrays(options.include, defaultOptions.include);
		options.copy = mergeArrays(options.copy, defaultOptions.copy);
		options.observe = mergeArrays(options.observe, defaultOptions.observe);

		options.mappedProperties = options.mappedProperties || {};
		options.copiedProperties = options.copiedProperties || {};
		return options;
	}

	function mergeArrays(a, b) {
		if (exports.getType(a) !== "array") {
			if (exports.getType(a) === "undefined") a = [];
			else a = [a];
		}
		if (exports.getType(b) !== "array") {
			if (exports.getType(b) === "undefined") b = [];
			else b = [b];
		}

		return ko.utils.arrayGetDistinctValues(a.concat(b));
	}

	// When using a 'create' callback, we proxy the dependent observable so that it doesn't immediately evaluate on creation.
	// The reason is that the dependent observables in the user-specified callback may contain references to properties that have not been mapped yet.
	function withProxyDependentObservable(dependentObservables, callback) {
		var localDO = ko.dependentObservable;
		ko.dependentObservable = function (read, owner, options) {
			options = options || {};

			if (read && typeof read == "object") { // mirrors condition in knockout implementation of DO's
				options = read;
			}

			var realDeferEvaluation = options.deferEvaluation;

			var isRemoved = false;

			// We wrap the original dependent observable so that we can remove it from the 'dependentObservables' list we need to evaluate after mapping has
			// completed if the user already evaluated the DO themselves in the meantime.
			var wrap = function (DO) {
				// Temporarily revert ko.dependentObservable, since it is used in ko.isWriteableObservable
				var tmp = ko.dependentObservable;
				ko.dependentObservable = realKoDependentObservable;
				var isWriteable = ko.isWriteableObservable(DO);
				ko.dependentObservable = tmp;

				var wrapped = realKoDependentObservable({
					read: function () {
						if (!isRemoved) {
							ko.utils.arrayRemoveItem(dependentObservables, DO);
							isRemoved = true;
						}
						return DO.apply(DO, arguments);
					},
					write: isWriteable && function (val) {
						return DO(val);
					},
					deferEvaluation: true
				});
				if (DEBUG) wrapped._wrapper = true;
				wrapped.__DO = DO;
				return wrapped;
			};
			
			options.deferEvaluation = true; // will either set for just options, or both read/options.
			var realDependentObservable = new realKoDependentObservable(read, owner, options);

			if (!realDeferEvaluation) {
				realDependentObservable = wrap(realDependentObservable);
				dependentObservables.push(realDependentObservable);
			}

			return realDependentObservable;
		}
		ko.dependentObservable.fn = realKoDependentObservable.fn;
		ko.computed = ko.dependentObservable;
		var result = callback();
		ko.dependentObservable = localDO;
		ko.computed = ko.dependentObservable;
		return result;
	}

	function updateViewModel(mappedRootObject, rootObject, options, parentName, parent, parentPropertyName, mappedParent) {
		var isArray = exports.getType(ko.utils.unwrapObservable(rootObject)) === "array";

		parentPropertyName = parentPropertyName || "";

		// If this object was already mapped previously, take the options from there and merge them with our existing ones.
		if (exports.isMapped(mappedRootObject)) {
			var previousMapping = ko.utils.unwrapObservable(mappedRootObject)[mappingProperty];
			options = merge(previousMapping, options);
		}

		var callbackParams = {
			data: rootObject,
			parent: mappedParent || parent
		};

		var hasCreateCallback = function () {
			return options[parentName] && options[parentName].create instanceof Function;
		};

		var createCallback = function (data) {
			return withProxyDependentObservable(dependentObservables, function () {
				
				if (ko.utils.unwrapObservable(parent) instanceof Array) {
					return options[parentName].create({
						data: data || callbackParams.data,
						parent: callbackParams.parent,
						skip: emptyReturn
					});
				} else {
					return options[parentName].create({
						data: data || callbackParams.data,
						parent: callbackParams.parent
					});
				}				
			});
		};

		var hasUpdateCallback = function () {
			return options[parentName] && options[parentName].update instanceof Function;
		};

		var updateCallback = function (obj, data) {
			var params = {
				data: data || callbackParams.data,
				parent: callbackParams.parent,
				target: ko.utils.unwrapObservable(obj)
			};

			if (ko.isWriteableObservable(obj)) {
				params.observable = obj;
			}

			return options[parentName].update(params);
		}

		var alreadyMapped = visitedObjects.get(rootObject);
		if (alreadyMapped) {
			return alreadyMapped;
		}

		parentName = parentName || "";

		if (!isArray) {
			// For atomic types, do a direct update on the observable
			if (!canHaveProperties(rootObject)) {
				switch (exports.getType(rootObject)) {
				case "function":
					if (hasUpdateCallback()) {
						if (ko.isWriteableObservable(rootObject)) {
							rootObject(updateCallback(rootObject));
							mappedRootObject = rootObject;
						} else {
							mappedRootObject = updateCallback(rootObject);
						}
					} else {
						mappedRootObject = rootObject;
					}
					break;
				default:
					if (ko.isWriteableObservable(mappedRootObject)) {
						if (hasUpdateCallback()) {
							var valueToWrite = updateCallback(mappedRootObject);
							mappedRootObject(valueToWrite);
							return valueToWrite;
						} else {
							var valueToWrite = ko.utils.unwrapObservable(rootObject);
							mappedRootObject(valueToWrite);
							return valueToWrite;
						}
					} else {
						var hasCreateOrUpdateCallback = hasCreateCallback() || hasUpdateCallback();
						
						if (hasCreateCallback()) {
							mappedRootObject = createCallback();
						} else {
							mappedRootObject = ko.observable(ko.utils.unwrapObservable(rootObject));
						}

						if (hasUpdateCallback()) {
							mappedRootObject(updateCallback(mappedRootObject));
						}
						
						if (hasCreateOrUpdateCallback) return mappedRootObject;
					}
				}

			} else {
				mappedRootObject = ko.utils.unwrapObservable(mappedRootObject);
				if (!mappedRootObject) {
					if (hasCreateCallback()) {
						var result = createCallback();

						if (hasUpdateCallback()) {
							result = updateCallback(result);
						}

						return result;
					} else {
						if (hasUpdateCallback()) {
							return updateCallback(result);
						}

						mappedRootObject = {};
					}
				}

				if (hasUpdateCallback()) {
					mappedRootObject = updateCallback(mappedRootObject);
				}

				visitedObjects.save(rootObject, mappedRootObject);
				if (hasUpdateCallback()) return mappedRootObject;

				// For non-atomic types, visit all properties and update recursively
				visitPropertiesOrArrayEntries(rootObject, function (indexer) {
					var fullPropertyName = parentPropertyName.length ? parentPropertyName + "." + indexer : indexer;

					if (ko.utils.arrayIndexOf(options.ignore, fullPropertyName) != -1) {
						return;
					}

					if (ko.utils.arrayIndexOf(options.copy, fullPropertyName) != -1) {
						mappedRootObject[indexer] = rootObject[indexer];
						return;
					}

					if(typeof rootObject[indexer] != "object" && typeof rootObject[indexer] != "array" && options.observe.length > 0 && ko.utils.arrayIndexOf(options.observe, fullPropertyName) == -1)
					{
						mappedRootObject[indexer] = rootObject[indexer];
						options.copiedProperties[fullPropertyName] = true;
						return;
					}
					
					// In case we are adding an already mapped property, fill it with the previously mapped property value to prevent recursion.
					// If this is a property that was generated by fromJS, we should use the options specified there
					var prevMappedProperty = visitedObjects.get(rootObject[indexer]);
					var retval = updateViewModel(mappedRootObject[indexer], rootObject[indexer], options, indexer, mappedRootObject, fullPropertyName, mappedRootObject);
					var value = prevMappedProperty || retval;
					
					if(options.observe.length > 0 && ko.utils.arrayIndexOf(options.observe, fullPropertyName) == -1)
					{
						mappedRootObject[indexer] = value();
						options.copiedProperties[fullPropertyName] = true;
						return;
					}
					
					if (ko.isWriteableObservable(mappedRootObject[indexer])) {
						value = ko.utils.unwrapObservable(value);
						if (mappedRootObject[indexer]() !== value) {
							mappedRootObject[indexer](value);
						}
					} else {
						value = mappedRootObject[indexer] === undefined ? value : ko.utils.unwrapObservable(value);
						mappedRootObject[indexer] = value;
					}

					options.mappedProperties[fullPropertyName] = true;
				});
			}
		} else { //mappedRootObject is an array
			var changes = [];

			var hasKeyCallback = false;
			var keyCallback = function (x) {
				return x;
			}
			if (options[parentName] && options[parentName].key) {
				keyCallback = options[parentName].key;
				hasKeyCallback = true;
			}

			if (!ko.isObservable(mappedRootObject)) {
				// When creating the new observable array, also add a bunch of utility functions that take the 'key' of the array items into account.
				mappedRootObject = ko.observableArray([]);

				mappedRootObject.mappedRemove = function (valueOrPredicate) {
					var predicate = typeof valueOrPredicate == "function" ? valueOrPredicate : function (value) {
							return value === keyCallback(valueOrPredicate);
						};
					return mappedRootObject.remove(function (item) {
						return predicate(keyCallback(item));
					});
				}

				mappedRootObject.mappedRemoveAll = function (arrayOfValues) {
					var arrayOfKeys = filterArrayByKey(arrayOfValues, keyCallback);
					return mappedRootObject.remove(function (item) {
						return ko.utils.arrayIndexOf(arrayOfKeys, keyCallback(item)) != -1;
					});
				}

				mappedRootObject.mappedDestroy = function (valueOrPredicate) {
					var predicate = typeof valueOrPredicate == "function" ? valueOrPredicate : function (value) {
							return value === keyCallback(valueOrPredicate);
						};
					return mappedRootObject.destroy(function (item) {
						return predicate(keyCallback(item));
					});
				}

				mappedRootObject.mappedDestroyAll = function (arrayOfValues) {
					var arrayOfKeys = filterArrayByKey(arrayOfValues, keyCallback);
					return mappedRootObject.destroy(function (item) {
						return ko.utils.arrayIndexOf(arrayOfKeys, keyCallback(item)) != -1;
					});
				}

				mappedRootObject.mappedIndexOf = function (item) {
					var keys = filterArrayByKey(mappedRootObject(), keyCallback);
					var key = keyCallback(item);
					return ko.utils.arrayIndexOf(keys, key);
				}

				mappedRootObject.mappedGet = function (item) {
					return mappedRootObject()[mappedRootObject.mappedIndexOf(item)];
				}

				mappedRootObject.mappedCreate = function (value) {
					if (mappedRootObject.mappedIndexOf(value) !== -1) {
						throw new Error("There already is an object with the key that you specified.");
					}

					var item = hasCreateCallback() ? createCallback(value) : value;
					if (hasUpdateCallback()) {
						var newValue = updateCallback(item, value);
						if (ko.isWriteableObservable(item)) {
							item(newValue);
						} else {
							item = newValue;
						}
					}
					mappedRootObject.push(item);
					return item;
				}
			}

			var currentArrayKeys = filterArrayByKey(ko.utils.unwrapObservable(mappedRootObject), keyCallback).sort();
			var newArrayKeys = filterArrayByKey(rootObject, keyCallback);
			if (hasKeyCallback) newArrayKeys.sort();
			var editScript = ko.utils.compareArrays(currentArrayKeys, newArrayKeys);

			var ignoreIndexOf = {};
			
			var i, j;

			var unwrappedRootObject = ko.utils.unwrapObservable(rootObject);
			var itemsByKey = {};
			var optimizedKeys = true;
			for (i = 0, j = unwrappedRootObject.length; i < j; i++) {
				var key = keyCallback(unwrappedRootObject[i]);
				if (key === undefined || key instanceof Object) {
					optimizedKeys = false;
					break;
				}
				itemsByKey[key] = unwrappedRootObject[i];
			}

			var newContents = [];
			var passedOver = 0;
			for (i = 0, j = editScript.length; i < j; i++) {
				var key = editScript[i];
				var mappedItem;
				var fullPropertyName = parentPropertyName + "[" + i + "]";
				switch (key.status) {
				case "added":
					var item = optimizedKeys ? itemsByKey[key.value] : getItemByKey(ko.utils.unwrapObservable(rootObject), key.value, keyCallback);
					mappedItem = updateViewModel(undefined, item, options, parentName, mappedRootObject, fullPropertyName, parent);
					if(!hasCreateCallback()) {
						mappedItem = ko.utils.unwrapObservable(mappedItem);
					}

					var index = ignorableIndexOf(ko.utils.unwrapObservable(rootObject), item, ignoreIndexOf);
					
					if (mappedItem === emptyReturn) {
						passedOver++;
					} else {
						newContents[index - passedOver] = mappedItem;
					}
						
					ignoreIndexOf[index] = true;
					break;
				case "retained":
					var item = optimizedKeys ? itemsByKey[key.value] : getItemByKey(ko.utils.unwrapObservable(rootObject), key.value, keyCallback);
					mappedItem = getItemByKey(mappedRootObject, key.value, keyCallback);
					updateViewModel(mappedItem, item, options, parentName, mappedRootObject, fullPropertyName, parent);

					var index = ignorableIndexOf(ko.utils.unwrapObservable(rootObject), item, ignoreIndexOf);
					newContents[index] = mappedItem;
					ignoreIndexOf[index] = true;
					break;
				case "deleted":
					mappedItem = getItemByKey(mappedRootObject, key.value, keyCallback);
					break;
				}

				changes.push({
					event: key.status,
					item: mappedItem
				});
			}

			mappedRootObject(newContents);

			if (options[parentName] && options[parentName].arrayChanged) {
				ko.utils.arrayForEach(changes, function (change) {
					options[parentName].arrayChanged(change.event, change.item);
				});
			}
		}

		return mappedRootObject;
	}

	function ignorableIndexOf(array, item, ignoreIndices) {
		for (var i = 0, j = array.length; i < j; i++) {
			if (ignoreIndices[i] === true) continue;
			if (array[i] === item) return i;
		}
		return null;
	}

	function mapKey(item, callback) {
		var mappedItem;
		if (callback) mappedItem = callback(item);
		if (exports.getType(mappedItem) === "undefined") mappedItem = item;

		return ko.utils.unwrapObservable(mappedItem);
	}

	function getItemByKey(array, key, callback) {
		array = ko.utils.unwrapObservable(array);
		for (var i = 0, j = array.length; i < j; i++) {
			var item = array[i];
			if (mapKey(item, callback) === key) return item;
		}

		throw new Error("When calling ko.update*, the key '" + key + "' was not found!");
	}

	function filterArrayByKey(array, callback) {
		return ko.utils.arrayMap(ko.utils.unwrapObservable(array), function (item) {
			if (callback) {
				return mapKey(item, callback);
			} else {
				return item;
			}
		});
	}

	function visitPropertiesOrArrayEntries(rootObject, visitorCallback) {
		if (exports.getType(rootObject) === "array") {
			for (var i = 0; i < rootObject.length; i++)
			visitorCallback(i);
		} else {
			for (var propertyName in rootObject)
			visitorCallback(propertyName);
		}
	};

	function canHaveProperties(object) {
		var type = exports.getType(object);
		return ((type === "object") || (type === "array")) && (object !== null);
	}

	// Based on the parentName, this creates a fully classified name of a property

	function getPropertyName(parentName, parent, indexer) {
		var propertyName = parentName || "";
		if (exports.getType(parent) === "array") {
			if (parentName) {
				propertyName += "[" + indexer + "]";
			}
		} else {
			if (parentName) {
				propertyName += ".";
			}
			propertyName += indexer;
		}
		return propertyName;
	}

	exports.visitModel = function (rootObject, callback, options) {
		options = options || {};
		options.visitedObjects = options.visitedObjects || new objectLookup();

		var mappedRootObject;
		var unwrappedRootObject = ko.utils.unwrapObservable(rootObject);

		if (!canHaveProperties(unwrappedRootObject)) {
			return callback(rootObject, options.parentName);
		} else {
			options = fillOptions(options, unwrappedRootObject[mappingProperty]);

			// Only do a callback, but ignore the results
			callback(rootObject, options.parentName);
			mappedRootObject = exports.getType(unwrappedRootObject) === "array" ? [] : {};
		}

		options.visitedObjects.save(rootObject, mappedRootObject);

		var parentName = options.parentName;
		visitPropertiesOrArrayEntries(unwrappedRootObject, function (indexer) {
			if (options.ignore && ko.utils.arrayIndexOf(options.ignore, indexer) != -1) return;

			var propertyValue = unwrappedRootObject[indexer];
			options.parentName = getPropertyName(parentName, unwrappedRootObject, indexer);

			// If we don't want to explicitly copy the unmapped property...
			if (ko.utils.arrayIndexOf(options.copy, indexer) === -1) {
				// ...find out if it's a property we want to explicitly include
				if (ko.utils.arrayIndexOf(options.include, indexer) === -1) {
					// The mapped properties object contains all the properties that were part of the original object.
					// If a property does not exist, and it is not because it is part of an array (e.g. "myProp[3]"), then it should not be unmapped.
				    if (unwrappedRootObject[mappingProperty]
				        && unwrappedRootObject[mappingProperty].mappedProperties && !unwrappedRootObject[mappingProperty].mappedProperties[indexer]
				        && unwrappedRootObject[mappingProperty].copiedProperties && !unwrappedRootObject[mappingProperty].copiedProperties[indexer]
				        && !(exports.getType(unwrappedRootObject) === "array")) {
						return;
					}
				}
			}

			var outputProperty;
			switch (exports.getType(ko.utils.unwrapObservable(propertyValue))) {
			case "object":
			case "array":
			case "undefined":
				var previouslyMappedValue = options.visitedObjects.get(propertyValue);
				mappedRootObject[indexer] = (exports.getType(previouslyMappedValue) !== "undefined") ? previouslyMappedValue : exports.visitModel(propertyValue, callback, options);
				break;
			default:
				mappedRootObject[indexer] = callback(propertyValue, options.parentName);
			}
		});

		return mappedRootObject;
	}

	function simpleObjectLookup() {
		var keys = [];
		var values = [];
		this.save = function (key, value) {
			var existingIndex = ko.utils.arrayIndexOf(keys, key);
			if (existingIndex >= 0) values[existingIndex] = value;
			else {
				keys.push(key);
				values.push(value);
			}
		};
		this.get = function (key) {
			var existingIndex = ko.utils.arrayIndexOf(keys, key);
			var value = (existingIndex >= 0) ? values[existingIndex] : undefined;
			return value;
		};
	};
	
	function objectLookup() {
		var buckets = {};
		
		var findBucket = function(key) {
			var bucketKey;
			try {
				bucketKey = key;//JSON.stringify(key);
			}
			catch (e) {
				bucketKey = "$$$";
			}

			var bucket = buckets[bucketKey];
			if (bucket === undefined) {
				bucket = new simpleObjectLookup();
				buckets[bucketKey] = bucket;
			}
			return bucket;
		};
		
		this.save = function (key, value) {
			findBucket(key).save(key, value);
		};
		this.get = function (key) {
			return findBucket(key).get(key);
		};
	};
}));
}).call(this,typeof global !== "undefined" ? global : typeof self !== "undefined" ? self : typeof window !== "undefined" ? window : {})

},{}],45:[function(require,module,exports){
(function (global){
// Knockout Fast Mapping v0.1
// License: MIT (http://www.opensource.org/licenses/mit-license.php)

(function (factory) {
	// Module systems magic dance.

	if (typeof require === "function" && typeof exports === "object" && typeof module === "object") {
		// CommonJS or Node: hard-coded dependency on "knockout"
		factory((typeof window !== "undefined" ? window['ko'] : typeof global !== "undefined" ? global['ko'] : null), exports);
	} else if (typeof define === "function" && define["amd"]) {
		// AMD anonymous module with hard-coded dependency on "knockout"
		define(["knockout", "exports"], factory);
	} else {
		// <script> tag: use the global `ko` object, attaching a `wrap` property
		factory(ko, ko.wrap = {});
	}
}(function (ko, exports) {
    
    // this function mimics ko.mapping
    exports.fromJS = function(jsObject, computedFunctions)
    {
        reset();
	return wrap(jsObject, computedFunctions);
    }

    // this function unwraps the outer for assigning the result to an observable
    // see https://github.com/SteveSanderson/knockout/issues/517
    exports.updateFromJS = function(observable, jsObject, computedFunctions)
    {
        reset();
	return observable(ko.utils.unwrapObservable(wrap(jsObject, computedFunctions)));
    }

    exports.fromJSON = function (jsonString, computedFunctions) {
	var parsed = ko.utils.parseJson(jsonString);
	arguments[0] = parsed;
	return exports.fromJS.apply(this, computedFunctions);
    };
    
    exports.toJS = function (observable) {
	return unwrap(observable);
    }

    exports.toJSON = function (observable) {
	var plainJavaScriptObject = exports.toJS(observable);
	return ko.utils.stringifyJson(plainJavaScriptObject);
    };

    function typeOf(value) {
	var s = typeof value;
	if (s === 'object') {
            if (value) {
                if (value.constructor == Date)
                    s = 'date';
		else if (Object.prototype.toString.call(value) == '[object Array]')
                    s = 'array';
            } else {
		s = 'null';
            }
	}
	return s;
    }

    // unwrapping
    function unwrapObject(o)
    {
	var t = {};

	for (var k in o)
	{
	    var v = o[k];

	    if (ko.isComputed(v))
		continue;

	    t[k] = unwrap(v);
	}

	return t;
    }

    function unwrapArray(a)
    {
	var r = [];

	if (!a || a.length == 0)
	    return r;
	
	for (var i = 0, l = a.length; i < l; ++i)
	    r.push(unwrap(a[i]));

	return r;
    }

    function unwrap(v)
    {
	var isObservable = ko.isObservable(v);

	if (isObservable)
	{
	    var val = v();

	    return unwrap(val);
	}
	else
	{
	    if (typeOf(v) == "array")
	    {
		return unwrapArray(v);
	    }
	    else if (typeOf(v) == "object")
	    {
		return unwrapObject(v);
	    }
	    else
	    {
		return v;
	    }
	}
    }

    function reset()
    {
        parents = [{obj: null, wrapped: null, lvl: ""}];
    }    
    
    // wrapping

    function wrapObject(o, computedFunctions)
    {
        // check for infinite recursion
        for (var i = 0; i < parents.length; ++i) {
            if (parents[i].obj === o) {
                return parents[i].wrapped;
            }
        }

	var t = {};

	for (var k in o)
	{
	    var v = o[k];

            parents.push({obj: o, wrapped: t, lvl: currentLvl() + "/" + k});

	    t[k] = wrap(v, computedFunctions);

            parents.pop();
	}

	if (computedFunctions && computedFunctions[currentLvl()])
	    t = computedFunctions[currentLvl()](t);

        if (hasES5Plugin())
            ko.track(t);

	return t;
    }

    function wrapArray(a, computedFunctions)
    {
	var r = ko.observableArray();

	if (!a || a.length == 0)
	    return r;

	for (var i = 0, l = a.length; i < l; ++i)
	    r.push(wrap(a[i], computedFunctions));

	return r;
    }

    // a stack, used for two purposes:
    //  - circular reference checking
    //  - computed functions
    var parents;

    function currentLvl()
    {
	return parents[parents.length-1].lvl;
    }

    function wrap(v, computedFunctions)
    {
	if (typeOf(v) == "array")
	{
	    return wrapArray(v, computedFunctions);
	}
	else if (typeOf(v) == "object")
	{
	    return wrapObject(v, computedFunctions);
	}
	else
	{
            if (!hasES5Plugin() && typeof v !== 'function')
            {
	        var t = ko.observable();
	        t(v);
	        return t;
            } else
                return v;
	}
    }

    function hasES5Plugin()
    {
        return ko.track != null;
    }
}));
}).call(this,typeof global !== "undefined" ? global : typeof self !== "undefined" ? self : typeof window !== "undefined" ? window : {})

},{}],46:[function(require,module,exports){
/*!
 * Chart.js
 * http://chartjs.org/
 * Version: 1.1.1
 *
 * Copyright 2015 Nick Downie
 * Released under the MIT license
 * https://github.com/nnnick/Chart.js/blob/master/LICENSE.md
 */


(function(){

	"use strict";

	//Declare root variable - window in the browser, global on the server
	var root = this,
		previous = root.Chart;

	//Occupy the global variable of Chart, and create a simple base class
	var Chart = function(context){
		var chart = this;
		this.canvas = context.canvas;

		this.ctx = context;

		//Variables global to the chart
		var computeDimension = function(element,dimension)
		{
			if (element['offset'+dimension])
			{
				return element['offset'+dimension];
			}
			else
			{
				return document.defaultView.getComputedStyle(element).getPropertyValue(dimension);
			}
		};

		var width = this.width = computeDimension(context.canvas,'Width') || context.canvas.width;
		var height = this.height = computeDimension(context.canvas,'Height') || context.canvas.height;

		this.aspectRatio = this.width / this.height;
		//High pixel density displays - multiply the size of the canvas height/width by the device pixel ratio, then scale.
		helpers.retinaScale(this);

		return this;
	};
	//Globally expose the defaults to allow for user updating/changing
	Chart.defaults = {
		global: {
			// Boolean - Whether to animate the chart
			animation: true,

			// Number - Number of animation steps
			animationSteps: 60,

			// String - Animation easing effect
			animationEasing: "easeOutQuart",

			// Boolean - If we should show the scale at all
			showScale: true,

			// Boolean - If we want to override with a hard coded scale
			scaleOverride: false,

			// ** Required if scaleOverride is true **
			// Number - The number of steps in a hard coded scale
			scaleSteps: null,
			// Number - The value jump in the hard coded scale
			scaleStepWidth: null,
			// Number - The scale starting value
			scaleStartValue: null,

			// String - Colour of the scale line
			scaleLineColor: "rgba(0,0,0,.1)",

			// Number - Pixel width of the scale line
			scaleLineWidth: 1,

			// Boolean - Whether to show labels on the scale
			scaleShowLabels: true,

			// Interpolated JS string - can access value
			scaleLabel: "<%=value%>",

			// Boolean - Whether the scale should stick to integers, and not show any floats even if drawing space is there
			scaleIntegersOnly: true,

			// Boolean - Whether the scale should start at zero, or an order of magnitude down from the lowest value
			scaleBeginAtZero: false,

			// String - Scale label font declaration for the scale label
			scaleFontFamily: "'Helvetica Neue', 'Helvetica', 'Arial', sans-serif",

			// Number - Scale label font size in pixels
			scaleFontSize: 12,

			// String - Scale label font weight style
			scaleFontStyle: "normal",

			// String - Scale label font colour
			scaleFontColor: "#666",

			// Boolean - whether or not the chart should be responsive and resize when the browser does.
			responsive: false,

			// Boolean - whether to maintain the starting aspect ratio or not when responsive, if set to false, will take up entire container
			maintainAspectRatio: true,

			// Boolean - Determines whether to draw tooltips on the canvas or not - attaches events to touchmove & mousemove
			showTooltips: true,

			// Boolean - Determines whether to draw built-in tooltip or call custom tooltip function
			customTooltips: false,

			// Array - Array of string names to attach tooltip events
			tooltipEvents: ["mousemove", "touchstart", "touchmove", "mouseout"],

			// String - Tooltip background colour
			tooltipFillColor: "rgba(0,0,0,0.8)",

			// String - Tooltip label font declaration for the scale label
			tooltipFontFamily: "'Helvetica Neue', 'Helvetica', 'Arial', sans-serif",

			// Number - Tooltip label font size in pixels
			tooltipFontSize: 14,

			// String - Tooltip font weight style
			tooltipFontStyle: "normal",

			// String - Tooltip label font colour
			tooltipFontColor: "#fff",

			// String - Tooltip title font declaration for the scale label
			tooltipTitleFontFamily: "'Helvetica Neue', 'Helvetica', 'Arial', sans-serif",

			// Number - Tooltip title font size in pixels
			tooltipTitleFontSize: 14,

			// String - Tooltip title font weight style
			tooltipTitleFontStyle: "bold",

			// String - Tooltip title font colour
			tooltipTitleFontColor: "#fff",

			// String - Tooltip title template
			tooltipTitleTemplate: "<%= label%>",

			// Number - pixel width of padding around tooltip text
			tooltipYPadding: 6,

			// Number - pixel width of padding around tooltip text
			tooltipXPadding: 6,

			// Number - Size of the caret on the tooltip
			tooltipCaretSize: 8,

			// Number - Pixel radius of the tooltip border
			tooltipCornerRadius: 6,

			// Number - Pixel offset from point x to tooltip edge
			tooltipXOffset: 10,

			// String - Template string for single tooltips
			tooltipTemplate: "<%if (label){%><%=label%>: <%}%><%= value %>",

			// String - Template string for single tooltips
			multiTooltipTemplate: "<%= datasetLabel %>: <%= value %>",

			// String - Colour behind the legend colour block
			multiTooltipKeyBackground: '#fff',

			// Array - A list of colors to use as the defaults
			segmentColorDefault: ["#A6CEE3", "#1F78B4", "#B2DF8A", "#33A02C", "#FB9A99", "#E31A1C", "#FDBF6F", "#FF7F00", "#CAB2D6", "#6A3D9A", "#B4B482", "#B15928" ],

			// Array - A list of highlight colors to use as the defaults
			segmentHighlightColorDefaults: [ "#CEF6FF", "#47A0DC", "#DAFFB2", "#5BC854", "#FFC2C1", "#FF4244", "#FFE797", "#FFA728", "#F2DAFE", "#9265C2", "#DCDCAA", "#D98150" ],

			// Function - Will fire on animation progression.
			onAnimationProgress: function(){},

			// Function - Will fire on animation completion.
			onAnimationComplete: function(){}

		}
	};

	//Create a dictionary of chart types, to allow for extension of existing types
	Chart.types = {};

	//Global Chart helpers object for utility methods and classes
	var helpers = Chart.helpers = {};

		//-- Basic js utility methods
	var each = helpers.each = function(loopable,callback,self){
			var additionalArgs = Array.prototype.slice.call(arguments, 3);
			// Check to see if null or undefined firstly.
			if (loopable){
				if (loopable.length === +loopable.length){
					var i;
					for (i=0; i<loopable.length; i++){
						callback.apply(self,[loopable[i], i].concat(additionalArgs));
					}
				}
				else{
					for (var item in loopable){
						callback.apply(self,[loopable[item],item].concat(additionalArgs));
					}
				}
			}
		},
		clone = helpers.clone = function(obj){
			var objClone = {};
			each(obj,function(value,key){
				if (obj.hasOwnProperty(key)){
					objClone[key] = value;
				}
			});
			return objClone;
		},
		extend = helpers.extend = function(base){
			each(Array.prototype.slice.call(arguments,1), function(extensionObject) {
				each(extensionObject,function(value,key){
					if (extensionObject.hasOwnProperty(key)){
						base[key] = value;
					}
				});
			});
			return base;
		},
		merge = helpers.merge = function(base,master){
			//Merge properties in left object over to a shallow clone of object right.
			var args = Array.prototype.slice.call(arguments,0);
			args.unshift({});
			return extend.apply(null, args);
		},
		indexOf = helpers.indexOf = function(arrayToSearch, item){
			if (Array.prototype.indexOf) {
				return arrayToSearch.indexOf(item);
			}
			else{
				for (var i = 0; i < arrayToSearch.length; i++) {
					if (arrayToSearch[i] === item) return i;
				}
				return -1;
			}
		},
		where = helpers.where = function(collection, filterCallback){
			var filtered = [];

			helpers.each(collection, function(item){
				if (filterCallback(item)){
					filtered.push(item);
				}
			});

			return filtered;
		},
		findNextWhere = helpers.findNextWhere = function(arrayToSearch, filterCallback, startIndex){
			// Default to start of the array
			if (!startIndex){
				startIndex = -1;
			}
			for (var i = startIndex + 1; i < arrayToSearch.length; i++) {
				var currentItem = arrayToSearch[i];
				if (filterCallback(currentItem)){
					return currentItem;
				}
			}
		},
		findPreviousWhere = helpers.findPreviousWhere = function(arrayToSearch, filterCallback, startIndex){
			// Default to end of the array
			if (!startIndex){
				startIndex = arrayToSearch.length;
			}
			for (var i = startIndex - 1; i >= 0; i--) {
				var currentItem = arrayToSearch[i];
				if (filterCallback(currentItem)){
					return currentItem;
				}
			}
		},
		inherits = helpers.inherits = function(extensions){
			//Basic javascript inheritance based on the model created in Backbone.js
			var parent = this;
			var ChartElement = (extensions && extensions.hasOwnProperty("constructor")) ? extensions.constructor : function(){ return parent.apply(this, arguments); };

			var Surrogate = function(){ this.constructor = ChartElement;};
			Surrogate.prototype = parent.prototype;
			ChartElement.prototype = new Surrogate();

			ChartElement.extend = inherits;

			if (extensions) extend(ChartElement.prototype, extensions);

			ChartElement.__super__ = parent.prototype;

			return ChartElement;
		},
		noop = helpers.noop = function(){},
		uid = helpers.uid = (function(){
			var id=0;
			return function(){
				return "chart-" + id++;
			};
		})(),
		warn = helpers.warn = function(str){
			//Method for warning of errors
			if (window.console && typeof window.console.warn === "function") console.warn(str);
		},
		amd = helpers.amd = (typeof define === 'function' && define.amd),
		//-- Math methods
		isNumber = helpers.isNumber = function(n){
			return !isNaN(parseFloat(n)) && isFinite(n);
		},
		max = helpers.max = function(array){
			return Math.max.apply( Math, array );
		},
		min = helpers.min = function(array){
			return Math.min.apply( Math, array );
		},
		cap = helpers.cap = function(valueToCap,maxValue,minValue){
			if(isNumber(maxValue)) {
				if( valueToCap > maxValue ) {
					return maxValue;
				}
			}
			else if(isNumber(minValue)){
				if ( valueToCap < minValue ){
					return minValue;
				}
			}
			return valueToCap;
		},
		getDecimalPlaces = helpers.getDecimalPlaces = function(num){
			if (num%1!==0 && isNumber(num)){
				var s = num.toString();
				if(s.indexOf("e-") < 0){
					// no exponent, e.g. 0.01
					return s.split(".")[1].length;
				}
				else if(s.indexOf(".") < 0) {
					// no decimal point, e.g. 1e-9
					return parseInt(s.split("e-")[1]);
				}
				else {
					// exponent and decimal point, e.g. 1.23e-9
					var parts = s.split(".")[1].split("e-");
					return parts[0].length + parseInt(parts[1]);
				}
			}
			else {
				return 0;
			}
		},
		toRadians = helpers.radians = function(degrees){
			return degrees * (Math.PI/180);
		},
		// Gets the angle from vertical upright to the point about a centre.
		getAngleFromPoint = helpers.getAngleFromPoint = function(centrePoint, anglePoint){
			var distanceFromXCenter = anglePoint.x - centrePoint.x,
				distanceFromYCenter = anglePoint.y - centrePoint.y,
				radialDistanceFromCenter = Math.sqrt( distanceFromXCenter * distanceFromXCenter + distanceFromYCenter * distanceFromYCenter);


			var angle = Math.PI * 2 + Math.atan2(distanceFromYCenter, distanceFromXCenter);

			//If the segment is in the top left quadrant, we need to add another rotation to the angle
			if (distanceFromXCenter < 0 && distanceFromYCenter < 0){
				angle += Math.PI*2;
			}

			return {
				angle: angle,
				distance: radialDistanceFromCenter
			};
		},
		aliasPixel = helpers.aliasPixel = function(pixelWidth){
			return (pixelWidth % 2 === 0) ? 0 : 0.5;
		},
		splineCurve = helpers.splineCurve = function(FirstPoint,MiddlePoint,AfterPoint,t){
			//Props to Rob Spencer at scaled innovation for his post on splining between points
			//http://scaledinnovation.com/analytics/splines/aboutSplines.html
			var d01=Math.sqrt(Math.pow(MiddlePoint.x-FirstPoint.x,2)+Math.pow(MiddlePoint.y-FirstPoint.y,2)),
				d12=Math.sqrt(Math.pow(AfterPoint.x-MiddlePoint.x,2)+Math.pow(AfterPoint.y-MiddlePoint.y,2)),
				fa=t*d01/(d01+d12),// scaling factor for triangle Ta
				fb=t*d12/(d01+d12);
			return {
				inner : {
					x : MiddlePoint.x-fa*(AfterPoint.x-FirstPoint.x),
					y : MiddlePoint.y-fa*(AfterPoint.y-FirstPoint.y)
				},
				outer : {
					x: MiddlePoint.x+fb*(AfterPoint.x-FirstPoint.x),
					y : MiddlePoint.y+fb*(AfterPoint.y-FirstPoint.y)
				}
			};
		},
		calculateOrderOfMagnitude = helpers.calculateOrderOfMagnitude = function(val){
			return Math.floor(Math.log(val) / Math.LN10);
		},
		calculateScaleRange = helpers.calculateScaleRange = function(valuesArray, drawingSize, textSize, startFromZero, integersOnly){

			//Set a minimum step of two - a point at the top of the graph, and a point at the base
			var minSteps = 2,
				maxSteps = Math.floor(drawingSize/(textSize * 1.5)),
				skipFitting = (minSteps >= maxSteps);

			// Filter out null values since these would min() to zero
			var values = [];
			each(valuesArray, function( v ){
				v == null || values.push( v );
			});
			var minValue = min(values),
			    maxValue = max(values);

			// We need some degree of separation here to calculate the scales if all the values are the same
			// Adding/minusing 0.5 will give us a range of 1.
			if (maxValue === minValue){
				maxValue += 0.5;
				// So we don't end up with a graph with a negative start value if we've said always start from zero
				if (minValue >= 0.5 && !startFromZero){
					minValue -= 0.5;
				}
				else{
					// Make up a whole number above the values
					maxValue += 0.5;
				}
			}

			var	valueRange = Math.abs(maxValue - minValue),
				rangeOrderOfMagnitude = calculateOrderOfMagnitude(valueRange),
				graphMax = Math.ceil(maxValue / (1 * Math.pow(10, rangeOrderOfMagnitude))) * Math.pow(10, rangeOrderOfMagnitude),
				graphMin = (startFromZero) ? 0 : Math.floor(minValue / (1 * Math.pow(10, rangeOrderOfMagnitude))) * Math.pow(10, rangeOrderOfMagnitude),
				graphRange = graphMax - graphMin,
				stepValue = Math.pow(10, rangeOrderOfMagnitude),
				numberOfSteps = Math.round(graphRange / stepValue);

			//If we have more space on the graph we'll use it to give more definition to the data
			while((numberOfSteps > maxSteps || (numberOfSteps * 2) < maxSteps) && !skipFitting) {
				if(numberOfSteps > maxSteps){
					stepValue *=2;
					numberOfSteps = Math.round(graphRange/stepValue);
					// Don't ever deal with a decimal number of steps - cancel fitting and just use the minimum number of steps.
					if (numberOfSteps % 1 !== 0){
						skipFitting = true;
					}
				}
				//We can fit in double the amount of scale points on the scale
				else{
					//If user has declared ints only, and the step value isn't a decimal
					if (integersOnly && rangeOrderOfMagnitude >= 0){
						//If the user has said integers only, we need to check that making the scale more granular wouldn't make it a float
						if(stepValue/2 % 1 === 0){
							stepValue /=2;
							numberOfSteps = Math.round(graphRange/stepValue);
						}
						//If it would make it a float break out of the loop
						else{
							break;
						}
					}
					//If the scale doesn't have to be an int, make the scale more granular anyway.
					else{
						stepValue /=2;
						numberOfSteps = Math.round(graphRange/stepValue);
					}

				}
			}

			if (skipFitting){
				numberOfSteps = minSteps;
				stepValue = graphRange / numberOfSteps;
			}

			return {
				steps : numberOfSteps,
				stepValue : stepValue,
				min : graphMin,
				max	: graphMin + (numberOfSteps * stepValue)
			};

		},
		/* jshint ignore:start */
		// Blows up jshint errors based on the new Function constructor
		//Templating methods
		//Javascript micro templating by John Resig - source at http://ejohn.org/blog/javascript-micro-templating/
		template = helpers.template = function(templateString, valuesObject){

			// If templateString is function rather than string-template - call the function for valuesObject

			if(templateString instanceof Function){
			 	return templateString(valuesObject);
		 	}

			var cache = {};
			function tmpl(str, data){
				// Figure out if we're getting a template, or if we need to
				// load the template - and be sure to cache the result.
				var fn = !/\W/.test(str) ?
				cache[str] = cache[str] :

				// Generate a reusable function that will serve as a template
				// generator (and which will be cached).
				new Function("obj",
					"var p=[],print=function(){p.push.apply(p,arguments);};" +

					// Introduce the data as local variables using with(){}
					"with(obj){p.push('" +

					// Convert the template into pure JavaScript
					str
						.replace(/[\r\t\n]/g, " ")
						.split("<%").join("\t")
						.replace(/((^|%>)[^\t]*)'/g, "$1\r")
						.replace(/\t=(.*?)%>/g, "',$1,'")
						.split("\t").join("');")
						.split("%>").join("p.push('")
						.split("\r").join("\\'") +
					"');}return p.join('');"
				);

				// Provide some basic currying to the user
				return data ? fn( data ) : fn;
			}
			return tmpl(templateString,valuesObject);
		},
		/* jshint ignore:end */
		generateLabels = helpers.generateLabels = function(templateString,numberOfSteps,graphMin,stepValue){
			var labelsArray = new Array(numberOfSteps);
			if (templateString){
				each(labelsArray,function(val,index){
					labelsArray[index] = template(templateString,{value: (graphMin + (stepValue*(index+1)))});
				});
			}
			return labelsArray;
		},
		//--Animation methods
		//Easing functions adapted from Robert Penner's easing equations
		//http://www.robertpenner.com/easing/
		easingEffects = helpers.easingEffects = {
			linear: function (t) {
				return t;
			},
			easeInQuad: function (t) {
				return t * t;
			},
			easeOutQuad: function (t) {
				return -1 * t * (t - 2);
			},
			easeInOutQuad: function (t) {
				if ((t /= 1 / 2) < 1){
					return 1 / 2 * t * t;
				}
				return -1 / 2 * ((--t) * (t - 2) - 1);
			},
			easeInCubic: function (t) {
				return t * t * t;
			},
			easeOutCubic: function (t) {
				return 1 * ((t = t / 1 - 1) * t * t + 1);
			},
			easeInOutCubic: function (t) {
				if ((t /= 1 / 2) < 1){
					return 1 / 2 * t * t * t;
				}
				return 1 / 2 * ((t -= 2) * t * t + 2);
			},
			easeInQuart: function (t) {
				return t * t * t * t;
			},
			easeOutQuart: function (t) {
				return -1 * ((t = t / 1 - 1) * t * t * t - 1);
			},
			easeInOutQuart: function (t) {
				if ((t /= 1 / 2) < 1){
					return 1 / 2 * t * t * t * t;
				}
				return -1 / 2 * ((t -= 2) * t * t * t - 2);
			},
			easeInQuint: function (t) {
				return 1 * (t /= 1) * t * t * t * t;
			},
			easeOutQuint: function (t) {
				return 1 * ((t = t / 1 - 1) * t * t * t * t + 1);
			},
			easeInOutQuint: function (t) {
				if ((t /= 1 / 2) < 1){
					return 1 / 2 * t * t * t * t * t;
				}
				return 1 / 2 * ((t -= 2) * t * t * t * t + 2);
			},
			easeInSine: function (t) {
				return -1 * Math.cos(t / 1 * (Math.PI / 2)) + 1;
			},
			easeOutSine: function (t) {
				return 1 * Math.sin(t / 1 * (Math.PI / 2));
			},
			easeInOutSine: function (t) {
				return -1 / 2 * (Math.cos(Math.PI * t / 1) - 1);
			},
			easeInExpo: function (t) {
				return (t === 0) ? 1 : 1 * Math.pow(2, 10 * (t / 1 - 1));
			},
			easeOutExpo: function (t) {
				return (t === 1) ? 1 : 1 * (-Math.pow(2, -10 * t / 1) + 1);
			},
			easeInOutExpo: function (t) {
				if (t === 0){
					return 0;
				}
				if (t === 1){
					return 1;
				}
				if ((t /= 1 / 2) < 1){
					return 1 / 2 * Math.pow(2, 10 * (t - 1));
				}
				return 1 / 2 * (-Math.pow(2, -10 * --t) + 2);
			},
			easeInCirc: function (t) {
				if (t >= 1){
					return t;
				}
				return -1 * (Math.sqrt(1 - (t /= 1) * t) - 1);
			},
			easeOutCirc: function (t) {
				return 1 * Math.sqrt(1 - (t = t / 1 - 1) * t);
			},
			easeInOutCirc: function (t) {
				if ((t /= 1 / 2) < 1){
					return -1 / 2 * (Math.sqrt(1 - t * t) - 1);
				}
				return 1 / 2 * (Math.sqrt(1 - (t -= 2) * t) + 1);
			},
			easeInElastic: function (t) {
				var s = 1.70158;
				var p = 0;
				var a = 1;
				if (t === 0){
					return 0;
				}
				if ((t /= 1) == 1){
					return 1;
				}
				if (!p){
					p = 1 * 0.3;
				}
				if (a < Math.abs(1)) {
					a = 1;
					s = p / 4;
				} else{
					s = p / (2 * Math.PI) * Math.asin(1 / a);
				}
				return -(a * Math.pow(2, 10 * (t -= 1)) * Math.sin((t * 1 - s) * (2 * Math.PI) / p));
			},
			easeOutElastic: function (t) {
				var s = 1.70158;
				var p = 0;
				var a = 1;
				if (t === 0){
					return 0;
				}
				if ((t /= 1) == 1){
					return 1;
				}
				if (!p){
					p = 1 * 0.3;
				}
				if (a < Math.abs(1)) {
					a = 1;
					s = p / 4;
				} else{
					s = p / (2 * Math.PI) * Math.asin(1 / a);
				}
				return a * Math.pow(2, -10 * t) * Math.sin((t * 1 - s) * (2 * Math.PI) / p) + 1;
			},
			easeInOutElastic: function (t) {
				var s = 1.70158;
				var p = 0;
				var a = 1;
				if (t === 0){
					return 0;
				}
				if ((t /= 1 / 2) == 2){
					return 1;
				}
				if (!p){
					p = 1 * (0.3 * 1.5);
				}
				if (a < Math.abs(1)) {
					a = 1;
					s = p / 4;
				} else {
					s = p / (2 * Math.PI) * Math.asin(1 / a);
				}
				if (t < 1){
					return -0.5 * (a * Math.pow(2, 10 * (t -= 1)) * Math.sin((t * 1 - s) * (2 * Math.PI) / p));}
				return a * Math.pow(2, -10 * (t -= 1)) * Math.sin((t * 1 - s) * (2 * Math.PI) / p) * 0.5 + 1;
			},
			easeInBack: function (t) {
				var s = 1.70158;
				return 1 * (t /= 1) * t * ((s + 1) * t - s);
			},
			easeOutBack: function (t) {
				var s = 1.70158;
				return 1 * ((t = t / 1 - 1) * t * ((s + 1) * t + s) + 1);
			},
			easeInOutBack: function (t) {
				var s = 1.70158;
				if ((t /= 1 / 2) < 1){
					return 1 / 2 * (t * t * (((s *= (1.525)) + 1) * t - s));
				}
				return 1 / 2 * ((t -= 2) * t * (((s *= (1.525)) + 1) * t + s) + 2);
			},
			easeInBounce: function (t) {
				return 1 - easingEffects.easeOutBounce(1 - t);
			},
			easeOutBounce: function (t) {
				if ((t /= 1) < (1 / 2.75)) {
					return 1 * (7.5625 * t * t);
				} else if (t < (2 / 2.75)) {
					return 1 * (7.5625 * (t -= (1.5 / 2.75)) * t + 0.75);
				} else if (t < (2.5 / 2.75)) {
					return 1 * (7.5625 * (t -= (2.25 / 2.75)) * t + 0.9375);
				} else {
					return 1 * (7.5625 * (t -= (2.625 / 2.75)) * t + 0.984375);
				}
			},
			easeInOutBounce: function (t) {
				if (t < 1 / 2){
					return easingEffects.easeInBounce(t * 2) * 0.5;
				}
				return easingEffects.easeOutBounce(t * 2 - 1) * 0.5 + 1 * 0.5;
			}
		},
		//Request animation polyfill - http://www.paulirish.com/2011/requestanimationframe-for-smart-animating/
		requestAnimFrame = helpers.requestAnimFrame = (function(){
			return window.requestAnimationFrame ||
				window.webkitRequestAnimationFrame ||
				window.mozRequestAnimationFrame ||
				window.oRequestAnimationFrame ||
				window.msRequestAnimationFrame ||
				function(callback) {
					return window.setTimeout(callback, 1000 / 60);
				};
		})(),
		cancelAnimFrame = helpers.cancelAnimFrame = (function(){
			return window.cancelAnimationFrame ||
				window.webkitCancelAnimationFrame ||
				window.mozCancelAnimationFrame ||
				window.oCancelAnimationFrame ||
				window.msCancelAnimationFrame ||
				function(callback) {
					return window.clearTimeout(callback, 1000 / 60);
				};
		})(),
		animationLoop = helpers.animationLoop = function(callback,totalSteps,easingString,onProgress,onComplete,chartInstance){

			var currentStep = 0,
				easingFunction = easingEffects[easingString] || easingEffects.linear;

			var animationFrame = function(){
				currentStep++;
				var stepDecimal = currentStep/totalSteps;
				var easeDecimal = easingFunction(stepDecimal);

				callback.call(chartInstance,easeDecimal,stepDecimal, currentStep);
				onProgress.call(chartInstance,easeDecimal,stepDecimal);
				if (currentStep < totalSteps){
					chartInstance.animationFrame = requestAnimFrame(animationFrame);
				} else{
					onComplete.apply(chartInstance);
				}
			};
			requestAnimFrame(animationFrame);
		},
		//-- DOM methods
		getRelativePosition = helpers.getRelativePosition = function(evt){
			var mouseX, mouseY;
			var e = evt.originalEvent || evt,
				canvas = evt.currentTarget || evt.srcElement,
				boundingRect = canvas.getBoundingClientRect();

			if (e.touches){
				mouseX = e.touches[0].clientX - boundingRect.left;
				mouseY = e.touches[0].clientY - boundingRect.top;

			}
			else{
				mouseX = e.clientX - boundingRect.left;
				mouseY = e.clientY - boundingRect.top;
			}

			return {
				x : mouseX,
				y : mouseY
			};

		},
		addEvent = helpers.addEvent = function(node,eventType,method){
			if (node.addEventListener){
				node.addEventListener(eventType,method);
			} else if (node.attachEvent){
				node.attachEvent("on"+eventType, method);
			} else {
				node["on"+eventType] = method;
			}
		},
		removeEvent = helpers.removeEvent = function(node, eventType, handler){
			if (node.removeEventListener){
				node.removeEventListener(eventType, handler, false);
			} else if (node.detachEvent){
				node.detachEvent("on"+eventType,handler);
			} else{
				node["on" + eventType] = noop;
			}
		},
		bindEvents = helpers.bindEvents = function(chartInstance, arrayOfEvents, handler){
			// Create the events object if it's not already present
			if (!chartInstance.events) chartInstance.events = {};

			each(arrayOfEvents,function(eventName){
				chartInstance.events[eventName] = function(){
					handler.apply(chartInstance, arguments);
				};
				addEvent(chartInstance.chart.canvas,eventName,chartInstance.events[eventName]);
			});
		},
		unbindEvents = helpers.unbindEvents = function (chartInstance, arrayOfEvents) {
			each(arrayOfEvents, function(handler,eventName){
				removeEvent(chartInstance.chart.canvas, eventName, handler);
			});
		},
		getMaximumWidth = helpers.getMaximumWidth = function(domNode){
			var container = domNode.parentNode,
			    padding = parseInt(getStyle(container, 'padding-left')) + parseInt(getStyle(container, 'padding-right'));
			// TODO = check cross browser stuff with this.
			return container ? container.clientWidth - padding : 0;
		},
		getMaximumHeight = helpers.getMaximumHeight = function(domNode){
			var container = domNode.parentNode,
			    padding = parseInt(getStyle(container, 'padding-bottom')) + parseInt(getStyle(container, 'padding-top'));
			// TODO = check cross browser stuff with this.
			return container ? container.clientHeight - padding : 0;
		},
		getStyle = helpers.getStyle = function (el, property) {
			return el.currentStyle ?
				el.currentStyle[property] :
				document.defaultView.getComputedStyle(el, null).getPropertyValue(property);
		},
		getMaximumSize = helpers.getMaximumSize = helpers.getMaximumWidth, // legacy support
		retinaScale = helpers.retinaScale = function(chart){
			var ctx = chart.ctx,
				width = chart.canvas.width,
				height = chart.canvas.height;

			if (window.devicePixelRatio) {
				ctx.canvas.style.width = width + "px";
				ctx.canvas.style.height = height + "px";
				ctx.canvas.height = height * window.devicePixelRatio;
				ctx.canvas.width = width * window.devicePixelRatio;
				ctx.scale(window.devicePixelRatio, window.devicePixelRatio);
			}
		},
		//-- Canvas methods
		clear = helpers.clear = function(chart){
			chart.ctx.clearRect(0,0,chart.width,chart.height);
		},
		fontString = helpers.fontString = function(pixelSize,fontStyle,fontFamily){
			return fontStyle + " " + pixelSize+"px " + fontFamily;
		},
		longestText = helpers.longestText = function(ctx,font,arrayOfStrings){
			ctx.font = font;
			var longest = 0;
			each(arrayOfStrings,function(string){
				var textWidth = ctx.measureText(string).width;
				longest = (textWidth > longest) ? textWidth : longest;
			});
			return longest;
		},
		drawRoundedRectangle = helpers.drawRoundedRectangle = function(ctx,x,y,width,height,radius){
			ctx.beginPath();
			ctx.moveTo(x + radius, y);
			ctx.lineTo(x + width - radius, y);
			ctx.quadraticCurveTo(x + width, y, x + width, y + radius);
			ctx.lineTo(x + width, y + height - radius);
			ctx.quadraticCurveTo(x + width, y + height, x + width - radius, y + height);
			ctx.lineTo(x + radius, y + height);
			ctx.quadraticCurveTo(x, y + height, x, y + height - radius);
			ctx.lineTo(x, y + radius);
			ctx.quadraticCurveTo(x, y, x + radius, y);
			ctx.closePath();
		};


	//Store a reference to each instance - allowing us to globally resize chart instances on window resize.
	//Destroy method on the chart will remove the instance of the chart from this reference.
	Chart.instances = {};

	Chart.Type = function(data,options,chart){
		this.options = options;
		this.chart = chart;
		this.id = uid();
		//Add the chart instance to the global namespace
		Chart.instances[this.id] = this;

		// Initialize is always called when a chart type is created
		// By default it is a no op, but it should be extended
		if (options.responsive){
			this.resize();
		}
		this.initialize.call(this,data);
	};

	//Core methods that'll be a part of every chart type
	extend(Chart.Type.prototype,{
		initialize : function(){return this;},
		clear : function(){
			clear(this.chart);
			return this;
		},
		stop : function(){
			// Stops any current animation loop occuring
			Chart.animationService.cancelAnimation(this);
			return this;
		},
		resize : function(callback){
			this.stop();
			var canvas = this.chart.canvas,
				newWidth = getMaximumWidth(this.chart.canvas),
				newHeight = this.options.maintainAspectRatio ? newWidth / this.chart.aspectRatio : getMaximumHeight(this.chart.canvas);

			canvas.width = this.chart.width = newWidth;
			canvas.height = this.chart.height = newHeight;

			retinaScale(this.chart);

			if (typeof callback === "function"){
				callback.apply(this, Array.prototype.slice.call(arguments, 1));
			}
			return this;
		},
		reflow : noop,
		render : function(reflow){
			if (reflow){
				this.reflow();
			}
			
			if (this.options.animation && !reflow){
				var animation = new Chart.Animation();
				animation.numSteps = this.options.animationSteps;
				animation.easing = this.options.animationEasing;
				
				// render function
				animation.render = function(chartInstance, animationObject) {
					var easingFunction = helpers.easingEffects[animationObject.easing];
					var stepDecimal = animationObject.currentStep / animationObject.numSteps;
					var easeDecimal = easingFunction(stepDecimal);
					
					chartInstance.draw(easeDecimal, stepDecimal, animationObject.currentStep);
				};
				
				// user events
				animation.onAnimationProgress = this.options.onAnimationProgress;
				animation.onAnimationComplete = this.options.onAnimationComplete;
				
				Chart.animationService.addAnimation(this, animation);
			}
			else{
				this.draw();
				this.options.onAnimationComplete.call(this);
			}
			return this;
		},
		generateLegend : function(){
			return helpers.template(this.options.legendTemplate, this);
		},
		destroy : function(){
			this.stop();
			this.clear();
			unbindEvents(this, this.events);
			var canvas = this.chart.canvas;

			// Reset canvas height/width attributes starts a fresh with the canvas context
			canvas.width = this.chart.width;
			canvas.height = this.chart.height;

			// < IE9 doesn't support removeProperty
			if (canvas.style.removeProperty) {
				canvas.style.removeProperty('width');
				canvas.style.removeProperty('height');
			} else {
				canvas.style.removeAttribute('width');
				canvas.style.removeAttribute('height');
			}

			delete Chart.instances[this.id];
		},
		showTooltip : function(ChartElements, forceRedraw){
			// Only redraw the chart if we've actually changed what we're hovering on.
			if (typeof this.activeElements === 'undefined') this.activeElements = [];

			var isChanged = (function(Elements){
				var changed = false;

				if (Elements.length !== this.activeElements.length){
					changed = true;
					return changed;
				}

				each(Elements, function(element, index){
					if (element !== this.activeElements[index]){
						changed = true;
					}
				}, this);
				return changed;
			}).call(this, ChartElements);

			if (!isChanged && !forceRedraw){
				return;
			}
			else{
				this.activeElements = ChartElements;
			}
			this.draw();
			if(this.options.customTooltips){
				this.options.customTooltips(false);
			}
			if (ChartElements.length > 0){
				// If we have multiple datasets, show a MultiTooltip for all of the data points at that index
				if (this.datasets && this.datasets.length > 1) {
					var dataArray,
						dataIndex;

					for (var i = this.datasets.length - 1; i >= 0; i--) {
						dataArray = this.datasets[i].points || this.datasets[i].bars || this.datasets[i].segments;
						dataIndex = indexOf(dataArray, ChartElements[0]);
						if (dataIndex !== -1){
							break;
						}
					}
					var tooltipLabels = [],
						tooltipColors = [],
						medianPosition = (function(index) {

							// Get all the points at that particular index
							var Elements = [],
								dataCollection,
								xPositions = [],
								yPositions = [],
								xMax,
								yMax,
								xMin,
								yMin;
							helpers.each(this.datasets, function(dataset){
								dataCollection = dataset.points || dataset.bars || dataset.segments;
								if (dataCollection[dataIndex] && dataCollection[dataIndex].hasValue()){
									Elements.push(dataCollection[dataIndex]);
								}
							});

							helpers.each(Elements, function(element) {
								xPositions.push(element.x);
								yPositions.push(element.y);


								//Include any colour information about the element
								tooltipLabels.push(helpers.template(this.options.multiTooltipTemplate, element));
								tooltipColors.push({
									fill: element._saved.fillColor || element.fillColor,
									stroke: element._saved.strokeColor || element.strokeColor
								});

							}, this);

							yMin = min(yPositions);
							yMax = max(yPositions);

							xMin = min(xPositions);
							xMax = max(xPositions);

							return {
								x: (xMin > this.chart.width/2) ? xMin : xMax,
								y: (yMin + yMax)/2
							};
						}).call(this, dataIndex);

					new Chart.MultiTooltip({
						x: medianPosition.x,
						y: medianPosition.y,
						xPadding: this.options.tooltipXPadding,
						yPadding: this.options.tooltipYPadding,
						xOffset: this.options.tooltipXOffset,
						fillColor: this.options.tooltipFillColor,
						textColor: this.options.tooltipFontColor,
						fontFamily: this.options.tooltipFontFamily,
						fontStyle: this.options.tooltipFontStyle,
						fontSize: this.options.tooltipFontSize,
						titleTextColor: this.options.tooltipTitleFontColor,
						titleFontFamily: this.options.tooltipTitleFontFamily,
						titleFontStyle: this.options.tooltipTitleFontStyle,
						titleFontSize: this.options.tooltipTitleFontSize,
						cornerRadius: this.options.tooltipCornerRadius,
						labels: tooltipLabels,
						legendColors: tooltipColors,
						legendColorBackground : this.options.multiTooltipKeyBackground,
						title: template(this.options.tooltipTitleTemplate,ChartElements[0]),
						chart: this.chart,
						ctx: this.chart.ctx,
						custom: this.options.customTooltips
					}).draw();

				} else {
					each(ChartElements, function(Element) {
						var tooltipPosition = Element.tooltipPosition();
						new Chart.Tooltip({
							x: Math.round(tooltipPosition.x),
							y: Math.round(tooltipPosition.y),
							xPadding: this.options.tooltipXPadding,
							yPadding: this.options.tooltipYPadding,
							fillColor: this.options.tooltipFillColor,
							textColor: this.options.tooltipFontColor,
							fontFamily: this.options.tooltipFontFamily,
							fontStyle: this.options.tooltipFontStyle,
							fontSize: this.options.tooltipFontSize,
							caretHeight: this.options.tooltipCaretSize,
							cornerRadius: this.options.tooltipCornerRadius,
							text: template(this.options.tooltipTemplate, Element),
							chart: this.chart,
							custom: this.options.customTooltips
						}).draw();
					}, this);
				}
			}
			return this;
		},
		toBase64Image : function(){
			return this.chart.canvas.toDataURL.apply(this.chart.canvas, arguments);
		}
	});

	Chart.Type.extend = function(extensions){

		var parent = this;

		var ChartType = function(){
			return parent.apply(this,arguments);
		};

		//Copy the prototype object of the this class
		ChartType.prototype = clone(parent.prototype);
		//Now overwrite some of the properties in the base class with the new extensions
		extend(ChartType.prototype, extensions);

		ChartType.extend = Chart.Type.extend;

		if (extensions.name || parent.prototype.name){

			var chartName = extensions.name || parent.prototype.name;
			//Assign any potential default values of the new chart type

			//If none are defined, we'll use a clone of the chart type this is being extended from.
			//I.e. if we extend a line chart, we'll use the defaults from the line chart if our new chart
			//doesn't define some defaults of their own.

			var baseDefaults = (Chart.defaults[parent.prototype.name]) ? clone(Chart.defaults[parent.prototype.name]) : {};

			Chart.defaults[chartName] = extend(baseDefaults,extensions.defaults);

			Chart.types[chartName] = ChartType;

			//Register this new chart type in the Chart prototype
			Chart.prototype[chartName] = function(data,options){
				var config = merge(Chart.defaults.global, Chart.defaults[chartName], options || {});
				return new ChartType(data,config,this);
			};
		} else{
			warn("Name not provided for this chart, so it hasn't been registered");
		}
		return parent;
	};

	Chart.Element = function(configuration){
		extend(this,configuration);
		this.initialize.apply(this,arguments);
		this.save();
	};
	extend(Chart.Element.prototype,{
		initialize : function(){},
		restore : function(props){
			if (!props){
				extend(this,this._saved);
			} else {
				each(props,function(key){
					this[key] = this._saved[key];
				},this);
			}
			return this;
		},
		save : function(){
			this._saved = clone(this);
			delete this._saved._saved;
			return this;
		},
		update : function(newProps){
			each(newProps,function(value,key){
				this._saved[key] = this[key];
				this[key] = value;
			},this);
			return this;
		},
		transition : function(props,ease){
			each(props,function(value,key){
				this[key] = ((value - this._saved[key]) * ease) + this._saved[key];
			},this);
			return this;
		},
		tooltipPosition : function(){
			return {
				x : this.x,
				y : this.y
			};
		},
		hasValue: function(){
			return isNumber(this.value);
		}
	});

	Chart.Element.extend = inherits;


	Chart.Point = Chart.Element.extend({
		display: true,
		inRange: function(chartX,chartY){
			var hitDetectionRange = this.hitDetectionRadius + this.radius;
			return ((Math.pow(chartX-this.x, 2)+Math.pow(chartY-this.y, 2)) < Math.pow(hitDetectionRange,2));
		},
		draw : function(){
			if (this.display){
				var ctx = this.ctx;
				ctx.beginPath();

				ctx.arc(this.x, this.y, this.radius, 0, Math.PI*2);
				ctx.closePath();

				ctx.strokeStyle = this.strokeColor;
				ctx.lineWidth = this.strokeWidth;

				ctx.fillStyle = this.fillColor;

				ctx.fill();
				ctx.stroke();
			}


			//Quick debug for bezier curve splining
			//Highlights control points and the line between them.
			//Handy for dev - stripped in the min version.

			// ctx.save();
			// ctx.fillStyle = "black";
			// ctx.strokeStyle = "black"
			// ctx.beginPath();
			// ctx.arc(this.controlPoints.inner.x,this.controlPoints.inner.y, 2, 0, Math.PI*2);
			// ctx.fill();

			// ctx.beginPath();
			// ctx.arc(this.controlPoints.outer.x,this.controlPoints.outer.y, 2, 0, Math.PI*2);
			// ctx.fill();

			// ctx.moveTo(this.controlPoints.inner.x,this.controlPoints.inner.y);
			// ctx.lineTo(this.x, this.y);
			// ctx.lineTo(this.controlPoints.outer.x,this.controlPoints.outer.y);
			// ctx.stroke();

			// ctx.restore();



		}
	});

	Chart.Arc = Chart.Element.extend({
		inRange : function(chartX,chartY){

			var pointRelativePosition = helpers.getAngleFromPoint(this, {
				x: chartX,
				y: chartY
			});

			// Normalize all angles to 0 - 2*PI (0 - 360)
			var pointRelativeAngle = pointRelativePosition.angle % (Math.PI * 2),
			    startAngle = (Math.PI * 2 + this.startAngle) % (Math.PI * 2),
			    endAngle = (Math.PI * 2 + this.endAngle) % (Math.PI * 2) || 360;

			// Calculate wether the pointRelativeAngle is between the start and the end angle
			var betweenAngles = (endAngle < startAngle) ?
				pointRelativeAngle <= endAngle || pointRelativeAngle >= startAngle:
				pointRelativeAngle >= startAngle && pointRelativeAngle <= endAngle;

			//Check if within the range of the open/close angle
			var withinRadius = (pointRelativePosition.distance >= this.innerRadius && pointRelativePosition.distance <= this.outerRadius);

			return (betweenAngles && withinRadius);
			//Ensure within the outside of the arc centre, but inside arc outer
		},
		tooltipPosition : function(){
			var centreAngle = this.startAngle + ((this.endAngle - this.startAngle) / 2),
				rangeFromCentre = (this.outerRadius - this.innerRadius) / 2 + this.innerRadius;
			return {
				x : this.x + (Math.cos(centreAngle) * rangeFromCentre),
				y : this.y + (Math.sin(centreAngle) * rangeFromCentre)
			};
		},
		draw : function(animationPercent){

			var easingDecimal = animationPercent || 1;

			var ctx = this.ctx;

			ctx.beginPath();

			ctx.arc(this.x, this.y, this.outerRadius < 0 ? 0 : this.outerRadius, this.startAngle, this.endAngle);

            ctx.arc(this.x, this.y, this.innerRadius < 0 ? 0 : this.innerRadius, this.endAngle, this.startAngle, true);

			ctx.closePath();
			ctx.strokeStyle = this.strokeColor;
			ctx.lineWidth = this.strokeWidth;

			ctx.fillStyle = this.fillColor;

			ctx.fill();
			ctx.lineJoin = 'bevel';

			if (this.showStroke){
				ctx.stroke();
			}
		}
	});

	Chart.Rectangle = Chart.Element.extend({
		draw : function(){
			var ctx = this.ctx,
				halfWidth = this.width/2,
				leftX = this.x - halfWidth,
				rightX = this.x + halfWidth,
				top = this.base - (this.base - this.y),
				halfStroke = this.strokeWidth / 2;

			// Canvas doesn't allow us to stroke inside the width so we can
			// adjust the sizes to fit if we're setting a stroke on the line
			if (this.showStroke){
				leftX += halfStroke;
				rightX -= halfStroke;
				top += halfStroke;
			}

			ctx.beginPath();

			ctx.fillStyle = this.fillColor;
			ctx.strokeStyle = this.strokeColor;
			ctx.lineWidth = this.strokeWidth;

			// It'd be nice to keep this class totally generic to any rectangle
			// and simply specify which border to miss out.
			ctx.moveTo(leftX, this.base);
			ctx.lineTo(leftX, top);
			ctx.lineTo(rightX, top);
			ctx.lineTo(rightX, this.base);
			ctx.fill();
			if (this.showStroke){
				ctx.stroke();
			}
		},
		height : function(){
			return this.base - this.y;
		},
		inRange : function(chartX,chartY){
			return (chartX >= this.x - this.width/2 && chartX <= this.x + this.width/2) && (chartY >= this.y && chartY <= this.base);
		}
	});

	Chart.Animation = Chart.Element.extend({
		currentStep: null, // the current animation step
		numSteps: 60, // default number of steps
		easing: "", // the easing to use for this animation
		render: null, // render function used by the animation service
		
		onAnimationProgress: null, // user specified callback to fire on each step of the animation 
		onAnimationComplete: null, // user specified callback to fire when the animation finishes
	});
	
	Chart.Tooltip = Chart.Element.extend({
		draw : function(){

			var ctx = this.chart.ctx;

			ctx.font = fontString(this.fontSize,this.fontStyle,this.fontFamily);

			this.xAlign = "center";
			this.yAlign = "above";

			//Distance between the actual element.y position and the start of the tooltip caret
			var caretPadding = this.caretPadding = 2;

			var tooltipWidth = ctx.measureText(this.text).width + 2*this.xPadding,
				tooltipRectHeight = this.fontSize + 2*this.yPadding,
				tooltipHeight = tooltipRectHeight + this.caretHeight + caretPadding;

			if (this.x + tooltipWidth/2 >this.chart.width){
				this.xAlign = "left";
			} else if (this.x - tooltipWidth/2 < 0){
				this.xAlign = "right";
			}

			if (this.y - tooltipHeight < 0){
				this.yAlign = "below";
			}


			var tooltipX = this.x - tooltipWidth/2,
				tooltipY = this.y - tooltipHeight;

			ctx.fillStyle = this.fillColor;

			// Custom Tooltips
			if(this.custom){
				this.custom(this);
			}
			else{
				switch(this.yAlign)
				{
				case "above":
					//Draw a caret above the x/y
					ctx.beginPath();
					ctx.moveTo(this.x,this.y - caretPadding);
					ctx.lineTo(this.x + this.caretHeight, this.y - (caretPadding + this.caretHeight));
					ctx.lineTo(this.x - this.caretHeight, this.y - (caretPadding + this.caretHeight));
					ctx.closePath();
					ctx.fill();
					break;
				case "below":
					tooltipY = this.y + caretPadding + this.caretHeight;
					//Draw a caret below the x/y
					ctx.beginPath();
					ctx.moveTo(this.x, this.y + caretPadding);
					ctx.lineTo(this.x + this.caretHeight, this.y + caretPadding + this.caretHeight);
					ctx.lineTo(this.x - this.caretHeight, this.y + caretPadding + this.caretHeight);
					ctx.closePath();
					ctx.fill();
					break;
				}

				switch(this.xAlign)
				{
				case "left":
					tooltipX = this.x - tooltipWidth + (this.cornerRadius + this.caretHeight);
					break;
				case "right":
					tooltipX = this.x - (this.cornerRadius + this.caretHeight);
					break;
				}

				drawRoundedRectangle(ctx,tooltipX,tooltipY,tooltipWidth,tooltipRectHeight,this.cornerRadius);

				ctx.fill();

				ctx.fillStyle = this.textColor;
				ctx.textAlign = "center";
				ctx.textBaseline = "middle";
				ctx.fillText(this.text, tooltipX + tooltipWidth/2, tooltipY + tooltipRectHeight/2);
			}
		}
	});

	Chart.MultiTooltip = Chart.Element.extend({
		initialize : function(){
			this.font = fontString(this.fontSize,this.fontStyle,this.fontFamily);

			this.titleFont = fontString(this.titleFontSize,this.titleFontStyle,this.titleFontFamily);

			this.titleHeight = this.title ? this.titleFontSize * 1.5 : 0;
			this.height = (this.labels.length * this.fontSize) + ((this.labels.length-1) * (this.fontSize/2)) + (this.yPadding*2) + this.titleHeight;

			this.ctx.font = this.titleFont;

			var titleWidth = this.ctx.measureText(this.title).width,
				//Label has a legend square as well so account for this.
				labelWidth = longestText(this.ctx,this.font,this.labels) + this.fontSize + 3,
				longestTextWidth = max([labelWidth,titleWidth]);

			this.width = longestTextWidth + (this.xPadding*2);


			var halfHeight = this.height/2;

			//Check to ensure the height will fit on the canvas
			if (this.y - halfHeight < 0 ){
				this.y = halfHeight;
			} else if (this.y + halfHeight > this.chart.height){
				this.y = this.chart.height - halfHeight;
			}

			//Decide whether to align left or right based on position on canvas
			if (this.x > this.chart.width/2){
				this.x -= this.xOffset + this.width;
			} else {
				this.x += this.xOffset;
			}


		},
		getLineHeight : function(index){
			var baseLineHeight = this.y - (this.height/2) + this.yPadding,
				afterTitleIndex = index-1;

			//If the index is zero, we're getting the title
			if (index === 0){
				return baseLineHeight + this.titleHeight / 3;
			} else{
				return baseLineHeight + ((this.fontSize * 1.5 * afterTitleIndex) + this.fontSize / 2) + this.titleHeight;
			}

		},
		draw : function(){
			// Custom Tooltips
			if(this.custom){
				this.custom(this);
			}
			else{
				drawRoundedRectangle(this.ctx,this.x,this.y - this.height/2,this.width,this.height,this.cornerRadius);
				var ctx = this.ctx;
				ctx.fillStyle = this.fillColor;
				ctx.fill();
				ctx.closePath();

				ctx.textAlign = "left";
				ctx.textBaseline = "middle";
				ctx.fillStyle = this.titleTextColor;
				ctx.font = this.titleFont;

				ctx.fillText(this.title,this.x + this.xPadding, this.getLineHeight(0));

				ctx.font = this.font;
				helpers.each(this.labels,function(label,index){
					ctx.fillStyle = this.textColor;
					ctx.fillText(label,this.x + this.xPadding + this.fontSize + 3, this.getLineHeight(index + 1));

					//A bit gnarly, but clearing this rectangle breaks when using explorercanvas (clears whole canvas)
					//ctx.clearRect(this.x + this.xPadding, this.getLineHeight(index + 1) - this.fontSize/2, this.fontSize, this.fontSize);
					//Instead we'll make a white filled block to put the legendColour palette over.

					ctx.fillStyle = this.legendColorBackground;
					ctx.fillRect(this.x + this.xPadding, this.getLineHeight(index + 1) - this.fontSize/2, this.fontSize, this.fontSize);

					ctx.fillStyle = this.legendColors[index].fill;
					ctx.fillRect(this.x + this.xPadding, this.getLineHeight(index + 1) - this.fontSize/2, this.fontSize, this.fontSize);


				},this);
			}
		}
	});

	Chart.Scale = Chart.Element.extend({
		initialize : function(){
			this.fit();
		},
		buildYLabels : function(){
			this.yLabels = [];

			var stepDecimalPlaces = getDecimalPlaces(this.stepValue);

			for (var i=0; i<=this.steps; i++){
				this.yLabels.push(template(this.templateString,{value:(this.min + (i * this.stepValue)).toFixed(stepDecimalPlaces)}));
			}
			this.yLabelWidth = (this.display && this.showLabels) ? longestText(this.ctx,this.font,this.yLabels) + 10 : 0;
		},
		addXLabel : function(label){
			this.xLabels.push(label);
			this.valuesCount++;
			this.fit();
		},
		removeXLabel : function(){
			this.xLabels.shift();
			this.valuesCount--;
			this.fit();
		},
		// Fitting loop to rotate x Labels and figure out what fits there, and also calculate how many Y steps to use
		fit: function(){
			// First we need the width of the yLabels, assuming the xLabels aren't rotated

			// To do that we need the base line at the top and base of the chart, assuming there is no x label rotation
			this.startPoint = (this.display) ? this.fontSize : 0;
			this.endPoint = (this.display) ? this.height - (this.fontSize * 1.5) - 5 : this.height; // -5 to pad labels

			// Apply padding settings to the start and end point.
			this.startPoint += this.padding;
			this.endPoint -= this.padding;

			// Cache the starting endpoint, excluding the space for x labels
			var cachedEndPoint = this.endPoint;

			// Cache the starting height, so can determine if we need to recalculate the scale yAxis
			var cachedHeight = this.endPoint - this.startPoint,
				cachedYLabelWidth;

			// Build the current yLabels so we have an idea of what size they'll be to start
			/*
			 *	This sets what is returned from calculateScaleRange as static properties of this class:
			 *
				this.steps;
				this.stepValue;
				this.min;
				this.max;
			 *
			 */
			this.calculateYRange(cachedHeight);

			// With these properties set we can now build the array of yLabels
			// and also the width of the largest yLabel
			this.buildYLabels();

			this.calculateXLabelRotation();

			while((cachedHeight > this.endPoint - this.startPoint)){
				cachedHeight = this.endPoint - this.startPoint;
				cachedYLabelWidth = this.yLabelWidth;

				this.calculateYRange(cachedHeight);
				this.buildYLabels();

				// Only go through the xLabel loop again if the yLabel width has changed
				if (cachedYLabelWidth < this.yLabelWidth){
					this.endPoint = cachedEndPoint;
					this.calculateXLabelRotation();
				}
			}

		},
		calculateXLabelRotation : function(){
			//Get the width of each grid by calculating the difference
			//between x offsets between 0 and 1.

			this.ctx.font = this.font;

			var firstWidth = this.ctx.measureText(this.xLabels[0]).width,
				lastWidth = this.ctx.measureText(this.xLabels[this.xLabels.length - 1]).width,
				firstRotated,
				lastRotated;


			this.xScalePaddingRight = lastWidth/2 + 3;
			this.xScalePaddingLeft = (firstWidth/2 > this.yLabelWidth) ? firstWidth/2 : this.yLabelWidth;

			this.xLabelRotation = 0;
			if (this.display){
				var originalLabelWidth = longestText(this.ctx,this.font,this.xLabels),
					cosRotation,
					firstRotatedWidth;
				this.xLabelWidth = originalLabelWidth;
				//Allow 3 pixels x2 padding either side for label readability
				var xGridWidth = Math.floor(this.calculateX(1) - this.calculateX(0)) - 6;

				//Max label rotate should be 90 - also act as a loop counter
				while ((this.xLabelWidth > xGridWidth && this.xLabelRotation === 0) || (this.xLabelWidth > xGridWidth && this.xLabelRotation <= 90 && this.xLabelRotation > 0)){
					cosRotation = Math.cos(toRadians(this.xLabelRotation));

					firstRotated = cosRotation * firstWidth;
					lastRotated = cosRotation * lastWidth;

					// We're right aligning the text now.
					if (firstRotated + this.fontSize / 2 > this.yLabelWidth){
						this.xScalePaddingLeft = firstRotated + this.fontSize / 2;
					}
					this.xScalePaddingRight = this.fontSize/2;


					this.xLabelRotation++;
					this.xLabelWidth = cosRotation * originalLabelWidth;

				}
				if (this.xLabelRotation > 0){
					this.endPoint -= Math.sin(toRadians(this.xLabelRotation))*originalLabelWidth + 3;
				}
			}
			else{
				this.xLabelWidth = 0;
				this.xScalePaddingRight = this.padding;
				this.xScalePaddingLeft = this.padding;
			}

		},
		// Needs to be overidden in each Chart type
		// Otherwise we need to pass all the data into the scale class
		calculateYRange: noop,
		drawingArea: function(){
			return this.startPoint - this.endPoint;
		},
		calculateY : function(value){
			var scalingFactor = this.drawingArea() / (this.min - this.max);
			return this.endPoint - (scalingFactor * (value - this.min));
		},
		calculateX : function(index){
			var isRotated = (this.xLabelRotation > 0),
				// innerWidth = (this.offsetGridLines) ? this.width - offsetLeft - this.padding : this.width - (offsetLeft + halfLabelWidth * 2) - this.padding,
				innerWidth = this.width - (this.xScalePaddingLeft + this.xScalePaddingRight),
				valueWidth = innerWidth/Math.max((this.valuesCount - ((this.offsetGridLines) ? 0 : 1)), 1),
				valueOffset = (valueWidth * index) + this.xScalePaddingLeft;

			if (this.offsetGridLines){
				valueOffset += (valueWidth/2);
			}

			return Math.round(valueOffset);
		},
		update : function(newProps){
			helpers.extend(this, newProps);
			this.fit();
		},
		draw : function(){
			var ctx = this.ctx,
				yLabelGap = (this.endPoint - this.startPoint) / this.steps,
				xStart = Math.round(this.xScalePaddingLeft);
			if (this.display){
				ctx.fillStyle = this.textColor;
				ctx.font = this.font;
				each(this.yLabels,function(labelString,index){
					var yLabelCenter = this.endPoint - (yLabelGap * index),
						linePositionY = Math.round(yLabelCenter),
						drawHorizontalLine = this.showHorizontalLines;

					ctx.textAlign = "right";
					ctx.textBaseline = "middle";
					if (this.showLabels){
						ctx.fillText(labelString,xStart - 10,yLabelCenter);
					}

					// This is X axis, so draw it
					if (index === 0 && !drawHorizontalLine){
						drawHorizontalLine = true;
					}

					if (drawHorizontalLine){
						ctx.beginPath();
					}

					if (index > 0){
						// This is a grid line in the centre, so drop that
						ctx.lineWidth = this.gridLineWidth;
						ctx.strokeStyle = this.gridLineColor;
					} else {
						// This is the first line on the scale
						ctx.lineWidth = this.lineWidth;
						ctx.strokeStyle = this.lineColor;
					}

					linePositionY += helpers.aliasPixel(ctx.lineWidth);

					if(drawHorizontalLine){
						ctx.moveTo(xStart, linePositionY);
						ctx.lineTo(this.width, linePositionY);
						ctx.stroke();
						ctx.closePath();
					}

					ctx.lineWidth = this.lineWidth;
					ctx.strokeStyle = this.lineColor;
					ctx.beginPath();
					ctx.moveTo(xStart - 5, linePositionY);
					ctx.lineTo(xStart, linePositionY);
					ctx.stroke();
					ctx.closePath();

				},this);

				each(this.xLabels,function(label,index){
					var xPos = this.calculateX(index) + aliasPixel(this.lineWidth),
						// Check to see if line/bar here and decide where to place the line
						linePos = this.calculateX(index - (this.offsetGridLines ? 0.5 : 0)) + aliasPixel(this.lineWidth),
						isRotated = (this.xLabelRotation > 0),
						drawVerticalLine = this.showVerticalLines;

					// This is Y axis, so draw it
					if (index === 0 && !drawVerticalLine){
						drawVerticalLine = true;
					}

					if (drawVerticalLine){
						ctx.beginPath();
					}

					if (index > 0){
						// This is a grid line in the centre, so drop that
						ctx.lineWidth = this.gridLineWidth;
						ctx.strokeStyle = this.gridLineColor;
					} else {
						// This is the first line on the scale
						ctx.lineWidth = this.lineWidth;
						ctx.strokeStyle = this.lineColor;
					}

					if (drawVerticalLine){
						ctx.moveTo(linePos,this.endPoint);
						ctx.lineTo(linePos,this.startPoint - 3);
						ctx.stroke();
						ctx.closePath();
					}


					ctx.lineWidth = this.lineWidth;
					ctx.strokeStyle = this.lineColor;


					// Small lines at the bottom of the base grid line
					ctx.beginPath();
					ctx.moveTo(linePos,this.endPoint);
					ctx.lineTo(linePos,this.endPoint + 5);
					ctx.stroke();
					ctx.closePath();

					ctx.save();
					ctx.translate(xPos,(isRotated) ? this.endPoint + 12 : this.endPoint + 8);
					ctx.rotate(toRadians(this.xLabelRotation)*-1);
					ctx.font = this.font;
					ctx.textAlign = (isRotated) ? "right" : "center";
					ctx.textBaseline = (isRotated) ? "middle" : "top";
					ctx.fillText(label, 0, 0);
					ctx.restore();
				},this);

			}
		}

	});

	Chart.RadialScale = Chart.Element.extend({
		initialize: function(){
			this.size = min([this.height, this.width]);
			this.drawingArea = (this.display) ? (this.size/2) - (this.fontSize/2 + this.backdropPaddingY) : (this.size/2);
		},
		calculateCenterOffset: function(value){
			// Take into account half font size + the yPadding of the top value
			var scalingFactor = this.drawingArea / (this.max - this.min);

			return (value - this.min) * scalingFactor;
		},
		update : function(){
			if (!this.lineArc){
				this.setScaleSize();
			} else {
				this.drawingArea = (this.display) ? (this.size/2) - (this.fontSize/2 + this.backdropPaddingY) : (this.size/2);
			}
			this.buildYLabels();
		},
		buildYLabels: function(){
			this.yLabels = [];

			var stepDecimalPlaces = getDecimalPlaces(this.stepValue);

			for (var i=0; i<=this.steps; i++){
				this.yLabels.push(template(this.templateString,{value:(this.min + (i * this.stepValue)).toFixed(stepDecimalPlaces)}));
			}
		},
		getCircumference : function(){
			return ((Math.PI*2) / this.valuesCount);
		},
		setScaleSize: function(){
			/*
			 * Right, this is really confusing and there is a lot of maths going on here
			 * The gist of the problem is here: https://gist.github.com/nnnick/696cc9c55f4b0beb8fe9
			 *
			 * Reaction: https://dl.dropboxusercontent.com/u/34601363/toomuchscience.gif
			 *
			 * Solution:
			 *
			 * We assume the radius of the polygon is half the size of the canvas at first
			 * at each index we check if the text overlaps.
			 *
			 * Where it does, we store that angle and that index.
			 *
			 * After finding the largest index and angle we calculate how much we need to remove
			 * from the shape radius to move the point inwards by that x.
			 *
			 * We average the left and right distances to get the maximum shape radius that can fit in the box
			 * along with labels.
			 *
			 * Once we have that, we can find the centre point for the chart, by taking the x text protrusion
			 * on each side, removing that from the size, halving it and adding the left x protrusion width.
			 *
			 * This will mean we have a shape fitted to the canvas, as large as it can be with the labels
			 * and position it in the most space efficient manner
			 *
			 * https://dl.dropboxusercontent.com/u/34601363/yeahscience.gif
			 */


			// Get maximum radius of the polygon. Either half the height (minus the text width) or half the width.
			// Use this to calculate the offset + change. - Make sure L/R protrusion is at least 0 to stop issues with centre points
			var largestPossibleRadius = min([(this.height/2 - this.pointLabelFontSize - 5), this.width/2]),
				pointPosition,
				i,
				textWidth,
				halfTextWidth,
				furthestRight = this.width,
				furthestRightIndex,
				furthestRightAngle,
				furthestLeft = 0,
				furthestLeftIndex,
				furthestLeftAngle,
				xProtrusionLeft,
				xProtrusionRight,
				radiusReductionRight,
				radiusReductionLeft,
				maxWidthRadius;
			this.ctx.font = fontString(this.pointLabelFontSize,this.pointLabelFontStyle,this.pointLabelFontFamily);
			for (i=0;i<this.valuesCount;i++){
				// 5px to space the text slightly out - similar to what we do in the draw function.
				pointPosition = this.getPointPosition(i, largestPossibleRadius);
				textWidth = this.ctx.measureText(template(this.templateString, { value: this.labels[i] })).width + 5;
				if (i === 0 || i === this.valuesCount/2){
					// If we're at index zero, or exactly the middle, we're at exactly the top/bottom
					// of the radar chart, so text will be aligned centrally, so we'll half it and compare
					// w/left and right text sizes
					halfTextWidth = textWidth/2;
					if (pointPosition.x + halfTextWidth > furthestRight) {
						furthestRight = pointPosition.x + halfTextWidth;
						furthestRightIndex = i;
					}
					if (pointPosition.x - halfTextWidth < furthestLeft) {
						furthestLeft = pointPosition.x - halfTextWidth;
						furthestLeftIndex = i;
					}
				}
				else if (i < this.valuesCount/2) {
					// Less than half the values means we'll left align the text
					if (pointPosition.x + textWidth > furthestRight) {
						furthestRight = pointPosition.x + textWidth;
						furthestRightIndex = i;
					}
				}
				else if (i > this.valuesCount/2){
					// More than half the values means we'll right align the text
					if (pointPosition.x - textWidth < furthestLeft) {
						furthestLeft = pointPosition.x - textWidth;
						furthestLeftIndex = i;
					}
				}
			}

			xProtrusionLeft = furthestLeft;

			xProtrusionRight = Math.ceil(furthestRight - this.width);

			furthestRightAngle = this.getIndexAngle(furthestRightIndex);

			furthestLeftAngle = this.getIndexAngle(furthestLeftIndex);

			radiusReductionRight = xProtrusionRight / Math.sin(furthestRightAngle + Math.PI/2);

			radiusReductionLeft = xProtrusionLeft / Math.sin(furthestLeftAngle + Math.PI/2);

			// Ensure we actually need to reduce the size of the chart
			radiusReductionRight = (isNumber(radiusReductionRight)) ? radiusReductionRight : 0;
			radiusReductionLeft = (isNumber(radiusReductionLeft)) ? radiusReductionLeft : 0;

			this.drawingArea = largestPossibleRadius - (radiusReductionLeft + radiusReductionRight)/2;

			//this.drawingArea = min([maxWidthRadius, (this.height - (2 * (this.pointLabelFontSize + 5)))/2])
			this.setCenterPoint(radiusReductionLeft, radiusReductionRight);

		},
		setCenterPoint: function(leftMovement, rightMovement){

			var maxRight = this.width - rightMovement - this.drawingArea,
				maxLeft = leftMovement + this.drawingArea;

			this.xCenter = (maxLeft + maxRight)/2;
			// Always vertically in the centre as the text height doesn't change
			this.yCenter = (this.height/2);
		},

		getIndexAngle : function(index){
			var angleMultiplier = (Math.PI * 2) / this.valuesCount;
			// Start from the top instead of right, so remove a quarter of the circle

			return index * angleMultiplier - (Math.PI/2);
		},
		getPointPosition : function(index, distanceFromCenter){
			var thisAngle = this.getIndexAngle(index);
			return {
				x : (Math.cos(thisAngle) * distanceFromCenter) + this.xCenter,
				y : (Math.sin(thisAngle) * distanceFromCenter) + this.yCenter
			};
		},
		draw: function(){
			if (this.display){
				var ctx = this.ctx;
				each(this.yLabels, function(label, index){
					// Don't draw a centre value
					if (index > 0){
						var yCenterOffset = index * (this.drawingArea/this.steps),
							yHeight = this.yCenter - yCenterOffset,
							pointPosition;

						// Draw circular lines around the scale
						if (this.lineWidth > 0){
							ctx.strokeStyle = this.lineColor;
							ctx.lineWidth = this.lineWidth;

							if(this.lineArc){
								ctx.beginPath();
								ctx.arc(this.xCenter, this.yCenter, yCenterOffset, 0, Math.PI*2);
								ctx.closePath();
								ctx.stroke();
							} else{
								ctx.beginPath();
								for (var i=0;i<this.valuesCount;i++)
								{
									pointPosition = this.getPointPosition(i, this.calculateCenterOffset(this.min + (index * this.stepValue)));
									if (i === 0){
										ctx.moveTo(pointPosition.x, pointPosition.y);
									} else {
										ctx.lineTo(pointPosition.x, pointPosition.y);
									}
								}
								ctx.closePath();
								ctx.stroke();
							}
						}
						if(this.showLabels){
							ctx.font = fontString(this.fontSize,this.fontStyle,this.fontFamily);
							if (this.showLabelBackdrop){
								var labelWidth = ctx.measureText(label).width;
								ctx.fillStyle = this.backdropColor;
								ctx.fillRect(
									this.xCenter - labelWidth/2 - this.backdropPaddingX,
									yHeight - this.fontSize/2 - this.backdropPaddingY,
									labelWidth + this.backdropPaddingX*2,
									this.fontSize + this.backdropPaddingY*2
								);
							}
							ctx.textAlign = 'center';
							ctx.textBaseline = "middle";
							ctx.fillStyle = this.fontColor;
							ctx.fillText(label, this.xCenter, yHeight);
						}
					}
				}, this);

				if (!this.lineArc){
					ctx.lineWidth = this.angleLineWidth;
					ctx.strokeStyle = this.angleLineColor;
					for (var i = this.valuesCount - 1; i >= 0; i--) {
						var centerOffset = null, outerPosition = null;

						if (this.angleLineWidth > 0 && (i % this.angleLineInterval === 0)){
							centerOffset = this.calculateCenterOffset(this.max);
							outerPosition = this.getPointPosition(i, centerOffset);
							ctx.beginPath();
							ctx.moveTo(this.xCenter, this.yCenter);
							ctx.lineTo(outerPosition.x, outerPosition.y);
							ctx.stroke();
							ctx.closePath();
						}

						if (this.backgroundColors && this.backgroundColors.length == this.valuesCount) {
							if (centerOffset == null)
								centerOffset = this.calculateCenterOffset(this.max);

							if (outerPosition == null)
								outerPosition = this.getPointPosition(i, centerOffset);

							var previousOuterPosition = this.getPointPosition(i === 0 ? this.valuesCount - 1 : i - 1, centerOffset);
							var nextOuterPosition = this.getPointPosition(i === this.valuesCount - 1 ? 0 : i + 1, centerOffset);

							var previousOuterHalfway = { x: (previousOuterPosition.x + outerPosition.x) / 2, y: (previousOuterPosition.y + outerPosition.y) / 2 };
							var nextOuterHalfway = { x: (outerPosition.x + nextOuterPosition.x) / 2, y: (outerPosition.y + nextOuterPosition.y) / 2 };

							ctx.beginPath();
							ctx.moveTo(this.xCenter, this.yCenter);
							ctx.lineTo(previousOuterHalfway.x, previousOuterHalfway.y);
							ctx.lineTo(outerPosition.x, outerPosition.y);
							ctx.lineTo(nextOuterHalfway.x, nextOuterHalfway.y);
							ctx.fillStyle = this.backgroundColors[i];
							ctx.fill();
							ctx.closePath();
						}
						// Extra 3px out for some label spacing
						var pointLabelPosition = this.getPointPosition(i, this.calculateCenterOffset(this.max) + 5);
						ctx.font = fontString(this.pointLabelFontSize,this.pointLabelFontStyle,this.pointLabelFontFamily);
						ctx.fillStyle = this.pointLabelFontColor;

						var labelsCount = this.labels.length,
							halfLabelsCount = this.labels.length/2,
							quarterLabelsCount = halfLabelsCount/2,
							upperHalf = (i < quarterLabelsCount || i > labelsCount - quarterLabelsCount),
							exactQuarter = (i === quarterLabelsCount || i === labelsCount - quarterLabelsCount);
						if (i === 0){
							ctx.textAlign = 'center';
						} else if(i === halfLabelsCount){
							ctx.textAlign = 'center';
						} else if (i < halfLabelsCount){
							ctx.textAlign = 'left';
						} else {
							ctx.textAlign = 'right';
						}

						// Set the correct text baseline based on outer positioning
						if (exactQuarter){
							ctx.textBaseline = 'middle';
						} else if (upperHalf){
							ctx.textBaseline = 'bottom';
						} else {
							ctx.textBaseline = 'top';
						}

						ctx.fillText(this.labels[i], pointLabelPosition.x, pointLabelPosition.y);
					}
				}
			}
		}
	});

	Chart.animationService = {
		frameDuration: 17,
		animations: [],
		dropFrames: 0,
		addAnimation: function(chartInstance, animationObject) {
			for (var index = 0; index < this.animations.length; ++ index){
				if (this.animations[index].chartInstance === chartInstance){
					// replacing an in progress animation
					this.animations[index].animationObject = animationObject;
					return;
				}
			}
			
			this.animations.push({
				chartInstance: chartInstance,
				animationObject: animationObject
			});

			// If there are no animations queued, manually kickstart a digest, for lack of a better word
			if (this.animations.length == 1) {
				helpers.requestAnimFrame.call(window, this.digestWrapper);
			}
		},
		// Cancel the animation for a given chart instance
		cancelAnimation: function(chartInstance) {
			var index = helpers.findNextWhere(this.animations, function(animationWrapper) {
				return animationWrapper.chartInstance === chartInstance;
			});
			
			if (index)
			{
				this.animations.splice(index, 1);
			}
		},
		// calls startDigest with the proper context
		digestWrapper: function() {
			Chart.animationService.startDigest.call(Chart.animationService);
		},
		startDigest: function() {

			var startTime = Date.now();
			var framesToDrop = 0;

			if(this.dropFrames > 1){
				framesToDrop = Math.floor(this.dropFrames);
				this.dropFrames -= framesToDrop;
			}

			for (var i = 0; i < this.animations.length; i++) {

				if (this.animations[i].animationObject.currentStep === null){
					this.animations[i].animationObject.currentStep = 0;
				}

				this.animations[i].animationObject.currentStep += 1 + framesToDrop;
				if(this.animations[i].animationObject.currentStep > this.animations[i].animationObject.numSteps){
					this.animations[i].animationObject.currentStep = this.animations[i].animationObject.numSteps;
				}
				
				this.animations[i].animationObject.render(this.animations[i].chartInstance, this.animations[i].animationObject);
				
				// Check if executed the last frame.
				if (this.animations[i].animationObject.currentStep == this.animations[i].animationObject.numSteps){
					// Call onAnimationComplete
					this.animations[i].animationObject.onAnimationComplete.call(this.animations[i].chartInstance);
					// Remove the animation.
					this.animations.splice(i, 1);
					// Keep the index in place to offset the splice
					i--;
				}
			}

			var endTime = Date.now();
			var delay = endTime - startTime - this.frameDuration;
			var frameDelay = delay / this.frameDuration;

			if(frameDelay > 1){
				this.dropFrames += frameDelay;
			}

			// Do we have more stuff to animate?
			if (this.animations.length > 0){
				helpers.requestAnimFrame.call(window, this.digestWrapper);
			}
		}
	};

	// Attach global event to resize each chart instance when the browser resizes
	helpers.addEvent(window, "resize", (function(){
		// Basic debounce of resize function so it doesn't hurt performance when resizing browser.
		var timeout;
		return function(){
			clearTimeout(timeout);
			timeout = setTimeout(function(){
				each(Chart.instances,function(instance){
					// If the responsive flag is set in the chart instance config
					// Cascade the resize event down to the chart.
					if (instance.options.responsive){
						instance.resize(instance.render, true);
					}
				});
			}, 50);
		};
	})());


	if (amd) {
		define('Chart', [], function(){
			return Chart;
		});
	} else if (typeof module === 'object' && module.exports) {
		module.exports = Chart;
	}

	root.Chart = Chart;

	Chart.noConflict = function(){
		root.Chart = previous;
		return Chart;
	};

}).call(this);

(function(){
	"use strict";

	var root = this,
		Chart = root.Chart,
		helpers = Chart.helpers;


	var defaultConfig = {
		//Boolean - Whether the scale should start at zero, or an order of magnitude down from the lowest value
		scaleBeginAtZero : true,

		//Boolean - Whether grid lines are shown across the chart
		scaleShowGridLines : true,

		//String - Colour of the grid lines
		scaleGridLineColor : "rgba(0,0,0,.05)",

		//Number - Width of the grid lines
		scaleGridLineWidth : 1,

		//Boolean - Whether to show horizontal lines (except X axis)
		scaleShowHorizontalLines: true,

		//Boolean - Whether to show vertical lines (except Y axis)
		scaleShowVerticalLines: true,

		//Boolean - If there is a stroke on each bar
		barShowStroke : true,

		//Number - Pixel width of the bar stroke
		barStrokeWidth : 2,

		//Number - Spacing between each of the X value sets
		barValueSpacing : 5,

		//Number - Spacing between data sets within X values
		barDatasetSpacing : 1,

		//String - A legend template
		legendTemplate : "<ul class=\"<%=name.toLowerCase()%>-legend\"><% for (var i=0; i<datasets.length; i++){%><li><span class=\"<%=name.toLowerCase()%>-legend-icon\" style=\"background-color:<%=datasets[i].fillColor%>\"></span><span class=\"<%=name.toLowerCase()%>-legend-text\"><%if(datasets[i].label){%><%=datasets[i].label%><%}%></span></li><%}%></ul>"

	};


	Chart.Type.extend({
		name: "Bar",
		defaults : defaultConfig,
		initialize:  function(data){

			//Expose options as a scope variable here so we can access it in the ScaleClass
			var options = this.options;

			this.ScaleClass = Chart.Scale.extend({
				offsetGridLines : true,
				calculateBarX : function(datasetCount, datasetIndex, barIndex){
					//Reusable method for calculating the xPosition of a given bar based on datasetIndex & width of the bar
					var xWidth = this.calculateBaseWidth(),
						xAbsolute = this.calculateX(barIndex) - (xWidth/2),
						barWidth = this.calculateBarWidth(datasetCount);

					return xAbsolute + (barWidth * datasetIndex) + (datasetIndex * options.barDatasetSpacing) + barWidth/2;
				},
				calculateBaseWidth : function(){
					return (this.calculateX(1) - this.calculateX(0)) - (2*options.barValueSpacing);
				},
				calculateBarWidth : function(datasetCount){
					//The padding between datasets is to the right of each bar, providing that there are more than 1 dataset
					var baseWidth = this.calculateBaseWidth() - ((datasetCount - 1) * options.barDatasetSpacing);

					return (baseWidth / datasetCount);
				}
			});

			this.datasets = [];

			//Set up tooltip events on the chart
			if (this.options.showTooltips){
				helpers.bindEvents(this, this.options.tooltipEvents, function(evt){
					var activeBars = (evt.type !== 'mouseout') ? this.getBarsAtEvent(evt) : [];

					this.eachBars(function(bar){
						bar.restore(['fillColor', 'strokeColor']);
					});
					helpers.each(activeBars, function(activeBar){
						if (activeBar) {
							activeBar.fillColor = activeBar.highlightFill;
							activeBar.strokeColor = activeBar.highlightStroke;
						}
					});
					this.showTooltip(activeBars);
				});
			}

			//Declare the extension of the default point, to cater for the options passed in to the constructor
			this.BarClass = Chart.Rectangle.extend({
				strokeWidth : this.options.barStrokeWidth,
				showStroke : this.options.barShowStroke,
				ctx : this.chart.ctx
			});

			//Iterate through each of the datasets, and build this into a property of the chart
			helpers.each(data.datasets,function(dataset,datasetIndex){

				var datasetObject = {
					label : dataset.label || null,
					fillColor : dataset.fillColor,
					strokeColor : dataset.strokeColor,
					bars : []
				};

				this.datasets.push(datasetObject);

				helpers.each(dataset.data,function(dataPoint,index){
					//Add a new point for each piece of data, passing any required data to draw.
					datasetObject.bars.push(new this.BarClass({
						value : dataPoint,
						label : data.labels[index],
						datasetLabel: dataset.label,
						strokeColor : (typeof dataset.strokeColor == 'object') ? dataset.strokeColor[index] : dataset.strokeColor,
						fillColor : (typeof dataset.fillColor == 'object') ? dataset.fillColor[index] : dataset.fillColor,
						highlightFill : (dataset.highlightFill) ? (typeof dataset.highlightFill == 'object') ? dataset.highlightFill[index] : dataset.highlightFill : (typeof dataset.fillColor == 'object') ? dataset.fillColor[index] : dataset.fillColor,
						highlightStroke : (dataset.highlightStroke) ? (typeof dataset.highlightStroke == 'object') ? dataset.highlightStroke[index] : dataset.highlightStroke : (typeof dataset.strokeColor == 'object') ? dataset.strokeColor[index] : dataset.strokeColor
					}));
				},this);

			},this);

			this.buildScale(data.labels);

			this.BarClass.prototype.base = this.scale.endPoint;

			this.eachBars(function(bar, index, datasetIndex){
				helpers.extend(bar, {
					width : this.scale.calculateBarWidth(this.datasets.length),
					x: this.scale.calculateBarX(this.datasets.length, datasetIndex, index),
					y: this.scale.endPoint
				});
				bar.save();
			}, this);

			this.render();
		},
		update : function(){
			this.scale.update();
			// Reset any highlight colours before updating.
			helpers.each(this.activeElements, function(activeElement){
				activeElement.restore(['fillColor', 'strokeColor']);
			});

			this.eachBars(function(bar){
				bar.save();
			});
			this.render();
		},
		eachBars : function(callback){
			helpers.each(this.datasets,function(dataset, datasetIndex){
				helpers.each(dataset.bars, callback, this, datasetIndex);
			},this);
		},
		getBarsAtEvent : function(e){
			var barsArray = [],
				eventPosition = helpers.getRelativePosition(e),
				datasetIterator = function(dataset){
					barsArray.push(dataset.bars[barIndex]);
				},
				barIndex;

			for (var datasetIndex = 0; datasetIndex < this.datasets.length; datasetIndex++) {
				for (barIndex = 0; barIndex < this.datasets[datasetIndex].bars.length; barIndex++) {
					if (this.datasets[datasetIndex].bars[barIndex].inRange(eventPosition.x,eventPosition.y)){
						helpers.each(this.datasets, datasetIterator);
						return barsArray;
					}
				}
			}

			return barsArray;
		},
		buildScale : function(labels){
			var self = this;

			var dataTotal = function(){
				var values = [];
				self.eachBars(function(bar){
					values.push(bar.value);
				});
				return values;
			};

			var scaleOptions = {
				templateString : this.options.scaleLabel,
				height : this.chart.height,
				width : this.chart.width,
				ctx : this.chart.ctx,
				textColor : this.options.scaleFontColor,
				fontSize : this.options.scaleFontSize,
				fontStyle : this.options.scaleFontStyle,
				fontFamily : this.options.scaleFontFamily,
				valuesCount : labels.length,
				beginAtZero : this.options.scaleBeginAtZero,
				integersOnly : this.options.scaleIntegersOnly,
				calculateYRange: function(currentHeight){
					var updatedRanges = helpers.calculateScaleRange(
						dataTotal(),
						currentHeight,
						this.fontSize,
						this.beginAtZero,
						this.integersOnly
					);
					helpers.extend(this, updatedRanges);
				},
				xLabels : labels,
				font : helpers.fontString(this.options.scaleFontSize, this.options.scaleFontStyle, this.options.scaleFontFamily),
				lineWidth : this.options.scaleLineWidth,
				lineColor : this.options.scaleLineColor,
				showHorizontalLines : this.options.scaleShowHorizontalLines,
				showVerticalLines : this.options.scaleShowVerticalLines,
				gridLineWidth : (this.options.scaleShowGridLines) ? this.options.scaleGridLineWidth : 0,
				gridLineColor : (this.options.scaleShowGridLines) ? this.options.scaleGridLineColor : "rgba(0,0,0,0)",
				padding : (this.options.showScale) ? 0 : (this.options.barShowStroke) ? this.options.barStrokeWidth : 0,
				showLabels : this.options.scaleShowLabels,
				display : this.options.showScale
			};

			if (this.options.scaleOverride){
				helpers.extend(scaleOptions, {
					calculateYRange: helpers.noop,
					steps: this.options.scaleSteps,
					stepValue: this.options.scaleStepWidth,
					min: this.options.scaleStartValue,
					max: this.options.scaleStartValue + (this.options.scaleSteps * this.options.scaleStepWidth)
				});
			}

			this.scale = new this.ScaleClass(scaleOptions);
		},
		addData : function(valuesArray,label){
			//Map the values array for each of the datasets
			helpers.each(valuesArray,function(value,datasetIndex){
				//Add a new point for each piece of data, passing any required data to draw.
				this.datasets[datasetIndex].bars.push(new this.BarClass({
					value : value,
					label : label,
					datasetLabel: this.datasets[datasetIndex].label,
					x: this.scale.calculateBarX(this.datasets.length, datasetIndex, this.scale.valuesCount+1),
					y: this.scale.endPoint,
					width : this.scale.calculateBarWidth(this.datasets.length),
					base : this.scale.endPoint,
					strokeColor : this.datasets[datasetIndex].strokeColor,
					fillColor : this.datasets[datasetIndex].fillColor
				}));
			},this);

			this.scale.addXLabel(label);
			//Then re-render the chart.
			this.update();
		},
		removeData : function(){
			this.scale.removeXLabel();
			//Then re-render the chart.
			helpers.each(this.datasets,function(dataset){
				dataset.bars.shift();
			},this);
			this.update();
		},
		reflow : function(){
			helpers.extend(this.BarClass.prototype,{
				y: this.scale.endPoint,
				base : this.scale.endPoint
			});
			var newScaleProps = helpers.extend({
				height : this.chart.height,
				width : this.chart.width
			});
			this.scale.update(newScaleProps);
		},
		draw : function(ease){
			var easingDecimal = ease || 1;
			this.clear();

			var ctx = this.chart.ctx;

			this.scale.draw(easingDecimal);

			//Draw all the bars for each dataset
			helpers.each(this.datasets,function(dataset,datasetIndex){
				helpers.each(dataset.bars,function(bar,index){
					if (bar.hasValue()){
						bar.base = this.scale.endPoint;
						//Transition then draw
						bar.transition({
							x : this.scale.calculateBarX(this.datasets.length, datasetIndex, index),
							y : this.scale.calculateY(bar.value),
							width : this.scale.calculateBarWidth(this.datasets.length)
						}, easingDecimal).draw();
					}
				},this);

			},this);
		}
	});


}).call(this);

(function(){
	"use strict";

	var root = this,
		Chart = root.Chart,
		//Cache a local reference to Chart.helpers
		helpers = Chart.helpers;

	var defaultConfig = {
		//Boolean - Whether we should show a stroke on each segment
		segmentShowStroke : true,

		//String - The colour of each segment stroke
		segmentStrokeColor : "#fff",

		//Number - The width of each segment stroke
		segmentStrokeWidth : 2,

		//The percentage of the chart that we cut out of the middle.
		percentageInnerCutout : 50,

		//Number - Amount of animation steps
		animationSteps : 100,

		//String - Animation easing effect
		animationEasing : "easeOutBounce",

		//Boolean - Whether we animate the rotation of the Doughnut
		animateRotate : true,

		//Boolean - Whether we animate scaling the Doughnut from the centre
		animateScale : false,

		//String - A legend template
		legendTemplate : "<ul class=\"<%=name.toLowerCase()%>-legend\"><% for (var i=0; i<segments.length; i++){%><li><span class=\"<%=name.toLowerCase()%>-legend-icon\" style=\"background-color:<%=segments[i].fillColor%>\"></span><span class=\"<%=name.toLowerCase()%>-legend-text\"><%if(segments[i].label){%><%=segments[i].label%><%}%></span></li><%}%></ul>"

	};

	Chart.Type.extend({
		//Passing in a name registers this chart in the Chart namespace
		name: "Doughnut",
		//Providing a defaults will also register the defaults in the chart namespace
		defaults : defaultConfig,
		//Initialize is fired when the chart is initialized - Data is passed in as a parameter
		//Config is automatically merged by the core of Chart.js, and is available at this.options
		initialize:  function(data){

			//Declare segments as a static property to prevent inheriting across the Chart type prototype
			this.segments = [];
			this.outerRadius = (helpers.min([this.chart.width,this.chart.height]) -	this.options.segmentStrokeWidth/2)/2;

			this.SegmentArc = Chart.Arc.extend({
				ctx : this.chart.ctx,
				x : this.chart.width/2,
				y : this.chart.height/2
			});

			//Set up tooltip events on the chart
			if (this.options.showTooltips){
				helpers.bindEvents(this, this.options.tooltipEvents, function(evt){
					var activeSegments = (evt.type !== 'mouseout') ? this.getSegmentsAtEvent(evt) : [];

					helpers.each(this.segments,function(segment){
						segment.restore(["fillColor"]);
					});
					helpers.each(activeSegments,function(activeSegment){
						activeSegment.fillColor = activeSegment.highlightColor;
					});
					this.showTooltip(activeSegments);
				});
			}
			this.calculateTotal(data);

			helpers.each(data,function(datapoint, index){
				if (!datapoint.color) {
					datapoint.color = 'hsl(' + (360 * index / data.length) + ', 100%, 50%)';
				}
				this.addData(datapoint, index, true);
			},this);

			this.render();
		},
		getSegmentsAtEvent : function(e){
			var segmentsArray = [];

			var location = helpers.getRelativePosition(e);

			helpers.each(this.segments,function(segment){
				if (segment.inRange(location.x,location.y)) segmentsArray.push(segment);
			},this);
			return segmentsArray;
		},
		addData : function(segment, atIndex, silent){
			var index = atIndex !== undefined ? atIndex : this.segments.length;
			if ( typeof(segment.color) === "undefined" ) {
				segment.color = Chart.defaults.global.segmentColorDefault[index % Chart.defaults.global.segmentColorDefault.length];
				segment.highlight = Chart.defaults.global.segmentHighlightColorDefaults[index % Chart.defaults.global.segmentHighlightColorDefaults.length];				
			}
			this.segments.splice(index, 0, new this.SegmentArc({
				value : segment.value,
				outerRadius : (this.options.animateScale) ? 0 : this.outerRadius,
				innerRadius : (this.options.animateScale) ? 0 : (this.outerRadius/100) * this.options.percentageInnerCutout,
				fillColor : segment.color,
				highlightColor : segment.highlight || segment.color,
				showStroke : this.options.segmentShowStroke,
				strokeWidth : this.options.segmentStrokeWidth,
				strokeColor : this.options.segmentStrokeColor,
				startAngle : Math.PI * 1.5,
				circumference : (this.options.animateRotate) ? 0 : this.calculateCircumference(segment.value),
				label : segment.label
			}));
			if (!silent){
				this.reflow();
				this.update();
			}
		},
		calculateCircumference : function(value) {
			if ( this.total > 0 ) {
				return (Math.PI*2)*(value / this.total);
			} else {
				return 0;
			}
		},
		calculateTotal : function(data){
			this.total = 0;
			helpers.each(data,function(segment){
				this.total += Math.abs(segment.value);
			},this);
		},
		update : function(){
			this.calculateTotal(this.segments);

			// Reset any highlight colours before updating.
			helpers.each(this.activeElements, function(activeElement){
				activeElement.restore(['fillColor']);
			});

			helpers.each(this.segments,function(segment){
				segment.save();
			});
			this.render();
		},

		removeData: function(atIndex){
			var indexToDelete = (helpers.isNumber(atIndex)) ? atIndex : this.segments.length-1;
			this.segments.splice(indexToDelete, 1);
			this.reflow();
			this.update();
		},

		reflow : function(){
			helpers.extend(this.SegmentArc.prototype,{
				x : this.chart.width/2,
				y : this.chart.height/2
			});
			this.outerRadius = (helpers.min([this.chart.width,this.chart.height]) -	this.options.segmentStrokeWidth/2)/2;
			helpers.each(this.segments, function(segment){
				segment.update({
					outerRadius : this.outerRadius,
					innerRadius : (this.outerRadius/100) * this.options.percentageInnerCutout
				});
			}, this);
		},
		draw : function(easeDecimal){
			var animDecimal = (easeDecimal) ? easeDecimal : 1;
			this.clear();
			helpers.each(this.segments,function(segment,index){
				segment.transition({
					circumference : this.calculateCircumference(segment.value),
					outerRadius : this.outerRadius,
					innerRadius : (this.outerRadius/100) * this.options.percentageInnerCutout
				},animDecimal);

				segment.endAngle = segment.startAngle + segment.circumference;

				segment.draw();
				if (index === 0){
					segment.startAngle = Math.PI * 1.5;
				}
				//Check to see if it's the last segment, if not get the next and update the start angle
				if (index < this.segments.length-1){
					this.segments[index+1].startAngle = segment.endAngle;
				}
			},this);

		}
	});

	Chart.types.Doughnut.extend({
		name : "Pie",
		defaults : helpers.merge(defaultConfig,{percentageInnerCutout : 0})
	});

}).call(this);

(function(){
	"use strict";

	var root = this,
		Chart = root.Chart,
		helpers = Chart.helpers;

	var defaultConfig = {

		///Boolean - Whether grid lines are shown across the chart
		scaleShowGridLines : true,

		//String - Colour of the grid lines
		scaleGridLineColor : "rgba(0,0,0,.05)",

		//Number - Width of the grid lines
		scaleGridLineWidth : 1,

		//Boolean - Whether to show horizontal lines (except X axis)
		scaleShowHorizontalLines: true,

		//Boolean - Whether to show vertical lines (except Y axis)
		scaleShowVerticalLines: true,

		//Boolean - Whether the line is curved between points
		bezierCurve : true,

		//Number - Tension of the bezier curve between points
		bezierCurveTension : 0.4,

		//Boolean - Whether to show a dot for each point
		pointDot : true,

		//Number - Radius of each point dot in pixels
		pointDotRadius : 4,

		//Number - Pixel width of point dot stroke
		pointDotStrokeWidth : 1,

		//Number - amount extra to add to the radius to cater for hit detection outside the drawn point
		pointHitDetectionRadius : 20,

		//Boolean - Whether to show a stroke for datasets
		datasetStroke : true,

		//Number - Pixel width of dataset stroke
		datasetStrokeWidth : 2,

		//Boolean - Whether to fill the dataset with a colour
		datasetFill : true,

		//String - A legend template
		legendTemplate : "<ul class=\"<%=name.toLowerCase()%>-legend\"><% for (var i=0; i<datasets.length; i++){%><li><span class=\"<%=name.toLowerCase()%>-legend-icon\" style=\"background-color:<%=datasets[i].strokeColor%>\"></span><span class=\"<%=name.toLowerCase()%>-legend-text\"><%if(datasets[i].label){%><%=datasets[i].label%><%}%></span></li><%}%></ul>",

		//Boolean - Whether to horizontally center the label and point dot inside the grid
		offsetGridLines : false

	};


	Chart.Type.extend({
		name: "Line",
		defaults : defaultConfig,
		initialize:  function(data){
			//Declare the extension of the default point, to cater for the options passed in to the constructor
			this.PointClass = Chart.Point.extend({
				offsetGridLines : this.options.offsetGridLines,
				strokeWidth : this.options.pointDotStrokeWidth,
				radius : this.options.pointDotRadius,
				display: this.options.pointDot,
				hitDetectionRadius : this.options.pointHitDetectionRadius,
				ctx : this.chart.ctx,
				inRange : function(mouseX){
					return (Math.pow(mouseX-this.x, 2) < Math.pow(this.radius + this.hitDetectionRadius,2));
				}
			});

			this.datasets = [];

			//Set up tooltip events on the chart
			if (this.options.showTooltips){
				helpers.bindEvents(this, this.options.tooltipEvents, function(evt){
					var activePoints = (evt.type !== 'mouseout') ? this.getPointsAtEvent(evt) : [];
					this.eachPoints(function(point){
						point.restore(['fillColor', 'strokeColor']);
					});
					helpers.each(activePoints, function(activePoint){
						activePoint.fillColor = activePoint.highlightFill;
						activePoint.strokeColor = activePoint.highlightStroke;
					});
					this.showTooltip(activePoints);
				});
			}

			//Iterate through each of the datasets, and build this into a property of the chart
			helpers.each(data.datasets,function(dataset){

				var datasetObject = {
					label : dataset.label || null,
					fillColor : dataset.fillColor,
					strokeColor : dataset.strokeColor,
					pointColor : dataset.pointColor,
					pointStrokeColor : dataset.pointStrokeColor,
					points : []
				};

				this.datasets.push(datasetObject);


				helpers.each(dataset.data,function(dataPoint,index){
					//Add a new point for each piece of data, passing any required data to draw.
					datasetObject.points.push(new this.PointClass({
						value : dataPoint,
						label : data.labels[index],
						datasetLabel: dataset.label,
						strokeColor : dataset.pointStrokeColor,
						fillColor : dataset.pointColor,
						highlightFill : dataset.pointHighlightFill || dataset.pointColor,
						highlightStroke : dataset.pointHighlightStroke || dataset.pointStrokeColor
					}));
				},this);

				this.buildScale(data.labels);


				this.eachPoints(function(point, index){
					helpers.extend(point, {
						x: this.scale.calculateX(index),
						y: this.scale.endPoint
					});
					point.save();
				}, this);

			},this);


			this.render();
		},
		update : function(){
			this.scale.update();
			// Reset any highlight colours before updating.
			helpers.each(this.activeElements, function(activeElement){
				activeElement.restore(['fillColor', 'strokeColor']);
			});
			this.eachPoints(function(point){
				point.save();
			});
			this.render();
		},
		eachPoints : function(callback){
			helpers.each(this.datasets,function(dataset){
				helpers.each(dataset.points,callback,this);
			},this);
		},
		getPointsAtEvent : function(e){
			var pointsArray = [],
				eventPosition = helpers.getRelativePosition(e);
			helpers.each(this.datasets,function(dataset){
				helpers.each(dataset.points,function(point){
					if (point.inRange(eventPosition.x,eventPosition.y)) pointsArray.push(point);
				});
			},this);
			return pointsArray;
		},
		buildScale : function(labels){
			var self = this;

			var dataTotal = function(){
				var values = [];
				self.eachPoints(function(point){
					values.push(point.value);
				});

				return values;
			};

			var scaleOptions = {
				templateString : this.options.scaleLabel,
				height : this.chart.height,
				width : this.chart.width,
				ctx : this.chart.ctx,
				textColor : this.options.scaleFontColor,
				offsetGridLines : this.options.offsetGridLines,
				fontSize : this.options.scaleFontSize,
				fontStyle : this.options.scaleFontStyle,
				fontFamily : this.options.scaleFontFamily,
				valuesCount : labels.length,
				beginAtZero : this.options.scaleBeginAtZero,
				integersOnly : this.options.scaleIntegersOnly,
				calculateYRange : function(currentHeight){
					var updatedRanges = helpers.calculateScaleRange(
						dataTotal(),
						currentHeight,
						this.fontSize,
						this.beginAtZero,
						this.integersOnly
					);
					helpers.extend(this, updatedRanges);
				},
				xLabels : labels,
				font : helpers.fontString(this.options.scaleFontSize, this.options.scaleFontStyle, this.options.scaleFontFamily),
				lineWidth : this.options.scaleLineWidth,
				lineColor : this.options.scaleLineColor,
				showHorizontalLines : this.options.scaleShowHorizontalLines,
				showVerticalLines : this.options.scaleShowVerticalLines,
				gridLineWidth : (this.options.scaleShowGridLines) ? this.options.scaleGridLineWidth : 0,
				gridLineColor : (this.options.scaleShowGridLines) ? this.options.scaleGridLineColor : "rgba(0,0,0,0)",
				padding: (this.options.showScale) ? 0 : this.options.pointDotRadius + this.options.pointDotStrokeWidth,
				showLabels : this.options.scaleShowLabels,
				display : this.options.showScale
			};

			if (this.options.scaleOverride){
				helpers.extend(scaleOptions, {
					calculateYRange: helpers.noop,
					steps: this.options.scaleSteps,
					stepValue: this.options.scaleStepWidth,
					min: this.options.scaleStartValue,
					max: this.options.scaleStartValue + (this.options.scaleSteps * this.options.scaleStepWidth)
				});
			}


			this.scale = new Chart.Scale(scaleOptions);
		},
		addData : function(valuesArray,label){
			//Map the values array for each of the datasets

			helpers.each(valuesArray,function(value,datasetIndex){
				//Add a new point for each piece of data, passing any required data to draw.
				this.datasets[datasetIndex].points.push(new this.PointClass({
					value : value,
					label : label,
					datasetLabel: this.datasets[datasetIndex].label,
					x: this.scale.calculateX(this.scale.valuesCount+1),
					y: this.scale.endPoint,
					strokeColor : this.datasets[datasetIndex].pointStrokeColor,
					fillColor : this.datasets[datasetIndex].pointColor
				}));
			},this);

			this.scale.addXLabel(label);
			//Then re-render the chart.
			this.update();
		},
		removeData : function(){
			this.scale.removeXLabel();
			//Then re-render the chart.
			helpers.each(this.datasets,function(dataset){
				dataset.points.shift();
			},this);
			this.update();
		},
		reflow : function(){
			var newScaleProps = helpers.extend({
				height : this.chart.height,
				width : this.chart.width
			});
			this.scale.update(newScaleProps);
		},
		draw : function(ease){
			var easingDecimal = ease || 1;
			this.clear();

			var ctx = this.chart.ctx;

			// Some helper methods for getting the next/prev points
			var hasValue = function(item){
				return item.value !== null;
			},
			nextPoint = function(point, collection, index){
				return helpers.findNextWhere(collection, hasValue, index) || point;
			},
			previousPoint = function(point, collection, index){
				return helpers.findPreviousWhere(collection, hasValue, index) || point;
			};

			if (!this.scale) return;
			this.scale.draw(easingDecimal);


			helpers.each(this.datasets,function(dataset){
				var pointsWithValues = helpers.where(dataset.points, hasValue);

				//Transition each point first so that the line and point drawing isn't out of sync
				//We can use this extra loop to calculate the control points of this dataset also in this loop

				helpers.each(dataset.points, function(point, index){
					if (point.hasValue()){
						point.transition({
							y : this.scale.calculateY(point.value),
							x : this.scale.calculateX(index)
						}, easingDecimal);
					}
				},this);


				// Control points need to be calculated in a separate loop, because we need to know the current x/y of the point
				// This would cause issues when there is no animation, because the y of the next point would be 0, so beziers would be skewed
				if (this.options.bezierCurve){
					helpers.each(pointsWithValues, function(point, index){
						var tension = (index > 0 && index < pointsWithValues.length - 1) ? this.options.bezierCurveTension : 0;
						point.controlPoints = helpers.splineCurve(
							previousPoint(point, pointsWithValues, index),
							point,
							nextPoint(point, pointsWithValues, index),
							tension
						);

						// Prevent the bezier going outside of the bounds of the graph

						// Cap puter bezier handles to the upper/lower scale bounds
						if (point.controlPoints.outer.y > this.scale.endPoint){
							point.controlPoints.outer.y = this.scale.endPoint;
						}
						else if (point.controlPoints.outer.y < this.scale.startPoint){
							point.controlPoints.outer.y = this.scale.startPoint;
						}

						// Cap inner bezier handles to the upper/lower scale bounds
						if (point.controlPoints.inner.y > this.scale.endPoint){
							point.controlPoints.inner.y = this.scale.endPoint;
						}
						else if (point.controlPoints.inner.y < this.scale.startPoint){
							point.controlPoints.inner.y = this.scale.startPoint;
						}
					},this);
				}


				//Draw the line between all the points
				ctx.lineWidth = this.options.datasetStrokeWidth;
				ctx.strokeStyle = dataset.strokeColor;
				ctx.beginPath();

				helpers.each(pointsWithValues, function(point, index){
					if (index === 0){
						ctx.moveTo(point.x, point.y);
					}
					else{
						if(this.options.bezierCurve){
							var previous = previousPoint(point, pointsWithValues, index);

							ctx.bezierCurveTo(
								previous.controlPoints.outer.x,
								previous.controlPoints.outer.y,
								point.controlPoints.inner.x,
								point.controlPoints.inner.y,
								point.x,
								point.y
							);
						}
						else{
							ctx.lineTo(point.x,point.y);
						}
					}
				}, this);

				if (this.options.datasetStroke) {
					ctx.stroke();
				}

				if (this.options.datasetFill && pointsWithValues.length > 0){
					//Round off the line by going to the base of the chart, back to the start, then fill.
					ctx.lineTo(pointsWithValues[pointsWithValues.length - 1].x, this.scale.endPoint);
					ctx.lineTo(pointsWithValues[0].x, this.scale.endPoint);
					ctx.fillStyle = dataset.fillColor;
					ctx.closePath();
					ctx.fill();
				}

				//Now draw the points over the line
				//A little inefficient double looping, but better than the line
				//lagging behind the point positions
				helpers.each(pointsWithValues,function(point){
					point.draw();
				});
			},this);
		}
	});


}).call(this);

(function(){
	"use strict";

	var root = this,
		Chart = root.Chart,
		//Cache a local reference to Chart.helpers
		helpers = Chart.helpers;

	var defaultConfig = {
		//Boolean - Show a backdrop to the scale label
		scaleShowLabelBackdrop : true,

		//String - The colour of the label backdrop
		scaleBackdropColor : "rgba(255,255,255,0.75)",

		// Boolean - Whether the scale should begin at zero
		scaleBeginAtZero : true,

		//Number - The backdrop padding above & below the label in pixels
		scaleBackdropPaddingY : 2,

		//Number - The backdrop padding to the side of the label in pixels
		scaleBackdropPaddingX : 2,

		//Boolean - Show line for each value in the scale
		scaleShowLine : true,

		//Boolean - Stroke a line around each segment in the chart
		segmentShowStroke : true,

		//String - The colour of the stroke on each segment.
		segmentStrokeColor : "#fff",

		//Number - The width of the stroke value in pixels
		segmentStrokeWidth : 2,

		//Number - Amount of animation steps
		animationSteps : 100,

		//String - Animation easing effect.
		animationEasing : "easeOutBounce",

		//Boolean - Whether to animate the rotation of the chart
		animateRotate : true,

		//Boolean - Whether to animate scaling the chart from the centre
		animateScale : false,

		//String - A legend template
		legendTemplate : "<ul class=\"<%=name.toLowerCase()%>-legend\"><% for (var i=0; i<segments.length; i++){%><li><span class=\"<%=name.toLowerCase()%>-legend-icon\" style=\"background-color:<%=segments[i].fillColor%>\"></span><span class=\"<%=name.toLowerCase()%>-legend-text\"><%if(segments[i].label){%><%=segments[i].label%><%}%></span></li><%}%></ul>"
	};


	Chart.Type.extend({
		//Passing in a name registers this chart in the Chart namespace
		name: "PolarArea",
		//Providing a defaults will also register the defaults in the chart namespace
		defaults : defaultConfig,
		//Initialize is fired when the chart is initialized - Data is passed in as a parameter
		//Config is automatically merged by the core of Chart.js, and is available at this.options
		initialize:  function(data){
			this.segments = [];
			//Declare segment class as a chart instance specific class, so it can share props for this instance
			this.SegmentArc = Chart.Arc.extend({
				showStroke : this.options.segmentShowStroke,
				strokeWidth : this.options.segmentStrokeWidth,
				strokeColor : this.options.segmentStrokeColor,
				ctx : this.chart.ctx,
				innerRadius : 0,
				x : this.chart.width/2,
				y : this.chart.height/2
			});
			this.scale = new Chart.RadialScale({
				display: this.options.showScale,
				fontStyle: this.options.scaleFontStyle,
				fontSize: this.options.scaleFontSize,
				fontFamily: this.options.scaleFontFamily,
				fontColor: this.options.scaleFontColor,
				showLabels: this.options.scaleShowLabels,
				showLabelBackdrop: this.options.scaleShowLabelBackdrop,
				backdropColor: this.options.scaleBackdropColor,
				backdropPaddingY : this.options.scaleBackdropPaddingY,
				backdropPaddingX: this.options.scaleBackdropPaddingX,
				lineWidth: (this.options.scaleShowLine) ? this.options.scaleLineWidth : 0,
				lineColor: this.options.scaleLineColor,
				lineArc: true,
				width: this.chart.width,
				height: this.chart.height,
				xCenter: this.chart.width/2,
				yCenter: this.chart.height/2,
				ctx : this.chart.ctx,
				templateString: this.options.scaleLabel,
				valuesCount: data.length
			});

			this.updateScaleRange(data);

			this.scale.update();

			helpers.each(data,function(segment,index){
				this.addData(segment,index,true);
			},this);

			//Set up tooltip events on the chart
			if (this.options.showTooltips){
				helpers.bindEvents(this, this.options.tooltipEvents, function(evt){
					var activeSegments = (evt.type !== 'mouseout') ? this.getSegmentsAtEvent(evt) : [];
					helpers.each(this.segments,function(segment){
						segment.restore(["fillColor"]);
					});
					helpers.each(activeSegments,function(activeSegment){
						activeSegment.fillColor = activeSegment.highlightColor;
					});
					this.showTooltip(activeSegments);
				});
			}

			this.render();
		},
		getSegmentsAtEvent : function(e){
			var segmentsArray = [];

			var location = helpers.getRelativePosition(e);

			helpers.each(this.segments,function(segment){
				if (segment.inRange(location.x,location.y)) segmentsArray.push(segment);
			},this);
			return segmentsArray;
		},
		addData : function(segment, atIndex, silent){
			var index = atIndex || this.segments.length;

			this.segments.splice(index, 0, new this.SegmentArc({
				fillColor: segment.color,
				highlightColor: segment.highlight || segment.color,
				label: segment.label,
				value: segment.value,
				outerRadius: (this.options.animateScale) ? 0 : this.scale.calculateCenterOffset(segment.value),
				circumference: (this.options.animateRotate) ? 0 : this.scale.getCircumference(),
				startAngle: Math.PI * 1.5
			}));
			if (!silent){
				this.reflow();
				this.update();
			}
		},
		removeData: function(atIndex){
			var indexToDelete = (helpers.isNumber(atIndex)) ? atIndex : this.segments.length-1;
			this.segments.splice(indexToDelete, 1);
			this.reflow();
			this.update();
		},
		calculateTotal: function(data){
			this.total = 0;
			helpers.each(data,function(segment){
				this.total += segment.value;
			},this);
			this.scale.valuesCount = this.segments.length;
		},
		updateScaleRange: function(datapoints){
			var valuesArray = [];
			helpers.each(datapoints,function(segment){
				valuesArray.push(segment.value);
			});

			var scaleSizes = (this.options.scaleOverride) ?
				{
					steps: this.options.scaleSteps,
					stepValue: this.options.scaleStepWidth,
					min: this.options.scaleStartValue,
					max: this.options.scaleStartValue + (this.options.scaleSteps * this.options.scaleStepWidth)
				} :
				helpers.calculateScaleRange(
					valuesArray,
					helpers.min([this.chart.width, this.chart.height])/2,
					this.options.scaleFontSize,
					this.options.scaleBeginAtZero,
					this.options.scaleIntegersOnly
				);

			helpers.extend(
				this.scale,
				scaleSizes,
				{
					size: helpers.min([this.chart.width, this.chart.height]),
					xCenter: this.chart.width/2,
					yCenter: this.chart.height/2
				}
			);

		},
		update : function(){
			this.calculateTotal(this.segments);

			helpers.each(this.segments,function(segment){
				segment.save();
			});
			
			this.reflow();
			this.render();
		},
		reflow : function(){
			helpers.extend(this.SegmentArc.prototype,{
				x : this.chart.width/2,
				y : this.chart.height/2
			});
			this.updateScaleRange(this.segments);
			this.scale.update();

			helpers.extend(this.scale,{
				xCenter: this.chart.width/2,
				yCenter: this.chart.height/2
			});

			helpers.each(this.segments, function(segment){
				segment.update({
					outerRadius : this.scale.calculateCenterOffset(segment.value)
				});
			}, this);

		},
		draw : function(ease){
			var easingDecimal = ease || 1;
			//Clear & draw the canvas
			this.clear();
			helpers.each(this.segments,function(segment, index){
				segment.transition({
					circumference : this.scale.getCircumference(),
					outerRadius : this.scale.calculateCenterOffset(segment.value)
				},easingDecimal);

				segment.endAngle = segment.startAngle + segment.circumference;

				// If we've removed the first segment we need to set the first one to
				// start at the top.
				if (index === 0){
					segment.startAngle = Math.PI * 1.5;
				}

				//Check to see if it's the last segment, if not get the next and update the start angle
				if (index < this.segments.length - 1){
					this.segments[index+1].startAngle = segment.endAngle;
				}
				segment.draw();
			}, this);
			this.scale.draw();
		}
	});

}).call(this);

(function(){
	"use strict";

	var root = this,
		Chart = root.Chart,
		helpers = Chart.helpers;



	Chart.Type.extend({
		name: "Radar",
		defaults:{
			//Boolean - Whether to show lines for each scale point
			scaleShowLine : true,

			//Boolean - Whether we show the angle lines out of the radar
			angleShowLineOut : true,

			//Boolean - Whether to show labels on the scale
			scaleShowLabels : false,

			// Boolean - Whether the scale should begin at zero
			scaleBeginAtZero : true,

			//String - Colour of the angle line
			angleLineColor : "rgba(0,0,0,.1)",

			//Number - Pixel width of the angle line
			angleLineWidth : 1,

			//Number - Interval at which to draw angle lines ("every Nth point")
			angleLineInterval: 1,

			//String - Point label font declaration
			pointLabelFontFamily : "'Arial'",

			//String - Point label font weight
			pointLabelFontStyle : "normal",

			//Number - Point label font size in pixels
			pointLabelFontSize : 10,

			//String - Point label font colour
			pointLabelFontColor : "#666",

			//Boolean - Whether to show a dot for each point
			pointDot : true,

			//Number - Radius of each point dot in pixels
			pointDotRadius : 3,

			//Number - Pixel width of point dot stroke
			pointDotStrokeWidth : 1,

			//Number - amount extra to add to the radius to cater for hit detection outside the drawn point
			pointHitDetectionRadius : 20,

			//Boolean - Whether to show a stroke for datasets
			datasetStroke : true,

			//Number - Pixel width of dataset stroke
			datasetStrokeWidth : 2,

			//Boolean - Whether to fill the dataset with a colour
			datasetFill : true,

			//String - A legend template
			legendTemplate : "<ul class=\"<%=name.toLowerCase()%>-legend\"><% for (var i=0; i<datasets.length; i++){%><li><span class=\"<%=name.toLowerCase()%>-legend-icon\" style=\"background-color:<%=datasets[i].strokeColor%>\"></span><span class=\"<%=name.toLowerCase()%>-legend-text\"><%if(datasets[i].label){%><%=datasets[i].label%><%}%></span></li><%}%></ul>"

		},

		initialize: function(data){
			this.PointClass = Chart.Point.extend({
				strokeWidth : this.options.pointDotStrokeWidth,
				radius : this.options.pointDotRadius,
				display: this.options.pointDot,
				hitDetectionRadius : this.options.pointHitDetectionRadius,
				ctx : this.chart.ctx
			});

			this.datasets = [];

			this.buildScale(data);

			//Set up tooltip events on the chart
			if (this.options.showTooltips){
				helpers.bindEvents(this, this.options.tooltipEvents, function(evt){
					var activePointsCollection = (evt.type !== 'mouseout') ? this.getPointsAtEvent(evt) : [];

					this.eachPoints(function(point){
						point.restore(['fillColor', 'strokeColor']);
					});
					helpers.each(activePointsCollection, function(activePoint){
						activePoint.fillColor = activePoint.highlightFill;
						activePoint.strokeColor = activePoint.highlightStroke;
					});

					this.showTooltip(activePointsCollection);
				});
			}

			//Iterate through each of the datasets, and build this into a property of the chart
			helpers.each(data.datasets,function(dataset){

				var datasetObject = {
					label: dataset.label || null,
					fillColor : dataset.fillColor,
					strokeColor : dataset.strokeColor,
					pointColor : dataset.pointColor,
					pointStrokeColor : dataset.pointStrokeColor,
					points : []
				};

				this.datasets.push(datasetObject);

				helpers.each(dataset.data,function(dataPoint,index){
					//Add a new point for each piece of data, passing any required data to draw.
					var pointPosition;
					if (!this.scale.animation){
						pointPosition = this.scale.getPointPosition(index, this.scale.calculateCenterOffset(dataPoint));
					}
					datasetObject.points.push(new this.PointClass({
						value : dataPoint,
						label : data.labels[index],
						datasetLabel: dataset.label,
						x: (this.options.animation) ? this.scale.xCenter : pointPosition.x,
						y: (this.options.animation) ? this.scale.yCenter : pointPosition.y,
						strokeColor : dataset.pointStrokeColor,
						fillColor : dataset.pointColor,
						highlightFill : dataset.pointHighlightFill || dataset.pointColor,
						highlightStroke : dataset.pointHighlightStroke || dataset.pointStrokeColor
					}));
				},this);

			},this);

			this.render();
		},
		eachPoints : function(callback){
			helpers.each(this.datasets,function(dataset){
				helpers.each(dataset.points,callback,this);
			},this);
		},

		getPointsAtEvent : function(evt){
			var mousePosition = helpers.getRelativePosition(evt),
				fromCenter = helpers.getAngleFromPoint({
					x: this.scale.xCenter,
					y: this.scale.yCenter
				}, mousePosition);

			var anglePerIndex = (Math.PI * 2) /this.scale.valuesCount,
				pointIndex = Math.round((fromCenter.angle - Math.PI * 1.5) / anglePerIndex),
				activePointsCollection = [];

			// If we're at the top, make the pointIndex 0 to get the first of the array.
			if (pointIndex >= this.scale.valuesCount || pointIndex < 0){
				pointIndex = 0;
			}

			if (fromCenter.distance <= this.scale.drawingArea){
				helpers.each(this.datasets, function(dataset){
					activePointsCollection.push(dataset.points[pointIndex]);
				});
			}

			return activePointsCollection;
		},

		buildScale : function(data){
			this.scale = new Chart.RadialScale({
				display: this.options.showScale,
				fontStyle: this.options.scaleFontStyle,
				fontSize: this.options.scaleFontSize,
				fontFamily: this.options.scaleFontFamily,
				fontColor: this.options.scaleFontColor,
				showLabels: this.options.scaleShowLabels,
				showLabelBackdrop: this.options.scaleShowLabelBackdrop,
				backdropColor: this.options.scaleBackdropColor,
				backgroundColors: this.options.scaleBackgroundColors,
				backdropPaddingY : this.options.scaleBackdropPaddingY,
				backdropPaddingX: this.options.scaleBackdropPaddingX,
				lineWidth: (this.options.scaleShowLine) ? this.options.scaleLineWidth : 0,
				lineColor: this.options.scaleLineColor,
				angleLineColor : this.options.angleLineColor,
				angleLineWidth : (this.options.angleShowLineOut) ? this.options.angleLineWidth : 0,
        angleLineInterval: (this.options.angleLineInterval) ? this.options.angleLineInterval : 1,
				// Point labels at the edge of each line
				pointLabelFontColor : this.options.pointLabelFontColor,
				pointLabelFontSize : this.options.pointLabelFontSize,
				pointLabelFontFamily : this.options.pointLabelFontFamily,
				pointLabelFontStyle : this.options.pointLabelFontStyle,
				height : this.chart.height,
				width: this.chart.width,
				xCenter: this.chart.width/2,
				yCenter: this.chart.height/2,
				ctx : this.chart.ctx,
				templateString: this.options.scaleLabel,
				labels: data.labels,
				valuesCount: data.datasets[0].data.length
			});

			this.scale.setScaleSize();
			this.updateScaleRange(data.datasets);
			this.scale.buildYLabels();
		},
		updateScaleRange: function(datasets){
			var valuesArray = (function(){
				var totalDataArray = [];
				helpers.each(datasets,function(dataset){
					if (dataset.data){
						totalDataArray = totalDataArray.concat(dataset.data);
					}
					else {
						helpers.each(dataset.points, function(point){
							totalDataArray.push(point.value);
						});
					}
				});
				return totalDataArray;
			})();


			var scaleSizes = (this.options.scaleOverride) ?
				{
					steps: this.options.scaleSteps,
					stepValue: this.options.scaleStepWidth,
					min: this.options.scaleStartValue,
					max: this.options.scaleStartValue + (this.options.scaleSteps * this.options.scaleStepWidth)
				} :
				helpers.calculateScaleRange(
					valuesArray,
					helpers.min([this.chart.width, this.chart.height])/2,
					this.options.scaleFontSize,
					this.options.scaleBeginAtZero,
					this.options.scaleIntegersOnly
				);

			helpers.extend(
				this.scale,
				scaleSizes
			);

		},
		addData : function(valuesArray,label){
			//Map the values array for each of the datasets
			this.scale.valuesCount++;
			helpers.each(valuesArray,function(value,datasetIndex){
				var pointPosition = this.scale.getPointPosition(this.scale.valuesCount, this.scale.calculateCenterOffset(value));
				this.datasets[datasetIndex].points.push(new this.PointClass({
					value : value,
					label : label,
					datasetLabel: this.datasets[datasetIndex].label,
					x: pointPosition.x,
					y: pointPosition.y,
					strokeColor : this.datasets[datasetIndex].pointStrokeColor,
					fillColor : this.datasets[datasetIndex].pointColor
				}));
			},this);

			this.scale.labels.push(label);

			this.reflow();

			this.update();
		},
		removeData : function(){
			this.scale.valuesCount--;
			this.scale.labels.shift();
			helpers.each(this.datasets,function(dataset){
				dataset.points.shift();
			},this);
			this.reflow();
			this.update();
		},
		update : function(){
			this.eachPoints(function(point){
				point.save();
			});
			this.reflow();
			this.render();
		},
		reflow: function(){
			helpers.extend(this.scale, {
				width : this.chart.width,
				height: this.chart.height,
				size : helpers.min([this.chart.width, this.chart.height]),
				xCenter: this.chart.width/2,
				yCenter: this.chart.height/2
			});
			this.updateScaleRange(this.datasets);
			this.scale.setScaleSize();
			this.scale.buildYLabels();
		},
		draw : function(ease){
			var easeDecimal = ease || 1,
				ctx = this.chart.ctx;
			this.clear();
			this.scale.draw();

			helpers.each(this.datasets,function(dataset){

				//Transition each point first so that the line and point drawing isn't out of sync
				helpers.each(dataset.points,function(point,index){
					if (point.hasValue()){
						point.transition(this.scale.getPointPosition(index, this.scale.calculateCenterOffset(point.value)), easeDecimal);
					}
				},this);



				//Draw the line between all the points
				ctx.lineWidth = this.options.datasetStrokeWidth;
				ctx.strokeStyle = dataset.strokeColor;
				ctx.beginPath();
				helpers.each(dataset.points,function(point,index){
					if (index === 0){
						ctx.moveTo(point.x,point.y);
					}
					else{
						ctx.lineTo(point.x,point.y);
					}
				},this);
				ctx.closePath();
				ctx.stroke();

				ctx.fillStyle = dataset.fillColor;
				if(this.options.datasetFill){
					ctx.fill();
				}
				//Now draw the points over the line
				//A little inefficient double looping, but better than the line
				//lagging behind the point positions
				helpers.each(dataset.points,function(point){
					if (point.hasValue()){
						point.draw();
					}
				});

			},this);

		}

	});





}).call(this);

},{}],47:[function(require,module,exports){
/*!
 * jQuery UI :data 1.12.1
 * http://jqueryui.com
 *
 * Copyright jQuery Foundation and other contributors
 * Released under the MIT license.
 * http://jquery.org/license
 */

//>>label: :data Selector
//>>group: Core
//>>description: Selects elements which have data stored under the specified key.
//>>docs: http://api.jqueryui.com/data-selector/

( function( factory ) {
	if ( typeof define === "function" && define.amd ) {

		// AMD. Register as an anonymous module.
		define( [ "jquery", "./version" ], factory );
	} else {

		// Browser globals
		factory( jQuery );
	}
} ( function( $ ) {
return $.extend( $.expr[ ":" ], {
	data: $.expr.createPseudo ?
		$.expr.createPseudo( function( dataName ) {
			return function( elem ) {
				return !!$.data( elem, dataName );
			};
		} ) :

		// Support: jQuery <1.8
		function( elem, i, match ) {
			return !!$.data( elem, match[ 3 ] );
		}
} );
} ) );

},{}],48:[function(require,module,exports){
/*!
 * jQuery UI Disable Selection 1.12.1
 * http://jqueryui.com
 *
 * Copyright jQuery Foundation and other contributors
 * Released under the MIT license.
 * http://jquery.org/license
 */

//>>label: disableSelection
//>>group: Core
//>>description: Disable selection of text content within the set of matched elements.
//>>docs: http://api.jqueryui.com/disableSelection/

// This file is deprecated
( function( factory ) {
	if ( typeof define === "function" && define.amd ) {

		// AMD. Register as an anonymous module.
		define( [ "jquery", "./version" ], factory );
	} else {

		// Browser globals
		factory( jQuery );
	}
} ( function( $ ) {

return $.fn.extend( {
	disableSelection: ( function() {
		var eventType = "onselectstart" in document.createElement( "div" ) ?
			"selectstart" :
			"mousedown";

		return function() {
			return this.on( eventType + ".ui-disableSelection", function( event ) {
				event.preventDefault();
			} );
		};
	} )(),

	enableSelection: function() {
		return this.off( ".ui-disableSelection" );
	}
} );

} ) );

},{}],49:[function(require,module,exports){
/*!
 * jQuery UI Focusable 1.12.1
 * http://jqueryui.com
 *
 * Copyright jQuery Foundation and other contributors
 * Released under the MIT license.
 * http://jquery.org/license
 */

//>>label: :focusable Selector
//>>group: Core
//>>description: Selects elements which can be focused.
//>>docs: http://api.jqueryui.com/focusable-selector/

( function( factory ) {
	if ( typeof define === "function" && define.amd ) {

		// AMD. Register as an anonymous module.
		define( [ "jquery", "./version" ], factory );
	} else {

		// Browser globals
		factory( jQuery );
	}
} ( function( $ ) {

// Selectors
$.ui.focusable = function( element, hasTabindex ) {
	var map, mapName, img, focusableIfVisible, fieldset,
		nodeName = element.nodeName.toLowerCase();

	if ( "area" === nodeName ) {
		map = element.parentNode;
		mapName = map.name;
		if ( !element.href || !mapName || map.nodeName.toLowerCase() !== "map" ) {
			return false;
		}
		img = $( "img[usemap='#" + mapName + "']" );
		return img.length > 0 && img.is( ":visible" );
	}

	if ( /^(input|select|textarea|button|object)$/.test( nodeName ) ) {
		focusableIfVisible = !element.disabled;

		if ( focusableIfVisible ) {

			// Form controls within a disabled fieldset are disabled.
			// However, controls within the fieldset's legend do not get disabled.
			// Since controls generally aren't placed inside legends, we skip
			// this portion of the check.
			fieldset = $( element ).closest( "fieldset" )[ 0 ];
			if ( fieldset ) {
				focusableIfVisible = !fieldset.disabled;
			}
		}
	} else if ( "a" === nodeName ) {
		focusableIfVisible = element.href || hasTabindex;
	} else {
		focusableIfVisible = hasTabindex;
	}

	return focusableIfVisible && $( element ).is( ":visible" ) && visible( $( element ) );
};

// Support: IE 8 only
// IE 8 doesn't resolve inherit to visible/hidden for computed values
function visible( element ) {
	var visibility = element.css( "visibility" );
	while ( visibility === "inherit" ) {
		element = element.parent();
		visibility = element.css( "visibility" );
	}
	return visibility !== "hidden";
}

$.extend( $.expr[ ":" ], {
	focusable: function( element ) {
		return $.ui.focusable( element, $.attr( element, "tabindex" ) != null );
	}
} );

return $.ui.focusable;

} ) );

},{}],50:[function(require,module,exports){
( function( factory ) {
	if ( typeof define === "function" && define.amd ) {

		// AMD. Register as an anonymous module.
		define( [ "jquery", "./version" ], factory );
	} else {

		// Browser globals
		factory( jQuery );
	}
} ( function( $ ) {

// This file is deprecated
return $.ui.ie = !!/msie [\w.]+/.exec( navigator.userAgent.toLowerCase() );
} ) );

},{}],51:[function(require,module,exports){
/*!
 * jQuery UI Keycode 1.12.1
 * http://jqueryui.com
 *
 * Copyright jQuery Foundation and other contributors
 * Released under the MIT license.
 * http://jquery.org/license
 */

//>>label: Keycode
//>>group: Core
//>>description: Provide keycodes as keynames
//>>docs: http://api.jqueryui.com/jQuery.ui.keyCode/

( function( factory ) {
	if ( typeof define === "function" && define.amd ) {

		// AMD. Register as an anonymous module.
		define( [ "jquery", "./version" ], factory );
	} else {

		// Browser globals
		factory( jQuery );
	}
} ( function( $ ) {
return $.ui.keyCode = {
	BACKSPACE: 8,
	COMMA: 188,
	DELETE: 46,
	DOWN: 40,
	END: 35,
	ENTER: 13,
	ESCAPE: 27,
	HOME: 36,
	LEFT: 37,
	PAGE_DOWN: 34,
	PAGE_UP: 33,
	PERIOD: 190,
	RIGHT: 39,
	SPACE: 32,
	TAB: 9,
	UP: 38
};

} ) );

},{}],52:[function(require,module,exports){
( function( factory ) {
	if ( typeof define === "function" && define.amd ) {

		// AMD. Register as an anonymous module.
		define( [ "jquery", "./version" ], factory );
	} else {

		// Browser globals
		factory( jQuery );
	}
} ( function( $ ) {

// $.ui.plugin is deprecated. Use $.widget() extensions instead.
return $.ui.plugin = {
	add: function( module, option, set ) {
		var i,
			proto = $.ui[ module ].prototype;
		for ( i in set ) {
			proto.plugins[ i ] = proto.plugins[ i ] || [];
			proto.plugins[ i ].push( [ option, set[ i ] ] );
		}
	},
	call: function( instance, name, args, allowDisconnected ) {
		var i,
			set = instance.plugins[ name ];

		if ( !set ) {
			return;
		}

		if ( !allowDisconnected && ( !instance.element[ 0 ].parentNode ||
				instance.element[ 0 ].parentNode.nodeType === 11 ) ) {
			return;
		}

		for ( i = 0; i < set.length; i++ ) {
			if ( instance.options[ set[ i ][ 0 ] ] ) {
				set[ i ][ 1 ].apply( instance.element, args );
			}
		}
	}
};

} ) );

},{}],53:[function(require,module,exports){
/*!
 * jQuery UI Position 1.12.1
 * http://jqueryui.com
 *
 * Copyright jQuery Foundation and other contributors
 * Released under the MIT license.
 * http://jquery.org/license
 *
 * http://api.jqueryui.com/position/
 */

//>>label: Position
//>>group: Core
//>>description: Positions elements relative to other elements.
//>>docs: http://api.jqueryui.com/position/
//>>demos: http://jqueryui.com/position/

( function( factory ) {
	if ( typeof define === "function" && define.amd ) {

		// AMD. Register as an anonymous module.
		define( [ "jquery", "./version" ], factory );
	} else {

		// Browser globals
		factory( jQuery );
	}
}( function( $ ) {
( function() {
var cachedScrollbarWidth,
	max = Math.max,
	abs = Math.abs,
	rhorizontal = /left|center|right/,
	rvertical = /top|center|bottom/,
	roffset = /[\+\-]\d+(\.[\d]+)?%?/,
	rposition = /^\w+/,
	rpercent = /%$/,
	_position = $.fn.position;

function getOffsets( offsets, width, height ) {
	return [
		parseFloat( offsets[ 0 ] ) * ( rpercent.test( offsets[ 0 ] ) ? width / 100 : 1 ),
		parseFloat( offsets[ 1 ] ) * ( rpercent.test( offsets[ 1 ] ) ? height / 100 : 1 )
	];
}

function parseCss( element, property ) {
	return parseInt( $.css( element, property ), 10 ) || 0;
}

function getDimensions( elem ) {
	var raw = elem[ 0 ];
	if ( raw.nodeType === 9 ) {
		return {
			width: elem.width(),
			height: elem.height(),
			offset: { top: 0, left: 0 }
		};
	}
	if ( $.isWindow( raw ) ) {
		return {
			width: elem.width(),
			height: elem.height(),
			offset: { top: elem.scrollTop(), left: elem.scrollLeft() }
		};
	}
	if ( raw.preventDefault ) {
		return {
			width: 0,
			height: 0,
			offset: { top: raw.pageY, left: raw.pageX }
		};
	}
	return {
		width: elem.outerWidth(),
		height: elem.outerHeight(),
		offset: elem.offset()
	};
}

$.position = {
	scrollbarWidth: function() {
		if ( cachedScrollbarWidth !== undefined ) {
			return cachedScrollbarWidth;
		}
		var w1, w2,
			div = $( "<div " +
				"style='display:block;position:absolute;width:50px;height:50px;overflow:hidden;'>" +
				"<div style='height:100px;width:auto;'></div></div>" ),
			innerDiv = div.children()[ 0 ];

		$( "body" ).append( div );
		w1 = innerDiv.offsetWidth;
		div.css( "overflow", "scroll" );

		w2 = innerDiv.offsetWidth;

		if ( w1 === w2 ) {
			w2 = div[ 0 ].clientWidth;
		}

		div.remove();

		return ( cachedScrollbarWidth = w1 - w2 );
	},
	getScrollInfo: function( within ) {
		var overflowX = within.isWindow || within.isDocument ? "" :
				within.element.css( "overflow-x" ),
			overflowY = within.isWindow || within.isDocument ? "" :
				within.element.css( "overflow-y" ),
			hasOverflowX = overflowX === "scroll" ||
				( overflowX === "auto" && within.width < within.element[ 0 ].scrollWidth ),
			hasOverflowY = overflowY === "scroll" ||
				( overflowY === "auto" && within.height < within.element[ 0 ].scrollHeight );
		return {
			width: hasOverflowY ? $.position.scrollbarWidth() : 0,
			height: hasOverflowX ? $.position.scrollbarWidth() : 0
		};
	},
	getWithinInfo: function( element ) {
		var withinElement = $( element || window ),
			isWindow = $.isWindow( withinElement[ 0 ] ),
			isDocument = !!withinElement[ 0 ] && withinElement[ 0 ].nodeType === 9,
			hasOffset = !isWindow && !isDocument;
		return {
			element: withinElement,
			isWindow: isWindow,
			isDocument: isDocument,
			offset: hasOffset ? $( element ).offset() : { left: 0, top: 0 },
			scrollLeft: withinElement.scrollLeft(),
			scrollTop: withinElement.scrollTop(),
			width: withinElement.outerWidth(),
			height: withinElement.outerHeight()
		};
	}
};

$.fn.position = function( options ) {
	if ( !options || !options.of ) {
		return _position.apply( this, arguments );
	}

	// Make a copy, we don't want to modify arguments
	options = $.extend( {}, options );

	var atOffset, targetWidth, targetHeight, targetOffset, basePosition, dimensions,
		target = $( options.of ),
		within = $.position.getWithinInfo( options.within ),
		scrollInfo = $.position.getScrollInfo( within ),
		collision = ( options.collision || "flip" ).split( " " ),
		offsets = {};

	dimensions = getDimensions( target );
	if ( target[ 0 ].preventDefault ) {

		// Force left top to allow flipping
		options.at = "left top";
	}
	targetWidth = dimensions.width;
	targetHeight = dimensions.height;
	targetOffset = dimensions.offset;

	// Clone to reuse original targetOffset later
	basePosition = $.extend( {}, targetOffset );

	// Force my and at to have valid horizontal and vertical positions
	// if a value is missing or invalid, it will be converted to center
	$.each( [ "my", "at" ], function() {
		var pos = ( options[ this ] || "" ).split( " " ),
			horizontalOffset,
			verticalOffset;

		if ( pos.length === 1 ) {
			pos = rhorizontal.test( pos[ 0 ] ) ?
				pos.concat( [ "center" ] ) :
				rvertical.test( pos[ 0 ] ) ?
					[ "center" ].concat( pos ) :
					[ "center", "center" ];
		}
		pos[ 0 ] = rhorizontal.test( pos[ 0 ] ) ? pos[ 0 ] : "center";
		pos[ 1 ] = rvertical.test( pos[ 1 ] ) ? pos[ 1 ] : "center";

		// Calculate offsets
		horizontalOffset = roffset.exec( pos[ 0 ] );
		verticalOffset = roffset.exec( pos[ 1 ] );
		offsets[ this ] = [
			horizontalOffset ? horizontalOffset[ 0 ] : 0,
			verticalOffset ? verticalOffset[ 0 ] : 0
		];

		// Reduce to just the positions without the offsets
		options[ this ] = [
			rposition.exec( pos[ 0 ] )[ 0 ],
			rposition.exec( pos[ 1 ] )[ 0 ]
		];
	} );

	// Normalize collision option
	if ( collision.length === 1 ) {
		collision[ 1 ] = collision[ 0 ];
	}

	if ( options.at[ 0 ] === "right" ) {
		basePosition.left += targetWidth;
	} else if ( options.at[ 0 ] === "center" ) {
		basePosition.left += targetWidth / 2;
	}

	if ( options.at[ 1 ] === "bottom" ) {
		basePosition.top += targetHeight;
	} else if ( options.at[ 1 ] === "center" ) {
		basePosition.top += targetHeight / 2;
	}

	atOffset = getOffsets( offsets.at, targetWidth, targetHeight );
	basePosition.left += atOffset[ 0 ];
	basePosition.top += atOffset[ 1 ];

	return this.each( function() {
		var collisionPosition, using,
			elem = $( this ),
			elemWidth = elem.outerWidth(),
			elemHeight = elem.outerHeight(),
			marginLeft = parseCss( this, "marginLeft" ),
			marginTop = parseCss( this, "marginTop" ),
			collisionWidth = elemWidth + marginLeft + parseCss( this, "marginRight" ) +
				scrollInfo.width,
			collisionHeight = elemHeight + marginTop + parseCss( this, "marginBottom" ) +
				scrollInfo.height,
			position = $.extend( {}, basePosition ),
			myOffset = getOffsets( offsets.my, elem.outerWidth(), elem.outerHeight() );

		if ( options.my[ 0 ] === "right" ) {
			position.left -= elemWidth;
		} else if ( options.my[ 0 ] === "center" ) {
			position.left -= elemWidth / 2;
		}

		if ( options.my[ 1 ] === "bottom" ) {
			position.top -= elemHeight;
		} else if ( options.my[ 1 ] === "center" ) {
			position.top -= elemHeight / 2;
		}

		position.left += myOffset[ 0 ];
		position.top += myOffset[ 1 ];

		collisionPosition = {
			marginLeft: marginLeft,
			marginTop: marginTop
		};

		$.each( [ "left", "top" ], function( i, dir ) {
			if ( $.ui.position[ collision[ i ] ] ) {
				$.ui.position[ collision[ i ] ][ dir ]( position, {
					targetWidth: targetWidth,
					targetHeight: targetHeight,
					elemWidth: elemWidth,
					elemHeight: elemHeight,
					collisionPosition: collisionPosition,
					collisionWidth: collisionWidth,
					collisionHeight: collisionHeight,
					offset: [ atOffset[ 0 ] + myOffset[ 0 ], atOffset [ 1 ] + myOffset[ 1 ] ],
					my: options.my,
					at: options.at,
					within: within,
					elem: elem
				} );
			}
		} );

		if ( options.using ) {

			// Adds feedback as second argument to using callback, if present
			using = function( props ) {
				var left = targetOffset.left - position.left,
					right = left + targetWidth - elemWidth,
					top = targetOffset.top - position.top,
					bottom = top + targetHeight - elemHeight,
					feedback = {
						target: {
							element: target,
							left: targetOffset.left,
							top: targetOffset.top,
							width: targetWidth,
							height: targetHeight
						},
						element: {
							element: elem,
							left: position.left,
							top: position.top,
							width: elemWidth,
							height: elemHeight
						},
						horizontal: right < 0 ? "left" : left > 0 ? "right" : "center",
						vertical: bottom < 0 ? "top" : top > 0 ? "bottom" : "middle"
					};
				if ( targetWidth < elemWidth && abs( left + right ) < targetWidth ) {
					feedback.horizontal = "center";
				}
				if ( targetHeight < elemHeight && abs( top + bottom ) < targetHeight ) {
					feedback.vertical = "middle";
				}
				if ( max( abs( left ), abs( right ) ) > max( abs( top ), abs( bottom ) ) ) {
					feedback.important = "horizontal";
				} else {
					feedback.important = "vertical";
				}
				options.using.call( this, props, feedback );
			};
		}

		elem.offset( $.extend( position, { using: using } ) );
	} );
};

$.ui.position = {
	fit: {
		left: function( position, data ) {
			var within = data.within,
				withinOffset = within.isWindow ? within.scrollLeft : within.offset.left,
				outerWidth = within.width,
				collisionPosLeft = position.left - data.collisionPosition.marginLeft,
				overLeft = withinOffset - collisionPosLeft,
				overRight = collisionPosLeft + data.collisionWidth - outerWidth - withinOffset,
				newOverRight;

			// Element is wider than within
			if ( data.collisionWidth > outerWidth ) {

				// Element is initially over the left side of within
				if ( overLeft > 0 && overRight <= 0 ) {
					newOverRight = position.left + overLeft + data.collisionWidth - outerWidth -
						withinOffset;
					position.left += overLeft - newOverRight;

				// Element is initially over right side of within
				} else if ( overRight > 0 && overLeft <= 0 ) {
					position.left = withinOffset;

				// Element is initially over both left and right sides of within
				} else {
					if ( overLeft > overRight ) {
						position.left = withinOffset + outerWidth - data.collisionWidth;
					} else {
						position.left = withinOffset;
					}
				}

			// Too far left -> align with left edge
			} else if ( overLeft > 0 ) {
				position.left += overLeft;

			// Too far right -> align with right edge
			} else if ( overRight > 0 ) {
				position.left -= overRight;

			// Adjust based on position and margin
			} else {
				position.left = max( position.left - collisionPosLeft, position.left );
			}
		},
		top: function( position, data ) {
			var within = data.within,
				withinOffset = within.isWindow ? within.scrollTop : within.offset.top,
				outerHeight = data.within.height,
				collisionPosTop = position.top - data.collisionPosition.marginTop,
				overTop = withinOffset - collisionPosTop,
				overBottom = collisionPosTop + data.collisionHeight - outerHeight - withinOffset,
				newOverBottom;

			// Element is taller than within
			if ( data.collisionHeight > outerHeight ) {

				// Element is initially over the top of within
				if ( overTop > 0 && overBottom <= 0 ) {
					newOverBottom = position.top + overTop + data.collisionHeight - outerHeight -
						withinOffset;
					position.top += overTop - newOverBottom;

				// Element is initially over bottom of within
				} else if ( overBottom > 0 && overTop <= 0 ) {
					position.top = withinOffset;

				// Element is initially over both top and bottom of within
				} else {
					if ( overTop > overBottom ) {
						position.top = withinOffset + outerHeight - data.collisionHeight;
					} else {
						position.top = withinOffset;
					}
				}

			// Too far up -> align with top
			} else if ( overTop > 0 ) {
				position.top += overTop;

			// Too far down -> align with bottom edge
			} else if ( overBottom > 0 ) {
				position.top -= overBottom;

			// Adjust based on position and margin
			} else {
				position.top = max( position.top - collisionPosTop, position.top );
			}
		}
	},
	flip: {
		left: function( position, data ) {
			var within = data.within,
				withinOffset = within.offset.left + within.scrollLeft,
				outerWidth = within.width,
				offsetLeft = within.isWindow ? within.scrollLeft : within.offset.left,
				collisionPosLeft = position.left - data.collisionPosition.marginLeft,
				overLeft = collisionPosLeft - offsetLeft,
				overRight = collisionPosLeft + data.collisionWidth - outerWidth - offsetLeft,
				myOffset = data.my[ 0 ] === "left" ?
					-data.elemWidth :
					data.my[ 0 ] === "right" ?
						data.elemWidth :
						0,
				atOffset = data.at[ 0 ] === "left" ?
					data.targetWidth :
					data.at[ 0 ] === "right" ?
						-data.targetWidth :
						0,
				offset = -2 * data.offset[ 0 ],
				newOverRight,
				newOverLeft;

			if ( overLeft < 0 ) {
				newOverRight = position.left + myOffset + atOffset + offset + data.collisionWidth -
					outerWidth - withinOffset;
				if ( newOverRight < 0 || newOverRight < abs( overLeft ) ) {
					position.left += myOffset + atOffset + offset;
				}
			} else if ( overRight > 0 ) {
				newOverLeft = position.left - data.collisionPosition.marginLeft + myOffset +
					atOffset + offset - offsetLeft;
				if ( newOverLeft > 0 || abs( newOverLeft ) < overRight ) {
					position.left += myOffset + atOffset + offset;
				}
			}
		},
		top: function( position, data ) {
			var within = data.within,
				withinOffset = within.offset.top + within.scrollTop,
				outerHeight = within.height,
				offsetTop = within.isWindow ? within.scrollTop : within.offset.top,
				collisionPosTop = position.top - data.collisionPosition.marginTop,
				overTop = collisionPosTop - offsetTop,
				overBottom = collisionPosTop + data.collisionHeight - outerHeight - offsetTop,
				top = data.my[ 1 ] === "top",
				myOffset = top ?
					-data.elemHeight :
					data.my[ 1 ] === "bottom" ?
						data.elemHeight :
						0,
				atOffset = data.at[ 1 ] === "top" ?
					data.targetHeight :
					data.at[ 1 ] === "bottom" ?
						-data.targetHeight :
						0,
				offset = -2 * data.offset[ 1 ],
				newOverTop,
				newOverBottom;
			if ( overTop < 0 ) {
				newOverBottom = position.top + myOffset + atOffset + offset + data.collisionHeight -
					outerHeight - withinOffset;
				if ( newOverBottom < 0 || newOverBottom < abs( overTop ) ) {
					position.top += myOffset + atOffset + offset;
				}
			} else if ( overBottom > 0 ) {
				newOverTop = position.top - data.collisionPosition.marginTop + myOffset + atOffset +
					offset - offsetTop;
				if ( newOverTop > 0 || abs( newOverTop ) < overBottom ) {
					position.top += myOffset + atOffset + offset;
				}
			}
		}
	},
	flipfit: {
		left: function() {
			$.ui.position.flip.left.apply( this, arguments );
			$.ui.position.fit.left.apply( this, arguments );
		},
		top: function() {
			$.ui.position.flip.top.apply( this, arguments );
			$.ui.position.fit.top.apply( this, arguments );
		}
	}
};

} )();

return $.ui.position;

} ) );

},{}],54:[function(require,module,exports){
( function( factory ) {
	if ( typeof define === "function" && define.amd ) {

		// AMD. Register as an anonymous module.
		define( [ "jquery", "./version" ], factory );
	} else {

		// Browser globals
		factory( jQuery );
	}
} ( function( $ ) {
return $.ui.safeActiveElement = function( document ) {
	var activeElement;

	// Support: IE 9 only
	// IE9 throws an "Unspecified error" accessing document.activeElement from an <iframe>
	try {
		activeElement = document.activeElement;
	} catch ( error ) {
		activeElement = document.body;
	}

	// Support: IE 9 - 11 only
	// IE may return null instead of an element
	// Interestingly, this only seems to occur when NOT in an iframe
	if ( !activeElement ) {
		activeElement = document.body;
	}

	// Support: IE 11 only
	// IE11 returns a seemingly empty object in some cases when accessing
	// document.activeElement from an <iframe>
	if ( !activeElement.nodeName ) {
		activeElement = document.body;
	}

	return activeElement;
};

} ) );

},{}],55:[function(require,module,exports){
( function( factory ) {
	if ( typeof define === "function" && define.amd ) {

		// AMD. Register as an anonymous module.
		define( [ "jquery", "./version" ], factory );
	} else {

		// Browser globals
		factory( jQuery );
	}
} ( function( $ ) {
return $.ui.safeBlur = function( element ) {

	// Support: IE9 - 10 only
	// If the <body> is blurred, IE will switch windows, see #9420
	if ( element && element.nodeName.toLowerCase() !== "body" ) {
		$( element ).trigger( "blur" );
	}
};

} ) );

},{}],56:[function(require,module,exports){
/*!
 * jQuery UI Scroll Parent 1.12.1
 * http://jqueryui.com
 *
 * Copyright jQuery Foundation and other contributors
 * Released under the MIT license.
 * http://jquery.org/license
 */

//>>label: scrollParent
//>>group: Core
//>>description: Get the closest ancestor element that is scrollable.
//>>docs: http://api.jqueryui.com/scrollParent/

( function( factory ) {
	if ( typeof define === "function" && define.amd ) {

		// AMD. Register as an anonymous module.
		define( [ "jquery", "./version" ], factory );
	} else {

		// Browser globals
		factory( jQuery );
	}
} ( function( $ ) {

return $.fn.scrollParent = function( includeHidden ) {
	var position = this.css( "position" ),
		excludeStaticParent = position === "absolute",
		overflowRegex = includeHidden ? /(auto|scroll|hidden)/ : /(auto|scroll)/,
		scrollParent = this.parents().filter( function() {
			var parent = $( this );
			if ( excludeStaticParent && parent.css( "position" ) === "static" ) {
				return false;
			}
			return overflowRegex.test( parent.css( "overflow" ) + parent.css( "overflow-y" ) +
				parent.css( "overflow-x" ) );
		} ).eq( 0 );

	return position === "fixed" || !scrollParent.length ?
		$( this[ 0 ].ownerDocument || document ) :
		scrollParent;
};

} ) );

},{}],57:[function(require,module,exports){
/*!
 * jQuery UI Tabbable 1.12.1
 * http://jqueryui.com
 *
 * Copyright jQuery Foundation and other contributors
 * Released under the MIT license.
 * http://jquery.org/license
 */

//>>label: :tabbable Selector
//>>group: Core
//>>description: Selects elements which can be tabbed to.
//>>docs: http://api.jqueryui.com/tabbable-selector/

( function( factory ) {
	if ( typeof define === "function" && define.amd ) {

		// AMD. Register as an anonymous module.
		define( [ "jquery", "./version", "./focusable" ], factory );
	} else {

		// Browser globals
		factory( jQuery );
	}
} ( function( $ ) {

return $.extend( $.expr[ ":" ], {
	tabbable: function( element ) {
		var tabIndex = $.attr( element, "tabindex" ),
			hasTabindex = tabIndex != null;
		return ( !hasTabindex || tabIndex >= 0 ) && $.ui.focusable( element, hasTabindex );
	}
} );

} ) );

},{}],58:[function(require,module,exports){
/*!
 * jQuery UI Unique ID 1.12.1
 * http://jqueryui.com
 *
 * Copyright jQuery Foundation and other contributors
 * Released under the MIT license.
 * http://jquery.org/license
 */

//>>label: uniqueId
//>>group: Core
//>>description: Functions to generate and remove uniqueId's
//>>docs: http://api.jqueryui.com/uniqueId/

( function( factory ) {
	if ( typeof define === "function" && define.amd ) {

		// AMD. Register as an anonymous module.
		define( [ "jquery", "./version" ], factory );
	} else {

		// Browser globals
		factory( jQuery );
	}
} ( function( $ ) {

return $.fn.extend( {
	uniqueId: ( function() {
		var uuid = 0;

		return function() {
			return this.each( function() {
				if ( !this.id ) {
					this.id = "ui-id-" + ( ++uuid );
				}
			} );
		};
	} )(),

	removeUniqueId: function() {
		return this.each( function() {
			if ( /^ui-id-\d+$/.test( this.id ) ) {
				$( this ).removeAttr( "id" );
			}
		} );
	}
} );

} ) );

},{}],59:[function(require,module,exports){
( function( factory ) {
	if ( typeof define === "function" && define.amd ) {

		// AMD. Register as an anonymous module.
		define( [ "jquery" ], factory );
	} else {

		// Browser globals
		factory( jQuery );
	}
} ( function( $ ) {

$.ui = $.ui || {};

return $.ui.version = "1.12.1";

} ) );

},{}],60:[function(require,module,exports){
/*!
 * jQuery UI Widget 1.12.1
 * http://jqueryui.com
 *
 * Copyright jQuery Foundation and other contributors
 * Released under the MIT license.
 * http://jquery.org/license
 */

//>>label: Widget
//>>group: Core
//>>description: Provides a factory for creating stateful widgets with a common API.
//>>docs: http://api.jqueryui.com/jQuery.widget/
//>>demos: http://jqueryui.com/widget/

( function( factory ) {
	if ( typeof define === "function" && define.amd ) {

		// AMD. Register as an anonymous module.
		define( [ "jquery", "./version" ], factory );
	} else {

		// Browser globals
		factory( jQuery );
	}
}( function( $ ) {

var widgetUuid = 0;
var widgetSlice = Array.prototype.slice;

$.cleanData = ( function( orig ) {
	return function( elems ) {
		var events, elem, i;
		for ( i = 0; ( elem = elems[ i ] ) != null; i++ ) {
			try {

				// Only trigger remove when necessary to save time
				events = $._data( elem, "events" );
				if ( events && events.remove ) {
					$( elem ).triggerHandler( "remove" );
				}

			// Http://bugs.jquery.com/ticket/8235
			} catch ( e ) {}
		}
		orig( elems );
	};
} )( $.cleanData );

$.widget = function( name, base, prototype ) {
	var existingConstructor, constructor, basePrototype;

	// ProxiedPrototype allows the provided prototype to remain unmodified
	// so that it can be used as a mixin for multiple widgets (#8876)
	var proxiedPrototype = {};

	var namespace = name.split( "." )[ 0 ];
	name = name.split( "." )[ 1 ];
	var fullName = namespace + "-" + name;

	if ( !prototype ) {
		prototype = base;
		base = $.Widget;
	}

	if ( $.isArray( prototype ) ) {
		prototype = $.extend.apply( null, [ {} ].concat( prototype ) );
	}

	// Create selector for plugin
	$.expr[ ":" ][ fullName.toLowerCase() ] = function( elem ) {
		return !!$.data( elem, fullName );
	};

	$[ namespace ] = $[ namespace ] || {};
	existingConstructor = $[ namespace ][ name ];
	constructor = $[ namespace ][ name ] = function( options, element ) {

		// Allow instantiation without "new" keyword
		if ( !this._createWidget ) {
			return new constructor( options, element );
		}

		// Allow instantiation without initializing for simple inheritance
		// must use "new" keyword (the code above always passes args)
		if ( arguments.length ) {
			this._createWidget( options, element );
		}
	};

	// Extend with the existing constructor to carry over any static properties
	$.extend( constructor, existingConstructor, {
		version: prototype.version,

		// Copy the object used to create the prototype in case we need to
		// redefine the widget later
		_proto: $.extend( {}, prototype ),

		// Track widgets that inherit from this widget in case this widget is
		// redefined after a widget inherits from it
		_childConstructors: []
	} );

	basePrototype = new base();

	// We need to make the options hash a property directly on the new instance
	// otherwise we'll modify the options hash on the prototype that we're
	// inheriting from
	basePrototype.options = $.widget.extend( {}, basePrototype.options );
	$.each( prototype, function( prop, value ) {
		if ( !$.isFunction( value ) ) {
			proxiedPrototype[ prop ] = value;
			return;
		}
		proxiedPrototype[ prop ] = ( function() {
			function _super() {
				return base.prototype[ prop ].apply( this, arguments );
			}

			function _superApply( args ) {
				return base.prototype[ prop ].apply( this, args );
			}

			return function() {
				var __super = this._super;
				var __superApply = this._superApply;
				var returnValue;

				this._super = _super;
				this._superApply = _superApply;

				returnValue = value.apply( this, arguments );

				this._super = __super;
				this._superApply = __superApply;

				return returnValue;
			};
		} )();
	} );
	constructor.prototype = $.widget.extend( basePrototype, {

		// TODO: remove support for widgetEventPrefix
		// always use the name + a colon as the prefix, e.g., draggable:start
		// don't prefix for widgets that aren't DOM-based
		widgetEventPrefix: existingConstructor ? ( basePrototype.widgetEventPrefix || name ) : name
	}, proxiedPrototype, {
		constructor: constructor,
		namespace: namespace,
		widgetName: name,
		widgetFullName: fullName
	} );

	// If this widget is being redefined then we need to find all widgets that
	// are inheriting from it and redefine all of them so that they inherit from
	// the new version of this widget. We're essentially trying to replace one
	// level in the prototype chain.
	if ( existingConstructor ) {
		$.each( existingConstructor._childConstructors, function( i, child ) {
			var childPrototype = child.prototype;

			// Redefine the child widget using the same prototype that was
			// originally used, but inherit from the new version of the base
			$.widget( childPrototype.namespace + "." + childPrototype.widgetName, constructor,
				child._proto );
		} );

		// Remove the list of existing child constructors from the old constructor
		// so the old child constructors can be garbage collected
		delete existingConstructor._childConstructors;
	} else {
		base._childConstructors.push( constructor );
	}

	$.widget.bridge( name, constructor );

	return constructor;
};

$.widget.extend = function( target ) {
	var input = widgetSlice.call( arguments, 1 );
	var inputIndex = 0;
	var inputLength = input.length;
	var key;
	var value;

	for ( ; inputIndex < inputLength; inputIndex++ ) {
		for ( key in input[ inputIndex ] ) {
			value = input[ inputIndex ][ key ];
			if ( input[ inputIndex ].hasOwnProperty( key ) && value !== undefined ) {

				// Clone objects
				if ( $.isPlainObject( value ) ) {
					target[ key ] = $.isPlainObject( target[ key ] ) ?
						$.widget.extend( {}, target[ key ], value ) :

						// Don't extend strings, arrays, etc. with objects
						$.widget.extend( {}, value );

				// Copy everything else by reference
				} else {
					target[ key ] = value;
				}
			}
		}
	}
	return target;
};

$.widget.bridge = function( name, object ) {
	var fullName = object.prototype.widgetFullName || name;
	$.fn[ name ] = function( options ) {
		var isMethodCall = typeof options === "string";
		var args = widgetSlice.call( arguments, 1 );
		var returnValue = this;

		if ( isMethodCall ) {

			// If this is an empty collection, we need to have the instance method
			// return undefined instead of the jQuery instance
			if ( !this.length && options === "instance" ) {
				returnValue = undefined;
			} else {
				this.each( function() {
					var methodValue;
					var instance = $.data( this, fullName );

					if ( options === "instance" ) {
						returnValue = instance;
						return false;
					}

					if ( !instance ) {
						return $.error( "cannot call methods on " + name +
							" prior to initialization; " +
							"attempted to call method '" + options + "'" );
					}

					if ( !$.isFunction( instance[ options ] ) || options.charAt( 0 ) === "_" ) {
						return $.error( "no such method '" + options + "' for " + name +
							" widget instance" );
					}

					methodValue = instance[ options ].apply( instance, args );

					if ( methodValue !== instance && methodValue !== undefined ) {
						returnValue = methodValue && methodValue.jquery ?
							returnValue.pushStack( methodValue.get() ) :
							methodValue;
						return false;
					}
				} );
			}
		} else {

			// Allow multiple hashes to be passed on init
			if ( args.length ) {
				options = $.widget.extend.apply( null, [ options ].concat( args ) );
			}

			this.each( function() {
				var instance = $.data( this, fullName );
				if ( instance ) {
					instance.option( options || {} );
					if ( instance._init ) {
						instance._init();
					}
				} else {
					$.data( this, fullName, new object( options, this ) );
				}
			} );
		}

		return returnValue;
	};
};

$.Widget = function( /* options, element */ ) {};
$.Widget._childConstructors = [];

$.Widget.prototype = {
	widgetName: "widget",
	widgetEventPrefix: "",
	defaultElement: "<div>",

	options: {
		classes: {},
		disabled: false,

		// Callbacks
		create: null
	},

	_createWidget: function( options, element ) {
		element = $( element || this.defaultElement || this )[ 0 ];
		this.element = $( element );
		this.uuid = widgetUuid++;
		this.eventNamespace = "." + this.widgetName + this.uuid;

		this.bindings = $();
		this.hoverable = $();
		this.focusable = $();
		this.classesElementLookup = {};

		if ( element !== this ) {
			$.data( element, this.widgetFullName, this );
			this._on( true, this.element, {
				remove: function( event ) {
					if ( event.target === element ) {
						this.destroy();
					}
				}
			} );
			this.document = $( element.style ?

				// Element within the document
				element.ownerDocument :

				// Element is window or document
				element.document || element );
			this.window = $( this.document[ 0 ].defaultView || this.document[ 0 ].parentWindow );
		}

		this.options = $.widget.extend( {},
			this.options,
			this._getCreateOptions(),
			options );

		this._create();

		if ( this.options.disabled ) {
			this._setOptionDisabled( this.options.disabled );
		}

		this._trigger( "create", null, this._getCreateEventData() );
		this._init();
	},

	_getCreateOptions: function() {
		return {};
	},

	_getCreateEventData: $.noop,

	_create: $.noop,

	_init: $.noop,

	destroy: function() {
		var that = this;

		this._destroy();
		$.each( this.classesElementLookup, function( key, value ) {
			that._removeClass( value, key );
		} );

		// We can probably remove the unbind calls in 2.0
		// all event bindings should go through this._on()
		this.element
			.off( this.eventNamespace )
			.removeData( this.widgetFullName );
		this.widget()
			.off( this.eventNamespace )
			.removeAttr( "aria-disabled" );

		// Clean up events and states
		this.bindings.off( this.eventNamespace );
	},

	_destroy: $.noop,

	widget: function() {
		return this.element;
	},

	option: function( key, value ) {
		var options = key;
		var parts;
		var curOption;
		var i;

		if ( arguments.length === 0 ) {

			// Don't return a reference to the internal hash
			return $.widget.extend( {}, this.options );
		}

		if ( typeof key === "string" ) {

			// Handle nested keys, e.g., "foo.bar" => { foo: { bar: ___ } }
			options = {};
			parts = key.split( "." );
			key = parts.shift();
			if ( parts.length ) {
				curOption = options[ key ] = $.widget.extend( {}, this.options[ key ] );
				for ( i = 0; i < parts.length - 1; i++ ) {
					curOption[ parts[ i ] ] = curOption[ parts[ i ] ] || {};
					curOption = curOption[ parts[ i ] ];
				}
				key = parts.pop();
				if ( arguments.length === 1 ) {
					return curOption[ key ] === undefined ? null : curOption[ key ];
				}
				curOption[ key ] = value;
			} else {
				if ( arguments.length === 1 ) {
					return this.options[ key ] === undefined ? null : this.options[ key ];
				}
				options[ key ] = value;
			}
		}

		this._setOptions( options );

		return this;
	},

	_setOptions: function( options ) {
		var key;

		for ( key in options ) {
			this._setOption( key, options[ key ] );
		}

		return this;
	},

	_setOption: function( key, value ) {
		if ( key === "classes" ) {
			this._setOptionClasses( value );
		}

		this.options[ key ] = value;

		if ( key === "disabled" ) {
			this._setOptionDisabled( value );
		}

		return this;
	},

	_setOptionClasses: function( value ) {
		var classKey, elements, currentElements;

		for ( classKey in value ) {
			currentElements = this.classesElementLookup[ classKey ];
			if ( value[ classKey ] === this.options.classes[ classKey ] ||
					!currentElements ||
					!currentElements.length ) {
				continue;
			}

			// We are doing this to create a new jQuery object because the _removeClass() call
			// on the next line is going to destroy the reference to the current elements being
			// tracked. We need to save a copy of this collection so that we can add the new classes
			// below.
			elements = $( currentElements.get() );
			this._removeClass( currentElements, classKey );

			// We don't use _addClass() here, because that uses this.options.classes
			// for generating the string of classes. We want to use the value passed in from
			// _setOption(), this is the new value of the classes option which was passed to
			// _setOption(). We pass this value directly to _classes().
			elements.addClass( this._classes( {
				element: elements,
				keys: classKey,
				classes: value,
				add: true
			} ) );
		}
	},

	_setOptionDisabled: function( value ) {
		this._toggleClass( this.widget(), this.widgetFullName + "-disabled", null, !!value );

		// If the widget is becoming disabled, then nothing is interactive
		if ( value ) {
			this._removeClass( this.hoverable, null, "ui-state-hover" );
			this._removeClass( this.focusable, null, "ui-state-focus" );
		}
	},

	enable: function() {
		return this._setOptions( { disabled: false } );
	},

	disable: function() {
		return this._setOptions( { disabled: true } );
	},

	_classes: function( options ) {
		var full = [];
		var that = this;

		options = $.extend( {
			element: this.element,
			classes: this.options.classes || {}
		}, options );

		function processClassString( classes, checkOption ) {
			var current, i;
			for ( i = 0; i < classes.length; i++ ) {
				current = that.classesElementLookup[ classes[ i ] ] || $();
				if ( options.add ) {
					current = $( $.unique( current.get().concat( options.element.get() ) ) );
				} else {
					current = $( current.not( options.element ).get() );
				}
				that.classesElementLookup[ classes[ i ] ] = current;
				full.push( classes[ i ] );
				if ( checkOption && options.classes[ classes[ i ] ] ) {
					full.push( options.classes[ classes[ i ] ] );
				}
			}
		}

		this._on( options.element, {
			"remove": "_untrackClassesElement"
		} );

		if ( options.keys ) {
			processClassString( options.keys.match( /\S+/g ) || [], true );
		}
		if ( options.extra ) {
			processClassString( options.extra.match( /\S+/g ) || [] );
		}

		return full.join( " " );
	},

	_untrackClassesElement: function( event ) {
		var that = this;
		$.each( that.classesElementLookup, function( key, value ) {
			if ( $.inArray( event.target, value ) !== -1 ) {
				that.classesElementLookup[ key ] = $( value.not( event.target ).get() );
			}
		} );
	},

	_removeClass: function( element, keys, extra ) {
		return this._toggleClass( element, keys, extra, false );
	},

	_addClass: function( element, keys, extra ) {
		return this._toggleClass( element, keys, extra, true );
	},

	_toggleClass: function( element, keys, extra, add ) {
		add = ( typeof add === "boolean" ) ? add : extra;
		var shift = ( typeof element === "string" || element === null ),
			options = {
				extra: shift ? keys : extra,
				keys: shift ? element : keys,
				element: shift ? this.element : element,
				add: add
			};
		options.element.toggleClass( this._classes( options ), add );
		return this;
	},

	_on: function( suppressDisabledCheck, element, handlers ) {
		var delegateElement;
		var instance = this;

		// No suppressDisabledCheck flag, shuffle arguments
		if ( typeof suppressDisabledCheck !== "boolean" ) {
			handlers = element;
			element = suppressDisabledCheck;
			suppressDisabledCheck = false;
		}

		// No element argument, shuffle and use this.element
		if ( !handlers ) {
			handlers = element;
			element = this.element;
			delegateElement = this.widget();
		} else {
			element = delegateElement = $( element );
			this.bindings = this.bindings.add( element );
		}

		$.each( handlers, function( event, handler ) {
			function handlerProxy() {

				// Allow widgets to customize the disabled handling
				// - disabled as an array instead of boolean
				// - disabled class as method for disabling individual parts
				if ( !suppressDisabledCheck &&
						( instance.options.disabled === true ||
						$( this ).hasClass( "ui-state-disabled" ) ) ) {
					return;
				}
				return ( typeof handler === "string" ? instance[ handler ] : handler )
					.apply( instance, arguments );
			}

			// Copy the guid so direct unbinding works
			if ( typeof handler !== "string" ) {
				handlerProxy.guid = handler.guid =
					handler.guid || handlerProxy.guid || $.guid++;
			}

			var match = event.match( /^([\w:-]*)\s*(.*)$/ );
			var eventName = match[ 1 ] + instance.eventNamespace;
			var selector = match[ 2 ];

			if ( selector ) {
				delegateElement.on( eventName, selector, handlerProxy );
			} else {
				element.on( eventName, handlerProxy );
			}
		} );
	},

	_off: function( element, eventName ) {
		eventName = ( eventName || "" ).split( " " ).join( this.eventNamespace + " " ) +
			this.eventNamespace;
		element.off( eventName ).off( eventName );

		// Clear the stack to avoid memory leaks (#10056)
		this.bindings = $( this.bindings.not( element ).get() );
		this.focusable = $( this.focusable.not( element ).get() );
		this.hoverable = $( this.hoverable.not( element ).get() );
	},

	_delay: function( handler, delay ) {
		function handlerProxy() {
			return ( typeof handler === "string" ? instance[ handler ] : handler )
				.apply( instance, arguments );
		}
		var instance = this;
		return setTimeout( handlerProxy, delay || 0 );
	},

	_hoverable: function( element ) {
		this.hoverable = this.hoverable.add( element );
		this._on( element, {
			mouseenter: function( event ) {
				this._addClass( $( event.currentTarget ), null, "ui-state-hover" );
			},
			mouseleave: function( event ) {
				this._removeClass( $( event.currentTarget ), null, "ui-state-hover" );
			}
		} );
	},

	_focusable: function( element ) {
		this.focusable = this.focusable.add( element );
		this._on( element, {
			focusin: function( event ) {
				this._addClass( $( event.currentTarget ), null, "ui-state-focus" );
			},
			focusout: function( event ) {
				this._removeClass( $( event.currentTarget ), null, "ui-state-focus" );
			}
		} );
	},

	_trigger: function( type, event, data ) {
		var prop, orig;
		var callback = this.options[ type ];

		data = data || {};
		event = $.Event( event );
		event.type = ( type === this.widgetEventPrefix ?
			type :
			this.widgetEventPrefix + type ).toLowerCase();

		// The original event may come from any element
		// so we need to reset the target on the new event
		event.target = this.element[ 0 ];

		// Copy original event properties over to the new event
		orig = event.originalEvent;
		if ( orig ) {
			for ( prop in orig ) {
				if ( !( prop in event ) ) {
					event[ prop ] = orig[ prop ];
				}
			}
		}

		this.element.trigger( event, data );
		return !( $.isFunction( callback ) &&
			callback.apply( this.element[ 0 ], [ event ].concat( data ) ) === false ||
			event.isDefaultPrevented() );
	}
};

$.each( { show: "fadeIn", hide: "fadeOut" }, function( method, defaultEffect ) {
	$.Widget.prototype[ "_" + method ] = function( element, options, callback ) {
		if ( typeof options === "string" ) {
			options = { effect: options };
		}

		var hasOptions;
		var effectName = !options ?
			method :
			options === true || typeof options === "number" ?
				defaultEffect :
				options.effect || defaultEffect;

		options = options || {};
		if ( typeof options === "number" ) {
			options = { duration: options };
		}

		hasOptions = !$.isEmptyObject( options );
		options.complete = callback;

		if ( options.delay ) {
			element.delay( options.delay );
		}

		if ( hasOptions && $.effects && $.effects.effect[ effectName ] ) {
			element[ method ]( options );
		} else if ( effectName !== method && element[ effectName ] ) {
			element[ effectName ]( options.duration, options.easing, callback );
		} else {
			element.queue( function( next ) {
				$( this )[ method ]();
				if ( callback ) {
					callback.call( element[ 0 ] );
				}
				next();
			} );
		}
	};
} );

return $.widget;

} ) );

},{}],61:[function(require,module,exports){
/*!
 * jQuery UI Autocomplete 1.12.1
 * http://jqueryui.com
 *
 * Copyright jQuery Foundation and other contributors
 * Released under the MIT license.
 * http://jquery.org/license
 */

//>>label: Autocomplete
//>>group: Widgets
//>>description: Lists suggested words as the user is typing.
//>>docs: http://api.jqueryui.com/autocomplete/
//>>demos: http://jqueryui.com/autocomplete/
//>>css.structure: ../../themes/base/core.css
//>>css.structure: ../../themes/base/autocomplete.css
//>>css.theme: ../../themes/base/theme.css

( function( factory ) {
	if ( typeof define === "function" && define.amd ) {

		// AMD. Register as an anonymous module.
		define( [
			"jquery",
			"./menu",
			"../keycode",
			"../position",
			"../safe-active-element",
			"../version",
			"../widget"
		], factory );
	} else {

		// Browser globals
		factory( jQuery );
	}
}( function( $ ) {

$.widget( "ui.autocomplete", {
	version: "1.12.1",
	defaultElement: "<input>",
	options: {
		appendTo: null,
		autoFocus: false,
		delay: 300,
		minLength: 1,
		position: {
			my: "left top",
			at: "left bottom",
			collision: "none"
		},
		source: null,

		// Callbacks
		change: null,
		close: null,
		focus: null,
		open: null,
		response: null,
		search: null,
		select: null
	},

	requestIndex: 0,
	pending: 0,

	_create: function() {

		// Some browsers only repeat keydown events, not keypress events,
		// so we use the suppressKeyPress flag to determine if we've already
		// handled the keydown event. #7269
		// Unfortunately the code for & in keypress is the same as the up arrow,
		// so we use the suppressKeyPressRepeat flag to avoid handling keypress
		// events when we know the keydown event was used to modify the
		// search term. #7799
		var suppressKeyPress, suppressKeyPressRepeat, suppressInput,
			nodeName = this.element[ 0 ].nodeName.toLowerCase(),
			isTextarea = nodeName === "textarea",
			isInput = nodeName === "input";

		// Textareas are always multi-line
		// Inputs are always single-line, even if inside a contentEditable element
		// IE also treats inputs as contentEditable
		// All other element types are determined by whether or not they're contentEditable
		this.isMultiLine = isTextarea || !isInput && this._isContentEditable( this.element );

		this.valueMethod = this.element[ isTextarea || isInput ? "val" : "text" ];
		this.isNewMenu = true;

		this._addClass( "ui-autocomplete-input" );
		this.element.attr( "autocomplete", "off" );

		this._on( this.element, {
			keydown: function( event ) {
				if ( this.element.prop( "readOnly" ) ) {
					suppressKeyPress = true;
					suppressInput = true;
					suppressKeyPressRepeat = true;
					return;
				}

				suppressKeyPress = false;
				suppressInput = false;
				suppressKeyPressRepeat = false;
				var keyCode = $.ui.keyCode;
				switch ( event.keyCode ) {
				case keyCode.PAGE_UP:
					suppressKeyPress = true;
					this._move( "previousPage", event );
					break;
				case keyCode.PAGE_DOWN:
					suppressKeyPress = true;
					this._move( "nextPage", event );
					break;
				case keyCode.UP:
					suppressKeyPress = true;
					this._keyEvent( "previous", event );
					break;
				case keyCode.DOWN:
					suppressKeyPress = true;
					this._keyEvent( "next", event );
					break;
				case keyCode.ENTER:

					// when menu is open and has focus
					if ( this.menu.active ) {

						// #6055 - Opera still allows the keypress to occur
						// which causes forms to submit
						suppressKeyPress = true;
						event.preventDefault();
						this.menu.select( event );
					}
					break;
				case keyCode.TAB:
					if ( this.menu.active ) {
						this.menu.select( event );
					}
					break;
				case keyCode.ESCAPE:
					if ( this.menu.element.is( ":visible" ) ) {
						if ( !this.isMultiLine ) {
							this._value( this.term );
						}
						this.close( event );

						// Different browsers have different default behavior for escape
						// Single press can mean undo or clear
						// Double press in IE means clear the whole form
						event.preventDefault();
					}
					break;
				default:
					suppressKeyPressRepeat = true;

					// search timeout should be triggered before the input value is changed
					this._searchTimeout( event );
					break;
				}
			},
			keypress: function( event ) {
				if ( suppressKeyPress ) {
					suppressKeyPress = false;
					if ( !this.isMultiLine || this.menu.element.is( ":visible" ) ) {
						event.preventDefault();
					}
					return;
				}
				if ( suppressKeyPressRepeat ) {
					return;
				}

				// Replicate some key handlers to allow them to repeat in Firefox and Opera
				var keyCode = $.ui.keyCode;
				switch ( event.keyCode ) {
				case keyCode.PAGE_UP:
					this._move( "previousPage", event );
					break;
				case keyCode.PAGE_DOWN:
					this._move( "nextPage", event );
					break;
				case keyCode.UP:
					this._keyEvent( "previous", event );
					break;
				case keyCode.DOWN:
					this._keyEvent( "next", event );
					break;
				}
			},
			input: function( event ) {
				if ( suppressInput ) {
					suppressInput = false;
					event.preventDefault();
					return;
				}
				this._searchTimeout( event );
			},
			focus: function() {
				this.selectedItem = null;
				this.previous = this._value();
			},
			blur: function( event ) {
				if ( this.cancelBlur ) {
					delete this.cancelBlur;
					return;
				}

				clearTimeout( this.searching );
				this.close( event );
				this._change( event );
			}
		} );

		this._initSource();
		this.menu = $( "<ul>" )
			.appendTo( this._appendTo() )
			.menu( {

				// disable ARIA support, the live region takes care of that
				role: null
			} )
			.hide()
			.menu( "instance" );

		this._addClass( this.menu.element, "ui-autocomplete", "ui-front" );
		this._on( this.menu.element, {
			mousedown: function( event ) {

				// prevent moving focus out of the text field
				event.preventDefault();

				// IE doesn't prevent moving focus even with event.preventDefault()
				// so we set a flag to know when we should ignore the blur event
				this.cancelBlur = true;
				this._delay( function() {
					delete this.cancelBlur;

					// Support: IE 8 only
					// Right clicking a menu item or selecting text from the menu items will
					// result in focus moving out of the input. However, we've already received
					// and ignored the blur event because of the cancelBlur flag set above. So
					// we restore focus to ensure that the menu closes properly based on the user's
					// next actions.
					if ( this.element[ 0 ] !== $.ui.safeActiveElement( this.document[ 0 ] ) ) {
						this.element.trigger( "focus" );
					}
				} );
			},
			menufocus: function( event, ui ) {
				var label, item;

				// support: Firefox
				// Prevent accidental activation of menu items in Firefox (#7024 #9118)
				if ( this.isNewMenu ) {
					this.isNewMenu = false;
					if ( event.originalEvent && /^mouse/.test( event.originalEvent.type ) ) {
						this.menu.blur();

						this.document.one( "mousemove", function() {
							$( event.target ).trigger( event.originalEvent );
						} );

						return;
					}
				}

				item = ui.item.data( "ui-autocomplete-item" );
				if ( false !== this._trigger( "focus", event, { item: item } ) ) {

					// use value to match what will end up in the input, if it was a key event
					if ( event.originalEvent && /^key/.test( event.originalEvent.type ) ) {
						this._value( item.value );
					}
				}

				// Announce the value in the liveRegion
				label = ui.item.attr( "aria-label" ) || item.value;
				if ( label && $.trim( label ).length ) {
					this.liveRegion.children().hide();
					$( "<div>" ).text( label ).appendTo( this.liveRegion );
				}
			},
			menuselect: function( event, ui ) {
				var item = ui.item.data( "ui-autocomplete-item" ),
					previous = this.previous;

				// Only trigger when focus was lost (click on menu)
				if ( this.element[ 0 ] !== $.ui.safeActiveElement( this.document[ 0 ] ) ) {
					this.element.trigger( "focus" );
					this.previous = previous;

					// #6109 - IE triggers two focus events and the second
					// is asynchronous, so we need to reset the previous
					// term synchronously and asynchronously :-(
					this._delay( function() {
						this.previous = previous;
						this.selectedItem = item;
					} );
				}

				if ( false !== this._trigger( "select", event, { item: item } ) ) {
					this._value( item.value );
				}

				// reset the term after the select event
				// this allows custom select handling to work properly
				this.term = this._value();

				this.close( event );
				this.selectedItem = item;
			}
		} );

		this.liveRegion = $( "<div>", {
			role: "status",
			"aria-live": "assertive",
			"aria-relevant": "additions"
		} )
			.appendTo( this.document[ 0 ].body );

		this._addClass( this.liveRegion, null, "ui-helper-hidden-accessible" );

		// Turning off autocomplete prevents the browser from remembering the
		// value when navigating through history, so we re-enable autocomplete
		// if the page is unloaded before the widget is destroyed. #7790
		this._on( this.window, {
			beforeunload: function() {
				this.element.removeAttr( "autocomplete" );
			}
		} );
	},

	_destroy: function() {
		clearTimeout( this.searching );
		this.element.removeAttr( "autocomplete" );
		this.menu.element.remove();
		this.liveRegion.remove();
	},

	_setOption: function( key, value ) {
		this._super( key, value );
		if ( key === "source" ) {
			this._initSource();
		}
		if ( key === "appendTo" ) {
			this.menu.element.appendTo( this._appendTo() );
		}
		if ( key === "disabled" && value && this.xhr ) {
			this.xhr.abort();
		}
	},

	_isEventTargetInWidget: function( event ) {
		var menuElement = this.menu.element[ 0 ];

		return event.target === this.element[ 0 ] ||
			event.target === menuElement ||
			$.contains( menuElement, event.target );
	},

	_closeOnClickOutside: function( event ) {
		if ( !this._isEventTargetInWidget( event ) ) {
			this.close();
		}
	},

	_appendTo: function() {
		var element = this.options.appendTo;

		if ( element ) {
			element = element.jquery || element.nodeType ?
				$( element ) :
				this.document.find( element ).eq( 0 );
		}

		if ( !element || !element[ 0 ] ) {
			element = this.element.closest( ".ui-front, dialog" );
		}

		if ( !element.length ) {
			element = this.document[ 0 ].body;
		}

		return element;
	},

	_initSource: function() {
		var array, url,
			that = this;
		if ( $.isArray( this.options.source ) ) {
			array = this.options.source;
			this.source = function( request, response ) {
				response( $.ui.autocomplete.filter( array, request.term ) );
			};
		} else if ( typeof this.options.source === "string" ) {
			url = this.options.source;
			this.source = function( request, response ) {
				if ( that.xhr ) {
					that.xhr.abort();
				}
				that.xhr = $.ajax( {
					url: url,
					data: request,
					dataType: "json",
					success: function( data ) {
						response( data );
					},
					error: function() {
						response( [] );
					}
				} );
			};
		} else {
			this.source = this.options.source;
		}
	},

	_searchTimeout: function( event ) {
		clearTimeout( this.searching );
		this.searching = this._delay( function() {

			// Search if the value has changed, or if the user retypes the same value (see #7434)
			var equalValues = this.term === this._value(),
				menuVisible = this.menu.element.is( ":visible" ),
				modifierKey = event.altKey || event.ctrlKey || event.metaKey || event.shiftKey;

			if ( !equalValues || ( equalValues && !menuVisible && !modifierKey ) ) {
				this.selectedItem = null;
				this.search( null, event );
			}
		}, this.options.delay );
	},

	search: function( value, event ) {
		value = value != null ? value : this._value();

		// Always save the actual value, not the one passed as an argument
		this.term = this._value();

		if ( value.length < this.options.minLength ) {
			return this.close( event );
		}

		if ( this._trigger( "search", event ) === false ) {
			return;
		}

		return this._search( value );
	},

	_search: function( value ) {
		this.pending++;
		this._addClass( "ui-autocomplete-loading" );
		this.cancelSearch = false;

		this.source( { term: value }, this._response() );
	},

	_response: function() {
		var index = ++this.requestIndex;

		return $.proxy( function( content ) {
			if ( index === this.requestIndex ) {
				this.__response( content );
			}

			this.pending--;
			if ( !this.pending ) {
				this._removeClass( "ui-autocomplete-loading" );
			}
		}, this );
	},

	__response: function( content ) {
		if ( content ) {
			content = this._normalize( content );
		}
		this._trigger( "response", null, { content: content } );
		if ( !this.options.disabled && content && content.length && !this.cancelSearch ) {
			this._suggest( content );
			this._trigger( "open" );
		} else {

			// use ._close() instead of .close() so we don't cancel future searches
			this._close();
		}
	},

	close: function( event ) {
		this.cancelSearch = true;
		this._close( event );
	},

	_close: function( event ) {

		// Remove the handler that closes the menu on outside clicks
		this._off( this.document, "mousedown" );

		if ( this.menu.element.is( ":visible" ) ) {
			this.menu.element.hide();
			this.menu.blur();
			this.isNewMenu = true;
			this._trigger( "close", event );
		}
	},

	_change: function( event ) {
		if ( this.previous !== this._value() ) {
			this._trigger( "change", event, { item: this.selectedItem } );
		}
	},

	_normalize: function( items ) {

		// assume all items have the right format when the first item is complete
		if ( items.length && items[ 0 ].label && items[ 0 ].value ) {
			return items;
		}
		return $.map( items, function( item ) {
			if ( typeof item === "string" ) {
				return {
					label: item,
					value: item
				};
			}
			return $.extend( {}, item, {
				label: item.label || item.value,
				value: item.value || item.label
			} );
		} );
	},

	_suggest: function( items ) {
		var ul = this.menu.element.empty();
		this._renderMenu( ul, items );
		this.isNewMenu = true;
		this.menu.refresh();

		// Size and position menu
		ul.show();
		this._resizeMenu();
		ul.position( $.extend( {
			of: this.element
		}, this.options.position ) );

		if ( this.options.autoFocus ) {
			this.menu.next();
		}

		// Listen for interactions outside of the widget (#6642)
		this._on( this.document, {
			mousedown: "_closeOnClickOutside"
		} );
	},

	_resizeMenu: function() {
		var ul = this.menu.element;
		ul.outerWidth( Math.max(

			// Firefox wraps long text (possibly a rounding bug)
			// so we add 1px to avoid the wrapping (#7513)
			ul.width( "" ).outerWidth() + 1,
			this.element.outerWidth()
		) );
	},

	_renderMenu: function( ul, items ) {
		var that = this;
		$.each( items, function( index, item ) {
			that._renderItemData( ul, item );
		} );
	},

	_renderItemData: function( ul, item ) {
		return this._renderItem( ul, item ).data( "ui-autocomplete-item", item );
	},

	_renderItem: function( ul, item ) {
		return $( "<li>" )
			.append( $( "<div>" ).text( item.label ) )
			.appendTo( ul );
	},

	_move: function( direction, event ) {
		if ( !this.menu.element.is( ":visible" ) ) {
			this.search( null, event );
			return;
		}
		if ( this.menu.isFirstItem() && /^previous/.test( direction ) ||
				this.menu.isLastItem() && /^next/.test( direction ) ) {

			if ( !this.isMultiLine ) {
				this._value( this.term );
			}

			this.menu.blur();
			return;
		}
		this.menu[ direction ]( event );
	},

	widget: function() {
		return this.menu.element;
	},

	_value: function() {
		return this.valueMethod.apply( this.element, arguments );
	},

	_keyEvent: function( keyEvent, event ) {
		if ( !this.isMultiLine || this.menu.element.is( ":visible" ) ) {
			this._move( keyEvent, event );

			// Prevents moving cursor to beginning/end of the text field in some browsers
			event.preventDefault();
		}
	},

	// Support: Chrome <=50
	// We should be able to just use this.element.prop( "isContentEditable" )
	// but hidden elements always report false in Chrome.
	// https://code.google.com/p/chromium/issues/detail?id=313082
	_isContentEditable: function( element ) {
		if ( !element.length ) {
			return false;
		}

		var editable = element.prop( "contentEditable" );

		if ( editable === "inherit" ) {
		  return this._isContentEditable( element.parent() );
		}

		return editable === "true";
	}
} );

$.extend( $.ui.autocomplete, {
	escapeRegex: function( value ) {
		return value.replace( /[\-\[\]{}()*+?.,\\\^$|#\s]/g, "\\$&" );
	},
	filter: function( array, term ) {
		var matcher = new RegExp( $.ui.autocomplete.escapeRegex( term ), "i" );
		return $.grep( array, function( value ) {
			return matcher.test( value.label || value.value || value );
		} );
	}
} );

// Live region extension, adding a `messages` option
// NOTE: This is an experimental API. We are still investigating
// a full solution for string manipulation and internationalization.
$.widget( "ui.autocomplete", $.ui.autocomplete, {
	options: {
		messages: {
			noResults: "No search results.",
			results: function( amount ) {
				return amount + ( amount > 1 ? " results are" : " result is" ) +
					" available, use up and down arrow keys to navigate.";
			}
		}
	},

	__response: function( content ) {
		var message;
		this._superApply( arguments );
		if ( this.options.disabled || this.cancelSearch ) {
			return;
		}
		if ( content && content.length ) {
			message = this.options.messages.results( content.length );
		} else {
			message = this.options.messages.noResults;
		}
		this.liveRegion.children().hide();
		$( "<div>" ).text( message ).appendTo( this.liveRegion );
	}
} );

return $.ui.autocomplete;

} ) );

},{}],62:[function(require,module,exports){
/*!
 * jQuery UI Button 1.12.1
 * http://jqueryui.com
 *
 * Copyright jQuery Foundation and other contributors
 * Released under the MIT license.
 * http://jquery.org/license
 */

//>>label: Button
//>>group: Widgets
//>>description: Enhances a form with themeable buttons.
//>>docs: http://api.jqueryui.com/button/
//>>demos: http://jqueryui.com/button/
//>>css.structure: ../../themes/base/core.css
//>>css.structure: ../../themes/base/button.css
//>>css.theme: ../../themes/base/theme.css

( function( factory ) {
	if ( typeof define === "function" && define.amd ) {

		// AMD. Register as an anonymous module.
		define( [
			"jquery",

			// These are only for backcompat
			// TODO: Remove after 1.12
			"./controlgroup",
			"./checkboxradio",

			"../keycode",
			"../widget"
		], factory );
	} else {

		// Browser globals
		factory( jQuery );
	}
}( function( $ ) {

$.widget( "ui.button", {
	version: "1.12.1",
	defaultElement: "<button>",
	options: {
		classes: {
			"ui-button": "ui-corner-all"
		},
		disabled: null,
		icon: null,
		iconPosition: "beginning",
		label: null,
		showLabel: true
	},

	_getCreateOptions: function() {
		var disabled,

			// This is to support cases like in jQuery Mobile where the base widget does have
			// an implementation of _getCreateOptions
			options = this._super() || {};

		this.isInput = this.element.is( "input" );

		disabled = this.element[ 0 ].disabled;
		if ( disabled != null ) {
			options.disabled = disabled;
		}

		this.originalLabel = this.isInput ? this.element.val() : this.element.html();
		if ( this.originalLabel ) {
			options.label = this.originalLabel;
		}

		return options;
	},

	_create: function() {
		if ( !this.option.showLabel & !this.options.icon ) {
			this.options.showLabel = true;
		}

		// We have to check the option again here even though we did in _getCreateOptions,
		// because null may have been passed on init which would override what was set in
		// _getCreateOptions
		if ( this.options.disabled == null ) {
			this.options.disabled = this.element[ 0 ].disabled || false;
		}

		this.hasTitle = !!this.element.attr( "title" );

		// Check to see if the label needs to be set or if its already correct
		if ( this.options.label && this.options.label !== this.originalLabel ) {
			if ( this.isInput ) {
				this.element.val( this.options.label );
			} else {
				this.element.html( this.options.label );
			}
		}
		this._addClass( "ui-button", "ui-widget" );
		this._setOption( "disabled", this.options.disabled );
		this._enhance();

		if ( this.element.is( "a" ) ) {
			this._on( {
				"keyup": function( event ) {
					if ( event.keyCode === $.ui.keyCode.SPACE ) {
						event.preventDefault();

						// Support: PhantomJS <= 1.9, IE 8 Only
						// If a native click is available use it so we actually cause navigation
						// otherwise just trigger a click event
						if ( this.element[ 0 ].click ) {
							this.element[ 0 ].click();
						} else {
							this.element.trigger( "click" );
						}
					}
				}
			} );
		}
	},

	_enhance: function() {
		if ( !this.element.is( "button" ) ) {
			this.element.attr( "role", "button" );
		}

		if ( this.options.icon ) {
			this._updateIcon( "icon", this.options.icon );
			this._updateTooltip();
		}
	},

	_updateTooltip: function() {
		this.title = this.element.attr( "title" );

		if ( !this.options.showLabel && !this.title ) {
			this.element.attr( "title", this.options.label );
		}
	},

	_updateIcon: function( option, value ) {
		var icon = option !== "iconPosition",
			position = icon ? this.options.iconPosition : value,
			displayBlock = position === "top" || position === "bottom";

		// Create icon
		if ( !this.icon ) {
			this.icon = $( "<span>" );

			this._addClass( this.icon, "ui-button-icon", "ui-icon" );

			if ( !this.options.showLabel ) {
				this._addClass( "ui-button-icon-only" );
			}
		} else if ( icon ) {

			// If we are updating the icon remove the old icon class
			this._removeClass( this.icon, null, this.options.icon );
		}

		// If we are updating the icon add the new icon class
		if ( icon ) {
			this._addClass( this.icon, null, value );
		}

		this._attachIcon( position );

		// If the icon is on top or bottom we need to add the ui-widget-icon-block class and remove
		// the iconSpace if there is one.
		if ( displayBlock ) {
			this._addClass( this.icon, null, "ui-widget-icon-block" );
			if ( this.iconSpace ) {
				this.iconSpace.remove();
			}
		} else {

			// Position is beginning or end so remove the ui-widget-icon-block class and add the
			// space if it does not exist
			if ( !this.iconSpace ) {
				this.iconSpace = $( "<span> </span>" );
				this._addClass( this.iconSpace, "ui-button-icon-space" );
			}
			this._removeClass( this.icon, null, "ui-wiget-icon-block" );
			this._attachIconSpace( position );
		}
	},

	_destroy: function() {
		this.element.removeAttr( "role" );

		if ( this.icon ) {
			this.icon.remove();
		}
		if ( this.iconSpace ) {
			this.iconSpace.remove();
		}
		if ( !this.hasTitle ) {
			this.element.removeAttr( "title" );
		}
	},

	_attachIconSpace: function( iconPosition ) {
		this.icon[ /^(?:end|bottom)/.test( iconPosition ) ? "before" : "after" ]( this.iconSpace );
	},

	_attachIcon: function( iconPosition ) {
		this.element[ /^(?:end|bottom)/.test( iconPosition ) ? "append" : "prepend" ]( this.icon );
	},

	_setOptions: function( options ) {
		var newShowLabel = options.showLabel === undefined ?
				this.options.showLabel :
				options.showLabel,
			newIcon = options.icon === undefined ? this.options.icon : options.icon;

		if ( !newShowLabel && !newIcon ) {
			options.showLabel = true;
		}
		this._super( options );
	},

	_setOption: function( key, value ) {
		if ( key === "icon" ) {
			if ( value ) {
				this._updateIcon( key, value );
			} else if ( this.icon ) {
				this.icon.remove();
				if ( this.iconSpace ) {
					this.iconSpace.remove();
				}
			}
		}

		if ( key === "iconPosition" ) {
			this._updateIcon( key, value );
		}

		// Make sure we can't end up with a button that has neither text nor icon
		if ( key === "showLabel" ) {
				this._toggleClass( "ui-button-icon-only", null, !value );
				this._updateTooltip();
		}

		if ( key === "label" ) {
			if ( this.isInput ) {
				this.element.val( value );
			} else {

				// If there is an icon, append it, else nothing then append the value
				// this avoids removal of the icon when setting label text
				this.element.html( value );
				if ( this.icon ) {
					this._attachIcon( this.options.iconPosition );
					this._attachIconSpace( this.options.iconPosition );
				}
			}
		}

		this._super( key, value );

		if ( key === "disabled" ) {
			this._toggleClass( null, "ui-state-disabled", value );
			this.element[ 0 ].disabled = value;
			if ( value ) {
				this.element.blur();
			}
		}
	},

	refresh: function() {

		// Make sure to only check disabled if its an element that supports this otherwise
		// check for the disabled class to determine state
		var isDisabled = this.element.is( "input, button" ) ?
			this.element[ 0 ].disabled : this.element.hasClass( "ui-button-disabled" );

		if ( isDisabled !== this.options.disabled ) {
			this._setOptions( { disabled: isDisabled } );
		}

		this._updateTooltip();
	}
} );

// DEPRECATED
if ( $.uiBackCompat !== false ) {

	// Text and Icons options
	$.widget( "ui.button", $.ui.button, {
		options: {
			text: true,
			icons: {
				primary: null,
				secondary: null
			}
		},

		_create: function() {
			if ( this.options.showLabel && !this.options.text ) {
				this.options.showLabel = this.options.text;
			}
			if ( !this.options.showLabel && this.options.text ) {
				this.options.text = this.options.showLabel;
			}
			if ( !this.options.icon && ( this.options.icons.primary ||
					this.options.icons.secondary ) ) {
				if ( this.options.icons.primary ) {
					this.options.icon = this.options.icons.primary;
				} else {
					this.options.icon = this.options.icons.secondary;
					this.options.iconPosition = "end";
				}
			} else if ( this.options.icon ) {
				this.options.icons.primary = this.options.icon;
			}
			this._super();
		},

		_setOption: function( key, value ) {
			if ( key === "text" ) {
				this._super( "showLabel", value );
				return;
			}
			if ( key === "showLabel" ) {
				this.options.text = value;
			}
			if ( key === "icon" ) {
				this.options.icons.primary = value;
			}
			if ( key === "icons" ) {
				if ( value.primary ) {
					this._super( "icon", value.primary );
					this._super( "iconPosition", "beginning" );
				} else if ( value.secondary ) {
					this._super( "icon", value.secondary );
					this._super( "iconPosition", "end" );
				}
			}
			this._superApply( arguments );
		}
	} );

	$.fn.button = ( function( orig ) {
		return function() {
			if ( !this.length || ( this.length && this[ 0 ].tagName !== "INPUT" ) ||
					( this.length && this[ 0 ].tagName === "INPUT" && (
						this.attr( "type" ) !== "checkbox" && this.attr( "type" ) !== "radio"
					) ) ) {
				return orig.apply( this, arguments );
			}
			if ( !$.ui.checkboxradio ) {
				$.error( "Checkboxradio widget missing" );
			}
			if ( arguments.length === 0 ) {
				return this.checkboxradio( {
					"icon": false
				} );
			}
			return this.checkboxradio.apply( this, arguments );
		};
	} )( $.fn.button );

	$.fn.buttonset = function() {
		if ( !$.ui.controlgroup ) {
			$.error( "Controlgroup widget missing" );
		}
		if ( arguments[ 0 ] === "option" && arguments[ 1 ] === "items" && arguments[ 2 ] ) {
			return this.controlgroup.apply( this,
				[ arguments[ 0 ], "items.button", arguments[ 2 ] ] );
		}
		if ( arguments[ 0 ] === "option" && arguments[ 1 ] === "items" ) {
			return this.controlgroup.apply( this, [ arguments[ 0 ], "items.button" ] );
		}
		if ( typeof arguments[ 0 ] === "object" && arguments[ 0 ].items ) {
			arguments[ 0 ].items = {
				button: arguments[ 0 ].items
			};
		}
		return this.controlgroup.apply( this, arguments );
	};
}

return $.ui.button;

} ) );

},{}],63:[function(require,module,exports){
/*!
 * jQuery UI Dialog 1.12.1
 * http://jqueryui.com
 *
 * Copyright jQuery Foundation and other contributors
 * Released under the MIT license.
 * http://jquery.org/license
 */

//>>label: Dialog
//>>group: Widgets
//>>description: Displays customizable dialog windows.
//>>docs: http://api.jqueryui.com/dialog/
//>>demos: http://jqueryui.com/dialog/
//>>css.structure: ../../themes/base/core.css
//>>css.structure: ../../themes/base/dialog.css
//>>css.theme: ../../themes/base/theme.css

( function( factory ) {
	if ( typeof define === "function" && define.amd ) {

		// AMD. Register as an anonymous module.
		define( [
			"jquery",
			"./button",
			"./draggable",
			"./mouse",
			"./resizable",
			"../focusable",
			"../keycode",
			"../position",
			"../safe-active-element",
			"../safe-blur",
			"../tabbable",
			"../unique-id",
			"../version",
			"../widget"
		], factory );
	} else {

		// Browser globals
		factory( jQuery );
	}
}( function( $ ) {

$.widget( "ui.dialog", {
	version: "1.12.1",
	options: {
		appendTo: "body",
		autoOpen: true,
		buttons: [],
		classes: {
			"ui-dialog": "ui-corner-all",
			"ui-dialog-titlebar": "ui-corner-all"
		},
		closeOnEscape: true,
		closeText: "Close",
		draggable: true,
		hide: null,
		height: "auto",
		maxHeight: null,
		maxWidth: null,
		minHeight: 150,
		minWidth: 150,
		modal: false,
		position: {
			my: "center",
			at: "center",
			of: window,
			collision: "fit",

			// Ensure the titlebar is always visible
			using: function( pos ) {
				var topOffset = $( this ).css( pos ).offset().top;
				if ( topOffset < 0 ) {
					$( this ).css( "top", pos.top - topOffset );
				}
			}
		},
		resizable: true,
		show: null,
		title: null,
		width: 300,

		// Callbacks
		beforeClose: null,
		close: null,
		drag: null,
		dragStart: null,
		dragStop: null,
		focus: null,
		open: null,
		resize: null,
		resizeStart: null,
		resizeStop: null
	},

	sizeRelatedOptions: {
		buttons: true,
		height: true,
		maxHeight: true,
		maxWidth: true,
		minHeight: true,
		minWidth: true,
		width: true
	},

	resizableRelatedOptions: {
		maxHeight: true,
		maxWidth: true,
		minHeight: true,
		minWidth: true
	},

	_create: function() {
		this.originalCss = {
			display: this.element[ 0 ].style.display,
			width: this.element[ 0 ].style.width,
			minHeight: this.element[ 0 ].style.minHeight,
			maxHeight: this.element[ 0 ].style.maxHeight,
			height: this.element[ 0 ].style.height
		};
		this.originalPosition = {
			parent: this.element.parent(),
			index: this.element.parent().children().index( this.element )
		};
		this.originalTitle = this.element.attr( "title" );
		if ( this.options.title == null && this.originalTitle != null ) {
			this.options.title = this.originalTitle;
		}

		// Dialogs can't be disabled
		if ( this.options.disabled ) {
			this.options.disabled = false;
		}

		this._createWrapper();

		this.element
			.show()
			.removeAttr( "title" )
			.appendTo( this.uiDialog );

		this._addClass( "ui-dialog-content", "ui-widget-content" );

		this._createTitlebar();
		this._createButtonPane();

		if ( this.options.draggable && $.fn.draggable ) {
			this._makeDraggable();
		}
		if ( this.options.resizable && $.fn.resizable ) {
			this._makeResizable();
		}

		this._isOpen = false;

		this._trackFocus();
	},

	_init: function() {
		if ( this.options.autoOpen ) {
			this.open();
		}
	},

	_appendTo: function() {
		var element = this.options.appendTo;
		if ( element && ( element.jquery || element.nodeType ) ) {
			return $( element );
		}
		return this.document.find( element || "body" ).eq( 0 );
	},

	_destroy: function() {
		var next,
			originalPosition = this.originalPosition;

		this._untrackInstance();
		this._destroyOverlay();

		this.element
			.removeUniqueId()
			.css( this.originalCss )

			// Without detaching first, the following becomes really slow
			.detach();

		this.uiDialog.remove();

		if ( this.originalTitle ) {
			this.element.attr( "title", this.originalTitle );
		}

		next = originalPosition.parent.children().eq( originalPosition.index );

		// Don't try to place the dialog next to itself (#8613)
		if ( next.length && next[ 0 ] !== this.element[ 0 ] ) {
			next.before( this.element );
		} else {
			originalPosition.parent.append( this.element );
		}
	},

	widget: function() {
		return this.uiDialog;
	},

	disable: $.noop,
	enable: $.noop,

	close: function( event ) {
		var that = this;

		if ( !this._isOpen || this._trigger( "beforeClose", event ) === false ) {
			return;
		}

		this._isOpen = false;
		this._focusedElement = null;
		this._destroyOverlay();
		this._untrackInstance();

		if ( !this.opener.filter( ":focusable" ).trigger( "focus" ).length ) {

			// Hiding a focused element doesn't trigger blur in WebKit
			// so in case we have nothing to focus on, explicitly blur the active element
			// https://bugs.webkit.org/show_bug.cgi?id=47182
			$.ui.safeBlur( $.ui.safeActiveElement( this.document[ 0 ] ) );
		}

		this._hide( this.uiDialog, this.options.hide, function() {
			that._trigger( "close", event );
		} );
	},

	isOpen: function() {
		return this._isOpen;
	},

	moveToTop: function() {
		this._moveToTop();
	},

	_moveToTop: function( event, silent ) {
		var moved = false,
			zIndices = this.uiDialog.siblings( ".ui-front:visible" ).map( function() {
				return +$( this ).css( "z-index" );
			} ).get(),
			zIndexMax = Math.max.apply( null, zIndices );

		if ( zIndexMax >= +this.uiDialog.css( "z-index" ) ) {
			this.uiDialog.css( "z-index", zIndexMax + 1 );
			moved = true;
		}

		if ( moved && !silent ) {
			this._trigger( "focus", event );
		}
		return moved;
	},

	open: function() {
		var that = this;
		if ( this._isOpen ) {
			if ( this._moveToTop() ) {
				this._focusTabbable();
			}
			return;
		}

		this._isOpen = true;
		this.opener = $( $.ui.safeActiveElement( this.document[ 0 ] ) );

		this._size();
		this._position();
		this._createOverlay();
		this._moveToTop( null, true );

		// Ensure the overlay is moved to the top with the dialog, but only when
		// opening. The overlay shouldn't move after the dialog is open so that
		// modeless dialogs opened after the modal dialog stack properly.
		if ( this.overlay ) {
			this.overlay.css( "z-index", this.uiDialog.css( "z-index" ) - 1 );
		}

		this._show( this.uiDialog, this.options.show, function() {
			that._focusTabbable();
			that._trigger( "focus" );
		} );

		// Track the dialog immediately upon openening in case a focus event
		// somehow occurs outside of the dialog before an element inside the
		// dialog is focused (#10152)
		this._makeFocusTarget();

		this._trigger( "open" );
	},

	_focusTabbable: function() {

		// Set focus to the first match:
		// 1. An element that was focused previously
		// 2. First element inside the dialog matching [autofocus]
		// 3. Tabbable element inside the content element
		// 4. Tabbable element inside the buttonpane
		// 5. The close button
		// 6. The dialog itself
		var hasFocus = this._focusedElement;
		if ( !hasFocus ) {
			hasFocus = this.element.find( "[autofocus]" );
		}
		if ( !hasFocus.length ) {
			hasFocus = this.element.find( ":tabbable" );
		}
		if ( !hasFocus.length ) {
			hasFocus = this.uiDialogButtonPane.find( ":tabbable" );
		}
		if ( !hasFocus.length ) {
			hasFocus = this.uiDialogTitlebarClose.filter( ":tabbable" );
		}
		if ( !hasFocus.length ) {
			hasFocus = this.uiDialog;
		}
		hasFocus.eq( 0 ).trigger( "focus" );
	},

	_keepFocus: function( event ) {
		function checkFocus() {
			var activeElement = $.ui.safeActiveElement( this.document[ 0 ] ),
				isActive = this.uiDialog[ 0 ] === activeElement ||
					$.contains( this.uiDialog[ 0 ], activeElement );
			if ( !isActive ) {
				this._focusTabbable();
			}
		}
		event.preventDefault();
		checkFocus.call( this );

		// support: IE
		// IE <= 8 doesn't prevent moving focus even with event.preventDefault()
		// so we check again later
		this._delay( checkFocus );
	},

	_createWrapper: function() {
		this.uiDialog = $( "<div>" )
			.hide()
			.attr( {

				// Setting tabIndex makes the div focusable
				tabIndex: -1,
				role: "dialog"
			} )
			.appendTo( this._appendTo() );

		this._addClass( this.uiDialog, "ui-dialog", "ui-widget ui-widget-content ui-front" );
		this._on( this.uiDialog, {
			keydown: function( event ) {
				if ( this.options.closeOnEscape && !event.isDefaultPrevented() && event.keyCode &&
						event.keyCode === $.ui.keyCode.ESCAPE ) {
					event.preventDefault();
					this.close( event );
					return;
				}

				// Prevent tabbing out of dialogs
				if ( event.keyCode !== $.ui.keyCode.TAB || event.isDefaultPrevented() ) {
					return;
				}
				var tabbables = this.uiDialog.find( ":tabbable" ),
					first = tabbables.filter( ":first" ),
					last = tabbables.filter( ":last" );

				if ( ( event.target === last[ 0 ] || event.target === this.uiDialog[ 0 ] ) &&
						!event.shiftKey ) {
					this._delay( function() {
						first.trigger( "focus" );
					} );
					event.preventDefault();
				} else if ( ( event.target === first[ 0 ] ||
						event.target === this.uiDialog[ 0 ] ) && event.shiftKey ) {
					this._delay( function() {
						last.trigger( "focus" );
					} );
					event.preventDefault();
				}
			},
			mousedown: function( event ) {
				if ( this._moveToTop( event ) ) {
					this._focusTabbable();
				}
			}
		} );

		// We assume that any existing aria-describedby attribute means
		// that the dialog content is marked up properly
		// otherwise we brute force the content as the description
		if ( !this.element.find( "[aria-describedby]" ).length ) {
			this.uiDialog.attr( {
				"aria-describedby": this.element.uniqueId().attr( "id" )
			} );
		}
	},

	_createTitlebar: function() {
		var uiDialogTitle;

		this.uiDialogTitlebar = $( "<div>" );
		this._addClass( this.uiDialogTitlebar,
			"ui-dialog-titlebar", "ui-widget-header ui-helper-clearfix" );
		this._on( this.uiDialogTitlebar, {
			mousedown: function( event ) {

				// Don't prevent click on close button (#8838)
				// Focusing a dialog that is partially scrolled out of view
				// causes the browser to scroll it into view, preventing the click event
				if ( !$( event.target ).closest( ".ui-dialog-titlebar-close" ) ) {

					// Dialog isn't getting focus when dragging (#8063)
					this.uiDialog.trigger( "focus" );
				}
			}
		} );

		// Support: IE
		// Use type="button" to prevent enter keypresses in textboxes from closing the
		// dialog in IE (#9312)
		this.uiDialogTitlebarClose = $( "<button type='button'></button>" )
			.button( {
				label: $( "<a>" ).text( this.options.closeText ).html(),
				icon: "ui-icon-closethick",
				showLabel: false
			} )
			.appendTo( this.uiDialogTitlebar );

		this._addClass( this.uiDialogTitlebarClose, "ui-dialog-titlebar-close" );
		this._on( this.uiDialogTitlebarClose, {
			click: function( event ) {
				event.preventDefault();
				this.close( event );
			}
		} );

		uiDialogTitle = $( "<span>" ).uniqueId().prependTo( this.uiDialogTitlebar );
		this._addClass( uiDialogTitle, "ui-dialog-title" );
		this._title( uiDialogTitle );

		this.uiDialogTitlebar.prependTo( this.uiDialog );

		this.uiDialog.attr( {
			"aria-labelledby": uiDialogTitle.attr( "id" )
		} );
	},

	_title: function( title ) {
		if ( this.options.title ) {
			title.text( this.options.title );
		} else {
			title.html( "&#160;" );
		}
	},

	_createButtonPane: function() {
		this.uiDialogButtonPane = $( "<div>" );
		this._addClass( this.uiDialogButtonPane, "ui-dialog-buttonpane",
			"ui-widget-content ui-helper-clearfix" );

		this.uiButtonSet = $( "<div>" )
			.appendTo( this.uiDialogButtonPane );
		this._addClass( this.uiButtonSet, "ui-dialog-buttonset" );

		this._createButtons();
	},

	_createButtons: function() {
		var that = this,
			buttons = this.options.buttons;

		// If we already have a button pane, remove it
		this.uiDialogButtonPane.remove();
		this.uiButtonSet.empty();

		if ( $.isEmptyObject( buttons ) || ( $.isArray( buttons ) && !buttons.length ) ) {
			this._removeClass( this.uiDialog, "ui-dialog-buttons" );
			return;
		}

		$.each( buttons, function( name, props ) {
			var click, buttonOptions;
			props = $.isFunction( props ) ?
				{ click: props, text: name } :
				props;

			// Default to a non-submitting button
			props = $.extend( { type: "button" }, props );

			// Change the context for the click callback to be the main element
			click = props.click;
			buttonOptions = {
				icon: props.icon,
				iconPosition: props.iconPosition,
				showLabel: props.showLabel,

				// Deprecated options
				icons: props.icons,
				text: props.text
			};

			delete props.click;
			delete props.icon;
			delete props.iconPosition;
			delete props.showLabel;

			// Deprecated options
			delete props.icons;
			if ( typeof props.text === "boolean" ) {
				delete props.text;
			}

			$( "<button></button>", props )
				.button( buttonOptions )
				.appendTo( that.uiButtonSet )
				.on( "click", function() {
					click.apply( that.element[ 0 ], arguments );
				} );
		} );
		this._addClass( this.uiDialog, "ui-dialog-buttons" );
		this.uiDialogButtonPane.appendTo( this.uiDialog );
	},

	_makeDraggable: function() {
		var that = this,
			options = this.options;

		function filteredUi( ui ) {
			return {
				position: ui.position,
				offset: ui.offset
			};
		}

		this.uiDialog.draggable( {
			cancel: ".ui-dialog-content, .ui-dialog-titlebar-close",
			handle: ".ui-dialog-titlebar",
			containment: "document",
			start: function( event, ui ) {
				that._addClass( $( this ), "ui-dialog-dragging" );
				that._blockFrames();
				that._trigger( "dragStart", event, filteredUi( ui ) );
			},
			drag: function( event, ui ) {
				that._trigger( "drag", event, filteredUi( ui ) );
			},
			stop: function( event, ui ) {
				var left = ui.offset.left - that.document.scrollLeft(),
					top = ui.offset.top - that.document.scrollTop();

				options.position = {
					my: "left top",
					at: "left" + ( left >= 0 ? "+" : "" ) + left + " " +
						"top" + ( top >= 0 ? "+" : "" ) + top,
					of: that.window
				};
				that._removeClass( $( this ), "ui-dialog-dragging" );
				that._unblockFrames();
				that._trigger( "dragStop", event, filteredUi( ui ) );
			}
		} );
	},

	_makeResizable: function() {
		var that = this,
			options = this.options,
			handles = options.resizable,

			// .ui-resizable has position: relative defined in the stylesheet
			// but dialogs have to use absolute or fixed positioning
			position = this.uiDialog.css( "position" ),
			resizeHandles = typeof handles === "string" ?
				handles :
				"n,e,s,w,se,sw,ne,nw";

		function filteredUi( ui ) {
			return {
				originalPosition: ui.originalPosition,
				originalSize: ui.originalSize,
				position: ui.position,
				size: ui.size
			};
		}

		this.uiDialog.resizable( {
			cancel: ".ui-dialog-content",
			containment: "document",
			alsoResize: this.element,
			maxWidth: options.maxWidth,
			maxHeight: options.maxHeight,
			minWidth: options.minWidth,
			minHeight: this._minHeight(),
			handles: resizeHandles,
			start: function( event, ui ) {
				that._addClass( $( this ), "ui-dialog-resizing" );
				that._blockFrames();
				that._trigger( "resizeStart", event, filteredUi( ui ) );
			},
			resize: function( event, ui ) {
				that._trigger( "resize", event, filteredUi( ui ) );
			},
			stop: function( event, ui ) {
				var offset = that.uiDialog.offset(),
					left = offset.left - that.document.scrollLeft(),
					top = offset.top - that.document.scrollTop();

				options.height = that.uiDialog.height();
				options.width = that.uiDialog.width();
				options.position = {
					my: "left top",
					at: "left" + ( left >= 0 ? "+" : "" ) + left + " " +
						"top" + ( top >= 0 ? "+" : "" ) + top,
					of: that.window
				};
				that._removeClass( $( this ), "ui-dialog-resizing" );
				that._unblockFrames();
				that._trigger( "resizeStop", event, filteredUi( ui ) );
			}
		} )
			.css( "position", position );
	},

	_trackFocus: function() {
		this._on( this.widget(), {
			focusin: function( event ) {
				this._makeFocusTarget();
				this._focusedElement = $( event.target );
			}
		} );
	},

	_makeFocusTarget: function() {
		this._untrackInstance();
		this._trackingInstances().unshift( this );
	},

	_untrackInstance: function() {
		var instances = this._trackingInstances(),
			exists = $.inArray( this, instances );
		if ( exists !== -1 ) {
			instances.splice( exists, 1 );
		}
	},

	_trackingInstances: function() {
		var instances = this.document.data( "ui-dialog-instances" );
		if ( !instances ) {
			instances = [];
			this.document.data( "ui-dialog-instances", instances );
		}
		return instances;
	},

	_minHeight: function() {
		var options = this.options;

		return options.height === "auto" ?
			options.minHeight :
			Math.min( options.minHeight, options.height );
	},

	_position: function() {

		// Need to show the dialog to get the actual offset in the position plugin
		var isVisible = this.uiDialog.is( ":visible" );
		if ( !isVisible ) {
			this.uiDialog.show();
		}
		this.uiDialog.position( this.options.position );
		if ( !isVisible ) {
			this.uiDialog.hide();
		}
	},

	_setOptions: function( options ) {
		var that = this,
			resize = false,
			resizableOptions = {};

		$.each( options, function( key, value ) {
			that._setOption( key, value );

			if ( key in that.sizeRelatedOptions ) {
				resize = true;
			}
			if ( key in that.resizableRelatedOptions ) {
				resizableOptions[ key ] = value;
			}
		} );

		if ( resize ) {
			this._size();
			this._position();
		}
		if ( this.uiDialog.is( ":data(ui-resizable)" ) ) {
			this.uiDialog.resizable( "option", resizableOptions );
		}
	},

	_setOption: function( key, value ) {
		var isDraggable, isResizable,
			uiDialog = this.uiDialog;

		if ( key === "disabled" ) {
			return;
		}

		this._super( key, value );

		if ( key === "appendTo" ) {
			this.uiDialog.appendTo( this._appendTo() );
		}

		if ( key === "buttons" ) {
			this._createButtons();
		}

		if ( key === "closeText" ) {
			this.uiDialogTitlebarClose.button( {

				// Ensure that we always pass a string
				label: $( "<a>" ).text( "" + this.options.closeText ).html()
			} );
		}

		if ( key === "draggable" ) {
			isDraggable = uiDialog.is( ":data(ui-draggable)" );
			if ( isDraggable && !value ) {
				uiDialog.draggable( "destroy" );
			}

			if ( !isDraggable && value ) {
				this._makeDraggable();
			}
		}

		if ( key === "position" ) {
			this._position();
		}

		if ( key === "resizable" ) {

			// currently resizable, becoming non-resizable
			isResizable = uiDialog.is( ":data(ui-resizable)" );
			if ( isResizable && !value ) {
				uiDialog.resizable( "destroy" );
			}

			// Currently resizable, changing handles
			if ( isResizable && typeof value === "string" ) {
				uiDialog.resizable( "option", "handles", value );
			}

			// Currently non-resizable, becoming resizable
			if ( !isResizable && value !== false ) {
				this._makeResizable();
			}
		}

		if ( key === "title" ) {
			this._title( this.uiDialogTitlebar.find( ".ui-dialog-title" ) );
		}
	},

	_size: function() {

		// If the user has resized the dialog, the .ui-dialog and .ui-dialog-content
		// divs will both have width and height set, so we need to reset them
		var nonContentHeight, minContentHeight, maxContentHeight,
			options = this.options;

		// Reset content sizing
		this.element.show().css( {
			width: "auto",
			minHeight: 0,
			maxHeight: "none",
			height: 0
		} );

		if ( options.minWidth > options.width ) {
			options.width = options.minWidth;
		}

		// Reset wrapper sizing
		// determine the height of all the non-content elements
		nonContentHeight = this.uiDialog.css( {
			height: "auto",
			width: options.width
		} )
			.outerHeight();
		minContentHeight = Math.max( 0, options.minHeight - nonContentHeight );
		maxContentHeight = typeof options.maxHeight === "number" ?
			Math.max( 0, options.maxHeight - nonContentHeight ) :
			"none";

		if ( options.height === "auto" ) {
			this.element.css( {
				minHeight: minContentHeight,
				maxHeight: maxContentHeight,
				height: "auto"
			} );
		} else {
			this.element.height( Math.max( 0, options.height - nonContentHeight ) );
		}

		if ( this.uiDialog.is( ":data(ui-resizable)" ) ) {
			this.uiDialog.resizable( "option", "minHeight", this._minHeight() );
		}
	},

	_blockFrames: function() {
		this.iframeBlocks = this.document.find( "iframe" ).map( function() {
			var iframe = $( this );

			return $( "<div>" )
				.css( {
					position: "absolute",
					width: iframe.outerWidth(),
					height: iframe.outerHeight()
				} )
				.appendTo( iframe.parent() )
				.offset( iframe.offset() )[ 0 ];
		} );
	},

	_unblockFrames: function() {
		if ( this.iframeBlocks ) {
			this.iframeBlocks.remove();
			delete this.iframeBlocks;
		}
	},

	_allowInteraction: function( event ) {
		if ( $( event.target ).closest( ".ui-dialog" ).length ) {
			return true;
		}

		// TODO: Remove hack when datepicker implements
		// the .ui-front logic (#8989)
		return !!$( event.target ).closest( ".ui-datepicker" ).length;
	},

	_createOverlay: function() {
		if ( !this.options.modal ) {
			return;
		}

		// We use a delay in case the overlay is created from an
		// event that we're going to be cancelling (#2804)
		var isOpening = true;
		this._delay( function() {
			isOpening = false;
		} );

		if ( !this.document.data( "ui-dialog-overlays" ) ) {

			// Prevent use of anchors and inputs
			// Using _on() for an event handler shared across many instances is
			// safe because the dialogs stack and must be closed in reverse order
			this._on( this.document, {
				focusin: function( event ) {
					if ( isOpening ) {
						return;
					}

					if ( !this._allowInteraction( event ) ) {
						event.preventDefault();
						this._trackingInstances()[ 0 ]._focusTabbable();
					}
				}
			} );
		}

		this.overlay = $( "<div>" )
			.appendTo( this._appendTo() );

		this._addClass( this.overlay, null, "ui-widget-overlay ui-front" );
		this._on( this.overlay, {
			mousedown: "_keepFocus"
		} );
		this.document.data( "ui-dialog-overlays",
			( this.document.data( "ui-dialog-overlays" ) || 0 ) + 1 );
	},

	_destroyOverlay: function() {
		if ( !this.options.modal ) {
			return;
		}

		if ( this.overlay ) {
			var overlays = this.document.data( "ui-dialog-overlays" ) - 1;

			if ( !overlays ) {
				this._off( this.document, "focusin" );
				this.document.removeData( "ui-dialog-overlays" );
			} else {
				this.document.data( "ui-dialog-overlays", overlays );
			}

			this.overlay.remove();
			this.overlay = null;
		}
	}
} );

// DEPRECATED
// TODO: switch return back to widget declaration at top of file when this is removed
if ( $.uiBackCompat !== false ) {

	// Backcompat for dialogClass option
	$.widget( "ui.dialog", $.ui.dialog, {
		options: {
			dialogClass: ""
		},
		_createWrapper: function() {
			this._super();
			this.uiDialog.addClass( this.options.dialogClass );
		},
		_setOption: function( key, value ) {
			if ( key === "dialogClass" ) {
				this.uiDialog
					.removeClass( this.options.dialogClass )
					.addClass( value );
			}
			this._superApply( arguments );
		}
	} );
}

return $.ui.dialog;

} ) );

},{}],64:[function(require,module,exports){
/*!
 * jQuery UI Draggable 1.12.1
 * http://jqueryui.com
 *
 * Copyright jQuery Foundation and other contributors
 * Released under the MIT license.
 * http://jquery.org/license
 */

//>>label: Draggable
//>>group: Interactions
//>>description: Enables dragging functionality for any element.
//>>docs: http://api.jqueryui.com/draggable/
//>>demos: http://jqueryui.com/draggable/
//>>css.structure: ../../themes/base/draggable.css

( function( factory ) {
	if ( typeof define === "function" && define.amd ) {

		// AMD. Register as an anonymous module.
		define( [
			"jquery",
			"./mouse",
			"../data",
			"../plugin",
			"../safe-active-element",
			"../safe-blur",
			"../scroll-parent",
			"../version",
			"../widget"
		], factory );
	} else {

		// Browser globals
		factory( jQuery );
	}
}( function( $ ) {

$.widget( "ui.draggable", $.ui.mouse, {
	version: "1.12.1",
	widgetEventPrefix: "drag",
	options: {
		addClasses: true,
		appendTo: "parent",
		axis: false,
		connectToSortable: false,
		containment: false,
		cursor: "auto",
		cursorAt: false,
		grid: false,
		handle: false,
		helper: "original",
		iframeFix: false,
		opacity: false,
		refreshPositions: false,
		revert: false,
		revertDuration: 500,
		scope: "default",
		scroll: true,
		scrollSensitivity: 20,
		scrollSpeed: 20,
		snap: false,
		snapMode: "both",
		snapTolerance: 20,
		stack: false,
		zIndex: false,

		// Callbacks
		drag: null,
		start: null,
		stop: null
	},
	_create: function() {

		if ( this.options.helper === "original" ) {
			this._setPositionRelative();
		}
		if ( this.options.addClasses ) {
			this._addClass( "ui-draggable" );
		}
		this._setHandleClassName();

		this._mouseInit();
	},

	_setOption: function( key, value ) {
		this._super( key, value );
		if ( key === "handle" ) {
			this._removeHandleClassName();
			this._setHandleClassName();
		}
	},

	_destroy: function() {
		if ( ( this.helper || this.element ).is( ".ui-draggable-dragging" ) ) {
			this.destroyOnClear = true;
			return;
		}
		this._removeHandleClassName();
		this._mouseDestroy();
	},

	_mouseCapture: function( event ) {
		var o = this.options;

		// Among others, prevent a drag on a resizable-handle
		if ( this.helper || o.disabled ||
				$( event.target ).closest( ".ui-resizable-handle" ).length > 0 ) {
			return false;
		}

		//Quit if we're not on a valid handle
		this.handle = this._getHandle( event );
		if ( !this.handle ) {
			return false;
		}

		this._blurActiveElement( event );

		this._blockFrames( o.iframeFix === true ? "iframe" : o.iframeFix );

		return true;

	},

	_blockFrames: function( selector ) {
		this.iframeBlocks = this.document.find( selector ).map( function() {
			var iframe = $( this );

			return $( "<div>" )
				.css( "position", "absolute" )
				.appendTo( iframe.parent() )
				.outerWidth( iframe.outerWidth() )
				.outerHeight( iframe.outerHeight() )
				.offset( iframe.offset() )[ 0 ];
		} );
	},

	_unblockFrames: function() {
		if ( this.iframeBlocks ) {
			this.iframeBlocks.remove();
			delete this.iframeBlocks;
		}
	},

	_blurActiveElement: function( event ) {
		var activeElement = $.ui.safeActiveElement( this.document[ 0 ] ),
			target = $( event.target );

		// Don't blur if the event occurred on an element that is within
		// the currently focused element
		// See #10527, #12472
		if ( target.closest( activeElement ).length ) {
			return;
		}

		// Blur any element that currently has focus, see #4261
		$.ui.safeBlur( activeElement );
	},

	_mouseStart: function( event ) {

		var o = this.options;

		//Create and append the visible helper
		this.helper = this._createHelper( event );

		this._addClass( this.helper, "ui-draggable-dragging" );

		//Cache the helper size
		this._cacheHelperProportions();

		//If ddmanager is used for droppables, set the global draggable
		if ( $.ui.ddmanager ) {
			$.ui.ddmanager.current = this;
		}

		/*
		 * - Position generation -
		 * This block generates everything position related - it's the core of draggables.
		 */

		//Cache the margins of the original element
		this._cacheMargins();

		//Store the helper's css position
		this.cssPosition = this.helper.css( "position" );
		this.scrollParent = this.helper.scrollParent( true );
		this.offsetParent = this.helper.offsetParent();
		this.hasFixedAncestor = this.helper.parents().filter( function() {
				return $( this ).css( "position" ) === "fixed";
			} ).length > 0;

		//The element's absolute position on the page minus margins
		this.positionAbs = this.element.offset();
		this._refreshOffsets( event );

		//Generate the original position
		this.originalPosition = this.position = this._generatePosition( event, false );
		this.originalPageX = event.pageX;
		this.originalPageY = event.pageY;

		//Adjust the mouse offset relative to the helper if "cursorAt" is supplied
		( o.cursorAt && this._adjustOffsetFromHelper( o.cursorAt ) );

		//Set a containment if given in the options
		this._setContainment();

		//Trigger event + callbacks
		if ( this._trigger( "start", event ) === false ) {
			this._clear();
			return false;
		}

		//Recache the helper size
		this._cacheHelperProportions();

		//Prepare the droppable offsets
		if ( $.ui.ddmanager && !o.dropBehaviour ) {
			$.ui.ddmanager.prepareOffsets( this, event );
		}

		// Execute the drag once - this causes the helper not to be visible before getting its
		// correct position
		this._mouseDrag( event, true );

		// If the ddmanager is used for droppables, inform the manager that dragging has started
		// (see #5003)
		if ( $.ui.ddmanager ) {
			$.ui.ddmanager.dragStart( this, event );
		}

		return true;
	},

	_refreshOffsets: function( event ) {
		this.offset = {
			top: this.positionAbs.top - this.margins.top,
			left: this.positionAbs.left - this.margins.left,
			scroll: false,
			parent: this._getParentOffset(),
			relative: this._getRelativeOffset()
		};

		this.offset.click = {
			left: event.pageX - this.offset.left,
			top: event.pageY - this.offset.top
		};
	},

	_mouseDrag: function( event, noPropagation ) {

		// reset any necessary cached properties (see #5009)
		if ( this.hasFixedAncestor ) {
			this.offset.parent = this._getParentOffset();
		}

		//Compute the helpers position
		this.position = this._generatePosition( event, true );
		this.positionAbs = this._convertPositionTo( "absolute" );

		//Call plugins and callbacks and use the resulting position if something is returned
		if ( !noPropagation ) {
			var ui = this._uiHash();
			if ( this._trigger( "drag", event, ui ) === false ) {
				this._mouseUp( new $.Event( "mouseup", event ) );
				return false;
			}
			this.position = ui.position;
		}

		this.helper[ 0 ].style.left = this.position.left + "px";
		this.helper[ 0 ].style.top = this.position.top + "px";

		if ( $.ui.ddmanager ) {
			$.ui.ddmanager.drag( this, event );
		}

		return false;
	},

	_mouseStop: function( event ) {

		//If we are using droppables, inform the manager about the drop
		var that = this,
			dropped = false;
		if ( $.ui.ddmanager && !this.options.dropBehaviour ) {
			dropped = $.ui.ddmanager.drop( this, event );
		}

		//if a drop comes from outside (a sortable)
		if ( this.dropped ) {
			dropped = this.dropped;
			this.dropped = false;
		}

		if ( ( this.options.revert === "invalid" && !dropped ) ||
				( this.options.revert === "valid" && dropped ) ||
				this.options.revert === true || ( $.isFunction( this.options.revert ) &&
				this.options.revert.call( this.element, dropped ) )
		) {
			$( this.helper ).animate(
				this.originalPosition,
				parseInt( this.options.revertDuration, 10 ),
				function() {
					if ( that._trigger( "stop", event ) !== false ) {
						that._clear();
					}
				}
			);
		} else {
			if ( this._trigger( "stop", event ) !== false ) {
				this._clear();
			}
		}

		return false;
	},

	_mouseUp: function( event ) {
		this._unblockFrames();

		// If the ddmanager is used for droppables, inform the manager that dragging has stopped
		// (see #5003)
		if ( $.ui.ddmanager ) {
			$.ui.ddmanager.dragStop( this, event );
		}

		// Only need to focus if the event occurred on the draggable itself, see #10527
		if ( this.handleElement.is( event.target ) ) {

			// The interaction is over; whether or not the click resulted in a drag,
			// focus the element
			this.element.trigger( "focus" );
		}

		return $.ui.mouse.prototype._mouseUp.call( this, event );
	},

	cancel: function() {

		if ( this.helper.is( ".ui-draggable-dragging" ) ) {
			this._mouseUp( new $.Event( "mouseup", { target: this.element[ 0 ] } ) );
		} else {
			this._clear();
		}

		return this;

	},

	_getHandle: function( event ) {
		return this.options.handle ?
			!!$( event.target ).closest( this.element.find( this.options.handle ) ).length :
			true;
	},

	_setHandleClassName: function() {
		this.handleElement = this.options.handle ?
			this.element.find( this.options.handle ) : this.element;
		this._addClass( this.handleElement, "ui-draggable-handle" );
	},

	_removeHandleClassName: function() {
		this._removeClass( this.handleElement, "ui-draggable-handle" );
	},

	_createHelper: function( event ) {

		var o = this.options,
			helperIsFunction = $.isFunction( o.helper ),
			helper = helperIsFunction ?
				$( o.helper.apply( this.element[ 0 ], [ event ] ) ) :
				( o.helper === "clone" ?
					this.element.clone().removeAttr( "id" ) :
					this.element );

		if ( !helper.parents( "body" ).length ) {
			helper.appendTo( ( o.appendTo === "parent" ?
				this.element[ 0 ].parentNode :
				o.appendTo ) );
		}

		// Http://bugs.jqueryui.com/ticket/9446
		// a helper function can return the original element
		// which wouldn't have been set to relative in _create
		if ( helperIsFunction && helper[ 0 ] === this.element[ 0 ] ) {
			this._setPositionRelative();
		}

		if ( helper[ 0 ] !== this.element[ 0 ] &&
				!( /(fixed|absolute)/ ).test( helper.css( "position" ) ) ) {
			helper.css( "position", "absolute" );
		}

		return helper;

	},

	_setPositionRelative: function() {
		if ( !( /^(?:r|a|f)/ ).test( this.element.css( "position" ) ) ) {
			this.element[ 0 ].style.position = "relative";
		}
	},

	_adjustOffsetFromHelper: function( obj ) {
		if ( typeof obj === "string" ) {
			obj = obj.split( " " );
		}
		if ( $.isArray( obj ) ) {
			obj = { left: +obj[ 0 ], top: +obj[ 1 ] || 0 };
		}
		if ( "left" in obj ) {
			this.offset.click.left = obj.left + this.margins.left;
		}
		if ( "right" in obj ) {
			this.offset.click.left = this.helperProportions.width - obj.right + this.margins.left;
		}
		if ( "top" in obj ) {
			this.offset.click.top = obj.top + this.margins.top;
		}
		if ( "bottom" in obj ) {
			this.offset.click.top = this.helperProportions.height - obj.bottom + this.margins.top;
		}
	},

	_isRootNode: function( element ) {
		return ( /(html|body)/i ).test( element.tagName ) || element === this.document[ 0 ];
	},

	_getParentOffset: function() {

		//Get the offsetParent and cache its position
		var po = this.offsetParent.offset(),
			document = this.document[ 0 ];

		// This is a special case where we need to modify a offset calculated on start, since the
		// following happened:
		// 1. The position of the helper is absolute, so it's position is calculated based on the
		// next positioned parent
		// 2. The actual offset parent is a child of the scroll parent, and the scroll parent isn't
		// the document, which means that the scroll is included in the initial calculation of the
		// offset of the parent, and never recalculated upon drag
		if ( this.cssPosition === "absolute" && this.scrollParent[ 0 ] !== document &&
				$.contains( this.scrollParent[ 0 ], this.offsetParent[ 0 ] ) ) {
			po.left += this.scrollParent.scrollLeft();
			po.top += this.scrollParent.scrollTop();
		}

		if ( this._isRootNode( this.offsetParent[ 0 ] ) ) {
			po = { top: 0, left: 0 };
		}

		return {
			top: po.top + ( parseInt( this.offsetParent.css( "borderTopWidth" ), 10 ) || 0 ),
			left: po.left + ( parseInt( this.offsetParent.css( "borderLeftWidth" ), 10 ) || 0 )
		};

	},

	_getRelativeOffset: function() {
		if ( this.cssPosition !== "relative" ) {
			return { top: 0, left: 0 };
		}

		var p = this.element.position(),
			scrollIsRootNode = this._isRootNode( this.scrollParent[ 0 ] );

		return {
			top: p.top - ( parseInt( this.helper.css( "top" ), 10 ) || 0 ) +
				( !scrollIsRootNode ? this.scrollParent.scrollTop() : 0 ),
			left: p.left - ( parseInt( this.helper.css( "left" ), 10 ) || 0 ) +
				( !scrollIsRootNode ? this.scrollParent.scrollLeft() : 0 )
		};

	},

	_cacheMargins: function() {
		this.margins = {
			left: ( parseInt( this.element.css( "marginLeft" ), 10 ) || 0 ),
			top: ( parseInt( this.element.css( "marginTop" ), 10 ) || 0 ),
			right: ( parseInt( this.element.css( "marginRight" ), 10 ) || 0 ),
			bottom: ( parseInt( this.element.css( "marginBottom" ), 10 ) || 0 )
		};
	},

	_cacheHelperProportions: function() {
		this.helperProportions = {
			width: this.helper.outerWidth(),
			height: this.helper.outerHeight()
		};
	},

	_setContainment: function() {

		var isUserScrollable, c, ce,
			o = this.options,
			document = this.document[ 0 ];

		this.relativeContainer = null;

		if ( !o.containment ) {
			this.containment = null;
			return;
		}

		if ( o.containment === "window" ) {
			this.containment = [
				$( window ).scrollLeft() - this.offset.relative.left - this.offset.parent.left,
				$( window ).scrollTop() - this.offset.relative.top - this.offset.parent.top,
				$( window ).scrollLeft() + $( window ).width() -
					this.helperProportions.width - this.margins.left,
				$( window ).scrollTop() +
					( $( window ).height() || document.body.parentNode.scrollHeight ) -
					this.helperProportions.height - this.margins.top
			];
			return;
		}

		if ( o.containment === "document" ) {
			this.containment = [
				0,
				0,
				$( document ).width() - this.helperProportions.width - this.margins.left,
				( $( document ).height() || document.body.parentNode.scrollHeight ) -
					this.helperProportions.height - this.margins.top
			];
			return;
		}

		if ( o.containment.constructor === Array ) {
			this.containment = o.containment;
			return;
		}

		if ( o.containment === "parent" ) {
			o.containment = this.helper[ 0 ].parentNode;
		}

		c = $( o.containment );
		ce = c[ 0 ];

		if ( !ce ) {
			return;
		}

		isUserScrollable = /(scroll|auto)/.test( c.css( "overflow" ) );

		this.containment = [
			( parseInt( c.css( "borderLeftWidth" ), 10 ) || 0 ) +
				( parseInt( c.css( "paddingLeft" ), 10 ) || 0 ),
			( parseInt( c.css( "borderTopWidth" ), 10 ) || 0 ) +
				( parseInt( c.css( "paddingTop" ), 10 ) || 0 ),
			( isUserScrollable ? Math.max( ce.scrollWidth, ce.offsetWidth ) : ce.offsetWidth ) -
				( parseInt( c.css( "borderRightWidth" ), 10 ) || 0 ) -
				( parseInt( c.css( "paddingRight" ), 10 ) || 0 ) -
				this.helperProportions.width -
				this.margins.left -
				this.margins.right,
			( isUserScrollable ? Math.max( ce.scrollHeight, ce.offsetHeight ) : ce.offsetHeight ) -
				( parseInt( c.css( "borderBottomWidth" ), 10 ) || 0 ) -
				( parseInt( c.css( "paddingBottom" ), 10 ) || 0 ) -
				this.helperProportions.height -
				this.margins.top -
				this.margins.bottom
		];
		this.relativeContainer = c;
	},

	_convertPositionTo: function( d, pos ) {

		if ( !pos ) {
			pos = this.position;
		}

		var mod = d === "absolute" ? 1 : -1,
			scrollIsRootNode = this._isRootNode( this.scrollParent[ 0 ] );

		return {
			top: (

				// The absolute mouse position
				pos.top	+

				// Only for relative positioned nodes: Relative offset from element to offset parent
				this.offset.relative.top * mod +

				// The offsetParent's offset without borders (offset + border)
				this.offset.parent.top * mod -
				( ( this.cssPosition === "fixed" ?
					-this.offset.scroll.top :
					( scrollIsRootNode ? 0 : this.offset.scroll.top ) ) * mod )
			),
			left: (

				// The absolute mouse position
				pos.left +

				// Only for relative positioned nodes: Relative offset from element to offset parent
				this.offset.relative.left * mod +

				// The offsetParent's offset without borders (offset + border)
				this.offset.parent.left * mod	-
				( ( this.cssPosition === "fixed" ?
					-this.offset.scroll.left :
					( scrollIsRootNode ? 0 : this.offset.scroll.left ) ) * mod )
			)
		};

	},

	_generatePosition: function( event, constrainPosition ) {

		var containment, co, top, left,
			o = this.options,
			scrollIsRootNode = this._isRootNode( this.scrollParent[ 0 ] ),
			pageX = event.pageX,
			pageY = event.pageY;

		// Cache the scroll
		if ( !scrollIsRootNode || !this.offset.scroll ) {
			this.offset.scroll = {
				top: this.scrollParent.scrollTop(),
				left: this.scrollParent.scrollLeft()
			};
		}

		/*
		 * - Position constraining -
		 * Constrain the position to a mix of grid, containment.
		 */

		// If we are not dragging yet, we won't check for options
		if ( constrainPosition ) {
			if ( this.containment ) {
				if ( this.relativeContainer ) {
					co = this.relativeContainer.offset();
					containment = [
						this.containment[ 0 ] + co.left,
						this.containment[ 1 ] + co.top,
						this.containment[ 2 ] + co.left,
						this.containment[ 3 ] + co.top
					];
				} else {
					containment = this.containment;
				}

				if ( event.pageX - this.offset.click.left < containment[ 0 ] ) {
					pageX = containment[ 0 ] + this.offset.click.left;
				}
				if ( event.pageY - this.offset.click.top < containment[ 1 ] ) {
					pageY = containment[ 1 ] + this.offset.click.top;
				}
				if ( event.pageX - this.offset.click.left > containment[ 2 ] ) {
					pageX = containment[ 2 ] + this.offset.click.left;
				}
				if ( event.pageY - this.offset.click.top > containment[ 3 ] ) {
					pageY = containment[ 3 ] + this.offset.click.top;
				}
			}

			if ( o.grid ) {

				//Check for grid elements set to 0 to prevent divide by 0 error causing invalid
				// argument errors in IE (see ticket #6950)
				top = o.grid[ 1 ] ? this.originalPageY + Math.round( ( pageY -
					this.originalPageY ) / o.grid[ 1 ] ) * o.grid[ 1 ] : this.originalPageY;
				pageY = containment ? ( ( top - this.offset.click.top >= containment[ 1 ] ||
					top - this.offset.click.top > containment[ 3 ] ) ?
						top :
						( ( top - this.offset.click.top >= containment[ 1 ] ) ?
							top - o.grid[ 1 ] : top + o.grid[ 1 ] ) ) : top;

				left = o.grid[ 0 ] ? this.originalPageX +
					Math.round( ( pageX - this.originalPageX ) / o.grid[ 0 ] ) * o.grid[ 0 ] :
					this.originalPageX;
				pageX = containment ? ( ( left - this.offset.click.left >= containment[ 0 ] ||
					left - this.offset.click.left > containment[ 2 ] ) ?
						left :
						( ( left - this.offset.click.left >= containment[ 0 ] ) ?
							left - o.grid[ 0 ] : left + o.grid[ 0 ] ) ) : left;
			}

			if ( o.axis === "y" ) {
				pageX = this.originalPageX;
			}

			if ( o.axis === "x" ) {
				pageY = this.originalPageY;
			}
		}

		return {
			top: (

				// The absolute mouse position
				pageY -

				// Click offset (relative to the element)
				this.offset.click.top -

				// Only for relative positioned nodes: Relative offset from element to offset parent
				this.offset.relative.top -

				// The offsetParent's offset without borders (offset + border)
				this.offset.parent.top +
				( this.cssPosition === "fixed" ?
					-this.offset.scroll.top :
					( scrollIsRootNode ? 0 : this.offset.scroll.top ) )
			),
			left: (

				// The absolute mouse position
				pageX -

				// Click offset (relative to the element)
				this.offset.click.left -

				// Only for relative positioned nodes: Relative offset from element to offset parent
				this.offset.relative.left -

				// The offsetParent's offset without borders (offset + border)
				this.offset.parent.left +
				( this.cssPosition === "fixed" ?
					-this.offset.scroll.left :
					( scrollIsRootNode ? 0 : this.offset.scroll.left ) )
			)
		};

	},

	_clear: function() {
		this._removeClass( this.helper, "ui-draggable-dragging" );
		if ( this.helper[ 0 ] !== this.element[ 0 ] && !this.cancelHelperRemoval ) {
			this.helper.remove();
		}
		this.helper = null;
		this.cancelHelperRemoval = false;
		if ( this.destroyOnClear ) {
			this.destroy();
		}
	},

	// From now on bulk stuff - mainly helpers

	_trigger: function( type, event, ui ) {
		ui = ui || this._uiHash();
		$.ui.plugin.call( this, type, [ event, ui, this ], true );

		// Absolute position and offset (see #6884 ) have to be recalculated after plugins
		if ( /^(drag|start|stop)/.test( type ) ) {
			this.positionAbs = this._convertPositionTo( "absolute" );
			ui.offset = this.positionAbs;
		}
		return $.Widget.prototype._trigger.call( this, type, event, ui );
	},

	plugins: {},

	_uiHash: function() {
		return {
			helper: this.helper,
			position: this.position,
			originalPosition: this.originalPosition,
			offset: this.positionAbs
		};
	}

} );

$.ui.plugin.add( "draggable", "connectToSortable", {
	start: function( event, ui, draggable ) {
		var uiSortable = $.extend( {}, ui, {
			item: draggable.element
		} );

		draggable.sortables = [];
		$( draggable.options.connectToSortable ).each( function() {
			var sortable = $( this ).sortable( "instance" );

			if ( sortable && !sortable.options.disabled ) {
				draggable.sortables.push( sortable );

				// RefreshPositions is called at drag start to refresh the containerCache
				// which is used in drag. This ensures it's initialized and synchronized
				// with any changes that might have happened on the page since initialization.
				sortable.refreshPositions();
				sortable._trigger( "activate", event, uiSortable );
			}
		} );
	},
	stop: function( event, ui, draggable ) {
		var uiSortable = $.extend( {}, ui, {
			item: draggable.element
		} );

		draggable.cancelHelperRemoval = false;

		$.each( draggable.sortables, function() {
			var sortable = this;

			if ( sortable.isOver ) {
				sortable.isOver = 0;

				// Allow this sortable to handle removing the helper
				draggable.cancelHelperRemoval = true;
				sortable.cancelHelperRemoval = false;

				// Use _storedCSS To restore properties in the sortable,
				// as this also handles revert (#9675) since the draggable
				// may have modified them in unexpected ways (#8809)
				sortable._storedCSS = {
					position: sortable.placeholder.css( "position" ),
					top: sortable.placeholder.css( "top" ),
					left: sortable.placeholder.css( "left" )
				};

				sortable._mouseStop( event );

				// Once drag has ended, the sortable should return to using
				// its original helper, not the shared helper from draggable
				sortable.options.helper = sortable.options._helper;
			} else {

				// Prevent this Sortable from removing the helper.
				// However, don't set the draggable to remove the helper
				// either as another connected Sortable may yet handle the removal.
				sortable.cancelHelperRemoval = true;

				sortable._trigger( "deactivate", event, uiSortable );
			}
		} );
	},
	drag: function( event, ui, draggable ) {
		$.each( draggable.sortables, function() {
			var innermostIntersecting = false,
				sortable = this;

			// Copy over variables that sortable's _intersectsWith uses
			sortable.positionAbs = draggable.positionAbs;
			sortable.helperProportions = draggable.helperProportions;
			sortable.offset.click = draggable.offset.click;

			if ( sortable._intersectsWith( sortable.containerCache ) ) {
				innermostIntersecting = true;

				$.each( draggable.sortables, function() {

					// Copy over variables that sortable's _intersectsWith uses
					this.positionAbs = draggable.positionAbs;
					this.helperProportions = draggable.helperProportions;
					this.offset.click = draggable.offset.click;

					if ( this !== sortable &&
							this._intersectsWith( this.containerCache ) &&
							$.contains( sortable.element[ 0 ], this.element[ 0 ] ) ) {
						innermostIntersecting = false;
					}

					return innermostIntersecting;
				} );
			}

			if ( innermostIntersecting ) {

				// If it intersects, we use a little isOver variable and set it once,
				// so that the move-in stuff gets fired only once.
				if ( !sortable.isOver ) {
					sortable.isOver = 1;

					// Store draggable's parent in case we need to reappend to it later.
					draggable._parent = ui.helper.parent();

					sortable.currentItem = ui.helper
						.appendTo( sortable.element )
						.data( "ui-sortable-item", true );

					// Store helper option to later restore it
					sortable.options._helper = sortable.options.helper;

					sortable.options.helper = function() {
						return ui.helper[ 0 ];
					};

					// Fire the start events of the sortable with our passed browser event,
					// and our own helper (so it doesn't create a new one)
					event.target = sortable.currentItem[ 0 ];
					sortable._mouseCapture( event, true );
					sortable._mouseStart( event, true, true );

					// Because the browser event is way off the new appended portlet,
					// modify necessary variables to reflect the changes
					sortable.offset.click.top = draggable.offset.click.top;
					sortable.offset.click.left = draggable.offset.click.left;
					sortable.offset.parent.left -= draggable.offset.parent.left -
						sortable.offset.parent.left;
					sortable.offset.parent.top -= draggable.offset.parent.top -
						sortable.offset.parent.top;

					draggable._trigger( "toSortable", event );

					// Inform draggable that the helper is in a valid drop zone,
					// used solely in the revert option to handle "valid/invalid".
					draggable.dropped = sortable.element;

					// Need to refreshPositions of all sortables in the case that
					// adding to one sortable changes the location of the other sortables (#9675)
					$.each( draggable.sortables, function() {
						this.refreshPositions();
					} );

					// Hack so receive/update callbacks work (mostly)
					draggable.currentItem = draggable.element;
					sortable.fromOutside = draggable;
				}

				if ( sortable.currentItem ) {
					sortable._mouseDrag( event );

					// Copy the sortable's position because the draggable's can potentially reflect
					// a relative position, while sortable is always absolute, which the dragged
					// element has now become. (#8809)
					ui.position = sortable.position;
				}
			} else {

				// If it doesn't intersect with the sortable, and it intersected before,
				// we fake the drag stop of the sortable, but make sure it doesn't remove
				// the helper by using cancelHelperRemoval.
				if ( sortable.isOver ) {

					sortable.isOver = 0;
					sortable.cancelHelperRemoval = true;

					// Calling sortable's mouseStop would trigger a revert,
					// so revert must be temporarily false until after mouseStop is called.
					sortable.options._revert = sortable.options.revert;
					sortable.options.revert = false;

					sortable._trigger( "out", event, sortable._uiHash( sortable ) );
					sortable._mouseStop( event, true );

					// Restore sortable behaviors that were modfied
					// when the draggable entered the sortable area (#9481)
					sortable.options.revert = sortable.options._revert;
					sortable.options.helper = sortable.options._helper;

					if ( sortable.placeholder ) {
						sortable.placeholder.remove();
					}

					// Restore and recalculate the draggable's offset considering the sortable
					// may have modified them in unexpected ways. (#8809, #10669)
					ui.helper.appendTo( draggable._parent );
					draggable._refreshOffsets( event );
					ui.position = draggable._generatePosition( event, true );

					draggable._trigger( "fromSortable", event );

					// Inform draggable that the helper is no longer in a valid drop zone
					draggable.dropped = false;

					// Need to refreshPositions of all sortables just in case removing
					// from one sortable changes the location of other sortables (#9675)
					$.each( draggable.sortables, function() {
						this.refreshPositions();
					} );
				}
			}
		} );
	}
} );

$.ui.plugin.add( "draggable", "cursor", {
	start: function( event, ui, instance ) {
		var t = $( "body" ),
			o = instance.options;

		if ( t.css( "cursor" ) ) {
			o._cursor = t.css( "cursor" );
		}
		t.css( "cursor", o.cursor );
	},
	stop: function( event, ui, instance ) {
		var o = instance.options;
		if ( o._cursor ) {
			$( "body" ).css( "cursor", o._cursor );
		}
	}
} );

$.ui.plugin.add( "draggable", "opacity", {
	start: function( event, ui, instance ) {
		var t = $( ui.helper ),
			o = instance.options;
		if ( t.css( "opacity" ) ) {
			o._opacity = t.css( "opacity" );
		}
		t.css( "opacity", o.opacity );
	},
	stop: function( event, ui, instance ) {
		var o = instance.options;
		if ( o._opacity ) {
			$( ui.helper ).css( "opacity", o._opacity );
		}
	}
} );

$.ui.plugin.add( "draggable", "scroll", {
	start: function( event, ui, i ) {
		if ( !i.scrollParentNotHidden ) {
			i.scrollParentNotHidden = i.helper.scrollParent( false );
		}

		if ( i.scrollParentNotHidden[ 0 ] !== i.document[ 0 ] &&
				i.scrollParentNotHidden[ 0 ].tagName !== "HTML" ) {
			i.overflowOffset = i.scrollParentNotHidden.offset();
		}
	},
	drag: function( event, ui, i  ) {

		var o = i.options,
			scrolled = false,
			scrollParent = i.scrollParentNotHidden[ 0 ],
			document = i.document[ 0 ];

		if ( scrollParent !== document && scrollParent.tagName !== "HTML" ) {
			if ( !o.axis || o.axis !== "x" ) {
				if ( ( i.overflowOffset.top + scrollParent.offsetHeight ) - event.pageY <
						o.scrollSensitivity ) {
					scrollParent.scrollTop = scrolled = scrollParent.scrollTop + o.scrollSpeed;
				} else if ( event.pageY - i.overflowOffset.top < o.scrollSensitivity ) {
					scrollParent.scrollTop = scrolled = scrollParent.scrollTop - o.scrollSpeed;
				}
			}

			if ( !o.axis || o.axis !== "y" ) {
				if ( ( i.overflowOffset.left + scrollParent.offsetWidth ) - event.pageX <
						o.scrollSensitivity ) {
					scrollParent.scrollLeft = scrolled = scrollParent.scrollLeft + o.scrollSpeed;
				} else if ( event.pageX - i.overflowOffset.left < o.scrollSensitivity ) {
					scrollParent.scrollLeft = scrolled = scrollParent.scrollLeft - o.scrollSpeed;
				}
			}

		} else {

			if ( !o.axis || o.axis !== "x" ) {
				if ( event.pageY - $( document ).scrollTop() < o.scrollSensitivity ) {
					scrolled = $( document ).scrollTop( $( document ).scrollTop() - o.scrollSpeed );
				} else if ( $( window ).height() - ( event.pageY - $( document ).scrollTop() ) <
						o.scrollSensitivity ) {
					scrolled = $( document ).scrollTop( $( document ).scrollTop() + o.scrollSpeed );
				}
			}

			if ( !o.axis || o.axis !== "y" ) {
				if ( event.pageX - $( document ).scrollLeft() < o.scrollSensitivity ) {
					scrolled = $( document ).scrollLeft(
						$( document ).scrollLeft() - o.scrollSpeed
					);
				} else if ( $( window ).width() - ( event.pageX - $( document ).scrollLeft() ) <
						o.scrollSensitivity ) {
					scrolled = $( document ).scrollLeft(
						$( document ).scrollLeft() + o.scrollSpeed
					);
				}
			}

		}

		if ( scrolled !== false && $.ui.ddmanager && !o.dropBehaviour ) {
			$.ui.ddmanager.prepareOffsets( i, event );
		}

	}
} );

$.ui.plugin.add( "draggable", "snap", {
	start: function( event, ui, i ) {

		var o = i.options;

		i.snapElements = [];

		$( o.snap.constructor !== String ? ( o.snap.items || ":data(ui-draggable)" ) : o.snap )
			.each( function() {
				var $t = $( this ),
					$o = $t.offset();
				if ( this !== i.element[ 0 ] ) {
					i.snapElements.push( {
						item: this,
						width: $t.outerWidth(), height: $t.outerHeight(),
						top: $o.top, left: $o.left
					} );
				}
			} );

	},
	drag: function( event, ui, inst ) {

		var ts, bs, ls, rs, l, r, t, b, i, first,
			o = inst.options,
			d = o.snapTolerance,
			x1 = ui.offset.left, x2 = x1 + inst.helperProportions.width,
			y1 = ui.offset.top, y2 = y1 + inst.helperProportions.height;

		for ( i = inst.snapElements.length - 1; i >= 0; i-- ) {

			l = inst.snapElements[ i ].left - inst.margins.left;
			r = l + inst.snapElements[ i ].width;
			t = inst.snapElements[ i ].top - inst.margins.top;
			b = t + inst.snapElements[ i ].height;

			if ( x2 < l - d || x1 > r + d || y2 < t - d || y1 > b + d ||
					!$.contains( inst.snapElements[ i ].item.ownerDocument,
					inst.snapElements[ i ].item ) ) {
				if ( inst.snapElements[ i ].snapping ) {
					( inst.options.snap.release &&
						inst.options.snap.release.call(
							inst.element,
							event,
							$.extend( inst._uiHash(), { snapItem: inst.snapElements[ i ].item } )
						) );
				}
				inst.snapElements[ i ].snapping = false;
				continue;
			}

			if ( o.snapMode !== "inner" ) {
				ts = Math.abs( t - y2 ) <= d;
				bs = Math.abs( b - y1 ) <= d;
				ls = Math.abs( l - x2 ) <= d;
				rs = Math.abs( r - x1 ) <= d;
				if ( ts ) {
					ui.position.top = inst._convertPositionTo( "relative", {
						top: t - inst.helperProportions.height,
						left: 0
					} ).top;
				}
				if ( bs ) {
					ui.position.top = inst._convertPositionTo( "relative", {
						top: b,
						left: 0
					} ).top;
				}
				if ( ls ) {
					ui.position.left = inst._convertPositionTo( "relative", {
						top: 0,
						left: l - inst.helperProportions.width
					} ).left;
				}
				if ( rs ) {
					ui.position.left = inst._convertPositionTo( "relative", {
						top: 0,
						left: r
					} ).left;
				}
			}

			first = ( ts || bs || ls || rs );

			if ( o.snapMode !== "outer" ) {
				ts = Math.abs( t - y1 ) <= d;
				bs = Math.abs( b - y2 ) <= d;
				ls = Math.abs( l - x1 ) <= d;
				rs = Math.abs( r - x2 ) <= d;
				if ( ts ) {
					ui.position.top = inst._convertPositionTo( "relative", {
						top: t,
						left: 0
					} ).top;
				}
				if ( bs ) {
					ui.position.top = inst._convertPositionTo( "relative", {
						top: b - inst.helperProportions.height,
						left: 0
					} ).top;
				}
				if ( ls ) {
					ui.position.left = inst._convertPositionTo( "relative", {
						top: 0,
						left: l
					} ).left;
				}
				if ( rs ) {
					ui.position.left = inst._convertPositionTo( "relative", {
						top: 0,
						left: r - inst.helperProportions.width
					} ).left;
				}
			}

			if ( !inst.snapElements[ i ].snapping && ( ts || bs || ls || rs || first ) ) {
				( inst.options.snap.snap &&
					inst.options.snap.snap.call(
						inst.element,
						event,
						$.extend( inst._uiHash(), {
							snapItem: inst.snapElements[ i ].item
						} ) ) );
			}
			inst.snapElements[ i ].snapping = ( ts || bs || ls || rs || first );

		}

	}
} );

$.ui.plugin.add( "draggable", "stack", {
	start: function( event, ui, instance ) {
		var min,
			o = instance.options,
			group = $.makeArray( $( o.stack ) ).sort( function( a, b ) {
				return ( parseInt( $( a ).css( "zIndex" ), 10 ) || 0 ) -
					( parseInt( $( b ).css( "zIndex" ), 10 ) || 0 );
			} );

		if ( !group.length ) { return; }

		min = parseInt( $( group[ 0 ] ).css( "zIndex" ), 10 ) || 0;
		$( group ).each( function( i ) {
			$( this ).css( "zIndex", min + i );
		} );
		this.css( "zIndex", ( min + group.length ) );
	}
} );

$.ui.plugin.add( "draggable", "zIndex", {
	start: function( event, ui, instance ) {
		var t = $( ui.helper ),
			o = instance.options;

		if ( t.css( "zIndex" ) ) {
			o._zIndex = t.css( "zIndex" );
		}
		t.css( "zIndex", o.zIndex );
	},
	stop: function( event, ui, instance ) {
		var o = instance.options;

		if ( o._zIndex ) {
			$( ui.helper ).css( "zIndex", o._zIndex );
		}
	}
} );

return $.ui.draggable;

} ) );

},{}],65:[function(require,module,exports){
/*!
 * jQuery UI Menu 1.12.1
 * http://jqueryui.com
 *
 * Copyright jQuery Foundation and other contributors
 * Released under the MIT license.
 * http://jquery.org/license
 */

//>>label: Menu
//>>group: Widgets
//>>description: Creates nestable menus.
//>>docs: http://api.jqueryui.com/menu/
//>>demos: http://jqueryui.com/menu/
//>>css.structure: ../../themes/base/core.css
//>>css.structure: ../../themes/base/menu.css
//>>css.theme: ../../themes/base/theme.css

( function( factory ) {
	if ( typeof define === "function" && define.amd ) {

		// AMD. Register as an anonymous module.
		define( [
			"jquery",
			"../keycode",
			"../position",
			"../safe-active-element",
			"../unique-id",
			"../version",
			"../widget"
		], factory );
	} else {

		// Browser globals
		factory( jQuery );
	}
}( function( $ ) {

return $.widget( "ui.menu", {
	version: "1.12.1",
	defaultElement: "<ul>",
	delay: 300,
	options: {
		icons: {
			submenu: "ui-icon-caret-1-e"
		},
		items: "> *",
		menus: "ul",
		position: {
			my: "left top",
			at: "right top"
		},
		role: "menu",

		// Callbacks
		blur: null,
		focus: null,
		select: null
	},

	_create: function() {
		this.activeMenu = this.element;

		// Flag used to prevent firing of the click handler
		// as the event bubbles up through nested menus
		this.mouseHandled = false;
		this.element
			.uniqueId()
			.attr( {
				role: this.options.role,
				tabIndex: 0
			} );

		this._addClass( "ui-menu", "ui-widget ui-widget-content" );
		this._on( {

			// Prevent focus from sticking to links inside menu after clicking
			// them (focus should always stay on UL during navigation).
			"mousedown .ui-menu-item": function( event ) {
				event.preventDefault();
			},
			"click .ui-menu-item": function( event ) {
				var target = $( event.target );
				var active = $( $.ui.safeActiveElement( this.document[ 0 ] ) );
				if ( !this.mouseHandled && target.not( ".ui-state-disabled" ).length ) {
					this.select( event );

					// Only set the mouseHandled flag if the event will bubble, see #9469.
					if ( !event.isPropagationStopped() ) {
						this.mouseHandled = true;
					}

					// Open submenu on click
					if ( target.has( ".ui-menu" ).length ) {
						this.expand( event );
					} else if ( !this.element.is( ":focus" ) &&
							active.closest( ".ui-menu" ).length ) {

						// Redirect focus to the menu
						this.element.trigger( "focus", [ true ] );

						// If the active item is on the top level, let it stay active.
						// Otherwise, blur the active item since it is no longer visible.
						if ( this.active && this.active.parents( ".ui-menu" ).length === 1 ) {
							clearTimeout( this.timer );
						}
					}
				}
			},
			"mouseenter .ui-menu-item": function( event ) {

				// Ignore mouse events while typeahead is active, see #10458.
				// Prevents focusing the wrong item when typeahead causes a scroll while the mouse
				// is over an item in the menu
				if ( this.previousFilter ) {
					return;
				}

				var actualTarget = $( event.target ).closest( ".ui-menu-item" ),
					target = $( event.currentTarget );

				// Ignore bubbled events on parent items, see #11641
				if ( actualTarget[ 0 ] !== target[ 0 ] ) {
					return;
				}

				// Remove ui-state-active class from siblings of the newly focused menu item
				// to avoid a jump caused by adjacent elements both having a class with a border
				this._removeClass( target.siblings().children( ".ui-state-active" ),
					null, "ui-state-active" );
				this.focus( event, target );
			},
			mouseleave: "collapseAll",
			"mouseleave .ui-menu": "collapseAll",
			focus: function( event, keepActiveItem ) {

				// If there's already an active item, keep it active
				// If not, activate the first item
				var item = this.active || this.element.find( this.options.items ).eq( 0 );

				if ( !keepActiveItem ) {
					this.focus( event, item );
				}
			},
			blur: function( event ) {
				this._delay( function() {
					var notContained = !$.contains(
						this.element[ 0 ],
						$.ui.safeActiveElement( this.document[ 0 ] )
					);
					if ( notContained ) {
						this.collapseAll( event );
					}
				} );
			},
			keydown: "_keydown"
		} );

		this.refresh();

		// Clicks outside of a menu collapse any open menus
		this._on( this.document, {
			click: function( event ) {
				if ( this._closeOnDocumentClick( event ) ) {
					this.collapseAll( event );
				}

				// Reset the mouseHandled flag
				this.mouseHandled = false;
			}
		} );
	},

	_destroy: function() {
		var items = this.element.find( ".ui-menu-item" )
				.removeAttr( "role aria-disabled" ),
			submenus = items.children( ".ui-menu-item-wrapper" )
				.removeUniqueId()
				.removeAttr( "tabIndex role aria-haspopup" );

		// Destroy (sub)menus
		this.element
			.removeAttr( "aria-activedescendant" )
			.find( ".ui-menu" ).addBack()
				.removeAttr( "role aria-labelledby aria-expanded aria-hidden aria-disabled " +
					"tabIndex" )
				.removeUniqueId()
				.show();

		submenus.children().each( function() {
			var elem = $( this );
			if ( elem.data( "ui-menu-submenu-caret" ) ) {
				elem.remove();
			}
		} );
	},

	_keydown: function( event ) {
		var match, prev, character, skip,
			preventDefault = true;

		switch ( event.keyCode ) {
		case $.ui.keyCode.PAGE_UP:
			this.previousPage( event );
			break;
		case $.ui.keyCode.PAGE_DOWN:
			this.nextPage( event );
			break;
		case $.ui.keyCode.HOME:
			this._move( "first", "first", event );
			break;
		case $.ui.keyCode.END:
			this._move( "last", "last", event );
			break;
		case $.ui.keyCode.UP:
			this.previous( event );
			break;
		case $.ui.keyCode.DOWN:
			this.next( event );
			break;
		case $.ui.keyCode.LEFT:
			this.collapse( event );
			break;
		case $.ui.keyCode.RIGHT:
			if ( this.active && !this.active.is( ".ui-state-disabled" ) ) {
				this.expand( event );
			}
			break;
		case $.ui.keyCode.ENTER:
		case $.ui.keyCode.SPACE:
			this._activate( event );
			break;
		case $.ui.keyCode.ESCAPE:
			this.collapse( event );
			break;
		default:
			preventDefault = false;
			prev = this.previousFilter || "";
			skip = false;

			// Support number pad values
			character = event.keyCode >= 96 && event.keyCode <= 105 ?
				( event.keyCode - 96 ).toString() : String.fromCharCode( event.keyCode );

			clearTimeout( this.filterTimer );

			if ( character === prev ) {
				skip = true;
			} else {
				character = prev + character;
			}

			match = this._filterMenuItems( character );
			match = skip && match.index( this.active.next() ) !== -1 ?
				this.active.nextAll( ".ui-menu-item" ) :
				match;

			// If no matches on the current filter, reset to the last character pressed
			// to move down the menu to the first item that starts with that character
			if ( !match.length ) {
				character = String.fromCharCode( event.keyCode );
				match = this._filterMenuItems( character );
			}

			if ( match.length ) {
				this.focus( event, match );
				this.previousFilter = character;
				this.filterTimer = this._delay( function() {
					delete this.previousFilter;
				}, 1000 );
			} else {
				delete this.previousFilter;
			}
		}

		if ( preventDefault ) {
			event.preventDefault();
		}
	},

	_activate: function( event ) {
		if ( this.active && !this.active.is( ".ui-state-disabled" ) ) {
			if ( this.active.children( "[aria-haspopup='true']" ).length ) {
				this.expand( event );
			} else {
				this.select( event );
			}
		}
	},

	refresh: function() {
		var menus, items, newSubmenus, newItems, newWrappers,
			that = this,
			icon = this.options.icons.submenu,
			submenus = this.element.find( this.options.menus );

		this._toggleClass( "ui-menu-icons", null, !!this.element.find( ".ui-icon" ).length );

		// Initialize nested menus
		newSubmenus = submenus.filter( ":not(.ui-menu)" )
			.hide()
			.attr( {
				role: this.options.role,
				"aria-hidden": "true",
				"aria-expanded": "false"
			} )
			.each( function() {
				var menu = $( this ),
					item = menu.prev(),
					submenuCaret = $( "<span>" ).data( "ui-menu-submenu-caret", true );

				that._addClass( submenuCaret, "ui-menu-icon", "ui-icon " + icon );
				item
					.attr( "aria-haspopup", "true" )
					.prepend( submenuCaret );
				menu.attr( "aria-labelledby", item.attr( "id" ) );
			} );

		this._addClass( newSubmenus, "ui-menu", "ui-widget ui-widget-content ui-front" );

		menus = submenus.add( this.element );
		items = menus.find( this.options.items );

		// Initialize menu-items containing spaces and/or dashes only as dividers
		items.not( ".ui-menu-item" ).each( function() {
			var item = $( this );
			if ( that._isDivider( item ) ) {
				that._addClass( item, "ui-menu-divider", "ui-widget-content" );
			}
		} );

		// Don't refresh list items that are already adapted
		newItems = items.not( ".ui-menu-item, .ui-menu-divider" );
		newWrappers = newItems.children()
			.not( ".ui-menu" )
				.uniqueId()
				.attr( {
					tabIndex: -1,
					role: this._itemRole()
				} );
		this._addClass( newItems, "ui-menu-item" )
			._addClass( newWrappers, "ui-menu-item-wrapper" );

		// Add aria-disabled attribute to any disabled menu item
		items.filter( ".ui-state-disabled" ).attr( "aria-disabled", "true" );

		// If the active item has been removed, blur the menu
		if ( this.active && !$.contains( this.element[ 0 ], this.active[ 0 ] ) ) {
			this.blur();
		}
	},

	_itemRole: function() {
		return {
			menu: "menuitem",
			listbox: "option"
		}[ this.options.role ];
	},

	_setOption: function( key, value ) {
		if ( key === "icons" ) {
			var icons = this.element.find( ".ui-menu-icon" );
			this._removeClass( icons, null, this.options.icons.submenu )
				._addClass( icons, null, value.submenu );
		}
		this._super( key, value );
	},

	_setOptionDisabled: function( value ) {
		this._super( value );

		this.element.attr( "aria-disabled", String( value ) );
		this._toggleClass( null, "ui-state-disabled", !!value );
	},

	focus: function( event, item ) {
		var nested, focused, activeParent;
		this.blur( event, event && event.type === "focus" );

		this._scrollIntoView( item );

		this.active = item.first();

		focused = this.active.children( ".ui-menu-item-wrapper" );
		this._addClass( focused, null, "ui-state-active" );

		// Only update aria-activedescendant if there's a role
		// otherwise we assume focus is managed elsewhere
		if ( this.options.role ) {
			this.element.attr( "aria-activedescendant", focused.attr( "id" ) );
		}

		// Highlight active parent menu item, if any
		activeParent = this.active
			.parent()
				.closest( ".ui-menu-item" )
					.children( ".ui-menu-item-wrapper" );
		this._addClass( activeParent, null, "ui-state-active" );

		if ( event && event.type === "keydown" ) {
			this._close();
		} else {
			this.timer = this._delay( function() {
				this._close();
			}, this.delay );
		}

		nested = item.children( ".ui-menu" );
		if ( nested.length && event && ( /^mouse/.test( event.type ) ) ) {
			this._startOpening( nested );
		}
		this.activeMenu = item.parent();

		this._trigger( "focus", event, { item: item } );
	},

	_scrollIntoView: function( item ) {
		var borderTop, paddingTop, offset, scroll, elementHeight, itemHeight;
		if ( this._hasScroll() ) {
			borderTop = parseFloat( $.css( this.activeMenu[ 0 ], "borderTopWidth" ) ) || 0;
			paddingTop = parseFloat( $.css( this.activeMenu[ 0 ], "paddingTop" ) ) || 0;
			offset = item.offset().top - this.activeMenu.offset().top - borderTop - paddingTop;
			scroll = this.activeMenu.scrollTop();
			elementHeight = this.activeMenu.height();
			itemHeight = item.outerHeight();

			if ( offset < 0 ) {
				this.activeMenu.scrollTop( scroll + offset );
			} else if ( offset + itemHeight > elementHeight ) {
				this.activeMenu.scrollTop( scroll + offset - elementHeight + itemHeight );
			}
		}
	},

	blur: function( event, fromFocus ) {
		if ( !fromFocus ) {
			clearTimeout( this.timer );
		}

		if ( !this.active ) {
			return;
		}

		this._removeClass( this.active.children( ".ui-menu-item-wrapper" ),
			null, "ui-state-active" );

		this._trigger( "blur", event, { item: this.active } );
		this.active = null;
	},

	_startOpening: function( submenu ) {
		clearTimeout( this.timer );

		// Don't open if already open fixes a Firefox bug that caused a .5 pixel
		// shift in the submenu position when mousing over the caret icon
		if ( submenu.attr( "aria-hidden" ) !== "true" ) {
			return;
		}

		this.timer = this._delay( function() {
			this._close();
			this._open( submenu );
		}, this.delay );
	},

	_open: function( submenu ) {
		var position = $.extend( {
			of: this.active
		}, this.options.position );

		clearTimeout( this.timer );
		this.element.find( ".ui-menu" ).not( submenu.parents( ".ui-menu" ) )
			.hide()
			.attr( "aria-hidden", "true" );

		submenu
			.show()
			.removeAttr( "aria-hidden" )
			.attr( "aria-expanded", "true" )
			.position( position );
	},

	collapseAll: function( event, all ) {
		clearTimeout( this.timer );
		this.timer = this._delay( function() {

			// If we were passed an event, look for the submenu that contains the event
			var currentMenu = all ? this.element :
				$( event && event.target ).closest( this.element.find( ".ui-menu" ) );

			// If we found no valid submenu ancestor, use the main menu to close all
			// sub menus anyway
			if ( !currentMenu.length ) {
				currentMenu = this.element;
			}

			this._close( currentMenu );

			this.blur( event );

			// Work around active item staying active after menu is blurred
			this._removeClass( currentMenu.find( ".ui-state-active" ), null, "ui-state-active" );

			this.activeMenu = currentMenu;
		}, this.delay );
	},

	// With no arguments, closes the currently active menu - if nothing is active
	// it closes all menus.  If passed an argument, it will search for menus BELOW
	_close: function( startMenu ) {
		if ( !startMenu ) {
			startMenu = this.active ? this.active.parent() : this.element;
		}

		startMenu.find( ".ui-menu" )
			.hide()
			.attr( "aria-hidden", "true" )
			.attr( "aria-expanded", "false" );
	},

	_closeOnDocumentClick: function( event ) {
		return !$( event.target ).closest( ".ui-menu" ).length;
	},

	_isDivider: function( item ) {

		// Match hyphen, em dash, en dash
		return !/[^\-\u2014\u2013\s]/.test( item.text() );
	},

	collapse: function( event ) {
		var newItem = this.active &&
			this.active.parent().closest( ".ui-menu-item", this.element );
		if ( newItem && newItem.length ) {
			this._close();
			this.focus( event, newItem );
		}
	},

	expand: function( event ) {
		var newItem = this.active &&
			this.active
				.children( ".ui-menu " )
					.find( this.options.items )
						.first();

		if ( newItem && newItem.length ) {
			this._open( newItem.parent() );

			// Delay so Firefox will not hide activedescendant change in expanding submenu from AT
			this._delay( function() {
				this.focus( event, newItem );
			} );
		}
	},

	next: function( event ) {
		this._move( "next", "first", event );
	},

	previous: function( event ) {
		this._move( "prev", "last", event );
	},

	isFirstItem: function() {
		return this.active && !this.active.prevAll( ".ui-menu-item" ).length;
	},

	isLastItem: function() {
		return this.active && !this.active.nextAll( ".ui-menu-item" ).length;
	},

	_move: function( direction, filter, event ) {
		var next;
		if ( this.active ) {
			if ( direction === "first" || direction === "last" ) {
				next = this.active
					[ direction === "first" ? "prevAll" : "nextAll" ]( ".ui-menu-item" )
					.eq( -1 );
			} else {
				next = this.active
					[ direction + "All" ]( ".ui-menu-item" )
					.eq( 0 );
			}
		}
		if ( !next || !next.length || !this.active ) {
			next = this.activeMenu.find( this.options.items )[ filter ]();
		}

		this.focus( event, next );
	},

	nextPage: function( event ) {
		var item, base, height;

		if ( !this.active ) {
			this.next( event );
			return;
		}
		if ( this.isLastItem() ) {
			return;
		}
		if ( this._hasScroll() ) {
			base = this.active.offset().top;
			height = this.element.height();
			this.active.nextAll( ".ui-menu-item" ).each( function() {
				item = $( this );
				return item.offset().top - base - height < 0;
			} );

			this.focus( event, item );
		} else {
			this.focus( event, this.activeMenu.find( this.options.items )
				[ !this.active ? "first" : "last" ]() );
		}
	},

	previousPage: function( event ) {
		var item, base, height;
		if ( !this.active ) {
			this.next( event );
			return;
		}
		if ( this.isFirstItem() ) {
			return;
		}
		if ( this._hasScroll() ) {
			base = this.active.offset().top;
			height = this.element.height();
			this.active.prevAll( ".ui-menu-item" ).each( function() {
				item = $( this );
				return item.offset().top - base + height > 0;
			} );

			this.focus( event, item );
		} else {
			this.focus( event, this.activeMenu.find( this.options.items ).first() );
		}
	},

	_hasScroll: function() {
		return this.element.outerHeight() < this.element.prop( "scrollHeight" );
	},

	select: function( event ) {

		// TODO: It should never be possible to not have an active item at this
		// point, but the tests don't trigger mouseenter before click.
		this.active = this.active || $( event.target ).closest( ".ui-menu-item" );
		var ui = { item: this.active };
		if ( !this.active.has( ".ui-menu" ).length ) {
			this.collapseAll( event, true );
		}
		this._trigger( "select", event, ui );
	},

	_filterMenuItems: function( character ) {
		var escapedCharacter = character.replace( /[\-\[\]{}()*+?.,\\\^$|#\s]/g, "\\$&" ),
			regex = new RegExp( "^" + escapedCharacter, "i" );

		return this.activeMenu
			.find( this.options.items )

				// Only match on items, not dividers or other content (#10571)
				.filter( ".ui-menu-item" )
					.filter( function() {
						return regex.test(
							$.trim( $( this ).children( ".ui-menu-item-wrapper" ).text() ) );
					} );
	}
} );

} ) );

},{}],66:[function(require,module,exports){
/*!
 * jQuery UI Mouse 1.12.1
 * http://jqueryui.com
 *
 * Copyright jQuery Foundation and other contributors
 * Released under the MIT license.
 * http://jquery.org/license
 */

//>>label: Mouse
//>>group: Widgets
//>>description: Abstracts mouse-based interactions to assist in creating certain widgets.
//>>docs: http://api.jqueryui.com/mouse/

( function( factory ) {
	if ( typeof define === "function" && define.amd ) {

		// AMD. Register as an anonymous module.
		define( [
			"jquery",
			"../ie",
			"../version",
			"../widget"
		], factory );
	} else {

		// Browser globals
		factory( jQuery );
	}
}( function( $ ) {

var mouseHandled = false;
$( document ).on( "mouseup", function() {
	mouseHandled = false;
} );

return $.widget( "ui.mouse", {
	version: "1.12.1",
	options: {
		cancel: "input, textarea, button, select, option",
		distance: 1,
		delay: 0
	},
	_mouseInit: function() {
		var that = this;

		this.element
			.on( "mousedown." + this.widgetName, function( event ) {
				return that._mouseDown( event );
			} )
			.on( "click." + this.widgetName, function( event ) {
				if ( true === $.data( event.target, that.widgetName + ".preventClickEvent" ) ) {
					$.removeData( event.target, that.widgetName + ".preventClickEvent" );
					event.stopImmediatePropagation();
					return false;
				}
			} );

		this.started = false;
	},

	// TODO: make sure destroying one instance of mouse doesn't mess with
	// other instances of mouse
	_mouseDestroy: function() {
		this.element.off( "." + this.widgetName );
		if ( this._mouseMoveDelegate ) {
			this.document
				.off( "mousemove." + this.widgetName, this._mouseMoveDelegate )
				.off( "mouseup." + this.widgetName, this._mouseUpDelegate );
		}
	},

	_mouseDown: function( event ) {

		// don't let more than one widget handle mouseStart
		if ( mouseHandled ) {
			return;
		}

		this._mouseMoved = false;

		// We may have missed mouseup (out of window)
		( this._mouseStarted && this._mouseUp( event ) );

		this._mouseDownEvent = event;

		var that = this,
			btnIsLeft = ( event.which === 1 ),

			// event.target.nodeName works around a bug in IE 8 with
			// disabled inputs (#7620)
			elIsCancel = ( typeof this.options.cancel === "string" && event.target.nodeName ?
				$( event.target ).closest( this.options.cancel ).length : false );
		if ( !btnIsLeft || elIsCancel || !this._mouseCapture( event ) ) {
			return true;
		}

		this.mouseDelayMet = !this.options.delay;
		if ( !this.mouseDelayMet ) {
			this._mouseDelayTimer = setTimeout( function() {
				that.mouseDelayMet = true;
			}, this.options.delay );
		}

		if ( this._mouseDistanceMet( event ) && this._mouseDelayMet( event ) ) {
			this._mouseStarted = ( this._mouseStart( event ) !== false );
			if ( !this._mouseStarted ) {
				event.preventDefault();
				return true;
			}
		}

		// Click event may never have fired (Gecko & Opera)
		if ( true === $.data( event.target, this.widgetName + ".preventClickEvent" ) ) {
			$.removeData( event.target, this.widgetName + ".preventClickEvent" );
		}

		// These delegates are required to keep context
		this._mouseMoveDelegate = function( event ) {
			return that._mouseMove( event );
		};
		this._mouseUpDelegate = function( event ) {
			return that._mouseUp( event );
		};

		this.document
			.on( "mousemove." + this.widgetName, this._mouseMoveDelegate )
			.on( "mouseup." + this.widgetName, this._mouseUpDelegate );

		event.preventDefault();

		mouseHandled = true;
		return true;
	},

	_mouseMove: function( event ) {

		// Only check for mouseups outside the document if you've moved inside the document
		// at least once. This prevents the firing of mouseup in the case of IE<9, which will
		// fire a mousemove event if content is placed under the cursor. See #7778
		// Support: IE <9
		if ( this._mouseMoved ) {

			// IE mouseup check - mouseup happened when mouse was out of window
			if ( $.ui.ie && ( !document.documentMode || document.documentMode < 9 ) &&
					!event.button ) {
				return this._mouseUp( event );

			// Iframe mouseup check - mouseup occurred in another document
			} else if ( !event.which ) {

				// Support: Safari <=8 - 9
				// Safari sets which to 0 if you press any of the following keys
				// during a drag (#14461)
				if ( event.originalEvent.altKey || event.originalEvent.ctrlKey ||
						event.originalEvent.metaKey || event.originalEvent.shiftKey ) {
					this.ignoreMissingWhich = true;
				} else if ( !this.ignoreMissingWhich ) {
					return this._mouseUp( event );
				}
			}
		}

		if ( event.which || event.button ) {
			this._mouseMoved = true;
		}

		if ( this._mouseStarted ) {
			this._mouseDrag( event );
			return event.preventDefault();
		}

		if ( this._mouseDistanceMet( event ) && this._mouseDelayMet( event ) ) {
			this._mouseStarted =
				( this._mouseStart( this._mouseDownEvent, event ) !== false );
			( this._mouseStarted ? this._mouseDrag( event ) : this._mouseUp( event ) );
		}

		return !this._mouseStarted;
	},

	_mouseUp: function( event ) {
		this.document
			.off( "mousemove." + this.widgetName, this._mouseMoveDelegate )
			.off( "mouseup." + this.widgetName, this._mouseUpDelegate );

		if ( this._mouseStarted ) {
			this._mouseStarted = false;

			if ( event.target === this._mouseDownEvent.target ) {
				$.data( event.target, this.widgetName + ".preventClickEvent", true );
			}

			this._mouseStop( event );
		}

		if ( this._mouseDelayTimer ) {
			clearTimeout( this._mouseDelayTimer );
			delete this._mouseDelayTimer;
		}

		this.ignoreMissingWhich = false;
		mouseHandled = false;
		event.preventDefault();
	},

	_mouseDistanceMet: function( event ) {
		return ( Math.max(
				Math.abs( this._mouseDownEvent.pageX - event.pageX ),
				Math.abs( this._mouseDownEvent.pageY - event.pageY )
			) >= this.options.distance
		);
	},

	_mouseDelayMet: function( /* event */ ) {
		return this.mouseDelayMet;
	},

	// These are placeholder methods, to be overriden by extending plugin
	_mouseStart: function( /* event */ ) {},
	_mouseDrag: function( /* event */ ) {},
	_mouseStop: function( /* event */ ) {},
	_mouseCapture: function( /* event */ ) { return true; }
} );

} ) );

},{}],67:[function(require,module,exports){
/*!
 * jQuery UI Resizable 1.12.1
 * http://jqueryui.com
 *
 * Copyright jQuery Foundation and other contributors
 * Released under the MIT license.
 * http://jquery.org/license
 */

//>>label: Resizable
//>>group: Interactions
//>>description: Enables resize functionality for any element.
//>>docs: http://api.jqueryui.com/resizable/
//>>demos: http://jqueryui.com/resizable/
//>>css.structure: ../../themes/base/core.css
//>>css.structure: ../../themes/base/resizable.css
//>>css.theme: ../../themes/base/theme.css

( function( factory ) {
	if ( typeof define === "function" && define.amd ) {

		// AMD. Register as an anonymous module.
		define( [
			"jquery",
			"./mouse",
			"../disable-selection",
			"../plugin",
			"../version",
			"../widget"
		], factory );
	} else {

		// Browser globals
		factory( jQuery );
	}
}( function( $ ) {

$.widget( "ui.resizable", $.ui.mouse, {
	version: "1.12.1",
	widgetEventPrefix: "resize",
	options: {
		alsoResize: false,
		animate: false,
		animateDuration: "slow",
		animateEasing: "swing",
		aspectRatio: false,
		autoHide: false,
		classes: {
			"ui-resizable-se": "ui-icon ui-icon-gripsmall-diagonal-se"
		},
		containment: false,
		ghost: false,
		grid: false,
		handles: "e,s,se",
		helper: false,
		maxHeight: null,
		maxWidth: null,
		minHeight: 10,
		minWidth: 10,

		// See #7960
		zIndex: 90,

		// Callbacks
		resize: null,
		start: null,
		stop: null
	},

	_num: function( value ) {
		return parseFloat( value ) || 0;
	},

	_isNumber: function( value ) {
		return !isNaN( parseFloat( value ) );
	},

	_hasScroll: function( el, a ) {

		if ( $( el ).css( "overflow" ) === "hidden" ) {
			return false;
		}

		var scroll = ( a && a === "left" ) ? "scrollLeft" : "scrollTop",
			has = false;

		if ( el[ scroll ] > 0 ) {
			return true;
		}

		// TODO: determine which cases actually cause this to happen
		// if the element doesn't have the scroll set, see if it's possible to
		// set the scroll
		el[ scroll ] = 1;
		has = ( el[ scroll ] > 0 );
		el[ scroll ] = 0;
		return has;
	},

	_create: function() {

		var margins,
			o = this.options,
			that = this;
		this._addClass( "ui-resizable" );

		$.extend( this, {
			_aspectRatio: !!( o.aspectRatio ),
			aspectRatio: o.aspectRatio,
			originalElement: this.element,
			_proportionallyResizeElements: [],
			_helper: o.helper || o.ghost || o.animate ? o.helper || "ui-resizable-helper" : null
		} );

		// Wrap the element if it cannot hold child nodes
		if ( this.element[ 0 ].nodeName.match( /^(canvas|textarea|input|select|button|img)$/i ) ) {

			this.element.wrap(
				$( "<div class='ui-wrapper' style='overflow: hidden;'></div>" ).css( {
					position: this.element.css( "position" ),
					width: this.element.outerWidth(),
					height: this.element.outerHeight(),
					top: this.element.css( "top" ),
					left: this.element.css( "left" )
				} )
			);

			this.element = this.element.parent().data(
				"ui-resizable", this.element.resizable( "instance" )
			);

			this.elementIsWrapper = true;

			margins = {
				marginTop: this.originalElement.css( "marginTop" ),
				marginRight: this.originalElement.css( "marginRight" ),
				marginBottom: this.originalElement.css( "marginBottom" ),
				marginLeft: this.originalElement.css( "marginLeft" )
			};

			this.element.css( margins );
			this.originalElement.css( "margin", 0 );

			// support: Safari
			// Prevent Safari textarea resize
			this.originalResizeStyle = this.originalElement.css( "resize" );
			this.originalElement.css( "resize", "none" );

			this._proportionallyResizeElements.push( this.originalElement.css( {
				position: "static",
				zoom: 1,
				display: "block"
			} ) );

			// Support: IE9
			// avoid IE jump (hard set the margin)
			this.originalElement.css( margins );

			this._proportionallyResize();
		}

		this._setupHandles();

		if ( o.autoHide ) {
			$( this.element )
				.on( "mouseenter", function() {
					if ( o.disabled ) {
						return;
					}
					that._removeClass( "ui-resizable-autohide" );
					that._handles.show();
				} )
				.on( "mouseleave", function() {
					if ( o.disabled ) {
						return;
					}
					if ( !that.resizing ) {
						that._addClass( "ui-resizable-autohide" );
						that._handles.hide();
					}
				} );
		}

		this._mouseInit();
	},

	_destroy: function() {

		this._mouseDestroy();

		var wrapper,
			_destroy = function( exp ) {
				$( exp )
					.removeData( "resizable" )
					.removeData( "ui-resizable" )
					.off( ".resizable" )
					.find( ".ui-resizable-handle" )
						.remove();
			};

		// TODO: Unwrap at same DOM position
		if ( this.elementIsWrapper ) {
			_destroy( this.element );
			wrapper = this.element;
			this.originalElement.css( {
				position: wrapper.css( "position" ),
				width: wrapper.outerWidth(),
				height: wrapper.outerHeight(),
				top: wrapper.css( "top" ),
				left: wrapper.css( "left" )
			} ).insertAfter( wrapper );
			wrapper.remove();
		}

		this.originalElement.css( "resize", this.originalResizeStyle );
		_destroy( this.originalElement );

		return this;
	},

	_setOption: function( key, value ) {
		this._super( key, value );

		switch ( key ) {
		case "handles":
			this._removeHandles();
			this._setupHandles();
			break;
		default:
			break;
		}
	},

	_setupHandles: function() {
		var o = this.options, handle, i, n, hname, axis, that = this;
		this.handles = o.handles ||
			( !$( ".ui-resizable-handle", this.element ).length ?
				"e,s,se" : {
					n: ".ui-resizable-n",
					e: ".ui-resizable-e",
					s: ".ui-resizable-s",
					w: ".ui-resizable-w",
					se: ".ui-resizable-se",
					sw: ".ui-resizable-sw",
					ne: ".ui-resizable-ne",
					nw: ".ui-resizable-nw"
				} );

		this._handles = $();
		if ( this.handles.constructor === String ) {

			if ( this.handles === "all" ) {
				this.handles = "n,e,s,w,se,sw,ne,nw";
			}

			n = this.handles.split( "," );
			this.handles = {};

			for ( i = 0; i < n.length; i++ ) {

				handle = $.trim( n[ i ] );
				hname = "ui-resizable-" + handle;
				axis = $( "<div>" );
				this._addClass( axis, "ui-resizable-handle " + hname );

				axis.css( { zIndex: o.zIndex } );

				this.handles[ handle ] = ".ui-resizable-" + handle;
				this.element.append( axis );
			}

		}

		this._renderAxis = function( target ) {

			var i, axis, padPos, padWrapper;

			target = target || this.element;

			for ( i in this.handles ) {

				if ( this.handles[ i ].constructor === String ) {
					this.handles[ i ] = this.element.children( this.handles[ i ] ).first().show();
				} else if ( this.handles[ i ].jquery || this.handles[ i ].nodeType ) {
					this.handles[ i ] = $( this.handles[ i ] );
					this._on( this.handles[ i ], { "mousedown": that._mouseDown } );
				}

				if ( this.elementIsWrapper &&
						this.originalElement[ 0 ]
							.nodeName
							.match( /^(textarea|input|select|button)$/i ) ) {
					axis = $( this.handles[ i ], this.element );

					padWrapper = /sw|ne|nw|se|n|s/.test( i ) ?
						axis.outerHeight() :
						axis.outerWidth();

					padPos = [ "padding",
						/ne|nw|n/.test( i ) ? "Top" :
						/se|sw|s/.test( i ) ? "Bottom" :
						/^e$/.test( i ) ? "Right" : "Left" ].join( "" );

					target.css( padPos, padWrapper );

					this._proportionallyResize();
				}

				this._handles = this._handles.add( this.handles[ i ] );
			}
		};

		// TODO: make renderAxis a prototype function
		this._renderAxis( this.element );

		this._handles = this._handles.add( this.element.find( ".ui-resizable-handle" ) );
		this._handles.disableSelection();

		this._handles.on( "mouseover", function() {
			if ( !that.resizing ) {
				if ( this.className ) {
					axis = this.className.match( /ui-resizable-(se|sw|ne|nw|n|e|s|w)/i );
				}
				that.axis = axis && axis[ 1 ] ? axis[ 1 ] : "se";
			}
		} );

		if ( o.autoHide ) {
			this._handles.hide();
			this._addClass( "ui-resizable-autohide" );
		}
	},

	_removeHandles: function() {
		this._handles.remove();
	},

	_mouseCapture: function( event ) {
		var i, handle,
			capture = false;

		for ( i in this.handles ) {
			handle = $( this.handles[ i ] )[ 0 ];
			if ( handle === event.target || $.contains( handle, event.target ) ) {
				capture = true;
			}
		}

		return !this.options.disabled && capture;
	},

	_mouseStart: function( event ) {

		var curleft, curtop, cursor,
			o = this.options,
			el = this.element;

		this.resizing = true;

		this._renderProxy();

		curleft = this._num( this.helper.css( "left" ) );
		curtop = this._num( this.helper.css( "top" ) );

		if ( o.containment ) {
			curleft += $( o.containment ).scrollLeft() || 0;
			curtop += $( o.containment ).scrollTop() || 0;
		}

		this.offset = this.helper.offset();
		this.position = { left: curleft, top: curtop };

		this.size = this._helper ? {
				width: this.helper.width(),
				height: this.helper.height()
			} : {
				width: el.width(),
				height: el.height()
			};

		this.originalSize = this._helper ? {
				width: el.outerWidth(),
				height: el.outerHeight()
			} : {
				width: el.width(),
				height: el.height()
			};

		this.sizeDiff = {
			width: el.outerWidth() - el.width(),
			height: el.outerHeight() - el.height()
		};

		this.originalPosition = { left: curleft, top: curtop };
		this.originalMousePosition = { left: event.pageX, top: event.pageY };

		this.aspectRatio = ( typeof o.aspectRatio === "number" ) ?
			o.aspectRatio :
			( ( this.originalSize.width / this.originalSize.height ) || 1 );

		cursor = $( ".ui-resizable-" + this.axis ).css( "cursor" );
		$( "body" ).css( "cursor", cursor === "auto" ? this.axis + "-resize" : cursor );

		this._addClass( "ui-resizable-resizing" );
		this._propagate( "start", event );
		return true;
	},

	_mouseDrag: function( event ) {

		var data, props,
			smp = this.originalMousePosition,
			a = this.axis,
			dx = ( event.pageX - smp.left ) || 0,
			dy = ( event.pageY - smp.top ) || 0,
			trigger = this._change[ a ];

		this._updatePrevProperties();

		if ( !trigger ) {
			return false;
		}

		data = trigger.apply( this, [ event, dx, dy ] );

		this._updateVirtualBoundaries( event.shiftKey );
		if ( this._aspectRatio || event.shiftKey ) {
			data = this._updateRatio( data, event );
		}

		data = this._respectSize( data, event );

		this._updateCache( data );

		this._propagate( "resize", event );

		props = this._applyChanges();

		if ( !this._helper && this._proportionallyResizeElements.length ) {
			this._proportionallyResize();
		}

		if ( !$.isEmptyObject( props ) ) {
			this._updatePrevProperties();
			this._trigger( "resize", event, this.ui() );
			this._applyChanges();
		}

		return false;
	},

	_mouseStop: function( event ) {

		this.resizing = false;
		var pr, ista, soffseth, soffsetw, s, left, top,
			o = this.options, that = this;

		if ( this._helper ) {

			pr = this._proportionallyResizeElements;
			ista = pr.length && ( /textarea/i ).test( pr[ 0 ].nodeName );
			soffseth = ista && this._hasScroll( pr[ 0 ], "left" ) ? 0 : that.sizeDiff.height;
			soffsetw = ista ? 0 : that.sizeDiff.width;

			s = {
				width: ( that.helper.width()  - soffsetw ),
				height: ( that.helper.height() - soffseth )
			};
			left = ( parseFloat( that.element.css( "left" ) ) +
				( that.position.left - that.originalPosition.left ) ) || null;
			top = ( parseFloat( that.element.css( "top" ) ) +
				( that.position.top - that.originalPosition.top ) ) || null;

			if ( !o.animate ) {
				this.element.css( $.extend( s, { top: top, left: left } ) );
			}

			that.helper.height( that.size.height );
			that.helper.width( that.size.width );

			if ( this._helper && !o.animate ) {
				this._proportionallyResize();
			}
		}

		$( "body" ).css( "cursor", "auto" );

		this._removeClass( "ui-resizable-resizing" );

		this._propagate( "stop", event );

		if ( this._helper ) {
			this.helper.remove();
		}

		return false;

	},

	_updatePrevProperties: function() {
		this.prevPosition = {
			top: this.position.top,
			left: this.position.left
		};
		this.prevSize = {
			width: this.size.width,
			height: this.size.height
		};
	},

	_applyChanges: function() {
		var props = {};

		if ( this.position.top !== this.prevPosition.top ) {
			props.top = this.position.top + "px";
		}
		if ( this.position.left !== this.prevPosition.left ) {
			props.left = this.position.left + "px";
		}
		if ( this.size.width !== this.prevSize.width ) {
			props.width = this.size.width + "px";
		}
		if ( this.size.height !== this.prevSize.height ) {
			props.height = this.size.height + "px";
		}

		this.helper.css( props );

		return props;
	},

	_updateVirtualBoundaries: function( forceAspectRatio ) {
		var pMinWidth, pMaxWidth, pMinHeight, pMaxHeight, b,
			o = this.options;

		b = {
			minWidth: this._isNumber( o.minWidth ) ? o.minWidth : 0,
			maxWidth: this._isNumber( o.maxWidth ) ? o.maxWidth : Infinity,
			minHeight: this._isNumber( o.minHeight ) ? o.minHeight : 0,
			maxHeight: this._isNumber( o.maxHeight ) ? o.maxHeight : Infinity
		};

		if ( this._aspectRatio || forceAspectRatio ) {
			pMinWidth = b.minHeight * this.aspectRatio;
			pMinHeight = b.minWidth / this.aspectRatio;
			pMaxWidth = b.maxHeight * this.aspectRatio;
			pMaxHeight = b.maxWidth / this.aspectRatio;

			if ( pMinWidth > b.minWidth ) {
				b.minWidth = pMinWidth;
			}
			if ( pMinHeight > b.minHeight ) {
				b.minHeight = pMinHeight;
			}
			if ( pMaxWidth < b.maxWidth ) {
				b.maxWidth = pMaxWidth;
			}
			if ( pMaxHeight < b.maxHeight ) {
				b.maxHeight = pMaxHeight;
			}
		}
		this._vBoundaries = b;
	},

	_updateCache: function( data ) {
		this.offset = this.helper.offset();
		if ( this._isNumber( data.left ) ) {
			this.position.left = data.left;
		}
		if ( this._isNumber( data.top ) ) {
			this.position.top = data.top;
		}
		if ( this._isNumber( data.height ) ) {
			this.size.height = data.height;
		}
		if ( this._isNumber( data.width ) ) {
			this.size.width = data.width;
		}
	},

	_updateRatio: function( data ) {

		var cpos = this.position,
			csize = this.size,
			a = this.axis;

		if ( this._isNumber( data.height ) ) {
			data.width = ( data.height * this.aspectRatio );
		} else if ( this._isNumber( data.width ) ) {
			data.height = ( data.width / this.aspectRatio );
		}

		if ( a === "sw" ) {
			data.left = cpos.left + ( csize.width - data.width );
			data.top = null;
		}
		if ( a === "nw" ) {
			data.top = cpos.top + ( csize.height - data.height );
			data.left = cpos.left + ( csize.width - data.width );
		}

		return data;
	},

	_respectSize: function( data ) {

		var o = this._vBoundaries,
			a = this.axis,
			ismaxw = this._isNumber( data.width ) && o.maxWidth && ( o.maxWidth < data.width ),
			ismaxh = this._isNumber( data.height ) && o.maxHeight && ( o.maxHeight < data.height ),
			isminw = this._isNumber( data.width ) && o.minWidth && ( o.minWidth > data.width ),
			isminh = this._isNumber( data.height ) && o.minHeight && ( o.minHeight > data.height ),
			dw = this.originalPosition.left + this.originalSize.width,
			dh = this.originalPosition.top + this.originalSize.height,
			cw = /sw|nw|w/.test( a ), ch = /nw|ne|n/.test( a );
		if ( isminw ) {
			data.width = o.minWidth;
		}
		if ( isminh ) {
			data.height = o.minHeight;
		}
		if ( ismaxw ) {
			data.width = o.maxWidth;
		}
		if ( ismaxh ) {
			data.height = o.maxHeight;
		}

		if ( isminw && cw ) {
			data.left = dw - o.minWidth;
		}
		if ( ismaxw && cw ) {
			data.left = dw - o.maxWidth;
		}
		if ( isminh && ch ) {
			data.top = dh - o.minHeight;
		}
		if ( ismaxh && ch ) {
			data.top = dh - o.maxHeight;
		}

		// Fixing jump error on top/left - bug #2330
		if ( !data.width && !data.height && !data.left && data.top ) {
			data.top = null;
		} else if ( !data.width && !data.height && !data.top && data.left ) {
			data.left = null;
		}

		return data;
	},

	_getPaddingPlusBorderDimensions: function( element ) {
		var i = 0,
			widths = [],
			borders = [
				element.css( "borderTopWidth" ),
				element.css( "borderRightWidth" ),
				element.css( "borderBottomWidth" ),
				element.css( "borderLeftWidth" )
			],
			paddings = [
				element.css( "paddingTop" ),
				element.css( "paddingRight" ),
				element.css( "paddingBottom" ),
				element.css( "paddingLeft" )
			];

		for ( ; i < 4; i++ ) {
			widths[ i ] = ( parseFloat( borders[ i ] ) || 0 );
			widths[ i ] += ( parseFloat( paddings[ i ] ) || 0 );
		}

		return {
			height: widths[ 0 ] + widths[ 2 ],
			width: widths[ 1 ] + widths[ 3 ]
		};
	},

	_proportionallyResize: function() {

		if ( !this._proportionallyResizeElements.length ) {
			return;
		}

		var prel,
			i = 0,
			element = this.helper || this.element;

		for ( ; i < this._proportionallyResizeElements.length; i++ ) {

			prel = this._proportionallyResizeElements[ i ];

			// TODO: Seems like a bug to cache this.outerDimensions
			// considering that we are in a loop.
			if ( !this.outerDimensions ) {
				this.outerDimensions = this._getPaddingPlusBorderDimensions( prel );
			}

			prel.css( {
				height: ( element.height() - this.outerDimensions.height ) || 0,
				width: ( element.width() - this.outerDimensions.width ) || 0
			} );

		}

	},

	_renderProxy: function() {

		var el = this.element, o = this.options;
		this.elementOffset = el.offset();

		if ( this._helper ) {

			this.helper = this.helper || $( "<div style='overflow:hidden;'></div>" );

			this._addClass( this.helper, this._helper );
			this.helper.css( {
				width: this.element.outerWidth(),
				height: this.element.outerHeight(),
				position: "absolute",
				left: this.elementOffset.left + "px",
				top: this.elementOffset.top + "px",
				zIndex: ++o.zIndex //TODO: Don't modify option
			} );

			this.helper
				.appendTo( "body" )
				.disableSelection();

		} else {
			this.helper = this.element;
		}

	},

	_change: {
		e: function( event, dx ) {
			return { width: this.originalSize.width + dx };
		},
		w: function( event, dx ) {
			var cs = this.originalSize, sp = this.originalPosition;
			return { left: sp.left + dx, width: cs.width - dx };
		},
		n: function( event, dx, dy ) {
			var cs = this.originalSize, sp = this.originalPosition;
			return { top: sp.top + dy, height: cs.height - dy };
		},
		s: function( event, dx, dy ) {
			return { height: this.originalSize.height + dy };
		},
		se: function( event, dx, dy ) {
			return $.extend( this._change.s.apply( this, arguments ),
				this._change.e.apply( this, [ event, dx, dy ] ) );
		},
		sw: function( event, dx, dy ) {
			return $.extend( this._change.s.apply( this, arguments ),
				this._change.w.apply( this, [ event, dx, dy ] ) );
		},
		ne: function( event, dx, dy ) {
			return $.extend( this._change.n.apply( this, arguments ),
				this._change.e.apply( this, [ event, dx, dy ] ) );
		},
		nw: function( event, dx, dy ) {
			return $.extend( this._change.n.apply( this, arguments ),
				this._change.w.apply( this, [ event, dx, dy ] ) );
		}
	},

	_propagate: function( n, event ) {
		$.ui.plugin.call( this, n, [ event, this.ui() ] );
		( n !== "resize" && this._trigger( n, event, this.ui() ) );
	},

	plugins: {},

	ui: function() {
		return {
			originalElement: this.originalElement,
			element: this.element,
			helper: this.helper,
			position: this.position,
			size: this.size,
			originalSize: this.originalSize,
			originalPosition: this.originalPosition
		};
	}

} );

/*
 * Resizable Extensions
 */

$.ui.plugin.add( "resizable", "animate", {

	stop: function( event ) {
		var that = $( this ).resizable( "instance" ),
			o = that.options,
			pr = that._proportionallyResizeElements,
			ista = pr.length && ( /textarea/i ).test( pr[ 0 ].nodeName ),
			soffseth = ista && that._hasScroll( pr[ 0 ], "left" ) ? 0 : that.sizeDiff.height,
			soffsetw = ista ? 0 : that.sizeDiff.width,
			style = {
				width: ( that.size.width - soffsetw ),
				height: ( that.size.height - soffseth )
			},
			left = ( parseFloat( that.element.css( "left" ) ) +
				( that.position.left - that.originalPosition.left ) ) || null,
			top = ( parseFloat( that.element.css( "top" ) ) +
				( that.position.top - that.originalPosition.top ) ) || null;

		that.element.animate(
			$.extend( style, top && left ? { top: top, left: left } : {} ), {
				duration: o.animateDuration,
				easing: o.animateEasing,
				step: function() {

					var data = {
						width: parseFloat( that.element.css( "width" ) ),
						height: parseFloat( that.element.css( "height" ) ),
						top: parseFloat( that.element.css( "top" ) ),
						left: parseFloat( that.element.css( "left" ) )
					};

					if ( pr && pr.length ) {
						$( pr[ 0 ] ).css( { width: data.width, height: data.height } );
					}

					// Propagating resize, and updating values for each animation step
					that._updateCache( data );
					that._propagate( "resize", event );

				}
			}
		);
	}

} );

$.ui.plugin.add( "resizable", "containment", {

	start: function() {
		var element, p, co, ch, cw, width, height,
			that = $( this ).resizable( "instance" ),
			o = that.options,
			el = that.element,
			oc = o.containment,
			ce = ( oc instanceof $ ) ?
				oc.get( 0 ) :
				( /parent/.test( oc ) ) ? el.parent().get( 0 ) : oc;

		if ( !ce ) {
			return;
		}

		that.containerElement = $( ce );

		if ( /document/.test( oc ) || oc === document ) {
			that.containerOffset = {
				left: 0,
				top: 0
			};
			that.containerPosition = {
				left: 0,
				top: 0
			};

			that.parentData = {
				element: $( document ),
				left: 0,
				top: 0,
				width: $( document ).width(),
				height: $( document ).height() || document.body.parentNode.scrollHeight
			};
		} else {
			element = $( ce );
			p = [];
			$( [ "Top", "Right", "Left", "Bottom" ] ).each( function( i, name ) {
				p[ i ] = that._num( element.css( "padding" + name ) );
			} );

			that.containerOffset = element.offset();
			that.containerPosition = element.position();
			that.containerSize = {
				height: ( element.innerHeight() - p[ 3 ] ),
				width: ( element.innerWidth() - p[ 1 ] )
			};

			co = that.containerOffset;
			ch = that.containerSize.height;
			cw = that.containerSize.width;
			width = ( that._hasScroll ( ce, "left" ) ? ce.scrollWidth : cw );
			height = ( that._hasScroll ( ce ) ? ce.scrollHeight : ch ) ;

			that.parentData = {
				element: ce,
				left: co.left,
				top: co.top,
				width: width,
				height: height
			};
		}
	},

	resize: function( event ) {
		var woset, hoset, isParent, isOffsetRelative,
			that = $( this ).resizable( "instance" ),
			o = that.options,
			co = that.containerOffset,
			cp = that.position,
			pRatio = that._aspectRatio || event.shiftKey,
			cop = {
				top: 0,
				left: 0
			},
			ce = that.containerElement,
			continueResize = true;

		if ( ce[ 0 ] !== document && ( /static/ ).test( ce.css( "position" ) ) ) {
			cop = co;
		}

		if ( cp.left < ( that._helper ? co.left : 0 ) ) {
			that.size.width = that.size.width +
				( that._helper ?
					( that.position.left - co.left ) :
					( that.position.left - cop.left ) );

			if ( pRatio ) {
				that.size.height = that.size.width / that.aspectRatio;
				continueResize = false;
			}
			that.position.left = o.helper ? co.left : 0;
		}

		if ( cp.top < ( that._helper ? co.top : 0 ) ) {
			that.size.height = that.size.height +
				( that._helper ?
					( that.position.top - co.top ) :
					that.position.top );

			if ( pRatio ) {
				that.size.width = that.size.height * that.aspectRatio;
				continueResize = false;
			}
			that.position.top = that._helper ? co.top : 0;
		}

		isParent = that.containerElement.get( 0 ) === that.element.parent().get( 0 );
		isOffsetRelative = /relative|absolute/.test( that.containerElement.css( "position" ) );

		if ( isParent && isOffsetRelative ) {
			that.offset.left = that.parentData.left + that.position.left;
			that.offset.top = that.parentData.top + that.position.top;
		} else {
			that.offset.left = that.element.offset().left;
			that.offset.top = that.element.offset().top;
		}

		woset = Math.abs( that.sizeDiff.width +
			( that._helper ?
				that.offset.left - cop.left :
				( that.offset.left - co.left ) ) );

		hoset = Math.abs( that.sizeDiff.height +
			( that._helper ?
				that.offset.top - cop.top :
				( that.offset.top - co.top ) ) );

		if ( woset + that.size.width >= that.parentData.width ) {
			that.size.width = that.parentData.width - woset;
			if ( pRatio ) {
				that.size.height = that.size.width / that.aspectRatio;
				continueResize = false;
			}
		}

		if ( hoset + that.size.height >= that.parentData.height ) {
			that.size.height = that.parentData.height - hoset;
			if ( pRatio ) {
				that.size.width = that.size.height * that.aspectRatio;
				continueResize = false;
			}
		}

		if ( !continueResize ) {
			that.position.left = that.prevPosition.left;
			that.position.top = that.prevPosition.top;
			that.size.width = that.prevSize.width;
			that.size.height = that.prevSize.height;
		}
	},

	stop: function() {
		var that = $( this ).resizable( "instance" ),
			o = that.options,
			co = that.containerOffset,
			cop = that.containerPosition,
			ce = that.containerElement,
			helper = $( that.helper ),
			ho = helper.offset(),
			w = helper.outerWidth() - that.sizeDiff.width,
			h = helper.outerHeight() - that.sizeDiff.height;

		if ( that._helper && !o.animate && ( /relative/ ).test( ce.css( "position" ) ) ) {
			$( this ).css( {
				left: ho.left - cop.left - co.left,
				width: w,
				height: h
			} );
		}

		if ( that._helper && !o.animate && ( /static/ ).test( ce.css( "position" ) ) ) {
			$( this ).css( {
				left: ho.left - cop.left - co.left,
				width: w,
				height: h
			} );
		}
	}
} );

$.ui.plugin.add( "resizable", "alsoResize", {

	start: function() {
		var that = $( this ).resizable( "instance" ),
			o = that.options;

		$( o.alsoResize ).each( function() {
			var el = $( this );
			el.data( "ui-resizable-alsoresize", {
				width: parseFloat( el.width() ), height: parseFloat( el.height() ),
				left: parseFloat( el.css( "left" ) ), top: parseFloat( el.css( "top" ) )
			} );
		} );
	},

	resize: function( event, ui ) {
		var that = $( this ).resizable( "instance" ),
			o = that.options,
			os = that.originalSize,
			op = that.originalPosition,
			delta = {
				height: ( that.size.height - os.height ) || 0,
				width: ( that.size.width - os.width ) || 0,
				top: ( that.position.top - op.top ) || 0,
				left: ( that.position.left - op.left ) || 0
			};

			$( o.alsoResize ).each( function() {
				var el = $( this ), start = $( this ).data( "ui-resizable-alsoresize" ), style = {},
					css = el.parents( ui.originalElement[ 0 ] ).length ?
							[ "width", "height" ] :
							[ "width", "height", "top", "left" ];

				$.each( css, function( i, prop ) {
					var sum = ( start[ prop ] || 0 ) + ( delta[ prop ] || 0 );
					if ( sum && sum >= 0 ) {
						style[ prop ] = sum || null;
					}
				} );

				el.css( style );
			} );
	},

	stop: function() {
		$( this ).removeData( "ui-resizable-alsoresize" );
	}
} );

$.ui.plugin.add( "resizable", "ghost", {

	start: function() {

		var that = $( this ).resizable( "instance" ), cs = that.size;

		that.ghost = that.originalElement.clone();
		that.ghost.css( {
			opacity: 0.25,
			display: "block",
			position: "relative",
			height: cs.height,
			width: cs.width,
			margin: 0,
			left: 0,
			top: 0
		} );

		that._addClass( that.ghost, "ui-resizable-ghost" );

		// DEPRECATED
		// TODO: remove after 1.12
		if ( $.uiBackCompat !== false && typeof that.options.ghost === "string" ) {

			// Ghost option
			that.ghost.addClass( this.options.ghost );
		}

		that.ghost.appendTo( that.helper );

	},

	resize: function() {
		var that = $( this ).resizable( "instance" );
		if ( that.ghost ) {
			that.ghost.css( {
				position: "relative",
				height: that.size.height,
				width: that.size.width
			} );
		}
	},

	stop: function() {
		var that = $( this ).resizable( "instance" );
		if ( that.ghost && that.helper ) {
			that.helper.get( 0 ).removeChild( that.ghost.get( 0 ) );
		}
	}

} );

$.ui.plugin.add( "resizable", "grid", {

	resize: function() {
		var outerDimensions,
			that = $( this ).resizable( "instance" ),
			o = that.options,
			cs = that.size,
			os = that.originalSize,
			op = that.originalPosition,
			a = that.axis,
			grid = typeof o.grid === "number" ? [ o.grid, o.grid ] : o.grid,
			gridX = ( grid[ 0 ] || 1 ),
			gridY = ( grid[ 1 ] || 1 ),
			ox = Math.round( ( cs.width - os.width ) / gridX ) * gridX,
			oy = Math.round( ( cs.height - os.height ) / gridY ) * gridY,
			newWidth = os.width + ox,
			newHeight = os.height + oy,
			isMaxWidth = o.maxWidth && ( o.maxWidth < newWidth ),
			isMaxHeight = o.maxHeight && ( o.maxHeight < newHeight ),
			isMinWidth = o.minWidth && ( o.minWidth > newWidth ),
			isMinHeight = o.minHeight && ( o.minHeight > newHeight );

		o.grid = grid;

		if ( isMinWidth ) {
			newWidth += gridX;
		}
		if ( isMinHeight ) {
			newHeight += gridY;
		}
		if ( isMaxWidth ) {
			newWidth -= gridX;
		}
		if ( isMaxHeight ) {
			newHeight -= gridY;
		}

		if ( /^(se|s|e)$/.test( a ) ) {
			that.size.width = newWidth;
			that.size.height = newHeight;
		} else if ( /^(ne)$/.test( a ) ) {
			that.size.width = newWidth;
			that.size.height = newHeight;
			that.position.top = op.top - oy;
		} else if ( /^(sw)$/.test( a ) ) {
			that.size.width = newWidth;
			that.size.height = newHeight;
			that.position.left = op.left - ox;
		} else {
			if ( newHeight - gridY <= 0 || newWidth - gridX <= 0 ) {
				outerDimensions = that._getPaddingPlusBorderDimensions( this );
			}

			if ( newHeight - gridY > 0 ) {
				that.size.height = newHeight;
				that.position.top = op.top - oy;
			} else {
				newHeight = gridY - outerDimensions.height;
				that.size.height = newHeight;
				that.position.top = op.top + os.height - newHeight;
			}
			if ( newWidth - gridX > 0 ) {
				that.size.width = newWidth;
				that.position.left = op.left - ox;
			} else {
				newWidth = gridX - outerDimensions.width;
				that.size.width = newWidth;
				that.position.left = op.left + os.width - newWidth;
			}
		}
	}

} );

return $.ui.resizable;

} ) );

},{}],68:[function(require,module,exports){
/*!
 * jQuery UI Spinner 1.12.1
 * http://jqueryui.com
 *
 * Copyright jQuery Foundation and other contributors
 * Released under the MIT license.
 * http://jquery.org/license
 */

//>>label: Spinner
//>>group: Widgets
//>>description: Displays buttons to easily input numbers via the keyboard or mouse.
//>>docs: http://api.jqueryui.com/spinner/
//>>demos: http://jqueryui.com/spinner/
//>>css.structure: ../../themes/base/core.css
//>>css.structure: ../../themes/base/spinner.css
//>>css.theme: ../../themes/base/theme.css

( function( factory ) {
	if ( typeof define === "function" && define.amd ) {

		// AMD. Register as an anonymous module.
		define( [
			"jquery",
			"./button",
			"../version",
			"../keycode",
			"../safe-active-element",
			"../widget"
		], factory );
	} else {

		// Browser globals
		factory( jQuery );
	}
}( function( $ ) {

function spinnerModifer( fn ) {
	return function() {
		var previous = this.element.val();
		fn.apply( this, arguments );
		this._refresh();
		if ( previous !== this.element.val() ) {
			this._trigger( "change" );
		}
	};
}

$.widget( "ui.spinner", {
	version: "1.12.1",
	defaultElement: "<input>",
	widgetEventPrefix: "spin",
	options: {
		classes: {
			"ui-spinner": "ui-corner-all",
			"ui-spinner-down": "ui-corner-br",
			"ui-spinner-up": "ui-corner-tr"
		},
		culture: null,
		icons: {
			down: "ui-icon-triangle-1-s",
			up: "ui-icon-triangle-1-n"
		},
		incremental: true,
		max: null,
		min: null,
		numberFormat: null,
		page: 10,
		step: 1,

		change: null,
		spin: null,
		start: null,
		stop: null
	},

	_create: function() {

		// handle string values that need to be parsed
		this._setOption( "max", this.options.max );
		this._setOption( "min", this.options.min );
		this._setOption( "step", this.options.step );

		// Only format if there is a value, prevents the field from being marked
		// as invalid in Firefox, see #9573.
		if ( this.value() !== "" ) {

			// Format the value, but don't constrain.
			this._value( this.element.val(), true );
		}

		this._draw();
		this._on( this._events );
		this._refresh();

		// Turning off autocomplete prevents the browser from remembering the
		// value when navigating through history, so we re-enable autocomplete
		// if the page is unloaded before the widget is destroyed. #7790
		this._on( this.window, {
			beforeunload: function() {
				this.element.removeAttr( "autocomplete" );
			}
		} );
	},

	_getCreateOptions: function() {
		var options = this._super();
		var element = this.element;

		$.each( [ "min", "max", "step" ], function( i, option ) {
			var value = element.attr( option );
			if ( value != null && value.length ) {
				options[ option ] = value;
			}
		} );

		return options;
	},

	_events: {
		keydown: function( event ) {
			if ( this._start( event ) && this._keydown( event ) ) {
				event.preventDefault();
			}
		},
		keyup: "_stop",
		focus: function() {
			this.previous = this.element.val();
		},
		blur: function( event ) {
			if ( this.cancelBlur ) {
				delete this.cancelBlur;
				return;
			}

			this._stop();
			this._refresh();
			if ( this.previous !== this.element.val() ) {
				this._trigger( "change", event );
			}
		},
		mousewheel: function( event, delta ) {
			if ( !delta ) {
				return;
			}
			if ( !this.spinning && !this._start( event ) ) {
				return false;
			}

			this._spin( ( delta > 0 ? 1 : -1 ) * this.options.step, event );
			clearTimeout( this.mousewheelTimer );
			this.mousewheelTimer = this._delay( function() {
				if ( this.spinning ) {
					this._stop( event );
				}
			}, 100 );
			event.preventDefault();
		},
		"mousedown .ui-spinner-button": function( event ) {
			var previous;

			// We never want the buttons to have focus; whenever the user is
			// interacting with the spinner, the focus should be on the input.
			// If the input is focused then this.previous is properly set from
			// when the input first received focus. If the input is not focused
			// then we need to set this.previous based on the value before spinning.
			previous = this.element[ 0 ] === $.ui.safeActiveElement( this.document[ 0 ] ) ?
				this.previous : this.element.val();
			function checkFocus() {
				var isActive = this.element[ 0 ] === $.ui.safeActiveElement( this.document[ 0 ] );
				if ( !isActive ) {
					this.element.trigger( "focus" );
					this.previous = previous;

					// support: IE
					// IE sets focus asynchronously, so we need to check if focus
					// moved off of the input because the user clicked on the button.
					this._delay( function() {
						this.previous = previous;
					} );
				}
			}

			// Ensure focus is on (or stays on) the text field
			event.preventDefault();
			checkFocus.call( this );

			// Support: IE
			// IE doesn't prevent moving focus even with event.preventDefault()
			// so we set a flag to know when we should ignore the blur event
			// and check (again) if focus moved off of the input.
			this.cancelBlur = true;
			this._delay( function() {
				delete this.cancelBlur;
				checkFocus.call( this );
			} );

			if ( this._start( event ) === false ) {
				return;
			}

			this._repeat( null, $( event.currentTarget )
				.hasClass( "ui-spinner-up" ) ? 1 : -1, event );
		},
		"mouseup .ui-spinner-button": "_stop",
		"mouseenter .ui-spinner-button": function( event ) {

			// button will add ui-state-active if mouse was down while mouseleave and kept down
			if ( !$( event.currentTarget ).hasClass( "ui-state-active" ) ) {
				return;
			}

			if ( this._start( event ) === false ) {
				return false;
			}
			this._repeat( null, $( event.currentTarget )
				.hasClass( "ui-spinner-up" ) ? 1 : -1, event );
		},

		// TODO: do we really want to consider this a stop?
		// shouldn't we just stop the repeater and wait until mouseup before
		// we trigger the stop event?
		"mouseleave .ui-spinner-button": "_stop"
	},

	// Support mobile enhanced option and make backcompat more sane
	_enhance: function() {
		this.uiSpinner = this.element
			.attr( "autocomplete", "off" )
			.wrap( "<span>" )
			.parent()

				// Add buttons
				.append(
					"<a></a><a></a>"
				);
	},

	_draw: function() {
		this._enhance();

		this._addClass( this.uiSpinner, "ui-spinner", "ui-widget ui-widget-content" );
		this._addClass( "ui-spinner-input" );

		this.element.attr( "role", "spinbutton" );

		// Button bindings
		this.buttons = this.uiSpinner.children( "a" )
			.attr( "tabIndex", -1 )
			.attr( "aria-hidden", true )
			.button( {
				classes: {
					"ui-button": ""
				}
			} );

		// TODO: Right now button does not support classes this is already updated in button PR
		this._removeClass( this.buttons, "ui-corner-all" );

		this._addClass( this.buttons.first(), "ui-spinner-button ui-spinner-up" );
		this._addClass( this.buttons.last(), "ui-spinner-button ui-spinner-down" );
		this.buttons.first().button( {
			"icon": this.options.icons.up,
			"showLabel": false
		} );
		this.buttons.last().button( {
			"icon": this.options.icons.down,
			"showLabel": false
		} );

		// IE 6 doesn't understand height: 50% for the buttons
		// unless the wrapper has an explicit height
		if ( this.buttons.height() > Math.ceil( this.uiSpinner.height() * 0.5 ) &&
				this.uiSpinner.height() > 0 ) {
			this.uiSpinner.height( this.uiSpinner.height() );
		}
	},

	_keydown: function( event ) {
		var options = this.options,
			keyCode = $.ui.keyCode;

		switch ( event.keyCode ) {
		case keyCode.UP:
			this._repeat( null, 1, event );
			return true;
		case keyCode.DOWN:
			this._repeat( null, -1, event );
			return true;
		case keyCode.PAGE_UP:
			this._repeat( null, options.page, event );
			return true;
		case keyCode.PAGE_DOWN:
			this._repeat( null, -options.page, event );
			return true;
		}

		return false;
	},

	_start: function( event ) {
		if ( !this.spinning && this._trigger( "start", event ) === false ) {
			return false;
		}

		if ( !this.counter ) {
			this.counter = 1;
		}
		this.spinning = true;
		return true;
	},

	_repeat: function( i, steps, event ) {
		i = i || 500;

		clearTimeout( this.timer );
		this.timer = this._delay( function() {
			this._repeat( 40, steps, event );
		}, i );

		this._spin( steps * this.options.step, event );
	},

	_spin: function( step, event ) {
		var value = this.value() || 0;

		if ( !this.counter ) {
			this.counter = 1;
		}

		value = this._adjustValue( value + step * this._increment( this.counter ) );

		if ( !this.spinning || this._trigger( "spin", event, { value: value } ) !== false ) {
			this._value( value );
			this.counter++;
		}
	},

	_increment: function( i ) {
		var incremental = this.options.incremental;

		if ( incremental ) {
			return $.isFunction( incremental ) ?
				incremental( i ) :
				Math.floor( i * i * i / 50000 - i * i / 500 + 17 * i / 200 + 1 );
		}

		return 1;
	},

	_precision: function() {
		var precision = this._precisionOf( this.options.step );
		if ( this.options.min !== null ) {
			precision = Math.max( precision, this._precisionOf( this.options.min ) );
		}
		return precision;
	},

	_precisionOf: function( num ) {
		var str = num.toString(),
			decimal = str.indexOf( "." );
		return decimal === -1 ? 0 : str.length - decimal - 1;
	},

	_adjustValue: function( value ) {
		var base, aboveMin,
			options = this.options;

		// Make sure we're at a valid step
		// - find out where we are relative to the base (min or 0)
		base = options.min !== null ? options.min : 0;
		aboveMin = value - base;

		// - round to the nearest step
		aboveMin = Math.round( aboveMin / options.step ) * options.step;

		// - rounding is based on 0, so adjust back to our base
		value = base + aboveMin;

		// Fix precision from bad JS floating point math
		value = parseFloat( value.toFixed( this._precision() ) );

		// Clamp the value
		if ( options.max !== null && value > options.max ) {
			return options.max;
		}
		if ( options.min !== null && value < options.min ) {
			return options.min;
		}

		return value;
	},

	_stop: function( event ) {
		if ( !this.spinning ) {
			return;
		}

		clearTimeout( this.timer );
		clearTimeout( this.mousewheelTimer );
		this.counter = 0;
		this.spinning = false;
		this._trigger( "stop", event );
	},

	_setOption: function( key, value ) {
		var prevValue, first, last;

		if ( key === "culture" || key === "numberFormat" ) {
			prevValue = this._parse( this.element.val() );
			this.options[ key ] = value;
			this.element.val( this._format( prevValue ) );
			return;
		}

		if ( key === "max" || key === "min" || key === "step" ) {
			if ( typeof value === "string" ) {
				value = this._parse( value );
			}
		}
		if ( key === "icons" ) {
			first = this.buttons.first().find( ".ui-icon" );
			this._removeClass( first, null, this.options.icons.up );
			this._addClass( first, null, value.up );
			last = this.buttons.last().find( ".ui-icon" );
			this._removeClass( last, null, this.options.icons.down );
			this._addClass( last, null, value.down );
		}

		this._super( key, value );
	},

	_setOptionDisabled: function( value ) {
		this._super( value );

		this._toggleClass( this.uiSpinner, null, "ui-state-disabled", !!value );
		this.element.prop( "disabled", !!value );
		this.buttons.button( value ? "disable" : "enable" );
	},

	_setOptions: spinnerModifer( function( options ) {
		this._super( options );
	} ),

	_parse: function( val ) {
		if ( typeof val === "string" && val !== "" ) {
			val = window.Globalize && this.options.numberFormat ?
				Globalize.parseFloat( val, 10, this.options.culture ) : +val;
		}
		return val === "" || isNaN( val ) ? null : val;
	},

	_format: function( value ) {
		if ( value === "" ) {
			return "";
		}
		return window.Globalize && this.options.numberFormat ?
			Globalize.format( value, this.options.numberFormat, this.options.culture ) :
			value;
	},

	_refresh: function() {
		this.element.attr( {
			"aria-valuemin": this.options.min,
			"aria-valuemax": this.options.max,

			// TODO: what should we do with values that can't be parsed?
			"aria-valuenow": this._parse( this.element.val() )
		} );
	},

	isValid: function() {
		var value = this.value();

		// Null is invalid
		if ( value === null ) {
			return false;
		}

		// If value gets adjusted, it's invalid
		return value === this._adjustValue( value );
	},

	// Update the value without triggering change
	_value: function( value, allowAny ) {
		var parsed;
		if ( value !== "" ) {
			parsed = this._parse( value );
			if ( parsed !== null ) {
				if ( !allowAny ) {
					parsed = this._adjustValue( parsed );
				}
				value = this._format( parsed );
			}
		}
		this.element.val( value );
		this._refresh();
	},

	_destroy: function() {
		this.element
			.prop( "disabled", false )
			.removeAttr( "autocomplete role aria-valuemin aria-valuemax aria-valuenow" );

		this.uiSpinner.replaceWith( this.element );
	},

	stepUp: spinnerModifer( function( steps ) {
		this._stepUp( steps );
	} ),
	_stepUp: function( steps ) {
		if ( this._start() ) {
			this._spin( ( steps || 1 ) * this.options.step );
			this._stop();
		}
	},

	stepDown: spinnerModifer( function( steps ) {
		this._stepDown( steps );
	} ),
	_stepDown: function( steps ) {
		if ( this._start() ) {
			this._spin( ( steps || 1 ) * -this.options.step );
			this._stop();
		}
	},

	pageUp: spinnerModifer( function( pages ) {
		this._stepUp( ( pages || 1 ) * this.options.page );
	} ),

	pageDown: spinnerModifer( function( pages ) {
		this._stepDown( ( pages || 1 ) * this.options.page );
	} ),

	value: function( newVal ) {
		if ( !arguments.length ) {
			return this._parse( this.element.val() );
		}
		spinnerModifer( this._value ).call( this, newVal );
	},

	widget: function() {
		return this.uiSpinner;
	}
} );

// DEPRECATED
// TODO: switch return back to widget declaration at top of file when this is removed
if ( $.uiBackCompat !== false ) {

	// Backcompat for spinner html extension points
	$.widget( "ui.spinner", $.ui.spinner, {
		_enhance: function() {
			this.uiSpinner = this.element
				.attr( "autocomplete", "off" )
				.wrap( this._uiSpinnerHtml() )
				.parent()

					// Add buttons
					.append( this._buttonHtml() );
		},
		_uiSpinnerHtml: function() {
			return "<span>";
		},

		_buttonHtml: function() {
			return "<a></a><a></a>";
		}
	} );
}

return $.ui.spinner;

} ) );

},{}],69:[function(require,module,exports){
!function(e,r){if("object"==typeof exports&&"object"==typeof module)module.exports=r();else if("function"==typeof define&&define.amd)define([],r);else{var t=r();for(var n in t)("object"==typeof exports?exports:e)[n]=t[n]}}(this,function(){return function(e){function r(n){if(t[n])return t[n].exports;var o=t[n]={exports:{},id:n,loaded:!1};return e[n].call(o.exports,o,o.exports,r),o.loaded=!0,o.exports}var t={};return r.m=e,r.c=t,r.p="",r(0)}([function(e,r,t){e.exports=t(1)},function(e,r,t){"use strict";function n(){var e="undefined"==typeof JSON?{}:JSON;o.setupJSON(e)}var o=t(2),i=t(3);n();var a=window._rollbarConfig,s=a&&a.globalAlias||"Rollbar",u=window[s]&&"undefined"!=typeof window[s].shimId;!u&&a?o.wrapper.init(a):(window.Rollbar=o.wrapper,window.RollbarNotifier=i.Notifier),e.exports=o.wrapper},function(e,r,t){"use strict";function n(e,r,t){!t[4]&&window._rollbarWrappedError&&(t[4]=window._rollbarWrappedError,window._rollbarWrappedError=null),e.uncaughtError.apply(e,t),r&&r.apply(window,t)}function o(e,r){if(r.hasOwnProperty&&r.hasOwnProperty("addEventListener")){var t=r.addEventListener;r.addEventListener=function(r,n,o){t.call(this,r,e.wrap(n),o)};var n=r.removeEventListener;r.removeEventListener=function(e,r,t){n.call(this,e,r&&r._wrapped||r,t)}}}var i=t(3),a=t(8),s=i.Notifier;window._rollbarWrappedError=null;var u={};u.init=function(e,r){var t=new s(r);if(t.configure(e),e.captureUncaught){var i;r&&a.isType(r._rollbarOldOnError,"function")?i=r._rollbarOldOnError:window.onerror&&!window.onerror.belongsToShim&&(i=window.onerror),window.onerror=function(){var e=Array.prototype.slice.call(arguments,0);n(t,i,e)};var u,c,l=["EventTarget","Window","Node","ApplicationCache","AudioTrackList","ChannelMergerNode","CryptoOperation","EventSource","FileReader","HTMLUnknownElement","IDBDatabase","IDBRequest","IDBTransaction","KeyOperation","MediaController","MessagePort","ModalWindow","Notification","SVGElementInstance","Screen","TextTrack","TextTrackCue","TextTrackList","WebSocket","WebSocketWorker","Worker","XMLHttpRequest","XMLHttpRequestEventTarget","XMLHttpRequestUpload"];for(u=0;u<l.length;++u)c=l[u],window[c]&&window[c].prototype&&o(t,window[c].prototype)}return e.captureUnhandledRejections&&(r&&a.isType(r._unhandledRejectionHandler,"function")&&window.removeEventListener("unhandledrejection",r._unhandledRejectionHandler),t._unhandledRejectionHandler=function(e){var r=e.reason,n=e.promise,o=e.detail;!r&&o&&(r=o.reason,n=o.promise),t.unhandledRejection(r,n)},window.addEventListener("unhandledrejection",t._unhandledRejectionHandler)),window.Rollbar=t,s.processPayloads(),t},e.exports={wrapper:u,setupJSON:i.setupJSON}},function(e,r,t){"use strict";function n(e){E=e,w.setupJSON(e)}function o(e,r){return function(){var t=r||this;try{return e.apply(t,arguments)}catch(n){console.error("[Rollbar]:",n)}}}function i(){h||(h=setTimeout(f,1e3))}function a(){return _}function s(e){_=_||this;var r="https://"+s.DEFAULT_ENDPOINT;this.options={enabled:!0,endpoint:r,environment:"production",scrubFields:g([],s.DEFAULT_SCRUB_FIELDS),checkIgnore:null,logLevel:s.DEFAULT_LOG_LEVEL,reportLevel:s.DEFAULT_REPORT_LEVEL,uncaughtErrorLevel:s.DEFAULT_UNCAUGHT_ERROR_LEVEL,payload:{}},this.lastError=null,this.plugins={},this.parentNotifier=e,e&&(e.hasOwnProperty("shimId")?e.notifier=this:this.configure(e.options))}function u(e){window._rollbarPayloadQueue.push(e),i()}function c(e){return o(function(){var r=this._getLogArgs(arguments);return this._log(e||r.level||this.options.logLevel||s.DEFAULT_LOG_LEVEL,r.message,r.err,r.custom,r.callback)})}function l(e,r){e||(e=r?E.stringify(r):"");var t={body:e};return r&&(t.extra=g(!0,{},r)),{message:t}}function p(e,r,t){var n=m.guessErrorClass(r.message),o=r.name||n[0],i=n[1],a={exception:{"class":o,message:i}};if(e&&(a.exception.description=e||"uncaught exception"),r.stack){var s,u,c,p,f,d,h,w;for(a.frames=[],h=0;h<r.stack.length;++h)s=r.stack[h],u={filename:s.url?v.sanitizeUrl(s.url):"(unknown)",lineno:s.line||null,method:s.func&&"?"!==s.func?s.func:"[anonymous]",colno:s.column},c=p=f=null,d=s.context?s.context.length:0,d&&(w=Math.floor(d/2),p=s.context.slice(0,w),c=s.context[w],f=s.context.slice(w)),c&&(u.code=c),(p||f)&&(u.context={},p&&p.length&&(u.context.pre=p),f&&f.length&&(u.context.post=f)),s.args&&(u.args=s.args),a.frames.push(u);return a.frames.reverse(),t&&(a.extra=g(!0,{},t)),{trace:a}}return l(o+": "+i,t)}function f(){var e;try{for(;e=window._rollbarPayloadQueue.shift();)d(e)}finally{h=void 0}}function d(e){var r=e.endpointUrl,t=e.accessToken,n=e.payload,o=e.callback||function(){},i=(new Date).getTime();i-L>=6e4&&(L=i,R=0);var a=window._globalRollbarOptions.maxItems,c=window._globalRollbarOptions.itemsPerMinute,l=function(){return!n.ignoreRateLimit&&a>=1&&T>=a},p=function(){return!n.ignoreRateLimit&&c>=1&&R>=c};return l()?void o(new Error(a+" max items reached")):p()?void o(new Error(c+" items per minute reached")):(T++,R++,l()&&_._log(_.options.uncaughtErrorLevel,"maxItems has been hit. Ignoring errors for the remainder of the current page load.",null,{maxItems:a},null,!1,!0),n.ignoreRateLimit&&delete n.ignoreRateLimit,void y.post(r,t,n,function(r,t){return r?(r instanceof b&&(e.callback=function(){},setTimeout(function(){u(e)},s.RETRY_DELAY)),o(r)):o(null,t)}))}var h,g=t(4),m=t(5),v=t(8),w=t(10),y=w.XHR,b=w.ConnectionError,E=null;s.NOTIFIER_VERSION="1.9.2",s.DEFAULT_ENDPOINT="api.rollbar.com/api/1/",s.DEFAULT_SCRUB_FIELDS=["pw","pass","passwd","password","secret","confirm_password","confirmPassword","password_confirmation","passwordConfirmation","access_token","accessToken","secret_key","secretKey","secretToken"],s.DEFAULT_LOG_LEVEL="debug",s.DEFAULT_REPORT_LEVEL="debug",s.DEFAULT_UNCAUGHT_ERROR_LEVEL="error",s.DEFAULT_ITEMS_PER_MIN=60,s.DEFAULT_MAX_ITEMS=0,s.LEVELS={debug:0,info:1,warning:2,error:3,critical:4},s.RETRY_DELAY=1e4,window._rollbarPayloadQueue=window._rollbarPayloadQueue||[],window._globalRollbarOptions={startTime:(new Date).getTime(),maxItems:s.DEFAULT_MAX_ITEMS,itemsPerMinute:s.DEFAULT_ITEMS_PER_MIN};var _,x=s.prototype;x._getLogArgs=function(e){for(var r,t,n,i,a,u,c=this.options.logLevel||s.DEFAULT_LOG_LEVEL,l=[],p=0;p<e.length;++p)u=e[p],a=v.typeName(u),"string"===a?r?l.push(u):r=u:"function"===a?i=o(u,this):"date"===a?l.push(u):"error"===a||u instanceof Error||"undefined"!=typeof DOMException&&u instanceof DOMException?t?l.push(u):t=u:"object"!==a&&"array"!==a||(n?l.push(u):n=u);return l.length&&(n=n||{},n.extraArgs=l),{level:c,message:r,err:t,custom:n,callback:i}},x._route=function(e){var r=this.options.endpoint,t=/\/$/.test(r),n=/^\//.test(e);return t&&n?e=e.substring(1):t||n||(e="/"+e),r+e},x._processShimQueue=function(e){for(var r,t,n,o,i,a,u,c={};t=e.shift();)r=t.shim,n=t.method,o=t.args,i=r.parentShim,u=c[r.shimId],u||(i?(a=c[i.shimId],u=new s(a)):u=this,c[r.shimId]=u),u[n]&&v.isType(u[n],"function")&&u[n].apply(u,o)},x._buildPayload=function(e,r,t,n,o){var i=this.options.accessToken,a=this.options.environment,u=g(!0,{},this.options.payload),c=v.uuid4();if(void 0===s.LEVELS[r])throw new Error("Invalid level");if(!t&&!n&&!o)throw new Error("No message, stack info or custom data");var l={environment:a,endpoint:this.options.endpoint,uuid:c,level:r,platform:"browser",framework:"browser-js",language:"javascript",body:this._buildBody(t,n,o),request:{url:window.location.href,query_string:window.location.search,user_ip:"$remote_ip"},client:{runtime_ms:e.getTime()-window._globalRollbarOptions.startTime,timestamp:Math.round(e.getTime()/1e3),javascript:{browser:window.navigator.userAgent,language:window.navigator.language,cookie_enabled:window.navigator.cookieEnabled,screen:{width:window.screen.width,height:window.screen.height},plugins:this._getBrowserPlugins()}},server:{},notifier:{name:"rollbar-browser-js",version:s.NOTIFIER_VERSION}};u.body&&delete u.body;var p={access_token:i,data:g(!0,l,u)};return this._scrub(p.data),p},x._buildBody=function(e,r,t){var n;return n=r?p(e,r,t):l(e,t)},x._getBrowserPlugins=function(){if(!this._browserPlugins){var e,r,t=window.navigator.plugins||[],n=t.length,o=[];for(r=0;r<n;++r)e=t[r],o.push({name:e.name,description:e.description});this._browserPlugins=o}return this._browserPlugins},x._scrub=function(e){function r(e,r,t,n,o,i){return r+v.redact(i)}function t(e){var t;if(v.isType(e,"string"))for(t=0;t<s.length;++t)e=e.replace(s[t],r);return e}function n(e,r){var t;for(t=0;t<a.length;++t)if(a[t].test(e)){r=v.redact(r);break}return r}function o(e,r){var o=n(e,r);return o===r?t(o):o}var i=this.options.scrubFields,a=this._getScrubFieldRegexs(i),s=this._getScrubQueryParamRegexs(i);return v.traverse(e,o),e},x._getScrubFieldRegexs=function(e){for(var r,t=[],n=0;n<e.length;++n)r="\\[?(%5[bB])?"+e[n]+"\\[?(%5[bB])?\\]?(%5[dD])?",t.push(new RegExp(r,"i"));return t},x._getScrubQueryParamRegexs=function(e){for(var r,t=[],n=0;n<e.length;++n)r="\\[?(%5[bB])?"+e[n]+"\\[?(%5[bB])?\\]?(%5[dD])?",t.push(new RegExp("("+r+"=)([^&\\n]+)","igm"));return t},x._urlIsWhitelisted=function(e){var r,t,n,o,i,a,s,u,c,l;try{if(r=this.options.hostWhiteList,t=e&&e.data&&e.data.body&&e.data.body.trace,!r||0===r.length)return!0;if(!t)return!0;for(s=r.length,i=t.frames.length,c=0;c<i;c++){if(n=t.frames[c],o=n.filename,!v.isType(o,"string"))return!0;for(l=0;l<s;l++)if(a=r[l],u=new RegExp(a),u.test(o))return!0}}catch(p){return this.configure({hostWhiteList:null}),console.error("[Rollbar]: Error while reading your configuration's hostWhiteList option. Removing custom hostWhiteList.",p),!0}return!1},x._messageIsIgnored=function(e){var r,t,n,o,i,a,s,u,c;try{if(i=!1,n=this.options.ignoredMessages,!n||0===n.length)return!1;if(s=e&&e.data&&e.data.body,u=s&&s.trace&&s.trace.exception&&s.trace.exception.message,c=s&&s.message&&s.message.body,r=u||c,!r)return!1;for(o=n.length,t=0;t<o&&(a=new RegExp(n[t],"gi"),!(i=a.test(r)));t++);}catch(l){this.configure({ignoredMessages:null}),console.error("[Rollbar]: Error while reading your configuration's ignoredMessages option. Removing custom ignoredMessages.")}return i},x._enqueuePayload=function(e,r,t,n){var o={callback:n,accessToken:this.options.accessToken,endpointUrl:this._route("item/"),payload:e},i=function(){if(n){var e="This item was not sent to Rollbar because it was ignored. This can happen if a custom checkIgnore() function was used or if the item's level was less than the notifier' reportLevel. See https://rollbar.com/docs/notifier/rollbar.js/configuration for more details.";n(null,{err:0,result:{id:null,uuid:null,message:e}})}};if(this._internalCheckIgnore(r,t,e))return void i();try{if(v.isType(this.options.checkIgnore,"function")&&this.options.checkIgnore(r,t,e))return void i()}catch(a){this.configure({checkIgnore:null}),console.error("[Rollbar]: Error while calling custom checkIgnore() function. Removing custom checkIgnore().",a)}if(this._urlIsWhitelisted(e)&&!this._messageIsIgnored(e)){if(this.options.verbose){if(e.data&&e.data.body&&e.data.body.trace){var s=e.data.body.trace,c=s.exception.message;console.error("[Rollbar]: ",c)}console.info("[Rollbar]: ",o)}v.isType(this.options.logFunction,"function")&&this.options.logFunction(o);try{v.isType(this.options.transform,"function")&&this.options.transform(e)}catch(a){this.configure({transform:null}),console.error("[Rollbar]: Error while calling custom transform() function. Removing custom transform().",a)}this.options.enabled&&u(o)}},x._internalCheckIgnore=function(e,r,t){var n=r[0],o=s.LEVELS[n]||0,i=s.LEVELS[this.options.reportLevel]||0;if(o<i)return!0;var a=this.options?this.options.plugins:{};if(a&&a.jquery&&a.jquery.ignoreAjaxErrors)try{return!!t.data.body.message.extra.isAjax}catch(u){return!1}return!1},x._log=function(e,r,t,n,o,i,a){var s=null;if(t)try{if(s=t._savedStackTrace?t._savedStackTrace:m.parse(t),t===this.lastError)return;this.lastError=t}catch(u){console.error("[Rollbar]: Error while parsing the error object.",u),r=t.message||t.description||r||String(t),t=null}var c=this._buildPayload(new Date,e,r,s,n);a&&(c.ignoreRateLimit=!0),this._enqueuePayload(c,!!i,[e,r,t,n],o)},x.log=c(),x.debug=c("debug"),x.info=c("info"),x.warn=c("warning"),x.warning=c("warning"),x.error=c("error"),x.critical=c("critical"),x.uncaughtError=o(function(e,r,t,n,o,i){if(i=i||null,o&&v.isType(o,"error"))return void this._log(this.options.uncaughtErrorLevel,e,o,i,null,!0);if(r&&v.isType(r,"error"))return void this._log(this.options.uncaughtErrorLevel,e,r,i,null,!0);var a={url:r||"",line:t};a.func=m.guessFunctionName(a.url,a.line),a.context=m.gatherContext(a.url,a.line);var s={mode:"onerror",message:o?String(o):e||"uncaught exception",url:document.location.href,stack:[a],useragent:navigator.userAgent},u=this._buildPayload(new Date,this.options.uncaughtErrorLevel,e,s,i);this._enqueuePayload(u,!0,[this.options.uncaughtErrorLevel,e,r,t,n,o])}),x.unhandledRejection=o(function(e,r){if(null==e)return void _._log(_.options.uncaughtErrorLevel,"unhandled rejection was null or undefined!",null,{},null,!1,!1);var t=e.message||(e?String(e):"unhandled rejection"),n=e._rollbarContext||r._rollbarContext||null;if(e&&v.isType(e,"error"))return void this._log(this.options.uncaughtErrorLevel,t,e,n,null,!0);var o={url:"",line:0};o.func=m.guessFunctionName(o.url,o.line),o.context=m.gatherContext(o.url,o.line);var i={mode:"unhandledrejection",message:t,url:document.location.href,stack:[o],useragent:navigator.userAgent},a=this._buildPayload(new Date,this.options.uncaughtErrorLevel,t,i,n);this._enqueuePayload(a,!0,[this.options.uncaughtErrorLevel,t,o.url,o.line,0,e,r])}),x.global=o(function(e){e=e||{};var r={startTime:e.startTime,maxItems:e.maxItems,itemsPerMinute:e.itemsPerMinute};g(!0,window._globalRollbarOptions,r),void 0!==e.maxItems&&(T=0),void 0!==e.itemsPerMinute&&(R=0)}),x.configure=o(function(e,r){var t=g(!0,{},e);g(!r,this.options,t),this.global(t)}),x.scope=o(function(e){var r=new s(this);return g(!0,r.options.payload,e),r}),x.wrap=function(e,r){try{var t;if(t=v.isType(r,"function")?r:function(){return r||{}},!v.isType(e,"function"))return e;if(e._isWrap)return e;if(!e._wrapped){e._wrapped=function(){try{return e.apply(this,arguments)}catch(r){throw"string"==typeof r&&(r=new String(r)),r.stack||(r._savedStackTrace=m.parse(r)),r._rollbarContext=t()||{},r._rollbarContext._wrappedSource=e.toString(),window._rollbarWrappedError=r,r}},e._wrapped._isWrap=!0;for(var n in e)e.hasOwnProperty(n)&&(e._wrapped[n]=e[n])}return e._wrapped}catch(o){return e}},x.loadFull=function(){console.error("[Rollbar]: Unexpected Rollbar.loadFull() called on a Notifier instance")},s.processPayloads=function(e){return e?void f():void i()};var L=(new Date).getTime(),T=0,R=0;e.exports={Notifier:s,setupJSON:n,topLevelNotifier:a}},function(e,r){"use strict";var t=Object.prototype.hasOwnProperty,n=Object.prototype.toString,o=function(e){return"function"==typeof Array.isArray?Array.isArray(e):"[object Array]"===n.call(e)},i=function(e){if(!e||"[object Object]"!==n.call(e))return!1;var r=t.call(e,"constructor"),o=e.constructor&&e.constructor.prototype&&t.call(e.constructor.prototype,"isPrototypeOf");if(e.constructor&&!r&&!o)return!1;var i;for(i in e);return"undefined"==typeof i||t.call(e,i)};e.exports=function a(){var e,r,t,n,s,u,c=arguments[0],l=1,p=arguments.length,f=!1;for("boolean"==typeof c?(f=c,c=arguments[1]||{},l=2):("object"!=typeof c&&"function"!=typeof c||null==c)&&(c={});l<p;++l)if(e=arguments[l],null!=e)for(r in e)t=c[r],n=e[r],c!==n&&(f&&n&&(i(n)||(s=o(n)))?(s?(s=!1,u=t&&o(t)?t:[]):u=t&&i(t)?t:{},c[r]=a(f,u,n)):"undefined"!=typeof n&&(c[r]=n));return c}},function(e,r,t){"use strict";function n(){return l}function o(){return null}function i(e){var r={};return r._stackFrame=e,r.url=e.fileName,r.line=e.lineNumber,r.func=e.functionName,r.column=e.columnNumber,r.args=e.args,r.context=o(r.url,r.line),r}function a(e){function r(){var r=[];try{r=c.parse(e)}catch(t){r=[]}for(var n=[],o=0;o<r.length;o++)n.push(new i(r[o]));return n}return{stack:r(),message:e.message,name:e.name}}function s(e){return new a(e)}function u(e){if(!e)return["Unknown error. There was no error message to display.",""];var r=e.match(p),t="(unknown)";return r&&(t=r[r.length-1],e=e.replace((r[r.length-2]||"")+t+":",""),e=e.replace(/(^[\s]+|[\s]+$)/g,"")),[t,e]}var c=t(6),l="?",p=new RegExp("^(([a-zA-Z0-9-_$ ]*): *)?(Uncaught )?([a-zA-Z0-9-_$ ]*): ");e.exports={guessFunctionName:n,guessErrorClass:u,gatherContext:o,parse:s,Stack:a,Frame:i}},function(e,r,t){var n,o,i;!function(a,s){"use strict";o=[t(7)],n=s,i="function"==typeof n?n.apply(r,o):n,!(void 0!==i&&(e.exports=i))}(this,function(e){"use strict";function r(e,r,t){if("function"==typeof Array.prototype.map)return e.map(r,t);for(var n=new Array(e.length),o=0;o<e.length;o++)n[o]=r.call(t,e[o]);return n}function t(e,r,t){if("function"==typeof Array.prototype.filter)return e.filter(r,t);for(var n=[],o=0;o<e.length;o++)r.call(t,e[o])&&n.push(e[o]);return n}var n=/(^|@)\S+\:\d+/,o=/^\s*at .*(\S+\:\d+|\(native\))/m,i=/^(eval@)?(\[native code\])?$/;return{parse:function(e){if("undefined"!=typeof e.stacktrace||"undefined"!=typeof e["opera#sourceloc"])return this.parseOpera(e);if(e.stack&&e.stack.match(o))return this.parseV8OrIE(e);if(e.stack)return this.parseFFOrSafari(e);throw new Error("Cannot parse given Error object")},extractLocation:function(e){if(e.indexOf(":")===-1)return[e];var r=e.replace(/[\(\)\s]/g,"").split(":"),t=r.pop(),n=r[r.length-1];if(!isNaN(parseFloat(n))&&isFinite(n)){var o=r.pop();return[r.join(":"),o,t]}return[r.join(":"),t,void 0]},parseV8OrIE:function(n){var i=t(n.stack.split("\n"),function(e){return!!e.match(o)},this);return r(i,function(r){r.indexOf("(eval ")>-1&&(r=r.replace(/eval code/g,"eval").replace(/(\(eval at [^\()]*)|(\)\,.*$)/g,""));var t=r.replace(/^\s+/,"").replace(/\(eval code/g,"(").split(/\s+/).slice(1),n=this.extractLocation(t.pop()),o=t.join(" ")||void 0,i="eval"===n[0]?void 0:n[0];return new e(o,(void 0),i,n[1],n[2],r)},this)},parseFFOrSafari:function(n){var o=t(n.stack.split("\n"),function(e){return!e.match(i)},this);return r(o,function(r){if(r.indexOf(" > eval")>-1&&(r=r.replace(/ line (\d+)(?: > eval line \d+)* > eval\:\d+\:\d+/g,":$1")),r.indexOf("@")===-1&&r.indexOf(":")===-1)return new e(r);var t=r.split("@"),n=this.extractLocation(t.pop()),o=t.shift()||void 0;return new e(o,(void 0),n[0],n[1],n[2],r)},this)},parseOpera:function(e){return!e.stacktrace||e.message.indexOf("\n")>-1&&e.message.split("\n").length>e.stacktrace.split("\n").length?this.parseOpera9(e):e.stack?this.parseOpera11(e):this.parseOpera10(e)},parseOpera9:function(r){for(var t=/Line (\d+).*script (?:in )?(\S+)/i,n=r.message.split("\n"),o=[],i=2,a=n.length;i<a;i+=2){var s=t.exec(n[i]);s&&o.push(new e((void 0),(void 0),s[2],s[1],(void 0),n[i]))}return o},parseOpera10:function(r){for(var t=/Line (\d+).*script (?:in )?(\S+)(?:: In function (\S+))?$/i,n=r.stacktrace.split("\n"),o=[],i=0,a=n.length;i<a;i+=2){var s=t.exec(n[i]);s&&o.push(new e(s[3]||void 0,(void 0),s[2],s[1],(void 0),n[i]))}return o},parseOpera11:function(o){var i=t(o.stack.split("\n"),function(e){return!!e.match(n)&&!e.match(/^Error created at/)},this);return r(i,function(r){var t,n=r.split("@"),o=this.extractLocation(n.pop()),i=n.shift()||"",a=i.replace(/<anonymous function(: (\w+))?>/,"$2").replace(/\([^\)]*\)/g,"")||void 0;i.match(/\(([^\)]*)\)/)&&(t=i.replace(/^[^\(]+\(([^\)]*)\)$/,"$1"));var s=void 0===t||"[arguments not available]"===t?void 0:t.split(",");return new e(a,s,o[0],o[1],o[2],r)},this)}}})},function(e,r,t){var n,o,i;!function(t,a){"use strict";o=[],n=a,i="function"==typeof n?n.apply(r,o):n,!(void 0!==i&&(e.exports=i))}(this,function(){"use strict";function e(e){return!isNaN(parseFloat(e))&&isFinite(e)}function r(e,r,t,n,o,i){void 0!==e&&this.setFunctionName(e),void 0!==r&&this.setArgs(r),void 0!==t&&this.setFileName(t),void 0!==n&&this.setLineNumber(n),void 0!==o&&this.setColumnNumber(o),void 0!==i&&this.setSource(i)}return r.prototype={getFunctionName:function(){return this.functionName},setFunctionName:function(e){this.functionName=String(e)},getArgs:function(){return this.args},setArgs:function(e){if("[object Array]"!==Object.prototype.toString.call(e))throw new TypeError("Args must be an Array");this.args=e},getFileName:function(){return this.fileName},setFileName:function(e){this.fileName=String(e)},getLineNumber:function(){return this.lineNumber},setLineNumber:function(r){if(!e(r))throw new TypeError("Line Number must be a Number");this.lineNumber=Number(r)},getColumnNumber:function(){return this.columnNumber},setColumnNumber:function(r){if(!e(r))throw new TypeError("Column Number must be a Number");this.columnNumber=Number(r)},getSource:function(){return this.source},setSource:function(e){this.source=String(e)},toString:function(){var r=this.getFunctionName()||"{anonymous}",t="("+(this.getArgs()||[]).join(",")+")",n=this.getFileName()?"@"+this.getFileName():"",o=e(this.getLineNumber())?":"+this.getLineNumber():"",i=e(this.getColumnNumber())?":"+this.getColumnNumber():"";return r+t+n+o+i}},r})},function(e,r,t){"use strict";function n(e){return{}.toString.call(e).match(/\s([a-zA-Z]+)/)[1].toLowerCase()}function o(e,r){return n(e)===r}function i(e){if(!o(e,"string"))throw new Error("received invalid input");for(var r=l,t=r.parser[r.strictMode?"strict":"loose"].exec(e),n={},i=14;i--;)n[r.key[i]]=t[i]||"";return n[r.q.name]={},n[r.key[12]].replace(r.q.parser,function(e,t,o){t&&(n[r.q.name][t]=o)}),n}function a(e){var r=i(e);return""===r.anchor&&(r.source=r.source.replace("#","")),e=r.source.replace("?"+r.query,"")}function s(e,r){var t,n,i,a=o(e,"object"),u=o(e,"array"),c=[];if(a)for(t in e)e.hasOwnProperty(t)&&c.push(t);else if(u)for(i=0;i<e.length;++i)c.push(i);for(i=0;i<c.length;++i)t=c[i],n=e[t],a=o(n,"object"),u=o(n,"array"),a||u?e[t]=s(n,r):e[t]=r(t,n);return e}function u(e){return e=String(e),new Array(e.length+1).join("*")}function c(){var e=(new Date).getTime(),r="xxxxxxxx-xxxx-4xxx-yxxx-xxxxxxxxxxxx".replace(/[xy]/g,function(r){var t=(e+16*Math.random())%16|0;return e=Math.floor(e/16),("x"===r?t:7&t|8).toString(16)});return r}t(9);var l={strictMode:!1,key:["source","protocol","authority","userInfo","user","password","host","port","relative","path","directory","file","query","anchor"],q:{name:"queryKey",parser:/(?:^|&)([^&=]*)=?([^&]*)/g},parser:{strict:/^(?:([^:\/?#]+):)?(?:\/\/((?:(([^:@]*)(?::([^:@]*))?)?@)?([^:\/?#]*)(?::(\d*))?))?((((?:[^?#\/]*\/)*)([^?#]*))(?:\?([^#]*))?(?:#(.*))?)/,loose:/^(?:(?![^:@]+:[^:@\/]*@)([^:\/?#.]+):)?(?:\/\/)?((?:(([^:@]*)(?::([^:@]*))?)?@)?([^:\/?#]*)(?::(\d*))?)(((\/(?:[^?#](?![^?#\/]*\.[^?#\/.]+(?:[?#]|$)))*\/?)?([^?#\/]*))(?:\?([^#]*))?(?:#(.*))?)/}},p={isType:o,parseUri:i,parseUriOptions:l,redact:u,sanitizeUrl:a,traverse:s,typeName:n,uuid4:c};e.exports=p},function(e,r){!function(e){"use strict";e.console=e.console||{};for(var r,t,n=e.console,o={},i=function(){},a="memory".split(","),s="assert,clear,count,debug,dir,dirxml,error,exception,group,groupCollapsed,groupEnd,info,log,markTimeline,profile,profiles,profileEnd,show,table,time,timeEnd,timeline,timelineEnd,timeStamp,trace,warn".split(",");r=a.pop();)n[r]||(n[r]=o);for(;t=s.pop();)n[t]||(n[t]=i)}("undefined"==typeof window?this:window)},function(e,r,t){"use strict";function n(e){a=e}function o(e){this.name="Connection Error",this.message=e,this.stack=(new Error).stack}var i=t(8),a=null;o.prototype=Object.create(Error.prototype),o.prototype.constructor=o;var s={XMLHttpFactories:[function(){return new XMLHttpRequest},function(){return new ActiveXObject("Msxml2.XMLHTTP")},function(){return new ActiveXObject("Msxml3.XMLHTTP")},function(){return new ActiveXObject("Microsoft.XMLHTTP")}],createXMLHTTPObject:function(){var e,r=!1,t=s.XMLHttpFactories,n=t.length;for(e=0;e<n;e++)try{r=t[e]();break}catch(o){}return r},post:function(e,r,t,n){if(!i.isType(t,"object"))throw new Error("Expected an object to POST");t=a.stringify(t),n=n||function(){};var u=s.createXMLHTTPObject();if(u)try{try{var c=function(){try{if(c&&4===u.readyState){c=void 0;var e=a.parse(u.responseText);200===u.status?n(null,e):i.isType(u.status,"number")&&u.status>=400&&u.status<600?(403==u.status&&console.error("[Rollbar]:"+e.message),n(new Error(String(u.status)))):n(new o("XHR response had no status code (likely connection failure)"))}}catch(r){var t;t=r&&r.stack?r:new Error(r),n(t)}};u.open("POST",e,!0),u.setRequestHeader&&(u.setRequestHeader("Content-Type","application/json"),u.setRequestHeader("X-Rollbar-Access-Token",r)),u.onreadystatechange=c,u.send(t)}catch(l){if("undefined"!=typeof XDomainRequest){"http:"===window.location.href.substring(0,5)&&"https"===e.substring(0,5)&&(e="http"+e.substring(5));var p=function(){n(new o("Request timed out"))},f=function(){n(new Error("Error during request"))},d=function(){n(null,a.parse(u.responseText))};u=new XDomainRequest,u.onprogress=function(){},u.ontimeout=p,u.onerror=f,u.onload=d,u.open("POST",e,!0),u.send(t)}}}catch(h){n(h)}}};e.exports={XHR:s,setupJSON:n,ConnectionError:o}}])});
},{}],70:[function(require,module,exports){
'use strict';
var ko = require('./herocalc_knockout');
    
var my = require("dota-hero-calculator-library");
var AbilityModel = require("dota-hero-calculator-library/src/herocalc/AbilityModel");
var BasicInventoryViewModel = require("dota-hero-calculator-library/src/herocalc/inventory/BasicInventoryViewModel");
var union = require("dota-hero-calculator-library/src/herocalc/util/union");

var inventoryClipBoard = {
    items: [],
    activeItems: []
};

var GraphPropertyOption = function (id, label) {
    this.id = id;
    this.label = label;
};

AbilityModel.prototype.isQWER = function (ability) {
    return (ability.displayname != 'Empty' &&  (ability.behavior.indexOf('DOTA_ABILITY_BEHAVIOR_HIDDEN') == -1 || ability.name.indexOf('invoker_') != -1) && ability.behavior.indexOf('DOTA_ABILITY_BEHAVIOR_NOT_LEARNABLE') == -1)
}

var BuildExplorerViewModel = function (h) {
var self = this;
    self.parent = h;

    self.itemBuild = ko.observableArray([]);
    self.skillBuild = ko.observableArray([]);
    self.graphDataItemRows = [];
    for (var i = 0; i < 25; i++) {
        self.itemBuild.push(new BasicInventoryViewModel());
        self.itemBuild()[i].carryOver = ko.observable(true);
        self.skillBuild.push(ko.observable(-1));
        self.graphDataItemRows.push(ko.observable(false));
    }
    self.toggleItemBuildCarryOver = function (index) {
        self.itemBuild()[index].carryOver(!self.itemBuild()[index].carryOver());
    }
    
    self.abilityMapData = [0,1,2,3,4];
    self.abilityMapHero = self.parent.selectedHero().heroName;
    self.abilityMap = ko.computed(function () {
        if (self.abilityMapHero == self.parent.selectedHero().heroName) return;
        self.abilityMapHero = self.parent.selectedHero().heroName;
        var newMap = self.parent.ability().abilities().map(function(ability, index) {
            if (self.parent.ability().isQWER(ability)) {
                return index;
            }
            else {
                return -1;
            }
        }).filter(function(element) { return element != -1; });
        for (var i = 0; i < 25; i++) {
            var abilityValue = self.skillBuild()[i]();
            if (abilityValue == -1) continue;
            
            var abilityIndex = self.abilityMapData.indexOf(abilityValue);
            var newValue = newMap[abilityIndex];
            if (newValue != abilityValue) {
                self.skillBuild()[i](newValue);
            }
        }
        self.abilityMapData = newMap;
    });
    
    self.availableSkillBuildPoints = ko.computed(function () {
        return self.skillBuild().reduce(function(memo, num){ return memo + (num() == -1); }, 0);
    });
    self.getSkillBuildAbilityLevel = function (index) {
        return self.skillBuild().reduce(function(memo, num){ return memo + (num() == index); }, 0);
    };
    self.toggleAbilitySkillBuild = function (index, abilityIndex, data, event) {
        if (self.skillBuild()[index]() != abilityIndex) {
            var ability = self.parent.ability().abilities()[abilityIndex],
                abilityType = ability.abilitytype,
                skillBuildSlice = self.skillBuild().slice(0, index),
                currentAbilityLevel = self.skillBuild().reduce(function(memo, num){ return memo + (num() == abilityIndex); }, 0),
                n = skillBuildSlice.reduce(function(memo, num){ return memo + (num() == abilityIndex); }, 0);
            
            if (self.IsValidAbilityLevel(ability, self.parent.selectedHero().heroName, index + 1, n)) {
                self.skillBuild()[index](abilityIndex);
                for (var i = index + 1; i < 25; i++) {
                    if (self.skillBuild()[i]() == abilityIndex) {
                        n++;
                        if (!self.IsValidAbilityLevel(ability, self.parent.selectedHero().heroName, i + 1, n)) {
                            self.skillBuild()[i](-1);
                            n--;
                        }
                    }
                }
            }
            else if (n > 0 && self.IsValidAbilityLevel(ability, self.parent.selectedHero().heroName, index + 1, n - 1)) {
                for (var i = skillBuildSlice.length - 1; i >= 0; i--) {
                    if (skillBuildSlice[i]() == abilityIndex) {
                        self.skillBuild()[i](-1);
                        self.skillBuild()[index](abilityIndex);
                        break;
                    }
                }
            }
        }
        else {
            self.skillBuild()[index](-1);
        }
    };
    self.IsValidAbilityLevel = function (ability, heroName, heroLevel, abilityLevel) {
        var a = 1, b = 2, m = 4;
        if (ability.name == 'attribute_bonus') {
            m = 10;
        }
        else {
            if (ability.abilitytype == 'DOTA_ABILITY_TYPE_ULTIMATE') {
                if (heroName == 'invoker') {
                    a = 2;
                    b = 5;
                }
                else if (heroName == 'meepo') {
                    a = 3;
                    b = 7;
                    m = 3;
                }
                else {
                    a = 6;
                    b = 5;
                    m = 3;
                }
            }
            else {
                if (heroName == 'invoker') {
                    m = 7;
                }
            }                
        }
        
        return heroLevel >= a + b * abilityLevel && abilityLevel < m;
    }
    
    self.resetItemBuild = function (index) {
        self.itemBuild()[index].removeAll();
    };        
    self.resetAllItemBuilds = function () {
        for (var i = 0; i < 25; i++) {
            self.itemBuild()[i].removeAll();
            self.itemBuild()[i].carryOver(true);
        }
    };
    self.resetSkillBuild = function () {
        for (var i = 0; i < 25; i++) {
            self.skillBuild()[i](-1);
        }
    };
    self.graphData = ko.observableArray([]);
    self.graphDataHeader = ko.observable(self.parent.selectedHero().heroDisplayName);
    self.parent.selectedHero.subscribe(function (newValue) {
        self.graphDataHeader(self.parent.selectedHero().heroDisplayName);
    });
    self.graphDataDescription = ko.observable('');
    self.graphProperties = ko.observableArray([
        new GraphPropertyOption('totalArmorPhysical', 'Armor'),
        new GraphPropertyOption('totalArmorPhysicalReduction', 'Physical Damage Reduction'),
        new GraphPropertyOption('totalMagicResistance', 'Magical Resistance'),
        new GraphPropertyOption('health', 'Health'),
        new GraphPropertyOption('healthregen', 'Health Regeneration'),
        new GraphPropertyOption('mana', 'Mana'),
        new GraphPropertyOption('manaregen', 'Mana Regeneration'),
        new GraphPropertyOption('ehpPhysical', 'EHP Physical'),
        new GraphPropertyOption('ehpMagical', 'EHP Magical'),
        new GraphPropertyOption('damage', 'Damage per attack'),
        new GraphPropertyOption('dps', 'Damage per second'),
        new GraphPropertyOption('attacksPerSecond', 'Attacks per second'),
        new GraphPropertyOption('attackTime', 'Time per attack')
    ]);
    self.graph = function() {
        var savedAbilityLevels = [],
            savedLevel = self.parent.selectedHeroLevel(),
            savedItems = self.parent.inventory.items(),
            savedActiveItems = self.parent.inventory.activeItems(),
            s = ko.toJS(self.skillBuild),
            carryOverItems = [],
            carryOverActiveItems = [],
            dataset = [];
        for (var i = 0; i < self.parent.ability().abilities().length; i++) {
            savedAbilityLevels.push(self.parent.ability().abilities()[i].level());
        }
        for (var i = 1; i < 26; i++) {
            self.parent.selectedHeroLevel(i);
            var skillBuildSubset = s.slice(0, i);
            for (var j = 0; j < self.parent.ability().abilities().length; j++) {
                var a = self.parent.ability().abilities()[j],
                    count = skillBuildSubset.reduce(function(memo, num) {
                        return memo + (num == j);
                    }, 0);
                a.level(count);
            }

            if (!self.itemBuild()[i - 1].carryOver()) {
                carryOverItems = [];
                carryOverActiveItems = [];
            }
            carryOverItems = carryOverItems.concat(self.itemBuild()[i - 1].items());
            carryOverActiveItems = carryOverActiveItems.concat(self.itemBuild()[i - 1].activeItems());

            self.parent.inventory.items(carryOverItems);
            self.parent.inventory.activeItems(carryOverActiveItems);
            var dataObj = {};
            for (var j = 0; j < self.graphProperties().length; j++) {
                var prop = self.graphProperties()[j];
                switch (prop.id) {
                    case 'dps':
                        dataObj[prop.id] = self.parent['damageTotalInfo']().totalRow[2]().toFixed(2);
                        break;
                    case 'damage':
                        dataObj[prop.id] = self.parent['damageTotalInfo']().totalRow[0]().toFixed(2);
                        break;
                    default:
                        dataObj[prop.id] = self.parent[prop.id]();
                        break;
                }
            }

            dataObj.items = carryOverItems.map(function(item) {
                return ko.toJS(item);
            });
            dataset.push(dataObj);
            if (carryOverItems > 0) {
                self.graphDataItemRows[i - 1](true);
            }
        }
        var data = {
            header: self.graphDataHeader(),
            description: self.graphDataDescription(),
            items: self.parent.inventory.items().map(function(item) {
                return ko.toJS(item);
            }),
            skillBuild: ko.toJS(self.skillBuild),
            data: dataset,
            abilityMap: self.abilityMapData.slice(0),
            cumulativeSkillBuild: [],
            visible: ko.observable(true)
        }
        for (var i = 0; i < 25; i++) {
            var skillBuildAtLevel = [],
                skillBuildSlice = data.skillBuild.slice(0, i + 1);
            for (var j = 0; j < data.abilityMap.length; j++) {
                var abilityIndex = data.abilityMap[j];
                skillBuildAtLevel.push(skillBuildSlice.reduce(function(memo, num) {
                    return memo + (num == abilityIndex);
                }, 0));
            }
            data.cumulativeSkillBuild.push(skillBuildAtLevel);
        }

        self.graphData.push(data);
        self.parent.selectedHeroLevel(savedLevel);
        for (var i = 0; i < self.parent.ability().abilities().length; i++) {
            self.parent.ability().abilities()[i].level(savedAbilityLevels[i]);
        }
        self.parent.inventory.items(savedItems);
        self.parent.inventory.activeItems(savedActiveItems);
    };
    self.removeGraphDataSet = function (data) {
        self.graphData.remove(data);
    }
    self.selectedGraphProperty = ko.observable(self.graphProperties()[0].id);
    
    self.graphChartOptions = ko.computed(function () {
        var color = 'rgb(151, 154, 162)';
        return {
            responsive: true,
            datasetStroke: false,
            datasetStrokeWidth: -1,
            datasetFill: false,
            pointHitDetectionRadius : 10,
            scaleFontColor: color,
            scaleLineColor: color.replace('rgb', 'rgba').replace(')', ', .1)'),
            scaleGridLineColor: color.replace('rgb', 'rgba').replace(')', ', .1)')
        }
    });
    self.graphChartData = ko.computed(function () {
        var data = {
            labels: [],
            datasets: []
        }
        for (var i = 0; i < 25; i++) {
            data.labels.push((i+1).toString());
        }
        for (var i = 0; i < self.graphData().length; i++) {
            var dataObj = self.graphData()[i],
                dataset = {
                    label: dataObj.header,
                    fillColor: self.graphDistinctColor(self.graphData().length, i, .1),
                    strokeColor: self.graphDistinctColor(self.graphData().length, i, 1),
                    pointColor: self.graphDistinctColor(self.graphData().length, i, 1),
                    pointStrokeColor: self.graphDistinctColor(self.graphData().length, i, 1),
                    pointHighlightFill: self.graphDistinctColor(self.graphData().length, i, .1),
                    pointHighlightStroke: self.graphDistinctColor(self.graphData().length, i, .5),
                    data: dataObj.data.map(function (o) {
                        return o[self.selectedGraphProperty()]
                    })
                };
            data.datasets.push(dataset);
        }
        return data;
    });
    self.graphDistinctColor = function (max, index, alpha) {
        var alpha = alpha || 1,
            rgba = self.hslToRgb((1 / max) * index % 1, 1, .5);
        rgba.push(alpha);
        return "rgba(" + rgba.join() + ")";
    }
    self.getDistinctColor = function (max, index, alpha) {
        var alpha = alpha || 1;
        rgba = self.hslToRgb((1 / max) * index % 1, 1, .5);
        rgba.push(alpha);
        return rgba;
    }
    self.hslToRgb = function(h, s, l) {
        var r, g, b;
        if (s == 0) {
            r = g = b = l; // achromatic
        }
        else {
            var hue2rgb = function hue2rgb(p, q, t) {
                if (t < 0) t += 1;
                if (t > 1) t -= 1;
                if (t < 1 / 6) return p + (q - p) * 6 * t;
                if (t < 1 / 2) return q;
                if (t < 2 / 3) return p + (q - p) * (2 / 3 - t) * 6;
                return p;
            }

            var q = l < 0.5 ? l * (1 + s) : l + s - l * s;
            var p = 2 * l - q;
            r = hue2rgb(p, q, h + 1 / 3);
            g = hue2rgb(p, q, h);
            b = hue2rgb(p, q, h - 1 / 3);
        }

        return [Math.round(r * 255), Math.round(g * 255), Math.round(b * 255)];
    }
    
    self.showGraphItemBuildRows = ko.observable(false);
    self.showGraphSkillBuildColumns = ko.observable(false);
    self.graphRowHasItems = function (index) {
        return self.graphData().some(function (dataset) {
            return dataset.visible() && dataset.data[index].items.length > 0;
        });
    }

    self.selectInventory = function (index) {
        self.parent.selectedInventory(self.parent.selectedInventory() == index ? -1 : index);
    }
    self.getSelectedInventory = ko.pureComputed(function () {
        if (self.parent.selectedInventory() == -1) {
            return self.parent.inventory;
        }
        else {
            return self.itemBuild()[self.parent.selectedInventory()];
        }
    });
    self.copyInventory = function (index) {
        if (self.parent.selectedInventory() != -1 && self.parent.selectedInventory() != index) {
            self.itemBuild()[self.parent.selectedInventory()].items(self.itemBuild()[self.parent.selectedInventory()].items().concat(self.itemBuild()[index].items()));
            self.itemBuild()[self.parent.selectedInventory()].activeItems(union(self.itemBuild()[self.parent.selectedInventory()].activeItems(), self.itemBuild()[index].activeItems()));
        }
    }
    self.copyInventoryToClipBoard = function (index) {
        if (index == -1) {
            inventoryClipBoard.items = self.parent.inventory.items.slice(0);
            inventoryClipBoard.activeItems = self.parent.inventory.activeItems.slice(0);            
        }
        else {
            inventoryClipBoard.items = self.itemBuild()[index].items.slice(0);
            inventoryClipBoard.activeItems = self.itemBuild()[index].activeItems.slice(0);
        }
    }
    self.pasteInventoryFromClipBoard = function (index) {
        if (inventoryClipBoard.items.length > 0) {
            if (index == -1) {
                self.parent.inventory.items(self.parent.inventory.items().concat(inventoryClipBoard.items));
                self.parent.inventory.activeItems(union(self.parent.inventory.activeItems(), inventoryClipBoard.activeItems));    
            }
            else {
                self.itemBuild()[index].items(self.itemBuild()[index].items().concat(inventoryClipBoard.items));
                self.itemBuild()[index].activeItems(union(self.itemBuild()[index].activeItems(), inventoryClipBoard.activeItems));
            }
        }
    }
    self.loadGraphData = function (data) {
        self.parent.sectionDisplay()['skillbuild'](true);
        for (var i = 0; i < data.length; i++) {
            data[i].visible = ko.observable(data[i].visible);
        }
        self.graphData(data);
    }
    self.graphChartContext = ko.observable();
    self.exportImage = function () {
        var w = window.open();
        w.document.write('<img src="'+ self.graphChartContext().canvas.toDataURL() +'"/>');
    }
    return self;
}

module.exports = BuildExplorerViewModel;
},{"./herocalc_knockout":79,"dota-hero-calculator-library":35,"dota-hero-calculator-library/src/herocalc/AbilityModel":1,"dota-hero-calculator-library/src/herocalc/inventory/BasicInventoryViewModel":25,"dota-hero-calculator-library/src/herocalc/util/union":41}],71:[function(require,module,exports){
(function (global){
"use strict";
var ko = (typeof window !== "undefined" ? window['ko'] : typeof global !== "undefined" ? global['ko'] : null);
var HeroCalc = require("dota-hero-calculator-library");
var DamageAmpViewModel = require("./DamageAmpViewModel");
var HeroDamageAmpMixin = require("./HeroDamageAmpMixin");

var CloneViewModel = function (heroData, itemData, unitData, h, p) {
    var self = this;
    HeroCalc.CloneModel.call(this, heroData, itemData, h, p);
    self.bound = ko.observable(false);
    
    self.sectionDisplay = ko.observable({
        'inventory': ko.observable(true),
        'ability': ko.observable(true),
        'buff': ko.observable(true),
        'debuff': ko.observable(true),
        'damageamp': ko.observable(false),
        'illusion': ko.observable(false),
        'skillbuild': ko.observable(false),
        'skillbuild-skills': ko.observable(true),
        'skillbuild-items': ko.observable(true)
    });
    self.sectionDisplayToggle = function (section) {
        self.sectionDisplay()[section](!self.sectionDisplay()[section]());
    }
    self.showUnitTab = ko.observable(false);
    self.showDiff = ko.observable(false);
    self.showCriticalStrikeDetails = ko.observable(false);
    self.showDamageDetails = ko.observable(false);
    self.showStatDetails = ko.observable(false);
    self.showDamageAmpCalcDetails = ko.observable(false);
    
    self.damageAmplification = new DamageAmpViewModel(heroData, itemData, unitData);
    self.damageReduction = new DamageAmpViewModel(heroData, itemData, unitData);
    HeroDamageAmpMixin(self);
}
CloneViewModel.prototype = Object.create(HeroCalc.CloneModel.prototype);
CloneViewModel.prototype.constructor = CloneViewModel;

module.exports = CloneViewModel;
}).call(this,typeof global !== "undefined" ? global : typeof self !== "undefined" ? self : typeof window !== "undefined" ? window : {})

},{"./DamageAmpViewModel":72,"./HeroDamageAmpMixin":74,"dota-hero-calculator-library":35}],72:[function(require,module,exports){
'use strict';
var ko = require('./herocalc_knockout');

var BuffViewModel = require("dota-hero-calculator-library/src/herocalc/BuffViewModel");
var BuffModel = require("dota-hero-calculator-library/src/herocalc/buffs/BuffModel");
var findWhere = require("dota-hero-calculator-library/src/herocalc/util/findWhere");

var DamageAmpViewModel = function (heroData, itemData, unitData, a) {
    var self = this;
    BuffViewModel.call(this, itemData, ko.observableArray([]));
    self.availableBuffs = ko.observableArray([
        new BuffModel(heroData, unitData, 'slardar', 'slardar_sprint'),
        new BuffModel(heroData, unitData, 'undying', 'undying_flesh_golem'),
        new BuffModel(heroData, unitData, 'chen', 'chen_penitence'),
        new BuffModel(heroData, unitData, 'medusa', 'medusa_stone_gaze'),
        new BuffModel(heroData, unitData, 'shadow_demon', 'shadow_demon_soul_catcher')
    ]);
    self.availableDebuffs = ko.observableArray([
        new BuffModel(heroData, unitData, 'medusa', 'medusa_mana_shield'),
        //new BuffModel(heroData, unitData, 'templar_assassin', 'templar_assassin_refraction'),
        //new BuffModel(heroData, unitData, 'faceless_void', 'faceless_void_backtrack'),
        //new BuffModel(heroData, unitData, 'nyx_assassin', 'nyx_assassin_spiked_carapace'),
        new BuffModel(heroData, unitData, 'spectre', 'spectre_dispersion'),
        new BuffModel(heroData, unitData, 'wisp', 'wisp_overcharge'),
        new BuffModel(heroData, unitData, 'bristleback', 'bristleback_bristleback'),
        //new BuffModel(heroData, unitData, 'abaddon', 'abaddon_borrowed_time'),
        //new BuffModel(heroData, unitData, 'abaddon', 'abaddon_aphotic_shield'),
        //new BuffModel(heroData, unitData, 'dazzle', 'dazzle_shallow_grave'),
        //new BuffModel(heroData, unitData, 'treant', 'treant_living_armor'),
        new BuffModel(heroData, unitData, 'kunkka', 'kunkka_ghostship')
    ]);
    self.selectedBuff = ko.observable(self.availableBuffs()[0]);
    
    self.buffs = ko.observableArray([]);

    self.getAbilityDamageAmpValue = function (abilityName, attributeName) {
        var a = findWhere(self.buffs(), {name: abilityName});
        if (a == undefined) {
            return 0;
        }
        else {
            var ability = a.data;
            return self.getAbilityAttributeValue(ability.attributes, attributeName, ability.level());
        }
    }
    
    self.getDamageMultiplierSources = ko.computed(function () {
        var sources = {};
        for (var i = 0; i < self.abilities().length; i++) {
            var ability = self.abilities()[i];
                if (ability.level() > 0 && (ability.isActive() || (ability.behavior.indexOf('DOTA_ABILITY_BEHAVIOR_PASSIVE') != -1))) {
                    switch (ability.name) {
                        case 'bristleback_bristleback':
                            sources[ability.name] = {
                                'multiplier': ability.damageReduction() / 100,
                                'damageType': 'physical',
                                'displayname': ability.displayname
                            }
                        break;
                        case 'slardar_sprint':
                            sources[ability.name] = {
                                'multiplier': self.getAbilityAttributeValue(ability.attributes, 'bonus_damage', ability.level()) / 100,
                                'damageType': 'physical',
                                'displayname': ability.displayname
                            }
                        break;
                        case 'undying_flesh_golem':
                            sources[ability.name] = {
                                'multiplier': ability.damageAmplification() / 100,
                                'damageType': 'physical',
                                'displayname': ability.displayname
                            }
                        break;
                        case 'medusa_stone_gaze':
                            sources[ability.name] = {
                                'multiplier': self.getAbilityAttributeValue(ability.attributes, 'bonus_physical_damage', ability.level()) / 100,
                                'damageType': 'physical',
                                'displayname': ability.displayname
                            }
                        break;
                        case 'chen_penitence':
                            sources[ability.name] = {
                                'multiplier': self.getAbilityAttributeValue(ability.attributes, 'bonus_damage_taken', ability.level()) / 100,
                                'damageType': 'physical',
                                'displayname': ability.displayname
                            }
                        break;
                        case 'shadow_demon_soul_catcher':
                            sources[ability.name] = {
                                'multiplier': self.getAbilityAttributeValue(ability.attributes, 'bonus_damage_taken', ability.level()) / 100,
                                'damageType': 'pure',
                                'displayname': ability.displayname
                            }
                        break;
                        case 'medusa_mana_shield':
                            sources[ability.name] = {
                                'multiplier': ability.damageReduction() / 100,
                                'damageType': 'physical',
                                'displayname': ability.displayname
                            }                            
                        break;
                        case 'spectre_dispersion':
                            sources[ability.name] = {
                                'multiplier': -self.getAbilityAttributeValue(ability.attributes, 'damage_reflection_pct', ability.level()) / 100,
                                'damageType': 'percentreduction',
                                'displayname': ability.displayname
                            }                                
                        break;
                        case 'abaddon_aphotic_shield':
                            sources[ability.name] = {
                                'multiplier': self.getAbilityAttributeValue(ability.attributes, 'damage_absorb', ability.level()),
                                'damageType': 'flatreduction',
                                'displayname': ability.displayname
                            }                                
                        break;
                        case 'kunkka_ghostship':
                            sources[ability.name] = {
                                'multiplier': -50 / 100,
                                'damageType': 'percentreduction',
                                'displayname': ability.displayname
                            }                                
                        break;
                        case 'wisp_overcharge':
                            sources[ability.name] = {
                                'multiplier': self.getAbilityAttributeValue(ability.attributes, 'bonus_damage_pct', ability.level()) / 100,
                                'damageType': 'percentreduction',
                                'displayname': ability.displayname
                            }                                
                        break;
                        /*case 'faceless_void_backtrack':
                            sources[ability.name] = {
                                'multiplier': -self.getAbilityAttributeValue(ability.attributes, 'dodge_chance_pct', ability.level()) / 100,
                                'damageType': 'percentreduction',
                                'displayname': ability.displayname
                            }                                
                        break;*/
                    }
                }
        }
        return sources;
    });
    
    return self;
}
DamageAmpViewModel.prototype = Object.create(BuffViewModel.prototype);
DamageAmpViewModel.prototype.constructor = DamageAmpViewModel;

module.exports = DamageAmpViewModel;
},{"./herocalc_knockout":79,"dota-hero-calculator-library/src/herocalc/BuffViewModel":2,"dota-hero-calculator-library/src/herocalc/buffs/BuffModel":3,"dota-hero-calculator-library/src/herocalc/util/findWhere":37}],73:[function(require,module,exports){
(function (global){
'use strict';
var ko = require('./herocalc_knockout');
var $ = (typeof window !== "undefined" ? window['$'] : typeof global !== "undefined" ? global['$'] : null);
require('./jquery-ui.custom');

ko.components.register('hero-pane', { template: "<div class=\"row\">\n    <div class=\"col-md-3 col-sm-6\">\n        <img class=\"img-rounded hero-image\" data-bind=\"attr:{src: '/media/images/heroes/' + selectedHero().heroName + '.png'}\"/>\n    </div>\n    <div class=\"col-md-9 col-sm-6\">\n        <div class=\"row form-group\">\n            <div class=\"col-md-6\">\n                <label for=\"heroselect\">Hero</label>\n                <select id=\"heroselect\" class=\"form-control\" data-bind=\"options: availableHeroes , optionsText: 'heroDisplayName', value: selectedHero\"></select>\n            </div>\n            <div class=\"col-md-6\">\n                <label for=\"herolevel\">Level</label>\n                <input id=\"herolevel\" data-bind=\"spinner: selectedHeroLevel, spinnerOptions: { min: 1, max: 25 }\">\n            </div>\n        </div>\n        <div class=\"row\">\n            <div class=\"col-md-6\">\n                <label for=\"enemyselect\">Enemy</label>\n                <select id=\"enemyselect\" class=\"form-control\" data-bind=\"css: enemy().playerColorCss, options: availableEnemies , optionsText: 'heroDisplayName', value: selectedEnemy, optionsAfterRender: setHeroOptionStyling\"></select>\n            </div>\n            <div class=\"col-md-6\">\n                <label for=\"enemyselect\">Compare to</label>\n                <select id=\"enemyselect\" class=\"form-control\" data-bind=\"css: heroCompare().playerColorCss, options: availableCompare , optionsText: 'heroDisplayName', value: selectedCompare, optionsAfterRender: setHeroOptionStyling\"></select>\n            </div>\n            <div class=\"col-md-12 checkbox\" style=\"margin-bottom:0px;padding-left:34px;\" data-bind=\"visible: $root.layout() == 0\">\n                <label><input type=\"checkbox\" style=\"float:none;margin-right:5px;\" data-bind=\"checked: showDiff\"><span style=\"font-size:12px\">Show <abbr title=\"The difference between two adjacent hero tabs shown next to each stat.\">delta values</abbr>. <span data-bind=\"visible: showDiff\">Comparing level <span data-bind=\"text: selectedHeroLevel\"></span> <span data-bind=\"text: heroData().displayname, css: playerColorCss\"></span> to level <span data-bind=\"text: heroCompare().selectedHeroLevel\"></span> <span data-bind=\"text: heroCompare().heroData().displayname, css: heroCompare().playerColorCss\"></span>.</span></span></label>\n                <label style=\"margin-left:25px;font-size:12px;\"><input type=\"checkbox\" style=\"float:none;margin-right:5px;\" data-bind=\"checked: showUnitTab\">Show unit tab</label>\n            </div>\n        </div>\n    </div>\n</div>\n\n<div class=\"row\">\n    <div class=\"col-md-4\" data-bind=\"css: {'col-md-4': $root.layout() == 0, 'col-md-12': $root.layout() == 1}\">\n        <div class=\"row\">\n            <h3 class=\"col-md-12\">Stats <a class=\"btn btn-default btn-xs\" data-bind=\"toggle: showStatDetails, text: !showStatDetails() ? 'Show more' : 'Show less', attr: {title: !showStatDetails() ? 'Click to show base stats' : 'Click to hide base stats'}\"></a>\n                <div style=\"margin-left:15px;display:inline;\" data-bind=\"style: {'display': $root.layout() == 1 ? 'inline' : 'none'}\">\n                    <label><input type=\"checkbox\" style=\"float:none;margin-right:5px;\" data-bind=\"checked: showDiff\"><span style=\"font-size:12px\">Show <abbr title=\"The difference between two adjacent hero tabs shown next to each stat.\">delta values</abbr>. <span data-bind=\"visible: showDiff\">Comparing level <span data-bind=\"text: selectedHeroLevel\"></span> <span data-bind=\"text: heroData().displayname, css: playerColorCss\"></span> to level <span data-bind=\"text: heroCompare().selectedHeroLevel\"></span> <span data-bind=\"text: heroCompare().heroData().displayname, css: heroCompare().playerColorCss\"></span>.</span></span></label>\n                    <label style=\"margin-left:25px;font-size:12px;\"><input type=\"checkbox\" style=\"float:none;margin-right:5px;\" data-bind=\"checked: showUnitTab\">Show unit tab</label>\n                </div>\n            </h3>\n\n            <div class=\"col-md-12\" data-bind=\"visible: showStatDetails(), css: {'col-md-12': $root.layout() == 0, 'col-md-3': $root.layout() == 1}, component: {name: 'stats-additional', params: $data}\"></div>\n\n            <div class=\"statscontainer\" data-bind=\"foreach: $root.allItems\">\n                <div data-bind=\"component: { name: $data.value, params: $parentContext.$data}\"></div>\n            </div>\n        </div>\n    </div>\n    <div class=\"col-md-8\" data-bind=\"css: {'col-md-8': $root.layout() == 0, 'col-md-12': $root.layout() == 1}\">\n        <div data-bind=\"component: { name: 'damage-details', params: $data}\"></div>\n    \n        <div class=\"row\">\n            <div class=\"col-md-12\" data-bind=\"itemBuildTable: $data.buildExplorer\">\n                <h3 class=\"section_header\" data-bind=\"toggle: sectionDisplay().inventory, css: { section_disabled: !sectionDisplay().inventory() }\">Inventory <small style=\"color:goldenrod\" data-bind=\"html: inventory.totalCost() ? '<img src=\\'http://cdn.dota2.com/apps/dota2/images/tooltips/gold.png\\'/> ' + inventory.totalCost() : '' \"></small></h3>\n                <div id=\"inventory\" class=\"inventory hover-cursor\" data-bind=\"click: function (data, event) { buildExplorer.selectInventory(-1); }, css: {'row-highlight': selectedInventory() == -1}, template: { name: 'item-template', foreach: inventory.items }, visible: sectionDisplay().inventory()\"></div>\n            </div>\n        </div>\n        \n        <div class=\"row\">\n            <div class=\"col-md-12\">\n                <h3 class=\"section_header\" data-bind=\"toggle: sectionDisplay().ability, css: { section_disabled: !sectionDisplay().ability() }\">Abilities <small style=\"color:inherit\" data-bind=\"text: availableSkillPoints() ? (availableSkillPoints() == 1 ? '1 unspent skillpoint' : availableSkillPoints() + ' unspent skillpoints') : ''\"></small></h3>\n                <div class=\"row\" data-bind=\"visible: sectionDisplay().ability(), foreach: ability().abilities()\">\n                    <div data-bind=\"component: { name: 'ability', params: $data }\"></div>\n                </div>\n                <div class=\"form-horizontal\" data-bind=\"if: selectedHero().heroName == 'silencer', visible: sectionDisplay().ability()\">\n                    <div class=\"form-group\">\n                            <div class=\"col-md-2 control-label\">\n                                <label for=\"intelligencestolen\">Intelligence Stolen</label>\n                            </div>\n                            <div class=\"col-md-2\">\n                                <input class=\"form-control\" id=\"intelligencestolen\" data-bind=\"value: intStolen\" />\n                            </div>\n                    </div>\n                </div>\n            </div>\n        </div>\n\n        <div data-bind=\"component: { name: 'talent-section', params: $data}\"></div>\n        \n        <div data-bind=\"component: { name: 'buff-section', params: $data}\"></div>\n        \n        <div class=\"row\" data-bind=\"component: { name: 'damage-amp', params: $data}\"></div>\n\n        <div class=\"row\">\n            <div class=\"col-md-12\">\n                <h3 class=\"section_header\" data-bind=\"toggle: sectionDisplay().illusion, css: { section_disabled: !sectionDisplay().illusion() }\">Illusions</h3>\n                <div data-bind=\"visible: sectionDisplay().illusion(), lazyBinding: sectionDisplay().illusion\">\n                    <h4 style=\"color:red\">Under Construction</h4>\n                    <div class=\"form-horizontal\">\n                        <div class=\"form-group\">\n                                <div class=\"col-md-2 control-label\">\n                                    <label for=\"illusionSelect\">Type</label>\n                                </div>\n                                <div class=\"col-md-10\">\n                                    <select id=\"illusionSelect\" class=\"form-control\" data-bind=\"options: availableIllusions , optionsText: 'illusionDisplayName', value: selectedIllusion\"></select>\n                                </div>\n                        </div>\n                        <div class=\"form-group\">\n                                <div class=\"col-md-2 control-label\">\n                                    <label for=\"illusionabilitylevel\">Ability Level</label>\n                                </div>\n                                <div class=\"col-md-10\">\n                                    <select id=\"illusionabilitylevel\" class=\"form-control\" data-bind=\"value: illusionAbilityLevel, foreach: new Array(illusionAbilityMaxLevel())\">\n                                        <option data-bind=\"text: $index()+1\"></option>\n                                    </select>\n                                </div>\n                        </div>\n                        <div class=\"form-group\">\n                            <div class=\"col-md-offset-2 col-md-10\">\n                                <button class=\"btn btn-default\" data-bind=\"click: addIllusion\">Add Illusion</button>\n                            </div>\n                        </div>\n                    </div>\n                </div>\n            </div>\n        </div>\n    </div>\n    \n    <div class=\"col-md-12\">\n        <h3 class=\"section_header\" data-bind=\"toggle: sectionDisplay().skillbuild, css: { section_disabled: !sectionDisplay().skillbuild() }\">Build Explorer</h3>\n        <div data-bind=\"visible: sectionDisplay().skillbuild(), attr: {id: 'section-build-explorer-' + index() }, lazyBinding: sectionDisplay().skillbuild\">\n            <div class=\"section-content\">    \n                <div class=\"col-md-12\">\n                    <h4 class=\"section_header\" data-bind=\"toggle: sectionDisplay()['skillbuild-skills'], css: { section_disabled: !sectionDisplay()['skillbuild-skills']() }\">Skill Build <small style=\"color:inherit\" data-bind=\"text: buildExplorer.availableSkillBuildPoints() ? (buildExplorer.availableSkillBuildPoints() == 1 ? '1 unspent skillpoint' : buildExplorer.availableSkillBuildPoints() + ' unspent skillpoints') : ''\"></small></h4>\n                        <div data-bind=\"visible: sectionDisplay()['skillbuild-skills']\">\n                        <table>\n                            <tbody data-bind=\"template: { name: 'ability-3-template', foreach: ability().abilities() }\"></tbody>\n                        </table>\n                        <div class=\"form-group\">\n                            <button class=\"btn btn-default\" data-bind=\"click: buildExplorer.resetSkillBuild\">Clear</button>\n                        </div>\n                    </div>\n                </div>\n                <div class=\"col-md-12\">\n                    <h4 class=\"section_header\" data-bind=\"toggle: sectionDisplay()['skillbuild-items'], css: { section_disabled: !sectionDisplay()['skillbuild-items']() }\">Item Build</h4>\n                    <div data-bind=\"visible: sectionDisplay()['skillbuild-items']\">\n                        <table class=\"table\">\n                            <thead>\n                                <tr>\n                                    <th>Level</th>\n                                    <th class=\"text-center\">Inventory</th>\n                                    <th></th>\n                                    <th></th>\n                                    <th></th>\n                                </tr>\n                            </thead>\n                            <tbody data-bind=\"foreach: new Array(25), itemBuildTable: buildExplorer\">\n                                <tr class=\"hover-cursor\" data-bind=\"css: {'row-highlight': $parent.selectedInventory() == $index()}\">\n                                    <td class=\"carry-over\" data-bind=\"click: function (data, event) { $parent.buildExplorer.selectInventory($index()); }\">\n                                        <strong data-bind=\"text: ($index() + 1)\"></strong>\n                                        <a class=\"btn btn-default btn-xs glyphicon\" data-bind=\"visible: $index() > 0, toggle: $parent.buildExplorer.itemBuild()[$index()].carryOver, preventBubble: 'click', css: { 'glyphicon-arrow-down': $parent.buildExplorer.itemBuild()[$index()].carryOver(), 'glyphicon-stop': !$parent.buildExplorer.itemBuild()[$index()].carryOver() }\" title=\"Carry over items to next level's inventory\"></a>\n                                    </td>\n                                    <td class=\"col-md-10\" data-bind=\"click: function (data, event) { $parent.buildExplorer.selectInventory($index()); }\">\n                                        <div class=\"itemBuild-inventory\" data-bind=\"template: { name: 'itemBuild-item-template', foreach: $parent.buildExplorer.itemBuild()[$index()].items }\"></div>\n                                    </td>\n                                    <td>\n                                        <a class=\"btn btn-default btn-xs\" data-bind=\"click: function (data, event) { $parent.buildExplorer.copyInventoryToClipBoard($index()); }\" title=\"Copy items\">Copy</a>\n                                    </td>\n                                    <td>\n                                        <a class=\"btn btn-default btn-xs\" data-bind=\"click: function (data, event) { $parent.buildExplorer.pasteInventoryFromClipBoard($index()); }\" title=\"Paste items\">Paste</a>\n                                    </td>\n                                    <td>\n                                        <a class=\"btn btn-default btn-xs\" data-bind=\"click: function (data, event) { $parent.buildExplorer.resetItemBuild($index()); }\" title=\"Clear inventory\">Clear</a>\n                                    </td>\n                                </tr>\n                            </tbody>\n                        </table>\n                        <div class=\"form-group\">\n                            <button class=\"btn btn-default\" data-bind=\"click: buildExplorer.resetAllItemBuilds\">Clear</button>\n                        </div>\n                    </div>\n                </div>\n                <div class=\"form-group\">\n                    <label>Data set header label</label>\n                    <input type=\"text\" class=\"form-control\" data-bind=\"value: buildExplorer.graphDataHeader\">\n                </div>\n                <div class=\"form-group\">\n                    <label>Data set description</label>\n                    <input type=\"text\" class=\"form-control\" data-bind=\"value: buildExplorer.graphDataDescription\">\n                </div>\n                <div class=\"form-group\">\n                    <button class=\"btn btn-default\" data-bind=\"click: buildExplorer.graph\">Add data set</button>\n                </div>\n                <div class=\"form-group\">\n                    <label>Hero Property</label>\n                    <select class=\"form-control\" data-bind=\"options: buildExplorer.graphProperties, optionsText: 'label', optionsValue: 'id', value: buildExplorer.selectedGraphProperty\"></select>\n                </div>\n                <!-- ko if: buildExplorer.graphData().length > 0 -->\n                <div class=\"form-group\" data-bind=\"chart: buildExplorer.graphChartData, chartType: 'Scatter', chartOptions: buildExplorer.graphChartOptions(), chartContext: buildExplorer.graphChartContext\"></div>\n                <div class=\"form-group\">\n                  <button class=\"btn btn-default\" data-bind=\"click: buildExplorer.exportImage\"><span class=\"glyphicon glyphicon-export\"></span> Export Image</button>\n                </div>\n                <button class=\"btn btn-default btn-xs\" data-bind=\"toggle: buildExplorer.showGraphItemBuildRows, css: {'toggled': buildExplorer.showGraphItemBuildRows}\">Show item build rows</button>\n                <button class=\"btn btn-default btn-xs\" data-bind=\"toggle: buildExplorer.showGraphSkillBuildColumns, css: {'toggled': buildExplorer.showGraphSkillBuildColumns}\">Show skill build columns</button>\n                <table class=\"table build-table\">\n                    <thead>\n                        <tr>\n                            <th class=\"right-border\">Level</th>\n                            <!-- ko foreach: buildExplorer.graphData -->\n                            <th class=\"text-center\" data-bind=\"css: { 'right-border': !$parent.buildExplorer.showGraphSkillBuildColumns() || !$data.visible() }\">\n                                <span data-bind=\"css: { 'tooltip-underline': $data.description }, tooltip: {title: $data.description, placement: 'bottom'}, visible: $data.visible(), text: $data.header, style: { color: $parent.buildExplorer.graphDistinctColor($parent.buildExplorer.graphData().length, $index(), 1) }\"></span>\n                                <span class=\"btn btn-xs glyphicon glyphicon-info-sign\" data-bind=\"visible: $data.visible(), popover: {template: 'popover-graphData-template', data: $data, options: {} }\"></span>\n                                <button class=\"btn btn-default btn-xs shop-button glyphicon glyphicon-remove pull-right\" class=\"close\" data-bind=\"visible: !$parent.buildExplorer.showGraphSkillBuildColumns() || !$data.visible(), click: function(data, event) { $parent.buildExplorer.removeGraphDataSet($data); }\"></button>\n                                <button class=\"btn btn-default btn-xs shop-button glyphicon pull-right\" data-bind=\"visible: !$parent.buildExplorer.showGraphSkillBuildColumns() || !$data.visible(), toggle: $data.visible, css: { 'glyphicon-minus': $data.visible(), 'glyphicon-plus': !$data.visible()}\"></button>\n                            </th>\n                            <th class=\"text-left right-border\" data-bind=\"visible: $data.visible() && $parent.buildExplorer.showGraphSkillBuildColumns()\"><abbr title=\"Q-W-E-R-Stats\">Skill Build</abbr>\n                                <button class=\"btn btn-default btn-xs shop-button glyphicon glyphicon-remove pull-right\" class=\"close\" data-bind=\"visible: $parent.buildExplorer.showGraphSkillBuildColumns(), click: function(data, event) { $parent.buildExplorer.removeGraphDataSet($data); }\"></button>\n                                <button class=\"btn btn-default btn-xs shop-button glyphicon pull-right\" data-bind=\"visible: $parent.buildExplorer.showGraphSkillBuildColumns(), toggle: $data.visible, css: { 'glyphicon-minus': $data.visible(), 'glyphicon-plus': !$data.visible()}\"></button>\n                            </th>\n                            <!-- /ko -->\n                        </tr>\n                    </thead>\n                    <tbody data-bind=\"foreach: new Array(buildExplorer.graphData()[0].data.length)\">\n                        <tr>\n                            <td class=\"right-border\">\n                                <strong data-bind=\"text: ($index() + 1)\"></strong>\n                            </td>\n                            <!-- ko foreach: new Array($parent.buildExplorer.graphData().length) -->\n                            <td class=\"text-right\" data-bind=\"css: { 'right-border': !$parents[1].buildExplorer.showGraphSkillBuildColumns() || !$parents[1].buildExplorer.graphData()[$index()].visible() }\">\n                                <span data-bind=\"visible: $parents[1].buildExplorer.graphData()[$index()].visible(), text: $parents[1].buildExplorer.graphData()[$index()].data[$parentContext.$index()][$parents[1].buildExplorer.selectedGraphProperty()]\"></span>\n                            </td>\n                            <td class=\"text-left right-border\" data-bind=\"visible: $parents[1].buildExplorer.graphData()[$index()].visible() && $parents[1].buildExplorer.showGraphSkillBuildColumns(), text: $parents[1].buildExplorer.graphData()[$index()].cumulativeSkillBuild[$parentContext.$index()].join('-')\"></td>\n                            <!-- /ko -->\n                        </tr>\n                        <tr class=\"itemBuild-inventory\" data-bind=\"visible: $parent.buildExplorer.showGraphItemBuildRows() && $parent.buildExplorer.graphRowHasItems($index())\">\n                            <td class=\"right-border-itemrow no-top-border\"></td>\n                            <!-- ko foreach: new Array($parent.buildExplorer.graphData().length) -->\n                            <td class=\"right-border-itemrow no-top-border\" data-bind=\"attr: { colspan: $parents[1].buildExplorer.graphData()[$index()].visible() && $parents[1].buildExplorer.showGraphSkillBuildColumns() ? 2 : 1 }\">\n                                <div data-bind=\"visible: $parents[1].buildExplorer.graphData()[$index()].visible(), foreach: $parents[1].buildExplorer.graphData()[$index()].data[$parentContext.$index()].items\">\n                                    <img class=\"itemBuild-img-sm img-rounded\" data-bind=\"css: { item_disabled: !enabled, item_active: $parents[2].inventory.getActiveBorder($data) == 1, item_inactive: $parents[2].inventory.getActiveBorder($data) == 0 }, attr:{ src: $parents[2].inventory.getItemImage($data) }\"/>\n                                    <div style=\"float:left\" data-bind=\"visible: $parents[2].inventory.getItemSizeLabel($data) != ''\">\n                                        <div data-bind=\"html: $parents[2].inventory.getItemSizeLabel($data)\" style=\"position:absolute;left:0;bottom:0;color:white;opacity:.5;background-color:black;padding:0px 2px\"></div>\n                                        <div data-bind=\"html: $parents[2].inventory.getItemSizeLabel($data)\" style=\"position:absolute;left:0;bottom:0;color:white;padding:0px 2px\"></div>\n                                    </div>\n                                </div>\n                            </td>\n                            <!-- /ko -->\n                        </tr>\n                    </tbody>\n                </table>\n                <!-- /ko -->\n            </div>\n        </div>\n    </div>\n\n</div>" });
ko.components.register('unit-pane', { template: "<div class=\"row\">\n    <div class=\"col-md-4\">\n        <img class=\"img-rounded\" data-bind=\"attr:{src: selectedUnit().image}\"/>\n    </div>\n    <div class=\"col-md-4\">\n        <label for=\"unitselect\">Unit</label>\n        <select id=\"unitselect\" class=\"form-control\" data-bind=\"options: availableUnits , optionsText: 'heroDisplayName', value: selectedUnit\"></select>\n    </div>\n    <div class=\"col-md-4\">\n        <label for=\"unitlevel\">Level</label>\n        <p class=\"form-control-static\" data-bind=\"visible: selectedUnit().levels == 0, text: heroData().level\"></p>\n        <select id=\"herolevel\" class=\"form-control\" data-bind=\"visible: selectedUnit().levels > 0, value: selectedUnitLevel, foreach: new Array(selectedUnit().levels)\">\n            <option data-bind=\"text: $index()+1\"></option>\n        </select>\n    </div>\n</div>\n\n<div class=\"row\">\n    <div class=\"col-md-4\" data-bind=\"css: {'col-md-4': $root.layout() == 0, 'col-md-12': $root.layout() == 1}\">\n        <div class=\"row\">\n            <h3 class=\"col-md-12\">Stats <a class=\"btn btn-default btn-xs\" data-bind=\"toggle: showStatDetails, text: !showStatDetails() ? 'Show more' : 'Show less', attr: {title: !showStatDetails() ? 'Click to show base stats' : 'Click to hide base stats'}\"></a></h3>\n\n            <div class=\"col-md-3\" data-bind=\"visible: showStatDetails(), component: {name: 'stats-additional', params: $data}\"></div>\n            \n            <div class=\"col-md-12\" data-bind=\"css: {'col-md-12': $root.layout() == 0, 'col-md-3': $root.layout() == 1}\">\n                <table class=\"table table-condensed\">\n                <tbody>\n                <tr><td>Gold:</td><td class=\"text-right\"><span data-bind=\"text: heroData().bountygoldmin == heroData().bountygoldmax ? heroData().bountygoldmax : heroData().bountygoldmin + '-' + heroData().bountygoldmax\"></span></td></tr>\n                <tr><td>Experience:</td><td class=\"text-right\"><span data-bind=\"text: heroData().bountyxp\"></span></td></tr>\n                <tr><td>Level:</td><td class=\"text-right\"><span data-bind=\"text: heroData().level\"></span></td></tr>\n                <tr><td><abbr title=\"Movement Speed\">MS</abbr>:</td><td class=\"text-right\"><span data-bind=\"text: totalMovementSpeed\"></span></td></tr>\n                <tr><td>Turn Rate:</td><td class=\"text-right\"><span data-bind=\"text: totalTurnRate\"></span></td></tr>\n                <tr><td>Sight Range:</td><td class=\"text-right\"><span data-bind=\"html: '<abbr title=\\'Day\\'>' + visionrangeday() + '</abbr>/<abbr title=\\'Night\\'>' + visionrangenight() + '</abbr>'\"></span></td></tr>\n                </tbody>\n                </table>\n            </div>\n\n\n            <div class=\"col-md-12\" data-bind=\"css: {'col-md-12': $root.layout() == 0, 'col-md-3': $root.layout() == 1}\">\n                <table class=\"table table-condensed\">\n                <tbody>\n                <tr><td>Health:</td><td class=\"text-right\"><span data-bind=\"text: health\"></span></td></tr>\n                <tr><td>Health Regen:</td><td class=\"text-right\"><span data-bind=\"text: healthregen\"></span></td></tr>\n                <tr><td>Mana:</td><td class=\"text-right\"><span data-bind=\"text: mana\"></span></td></tr>\n                <tr><td>Mana Regen:</td><td class=\"text-right\"><span data-bind=\"text: manaregen\"></span></td></tr>\n                <tr><td>Physical <abbr title=\"Effective Hit Points\">EHP</abbr>:</td><td class=\"text-right\"><span data-bind=\"text: ehpPhysical\"></span></td></tr>\n                <tr><td>Magical <abbr title=\"Effective Hit Points\">EHP</abbr>:</td><td class=\"text-right\"><span data-bind=\"text: ehpMagical\"></span></td></tr>\n                </tbody>\n                </table>\n            </div>\n\n            <div class=\"col-md-12\" data-bind=\"css: {'col-md-12': $root.layout() == 0, 'col-md-3': $root.layout() == 1}\">\n                <table class=\"table table-condensed\">\n                <tbody>\n                <tr><td>Armor:</td><td class=\"text-right\"><span data-bind=\"text: totalArmorPhysical\"></span></td></tr>\n                <tr><td>Magic Res:</td><td class=\"text-right\"><span data-bind=\"html: totalMagicResistance().toFixed(2) + '%'\"></span></td></tr>\n                <tr><td>Lifesteal:</td><td class=\"text-right\"><span data-bind=\"text: lifesteal\"></span></td></tr>\n                <tr><td>Evasion:</td><td class=\"text-right\"><span data-bind=\"text: evasion\"></span></td></tr>\n                <tr><td>Bash:</td><td class=\"text-right\"><span data-bind=\"text: bash\"></span></td></tr>\n                <tr><td>Miss Chance:</td><td class=\"text-right\"><span data-bind=\"text: missChance\"></span></td></tr>\n                </tbody>\n                <tbody class=\"tabledropdown\" style=\"border-top:0\" data-bind=\"visible: showCriticalStrikeDetails(),foreach: critInfo().sources\">\n                <tr><td colspan=2><strong data-bind=\"text: $data.name\"></strong></td></tr>\n                <tr><td>Crit Chance:</td><td class=\"text-right\"><span data-bind=\"text: ($data.totalchance * 100).toFixed(2) + '%'\"></span></td></tr>\n                <tr><td>Crit Multiplier:</td><td class=\"text-right\"><span data-bind=\"text: ($data.multiplier * 100).toFixed(2) + '%'\"></span></td></tr>\n                </tbody>\n                </table>\n            </div>\n\n            <div class=\"col-md-12\" data-bind=\"css: {'col-md-12': $root.layout() == 0, 'col-md-3': $root.layout() == 1}\">\n                <table class=\"table table-condensed\">\n                <tbody>\n                <tr>\n                    <td>Damage:</td>\n                    <td class=\"text-right\">\n                        <span data-bind=\"html: baseDamage()[0] + '-' + baseDamage()[1]\"></span>\n                        <span style=\"color:green\" data-bind=\"visible: bonusDamage() > 0, text: ' + ' + bonusDamage()\"></span>\n                        <span style=\"color:red\" data-bind=\"visible: bonusDamageReduction() != 0, text: ' - ' + bonusDamageReduction()\"></span>\n                    </td>\n                </tr>\n                <tr><td><abbr title=\"Increased Attack Speed\">IAS</abbr>:</td><td class=\"text-right\"><span data-bind=\"text: ias\"></span></td></tr>\n                <tr><td><abbr title=\"Base Attack Time\">BAT</abbr>:</td><td class=\"text-right\"><span data-bind=\"text: bat\"></span></td></tr>\n                <tr><td>Attack Time:</td><td class=\"text-right\"><span data-bind=\"text: attackTime\"></span></td></tr>\n                <tr><td>Attack / Sec:</td><td class=\"text-right\"><span data-bind=\"text: attacksPerSecond().toFixed(2)\"></span></td></tr>\n                <tr><td>Attack Range:</td><td class=\"text-right\"><span data-bind=\"text: totalattackrange\"></span></td></tr>\n                </tbody>\n                </table>\n            </div>\n        </div>\n    </div>\n    <div class=\"col-md-8\" data-bind=\"css: {'col-md-8': $root.layout() == 0, 'col-md-12': $root.layout() == 1}\">\n        <div data-bind=\"component: { name: 'damage-details', params: $data}\"></div>\n        \n        <div class=\"row\">\n            <div class=\"col-md-12\">\n                <h3 class=\"section_header\" data-bind=\"toggle: sectionDisplay().inventory, css: { section_disabled: !sectionDisplay().inventory() }\">Inventory <small style=\"color:goldenrod\" data-bind=\"html: inventory.totalCost() ? '<img src=\\'http://cdn.dota2.com/apps/dota2/images/tooltips/gold.png\\'/> ' + inventory.totalCost() : '' \"></small></h3>\n                <div id=\"inventory\" class=\"inventory hover-cursor\" data-bind=\"click: function (data, event) { buildExplorer.selectInventory(-1); }, css: {'row-highlight': selectedInventory() == -1}, template: { name: 'item-template', foreach: inventory.items }, visible: sectionDisplay().inventory()\"></div>\n            </div>\n        </div>\n        \n        <div class=\"row\">\n            <div class=\"col-md-12\">\n                <h3 class=\"section_header\" data-bind=\"toggle: sectionDisplay().ability, css: { section_disabled: !sectionDisplay().ability() }\">Abilities</h3>\n                <div class=\"row\" data-bind=\"visible: sectionDisplay().ability(), foreach: ability().abilities()\">\n                    <div data-bind=\"component: { name: 'ability', params: $data }\"></div>\n                </div>\n            </div>\n        </div>\n\n        <div data-bind=\"component: { name: 'buff-section', params: $data}\"></div>\n    </div>\n</div>" });
ko.components.register('clone-pane', { template: "<div class=\"row\">\n    <div class=\"col-md-4\">\n        <img class=\"img-rounded\" data-bind=\"attr:{src: '/media/images/heroes/meepo.png'}\"/>\n    </div>\n</div>\n\n<div class=\"row\">\n    <div class=\"col-md-4\" data-bind=\"css: {'col-md-4': $root.layout() == 0, 'col-md-12': $root.layout() == 1}\">\n        <div class=\"row\">\n            <h3 class=\"col-md-12\">Stats <a class=\"btn btn-default btn-xs\" data-bind=\"toggle: showStatDetails, text: !showStatDetails() ? 'Show more' : 'Show less', attr: {title: !showStatDetails() ? 'Click to show base stats' : 'Click to hide base stats'}\"></a></h3>\n\n            <div class=\"col-md-12\" data-bind=\"visible: showStatDetails(), css: {'col-md-12': $root.layout() == 0, 'col-md-3': $root.layout() == 1}, component: {name: 'stats-additional', params: $data}\"></div>\n\n            <div class=\"statscontainer\" data-bind=\"foreach: $root.allItems\">\n                <div data-bind=\"component: { name: $data.value, params: $root.heroes[$parentContext.$index()].clone()}\"></div>\n            </div>\n        </div>\n    </div>\n    <div class=\"col-md-8\" data-bind=\"css: {'col-md-8': $root.layout() == 0, 'col-md-12': $root.layout() == 1}\">\n        <div data-bind=\"component: { name: 'damage-details', params: $data}\"></div>\n        \n        <div class=\"row\">\n            <div class=\"col-md-12\">\n                <h3 class=\"section_header\" data-bind=\"toggle: sectionDisplay().inventory, css: { section_disabled: !sectionDisplay().inventory() }\">Inventory <small style=\"color:goldenrod\" data-bind=\"html: inventory.totalCost() ? '<img src=\\'http://cdn.dota2.com/apps/dota2/images/tooltips/gold.png\\'/> ' + inventory.totalCost() : '' \"></small></h3>\n                <div id=\"inventory\" class=\"inventory hover-cursor\" data-bind=\"click: function (data, event) { buildExplorer.selectInventory(-1); }, css: {'row-highlight': selectedInventory() == -1}, template: { name: 'item-template', foreach: inventory.items }, visible: sectionDisplay().inventory()\"></div>\n            </div>\n        </div>\n\n        <div class=\"row\" data-bind=\"component: { name: 'damage-amp', params: $data}\"></div>\n    </div>\n</div>" });
ko.components.register('illusion-pane', { template: "<div class=\"row\">\n    <div class=\"col-md-4\">\n        <div class=\"img-rounded\" style=\"background-color:#428bca;display:inline-block\">\n            <img class=\"img-rounded\" style=\"opacity:.5\" data-bind=\"attr:{src: '/media/images/heroes/' + selectedHero().heroName + '.png'}\"/>\n        </div>\n    </div>\n    <div class=\"col-md-4\">\n        <label for=\"illusionlevel\" data-bind=\"text: illusionDisplayName\"></label>\n        <table class=\"table\">\n            <tbody>\n            <tr>\n                <td>Damage Dealt</td>\n                <td class=\"text-right\" data-bind=\"text: (getOutgoingDamageMultiplier(illusionType(), false, heroData().attacktype)*100).toFixed(0)+'%'\"></td>\n            </tr>\n            <tr>\n                <td>Damage Taken</td>\n                <td class=\"text-right\" data-bind=\"text: (getIncomingDamageMultiplier(illusionType(), false, heroData().attacktype)*100).toFixed(0)+'%'\"></td>\n            </tr>\n            </tbody>\n        </table>\n    </div>\n    <div class=\"col-md-4\">\n        <div data-bind=\"visible: illusionType() != 'item_manta'\">\n            <label for=\"illusionlevel\">Ability Level</label>\n            <select id=\"illusionlevel\" class=\"form-control\" data-bind=\"value: illusionAbilityLevel, foreach: new Array(illusionAbilityMaxLevel())\">\n                <option data-bind=\"text: $index()+1\"></option>\n            </select>\n        </div>\n    </div>\n</div>\n\n<div class=\"row\">\n    <div class=\"col-md-4\" data-bind=\"css: {'col-md-4': $root.layout() == 0, 'col-md-12': $root.layout() == 1}\">\n        <div class=\"row\">\n            <h3 class=\"col-md-12\">Stats <a class=\"btn btn-default btn-xs\" data-bind=\"toggle: showStatDetails, text: !showStatDetails() ? 'Show more' : 'Show less', attr: {title: !showStatDetails() ? 'Click to show base stats' : 'Click to hide base stats'}\"></a></h3>\n\n            <div class=\"col-md-12\" data-bind=\"visible: showStatDetails(), css: {'col-md-12': $root.layout() == 0, 'col-md-3': $root.layout() == 1}, component: {name: 'stats-additional', params: $data}\">\n            </div>\n            <div class=\"statscontainer\" data-bind=\"foreach: $root.allItems\">\n                <div data-bind=\"component: { name: $data.value, params: $parentContext.$data}\"></div>\n            </div>\n        </div>\n    </div>\n    <div class=\"col-md-8\" data-bind=\"css: {'col-md-4': $root.layout() == 0, 'col-md-12': $root.layout() == 1}\">\n        <div class=\"row\">\n            <div class=\"col-md-12\">\n                <h3 class=\"section_header\" data-bind=\"toggle: sectionDisplay().inventory, css: { section_disabled: !sectionDisplay().inventory() }\">Inventory <small style=\"color:goldenrod\" data-bind=\"html: inventory.totalCost() ? '<img src=\\'http://cdn.dota2.com/apps/dota2/images/tooltips/gold.png\\'/> ' + inventory.totalCost() : '' \"></small></h3>\n                <div id=\"inventory\" class=\"inventory hover-cursor\" data-bind=\"click: function (data, event) { buildExplorer.selectInventory(-1); }, css: {'row-highlight': selectedInventory() == -1}, foreach: inventory.items, visible: sectionDisplay().inventory()\">\n                    <div class=\"btn-group\">\n                        <img style=\"width:75px;\" class=\"img-rounded\" data-bind=\"css: { item_disabled: !enabled(), item_active: $parent.inventory.getActiveBorder($data) == 1, item_inactive: $parent.inventory.getActiveBorder($data) == 0 }, attr:{ src: $parent.inventory.getItemImage($data) }, click: function(data, event) { $parent.inventory.toggleItem($index, data, event); }, event: { dblclick: $parent.inventory.removeItem }\"/>\n                        <div style=\"float:left\" data-bind=\"visible: $parent.inventory.getItemSizeLabel($data) != ''\">\n                            <div data-bind=\"html: $parent.inventory.getItemSizeLabel($data)\" style=\"position:absolute;left:0;bottom:0;color:white;opacity:.5;background-color:black;padding:0px 2px\"></div>\n                            <div data-bind=\"html: $parent.inventory.getItemSizeLabel($data)\" style=\"position:absolute;left:0;bottom:0;color:white;padding:0px 2px\"></div>\n                        </div>\n                    </div>\n                </div>\n            </div>\n        </div>\n    </div>\n</div>" });
ko.components.register('buff-settings', { template: "<div class=\"form-horizontal\">\n    <div data-bind=\"foreach: data\">\n        <div class=\"form-group\" data-bind=\"visible: (display == undefined || display == 'buff')\">\n            <label class=\"col-md-6 control-label\" data-bind=\"css: {'checkbox-label': controlType == 'checkbox'}, attr: {'for': labelName}, html: labelName\"></label>\n            <div data-bind=\"if: controlType == 'input' && (display == undefined || display == 'buff' || display == 'hidden')\">\n                <div class=\"col-md-6\"><input class=\"form-control\" data-bind=\"attr: {'id': labelName}, value: controlVal\"></div>\n            </div>\n            <div data-bind=\"if: controlType == 'checkbox' && (display == undefined || display == 'buff' || display == 'hidden')\">\n                <div class=\"col-md-6\">\n                    <div class=\"checkbox\">\n                        <input type=\"checkbox\" data-bind=\"attr: {'id': labelName}, checked: controlVal\">\n                    </div>\n                </div>\n            </div>\n            <div data-bind=\"if: (controlType == 'text' || controlType == 'method') && (display == undefined || display == 'buff' || display == 'hidden')\">\n                <div class=\"col-md-6\"><p class=\"form-control-static\" data-bind=\"html: controlVal\"></p></div>\n            </div>\n            <div data-bind=\"if: controlType == 'radio' && (display == undefined || display == 'buff' || display == 'hidden')\">\n                <div class=\"col-md-6\">\n                    <!-- ko foreach: controlOptions -->\n                    <div class=\"radio\">\n                        <label>\n                            <input type=\"radio\" data-bind=\"attr: {'id': $parent.labelName + value, value: value}, checked: $parent.controlVal\">\n                            <span data-bind=\"text: text\"></span>\n                        </label>\n                    </div>\n                    <!-- /ko -->\n                </div>\n            </div>\n        </div>\n    </div>\n</div>" });
ko.components.register('talent-section', { template: "<div class=\"row\">\n    <div class=\"col-md-12\">\n        <h3 class=\"section_header\" data-bind=\"toggle: sectionDisplay().talent, css: { section_disabled: !sectionDisplay().talent() }\">Talents</h3>\n        <div class=\"row\" data-bind=\"foreach: heroData().talents, visible: sectionDisplay().talent()\">\n            <div class=\"talent col-xs-12\">\n                <label class=\"talent-level col-sm-4 col-xs-12\" data-bind=\"text: 'Level ' + ($index() * 5 + 10) + ':'\"></label>\n                <div class=\"talent-1 col-sm-4 col-xs-12 btn btn-default btn-sm\" data-bind=\"text: $data[0].displayname, click: function () { $parent.toggleTalent($index(), 0) }, css: {'toggled': $parent.talents[$index()]() == 0}\"></div>\n                <div class=\"talent-2 col-sm-4 col-xs-12 btn btn-default btn-sm\" data-bind=\"text: $data[1].displayname, click: function () { $parent.toggleTalent($index(), 1) }, css: {'toggled': $parent.talents[$index()]() == 1}\"></div>\n            </div>\n        </div>\n    </div>\n</div>" });
ko.components.register('item-buff', { template: "<div class=\"btn-group\">\n    <img style=\"width:75px;\" class=\"img-rounded\" data-bind=\"css: { item_disabled: !enabled(), item_active: $parents[1].buffs.itemBuffs.getActiveBorder($data) == 1, item_inactive: $parents[1].buffs.itemBuffs.getActiveBorder($data) == 0 }, attr:{ src: $parents[1].buffs.itemBuffs.getItemImage($data) }, click: function(data, event) { $parents[1].buffs.itemBuffs.toggleItem($index, data, event); }, event: { dblclick: $parents[1].buffs.itemBuffs.removeItem }\"/>\n    <div class=\"btn-group-vertical\">\n        <button style=\"padding:3px 10px;\" class=\"btn btn-default btn-xs\" title=\"Remove Item\" data-bind=\"click: $parents[1].buffs.itemBuffs.removeItem\">&times;</button>\n        <button style=\"padding:3px 10px;\" class=\"btn btn-default btn-xs\" title=\"Disable/Enable Item\" data-bind=\"click: $parents[1].buffs.itemBuffs.toggleMuteItem, html: enabled() ? 'o' : '-', attr: {title: enabled() ? 'Disable Item' : 'Enable Item'}\">o</button>\n    </div>\n</div>" });
ko.components.register('item-debuff', { template: "<div class=\"btn-group\">\n    <img style=\"width:75px;\" class=\"img-rounded\" data-bind=\"css: { item_disabled: !enabled(), item_active: $parents[1].debuffs.itemBuffs.getActiveBorder($data) == 1, item_inactive: $parents[1].debuffs.itemBuffs.getActiveBorder($data) == 0 }, attr:{ src: $parents[1].debuffs.itemBuffs.getItemImage($data) }, click: function(data, event) { $parents[1].debuffs.itemBuffs.toggleItem($index, data, event); }, event: { dblclick: $parents[1].debuffs.itemBuffs.removeItem }\"/>\n    <div class=\"btn-group-vertical\">\n        <button style=\"padding:3px 10px;\" class=\"btn btn-default btn-xs\" title=\"Remove Item\" data-bind=\"click: $parents[1].debuffs.itemBuffs.removeItem\">&times;</button>\n        <button style=\"padding:3px 10px;\" class=\"btn btn-default btn-xs\" title=\"Disable/Enable Item\" data-bind=\"click: $parents[1].debuffs.itemBuffs.toggleMuteItem, html: enabled() ? 'o' : '-', attr: {title: enabled() ? 'Disable Item' : 'Enable Item'}\">o</button>\n    </div>\n</div>" });
ko.components.register('buff-section', { template: "<div class=\"row\">\n    <div class=\"col-md-12\">\n        <h3 class=\"section_header\" data-bind=\"toggle: sectionDisplay().buff, css: { section_disabled: !sectionDisplay().buff() }\">Buffs</h3>\n        <div class=\"form-horizontal\" data-bind=\"visible: sectionDisplay().buff()\">\n            <div class=\"form-group\">\n                <div class=\"col-md-6\">\n                    <select id=\"buffselect\" class=\"form-control\" data-bind=\"options: buffs.availableBuffs , optionsText: 'buffDisplayName', value: buffs.selectedBuff\"></select>\n                </div>\n                <div class=\"col-md-6\">\n                    <button class=\"btn btn-default\" data-bind=\"click: buffs.addBuff\">Add</button>\n                    <button class=\"btn btn-default\" data-bind=\"click: function(data,event) { buffs.removeBuff(data, event, buffs.selectedBuff().buffName) }\">Remove</button>\n                </div>\n            </div>\n        </div>\n        <div class=\"row\" data-bind=\"foreach: buffs.buffs, visible: sectionDisplay().buff()\">\n            <div data-bind=\"css: {row: $data.data.isDetail() || ($index() < $parent.buffs.buffs().length-1 && $parent.buffs.buffs()[$index()+1].data.isDetail()), row2: $data.data.isDetail() || ($index() < $parent.buffs.buffs().length-1 && $parent.buffs.buffs()[$index()+1].data.isDetail()) }\">\n                <div class=\"col-md-3 text-center bottom-buffer2\" data-bind=\"css: {'col-md-3': $root.layout() == 0, 'col-md-2': $root.layout() == 1}\">\n                    <img style=\"padding:0px;margin-bottom:1px;\" class=\"img-rounded ability\" data-bind=\"css: { ability_active: $data.data.isActive() || $data.data.behavior.indexOf('DOTA_ABILITY_BEHAVIOR_PASSIVE') != -1, ability_inactive: !$data.data.isActive() && $data.data.behavior.indexOf('DOTA_ABILITY_BEHAVIOR_PASSIVE') == -1, btn: $data.data.behavior.indexOf('DOTA_ABILITY_BEHAVIOR_PASSIVE') == -1, 'btn-default': $data.data.behavior.indexOf('DOTA_ABILITY_BEHAVIOR_PASSIVE') == -1}, attr:{src: '/media/images/spellicons/' + $data.data.name + '.png'}, click: function(data, event) { $parent.buffs.toggleBuff($index, data.data, event); }, event: { dblclick: function(data,event) { $parent.buffs.removeBuff(data, event, $data.data.name) } }\"/>\n                    <div class=\"progress\" style=\"position:relative\">\n                        <div style=\"position:absolute;width:100%;color:white;\" class=\"text-center\" data-bind=\"visible: $parent.getAbilityLevelMax($data.data) > 0, text: $data.data.level() + '/' + $parent.getAbilityLevelMax($data.data)\"></div>\n                        <div class=\"progress-bar progress-bar-danger\" role=\"progressbar\" aria-valuenow=\"60\" aria-valuemin=\"0\" aria-valuemax=\"100\" style=\"width: 60%;\" data-bind=\"attr: { 'aria-valuenow': ($parent.getAbilityLevelMax($data.data) > 0 ? $data.data.level()/$parent.getAbilityLevelMax($data.data)*100 : 0) }, style: { width: ($parent.getAbilityLevelMax($data.data) > 0 ? $data.data.level()/$parent.getAbilityLevelMax($data.data)*100 : 0) + '%' }\"></div>\n                    </div>\n                    <div class=\"btn-group btn-group-justified\" data-bind=\"if: $data.data.behavior.indexOf('DOTA_ABILITY_BEHAVIOR_NOT_LEARNABLE') == -1\">\n                        <a class=\"btn btn-default btn-sm\" data-bind=\"click: function(data, event) { $parent.buffs.levelDownAbility($index, data.data, event, $parent); }\">-</a>\n                        <a class=\"btn btn-default btn-sm\" data-bind=\"click: function(data, event) { $parent.buffs.levelUpAbility($index, data.data, event, $parent); }\">+</a>\n                    </div>\n                    <div class=\"btn-group btn-group-justified\">\n                        <a class=\"btn btn-default btn-sm\" data-bind=\"click: function(data, event) { $parent.buffs.toggleBuffDetail($index, data, event); }, css: {'toggled': $data.data.isDetail}\">Details</a>\n                    </div>\n                </div>\n                <div class=\"col-md-9 bottom-buffer\" data-bind=\"visible: $data.data.isDetail()\">\n                    <button type=\"button\" class=\"close\" data-bind=\"click: function(data, event) { $parent.buffs.toggleBuffDetail($index, data.data, event); }\">&times;</button>\n                    <div data-bind=\"html: $parent.ability().getAbilityTooltipData($data.hero, $data.data.name)\"></div>\n                    <div data-bind=\"if: $data.data.name in $parent.buffs.abilityData && $parent.buffs.buffs()[$index()].data.level() > 0\">\n                        <div class=\"col-md-8\">\n                            <div data-bind=\"component: { name: 'buff-settings', params: $parent.buffs.abilitySettingsData($data.data.name, $parent, $index()) }\"></div>\n                        </div>\n                    </div>\n                </div>\n            </div>\n        </div>\n        \n        <div class=\"form-horizontal\" data-bind=\"visible: sectionDisplay().buff()\">\n            <div class=\"form-group\">\n                <div class=\"col-md-6\">\n                    <div class=\"input-group\">\n                        <input class=\"form-control\" id=\"auto2\" data-bind=\"attr: {id: id() + '-auto2' }, jqAuto: { autoFocus: true, html: true }, jqAutoSource: buffs.itemBuffs.itemBuffOptions, jqAutoValue: buffs.itemBuffs.selectedItemBuff, jqAutoSourceLabel: 'displayname', jqAutoSourceInputValue: 'name', jqAutoSourceValue: 'value'\" />\n                        <span class=\"input-group-btn\">\n                            <button class=\"btn btn-default\" data-bind=\"jqAutoCombo: id() + '-auto2'\"><span class=\"glyphicon glyphicon-search\"></span></button>\n                        </span>\n                    </div>\n                </div>\n                <div class=\"col-md-6\">\n                    <button class=\"btn btn-default\" data-bind=\"click: buffs.itemBuffs.addItemBuff\">Add</button>\n                </div>\n            </div>\n        </div>\n        <div data-bind=\"foreach: buffs.itemBuffs.items, visible: sectionDisplay().buff()\">\n            <div class=\"pull-left\" style=\"margin-right:10px\" data-bind=\"component: { name: 'item-buff', params: $data}\"></div>\n        </div>\n    </div>\n</div>\n\n<div class=\"row\">\n    <div class=\"col-md-12\">\n        <h3 class=\"section_header\" data-bind=\"toggle: sectionDisplay().debuff, css: { section_disabled: !sectionDisplay().debuff() }\">Debuffs</h3>\n        <div class=\"form-horizontal\" data-bind=\"visible: sectionDisplay().debuff()\">\n            <div class=\"form-group\">\n                <div class=\"col-md-6\">\n                    <select id=\"buffselect\" class=\"form-control\" data-bind=\"options: debuffs.availableDebuffs , optionsText: 'buffDisplayName', value: debuffs.selectedBuff\"></select>\n                </div>\n                <div class=\"col-md-6\">\n                    <button class=\"btn btn-default\" data-bind=\"click: debuffs.addBuff\">Add</button>\n                    <button class=\"btn btn-default\" data-bind=\"click: function(data,event) { debuffs.removeBuff(data, event, debuffs.selectedBuff().buffName) }\">Remove</button>\n                </div>\n            </div>\n        </div>\n\n        <div class=\"row\" data-bind=\"foreach: debuffs.buffs, visible: sectionDisplay().debuff()\">\n            <div data-bind=\"css: {row: $data.data.isDetail() || ($index() < $parent.debuffs.buffs().length-1 && $parent.debuffs.buffs()[$index()+1].data.isDetail()), row2: $data.data.isDetail() || ($index() < $parent.debuffs.buffs().length-1 && $parent.debuffs.buffs()[$index()+1].data.isDetail()) }\">\n                <div class=\"col-md-3 text-center bottom-buffer2\" data-bind=\"css: {'col-md-3': $root.layout() == 0, 'col-md-2': $root.layout() == 1}\">\n                    <img style=\"padding:0px;margin-bottom:1px;\" class=\"img-rounded ability\" data-bind=\"css: { ability_active: $data.data.isActive() || $data.data.behavior.indexOf('DOTA_ABILITY_BEHAVIOR_PASSIVE') != -1, ability_inactive: !$data.data.isActive() && $data.data.behavior.indexOf('DOTA_ABILITY_BEHAVIOR_PASSIVE') == -1, btn: $data.data.behavior.indexOf('DOTA_ABILITY_BEHAVIOR_PASSIVE') == -1, 'btn-default': $data.data.behavior.indexOf('DOTA_ABILITY_BEHAVIOR_PASSIVE') == -1}, attr:{src: '/media/images/spellicons/' + $data.data.name + '.png'}, click: function(data, event) { $parent.debuffs.toggleBuff($index, data.data, event); }, event: { dblclick: function(data,event) { $parent.debuffs.removeBuff(data, event, $data.data.name) } }\"/>\n                    <div class=\"progress\" style=\"position:relative\">\n                        <div style=\"position:absolute;width:100%;color:white;\" class=\"text-center\" data-bind=\"visible: $parent.getAbilityLevelMax($data.data) > 0, text: $data.data.level() + '/' + $parent.getAbilityLevelMax($data.data)\"></div>\n                        <div class=\"progress-bar progress-bar-danger\" role=\"progressbar\" aria-valuenow=\"60\" aria-valuemin=\"0\" aria-valuemax=\"100\" style=\"width: 60%;\" data-bind=\"attr: { 'aria-valuenow': ($parent.getAbilityLevelMax($data.data) > 0 ? $data.data.level()/$parent.getAbilityLevelMax($data.data)*100 : 0) }, style: { width: ($parent.getAbilityLevelMax($data.data) > 0 ? $data.data.level()/$parent.getAbilityLevelMax($data.data)*100 : 0) + '%' }\"></div>\n                    </div>\n                    <div class=\"btn-group btn-group-justified\" data-bind=\"if: $data.data.behavior.indexOf('DOTA_ABILITY_BEHAVIOR_NOT_LEARNABLE') == -1\">\n                        <a class=\"btn btn-default btn-sm\" data-bind=\"click: function(data, event) { $parent.debuffs.levelDownAbility($index, data.data, event, $parent); }\">-</a>\n                        <a class=\"btn btn-default btn-sm\" data-bind=\"click: function(data, event) { $parent.debuffs.levelUpAbility($index, data.data, event, $parent); }\">+</a>\n                    </div>\n                    <div class=\"btn-group btn-group-justified\">\n                        <a class=\"btn btn-default btn-sm\" data-bind=\"click: function(data, event) { $parent.debuffs.toggleBuffDetail($index, data, event); }, css: {'toggled': $data.data.isDetail}\">Details</a>\n                    </div>\n                </div>\n                <div class=\"col-md-9 bottom-buffer\" data-bind=\"visible: $data.data.isDetail()\">\n                    <button type=\"button\" class=\"close\" data-bind=\"click: function(data, event) { $parent.debuffs.toggleBuffDetail($index, data.data, event); }\">&times;</button>\n                    <div data-bind=\"html: $parent.ability().getAbilityTooltipData($data.hero, $data.data.name)\"></div>\n                    <div data-bind=\"if: $data.data.name in $parent.debuffs.abilityData && $parent.debuffs.buffs()[$index()].data.level() > 0\">\n                        <div class=\"col-md-8\">\n                            <div data-bind=\"component: { name: 'buff-settings', params: $parent.debuffs.abilitySettingsData($data.data.name, $parent, $index()) }\"></div>\n                        </div>\n                    </div>\n                </div>\n            </div>\n        </div>\n        \n        <div class=\"form-horizontal\" data-bind=\"visible: sectionDisplay().debuff()\">\n            <div class=\"form-group\">\n                <div class=\"col-md-6\">\n                    <div class=\"input-group\">\n                        <input class=\"form-control\" id=\"auto3\" data-bind=\"attr: {id: id() + '-auto3' }, jqAuto: { autoFocus: true, html: true }, jqAutoSource: debuffs.itemBuffs.itemDebuffOptions, jqAutoValue: debuffs.itemBuffs.selectedItemDebuff, jqAutoSourceLabel: 'displayname', jqAutoSourceInputValue: 'name', jqAutoSourceValue: 'value'\" />\n                        <span class=\"input-group-btn\">\n                            <button class=\"btn btn-default\" data-bind=\"jqAutoCombo: id() + '-auto3'\"><span class=\"glyphicon glyphicon-search\"></span></button>\n                        </span>\n                    </div>\n                </div>\n                <div class=\"col-md-6\">\n                    <button class=\"btn btn-default\" data-bind=\"click: debuffs.itemBuffs.addItemDebuff\">Add</button>\n                </div>\n            </div>\n        </div>\n        <div data-bind=\"foreach: debuffs.itemBuffs.items, visible: sectionDisplay().debuff()\">\n            <div class=\"pull-left\" style=\"margin-right:10px\" data-bind=\"component: { name: 'item-debuff', params: $data}\"></div>\n        </div>\n    </div>\n</div>" });
ko.components.register('damage-details', { template: "<div class=\"row\">\n    <div class=\"col-md-12\">\n        <h3 style=\"display:block;\" class=\"section_header\" data-bind=\"toggle: showDamageDetails, css: { section_disabled: !showDamageDetails() }\">Damage Details\n            <span class=\"pull-right\" data-bind=\"visible: showDamageDetails()\">\n                <small style=\"text-align:center\" data-bind=\"style: {color: getDamageTypeColor('physical')}\">Physical</small>\n                <small style=\"text-align:center\" data-bind=\"style: {color: getDamageTypeColor('magic')}\">Magical</small>\n                <small style=\"text-align:center\" data-bind=\"style: {color: getDamageTypeColor('pure')}\">Pure</small>\n            </span>\n        </h3>\n        <table class=\"table damage-details\" data-bind=\"visible: showDamageDetails()\">\n            <thead>\n                <tr class=\"damage-details-header-row\">\n                    <td></td>\n                    <td class=\"text-center\" colspan=\"2\"><strong>Attack Damage</strong><img src=\"img/reduc_icon.png\" class=\"pull-right\" data-bind=\"attr: {title: 'After reductions from ' + enemy().heroData().displayname}\"></td>\n                    <td class=\"text-center\" colspan=\"2\"><strong>DPS</strong><img src=\"img/reduc_icon.png\" class=\"pull-right\" data-bind=\"attr: {title: 'After reductions from ' + enemy().heroData().displayname}\"></td>\n                </tr>\n                <tr class=\"damage-details-header-row-2 total-row\">\n                    <td><strong>Total</strong></td>\n                    <td class=\"text-right\" data-bind=\"text: damageTotalInfo().totalRow[0]().toFixed(2)\"></td>\n                    <td class=\"text-right\" data-bind=\"text: damageTotalInfo().totalRow[1]().toFixed(2)\"></td>\n                    <td class=\"text-right\" data-bind=\"text: damageTotalInfo().totalRow[2]().toFixed(2)\"></td>\n                    <td class=\"text-right\" data-bind=\"text: damageTotalInfo().totalRow[3]().toFixed(2)\"></td>\n                </tr>\n            </thead>\n            <!-- ko foreach: damageTotalInfo().attacks -->\n            <tbody>\n                <tr class=\"indent subtotal-row\" data-bind=\"toggle: $data.enabled, css: { 'inactive': !$data.enabled() }\">\n                    <td>\n                        <button class=\"btn btn-default btn-xs glyphicon pull-left\" data-bind=\"toggle: $data.enabled, css: {'glyphicon-eye-open': $data.enabled(), 'glyphicon-eye-close': !$data.enabled()}, preventBubble: 'click'\"></button>\n                        <button class=\"btn btn-default btn-xs glyphicon pull-right\" data-bind=\"toggle: $data.visible, css: {'glyphicon-minus': $data.visible(), 'glyphicon-plus': !$data.visible()}, preventBubble: 'click'\"></button>\n                        <strong><span data-bind=\"text: $data.name\"></span></strong>\n                    </td>\n                    <td class=\"text-right\" data-bind=\"text: $data.totalRow[0]().toFixed(2)\"></td>\n                    <td class=\"text-right\" data-bind=\"text: $data.totalRow[1]().toFixed(2)\"></td>\n                    <td class=\"text-right\" data-bind=\"text: $data.totalRow[2]().toFixed(2)\"></td>\n                    <td class=\"text-right\" data-bind=\"text: $data.totalRow[3]().toFixed(2)\"></td>\n                </tr>\n            </tbody>\n            <tbody class=\"indent\" data-bind=\"foreach: $data.sources, visible: $data.visible\">\n                <tr data-bind=\"toggle: $data.enabled, css: { 'inactive': !$data.enabled() }\">\n                    <td class=\"indent\">\n                        <span data-bind=\"text: $data.name\"></span>\n                        <button class=\"btn btn-default btn-xs glyphicon pull-left\" data-bind=\"toggle: $data.enabled, css: {'glyphicon-eye-open': $data.enabled(), 'glyphicon-eye-close': !$data.enabled()}, preventBubble: 'click'\"></button>\n                    </td>\n                    <td class=\"text-right\"><span data-bind=\"html: $data.damage.toFixed(2), style: {color: $parents[1].getDamageTypeColor($data.damageType)}\"></span></td>\n                    <td class=\"text-right\"><span data-bind=\"html: $data.damageReduced.toFixed(2), style: {color: $parents[1].getDamageTypeColor($data.damageType)}\"></span></td>\n                    <td class=\"text-right\"><span data-bind=\"html: $data.dps.toFixed(2), style: {color: $parents[1].getDamageTypeColor($data.damageType)}\"></span></td>\n                    <td class=\"text-right\"><span data-bind=\"html: $data.dpsReduced.toFixed(2), style: {color: $parents[1].getDamageTypeColor($data.damageType)}\"></span></td>\n                </tr>\n            </tbody>\n            <tr class=\"indent crit\" data-bind=\"visible: $data.visible() && $data.sourcesCrit.length > 0\">\n                <td class=\"indent\">Critical Strike Proc, <span data-bind=\"text: ($data.totalCritChance * 100).toFixed(1) + '%'\"></span></td>\n                <td class=\"text-right\" data-bind=\"text: $data.totalCritRow[0]().toFixed(2)\"></td>\n                <td class=\"text-right\" data-bind=\"text: $data.totalCritRow[1]().toFixed(2)\"></td>\n                <td class=\"text-right\" data-bind=\"text: $data.totalCritRow[2]().toFixed(2)\"></td>\n                <td class=\"text-right\" data-bind=\"text: $data.totalCritRow[3]().toFixed(2)\"></td>\n            </tr>\n            <tbody class=\"indent\" data-bind=\"visible: $data.visible, foreach: $data.sourcesCrit\">\n                <tr class=\"indent crit\" data-bind=\"toggle: $data.enabled, css: { 'inactive': !$data.enabled() }\">\n                    <td class=\"indent\">\n                        <span data-bind=\"text: $data.name\"></span>\n                        <button class=\"btn btn-default btn-xs glyphicon pull-left\" data-bind=\"toggle: $data.enabled, css: {'glyphicon-eye-open': $data.enabled(), 'glyphicon-eye-close': !$data.enabled()}, preventBubble: 'click'\"></button>\n                    </td>\n                    <td class=\"text-right\"><span data-bind=\"html: $data.damage.toFixed(2)\"></span></td>\n                    <td class=\"text-right\"><span data-bind=\"html: $data.damageReduced.toFixed(2)\"></span></td>\n                    <td class=\"text-right\"><span data-bind=\"html: $data.dps.toFixed(2)\"></span></td>\n                    <td class=\"text-right\"><span data-bind=\"html: $data.dpsReduced.toFixed(2)\"></span></td>\n                </tr>\n            </tbody>\n            <!-- /ko -->\n            <tbody>\n                <tr data-bind=\"visible: cleaveInfo().length > 0\">\n                    <td colspan=3><strong>Cleave</strong></td>\n                </tr>\n            </tbody>    \n            <tbody data-bind=\"foreach: cleaveInfo()\">\n                <tr><td>Radius:</td><td class=\"text-right\"><span data-bind=\"html: $data.radius\"></span></td></tr>\n                <tr><td>Magnitude:</td><td class=\"text-right\"><span data-bind=\"html: ($data.magnitude * 100).toFixed(2) + '%'\"></span></td></tr>\n                <tr>\n                    <td>Cleave Damage:</td>\n                    <td class=\"text-right\"><span data-bind=\"html: ($data.magnitude * $parent.damageTotalInfo().total).toFixed(2)\"></span></td>\n                </tr>\n            </tbody>\n        \n        </table>\n    </div>\n</div>" });
ko.components.register('damage-amp', { template: "<div class=\"col-md-12\">\n    <h3 class=\"section_header\" data-bind=\"toggle: sectionDisplay().damageamp, css: { section_disabled: !sectionDisplay().damageamp() }\">Damage Amplification & Reduction</h3>\n    <div data-bind=\"visible: sectionDisplay().damageamp(), lazyBinding: sectionDisplay().damageamp\">\n        <div class=\"form-horizontal\">\n            <div class=\"form-group\">\n                    <div class=\"col-md-3 control-label\">\n                        <label for=\"damageinput\">Damage</label>\n                    </div>\n                    <div class=\"col-md-6\">\n                        <input class=\"form-control\" id=\"damageinput\" data-bind=\"value: damageInputValue\" />\n                    </div>\n            </div>\n        </div>\n        <div class=\"form-horizontal\">\n            <div class=\"form-group\">\n                    <div class=\"col-md-3 control-label\">\n                        <label for=\"buffampselect\">Amplification</label>\n                    </div>\n                    <div class=\"col-md-5\">\n                        <select id=\"buffampselect\" class=\"form-control\" data-bind=\"options: damageAmplification.availableBuffs , optionsText: 'buffDisplayName', value: damageAmplification.selectedBuff\"></select>\n                    </div>\n                    <div class=\"col-md-4\">\n                        <button class=\"btn btn-default\" data-bind=\"click: damageAmplification.addBuff\">Add</button>\n                        <button class=\"btn btn-default\" data-bind=\"click: function(data,event) { damageAmplification.removeBuff(data, event, damageAmplification.selectedBuff().buffName) }\">Remove</button>\n                    </div>\n            </div>\n        </div>\n        <div class=\"row\" data-bind=\"foreach: damageAmplification.buffs\">\n            <div data-bind=\"css: {row: $data.data.isDetail() || ($index() < $parent.damageAmplification.buffs().length-1 && $parent.damageAmplification.buffs()[$index()+1].data.isDetail()), row2: $data.data.isDetail() || ($index() < $parent.damageAmplification.buffs().length-1 && $parent.damageAmplification.buffs()[$index()+1].data.isDetail()) }\">\n                <div class=\"col-md-3 text-center bottom-buffer row2\" data-bind=\"css: {'col-md-3': $root.layout() == 0, 'col-md-2': $root.layout() == 1}\">\n                    <img style=\"padding:0px;margin-bottom:1px;\" class=\"img-rounded ability\" data-bind=\"css: { ability_active: $data.data.isActive() || $data.data.behavior.indexOf('DOTA_ABILITY_BEHAVIOR_PASSIVE') != -1, ability_inactive: !$data.data.isActive() && $data.data.behavior.indexOf('DOTA_ABILITY_BEHAVIOR_PASSIVE') == -1, btn: $data.data.behavior.indexOf('DOTA_ABILITY_BEHAVIOR_PASSIVE') == -1, 'btn-default': $data.data.behavior.indexOf('DOTA_ABILITY_BEHAVIOR_PASSIVE') == -1}, attr:{src: '/media/images/spellicons/' + $data.data.name + '.png'}, click: function(data, event) { $parent.damageAmplification.toggleBuff($index, data.data, event); }, event: { dblclick: function(data,event) { $parent.damageAmplification.removeBuff(data, event, $data.data.name) } }\"/>\n                    <div class=\"progress\" style=\"position:relative\">\n                        <div style=\"position:absolute;width:100%;color:white;\" class=\"text-center\" data-bind=\"visible: $parent.getAbilityLevelMax($data.data) > 0, text: $data.data.level() + '/' + $parent.getAbilityLevelMax($data.data)\"></div>\n                        <div class=\"progress-bar progress-bar-danger\" role=\"progressbar\" aria-valuenow=\"60\" aria-valuemin=\"0\" aria-valuemax=\"100\" style=\"width: 60%;\" data-bind=\"attr: { 'aria-valuenow': ($parent.getAbilityLevelMax($data.data) > 0 ? $data.data.level()/$parent.getAbilityLevelMax($data.data)*100 : 0) }, style: { width: ($parent.getAbilityLevelMax($data.data) > 0 ? $data.data.level()/$parent.getAbilityLevelMax($data.data)*100 : 0) + '%' }\"></div>\n                    </div>\n                    <div class=\"btn-group btn-group-justified\" data-bind=\"if: $data.data.behavior.indexOf('DOTA_ABILITY_BEHAVIOR_NOT_LEARNABLE') == -1\">\n                        <a class=\"btn btn-default btn-sm\" data-bind=\"click: function(data, event) { $parent.damageAmplification.levelDownAbility($index, data.data, event, $parent); }\">-</a>\n                        <a class=\"btn btn-default btn-sm\" data-bind=\"click: function(data, event) { $parent.damageAmplification.levelUpAbility($index, data.data, event, $parent); }\">+</a>\n                    </div>\n                    <div class=\"btn-group btn-group-justified\">\n                        <a class=\"btn btn-default btn-sm\" data-bind=\"click: function(data, event) { $parent.damageAmplification.toggleBuffDetail($index, data, event); }, css: {'toggled': $data.data.isDetail}\">Details</a>\n                    </div>\n                </div>\n                <div class=\"col-md-9 bottom-buffer\" data-bind=\"visible: $data.data.isDetail()\">\n                    <button type=\"button\" class=\"close\" data-bind=\"click: function(data, event) { $parent.damageAmplification.toggleBuffDetail($index, data.data, event); }\">&times;</button>\n                    <div data-bind=\"html: $parent.ability().getAbilityTooltipData($data.hero, $data.data.name)\"></div>\n                    <div data-bind=\"if: $data.data.name in $parent.damageAmplification.abilityData && $parent.damageAmplification.buffs()[$index()].data.level() > 0\">\n                        <div class=\"col-md-8\">\n                            <div data-bind=\"component: { name: 'buff-settings', params: $parent.damageAmplification.abilitySettingsData($data.data.name, $parent, $index()) }\"></div>\n                        </div>\n                    </div>\n                </div>\n            </div>\n        </div>\n        <div class=\"form-horizontal\">\n            <div class=\"form-group\">\n                    <div class=\"col-md-3 control-label\">\n                        <label for=\"buffreductionselect\">Reduction</label>\n                    </div>\n                    <div class=\"col-md-5\">\n                        <select id=\"buffreductionselect\" class=\"form-control\" data-bind=\"options: damageReduction.availableDebuffs , optionsText: 'buffDisplayName', value: damageReduction.selectedBuff\"></select>\n                    </div>\n                    <div class=\"col-md-4\">\n                        <button class=\"btn btn-default\" data-bind=\"click: damageReduction.addBuff\">Add</button>\n                        <button class=\"btn btn-default\" data-bind=\"click: function(data,event) { damageReduction.removeBuff(data, event, damageReduction.selectedBuff().buffName) }\">Remove</button>\n                    </div>\n            </div>\n        </div>\n        <div class=\"row\" data-bind=\"foreach: damageReduction.buffs\">\n            <div data-bind=\"css: {row: $data.data.isDetail() || ($index() < $parent.damageReduction.buffs().length-1 && $parent.damageReduction.buffs()[$index()+1].data.isDetail()), row2: $data.data.isDetail() || ($index() < $parent.damageReduction.buffs().length-1 && $parent.damageReduction.buffs()[$index()+1].data.isDetail()) }\">\n                <div class=\"col-md-3 text-center bottom-buffer row2\" data-bind=\"css: {'col-md-3': $root.layout() == 0, 'col-md-2': $root.layout() == 1}\">\n                    <img style=\"padding:0px;margin-bottom:1px;\" class=\"img-rounded ability\" data-bind=\"css: { ability_active: $data.data.isActive() || $data.data.behavior.indexOf('DOTA_ABILITY_BEHAVIOR_PASSIVE') != -1, ability_inactive: !$data.data.isActive() && $data.data.behavior.indexOf('DOTA_ABILITY_BEHAVIOR_PASSIVE') == -1, btn: $data.data.behavior.indexOf('DOTA_ABILITY_BEHAVIOR_PASSIVE') == -1, 'btn-default': $data.data.behavior.indexOf('DOTA_ABILITY_BEHAVIOR_PASSIVE') == -1}, attr:{src: '/media/images/spellicons/' + $data.data.name + '.png'}, click: function(data, event) { $parent.damageReduction.toggleBuff($index, data.data, event); }, event: { dblclick: function(data,event) { $parent.damageReduction.removeBuff(data, event, $data.data.name) } }\"/>\n                    <div class=\"progress\" style=\"position:relative\">\n                        <div style=\"position:absolute;width:100%;color:white;\" class=\"text-center\" data-bind=\"visible: $parent.getAbilityLevelMax($data.data) > 0, text: $data.data.level() + '/' + $parent.getAbilityLevelMax($data.data)\"></div>\n                        <div class=\"progress-bar progress-bar-danger\" role=\"progressbar\" aria-valuenow=\"60\" aria-valuemin=\"0\" aria-valuemax=\"100\" style=\"width: 60%;\" data-bind=\"attr: { 'aria-valuenow': ($parent.getAbilityLevelMax($data.data) > 0 ? $data.data.level()/$parent.getAbilityLevelMax($data.data)*100 : 0) }, style: { width: ($parent.getAbilityLevelMax($data.data) > 0 ? $data.data.level()/$parent.getAbilityLevelMax($data.data)*100 : 0) + '%' }\"></div>\n                    </div>\n                    <div class=\"btn-group btn-group-justified\" data-bind=\"if: $data.data.behavior.indexOf('DOTA_ABILITY_BEHAVIOR_NOT_LEARNABLE') == -1\">\n                        <a class=\"btn btn-default btn-sm\" data-bind=\"click: function(data, event) { $parent.damageReduction.levelDownAbility($index, data.data, event, $parent); }\">-</a>\n                        <a class=\"btn btn-default btn-sm\" data-bind=\"click: function(data, event) { $parent.damageReduction.levelUpAbility($index, data.data, event, $parent); }\">+</a>\n                    </div>\n                    <div class=\"btn-group btn-group-justified\">\n                        <a class=\"btn btn-default btn-sm\" data-bind=\"click: function(data, event) { $parent.damageReduction.toggleBuffDetail($index, data, event); }, css: {'toggled': $data.data.isDetail}\">Details</a>\n                    </div>\n                </div>\n                <div class=\"col-md-9 bottom-buffer\" data-bind=\"visible: $data.data.isDetail()\">\n                    <button type=\"button\" class=\"close\" data-bind=\"click: function(data, event) { $parent.damageReduction.toggleBuffDetail($index, data.data, event); }\">&times;</button>\n                    <div data-bind=\"html: $parent.ability().getAbilityTooltipData($data.hero, $data.data.name)\"></div>\n                    <div data-bind=\"if: $data.data.name in $parent.damageReduction.abilityData && $parent.damageReduction.buffs()[$index()].data.level() > 0\">\n                        <div class=\"col-md-8\">\n                            <div data-bind=\"component: { name: 'buff-settings', params: $parent.damageReduction.abilitySettingsData($data.data.name, $parent, $index()) }\"></div>\n                        </div>\n                    </div>\n                </div>\n            </div>\n        </div>\n        \n        <h4>Calculations <a class=\"btn btn-default btn-xs\" data-bind=\"toggle: showDamageAmpCalcDetails, text: !showDamageAmpCalcDetails() ? 'Show details' : 'Hide details'\"></a></h4>\n        <table class=\"table\">\n            <tbody>\n                <!-- ko foreach: damageInputModified().data -->\n                <tr data-bind=\"visible: $parent.showDamageAmpCalcDetails()\">\n                    <td><span style=\"text-decoration: underline;\" data-bind=\"text: $data.label + ' damage'\"></span></td>\n                    <td class=\"text-right\"><span data-bind=\"html: Math.round($data.value * 100) / 100, style: {color: $parent.getDamageTypeColor($data.damageType)}\"></span></td>\n                </tr>\n                    <!-- ko foreach: $data.data -->\n                    <tr data-bind=\"visible: $parents[1].showDamageAmpCalcDetails()\">\n                        <td><span data-bind=\"text: $data.label\"></span></td>\n                        <td class=\"text-right\"><span data-bind=\"html: Math.round($data.value * 100) / 100, diffStyle: $data.value\"></span></td>\n                    </tr>\n                    <!-- /ko -->\n                <tr data-bind=\"css: {subtotal: $parent.showDamageAmpCalcDetails()}\">\n                    <td data-bind=\"visible: $parent.showDamageAmpCalcDetails()\"><span data-bind=\"text: $data.label + ' damage subtotal'\"></span></td>\n                    <td data-bind=\"visible: !$parent.showDamageAmpCalcDetails()\"><span data-bind=\"text: $data.label + ' damage'\"></span></td>\n                    <td class=\"text-right\"><span data-bind=\"html: Math.round($data.total * 100) / 100, style: {color: $parent.getDamageTypeColor($data.damageType)}\"></span></td>\n                </tr>\n                <!-- /ko -->\n                <tr>\n                    <td><strong data-bind=\"text: damageInputModified().label + ' damage'\"></strong></td>\n                    <td class=\"text-right\"><strong data-bind=\"html: Math.round(damageInputModified().total * 100) / 100, style: {color: getDamageTypeColor(damageInputModified().damageType)}\"></strong></td>\n                </tr>\n            </tbody>\n        </table>\n    </div>\n</div>" });
ko.components.register('ability', { template: "<div data-bind=\"if: $data.displayname != 'Empty' &&  ($data.behavior.indexOf('DOTA_ABILITY_BEHAVIOR_HIDDEN') == -1 || $data.name.indexOf('invoker_') != -1),\nstyle: {clear: $data.name == 'invoker_cold_snap' || $data.name == 'invoker_chaos_meteor' ? 'both' : ''},\ncss: {row: $data.isDetail() || ($index() < $parents[1].ability().abilities().length-1 && $parents[1].ability().abilities()[$index()+1].isDetail()), row3: $data.isDetail() || ($index() < $parents[1].ability().abilities().length-1 && $parents[1].ability().abilities()[$index()+1].isDetail()) }\">\n    <div class=\"col-md-3 text-center bottom-buffer row2\" data-bind=\"css: {'col-md-3': $root.layout() == 0, 'col-md-2': $root.layout() == 1}\">\n        <img style=\"padding:0px;margin-bottom:1px;\" class=\"img-rounded ability\" data-bind=\"css: { ability_active: $data.isActive() || $data.behavior.indexOf('DOTA_ABILITY_BEHAVIOR_PASSIVE') != -1, ability_inactive: !$data.isActive() && $data.behavior.indexOf('DOTA_ABILITY_BEHAVIOR_PASSIVE') == -1, btn: $data.behavior.indexOf('DOTA_ABILITY_BEHAVIOR_PASSIVE') == -1, 'btn-default': $data.behavior.indexOf('DOTA_ABILITY_BEHAVIOR_PASSIVE') == -1}, attr:{src: '/media/images/spellicons/' + $data.name + '.png'}, click: function(data, event) { $parents[1].ability().toggleAbility($index, data, event); }\"/>\n        <div class=\"progress\" style=\"position:relative\">\n            <div style=\"position:absolute;width:100%;color:white;\" class=\"text-center\" data-bind=\"visible: $parents[1].getAbilityLevelMax($data) > 0, text: $data.level() + '/' + $parents[1].getAbilityLevelMax($data)\"></div>\n            <div class=\"progress-bar progress-bar-danger\" role=\"progressbar\" aria-valuenow=\"60\" aria-valuemin=\"0\" aria-valuemax=\"100\" style=\"width: 60%;\" data-bind=\"attr: { 'aria-valuenow': ($parents[1].getAbilityLevelMax($data) > 0 ? $data.level()/$parents[1].getAbilityLevelMax($data)*100 : 0) }, style: { width: ($parents[1].getAbilityLevelMax($data) > 0 ? $data.level()/$parents[1].getAbilityLevelMax($data)*100 : 0) + '%' }\"></div>\n        </div>\n        <div class=\"btn-group btn-group-justified\" data-bind=\"if: $data.behavior.indexOf('DOTA_ABILITY_BEHAVIOR_NOT_LEARNABLE') == -1\">\n            <a class=\"btn btn-default btn-sm\" data-bind=\"click: function(data, event) { $parents[1].ability().levelDownAbility($index, data, event, $parents[1]); }\">-</a>\n            <a class=\"btn btn-default btn-sm\" data-bind=\"click: function(data, event) { $parents[1].ability().levelUpAbility($index, data, event, $parents[1]); }\">+</a>\n        </div>\n        <div class=\"btn-group btn-group-justified\">\n            <a class=\"btn btn-default btn-sm\" data-bind=\"click: function(data, event) { $parents[1].ability().toggleAbilityDetail($index, data, event); }, css: {'toggled': $data.isDetail}\">Details</a>\n        </div>\n        <div class=\"btn-group btn-group-justified\" data-bind=\"if: $data.behavior.indexOf('DOTA_ABILITY_BEHAVIOR_NOT_LEARNABLE') != -1\">\n            <a class=\"btn btn-default btn-sm btn-block\" style=\"visibility:hidden;\">&mdash;</a>\n        </div>\n    </div>\n    <div class=\"col-md-9 bottom-buffer2\" data-bind=\"visible: $data.isDetail()\">\n        <button type=\"button\" class=\"close\" data-bind=\"click: function(data, event) { $parents[1].ability().toggleAbilityDetail($index, data, event); }\">&times;</button>\n        <div data-bind=\"html: $parents[1].ability().getAbilityTooltipData($parents[1].heroId(), $data.name)\"></div>\n        <div data-bind=\"if: $data.name in $parents[1].ability().abilityData && $parents[1].ability().abilities()[$index()].level() > 0\">\n            <div class=\"col-md-12\" style=\"margin-top: 10px\" >\n                <div data-bind=\"template: { name: 'ability-settings-template', data: $parents[1].ability().abilitySettingsData($data.name, $parents[1], $index()) }\"></div>\n            </div>\n        </div>\n    </div>\n</div>" });
ko.components.register('shop', require('../components/shop'));
ko.components.register('stat', { template: "<span data-bind=\"text: parseFloat(hero[stat]()).toString()\"></span><span data-bind=\"html: $root.getDiffText(hero.diff[stat]()), diffCss: hero.diff[stat], diffCssStat: stat, visible: hero.showDiff\"></span>" });
ko.components.register('stats0', { template: "<div class=\"col-md-12 stats0\" data-bind=\"css: {'col-md-12': $root.layout() == 0, 'col-md-3': $root.layout() == 1}\">\n    <table class=\"table table-condensed\">\n    <tbody>\n    <tr><td>Strength:</td><td class=\"text-right\" data-bind=\"component: { name: 'stat', params: {'hero': $data, 'stat': 'totalStr' } }\"></td></tr>\n    <tr><td>Agility:</td><td class=\"text-right\" data-bind=\"component: { name: 'stat', params: {'hero': $data, 'stat': 'totalAgi' } }\"></td></tr>\n    <tr><td>Intelligence:</td><td class=\"text-right\" data-bind=\"component: { name: 'stat', params: {'hero': $data, 'stat': 'totalInt' } }\"></td></tr>\n    <tr><td><abbr title=\"Movement Speed\">MS</abbr>:</td><td class=\"text-right\" data-bind=\"component: { name: 'stat', params: {'hero': $data, 'stat': 'totalMovementSpeed' } }\"></td></tr>\n    <tr><td>Turn Rate:</td><td class=\"text-right\" data-bind=\"component: { name: 'stat', params: {'hero': $data, 'stat': 'totalTurnRate' } }\"></td></tr>\n    <tr><td>Sight Range:</td><td class=\"text-right\"><span data-bind=\"html: '<abbr title=\\'Day\\'>' + visionrangeday() + '</abbr>/<abbr title=\\'Night\\'>' + visionrangenight() + '</abbr>'\"></span></td></tr>\n    </tbody>\n    </table>\n</div>" });
ko.components.register('stats1', { template: "<div class=\"col-md-12 stats1\" data-bind=\"css: {'col-md-12': $root.layout() == 0, 'col-md-3': $root.layout() == 1}\">\n    <table class=\"table table-condensed\">\n    <tbody>\n    <tr><td>Armor:</td><td class=\"text-right\" data-bind=\"component: { name: 'stat', params: {'hero': $data, 'stat': 'totalArmorPhysical' } }\"></td></tr>\n    <tr><td>Health:</td><td class=\"text-right\" data-bind=\"component: { name: 'stat', params: {'hero': $data, 'stat': 'health' } }\"></td></tr>\n    <tr><td>Health Regen:</td><td class=\"text-right\" data-bind=\"component: { name: 'stat', params: {'hero': $data, 'stat': 'healthregen' } }\"></td></tr>\n    <tr><td>Mana:</td><td class=\"text-right\" data-bind=\"component: { name: 'stat', params: {'hero': $data, 'stat': 'mana' } }\"></td></tr>\n    <tr><td>Mana Regen:</td><td class=\"text-right\" data-bind=\"component: { name: 'stat', params: {'hero': $data, 'stat': 'manaregen' } }\"></td></tr>\n    <tr><td>Physical <abbr title=\"Effective Hit Points\">EHP</abbr>:</td><td class=\"text-right\" data-bind=\"component: { name: 'stat', params: {'hero': $data, 'stat': 'ehpPhysical' } }\"></td></tr>\n    <tr><td>Magical <abbr title=\"Effective Hit Points\">EHP</abbr>:</td><td class=\"text-right\" data-bind=\"component: { name: 'stat', params: {'hero': $data, 'stat': 'ehpMagical' } }\"></td></tr>\n    </tbody>\n    </table>\n</div>" });
ko.components.register('stats2', { template: "<div class=\"col-md-12 stats2\" data-bind=\"css: {'col-md-12': $root.layout() == 0, 'col-md-3': $root.layout() == 1}\">\n    <table class=\"table table-condensed\">\n    <tbody>\n    <tr><td>%Phys Res:</td><td class=\"text-right\" data-bind=\"component: { name: 'stat', params: {'hero': $data, 'stat': 'totalArmorPhysicalReduction' } }\"></td></tr>\n    <tr><td>%Magic Res:</td><td class=\"text-right\" data-bind=\"component: { name: 'stat', params: {'hero': $data, 'stat': 'totalMagicResistance' } }\"></td></tr>\n    <tr><td>%Lifesteal:</td><td class=\"text-right\" data-bind=\"component: { name: 'stat', params: {'hero': $data, 'stat': 'lifesteal' } }\"></td></tr>\n    <tr><td>%Evasion:</td><td class=\"text-right\" data-bind=\"component: { name: 'stat', params: {'hero': $data, 'stat': 'evasion' } }\"></td></tr>\n    <tr><td>%Bash:</td><td class=\"text-right\" data-bind=\"component: { name: 'stat', params: {'hero': $data, 'stat': 'bash' } }\"></td></tr>\n    <tr><td>%Miss Chance:</td><td class=\"text-right\" data-bind=\"component: { name: 'stat', params: {'hero': $data, 'stat': 'missChance' } }\"></td></tr>\n    <tr style=\"display: none\"><td colspan=2><a class=\"btn btn-default btn-block btn-xs\" data-bind=\"css: {disabled: critInfo().sources.length == 0 ? 'disabled' : '', 'toggled': showCriticalStrikeDetails}, toggle: showCriticalStrikeDetails\">Critical Strike Details</a></td></tr>\n    </tbody>\n    <tbody class=\"tabledropdown\" style=\"border-top:0\" data-bind=\"visible: showCriticalStrikeDetails(),foreach: critInfo().sources\">\n    <tr><td colspan=2><strong data-bind=\"text: $data.name\"></strong></td></tr>\n    <tr><td>Crit Chance:</td><td class=\"text-right\"><span data-bind=\"text: ($data.totalchance * 100).toFixed(2) + '%'\"></span></td></tr>\n    <tr><td>Crit Multiplier:</td><td class=\"text-right\"><span data-bind=\"text: ($data.multiplier * 100).toFixed(2) + '%'\"></span></td></tr>\n    </tbody>\n    </table>\n</div>" });
ko.components.register('stats3', { template: "<div class=\"col-md-12 stats3\" data-bind=\"css: {'col-md-12': $root.layout() == 0, 'col-md-3': $root.layout() == 1}\">\n    <table class=\"table table-condensed\">\n    <tbody>\n    <tr>\n        <td>Damage:</td>\n        <td class=\"text-right\">\n            <span data-bind=\"html: baseDamage()[0].toFixed(0)\"></span>\n            <span data-bind=\"html: $root.getDiffText(diff['baseDamage']()[0]), css: {'diffPos': diff['baseDamage']()[0] > 0, 'diffNeg': diff['baseDamage']()[0] < 0}, visible: showDiff\"></span>\n            <span>&ndash;</span>\n            <span data-bind=\"html: baseDamage()[1].toFixed(0)\"></span>\n            <span data-bind=\"html: $root.getDiffText(diff['baseDamage']()[1]), css: {'diffPos': diff['baseDamage']()[1] > 0, 'diffNeg': diff['baseDamage']()[1] < 0}, visible: showDiff\"></span>\n            <span style=\"color:green\" data-bind=\"visible: bonusDamage() > 0, html: ' + ' + bonusDamage().toFixed(0)\"></span>\n            <span data-bind=\"html: $root.getDiffText(diff['bonusDamage']()), css: {'diffPos': diff['bonusDamage']() > 0, 'diffNeg': diff['bonusDamage']() < 0}, visible: showDiff\"></span>\n            <span style=\"color:red\" data-bind=\"visible: bonusDamageReduction() != 0, html: ' - ' + bonusDamageReduction().toFixed(0)\"></span>\n            <span data-bind=\"html: $root.getDiffText(diff['bonusDamageReduction']()), css: {'diffPos': diff['bonusDamageReduction']() > 0, 'diffNeg': diff['bonusDamageReduction']() < 0}, visible: showDiff\"></span>\n        </td>\n    </tr>\n    <tr><td><abbr title=\"Increased Attack Speed\">IAS</abbr>:</td><td class=\"text-right\" data-bind=\"component: { name: 'stat', params: {'hero': $data, 'stat': 'ias' } }\"></td></tr>\n    <tr><td><abbr title=\"Base Attack Time\">BAT</abbr>:</td><td class=\"text-right\" data-bind=\"component: { name: 'stat', params: {'hero': $data, 'stat': 'bat' } }\"></td></tr>\n    <tr><td>Attack Time:</td><td class=\"text-right\" data-bind=\"component: { name: 'stat', params: {'hero': $data, 'stat': 'attackTime' } }\"></td></tr>\n    <tr><td>Attack &frasl; Sec:</td><td class=\"text-right\" data-bind=\"component: { name: 'stat', params: {'hero': $data, 'stat': 'attacksPerSecond' } }\"></td></tr>\n    <tr><td>Attack Range:</td><td class=\"text-right\" data-bind=\"component: { name: 'stat', params: {'hero': $data, 'stat': 'totalattackrange' } }\"></td></tr>\n    </tbody>\n    </table>\n</div>" });
ko.components.register('stats-additional', { template: "<table class=\"table table-condensed\">\n    <tbody>\n        <tr><td>Base Strength:</td><td class=\"text-right\"><span data-bind=\"text: heroData().attributebasestrength\"></span></td></tr>\n        <tr><td>Strength Gain:</td><td class=\"text-right\"><span data-bind=\"text: heroData().attributestrengthgain\"></span></td></tr>\n        <tr><td>Base Agility:</td><td class=\"text-right\"><span data-bind=\"text: heroData().attributebaseagility\"></span></td></tr>\n        <tr><td>Agility Gain:</td><td class=\"text-right\"><span data-bind=\"text: heroData().attributeagilitygain\"></span></td></tr>\n        <tr><td>Base Intelligence:</td><td class=\"text-right\"><span data-bind=\"text: heroData().attributebaseintelligence\"></span></td></tr>\n        <tr><td>Intelligence Gain:</td><td class=\"text-right\"><span data-bind=\"text: heroData().attributeintelligencegain\"></span></td></tr>\n        <tr><td>Base Armor:</td><td class=\"text-right\"><span data-bind=\"text: heroData().armorphysical\"></span></td></tr>\n        <tr><td><abbr title=\"Base Armor + armor from base agility\">Starting Armor:</abbr></td><td class=\"text-right\"><span data-bind=\"text: parseFloat($data.startingArmor()).toString()\"></span></td></tr>\n        <tr><td>Base Magic Res:</td><td class=\"text-right\"><span data-bind=\"text: heroData().magicalresistance + '%'\"></span></td></tr>\n        <tr><td>Base Attack Point:</td><td class=\"text-right\"><span data-bind=\"text: heroData().attackpoint\"></span></td></tr>\n        <tr><td><abbr data-bind=\"attr: { title: 'Total experience required to reach level ' + $data.selectedHeroLevel() }\">Total Exp:</abbr></td><td class=\"text-right\"><span data-bind=\"text: $data.totalExp()\"></span></span></td></tr>\n        <tr><td><abbr title=\"Experience required for next level\">Next level exp:</abbr></td><td class=\"text-right\"><span data-bind=\"html: $data.nextLevelExp()\"></span></span></td></tr>\n        <tr><td>Respawn Time:</td><td class=\"text-right\"><span data-bind=\"text: $data.respawnTime()\"></span></td></tr>\n    </tbody>\n</table>" });

// The app extends the herocalc library, provides a frontend
var my = require("dota-hero-calculator-library");
var findWhere = require("dota-hero-calculator-library/src/herocalc/util/findWhere");
var uniqueId = require("dota-hero-calculator-library/src/herocalc/util/uniqueId");
var itemData = require("dota-hero-calculator-library/src/herocalc/data/main").itemData;
var unitData = require("dota-hero-calculator-library/src/herocalc/data/main").unitData;
var heroData = require("dota-hero-calculator-library/src/herocalc/data/main").heroData;
var stackableItems = require("dota-hero-calculator-library/src/herocalc/inventory/stackableItems");
var levelItems = require("dota-hero-calculator-library/src/herocalc/inventory/levelItems");
var getItemTooltipData = require("./herocalc_tooltips_item");
var getAbilityTooltipData = require("./herocalc_tooltips_ability");
var HeroViewModel = require("./HeroViewModel");
var CloneViewModel = require("./CloneViewModel");
var UnitViewModel = require("./UnitViewModel");
var AbilityModel = require("dota-hero-calculator-library/src/herocalc/AbilityModel");
AbilityModel.prototype.getAbilityTooltipData = function (hero, el) {
    return getAbilityTooltipData(heroData, unitData, hero, el);
}

var PlayerColors = [
    "#2E6AE6", //Blue
    "#5DE6AD", //Teal
    "#AD00AD", //Purple
    "#DCD90A", //Yellow
    "#E66200", //Orange
    "#E67AB0", //Pink
    "#92A440", //Pus Yellow
    "#5CC5E0", //Light Blue
    "#00771F", //Green
    "#956000" //Brown
];

var Tab = function (id, href, data, text, color, template) {
    var self = this;
    self.id = id;
    self.href = href;
    self.color = color;
    self.data = data;
    self.data.id = ko.observable(self.href);
    self.text = text;
    self.template = template;
    return self;
}
Tab.prototype.toJS = function () {
    return {
        id: this.id,
        href: this.href,
        color: this.color,
        text: this.text,
        template: this.template
    }
}

var TabGroup = function (hero, unit, clone) {
    var self = this;
    self.hero = hero;
    self.unit = unit;
    self.clone = clone;
    self.illusions = ko.observableArray([]);
    return self;
}
TabGroup.prototype.toJS = function () {
    return {
        hero: this.hero.toJS(),
        unit: this.unit.toJS(),
        clone: this.clone.toJS(),
        illusions: this.illusions().map(function (illusion) { return illusion.toJS(); })
    }
}

var HeroCalculatorViewModel = function (tooltipURL) {
    var self = this;
    self.heroes = [];
    
    getAbilityTooltipData.init(tooltipURL);

    for (var i = 0; i < 10; i++) {
        self.heroes.push(new HeroViewModel(heroData, itemData, unitData, i));
    }
    
    for (var i = 0; i < 5; i++) {
        var arr = [];
        for (var j = 5; j < 10; j++) {
            arr.push(self.heroes[j]);
        }
        self.heroes[i].enemies.push.apply(self.heroes[i].enemies, arr);
    }
    for (var i = 5; i < 10; i++) {
        var arr = [];
        for (var j = 0; j < 5; j++) {
            arr.push(self.heroes[j]);
        }
        self.heroes[i].enemies.push.apply(self.heroes[i].enemies, arr);
    }
    for (var i = 0; i < 10; i++) {
        var arr = [];
        for (var j = 0; j < 10; j++) {
            if (i !== j) arr.push(self.heroes[j]);
        }
        self.heroes[i].otherHeroes.push.apply(self.heroes[i].otherHeroes, arr);
    }
    
    for (var i = 0; i < 10; i++) {
        self.heroes[i].clone = ko.observable(new CloneViewModel(heroData, itemData, unitData, 'meepo', self.heroes[i]));
        self.heroes[i].unit = ko.observable(new UnitViewModel(heroData, itemData, unitData, 'abaddon', self.heroes[i]));
        
        self.heroes[i].selectedCompare(self.heroes[i].availableCompare()[i < 5 ? 4 + i : i - 5]);
        self.heroes[i].selectedEnemy(self.heroes[i].availableEnemies()[i % 5]);
        //self.heroes[i].enemy = ko.observable(self.heroes[i < 2 ? 2 : 0]);
        self.heroes[i].unit().enemy(self.heroes[i].enemy());
        //self.heroes[i].unit().enemy = ko.observable(self.heroes[i < 2 ? 2 : 0]);
        //self.heroes[i].heroCompare = ko.observable(self.heroes[1 - (i % 2) + (i < 2 ? 0 : 2)]);
        
        self.heroes[i].unit().selectedUnit(self.heroes[i].unit().availableUnits()[0]);
        //self.heroes[i].selectedHero(self.heroes[i].availableHeroes()[i < 2 ? 0 : 2]);
        self.heroes[i].illusions.subscribe(function (changes) {
            for (var i = 0; i < changes.length; i++) {
                if (changes[i].status == 'added') {
                    var color = this.index < 2 ? '#5cb85c' : '#d9534f',
                        j = uniqueId();
                    self.tabs()[this.index].illusions.push(
                        new Tab(
                            'illusionTab' + this.index + '-' + j,
                            'illusionPane' + this.index + '-' + j,
                            self.heroes[this.index].illusions()[self.tabs()[this.index].illusions().length](),
                            'Illusion ' + j,
                            color,
                            'illusion-pane')
                    );
                }
            }
        }, {vm: this, index: i}, "arrayChange");
    }
    //self.heroes[0].showUnitTab(true);
    self.heroes[0].bound(true);
    self.tabs = ko.observableArray([]);
    var tabsArr = [];
    for (var i = 0; i < 10; i++) {
        //var color = i < 5 ? '#5cb85c' : '#d9534f';
        var color = PlayerColors[i];
        var tabGroup = new TabGroup(
            new Tab('heroTab' + i, 'heroPane' + i, self.heroes[i], 'Hero ' + i, color, 'hero-pane'),
            new Tab('unitTab' + i, 'unitPane' + i, self.heroes[i].unit(), 'Unit ' + i, color, 'unit-pane'),
            new Tab('cloneTab' + i, 'clonePane' + i, self.heroes[i].clone(), 'Meepo Clone ' + i, color, 'clone-pane')
        );
        //self.tabs.push(tabGroup);
        tabsArr.push(tabGroup);
    }
    self.tabs.push.apply(self.tabs, tabsArr);//.slice(0, 1));

    self.selectedItem = ko.observable();
    self.layout = ko.observable("1");
    self.displayShop = ko.observable(true);
    self.displayShopItemTooltip = ko.observable(true);
    self.allItems = ko.observableArray([
        {name: 'Str, Agi, Int, MS, Turn, Sight', value: 'stats0'},
        {name: 'Armor, Health, Mana, Regen, EHP', value: 'stats1'},
        {name: 'Phys Res, Magic Res, Lifesteal, Evasion, Bash, Miss', value: 'stats2'},
        {name: 'Damage, IAS, BAT, Attack', value: 'stats3'}
    ]); // Initial items
    self.selectedItems = ko.observableArray([]); 
    self.moveUp = function () {
        var start = self.allItems.indexOf(self.selectedItems()[0]),
            end = self.allItems.indexOf(self.selectedItems()[self.selectedItems().length - 1]);
        if (start > 0) {
            var e = self.allItems.splice(start - 1, 1);
            self.allItems.splice(end, 0, e[0]);            
        }
    };
    self.moveDown = function () {
        var start = self.allItems.indexOf(self.selectedItems()[0]),
            end = self.allItems.indexOf(self.selectedItems()[self.selectedItems().length - 1]);        
        if (end < self.allItems().length - 1) {
            var e = self.allItems.splice(end + 1, 1);
            self.allItems.splice(start, 0, e[0]);
        }
    };
    self.selectedTabId = ko.observable('heroTab0');
    self.getSelectedTab = function (tabId) {
        var indices = tabId.replace('heroTab', '').replace('cloneTab', '').replace('unitTab', '').replace('illusionTab', '').split('-'),
            index = indices[0],
            tab = self.tabs()[index];
        return tab;
    }
    self.selectedTab = ko.computed(function () {
        /*var indices = self.selectedTabId().replace('heroTab', '').replace('cloneTab', '').replace('unitTab', '').replace('illusionTab', '').split('-'),
            index = indices[0],
            tab = self.tabs()[index];*/
        var tab = self.getSelectedTab(self.selectedTabId());
        if (self.selectedTabId().indexOf('hero') != -1) {
            return tab.hero;
        }
        else if (self.selectedTabId().indexOf('unit') != -1) {
            return tab.unit;
        }
        else if (self.selectedTabId().indexOf('clone') != -1) {
            return tab.clone;
        }
        else if (self.selectedTabId().indexOf('illusion') != -1) {
            return tab.illusions().find(function (tab) {
                return tab.id == self.selectedTabId();
            });
        }
        else {
            return self.tabs()[0].hero;
        }
    });
    self.selectedTabs = ko.observableArray(['heroTab0', 'heroTab1']);
    //self.selectedTabs.push('heroTab0');
    //self.selectedTabs.push('heroTab1');
    self.boundSettings = ko.observable(false);
    self.clickTab = function (data, event, index) {
        /*if (event.target.id != 'settingsTab') {
            self.selectedTabId(event.target.id);
        }*/
        self.selectedTabId(event.target.id);
        if (self.selectedTabs()[1] != event.target.id) {
            self.selectedTabs.shift();
            self.selectedTabs.push(event.target.id);
        }
        if (self.selectedTab().data.hasOwnProperty('bound')) {
            self.selectedTab().data.bound(true);

            // make sure build explorer graph renders
            if (self.selectedTab().data.hasOwnProperty('buildExplorer')) {
                setTimeout(function () {
                    self.selectedTab().data.buildExplorer.graphData.valueHasMutated();
                }, 0);
            }
        }
        if (event.target.id === 'settingsTab') self.boundSettings(true);
    };
    self.isSecondTab = function (id) {
        return self.selectedTabs().indexOf(id) > -1 && self.selectedTabId() != id;
    }
    
    self.showSideTabId = function (id) {
        return self.selectedTabs().indexOf(id) > -1 && self.sideView();
    };
    
    self.removeTab = function (index, data, event, tab) {
        if (data.id == self.selectedTabId()) {
            //self.selectedTabId('heroTab0');
            self.clickTab(null, {target: {id: 'heroTab0'}});
            $('#heroTab0').tab('show');
        }
        self.tabs()[tab].illusions.remove(function (illusion) {
            return illusion == data;
        });
        self.heroes[tab].illusions.remove(function (illusion) {
            return illusion() == data.data;
        });
    };
    
    self.sideView = ko.observable(false);
    self.sideView.subscribe(function (newValue) {
        if (newValue) {
            if (!self.shopPopout()) {
                self.displayShop(false);
            }
            for (var i = 0; i < self.selectedTabs().length; i++) {
                var tab = self.getSelectedTab(self.selectedTabs()[i]);
                if (tab && tab.hero.data.hasOwnProperty('bound')) {
                    tab.hero.data.bound(true);
                }
            }
            self.layout("0");
        }
    });
    var $window = $(window);
    self.windowWidth = ko.observable($window.width());
    self.windowHeight = ko.observable($window.height());
    $window.resize(function () { 
        self.windowWidth($window.width());
        self.windowHeight($window.height());
    });
    self.shopDock = ko.observable(false);
    self.shopDock.subscribe(function (newValue) {
        if (newValue) {
            self.shopPopout(false);
        }
        else {
        }
    });

    self.shopDockTrigger = ko.computed(function () {
        self.windowWidth();
        self.shopDock();
    });
    self.shopPopout = ko.observable(false);
    self.shopPopout.subscribe(function (newValue) {
        if (newValue) {
            self.displayShop(true);
            $( "#shop-dialog" ).dialog({
                minWidth: 380,
                minHeight: 0,
                closeText: "",
                open: function ( event, ui ) {
                    $(event.target.offsetParent).find('.ui-dialog-titlebar').find('button')
                        .addClass('close glyphicon glyphicon-remove shop-button btn btn-default btn-xs pull-right')
                        .removeClass('ui-button ui-widget ui-state-default ui-corner-all ui-button-icon-only ui-dialog-titlebar-close close')
                        .css('margin-right','0px')
                        .parent()
                            .append($('#shop-minimize'))
                            .append($('#shop-maximize'));
                    $(event.target.offsetParent).find('.ui-dialog-titlebar').dblclick(function () {
                        self.displayShop(!self.displayShop());
                    });
                },
                close: function ( event, ui ) {
                    self.shopPopout(false);
                }
            });
        }
        else {
            $('#shop-container').prepend($('#shop-minimize')).prepend($('#shop-maximize'));
            $( "#shop-dialog" ).dialog("destroy");
        }
    });

    self.addItem = function (data, event) {
        self.selectedTab().data.buildExplorer.getSelectedInventory().addItem(data, event);
    }
    self.itemOptions = ko.computed(function () {
        return self.selectedTab().data.inventory.itemOptions();
    });
    
    self.changeSelectedItem = function (data, event) {
        self.itemInputValue(1);
        self.selectedItem(event.target.id);
    }
    
    self.getItemTooltipData = ko.computed(function () {
        return getItemTooltipData(itemData, self.selectedItem());
    }, this);
    self.getItemInputLabel = ko.computed(function () {
        if (stackableItems.indexOf(self.selectedItem()) != -1) {
            return 'Stack Size'
        }
        else if (levelItems.indexOf(self.selectedItem()) != -1) {
            return 'Upgrade Level'
        }
        else if (self.selectedItem() == 'bloodstone') {
            return 'Charges'
        }
        else {
            return ''
        }
    }, this);
    self.itemInputValue = ko.observable(1);
    self.saveLink = ko.observable();
    self.getAppState = function () {
        var data = {
            selectedItem: self.selectedItem,
            layout: self.layout,
            displayShop: self.displayShop,
            displayShopItemTooltip: self.displayShopItemTooltip,
            allItems: self.allItems,
            selectedItems: self.selectedItems,
            selectedTabId: self.selectedTabId,
            selectedTabs: self.selectedTabs,
            boundSettings: self.boundSettings,
            sideView: self.sideView,
            windowWidth: self.windowWidth,
            windowHeight: self.windowHeight,
            shopDock: self.shopDock,
            shopPopout: self.shopPopout,
            itemInputValue: self.itemInputValue,
            saveLink: self.saveLink
        }
        data.tabs = self.tabs().map(function (tab) { return tab.toJS() });
        return ko.toJS(data);
    }
    self.getSaveData = function () {
        var data = {
            version: "1.3.0",
            heroes: []
        }
        for (var i = 0; i < 10; i++) {
            var hero = self.heroes[i];
            var d = {
                hero: hero.selectedHero().heroName,
                level: hero.selectedHeroLevel(),
                items: [],
                abilities: [],
                skillPointHistory: hero.skillPointHistory(),
                buffs: [],
                itemBuffs: [],
                debuffs: [],
                itemDebuffs: [],
                graphData: [],
                enemyIndex: hero.enemy().index(),
                heroCompareIndex: hero.heroCompare().index()
            }
            // items
            for (var j = 0; j < hero.inventory.items().length; j++) {
                d.items.push(ko.toJS(hero.inventory.items()[j]));
            }
            // abilities
            for (var j = 0; j < hero.ability().abilities().length; j++) {
                d.abilities.push({
                    level: hero.ability().abilities()[j].level(),
                    isActive: hero.ability().abilities()[j].isActive()
                });
            }
            // buffs
            for (var j = 0; j < hero.buffs.buffs().length; j++) {
                d.buffs.push({
                    name: hero.buffs.buffs()[j].name,
                    level: hero.buffs.buffs()[j].data.level(),
                    isActive: hero.buffs.buffs()[j].data.isActive()
                });
            }
            
            // debuffs
            for (var j = 0; j < hero.debuffs.buffs().length; j++) {
                d.debuffs.push({
                    name: hero.debuffs.buffs()[j].name,
                    level: hero.debuffs.buffs()[j].data.level(),
                    isActive: hero.debuffs.buffs()[j].data.isActive()
                });
            }

            // item buffs
            for (var j = 0; j < hero.buffs.itemBuffs.items().length; j++) {
                d.itemBuffs.push(ko.toJS(hero.buffs.itemBuffs.items()[j]));
            }
            
            // item debuffs
            for (var j = 0; j < hero.debuffs.itemBuffs.items().length; j++) {
                d.itemDebuffs.push(ko.toJS(hero.debuffs.itemBuffs.items()[j]));
            }
            
            // graph data
            d.graphData = ko.toJS(hero.buildExplorer.graphData);
            
            data.heroes.push(d);
        }
        return data;
    }
    self.save = function () {
        var data = self.getSaveData();
        var serialized = JSON.stringify(data);
        $.ajax({
            type: "POST",
            url: "save.php",
            data: {'data': serialized},
            dataType: "json",
            success: function (data){
                self.saveLink([location.protocol, '//', location.host, location.pathname].join('') + '?id=' + data.file);
            },
            failure: function (errMsg) {
                alert("Save request failed.");
            }
        });
    }
    self.load = function (data) {
        for (var i = 0; i < data.heroes.length; i++) {
            var hero = self.heroes[i];
            hero.selectedHero(findWhere(hero.availableHeroes(), {'heroName': data.heroes[i].hero}));
            hero.selectedHeroLevel(data.heroes[i].level);
            hero.inventory.items.removeAll();
            hero.inventory.activeItems.removeAll();
            
            // load hero compare
            if (data.heroes[i].hasOwnProperty('heroCompareIndex')) {
                var o = hero.availableCompare().filter(function (option) {
                    return option.hero.index() == data.heroes[i].heroCompareIndex;
                });
                if (o.length) {
                    hero.selectedCompare(o[0]);
                    hero.heroCompare(o[0].hero);
                }
            }
            
            // load enemy
            if (data.heroes[i].hasOwnProperty('enemyIndex')) {
                var o = hero.availableEnemies().filter(function (option) {
                    return option.hero.index() == data.heroes[i].enemyIndex;
                });
                if (o.length) {
                    hero.selectedEnemy(o[0]);
                    hero.enemy(o[0].hero);
                }
            }
            
            // load items
            for (var j = 0; j < data.heroes[i].items.length; j++) {
                var item = data.heroes[i].items[j];
                var new_item = {
                    item: item.item,
                    state: ko.observable(item.state),
                    size: item.size,
                    enabled: ko.observable(item.enabled)
                }
                hero.inventory.items.push(new_item);
            }

            // load abilities
            for (var j = 0; j < data.heroes[i].abilities.length; j++) {
                hero.ability().abilities()[j].level(data.heroes[i].abilities[j].level);
                hero.ability().abilities()[j].isActive(data.heroes[i].abilities[j].isActive);
            }
            hero.skillPointHistory(data.heroes[i].skillPointHistory);

            // load buffs
            for (var j = 0; j < data.heroes[i].buffs.length; j++) {
                hero.buffs.selectedBuff(findWhere(hero.buffs.availableBuffs(), {buffName: data.heroes[i].buffs[j].name}));
                hero.buffs.addBuff(hero, {});
                var b = findWhere(hero.buffs.buffs(), { name: data.heroes[i].buffs[j].name });
                b.data.level(data.heroes[i].buffs[j].level);
                b.data.isActive(data.heroes[i].buffs[j].isActive);
            }

            // load debuffs
            for (var j = 0; j < data.heroes[i].debuffs.length; j++) {
                hero.debuffs.selectedBuff(findWhere(hero.debuffs.availableDebuffs(), {buffName: data.heroes[i].debuffs[j].name}));
                hero.debuffs.addBuff(hero, {});
                var b = findWhere(hero.debuffs.buffs(), { name: data.heroes[i].debuffs[j].name });
                b.data.level(data.heroes[i].debuffs[j].level);
                b.data.isActive(data.heroes[i].debuffs[j].isActive);
            }

            // load item buffs
            if (data.heroes[i].itemBuffs) {
                for (var j = 0; j < data.heroes[i].itemBuffs.length; j++) {
                    var item = data.heroes[i].itemBuffs[j];
                    var new_item = {
                        item: item.item,
                        state: ko.observable(item.state),
                        size: item.size,
                        enabled: ko.observable(item.enabled)
                    }
                    hero.buffs.itemBuffs.items.push(new_item);
                }
            }

            // load item debuffs
            if (data.heroes[i].itemDebuffs) {
                for (var j = 0; j < data.heroes[i].itemDebuffs.length; j++) {
                    var item = data.heroes[i].itemDebuffs[j];
                    var new_item = {
                        item: item.item,
                        state: ko.observable(item.state),
                        size: item.size,
                        enabled: ko.observable(item.enabled)
                    }
                    hero.debuffs.itemBuffs.items.push(new_item);
                }
            }
            
            // load graph data
            if (data.heroes[i].graphData) {
                hero.buildExplorer.loadGraphData(data.heroes[i].graphData);
            }
        }
    }
    
    self.sendReport = function () {
        if ($('#BugReportFormText').val()) {
            $.post( "report.php", { name: $('#BugReportFormName').val(), email: $('#BugReportFormEmail').val(), body: $('#BugReportFormText').val() })
            .done(function (data) {
                if (data == 'Success') {
                    alert('Report successfully sent. Thanks!');
                    $('#BugReportFormText').val('');
                }
                else {
                    alert('Failed to send report. Try again later or email admin@devilesk.com');
                }
            });
            $('#myModal').modal('hide');
        }
        else {
            alert('Message is required.');
        }
    }
    
    self.getProperty = function (obj, properties) {
        var result = obj;
        for (var i = 0; i < properties.length; i++) {
            result = result[properties[i]];
        }
        return result;
    };
    
    self.getDiffTextWrapper = function (hero, property) {
        return self.getDiffText(self.getDiffMagnitude(hero, property));
    }
    
    self.getDiffMagnitude = function (hero, property) {
        var properties = property.split('.');
        return self.getProperty(hero.damageTotalInfo(), properties).toFixed(2) - self.getProperty(hero.heroCompare().damageTotalInfo(), properties).toFixed(2);
    }
    
    self.getDiffText = function (value) {
        if (value > 0) {
            return '+' + parseFloat(value.toFixed(2));
        }
        else if (value < 0) {
            return '&minus;' + parseFloat(value.toFixed(2)*-1).toString();
        }
        else {
            return '';
        }
    }
    self.highlightedTabInternal = ko.observable('');
    self.highlightedTab = ko.computed(function () {
        return self.highlightedTabInternal();
    }).extend({ throttle: 100 });
    self.highlightTab = function (data) {
        self.highlightedTabInternal(data);
    }
    self.unhighlightTab = function (data) {
        self.highlightedTabInternal('');
    }
}

module.exports = HeroCalculatorViewModel;
}).call(this,typeof global !== "undefined" ? global : typeof self !== "undefined" ? self : typeof window !== "undefined" ? window : {})

},{"../components/shop":85,"./CloneViewModel":71,"./HeroViewModel":75,"./UnitViewModel":77,"./herocalc_knockout":79,"./herocalc_tooltips_ability":80,"./herocalc_tooltips_item":81,"./jquery-ui.custom":82,"dota-hero-calculator-library":35,"dota-hero-calculator-library/src/herocalc/AbilityModel":1,"dota-hero-calculator-library/src/herocalc/data/main":6,"dota-hero-calculator-library/src/herocalc/inventory/levelItems":32,"dota-hero-calculator-library/src/herocalc/inventory/stackableItems":33,"dota-hero-calculator-library/src/herocalc/util/findWhere":37,"dota-hero-calculator-library/src/herocalc/util/uniqueId":42}],74:[function(require,module,exports){
'use strict';
var ko = require('./herocalc_knockout');
var extend = require("dota-hero-calculator-library/src/herocalc/util/extend");
var findWhere = require("dota-hero-calculator-library/src/herocalc/util/findWhere");

var DamageInstance = function (label, damageType, value, data, total) {
    this.label = label || '';
    this.damageType = damageType || '';
    this.value = parseFloat(value) || 0;
    this.data = data || [];
    this.total = parseFloat(total) || 0;
}

var HeroDamageAmpMixin = function (self) {
    self.damageBrackets = [
        ['medusa_mana_shield', 'templar_assassin_refraction', 'faceless_void_backtrack', 'nyx_assassin_spiked_carapace'],
        ['spectre_dispersion', 'wisp_overcharge', 'slardar_sprint','bristleback_bristleback', 'undying_flesh_golem'],
        ['abaddon_borrowed_time', 'abaddon_aphotic_shield', 'kunkka_ghostship', 'treant_living_armor'],
        ['chen_penitence', 'medusa_stone_gaze', 'shadow_demon_soul_catcher'],
        ['dazzle_shallow_grave']
    ];
    
    self.getDamageAfterBracket = function (initialDamage,index) {
        var bracket = self.damageBrackets[index];
        var multiplier = 1;
        for (var i = 0; i < bracket.length; i++) {
            if (findWhere(self.damageAmplification.buffs, {name: bracket[i].name}) != undefined || findWhere(self.damageReduction.buffs, {name: bracket[i].name}) != undefined) {
                multiplier += bracket[i].value;
            }
        };
        return initialDamage * multiplier;
    };
    
    self.processDamageAmpReducBracket = function (index, sources, damage) {
        var multiplier = 1,
            data = [],
            damage = parseFloat(damage),
            total = parseFloat(damage);
            
        for (var i = 0; i < self.damageBrackets[index].length; i++) {
            if (sources[self.damageBrackets[index][i]] != undefined) {
                multiplier = 1 + parseFloat(sources[self.damageBrackets[index][i]].multiplier);
                total += (damage * multiplier) - damage;
                data.push(new DamageInstance(
                    sources[self.damageBrackets[index][i]].displayname,
                    sources[self.damageBrackets[index][i]].damageType,
                    (damage * multiplier) - damage,
                    [],
                    total
                ));
            }
        }
        return data;
    }
    
    self.getDamageAmpReducInstance = function(sources, initialDamage, ability, damageType) {
        var data = [],
            damage = parseFloat(initialDamage),
            prevDamage = damage,
            label = ability == 'initial' ? 'Initial' : sources[ability].displayname;

        // Bracket 0
        data = data.concat(self.processDamageAmpReducBracket(0, sources, damage));
        damage = data[data.length - 1] ? data[data.length - 1].total : damage;

        // Bracket 1
        data = data.concat(self.processDamageAmpReducBracket(1, sources, damage));
        damage = data[data.length - 1] ? data[data.length - 1].total : damage;
        
        // Bracket 2
        data = data.concat(self.processDamageAmpReducBracket(2, sources, damage));
        damage = data[data.length - 1] ? data[data.length - 1].total : damage;

        return new DamageInstance(label, damageType, initialDamage, data, data[data.length - 1] ? data[data.length - 1].total : damage);
    }
    
    self.getDamageAmpReduc = function (initialDamage) {
        var instances = [],
            sources = {},
            sourcesAmp = self.damageReduction.getDamageMultiplierSources(),
            sourcesReduc = self.damageAmplification.getDamageMultiplierSources();
        extend(sources, sourcesAmp);
        extend(sources, sourcesReduc);
        // Initial damage instance
        instances.push(self.getDamageAmpReducInstance(sources, initialDamage, 'initial', 'physical'));
        
        // Bracket 4 damage instances
        var b4 = ['shadow_demon_soul_catcher', 'medusa_stone_gaze', 'chen_penitence'];
        for (var i = 0; i < b4.length; i++) {
            if (sources[b4[i]] != undefined) {
                instances.push(self.getDamageAmpReducInstance(sources, initialDamage * sources[b4[i]].multiplier, b4[i], sources[b4[i]].damageType));
            }
        }
    
        return new DamageInstance('Total', 'physical', initialDamage, instances, instances.reduce(function(memo, i) {return parseFloat(memo) + parseFloat(i.total);}, 0));
    };
    
    self.damageInputValue = ko.observable(0);
    self.damageInputModified = ko.computed(function () {
        return self.getDamageAmpReduc(self.damageInputValue());
    });
}

module.exports = HeroDamageAmpMixin;
},{"./herocalc_knockout":79,"dota-hero-calculator-library/src/herocalc/util/extend":36,"dota-hero-calculator-library/src/herocalc/util/findWhere":37}],75:[function(require,module,exports){
(function (global){
"use strict";
var ko = (typeof window !== "undefined" ? window['ko'] : typeof global !== "undefined" ? global['ko'] : null);
var HeroCalc = require("dota-hero-calculator-library");
var DamageAmpViewModel = require("./DamageAmpViewModel");
var BuildExplorerViewModel = require("./BuildExplorerViewModel");
var HeroDamageAmpMixin = require("./HeroDamageAmpMixin");
var illusionOptionsArray = require("dota-hero-calculator-library/src/herocalc/illusion/illusionOptionsArray");
var illusionData = require("dota-hero-calculator-library/src/herocalc/illusion/illusionData");
var IllusionViewModel = require("./IllusionViewModel");

var HeroOption2 = function (hero) {
    this.heroName = ko.computed(function () {
        return hero.selectedHero().heroName;
    });
    this.heroDisplayName = ko.computed(function () {
        return hero.selectedHero().heroDisplayName;
    });
    this.hero = hero;
};

var HeroViewModel = function (heroData, itemData, unitData, h) {
    var self = this;
    self.index = ko.observable(h);
    self.availableHeroes = ko.observableArray(HeroCalc.HeroOptions);
    self.availableHeroes.sort(function (left, right) {
        return left.heroDisplayName == right.heroDisplayName ? 0 : (left.heroDisplayName < right.heroDisplayName ? -1 : 1);
    });
    self.selectedHero = ko.observable(self.availableHeroes()[h]);
    
    HeroCalc.HeroModel.call(this, heroData, itemData, self.selectedHero().heroName);
    
    self.selectedHero.subscribe(function (newValue) {
        self.heroId(newValue.heroName);
    });
    
    self.illusions = ko.observableArray([]);
    self.availableIllusions = ko.observableArray(illusionOptionsArray);
    self.selectedIllusion = ko.observable(self.availableIllusions()[0]);
    self.illusionAbilityLevel = ko.observable(1);
    self.illusionAbilityMaxLevel = ko.computed(function () {
        return illusionData[self.selectedIllusion().illusionName].max_level;
    });
    self.addIllusion = function (data, event) {
        self.illusions.push(ko.observable(new IllusionViewModel(heroData, itemData, 0, self, self.illusionAbilityLevel())));
    };
    
    self.bound = ko.observable(false);
    self.playerColorCss = ko.computed(function () {
        return 'player-color-' + self.index();
    });
    self.heroOption = new HeroOption2(self);
    self.otherHeroes = ko.observableArray([]);
    self.availableCompare = ko.computed(function () {
        return self.otherHeroes().map(function (o) {
            return o.heroOption;
        });
    });
    self.selectedCompare = ko.observable();
    self.selectedCompare.subscribe(function (newValue) {
        self.heroCompare(newValue.hero);
    });
    self.enemies = ko.observableArray([]);
    self.availableEnemies = ko.computed(function () {
        return self.enemies().map(function (o) {
            return o.heroOption;
        });
    });
    self.selectedEnemy = ko.observable();
    self.selectedEnemy.subscribe(function (newValue) {
        self.enemy(newValue.hero);
    });
    self.setHeroOptionStyling = function(option, item) {
        ko.applyBindingsToNode(option, {css: item.hero.playerColorCss() }, item);
    }
    self.sectionDisplay = ko.observable({
        'inventory': ko.observable(true),
        'ability': ko.observable(true),
        'talent': ko.observable(true),
        'buff': ko.observable(true),
        'debuff': ko.observable(true),
        'damageamp': ko.observable(false),
        'illusion': ko.observable(false),
        'skillbuild': ko.observable(false),
        'skillbuild-skills': ko.observable(true),
        'skillbuild-items': ko.observable(true)
    });
    self.sectionDisplayToggle = function (section) {
        self.sectionDisplay()[section](!self.sectionDisplay()[section]());
    }
    self.showUnitTab = ko.observable(false);
    self.showDiff = ko.observable(false);
    self.showCriticalStrikeDetails = ko.observable(false);
    self.showDamageDetails = ko.observable(false);
    self.showStatDetails = ko.observable(false);
    self.showDamageAmpCalcDetails = ko.observable(false);
    
    self.damageAmplification = new DamageAmpViewModel(heroData, itemData, unitData);
    self.damageReduction = new DamageAmpViewModel(heroData, itemData, unitData);
    self.buildExplorer = new BuildExplorerViewModel(self);
    HeroDamageAmpMixin(self);
}
HeroViewModel.prototype = Object.create(HeroCalc.HeroModel.prototype);
HeroViewModel.prototype.constructor = HeroViewModel;

module.exports = HeroViewModel;
}).call(this,typeof global !== "undefined" ? global : typeof self !== "undefined" ? self : typeof window !== "undefined" ? window : {})

},{"./BuildExplorerViewModel":70,"./DamageAmpViewModel":72,"./HeroDamageAmpMixin":74,"./IllusionViewModel":76,"dota-hero-calculator-library":35,"dota-hero-calculator-library/src/herocalc/illusion/illusionData":23,"dota-hero-calculator-library/src/herocalc/illusion/illusionOptionsArray":24}],76:[function(require,module,exports){
'use strict';
var ko = require('./herocalc_knockout');
    
var HeroCalc = require("dota-hero-calculator-library");
var illusionData = require("dota-hero-calculator-library/src/herocalc/illusion/illusionData");
var heroData = require("dota-hero-calculator-library/src/herocalc/data/main").heroData;
var itemData = require("dota-hero-calculator-library/src/herocalc/data/main").itemData;
var findWhere = require("dota-hero-calculator-library/src/herocalc/util/findWhere");

var IllusionViewModel = function (heroData, itemData, h, p, abilityLevel) {
    var self = this;
    self.parent = p;
    self.illusionType = ko.observable(self.parent.selectedIllusion().illusionName);
    if (!illusionData[self.illusionType()].use_selected_hero) {
        HeroCalc.IllusionModel.call(this, heroData, itemData, self.parent.selectedIllusion().baseHero, p, abilityLevel);
        self.selectedHero = ko.observable(findWhere(self.parent.availableHeroes(), {heroName: self.parent.selectedIllusion().baseHero}));
    }
    else {
        HeroCalc.IllusionModel.call(this, heroData, itemData, self.parent.selectedHero().heroName, p, abilityLevel);
        self.selectedHero = ko.observable(self.parent.selectedHero());
    }
    
    self.inventory = self.parent.inventory;
    self.illusionDisplayName = ko.observable(self.parent.selectedIllusion().illusionDisplayName);
    self.illusionAbilityMaxLevel = ko.observable(illusionData[self.parent.selectedIllusion().illusionName].max_level);
    /*if (!illusionData[self.illusionType()].use_selected_hero) {
        self.selectedHero(findWhere(self.parent.availableHeroes(), {heroName: self.parent.selectedIllusion().baseHero}));
    }
    else {
        self.selectedHero(self.parent.selectedHero());
    }*/
    self.selectedHeroLevel(self.parent.selectedHeroLevel());
    /*self.hero = ko.computed(function() {
        return ko.wrap.fromJS(heroData['npc_dota_hero_' + self.selectedHero().heroName]);
    });*/
    
    self.ability().getAttributeBonusLevel = self.parent.ability().getAttributeBonusLevel;
    
    self.sectionDisplay = ko.observable({
        'inventory': ko.observable(true),
        'ability': ko.observable(true),
        'buff': ko.observable(true),
        'debuff': ko.observable(true),
        'damageamp': ko.observable(false),
        'illusion': ko.observable(false),
        'skillbuild': ko.observable(false),
        'skillbuild-skills': ko.observable(true),
        'skillbuild-items': ko.observable(true)
    });
    self.sectionDisplayToggle = function (section) {
        self.sectionDisplay()[section](!self.sectionDisplay()[section]());
    }
    self.showUnitTab = ko.observable(false);
    self.showDiff = ko.observable(false);
    self.showCriticalStrikeDetails = ko.observable(false);
    self.showDamageDetails = ko.observable(false);
    self.showStatDetails = ko.observable(false);
    return self;
}
IllusionViewModel.prototype = Object.create(HeroCalc.IllusionModel.prototype);
IllusionViewModel.prototype.constructor = IllusionViewModel;

module.exports = IllusionViewModel;
},{"./herocalc_knockout":79,"dota-hero-calculator-library":35,"dota-hero-calculator-library/src/herocalc/data/main":6,"dota-hero-calculator-library/src/herocalc/illusion/illusionData":23,"dota-hero-calculator-library/src/herocalc/util/findWhere":37}],77:[function(require,module,exports){
(function (global){
"use strict";
var ko = (typeof window !== "undefined" ? window['ko'] : typeof global !== "undefined" ? global['ko'] : null);
var HeroCalc = require("dota-hero-calculator-library");
var UnitOption = require("dota-hero-calculator-library/src/herocalc/hero/UnitOption");

var UnitViewModel = function (heroData, itemData, unitData, h, p) {
    var self = this;
    self.index = ko.observable(h);
    self.selectedUnitLevel = ko.observable(1);
    self.availableUnits = ko.observableArray([
        new UnitOption('npc_dota_lone_druid_bear', 'Lone Druid Spirit Bear',4,'/media/images/units/spirit_bear.png', self.selectedUnitLevel),
        new UnitOption('npc_dota_brewmaster_earth_','Brewmaster Earth Warrior',3,'/media/images/units/npc_dota_brewmaster_earth.png', self.selectedUnitLevel),
        new UnitOption('npc_dota_brewmaster_fire_','Brewmaster Fire Warrior',3,'/media/images/units/npc_dota_brewmaster_fire.png', self.selectedUnitLevel),
        new UnitOption('npc_dota_brewmaster_storm_','Brewmaster Storm Warrior',3,'/media/images/units/npc_dota_brewmaster_storm.png', self.selectedUnitLevel),
        new UnitOption('npc_dota_necronomicon_archer_','Necronomicon Archer',3,'/media/images/units/npc_dota_necronomicon_archer.png', self.selectedUnitLevel),
        new UnitOption('npc_dota_necronomicon_warrior_','Necronomicon Warrior',3,'/media/images/units/npc_dota_necronomicon_warrior.png', self.selectedUnitLevel),
        new UnitOption('npc_dota_lycan_wolf','Lycan Wolf',4,'/media/images/units/npc_dota_lycan_wolf.png', self.selectedUnitLevel),
        new UnitOption('npc_dota_visage_familiar','Visage Familiar',3,'/media/images/units/npc_dota_visage_familiar.png', self.selectedUnitLevel)
    ]);
    self.selectedUnit = ko.observable(self.availableUnits()[0]);
    HeroCalc.UnitModel.call(this, heroData, itemData, unitData, self.selectedUnit().heroName());
    
    self.selectedUnitLevel.subscribe(function(newValue) {
        self.unitLevel(newValue);
        self.unitId(self.selectedUnit().heroName());
    });
    self.selectedUnit.subscribe(function(newValue) {
        if (newValue.heroName().indexOf('npc_dota_lone_druid_bear') != -1) {
            self.inventory.hasInventory(true);
            self.inventory.items.removeAll();
            self.inventory.activeItems.removeAll();
        }
        else {
            self.inventory.hasInventory(false);
            self.inventory.items.removeAll();
            self.inventory.activeItems.removeAll();
        }
        self.unitId(newValue.heroName());
    });
    
    
    self.bound = ko.observable(false);
    self.playerColorCss = ko.computed(function () {
        return 'player-color-' + self.index();
    });
    self.setHeroOptionStyling = function(option, item) {
        ko.applyBindingsToNode(option, {css: item.hero.playerColorCss() }, item);
    }
    self.sectionDisplay = ko.observable({
        'inventory': ko.observable(true),
        'ability': ko.observable(true),
        'buff': ko.observable(true),
        'debuff': ko.observable(true),
        'damageamp': ko.observable(false),
        'illusion': ko.observable(false),
        'skillbuild': ko.observable(false),
        'skillbuild-skills': ko.observable(true),
        'skillbuild-items': ko.observable(true)
    });
    self.sectionDisplayToggle = function (section) {
        self.sectionDisplay()[section](!self.sectionDisplay()[section]());
    }
    self.showUnitTab = ko.observable(false);
    self.showDiff = ko.observable(false);
    self.showCriticalStrikeDetails = ko.observable(false);
    self.showDamageDetails = ko.observable(false);
    self.showStatDetails = ko.observable(false);

}
UnitViewModel.prototype = Object.create(HeroCalc.UnitModel.prototype);
UnitViewModel.prototype.constructor = UnitViewModel;

module.exports = UnitViewModel;
}).call(this,typeof global !== "undefined" ? global : typeof self !== "undefined" ? self : typeof window !== "undefined" ? window : {})

},{"dota-hero-calculator-library":35,"dota-hero-calculator-library/src/herocalc/hero/UnitOption":15}],78:[function(require,module,exports){
"use strict";

var getParameterByName = function (name) {
    name = name.replace(/[\[]/, "\\[").replace(/[\]]/, "\\]");
    var regex = new RegExp("[\\?&]" + name + "=([^&#]*)"),
        results = regex.exec(location.search);
    return results == null ? "" : decodeURIComponent(results[1].replace(/\+/g, " "));
}

module.exports = getParameterByName;
},{}],79:[function(require,module,exports){
(function (global){
'use strict';
var ko = (typeof window !== "undefined" ? window['ko'] : typeof global !== "undefined" ? global['ko'] : null);
var $ = (typeof window !== "undefined" ? window['$'] : typeof global !== "undefined" ? global['$'] : null);
var Chart = require('chart.js');
require('../lib/Chart.scatter');

ko.bindingHandlers.stopBinding = {
    init: function() {
        return { controlsDescendantBindings: true };
    }
};

ko.virtualElements.allowedBindings.stopBinding = true;

ko.bindingHandlers.lazyBinding = {
    init: function(element, valueAccessor, allBindingsAccessor, viewModel, bindingContext) {
        ko.utils.domData.set(element, 'isBound', false)
        
        // Also tell KO *not* to bind the descendants itself, otherwise they will be bound twice
        return { controlsDescendantBindings: true };
    },
    update: function(element, valueAccessor, allBindingsAccessor, viewModel, bindingContext) {
        var val = ko.unwrap(valueAccessor()),
            isBound = ko.utils.domData.get(element, 'isBound');
        if (val && !isBound) {
            ko.utils.domData.set(element, 'isBound', true);
            ko.applyBindingsToDescendants(bindingContext, element);
        }
    }
};

ko.virtualElements.allowedBindings.lazyBinding = true;

ko.bindingHandlers.itemBuildTable = {
    init: function(element, valueAccessor, allBindingsAccessor, viewModel, bindingContext) {
        var buildExplorer = ko.unwrap(valueAccessor()),
            $el = $(element);

        var pressedKeys = {};
        ko.utils.domData.set(element, 'pressedKeys', pressedKeys);
        
        var keyDownHandler = function(e) {
            var pressedKeys = ko.utils.domData.get(element, 'pressedKeys');
            pressedKeys[e.which] = true;
            ko.utils.domData.set(element, 'pressedKeys', pressedKeys);
        }
        ko.utils.domData.set(element, 'keyDownHandler', keyDownHandler);
        
        var keyUpHandler = function(e) {
            var pressedKeys = ko.utils.domData.get(element, 'pressedKeys');
            if ((pressedKeys[17] && pressedKeys[67]) || (pressedKeys[17] && pressedKeys[86])) { // ctrl + c
                var $hoveredRows = $(element).find('.hover-cursor:hover');
                if ($hoveredRows.length == 1) {
                    if (pressedKeys[67]) {
                        buildExplorer.copyInventoryToClipBoard($("tr", $(element)).index($hoveredRows[0]));
                    }
                    else {
                        buildExplorer.pasteInventoryFromClipBoard($("tr", $(element)).index($hoveredRows[0]));
                    }
                    $hoveredRows.fadeOut(50).fadeIn(50);
                }
            }
            delete pressedKeys[e.which];
            ko.utils.domData.set(element, 'pressedKeys', pressedKeys);
        }
        ko.utils.domData.set(element, 'keyUpHandler', keyUpHandler);
        
        $(document).bind( "keydown", keyDownHandler );
        $(document).bind( "keyup", keyUpHandler );

        ko.utils.domNodeDisposal.addDisposeCallback(element, function() {
            var keyDownHandler = ko.utils.domData.get(element, 'keyDownHandler');
            var keyUpHandler = ko.utils.domData.get(element, 'keyUpHandler');
            $(document).unbind( "keydown", keyDownHandler );
            $(document).unbind( "keyup", keyUpHandler );
        });
    }
};

ko.bindingHandlers.preventBubble = {
    init: function(element, valueAccessor) {
        var eventName = ko.utils.unwrapObservable(valueAccessor());
        ko.utils.registerEventHandler(element, eventName, function(event) {
           event.cancelBubble = true;
           if (event.stopPropagation) {
                event.stopPropagation();
           }                
        });
    }        
};

ko.bindingHandlers.toggle = {
    init: function (element, valueAccessor) {
        var value = valueAccessor();
        ko.applyBindingsToNode(element, {
            click: function () {
                value(!value());
            }
        });
    }
};

ko.bindingHandlers.shopDockStyle = {
    init: function(element, valueAccessor, allBindingsAccessor, viewModel, bindingContext) {
        var value = ko.utils.unwrapObservable(valueAccessor());
        if (bindingContext.$data.shopDock() && !bindingContext.$data.shopPopout()) {
            ko.applyBindingsToNode(element, { style: { height: (bindingContext.$data.windowHeight() - 52) + 'px', position: 'fixed', right: 0, top: '52px', 'overflow-y': 'auto' } });
        }
        else {
            ko.applyBindingsToNode(element, { style: { height: 'auto', position: 'relative', right: 'initial', top: 'initial', 'overflow-y': 'initial' } });
        }
    },
    update: function(element, valueAccessor, allBindingsAccessor, viewModel, bindingContext) {
        var value = ko.utils.unwrapObservable(valueAccessor());
        if (bindingContext.$data.shopDock() && !bindingContext.$data.shopPopout()) {
            ko.applyBindingsToNode(element, { style: { height: (bindingContext.$data.windowHeight() - 52) + 'px', position: 'fixed', right: 0, top: '52px', 'overflow-y': 'auto' } });
        }
        else {
            ko.applyBindingsToNode(element, { style: { height: 'auto', position: 'relative', right: 'initial', top: 'initial', 'overflow-y': 'initial' } });
        }
    }
};

ko.bindingHandlers.logger = {
    update: function(element, valueAccessor, allBindings) {
        //store a counter with this element
        var count = ko.utils.domData.get(element, "_ko_logger") || 0,
            data = ko.toJS(valueAccessor() || allBindings());

        ko.utils.domData.set(element, "_ko_logger", ++count);

        if (window.console && console.log) {
            console.log(count, element, data);
        }
    }
};

ko.bindingHandlers.tooltip = {
    update: function (element, valueAccessor, allBindingsAccessor, viewModel, bindingContext) {
        var $element, options, tooltip;
        options = ko.utils.unwrapObservable(valueAccessor());
        $element = $(element);

        // If the title is an observable, make it auto-updating.
        if (ko.isObservable(options.title)) {
            var isToolTipVisible = false;

            $element.on('show.bs.tooltip', function () {
                isToolTipVisible = true;
            });
            $element.on('hide.bs.tooltip', function () {
                isToolTipVisible = false;
            });

            // "true" is the bootstrap default.
            var origAnimation = options.animation || true;
            options.title.subscribe(function () {
                if (isToolTipVisible) {
                    $element.data('bs.tooltip').options.animation = false; // temporarily disable animation to avoid flickering of the tooltip
                    $element.tooltip('fixTitle') // call this method to update the title
                        .tooltip('show');
                    $element.data('bs.tooltip').options.animation = origAnimation;
                }
            });
        }

        tooltip = $element.data('bs.tooltip');
        if (tooltip) {
            $.extend(tooltip.options, options);
        } else {
            $element.tooltip(options);
        }
    }
};

ko.bindingHandlers.popover = {
    init: function (element, valueAccessor, allBindingsAccessor, viewModel, bindingContext) {
        var $element = $(element);
        var popoverBindingValues = ko.utils.unwrapObservable(valueAccessor());
        var template = popoverBindingValues.template || false;
        var options = popoverBindingValues.options || {title: 'popover'};
        var data = popoverBindingValues.data || false;
        if (template !== false) {
            if (data) {
                options.content = "<!-- ko template: { name: template, if: data, data: data } --><!-- /ko -->";
            }
            else {
                options.content = $('#' + template).html();
            }
            options.html = true;
        }
        $element.on('shown.bs.popover', function(event) {

            var popoverData = $(event.target).data();
            var popoverEl = popoverData['bs.popover'].$tip;
            var options = popoverData['bs.popover'].options || {};
            var button = $(event.target);
            var buttonPosition = button.position();
            var buttonDimensions = {
                x: button.outerWidth(),
                y: button.outerHeight()
            };

            if (data) {
                ko.applyBindingsToNode(popoverEl[0], { template: { name: template, data: data } }, bindingContext);
                //ko.applyBindings({template: template, data: data}, popoverEl[0]);
                //ko.renderTemplate(template, data, {}, popoverEl[0], 'replaceChildren');
            }
            else {
                //ko.renderTemplate(template, data, {}, popoverEl[0], 'replaceChildren');
                //ko.applyBindings(viewModel, popoverEl[0]);
            }

            var popoverDimensions = {
                x: popoverEl.outerWidth(),
                y: popoverEl.outerHeight()
            };

            popoverEl.find('button[data-dismiss="popover"]').click(function() {
                button.popover('hide');
            });

            switch (options.placement) {
                case 'right':
                    popoverEl.css({
                        left: buttonDimensions.x + buttonPosition.left,
                        top: (buttonDimensions.y / 2 + buttonPosition.top) - popoverDimensions.y / 2
                    });
                    break;
                case 'left':
                    popoverEl.css({
                        left: buttonPosition.left - popoverDimensions.x,
                        top: (buttonDimensions.y / 2 + buttonPosition.top) - popoverDimensions.y / 2
                    });
                    break;
                case 'top':
                    popoverEl.css({
                        left: buttonPosition.left + (buttonDimensions.x / 2 - popoverDimensions.x / 2),
                        top: buttonPosition.top - popoverDimensions.y
                    });
                    break;
                case 'bottom':
                    popoverEl.css({
                        left: buttonPosition.left + (buttonDimensions.x / 2 - popoverDimensions.x / 2),
                        top: buttonPosition.top + buttonDimensions.y
                    });
                    break;
            }
        });

        $element.popover(options);

        return { controlsDescendantBindings: true };

    }
};

ko.bindingHandlers.chart = {
    init: function(element, valueAccessor, allBindingsAccessor, viewModel, bindingContext) {
        var newCanvas = $('<canvas/>'),
      data = ko.utils.unwrapObservable(valueAccessor()),
      ctx = newCanvas[0].getContext("2d"),
      chartType = allBindingsAccessor().chartType,
      options = allBindingsAccessor().chartOptions || {},
      chartContext = allBindingsAccessor().chartContext;
            
        $(element).append(newCanvas);
        var myChart = new Chart(ctx)[chartType](data, options);
        ko.utils.domData.set(element, 'myChart', myChart);
        
  //handle disposal (if KO removes by the template binding)
  ko.utils.domNodeDisposal.addDisposeCallback(element, function() {
    var myChart = ko.utils.domData.get(element, 'myChart');
    myChart.clear();
    myChart.destroy();
  });
        
  if (chartContext) {
    chartContext(ctx);
  }
    },
    update: function(element, valueAccessor, allBindingsAccessor, viewModel, bindingContext) {
        var newCanvas = $('<canvas/>').width(730).height(365),
      data = ko.utils.unwrapObservable(valueAccessor()),
      ctx = newCanvas[0].getContext("2d"),
      chartType = allBindingsAccessor().chartType,
      options = allBindingsAccessor().chartOptions || {},
      chartContext = allBindingsAccessor().chartContext,
      myChart = ko.utils.domData.get(element, 'myChart');
        
  if (myChart) {
    myChart.clear();
    myChart.destroy();
  }
        bindingContext.$root.displayShop();
        bindingContext.$root.sideView();
        bindingContext.$root.shopDock();
        $(element).empty();
        $(element).append(newCanvas);
  if (data.datasets.length > 0) {
            myChart = new Chart(ctx)[chartType](data, options);
            ko.utils.domData.set(element, 'myChart', myChart);
  }
  
  if (chartContext) {
    chartContext(ctx);
  }
    }
};

ko.bindingHandlers.spinner = {
    init: function(element, valueAccessor, allBindingsAccessor) {
        //initialize datepicker with some optional options
        var options = allBindingsAccessor().spinnerOptions || {};
        options.icons = options.icons || { down: "glyphicon glyphicon-triangle-bottom", up: "glyphicon glyphicon-triangle-top" };
        $(element).spinner(options);

        //handle the field changing
        ko.utils.registerEventHandler(element, "spinchange", function () {
            var observable = valueAccessor();
            observable($(element).spinner("value"));
        });

        //handle disposal (if KO removes by the template binding)
        ko.utils.domNodeDisposal.addDisposeCallback(element, function() {
            $(element).spinner("destroy");
        });

    },
    update: function(element, valueAccessor) {
        var value = ko.utils.unwrapObservable(valueAccessor()),
            current = $(element).spinner("value");

        if (value !== current) {
            $(element).spinner("value", value);
        }
    }
};

ko.bindingHandlers.secondTab = {
    update: function(element, valueAccessor, allBindingsAccessor, viewModel, bindingContext) {
        var $root = bindingContext.$root,
            value = ko.utils.unwrapObservable(valueAccessor());
        ko.applyBindingsToNode(element, { css: {'second-tab': $root.isSecondTab(value) && $root.sideView()} });
    }
};

ko.bindingHandlers.hoverTab = {
    update: function(element, valueAccessor, allBindingsAccessor, viewModel, bindingContext) {
        var $root = bindingContext.$root,
            value = ko.utils.unwrapObservable(valueAccessor());
            
        ko.utils.registerEventHandler(element, "mouseover", function() {
            $root.highlightTab(value);
        });  

        ko.utils.registerEventHandler(element, "mouseout", function() {
            $root.unhighlightTab(value);
        });      
    }
};

ko.bindingHandlers.hoverPaneStyle = {
    init: function(element, valueAccessor, allBindingsAccessor, viewModel, bindingContext) {
        var $root = bindingContext.$root,
            value = ko.utils.unwrapObservable(valueAccessor());
        ko.applyBindingsToNode(element, { style: { opacity: !($root.sideView()) || $root.highlightedTab() == value || $root.highlightedTab() == '' ? 1 : .5 } });
    },
    update: function(element, valueAccessor, allBindingsAccessor, viewModel, bindingContext) {
        var $root = bindingContext.$root,
            value = ko.utils.unwrapObservable(valueAccessor());
        ko.applyBindingsToNode(element, { style: { opacity: !($root.sideView()) || $root.highlightedTab() == value || $root.highlightedTab() == '' ? 1 : .5 } });
    }
};

ko.bindingHandlers.diffStyle = {
    init: function(element, valueAccessor, allBindingsAccessor, viewModel) {
        var value = ko.utils.unwrapObservable(valueAccessor());
        ko.applyBindingsToNode(element, { css: {'diffPos': value > 0, 'diffNeg': value < 0} });
    },
    update: function(element, valueAccessor, allBindingsAccessor, viewModel) {
        var value = ko.utils.unwrapObservable(valueAccessor());
        ko.applyBindingsToNode(element, { css: {'diffPos': value > 0, 'diffNeg': value < 0} });
    }
};

ko.bindingHandlers.diffCss = {
    init: function(element, valueAccessor, allBindingsAccessor, viewModel) {
        var value = ko.utils.unwrapObservable(valueAccessor()),
            stat = allBindingsAccessor().diffCssStat;
        if (stat == 'attackTime' || stat == 'bat') {
            value = -value;
        }
        ko.applyBindingsToNode(element, { css: {'diffPos': value > 0, 'diffNeg': value < 0} });
    },
    update: function(element, valueAccessor, allBindingsAccessor, viewModel) {
        var value = ko.utils.unwrapObservable(valueAccessor()),
            stat = allBindingsAccessor().diffCssStat;
        if (stat == 'attackTime' || stat == 'bat') {
            value = -value;
        }
        ko.applyBindingsToNode(element, { css: {'diffPos': value > 0, 'diffNeg': value < 0} });
    }
};

ko.bindingHandlers.jqAuto = {
    init: function(element, valueAccessor, allBindingsAccessor, viewModel) {
        var options = valueAccessor() || {},
            allBindings = allBindingsAccessor(),
            unwrap = ko.utils.unwrapObservable,
            modelValue = allBindings.jqAutoValue,
            source = allBindings.jqAutoSource,
            valueProp = allBindings.jqAutoSourceValue,
            inputValueProp = allBindings.jqAutoSourceInputValue || valueProp,
            labelProp = allBindings.jqAutoSourceLabel || valueProp;

        //function that is shared by both select and change event handlers
        function writeValueToModel(valueToWrite) {
            if (ko.isWriteableObservable(modelValue)) {
               modelValue(valueToWrite );  
            } else {  //write to non-observable
               if (allBindings['_ko_property_writers'] && allBindings['_ko_property_writers']['jqAutoValue'])
                        allBindings['_ko_property_writers']['jqAutoValue'](valueToWrite );    
            }
        }
        
        //on a selection write the proper value to the model
        options.select = function(event, ui) {
            writeValueToModel(ui.item ? ui.item.actualValue : null);
        };
            
        //on a change, make sure that it is a valid value or clear out the model value
        options.change = function(event, ui) {
            var currentValue = $(element).val();
            var matchingItem =  ko.utils.arrayFirst(unwrap(source), function(item) {
               return unwrap(item[inputValueProp]) === currentValue;  
            });
            
            if (!matchingItem) {
               writeValueToModel(null);
            }    
        }
        
        
        //handle the choices being updated in a DO, to decouple value updates from source (options) updates
        var mappedSource = ko.dependentObservable(function() {
            var mapped = ko.utils.arrayMap(unwrap(source), function(item) {
                var result = {};
                result.label = labelProp ? unwrap(item[labelProp]) : unwrap(item).toString();  //show in pop-up choices
                result.value = inputValueProp ? unwrap(item[inputValueProp]) : unwrap(item).toString();  //show in input box
                result.actualValue = valueProp ? unwrap(item[valueProp]) : item;  //store in model
                return result;
            });
            return mapped;                
        });
        
        //whenever the items that make up the source are updated, make sure that autocomplete knows it
        mappedSource.subscribe(function(newValue) {
           $(element).autocomplete("option", "source", newValue); 
        });
        
        options.source = mappedSource();
        
        options.minLength = 1;
        //initialize autocomplete
        $(element).autocomplete(options);
    },
    update: function(element, valueAccessor, allBindingsAccessor, viewModel) {
       //update value based on a model change
       var allBindings = allBindingsAccessor(),
           unwrap = ko.utils.unwrapObservable,
           modelValue = unwrap(allBindings.jqAutoValue) || '', 
           valueProp = allBindings.jqAutoSourceValue,
           inputValueProp = allBindings.jqAutoSourceInputValue || valueProp;
        
       //if we are writing a different property to the input than we are writing to the model, then locate the object
       if (valueProp && inputValueProp !== valueProp) {
           var source = unwrap(allBindings.jqAutoSource) || [];
           var modelValue = ko.utils.arrayFirst(source, function(item) {
                 return unwrap(item[valueProp]) === modelValue;
           }) || {};  //probably don't need the || {}, but just protect against a bad value          
       } 

       //update the element with the value that should be shown in the input
       $(element).val(modelValue && inputValueProp !== valueProp ? unwrap(modelValue[inputValueProp]) : modelValue.toString());    
    }
};

ko.bindingHandlers.jqAutoCombo = {
    init: function(element, valueAccessor) {
       var autoEl = $("#" + valueAccessor());
       
        $(element).click(function() {
           // close if already visible
            if (autoEl.autocomplete("widget").is(":visible")) {
                autoEl.autocomplete( "close" );
                return;
            }

           //autoEl.blur();
            autoEl.autocomplete("search", " ");
            autoEl.focus(); 
            
        });
        
    }  
}

module.exports = ko;
}).call(this,typeof global !== "undefined" ? global : typeof self !== "undefined" ? self : typeof window !== "undefined" ? window : {})

},{"../lib/Chart.scatter":86,"chart.js":46}],80:[function(require,module,exports){
(function (global){
'use strict';
var $ = (typeof window !== "undefined" ? window['$'] : typeof global !== "undefined" ? global['$'] : null);

require('./ko.extenders.async');

var ability_vars = {
    '$health': 'Health',
    '$mana': 'Mana',
    '$armor': 'Armor',
    '$damage': 'Damage',
    '$str': 'Strength',
    '$int': 'Intelligence',
    '$agi': 'Agility',
    '$all': 'All Attributes',
    '$attack': 'Attack Speed',
    '$hp_regen': 'HP Regeneration',
    '$mana_regen': 'Mana Regeneration',
    '$move_speed': 'Movement Speed',
    '$evasion': 'Evasion',
    '$spell_resist': 'Spell Resistance',
    '$selected_attribute': 'Selected Attribute',
    '$selected_attrib': 'Selected Attribute',
    '$cast_range': 'Cast Range',
    '$attack_range': 'Attack Range'
}
var abilityTooltipData = {};
var abilityDamageTypes = {
    'DAMAGE_TYPE_MAGICAL': 'Magical',
    'DAMAGE_TYPE_PURE': 'Pure',
    'DAMAGE_TYPE_PHYSICAL': 'Physical',
    'DAMAGE_TYPE_COMPOSITE': 'Composite',
    'DAMAGE_TYPE_HP_REMOVAL': 'HP Removal'
}
var tooltipJSON = ko.observable();

var getTooltipAbilityDescription = function (item) {
    var d = tooltipJSON() ? tooltipJSON()[item.name].description : '';
    for (var i = 0; i < item.attributes.length; i++) {
        if (item.attributes[i].name != null) {
            var attributeName = item.attributes[i].name;
            var attributeValue = item.attributes[i].value[0];
            for (var j = 1; j < item.attributes[i].value.length; j++) {
                attributeValue += ' / ' + item.attributes[i].value[j];
            }
            regexp = new RegExp('%' + attributeName + '%', 'gi');
            d = d.replace(regexp, attributeValue);
        }
    }
    var regexp = new RegExp('%%', 'gi');
    d = d.replace(regexp, '%');
    regexp = new RegExp('\n', 'gi');
    d = d.replace(/\\n/g, '<br>');
    return d;
}

var getTooltipAbilityAttributes = function (item) {
    var a = '';
    if (item.damage.length > 0 && item.damage.reduce(function(memo, num){ return memo + num; }, 0) > 0) {
        var attributeTooltip = 'DAMAGE: ';
        var attributeValue = item.damage[0];
        for (var j = 1; j < item.damage.length; j++) {
            attributeValue += ' / ' + item.damage[j];
        }
        a = a + attributeTooltip + ' ' + attributeValue + '<br>';
    }
    for (var i = 0; i < item.attributes.length; i++) {
        if (item.attributes[i].tooltip != null) {
            var attributeTooltip = item.attributes[i].tooltip;
            attributeTooltip = attributeTooltip.replace(/\\n/g, '');
            var attributeValue = item.attributes[i].value[0];
            for (var j = 1; j < item.attributes[i].value.length; j++) {
                attributeValue += ' / ' + item.attributes[i].value[j];
            }
            var p = attributeTooltip.indexOf('%');
            if (p == 0) {
                if (attributeValue.toString().indexOf('/') == -1) {
                    attributeValue = attributeValue.toString().trim() + '%';
                } else {
                    //var regexp2 = new RegExp('/', 'gi');
                    //attributeValue = attributeValue.replace(regexp2, '%/') + '%';
                    var attributeValues = attributeValue.split('/');
                    var trimmedAttributeValues = attributeValues.map(function(v) {
                        return v.trim();
                    });
                    attributeValue = trimmedAttributeValues.join('% / ') + '%';
                }
                attributeTooltip = attributeTooltip.slice(1);
            }
            var d = attributeTooltip.indexOf('$');
            a = a + attributeTooltip + ' ' + attributeValue + '<br>';
        }
    }
    return a.trim('<br>');
}

var getTooltipAbilityManaCost = function (item) {
    var c = '';
    if (item.manacost.reduce(function(memo, num){ return memo + num; }, 0) == 0) {
        return c;
    }
    if (item.manacost.every(function(num) { return num == item.manacost[0]; })) {
        return item.manacost[0].toString();
    }
    for (var i = 0; i < 4; i++) {
        if (item.manacost[i] != null) {
            c = c + ' ' + item.manacost[i];
        }
    }
    return c;
}

var getTooltipAbilityCooldown = function (item) {
    var c = '';
    if (item.cooldown.reduce(function(memo, num){ return memo + num; }, 0) == 0) {
        return c;
    }
    if (item.cooldown.every(function(num) { return num == item.cooldown[0]; })) {
        return item.cooldown[0].toString();
    }
    for (var i = 0; i < 4; i++) {
        if (item.cooldown[i] != null) {
            c = c + ' ' + item.cooldown[i];
        }
    }
    return c;
}
    
var getAbilityTooltipData = function(heroData, unitData, hero, el) {
    if (abilityTooltipData[el] == undefined) {
        var abilityName = el
        var ability = {};
        if (heroData['npc_dota_hero_' + hero] == undefined && heroData[hero] == undefined) {
            for (var i = 0; i < unitData[hero].abilities.length; i++) {
                if (unitData[hero].abilities[i].name == el) {
                    ability = unitData[hero].abilities[i];
                }
            }            
        }
        else {
            if (hero.indexOf('npc_dota_hero_') == -1) hero = 'npc_dota_hero_' + hero;
            for (var i = 0; i < heroData[hero].abilities.length; i++) {
                if (heroData[hero].abilities[i].name == el) {
                    ability = heroData[hero].abilities[i];
                }
            }
        }
        var data = $('<div>')
        data.append($('<span>').html(ability.displayname).addClass('item_field pull-left item_name'));
        if (ability.abilityunitdamagetype) {
            data.append($('<span>').html(abilityDamageTypes[ability.abilityunitdamagetype]).addClass('item_field pull-right item_ability_damage_type').css('margin-right','10px'));
        }
        data.append($('<hr>').css('clear', 'both'));
        if (tooltipJSON() && tooltipJSON()[ability.name] && tooltipJSON()[ability.name].description) {
            data.append($('<div>').html(getTooltipAbilityDescription(ability)).addClass('item_field item_description'));
        }
        var attributedata = getTooltipAbilityAttributes(ability);
        if (attributedata != '') {
            data.append($('<div>').html(attributedata).addClass('item_field item_attributes'));
        }
        var cd = getTooltipAbilityCooldown(ability);
        var mana = getTooltipAbilityManaCost(ability);
        if (cd != '' || mana != '') {
            var cdmanacost = $('<div>').addClass('item_cdmana');
            if (mana != '') {
                cdmanacost.append($('<span>').html(mana.trim()).addClass('item_field item_manacost'));
            }
            if (cd != '') {
                cdmanacost.append($('<span>').html(cd.trim()).addClass('item_field item_cooldown'));
            }
            data.append(cdmanacost);
        }
        if (tooltipJSON() && tooltipJSON()[ability.name] && tooltipJSON()[ability.name].description) {
            data.append($('<div>').html(tooltipJSON()[ability.name].lore).addClass('item_field item_lore'));
        }
        if (!tooltipJSON()) {
            return ko.computed(function () {
                if (!tooltipJSON()) {
                    return data.html();
                }
                else {
                    return getAbilityTooltipData(heroData, unitData, hero, el);
                }
            });
        }
        else {
            abilityTooltipData[el] = data.html();
            return data.html();
        }
    }
    else {
        return abilityTooltipData[el];
    }
}

getAbilityTooltipData.tooltipJSON = tooltipJSON;

var init = function (url) {
    $.getJSON(url, function (data) {
        tooltipJSON(data);
    });
}
getAbilityTooltipData.init = init;

module.exports = getAbilityTooltipData;
}).call(this,typeof global !== "undefined" ? global : typeof self !== "undefined" ? self : typeof window !== "undefined" ? window : {})

},{"./ko.extenders.async":83}],81:[function(require,module,exports){
(function (global){
'use strict';
var $ = (typeof window !== "undefined" ? window['$'] : typeof global !== "undefined" ? global['$'] : null);

var itemtooltipdata = {};
var ability_vars = {
    '$health': 'Health',
    '$mana': 'Mana',
    '$armor': 'Armor',
    '$damage': 'Damage',
    '$str': 'Strength',
    '$int': 'Intelligence',
    '$agi': 'Agility',
    '$all': 'All Attributes',
    '$attack': 'Attack Speed',
    '$hp_regen': 'HP Regeneration',
    '$mana_regen': 'Mana Regeneration',
    '$move_speed': 'Movement Speed',
    '$evasion': 'Evasion',
    '$spell_resist': 'Spell Resistance',
    '$selected_attribute': 'Selected Attribute',
    '$selected_attrib': 'Selected Attribute',
    '$cast_range': 'Cast Range',
    '$attack_range': 'Attack Range'
}

var getTooltipItemDescription = function (item) {
    var d = item.description;
    for (var i = 0; i < item.attributes.length; i++) {
        if (item.attributes[i].name != null) {
            var attributeName = item.attributes[i].name;
            var attributeValue = item.attributes[i].value[0];
            for (var j = 1; j < item.attributes[i].value.length; j++) {
                attributeValue += ' / ' + item.attributes[i].value[j];
            }
            var regexp = new RegExp('%' + attributeName + '%', 'gi');
            d = d.replace(regexp, attributeValue );
        }
    }
    var regexp = new RegExp('%%', 'gi');
    d = d.replace(regexp,'%');
    regexp = new RegExp('\n', 'gi');
    d = d.replace(/\\n/g, '<br>');
    return d;
}

var getTooltipItemAttributes = function (item) {
    var a = '';
    for (var i = 0; i < item.attributes.length; i++) {
        if (item.attributes[i].tooltip != null) {
            var attributeTooltip = item.attributes[i].tooltip;
            var attributeValue = item.attributes[i].value[0];
            for (var j = 1; j < item.attributes[i].value.length; j++) {
                attributeValue += ' / ' + item.attributes[i].value[j];
            }
            var p = attributeTooltip.indexOf('%');
            if (p == 0) {
                attributeValue = attributeValue + '%';
                attributeTooltip = attributeTooltip.slice(1);
            }
            var d = attributeTooltip.indexOf('$');
            if (d != -1) {
                a = a + attributeTooltip.slice(0, d) + ' ' + attributeValue + ' ' + ability_vars[attributeTooltip.slice(d)] + '<br>';
            }
            else {
                a = a + attributeTooltip + ' ' + attributeValue + '<br>';
            }
        }
    }
    return a.trim('<br>');
}

var getTooltipItemCooldown = function (item) {
    var c = '';
    for (var i = 0; i < item.cooldown.length; i++) {
        c = c + ' ' + item.cooldown[i];
    }
    return c;
}

var getTooltipItemManaCost = function (item) {
    var c = '';
    for (var i = 0; i < item.manacost.length; i++) {
        if (item.manacost[i] > 0) {
            c = c + ' ' + item.manacost[i];
        }
    }
    return c;
}

var getItemTooltipData = function(itemData, el) {
    if (itemData['item_' + el] == undefined) {
        return undefined;
    }
    if (itemtooltipdata[el] == undefined) {
        var item = itemData['item_' + el];
        var data = $('<div>');
        data.append($('<span>').html(item.displayname).addClass('item_field item_name'));
        data.append($('<span>').html(item.itemcost).addClass('item_field item_cost'));
        data.append($('<hr>'));
        if (item.description != null) {
            data.append($('<div>').html(getTooltipItemDescription(item)).addClass('item_field item_description'));
        }
        var attributedata = getTooltipItemAttributes(item);
        if (attributedata != '') {
            data.append($('<div>').html(attributedata).addClass('item_field item_attributes'));
        }
        var cd = getTooltipItemCooldown(item);
        var mana = getTooltipItemManaCost(item);
        if (cd != '' || mana != '') {
            var cdmanacost = $('<div>').addClass('item_cdmana');
            if (cd != '') {
                cdmanacost.append($('<span>').html(cd).addClass('item_field item_cooldown'));
            }
            if (mana != '') {
                cdmanacost.append($('<span>').html(mana).addClass('item_field item_manacost'));
            }
            data.append(cdmanacost);
        }
        if (item.lore != null) {
            data.append($('<div>').html(item.lore).addClass('item_field item_lore'));
        }
        itemtooltipdata[el] = data.html();
        return data.html();
    }
    else {
        return itemtooltipdata[el];
    }
}

module.exports = getItemTooltipData;
}).call(this,typeof global !== "undefined" ? global : typeof self !== "undefined" ? self : typeof window !== "undefined" ? window : {})

},{}],82:[function(require,module,exports){
(function (global){
'use strict';
var $ = (typeof window !== "undefined" ? window['$'] : typeof global !== "undefined" ? global['$'] : null);
//require('jquery-ui');
require('jquery-ui/ui/version');
require('jquery-ui/ui/widget');
require('jquery-ui/ui/unique-id');
require('jquery-ui/ui/safe-active-element');
require('jquery-ui/ui/keycode');
require('jquery-ui/ui/position');
require('jquery-ui/ui/focusable');
require('jquery-ui/ui/tabbable');
require('jquery-ui/ui/plugin');
require('jquery-ui/ui/ie');
require('jquery-ui/ui/data');
require('jquery-ui/ui/scroll-parent');
require('jquery-ui/ui/disable-selection');
require('jquery-ui/ui/safe-blur');
require('jquery-ui/ui/widgets/button');
require('jquery-ui/ui/widgets/spinner');
require('jquery-ui/ui/widgets/menu');
require('jquery-ui/ui/widgets/autocomplete');
require('jquery-ui/ui/widgets/mouse');
require('jquery-ui/ui/widgets/draggable');
require('jquery-ui/ui/widgets/resizable');
require('jquery-ui/ui/widgets/dialog');

var proto = $.ui.autocomplete.prototype,
    initSource = proto._initSource;

function filter( array, term ) {
    var matcher = new RegExp( $.ui.autocomplete.escapeRegex(term), "i" );
    return $.grep( array, function(value) {
        return matcher.test( $( "<div>" ).html( value.label || value.value || value ).text() );
    });
}

$.extend( proto, {
    _initSource: function() {
        if ( this.options.html && $.isArray(this.options.source) ) {
            this.source = function( request, response ) {
                response( filter( this.options.source, request.term ) );
            };
        } else {
            initSource.call( this );
        }
    },

    _renderItem: function( ul, item) {
        return $( "<li></li>" )
            .data( "item.autocomplete", item )
            .append( $( "<a></a>" )[ this.options.html ? "html" : "text" ]( item.label ) )
            .appendTo( ul );
    }
});
}).call(this,typeof global !== "undefined" ? global : typeof self !== "undefined" ? self : typeof window !== "undefined" ? window : {})

},{"jquery-ui/ui/data":47,"jquery-ui/ui/disable-selection":48,"jquery-ui/ui/focusable":49,"jquery-ui/ui/ie":50,"jquery-ui/ui/keycode":51,"jquery-ui/ui/plugin":52,"jquery-ui/ui/position":53,"jquery-ui/ui/safe-active-element":54,"jquery-ui/ui/safe-blur":55,"jquery-ui/ui/scroll-parent":56,"jquery-ui/ui/tabbable":57,"jquery-ui/ui/unique-id":58,"jquery-ui/ui/version":59,"jquery-ui/ui/widget":60,"jquery-ui/ui/widgets/autocomplete":61,"jquery-ui/ui/widgets/button":62,"jquery-ui/ui/widgets/dialog":63,"jquery-ui/ui/widgets/draggable":64,"jquery-ui/ui/widgets/menu":65,"jquery-ui/ui/widgets/mouse":66,"jquery-ui/ui/widgets/resizable":67,"jquery-ui/ui/widgets/spinner":68}],83:[function(require,module,exports){
ko.extenders.async = function(computedDeferred, initialValue) {
 
    var plainObservable = ko.observable(initialValue), currentDeferred;
    plainObservable.inProgress = ko.observable(false);
 
    ko.computed(function() {
        if (currentDeferred) {
            currentDeferred.reject();
            currentDeferred = null;
        }
 
        var newDeferred = computedDeferred();
        if (newDeferred &&
            (typeof newDeferred.done == "function")) {
 
            // It's a deferred
            plainObservable.inProgress(true);
 
            // Create our own wrapper so we can reject
            currentDeferred = $.Deferred().done(function(data) {
                plainObservable.inProgress(false);
                plainObservable(data);
            });
            newDeferred.done(currentDeferred.resolve);
        } else {
            // A real value, so just publish it immediately
            plainObservable(newDeferred);
        }
    });
 
    return plainObservable;
};
},{}],84:[function(require,module,exports){
if (!Array.prototype.find) {
  Array.prototype.find = function(predicate) {
    'use strict';
    if (this == null) {
      throw new TypeError('Array.prototype.find called on null or undefined');
    }
    if (typeof predicate !== 'function') {
      throw new TypeError('predicate must be a function');
    }
    var list = Object(this);
    var length = list.length >>> 0;
    var thisArg = arguments[1];
    var value;

    for (var i = 0; i < length; i++) {
      value = list[i];
      if (predicate.call(thisArg, value, i, list)) {
        return value;
      }
    }
    return undefined;
  };
}
},{}],85:[function(require,module,exports){
function ViewModel(params) {
    var self = this;
    self.windowWidth = params.windowWidth;
    self.windowHeight = params.windowHeight;
    self.displayShop = params.displayShop;
    self.displayShopItemTooltip = params.displayShopItemTooltip;
    self.shopDock = params.shopDock;
    self.shopDockTrigger = params.shopDockTrigger;
    self.shopPopout = params.shopPopout;
    self.selectedItem = params.selectedItem;
    self.addItem = params.addItem;
    self.changeSelectedItem = params.changeSelectedItem;
    self.getItemTooltipData = params.getItemTooltipData;
    self.getItemInputLabel = params.getItemInputLabel;
    self.itemInputValue = params.itemInputValue;
    self.itemOptions = params.itemOptions;
}

module.exports = {
    viewModel: ViewModel,
    template: "        <div id=\"shop-container\" class=\"col-md-12 col-lg-4\" data-bind=\"shopDockStyle: shopDockTrigger, visible: displayShop() || shopPopout(), css: {'col-lg-4': !shopPopout()}, style: { 'padding-top': shopPopout() ? '5px' : '0px'}\">\n              <button id=\"shop-minimize\" class=\"btn btn-default btn-xs shop-button glyphicon glyphicon-minus pull-right\" data-bind=\"toggle: displayShop, visible: displayShop()\" title=\"Minimize shop\"></button>\n              <button id=\"shop-maximize\" class=\"btn btn-default btn-xs shop-button glyphicon glyphicon-plus pull-right\" data-bind=\"toggle: displayShop, visible: !displayShop()\" title=\"Maximize shop\"></button>\n              <button class=\"btn btn-default btn-xs shop-button glyphicon glyphicon-new-window pull-right hidden-xs\" data-bind=\"click: shopPopout, visible: !shopPopout()\" title=\"Popout shop\"></button>\n              <button class=\"btn btn-default btn-xs shop-button glyphicon glyphicon-align-right pull-right hidden-xs\" data-bind=\"toggle: shopDock, attr: { title: shopDock() ? 'Undock shop to right side of screen' : 'Dock shop to right side of screen' }\" ></button>\n            <ul id=\"shoptabs\" class=\"nav nav-tabs\" data-bind=\"visible: displayShop()\">\n              <li><a href=\"#shop_basic\" data-toggle=\"tab\">Basic</a></li>\n              <li><a href=\"#shop_upgrade\" data-toggle=\"tab\">Upgrade</a></li>\n              <li><a href=\"#shop_secret\" data-toggle=\"tab\">Secret</a></li>\n            </ul>\n            <div class=\"tab-content text-center bottom-buffer2\" data-bind=\"visible: displayShop()\">\n                <div class=\"tab-pane active\" id=\"shop_basic\">\n<div class=\"shop-column\">\n  <div class=\"hc-shop hc-shop-consumables\" id=\"consumables\"></div>\n  <div class=\"img-rounded items-sprite-50x36 items-sprite-clarity\" id=\"clarity\" data-bind=\"click: changeSelectedItem, event: { dblclick: addItem }\"></div>\n  <div class=\"img-rounded items-sprite-50x36 items-sprite-faerie_fire\" id=\"faerie_fire\" data-bind=\"click: changeSelectedItem, event: { dblclick: addItem }\"></div>\n  <div class=\"img-rounded items-sprite-50x36 items-sprite-enchanted_mango\" id=\"enchanted_mango\" data-bind=\"click: changeSelectedItem, event: { dblclick: addItem }\"></div>\n  <div class=\"img-rounded items-sprite-50x36 items-sprite-tango\" id=\"tango\" data-bind=\"click: changeSelectedItem, event: { dblclick: addItem }\"></div>\n  <div class=\"img-rounded items-sprite-50x36 items-sprite-flask\" id=\"flask\" data-bind=\"click: changeSelectedItem, event: { dblclick: addItem }\"></div>\n  <div class=\"img-rounded items-sprite-50x36 items-sprite-smoke_of_deceit\" id=\"smoke_of_deceit\" data-bind=\"click: changeSelectedItem, event: { dblclick: addItem }\"></div>\n  <div class=\"img-rounded items-sprite-50x36 items-sprite-tpscroll\" id=\"tpscroll\" data-bind=\"click: changeSelectedItem, event: { dblclick: addItem }\"></div>\n  <div class=\"img-rounded items-sprite-50x36 items-sprite-dust\" id=\"dust\" data-bind=\"click: changeSelectedItem, event: { dblclick: addItem }\"></div>\n  <div class=\"img-rounded items-sprite-50x36 items-sprite-courier\" id=\"courier\" data-bind=\"click: changeSelectedItem, event: { dblclick: addItem }\"></div>\n  <div class=\"img-rounded items-sprite-50x36 items-sprite-flying_courier\" id=\"flying_courier\" data-bind=\"click: changeSelectedItem, event: { dblclick: addItem }\"></div>\n  <div class=\"img-rounded items-sprite-50x36 items-sprite-ward_observer\" id=\"ward_observer\" data-bind=\"click: changeSelectedItem, event: { dblclick: addItem }\"></div>\n  <div class=\"img-rounded items-sprite-50x36 items-sprite-ward_sentry\" id=\"ward_sentry\" data-bind=\"click: changeSelectedItem, event: { dblclick: addItem }\"></div>\n  <div class=\"img-rounded items-sprite-50x36 items-sprite-tome_of_knowledge\" id=\"tome_of_knowledge\" data-bind=\"click: changeSelectedItem, event: { dblclick: addItem }\"></div>\n  <div class=\"img-rounded items-sprite-50x36 items-sprite-bottle\" id=\"bottle\" data-bind=\"click: changeSelectedItem, event: { dblclick: addItem }\"></div>\n</div>\n<div class=\"shop-column\">\n  <div class=\"hc-shop hc-shop-attributes\" id=\"attributes\"></div>\n  <div class=\"img-rounded items-sprite-50x36 items-sprite-branches\" id=\"branches\" data-bind=\"click: changeSelectedItem, event: { dblclick: addItem }\"></div>\n  <div class=\"img-rounded items-sprite-50x36 items-sprite-gauntlets\" id=\"gauntlets\" data-bind=\"click: changeSelectedItem, event: { dblclick: addItem }\"></div>\n  <div class=\"img-rounded items-sprite-50x36 items-sprite-slippers\" id=\"slippers\" data-bind=\"click: changeSelectedItem, event: { dblclick: addItem }\"></div>\n  <div class=\"img-rounded items-sprite-50x36 items-sprite-mantle\" id=\"mantle\" data-bind=\"click: changeSelectedItem, event: { dblclick: addItem }\"></div>\n  <div class=\"img-rounded items-sprite-50x36 items-sprite-circlet\" id=\"circlet\" data-bind=\"click: changeSelectedItem, event: { dblclick: addItem }\"></div>\n  <div class=\"img-rounded items-sprite-50x36 items-sprite-belt_of_strength\" id=\"belt_of_strength\" data-bind=\"click: changeSelectedItem, event: { dblclick: addItem }\"></div>\n  <div class=\"img-rounded items-sprite-50x36 items-sprite-boots_of_elves\" id=\"boots_of_elves\" data-bind=\"click: changeSelectedItem, event: { dblclick: addItem }\"></div>\n  <div class=\"img-rounded items-sprite-50x36 items-sprite-robe\" id=\"robe\" data-bind=\"click: changeSelectedItem, event: { dblclick: addItem }\"></div>\n  <div class=\"img-rounded items-sprite-50x36 items-sprite-ogre_axe\" id=\"ogre_axe\" data-bind=\"click: changeSelectedItem, event: { dblclick: addItem }\"></div>\n  <div class=\"img-rounded items-sprite-50x36 items-sprite-blade_of_alacrity\" id=\"blade_of_alacrity\" data-bind=\"click: changeSelectedItem, event: { dblclick: addItem }\"></div>\n  <div class=\"img-rounded items-sprite-50x36 items-sprite-staff_of_wizardry\" id=\"staff_of_wizardry\" data-bind=\"click: changeSelectedItem, event: { dblclick: addItem }\"></div>\n  <div class=\"img-rounded items-sprite-50x36 items-sprite-emptyitembg\" id=\"emptyitembg\"></div>\n  <div class=\"img-rounded items-sprite-50x36 items-sprite-emptyitembg\" id=\"emptyitembg\"></div>\n  <div class=\"img-rounded items-sprite-50x36 items-sprite-emptyitembg\" id=\"emptyitembg\"></div>\n</div>\n<div class=\"shop-column\">\n  <div class=\"hc-shop hc-shop-armaments\" id=\"armaments\"></div>\n  <div class=\"img-rounded items-sprite-50x36 items-sprite-ring_of_protection\" id=\"ring_of_protection\" data-bind=\"click: changeSelectedItem, event: { dblclick: addItem }\"></div>\n  <div class=\"img-rounded items-sprite-50x36 items-sprite-stout_shield\" id=\"stout_shield\" data-bind=\"click: changeSelectedItem, event: { dblclick: addItem }\"></div>\n  <div class=\"img-rounded items-sprite-50x36 items-sprite-quelling_blade\" id=\"quelling_blade\" data-bind=\"click: changeSelectedItem, event: { dblclick: addItem }\"></div>\n  <div class=\"img-rounded items-sprite-50x36 items-sprite-infused_raindrop\" id=\"infused_raindrop\" data-bind=\"click: changeSelectedItem, event: { dblclick: addItem }\"></div>\n  <div class=\"img-rounded items-sprite-50x36 items-sprite-blight_stone\" id=\"blight_stone\" data-bind=\"click: changeSelectedItem, event: { dblclick: addItem }\"></div>\n  <div class=\"img-rounded items-sprite-50x36 items-sprite-orb_of_venom\" id=\"orb_of_venom\" data-bind=\"click: changeSelectedItem, event: { dblclick: addItem }\"></div>\n  <div class=\"img-rounded items-sprite-50x36 items-sprite-blades_of_attack\" id=\"blades_of_attack\" data-bind=\"click: changeSelectedItem, event: { dblclick: addItem }\"></div>\n  <div class=\"img-rounded items-sprite-50x36 items-sprite-chainmail\" id=\"chainmail\" data-bind=\"click: changeSelectedItem, event: { dblclick: addItem }\"></div>\n  <div class=\"img-rounded items-sprite-50x36 items-sprite-quarterstaff\" id=\"quarterstaff\" data-bind=\"click: changeSelectedItem, event: { dblclick: addItem }\"></div>\n  <div class=\"img-rounded items-sprite-50x36 items-sprite-helm_of_iron_will\" id=\"helm_of_iron_will\" data-bind=\"click: changeSelectedItem, event: { dblclick: addItem }\"></div>\n  <div class=\"img-rounded items-sprite-50x36 items-sprite-broadsword\" id=\"broadsword\" data-bind=\"click: changeSelectedItem, event: { dblclick: addItem }\"></div>\n  <div class=\"img-rounded items-sprite-50x36 items-sprite-claymore\" id=\"claymore\" data-bind=\"click: changeSelectedItem, event: { dblclick: addItem }\"></div>\n  <div class=\"img-rounded items-sprite-50x36 items-sprite-javelin\" id=\"javelin\" data-bind=\"click: changeSelectedItem, event: { dblclick: addItem }\"></div>\n  <div class=\"img-rounded items-sprite-50x36 items-sprite-mithril_hammer\" id=\"mithril_hammer\" data-bind=\"click: changeSelectedItem, event: { dblclick: addItem }\"></div>\n</div>\n<div class=\"shop-column\">\n  <div class=\"hc-shop hc-shop-arcane\" id=\"arcane\"></div>\n  <div class=\"img-rounded items-sprite-50x36 items-sprite-wind_lace\" id=\"wind_lace\" data-bind=\"click: changeSelectedItem, event: { dblclick: addItem }\"></div>\n  <div class=\"img-rounded items-sprite-50x36 items-sprite-magic_stick\" id=\"magic_stick\" data-bind=\"click: changeSelectedItem, event: { dblclick: addItem }\"></div>\n  <div class=\"img-rounded items-sprite-50x36 items-sprite-sobi_mask\" id=\"sobi_mask\" data-bind=\"click: changeSelectedItem, event: { dblclick: addItem }\"></div>\n  <div class=\"img-rounded items-sprite-50x36 items-sprite-ring_of_regen\" id=\"ring_of_regen\" data-bind=\"click: changeSelectedItem, event: { dblclick: addItem }\"></div>\n  <div class=\"img-rounded items-sprite-50x36 items-sprite-boots\" id=\"boots\" data-bind=\"click: changeSelectedItem, event: { dblclick: addItem }\"></div>\n  <div class=\"img-rounded items-sprite-50x36 items-sprite-gloves\" id=\"gloves\" data-bind=\"click: changeSelectedItem, event: { dblclick: addItem }\"></div>\n  <div class=\"img-rounded items-sprite-50x36 items-sprite-cloak\" id=\"cloak\" data-bind=\"click: changeSelectedItem, event: { dblclick: addItem }\"></div>\n  <div class=\"img-rounded items-sprite-50x36 items-sprite-ring_of_health\" id=\"ring_of_health\" data-bind=\"click: changeSelectedItem, event: { dblclick: addItem }\"></div>\n  <div class=\"img-rounded items-sprite-50x36 items-sprite-void_stone\" id=\"void_stone\" data-bind=\"click: changeSelectedItem, event: { dblclick: addItem }\"></div>\n  <div class=\"img-rounded items-sprite-50x36 items-sprite-gem\" id=\"gem\" data-bind=\"click: changeSelectedItem, event: { dblclick: addItem }\"></div>\n  <div class=\"img-rounded items-sprite-50x36 items-sprite-lifesteal\" id=\"lifesteal\" data-bind=\"click: changeSelectedItem, event: { dblclick: addItem }\"></div>\n  <div class=\"img-rounded items-sprite-50x36 items-sprite-shadow_amulet\" id=\"shadow_amulet\" data-bind=\"click: changeSelectedItem, event: { dblclick: addItem }\"></div>\n  <div class=\"img-rounded items-sprite-50x36 items-sprite-ghost\" id=\"ghost\" data-bind=\"click: changeSelectedItem, event: { dblclick: addItem }\"></div>\n  <div class=\"img-rounded items-sprite-50x36 items-sprite-blink\" id=\"blink\" data-bind=\"click: changeSelectedItem, event: { dblclick: addItem }\"></div>\n</div>\n\n\n                </div>\n                <div class=\"tab-pane\" id=\"shop_upgrade\">\n<div class=\"shop-column\">\n  <div class=\"hc-shop hc-shop-common\" id=\"common\"></div>\n  <div class=\"img-rounded items-sprite-50x36 items-sprite-magic_wand\" id=\"magic_wand\" data-bind=\"click: changeSelectedItem, event: { dblclick: addItem }\"></div>\n  <div class=\"img-rounded items-sprite-50x36 items-sprite-null_talisman\" id=\"null_talisman\" data-bind=\"click: changeSelectedItem, event: { dblclick: addItem }\"></div>\n  <div class=\"img-rounded items-sprite-50x36 items-sprite-wraith_band\" id=\"wraith_band\" data-bind=\"click: changeSelectedItem, event: { dblclick: addItem }\"></div>\n  <div class=\"img-rounded items-sprite-50x36 items-sprite-poor_mans_shield\" id=\"poor_mans_shield\" data-bind=\"click: changeSelectedItem, event: { dblclick: addItem }\"></div>\n  <div class=\"img-rounded items-sprite-50x36 items-sprite-bracer\" id=\"bracer\" data-bind=\"click: changeSelectedItem, event: { dblclick: addItem }\"></div>\n  <div class=\"img-rounded items-sprite-50x36 items-sprite-soul_ring\" id=\"soul_ring\" data-bind=\"click: changeSelectedItem, event: { dblclick: addItem }\"></div>\n  <div class=\"img-rounded items-sprite-50x36 items-sprite-phase_boots\" id=\"phase_boots\" data-bind=\"click: changeSelectedItem, event: { dblclick: addItem }\"></div>\n  <div class=\"img-rounded items-sprite-50x36 items-sprite-power_treads\" id=\"power_treads\" data-bind=\"click: changeSelectedItem, event: { dblclick: addItem }\"></div>\n  <div class=\"img-rounded items-sprite-50x36 items-sprite-oblivion_staff\" id=\"oblivion_staff\" data-bind=\"click: changeSelectedItem, event: { dblclick: addItem }\"></div>\n  <div class=\"img-rounded items-sprite-50x36 items-sprite-pers\" id=\"pers\" data-bind=\"click: changeSelectedItem, event: { dblclick: addItem }\"></div>\n  <div class=\"img-rounded items-sprite-50x36 items-sprite-hand_of_midas\" id=\"hand_of_midas\" data-bind=\"click: changeSelectedItem, event: { dblclick: addItem }\"></div>\n  <div class=\"img-rounded items-sprite-50x36 items-sprite-travel_boots\" id=\"travel_boots\" data-bind=\"click: changeSelectedItem, event: { dblclick: addItem }\"></div>\n  <div class=\"img-rounded items-sprite-50x36 items-sprite-moon_shard\" id=\"moon_shard\" data-bind=\"click: changeSelectedItem, event: { dblclick: addItem }\"></div>\n  <div class=\"img-rounded items-sprite-50x36 items-sprite-emptyitembg\" id=\"emptyitembg\"></div>\n</div>\n<div class=\"shop-column\">\n  <div class=\"hc-shop hc-shop-support\" id=\"support\"></div>\n  <div class=\"img-rounded items-sprite-50x36 items-sprite-ring_of_basilius\" id=\"ring_of_basilius\" data-bind=\"click: changeSelectedItem, event: { dblclick: addItem }\"></div>\n  <div class=\"img-rounded items-sprite-50x36 items-sprite-iron_talon\" id=\"iron_talon\" data-bind=\"click: changeSelectedItem, event: { dblclick: addItem }\"></div>\n  <div class=\"img-rounded items-sprite-50x36 items-sprite-headdress\" id=\"headdress\" data-bind=\"click: changeSelectedItem, event: { dblclick: addItem }\"></div>\n  <div class=\"img-rounded items-sprite-50x36 items-sprite-buckler\" id=\"buckler\" data-bind=\"click: changeSelectedItem, event: { dblclick: addItem }\"></div>\n  <div class=\"img-rounded items-sprite-50x36 items-sprite-urn_of_shadows\" id=\"urn_of_shadows\" data-bind=\"click: changeSelectedItem, event: { dblclick: addItem }\"></div>\n  <div class=\"img-rounded items-sprite-50x36 items-sprite-tranquil_boots\" id=\"tranquil_boots\" data-bind=\"click: changeSelectedItem, event: { dblclick: addItem }\"></div>\n  <div class=\"img-rounded items-sprite-50x36 items-sprite-ring_of_aquila\" id=\"ring_of_aquila\" data-bind=\"click: changeSelectedItem, event: { dblclick: addItem }\"></div>\n  <div class=\"img-rounded items-sprite-50x36 items-sprite-medallion_of_courage\" id=\"medallion_of_courage\" data-bind=\"click: changeSelectedItem, event: { dblclick: addItem }\"></div>\n  <div class=\"img-rounded items-sprite-50x36 items-sprite-arcane_boots\" id=\"arcane_boots\" data-bind=\"click: changeSelectedItem, event: { dblclick: addItem }\"></div>\n  <div class=\"img-rounded items-sprite-50x36 items-sprite-ancient_janggo\" id=\"ancient_janggo\" data-bind=\"click: changeSelectedItem, event: { dblclick: addItem }\"></div>\n  <div class=\"img-rounded items-sprite-50x36 items-sprite-mekansm\" id=\"mekansm\" data-bind=\"click: changeSelectedItem, event: { dblclick: addItem }\"></div>\n  <div class=\"img-rounded items-sprite-50x36 items-sprite-vladmir\" id=\"vladmir\" data-bind=\"click: changeSelectedItem, event: { dblclick: addItem }\"></div>\n  <div class=\"img-rounded items-sprite-50x36 items-sprite-pipe\" id=\"pipe\" data-bind=\"click: changeSelectedItem, event: { dblclick: addItem }\"></div>\n  <div class=\"img-rounded items-sprite-50x36 items-sprite-guardian_greaves\" id=\"guardian_greaves\" data-bind=\"click: changeSelectedItem, event: { dblclick: addItem }\"></div>\n</div>\n<div class=\"shop-column\">\n  <div class=\"hc-shop hc-shop-caster\" id=\"caster\"></div>\n  <div class=\"img-rounded items-sprite-50x36 items-sprite-glimmer_cape\" id=\"glimmer_cape\" data-bind=\"click: changeSelectedItem, event: { dblclick: addItem }\"></div>\n  <div class=\"img-rounded items-sprite-50x36 items-sprite-force_staff\" id=\"force_staff\" data-bind=\"click: changeSelectedItem, event: { dblclick: addItem }\"></div>\n  <div class=\"img-rounded items-sprite-50x36 items-sprite-veil_of_discord\" id=\"veil_of_discord\" data-bind=\"click: changeSelectedItem, event: { dblclick: addItem }\"></div>\n  <div class=\"img-rounded items-sprite-50x36 items-sprite-aether_lens\" id=\"aether_lens\" data-bind=\"click: changeSelectedItem, event: { dblclick: addItem }\"></div>\n  <div class=\"img-rounded items-sprite-50x36 items-sprite-necronomicon\" id=\"necronomicon\" data-bind=\"click: changeSelectedItem, event: { dblclick: addItem }\"></div>\n  <div class=\"img-rounded items-sprite-50x36 items-sprite-dagon\" id=\"dagon\" data-bind=\"click: changeSelectedItem, event: { dblclick: addItem }\"></div>\n  <div class=\"img-rounded items-sprite-50x36 items-sprite-cyclone\" id=\"cyclone\" data-bind=\"click: changeSelectedItem, event: { dblclick: addItem }\"></div>\n  <div class=\"img-rounded items-sprite-50x36 items-sprite-solar_crest\" id=\"solar_crest\" data-bind=\"click: changeSelectedItem, event: { dblclick: addItem }\"></div>\n  <div class=\"img-rounded items-sprite-50x36 items-sprite-rod_of_atos\" id=\"rod_of_atos\" data-bind=\"click: changeSelectedItem, event: { dblclick: addItem }\"></div>\n  <div class=\"img-rounded items-sprite-50x36 items-sprite-orchid\" id=\"orchid\" data-bind=\"click: changeSelectedItem, event: { dblclick: addItem }\"></div>\n  <div class=\"img-rounded items-sprite-50x36 items-sprite-ultimate_scepter\" id=\"ultimate_scepter\" data-bind=\"click: changeSelectedItem, event: { dblclick: addItem }\"></div>\n  <div class=\"img-rounded items-sprite-50x36 items-sprite-refresher\" id=\"refresher\" data-bind=\"click: changeSelectedItem, event: { dblclick: addItem }\"></div>\n  <div class=\"img-rounded items-sprite-50x36 items-sprite-sheepstick\" id=\"sheepstick\" data-bind=\"click: changeSelectedItem, event: { dblclick: addItem }\"></div>\n  <div class=\"img-rounded items-sprite-50x36 items-sprite-octarine_core\" id=\"octarine_core\" data-bind=\"click: changeSelectedItem, event: { dblclick: addItem }\"></div>\n</div>\n<div class=\"shop-column\">\n  <div class=\"hc-shop hc-shop-weapons\" id=\"weapons\"></div>\n  <div class=\"img-rounded items-sprite-50x36 items-sprite-lesser_crit\" id=\"lesser_crit\" data-bind=\"click: changeSelectedItem, event: { dblclick: addItem }\"></div>\n  <div class=\"img-rounded items-sprite-50x36 items-sprite-armlet\" id=\"armlet\" data-bind=\"click: changeSelectedItem, event: { dblclick: addItem }\"></div>\n  <div class=\"img-rounded items-sprite-50x36 items-sprite-invis_sword\" id=\"invis_sword\" data-bind=\"click: changeSelectedItem, event: { dblclick: addItem }\"></div>\n  <div class=\"img-rounded items-sprite-50x36 items-sprite-basher\" id=\"basher\" data-bind=\"click: changeSelectedItem, event: { dblclick: addItem }\"></div>\n  <div class=\"img-rounded items-sprite-50x36 items-sprite-bfury\" id=\"bfury\" data-bind=\"click: changeSelectedItem, event: { dblclick: addItem }\"></div>\n  <div class=\"img-rounded items-sprite-50x36 items-sprite-ethereal_blade\" id=\"ethereal_blade\" data-bind=\"click: changeSelectedItem, event: { dblclick: addItem }\"></div>\n  <div class=\"img-rounded items-sprite-50x36 items-sprite-silver_edge\" id=\"silver_edge\" data-bind=\"click: changeSelectedItem, event: { dblclick: addItem }\"></div>\n  <div class=\"img-rounded items-sprite-50x36 items-sprite-radiance\" id=\"radiance\" data-bind=\"click: changeSelectedItem, event: { dblclick: addItem }\"></div>\n  <div class=\"img-rounded items-sprite-50x36 items-sprite-monkey_king_bar\" id=\"monkey_king_bar\" data-bind=\"click: changeSelectedItem, event: { dblclick: addItem }\"></div>\n  <div class=\"img-rounded items-sprite-50x36 items-sprite-greater_crit\" id=\"greater_crit\" data-bind=\"click: changeSelectedItem, event: { dblclick: addItem }\"></div>\n  <div class=\"img-rounded items-sprite-50x36 items-sprite-butterfly\" id=\"butterfly\" data-bind=\"click: changeSelectedItem, event: { dblclick: addItem }\"></div>\n  <div class=\"img-rounded items-sprite-50x36 items-sprite-rapier\" id=\"rapier\" data-bind=\"click: changeSelectedItem, event: { dblclick: addItem }\"></div>\n  <div class=\"img-rounded items-sprite-50x36 items-sprite-abyssal_blade\" id=\"abyssal_blade\" data-bind=\"click: changeSelectedItem, event: { dblclick: addItem }\"></div>\n  <div class=\"img-rounded items-sprite-50x36 items-sprite-bloodthorn\" id=\"bloodthorn\" data-bind=\"click: changeSelectedItem, event: { dblclick: addItem }\"></div>\n</div>\n<div class=\"shop-column\">\n  <div class=\"hc-shop hc-shop-armor\" id=\"armor\"></div>\n  <div class=\"img-rounded items-sprite-50x36 items-sprite-hood_of_defiance\" id=\"hood_of_defiance\" data-bind=\"click: changeSelectedItem, event: { dblclick: addItem }\"></div>\n  <div class=\"img-rounded items-sprite-50x36 items-sprite-vanguard\" id=\"vanguard\" data-bind=\"click: changeSelectedItem, event: { dblclick: addItem }\"></div>\n  <div class=\"img-rounded items-sprite-50x36 items-sprite-blade_mail\" id=\"blade_mail\" data-bind=\"click: changeSelectedItem, event: { dblclick: addItem }\"></div>\n  <div class=\"img-rounded items-sprite-50x36 items-sprite-soul_booster\" id=\"soul_booster\" data-bind=\"click: changeSelectedItem, event: { dblclick: addItem }\"></div>\n  <div class=\"img-rounded items-sprite-50x36 items-sprite-crimson_guard\" id=\"crimson_guard\" data-bind=\"click: changeSelectedItem, event: { dblclick: addItem }\"></div>\n  <div class=\"img-rounded items-sprite-50x36 items-sprite-black_king_bar\" id=\"black_king_bar\" data-bind=\"click: changeSelectedItem, event: { dblclick: addItem }\"></div>\n  <div class=\"img-rounded items-sprite-50x36 items-sprite-lotus_orb\" id=\"lotus_orb\" data-bind=\"click: changeSelectedItem, event: { dblclick: addItem }\"></div>\n  <div class=\"img-rounded items-sprite-50x36 items-sprite-shivas_guard\" id=\"shivas_guard\" data-bind=\"click: changeSelectedItem, event: { dblclick: addItem }\"></div>\n  <div class=\"img-rounded items-sprite-50x36 items-sprite-bloodstone\" id=\"bloodstone\" data-bind=\"click: changeSelectedItem, event: { dblclick: addItem }\"></div>\n  <div class=\"img-rounded items-sprite-50x36 items-sprite-manta\" id=\"manta\" data-bind=\"click: changeSelectedItem, event: { dblclick: addItem }\"></div>\n  <div class=\"img-rounded items-sprite-50x36 items-sprite-sphere\" id=\"sphere\" data-bind=\"click: changeSelectedItem, event: { dblclick: addItem }\"></div>\n  <div class=\"img-rounded items-sprite-50x36 items-sprite-hurricane_pike\" id=\"hurricane_pike\" data-bind=\"click: changeSelectedItem, event: { dblclick: addItem }\"></div>\n  <div class=\"img-rounded items-sprite-50x36 items-sprite-assault\" id=\"assault\" data-bind=\"click: changeSelectedItem, event: { dblclick: addItem }\"></div>\n  <div class=\"img-rounded items-sprite-50x36 items-sprite-heart\" id=\"heart\" data-bind=\"click: changeSelectedItem, event: { dblclick: addItem }\"></div>\n</div>\n<div class=\"shop-column\">\n  <div class=\"hc-shop hc-shop-artifacts\" id=\"artifacts\"></div>\n  <div class=\"img-rounded items-sprite-50x36 items-sprite-mask_of_madness\" id=\"mask_of_madness\" data-bind=\"click: changeSelectedItem, event: { dblclick: addItem }\"></div>\n  <div class=\"img-rounded items-sprite-50x36 items-sprite-helm_of_the_dominator\" id=\"helm_of_the_dominator\" data-bind=\"click: changeSelectedItem, event: { dblclick: addItem }\"></div>\n  <div class=\"img-rounded items-sprite-50x36 items-sprite-dragon_lance\" id=\"dragon_lance\" data-bind=\"click: changeSelectedItem, event: { dblclick: addItem }\"></div>\n  <div class=\"img-rounded items-sprite-50x36 items-sprite-sange\" id=\"sange\" data-bind=\"click: changeSelectedItem, event: { dblclick: addItem }\"></div>\n  <div class=\"img-rounded items-sprite-50x36 items-sprite-yasha\" id=\"yasha\" data-bind=\"click: changeSelectedItem, event: { dblclick: addItem }\"></div>\n  <div class=\"img-rounded items-sprite-50x36 items-sprite-echo_sabre\" id=\"echo_sabre\" data-bind=\"click: changeSelectedItem, event: { dblclick: addItem }\"></div>\n  <div class=\"img-rounded items-sprite-50x36 items-sprite-maelstrom\" id=\"maelstrom\" data-bind=\"click: changeSelectedItem, event: { dblclick: addItem }\"></div>\n  <div class=\"img-rounded items-sprite-50x36 items-sprite-diffusal_blade\" id=\"diffusal_blade\" data-bind=\"click: changeSelectedItem, event: { dblclick: addItem }\"></div>\n  <div class=\"img-rounded items-sprite-50x36 items-sprite-desolator\" id=\"desolator\" data-bind=\"click: changeSelectedItem, event: { dblclick: addItem }\"></div>\n  <div class=\"img-rounded items-sprite-50x36 items-sprite-heavens_halberd\" id=\"heavens_halberd\" data-bind=\"click: changeSelectedItem, event: { dblclick: addItem }\"></div>\n  <div class=\"img-rounded items-sprite-50x36 items-sprite-sange_and_yasha\" id=\"sange_and_yasha\" data-bind=\"click: changeSelectedItem, event: { dblclick: addItem }\"></div>\n  <div class=\"img-rounded items-sprite-50x36 items-sprite-skadi\" id=\"skadi\" data-bind=\"click: changeSelectedItem, event: { dblclick: addItem }\"></div>\n  <div class=\"img-rounded items-sprite-50x36 items-sprite-mjollnir\" id=\"mjollnir\" data-bind=\"click: changeSelectedItem, event: { dblclick: addItem }\"></div>\n  <div class=\"img-rounded items-sprite-50x36 items-sprite-satanic\" id=\"satanic\" data-bind=\"click: changeSelectedItem, event: { dblclick: addItem }\"></div>\n</div>\n                </div>\n                <div class=\"tab-pane\" id=\"shop_secret\">\n<div class=\"shop-column\">\n  <div class=\"hc-shop hc-shop-secret\" id=\"secret\"></div>\n  <div class=\"img-rounded items-sprite-50x36 items-sprite-energy_booster\" id=\"energy_booster\" data-bind=\"click: changeSelectedItem, event: { dblclick: addItem }\"></div>\n  <div class=\"img-rounded items-sprite-50x36 items-sprite-vitality_booster\" id=\"vitality_booster\" data-bind=\"click: changeSelectedItem, event: { dblclick: addItem }\"></div>\n  <div class=\"img-rounded items-sprite-50x36 items-sprite-point_booster\" id=\"point_booster\" data-bind=\"click: changeSelectedItem, event: { dblclick: addItem }\"></div>\n  <div class=\"img-rounded items-sprite-50x36 items-sprite-platemail\" id=\"platemail\" data-bind=\"click: changeSelectedItem, event: { dblclick: addItem }\"></div>\n  <div class=\"img-rounded items-sprite-50x36 items-sprite-talisman_of_evasion\" id=\"talisman_of_evasion\" data-bind=\"click: changeSelectedItem, event: { dblclick: addItem }\"></div>\n  <div class=\"img-rounded items-sprite-50x36 items-sprite-hyperstone\" id=\"hyperstone\" data-bind=\"click: changeSelectedItem, event: { dblclick: addItem }\"></div>\n  <div class=\"img-rounded items-sprite-50x36 items-sprite-ultimate_orb\" id=\"ultimate_orb\" data-bind=\"click: changeSelectedItem, event: { dblclick: addItem }\"></div>\n  <div class=\"img-rounded items-sprite-50x36 items-sprite-demon_edge\" id=\"demon_edge\" data-bind=\"click: changeSelectedItem, event: { dblclick: addItem }\"></div>\n  <div class=\"img-rounded items-sprite-50x36 items-sprite-mystic_staff\" id=\"mystic_staff\" data-bind=\"click: changeSelectedItem, event: { dblclick: addItem }\"></div>\n  <div class=\"img-rounded items-sprite-50x36 items-sprite-eagle\" id=\"eagle\" data-bind=\"click: changeSelectedItem, event: { dblclick: addItem }\"></div>\n  <div class=\"img-rounded items-sprite-50x36 items-sprite-reaver\" id=\"reaver\" data-bind=\"click: changeSelectedItem, event: { dblclick: addItem }\"></div>\n  <div class=\"img-rounded items-sprite-50x36 items-sprite-relic\" id=\"relic\" data-bind=\"click: changeSelectedItem, event: { dblclick: addItem }\"></div>\n</div>\n                </div>\n            </div>\n\n            <div class=\"form-group\" data-bind=\"visible: displayShop()\">\n                <div class=\"input-group\">\n                    <input class=\"form-control\" id=\"auto\" data-bind=\"jqAuto: { autoFocus: true, html: true }, jqAutoSource: itemOptions, jqAutoValue: selectedItem, jqAutoSourceLabel: 'displayname', jqAutoSourceInputValue: 'name', jqAutoSourceValue: 'value'\" />\n                    <span class=\"input-group-btn\">\n                        <button class=\"btn btn-default\" data-bind=\"jqAutoCombo: 'auto'\"><span class=\"glyphicon glyphicon-search\"></span></button>\n                    </span>\n                </div>\n            </div>\n\n            <div data-bind=\"visible: selectedItem() && displayShop()\">\n                <button class=\"btn btn-default btn-xs glyphicon glyphicon-minus pull-right\" data-bind=\"toggle: displayShopItemTooltip, visible: displayShopItemTooltip()\" title=\"Hide item description\"></button>\n                <button class=\"btn btn-default btn-xs glyphicon glyphicon-plus pull-right\" data-bind=\"toggle: displayShopItemTooltip, visible: !displayShopItemTooltip()\" title=\"Show item description\"></button>\n                <div data-bind=\"html: getItemTooltipData, css: { 'hide-shop-item-details': !displayShopItemTooltip() }\"></div>\n                <div style=\"margin-top:10px;margin-bottom:10px;\" class=\"form-inline\" data-bind=\"visible: getItemInputLabel() != ''\">\n                    <div class=\"form-group\">\n                        <label for=\"iteminput\" data-bind=\"text: getItemInputLabel\"></label>\n                        <input class=\"form-control\" id=\"iteminput\" data-bind=\"value: itemInputValue\" />\n                    </div>\n                </div>\n                <div class=\"form-group text-right\">\n                    <button class=\"btn btn-default\" data-bind=\"click: addItem\">Add Item</button>\n                </div>\n            </div>\n        </div>"
};
},{}],86:[function(require,module,exports){
var Chart = require('chart.js');
Chart.types.Line.extend({
    // Passing in a name registers this chart in the Chart namespace in the same way
    name: "Scatter",
    draw : function(ease){
            var easingDecimal = ease || 1;
            this.clear();

            var ctx = this.chart.ctx;

            // Some helper methods for getting the next/prev points
            var hasValue = function(item){
                return item.value !== null;
            },
            nextPoint = function(point, collection, index){
                return Chart.helpers.findNextWhere(collection, hasValue, index) || point;
            },
            previousPoint = function(point, collection, index){
                return Chart.helpers.findPreviousWhere(collection, hasValue, index) || point;
            };

            this.scale.draw(easingDecimal);


            Chart.helpers.each(this.datasets,function(dataset){
                var pointsWithValues = Chart.helpers.where(dataset.points, hasValue);

                //Transition each point first so that the line and point drawing isn't out of sync
                //We can use this extra loop to calculate the control points of this dataset also in this loop

                Chart.helpers.each(dataset.points, function(point, index){
                    if (point.hasValue()){
                        point.transition({
                            y : this.scale.calculateY(point.value),
                            x : this.scale.calculateX(index)
                        }, easingDecimal);
                    }
                },this);


                // Control points need to be calculated in a seperate loop, because we need to know the current x/y of the point
                // This would cause issues when there is no animation, because the y of the next point would be 0, so beziers would be skewed
                if (this.options.bezierCurve){
                    Chart.helpers.each(pointsWithValues, function(point, index){
                        var tension = (index > 0 && index < pointsWithValues.length - 1) ? this.options.bezierCurveTension : 0;
                        point.controlPoints = Chart.helpers.splineCurve(
                            previousPoint(point, pointsWithValues, index),
                            point,
                            nextPoint(point, pointsWithValues, index),
                            tension
                        );

                        // Prevent the bezier going outside of the bounds of the graph

                        // Cap puter bezier handles to the upper/lower scale bounds
                        if (point.controlPoints.outer.y > this.scale.endPoint){
                            point.controlPoints.outer.y = this.scale.endPoint;
                        }
                        else if (point.controlPoints.outer.y < this.scale.startPoint){
                            point.controlPoints.outer.y = this.scale.startPoint;
                        }

                        // Cap inner bezier handles to the upper/lower scale bounds
                        if (point.controlPoints.inner.y > this.scale.endPoint){
                            point.controlPoints.inner.y = this.scale.endPoint;
                        }
                        else if (point.controlPoints.inner.y < this.scale.startPoint){
                            point.controlPoints.inner.y = this.scale.startPoint;
                        }
                    },this);
                }

                if (this.options.datasetFill && pointsWithValues.length > 0){
                    //Round off the line by going to the base of the chart, back to the start, then fill.
                    ctx.lineTo(pointsWithValues[pointsWithValues.length - 1].x, this.scale.endPoint);
                    ctx.lineTo(pointsWithValues[0].x, this.scale.endPoint);
                    ctx.fillStyle = dataset.fillColor;
                    ctx.closePath();
                    ctx.fill();
                }

                //Now draw the points over the line
                //A little inefficient double looping, but better than the line
                //lagging behind the point positions
                Chart.helpers.each(pointsWithValues,function(point){
                    point.draw();
                });
            },this);
        }
});
},{"chart.js":46}],87:[function(require,module,exports){
(function (global){
require("./app/polyfill");
var Rollbar = require("rollbar-browser");
var $ = (typeof window !== "undefined" ? window['$'] : typeof global !== "undefined" ? global['$'] : null);
var getParameterByName = require("./app/getParameterByName");
var HeroCalc = require("dota-hero-calculator-library");
var HeroCalculatorViewModel = require('./app/HeroCalculatorViewModel');
var viewModel;

var App = function (appConfig) {
    
    HeroCalc.init(null, null, null, function () {
        
        viewModel = new HeroCalculatorViewModel(appConfig.abilityTooltipPath);
        ko.options.deferUpdates = true;
        ko.applyBindings(viewModel);
        $('#spinner').hide();
        $('.initial-hidden').css('display', 'inline-block');
        $('#popHero0').addClass('active');
        $('#heroPane0').addClass('active');
        $('[data-toggle="tooltip"]').tooltip();
        var saveId = getParameterByName('id');
        if (saveId) {
            $.get('save/' + saveId + '.json', function (data) {
                viewModel.load(data);
            });
        }
    });

    var lastUpdate = "#DEV_BUILD";
    $('#last-update').text(lastUpdate);

    var rollbarConfig = {
        accessToken: 'de1980fcab4849d6a7a066cf098a6521',
        captureUncaught: true,
        payload: {
            environment: 'development',
            client: {
                javascript: {
                    source_map_enabled: true,
                    code_version: "#code_version",
                    // Optionally have Rollbar guess which frames the error was thrown from
                    // when the browser does not provide line and column numbers.
                    guess_uncaught_frames: true
                }
            }
        }
    };

    var rollbar = Rollbar.init(rollbarConfig);

    $('.error-warning-view, .error-warning-close').click(function () {
        $('.error-warning').fadeOut(200);
    });

    var userActions = [];
    function addUserAction(o) {
        if (userActions.length > 10) {
            userActions.shift();
        }
        userActions.push(o);
    }

    function actionTrackWrapper(func, eventName) {
        return function() {
            var el = this;
            var data = {
                eventName: eventName
            };
            if (el.id) data.id = el.id;
            if (el.src) data.src = el.src;
            if (el.className) data.className = el.className;
            if (el.textContent) data.textContent = el.textContent;
            if (el.nodeName) data.nodeName = el.nodeName;
            if (el.getAttribute('data-bind')) data['data-bind'] = el.getAttribute('data-bind');
            
            for (var property in data) {
                if (data.hasOwnProperty(property)) {
                    data[property] = data[property].substring(0, Math.min(200, data[property].length));
                }
            }
            addUserAction(data);
            return func.apply(this, arguments);
        }
    }

    function callbackWrap(object, property, argumentIndex, wrapperFactory, eventFilter) {
        var original = object[property];
        object[property] = function() {
            if (eventFilter.indexOf(arguments[0]) != -1) {
                arguments[argumentIndex] = wrapperFactory(arguments[argumentIndex], arguments[0]);
            }
            return original.apply(this, arguments);
        }
        return original;
    }

    callbackWrap(Element.prototype, "addEventListener", 1, actionTrackWrapper, ['click', 'focus', 'blur', 'change', 'dblclick'])

    window.onerror = (function (old) {
        return function () {
            var payload = {};
            var logEl = document.querySelector('#log');

            if (logEl) {
                try {
                    var msg = arguments[0];
                    var el = document.createElement('div');
                    el.classList.add('alert');
                    el.classList.add('alert-danger');
                    el.classList.add('error-log');
                    el.classList.add('col-md-12');
                    el.textContent = 'error: ' + msg;
                    
                    var closeBtn = document.createElement('div');
                    closeBtn.classList.add('error-log-close');
                    closeBtn.innerHTML = "&times;";
                    closeBtn.onclick = function () {
                        logEl.removeChild(el);
                    }
                    el.appendChild(closeBtn);
                    
                    var reportEl = document.createElement('a');
                    reportEl.classList.add('error-log-link');
                    reportEl.innerHTML = "Send error report";
                    reportEl.href = "#"
                    reportEl.onclick = function () {
                        $('#myModal').modal('show');
                        $('#BugReportFormText').text('error: ' + msg + '\n\nDescribe what you were doing. Try to be as detailed as possible.');
                    }
                    el.appendChild(reportEl);
                    
                    logEl.appendChild(el);
                    
                    $('.error-warning').fadeOut(200).fadeIn(100);
                }
                catch (e) {
                    rollbar.error("window.onerror create error log failed.", e);
                }
            }
            else {
                payload.clientLogCreated = false;
            }

            if (HeroCalculatorViewModel && viewModel) {
                try {
                    payload.heroCalcState = viewModel.getSaveData();
                }
                catch (e) {
                    rollbar.error("window.onerror getSaveData failed.", e);
                }
                try {
                    payload.appState = viewModel.getAppState();
                }
                catch (e) {
                    rollbar.error("window.onerror getAppState failed.", e);
                }
            }
            else {
                payload.appState = "load failed"
            }
            payload.userActions = userActions;
            rollbar.configure({
              payload: {custom: payload}
            });
            
            return old.apply(this, arguments);
        }
    })(window.onerror);
    
};

module.exports = App;
}).call(this,typeof global !== "undefined" ? global : typeof self !== "undefined" ? self : typeof window !== "undefined" ? window : {})

},{"./app/HeroCalculatorViewModel":73,"./app/getParameterByName":78,"./app/polyfill":84,"dota-hero-calculator-library":35,"rollbar-browser":69}]},{},[87])(87)
});
//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJzb3VyY2VzIjpbIm5vZGVfbW9kdWxlcy9icm93c2VyLXBhY2svX3ByZWx1ZGUuanMiLCIuLi9kb3RhLWhlcm8tY2FsY3VsYXRvci1saWJyYXJ5L3NyYy9oZXJvY2FsYy9BYmlsaXR5TW9kZWwuanMiLCIuLi9kb3RhLWhlcm8tY2FsY3VsYXRvci1saWJyYXJ5L3NyYy9oZXJvY2FsYy9CdWZmVmlld01vZGVsLmpzIiwiLi4vZG90YS1oZXJvLWNhbGN1bGF0b3ItbGlicmFyeS9zcmMvaGVyb2NhbGMvYnVmZnMvQnVmZk1vZGVsLmpzIiwiLi4vZG90YS1oZXJvLWNhbGN1bGF0b3ItbGlicmFyeS9zcmMvaGVyb2NhbGMvYnVmZnMvYnVmZk9wdGlvbnNBcnJheS5qcyIsIi4uL2RvdGEtaGVyby1jYWxjdWxhdG9yLWxpYnJhcnkvc3JjL2hlcm9jYWxjL2J1ZmZzL2RlYnVmZk9wdGlvbnNBcnJheS5qcyIsIi4uL2RvdGEtaGVyby1jYWxjdWxhdG9yLWxpYnJhcnkvc3JjL2hlcm9jYWxjL2RhdGEvbWFpbi5qcyIsIi4uL2RvdGEtaGVyby1jYWxjdWxhdG9yLWxpYnJhcnkvc3JjL2hlcm9jYWxjL2hlcm8vQ2xvbmVNb2RlbC5qcyIsIi4uL2RvdGEtaGVyby1jYWxjdWxhdG9yLWxpYnJhcnkvc3JjL2hlcm9jYWxjL2hlcm8vRGFtYWdlVHlwZUNvbG9yLmpzIiwiLi4vZG90YS1oZXJvLWNhbGN1bGF0b3ItbGlicmFyeS9zcmMvaGVyb2NhbGMvaGVyby9IZXJvRGFtYWdlTWl4aW4uanMiLCIuLi9kb3RhLWhlcm8tY2FsY3VsYXRvci1saWJyYXJ5L3NyYy9oZXJvY2FsYy9oZXJvL0hlcm9Nb2RlbC5qcyIsIi4uL2RvdGEtaGVyby1jYWxjdWxhdG9yLWxpYnJhcnkvc3JjL2hlcm9jYWxjL2hlcm8vSGVyb09wdGlvbi5qcyIsIi4uL2RvdGEtaGVyby1jYWxjdWxhdG9yLWxpYnJhcnkvc3JjL2hlcm9jYWxjL2hlcm8vSWxsdXNpb25Nb2RlbC5qcyIsIi4uL2RvdGEtaGVyby1jYWxjdWxhdG9yLWxpYnJhcnkvc3JjL2hlcm9jYWxjL2hlcm8vVGFsZW50Q29udHJvbGxlci5qcyIsIi4uL2RvdGEtaGVyby1jYWxjdWxhdG9yLWxpYnJhcnkvc3JjL2hlcm9jYWxjL2hlcm8vVW5pdE1vZGVsLmpzIiwiLi4vZG90YS1oZXJvLWNhbGN1bGF0b3ItbGlicmFyeS9zcmMvaGVyb2NhbGMvaGVyby9Vbml0T3B0aW9uLmpzIiwiLi4vZG90YS1oZXJvLWNhbGN1bGF0b3ItbGlicmFyeS9zcmMvaGVyb2NhbGMvaGVyby9kaWZmUHJvcGVydGllcy5qcyIsIi4uL2RvdGEtaGVyby1jYWxjdWxhdG9yLWxpYnJhcnkvc3JjL2hlcm9jYWxjL2hlcm8vaGVyb09wdGlvbnNBcnJheS5qcyIsIi4uL2RvdGEtaGVyby1jYWxjdWxhdG9yLWxpYnJhcnkvc3JjL2hlcm9jYWxjL2hlcm8vbmV4dExldmVsRXhwLmpzIiwiLi4vZG90YS1oZXJvLWNhbGN1bGF0b3ItbGlicmFyeS9zcmMvaGVyb2NhbGMvaGVyby90b3RhbEV4cC5qcyIsIi4uL2RvdGEtaGVyby1jYWxjdWxhdG9yLWxpYnJhcnkvc3JjL2hlcm9jYWxjL2hlcm9jYWxjX2FiaWxpdHlkYXRhLmpzIiwiLi4vZG90YS1oZXJvLWNhbGN1bGF0b3ItbGlicmFyeS9zcmMvaGVyb2NhbGMvaGVyb2NhbGNfa25vY2tvdXQuanMiLCIuLi9kb3RhLWhlcm8tY2FsY3VsYXRvci1saWJyYXJ5L3NyYy9oZXJvY2FsYy9pbGx1c2lvbi9JbGx1c2lvbk9wdGlvbi5qcyIsIi4uL2RvdGEtaGVyby1jYWxjdWxhdG9yLWxpYnJhcnkvc3JjL2hlcm9jYWxjL2lsbHVzaW9uL2lsbHVzaW9uRGF0YS5qcyIsIi4uL2RvdGEtaGVyby1jYWxjdWxhdG9yLWxpYnJhcnkvc3JjL2hlcm9jYWxjL2lsbHVzaW9uL2lsbHVzaW9uT3B0aW9uc0FycmF5LmpzIiwiLi4vZG90YS1oZXJvLWNhbGN1bGF0b3ItbGlicmFyeS9zcmMvaGVyb2NhbGMvaW52ZW50b3J5L0Jhc2ljSW52ZW50b3J5Vmlld01vZGVsLmpzIiwiLi4vZG90YS1oZXJvLWNhbGN1bGF0b3ItbGlicmFyeS9zcmMvaGVyb2NhbGMvaW52ZW50b3J5L0ludmVudG9yeVZpZXdNb2RlbC5qcyIsIi4uL2RvdGEtaGVyby1jYWxjdWxhdG9yLWxpYnJhcnkvc3JjL2hlcm9jYWxjL2ludmVudG9yeS9JdGVtSW5wdXQuanMiLCIuLi9kb3RhLWhlcm8tY2FsY3VsYXRvci1saWJyYXJ5L3NyYy9oZXJvY2FsYy9pbnZlbnRvcnkvaXRlbUJ1ZmZPcHRpb25zLmpzIiwiLi4vZG90YS1oZXJvLWNhbGN1bGF0b3ItbGlicmFyeS9zcmMvaGVyb2NhbGMvaW52ZW50b3J5L2l0ZW1EZWJ1ZmZPcHRpb25zLmpzIiwiLi4vZG90YS1oZXJvLWNhbGN1bGF0b3ItbGlicmFyeS9zcmMvaGVyb2NhbGMvaW52ZW50b3J5L2l0ZW1PcHRpb25zQXJyYXkuanMiLCIuLi9kb3RhLWhlcm8tY2FsY3VsYXRvci1saWJyYXJ5L3NyYy9oZXJvY2FsYy9pbnZlbnRvcnkvaXRlbXNXaXRoQWN0aXZlLmpzIiwiLi4vZG90YS1oZXJvLWNhbGN1bGF0b3ItbGlicmFyeS9zcmMvaGVyb2NhbGMvaW52ZW50b3J5L2xldmVsSXRlbXMuanMiLCIuLi9kb3RhLWhlcm8tY2FsY3VsYXRvci1saWJyYXJ5L3NyYy9oZXJvY2FsYy9pbnZlbnRvcnkvc3RhY2thYmxlSXRlbXMuanMiLCIuLi9kb3RhLWhlcm8tY2FsY3VsYXRvci1saWJyYXJ5L3NyYy9oZXJvY2FsYy9pbnZlbnRvcnkvdmFsaWRJdGVtcy5qcyIsIi4uL2RvdGEtaGVyby1jYWxjdWxhdG9yLWxpYnJhcnkvc3JjL2hlcm9jYWxjL21haW4uanMiLCIuLi9kb3RhLWhlcm8tY2FsY3VsYXRvci1saWJyYXJ5L3NyYy9oZXJvY2FsYy91dGlsL2V4dGVuZC5qcyIsIi4uL2RvdGEtaGVyby1jYWxjdWxhdG9yLWxpYnJhcnkvc3JjL2hlcm9jYWxjL3V0aWwvZmluZFdoZXJlLmpzIiwiLi4vZG90YS1oZXJvLWNhbGN1bGF0b3ItbGlicmFyeS9zcmMvaGVyb2NhbGMvdXRpbC9nZXRKU09OLmpzIiwiLi4vZG90YS1oZXJvLWNhbGN1bGF0b3ItbGlicmFyeS9zcmMvaGVyb2NhbGMvdXRpbC9pc0VtcHR5LmpzIiwiLi4vZG90YS1oZXJvLWNhbGN1bGF0b3ItbGlicmFyeS9zcmMvaGVyb2NhbGMvdXRpbC9tYWluLmpzIiwiLi4vZG90YS1oZXJvLWNhbGN1bGF0b3ItbGlicmFyeS9zcmMvaGVyb2NhbGMvdXRpbC91bmlvbi5qcyIsIi4uL2RvdGEtaGVyby1jYWxjdWxhdG9yLWxpYnJhcnkvc3JjL2hlcm9jYWxjL3V0aWwvdW5pcXVlSWQuanMiLCIuLi9kb3RhLWhlcm8tY2FsY3VsYXRvci1saWJyYXJ5L3NyYy9oZXJvY2FsYy91dGlsL3VuaXF1ZXMuanMiLCIuLi9kb3RhLWhlcm8tY2FsY3VsYXRvci1saWJyYXJ5L3NyYy9saWIva25vY2tvdXQubWFwcGluZy5qcyIsIi4uL2RvdGEtaGVyby1jYWxjdWxhdG9yLWxpYnJhcnkvc3JjL2xpYi9rbm9ja291dC53cmFwLmpzIiwibm9kZV9tb2R1bGVzL2NoYXJ0LmpzL0NoYXJ0LmpzIiwibm9kZV9tb2R1bGVzL2pxdWVyeS11aS91aS9kYXRhLmpzIiwibm9kZV9tb2R1bGVzL2pxdWVyeS11aS91aS9kaXNhYmxlLXNlbGVjdGlvbi5qcyIsIm5vZGVfbW9kdWxlcy9qcXVlcnktdWkvdWkvZm9jdXNhYmxlLmpzIiwibm9kZV9tb2R1bGVzL2pxdWVyeS11aS91aS9pZS5qcyIsIm5vZGVfbW9kdWxlcy9qcXVlcnktdWkvdWkva2V5Y29kZS5qcyIsIm5vZGVfbW9kdWxlcy9qcXVlcnktdWkvdWkvcGx1Z2luLmpzIiwibm9kZV9tb2R1bGVzL2pxdWVyeS11aS91aS9wb3NpdGlvbi5qcyIsIm5vZGVfbW9kdWxlcy9qcXVlcnktdWkvdWkvc2FmZS1hY3RpdmUtZWxlbWVudC5qcyIsIm5vZGVfbW9kdWxlcy9qcXVlcnktdWkvdWkvc2FmZS1ibHVyLmpzIiwibm9kZV9tb2R1bGVzL2pxdWVyeS11aS91aS9zY3JvbGwtcGFyZW50LmpzIiwibm9kZV9tb2R1bGVzL2pxdWVyeS11aS91aS90YWJiYWJsZS5qcyIsIm5vZGVfbW9kdWxlcy9qcXVlcnktdWkvdWkvdW5pcXVlLWlkLmpzIiwibm9kZV9tb2R1bGVzL2pxdWVyeS11aS91aS92ZXJzaW9uLmpzIiwibm9kZV9tb2R1bGVzL2pxdWVyeS11aS91aS93aWRnZXQuanMiLCJub2RlX21vZHVsZXMvanF1ZXJ5LXVpL3VpL3dpZGdldHMvYXV0b2NvbXBsZXRlLmpzIiwibm9kZV9tb2R1bGVzL2pxdWVyeS11aS91aS93aWRnZXRzL2J1dHRvbi5qcyIsIm5vZGVfbW9kdWxlcy9qcXVlcnktdWkvdWkvd2lkZ2V0cy9kaWFsb2cuanMiLCJub2RlX21vZHVsZXMvanF1ZXJ5LXVpL3VpL3dpZGdldHMvZHJhZ2dhYmxlLmpzIiwibm9kZV9tb2R1bGVzL2pxdWVyeS11aS91aS93aWRnZXRzL21lbnUuanMiLCJub2RlX21vZHVsZXMvanF1ZXJ5LXVpL3VpL3dpZGdldHMvbW91c2UuanMiLCJub2RlX21vZHVsZXMvanF1ZXJ5LXVpL3VpL3dpZGdldHMvcmVzaXphYmxlLmpzIiwibm9kZV9tb2R1bGVzL2pxdWVyeS11aS91aS93aWRnZXRzL3NwaW5uZXIuanMiLCJub2RlX21vZHVsZXMvcm9sbGJhci1icm93c2VyL2Rpc3Qvcm9sbGJhci51bWQubm9qc29uLm1pbi5qcyIsInNyYy9qcy9hcHAvQnVpbGRFeHBsb3JlclZpZXdNb2RlbC5qcyIsInNyYy9qcy9hcHAvQ2xvbmVWaWV3TW9kZWwuanMiLCJzcmMvanMvYXBwL0RhbWFnZUFtcFZpZXdNb2RlbC5qcyIsInNyYy9qcy9hcHAvSGVyb0NhbGN1bGF0b3JWaWV3TW9kZWwuanMiLCJzcmMvanMvYXBwL0hlcm9EYW1hZ2VBbXBNaXhpbi5qcyIsInNyYy9qcy9hcHAvSGVyb1ZpZXdNb2RlbC5qcyIsInNyYy9qcy9hcHAvSWxsdXNpb25WaWV3TW9kZWwuanMiLCJzcmMvanMvYXBwL1VuaXRWaWV3TW9kZWwuanMiLCJzcmMvanMvYXBwL2dldFBhcmFtZXRlckJ5TmFtZS5qcyIsInNyYy9qcy9hcHAvaGVyb2NhbGNfa25vY2tvdXQuanMiLCJzcmMvanMvYXBwL2hlcm9jYWxjX3Rvb2x0aXBzX2FiaWxpdHkuanMiLCJzcmMvanMvYXBwL2hlcm9jYWxjX3Rvb2x0aXBzX2l0ZW0uanMiLCJzcmMvanMvYXBwL2pxdWVyeS11aS5jdXN0b20uanMiLCJzcmMvanMvYXBwL2tvLmV4dGVuZGVycy5hc3luYy5qcyIsInNyYy9qcy9hcHAvcG9seWZpbGwuanMiLCJzcmMvanMvY29tcG9uZW50cy9zaG9wLmpzIiwic3JjL2pzL2xpYi9DaGFydC5zY2F0dGVyLmpzIiwic3JjL2pzL21haW4uanMiXSwibmFtZXMiOltdLCJtYXBwaW5ncyI6IkFBQUE7QUNBQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7O0FDbjFFQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7O0FDOU1BO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTs7QUNwQkE7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7O0FDbkRBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7OztBQ3ZHQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBOzs7O0FDM0ZBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBOztBQ1pBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7O0FDUEE7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTs7QUNycEJBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBOztBQ25rQkE7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7O0FDTkE7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTs7QUMzSUE7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBOztBQ2hMQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7O0FDeFNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBOztBQ1RBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTs7QUNuQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBOztBQ2RBO0FBQ0E7QUFDQTs7QUNGQTtBQUNBO0FBQ0E7O0FDRkE7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTs7O0FDditHQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7Ozs7QUNuQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7O0FDTkE7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7O0FDdEdBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTs7QUNSQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTs7QUM5S0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTs7QUNydENBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBOztBQ3JCQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBOztBQ2JBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBOztBQ3hCQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTs7QUNmQTs7QUNBQTs7QUNBQTs7QUNBQTs7QUNBQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBOztBQ3pCQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBOztBQ3RCQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7O0FDWEE7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTs7QUN6QkE7QUFDQTtBQUNBO0FBQ0E7QUFDQTs7QUNKQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBOztBQ1ZBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTs7QUNSQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7O0FDUkE7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7OztBQ1RBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7Ozs7O0FDcnlCQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBOzs7O0FDaE5BO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7O0FDeHBIQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTs7QUN2Q0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTs7QUM5Q0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7O0FDcEZBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBOztBQ2ZBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBOztBQzdDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7O0FDNUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBOztBQ2xmQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBOztBQ3hDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTs7QUNyQkE7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7O0FDN0NBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTs7QUNuQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTs7QUNqREE7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBOztBQ2pCQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBOztBQzd0QkE7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTs7QUMxcUJBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTs7QUNsWUE7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTs7QUM1NkJBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTs7QUNsdUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7O0FDanFCQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBOztBQ2xPQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBOztBQ2pyQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBOztBQy9qQkE7O0FDQUE7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTs7O0FDblpBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBOzs7O0FDdkNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBOzs7QUNuSkE7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7Ozs7QUNsb0JBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7OztBQ3ZHQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7Ozs7QUN4R0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBOzs7QUM5REE7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7Ozs7QUN4RUE7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7OztBQ1RBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7Ozs7O0FDNWZBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTs7Ozs7QUMzTUE7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7Ozs7O0FDaklBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTs7OztBQ3JEQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBOztBQy9CQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBOztBQ3RCQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTs7QUNyQkE7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBOzs7QUN6RkE7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0EiLCJmaWxlIjoiZ2VuZXJhdGVkLmpzIiwic291cmNlUm9vdCI6IiIsInNvdXJjZXNDb250ZW50IjpbIihmdW5jdGlvbiBlKHQsbixyKXtmdW5jdGlvbiBzKG8sdSl7aWYoIW5bb10pe2lmKCF0W29dKXt2YXIgYT10eXBlb2YgcmVxdWlyZT09XCJmdW5jdGlvblwiJiZyZXF1aXJlO2lmKCF1JiZhKXJldHVybiBhKG8sITApO2lmKGkpcmV0dXJuIGkobywhMCk7dmFyIGY9bmV3IEVycm9yKFwiQ2Fubm90IGZpbmQgbW9kdWxlICdcIitvK1wiJ1wiKTt0aHJvdyBmLmNvZGU9XCJNT0RVTEVfTk9UX0ZPVU5EXCIsZn12YXIgbD1uW29dPXtleHBvcnRzOnt9fTt0W29dWzBdLmNhbGwobC5leHBvcnRzLGZ1bmN0aW9uKGUpe3ZhciBuPXRbb11bMV1bZV07cmV0dXJuIHMobj9uOmUpfSxsLGwuZXhwb3J0cyxlLHQsbixyKX1yZXR1cm4gbltvXS5leHBvcnRzfXZhciBpPXR5cGVvZiByZXF1aXJlPT1cImZ1bmN0aW9uXCImJnJlcXVpcmU7Zm9yKHZhciBvPTA7bzxyLmxlbmd0aDtvKyspcyhyW29dKTtyZXR1cm4gc30pIiwiJ3VzZSBzdHJpY3QnO1xudmFyIGtvID0gcmVxdWlyZSgnLi9oZXJvY2FsY19rbm9ja291dCcpO1xudmFyIGFiaWxpdHlEYXRhID0gcmVxdWlyZShcIi4vaGVyb2NhbGNfYWJpbGl0eWRhdGFcIik7XG5cbnZhciBBYmlsaXR5TW9kZWwgPSBmdW5jdGlvbiAoYSwgaCkge1xuICAgIHZhciBzZWxmID0gdGhpcztcbiAgICBzZWxmLmhlcm8gPSBoO1xuICAgIHNlbGYuYWJpbGl0eURhdGEgPSBhYmlsaXR5RGF0YTtcbiAgICBzZWxmLmhhc1NjZXB0ZXIgPSBrby5vYnNlcnZhYmxlKGZhbHNlKTtcbiAgICBzZWxmLmlzU2hhcGVTaGlmdEFjdGl2ZSA9IGtvLm9ic2VydmFibGUoZmFsc2UpO1xuICAgIHNlbGYuYWJpbGl0aWVzID0gYTtcbiAgICBzZWxmLl9hYmlsaXRpZXMgPSBzZWxmLmFiaWxpdGllcygpO1xuICAgIGZvciAodmFyIGkgPSAwOyBpIDwgc2VsZi5hYmlsaXRpZXMoKS5sZW5ndGg7IGkrKykge1xuICAgICAgICBzZWxmLl9hYmlsaXRpZXNbaV0ubGV2ZWwgPSBrby5vYnNlcnZhYmxlKDApO1xuICAgICAgICBzZWxmLl9hYmlsaXRpZXNbaV0uaXNBY3RpdmUgPSBrby5vYnNlcnZhYmxlKGZhbHNlKTtcbiAgICAgICAgc2VsZi5fYWJpbGl0aWVzW2ldLmlzRGV0YWlsID0ga28ub2JzZXJ2YWJsZShmYWxzZSk7XG4gICAgICAgIHNlbGYuX2FiaWxpdGllc1tpXS5iYXNlRGFtYWdlID0ga28ub2JzZXJ2YWJsZSgwKTtcbiAgICAgICAgc2VsZi5fYWJpbGl0aWVzW2ldLmJhc2VEYW1hZ2VSZWR1Y3Rpb25QY3QgPSBrby5vYnNlcnZhYmxlKDApO1xuICAgICAgICBzZWxmLl9hYmlsaXRpZXNbaV0uYmFzZURhbWFnZU11bHRpcGxpZXIgPSBrby5vYnNlcnZhYmxlKDApO1xuICAgICAgICBzZWxmLl9hYmlsaXRpZXNbaV0uYmFzaCA9IGtvLm9ic2VydmFibGUoMCk7XG4gICAgICAgIHNlbGYuX2FiaWxpdGllc1tpXS5iYXNoQm9udXNEYW1hZ2UgPSBrby5vYnNlcnZhYmxlKDApO1xuICAgICAgICBzZWxmLl9hYmlsaXRpZXNbaV0uYm9udXNEYW1hZ2UgPSBrby5vYnNlcnZhYmxlKDApO1xuICAgICAgICBzZWxmLl9hYmlsaXRpZXNbaV0uYm9udXNEYW1hZ2VPcmIgPSBrby5vYnNlcnZhYmxlKDApO1xuICAgICAgICBzZWxmLl9hYmlsaXRpZXNbaV0uYm9udXNEYW1hZ2VQY3QgPSBrby5vYnNlcnZhYmxlKDApO1xuICAgICAgICBzZWxmLl9hYmlsaXRpZXNbaV0uYm9udXNEYW1hZ2VQcmVjaXNpb25BdXJhID0ga28ub2JzZXJ2YWJsZSgwKTtcbiAgICAgICAgc2VsZi5fYWJpbGl0aWVzW2ldLmJvbnVzRGFtYWdlUmVkdWN0aW9uID0ga28ub2JzZXJ2YWJsZSgwKTtcbiAgICAgICAgc2VsZi5fYWJpbGl0aWVzW2ldLmJvbnVzSGVhbHRoID0ga28ub2JzZXJ2YWJsZSgwKTtcbiAgICAgICAgc2VsZi5fYWJpbGl0aWVzW2ldLmJvbnVzU3RyZW5ndGggPSBrby5vYnNlcnZhYmxlKDApO1xuICAgICAgICBzZWxmLl9hYmlsaXRpZXNbaV0uYm9udXNTdHJlbmd0aDIgPSBrby5vYnNlcnZhYmxlKDApO1xuICAgICAgICBzZWxmLl9hYmlsaXRpZXNbaV0uYm9udXNBZ2lsaXR5ID0ga28ub2JzZXJ2YWJsZSgwKTtcbiAgICAgICAgc2VsZi5fYWJpbGl0aWVzW2ldLmJvbnVzQWdpbGl0eTIgPSBrby5vYnNlcnZhYmxlKDApO1xuICAgICAgICBzZWxmLl9hYmlsaXRpZXNbaV0uYm9udXNJbnQgPSBrby5vYnNlcnZhYmxlKDApO1xuICAgICAgICBzZWxmLl9hYmlsaXRpZXNbaV0uYm9udXNBbGxTdGF0c1JlZHVjdGlvbiA9IGtvLm9ic2VydmFibGUoMCk7XG4gICAgICAgIHNlbGYuX2FiaWxpdGllc1tpXS5kYW1hZ2VBbXBsaWZpY2F0aW9uID0ga28ub2JzZXJ2YWJsZSgwKTtcbiAgICAgICAgc2VsZi5fYWJpbGl0aWVzW2ldLmRhbWFnZVJlZHVjdGlvbiA9IGtvLm9ic2VydmFibGUoMCk7XG4gICAgICAgIHNlbGYuX2FiaWxpdGllc1tpXS5ldmFzaW9uID0ga28ub2JzZXJ2YWJsZSgwKTtcbiAgICAgICAgc2VsZi5fYWJpbGl0aWVzW2ldLm1hZ2ljUmVzaXN0ID0ga28ub2JzZXJ2YWJsZSgwKTtcbiAgICAgICAgc2VsZi5fYWJpbGl0aWVzW2ldLm1hbmFyZWdlbiA9IGtvLm9ic2VydmFibGUoMCk7XG4gICAgICAgIHNlbGYuX2FiaWxpdGllc1tpXS5tYW5hcmVnZW5yZWR1Y3Rpb24gPSBrby5vYnNlcnZhYmxlKDApO1xuICAgICAgICBzZWxmLl9hYmlsaXRpZXNbaV0ubWlzc0NoYW5jZSA9IGtvLm9ic2VydmFibGUoMCk7XG4gICAgICAgIHNlbGYuX2FiaWxpdGllc1tpXS5tb3ZlbWVudFNwZWVkRmxhdCA9IGtvLm9ic2VydmFibGUoMCk7XG4gICAgICAgIHNlbGYuX2FiaWxpdGllc1tpXS5tb3ZlbWVudFNwZWVkUGN0ID0ga28ub2JzZXJ2YWJsZSgwKTtcbiAgICAgICAgc2VsZi5fYWJpbGl0aWVzW2ldLm1vdmVtZW50U3BlZWRQY3RSZWR1Y3Rpb24gPSBrby5vYnNlcnZhYmxlKDApO1xuICAgICAgICBzZWxmLl9hYmlsaXRpZXNbaV0udHVyblJhdGVSZWR1Y3Rpb24gPSBrby5vYnNlcnZhYmxlKDApO1xuICAgICAgICBzZWxmLl9hYmlsaXRpZXNbaV0uYXR0YWNrcmFuZ2UgPSBrby5vYnNlcnZhYmxlKDApO1xuICAgICAgICBzZWxmLl9hYmlsaXRpZXNbaV0uYXR0YWNrc3BlZWQgPSBrby5vYnNlcnZhYmxlKDApO1xuICAgICAgICBzZWxmLl9hYmlsaXRpZXNbaV0uYXR0YWNrc3BlZWRyZWR1Y3Rpb24gPSBrby5vYnNlcnZhYmxlKDApO1xuICAgICAgICBzZWxmLl9hYmlsaXRpZXNbaV0uYXJtb3IgPSBrby5vYnNlcnZhYmxlKDApO1xuICAgICAgICBzZWxmLl9hYmlsaXRpZXNbaV0uYXJtb3JSZWR1Y3Rpb24gPSBrby5vYnNlcnZhYmxlKDApO1xuICAgICAgICBzZWxmLl9hYmlsaXRpZXNbaV0uaGVhbHRocmVnZW4gPSBrby5vYnNlcnZhYmxlKDApO1xuICAgICAgICBzZWxmLl9hYmlsaXRpZXNbaV0ubGlmZXN0ZWFsID0ga28ub2JzZXJ2YWJsZSgwKTtcbiAgICAgICAgc2VsZi5fYWJpbGl0aWVzW2ldLnZpc2lvbm5pZ2h0ID0ga28ub2JzZXJ2YWJsZSgwKTtcbiAgICAgICAgc2VsZi5fYWJpbGl0aWVzW2ldLnZpc2lvbmRheSA9IGtvLm9ic2VydmFibGUoMCk7XG4gICAgfVxuICAgIHNlbGYuYWJpbGl0eUNvbnRyb2xEYXRhID0ge307XG4gICAgc2VsZi5hYmlsaXR5U2V0dGluZ3NEYXRhID0gZnVuY3Rpb24gKGRhdGEsIHBhcmVudCwgaW5kZXgpIHtcbiAgICAgICAgaWYgKHNlbGYuYWJpbGl0eUNvbnRyb2xEYXRhW2RhdGFdID09IHVuZGVmaW5lZCkge1xuICAgICAgICAgICAgcmV0dXJuIHNlbGYucHJvY2Vzc0FiaWxpdHkoZGF0YSwgcGFyZW50LCBpbmRleCwgc2VsZi5hYmlsaXR5RGF0YVtkYXRhXSk7XG4gICAgICAgIH1cbiAgICAgICAgZWxzZSB7XG4gICAgICAgICAgICByZXR1cm4gc2VsZi5hYmlsaXR5Q29udHJvbERhdGFbZGF0YV07XG4gICAgICAgIH1cbiAgICB9XG4gICAgXG4gICAgc2VsZi5wcm9jZXNzQWJpbGl0eSA9IGZ1bmN0aW9uIChkYXRhLCBwYXJlbnQsIGluZGV4LCBhcmdzKSB7XG4gICAgICAgIHZhciByZXN1bHQgPSB7fTtcbiAgICAgICAgcmVzdWx0LmRhdGEgPSBbXTtcbiAgICAgICAgdmFyIHY7XG4gICAgICAgIHZhciB2X2xpc3QgPSBbXTtcbiAgICAgICAgZm9yICh2YXIgaT0wOyBpIDwgYXJncy5sZW5ndGg7IGkrKykge1xuICAgICAgICAgICAgc3dpdGNoIChhcmdzW2ldLmNvbnRyb2xUeXBlKSB7XG4gICAgICAgICAgICAgICAgY2FzZSAnaW5wdXQnOlxuICAgICAgICAgICAgICAgICAgICB2ID0ga28ub2JzZXJ2YWJsZSgwKS5leHRlbmQoeyBudW1lcmljOiAyIH0pO1xuICAgICAgICAgICAgICAgICAgICB2LmNvbnRyb2xWYWx1ZVR5cGUgPSBhcmdzW2ldLmNvbnRyb2xWYWx1ZVR5cGU7XG4gICAgICAgICAgICAgICAgICAgIHZfbGlzdC5wdXNoKHYpO1xuICAgICAgICAgICAgICAgICAgICByZXN1bHQuZGF0YS5wdXNoKHsgbGFiZWxOYW1lOiBhcmdzW2ldLmxhYmVsLnRvVXBwZXJDYXNlKCkgKyAnOicsIGNvbnRyb2xWYWw6IHYsIGNvbnRyb2xUeXBlOiBhcmdzW2ldLmNvbnRyb2xUeXBlLCBkaXNwbGF5OiBhcmdzW2ldLmRpc3BsYXkgfSk7XG4gICAgICAgICAgICAgICAgYnJlYWs7XG4gICAgICAgICAgICAgICAgY2FzZSAnY2hlY2tib3gnOlxuICAgICAgICAgICAgICAgICAgICB2ID0ga28ub2JzZXJ2YWJsZShmYWxzZSk7XG4gICAgICAgICAgICAgICAgICAgIHYuY29udHJvbFZhbHVlVHlwZSA9IGFyZ3NbaV0uY29udHJvbFZhbHVlVHlwZTtcbiAgICAgICAgICAgICAgICAgICAgdl9saXN0LnB1c2godik7XG4gICAgICAgICAgICAgICAgICAgIHJlc3VsdC5kYXRhLnB1c2goeyBsYWJlbE5hbWU6IGFyZ3NbaV0ubGFiZWwudG9VcHBlckNhc2UoKSArICc/JywgY29udHJvbFZhbDogdiwgY29udHJvbFR5cGU6IGFyZ3NbaV0uY29udHJvbFR5cGUsIGRpc3BsYXk6IGFyZ3NbaV0uZGlzcGxheSB9KTtcbiAgICAgICAgICAgICAgICBicmVhaztcbiAgICAgICAgICAgICAgICBjYXNlICdyYWRpbyc6XG4gICAgICAgICAgICAgICAgICAgIHYgPSBrby5vYnNlcnZhYmxlKGFyZ3NbaV0uY29udHJvbE9wdGlvbnNbMF0udmFsdWUpO1xuICAgICAgICAgICAgICAgICAgICB2LmNvbnRyb2xWYWx1ZVR5cGUgPSBhcmdzW2ldLmNvbnRyb2xWYWx1ZVR5cGU7XG4gICAgICAgICAgICAgICAgICAgIHZfbGlzdC5wdXNoKHYpO1xuICAgICAgICAgICAgICAgICAgICByZXN1bHQuZGF0YS5wdXNoKHsgbGFiZWxOYW1lOiBhcmdzW2ldLmxhYmVsLnRvVXBwZXJDYXNlKCkgKyAnPycsIGNvbnRyb2xWYWw6IHYsIGNvbnRyb2xUeXBlOiBhcmdzW2ldLmNvbnRyb2xUeXBlLCBkaXNwbGF5OiBhcmdzW2ldLmRpc3BsYXksIGNvbnRyb2xPcHRpb25zOiBhcmdzW2ldLmNvbnRyb2xPcHRpb25zIH0pO1xuICAgICAgICAgICAgICAgIGJyZWFrO1xuICAgICAgICAgICAgICAgIGNhc2UgJ21ldGhvZCc6XG4gICAgICAgICAgICAgICAgY2FzZSAndGV4dCc6XG4gICAgICAgICAgICAgICAgICAgIC8vIHNpbmdsZSBpbnB1dCBhYmlsaXRpZXNcbiAgICAgICAgICAgICAgICAgICAgaWYgKGFyZ3NbaV0uY29udHJvbHMgPT0gdW5kZWZpbmVkKSB7XG4gICAgICAgICAgICAgICAgICAgICAgICBpZiAoYXJnc1tpXS5ub0xldmVsKSB7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgdmFyIGF0dHJpYnV0ZVZhbHVlID0gZnVuY3Rpb24gKGF0dHJpYnV0ZU5hbWUpIHtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgcmV0dXJuIHtmbjoga28uY29tcHV0ZWQoZnVuY3Rpb24gKCkge1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgdmFyIF9hYmlsaXR5ID0gc2VsZi5hYmlsaXRpZXMoKS5maW5kKGZ1bmN0aW9uKGIpIHtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICByZXR1cm4gYi5uYW1lID09IGRhdGE7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICB9KTtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIHJldHVybiBzZWxmLmdldEFiaWxpdHlBdHRyaWJ1dGVWYWx1ZShfYWJpbGl0eS5hdHRyaWJ1dGVzLCBhdHRyaWJ1dGVOYW1lLCAwKTtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgfSl9O1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgIH07XG4gICAgICAgICAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgICAgICAgICAgICBlbHNlIHtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICB2YXIgYXR0cmlidXRlVmFsdWUgPSBmdW5jdGlvbiAoYXR0cmlidXRlTmFtZSkge1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICByZXR1cm4ge2ZuOiBrby5jb21wdXRlZChmdW5jdGlvbiAoKSB7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICB2YXIgX2FiaWxpdHkgPSBzZWxmLmFiaWxpdGllcygpLmZpbmQoZnVuY3Rpb24oYikge1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIHJldHVybiBiLm5hbWUgPT0gZGF0YTtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIH0pO1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgcmV0dXJuIHNlbGYuZ2V0QWJpbGl0eUF0dHJpYnV0ZVZhbHVlKF9hYmlsaXR5LmF0dHJpYnV0ZXMsIGF0dHJpYnV0ZU5hbWUsIF9hYmlsaXR5LmxldmVsKCkpO1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICB9KX07XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgfTtcbiAgICAgICAgICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgICAgICAgICAgIHZhciBnID0gYXR0cmlidXRlVmFsdWUoYXJnc1tpXS5hdHRyaWJ1dGVOYW1lKVxuICAgICAgICAgICAgICAgICAgICAgICAgdmFyIHIgPSBzZWxmLmdldENvbXB1dGVkRnVuY3Rpb24odiwgZy5mbiwgYXJnc1tpXS5mbiwgcGFyZW50LCBpbmRleCwgc2VsZiwgYXJnc1tpXS5yZXR1cm5Qcm9wZXJ0eSwgdW5kZWZpbmVkLCBkYXRhKTtcbiAgICAgICAgICAgICAgICAgICAgICAgIGlmIChhcmdzW2ldLmlnbm9yZVRvb2x0aXApIHtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICB2YXIgdG9vbHRpcCA9IGFyZ3NbaV0ubGFiZWwgfHwgYXJnc1tpXS5hdHRyaWJ1dGVOYW1lO1xuICAgICAgICAgICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICAgICAgICAgICAgZWxzZSB7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgdmFyIHRvb2x0aXAgPSBzZWxmLmdldEFiaWxpdHlBdHRyaWJ1dGVUb29sdGlwKHNlbGYuYWJpbGl0aWVzKClbaW5kZXhdLmF0dHJpYnV0ZXMsIGFyZ3NbaV0uYXR0cmlidXRlTmFtZSkgfHwgYXJnc1tpXS5sYWJlbCB8fCBhcmdzW2ldLmF0dHJpYnV0ZU5hbWU7XG4gICAgICAgICAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgICAgICAgICAgICByZXN1bHQuZGF0YS5wdXNoKHsgbGFiZWxOYW1lOiB0b29sdGlwLnRvVXBwZXJDYXNlKCksIGNvbnRyb2xWYWw6IHIsIGNvbnRyb2xUeXBlOiBhcmdzW2ldLmNvbnRyb2xUeXBlLCBkaXNwbGF5OiBhcmdzW2ldLmRpc3BsYXksIGNsZWFuOiBnLmZuIH0pO1xuICAgICAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgICAgICAgIC8vIG11bHRpIGlucHV0IGFiaWxpdGllc1xuICAgICAgICAgICAgICAgICAgICBlbHNlIHtcbiAgICAgICAgICAgICAgICAgICAgICAgIGlmIChhcmdzW2ldLm5vTGV2ZWwpIHtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICB2YXIgYXR0cmlidXRlVmFsdWUgPSBmdW5jdGlvbiAoYXR0cmlidXRlTmFtZSkge1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICByZXR1cm4ge2ZuOiBrby5jb21wdXRlZChmdW5jdGlvbiAoKSB7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICByZXR1cm4gc2VsZi5nZXRBYmlsaXR5QXR0cmlidXRlVmFsdWUoc2VsZi5hYmlsaXRpZXMoKVtpbmRleF0uYXR0cmlidXRlcywgYXR0cmlidXRlTmFtZSwgMCk7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIH0pfTtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICB9O1xuICAgICAgICAgICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICAgICAgICAgICAgZWxzZSB7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgdmFyIGF0dHJpYnV0ZVZhbHVlID0gZnVuY3Rpb24gKGF0dHJpYnV0ZU5hbWUpIHtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgcmV0dXJuIHtmbjoga28uY29tcHV0ZWQoZnVuY3Rpb24gKCkge1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgcmV0dXJuIHNlbGYuZ2V0QWJpbGl0eUF0dHJpYnV0ZVZhbHVlKHNlbGYuYWJpbGl0aWVzKClbaW5kZXhdLmF0dHJpYnV0ZXMsIGF0dHJpYnV0ZU5hbWUsIHNlbGYuYWJpbGl0aWVzKClbaW5kZXhdLmxldmVsKCkpO1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICB9KX07XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgfTtcbiAgICAgICAgICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgICAgICAgICAgIHZhciBnID0gYXR0cmlidXRlVmFsdWUoYXJnc1tpXS5hdHRyaWJ1dGVOYW1lKVxuICAgICAgICAgICAgICAgICAgICAgICAgdmFyIHIgPSBzZWxmLmdldENvbXB1dGVkRnVuY3Rpb24odl9saXN0LCBnLmZuLCBhcmdzW2ldLmZuLCBwYXJlbnQsIGluZGV4LCBzZWxmLCBhcmdzW2ldLnJldHVyblByb3BlcnR5LCBhcmdzW2ldLmNvbnRyb2xzLCBkYXRhKTtcbiAgICAgICAgICAgICAgICAgICAgICAgIGlmIChhcmdzW2ldLmlnbm9yZVRvb2x0aXApIHtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICB2YXIgdG9vbHRpcCA9IGFyZ3NbaV0ubGFiZWwgfHwgYXJnc1tpXS5hdHRyaWJ1dGVOYW1lO1xuICAgICAgICAgICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICAgICAgICAgICAgZWxzZSB7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgdmFyIHRvb2x0aXAgPSBzZWxmLmdldEFiaWxpdHlBdHRyaWJ1dGVUb29sdGlwKHNlbGYuYWJpbGl0aWVzKClbaW5kZXhdLmF0dHJpYnV0ZXMsIGFyZ3NbaV0uYXR0cmlidXRlTmFtZSkgfHwgYXJnc1tpXS5sYWJlbCB8fCBhcmdzW2ldLmF0dHJpYnV0ZU5hbWU7XG4gICAgICAgICAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgICAgICAgICAgICByZXN1bHQuZGF0YS5wdXNoKHsgbGFiZWxOYW1lOiB0b29sdGlwLnRvVXBwZXJDYXNlKCksIGNvbnRyb2xWYWw6IHIsIGNvbnRyb2xUeXBlOiBhcmdzW2ldLmNvbnRyb2xUeXBlLCBkaXNwbGF5OiBhcmdzW2ldLmRpc3BsYXksIGNsZWFuOiBnLmZuIH0pO1xuICAgICAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgICAgICAgIFxuICAgICAgICAgICAgICAgICAgICBpZiAoYXJnc1tpXS5jb250cm9sVHlwZSA9PSAnbWV0aG9kJykge1xuICAgICAgICAgICAgICAgICAgICAgICAgdl9saXN0LnB1c2gocik7XG4gICAgICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgICBicmVhaztcbiAgICAgICAgICAgIH1cbiAgICAgICAgfVxuICAgICAgICBzZWxmLmFiaWxpdHlDb250cm9sRGF0YVtkYXRhXSA9IHJlc3VsdDtcbiAgICAgICAgcmV0dXJuIHJlc3VsdDtcbiAgICB9XG5cbiAgICBzZWxmLmdldENvbXB1dGVkRnVuY3Rpb24gPSBmdW5jdGlvbiAodiwgYXR0cmlidXRlVmFsdWUsIGZuLCBwYXJlbnQsIGluZGV4LCBhYmlsaXR5TW9kZWwsIHJldHVyblByb3BlcnR5LCBjb250cm9scywgYWJpbGl0eU5hbWUpIHtcbiAgICAgICAgdmFyIF9hYmlsaXR5ID0gYWJpbGl0eU1vZGVsLmFiaWxpdGllcygpLmZpbmQoZnVuY3Rpb24oYikge1xuICAgICAgICAgICAgcmV0dXJuIGIubmFtZSA9PSBhYmlsaXR5TmFtZTtcbiAgICAgICAgfSk7XG4gICAgICAgIHJldHVybiBrby5wdXJlQ29tcHV0ZWQoZnVuY3Rpb24gKCkgeyAgICAgICAgICAgICAgICBcbiAgICAgICAgICAgIHZhciBpbnB1dFZhbHVlO1xuICAgICAgICAgICAgaWYgKGNvbnRyb2xzID09IHVuZGVmaW5lZCkge1xuICAgICAgICAgICAgICAgIGlmICh2ID09IHVuZGVmaW5lZCkge1xuICAgICAgICAgICAgICAgICAgICBpbnB1dFZhbHVlID0gdjtcbiAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgICAgZWxzZSBpZiAodHlwZW9mIHYoKSA9PSAnYm9vbGVhbicpIHtcbiAgICAgICAgICAgICAgICAgICAgaW5wdXRWYWx1ZSA9IHYoKTtcbiAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgICAgZWxzZSBpZiAodi5jb250cm9sVmFsdWVUeXBlID09IHVuZGVmaW5lZCkge1xuICAgICAgICAgICAgICAgICAgICBpbnB1dFZhbHVlID0gcGFyc2VGbG9hdCh2KCkpO1xuICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgICBlbHNlIGlmICh2LmNvbnRyb2xWYWx1ZVR5cGUgPT0gJ3N0cmluZycpIHtcbiAgICAgICAgICAgICAgICAgICAgaW5wdXRWYWx1ZSA9IHYoKTtcbiAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgICAgZWxzZSB7XG4gICAgICAgICAgICAgICAgICAgIGlucHV0VmFsdWUgPSBwYXJzZUZsb2F0KHYoKSk7XG4gICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgfVxuICAgICAgICAgICAgZWxzZSB7XG4gICAgICAgICAgICAgICAgdmFyIHZfbGlzdCA9IFtdO1xuICAgICAgICAgICAgICAgIGZvciAodmFyIGk9MDtpPGNvbnRyb2xzLmxlbmd0aDtpKyspIHtcbiAgICAgICAgICAgICAgICAgICAgc3dpdGNoICh0eXBlb2Ygdltjb250cm9sc1tpXV0oKSkge1xuICAgICAgICAgICAgICAgICAgICAgICAgY2FzZSAnYm9vbGVhbic6XG4gICAgICAgICAgICAgICAgICAgICAgICBjYXNlICdvYmplY3QnOlxuICAgICAgICAgICAgICAgICAgICAgICAgICAgIHZfbGlzdC5wdXNoKHZbY29udHJvbHNbaV1dKCkpO1xuICAgICAgICAgICAgICAgICAgICAgICAgYnJlYWs7XG4gICAgICAgICAgICAgICAgICAgICAgICBkZWZhdWx0OlxuICAgICAgICAgICAgICAgICAgICAgICAgICAgIHZfbGlzdC5wdXNoKHBhcnNlRmxvYXQodltjb250cm9sc1tpXV0oKSkpO1xuICAgICAgICAgICAgICAgICAgICAgICAgYnJlYWs7XG4gICAgICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgICAgaW5wdXRWYWx1ZSA9IHZfbGlzdDtcbiAgICAgICAgICAgIH1cbiAgICAgICAgICAgIFxuICAgICAgICAgICAgdmFyIHJldHVyblZhbCA9IGZuLmNhbGwodGhpcywgaW5wdXRWYWx1ZSwgYXR0cmlidXRlVmFsdWUoKSwgcGFyZW50LCBpbmRleCwgYWJpbGl0eU1vZGVsLCBfYWJpbGl0eSk7XG4gICAgICAgICAgICBpZiAocmV0dXJuUHJvcGVydHkgIT0gdW5kZWZpbmVkKSB7XG4gICAgICAgICAgICAgICAgX2FiaWxpdHlbcmV0dXJuUHJvcGVydHldKHJldHVyblZhbCk7XG4gICAgICAgICAgICB9XG4gICAgICAgICAgICByZXR1cm4gcmV0dXJuVmFsO1xuICAgICAgICB9LCB0aGlzKTtcbiAgICB9XG4gICAgXG4gICAgc2VsZi5nZXRBYmlsaXR5TGV2ZWxCeUFiaWxpdHlOYW1lID0gZnVuY3Rpb24gKGFiaWxpdHlOYW1lKSB7XG4gICAgICAgIGZvciAodmFyIGkgPSAwOyBpIDwgc2VsZi5hYmlsaXRpZXMoKS5sZW5ndGg7IGkrKykge1xuICAgICAgICAgICAgaWYgKHNlbGYuX2FiaWxpdGllc1tpXS5uYW1lID09IGFiaWxpdHlOYW1lKSB7XG4gICAgICAgICAgICAgICAgcmV0dXJuIHNlbGYuX2FiaWxpdGllc1tpXS5sZXZlbCgpO1xuICAgICAgICAgICAgfVxuICAgICAgICB9XG4gICAgICAgIHJldHVybiAtMTtcbiAgICB9XG5cbiAgICBzZWxmLmdldEFiaWxpdHlCeU5hbWUgPSBmdW5jdGlvbiAoYWJpbGl0eU5hbWUpIHtcbiAgICAgICAgZm9yICh2YXIgaSA9IDA7IGkgPCBzZWxmLmFiaWxpdGllcygpLmxlbmd0aDsgaSsrKSB7XG4gICAgICAgICAgICBpZiAoc2VsZi5fYWJpbGl0aWVzW2ldLm5hbWUgPT0gYWJpbGl0eU5hbWUpIHtcbiAgICAgICAgICAgICAgICByZXR1cm4gc2VsZi5fYWJpbGl0aWVzW2ldO1xuICAgICAgICAgICAgfVxuICAgICAgICB9XG4gICAgICAgIHJldHVybiB1bmRlZmluZWQ7XG4gICAgfVxuXG4gICAgc2VsZi5nZXRBYmlsaXR5UHJvcGVydHlWYWx1ZSA9IGZ1bmN0aW9uIChhYmlsaXR5LCBwcm9wZXJ0eSkge1xuICAgICAgICByZXR1cm4gcGFyc2VGbG9hdChhYmlsaXR5W3Byb3BlcnR5XSgpW2FiaWxpdHkubGV2ZWwoKS0xXSk7XG4gICAgfVxuICAgIFxuICAgIHNlbGYuZ2V0QXR0cmlidXRlQm9udXNMZXZlbCA9IGZ1bmN0aW9uICgpIHtcbiAgICAgICAgZm9yICh2YXIgaSA9IDA7IGkgPCBzZWxmLmFiaWxpdGllcygpLmxlbmd0aDsgaSsrKSB7XG4gICAgICAgICAgICBpZiAoc2VsZi5fYWJpbGl0aWVzW2ldLm5hbWUgPT0gJ2F0dHJpYnV0ZV9ib251cycpIHtcbiAgICAgICAgICAgICAgICByZXR1cm4gc2VsZi5fYWJpbGl0aWVzW2ldLmxldmVsKCk7XG4gICAgICAgICAgICB9XG4gICAgICAgIH1cbiAgICAgICAgcmV0dXJuIDA7ICAgICAgICBcbiAgICB9XG4gICAgXG4gICAgc2VsZi5nZXRBbGxTdGF0c1JlZHVjdGlvbiA9IGtvLmNvbXB1dGVkKGZ1bmN0aW9uICgpIHtcbiAgICAgICAgdmFyIHRvdGFsQXR0cmlidXRlID0gMDtcbiAgICAgICAgZm9yICh2YXIgaSA9IDA7IGkgPCBzZWxmLmFiaWxpdGllcygpLmxlbmd0aDsgaSsrKSB7XG4gICAgICAgICAgICB2YXIgYWJpbGl0eSA9IHNlbGYuX2FiaWxpdGllc1tpXTtcbiAgICAgICAgICAgIGlmIChhYmlsaXR5LmxldmVsKCkgPiAwICYmIChhYmlsaXR5LmlzQWN0aXZlKCkgfHwgKGFiaWxpdHkuYmVoYXZpb3IuaW5kZXhPZignRE9UQV9BQklMSVRZX0JFSEFWSU9SX1BBU1NJVkUnKSAhPSAtMSkpKSB7XG4gICAgICAgICAgICAgICAgaWYgKCEoYWJpbGl0eS5uYW1lIGluIHNlbGYuYWJpbGl0eURhdGEpKSB7ICAgICAgICAgICAgICAgICAgICBcbiAgICAgICAgICAgICAgICAgICAgZm9yICh2YXIgaiA9IDA7IGogPCBzZWxmLl9hYmlsaXRpZXNbaV0uYXR0cmlidXRlcy5sZW5ndGg7IGorKykge1xuICAgICAgICAgICAgICAgICAgICAgICAgdmFyIGF0dHJpYnV0ZSA9IHNlbGYuX2FiaWxpdGllc1tpXS5hdHRyaWJ1dGVzW2pdO1xuICAgICAgICAgICAgICAgICAgICAgICAgLypzd2l0Y2goYXR0cmlidXRlLm5hbWUpIHtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAvLyBpbnZva2VyX3F1YXNcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICBjYXNlICdib251c19zdHJlbmd0aCc6XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIHRvdGFsQXR0cmlidXRlICs9IHBhcnNlSW50KGF0dHJpYnV0ZS52YWx1ZVthYmlsaXR5LmxldmVsKCktMV0pO1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgIGJyZWFrO1xuICAgICAgICAgICAgICAgICAgICAgICAgfSovXG4gICAgICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgICAgZWxzZSBpZiAoYWJpbGl0eS5ib251c0FsbFN0YXRzUmVkdWN0aW9uICE9IHVuZGVmaW5lZCkge1xuICAgICAgICAgICAgICAgICAgICAvLyBzbGFya19lc3NlbmNlX3NoaWZ0XG4gICAgICAgICAgICAgICAgICAgIHRvdGFsQXR0cmlidXRlKz1hYmlsaXR5LmJvbnVzQWxsU3RhdHNSZWR1Y3Rpb24oKTtcbiAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICB9XG4gICAgICAgIH1cbiAgICAgICAgcmV0dXJuIHRvdGFsQXR0cmlidXRlO1xuICAgIH0pO1xuICAgIFxuICAgIHNlbGYuZ2V0U3RyZW5ndGhSZWR1Y3Rpb24gPSBrby5jb21wdXRlZChmdW5jdGlvbiAoKSB7XG4gICAgICAgIHZhciB0b3RhbEF0dHJpYnV0ZSA9IDA7XG4gICAgICAgIGZvciAodmFyIGkgPSAwOyBpIDwgc2VsZi5hYmlsaXRpZXMoKS5sZW5ndGg7IGkrKykge1xuICAgICAgICAgICAgdmFyIGFiaWxpdHkgPSBzZWxmLl9hYmlsaXRpZXNbaV07XG4gICAgICAgICAgICBpZiAoYWJpbGl0eS5sZXZlbCgpID4gMCAmJiAoYWJpbGl0eS5pc0FjdGl2ZSgpIHx8IChhYmlsaXR5LmJlaGF2aW9yLmluZGV4T2YoJ0RPVEFfQUJJTElUWV9CRUhBVklPUl9QQVNTSVZFJykgIT0gLTEpKSkge1xuICAgICAgICAgICAgICAgIGlmICghKGFiaWxpdHkubmFtZSBpbiBzZWxmLmFiaWxpdHlEYXRhKSkgeyAgICAgICAgICAgICAgICAgICAgXG4gICAgICAgICAgICAgICAgICAgIGZvciAodmFyIGogPSAwOyBqIDwgc2VsZi5fYWJpbGl0aWVzW2ldLmF0dHJpYnV0ZXMubGVuZ3RoOyBqKyspIHtcbiAgICAgICAgICAgICAgICAgICAgICAgIHZhciBhdHRyaWJ1dGUgPSBzZWxmLl9hYmlsaXRpZXNbaV0uYXR0cmlidXRlc1tqXTtcbiAgICAgICAgICAgICAgICAgICAgICAgIC8qc3dpdGNoKGF0dHJpYnV0ZS5uYW1lKSB7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgLy8gaW52b2tlcl9xdWFzXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgY2FzZSAnYm9udXNfc3RyZW5ndGgnOlxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICB0b3RhbEF0dHJpYnV0ZSArPSBwYXJzZUludChhdHRyaWJ1dGUudmFsdWVbYWJpbGl0eS5sZXZlbCgpLTFdKTtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICBicmVhaztcbiAgICAgICAgICAgICAgICAgICAgICAgIH0qL1xuICAgICAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICAgIGVsc2UgaWYgKGFiaWxpdHkuYm9udXNTdHJlbmd0aCAhPSB1bmRlZmluZWQgJiYgYWJpbGl0eS5uYW1lID09ICd1bmR5aW5nX2RlY2F5Jykge1xuICAgICAgICAgICAgICAgICAgICAvLyB1bmR5aW5nX2RlY2F5XG4gICAgICAgICAgICAgICAgICAgIHRvdGFsQXR0cmlidXRlLT1hYmlsaXR5LmJvbnVzU3RyZW5ndGgoKTtcbiAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICB9XG4gICAgICAgIH1cbiAgICAgICAgcmV0dXJuIHRvdGFsQXR0cmlidXRlO1xuICAgIH0pO1xuICAgIFxuICAgIHNlbGYuZ2V0U3RyZW5ndGggPSBrby5jb21wdXRlZChmdW5jdGlvbiAoKSB7XG4gICAgICAgIHZhciB0b3RhbEF0dHJpYnV0ZSA9IDA7XG4gICAgICAgIGZvciAodmFyIGkgPSAwOyBpIDwgc2VsZi5hYmlsaXRpZXMoKS5sZW5ndGg7IGkrKykge1xuICAgICAgICAgICAgdmFyIGFiaWxpdHkgPSBzZWxmLl9hYmlsaXRpZXNbaV07XG4gICAgICAgICAgICBpZiAoYWJpbGl0eS5sZXZlbCgpID4gMCkge1xuICAgICAgICAgICAgICAgIGlmICghKGFiaWxpdHkubmFtZSBpbiBzZWxmLmFiaWxpdHlEYXRhKSkge1xuICAgICAgICAgICAgICAgICAgICBpZiAoYWJpbGl0eS5pc0FjdGl2ZSgpIHx8IChhYmlsaXR5LmJlaGF2aW9yLmluZGV4T2YoJ0RPVEFfQUJJTElUWV9CRUhBVklPUl9QQVNTSVZFJykgIT0gLTEpKSB7XG4gICAgICAgICAgICAgICAgICAgICAgICBmb3IgKHZhciBqID0gMDsgaiA8IHNlbGYuX2FiaWxpdGllc1tpXS5hdHRyaWJ1dGVzLmxlbmd0aDsgaisrKSB7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgdmFyIGF0dHJpYnV0ZSA9IHNlbGYuX2FiaWxpdGllc1tpXS5hdHRyaWJ1dGVzW2pdO1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgIC8qc3dpdGNoKGF0dHJpYnV0ZS5uYW1lKSB7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIC8vIGludm9rZXJfcXVhc1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBjYXNlICdib251c19zdHJlbmd0aCc6XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICB0b3RhbEF0dHJpYnV0ZSArPSBwYXJzZUludChhdHRyaWJ1dGUudmFsdWVbYWJpbGl0eS5sZXZlbCgpLTFdKTtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgYnJlYWs7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgfSovXG4gICAgICAgICAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgICAgZWxzZSB7XG4gICAgICAgICAgICAgICAgICAgIGlmIChhYmlsaXR5LmJvbnVzU3RyZW5ndGggIT0gdW5kZWZpbmVkKSB7XG4gICAgICAgICAgICAgICAgICAgICAgICBpZiAoYWJpbGl0eS5pc0FjdGl2ZSgpIHx8IChhYmlsaXR5LmJlaGF2aW9yLmluZGV4T2YoJ0RPVEFfQUJJTElUWV9CRUhBVklPUl9QQVNTSVZFJykgIT0gLTEpKSB7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgLy8gcHVkZ2VfZmxlc2hfaGVhcCxtb3JwaGxpbmdfbW9ycGhfc3RyLG1vcnBobGluZ19tb3JwaF9hZ2ksdW5keWluZ19kZWNheVxuICAgICAgICAgICAgICAgICAgICAgICAgICAgIHRvdGFsQXR0cmlidXRlKz1hYmlsaXR5LmJvbnVzU3RyZW5ndGgoKTtcbiAgICAgICAgICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICAgICAgICBpZiAoYWJpbGl0eS5ib251c1N0cmVuZ3RoMiAhPSB1bmRlZmluZWQpIHtcbiAgICAgICAgICAgICAgICAgICAgICAgIGlmIChhYmlsaXR5LmlzQWN0aXZlKCkgfHwgKGFiaWxpdHkuYmVoYXZpb3IuaW5kZXhPZignRE9UQV9BQklMSVRZX0JFSEFWSU9SX1BBU1NJVkUnKSAhPSAtMSkpIHtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAvLyBtb3JwaGxpbmdfbW9ycGhfc3RyXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgdG90YWxBdHRyaWJ1dGUrPWFiaWxpdHkuYm9udXNTdHJlbmd0aDIoKTtcbiAgICAgICAgICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgIH1cbiAgICAgICAgfVxuICAgICAgICByZXR1cm4gdG90YWxBdHRyaWJ1dGU7XG4gICAgfSk7XG4gICAgXG4gICAgc2VsZi5nZXRBZ2lsaXR5ID0ga28uY29tcHV0ZWQoZnVuY3Rpb24gKCkge1xuICAgICAgICB2YXIgdG90YWxBdHRyaWJ1dGUgPSAwO1xuICAgICAgICBmb3IgKHZhciBpID0gMDsgaSA8IHNlbGYuYWJpbGl0aWVzKCkubGVuZ3RoOyBpKyspIHtcbiAgICAgICAgICAgIHZhciBhYmlsaXR5ID0gc2VsZi5fYWJpbGl0aWVzW2ldO1xuICAgICAgICAgICAgaWYgKGFiaWxpdHkubGV2ZWwoKSA+IDApIHtcbiAgICAgICAgICAgICAgICBpZiAoIShhYmlsaXR5Lm5hbWUgaW4gc2VsZi5hYmlsaXR5RGF0YSkpIHtcbiAgICAgICAgICAgICAgICAgICAgaWYgKGFiaWxpdHkuaXNBY3RpdmUoKSB8fCAoYWJpbGl0eS5iZWhhdmlvci5pbmRleE9mKCdET1RBX0FCSUxJVFlfQkVIQVZJT1JfUEFTU0lWRScpICE9IC0xKSkge1xuICAgICAgICAgICAgICAgICAgICAgICAgZm9yICh2YXIgaiA9IDA7IGogPCBzZWxmLl9hYmlsaXRpZXNbaV0uYXR0cmlidXRlcy5sZW5ndGg7IGorKykge1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgIHZhciBhdHRyaWJ1dGUgPSBzZWxmLl9hYmlsaXRpZXNbaV0uYXR0cmlidXRlc1tqXTtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICBzd2l0Y2goYXR0cmlidXRlLm5hbWUpIHtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgLy8gZHJvd19yYW5nZXJfbWFya3NtYW5zaGlwXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIGNhc2UgJ21hcmtzbWFuc2hpcF9hZ2lsaXR5X2JvbnVzJzpcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIHRvdGFsQXR0cmlidXRlICs9IHNlbGYuZ2V0QWJpbGl0eUF0dHJpYnV0ZVZhbHVlKHNlbGYuX2FiaWxpdGllc1tpXS5hdHRyaWJ1dGVzLCBhdHRyaWJ1dGUubmFtZSwgYWJpbGl0eS5sZXZlbCgpKTtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgYnJlYWs7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICAgIGVsc2Uge1xuICAgICAgICAgICAgICAgICAgICBpZiAoYWJpbGl0eS5ib251c0FnaWxpdHkgIT0gdW5kZWZpbmVkKSB7XG4gICAgICAgICAgICAgICAgICAgICAgICBpZiAoYWJpbGl0eS5pc0FjdGl2ZSgpIHx8IChhYmlsaXR5LmJlaGF2aW9yLmluZGV4T2YoJ0RPVEFfQUJJTElUWV9CRUhBVklPUl9QQVNTSVZFJykgIT0gLTEpKSB7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgLy8gbW9ycGhsaW5nX21vcnBoX2FnaSxtb3JwaGxpbmdfbW9ycGhfc3RyXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgdG90YWxBdHRyaWJ1dGUrPWFiaWxpdHkuYm9udXNBZ2lsaXR5KCk7XG4gICAgICAgICAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgICAgICAgaWYgKGFiaWxpdHkuYm9udXNBZ2lsaXR5MiAhPSB1bmRlZmluZWQpIHtcbiAgICAgICAgICAgICAgICAgICAgICAgIGlmIChhYmlsaXR5LmlzQWN0aXZlKCkgfHwgKGFiaWxpdHkuYmVoYXZpb3IuaW5kZXhPZignRE9UQV9BQklMSVRZX0JFSEFWSU9SX1BBU1NJVkUnKSAhPSAtMSkpIHtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAvLyBtb3JwaGxpbmdfbW9ycGhfYWdpLG1vcnBobGluZ19tb3JwaF9zdHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICB0b3RhbEF0dHJpYnV0ZSs9YWJpbGl0eS5ib251c0FnaWxpdHkyKCk7XG4gICAgICAgICAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICB9XG4gICAgICAgIH1cbiAgICAgICAgcmV0dXJuIHRvdGFsQXR0cmlidXRlO1xuICAgIH0pO1xuXG4gICAgc2VsZi5nZXRJbnRlbGxpZ2VuY2UgPSBrby5jb21wdXRlZChmdW5jdGlvbiAoKSB7XG4gICAgICAgIHZhciB0b3RhbEF0dHJpYnV0ZSA9IDA7XG4gICAgICAgIGZvciAodmFyIGkgPSAwOyBpIDwgc2VsZi5hYmlsaXRpZXMoKS5sZW5ndGg7IGkrKykge1xuICAgICAgICAgICAgdmFyIGFiaWxpdHkgPSBzZWxmLl9hYmlsaXRpZXNbaV07XG4gICAgICAgICAgICBpZiAoYWJpbGl0eS5sZXZlbCgpID4gMCkge1xuICAgICAgICAgICAgICAgIGlmICghKGFiaWxpdHkubmFtZSBpbiBzZWxmLmFiaWxpdHlEYXRhKSkge1xuICAgICAgICAgICAgICAgICAgICBpZiAoYWJpbGl0eS5pc0FjdGl2ZSgpIHx8IChhYmlsaXR5LmJlaGF2aW9yLmluZGV4T2YoJ0RPVEFfQUJJTElUWV9CRUhBVklPUl9QQVNTSVZFJykgIT0gLTEpKSB7XG4gICAgICAgICAgICAgICAgICAgICAgICBmb3IgKHZhciBqID0gMDsgaiA8IHNlbGYuX2FiaWxpdGllc1tpXS5hdHRyaWJ1dGVzLmxlbmd0aDsgaisrKSB7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgdmFyIGF0dHJpYnV0ZSA9IHNlbGYuX2FiaWxpdGllc1tpXS5hdHRyaWJ1dGVzW2pdO1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgIHN3aXRjaChhdHRyaWJ1dGUubmFtZSkge1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAvLyBpbnZva2VyX2V4b3J0XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgLyogICAgY2FzZSAnYm9udXNfaW50ZWxsaWdlbmNlJzpcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIHRvdGFsQXR0cmlidXRlICs9IHNlbGYuZ2V0QWJpbGl0eUF0dHJpYnV0ZVZhbHVlKHNlbGYuX2FiaWxpdGllc1tpXS5hdHRyaWJ1dGVzLCBhdHRyaWJ1dGUubmFtZSwgYWJpbGl0eS5sZXZlbCgpKTtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgYnJlYWs7Ki9cbiAgICAgICAgICAgICAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgICAgLyplbHNlIGlmIChhYmlsaXR5LmJvbnVzSW50ICE9IHVuZGVmaW5lZCkge1xuICAgICAgICAgICAgICAgICAgICBpZiAoYWJpbGl0eS5pc0FjdGl2ZSgpIHx8IChhYmlsaXR5LmJlaGF2aW9yLmluZGV4T2YoJ0RPVEFfQUJJTElUWV9CRUhBVklPUl9QQVNTSVZFJykgIT0gLTEpIHx8IGFiaWxpdHkubmFtZSA9PSAnaW52b2tlcl9leG9ydCcpIHtcbiAgICAgICAgICAgICAgICAgICAgICAgIC8vIGludm9rZXJfZXhvcnRcbiAgICAgICAgICAgICAgICAgICAgICAgIHRvdGFsQXR0cmlidXRlKz1hYmlsaXR5LmJvbnVzSW50KCk7XG4gICAgICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgICB9Ki9cbiAgICAgICAgICAgIH1cbiAgICAgICAgfVxuICAgICAgICByZXR1cm4gdG90YWxBdHRyaWJ1dGU7XG4gICAgfSk7XG4gICAgXG4gICAgc2VsZi5nZXRBcm1vciA9IGtvLmNvbXB1dGVkKGZ1bmN0aW9uICgpIHtcbiAgICAgICAgdmFyIHRvdGFsQXR0cmlidXRlID0gMDtcbiAgICAgICAgZm9yICh2YXIgaSA9IDA7IGkgPCBzZWxmLmFiaWxpdGllcygpLmxlbmd0aDsgaSsrKSB7XG4gICAgICAgICAgICB2YXIgYWJpbGl0eSA9IHNlbGYuX2FiaWxpdGllc1tpXTtcbiAgICAgICAgICAgIGlmIChhYmlsaXR5LmxldmVsKCkgPiAwICYmIChhYmlsaXR5LmlzQWN0aXZlKCkgfHwgKGFiaWxpdHkuYmVoYXZpb3IuaW5kZXhPZignRE9UQV9BQklMSVRZX0JFSEFWSU9SX1BBU1NJVkUnKSAhPSAtMSkpKSB7XG4gICAgICAgICAgICAgICAgaWYgKCEoYWJpbGl0eS5uYW1lIGluIHNlbGYuYWJpbGl0eURhdGEpKSB7XG4gICAgICAgICAgICAgICAgICAgIGZvciAodmFyIGogPSAwOyBqIDwgc2VsZi5fYWJpbGl0aWVzW2ldLmF0dHJpYnV0ZXMubGVuZ3RoOyBqKyspIHtcbiAgICAgICAgICAgICAgICAgICAgICAgIHZhciBhdHRyaWJ1dGUgPSBzZWxmLl9hYmlsaXRpZXNbaV0uYXR0cmlidXRlc1tqXTtcbiAgICAgICAgICAgICAgICAgICAgICAgIHN3aXRjaChhdHRyaWJ1dGUubmFtZSkge1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgIC8vIGF4ZV9iZXJzZXJrZXJzX2NhbGwsZHJhZ29uX2tuaWdodF9kcmFnb25fYmxvb2QsdHJvbGxfd2FybG9yZF9iZXJzZXJrZXJzX3JhZ2UsbHljYW5fc2hhcGVzaGlmdCxlbnJhZ2VkX3dpbGRraW5fdG91Z2huZXNzX2F1cmFcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICBjYXNlICdib251c19hcm1vcic6XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIGlmIChhYmlsaXR5Lm5hbWUgIT0gJ3RlbXBsYXJfYXNzYXNzaW5fbWVsZCcpIHtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIHRvdGFsQXR0cmlidXRlICs9IHNlbGYuZ2V0QWJpbGl0eUF0dHJpYnV0ZVZhbHVlKHNlbGYuX2FiaWxpdGllc1tpXS5hdHRyaWJ1dGVzLCBhdHRyaWJ1dGUubmFtZSwgYWJpbGl0eS5sZXZlbCgpKTtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICAgICAgICAgICAgICAgIGJyZWFrO1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgIC8vIHN2ZW5fd2FyY3J5XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgY2FzZSAnd2FyY3J5X2FybW9yJzpcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgdG90YWxBdHRyaWJ1dGUgKz0gc2VsZi5nZXRBYmlsaXR5QXR0cmlidXRlVmFsdWUoc2VsZi5fYWJpbGl0aWVzW2ldLmF0dHJpYnV0ZXMsIGF0dHJpYnV0ZS5uYW1lLCBhYmlsaXR5LmxldmVsKCkpO1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgIGJyZWFrO1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgIC8vIGxpY2hfZnJvc3RfYXJtb3Isb2dyZV9tYWdpX2Zyb3N0X2FybW9yXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgY2FzZSAnYXJtb3JfYm9udXMnOlxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBpZiAoYWJpbGl0eS5uYW1lID09ICdsaWNoX2Zyb3N0X2FybW9yJyB8fCBhYmlsaXR5Lm5hbWUgPT0gJ29ncmVfbWFnaV9mcm9zdF9hcm1vcicpIHtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIHRvdGFsQXR0cmlidXRlICs9IHNlbGYuZ2V0QWJpbGl0eUF0dHJpYnV0ZVZhbHVlKHNlbGYuX2FiaWxpdGllc1tpXS5hdHRyaWJ1dGVzLCBhdHRyaWJ1dGUubmFtZSwgYWJpbGl0eS5sZXZlbCgpKTtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICAgICAgICAgICAgICAgIGJyZWFrO1xuICAgICAgICAgICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICAgIGVsc2UgaWYgKGFiaWxpdHkuYXJtb3IgIT0gdW5kZWZpbmVkKSB7XG4gICAgICAgICAgICAgICAgICAgIC8vIHNocmVkZGVyX3JlYWN0aXZlX2FybW9yLHZpc2FnZV9ncmF2ZWtlZXBlcnNfY2xvYWtcbiAgICAgICAgICAgICAgICAgICAgdG90YWxBdHRyaWJ1dGUrPWFiaWxpdHkuYXJtb3IoKTtcbiAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICB9XG4gICAgICAgIH1cbiAgICAgICAgcmV0dXJuIHRvdGFsQXR0cmlidXRlO1xuICAgIH0pO1xuXG4gICAgc2VsZi5nZXRBcm1vckJhc2VSZWR1Y3Rpb24gPSBrby5jb21wdXRlZChmdW5jdGlvbiAoKSB7XG4gICAgICAgIHZhciB0b3RhbEF0dHJpYnV0ZSA9IDE7XG4gICAgICAgIGZvciAodmFyIGkgPSAwOyBpIDwgc2VsZi5hYmlsaXRpZXMoKS5sZW5ndGg7IGkrKykge1xuICAgICAgICAgICAgdmFyIGFiaWxpdHkgPSBzZWxmLl9hYmlsaXRpZXNbaV07XG4gICAgICAgICAgICBpZiAoYWJpbGl0eS5sZXZlbCgpID4gMCAmJiAoYWJpbGl0eS5pc0FjdGl2ZSgpIHx8IChhYmlsaXR5LmJlaGF2aW9yLmluZGV4T2YoJ0RPVEFfQUJJTElUWV9CRUhBVklPUl9QQVNTSVZFJykgIT0gLTEpKSkge1xuICAgICAgICAgICAgICAgIC8vaWYgKCEoYWJpbGl0eS5uYW1lIGluIHNlbGYuYWJpbGl0eURhdGEpKSB7XG4gICAgICAgICAgICAgICAgICAgIHN3aXRjaChhYmlsaXR5Lm5hbWUpIHtcbiAgICAgICAgICAgICAgICAgICAgICAgIC8vZWxkZXJfdGl0YW5fbmF0dXJhbF9vcmRlclxuICAgICAgICAgICAgICAgICAgICAgICAgY2FzZSAnZWxkZXJfdGl0YW5fbmF0dXJhbF9vcmRlcic6XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgdG90YWxBdHRyaWJ1dGUgKj0gKDEtc2VsZi5nZXRBYmlsaXR5QXR0cmlidXRlVmFsdWUoc2VsZi5fYWJpbGl0aWVzW2ldLmF0dHJpYnV0ZXMsICdhcm1vcl9yZWR1Y3Rpb25fcGN0JywgYWJpbGl0eS5sZXZlbCgpKS8xMDApO1xuICAgICAgICAgICAgICAgICAgICAgICAgYnJlYWs7XG4gICAgICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgICAvL31cbiAgICAgICAgICAgIH1cbiAgICAgICAgfVxuICAgICAgICByZXR1cm4gdG90YWxBdHRyaWJ1dGU7XG4gICAgfSk7XG4gICAgXG4gICAgc2VsZi5nZXRBcm1vclJlZHVjdGlvbiA9IGtvLmNvbXB1dGVkKGZ1bmN0aW9uICgpIHtcbiAgICAgICAgdmFyIHRvdGFsQXR0cmlidXRlID0gMDtcbiAgICAgICAgZm9yICh2YXIgaSA9IDA7IGkgPCBzZWxmLmFiaWxpdGllcygpLmxlbmd0aDsgaSsrKSB7XG4gICAgICAgICAgICB2YXIgYWJpbGl0eSA9IHNlbGYuX2FiaWxpdGllc1tpXTtcbiAgICAgICAgICAgIGlmIChhYmlsaXR5LmxldmVsKCkgPiAwICYmIChhYmlsaXR5LmlzQWN0aXZlKCkgfHwgKGFiaWxpdHkuYmVoYXZpb3IuaW5kZXhPZignRE9UQV9BQklMSVRZX0JFSEFWSU9SX1BBU1NJVkUnKSAhPSAtMSkpKSB7XG4gICAgICAgICAgICAgICAgaWYgKCEoYWJpbGl0eS5uYW1lIGluIHNlbGYuYWJpbGl0eURhdGEpKSB7XG4gICAgICAgICAgICAgICAgICAgIHN3aXRjaChhYmlsaXR5Lm5hbWUpIHtcbiAgICAgICAgICAgICAgICAgICAgICAgIC8vdGVtcGxhcl9hc3Nhc3Npbl9tZWxkXG4gICAgICAgICAgICAgICAgICAgICAgICBjYXNlICd0ZW1wbGFyX2Fzc2Fzc2luX21lbGQnOlxuICAgICAgICAgICAgICAgICAgICAgICAgICAgIHRvdGFsQXR0cmlidXRlICs9IHNlbGYuZ2V0QWJpbGl0eUF0dHJpYnV0ZVZhbHVlKHNlbGYuX2FiaWxpdGllc1tpXS5hdHRyaWJ1dGVzLCAnYm9udXNfYXJtb3InLCBhYmlsaXR5LmxldmVsKCkpO1xuICAgICAgICAgICAgICAgICAgICAgICAgYnJlYWs7XG4gICAgICAgICAgICAgICAgICAgICAgICAvLyB0aWRlaHVudGVyX2d1c2hcbiAgICAgICAgICAgICAgICAgICAgICAgIGNhc2UgJ3RpZGVodW50ZXJfZ3VzaCc6XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgdG90YWxBdHRyaWJ1dGUgKz0gc2VsZi5nZXRBYmlsaXR5QXR0cmlidXRlVmFsdWUoc2VsZi5fYWJpbGl0aWVzW2ldLmF0dHJpYnV0ZXMsICdhcm1vcl9ib251cycsIGFiaWxpdHkubGV2ZWwoKSk7XG4gICAgICAgICAgICAgICAgICAgICAgICBicmVhaztcbiAgICAgICAgICAgICAgICAgICAgICAgIC8vIG5hZ2Ffc2lyZW5fcmlwX3RpZGVcbiAgICAgICAgICAgICAgICAgICAgICAgIGNhc2UgJ25hZ2Ffc2lyZW5fcmlwX3RpZGUnOlxuICAgICAgICAgICAgICAgICAgICAgICAgLy8gc2xhcmRhcl9hbXBsaWZ5X2RhbWFnZVxuICAgICAgICAgICAgICAgICAgICAgICAgY2FzZSAnc2xhcmRhcl9hbXBsaWZ5X2RhbWFnZSc6XG4gICAgICAgICAgICAgICAgICAgICAgICAvLyB2ZW5nZWZ1bHNwaXJpdF93YXZlX29mX3RlcnJvclxuICAgICAgICAgICAgICAgICAgICAgICAgY2FzZSAndmVuZ2VmdWxzcGlyaXRfd2F2ZV9vZl90ZXJyb3InOlxuICAgICAgICAgICAgICAgICAgICAgICAgICAgIHRvdGFsQXR0cmlidXRlICs9IHNlbGYuZ2V0QWJpbGl0eUF0dHJpYnV0ZVZhbHVlKHNlbGYuX2FiaWxpdGllc1tpXS5hdHRyaWJ1dGVzLCAnYXJtb3JfcmVkdWN0aW9uJywgYWJpbGl0eS5sZXZlbCgpKTtcbiAgICAgICAgICAgICAgICAgICAgICAgIGJyZWFrO1xuICAgICAgICAgICAgICAgICAgICAgICAgLy8gbmV2ZXJtb3JlX2RhcmtfbG9yZFxuICAgICAgICAgICAgICAgICAgICAgICAgY2FzZSAnbmV2ZXJtb3JlX2RhcmtfbG9yZCc6XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgdG90YWxBdHRyaWJ1dGUgKz0gc2VsZi5nZXRBYmlsaXR5QXR0cmlidXRlVmFsdWUoc2VsZi5fYWJpbGl0aWVzW2ldLmF0dHJpYnV0ZXMsICdwcmVzZW5jZV9hcm1vcl9yZWR1Y3Rpb24nLCBhYmlsaXR5LmxldmVsKCkpO1xuICAgICAgICAgICAgICAgICAgICAgICAgYnJlYWs7XG4gICAgICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgICAgZWxzZSBpZiAoYWJpbGl0eS5hcm1vclJlZHVjdGlvbiAhPSB1bmRlZmluZWQpIHtcbiAgICAgICAgICAgICAgICAgICAgLy8gYWxjaGVtaXN0X2FjaWRfc3ByYXlcbiAgICAgICAgICAgICAgICAgICAgdG90YWxBdHRyaWJ1dGUrPWFiaWxpdHkuYXJtb3JSZWR1Y3Rpb24oKTtcbiAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICB9XG4gICAgICAgIH1cbiAgICAgICAgcmV0dXJuIHRvdGFsQXR0cmlidXRlO1xuICAgIH0pO1xuXG4gICAgc2VsZi5nZXRIZWFsdGggPSBrby5jb21wdXRlZChmdW5jdGlvbiAoKSB7XG4gICAgICAgIHZhciB0b3RhbEF0dHJpYnV0ZSA9IDA7XG4gICAgICAgIGZvciAodmFyIGkgPSAwOyBpIDwgc2VsZi5hYmlsaXRpZXMoKS5sZW5ndGg7IGkrKykge1xuICAgICAgICAgICAgdmFyIGFiaWxpdHkgPSBzZWxmLl9hYmlsaXRpZXNbaV07XG4gICAgICAgICAgICBpZiAoYWJpbGl0eS5sZXZlbCgpID4gMCAmJiAoYWJpbGl0eS5pc0FjdGl2ZSgpIHx8IChhYmlsaXR5LmJlaGF2aW9yLmluZGV4T2YoJ0RPVEFfQUJJTElUWV9CRUhBVklPUl9QQVNTSVZFJykgIT0gLTEpKSkge1xuICAgICAgICAgICAgICAgIGlmICghKGFiaWxpdHkubmFtZSBpbiBzZWxmLmFiaWxpdHlEYXRhKSkge1xuICAgICAgICAgICAgICAgICAgICBmb3IgKHZhciBqID0gMDsgaiA8IHNlbGYuX2FiaWxpdGllc1tpXS5hdHRyaWJ1dGVzLmxlbmd0aDsgaisrKSB7XG4gICAgICAgICAgICAgICAgICAgICAgICB2YXIgYXR0cmlidXRlID0gc2VsZi5fYWJpbGl0aWVzW2ldLmF0dHJpYnV0ZXNbal07XG4gICAgICAgICAgICAgICAgICAgICAgICBzd2l0Y2goYXR0cmlidXRlLm5hbWUpIHtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAvLyBsb25lX2RydWlkX3RydWVfZm9ybSxseWNhbl9zaGFwZXNoaWZ0LHRyb2xsX3dhcmxvcmRfYmVyc2Vya2Vyc19yYWdlXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgY2FzZSAnYm9udXNfaHAnOlxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICB0b3RhbEF0dHJpYnV0ZSArPSBzZWxmLmdldEFiaWxpdHlBdHRyaWJ1dGVWYWx1ZShzZWxmLl9hYmlsaXRpZXNbaV0uYXR0cmlidXRlcywgYXR0cmlidXRlLm5hbWUsIGFiaWxpdHkubGV2ZWwoKSk7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgYnJlYWs7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgLy8gbG9uZV9kcnVpZF9zeW5lcmd5XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgY2FzZSAndHJ1ZV9mb3JtX2hwX2JvbnVzJzpcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgaWYgKHNlbGYuaXNUcnVlRm9ybUFjdGl2ZSgpKSB7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICB0b3RhbEF0dHJpYnV0ZSArPSBzZWxmLmdldEFiaWxpdHlBdHRyaWJ1dGVWYWx1ZShzZWxmLl9hYmlsaXRpZXNbaV0uYXR0cmlidXRlcywgYXR0cmlidXRlLm5hbWUsIGFiaWxpdHkubGV2ZWwoKSk7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgICAgICAgICAgICAgICBicmVhaztcbiAgICAgICAgICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgICBlbHNlIGlmIChhYmlsaXR5LmJvbnVzSGVhbHRoICE9IHVuZGVmaW5lZCkge1xuICAgICAgICAgICAgICAgICAgICAvLyBjbGlua3pfZGVhdGhfcGFjdFxuICAgICAgICAgICAgICAgICAgICB0b3RhbEF0dHJpYnV0ZSs9YWJpbGl0eS5ib251c0hlYWx0aCgpO1xuICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgIH1cbiAgICAgICAgfVxuICAgICAgICByZXR1cm4gdG90YWxBdHRyaWJ1dGU7XG4gICAgfSk7XG4gICAgXG4gICAgc2VsZi5pc1RydWVGb3JtQWN0aXZlID0gZnVuY3Rpb24gKCkge1xuICAgICAgICBmb3IgKHZhciBpID0gMDsgaSA8IHNlbGYuYWJpbGl0aWVzKCkubGVuZ3RoOyBpKyspIHtcbiAgICAgICAgICAgIHZhciBhYmlsaXR5ID0gc2VsZi5fYWJpbGl0aWVzW2ldO1xuICAgICAgICAgICAgaWYgKGFiaWxpdHkuaXNBY3RpdmUoKSAmJiBhYmlsaXR5Lm5hbWUgPT0gJ2xvbmVfZHJ1aWRfdHJ1ZV9mb3JtJykge1xuICAgICAgICAgICAgICAgIHJldHVybiB0cnVlO1xuICAgICAgICAgICAgfVxuICAgICAgICB9XG4gICAgICAgIHJldHVybiBmYWxzZTtcbiAgICB9XG5cbiAgICBzZWxmLmdldEhlYWx0aFJlZ2VuID0ga28uY29tcHV0ZWQoZnVuY3Rpb24gKCkge1xuICAgICAgICB2YXIgdG90YWxBdHRyaWJ1dGUgPSAwO1xuICAgICAgICBmb3IgKHZhciBpID0gMDsgaSA8IHNlbGYuYWJpbGl0aWVzKCkubGVuZ3RoOyBpKyspIHtcbiAgICAgICAgICAgIHZhciBhYmlsaXR5ID0gc2VsZi5fYWJpbGl0aWVzW2ldO1xuICAgICAgICAgICAgaWYgKGFiaWxpdHkubGV2ZWwoKSA+IDAgJiYgKGFiaWxpdHkuaXNBY3RpdmUoKSB8fCAoYWJpbGl0eS5iZWhhdmlvci5pbmRleE9mKCdET1RBX0FCSUxJVFlfQkVIQVZJT1JfUEFTU0lWRScpICE9IC0xKSkpIHtcbiAgICAgICAgICAgICAgICBpZiAoIShhYmlsaXR5Lm5hbWUgaW4gc2VsZi5hYmlsaXR5RGF0YSkpIHtcbiAgICAgICAgICAgICAgICAgICAgZm9yICh2YXIgaiA9IDA7IGogPCBzZWxmLl9hYmlsaXRpZXNbaV0uYXR0cmlidXRlcy5sZW5ndGg7IGorKykge1xuICAgICAgICAgICAgICAgICAgICAgICAgdmFyIGF0dHJpYnV0ZSA9IHNlbGYuX2FiaWxpdGllc1tpXS5hdHRyaWJ1dGVzW2pdO1xuICAgICAgICAgICAgICAgICAgICAgICAgc3dpdGNoKGF0dHJpYnV0ZS5uYW1lKSB7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgLy8gYWxjaGVtaXN0X2NoZW1pY2FsX3JhZ2UsIGRyYWdvbl9rbmlnaHRfZHJhZ29uX2Jsb29kXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgY2FzZSAnYm9udXNfaGVhbHRoX3JlZ2VuJzpcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAvLyBicm9vZG1vdGhlcl9zcGluX3dlYlxuICAgICAgICAgICAgICAgICAgICAgICAgICAgIGNhc2UgJ2hlYXRoX3JlZ2VuJzpcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAvLyBvbW5pa25pZ2h0X2d1YXJkaWFuX2FuZ2VsLHRyZWFudF9saXZpbmdfYXJtb3Isc2F0eXJfaGVsbGNhbGxlcl91bmhvbHlfYXVyYVxuICAgICAgICAgICAgICAgICAgICAgICAgICAgIGNhc2UgJ2hlYWx0aF9yZWdlbic6XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIHRvdGFsQXR0cmlidXRlICs9IHNlbGYuZ2V0QWJpbGl0eUF0dHJpYnV0ZVZhbHVlKHNlbGYuX2FiaWxpdGllc1tpXS5hdHRyaWJ1dGVzLCBhdHRyaWJ1dGUubmFtZSwgYWJpbGl0eS5sZXZlbCgpKTtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICBicmVhaztcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAvLyBsZWdpb25fY29tbWFuZGVyX3ByZXNzX3RoZV9hdHRhY2tcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICBjYXNlICdocF9yZWdlbic6XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIHRvdGFsQXR0cmlidXRlICs9IHNlbGYuZ2V0QWJpbGl0eUF0dHJpYnV0ZVZhbHVlKHNlbGYuX2FiaWxpdGllc1tpXS5hdHRyaWJ1dGVzLCBhdHRyaWJ1dGUubmFtZSwgYWJpbGl0eS5sZXZlbCgpKTtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICBicmVhaztcbiAgICAgICAgICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgICBlbHNlIGlmIChhYmlsaXR5LmhlYWx0aHJlZ2VuICE9IHVuZGVmaW5lZCkge1xuICAgICAgICAgICAgICAgICAgICAvLyBzaHJlZGRlcl9yZWFjdGl2ZV9hcm1vcixpbnZva2VyX3F1YXMsbmVjcm9seXRlX3NhZGlzdFxuICAgICAgICAgICAgICAgICAgICB0b3RhbEF0dHJpYnV0ZSs9YWJpbGl0eS5oZWFsdGhyZWdlbigpO1xuICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgIH1cbiAgICAgICAgfVxuICAgICAgICByZXR1cm4gdG90YWxBdHRyaWJ1dGU7XG4gICAgfSk7XG5cbiAgICBzZWxmLmdldE1hbmEgPSBrby5jb21wdXRlZChmdW5jdGlvbiAoKSB7XG4gICAgICAgIHZhciB0b3RhbEF0dHJpYnV0ZSA9IDA7XG4gICAgICAgIGZvciAodmFyIGkgPSAwOyBpIDwgc2VsZi5hYmlsaXRpZXMoKS5sZW5ndGg7IGkrKykge1xuICAgICAgICAgICAgdmFyIGFiaWxpdHkgPSBzZWxmLl9hYmlsaXRpZXNbaV07XG4gICAgICAgICAgICBpZiAoYWJpbGl0eS5sZXZlbCgpID4gMCAmJiAoYWJpbGl0eS5pc0FjdGl2ZSgpIHx8IChhYmlsaXR5LmJlaGF2aW9yLmluZGV4T2YoJ0RPVEFfQUJJTElUWV9CRUhBVklPUl9QQVNTSVZFJykgIT0gLTEpKSkge1xuICAgICAgICAgICAgICAgIC8vaWYgKCEoYWJpbGl0eS5uYW1lIGluIHNlbGYuYWJpbGl0eURhdGEpKSB7XG4gICAgICAgICAgICAgICAgICAgIGZvciAodmFyIGogPSAwOyBqIDwgc2VsZi5fYWJpbGl0aWVzW2ldLmF0dHJpYnV0ZXMubGVuZ3RoOyBqKyspIHtcbiAgICAgICAgICAgICAgICAgICAgICAgIHZhciBhdHRyaWJ1dGUgPSBzZWxmLl9hYmlsaXRpZXNbaV0uYXR0cmlidXRlc1tqXTtcbiAgICAgICAgICAgICAgICAgICAgICAgIHN3aXRjaChhdHRyaWJ1dGUubmFtZSkge1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgIC8vIG9ic2lkaWFuX2Rlc3Ryb3llcl9lc3NlbmNlX2F1cmFcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICBjYXNlICdib251c19tYW5hJzpcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgdG90YWxBdHRyaWJ1dGUgKz0gc2VsZi5nZXRBYmlsaXR5QXR0cmlidXRlVmFsdWUoc2VsZi5fYWJpbGl0aWVzW2ldLmF0dHJpYnV0ZXMsIGF0dHJpYnV0ZS5uYW1lLCBhYmlsaXR5LmxldmVsKCkpO1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgIGJyZWFrO1xuICAgICAgICAgICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgICAgLy99XG4gICAgICAgICAgICB9XG4gICAgICAgIH1cbiAgICAgICAgcmV0dXJuIHRvdGFsQXR0cmlidXRlO1xuICAgIH0pO1xuICAgIFxuICAgIHNlbGYuZ2V0TWFuYVJlZ2VuID0ga28uY29tcHV0ZWQoZnVuY3Rpb24gKCkge1xuICAgICAgICB2YXIgdG90YWxBdHRyaWJ1dGUgPSAwO1xuICAgICAgICBmb3IgKHZhciBpID0gMDsgaSA8IHNlbGYuYWJpbGl0aWVzKCkubGVuZ3RoOyBpKyspIHtcbiAgICAgICAgICAgIHZhciBhYmlsaXR5ID0gc2VsZi5fYWJpbGl0aWVzW2ldO1xuICAgICAgICAgICAgaWYgKGFiaWxpdHkubGV2ZWwoKSA+IDAgJiYgKGFiaWxpdHkuaXNBY3RpdmUoKSB8fCAoYWJpbGl0eS5iZWhhdmlvci5pbmRleE9mKCdET1RBX0FCSUxJVFlfQkVIQVZJT1JfUEFTU0lWRScpICE9IC0xKSkpIHtcbiAgICAgICAgICAgICAgICBpZiAoIShhYmlsaXR5Lm5hbWUgaW4gc2VsZi5hYmlsaXR5RGF0YSkpIHtcbiAgICAgICAgICAgICAgICAgICAgZm9yICh2YXIgaiA9IDA7IGogPCBzZWxmLl9hYmlsaXRpZXNbaV0uYXR0cmlidXRlcy5sZW5ndGg7IGorKykge1xuICAgICAgICAgICAgICAgICAgICAgICAgdmFyIGF0dHJpYnV0ZSA9IHNlbGYuX2FiaWxpdGllc1tpXS5hdHRyaWJ1dGVzW2pdO1xuICAgICAgICAgICAgICAgICAgICAgICAgc3dpdGNoKGF0dHJpYnV0ZS5uYW1lKSB7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgLy8gYWxjaGVtaXN0X2NoZW1pY2FsX3JhZ2VcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICBjYXNlICdib251c19tYW5hX3JlZ2VuJzpcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgdG90YWxBdHRyaWJ1dGUgKz0gc2VsZi5nZXRBYmlsaXR5QXR0cmlidXRlVmFsdWUoc2VsZi5fYWJpbGl0aWVzW2ldLmF0dHJpYnV0ZXMsIGF0dHJpYnV0ZS5uYW1lLCBhYmlsaXR5LmxldmVsKCkpO1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgIGJyZWFrO1xuICAgICAgICAgICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICAgIGVsc2UgaWYgKGFiaWxpdHkubWFuYXJlZ2VuICE9IHVuZGVmaW5lZCkge1xuICAgICAgICAgICAgICAgICAgICAvLyBuZWNyb2x5dGVfc2FkaXN0XG4gICAgICAgICAgICAgICAgICAgIHRvdGFsQXR0cmlidXRlKz1hYmlsaXR5Lm1hbmFyZWdlbigpO1xuICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgIH1cbiAgICAgICAgfVxuICAgICAgICByZXR1cm4gdG90YWxBdHRyaWJ1dGU7XG4gICAgfSk7XG4gICAgXG4gICAgc2VsZi5nZXRNYW5hUmVnZW5BcmNhbmVBdXJhID0ga28uY29tcHV0ZWQoZnVuY3Rpb24gKCkge1xuICAgICAgICB2YXIgdG90YWxBdHRyaWJ1dGUgPSAwO1xuICAgICAgICBmb3IgKHZhciBpID0gMDsgaSA8IHNlbGYuYWJpbGl0aWVzKCkubGVuZ3RoOyBpKyspIHtcbiAgICAgICAgICAgIHZhciBhYmlsaXR5ID0gc2VsZi5fYWJpbGl0aWVzW2ldO1xuICAgICAgICAgICAgaWYgKGFiaWxpdHkubGV2ZWwoKSA+IDAgJiYgKGFiaWxpdHkuaXNBY3RpdmUoKSB8fCAoYWJpbGl0eS5iZWhhdmlvci5pbmRleE9mKCdET1RBX0FCSUxJVFlfQkVIQVZJT1JfUEFTU0lWRScpICE9IC0xKSkpIHtcbiAgICAgICAgICAgICAgICAvL2lmICghKGFiaWxpdHkubmFtZSBpbiBzZWxmLmFiaWxpdHlEYXRhKSkge1xuICAgICAgICAgICAgICAgICAgICBmb3IgKHZhciBqID0gMDsgaiA8IHNlbGYuX2FiaWxpdGllc1tpXS5hdHRyaWJ1dGVzLmxlbmd0aDsgaisrKSB7XG4gICAgICAgICAgICAgICAgICAgICAgICB2YXIgYXR0cmlidXRlID0gc2VsZi5fYWJpbGl0aWVzW2ldLmF0dHJpYnV0ZXNbal07XG4gICAgICAgICAgICAgICAgICAgICAgICBzd2l0Y2goYXR0cmlidXRlLm5hbWUpIHtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAvLyBjcnlzdGFsX21haWRlbl9icmlsbGlhbmNlX2F1cmFcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICBjYXNlICdtYW5hX3JlZ2VuJzpcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgaWYgKGFiaWxpdHkubmFtZSA9PSAnY3J5c3RhbF9tYWlkZW5fYnJpbGxpYW5jZV9hdXJhJykge1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgdG90YWxBdHRyaWJ1dGUgKz0gc2VsZi5nZXRBYmlsaXR5QXR0cmlidXRlVmFsdWUoc2VsZi5fYWJpbGl0aWVzW2ldLmF0dHJpYnV0ZXMsIGF0dHJpYnV0ZS5uYW1lLCBhYmlsaXR5LmxldmVsKCkpO1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgYnJlYWs7XG4gICAgICAgICAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgICAvL31cbiAgICAgICAgICAgIH1cbiAgICAgICAgfVxuICAgICAgICByZXR1cm4gdG90YWxBdHRyaWJ1dGU7XG4gICAgfSk7XG5cbiAgICBzZWxmLmdldE1hbmFSZWdlblJlZHVjdGlvbiA9IGtvLmNvbXB1dGVkKGZ1bmN0aW9uICgpIHtcbiAgICAgICAgdmFyIHRvdGFsQXR0cmlidXRlID0gMDtcbiAgICAgICAgZm9yICh2YXIgaSA9IDA7IGkgPCBzZWxmLmFiaWxpdGllcygpLmxlbmd0aDsgaSsrKSB7XG4gICAgICAgICAgICB2YXIgYWJpbGl0eSA9IHNlbGYuX2FiaWxpdGllc1tpXTtcbiAgICAgICAgICAgIGlmIChhYmlsaXR5LmxldmVsKCkgPiAwICYmIChhYmlsaXR5LmlzQWN0aXZlKCkgfHwgKGFiaWxpdHkuYmVoYXZpb3IuaW5kZXhPZignRE9UQV9BQklMSVRZX0JFSEFWSU9SX1BBU1NJVkUnKSAhPSAtMSkpKSB7XG4gICAgICAgICAgICAgICAgLyppZiAoIShhYmlsaXR5Lm5hbWUgaW4gc2VsZi5hYmlsaXR5RGF0YSkpIHtcbiAgICAgICAgICAgICAgICAgICAgZm9yICh2YXIgaiA9IDA7IGogPCBzZWxmLl9hYmlsaXRpZXNbaV0uYXR0cmlidXRlcy5sZW5ndGg7IGorKykge1xuICAgICAgICAgICAgICAgICAgICAgICAgdmFyIGF0dHJpYnV0ZSA9IHNlbGYuX2FiaWxpdGllc1tpXS5hdHRyaWJ1dGVzW2pdO1xuICAgICAgICAgICAgICAgICAgICAgICAgLy9zd2l0Y2goYXR0cmlidXRlLm5hbWUpIHtcbiAgICAgICAgICAgICAgICAgICAgICAgIC8vICAgIC8vIFxuICAgICAgICAgICAgICAgICAgICAgICAgLy8gICAgY2FzZSAnJzpcbiAgICAgICAgICAgICAgICAgICAgICAgIC8vICAgICAgICB0b3RhbEF0dHJpYnV0ZSArPSBwYXJzZUludChhdHRyaWJ1dGUudmFsdWVbYWJpbGl0eS5sZXZlbCgpLTFdKTtcbiAgICAgICAgICAgICAgICAgICAgICAgIC8vICAgIGJyZWFrO1xuICAgICAgICAgICAgICAgICAgICAgICAgLy99XG4gICAgICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgICAgZWxzZSovIGlmIChhYmlsaXR5Lm1hbmFyZWdlbnJlZHVjdGlvbiAhPSB1bmRlZmluZWQpIHtcbiAgICAgICAgICAgICAgICAgICAgLy8gcHVnbmFfbmV0aGVyX3dhcmRcbiAgICAgICAgICAgICAgICAgICAgdG90YWxBdHRyaWJ1dGUrPWFiaWxpdHkubWFuYXJlZ2VucmVkdWN0aW9uKCk7XG4gICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgfVxuICAgICAgICB9XG4gICAgICAgIHJldHVybiB0b3RhbEF0dHJpYnV0ZTtcbiAgICB9KTtcbiAgICBcbiAgICBzZWxmLmdldEF0dGFja1JhbmdlID0ga28uY29tcHV0ZWQoZnVuY3Rpb24gKCkge1xuICAgICAgICB2YXIgdG90YWxBdHRyaWJ1dGUgPSAwO1xuICAgICAgICBmb3IgKHZhciBpID0gMDsgaSA8IHNlbGYuYWJpbGl0aWVzKCkubGVuZ3RoOyBpKyspIHtcbiAgICAgICAgICAgIHZhciBhYmlsaXR5ID0gc2VsZi5fYWJpbGl0aWVzW2ldO1xuICAgICAgICAgICAgaWYgKGFiaWxpdHkubGV2ZWwoKSA+IDApIHtcbiAgICAgICAgICAgICAgICBpZiAoIShhYmlsaXR5Lm5hbWUgaW4gc2VsZi5hYmlsaXR5RGF0YSkpIHtcbiAgICAgICAgICAgICAgICAgICAgaWYgKGFiaWxpdHkuaXNBY3RpdmUoKSB8fCAoYWJpbGl0eS5iZWhhdmlvci5pbmRleE9mKCdET1RBX0FCSUxJVFlfQkVIQVZJT1JfUEFTU0lWRScpICE9IC0xKSkge1xuICAgICAgICAgICAgICAgICAgICAgICAgZm9yICh2YXIgaiA9IDA7IGogPCBzZWxmLl9hYmlsaXRpZXNbaV0uYXR0cmlidXRlcy5sZW5ndGg7IGorKykge1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgIHZhciBhdHRyaWJ1dGUgPSBzZWxmLl9hYmlsaXRpZXNbaV0uYXR0cmlidXRlc1tqXTtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICBzd2l0Y2goYXR0cmlidXRlLm5hbWUpIHtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgLy8gd2ludGVyX3d5dmVybl9hcmN0aWNfYnVyblxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBjYXNlICdhdHRhY2tfcmFuZ2VfYm9udXMnOlxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAvLyB0ZW1wbGFyX2Fzc2Fzc2luX3BzaV9ibGFkZXMsc25pcGVyX3Rha2VfYWltXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIGNhc2UgJ2JvbnVzX2F0dGFja19yYW5nZSc6XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICB0b3RhbEF0dHJpYnV0ZSArPSBzZWxmLmdldEFiaWxpdHlBdHRyaWJ1dGVWYWx1ZShzZWxmLl9hYmlsaXRpZXNbaV0uYXR0cmlidXRlcywgYXR0cmlidXRlLm5hbWUsIGFiaWxpdHkubGV2ZWwoKSk7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIGJyZWFrO1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAvLyB0ZXJyb3JibGFkZV9tZXRhbW9ycGhvc2lzLHRyb2xsX3dhcmxvcmRfYmVyc2Vya2Vyc19yYWdlXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIGNhc2UgJ2JvbnVzX3JhbmdlJzpcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIGlmIChhYmlsaXR5Lm5hbWUgPT0gJ3RlcnJvcmJsYWRlX21ldGFtb3JwaG9zaXMnKSB7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgdG90YWxBdHRyaWJ1dGUgKz0gc2VsZi5nZXRBYmlsaXR5QXR0cmlidXRlVmFsdWUoc2VsZi5fYWJpbGl0aWVzW2ldLmF0dHJpYnV0ZXMsIGF0dHJpYnV0ZS5uYW1lLCBhYmlsaXR5LmxldmVsKCkpO1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgaWYgKGFiaWxpdHkubmFtZSA9PSAndHJvbGxfd2FybG9yZF9iZXJzZXJrZXJzX3JhZ2UnKSB7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgdG90YWxBdHRyaWJ1dGUgLT0gc2VsZi5nZXRBYmlsaXR5QXR0cmlidXRlVmFsdWUoc2VsZi5fYWJpbGl0aWVzW2ldLmF0dHJpYnV0ZXMsIGF0dHJpYnV0ZS5uYW1lLCBhYmlsaXR5LmxldmVsKCkpO1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBicmVhaztcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgLy8gdGlueV9ncm93XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIGNhc2UgJ2JvbnVzX3JhbmdlX3NjZXB0ZXInOlxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgaWYgKGFiaWxpdHkubmFtZSA9PSAndGlueV9ncm93JyAmJiBzZWxmLmhhc1NjZXB0ZXIoKSkge1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIHRvdGFsQXR0cmlidXRlICs9IHNlbGYuZ2V0QWJpbGl0eUF0dHJpYnV0ZVZhbHVlKHNlbGYuX2FiaWxpdGllc1tpXS5hdHRyaWJ1dGVzLCBhdHRyaWJ1dGUubmFtZSwgYWJpbGl0eS5sZXZlbCgpKTtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgYnJlYWs7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIC8vIGVuY2hhbnRyZXNzX2ltcGV0dXNcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgY2FzZSAnYm9udXNfYXR0YWNrX3JhbmdlX3NjZXB0ZXInOlxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgaWYgKGFiaWxpdHkubmFtZSA9PSAnZW5jaGFudHJlc3NfaW1wZXR1cycgJiYgc2VsZi5oYXNTY2VwdGVyKCkpIHtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICB0b3RhbEF0dHJpYnV0ZSArPSBzZWxmLmdldEFiaWxpdHlBdHRyaWJ1dGVWYWx1ZShzZWxmLl9hYmlsaXRpZXNbaV0uYXR0cmlidXRlcywgYXR0cmlidXRlLm5hbWUsIGFiaWxpdHkubGV2ZWwoKSk7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIGJyZWFrO1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgICAgICAgICAgIC8vIGxvbmVfZHJ1aWRfdHJ1ZV9mb3JtXG4gICAgICAgICAgICAgICAgICAgICAgICBpZiAoYWJpbGl0eS5uYW1lID09ICdsb25lX2RydWlkX3RydWVfZm9ybScpIHtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICB0b3RhbEF0dHJpYnV0ZSAtPSA0MjI7XG4gICAgICAgICAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgICAgICAgZWxzZSBpZiAoYWJpbGl0eS5uYW1lID09ICdlbmNoYW50cmVzc19pbXBldHVzJyAmJiBzZWxmLmhhc1NjZXB0ZXIoKSkge1xuICAgICAgICAgICAgICAgICAgICAgICAgZm9yICh2YXIgaiA9IDA7IGogPCBzZWxmLl9hYmlsaXRpZXNbaV0uYXR0cmlidXRlcy5sZW5ndGg7IGorKykge1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgIHZhciBhdHRyaWJ1dGUgPSBzZWxmLl9hYmlsaXRpZXNbaV0uYXR0cmlidXRlc1tqXTtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICBzd2l0Y2goYXR0cmlidXRlLm5hbWUpIHtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIGNhc2UgJ2JvbnVzX2F0dGFja19yYW5nZV9zY2VwdGVyJzpcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgdG90YWxBdHRyaWJ1dGUgKz0gc2VsZi5nZXRBYmlsaXR5QXR0cmlidXRlVmFsdWUoc2VsZi5fYWJpbGl0aWVzW2ldLmF0dHJpYnV0ZXMsIGF0dHJpYnV0ZS5uYW1lLCBhYmlsaXR5LmxldmVsKCkpO1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgYnJlYWs7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICAgIGVsc2UgaWYgKGFiaWxpdHkuYXR0YWNrcmFuZ2UgIT0gdW5kZWZpbmVkKSB7XG4gICAgICAgICAgICAgICAgICAgIGlmIChhYmlsaXR5LmlzQWN0aXZlKCkgfHwgKGFiaWxpdHkuYmVoYXZpb3IuaW5kZXhPZignRE9UQV9BQklMSVRZX0JFSEFWSU9SX1BBU1NJVkUnKSAhPSAtMSkpIHtcbiAgICAgICAgICAgICAgICAgICAgICAgIC8vIGRyYWdvbl9rbmlnaHRfZWxkZXJfZHJhZ29uX2Zvcm1cbiAgICAgICAgICAgICAgICAgICAgICAgIHRvdGFsQXR0cmlidXRlKz1hYmlsaXR5LmF0dGFja3JhbmdlKCk7XG4gICAgICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICB9XG4gICAgICAgIH1cbiAgICAgICAgcmV0dXJuIHRvdGFsQXR0cmlidXRlO1xuICAgIH0pO1xuICAgIFxuICAgIHNlbGYuZ2V0QXR0YWNrU3BlZWQgPSBrby5jb21wdXRlZChmdW5jdGlvbiAoKSB7XG4gICAgICAgIHZhciB0b3RhbEF0dHJpYnV0ZSA9IDA7XG4gICAgICAgIGZvciAodmFyIGkgPSAwOyBpIDwgc2VsZi5hYmlsaXRpZXMoKS5sZW5ndGg7IGkrKykge1xuICAgICAgICAgICAgdmFyIGFiaWxpdHkgPSBzZWxmLl9hYmlsaXRpZXNbaV07XG4gICAgICAgICAgICBpZiAoYWJpbGl0eS5sZXZlbCgpID4gMCAmJiAoYWJpbGl0eS5pc0FjdGl2ZSgpIHx8IChhYmlsaXR5LmJlaGF2aW9yLmluZGV4T2YoJ0RPVEFfQUJJTElUWV9CRUhBVklPUl9QQVNTSVZFJykgIT0gLTEpKSkge1xuICAgICAgICAgICAgICAgIGlmICghKGFiaWxpdHkubmFtZSBpbiBzZWxmLmFiaWxpdHlEYXRhKSkge1xuICAgICAgICAgICAgICAgICAgICBmb3IgKHZhciBqID0gMDsgaiA8IHNlbGYuX2FiaWxpdGllc1tpXS5hdHRyaWJ1dGVzLmxlbmd0aDsgaisrKSB7XG4gICAgICAgICAgICAgICAgICAgICAgICB2YXIgYXR0cmlidXRlID0gc2VsZi5fYWJpbGl0aWVzW2ldLmF0dHJpYnV0ZXNbal07XG4gICAgICAgICAgICAgICAgICAgICAgICBzd2l0Y2goYXR0cmlidXRlLm5hbWUpIHtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAvLyBhYmFkZG9uX2Zyb3N0bW91cm5lLHRyb2xsX3dhcmxvcmRfYmF0dGxlX3RyYW5jZVxuICAgICAgICAgICAgICAgICAgICAgICAgICAgIGNhc2UgJ2F0dGFja19zcGVlZCc6XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgLy8gdmlzYWdlX2dyYXZlX2NoaWxsXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgY2FzZSAnYXR0YWNrc3BlZWRfYm9udXMnOlxuICAgICAgICAgICAgICAgICAgICAgICAgICAgIC8vIG1pcmFuYV9sZWFwXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgY2FzZSAnbGVhcF9zcGVlZGJvbnVzX2FzJzpcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAvLyBsaWZlX3N0ZWFsZXJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICBjYXNlICdhdHRhY2tfc3BlZWRfYm9udXMnOlxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICB0b3RhbEF0dHJpYnV0ZSArPSBzZWxmLmdldEFiaWxpdHlBdHRyaWJ1dGVWYWx1ZShzZWxmLl9hYmlsaXRpZXNbaV0uYXR0cmlidXRlcywgYXR0cmlidXRlLm5hbWUsIGFiaWxpdHkubGV2ZWwoKSk7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgYnJlYWs7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgLy8gY2xpbmt6X3N0cmFmZSx1cnNhX292ZXJwb3dlclxuICAgICAgICAgICAgICAgICAgICAgICAgICAgIGNhc2UgJ2F0dGFja19zcGVlZF9ib251c19wY3QnOlxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBpZiAoYWJpbGl0eS5uYW1lID09ICdjbGlua3pfc3RyYWZlJyB8fCBhYmlsaXR5Lm5hbWUgPT0gJ3Vyc2Ffb3ZlcnBvd2VyJykge1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgdG90YWxBdHRyaWJ1dGUgKz0gc2VsZi5nZXRBYmlsaXR5QXR0cmlidXRlVmFsdWUoc2VsZi5fYWJpbGl0aWVzW2ldLmF0dHJpYnV0ZXMsIGF0dHJpYnV0ZS5uYW1lLCBhYmlsaXR5LmxldmVsKCkpO1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgYnJlYWs7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgLy8gYXhlX2N1bGxpbmdfYmxhZGUsbmVjcm9ub21pY29uX2FyY2hlcl9hb2VcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICBjYXNlICdzcGVlZF9ib251cyc6XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIGlmIChhYmlsaXR5Lm5hbWUgPT0gJ2F4ZV9jdWxsaW5nX2JsYWRlJyB8fCBhYmlsaXR5Lm5hbWUgPT0gJ25lY3Jvbm9taWNvbl9hcmNoZXJfYW9lJykge1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgdG90YWxBdHRyaWJ1dGUgKz0gc2VsZi5nZXRBYmlsaXR5QXR0cmlidXRlVmFsdWUoc2VsZi5fYWJpbGl0aWVzW2ldLmF0dHJpYnV0ZXMsIGF0dHJpYnV0ZS5uYW1lLCBhYmlsaXR5LmxldmVsKCkpO1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgYnJlYWs7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgLy8gYW5jaWVudF9hcHBhcml0aW9uX2NoaWxsaW5nX3RvdWNoXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgY2FzZSAnYXR0YWNrX3NwZWVkX3BjdCc6XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIGlmIChhYmlsaXR5Lm5hbWUgPT0gJ2FuY2llbnRfYXBwYXJpdGlvbl9jaGlsbGluZ190b3VjaCcpIHtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIHRvdGFsQXR0cmlidXRlICs9IHNlbGYuZ2V0QWJpbGl0eUF0dHJpYnV0ZVZhbHVlKHNlbGYuX2FiaWxpdGllc1tpXS5hdHRyaWJ1dGVzLCBhdHRyaWJ1dGUubmFtZSwgYWJpbGl0eS5sZXZlbCgpKTtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICAgICAgICAgICAgICAgIGJyZWFrO1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgIC8vIGJlYXN0bWFzdGVyX2lubmVyX2JlYXN0LGx5Y2FuX2ZlcmFsX2ltcHVsc2UsbG9uZV9kcnVpZF9yYWJpZCx0aW55X2dyb3cscGhhbnRvbV9hc3Nhc3Npbl9waGFudG9tX3N0cmlrZSx3aW5kcnVubmVyX2ZvY3VzZmlyZSxvZ3JlX21hZ2lfYmxvb2RsdXN0LGNlbnRhdXJfa2hhbl9lbmR1cmFuY2VfYXVyYVxuICAgICAgICAgICAgICAgICAgICAgICAgICAgIGNhc2UgJ2JvbnVzX2F0dGFja19zcGVlZCc6XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIGlmIChhYmlsaXR5Lm5hbWUgPT0gJ2JlYXN0bWFzdGVyX2lubmVyX2JlYXN0JyBcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIHx8IGFiaWxpdHkubmFtZSA9PSAnbHljYW5fZmVyYWxfaW1wdWxzZScgXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICB8fCBhYmlsaXR5Lm5hbWUgPT0gJ2xvbmVfZHJ1aWRfcmFiaWQnIFxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgfHwgYWJpbGl0eS5uYW1lID09ICd0aW55X2dyb3cnIFxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgfHwgYWJpbGl0eS5uYW1lID09ICdwaGFudG9tX2Fzc2Fzc2luX3BoYW50b21fc3RyaWtlJyBcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIHx8IGFiaWxpdHkubmFtZSA9PSAnd2luZHJ1bm5lcl9mb2N1c2ZpcmUnIFxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgfHwgYWJpbGl0eS5uYW1lID09ICdvZ3JlX21hZ2lfYmxvb2RsdXN0J1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgfHwgYWJpbGl0eS5uYW1lID09ICdjZW50YXVyX2toYW5fZW5kdXJhbmNlX2F1cmEnKSB7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICB0b3RhbEF0dHJpYnV0ZSArPSBzZWxmLmdldEFiaWxpdHlBdHRyaWJ1dGVWYWx1ZShzZWxmLl9hYmlsaXRpZXNbaV0uYXR0cmlidXRlcywgYXR0cmlidXRlLm5hbWUsIGFiaWxpdHkubGV2ZWwoKSk7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgICAgICAgICAgICAgICBicmVhaztcbiAgICAgICAgICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgICBlbHNlIGlmIChhYmlsaXR5LmF0dGFja3NwZWVkICE9IHVuZGVmaW5lZCkge1xuICAgICAgICAgICAgICAgICAgICAvLyB0cm9sbF93YXJsb3JkX2ZlcnZvcix3aXNwX292ZXJjaGFyZ2UsbGluYV9maWVyeV9zb3VsLGludm9rZXJfYWxhY3JpdHksaW52b2tlcl93ZXgsaHVza2FyX2JlcnNlcmtlcnNfYmxvb2RcbiAgICAgICAgICAgICAgICAgICAgdG90YWxBdHRyaWJ1dGUrPWFiaWxpdHkuYXR0YWNrc3BlZWQoKTtcbiAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICB9XG4gICAgICAgIH1cbiAgICAgICAgcmV0dXJuIHRvdGFsQXR0cmlidXRlO1xuICAgIH0pO1xuXG4gICAgc2VsZi5nZXRBdHRhY2tTcGVlZFJlZHVjdGlvbiA9IGtvLmNvbXB1dGVkKGZ1bmN0aW9uICgpIHtcbiAgICAgICAgdmFyIHRvdGFsQXR0cmlidXRlID0gMDtcbiAgICAgICAgZm9yICh2YXIgaSA9IDA7IGkgPCBzZWxmLmFiaWxpdGllcygpLmxlbmd0aDsgaSsrKSB7XG4gICAgICAgICAgICB2YXIgYWJpbGl0eSA9IHNlbGYuX2FiaWxpdGllc1tpXTtcbiAgICAgICAgICAgIGlmIChhYmlsaXR5LmxldmVsKCkgPiAwICYmIChhYmlsaXR5LmlzQWN0aXZlKCkgfHwgKGFiaWxpdHkuYmVoYXZpb3IuaW5kZXhPZignRE9UQV9BQklMSVRZX0JFSEFWSU9SX1BBU1NJVkUnKSAhPSAtMSkpKSB7XG4gICAgICAgICAgICAgICAgaWYgKCEoYWJpbGl0eS5uYW1lIGluIHNlbGYuYWJpbGl0eURhdGEpKSB7XG4gICAgICAgICAgICAgICAgICAgIGZvciAodmFyIGogPSAwOyBqIDwgc2VsZi5fYWJpbGl0aWVzW2ldLmF0dHJpYnV0ZXMubGVuZ3RoOyBqKyspIHtcbiAgICAgICAgICAgICAgICAgICAgICAgIHZhciBhdHRyaWJ1dGUgPSBzZWxmLl9hYmlsaXRpZXNbaV0uYXR0cmlidXRlc1tqXTtcbiAgICAgICAgICAgICAgICAgICAgICAgIHN3aXRjaChhdHRyaWJ1dGUubmFtZSkge1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgIC8vIG5pZ2h0X3N0YWxrZXJfdm9pZCxjcnlzdGFsX21haWRlbl9jcnlzdGFsX25vdmEsZ2hvc3RfZnJvc3RfYXR0YWNrLG9ncmVfbWFnaV9mcm9zdF9hcm1vcixwb2xhcl9mdXJib2xnX3Vyc2Ffd2Fycmlvcl90aHVuZGVyX2NsYXBcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICBjYXNlICdhdHRhY2tzcGVlZF9zbG93JzpcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAvLyBsaWNoX2Zyb3N0X2FybW9yLGxpY2hfZnJvc3Rfbm92YSxlbmNoYW50cmVzc191bnRvdWNoYWJsZVxuICAgICAgICAgICAgICAgICAgICAgICAgICAgIGNhc2UgJ3Nsb3dfYXR0YWNrX3NwZWVkJzpcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAvLyBiZWFzdG1hc3Rlcl9wcmltYWxfcm9hclxuICAgICAgICAgICAgICAgICAgICAgICAgICAgIGNhc2UgJ3Nsb3dfYXR0YWNrX3NwZWVkX3BjdCc6XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgLy8gc3Rvcm1fc3Bpcml0X292ZXJsb2FkXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgY2FzZSAnb3ZlcmxvYWRfYXR0YWNrX3Nsb3cnOlxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICB0b3RhbEF0dHJpYnV0ZSArPSBzZWxmLmdldEFiaWxpdHlBdHRyaWJ1dGVWYWx1ZShzZWxmLl9hYmlsaXRpZXNbaV0uYXR0cmlidXRlcywgYXR0cmlidXRlLm5hbWUsIGFiaWxpdHkubGV2ZWwoKSk7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgYnJlYWs7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgLy8gb21uaWtuaWdodF9kZWdlbl9hdXJhXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgY2FzZSAnc3BlZWRfYm9udXMnOlxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBpZiAoYWJpbGl0eS5uYW1lID09ICdvbW5pa25pZ2h0X2RlZ2VuX2F1cmEnKSB7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICB0b3RhbEF0dHJpYnV0ZSArPSBzZWxmLmdldEFiaWxpdHlBdHRyaWJ1dGVWYWx1ZShzZWxmLl9hYmlsaXRpZXNbaV0uYXR0cmlidXRlcywgYXR0cmlidXRlLm5hbWUsIGFiaWxpdHkubGV2ZWwoKSk7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgICAgICAgICAgICAgICBicmVhaztcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAvLyB0dXNrX2Zyb3plbl9zaWdpbCxjcnlzdGFsX21haWRlbl9mcmVlemluZ19maWVsZFxuICAgICAgICAgICAgICAgICAgICAgICAgICAgIGNhc2UgJ2F0dGFja19zbG93JzpcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgaWYgKGFiaWxpdHkubmFtZSA9PSAnY3J5c3RhbF9tYWlkZW5fZnJlZXppbmdfZmllbGQnICYmICFzZWxmLmhhc1NjZXB0ZXIoKSkge1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgdG90YWxBdHRyaWJ1dGUgKz0gc2VsZi5nZXRBYmlsaXR5QXR0cmlidXRlVmFsdWUoc2VsZi5fYWJpbGl0aWVzW2ldLmF0dHJpYnV0ZXMsIGF0dHJpYnV0ZS5uYW1lLCBhYmlsaXR5LmxldmVsKCkpO1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIGVsc2UgaWYgKGFiaWxpdHkubmFtZSA9PSAndHVza19mcm96ZW5fc2lnaWwnKSB7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICB0b3RhbEF0dHJpYnV0ZSAtPSBzZWxmLmdldEFiaWxpdHlBdHRyaWJ1dGVWYWx1ZShzZWxmLl9hYmlsaXRpZXNbaV0uYXR0cmlidXRlcywgYXR0cmlidXRlLm5hbWUsIGFiaWxpdHkubGV2ZWwoKSk7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgICAgICAgICAgICAgICBicmVhaztcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICBjYXNlICdhdHRhY2tfc2xvd19zY2VwdGVyJzpcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgaWYgKGFiaWxpdHkubmFtZSA9PSAnY3J5c3RhbF9tYWlkZW5fZnJlZXppbmdfZmllbGQnICYmIHNlbGYuaGFzU2NlcHRlcigpKSB7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICB0b3RhbEF0dHJpYnV0ZSArPSBzZWxmLmdldEFiaWxpdHlBdHRyaWJ1dGVWYWx1ZShzZWxmLl9hYmlsaXRpZXNbaV0uYXR0cmlidXRlcywgYXR0cmlidXRlLm5hbWUsIGFiaWxpdHkubGV2ZWwoKSk7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgICAgICAgICAgICAgICBicmVhaztcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAvLyBmYWNlbGVzc192b2lkX3RpbWVfd2Fsa1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgIGNhc2UgJ2F0dGFja19zcGVlZF9wY3QnOlxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBpZiAoYWJpbGl0eS5uYW1lID09ICdmYWNlbGVzc192b2lkX3RpbWVfd2FsaycpIHtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIHRvdGFsQXR0cmlidXRlICs9IHNlbGYuZ2V0QWJpbGl0eUF0dHJpYnV0ZVZhbHVlKHNlbGYuX2FiaWxpdGllc1tpXS5hdHRyaWJ1dGVzLCBhdHRyaWJ1dGUubmFtZSwgYWJpbGl0eS5sZXZlbCgpKTtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICAgICAgICAgICAgICAgIGJyZWFrO1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgIC8vIGJvdW50eV9odW50ZXJfamluYWRhXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgY2FzZSAnYm9udXNfYXR0YWNrc3BlZWQnOlxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBpZiAoYWJpbGl0eS5uYW1lID09ICdib3VudHlfaHVudGVyX2ppbmFkYScpIHtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIHRvdGFsQXR0cmlidXRlICs9IHNlbGYuZ2V0QWJpbGl0eUF0dHJpYnV0ZVZhbHVlKHNlbGYuX2FiaWxpdGllc1tpXS5hdHRyaWJ1dGVzLCBhdHRyaWJ1dGUubmFtZSwgYWJpbGl0eS5sZXZlbCgpKTtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICAgICAgICAgICAgICAgIGJyZWFrO1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgIC8vIGJyZXdtYXN0ZXJfdGh1bmRlcl9jbGFwXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgY2FzZSAnYXR0YWNrX3NwZWVkX3Nsb3cnOlxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBpZiAoYWJpbGl0eS5uYW1lID09ICdicmV3bWFzdGVyX3RodW5kZXJfY2xhcCcpIHtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIHRvdGFsQXR0cmlidXRlIC09IHNlbGYuZ2V0QWJpbGl0eUF0dHJpYnV0ZVZhbHVlKHNlbGYuX2FiaWxpdGllc1tpXS5hdHRyaWJ1dGVzLCBhdHRyaWJ1dGUubmFtZSwgYWJpbGl0eS5sZXZlbCgpKTtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICAgICAgICAgICAgICAgIGJyZWFrO1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgIC8vIG1lZHVzYV9zdG9uZV9nYXplXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgY2FzZSAnc2xvdyc6XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIGlmIChhYmlsaXR5Lm5hbWUgPT0gJ21lZHVzYV9zdG9uZV9nYXplJykge1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgdG90YWxBdHRyaWJ1dGUgLT0gc2VsZi5nZXRBYmlsaXR5QXR0cmlidXRlVmFsdWUoc2VsZi5fYWJpbGl0aWVzW2ldLmF0dHJpYnV0ZXMsIGF0dHJpYnV0ZS5uYW1lLCBhYmlsaXR5LmxldmVsKCkpO1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgYnJlYWs7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgLy8gdmlzYWdlX2dyYXZlX2NoaWxsXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgY2FzZSAnYXR0YWNrc3BlZWRfYm9udXMnOlxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICB0b3RhbEF0dHJpYnV0ZSAtPSBzZWxmLmdldEFiaWxpdHlBdHRyaWJ1dGVWYWx1ZShzZWxmLl9hYmlsaXRpZXNbaV0uYXR0cmlidXRlcywgYXR0cmlidXRlLm5hbWUsIGFiaWxpdHkubGV2ZWwoKSk7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgYnJlYWs7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgLy8gYWJhZGRvbl9mcm9zdG1vdXJuZVxuICAgICAgICAgICAgICAgICAgICAgICAgICAgIGNhc2UgJ2F0dGFja19zbG93X3Rvb2x0aXAnOlxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBpZiAoYWJpbGl0eS5uYW1lID09ICdhYmFkZG9uX2Zyb3N0bW91cm5lJykge1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgdG90YWxBdHRyaWJ1dGUgLT0gc2VsZi5nZXRBYmlsaXR5QXR0cmlidXRlVmFsdWUoc2VsZi5fYWJpbGl0aWVzW2ldLmF0dHJpYnV0ZXMsIGF0dHJpYnV0ZS5uYW1lLCBhYmlsaXR5LmxldmVsKCkpO1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgYnJlYWs7XG4gICAgICAgICAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgICAgICAgaWYgKGFiaWxpdHkubmFtZSA9PSAnZW5yYWdlZF93aWxka2luX3Rvcm5hZG8nKSB7XG4gICAgICAgICAgICAgICAgICAgICAgICB0b3RhbEF0dHJpYnV0ZSAtPSAxNTtcbiAgICAgICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgICBlbHNlIGlmIChhYmlsaXR5LmF0dGFja3NwZWVkcmVkdWN0aW9uICE9IHVuZGVmaW5lZCkge1xuICAgICAgICAgICAgICAgICAgICAvLyB2aXBlcl92aXBlcl9zdHJpa2UsdmlwZXJfY29ycm9zaXZlX3NraW4samFraXJvX2xpcXVpZF9maXJlLGxpY2hfY2hhaW5fZnJvc3Qsc2FuZGtpbmdfZXBpY2VudGVyLGVhcnRoX3NwaXJpdF9yb2xsaW5nX2JvdWxkZXJcbiAgICAgICAgICAgICAgICAgICAgdG90YWxBdHRyaWJ1dGUrPWFiaWxpdHkuYXR0YWNrc3BlZWRyZWR1Y3Rpb24oKTtcbiAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICB9XG4gICAgICAgIH1cbiAgICAgICAgcmV0dXJuIHRvdGFsQXR0cmlidXRlO1xuICAgIH0pO1xuICAgIHNlbGYuZ2V0QmFzaCA9IGtvLmNvbXB1dGVkKGZ1bmN0aW9uICgpIHtcbiAgICAgICAgdmFyIHRvdGFsQXR0cmlidXRlID0gMTtcbiAgICAgICAgZm9yICh2YXIgaSA9IDA7IGkgPCBzZWxmLmFiaWxpdGllcygpLmxlbmd0aDsgaSsrKSB7XG4gICAgICAgICAgICB2YXIgYWJpbGl0eSA9IHNlbGYuX2FiaWxpdGllc1tpXTtcbiAgICAgICAgICAgIGlmIChhYmlsaXR5LmxldmVsKCkgPiAwICYmIChhYmlsaXR5LmlzQWN0aXZlKCkgfHwgKGFiaWxpdHkuYmVoYXZpb3IuaW5kZXhPZignRE9UQV9BQklMSVRZX0JFSEFWSU9SX1BBU1NJVkUnKSAhPSAtMSkpKSB7XG4gICAgICAgICAgICAgICAgaWYgKCEoYWJpbGl0eS5uYW1lIGluIHNlbGYuYWJpbGl0eURhdGEpKSB7XG4gICAgICAgICAgICAgICAgICAgIGZvciAodmFyIGogPSAwOyBqIDwgc2VsZi5fYWJpbGl0aWVzW2ldLmF0dHJpYnV0ZXMubGVuZ3RoOyBqKyspIHtcbiAgICAgICAgICAgICAgICAgICAgICAgIHZhciBhdHRyaWJ1dGUgPSBzZWxmLl9hYmlsaXRpZXNbaV0uYXR0cmlidXRlc1tqXTtcbiAgICAgICAgICAgICAgICAgICAgICAgIHN3aXRjaChhdHRyaWJ1dGUubmFtZSkge1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgIC8vIHNsYXJkYXJfYmFzaFxuICAgICAgICAgICAgICAgICAgICAgICAgICAgIGNhc2UgJ2NoYW5jZSc6XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgLy8gc25pcGVyX2hlYWRzaG90XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgY2FzZSAncHJvY19jaGFuY2UnOlxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICB0b3RhbEF0dHJpYnV0ZSAqPSAoMSAtIHNlbGYuZ2V0QWJpbGl0eUF0dHJpYnV0ZVZhbHVlKHNlbGYuX2FiaWxpdGllc1tpXS5hdHRyaWJ1dGVzLCBhdHRyaWJ1dGUubmFtZSwgYWJpbGl0eS5sZXZlbCgpKS8xMDApO1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgIGJyZWFrO1xuICAgICAgICAgICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICAgIGVsc2UgaWYgKGFiaWxpdHkuYmFzaCAhPSB1bmRlZmluZWQpIHtcbiAgICAgICAgICAgICAgICAgICAgLy8gc3Bpcml0X2JyZWFrZXJfZ3JlYXRlcl9iYXNoLGZhY2VsZXNzX3ZvaWRfdGltZV9sb2NrXG4gICAgICAgICAgICAgICAgICAgIHRvdGFsQXR0cmlidXRlICo9ICgxIC0gYWJpbGl0eS5iYXNoKCkvMTAwKTtcbiAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICB9XG4gICAgICAgIH1cbiAgICAgICAgcmV0dXJuIHRvdGFsQXR0cmlidXRlO1xuICAgIH0pOyAgICBcbiAgICBzZWxmLmdldEJhc2VEYW1hZ2UgPSBrby5jb21wdXRlZChmdW5jdGlvbiAoKSB7XG4gICAgICAgIHZhciB0b3RhbEF0dHJpYnV0ZSA9IDA7XG4gICAgICAgIHZhciB0b3RhbE11bHRpcGxpZXIgPSAxO1xuICAgICAgICB2YXIgc291cmNlcyA9IHt9O1xuICAgICAgICBmb3IgKHZhciBpID0gMDsgaSA8IHNlbGYuYWJpbGl0aWVzKCkubGVuZ3RoOyBpKyspIHtcbiAgICAgICAgICAgIHZhciBhYmlsaXR5ID0gc2VsZi5fYWJpbGl0aWVzW2ldO1xuICAgICAgICAgICAgaWYgKGFiaWxpdHkubGV2ZWwoKSA+IDAgJiYgKGFiaWxpdHkuaXNBY3RpdmUoKSB8fCAoYWJpbGl0eS5iZWhhdmlvci5pbmRleE9mKCdET1RBX0FCSUxJVFlfQkVIQVZJT1JfUEFTU0lWRScpICE9IC0xKSkpIHtcbiAgICAgICAgICAgICAgICBpZiAoIShhYmlsaXR5Lm5hbWUgaW4gc2VsZi5hYmlsaXR5RGF0YSkpIHtcbiAgICAgICAgICAgICAgICAgICAgZm9yICh2YXIgaiA9IDA7IGogPCBzZWxmLl9hYmlsaXRpZXNbaV0uYXR0cmlidXRlcy5sZW5ndGg7IGorKykge1xuICAgICAgICAgICAgICAgICAgICAgICAgdmFyIGF0dHJpYnV0ZSA9IHNlbGYuX2FiaWxpdGllc1tpXS5hdHRyaWJ1dGVzW2pdO1xuICAgICAgICAgICAgICAgICAgICAgICAgc3dpdGNoKGF0dHJpYnV0ZS5uYW1lKSB7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgLy8gdGlueV9ncm93LHRlcnJvcmJsYWRlX21ldGFtb3JwaG9zaXNcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICBjYXNlICdib251c19kYW1hZ2UnOlxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBpZiAoYWJpbGl0eS5uYW1lID09ICd0aW55X2dyb3cnIHx8IGFiaWxpdHkubmFtZSA9PSAndGVycm9yYmxhZGVfbWV0YW1vcnBob3NpcycpIHtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIHRvdGFsQXR0cmlidXRlICs9IHNlbGYuZ2V0QWJpbGl0eUF0dHJpYnV0ZVZhbHVlKHNlbGYuX2FiaWxpdGllc1tpXS5hdHRyaWJ1dGVzLCBhdHRyaWJ1dGUubmFtZSwgYWJpbGl0eS5sZXZlbCgpKTtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIHNvdXJjZXNbYWJpbGl0eS5uYW1lXSA9IHtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAnZGFtYWdlJzogc2VsZi5nZXRBYmlsaXR5QXR0cmlidXRlVmFsdWUoc2VsZi5fYWJpbGl0aWVzW2ldLmF0dHJpYnV0ZXMsIGF0dHJpYnV0ZS5uYW1lLCBhYmlsaXR5LmxldmVsKCkpLFxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICdkYW1hZ2VUeXBlJzogJ3BoeXNpY2FsJyxcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAnZGlzcGxheW5hbWUnOiBhYmlsaXR5LmRpc3BsYXluYW1lXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgICAgICAgICAgICAgICBicmVhaztcbiAgICAgICAgICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgICBlbHNlIHtcbiAgICAgICAgICAgICAgICAgICAgaWYgKGFiaWxpdHkuYmFzZURhbWFnZU11bHRpcGxpZXIgIT0gdW5kZWZpbmVkKSB7XG4gICAgICAgICAgICAgICAgICAgICAgICAvLyBlYXJ0aHNoYWtlcl9lbmNoYW50X3RvdGVtXG4gICAgICAgICAgICAgICAgICAgICAgICB0b3RhbE11bHRpcGxpZXIgKz0gYWJpbGl0eS5iYXNlRGFtYWdlTXVsdGlwbGllcigpLzEwMDtcbiAgICAgICAgICAgICAgICAgICAgICAgIC8qdG90YWxBdHRyaWJ1dGUgKz0gYWJpbGl0eS5iYXNlRGFtYWdlKCk7XG4gICAgICAgICAgICAgICAgICAgICAgICBzb3VyY2VzW2FiaWxpdHkubmFtZV0gPSB7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgJ2RhbWFnZSc6IGFiaWxpdHkuYmFzZURhbWFnZSgpLFxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICdkYW1hZ2VUeXBlJzogJ3BoeXNpY2FsJyxcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAnZGlzcGxheW5hbWUnOiBhYmlsaXR5LmRpc3BsYXluYW1lXG4gICAgICAgICAgICAgICAgICAgICAgICB9Ki9cbiAgICAgICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICAgICAgICBpZiAoYWJpbGl0eS5iYXNlRGFtYWdlICE9IHVuZGVmaW5lZCkge1xuICAgICAgICAgICAgICAgICAgICAgICAgLy8gY2xpbmt6X2RlYXRoX3BhY3RcbiAgICAgICAgICAgICAgICAgICAgICAgIHRvdGFsQXR0cmlidXRlICs9IGFiaWxpdHkuYmFzZURhbWFnZSgpO1xuICAgICAgICAgICAgICAgICAgICAgICAgc291cmNlc1thYmlsaXR5Lm5hbWVdID0ge1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgICdkYW1hZ2UnOiBhYmlsaXR5LmJhc2VEYW1hZ2UoKSxcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAnZGFtYWdlVHlwZSc6ICdwaHlzaWNhbCcsXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgJ2Rpc3BsYXluYW1lJzogYWJpbGl0eS5kaXNwbGF5bmFtZVxuICAgICAgICAgICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgfVxuICAgICAgICB9XG4gICAgICAgIHJldHVybiB7IHNvdXJjZXM6IHNvdXJjZXMsIHRvdGFsOiB0b3RhbEF0dHJpYnV0ZSwgbXVsdGlwbGllcjogdG90YWxNdWx0aXBsaWVyIH07XG4gICAgfSk7XG4gICAgXG4gICAgc2VsZi5nZXRTZWxmQmFzZURhbWFnZVJlZHVjdGlvblBjdCA9IGtvLmNvbXB1dGVkKGZ1bmN0aW9uICgpIHtcbiAgICAgICAgdmFyIHRvdGFsQXR0cmlidXRlID0gMTtcbiAgICAgICAgZm9yICh2YXIgaSA9IDA7IGkgPCBzZWxmLmFiaWxpdGllcygpLmxlbmd0aDsgaSsrKSB7XG4gICAgICAgICAgICB2YXIgYWJpbGl0eSA9IHNlbGYuX2FiaWxpdGllc1tpXTtcbiAgICAgICAgICAgIGlmIChhYmlsaXR5LmxldmVsKCkgPiAwICYmIChhYmlsaXR5LmlzQWN0aXZlKCkgfHwgKGFiaWxpdHkuYmVoYXZpb3IuaW5kZXhPZignRE9UQV9BQklMSVRZX0JFSEFWSU9SX1BBU1NJVkUnKSAhPSAtMSkpKSB7XG4gICAgICAgICAgICAgICAgaWYgKCEoYWJpbGl0eS5uYW1lIGluIHNlbGYuYWJpbGl0eURhdGEpKSB7XG4gICAgICAgICAgICAgICAgICAgIGZvciAodmFyIGogPSAwOyBqIDwgc2VsZi5fYWJpbGl0aWVzW2ldLmF0dHJpYnV0ZXMubGVuZ3RoOyBqKyspIHtcbiAgICAgICAgICAgICAgICAgICAgICAgIHZhciBhdHRyaWJ1dGUgPSBzZWxmLl9hYmlsaXRpZXNbaV0uYXR0cmlidXRlc1tqXTtcbiAgICAgICAgICAgICAgICAgICAgICAgIHN3aXRjaChhdHRyaWJ1dGUubmFtZSkge1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgIC8vIG1lZHVzYV9zcGxpdF9zaG90XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgY2FzZSAnZGFtYWdlX21vZGlmaWVyJzpcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgdG90YWxBdHRyaWJ1dGUgKj0gKDEgKyBzZWxmLmdldEFiaWxpdHlBdHRyaWJ1dGVWYWx1ZShzZWxmLl9hYmlsaXRpZXNbaV0uYXR0cmlidXRlcywgYXR0cmlidXRlLm5hbWUsIGFiaWxpdHkubGV2ZWwoKSkvMTAwKTtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICBicmVhaztcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAvLyB3aW5kcnVubmVyX2ZvY3VzZmlyZVxuICAgICAgICAgICAgICAgICAgICAgICAgICAgIGNhc2UgJ2ZvY3VzZmlyZV9kYW1hZ2VfcmVkdWN0aW9uJzpcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgaWYgKCFzZWxmLmhhc1NjZXB0ZXIoKSkge1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgdG90YWxBdHRyaWJ1dGUgKj0gKDEgKyBzZWxmLmdldEFiaWxpdHlBdHRyaWJ1dGVWYWx1ZShzZWxmLl9hYmlsaXRpZXNbaV0uYXR0cmlidXRlcywgYXR0cmlidXRlLm5hbWUsIGFiaWxpdHkubGV2ZWwoKSkvMTAwKTtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICAgICAgICAgICAgICAgIGJyZWFrO1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgIGNhc2UgJ2ZvY3VzZmlyZV9kYW1hZ2VfcmVkdWN0aW9uX3NjZXB0ZXInOlxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBpZiAoc2VsZi5oYXNTY2VwdGVyKCkpIHtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIHRvdGFsQXR0cmlidXRlICo9ICgxICsgc2VsZi5nZXRBYmlsaXR5QXR0cmlidXRlVmFsdWUoc2VsZi5fYWJpbGl0aWVzW2ldLmF0dHJpYnV0ZXMsIGF0dHJpYnV0ZS5uYW1lLCBhYmlsaXR5LmxldmVsKCkpLzEwMCk7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgICAgICAgICAgICAgICBicmVhaztcbiAgICAgICAgICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgIH1cbiAgICAgICAgfVxuICAgICAgICByZXR1cm4gdG90YWxBdHRyaWJ1dGU7XG4gICAgfSk7XG4gICAgXG4gICAgc2VsZi5nZXRCYXNlRGFtYWdlUmVkdWN0aW9uUGN0ID0ga28uY29tcHV0ZWQoZnVuY3Rpb24gKCkge1xuICAgICAgICB2YXIgdG90YWxBdHRyaWJ1dGUgPSAxO1xuICAgICAgICBmb3IgKHZhciBpID0gMDsgaSA8IHNlbGYuYWJpbGl0aWVzKCkubGVuZ3RoOyBpKyspIHtcbiAgICAgICAgICAgIHZhciBhYmlsaXR5ID0gc2VsZi5fYWJpbGl0aWVzW2ldO1xuICAgICAgICAgICAgaWYgKGFiaWxpdHkubGV2ZWwoKSA+IDAgJiYgKGFiaWxpdHkuaXNBY3RpdmUoKSB8fCAoYWJpbGl0eS5iZWhhdmlvci5pbmRleE9mKCdET1RBX0FCSUxJVFlfQkVIQVZJT1JfUEFTU0lWRScpICE9IC0xKSkpIHtcbiAgICAgICAgICAgICAgICBpZiAoIShhYmlsaXR5Lm5hbWUgaW4gc2VsZi5hYmlsaXR5RGF0YSkpIHtcbiAgICAgICAgICAgICAgICAgICAgZm9yICh2YXIgaiA9IDA7IGogPCBzZWxmLl9hYmlsaXRpZXNbaV0uYXR0cmlidXRlcy5sZW5ndGg7IGorKykge1xuICAgICAgICAgICAgICAgICAgICAgICAgdmFyIGF0dHJpYnV0ZSA9IHNlbGYuX2FiaWxpdGllc1tpXS5hdHRyaWJ1dGVzW2pdO1xuICAgICAgICAgICAgICAgICAgICAgICAgc3dpdGNoKGF0dHJpYnV0ZS5uYW1lKSB7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgLy8gdmVuZ2VmdWxzcGlyaXRfY29tbWFuZF9hdXJhXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgY2FzZSAnYm9udXNfZGFtYWdlX3BjdCc6XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIGlmIChhYmlsaXR5Lm5hbWUgPT0gJ3ZlbmdlZnVsc3Bpcml0X2NvbW1hbmRfYXVyYScpIHtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIHRvdGFsQXR0cmlidXRlICo9ICgxIC0gc2VsZi5nZXRBYmlsaXR5QXR0cmlidXRlVmFsdWUoc2VsZi5fYWJpbGl0aWVzW2ldLmF0dHJpYnV0ZXMsIGF0dHJpYnV0ZS5uYW1lLCBhYmlsaXR5LmxldmVsKCkpLzEwMCk7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgICAgICAgICAgICAgICBicmVhaztcbiAgICAgICAgICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgICBlbHNlIGlmIChhYmlsaXR5LmJhc2VEYW1hZ2VSZWR1Y3Rpb25QY3QgIT0gdW5kZWZpbmVkKSB7XG4gICAgICAgICAgICAgICAgICAgIC8vIG5ldmVybW9yZV9yZXF1aWVtXG4gICAgICAgICAgICAgICAgICAgIHRvdGFsQXR0cmlidXRlICo9ICgxICsgYWJpbGl0eS5iYXNlRGFtYWdlUmVkdWN0aW9uUGN0KCkvMTAwKTtcbiAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICB9XG4gICAgICAgIH1cbiAgICAgICAgcmV0dXJuIHRvdGFsQXR0cmlidXRlO1xuICAgIH0pO1xuICAgIFxuICAgIHNlbGYuZ2V0QkFUID0ga28uY29tcHV0ZWQoZnVuY3Rpb24gKCkge1xuICAgICAgICB2YXIgdG90YWxBdHRyaWJ1dGUgPSAwO1xuICAgICAgICBmb3IgKHZhciBpID0gMDsgaSA8IHNlbGYuYWJpbGl0aWVzKCkubGVuZ3RoOyBpKyspIHtcbiAgICAgICAgICAgIHZhciBhYmlsaXR5ID0gc2VsZi5fYWJpbGl0aWVzW2ldO1xuICAgICAgICAgICAgaWYgKGFiaWxpdHkubGV2ZWwoKSA+IDAgJiYgKGFiaWxpdHkuaXNBY3RpdmUoKSB8fCAoYWJpbGl0eS5iZWhhdmlvci5pbmRleE9mKCdET1RBX0FCSUxJVFlfQkVIQVZJT1JfUEFTU0lWRScpICE9IC0xKSkpIHtcbiAgICAgICAgICAgICAgICBpZiAoIShhYmlsaXR5Lm5hbWUgaW4gc2VsZi5hYmlsaXR5RGF0YSkpIHtcbiAgICAgICAgICAgICAgICAgICAgZm9yICh2YXIgaiA9IDA7IGogPCBzZWxmLl9hYmlsaXRpZXNbaV0uYXR0cmlidXRlcy5sZW5ndGg7IGorKykge1xuICAgICAgICAgICAgICAgICAgICAgICAgdmFyIGF0dHJpYnV0ZSA9IHNlbGYuX2FiaWxpdGllc1tpXS5hdHRyaWJ1dGVzW2pdO1xuICAgICAgICAgICAgICAgICAgICAgICAgc3dpdGNoKGF0dHJpYnV0ZS5uYW1lKSB7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgLy8gdHJvbGxfd2FybG9yZF9iZXJzZXJrZXJzX3JhZ2UsYWxjaGVtaXN0X2NoZW1pY2FsX3JhZ2UsbG9uZV9kcnVpZF90cnVlX2Zvcm0sbHljYW5fc2hhcGVzaGlmdFxuICAgICAgICAgICAgICAgICAgICAgICAgICAgIGNhc2UgJ2Jhc2VfYXR0YWNrX3RpbWUnOlxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICB0b3RhbEF0dHJpYnV0ZSArPSBzZWxmLmdldEFiaWxpdHlBdHRyaWJ1dGVWYWx1ZShzZWxmLl9hYmlsaXRpZXNbaV0uYXR0cmlidXRlcywgYXR0cmlidXRlLm5hbWUsIGFiaWxpdHkubGV2ZWwoKSk7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgYnJlYWs7XG4gICAgICAgICAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICB9XG4gICAgICAgIH1cbiAgICAgICAgcmV0dXJuIHRvdGFsQXR0cmlidXRlO1xuICAgIH0pO1xuICAgIHNlbGYuZ2V0Qm9udXNEYW1hZ2UgPSBrby5jb21wdXRlZChmdW5jdGlvbiAoKSB7XG4gICAgICAgIHZhciB0b3RhbEF0dHJpYnV0ZSA9IDA7XG4gICAgICAgIHZhciBzb3VyY2VzID0ge307XG4gICAgICAgIGZvciAodmFyIGkgPSAwOyBpIDwgc2VsZi5hYmlsaXRpZXMoKS5sZW5ndGg7IGkrKykge1xuICAgICAgICAgICAgdmFyIGFiaWxpdHkgPSBzZWxmLl9hYmlsaXRpZXNbaV07XG4gICAgICAgICAgICBpZiAoYWJpbGl0eS5sZXZlbCgpID4gMCAmJiAoYWJpbGl0eS5pc0FjdGl2ZSgpIHx8IChhYmlsaXR5LmJlaGF2aW9yLmluZGV4T2YoJ0RPVEFfQUJJTElUWV9CRUhBVklPUl9QQVNTSVZFJykgIT0gLTEpKSkge1xuICAgICAgICAgICAgICAgIGlmICghKGFiaWxpdHkubmFtZSBpbiBzZWxmLmFiaWxpdHlEYXRhKSkge1xuICAgICAgICAgICAgICAgICAgICBmb3IgKHZhciBqID0gMDsgaiA8IHNlbGYuX2FiaWxpdGllc1tpXS5hdHRyaWJ1dGVzLmxlbmd0aDsgaisrKSB7XG4gICAgICAgICAgICAgICAgICAgICAgICB2YXIgYXR0cmlidXRlID0gc2VsZi5fYWJpbGl0aWVzW2ldLmF0dHJpYnV0ZXNbal07XG4gICAgICAgICAgICAgICAgICAgICAgICBzd2l0Y2goYXR0cmlidXRlLm5hbWUpIHtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAvLyBicm9vZG1vdGhlcl9pbnNhdGlhYmxlX2h1bmdlcixsdW5hX2x1bmFyX2JsZXNzaW5nLHRlbXBsYXJfYXNzYXNzaW5fcmVmcmFjdGlvbix0ZW1wbGFyX2Fzc2Fzc2luX21lbGQsdHJvbGxfd2FybG9yZF9iZXJzZXJrZXJzX3JhZ2UsbG9uZV9kcnVpZF90cnVlX2Zvcm1fYmF0dGxlX2NyeVxuICAgICAgICAgICAgICAgICAgICAgICAgICAgIGNhc2UgJ2JvbnVzX2RhbWFnZSc6XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIGlmIChhYmlsaXR5Lm5hbWUgPT0gJ2Jyb29kbW90aGVyX2luc2F0aWFibGVfaHVuZ2VyJyB8fCBhYmlsaXR5Lm5hbWUgPT0gJ2x1bmFfbHVuYXJfYmxlc3NpbmcnXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICB8fCBhYmlsaXR5Lm5hbWUgPT0gJ3RlbXBsYXJfYXNzYXNzaW5fcmVmcmFjdGlvbicgfHwgYWJpbGl0eS5uYW1lID09ICd0ZW1wbGFyX2Fzc2Fzc2luX21lbGQnXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICB8fCBhYmlsaXR5Lm5hbWUgPT0gJ3Ryb2xsX3dhcmxvcmRfYmVyc2Vya2Vyc19yYWdlJyB8fCBhYmlsaXR5Lm5hbWUgPT0gJ2xvbmVfZHJ1aWRfdHJ1ZV9mb3JtX2JhdHRsZV9jcnknKSB7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICB0b3RhbEF0dHJpYnV0ZSArPSBzZWxmLmdldEFiaWxpdHlBdHRyaWJ1dGVWYWx1ZShzZWxmLl9hYmlsaXRpZXNbaV0uYXR0cmlidXRlcywgYXR0cmlidXRlLm5hbWUsIGFiaWxpdHkubGV2ZWwoKSk7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBzb3VyY2VzW2FiaWxpdHkubmFtZV0gPSB7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgJ2RhbWFnZSc6IHNlbGYuZ2V0QWJpbGl0eUF0dHJpYnV0ZVZhbHVlKHNlbGYuX2FiaWxpdGllc1tpXS5hdHRyaWJ1dGVzLCBhdHRyaWJ1dGUubmFtZSwgYWJpbGl0eS5sZXZlbCgpKSxcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAnZGFtYWdlVHlwZSc6ICdwaHlzaWNhbCcsXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgJ2Rpc3BsYXluYW1lJzogYWJpbGl0eS5kaXNwbGF5bmFtZVxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgYnJlYWs7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgLy8gbHljYW5faG93bFxuICAgICAgICAgICAgICAgICAgICAgICAgICAgIGNhc2UgJ2hlcm9fYm9udXNfZGFtYWdlJzpcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgdG90YWxBdHRyaWJ1dGUgKz0gc2VsZi5nZXRBYmlsaXR5QXR0cmlidXRlVmFsdWUoc2VsZi5fYWJpbGl0aWVzW2ldLmF0dHJpYnV0ZXMsIGF0dHJpYnV0ZS5uYW1lLCBhYmlsaXR5LmxldmVsKCkpO1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBzb3VyY2VzW2FiaWxpdHkubmFtZV0gPSB7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAnZGFtYWdlJzogc2VsZi5nZXRBYmlsaXR5QXR0cmlidXRlVmFsdWUoc2VsZi5fYWJpbGl0aWVzW2ldLmF0dHJpYnV0ZXMsIGF0dHJpYnV0ZS5uYW1lLCBhYmlsaXR5LmxldmVsKCkpLFxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgJ2RhbWFnZVR5cGUnOiAncGh5c2ljYWwnLFxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgJ2Rpc3BsYXluYW1lJzogYWJpbGl0eS5kaXNwbGF5bmFtZVxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgYnJlYWs7XG4gICAgICAgICAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgICAgICAgaWYgKGFiaWxpdHkubmFtZSA9PSAnc3Rvcm1fc3Bpcml0X292ZXJsb2FkJykge1xuICAgICAgICAgICAgICAgICAgICAgICAgdG90YWxBdHRyaWJ1dGUgKz0gc2VsZi5nZXRBYmlsaXR5UHJvcGVydHlWYWx1ZShhYmlsaXR5LCAnZGFtYWdlJyk7XG4gICAgICAgICAgICAgICAgICAgICAgICBzb3VyY2VzW2FiaWxpdHkubmFtZV0gPSB7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgJ2RhbWFnZSc6IHNlbGYuZ2V0QWJpbGl0eVByb3BlcnR5VmFsdWUoYWJpbGl0eSwgJ2RhbWFnZScpLFxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICdkYW1hZ2VUeXBlJzogJ21hZ2ljJyxcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAnZGlzcGxheW5hbWUnOiBhYmlsaXR5LmRpc3BsYXluYW1lXG4gICAgICAgICAgICAgICAgICAgICAgICB9ICAgICAgICAgICAgICAgICAgICAgICAgXG4gICAgICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgICAgZWxzZSBpZiAoYWJpbGl0eS5ib251c0RhbWFnZSAhPSB1bmRlZmluZWQgJiYgYWJpbGl0eS5ib251c0RhbWFnZSgpICE9IDApIHtcbiAgICAgICAgICAgICAgICAgICAgLy8gbmV2ZXJtb3JlX25lY3JvbWFzdGVyeSx1cnNhX2Z1cnlfc3dpcGVzLHVyc2FfZW5yYWdlLGludm9rZXJfYWxhY3JpdHksaW52b2tlcl9leG9ydCxlbGRlcl90aXRhbl9hbmNlc3RyYWxfc3Bpcml0LHNwZWN0cmVfZGVzb2xhdGUscmF6b3Jfc3RhdGljX2xpbmtcbiAgICAgICAgICAgICAgICAgICAgdG90YWxBdHRyaWJ1dGUrPWFiaWxpdHkuYm9udXNEYW1hZ2UoKTtcbiAgICAgICAgICAgICAgICAgICAgc291cmNlc1thYmlsaXR5Lm5hbWVdID0ge1xuICAgICAgICAgICAgICAgICAgICAgICAgJ2RhbWFnZSc6IGFiaWxpdHkuYm9udXNEYW1hZ2UoKSxcbiAgICAgICAgICAgICAgICAgICAgICAgICdkYW1hZ2VUeXBlJzogYWJpbGl0eS5uYW1lID09ICdzcGVjdHJlX2Rlc29sYXRlJyA/ICdwdXJlJyA6ICdwaHlzaWNhbCcsXG4gICAgICAgICAgICAgICAgICAgICAgICAnZGlzcGxheW5hbWUnOiBhYmlsaXR5LmRpc3BsYXluYW1lXG4gICAgICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICB9XG4gICAgICAgIH1cbiAgICAgICAgcmV0dXJuIHsgc291cmNlczogc291cmNlcywgdG90YWw6IHRvdGFsQXR0cmlidXRlIH07XG4gICAgfSk7XG5cbiAgICBzZWxmLmdldEJvbnVzRGFtYWdlUGVyY2VudCA9IGtvLmNvbXB1dGVkKGZ1bmN0aW9uICgpIHtcbiAgICAgICAgdmFyIHRvdGFsQXR0cmlidXRlID0gMDtcbiAgICAgICAgdmFyIHNvdXJjZXMgPSB7fTtcbiAgICAgICAgZm9yICh2YXIgaSA9IDA7IGkgPCBzZWxmLmFiaWxpdGllcygpLmxlbmd0aDsgaSsrKSB7XG4gICAgICAgICAgICB2YXIgYWJpbGl0eSA9IHNlbGYuX2FiaWxpdGllc1tpXTtcbiAgICAgICAgICAgIGlmIChhYmlsaXR5LmxldmVsKCkgPiAwICYmIChhYmlsaXR5LmlzQWN0aXZlKCkgfHwgKGFiaWxpdHkuYmVoYXZpb3IuaW5kZXhPZignRE9UQV9BQklMSVRZX0JFSEFWSU9SX1BBU1NJVkUnKSAhPSAtMSkpKSB7XG4gICAgICAgICAgICAgICAgaWYgKCEoYWJpbGl0eS5uYW1lIGluIHNlbGYuYWJpbGl0eURhdGEpKSB7XG4gICAgICAgICAgICAgICAgICAgIGZvciAodmFyIGogPSAwOyBqIDwgc2VsZi5fYWJpbGl0aWVzW2ldLmF0dHJpYnV0ZXMubGVuZ3RoOyBqKyspIHtcbiAgICAgICAgICAgICAgICAgICAgICAgIHZhciBhdHRyaWJ1dGUgPSBzZWxmLl9hYmlsaXRpZXNbaV0uYXR0cmlidXRlc1tqXTtcbiAgICAgICAgICAgICAgICAgICAgICAgIHN3aXRjaChhdHRyaWJ1dGUubmFtZSkge1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgIC8vIGJsb29kc2Vla2VyX2Jsb29kcmFnZVxuICAgICAgICAgICAgICAgICAgICAgICAgICAgIGNhc2UgJ2RhbWFnZV9pbmNyZWFzZV9wY3QnOlxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBpZiAoYWJpbGl0eS5uYW1lID09ICdibG9vZHNlZWtlcl9ibG9vZHJhZ2UnKSB7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICB0b3RhbEF0dHJpYnV0ZSArPSBzZWxmLmdldEFiaWxpdHlBdHRyaWJ1dGVWYWx1ZShzZWxmLl9hYmlsaXRpZXNbaV0uYXR0cmlidXRlcywgYXR0cmlidXRlLm5hbWUsIGFiaWxpdHkubGV2ZWwoKSkvMTAwO1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgc291cmNlc1thYmlsaXR5Lm5hbWVdID0ge1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICdkYW1hZ2UnOiBzZWxmLmdldEFiaWxpdHlBdHRyaWJ1dGVWYWx1ZShzZWxmLl9hYmlsaXRpZXNbaV0uYXR0cmlidXRlcywgYXR0cmlidXRlLm5hbWUsIGFiaWxpdHkubGV2ZWwoKSkvMTAwLFxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICdkYW1hZ2VUeXBlJzogJ3BoeXNpY2FsJyxcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAnZGlzcGxheW5hbWUnOiBhYmlsaXR5LmRpc3BsYXluYW1lXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgICAgICAgICAgICAgICBicmVhaztcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAvLyBtYWduYXRhdXJfZW1wb3dlcix2ZW5nZWZ1bHNwaXJpdF9jb21tYW5kX2F1cmEsYWxwaGFfd29sZl9jb21tYW5kX2F1cmFcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICBjYXNlICdib251c19kYW1hZ2VfcGN0JzpcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgaWYgKGFiaWxpdHkubmFtZSA9PSAnbWFnbmF0YXVyX2VtcG93ZXInIHx8IGFiaWxpdHkubmFtZSA9PSAndmVuZ2VmdWxzcGlyaXRfY29tbWFuZF9hdXJhJyB8fCBhYmlsaXR5Lm5hbWUgPT0gJ2FscGhhX3dvbGZfY29tbWFuZF9hdXJhJykge1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgdG90YWxBdHRyaWJ1dGUgKz0gc2VsZi5nZXRBYmlsaXR5QXR0cmlidXRlVmFsdWUoc2VsZi5fYWJpbGl0aWVzW2ldLmF0dHJpYnV0ZXMsIGF0dHJpYnV0ZS5uYW1lLCBhYmlsaXR5LmxldmVsKCkpLzEwMDtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIHNvdXJjZXNbYWJpbGl0eS5uYW1lXSA9IHtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAnZGFtYWdlJzogc2VsZi5nZXRBYmlsaXR5QXR0cmlidXRlVmFsdWUoc2VsZi5fYWJpbGl0aWVzW2ldLmF0dHJpYnV0ZXMsIGF0dHJpYnV0ZS5uYW1lLCBhYmlsaXR5LmxldmVsKCkpLzEwMCxcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAnZGFtYWdlVHlwZSc6ICdwaHlzaWNhbCcsXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgJ2Rpc3BsYXluYW1lJzogYWJpbGl0eS5kaXNwbGF5bmFtZVxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgYnJlYWs7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgLy8gc3Zlbl9nb2RzX3N0cmVuZ3RoXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgY2FzZSAnZ29kc19zdHJlbmd0aF9kYW1hZ2UnOlxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBpZiAoYWJpbGl0eS5uYW1lID09ICdzdmVuX2dvZHNfc3RyZW5ndGgnICYmIHNlbGYuaGVybyAhPSB1bmRlZmluZWQgJiYgc2VsZi5oZXJvLmhlcm9JZCgpID09ICdzdmVuJykge1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgdG90YWxBdHRyaWJ1dGUgKz0gc2VsZi5nZXRBYmlsaXR5QXR0cmlidXRlVmFsdWUoc2VsZi5fYWJpbGl0aWVzW2ldLmF0dHJpYnV0ZXMsIGF0dHJpYnV0ZS5uYW1lLCBhYmlsaXR5LmxldmVsKCkpLzEwMDtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIHNvdXJjZXNbYWJpbGl0eS5uYW1lXSA9IHtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAnZGFtYWdlJzogc2VsZi5nZXRBYmlsaXR5QXR0cmlidXRlVmFsdWUoc2VsZi5fYWJpbGl0aWVzW2ldLmF0dHJpYnV0ZXMsIGF0dHJpYnV0ZS5uYW1lLCBhYmlsaXR5LmxldmVsKCkpLzEwMCxcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAnZGFtYWdlVHlwZSc6ICdwaHlzaWNhbCcsXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgJ2Rpc3BsYXluYW1lJzogYWJpbGl0eS5kaXNwbGF5bmFtZVxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgYnJlYWs7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgY2FzZSAnZ29kc19zdHJlbmd0aF9kYW1hZ2Vfc2NlcHRlcic6XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIGlmIChhYmlsaXR5Lm5hbWUgPT0gJ3N2ZW5fZ29kc19zdHJlbmd0aCcgJiYgc2VsZi5oZXJvID09IHVuZGVmaW5lZCkge1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgdG90YWxBdHRyaWJ1dGUgKz0gc2VsZi5nZXRBYmlsaXR5QXR0cmlidXRlVmFsdWUoc2VsZi5fYWJpbGl0aWVzW2ldLmF0dHJpYnV0ZXMsIGF0dHJpYnV0ZS5uYW1lLCBhYmlsaXR5LmxldmVsKCkpLzEwMDtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIHNvdXJjZXNbYWJpbGl0eS5uYW1lXSA9IHtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAnZGFtYWdlJzogc2VsZi5nZXRBYmlsaXR5QXR0cmlidXRlVmFsdWUoc2VsZi5fYWJpbGl0aWVzW2ldLmF0dHJpYnV0ZXMsIGF0dHJpYnV0ZS5uYW1lLCBhYmlsaXR5LmxldmVsKCkpLzEwMCxcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAnZGFtYWdlVHlwZSc6ICdwaHlzaWNhbCcsXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgJ2Rpc3BsYXluYW1lJzogYWJpbGl0eS5kaXNwbGF5bmFtZVxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgYnJlYWs7XG4gICAgICAgICAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgICAgLyplbHNlIGlmIChhYmlsaXR5LmJvbnVzRGFtYWdlUGN0ICE9IHVuZGVmaW5lZCAmJiBhYmlsaXR5LmJvbnVzRGFtYWdlUGN0KCkgIT0gMCkge1xuICAgICAgICAgICAgICAgICAgICAvLyBibG9vZHNlZWtlcl9ibG9vZHJhZ2VcbiAgICAgICAgICAgICAgICAgICAgLy8gdG90YWxBdHRyaWJ1dGUrPWFiaWxpdHkuYm9udXNEYW1hZ2VQY3QoKS8xMDA7XG4gICAgICAgICAgICAgICAgICAgIC8vIHNvdXJjZXNbYWJpbGl0eS5uYW1lXSA9IHtcbiAgICAgICAgICAgICAgICAgICAgICAgIC8vICdkYW1hZ2UnOiBhYmlsaXR5LmJvbnVzRGFtYWdlUGN0KCkvMTAwLFxuICAgICAgICAgICAgICAgICAgICAgICAgLy8gJ2RhbWFnZVR5cGUnOiAncGh5c2ljYWwnLFxuICAgICAgICAgICAgICAgICAgICAgICAgLy8gJ2Rpc3BsYXluYW1lJzogYWJpbGl0eS5kaXNwbGF5bmFtZVxuICAgICAgICAgICAgICAgICAgICAvLyB9XG4gICAgICAgICAgICAgICAgfSovXG4gICAgICAgICAgICB9XG4gICAgICAgIH1cbiAgICAgICAgcmV0dXJuIHsgc291cmNlczogc291cmNlcywgdG90YWw6IHRvdGFsQXR0cmlidXRlIH07XG4gICAgfSk7XG5cbiAgICBzZWxmLmdldEJvbnVzRGFtYWdlQmFja3N0YWIgPSBrby5jb21wdXRlZChmdW5jdGlvbiAoKSB7XG4gICAgICAgIHZhciB0b3RhbEF0dHJpYnV0ZTEgPSAwO1xuICAgICAgICB2YXIgdG90YWxBdHRyaWJ1dGUyID0gMDtcbiAgICAgICAgdmFyIHNvdXJjZXMgPSBbXTtcbiAgICAgICAgZm9yICh2YXIgaSA9IDA7IGkgPCBzZWxmLmFiaWxpdGllcygpLmxlbmd0aDsgaSsrKSB7XG4gICAgICAgICAgICB2YXIgYWJpbGl0eSA9IHNlbGYuX2FiaWxpdGllc1tpXTtcbiAgICAgICAgICAgIGlmIChhYmlsaXR5Lm5hbWUgPT0gJ3Jpa2lfYmFja3N0YWInKSB7XG4gICAgICAgICAgICAgICAgaWYgKGFiaWxpdHkubGV2ZWwoKSA+IDAgJiYgKGFiaWxpdHkuaXNBY3RpdmUoKSB8fCAoYWJpbGl0eS5iZWhhdmlvci5pbmRleE9mKCdET1RBX0FCSUxJVFlfQkVIQVZJT1JfUEFTU0lWRScpICE9IC0xKSkpIHtcbiAgICAgICAgICAgICAgICAgICAgZm9yICh2YXIgaiA9IDA7IGogPCBzZWxmLl9hYmlsaXRpZXNbaV0uYXR0cmlidXRlcy5sZW5ndGg7IGorKykge1xuICAgICAgICAgICAgICAgICAgICAgICAgdmFyIGF0dHJpYnV0ZSA9IHNlbGYuX2FiaWxpdGllc1tpXS5hdHRyaWJ1dGVzW2pdO1xuICAgICAgICAgICAgICAgICAgICAgICAgc3dpdGNoKGF0dHJpYnV0ZS5uYW1lKSB7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgLy8gcmlraV9iYWNrc3RhYlxuICAgICAgICAgICAgICAgICAgICAgICAgICAgIGNhc2UgJ2RhbWFnZV9tdWx0aXBsaWVyJzpcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgdG90YWxBdHRyaWJ1dGUxICs9IHNlbGYuZ2V0QWJpbGl0eUF0dHJpYnV0ZVZhbHVlKHNlbGYuX2FiaWxpdGllc1tpXS5hdHRyaWJ1dGVzLCBhdHRyaWJ1dGUubmFtZSwgYWJpbGl0eS5sZXZlbCgpKTtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgc291cmNlcy5wdXNoKHtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICdkYW1hZ2UnOiBzZWxmLmdldEFiaWxpdHlBdHRyaWJ1dGVWYWx1ZShzZWxmLl9hYmlsaXRpZXNbaV0uYXR0cmlidXRlcywgYXR0cmlidXRlLm5hbWUsIGFiaWxpdHkubGV2ZWwoKSksXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAnZGFtYWdlVHlwZSc6ICdwaHlzaWNhbCcsXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAnZGlzcGxheW5hbWUnOiBhYmlsaXR5LmRpc3BsYXluYW1lXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIH0pO1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgIGJyZWFrO1xuICAgICAgICAgICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICAgICAgICB9LypcbiAgICAgICAgICAgICAgICAgICAgaWYgKGFiaWxpdHkuYm9udXNEYW1hZ2VCYWNrc3RhYiAhPSB1bmRlZmluZWQpIHtcbiAgICAgICAgICAgICAgICAgICAgICAgIGNvbnNvbGUubG9nKCdib251c0RhbWFnZUJhY2tzdGFiJyk7XG4gICAgICAgICAgICAgICAgICAgICAgICAvLyBkYW1hZ2VfbXVsdGlwbGllclxuICAgICAgICAgICAgICAgICAgICAgICAgdG90YWxBdHRyaWJ1dGUyKz1hYmlsaXR5LmJvbnVzRGFtYWdlQmFja3N0YWIoKTtcbiAgICAgICAgICAgICAgICAgICAgICAgIHNvdXJjZXMucHVzaCh7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgJ2RhbWFnZSc6IGFiaWxpdHkuYm9udXNEYW1hZ2VCYWNrc3RhYigpLFxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICdkYW1hZ2VUeXBlJzogJ3BoeXNpY2FsJyxcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAnZGlzcGxheW5hbWUnOiBhYmlsaXR5LmRpc3BsYXluYW1lXG4gICAgICAgICAgICAgICAgICAgICAgICB9KTtcbiAgICAgICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICAgICAgICAqL1xuICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgIH1cbiAgICAgICAgfVxuICAgICAgICByZXR1cm4geyBzb3VyY2VzOiBzb3VyY2VzLCB0b3RhbDogW3RvdGFsQXR0cmlidXRlMSx0b3RhbEF0dHJpYnV0ZTJdIH07XG4gICAgfSk7XG4gICAgXG4gICAgc2VsZi5nZXRCb251c0RhbWFnZVByZWNpc2lvbkF1cmEgPSBrby5jb21wdXRlZChmdW5jdGlvbiAoKSB7XG4gICAgICAgIHZhciB0b3RhbEF0dHJpYnV0ZTEgPSAwO1xuICAgICAgICB2YXIgdG90YWxBdHRyaWJ1dGUyID0gMDtcbiAgICAgICAgdmFyIHNvdXJjZXMgPSBbXTtcbiAgICAgICAgZm9yICh2YXIgaSA9IDA7IGkgPCBzZWxmLmFiaWxpdGllcygpLmxlbmd0aDsgaSsrKSB7XG4gICAgICAgICAgICB2YXIgYWJpbGl0eSA9IHNlbGYuX2FiaWxpdGllc1tpXTtcbiAgICAgICAgICAgIGlmIChhYmlsaXR5Lm5hbWUgPT0gJ2Ryb3dfcmFuZ2VyX3RydWVzaG90Jykge1xuICAgICAgICAgICAgICAgIGlmIChhYmlsaXR5LmxldmVsKCkgPiAwICYmIChhYmlsaXR5LmlzQWN0aXZlKCkgfHwgKGFiaWxpdHkuYmVoYXZpb3IuaW5kZXhPZignRE9UQV9BQklMSVRZX0JFSEFWSU9SX1BBU1NJVkUnKSAhPSAtMSkpKSB7XG4gICAgICAgICAgICAgICAgICAgIGZvciAodmFyIGogPSAwOyBqIDwgc2VsZi5fYWJpbGl0aWVzW2ldLmF0dHJpYnV0ZXMubGVuZ3RoOyBqKyspIHtcbiAgICAgICAgICAgICAgICAgICAgICAgIHZhciBhdHRyaWJ1dGUgPSBzZWxmLl9hYmlsaXRpZXNbaV0uYXR0cmlidXRlc1tqXTtcbiAgICAgICAgICAgICAgICAgICAgICAgIHN3aXRjaChhdHRyaWJ1dGUubmFtZSkge1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgIC8vIGRyb3dfcmFuZ2VyX3RydWVzaG90XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgY2FzZSAndHJ1ZXNob3RfcmFuZ2VkX2RhbWFnZSc6XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIHRvdGFsQXR0cmlidXRlMSArPSBzZWxmLmdldEFiaWxpdHlBdHRyaWJ1dGVWYWx1ZShzZWxmLl9hYmlsaXRpZXNbaV0uYXR0cmlidXRlcywgYXR0cmlidXRlLm5hbWUsIGFiaWxpdHkubGV2ZWwoKSkvMTAwO1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBzb3VyY2VzLnB1c2goe1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgJ2RhbWFnZSc6IHNlbGYuZ2V0QWJpbGl0eUF0dHJpYnV0ZVZhbHVlKHNlbGYuX2FiaWxpdGllc1tpXS5hdHRyaWJ1dGVzLCBhdHRyaWJ1dGUubmFtZSwgYWJpbGl0eS5sZXZlbCgpKS8xMDAsXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAnZGFtYWdlVHlwZSc6ICdwaHlzaWNhbCcsXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAnZGlzcGxheW5hbWUnOiBhYmlsaXR5LmRpc3BsYXluYW1lXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIH0pO1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgIGJyZWFrO1xuICAgICAgICAgICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgICAgICAgIGlmIChhYmlsaXR5LmJvbnVzRGFtYWdlUHJlY2lzaW9uQXVyYSAhPSB1bmRlZmluZWQpIHtcbiAgICAgICAgICAgICAgICAgICAgICAgIC8vIGRyb3dfcmFuZ2VyX3RydWVzaG90XG4gICAgICAgICAgICAgICAgICAgICAgICB0b3RhbEF0dHJpYnV0ZTIrPWFiaWxpdHkuYm9udXNEYW1hZ2VQcmVjaXNpb25BdXJhKCk7XG4gICAgICAgICAgICAgICAgICAgICAgICBzb3VyY2VzLnB1c2goe1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgICdkYW1hZ2UnOiBhYmlsaXR5LmJvbnVzRGFtYWdlUHJlY2lzaW9uQXVyYSgpLFxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICdkYW1hZ2VUeXBlJzogJ3BoeXNpY2FsJyxcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAnZGlzcGxheW5hbWUnOiBhYmlsaXR5LmRpc3BsYXluYW1lXG4gICAgICAgICAgICAgICAgICAgICAgICB9KTtcbiAgICAgICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgIH1cbiAgICAgICAgfVxuICAgICAgICByZXR1cm4geyBzb3VyY2VzOiBzb3VyY2VzLCB0b3RhbDogW3RvdGFsQXR0cmlidXRlMSx0b3RhbEF0dHJpYnV0ZTJdIH07XG4gICAgfSk7XG4gICAgXG4gICAgc2VsZi5nZXRCb251c0RhbWFnZVJlZHVjdGlvbiA9IGtvLmNvbXB1dGVkKGZ1bmN0aW9uICgpIHtcbiAgICAgICAgdmFyIHRvdGFsQXR0cmlidXRlID0gMDtcbiAgICAgICAgZm9yICh2YXIgaSA9IDA7IGkgPCBzZWxmLmFiaWxpdGllcygpLmxlbmd0aDsgaSsrKSB7XG4gICAgICAgICAgICB2YXIgYWJpbGl0eSA9IHNlbGYuX2FiaWxpdGllc1tpXTtcbiAgICAgICAgICAgIGlmIChhYmlsaXR5LmxldmVsKCkgPiAwICYmIChhYmlsaXR5LmlzQWN0aXZlKCkgfHwgKGFiaWxpdHkuYmVoYXZpb3IuaW5kZXhPZignRE9UQV9BQklMSVRZX0JFSEFWSU9SX1BBU1NJVkUnKSAhPSAtMSkpKSB7XG4gICAgICAgICAgICAgICAgaWYgKCEoYWJpbGl0eS5uYW1lIGluIHNlbGYuYWJpbGl0eURhdGEpKSB7XG4gICAgICAgICAgICAgICAgICAgIGZvciAodmFyIGogPSAwOyBqIDwgc2VsZi5fYWJpbGl0aWVzW2ldLmF0dHJpYnV0ZXMubGVuZ3RoOyBqKyspIHtcbiAgICAgICAgICAgICAgICAgICAgICAgIHZhciBhdHRyaWJ1dGUgPSBzZWxmLl9hYmlsaXRpZXNbaV0uYXR0cmlidXRlc1tqXTtcbiAgICAgICAgICAgICAgICAgICAgICAgIHN3aXRjaChhdHRyaWJ1dGUubmFtZSkge1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgIC8vIGJhbmVfZW5mZWVibGVcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICBjYXNlICdlbmZlZWJsZV9hdHRhY2tfcmVkdWN0aW9uJzpcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgdG90YWxBdHRyaWJ1dGUgKz0gc2VsZi5nZXRBYmlsaXR5QXR0cmlidXRlVmFsdWUoc2VsZi5fYWJpbGl0aWVzW2ldLmF0dHJpYnV0ZXMsIGF0dHJpYnV0ZS5uYW1lLCBhYmlsaXR5LmxldmVsKCkpO1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgIGJyZWFrO1xuICAgICAgICAgICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICAgIGVsc2UgaWYgKGFiaWxpdHkuYm9udXNEYW1hZ2VSZWR1Y3Rpb24gIT0gdW5kZWZpbmVkKSB7XG4gICAgICAgICAgICAgICAgICAgIC8vIHJ1Ymlja19mYWRlX2JvbHQscmF6b3Jfc3RhdGljX2xpbmtcbiAgICAgICAgICAgICAgICAgICAgdG90YWxBdHRyaWJ1dGUrPWFiaWxpdHkuYm9udXNEYW1hZ2VSZWR1Y3Rpb24oKTtcbiAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICB9XG4gICAgICAgIH1cbiAgICAgICAgcmV0dXJuIHRvdGFsQXR0cmlidXRlO1xuICAgIH0pO1xuICAgIFxuICAgIHNlbGYuZ2V0Qm9udXNEYW1hZ2VSZWR1Y3Rpb25QY3QgPSBrby5jb21wdXRlZChmdW5jdGlvbiAoKSB7XG4gICAgICAgIHZhciB0b3RhbEF0dHJpYnV0ZSA9IDE7XG4gICAgICAgIGZvciAodmFyIGkgPSAwOyBpIDwgc2VsZi5hYmlsaXRpZXMoKS5sZW5ndGg7IGkrKykge1xuICAgICAgICAgICAgdmFyIGFiaWxpdHkgPSBzZWxmLl9hYmlsaXRpZXNbaV07XG4gICAgICAgICAgICBpZiAoYWJpbGl0eS5sZXZlbCgpID4gMCAmJiAoYWJpbGl0eS5pc0FjdGl2ZSgpIHx8IChhYmlsaXR5LmJlaGF2aW9yLmluZGV4T2YoJ0RPVEFfQUJJTElUWV9CRUhBVklPUl9QQVNTSVZFJykgIT0gLTEpKSkge1xuICAgICAgICAgICAgICAgIGlmICghKGFiaWxpdHkubmFtZSBpbiBzZWxmLmFiaWxpdHlEYXRhKSkge1xuICAgICAgICAgICAgICAgICAgICBmb3IgKHZhciBqID0gMDsgaiA8IHNlbGYuX2FiaWxpdGllc1tpXS5hdHRyaWJ1dGVzLmxlbmd0aDsgaisrKSB7XG4gICAgICAgICAgICAgICAgICAgICAgICB2YXIgYXR0cmlidXRlID0gc2VsZi5fYWJpbGl0aWVzW2ldLmF0dHJpYnV0ZXNbal07XG4gICAgICAgICAgICAgICAgICAgICAgICBzd2l0Y2goYXR0cmlidXRlLm5hbWUpIHtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAvLyBtZWR1c2Ffc3BsaXRfc2hvdFxuICAgICAgICAgICAgICAgICAgICAgICAgICAgIGNhc2UgJ2RhbWFnZV9tb2RpZmllcic6XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIHRvdGFsQXR0cmlidXRlICo9ICgxICsgc2VsZi5nZXRBYmlsaXR5QXR0cmlidXRlVmFsdWUoc2VsZi5fYWJpbGl0aWVzW2ldLmF0dHJpYnV0ZXMsIGF0dHJpYnV0ZS5uYW1lLCBhYmlsaXR5LmxldmVsKCkpLzEwMCk7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgYnJlYWs7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgLy8gd2luZHJ1bm5lcl9mb2N1c2ZpcmVcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICBjYXNlICdmb2N1c2ZpcmVfZGFtYWdlX3JlZHVjdGlvbic6XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIGlmICghc2VsZi5oYXNTY2VwdGVyKCkpIHtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIHRvdGFsQXR0cmlidXRlICo9ICgxICsgc2VsZi5nZXRBYmlsaXR5QXR0cmlidXRlVmFsdWUoc2VsZi5fYWJpbGl0aWVzW2ldLmF0dHJpYnV0ZXMsIGF0dHJpYnV0ZS5uYW1lLCBhYmlsaXR5LmxldmVsKCkpLzEwMCk7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgICAgICAgICAgICAgICBicmVhaztcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICBjYXNlICdmb2N1c2ZpcmVfZGFtYWdlX3JlZHVjdGlvbl9zY2VwdGVyJzpcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgaWYgKHNlbGYuaGFzU2NlcHRlcigpKSB7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICB0b3RhbEF0dHJpYnV0ZSAqPSAoMSArIHNlbGYuZ2V0QWJpbGl0eUF0dHJpYnV0ZVZhbHVlKHNlbGYuX2FiaWxpdGllc1tpXS5hdHRyaWJ1dGVzLCBhdHRyaWJ1dGUubmFtZSwgYWJpbGl0eS5sZXZlbCgpKS8xMDApO1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgYnJlYWs7XG4gICAgICAgICAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICB9XG4gICAgICAgIH1cbiAgICAgICAgcmV0dXJuIHRvdGFsQXR0cmlidXRlO1xuICAgIH0pO1xuXG4gICAgc2VsZi5nZXREYW1hZ2VBbXBsaWZpY2F0aW9uID0ga28uY29tcHV0ZWQoZnVuY3Rpb24gKCkge1xuICAgICAgICB2YXIgdG90YWxBdHRyaWJ1dGUgPSAxO1xuICAgICAgICBmb3IgKHZhciBpID0gMDsgaSA8IHNlbGYuYWJpbGl0aWVzKCkubGVuZ3RoOyBpKyspIHtcbiAgICAgICAgICAgIHZhciBhYmlsaXR5ID0gc2VsZi5fYWJpbGl0aWVzW2ldO1xuICAgICAgICAgICAgaWYgKGFiaWxpdHkubGV2ZWwoKSA+IDAgJiYgKGFiaWxpdHkuaXNBY3RpdmUoKSB8fCAoYWJpbGl0eS5iZWhhdmlvci5pbmRleE9mKCdET1RBX0FCSUxJVFlfQkVIQVZJT1JfUEFTU0lWRScpICE9IC0xKSkpIHtcbiAgICAgICAgICAgICAgICAvKmlmICghKGFiaWxpdHkubmFtZSBpbiBzZWxmLmFiaWxpdHlEYXRhKSkge1xuICAgICAgICAgICAgICAgICAgICBpZiAoYWJpbGl0eS5sZXZlbCgpID4gMCAmJiAoYWJpbGl0eS5pc0FjdGl2ZSgpIHx8IChhYmlsaXR5LmJlaGF2aW9yLmluZGV4T2YoJ0RPVEFfQUJJTElUWV9CRUhBVklPUl9QQVNTSVZFJykgIT0gLTEpKSkge1xuICAgICAgICAgICAgICAgICAgICAgICAgZm9yICh2YXIgaiA9IDA7IGogPCBzZWxmLl9hYmlsaXRpZXNbaV0uYXR0cmlidXRlcy5sZW5ndGg7IGorKykge1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgIHZhciBhdHRyaWJ1dGUgPSBzZWxmLl9hYmlsaXRpZXNbaV0uYXR0cmlidXRlc1tqXTtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICBzd2l0Y2goYXR0cmlidXRlLm5hbWUpIHtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgLy8gYmFuZV9lbmZlZWJsZVxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBjYXNlICdlbmZlZWJsZV9hdHRhY2tfcmVkdWN0aW9uJzpcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIHRvdGFsQXR0cmlidXRlICs9IHNlbGYuZ2V0QWJpbGl0eUF0dHJpYnV0ZVZhbHVlKHNlbGYuX2FiaWxpdGllc1tpXS5hdHRyaWJ1dGVzLCBhdHRyaWJ1dGUubmFtZSwgYWJpbGl0eS5sZXZlbCgpKTtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgYnJlYWs7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICAgIGVsc2UqLyBpZiAoYWJpbGl0eS5kYW1hZ2VBbXBsaWZpY2F0aW9uICE9IHVuZGVmaW5lZCkge1xuICAgICAgICAgICAgICAgICAgICAgICAgLy8gdW5keWluZ19mbGVzaF9nb2xlbVxuICAgICAgICAgICAgICAgICAgICAgICAgdG90YWxBdHRyaWJ1dGUgKj0gKDEgKyBhYmlsaXR5LmRhbWFnZUFtcGxpZmljYXRpb24oKS8xMDApO1xuICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgIH1cbiAgICAgICAgfVxuICAgICAgICByZXR1cm4gdG90YWxBdHRyaWJ1dGU7XG4gICAgfSk7XG4gICAgXG4gICAgc2VsZi5nZXREYW1hZ2VSZWR1Y3Rpb24gPSBrby5jb21wdXRlZChmdW5jdGlvbiAoKSB7XG4gICAgICAgIHZhciB0b3RhbEF0dHJpYnV0ZSA9IDE7XG4gICAgICAgIGZvciAodmFyIGkgPSAwOyBpIDwgc2VsZi5hYmlsaXRpZXMoKS5sZW5ndGg7IGkrKykge1xuICAgICAgICAgICAgdmFyIGFiaWxpdHkgPSBzZWxmLl9hYmlsaXRpZXNbaV07XG4gICAgICAgICAgICBpZiAoYWJpbGl0eS5sZXZlbCgpID4gMCAmJiAoYWJpbGl0eS5pc0FjdGl2ZSgpIHx8IChhYmlsaXR5LmJlaGF2aW9yLmluZGV4T2YoJ0RPVEFfQUJJTElUWV9CRUhBVklPUl9QQVNTSVZFJykgIT0gLTEpKSkge1xuICAgICAgICAgICAgICAgIGlmICghKGFiaWxpdHkubmFtZSBpbiBzZWxmLmFiaWxpdHlEYXRhKSkge1xuICAgICAgICAgICAgICAgICAgICBmb3IgKHZhciBqID0gMDsgaiA8IHNlbGYuX2FiaWxpdGllc1tpXS5hdHRyaWJ1dGVzLmxlbmd0aDsgaisrKSB7XG4gICAgICAgICAgICAgICAgICAgICAgICB2YXIgYXR0cmlidXRlID0gc2VsZi5fYWJpbGl0aWVzW2ldLmF0dHJpYnV0ZXNbal07XG4gICAgICAgICAgICAgICAgICAgICAgICBzd2l0Y2goYXR0cmlidXRlLm5hbWUpIHtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAvLyBibG9vZHNlZWtlcl9ibG9vZHJhZ2VcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICBjYXNlICdkYW1hZ2VfaW5jcmVhc2VfcGN0JzpcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgaWYgKGFiaWxpdHkubmFtZSA9PSAnYmxvb2RzZWVrZXJfYmxvb2RyYWdlJykge1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgdG90YWxBdHRyaWJ1dGUgKj0gKDEgKyBzZWxmLmdldEFiaWxpdHlBdHRyaWJ1dGVWYWx1ZShzZWxmLl9hYmlsaXRpZXNbaV0uYXR0cmlidXRlcywgYXR0cmlidXRlLm5hbWUsIGFiaWxpdHkubGV2ZWwoKSkvMTAwKTtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICAgICAgICAgICAgICAgIGJyZWFrO1xuICAgICAgICAgICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgICAgICAgIC8vIGt1bmtrYV9naG9zdHNoaXBcbiAgICAgICAgICAgICAgICAgICAgaWYgKGFiaWxpdHkubmFtZSA9PSAna3Vua2thX2dob3N0c2hpcCcpIHtcbiAgICAgICAgICAgICAgICAgICAgICAgIHRvdGFsQXR0cmlidXRlICo9ICgxIC0gNTAvMTAwKTtcbiAgICAgICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgICBlbHNlIGlmIChhYmlsaXR5LmRhbWFnZVJlZHVjdGlvbiAhPSB1bmRlZmluZWQpIHtcbiAgICAgICAgICAgICAgICAgICAgLy8gd2lzcF9vdmVyY2hhcmdlLGJyaXN0bGViYWNrX2JyaXN0bGViYWNrLHNwZWN0cmVfZGlzcGVyc2lvbixtZWR1c2FfbWFuYV9zaGllbGQsdXJzYV9lbnJhZ2VcbiAgICAgICAgICAgICAgICAgICAgdG90YWxBdHRyaWJ1dGUgKj0gKDEgKyBhYmlsaXR5LmRhbWFnZVJlZHVjdGlvbigpLzEwMCk7XG4gICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgfVxuICAgICAgICB9XG4gICAgICAgIHJldHVybiB0b3RhbEF0dHJpYnV0ZTtcbiAgICB9KTtcblxuICAgIHNlbGYuZ2V0Q3JpdFNvdXJjZSA9IGtvLmNvbXB1dGVkKGZ1bmN0aW9uICgpIHtcbiAgICAgICAgdmFyIHNvdXJjZXMgPSB7fTtcbiAgICAgICAgZm9yICh2YXIgaSA9IDA7IGkgPCBzZWxmLmFiaWxpdGllcygpLmxlbmd0aDsgaSsrKSB7XG4gICAgICAgICAgICB2YXIgYWJpbGl0eSA9IHNlbGYuX2FiaWxpdGllc1tpXTtcbiAgICAgICAgICAgIGlmIChhYmlsaXR5LmxldmVsKCkgPiAwICYmIChhYmlsaXR5LmlzQWN0aXZlKCkgfHwgKGFiaWxpdHkuYmVoYXZpb3IuaW5kZXhPZignRE9UQV9BQklMSVRZX0JFSEFWSU9SX1BBU1NJVkUnKSAhPSAtMSkpKSB7XG4gICAgICAgICAgICAgICAgaWYgKCEoYWJpbGl0eS5uYW1lIGluIHNlbGYuYWJpbGl0eURhdGEpKSB7XG4gICAgICAgICAgICAgICAgICAgIHN3aXRjaChhYmlsaXR5Lm5hbWUpIHtcbiAgICAgICAgICAgICAgICAgICAgICAgIC8vIHBoYW50b21fYXNzYXNzaW5fY291cF9kZV9ncmFjZSxicmV3bWFzdGVyX2RydW5rZW5fYnJhd2xlcixjaGFvc19rbmlnaHRfY2hhb3Nfc3RyaWtlLGx5Y2FuX3NoYXBlc2hpZnQsc2tlbGV0b25fa2luZ19tb3J0YWxfc3RyaWtlLGp1Z2dlcm5hdXRfYmxhZGVfZGFuY2UsYWxwaGFfd29sZl9jcml0aWNhbF9zdHJpa2UsZ2lhbnRfd29sZl9jcml0aWNhbF9zdHJpa2VcbiAgICAgICAgICAgICAgICAgICAgICAgIGNhc2UgJ3BoYW50b21fYXNzYXNzaW5fY291cF9kZV9ncmFjZSc6XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgaWYgKHNvdXJjZXNbYWJpbGl0eS5uYW1lXSA9PSB1bmRlZmluZWQpIHtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgc291cmNlc1thYmlsaXR5Lm5hbWVdID0ge1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgJ2NoYW5jZSc6IHNlbGYuZ2V0QWJpbGl0eUF0dHJpYnV0ZVZhbHVlKHNlbGYuX2FiaWxpdGllc1tpXS5hdHRyaWJ1dGVzLCAnY3JpdF9jaGFuY2UnLCBhYmlsaXR5LmxldmVsKCkpLzEwMCxcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICdtdWx0aXBsaWVyJzogc2VsZi5nZXRBYmlsaXR5QXR0cmlidXRlVmFsdWUoc2VsZi5fYWJpbGl0aWVzW2ldLmF0dHJpYnV0ZXMsICdjcml0X2JvbnVzJywgYWJpbGl0eS5sZXZlbCgpKS8xMDAsXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAnY291bnQnOiAxLFxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgJ2Rpc3BsYXluYW1lJzogYWJpbGl0eS5kaXNwbGF5bmFtZVxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICAgICAgICAgICAgICAgIGVsc2Uge1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBzb3VyY2VzW2FiaWxpdHkubmFtZV0uY291bnQgKz0gMTtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgICAgICAgICAgICBicmVhaztcbiAgICAgICAgICAgICAgICAgICAgICAgIGNhc2UgJ2JyZXdtYXN0ZXJfZHJ1bmtlbl9icmF3bGVyJzpcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICBpZiAoc291cmNlc1thYmlsaXR5Lm5hbWVdID09IHVuZGVmaW5lZCkge1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBzb3VyY2VzW2FiaWxpdHkubmFtZV0gPSB7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAnY2hhbmNlJzogc2VsZi5nZXRBYmlsaXR5QXR0cmlidXRlVmFsdWUoc2VsZi5fYWJpbGl0aWVzW2ldLmF0dHJpYnV0ZXMsICdjcml0X2NoYW5jZScsIGFiaWxpdHkubGV2ZWwoKSkvMTAwLFxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgJ211bHRpcGxpZXInOiBzZWxmLmdldEFiaWxpdHlBdHRyaWJ1dGVWYWx1ZShzZWxmLl9hYmlsaXRpZXNbaV0uYXR0cmlidXRlcywgJ2NyaXRfbXVsdGlwbGllcicsIGFiaWxpdHkubGV2ZWwoKSkvMTAwLFxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgJ2NvdW50JzogMSxcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICdkaXNwbGF5bmFtZSc6IGFiaWxpdHkuZGlzcGxheW5hbWVcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgICAgICAgICAgICAgICBlbHNlIHtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgc291cmNlc1thYmlsaXR5Lm5hbWVdLmNvdW50ICs9IDE7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICAgICAgICAgICAgYnJlYWs7XG4gICAgICAgICAgICAgICAgICAgICAgICBjYXNlICdjaGFvc19rbmlnaHRfY2hhb3Nfc3RyaWtlJzpcbiAgICAgICAgICAgICAgICAgICAgICAgIGNhc2UgJ2x5Y2FuX3NoYXBlc2hpZnQnOlxuICAgICAgICAgICAgICAgICAgICAgICAgICAgIGlmIChzb3VyY2VzW2FiaWxpdHkubmFtZV0gPT0gdW5kZWZpbmVkKSB7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIHNvdXJjZXNbYWJpbGl0eS5uYW1lXSA9IHtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICdjaGFuY2UnOiBzZWxmLmdldEFiaWxpdHlBdHRyaWJ1dGVWYWx1ZShzZWxmLl9hYmlsaXRpZXNbaV0uYXR0cmlidXRlcywgJ2NyaXRfY2hhbmNlJywgYWJpbGl0eS5sZXZlbCgpKS8xMDAsXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAnbXVsdGlwbGllcic6IHNlbGYuZ2V0QWJpbGl0eUF0dHJpYnV0ZVZhbHVlKHNlbGYuX2FiaWxpdGllc1tpXS5hdHRyaWJ1dGVzLCAnY3JpdF9tdWx0aXBsaWVyJywgYWJpbGl0eS5sZXZlbCgpKS8xMDAsXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAnY291bnQnOiAxLFxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgJ2Rpc3BsYXluYW1lJzogYWJpbGl0eS5kaXNwbGF5bmFtZVxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICAgICAgICAgICAgICAgIGVsc2Uge1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBzb3VyY2VzW2FiaWxpdHkubmFtZV0uY291bnQgKz0gMTtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgICAgICAgICAgICBicmVhaztcbiAgICAgICAgICAgICAgICAgICAgICAgIGNhc2UgJ3NrZWxldG9uX2tpbmdfbW9ydGFsX3N0cmlrZSc6XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgaWYgKHNvdXJjZXNbYWJpbGl0eS5uYW1lXSA9PSB1bmRlZmluZWQpIHtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgc291cmNlc1thYmlsaXR5Lm5hbWVdID0ge1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgJ2NoYW5jZSc6IHNlbGYuZ2V0QWJpbGl0eUF0dHJpYnV0ZVZhbHVlKHNlbGYuX2FiaWxpdGllc1tpXS5hdHRyaWJ1dGVzLCAnY3JpdF9jaGFuY2UnLCBhYmlsaXR5LmxldmVsKCkpLzEwMCxcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICdtdWx0aXBsaWVyJzogc2VsZi5nZXRBYmlsaXR5QXR0cmlidXRlVmFsdWUoc2VsZi5fYWJpbGl0aWVzW2ldLmF0dHJpYnV0ZXMsICdjcml0X211bHQnLCBhYmlsaXR5LmxldmVsKCkpLzEwMCxcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICdjb3VudCc6IDEsXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAnZGlzcGxheW5hbWUnOiBhYmlsaXR5LmRpc3BsYXluYW1lXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgZWxzZSB7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIHNvdXJjZXNbYWJpbGl0eS5uYW1lXS5jb3VudCArPSAxO1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgICAgICAgICAgIGJyZWFrO1xuICAgICAgICAgICAgICAgICAgICAgICAgY2FzZSAnanVnZ2VybmF1dF9ibGFkZV9kYW5jZSc6XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgaWYgKHNvdXJjZXNbYWJpbGl0eS5uYW1lXSA9PSB1bmRlZmluZWQpIHtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgc291cmNlc1thYmlsaXR5Lm5hbWVdID0ge1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgJ2NoYW5jZSc6IHNlbGYuZ2V0QWJpbGl0eUF0dHJpYnV0ZVZhbHVlKHNlbGYuX2FiaWxpdGllc1tpXS5hdHRyaWJ1dGVzLCAnYmxhZGVfZGFuY2VfY3JpdF9jaGFuY2UnLCBhYmlsaXR5LmxldmVsKCkpLzEwMCxcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICdtdWx0aXBsaWVyJzogc2VsZi5nZXRBYmlsaXR5QXR0cmlidXRlVmFsdWUoc2VsZi5fYWJpbGl0aWVzW2ldLmF0dHJpYnV0ZXMsICdibGFkZV9kYW5jZV9jcml0X211bHQnLCBhYmlsaXR5LmxldmVsKCkpLzEwMCxcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICdjb3VudCc6IDEsXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAnZGlzcGxheW5hbWUnOiBhYmlsaXR5LmRpc3BsYXluYW1lXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgZWxzZSB7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIHNvdXJjZXNbYWJpbGl0eS5uYW1lXS5jb3VudCArPSAxO1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgICAgICAgICAgIGJyZWFrO1xuICAgICAgICAgICAgICAgICAgICAgICAgY2FzZSAnYWxwaGFfd29sZl9jcml0aWNhbF9zdHJpa2UnOlxuICAgICAgICAgICAgICAgICAgICAgICAgY2FzZSAnZ2lhbnRfd29sZl9jcml0aWNhbF9zdHJpa2UnOlxuICAgICAgICAgICAgICAgICAgICAgICAgICAgIGlmIChzb3VyY2VzW2FiaWxpdHkubmFtZV0gPT0gdW5kZWZpbmVkKSB7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIHNvdXJjZXNbYWJpbGl0eS5uYW1lXSA9IHtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICdjaGFuY2UnOiBzZWxmLmdldEFiaWxpdHlBdHRyaWJ1dGVWYWx1ZShzZWxmLl9hYmlsaXRpZXNbaV0uYXR0cmlidXRlcywgJ2NyaXRfY2hhbmNlJywgYWJpbGl0eS5sZXZlbCgpKS8xMDAsXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAnbXVsdGlwbGllcic6IHNlbGYuZ2V0QWJpbGl0eUF0dHJpYnV0ZVZhbHVlKHNlbGYuX2FiaWxpdGllc1tpXS5hdHRyaWJ1dGVzLCAnY3JpdF9tdWx0JywgYWJpbGl0eS5sZXZlbCgpKS8xMDAsXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAnY291bnQnOiAxLFxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgJ2Rpc3BsYXluYW1lJzogYWJpbGl0eS5kaXNwbGF5bmFtZVxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICAgICAgICAgICAgICAgIGVsc2Uge1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBzb3VyY2VzW2FiaWxpdHkubmFtZV0uY291bnQgKz0gMTtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgICAgICAgICAgICBicmVhaztcbiAgICAgICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgIH1cbiAgICAgICAgfVxuICAgICAgICByZXR1cm4gc291cmNlcztcbiAgICB9KTsgICAgXG5cbiAgICBzZWxmLmdldENsZWF2ZVNvdXJjZSA9IGtvLmNvbXB1dGVkKGZ1bmN0aW9uICgpIHtcbiAgICAgICAgdmFyIHNvdXJjZXMgPSB7fTtcbiAgICAgICAgZm9yICh2YXIgaSA9IDA7IGkgPCBzZWxmLmFiaWxpdGllcygpLmxlbmd0aDsgaSsrKSB7XG4gICAgICAgICAgICB2YXIgYWJpbGl0eSA9IHNlbGYuX2FiaWxpdGllc1tpXTtcbiAgICAgICAgICAgIGlmIChhYmlsaXR5LmxldmVsKCkgPiAwICYmIChhYmlsaXR5LmlzQWN0aXZlKCkgfHwgKGFiaWxpdHkuYmVoYXZpb3IuaW5kZXhPZignRE9UQV9BQklMSVRZX0JFSEFWSU9SX1BBU1NJVkUnKSAhPSAtMSkpKSB7XG4gICAgICAgICAgICAgICAgaWYgKCEoYWJpbGl0eS5uYW1lIGluIHNlbGYuYWJpbGl0eURhdGEpKSB7XG4gICAgICAgICAgICAgICAgICAgIHN3aXRjaChhYmlsaXR5Lm5hbWUpIHtcbiAgICAgICAgICAgICAgICAgICAgICAgIC8vIG1hZ25hdGF1cl9lbXBvd2VyXG4gICAgICAgICAgICAgICAgICAgICAgICBjYXNlICdtYWduYXRhdXJfZW1wb3dlcic6XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgaWYgKHNvdXJjZXNbYWJpbGl0eS5uYW1lXSA9PSB1bmRlZmluZWQpIHtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgc291cmNlc1thYmlsaXR5Lm5hbWVdID0ge1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgJ3JhZGl1cyc6IHNlbGYuZ2V0QWJpbGl0eUF0dHJpYnV0ZVZhbHVlKHNlbGYuX2FiaWxpdGllc1tpXS5hdHRyaWJ1dGVzLCAnY2xlYXZlX3JhZGl1cycsIGFiaWxpdHkubGV2ZWwoKSksXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAnbWFnbml0dWRlJzogc2VsZi5nZXRBYmlsaXR5QXR0cmlidXRlVmFsdWUoc2VsZi5fYWJpbGl0aWVzW2ldLmF0dHJpYnV0ZXMsICdjbGVhdmVfZGFtYWdlX3BjdCcsIGFiaWxpdHkubGV2ZWwoKSkvMTAwLFxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgJ2NvdW50JzogMSxcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICdkaXNwbGF5bmFtZSc6IGFiaWxpdHkuZGlzcGxheW5hbWVcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgICAgICAgICAgICAgICBlbHNlIHtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgc291cmNlc1thYmlsaXR5Lm5hbWVdLmNvdW50ICs9IDE7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICAgICAgICAgICAgYnJlYWs7XG4gICAgICAgICAgICAgICAgICAgICAgICAvLyBzdmVuX2dyZWF0X2NsZWF2ZVxuICAgICAgICAgICAgICAgICAgICAgICAgY2FzZSAnc3Zlbl9ncmVhdF9jbGVhdmUnOlxuICAgICAgICAgICAgICAgICAgICAgICAgICAgIGlmIChzb3VyY2VzW2FiaWxpdHkubmFtZV0gPT0gdW5kZWZpbmVkKSB7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIHNvdXJjZXNbYWJpbGl0eS5uYW1lXSA9IHtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICdyYWRpdXMnOiBzZWxmLmdldEFiaWxpdHlBdHRyaWJ1dGVWYWx1ZShzZWxmLl9hYmlsaXRpZXNbaV0uYXR0cmlidXRlcywgJ2dyZWF0X2NsZWF2ZV9yYWRpdXMnLCBhYmlsaXR5LmxldmVsKCkpLFxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgJ21hZ25pdHVkZSc6IHNlbGYuZ2V0QWJpbGl0eUF0dHJpYnV0ZVZhbHVlKHNlbGYuX2FiaWxpdGllc1tpXS5hdHRyaWJ1dGVzLCAnZ3JlYXRfY2xlYXZlX2RhbWFnZScsIGFiaWxpdHkubGV2ZWwoKSkvMTAwLFxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgJ2NvdW50JzogMSxcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICdkaXNwbGF5bmFtZSc6IGFiaWxpdHkuZGlzcGxheW5hbWVcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgICAgICAgICAgICAgICBlbHNlIHtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgc291cmNlc1thYmlsaXR5Lm5hbWVdLmNvdW50ICs9IDE7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICAgICAgICAgICAgYnJlYWs7XG4gICAgICAgICAgICAgICAgICAgICAgICAvLyBrdW5ra2FfdGlkZWJyaW5nZXJcbiAgICAgICAgICAgICAgICAgICAgICAgIGNhc2UgJ2t1bmtrYV90aWRlYnJpbmdlcic6XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgaWYgKHNvdXJjZXNbYWJpbGl0eS5uYW1lXSA9PSB1bmRlZmluZWQpIHtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgc291cmNlc1thYmlsaXR5Lm5hbWVdID0ge1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgJ3JhZGl1cyc6IHNlbGYuZ2V0QWJpbGl0eUF0dHJpYnV0ZVZhbHVlKHNlbGYuX2FiaWxpdGllc1tpXS5hdHRyaWJ1dGVzLCAncmFkaXVzJywgYWJpbGl0eS5sZXZlbCgpKSxcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICdtYWduaXR1ZGUnOiAxLFxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgJ2NvdW50JzogMSxcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICdkaXNwbGF5bmFtZSc6IGFiaWxpdHkuZGlzcGxheW5hbWVcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgICAgICAgICAgICAgICBlbHNlIHtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgc291cmNlc1thYmlsaXR5Lm5hbWVdLmNvdW50ICs9IDE7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICAgICAgICAgICAgYnJlYWs7XG4gICAgICAgICAgICAgICAgICAgICAgICAvLyB0aW55X2dyb3dcbiAgICAgICAgICAgICAgICAgICAgICAgIGNhc2UgJ3RpbnlfZ3Jvdyc6XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgaWYgKHNlbGYuaGFzU2NlcHRlcigpKSB7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIGlmIChzb3VyY2VzW2FiaWxpdHkubmFtZV0gPT0gdW5kZWZpbmVkKSB7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBzb3VyY2VzW2FiaWxpdHkubmFtZV0gPSB7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgJ3JhZGl1cyc6IHNlbGYuZ2V0QWJpbGl0eUF0dHJpYnV0ZVZhbHVlKHNlbGYuX2FiaWxpdGllc1tpXS5hdHRyaWJ1dGVzLCAnYm9udXNfY2xlYXZlX3JhZGl1c19zY2VwdGVyJywgYWJpbGl0eS5sZXZlbCgpKSxcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAnbWFnbml0dWRlJzogc2VsZi5nZXRBYmlsaXR5QXR0cmlidXRlVmFsdWUoc2VsZi5fYWJpbGl0aWVzW2ldLmF0dHJpYnV0ZXMsICdib251c19jbGVhdmVfZGFtYWdlX3NjZXB0ZXInLCBhYmlsaXR5LmxldmVsKCkpLzEwMCxcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAnY291bnQnOiAxLFxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICdkaXNwbGF5bmFtZSc6IGFiaWxpdHkuZGlzcGxheW5hbWVcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBlbHNlIHtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIHNvdXJjZXNbYWJpbGl0eS5uYW1lXS5jb3VudCArPSAxO1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICAgICAgICAgICAgYnJlYWs7XG4gICAgICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICB9XG4gICAgICAgIH1cbiAgICAgICAgcmV0dXJuIHNvdXJjZXM7XG4gICAgfSk7ICAgIFxuICAgIFxuICAgIHNlbGYuZ2V0Q3JpdENoYW5jZSA9IGtvLmNvbXB1dGVkKGZ1bmN0aW9uICgpIHtcbiAgICAgICAgdmFyIHRvdGFsQXR0cmlidXRlID0gMTtcbiAgICAgICAgZm9yICh2YXIgaSA9IDA7IGkgPCBzZWxmLmFiaWxpdGllcygpLmxlbmd0aDsgaSsrKSB7XG4gICAgICAgICAgICB2YXIgYWJpbGl0eSA9IHNlbGYuX2FiaWxpdGllc1tpXTtcbiAgICAgICAgICAgIGlmIChhYmlsaXR5LmxldmVsKCkgPiAwICYmIChhYmlsaXR5LmlzQWN0aXZlKCkgfHwgKGFiaWxpdHkuYmVoYXZpb3IuaW5kZXhPZignRE9UQV9BQklMSVRZX0JFSEFWSU9SX1BBU1NJVkUnKSAhPSAtMSkpKSB7XG4gICAgICAgICAgICAgICAgaWYgKCEoYWJpbGl0eS5uYW1lIGluIHNlbGYuYWJpbGl0eURhdGEpKSB7XG4gICAgICAgICAgICAgICAgICAgIGZvciAodmFyIGogPSAwOyBqIDwgc2VsZi5fYWJpbGl0aWVzW2ldLmF0dHJpYnV0ZXMubGVuZ3RoOyBqKyspIHtcbiAgICAgICAgICAgICAgICAgICAgICAgIHZhciBhdHRyaWJ1dGUgPSBzZWxmLl9hYmlsaXRpZXNbaV0uYXR0cmlidXRlc1tqXTtcbiAgICAgICAgICAgICAgICAgICAgICAgIHN3aXRjaChhdHRyaWJ1dGUubmFtZSkge1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgIC8vIHBoYW50b21fYXNzYXNzaW5fY291cF9kZV9ncmFjZSxicmV3bWFzdGVyX2RydW5rZW5fYnJhd2xlcixjaGFvc19rbmlnaHRfY2hhb3Nfc3RyaWtlLGx5Y2FuX3NoYXBlc2hpZnQsc2tlbGV0b25fa2luZ19tb3J0YWxfc3RyaWtlXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgY2FzZSAnY3JpdF9jaGFuY2UnOlxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICB0b3RhbEF0dHJpYnV0ZSAqPSAoMSAtIHNlbGYuZ2V0QWJpbGl0eUF0dHJpYnV0ZVZhbHVlKHNlbGYuX2FiaWxpdGllc1tpXS5hdHRyaWJ1dGVzLCBhdHRyaWJ1dGUubmFtZSwgYWJpbGl0eS5sZXZlbCgpKS8xMDApO1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgIGJyZWFrO1xuICAgICAgICAgICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgfVxuICAgICAgICB9XG4gICAgICAgIHJldHVybiB0b3RhbEF0dHJpYnV0ZTtcbiAgICB9KTsgICAgICAgICAgICBcbiAgICBcbiAgICBzZWxmLmdldEV2YXNpb24gPSBrby5jb21wdXRlZChmdW5jdGlvbiAoKSB7XG4gICAgICAgIHZhciB0b3RhbEF0dHJpYnV0ZSA9IDE7XG4gICAgICAgIGZvciAodmFyIGkgPSAwOyBpIDwgc2VsZi5hYmlsaXRpZXMoKS5sZW5ndGg7IGkrKykge1xuICAgICAgICAgICAgdmFyIGFiaWxpdHkgPSBzZWxmLl9hYmlsaXRpZXNbaV07XG4gICAgICAgICAgICBpZiAoYWJpbGl0eS5sZXZlbCgpID4gMCAmJiAoYWJpbGl0eS5pc0FjdGl2ZSgpIHx8IChhYmlsaXR5LmJlaGF2aW9yLmluZGV4T2YoJ0RPVEFfQUJJTElUWV9CRUhBVklPUl9QQVNTSVZFJykgIT0gLTEpKSkge1xuICAgICAgICAgICAgICAgIGlmICghKGFiaWxpdHkubmFtZSBpbiBzZWxmLmFiaWxpdHlEYXRhKSkge1xuICAgICAgICAgICAgICAgICAgICBmb3IgKHZhciBqID0gMDsgaiA8IHNlbGYuX2FiaWxpdGllc1tpXS5hdHRyaWJ1dGVzLmxlbmd0aDsgaisrKSB7XG4gICAgICAgICAgICAgICAgICAgICAgICB2YXIgYXR0cmlidXRlID0gc2VsZi5fYWJpbGl0aWVzW2ldLmF0dHJpYnV0ZXNbal07XG4gICAgICAgICAgICAgICAgICAgICAgICBzd2l0Y2goYXR0cmlidXRlLm5hbWUpIHtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAvLyBwaGFudG9tX2Fzc2Fzc2luX2JsdXJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICBjYXNlICdib251c19ldmFzaW9uJzpcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAvLyBicmV3bWFzdGVyX2RydW5rZW5fYnJhd2xlclxuICAgICAgICAgICAgICAgICAgICAgICAgICAgIGNhc2UgJ2RvZGdlX2NoYW5jZSc6XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIHRvdGFsQXR0cmlidXRlICo9ICgxIC0gc2VsZi5nZXRBYmlsaXR5QXR0cmlidXRlVmFsdWUoc2VsZi5fYWJpbGl0aWVzW2ldLmF0dHJpYnV0ZXMsIGF0dHJpYnV0ZS5uYW1lLCBhYmlsaXR5LmxldmVsKCkpLzEwMCk7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgYnJlYWs7XG4gICAgICAgICAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICB9XG4gICAgICAgIH1cbiAgICAgICAgcmV0dXJuIHRvdGFsQXR0cmlidXRlO1xuICAgIH0pO1xuICAgIFxuICAgIHNlbGYuZ2V0RXZhc2lvbkJhY2t0cmFjayA9IGtvLmNvbXB1dGVkKGZ1bmN0aW9uICgpIHtcbiAgICAgICAgdmFyIHRvdGFsQXR0cmlidXRlID0gMTtcbiAgICAgICAgZm9yICh2YXIgaSA9IDA7IGkgPCBzZWxmLmFiaWxpdGllcygpLmxlbmd0aDsgaSsrKSB7XG4gICAgICAgICAgICB2YXIgYWJpbGl0eSA9IHNlbGYuX2FiaWxpdGllc1tpXTtcbiAgICAgICAgICAgIGlmIChhYmlsaXR5LmxldmVsKCkgPiAwICYmIChhYmlsaXR5LmlzQWN0aXZlKCkgfHwgKGFiaWxpdHkuYmVoYXZpb3IuaW5kZXhPZignRE9UQV9BQklMSVRZX0JFSEFWSU9SX1BBU1NJVkUnKSAhPSAtMSkpKSB7XG4gICAgICAgICAgICAgICAgaWYgKCEoYWJpbGl0eS5uYW1lIGluIHNlbGYuYWJpbGl0eURhdGEpKSB7XG4gICAgICAgICAgICAgICAgICAgIGZvciAodmFyIGogPSAwOyBqIDwgc2VsZi5fYWJpbGl0aWVzW2ldLmF0dHJpYnV0ZXMubGVuZ3RoOyBqKyspIHtcbiAgICAgICAgICAgICAgICAgICAgICAgIHZhciBhdHRyaWJ1dGUgPSBzZWxmLl9hYmlsaXRpZXNbaV0uYXR0cmlidXRlc1tqXTtcbiAgICAgICAgICAgICAgICAgICAgICAgIHN3aXRjaChhdHRyaWJ1dGUubmFtZSkge1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgIC8vIGZhY2VsZXNzX3ZvaWRfYmFja3RyYWNrXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgY2FzZSAnZG9kZ2VfY2hhbmNlX3BjdCc6XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIHRvdGFsQXR0cmlidXRlICo9ICgxIC0gc2VsZi5nZXRBYmlsaXR5QXR0cmlidXRlVmFsdWUoc2VsZi5fYWJpbGl0aWVzW2ldLmF0dHJpYnV0ZXMsIGF0dHJpYnV0ZS5uYW1lLCBhYmlsaXR5LmxldmVsKCkpLzEwMCk7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgYnJlYWs7XG4gICAgICAgICAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICB9XG4gICAgICAgIH1cbiAgICAgICAgcmV0dXJuIHRvdGFsQXR0cmlidXRlO1xuICAgIH0pO1xuICAgIFxuICAgIHNlbGYuZ2V0TWlzc0NoYW5jZSA9IGtvLmNvbXB1dGVkKGZ1bmN0aW9uICgpIHtcbiAgICAgICAgdmFyIHRvdGFsQXR0cmlidXRlID0gMTtcbiAgICAgICAgZm9yICh2YXIgaSA9IDA7IGkgPCBzZWxmLmFiaWxpdGllcygpLmxlbmd0aDsgaSsrKSB7XG4gICAgICAgICAgICB2YXIgYWJpbGl0eSA9IHNlbGYuX2FiaWxpdGllc1tpXTtcbiAgICAgICAgICAgIGlmIChhYmlsaXR5LmxldmVsKCkgPiAwICYmIChhYmlsaXR5LmlzQWN0aXZlKCkgfHwgKGFiaWxpdHkuYmVoYXZpb3IuaW5kZXhPZignRE9UQV9BQklMSVRZX0JFSEFWSU9SX1BBU1NJVkUnKSAhPSAtMSkpKSB7XG4gICAgICAgICAgICAgICAgaWYgKCEoYWJpbGl0eS5uYW1lIGluIHNlbGYuYWJpbGl0eURhdGEpKSB7XG4gICAgICAgICAgICAgICAgICAgIGZvciAodmFyIGogPSAwOyBqIDwgc2VsZi5fYWJpbGl0aWVzW2ldLmF0dHJpYnV0ZXMubGVuZ3RoOyBqKyspIHtcbiAgICAgICAgICAgICAgICAgICAgICAgIHZhciBhdHRyaWJ1dGUgPSBzZWxmLl9hYmlsaXRpZXNbaV0uYXR0cmlidXRlc1tqXTtcbiAgICAgICAgICAgICAgICAgICAgICAgIHN3aXRjaChhdHRyaWJ1dGUubmFtZSkge1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgIC8vIGJyb29kbW90aGVyX2luY2FwYWNpdGF0aW5nX2JpdGUsYnJld21hc3Rlcl9kcnVua2VuX2hhemVcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICBjYXNlICdtaXNzX2NoYW5jZSc6XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgLy8gcmlraV9zbW9rZV9zY3JlZW4sa2VlcGVyX29mX3RoZV9saWdodF9ibGluZGluZ19saWdodCx0aW5rZXJfbGFzZXJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICBjYXNlICdtaXNzX3JhdGUnOlxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICB0b3RhbEF0dHJpYnV0ZSAqPSAoMSAtIHNlbGYuZ2V0QWJpbGl0eUF0dHJpYnV0ZVZhbHVlKHNlbGYuX2FiaWxpdGllc1tpXS5hdHRyaWJ1dGVzLCBhdHRyaWJ1dGUubmFtZSwgYWJpbGl0eS5sZXZlbCgpKS8xMDApO1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgIGJyZWFrO1xuICAgICAgICAgICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICAgIGVsc2UgaWYgKGFiaWxpdHkubWlzc0NoYW5jZSAhPSB1bmRlZmluZWQpIHtcbiAgICAgICAgICAgICAgICAgICAgLy8gbmlnaHRfc3RhbGtlcl9jcmlwcGxpbmdfZmVhclxuICAgICAgICAgICAgICAgICAgICB0b3RhbEF0dHJpYnV0ZSo9KDEtYWJpbGl0eS5taXNzQ2hhbmNlKCkvMTAwKTtcbiAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICB9XG4gICAgICAgIH1cbiAgICAgICAgcmV0dXJuIHRvdGFsQXR0cmlidXRlO1xuICAgIH0pO1xuICAgIFxuICAgIHNlbGYuZ2V0TGlmZXN0ZWFsID0ga28uY29tcHV0ZWQoZnVuY3Rpb24gKCkge1xuICAgICAgICB2YXIgdG90YWxBdHRyaWJ1dGUgPSAwO1xuICAgICAgICBmb3IgKHZhciBpID0gMDsgaSA8IHNlbGYuYWJpbGl0aWVzKCkubGVuZ3RoOyBpKyspIHtcbiAgICAgICAgICAgIHZhciBhYmlsaXR5ID0gc2VsZi5fYWJpbGl0aWVzW2ldO1xuICAgICAgICAgICAgaWYgKGFiaWxpdHkubGV2ZWwoKSA+IDAgJiYgKGFiaWxpdHkuaXNBY3RpdmUoKSB8fCAoYWJpbGl0eS5iZWhhdmlvci5pbmRleE9mKCdET1RBX0FCSUxJVFlfQkVIQVZJT1JfUEFTU0lWRScpICE9IC0xKSkpIHtcbiAgICAgICAgICAgICAgICBpZiAoIShhYmlsaXR5Lm5hbWUgaW4gc2VsZi5hYmlsaXR5RGF0YSkpIHtcbiAgICAgICAgICAgICAgICAgICAgZm9yICh2YXIgaiA9IDA7IGogPCBzZWxmLl9hYmlsaXRpZXNbaV0uYXR0cmlidXRlcy5sZW5ndGg7IGorKykge1xuICAgICAgICAgICAgICAgICAgICAgICAgdmFyIGF0dHJpYnV0ZSA9IHNlbGYuX2FiaWxpdGllc1tpXS5hdHRyaWJ1dGVzW2pdO1xuICAgICAgICAgICAgICAgICAgICAgICAgc3dpdGNoKGF0dHJpYnV0ZS5uYW1lKSB7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgLy8gc2tlbGV0b25fa2luZ192YW1waXJpY19hdXJhXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgY2FzZSAndmFtcGlyaWNfYXVyYSc6XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgLy8gYnJvb2Rtb3RoZXJfaW5zYXRpYWJsZV9odW5nZXJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICBjYXNlICdsaWZlc3RlYWxfcGN0JzpcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgdG90YWxBdHRyaWJ1dGUgKz0gc2VsZi5nZXRBYmlsaXR5QXR0cmlidXRlVmFsdWUoc2VsZi5fYWJpbGl0aWVzW2ldLmF0dHJpYnV0ZXMsIGF0dHJpYnV0ZS5uYW1lLCBhYmlsaXR5LmxldmVsKCkpO1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgIGJyZWFrO1xuICAgICAgICAgICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICAgIGVsc2UgaWYgKGFiaWxpdHkubGlmZXN0ZWFsICE9IHVuZGVmaW5lZCkge1xuICAgICAgICAgICAgICAgICAgICAvLyBsaWZlX3N0ZWFsZXJfb3Blbl93b3VuZHNcbiAgICAgICAgICAgICAgICAgICAgdG90YWxBdHRyaWJ1dGUrPWFiaWxpdHkubGlmZXN0ZWFsKCk7XG4gICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgfVxuICAgICAgICB9XG4gICAgICAgIHJldHVybiB0b3RhbEF0dHJpYnV0ZTtcbiAgICB9KTtcbiAgICBcbiAgICBzZWxmLmdldE1hZ2ljUmVzaXN0ID0ga28uY29tcHV0ZWQoZnVuY3Rpb24gKCkge1xuICAgICAgICB2YXIgdG90YWxBdHRyaWJ1dGUgPSAxO1xuICAgICAgICBmb3IgKHZhciBpID0gMDsgaSA8IHNlbGYuYWJpbGl0aWVzKCkubGVuZ3RoOyBpKyspIHtcbiAgICAgICAgICAgIHZhciBhYmlsaXR5ID0gc2VsZi5fYWJpbGl0aWVzW2ldO1xuICAgICAgICAgICAgaWYgKGFiaWxpdHkubGV2ZWwoKSA+IDAgJiYgKGFiaWxpdHkuaXNBY3RpdmUoKSB8fCAoYWJpbGl0eS5iZWhhdmlvci5pbmRleE9mKCdET1RBX0FCSUxJVFlfQkVIQVZJT1JfUEFTU0lWRScpICE9IC0xKSkpIHtcbiAgICAgICAgICAgICAgICBpZiAoIShhYmlsaXR5Lm5hbWUgaW4gc2VsZi5hYmlsaXR5RGF0YSkpIHtcbiAgICAgICAgICAgICAgICAgICAgZm9yICh2YXIgaiA9IDA7IGogPCBzZWxmLl9hYmlsaXRpZXNbaV0uYXR0cmlidXRlcy5sZW5ndGg7IGorKykge1xuICAgICAgICAgICAgICAgICAgICAgICAgdmFyIGF0dHJpYnV0ZSA9IHNlbGYuX2FiaWxpdGllc1tpXS5hdHRyaWJ1dGVzW2pdO1xuICAgICAgICAgICAgICAgICAgICAgICAgc3dpdGNoKGF0dHJpYnV0ZS5uYW1lKSB7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgLy8gYW50aW1hZ2Vfc3BlbGxfc2hpZWxkXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgY2FzZSAnc3BlbGxfc2hpZWxkX3Jlc2lzdGFuY2UnOlxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICB0b3RhbEF0dHJpYnV0ZSAqPSAoMSAtIHNlbGYuZ2V0QWJpbGl0eUF0dHJpYnV0ZVZhbHVlKHNlbGYuX2FiaWxpdGllc1tpXS5hdHRyaWJ1dGVzLCBhdHRyaWJ1dGUubmFtZSwgYWJpbGl0eS5sZXZlbCgpKS8xMDApO1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgIGJyZWFrO1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgIC8vIHBoYW50b21fbGFuY2VyX3BoYW50b21fZWRnZVxuICAgICAgICAgICAgICAgICAgICAgICAgICAgIGNhc2UgJ21hZ2ljX3Jlc2lzdGFuY2VfcGN0JzpcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgaWYgKGFiaWxpdHkubmFtZSA9PSAncGhhbnRvbV9sYW5jZXJfcGhhbnRvbV9lZGdlJykge1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgdG90YWxBdHRyaWJ1dGUgKj0gKDEgLSBzZWxmLmdldEFiaWxpdHlBdHRyaWJ1dGVWYWx1ZShzZWxmLl9hYmlsaXRpZXNbaV0uYXR0cmlidXRlcywgYXR0cmlidXRlLm5hbWUsIGFiaWxpdHkubGV2ZWwoKSkvMTAwKTtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICAgICAgICAgICAgICAgIGJyZWFrO1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgIC8vIHJ1Ymlja19udWxsX2ZpZWxkXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgY2FzZSAnbWFnaWNfZGFtYWdlX3JlZHVjdGlvbl9wY3QnOlxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBpZiAoYWJpbGl0eS5uYW1lID09ICdydWJpY2tfbnVsbF9maWVsZCcpIHtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIHRvdGFsQXR0cmlidXRlICo9ICgxIC0gc2VsZi5nZXRBYmlsaXR5QXR0cmlidXRlVmFsdWUoc2VsZi5fYWJpbGl0aWVzW2ldLmF0dHJpYnV0ZXMsIGF0dHJpYnV0ZS5uYW1lLCBhYmlsaXR5LmxldmVsKCkpLzEwMCk7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgICAgICAgICAgICAgICBicmVhaztcbiAgICAgICAgICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgICBlbHNlIGlmIChhYmlsaXR5Lm1hZ2ljUmVzaXN0ICE9IHVuZGVmaW5lZCkge1xuICAgICAgICAgICAgICAgICAgICAvLyBodXNrYXJfYmVyc2Vya2Vyc19ibG9vZCx2aXBlcl9jb3Jyb3NpdmVfc2tpbix2aXNhZ2VfZ3JhdmVrZWVwZXJzX2Nsb2FrXG4gICAgICAgICAgICAgICAgICAgIHRvdGFsQXR0cmlidXRlICo9ICgxIC0gYWJpbGl0eS5tYWdpY1Jlc2lzdCgpLzEwMCk7XG4gICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgfVxuICAgICAgICB9XG4gICAgICAgIHJldHVybiB0b3RhbEF0dHJpYnV0ZTtcbiAgICB9KTtcblxuICAgIHNlbGYuZ2V0TWFnaWNSZXNpc3RSZWR1Y3Rpb24gPSBrby5jb21wdXRlZChmdW5jdGlvbiAoKSB7XG4gICAgICAgIHZhciB0b3RhbEF0dHJpYnV0ZSA9IDE7XG4gICAgICAgIGZvciAodmFyIGkgPSAwOyBpIDwgc2VsZi5hYmlsaXRpZXMoKS5sZW5ndGg7IGkrKykge1xuICAgICAgICAgICAgdmFyIGFiaWxpdHkgPSBzZWxmLl9hYmlsaXRpZXNbaV07XG4gICAgICAgICAgICBpZiAoYWJpbGl0eS5sZXZlbCgpID4gMCAmJiAoYWJpbGl0eS5pc0FjdGl2ZSgpIHx8IChhYmlsaXR5LmJlaGF2aW9yLmluZGV4T2YoJ0RPVEFfQUJJTElUWV9CRUhBVklPUl9QQVNTSVZFJykgIT0gLTEpKSkge1xuICAgICAgICAgICAgICAgIGlmICghKGFiaWxpdHkubmFtZSBpbiBzZWxmLmFiaWxpdHlEYXRhKSkge1xuICAgICAgICAgICAgICAgICAgICBmb3IgKHZhciBqID0gMDsgaiA8IHNlbGYuX2FiaWxpdGllc1tpXS5hdHRyaWJ1dGVzLmxlbmd0aDsgaisrKSB7XG4gICAgICAgICAgICAgICAgICAgICAgICB2YXIgYXR0cmlidXRlID0gc2VsZi5fYWJpbGl0aWVzW2ldLmF0dHJpYnV0ZXNbal07XG4gICAgICAgICAgICAgICAgICAgICAgICBzd2l0Y2goYXR0cmlidXRlLm5hbWUpIHtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAvLyBhbmNpZW50X2FwcGFyaXRpb25faWNlX3ZvcnRleFxuICAgICAgICAgICAgICAgICAgICAgICAgICAgIGNhc2UgJ3NwZWxsX3Jlc2lzdF9wY3QnOlxuICAgICAgICAgICAgICAgICAgICAgICAgICAgIC8vIHB1Z25hX2RlY3JlcGlmeVxuICAgICAgICAgICAgICAgICAgICAgICAgICAgIGNhc2UgJ2JvbnVzX3NwZWxsX2RhbWFnZV9wY3QnOlxuICAgICAgICAgICAgICAgICAgICAgICAgICAgIC8vIHNreXdyYXRoX21hZ2VfYW5jaWVudF9zZWFsXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgY2FzZSAncmVzaXN0X2RlYnVmZic6XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIHRvdGFsQXR0cmlidXRlICo9ICgxIC0gc2VsZi5nZXRBYmlsaXR5QXR0cmlidXRlVmFsdWUoc2VsZi5fYWJpbGl0aWVzW2ldLmF0dHJpYnV0ZXMsIGF0dHJpYnV0ZS5uYW1lLCBhYmlsaXR5LmxldmVsKCkpLzEwMCk7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgYnJlYWs7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgLy8gZWxkZXJfdGl0YW5fbmF0dXJhbF9vcmRlclxuICAgICAgICAgICAgICAgICAgICAgICAgICAgIGNhc2UgJ21hZ2ljX3Jlc2lzdGFuY2VfcGN0JzpcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgdG90YWxBdHRyaWJ1dGUgKj0gKDEgLSBzZWxmLmdldEFiaWxpdHlBdHRyaWJ1dGVWYWx1ZShzZWxmLl9hYmlsaXRpZXNbaV0uYXR0cmlidXRlcywgYXR0cmlidXRlLm5hbWUsIGFiaWxpdHkubGV2ZWwoKSkvMTAwKTtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICBicmVhaztcbiAgICAgICAgICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgIH1cbiAgICAgICAgfVxuICAgICAgICByZXR1cm4gdG90YWxBdHRyaWJ1dGU7XG4gICAgfSk7XG4gICAgXG4gICAgc2VsZi5nZXRNb3ZlbWVudFNwZWVkRmxhdCA9IGtvLmNvbXB1dGVkKGZ1bmN0aW9uICgpIHtcbiAgICAgICAgdmFyIHRvdGFsQXR0cmlidXRlID0gMDtcbiAgICAgICAgZm9yICh2YXIgaSA9IDA7IGkgPCBzZWxmLmFiaWxpdGllcygpLmxlbmd0aDsgaSsrKSB7XG4gICAgICAgICAgICB2YXIgYWJpbGl0eSA9IHNlbGYuX2FiaWxpdGllc1tpXTtcbiAgICAgICAgICAgIGlmIChhYmlsaXR5LmxldmVsKCkgPiAwICYmIChhYmlsaXR5LmlzQWN0aXZlKCkgfHwgKGFiaWxpdHkuYmVoYXZpb3IuaW5kZXhPZignRE9UQV9BQklMSVRZX0JFSEFWSU9SX1BBU1NJVkUnKSAhPSAtMSkpKSB7XG4gICAgICAgICAgICAgICAgaWYgKCEoYWJpbGl0eS5uYW1lIGluIHNlbGYuYWJpbGl0eURhdGEpKSB7XG4gICAgICAgICAgICAgICAgICAgIGZvciAodmFyIGogPSAwOyBqIDwgc2VsZi5fYWJpbGl0aWVzW2ldLmF0dHJpYnV0ZXMubGVuZ3RoOyBqKyspIHtcbiAgICAgICAgICAgICAgICAgICAgICAgIHZhciBhdHRyaWJ1dGUgPSBzZWxmLl9hYmlsaXRpZXNbaV0uYXR0cmlidXRlc1tqXTtcbiAgICAgICAgICAgICAgICAgICAgICAgIHN3aXRjaChhdHRyaWJ1dGUubmFtZSkge1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgIC8vIGFsY2hlbWlzdF9jaGVtaWNhbF9yYWdlXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgY2FzZSAnYm9udXNfbW92ZXNwZWVkJzpcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgaWYgKGFiaWxpdHkubmFtZSA9PSAnYWxjaGVtaXN0X2NoZW1pY2FsX3JhZ2UnKSB7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICB0b3RhbEF0dHJpYnV0ZSArPSBzZWxmLmdldEFiaWxpdHlBdHRyaWJ1dGVWYWx1ZShzZWxmLl9hYmlsaXRpZXNbaV0uYXR0cmlidXRlcywgYXR0cmlidXRlLm5hbWUsIGFiaWxpdHkubGV2ZWwoKSk7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgICAgICAgICAgICAgICBicmVhaztcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAvLyB0aW55X2dyb3dcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICBjYXNlICdib251c19tb3ZlbWVudF9zcGVlZCc6XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIGlmIChhYmlsaXR5Lm5hbWUgPT0gJ3RpbnlfZ3JvdycpIHtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIHRvdGFsQXR0cmlidXRlICs9IHNlbGYuZ2V0QWJpbGl0eUF0dHJpYnV0ZVZhbHVlKHNlbGYuX2FiaWxpdGllc1tpXS5hdHRyaWJ1dGVzLCBhdHRyaWJ1dGUubmFtZSwgYWJpbGl0eS5sZXZlbCgpKTtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICAgICAgICAgICAgICAgIGJyZWFrO1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgIC8vIHRyb2xsX3dhcmxvcmRfYmVyc2Vya2Vyc19yYWdlXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgY2FzZSAnYm9udXNfbW92ZV9zcGVlZCc6XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIGlmIChhYmlsaXR5Lm5hbWUgPT0gJ3Ryb2xsX3dhcmxvcmRfYmVyc2Vya2Vyc19yYWdlJykge1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgdG90YWxBdHRyaWJ1dGUgKz0gc2VsZi5nZXRBYmlsaXR5QXR0cmlidXRlVmFsdWUoc2VsZi5fYWJpbGl0aWVzW2ldLmF0dHJpYnV0ZXMsIGF0dHJpYnV0ZS5uYW1lLCBhYmlsaXR5LmxldmVsKCkpO1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICB9ICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICBicmVhaztcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAvLyBsb25lX2RydWlkX3RydWVfZm9ybVxuICAgICAgICAgICAgICAgICAgICAgICAgICAgIGNhc2UgJ3NwZWVkX2xvc3MnOlxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICB0b3RhbEF0dHJpYnV0ZSAtPSBzZWxmLmdldEFiaWxpdHlBdHRyaWJ1dGVWYWx1ZShzZWxmLl9hYmlsaXRpZXNbaV0uYXR0cmlidXRlcywgYXR0cmlidXRlLm5hbWUsIGFiaWxpdHkubGV2ZWwoKSk7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgYnJlYWs7XG4gICAgICAgICAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgICAgZWxzZSBpZiAoYWJpbGl0eS5tb3ZlbWVudFNwZWVkRmxhdCAhPSB1bmRlZmluZWQpIHtcbiAgICAgICAgICAgICAgICAvLyBkcmFnb25fa25pZ2h0X2VsZGVyX2RyYWdvbl9mb3JtXG4gICAgICAgICAgICAgICAgICAgIHRvdGFsQXR0cmlidXRlKz1hYmlsaXR5Lm1vdmVtZW50U3BlZWRGbGF0KCk7XG4gICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgfVxuICAgICAgICB9XG4gICAgICAgIHJldHVybiB0b3RhbEF0dHJpYnV0ZTtcbiAgICB9KTtcbiAgICBcbiAgICBzZWxmLmdldE1vdmVtZW50U3BlZWRQZXJjZW50ID0ga28uY29tcHV0ZWQoZnVuY3Rpb24gKCkge1xuICAgICAgICB2YXIgdG90YWxBdHRyaWJ1dGUgPSAwO1xuICAgICAgICBmb3IgKHZhciBpID0gMDsgaSA8IHNlbGYuYWJpbGl0aWVzKCkubGVuZ3RoOyBpKyspIHtcbiAgICAgICAgICAgIHZhciBhYmlsaXR5ID0gc2VsZi5fYWJpbGl0aWVzW2ldO1xuICAgICAgICAgICAgaWYgKGFiaWxpdHkubGV2ZWwoKSA+IDAgJiYgKGFiaWxpdHkuaXNBY3RpdmUoKSB8fCAoYWJpbGl0eS5iZWhhdmlvci5pbmRleE9mKCdET1RBX0FCSUxJVFlfQkVIQVZJT1JfUEFTU0lWRScpICE9IC0xKSkpIHtcbiAgICAgICAgICAgICAgICBpZiAoIShhYmlsaXR5Lm5hbWUgaW4gc2VsZi5hYmlsaXR5RGF0YSkpIHtcbiAgICAgICAgICAgICAgICAgICAgZm9yICh2YXIgaiA9IDA7IGogPCBzZWxmLl9hYmlsaXRpZXNbaV0uYXR0cmlidXRlcy5sZW5ndGg7IGorKykge1xuICAgICAgICAgICAgICAgICAgICAgICAgdmFyIGF0dHJpYnV0ZSA9IHNlbGYuX2FiaWxpdGllc1tpXS5hdHRyaWJ1dGVzW2pdO1xuICAgICAgICAgICAgICAgICAgICAgICAgc3dpdGNoKGF0dHJpYnV0ZS5uYW1lKSB7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgLy8gYWJhZGRvbl9mcm9zdG1vdXJuZSBcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICBjYXNlICdtb3ZlX3NwZWVkX3BjdCc6XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgLy8gYm91bnR5X2h1bnRlcl90cmFjayBcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICBjYXNlICdib251c19tb3ZlX3NwZWVkX3BjdCc6XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgLy8gbWlyYW5hX2xlYXAgXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgY2FzZSAnbGVhcF9zcGVlZGJvbnVzJzpcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAvLyBzdmVuX3dhcmNyeSBcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICBjYXNlICd3YXJjcnlfbW92ZXNwZWVkJzpcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAvLyBjbGlua3pfd2luZF93YWxrXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgY2FzZSAnbW92ZV9zcGVlZF9ib251c19wY3QnOlxuICAgICAgICAgICAgICAgICAgICAgICAgICAgIC8vIHdpbmRydW5uZXJfd2luZHJ1blxuICAgICAgICAgICAgICAgICAgICAgICAgICAgIGNhc2UgJ21vdmVzcGVlZF9ib251c19wY3QnOlxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICB0b3RhbEF0dHJpYnV0ZSArPSBzZWxmLmdldEFiaWxpdHlBdHRyaWJ1dGVWYWx1ZShzZWxmLl9hYmlsaXRpZXNbaV0uYXR0cmlidXRlcywgYXR0cmlidXRlLm5hbWUsIGFiaWxpdHkubGV2ZWwoKSkvMTAwO1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgIGJyZWFrO1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgIC8vIGJyb29kbW90aGVyX3NwaW5fd2ViLHNwZWN0cmVfc3BlY3RyYWxfZGFnZ2VyXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgY2FzZSAnYm9udXNfbW92ZXNwZWVkJzpcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgaWYgKGFiaWxpdHkubmFtZSA9PSAnYnJvb2Rtb3RoZXJfc3Bpbl93ZWInIHx8IGFiaWxpdHkubmFtZSA9PSAnc3BlY3RyZV9zcGVjdHJhbF9kYWdnZXInKSB7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICB0b3RhbEF0dHJpYnV0ZSArPSBzZWxmLmdldEFiaWxpdHlBdHRyaWJ1dGVWYWx1ZShzZWxmLl9hYmlsaXRpZXNbaV0uYXR0cmlidXRlcywgYXR0cmlidXRlLm5hbWUsIGFiaWxpdHkubGV2ZWwoKSkvMTAwO1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgYnJlYWs7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgLy8gYXhlX2N1bGxpbmdfYmxhZGUsbmVjcm9ub21pY29uX2FyY2hlcl9hb2VcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICBjYXNlICdzcGVlZF9ib251cyc6XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIGlmIChhYmlsaXR5Lm5hbWUgPT0gJ2F4ZV9jdWxsaW5nX2JsYWRlJyB8fCBhYmlsaXR5Lm5hbWUgPT0gJ25lY3Jvbm9taWNvbl9hcmNoZXJfYW9lJykge1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgdG90YWxBdHRyaWJ1dGUgKz0gc2VsZi5nZXRBYmlsaXR5QXR0cmlidXRlVmFsdWUoc2VsZi5fYWJpbGl0aWVzW2ldLmF0dHJpYnV0ZXMsIGF0dHJpYnV0ZS5uYW1lLCBhYmlsaXR5LmxldmVsKCkpLzEwMDtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICAgICAgICAgICAgICAgIGJyZWFrO1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgIC8vIG55eF9hc3Nhc3Npbl92ZW5kZXR0YSBcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICBjYXNlICdtb3ZlbWVudF9zcGVlZCc6XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIGlmIChhYmlsaXR5Lm5hbWUgPT0gJ255eF9hc3Nhc3Npbl92ZW5kZXR0YScpIHtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIHRvdGFsQXR0cmlidXRlICs9IHNlbGYuZ2V0QWJpbGl0eUF0dHJpYnV0ZVZhbHVlKHNlbGYuX2FiaWxpdGllc1tpXS5hdHRyaWJ1dGVzLCBhdHRyaWJ1dGUubmFtZSwgYWJpbGl0eS5sZXZlbCgpKS8xMDA7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgICAgICAgICAgICAgICBicmVhaztcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAvLyBzcGlyaXRfYnJlYWtlcl9lbXBvd2VyaW5nX2hhc3RlXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgY2FzZSAnYm9udXNfbW92ZXNwZWVkX3BjdCc6XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIGlmIChhYmlsaXR5Lm5hbWUgPT0gJ3NwaXJpdF9icmVha2VyX2VtcG93ZXJpbmdfaGFzdGUnKSB7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICB0b3RhbEF0dHJpYnV0ZSArPSBzZWxmLmdldEFiaWxpdHlBdHRyaWJ1dGVWYWx1ZShzZWxmLl9hYmlsaXRpZXNbaV0uYXR0cmlidXRlcywgYXR0cmlidXRlLm5hbWUsIGFiaWxpdHkubGV2ZWwoKSkvMTAwO1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgYnJlYWs7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgLy8gb2dyZV9tYWdpX2Jsb29kbHVzdCxkZWF0aF9wcm9waGV0X3dpdGNoY3JhZnQsa29ib2xkX3Rhc2ttYXN0ZXJfc3BlZWRfYXVyYVxuICAgICAgICAgICAgICAgICAgICAgICAgICAgIGNhc2UgJ2JvbnVzX21vdmVtZW50X3NwZWVkJzpcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgaWYgKGFiaWxpdHkubmFtZSA9PSAnb2dyZV9tYWdpX2Jsb29kbHVzdCcgfHwgYWJpbGl0eS5uYW1lID09ICdkZWF0aF9wcm9waGV0X3dpdGNoY3JhZnQnIHx8IGFiaWxpdHkubmFtZSA9PSAna29ib2xkX3Rhc2ttYXN0ZXJfc3BlZWRfYXVyYScpIHtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIHRvdGFsQXR0cmlidXRlICs9IHNlbGYuZ2V0QWJpbGl0eUF0dHJpYnV0ZVZhbHVlKHNlbGYuX2FiaWxpdGllc1tpXS5hdHRyaWJ1dGVzLCBhdHRyaWJ1dGUubmFtZSwgYWJpbGl0eS5sZXZlbCgpKS8xMDA7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgICAgICAgICAgICAgICBicmVhaztcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAvLyByYXpvcl91bnN0YWJsZV9jdXJyZW50LHBoYW50b21fbGFuY2VyX2RvcHBlbHdhbGtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICBjYXNlICdtb3ZlbWVudF9zcGVlZF9wY3QnOlxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBpZiAoYWJpbGl0eS5uYW1lID09ICdyYXpvcl91bnN0YWJsZV9jdXJyZW50JyB8fCBhYmlsaXR5Lm5hbWUgPT0gJ3BoYW50b21fbGFuY2VyX2RvcHBlbHdhbGsnKSB7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICB0b3RhbEF0dHJpYnV0ZSArPSBzZWxmLmdldEFiaWxpdHlBdHRyaWJ1dGVWYWx1ZShzZWxmLl9hYmlsaXRpZXNbaV0uYXR0cmlidXRlcywgYXR0cmlidXRlLm5hbWUsIGFiaWxpdHkubGV2ZWwoKSkvMTAwO1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgYnJlYWs7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgLy8gdHJlYW50X25hdHVyZXNfZ3Vpc2UsbG9uZV9kcnVpZF9yYWJpZFxuICAgICAgICAgICAgICAgICAgICAgICAgICAgIGNhc2UgJ2JvbnVzX21vdmVfc3BlZWQnOlxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBpZiAoYWJpbGl0eS5uYW1lID09ICd0cmVhbnRfbmF0dXJlc19ndWlzZScgfHwgYWJpbGl0eS5uYW1lID09ICdsb25lX2RydWlkX3JhYmlkJykge1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgdG90YWxBdHRyaWJ1dGUgKz0gc2VsZi5nZXRBYmlsaXR5QXR0cmlidXRlVmFsdWUoc2VsZi5fYWJpbGl0aWVzW2ldLmF0dHJpYnV0ZXMsIGF0dHJpYnV0ZS5uYW1lLCBhYmlsaXR5LmxldmVsKCkpLzEwMDtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICAgICAgICAgICAgICAgIGJyZWFrO1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgIC8vIHdpc3BfdGV0aGVyXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgY2FzZSAnbW92ZXNwZWVkJzpcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgaWYgKGFiaWxpdHkubmFtZSA9PSAnd2lzcF90ZXRoZXInKSB7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICB0b3RhbEF0dHJpYnV0ZSArPSBzZWxmLmdldEFiaWxpdHlBdHRyaWJ1dGVWYWx1ZShzZWxmLl9hYmlsaXRpZXNbaV0uYXR0cmlidXRlcywgYXR0cmlidXRlLm5hbWUsIGFiaWxpdHkubGV2ZWwoKSkvMTAwO1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgYnJlYWs7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgLy8ga3Vua2thX2dob3N0c2hpcCx2aXNhZ2VfZ3JhdmVfY2hpbGxcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICBjYXNlICdtb3Zlc3BlZWRfYm9udXMnOlxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBpZiAoYWJpbGl0eS5uYW1lID09ICdrdW5ra2FfZ2hvc3RzaGlwJyB8fCBhYmlsaXR5Lm5hbWUgPT0gJ3Zpc2FnZV9ncmF2ZV9jaGlsbCcpIHtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIHRvdGFsQXR0cmlidXRlICs9IHNlbGYuZ2V0QWJpbGl0eUF0dHJpYnV0ZVZhbHVlKHNlbGYuX2FiaWxpdGllc1tpXS5hdHRyaWJ1dGVzLCBhdHRyaWJ1dGUubmFtZSwgYWJpbGl0eS5sZXZlbCgpKS8xMDA7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIH0gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIFxuICAgICAgICAgICAgICAgICAgICAgICAgICAgIGJyZWFrO1xuICAgICAgICAgICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICAgIGVsc2UgaWYgKGFiaWxpdHkubW92ZW1lbnRTcGVlZFBjdCAhPSB1bmRlZmluZWQpIHtcbiAgICAgICAgICAgICAgICAvLyBheGVfYmF0dGxlX2h1bmdlcixicmlzdGxlYmFja193YXJwYXRoLHNwaXJpdF9icmVha2VyX2dyZWF0ZXJfYmFzaCxsaW5hX2ZpZXJ5X3NvdWwsaW52b2tlcl9naG9zdF93YWxrLGludm9rZXJfd2V4LGVsZGVyX3RpdGFuX2FuY2VzdHJhbF9zcGlyaXRcbiAgICAgICAgICAgICAgICAgICAgdG90YWxBdHRyaWJ1dGUrPWFiaWxpdHkubW92ZW1lbnRTcGVlZFBjdCgpLzEwMDtcbiAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICB9XG4gICAgICAgIH1cbiAgICAgICAgcmV0dXJuIHRvdGFsQXR0cmlidXRlO1xuICAgIH0pO1xuXG4gICAgc2VsZi5nZXRNb3ZlbWVudFNwZWVkUGVyY2VudFJlZHVjdGlvbiA9IGtvLmNvbXB1dGVkKGZ1bmN0aW9uICgpIHtcbiAgICAgICAgdmFyIHRvdGFsQXR0cmlidXRlID0gMDtcbiAgICAgICAgZm9yICh2YXIgaSA9IDA7IGkgPCBzZWxmLmFiaWxpdGllcygpLmxlbmd0aDsgaSsrKSB7XG4gICAgICAgICAgICB2YXIgYWJpbGl0eSA9IHNlbGYuX2FiaWxpdGllc1tpXTtcbiAgICAgICAgICAgIGlmIChhYmlsaXR5LmxldmVsKCkgPiAwICYmIChhYmlsaXR5LmlzQWN0aXZlKCkgfHwgKGFiaWxpdHkuYmVoYXZpb3IuaW5kZXhPZignRE9UQV9BQklMSVRZX0JFSEFWSU9SX1BBU1NJVkUnKSAhPSAtMSkpKSB7XG4gICAgICAgICAgICAgICAgaWYgKCEoYWJpbGl0eS5uYW1lIGluIHNlbGYuYWJpbGl0eURhdGEpKSB7XG4gICAgICAgICAgICAgICAgICAgIGZvciAodmFyIGogPSAwOyBqIDwgc2VsZi5fYWJpbGl0aWVzW2ldLmF0dHJpYnV0ZXMubGVuZ3RoOyBqKyspIHtcbiAgICAgICAgICAgICAgICAgICAgICAgIHZhciBhdHRyaWJ1dGUgPSBzZWxmLl9hYmlsaXRpZXNbaV0uYXR0cmlidXRlc1tqXTtcbiAgICAgICAgICAgICAgICAgICAgICAgIHN3aXRjaChhdHRyaWJ1dGUubmFtZSkge1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgIC8vIGNyeXN0YWxfbWFpZGVuX2ZyZWV6aW5nX2ZpZWxkXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgY2FzZSAnbW92ZXNwZWVkX3Nsb3cnOlxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBpZiAoYWJpbGl0eS5uYW1lID09ICdjcnlzdGFsX21haWRlbl9mcmVlemluZ19maWVsZCcgJiYgIXNlbGYuaGFzU2NlcHRlcigpKSB7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICB0b3RhbEF0dHJpYnV0ZSArPSBzZWxmLmdldEFiaWxpdHlBdHRyaWJ1dGVWYWx1ZShzZWxmLl9hYmlsaXRpZXNbaV0uYXR0cmlidXRlcywgYXR0cmlidXRlLm5hbWUsIGFiaWxpdHkubGV2ZWwoKSkvMTAwO1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgYnJlYWs7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgY2FzZSAnbW92ZXNwZWVkX3Nsb3dfc2NlcHRlcic6XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIGlmIChhYmlsaXR5Lm5hbWUgPT0gJ2NyeXN0YWxfbWFpZGVuX2ZyZWV6aW5nX2ZpZWxkJyAmJiBzZWxmLmhhc1NjZXB0ZXIoKSkge1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgdG90YWxBdHRyaWJ1dGUgKz0gc2VsZi5nZXRBYmlsaXR5QXR0cmlidXRlVmFsdWUoc2VsZi5fYWJpbGl0aWVzW2ldLmF0dHJpYnV0ZXMsIGF0dHJpYnV0ZS5uYW1lLCBhYmlsaXR5LmxldmVsKCkpLzEwMDtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICAgICAgICAgICAgICAgIGJyZWFrO1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgIC8vIGVsZGVyX3RpdGFuX2VhcnRoX3NwbGl0dGVyLG1hZ25hdGF1cl9za2V3ZXIsYWJhZGRvbl9mcm9zdG1vdXJuZSBcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICBjYXNlICdzbG93X3BjdCc6XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIHRvdGFsQXR0cmlidXRlIC09IHNlbGYuZ2V0QWJpbGl0eUF0dHJpYnV0ZVZhbHVlKHNlbGYuX2FiaWxpdGllc1tpXS5hdHRyaWJ1dGVzLCBhdHRyaWJ1dGUubmFtZSwgYWJpbGl0eS5sZXZlbCgpKS8xMDA7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgYnJlYWs7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgLy8gbmlnaHRfc3RhbGtlcl92b2lkLGNyeXN0YWxfbWFpZGVuX2NyeXN0YWxfbm92YSxnaG9zdF9mcm9zdF9hdHRhY2ssb2dyZV9tYWdpX2Zyb3N0X2FybW9yLHBvbGFyX2Z1cmJvbGdfdXJzYV93YXJyaW9yX3RodW5kZXJfY2xhcFxuICAgICAgICAgICAgICAgICAgICAgICAgICAgIGNhc2UgJ21vdmVzcGVlZF9zbG93JzpcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgaWYgKGFiaWxpdHkubmFtZSAhPSAnY3J5c3RhbF9tYWlkZW5fZnJlZXppbmdfZmllbGQnKSB7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICB0b3RhbEF0dHJpYnV0ZSArPSBzZWxmLmdldEFiaWxpdHlBdHRyaWJ1dGVWYWx1ZShzZWxmLl9hYmlsaXRpZXNbaV0uYXR0cmlidXRlcywgYXR0cmlidXRlLm5hbWUsIGFiaWxpdHkubGV2ZWwoKSkvMTAwO1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgYnJlYWs7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgLy8gbGljaF9mcm9zdF9hcm1vcixsaWNoX2Zyb3N0X25vdmEsZW5jaGFudHJlc3NfZW5jaGFudFxuICAgICAgICAgICAgICAgICAgICAgICAgICAgIGNhc2UgJ3Nsb3dfbW92ZW1lbnRfc3BlZWQnOlxuICAgICAgICAgICAgICAgICAgICAgICAgICAgIC8vIGJlYXN0bWFzdGVyX3ByaW1hbF9yb2FyXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgY2FzZSAnc2xvd19tb3ZlbWVudF9zcGVlZF9wY3QnOlxuICAgICAgICAgICAgICAgICAgICAgICAgICAgIC8vIGRyb3dfcmFuZ2VyX2Zyb3N0X2Fycm93c1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgIGNhc2UgJ2Zyb3N0X2Fycm93c19tb3ZlbWVudF9zcGVlZCc6XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgLy8gc2tlbGV0b25fa2luZ19oZWxsZmlyZV9ibGFzdFxuICAgICAgICAgICAgICAgICAgICAgICAgICAgIGNhc2UgJ2JsYXN0X3Nsb3cnOlxuICAgICAgICAgICAgICAgICAgICAgICAgICAgIC8vIHNsYXJkYXJfc2xpdGhlcmVlbl9jcnVzaFxuICAgICAgICAgICAgICAgICAgICAgICAgICAgIGNhc2UgJ2NydXNoX2V4dHJhX3Nsb3cnOlxuICAgICAgICAgICAgICAgICAgICAgICAgICAgIC8vIHN0b3JtX3NwaXJpdF9vdmVybG9hZDpcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICBjYXNlICdvdmVybG9hZF9tb3ZlX3Nsb3cnOlxuICAgICAgICAgICAgICAgICAgICAgICAgICAgIC8vIHdpbmRydW5uZXJfd2luZHJ1blxuICAgICAgICAgICAgICAgICAgICAgICAgICAgIGNhc2UgJ2VuZW15X21vdmVzcGVlZF9ib251c19wY3QnOlxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICB0b3RhbEF0dHJpYnV0ZSArPSBzZWxmLmdldEFiaWxpdHlBdHRyaWJ1dGVWYWx1ZShzZWxmLl9hYmlsaXRpZXNbaV0uYXR0cmlidXRlcywgYXR0cmlidXRlLm5hbWUsIGFiaWxpdHkubGV2ZWwoKSkvMTAwO1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgIGJyZWFrO1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgIC8vIHBoYW50b21fYXNzYXNzaW5fc3RpZmxpbmdfZGFnZ2VyLHR1c2tfZnJvemVuX3NpZ2lsXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgY2FzZSAnbW92ZV9zbG93JzpcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgaWYgKGFiaWxpdHkubmFtZSA9PSAncGhhbnRvbV9hc3Nhc3Npbl9zdGlmbGluZ19kYWdnZXInKSB7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICB0b3RhbEF0dHJpYnV0ZSArPSBzZWxmLmdldEFiaWxpdHlBdHRyaWJ1dGVWYWx1ZShzZWxmLl9hYmlsaXRpZXNbaV0uYXR0cmlidXRlcywgYXR0cmlidXRlLm5hbWUsIGFiaWxpdHkubGV2ZWwoKSkvMTAwO1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIGVsc2UgaWYgKGFiaWxpdHkubmFtZSA9PSAndHVza19mcm96ZW5fc2lnaWwnKSB7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICB0b3RhbEF0dHJpYnV0ZSAtPSBzZWxmLmdldEFiaWxpdHlBdHRyaWJ1dGVWYWx1ZShzZWxmLl9hYmlsaXRpZXNbaV0uYXR0cmlidXRlcywgYXR0cmlidXRlLm5hbWUsIGFiaWxpdHkubGV2ZWwoKSkvMTAwO1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgYnJlYWs7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgLy8gaW52b2tlcl9pY2Vfd2FsbCxtZWR1c2Ffc3RvbmVfZ2F6ZSx3aXNwX3RldGhlclxuICAgICAgICAgICAgICAgICAgICAgICAgICAgIGNhc2UgJ3Nsb3cnOlxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBpZiAoYWJpbGl0eS5uYW1lID09ICdtZWR1c2Ffc3RvbmVfZ2F6ZScpIHtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIHRvdGFsQXR0cmlidXRlIC09IHNlbGYuZ2V0QWJpbGl0eUF0dHJpYnV0ZVZhbHVlKHNlbGYuX2FiaWxpdGllc1tpXS5hdHRyaWJ1dGVzLCBhdHRyaWJ1dGUubmFtZSwgYWJpbGl0eS5sZXZlbCgpKS8xMDA7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgZWxzZSB7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICB0b3RhbEF0dHJpYnV0ZSArPSBzZWxmLmdldEFiaWxpdHlBdHRyaWJ1dGVWYWx1ZShzZWxmLl9hYmlsaXRpZXNbaV0uYXR0cmlidXRlcywgYXR0cmlidXRlLm5hbWUsIGFiaWxpdHkubGV2ZWwoKSkvMTAwO1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgYnJlYWs7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgLy8gYnJvb2Rtb3RoZXJfaW5jYXBhY2l0YXRpbmdfYml0ZSxib3VudHlfaHVudGVyX2ppbmFkYSxzcGVjdHJlX3NwZWN0cmFsX2RhZ2dlcix3aW50ZXJfd3l2ZXJuX2FyY3RpY19idXJuXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgY2FzZSAnYm9udXNfbW92ZXNwZWVkJzpcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgaWYgKGFiaWxpdHkubmFtZSA9PSAnYnJvb2Rtb3RoZXJfaW5jYXBhY2l0YXRpbmdfYml0ZScgfHwgYWJpbGl0eS5uYW1lID09ICdib3VudHlfaHVudGVyX2ppbmFkYScgfHwgYWJpbGl0eS5uYW1lID09ICd3aW50ZXJfd3l2ZXJuX2FyY3RpY19idXJuJyB8fCBhYmlsaXR5Lm5hbWUgPT0gJ3dpbnRlcl93eXZlcm5fc3BsaW50ZXJfYmxhc3QnKSB7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICB0b3RhbEF0dHJpYnV0ZSArPSBzZWxmLmdldEFiaWxpdHlBdHRyaWJ1dGVWYWx1ZShzZWxmLl9hYmlsaXRpZXNbaV0uYXR0cmlidXRlcywgYXR0cmlidXRlLm5hbWUsIGFiaWxpdHkubGV2ZWwoKSkvMTAwO1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIGVsc2UgaWYgKGFiaWxpdHkubmFtZSA9PSAnc3BlY3RyZV9zcGVjdHJhbF9kYWdnZXInKSB7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICB0b3RhbEF0dHJpYnV0ZSAtPSBzZWxmLmdldEFiaWxpdHlBdHRyaWJ1dGVWYWx1ZShzZWxmLl9hYmlsaXRpZXNbaV0uYXR0cmlidXRlcywgYXR0cmlidXRlLm5hbWUsIGFiaWxpdHkubGV2ZWwoKSkvMTAwO1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgYnJlYWs7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgLy8gb21uaWtuaWdodF9kZWdlbl9hdXJhXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgY2FzZSAnc3BlZWRfYm9udXMnOlxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBpZiAoYWJpbGl0eS5uYW1lID09ICdvbW5pa25pZ2h0X2RlZ2VuX2F1cmEnKSB7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICB0b3RhbEF0dHJpYnV0ZSArPSBzZWxmLmdldEFiaWxpdHlBdHRyaWJ1dGVWYWx1ZShzZWxmLl9hYmlsaXRpZXNbaV0uYXR0cmlidXRlcywgYXR0cmlidXRlLm5hbWUsIGFiaWxpdHkubGV2ZWwoKSkvMTAwO1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgYnJlYWs7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgLy8gdGlkZWh1bnRlcl9ndXNoXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgY2FzZSAnbW92ZW1lbnRfc3BlZWQnOlxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBpZiAoYWJpbGl0eS5uYW1lID09ICd0aWRlaHVudGVyX2d1c2gnKSB7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICB0b3RhbEF0dHJpYnV0ZSArPSBzZWxmLmdldEFiaWxpdHlBdHRyaWJ1dGVWYWx1ZShzZWxmLl9hYmlsaXRpZXNbaV0uYXR0cmlidXRlcywgYXR0cmlidXRlLm5hbWUsIGFiaWxpdHkubGV2ZWwoKSkvMTAwO1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgYnJlYWs7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgLy8gcHVnbmFfZGVjcmVwaWZ5LGNoZW5fcGVuaXRlbmNlXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgY2FzZSAnYm9udXNfbW92ZW1lbnRfc3BlZWQnOlxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBpZiAoYWJpbGl0eS5uYW1lID09ICdwdWduYV9kZWNyZXBpZnknIHx8IGFiaWxpdHkubmFtZSA9PSAnY2hlbl9wZW5pdGVuY2UnKSB7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICB0b3RhbEF0dHJpYnV0ZSArPSBzZWxmLmdldEFiaWxpdHlBdHRyaWJ1dGVWYWx1ZShzZWxmLl9hYmlsaXRpZXNbaV0uYXR0cmlidXRlcywgYXR0cmlidXRlLm5hbWUsIGFiaWxpdHkubGV2ZWwoKSkvMTAwO1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgYnJlYWs7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgLy8gYW5jaWVudF9hcHBhcml0aW9uX2ljZV92b3J0ZXgscGhhbnRvbV9sYW5jZXJfc3Bpcml0X2xhbmNlLHNreXdyYXRoX21hZ2VfY29uY3Vzc2l2ZV9zaG90LGZhY2VsZXNzX3ZvaWRfdGltZV93YWxrXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgY2FzZSAnbW92ZW1lbnRfc3BlZWRfcGN0JzpcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgaWYgKGFiaWxpdHkubmFtZSA9PSAnYW5jaWVudF9hcHBhcml0aW9uX2ljZV92b3J0ZXgnIHx8IGFiaWxpdHkubmFtZSA9PSAncGhhbnRvbV9sYW5jZXJfc3Bpcml0X2xhbmNlJyB8fCBhYmlsaXR5Lm5hbWUgPT0gJ2ZhY2VsZXNzX3ZvaWRfdGltZV93YWxrJykge1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgdG90YWxBdHRyaWJ1dGUgKz0gc2VsZi5nZXRBYmlsaXR5QXR0cmlidXRlVmFsdWUoc2VsZi5fYWJpbGl0aWVzW2ldLmF0dHJpYnV0ZXMsIGF0dHJpYnV0ZS5uYW1lLCBhYmlsaXR5LmxldmVsKCkpLzEwMDtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBlbHNlIGlmIChhYmlsaXR5Lm5hbWUgPT0gJ3NreXdyYXRoX21hZ2VfY29uY3Vzc2l2ZV9zaG90Jykge1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgdG90YWxBdHRyaWJ1dGUgLT0gc2VsZi5nZXRBYmlsaXR5QXR0cmlidXRlVmFsdWUoc2VsZi5fYWJpbGl0aWVzW2ldLmF0dHJpYnV0ZXMsIGF0dHJpYnV0ZS5uYW1lLCBhYmlsaXR5LmxldmVsKCkpLzEwMDtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICAgICAgICAgICAgICAgIGJyZWFrO1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgIC8vIHJhem9yX3Vuc3RhYmxlX2N1cnJlbnRcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICBjYXNlICdzbG93X2Ftb3VudCc6XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIGlmIChhYmlsaXR5Lm5hbWUgPT0gJ3Jhem9yX3Vuc3RhYmxlX2N1cnJlbnQnKSB7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICB0b3RhbEF0dHJpYnV0ZSArPSBzZWxmLmdldEFiaWxpdHlBdHRyaWJ1dGVWYWx1ZShzZWxmLl9hYmlsaXRpZXNbaV0uYXR0cmlidXRlcywgYXR0cmlidXRlLm5hbWUsIGFiaWxpdHkubGV2ZWwoKSkvMTAwO1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgYnJlYWs7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgLy8gYnJld21hc3Rlcl9kcnVua2VuX2hhemUsYnJld21hc3Rlcl90aHVuZGVyX2NsYXAsdHJlYW50X2xlZWNoX3NlZWRcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICBjYXNlICdtb3ZlbWVudF9zbG93JzpcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgaWYgKGFiaWxpdHkubmFtZSA9PSAnYnJld21hc3Rlcl9kcnVua2VuX2hhemUnIHx8IGFiaWxpdHkubmFtZSA9PSAnYnJld21hc3Rlcl90aHVuZGVyX2NsYXAnKSB7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICB0b3RhbEF0dHJpYnV0ZSAtPSBzZWxmLmdldEFiaWxpdHlBdHRyaWJ1dGVWYWx1ZShzZWxmLl9hYmlsaXRpZXNbaV0uYXR0cmlidXRlcywgYXR0cmlidXRlLm5hbWUsIGFiaWxpdHkubGV2ZWwoKSkvMTAwO1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIGVsc2UgaWYgKGFiaWxpdHkubmFtZSA9PSAndXJzYV9lYXJ0aHNob2NrJyB8fCBhYmlsaXR5Lm5hbWUgPT0gJ3RyZWFudF9sZWVjaF9zZWVkJykge1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgdG90YWxBdHRyaWJ1dGUgKz0gc2VsZi5nZXRBYmlsaXR5QXR0cmlidXRlVmFsdWUoc2VsZi5fYWJpbGl0aWVzW2ldLmF0dHJpYnV0ZXMsIGF0dHJpYnV0ZS5uYW1lLCBhYmlsaXR5LmxldmVsKCkpLzEwMDtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICAgICAgICAgICAgICAgIGJyZWFrO1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgIC8vIHNrZWxldG9uX2tpbmdfcmVpbmNhcm5hdGlvblxuICAgICAgICAgICAgICAgICAgICAgICAgICAgIGNhc2UgJ21vdmVzcGVlZCc6XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIGlmIChhYmlsaXR5Lm5hbWUgPT0gJ3NrZWxldG9uX2tpbmdfcmVpbmNhcm5hdGlvbicpIHtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIHRvdGFsQXR0cmlidXRlICs9IHNlbGYuZ2V0QWJpbGl0eUF0dHJpYnV0ZVZhbHVlKHNlbGYuX2FiaWxpdGllc1tpXS5hdHRyaWJ1dGVzLCBhdHRyaWJ1dGUubmFtZSwgYWJpbGl0eS5sZXZlbCgpKS8xMDA7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgICAgICAgICAgICAgICBicmVhaztcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAvLyBrdW5ra2FfdG9ycmVudCx2aXNhZ2VfZ3JhdmVfY2hpbGxcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICBjYXNlICdtb3Zlc3BlZWRfYm9udXMnOlxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBpZiAoYWJpbGl0eS5uYW1lID09ICdrdW5ra2FfdG9ycmVudCcpIHtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIHRvdGFsQXR0cmlidXRlICs9IHNlbGYuZ2V0QWJpbGl0eUF0dHJpYnV0ZVZhbHVlKHNlbGYuX2FiaWxpdGllc1tpXS5hdHRyaWJ1dGVzLCBhdHRyaWJ1dGUubmFtZSwgYWJpbGl0eS5sZXZlbCgpKS8xMDA7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgZWxzZSBpZiAoYWJpbGl0eS5uYW1lID09ICd2aXNhZ2VfZ3JhdmVfY2hpbGwnKSB7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICB0b3RhbEF0dHJpYnV0ZSAtPSBzZWxmLmdldEFiaWxpdHlBdHRyaWJ1dGVWYWx1ZShzZWxmLl9hYmlsaXRpZXNbaV0uYXR0cmlidXRlcywgYXR0cmlidXRlLm5hbWUsIGFiaWxpdHkubGV2ZWwoKSkvMTAwO1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgYnJlYWs7XG4gICAgICAgICAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgICAgICAgaWYgKGFiaWxpdHkubmFtZSA9PSAnc2F0eXJfdHJpY2tzdGVyX3B1cmdlJykge1xuICAgICAgICAgICAgICAgICAgICAgICAgdG90YWxBdHRyaWJ1dGUgLT0gODAvMTAwO1xuICAgICAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgICAgICAgIGVsc2UgaWYgKGFiaWxpdHkubmFtZSA9PSAnZW5yYWdlZF93aWxka2luX3Rvcm5hZG8nKSB7XG4gICAgICAgICAgICAgICAgICAgICAgICB0b3RhbEF0dHJpYnV0ZSAtPSAxNS8xMDA7XG4gICAgICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgICAgZWxzZSBpZiAoYWJpbGl0eS5tb3ZlbWVudFNwZWVkUGN0UmVkdWN0aW9uICE9IHVuZGVmaW5lZCkge1xuICAgICAgICAgICAgICAgICAgICAvLyBheGVfYmF0dGxlX2h1bmdlcixiYXRyaWRlcl9zdGlja3lfbmFwYWxtLHNocmVkZGVyX2NoYWtyYW0sbWVlcG9fZ2Vvc3RyaWtlLGxpZmVfc3RlYWxlcl9vcGVuX3dvdW5kcyxcbiAgICAgICAgICAgICAgICAgICAgLy8gdmVub21hbmNlcl9wb2lzb25fc3RpbmcsdmlwZXJfdmlwZXJfc3RyaWtlLHZpcGVyX2NvcnJvc2l2ZV9za2luLHZpcGVyX3BvaXNvbl9hdHRhY2ssdmVub21hbmNlcl92ZW5vbW91c19nYWxlLHRyZWFudF9sZWVjaF9zZWVkXG4gICAgICAgICAgICAgICAgICAgIC8vIGxpY2hfY2hhaW5fZnJvc3Qsc25pcGVyX3NocmFwbmVsLGNlbnRhdXJfc3RhbXBlZGUsaHVza2FyX2xpZmVfYnJlYWssamFraXJvX2R1YWxfYnJlYXRoLG1lZXBvX2dlb3N0cmlrZSxzYW5ka2luZ19lcGljZW50ZXJcbiAgICAgICAgICAgICAgICAgICAgLy8gZWFydGhfc3Bpcml0X3JvbGxpbmdfYm91bGRlcixpbnZva2VyX2dob3N0X3dhbGssaW52b2tlcl9pY2Vfd2FsbCxlbGRlcl90aXRhbl9lYXJ0aF9zcGxpdHRlclxuICAgICAgICAgICAgICAgICAgICAvLyB1bmR5aW5nX2ZsZXNoX2dvbGVtLHRlbXBsYXJfYXNzYXNzaW5fcHNpb25pY190cmFwLG5ldmVybW9yZV9yZXF1aWVtLHF1ZWVub2ZwYWluX3NoYWRvd19zdHJpa2VcbiAgICAgICAgICAgICAgICAgICAgdG90YWxBdHRyaWJ1dGUrPWFiaWxpdHkubW92ZW1lbnRTcGVlZFBjdFJlZHVjdGlvbigpLzEwMDtcbiAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICB9XG4gICAgICAgIH1cbiAgICAgICAgcmV0dXJuIHRvdGFsQXR0cmlidXRlO1xuICAgIH0pO1xuXG4gICAgc2VsZi5nZXRUdXJuUmF0ZVJlZHVjdGlvbiA9IGtvLmNvbXB1dGVkKGZ1bmN0aW9uICgpIHtcbiAgICAgICAgdmFyIHRvdGFsQXR0cmlidXRlID0gMDtcbiAgICAgICAgZm9yICh2YXIgaSA9IDA7IGkgPCBzZWxmLmFiaWxpdGllcygpLmxlbmd0aDsgaSsrKSB7XG4gICAgICAgICAgICB2YXIgYWJpbGl0eSA9IHNlbGYuX2FiaWxpdGllc1tpXTtcbiAgICAgICAgICAgIGlmIChhYmlsaXR5LmxldmVsKCkgPiAwICYmIChhYmlsaXR5LmlzQWN0aXZlKCkgfHwgKGFiaWxpdHkuYmVoYXZpb3IuaW5kZXhPZignRE9UQV9BQklMSVRZX0JFSEFWSU9SX1BBU1NJVkUnKSAhPSAtMSkpKSB7XG4gICAgICAgICAgICAgICAgaWYgKCEoYWJpbGl0eS5uYW1lIGluIHNlbGYuYWJpbGl0eURhdGEpKSB7XG4gICAgICAgICAgICAgICAgICAgIGZvciAodmFyIGogPSAwOyBqIDwgc2VsZi5fYWJpbGl0aWVzW2ldLmF0dHJpYnV0ZXMubGVuZ3RoOyBqKyspIHtcbiAgICAgICAgICAgICAgICAgICAgICAgIHZhciBhdHRyaWJ1dGUgPSBzZWxmLl9hYmlsaXRpZXNbaV0uYXR0cmlidXRlc1tqXTtcbiAgICAgICAgICAgICAgICAgICAgICAgIHN3aXRjaChhdHRyaWJ1dGUubmFtZSkge1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgIC8vIG1lZHVzYV9zdG9uZV9nYXplXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgY2FzZSAnc2xvdyc6XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIGlmIChhYmlsaXR5Lm5hbWUgPT0gJ21lZHVzYV9zdG9uZV9nYXplJykge1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgdG90YWxBdHRyaWJ1dGUgLT0gc2VsZi5nZXRBYmlsaXR5QXR0cmlidXRlVmFsdWUoc2VsZi5fYWJpbGl0aWVzW2ldLmF0dHJpYnV0ZXMsIGF0dHJpYnV0ZS5uYW1lLCBhYmlsaXR5LmxldmVsKCkpLzEwMDtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICAgICAgICAgICAgICAgIGJyZWFrO1xuICAgICAgICAgICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICAgIGVsc2UgaWYgKGFiaWxpdHkudHVyblJhdGVSZWR1Y3Rpb24gIT0gdW5kZWZpbmVkKSB7XG4gICAgICAgICAgICAgICAgICAgIC8vIGJhdHJpZGVyX3N0aWNreV9uYXBhbG1cbiAgICAgICAgICAgICAgICAgICAgdG90YWxBdHRyaWJ1dGUrPWFiaWxpdHkudHVyblJhdGVSZWR1Y3Rpb24oKS8xMDA7XG4gICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgfVxuICAgICAgICB9XG4gICAgICAgIHJldHVybiB0b3RhbEF0dHJpYnV0ZTtcbiAgICB9KTtcbiAgICBcbiAgICBzZWxmLmdldFZpc2lvblJhbmdlTmlnaHQgPSBrby5jb21wdXRlZChmdW5jdGlvbiAoKSB7XG4gICAgICAgIHZhciB0b3RhbEF0dHJpYnV0ZSA9IDA7XG4gICAgICAgIGZvciAodmFyIGkgPSAwOyBpIDwgc2VsZi5hYmlsaXRpZXMoKS5sZW5ndGg7IGkrKykge1xuICAgICAgICAgICAgdmFyIGFiaWxpdHkgPSBzZWxmLl9hYmlsaXRpZXNbaV07XG4gICAgICAgICAgICBpZiAoYWJpbGl0eS5sZXZlbCgpID4gMCAmJiAoYWJpbGl0eS5pc0FjdGl2ZSgpIHx8IChhYmlsaXR5LmJlaGF2aW9yLmluZGV4T2YoJ0RPVEFfQUJJTElUWV9CRUhBVklPUl9QQVNTSVZFJykgIT0gLTEpKSkge1xuICAgICAgICAgICAgICAgIGlmICghKGFiaWxpdHkubmFtZSBpbiBzZWxmLmFiaWxpdHlEYXRhKSkge1xuICAgICAgICAgICAgICAgICAgICBmb3IgKHZhciBqID0gMDsgaiA8IHNlbGYuX2FiaWxpdGllc1tpXS5hdHRyaWJ1dGVzLmxlbmd0aDsgaisrKSB7XG4gICAgICAgICAgICAgICAgICAgICAgICB2YXIgYXR0cmlidXRlID0gc2VsZi5fYWJpbGl0aWVzW2ldLmF0dHJpYnV0ZXNbal07XG4gICAgICAgICAgICAgICAgICAgICAgICBzd2l0Y2goYXR0cmlidXRlLm5hbWUpIHtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAvLyB3aW50ZXJfd3l2ZXJuX2FyY3RpY19idXJuXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgY2FzZSAnbmlnaHRfdmlzaW9uX2JvbnVzJzpcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAvLyBseWNhbl9zaGFwZXNoaWZ0LGx1bmFfbHVuYXJfYmxlc3NpbmdcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICBjYXNlICdib251c19uaWdodF92aXNpb24nOlxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICB0b3RhbEF0dHJpYnV0ZSArPSBzZWxmLmdldEFiaWxpdHlBdHRyaWJ1dGVWYWx1ZShzZWxmLl9hYmlsaXRpZXNbaV0uYXR0cmlidXRlcywgYXR0cmlidXRlLm5hbWUsIGFiaWxpdHkubGV2ZWwoKSk7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgYnJlYWs7XG4gICAgICAgICAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgICAgZWxzZSBpZiAoYWJpbGl0eS52aXNpb25uaWdodCAhPSB1bmRlZmluZWQpIHtcbiAgICAgICAgICAgICAgICAgICAgLy8gXG4gICAgICAgICAgICAgICAgICAgIHRvdGFsQXR0cmlidXRlKz1hYmlsaXR5LnZpc2lvbm5pZ2h0KCk7XG4gICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgfVxuICAgICAgICB9XG4gICAgICAgIHJldHVybiB0b3RhbEF0dHJpYnV0ZTtcbiAgICB9KTtcblxuICAgIHNlbGYuZ2V0VmlzaW9uUmFuZ2VQY3RSZWR1Y3Rpb24gPSBrby5jb21wdXRlZChmdW5jdGlvbiAoKSB7XG4gICAgICAgIHZhciB0b3RhbEF0dHJpYnV0ZSA9IDA7XG4gICAgICAgIGZvciAodmFyIGkgPSAwOyBpIDwgc2VsZi5hYmlsaXRpZXMoKS5sZW5ndGg7IGkrKykge1xuICAgICAgICAgICAgdmFyIGFiaWxpdHkgPSBzZWxmLl9hYmlsaXRpZXNbaV07XG4gICAgICAgICAgICBpZiAoYWJpbGl0eS5sZXZlbCgpID4gMCAmJiAoYWJpbGl0eS5pc0FjdGl2ZSgpIHx8IChhYmlsaXR5LmJlaGF2aW9yLmluZGV4T2YoJ0RPVEFfQUJJTElUWV9CRUhBVklPUl9QQVNTSVZFJykgIT0gLTEpKSkge1xuICAgICAgICAgICAgICAgIGlmICghKGFiaWxpdHkubmFtZSBpbiBzZWxmLmFiaWxpdHlEYXRhKSkge1xuICAgICAgICAgICAgICAgICAgICBmb3IgKHZhciBqID0gMDsgaiA8IHNlbGYuX2FiaWxpdGllc1tpXS5hdHRyaWJ1dGVzLmxlbmd0aDsgaisrKSB7XG4gICAgICAgICAgICAgICAgICAgICAgICB2YXIgYXR0cmlidXRlID0gc2VsZi5fYWJpbGl0aWVzW2ldLmF0dHJpYnV0ZXNbal07XG4gICAgICAgICAgICAgICAgICAgICAgICBzd2l0Y2goYXR0cmlidXRlLm5hbWUpIHtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAvLyBuaWdodF9zdGFsa2VyX2RhcmtuZXNzXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgY2FzZSAnYmxpbmRfcGVyY2VudGFnZSc6XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIHRvdGFsQXR0cmlidXRlICs9IHNlbGYuZ2V0QWJpbGl0eUF0dHJpYnV0ZVZhbHVlKHNlbGYuX2FiaWxpdGllc1tpXS5hdHRyaWJ1dGVzLCBhdHRyaWJ1dGUubmFtZSwgYWJpbGl0eS5sZXZlbCgpKS8xMDA7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgYnJlYWs7XG4gICAgICAgICAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICB9XG4gICAgICAgIH1cbiAgICAgICAgcmV0dXJuIHRvdGFsQXR0cmlidXRlO1xuICAgIH0pO1xuXG4gICAgc2VsZi5zZXRFdmFzaW9uID0ga28uY29tcHV0ZWQoZnVuY3Rpb24gKCkge1xuICAgICAgICB2YXIgdG90YWxBdHRyaWJ1dGUgPSAwO1xuICAgICAgICBmb3IgKHZhciBpID0gMDsgaSA8IHNlbGYuYWJpbGl0aWVzKCkubGVuZ3RoOyBpKyspIHtcbiAgICAgICAgICAgIHZhciBhYmlsaXR5ID0gc2VsZi5fYWJpbGl0aWVzW2ldO1xuICAgICAgICAgICAgaWYgKGFiaWxpdHkubGV2ZWwoKSA+IDAgJiYgKGFiaWxpdHkuaXNBY3RpdmUoKSB8fCAoYWJpbGl0eS5iZWhhdmlvci5pbmRleE9mKCdET1RBX0FCSUxJVFlfQkVIQVZJT1JfUEFTU0lWRScpICE9IC0xKSkpIHtcbiAgICAgICAgICAgICAgICBpZiAoYWJpbGl0eS5uYW1lID09ICd3aW5kcnVubmVyX3dpbmRydW4nKSB7XG4gICAgICAgICAgICAgICAgICAgIHJldHVybiAxO1xuICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgIH1cbiAgICAgICAgfVxuICAgICAgICByZXR1cm4gdG90YWxBdHRyaWJ1dGU7XG4gICAgfSk7XG4gICAgXG4gICAgc2VsZi5zZXRNb3ZlbWVudFNwZWVkID0ga28uY29tcHV0ZWQoZnVuY3Rpb24gKCkge1xuICAgICAgICB2YXIgTUFYX01PVkVTUEVFRCA9IDUyMjtcbiAgICAgICAgdmFyIE1JTl9NT1ZFU1BFRUQgPSAxMDA7XG4gICAgICAgIHZhciB0b3RhbEF0dHJpYnV0ZSA9IDA7XG4gICAgICAgIGZvciAodmFyIGkgPSAwOyBpIDwgc2VsZi5hYmlsaXRpZXMoKS5sZW5ndGg7IGkrKykge1xuICAgICAgICAgICAgdmFyIGFiaWxpdHkgPSBzZWxmLl9hYmlsaXRpZXNbaV07XG4gICAgICAgICAgICBpZiAoYWJpbGl0eS5sZXZlbCgpID4gMCAmJiAoYWJpbGl0eS5pc0FjdGl2ZSgpIHx8IChhYmlsaXR5LmJlaGF2aW9yLmluZGV4T2YoJ0RPVEFfQUJJTElUWV9CRUhBVklPUl9QQVNTSVZFJykgIT0gLTEpKSkge1xuICAgICAgICAgICAgICAgIGlmIChhYmlsaXR5Lm5hbWUgPT0gJ3NwaXJpdF9icmVha2VyX2NoYXJnZV9vZl9kYXJrbmVzcycpIHtcbiAgICAgICAgICAgICAgICAgICAgcmV0dXJuIHNlbGYuZ2V0QWJpbGl0eUF0dHJpYnV0ZVZhbHVlKGFiaWxpdHkuYXR0cmlidXRlcywgJ21vdmVtZW50X3NwZWVkJywgYWJpbGl0eS5sZXZlbCgpKTtcbiAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgICAgaWYgKGFiaWxpdHkubmFtZSA9PSAnZGFya19zZWVyX3N1cmdlJykge1xuICAgICAgICAgICAgICAgICAgICByZXR1cm4gTUFYX01PVkVTUEVFRDtcbiAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgICAgaWYgKGFiaWxpdHkubmFtZSA9PSAnY2VudGF1cl9zdGFtcGVkZScpIHtcbiAgICAgICAgICAgICAgICAgICAgcmV0dXJuIE1BWF9NT1ZFU1BFRUQ7XG4gICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICAgIGlmIChhYmlsaXR5Lm5hbWUgPT0gJ2x5Y2FuX3NoYXBlc2hpZnQnKSB7XG4gICAgICAgICAgICAgICAgICAgIHJldHVybiBNQVhfTU9WRVNQRUVEO1xuICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgICBpZiAoYWJpbGl0eS5uYW1lID09ICdsaW9uX3Zvb2RvbycgfHwgYWJpbGl0eS5uYW1lID09ICdzaGFkb3dfc2hhbWFuX3Zvb2RvbycpIHtcbiAgICAgICAgICAgICAgICAgICAgcmV0dXJuIE1JTl9NT1ZFU1BFRUQ7XG4gICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgfVxuICAgICAgICB9XG4gICAgICAgIHJldHVybiB0b3RhbEF0dHJpYnV0ZTtcbiAgICB9KTtcblxuICAgIHNlbGYuZ2V0QmFzaFNvdXJjZSA9IGZ1bmN0aW9uIChhdHRhY2t0eXBlKSB7XG4gICAgICAgIHZhciBzb3VyY2VzID0ge307XG4gICAgICAgIGZvciAodmFyIGkgPSAwOyBpIDwgc2VsZi5hYmlsaXRpZXMoKS5sZW5ndGg7IGkrKykge1xuICAgICAgICAgICAgdmFyIGFiaWxpdHkgPSBzZWxmLl9hYmlsaXRpZXNbaV07XG4gICAgICAgICAgICBpZiAoYWJpbGl0eS5sZXZlbCgpID4gMCAmJiAoYWJpbGl0eS5pc0FjdGl2ZSgpIHx8IChhYmlsaXR5LmJlaGF2aW9yLmluZGV4T2YoJ0RPVEFfQUJJTElUWV9CRUhBVklPUl9QQVNTSVZFJykgIT0gLTEpKSkge1xuICAgICAgICAgICAgICAgIGlmICghKGFiaWxpdHkubmFtZSBpbiBzZWxmLmFiaWxpdHlEYXRhKSkge1xuICAgICAgICAgICAgICAgICAgICBmb3IgKHZhciBqID0gMDsgaiA8IHNlbGYuX2FiaWxpdGllc1tpXS5hdHRyaWJ1dGVzLmxlbmd0aDsgaisrKSB7XG4gICAgICAgICAgICAgICAgICAgICAgICB2YXIgYXR0cmlidXRlID0gc2VsZi5fYWJpbGl0aWVzW2ldLmF0dHJpYnV0ZXNbal07XG4gICAgICAgICAgICAgICAgICAgICAgICBzd2l0Y2goYXR0cmlidXRlLm5hbWUpIHtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAvLyBzbmlwZXJfaGVhZHNob3RcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICBjYXNlICdwcm9jX2NoYW5jZSc6XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIGlmIChzb3VyY2VzW2FiaWxpdHkubmFtZV0gPT0gdW5kZWZpbmVkICYmIGFiaWxpdHkubmFtZSA9PSAnc25pcGVyX2hlYWRzaG90Jykge1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgc291cmNlc1thYmlsaXR5Lm5hbWVdID0ge1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICdjaGFuY2UnOiBzZWxmLmdldEFiaWxpdHlBdHRyaWJ1dGVWYWx1ZShhYmlsaXR5LmF0dHJpYnV0ZXMsIGF0dHJpYnV0ZS5uYW1lLCBhYmlsaXR5LmxldmVsKCkpLzEwMCxcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAnZGFtYWdlJzogc2VsZi5nZXRBYmlsaXR5UHJvcGVydHlWYWx1ZShhYmlsaXR5LCAnZGFtYWdlJyksXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgJ2NvdW50JzogMSxcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAnZGFtYWdlVHlwZSc6ICdwaHlzaWNhbCcsXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgJ2Rpc3BsYXluYW1lJzogYWJpbGl0eS5kaXNwbGF5bmFtZVxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgYnJlYWs7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgLy8gc2xhcmRhcl9iYXNoXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgY2FzZSAnY2hhbmNlJzpcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgaWYgKHNvdXJjZXNbYWJpbGl0eS5uYW1lXSA9PSB1bmRlZmluZWQgJiYgYWJpbGl0eS5uYW1lID09ICdzbGFyZGFyX2Jhc2gnKSB7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBzb3VyY2VzW2FiaWxpdHkubmFtZV0gPSB7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgJ2NoYW5jZSc6IHNlbGYuZ2V0QWJpbGl0eUF0dHJpYnV0ZVZhbHVlKGFiaWxpdHkuYXR0cmlidXRlcywgYXR0cmlidXRlLm5hbWUsIGFiaWxpdHkubGV2ZWwoKSkvMTAwLFxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICdkYW1hZ2UnOiBzZWxmLmdldEFiaWxpdHlBdHRyaWJ1dGVWYWx1ZShhYmlsaXR5LmF0dHJpYnV0ZXMsICdib251c19kYW1hZ2UnLCBhYmlsaXR5LmxldmVsKCkpLFxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICdjb3VudCc6IDEsXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgJ2RhbWFnZVR5cGUnOiAncGh5c2ljYWwnLFxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICdkaXNwbGF5bmFtZSc6IGFiaWxpdHkuZGlzcGxheW5hbWVcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICAgICAgICAgICAgICAgIGJyZWFrO1xuICAgICAgICAgICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICAgIGVsc2UgaWYgKGFiaWxpdHkuYmFzaEJvbnVzRGFtYWdlICE9IHVuZGVmaW5lZCkge1xuICAgICAgICAgICAgICAgICAgICAvLyBmYWNlbGVzc192b2lkX3RpbWVfbG9ja1xuICAgICAgICAgICAgICAgICAgICBpZiAoc291cmNlc1thYmlsaXR5Lm5hbWVdID09IHVuZGVmaW5lZCAmJiBhYmlsaXR5Lm5hbWUgPT0gJ2ZhY2VsZXNzX3ZvaWRfdGltZV9sb2NrJykge1xuICAgICAgICAgICAgICAgICAgICAgICAgc291cmNlc1thYmlsaXR5Lm5hbWVdID0ge1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgICdjaGFuY2UnOiBhYmlsaXR5LmJhc2goKS8xMDAsXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgJ2RhbWFnZSc6IGFiaWxpdHkuYmFzaEJvbnVzRGFtYWdlKCksXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgJ2NvdW50JzogMSxcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAnZGFtYWdlVHlwZSc6ICdtYWdpYycsXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgJ2Rpc3BsYXluYW1lJzogYWJpbGl0eS5kaXNwbGF5bmFtZVxuICAgICAgICAgICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgICAgICAgIC8vIHNwaXJpdF9icmVha2VyX2dyZWF0ZXJfYmFzaFxuICAgICAgICAgICAgICAgICAgICBpZiAoc291cmNlc1thYmlsaXR5Lm5hbWVdID09IHVuZGVmaW5lZCAmJiBhYmlsaXR5Lm5hbWUgPT0gJ3NwaXJpdF9icmVha2VyX2dyZWF0ZXJfYmFzaCcpIHtcbiAgICAgICAgICAgICAgICAgICAgICAgIHNvdXJjZXNbYWJpbGl0eS5uYW1lXSA9IHtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAnY2hhbmNlJzogYWJpbGl0eS5iYXNoKCkvMTAwLFxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICdkYW1hZ2UnOiBhYmlsaXR5LmJhc2hCb251c0RhbWFnZSgpLzEwMCxcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAnY291bnQnOiAxLFxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICdkYW1hZ2VUeXBlJzogJ21hZ2ljJyxcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAnZGlzcGxheW5hbWUnOiBhYmlsaXR5LmRpc3BsYXluYW1lXG4gICAgICAgICAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICB9XG4gICAgICAgIH1cblxuICAgICAgICByZXR1cm4gc291cmNlcztcbiAgICB9O1xuICAgIFxuICAgIHNlbGYuZ2V0T3JiU291cmNlID0gZnVuY3Rpb24gKCkge1xuICAgICAgICB2YXIgc291cmNlcyA9IHt9O1xuICAgICAgICBmb3IgKHZhciBpID0gMDsgaSA8IHNlbGYuYWJpbGl0aWVzKCkubGVuZ3RoOyBpKyspIHtcbiAgICAgICAgICAgIHZhciBhYmlsaXR5ID0gc2VsZi5fYWJpbGl0aWVzW2ldO1xuICAgICAgICAgICAgaWYgKGFiaWxpdHkubGV2ZWwoKSA+IDAgJiYgKGFiaWxpdHkuaXNBY3RpdmUoKSB8fCAoYWJpbGl0eS5iZWhhdmlvci5pbmRleE9mKCdET1RBX0FCSUxJVFlfQkVIQVZJT1JfUEFTU0lWRScpICE9IC0xKSkpIHtcbiAgICAgICAgICAgICAgICBpZiAoIShhYmlsaXR5Lm5hbWUgaW4gc2VsZi5hYmlsaXR5RGF0YSkpIHtcbiAgICAgICAgICAgICAgICAgICAgZm9yICh2YXIgaiA9IDA7IGogPCBzZWxmLl9hYmlsaXRpZXNbaV0uYXR0cmlidXRlcy5sZW5ndGg7IGorKykge1xuICAgICAgICAgICAgICAgICAgICAgICAgdmFyIGF0dHJpYnV0ZSA9IHNlbGYuX2FiaWxpdGllc1tpXS5hdHRyaWJ1dGVzW2pdO1xuICAgICAgICAgICAgICAgICAgICAgICAgc3dpdGNoKGF0dHJpYnV0ZS5uYW1lKSB7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgLy8gYW50aW1hZ2VfbWFuYV9icmVha1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgIGNhc2UgJ21hbmFfcGVyX2hpdCc6XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIGlmIChzb3VyY2VzW2FiaWxpdHkubmFtZV0gPT0gdW5kZWZpbmVkICYmIGFiaWxpdHkubmFtZSA9PSAnYW50aW1hZ2VfbWFuYV9icmVhaycpIHtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIHNvdXJjZXNbYWJpbGl0eS5uYW1lXSA9IHtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAnZGFtYWdlJzogc2VsZi5nZXRBYmlsaXR5QXR0cmlidXRlVmFsdWUoYWJpbGl0eS5hdHRyaWJ1dGVzLCBhdHRyaWJ1dGUubmFtZSwgYWJpbGl0eS5sZXZlbCgpKSBcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICogc2VsZi5nZXRBYmlsaXR5QXR0cmlidXRlVmFsdWUoYWJpbGl0eS5hdHRyaWJ1dGVzLCAnZGFtYWdlX3Blcl9idXJuJywgYWJpbGl0eS5sZXZlbCgpKSxcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAnZGFtYWdlVHlwZSc6ICdwaHlzaWNhbCcsXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgJ2Rpc3BsYXluYW1lJzogYWJpbGl0eS5kaXNwbGF5bmFtZVxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgYnJlYWs7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgLy8gY2xpbmt6X3NlYXJpbmdfYXJyb3dzXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgY2FzZSAnZGFtYWdlX2JvbnVzJzpcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgaWYgKHNvdXJjZXNbYWJpbGl0eS5uYW1lXSA9PSB1bmRlZmluZWQgJiYgYWJpbGl0eS5uYW1lID09ICdjbGlua3pfc2VhcmluZ19hcnJvd3MnKSB7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBzb3VyY2VzW2FiaWxpdHkubmFtZV0gPSB7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgJ2RhbWFnZSc6IHNlbGYuZ2V0QWJpbGl0eUF0dHJpYnV0ZVZhbHVlKGFiaWxpdHkuYXR0cmlidXRlcywgYXR0cmlidXRlLm5hbWUsIGFiaWxpdHkubGV2ZWwoKSksXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgJ2RhbWFnZVR5cGUnOiAncGh5c2ljYWwnLFxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICdkaXNwbGF5bmFtZSc6IGFiaWxpdHkuZGlzcGxheW5hbWVcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICAgICAgICAgICAgICAgIC8vIHNpbGVuY2VyX2dsYWl2ZXNfb2Zfd2lzZG9tXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgY2FzZSAnaW50ZWxsZWN0X2RhbWFnZV9wY3QnOlxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBpZiAoc291cmNlc1thYmlsaXR5Lm5hbWVdID09IHVuZGVmaW5lZCAmJiBhYmlsaXR5Lm5hbWUgPT0gJ3NpbGVuY2VyX2dsYWl2ZXNfb2Zfd2lzZG9tJykge1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgc291cmNlc1thYmlsaXR5Lm5hbWVdID0ge1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICdkYW1hZ2UnOiBzZWxmLmdldEFiaWxpdHlBdHRyaWJ1dGVWYWx1ZShhYmlsaXR5LmF0dHJpYnV0ZXMsIGF0dHJpYnV0ZS5uYW1lLCBhYmlsaXR5LmxldmVsKCkpLzEwMCAqIHNlbGYuaGVyby50b3RhbEludCgpLFxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICdkYW1hZ2VUeXBlJzogJ3B1cmUnLFxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICdkaXNwbGF5bmFtZSc6IGFiaWxpdHkuZGlzcGxheW5hbWVcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICAgICAgICAgICAgICAgIGJyZWFrO1xuICAgICAgICAgICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICAgIGVsc2UgaWYgKGFiaWxpdHkuYm9udXNEYW1hZ2VPcmIgIT0gdW5kZWZpbmVkKSB7XG4gICAgICAgICAgICAgICAgICAgIC8vIG9ic2lkaWFuX2Rlc3Ryb3llcl9hcmNhbmVfb3JiXG4gICAgICAgICAgICAgICAgICAgIGlmIChzb3VyY2VzW2FiaWxpdHkubmFtZV0gPT0gdW5kZWZpbmVkICYmIGFiaWxpdHkubmFtZSA9PSAnb2JzaWRpYW5fZGVzdHJveWVyX2FyY2FuZV9vcmInKSB7XG4gICAgICAgICAgICAgICAgICAgICAgICBzb3VyY2VzW2FiaWxpdHkubmFtZV0gPSB7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgJ2RhbWFnZSc6IGFiaWxpdHkuYm9udXNEYW1hZ2VPcmIoKSxcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAnZGFtYWdlVHlwZSc6ICdwdXJlJyxcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAnZGlzcGxheW5hbWUnOiBhYmlsaXR5LmRpc3BsYXluYW1lXG4gICAgICAgICAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICB9XG4gICAgICAgIH1cbiAgICAgICAgXG4gICAgICAgIHJldHVybiBzb3VyY2VzO1xuICAgIH07XG4gICAgXG4gICAgc2VsZi50b2dnbGVBYmlsaXR5ID0gZnVuY3Rpb24gKGluZGV4LCBkYXRhLCBldmVudCkge1xuICAgICAgICBpZiAoc2VsZi5hYmlsaXRpZXMoKVtpbmRleCgpXS5iZWhhdmlvci5pbmRleE9mKCdET1RBX0FCSUxJVFlfQkVIQVZJT1JfUEFTU0lWRScpIDwgMCkge1xuICAgICAgICAgICAgaWYgKHNlbGYuYWJpbGl0aWVzKClbaW5kZXgoKV0uaXNBY3RpdmUoKSkge1xuICAgICAgICAgICAgICAgIHNlbGYuYWJpbGl0aWVzKClbaW5kZXgoKV0uaXNBY3RpdmUoZmFsc2UpO1xuICAgICAgICAgICAgfVxuICAgICAgICAgICAgZWxzZSB7XG4gICAgICAgICAgICAgICAgc2VsZi5hYmlsaXRpZXMoKVtpbmRleCgpXS5pc0FjdGl2ZSh0cnVlKTtcbiAgICAgICAgICAgIH1cbiAgICAgICAgICAgIFxuICAgICAgICAgICAgaWYgKHNlbGYuYWJpbGl0aWVzKClbaW5kZXgoKV0ubmFtZSA9PSAnbHljYW5fc2hhcGVzaGlmdCcpIHtcbiAgICAgICAgICAgICAgICBzZWxmLmlzU2hhcGVTaGlmdEFjdGl2ZShzZWxmLmFiaWxpdGllcygpW2luZGV4KCldLmlzQWN0aXZlKCkpO1xuICAgICAgICAgICAgfVxuICAgICAgICB9XG4gICAgfS5iaW5kKHRoaXMpO1xuXG4gICAgc2VsZi50b2dnbGVBYmlsaXR5RGV0YWlsID0gZnVuY3Rpb24gKGluZGV4LCBkYXRhLCBldmVudCkge1xuICAgICAgICBpZiAoc2VsZi5hYmlsaXRpZXMoKVtpbmRleCgpXS5pc0RldGFpbCgpKSB7XG4gICAgICAgICAgICBzZWxmLmFiaWxpdGllcygpW2luZGV4KCldLmlzRGV0YWlsKGZhbHNlKTtcbiAgICAgICAgfVxuICAgICAgICBlbHNlIHtcbiAgICAgICAgICAgIHNlbGYuYWJpbGl0aWVzKClbaW5kZXgoKV0uaXNEZXRhaWwodHJ1ZSk7XG4gICAgICAgIH1cbiAgICB9LmJpbmQodGhpcyk7XG4gICAgXG4gICAgc2VsZi5nZXRBYmlsaXR5ID0gZnVuY3Rpb24gKGFiaWxpdHlOYW1lKSB7XG4gICAgICAgIHJldHVybiBzZWxmLmFiaWxpdGllcygpLmZpbmQoZnVuY3Rpb24oYikge1xuICAgICAgICAgICAgcmV0dXJuIGIubmFtZSA9PSBhYmlsaXR5TmFtZTtcbiAgICAgICAgfSk7XG4gICAgfVxufVxuXG5BYmlsaXR5TW9kZWwucHJvdG90eXBlLmxldmVsVXBBYmlsaXR5ID0gZnVuY3Rpb24gKGluZGV4LCBkYXRhLCBldmVudCwgaGVybykge1xuICAgIHZhciBzZWxmID0gdGhpcztcbiAgICBpZiAoc2VsZi5hYmlsaXRpZXMoKVtpbmRleCgpXS5sZXZlbCgpIDwgaGVyby5nZXRBYmlsaXR5TGV2ZWxNYXgoZGF0YSkgJiYgaGVyby5hdmFpbGFibGVTa2lsbFBvaW50cygpID4gMCApIHtcbiAgICAgICAgc3dpdGNoKHNlbGYuYWJpbGl0aWVzKClbaW5kZXgoKV0uYWJpbGl0eXR5cGUpIHtcbiAgICAgICAgICAgIGNhc2UgJ0RPVEFfQUJJTElUWV9UWVBFX1VMVElNQVRFJzpcbiAgICAgICAgICAgICAgICBpZiAoaGVyby5oZXJvSWQoKSA9PSAnaW52b2tlcicpIHtcbiAgICAgICAgICAgICAgICAgICAgaWYgKFxuICAgICAgICAgICAgICAgICAgICAgICAgKHNlbGYuYWJpbGl0aWVzKClbaW5kZXgoKV0ubGV2ZWwoKSA9PSAwKSAmJiAocGFyc2VJbnQoaGVyby5zZWxlY3RlZEhlcm9MZXZlbCgpKSA+PSAyKSB8fFxuICAgICAgICAgICAgICAgICAgICAgICAgKHNlbGYuYWJpbGl0aWVzKClbaW5kZXgoKV0ubGV2ZWwoKSA9PSAxKSAmJiAocGFyc2VJbnQoaGVyby5zZWxlY3RlZEhlcm9MZXZlbCgpKSA+PSA3KSB8fFxuICAgICAgICAgICAgICAgICAgICAgICAgKHNlbGYuYWJpbGl0aWVzKClbaW5kZXgoKV0ubGV2ZWwoKSA9PSAyKSAmJiAocGFyc2VJbnQoaGVyby5zZWxlY3RlZEhlcm9MZXZlbCgpKSA+PSAxMSkgfHxcbiAgICAgICAgICAgICAgICAgICAgICAgIChzZWxmLmFiaWxpdGllcygpW2luZGV4KCldLmxldmVsKCkgPT0gMykgJiYgKHBhcnNlSW50KGhlcm8uc2VsZWN0ZWRIZXJvTGV2ZWwoKSkgPj0gMTcpXG4gICAgICAgICAgICAgICAgICAgICkge1xuICAgICAgICAgICAgICAgICAgICAgICAgc2VsZi5hYmlsaXRpZXMoKVtpbmRleCgpXS5sZXZlbChzZWxmLmFiaWxpdGllcygpW2luZGV4KCldLmxldmVsKCkrMSk7XG4gICAgICAgICAgICAgICAgICAgICAgICBoZXJvLnNraWxsUG9pbnRIaXN0b3J5LnB1c2goaW5kZXgoKSk7XG4gICAgICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgICAgZWxzZSBpZiAoaGVyby5oZXJvSWQoKSA9PSAnbWVlcG8nKSB7XG4gICAgICAgICAgICAgICAgICAgIGlmIChzZWxmLmFiaWxpdGllcygpW2luZGV4KCldLmxldmVsKCkgKiA3ICsgMyA8PSBwYXJzZUludChoZXJvLnNlbGVjdGVkSGVyb0xldmVsKCkpKSB7XG4gICAgICAgICAgICAgICAgICAgICAgICBzZWxmLmFiaWxpdGllcygpW2luZGV4KCldLmxldmVsKHNlbGYuYWJpbGl0aWVzKClbaW5kZXgoKV0ubGV2ZWwoKSsxKTtcbiAgICAgICAgICAgICAgICAgICAgICAgIGhlcm8uc2tpbGxQb2ludEhpc3RvcnkucHVzaChpbmRleCgpKTtcbiAgICAgICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgICBlbHNlIHtcbiAgICAgICAgICAgICAgICAgICAgaWYgKChzZWxmLmFiaWxpdGllcygpW2luZGV4KCldLmxldmVsKCkrMSkgKiA1ICsgMSA8PSBwYXJzZUludChoZXJvLnNlbGVjdGVkSGVyb0xldmVsKCkpKSB7XG4gICAgICAgICAgICAgICAgICAgICAgICBzZWxmLmFiaWxpdGllcygpW2luZGV4KCldLmxldmVsKHNlbGYuYWJpbGl0aWVzKClbaW5kZXgoKV0ubGV2ZWwoKSsxKTtcbiAgICAgICAgICAgICAgICAgICAgICAgIGhlcm8uc2tpbGxQb2ludEhpc3RvcnkucHVzaChpbmRleCgpKTtcbiAgICAgICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgIGJyZWFrO1xuICAgICAgICAgICAgZGVmYXVsdDpcbiAgICAgICAgICAgICAgICBpZiAoc2VsZi5hYmlsaXRpZXMoKVtpbmRleCgpXS5sZXZlbCgpICogMiArIDEgPD0gcGFyc2VJbnQoaGVyby5zZWxlY3RlZEhlcm9MZXZlbCgpKSkge1xuICAgICAgICAgICAgICAgICAgICBzZWxmLmFiaWxpdGllcygpW2luZGV4KCldLmxldmVsKHNlbGYuYWJpbGl0aWVzKClbaW5kZXgoKV0ubGV2ZWwoKSsxKTtcbiAgICAgICAgICAgICAgICAgICAgaGVyby5za2lsbFBvaW50SGlzdG9yeS5wdXNoKGluZGV4KCkpO1xuICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgIGJyZWFrO1xuICAgICAgICB9XG4gICAgICAgIHN3aXRjaCAoc2VsZi5hYmlsaXRpZXMoKVtpbmRleCgpXS5uYW1lKSB7XG4gICAgICAgICAgICBjYXNlICdiZWFzdG1hc3Rlcl9jYWxsX29mX3RoZV93aWxkJzpcbiAgICAgICAgICAgIGNhc2UgJ2NoZW5fdGVzdF9vZl9mYWl0aCc6XG4gICAgICAgICAgICBjYXNlICdtb3JwaGxpbmdfbW9ycGhfYWdpJzpcbiAgICAgICAgICAgIGNhc2UgJ3NoYWRvd19kZW1vbl9zaGFkb3dfcG9pc29uJzpcbiAgICAgICAgICAgICAgICBzZWxmLmFiaWxpdGllcygpW2luZGV4KCkgKyAxXS5sZXZlbChzZWxmLmFiaWxpdGllcygpW2luZGV4KCldLmxldmVsKCkpO1xuICAgICAgICAgICAgYnJlYWs7XG4gICAgICAgICAgICBjYXNlICdtb3JwaGxpbmdfbW9ycGhfc3RyJzpcbiAgICAgICAgICAgICAgICBzZWxmLmFiaWxpdGllcygpW2luZGV4KCkgLSAxXS5sZXZlbChzZWxmLmFiaWxpdGllcygpW2luZGV4KCldLmxldmVsKCkpO1xuICAgICAgICAgICAgYnJlYWs7XG4gICAgICAgICAgICBjYXNlICdrZWVwZXJfb2ZfdGhlX2xpZ2h0X3NwaXJpdF9mb3JtJzpcbiAgICAgICAgICAgICAgICBzZWxmLmFiaWxpdGllcygpW2luZGV4KCkgLSAxXS5sZXZlbChzZWxmLmFiaWxpdGllcygpW2luZGV4KCldLmxldmVsKCkpO1xuICAgICAgICAgICAgICAgIHNlbGYuYWJpbGl0aWVzKClbaW5kZXgoKSAtIDJdLmxldmVsKHNlbGYuYWJpbGl0aWVzKClbaW5kZXgoKV0ubGV2ZWwoKSk7XG4gICAgICAgICAgICBicmVhaztcbiAgICAgICAgICAgIGNhc2UgJ25ldmVybW9yZV9zaGFkb3dyYXplMSc6XG4gICAgICAgICAgICAgICAgc2VsZi5hYmlsaXRpZXMoKVtpbmRleCgpICsgMV0ubGV2ZWwoc2VsZi5hYmlsaXRpZXMoKVtpbmRleCgpXS5sZXZlbCgpKTtcbiAgICAgICAgICAgICAgICBzZWxmLmFiaWxpdGllcygpW2luZGV4KCkgKyAyXS5sZXZlbChzZWxmLmFiaWxpdGllcygpW2luZGV4KCldLmxldmVsKCkpO1xuICAgICAgICAgICAgYnJlYWs7XG4gICAgICAgICAgICBjYXNlICduZXZlcm1vcmVfc2hhZG93cmF6ZTInOlxuICAgICAgICAgICAgICAgIHNlbGYuYWJpbGl0aWVzKClbaW5kZXgoKSAtIDFdLmxldmVsKHNlbGYuYWJpbGl0aWVzKClbaW5kZXgoKV0ubGV2ZWwoKSk7XG4gICAgICAgICAgICAgICAgc2VsZi5hYmlsaXRpZXMoKVtpbmRleCgpICsgMV0ubGV2ZWwoc2VsZi5hYmlsaXRpZXMoKVtpbmRleCgpXS5sZXZlbCgpKTtcbiAgICAgICAgICAgIGJyZWFrO1xuICAgICAgICAgICAgY2FzZSAnbmV2ZXJtb3JlX3NoYWRvd3JhemUzJzpcbiAgICAgICAgICAgICAgICBzZWxmLmFiaWxpdGllcygpW2luZGV4KCkgLSAxXS5sZXZlbChzZWxmLmFiaWxpdGllcygpW2luZGV4KCldLmxldmVsKCkpO1xuICAgICAgICAgICAgICAgIHNlbGYuYWJpbGl0aWVzKClbaW5kZXgoKSAtIDJdLmxldmVsKHNlbGYuYWJpbGl0aWVzKClbaW5kZXgoKV0ubGV2ZWwoKSk7XG4gICAgICAgICAgICBicmVhaztcbiAgICAgICAgICAgIGNhc2UgJ2VtYmVyX3NwaXJpdF9maXJlX3JlbW5hbnQnOlxuICAgICAgICAgICAgICAgIHNlbGYuYWJpbGl0aWVzKClbaW5kZXgoKSAtIDFdLmxldmVsKHNlbGYuYWJpbGl0aWVzKClbaW5kZXgoKV0ubGV2ZWwoKSk7XG4gICAgICAgICAgICBicmVhaztcbiAgICAgICAgICAgIGNhc2UgJ2xvbmVfZHJ1aWRfdHJ1ZV9mb3JtJzpcbiAgICAgICAgICAgICAgICBzZWxmLmFiaWxpdGllcygpW2luZGV4KCkgLSAxXS5sZXZlbChzZWxmLmFiaWxpdGllcygpW2luZGV4KCldLmxldmVsKCkpO1xuICAgICAgICAgICAgYnJlYWs7XG4gICAgICAgIH1cbiAgICB9XG59O1xuQWJpbGl0eU1vZGVsLnByb3RvdHlwZS5sZXZlbERvd25BYmlsaXR5ID0gZnVuY3Rpb24gKGluZGV4LCBkYXRhLCBldmVudCwgaGVybykge1xuICAgIHZhciBpID0ga28udXRpbHMudW53cmFwT2JzZXJ2YWJsZShpbmRleCk7XG4gICAgdmFyIHNlbGYgPSB0aGlzO1xuICAgIGlmIChzZWxmLmFiaWxpdGllcygpW2ldLmxldmVsKCkgPiAwKSB7XG4gICAgICAgIHNlbGYuYWJpbGl0aWVzKClbaV0ubGV2ZWwoc2VsZi5hYmlsaXRpZXMoKVtpXS5sZXZlbCgpIC0gMSk7XG4gICAgICAgIGhlcm8uc2tpbGxQb2ludEhpc3Rvcnkuc3BsaWNlKGhlcm8uc2tpbGxQb2ludEhpc3RvcnkoKS5sYXN0SW5kZXhPZihpKSwgMSk7XG4gICAgICAgIHN3aXRjaCAoc2VsZi5hYmlsaXRpZXMoKVtpXS5uYW1lKSB7XG4gICAgICAgICAgICBjYXNlICdiZWFzdG1hc3Rlcl9jYWxsX29mX3RoZV93aWxkJzpcbiAgICAgICAgICAgIGNhc2UgJ2NoZW5fdGVzdF9vZl9mYWl0aCc6XG4gICAgICAgICAgICBjYXNlICdtb3JwaGxpbmdfbW9ycGhfYWdpJzpcbiAgICAgICAgICAgIGNhc2UgJ3NoYWRvd19kZW1vbl9zaGFkb3dfcG9pc29uJzpcbiAgICAgICAgICAgICAgICBzZWxmLmFiaWxpdGllcygpW2kgKyAxXS5sZXZlbChzZWxmLmFiaWxpdGllcygpW2ldLmxldmVsKCkpO1xuICAgICAgICAgICAgYnJlYWs7XG4gICAgICAgICAgICBjYXNlICdtb3JwaGxpbmdfbW9ycGhfc3RyJzpcbiAgICAgICAgICAgICAgICBzZWxmLmFiaWxpdGllcygpW2kgLSAxXS5sZXZlbChzZWxmLmFiaWxpdGllcygpW2ldLmxldmVsKCkpO1xuICAgICAgICAgICAgYnJlYWs7XG4gICAgICAgICAgICBjYXNlICdrZWVwZXJfb2ZfdGhlX2xpZ2h0X3NwaXJpdF9mb3JtJzpcbiAgICAgICAgICAgICAgICBzZWxmLmFiaWxpdGllcygpW2kgLSAxXS5sZXZlbChzZWxmLmFiaWxpdGllcygpW2ldLmxldmVsKCkpO1xuICAgICAgICAgICAgICAgIHNlbGYuYWJpbGl0aWVzKClbaSAtIDJdLmxldmVsKHNlbGYuYWJpbGl0aWVzKClbaV0ubGV2ZWwoKSk7XG4gICAgICAgICAgICBicmVhaztcbiAgICAgICAgICAgIGNhc2UgJ25ldmVybW9yZV9zaGFkb3dyYXplMSc6XG4gICAgICAgICAgICAgICAgc2VsZi5hYmlsaXRpZXMoKVtpICsgMV0ubGV2ZWwoc2VsZi5hYmlsaXRpZXMoKVtpXS5sZXZlbCgpKTtcbiAgICAgICAgICAgICAgICBzZWxmLmFiaWxpdGllcygpW2kgKyAyXS5sZXZlbChzZWxmLmFiaWxpdGllcygpW2ldLmxldmVsKCkpO1xuICAgICAgICAgICAgYnJlYWs7XG4gICAgICAgICAgICBjYXNlICduZXZlcm1vcmVfc2hhZG93cmF6ZTInOlxuICAgICAgICAgICAgICAgIHNlbGYuYWJpbGl0aWVzKClbaSAtIDFdLmxldmVsKHNlbGYuYWJpbGl0aWVzKClbaV0ubGV2ZWwoKSk7XG4gICAgICAgICAgICAgICAgc2VsZi5hYmlsaXRpZXMoKVtpICsgMV0ubGV2ZWwoc2VsZi5hYmlsaXRpZXMoKVtpXS5sZXZlbCgpKTtcbiAgICAgICAgICAgIGJyZWFrO1xuICAgICAgICAgICAgY2FzZSAnbmV2ZXJtb3JlX3NoYWRvd3JhemUzJzpcbiAgICAgICAgICAgICAgICBzZWxmLmFiaWxpdGllcygpW2kgLSAxXS5sZXZlbChzZWxmLmFiaWxpdGllcygpW2ldLmxldmVsKCkpO1xuICAgICAgICAgICAgICAgIHNlbGYuYWJpbGl0aWVzKClbaSAtIDJdLmxldmVsKHNlbGYuYWJpbGl0aWVzKClbaV0ubGV2ZWwoKSk7XG4gICAgICAgICAgICBicmVhaztcbiAgICAgICAgICAgIGNhc2UgJ2VtYmVyX3NwaXJpdF9maXJlX3JlbW5hbnQnOlxuICAgICAgICAgICAgICAgIHNlbGYuYWJpbGl0aWVzKClbaSAtIDFdLmxldmVsKHNlbGYuYWJpbGl0aWVzKClbaV0ubGV2ZWwoKSk7XG4gICAgICAgICAgICBicmVhaztcbiAgICAgICAgICAgIGNhc2UgJ2xvbmVfZHJ1aWRfdHJ1ZV9mb3JtJzpcbiAgICAgICAgICAgICAgICBzZWxmLmFiaWxpdGllcygpW2kgLSAxXS5sZXZlbChzZWxmLmFiaWxpdGllcygpW2ldLmxldmVsKCkpO1xuICAgICAgICAgICAgYnJlYWs7XG4gICAgICAgIH1cbiAgICB9XG59O1xuQWJpbGl0eU1vZGVsLnByb3RvdHlwZS5nZXRBYmlsaXR5QXR0cmlidXRlVmFsdWUgPSBmdW5jdGlvbiAoYXR0cmlidXRlcywgYXR0cmlidXRlTmFtZSwgbGV2ZWwpIHtcbiAgICBmb3IgKHZhciBpPTA7IGkgPCBhdHRyaWJ1dGVzLmxlbmd0aDsgaSsrKSB7XG4gICAgICAgIGlmIChhdHRyaWJ1dGVzW2ldLm5hbWUgPT0gYXR0cmlidXRlTmFtZSkge1xuICAgICAgICAgICAgaWYgKGxldmVsID09IDApIHtcbiAgICAgICAgICAgICAgICByZXR1cm4gcGFyc2VGbG9hdChhdHRyaWJ1dGVzW2ldLnZhbHVlWzBdKTtcbiAgICAgICAgICAgIH1cbiAgICAgICAgICAgIGVsc2UgaWYgKGxldmVsID4gYXR0cmlidXRlc1tpXS52YWx1ZS5sZW5ndGgpIHtcbiAgICAgICAgICAgICAgICByZXR1cm4gcGFyc2VGbG9hdChhdHRyaWJ1dGVzW2ldLnZhbHVlWzBdKTtcbiAgICAgICAgICAgIH1cbiAgICAgICAgICAgIGVsc2Uge1xuICAgICAgICAgICAgICAgIHJldHVybiBwYXJzZUZsb2F0KGF0dHJpYnV0ZXNbaV0udmFsdWVbbGV2ZWwtMV0pO1xuICAgICAgICAgICAgfVxuICAgICAgICB9XG4gICAgfVxufVxuQWJpbGl0eU1vZGVsLnByb3RvdHlwZS5nZXRBYmlsaXR5QXR0cmlidXRlVG9vbHRpcCA9IGZ1bmN0aW9uIChhdHRyaWJ1dGVzLCBhdHRyaWJ1dGVOYW1lKSB7XG4gICAgZm9yICh2YXIgaT0wOyBpPGF0dHJpYnV0ZXMubGVuZ3RoOyBpKyspIHtcbiAgICAgICAgaWYgKGF0dHJpYnV0ZXNbaV0ubmFtZSA9PSBhdHRyaWJ1dGVOYW1lKSB7XG4gICAgICAgICAgICBpZiAoYXR0cmlidXRlc1tpXS5oYXNPd25Qcm9wZXJ0eSgndG9vbHRpcCcpKSB7XG4gICAgICAgICAgICAgICAgdmFyIGQgPSBhdHRyaWJ1dGVzW2ldLnRvb2x0aXAucmVwbGFjZSgvXFxcXG4vZywgJycpO1xuICAgICAgICAgICAgICAgIHJldHVybiBkO1xuICAgICAgICAgICAgfVxuICAgICAgICAgICAgZWxzZSB7XG4gICAgICAgICAgICAgICAgcmV0dXJuICcnO1xuICAgICAgICAgICAgfVxuICAgICAgICB9XG4gICAgfVxuICAgIHJldHVybiAnJztcbn1cblxubW9kdWxlLmV4cG9ydHMgPSBBYmlsaXR5TW9kZWw7IiwiJ3VzZSBzdHJpY3QnO1xudmFyIGtvID0gcmVxdWlyZSgnLi9oZXJvY2FsY19rbm9ja291dCcpO1xuXG52YXIgQWJpbGl0eU1vZGVsID0gcmVxdWlyZShcIi4vQWJpbGl0eU1vZGVsXCIpO1xudmFyIEludmVudG9yeVZpZXdNb2RlbCA9IHJlcXVpcmUoXCIuL2ludmVudG9yeS9JbnZlbnRvcnlWaWV3TW9kZWxcIik7XG52YXIgZmluZFdoZXJlID0gcmVxdWlyZShcIi4vdXRpbC9maW5kV2hlcmVcIik7XG52YXIgYnVmZk9wdGlvbnNBcnJheSA9IHJlcXVpcmUoXCIuL2J1ZmZzL2J1ZmZPcHRpb25zQXJyYXlcIik7XG52YXIgZGVidWZmT3B0aW9uc0FycmF5ID0gcmVxdWlyZShcIi4vYnVmZnMvZGVidWZmT3B0aW9uc0FycmF5XCIpO1xuXG52YXIgQnVmZlZpZXdNb2RlbCA9IGZ1bmN0aW9uIChpdGVtRGF0YSwgYSkge1xuICAgIHZhciBzZWxmID0gdGhpcztcbiAgICBBYmlsaXR5TW9kZWwuY2FsbCh0aGlzLCBrby5vYnNlcnZhYmxlQXJyYXkoW10pKTtcbiAgICBzZWxmLmF2YWlsYWJsZUJ1ZmZzID0ga28ub2JzZXJ2YWJsZUFycmF5KGJ1ZmZPcHRpb25zQXJyYXkuaXRlbXMpO1xuICAgIHNlbGYuYXZhaWxhYmxlRGVidWZmcyA9IGtvLm9ic2VydmFibGVBcnJheShkZWJ1ZmZPcHRpb25zQXJyYXkuaXRlbXMpO1xuICAgIHNlbGYuc2VsZWN0ZWRCdWZmID0ga28ub2JzZXJ2YWJsZShzZWxmLmF2YWlsYWJsZUJ1ZmZzKClbMF0pO1xuICAgIFxuICAgIHNlbGYuYnVmZnMgPSBrby5vYnNlcnZhYmxlQXJyYXkoW10pO1xuICAgIHNlbGYuaXRlbUJ1ZmZzID0gbmV3IEludmVudG9yeVZpZXdNb2RlbChpdGVtRGF0YSk7XG4gICAgXG4gICAgc2VsZi5hZGRCdWZmID0gZnVuY3Rpb24gKGRhdGEsIGV2ZW50KSB7XG4gICAgICAgIGlmIChmaW5kV2hlcmUoc2VsZi5idWZmcygpLCB7IG5hbWU6IHNlbGYuc2VsZWN0ZWRCdWZmKCkuYnVmZk5hbWUgfSkgPT0gdW5kZWZpbmVkKSB7XG4gICAgICAgICAgICB2YXIgYSA9IEpTT04ucGFyc2UoSlNPTi5zdHJpbmdpZnkoc2VsZi5zZWxlY3RlZEJ1ZmYoKS5hYmlsaXR5RGF0YSkpO1xuICAgICAgICAgICAgYS5sZXZlbCA9IGtvLm9ic2VydmFibGUoMCk7XG4gICAgICAgICAgICBhLmlzQWN0aXZlID0ga28ub2JzZXJ2YWJsZShmYWxzZSk7XG4gICAgICAgICAgICBhLmlzRGV0YWlsID0ga28ub2JzZXJ2YWJsZShmYWxzZSk7XG4gICAgICAgICAgICBhLmJhc2VEYW1hZ2UgPSBrby5vYnNlcnZhYmxlKDApO1xuICAgICAgICAgICAgYS5iYXNoID0ga28ub2JzZXJ2YWJsZSgwKTtcbiAgICAgICAgICAgIGEuYmFzaEJvbnVzRGFtYWdlID0ga28ub2JzZXJ2YWJsZSgwKTtcbiAgICAgICAgICAgIGEuYm9udXNEYW1hZ2UgPSBrby5vYnNlcnZhYmxlKDApO1xuICAgICAgICAgICAgYS5ib251c0RhbWFnZU9yYiA9IGtvLm9ic2VydmFibGUoMCk7XG4gICAgICAgICAgICBhLmJvbnVzRGFtYWdlUGN0ID0ga28ub2JzZXJ2YWJsZSgwKTtcbiAgICAgICAgICAgIGEuYm9udXNEYW1hZ2VQcmVjaXNpb25BdXJhID0ga28ub2JzZXJ2YWJsZSgwKTtcbiAgICAgICAgICAgIGEuYm9udXNEYW1hZ2VSZWR1Y3Rpb24gPSBrby5vYnNlcnZhYmxlKDApO1xuICAgICAgICAgICAgYS5ib251c0hlYWx0aCA9IGtvLm9ic2VydmFibGUoMCk7XG4gICAgICAgICAgICBhLmJvbnVzU3RyZW5ndGggPSBrby5vYnNlcnZhYmxlKDApO1xuICAgICAgICAgICAgYS5ib251c1N0cmVuZ3RoMiA9IGtvLm9ic2VydmFibGUoMCk7XG4gICAgICAgICAgICBhLmJvbnVzQWdpbGl0eSA9IGtvLm9ic2VydmFibGUoMCk7XG4gICAgICAgICAgICBhLmJvbnVzQWdpbGl0eTIgPSBrby5vYnNlcnZhYmxlKDApO1xuICAgICAgICAgICAgYS5ib251c0ludCA9IGtvLm9ic2VydmFibGUoMCk7XG4gICAgICAgICAgICBhLmJvbnVzQWxsU3RhdHNSZWR1Y3Rpb24gPSBrby5vYnNlcnZhYmxlKDApO1xuICAgICAgICAgICAgYS5kYW1hZ2VBbXBsaWZpY2F0aW9uID0ga28ub2JzZXJ2YWJsZSgwKTtcbiAgICAgICAgICAgIGEuZGFtYWdlUmVkdWN0aW9uID0ga28ub2JzZXJ2YWJsZSgwKTtcbiAgICAgICAgICAgIGEuZXZhc2lvbiA9IGtvLm9ic2VydmFibGUoMCk7XG4gICAgICAgICAgICBhLm1hZ2ljUmVzaXN0ID0ga28ub2JzZXJ2YWJsZSgwKTtcbiAgICAgICAgICAgIGEubWFuYXJlZ2VuID0ga28ub2JzZXJ2YWJsZSgwKTtcbiAgICAgICAgICAgIGEubWFuYXJlZ2VucmVkdWN0aW9uID0ga28ub2JzZXJ2YWJsZSgwKTtcbiAgICAgICAgICAgIGEubWlzc0NoYW5jZSA9IGtvLm9ic2VydmFibGUoMCk7XG4gICAgICAgICAgICBhLm1vdmVtZW50U3BlZWRGbGF0ID0ga28ub2JzZXJ2YWJsZSgwKTtcbiAgICAgICAgICAgIGEubW92ZW1lbnRTcGVlZFBjdCA9IGtvLm9ic2VydmFibGUoMCk7XG4gICAgICAgICAgICBhLm1vdmVtZW50U3BlZWRQY3RSZWR1Y3Rpb24gPSBrby5vYnNlcnZhYmxlKDApO1xuICAgICAgICAgICAgYS50dXJuUmF0ZVJlZHVjdGlvbiA9IGtvLm9ic2VydmFibGUoMCk7XG4gICAgICAgICAgICBhLmF0dGFja3JhbmdlID0ga28ub2JzZXJ2YWJsZSgwKTtcbiAgICAgICAgICAgIGEuYXR0YWNrc3BlZWQgPSBrby5vYnNlcnZhYmxlKDApO1xuICAgICAgICAgICAgYS5hdHRhY2tzcGVlZHJlZHVjdGlvbiA9IGtvLm9ic2VydmFibGUoMCk7XG4gICAgICAgICAgICBhLmFybW9yID0ga28ub2JzZXJ2YWJsZSgwKTtcbiAgICAgICAgICAgIGEuYXJtb3JSZWR1Y3Rpb24gPSBrby5vYnNlcnZhYmxlKDApO1xuICAgICAgICAgICAgYS5oZWFsdGhyZWdlbiA9IGtvLm9ic2VydmFibGUoMCk7XG4gICAgICAgICAgICBhLmxpZmVzdGVhbCA9IGtvLm9ic2VydmFibGUoMCk7XG4gICAgICAgICAgICBhLnZpc2lvbm5pZ2h0ID0ga28ub2JzZXJ2YWJsZSgwKTtcbiAgICAgICAgICAgIGEudmlzaW9uZGF5ID0ga28ub2JzZXJ2YWJsZSgwKTtcbiAgICAgICAgICAgIHN3aXRjaCAoYS5uYW1lKSB7XG4gICAgICAgICAgICAgICAgY2FzZSAnaW52b2tlcl9jb2xkX3NuYXAnOlxuICAgICAgICAgICAgICAgIGNhc2UgJ2ludm9rZXJfZ2hvc3Rfd2Fsayc6XG4gICAgICAgICAgICAgICAgY2FzZSAnaW52b2tlcl90b3JuYWRvJzpcbiAgICAgICAgICAgICAgICBjYXNlICdpbnZva2VyX2VtcCc6XG4gICAgICAgICAgICAgICAgY2FzZSAnaW52b2tlcl9hbGFjcml0eSc6XG4gICAgICAgICAgICAgICAgY2FzZSAnaW52b2tlcl9jaGFvc19tZXRlb3InOlxuICAgICAgICAgICAgICAgIGNhc2UgJ2ludm9rZXJfc3VuX3N0cmlrZSc6XG4gICAgICAgICAgICAgICAgY2FzZSAnaW52b2tlcl9mb3JnZV9zcGlyaXQnOlxuICAgICAgICAgICAgICAgIGNhc2UgJ2ludm9rZXJfaWNlX3dhbGwnOlxuICAgICAgICAgICAgICAgIGNhc2UgJ2ludm9rZXJfZGVhZmVuaW5nX2JsYXN0JzpcbiAgICAgICAgICAgICAgICAgICAgYS5sZXZlbCgxKTtcbiAgICAgICAgICAgICAgICBicmVhaztcbiAgICAgICAgICAgIH1cbiAgICAgICAgICAgIHNlbGYuYWJpbGl0aWVzLnB1c2goYSk7XG4gICAgICAgICAgICBzZWxmLmJ1ZmZzLnB1c2goeyBuYW1lOiBzZWxmLnNlbGVjdGVkQnVmZigpLmJ1ZmZOYW1lLCBoZXJvOiBzZWxmLnNlbGVjdGVkQnVmZigpLmhlcm8sIGRhdGE6IGEgfSk7XG4gICAgICAgIH1cbiAgICB9O1xuICAgIFxuICAgIHNlbGYucmVtb3ZlQnVmZiA9IGZ1bmN0aW9uIChkYXRhLCBldmVudCwgYWJpbGl0eU5hbWUpIHtcbiAgICAgICAgaWYgKGZpbmRXaGVyZShzZWxmLmJ1ZmZzKCksIHsgbmFtZTogYWJpbGl0eU5hbWUgfSkgICE9IHVuZGVmaW5lZCkge1xuICAgICAgICAgICAgICAgIHNlbGYuYnVmZnMucmVtb3ZlKGZpbmRXaGVyZShzZWxmLmJ1ZmZzKCksIHsgbmFtZTogYWJpbGl0eU5hbWUgfSkpO1xuICAgICAgICAgICAgICAgIGlmIChzZWxmLmFiaWxpdHlDb250cm9sRGF0YVthYmlsaXR5TmFtZV0gIT0gdW5kZWZpbmVkKSB7XG4gICAgICAgICAgICAgICAgICAgIGZvciAodmFyIGkgPSAwOyBpIDwgc2VsZi5hYmlsaXR5Q29udHJvbERhdGFbYWJpbGl0eU5hbWVdLmRhdGEubGVuZ3RoOyBpKyspIHtcbiAgICAgICAgICAgICAgICAgICAgICAgIGlmIChzZWxmLmFiaWxpdHlDb250cm9sRGF0YVthYmlsaXR5TmFtZV0uZGF0YVtpXS5jb250cm9sVmFsLmRpc3Bvc2UgIT0gdW5kZWZpbmVkKSB7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgc2VsZi5hYmlsaXR5Q29udHJvbERhdGFbYWJpbGl0eU5hbWVdLmRhdGFbaV0uY29udHJvbFZhbC5kaXNwb3NlKCk7XG4gICAgICAgICAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgICAgICAgICAgICBpZiAoc2VsZi5hYmlsaXR5Q29udHJvbERhdGFbYWJpbGl0eU5hbWVdLmRhdGFbaV0uY2xlYW4gIT0gdW5kZWZpbmVkKSB7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgc2VsZi5hYmlsaXR5Q29udHJvbERhdGFbYWJpbGl0eU5hbWVdLmRhdGFbaV0uY2xlYW4uZGlzcG9zZSgpO1xuICAgICAgICAgICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgICAgICAgIHNlbGYuYWJpbGl0eUNvbnRyb2xEYXRhW2FiaWxpdHlOYW1lXSA9IHVuZGVmaW5lZDtcbiAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgICAgZm9yICh2YXIgaSA9IDA7IGkgPCBzZWxmLmFiaWxpdGllcygpLmxlbmd0aDsgaSsrKSB7XG4gICAgICAgICAgICAgICAgICAgIGlmIChzZWxmLmFiaWxpdGllcygpW2ldLm5hbWUgPT0gYWJpbGl0eU5hbWUpIHtcbiAgICAgICAgICAgICAgICAgICAgICAgIHNlbGYuYWJpbGl0aWVzKClbaV0ubGV2ZWwoMCk7XG4gICAgICAgICAgICAgICAgICAgICAgICBzZWxmLmFiaWxpdGllcy5yZW1vdmUoc2VsZi5hYmlsaXRpZXMoKVtpXSk7XG4gICAgICAgICAgICAgICAgICAgICAgICBicmVhaztcbiAgICAgICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICAgIH1cbiAgICAgICAgfVxuICAgIH07XG4gICAgc2VsZi50b2dnbGVCdWZmID0gZnVuY3Rpb24gKGluZGV4LCBkYXRhLCBldmVudCkge1xuICAgICAgICBpZiAoc2VsZi5idWZmcygpW2luZGV4KCldLmRhdGEuYmVoYXZpb3IuaW5kZXhPZignRE9UQV9BQklMSVRZX0JFSEFWSU9SX1BBU1NJVkUnKSA8IDApIHtcbiAgICAgICAgICAgIGlmIChzZWxmLmJ1ZmZzKClbaW5kZXgoKV0uZGF0YS5pc0FjdGl2ZSgpKSB7XG4gICAgICAgICAgICAgICAgc2VsZi5idWZmcygpW2luZGV4KCldLmRhdGEuaXNBY3RpdmUoZmFsc2UpO1xuICAgICAgICAgICAgICAgIHNlbGYuYWJpbGl0aWVzKClbaW5kZXgoKV0uaXNBY3RpdmUoZmFsc2UpO1xuICAgICAgICAgICAgfVxuICAgICAgICAgICAgZWxzZSB7XG4gICAgICAgICAgICAgICAgc2VsZi5idWZmcygpW2luZGV4KCldLmRhdGEuaXNBY3RpdmUodHJ1ZSk7XG4gICAgICAgICAgICAgICAgc2VsZi5hYmlsaXRpZXMoKVtpbmRleCgpXS5pc0FjdGl2ZSh0cnVlKTtcbiAgICAgICAgICAgIH1cbiAgICAgICAgfVxuICAgIH0uYmluZCh0aGlzKTtcblxuICAgIHNlbGYudG9nZ2xlQnVmZkRldGFpbCA9IGZ1bmN0aW9uIChpbmRleCwgZGF0YSwgZXZlbnQpIHtcbiAgICAgICAgaWYgKHNlbGYuYnVmZnMoKVtpbmRleCgpXS5kYXRhLmlzRGV0YWlsKCkpIHtcbiAgICAgICAgICAgIHNlbGYuYnVmZnMoKVtpbmRleCgpXS5kYXRhLmlzRGV0YWlsKGZhbHNlKTtcbiAgICAgICAgfVxuICAgICAgICBlbHNlIHtcbiAgICAgICAgICAgIHNlbGYuYnVmZnMoKVtpbmRleCgpXS5kYXRhLmlzRGV0YWlsKHRydWUpO1xuICAgICAgICB9XG4gICAgfS5iaW5kKHRoaXMpO1xuXG4gICAgLy8gT3ZlcnJpZGVzIHRoZSBhYmlsaXR5IG1vZHVsZSBmdW5jdGlvbiB0byByZW1vdmUgYXZhaWxhYmxlIHNraWxsIHBvaW50IGNoZWNrXG4gICAgc2VsZi5sZXZlbFVwQWJpbGl0eSA9IGZ1bmN0aW9uIChpbmRleCwgZGF0YSwgZXZlbnQsIGhlcm8pIHtcbiAgICAgICAgaWYgKHNlbGYuYWJpbGl0aWVzKClbaW5kZXgoKV0ubGV2ZWwoKSA8IGhlcm8uZ2V0QWJpbGl0eUxldmVsTWF4KGRhdGEpKSB7XG4gICAgICAgICAgICBzd2l0Y2goc2VsZi5hYmlsaXRpZXMoKVtpbmRleCgpXS5hYmlsaXR5dHlwZSkge1xuICAgICAgICAgICAgICAgIGNhc2UgJ0RPVEFfQUJJTElUWV9UWVBFX1VMVElNQVRFJzpcbiAgICAgICAgICAgICAgICAgICAgc2VsZi5hYmlsaXRpZXMoKVtpbmRleCgpXS5sZXZlbChzZWxmLmFiaWxpdGllcygpW2luZGV4KCldLmxldmVsKCkgKyAxKTtcbiAgICAgICAgICAgICAgICBicmVhaztcbiAgICAgICAgICAgICAgICBkZWZhdWx0OlxuICAgICAgICAgICAgICAgICAgICBzZWxmLmFiaWxpdGllcygpW2luZGV4KCldLmxldmVsKHNlbGYuYWJpbGl0aWVzKClbaW5kZXgoKV0ubGV2ZWwoKSArIDEpO1xuICAgICAgICAgICAgICAgIGJyZWFrO1xuICAgICAgICAgICAgfVxuICAgICAgICAgICAgc3dpdGNoIChzZWxmLmFiaWxpdGllcygpW2luZGV4KCldLm5hbWUpIHtcbiAgICAgICAgICAgICAgICBjYXNlICdiZWFzdG1hc3Rlcl9jYWxsX29mX3RoZV93aWxkJzpcbiAgICAgICAgICAgICAgICBjYXNlICdjaGVuX3Rlc3Rfb2ZfZmFpdGgnOlxuICAgICAgICAgICAgICAgIGNhc2UgJ21vcnBobGluZ19tb3JwaF9hZ2knOlxuICAgICAgICAgICAgICAgIGNhc2UgJ3NoYWRvd19kZW1vbl9zaGFkb3dfcG9pc29uJzpcbiAgICAgICAgICAgICAgICAgICAgc2VsZi5hYmlsaXRpZXMoKVtpbmRleCgpICsgMV0ubGV2ZWwoc2VsZi5hYmlsaXRpZXMoKVtpbmRleCgpXS5sZXZlbCgpKTtcbiAgICAgICAgICAgICAgICBicmVhaztcbiAgICAgICAgICAgICAgICBjYXNlICdtb3JwaGxpbmdfbW9ycGhfc3RyJzpcbiAgICAgICAgICAgICAgICAgICAgc2VsZi5hYmlsaXRpZXMoKVtpbmRleCgpIC0gMV0ubGV2ZWwoc2VsZi5hYmlsaXRpZXMoKVtpbmRleCgpXS5sZXZlbCgpKTtcbiAgICAgICAgICAgICAgICBicmVhaztcbiAgICAgICAgICAgICAgICBjYXNlICdrZWVwZXJfb2ZfdGhlX2xpZ2h0X3NwaXJpdF9mb3JtJzpcbiAgICAgICAgICAgICAgICAgICAgc2VsZi5hYmlsaXRpZXMoKVtpbmRleCgpIC0gMV0ubGV2ZWwoc2VsZi5hYmlsaXRpZXMoKVtpbmRleCgpXS5sZXZlbCgpKTtcbiAgICAgICAgICAgICAgICAgICAgc2VsZi5hYmlsaXRpZXMoKVtpbmRleCgpIC0gMl0ubGV2ZWwoc2VsZi5hYmlsaXRpZXMoKVtpbmRleCgpXS5sZXZlbCgpKTtcbiAgICAgICAgICAgICAgICBjYXNlICduZXZlcm1vcmVfc2hhZG93cmF6ZTEnOlxuICAgICAgICAgICAgICAgICAgICBzZWxmLmFiaWxpdGllcygpW2luZGV4KCkgKyAxXS5sZXZlbChzZWxmLmFiaWxpdGllcygpW2luZGV4KCldLmxldmVsKCkpO1xuICAgICAgICAgICAgICAgICAgICBzZWxmLmFiaWxpdGllcygpW2luZGV4KCkgKyAyXS5sZXZlbChzZWxmLmFiaWxpdGllcygpW2luZGV4KCldLmxldmVsKCkpO1xuICAgICAgICAgICAgICAgIGJyZWFrO1xuICAgICAgICAgICAgICAgIGNhc2UgJ25ldmVybW9yZV9zaGFkb3dyYXplMic6XG4gICAgICAgICAgICAgICAgICAgIHNlbGYuYWJpbGl0aWVzKClbaW5kZXgoKSAtIDFdLmxldmVsKHNlbGYuYWJpbGl0aWVzKClbaW5kZXgoKV0ubGV2ZWwoKSk7XG4gICAgICAgICAgICAgICAgICAgIHNlbGYuYWJpbGl0aWVzKClbaW5kZXgoKSArIDFdLmxldmVsKHNlbGYuYWJpbGl0aWVzKClbaW5kZXgoKV0ubGV2ZWwoKSk7XG4gICAgICAgICAgICAgICAgYnJlYWs7XG4gICAgICAgICAgICAgICAgY2FzZSAnbmV2ZXJtb3JlX3NoYWRvd3JhemUzJzpcbiAgICAgICAgICAgICAgICAgICAgc2VsZi5hYmlsaXRpZXMoKVtpbmRleCgpIC0gMV0ubGV2ZWwoc2VsZi5hYmlsaXRpZXMoKVtpbmRleCgpXS5sZXZlbCgpKTtcbiAgICAgICAgICAgICAgICAgICAgc2VsZi5hYmlsaXRpZXMoKVtpbmRleCgpIC0gMl0ubGV2ZWwoc2VsZi5hYmlsaXRpZXMoKVtpbmRleCgpXS5sZXZlbCgpKTtcbiAgICAgICAgICAgICAgICBicmVhaztcbiAgICAgICAgICAgIH1cbiAgICAgICAgfVxuICAgIH07XG4gICAgc2VsZi5sZXZlbERvd25BYmlsaXR5ID0gZnVuY3Rpb24gKGluZGV4LCBkYXRhLCBldmVudCwgaGVybykge1xuICAgICAgICBpZiAoc2VsZi5hYmlsaXRpZXMoKVtpbmRleCgpXS5sZXZlbCgpID4gMCkge1xuICAgICAgICAgICAgc2VsZi5hYmlsaXRpZXMoKVtpbmRleCgpXS5sZXZlbChzZWxmLmFiaWxpdGllcygpW2luZGV4KCldLmxldmVsKCkgLSAxKTtcbiAgICAgICAgICAgIHN3aXRjaCAoc2VsZi5hYmlsaXRpZXMoKVtpbmRleCgpXS5uYW1lKSB7XG4gICAgICAgICAgICAgICAgY2FzZSAnYmVhc3RtYXN0ZXJfY2FsbF9vZl90aGVfd2lsZCc6XG4gICAgICAgICAgICAgICAgY2FzZSAnY2hlbl90ZXN0X29mX2ZhaXRoJzpcbiAgICAgICAgICAgICAgICBjYXNlICdtb3JwaGxpbmdfbW9ycGhfYWdpJzpcbiAgICAgICAgICAgICAgICBjYXNlICdzaGFkb3dfZGVtb25fc2hhZG93X3BvaXNvbic6XG4gICAgICAgICAgICAgICAgICAgIHNlbGYuYWJpbGl0aWVzKClbaW5kZXgoKSArIDFdLmxldmVsKHNlbGYuYWJpbGl0aWVzKClbaW5kZXgoKV0ubGV2ZWwoKSk7XG4gICAgICAgICAgICAgICAgYnJlYWs7XG4gICAgICAgICAgICAgICAgY2FzZSAnbW9ycGhsaW5nX21vcnBoX3N0cic6XG4gICAgICAgICAgICAgICAgICAgIHNlbGYuYWJpbGl0aWVzKClbaW5kZXgoKSAtIDFdLmxldmVsKHNlbGYuYWJpbGl0aWVzKClbaW5kZXgoKV0ubGV2ZWwoKSk7XG4gICAgICAgICAgICAgICAgYnJlYWs7XG4gICAgICAgICAgICAgICAgY2FzZSAna2VlcGVyX29mX3RoZV9saWdodF9zcGlyaXRfZm9ybSc6XG4gICAgICAgICAgICAgICAgICAgIHNlbGYuYWJpbGl0aWVzKClbaW5kZXgoKSAtIDFdLmxldmVsKHNlbGYuYWJpbGl0aWVzKClbaW5kZXgoKV0ubGV2ZWwoKSk7XG4gICAgICAgICAgICAgICAgICAgIHNlbGYuYWJpbGl0aWVzKClbaW5kZXgoKSAtIDJdLmxldmVsKHNlbGYuYWJpbGl0aWVzKClbaW5kZXgoKV0ubGV2ZWwoKSk7XG4gICAgICAgICAgICAgICAgY2FzZSAnbmV2ZXJtb3JlX3NoYWRvd3JhemUxJzpcbiAgICAgICAgICAgICAgICAgICAgc2VsZi5hYmlsaXRpZXMoKVtpbmRleCgpICsgMV0ubGV2ZWwoc2VsZi5hYmlsaXRpZXMoKVtpbmRleCgpXS5sZXZlbCgpKTtcbiAgICAgICAgICAgICAgICAgICAgc2VsZi5hYmlsaXRpZXMoKVtpbmRleCgpICsgMl0ubGV2ZWwoc2VsZi5hYmlsaXRpZXMoKVtpbmRleCgpXS5sZXZlbCgpKTtcbiAgICAgICAgICAgICAgICBicmVhaztcbiAgICAgICAgICAgICAgICBjYXNlICduZXZlcm1vcmVfc2hhZG93cmF6ZTInOlxuICAgICAgICAgICAgICAgICAgICBzZWxmLmFiaWxpdGllcygpW2luZGV4KCkgLSAxXS5sZXZlbChzZWxmLmFiaWxpdGllcygpW2luZGV4KCldLmxldmVsKCkpO1xuICAgICAgICAgICAgICAgICAgICBzZWxmLmFiaWxpdGllcygpW2luZGV4KCkgKyAxXS5sZXZlbChzZWxmLmFiaWxpdGllcygpW2luZGV4KCldLmxldmVsKCkpO1xuICAgICAgICAgICAgICAgIGJyZWFrO1xuICAgICAgICAgICAgICAgIGNhc2UgJ25ldmVybW9yZV9zaGFkb3dyYXplMyc6XG4gICAgICAgICAgICAgICAgICAgIHNlbGYuYWJpbGl0aWVzKClbaW5kZXgoKSAtIDFdLmxldmVsKHNlbGYuYWJpbGl0aWVzKClbaW5kZXgoKV0ubGV2ZWwoKSk7XG4gICAgICAgICAgICAgICAgICAgIHNlbGYuYWJpbGl0aWVzKClbaW5kZXgoKSAtIDJdLmxldmVsKHNlbGYuYWJpbGl0aWVzKClbaW5kZXgoKV0ubGV2ZWwoKSk7XG4gICAgICAgICAgICAgICAgYnJlYWs7XG4gICAgICAgICAgICAgICAgY2FzZSAnZW1iZXJfc3Bpcml0X2ZpcmVfcmVtbmFudCc6XG4gICAgICAgICAgICAgICAgICAgIHNlbGYuYWJpbGl0aWVzKClbaW5kZXgoKSAtIDFdLmxldmVsKHNlbGYuYWJpbGl0aWVzKClbaW5kZXgoKV0ubGV2ZWwoKSk7XG4gICAgICAgICAgICAgICAgYnJlYWs7XG4gICAgICAgICAgICAgICAgY2FzZSAnbG9uZV9kcnVpZF90cnVlX2Zvcm0nOlxuICAgICAgICAgICAgICAgICAgICBzZWxmLmFiaWxpdGllcygpW2luZGV4KCkgLSAxXS5sZXZlbChzZWxmLmFiaWxpdGllcygpW2luZGV4KCldLmxldmVsKCkpO1xuICAgICAgICAgICAgICAgIGJyZWFrO1xuICAgICAgICAgICAgfVxuICAgICAgICB9XG4gICAgfTtcbiAgICBcbiAgICByZXR1cm4gc2VsZjtcbn1cbkJ1ZmZWaWV3TW9kZWwucHJvdG90eXBlID0gT2JqZWN0LmNyZWF0ZShBYmlsaXR5TW9kZWwucHJvdG90eXBlKTtcbkJ1ZmZWaWV3TW9kZWwucHJvdG90eXBlLmNvbnN0cnVjdG9yID0gQnVmZlZpZXdNb2RlbDtcblxubW9kdWxlLmV4cG9ydHMgPSBCdWZmVmlld01vZGVsOyIsInZhciBmaW5kV2hlcmUgPSByZXF1aXJlKFwiLi4vdXRpbC9maW5kV2hlcmVcIik7XG5cbnZhciBCdWZmTW9kZWwgPSBmdW5jdGlvbiAoaGVyb0RhdGEsIHVuaXREYXRhLCBoZXJvLCBhYmlsaXR5KSB7XG4gICAgdGhpcy5idWZmTmFtZSA9IGFiaWxpdHk7XG4gICAgaWYgKGhlcm9EYXRhWyducGNfZG90YV9oZXJvXycgKyBoZXJvXSA9PSB1bmRlZmluZWQpIHtcbiAgICAgICAgdGhpcy5oZXJvID0gaGVybztcbiAgICAgICAgdGhpcy5hYmlsaXR5RGF0YSA9IGZpbmRXaGVyZSh1bml0RGF0YVtoZXJvXS5hYmlsaXRpZXMsIHtuYW1lOiBhYmlsaXR5fSlcbiAgICAgICAgdGhpcy5idWZmRGlzcGxheU5hbWUgPSB1bml0RGF0YVtoZXJvXS5kaXNwbGF5bmFtZSArICcgLSAnICsgdGhpcy5hYmlsaXR5RGF0YS5kaXNwbGF5bmFtZTtcbiAgICB9XG4gICAgZWxzZSB7XG4gICAgICAgIHRoaXMuaGVybyA9ICducGNfZG90YV9oZXJvXycgKyBoZXJvO1xuICAgICAgICB0aGlzLmFiaWxpdHlEYXRhID0gZmluZFdoZXJlKGhlcm9EYXRhWyducGNfZG90YV9oZXJvXycgKyBoZXJvXS5hYmlsaXRpZXMsIHtuYW1lOiBhYmlsaXR5fSlcbiAgICAgICAgdGhpcy5idWZmRGlzcGxheU5hbWUgPSBoZXJvRGF0YVsnbnBjX2RvdGFfaGVyb18nICsgaGVyb10uZGlzcGxheW5hbWUgKyAnIC0gJyArIHRoaXMuYWJpbGl0eURhdGEuZGlzcGxheW5hbWU7ICAgICAgICBcbiAgICAgICAgaWYgKGFiaWxpdHkgPT0gJ3N2ZW5fZ29kc19zdHJlbmd0aCcpIHtcbiAgICAgICAgICAgIHRoaXMuYnVmZkRpc3BsYXlOYW1lICs9ICcgKEF1cmEgZm9yIGFsbGllcyknO1xuICAgICAgICB9XG4gICAgfVxuXG59O1xuXG5tb2R1bGUuZXhwb3J0cyA9IEJ1ZmZNb2RlbDsiLCJ2YXIgQnVmZk1vZGVsID0gcmVxdWlyZShcIi4vQnVmZk1vZGVsXCIpO1xuXG52YXIgYnVmZk9wdGlvbnNBcnJheSA9IHt9O1xuXG52YXIgaW5pdCA9IGZ1bmN0aW9uIChoZXJvRGF0YSwgdW5pdERhdGEpIHtcbiAgICBidWZmT3B0aW9uc0FycmF5Lml0ZW1zID0gW1xuICAgICAgICBuZXcgQnVmZk1vZGVsKGhlcm9EYXRhLCB1bml0RGF0YSwgJ2FiYWRkb24nLCAnYWJhZGRvbl9mcm9zdG1vdXJuZScpLFxuICAgICAgICBuZXcgQnVmZk1vZGVsKGhlcm9EYXRhLCB1bml0RGF0YSwgJ2F4ZScsICdheGVfY3VsbGluZ19ibGFkZScpLFxuICAgICAgICBuZXcgQnVmZk1vZGVsKGhlcm9EYXRhLCB1bml0RGF0YSwgJ2JlYXN0bWFzdGVyJywgJ2JlYXN0bWFzdGVyX2lubmVyX2JlYXN0JyksXG4gICAgICAgIG5ldyBCdWZmTW9kZWwoaGVyb0RhdGEsIHVuaXREYXRhLCAnYmxvb2RzZWVrZXInLCAnYmxvb2RzZWVrZXJfYmxvb2RyYWdlJyksXG4gICAgICAgIG5ldyBCdWZmTW9kZWwoaGVyb0RhdGEsIHVuaXREYXRhLCAnYm91bnR5X2h1bnRlcicsICdib3VudHlfaHVudGVyX3RyYWNrJyksXG4gICAgICAgIG5ldyBCdWZmTW9kZWwoaGVyb0RhdGEsIHVuaXREYXRhLCAnY2VudGF1cicsICdjZW50YXVyX3N0YW1wZWRlJyksXG4gICAgICAgIG5ldyBCdWZmTW9kZWwoaGVyb0RhdGEsIHVuaXREYXRhLCAnY3J5c3RhbF9tYWlkZW4nLCAnY3J5c3RhbF9tYWlkZW5fYnJpbGxpYW5jZV9hdXJhJyksXG4gICAgICAgIG5ldyBCdWZmTW9kZWwoaGVyb0RhdGEsIHVuaXREYXRhLCAnZGFya19zZWVyJywgJ2Rhcmtfc2Vlcl9zdXJnZScpLFxuICAgICAgICBuZXcgQnVmZk1vZGVsKGhlcm9EYXRhLCB1bml0RGF0YSwgJ2RhenpsZScsICdkYXp6bGVfd2VhdmUnKSxcbiAgICAgICAgbmV3IEJ1ZmZNb2RlbChoZXJvRGF0YSwgdW5pdERhdGEsICdkcm93X3JhbmdlcicsICdkcm93X3Jhbmdlcl90cnVlc2hvdCcpLFxuICAgICAgICBuZXcgQnVmZk1vZGVsKGhlcm9EYXRhLCB1bml0RGF0YSwgJ2ludm9rZXInLCAnaW52b2tlcl9hbGFjcml0eScpLFxuICAgICAgICBuZXcgQnVmZk1vZGVsKGhlcm9EYXRhLCB1bml0RGF0YSwgJ3dpc3AnLCAnd2lzcF90ZXRoZXInKSxcbiAgICAgICAgbmV3IEJ1ZmZNb2RlbChoZXJvRGF0YSwgdW5pdERhdGEsICd3aXNwJywgJ3dpc3Bfb3ZlcmNoYXJnZScpLFxuICAgICAgICBuZXcgQnVmZk1vZGVsKGhlcm9EYXRhLCB1bml0RGF0YSwgJ2t1bmtrYScsICdrdW5ra2FfZ2hvc3RzaGlwJyksXG4gICAgICAgIG5ldyBCdWZmTW9kZWwoaGVyb0RhdGEsIHVuaXREYXRhLCAnbGljaCcsICdsaWNoX2Zyb3N0X2FybW9yJyksXG4gICAgICAgIG5ldyBCdWZmTW9kZWwoaGVyb0RhdGEsIHVuaXREYXRhLCAnbGlmZV9zdGVhbGVyJywgJ2xpZmVfc3RlYWxlcl9vcGVuX3dvdW5kcycpLFxuICAgICAgICBuZXcgQnVmZk1vZGVsKGhlcm9EYXRhLCB1bml0RGF0YSwgJ2x1bmEnLCAnbHVuYV9sdW5hcl9ibGVzc2luZycpLFxuICAgICAgICBuZXcgQnVmZk1vZGVsKGhlcm9EYXRhLCB1bml0RGF0YSwgJ2x5Y2FuJywgJ2x5Y2FuX2hvd2wnKSxcbiAgICAgICAgbmV3IEJ1ZmZNb2RlbChoZXJvRGF0YSwgdW5pdERhdGEsICdtYWduYXRhdXInLCAnbWFnbmF0YXVyX2VtcG93ZXInKSxcbiAgICAgICAgbmV3IEJ1ZmZNb2RlbChoZXJvRGF0YSwgdW5pdERhdGEsICdtaXJhbmEnLCAnbWlyYW5hX2xlYXAnKSxcbiAgICAgICAgbmV3IEJ1ZmZNb2RlbChoZXJvRGF0YSwgdW5pdERhdGEsICdvZ3JlX21hZ2knLCAnb2dyZV9tYWdpX2Jsb29kbHVzdCcpLFxuICAgICAgICBuZXcgQnVmZk1vZGVsKGhlcm9EYXRhLCB1bml0RGF0YSwgJ29tbmlrbmlnaHQnLCAnb21uaWtuaWdodF9ndWFyZGlhbl9hbmdlbCcpLFxuICAgICAgICBuZXcgQnVmZk1vZGVsKGhlcm9EYXRhLCB1bml0RGF0YSwgJ3J1YmljaycsICdydWJpY2tfbnVsbF9maWVsZCcpLFxuICAgICAgICBuZXcgQnVmZk1vZGVsKGhlcm9EYXRhLCB1bml0RGF0YSwgJ3NrZWxldG9uX2tpbmcnLCAnc2tlbGV0b25fa2luZ192YW1waXJpY19hdXJhJyksXG4gICAgICAgIG5ldyBCdWZmTW9kZWwoaGVyb0RhdGEsIHVuaXREYXRhLCAnc3Bpcml0X2JyZWFrZXInLCAnc3Bpcml0X2JyZWFrZXJfZW1wb3dlcmluZ19oYXN0ZScpLFxuICAgICAgICBuZXcgQnVmZk1vZGVsKGhlcm9EYXRhLCB1bml0RGF0YSwgJ3N2ZW4nLCAnc3Zlbl93YXJjcnknKSxcbiAgICAgICAgbmV3IEJ1ZmZNb2RlbChoZXJvRGF0YSwgdW5pdERhdGEsICdzdmVuJywgJ3N2ZW5fZ29kc19zdHJlbmd0aCcpLFxuICAgICAgICBuZXcgQnVmZk1vZGVsKGhlcm9EYXRhLCB1bml0RGF0YSwgJ3RyZWFudCcsICd0cmVhbnRfbGl2aW5nX2FybW9yJyksXG4gICAgICAgIG5ldyBCdWZmTW9kZWwoaGVyb0RhdGEsIHVuaXREYXRhLCAndHJvbGxfd2FybG9yZCcsICd0cm9sbF93YXJsb3JkX2JhdHRsZV90cmFuY2UnKSxcbiAgICAgICAgbmV3IEJ1ZmZNb2RlbChoZXJvRGF0YSwgdW5pdERhdGEsICd2ZW5nZWZ1bHNwaXJpdCcsICd2ZW5nZWZ1bHNwaXJpdF9jb21tYW5kX2F1cmEnKSxcbiAgICAgICAgbmV3IEJ1ZmZNb2RlbChoZXJvRGF0YSwgdW5pdERhdGEsICducGNfZG90YV9uZXV0cmFsX2FscGhhX3dvbGYnLCAnYWxwaGFfd29sZl9jcml0aWNhbF9zdHJpa2UnKSxcbiAgICAgICAgbmV3IEJ1ZmZNb2RlbChoZXJvRGF0YSwgdW5pdERhdGEsICducGNfZG90YV9uZXV0cmFsX2FscGhhX3dvbGYnLCAnYWxwaGFfd29sZl9jb21tYW5kX2F1cmEnKSxcbiAgICAgICAgbmV3IEJ1ZmZNb2RlbChoZXJvRGF0YSwgdW5pdERhdGEsICducGNfZG90YV9uZXV0cmFsX3BvbGFyX2Z1cmJvbGdfdXJzYV93YXJyaW9yJywgJ2NlbnRhdXJfa2hhbl9lbmR1cmFuY2VfYXVyYScpLFxuICAgICAgICBuZXcgQnVmZk1vZGVsKGhlcm9EYXRhLCB1bml0RGF0YSwgJ25wY19kb3RhX25ldXRyYWxfZ2lhbnRfd29sZicsICdnaWFudF93b2xmX2NyaXRpY2FsX3N0cmlrZScpLFxuICAgICAgICBuZXcgQnVmZk1vZGVsKGhlcm9EYXRhLCB1bml0RGF0YSwgJ25wY19kb3RhX25ldXRyYWxfa29ib2xkX3Rhc2ttYXN0ZXInLCAna29ib2xkX3Rhc2ttYXN0ZXJfc3BlZWRfYXVyYScpLFxuICAgICAgICBuZXcgQnVmZk1vZGVsKGhlcm9EYXRhLCB1bml0RGF0YSwgJ25wY19kb3RhX25ldXRyYWxfb2dyZV9tYWdpJywgJ29ncmVfbWFnaV9mcm9zdF9hcm1vcicpLFxuICAgICAgICBuZXcgQnVmZk1vZGVsKGhlcm9EYXRhLCB1bml0RGF0YSwgJ25wY19kb3RhX25ldXRyYWxfc2F0eXJfaGVsbGNhbGxlcicsICdzYXR5cl9oZWxsY2FsbGVyX3VuaG9seV9hdXJhJyksXG4gICAgICAgIG5ldyBCdWZmTW9kZWwoaGVyb0RhdGEsIHVuaXREYXRhLCAnbnBjX2RvdGFfbmV1dHJhbF9lbnJhZ2VkX3dpbGRraW4nLCAnZW5yYWdlZF93aWxka2luX3RvdWdobmVzc19hdXJhJyksXG4gICAgICAgIG5ldyBCdWZmTW9kZWwoaGVyb0RhdGEsIHVuaXREYXRhLCAnbnBjX2RvdGFfbmVjcm9ub21pY29uX2FyY2hlcl8xJywgJ25lY3Jvbm9taWNvbl9hcmNoZXJfYW9lJylcbiAgICBdO1xuICAgIHJldHVybiBidWZmT3B0aW9uc0FycmF5Lml0ZW1zO1xufVxuXG5idWZmT3B0aW9uc0FycmF5LmluaXQgPSBpbml0O1xuXG5tb2R1bGUuZXhwb3J0cyA9IGJ1ZmZPcHRpb25zQXJyYXk7IiwidmFyIEJ1ZmZNb2RlbCA9IHJlcXVpcmUoXCIuL0J1ZmZNb2RlbFwiKTtcblxudmFyIGRlYnVmZk9wdGlvbnNBcnJheSA9IHt9O1xuXG52YXIgaW5pdCA9IGZ1bmN0aW9uIChoZXJvRGF0YSwgdW5pdERhdGEpIHtcbiAgICBkZWJ1ZmZPcHRpb25zQXJyYXkuaXRlbXMgPSBbXG4gICAgICAgIG5ldyBCdWZmTW9kZWwoaGVyb0RhdGEsIHVuaXREYXRhLCAnYWJhZGRvbicsICdhYmFkZG9uX2Zyb3N0bW91cm5lJyksXG4gICAgICAgIG5ldyBCdWZmTW9kZWwoaGVyb0RhdGEsIHVuaXREYXRhLCAnYWxjaGVtaXN0JywgJ2FsY2hlbWlzdF9hY2lkX3NwcmF5JyksXG4gICAgICAgIG5ldyBCdWZmTW9kZWwoaGVyb0RhdGEsIHVuaXREYXRhLCAnYW5jaWVudF9hcHBhcml0aW9uJywgJ2FuY2llbnRfYXBwYXJpdGlvbl9pY2Vfdm9ydGV4JyksXG4gICAgICAgIG5ldyBCdWZmTW9kZWwoaGVyb0RhdGEsIHVuaXREYXRhLCAnYXhlJywgJ2F4ZV9iYXR0bGVfaHVuZ2VyJyksXG4gICAgICAgIG5ldyBCdWZmTW9kZWwoaGVyb0RhdGEsIHVuaXREYXRhLCAnYmFuZScsICdiYW5lX2VuZmVlYmxlJyksXG4gICAgICAgIG5ldyBCdWZmTW9kZWwoaGVyb0RhdGEsIHVuaXREYXRhLCAnYmF0cmlkZXInLCAnYmF0cmlkZXJfc3RpY2t5X25hcGFsbScpLFxuICAgICAgICBuZXcgQnVmZk1vZGVsKGhlcm9EYXRhLCB1bml0RGF0YSwgJ2JlYXN0bWFzdGVyJywgJ2JlYXN0bWFzdGVyX3ByaW1hbF9yb2FyJyksXG4gICAgICAgIG5ldyBCdWZmTW9kZWwoaGVyb0RhdGEsIHVuaXREYXRhLCAnYm91bnR5X2h1bnRlcicsICdib3VudHlfaHVudGVyX2ppbmFkYScpLFxuICAgICAgICBuZXcgQnVmZk1vZGVsKGhlcm9EYXRhLCB1bml0RGF0YSwgJ2JyZXdtYXN0ZXInLCAnYnJld21hc3Rlcl90aHVuZGVyX2NsYXAnKSxcbiAgICAgICAgbmV3IEJ1ZmZNb2RlbChoZXJvRGF0YSwgdW5pdERhdGEsICdicmV3bWFzdGVyJywgJ2JyZXdtYXN0ZXJfZHJ1bmtlbl9oYXplJyksXG4gICAgICAgIG5ldyBCdWZmTW9kZWwoaGVyb0RhdGEsIHVuaXREYXRhLCAnYnJpc3RsZWJhY2snLCAnYnJpc3RsZWJhY2tfdmlzY291c19uYXNhbF9nb28nKSxcbiAgICAgICAgbmV3IEJ1ZmZNb2RlbChoZXJvRGF0YSwgdW5pdERhdGEsICdicm9vZG1vdGhlcicsICdicm9vZG1vdGhlcl9pbmNhcGFjaXRhdGluZ19iaXRlJyksXG4gICAgICAgIG5ldyBCdWZmTW9kZWwoaGVyb0RhdGEsIHVuaXREYXRhLCAnY2VudGF1cicsICdjZW50YXVyX3N0YW1wZWRlJyksXG4gICAgICAgIG5ldyBCdWZmTW9kZWwoaGVyb0RhdGEsIHVuaXREYXRhLCAnY2hlbicsICdjaGVuX3Blbml0ZW5jZScpLFxuICAgICAgICBuZXcgQnVmZk1vZGVsKGhlcm9EYXRhLCB1bml0RGF0YSwgJ2NyeXN0YWxfbWFpZGVuJywgJ2NyeXN0YWxfbWFpZGVuX2NyeXN0YWxfbm92YScpLFxuICAgICAgICBuZXcgQnVmZk1vZGVsKGhlcm9EYXRhLCB1bml0RGF0YSwgJ2NyeXN0YWxfbWFpZGVuJywgJ2NyeXN0YWxfbWFpZGVuX2ZyZWV6aW5nX2ZpZWxkJyksXG4gICAgICAgIG5ldyBCdWZmTW9kZWwoaGVyb0RhdGEsIHVuaXREYXRhLCAnZGF6emxlJywgJ2RhenpsZV93ZWF2ZScpLFxuICAgICAgICBuZXcgQnVmZk1vZGVsKGhlcm9EYXRhLCB1bml0RGF0YSwgJ2Ryb3dfcmFuZ2VyJywgJ2Ryb3dfcmFuZ2VyX2Zyb3N0X2Fycm93cycpLFxuICAgICAgICBuZXcgQnVmZk1vZGVsKGhlcm9EYXRhLCB1bml0RGF0YSwgJ2VhcnRoX3NwaXJpdCcsICdlYXJ0aF9zcGlyaXRfcm9sbGluZ19ib3VsZGVyJyksXG4gICAgICAgIG5ldyBCdWZmTW9kZWwoaGVyb0RhdGEsIHVuaXREYXRhLCAnZWxkZXJfdGl0YW4nLCAnZWxkZXJfdGl0YW5fbmF0dXJhbF9vcmRlcicpLFxuICAgICAgICBuZXcgQnVmZk1vZGVsKGhlcm9EYXRhLCB1bml0RGF0YSwgJ2VsZGVyX3RpdGFuJywgJ2VsZGVyX3RpdGFuX2VhcnRoX3NwbGl0dGVyJyksXG4gICAgICAgIG5ldyBCdWZmTW9kZWwoaGVyb0RhdGEsIHVuaXREYXRhLCAnZW5jaGFudHJlc3MnLCAnZW5jaGFudHJlc3NfdW50b3VjaGFibGUnKSxcbiAgICAgICAgbmV3IEJ1ZmZNb2RlbChoZXJvRGF0YSwgdW5pdERhdGEsICdlbmNoYW50cmVzcycsICdlbmNoYW50cmVzc19lbmNoYW50JyksXG4gICAgICAgIG5ldyBCdWZmTW9kZWwoaGVyb0RhdGEsIHVuaXREYXRhLCAnZmFjZWxlc3Nfdm9pZCcsICdmYWNlbGVzc192b2lkX3RpbWVfd2FsaycpLFxuICAgICAgICBuZXcgQnVmZk1vZGVsKGhlcm9EYXRhLCB1bml0RGF0YSwgJ2h1c2thcicsICdodXNrYXJfbGlmZV9icmVhaycpLFxuICAgICAgICBuZXcgQnVmZk1vZGVsKGhlcm9EYXRhLCB1bml0RGF0YSwgJ2ludm9rZXInLCAnaW52b2tlcl9naG9zdF93YWxrJyksXG4gICAgICAgIG5ldyBCdWZmTW9kZWwoaGVyb0RhdGEsIHVuaXREYXRhLCAnaW52b2tlcicsICdpbnZva2VyX2ljZV93YWxsJyksXG4gICAgICAgIG5ldyBCdWZmTW9kZWwoaGVyb0RhdGEsIHVuaXREYXRhLCAnd2lzcCcsICd3aXNwX3RldGhlcicpLFxuICAgICAgICBuZXcgQnVmZk1vZGVsKGhlcm9EYXRhLCB1bml0RGF0YSwgJ2pha2lybycsICdqYWtpcm9fZHVhbF9icmVhdGgnKSxcbiAgICAgICAgbmV3IEJ1ZmZNb2RlbChoZXJvRGF0YSwgdW5pdERhdGEsICdqYWtpcm8nLCAnamFraXJvX2xpcXVpZF9maXJlJyksXG4gICAgICAgIG5ldyBCdWZmTW9kZWwoaGVyb0RhdGEsIHVuaXREYXRhLCAna2VlcGVyX29mX3RoZV9saWdodCcsICdrZWVwZXJfb2ZfdGhlX2xpZ2h0X2JsaW5kaW5nX2xpZ2h0JyksXG4gICAgICAgIG5ldyBCdWZmTW9kZWwoaGVyb0RhdGEsIHVuaXREYXRhLCAna3Vua2thJywgJ2t1bmtrYV90b3JyZW50JyksXG4gICAgICAgIG5ldyBCdWZmTW9kZWwoaGVyb0RhdGEsIHVuaXREYXRhLCAnbGljaCcsICdsaWNoX2Zyb3N0X25vdmEnKSxcbiAgICAgICAgbmV3IEJ1ZmZNb2RlbChoZXJvRGF0YSwgdW5pdERhdGEsICdsaWNoJywgJ2xpY2hfZnJvc3RfYXJtb3InKSxcbiAgICAgICAgbmV3IEJ1ZmZNb2RlbChoZXJvRGF0YSwgdW5pdERhdGEsICdsaWNoJywgJ2xpY2hfY2hhaW5fZnJvc3QnKSxcbiAgICAgICAgbmV3IEJ1ZmZNb2RlbChoZXJvRGF0YSwgdW5pdERhdGEsICdsaWZlX3N0ZWFsZXInLCAnbGlmZV9zdGVhbGVyX29wZW5fd291bmRzJyksXG4gICAgICAgIG5ldyBCdWZmTW9kZWwoaGVyb0RhdGEsIHVuaXREYXRhLCAnbGlvbicsICdsaW9uX3Zvb2RvbycpLFxuICAgICAgICBuZXcgQnVmZk1vZGVsKGhlcm9EYXRhLCB1bml0RGF0YSwgJ21hZ25hdGF1cicsICdtYWduYXRhdXJfc2tld2VyJyksXG4gICAgICAgIG5ldyBCdWZmTW9kZWwoaGVyb0RhdGEsIHVuaXREYXRhLCAnbWVkdXNhJywgJ21lZHVzYV9zdG9uZV9nYXplJyksXG4gICAgICAgIG5ldyBCdWZmTW9kZWwoaGVyb0RhdGEsIHVuaXREYXRhLCAnbWVlcG8nLCAnbWVlcG9fZ2Vvc3RyaWtlJyksXG4gICAgICAgIG5ldyBCdWZmTW9kZWwoaGVyb0RhdGEsIHVuaXREYXRhLCAnbmFnYV9zaXJlbicsICduYWdhX3NpcmVuX3JpcF90aWRlJyksXG4gICAgICAgIG5ldyBCdWZmTW9kZWwoaGVyb0RhdGEsIHVuaXREYXRhLCAnbmlnaHRfc3RhbGtlcicsICduaWdodF9zdGFsa2VyX3ZvaWQnKSxcbiAgICAgICAgbmV3IEJ1ZmZNb2RlbChoZXJvRGF0YSwgdW5pdERhdGEsICduaWdodF9zdGFsa2VyJywgJ25pZ2h0X3N0YWxrZXJfY3JpcHBsaW5nX2ZlYXInKSxcbiAgICAgICAgbmV3IEJ1ZmZNb2RlbChoZXJvRGF0YSwgdW5pdERhdGEsICduaWdodF9zdGFsa2VyJywgJ25pZ2h0X3N0YWxrZXJfZGFya25lc3MnKSxcbiAgICAgICAgbmV3IEJ1ZmZNb2RlbChoZXJvRGF0YSwgdW5pdERhdGEsICdvZ3JlX21hZ2knLCAnb2dyZV9tYWdpX2lnbml0ZScpLFxuICAgICAgICBuZXcgQnVmZk1vZGVsKGhlcm9EYXRhLCB1bml0RGF0YSwgJ29tbmlrbmlnaHQnLCAnb21uaWtuaWdodF9kZWdlbl9hdXJhJyksXG4gICAgICAgIG5ldyBCdWZmTW9kZWwoaGVyb0RhdGEsIHVuaXREYXRhLCAncGhhbnRvbV9hc3Nhc3NpbicsICdwaGFudG9tX2Fzc2Fzc2luX3N0aWZsaW5nX2RhZ2dlcicpLFxuICAgICAgICBuZXcgQnVmZk1vZGVsKGhlcm9EYXRhLCB1bml0RGF0YSwgJ3BoYW50b21fbGFuY2VyJywgJ3BoYW50b21fbGFuY2VyX3NwaXJpdF9sYW5jZScpLFxuICAgICAgICBuZXcgQnVmZk1vZGVsKGhlcm9EYXRhLCB1bml0RGF0YSwgJ3B1ZGdlJywgJ3B1ZGdlX3JvdCcpLFxuICAgICAgICBuZXcgQnVmZk1vZGVsKGhlcm9EYXRhLCB1bml0RGF0YSwgJ3B1Z25hJywgJ3B1Z25hX2RlY3JlcGlmeScpLFxuICAgICAgICBuZXcgQnVmZk1vZGVsKGhlcm9EYXRhLCB1bml0RGF0YSwgJ3F1ZWVub2ZwYWluJywgJ3F1ZWVub2ZwYWluX3NoYWRvd19zdHJpa2UnKSxcbiAgICAgICAgbmV3IEJ1ZmZNb2RlbChoZXJvRGF0YSwgdW5pdERhdGEsICdyaWtpJywgJ3Jpa2lfc21va2Vfc2NyZWVuJyksXG4gICAgICAgIG5ldyBCdWZmTW9kZWwoaGVyb0RhdGEsIHVuaXREYXRhLCAncnViaWNrJywgJ3J1Ymlja19mYWRlX2JvbHQnKSxcbiAgICAgICAgbmV3IEJ1ZmZNb2RlbChoZXJvRGF0YSwgdW5pdERhdGEsICdzYW5kX2tpbmcnLCAnc2FuZGtpbmdfZXBpY2VudGVyJyksXG4gICAgICAgIG5ldyBCdWZmTW9kZWwoaGVyb0RhdGEsIHVuaXREYXRhLCAnbmV2ZXJtb3JlJywgJ25ldmVybW9yZV9kYXJrX2xvcmQnKSxcbiAgICAgICAgbmV3IEJ1ZmZNb2RlbChoZXJvRGF0YSwgdW5pdERhdGEsICdzaGFkb3dfc2hhbWFuJywgJ3NoYWRvd19zaGFtYW5fdm9vZG9vJyksXG4gICAgICAgIG5ldyBCdWZmTW9kZWwoaGVyb0RhdGEsIHVuaXREYXRhLCAnc2tlbGV0b25fa2luZycsICdza2VsZXRvbl9raW5nX2hlbGxmaXJlX2JsYXN0JyksXG4gICAgICAgIG5ldyBCdWZmTW9kZWwoaGVyb0RhdGEsIHVuaXREYXRhLCAnc2tlbGV0b25fa2luZycsICdza2VsZXRvbl9raW5nX3JlaW5jYXJuYXRpb24nKSxcbiAgICAgICAgbmV3IEJ1ZmZNb2RlbChoZXJvRGF0YSwgdW5pdERhdGEsICdza3l3cmF0aF9tYWdlJywgJ3NreXdyYXRoX21hZ2VfY29uY3Vzc2l2ZV9zaG90JyksXG4gICAgICAgIG5ldyBCdWZmTW9kZWwoaGVyb0RhdGEsIHVuaXREYXRhLCAnc2t5d3JhdGhfbWFnZScsICdza3l3cmF0aF9tYWdlX2FuY2llbnRfc2VhbCcpLFxuICAgICAgICBuZXcgQnVmZk1vZGVsKGhlcm9EYXRhLCB1bml0RGF0YSwgJ3NsYXJkYXInLCAnc2xhcmRhcl9zbGl0aGVyZWVuX2NydXNoJyksXG4gICAgICAgIG5ldyBCdWZmTW9kZWwoaGVyb0RhdGEsIHVuaXREYXRhLCAnc2xhcmRhcicsICdzbGFyZGFyX2FtcGxpZnlfZGFtYWdlJyksXG4gICAgICAgIG5ldyBCdWZmTW9kZWwoaGVyb0RhdGEsIHVuaXREYXRhLCAnc2xhcmsnLCAnc2xhcmtfZXNzZW5jZV9zaGlmdCcpLFxuICAgICAgICBuZXcgQnVmZk1vZGVsKGhlcm9EYXRhLCB1bml0RGF0YSwgJ3NuaXBlcicsICdzbmlwZXJfc2hyYXBuZWwnKSxcbiAgICAgICAgbmV3IEJ1ZmZNb2RlbChoZXJvRGF0YSwgdW5pdERhdGEsICdzcGVjdHJlJywgJ3NwZWN0cmVfc3BlY3RyYWxfZGFnZ2VyJyksXG4gICAgICAgIG5ldyBCdWZmTW9kZWwoaGVyb0RhdGEsIHVuaXREYXRhLCAnc3Rvcm1fc3Bpcml0JywgJ3N0b3JtX3NwaXJpdF9vdmVybG9hZCcpLFxuICAgICAgICBuZXcgQnVmZk1vZGVsKGhlcm9EYXRhLCB1bml0RGF0YSwgJ3RlbXBsYXJfYXNzYXNzaW4nLCAndGVtcGxhcl9hc3Nhc3Npbl9tZWxkJyksXG4gICAgICAgIG5ldyBCdWZmTW9kZWwoaGVyb0RhdGEsIHVuaXREYXRhLCAndGlkZWh1bnRlcicsICd0aWRlaHVudGVyX2d1c2gnKSxcbiAgICAgICAgbmV3IEJ1ZmZNb2RlbChoZXJvRGF0YSwgdW5pdERhdGEsICd0aW5rZXInLCAndGlua2VyX2xhc2VyJyksXG4gICAgICAgIG5ldyBCdWZmTW9kZWwoaGVyb0RhdGEsIHVuaXREYXRhLCAndHJlYW50JywgJ3RyZWFudF9sZWVjaF9zZWVkJyksXG4gICAgICAgIG5ldyBCdWZmTW9kZWwoaGVyb0RhdGEsIHVuaXREYXRhLCAndHVzaycsICd0dXNrX2Zyb3plbl9zaWdpbCcpLFxuICAgICAgICBuZXcgQnVmZk1vZGVsKGhlcm9EYXRhLCB1bml0RGF0YSwgJ3VuZHlpbmcnLCAndW5keWluZ19mbGVzaF9nb2xlbScpLFxuICAgICAgICBuZXcgQnVmZk1vZGVsKGhlcm9EYXRhLCB1bml0RGF0YSwgJ3Vyc2EnLCAndXJzYV9lYXJ0aHNob2NrJyksXG4gICAgICAgIG5ldyBCdWZmTW9kZWwoaGVyb0RhdGEsIHVuaXREYXRhLCAndmVuZ2VmdWxzcGlyaXQnLCAndmVuZ2VmdWxzcGlyaXRfd2F2ZV9vZl90ZXJyb3InKSxcbiAgICAgICAgbmV3IEJ1ZmZNb2RlbChoZXJvRGF0YSwgdW5pdERhdGEsICd2ZW5nZWZ1bHNwaXJpdCcsICd2ZW5nZWZ1bHNwaXJpdF9jb21tYW5kX2F1cmEnKSxcbiAgICAgICAgbmV3IEJ1ZmZNb2RlbChoZXJvRGF0YSwgdW5pdERhdGEsICd2ZW5vbWFuY2VyJywgJ3Zlbm9tYW5jZXJfdmVub21vdXNfZ2FsZScpLFxuICAgICAgICBuZXcgQnVmZk1vZGVsKGhlcm9EYXRhLCB1bml0RGF0YSwgJ3Zlbm9tYW5jZXInLCAndmVub21hbmNlcl9wb2lzb25fc3RpbmcnKSxcbiAgICAgICAgbmV3IEJ1ZmZNb2RlbChoZXJvRGF0YSwgdW5pdERhdGEsICd2aXBlcicsICd2aXBlcl9wb2lzb25fYXR0YWNrJyksXG4gICAgICAgIG5ldyBCdWZmTW9kZWwoaGVyb0RhdGEsIHVuaXREYXRhLCAndmlwZXInLCAndmlwZXJfY29ycm9zaXZlX3NraW4nKSxcbiAgICAgICAgbmV3IEJ1ZmZNb2RlbChoZXJvRGF0YSwgdW5pdERhdGEsICd2aXBlcicsICd2aXBlcl92aXBlcl9zdHJpa2UnKSxcbiAgICAgICAgbmV3IEJ1ZmZNb2RlbChoZXJvRGF0YSwgdW5pdERhdGEsICd2aXNhZ2UnLCAndmlzYWdlX2dyYXZlX2NoaWxsJyksXG4gICAgICAgIG5ldyBCdWZmTW9kZWwoaGVyb0RhdGEsIHVuaXREYXRhLCAnd2FybG9jaycsICd3YXJsb2NrX3VwaGVhdmFsJyksXG4gICAgICAgIG5ldyBCdWZmTW9kZWwoaGVyb0RhdGEsIHVuaXREYXRhLCAnd2VhdmVyJywgJ3dlYXZlcl90aGVfc3dhcm0nKSxcbiAgICAgICAgbmV3IEJ1ZmZNb2RlbChoZXJvRGF0YSwgdW5pdERhdGEsICd3aW5kcnVubmVyJywgJ3dpbmRydW5uZXJfd2luZHJ1bicpLFxuICAgICAgICBuZXcgQnVmZk1vZGVsKGhlcm9EYXRhLCB1bml0RGF0YSwgJ3dpbnRlcl93eXZlcm4nLCAnd2ludGVyX3d5dmVybl9hcmN0aWNfYnVybicpLFxuICAgICAgICBuZXcgQnVmZk1vZGVsKGhlcm9EYXRhLCB1bml0RGF0YSwgJ3dpbnRlcl93eXZlcm4nLCAnd2ludGVyX3d5dmVybl9zcGxpbnRlcl9ibGFzdCcpLFxuICAgICAgICBuZXcgQnVmZk1vZGVsKGhlcm9EYXRhLCB1bml0RGF0YSwgJ25wY19kb3RhX25ldXRyYWxfZ2hvc3QnLCAnZ2hvc3RfZnJvc3RfYXR0YWNrJyksXG4gICAgICAgIG5ldyBCdWZmTW9kZWwoaGVyb0RhdGEsIHVuaXREYXRhLCAnbnBjX2RvdGFfbmV1dHJhbF9wb2xhcl9mdXJib2xnX3Vyc2Ffd2FycmlvcicsICdwb2xhcl9mdXJib2xnX3Vyc2Ffd2Fycmlvcl90aHVuZGVyX2NsYXAnKSxcbiAgICAgICAgbmV3IEJ1ZmZNb2RlbChoZXJvRGF0YSwgdW5pdERhdGEsICducGNfZG90YV9uZXV0cmFsX29ncmVfbWFnaScsICdvZ3JlX21hZ2lfZnJvc3RfYXJtb3InKSxcbiAgICAgICAgbmV3IEJ1ZmZNb2RlbChoZXJvRGF0YSwgdW5pdERhdGEsICducGNfZG90YV9uZXV0cmFsX3NhdHlyX3RyaWNrc3RlcicsICdzYXR5cl90cmlja3N0ZXJfcHVyZ2UnKSxcbiAgICAgICAgbmV3IEJ1ZmZNb2RlbChoZXJvRGF0YSwgdW5pdERhdGEsICducGNfZG90YV9uZXV0cmFsX2VucmFnZWRfd2lsZGtpbicsICdlbnJhZ2VkX3dpbGRraW5fdG9ybmFkbycpXG4gICAgXTtcbiAgICByZXR1cm4gZGVidWZmT3B0aW9uc0FycmF5Lml0ZW1zO1xufVxuXG5kZWJ1ZmZPcHRpb25zQXJyYXkuaW5pdCA9IGluaXQ7XG5cbm1vZHVsZS5leHBvcnRzID0gZGVidWZmT3B0aW9uc0FycmF5OyIsInZhciBIZXJvQ2FsY0RhdGEgPSAodHlwZW9mIHdpbmRvdyAhPT0gXCJ1bmRlZmluZWRcIiA/IHdpbmRvd1snSGVyb0NhbGNEYXRhJ10gOiB0eXBlb2YgZ2xvYmFsICE9PSBcInVuZGVmaW5lZFwiID8gZ2xvYmFsWydIZXJvQ2FsY0RhdGEnXSA6IG51bGwpIHx8IHt9O1xudmFyIGdldEpTT04gPSByZXF1aXJlKFwiLi4vdXRpbC9nZXRKU09OXCIpO1xudmFyIGlzRW1wdHkgPSByZXF1aXJlKFwiLi4vdXRpbC9pc0VtcHR5XCIpO1xudmFyIGV4dGVuZCA9IGZ1bmN0aW9uKG91dCkge1xuICBvdXQgPSBvdXQgfHwge307XG5cbiAgZm9yICh2YXIgaSA9IDE7IGkgPCBhcmd1bWVudHMubGVuZ3RoOyBpKyspIHtcbiAgICBpZiAoIWFyZ3VtZW50c1tpXSlcbiAgICAgIGNvbnRpbnVlO1xuXG4gICAgZm9yICh2YXIga2V5IGluIGFyZ3VtZW50c1tpXSkge1xuICAgICAgaWYgKGFyZ3VtZW50c1tpXS5oYXNPd25Qcm9wZXJ0eShrZXkpKVxuICAgICAgICBvdXRba2V5XSA9IGFyZ3VtZW50c1tpXVtrZXldO1xuICAgIH1cbiAgfVxuXG4gIHJldHVybiBvdXQ7XG59O1xuXG52YXIgcmVzb3VyY2VDb3VudGVyID0gMDtcblxudmFyIG9uUmVzb3VyY2VMb2FkZWQgPSBmdW5jdGlvbiAoY2FsbGJhY2spIHtcbiAgICByZXNvdXJjZUNvdW50ZXItLTtcbiAgICBpZiAocmVzb3VyY2VDb3VudGVyID09PSAwKSB7XG4gICAgICAgIGZpeEhlcm9EYXRhKEhlcm9DYWxjRGF0YS5oZXJvRGF0YSk7XG4gICAgICAgIGlmIChjYWxsYmFjaykgY2FsbGJhY2soKTtcbiAgICB9XG59XG5cbnZhciBmaXhIZXJvRGF0YSA9IGZ1bmN0aW9uIChoZXJvRGF0YSkge1xuICAgIGhlcm9EYXRhWyducGNfZG90YV9oZXJvX2ludm9rZXInXS5hYmlsaXRpZXNbNV0uYmVoYXZpb3IucHVzaCgnRE9UQV9BQklMSVRZX0JFSEFWSU9SX05PVF9MRUFSTkFCTEUnKTtcbiAgICBoZXJvRGF0YVsnbnBjX2RvdGFfaGVyb19jaGVuJ10uYWJpbGl0aWVzWzJdLmJlaGF2aW9yLnB1c2goJ0RPVEFfQUJJTElUWV9CRUhBVklPUl9OT1RfTEVBUk5BQkxFJyk7XG4gICAgaGVyb0RhdGFbJ25wY19kb3RhX2hlcm9fbmV2ZXJtb3JlJ10uYWJpbGl0aWVzWzFdLmJlaGF2aW9yLnB1c2goJ0RPVEFfQUJJTElUWV9CRUhBVklPUl9OT1RfTEVBUk5BQkxFJyk7XG4gICAgaGVyb0RhdGFbJ25wY19kb3RhX2hlcm9fbmV2ZXJtb3JlJ10uYWJpbGl0aWVzWzJdLmJlaGF2aW9yLnB1c2goJ0RPVEFfQUJJTElUWV9CRUhBVklPUl9OT1RfTEVBUk5BQkxFJyk7XG4gICAgaGVyb0RhdGFbJ25wY19kb3RhX2hlcm9fbW9ycGhsaW5nJ10uYWJpbGl0aWVzWzNdLmJlaGF2aW9yLnB1c2goJ0RPVEFfQUJJTElUWV9CRUhBVklPUl9OT1RfTEVBUk5BQkxFJyk7XG4gICAgaGVyb0RhdGFbJ25wY19kb3RhX2hlcm9fb2dyZV9tYWdpJ10uYWJpbGl0aWVzWzNdLmJlaGF2aW9yLnB1c2goJ0RPVEFfQUJJTElUWV9CRUhBVklPUl9OT1RfTEVBUk5BQkxFJyk7XG4gICAgaGVyb0RhdGFbJ25wY19kb3RhX2hlcm9fdGVjaGllcyddLmFiaWxpdGllc1s0XS5iZWhhdmlvci5wdXNoKCdET1RBX0FCSUxJVFlfQkVIQVZJT1JfTk9UX0xFQVJOQUJMRScpO1xuICAgIGhlcm9EYXRhWyducGNfZG90YV9oZXJvX2JlYXN0bWFzdGVyJ10uYWJpbGl0aWVzWzJdLmJlaGF2aW9yLnB1c2goJ0RPVEFfQUJJTElUWV9CRUhBVklPUl9OT1RfTEVBUk5BQkxFJyk7XG5cbiAgICB2YXIgaW5kZXggPSBoZXJvRGF0YVsnbnBjX2RvdGFfaGVyb19sb25lX2RydWlkJ10uYWJpbGl0aWVzWzNdLmJlaGF2aW9yLmluZGV4T2YoJ0RPVEFfQUJJTElUWV9CRUhBVklPUl9ISURERU4nKTtcbiAgICBoZXJvRGF0YVsnbnBjX2RvdGFfaGVyb19sb25lX2RydWlkJ10uYWJpbGl0aWVzWzNdLmJlaGF2aW9yLnNwbGljZShpbmRleCwgMSk7XG5cbiAgICBpbmRleCA9IGhlcm9EYXRhWyducGNfZG90YV9oZXJvX2FiYWRkb24nXS5hYmlsaXRpZXNbMl0uYmVoYXZpb3IuaW5kZXhPZignRE9UQV9BQklMSVRZX0JFSEFWSU9SX1BBU1NJVkUnKTtcbiAgICBoZXJvRGF0YVsnbnBjX2RvdGFfaGVyb19hYmFkZG9uJ10uYWJpbGl0aWVzWzJdLmJlaGF2aW9yLnNwbGljZShpbmRleCwgMSk7XG5cbiAgICBpbmRleCA9IGhlcm9EYXRhWyducGNfZG90YV9oZXJvX3Jpa2knXS5hYmlsaXRpZXNbMl0uYmVoYXZpb3IuaW5kZXhPZignRE9UQV9BQklMSVRZX0JFSEFWSU9SX1BBU1NJVkUnKTtcbiAgICBoZXJvRGF0YVsnbnBjX2RvdGFfaGVyb19yaWtpJ10uYWJpbGl0aWVzWzJdLmJlaGF2aW9yLnNwbGljZShpbmRleCwgMSk7XG59XG5cbnZhciBpbml0ID0gZnVuY3Rpb24gKEhFUk9EQVRBX1BBVEgsIElURU1EQVRBX1BBVEgsIFVOSVREQVRBX1BBVEgsIGNhbGxiYWNrKSB7XG4gICAgcmVzb3VyY2VDb3VudGVyID0gMztcbiAgICBcbiAgICBpZiAoIUhlcm9DYWxjRGF0YS5oZXJvRGF0YSB8fCBpc0VtcHR5KEhlcm9DYWxjRGF0YS5oZXJvRGF0YSkpIHtcbiAgICAgICAgaWYgKEhFUk9EQVRBX1BBVEgpIHtcbiAgICAgICAgICAgIGdldEpTT04oSEVST0RBVEFfUEFUSCwgZnVuY3Rpb24gKGRhdGEpIHtcbiAgICAgICAgICAgICAgICBIZXJvQ2FsY0RhdGEuaGVyb0RhdGEgPSBkYXRhO1xuICAgICAgICAgICAgICAgIG9uUmVzb3VyY2VMb2FkZWQoY2FsbGJhY2spO1xuICAgICAgICAgICAgfSk7XG4gICAgICAgIH1cbiAgICB9XG4gICAgZWxzZSB7XG4gICAgICAgIG9uUmVzb3VyY2VMb2FkZWQoY2FsbGJhY2spO1xuICAgIH1cbiAgICBcbiAgICBpZiAoIUhlcm9DYWxjRGF0YS5pdGVtRGF0YSB8fCBpc0VtcHR5KEhlcm9DYWxjRGF0YS5pdGVtRGF0YSkpIHtcbiAgICAgICAgaWYgKElURU1EQVRBX1BBVEgpIHtcbiAgICAgICAgICAgIGdldEpTT04oSVRFTURBVEFfUEFUSCwgZnVuY3Rpb24gKGRhdGEpIHtcbiAgICAgICAgICAgICAgICBIZXJvQ2FsY0RhdGEuaXRlbURhdGEgPSBkYXRhO1xuICAgICAgICAgICAgICAgIG9uUmVzb3VyY2VMb2FkZWQoY2FsbGJhY2spO1xuICAgICAgICAgICAgfSk7XG4gICAgICAgIH1cbiAgICB9XG4gICAgZWxzZSB7XG4gICAgICAgIG9uUmVzb3VyY2VMb2FkZWQoY2FsbGJhY2spO1xuICAgIH1cbiAgICBcbiAgICBpZiAoIUhlcm9DYWxjRGF0YS51bml0RGF0YSB8fCBpc0VtcHR5KEhlcm9DYWxjRGF0YS51bml0RGF0YSkpIHtcbiAgICAgICAgaWYgKFVOSVREQVRBX1BBVEgpIHtcbiAgICAgICAgICAgIGdldEpTT04oVU5JVERBVEFfUEFUSCwgZnVuY3Rpb24gKGRhdGEpIHtcbiAgICAgICAgICAgICAgICBIZXJvQ2FsY0RhdGEudW5pdERhdGEgPSBkYXRhO1xuICAgICAgICAgICAgICAgIG9uUmVzb3VyY2VMb2FkZWQoY2FsbGJhY2spO1xuICAgICAgICAgICAgfSk7XG4gICAgICAgIH1cbiAgICB9XG4gICAgZWxzZSB7XG4gICAgICAgIG9uUmVzb3VyY2VMb2FkZWQoY2FsbGJhY2spO1xuICAgIH1cbn1cbiAgICBcbkhlcm9DYWxjRGF0YS5pbml0ID0gaW5pdDtcblxubW9kdWxlLmV4cG9ydHMgPSBIZXJvQ2FsY0RhdGE7IiwiJ3VzZSBzdHJpY3QnO1xudmFyIEhlcm9Nb2RlbCA9IHJlcXVpcmUoXCIuL0hlcm9Nb2RlbFwiKTtcblxudmFyIENsb25lTW9kZWwgPSBmdW5jdGlvbiAoaGVyb0RhdGEsIGl0ZW1EYXRhLCBoLHApIHtcbiAgICB2YXIgc2VsZiA9IHRoaXM7XG4gICAgSGVyb01vZGVsLmNhbGwodGhpcywgaGVyb0RhdGEsIGl0ZW1EYXRhLCBoKTtcbiAgICBzZWxmLnBhcmVudCA9IHA7XG4gICAgcmV0dXJuIHNlbGY7XG59XG5DbG9uZU1vZGVsLnByb3RvdHlwZSA9IE9iamVjdC5jcmVhdGUoSGVyb01vZGVsLnByb3RvdHlwZSk7XG5DbG9uZU1vZGVsLnByb3RvdHlwZS5jb25zdHJ1Y3RvciA9IENsb25lTW9kZWw7XG5cbm1vZHVsZS5leHBvcnRzID0gQ2xvbmVNb2RlbDsiLCJ2YXIgRGFtYWdlVHlwZUNvbG9yID0ge1xuICAgICdwaHlzaWNhbCc6ICcjOTc5YWEyJyxcbiAgICAncHVyZSc6ICdnb2xkZW5yb2QnLFxuICAgICdtYWdpYyc6ICcjNDI4YmNhJyxcbiAgICAnZGVmYXVsdCc6ICcjOTc5YWEyJ1xufVxuXG5tb2R1bGUuZXhwb3J0cyA9IERhbWFnZVR5cGVDb2xvcjsiLCIndXNlIHN0cmljdCc7XG52YXIga28gPSByZXF1aXJlKCcuLi9oZXJvY2FsY19rbm9ja291dCcpO1xuICAgIFxudmFyIERhbWFnZVR5cGVDb2xvciA9IHJlcXVpcmUoXCIuL0RhbWFnZVR5cGVDb2xvclwiKTtcbnZhciBleHRlbmQgPSByZXF1aXJlKFwiLi4vdXRpbC9leHRlbmRcIik7XG5cbnZhciBIZXJvRGFtYWdlTWl4aW4gPSBmdW5jdGlvbiAoc2VsZiwgaXRlbURhdGEpIHtcbiAgICBzZWxmLmNyaXRJbmZvID0ga28ucHVyZUNvbXB1dGVkKGZ1bmN0aW9uICgpIHtcbiAgICAgICAgdmFyIGNyaXRTb3VyY2VzID0gc2VsZi5pbnZlbnRvcnkuZ2V0Q3JpdFNvdXJjZSgpO1xuICAgICAgICBleHRlbmQoY3JpdFNvdXJjZXMsIHNlbGYuYWJpbGl0eSgpLmdldENyaXRTb3VyY2UoKSk7XG4gICAgICAgIGV4dGVuZChjcml0U291cmNlcywgc2VsZi5idWZmcy5nZXRDcml0U291cmNlKCkpO1xuICAgICAgICB2YXIgY3JpdFNvdXJjZXNBcnJheSA9IFtdO1xuICAgICAgICBmb3IgKHZhciBwcm9wIGluIGNyaXRTb3VyY2VzKSB7XG4gICAgICAgICAgICB2YXIgZWwgPSBjcml0U291cmNlc1twcm9wXTtcbiAgICAgICAgICAgIGVsLm5hbWUgPSBwcm9wXG4gICAgICAgICAgICBjcml0U291cmNlc0FycmF5LnB1c2goZWwpO1xuICAgICAgICB9XG4gICAgICAgIGZ1bmN0aW9uIGNvbXBhcmVCeU11bHRpcGxpZXIoYSxiKSB7XG4gICAgICAgICAgICBpZiAoYS5tdWx0aXBsaWVyIDwgYi5tdWx0aXBsaWVyKVxuICAgICAgICAgICAgICAgIHJldHVybiAxO1xuICAgICAgICAgICAgaWYgKGEubXVsdGlwbGllciA+IGIubXVsdGlwbGllcilcbiAgICAgICAgICAgICAgICByZXR1cm4gLTE7XG4gICAgICAgICAgICByZXR1cm4gMDtcbiAgICAgICAgfVxuXG4gICAgICAgIGNyaXRTb3VyY2VzQXJyYXkuc29ydChjb21wYXJlQnlNdWx0aXBsaWVyKTtcbiAgICAgICAgXG4gICAgICAgIHZhciByZXN1bHQgPSBbXTtcbiAgICAgICAgdmFyIGNyaXRUb3RhbCA9IDA7XG4gICAgICAgIGZvciAodmFyIGkgPSAwOyBpIDwgY3JpdFNvdXJjZXNBcnJheS5sZW5ndGg7IGkrKykge1xuICAgICAgICAgICAgdmFyIHRvdGFsID0gMTtcbiAgICAgICAgICAgIGZvciAodmFyIGogPSAwOyBqIDwgaTsgaisrKSB7XG4gICAgICAgICAgICAgICAgZm9yICh2YXIgayA9IDA7IGsgPGNyaXRTb3VyY2VzQXJyYXlbal0uY291bnQ7IGsrKykge1xuICAgICAgICAgICAgICAgICAgICB0b3RhbCAqPSAoMSAtIGNyaXRTb3VyY2VzQXJyYXlbal0uY2hhbmNlKTtcbiAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICB9XG4gICAgICAgICAgICB2YXIgdG90YWwyID0gMTtcbiAgICAgICAgICAgIGZvciAodmFyIGsgPSAwOyBrIDwgY3JpdFNvdXJjZXNBcnJheVtpXS5jb3VudDsgaysrKSB7XG4gICAgICAgICAgICAgICAgdG90YWwyICo9ICgxIC0gY3JpdFNvdXJjZXNBcnJheVtpXS5jaGFuY2UpO1xuICAgICAgICAgICAgfVxuICAgICAgICAgICAgdG90YWwgKj0gKDEgLSB0b3RhbDIpO1xuICAgICAgICAgICAgY3JpdFRvdGFsICs9IHRvdGFsO1xuICAgICAgICAgICAgaWYgKGNyaXRTb3VyY2VzQXJyYXlbaV0uY291bnQgPiAxKSB7XG4gICAgICAgICAgICAgICAgcmVzdWx0LnB1c2goe1xuICAgICAgICAgICAgICAgICAgICAnbmFtZSc6Y3JpdFNvdXJjZXNBcnJheVtpXS5kaXNwbGF5bmFtZSArICcgeCcgKyBjcml0U291cmNlc0FycmF5W2ldLmNvdW50LFxuICAgICAgICAgICAgICAgICAgICAnY2hhbmNlJzpjcml0U291cmNlc0FycmF5W2ldLmNoYW5jZSxcbiAgICAgICAgICAgICAgICAgICAgJ211bHRpcGxpZXInOmNyaXRTb3VyY2VzQXJyYXlbaV0ubXVsdGlwbGllcixcbiAgICAgICAgICAgICAgICAgICAgJ2NvdW50Jzpjcml0U291cmNlc0FycmF5W2ldLmNvdW50LFxuICAgICAgICAgICAgICAgICAgICAndG90YWxDaGFuY2UnOnRvdGFsXG4gICAgICAgICAgICAgICAgfSk7XG4gICAgICAgICAgICB9XG4gICAgICAgICAgICBlbHNlIHtcbiAgICAgICAgICAgICAgICByZXN1bHQucHVzaCh7XG4gICAgICAgICAgICAgICAgICAgICduYW1lJzpjcml0U291cmNlc0FycmF5W2ldLmRpc3BsYXluYW1lLFxuICAgICAgICAgICAgICAgICAgICAnY2hhbmNlJzpjcml0U291cmNlc0FycmF5W2ldLmNoYW5jZSxcbiAgICAgICAgICAgICAgICAgICAgJ211bHRpcGxpZXInOmNyaXRTb3VyY2VzQXJyYXlbaV0ubXVsdGlwbGllcixcbiAgICAgICAgICAgICAgICAgICAgJ2NvdW50Jzpjcml0U291cmNlc0FycmF5W2ldLmNvdW50LFxuICAgICAgICAgICAgICAgICAgICAndG90YWxDaGFuY2UnOnRvdGFsXG4gICAgICAgICAgICAgICAgfSk7XG4gICAgICAgICAgICB9XG4gICAgICAgIH1cbiAgICAgICAgcmV0dXJuIHsgc291cmNlczogcmVzdWx0LCB0b3RhbDogY3JpdFRvdGFsIH07XG4gICAgfSk7XG5cbiAgICBzZWxmLmNsZWF2ZUluZm8gPSBrby5wdXJlQ29tcHV0ZWQoZnVuY3Rpb24gKCkge1xuICAgICAgICB2YXIgY2xlYXZlU291cmNlcyA9IHNlbGYuaW52ZW50b3J5LmdldENsZWF2ZVNvdXJjZSgpO1xuICAgICAgICBleHRlbmQoY2xlYXZlU291cmNlcywgc2VsZi5hYmlsaXR5KCkuZ2V0Q2xlYXZlU291cmNlKCkpO1xuICAgICAgICBleHRlbmQoY2xlYXZlU291cmNlcywgc2VsZi5idWZmcy5nZXRDbGVhdmVTb3VyY2UoKSk7XG4gICAgICAgIHZhciBjbGVhdmVTb3VyY2VzQXJyYXkgPSBbXTtcbiAgICAgICAgZm9yICh2YXIgcHJvcCBpbiBjbGVhdmVTb3VyY2VzKSB7XG4gICAgICAgICAgICB2YXIgZWwgPSBjbGVhdmVTb3VyY2VzW3Byb3BdO1xuICAgICAgICAgICAgZWwubmFtZSA9IHByb3BcbiAgICAgICAgICAgIGNsZWF2ZVNvdXJjZXNBcnJheS5wdXNoKGVsKTtcbiAgICAgICAgfVxuICAgICAgICBmdW5jdGlvbiBjb21wYXJlQnlSYWRpdXMoYSxiKSB7XG4gICAgICAgICAgICBpZiAoYS5yYWRpdXMgPCBiLnJhZGl1cylcbiAgICAgICAgICAgICAgICByZXR1cm4gMTtcbiAgICAgICAgICAgIGlmIChhLnJhZGl1cyA+IGIucmFkaXVzKVxuICAgICAgICAgICAgICAgIHJldHVybiAtMTtcbiAgICAgICAgICAgIHJldHVybiAwO1xuICAgICAgICB9XG5cbiAgICAgICAgY2xlYXZlU291cmNlc0FycmF5LnNvcnQoY29tcGFyZUJ5UmFkaXVzKTtcbiAgICAgICAgdmFyIGNsZWF2ZVNvdXJjZXNCeVJhZGl1cyA9IHt9O1xuICAgICAgICBmb3IgKHZhciBpID0gMDsgaSA8IGNsZWF2ZVNvdXJjZXNBcnJheS5sZW5ndGg7IGkrKykge1xuICAgICAgICAgICAgdmFyIHRvdGFsID0gMDtcbiAgICAgICAgICAgIGZvciAodmFyIGogPSAwOyBqIDxjbGVhdmVTb3VyY2VzQXJyYXkubGVuZ3RoOyBqKyspIHtcbiAgICAgICAgICAgICAgICBpZiAoY2xlYXZlU291cmNlc0FycmF5W2pdLnJhZGl1cyA+PSBjbGVhdmVTb3VyY2VzQXJyYXlbaV0ucmFkaXVzKSB7XG4gICAgICAgICAgICAgICAgICAgIHRvdGFsICs9IGNsZWF2ZVNvdXJjZXNBcnJheVtqXS5tYWduaXR1ZGUgKiBjbGVhdmVTb3VyY2VzQXJyYXlbal0uY291bnQ7XG4gICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgfVxuICAgICAgICAgICAgY2xlYXZlU291cmNlc0J5UmFkaXVzW2NsZWF2ZVNvdXJjZXNBcnJheVtpXS5yYWRpdXNdID0gdG90YWw7XG4gICAgICAgIH1cbiAgICAgICAgdmFyIHJlc3VsdCA9IFtdO1xuICAgICAgICBmb3IgKHZhciBwcm9wIGluIGNsZWF2ZVNvdXJjZXNCeVJhZGl1cykge1xuICAgICAgICAgICAgcmVzdWx0LnB1c2goe1xuICAgICAgICAgICAgICAgICdyYWRpdXMnOnByb3AsXG4gICAgICAgICAgICAgICAgJ21hZ25pdHVkZSc6Y2xlYXZlU291cmNlc0J5UmFkaXVzW3Byb3BdXG4gICAgICAgICAgICB9KTtcbiAgICAgICAgfVxuICAgICAgICByZXR1cm4gcmVzdWx0O1xuICAgIH0pO1xuICAgIFxuICAgIHNlbGYuYmFzaEluZm8gPSBrby5wdXJlQ29tcHV0ZWQoZnVuY3Rpb24gKCkge1xuICAgICAgICB2YXIgYXR0YWNrdHlwZSA9IHNlbGYuaGVyb0RhdGEoKS5hdHRhY2t0eXBlO1xuICAgICAgICB2YXIgYmFzaFNvdXJjZXMgPSBzZWxmLmludmVudG9yeS5nZXRCYXNoU291cmNlKGF0dGFja3R5cGUpO1xuICAgICAgICBleHRlbmQoYmFzaFNvdXJjZXMsIHNlbGYuYWJpbGl0eSgpLmdldEJhc2hTb3VyY2UoKSk7XG4gICAgICAgIHZhciBiYXNoU291cmNlc0FycmF5ID0gW107XG4gICAgICAgIGZvciAodmFyIHByb3AgaW4gYmFzaFNvdXJjZXMpIHtcbiAgICAgICAgICAgIHZhciBlbCA9IGJhc2hTb3VyY2VzW3Byb3BdO1xuICAgICAgICAgICAgZWwubmFtZSA9IHByb3BcbiAgICAgICAgICAgIGJhc2hTb3VyY2VzQXJyYXkucHVzaChlbCk7XG4gICAgICAgIH1cbiAgICAgICAgZnVuY3Rpb24gY29tcGFyZUJ5RHVyYXRpb24oYSwgYikge1xuICAgICAgICAgICAgaWYgKGEuZHVyYXRpb24gPCBiLmR1cmF0aW9uKVxuICAgICAgICAgICAgICAgIHJldHVybiAxO1xuICAgICAgICAgICAgaWYgKGEuZHVyYXRpb24gPiBiLmR1cmF0aW9uKVxuICAgICAgICAgICAgICAgIHJldHVybiAtMTtcbiAgICAgICAgICAgIHJldHVybiAwO1xuICAgICAgICB9XG5cbiAgICAgICAgLy9iYXNoU291cmNlc0FycmF5LnNvcnQoY29tcGFyZUJ5RHVyYXRpb24pO1xuICAgICAgICBcbiAgICAgICAgdmFyIHJlc3VsdCA9IFtdO1xuICAgICAgICB2YXIgYmFzaFRvdGFsID0gMDtcbiAgICAgICAgZm9yICh2YXIgaSA9IDA7aSA8IGJhc2hTb3VyY2VzQXJyYXkubGVuZ3RoOyBpKyspIHtcbiAgICAgICAgICAgIHZhciB0b3RhbCA9IDE7XG4gICAgICAgICAgICBmb3IgKHZhciBqID0gMDsgaiA8IGk7IGorKykge1xuICAgICAgICAgICAgICAgIGZvciAodmFyIGsgPSAwOyBrIDwgYmFzaFNvdXJjZXNBcnJheVtqXS5jb3VudDsgaysrKSB7XG4gICAgICAgICAgICAgICAgICAgIHRvdGFsICo9ICgxIC0gYmFzaFNvdXJjZXNBcnJheVtqXS5jaGFuY2UpO1xuICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgIH1cbiAgICAgICAgICAgIHZhciB0b3RhbDIgPSAxO1xuICAgICAgICAgICAgZm9yICh2YXIgayA9IDA7IGsgPCBiYXNoU291cmNlc0FycmF5W2ldLmNvdW50OyBrKyspIHtcbiAgICAgICAgICAgICAgICB0b3RhbDIgKj0gKDEgLSBiYXNoU291cmNlc0FycmF5W2ldLmNoYW5jZSk7XG4gICAgICAgICAgICB9XG4gICAgICAgICAgICB0b3RhbCAqPSAoMSAtIHRvdGFsMik7XG4gICAgICAgICAgICBiYXNoVG90YWwgKz0gdG90YWw7XG4gICAgICAgICAgICBpZiAoYmFzaFNvdXJjZXNBcnJheVtpXS5uYW1lID09PSAnc3Bpcml0X2JyZWFrZXJfZ3JlYXRlcl9iYXNoJykge1xuICAgICAgICAgICAgICAgIHZhciBkID0gYmFzaFNvdXJjZXNBcnJheVtpXS5kYW1hZ2UgKiBzZWxmLnRvdGFsTW92ZW1lbnRTcGVlZCgpO1xuICAgICAgICAgICAgfVxuICAgICAgICAgICAgZWxzZSB7XG4gICAgICAgICAgICAgICAgdmFyIGQgPSBiYXNoU291cmNlc0FycmF5W2ldLmRhbWFnZTtcbiAgICAgICAgICAgIH1cbiAgICAgICAgICAgIGlmIChiYXNoU291cmNlc0FycmF5W2ldLmNvdW50ID4gMSkge1xuICAgICAgICAgICAgICAgIHJlc3VsdC5wdXNoKHtcbiAgICAgICAgICAgICAgICAgICAgJ25hbWUnOmJhc2hTb3VyY2VzQXJyYXlbaV0uZGlzcGxheW5hbWUsIC8vICsgJyB4JyArIGJhc2hTb3VyY2VzQXJyYXlbaV0uY291bnQsXG4gICAgICAgICAgICAgICAgICAgICdjaGFuY2UnOmJhc2hTb3VyY2VzQXJyYXlbaV0uY2hhbmNlLFxuICAgICAgICAgICAgICAgICAgICAnZGFtYWdlJzpkLFxuICAgICAgICAgICAgICAgICAgICAnY291bnQnOmJhc2hTb3VyY2VzQXJyYXlbaV0uY291bnQsXG4gICAgICAgICAgICAgICAgICAgICdkYW1hZ2VUeXBlJzpiYXNoU291cmNlc0FycmF5W2ldLmRhbWFnZVR5cGUsXG4gICAgICAgICAgICAgICAgICAgICd0b3RhbENoYW5jZSc6dG90YWxcbiAgICAgICAgICAgICAgICB9KTtcbiAgICAgICAgICAgIH1cbiAgICAgICAgICAgIGVsc2Uge1xuICAgICAgICAgICAgICAgIHJlc3VsdC5wdXNoKHtcbiAgICAgICAgICAgICAgICAgICAgJ25hbWUnOmJhc2hTb3VyY2VzQXJyYXlbaV0uZGlzcGxheW5hbWUsXG4gICAgICAgICAgICAgICAgICAgICdjaGFuY2UnOmJhc2hTb3VyY2VzQXJyYXlbaV0uY2hhbmNlLFxuICAgICAgICAgICAgICAgICAgICAnZGFtYWdlJzpkLFxuICAgICAgICAgICAgICAgICAgICAnY291bnQnOmJhc2hTb3VyY2VzQXJyYXlbaV0uY291bnQsXG4gICAgICAgICAgICAgICAgICAgICdkYW1hZ2VUeXBlJzpiYXNoU291cmNlc0FycmF5W2ldLmRhbWFnZVR5cGUsXG4gICAgICAgICAgICAgICAgICAgICd0b3RhbENoYW5jZSc6dG90YWxcbiAgICAgICAgICAgICAgICB9KTtcbiAgICAgICAgICAgIH1cblxuICAgICAgICB9XG4gICAgICAgIHJldHVybiB7IHNvdXJjZXM6IHJlc3VsdCwgdG90YWw6IGJhc2hUb3RhbCB9O1xuICAgIH0pO1xuICAgIFxuICAgIHNlbGYub3JiUHJvY0luZm8gPSBrby5wdXJlQ29tcHV0ZWQoZnVuY3Rpb24gKCkge1xuICAgICAgICB2YXIgYXR0YWNrdHlwZSA9IHNlbGYuaGVyb0RhdGEoKS5hdHRhY2t0eXBlO1xuICAgICAgICB2YXIgZGFtYWdlU291cmNlcyA9IHNlbGYuaW52ZW50b3J5LmdldE9yYlByb2NTb3VyY2UoKTtcbiAgICAgICAgdmFyIGRhbWFnZVNvdXJjZXNBcnJheSA9IFtdO1xuICAgICAgICBmb3IgKHZhciBwcm9wIGluIGRhbWFnZVNvdXJjZXMpIHtcbiAgICAgICAgICAgIHZhciBlbCA9IGRhbWFnZVNvdXJjZXNbcHJvcF07XG4gICAgICAgICAgICBlbC5uYW1lID0gcHJvcFxuICAgICAgICAgICAgZGFtYWdlU291cmNlc0FycmF5LnB1c2goZWwpO1xuICAgICAgICB9XG4gICAgICAgIGZ1bmN0aW9uIGNvbXBhcmVCeURhbWFnZShhLCBiKSB7XG4gICAgICAgICAgICBpZiAoYS5wcmlvcml0eSA+IGIucHJpb3JpdHkpIHtcbiAgICAgICAgICAgICAgICByZXR1cm4gMTtcbiAgICAgICAgICAgIH1cbiAgICAgICAgICAgIGlmIChhLnByaW9yaXR5IDwgYi5wcmlvcml0eSkge1xuICAgICAgICAgICAgICAgIHJldHVybiAtMTtcbiAgICAgICAgICAgIH1cbiAgICAgICAgICAgIGlmIChhLmRhbWFnZSA8IGIuZGFtYWdlKVxuICAgICAgICAgICAgICAgIHJldHVybiAxO1xuICAgICAgICAgICAgaWYgKGEuZGFtYWdlID4gYi5kYW1hZ2UpXG4gICAgICAgICAgICAgICAgcmV0dXJuIC0xO1xuICAgICAgICAgICAgcmV0dXJuIDA7XG4gICAgICAgIH1cblxuICAgICAgICBkYW1hZ2VTb3VyY2VzQXJyYXkuc29ydChjb21wYXJlQnlEYW1hZ2UpO1xuICAgICAgICBcbiAgICAgICAgdmFyIHJlc3VsdCA9IFtdO1xuICAgICAgICB2YXIgZGFtYWdlVG90YWwgPSAwO1xuICAgICAgICBmb3IgKHZhciBpPTAgOyBpIDwgZGFtYWdlU291cmNlc0FycmF5Lmxlbmd0aDsgaSsrKSB7XG4gICAgICAgICAgICB2YXIgdG90YWwgPSAxO1xuICAgICAgICAgICAgZm9yICh2YXIgaiA9IDA7IGogPCBpOyBqKyspIHtcbiAgICAgICAgICAgICAgICBmb3IgKHZhciBrID0gMDsgayA8IGRhbWFnZVNvdXJjZXNBcnJheVtqXS5jb3VudDsgaysrKSB7XG4gICAgICAgICAgICAgICAgICAgIHRvdGFsICo9ICgxIC0gZGFtYWdlU291cmNlc0FycmF5W2pdLmNoYW5jZSk7XG4gICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgfVxuICAgICAgICAgICAgdmFyIHRvdGFsMiA9IDE7XG4gICAgICAgICAgICBmb3IgKHZhciBrID0gMDsgayA8IGRhbWFnZVNvdXJjZXNBcnJheVtpXS5jb3VudDsgaysrKSB7XG4gICAgICAgICAgICAgICAgdG90YWwyICo9ICgxIC0gZGFtYWdlU291cmNlc0FycmF5W2ldLmNoYW5jZSk7XG4gICAgICAgICAgICB9XG4gICAgICAgICAgICB0b3RhbCAqPSAoMSAtIHRvdGFsMik7XG4gICAgICAgICAgICBkYW1hZ2VUb3RhbCArPSB0b3RhbDtcbiAgICAgICAgICAgIGlmIChkYW1hZ2VTb3VyY2VzQXJyYXlbaV0uY291bnQgPiAxKSB7XG4gICAgICAgICAgICAgICAgcmVzdWx0LnB1c2goe1xuICAgICAgICAgICAgICAgICAgICAnbmFtZSc6ZGFtYWdlU291cmNlc0FycmF5W2ldLmRpc3BsYXluYW1lICsgJyB4JyArIGRhbWFnZVNvdXJjZXNBcnJheVtpXS5jb3VudCxcbiAgICAgICAgICAgICAgICAgICAgJ2NoYW5jZSc6ZGFtYWdlU291cmNlc0FycmF5W2ldLmNoYW5jZSxcbiAgICAgICAgICAgICAgICAgICAgJ2RhbWFnZSc6ZGFtYWdlU291cmNlc0FycmF5W2ldLmRhbWFnZSxcbiAgICAgICAgICAgICAgICAgICAgJ2NvdW50JzpkYW1hZ2VTb3VyY2VzQXJyYXlbaV0uY291bnQsXG4gICAgICAgICAgICAgICAgICAgICdkYW1hZ2VUeXBlJzpkYW1hZ2VTb3VyY2VzQXJyYXlbaV0uZGFtYWdlVHlwZSxcbiAgICAgICAgICAgICAgICAgICAgJ3RvdGFsQ2hhbmNlJzp0b3RhbFxuICAgICAgICAgICAgICAgIH0pO1xuICAgICAgICAgICAgfVxuICAgICAgICAgICAgZWxzZSB7XG4gICAgICAgICAgICAgICAgcmVzdWx0LnB1c2goe1xuICAgICAgICAgICAgICAgICAgICAnbmFtZSc6ZGFtYWdlU291cmNlc0FycmF5W2ldLmRpc3BsYXluYW1lLFxuICAgICAgICAgICAgICAgICAgICAnY2hhbmNlJzpkYW1hZ2VTb3VyY2VzQXJyYXlbaV0uY2hhbmNlLFxuICAgICAgICAgICAgICAgICAgICAnZGFtYWdlJzpkYW1hZ2VTb3VyY2VzQXJyYXlbaV0uZGFtYWdlLFxuICAgICAgICAgICAgICAgICAgICAnY291bnQnOmRhbWFnZVNvdXJjZXNBcnJheVtpXS5jb3VudCxcbiAgICAgICAgICAgICAgICAgICAgJ2RhbWFnZVR5cGUnOmRhbWFnZVNvdXJjZXNBcnJheVtpXS5kYW1hZ2VUeXBlLFxuICAgICAgICAgICAgICAgICAgICAndG90YWxDaGFuY2UnOnRvdGFsXG4gICAgICAgICAgICAgICAgfSk7XG4gICAgICAgICAgICB9XG4gICAgICAgIH1cbiAgICAgICAgcmV0dXJuIHsgc291cmNlczogcmVzdWx0LCB0b3RhbDogZGFtYWdlVG90YWwgfTtcbiAgICB9KTtcbiAgICBcbiAgICBzZWxmLmdldFJlZHVjZWREYW1hZ2UgPSBmdW5jdGlvbiAodmFsdWUsIHR5cGUpIHtcbiAgICAgICAgdmFyIHJlc3VsdCA9IHZhbHVlO1xuICAgICAgICBzd2l0Y2ggKHR5cGUpIHtcbiAgICAgICAgICAgIGNhc2UgJ3BoeXNpY2FsJzpcbiAgICAgICAgICAgICAgICByZXN1bHQgPSB2YWx1ZSAqICgxIC0gKDAuMDYgKiBzZWxmLmVuZW15KCkudG90YWxBcm1vclBoeXNpY2FsKCkpIC8gKDEgKyAwLjA2ICogTWF0aC5hYnMoc2VsZi5lbmVteSgpLnRvdGFsQXJtb3JQaHlzaWNhbCgpKSkpO1xuICAgICAgICAgICAgYnJlYWs7XG4gICAgICAgICAgICBjYXNlICdtYWdpYyc6XG4gICAgICAgICAgICAgICAgcmVzdWx0ID0gdmFsdWUgKiAoMSAtIHNlbGYuZW5lbXkoKS50b3RhbE1hZ2ljUmVzaXN0YW5jZSgpIC8gMTAwKTtcbiAgICAgICAgICAgIGJyZWFrO1xuICAgICAgICAgICAgY2FzZSAncHVyZSc6XG4gICAgICAgICAgICAgICAgcmVzdWx0ID0gdmFsdWU7XG4gICAgICAgICAgICBicmVhaztcbiAgICAgICAgICAgIGNhc2UgJ2NvbXBvc2l0ZSc6XG4gICAgICAgICAgICAgICAgcmVzdWx0ID0gdmFsdWUgKiAoMSAtICgwLjA2ICogc2VsZi5lbmVteSgpLnRvdGFsQXJtb3JQaHlzaWNhbCgpKSAvICgxICsgMC4wNiAqIE1hdGguYWJzKHNlbGYuZW5lbXkoKS50b3RhbEFybW9yUGh5c2ljYWwoKSkpKTtcbiAgICAgICAgICAgICAgICByZXN1bHQgKj0gKDEgLSBzZWxmLmVuZW15KCkudG90YWxNYWdpY1Jlc2lzdGFuY2UoKSAvIDEwMCk7XG4gICAgICAgICAgICBicmVhaztcbiAgICAgICAgfVxuICAgICAgICByZXN1bHQgKj0gc2VsZi5hYmlsaXR5KCkuZ2V0RGFtYWdlQW1wbGlmaWNhdGlvbigpICogc2VsZi5kZWJ1ZmZzLmdldERhbWFnZUFtcGxpZmljYXRpb24oKTtcbiAgICAgICAgcmVzdWx0ICo9IHNlbGYuZW5lbXkoKS5hYmlsaXR5KCkuZ2V0RGFtYWdlUmVkdWN0aW9uKCkgKiBzZWxmLmVuZW15KCkuYnVmZnMuZ2V0RGFtYWdlUmVkdWN0aW9uKCk7XG4gICAgICAgIHJldHVybiByZXN1bHQ7XG4gICAgfVxuICAgIFxuICAgIHNlbGYuZGFtYWdlVG90YWxJbmZvID0ga28ucHVyZUNvbXB1dGVkKGZ1bmN0aW9uICgpIHtcbiAgICAgICAgdmFyIGJvbnVzRGFtYWdlQXJyYXkgPSBbXG4gICAgICAgICAgICBzZWxmLmFiaWxpdHkoKS5nZXRCb251c0RhbWFnZSgpLnNvdXJjZXMsXG4gICAgICAgICAgICBzZWxmLmJ1ZmZzLmdldEJvbnVzRGFtYWdlKCkuc291cmNlc1xuICAgICAgICBdLFxuICAgICAgICBib251c0RhbWFnZVBjdEFycmF5ID0gW1xuICAgICAgICAgICAgc2VsZi5hYmlsaXR5KCkuZ2V0Qm9udXNEYW1hZ2VQZXJjZW50KCkuc291cmNlcyxcbiAgICAgICAgICAgIHNlbGYuYnVmZnMuZ2V0Qm9udXNEYW1hZ2VQZXJjZW50KCkuc291cmNlc1xuICAgICAgICBdLFxuICAgICAgICBpdGVtQm9udXNEYW1hZ2UgPSBzZWxmLmludmVudG9yeS5nZXRCb251c0RhbWFnZSgpLnNvdXJjZXMsXG4gICAgICAgIGl0ZW1Cb251c0RhbWFnZVBjdCA9IHNlbGYuYnVmZnMuaXRlbUJ1ZmZzLmdldEJvbnVzRGFtYWdlUGVyY2VudChzZWxmLmludmVudG9yeS5nZXRCb251c0RhbWFnZVBlcmNlbnQoKSkuc291cmNlcyxcbiAgICAgICAgY3JpdFNvdXJjZXMgPSBzZWxmLmNyaXRJbmZvKCksXG4gICAgICAgIGFiaWxpdHlPcmJTb3VyY2VzID0gc2VsZi5hYmlsaXR5KCkuZ2V0T3JiU291cmNlKCksXG4gICAgICAgIGl0ZW1PcmJTb3VyY2VzID0gc2VsZi5pbnZlbnRvcnkuZ2V0T3JiU291cmNlKCksXG4gICAgICAgIGl0ZW1Qcm9jT3JiU291cmNlcyA9IHNlbGYub3JiUHJvY0luZm8oKSxcbiAgICAgICAgYmFzaFNvdXJjZXMgPSBzZWxmLmJhc2hJbmZvKCksXG4gICAgICAgIFxuICAgICAgICBhdHRhY2tTb3VyY2VzID0gW107XG4gICAgICAgIFxuICAgICAgICBhdHRhY2tTb3VyY2VzLnB1c2goe1xuICAgICAgICAgICAgbmFtZTogJ0Jhc2UgQXR0YWNrJyxcbiAgICAgICAgICAgIGNvb2xkb3duOiAxXG4gICAgICAgIH0pO1xuICAgICAgICBcbiAgICAgICAgLy8gd2VhdmVyX2dlbWluYXRlX2F0dGFja1xuICAgICAgICBpZiAoc2VsZi5oZXJvSWQoKSA9PT0gJ3dlYXZlcicpIHtcbiAgICAgICAgICAgIHZhciBhID0gc2VsZi5hYmlsaXR5KCkuYWJpbGl0aWVzKCkuZmluZChmdW5jdGlvbiAoYWJpbGl0eSkge1xuICAgICAgICAgICAgICAgIHJldHVybiBhYmlsaXR5Lm5hbWUgPT09ICd3ZWF2ZXJfZ2VtaW5hdGVfYXR0YWNrJztcbiAgICAgICAgICAgIH0pO1xuICAgICAgICAgICAgaWYgKGEpIHtcbiAgICAgICAgICAgICAgICBpZiAoYS5sZXZlbCgpID4gMCkge1xuICAgICAgICAgICAgICAgICAgICB2YXIgY2QgPSBhLmNvb2xkb3duW2EubGV2ZWwoKSAtIDFdO1xuICAgICAgICAgICAgICAgICAgICBhdHRhY2tTb3VyY2VzLnB1c2goe1xuICAgICAgICAgICAgICAgICAgICAgICAgbmFtZTogYS5kaXNwbGF5bmFtZSxcbiAgICAgICAgICAgICAgICAgICAgICAgIGNvb2xkb3duOiAoMS9jZClcbiAgICAgICAgICAgICAgICAgICAgfSk7XG4gICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgfVxuICAgICAgICB9XG4gICAgICAgIFxuICAgICAgICAvLyBlY2hvX3NhYnJlXG4gICAgICAgIHZhciBpdGVtID0gc2VsZi5pbnZlbnRvcnkuaXRlbXMoKS5maW5kKGZ1bmN0aW9uIChvKSB7IHJldHVybiBvLml0ZW0gPT09IFwiZWNob19zYWJyZVwiICYmIG8uZW5hYmxlZCgpOyB9KTtcbiAgICAgICAgaWYgKGl0ZW0gJiYgc2VsZi5oZXJvRGF0YSgpLmF0dGFja3R5cGUgPT09ICdET1RBX1VOSVRfQ0FQX01FTEVFX0FUVEFDSycpIHtcbiAgICAgICAgICAgIHZhciBpdGVtX2VjaG9fc2FicmUgPSBpdGVtRGF0YVsnaXRlbV9lY2hvX3NhYnJlJ107XG4gICAgICAgICAgICBhdHRhY2tTb3VyY2VzLnB1c2goe1xuICAgICAgICAgICAgICAgIG5hbWU6IGl0ZW1fZWNob19zYWJyZS5kaXNwbGF5bmFtZSxcbiAgICAgICAgICAgICAgICBjb29sZG93bjogKDEvaXRlbV9lY2hvX3NhYnJlLmNvb2xkb3duKVxuICAgICAgICAgICAgfSk7XG4gICAgICAgIH1cblxuICAgICAgICB2YXIgYXR0YWNrcyA9IGF0dGFja1NvdXJjZXMubWFwKGZ1bmN0aW9uIChhKSB7XG4gICAgICAgICAgICB2YXIgYmFzZURhbWFnZSA9IChzZWxmLmJhc2VEYW1hZ2UoKVswXSArIHNlbGYuYmFzZURhbWFnZSgpWzFdKSAvIDIsXG4gICAgICAgICAgICB0b3RhbERhbWFnZSA9IDAsXG4gICAgICAgICAgICB0b3RhbENyaXRhYmxlRGFtYWdlID0gMCxcbiAgICAgICAgICAgIHRvdGFsQ3JpdCA9IDAsXG4gICAgICAgICAgICBnZW1pbmF0ZUF0dGFjayA9IHsgZGFtYWdlOiAwLCBkYW1hZ2VSZWR1Y2VkOiAwLCBjb29sZG93bjogNiwgYWN0aXZlOiBmYWxzZSB9LFxuICAgICAgICAgICAgZWNob1NhYnJlQXR0YWNrID0geyBkYW1hZ2U6IDAsIGRhbWFnZVJlZHVjZWQ6IDAsIGNvb2xkb3duOiBpdGVtRGF0YVsnaXRlbV9lY2hvX3NhYnJlJ10uY29vbGRvd25bMF0sIGFjdGl2ZTogZmFsc2UgfSxcbiAgICAgICAgICAgIGRhbWFnZSA9IHtcbiAgICAgICAgICAgICAgICBwdXJlOiAwLFxuICAgICAgICAgICAgICAgIHBoeXNpY2FsOiAwLFxuICAgICAgICAgICAgICAgIG1hZ2ljOiAwXG4gICAgICAgICAgICB9LFxuICAgICAgICAgICAgcmVzdWx0ID0gW10sXG4gICAgICAgICAgICBjcml0cyA9IFtdO1xuICAgICAgICAgICAgXG4gICAgICAgICAgICAvLyBiYXNlIGRhbWFnZVxuICAgICAgICAgICAgcmVzdWx0LnB1c2goe1xuICAgICAgICAgICAgICAgIG5hbWU6ICdCYXNlIERhbWFnZScsXG4gICAgICAgICAgICAgICAgZGFtYWdlOiBiYXNlRGFtYWdlLFxuICAgICAgICAgICAgICAgIGRhbWFnZVR5cGU6ICdwaHlzaWNhbCcsXG4gICAgICAgICAgICAgICAgZGFtYWdlUmVkdWNlZDogc2VsZi5nZXRSZWR1Y2VkRGFtYWdlKGJhc2VEYW1hZ2UsICdwaHlzaWNhbCcpLFxuICAgICAgICAgICAgICAgIGVuYWJsZWQ6IGtvLm9ic2VydmFibGUodHJ1ZSlcbiAgICAgICAgICAgIH0pO1xuICAgICAgICAgICAgdG90YWxEYW1hZ2UgKz0gYmFzZURhbWFnZTtcbiAgICAgICAgICAgIHRvdGFsQ3JpdGFibGVEYW1hZ2UgKz0gYmFzZURhbWFnZTtcbiAgICAgICAgICAgIGRhbWFnZS5waHlzaWNhbCArPSBiYXNlRGFtYWdlO1xuICAgICAgICAgICAgXG4gICAgICAgICAgICAvLyBib251cyBkYW1hZ2UgZnJvbSBpdGVtc1xuICAgICAgICAgICAgZm9yIChpIGluIGl0ZW1Cb251c0RhbWFnZSkge1xuICAgICAgICAgICAgICAgIHZhciBkID0gaXRlbUJvbnVzRGFtYWdlW2ldLmRhbWFnZSppdGVtQm9udXNEYW1hZ2VbaV0uY291bnQgKiBzZWxmLmFiaWxpdHkoKS5nZXRTZWxmQmFzZURhbWFnZVJlZHVjdGlvblBjdCgpICogc2VsZi5lbmVteSgpLmFiaWxpdHkoKS5nZXRCYXNlRGFtYWdlUmVkdWN0aW9uUGN0KCkgKiBzZWxmLmRlYnVmZnMuaXRlbUJ1ZmZzLmdldEJhc2VEYW1hZ2VSZWR1Y3Rpb25QY3QoKTtcbiAgICAgICAgICAgICAgICByZXN1bHQucHVzaCh7XG4gICAgICAgICAgICAgICAgICAgIG5hbWU6IGl0ZW1Cb251c0RhbWFnZVtpXS5kaXNwbGF5bmFtZSArIChpdGVtQm9udXNEYW1hZ2VbaV0uY291bnQgPiAxID8gJyB4JyArIGl0ZW1Cb251c0RhbWFnZVtpXS5jb3VudCA6ICcnKSxcbiAgICAgICAgICAgICAgICAgICAgZGFtYWdlOiBkLFxuICAgICAgICAgICAgICAgICAgICBkYW1hZ2VUeXBlOiBpdGVtQm9udXNEYW1hZ2VbaV0uZGFtYWdlVHlwZSxcbiAgICAgICAgICAgICAgICAgICAgZGFtYWdlUmVkdWNlZDogc2VsZi5nZXRSZWR1Y2VkRGFtYWdlKGQsIGl0ZW1Cb251c0RhbWFnZVtpXS5kYW1hZ2VUeXBlKSxcbiAgICAgICAgICAgICAgICAgICAgZW5hYmxlZDoga28ub2JzZXJ2YWJsZSh0cnVlKVxuICAgICAgICAgICAgICAgIH0pO1xuICAgICAgICAgICAgICAgIHRvdGFsRGFtYWdlICs9IGQ7XG4gICAgICAgICAgICAgICAgdG90YWxDcml0YWJsZURhbWFnZSArPSBkO1xuICAgICAgICAgICAgICAgIGRhbWFnZVtpdGVtQm9udXNEYW1hZ2VbaV0uZGFtYWdlVHlwZV0gKz0gZDtcbiAgICAgICAgICAgIH1cblxuICAgICAgICAgICAgLy8gYm9udXMgZGFtYWdlIHBlcmNlbnQgZnJvbSBpdGVtc1xuICAgICAgICAgICAgZm9yIChpIGluIGl0ZW1Cb251c0RhbWFnZVBjdCkge1xuICAgICAgICAgICAgICAgIHZhciBkID0gYmFzZURhbWFnZSAqIGl0ZW1Cb251c0RhbWFnZVBjdFtpXS5kYW1hZ2U7XG4gICAgICAgICAgICAgICAgcmVzdWx0LnB1c2goe1xuICAgICAgICAgICAgICAgICAgICBuYW1lOiBpdGVtQm9udXNEYW1hZ2VQY3RbaV0uZGlzcGxheW5hbWUsXG4gICAgICAgICAgICAgICAgICAgIGRhbWFnZTogZCxcbiAgICAgICAgICAgICAgICAgICAgZGFtYWdlVHlwZTogaXRlbUJvbnVzRGFtYWdlUGN0W2ldLmRhbWFnZVR5cGUsXG4gICAgICAgICAgICAgICAgICAgIGRhbWFnZVJlZHVjZWQ6IHNlbGYuZ2V0UmVkdWNlZERhbWFnZShkLCBpdGVtQm9udXNEYW1hZ2VQY3RbaV0uZGFtYWdlVHlwZSksXG4gICAgICAgICAgICAgICAgICAgIGVuYWJsZWQ6IGtvLm9ic2VydmFibGUodHJ1ZSlcbiAgICAgICAgICAgICAgICB9KTtcbiAgICAgICAgICAgICAgICB0b3RhbERhbWFnZSArPSBkO1xuICAgICAgICAgICAgICAgIHRvdGFsQ3JpdGFibGVEYW1hZ2UgKz0gZDtcbiAgICAgICAgICAgICAgICBkYW1hZ2VbaXRlbUJvbnVzRGFtYWdlUGN0W2ldLmRhbWFnZVR5cGVdICs9IGQ7XG4gICAgICAgICAgICB9XG4gICAgICAgICAgICBcbiAgICAgICAgICAgIC8vIGJvbnVzIGRhbWFnZSBmcm9tIGFiaWxpdGllcyBhbmQgYnVmZnNcbiAgICAgICAgICAgIGZvciAodmFyIGkgPSAwOyBpIDwgYm9udXNEYW1hZ2VBcnJheS5sZW5ndGg7IGkrKykge1xuICAgICAgICAgICAgICAgIGZvciAoaiBpbiBib251c0RhbWFnZUFycmF5W2ldKSB7XG4gICAgICAgICAgICAgICAgICAgIHZhciBkID0gYm9udXNEYW1hZ2VBcnJheVtpXVtqXS5kYW1hZ2U7XG4gICAgICAgICAgICAgICAgICAgIHJlc3VsdC5wdXNoKHtcbiAgICAgICAgICAgICAgICAgICAgICAgIG5hbWU6IGJvbnVzRGFtYWdlQXJyYXlbaV1bal0uZGlzcGxheW5hbWUsXG4gICAgICAgICAgICAgICAgICAgICAgICBkYW1hZ2U6IGQsXG4gICAgICAgICAgICAgICAgICAgICAgICBkYW1hZ2VUeXBlOiBib251c0RhbWFnZUFycmF5W2ldW2pdLmRhbWFnZVR5cGUsXG4gICAgICAgICAgICAgICAgICAgICAgICBkYW1hZ2VSZWR1Y2VkOiBzZWxmLmdldFJlZHVjZWREYW1hZ2UoZCwgYm9udXNEYW1hZ2VBcnJheVtpXVtqXS5kYW1hZ2VUeXBlKSxcbiAgICAgICAgICAgICAgICAgICAgICAgIGVuYWJsZWQ6IGtvLm9ic2VydmFibGUodHJ1ZSlcbiAgICAgICAgICAgICAgICAgICAgfSk7XG4gICAgICAgICAgICAgICAgICAgIHRvdGFsRGFtYWdlICs9IGQ7XG4gICAgICAgICAgICAgICAgICAgIHRvdGFsQ3JpdGFibGVEYW1hZ2UgKz0gZDtcbiAgICAgICAgICAgICAgICAgICAgZGFtYWdlW2JvbnVzRGFtYWdlQXJyYXlbaV1bal0uZGFtYWdlVHlwZV0gKz0gZDtcbiAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICB9XG4gICAgICAgICAgICBcbiAgICAgICAgICAgIC8vIGJvbnVzIGRhbWFnZSBwZXJjZW50IGZyb20gYWJpbGl0aWVzIGFuZCBidWZmc1xuICAgICAgICAgICAgZm9yICh2YXIgaSA9IDA7IGkgPCBib251c0RhbWFnZVBjdEFycmF5Lmxlbmd0aDsgaSsrKSB7XG4gICAgICAgICAgICAgICAgZm9yIChqIGluIGJvbnVzRGFtYWdlUGN0QXJyYXlbaV0pIHtcbiAgICAgICAgICAgICAgICAgICAgdmFyIGQgPSBiYXNlRGFtYWdlICogYm9udXNEYW1hZ2VQY3RBcnJheVtpXVtqXS5kYW1hZ2U7XG4gICAgICAgICAgICAgICAgICAgIHJlc3VsdC5wdXNoKHtcbiAgICAgICAgICAgICAgICAgICAgICAgIG5hbWU6IGJvbnVzRGFtYWdlUGN0QXJyYXlbaV1bal0uZGlzcGxheW5hbWUsXG4gICAgICAgICAgICAgICAgICAgICAgICBkYW1hZ2U6IGQsXG4gICAgICAgICAgICAgICAgICAgICAgICBkYW1hZ2VUeXBlOiBib251c0RhbWFnZVBjdEFycmF5W2ldW2pdLmRhbWFnZVR5cGUsXG4gICAgICAgICAgICAgICAgICAgICAgICBkYW1hZ2VSZWR1Y2VkOiBzZWxmLmdldFJlZHVjZWREYW1hZ2UoZCwgYm9udXNEYW1hZ2VQY3RBcnJheVtpXVtqXS5kYW1hZ2VUeXBlKSxcbiAgICAgICAgICAgICAgICAgICAgICAgIGVuYWJsZWQ6IGtvLm9ic2VydmFibGUodHJ1ZSlcbiAgICAgICAgICAgICAgICAgICAgfSk7XG4gICAgICAgICAgICAgICAgICAgIHRvdGFsRGFtYWdlICs9IGQ7XG4gICAgICAgICAgICAgICAgICAgIHRvdGFsQ3JpdGFibGVEYW1hZ2UgKz0gZDtcbiAgICAgICAgICAgICAgICAgICAgZGFtYWdlW2JvbnVzRGFtYWdlUGN0QXJyYXlbaV1bal0uZGFtYWdlVHlwZV0gKz0gZDtcbiAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICB9XG4gICAgICAgICAgICAvLyBkcm93X3Jhbmdlcl90cnVlc2hvdFxuICAgICAgICAgICAgaWYgKHNlbGYuaGVyb0RhdGEoKS5hdHRhY2t0eXBlID09PSAnRE9UQV9VTklUX0NBUF9SQU5HRURfQVRUQUNLJykge1xuICAgICAgICAgICAgICAgIGlmIChzZWxmLmhlcm9JZCgpID09PSAnZHJvd19yYW5nZXInKSB7XG4gICAgICAgICAgICAgICAgICAgIHZhciBzID0gc2VsZi5hYmlsaXR5KCkuZ2V0Qm9udXNEYW1hZ2VQcmVjaXNpb25BdXJhKCkuc291cmNlcztcbiAgICAgICAgICAgICAgICAgICAgdmFyIGluZGV4ID0gMDtcbiAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgICAgZWxzZSB7XG4gICAgICAgICAgICAgICAgICAgIHZhciBzID0gc2VsZi5idWZmcy5nZXRCb251c0RhbWFnZVByZWNpc2lvbkF1cmEoKS5zb3VyY2VzO1xuICAgICAgICAgICAgICAgICAgICB2YXIgaW5kZXggPSAxO1xuICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgICBpZiAoc1tpbmRleF0gIT0gdW5kZWZpbmVkKSB7XG4gICAgICAgICAgICAgICAgICAgIGlmIChzZWxmLmhlcm9JZCgpID09PSAnZHJvd19yYW5nZXInKSB7XG4gICAgICAgICAgICAgICAgICAgICAgICB2YXIgZCA9IHNbaW5kZXhdLmRhbWFnZSAqIHNlbGYudG90YWxBZ2koKTtcbiAgICAgICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICAgICAgICBlbHNlIHtcbiAgICAgICAgICAgICAgICAgICAgICAgIHZhciBkID0gc1tpbmRleF0uZGFtYWdlO1xuICAgICAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgICAgICAgIHJlc3VsdC5wdXNoKHtcbiAgICAgICAgICAgICAgICAgICAgICAgIG5hbWU6IHNbaW5kZXhdLmRpc3BsYXluYW1lLFxuICAgICAgICAgICAgICAgICAgICAgICAgZGFtYWdlOiBkLFxuICAgICAgICAgICAgICAgICAgICAgICAgZGFtYWdlVHlwZTogJ3BoeXNpY2FsJyxcbiAgICAgICAgICAgICAgICAgICAgICAgIGRhbWFnZVJlZHVjZWQ6IHNlbGYuZ2V0UmVkdWNlZERhbWFnZShkLCAncGh5c2ljYWwnKSxcbiAgICAgICAgICAgICAgICAgICAgICAgIGVuYWJsZWQ6IGtvLm9ic2VydmFibGUodHJ1ZSlcbiAgICAgICAgICAgICAgICAgICAgfSk7XG4gICAgICAgICAgICAgICAgICAgIHRvdGFsRGFtYWdlICs9IGQ7XG4gICAgICAgICAgICAgICAgICAgIHRvdGFsQ3JpdGFibGVEYW1hZ2UgKz0gZDtcbiAgICAgICAgICAgICAgICAgICAgZGFtYWdlLnBoeXNpY2FsICs9IGQ7ICAgICAgICAgICAgICAgICAgICBcbiAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICB9XG4gICAgICAgICAgICBcbiAgICAgICAgICAgIC8vIHJpa2lfYmFja3N0YWJcbiAgICAgICAgICAgIGlmIChzZWxmLmhlcm9JZCgpID09PSAncmlraScpIHtcbiAgICAgICAgICAgICAgICB2YXIgcyA9IHNlbGYuYWJpbGl0eSgpLmdldEJvbnVzRGFtYWdlQmFja3N0YWIoKS5zb3VyY2VzO1xuICAgICAgICAgICAgICAgIHZhciBpbmRleCA9IDA7XG4gICAgICAgICAgICB9XG4gICAgICAgICAgICBlbHNlIHtcbiAgICAgICAgICAgICAgICB2YXIgcyA9IHNlbGYuYnVmZnMuZ2V0Qm9udXNEYW1hZ2VCYWNrc3RhYigpLnNvdXJjZXM7XG4gICAgICAgICAgICAgICAgdmFyIGluZGV4ID0gMTtcbiAgICAgICAgICAgIH1cbiAgICAgICAgICAgIGlmIChzW2luZGV4XSAhPSB1bmRlZmluZWQpIHtcbiAgICAgICAgICAgICAgICBpZiAoc2VsZi5oZXJvSWQoKSA9PT0gJ3Jpa2knKSB7XG4gICAgICAgICAgICAgICAgICAgIHZhciBkID0gc1tpbmRleF0uZGFtYWdlICogc2VsZi50b3RhbEFnaSgpO1xuICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgICBlbHNlIHtcbiAgICAgICAgICAgICAgICAgICAgdmFyIGQgPSBzW2luZGV4XS5kYW1hZ2U7XG4gICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICAgIHJlc3VsdC5wdXNoKHtcbiAgICAgICAgICAgICAgICAgICAgbmFtZTogc1tpbmRleF0uZGlzcGxheW5hbWUsXG4gICAgICAgICAgICAgICAgICAgIGRhbWFnZTogZCxcbiAgICAgICAgICAgICAgICAgICAgZGFtYWdlVHlwZTogJ3BoeXNpY2FsJyxcbiAgICAgICAgICAgICAgICAgICAgZGFtYWdlUmVkdWNlZDogc2VsZi5nZXRSZWR1Y2VkRGFtYWdlKGQsICdwaHlzaWNhbCcpLFxuICAgICAgICAgICAgICAgICAgICBlbmFibGVkOiBrby5vYnNlcnZhYmxlKHRydWUpXG4gICAgICAgICAgICAgICAgfSk7XG4gICAgICAgICAgICAgICAgdG90YWxEYW1hZ2UgKz0gZDtcbiAgICAgICAgICAgICAgICAvL3RvdGFsQ3JpdGFibGVEYW1hZ2UgKz0gZDtcbiAgICAgICAgICAgICAgICBkYW1hZ2UucGh5c2ljYWwgKz0gZDsgICAgICAgICAgICAgICAgICAgIFxuICAgICAgICAgICAgfVxuXG4gICAgICAgICAgICAvLyBiYXNoIGRhbWFnZVxuICAgICAgICAgICAgZm9yICh2YXIgaSA9IDA7IGkgPCBiYXNoU291cmNlcy5zb3VyY2VzLmxlbmd0aDsgaSsrKSB7XG4gICAgICAgICAgICAgICAgdmFyIG8gPSBiYXNoU291cmNlcy5zb3VyY2VzW2ldO1xuICAgICAgICAgICAgICAgIHZhciBkID0gYmFzaFNvdXJjZXMuc291cmNlc1tpXS5kYW1hZ2U7XG4gICAgICAgICAgICAgICAgdmFyIGNkID0gc2VsZi5hdHRhY2tzUGVyU2Vjb25kKCk7XG4gICAgICAgICAgICAgICAgaWYgKG8uY29vbGRvd24pIHtcbiAgICAgICAgICAgICAgICAgICAgY2QgPSBNYXRoLm1heCgxL28uY29vbGRvd24sIGNkKTtcbiAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgICAgZm9yICh2YXIgaiA9IDA7IGogPCBiYXNoU291cmNlcy5zb3VyY2VzW2ldLmNvdW50OyBqKyspIHtcbiAgICAgICAgICAgICAgICAgICAgcmVzdWx0LnB1c2goe1xuICAgICAgICAgICAgICAgICAgICAgICAgbmFtZTogYmFzaFNvdXJjZXMuc291cmNlc1tpXS5uYW1lLFxuICAgICAgICAgICAgICAgICAgICAgICAgZGFtYWdlOiBkLFxuICAgICAgICAgICAgICAgICAgICAgICAgZGFtYWdlVHlwZTogYmFzaFNvdXJjZXMuc291cmNlc1tpXS5kYW1hZ2VUeXBlLFxuICAgICAgICAgICAgICAgICAgICAgICAgZGFtYWdlUmVkdWNlZDogc2VsZi5nZXRSZWR1Y2VkRGFtYWdlKGQsIGJhc2hTb3VyY2VzLnNvdXJjZXNbaV0uZGFtYWdlVHlwZSksXG4gICAgICAgICAgICAgICAgICAgICAgICBkcHM6IGQgKiBjZCAqIGJhc2hTb3VyY2VzLnNvdXJjZXNbaV0uY2hhbmNlLFxuICAgICAgICAgICAgICAgICAgICAgICAgZHBzUmVkdWNlZDogc2VsZi5nZXRSZWR1Y2VkRGFtYWdlKGQsIGJhc2hTb3VyY2VzLnNvdXJjZXNbaV0uZGFtYWdlVHlwZSkgKiBjZCAqIGJhc2hTb3VyY2VzLnNvdXJjZXNbaV0uY2hhbmNlLFxuICAgICAgICAgICAgICAgICAgICAgICAgZW5hYmxlZDoga28ub2JzZXJ2YWJsZSh0cnVlKVxuICAgICAgICAgICAgICAgICAgICB9KTtcbiAgICAgICAgICAgICAgICAgICAgdG90YWxEYW1hZ2UgKz0gZDtcbiAgICAgICAgICAgICAgICAgICAgZGFtYWdlW2Jhc2hTb3VyY2VzLnNvdXJjZXNbaV0uZGFtYWdlVHlwZV0gKz0gZDtcbiAgICAgICAgICAgICAgICB9XG5cbiAgICAgICAgICAgIH1cbiAgICAgICAgICAgIFxuICAgICAgICAgICAgLy8gJS1iYXNlZCBvcmJzXG4gICAgICAgICAgICBmb3IgKHZhciBpID0gMDsgaSA8IGl0ZW1Qcm9jT3JiU291cmNlcy5zb3VyY2VzLmxlbmd0aDsgaSsrKSB7XG4gICAgICAgICAgICAgICAgdmFyIGQgPSBpdGVtUHJvY09yYlNvdXJjZXMuc291cmNlc1tpXS5kYW1hZ2UgKiAoMSAtIE1hdGgucG93KDEgLSBpdGVtUHJvY09yYlNvdXJjZXMuc291cmNlc1tpXS5jaGFuY2UsIGl0ZW1Qcm9jT3JiU291cmNlcy5zb3VyY2VzW2ldLmNvdW50KSk7XG4gICAgICAgICAgICAgICAgcmVzdWx0LnB1c2goe1xuICAgICAgICAgICAgICAgICAgICBuYW1lOiBpdGVtUHJvY09yYlNvdXJjZXMuc291cmNlc1tpXS5uYW1lLFxuICAgICAgICAgICAgICAgICAgICBkYW1hZ2U6IGQsXG4gICAgICAgICAgICAgICAgICAgIGRhbWFnZVR5cGU6IGl0ZW1Qcm9jT3JiU291cmNlcy5zb3VyY2VzW2ldLmRhbWFnZVR5cGUsXG4gICAgICAgICAgICAgICAgICAgIGRhbWFnZVJlZHVjZWQ6IHNlbGYuZ2V0UmVkdWNlZERhbWFnZShkLCBpdGVtUHJvY09yYlNvdXJjZXMuc291cmNlc1tpXS5kYW1hZ2VUeXBlKSxcbiAgICAgICAgICAgICAgICAgICAgZW5hYmxlZDoga28ub2JzZXJ2YWJsZSh0cnVlKVxuICAgICAgICAgICAgICAgIH0pO1xuICAgICAgICAgICAgICAgIHRvdGFsRGFtYWdlICs9IGQ7XG4gICAgICAgICAgICAgICAgZGFtYWdlW2l0ZW1Qcm9jT3JiU291cmNlcy5zb3VyY2VzW2ldLmRhbWFnZVR5cGVdICs9IGQ7XG4gICAgICAgICAgICB9XG4gICAgICAgICAgICBcbiAgICAgICAgICAgIC8vIGFiaWxpdHkgb3Jic1xuICAgICAgICAgICAgZm9yICh2YXIgb3JiIGluIGFiaWxpdHlPcmJTb3VyY2VzKSB7XG4gICAgICAgICAgICAgICAgdmFyIGQgPSBhYmlsaXR5T3JiU291cmNlc1tvcmJdLmRhbWFnZSAqICgxIC0gaXRlbVByb2NPcmJTb3VyY2VzLnRvdGFsKTtcbiAgICAgICAgICAgICAgICByZXN1bHQucHVzaCh7XG4gICAgICAgICAgICAgICAgICAgIG5hbWU6IGFiaWxpdHlPcmJTb3VyY2VzW29yYl0uZGlzcGxheW5hbWUsXG4gICAgICAgICAgICAgICAgICAgIGRhbWFnZTogZCxcbiAgICAgICAgICAgICAgICAgICAgZGFtYWdlVHlwZTogYWJpbGl0eU9yYlNvdXJjZXNbb3JiXS5kYW1hZ2VUeXBlLFxuICAgICAgICAgICAgICAgICAgICBkYW1hZ2VSZWR1Y2VkOiBzZWxmLmdldFJlZHVjZWREYW1hZ2UoZCwgYWJpbGl0eU9yYlNvdXJjZXNbb3JiXS5kYW1hZ2VUeXBlKSxcbiAgICAgICAgICAgICAgICAgICAgZW5hYmxlZDoga28ub2JzZXJ2YWJsZSh0cnVlKVxuICAgICAgICAgICAgICAgIH0pO1xuICAgICAgICAgICAgICAgIHRvdGFsRGFtYWdlICs9IGQ7XG4gICAgICAgICAgICAgICAgZGFtYWdlW2FiaWxpdHlPcmJTb3VyY2VzW29yYl0uZGFtYWdlVHlwZV0gKz0gZDtcbiAgICAgICAgICAgIH1cbiAgICAgICAgICAgIFxuICAgICAgICAgICAgLy8gaXRlbSBvcmJzXG4gICAgICAgICAgICBpZiAoT2JqZWN0LmtleXMoYWJpbGl0eU9yYlNvdXJjZXMpLmxlbmd0aCA9PT0gMCkge1xuICAgICAgICAgICAgICAgIGZvciAodmFyIG9yYiBpbiBpdGVtT3JiU291cmNlcykge1xuICAgICAgICAgICAgICAgICAgICB2YXIgZCA9IGl0ZW1PcmJTb3VyY2VzW29yYl0uZGFtYWdlICogKDEgLSBpdGVtUHJvY09yYlNvdXJjZXMudG90YWwpO1xuICAgICAgICAgICAgICAgICAgICByZXN1bHQucHVzaCh7XG4gICAgICAgICAgICAgICAgICAgICAgICBuYW1lOiBpdGVtT3JiU291cmNlc1tvcmJdLmRpc3BsYXluYW1lLFxuICAgICAgICAgICAgICAgICAgICAgICAgZGFtYWdlOiBkLFxuICAgICAgICAgICAgICAgICAgICAgICAgZGFtYWdlVHlwZTogaXRlbU9yYlNvdXJjZXNbb3JiXS5kYW1hZ2VUeXBlLFxuICAgICAgICAgICAgICAgICAgICAgICAgZGFtYWdlUmVkdWNlZDogc2VsZi5nZXRSZWR1Y2VkRGFtYWdlKGQsIGl0ZW1PcmJTb3VyY2VzW29yYl0uZGFtYWdlVHlwZSksXG4gICAgICAgICAgICAgICAgICAgICAgICBlbmFibGVkOiBrby5vYnNlcnZhYmxlKHRydWUpXG4gICAgICAgICAgICAgICAgICAgIH0pO1xuICAgICAgICAgICAgICAgICAgICB0b3RhbERhbWFnZSArPSBkO1xuICAgICAgICAgICAgICAgICAgICBkYW1hZ2VbaXRlbU9yYlNvdXJjZXNbb3JiXS5kYW1hZ2VUeXBlXSArPSBkO1xuICAgICAgICAgICAgICAgIH0gICAgICAgICAgICBcbiAgICAgICAgICAgIH1cbiAgICAgICAgICAgIFxuICAgICAgICAgICAgLy8gY3JpdCBkYW1hZ2VcbiAgICAgICAgICAgIGZvciAodmFyIGkgPSAwOyBpIDwgY3JpdFNvdXJjZXMuc291cmNlcy5sZW5ndGg7IGkrKykge1xuICAgICAgICAgICAgICAgIHZhciBkID0gdG90YWxDcml0YWJsZURhbWFnZSAqIChjcml0U291cmNlcy5zb3VyY2VzW2ldLm11bHRpcGxpZXIgLSAxKTsvLyAqIGNyaXRTb3VyY2VzLnNvdXJjZXNbaV0udG90YWxDaGFuY2U7XG4gICAgICAgICAgICAgICAgY3JpdHMucHVzaCh7XG4gICAgICAgICAgICAgICAgICAgIG5hbWU6IGNyaXRTb3VyY2VzLnNvdXJjZXNbaV0ubmFtZSArICcsICcgKyBjcml0U291cmNlcy5zb3VyY2VzW2ldLm11bHRpcGxpZXIgKyAneCwgJyArIChjcml0U291cmNlcy5zb3VyY2VzW2ldLnRvdGFsQ2hhbmNlICogMTAwKS50b0ZpeGVkKDEpICsgJyUnLFxuICAgICAgICAgICAgICAgICAgICBkYW1hZ2U6IGQsXG4gICAgICAgICAgICAgICAgICAgIGRhbWFnZVR5cGU6ICdwaHlzaWNhbCcsXG4gICAgICAgICAgICAgICAgICAgIGRhbWFnZVJlZHVjZWQ6IHNlbGYuZ2V0UmVkdWNlZERhbWFnZShkLCAncGh5c2ljYWwnKSxcbiAgICAgICAgICAgICAgICAgICAgZW5hYmxlZDoga28ub2JzZXJ2YWJsZSh0cnVlKSxcbiAgICAgICAgICAgICAgICAgICAgY2hhbmNlOiBjcml0U291cmNlcy5zb3VyY2VzW2ldLnRvdGFsQ2hhbmNlXG4gICAgICAgICAgICAgICAgfSk7XG4gICAgICAgICAgICAgICAgdG90YWxDcml0ICs9IGQ7XG4gICAgICAgICAgICB9XG5cbiAgICAgICAgICAgIHZhciB0b3RhbFJlZHVjZWQgPSBzZWxmLmdldFJlZHVjZWREYW1hZ2UoZGFtYWdlLnB1cmUsICdwdXJlJykgXG4gICAgICAgICAgICAgICAgICAgICsgc2VsZi5nZXRSZWR1Y2VkRGFtYWdlKGRhbWFnZS5waHlzaWNhbCwgJ3BoeXNpY2FsJylcbiAgICAgICAgICAgICAgICAgICAgKyBzZWxmLmdldFJlZHVjZWREYW1hZ2UoZGFtYWdlLm1hZ2ljLCAnbWFnaWMnKSxcbiAgICAgICAgICAgICAgICB0b3RhbENyaXRSZWR1Y2VkID0gc2VsZi5nZXRSZWR1Y2VkRGFtYWdlKHRvdGFsQ3JpdCwgJ3BoeXNpY2FsJyksXG4gICAgICAgICAgICAgICAgZHBzID0ge1xuICAgICAgICAgICAgICAgICAgICBiYXNlOiB0b3RhbERhbWFnZSAqIHNlbGYuYXR0YWNrc1BlclNlY29uZCgpLFxuICAgICAgICAgICAgICAgICAgICBjcml0OiB0b3RhbENyaXQgKiBzZWxmLmF0dGFja3NQZXJTZWNvbmQoKSxcbiAgICAgICAgICAgICAgICAgICAgZ2VtaW5hdGVBdHRhY2s6IGdlbWluYXRlQXR0YWNrLmFjdGl2ZSA/IGdlbWluYXRlQXR0YWNrLmRhbWFnZSAvIGdlbWluYXRlQXR0YWNrLmNvb2xkb3duIDogMCxcbiAgICAgICAgICAgICAgICAgICAgcmVkdWNlZDoge1xuICAgICAgICAgICAgICAgICAgICAgICAgYmFzZTogdG90YWxSZWR1Y2VkICogc2VsZi5hdHRhY2tzUGVyU2Vjb25kKCksXG4gICAgICAgICAgICAgICAgICAgICAgICBjcml0OiB0b3RhbENyaXRSZWR1Y2VkICogc2VsZi5hdHRhY2tzUGVyU2Vjb25kKCksXG4gICAgICAgICAgICAgICAgICAgICAgICBnZW1pbmF0ZUF0dGFjazogZ2VtaW5hdGVBdHRhY2suYWN0aXZlID8gc2VsZi5nZXRSZWR1Y2VkRGFtYWdlKGdlbWluYXRlQXR0YWNrLmRhbWFnZSwgJ3BoeXNpY2FsJykgLyBnZW1pbmF0ZUF0dGFjay5jb29sZG93biA6IDAsXG4gICAgICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgICAgXG4gICAgICAgICAgICBjcml0cy5mb3JFYWNoKGZ1bmN0aW9uIChvKSB7XG4gICAgICAgICAgICAgICAgaWYgKCFvLmRwcykge1xuICAgICAgICAgICAgICAgICAgICBvLmRwcyA9IG8uZGFtYWdlICogKG8uY29vbGRvd24gfHwgc2VsZi5hdHRhY2tzUGVyU2Vjb25kKCkpICogby5jaGFuY2U7XG4gICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICAgIGlmICghby5kcHNSZWR1Y2VkKSB7XG4gICAgICAgICAgICAgICAgICAgIG8uZHBzUmVkdWNlZCA9IG8uZGFtYWdlUmVkdWNlZCAqIChvLmNvb2xkb3duIHx8IHNlbGYuYXR0YWNrc1BlclNlY29uZCgpKSAqIG8uY2hhbmNlO1xuICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgIH0pO1xuICAgICAgICAgICAgICAgIFxuICAgICAgICAgICAgcmVzdWx0LmZvckVhY2goZnVuY3Rpb24gKG8pIHtcbiAgICAgICAgICAgICAgICBpZiAoIW8uZHBzKSB7XG4gICAgICAgICAgICAgICAgICAgIG8uZHBzID0gby5kYW1hZ2UgKiAoby5jb29sZG93biB8fCBzZWxmLmF0dGFja3NQZXJTZWNvbmQoKSk7XG4gICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICAgIGlmICghby5kcHNSZWR1Y2VkKSB7XG4gICAgICAgICAgICAgICAgICAgIG8uZHBzUmVkdWNlZCA9IG8uZGFtYWdlUmVkdWNlZCAqIChvLmNvb2xkb3duIHx8IHNlbGYuYXR0YWNrc1BlclNlY29uZCgpKTtcbiAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICB9KTtcbiAgICAgICAgICAgIFxuICAgICAgICAgICAgdmFyIHRvdGFsQ3JpdENoYW5jZSA9IGNyaXRzLnJlZHVjZShmdW5jdGlvbiAobWVtbywgbykgeyByZXR1cm4gbWVtbyArIG8uY2hhbmNlIH0sIDApO1xuICAgICAgICAgICAgICAgIFxuICAgICAgICAgICAgdmFyIHQxQ3JpdCA9IGtvLmNvbXB1dGVkKGZ1bmN0aW9uICgpIHtcbiAgICAgICAgICAgICAgICB2YXIgYyA9IGNyaXRzLmZpbmQoZnVuY3Rpb24gKG8pIHsgcmV0dXJuIG8uZW5hYmxlZCgpOyB9KTtcbiAgICAgICAgICAgICAgICByZXR1cm4gYyA/IGMuZGFtYWdlIDogMDtcbiAgICAgICAgICAgIH0pO1xuICAgICAgICAgICAgdmFyIHQyQ3JpdCA9IGtvLmNvbXB1dGVkKGZ1bmN0aW9uICgpIHtcbiAgICAgICAgICAgICAgICB2YXIgYyA9IGNyaXRzLmZpbmQoZnVuY3Rpb24gKG8pIHsgcmV0dXJuIG8uZW5hYmxlZCgpOyB9KTtcbiAgICAgICAgICAgICAgICByZXR1cm4gYyA/IGMuZGFtYWdlUmVkdWNlZCA6IDA7XG4gICAgICAgICAgICB9KTtcbiAgICAgICAgICAgIHZhciB0M0NyaXQgPSBrby5jb21wdXRlZChmdW5jdGlvbiAoKSB7XG4gICAgICAgICAgICAgICAgcmV0dXJuIGNyaXRzLmZpbHRlcihmdW5jdGlvbiAobykgeyByZXR1cm4gby5lbmFibGVkKCk7IH0pLnJlZHVjZShmdW5jdGlvbiAobWVtbywgbykgeyByZXR1cm4gbWVtbyArIG8uZHBzIH0sIDApO1xuICAgICAgICAgICAgfSk7XG4gICAgICAgICAgICB2YXIgdDRDcml0ID0ga28uY29tcHV0ZWQoZnVuY3Rpb24gKCkge1xuICAgICAgICAgICAgICAgIHJldHVybiBjcml0cy5maWx0ZXIoZnVuY3Rpb24gKG8pIHsgcmV0dXJuIG8uZW5hYmxlZCgpOyB9KS5yZWR1Y2UoZnVuY3Rpb24gKG1lbW8sIG8pIHsgcmV0dXJuIG1lbW8gKyBvLmRwc1JlZHVjZWQgfSwgMCk7XG4gICAgICAgICAgICB9KTtcbiAgICAgICAgICAgICAgICBcbiAgICAgICAgICAgIHZhciB0MSA9IGtvLmNvbXB1dGVkKGZ1bmN0aW9uICgpIHtcbiAgICAgICAgICAgICAgICByZXR1cm4gcmVzdWx0LmZpbHRlcihmdW5jdGlvbiAobykgeyByZXR1cm4gby5lbmFibGVkKCk7IH0pLnJlZHVjZShmdW5jdGlvbiAobWVtbywgbykgeyByZXR1cm4gbWVtbyArIG8uZGFtYWdlIH0sIDApICsgdDFDcml0KCk7XG4gICAgICAgICAgICB9KTtcbiAgICAgICAgICAgIHZhciB0MiA9IGtvLmNvbXB1dGVkKGZ1bmN0aW9uICgpIHtcbiAgICAgICAgICAgICAgICByZXR1cm4gcmVzdWx0LmZpbHRlcihmdW5jdGlvbiAobykgeyByZXR1cm4gby5lbmFibGVkKCk7IH0pLnJlZHVjZShmdW5jdGlvbiAobWVtbywgbykgeyByZXR1cm4gbWVtbyArIG8uZGFtYWdlUmVkdWNlZCB9LCAwKSArIHQyQ3JpdCgpO1xuICAgICAgICAgICAgfSk7XG4gICAgICAgICAgICB2YXIgdDMgPSBrby5jb21wdXRlZChmdW5jdGlvbiAoKSB7XG4gICAgICAgICAgICAgICAgcmV0dXJuIChyZXN1bHQuZmlsdGVyKGZ1bmN0aW9uIChvKSB7IHJldHVybiBvLmVuYWJsZWQoKTsgfSkucmVkdWNlKGZ1bmN0aW9uIChtZW1vLCBvKSB7IHJldHVybiBtZW1vICsgby5kcHMgfSwgMCkgKyB0M0NyaXQoKSkgKiBhLmNvb2xkb3duO1xuICAgICAgICAgICAgfSk7XG4gICAgICAgICAgICB2YXIgdDQgPSBrby5jb21wdXRlZChmdW5jdGlvbiAoKSB7XG4gICAgICAgICAgICAgICAgcmV0dXJuIChyZXN1bHQuZmlsdGVyKGZ1bmN0aW9uIChvKSB7IHJldHVybiBvLmVuYWJsZWQoKTsgfSkucmVkdWNlKGZ1bmN0aW9uIChtZW1vLCBvKSB7IHJldHVybiBtZW1vICsgby5kcHNSZWR1Y2VkIH0sIDApICsgdDRDcml0KCkpICogYS5jb29sZG93bjtcbiAgICAgICAgICAgIH0pO1xuICAgICAgICAgICAgXG4gICAgICAgICAgICB2YXIgdG90YWxDcml0Um93ID0gW3QxQ3JpdCwgdDJDcml0LCB0M0NyaXQsIHQ0Q3JpdF07XG4gICAgICAgICAgICBcbiAgICAgICAgICAgIHZhciB0b3RhbFJvdyA9IFt0MSwgdDIsIHQzLCB0NF07XG5cbiAgICAgICAgICAgIHJldHVybiB7XG4gICAgICAgICAgICAgICAgbmFtZTogYS5uYW1lICsgJyBTdWJ0b3RhbCcsXG4gICAgICAgICAgICAgICAgY29vbGRvd246IGEuY29vbGRvd24sXG4gICAgICAgICAgICAgICAgZW5hYmxlZDoga28ub2JzZXJ2YWJsZSh0cnVlKSxcbiAgICAgICAgICAgICAgICB2aXNpYmxlOiBrby5vYnNlcnZhYmxlKHRydWUpLFxuICAgICAgICAgICAgICAgIHRvdGFsQ3JpdENoYW5jZTogdG90YWxDcml0Q2hhbmNlLFxuICAgICAgICAgICAgICAgIHRvdGFsQ3JpdFJvdzogdG90YWxDcml0Um93LFxuICAgICAgICAgICAgICAgIHRvdGFsUm93OiB0b3RhbFJvdyxcbiAgICAgICAgICAgICAgICBzb3VyY2VzOiByZXN1bHQsXG4gICAgICAgICAgICAgICAgc291cmNlc0NyaXQ6IGNyaXRzLFxuICAgICAgICAgICAgICAgIHRvdGFsOiB0b3RhbERhbWFnZSxcbiAgICAgICAgICAgICAgICB0b3RhbENyaXQ6IHRvdGFsQ3JpdCxcbiAgICAgICAgICAgICAgICB0b3RhbEdlbWluYXRlQXR0YWNrOiB0b3RhbERhbWFnZSArIGdlbWluYXRlQXR0YWNrLmRhbWFnZSxcbiAgICAgICAgICAgICAgICB0b3RhbEdlbWluYXRlQXR0YWNrUmVkdWNlZDogdG90YWxSZWR1Y2VkICsgZ2VtaW5hdGVBdHRhY2suZGFtYWdlUmVkdWNlZCxcbiAgICAgICAgICAgICAgICBnZW1pbmF0ZUF0dGFjazogZ2VtaW5hdGVBdHRhY2ssXG4gICAgICAgICAgICAgICAgdG90YWxDcml0UmVkdWNlZDogdG90YWxDcml0UmVkdWNlZCxcbiAgICAgICAgICAgICAgICB0b3RhbFJlZHVjZWQ6IHRvdGFsUmVkdWNlZCxcbiAgICAgICAgICAgICAgICBzdW1Ub3RhbDogdG90YWxEYW1hZ2UgKyB0b3RhbENyaXQsXG4gICAgICAgICAgICAgICAgc3VtVG90YWxSZWR1Y2VkOiB0b3RhbFJlZHVjZWQgKyB0b3RhbENyaXRSZWR1Y2VkLFxuICAgICAgICAgICAgICAgIGRwczoge1xuICAgICAgICAgICAgICAgICAgICBiYXNlOiBkcHMuYmFzZSxcbiAgICAgICAgICAgICAgICAgICAgY3JpdDogZHBzLmJhc2UgKyBkcHMuY3JpdCxcbiAgICAgICAgICAgICAgICAgICAgZ2VtaW5hdGVBdHRhY2s6IGRwcy5iYXNlICsgZHBzLmdlbWluYXRlQXR0YWNrLFxuICAgICAgICAgICAgICAgICAgICB0b3RhbDogZHBzLmJhc2UgKyBkcHMuY3JpdCArIGRwcy5nZW1pbmF0ZUF0dGFjayxcbiAgICAgICAgICAgICAgICAgICAgcmVkdWNlZDoge1xuICAgICAgICAgICAgICAgICAgICAgICAgYmFzZTogZHBzLnJlZHVjZWQuYmFzZSxcbiAgICAgICAgICAgICAgICAgICAgICAgIGNyaXQ6IGRwcy5yZWR1Y2VkLmJhc2UgKyBkcHMucmVkdWNlZC5jcml0LFxuICAgICAgICAgICAgICAgICAgICAgICAgZ2VtaW5hdGVBdHRhY2s6IGRwcy5yZWR1Y2VkLmJhc2UgKyBkcHMucmVkdWNlZC5nZW1pbmF0ZUF0dGFjayxcbiAgICAgICAgICAgICAgICAgICAgICAgIHRvdGFsOiBkcHMucmVkdWNlZC5iYXNlICsgZHBzLnJlZHVjZWQuY3JpdCArIGRwcy5yZWR1Y2VkLmdlbWluYXRlQXR0YWNrXG4gICAgICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICB9O1xuICAgICAgICB9KTtcbiAgICAgICAgXG4gICAgICAgIHZhciB0MSA9IGtvLmNvbXB1dGVkKGZ1bmN0aW9uICgpIHtcbiAgICAgICAgICAgIHJldHVybiBhdHRhY2tzLmZpbHRlcihmdW5jdGlvbiAobykgeyByZXR1cm4gby5lbmFibGVkKCk7IH0pLnJlZHVjZShmdW5jdGlvbiAobWVtbywgbykgeyByZXR1cm4gbWVtbyArIG8udG90YWxSb3dbMF0oKSB9LCAwKTtcbiAgICAgICAgfSk7XG4gICAgICAgIHZhciB0MiA9IGtvLmNvbXB1dGVkKGZ1bmN0aW9uICgpIHtcbiAgICAgICAgICAgIHJldHVybiBhdHRhY2tzLmZpbHRlcihmdW5jdGlvbiAobykgeyByZXR1cm4gby5lbmFibGVkKCk7IH0pLnJlZHVjZShmdW5jdGlvbiAobWVtbywgbykgeyByZXR1cm4gbWVtbyArIG8udG90YWxSb3dbMV0oKSB9LCAwKTtcbiAgICAgICAgfSk7XG4gICAgICAgIHZhciB0MyA9IGtvLmNvbXB1dGVkKGZ1bmN0aW9uICgpIHtcbiAgICAgICAgICAgIHJldHVybiBhdHRhY2tzLmZpbHRlcihmdW5jdGlvbiAobykgeyByZXR1cm4gby5lbmFibGVkKCk7IH0pLnJlZHVjZShmdW5jdGlvbiAobWVtbywgbykgeyByZXR1cm4gbWVtbyArIG8udG90YWxSb3dbMl0oKSB9LCAwKTtcbiAgICAgICAgfSk7XG4gICAgICAgIHZhciB0NCA9IGtvLmNvbXB1dGVkKGZ1bmN0aW9uICgpIHtcbiAgICAgICAgICAgIHJldHVybiBhdHRhY2tzLmZpbHRlcihmdW5jdGlvbiAobykgeyByZXR1cm4gby5lbmFibGVkKCk7IH0pLnJlZHVjZShmdW5jdGlvbiAobWVtbywgbykgeyByZXR1cm4gbWVtbyArIG8udG90YWxSb3dbM10oKSB9LCAwKTtcbiAgICAgICAgfSk7XG4gICAgICAgICAgICBcbiAgICAgICAgcmV0dXJuIHtcbiAgICAgICAgICAgIGF0dGFja3M6IGF0dGFja3MsXG4gICAgICAgICAgICB0b3RhbFJvdzogW3QxLCB0MiwgdDMsIHQ0XVxuICAgICAgICB9XG4gICAgfSk7XG4gICAgXG4gICAgc2VsZi5nZXREYW1hZ2VUeXBlQ29sb3IgPSBmdW5jdGlvbiAoZGFtYWdlVHlwZSkge1xuICAgICAgICByZXR1cm4gRGFtYWdlVHlwZUNvbG9yW2RhbWFnZVR5cGVdIHx8IERhbWFnZVR5cGVDb2xvclsnZGVmYXVsdCddO1xuICAgIH1cbiAgICBcbn1cblxubW9kdWxlLmV4cG9ydHMgPSBIZXJvRGFtYWdlTWl4aW47IiwiJ3VzZSBzdHJpY3QnO1xudmFyIGtvID0gcmVxdWlyZSgnLi4vaGVyb2NhbGNfa25vY2tvdXQnKTtcblxudmFyIEFiaWxpdHlNb2RlbCA9IHJlcXVpcmUoXCIuLi9BYmlsaXR5TW9kZWxcIik7XG52YXIgQnVmZlZpZXdNb2RlbCA9IHJlcXVpcmUoXCIuLi9CdWZmVmlld01vZGVsXCIpO1xudmFyIEludmVudG9yeVZpZXdNb2RlbCA9IHJlcXVpcmUoXCIuLi9pbnZlbnRvcnkvSW52ZW50b3J5Vmlld01vZGVsXCIpO1xudmFyIGRpZmZQcm9wZXJ0aWVzID0gcmVxdWlyZShcIi4vZGlmZlByb3BlcnRpZXNcIik7XG52YXIgSGVyb0RhbWFnZU1peGluID0gcmVxdWlyZShcIi4vSGVyb0RhbWFnZU1peGluXCIpO1xudmFyIFRhbGVudENvbnRyb2xsZXIgPSByZXF1aXJlKFwiLi9UYWxlbnRDb250cm9sbGVyXCIpO1xudmFyIHRvdGFsRXhwID0gcmVxdWlyZShcIi4vdG90YWxFeHBcIik7XG52YXIgbmV4dExldmVsRXhwID0gcmVxdWlyZShcIi4vbmV4dExldmVsRXhwXCIpO1xuXG52YXIgSGVyb01vZGVsID0gZnVuY3Rpb24gKGhlcm9EYXRhLCBpdGVtRGF0YSwgaCkge1xuICAgIHZhciBzZWxmID0gdGhpcztcbiAgICBzZWxmLmhlcm9JZCA9IGtvLm9ic2VydmFibGUoaCk7XG4gICAgc2VsZi5zZWxlY3RlZEhlcm9MZXZlbCA9IGtvLm9ic2VydmFibGUoMSk7XG4gICAgc2VsZi5pbnZlbnRvcnkgPSBuZXcgSW52ZW50b3J5Vmlld01vZGVsKGl0ZW1EYXRhLCBzZWxmKTtcbiAgICBzZWxmLnNlbGVjdGVkSW52ZW50b3J5ID0ga28ub2JzZXJ2YWJsZSgtMSk7XG4gICAgc2VsZi5idWZmcyA9IG5ldyBCdWZmVmlld01vZGVsKGl0ZW1EYXRhKTtcbiAgICBzZWxmLmJ1ZmZzLmhhc1NjZXB0ZXIgPSBzZWxmLmludmVudG9yeS5oYXNTY2VwdGVyO1xuICAgIHNlbGYuZGVidWZmcyA9IG5ldyBCdWZmVmlld01vZGVsKGl0ZW1EYXRhKTtcbiAgICBzZWxmLmhlcm9EYXRhID0ga28uY29tcHV0ZWQoZnVuY3Rpb24gKCkge1xuICAgICAgcmV0dXJuIGhlcm9EYXRhWyducGNfZG90YV9oZXJvXycgKyBzZWxmLmhlcm9JZCgpXTtcbiAgICB9KTtcbiAgICBzZWxmLmhlcm9Db21wYXJlID0ga28ub2JzZXJ2YWJsZShzZWxmKTtcbiAgICBzZWxmLmVuZW15ID0ga28ub2JzZXJ2YWJsZShzZWxmKTtcbiAgICBzZWxmLnVuaXQgPSBrby5vYnNlcnZhYmxlKHNlbGYpO1xuICAgIHNlbGYuY2xvbmUgPSBrby5vYnNlcnZhYmxlKHNlbGYpO1xuICAgIFxuICAgIHNlbGYudGFsZW50cyA9IFtcbiAgICAgICAga28ub2JzZXJ2YWJsZSgtMSksXG4gICAgICAgIGtvLm9ic2VydmFibGUoLTEpLFxuICAgICAgICBrby5vYnNlcnZhYmxlKC0xKSxcbiAgICAgICAga28ub2JzZXJ2YWJsZSgtMSlcbiAgICBdO1xuICAgIFxuICAgIHNlbGYuc2VsZWN0ZWRUYWxlbnRzID0ga28uY29tcHV0ZWQoZnVuY3Rpb24gKCkge1xuICAgICAgICB2YXIgYXJyID0gW107XG4gICAgICAgIGZvciAodmFyIGkgPSAwOyBpIDwgNDsgaSsrKSB7XG4gICAgICAgICAgICBpZiAoc2VsZi50YWxlbnRzW2ldKCkgIT09IC0xKSB7XG4gICAgICAgICAgICAgICAgYXJyLnB1c2goc2VsZi5oZXJvRGF0YSgpLnRhbGVudHNbaV1bc2VsZi50YWxlbnRzW2ldKCldKTtcbiAgICAgICAgICAgIH1cbiAgICAgICAgfVxuICAgICAgICByZXR1cm4gYXJyO1xuICAgIH0pO1xuICAgIFxuICAgIHNlbGYuc2tpbGxQb2ludEhpc3RvcnkgPSBrby5vYnNlcnZhYmxlQXJyYXkoKTtcbiAgICBcbiAgICBzZWxmLmFiaWxpdHkgPSBrby5jb21wdXRlZChmdW5jdGlvbiAoKSB7XG4gICAgICAgIHZhciBhID0gbmV3IEFiaWxpdHlNb2RlbChrby5vYnNlcnZhYmxlQXJyYXkoSlNPTi5wYXJzZShKU09OLnN0cmluZ2lmeShzZWxmLmhlcm9EYXRhKCkuYWJpbGl0aWVzKSkpLCBzZWxmKTtcbiAgICAgICAgc3dpdGNoIChzZWxmLmhlcm9JZCgpKSB7XG4gICAgICAgICAgICBjYXNlICdlYXJ0aF9zcGlyaXQnOlxuICAgICAgICAgICAgY2FzZSAnb2dyZV9tYWdpJzpcbiAgICAgICAgICAgICAgICBhLl9hYmlsaXRpZXNbM10ubGV2ZWwoMSk7XG4gICAgICAgICAgICBicmVhaztcbiAgICAgICAgICAgIGNhc2UgJ2ludm9rZXInOlxuICAgICAgICAgICAgICAgIGZvciAodmFyIGkgPSA1OyBpIDwgMTY7IGkrKykge1xuICAgICAgICAgICAgICAgICAgICBjb25zb2xlLmxvZyhhLl9hYmlsaXRpZXNbaV0pO1xuICAgICAgICAgICAgICAgICAgICBhLl9hYmlsaXRpZXNbaV0ubGV2ZWwoMSk7XG4gICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgYnJlYWs7XG4gICAgICAgIH1cbiAgICAgICAgc2VsZi5za2lsbFBvaW50SGlzdG9yeS5yZW1vdmVBbGwoKTtcbiAgICAgICAgYS5oYXNTY2VwdGVyID0gc2VsZi5pbnZlbnRvcnkuaGFzU2NlcHRlclxuICAgICAgICByZXR1cm4gYTtcbiAgICB9KTtcblxuICAgIHNlbGYuYXZhaWxhYmxlU2tpbGxQb2ludHMgPSBrby5jb21wdXRlZChmdW5jdGlvbiAoKSB7XG4gICAgICAgIHZhciBjID0gc2VsZi5zZWxlY3RlZEhlcm9MZXZlbCgpO1xuICAgICAgICBmb3IgKHZhciBpID0gMDsgaSA8IDQ7IGkrKykge1xuICAgICAgICAgICAgaWYgKHNlbGYuc2VsZWN0ZWRIZXJvTGV2ZWwoKSA8IGkgKiA1ICsgMTApIHNlbGYudGFsZW50c1tpXSgtMSk7XG4gICAgICAgIH1cbiAgICAgICAgYyAtPSBzZWxmLnRhbGVudHMuZmlsdGVyKGZ1bmN0aW9uICh0YWxlbnQpIHsgcmV0dXJuIHRhbGVudCgpICE9PSAtMSB9KS5sZW5ndGg7XG4gICAgICAgIGZvciAodmFyIGkgPSAwOyBpIDwgc2VsZi5hYmlsaXR5KCkuYWJpbGl0aWVzKCkubGVuZ3RoOyBpKyspIHtcbiAgICAgICAgICAgIHN3aXRjaChzZWxmLmFiaWxpdHkoKS5hYmlsaXRpZXMoKVtpXS5hYmlsaXR5dHlwZSkge1xuICAgICAgICAgICAgICAgIGNhc2UgJ0RPVEFfQUJJTElUWV9UWVBFX1VMVElNQVRFJzpcbiAgICAgICAgICAgICAgICAgICAgaWYgKHNlbGYuaGVyb0lkKCkgPT09ICdpbnZva2VyJykge1xuICAgICAgICAgICAgICAgICAgICAgICAgLyp3aGlsZSAoXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgKChzZWxmLmFiaWxpdHkoKS5hYmlsaXRpZXMoKVtpXS5sZXZlbCgpID09IDEpICYmIChwYXJzZUludChzZWxmLnNlbGVjdGVkSGVyb0xldmVsKCkpIDwgMikpIHx8XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgKChzZWxmLmFiaWxpdHkoKS5hYmlsaXRpZXMoKVtpXS5sZXZlbCgpID09IDIpICYmIChwYXJzZUludChzZWxmLnNlbGVjdGVkSGVyb0xldmVsKCkpIDwgNykpIHx8XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgKChzZWxmLmFiaWxpdHkoKS5hYmlsaXRpZXMoKVtpXS5sZXZlbCgpID09IDMpICYmIChwYXJzZUludChzZWxmLnNlbGVjdGVkSGVyb0xldmVsKCkpIDwgMTEpKSB8fFxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICgoc2VsZi5hYmlsaXR5KCkuYWJpbGl0aWVzKClbaV0ubGV2ZWwoKSA9PSA0KSAmJiAocGFyc2VJbnQoc2VsZi5zZWxlY3RlZEhlcm9MZXZlbCgpKSA8IDE3KSlcbiAgICAgICAgICAgICAgICAgICAgICAgICkge1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgIHNlbGYuYWJpbGl0eSgpLmxldmVsRG93bkFiaWxpdHkoaSwgbnVsbCwgbnVsbCwgc2VsZik7XG4gICAgICAgICAgICAgICAgICAgICAgICB9Ki9cbiAgICAgICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICAgICAgICBlbHNlIGlmIChzZWxmLmhlcm9JZCgpID09PSAnbWVlcG8nKSB7XG4gICAgICAgICAgICAgICAgICAgICAgICB3aGlsZSAoKHNlbGYuYWJpbGl0eSgpLmFiaWxpdGllcygpW2ldLmxldmVsKCktMSkgKiA3ICsgMyA+IHBhcnNlSW50KHNlbGYuc2VsZWN0ZWRIZXJvTGV2ZWwoKSkpIHtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICBzZWxmLmFiaWxpdHkoKS5sZXZlbERvd25BYmlsaXR5KGksIG51bGwsIG51bGwsIHNlbGYpO1xuICAgICAgICAgICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgICAgICAgIGVsc2Uge1xuICAgICAgICAgICAgICAgICAgICAgICAgd2hpbGUgKHNlbGYuYWJpbGl0eSgpLmFiaWxpdGllcygpW2ldLmxldmVsKCkgKiA1ICsgMSA+IHBhcnNlSW50KHNlbGYuc2VsZWN0ZWRIZXJvTGV2ZWwoKSkpIHtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICBzZWxmLmFiaWxpdHkoKS5sZXZlbERvd25BYmlsaXR5KGksIG51bGwsIG51bGwsIHNlbGYpO1xuICAgICAgICAgICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgICAgYnJlYWs7XG4gICAgICAgICAgICAgICAgZGVmYXVsdDpcbiAgICAgICAgICAgICAgICAgICAgd2hpbGUgKHNlbGYuYWJpbGl0eSgpLmFiaWxpdGllcygpW2ldLmxldmVsKCkgKiAyIC0gMSA+IHBhcnNlSW50KHNlbGYuc2VsZWN0ZWRIZXJvTGV2ZWwoKSkpIHtcbiAgICAgICAgICAgICAgICAgICAgICAgIHNlbGYuYWJpbGl0eSgpLmxldmVsRG93bkFiaWxpdHkoaSwgbnVsbCwgbnVsbCwgc2VsZik7XG4gICAgICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgICBicmVhaztcbiAgICAgICAgICAgIH1cbiAgICAgICAgfVxuICAgICAgICB3aGlsZSAoc2VsZi5za2lsbFBvaW50SGlzdG9yeSgpLmxlbmd0aCA+IGMpIHtcbiAgICAgICAgICAgIHNlbGYuYWJpbGl0eSgpLmxldmVsRG93bkFiaWxpdHkoc2VsZi5za2lsbFBvaW50SGlzdG9yeSgpW3NlbGYuc2tpbGxQb2ludEhpc3RvcnkoKS5sZW5ndGgtMV0sIG51bGwsIG51bGwsIHNlbGYpO1xuICAgICAgICB9XG4gICAgICAgIHJldHVybiBjLXNlbGYuc2tpbGxQb2ludEhpc3RvcnkoKS5sZW5ndGg7XG4gICAgfSwgdGhpcyk7XG4gICAgc2VsZi5wcmltYXJ5QXR0cmlidXRlID0ga28ucHVyZUNvbXB1dGVkKGZ1bmN0aW9uICgpIHtcbiAgICAgICAgdmFyIHYgPSBzZWxmLmhlcm9EYXRhKCkuYXR0cmlidXRlcHJpbWFyeTtcbiAgICAgICAgaWYgKHYgPT09ICdET1RBX0FUVFJJQlVURV9BR0lMSVRZJykgcmV0dXJuICdhZ2knO1xuICAgICAgICBpZiAodiA9PT0gJ0RPVEFfQVRUUklCVVRFX0lOVEVMTEVDVCcpIHJldHVybiAnaW50JztcbiAgICAgICAgaWYgKHYgPT09ICdET1RBX0FUVFJJQlVURV9TVFJFTkdUSCcpIHJldHVybiAnc3RyJztcbiAgICAgICAgcmV0dXJuICcnO1xuICAgIH0pO1xuICAgIHNlbGYudG90YWxFeHAgPSBrby5wdXJlQ29tcHV0ZWQoZnVuY3Rpb24gKCkge1xuICAgICAgICByZXR1cm4gdG90YWxFeHBbc2VsZi5zZWxlY3RlZEhlcm9MZXZlbCgpIC0gMV07XG4gICAgfSk7XG4gICAgc2VsZi5uZXh0TGV2ZWxFeHAgPSBrby5wdXJlQ29tcHV0ZWQoZnVuY3Rpb24gKCkge1xuICAgICAgICByZXR1cm4gbmV4dExldmVsRXhwW3NlbGYuc2VsZWN0ZWRIZXJvTGV2ZWwoKSAtIDFdO1xuICAgIH0pO1xuICAgIHNlbGYuc3RhcnRpbmdBcm1vciA9IGtvLnB1cmVDb21wdXRlZChmdW5jdGlvbiAoKSB7XG4gICAgICAgIHJldHVybiAoc2VsZi5oZXJvRGF0YSgpLmF0dHJpYnV0ZWJhc2VhZ2lsaXR5ICogLjE0ICsgc2VsZi5oZXJvRGF0YSgpLmFybW9ycGh5c2ljYWwpLnRvRml4ZWQoMik7XG4gICAgfSk7XG4gICAgc2VsZi5yZXNwYXduVGltZSA9IGtvLnB1cmVDb21wdXRlZChmdW5jdGlvbiAoKSB7XG4gICAgICAgIHZhciBsZXZlbCA9IHNlbGYuc2VsZWN0ZWRIZXJvTGV2ZWwoKTtcbiAgICAgICAgdmFyIHJlZHVjdGlvbiA9IFRhbGVudENvbnRyb2xsZXIuZ2V0UmVzcGF3blJlZHVjdGlvbihzZWxmLnNlbGVjdGVkVGFsZW50cygpKTtcbiAgICAgICAgaWYgKGxldmVsID49IDEgJiYgbGV2ZWwgPD0gNSkge1xuICAgICAgICAgICAgcmV0dXJuIChsZXZlbCAtIDEpICogMiArIDggLSByZWR1Y3Rpb247XG4gICAgICAgIH1cbiAgICAgICAgZWxzZSBpZiAobGV2ZWwgPj0gNiAmJiBsZXZlbCA8PSAxMSkge1xuICAgICAgICAgICAgcmV0dXJuIChsZXZlbCAtIDYpICogMiArIDI2IC0gcmVkdWN0aW9uO1xuICAgICAgICB9XG4gICAgICAgIGVsc2UgaWYgKGxldmVsID49IDEyICYmIGxldmVsIDw9IDE3KSB7XG4gICAgICAgICAgICByZXR1cm4gKGxldmVsIC0gMTIpICogMiArIDQ2IC0gcmVkdWN0aW9uO1xuICAgICAgICB9XG4gICAgICAgIGVsc2UgaWYgKGxldmVsID49IDE4ICYmIGxldmVsIDw9IDI0KSB7XG4gICAgICAgICAgICByZXR1cm4gKGxldmVsIC0gMTgpICogNCArIDY2IC0gcmVkdWN0aW9uO1xuICAgICAgICB9XG4gICAgICAgIGVsc2UgaWYgKGxldmVsID09IDI1KSB7XG4gICAgICAgICAgICByZXR1cm4gMTAwIC0gcmVkdWN0aW9uO1xuICAgICAgICB9XG4gICAgfSk7XG4gICAgc2VsZi50b3RhbEF0dHJpYnV0ZSA9IGZ1bmN0aW9uIChhKSB7XG4gICAgICAgIGlmIChhID09PSAnYWdpJykgcmV0dXJuIHBhcnNlRmxvYXQoc2VsZi50b3RhbEFnaSgpKTtcbiAgICAgICAgaWYgKGEgPT09ICdpbnQnKSByZXR1cm4gcGFyc2VGbG9hdChzZWxmLnRvdGFsSW50KCkpO1xuICAgICAgICBpZiAoYSA9PT0gJ3N0cicpIHJldHVybiBwYXJzZUZsb2F0KHNlbGYudG90YWxTdHIoKSk7XG4gICAgICAgIHJldHVybiAwO1xuICAgIH07XG4gICAgc2VsZi50b3RhbEFnaSA9IGtvLnB1cmVDb21wdXRlZChmdW5jdGlvbiAoKSB7XG4gICAgICAgIHJldHVybiAoc2VsZi5oZXJvRGF0YSgpLmF0dHJpYnV0ZWJhc2VhZ2lsaXR5XG4gICAgICAgICAgICAgICAgKyBzZWxmLmhlcm9EYXRhKCkuYXR0cmlidXRlYWdpbGl0eWdhaW4gKiAoc2VsZi5zZWxlY3RlZEhlcm9MZXZlbCgpIC0gMSkgXG4gICAgICAgICAgICAgICAgKyBzZWxmLmludmVudG9yeS5nZXRBdHRyaWJ1dGVzKCdhZ2knKSBcbiAgICAgICAgICAgICAgICArIHNlbGYuYWJpbGl0eSgpLmdldEF0dHJpYnV0ZUJvbnVzTGV2ZWwoKSAqIDJcbiAgICAgICAgICAgICAgICArIHNlbGYuYWJpbGl0eSgpLmdldEFnaWxpdHkoKVxuICAgICAgICAgICAgICAgICsgVGFsZW50Q29udHJvbGxlci5nZXRBZ2lsaXR5KHNlbGYuc2VsZWN0ZWRUYWxlbnRzKCkpXG4gICAgICAgICAgICAgICAgKyBzZWxmLmVuZW15KCkuYWJpbGl0eSgpLmdldEFsbFN0YXRzUmVkdWN0aW9uKClcbiAgICAgICAgICAgICAgICArIHNlbGYuZGVidWZmcy5nZXRBbGxTdGF0c1JlZHVjdGlvbigpXG4gICAgICAgICAgICAgICApLnRvRml4ZWQoMik7XG4gICAgfSk7XG4gICAgc2VsZi5pbnRTdG9sZW4gPSBrby5vYnNlcnZhYmxlKDApLmV4dGVuZCh7IG51bWVyaWM6IDAgfSk7XG4gICAgc2VsZi50b3RhbEludCA9IGtvLnB1cmVDb21wdXRlZChmdW5jdGlvbiAoKSB7XG4gICAgICAgIHJldHVybiAoc2VsZi5oZXJvRGF0YSgpLmF0dHJpYnV0ZWJhc2VpbnRlbGxpZ2VuY2UgXG4gICAgICAgICAgICAgICAgKyBzZWxmLmhlcm9EYXRhKCkuYXR0cmlidXRlaW50ZWxsaWdlbmNlZ2FpbiAqIChzZWxmLnNlbGVjdGVkSGVyb0xldmVsKCkgLSAxKSBcbiAgICAgICAgICAgICAgICArIHNlbGYuaW52ZW50b3J5LmdldEF0dHJpYnV0ZXMoJ2ludCcpIFxuICAgICAgICAgICAgICAgICsgc2VsZi5hYmlsaXR5KCkuZ2V0QXR0cmlidXRlQm9udXNMZXZlbCgpICogMlxuICAgICAgICAgICAgICAgICsgc2VsZi5hYmlsaXR5KCkuZ2V0SW50ZWxsaWdlbmNlKClcbiAgICAgICAgICAgICAgICArIFRhbGVudENvbnRyb2xsZXIuZ2V0SW50ZWxsaWdlbmNlKHNlbGYuc2VsZWN0ZWRUYWxlbnRzKCkpXG4gICAgICAgICAgICAgICAgKyBzZWxmLmVuZW15KCkuYWJpbGl0eSgpLmdldEFsbFN0YXRzUmVkdWN0aW9uKClcbiAgICAgICAgICAgICAgICArIHNlbGYuZGVidWZmcy5nZXRBbGxTdGF0c1JlZHVjdGlvbigpICsgc2VsZi5pbnRTdG9sZW4oKVxuICAgICAgICAgICAgICAgKS50b0ZpeGVkKDIpO1xuICAgIH0pO1xuICAgIHNlbGYudG90YWxTdHIgPSBrby5wdXJlQ29tcHV0ZWQoZnVuY3Rpb24gKCkge1xuICAgICAgICByZXR1cm4gKHNlbGYuaGVyb0RhdGEoKS5hdHRyaWJ1dGViYXNlc3RyZW5ndGggXG4gICAgICAgICAgICAgICAgKyBzZWxmLmhlcm9EYXRhKCkuYXR0cmlidXRlc3RyZW5ndGhnYWluICogKHNlbGYuc2VsZWN0ZWRIZXJvTGV2ZWwoKSAtIDEpIFxuICAgICAgICAgICAgICAgICsgc2VsZi5pbnZlbnRvcnkuZ2V0QXR0cmlidXRlcygnc3RyJykgXG4gICAgICAgICAgICAgICAgKyBzZWxmLmFiaWxpdHkoKS5nZXRBdHRyaWJ1dGVCb251c0xldmVsKCkgKiAyXG4gICAgICAgICAgICAgICAgKyBzZWxmLmFiaWxpdHkoKS5nZXRTdHJlbmd0aCgpXG4gICAgICAgICAgICAgICAgKyBUYWxlbnRDb250cm9sbGVyLmdldFN0cmVuZ3RoKHNlbGYuc2VsZWN0ZWRUYWxlbnRzKCkpXG4gICAgICAgICAgICAgICAgKyBzZWxmLmVuZW15KCkuYWJpbGl0eSgpLmdldFN0cmVuZ3RoUmVkdWN0aW9uKClcbiAgICAgICAgICAgICAgICArIHNlbGYuZW5lbXkoKS5hYmlsaXR5KCkuZ2V0QWxsU3RhdHNSZWR1Y3Rpb24oKVxuICAgICAgICAgICAgICAgICsgc2VsZi5kZWJ1ZmZzLmdldEFsbFN0YXRzUmVkdWN0aW9uKClcbiAgICAgICAgICAgICAgICkudG9GaXhlZCgyKTtcbiAgICB9KTtcbiAgICBzZWxmLmhlYWx0aCA9IGtvLnB1cmVDb21wdXRlZChmdW5jdGlvbiAoKSB7XG4gICAgICAgIHJldHVybiAoc2VsZi5oZXJvRGF0YSgpLnN0YXR1c2hlYWx0aCArIE1hdGguZmxvb3Ioc2VsZi50b3RhbFN0cigpKSAqIDIwIFxuICAgICAgICAgICAgICAgICsgc2VsZi5pbnZlbnRvcnkuZ2V0SGVhbHRoKClcbiAgICAgICAgICAgICAgICArIHNlbGYuYWJpbGl0eSgpLmdldEhlYWx0aCgpXG4gICAgICAgICAgICAgICAgKyBUYWxlbnRDb250cm9sbGVyLmdldEhlYWx0aChzZWxmLnNlbGVjdGVkVGFsZW50cygpKVxuICAgICAgICAgICAgICAgICkudG9GaXhlZCgyKTtcbiAgICB9KTtcbiAgICBzZWxmLmhlYWx0aHJlZ2VuID0ga28ucHVyZUNvbXB1dGVkKGZ1bmN0aW9uICgpIHtcbiAgICAgICAgdmFyIGhlYWx0aFJlZ2VuQXVyYSA9IFtzZWxmLmludmVudG9yeS5nZXRIZWFsdGhSZWdlbkF1cmEsIHNlbGYuYnVmZnMuaXRlbUJ1ZmZzLmdldEhlYWx0aFJlZ2VuQXVyYV0ucmVkdWNlKGZ1bmN0aW9uIChtZW1vLCBmbikge1xuICAgICAgICAgICAgdmFyIG9iaiA9IGZuKG1lbW8uZXhjbHVkZUxpc3QpO1xuICAgICAgICAgICAgb2JqLnZhbHVlICs9IG1lbW8udmFsdWU7XG4gICAgICAgICAgICByZXR1cm4gb2JqO1xuICAgICAgICB9LCB7dmFsdWU6IDAsIGV4Y2x1ZGVMaXN0OiBbXX0pO1xuICAgICAgICByZXR1cm4gKHNlbGYuaGVyb0RhdGEoKS5zdGF0dXNoZWFsdGhyZWdlbiArIHNlbGYudG90YWxTdHIoKSAqIC4wMyBcbiAgICAgICAgICAgICAgICArIHNlbGYuaW52ZW50b3J5LmdldEhlYWx0aFJlZ2VuKCkgXG4gICAgICAgICAgICAgICAgKyBzZWxmLmFiaWxpdHkoKS5nZXRIZWFsdGhSZWdlbigpXG4gICAgICAgICAgICAgICAgKyBUYWxlbnRDb250cm9sbGVyLmdldEhlYWx0aFJlZ2VuKHNlbGYuc2VsZWN0ZWRUYWxlbnRzKCkpXG4gICAgICAgICAgICAgICAgKyBzZWxmLmJ1ZmZzLmdldEhlYWx0aFJlZ2VuKClcbiAgICAgICAgICAgICAgICArIGhlYWx0aFJlZ2VuQXVyYS52YWx1ZVxuICAgICAgICAgICAgICAgICkudG9GaXhlZCgyKTtcbiAgICB9KTtcbiAgICBzZWxmLm1hbmEgPSBrby5wdXJlQ29tcHV0ZWQoZnVuY3Rpb24gKCkge1xuICAgICAgICByZXR1cm4gKHNlbGYuaGVyb0RhdGEoKS5zdGF0dXNtYW5hXG4gICAgICAgICAgICAgICAgKyBzZWxmLnRvdGFsSW50KCkgKiAxMlxuICAgICAgICAgICAgICAgICsgc2VsZi5pbnZlbnRvcnkuZ2V0TWFuYSgpXG4gICAgICAgICAgICAgICAgKyBUYWxlbnRDb250cm9sbGVyLmdldE1hbmEoc2VsZi5zZWxlY3RlZFRhbGVudHMoKSlcbiAgICAgICAgICAgICAgICArIHNlbGYuYWJpbGl0eSgpLmdldE1hbmEoKSkudG9GaXhlZCgyKTtcbiAgICB9KTtcbiAgICBzZWxmLm1hbmFyZWdlbiA9IGtvLnB1cmVDb21wdXRlZChmdW5jdGlvbiAoKSB7XG4gICAgICAgIHJldHVybiAoKHNlbGYuaGVyb0RhdGEoKS5zdGF0dXNtYW5hcmVnZW4gXG4gICAgICAgICAgICAgICAgKyBzZWxmLnRvdGFsSW50KCkgKiAuMDQgXG4gICAgICAgICAgICAgICAgKyBzZWxmLmFiaWxpdHkoKS5nZXRNYW5hUmVnZW4oKVxuICAgICAgICAgICAgICAgICsgVGFsZW50Q29udHJvbGxlci5nZXRNYW5hUmVnZW4oc2VsZi5zZWxlY3RlZFRhbGVudHMoKSlcbiAgICAgICAgICAgICAgICApIFxuICAgICAgICAgICAgICAgICogKDEgKyBzZWxmLmludmVudG9yeS5nZXRNYW5hUmVnZW5QZXJjZW50KCkpIFxuICAgICAgICAgICAgICAgICsgKHNlbGYuaGVyb0lkKCkgPT09ICdjcnlzdGFsX21haWRlbicgPyBzZWxmLmFiaWxpdHkoKS5nZXRNYW5hUmVnZW5BcmNhbmVBdXJhKCkgKiAyIDogc2VsZi5idWZmcy5nZXRNYW5hUmVnZW5BcmNhbmVBdXJhKCkpXG4gICAgICAgICAgICAgICAgKyBzZWxmLmludmVudG9yeS5nZXRNYW5hUmVnZW5CbG9vZHN0b25lKClcbiAgICAgICAgICAgICAgICArIHNlbGYuaW52ZW50b3J5LmdldE1hbmFSZWdlbigpXG4gICAgICAgICAgICAgICAgLSBzZWxmLmVuZW15KCkuYWJpbGl0eSgpLmdldE1hbmFSZWdlblJlZHVjdGlvbigpKS50b0ZpeGVkKDIpO1xuICAgIH0pO1xuICAgIHNlbGYudG90YWxBcm1vclBoeXNpY2FsID0ga28ucHVyZUNvbXB1dGVkKGZ1bmN0aW9uICgpIHtcbiAgICAgICAgdmFyIGFybW9yQXVyYSA9IFtzZWxmLmludmVudG9yeS5nZXRBcm1vckF1cmEsIHNlbGYuYnVmZnMuaXRlbUJ1ZmZzLmdldEFybW9yQXVyYV0ucmVkdWNlKGZ1bmN0aW9uIChtZW1vLCBmbikge1xuICAgICAgICAgICAgdmFyIG9iaiA9IGZuKG1lbW8uYXR0cmlidXRlcyk7XG4gICAgICAgICAgICByZXR1cm4gb2JqO1xuICAgICAgICB9LCB7dmFsdWU6MCwgYXR0cmlidXRlczpbXX0pO1xuICAgICAgICB2YXIgYXJtb3JSZWR1Y3Rpb24gPSBbc2VsZi5lbmVteSgpLmludmVudG9yeS5nZXRBcm1vclJlZHVjdGlvbiwgc2VsZi5kZWJ1ZmZzLml0ZW1CdWZmcy5nZXRBcm1vclJlZHVjdGlvbl0ucmVkdWNlKGZ1bmN0aW9uIChtZW1vLCBmbikge1xuICAgICAgICAgICAgdmFyIG9iaiA9IGZuKG1lbW8uZXhjbHVkZUxpc3QpO1xuICAgICAgICAgICAgb2JqLnZhbHVlICs9IG1lbW8udmFsdWU7XG4gICAgICAgICAgICByZXR1cm4gb2JqO1xuICAgICAgICB9LCB7dmFsdWU6IDAsIGV4Y2x1ZGVMaXN0OiBbXX0pO1xuICAgICAgICByZXR1cm4gKHNlbGYuZW5lbXkoKS5hYmlsaXR5KCkuZ2V0QXJtb3JCYXNlUmVkdWN0aW9uKCkgKiBzZWxmLmRlYnVmZnMuZ2V0QXJtb3JCYXNlUmVkdWN0aW9uKCkgKiAoc2VsZi5oZXJvRGF0YSgpLmFybW9ycGh5c2ljYWwgKyBzZWxmLnRvdGFsQWdpKCkgKiAuMTQpXG4gICAgICAgICAgICAgICAgKyBzZWxmLmludmVudG9yeS5nZXRBcm1vcigpXG4gICAgICAgICAgICAgICAgLy8rIHNlbGYuaW52ZW50b3J5LmdldEFybW9yQXVyYSgpLnZhbHVlXG4gICAgICAgICAgICAgICAgLy8rIHNlbGYuZW5lbXkoKS5pbnZlbnRvcnkuZ2V0QXJtb3JSZWR1Y3Rpb24oKVxuICAgICAgICAgICAgICAgICsgc2VsZi5hYmlsaXR5KCkuZ2V0QXJtb3IoKVxuICAgICAgICAgICAgICAgICsgVGFsZW50Q29udHJvbGxlci5nZXRBcm1vcihzZWxmLnNlbGVjdGVkVGFsZW50cygpKVxuICAgICAgICAgICAgICAgICsgc2VsZi5lbmVteSgpLmFiaWxpdHkoKS5nZXRBcm1vclJlZHVjdGlvbigpXG4gICAgICAgICAgICAgICAgKyBzZWxmLmJ1ZmZzLmdldEFybW9yKClcbiAgICAgICAgICAgICAgICArIHNlbGYuYnVmZnMuaXRlbUJ1ZmZzLmdldEFybW9yKClcbiAgICAgICAgICAgICAgICArIHNlbGYuZGVidWZmcy5nZXRBcm1vclJlZHVjdGlvbigpXG4gICAgICAgICAgICAgICAgLy8rIHNlbGYuYnVmZnMuaXRlbUJ1ZmZzLmdldEFybW9yQXVyYSgpLnZhbHVlXG4gICAgICAgICAgICAgICAgKyBhcm1vckF1cmEudmFsdWVcbiAgICAgICAgICAgICAgICArIGFybW9yUmVkdWN0aW9uLnZhbHVlXG4gICAgICAgICAgICAgICAgLy8rIHNlbGYuZGVidWZmcy5nZXRBcm1vclJlZHVjdGlvbigpXG4gICAgICAgICAgICAgICAgKS50b0ZpeGVkKDIpO1xuICAgIH0pO1xuICAgIHNlbGYudG90YWxBcm1vclBoeXNpY2FsUmVkdWN0aW9uID0ga28ucHVyZUNvbXB1dGVkKGZ1bmN0aW9uICgpIHtcbiAgICAgICAgdmFyIHRvdGFsQXJtb3IgPSBzZWxmLnRvdGFsQXJtb3JQaHlzaWNhbCgpO1xuICAgICAgICBpZiAodG90YWxBcm1vciA+PSAwKSB7XG4gICAgICAgICAgICByZXR1cm4gKCgwLjA2ICogc2VsZi50b3RhbEFybW9yUGh5c2ljYWwoKSkgLyAoMSArIDAuMDYgKiBzZWxmLnRvdGFsQXJtb3JQaHlzaWNhbCgpKSAqIDEwMCkudG9GaXhlZCgyKTtcbiAgICAgICAgfVxuICAgICAgICBlbHNlIHtcbiAgICAgICAgICAgIHJldHVybiAtKCgwLjA2ICogLXNlbGYudG90YWxBcm1vclBoeXNpY2FsKCkpIC8gKDEgKyAwLjA2ICogLXNlbGYudG90YWxBcm1vclBoeXNpY2FsKCkpICogMTAwKS50b0ZpeGVkKDIpO1xuICAgICAgICB9XG4gICAgfSk7XG4gICAgc2VsZi50b3RhbE1vdmVtZW50U3BlZWQgPSBrby5wdXJlQ29tcHV0ZWQoZnVuY3Rpb24gKCkge1xuICAgICAgICB2YXIgTUlOX01PVkVTUEVFRCA9IDEwMDtcbiAgICAgICAgdmFyIG1zID0gKHNlbGYuYWJpbGl0eSgpLnNldE1vdmVtZW50U3BlZWQoKSA+IDAgPyBzZWxmLmFiaWxpdHkoKS5zZXRNb3ZlbWVudFNwZWVkKCkgOiBzZWxmLmJ1ZmZzLnNldE1vdmVtZW50U3BlZWQoKSk7XG4gICAgICAgIGlmIChtcyA+IDApIHtcbiAgICAgICAgICAgIHJldHVybiBtcztcbiAgICAgICAgfVxuICAgICAgICBlbHNlIHtcbiAgICAgICAgICAgIHZhciBtb3ZlbWVudFNwZWVkUGVyY2VudCA9IFtzZWxmLmludmVudG9yeS5nZXRNb3ZlbWVudFNwZWVkUGVyY2VudCwgc2VsZi5idWZmcy5pdGVtQnVmZnMuZ2V0TW92ZW1lbnRTcGVlZFBlcmNlbnRdLnJlZHVjZShmdW5jdGlvbiAobWVtbywgZm4pIHtcbiAgICAgICAgICAgICAgICB2YXIgb2JqID0gZm4obWVtby5leGNsdWRlTGlzdCk7XG4gICAgICAgICAgICAgICAgb2JqLnZhbHVlICs9IG1lbW8udmFsdWU7XG4gICAgICAgICAgICAgICAgcmV0dXJuIG9iajtcbiAgICAgICAgICAgIH0sIHt2YWx1ZTowLCBleGNsdWRlTGlzdDpbXX0pO1xuICAgICAgICAgICAgdmFyIG1vdmVtZW50U3BlZWRQZXJjZW50UmVkdWN0aW9uID0gW3NlbGYuZW5lbXkoKS5pbnZlbnRvcnkuZ2V0TW92ZW1lbnRTcGVlZFBlcmNlbnRSZWR1Y3Rpb24sIHNlbGYuZGVidWZmcy5pdGVtQnVmZnMuZ2V0TW92ZW1lbnRTcGVlZFBlcmNlbnRSZWR1Y3Rpb25dLnJlZHVjZShmdW5jdGlvbiAobWVtbywgZm4pIHtcbiAgICAgICAgICAgICAgICB2YXIgb2JqID0gZm4obWVtby5leGNsdWRlTGlzdCk7XG4gICAgICAgICAgICAgICAgb2JqLnZhbHVlICs9IG1lbW8udmFsdWU7XG4gICAgICAgICAgICAgICAgcmV0dXJuIG9iajtcbiAgICAgICAgICAgIH0sIHt2YWx1ZTowLCBleGNsdWRlTGlzdDpbXX0pO1xuICAgICAgICAgICAgcmV0dXJuIE1hdGgubWF4KFxuICAgICAgICAgICAgICAgIHNlbGYuZW5lbXkoKS5pbnZlbnRvcnkuaXNTaGVlcGVkKCkgfHwgc2VsZi5kZWJ1ZmZzLml0ZW1CdWZmcy5pc1NoZWVwZWQoKSA/IDE0MCA6XG4gICAgICAgICAgICAgICAgKHNlbGYuaGVyb0RhdGEoKS5tb3ZlbWVudHNwZWVkICsgc2VsZi5pbnZlbnRvcnkuZ2V0TW92ZW1lbnRTcGVlZEZsYXQoKSArIHNlbGYuYWJpbGl0eSgpLmdldE1vdmVtZW50U3BlZWRGbGF0KCkgKyBUYWxlbnRDb250cm9sbGVyLmdldE1vdmVtZW50U3BlZWRGbGF0KHNlbGYuc2VsZWN0ZWRUYWxlbnRzKCkpKSAqIFxuICAgICAgICAgICAgICAgICgxIC8vKyBzZWxmLmludmVudG9yeS5nZXRNb3ZlbWVudFNwZWVkUGVyY2VudCgpIFxuICAgICAgICAgICAgICAgICAgICsgbW92ZW1lbnRTcGVlZFBlcmNlbnQudmFsdWVcbiAgICAgICAgICAgICAgICAgICArIG1vdmVtZW50U3BlZWRQZXJjZW50UmVkdWN0aW9uLnZhbHVlXG4gICAgICAgICAgICAgICAgICAgKyBzZWxmLmFiaWxpdHkoKS5nZXRNb3ZlbWVudFNwZWVkUGVyY2VudCgpIFxuICAgICAgICAgICAgICAgICAgIC8vKyBzZWxmLmVuZW15KCkuaW52ZW50b3J5LmdldE1vdmVtZW50U3BlZWRQZXJjZW50UmVkdWN0aW9uKCkgXG4gICAgICAgICAgICAgICAgICAgKyBzZWxmLmVuZW15KCkuYWJpbGl0eSgpLmdldE1vdmVtZW50U3BlZWRQZXJjZW50UmVkdWN0aW9uKCkgXG4gICAgICAgICAgICAgICAgICAgKyBzZWxmLmJ1ZmZzLmdldE1vdmVtZW50U3BlZWRQZXJjZW50KCkgXG4gICAgICAgICAgICAgICAgICAgKyBzZWxmLmRlYnVmZnMuZ2V0TW92ZW1lbnRTcGVlZFBlcmNlbnRSZWR1Y3Rpb24oKVxuICAgICAgICAgICAgICAgICAgICsgc2VsZi51bml0KCkuYWJpbGl0eSgpLmdldE1vdmVtZW50U3BlZWRQZXJjZW50KCkgXG4gICAgICAgICAgICAgICAgKVxuICAgICAgICAgICAgLCBNSU5fTU9WRVNQRUVEKS50b0ZpeGVkKDIpO1xuICAgICAgICB9XG4gICAgfSk7XG4gICAgc2VsZi50b3RhbFR1cm5SYXRlID0ga28ucHVyZUNvbXB1dGVkKGZ1bmN0aW9uICgpIHtcbiAgICAgICAgcmV0dXJuIChzZWxmLmhlcm9EYXRhKCkubW92ZW1lbnR0dXJucmF0ZSBcbiAgICAgICAgICAgICAgICAqICgxICsgc2VsZi5lbmVteSgpLmFiaWxpdHkoKS5nZXRUdXJuUmF0ZVJlZHVjdGlvbigpXG4gICAgICAgICAgICAgICAgICAgICArIHNlbGYuZGVidWZmcy5nZXRUdXJuUmF0ZVJlZHVjdGlvbigpKSkudG9GaXhlZCgyKTtcbiAgICB9KTtcbiAgICBzZWxmLmJhc2VEYW1hZ2UgPSBrby5wdXJlQ29tcHV0ZWQoZnVuY3Rpb24gKCkge1xuICAgICAgICB2YXIgdG90YWxBdHRyaWJ1dGUgPSBzZWxmLnRvdGFsQXR0cmlidXRlKHNlbGYucHJpbWFyeUF0dHJpYnV0ZSgpKSxcbiAgICAgICAgICAgIGFiaWxpdHlCYXNlRGFtYWdlID0gc2VsZi5hYmlsaXR5KCkuZ2V0QmFzZURhbWFnZSgpLFxuICAgICAgICAgICAgbWluRGFtYWdlID0gc2VsZi5oZXJvRGF0YSgpLmF0dGFja2RhbWFnZW1pbixcbiAgICAgICAgICAgIG1heERhbWFnZSA9IHNlbGYuaGVyb0RhdGEoKS5hdHRhY2tkYW1hZ2VtYXg7XG4gICAgICAgIHJldHVybiBbTWF0aC5mbG9vcigobWluRGFtYWdlICsgdG90YWxBdHRyaWJ1dGUgKyBhYmlsaXR5QmFzZURhbWFnZS50b3RhbCkgKiBzZWxmLmFiaWxpdHkoKS5nZXRTZWxmQmFzZURhbWFnZVJlZHVjdGlvblBjdCgpICogc2VsZi5lbmVteSgpLmFiaWxpdHkoKS5nZXRCYXNlRGFtYWdlUmVkdWN0aW9uUGN0KCkgKiBzZWxmLmRlYnVmZnMuZ2V0QmFzZURhbWFnZVJlZHVjdGlvblBjdCgpICogc2VsZi5kZWJ1ZmZzLml0ZW1CdWZmcy5nZXRCYXNlRGFtYWdlUmVkdWN0aW9uUGN0KCkgKiBhYmlsaXR5QmFzZURhbWFnZS5tdWx0aXBsaWVyKSxcbiAgICAgICAgICAgICAgICBNYXRoLmZsb29yKChtYXhEYW1hZ2UgKyB0b3RhbEF0dHJpYnV0ZSArIGFiaWxpdHlCYXNlRGFtYWdlLnRvdGFsKSAqIHNlbGYuYWJpbGl0eSgpLmdldFNlbGZCYXNlRGFtYWdlUmVkdWN0aW9uUGN0KCkgKiBzZWxmLmVuZW15KCkuYWJpbGl0eSgpLmdldEJhc2VEYW1hZ2VSZWR1Y3Rpb25QY3QoKSAqIHNlbGYuZGVidWZmcy5nZXRCYXNlRGFtYWdlUmVkdWN0aW9uUGN0KCkgKiBzZWxmLmRlYnVmZnMuaXRlbUJ1ZmZzLmdldEJhc2VEYW1hZ2VSZWR1Y3Rpb25QY3QoKSAqIGFiaWxpdHlCYXNlRGFtYWdlLm11bHRpcGxpZXIpXTtcbiAgICB9KTtcbiAgICBzZWxmLmJhc2VEYW1hZ2VBdmcgPSBrby5wdXJlQ29tcHV0ZWQoZnVuY3Rpb24gKCkge1xuICAgICAgICByZXR1cm4gKHNlbGYuYmFzZURhbWFnZSgpWzBdICsgc2VsZi5iYXNlRGFtYWdlKClbMV0pIC8gMjtcbiAgICB9KTtcbiAgICBzZWxmLmJhc2VEYW1hZ2VNaW4gPSBrby5wdXJlQ29tcHV0ZWQoZnVuY3Rpb24gKCkge1xuICAgICAgICByZXR1cm4gc2VsZi5iYXNlRGFtYWdlKClbMF07XG4gICAgfSk7XG4gICAgc2VsZi5iYXNlRGFtYWdlTWF4ID0ga28ucHVyZUNvbXB1dGVkKGZ1bmN0aW9uICgpIHtcbiAgICAgICAgcmV0dXJuIHNlbGYuYmFzZURhbWFnZSgpWzFdO1xuICAgIH0pO1xuICAgIHNlbGYuYm9udXNEYW1hZ2UgPSBrby5wdXJlQ29tcHV0ZWQoZnVuY3Rpb24gKCkge1xuICAgICAgICByZXR1cm4gKChzZWxmLmludmVudG9yeS5nZXRCb251c0RhbWFnZSgpLnRvdGFsXG4gICAgICAgICAgICAgICAgKyBzZWxmLmFiaWxpdHkoKS5nZXRCb251c0RhbWFnZSgpLnRvdGFsXG4gICAgICAgICAgICAgICAgKyBUYWxlbnRDb250cm9sbGVyLmdldEJvbnVzRGFtYWdlKHNlbGYuc2VsZWN0ZWRUYWxlbnRzKCkpLnRvdGFsXG4gICAgICAgICAgICAgICAgKyBzZWxmLmJ1ZmZzLmdldEJvbnVzRGFtYWdlKCkudG90YWxcbiAgICAgICAgICAgICAgICArIE1hdGguZmxvb3IoKHNlbGYuYmFzZURhbWFnZSgpWzBdICsgc2VsZi5iYXNlRGFtYWdlKClbMV0pIC8gMiBcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICogKHNlbGYuYnVmZnMuaXRlbUJ1ZmZzLmdldEJvbnVzRGFtYWdlUGVyY2VudChzZWxmLmludmVudG9yeS5nZXRCb251c0RhbWFnZVBlcmNlbnQoKSkudG90YWxcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICsgc2VsZi5hYmlsaXR5KCkuZ2V0Qm9udXNEYW1hZ2VQZXJjZW50KCkudG90YWxcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICsgc2VsZi5idWZmcy5nZXRCb251c0RhbWFnZVBlcmNlbnQoKS50b3RhbFxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICApXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgKVxuICAgICAgICAgICAgICAgICsgTWF0aC5mbG9vcihcbiAgICAgICAgICAgICAgICAgICAgKHNlbGYuaGVyb0RhdGEoKS5hdHRhY2t0eXBlID09ICdET1RBX1VOSVRfQ0FQX1JBTkdFRF9BVFRBQ0snIFxuICAgICAgICAgICAgICAgICAgICAgICAgPyAoKHNlbGYuaGVyb0lkKCkgPT0gJ2Ryb3dfcmFuZ2VyJykgPyBzZWxmLmFiaWxpdHkoKS5nZXRCb251c0RhbWFnZVByZWNpc2lvbkF1cmEoKS50b3RhbFswXSAqIHNlbGYudG90YWxBZ2koKSA6IHNlbGYuYnVmZnMuZ2V0Qm9udXNEYW1hZ2VQcmVjaXNpb25BdXJhKCkudG90YWxbMV0pXG4gICAgICAgICAgICAgICAgICAgICAgICA6IDApXG4gICAgICAgICAgICAgICAgICApXG4gICAgICAgICAgICAgICAgKyBNYXRoLmZsb29yKFxuICAgICAgICAgICAgICAgICAgICAoKHNlbGYuaGVyb0lkKCkgPT0gJ3Jpa2knKSA/IHNlbGYuYWJpbGl0eSgpLmdldEJvbnVzRGFtYWdlQmFja3N0YWIoKS50b3RhbFswXSAqIHNlbGYudG90YWxBZ2koKSA6IDApXG4gICAgICAgICAgICAgICAgICApXG4gICAgICAgICAgICAgICAgKSAqIHNlbGYuYWJpbGl0eSgpLmdldFNlbGZCYXNlRGFtYWdlUmVkdWN0aW9uUGN0KClcbiAgICAgICAgICAgICAgICAgICogc2VsZi5lbmVteSgpLmFiaWxpdHkoKS5nZXRCYXNlRGFtYWdlUmVkdWN0aW9uUGN0KClcbiAgICAgICAgICAgICAgICAgICogc2VsZi5kZWJ1ZmZzLml0ZW1CdWZmcy5nZXRCYXNlRGFtYWdlUmVkdWN0aW9uUGN0KCkpO1xuICAgIH0pO1xuICAgIHNlbGYuYm9udXNEYW1hZ2VSZWR1Y3Rpb24gPSBrby5wdXJlQ29tcHV0ZWQoZnVuY3Rpb24gKCkge1xuICAgICAgICByZXR1cm4gTWF0aC5hYnMoc2VsZi5lbmVteSgpLmFiaWxpdHkoKS5nZXRCb251c0RhbWFnZVJlZHVjdGlvbigpICsgc2VsZi5kZWJ1ZmZzLmdldEJvbnVzRGFtYWdlUmVkdWN0aW9uKCkpO1xuICAgIH0pO1xuICAgIHNlbGYuZGFtYWdlQXZnID0ga28ucHVyZUNvbXB1dGVkKGZ1bmN0aW9uICgpIHtcbiAgICAgICAgcmV0dXJuIChzZWxmLmJhc2VEYW1hZ2UoKVswXSArIHNlbGYuYmFzZURhbWFnZSgpWzFdKSAvIDIgKyBzZWxmLmJvbnVzRGFtYWdlKCk7XG4gICAgfSk7XG4gICAgc2VsZi5kYW1hZ2VNaW4gPSBrby5wdXJlQ29tcHV0ZWQoZnVuY3Rpb24gKCkge1xuICAgICAgICByZXR1cm4gc2VsZi5iYXNlRGFtYWdlKClbMF0gKyBzZWxmLmJvbnVzRGFtYWdlKCk7XG4gICAgfSk7XG4gICAgc2VsZi5kYW1hZ2VNYXggPSBrby5wdXJlQ29tcHV0ZWQoZnVuY3Rpb24gKCkge1xuICAgICAgICByZXR1cm4gc2VsZi5iYXNlRGFtYWdlKClbMV0gKyBzZWxmLmJvbnVzRGFtYWdlKCk7XG4gICAgfSk7XG4gICAgc2VsZi5kYW1hZ2UgPSBrby5wdXJlQ29tcHV0ZWQoZnVuY3Rpb24gKCkge1xuICAgICAgICByZXR1cm4gW3NlbGYuYmFzZURhbWFnZSgpWzBdICsgc2VsZi5ib251c0RhbWFnZSgpLFxuICAgICAgICAgICAgICAgIHNlbGYuYmFzZURhbWFnZSgpWzFdICsgc2VsZi5ib251c0RhbWFnZSgpXTtcbiAgICB9KTtcbiAgICBzZWxmLnRvdGFsTWFnaWNSZXNpc3RhbmNlUHJvZHVjdCA9IGtvLnB1cmVDb21wdXRlZChmdW5jdGlvbiAoKSB7XG4gICAgICAgIHJldHVybiAoMSAtIHNlbGYuaGVyb0RhdGEoKS5tYWdpY2FscmVzaXN0YW5jZSAvIDEwMCkgXG4gICAgICAgICAgICAgICAgKiBzZWxmLmludmVudG9yeS5nZXRNYWdpY1Jlc2lzdCgpXG4gICAgICAgICAgICAgICAgKiBzZWxmLmFiaWxpdHkoKS5nZXRNYWdpY1Jlc2lzdCgpXG4gICAgICAgICAgICAgICAgKiBUYWxlbnRDb250cm9sbGVyLmdldE1hZ2ljUmVzaXN0KHNlbGYuc2VsZWN0ZWRUYWxlbnRzKCkpXG4gICAgICAgICAgICAgICAgKiBzZWxmLmJ1ZmZzLmdldE1hZ2ljUmVzaXN0KClcbiAgICAgICAgICAgICAgICAqIHNlbGYuaW52ZW50b3J5LmdldE1hZ2ljUmVzaXN0UmVkdWN0aW9uU2VsZigpXG4gICAgICAgICAgICAgICAgKiBzZWxmLmVuZW15KCkuaW52ZW50b3J5LmdldE1hZ2ljUmVzaXN0UmVkdWN0aW9uKClcbiAgICAgICAgICAgICAgICAqIHNlbGYuZW5lbXkoKS5hYmlsaXR5KCkuZ2V0TWFnaWNSZXNpc3RSZWR1Y3Rpb24oKVxuICAgICAgICAgICAgICAgICogc2VsZi5kZWJ1ZmZzLmdldE1hZ2ljUmVzaXN0UmVkdWN0aW9uKClcbiAgICAgICAgICAgICAgICAqIHNlbGYuZGVidWZmcy5pdGVtQnVmZnMuZ2V0TWFnaWNSZXNpc3RSZWR1Y3Rpb24oKTtcbiAgICB9KTtcbiAgICBzZWxmLnRvdGFsTWFnaWNSZXNpc3RhbmNlID0ga28ucHVyZUNvbXB1dGVkKGZ1bmN0aW9uICgpIHtcbiAgICAgICAgcmV0dXJuICgoMSAtIHNlbGYudG90YWxNYWdpY1Jlc2lzdGFuY2VQcm9kdWN0KCkpICogMTAwKS50b0ZpeGVkKDIpO1xuICAgIH0pO1xuICAgIHNlbGYuYmF0ID0ga28ucHVyZUNvbXB1dGVkKGZ1bmN0aW9uICgpIHtcbiAgICAgICAgdmFyIGFiaWxpdHlCQVQgPSBzZWxmLmFiaWxpdHkoKS5nZXRCQVQoKTtcbiAgICAgICAgaWYgKGFiaWxpdHlCQVQgPiAwKSB7XG4gICAgICAgICAgICByZXR1cm4gYWJpbGl0eUJBVDtcbiAgICAgICAgfVxuICAgICAgICByZXR1cm4gc2VsZi5oZXJvRGF0YSgpLmF0dGFja3JhdGU7XG4gICAgfSk7XG4gICAgc2VsZi5pYXMgPSBrby5wdXJlQ29tcHV0ZWQoZnVuY3Rpb24gKCkge1xuICAgICAgICB2YXIgYXR0YWNrU3BlZWQgPSBbc2VsZi5pbnZlbnRvcnkuZ2V0QXR0YWNrU3BlZWQsIHNlbGYuYnVmZnMuaXRlbUJ1ZmZzLmdldEF0dGFja1NwZWVkXS5yZWR1Y2UoZnVuY3Rpb24gKG1lbW8sIGZuKSB7XG4gICAgICAgICAgICB2YXIgb2JqID0gZm4obWVtby5leGNsdWRlTGlzdCk7XG4gICAgICAgICAgICBvYmoudmFsdWUgKz0gbWVtby52YWx1ZTtcbiAgICAgICAgICAgIHJldHVybiBvYmo7XG4gICAgICAgIH0sIHt2YWx1ZTowLCBleGNsdWRlTGlzdDpbXX0pO1xuICAgICAgICB2YXIgYXR0YWNrU3BlZWRSZWR1Y3Rpb24gPSBbc2VsZi5lbmVteSgpLmludmVudG9yeS5nZXRBdHRhY2tTcGVlZFJlZHVjdGlvbiwgc2VsZi5kZWJ1ZmZzLml0ZW1CdWZmcy5nZXRBdHRhY2tTcGVlZFJlZHVjdGlvbl0ucmVkdWNlKGZ1bmN0aW9uIChtZW1vLCBmbikge1xuICAgICAgICAgICAgdmFyIG9iaiA9IGZuKG1lbW8uZXhjbHVkZUxpc3QpO1xuICAgICAgICAgICAgb2JqLnZhbHVlICs9IG1lbW8udmFsdWU7XG4gICAgICAgICAgICByZXR1cm4gb2JqO1xuICAgICAgICB9LCB7dmFsdWU6MCwgZXhjbHVkZUxpc3Q6IFtdfSk7XG4gICAgICAgIHZhciB2YWwgPSBwYXJzZUZsb2F0KHNlbGYudG90YWxBZ2koKSkgXG4gICAgICAgICAgICAgICAgLy8rIHNlbGYuaW52ZW50b3J5LmdldEF0dGFja1NwZWVkKCkgXG4gICAgICAgICAgICAgICAgKyBhdHRhY2tTcGVlZC52YWx1ZVxuICAgICAgICAgICAgICAgICsgYXR0YWNrU3BlZWRSZWR1Y3Rpb24udmFsdWVcbiAgICAgICAgICAgICAgICAvLysgc2VsZi5lbmVteSgpLmludmVudG9yeS5nZXRBdHRhY2tTcGVlZFJlZHVjdGlvbigpIFxuICAgICAgICAgICAgICAgICsgc2VsZi5hYmlsaXR5KCkuZ2V0QXR0YWNrU3BlZWQoKSBcbiAgICAgICAgICAgICAgICArIFRhbGVudENvbnRyb2xsZXIuZ2V0QXR0YWNrU3BlZWQoc2VsZi5zZWxlY3RlZFRhbGVudHMoKSkgXG4gICAgICAgICAgICAgICAgKyBzZWxmLmVuZW15KCkuYWJpbGl0eSgpLmdldEF0dGFja1NwZWVkUmVkdWN0aW9uKCkgXG4gICAgICAgICAgICAgICAgKyBzZWxmLmJ1ZmZzLmdldEF0dGFja1NwZWVkKCkgXG4gICAgICAgICAgICAgICAgKyBzZWxmLmRlYnVmZnMuZ2V0QXR0YWNrU3BlZWRSZWR1Y3Rpb24oKVxuICAgICAgICAgICAgICAgICsgc2VsZi51bml0KCkuYWJpbGl0eSgpLmdldEF0dGFja1NwZWVkKCk7IFxuICAgICAgICBpZiAodmFsIDwgLTgwKSB7XG4gICAgICAgICAgICByZXR1cm4gLTgwO1xuICAgICAgICB9XG4gICAgICAgIGVsc2UgaWYgKHZhbCA+IDUwMCkge1xuICAgICAgICAgICAgcmV0dXJuIDUwMDtcbiAgICAgICAgfVxuICAgICAgICByZXR1cm4gdmFsLnRvRml4ZWQoMik7XG4gICAgfSk7XG4gICAgc2VsZi5hdHRhY2tUaW1lID0ga28ucHVyZUNvbXB1dGVkKGZ1bmN0aW9uICgpIHtcbiAgICAgICAgcmV0dXJuIChzZWxmLmJhdCgpIC8gKDEgKyBzZWxmLmlhcygpIC8gMTAwKSkudG9GaXhlZCgyKTtcbiAgICB9KTtcbiAgICBzZWxmLmF0dGFja3NQZXJTZWNvbmQgPSBrby5wdXJlQ29tcHV0ZWQoZnVuY3Rpb24gKCkge1xuICAgICAgICByZXR1cm4gKCgxICsgc2VsZi5pYXMoKSAvIDEwMCkgLyBzZWxmLmJhdCgpKS50b0ZpeGVkKDIpO1xuICAgIH0pO1xuICAgIHNlbGYuZXZhc2lvbiA9IGtvLnB1cmVDb21wdXRlZChmdW5jdGlvbiAoKSB7XG4gICAgICAgIGlmIChzZWxmLmVuZW15KCkuaW52ZW50b3J5LmlzU2hlZXBlZCgpIHx8IHNlbGYuZGVidWZmcy5pdGVtQnVmZnMuaXNTaGVlcGVkKCkpIHJldHVybiAwO1xuICAgICAgICB2YXIgZSA9IHNlbGYuYWJpbGl0eSgpLnNldEV2YXNpb24oKTtcbiAgICAgICAgaWYgKGUpIHtcbiAgICAgICAgICAgIHJldHVybiAoZSAqIDEwMCkudG9GaXhlZCgyKTtcbiAgICAgICAgfVxuICAgICAgICBlbHNlIHtcbiAgICAgICAgICAgIHJldHVybiAoXG4gICAgICAgICAgICAgICAgKFxuICAgICAgICAgICAgICAgICAgICAxIC0gKFxuICAgICAgICAgICAgICAgICAgICAgICAgc2VsZi5pbnZlbnRvcnkuZ2V0RXZhc2lvbigpXG4gICAgICAgICAgICAgICAgICAgICAgICAqIHNlbGYuYWJpbGl0eSgpLmdldEV2YXNpb24oKVxuICAgICAgICAgICAgICAgICAgICAgICAgKiBzZWxmLmFiaWxpdHkoKS5nZXRFdmFzaW9uQmFja3RyYWNrKClcbiAgICAgICAgICAgICAgICAgICAgICAgICogVGFsZW50Q29udHJvbGxlci5nZXRFdmFzaW9uKHNlbGYuc2VsZWN0ZWRUYWxlbnRzKCkpXG4gICAgICAgICAgICAgICAgICAgICAgICAqIHNlbGYuYnVmZnMuaXRlbUJ1ZmZzLmdldEV2YXNpb24oKVxuICAgICAgICAgICAgICAgICAgICApXG4gICAgICAgICAgICAgICAgKSAqIDEwMFxuICAgICAgICAgICAgKS50b0ZpeGVkKDIpO1xuICAgICAgICB9XG4gICAgfSk7XG4gICAgc2VsZi5laHBQaHlzaWNhbCA9IGtvLnB1cmVDb21wdXRlZChmdW5jdGlvbiAoKSB7XG4gICAgICAgIHZhciBldmFzaW9uID0gc2VsZi5lbmVteSgpLmludmVudG9yeS5pc1NoZWVwZWQoKSB8fCBzZWxmLmRlYnVmZnMuaXRlbUJ1ZmZzLmlzU2hlZXBlZCgpID8gMSA6IHNlbGYuaW52ZW50b3J5LmdldEV2YXNpb24oKSAqIHNlbGYuYWJpbGl0eSgpLmdldEV2YXNpb24oKSAqIHNlbGYuYnVmZnMuaXRlbUJ1ZmZzLmdldEV2YXNpb24oKTtcbiAgICAgICAgaWYgKHNlbGYudG90YWxBcm1vclBoeXNpY2FsKCkgPj0gMCkge1xuICAgICAgICAgICAgdmFyIGVocCA9IHNlbGYuaGVhbHRoKCkgKiAoMSArIC4wNiAqIHNlbGYudG90YWxBcm1vclBoeXNpY2FsKCkpO1xuICAgICAgICB9XG4gICAgICAgIGVsc2Uge1xuICAgICAgICAgICAgdmFyIGVocCA9IHNlbGYuaGVhbHRoKCkgKiAoMSAtIC4wNiAqIHNlbGYudG90YWxBcm1vclBoeXNpY2FsKCkpIC8gKDEgLSAuMTIgKiBzZWxmLnRvdGFsQXJtb3JQaHlzaWNhbCgpKTtcbiAgICAgICAgfVxuICAgICAgICBlaHAgLz0gKDEgLSAoMSAtIChldmFzaW9uICogc2VsZi5hYmlsaXR5KCkuZ2V0RXZhc2lvbkJhY2t0cmFjaygpKSkpO1xuICAgICAgICBlaHAgLz0gKDEgLSBwYXJzZUZsb2F0KHNlbGYuZW5lbXkoKS5taXNzQ2hhbmNlKCkpIC8gMTAwKTtcbiAgICAgICAgZWhwICo9IChzZWxmLmludmVudG9yeS5hY3RpdmVJdGVtcygpLnNvbWUoZnVuY3Rpb24gKGl0ZW0pIHtyZXR1cm4gaXRlbS5pdGVtID09ICdtYXNrX29mX21hZG5lc3MnO30pID8gKDEgLyAxLjMpIDogMSk7XG4gICAgICAgIGVocCAqPSAoMSAvIHNlbGYuYWJpbGl0eSgpLmdldERhbWFnZVJlZHVjdGlvbigpKTtcbiAgICAgICAgZWhwICo9ICgxIC8gc2VsZi5idWZmcy5nZXREYW1hZ2VSZWR1Y3Rpb24oKSk7XG4gICAgICAgIGVocCAqPSAoMSAvIHNlbGYuZW5lbXkoKS5hYmlsaXR5KCkuZ2V0RGFtYWdlQW1wbGlmaWNhdGlvbigpKTtcbiAgICAgICAgZWhwICo9ICgxIC8gc2VsZi5kZWJ1ZmZzLmdldERhbWFnZUFtcGxpZmljYXRpb24oKSk7XG4gICAgICAgIHJldHVybiBlaHAudG9GaXhlZCgyKTtcbiAgICB9KTtcbiAgICBzZWxmLmVocE1hZ2ljYWwgPSBrby5wdXJlQ29tcHV0ZWQoZnVuY3Rpb24gKCkge1xuICAgICAgICB2YXIgZWhwID0gc2VsZi5oZWFsdGgoKSAvIHNlbGYudG90YWxNYWdpY1Jlc2lzdGFuY2VQcm9kdWN0KCk7XG4gICAgICAgIGVocCAqPSAoc2VsZi5pbnZlbnRvcnkuYWN0aXZlSXRlbXMoKS5zb21lKGZ1bmN0aW9uIChpdGVtKSB7cmV0dXJuIGl0ZW0uaXRlbSA9PSAnbWFza19vZl9tYWRuZXNzJzt9KSA/ICgxIC8gMS4zKSA6IDEpO1xuICAgICAgICBlaHAgKj0gKDEgLyBzZWxmLmFiaWxpdHkoKS5nZXREYW1hZ2VSZWR1Y3Rpb24oKSk7XG4gICAgICAgIGVocCAqPSAoMSAvIHNlbGYuYnVmZnMuZ2V0RGFtYWdlUmVkdWN0aW9uKCkpO1xuICAgICAgICBlaHAgKj0gKDEgLyBzZWxmLmFiaWxpdHkoKS5nZXRFdmFzaW9uQmFja3RyYWNrKCkpO1xuICAgICAgICBlaHAgKj0gKDEgLyBzZWxmLmVuZW15KCkuYWJpbGl0eSgpLmdldERhbWFnZUFtcGxpZmljYXRpb24oKSk7XG4gICAgICAgIGVocCAqPSAoMSAvIHNlbGYuZGVidWZmcy5nZXREYW1hZ2VBbXBsaWZpY2F0aW9uKCkpO1xuICAgICAgICByZXR1cm4gZWhwLnRvRml4ZWQoMik7XG4gICAgfSk7XG4gICAgc2VsZi5iYXNoID0ga28ucHVyZUNvbXB1dGVkKGZ1bmN0aW9uICgpIHtcbiAgICAgICAgdmFyIGF0dGFja3R5cGUgPSBzZWxmLmhlcm9EYXRhKCkuYXR0YWNrdHlwZTtcbiAgICAgICAgcmV0dXJuICgoMSAtIChzZWxmLmludmVudG9yeS5nZXRCYXNoKGF0dGFja3R5cGUpICogc2VsZi5hYmlsaXR5KCkuZ2V0QmFzaCgpKSkgKiAxMDApLnRvRml4ZWQoMik7XG4gICAgfSk7XG4gICAgXG4gICAgc2VsZi5jcml0Q2hhbmNlID0ga28ucHVyZUNvbXB1dGVkKGZ1bmN0aW9uICgpIHtcbiAgICAgICAgcmV0dXJuICgoMSAtIChzZWxmLmludmVudG9yeS5nZXRDcml0Q2hhbmNlKCkgKiBzZWxmLmFiaWxpdHkoKS5nZXRDcml0Q2hhbmNlKCkpKSAqIDEwMCkudG9GaXhlZCgyKTtcbiAgICB9KTtcblxuICAgIEhlcm9EYW1hZ2VNaXhpbihzZWxmLCBpdGVtRGF0YSk7XG4gICAgXG4gICAgLypzZWxmLmNyaXREYW1hZ2UgPSBrby5jb21wdXRlZChmdW5jdGlvbiAoKSB7XG4gICAgICAgIHNlbGYuY3JpdEluZm8oKTtcbiAgICAgICAgcmV0dXJuIDA7XG4gICAgfSk7Ki9cbiAgICBzZWxmLm1pc3NDaGFuY2UgPSBrby5wdXJlQ29tcHV0ZWQoZnVuY3Rpb24gKCkge1xuICAgICAgICB2YXIgbWlzc0RlYnVmZiA9IFtzZWxmLmVuZW15KCkuaW52ZW50b3J5LmdldE1pc3NDaGFuY2UsIHNlbGYuZGVidWZmcy5pdGVtQnVmZnMuZ2V0TWlzc0NoYW5jZV0ucmVkdWNlKGZ1bmN0aW9uIChtZW1vLCBmbikge1xuICAgICAgICAgICAgdmFyIG9iaiA9IGZuKG1lbW8uZXhjbHVkZUxpc3QpO1xuICAgICAgICAgICAgb2JqLnZhbHVlICo9IG1lbW8udmFsdWU7XG4gICAgICAgICAgICByZXR1cm4gb2JqO1xuICAgICAgICB9LCB7dmFsdWU6MSwgZXhjbHVkZUxpc3Q6W119KTtcbiAgICAgICAgcmV0dXJuICgoMSAtIChzZWxmLmVuZW15KCkuYWJpbGl0eSgpLmdldE1pc3NDaGFuY2UoKSAqIHNlbGYuZGVidWZmcy5nZXRNaXNzQ2hhbmNlKCkgKiBtaXNzRGVidWZmLnZhbHVlKSkgKiAxMDApLnRvRml4ZWQoMik7XG4gICAgfSk7XG4gICAgc2VsZi50b3RhbGF0dGFja3JhbmdlID0ga28ucHVyZUNvbXB1dGVkKGZ1bmN0aW9uICgpIHtcbiAgICAgICAgdmFyIGF0dGFja3R5cGUgPSBzZWxmLmhlcm9EYXRhKCkuYXR0YWNrdHlwZTtcbiAgICAgICAgcmV0dXJuIHNlbGYuaGVyb0RhdGEoKS5hdHRhY2tyYW5nZVxuICAgICAgICAgICAgICsgc2VsZi5hYmlsaXR5KCkuZ2V0QXR0YWNrUmFuZ2UoKVxuICAgICAgICAgICAgICsgVGFsZW50Q29udHJvbGxlci5nZXRBdHRhY2tSYW5nZShzZWxmLnNlbGVjdGVkVGFsZW50cygpKVxuICAgICAgICAgICAgICsgc2VsZi5pbnZlbnRvcnkuZ2V0QXR0YWNrUmFuZ2UoYXR0YWNrdHlwZSkudmFsdWU7XG4gICAgfSk7XG4gICAgc2VsZi52aXNpb25yYW5nZWRheSA9IGtvLnB1cmVDb21wdXRlZChmdW5jdGlvbiAoKSB7XG4gICAgICAgIHJldHVybiAoc2VsZi5oZXJvRGF0YSgpLnZpc2lvbmRheXRpbWVyYW5nZSkgKiAoMSArIHNlbGYuZW5lbXkoKS5hYmlsaXR5KCkuZ2V0VmlzaW9uUmFuZ2VQY3RSZWR1Y3Rpb24oKSArIHNlbGYuZGVidWZmcy5nZXRWaXNpb25SYW5nZVBjdFJlZHVjdGlvbigpKTtcbiAgICB9KTtcbiAgICBzZWxmLnZpc2lvbnJhbmdlbmlnaHQgPSBrby5wdXJlQ29tcHV0ZWQoZnVuY3Rpb24gKCkge1xuICAgICAgICByZXR1cm4gKHNlbGYuaGVyb0RhdGEoKS52aXNpb25uaWdodHRpbWVyYW5nZSArIHNlbGYuaW52ZW50b3J5LmdldFZpc2lvblJhbmdlTmlnaHQoKSArIHNlbGYuYWJpbGl0eSgpLmdldFZpc2lvblJhbmdlTmlnaHQoKSkgKiAoMSArIHNlbGYuZW5lbXkoKS5hYmlsaXR5KCkuZ2V0VmlzaW9uUmFuZ2VQY3RSZWR1Y3Rpb24oKSArIHNlbGYuZGVidWZmcy5nZXRWaXNpb25SYW5nZVBjdFJlZHVjdGlvbigpKTtcbiAgICB9KTtcbiAgICBzZWxmLmxpZmVzdGVhbCA9IGtvLnB1cmVDb21wdXRlZChmdW5jdGlvbiAoKSB7XG4gICAgICAgIHZhciB0b3RhbCA9IHNlbGYuaW52ZW50b3J5LmdldExpZmVzdGVhbCgpXG4gICAgICAgICAgICAgICAgICArIHNlbGYuYWJpbGl0eSgpLmdldExpZmVzdGVhbCgpXG4gICAgICAgICAgICAgICAgICArIFRhbGVudENvbnRyb2xsZXIuZ2V0TGlmZXN0ZWFsKHNlbGYuc2VsZWN0ZWRUYWxlbnRzKCkpXG4gICAgICAgICAgICAgICAgICArIHNlbGYuYnVmZnMuZ2V0TGlmZXN0ZWFsKCk7XG4gICAgICAgIGlmIChzZWxmLmhlcm9EYXRhKCkuYXR0YWNrdHlwZSA9PSAnRE9UQV9VTklUX0NBUF9NRUxFRV9BVFRBQ0snKSB7XG4gICAgICAgICAgICB2YXIgbGlmZXN0ZWFsQXVyYSA9IFtzZWxmLmludmVudG9yeS5nZXRMaWZlc3RlYWxBdXJhLCBzZWxmLmJ1ZmZzLml0ZW1CdWZmcy5nZXRMaWZlc3RlYWxBdXJhXS5yZWR1Y2UoZnVuY3Rpb24gKG1lbW8sIGZuKSB7XG4gICAgICAgICAgICAgICAgdmFyIG9iaiA9IGZuKG1lbW8uZXhjbHVkZUxpc3QpO1xuICAgICAgICAgICAgICAgIG9iai52YWx1ZSArPSBtZW1vLnZhbHVlO1xuICAgICAgICAgICAgICAgIHJldHVybiBvYmo7XG4gICAgICAgICAgICB9LCB7dmFsdWU6IDAsIGV4Y2x1ZGVMaXN0OiBbXX0pO1xuICAgICAgICAgICAgdG90YWwgKz0gbGlmZXN0ZWFsQXVyYS52YWx1ZTtcbiAgICAgICAgfVxuICAgICAgICByZXR1cm4gKHRvdGFsKS50b0ZpeGVkKDIpO1xuICAgIH0pO1xuICAgIFxuICAgIHNlbGYuZGlmZlByb3BlcnRpZXMgPSBkaWZmUHJvcGVydGllcztcbiAgICBzZWxmLmRpZmYgPSB7fTtcblxuICAgIGZvciAodmFyIGkgPSAwOyBpIDwgc2VsZi5kaWZmUHJvcGVydGllcy5sZW5ndGg7IGkrKykge1xuICAgICAgICB2YXIgaW5kZXggPSBpO1xuICAgICAgICBzZWxmLmRpZmZbc2VsZi5kaWZmUHJvcGVydGllc1tpbmRleF1dID0gc2VsZi5nZXREaWZmRnVuY3Rpb24oc2VsZi5kaWZmUHJvcGVydGllc1tpbmRleF0pO1xuICAgIH1cbn07XG5cbkhlcm9Nb2RlbC5wcm90b3R5cGUuZ2V0RGlmZkZ1bmN0aW9uID0gZnVuY3Rpb24gKHByb3ApIHtcbiAgICB2YXIgc2VsZiA9IHRoaXM7XG4gICAgcmV0dXJuIGtvLmNvbXB1dGVkKGZ1bmN0aW9uICgpIHtcbiAgICAgICAgaWYgKHByb3AgPT0gJ2Jhc2VEYW1hZ2UnKSB7XG4gICAgICAgICAgICByZXR1cm4gW3NlbGZbcHJvcF0oKVswXSAtIHNlbGYuaGVyb0NvbXBhcmUoKVtwcm9wXSgpWzBdLCBzZWxmW3Byb3BdKClbMV0gLSBzZWxmLmhlcm9Db21wYXJlKClbcHJvcF0oKVsxXV07XG4gICAgICAgIH1cbiAgICAgICAgZWxzZSB7XG4gICAgICAgICAgICByZXR1cm4gc2VsZltwcm9wXSgpIC0gc2VsZi5oZXJvQ29tcGFyZSgpW3Byb3BdKCk7XG4gICAgICAgIH1cbiAgICB9LCB0aGlzLCB7IGRlZmVyRXZhbHVhdGlvbjogdHJ1ZSB9KTtcbn1cblxuSGVyb01vZGVsLnByb3RvdHlwZS5nZXRBYmlsaXR5TGV2ZWxNYXggPSBmdW5jdGlvbiAoZGF0YSkge1xuICAgIGlmIChkYXRhLmFiaWxpdHl0eXBlID09PSAnRE9UQV9BQklMSVRZX1RZUEVfQVRUUklCVVRFUycpIHtcbiAgICAgICAgcmV0dXJuIDE7XG4gICAgfVxuICAgIGVsc2UgaWYgKGRhdGEubmFtZSA9PT0gJ2ludm9rZXJfcXVhcycgfHwgZGF0YS5uYW1lID09PSAnaW52b2tlcl93ZXgnIHx8IGRhdGEubmFtZSA9PT0gJ2ludm9rZXJfZXhvcnQnKSB7XG4gICAgICAgIHJldHVybiA3O1xuICAgIH1cbiAgICBlbHNlIGlmIChkYXRhLm5hbWUgPT09ICdpbnZva2VyX2ludm9rZScpIHtcbiAgICAgICAgcmV0dXJuIDE7XG4gICAgfVxuICAgIGVsc2UgaWYgKGRhdGEubmFtZSA9PT0gJ2VhcnRoX3NwaXJpdF9zdG9uZV9jYWxsZXInIHx8IGRhdGEubmFtZSA9PT0gJ29ncmVfbWFnaV91bnJlZmluZWRfZmlyZWJsYXN0Jykge1xuICAgICAgICByZXR1cm4gMTtcbiAgICB9XG4gICAgZWxzZSBpZiAoZGF0YS5hYmlsaXR5dHlwZSA9PT0gJ0RPVEFfQUJJTElUWV9UWVBFX1VMVElNQVRFJyB8fCBkYXRhLm5hbWUgPT09ICdrZWVwZXJfb2ZfdGhlX2xpZ2h0X3JlY2FsbCcgfHxcbiAgICAgICAgICAgICBkYXRhLm5hbWUgPT09ICdrZWVwZXJfb2ZfdGhlX2xpZ2h0X2JsaW5kaW5nX2xpZ2h0JyB8fCBkYXRhLm5hbWUgPT09ICdlbWJlcl9zcGlyaXRfYWN0aXZhdGVfZmlyZV9yZW1uYW50JyB8fFxuICAgICAgICAgICAgIGRhdGEubmFtZSA9PT0gJ2xvbmVfZHJ1aWRfdHJ1ZV9mb3JtX2JhdHRsZV9jcnknKSB7XG4gICAgICAgIHJldHVybiAzO1xuICAgIH1cbiAgICBlbHNlIGlmIChkYXRhLm5hbWUgPT09ICdwdWNrX2V0aGVyZWFsX2phdW50JyAgfHwgZGF0YS5uYW1lID09PSAnc2hhZG93X2RlbW9uX3NoYWRvd19wb2lzb25fcmVsZWFzZScgfHxcbiAgICAgICAgICAgICBkYXRhLm5hbWUgPT09ICd0ZW1wbGFyX2Fzc2Fzc2luX3RyYXAnIHx8IGRhdGEubmFtZSA9PT0gJ3NwZWN0cmVfcmVhbGl0eScpIHtcbiAgICAgICAgcmV0dXJuIDA7XG4gICAgfVxuICAgIGVsc2UgaWYgKGRhdGEubmFtZSA9PT0gJ2ludm9rZXJfY29sZF9zbmFwJyAgfHwgZGF0YS5uYW1lID09PSAnaW52b2tlcl9naG9zdF93YWxrJyB8fCBkYXRhLm5hbWUgPT09ICdpbnZva2VyX3Rvcm5hZG8nIHx8IFxuICAgICAgICAgICAgIGRhdGEubmFtZSA9PT0gJ2ludm9rZXJfZW1wJyB8fCBkYXRhLm5hbWUgPT09ICdpbnZva2VyX2FsYWNyaXR5JyB8fCBkYXRhLm5hbWUgPT09ICdpbnZva2VyX2NoYW9zX21ldGVvcicgfHwgXG4gICAgICAgICAgICAgZGF0YS5uYW1lID09PSAnaW52b2tlcl9zdW5fc3RyaWtlJyB8fCBkYXRhLm5hbWUgPT09ICdpbnZva2VyX2ZvcmdlX3NwaXJpdCcgfHwgZGF0YS5uYW1lID09PSAnaW52b2tlcl9pY2Vfd2FsbCcgfHwgXG4gICAgICAgICAgICAgZGF0YS5uYW1lID09PSAnaW52b2tlcl9kZWFmZW5pbmdfYmxhc3QnKSB7XG4gICAgICAgIHJldHVybiAwO1xuICAgIH1cbiAgICBlbHNlIGlmIChkYXRhLm5hbWUgPT09ICd0ZWNoaWVzX21pbmVmaWVsZF9zaWduJyB8fCBkYXRhLm5hbWUgPT09ICd0ZWNoaWVzX2ZvY3VzZWRfZGV0b25hdGUnKSB7XG4gICAgICAgIHJldHVybiAwO1xuICAgIH1cbiAgICBlbHNlIHtcbiAgICAgICAgcmV0dXJuIDQ7XG4gICAgfVxufTtcblxuSGVyb01vZGVsLnByb3RvdHlwZS50b2dnbGVUYWxlbnQgPSBmdW5jdGlvbiAodGFsZW50VGllciwgdGFsZW50SW5kZXgpIHtcbiAgICBpZiAodGhpcy50YWxlbnRzW3RhbGVudFRpZXJdKCkgPT09IHRhbGVudEluZGV4KSB7XG4gICAgICAgIHRoaXMudGFsZW50c1t0YWxlbnRUaWVyXSgtMSk7XG4gICAgfVxuICAgIGVsc2UgaWYgKHRoaXMuYXZhaWxhYmxlU2tpbGxQb2ludHMoKSA+IDAgfHwgdGhpcy50YWxlbnRzW3RhbGVudFRpZXJdKCkgPT0gMSAtIHRhbGVudEluZGV4KSB7XG4gICAgICAgIGlmIChwYXJzZUludCh0aGlzLnNlbGVjdGVkSGVyb0xldmVsKCkpID49IHRhbGVudFRpZXIgKiA1ICsgMTApIHtcbiAgICAgICAgICAgIHRoaXMudGFsZW50c1t0YWxlbnRUaWVyXSh0YWxlbnRJbmRleCk7XG4gICAgICAgIH1cbiAgICB9XG59XG5cbm1vZHVsZS5leHBvcnRzID0gSGVyb01vZGVsOyIsInZhciBIZXJvT3B0aW9uID0gZnVuY3Rpb24gKG5hbWUsIGRpc3BsYXluYW1lLCBoZXJvKSB7XG4gICAgdGhpcy5oZXJvTmFtZSA9IG5hbWU7XG4gICAgdGhpcy5oZXJvRGlzcGxheU5hbWUgPSBkaXNwbGF5bmFtZTtcbiAgICB0aGlzLmhlcm8gPSBoZXJvO1xufTtcblxubW9kdWxlLmV4cG9ydHMgPSBIZXJvT3B0aW9uOyIsIid1c2Ugc3RyaWN0JztcbnZhciBIZXJvTW9kZWwgPSByZXF1aXJlKFwiLi9IZXJvTW9kZWxcIik7XG52YXIgaWxsdXNpb25EYXRhID0gcmVxdWlyZShcIi4uL2lsbHVzaW9uL2lsbHVzaW9uRGF0YVwiKTtcbnZhciBmaW5kV2hlcmUgPSByZXF1aXJlKFwiLi4vdXRpbC9maW5kV2hlcmVcIik7XG5cbnZhciBJbGx1c2lvbk1vZGVsID0gZnVuY3Rpb24gKGhlcm9EYXRhLCBpdGVtRGF0YSwgaCxwLCBhYmlsaXR5TGV2ZWwpIHtcbiAgICB2YXIgc2VsZiA9IHRoaXM7XG4gICAgSGVyb01vZGVsLmNhbGwodGhpcywgaGVyb0RhdGEsIGl0ZW1EYXRhLCBoKTtcbiAgICBzZWxmLmlsbHVzaW9uQWJpbGl0eUxldmVsID0ga28ub2JzZXJ2YWJsZShhYmlsaXR5TGV2ZWwpO1xuICAgIHNlbGYucGFyZW50ID0gcDtcbiAgICBcbiAgICBzZWxmLnRvdGFsQWdpID0ga28uY29tcHV0ZWQoZnVuY3Rpb24gKCkge1xuICAgICAgICByZXR1cm4gKHNlbGYuaGVyb0RhdGEoKS5hdHRyaWJ1dGViYXNlYWdpbGl0eVxuICAgICAgICAgICAgICAgICsgc2VsZi5oZXJvRGF0YSgpLmF0dHJpYnV0ZWFnaWxpdHlnYWluICogKHNlbGYuc2VsZWN0ZWRIZXJvTGV2ZWwoKSAtIDEpIFxuICAgICAgICAgICAgICAgICsgc2VsZi5pbnZlbnRvcnkuZ2V0QXR0cmlidXRlcygnYWdpJykgXG4gICAgICAgICAgICAgICAgKyBzZWxmLmFiaWxpdHkoKS5nZXRBdHRyaWJ1dGVCb251c0xldmVsKCkgKiAyXG4gICAgICAgICAgICAgICAgKyBzZWxmLmFiaWxpdHkoKS5nZXRBZ2lsaXR5KClcbiAgICAgICAgICAgICAgICArIHNlbGYuZW5lbXkoKS5hYmlsaXR5KCkuZ2V0QWxsU3RhdHNSZWR1Y3Rpb24oKVxuICAgICAgICAgICAgICAgICsgc2VsZi5kZWJ1ZmZzLmdldEFsbFN0YXRzUmVkdWN0aW9uKClcbiAgICAgICAgICAgICAgICkudG9GaXhlZCgyKTtcbiAgICB9KTtcbiAgICBzZWxmLmludFN0b2xlbiA9IGtvLm9ic2VydmFibGUoMCkuZXh0ZW5kKHsgbnVtZXJpYzogMCB9KTtcbiAgICBzZWxmLnRvdGFsSW50ID0ga28uY29tcHV0ZWQoZnVuY3Rpb24gKCkge1xuICAgICAgICByZXR1cm4gKHNlbGYuaGVyb0RhdGEoKS5hdHRyaWJ1dGViYXNlaW50ZWxsaWdlbmNlIFxuICAgICAgICAgICAgICAgICsgc2VsZi5oZXJvRGF0YSgpLmF0dHJpYnV0ZWludGVsbGlnZW5jZWdhaW4gKiAoc2VsZi5zZWxlY3RlZEhlcm9MZXZlbCgpIC0gMSkgXG4gICAgICAgICAgICAgICAgKyBzZWxmLmludmVudG9yeS5nZXRBdHRyaWJ1dGVzKCdpbnQnKSBcbiAgICAgICAgICAgICAgICArIHNlbGYuYWJpbGl0eSgpLmdldEF0dHJpYnV0ZUJvbnVzTGV2ZWwoKSAqIDJcbiAgICAgICAgICAgICAgICArIHNlbGYuYWJpbGl0eSgpLmdldEludGVsbGlnZW5jZSgpXG4gICAgICAgICAgICAgICAgKyBzZWxmLmVuZW15KCkuYWJpbGl0eSgpLmdldEFsbFN0YXRzUmVkdWN0aW9uKClcbiAgICAgICAgICAgICAgICArIHNlbGYuZGVidWZmcy5nZXRBbGxTdGF0c1JlZHVjdGlvbigpICsgc2VsZi5pbnRTdG9sZW4oKVxuICAgICAgICAgICAgICAgKS50b0ZpeGVkKDIpO1xuICAgIH0pO1xuICAgIHNlbGYudG90YWxTdHIgPSBrby5jb21wdXRlZChmdW5jdGlvbiAoKSB7XG4gICAgICAgIHJldHVybiAoc2VsZi5oZXJvRGF0YSgpLmF0dHJpYnV0ZWJhc2VzdHJlbmd0aCBcbiAgICAgICAgICAgICAgICArIHNlbGYuaGVyb0RhdGEoKS5hdHRyaWJ1dGVzdHJlbmd0aGdhaW4gKiAoc2VsZi5zZWxlY3RlZEhlcm9MZXZlbCgpIC0gMSkgXG4gICAgICAgICAgICAgICAgKyBzZWxmLmludmVudG9yeS5nZXRBdHRyaWJ1dGVzKCdzdHInKSBcbiAgICAgICAgICAgICAgICArIHNlbGYuYWJpbGl0eSgpLmdldEF0dHJpYnV0ZUJvbnVzTGV2ZWwoKSAqIDJcbiAgICAgICAgICAgICAgICArIHNlbGYuYWJpbGl0eSgpLmdldFN0cmVuZ3RoKClcbiAgICAgICAgICAgICAgICArIHNlbGYuZW5lbXkoKS5hYmlsaXR5KCkuZ2V0QWxsU3RhdHNSZWR1Y3Rpb24oKVxuICAgICAgICAgICAgICAgICsgc2VsZi5kZWJ1ZmZzLmdldEFsbFN0YXRzUmVkdWN0aW9uKClcbiAgICAgICAgICAgICAgICkudG9GaXhlZCgyKTtcbiAgICB9KTtcbiAgICBcbiAgICBzZWxmLmdldEFiaWxpdHlBdHRyaWJ1dGVWYWx1ZSA9IGZ1bmN0aW9uKGhlcm8sIGFiaWxpdHksIGF0dHJpYnV0ZU5hbWUsIGxldmVsKSB7XG4gICAgICAgIGlmIChhYmlsaXR5ID09ICdpdGVtX21hbnRhJykge1xuICAgICAgICAgICAgdmFyIGFiaWxpdHlPYmogPSBpdGVtRGF0YVthYmlsaXR5XTtcbiAgICAgICAgfVxuICAgICAgICBlbHNlIHtcbiAgICAgICAgICAgIHZhciBhYmlsaXR5T2JqID0gZmluZFdoZXJlKGhlcm9EYXRhWyducGNfZG90YV9oZXJvXycgKyBoZXJvXS5hYmlsaXRpZXMsIHtuYW1lOiBhYmlsaXR5fSk7XG4gICAgICAgIH1cbiAgICAgICAgdmFyIGF0dHJpYnV0ZSA9IGZpbmRXaGVyZShhYmlsaXR5T2JqLmF0dHJpYnV0ZXMsIHtuYW1lOiBhdHRyaWJ1dGVOYW1lfSk7XG4gICAgICAgIGlmIChsZXZlbCA9PSAwKSB7XG4gICAgICAgICAgICByZXR1cm4gcGFyc2VGbG9hdChhdHRyaWJ1dGUudmFsdWVbMF0pO1xuICAgICAgICB9XG4gICAgICAgIGVsc2UgaWYgKGxldmVsID4gYXR0cmlidXRlLmxlbmd0aCkge1xuICAgICAgICAgICAgcmV0dXJuIHBhcnNlRmxvYXQoYXR0cmlidXRlLnZhbHVlWzBdKTtcbiAgICAgICAgfVxuICAgICAgICBlbHNlIHtcbiAgICAgICAgICAgIHJldHVybiBwYXJzZUZsb2F0KGF0dHJpYnV0ZS52YWx1ZVtsZXZlbCAtIDFdKTtcbiAgICAgICAgfVxuICAgIH1cbiAgICBcbiAgICBzZWxmLmdldEluY29taW5nRGFtYWdlTXVsdGlwbGllciA9IGZ1bmN0aW9uKGlsbHVzaW9uVHlwZSwgaGFzU2NlcHRlciwgYXR0YWNrVHlwZSkge1xuICAgICAgICBpZiAoaWxsdXNpb25UeXBlID09ICdpdGVtX21hbnRhJykge1xuICAgICAgICAgICAgaWYgKGF0dGFja1R5cGUgPT0gJ0RPVEFfVU5JVF9DQVBfTUVMRUVfQVRUQUNLJykge1xuICAgICAgICAgICAgICAgIHJldHVybiAoMSArIHNlbGYuZ2V0QWJpbGl0eUF0dHJpYnV0ZVZhbHVlKGlsbHVzaW9uRGF0YVtzZWxmLmlsbHVzaW9uVHlwZSgpXS5oZXJvLCBzZWxmLmlsbHVzaW9uVHlwZSgpLCBpbGx1c2lvbkRhdGFbaWxsdXNpb25UeXBlXS5pbmNvbWluZ19kYW1hZ2VfbWVsZWUsIHNlbGYuaWxsdXNpb25BYmlsaXR5TGV2ZWwoKSkvMTAwKVxuICAgICAgICAgICAgfVxuICAgICAgICAgICAgZWxzZSB7XG4gICAgICAgICAgICAgICAgcmV0dXJuICgxICsgc2VsZi5nZXRBYmlsaXR5QXR0cmlidXRlVmFsdWUoaWxsdXNpb25EYXRhW3NlbGYuaWxsdXNpb25UeXBlKCldLmhlcm8sIHNlbGYuaWxsdXNpb25UeXBlKCksIGlsbHVzaW9uRGF0YVtpbGx1c2lvblR5cGVdLmluY29taW5nX2RhbWFnZV9yYW5nZWQsIHNlbGYuaWxsdXNpb25BYmlsaXR5TGV2ZWwoKSkvMTAwKVxuICAgICAgICAgICAgfVxuICAgICAgICB9XG4gICAgICAgIGVsc2Uge1xuICAgICAgICAgICAgcmV0dXJuICgxICsgc2VsZi5nZXRBYmlsaXR5QXR0cmlidXRlVmFsdWUoaWxsdXNpb25EYXRhW3NlbGYuaWxsdXNpb25UeXBlKCldLmhlcm8sIHNlbGYuaWxsdXNpb25UeXBlKCksIGlsbHVzaW9uRGF0YVtpbGx1c2lvblR5cGVdLmluY29taW5nX2RhbWFnZSwgc2VsZi5pbGx1c2lvbkFiaWxpdHlMZXZlbCgpKS8xMDApXG4gICAgICAgIH1cbiAgICB9XG4gICAgc2VsZi5nZXRPdXRnb2luZ0RhbWFnZU11bHRpcGxpZXIgPSBmdW5jdGlvbihpbGx1c2lvblR5cGUsIGhhc1NjZXB0ZXIsIGF0dGFja1R5cGUpIHtcbiAgICAgICAgaWYgKGlsbHVzaW9uVHlwZSA9PSAnaXRlbV9tYW50YScpIHtcbiAgICAgICAgICAgIGlmIChhdHRhY2tUeXBlID09ICdET1RBX1VOSVRfQ0FQX01FTEVFX0FUVEFDSycpIHtcbiAgICAgICAgICAgICAgICByZXR1cm4gKDEgKyBzZWxmLmdldEFiaWxpdHlBdHRyaWJ1dGVWYWx1ZShpbGx1c2lvbkRhdGFbc2VsZi5pbGx1c2lvblR5cGUoKV0uaGVybywgc2VsZi5pbGx1c2lvblR5cGUoKSwgaWxsdXNpb25EYXRhW2lsbHVzaW9uVHlwZV0ub3V0Z29pbmdfZGFtYWdlX21lbGVlLCBzZWxmLmlsbHVzaW9uQWJpbGl0eUxldmVsKCkpLzEwMCk7XG4gICAgICAgICAgICB9XG4gICAgICAgICAgICBlbHNlIHtcbiAgICAgICAgICAgICAgICByZXR1cm4gKDEgKyBzZWxmLmdldEFiaWxpdHlBdHRyaWJ1dGVWYWx1ZShpbGx1c2lvbkRhdGFbc2VsZi5pbGx1c2lvblR5cGUoKV0uaGVybywgc2VsZi5pbGx1c2lvblR5cGUoKSwgaWxsdXNpb25EYXRhW2lsbHVzaW9uVHlwZV0ub3V0Z29pbmdfZGFtYWdlX3JhbmdlZCwgc2VsZi5pbGx1c2lvbkFiaWxpdHlMZXZlbCgpKS8xMDApO1xuICAgICAgICAgICAgfVxuICAgICAgICB9XG4gICAgICAgIGVsc2Uge1xuICAgICAgICAgICAgcmV0dXJuICgxICsgc2VsZi5nZXRBYmlsaXR5QXR0cmlidXRlVmFsdWUoaWxsdXNpb25EYXRhW3NlbGYuaWxsdXNpb25UeXBlKCldLmhlcm8sIHNlbGYuaWxsdXNpb25UeXBlKCksIGlsbHVzaW9uRGF0YVtpbGx1c2lvblR5cGVdLm91dGdvaW5nX2RhbWFnZSwgc2VsZi5pbGx1c2lvbkFiaWxpdHlMZXZlbCgpKS8xMDApO1xuICAgICAgICB9XG4gICAgfVxuXG4gICAgc2VsZi5iYXNlRGFtYWdlID0ga28uY29tcHV0ZWQoZnVuY3Rpb24oKSB7XG4gICAgICAgIHJldHVybiBbTWF0aC5mbG9vcihoZXJvRGF0YVsnbnBjX2RvdGFfaGVyb18nICsgc2VsZi5oZXJvSWQoKV0uYXR0YWNrZGFtYWdlbWluICsgc2VsZi50b3RhbEF0dHJpYnV0ZShzZWxmLnByaW1hcnlBdHRyaWJ1dGUoKSkgKyBzZWxmLmFiaWxpdHkoKS5nZXRCYXNlRGFtYWdlKCkudG90YWwpXG4gICAgICAgICAgICAgICAgKiBzZWxmLmdldE91dGdvaW5nRGFtYWdlTXVsdGlwbGllcihzZWxmLmlsbHVzaW9uVHlwZSgpLCBmYWxzZSwgc2VsZi5oZXJvRGF0YSgpLmF0dGFja3R5cGUpLFxuICAgICAgICAgICAgICAgIE1hdGguZmxvb3IoaGVyb0RhdGFbJ25wY19kb3RhX2hlcm9fJyArIHNlbGYuaGVyb0lkKCldLmF0dGFja2RhbWFnZW1heCArIHNlbGYudG90YWxBdHRyaWJ1dGUoc2VsZi5wcmltYXJ5QXR0cmlidXRlKCkpICsgc2VsZi5hYmlsaXR5KCkuZ2V0QmFzZURhbWFnZSgpLnRvdGFsKVxuICAgICAgICAgICAgICAgICogc2VsZi5nZXRPdXRnb2luZ0RhbWFnZU11bHRpcGxpZXIoc2VsZi5pbGx1c2lvblR5cGUoKSwgZmFsc2UsIHNlbGYuaGVyb0RhdGEoKS5hdHRhY2t0eXBlKV07XG4gICAgfSk7XG4gICAgXG4gICAgc2VsZi5kYW1hZ2UgPSBrby5jb21wdXRlZChmdW5jdGlvbigpIHtcbiAgICAgICAgcmV0dXJuIFtzZWxmLmJhc2VEYW1hZ2UoKVswXSxcbiAgICAgICAgICAgICAgICBzZWxmLmJhc2VEYW1hZ2UoKVsxXV07XG4gICAgfSk7XG4gICAgXG4gICAgc2VsZi5laHBQaHlzaWNhbCA9IGtvLmNvbXB1dGVkKGZ1bmN0aW9uKCkge1xuICAgICAgICB2YXIgZWhwID0gKHNlbGYuaGVhbHRoKCkgKiAoMSArIC4wNiAqIHNlbGYudG90YWxBcm1vclBoeXNpY2FsKCkpKSAvICgxIC0gKDEgLSAoc2VsZi5pbnZlbnRvcnkuZ2V0RXZhc2lvbigpICogc2VsZi5hYmlsaXR5KCkuZ2V0RXZhc2lvbigpKSkpXG4gICAgICAgIGVocCAqPSAoc2VsZi5pbnZlbnRvcnkuYWN0aXZlSXRlbXMoKS5zb21lKGZ1bmN0aW9uKGl0ZW0pIHtyZXR1cm4gaXRlbS5pdGVtID09ICdtYXNrX29mX21hZG5lc3MnO30pID8gKDEgLyAxLjMpIDogMSk7XG4gICAgICAgIGVocCAqPSAoMSAvIHNlbGYuZ2V0SW5jb21pbmdEYW1hZ2VNdWx0aXBsaWVyKHNlbGYuaWxsdXNpb25UeXBlKCksIGZhbHNlLCBzZWxmLmhlcm9EYXRhKCkuYXR0YWNrdHlwZSkpO1xuICAgICAgICByZXR1cm4gZWhwLnRvRml4ZWQoMik7XG4gICAgfSk7XG4gICAgc2VsZi5laHBNYWdpY2FsID0ga28uY29tcHV0ZWQoZnVuY3Rpb24oKSB7XG4gICAgICAgIHZhciBlaHAgPSBzZWxmLmhlYWx0aCgpIC8gc2VsZi50b3RhbE1hZ2ljUmVzaXN0YW5jZVByb2R1Y3QoKTtcbiAgICAgICAgZWhwICo9ICgxIC8gc2VsZi5nZXRJbmNvbWluZ0RhbWFnZU11bHRpcGxpZXIoc2VsZi5pbGx1c2lvblR5cGUoKSwgZmFsc2UsIHNlbGYuaGVyb0RhdGEoKS5hdHRhY2t0eXBlKSk7XG4gICAgICAgIHJldHVybiBlaHAudG9GaXhlZCgyKTtcbiAgICB9KTtcbiAgICBcbiAgICBzZWxmLnRvdGFsQXJtb3JQaHlzaWNhbCA9IGtvLmNvbXB1dGVkKGZ1bmN0aW9uKCkge1xuICAgICAgICByZXR1cm4gKHNlbGYuZW5lbXkoKS5hYmlsaXR5KCkuZ2V0QXJtb3JCYXNlUmVkdWN0aW9uKCkgKiBzZWxmLmRlYnVmZnMuZ2V0QXJtb3JCYXNlUmVkdWN0aW9uKCkgKiAoaGVyb0RhdGFbJ25wY19kb3RhX2hlcm9fJyArIHNlbGYuaGVyb0lkKCldLmFybW9ycGh5c2ljYWwgKyBzZWxmLnRvdGFsQWdpKCkgKiAuMTQpXG4gICAgICAgICAgICAgICAgKyBzZWxmLmFiaWxpdHkoKS5nZXRBcm1vcigpICsgc2VsZi5lbmVteSgpLmFiaWxpdHkoKS5nZXRBcm1vclJlZHVjdGlvbigpICsgc2VsZi5idWZmcy5nZXRBcm1vcigpICsgc2VsZi5kZWJ1ZmZzLmdldEFybW9yUmVkdWN0aW9uKCkpLnRvRml4ZWQoMik7XG4gICAgfSk7XG4gICAgXG4gICAgc2VsZi5pYXMgPSBrby5jb21wdXRlZChmdW5jdGlvbigpIHtcbiAgICAgICAgdmFyIHZhbCA9IHBhcnNlRmxvYXQoc2VsZi50b3RhbEFnaSgpKSBcbiAgICAgICAgICAgICAgICArIHNlbGYuYWJpbGl0eSgpLmdldEF0dGFja1NwZWVkKCkgXG4gICAgICAgICAgICAgICAgKyBzZWxmLmVuZW15KCkuYWJpbGl0eSgpLmdldEF0dGFja1NwZWVkUmVkdWN0aW9uKCkgXG4gICAgICAgICAgICAgICAgKyBzZWxmLmJ1ZmZzLmdldEF0dGFja1NwZWVkKCkgXG4gICAgICAgICAgICAgICAgKyBzZWxmLmRlYnVmZnMuZ2V0QXR0YWNrU3BlZWRSZWR1Y3Rpb24oKVxuICAgICAgICAgICAgICAgICsgc2VsZi51bml0KCkuYWJpbGl0eSgpLmdldEF0dGFja1NwZWVkKCk7IFxuICAgICAgICBpZiAodmFsIDwgLTgwKSB7XG4gICAgICAgICAgICByZXR1cm4gLTgwO1xuICAgICAgICB9XG4gICAgICAgIGVsc2UgaWYgKHZhbCA+IDQwMCkge1xuICAgICAgICAgICAgcmV0dXJuIDQwMDtcbiAgICAgICAgfVxuICAgICAgICByZXR1cm4gdmFsLnRvRml4ZWQoMik7XG4gICAgfSk7XG4gICAgXG4gICAgcmV0dXJuIHNlbGY7XG59XG5JbGx1c2lvbk1vZGVsLnByb3RvdHlwZSA9IE9iamVjdC5jcmVhdGUoSGVyb01vZGVsLnByb3RvdHlwZSk7XG5JbGx1c2lvbk1vZGVsLnByb3RvdHlwZS5jb25zdHJ1Y3RvciA9IElsbHVzaW9uTW9kZWw7XG5cbm1vZHVsZS5leHBvcnRzID0gSWxsdXNpb25Nb2RlbDsiLCJtb2R1bGUuZXhwb3J0cyA9IHtcbiAgICBnZXRCb251c0RhbWFnZTogZnVuY3Rpb24gKHRhbGVudHMpIHtcbiAgICAgICAgdmFyIHRvdGFsQXR0cmlidXRlID0gMDtcbiAgICAgICAgdmFyIHNvdXJjZXMgPSB7fTtcbiAgICAgICAgZm9yICh2YXIgaSA9IDA7IGkgPCB0YWxlbnRzLmxlbmd0aDsgaSsrKSB7XG4gICAgICAgICAgICB2YXIgYWJpbGl0eSA9IHRhbGVudHNbaV07XG4gICAgICAgICAgICBpZiAoYWJpbGl0eS5uYW1lLnN0YXJ0c1dpdGgoJ3NwZWNpYWxfYm9udXNfYXR0YWNrX2RhbWFnZV8nKSkge1xuICAgICAgICAgICAgICAgIHRvdGFsQXR0cmlidXRlICs9IGFiaWxpdHkuYXR0cmlidXRlc1swXS52YWx1ZVswXTtcbiAgICAgICAgICAgICAgICBzb3VyY2VzW2FiaWxpdHkubmFtZV0gPSB7XG4gICAgICAgICAgICAgICAgICAgICdkYW1hZ2UnOiBhYmlsaXR5LmF0dHJpYnV0ZXNbMF0udmFsdWVbMF0sXG4gICAgICAgICAgICAgICAgICAgICdkYW1hZ2VUeXBlJzogJ3BoeXNpY2FsJyxcbiAgICAgICAgICAgICAgICAgICAgJ2Rpc3BsYXluYW1lJzogYWJpbGl0eS5kaXNwbGF5bmFtZVxuICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgIH1cbiAgICAgICAgfVxuICAgICAgICByZXR1cm4geyBzb3VyY2VzOiBzb3VyY2VzLCB0b3RhbDogdG90YWxBdHRyaWJ1dGUgfTtcbiAgICB9LFxuICAgIGdldEhlYWx0aDogZnVuY3Rpb24gKHRhbGVudHMpIHtcbiAgICAgICAgdmFyIHRvdGFsQXR0cmlidXRlID0gMDtcbiAgICAgICAgZm9yICh2YXIgaSA9IDA7IGkgPCB0YWxlbnRzLmxlbmd0aDsgaSsrKSB7XG4gICAgICAgICAgICB2YXIgYWJpbGl0eSA9IHRhbGVudHNbaV07XG4gICAgICAgICAgICBpZiAoYWJpbGl0eS5uYW1lLnN0YXJ0c1dpdGgoJ3NwZWNpYWxfYm9udXNfaHBfJykgJiYgIWFiaWxpdHkubmFtZS5zdGFydHNXaXRoKCdzcGVjaWFsX2JvbnVzX2hwX3JlZ2VuXycpKSB7XG4gICAgICAgICAgICAgICAgdG90YWxBdHRyaWJ1dGUgKz0gYWJpbGl0eS5hdHRyaWJ1dGVzWzBdLnZhbHVlWzBdO1xuICAgICAgICAgICAgfVxuICAgICAgICB9XG4gICAgICAgIHJldHVybiB0b3RhbEF0dHJpYnV0ZTtcbiAgICB9LFxuICAgIGdldEhlYWx0aFJlZ2VuOiBmdW5jdGlvbiAodGFsZW50cykge1xuICAgICAgICB2YXIgdG90YWxBdHRyaWJ1dGUgPSAwO1xuICAgICAgICBmb3IgKHZhciBpID0gMDsgaSA8IHRhbGVudHMubGVuZ3RoOyBpKyspIHtcbiAgICAgICAgICAgIHZhciBhYmlsaXR5ID0gdGFsZW50c1tpXTtcbiAgICAgICAgICAgIGlmIChhYmlsaXR5Lm5hbWUuc3RhcnRzV2l0aCgnc3BlY2lhbF9ib251c19ocF9yZWdlbl8nKSkge1xuICAgICAgICAgICAgICAgIHRvdGFsQXR0cmlidXRlICs9IGFiaWxpdHkuYXR0cmlidXRlc1swXS52YWx1ZVswXTtcbiAgICAgICAgICAgIH1cbiAgICAgICAgfVxuICAgICAgICByZXR1cm4gdG90YWxBdHRyaWJ1dGU7XG4gICAgfSxcbiAgICBnZXRNYW5hOiBmdW5jdGlvbiAodGFsZW50cykge1xuICAgICAgICB2YXIgdG90YWxBdHRyaWJ1dGUgPSAwO1xuICAgICAgICBmb3IgKHZhciBpID0gMDsgaSA8IHRhbGVudHMubGVuZ3RoOyBpKyspIHtcbiAgICAgICAgICAgIHZhciBhYmlsaXR5ID0gdGFsZW50c1tpXTtcbiAgICAgICAgICAgIGlmIChhYmlsaXR5Lm5hbWUuc3RhcnRzV2l0aCgnc3BlY2lhbF9ib251c19tcF8nKSAmJiAhYWJpbGl0eS5uYW1lLnN0YXJ0c1dpdGgoJ3NwZWNpYWxfYm9udXNfbXBfcmVnZW5fJykpIHtcbiAgICAgICAgICAgICAgICB0b3RhbEF0dHJpYnV0ZSArPSBhYmlsaXR5LmF0dHJpYnV0ZXNbMF0udmFsdWVbMF07XG4gICAgICAgICAgICB9XG4gICAgICAgIH1cbiAgICAgICAgcmV0dXJuIHRvdGFsQXR0cmlidXRlO1xuICAgIH0sXG4gICAgZ2V0TWFuYVJlZ2VuOiBmdW5jdGlvbiAodGFsZW50cykge1xuICAgICAgICB2YXIgdG90YWxBdHRyaWJ1dGUgPSAwO1xuICAgICAgICBmb3IgKHZhciBpID0gMDsgaSA8IHRhbGVudHMubGVuZ3RoOyBpKyspIHtcbiAgICAgICAgICAgIHZhciBhYmlsaXR5ID0gdGFsZW50c1tpXTtcbiAgICAgICAgICAgIGlmIChhYmlsaXR5Lm5hbWUuc3RhcnRzV2l0aCgnc3BlY2lhbF9ib251c19tcF9yZWdlbl8nKSkge1xuICAgICAgICAgICAgICAgIHRvdGFsQXR0cmlidXRlICs9IGFiaWxpdHkuYXR0cmlidXRlc1swXS52YWx1ZVswXTtcbiAgICAgICAgICAgIH1cbiAgICAgICAgfVxuICAgICAgICByZXR1cm4gdG90YWxBdHRyaWJ1dGU7XG4gICAgfSxcbiAgICBnZXRBcm1vcjogZnVuY3Rpb24gKHRhbGVudHMpIHtcbiAgICAgICAgdmFyIHRvdGFsQXR0cmlidXRlID0gMDtcbiAgICAgICAgZm9yICh2YXIgaSA9IDA7IGkgPCB0YWxlbnRzLmxlbmd0aDsgaSsrKSB7XG4gICAgICAgICAgICB2YXIgYWJpbGl0eSA9IHRhbGVudHNbaV07XG4gICAgICAgICAgICBpZiAoYWJpbGl0eS5uYW1lLnN0YXJ0c1dpdGgoJ3NwZWNpYWxfYm9udXNfYXJtb3JfJykpIHtcbiAgICAgICAgICAgICAgICB0b3RhbEF0dHJpYnV0ZSArPSBhYmlsaXR5LmF0dHJpYnV0ZXNbMF0udmFsdWVbMF07XG4gICAgICAgICAgICB9XG4gICAgICAgIH1cbiAgICAgICAgcmV0dXJuIHRvdGFsQXR0cmlidXRlO1xuICAgIH0sXG4gICAgZ2V0TW92ZW1lbnRTcGVlZEZsYXQ6IGZ1bmN0aW9uICh0YWxlbnRzKSB7XG4gICAgICAgIHZhciB0b3RhbEF0dHJpYnV0ZSA9IDA7XG4gICAgICAgIGZvciAodmFyIGkgPSAwOyBpIDwgdGFsZW50cy5sZW5ndGg7IGkrKykge1xuICAgICAgICAgICAgdmFyIGFiaWxpdHkgPSB0YWxlbnRzW2ldO1xuICAgICAgICAgICAgaWYgKGFiaWxpdHkubmFtZS5zdGFydHNXaXRoKCdzcGVjaWFsX2JvbnVzX21vdmVtZW50X3NwZWVkXycpKSB7XG4gICAgICAgICAgICAgICAgdG90YWxBdHRyaWJ1dGUgKz0gYWJpbGl0eS5hdHRyaWJ1dGVzWzBdLnZhbHVlWzBdO1xuICAgICAgICAgICAgfVxuICAgICAgICB9XG4gICAgICAgIHJldHVybiB0b3RhbEF0dHJpYnV0ZTtcbiAgICB9LFxuICAgIGdldEF0dGFja1JhbmdlOiBmdW5jdGlvbiAodGFsZW50cykge1xuICAgICAgICB2YXIgdG90YWxBdHRyaWJ1dGUgPSAwO1xuICAgICAgICBmb3IgKHZhciBpID0gMDsgaSA8IHRhbGVudHMubGVuZ3RoOyBpKyspIHtcbiAgICAgICAgICAgIHZhciBhYmlsaXR5ID0gdGFsZW50c1tpXTtcbiAgICAgICAgICAgIGlmIChhYmlsaXR5Lm5hbWUuc3RhcnRzV2l0aCgnc3BlY2lhbF9ib251c19hdHRhY2tfcmFuZ2VfJykpIHtcbiAgICAgICAgICAgICAgICB0b3RhbEF0dHJpYnV0ZSArPSBhYmlsaXR5LmF0dHJpYnV0ZXNbMF0udmFsdWVbMF07XG4gICAgICAgICAgICB9XG4gICAgICAgIH1cbiAgICAgICAgcmV0dXJuIHRvdGFsQXR0cmlidXRlO1xuICAgIH0sXG4gICAgZ2V0QXR0YWNrU3BlZWQ6IGZ1bmN0aW9uICh0YWxlbnRzKSB7XG4gICAgICAgIHZhciB0b3RhbEF0dHJpYnV0ZSA9IDA7XG4gICAgICAgIGZvciAodmFyIGkgPSAwOyBpIDwgdGFsZW50cy5sZW5ndGg7IGkrKykge1xuICAgICAgICAgICAgdmFyIGFiaWxpdHkgPSB0YWxlbnRzW2ldO1xuICAgICAgICAgICAgaWYgKGFiaWxpdHkubmFtZS5zdGFydHNXaXRoKCdzcGVjaWFsX2JvbnVzX2F0dGFja19zcGVlZF8nKSkge1xuICAgICAgICAgICAgICAgIHRvdGFsQXR0cmlidXRlICs9IGFiaWxpdHkuYXR0cmlidXRlc1swXS52YWx1ZVswXTtcbiAgICAgICAgICAgIH1cbiAgICAgICAgfVxuICAgICAgICByZXR1cm4gdG90YWxBdHRyaWJ1dGU7XG4gICAgfSxcbiAgICBnZXRMaWZlc3RlYWw6IGZ1bmN0aW9uICh0YWxlbnRzKSB7XG4gICAgICAgIHZhciB0b3RhbEF0dHJpYnV0ZSA9IDA7XG4gICAgICAgIGZvciAodmFyIGkgPSAwOyBpIDwgdGFsZW50cy5sZW5ndGg7IGkrKykge1xuICAgICAgICAgICAgdmFyIGFiaWxpdHkgPSB0YWxlbnRzW2ldO1xuICAgICAgICAgICAgaWYgKGFiaWxpdHkubmFtZS5zdGFydHNXaXRoKCdzcGVjaWFsX2JvbnVzX2xpZmVzdGVhbF8nKSkge1xuICAgICAgICAgICAgICAgIHRvdGFsQXR0cmlidXRlICs9IGFiaWxpdHkuYXR0cmlidXRlc1swXS52YWx1ZVswXTtcbiAgICAgICAgICAgIH1cbiAgICAgICAgfVxuICAgICAgICByZXR1cm4gdG90YWxBdHRyaWJ1dGU7XG4gICAgfSxcbiAgICBnZXRFdmFzaW9uOiBmdW5jdGlvbiAodGFsZW50cykge1xuICAgICAgICB2YXIgdG90YWxBdHRyaWJ1dGUgPSAxO1xuICAgICAgICBmb3IgKHZhciBpID0gMDsgaSA8IHRhbGVudHMubGVuZ3RoOyBpKyspIHtcbiAgICAgICAgICAgIHZhciBhYmlsaXR5ID0gdGFsZW50c1tpXTtcbiAgICAgICAgICAgIGlmIChhYmlsaXR5Lm5hbWUuc3RhcnRzV2l0aCgnc3BlY2lhbF9ib251c19ldmFzaW9uXycpKSB7XG4gICAgICAgICAgICAgICAgdG90YWxBdHRyaWJ1dGUgKj0gKDEgLSBhYmlsaXR5LmF0dHJpYnV0ZXNbMF0udmFsdWVbMF0vMTAwKTtcbiAgICAgICAgICAgIH1cbiAgICAgICAgfVxuICAgICAgICByZXR1cm4gdG90YWxBdHRyaWJ1dGU7XG4gICAgfSxcbiAgICBnZXRNYWdpY1Jlc2lzdDogZnVuY3Rpb24gKHRhbGVudHMpIHtcbiAgICAgICAgdmFyIHRvdGFsQXR0cmlidXRlID0gMTtcbiAgICAgICAgZm9yICh2YXIgaSA9IDA7IGkgPCB0YWxlbnRzLmxlbmd0aDsgaSsrKSB7XG4gICAgICAgICAgICB2YXIgYWJpbGl0eSA9IHRhbGVudHNbaV07XG4gICAgICAgICAgICBpZiAoYWJpbGl0eS5uYW1lLnN0YXJ0c1dpdGgoJ3NwZWNpYWxfYm9udXNfbWFnaWNfcmVzaXN0YW5jZV8nKSkge1xuICAgICAgICAgICAgICAgIHRvdGFsQXR0cmlidXRlICo9ICgxIC0gYWJpbGl0eS5hdHRyaWJ1dGVzWzBdLnZhbHVlWzBdLzEwMCk7XG4gICAgICAgICAgICB9XG4gICAgICAgIH1cbiAgICAgICAgcmV0dXJuIHRvdGFsQXR0cmlidXRlO1xuICAgIH0sXG4gICAgZ2V0UmVzcGF3blJlZHVjdGlvbjogZnVuY3Rpb24gKHRhbGVudHMpIHtcbiAgICAgICAgdmFyIHRvdGFsQXR0cmlidXRlID0gMDtcbiAgICAgICAgZm9yICh2YXIgaSA9IDA7IGkgPCB0YWxlbnRzLmxlbmd0aDsgaSsrKSB7XG4gICAgICAgICAgICB2YXIgYWJpbGl0eSA9IHRhbGVudHNbaV07XG4gICAgICAgICAgICBpZiAoYWJpbGl0eS5uYW1lLnN0YXJ0c1dpdGgoJ3NwZWNpYWxfYm9udXNfcmVzcGF3bl9yZWR1Y3Rpb25fJykpIHtcbiAgICAgICAgICAgICAgICB0b3RhbEF0dHJpYnV0ZSArPSBhYmlsaXR5LmF0dHJpYnV0ZXNbMF0udmFsdWVbMF07XG4gICAgICAgICAgICB9XG4gICAgICAgIH1cbiAgICAgICAgcmV0dXJuIHRvdGFsQXR0cmlidXRlO1xuICAgIH0sXG4gICAgZ2V0U3RyZW5ndGg6IGZ1bmN0aW9uICh0YWxlbnRzKSB7XG4gICAgICAgIHZhciB0b3RhbEF0dHJpYnV0ZSA9IDA7XG4gICAgICAgIGZvciAodmFyIGkgPSAwOyBpIDwgdGFsZW50cy5sZW5ndGg7IGkrKykge1xuICAgICAgICAgICAgdmFyIGFiaWxpdHkgPSB0YWxlbnRzW2ldO1xuICAgICAgICAgICAgaWYgKGFiaWxpdHkubmFtZS5zdGFydHNXaXRoKCdzcGVjaWFsX2JvbnVzX3N0cmVuZ3RoXycpKSB7XG4gICAgICAgICAgICAgICAgdG90YWxBdHRyaWJ1dGUgKz0gYWJpbGl0eS5hdHRyaWJ1dGVzWzBdLnZhbHVlWzBdO1xuICAgICAgICAgICAgfVxuICAgICAgICAgICAgZWxzZSBpZiAoYWJpbGl0eS5uYW1lLnN0YXJ0c1dpdGgoJ3NwZWNpYWxfYm9udXNfYWxsX3N0YXRzXycpKSB7XG4gICAgICAgICAgICAgICAgdG90YWxBdHRyaWJ1dGUgKz0gYWJpbGl0eS5hdHRyaWJ1dGVzWzBdLnZhbHVlWzBdO1xuICAgICAgICAgICAgfVxuICAgICAgICB9XG4gICAgICAgIHJldHVybiB0b3RhbEF0dHJpYnV0ZTtcbiAgICB9LFxuICAgIGdldEFnaWxpdHk6IGZ1bmN0aW9uICh0YWxlbnRzKSB7XG4gICAgICAgIHZhciB0b3RhbEF0dHJpYnV0ZSA9IDA7XG4gICAgICAgIGZvciAodmFyIGkgPSAwOyBpIDwgdGFsZW50cy5sZW5ndGg7IGkrKykge1xuICAgICAgICAgICAgdmFyIGFiaWxpdHkgPSB0YWxlbnRzW2ldO1xuICAgICAgICAgICAgaWYgKGFiaWxpdHkubmFtZS5zdGFydHNXaXRoKCdzcGVjaWFsX2JvbnVzX2FnaWxpdHlfJykpIHtcbiAgICAgICAgICAgICAgICB0b3RhbEF0dHJpYnV0ZSArPSBhYmlsaXR5LmF0dHJpYnV0ZXNbMF0udmFsdWVbMF07XG4gICAgICAgICAgICB9XG4gICAgICAgICAgICBlbHNlIGlmIChhYmlsaXR5Lm5hbWUuc3RhcnRzV2l0aCgnc3BlY2lhbF9ib251c19hbGxfc3RhdHNfJykpIHtcbiAgICAgICAgICAgICAgICB0b3RhbEF0dHJpYnV0ZSArPSBhYmlsaXR5LmF0dHJpYnV0ZXNbMF0udmFsdWVbMF07XG4gICAgICAgICAgICB9XG4gICAgICAgIH1cbiAgICAgICAgcmV0dXJuIHRvdGFsQXR0cmlidXRlO1xuICAgIH0sXG4gICAgZ2V0SW50ZWxsaWdlbmNlOiBmdW5jdGlvbiAodGFsZW50cykge1xuICAgICAgICB2YXIgdG90YWxBdHRyaWJ1dGUgPSAwO1xuICAgICAgICBmb3IgKHZhciBpID0gMDsgaSA8IHRhbGVudHMubGVuZ3RoOyBpKyspIHtcbiAgICAgICAgICAgIHZhciBhYmlsaXR5ID0gdGFsZW50c1tpXTtcbiAgICAgICAgICAgIGlmIChhYmlsaXR5Lm5hbWUuc3RhcnRzV2l0aCgnc3BlY2lhbF9ib251c19pbnRlbGxpZ2VuY2VfJykpIHtcbiAgICAgICAgICAgICAgICB0b3RhbEF0dHJpYnV0ZSArPSBhYmlsaXR5LmF0dHJpYnV0ZXNbMF0udmFsdWVbMF07XG4gICAgICAgICAgICB9XG4gICAgICAgICAgICBlbHNlIGlmIChhYmlsaXR5Lm5hbWUuc3RhcnRzV2l0aCgnc3BlY2lhbF9ib251c19hbGxfc3RhdHNfJykpIHtcbiAgICAgICAgICAgICAgICB0b3RhbEF0dHJpYnV0ZSArPSBhYmlsaXR5LmF0dHJpYnV0ZXNbMF0udmFsdWVbMF07XG4gICAgICAgICAgICB9XG4gICAgICAgIH1cbiAgICAgICAgcmV0dXJuIHRvdGFsQXR0cmlidXRlO1xuICAgIH1cbn0iLCIndXNlIHN0cmljdCc7XG52YXIga28gPSByZXF1aXJlKCcuLi9oZXJvY2FsY19rbm9ja291dCcpO1xuXG52YXIgQWJpbGl0eU1vZGVsID0gcmVxdWlyZShcIi4uL0FiaWxpdHlNb2RlbFwiKTtcbnZhciBIZXJvTW9kZWwgPSByZXF1aXJlKFwiLi9IZXJvTW9kZWxcIik7XG5cbnZhciBVbml0TW9kZWwgPSBmdW5jdGlvbiAoaGVyb0RhdGEsIGl0ZW1EYXRhLCB1bml0RGF0YSwgaCwgcCkge1xuICAgIHZhciBzZWxmID0gdGhpcztcbiAgICBIZXJvTW9kZWwuY2FsbCh0aGlzLCBoZXJvRGF0YSwgaXRlbURhdGEsICdhYmFkZG9uJyk7XG4gICAgc2VsZi5wYXJlbnQgPSBwO1xuICAgIHNlbGYudW5pdElkID0ga28ub2JzZXJ2YWJsZShoKTtcbiAgICBzZWxmLnVuaXRMZXZlbCA9IGtvLm9ic2VydmFibGUoMSk7XG5cbiAgICBzZWxmLmhlcm9EYXRhID0ga28uY29tcHV0ZWQoZnVuY3Rpb24oKSB7XG4gICAgICAgIHJldHVybiB1bml0RGF0YVtzZWxmLnVuaXRJZCgpXTtcbiAgICB9KTtcbiAgICBzZWxmLmdldEFiaWxpdHlMZXZlbE1heCA9IGZ1bmN0aW9uKGRhdGEpIHtcbiAgICAgICAgaWYgKGRhdGEuYWJpbGl0eXR5cGUgPT0gJ0RPVEFfQUJJTElUWV9UWVBFX0FUVFJJQlVURVMnKSB7XG4gICAgICAgICAgICByZXR1cm4gMTA7XG4gICAgICAgIH1cbiAgICAgICAgZWxzZSBpZiAoZGF0YS5uYW1lID09ICduZWNyb25vbWljb25fYXJjaGVyX21hbmFfYnVybicgfHwgZGF0YS5uYW1lID09ICduZWNyb25vbWljb25fYXJjaGVyX2FvZSdcbiAgICAgICAgICAgIHx8IGRhdGEubmFtZSA9PSAnbmVjcm9ub21pY29uX3dhcnJpb3JfbWFuYV9idXJuJyB8fCBkYXRhLm5hbWUgPT0gJ25lY3Jvbm9taWNvbl93YXJyaW9yX2xhc3Rfd2lsbCcpIHtcbiAgICAgICAgICAgIHJldHVybiAzO1xuICAgICAgICB9XG4gICAgICAgIGVsc2UgaWYgKGRhdGEubmFtZSA9PSAnbmVjcm9ub21pY29uX3dhcnJpb3Jfc2lnaHQnKSB7XG4gICAgICAgICAgICByZXR1cm4gMTtcbiAgICAgICAgfVxuICAgICAgICBlbHNlIHtcbiAgICAgICAgICAgIHJldHVybiA0O1xuICAgICAgICB9XG4gICAgfTtcbiAgICBzZWxmLmF2YWlsYWJsZVNraWxsUG9pbnRzLmRpc3Bvc2UoKTtcbiAgICBzZWxmLmFiaWxpdHkgPSBrby5jb21wdXRlZChmdW5jdGlvbigpIHtcbiAgICAgICAgdmFyIGEgPSBuZXcgQWJpbGl0eU1vZGVsKGtvLm9ic2VydmFibGVBcnJheShKU09OLnBhcnNlKEpTT04uc3RyaW5naWZ5KHNlbGYuaGVyb0RhdGEoKS5hYmlsaXRpZXMpKSksIHNlbGYpO1xuICAgICAgICBhLmhhc1NjZXB0ZXIgPSBzZWxmLmludmVudG9yeS5oYXNTY2VwdGVyXG4gICAgICAgIHN3aXRjaCAoc2VsZi51bml0SWQoKSkge1xuICAgICAgICAgICAgY2FzZSAnbnBjX2RvdGFfbmVjcm9ub21pY29uX2FyY2hlcl8xJzpcbiAgICAgICAgICAgIGNhc2UgJ25wY19kb3RhX25lY3Jvbm9taWNvbl93YXJyaW9yXzEnOlxuICAgICAgICAgICAgICAgIGEuYWJpbGl0aWVzKClbMF0ubGV2ZWwoMSk7XG4gICAgICAgICAgICAgICAgYS5hYmlsaXRpZXMoKVsxXS5sZXZlbCgxKTtcbiAgICAgICAgICAgIGJyZWFrO1xuICAgICAgICAgICAgY2FzZSAnbnBjX2RvdGFfbmVjcm9ub21pY29uX2FyY2hlcl8yJzpcbiAgICAgICAgICAgIGNhc2UgJ25wY19kb3RhX25lY3Jvbm9taWNvbl93YXJyaW9yXzInOlxuICAgICAgICAgICAgICAgIGEuYWJpbGl0aWVzKClbMF0ubGV2ZWwoMik7XG4gICAgICAgICAgICAgICAgYS5hYmlsaXRpZXMoKVsxXS5sZXZlbCgyKTtcbiAgICAgICAgICAgIGJyZWFrO1xuICAgICAgICAgICAgY2FzZSAnbnBjX2RvdGFfbmVjcm9ub21pY29uX2FyY2hlcl8zJzpcbiAgICAgICAgICAgICAgICBhLmFiaWxpdGllcygpWzBdLmxldmVsKDMpO1xuICAgICAgICAgICAgICAgIGEuYWJpbGl0aWVzKClbMV0ubGV2ZWwoMyk7XG4gICAgICAgICAgICBicmVhaztcbiAgICAgICAgICAgIGNhc2UgJ25wY19kb3RhX25lY3Jvbm9taWNvbl93YXJyaW9yXzMnOlxuICAgICAgICAgICAgICAgIGEuYWJpbGl0aWVzKClbMF0ubGV2ZWwoMyk7XG4gICAgICAgICAgICAgICAgYS5hYmlsaXRpZXMoKVsxXS5sZXZlbCgzKTtcbiAgICAgICAgICAgICAgICBhLmFiaWxpdGllcygpWzJdLmxldmVsKDEpO1xuICAgICAgICAgICAgYnJlYWs7XG4gICAgICAgIH1cbiAgICAgICAgYS5sZXZlbFVwQWJpbGl0eSA9IGZ1bmN0aW9uKGluZGV4LCBkYXRhLCBldmVudCwgaGVybykge1xuICAgICAgICAgICAgdmFyIGkgPSBrby51dGlscy51bndyYXBPYnNlcnZhYmxlKGluZGV4KTtcbiAgICAgICAgICAgIHN3aXRjaCAoYS5hYmlsaXRpZXMoKVtpXS5uYW1lKSB7XG4gICAgICAgICAgICAgICAgY2FzZSAnbmVjcm9ub21pY29uX2FyY2hlcl9tYW5hX2J1cm4nOlxuICAgICAgICAgICAgICAgIGNhc2UgJ25lY3Jvbm9taWNvbl9hcmNoZXJfYW9lJzpcbiAgICAgICAgICAgICAgICBjYXNlICduZWNyb25vbWljb25fd2Fycmlvcl9tYW5hX2J1cm4nOlxuICAgICAgICAgICAgICAgIGNhc2UgJ25lY3Jvbm9taWNvbl93YXJyaW9yX2xhc3Rfd2lsbCc6XG4gICAgICAgICAgICAgICAgY2FzZSAnbmVjcm9ub21pY29uX3dhcnJpb3Jfc2lnaHQnOlxuICAgICAgICAgICAgICAgIGJyZWFrO1xuICAgICAgICAgICAgICAgIGRlZmF1bHQ6XG4gICAgICAgICAgICAgICAgICAgIGlmIChhLmFiaWxpdGllcygpW2ldLmxldmVsKCkgPCBoZXJvLmdldEFiaWxpdHlMZXZlbE1heChkYXRhKSkge1xuICAgICAgICAgICAgICAgICAgICAgICAgYS5hYmlsaXRpZXMoKVtpXS5sZXZlbChhLmFiaWxpdGllcygpW2ldLmxldmVsKCkrMSk7XG4gICAgICAgICAgICAgICAgICAgIH0gICAgICAgICAgICAgICAgICAgIFxuICAgICAgICAgICAgICAgIGJyZWFrO1xuICAgICAgICAgICAgfVxuXG4gICAgICAgIH07XG4gICAgICAgIGEubGV2ZWxEb3duQWJpbGl0eSA9IGZ1bmN0aW9uKGluZGV4LCBkYXRhLCBldmVudCwgaGVybykgeyAgICAgICAgICAgIFxuICAgICAgICAgICAgdmFyIGkgPSBrby51dGlscy51bndyYXBPYnNlcnZhYmxlKGluZGV4KTtcbiAgICAgICAgICAgIHN3aXRjaCAoYS5hYmlsaXRpZXMoKVtpXS5uYW1lKSB7XG4gICAgICAgICAgICAgICAgY2FzZSAnbmVjcm9ub21pY29uX2FyY2hlcl9tYW5hX2J1cm4nOlxuICAgICAgICAgICAgICAgIGNhc2UgJ25lY3Jvbm9taWNvbl9hcmNoZXJfYW9lJzpcbiAgICAgICAgICAgICAgICBjYXNlICduZWNyb25vbWljb25fd2Fycmlvcl9tYW5hX2J1cm4nOlxuICAgICAgICAgICAgICAgIGNhc2UgJ25lY3Jvbm9taWNvbl93YXJyaW9yX2xhc3Rfd2lsbCc6XG4gICAgICAgICAgICAgICAgY2FzZSAnbmVjcm9ub21pY29uX3dhcnJpb3Jfc2lnaHQnOlxuICAgICAgICAgICAgICAgIGJyZWFrO1xuICAgICAgICAgICAgICAgIGRlZmF1bHQ6XG4gICAgICAgICAgICAgICAgICAgIGlmIChhLmFiaWxpdGllcygpW2ldLmxldmVsKCk+MCkge1xuICAgICAgICAgICAgICAgICAgICAgICAgYS5hYmlsaXRpZXMoKVtpXS5sZXZlbChhLmFiaWxpdGllcygpW2ldLmxldmVsKCktMSk7XG4gICAgICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgICBicmVhaztcbiAgICAgICAgICAgIH1cbiAgICAgICAgfTtcbiAgICAgICAgcmV0dXJuIGE7XG4gICAgfSk7ICAgICAgICBcbiAgICBzZWxmLnByaW1hcnlBdHRyaWJ1dGUgPSBrby5jb21wdXRlZChmdW5jdGlvbigpIHtcbiAgICAgICAgLy92YXIgdiA9IHVuaXREYXRhW3NlbGYudW5pdElkKCldLmF0dHJpYnV0ZXByaW1hcnk7XG4gICAgICAgIHZhciB2ID0gMDtcbiAgICAgICAgaWYgKHYgPT0gJ0RPVEFfQVRUUklCVVRFX0FHSUxJVFknKSB7XG4gICAgICAgICAgICByZXR1cm4gJ2FnaSdcbiAgICAgICAgfVxuICAgICAgICBlbHNlIGlmICh2ID09ICdET1RBX0FUVFJJQlVURV9JTlRFTExFQ1QnKSB7XG4gICAgICAgICAgICByZXR1cm4gJ2ludCdcbiAgICAgICAgfVxuICAgICAgICBlbHNlIGlmICh2ID09ICdET1RBX0FUVFJJQlVURV9TVFJFTkdUSCcpIHtcbiAgICAgICAgICAgIHJldHVybiAnc3RyJ1xuICAgICAgICB9XG4gICAgICAgIGVsc2Uge1xuICAgICAgICAgICAgcmV0dXJuICcnXG4gICAgICAgIH1cbiAgICB9KTtcbiAgICBzZWxmLnRvdGFsQXR0cmlidXRlID0gZnVuY3Rpb24oYSkge1xuICAgICAgICBpZiAoYSA9PSAnYWdpJykge1xuICAgICAgICAgICAgcmV0dXJuIHBhcnNlRmxvYXQoc2VsZi50b3RhbEFnaSgpKTtcbiAgICAgICAgfVxuICAgICAgICBpZiAoYSA9PSAnaW50Jykge1xuICAgICAgICAgICAgcmV0dXJuIHBhcnNlRmxvYXQoc2VsZi50b3RhbEludCgpKTtcbiAgICAgICAgfVxuICAgICAgICBpZiAoYSA9PSAnc3RyJykge1xuICAgICAgICAgICAgcmV0dXJuIHBhcnNlRmxvYXQoc2VsZi50b3RhbFN0cigpKTtcbiAgICAgICAgfVxuICAgICAgICByZXR1cm4gMDtcbiAgICB9O1xuICAgIHNlbGYudG90YWxBZ2kgPSBrby5jb21wdXRlZChmdW5jdGlvbigpIHtcbiAgICAgICAgcmV0dXJuICh1bml0RGF0YVtzZWxmLnVuaXRJZCgpXS5hdHRyaWJ1dGViYXNlYWdpbGl0eVxuICAgICAgICAgICAgICAgICsgdW5pdERhdGFbc2VsZi51bml0SWQoKV0uYXR0cmlidXRlYWdpbGl0eWdhaW4gKiAoc2VsZi5zZWxlY3RlZEhlcm9MZXZlbCgpIC0gMSkgXG4gICAgICAgICAgICAgICAgLy8rIHNlbGYuaW52ZW50b3J5LmdldEF0dHJpYnV0ZXMoJ2FnaScpIFxuICAgICAgICAgICAgICAgICsgc2VsZi5hYmlsaXR5KCkuZ2V0QXR0cmlidXRlQm9udXNMZXZlbCgpKjJcbiAgICAgICAgICAgICAgICArIHNlbGYuYWJpbGl0eSgpLmdldEFnaWxpdHkoKVxuICAgICAgICAgICAgICAgICsgc2VsZi5lbmVteSgpLmFiaWxpdHkoKS5nZXRBbGxTdGF0c1JlZHVjdGlvbigpXG4gICAgICAgICAgICAgICAgKyBzZWxmLmRlYnVmZnMuZ2V0QWxsU3RhdHNSZWR1Y3Rpb24oKVxuICAgICAgICAgICAgICAgKS50b0ZpeGVkKDIpO1xuICAgIH0pO1xuICAgIHNlbGYudG90YWxJbnQgPSBrby5jb21wdXRlZChmdW5jdGlvbigpIHtcbiAgICAgICAgcmV0dXJuICh1bml0RGF0YVtzZWxmLnVuaXRJZCgpXS5hdHRyaWJ1dGViYXNlaW50ZWxsaWdlbmNlIFxuICAgICAgICAgICAgICAgICsgdW5pdERhdGFbc2VsZi51bml0SWQoKV0uYXR0cmlidXRlaW50ZWxsaWdlbmNlZ2FpbiAqIChzZWxmLnNlbGVjdGVkSGVyb0xldmVsKCkgLSAxKSBcbiAgICAgICAgICAgICAgICAvLysgc2VsZi5pbnZlbnRvcnkuZ2V0QXR0cmlidXRlcygnaW50JykgXG4gICAgICAgICAgICAgICAgKyBzZWxmLmFiaWxpdHkoKS5nZXRBdHRyaWJ1dGVCb251c0xldmVsKCkqMlxuICAgICAgICAgICAgICAgICsgc2VsZi5hYmlsaXR5KCkuZ2V0SW50ZWxsaWdlbmNlKClcbiAgICAgICAgICAgICAgICArIHNlbGYuZW5lbXkoKS5hYmlsaXR5KCkuZ2V0QWxsU3RhdHNSZWR1Y3Rpb24oKVxuICAgICAgICAgICAgICAgICsgc2VsZi5kZWJ1ZmZzLmdldEFsbFN0YXRzUmVkdWN0aW9uKClcbiAgICAgICAgICAgICAgICkudG9GaXhlZCgyKTtcbiAgICB9KTtcbiAgICBzZWxmLnRvdGFsU3RyID0ga28uY29tcHV0ZWQoZnVuY3Rpb24oKSB7XG4gICAgICAgIHJldHVybiAodW5pdERhdGFbc2VsZi51bml0SWQoKV0uYXR0cmlidXRlYmFzZXN0cmVuZ3RoIFxuICAgICAgICAgICAgICAgICsgdW5pdERhdGFbc2VsZi51bml0SWQoKV0uYXR0cmlidXRlc3RyZW5ndGhnYWluICogKHNlbGYuc2VsZWN0ZWRIZXJvTGV2ZWwoKSAtIDEpIFxuICAgICAgICAgICAgICAgIC8vKyBzZWxmLmludmVudG9yeS5nZXRBdHRyaWJ1dGVzKCdzdHInKSBcbiAgICAgICAgICAgICAgICArIHNlbGYuYWJpbGl0eSgpLmdldEF0dHJpYnV0ZUJvbnVzTGV2ZWwoKSoyXG4gICAgICAgICAgICAgICAgKyBzZWxmLmFiaWxpdHkoKS5nZXRTdHJlbmd0aCgpXG4gICAgICAgICAgICAgICAgKyBzZWxmLmVuZW15KCkuYWJpbGl0eSgpLmdldEFsbFN0YXRzUmVkdWN0aW9uKClcbiAgICAgICAgICAgICAgICArIHNlbGYuZGVidWZmcy5nZXRBbGxTdGF0c1JlZHVjdGlvbigpXG4gICAgICAgICAgICAgICApLnRvRml4ZWQoMik7XG4gICAgfSk7XG4gICAgLypzZWxmLmhlYWx0aCA9IGtvLmNvbXB1dGVkKGZ1bmN0aW9uKCkge1xuICAgICAgICByZXR1cm4gKHVuaXREYXRhW3NlbGYudW5pdElkKCldLnN0YXR1c2hlYWx0aCArIHNlbGYudG90YWxTdHIoKSoxOSBcbiAgICAgICAgICAgICAgICArIHNlbGYuaW52ZW50b3J5LmdldEhlYWx0aCgpXG4gICAgICAgICAgICAgICAgKyBzZWxmLmFiaWxpdHkoKS5nZXRIZWFsdGgoKSkudG9GaXhlZCgyKTtcbiAgICB9KTtcbiAgICBzZWxmLmhlYWx0aHJlZ2VuID0ga28uY29tcHV0ZWQoZnVuY3Rpb24oKSB7XG4gICAgICAgIHJldHVybiAodW5pdERhdGFbc2VsZi51bml0SWQoKV0uc3RhdHVzaGVhbHRocmVnZW4gKyBzZWxmLnRvdGFsU3RyKCkqLjAzIFxuICAgICAgICAgICAgICAgICsgc2VsZi5pbnZlbnRvcnkuZ2V0SGVhbHRoUmVnZW4oKSBcbiAgICAgICAgICAgICAgICArIHNlbGYuYWJpbGl0eSgpLmdldEhlYWx0aFJlZ2VuKClcbiAgICAgICAgICAgICAgICArIHNlbGYuYnVmZnMuZ2V0SGVhbHRoUmVnZW4oKSkudG9GaXhlZCgyKTtcbiAgICB9KTtcbiAgICBzZWxmLm1hbmEgPSBrby5jb21wdXRlZChmdW5jdGlvbigpIHtcbiAgICAgICAgcmV0dXJuICh1bml0RGF0YVtzZWxmLnVuaXRJZCgpXS5zdGF0dXNtYW5hICsgc2VsZi50b3RhbEludCgpKjEzICsgc2VsZi5pbnZlbnRvcnkuZ2V0TWFuYSgpKS50b0ZpeGVkKDIpO1xuICAgIH0pO1xuICAgIHNlbGYubWFuYXJlZ2VuID0ga28uY29tcHV0ZWQoZnVuY3Rpb24oKSB7XG4gICAgICAgIHJldHVybiAoKHVuaXREYXRhW3NlbGYudW5pdElkKCldLnN0YXR1c21hbmFyZWdlbiBcbiAgICAgICAgICAgICAgICArIHNlbGYudG90YWxJbnQoKSouMDQgXG4gICAgICAgICAgICAgICAgKyBzZWxmLmFiaWxpdHkoKS5nZXRNYW5hUmVnZW4oKSkgXG4gICAgICAgICAgICAgICAgKiAoMSArIHNlbGYuaW52ZW50b3J5LmdldE1hbmFSZWdlblBlcmNlbnQoKSkgXG4gICAgICAgICAgICAgICAgKyAoc2VsZi5zZWxlY3RlZEhlcm8oKS5oZXJvTmFtZSA9PSAnY3J5c3RhbF9tYWlkZW4nID8gc2VsZi5hYmlsaXR5KCkuZ2V0TWFuYVJlZ2VuQXJjYW5lQXVyYSgpICogMiA6IHNlbGYuYnVmZnMuZ2V0TWFuYVJlZ2VuQXJjYW5lQXVyYSgpKVxuICAgICAgICAgICAgICAgICsgc2VsZi5pbnZlbnRvcnkuZ2V0TWFuYVJlZ2VuQmxvb2RzdG9uZSgpXG4gICAgICAgICAgICAgICAgLSBzZWxmLmVuZW15KCkuYWJpbGl0eSgpLmdldE1hbmFSZWdlblJlZHVjdGlvbigpKS50b0ZpeGVkKDIpO1xuICAgIH0pO1xuICAgIHNlbGYudG90YWxBcm1vclBoeXNpY2FsID0ga28uY29tcHV0ZWQoZnVuY3Rpb24oKSB7XG4gICAgICAgIHJldHVybiAoc2VsZi5lbmVteSgpLmFiaWxpdHkoKS5nZXRBcm1vckJhc2VSZWR1Y3Rpb24oKSAqIHNlbGYuZGVidWZmcy5nZXRBcm1vckJhc2VSZWR1Y3Rpb24oKSAqICh1bml0RGF0YVtzZWxmLnVuaXRJZCgpXS5hcm1vcnBoeXNpY2FsICsgc2VsZi50b3RhbEFnaSgpKi4xNClcbiAgICAgICAgICAgICAgICArIHNlbGYuaW52ZW50b3J5LmdldEFybW9yKCkgKyBzZWxmLmFiaWxpdHkoKS5nZXRBcm1vcigpICsgc2VsZi5lbmVteSgpLmFiaWxpdHkoKS5nZXRBcm1vclJlZHVjdGlvbigpICsgc2VsZi5idWZmcy5nZXRBcm1vcigpICsgc2VsZi5kZWJ1ZmZzLmdldEFybW9yUmVkdWN0aW9uKCkpLnRvRml4ZWQoMik7XG4gICAgfSk7XG4gICAgc2VsZi50b3RhbEFybW9yUGh5c2ljYWxSZWR1Y3Rpb24gPSBrby5jb21wdXRlZChmdW5jdGlvbigpIHtcbiAgICAgICAgcmV0dXJuICgoMC4wNiAqIHNlbGYudG90YWxBcm1vclBoeXNpY2FsKCkpIC8gKDEgKyAwLjA2ICogc2VsZi50b3RhbEFybW9yUGh5c2ljYWwoKSkgKiAxMDApLnRvRml4ZWQoMik7XG4gICAgfSk7XG4gICAgc2VsZi50b3RhbE1vdmVtZW50U3BlZWQgPSBrby5jb21wdXRlZChmdW5jdGlvbigpIHtcbiAgICAgICAgaWYgKHNlbGYucGFyZW50LmFiaWxpdHkoKS5pc1NoYXBlU2hpZnRBY3RpdmUoKSkge1xuICAgICAgICAgICAgcmV0dXJuIDUyMjtcbiAgICAgICAgfVxuICAgICAgICB2YXIgbXMgPSAoc2VsZi5hYmlsaXR5KCkuc2V0TW92ZW1lbnRTcGVlZCgpID4gMCA/IHNlbGYuYWJpbGl0eSgpLnNldE1vdmVtZW50U3BlZWQoKSA6IHNlbGYuYnVmZnMuc2V0TW92ZW1lbnRTcGVlZCgpKTtcbiAgICAgICAgaWYgKG1zID4gMCkge1xuICAgICAgICAgICAgcmV0dXJuIG1zO1xuICAgICAgICB9XG4gICAgICAgIGVsc2Uge1xuICAgICAgICAgICAgcmV0dXJuICgodW5pdERhdGFbc2VsZi51bml0SWQoKV0ubW92ZW1lbnRzcGVlZCArIHNlbGYuaW52ZW50b3J5LmdldE1vdmVtZW50U3BlZWRGbGF0KCkrIHNlbGYuYWJpbGl0eSgpLmdldE1vdmVtZW50U3BlZWRGbGF0KCkpICogXG4gICAgICAgICAgICAgICAgICAgICgxICsgc2VsZi5pbnZlbnRvcnkuZ2V0TW92ZW1lbnRTcGVlZFBlcmNlbnQoKSBcbiAgICAgICAgICAgICAgICAgICAgICAgKyBzZWxmLmFiaWxpdHkoKS5nZXRNb3ZlbWVudFNwZWVkUGVyY2VudCgpIFxuICAgICAgICAgICAgICAgICAgICAgICArIHNlbGYuZW5lbXkoKS5pbnZlbnRvcnkuZ2V0TW92ZW1lbnRTcGVlZFBlcmNlbnRSZWR1Y3Rpb24oKSBcbiAgICAgICAgICAgICAgICAgICAgICAgKyBzZWxmLmVuZW15KCkuYWJpbGl0eSgpLmdldE1vdmVtZW50U3BlZWRQZXJjZW50UmVkdWN0aW9uKCkgXG4gICAgICAgICAgICAgICAgICAgICAgICsgc2VsZi5idWZmcy5nZXRNb3ZlbWVudFNwZWVkUGVyY2VudCgpIFxuICAgICAgICAgICAgICAgICAgICAgICArIHNlbGYuZGVidWZmcy5nZXRNb3ZlbWVudFNwZWVkUGVyY2VudFJlZHVjdGlvbigpXG4gICAgICAgICAgICAgICAgICAgICkpLnRvRml4ZWQoMik7XG4gICAgICAgIH1cbiAgICB9KTtcbiAgICBzZWxmLnRvdGFsVHVyblJhdGUgPSBrby5jb21wdXRlZChmdW5jdGlvbigpIHtcbiAgICAgICAgcmV0dXJuICh1bml0RGF0YVtzZWxmLnVuaXRJZCgpXS5tb3ZlbWVudHR1cm5yYXRlIFxuICAgICAgICAgICAgICAgICogKDEgKyBzZWxmLmVuZW15KCkuYWJpbGl0eSgpLmdldFR1cm5SYXRlUmVkdWN0aW9uKClcbiAgICAgICAgICAgICAgICAgICAgICsgc2VsZi5kZWJ1ZmZzLmdldFR1cm5SYXRlUmVkdWN0aW9uKCkpKS50b0ZpeGVkKDIpO1xuICAgIH0pO1xuICAgICovXG4gICAgc2VsZi5iYXNlRGFtYWdlID0ga28uY29tcHV0ZWQoZnVuY3Rpb24oKSB7XG4gICAgICAgIHJldHVybiBbTWF0aC5mbG9vcih1bml0RGF0YVtzZWxmLnVuaXRJZCgpXS5hdHRhY2tkYW1hZ2VtaW4gKyBzZWxmLnRvdGFsQXR0cmlidXRlKHNlbGYucHJpbWFyeUF0dHJpYnV0ZSgpKSArIHNlbGYuYWJpbGl0eSgpLmdldEJhc2VEYW1hZ2UoKS50b3RhbCksXG4gICAgICAgICAgICAgICAgTWF0aC5mbG9vcih1bml0RGF0YVtzZWxmLnVuaXRJZCgpXS5hdHRhY2tkYW1hZ2VtYXggKyBzZWxmLnRvdGFsQXR0cmlidXRlKHNlbGYucHJpbWFyeUF0dHJpYnV0ZSgpKSArIHNlbGYuYWJpbGl0eSgpLmdldEJhc2VEYW1hZ2UoKS50b3RhbCldO1xuICAgIH0pO1xuICAgIC8qc2VsZi5ib251c0RhbWFnZSA9IGtvLmNvbXB1dGVkKGZ1bmN0aW9uKCkge1xuICAgICAgICByZXR1cm4gc2VsZi5pbnZlbnRvcnkuZ2V0Qm9udXNEYW1hZ2UoKS50b3RhbFxuICAgICAgICAgICAgICAgICsgc2VsZi5hYmlsaXR5KCkuZ2V0Qm9udXNEYW1hZ2UoKS50b3RhbFxuICAgICAgICAgICAgICAgICsgc2VsZi5idWZmcy5nZXRCb251c0RhbWFnZSgpLnRvdGFsXG4gICAgICAgICAgICAgICAgKyBNYXRoLmZsb29yKChzZWxmLmJhc2VEYW1hZ2UoKVswXSArIHNlbGYuYmFzZURhbWFnZSgpWzFdKS8yIFxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgKiAoc2VsZi5pbnZlbnRvcnkuZ2V0Qm9udXNEYW1hZ2VQZXJjZW50KCkudG90YWxcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICsgc2VsZi5hYmlsaXR5KCkuZ2V0Qm9udXNEYW1hZ2VQZXJjZW50KCkudG90YWxcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICsgc2VsZi5idWZmcy5nZXRCb251c0RhbWFnZVBlcmNlbnQoKS50b3RhbFxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICApXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgKVxuICAgICAgICAgICAgICAgICsgTWF0aC5mbG9vcihcbiAgICAgICAgICAgICAgICAgICAgKHNlbGYuaGVybygpLmF0dGFja3R5cGUoKSA9PSAnRE9UQV9VTklUX0NBUF9SQU5HRURfQVRUQUNLJyBcbiAgICAgICAgICAgICAgICAgICAgICAgID8gKChzZWxmLnNlbGVjdGVkSGVybygpLmhlcm9OYW1lID09ICdkcm93X3JhbmdlcicpID8gc2VsZi5hYmlsaXR5KCkuZ2V0Qm9udXNEYW1hZ2VQcmVjaXNpb25BdXJhKCkudG90YWxbMF0gKiBzZWxmLnRvdGFsQWdpKCkgOiBzZWxmLmJ1ZmZzLmdldEJvbnVzRGFtYWdlUHJlY2lzaW9uQXVyYSgpLnRvdGFsWzFdKVxuICAgICAgICAgICAgICAgICAgICAgICAgOiAwKVxuICAgICAgICAgICAgICAgICAgKTtcbiAgICB9KTsqL1xuICAgIC8qc2VsZi5ib251c0RhbWFnZVJlZHVjdGlvbiA9IGtvLmNvbXB1dGVkKGZ1bmN0aW9uKCkge1xuICAgICAgICByZXR1cm4gTWF0aC5hYnMoc2VsZi5lbmVteSgpLmFiaWxpdHkoKS5nZXRCb251c0RhbWFnZVJlZHVjdGlvbigpICsgc2VsZi5kZWJ1ZmZzLmdldEJvbnVzRGFtYWdlUmVkdWN0aW9uKCkpO1xuICAgIH0pO1xuICAgIHNlbGYuZGFtYWdlID0ga28uY29tcHV0ZWQoZnVuY3Rpb24oKSB7XG4gICAgICAgIHJldHVybiBbc2VsZi5iYXNlRGFtYWdlKClbMF0gKyBzZWxmLmJvbnVzRGFtYWdlKClbMF0sXG4gICAgICAgICAgICAgICAgc2VsZi5iYXNlRGFtYWdlKClbMV0gKyBzZWxmLmJvbnVzRGFtYWdlKClbMV1dO1xuICAgIH0pOyovXG4gICAgc2VsZi50b3RhbE1hZ2ljUmVzaXN0YW5jZVByb2R1Y3QgPSBrby5jb21wdXRlZChmdW5jdGlvbigpIHtcbiAgICAgICAgcmV0dXJuICgxIC0gdW5pdERhdGFbc2VsZi51bml0SWQoKV0ubWFnaWNhbHJlc2lzdGFuY2UgLyAxMDApIFxuICAgICAgICAgICAgICAgICAgICogKDEgLSBzZWxmLmludmVudG9yeS5nZXRNYWdpY1Jlc2lzdCgpIC8gMTAwKSBcbiAgICAgICAgICAgICAgICAgICAqICgxIC0gc2VsZi5hYmlsaXR5KCkuZ2V0TWFnaWNSZXNpc3QoKSAvIDEwMCkgXG4gICAgICAgICAgICAgICAgICAgKiAoMSAtIHNlbGYuYnVmZnMuZ2V0TWFnaWNSZXNpc3QoKSAvIDEwMCkgXG4gICAgICAgICAgICAgICAgICAgKiBzZWxmLmVuZW15KCkuaW52ZW50b3J5LmdldE1hZ2ljUmVzaXN0UmVkdWN0aW9uKClcbiAgICAgICAgICAgICAgICAgICAqIHNlbGYuZW5lbXkoKS5hYmlsaXR5KCkuZ2V0TWFnaWNSZXNpc3RSZWR1Y3Rpb24oKSBcbiAgICAgICAgICAgICAgICAgICAqIHNlbGYuZGVidWZmcy5nZXRNYWdpY1Jlc2lzdFJlZHVjdGlvbigpO1xuICAgIH0pO1xuICAgIHNlbGYudG90YWxNYWdpY1Jlc2lzdGFuY2UgPSBrby5jb21wdXRlZChmdW5jdGlvbigpIHtcbiAgICAgICAgcmV0dXJuICgxIC0gc2VsZi50b3RhbE1hZ2ljUmVzaXN0YW5jZVByb2R1Y3QoKSk7XG4gICAgfSk7XG4gICAgc2VsZi5iYXQgPSBrby5jb21wdXRlZChmdW5jdGlvbigpIHtcbiAgICAgICAgdmFyIGFiaWxpdHlCQVQgPSBzZWxmLmFiaWxpdHkoKS5nZXRCQVQoKTtcbiAgICAgICAgaWYgKGFiaWxpdHlCQVQgPiAwKSB7XG4gICAgICAgICAgICByZXR1cm4gYWJpbGl0eUJBVDtcbiAgICAgICAgfVxuICAgICAgICByZXR1cm4gdW5pdERhdGFbc2VsZi51bml0SWQoKV0uYXR0YWNrcmF0ZTtcbiAgICB9KTtcbiAgICAvKlxuICAgIHNlbGYuaWFzID0ga28uY29tcHV0ZWQoZnVuY3Rpb24oKSB7XG4gICAgICAgIHZhciB2YWwgPSBwYXJzZUZsb2F0KHNlbGYudG90YWxBZ2koKSkgXG4gICAgICAgICAgICAgICAgKyBzZWxmLmludmVudG9yeS5nZXRBdHRhY2tTcGVlZCgpIFxuICAgICAgICAgICAgICAgICsgc2VsZi5hYmlsaXR5KCkuZ2V0QXR0YWNrU3BlZWQoKSBcbiAgICAgICAgICAgICAgICArIHNlbGYuZW5lbXkoKS5hYmlsaXR5KCkuZ2V0QXR0YWNrU3BlZWRSZWR1Y3Rpb24oKSBcbiAgICAgICAgICAgICAgICArIHNlbGYuYnVmZnMuZ2V0QXR0YWNrU3BlZWQoKSBcbiAgICAgICAgICAgICAgICArIHNlbGYuZGVidWZmcy5nZXRBdHRhY2tTcGVlZFJlZHVjdGlvbigpO1xuICAgICAgICBpZiAodmFsIDwgLTgwKSB7XG4gICAgICAgICAgICByZXR1cm4gLTgwO1xuICAgICAgICB9XG4gICAgICAgIGVsc2UgaWYgKHZhbCA+IDQwMCkge1xuICAgICAgICAgICAgcmV0dXJuIDQwMDtcbiAgICAgICAgfVxuICAgICAgICByZXR1cm4gKHZhbCkudG9GaXhlZCgyKTtcbiAgICB9KTsqL1xuICAgIHNlbGYuYXR0YWNrVGltZSA9IGtvLmNvbXB1dGVkKGZ1bmN0aW9uKCkge1xuICAgICAgICByZXR1cm4gKHNlbGYuYmF0KCkgLyAoMSArIHNlbGYuaWFzKCkgLyAxMDApKS50b0ZpeGVkKDIpO1xuICAgIH0pO1xuICAgIHNlbGYuYXR0YWNrc1BlclNlY29uZCA9IGtvLmNvbXB1dGVkKGZ1bmN0aW9uKCkge1xuICAgICAgICByZXR1cm4gKDEgKyBzZWxmLmlhcygpIC8gMTAwKSAvIHNlbGYuYmF0KCk7XG4gICAgfSk7XG4gICAgc2VsZi5ldmFzaW9uID0ga28uY29tcHV0ZWQoZnVuY3Rpb24oKSB7XG4gICAgICAgIHZhciBlID0gc2VsZi5hYmlsaXR5KCkuc2V0RXZhc2lvbigpO1xuICAgICAgICBpZiAoZSkge1xuICAgICAgICAgICAgcmV0dXJuIChlICogMTAwKS50b0ZpeGVkKDIpICsgJyUnO1xuICAgICAgICB9XG4gICAgICAgIGVsc2Uge1xuICAgICAgICAgICAgcmV0dXJuICgoMS0oc2VsZi5pbnZlbnRvcnkuZ2V0RXZhc2lvbigpICogc2VsZi5hYmlsaXR5KCkuZ2V0RXZhc2lvbigpKSkgKiAxMDApLnRvRml4ZWQoMikgKyAnJSc7XG4gICAgICAgIH1cbiAgICB9KTtcbiAgICBzZWxmLmVocFBoeXNpY2FsID0ga28uY29tcHV0ZWQoZnVuY3Rpb24oKSB7XG4gICAgICAgIHJldHVybiAoKHNlbGYuaGVhbHRoKCkgKiAoMSArIC4wNiAqIHNlbGYudG90YWxBcm1vclBoeXNpY2FsKCkpKSAvICgxLSgxLShzZWxmLmludmVudG9yeS5nZXRFdmFzaW9uKCkgKiBzZWxmLmFiaWxpdHkoKS5nZXRFdmFzaW9uKCkpKSkpLnRvRml4ZWQoMik7XG4gICAgfSk7XG4gICAgc2VsZi5laHBNYWdpY2FsID0ga28uY29tcHV0ZWQoZnVuY3Rpb24oKSB7XG4gICAgICAgIHJldHVybiAoc2VsZi5oZWFsdGgoKSAvIHNlbGYudG90YWxNYWdpY1Jlc2lzdGFuY2VQcm9kdWN0KCkpLnRvRml4ZWQoMik7XG4gICAgfSk7XG4gICAgc2VsZi5oZXJvSWQoaCk7XG4gICAgc2VsZi51bml0SWQuc3Vic2NyaWJlKGZ1bmN0aW9uIChuZXdWYWx1ZSkge1xuICAgICAgICBzZWxmLmhlcm9JZChuZXdWYWx1ZSk7XG4gICAgfSk7XG4gICAgcmV0dXJuIHNlbGY7XG59XG5Vbml0TW9kZWwucHJvdG90eXBlID0gT2JqZWN0LmNyZWF0ZShIZXJvTW9kZWwucHJvdG90eXBlKTtcblVuaXRNb2RlbC5wcm90b3R5cGUuY29uc3RydWN0b3IgPSBVbml0TW9kZWw7XG5cbm1vZHVsZS5leHBvcnRzID0gVW5pdE1vZGVsOyIsInZhciBVbml0T3B0aW9uID0gZnVuY3Rpb24gKG5hbWUsIGRpc3BsYXluYW1lLCBsZXZlbHMsIGltYWdlLCBsZXZlbCkge1xuICAgIHRoaXMuaGVyb05hbWUgPSBrby5jb21wdXRlZChmdW5jdGlvbigpIHtcbiAgICAgICAgcmV0dXJuIChsZXZlbHMgPiAwKSA/IG5hbWUgKyAobGV2ZWwoKSA8PSBsZXZlbHMgPyBsZXZlbCgpIDogMSkgOiBuYW1lO1xuICAgIH0pO1xuICAgIHRoaXMuaGVyb0Rpc3BsYXlOYW1lID0gZGlzcGxheW5hbWU7XG4gICAgdGhpcy5pbWFnZSA9IGltYWdlO1xuICAgIHRoaXMubGV2ZWxzID0gbGV2ZWxzO1xufTtcblxubW9kdWxlLmV4cG9ydHMgPSBVbml0T3B0aW9uOyIsInZhciBkaWZmUHJvcGVydGllcyA9IFtcbiAgICAndG90YWxBZ2knLFxuICAgICd0b3RhbEludCcsXG4gICAgJ3RvdGFsU3RyJyxcbiAgICAnaGVhbHRoJyxcbiAgICAnaGVhbHRocmVnZW4nLFxuICAgICdtYW5hJyxcbiAgICAnbWFuYXJlZ2VuJyxcbiAgICAndG90YWxBcm1vclBoeXNpY2FsJyxcbiAgICAndG90YWxBcm1vclBoeXNpY2FsUmVkdWN0aW9uJyxcbiAgICAndG90YWxNb3ZlbWVudFNwZWVkJyxcbiAgICAndG90YWxUdXJuUmF0ZScsXG4gICAgJ2Jhc2VEYW1hZ2UnLFxuICAgICdib251c0RhbWFnZScsXG4gICAgJ2JvbnVzRGFtYWdlUmVkdWN0aW9uJyxcbiAgICAnZGFtYWdlJyxcbiAgICAndG90YWxNYWdpY1Jlc2lzdGFuY2VQcm9kdWN0JyxcbiAgICAndG90YWxNYWdpY1Jlc2lzdGFuY2UnLFxuICAgICdiYXQnLFxuICAgICdpYXMnLFxuICAgICdhdHRhY2tUaW1lJyxcbiAgICAnYXR0YWNrc1BlclNlY29uZCcsXG4gICAgJ2V2YXNpb24nLFxuICAgICdlaHBQaHlzaWNhbCcsXG4gICAgJ2VocE1hZ2ljYWwnLFxuICAgICdiYXNoJyxcbiAgICAnY3JpdENoYW5jZScsXG4gICAgLy8nY3JpdERhbWFnZScsXG4gICAgJ21pc3NDaGFuY2UnLFxuICAgICd0b3RhbGF0dGFja3JhbmdlJyxcbiAgICAndmlzaW9ucmFuZ2VkYXknLFxuICAgICd2aXNpb25yYW5nZW5pZ2h0JyxcbiAgICAnbGlmZXN0ZWFsJ1xuXTtcblxubW9kdWxlLmV4cG9ydHMgPSBkaWZmUHJvcGVydGllczsiLCJ2YXIgSGVyb09wdGlvbiA9IHJlcXVpcmUoXCIuL0hlcm9PcHRpb25cIik7XG5cbnZhciBoZXJvT3B0aW9uc0FycmF5ID0ge307XG5cbnZhciBpbml0ID0gZnVuY3Rpb24gKGhlcm9EYXRhKSB7XG4gICAgaGVyb09wdGlvbnNBcnJheS5pdGVtcyA9IFtdO1xuICAgIGZvciAodmFyIGggaW4gaGVyb0RhdGEpIHtcbiAgICAgICAgaGVyb09wdGlvbnNBcnJheS5pdGVtcy5wdXNoKG5ldyBIZXJvT3B0aW9uKGgucmVwbGFjZSgnbnBjX2RvdGFfaGVyb18nLCAnJyksIGhlcm9EYXRhW2hdLmRpc3BsYXluYW1lKSk7XG4gICAgfVxuICAgIHJldHVybiBoZXJvT3B0aW9uc0FycmF5Lml0ZW1zO1xufVxuXG5oZXJvT3B0aW9uc0FycmF5LmluaXQgPSBpbml0O1xuXG5tb2R1bGUuZXhwb3J0cyA9IGhlcm9PcHRpb25zQXJyYXk7IiwidmFyIG5leHRMZXZlbEV4cCA9IFsyMDAsIDMwMCwgNDAwLCA1MDAsIDYwMCwgNjAwLCA4MDAsIDEwMDAsIDEwMDAsIDYwMCwgMjIwMCwgODAwLCAxNDAwLCAxNTAwLCAxNjAwLCAxNzAwLCAxODAwLCAxOTAwLCAyMDAwLCAyMTAwLCAyMjAwLCAyMzAwLCAyNDAwLCAyNTAwLCAnJm1kYXNoOyddO1xuXG5tb2R1bGUuZXhwb3J0cyA9IG5leHRMZXZlbEV4cDsiLCJ2YXIgdG90YWxFeHAgPSBbMCwgMjAwLCA1MDAsIDkwMCwgMTQwMCwgMjAwMCwgMjYwMCwgMzQwMCwgNDQwMCwgNTQwMCwgNjAwMCwgODIwMCwgOTAwMCwgMTA0MDAsIDExOTAwLCAxMzUwMCwgMTUyMDAsIDE3MDAwLCAxODkwMCwgMjA5MDAsIDIzMDAwLCAyNTIwMCwgMjc1MDAsIDI5OTAwLCAzMjQwMF07XG5cbm1vZHVsZS5leHBvcnRzID0gdG90YWxFeHA7IiwidmFyIGFiaWxpdHlEYXRhID0ge1xuICAgICdhbGNoZW1pc3RfYWNpZF9zcHJheSc6IFtcbiAgICAgICAge1xuICAgICAgICAgICAgbGFiZWw6ICdEdXJhdGlvbicsXG4gICAgICAgICAgICBjb250cm9sVHlwZTogJ2lucHV0J1xuICAgICAgICB9LFxuICAgICAgICB7XG4gICAgICAgICAgICBhdHRyaWJ1dGVOYW1lOiAnZGFtYWdlJyxcbiAgICAgICAgICAgIGxhYmVsOiAnVG90YWwgRGFtYWdlJyxcbiAgICAgICAgICAgIGNvbnRyb2xUeXBlOiAndGV4dCcsXG4gICAgICAgICAgICBmbjogZnVuY3Rpb24gKHYsIGEsIHBhcmVudCwgaW5kZXgsIGFiaWxpdHlNb2RlbCwgYWJpbGl0eSkge1xuICAgICAgICAgICAgICAgIHJldHVybiB2KmE7XG4gICAgICAgICAgICB9XG4gICAgICAgIH0sXG4gICAgICAgIHtcbiAgICAgICAgICAgIGF0dHJpYnV0ZU5hbWU6ICdhcm1vcl9yZWR1Y3Rpb24nLFxuICAgICAgICAgICAgbGFiZWw6ICdUb3RhbCBEYW1hZ2UnLFxuICAgICAgICAgICAgY29udHJvbFR5cGU6ICd0ZXh0JyxcbiAgICAgICAgICAgIGZuOiBmdW5jdGlvbiAodiwgYSwgcGFyZW50LCBpbmRleCwgYWJpbGl0eU1vZGVsLCBhYmlsaXR5KSB7XG4gICAgICAgICAgICAgICAgcmV0dXJuIC1hO1xuICAgICAgICAgICAgfSxcbiAgICAgICAgICAgIHJldHVyblByb3BlcnR5OiAnYXJtb3JSZWR1Y3Rpb24nXG4gICAgICAgIH1cbiAgICBdLFxuICAgICdhbGNoZW1pc3RfdW5zdGFibGVfY29uY29jdGlvbic6IFtcbiAgICAgICAge1xuICAgICAgICAgICAgbGFiZWw6ICdCcmV3IFRpbWUnLFxuICAgICAgICAgICAgY29udHJvbFR5cGU6ICdpbnB1dCdcbiAgICAgICAgfSxcbiAgICAgICAge1xuICAgICAgICAgICAgYXR0cmlidXRlTmFtZTogJ21heF9kYW1hZ2UnLFxuICAgICAgICAgICAgbGFiZWw6ICdUb3RhbCBEYW1hZ2UnLFxuICAgICAgICAgICAgY29udHJvbFR5cGU6ICd0ZXh0JyxcbiAgICAgICAgICAgIGZuOiBmdW5jdGlvbiAodiwgYSwgcGFyZW50LCBpbmRleCwgYWJpbGl0eU1vZGVsLCBhYmlsaXR5KSB7XG4gICAgICAgICAgICAgICAgcmV0dXJuIHYqYS81O1xuICAgICAgICAgICAgfVxuICAgICAgICB9LFxuICAgICAgICB7XG4gICAgICAgICAgICBhdHRyaWJ1dGVOYW1lOiAnbWF4X3N0dW4nLFxuICAgICAgICAgICAgbGFiZWw6ICdUb3RhbCBTdHVuJyxcbiAgICAgICAgICAgIGNvbnRyb2xUeXBlOiAndGV4dCcsXG4gICAgICAgICAgICBmbjogZnVuY3Rpb24gKHYsIGEsIHBhcmVudCwgaW5kZXgsIGFiaWxpdHlNb2RlbCwgYWJpbGl0eSkge1xuICAgICAgICAgICAgICAgIHJldHVybiB2KmEvNTtcbiAgICAgICAgICAgIH1cbiAgICAgICAgfVxuICAgIF0sXG4gICAgJ2FuY2llbnRfYXBwYXJpdGlvbl9jb2xkX2ZlZXQnOiBbXG4gICAgICAgIHtcbiAgICAgICAgICAgIGxhYmVsOiAnRHVyYXRpb24nLFxuICAgICAgICAgICAgY29udHJvbFR5cGU6ICdpbnB1dCdcbiAgICAgICAgfSxcbiAgICAgICAge1xuICAgICAgICAgICAgYXR0cmlidXRlTmFtZTogJ2RhbWFnZScsXG4gICAgICAgICAgICBsYWJlbDogJ1RvdGFsIERhbWFnZScsXG4gICAgICAgICAgICBjb250cm9sVHlwZTogJ3RleHQnLFxuICAgICAgICAgICAgZm46IGZ1bmN0aW9uICh2LCBhLCBwYXJlbnQsIGluZGV4LCBhYmlsaXR5TW9kZWwsIGFiaWxpdHkpIHtcbiAgICAgICAgICAgICAgICByZXR1cm4gdiphO1xuICAgICAgICAgICAgfVxuICAgICAgICB9LFxuICAgICAgICB7XG4gICAgICAgICAgICBhdHRyaWJ1dGVOYW1lOiAnc3R1bl9kdXJhdGlvbicsXG4gICAgICAgICAgICBsYWJlbDogJ1RvdGFsIFN0dW4nLFxuICAgICAgICAgICAgY29udHJvbFR5cGU6ICd0ZXh0JyxcbiAgICAgICAgICAgIGZuOiBmdW5jdGlvbiAodiwgYSwgcGFyZW50LCBpbmRleCwgYWJpbGl0eU1vZGVsLCBhYmlsaXR5KSB7XG4gICAgICAgICAgICAgICAgcmV0dXJuIGE7XG4gICAgICAgICAgICB9XG4gICAgICAgIH1cbiAgICBdLFxuICAgICdhbmNpZW50X2FwcGFyaXRpb25faWNlX2JsYXN0JzogW1xuICAgICAgICB7XG4gICAgICAgICAgICBsYWJlbDogJ0R1cmF0aW9uJyxcbiAgICAgICAgICAgIGNvbnRyb2xUeXBlOiAnaW5wdXQnXG4gICAgICAgIH0sXG4gICAgICAgIHtcbiAgICAgICAgICAgIGF0dHJpYnV0ZU5hbWU6ICdkb3RfZGFtYWdlJyxcbiAgICAgICAgICAgIGxhYmVsOiAnVG90YWwgRGFtYWdlJyxcbiAgICAgICAgICAgIGNvbnRyb2xUeXBlOiAndGV4dCcsXG4gICAgICAgICAgICBmbjogZnVuY3Rpb24gKHYsIGEsIHBhcmVudCwgaW5kZXgsIGFiaWxpdHlNb2RlbCwgYWJpbGl0eSkge1xuICAgICAgICAgICAgICAgIHJldHVybiBhYmlsaXR5TW9kZWwuZ2V0QWJpbGl0eVByb3BlcnR5VmFsdWUoYWJpbGl0eSwgJ2RhbWFnZScpK3YqYTtcbiAgICAgICAgICAgIH1cbiAgICAgICAgfVxuICAgIF0sXG4gICAgJ2FudGltYWdlX21hbmFfdm9pZCc6IFtcbiAgICAgICAge1xuICAgICAgICAgICAgbGFiZWw6ICdFbmVteSBNaXNzaW5nIE1hbmEnLFxuICAgICAgICAgICAgY29udHJvbFR5cGU6ICdpbnB1dCdcbiAgICAgICAgfSxcbiAgICAgICAge1xuICAgICAgICAgICAgYXR0cmlidXRlTmFtZTogJ21hbmFfdm9pZF9kYW1hZ2VfcGVyX21hbmEnLFxuICAgICAgICAgICAgbGFiZWw6ICdUb3RhbCBEYW1hZ2UnLFxuICAgICAgICAgICAgY29udHJvbFR5cGU6ICd0ZXh0JyxcbiAgICAgICAgICAgIGZuOiBmdW5jdGlvbiAodiwgYSwgcGFyZW50LCBpbmRleCwgYWJpbGl0eU1vZGVsLCBhYmlsaXR5KSB7XG4gICAgICAgICAgICAgICAgcmV0dXJuIHYqYTtcbiAgICAgICAgICAgIH1cbiAgICAgICAgfVxuICAgIF0sXG4gICAgJ2F4ZV9iYXR0bGVfaHVuZ2VyJzogW1xuICAgICAgICB7XG4gICAgICAgICAgICBsYWJlbDogJ0JhdHRsZSBIdW5nZXJlZCBFbmVtaWVzJyxcbiAgICAgICAgICAgIGNvbnRyb2xUeXBlOiAnaW5wdXQnXG4gICAgICAgIH0sXG4gICAgICAgIHtcbiAgICAgICAgICAgIGF0dHJpYnV0ZU5hbWU6ICdzcGVlZF9ib251cycsXG4gICAgICAgICAgICBsYWJlbDogJ01vdmVtZW50IFNwZWVkIEJvbnVzJyxcbiAgICAgICAgICAgIGNvbnRyb2xUeXBlOiAndGV4dCcsXG4gICAgICAgICAgICBub0xldmVsOiB0cnVlLFxuICAgICAgICAgICAgZm46IGZ1bmN0aW9uICh2LCBhLCBwYXJlbnQsIGluZGV4LCBhYmlsaXR5TW9kZWwsIGFiaWxpdHkpIHtcbiAgICAgICAgICAgICAgICByZXR1cm4gdiphO1xuICAgICAgICAgICAgfSxcbiAgICAgICAgICAgIHJldHVyblByb3BlcnR5OiAnbW92ZW1lbnRTcGVlZFBjdCdcbiAgICAgICAgfSxcbiAgICAgICAge1xuICAgICAgICAgICAgYXR0cmlidXRlTmFtZTogJ3Nsb3cnLFxuICAgICAgICAgICAgbGFiZWw6ICdNb3ZlbWVudCBTcGVlZCBCb251cycsXG4gICAgICAgICAgICBjb250cm9sVHlwZTogJ3RleHQnLFxuICAgICAgICAgICAgbm9MZXZlbDogdHJ1ZSxcbiAgICAgICAgICAgIGZuOiBmdW5jdGlvbiAodiwgYSwgcGFyZW50LCBpbmRleCwgYWJpbGl0eU1vZGVsLCBhYmlsaXR5KSB7XG4gICAgICAgICAgICAgICAgcmV0dXJuIGE7XG4gICAgICAgICAgICB9LFxuICAgICAgICAgICAgcmV0dXJuUHJvcGVydHk6ICdtb3ZlbWVudFNwZWVkUGN0UmVkdWN0aW9uJ1xuICAgICAgICB9XG4gICAgXSxcbiAgICAnYmFuZV9uaWdodG1hcmUnOiBbXG4gICAgICAgIHtcbiAgICAgICAgICAgIGxhYmVsOiAnRHVyYXRpb24nLFxuICAgICAgICAgICAgY29udHJvbFR5cGU6ICdpbnB1dCdcbiAgICAgICAgfSxcbiAgICAgICAge1xuICAgICAgICAgICAgbGFiZWw6ICdEQU1BR0U6JyxcbiAgICAgICAgICAgIGNvbnRyb2xUeXBlOiAndGV4dCcsXG4gICAgICAgICAgICBmbjogZnVuY3Rpb24gKHYsIGEsIHBhcmVudCwgaW5kZXgsIGFiaWxpdHlNb2RlbCwgYWJpbGl0eSkge1xuICAgICAgICAgICAgICAgIHJldHVybiBhYmlsaXR5TW9kZWwuZ2V0QWJpbGl0eVByb3BlcnR5VmFsdWUoYWJpbGl0eSwgJ2RhbWFnZScpKnY7XG4gICAgICAgICAgICB9XG4gICAgICAgIH1cbiAgICBdLFxuICAgICdiYW5lX2ZpZW5kc19ncmlwJzogW1xuICAgICAgICB7XG4gICAgICAgICAgICBsYWJlbDogJ0R1cmF0aW9uJyxcbiAgICAgICAgICAgIGNvbnRyb2xUeXBlOiAnaW5wdXQnXG4gICAgICAgIH0sXG4gICAgICAgIHtcbiAgICAgICAgICAgIGxhYmVsOiAnRW5lbXkgTWF4IE1hbmEnLFxuICAgICAgICAgICAgY29udHJvbFR5cGU6ICdpbnB1dCdcbiAgICAgICAgfSxcbiAgICAgICAge1xuICAgICAgICAgICAgYXR0cmlidXRlTmFtZTogJ2ZpZW5kX2dyaXBfZGFtYWdlJyxcbiAgICAgICAgICAgIGxhYmVsOiAnVG90YWwgRGFtYWdlJyxcbiAgICAgICAgICAgIGNvbnRyb2xUeXBlOiAndGV4dCcsXG4gICAgICAgICAgICBjb250cm9sczogWzAsMV0sXG4gICAgICAgICAgICBmbjogZnVuY3Rpb24gKHYsIGEsIHBhcmVudCwgaW5kZXgsIGFiaWxpdHlNb2RlbCwgYWJpbGl0eSkge1xuICAgICAgICAgICAgICAgIGlmIChwYXJlbnQuaW52ZW50b3J5Lmhhc1NjZXB0ZXIoKSkge1xuICAgICAgICAgICAgICAgICAgICByZXR1cm4gdlswXSphYmlsaXR5TW9kZWwuZ2V0QWJpbGl0eUF0dHJpYnV0ZVZhbHVlKGFiaWxpdHkuYXR0cmlidXRlcywgJ2ZpZW5kX2dyaXBfZGFtYWdlX3NjZXB0ZXInLGFiaWxpdHkubGV2ZWwoKSk7XG4gICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICAgIGVsc2Uge1xuICAgICAgICAgICAgICAgICAgICByZXR1cm4gdlswXSphO1xuICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgIH1cbiAgICAgICAgfSxcbiAgICAgICAge1xuICAgICAgICAgICAgYXR0cmlidXRlTmFtZTogJ2ZpZW5kX2dyaXBfbWFuYV9kcmFpbicsXG4gICAgICAgICAgICBsYWJlbDogJ1RvdGFsIE1hbmEgRHJhaW4nLFxuICAgICAgICAgICAgY29udHJvbFR5cGU6ICd0ZXh0JyxcbiAgICAgICAgICAgIGNvbnRyb2xzOiBbMCwxXSxcbiAgICAgICAgICAgIG5vTGV2ZWw6IHRydWUsXG4gICAgICAgICAgICBmbjogZnVuY3Rpb24gKHYsIGEsIHBhcmVudCwgaW5kZXgsIGFiaWxpdHlNb2RlbCwgYWJpbGl0eSkge1xuICAgICAgICAgICAgICAgIGlmIChwYXJlbnQuaW52ZW50b3J5Lmhhc1NjZXB0ZXIoKSkge1xuICAgICAgICAgICAgICAgICAgICByZXR1cm4gdlswXSp2WzFdKmFiaWxpdHlNb2RlbC5nZXRBYmlsaXR5QXR0cmlidXRlVmFsdWUoYWJpbGl0eS5hdHRyaWJ1dGVzLCAnZmllbmRfZ3JpcF9tYW5hX2RyYWluX3NjZXB0ZXInLGFiaWxpdHkubGV2ZWwoKSkvMTAwO1xuICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgICBlbHNlIHtcbiAgICAgICAgICAgICAgICAgICAgcmV0dXJuIHZbMF0qdlsxXSphLzEwMDtcbiAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICB9XG4gICAgICAgIH1cbiAgICBdLFxuICAgICdiYXRyaWRlcl9zdGlja3lfbmFwYWxtJzogW1xuICAgICAgICB7XG4gICAgICAgICAgICBsYWJlbDogJ1N0YWNrcycsXG4gICAgICAgICAgICBjb250cm9sVHlwZTogJ2lucHV0J1xuICAgICAgICB9LFxuICAgICAgICB7XG4gICAgICAgICAgICBhdHRyaWJ1dGVOYW1lOiAnZGFtYWdlJyxcbiAgICAgICAgICAgIGxhYmVsOiAnVG90YWwgQm9udXMgRGFtYWdlJyxcbiAgICAgICAgICAgIGNvbnRyb2xUeXBlOiAndGV4dCcsXG4gICAgICAgICAgICBmbjogZnVuY3Rpb24gKHYsIGEsIHBhcmVudCwgaW5kZXgsIGFiaWxpdHlNb2RlbCwgYWJpbGl0eSkge1xuICAgICAgICAgICAgICAgIHJldHVybiB2KmE7XG4gICAgICAgICAgICB9LFxuICAgICAgICAgICAgcmV0dXJuUHJvcGVydHk6ICdib251c0RhbWFnZSdcbiAgICAgICAgfSxcbiAgICAgICAge1xuICAgICAgICAgICAgYXR0cmlidXRlTmFtZTogJ21vdmVtZW50X3NwZWVkX3BjdCcsXG4gICAgICAgICAgICBsYWJlbDogJ0VuZW15IE1vdmVtZW50IFNwZWVkIFNsb3cnLFxuICAgICAgICAgICAgY29udHJvbFR5cGU6ICd0ZXh0JyxcbiAgICAgICAgICAgIGZuOiBmdW5jdGlvbiAodiwgYSwgcGFyZW50LCBpbmRleCwgYWJpbGl0eU1vZGVsLCBhYmlsaXR5KSB7XG4gICAgICAgICAgICAgICAgcmV0dXJuIHYqYTtcbiAgICAgICAgICAgIH0sXG4gICAgICAgICAgICByZXR1cm5Qcm9wZXJ0eTogJ21vdmVtZW50U3BlZWRQY3RSZWR1Y3Rpb24nXG4gICAgICAgIH0sXG4gICAgICAgIHtcbiAgICAgICAgICAgIGF0dHJpYnV0ZU5hbWU6ICd0dXJuX3JhdGVfcGN0JyxcbiAgICAgICAgICAgIGxhYmVsOiAnRW5lbXkgVHVybiBSYXRlIFNsb3cnLFxuICAgICAgICAgICAgY29udHJvbFR5cGU6ICd0ZXh0JyxcbiAgICAgICAgICAgIGZuOiBmdW5jdGlvbiAodiwgYSwgcGFyZW50LCBpbmRleCwgYWJpbGl0eU1vZGVsLCBhYmlsaXR5KSB7XG4gICAgICAgICAgICAgICAgcmV0dXJuIGE7XG4gICAgICAgICAgICB9LFxuICAgICAgICAgICAgcmV0dXJuUHJvcGVydHk6ICd0dXJuUmF0ZVJlZHVjdGlvbidcbiAgICAgICAgfVxuICAgIF0sXG4gICAgJ2JhdHJpZGVyX2ZpcmVmbHknOiBbXG4gICAgICAgIHtcbiAgICAgICAgICAgIGxhYmVsOiAnRHVyYXRpb24nLFxuICAgICAgICAgICAgY29udHJvbFR5cGU6ICdpbnB1dCdcbiAgICAgICAgfSxcbiAgICAgICAge1xuICAgICAgICAgICAgYXR0cmlidXRlTmFtZTogJ2RhbWFnZV9wZXJfc2Vjb25kJyxcbiAgICAgICAgICAgIGxhYmVsOiAnVG90YWwgRGFtYWdlJyxcbiAgICAgICAgICAgIGNvbnRyb2xUeXBlOiAndGV4dCcsXG4gICAgICAgICAgICBmbjogZnVuY3Rpb24gKHYsIGEsIHBhcmVudCwgaW5kZXgsIGFiaWxpdHlNb2RlbCwgYWJpbGl0eSkge1xuICAgICAgICAgICAgICAgIHJldHVybiB2KmE7XG4gICAgICAgICAgICB9XG4gICAgICAgIH1cbiAgICBdLFxuICAgICdibG9vZHNlZWtlcl9ydXB0dXJlJzogW1xuICAgICAgICB7XG4gICAgICAgICAgICBsYWJlbDogJ0VuZW15IERpc3RhbmNlIFRyYXZlbGVkJyxcbiAgICAgICAgICAgIGNvbnRyb2xUeXBlOiAnaW5wdXQnXG4gICAgICAgIH0sXG4gICAgICAgIHtcbiAgICAgICAgICAgIGF0dHJpYnV0ZU5hbWU6ICdtb3ZlbWVudF9kYW1hZ2VfcGN0JyxcbiAgICAgICAgICAgIGxhYmVsOiAnREFNQUdFOicsXG4gICAgICAgICAgICBpZ25vcmVUb29sdGlwOiB0cnVlLFxuICAgICAgICAgICAgY29udHJvbFR5cGU6ICd0ZXh0JyxcbiAgICAgICAgICAgIGZuOiBmdW5jdGlvbiAodiwgYSwgcGFyZW50LCBpbmRleCwgYWJpbGl0eU1vZGVsLCBhYmlsaXR5KSB7XG4gICAgICAgICAgICAgICAgcmV0dXJuIGFiaWxpdHlNb2RlbC5nZXRBYmlsaXR5UHJvcGVydHlWYWx1ZShhYmlsaXR5LCAnZGFtYWdlJykgKyB2KmEvMTAwO1xuICAgICAgICAgICAgfVxuICAgICAgICB9XG4gICAgXSxcbiAgICAnYnJpc3RsZWJhY2tfdmlzY291c19uYXNhbF9nb28nOiBbXG4gICAgICAgIHtcbiAgICAgICAgICAgIGxhYmVsOiAnU3RhY2tzJyxcbiAgICAgICAgICAgIGNvbnRyb2xUeXBlOiAnaW5wdXQnXG4gICAgICAgIH0sXG4gICAgICAgIHtcbiAgICAgICAgICAgIGF0dHJpYnV0ZU5hbWU6ICdhcm1vcl9wZXJfc3RhY2snLFxuICAgICAgICAgICAgbGFiZWw6ICdFbmVteSBBcm1vciBSZWR1Y3Rpb24nLFxuICAgICAgICAgICAgY29udHJvbFR5cGU6ICd0ZXh0JyxcbiAgICAgICAgICAgIGZuOiBmdW5jdGlvbiAodiwgYSwgcGFyZW50LCBpbmRleCwgYWJpbGl0eU1vZGVsLCBhYmlsaXR5KSB7XG4gICAgICAgICAgICAgICAgcmV0dXJuIC12KmE7XG4gICAgICAgICAgICB9LFxuICAgICAgICAgICAgcmV0dXJuUHJvcGVydHk6ICdhcm1vclJlZHVjdGlvbidcbiAgICAgICAgfSxcbiAgICAgICAge1xuICAgICAgICAgICAgYXR0cmlidXRlTmFtZTogJ21vdmVfc2xvd19wZXJfc3RhY2snLFxuICAgICAgICAgICAgbGFiZWw6ICclU0xPVzonLFxuICAgICAgICAgICAgaWdub3JlVG9vbHRpcDogdHJ1ZSxcbiAgICAgICAgICAgIGNvbnRyb2xUeXBlOiAndGV4dCcsXG4gICAgICAgICAgICBmbjogZnVuY3Rpb24gKHYsIGEsIHBhcmVudCwgaW5kZXgsIGFiaWxpdHlNb2RlbCwgYWJpbGl0eSkge1xuICAgICAgICAgICAgICAgIHJldHVybiAtKGFiaWxpdHlNb2RlbC5nZXRBYmlsaXR5QXR0cmlidXRlVmFsdWUoYWJpbGl0eS5hdHRyaWJ1dGVzLCAnYmFzZV9tb3ZlX3Nsb3cnLDApK3YqYSk7XG4gICAgICAgICAgICB9LFxuICAgICAgICAgICAgcmV0dXJuUHJvcGVydHk6ICdtb3ZlbWVudFNwZWVkUGN0UmVkdWN0aW9uJ1xuICAgICAgICB9XG4gICAgXSxcbiAgICAnYnJpc3RsZWJhY2tfcXVpbGxfc3ByYXknOiBbXG4gICAgICAgIHtcbiAgICAgICAgICAgIGxhYmVsOiAnU3RhY2tzJyxcbiAgICAgICAgICAgIGNvbnRyb2xUeXBlOiAnaW5wdXQnXG4gICAgICAgIH0sXG4gICAgICAgIHtcbiAgICAgICAgICAgIGF0dHJpYnV0ZU5hbWU6ICdxdWlsbF9zdGFja19kYW1hZ2UnLFxuICAgICAgICAgICAgbGFiZWw6ICdEQU1BR0UnLFxuICAgICAgICAgICAgY29udHJvbFR5cGU6ICd0ZXh0JyxcbiAgICAgICAgICAgIGZuOiBmdW5jdGlvbiAodiwgYSwgcGFyZW50LCBpbmRleCwgYWJpbGl0eU1vZGVsLCBhYmlsaXR5KSB7XG4gICAgICAgICAgICAgICAgdmFyIHRvdGFsID0gYWJpbGl0eU1vZGVsLmdldEFiaWxpdHlBdHRyaWJ1dGVWYWx1ZShhYmlsaXR5LmF0dHJpYnV0ZXMsICdxdWlsbF9iYXNlX2RhbWFnZScsYWJpbGl0eS5sZXZlbCgpKSt2KmEsXG4gICAgICAgICAgICAgICAgZGFtYWdlX2NhcCA9IGFiaWxpdHlNb2RlbC5nZXRBYmlsaXR5QXR0cmlidXRlVmFsdWUoYWJpbGl0eS5hdHRyaWJ1dGVzLCAnbWF4X2RhbWFnZScsMCk7XG4gICAgICAgICAgICAgICAgaWYgKHRvdGFsID4gZGFtYWdlX2NhcCkge1xuICAgICAgICAgICAgICAgICAgICB0b3RhbCA9IGRhbWFnZV9jYXA7XG4gICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICAgIHJldHVybiB0b3RhbDtcbiAgICAgICAgICAgIH1cbiAgICAgICAgfVxuICAgIF0sXG4gICAgJ2JyaXN0bGViYWNrX2JyaXN0bGViYWNrJzogW1xuICAgICAgICB7XG4gICAgICAgICAgICBsYWJlbDogJ0RhbWFnZSBGcm9tJyxcbiAgICAgICAgICAgIGNvbnRyb2xUeXBlOiAncmFkaW8nLFxuICAgICAgICAgICAgY29udHJvbFZhbHVlVHlwZTogJ3N0cmluZycsXG4gICAgICAgICAgICBjb250cm9sT3B0aW9uczogW1xuICAgICAgICAgICAgICAgIHt0ZXh0OiAnQmFjaycsIHZhbHVlOiAnYmFjayd9LFxuICAgICAgICAgICAgICAgIHt0ZXh0OiAnU2lkZScsIHZhbHVlOiAnc2lkZSd9XG4gICAgICAgICAgICBdXG4gICAgICAgIH0sXG4gICAgICAgIHtcbiAgICAgICAgICAgIGF0dHJpYnV0ZU5hbWU6ICdiYWNrX2RhbWFnZV9yZWR1Y3Rpb24nLFxuICAgICAgICAgICAgbGFiZWw6ICclREFNQUdFIFJFRFVDVElPTjonLFxuICAgICAgICAgICAgaWdub3JlVG9vbHRpcDogdHJ1ZSxcbiAgICAgICAgICAgIGNvbnRyb2xUeXBlOiAndGV4dCcsXG4gICAgICAgICAgICBmbjogZnVuY3Rpb24gKHYsIGEsIHBhcmVudCwgaW5kZXgsIGFiaWxpdHlNb2RlbCwgYWJpbGl0eSkge1xuICAgICAgICAgICAgICAgIHZhciBhYmlsaXR5ID0gYWJpbGl0eU1vZGVsLmFiaWxpdGllcygpLmZpbmQoZnVuY3Rpb24oYikge1xuICAgICAgICAgICAgICAgICAgICByZXR1cm4gYi5uYW1lID09ICdicmlzdGxlYmFja19icmlzdGxlYmFjayc7XG4gICAgICAgICAgICAgICAgfSk7XG4gICAgICAgICAgICAgICAgaWYgKHYgPT0gJ2JhY2snKSB7XG4gICAgICAgICAgICAgICAgICAgIHZhciB0b3RhbCA9IGFiaWxpdHlNb2RlbC5nZXRBYmlsaXR5QXR0cmlidXRlVmFsdWUoYWJpbGl0eS5hdHRyaWJ1dGVzLCAnYmFja19kYW1hZ2VfcmVkdWN0aW9uJywgYWJpbGl0eS5sZXZlbCgpKTtcbiAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgICAgZWxzZSB7XG4gICAgICAgICAgICAgICAgICAgIHZhciB0b3RhbCA9IGFiaWxpdHlNb2RlbC5nZXRBYmlsaXR5QXR0cmlidXRlVmFsdWUoYWJpbGl0eS5hdHRyaWJ1dGVzLCAnc2lkZV9kYW1hZ2VfcmVkdWN0aW9uJywgYWJpbGl0eS5sZXZlbCgpKTtcbiAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgICAgcmV0dXJuIC10b3RhbDtcbiAgICAgICAgICAgIH0sXG4gICAgICAgICAgICByZXR1cm5Qcm9wZXJ0eTogJ2RhbWFnZVJlZHVjdGlvbidcbiAgICAgICAgfVxuICAgIF0sXG4gICAgJ2JyaXN0bGViYWNrX3dhcnBhdGgnOiBbXG4gICAgICAgIHtcbiAgICAgICAgICAgIGxhYmVsOiAnU3RhY2tzJyxcbiAgICAgICAgICAgIGNvbnRyb2xUeXBlOiAnaW5wdXQnXG4gICAgICAgIH0sXG4gICAgICAgIHtcbiAgICAgICAgICAgIGF0dHJpYnV0ZU5hbWU6ICdkYW1hZ2VfcGVyX3N0YWNrJyxcbiAgICAgICAgICAgIGxhYmVsOiAnQk9OVVMgREFNQUdFOicsXG4gICAgICAgICAgICBpZ25vcmVUb29sdGlwOiB0cnVlLFxuICAgICAgICAgICAgY29udHJvbFR5cGU6ICd0ZXh0JyxcbiAgICAgICAgICAgIGZuOiBmdW5jdGlvbiAodiwgYSwgcGFyZW50LCBpbmRleCwgYWJpbGl0eU1vZGVsLCBhYmlsaXR5KSB7XG4gICAgICAgICAgICAgICAgaWYgKHYgPCAxKSB7XG4gICAgICAgICAgICAgICAgICAgIHJldHVybiAwO1xuICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgICBlbHNlIHtcbiAgICAgICAgICAgICAgICAgICAgcmV0dXJuIGFiaWxpdHlNb2RlbC5nZXRBYmlsaXR5QXR0cmlidXRlVmFsdWUoYWJpbGl0eS5hdHRyaWJ1dGVzLCAnYmFzZV9kYW1hZ2UnLGFiaWxpdHkubGV2ZWwoKSkrKHYtMSkqYTtcbiAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICB9XG4gICAgICAgIH0sXG4gICAgICAgIHtcbiAgICAgICAgICAgIGF0dHJpYnV0ZU5hbWU6ICdtb3ZlX3NwZWVkX3Blcl9zdGFjaycsXG4gICAgICAgICAgICBsYWJlbDogJyVNT1ZFTUVOVDonLFxuICAgICAgICAgICAgaWdub3JlVG9vbHRpcDogdHJ1ZSxcbiAgICAgICAgICAgIGNvbnRyb2xUeXBlOiAndGV4dCcsXG4gICAgICAgICAgICBmbjogZnVuY3Rpb24gKHYsIGEsIHBhcmVudCwgaW5kZXgsIGFiaWxpdHlNb2RlbCwgYWJpbGl0eSkge1xuICAgICAgICAgICAgICAgIGlmICh2IDwgMSkge1xuICAgICAgICAgICAgICAgICAgICByZXR1cm4gMDtcbiAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgICAgZWxzZSB7XG4gICAgICAgICAgICAgICAgICAgIHJldHVybiBhYmlsaXR5TW9kZWwuZ2V0QWJpbGl0eUF0dHJpYnV0ZVZhbHVlKGFiaWxpdHkuYXR0cmlidXRlcywgJ2Jhc2VfbW92ZV9zcGVlZCcsYWJpbGl0eS5sZXZlbCgpKSsodi0xKSphO1xuICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgIH0sXG4gICAgICAgICAgICByZXR1cm5Qcm9wZXJ0eTogJ21vdmVtZW50U3BlZWRQY3QnXG4gICAgICAgIH1cbiAgICBdLFxuICAgICdjZW50YXVyX3JldHVybic6IFtcbiAgICAgICAge1xuICAgICAgICAgICAgbGFiZWw6ICdTdHJlbmd0aCcsXG4gICAgICAgICAgICBjb250cm9sVHlwZTogJ2lucHV0J1xuICAgICAgICB9LFxuICAgICAgICB7XG4gICAgICAgICAgICBhdHRyaWJ1dGVOYW1lOiAnc3RyZW5ndGhfcGN0JyxcbiAgICAgICAgICAgIGxhYmVsOiAnREFNQUdFOicsXG4gICAgICAgICAgICBjb250cm9sVHlwZTogJ3RleHQnLFxuICAgICAgICAgICAgZm46IGZ1bmN0aW9uICh2LCBhLCBwYXJlbnQsIGluZGV4LCBhYmlsaXR5TW9kZWwsIGFiaWxpdHkpIHtcbiAgICAgICAgICAgICAgICByZXR1cm4gYWJpbGl0eU1vZGVsLmdldEFiaWxpdHlBdHRyaWJ1dGVWYWx1ZShhYmlsaXR5LmF0dHJpYnV0ZXMsICdyZXR1cm5fZGFtYWdlJyxhYmlsaXR5LmxldmVsKCkpICsgdiphLzEwMDtcbiAgICAgICAgICAgIH1cbiAgICAgICAgfVxuICAgIF0sXG4gICAgJ2NlbnRhdXJfc3RhbXBlZGUnOiBbXG4gICAgICAgIHtcbiAgICAgICAgICAgIGxhYmVsOiAnU3RyZW5ndGgnLFxuICAgICAgICAgICAgY29udHJvbFR5cGU6ICdpbnB1dCdcbiAgICAgICAgfSxcbiAgICAgICAge1xuICAgICAgICAgICAgYXR0cmlidXRlTmFtZTogJ3N0cmVuZ3RoX2RhbWFnZScsXG4gICAgICAgICAgICBsYWJlbDogJ0RBTUFHRTonLFxuICAgICAgICAgICAgaWdub3JlVG9vbHRpcDogdHJ1ZSxcbiAgICAgICAgICAgIGNvbnRyb2xUeXBlOiAndGV4dCcsXG4gICAgICAgICAgICBmbjogZnVuY3Rpb24gKHYsIGEsIHBhcmVudCwgaW5kZXgsIGFiaWxpdHlNb2RlbCwgYWJpbGl0eSkge1xuICAgICAgICAgICAgICAgIHJldHVybiB2KmE7XG4gICAgICAgICAgICB9XG4gICAgICAgIH0sXG4gICAgICAgIHtcbiAgICAgICAgICAgIGF0dHJpYnV0ZU5hbWU6ICdzbG93X21vdmVtZW50X3NwZWVkJyxcbiAgICAgICAgICAgIGxhYmVsOiAnRW5lbXkgTW92ZW1lbnQgU3BlZWQgU2xvdycsXG4gICAgICAgICAgICBjb250cm9sVHlwZTogJ3RleHQnLFxuICAgICAgICAgICAgZm46IGZ1bmN0aW9uICh2LCBhLCBwYXJlbnQsIGluZGV4LCBhYmlsaXR5TW9kZWwsIGFiaWxpdHkpIHtcbiAgICAgICAgICAgICAgICByZXR1cm4gLWE7XG4gICAgICAgICAgICB9LFxuICAgICAgICAgICAgcmV0dXJuUHJvcGVydHk6ICdtb3ZlbWVudFNwZWVkUGN0UmVkdWN0aW9uJ1xuICAgICAgICB9XG4gICAgXSxcbiAgICAnY2xpbmt6X2RlYXRoX3BhY3QnOiBbXG4gICAgICAgIHtcbiAgICAgICAgICAgIGxhYmVsOiAnQ29uc3VtZWQgVW5pdCBIUCcsXG4gICAgICAgICAgICBjb250cm9sVHlwZTogJ2lucHV0J1xuICAgICAgICB9LFxuICAgICAgICB7XG4gICAgICAgICAgICBhdHRyaWJ1dGVOYW1lOiAnZGFtYWdlX2dhaW5fcGN0JyxcbiAgICAgICAgICAgIGxhYmVsOiAnQkFTRSBEQU1BR0UgR0FJTjonLFxuICAgICAgICAgICAgaWdub3JlVG9vbHRpcDogdHJ1ZSxcbiAgICAgICAgICAgIGNvbnRyb2xUeXBlOiAndGV4dCcsXG4gICAgICAgICAgICBmbjogZnVuY3Rpb24gKHYsIGEsIHBhcmVudCwgaW5kZXgsIGFiaWxpdHlNb2RlbCwgYWJpbGl0eSkge1xuICAgICAgICAgICAgICAgIHJldHVybiB2KmEvMTAwO1xuICAgICAgICAgICAgfSxcbiAgICAgICAgICAgIHJldHVyblByb3BlcnR5OiAnYmFzZURhbWFnZSdcbiAgICAgICAgfSxcbiAgICAgICAge1xuICAgICAgICAgICAgYXR0cmlidXRlTmFtZTogJ2hlYWx0aF9nYWluX3BjdCcsXG4gICAgICAgICAgICBsYWJlbDogJ0hFQUxUSCBHQUlOOicsXG4gICAgICAgICAgICBpZ25vcmVUb29sdGlwOiB0cnVlLFxuICAgICAgICAgICAgY29udHJvbFR5cGU6ICd0ZXh0JyxcbiAgICAgICAgICAgIGZuOiBmdW5jdGlvbiAodiwgYSwgcGFyZW50LCBpbmRleCwgYWJpbGl0eU1vZGVsLCBhYmlsaXR5KSB7XG4gICAgICAgICAgICAgICAgcmV0dXJuIHYqYS8xMDA7XG4gICAgICAgICAgICB9LFxuICAgICAgICAgICAgcmV0dXJuUHJvcGVydHk6ICdib251c0hlYWx0aCdcbiAgICAgICAgfVxuICAgIF0sXG4gICAgJ2NyeXN0YWxfbWFpZGVuX2Zyb3N0Yml0ZSc6IFtcbiAgICAgICAge1xuICAgICAgICAgICAgbGFiZWw6ICdEdXJhdGlvbicsXG4gICAgICAgICAgICBjb250cm9sVHlwZTogJ2lucHV0J1xuICAgICAgICB9LFxuICAgICAgICB7XG4gICAgICAgICAgICBsYWJlbDogJ0RBTUFHRTonLFxuICAgICAgICAgICAgY29udHJvbFR5cGU6ICd0ZXh0JyxcbiAgICAgICAgICAgIGZuOiBmdW5jdGlvbiAodiwgYSwgcGFyZW50LCBpbmRleCwgYWJpbGl0eU1vZGVsLCBhYmlsaXR5KSB7XG4gICAgICAgICAgICAgICAgcmV0dXJuIGFiaWxpdHlNb2RlbC5nZXRBYmlsaXR5UHJvcGVydHlWYWx1ZShhYmlsaXR5LCAnZGFtYWdlJykqdjtcbiAgICAgICAgICAgIH1cbiAgICAgICAgfVxuICAgIF0sXG4gICAgJ2Rhcmtfc2Vlcl9pb25fc2hlbGwnOiBbXG4gICAgICAgIHtcbiAgICAgICAgICAgIGxhYmVsOiAnRHVyYXRpb24nLFxuICAgICAgICAgICAgY29udHJvbFR5cGU6ICdpbnB1dCdcbiAgICAgICAgfSxcbiAgICAgICAge1xuICAgICAgICAgICAgYXR0cmlidXRlTmFtZTogJ2RhbWFnZV9wZXJfc2Vjb25kJyxcbiAgICAgICAgICAgIGxhYmVsOiAnVG90YWwgRGFtYWdlJyxcbiAgICAgICAgICAgIGNvbnRyb2xUeXBlOiAndGV4dCcsXG4gICAgICAgICAgICBmbjogZnVuY3Rpb24gKHYsIGEsIHBhcmVudCwgaW5kZXgsIGFiaWxpdHlNb2RlbCwgYWJpbGl0eSkge1xuICAgICAgICAgICAgICAgIHJldHVybiB2KmE7XG4gICAgICAgICAgICB9XG4gICAgICAgIH1cbiAgICBdLFxuICAgICdkYXp6bGVfc2hhZG93X3dhdmUnOiBbXG4gICAgICAgIHtcbiAgICAgICAgICAgIGxhYmVsOiAnVGFyZ2V0cycsXG4gICAgICAgICAgICBjb250cm9sVHlwZTogJ2lucHV0J1xuICAgICAgICB9LFxuICAgICAgICB7XG4gICAgICAgICAgICBsYWJlbDogJ0RBTUFHRTonLFxuICAgICAgICAgICAgY29udHJvbFR5cGU6ICd0ZXh0JyxcbiAgICAgICAgICAgIGZuOiBmdW5jdGlvbiAodiwgYSwgcGFyZW50LCBpbmRleCwgYWJpbGl0eU1vZGVsLCBhYmlsaXR5KSB7XG4gICAgICAgICAgICAgICAgcmV0dXJuIGFiaWxpdHlNb2RlbC5nZXRBYmlsaXR5UHJvcGVydHlWYWx1ZShhYmlsaXR5LCAnZGFtYWdlJykqdjtcbiAgICAgICAgICAgIH1cbiAgICAgICAgfVxuICAgIF0sXG4gICAgJ2RhenpsZV93ZWF2ZSc6IFtcbiAgICAgICAge1xuICAgICAgICAgICAgbGFiZWw6ICdEdXJhdGlvbicsXG4gICAgICAgICAgICBjb250cm9sVHlwZTogJ2lucHV0J1xuICAgICAgICB9LFxuICAgICAgICB7XG4gICAgICAgICAgICBhdHRyaWJ1dGVOYW1lOiAnYXJtb3JfcGVyX3NlY29uZCcsXG4gICAgICAgICAgICBsYWJlbDogJ0FSTU9SJyxcbiAgICAgICAgICAgIGlnbm9yZVRvb2x0aXA6IHRydWUsXG4gICAgICAgICAgICBjb250cm9sVHlwZTogJ3RleHQnLFxuICAgICAgICAgICAgZm46IGZ1bmN0aW9uICh2LCBhLCBwYXJlbnQsIGluZGV4LCBhYmlsaXR5TW9kZWwsIGFiaWxpdHkpIHtcbiAgICAgICAgICAgICAgICByZXR1cm4gdiphO1xuICAgICAgICAgICAgfSxcbiAgICAgICAgICAgIHJldHVyblByb3BlcnR5OiAnYXJtb3InXG4gICAgICAgIH0sXG4gICAgICAgIHtcbiAgICAgICAgICAgIGF0dHJpYnV0ZU5hbWU6ICdhcm1vcl9wZXJfc2Vjb25kJyxcbiAgICAgICAgICAgIGxhYmVsOiAnQVJNT1IgUkVEVUNUSU9OOicsXG4gICAgICAgICAgICBpZ25vcmVUb29sdGlwOiB0cnVlLFxuICAgICAgICAgICAgY29udHJvbFR5cGU6ICd0ZXh0JyxcbiAgICAgICAgICAgIGZuOiBmdW5jdGlvbiAodiwgYSwgcGFyZW50LCBpbmRleCwgYWJpbGl0eU1vZGVsLCBhYmlsaXR5KSB7XG4gICAgICAgICAgICAgICAgcmV0dXJuIC12KmE7XG4gICAgICAgICAgICB9LFxuICAgICAgICAgICAgcmV0dXJuUHJvcGVydHk6ICdhcm1vclJlZHVjdGlvbidcbiAgICAgICAgfVxuICAgIF0sXG4gICAgJ2RlYXRoX3Byb3BoZXRfZXhvcmNpc20nOiBbXG4gICAgICAgIHtcbiAgICAgICAgICAgIGxhYmVsOiAnRGFtYWdlIERlYWx0JyxcbiAgICAgICAgICAgIGNvbnRyb2xUeXBlOiAnaW5wdXQnXG4gICAgICAgIH0sXG4gICAgICAgIHtcbiAgICAgICAgICAgIGF0dHJpYnV0ZU5hbWU6ICdoZWFsX3BlcmNlbnQnLFxuICAgICAgICAgICAgbGFiZWw6ICdUb3RhbCBBcm1vcicsXG4gICAgICAgICAgICBjb250cm9sVHlwZTogJ3RleHQnLFxuICAgICAgICAgICAgZm46IGZ1bmN0aW9uICh2LCBhLCBwYXJlbnQsIGluZGV4LCBhYmlsaXR5TW9kZWwsIGFiaWxpdHkpIHtcbiAgICAgICAgICAgICAgICByZXR1cm4gdiphLzEwMDtcbiAgICAgICAgICAgIH1cbiAgICAgICAgfVxuICAgIF0sXG4gICAgJ2Rpc3J1cHRvcl9zdGF0aWNfc3Rvcm0nOiBbXG4gICAgICAgIHtcbiAgICAgICAgICAgIGxhYmVsOiAnRHVyYXRpb24nLFxuICAgICAgICAgICAgY29udHJvbFR5cGU6ICdpbnB1dCdcbiAgICAgICAgfSxcbiAgICAgICAge1xuICAgICAgICAgICAgbGFiZWw6ICdEQU1BR0U6JyxcbiAgICAgICAgICAgIGNvbnRyb2xUeXBlOiAndGV4dCcsXG4gICAgICAgICAgICBmbjogZnVuY3Rpb24gKHYsIGEsIHBhcmVudCwgaW5kZXgsIGFiaWxpdHlNb2RlbCwgYWJpbGl0eSkge1xuICAgICAgICAgICAgICAgIHZhciBkYW1hZ2V2YWx1ZSA9IDAuMjUgKiAoMTMwICsgNDAgKiBhYmlsaXR5LmxldmVsKCkpICogKDEvMjApLFxuICAgICAgICAgICAgICAgIG11bHQgPSAodio0KSooKHYqNCkrMSkvMjtcbiAgICAgICAgICAgICAgICByZXR1cm4gZGFtYWdldmFsdWUgKiBtdWx0O1xuICAgICAgICAgICAgfVxuICAgICAgICB9XG4gICAgXSxcbiAgICAnZG9vbV9icmluZ2VyX3Njb3JjaGVkX2VhcnRoJzogW1xuICAgICAgICB7XG4gICAgICAgICAgICBsYWJlbDogJ0R1cmF0aW9uJyxcbiAgICAgICAgICAgIGNvbnRyb2xUeXBlOiAnaW5wdXQnXG4gICAgICAgIH0sXG4gICAgICAgIHtcbiAgICAgICAgICAgIGF0dHJpYnV0ZU5hbWU6ICdkYW1hZ2VfcGVyX3NlY29uZCcsXG4gICAgICAgICAgICBsYWJlbDogJ1RvdGFsIERhbWFnZScsXG4gICAgICAgICAgICBjb250cm9sVHlwZTogJ3RleHQnLFxuICAgICAgICAgICAgZm46IGZ1bmN0aW9uICh2LCBhLCBwYXJlbnQsIGluZGV4LCBhYmlsaXR5TW9kZWwsIGFiaWxpdHkpIHtcbiAgICAgICAgICAgICAgICByZXR1cm4gdiphO1xuICAgICAgICAgICAgfVxuICAgICAgICB9LFxuICAgICAgICB7XG4gICAgICAgICAgICBhdHRyaWJ1dGVOYW1lOiAnYm9udXNfbW92ZW1lbnRfc3BlZWRfcGN0JyxcbiAgICAgICAgICAgIGxhYmVsOiAnVG90YWwgRGFtYWdlJyxcbiAgICAgICAgICAgIGNvbnRyb2xUeXBlOiAndGV4dCcsXG4gICAgICAgICAgICBmbjogZnVuY3Rpb24gKHYsIGEsIHBhcmVudCwgaW5kZXgsIGFiaWxpdHlNb2RlbCwgYWJpbGl0eSkge1xuICAgICAgICAgICAgICAgIHJldHVybiBhO1xuICAgICAgICAgICAgfSxcbiAgICAgICAgICAgIHJldHVyblByb3BlcnR5OiAnbW92ZW1lbnRTcGVlZFBjdCdcbiAgICAgICAgfSxcbiAgICAgICAge1xuICAgICAgICAgICAgYXR0cmlidXRlTmFtZTogJ2RhbWFnZV9wZXJfc2Vjb25kJyxcbiAgICAgICAgICAgIGxhYmVsOiAnSFAgUkVHRU46JyxcbiAgICAgICAgICAgIGlnbm9yZVRvb2x0aXA6IHRydWUsXG4gICAgICAgICAgICBjb250cm9sVHlwZTogJ3RleHQnLFxuICAgICAgICAgICAgZm46IGZ1bmN0aW9uICh2LCBhLCBwYXJlbnQsIGluZGV4LCBhYmlsaXR5TW9kZWwsIGFiaWxpdHkpIHtcbiAgICAgICAgICAgICAgICByZXR1cm4gYTtcbiAgICAgICAgICAgIH0sXG4gICAgICAgICAgICByZXR1cm5Qcm9wZXJ0eTogJ2hlYWx0aHJlZ2VuJ1xuICAgICAgICB9XG4gICAgXSxcbiAgICAnZG9vbV9icmluZ2VyX2Rvb20nOiBbXG4gICAgICAgIHtcbiAgICAgICAgICAgIGxhYmVsOiAnRHVyYXRpb24nLFxuICAgICAgICAgICAgY29udHJvbFR5cGU6ICdpbnB1dCdcbiAgICAgICAgfSxcbiAgICAgICAge1xuICAgICAgICAgICAgYXR0cmlidXRlTmFtZTogJ2RhbWFnZScsXG4gICAgICAgICAgICBsYWJlbDogJ1RvdGFsIERhbWFnZScsXG4gICAgICAgICAgICBjb250cm9sVHlwZTogJ3RleHQnLFxuICAgICAgICAgICAgZm46IGZ1bmN0aW9uICh2LCBhLCBwYXJlbnQsIGluZGV4LCBhYmlsaXR5TW9kZWwsIGFiaWxpdHkpIHtcbiAgICAgICAgICAgICAgICBpZiAocGFyZW50LmludmVudG9yeS5oYXNTY2VwdGVyKCkpIHtcbiAgICAgICAgICAgICAgICAgICAgcmV0dXJuIHYqYWJpbGl0eU1vZGVsLmdldEFiaWxpdHlBdHRyaWJ1dGVWYWx1ZShhYmlsaXR5LmF0dHJpYnV0ZXMsICdkYW1hZ2Vfc2NlcHRlcicsYWJpbGl0eS5sZXZlbCgpKTtcbiAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgICAgZWxzZSB7XG4gICAgICAgICAgICAgICAgICAgIHJldHVybiB2KmE7XG4gICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgfVxuICAgICAgICB9XG4gICAgXSxcbiAgICAnZHJhZ29uX2tuaWdodF9lbGRlcl9kcmFnb25fZm9ybSc6IFtcbiAgICAgICAge1xuICAgICAgICAgICAgbGFiZWw6ICdEdXJhdGlvbicsXG4gICAgICAgICAgICBjb250cm9sVHlwZTogJ2lucHV0J1xuICAgICAgICB9LFxuICAgICAgICB7XG4gICAgICAgICAgICBhdHRyaWJ1dGVOYW1lOiAnYm9udXNfYXR0YWNrX3JhbmdlJyxcbiAgICAgICAgICAgIGxhYmVsOiAnVG90YWwgRGFtYWdlJyxcbiAgICAgICAgICAgIGNvbnRyb2xUeXBlOiAndGV4dCcsXG4gICAgICAgICAgICBmbjogZnVuY3Rpb24gKHYsIGEsIHBhcmVudCwgaW5kZXgsIGFiaWxpdHlNb2RlbCwgYWJpbGl0eSkge1xuICAgICAgICAgICAgICAgIHJldHVybiBhO1xuICAgICAgICAgICAgfSxcbiAgICAgICAgICAgIHJldHVyblByb3BlcnR5OiAnYXR0YWNrcmFuZ2UnXG4gICAgICAgIH0sXG4gICAgICAgIHtcbiAgICAgICAgICAgIGF0dHJpYnV0ZU5hbWU6ICdib251c19tb3ZlbWVudF9zcGVlZCcsXG4gICAgICAgICAgICBsYWJlbDogJ1RvdGFsIERhbWFnZScsXG4gICAgICAgICAgICBjb250cm9sVHlwZTogJ3RleHQnLFxuICAgICAgICAgICAgZm46IGZ1bmN0aW9uICh2LCBhLCBwYXJlbnQsIGluZGV4LCBhYmlsaXR5TW9kZWwsIGFiaWxpdHkpIHtcbiAgICAgICAgICAgICAgICByZXR1cm4gYTtcbiAgICAgICAgICAgIH0sXG4gICAgICAgICAgICByZXR1cm5Qcm9wZXJ0eTogJ21vdmVtZW50U3BlZWRGbGF0J1xuICAgICAgICB9XG4gICAgXSxcbiAgICAnZHJvd19yYW5nZXJfdHJ1ZXNob3QnOiBbXG4gICAgICAgIHtcbiAgICAgICAgICAgIGxhYmVsOiAnRHJvd1xcJ3MgQWdpbGl0eScsXG4gICAgICAgICAgICBjb250cm9sVHlwZTogJ2lucHV0JyxcbiAgICAgICAgICAgIGRpc3BsYXk6ICdidWZmJ1xuICAgICAgICB9LFxuICAgICAgICB7XG4gICAgICAgICAgICBhdHRyaWJ1dGVOYW1lOiAndHJ1ZXNob3RfcmFuZ2VkX2RhbWFnZScsXG4gICAgICAgICAgICBsYWJlbDogJ0RBTUFHRSBCT05VUzonLFxuICAgICAgICAgICAgaWdub3JlVG9vbHRpcDogdHJ1ZSxcbiAgICAgICAgICAgIGNvbnRyb2xUeXBlOiAndGV4dCcsXG4gICAgICAgICAgICBkaXNwbGF5OiAnYnVmZicsXG4gICAgICAgICAgICBmbjogZnVuY3Rpb24gKHYsIGEsIHBhcmVudCwgaW5kZXgsIGFiaWxpdHlNb2RlbCwgYWJpbGl0eSkge1xuICAgICAgICAgICAgICAgIHJldHVybiB2KmEvMTAwO1xuICAgICAgICAgICAgfSxcbiAgICAgICAgICAgIHJldHVyblByb3BlcnR5OiAnYm9udXNEYW1hZ2VQcmVjaXNpb25BdXJhJ1xuICAgICAgICB9XG4gICAgXSxcbiAgICAnZWFydGhfc3Bpcml0X3JvbGxpbmdfYm91bGRlcic6IFtcbiAgICAgICAge1xuICAgICAgICAgICAgbGFiZWw6ICdVc2luZyBTdG9uZScsXG4gICAgICAgICAgICBjb250cm9sVHlwZTogJ2NoZWNrYm94J1xuICAgICAgICB9LFxuICAgICAgICB7XG4gICAgICAgICAgICBhdHRyaWJ1dGVOYW1lOiAnbW92ZV9zbG93JyxcbiAgICAgICAgICAgIGxhYmVsOiAnVG90YWwgRGFtYWdlJyxcbiAgICAgICAgICAgIGNvbnRyb2xUeXBlOiAndGV4dCcsXG4gICAgICAgICAgICBmbjogZnVuY3Rpb24gKHYsIGEsIHBhcmVudCwgaW5kZXgsIGFiaWxpdHlNb2RlbCwgYWJpbGl0eSkge1xuICAgICAgICAgICAgICAgIGlmICh2KSB7XG4gICAgICAgICAgICAgICAgICAgIHJldHVybiAtYTtcbiAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgICAgZWxzZSB7XG4gICAgICAgICAgICAgICAgICAgIHJldHVybiAwO1xuICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgIH0sXG4gICAgICAgICAgICByZXR1cm5Qcm9wZXJ0eTogJ21vdmVtZW50U3BlZWRQY3RSZWR1Y3Rpb24nXG4gICAgICAgIH1cbiAgICBdLFxuICAgICdlYXJ0aHNoYWtlcl9lbmNoYW50X3RvdGVtJzogW1xuICAgICAgICB7XG4gICAgICAgICAgICBsYWJlbDogJ0FjdGl2YXRlZCcsXG4gICAgICAgICAgICBjb250cm9sVHlwZTogJ2NoZWNrYm94J1xuICAgICAgICB9LFxuICAgICAgICB7XG4gICAgICAgICAgICBhdHRyaWJ1dGVOYW1lOiAndG90ZW1fZGFtYWdlX3BlcmNlbnRhZ2UnLFxuICAgICAgICAgICAgbGFiZWw6ICdEQU1BR0UnLFxuICAgICAgICAgICAgY29udHJvbFR5cGU6ICd0ZXh0JyxcbiAgICAgICAgICAgIGZuOiBmdW5jdGlvbiAodiwgYSwgcGFyZW50LCBpbmRleCwgYWJpbGl0eU1vZGVsLCBhYmlsaXR5KSB7XG4gICAgICAgICAgICAgICAgaWYgKHYpIHtcbiAgICAgICAgICAgICAgICAgICAgcmV0dXJuIGE7XG4gICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICAgIGVsc2Uge1xuICAgICAgICAgICAgICAgICAgICByZXR1cm4gMDtcbiAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICB9LFxuICAgICAgICAgICAgcmV0dXJuUHJvcGVydHk6ICdiYXNlRGFtYWdlTXVsdGlwbGllcidcbiAgICAgICAgfVxuICAgIF0sXG4gICAgJ2VhcnRoc2hha2VyX2VjaG9fc2xhbSc6IFtcbiAgICAgICAge1xuICAgICAgICAgICAgbGFiZWw6ICdFbmVtaWVzIGluIFJhbmdlJyxcbiAgICAgICAgICAgIGNvbnRyb2xUeXBlOiAnaW5wdXQnXG4gICAgICAgIH0sXG4gICAgICAgIHtcbiAgICAgICAgICAgIGF0dHJpYnV0ZU5hbWU6ICdlY2hvX3NsYW1fZWNob19kYW1hZ2UnLFxuICAgICAgICAgICAgbGFiZWw6ICdUb3RhbCBEYW1hZ2UnLFxuICAgICAgICAgICAgY29udHJvbFR5cGU6ICd0ZXh0JyxcbiAgICAgICAgICAgIGZuOiBmdW5jdGlvbiAodiwgYSwgcGFyZW50LCBpbmRleCwgYWJpbGl0eU1vZGVsLCBhYmlsaXR5KSB7XG4gICAgICAgICAgICAgICAgcmV0dXJuIHYqYTtcbiAgICAgICAgICAgIH1cbiAgICAgICAgfVxuICAgIF0sXG4gICAgJ2VsZGVyX3RpdGFuX2FuY2VzdHJhbF9zcGlyaXQnOiBbXG4gICAgICAgIHtcbiAgICAgICAgICAgIGxhYmVsOiAnSEVST0VTIFBBU1NFRCBUSFJPVUdIJyxcbiAgICAgICAgICAgIGNvbnRyb2xUeXBlOiAnaW5wdXQnXG4gICAgICAgIH0sXG4gICAgICAgIHtcbiAgICAgICAgICAgIGxhYmVsOiAnQ1JFRVBTIFBBU1NFRCBUSFJPVUdIJyxcbiAgICAgICAgICAgIGNvbnRyb2xUeXBlOiAnaW5wdXQnXG4gICAgICAgIH0sXG4gICAgICAgIHtcbiAgICAgICAgICAgIGF0dHJpYnV0ZU5hbWU6ICdkYW1hZ2VfY3JlZXBzJyxcbiAgICAgICAgICAgIGxhYmVsOiAnREFNQUdFOicsXG4gICAgICAgICAgICBpZ25vcmVUb29sdGlwOiB0cnVlLFxuICAgICAgICAgICAgY29udHJvbFR5cGU6ICd0ZXh0JyxcbiAgICAgICAgICAgIGNvbnRyb2xzOiBbMCwxXSxcbiAgICAgICAgICAgIGZuOiBmdW5jdGlvbiAodiwgYSwgcGFyZW50LCBpbmRleCwgYWJpbGl0eU1vZGVsLCBhYmlsaXR5KSB7XG4gICAgICAgICAgICAgICAgcmV0dXJuIHZbMF0qYWJpbGl0eU1vZGVsLmdldEFiaWxpdHlBdHRyaWJ1dGVWYWx1ZShhYmlsaXR5LmF0dHJpYnV0ZXMsICdkYW1hZ2VfaGVyb2VzJyxhYmlsaXR5LmxldmVsKCkpICsgdlsxXSphO1xuICAgICAgICAgICAgfSxcbiAgICAgICAgICAgIHJldHVyblByb3BlcnR5OiAnYm9udXNEYW1hZ2UnXG4gICAgICAgIH0sXG4gICAgICAgIHtcbiAgICAgICAgICAgIGF0dHJpYnV0ZU5hbWU6ICdtb3ZlX3BjdF9jcmVlcHMnLFxuICAgICAgICAgICAgbGFiZWw6ICclQk9OVVMgU1BFRUQ6JyxcbiAgICAgICAgICAgIGlnbm9yZVRvb2x0aXA6IHRydWUsXG4gICAgICAgICAgICBjb250cm9sVHlwZTogJ3RleHQnLFxuICAgICAgICAgICAgY29udHJvbHM6IFswLDFdLFxuICAgICAgICAgICAgZm46IGZ1bmN0aW9uICh2LCBhLCBwYXJlbnQsIGluZGV4LCBhYmlsaXR5TW9kZWwsIGFiaWxpdHkpIHtcbiAgICAgICAgICAgICAgICByZXR1cm4gdlswXSphYmlsaXR5TW9kZWwuZ2V0QWJpbGl0eUF0dHJpYnV0ZVZhbHVlKGFiaWxpdHkuYXR0cmlidXRlcywgJ21vdmVfcGN0X2hlcm9lcycsYWJpbGl0eS5sZXZlbCgpKSArIHZbMV0qYTtcbiAgICAgICAgICAgIH0sXG4gICAgICAgICAgICByZXR1cm5Qcm9wZXJ0eTogJ21vdmVtZW50U3BlZWRQY3QnXG4gICAgICAgIH1cbiAgICBdLFxuICAgICdlbGRlcl90aXRhbl9lYXJ0aF9zcGxpdHRlcic6IFtcbiAgICAgICAge1xuICAgICAgICAgICAgbGFiZWw6ICdFbmVteSBNYXggSGVhbHRoJyxcbiAgICAgICAgICAgIGNvbnRyb2xUeXBlOiAnaW5wdXQnXG4gICAgICAgIH0sXG4gICAgICAgIHtcbiAgICAgICAgICAgIGF0dHJpYnV0ZU5hbWU6ICdkYW1hZ2VfcGN0JyxcbiAgICAgICAgICAgIGxhYmVsOiAnVG90YWwgRGFtYWdlJyxcbiAgICAgICAgICAgIGNvbnRyb2xUeXBlOiAndGV4dCcsXG4gICAgICAgICAgICBmbjogZnVuY3Rpb24gKHYsIGEsIHBhcmVudCwgaW5kZXgsIGFiaWxpdHlNb2RlbCwgYWJpbGl0eSkge1xuICAgICAgICAgICAgICAgIHJldHVybiB2KmEvMTAwO1xuICAgICAgICAgICAgfVxuICAgICAgICB9LFxuICAgICAgICB7XG4gICAgICAgICAgICBhdHRyaWJ1dGVOYW1lOiAnc2xvd19wY3QnLFxuICAgICAgICAgICAgbGFiZWw6ICdUb3RhbCBEYW1hZ2UnLFxuICAgICAgICAgICAgY29udHJvbFR5cGU6ICd0ZXh0JyxcbiAgICAgICAgICAgIGZuOiBmdW5jdGlvbiAodiwgYSwgcGFyZW50LCBpbmRleCwgYWJpbGl0eU1vZGVsLCBhYmlsaXR5KSB7XG4gICAgICAgICAgICAgICAgcmV0dXJuIC1hO1xuICAgICAgICAgICAgfSxcbiAgICAgICAgICAgIHJldHVyblByb3BlcnR5OiAnbW92ZW1lbnRTcGVlZFBjdFJlZHVjdGlvbidcbiAgICAgICAgfVxuICAgIF0sXG4gICAgJ2VuY2hhbnRyZXNzX25hdHVyZXNfYXR0ZW5kYW50cyc6IFtcbiAgICAgICAge1xuICAgICAgICAgICAgbGFiZWw6ICdEdXJhdGlvbicsXG4gICAgICAgICAgICBjb250cm9sVHlwZTogJ2lucHV0J1xuICAgICAgICB9LFxuICAgICAgICB7XG4gICAgICAgICAgICBhdHRyaWJ1dGVOYW1lOiAnaGVhbCcsXG4gICAgICAgICAgICBsYWJlbDogJ0hFQUw6JyxcbiAgICAgICAgICAgIGlnbm9yZVRvb2x0aXA6IHRydWUsXG4gICAgICAgICAgICBjb250cm9sVHlwZTogJ3RleHQnLFxuICAgICAgICAgICAgZm46IGZ1bmN0aW9uICh2LCBhLCBwYXJlbnQsIGluZGV4LCBhYmlsaXR5TW9kZWwsIGFiaWxpdHkpIHtcbiAgICAgICAgICAgICAgICByZXR1cm4gYWJpbGl0eU1vZGVsLmdldEFiaWxpdHlBdHRyaWJ1dGVWYWx1ZShhYmlsaXR5LmF0dHJpYnV0ZXMsICd3aXNwX2NvdW50JyxhYmlsaXR5LmxldmVsKCkpKnYqYTtcbiAgICAgICAgICAgIH1cbiAgICAgICAgfVxuICAgIF0sXG4gICAgJ2VuaWdtYV9tYWxlZmljZSc6IFtcbiAgICAgICAge1xuICAgICAgICAgICAgbGFiZWw6ICdIaXRzJyxcbiAgICAgICAgICAgIGNvbnRyb2xUeXBlOiAnaW5wdXQnXG4gICAgICAgIH0sXG4gICAgICAgIHtcbiAgICAgICAgICAgIGF0dHJpYnV0ZU5hbWU6ICdkYW1hZ2UnLFxuICAgICAgICAgICAgbGFiZWw6ICdEQU1BR0U6JyxcbiAgICAgICAgICAgIGlnbm9yZVRvb2x0aXA6IHRydWUsXG4gICAgICAgICAgICBjb250cm9sVHlwZTogJ3RleHQnLFxuICAgICAgICAgICAgZm46IGZ1bmN0aW9uICh2LCBhLCBwYXJlbnQsIGluZGV4LCBhYmlsaXR5TW9kZWwsIGFiaWxpdHkpIHtcbiAgICAgICAgICAgICAgICByZXR1cm4gdiphO1xuICAgICAgICAgICAgfVxuICAgICAgICB9LFxuICAgICAgICB7XG4gICAgICAgICAgICBhdHRyaWJ1dGVOYW1lOiAnc3R1bl9kdXJhdGlvbicsXG4gICAgICAgICAgICBsYWJlbDogJ1RvdGFsIERhbWFnZScsXG4gICAgICAgICAgICBjb250cm9sVHlwZTogJ3RleHQnLFxuICAgICAgICAgICAgZm46IGZ1bmN0aW9uICh2LCBhLCBwYXJlbnQsIGluZGV4LCBhYmlsaXR5TW9kZWwsIGFiaWxpdHkpIHtcbiAgICAgICAgICAgICAgICByZXR1cm4gdiphO1xuICAgICAgICAgICAgfVxuICAgICAgICB9XG4gICAgXSxcbiAgICAnZW5pZ21hX21pZG5pZ2h0X3B1bHNlJzogW1xuICAgICAgICB7XG4gICAgICAgICAgICBsYWJlbDogJ0R1cmF0aW9uJyxcbiAgICAgICAgICAgIGNvbnRyb2xUeXBlOiAnaW5wdXQnXG4gICAgICAgIH0sXG4gICAgICAgIHtcbiAgICAgICAgICAgIGxhYmVsOiAnRW5lbXkgTWF4IEhlYWx0aCcsXG4gICAgICAgICAgICBjb250cm9sVHlwZTogJ2lucHV0J1xuICAgICAgICB9LFxuICAgICAgICB7XG4gICAgICAgICAgICBhdHRyaWJ1dGVOYW1lOiAnZGFtYWdlX3BlcmNlbnQnLFxuICAgICAgICAgICAgbGFiZWw6ICdEQU1BR0U6JyxcbiAgICAgICAgICAgIGlnbm9yZVRvb2x0aXA6IHRydWUsXG4gICAgICAgICAgICBjb250cm9sVHlwZTogJ3RleHQnLFxuICAgICAgICAgICAgY29udHJvbHM6IFswLDFdLFxuICAgICAgICAgICAgZm46IGZ1bmN0aW9uICh2LCBhLCBwYXJlbnQsIGluZGV4LCBhYmlsaXR5TW9kZWwsIGFiaWxpdHkpIHtcbiAgICAgICAgICAgICAgICByZXR1cm4gdlswXSp2WzFdKmEvMTAwO1xuICAgICAgICAgICAgfVxuICAgICAgICB9XG4gICAgXSxcbiAgICAnZW5pZ21hX2JsYWNrX2hvbGUnOiBbXG4gICAgICAgIHtcbiAgICAgICAgICAgIGxhYmVsOiAnRHVyYXRpb24nLFxuICAgICAgICAgICAgY29udHJvbFR5cGU6ICdpbnB1dCdcbiAgICAgICAgfSxcbiAgICAgICAge1xuICAgICAgICAgICAgYXR0cmlidXRlTmFtZTogJ2Zhcl9kYW1hZ2UnLFxuICAgICAgICAgICAgbGFiZWw6ICdUb3RhbCBEYW1hZ2UnLFxuICAgICAgICAgICAgY29udHJvbFR5cGU6ICd0ZXh0JyxcbiAgICAgICAgICAgIGZuOiBmdW5jdGlvbiAodiwgYSwgcGFyZW50LCBpbmRleCwgYWJpbGl0eU1vZGVsLCBhYmlsaXR5KSB7XG4gICAgICAgICAgICAgICAgcmV0dXJuIHYqYTtcbiAgICAgICAgICAgIH1cbiAgICAgICAgfSxcbiAgICAgICAge1xuICAgICAgICAgICAgYXR0cmlidXRlTmFtZTogJ25lYXJfZGFtYWdlJyxcbiAgICAgICAgICAgIGxhYmVsOiAnVG90YWwgRGFtYWdlJyxcbiAgICAgICAgICAgIGNvbnRyb2xUeXBlOiAndGV4dCcsXG4gICAgICAgICAgICBmbjogZnVuY3Rpb24gKHYsIGEsIHBhcmVudCwgaW5kZXgsIGFiaWxpdHlNb2RlbCwgYWJpbGl0eSkge1xuICAgICAgICAgICAgICAgIHJldHVybiB2KmE7XG4gICAgICAgICAgICB9XG4gICAgICAgIH1cbiAgICBdLFxuICAgICdmYWNlbGVzc192b2lkX3RpbWVfbG9jayc6IFtcbiAgICAgICAge1xuICAgICAgICAgICAgbGFiZWw6ICdJbiBDaHJvbm9zcGhlcmUnLFxuICAgICAgICAgICAgY29udHJvbFR5cGU6ICdjaGVja2JveCdcbiAgICAgICAgfSxcbiAgICAgICAge1xuICAgICAgICAgICAgYXR0cmlidXRlTmFtZTogJ2JvbnVzX2RhbWFnZScsXG4gICAgICAgICAgICBsYWJlbDogJyVNT1ZFU1BFRUQgQVMgREFNQUdFJyxcbiAgICAgICAgICAgIGNvbnRyb2xUeXBlOiAndGV4dCcsXG4gICAgICAgICAgICBmbjogZnVuY3Rpb24gKHYsIGEsIHBhcmVudCwgaW5kZXgsIGFiaWxpdHlNb2RlbCwgYWJpbGl0eSkge1xuICAgICAgICAgICAgICAgIGlmICh2KSB7XG4gICAgICAgICAgICAgICAgICAgIHJldHVybiBhKjI7XG4gICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICAgIGVsc2Uge1xuICAgICAgICAgICAgICAgICAgICByZXR1cm4gYTtcbiAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICB9LFxuICAgICAgICAgICAgcmV0dXJuUHJvcGVydHk6ICdiYXNoQm9udXNEYW1hZ2UnXG4gICAgICAgIH0sXG4gICAgICAgIHtcbiAgICAgICAgICAgIGF0dHJpYnV0ZU5hbWU6ICdkdXJhdGlvbicsXG4gICAgICAgICAgICBsYWJlbDogJ1RvdGFsIERhbWFnZScsXG4gICAgICAgICAgICBjb250cm9sVHlwZTogJ3RleHQnLFxuICAgICAgICAgICAgZm46IGZ1bmN0aW9uICh2LCBhLCBwYXJlbnQsIGluZGV4LCBhYmlsaXR5TW9kZWwsIGFiaWxpdHkpIHtcbiAgICAgICAgICAgICAgICByZXR1cm4gYTtcbiAgICAgICAgICAgIH1cbiAgICAgICAgfSxcbiAgICAgICAge1xuICAgICAgICAgICAgYXR0cmlidXRlTmFtZTogJ2NoYW5jZV9wY3QnLFxuICAgICAgICAgICAgbGFiZWw6ICdUb3RhbCBEYW1hZ2UnLFxuICAgICAgICAgICAgY29udHJvbFR5cGU6ICd0ZXh0JyxcbiAgICAgICAgICAgIGZuOiBmdW5jdGlvbiAodiwgYSwgcGFyZW50LCBpbmRleCwgYWJpbGl0eU1vZGVsLCBhYmlsaXR5KSB7XG4gICAgICAgICAgICAgICAgcmV0dXJuIGE7XG4gICAgICAgICAgICB9LFxuICAgICAgICAgICAgcmV0dXJuUHJvcGVydHk6ICdiYXNoJ1xuICAgICAgICB9XG4gICAgXSxcbiAgICAnZ3lyb2NvcHRlcl9yb2NrZXRfYmFycmFnZSc6IFtcbiAgICAgICAge1xuICAgICAgICAgICAgbGFiZWw6ICdSb2NrZXRzJyxcbiAgICAgICAgICAgIGNvbnRyb2xUeXBlOiAnaW5wdXQnXG4gICAgICAgIH0sXG4gICAgICAgIHtcbiAgICAgICAgICAgIGF0dHJpYnV0ZU5hbWU6ICdyb2NrZXRzX3Blcl9zZWNvbmQnLFxuICAgICAgICAgICAgbGFiZWw6ICdUb3RhbCBEYW1hZ2UnLFxuICAgICAgICAgICAgY29udHJvbFR5cGU6ICd0ZXh0JyxcbiAgICAgICAgICAgIGZuOiBmdW5jdGlvbiAodiwgYSwgcGFyZW50LCBpbmRleCwgYWJpbGl0eU1vZGVsLCBhYmlsaXR5KSB7XG4gICAgICAgICAgICAgICAgcmV0dXJuIGE7XG4gICAgICAgICAgICB9XG4gICAgICAgIH0sXG4gICAgICAgIHtcbiAgICAgICAgICAgIGxhYmVsOiAnREFNQUdFOicsXG4gICAgICAgICAgICBjb250cm9sVHlwZTogJ3RleHQnLFxuICAgICAgICAgICAgZm46IGZ1bmN0aW9uICh2LCBhLCBwYXJlbnQsIGluZGV4LCBhYmlsaXR5TW9kZWwsIGFiaWxpdHkpIHtcbiAgICAgICAgICAgICAgICByZXR1cm4gYWJpbGl0eU1vZGVsLmdldEFiaWxpdHlQcm9wZXJ0eVZhbHVlKGFiaWxpdHksICdkYW1hZ2UnKSp2O1xuICAgICAgICAgICAgfVxuICAgICAgICB9XG4gICAgXSxcbi8qICAgICAgICAnZ3lyb2NvcHRlcl9ob21pbmdfbWlzc2lsZSc6IFtcbiAgICAgICAge1xuICAgICAgICAgICAgbGFiZWw6ICdEaXN0YW5jZSBUcmF2ZWxlZCcsXG4gICAgICAgICAgICBjb250cm9sVHlwZTogJ2lucHV0J1xuICAgICAgICB9LFxuICAgICAgICB7XG4gICAgICAgICAgICBhdHRyaWJ1dGVOYW1lOiAnZGFtYWdlJyxcbiAgICAgICAgICAgIGxhYmVsOiAnVG90YWwgRGFtYWdlJyxcbiAgICAgICAgICAgIGNvbnRyb2xUeXBlOiAndGV4dCcsXG4gICAgICAgICAgICBmbjogZnVuY3Rpb24gKHYsIGEsIHBhcmVudCwgaW5kZXgsIGFiaWxpdHlNb2RlbCwgYWJpbGl0eSkge1xuICAgICAgICAgICAgICAgIHJldHVybiB2KmE7XG4gICAgICAgICAgICB9XG4gICAgICAgIH1cbiAgICBdLFxuICAgICdneXJvY29wdGVyX2ZsYWtfY2Fubm9uJzogW1xuICAgICAgICB7XG4gICAgICAgICAgICBsYWJlbDogJ0F0dGFja3MnLFxuICAgICAgICAgICAgY29udHJvbFR5cGU6ICdpbnB1dCdcbiAgICAgICAgfSxcbiAgICAgICAge1xuICAgICAgICAgICAgYXR0cmlidXRlTmFtZTogJ2RhbWFnZScsXG4gICAgICAgICAgICBsYWJlbDogJ1RvdGFsIERhbWFnZScsXG4gICAgICAgICAgICBjb250cm9sVHlwZTogJ3RleHQnLFxuICAgICAgICAgICAgZm46IGZ1bmN0aW9uICh2LCBhLCBwYXJlbnQsIGluZGV4LCBhYmlsaXR5TW9kZWwsIGFiaWxpdHkpIHtcbiAgICAgICAgICAgICAgICByZXR1cm4gdiphO1xuICAgICAgICAgICAgfVxuICAgICAgICB9XG4gICAgXSwqL1xuICAgICdodXNrYXJfYnVybmluZ19zcGVhcic6IFtcbiAgICAgICAge1xuICAgICAgICAgICAgbGFiZWw6ICdTdGFja3MnLFxuICAgICAgICAgICAgY29udHJvbFR5cGU6ICdpbnB1dCdcbiAgICAgICAgfSxcbiAgICAgICAge1xuICAgICAgICAgICAgYXR0cmlidXRlTmFtZTogJ2hlYWx0aF9jb3N0JyxcbiAgICAgICAgICAgIGxhYmVsOiAnVG90YWwgRGFtYWdlJyxcbiAgICAgICAgICAgIGNvbnRyb2xUeXBlOiAndGV4dCcsXG4gICAgICAgICAgICBmbjogZnVuY3Rpb24gKHYsIGEsIHBhcmVudCwgaW5kZXgsIGFiaWxpdHlNb2RlbCwgYWJpbGl0eSkge1xuICAgICAgICAgICAgICAgIHJldHVybiB2KmE7XG4gICAgICAgICAgICB9XG4gICAgICAgIH0sXG4gICAgICAgIHtcbiAgICAgICAgICAgIGxhYmVsOiAnREFNQUdFOicsXG4gICAgICAgICAgICBjb250cm9sVHlwZTogJ3RleHQnLFxuICAgICAgICAgICAgZm46IGZ1bmN0aW9uICh2LCBhLCBwYXJlbnQsIGluZGV4LCBhYmlsaXR5TW9kZWwsIGFiaWxpdHkpIHtcbiAgICAgICAgICAgICAgICByZXR1cm4gYWJpbGl0eU1vZGVsLmdldEFiaWxpdHlQcm9wZXJ0eVZhbHVlKGFiaWxpdHksICdkYW1hZ2UnKSp2O1xuICAgICAgICAgICAgfVxuICAgICAgICB9XG4gICAgXSxcbiAgICAnaHVza2FyX2JlcnNlcmtlcnNfYmxvb2QnOiBbXG4gICAgICAgIHtcbiAgICAgICAgICAgIGxhYmVsOiAnJUhQJyxcbiAgICAgICAgICAgIGNvbnRyb2xUeXBlOiAnaW5wdXQnXG4gICAgICAgIH0sXG4gICAgICAgIHtcbiAgICAgICAgICAgIGF0dHJpYnV0ZU5hbWU6ICdocF90aHJlc2hvbGRfbWF4JyxcbiAgICAgICAgICAgIGxhYmVsOiAnSGVhbHRoIGF0IGdpdmVuICVIUDonLFxuICAgICAgICAgICAgaWdub3JlVG9vbHRpcDogdHJ1ZSxcbiAgICAgICAgICAgIGNvbnRyb2xUeXBlOiAndGV4dCcsXG4gICAgICAgICAgICBmbjogZnVuY3Rpb24gKHYsIGEsIHBhcmVudCwgaW5kZXgsIGFiaWxpdHlNb2RlbCwgYWJpbGl0eSkge1xuICAgICAgICAgICAgICAgIHJldHVybiBwYXJlbnQuaGVhbHRoKCkqdi8xMDA7XG4gICAgICAgICAgICB9XG4gICAgICAgIH0sXG4gICAgICAgIHtcbiAgICAgICAgICAgIGF0dHJpYnV0ZU5hbWU6ICdocF90aHJlc2hvbGRfbWF4JyxcbiAgICAgICAgICAgIGxhYmVsOiAnVG90YWwgRGFtYWdlJyxcbiAgICAgICAgICAgIGNvbnRyb2xUeXBlOiAndGV4dCcsXG4gICAgICAgICAgICBmbjogZnVuY3Rpb24gKHYsIGEsIHBhcmVudCwgaW5kZXgsIGFiaWxpdHlNb2RlbCwgYWJpbGl0eSkge1xuICAgICAgICAgICAgICAgIHJldHVybiBhO1xuICAgICAgICAgICAgfVxuICAgICAgICB9LFxuICAgICAgICB7XG4gICAgICAgICAgICBhdHRyaWJ1dGVOYW1lOiAnbWF4aW11bV9yZXNpc3RhbmNlJyxcbiAgICAgICAgICAgIGxhYmVsOiAnTUFHSUMgUkVTSVNUQU5DRSBCT05VUzonLFxuICAgICAgICAgICAgaWdub3JlVG9vbHRpcDogdHJ1ZSxcbiAgICAgICAgICAgIGNvbnRyb2xUeXBlOiAndGV4dCcsXG4gICAgICAgICAgICBmbjogZnVuY3Rpb24gKHYsIGEsIHBhcmVudCwgaW5kZXgsIGFiaWxpdHlNb2RlbCwgYWJpbGl0eSkge1xuICAgICAgICAgICAgICAgIHZhciB2ID0gTWF0aC5taW4odiwgMTAwKTtcbiAgICAgICAgICAgICAgICB2ID0gTWF0aC5tYXgodiwgMTApO1xuICAgICAgICAgICAgICAgIHZhciBocF90aHJlc2hvbGRfbWF4ID0gYWJpbGl0eU1vZGVsLmdldEFiaWxpdHlBdHRyaWJ1dGVWYWx1ZShhYmlsaXR5LmF0dHJpYnV0ZXMsICdocF90aHJlc2hvbGRfbWF4JywwKTtcbiAgICAgICAgICAgICAgICB2YXIgZCA9IDEwMCAtIGhwX3RocmVzaG9sZF9tYXg7XG4gICAgICAgICAgICAgICAgdmFyIGMgPSAodiAtIGhwX3RocmVzaG9sZF9tYXgpIC8gZDtcbiAgICAgICAgICAgICAgICBjID0gMSAtIGM7XG4gICAgICAgICAgICAgICAgcmV0dXJuIGMqYTtcbiAgICAgICAgICAgIH0sXG4gICAgICAgICAgICByZXR1cm5Qcm9wZXJ0eTogJ21hZ2ljUmVzaXN0J1xuICAgICAgICB9LFxuICAgICAgICB7XG4gICAgICAgICAgICBhdHRyaWJ1dGVOYW1lOiAnbWF4aW11bV9hdHRhY2tfc3BlZWQnLFxuICAgICAgICAgICAgbGFiZWw6ICdBVFRBQ0sgU1BFRUQgQk9OVVM6JyxcbiAgICAgICAgICAgIGlnbm9yZVRvb2x0aXA6IHRydWUsXG4gICAgICAgICAgICBjb250cm9sVHlwZTogJ3RleHQnLFxuICAgICAgICAgICAgZm46IGZ1bmN0aW9uICh2LCBhLCBwYXJlbnQsIGluZGV4LCBhYmlsaXR5TW9kZWwsIGFiaWxpdHkpIHtcbiAgICAgICAgICAgICAgICB2YXIgdiA9IE1hdGgubWluKHYsIDEwMCk7XG4gICAgICAgICAgICAgICAgdiA9IE1hdGgubWF4KHYsIDEwKTtcbiAgICAgICAgICAgICAgICB2YXIgaHBfdGhyZXNob2xkX21heCA9IGFiaWxpdHlNb2RlbC5nZXRBYmlsaXR5QXR0cmlidXRlVmFsdWUoYWJpbGl0eS5hdHRyaWJ1dGVzLCAnaHBfdGhyZXNob2xkX21heCcsMCk7XG4gICAgICAgICAgICAgICAgdmFyIGQgPSAxMDAgLSBocF90aHJlc2hvbGRfbWF4O1xuICAgICAgICAgICAgICAgIHZhciBjID0gKHYgLSBocF90aHJlc2hvbGRfbWF4KSAvIGQ7XG4gICAgICAgICAgICAgICAgYyA9IDEgLSBjO1xuICAgICAgICAgICAgICAgIHJldHVybiBjKmE7XG4gICAgICAgICAgICB9LFxuICAgICAgICAgICAgcmV0dXJuUHJvcGVydHk6ICdhdHRhY2tzcGVlZCdcbiAgICAgICAgfVxuICAgIF0sXG4gICAgJ2h1c2thcl9saWZlX2JyZWFrJzogW1xuICAgICAgICB7XG4gICAgICAgICAgICBsYWJlbDogJ0VuZW15IEN1cnJlbnQgSFAnLFxuICAgICAgICAgICAgY29udHJvbFR5cGU6ICdpbnB1dCdcbiAgICAgICAgfSxcbiAgICAgICAge1xuICAgICAgICAgICAgYXR0cmlidXRlTmFtZTogJ2hlYWx0aF9kYW1hZ2UnLFxuICAgICAgICAgICAgbGFiZWw6ICdEQU1BR0U6JyxcbiAgICAgICAgICAgIGlnbm9yZVRvb2x0aXA6IHRydWUsXG4gICAgICAgICAgICBjb250cm9sVHlwZTogJ3RleHQnLFxuICAgICAgICAgICAgZm46IGZ1bmN0aW9uICh2LCBhLCBwYXJlbnQsIGluZGV4LCBhYmlsaXR5TW9kZWwsIGFiaWxpdHkpIHtcbiAgICAgICAgICAgICAgICByZXR1cm4gdiphO1xuICAgICAgICAgICAgfVxuICAgICAgICB9LFxuICAgICAgICB7XG4gICAgICAgICAgICBsYWJlbDogJ0h1c2thciBDdXJyZW50IEhQJyxcbiAgICAgICAgICAgIGNvbnRyb2xUeXBlOiAnaW5wdXQnXG4gICAgICAgIH0sXG4gICAgICAgIHtcbiAgICAgICAgICAgIGF0dHJpYnV0ZU5hbWU6ICdoZWFsdGhfY29zdF9wZXJjZW50JyxcbiAgICAgICAgICAgIGxhYmVsOiAnREFNQUdFIFRBS0VOOicsXG4gICAgICAgICAgICBpZ25vcmVUb29sdGlwOiB0cnVlLFxuICAgICAgICAgICAgY29udHJvbFR5cGU6ICd0ZXh0JyxcbiAgICAgICAgICAgIGZuOiBmdW5jdGlvbiAodiwgYSwgcGFyZW50LCBpbmRleCwgYWJpbGl0eU1vZGVsLCBhYmlsaXR5KSB7XG4gICAgICAgICAgICAgICAgcmV0dXJuIHYqYTtcbiAgICAgICAgICAgIH1cbiAgICAgICAgfSxcbiAgICAgICAge1xuICAgICAgICAgICAgYXR0cmlidXRlTmFtZTogJ21vdmVzcGVlZCcsXG4gICAgICAgICAgICBsYWJlbDogJ1RvdGFsIERhbWFnZScsXG4gICAgICAgICAgICBjb250cm9sVHlwZTogJ3RleHQnLFxuICAgICAgICAgICAgZm46IGZ1bmN0aW9uICh2LCBhLCBwYXJlbnQsIGluZGV4LCBhYmlsaXR5TW9kZWwsIGFiaWxpdHkpIHtcbiAgICAgICAgICAgICAgICByZXR1cm4gYTtcbiAgICAgICAgICAgIH0sXG4gICAgICAgICAgICByZXR1cm5Qcm9wZXJ0eTogJ21vdmVtZW50U3BlZWRQY3RSZWR1Y3Rpb24nXG4gICAgICAgIH1cbiAgICBdLFxuICAgICdpbnZva2VyX3F1YXMnOiBbXG4gICAgICAgIHtcbiAgICAgICAgICAgIGxhYmVsOiAnSW5zdGFuY2VzJyxcbiAgICAgICAgICAgIGNvbnRyb2xUeXBlOiAnaW5wdXQnXG4gICAgICAgIH0sXG4gICAgICAgIC8qe1xuICAgICAgICAgICAgYXR0cmlidXRlTmFtZTogJ2JvbnVzX3N0cmVuZ3RoJyxcbiAgICAgICAgICAgIGxhYmVsOiAnVG90YWwgRGFtYWdlJyxcbiAgICAgICAgICAgIGNvbnRyb2xUeXBlOiAndGV4dCcsXG4gICAgICAgICAgICBmbjogZnVuY3Rpb24gKHYsIGEsIHBhcmVudCwgaW5kZXgsIGFiaWxpdHlNb2RlbCwgYWJpbGl0eSkge1xuICAgICAgICAgICAgICAgIHJldHVybiBhO1xuICAgICAgICAgICAgfSxcbiAgICAgICAgICAgIHJldHVyblByb3BlcnR5OiAnYm9udXNTdHJlbmd0aCdcbiAgICAgICAgfSwqL1xuICAgICAgICB7XG4gICAgICAgICAgICBhdHRyaWJ1dGVOYW1lOiAnaGVhbHRoX3JlZ2VuX3Blcl9pbnN0YW5jZScsXG4gICAgICAgICAgICBsYWJlbDogJ0hQIFJFR0VOOicsXG4gICAgICAgICAgICBpZ25vcmVUb29sdGlwOiB0cnVlLFxuICAgICAgICAgICAgY29udHJvbFR5cGU6ICd0ZXh0JyxcbiAgICAgICAgICAgIGZuOiBmdW5jdGlvbiAodiwgYSwgcGFyZW50LCBpbmRleCwgYWJpbGl0eU1vZGVsLCBhYmlsaXR5KSB7XG4gICAgICAgICAgICAgICAgcmV0dXJuIHYqYTtcbiAgICAgICAgICAgIH0sXG4gICAgICAgICAgICByZXR1cm5Qcm9wZXJ0eTogJ2hlYWx0aHJlZ2VuJ1xuICAgICAgICB9XG4gICAgXSxcbiAgICAnaW52b2tlcl93ZXgnOiBbXG4gICAgICAgIHtcbiAgICAgICAgICAgIGxhYmVsOiAnSW5zdGFuY2VzJyxcbiAgICAgICAgICAgIGNvbnRyb2xUeXBlOiAnaW5wdXQnXG4gICAgICAgIH0sXG4gICAgICAgIC8qe1xuICAgICAgICAgICAgYXR0cmlidXRlTmFtZTogJ2JvbnVzX2FnaWxpdHknLFxuICAgICAgICAgICAgbGFiZWw6ICdUb3RhbCBEYW1hZ2UnLFxuICAgICAgICAgICAgY29udHJvbFR5cGU6ICd0ZXh0JyxcbiAgICAgICAgICAgIGZuOiBmdW5jdGlvbiAodiwgYSwgcGFyZW50LCBpbmRleCwgYWJpbGl0eU1vZGVsLCBhYmlsaXR5KSB7XG4gICAgICAgICAgICAgICAgcmV0dXJuIGE7XG4gICAgICAgICAgICB9LFxuICAgICAgICAgICAgcmV0dXJuUHJvcGVydHk6ICdib251c0FnaWxpdHknXG4gICAgICAgIH0sKi9cbiAgICAgICAge1xuICAgICAgICAgICAgYXR0cmlidXRlTmFtZTogJ21vdmVfc3BlZWRfcGVyX2luc3RhbmNlJyxcbiAgICAgICAgICAgIGxhYmVsOiAnJU1PVkUgU1BFRUQ6JyxcbiAgICAgICAgICAgIGlnbm9yZVRvb2x0aXA6IHRydWUsXG4gICAgICAgICAgICBjb250cm9sVHlwZTogJ3RleHQnLFxuICAgICAgICAgICAgZm46IGZ1bmN0aW9uICh2LCBhLCBwYXJlbnQsIGluZGV4LCBhYmlsaXR5TW9kZWwsIGFiaWxpdHkpIHtcbiAgICAgICAgICAgICAgICByZXR1cm4gdiphO1xuICAgICAgICAgICAgfSxcbiAgICAgICAgICAgIHJldHVyblByb3BlcnR5OiAnbW92ZW1lbnRTcGVlZFBjdCdcbiAgICAgICAgfSxcbiAgICAgICAge1xuICAgICAgICAgICAgYXR0cmlidXRlTmFtZTogJ2F0dGFja19zcGVlZF9wZXJfaW5zdGFuY2UnLFxuICAgICAgICAgICAgbGFiZWw6ICclQVRUQUNLIFNQRUVEOicsXG4gICAgICAgICAgICBpZ25vcmVUb29sdGlwOiB0cnVlLFxuICAgICAgICAgICAgY29udHJvbFR5cGU6ICd0ZXh0JyxcbiAgICAgICAgICAgIGZuOiBmdW5jdGlvbiAodiwgYSwgcGFyZW50LCBpbmRleCwgYWJpbGl0eU1vZGVsLCBhYmlsaXR5KSB7XG4gICAgICAgICAgICAgICAgcmV0dXJuIHYqYTtcbiAgICAgICAgICAgIH0sXG4gICAgICAgICAgICByZXR1cm5Qcm9wZXJ0eTogJ2F0dGFja3NwZWVkJ1xuICAgICAgICB9XG4gICAgXSxcbiAgICAnaW52b2tlcl9leG9ydCc6IFtcbiAgICAgICAge1xuICAgICAgICAgICAgbGFiZWw6ICdJbnN0YW5jZXMnLFxuICAgICAgICAgICAgY29udHJvbFR5cGU6ICdpbnB1dCdcbiAgICAgICAgfSxcbiAgICAgICAgLyp7XG4gICAgICAgICAgICBhdHRyaWJ1dGVOYW1lOiAnYm9udXNfaW50ZWxsaWdlbmNlJyxcbiAgICAgICAgICAgIGxhYmVsOiAnVG90YWwgRGFtYWdlJyxcbiAgICAgICAgICAgIGNvbnRyb2xUeXBlOiAndGV4dCcsXG4gICAgICAgICAgICBmbjogZnVuY3Rpb24gKHYsIGEsIHBhcmVudCwgaW5kZXgsIGFiaWxpdHlNb2RlbCwgYWJpbGl0eSkge1xuICAgICAgICAgICAgICAgIHJldHVybiBhO1xuICAgICAgICAgICAgfSxcbiAgICAgICAgICAgIHJldHVyblByb3BlcnR5OiAnYm9udXNJbnQnXG4gICAgICAgIH0sKi9cbiAgICAgICAge1xuICAgICAgICAgICAgYXR0cmlidXRlTmFtZTogJ2JvbnVzX2RhbWFnZV9wZXJfaW5zdGFuY2UnLFxuICAgICAgICAgICAgbGFiZWw6ICdEQU1BR0U6JyxcbiAgICAgICAgICAgIGlnbm9yZVRvb2x0aXA6IHRydWUsXG4gICAgICAgICAgICBjb250cm9sVHlwZTogJ3RleHQnLFxuICAgICAgICAgICAgZm46IGZ1bmN0aW9uICh2LCBhLCBwYXJlbnQsIGluZGV4LCBhYmlsaXR5TW9kZWwsIGFiaWxpdHkpIHtcbiAgICAgICAgICAgICAgICByZXR1cm4gdiphO1xuICAgICAgICAgICAgfSxcbiAgICAgICAgICAgIHJldHVyblByb3BlcnR5OiAnYm9udXNEYW1hZ2UnXG4gICAgICAgIH1cbiAgICBdLFxuICAgICdpbnZva2VyX2dob3N0X3dhbGsnOiBbXG4gICAgICAgIHtcbiAgICAgICAgICAgIGxhYmVsOiAnUXVhcyBMZXZlbCcsXG4gICAgICAgICAgICBjb250cm9sVHlwZTogJ2lucHV0J1xuICAgICAgICB9LFxuICAgICAgICB7XG4gICAgICAgICAgICBhdHRyaWJ1dGVOYW1lOiAnZW5lbXlfc2xvdycsXG4gICAgICAgICAgICBsYWJlbDogJ1RvdGFsIERhbWFnZScsXG4gICAgICAgICAgICBjb250cm9sVHlwZTogJ3RleHQnLFxuICAgICAgICAgICAgZm46IGZ1bmN0aW9uICh2LCBhLCBwYXJlbnQsIGluZGV4LCBhYmlsaXR5TW9kZWwsIGFiaWxpdHkpIHtcbiAgICAgICAgICAgICAgICBpZiAodiA9PSAwKSB7XG4gICAgICAgICAgICAgICAgICAgIHJldHVybiAwO1xuICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgICByZXR1cm4gYWJpbGl0eU1vZGVsLmdldEFiaWxpdHlBdHRyaWJ1dGVWYWx1ZShhYmlsaXR5LmF0dHJpYnV0ZXMsICdlbmVteV9zbG93Jyx2KTtcbiAgICAgICAgICAgIH0sXG4gICAgICAgICAgICByZXR1cm5Qcm9wZXJ0eTogJ21vdmVtZW50U3BlZWRQY3RSZWR1Y3Rpb24nXG4gICAgICAgIH0sXG4gICAgICAgIHtcbiAgICAgICAgICAgIGxhYmVsOiAnV2V4IExldmVsJyxcbiAgICAgICAgICAgIGNvbnRyb2xUeXBlOiAnaW5wdXQnLFxuICAgICAgICAgICAgZGlzcGxheTogJ2FiaWxpdHknXG4gICAgICAgIH0sXG4gICAgICAgIHtcbiAgICAgICAgICAgIGF0dHJpYnV0ZU5hbWU6ICdzZWxmX3Nsb3cnLFxuICAgICAgICAgICAgbGFiZWw6ICdUb3RhbCBEYW1hZ2UnLFxuICAgICAgICAgICAgY29udHJvbFR5cGU6ICd0ZXh0JyxcbiAgICAgICAgICAgIGRpc3BsYXk6ICdhYmlsaXR5JyxcbiAgICAgICAgICAgIGZuOiBmdW5jdGlvbiAodiwgYSwgcGFyZW50LCBpbmRleCwgYWJpbGl0eU1vZGVsLCBhYmlsaXR5KSB7XG4gICAgICAgICAgICAgICAgaWYgKHYgPT0gMCkge1xuICAgICAgICAgICAgICAgICAgICByZXR1cm4gMDtcbiAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgICAgcmV0dXJuIGFiaWxpdHlNb2RlbC5nZXRBYmlsaXR5QXR0cmlidXRlVmFsdWUoYWJpbGl0eS5hdHRyaWJ1dGVzLCAnc2VsZl9zbG93Jyx2KTtcbiAgICAgICAgICAgIH0sXG4gICAgICAgICAgICByZXR1cm5Qcm9wZXJ0eTogJ21vdmVtZW50U3BlZWRQY3QnXG4gICAgICAgIH1cbiAgICBdLFxuICAgICdpbnZva2VyX2FsYWNyaXR5JzogW1xuICAgICAgICB7XG4gICAgICAgICAgICBsYWJlbDogJ1dleCBMZXZlbCcsXG4gICAgICAgICAgICBjb250cm9sVHlwZTogJ2lucHV0J1xuICAgICAgICB9LFxuICAgICAgICB7XG4gICAgICAgICAgICBhdHRyaWJ1dGVOYW1lOiAnYm9udXNfYXR0YWNrX3NwZWVkJyxcbiAgICAgICAgICAgIGxhYmVsOiAnVG90YWwgRGFtYWdlJyxcbiAgICAgICAgICAgIGNvbnRyb2xUeXBlOiAndGV4dCcsXG4gICAgICAgICAgICBmbjogZnVuY3Rpb24gKHYsIGEsIHBhcmVudCwgaW5kZXgsIGFiaWxpdHlNb2RlbCwgYWJpbGl0eSkge1xuICAgICAgICAgICAgICAgIGlmICh2ID09IDApIHtcbiAgICAgICAgICAgICAgICAgICAgcmV0dXJuIDA7XG4gICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICAgIHJldHVybiBhYmlsaXR5TW9kZWwuZ2V0QWJpbGl0eUF0dHJpYnV0ZVZhbHVlKGFiaWxpdHkuYXR0cmlidXRlcywgJ2JvbnVzX2F0dGFja19zcGVlZCcsdik7XG4gICAgICAgICAgICB9LFxuICAgICAgICAgICAgcmV0dXJuUHJvcGVydHk6ICdhdHRhY2tzcGVlZCdcbiAgICAgICAgfSxcbiAgICAgICAge1xuICAgICAgICAgICAgbGFiZWw6ICdFeG9ydCBMZXZlbCcsXG4gICAgICAgICAgICBjb250cm9sVHlwZTogJ2lucHV0JyxcbiAgICAgICAgfSxcbiAgICAgICAge1xuICAgICAgICAgICAgYXR0cmlidXRlTmFtZTogJ2JvbnVzX2RhbWFnZScsXG4gICAgICAgICAgICBsYWJlbDogJ1RvdGFsIERhbWFnZScsXG4gICAgICAgICAgICBjb250cm9sVHlwZTogJ3RleHQnLFxuICAgICAgICAgICAgZm46IGZ1bmN0aW9uICh2LCBhLCBwYXJlbnQsIGluZGV4LCBhYmlsaXR5TW9kZWwsIGFiaWxpdHkpIHtcbiAgICAgICAgICAgICAgICBpZiAodiA9PSAwKSB7XG4gICAgICAgICAgICAgICAgICAgIHJldHVybiAwO1xuICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgICByZXR1cm4gYWJpbGl0eU1vZGVsLmdldEFiaWxpdHlBdHRyaWJ1dGVWYWx1ZShhYmlsaXR5LmF0dHJpYnV0ZXMsICdib251c19kYW1hZ2UnLHYpO1xuICAgICAgICAgICAgfSxcbiAgICAgICAgICAgIHJldHVyblByb3BlcnR5OiAnYm9udXNEYW1hZ2UnXG4gICAgICAgIH1cbiAgICBdLFxuICAgICdpbnZva2VyX2ljZV93YWxsJzogW1xuICAgICAgICB7XG4gICAgICAgICAgICBsYWJlbDogJ1F1YXMgTGV2ZWwnLFxuICAgICAgICAgICAgY29udHJvbFR5cGU6ICdpbnB1dCdcbiAgICAgICAgfSxcbiAgICAgICAge1xuICAgICAgICAgICAgYXR0cmlidXRlTmFtZTogJ3Nsb3cnLFxuICAgICAgICAgICAgbGFiZWw6ICdUb3RhbCBEYW1hZ2UnLFxuICAgICAgICAgICAgY29udHJvbFR5cGU6ICd0ZXh0JyxcbiAgICAgICAgICAgIGZuOiBmdW5jdGlvbiAodiwgYSwgcGFyZW50LCBpbmRleCwgYWJpbGl0eU1vZGVsLCBhYmlsaXR5KSB7XG4gICAgICAgICAgICAgICAgaWYgKHYgPT0gMCkge1xuICAgICAgICAgICAgICAgICAgICByZXR1cm4gMDtcbiAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgICAgcmV0dXJuIGFiaWxpdHlNb2RlbC5nZXRBYmlsaXR5QXR0cmlidXRlVmFsdWUoYWJpbGl0eS5hdHRyaWJ1dGVzLCAnc2xvdycsdik7XG4gICAgICAgICAgICB9LFxuICAgICAgICAgICAgcmV0dXJuUHJvcGVydHk6ICdtb3ZlbWVudFNwZWVkUGN0UmVkdWN0aW9uJ1xuICAgICAgICB9LFxuICAgICAgICB7XG4gICAgICAgICAgICBsYWJlbDogJ0V4b3J0IExldmVsJyxcbiAgICAgICAgICAgIGNvbnRyb2xUeXBlOiAnaW5wdXQnLFxuICAgICAgICAgICAgZGlzcGxheTogJ2FiaWxpdHknXG4gICAgICAgIH0sXG4gICAgICAgIHtcbiAgICAgICAgICAgIGxhYmVsOiAnRHVyYXRpb24nLFxuICAgICAgICAgICAgY29udHJvbFR5cGU6ICdpbnB1dCcsXG4gICAgICAgICAgICBkaXNwbGF5OiAnYWJpbGl0eSdcbiAgICAgICAgfSxcbiAgICAgICAge1xuICAgICAgICAgICAgYXR0cmlidXRlTmFtZTogJ2RhbWFnZV9wZXJfc2Vjb25kJyxcbiAgICAgICAgICAgIGxhYmVsOiAnREFNQUdFOicsXG4gICAgICAgICAgICBpZ25vcmVUb29sdGlwOiB0cnVlLFxuICAgICAgICAgICAgY29udHJvbFR5cGU6ICd0ZXh0JyxcbiAgICAgICAgICAgIGRpc3BsYXk6ICdhYmlsaXR5JyxcbiAgICAgICAgICAgIGNvbnRyb2xzOiBbMSwyXSxcbiAgICAgICAgICAgIGZuOiBmdW5jdGlvbiAodiwgYSwgcGFyZW50LCBpbmRleCwgYWJpbGl0eU1vZGVsLCBhYmlsaXR5KSB7XG4gICAgICAgICAgICAgICAgaWYgKHZbMF0gPT0gMCkge1xuICAgICAgICAgICAgICAgICAgICByZXR1cm4gMDtcbiAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgICAgcmV0dXJuIGFiaWxpdHlNb2RlbC5nZXRBYmlsaXR5QXR0cmlidXRlVmFsdWUoYWJpbGl0eS5hdHRyaWJ1dGVzLCAnZGFtYWdlX3Blcl9zZWNvbmQnLHZbMF0pKnZbMV07XG4gICAgICAgICAgICB9XG4gICAgICAgIH1cbiAgICBdLFxuICAgICdqYWtpcm9fZHVhbF9icmVhdGgnOiBbXG4gICAgICAgIHtcbiAgICAgICAgICAgIGxhYmVsOiAnRHVyYXRpb24nLFxuICAgICAgICAgICAgY29udHJvbFR5cGU6ICdpbnB1dCdcbiAgICAgICAgfSxcbiAgICAgICAge1xuICAgICAgICAgICAgbGFiZWw6ICdEQU1BR0U6JyxcbiAgICAgICAgICAgIGNvbnRyb2xUeXBlOiAndGV4dCcsXG4gICAgICAgICAgICBmbjogZnVuY3Rpb24gKHYsIGEsIHBhcmVudCwgaW5kZXgsIGFiaWxpdHlNb2RlbCwgYWJpbGl0eSkge1xuICAgICAgICAgICAgICAgIHJldHVybiBhYmlsaXR5TW9kZWwuZ2V0QWJpbGl0eVByb3BlcnR5VmFsdWUoYWJpbGl0eSwgJ2RhbWFnZScpKjIgKyBcbiAgICAgICAgICAgICAgICBhYmlsaXR5TW9kZWwuZ2V0QWJpbGl0eUF0dHJpYnV0ZVZhbHVlKGFiaWxpdHkuYXR0cmlidXRlcywgJ2J1cm5fZGFtYWdlJyxhYmlsaXR5LmxldmVsKCkpKnY7XG4gICAgICAgICAgICB9XG4gICAgICAgIH0sXG4gICAgICAgIHtcbiAgICAgICAgICAgIGF0dHJpYnV0ZU5hbWU6ICdzbG93X21vdmVtZW50X3NwZWVkX3BjdCcsXG4gICAgICAgICAgICBsYWJlbDogJ1RvdGFsIERhbWFnZScsXG4gICAgICAgICAgICBjb250cm9sVHlwZTogJ3RleHQnLFxuICAgICAgICAgICAgZm46IGZ1bmN0aW9uICh2LCBhLCBwYXJlbnQsIGluZGV4LCBhYmlsaXR5TW9kZWwsIGFiaWxpdHkpIHtcbiAgICAgICAgICAgICAgICByZXR1cm4gYTtcbiAgICAgICAgICAgIH0sXG4gICAgICAgICAgICByZXR1cm5Qcm9wZXJ0eTogJ21vdmVtZW50U3BlZWRQY3RSZWR1Y3Rpb24nXG4gICAgICAgIH0sXG4gICAgICAgIHtcbiAgICAgICAgICAgIGF0dHJpYnV0ZU5hbWU6ICdzbG93X2F0dGFja19zcGVlZF9wY3QnLFxuICAgICAgICAgICAgbGFiZWw6ICclQVRUQUNLIFNMT1c6JyxcbiAgICAgICAgICAgIGlnbm9yZVRvb2x0aXA6IHRydWUsXG4gICAgICAgICAgICBjb250cm9sVHlwZTogJ3RleHQnLFxuICAgICAgICAgICAgZm46IGZ1bmN0aW9uICh2LCBhLCBwYXJlbnQsIGluZGV4LCBhYmlsaXR5TW9kZWwsIGFiaWxpdHkpIHtcbiAgICAgICAgICAgICAgICByZXR1cm4gYTtcbiAgICAgICAgICAgIH0sXG4gICAgICAgICAgICByZXR1cm5Qcm9wZXJ0eTogJ2F0dGFja3NwZWVkcmVkdWN0aW9uJ1xuICAgICAgICB9XG4gICAgXSxcbiAgICAnamFraXJvX2xpcXVpZF9maXJlJzogW1xuICAgICAgICB7XG4gICAgICAgICAgICBsYWJlbDogJ0R1cmF0aW9uJyxcbiAgICAgICAgICAgIGNvbnRyb2xUeXBlOiAnaW5wdXQnXG4gICAgICAgIH0sXG4gICAgICAgIHtcbiAgICAgICAgICAgIGF0dHJpYnV0ZU5hbWU6ICdkYW1hZ2UnLFxuICAgICAgICAgICAgbGFiZWw6ICdUb3RhbCBEYW1hZ2UnLFxuICAgICAgICAgICAgY29udHJvbFR5cGU6ICd0ZXh0JyxcbiAgICAgICAgICAgIGZuOiBmdW5jdGlvbiAodiwgYSwgcGFyZW50LCBpbmRleCwgYWJpbGl0eU1vZGVsLCBhYmlsaXR5KSB7XG4gICAgICAgICAgICAgICAgcmV0dXJuIHYqYTtcbiAgICAgICAgICAgIH1cbiAgICAgICAgfSxcbiAgICAgICAge1xuICAgICAgICAgICAgYXR0cmlidXRlTmFtZTogJ3Nsb3dfYXR0YWNrX3NwZWVkX3BjdCcsXG4gICAgICAgICAgICBsYWJlbDogJ1RvdGFsIERhbWFnZScsXG4gICAgICAgICAgICBjb250cm9sVHlwZTogJ3RleHQnLFxuICAgICAgICAgICAgZm46IGZ1bmN0aW9uICh2LCBhLCBwYXJlbnQsIGluZGV4LCBhYmlsaXR5TW9kZWwsIGFiaWxpdHkpIHtcbiAgICAgICAgICAgICAgICByZXR1cm4gYTtcbiAgICAgICAgICAgIH0sXG4gICAgICAgICAgICByZXR1cm5Qcm9wZXJ0eTogJ2F0dGFja3NwZWVkcmVkdWN0aW9uJ1xuICAgICAgICB9XG4gICAgXSxcbiAgICAnamFraXJvX21hY3JvcHlyZSc6IFtcbiAgICAgICAge1xuICAgICAgICAgICAgbGFiZWw6ICdEdXJhdGlvbicsXG4gICAgICAgICAgICBjb250cm9sVHlwZTogJ2lucHV0J1xuICAgICAgICB9LFxuICAgICAgICB7XG4gICAgICAgICAgICBhdHRyaWJ1dGVOYW1lOiAnZGFtYWdlJyxcbiAgICAgICAgICAgIGxhYmVsOiAnVG90YWwgRGFtYWdlJyxcbiAgICAgICAgICAgIGNvbnRyb2xUeXBlOiAndGV4dCcsXG4gICAgICAgICAgICBmbjogZnVuY3Rpb24gKHYsIGEsIHBhcmVudCwgaW5kZXgsIGFiaWxpdHlNb2RlbCwgYWJpbGl0eSkge1xuICAgICAgICAgICAgICAgIHJldHVybiB2KmE7XG4gICAgICAgICAgICB9XG4gICAgICAgIH1cbiAgICBdLFxuICAgICdqdWdnZXJuYXV0X2JsYWRlX2Z1cnknOiBbXG4gICAgICAgIHtcbiAgICAgICAgICAgIGxhYmVsOiAnRHVyYXRpb24nLFxuICAgICAgICAgICAgY29udHJvbFR5cGU6ICdpbnB1dCdcbiAgICAgICAgfSxcbiAgICAgICAge1xuICAgICAgICAgICAgbGFiZWw6ICdEQU1BR0U6JyxcbiAgICAgICAgICAgIGNvbnRyb2xUeXBlOiAndGV4dCcsXG4gICAgICAgICAgICBmbjogZnVuY3Rpb24gKHYsIGEsIHBhcmVudCwgaW5kZXgsIGFiaWxpdHlNb2RlbCwgYWJpbGl0eSkge1xuICAgICAgICAgICAgICAgIHJldHVybiBhYmlsaXR5TW9kZWwuZ2V0QWJpbGl0eVByb3BlcnR5VmFsdWUoYWJpbGl0eSwgJ2RhbWFnZScpKnY7XG4gICAgICAgICAgICB9XG4gICAgICAgIH1cbiAgICBdLFxuICAgICdqdWdnZXJuYXV0X2hlYWxpbmdfd2FyZCc6IFtcbiAgICAgICAge1xuICAgICAgICAgICAgbGFiZWw6ICdEdXJhdGlvbicsXG4gICAgICAgICAgICBjb250cm9sVHlwZTogJ2lucHV0J1xuICAgICAgICB9LFxuICAgICAgICB7XG4gICAgICAgICAgICBsYWJlbDogJ01heCBIZWFsdGgnLFxuICAgICAgICAgICAgY29udHJvbFR5cGU6ICdpbnB1dCdcbiAgICAgICAgfSxcbiAgICAgICAge1xuICAgICAgICAgICAgYXR0cmlidXRlTmFtZTogJ2hlYWxpbmdfd2FyZF9oZWFsX2Ftb3VudCcsXG4gICAgICAgICAgICBsYWJlbDogJ0hFQUwgT1ZFUiBUSU1FOicsXG4gICAgICAgICAgICBpZ25vcmVUb29sdGlwOiB0cnVlLFxuICAgICAgICAgICAgY29udHJvbFR5cGU6ICd0ZXh0JyxcbiAgICAgICAgICAgIGNvbnRyb2xzOiBbMCwxXSxcbiAgICAgICAgICAgIGZuOiBmdW5jdGlvbiAodiwgYSwgcGFyZW50LCBpbmRleCwgYWJpbGl0eU1vZGVsLCBhYmlsaXR5KSB7XG4gICAgICAgICAgICAgICAgcmV0dXJuIHZbMF0qdlsxXSphLzEwMDtcbiAgICAgICAgICAgIH1cbiAgICAgICAgfVxuICAgIF0sXG4gICAgJ2p1Z2dlcm5hdXRfb21uaV9zbGFzaCc6IFtcbiAgICAgICAge1xuICAgICAgICAgICAgbGFiZWw6ICdKdW1wcycsXG4gICAgICAgICAgICBjb250cm9sVHlwZTogJ2lucHV0J1xuICAgICAgICB9LFxuICAgICAgICB7XG4gICAgICAgICAgICBsYWJlbDogJ01JTiBEQU1BR0U6JyxcbiAgICAgICAgICAgIGlnbm9yZVRvb2x0aXA6IHRydWUsXG4gICAgICAgICAgICBjb250cm9sVHlwZTogJ3RleHQnLFxuICAgICAgICAgICAgZm46IGZ1bmN0aW9uICh2LCBhLCBwYXJlbnQsIGluZGV4LCBhYmlsaXR5TW9kZWwsIGFiaWxpdHkpIHtcbiAgICAgICAgICAgICAgICByZXR1cm4gYWJpbGl0eU1vZGVsLmdldEFiaWxpdHlBdHRyaWJ1dGVWYWx1ZShhYmlsaXR5LmF0dHJpYnV0ZXMsICdvbW5pX3NsYXNoX2RhbWFnZScsMSkqdjtcbiAgICAgICAgICAgIH1cbiAgICAgICAgfSxcbiAgICAgICAge1xuICAgICAgICAgICAgbGFiZWw6ICdNQVggREFNQUdFOicsXG4gICAgICAgICAgICBpZ25vcmVUb29sdGlwOiB0cnVlLFxuICAgICAgICAgICAgY29udHJvbFR5cGU6ICd0ZXh0JyxcbiAgICAgICAgICAgIGZuOiBmdW5jdGlvbiAodiwgYSwgcGFyZW50LCBpbmRleCwgYWJpbGl0eU1vZGVsLCBhYmlsaXR5KSB7XG4gICAgICAgICAgICAgICAgcmV0dXJuIGFiaWxpdHlNb2RlbC5nZXRBYmlsaXR5QXR0cmlidXRlVmFsdWUoYWJpbGl0eS5hdHRyaWJ1dGVzLCAnb21uaV9zbGFzaF9kYW1hZ2UnLDIpKnY7XG4gICAgICAgICAgICB9XG4gICAgICAgIH1cbiAgICBdLFxuICAgICdrZWVwZXJfb2ZfdGhlX2xpZ2h0X2lsbHVtaW5hdGUnOiBbXG4gICAgICAgIHtcbiAgICAgICAgICAgIGxhYmVsOiAnRHVyYXRpb24nLFxuICAgICAgICAgICAgY29udHJvbFR5cGU6ICdpbnB1dCdcbiAgICAgICAgfSxcbiAgICAgICAge1xuICAgICAgICAgICAgYXR0cmlidXRlTmFtZTogJ2RhbWFnZV9wZXJfc2Vjb25kJyxcbiAgICAgICAgICAgIGxhYmVsOiAnREFNQUdFOicsXG4gICAgICAgICAgICBpZ25vcmVUb29sdGlwOiB0cnVlLFxuICAgICAgICAgICAgY29udHJvbFR5cGU6ICd0ZXh0JyxcbiAgICAgICAgICAgIGZuOiBmdW5jdGlvbiAodiwgYSwgcGFyZW50LCBpbmRleCwgYWJpbGl0eU1vZGVsLCBhYmlsaXR5KSB7XG4gICAgICAgICAgICAgICAgcmV0dXJuIHYqYTtcbiAgICAgICAgICAgIH1cbiAgICAgICAgfVxuICAgIF0sXG4gICAgJ2tlZXBlcl9vZl90aGVfbGlnaHRfbWFuYV9sZWFrJzogW1xuICAgICAgICB7XG4gICAgICAgICAgICBsYWJlbDogJ0Rpc3RhbmNlIE1vdmVkJyxcbiAgICAgICAgICAgIGNvbnRyb2xUeXBlOiAnaW5wdXQnXG4gICAgICAgIH0sXG4gICAgICAgIHtcbiAgICAgICAgICAgIGxhYmVsOiAnRW5lbXkgTWF4IE1hbmEnLFxuICAgICAgICAgICAgY29udHJvbFR5cGU6ICdpbnB1dCdcbiAgICAgICAgfSxcbiAgICAgICAge1xuICAgICAgICAgICAgYXR0cmlidXRlTmFtZTogJ21hbmFfbGVha19wY3QnLFxuICAgICAgICAgICAgbGFiZWw6ICdNQU5BIExFQUtFRDonLFxuICAgICAgICAgICAgaWdub3JlVG9vbHRpcDogdHJ1ZSxcbiAgICAgICAgICAgIGNvbnRyb2xUeXBlOiAndGV4dCcsXG4gICAgICAgICAgICBjb250cm9sczogWzAsMV0sXG4gICAgICAgICAgICBmbjogZnVuY3Rpb24gKHYsIGEsIHBhcmVudCwgaW5kZXgsIGFiaWxpdHlNb2RlbCwgYWJpbGl0eSkge1xuICAgICAgICAgICAgICAgIHJldHVybiB2WzBdLzEwMCp2WzFdKmEvMTAwO1xuICAgICAgICAgICAgfVxuICAgICAgICB9XG4gICAgXSxcbiAgICAnbGVnaW9uX2NvbW1hbmRlcl9kdWVsJzogW1xuICAgICAgICB7XG4gICAgICAgICAgICBsYWJlbDogJ0R1ZWwgV2lucycsXG4gICAgICAgICAgICBjb250cm9sVHlwZTogJ2lucHV0J1xuICAgICAgICB9LFxuICAgICAgICB7XG4gICAgICAgICAgICBhdHRyaWJ1dGVOYW1lOiAncmV3YXJkX2RhbWFnZScsXG4gICAgICAgICAgICBsYWJlbDogJ1RvdGFsIERhbWFnZTonLFxuICAgICAgICAgICAgaWdub3JlVG9vbHRpcDogdHJ1ZSxcbiAgICAgICAgICAgIGNvbnRyb2xUeXBlOiAndGV4dCcsXG4gICAgICAgICAgICBmbjogZnVuY3Rpb24gKHYsIGEsIHBhcmVudCwgaW5kZXgsIGFiaWxpdHlNb2RlbCwgYWJpbGl0eSkge1xuICAgICAgICAgICAgICAgIHJldHVybiB2KmE7XG4gICAgICAgICAgICB9LFxuICAgICAgICAgICAgcmV0dXJuUHJvcGVydHk6ICdib251c0RhbWFnZSdcbiAgICAgICAgfVxuICAgIF0sXG4gICAgJ2xlc2hyYWNfcHVsc2Vfbm92YSc6IFtcbiAgICAgICAge1xuICAgICAgICAgICAgbGFiZWw6ICdEdXJhdGlvbicsXG4gICAgICAgICAgICBjb250cm9sVHlwZTogJ2lucHV0J1xuICAgICAgICB9LFxuICAgICAgICB7XG4gICAgICAgICAgICBhdHRyaWJ1dGVOYW1lOiAnZGFtYWdlJyxcbiAgICAgICAgICAgIGxhYmVsOiAnVG90YWwgRGFtYWdlJyxcbiAgICAgICAgICAgIGNvbnRyb2xUeXBlOiAndGV4dCcsXG4gICAgICAgICAgICBmbjogZnVuY3Rpb24gKHYsIGEsIHBhcmVudCwgaW5kZXgsIGFiaWxpdHlNb2RlbCwgYWJpbGl0eSkge1xuICAgICAgICAgICAgICAgIHJldHVybiB2KmE7XG4gICAgICAgICAgICB9XG4gICAgICAgIH0sXG4gICAgICAgIHtcbiAgICAgICAgICAgIGF0dHJpYnV0ZU5hbWU6ICdtYW5hX2Nvc3RfcGVyX3NlY29uZCcsXG4gICAgICAgICAgICBsYWJlbDogJ01BTkEgQ09TVDonLFxuICAgICAgICAgICAgaWdub3JlVG9vbHRpcDogdHJ1ZSxcbiAgICAgICAgICAgIGNvbnRyb2xUeXBlOiAndGV4dCcsXG4gICAgICAgICAgICBmbjogZnVuY3Rpb24gKHYsIGEsIHBhcmVudCwgaW5kZXgsIGFiaWxpdHlNb2RlbCwgYWJpbGl0eSkge1xuICAgICAgICAgICAgICAgIHJldHVybiB2KmE7XG4gICAgICAgICAgICB9XG4gICAgICAgIH1cbiAgICBdLFxuICAgICdsaWNoX2NoYWluX2Zyb3N0JzogW1xuICAgICAgICB7XG4gICAgICAgICAgICBsYWJlbDogJ0JvdW5jZSBIaXRzJyxcbiAgICAgICAgICAgIGNvbnRyb2xUeXBlOiAnaW5wdXQnXG4gICAgICAgIH0sXG4gICAgICAgIHtcbiAgICAgICAgICAgIGF0dHJpYnV0ZU5hbWU6ICdkYW1hZ2UnLFxuICAgICAgICAgICAgbGFiZWw6ICdUb3RhbCBEYW1hZ2UnLFxuICAgICAgICAgICAgY29udHJvbFR5cGU6ICd0ZXh0JyxcbiAgICAgICAgICAgIGZuOiBmdW5jdGlvbiAodiwgYSwgcGFyZW50LCBpbmRleCwgYWJpbGl0eU1vZGVsLCBhYmlsaXR5KSB7XG4gICAgICAgICAgICAgICAgcmV0dXJuIHYqYTtcbiAgICAgICAgICAgIH1cbiAgICAgICAgfSxcbiAgICAgICAge1xuICAgICAgICAgICAgYXR0cmlidXRlTmFtZTogJ3Nsb3dfbW92ZW1lbnRfc3BlZWQnLFxuICAgICAgICAgICAgbGFiZWw6ICdFbmVteSBNb3ZlbWVudCBTcGVlZCBTbG93JyxcbiAgICAgICAgICAgIGNvbnRyb2xUeXBlOiAndGV4dCcsXG4gICAgICAgICAgICBmbjogZnVuY3Rpb24gKHYsIGEsIHBhcmVudCwgaW5kZXgsIGFiaWxpdHlNb2RlbCwgYWJpbGl0eSkge1xuICAgICAgICAgICAgICAgIHJldHVybiBhO1xuICAgICAgICAgICAgfSxcbiAgICAgICAgICAgIHJldHVyblByb3BlcnR5OiAnbW92ZW1lbnRTcGVlZFBjdFJlZHVjdGlvbidcbiAgICAgICAgfSxcbiAgICAgICAge1xuICAgICAgICAgICAgYXR0cmlidXRlTmFtZTogJ3Nsb3dfYXR0YWNrX3NwZWVkJyxcbiAgICAgICAgICAgIGxhYmVsOiAnVG90YWwgRGFtYWdlJyxcbiAgICAgICAgICAgIGNvbnRyb2xUeXBlOiAndGV4dCcsXG4gICAgICAgICAgICBmbjogZnVuY3Rpb24gKHYsIGEsIHBhcmVudCwgaW5kZXgsIGFiaWxpdHlNb2RlbCwgYWJpbGl0eSkge1xuICAgICAgICAgICAgICAgIHJldHVybiBhO1xuICAgICAgICAgICAgfSxcbiAgICAgICAgICAgIHJldHVyblByb3BlcnR5OiAnYXR0YWNrc3BlZWRyZWR1Y3Rpb24nXG4gICAgICAgIH1cbiAgICBdLFxuICAgICdsaWZlX3N0ZWFsZXJfZmVhc3QnOiBbXG4gICAgICAgIHtcbiAgICAgICAgICAgIGxhYmVsOiAnRW5lbXkgQ3VycmVudCBIUCcsXG4gICAgICAgICAgICBjb250cm9sVHlwZTogJ2lucHV0J1xuICAgICAgICB9LFxuICAgICAgICB7XG4gICAgICAgICAgICBhdHRyaWJ1dGVOYW1lOiAnaHBfbGVlY2hfcGVyY2VudCcsXG4gICAgICAgICAgICBsYWJlbDogJ1RvdGFsIERhbWFnZScsXG4gICAgICAgICAgICBjb250cm9sVHlwZTogJ3RleHQnLFxuICAgICAgICAgICAgZm46IGZ1bmN0aW9uICh2LCBhLCBwYXJlbnQsIGluZGV4LCBhYmlsaXR5TW9kZWwsIGFiaWxpdHkpIHtcbiAgICAgICAgICAgICAgICByZXR1cm4gdiphLzEwMDtcbiAgICAgICAgICAgIH0sXG4gICAgICAgICAgICByZXR1cm5Qcm9wZXJ0eTogJ2JvbnVzRGFtYWdlJ1xuICAgICAgICB9XG4gICAgXSxcbiAgICAnbGlmZV9zdGVhbGVyX29wZW5fd291bmRzJzogW1xuICAgICAgICB7XG4gICAgICAgICAgICBsYWJlbDogJ0R1cmF0aW9uJyxcbiAgICAgICAgICAgIGNvbnRyb2xUeXBlOiAnaW5wdXQnXG4gICAgICAgIH0sXG4gICAgICAgIHtcbiAgICAgICAgICAgIGF0dHJpYnV0ZU5hbWU6ICdoZWFsX3BlcmNlbnQnLFxuICAgICAgICAgICAgbGFiZWw6ICdUb3RhbCBEYW1hZ2UnLFxuICAgICAgICAgICAgY29udHJvbFR5cGU6ICd0ZXh0JyxcbiAgICAgICAgICAgIGZuOiBmdW5jdGlvbiAodiwgYSwgcGFyZW50LCBpbmRleCwgYWJpbGl0eU1vZGVsLCBhYmlsaXR5KSB7XG4gICAgICAgICAgICAgICAgcmV0dXJuIGE7XG4gICAgICAgICAgICB9LFxuICAgICAgICAgICAgcmV0dXJuUHJvcGVydHk6ICdsaWZlc3RlYWwnXG4gICAgICAgIH0sXG4gICAgICAgIHtcbiAgICAgICAgICAgIGF0dHJpYnV0ZU5hbWU6ICdzbG93X3N0ZXBzJyxcbiAgICAgICAgICAgIGxhYmVsOiAnJVNMT1c6JyxcbiAgICAgICAgICAgIGlnbm9yZVRvb2x0aXA6IHRydWUsXG4gICAgICAgICAgICBjb250cm9sVHlwZTogJ3RleHQnLFxuICAgICAgICAgICAgbm9MZXZlbDogdHJ1ZSxcbiAgICAgICAgICAgIGZuOiBmdW5jdGlvbiAodiwgYSwgcGFyZW50LCBpbmRleCwgYWJpbGl0eU1vZGVsLCBhYmlsaXR5KSB7XG4gICAgICAgICAgICAgICAgcmV0dXJuIGFiaWxpdHlNb2RlbC5nZXRBYmlsaXR5QXR0cmlidXRlVmFsdWUoYWJpbGl0eS5hdHRyaWJ1dGVzLCAnc2xvd19zdGVwcycsdisxKTtcbiAgICAgICAgICAgIH0sXG4gICAgICAgICAgICByZXR1cm5Qcm9wZXJ0eTogJ21vdmVtZW50U3BlZWRQY3RSZWR1Y3Rpb24nXG4gICAgICAgIH1cbiAgICBdLFxuICAgICdsaW5hX2ZpZXJ5X3NvdWwnOiBbXG4gICAgICAgIHtcbiAgICAgICAgICAgIGxhYmVsOiAnRHVyYXRpb24nLFxuICAgICAgICAgICAgY29udHJvbFR5cGU6ICdpbnB1dCdcbiAgICAgICAgfSxcbiAgICAgICAge1xuICAgICAgICAgICAgYXR0cmlidXRlTmFtZTogJ2ZpZXJ5X3NvdWxfbW92ZV9zcGVlZF9ib251cycsXG4gICAgICAgICAgICBsYWJlbDogJ0VuZW15IE1vdmVtZW50IFNwZWVkIFNsb3cnLFxuICAgICAgICAgICAgY29udHJvbFR5cGU6ICd0ZXh0JyxcbiAgICAgICAgICAgIGZuOiBmdW5jdGlvbiAodiwgYSwgcGFyZW50LCBpbmRleCwgYWJpbGl0eU1vZGVsLCBhYmlsaXR5KSB7XG4gICAgICAgICAgICAgICAgcmV0dXJuIHYqYTtcbiAgICAgICAgICAgIH0sXG4gICAgICAgICAgICByZXR1cm5Qcm9wZXJ0eTogJ21vdmVtZW50U3BlZWRQY3QnXG4gICAgICAgIH0sXG4gICAgICAgIHtcbiAgICAgICAgICAgIGF0dHJpYnV0ZU5hbWU6ICdmaWVyeV9zb3VsX2F0dGFja19zcGVlZF9ib251cycsXG4gICAgICAgICAgICBsYWJlbDogJ1RvdGFsIERhbWFnZScsXG4gICAgICAgICAgICBjb250cm9sVHlwZTogJ3RleHQnLFxuICAgICAgICAgICAgZm46IGZ1bmN0aW9uICh2LCBhLCBwYXJlbnQsIGluZGV4LCBhYmlsaXR5TW9kZWwsIGFiaWxpdHkpIHtcbiAgICAgICAgICAgICAgICByZXR1cm4gdiphO1xuICAgICAgICAgICAgfSxcbiAgICAgICAgICAgIHJldHVyblByb3BlcnR5OiAnYXR0YWNrc3BlZWQnXG4gICAgICAgIH1cbiAgICBdLFxuICAgICdsaW9uX21hbmFfZHJhaW4nOiBbXG4gICAgICAgIHtcbiAgICAgICAgICAgIGxhYmVsOiAnRHVyYXRpb24nLFxuICAgICAgICAgICAgY29udHJvbFR5cGU6ICdpbnB1dCdcbiAgICAgICAgfSxcbiAgICAgICAge1xuICAgICAgICAgICAgYXR0cmlidXRlTmFtZTogJ21hbmFfcGVyX3NlY29uZCcsXG4gICAgICAgICAgICBsYWJlbDogJ01BTkEgRFJBSU5FRDonLFxuICAgICAgICAgICAgaWdub3JlVG9vbHRpcDogdHJ1ZSxcbiAgICAgICAgICAgIGNvbnRyb2xUeXBlOiAndGV4dCcsXG4gICAgICAgICAgICBmbjogZnVuY3Rpb24gKHYsIGEsIHBhcmVudCwgaW5kZXgsIGFiaWxpdHlNb2RlbCwgYWJpbGl0eSkge1xuICAgICAgICAgICAgICAgIHJldHVybiB2KmE7XG4gICAgICAgICAgICB9XG4gICAgICAgIH1cbiAgICBdLFxuICAgICdsdW5hX21vb25fZ2xhaXZlJzogW1xuICAgICAgICB7XG4gICAgICAgICAgICBsYWJlbDogJ0RhbWFnZScsXG4gICAgICAgICAgICBjb250cm9sVHlwZTogJ2lucHV0J1xuICAgICAgICB9LFxuICAgICAgICB7XG4gICAgICAgICAgICBhdHRyaWJ1dGVOYW1lOiAnZGFtYWdlX3JlZHVjdGlvbl9wZXJjZW50JyxcbiAgICAgICAgICAgIGxhYmVsOiAnQk9VTkNFIERBTUFHRTonLFxuICAgICAgICAgICAgaWdub3JlVG9vbHRpcDogdHJ1ZSxcbiAgICAgICAgICAgIGNvbnRyb2xUeXBlOiAndGV4dCcsXG4gICAgICAgICAgICBmbjogZnVuY3Rpb24gKHYsIGEsIHBhcmVudCwgaW5kZXgsIGFiaWxpdHlNb2RlbCwgYWJpbGl0eSkge1xuICAgICAgICAgICAgICAgIHZhciByZXN1bHQgPSBbXTtcbiAgICAgICAgICAgICAgICBmb3IgKHZhciBpID0gMTsgaSA8IDY7IGkrKykge1xuICAgICAgICAgICAgICAgICAgICByZXN1bHQucHVzaCgodipNYXRoLnBvdyhhLzEwMCxpKSkudG9GaXhlZCgyKSlcbiAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgICAgcmV0dXJuIHJlc3VsdC5qb2luKCc8YnI+Jyk7XG4gICAgICAgICAgICB9XG4gICAgICAgIH1cbiAgICBdLFxuICAgICdsdW5hX2VjbGlwc2UnOiBbXG4gICAgICAgIHtcbiAgICAgICAgICAgIGxhYmVsOiAnQmVhbSBDb3VudCcsXG4gICAgICAgICAgICBjb250cm9sVHlwZTogJ2lucHV0J1xuICAgICAgICB9LFxuICAgICAgICB7XG4gICAgICAgICAgICBhdHRyaWJ1dGVOYW1lOiAnYmVhbXMnLFxuICAgICAgICAgICAgbGFiZWw6ICdUb3RhbCBEYW1hZ2UnLFxuICAgICAgICAgICAgY29udHJvbFR5cGU6ICd0ZXh0JyxcbiAgICAgICAgICAgIGZuOiBmdW5jdGlvbiAodiwgYSwgcGFyZW50LCBpbmRleCwgYWJpbGl0eU1vZGVsLCBhYmlsaXR5KSB7XG4gICAgICAgICAgICAgICAgdmFyIGx1Y2VudEJlYW1BYmlsaXR5ID0gYWJpbGl0eU1vZGVsLmFiaWxpdGllcygpLmZpbmQoZnVuY3Rpb24oYikge1xuICAgICAgICAgICAgICAgICAgICByZXR1cm4gYi5uYW1lID09ICdsdW5hX2x1Y2VudF9iZWFtJztcbiAgICAgICAgICAgICAgICB9KTtcbiAgICAgICAgICAgICAgICBpZiAobHVjZW50QmVhbUFiaWxpdHkubGV2ZWwoKSA9PSAwKSByZXR1cm4gMDtcbiAgICAgICAgICAgICAgICB2YXIgZGFtYWdlID0gYWJpbGl0eU1vZGVsLmdldEFiaWxpdHlQcm9wZXJ0eVZhbHVlKGx1Y2VudEJlYW1BYmlsaXR5LCAnZGFtYWdlJyk7XG4gICAgICAgICAgICAgICAgcmV0dXJuIHYqZGFtYWdlO1xuICAgICAgICAgICAgfVxuICAgICAgICB9XG4gICAgXSxcbiAgICAnbWVkdXNhX215c3RpY19zbmFrZSc6IFtcbiAgICAgICAge1xuICAgICAgICAgICAgbGFiZWw6ICdKdW1wIENvdW50JyxcbiAgICAgICAgICAgIGNvbnRyb2xUeXBlOiAnaW5wdXQnXG4gICAgICAgIH0sXG4gICAgICAgIHtcbiAgICAgICAgICAgIGF0dHJpYnV0ZU5hbWU6ICdzbmFrZV9kYW1hZ2UnLFxuICAgICAgICAgICAgbGFiZWw6ICdEYW1hZ2UgUGVyIEp1bXA6JyxcbiAgICAgICAgICAgIGlnbm9yZVRvb2x0aXA6IHRydWUsXG4gICAgICAgICAgICBjb250cm9sVHlwZTogJ21ldGhvZCcsXG4gICAgICAgICAgICBkaXNwbGF5OiAnbm9uZScsXG4gICAgICAgICAgICBmbjogZnVuY3Rpb24gKHYsIGEsIHBhcmVudCwgaW5kZXgsIGFiaWxpdHlNb2RlbCwgYWJpbGl0eSkge1xuICAgICAgICAgICAgICAgIHZhciBzbmFrZV9qdW1wcyA9IGFiaWxpdHlNb2RlbC5nZXRBYmlsaXR5QXR0cmlidXRlVmFsdWUoYWJpbGl0eS5hdHRyaWJ1dGVzLCAnc25ha2VfanVtcHMnLGFiaWxpdHkubGV2ZWwoKSk7XG4gICAgICAgICAgICAgICAgdmFyIHNuYWtlX3NjYWxlID0gYWJpbGl0eU1vZGVsLmdldEFiaWxpdHlBdHRyaWJ1dGVWYWx1ZShhYmlsaXR5LmF0dHJpYnV0ZXMsICdzbmFrZV9zY2FsZScsMCk7XG4gICAgICAgICAgICAgICAgdmFyIGRhbWFnZSA9IFtdO1xuICAgICAgICAgICAgICAgIGZvciAodmFyIGkgPSAwOyBpIDwgc25ha2VfanVtcHM7IGkrKykge1xuICAgICAgICAgICAgICAgICAgICBkYW1hZ2UucHVzaChhICsgYSAqIGkgKiBzbmFrZV9zY2FsZS8xMDApO1xuICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgICByZXR1cm4gZGFtYWdlO1xuICAgICAgICAgICAgfVxuICAgICAgICB9LFxuICAgICAgICB7XG4gICAgICAgICAgICBhdHRyaWJ1dGVOYW1lOiAnc25ha2VfZGFtYWdlJyxcbiAgICAgICAgICAgIGxhYmVsOiAnRGFtYWdlIFBlciBKdW1wOicsXG4gICAgICAgICAgICBpZ25vcmVUb29sdGlwOiB0cnVlLFxuICAgICAgICAgICAgY29udHJvbFR5cGU6ICd0ZXh0JyxcbiAgICAgICAgICAgIGNvbnRyb2xzOiBbMCwxXSxcbiAgICAgICAgICAgIGZuOiBmdW5jdGlvbiAodiwgYSwgcGFyZW50LCBpbmRleCwgYWJpbGl0eU1vZGVsLCBhYmlsaXR5KSB7XG4gICAgICAgICAgICAgICAgcmV0dXJuIHZbMV0uam9pbignIC8gJyk7XG4gICAgICAgICAgICB9XG4gICAgICAgIH0sXG4gICAgICAgIHtcbiAgICAgICAgICAgIGF0dHJpYnV0ZU5hbWU6ICdzbmFrZV9kYW1hZ2UnLFxuICAgICAgICAgICAgbGFiZWw6ICdUb3RhbCBEYW1hZ2U6JyxcbiAgICAgICAgICAgIGlnbm9yZVRvb2x0aXA6IHRydWUsXG4gICAgICAgICAgICBjb250cm9sVHlwZTogJ3RleHQnLFxuICAgICAgICAgICAgY29udHJvbHM6IFswLDFdLFxuICAgICAgICAgICAgZm46IGZ1bmN0aW9uICh2LCBhLCBwYXJlbnQsIGluZGV4LCBhYmlsaXR5TW9kZWwsIGFiaWxpdHkpIHtcbiAgICAgICAgICAgICAgICByZXR1cm4gdlsxXS5zbGljZSgwLCB2WzBdKS5yZWR1Y2UoZnVuY3Rpb24gKG1lbW8sIG8pIHsgcmV0dXJuIG1lbW8gKyBvIH0sIDApO1xuICAgICAgICAgICAgfVxuICAgICAgICB9LFxuICAgICAgICB7XG4gICAgICAgICAgICBhdHRyaWJ1dGVOYW1lOiAnc25ha2VfZGFtYWdlJyxcbiAgICAgICAgICAgIGxhYmVsOiAnTWF4IERhbWFnZTonLFxuICAgICAgICAgICAgaWdub3JlVG9vbHRpcDogdHJ1ZSxcbiAgICAgICAgICAgIGNvbnRyb2xUeXBlOiAndGV4dCcsXG4gICAgICAgICAgICBjb250cm9sczogWzAsMV0sXG4gICAgICAgICAgICBmbjogZnVuY3Rpb24gKHYsIGEsIHBhcmVudCwgaW5kZXgsIGFiaWxpdHlNb2RlbCwgYWJpbGl0eSkge1xuICAgICAgICAgICAgICAgIHJldHVybiB2WzFdLnJlZHVjZShmdW5jdGlvbiAobWVtbywgbykgeyByZXR1cm4gbWVtbyArIG8gfSwgMCk7XG4gICAgICAgICAgICB9XG4gICAgICAgIH1cbiAgICBdLFxuICAgICdtZWR1c2FfbWFuYV9zaGllbGQnOiBbXG4gICAgICAgIHtcbiAgICAgICAgICAgIGxhYmVsOiAnRGFtYWdlJyxcbiAgICAgICAgICAgIGNvbnRyb2xUeXBlOiAnaW5wdXQnXG4gICAgICAgIH0sXG4gICAgICAgIHtcbiAgICAgICAgICAgIGF0dHJpYnV0ZU5hbWU6ICdkYW1hZ2VfcGVyX21hbmEnLFxuICAgICAgICAgICAgbGFiZWw6ICdNQU5BIFVTRUQ6JyxcbiAgICAgICAgICAgIGlnbm9yZVRvb2x0aXA6IHRydWUsXG4gICAgICAgICAgICBjb250cm9sVHlwZTogJ3RleHQnLFxuICAgICAgICAgICAgZm46IGZ1bmN0aW9uICh2LCBhLCBwYXJlbnQsIGluZGV4LCBhYmlsaXR5TW9kZWwsIGFiaWxpdHkpIHtcbiAgICAgICAgICAgICAgICByZXR1cm4gKHYvYSkudG9GaXhlZCgyKTtcbiAgICAgICAgICAgIH1cbiAgICAgICAgfSxcbiAgICAgICAge1xuICAgICAgICAgICAgYXR0cmlidXRlTmFtZTogJ2Fic29ycHRpb25fdG9vbHRpcCcsXG4gICAgICAgICAgICBsYWJlbDogJyVEQU1BR0UgUkVEVUNUSU9OOicsXG4gICAgICAgICAgICBpZ25vcmVUb29sdGlwOiB0cnVlLFxuICAgICAgICAgICAgY29udHJvbFR5cGU6ICd0ZXh0JyxcbiAgICAgICAgICAgIGZuOiBmdW5jdGlvbiAodiwgYSwgcGFyZW50LCBpbmRleCwgYWJpbGl0eU1vZGVsLCBhYmlsaXR5KSB7XG4gICAgICAgICAgICAgICAgcmV0dXJuIC1hO1xuICAgICAgICAgICAgfSxcbiAgICAgICAgICAgIHJldHVyblByb3BlcnR5OiAnZGFtYWdlUmVkdWN0aW9uJ1xuICAgICAgICB9XG4gICAgXSxcbiAgICAnbWVlcG9fcG9vZic6IFtcbiAgICAgICAge1xuICAgICAgICAgICAgbGFiZWw6ICdNZWVwbyBDb3VudCcsXG4gICAgICAgICAgICBjb250cm9sVHlwZTogJ2lucHV0J1xuICAgICAgICB9LFxuICAgICAgICB7XG4gICAgICAgICAgICBsYWJlbDogJ0RBTUFHRTonLFxuICAgICAgICAgICAgY29udHJvbFR5cGU6ICd0ZXh0JyxcbiAgICAgICAgICAgIGZuOiBmdW5jdGlvbiAodiwgYSwgcGFyZW50LCBpbmRleCwgYWJpbGl0eU1vZGVsLCBhYmlsaXR5KSB7XG4gICAgICAgICAgICAgICAgcmV0dXJuIGFiaWxpdHlNb2RlbC5nZXRBYmlsaXR5UHJvcGVydHlWYWx1ZShhYmlsaXR5LCAnZGFtYWdlJykqdjtcbiAgICAgICAgICAgIH1cbiAgICAgICAgfVxuICAgIF0sXG4gICAgJ21lZXBvX2dlb3N0cmlrZSc6IFtcbiAgICAgICAge1xuICAgICAgICAgICAgbGFiZWw6ICdTdGFja3MnLFxuICAgICAgICAgICAgY29udHJvbFR5cGU6ICdpbnB1dCdcbiAgICAgICAgfSxcbiAgICAgICAge1xuICAgICAgICAgICAgbGFiZWw6ICdEQU1BR0U6JyxcbiAgICAgICAgICAgIGlnbm9yZVRvb2x0aXA6IHRydWUsXG4gICAgICAgICAgICBjb250cm9sVHlwZTogJ3RleHQnLFxuICAgICAgICAgICAgZm46IGZ1bmN0aW9uICh2LCBhLCBwYXJlbnQsIGluZGV4LCBhYmlsaXR5TW9kZWwsIGFiaWxpdHkpIHtcbiAgICAgICAgICAgICAgICByZXR1cm4gYWJpbGl0eU1vZGVsLmdldEFiaWxpdHlQcm9wZXJ0eVZhbHVlKGFiaWxpdHksICdkYW1hZ2UnKSp2O1xuICAgICAgICAgICAgfVxuICAgICAgICB9LFxuICAgICAgICB7XG4gICAgICAgICAgICBhdHRyaWJ1dGVOYW1lOiAnc2xvdycsXG4gICAgICAgICAgICBsYWJlbDogJyVTTE9XOicsXG4gICAgICAgICAgICBpZ25vcmVUb29sdGlwOiB0cnVlLFxuICAgICAgICAgICAgY29udHJvbFR5cGU6ICd0ZXh0JyxcbiAgICAgICAgICAgIG5vTGV2ZWw6IHRydWUsXG4gICAgICAgICAgICBmbjogZnVuY3Rpb24gKHYsIGEsIHBhcmVudCwgaW5kZXgsIGFiaWxpdHlNb2RlbCwgYWJpbGl0eSkge1xuICAgICAgICAgICAgICAgIHJldHVybiBhYmlsaXR5TW9kZWwuZ2V0QWJpbGl0eUF0dHJpYnV0ZVZhbHVlKGFiaWxpdHkuYXR0cmlidXRlcywgJ3Nsb3cnLGFiaWxpdHkubGV2ZWwoKSkqdjtcbiAgICAgICAgICAgIH0sXG4gICAgICAgICAgICByZXR1cm5Qcm9wZXJ0eTogJ21vdmVtZW50U3BlZWRQY3RSZWR1Y3Rpb24nXG4gICAgICAgIH1cbiAgICBdLFxuICAgICdtaXJhbmFfYXJyb3cnOiBbXG4gICAgICAgIHtcbiAgICAgICAgICAgIGxhYmVsOiAnQXJyb3cgVHJhdmVsIERpc3RhbmNlJyxcbiAgICAgICAgICAgIGNvbnRyb2xUeXBlOiAnaW5wdXQnXG4gICAgICAgIH0sXG4gICAgICAgIHtcbiAgICAgICAgICAgIGF0dHJpYnV0ZU5hbWU6ICdhcnJvd19tYXhfc3R1bicsXG4gICAgICAgICAgICBsYWJlbDogJ1NUVU4gRFVSQVRJT046JyxcbiAgICAgICAgICAgIGlnbm9yZVRvb2x0aXA6IHRydWUsXG4gICAgICAgICAgICBjb250cm9sVHlwZTogJ3RleHQnLFxuICAgICAgICAgICAgZm46IGZ1bmN0aW9uICh2LCBhLCBwYXJlbnQsIGluZGV4LCBhYmlsaXR5TW9kZWwsIGFiaWxpdHkpIHtcbiAgICAgICAgICAgICAgICB2YXIgYXJyb3dfbWluX3N0dW4gPSBhYmlsaXR5TW9kZWwuZ2V0QWJpbGl0eUF0dHJpYnV0ZVZhbHVlKGFiaWxpdHkuYXR0cmlidXRlcywgJ2Fycm93X21pbl9zdHVuJywwKTtcbiAgICAgICAgICAgICAgICB2YXIgYXJyb3dfbWF4X3N0dW5yYW5nZSA9IGFiaWxpdHlNb2RlbC5nZXRBYmlsaXR5QXR0cmlidXRlVmFsdWUoYWJpbGl0eS5hdHRyaWJ1dGVzLCAnYXJyb3dfbWF4X3N0dW5yYW5nZScsMCk7XG4gICAgICAgICAgICAgICAgdmFyIHNjYWxlID0gTWF0aC5taW4odiwgYXJyb3dfbWF4X3N0dW5yYW5nZSkgLyBhcnJvd19tYXhfc3R1bnJhbmdlO1xuICAgICAgICAgICAgICAgIHJldHVybiBNYXRoLm1heChhcnJvd19taW5fc3R1biwgTWF0aC5mbG9vcihhICogc2NhbGUgLyAwLjEpICogMC4xKTtcbiAgICAgICAgICAgIH1cbiAgICAgICAgfSxcbiAgICAgICAge1xuICAgICAgICAgICAgYXR0cmlidXRlTmFtZTogJ2Fycm93X2JvbnVzX2RhbWFnZScsXG4gICAgICAgICAgICBsYWJlbDogJ1RPVEFMIERBTUFHRTonLFxuICAgICAgICAgICAgaWdub3JlVG9vbHRpcDogdHJ1ZSxcbiAgICAgICAgICAgIGNvbnRyb2xUeXBlOiAndGV4dCcsXG4gICAgICAgICAgICBmbjogZnVuY3Rpb24gKHYsIGEsIHBhcmVudCwgaW5kZXgsIGFiaWxpdHlNb2RlbCwgYWJpbGl0eSkge1xuICAgICAgICAgICAgICAgIHZhciBhYmlsaXR5ID0gYWJpbGl0eTtcbiAgICAgICAgICAgICAgICB2YXIgZGFtYWdlID0gYWJpbGl0eS5kYW1hZ2UoKVthYmlsaXR5LmxldmVsKCktMV07XG4gICAgICAgICAgICAgICAgdmFyIGFycm93X21heF9zdHVucmFuZ2UgPSBhYmlsaXR5TW9kZWwuZ2V0QWJpbGl0eUF0dHJpYnV0ZVZhbHVlKGFiaWxpdHkuYXR0cmlidXRlcywgJ2Fycm93X21heF9zdHVucmFuZ2UnLDApO1xuICAgICAgICAgICAgICAgIHZhciBzY2FsZSA9IE1hdGgubWluKHYsIGFycm93X21heF9zdHVucmFuZ2UpIC8gYXJyb3dfbWF4X3N0dW5yYW5nZTtcbiAgICAgICAgICAgICAgICB2YXIgYm9udXNfZGFtYWdlID0gTWF0aC5mbG9vcihhICogc2NhbGUgLyAyLjgpICogMi44O1xuICAgICAgICAgICAgICAgIHJldHVybiBkYW1hZ2UgKyAnICsgJyArIGJvbnVzX2RhbWFnZSArICcgPSAnICsgKGRhbWFnZSArIGJvbnVzX2RhbWFnZSk7XG4gICAgICAgICAgICB9XG4gICAgICAgIH1cbiAgICBdLFxuICAgICdtb3JwaGxpbmdfbW9ycGhfYWdpJzogW1xuICAgICAgICB7XG4gICAgICAgICAgICBsYWJlbDogJ1NoaWZ0cycsXG4gICAgICAgICAgICBjb250cm9sVHlwZTogJ2lucHV0J1xuICAgICAgICB9LFxuICAgICAgICB7XG4gICAgICAgICAgICBhdHRyaWJ1dGVOYW1lOiAncG9pbnRzX3Blcl90aWNrJyxcbiAgICAgICAgICAgIGxhYmVsOiAnQUdJIFNISUZUIEdBSU46JyxcbiAgICAgICAgICAgIGlnbm9yZVRvb2x0aXA6IHRydWUsXG4gICAgICAgICAgICBjb250cm9sVHlwZTogJ3RleHQnLFxuICAgICAgICAgICAgZm46IGZ1bmN0aW9uICh2LCBhLCBwYXJlbnQsIGluZGV4LCBhYmlsaXR5TW9kZWwsIGFiaWxpdHkpIHtcbiAgICAgICAgICAgICAgICByZXR1cm4gdiphO1xuICAgICAgICAgICAgfSxcbiAgICAgICAgICAgIHJldHVyblByb3BlcnR5OiAnYm9udXNBZ2lsaXR5J1xuICAgICAgICB9LFxuICAgICAgICB7XG4gICAgICAgICAgICBhdHRyaWJ1dGVOYW1lOiAncG9pbnRzX3Blcl90aWNrJyxcbiAgICAgICAgICAgIGxhYmVsOiAnU1RSIFNISUZUIExPU1M6JyxcbiAgICAgICAgICAgIGlnbm9yZVRvb2x0aXA6IHRydWUsXG4gICAgICAgICAgICBjb250cm9sVHlwZTogJ3RleHQnLFxuICAgICAgICAgICAgZm46IGZ1bmN0aW9uICh2LCBhLCBwYXJlbnQsIGluZGV4LCBhYmlsaXR5TW9kZWwsIGFiaWxpdHkpIHtcbiAgICAgICAgICAgICAgICByZXR1cm4gLXYqYTtcbiAgICAgICAgICAgIH0sXG4gICAgICAgICAgICByZXR1cm5Qcm9wZXJ0eTogJ2JvbnVzU3RyZW5ndGgnXG4gICAgICAgIH0sXG4gICAgICAgIHtcbiAgICAgICAgICAgIGF0dHJpYnV0ZU5hbWU6ICdib251c19hdHRyaWJ1dGVzJyxcbiAgICAgICAgICAgIGxhYmVsOiAnU0hJRlQgVElNRTonLFxuICAgICAgICAgICAgY29udHJvbFR5cGU6ICd0ZXh0JyxcbiAgICAgICAgICAgIGZuOiBmdW5jdGlvbiAodiwgYSwgcGFyZW50LCBpbmRleCwgYWJpbGl0eU1vZGVsLCBhYmlsaXR5KSB7XG4gICAgICAgICAgICAgICAgcmV0dXJuIGE7XG4gICAgICAgICAgICB9LFxuICAgICAgICAgICAgcmV0dXJuUHJvcGVydHk6ICdib251c0FnaWxpdHkyJ1xuICAgICAgICB9LFxuICAgICAgICB7XG4gICAgICAgICAgICBhdHRyaWJ1dGVOYW1lOiAnbW9ycGhfY29vbGRvd24nLFxuICAgICAgICAgICAgbGFiZWw6ICdTSElGVCBUSU1FOicsXG4gICAgICAgICAgICBpZ25vcmVUb29sdGlwOiB0cnVlLFxuICAgICAgICAgICAgY29udHJvbFR5cGU6ICd0ZXh0JyxcbiAgICAgICAgICAgIGZuOiBmdW5jdGlvbiAodiwgYSwgcGFyZW50LCBpbmRleCwgYWJpbGl0eU1vZGVsLCBhYmlsaXR5KSB7XG4gICAgICAgICAgICAgICAgcmV0dXJuIHYqYTtcbiAgICAgICAgICAgIH1cbiAgICAgICAgfSxcbiAgICAgICAge1xuICAgICAgICAgICAgYXR0cmlidXRlTmFtZTogJ21hbmFfY29zdCcsXG4gICAgICAgICAgICBsYWJlbDogJ1NISUZUIE1BTkEgQ09TVDonLFxuICAgICAgICAgICAgaWdub3JlVG9vbHRpcDogdHJ1ZSxcbiAgICAgICAgICAgIGNvbnRyb2xUeXBlOiAndGV4dCcsXG4gICAgICAgICAgICBmbjogZnVuY3Rpb24gKHYsIGEsIHBhcmVudCwgaW5kZXgsIGFiaWxpdHlNb2RlbCwgYWJpbGl0eSkge1xuICAgICAgICAgICAgICAgIHJldHVybiB2KmEqYWJpbGl0eU1vZGVsLmdldEFiaWxpdHlBdHRyaWJ1dGVWYWx1ZShhYmlsaXR5LmF0dHJpYnV0ZXMsICdtb3JwaF9jb29sZG93bicsYWJpbGl0eS5sZXZlbCgpKTtcbiAgICAgICAgICAgIH1cbiAgICAgICAgfVxuICAgIF0sXG4gICAgJ21vcnBobGluZ19tb3JwaF9zdHInOiBbXG4gICAgICAgIHtcbiAgICAgICAgICAgIGxhYmVsOiAnU2hpZnRzJyxcbiAgICAgICAgICAgIGNvbnRyb2xUeXBlOiAnaW5wdXQnXG4gICAgICAgIH0sXG4gICAgICAgIHtcbiAgICAgICAgICAgIGF0dHJpYnV0ZU5hbWU6ICdwb2ludHNfcGVyX3RpY2snLFxuICAgICAgICAgICAgbGFiZWw6ICdTVFIgU0hJRlQgR0FJTjonLFxuICAgICAgICAgICAgaWdub3JlVG9vbHRpcDogdHJ1ZSxcbiAgICAgICAgICAgIGNvbnRyb2xUeXBlOiAndGV4dCcsXG4gICAgICAgICAgICBmbjogZnVuY3Rpb24gKHYsIGEsIHBhcmVudCwgaW5kZXgsIGFiaWxpdHlNb2RlbCwgYWJpbGl0eSkge1xuICAgICAgICAgICAgICAgIHJldHVybiB2KmE7XG4gICAgICAgICAgICB9LFxuICAgICAgICAgICAgcmV0dXJuUHJvcGVydHk6ICdib251c1N0cmVuZ3RoJ1xuICAgICAgICB9LFxuICAgICAgICB7XG4gICAgICAgICAgICBhdHRyaWJ1dGVOYW1lOiAncG9pbnRzX3Blcl90aWNrJyxcbiAgICAgICAgICAgIGxhYmVsOiAnQUdJIFNISUZUIExPU1M6JyxcbiAgICAgICAgICAgIGlnbm9yZVRvb2x0aXA6IHRydWUsXG4gICAgICAgICAgICBjb250cm9sVHlwZTogJ3RleHQnLFxuICAgICAgICAgICAgZm46IGZ1bmN0aW9uICh2LCBhLCBwYXJlbnQsIGluZGV4LCBhYmlsaXR5TW9kZWwsIGFiaWxpdHkpIHtcbiAgICAgICAgICAgICAgICByZXR1cm4gLXYqYTtcbiAgICAgICAgICAgIH0sXG4gICAgICAgICAgICByZXR1cm5Qcm9wZXJ0eTogJ2JvbnVzQWdpbGl0eSdcbiAgICAgICAgfSxcbiAgICAgICAge1xuICAgICAgICAgICAgYXR0cmlidXRlTmFtZTogJ2JvbnVzX2F0dHJpYnV0ZXMnLFxuICAgICAgICAgICAgbGFiZWw6ICdTSElGVCBUSU1FOicsXG4gICAgICAgICAgICBjb250cm9sVHlwZTogJ3RleHQnLFxuICAgICAgICAgICAgZm46IGZ1bmN0aW9uICh2LCBhLCBwYXJlbnQsIGluZGV4LCBhYmlsaXR5TW9kZWwsIGFiaWxpdHkpIHtcbiAgICAgICAgICAgICAgICByZXR1cm4gYTtcbiAgICAgICAgICAgIH0sXG4gICAgICAgICAgICByZXR1cm5Qcm9wZXJ0eTogJ2JvbnVzU3RyZW5ndGgyJ1xuICAgICAgICB9LFxuICAgICAgICB7XG4gICAgICAgICAgICBhdHRyaWJ1dGVOYW1lOiAnbW9ycGhfY29vbGRvd24nLFxuICAgICAgICAgICAgbGFiZWw6ICdTSElGVCBUSU1FOicsXG4gICAgICAgICAgICBpZ25vcmVUb29sdGlwOiB0cnVlLFxuICAgICAgICAgICAgY29udHJvbFR5cGU6ICd0ZXh0JyxcbiAgICAgICAgICAgIGZuOiBmdW5jdGlvbiAodiwgYSwgcGFyZW50LCBpbmRleCwgYWJpbGl0eU1vZGVsLCBhYmlsaXR5KSB7XG4gICAgICAgICAgICAgICAgcmV0dXJuIHYqYTtcbiAgICAgICAgICAgIH1cbiAgICAgICAgfSxcbiAgICAgICAge1xuICAgICAgICAgICAgYXR0cmlidXRlTmFtZTogJ21hbmFfY29zdCcsXG4gICAgICAgICAgICBsYWJlbDogJ1NISUZUIE1BTkEgQ09TVDonLFxuICAgICAgICAgICAgaWdub3JlVG9vbHRpcDogdHJ1ZSxcbiAgICAgICAgICAgIGNvbnRyb2xUeXBlOiAndGV4dCcsXG4gICAgICAgICAgICBmbjogZnVuY3Rpb24gKHYsIGEsIHBhcmVudCwgaW5kZXgsIGFiaWxpdHlNb2RlbCwgYWJpbGl0eSkge1xuICAgICAgICAgICAgICAgIHJldHVybiB2KmEqYWJpbGl0eU1vZGVsLmdldEFiaWxpdHlBdHRyaWJ1dGVWYWx1ZShhYmlsaXR5LmF0dHJpYnV0ZXMsICdtb3JwaF9jb29sZG93bicsYWJpbGl0eS5sZXZlbCgpKTtcbiAgICAgICAgICAgIH1cbiAgICAgICAgfVxuICAgIF0sXG4gICAgJ2Z1cmlvbl93cmF0aF9vZl9uYXR1cmUnOiBbXG4gICAgICAgIHtcbiAgICAgICAgICAgIGxhYmVsOiAnRHVyYXRpb24nLFxuICAgICAgICAgICAgY29udHJvbFR5cGU6ICdpbnB1dCdcbiAgICAgICAgfSxcbiAgICAgICAge1xuICAgICAgICAgICAgYXR0cmlidXRlTmFtZTogJ2RhbWFnZScsXG4gICAgICAgICAgICBsYWJlbDogJ1RvdGFsIERhbWFnZScsXG4gICAgICAgICAgICBjb250cm9sVHlwZTogJ3RleHQnLFxuICAgICAgICAgICAgZm46IGZ1bmN0aW9uICh2LCBhLCBwYXJlbnQsIGluZGV4LCBhYmlsaXR5TW9kZWwsIGFiaWxpdHkpIHtcbiAgICAgICAgICAgICAgICByZXR1cm4gdiphO1xuICAgICAgICAgICAgfVxuICAgICAgICB9XG4gICAgXSxcbiAgICAnbmVjcm9seXRlX2hlYXJ0c3RvcHBlcl9hdXJhJzogW1xuICAgICAgICB7XG4gICAgICAgICAgICBsYWJlbDogJ0R1cmF0aW9uJyxcbiAgICAgICAgICAgIGNvbnRyb2xUeXBlOiAnaW5wdXQnXG4gICAgICAgIH0sXG4gICAgICAgIHtcbiAgICAgICAgICAgIGxhYmVsOiAnRW5lbXkgTWF4IEhlYWx0aCcsXG4gICAgICAgICAgICBjb250cm9sVHlwZTogJ2lucHV0J1xuICAgICAgICB9LFxuICAgICAgICB7XG4gICAgICAgICAgICBhdHRyaWJ1dGVOYW1lOiAnYXVyYV9kYW1hZ2UnLFxuICAgICAgICAgICAgbGFiZWw6ICdIRUFMVEggTE9TVDonLFxuICAgICAgICAgICAgaWdub3JlVG9vbHRpcDogdHJ1ZSxcbiAgICAgICAgICAgIGNvbnRyb2xUeXBlOiAndGV4dCcsXG4gICAgICAgICAgICBjb250cm9sczogWzAsMV0sXG4gICAgICAgICAgICBmbjogZnVuY3Rpb24gKHYsIGEsIHBhcmVudCwgaW5kZXgsIGFiaWxpdHlNb2RlbCwgYWJpbGl0eSkge1xuICAgICAgICAgICAgICAgIHJldHVybiB2WzBdKnZbMV0qYS8xMDA7XG4gICAgICAgICAgICB9XG4gICAgICAgIH1cbiAgICBdLFxuICAgICduZWNyb2x5dGVfc2FkaXN0JzogW1xuICAgICAgICB7XG4gICAgICAgICAgICBsYWJlbDogJ1VuaXQgS2lsbHMnLFxuICAgICAgICAgICAgY29udHJvbFR5cGU6ICdpbnB1dCdcbiAgICAgICAgfSxcbiAgICAgICAge1xuICAgICAgICAgICAgbGFiZWw6ICdIZXJvIEtpbGxzJyxcbiAgICAgICAgICAgIGNvbnRyb2xUeXBlOiAnaW5wdXQnXG4gICAgICAgIH0sXG4gICAgICAgIHtcbiAgICAgICAgICAgIGF0dHJpYnV0ZU5hbWU6ICdoZWFsdGhfcmVnZW4nLFxuICAgICAgICAgICAgbGFiZWw6ICdUb3RhbCBEYW1hZ2UnLFxuICAgICAgICAgICAgY29udHJvbFR5cGU6ICd0ZXh0JyxcbiAgICAgICAgICAgIGNvbnRyb2xzOiBbMCwxXSxcbiAgICAgICAgICAgIGZuOiBmdW5jdGlvbiAodiwgYSwgcGFyZW50LCBpbmRleCwgYWJpbGl0eU1vZGVsLCBhYmlsaXR5KSB7XG4gICAgICAgICAgICAgICAgdmFyIGhlcm9fbXVsdGlwbGllciA9IGFiaWxpdHlNb2RlbC5nZXRBYmlsaXR5QXR0cmlidXRlVmFsdWUoYWJpbGl0eS5hdHRyaWJ1dGVzLCAnaGVyb19tdWx0aXBsaWVyJywwKVxuICAgICAgICAgICAgICAgIHJldHVybiAodlswXSt2WzFdKmhlcm9fbXVsdGlwbGllcikqYTtcbiAgICAgICAgICAgIH0sXG4gICAgICAgICAgICByZXR1cm5Qcm9wZXJ0eTogJ2hlYWx0aHJlZ2VuJ1xuICAgICAgICB9LFxuICAgICAgICB7XG4gICAgICAgICAgICBhdHRyaWJ1dGVOYW1lOiAnbWFuYV9yZWdlbicsXG4gICAgICAgICAgICBsYWJlbDogJ1RvdGFsIERhbWFnZScsXG4gICAgICAgICAgICBjb250cm9sVHlwZTogJ3RleHQnLFxuICAgICAgICAgICAgY29udHJvbHM6IFswLDFdLFxuICAgICAgICAgICAgZm46IGZ1bmN0aW9uICh2LCBhLCBwYXJlbnQsIGluZGV4LCBhYmlsaXR5TW9kZWwsIGFiaWxpdHkpIHtcbiAgICAgICAgICAgICAgICB2YXIgaGVyb19tdWx0aXBsaWVyID0gYWJpbGl0eU1vZGVsLmdldEFiaWxpdHlBdHRyaWJ1dGVWYWx1ZShhYmlsaXR5LmF0dHJpYnV0ZXMsICdoZXJvX211bHRpcGxpZXInLDApXG4gICAgICAgICAgICAgICAgcmV0dXJuICh2WzBdK3ZbMV0qaGVyb19tdWx0aXBsaWVyKSphO1xuICAgICAgICAgICAgfSxcbiAgICAgICAgICAgIHJldHVyblByb3BlcnR5OiAnbWFuYXJlZ2VuJ1xuICAgICAgICB9XG4gICAgXSxcbiAgICAnbmlnaHRfc3RhbGtlcl9jcmlwcGxpbmdfZmVhcic6IFtcbiAgICAgICAge1xuICAgICAgICAgICAgbGFiZWw6ICdJcyBOaWdodCcsXG4gICAgICAgICAgICBjb250cm9sVHlwZTogJ2NoZWNrYm94J1xuICAgICAgICB9LFxuICAgICAgICB7XG4gICAgICAgICAgICBhdHRyaWJ1dGVOYW1lOiAnbWlzc19yYXRlX25pZ2h0JyxcbiAgICAgICAgICAgIGxhYmVsOiAnJUNIQU5DRSBUTyBNSVNTOicsXG4gICAgICAgICAgICBpZ25vcmVUb29sdGlwOiB0cnVlLFxuICAgICAgICAgICAgY29udHJvbFR5cGU6ICd0ZXh0JyxcbiAgICAgICAgICAgIGZuOiBmdW5jdGlvbiAodiwgYSwgcGFyZW50LCBpbmRleCwgYWJpbGl0eU1vZGVsLCBhYmlsaXR5KSB7XG4gICAgICAgICAgICAgICAgaWYgKHYpIHtcbiAgICAgICAgICAgICAgICAgICAgcmV0dXJuIGFiaWxpdHlNb2RlbC5nZXRBYmlsaXR5QXR0cmlidXRlVmFsdWUoYWJpbGl0eS5hdHRyaWJ1dGVzLCAnbWlzc19yYXRlX25pZ2h0JyxhYmlsaXR5LmxldmVsKCkpO1xuICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgICBlbHNlIHtcbiAgICAgICAgICAgICAgICAgICAgcmV0dXJuIGFiaWxpdHlNb2RlbC5nZXRBYmlsaXR5QXR0cmlidXRlVmFsdWUoYWJpbGl0eS5hdHRyaWJ1dGVzLCAnbWlzc19yYXRlX2RheScsYWJpbGl0eS5sZXZlbCgpKTtcbiAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICB9LFxuICAgICAgICAgICAgcmV0dXJuUHJvcGVydHk6ICdtaXNzQ2hhbmNlJ1xuICAgICAgICB9XG4gICAgXSwgICAgXG4gICAgJ25pZ2h0X3N0YWxrZXJfaHVudGVyX2luX3RoZV9uaWdodCc6IFtcbiAgICAgICAge1xuICAgICAgICAgICAgbGFiZWw6ICdJcyBOaWdodCcsXG4gICAgICAgICAgICBjb250cm9sVHlwZTogJ2NoZWNrYm94J1xuICAgICAgICB9LFxuICAgICAgICB7XG4gICAgICAgICAgICBhdHRyaWJ1dGVOYW1lOiAnYm9udXNfYXR0YWNrX3NwZWVkX25pZ2h0JyxcbiAgICAgICAgICAgIGxhYmVsOiAnVG90YWwgRGFtYWdlJyxcbiAgICAgICAgICAgIGNvbnRyb2xUeXBlOiAndGV4dCcsXG4gICAgICAgICAgICBmbjogZnVuY3Rpb24gKHYsIGEsIHBhcmVudCwgaW5kZXgsIGFiaWxpdHlNb2RlbCwgYWJpbGl0eSkge1xuICAgICAgICAgICAgICAgIGlmICh2KSB7XG4gICAgICAgICAgICAgICAgICAgIHJldHVybiBhO1xuICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgICBlbHNlIHtcbiAgICAgICAgICAgICAgICAgICAgcmV0dXJuIDA7XG4gICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgfSxcbiAgICAgICAgICAgIHJldHVyblByb3BlcnR5OiAnYXR0YWNrc3BlZWQnXG4gICAgICAgIH0sXG4gICAgICAgIHtcbiAgICAgICAgICAgIGF0dHJpYnV0ZU5hbWU6ICdib251c19tb3ZlbWVudF9zcGVlZF9wY3RfbmlnaHQnLFxuICAgICAgICAgICAgbGFiZWw6ICdUb3RhbCBEYW1hZ2UnLFxuICAgICAgICAgICAgY29udHJvbFR5cGU6ICd0ZXh0JyxcbiAgICAgICAgICAgIGZuOiBmdW5jdGlvbiAodiwgYSwgcGFyZW50LCBpbmRleCwgYWJpbGl0eU1vZGVsLCBhYmlsaXR5KSB7XG4gICAgICAgICAgICAgICAgaWYgKHYpIHtcbiAgICAgICAgICAgICAgICAgICAgcmV0dXJuIGE7XG4gICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICAgIGVsc2Uge1xuICAgICAgICAgICAgICAgICAgICByZXR1cm4gMDtcbiAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICB9LFxuICAgICAgICAgICAgcmV0dXJuUHJvcGVydHk6ICdtb3ZlbWVudFNwZWVkUGN0J1xuICAgICAgICB9XG4gICAgXSwgICAgXG4gICAgJ29ic2lkaWFuX2Rlc3Ryb3llcl9hcmNhbmVfb3JiJzogW1xuICAgICAgICB7XG4gICAgICAgICAgICBsYWJlbDogJ0N1cnJlbnQgTWFuYScsXG4gICAgICAgICAgICBjb250cm9sVHlwZTogJ2lucHV0J1xuICAgICAgICB9LFxuICAgICAgICB7XG4gICAgICAgICAgICBhdHRyaWJ1dGVOYW1lOiAnbWFuYV9wb29sX2RhbWFnZV9wY3QnLFxuICAgICAgICAgICAgbGFiZWw6ICdUb3RhbCBEYW1hZ2UnLFxuICAgICAgICAgICAgY29udHJvbFR5cGU6ICd0ZXh0JyxcbiAgICAgICAgICAgIGZuOiBmdW5jdGlvbiAodiwgYSwgcGFyZW50LCBpbmRleCwgYWJpbGl0eU1vZGVsLCBhYmlsaXR5KSB7XG4gICAgICAgICAgICAgICAgcmV0dXJuIHYqYS8xMDA7XG4gICAgICAgICAgICB9LFxuICAgICAgICAgICAgcmV0dXJuUHJvcGVydHk6ICdib251c0RhbWFnZU9yYidcbiAgICAgICAgfVxuICAgIF0sXG4gICAgJ29ncmVfbWFnaV9pZ25pdGUnOiBbXG4gICAgICAgIHtcbiAgICAgICAgICAgIGxhYmVsOiAnRHVyYXRpb24nLFxuICAgICAgICAgICAgY29udHJvbFR5cGU6ICdpbnB1dCdcbiAgICAgICAgfSxcbiAgICAgICAge1xuICAgICAgICAgICAgYXR0cmlidXRlTmFtZTogJ2J1cm5fZGFtYWdlJyxcbiAgICAgICAgICAgIGxhYmVsOiAnVG90YWwgRGFtYWdlJyxcbiAgICAgICAgICAgIGNvbnRyb2xUeXBlOiAndGV4dCcsXG4gICAgICAgICAgICBmbjogZnVuY3Rpb24gKHYsIGEsIHBhcmVudCwgaW5kZXgsIGFiaWxpdHlNb2RlbCwgYWJpbGl0eSkge1xuICAgICAgICAgICAgICAgIHJldHVybiB2KmE7XG4gICAgICAgICAgICB9XG4gICAgICAgIH0sXG4gICAgICAgIHtcbiAgICAgICAgICAgIGF0dHJpYnV0ZU5hbWU6ICdzbG93X21vdmVtZW50X3NwZWVkX3BjdCcsXG4gICAgICAgICAgICBsYWJlbDogJ1RvdGFsIERhbWFnZScsXG4gICAgICAgICAgICBjb250cm9sVHlwZTogJ3RleHQnLFxuICAgICAgICAgICAgZm46IGZ1bmN0aW9uICh2LCBhLCBwYXJlbnQsIGluZGV4LCBhYmlsaXR5TW9kZWwsIGFiaWxpdHkpIHtcbiAgICAgICAgICAgICAgICByZXR1cm4gYTtcbiAgICAgICAgICAgIH0sXG4gICAgICAgICAgICByZXR1cm5Qcm9wZXJ0eTogJ21vdmVtZW50U3BlZWRQY3RSZWR1Y3Rpb24nXG4gICAgICAgIH1cbiAgICBdLFxuICAgICdwdWRnZV9yb3QnOiBbXG4gICAgICAgIHtcbiAgICAgICAgICAgIGxhYmVsOiAnRHVyYXRpb24nLFxuICAgICAgICAgICAgY29udHJvbFR5cGU6ICdpbnB1dCdcbiAgICAgICAgfSxcbiAgICAgICAge1xuICAgICAgICAgICAgbGFiZWw6ICdEQU1BR0U6JyxcbiAgICAgICAgICAgIGNvbnRyb2xUeXBlOiAndGV4dCcsXG4gICAgICAgICAgICBmbjogZnVuY3Rpb24gKHYsIGEsIHBhcmVudCwgaW5kZXgsIGFiaWxpdHlNb2RlbCwgYWJpbGl0eSkge1xuICAgICAgICAgICAgICAgIHJldHVybiBhYmlsaXR5TW9kZWwuZ2V0QWJpbGl0eVByb3BlcnR5VmFsdWUoYWJpbGl0eSwgJ2RhbWFnZScpKnY7XG4gICAgICAgICAgICB9XG4gICAgICAgIH0sXG4gICAgICAgIHtcbiAgICAgICAgICAgIGF0dHJpYnV0ZU5hbWU6ICdyb3Rfc2xvdycsXG4gICAgICAgICAgICBsYWJlbDogJ1RvdGFsIERhbWFnZScsXG4gICAgICAgICAgICBjb250cm9sVHlwZTogJ3RleHQnLFxuICAgICAgICAgICAgZm46IGZ1bmN0aW9uICh2LCBhLCBwYXJlbnQsIGluZGV4LCBhYmlsaXR5TW9kZWwsIGFiaWxpdHkpIHtcbiAgICAgICAgICAgICAgICByZXR1cm4gYTtcbiAgICAgICAgICAgIH0sXG4gICAgICAgICAgICByZXR1cm5Qcm9wZXJ0eTogJ21vdmVtZW50U3BlZWRQY3RSZWR1Y3Rpb24nXG4gICAgICAgIH1cbiAgICBdLFxuICAgICdwdWRnZV9mbGVzaF9oZWFwJzogW1xuICAgICAgICB7XG4gICAgICAgICAgICBsYWJlbDogJ1N0YWNrcycsXG4gICAgICAgICAgICBjb250cm9sVHlwZTogJ2lucHV0J1xuICAgICAgICB9LFxuICAgICAgICB7XG4gICAgICAgICAgICBhdHRyaWJ1dGVOYW1lOiAnZmxlc2hfaGVhcF9zdHJlbmd0aF9idWZmX2Ftb3VudCcsXG4gICAgICAgICAgICBsYWJlbDogJ1RvdGFsIERhbWFnZScsXG4gICAgICAgICAgICBjb250cm9sVHlwZTogJ3RleHQnLFxuICAgICAgICAgICAgZm46IGZ1bmN0aW9uICh2LCBhLCBwYXJlbnQsIGluZGV4LCBhYmlsaXR5TW9kZWwsIGFiaWxpdHkpIHtcbiAgICAgICAgICAgICAgICByZXR1cm4gdiphO1xuICAgICAgICAgICAgfSxcbiAgICAgICAgICAgIHJldHVyblByb3BlcnR5OiAnYm9udXNTdHJlbmd0aCdcbiAgICAgICAgfSxcbiAgICAgICAge1xuICAgICAgICAgICAgYXR0cmlidXRlTmFtZTogJ2ZsZXNoX2hlYXBfbWFnaWNfcmVzaXN0JyxcbiAgICAgICAgICAgIGxhYmVsOiAnVG90YWwgRGFtYWdlJyxcbiAgICAgICAgICAgIGNvbnRyb2xUeXBlOiAndGV4dCcsXG4gICAgICAgICAgICBmbjogZnVuY3Rpb24gKHYsIGEsIHBhcmVudCwgaW5kZXgsIGFiaWxpdHlNb2RlbCwgYWJpbGl0eSkge1xuICAgICAgICAgICAgICAgIHJldHVybiBhO1xuICAgICAgICAgICAgfSxcbiAgICAgICAgICAgIHJldHVyblByb3BlcnR5OiAnbWFnaWNSZXNpc3QnXG4gICAgICAgIH1cbiAgICBdLFxuICAgICdwdWRnZV9kaXNtZW1iZXInOiBbXG4gICAgICAgIHtcbiAgICAgICAgICAgIGxhYmVsOiAnRHVyYXRpb24nLFxuICAgICAgICAgICAgY29udHJvbFR5cGU6ICdpbnB1dCdcbiAgICAgICAgfSxcbiAgICAgICAge1xuICAgICAgICAgICAgYXR0cmlidXRlTmFtZTogJ2Rpc21lbWJlcl9kYW1hZ2UnLFxuICAgICAgICAgICAgbGFiZWw6ICdUb3RhbCBEYW1hZ2UnLFxuICAgICAgICAgICAgY29udHJvbFR5cGU6ICd0ZXh0JyxcbiAgICAgICAgICAgIGZuOiBmdW5jdGlvbiAodiwgYSwgcGFyZW50LCBpbmRleCwgYWJpbGl0eU1vZGVsLCBhYmlsaXR5KSB7XG4gICAgICAgICAgICAgICAgcmV0dXJuIHYqYTtcbiAgICAgICAgICAgIH1cbiAgICAgICAgfVxuICAgIF0sXG4gICAgJ3B1Z25hX25ldGhlcl93YXJkJzogW1xuICAgICAgICB7XG4gICAgICAgICAgICBsYWJlbDogJ0VuZW15IE1hbmEgU3BlbnQnLFxuICAgICAgICAgICAgY29udHJvbFR5cGU6ICdpbnB1dCdcbiAgICAgICAgfSxcbiAgICAgICAge1xuICAgICAgICAgICAgYXR0cmlidXRlTmFtZTogJ21hbmFfbXVsdGlwbGllcicsXG4gICAgICAgICAgICBsYWJlbDogJ0RBTUFHRTonLFxuICAgICAgICAgICAgaWdub3JlVG9vbHRpcDogdHJ1ZSxcbiAgICAgICAgICAgIGNvbnRyb2xUeXBlOiAndGV4dCcsXG4gICAgICAgICAgICBmbjogZnVuY3Rpb24gKHYsIGEsIHBhcmVudCwgaW5kZXgsIGFiaWxpdHlNb2RlbCwgYWJpbGl0eSkge1xuICAgICAgICAgICAgICAgIHJldHVybiB2KmE7XG4gICAgICAgICAgICB9XG4gICAgICAgIH0sXG4gICAgICAgIHtcbiAgICAgICAgICAgIGF0dHJpYnV0ZU5hbWU6ICdtYW5hX3JlZ2VuJyxcbiAgICAgICAgICAgIGxhYmVsOiAnVG90YWwgRGFtYWdlJyxcbiAgICAgICAgICAgIGNvbnRyb2xUeXBlOiAndGV4dCcsXG4gICAgICAgICAgICBmbjogZnVuY3Rpb24gKHYsIGEsIHBhcmVudCwgaW5kZXgsIGFiaWxpdHlNb2RlbCwgYWJpbGl0eSkge1xuICAgICAgICAgICAgICAgIHJldHVybiBhO1xuICAgICAgICAgICAgfSxcbiAgICAgICAgICAgIHJldHVyblByb3BlcnR5OiAnbWFuYXJlZ2VucmVkdWN0aW9uJ1xuICAgICAgICB9XG4gICAgXSxcbiAgICAncHVnbmFfbGlmZV9kcmFpbic6IFtcbiAgICAgICAge1xuICAgICAgICAgICAgbGFiZWw6ICdEdXJhdGlvbicsXG4gICAgICAgICAgICBjb250cm9sVHlwZTogJ2lucHV0J1xuICAgICAgICB9LFxuICAgICAgICB7XG4gICAgICAgICAgICBhdHRyaWJ1dGVOYW1lOiAnaGVhbHRoX2RyYWluJyxcbiAgICAgICAgICAgIGxhYmVsOiAnSEVBTFRIIERSQUlORUQ6JyxcbiAgICAgICAgICAgIGlnbm9yZVRvb2x0aXA6IHRydWUsXG4gICAgICAgICAgICBjb250cm9sVHlwZTogJ3RleHQnLFxuICAgICAgICAgICAgZm46IGZ1bmN0aW9uICh2LCBhLCBwYXJlbnQsIGluZGV4LCBhYmlsaXR5TW9kZWwsIGFiaWxpdHkpIHtcbiAgICAgICAgICAgICAgICByZXR1cm4gdiphO1xuICAgICAgICAgICAgfVxuICAgICAgICB9XG4gICAgXSxcbiAgICAncXVlZW5vZnBhaW5fc2hhZG93X3N0cmlrZSc6IFtcbiAgICAgICAge1xuICAgICAgICAgICAgbGFiZWw6ICdEdXJhdGlvbicsXG4gICAgICAgICAgICBjb250cm9sVHlwZTogJ2lucHV0J1xuICAgICAgICB9LFxuICAgICAgICB7XG4gICAgICAgICAgICBhdHRyaWJ1dGVOYW1lOiAnbW92ZW1lbnRfc2xvdycsXG4gICAgICAgICAgICBsYWJlbDogJ1RvdGFsIERhbWFnZScsXG4gICAgICAgICAgICBjb250cm9sVHlwZTogJ3RleHQnLFxuICAgICAgICAgICAgZm46IGZ1bmN0aW9uICh2LCBhLCBwYXJlbnQsIGluZGV4LCBhYmlsaXR5TW9kZWwsIGFiaWxpdHkpIHtcbiAgICAgICAgICAgICAgICByZXR1cm4gYTtcbiAgICAgICAgICAgIH0sXG4gICAgICAgICAgICByZXR1cm5Qcm9wZXJ0eTogJ21vdmVtZW50U3BlZWRQY3RSZWR1Y3Rpb24nXG4gICAgICAgIH0sXG4gICAgICAgIHtcbiAgICAgICAgICAgIGF0dHJpYnV0ZU5hbWU6ICdzdHJpa2VfZGFtYWdlJyxcbiAgICAgICAgICAgIGxhYmVsOiAnVG90YWwgRGFtYWdlOicsXG4gICAgICAgICAgICBpZ25vcmVUb29sdGlwOiB0cnVlLFxuICAgICAgICAgICAgY29udHJvbFR5cGU6ICd0ZXh0JyxcbiAgICAgICAgICAgIGZuOiBmdW5jdGlvbiAodiwgYSwgcGFyZW50LCBpbmRleCwgYWJpbGl0eU1vZGVsLCBhYmlsaXR5KSB7XG4gICAgICAgICAgICAgICAgdmFyIGR1cmF0aW9uX2RhbWFnZSA9IGFiaWxpdHlNb2RlbC5nZXRBYmlsaXR5QXR0cmlidXRlVmFsdWUoYWJpbGl0eS5hdHRyaWJ1dGVzLCAnZHVyYXRpb25fZGFtYWdlJyxhYmlsaXR5LmxldmVsKCkpO1xuICAgICAgICAgICAgICAgIHZhciB0aWNrcyA9IE1hdGguZmxvb3Iodi8zKTtcbiAgICAgICAgICAgICAgICByZXR1cm4gYSArIGR1cmF0aW9uX2RhbWFnZSAqIHRpY2tzO1xuICAgICAgICAgICAgfVxuICAgICAgICB9XG4gICAgXSxcbiAgICAncmF6b3JfcGxhc21hX2ZpZWxkJzogW1xuICAgICAgICB7XG4gICAgICAgICAgICBsYWJlbDogJ0Rpc3RhbmNlJyxcbiAgICAgICAgICAgIGNvbnRyb2xUeXBlOiAnaW5wdXQnXG4gICAgICAgIH0sXG4gICAgICAgIHtcbiAgICAgICAgICAgIGF0dHJpYnV0ZU5hbWU6ICdyYWRpdXMnLFxuICAgICAgICAgICAgbGFiZWw6ICdNSU4gRElTVEFOQ0U6JyxcbiAgICAgICAgICAgIGlnbm9yZVRvb2x0aXA6IHRydWUsXG4gICAgICAgICAgICBjb250cm9sVHlwZTogJ3RleHQnLFxuICAgICAgICAgICAgZm46IGZ1bmN0aW9uICh2LCBhLCBwYXJlbnQsIGluZGV4LCBhYmlsaXR5TW9kZWwsIGFiaWxpdHkpIHtcbiAgICAgICAgICAgICAgICByZXR1cm4gMjAwO1xuICAgICAgICAgICAgfVxuICAgICAgICB9LFxuICAgICAgICB7XG4gICAgICAgICAgICBhdHRyaWJ1dGVOYW1lOiAncmFkaXVzJyxcbiAgICAgICAgICAgIGxhYmVsOiAnTUFYIERJU1RBTkNFOicsXG4gICAgICAgICAgICBpZ25vcmVUb29sdGlwOiB0cnVlLFxuICAgICAgICAgICAgY29udHJvbFR5cGU6ICd0ZXh0JyxcbiAgICAgICAgICAgIGZuOiBmdW5jdGlvbiAodiwgYSwgcGFyZW50LCBpbmRleCwgYWJpbGl0eU1vZGVsLCBhYmlsaXR5KSB7XG4gICAgICAgICAgICAgICAgcmV0dXJuIDIwMCArIGE7XG4gICAgICAgICAgICB9XG4gICAgICAgIH0sXG4gICAgICAgIHtcbiAgICAgICAgICAgIGF0dHJpYnV0ZU5hbWU6ICdyYWRpdXMnLFxuICAgICAgICAgICAgbGFiZWw6ICdJbnN0YW5jZSBEYW1hZ2UnLFxuICAgICAgICAgICAgaWdub3JlVG9vbHRpcDogdHJ1ZSxcbiAgICAgICAgICAgIGNvbnRyb2xUeXBlOiAndGV4dCcsXG4gICAgICAgICAgICBmbjogZnVuY3Rpb24gKHYsIGEsIHBhcmVudCwgaW5kZXgsIGFiaWxpdHlNb2RlbCwgYWJpbGl0eSkge1xuICAgICAgICAgICAgICAgIHZhciBtYXhfcmFkaXVzID0gYSArIDIwMDtcbiAgICAgICAgICAgICAgICB2YXIgc2NhbGUgPSAoTWF0aC5taW4oTWF0aC5tYXgodiwgMjAwKSwgbWF4X3JhZGl1cykgLSAyMDApIC8gKG1heF9yYWRpdXMgLSAyMDApO1xuICAgICAgICAgICAgICAgIHZhciBkYW1hZ2VfbWluID0gYWJpbGl0eU1vZGVsLmdldEFiaWxpdHlBdHRyaWJ1dGVWYWx1ZShhYmlsaXR5LmF0dHJpYnV0ZXMsICdkYW1hZ2VfbWluJyxhYmlsaXR5LmxldmVsKCkpO1xuICAgICAgICAgICAgICAgIHZhciBkYW1hZ2VfbWF4ID0gYWJpbGl0eU1vZGVsLmdldEFiaWxpdHlBdHRyaWJ1dGVWYWx1ZShhYmlsaXR5LmF0dHJpYnV0ZXMsICdkYW1hZ2VfbWF4JyxhYmlsaXR5LmxldmVsKCkpO1xuICAgICAgICAgICAgICAgIHJldHVybiBkYW1hZ2VfbWluICsgKGRhbWFnZV9tYXggLSBkYW1hZ2VfbWluKSAqIHNjYWxlO1xuICAgICAgICAgICAgfVxuICAgICAgICB9XG4gICAgXSxcbiAgICAncmF6b3Jfc3RhdGljX2xpbmsnOiBbXG4gICAgICAgIHtcbiAgICAgICAgICAgIGxhYmVsOiAnRHVyYXRpb24nLFxuICAgICAgICAgICAgY29udHJvbFR5cGU6ICdpbnB1dCdcbiAgICAgICAgfSxcbiAgICAgICAge1xuICAgICAgICAgICAgYXR0cmlidXRlTmFtZTogJ2RyYWluX2xlbmd0aCcsXG4gICAgICAgICAgICBsYWJlbDogJ0RhbWFnZSBEcmFpbmVkOicsXG4gICAgICAgICAgICBpZ25vcmVUb29sdGlwOiB0cnVlLFxuICAgICAgICAgICAgY29udHJvbFR5cGU6ICd0ZXh0JyxcbiAgICAgICAgICAgIGZuOiBmdW5jdGlvbiAodiwgYSwgcGFyZW50LCBpbmRleCwgYWJpbGl0eU1vZGVsLCBhYmlsaXR5KSB7XG4gICAgICAgICAgICAgICAgdmFyIHRpY2tfZHVyYXRpb24gPSBNYXRoLmZsb29yKHYgKiA0KSArIDE7XG4gICAgICAgICAgICAgICAgdmFyIHRpY2tzID0gTWF0aC5taW4oYSAqIDQgKyAxLCB0aWNrX2R1cmF0aW9uKTtcbiAgICAgICAgICAgICAgICB2YXIgZHJhaW5fcmF0ZSA9IGFiaWxpdHlNb2RlbC5nZXRBYmlsaXR5QXR0cmlidXRlVmFsdWUoYWJpbGl0eS5hdHRyaWJ1dGVzLCAnZHJhaW5fcmF0ZScsYWJpbGl0eS5sZXZlbCgpKTtcbiAgICAgICAgICAgICAgICByZXR1cm4gdGlja3MgKiBkcmFpbl9yYXRlLzQ7XG4gICAgICAgICAgICB9LFxuICAgICAgICAgICAgcmV0dXJuUHJvcGVydHk6ICdib251c0RhbWFnZSdcbiAgICAgICAgfSxcbiAgICAgICAge1xuICAgICAgICAgICAgYXR0cmlidXRlTmFtZTogJ2RyYWluX2xlbmd0aCcsXG4gICAgICAgICAgICBsYWJlbDogJ0VuZW15IERhbWFnZSBMb3N0OicsXG4gICAgICAgICAgICBpZ25vcmVUb29sdGlwOiB0cnVlLFxuICAgICAgICAgICAgY29udHJvbFR5cGU6ICd0ZXh0JyxcbiAgICAgICAgICAgIGRpc3BsYXk6ICdoaWRkZW4nLFxuICAgICAgICAgICAgZm46IGZ1bmN0aW9uICh2LCBhLCBwYXJlbnQsIGluZGV4LCBhYmlsaXR5TW9kZWwsIGFiaWxpdHkpIHtcbiAgICAgICAgICAgICAgICB2YXIgdGlja19kdXJhdGlvbiA9IE1hdGguZmxvb3IodiAqIDQpICsgMTtcbiAgICAgICAgICAgICAgICB2YXIgdGlja3MgPSBNYXRoLm1pbihhICogNCArIDEsIHRpY2tfZHVyYXRpb24pO1xuICAgICAgICAgICAgICAgIHZhciBkcmFpbl9yYXRlID0gYWJpbGl0eU1vZGVsLmdldEFiaWxpdHlBdHRyaWJ1dGVWYWx1ZShhYmlsaXR5LmF0dHJpYnV0ZXMsICdkcmFpbl9yYXRlJyxhYmlsaXR5LmxldmVsKCkpO1xuICAgICAgICAgICAgICAgIHJldHVybiB0aWNrcyAqIGRyYWluX3JhdGUvNDtcbiAgICAgICAgICAgIH0sXG4gICAgICAgICAgICByZXR1cm5Qcm9wZXJ0eTogJ2JvbnVzRGFtYWdlUmVkdWN0aW9uJ1xuICAgICAgICB9XG4gICAgXSxcbiAgICAncmF6b3JfZXllX29mX3RoZV9zdG9ybSc6IFtcbiAgICAgICAge1xuICAgICAgICAgICAgbGFiZWw6ICdEdXJhdGlvbicsXG4gICAgICAgICAgICBjb250cm9sVHlwZTogJ2lucHV0J1xuICAgICAgICB9LFxuICAgICAgICB7XG4gICAgICAgICAgICBhdHRyaWJ1dGVOYW1lOiAnZGFtYWdlJyxcbiAgICAgICAgICAgIGxhYmVsOiAnVG90YWwgRGFtYWdlJyxcbiAgICAgICAgICAgIGNvbnRyb2xUeXBlOiAndGV4dCcsXG4gICAgICAgICAgICBmbjogZnVuY3Rpb24gKHYsIGEsIHBhcmVudCwgaW5kZXgsIGFiaWxpdHlNb2RlbCwgYWJpbGl0eSkge1xuICAgICAgICAgICAgICAgIHJldHVybiB2KmE7XG4gICAgICAgICAgICB9XG4gICAgICAgIH1cbiAgICBdLFxuICAgICdydWJpY2tfZmFkZV9ib2x0JzogW1xuICAgICAgICB7XG4gICAgICAgICAgICBsYWJlbDogJ0p1bXBzJyxcbiAgICAgICAgICAgIGNvbnRyb2xUeXBlOiAnaW5wdXQnXG4gICAgICAgIH0sXG4gICAgICAgIHtcbiAgICAgICAgICAgIGF0dHJpYnV0ZU5hbWU6ICdkYW1hZ2UnLFxuICAgICAgICAgICAgbGFiZWw6ICdUb3RhbCBEYW1hZ2UnLFxuICAgICAgICAgICAgY29udHJvbFR5cGU6ICd0ZXh0JyxcbiAgICAgICAgICAgIGZuOiBmdW5jdGlvbiAodiwgYSwgcGFyZW50LCBpbmRleCwgYWJpbGl0eU1vZGVsLCBhYmlsaXR5KSB7XG4gICAgICAgICAgICAgICAgcmV0dXJuIGEgKiAoMSAtIHYqYWJpbGl0eU1vZGVsLmdldEFiaWxpdHlBdHRyaWJ1dGVWYWx1ZShhYmlsaXR5LmF0dHJpYnV0ZXMsICdqdW1wX2RhbWFnZV9yZWR1Y3Rpb25fcGN0JyxhYmlsaXR5LmxldmVsKCkpLzEwMCk7XG4gICAgICAgICAgICB9XG4gICAgICAgIH0sXG4gICAgICAgIHtcbiAgICAgICAgICAgIGF0dHJpYnV0ZU5hbWU6ICdoZXJvX2F0dGFja19kYW1hZ2VfcmVkdWN0aW9uJyxcbiAgICAgICAgICAgIGxhYmVsOiAnVG90YWwgRGFtYWdlJyxcbiAgICAgICAgICAgIGNvbnRyb2xUeXBlOiAndGV4dCcsXG4gICAgICAgICAgICBmbjogZnVuY3Rpb24gKHYsIGEsIHBhcmVudCwgaW5kZXgsIGFiaWxpdHlNb2RlbCwgYWJpbGl0eSkge1xuICAgICAgICAgICAgICAgIHJldHVybiBhO1xuICAgICAgICAgICAgfSxcbiAgICAgICAgICAgIHJldHVyblByb3BlcnR5OiAnYm9udXNEYW1hZ2VSZWR1Y3Rpb24nXG4gICAgICAgIH1cbiAgICBdLFxuICAgICdzYW5ka2luZ19zYW5kX3N0b3JtJzogW1xuICAgICAgICB7XG4gICAgICAgICAgICBsYWJlbDogJ0R1cmF0aW9uJyxcbiAgICAgICAgICAgIGNvbnRyb2xUeXBlOiAnaW5wdXQnXG4gICAgICAgIH0sXG4gICAgICAgIHtcbiAgICAgICAgICAgIGxhYmVsOiAnREFNQUdFOicsXG4gICAgICAgICAgICBjb250cm9sVHlwZTogJ3RleHQnLFxuICAgICAgICAgICAgZm46IGZ1bmN0aW9uICh2LCBhLCBwYXJlbnQsIGluZGV4LCBhYmlsaXR5TW9kZWwsIGFiaWxpdHkpIHtcbiAgICAgICAgICAgICAgICByZXR1cm4gYWJpbGl0eU1vZGVsLmdldEFiaWxpdHlQcm9wZXJ0eVZhbHVlKGFiaWxpdHksICdkYW1hZ2UnKSp2O1xuICAgICAgICAgICAgfVxuICAgICAgICB9XG4gICAgXSxcbiAgICAnc2FuZGtpbmdfZXBpY2VudGVyJzogW1xuICAgICAgICB7XG4gICAgICAgICAgICBsYWJlbDogJ1B1bHNlcycsXG4gICAgICAgICAgICBjb250cm9sVHlwZTogJ2lucHV0J1xuICAgICAgICB9LFxuICAgICAgICB7XG4gICAgICAgICAgICBhdHRyaWJ1dGVOYW1lOiAnZXBpY2VudGVyX2RhbWFnZScsXG4gICAgICAgICAgICBsYWJlbDogJ0RBTUFHRTonLFxuICAgICAgICAgICAgaWdub3JlVG9vbHRpcDogdHJ1ZSxcbiAgICAgICAgICAgIGNvbnRyb2xUeXBlOiAndGV4dCcsXG4gICAgICAgICAgICBmbjogZnVuY3Rpb24gKHYsIGEsIHBhcmVudCwgaW5kZXgsIGFiaWxpdHlNb2RlbCwgYWJpbGl0eSkge1xuICAgICAgICAgICAgICAgIHJldHVybiB2KmE7XG4gICAgICAgICAgICB9XG4gICAgICAgIH0sXG4gICAgICAgIHtcbiAgICAgICAgICAgIGF0dHJpYnV0ZU5hbWU6ICdlcGljZW50ZXJfc2xvdycsXG4gICAgICAgICAgICBsYWJlbDogJ1RvdGFsIERhbWFnZScsXG4gICAgICAgICAgICBjb250cm9sVHlwZTogJ3RleHQnLFxuICAgICAgICAgICAgZm46IGZ1bmN0aW9uICh2LCBhLCBwYXJlbnQsIGluZGV4LCBhYmlsaXR5TW9kZWwsIGFiaWxpdHkpIHtcbiAgICAgICAgICAgICAgICByZXR1cm4gYTtcbiAgICAgICAgICAgIH0sXG4gICAgICAgICAgICByZXR1cm5Qcm9wZXJ0eTogJ21vdmVtZW50U3BlZWRQY3RSZWR1Y3Rpb24nXG4gICAgICAgIH0sXG4gICAgICAgIHtcbiAgICAgICAgICAgIGF0dHJpYnV0ZU5hbWU6ICdlcGljZW50ZXJfc2xvd19hcycsXG4gICAgICAgICAgICBsYWJlbDogJyVBVFRBQ0sgU0xPVzonLFxuICAgICAgICAgICAgaWdub3JlVG9vbHRpcDogdHJ1ZSxcbiAgICAgICAgICAgIGNvbnRyb2xUeXBlOiAndGV4dCcsXG4gICAgICAgICAgICBmbjogZnVuY3Rpb24gKHYsIGEsIHBhcmVudCwgaW5kZXgsIGFiaWxpdHlNb2RlbCwgYWJpbGl0eSkge1xuICAgICAgICAgICAgICAgIHJldHVybiBhO1xuICAgICAgICAgICAgfSxcbiAgICAgICAgICAgIHJldHVyblByb3BlcnR5OiAnYXR0YWNrc3BlZWRyZWR1Y3Rpb24nXG4gICAgICAgIH1cbiAgICBdLFxuICAgICdzaGFkb3dfZGVtb25fc2hhZG93X3BvaXNvbic6IFtcbiAgICAgICAge1xuICAgICAgICAgICAgbGFiZWw6ICdEdXJhdGlvbicsXG4gICAgICAgICAgICBjb250cm9sVHlwZTogJ2lucHV0J1xuICAgICAgICB9LFxuICAgICAgICB7XG4gICAgICAgICAgICBhdHRyaWJ1dGVOYW1lOiAnc3RhY2tfZGFtYWdlJyxcbiAgICAgICAgICAgIGxhYmVsOiAnVG90YWwgRGFtYWdlJyxcbiAgICAgICAgICAgIGNvbnRyb2xUeXBlOiAndGV4dCcsXG4gICAgICAgICAgICBmbjogZnVuY3Rpb24gKHYsIGEsIHBhcmVudCwgaW5kZXgsIGFiaWxpdHlNb2RlbCwgYWJpbGl0eSkge1xuICAgICAgICAgICAgICAgIHZhciBzdGFja211bHQgPSBbMSwyLDQsOF07XG4gICAgICAgICAgICAgICAgaWYgKHYgPiA0KSB7XG4gICAgICAgICAgICAgICAgICAgIHJldHVybiBhICogc3RhY2ttdWx0WzNdICsgNTAgKiAodiAtIDQpO1xuICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgICBlbHNlIGlmICh2IDw9IDApIHtcbiAgICAgICAgICAgICAgICAgICAgcmV0dXJuIDBcbiAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgICAgZWxzZSB7XG4gICAgICAgICAgICAgICAgICAgIHJldHVybiBhICogc3RhY2ttdWx0W3YtMV1cbiAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICB9XG4gICAgICAgIH1cbiAgICBdLFxuICAgICduZXZlcm1vcmVfbmVjcm9tYXN0ZXJ5JzogW1xuICAgICAgICB7XG4gICAgICAgICAgICBsYWJlbDogJ1NvdWxzJyxcbiAgICAgICAgICAgIGNvbnRyb2xUeXBlOiAnaW5wdXQnXG4gICAgICAgIH0sXG4gICAgICAgIHtcbiAgICAgICAgICAgIGF0dHJpYnV0ZU5hbWU6ICduZWNyb21hc3RlcnlfZGFtYWdlX3Blcl9zb3VsJyxcbiAgICAgICAgICAgIGxhYmVsOiAnREFNQUdFOicsXG4gICAgICAgICAgICBpZ25vcmVUb29sdGlwOiB0cnVlLFxuICAgICAgICAgICAgY29udHJvbFR5cGU6ICd0ZXh0JyxcbiAgICAgICAgICAgIGZuOiBmdW5jdGlvbiAodiwgYSwgcGFyZW50LCBpbmRleCwgYWJpbGl0eU1vZGVsLCBhYmlsaXR5KSB7XG4gICAgICAgICAgICAgICAgcmV0dXJuIHYqYTtcbiAgICAgICAgICAgIH0sXG4gICAgICAgICAgICByZXR1cm5Qcm9wZXJ0eTogJ2JvbnVzRGFtYWdlJ1xuICAgICAgICB9XG4gICAgXSxcbiAgICAnbmV2ZXJtb3JlX3JlcXVpZW0nOiBbXG4gICAgICAgIHtcbiAgICAgICAgICAgIGxhYmVsOiAnTGluZSBIaXQgQ291bnQnLFxuICAgICAgICAgICAgY29udHJvbFR5cGU6ICdpbnB1dCdcbiAgICAgICAgfSxcbiAgICAgICAge1xuICAgICAgICAgICAgYXR0cmlidXRlTmFtZTogJ3JlcXVpZW1fcmVkdWN0aW9uX2RhbWFnZScsXG4gICAgICAgICAgICBsYWJlbDogJ0RhbWFnZTonLFxuICAgICAgICAgICAgaWdub3JlVG9vbHRpcDogdHJ1ZSxcbiAgICAgICAgICAgIGNvbnRyb2xUeXBlOiAndGV4dCcsXG4gICAgICAgICAgICBmbjogZnVuY3Rpb24gKHYsIGEsIHBhcmVudCwgaW5kZXgsIGFiaWxpdHlNb2RlbCwgYWJpbGl0eSkge1xuICAgICAgICAgICAgICAgIHJldHVybiBhYmlsaXR5TW9kZWwuZ2V0QWJpbGl0eVByb3BlcnR5VmFsdWUoYWJpbGl0eSwgJ2RhbWFnZScpKnY7XG4gICAgICAgICAgICB9XG4gICAgICAgIH0sXG4gICAgICAgIHtcbiAgICAgICAgICAgIGxhYmVsOiAnUmV0dXJuIExpbmUgSGl0IENvdW50IChTY2VwdGVyKScsXG4gICAgICAgICAgICBjb250cm9sVHlwZTogJ2lucHV0J1xuICAgICAgICB9LFxuICAgICAgICB7XG4gICAgICAgICAgICBhdHRyaWJ1dGVOYW1lOiAncmVxdWllbV9kYW1hZ2VfcGN0X3NjZXB0ZXInLFxuICAgICAgICAgICAgbGFiZWw6ICdEYW1hZ2UvSGVhbDonLFxuICAgICAgICAgICAgaWdub3JlVG9vbHRpcDogdHJ1ZSxcbiAgICAgICAgICAgIGNvbnRyb2xUeXBlOiAndGV4dCcsXG4gICAgICAgICAgICBmbjogZnVuY3Rpb24gKHYsIGEsIHBhcmVudCwgaW5kZXgsIGFiaWxpdHlNb2RlbCwgYWJpbGl0eSkge1xuICAgICAgICAgICAgICAgIHJldHVybiBhYmlsaXR5TW9kZWwuZ2V0QWJpbGl0eVByb3BlcnR5VmFsdWUoYWJpbGl0eSwgJ2RhbWFnZScpKnYqYS8xMDA7XG4gICAgICAgICAgICB9XG4gICAgICAgIH0sXG4gICAgICAgIHtcbiAgICAgICAgICAgIGF0dHJpYnV0ZU5hbWU6ICdyZXF1aWVtX2RhbWFnZV9wY3Rfc2NlcHRlcicsXG4gICAgICAgICAgICBsYWJlbDogJ1RvdGFsIERhbWFnZTonLFxuICAgICAgICAgICAgaWdub3JlVG9vbHRpcDogdHJ1ZSxcbiAgICAgICAgICAgIGNvbnRyb2xUeXBlOiAndGV4dCcsXG4gICAgICAgICAgICBjb250cm9sczogWzAsMV0sXG4gICAgICAgICAgICBmbjogZnVuY3Rpb24gKHYsIGEsIHBhcmVudCwgaW5kZXgsIGFiaWxpdHlNb2RlbCwgYWJpbGl0eSkge1xuICAgICAgICAgICAgICAgIHZhciBkYW1hZ2UgPSBhYmlsaXR5TW9kZWwuZ2V0QWJpbGl0eVByb3BlcnR5VmFsdWUoYWJpbGl0eSwgJ2RhbWFnZScpO1xuICAgICAgICAgICAgICAgIHJldHVybiBkYW1hZ2UqdlswXSArIGRhbWFnZSp2WzFdKmEvMTAwO1xuICAgICAgICAgICAgfVxuICAgICAgICB9LFxuICAgICAgICB7XG4gICAgICAgICAgICBhdHRyaWJ1dGVOYW1lOiAncmVxdWllbV9yZWR1Y3Rpb25fZGFtYWdlJyxcbiAgICAgICAgICAgIGxhYmVsOiAnJURBTUFHRSBSRURVQ1RJT046JyxcbiAgICAgICAgICAgIGlnbm9yZVRvb2x0aXA6IHRydWUsXG4gICAgICAgICAgICBjb250cm9sVHlwZTogJ3RleHQnLFxuICAgICAgICAgICAgZm46IGZ1bmN0aW9uICh2LCBhLCBwYXJlbnQsIGluZGV4LCBhYmlsaXR5TW9kZWwsIGFiaWxpdHkpIHtcbiAgICAgICAgICAgICAgICByZXR1cm4gYTtcbiAgICAgICAgICAgIH0sXG4gICAgICAgICAgICByZXR1cm5Qcm9wZXJ0eTogJ2Jhc2VEYW1hZ2VSZWR1Y3Rpb25QY3QnXG4gICAgICAgIH0sXG4gICAgICAgIHtcbiAgICAgICAgICAgIGF0dHJpYnV0ZU5hbWU6ICdyZXF1aWVtX3JlZHVjdGlvbl9tcycsXG4gICAgICAgICAgICBsYWJlbDogJyVEQU1BR0UgUkVEVUNUSU9OOicsXG4gICAgICAgICAgICBjb250cm9sVHlwZTogJ3RleHQnLFxuICAgICAgICAgICAgZm46IGZ1bmN0aW9uICh2LCBhLCBwYXJlbnQsIGluZGV4LCBhYmlsaXR5TW9kZWwsIGFiaWxpdHkpIHtcbiAgICAgICAgICAgICAgICByZXR1cm4gYTtcbiAgICAgICAgICAgIH0sXG4gICAgICAgICAgICByZXR1cm5Qcm9wZXJ0eTogJ21vdmVtZW50U3BlZWRQY3RSZWR1Y3Rpb24nXG4gICAgICAgIH1cbiAgICBdLFxuICAgICdzaGFkb3dfc2hhbWFuX3NoYWNrbGVzJzogW1xuICAgICAgICB7XG4gICAgICAgICAgICBsYWJlbDogJ0R1cmF0aW9uJyxcbiAgICAgICAgICAgIGNvbnRyb2xUeXBlOiAnaW5wdXQnXG4gICAgICAgIH0sXG4gICAgICAgIHtcbiAgICAgICAgICAgIGxhYmVsOiAnREFNQUdFOicsXG4gICAgICAgICAgICBjb250cm9sVHlwZTogJ3RleHQnLFxuICAgICAgICAgICAgZm46IGZ1bmN0aW9uICh2LCBhLCBwYXJlbnQsIGluZGV4LCBhYmlsaXR5TW9kZWwsIGFiaWxpdHkpIHtcbiAgICAgICAgICAgICAgICByZXR1cm4gYWJpbGl0eU1vZGVsLmdldEFiaWxpdHlQcm9wZXJ0eVZhbHVlKGFiaWxpdHksICdkYW1hZ2UnKSp2O1xuICAgICAgICAgICAgfVxuICAgICAgICB9XG4gICAgXSxcbiAgICAnc2lsZW5jZXJfY3Vyc2Vfb2ZfdGhlX3NpbGVudCc6IFtcbiAgICAgICAge1xuICAgICAgICAgICAgbGFiZWw6ICdEdXJhdGlvbicsXG4gICAgICAgICAgICBjb250cm9sVHlwZTogJ2lucHV0J1xuICAgICAgICB9LFxuICAgICAgICB7XG4gICAgICAgICAgICBhdHRyaWJ1dGVOYW1lOiAnZGFtYWdlJyxcbiAgICAgICAgICAgIGxhYmVsOiAnVG90YWwgRGFtYWdlJyxcbiAgICAgICAgICAgIGNvbnRyb2xUeXBlOiAndGV4dCcsXG4gICAgICAgICAgICBmbjogZnVuY3Rpb24gKHYsIGEsIHBhcmVudCwgaW5kZXgsIGFiaWxpdHlNb2RlbCwgYWJpbGl0eSkge1xuICAgICAgICAgICAgICAgIHJldHVybiBNYXRoLmZsb29yKHYpKmE7XG4gICAgICAgICAgICB9XG4gICAgICAgIH0sXG4gICAgICAgIHtcbiAgICAgICAgICAgIGF0dHJpYnV0ZU5hbWU6ICdtb3Zlc3BlZWQnLFxuICAgICAgICAgICAgbGFiZWw6ICdUb3RhbCBEYW1hZ2UnLFxuICAgICAgICAgICAgY29udHJvbFR5cGU6ICd0ZXh0JyxcbiAgICAgICAgICAgIGZuOiBmdW5jdGlvbiAodiwgYSwgcGFyZW50LCBpbmRleCwgYWJpbGl0eU1vZGVsLCBhYmlsaXR5KSB7XG4gICAgICAgICAgICAgICAgcmV0dXJuIGE7XG4gICAgICAgICAgICB9LFxuICAgICAgICAgICAgcmV0dXJuUHJvcGVydHk6ICdtb3ZlbWVudFNwZWVkUGN0UmVkdWN0aW9uJ1xuICAgICAgICB9XG4gICAgXSxcbi8qICAgICAgICAnc2lsZW5jZXJfZ2xhaXZlc19vZl93aXNkb20nOiBbXG4gICAgICAgIHtcbiAgICAgICAgICAgIGxhYmVsOiAnRHVyYXRpb24nLFxuICAgICAgICAgICAgY29udHJvbFR5cGU6ICdpbnB1dCdcbiAgICAgICAgfSxcbiAgICAgICAge1xuICAgICAgICAgICAgYXR0cmlidXRlTmFtZTogJ2RhbWFnZScsXG4gICAgICAgICAgICBsYWJlbDogJ1RvdGFsIERhbWFnZScsXG4gICAgICAgICAgICBjb250cm9sVHlwZTogJ3RleHQnLFxuICAgICAgICAgICAgZm46IGZ1bmN0aW9uICh2LCBhLCBwYXJlbnQsIGluZGV4LCBhYmlsaXR5TW9kZWwsIGFiaWxpdHkpIHtcbiAgICAgICAgICAgICAgICByZXR1cm4gdiphO1xuICAgICAgICAgICAgfVxuICAgICAgICB9XG4gICAgXSwqL1xuICAgICdza3l3cmF0aF9tYWdlX215c3RpY19mbGFyZSc6IFtcbiAgICAgICAge1xuICAgICAgICAgICAgbGFiZWw6ICdEdXJhdGlvbicsXG4gICAgICAgICAgICBjb250cm9sVHlwZTogJ2lucHV0J1xuICAgICAgICB9LFxuICAgICAgICB7XG4gICAgICAgICAgICBhdHRyaWJ1dGVOYW1lOiAnZGFtYWdlJyxcbiAgICAgICAgICAgIGxhYmVsOiAnVG90YWwgRGFtYWdlJyxcbiAgICAgICAgICAgIGNvbnRyb2xUeXBlOiAndGV4dCcsXG4gICAgICAgICAgICBmbjogZnVuY3Rpb24gKHYsIGEsIHBhcmVudCwgaW5kZXgsIGFiaWxpdHlNb2RlbCwgYWJpbGl0eSkge1xuICAgICAgICAgICAgICAgIHJldHVybiB2KmE7XG4gICAgICAgICAgICB9XG4gICAgICAgIH1cbiAgICBdLFxuICAgICdzbGFya19lc3NlbmNlX3NoaWZ0JzogW1xuICAgICAgICB7XG4gICAgICAgICAgICBsYWJlbDogJ0F0dGFja3MnLFxuICAgICAgICAgICAgY29udHJvbFR5cGU6ICdpbnB1dCdcbiAgICAgICAgfSxcbiAgICAgICAge1xuICAgICAgICAgICAgYXR0cmlidXRlTmFtZTogJ2FnaV9nYWluJyxcbiAgICAgICAgICAgIGxhYmVsOiAnVG90YWwgRGFtYWdlJyxcbiAgICAgICAgICAgIGNvbnRyb2xUeXBlOiAndGV4dCcsXG4gICAgICAgICAgICBkaXNwbGF5OiAnYWJpbGl0eScsXG4gICAgICAgICAgICBmbjogZnVuY3Rpb24gKHYsIGEsIHBhcmVudCwgaW5kZXgsIGFiaWxpdHlNb2RlbCwgYWJpbGl0eSkge1xuICAgICAgICAgICAgICAgIHJldHVybiB2KmE7XG4gICAgICAgICAgICB9LFxuICAgICAgICAgICAgcmV0dXJuUHJvcGVydHk6ICdib251c0FnaWxpdHknXG4gICAgICAgIH0sXG4gICAgICAgIHtcbiAgICAgICAgICAgIGF0dHJpYnV0ZU5hbWU6ICdzdGF0X2xvc3MnLFxuICAgICAgICAgICAgbGFiZWw6ICdUb3RhbCBEYW1hZ2UnLFxuICAgICAgICAgICAgY29udHJvbFR5cGU6ICd0ZXh0JyxcbiAgICAgICAgICAgIGZuOiBmdW5jdGlvbiAodiwgYSwgcGFyZW50LCBpbmRleCwgYWJpbGl0eU1vZGVsLCBhYmlsaXR5KSB7XG4gICAgICAgICAgICAgICAgcmV0dXJuIC12KmE7XG4gICAgICAgICAgICB9LFxuICAgICAgICAgICAgcmV0dXJuUHJvcGVydHk6ICdib251c0FsbFN0YXRzUmVkdWN0aW9uJ1xuICAgICAgICB9XG4gICAgXSxcbiAgICAnc2xhcmtfc2hhZG93X2RhbmNlJzogW1xuICAgICAgICB7XG4gICAgICAgICAgICBsYWJlbDogJ0R1cmF0aW9uJyxcbiAgICAgICAgICAgIGNvbnRyb2xUeXBlOiAnaW5wdXQnXG4gICAgICAgIH0sXG4gICAgICAgIHtcbiAgICAgICAgICAgIGF0dHJpYnV0ZU5hbWU6ICdib251c19yZWdlbl9wY3QnLFxuICAgICAgICAgICAgbGFiZWw6ICdUT1RBTCBIRUFMVEggUkVHRU5FUkFURUQ6JyxcbiAgICAgICAgICAgIGlnbm9yZVRvb2x0aXA6IHRydWUsXG4gICAgICAgICAgICBjb250cm9sVHlwZTogJ3RleHQnLFxuICAgICAgICAgICAgZm46IGZ1bmN0aW9uICh2LCBhLCBwYXJlbnQsIGluZGV4LCBhYmlsaXR5TW9kZWwsIGFiaWxpdHkpIHtcbiAgICAgICAgICAgICAgICByZXR1cm4gdipwYXJlbnQuaGVhbHRoKCkqYS8xMDA7XG4gICAgICAgICAgICB9XG4gICAgICAgIH0sXG4gICAgICAgIHtcbiAgICAgICAgICAgIGF0dHJpYnV0ZU5hbWU6ICdib251c19yZWdlbl9wY3QnLFxuICAgICAgICAgICAgbGFiZWw6ICdIRUFMVEggR0FJTkVEIFBFUiBTRUNPTkQ6JyxcbiAgICAgICAgICAgIGlnbm9yZVRvb2x0aXA6IHRydWUsXG4gICAgICAgICAgICBjb250cm9sVHlwZTogJ3RleHQnLFxuICAgICAgICAgICAgZm46IGZ1bmN0aW9uICh2LCBhLCBwYXJlbnQsIGluZGV4LCBhYmlsaXR5TW9kZWwsIGFiaWxpdHkpIHtcbiAgICAgICAgICAgICAgICByZXR1cm4gcGFyZW50LmhlYWx0aCgpKmEvMTAwO1xuICAgICAgICAgICAgfSxcbiAgICAgICAgICAgIHJldHVyblByb3BlcnR5OiAnaGVhbHRocmVnZW4nXG4gICAgICAgIH0sXG4gICAgICAgIHtcbiAgICAgICAgICAgIGF0dHJpYnV0ZU5hbWU6ICdib251c19tb3ZlbWVudF9zcGVlZCcsXG4gICAgICAgICAgICBsYWJlbDogJyVNT1ZFIFNQRUVEOicsXG4gICAgICAgICAgICBpZ25vcmVUb29sdGlwOiB0cnVlLFxuICAgICAgICAgICAgY29udHJvbFR5cGU6ICd0ZXh0JyxcbiAgICAgICAgICAgIGZuOiBmdW5jdGlvbiAodiwgYSwgcGFyZW50LCBpbmRleCwgYWJpbGl0eU1vZGVsLCBhYmlsaXR5KSB7XG4gICAgICAgICAgICAgICAgcmV0dXJuIGE7XG4gICAgICAgICAgICB9LFxuICAgICAgICAgICAgcmV0dXJuUHJvcGVydHk6ICdtb3ZlbWVudFNwZWVkUGN0J1xuICAgICAgICB9XG4gICAgXSxcbiAgICAnc25pcGVyX3NocmFwbmVsJzogW1xuICAgICAgICB7XG4gICAgICAgICAgICBsYWJlbDogJ0R1cmF0aW9uJyxcbiAgICAgICAgICAgIGNvbnRyb2xUeXBlOiAnaW5wdXQnXG4gICAgICAgIH0sXG4gICAgICAgIHtcbiAgICAgICAgICAgIGxhYmVsOiAnREFNQUdFOicsXG4gICAgICAgICAgICBpZ25vcmVUb29sdGlwOiB0cnVlLFxuICAgICAgICAgICAgY29udHJvbFR5cGU6ICd0ZXh0JyxcbiAgICAgICAgICAgIGZuOiBmdW5jdGlvbiAodiwgYSwgcGFyZW50LCBpbmRleCwgYWJpbGl0eU1vZGVsLCBhYmlsaXR5KSB7XG4gICAgICAgICAgICAgICAgcmV0dXJuIGFiaWxpdHlNb2RlbC5nZXRBYmlsaXR5UHJvcGVydHlWYWx1ZShhYmlsaXR5LCAnZGFtYWdlJykqdjtcbiAgICAgICAgICAgIH1cbiAgICAgICAgfSxcbiAgICAgICAge1xuICAgICAgICAgICAgYXR0cmlidXRlTmFtZTogJ2J1aWxkaW5nX2RhbWFnZScsXG4gICAgICAgICAgICBsYWJlbDogJ0JVSUxESU5HIERBTUFHRTonLFxuICAgICAgICAgICAgaWdub3JlVG9vbHRpcDogdHJ1ZSxcbiAgICAgICAgICAgIGNvbnRyb2xUeXBlOiAndGV4dCcsXG4gICAgICAgICAgICBmbjogZnVuY3Rpb24gKHYsIGEsIHBhcmVudCwgaW5kZXgsIGFiaWxpdHlNb2RlbCwgYWJpbGl0eSkge1xuICAgICAgICAgICAgICAgIHJldHVybiB2KmE7XG4gICAgICAgICAgICB9XG4gICAgICAgIH0sXG4gICAgICAgIHtcbiAgICAgICAgICAgIGF0dHJpYnV0ZU5hbWU6ICdzbG93X21vdmVtZW50X3NwZWVkJyxcbiAgICAgICAgICAgIGxhYmVsOiAnRW5lbXkgTW92ZW1lbnQgU3BlZWQgU2xvdycsXG4gICAgICAgICAgICBjb250cm9sVHlwZTogJ3RleHQnLFxuICAgICAgICAgICAgZm46IGZ1bmN0aW9uICh2LCBhLCBwYXJlbnQsIGluZGV4LCBhYmlsaXR5TW9kZWwsIGFiaWxpdHkpIHtcbiAgICAgICAgICAgICAgICByZXR1cm4gYTtcbiAgICAgICAgICAgIH0sXG4gICAgICAgICAgICByZXR1cm5Qcm9wZXJ0eTogJ21vdmVtZW50U3BlZWRQY3RSZWR1Y3Rpb24nXG4gICAgICAgIH1cbiAgICBdLFxuICAgICdzcGVjdHJlX2Rlc29sYXRlJzogW1xuICAgICAgICB7XG4gICAgICAgICAgICBsYWJlbDogJ0VuZW15IEFsb25lJyxcbiAgICAgICAgICAgIGNvbnRyb2xUeXBlOiAnY2hlY2tib3gnXG4gICAgICAgIH0sXG4gICAgICAgIHtcbiAgICAgICAgICAgIGF0dHJpYnV0ZU5hbWU6ICdib251c19kYW1hZ2UnLFxuICAgICAgICAgICAgbGFiZWw6ICdUb3RhbCBEYW1hZ2UnLFxuICAgICAgICAgICAgY29udHJvbFR5cGU6ICd0ZXh0JyxcbiAgICAgICAgICAgIGZuOiBmdW5jdGlvbiAodiwgYSwgcGFyZW50LCBpbmRleCwgYWJpbGl0eU1vZGVsLCBhYmlsaXR5KSB7XG4gICAgICAgICAgICAgICAgaWYgKHYpIHtcbiAgICAgICAgICAgICAgICAgICAgcmV0dXJuIGE7XG4gICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICAgIGVsc2Uge1xuICAgICAgICAgICAgICAgICAgICByZXR1cm4gMDtcbiAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICB9LFxuICAgICAgICAgICAgcmV0dXJuUHJvcGVydHk6ICdib251c0RhbWFnZSdcbiAgICAgICAgfVxuICAgIF0sXG4gICAgJ3NwZWN0cmVfZGlzcGVyc2lvbic6IFtcbiAgICAgICAge1xuICAgICAgICAgICAgbGFiZWw6ICdEYW1hZ2UgVGFrZW4nLFxuICAgICAgICAgICAgY29udHJvbFR5cGU6ICdpbnB1dCdcbiAgICAgICAgfSxcbiAgICAgICAge1xuICAgICAgICAgICAgYXR0cmlidXRlTmFtZTogJ2RhbWFnZV9yZWZsZWN0aW9uX3BjdCcsXG4gICAgICAgICAgICBsYWJlbDogJ0RBTUFHRSBSRUZMRUNURUQ6JyxcbiAgICAgICAgICAgIGNvbnRyb2xUeXBlOiAndGV4dCcsXG4gICAgICAgICAgICBmbjogZnVuY3Rpb24gKHYsIGEsIHBhcmVudCwgaW5kZXgsIGFiaWxpdHlNb2RlbCwgYWJpbGl0eSkge1xuICAgICAgICAgICAgICAgIHJldHVybiAtYTtcbiAgICAgICAgICAgIH0sXG4gICAgICAgICAgICByZXR1cm5Qcm9wZXJ0eTogJ2RhbWFnZVJlZHVjdGlvbidcbiAgICAgICAgfSxcbiAgICAgICAge1xuICAgICAgICAgICAgYXR0cmlidXRlTmFtZTogJ2RhbWFnZV9yZWZsZWN0aW9uX3BjdCcsXG4gICAgICAgICAgICBsYWJlbDogJ0RBTUFHRSBSRUZMRUNURUQ6JyxcbiAgICAgICAgICAgIGlnbm9yZVRvb2x0aXA6IHRydWUsXG4gICAgICAgICAgICBjb250cm9sVHlwZTogJ3RleHQnLFxuICAgICAgICAgICAgZm46IGZ1bmN0aW9uICh2LCBhLCBwYXJlbnQsIGluZGV4LCBhYmlsaXR5TW9kZWwsIGFiaWxpdHkpIHtcbiAgICAgICAgICAgICAgICByZXR1cm4gdiphLzEwMDtcbiAgICAgICAgICAgIH1cbiAgICAgICAgfVxuICAgIF0sXG4gICAgJ3N0b3JtX3NwaXJpdF9iYWxsX2xpZ2h0bmluZyc6IFtcbiAgICAgICAge1xuICAgICAgICAgICAgbGFiZWw6ICdNQVggTUFOQScsXG4gICAgICAgICAgICBjb250cm9sVHlwZTogJ2lucHV0J1xuICAgICAgICB9LFxuICAgICAgICB7XG4gICAgICAgICAgICBsYWJlbDogJ0Rpc3RhbmNlJyxcbiAgICAgICAgICAgIGNvbnRyb2xUeXBlOiAnaW5wdXQnXG4gICAgICAgIH0sXG4gICAgICAgIHtcbiAgICAgICAgICAgIGF0dHJpYnV0ZU5hbWU6ICdiYWxsX2xpZ2h0bmluZ19pbml0aWFsX21hbmFfYmFzZScsXG4gICAgICAgICAgICBsYWJlbDogJ1RvdGFsIERhbWFnZTonLFxuICAgICAgICAgICAgaWdub3JlVG9vbHRpcDogdHJ1ZSxcbiAgICAgICAgICAgIGNvbnRyb2xUeXBlOiAndGV4dCcsXG4gICAgICAgICAgICBjb250cm9sczogWzAsIDFdLFxuICAgICAgICAgICAgZm46IGZ1bmN0aW9uICh2LCBhLCBwYXJlbnQsIGluZGV4LCBhYmlsaXR5TW9kZWwsIGFiaWxpdHkpIHtcbiAgICAgICAgICAgICAgICByZXR1cm4gYWJpbGl0eU1vZGVsLmdldEFiaWxpdHlQcm9wZXJ0eVZhbHVlKGFiaWxpdHksICdkYW1hZ2UnKS8xMDAqdlsxXTtcbiAgICAgICAgICAgIH1cbiAgICAgICAgfSxcbiAgICAgICAge1xuICAgICAgICAgICAgYXR0cmlidXRlTmFtZTogJ2JhbGxfbGlnaHRuaW5nX2luaXRpYWxfbWFuYV9iYXNlJyxcbiAgICAgICAgICAgIGxhYmVsOiAnRkxBVCBNQU5BIENPU1Q6JyxcbiAgICAgICAgICAgIGlnbm9yZVRvb2x0aXA6IHRydWUsXG4gICAgICAgICAgICBjb250cm9sVHlwZTogJ21ldGhvZCcsXG4gICAgICAgICAgICBjb250cm9sczogWzAsIDFdLFxuICAgICAgICAgICAgZm46IGZ1bmN0aW9uICh2LCBhLCBwYXJlbnQsIGluZGV4LCBhYmlsaXR5TW9kZWwsIGFiaWxpdHkpIHtcbiAgICAgICAgICAgICAgICB2YXIgZGlzdGFuY2VfaW50ZXJ2YWxzID0gTWF0aC5mbG9vcih2WzFdLzEwMCk7XG4gICAgICAgICAgICAgICAgdmFyIHRyYXZlbF9jb3N0X2Jhc2UgPSBhYmlsaXR5TW9kZWwuZ2V0QWJpbGl0eUF0dHJpYnV0ZVZhbHVlKGFiaWxpdHkuYXR0cmlidXRlcywgJ2JhbGxfbGlnaHRuaW5nX3RyYXZlbF9jb3N0X2Jhc2UnLDApO1xuICAgICAgICAgICAgICAgIHJldHVybiBhICsgZGlzdGFuY2VfaW50ZXJ2YWxzICogdHJhdmVsX2Nvc3RfYmFzZTtcbiAgICAgICAgICAgIH1cbiAgICAgICAgfSxcbiAgICAgICAge1xuICAgICAgICAgICAgYXR0cmlidXRlTmFtZTogJ2JhbGxfbGlnaHRuaW5nX2luaXRpYWxfbWFuYV9wZXJjZW50YWdlJyxcbiAgICAgICAgICAgIGxhYmVsOiAnJU1BWCBNQU5BIENPU1Q6JyxcbiAgICAgICAgICAgIGlnbm9yZVRvb2x0aXA6IHRydWUsXG4gICAgICAgICAgICBjb250cm9sVHlwZTogJ21ldGhvZCcsXG4gICAgICAgICAgICBjb250cm9sczogWzAsIDFdLFxuICAgICAgICAgICAgZm46IGZ1bmN0aW9uICh2LCBhLCBwYXJlbnQsIGluZGV4LCBhYmlsaXR5TW9kZWwsIGFiaWxpdHkpIHtcbiAgICAgICAgICAgICAgICB2YXIgZGlzdGFuY2VfaW50ZXJ2YWxzID0gTWF0aC5mbG9vcih2WzFdLzEwMCk7XG4gICAgICAgICAgICAgICAgdmFyIHRyYXZlbF9jb3N0X3BlcmNlbnQgPSBhYmlsaXR5TW9kZWwuZ2V0QWJpbGl0eUF0dHJpYnV0ZVZhbHVlKGFiaWxpdHkuYXR0cmlidXRlcywgJ2JhbGxfbGlnaHRuaW5nX3RyYXZlbF9jb3N0X3BlcmNlbnQnLDApO1xuICAgICAgICAgICAgICAgIHJldHVybiBhICsgZGlzdGFuY2VfaW50ZXJ2YWxzICogdHJhdmVsX2Nvc3RfcGVyY2VudDtcbiAgICAgICAgICAgIH1cbiAgICAgICAgfSxcbiAgICAgICAge1xuICAgICAgICAgICAgYXR0cmlidXRlTmFtZTogJ2JhbGxfbGlnaHRuaW5nX2luaXRpYWxfbWFuYV9iYXNlJyxcbiAgICAgICAgICAgIGxhYmVsOiAnVE9UQUwgTUFOQSBDT1NUOicsXG4gICAgICAgICAgICBpZ25vcmVUb29sdGlwOiB0cnVlLFxuICAgICAgICAgICAgY29udHJvbFR5cGU6ICd0ZXh0JyxcbiAgICAgICAgICAgIGNvbnRyb2xzOiBbMCwgMSwgMiwgM10sXG4gICAgICAgICAgICBmbjogZnVuY3Rpb24gKHYsIGEsIHBhcmVudCwgaW5kZXgsIGFiaWxpdHlNb2RlbCwgYWJpbGl0eSkge1xuICAgICAgICAgICAgICAgIHJldHVybiB2WzJdICsgJyArICcgKyAodlszXS8xMDAgKiB2WzBdKSArICcgKCcgKyB2WzNdICsgJyUgb2YgbWF4KSA9ICcgKyAodlsyXSArIHZbM10vMTAwICogdlswXSk7XG4gICAgICAgICAgICB9XG4gICAgICAgIH1cbiAgICBdLFxuICAgICd0ZW1wbGFyX2Fzc2Fzc2luX3BzaW9uaWNfdHJhcCc6IFtcbiAgICAgICAge1xuICAgICAgICAgICAgbGFiZWw6ICdDaGFyZ2UgVGltZScsXG4gICAgICAgICAgICBjb250cm9sVHlwZTogJ2lucHV0J1xuICAgICAgICB9LFxuICAgICAgICB7XG4gICAgICAgICAgICBhdHRyaWJ1dGVOYW1lOiAnbW92ZW1lbnRfc3BlZWRfbWluX3Rvb2x0aXAnLFxuICAgICAgICAgICAgbGFiZWw6ICclTU9WRSBTTE9XOicsXG4gICAgICAgICAgICBpZ25vcmVUb29sdGlwOiB0cnVlLFxuICAgICAgICAgICAgY29udHJvbFR5cGU6ICd0ZXh0JyxcbiAgICAgICAgICAgIGZuOiBmdW5jdGlvbiAodiwgYSwgcGFyZW50LCBpbmRleCwgYWJpbGl0eU1vZGVsLCBhYmlsaXR5KSB7XG4gICAgICAgICAgICAgICAgdmFyIG1heF9zbG93ID0gYWJpbGl0eU1vZGVsLmdldEFiaWxpdHlBdHRyaWJ1dGVWYWx1ZShhYmlsaXR5LmF0dHJpYnV0ZXMsICdtb3ZlbWVudF9zcGVlZF9tYXhfdG9vbHRpcCcsMCk7XG4gICAgICAgICAgICAgICAgdmFyIHNsb3dfcGVyX3RpY2sgPSAobWF4X3Nsb3cgLSBhKS80MDtcbiAgICAgICAgICAgICAgICByZXR1cm4gLShhICsgc2xvd19wZXJfdGljayAqIE1hdGgubWluKE1hdGgubWF4KDAsIHYpLCA0KSAqIDEwKTtcbiAgICAgICAgICAgIH0sXG4gICAgICAgICAgICByZXR1cm5Qcm9wZXJ0eTogJ21vdmVtZW50U3BlZWRQY3RSZWR1Y3Rpb24nXG4gICAgICAgIH1cbiAgICBdLFxuICAgICdzaHJlZGRlcl9yZWFjdGl2ZV9hcm1vcic6IFtcbiAgICAgICAge1xuICAgICAgICAgICAgbGFiZWw6ICdTdGFja3MnLFxuICAgICAgICAgICAgY29udHJvbFR5cGU6ICdpbnB1dCdcbiAgICAgICAgfSxcbiAgICAgICAge1xuICAgICAgICAgICAgYXR0cmlidXRlTmFtZTogJ2JvbnVzX2FybW9yJyxcbiAgICAgICAgICAgIGxhYmVsOiAnVG90YWwgQXJtb3IgQm9udXMnLFxuICAgICAgICAgICAgY29udHJvbFR5cGU6ICd0ZXh0JyxcbiAgICAgICAgICAgIGZuOiBmdW5jdGlvbiAodiwgYSwgcGFyZW50LCBpbmRleCwgYWJpbGl0eU1vZGVsLCBhYmlsaXR5KSB7XG4gICAgICAgICAgICAgICAgcmV0dXJuIHYqYTtcbiAgICAgICAgICAgIH0sXG4gICAgICAgICAgICByZXR1cm5Qcm9wZXJ0eTogJ2FybW9yJ1xuICAgICAgICB9LFxuICAgICAgICB7XG4gICAgICAgICAgICBhdHRyaWJ1dGVOYW1lOiAnYm9udXNfaHBfcmVnZW4nLFxuICAgICAgICAgICAgbGFiZWw6ICdUb3RhbCBIUCBSZWdlbiBCb251cycsXG4gICAgICAgICAgICBjb250cm9sVHlwZTogJ3RleHQnLFxuICAgICAgICAgICAgZm46IGZ1bmN0aW9uICh2LCBhLCBwYXJlbnQsIGluZGV4LCBhYmlsaXR5TW9kZWwsIGFiaWxpdHkpIHtcbiAgICAgICAgICAgICAgICByZXR1cm4gdiphO1xuICAgICAgICAgICAgfSxcbiAgICAgICAgICAgIHJldHVyblByb3BlcnR5OiAnaGVhbHRocmVnZW4nXG4gICAgICAgIH1cbiAgICBdLFxuICAgICdzaHJlZGRlcl9jaGFrcmFtJzogW1xuICAgICAgICB7XG4gICAgICAgICAgICBsYWJlbDogJ0R1cmF0aW9uJyxcbiAgICAgICAgICAgIGNvbnRyb2xUeXBlOiAnaW5wdXQnXG4gICAgICAgIH0sXG4gICAgICAgIHtcbiAgICAgICAgICAgIGF0dHJpYnV0ZU5hbWU6ICdkYW1hZ2VfcGVyX3NlY29uZCcsXG4gICAgICAgICAgICBsYWJlbDogJ0RBTUFHRTonLFxuICAgICAgICAgICAgaWdub3JlVG9vbHRpcDogdHJ1ZSxcbiAgICAgICAgICAgIGNvbnRyb2xUeXBlOiAndGV4dCcsXG4gICAgICAgICAgICBmbjogZnVuY3Rpb24gKHYsIGEsIHBhcmVudCwgaW5kZXgsIGFiaWxpdHlNb2RlbCwgYWJpbGl0eSkge1xuICAgICAgICAgICAgICAgIHZhciBpbnRlcnZhbCA9IGFiaWxpdHlNb2RlbC5nZXRBYmlsaXR5QXR0cmlidXRlVmFsdWUoYWJpbGl0eS5hdHRyaWJ1dGVzLCAnZGFtYWdlX2ludGVydmFsJywwKTtcbiAgICAgICAgICAgICAgICB2YXIgdGlja3MgPSBNYXRoLmZsb29yKHYgLyBpbnRlcnZhbCk7XG4gICAgICAgICAgICAgICAgcmV0dXJuIGEqaW50ZXJ2YWwqdGlja3M7XG4gICAgICAgICAgICB9XG4gICAgICAgIH0sXG4gICAgICAgIHtcbiAgICAgICAgICAgIGF0dHJpYnV0ZU5hbWU6ICdtYW5hX3Blcl9zZWNvbmQnLFxuICAgICAgICAgICAgbGFiZWw6ICdNQU5BIENPU1Q6JyxcbiAgICAgICAgICAgIGlnbm9yZVRvb2x0aXA6IHRydWUsXG4gICAgICAgICAgICBjb250cm9sVHlwZTogJ3RleHQnLFxuICAgICAgICAgICAgZm46IGZ1bmN0aW9uICh2LCBhLCBwYXJlbnQsIGluZGV4LCBhYmlsaXR5TW9kZWwsIGFiaWxpdHkpIHtcbiAgICAgICAgICAgICAgICB2YXIgaW50ZXJ2YWwgPSBhYmlsaXR5TW9kZWwuZ2V0QWJpbGl0eUF0dHJpYnV0ZVZhbHVlKGFiaWxpdHkuYXR0cmlidXRlcywgJ2RhbWFnZV9pbnRlcnZhbCcsMCk7XG4gICAgICAgICAgICAgICAgdmFyIHRpY2tzID0gTWF0aC5mbG9vcih2IC8gaW50ZXJ2YWwpO1xuICAgICAgICAgICAgICAgIHJldHVybiBhKmludGVydmFsKnRpY2tzO1xuICAgICAgICAgICAgfVxuICAgICAgICB9LFxuICAgICAgICB7XG4gICAgICAgICAgICBsYWJlbDogJ0VORU1ZICVIUCcsXG4gICAgICAgICAgICBjb250cm9sVHlwZTogJ2lucHV0J1xuICAgICAgICB9LFxuICAgICAgICB7XG4gICAgICAgICAgICBhdHRyaWJ1dGVOYW1lOiAnc2xvdycsXG4gICAgICAgICAgICBsYWJlbDogJ01BTkEgQ09TVDonLFxuICAgICAgICAgICAgY29udHJvbFR5cGU6ICd0ZXh0JyxcbiAgICAgICAgICAgIGZuOiBmdW5jdGlvbiAodiwgYSwgcGFyZW50LCBpbmRleCwgYWJpbGl0eU1vZGVsLCBhYmlsaXR5KSB7XG4gICAgICAgICAgICAgICAgdmFyIHRpY2tzID0gMjAgLSBNYXRoLmZsb29yKE1hdGgubWluKE1hdGgubWF4KHYtMSwgMCksIDk5KSAvIDUpO1xuICAgICAgICAgICAgICAgIHJldHVybiAtYSp0aWNrcztcbiAgICAgICAgICAgIH0sXG4gICAgICAgICAgICByZXR1cm5Qcm9wZXJ0eTogJ21vdmVtZW50U3BlZWRQY3RSZWR1Y3Rpb24nXG4gICAgICAgIH1cbiAgICBdLFxuICAgICdzcGlyaXRfYnJlYWtlcl9ncmVhdGVyX2Jhc2gnOiBbXG4gICAgICAgIHtcbiAgICAgICAgICAgIGxhYmVsOiAnQmFzaCBQcm9jJyxcbiAgICAgICAgICAgIGNvbnRyb2xUeXBlOiAnY2hlY2tib3gnXG4gICAgICAgIH0sXG4gICAgICAgIHtcbiAgICAgICAgICAgIGF0dHJpYnV0ZU5hbWU6ICdkYW1hZ2UnLFxuICAgICAgICAgICAgbGFiZWw6ICclTU9WRVNQRUVEIEFTIERBTUFHRScsXG4gICAgICAgICAgICBjb250cm9sVHlwZTogJ3RleHQnLFxuICAgICAgICAgICAgZm46IGZ1bmN0aW9uICh2LCBhLCBwYXJlbnQsIGluZGV4LCBhYmlsaXR5TW9kZWwsIGFiaWxpdHkpIHtcbiAgICAgICAgICAgICAgICBpZiAodikge1xuICAgICAgICAgICAgICAgICAgICByZXR1cm4gYTtcbiAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgICAgZWxzZSB7XG4gICAgICAgICAgICAgICAgICAgIHJldHVybiAwO1xuICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgIH0sXG4gICAgICAgICAgICByZXR1cm5Qcm9wZXJ0eTogJ2Jhc2hCb251c0RhbWFnZSdcbiAgICAgICAgfSxcbiAgICAgICAge1xuICAgICAgICAgICAgYXR0cmlidXRlTmFtZTogJ2JvbnVzX21vdmVzcGVlZF9wY3QnLFxuICAgICAgICAgICAgbGFiZWw6ICdUb3RhbCBEYW1hZ2UnLFxuICAgICAgICAgICAgY29udHJvbFR5cGU6ICd0ZXh0JyxcbiAgICAgICAgICAgIGZuOiBmdW5jdGlvbiAodiwgYSwgcGFyZW50LCBpbmRleCwgYWJpbGl0eU1vZGVsLCBhYmlsaXR5KSB7XG4gICAgICAgICAgICAgICAgaWYgKHYpIHtcbiAgICAgICAgICAgICAgICAgICAgcmV0dXJuIGE7XG4gICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICAgIGVsc2Uge1xuICAgICAgICAgICAgICAgICAgICByZXR1cm4gMDtcbiAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICB9LFxuICAgICAgICAgICAgcmV0dXJuUHJvcGVydHk6ICdtb3ZlbWVudFNwZWVkUGN0J1xuICAgICAgICB9LFxuICAgICAgICB7XG4gICAgICAgICAgICBhdHRyaWJ1dGVOYW1lOiAnY2hhbmNlX3BjdCcsXG4gICAgICAgICAgICBsYWJlbDogJ1RvdGFsIERhbWFnZScsXG4gICAgICAgICAgICBjb250cm9sVHlwZTogJ3RleHQnLFxuICAgICAgICAgICAgZm46IGZ1bmN0aW9uICh2LCBhLCBwYXJlbnQsIGluZGV4LCBhYmlsaXR5TW9kZWwsIGFiaWxpdHkpIHtcbiAgICAgICAgICAgICAgICByZXR1cm4gYVxuICAgICAgICAgICAgfSxcbiAgICAgICAgICAgIHJldHVyblByb3BlcnR5OiAnYmFzaCdcbiAgICAgICAgfVxuICAgIF0sXG4gICAgJ3RlY2hpZXNfbGFuZF9taW5lcyc6IFtcbiAgICAgICAge1xuICAgICAgICAgICAgbGFiZWw6ICdOdW1iZXIgb2YgTWluZXMnLFxuICAgICAgICAgICAgY29udHJvbFR5cGU6ICdpbnB1dCdcbiAgICAgICAgfSxcbiAgICAgICAge1xuICAgICAgICAgICAgYXR0cmlidXRlTmFtZTogJ2RhbWFnZScsXG4gICAgICAgICAgICBsYWJlbDogJ1RvdGFsIERhbWFnZScsXG4gICAgICAgICAgICBjb250cm9sVHlwZTogJ3RleHQnLFxuICAgICAgICAgICAgZm46IGZ1bmN0aW9uICh2LCBhLCBwYXJlbnQsIGluZGV4LCBhYmlsaXR5TW9kZWwsIGFiaWxpdHkpIHtcbiAgICAgICAgICAgICAgICByZXR1cm4gdiphO1xuICAgICAgICAgICAgfVxuICAgICAgICB9LFxuICAgICAgICB7XG4gICAgICAgICAgICBhdHRyaWJ1dGVOYW1lOiAnZGFtYWdlJyxcbiAgICAgICAgICAgIGxhYmVsOiAnQUZURVIgUkVEVUNUSU9OUzonLFxuICAgICAgICAgICAgaWdub3JlVG9vbHRpcDogdHJ1ZSxcbiAgICAgICAgICAgIGNvbnRyb2xUeXBlOiAndGV4dCcsXG4gICAgICAgICAgICBmbjogZnVuY3Rpb24gKHYsIGEsIHBhcmVudCwgaW5kZXgsIGFiaWxpdHlNb2RlbCwgYWJpbGl0eSkge1xuICAgICAgICAgICAgICAgIHZhciBwaHlzX3JlZHVjdGlvbiA9IHBhcmVudC5lbmVteSgpLnRvdGFsQXJtb3JQaHlzaWNhbFJlZHVjdGlvbigpLFxuICAgICAgICAgICAgICAgICAgICBtYWdpY19yZWR1Y3Rpb24gPSBwYXJlbnQuZW5lbXkoKS50b3RhbE1hZ2ljUmVzaXN0YW5jZSgpO1xuICAgICAgICAgICAgICAgIHJldHVybiAodiAqIGEgKiAoMSAtIHBoeXNfcmVkdWN0aW9uIC8gMTAwKSAqICgxIC0gbWFnaWNfcmVkdWN0aW9uIC8gMTAwKSkudG9GaXhlZCgyKTtcbiAgICAgICAgICAgIH1cbiAgICAgICAgfVxuICAgIF0sXG4gICAgJ3RlY2hpZXNfc3VpY2lkZSc6IFtcbiAgICAgICAge1xuICAgICAgICAgICAgYXR0cmlidXRlTmFtZTogJ2RhbWFnZScsXG4gICAgICAgICAgICBsYWJlbDogJ0ZVTEwgREFNQUdFIEFGVEVSIFJFRFVDVElPTlM6JyxcbiAgICAgICAgICAgIGlnbm9yZVRvb2x0aXA6IHRydWUsXG4gICAgICAgICAgICBjb250cm9sVHlwZTogJ3RleHQnLFxuICAgICAgICAgICAgZm46IGZ1bmN0aW9uICh2LCBhLCBwYXJlbnQsIGluZGV4LCBhYmlsaXR5TW9kZWwsIGFiaWxpdHkpIHtcbiAgICAgICAgICAgICAgICB2YXIgcGh5c19yZWR1Y3Rpb24gPSBwYXJlbnQuZW5lbXkoKS50b3RhbEFybW9yUGh5c2ljYWxSZWR1Y3Rpb24oKSxcbiAgICAgICAgICAgICAgICAgICAgbWFnaWNfcmVkdWN0aW9uID0gcGFyZW50LmVuZW15KCkudG90YWxNYWdpY1Jlc2lzdGFuY2UoKTtcbiAgICAgICAgICAgICAgICByZXR1cm4gKGEgKiAoMSAtIHBoeXNfcmVkdWN0aW9uIC8gMTAwKSAqICgxIC0gbWFnaWNfcmVkdWN0aW9uIC8gMTAwKSkudG9GaXhlZCgyKTtcbiAgICAgICAgICAgIH1cbiAgICAgICAgfSxcbiAgICAgICAge1xuICAgICAgICAgICAgYXR0cmlidXRlTmFtZTogJ3BhcnRpYWxfZGFtYWdlJyxcbiAgICAgICAgICAgIGxhYmVsOiAnUEFSVElBTCBEQU1BR0UgQUZURVIgUkVEVUNUSU9OUzonLFxuICAgICAgICAgICAgaWdub3JlVG9vbHRpcDogdHJ1ZSxcbiAgICAgICAgICAgIGNvbnRyb2xUeXBlOiAndGV4dCcsXG4gICAgICAgICAgICBmbjogZnVuY3Rpb24gKHYsIGEsIHBhcmVudCwgaW5kZXgsIGFiaWxpdHlNb2RlbCwgYWJpbGl0eSkge1xuICAgICAgICAgICAgICAgIHZhciBwaHlzX3JlZHVjdGlvbiA9IHBhcmVudC5lbmVteSgpLnRvdGFsQXJtb3JQaHlzaWNhbFJlZHVjdGlvbigpLFxuICAgICAgICAgICAgICAgICAgICBtYWdpY19yZWR1Y3Rpb24gPSBwYXJlbnQuZW5lbXkoKS50b3RhbE1hZ2ljUmVzaXN0YW5jZSgpO1xuICAgICAgICAgICAgICAgIHJldHVybiAoYSAqICgxIC0gcGh5c19yZWR1Y3Rpb24gLyAxMDApICogKDEgLSBtYWdpY19yZWR1Y3Rpb24gLyAxMDApKS50b0ZpeGVkKDIpO1xuICAgICAgICAgICAgfVxuICAgICAgICB9LFxuICAgICAgICB7XG4gICAgICAgICAgICBhdHRyaWJ1dGVOYW1lOiAnZGFtYWdlJyxcbiAgICAgICAgICAgIGxhYmVsOiAnUkVTUEFXTiBUSU1FOicsXG4gICAgICAgICAgICBpZ25vcmVUb29sdGlwOiB0cnVlLFxuICAgICAgICAgICAgY29udHJvbFR5cGU6ICd0ZXh0JyxcbiAgICAgICAgICAgIGZuOiBmdW5jdGlvbiAodiwgYSwgcGFyZW50LCBpbmRleCwgYWJpbGl0eU1vZGVsLCBhYmlsaXR5KSB7XG4gICAgICAgICAgICAgICAgcmV0dXJuIChwYXJlbnQucmVzcGF3blRpbWUoKSAvIDIpLnRvRml4ZWQoMCkgKyAnIHNlY29uZHMnO1xuICAgICAgICAgICAgfVxuICAgICAgICB9XG4gICAgXSxcbiAgICAndGVjaGllc19yZW1vdGVfbWluZXMnOiBbXG4gICAgICAgIHtcbiAgICAgICAgICAgIGxhYmVsOiAnTnVtYmVyIG9mIE1pbmVzJyxcbiAgICAgICAgICAgIGNvbnRyb2xUeXBlOiAnaW5wdXQnXG4gICAgICAgIH0sXG4gICAgICAgIHtcbiAgICAgICAgICAgIGF0dHJpYnV0ZU5hbWU6ICdkYW1hZ2UnLFxuICAgICAgICAgICAgbGFiZWw6ICdUb3RhbCBEYW1hZ2UnLFxuICAgICAgICAgICAgY29udHJvbFR5cGU6ICd0ZXh0JyxcbiAgICAgICAgICAgIGZuOiBmdW5jdGlvbiAodiwgYSwgcGFyZW50LCBpbmRleCwgYWJpbGl0eU1vZGVsLCBhYmlsaXR5KSB7XG4gICAgICAgICAgICAgICAgcmV0dXJuIHYqYTtcbiAgICAgICAgICAgIH1cbiAgICAgICAgfSxcbiAgICAgICAge1xuICAgICAgICAgICAgYXR0cmlidXRlTmFtZTogJ2RhbWFnZScsXG4gICAgICAgICAgICBsYWJlbDogJ0FGVEVSIFJFRFVDVElPTlM6JyxcbiAgICAgICAgICAgIGlnbm9yZVRvb2x0aXA6IHRydWUsXG4gICAgICAgICAgICBjb250cm9sVHlwZTogJ3RleHQnLFxuICAgICAgICAgICAgZm46IGZ1bmN0aW9uICh2LCBhLCBwYXJlbnQsIGluZGV4LCBhYmlsaXR5TW9kZWwsIGFiaWxpdHkpIHtcbiAgICAgICAgICAgICAgICB2YXIgbWFnaWNfcmVkdWN0aW9uID0gcGFyZW50LmVuZW15KCkudG90YWxNYWdpY1Jlc2lzdGFuY2UoKTtcbiAgICAgICAgICAgICAgICByZXR1cm4gKHYgKiBhICogKDEgLSBtYWdpY19yZWR1Y3Rpb24gLyAxMDApKS50b0ZpeGVkKDIpO1xuICAgICAgICAgICAgfVxuICAgICAgICB9XG4gICAgXSxcbiAgICAndGlua2VyX21hcmNoX29mX3RoZV9tYWNoaW5lcyc6IFtcbiAgICAgICAge1xuICAgICAgICAgICAgbGFiZWw6ICdSb2JvdCBFeHBsb3Npb25zJyxcbiAgICAgICAgICAgIGNvbnRyb2xUeXBlOiAnaW5wdXQnXG4gICAgICAgIH0sXG4gICAgICAgIHtcbiAgICAgICAgICAgIGF0dHJpYnV0ZU5hbWU6ICdtYWNoaW5lc19wZXJfc2VjJyxcbiAgICAgICAgICAgIGxhYmVsOiAnVE9UQUwgREFNQUdFOicsXG4gICAgICAgICAgICBpZ25vcmVUb29sdGlwOiB0cnVlLFxuICAgICAgICAgICAgY29udHJvbFR5cGU6ICd0ZXh0JyxcbiAgICAgICAgICAgIGZuOiBmdW5jdGlvbiAodiwgYSwgcGFyZW50LCBpbmRleCwgYWJpbGl0eU1vZGVsLCBhYmlsaXR5KSB7XG4gICAgICAgICAgICAgICAgcmV0dXJuIGFiaWxpdHlNb2RlbC5nZXRBYmlsaXR5UHJvcGVydHlWYWx1ZShhYmlsaXR5LCAnZGFtYWdlJykqdjtcbiAgICAgICAgICAgIH1cbiAgICAgICAgfVxuICAgIF0sXG4gICAgJ3RyZWFudF9sZWVjaF9zZWVkJzogW1xuICAgICAgICB7XG4gICAgICAgICAgICBsYWJlbDogJ1B1bHNlcycsXG4gICAgICAgICAgICBjb250cm9sVHlwZTogJ2lucHV0J1xuICAgICAgICB9LFxuICAgICAgICB7XG4gICAgICAgICAgICBhdHRyaWJ1dGVOYW1lOiAnbGVlY2hfZGFtYWdlJyxcbiAgICAgICAgICAgIGxhYmVsOiAnREFNQUdFL0hFQUw6JyxcbiAgICAgICAgICAgIGlnbm9yZVRvb2x0aXA6IHRydWUsXG4gICAgICAgICAgICBjb250cm9sVHlwZTogJ3RleHQnLFxuICAgICAgICAgICAgZm46IGZ1bmN0aW9uICh2LCBhLCBwYXJlbnQsIGluZGV4LCBhYmlsaXR5TW9kZWwsIGFiaWxpdHkpIHtcbiAgICAgICAgICAgICAgICByZXR1cm4gdiphO1xuICAgICAgICAgICAgfVxuICAgICAgICB9LFxuICAgICAgICB7XG4gICAgICAgICAgICBhdHRyaWJ1dGVOYW1lOiAnbW92ZW1lbnRfc2xvdycsXG4gICAgICAgICAgICBsYWJlbDogJ1RvdGFsIERhbWFnZScsXG4gICAgICAgICAgICBjb250cm9sVHlwZTogJ3RleHQnLFxuICAgICAgICAgICAgZm46IGZ1bmN0aW9uICh2LCBhLCBwYXJlbnQsIGluZGV4LCBhYmlsaXR5TW9kZWwsIGFiaWxpdHkpIHtcbiAgICAgICAgICAgICAgICByZXR1cm4gYTtcbiAgICAgICAgICAgIH0sXG4gICAgICAgICAgICByZXR1cm5Qcm9wZXJ0eTogJ21vdmVtZW50U3BlZWRQY3RSZWR1Y3Rpb24nXG4gICAgICAgIH1cbiAgICBdLFxuICAgICd0cm9sbF93YXJsb3JkX2ZlcnZvcic6IFtcbiAgICAgICAge1xuICAgICAgICAgICAgbGFiZWw6ICdTdGFja3MnLFxuICAgICAgICAgICAgY29udHJvbFR5cGU6ICdpbnB1dCdcbiAgICAgICAgfSxcbiAgICAgICAge1xuICAgICAgICAgICAgYXR0cmlidXRlTmFtZTogJ2F0dGFja19zcGVlZCcsXG4gICAgICAgICAgICBsYWJlbDogJ0FUVEFDSyBTUEVFRDonLFxuICAgICAgICAgICAgaWdub3JlVG9vbHRpcDogdHJ1ZSxcbiAgICAgICAgICAgIGNvbnRyb2xUeXBlOiAndGV4dCcsXG4gICAgICAgICAgICBmbjogZnVuY3Rpb24gKHYsIGEsIHBhcmVudCwgaW5kZXgsIGFiaWxpdHlNb2RlbCwgYWJpbGl0eSkge1xuICAgICAgICAgICAgICAgIHJldHVybiB2KmE7XG4gICAgICAgICAgICB9LFxuICAgICAgICAgICAgcmV0dXJuUHJvcGVydHk6ICdhdHRhY2tzcGVlZCdcbiAgICAgICAgfVxuICAgIF0sXG4gICAgJ3VuZHlpbmdfZGVjYXknOiBbXG4gICAgICAgIHtcbiAgICAgICAgICAgIGxhYmVsOiAnU3RhY2tzJyxcbiAgICAgICAgICAgIGNvbnRyb2xUeXBlOiAnaW5wdXQnXG4gICAgICAgIH0sXG4gICAgICAgIHtcbiAgICAgICAgICAgIGF0dHJpYnV0ZU5hbWU6ICdzdHJfc3RlYWwnLFxuICAgICAgICAgICAgbGFiZWw6ICdTVFJFTkdUSCBTVE9MRU46JyxcbiAgICAgICAgICAgIGlnbm9yZVRvb2x0aXA6IHRydWUsXG4gICAgICAgICAgICBjb250cm9sVHlwZTogJ3RleHQnLFxuICAgICAgICAgICAgZm46IGZ1bmN0aW9uICh2LCBhLCBwYXJlbnQsIGluZGV4LCBhYmlsaXR5TW9kZWwsIGFiaWxpdHkpIHtcbiAgICAgICAgICAgICAgICBpZiAocGFyZW50LmludmVudG9yeS5oYXNTY2VwdGVyKCkpIHtcbiAgICAgICAgICAgICAgICAgICAgdmFyIHN0cl9zdGVhbF9zY2VwdGVyID0gYWJpbGl0eU1vZGVsLmdldEFiaWxpdHlBdHRyaWJ1dGVWYWx1ZShhYmlsaXR5LmF0dHJpYnV0ZXMsICdzdHJfc3RlYWxfc2NlcHRlcicsMCk7XG4gICAgICAgICAgICAgICAgICAgIHJldHVybiB2KnN0cl9zdGVhbF9zY2VwdGVyO1xuICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgICBlbHNlIHtcbiAgICAgICAgICAgICAgICAgICAgcmV0dXJuIHYqYTtcbiAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICB9LFxuICAgICAgICAgICAgcmV0dXJuUHJvcGVydHk6ICdib251c1N0cmVuZ3RoJ1xuICAgICAgICB9LFxuICAgIF0sXG4gICAgJ3VuZHlpbmdfc291bF9yaXAnOiBbXG4gICAgICAgIHtcbiAgICAgICAgICAgIGxhYmVsOiAnVW5pdHMnLFxuICAgICAgICAgICAgY29udHJvbFR5cGU6ICdpbnB1dCdcbiAgICAgICAgfSxcbiAgICAgICAge1xuICAgICAgICAgICAgYXR0cmlidXRlTmFtZTogJ2RhbWFnZV9wZXJfdW5pdCcsXG4gICAgICAgICAgICBsYWJlbDogJ0RBTUFHRS9IRUFMOicsXG4gICAgICAgICAgICBpZ25vcmVUb29sdGlwOiB0cnVlLFxuICAgICAgICAgICAgY29udHJvbFR5cGU6ICd0ZXh0JyxcbiAgICAgICAgICAgIGZuOiBmdW5jdGlvbiAodiwgYSwgcGFyZW50LCBpbmRleCwgYWJpbGl0eU1vZGVsLCBhYmlsaXR5KSB7XG4gICAgICAgICAgICAgICAgcmV0dXJuIHYqYTtcbiAgICAgICAgICAgIH1cbiAgICAgICAgfVxuICAgIF0sXG4gICAgJ3VuZHlpbmdfZmxlc2hfZ29sZW0nOiBbXG4gICAgICAgIHtcbiAgICAgICAgICAgIGxhYmVsOiAnRGlzdGFuY2UnLFxuICAgICAgICAgICAgY29udHJvbFR5cGU6ICdpbnB1dCdcbiAgICAgICAgfSxcbiAgICAgICAge1xuICAgICAgICAgICAgYXR0cmlidXRlTmFtZTogJ21heF9zcGVlZF9zbG93JyxcbiAgICAgICAgICAgIGxhYmVsOiAnJU1PVkUgU0xPVzonLFxuICAgICAgICAgICAgaWdub3JlVG9vbHRpcDogdHJ1ZSxcbiAgICAgICAgICAgIGNvbnRyb2xUeXBlOiAndGV4dCcsXG4gICAgICAgICAgICBmbjogZnVuY3Rpb24gKHYsIGEsIHBhcmVudCwgaW5kZXgsIGFiaWxpdHlNb2RlbCwgYWJpbGl0eSkge1xuICAgICAgICAgICAgICAgIHZhciBtaW5fc3BlZWRfc2xvdyA9IGFiaWxpdHlNb2RlbC5nZXRBYmlsaXR5QXR0cmlidXRlVmFsdWUoYWJpbGl0eS5hdHRyaWJ1dGVzLCAnbWluX3NwZWVkX3Nsb3cnLCAwKTtcbiAgICAgICAgICAgICAgICB2YXIgcmFkaXVzID0gYWJpbGl0eU1vZGVsLmdldEFiaWxpdHlBdHRyaWJ1dGVWYWx1ZShhYmlsaXR5LmF0dHJpYnV0ZXMsICdyYWRpdXMnLCAwKTtcbiAgICAgICAgICAgICAgICB2YXIgZnVsbF9wb3dlcl9yYWRpdXMgPSBhYmlsaXR5TW9kZWwuZ2V0QWJpbGl0eUF0dHJpYnV0ZVZhbHVlKGFiaWxpdHkuYXR0cmlidXRlcywgJ2Z1bGxfcG93ZXJfcmFkaXVzJywgMCk7XG4gICAgICAgICAgICAgICAgdmFyIGRpc3RhbmNlID0gTWF0aC5taW4oTWF0aC5tYXgodiwgZnVsbF9wb3dlcl9yYWRpdXMpLCByYWRpdXMpO1xuICAgICAgICAgICAgICAgIHZhciBzY2FsZSA9IDEgLSAoZGlzdGFuY2UgLSBmdWxsX3Bvd2VyX3JhZGl1cykgLyAocmFkaXVzIC0gZnVsbF9wb3dlcl9yYWRpdXMpO1xuICAgICAgICAgICAgICAgIHJldHVybiAtTWF0aC5tYXgoc2NhbGUgKiBhLCBtaW5fc3BlZWRfc2xvdyk7XG4gICAgICAgICAgICB9LFxuICAgICAgICAgICAgcmV0dXJuUHJvcGVydHk6ICdtb3ZlbWVudFNwZWVkUGN0UmVkdWN0aW9uJ1xuICAgICAgICB9LFxuICAgICAgICB7XG4gICAgICAgICAgICBhdHRyaWJ1dGVOYW1lOiAnbWF4X2RhbWFnZV9hbXAnLFxuICAgICAgICAgICAgbGFiZWw6ICclREFNQUdFIEFNUDonLFxuICAgICAgICAgICAgaWdub3JlVG9vbHRpcDogdHJ1ZSxcbiAgICAgICAgICAgIGNvbnRyb2xUeXBlOiAndGV4dCcsXG4gICAgICAgICAgICBmbjogZnVuY3Rpb24gKHYsIGEsIHBhcmVudCwgaW5kZXgsIGFiaWxpdHlNb2RlbCwgYWJpbGl0eSkge1xuICAgICAgICAgICAgICAgIHZhciBtaW5fZGFtYWdlX2FtcCA9IGFiaWxpdHlNb2RlbC5nZXRBYmlsaXR5QXR0cmlidXRlVmFsdWUoYWJpbGl0eS5hdHRyaWJ1dGVzLCAnbWluX2RhbWFnZV9hbXAnLCAwKTtcbiAgICAgICAgICAgICAgICB2YXIgcmFkaXVzID0gYWJpbGl0eU1vZGVsLmdldEFiaWxpdHlBdHRyaWJ1dGVWYWx1ZShhYmlsaXR5LmF0dHJpYnV0ZXMsICdyYWRpdXMnLCAwKTtcbiAgICAgICAgICAgICAgICB2YXIgZnVsbF9wb3dlcl9yYWRpdXMgPSBhYmlsaXR5TW9kZWwuZ2V0QWJpbGl0eUF0dHJpYnV0ZVZhbHVlKGFiaWxpdHkuYXR0cmlidXRlcywgJ2Z1bGxfcG93ZXJfcmFkaXVzJywgMCk7XG4gICAgICAgICAgICAgICAgdmFyIGRpc3RhbmNlID0gTWF0aC5taW4oTWF0aC5tYXgodiwgZnVsbF9wb3dlcl9yYWRpdXMpLCByYWRpdXMpO1xuICAgICAgICAgICAgICAgIHZhciBzY2FsZSA9IDEgLSAoZGlzdGFuY2UgLSBmdWxsX3Bvd2VyX3JhZGl1cykgLyAocmFkaXVzIC0gZnVsbF9wb3dlcl9yYWRpdXMpO1xuICAgICAgICAgICAgICAgIHJldHVybiBNYXRoLm1heChzY2FsZSAqIGEsIG1pbl9kYW1hZ2VfYW1wKTtcbiAgICAgICAgICAgIH0sXG4gICAgICAgICAgICByZXR1cm5Qcm9wZXJ0eTogJ2RhbWFnZUFtcGxpZmljYXRpb24nXG4gICAgICAgIH0sXG4gICAgICAgIHtcbiAgICAgICAgICAgIGxhYmVsOiAnTUFYIEhQJyxcbiAgICAgICAgICAgIGNvbnRyb2xUeXBlOiAnaW5wdXQnXG4gICAgICAgIH0sXG4gICAgICAgIHtcbiAgICAgICAgICAgIGxhYmVsOiAnSGVybyBEZWF0aCBDb3VudCcsXG4gICAgICAgICAgICBjb250cm9sVHlwZTogJ2lucHV0J1xuICAgICAgICB9LFxuICAgICAgICB7XG4gICAgICAgICAgICBsYWJlbDogJ0NyZWVwIERlYXRoIENvdW50JyxcbiAgICAgICAgICAgIGNvbnRyb2xUeXBlOiAnaW5wdXQnXG4gICAgICAgIH0sXG4gICAgICAgIHtcbiAgICAgICAgICAgIGF0dHJpYnV0ZU5hbWU6ICdkZWF0aF9oZWFsJyxcbiAgICAgICAgICAgIGxhYmVsOiAnREVBVEggSEVBTCAoSEVST0VTKTonLFxuICAgICAgICAgICAgaWdub3JlVG9vbHRpcDogdHJ1ZSxcbiAgICAgICAgICAgIGNvbnRyb2xUeXBlOiAnbWV0aG9kJyxcbiAgICAgICAgICAgIGNvbnRyb2xzOiBbMSwgMl0sXG4gICAgICAgICAgICBmbjogZnVuY3Rpb24gKHYsIGEsIHBhcmVudCwgaW5kZXgsIGFiaWxpdHlNb2RlbCwgYWJpbGl0eSkge1xuICAgICAgICAgICAgICAgIHJldHVybiB2WzBdKnZbMV0qYS8xMDA7XG4gICAgICAgICAgICB9XG4gICAgICAgIH0sXG4gICAgICAgIHtcbiAgICAgICAgICAgIGF0dHJpYnV0ZU5hbWU6ICdkZWF0aF9oZWFsX2NyZWVwJyxcbiAgICAgICAgICAgIGxhYmVsOiAnREVBVEggSEVBTCAoQ1JFRVBTKTonLFxuICAgICAgICAgICAgaWdub3JlVG9vbHRpcDogdHJ1ZSxcbiAgICAgICAgICAgIGNvbnRyb2xUeXBlOiAnbWV0aG9kJyxcbiAgICAgICAgICAgIGNvbnRyb2xzOiBbMSwgM10sXG4gICAgICAgICAgICBmbjogZnVuY3Rpb24gKHYsIGEsIHBhcmVudCwgaW5kZXgsIGFiaWxpdHlNb2RlbCwgYWJpbGl0eSkge1xuICAgICAgICAgICAgICAgIHJldHVybiB2WzBdKnZbMV0qYS8xMDA7XG4gICAgICAgICAgICB9XG4gICAgICAgIH0sXG4gICAgICAgIHtcbiAgICAgICAgICAgIGF0dHJpYnV0ZU5hbWU6ICdkZWF0aF9oZWFsX2NyZWVwJyxcbiAgICAgICAgICAgIGxhYmVsOiAnVE9UQUwgREVBVEggSEVBTDonLFxuICAgICAgICAgICAgaWdub3JlVG9vbHRpcDogdHJ1ZSxcbiAgICAgICAgICAgIGNvbnRyb2xUeXBlOiAndGV4dCcsXG4gICAgICAgICAgICBjb250cm9sczogWzQsIDVdLFxuICAgICAgICAgICAgZm46IGZ1bmN0aW9uICh2LCBhLCBwYXJlbnQsIGluZGV4LCBhYmlsaXR5TW9kZWwsIGFiaWxpdHkpIHtcbiAgICAgICAgICAgICAgICByZXR1cm4gdlswXSt2WzFdO1xuICAgICAgICAgICAgfVxuICAgICAgICB9XG4gICAgXSxcbiAgICAndXJzYV9mdXJ5X3N3aXBlcyc6IFtcbiAgICAgICAge1xuICAgICAgICAgICAgbGFiZWw6ICdTdGFja3MnLFxuICAgICAgICAgICAgY29udHJvbFR5cGU6ICdpbnB1dCdcbiAgICAgICAgfSxcbiAgICAgICAge1xuICAgICAgICAgICAgYXR0cmlidXRlTmFtZTogJ2RhbWFnZV9wZXJfc3RhY2snLFxuICAgICAgICAgICAgbGFiZWw6ICdUb3RhbCBEYW1hZ2UnLFxuICAgICAgICAgICAgY29udHJvbFR5cGU6ICd0ZXh0JyxcbiAgICAgICAgICAgIGZuOiBmdW5jdGlvbiAodiwgYSwgcGFyZW50LCBpbmRleCwgYWJpbGl0eU1vZGVsLCBhYmlsaXR5KSB7XG4gICAgICAgICAgICAgICAgdmFyIGVucmFnZUFiaWxpdHkgPSBhYmlsaXR5TW9kZWwuYWJpbGl0aWVzKCkuZmluZChmdW5jdGlvbihiKSB7XG4gICAgICAgICAgICAgICAgICAgIHJldHVybiBiLm5hbWUgPT0gJ3Vyc2FfZW5yYWdlJztcbiAgICAgICAgICAgICAgICB9KTtcbiAgICAgICAgICAgICAgICBpZiAoZW5yYWdlQWJpbGl0eS5pc0FjdGl2ZSgpICYmIGVucmFnZUFiaWxpdHkubGV2ZWwoKSA+IDApIHtcbiAgICAgICAgICAgICAgICAgICAgdmFyIGVucmFnZV9tdWx0aXBsaWVyID0gYWJpbGl0eU1vZGVsLmdldEFiaWxpdHlBdHRyaWJ1dGVWYWx1ZShlbnJhZ2VBYmlsaXR5LmF0dHJpYnV0ZXMsICdlbnJhZ2VfbXVsdGlwbGllcicsIGVucmFnZUFiaWxpdHkubGV2ZWwoKSk7XG4gICAgICAgICAgICAgICAgICAgIHJldHVybiB2KmEqZW5yYWdlX211bHRpcGxpZXI7XG4gICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICAgIHJldHVybiB2KmE7XG4gICAgICAgICAgICB9LFxuICAgICAgICAgICAgcmV0dXJuUHJvcGVydHk6ICdib251c0RhbWFnZSdcbiAgICAgICAgfVxuICAgIF0sXG4gICAgJ3Vyc2FfZW5yYWdlJzogW1xuICAgICAgICB7XG4gICAgICAgICAgICBhdHRyaWJ1dGVOYW1lOiAnZGFtYWdlX3JlZHVjdGlvbicsXG4gICAgICAgICAgICBsYWJlbDogJ1RvdGFsIERhbWFnZScsXG4gICAgICAgICAgICBjb250cm9sVHlwZTogJ3RleHQnLFxuICAgICAgICAgICAgZm46IGZ1bmN0aW9uICh2LCBhLCBwYXJlbnQsIGluZGV4LCBhYmlsaXR5TW9kZWwsIGFiaWxpdHkpIHtcbiAgICAgICAgICAgICAgICByZXR1cm4gLWE7XG4gICAgICAgICAgICB9LFxuICAgICAgICAgICAgcmV0dXJuUHJvcGVydHk6ICdkYW1hZ2VSZWR1Y3Rpb24nXG4gICAgICAgIH1cbiAgICBdLFxuICAgICd2ZW5vbWFuY2VyX3Zlbm9tb3VzX2dhbGUnOiBbXG4gICAgICAgIHtcbiAgICAgICAgICAgIGxhYmVsOiAnRHVyYXRpb24nLFxuICAgICAgICAgICAgY29udHJvbFR5cGU6ICdpbnB1dCdcbiAgICAgICAgfSxcbiAgICAgICAge1xuICAgICAgICAgICAgYXR0cmlidXRlTmFtZTogJ3RpY2tfZGFtYWdlJyxcbiAgICAgICAgICAgIGxhYmVsOiAnVG90YWwgRGFtYWdlJyxcbiAgICAgICAgICAgIGNvbnRyb2xUeXBlOiAndGV4dCcsXG4gICAgICAgICAgICBmbjogZnVuY3Rpb24gKHYsIGEsIHBhcmVudCwgaW5kZXgsIGFiaWxpdHlNb2RlbCwgYWJpbGl0eSkge1xuICAgICAgICAgICAgICAgIHJldHVybiBhYmlsaXR5TW9kZWwuZ2V0QWJpbGl0eUF0dHJpYnV0ZVZhbHVlKGFiaWxpdHkuYXR0cmlidXRlcywgJ3N0cmlrZV9kYW1hZ2UnLGFiaWxpdHkubGV2ZWwoKSkgKyBNYXRoLmZsb29yKHYvMykqYTtcbiAgICAgICAgICAgIH1cbiAgICAgICAgfSxcbiAgICAgICAge1xuICAgICAgICAgICAgYXR0cmlidXRlTmFtZTogJ21vdmVtZW50X3Nsb3cnLFxuICAgICAgICAgICAgbGFiZWw6ICdUb3RhbCBEYW1hZ2UnLFxuICAgICAgICAgICAgY29udHJvbFR5cGU6ICd0ZXh0JyxcbiAgICAgICAgICAgIGZuOiBmdW5jdGlvbiAodiwgYSwgcGFyZW50LCBpbmRleCwgYWJpbGl0eU1vZGVsLCBhYmlsaXR5KSB7XG4gICAgICAgICAgICAgICAgcmV0dXJuIGE7XG4gICAgICAgICAgICB9LFxuICAgICAgICAgICAgcmV0dXJuUHJvcGVydHk6ICdtb3ZlbWVudFNwZWVkUGN0UmVkdWN0aW9uJ1xuICAgICAgICB9XG4gICAgXSxcbiAgICAndmVub21hbmNlcl9wb2lzb25fc3RpbmcnOiBbXG4gICAgICAgIHtcbiAgICAgICAgICAgIGxhYmVsOiAnRHVyYXRpb24nLFxuICAgICAgICAgICAgY29udHJvbFR5cGU6ICdpbnB1dCdcbiAgICAgICAgfSxcbiAgICAgICAge1xuICAgICAgICAgICAgYXR0cmlidXRlTmFtZTogJ2RhbWFnZScsXG4gICAgICAgICAgICBsYWJlbDogJ1RvdGFsIERhbWFnZScsXG4gICAgICAgICAgICBjb250cm9sVHlwZTogJ3RleHQnLFxuICAgICAgICAgICAgZm46IGZ1bmN0aW9uICh2LCBhLCBwYXJlbnQsIGluZGV4LCBhYmlsaXR5TW9kZWwsIGFiaWxpdHkpIHtcbiAgICAgICAgICAgICAgICByZXR1cm4gdiphO1xuICAgICAgICAgICAgfVxuICAgICAgICB9LFxuICAgICAgICB7XG4gICAgICAgICAgICBhdHRyaWJ1dGVOYW1lOiAnbW92ZW1lbnRfc3BlZWQnLFxuICAgICAgICAgICAgbGFiZWw6ICdUb3RhbCBEYW1hZ2UnLFxuICAgICAgICAgICAgY29udHJvbFR5cGU6ICd0ZXh0JyxcbiAgICAgICAgICAgIGZuOiBmdW5jdGlvbiAodiwgYSwgcGFyZW50LCBpbmRleCwgYWJpbGl0eU1vZGVsLCBhYmlsaXR5KSB7XG4gICAgICAgICAgICAgICAgcmV0dXJuIGE7XG4gICAgICAgICAgICB9LFxuICAgICAgICAgICAgcmV0dXJuUHJvcGVydHk6ICdtb3ZlbWVudFNwZWVkUGN0UmVkdWN0aW9uJ1xuICAgICAgICB9XG4gICAgXSxcbiAgICAndmVub21hbmNlcl9wb2lzb25fbm92YSc6IFtcbiAgICAgICAge1xuICAgICAgICAgICAgbGFiZWw6ICdEdXJhdGlvbicsXG4gICAgICAgICAgICBjb250cm9sVHlwZTogJ2lucHV0J1xuICAgICAgICB9LFxuICAgICAgICB7XG4gICAgICAgICAgICBhdHRyaWJ1dGVOYW1lOiAnZGFtYWdlJyxcbiAgICAgICAgICAgIGxhYmVsOiAnVG90YWwgRGFtYWdlJyxcbiAgICAgICAgICAgIGNvbnRyb2xUeXBlOiAndGV4dCcsXG4gICAgICAgICAgICBmbjogZnVuY3Rpb24gKHYsIGEsIHBhcmVudCwgaW5kZXgsIGFiaWxpdHlNb2RlbCwgYWJpbGl0eSkge1xuICAgICAgICAgICAgICAgIHJldHVybiB2KmE7XG4gICAgICAgICAgICB9XG4gICAgICAgIH1cbiAgICBdLFxuICAgICd2aXBlcl9wb2lzb25fYXR0YWNrJzogW1xuICAgICAgICB7XG4gICAgICAgICAgICBsYWJlbDogJ0R1cmF0aW9uJyxcbiAgICAgICAgICAgIGNvbnRyb2xUeXBlOiAnaW5wdXQnXG4gICAgICAgIH0sXG4gICAgICAgIHtcbiAgICAgICAgICAgIGF0dHJpYnV0ZU5hbWU6ICdkYW1hZ2UnLFxuICAgICAgICAgICAgbGFiZWw6ICdUb3RhbCBEYW1hZ2UnLFxuICAgICAgICAgICAgY29udHJvbFR5cGU6ICd0ZXh0JyxcbiAgICAgICAgICAgIGZuOiBmdW5jdGlvbiAodiwgYSwgcGFyZW50LCBpbmRleCwgYWJpbGl0eU1vZGVsLCBhYmlsaXR5KSB7XG4gICAgICAgICAgICAgICAgcmV0dXJuIHYqYTtcbiAgICAgICAgICAgIH1cbiAgICAgICAgfSxcbiAgICAgICAge1xuICAgICAgICAgICAgYXR0cmlidXRlTmFtZTogJ2JvbnVzX21vdmVtZW50X3NwZWVkJyxcbiAgICAgICAgICAgIGxhYmVsOiAnVG90YWwgRGFtYWdlJyxcbiAgICAgICAgICAgIGNvbnRyb2xUeXBlOiAndGV4dCcsXG4gICAgICAgICAgICBmbjogZnVuY3Rpb24gKHYsIGEsIHBhcmVudCwgaW5kZXgsIGFiaWxpdHlNb2RlbCwgYWJpbGl0eSkge1xuICAgICAgICAgICAgICAgIHJldHVybiBhO1xuICAgICAgICAgICAgfSxcbiAgICAgICAgICAgIHJldHVyblByb3BlcnR5OiAnbW92ZW1lbnRTcGVlZFBjdFJlZHVjdGlvbidcbiAgICAgICAgfSxcbiAgICAgICAge1xuICAgICAgICAgICAgYXR0cmlidXRlTmFtZTogJ2JvbnVzX2F0dGFja19zcGVlZCcsXG4gICAgICAgICAgICBsYWJlbDogJ1RvdGFsIERhbWFnZScsXG4gICAgICAgICAgICBjb250cm9sVHlwZTogJ3RleHQnLFxuICAgICAgICAgICAgZm46IGZ1bmN0aW9uICh2LCBhLCBwYXJlbnQsIGluZGV4LCBhYmlsaXR5TW9kZWwsIGFiaWxpdHkpIHtcbiAgICAgICAgICAgICAgICByZXR1cm4gYTtcbiAgICAgICAgICAgIH0sXG4gICAgICAgICAgICByZXR1cm5Qcm9wZXJ0eTogJ2F0dGFja3NwZWVkcmVkdWN0aW9uJ1xuICAgICAgICB9XG4gICAgXSxcbiAgICAndmlwZXJfY29ycm9zaXZlX3NraW4nOiBbXG4gICAgICAgIHtcbiAgICAgICAgICAgIGxhYmVsOiAnRHVyYXRpb24nLFxuICAgICAgICAgICAgY29udHJvbFR5cGU6ICdpbnB1dCdcbiAgICAgICAgfSxcbiAgICAgICAge1xuICAgICAgICAgICAgYXR0cmlidXRlTmFtZTogJ2RhbWFnZScsXG4gICAgICAgICAgICBsYWJlbDogJ1RvdGFsIERhbWFnZScsXG4gICAgICAgICAgICBjb250cm9sVHlwZTogJ3RleHQnLFxuICAgICAgICAgICAgZm46IGZ1bmN0aW9uICh2LCBhLCBwYXJlbnQsIGluZGV4LCBhYmlsaXR5TW9kZWwsIGFiaWxpdHkpIHtcbiAgICAgICAgICAgICAgICByZXR1cm4gdiphO1xuICAgICAgICAgICAgfVxuICAgICAgICB9LFxuICAgICAgICB7XG4gICAgICAgICAgICBhdHRyaWJ1dGVOYW1lOiAnYm9udXNfbW92ZW1lbnRfc3BlZWQnLFxuICAgICAgICAgICAgbGFiZWw6ICdUb3RhbCBEYW1hZ2UnLFxuICAgICAgICAgICAgY29udHJvbFR5cGU6ICd0ZXh0JyxcbiAgICAgICAgICAgIGZuOiBmdW5jdGlvbiAodiwgYSwgcGFyZW50LCBpbmRleCwgYWJpbGl0eU1vZGVsLCBhYmlsaXR5KSB7XG4gICAgICAgICAgICAgICAgcmV0dXJuIGE7XG4gICAgICAgICAgICB9LFxuICAgICAgICAgICAgcmV0dXJuUHJvcGVydHk6ICdtb3ZlbWVudFNwZWVkUGN0UmVkdWN0aW9uJ1xuICAgICAgICB9LFxuICAgICAgICB7XG4gICAgICAgICAgICBhdHRyaWJ1dGVOYW1lOiAnYm9udXNfYXR0YWNrX3NwZWVkJyxcbiAgICAgICAgICAgIGxhYmVsOiAnVG90YWwgRGFtYWdlJyxcbiAgICAgICAgICAgIGNvbnRyb2xUeXBlOiAndGV4dCcsXG4gICAgICAgICAgICBmbjogZnVuY3Rpb24gKHYsIGEsIHBhcmVudCwgaW5kZXgsIGFiaWxpdHlNb2RlbCwgYWJpbGl0eSkge1xuICAgICAgICAgICAgICAgIHJldHVybiBhO1xuICAgICAgICAgICAgfSxcbiAgICAgICAgICAgIHJldHVyblByb3BlcnR5OiAnYXR0YWNrc3BlZWRyZWR1Y3Rpb24nXG4gICAgICAgIH0sXG4gICAgICAgIHtcbiAgICAgICAgICAgIGF0dHJpYnV0ZU5hbWU6ICdib251c19tYWdpY19yZXNpc3RhbmNlJyxcbiAgICAgICAgICAgIGxhYmVsOiAnVG90YWwgRGFtYWdlJyxcbiAgICAgICAgICAgIGNvbnRyb2xUeXBlOiAndGV4dCcsXG4gICAgICAgICAgICBmbjogZnVuY3Rpb24gKHYsIGEsIHBhcmVudCwgaW5kZXgsIGFiaWxpdHlNb2RlbCwgYWJpbGl0eSkge1xuICAgICAgICAgICAgICAgIHJldHVybiBhO1xuICAgICAgICAgICAgfSxcbiAgICAgICAgICAgIHJldHVyblByb3BlcnR5OiAnbWFnaWNSZXNpc3QnXG4gICAgICAgIH1cbiAgICBdLFxuICAgICd2aXBlcl92aXBlcl9zdHJpa2UnOiBbXG4gICAgICAgIHtcbiAgICAgICAgICAgIGxhYmVsOiAnRHVyYXRpb24nLFxuICAgICAgICAgICAgY29udHJvbFR5cGU6ICdpbnB1dCdcbiAgICAgICAgfSxcbiAgICAgICAge1xuICAgICAgICAgICAgYXR0cmlidXRlTmFtZTogJ2RhbWFnZScsXG4gICAgICAgICAgICBsYWJlbDogJ1RvdGFsIERhbWFnZScsXG4gICAgICAgICAgICBjb250cm9sVHlwZTogJ3RleHQnLFxuICAgICAgICAgICAgZm46IGZ1bmN0aW9uICh2LCBhLCBwYXJlbnQsIGluZGV4LCBhYmlsaXR5TW9kZWwsIGFiaWxpdHkpIHtcbiAgICAgICAgICAgICAgICByZXR1cm4gdiphO1xuICAgICAgICAgICAgfVxuICAgICAgICB9LFxuICAgICAgICB7XG4gICAgICAgICAgICBhdHRyaWJ1dGVOYW1lOiAnYm9udXNfbW92ZW1lbnRfc3BlZWQnLFxuICAgICAgICAgICAgbGFiZWw6ICdUb3RhbCBEYW1hZ2UnLFxuICAgICAgICAgICAgY29udHJvbFR5cGU6ICd0ZXh0JyxcbiAgICAgICAgICAgIGZuOiBmdW5jdGlvbiAodiwgYSwgcGFyZW50LCBpbmRleCwgYWJpbGl0eU1vZGVsLCBhYmlsaXR5KSB7XG4gICAgICAgICAgICAgICAgcmV0dXJuIGE7XG4gICAgICAgICAgICB9LFxuICAgICAgICAgICAgcmV0dXJuUHJvcGVydHk6ICdtb3ZlbWVudFNwZWVkUGN0UmVkdWN0aW9uJ1xuICAgICAgICB9LFxuICAgICAgICB7XG4gICAgICAgICAgICBhdHRyaWJ1dGVOYW1lOiAnYm9udXNfYXR0YWNrX3NwZWVkJyxcbiAgICAgICAgICAgIGxhYmVsOiAnVG90YWwgRGFtYWdlJyxcbiAgICAgICAgICAgIGNvbnRyb2xUeXBlOiAndGV4dCcsXG4gICAgICAgICAgICBmbjogZnVuY3Rpb24gKHYsIGEsIHBhcmVudCwgaW5kZXgsIGFiaWxpdHlNb2RlbCwgYWJpbGl0eSkge1xuICAgICAgICAgICAgICAgIHJldHVybiBhO1xuICAgICAgICAgICAgfSxcbiAgICAgICAgICAgIHJldHVyblByb3BlcnR5OiAnYXR0YWNrc3BlZWRyZWR1Y3Rpb24nXG4gICAgICAgIH1cbiAgICBdLFxuICAgICd2aXNhZ2Vfc291bF9hc3N1bXB0aW9uJzogW1xuICAgICAgICB7XG4gICAgICAgICAgICBsYWJlbDogJ0NoYXJnZXMnLFxuICAgICAgICAgICAgY29udHJvbFR5cGU6ICdpbnB1dCdcbiAgICAgICAgfSxcbiAgICAgICAge1xuICAgICAgICAgICAgYXR0cmlidXRlTmFtZTogJ3NvdWxfY2hhcmdlX2RhbWFnZScsXG4gICAgICAgICAgICBsYWJlbDogJ1RvdGFsIERhbWFnZTonLFxuICAgICAgICAgICAgaWdub3JlVG9vbHRpcDogdHJ1ZSxcbiAgICAgICAgICAgIGNvbnRyb2xUeXBlOiAndGV4dCcsXG4gICAgICAgICAgICBmbjogZnVuY3Rpb24gKHYsIGEsIHBhcmVudCwgaW5kZXgsIGFiaWxpdHlNb2RlbCwgYWJpbGl0eSkge1xuICAgICAgICAgICAgICAgIHZhciBzb3VsX2Jhc2VfZGFtYWdlID0gYWJpbGl0eU1vZGVsLmdldEFiaWxpdHlBdHRyaWJ1dGVWYWx1ZShhYmlsaXR5LmF0dHJpYnV0ZXMsICdzb3VsX2Jhc2VfZGFtYWdlJywwKTtcbiAgICAgICAgICAgICAgICB2YXIgc3RhY2tfbGltaXQgPSBhYmlsaXR5TW9kZWwuZ2V0QWJpbGl0eUF0dHJpYnV0ZVZhbHVlKGFiaWxpdHkuYXR0cmlidXRlcywgJ3N0YWNrX2xpbWl0JywgYWJpbGl0eS5sZXZlbCgpKTtcbiAgICAgICAgICAgICAgICBzdGFja19saW1pdCA9IE1hdGgubWF4KE1hdGgubWluKHYsIHN0YWNrX2xpbWl0KSwgMCk7XG4gICAgICAgICAgICAgICAgcmV0dXJuIHNvdWxfYmFzZV9kYW1hZ2UgKyBzdGFja19saW1pdCphO1xuICAgICAgICAgICAgfVxuICAgICAgICB9XG4gICAgXSxcbiAgICAndmlzYWdlX2dyYXZla2VlcGVyc19jbG9hayc6IFtcbiAgICAgICAge1xuICAgICAgICAgICAgbGFiZWw6ICdMYXllcnMnLFxuICAgICAgICAgICAgY29udHJvbFR5cGU6ICdpbnB1dCdcbiAgICAgICAgfSxcbiAgICAgICAge1xuICAgICAgICAgICAgYXR0cmlidXRlTmFtZTogJ2JvbnVzX2FybW9yJyxcbiAgICAgICAgICAgIGxhYmVsOiAnQVJNT1I6JyxcbiAgICAgICAgICAgIGlnbm9yZVRvb2x0aXA6IHRydWUsXG4gICAgICAgICAgICBjb250cm9sVHlwZTogJ3RleHQnLFxuICAgICAgICAgICAgZm46IGZ1bmN0aW9uICh2LCBhLCBwYXJlbnQsIGluZGV4LCBhYmlsaXR5TW9kZWwsIGFiaWxpdHkpIHtcbiAgICAgICAgICAgICAgICByZXR1cm4gdiphO1xuICAgICAgICAgICAgfSxcbiAgICAgICAgICAgIHJldHVyblByb3BlcnR5OiAnYXJtb3InXG4gICAgICAgIH0sXG4gICAgICAgIHtcbiAgICAgICAgICAgIGF0dHJpYnV0ZU5hbWU6ICdib251c19yZXNpc3QnLFxuICAgICAgICAgICAgbGFiZWw6ICclUkVTSVNUOicsXG4gICAgICAgICAgICBpZ25vcmVUb29sdGlwOiB0cnVlLFxuICAgICAgICAgICAgY29udHJvbFR5cGU6ICd0ZXh0JyxcbiAgICAgICAgICAgIGZuOiBmdW5jdGlvbiAodiwgYSwgcGFyZW50LCBpbmRleCwgYWJpbGl0eU1vZGVsLCBhYmlsaXR5KSB7XG4gICAgICAgICAgICAgICAgcmV0dXJuIHYqYTtcbiAgICAgICAgICAgIH0sXG4gICAgICAgICAgICByZXR1cm5Qcm9wZXJ0eTogJ21hZ2ljUmVzaXN0J1xuICAgICAgICB9XG4gICAgXSxcbiAgICAnd2FybG9ja19zaGFkb3dfd29yZCc6IFtcbiAgICAgICAge1xuICAgICAgICAgICAgbGFiZWw6ICdEdXJhdGlvbicsXG4gICAgICAgICAgICBjb250cm9sVHlwZTogJ2lucHV0J1xuICAgICAgICB9LFxuICAgICAgICB7XG4gICAgICAgICAgICBsYWJlbDogJ0RBTUFHRTonLFxuICAgICAgICAgICAgaWdub3JlVG9vbHRpcDogdHJ1ZSxcbiAgICAgICAgICAgIGNvbnRyb2xUeXBlOiAndGV4dCcsXG4gICAgICAgICAgICBmbjogZnVuY3Rpb24gKHYsIGEsIHBhcmVudCwgaW5kZXgsIGFiaWxpdHlNb2RlbCwgYWJpbGl0eSkge1xuICAgICAgICAgICAgICAgIHJldHVybiBhYmlsaXR5TW9kZWwuZ2V0QWJpbGl0eVByb3BlcnR5VmFsdWUoYWJpbGl0eSwgJ2RhbWFnZScpKnY7XG4gICAgICAgICAgICB9XG4gICAgICAgIH1cbiAgICBdLFxuICAgICd3YXJsb2NrX3VwaGVhdmFsJzogW1xuICAgICAgICB7XG4gICAgICAgICAgICBsYWJlbDogJ0NoYW5uZWwgRHVyYXRpb24nLFxuICAgICAgICAgICAgY29udHJvbFR5cGU6ICdpbnB1dCdcbiAgICAgICAgfSxcbiAgICAgICAge1xuICAgICAgICAgICAgYXR0cmlidXRlTmFtZTogJ3Nsb3dfcmF0ZV9kdXJhdGlvbicsXG4gICAgICAgICAgICBsYWJlbDogJyVNT1ZFIFNMT1c6JyxcbiAgICAgICAgICAgIGlnbm9yZVRvb2x0aXA6IHRydWUsXG4gICAgICAgICAgICBjb250cm9sVHlwZTogJ3RleHQnLFxuICAgICAgICAgICAgZm46IGZ1bmN0aW9uICh2LCBhLCBwYXJlbnQsIGluZGV4LCBhYmlsaXR5TW9kZWwsIGFiaWxpdHkpIHtcbiAgICAgICAgICAgICAgICB2YXIgbWF4X3Nsb3cgPSBhYmlsaXR5TW9kZWwuZ2V0QWJpbGl0eUF0dHJpYnV0ZVZhbHVlKGFiaWxpdHkuYXR0cmlidXRlcywgJ21heF9zbG93JywwKTtcbiAgICAgICAgICAgICAgICB2YXIgc2xvd19wZXJfdGljayA9IG1heF9zbG93IC8gKGEgLSAwLjUpIC8gMjtcbiAgICAgICAgICAgICAgICB2YXIgdGlja3MgPSBNYXRoLm1heChNYXRoLmZsb29yKHYgKiAyKSAtIDEsIDApO1xuICAgICAgICAgICAgICAgIHJldHVybiAtTWF0aC5taW4odGlja3MgKiBzbG93X3Blcl90aWNrLCBtYXhfc2xvdyk7XG4gICAgICAgICAgICB9LFxuICAgICAgICAgICAgcmV0dXJuUHJvcGVydHk6ICdtb3ZlbWVudFNwZWVkUGN0UmVkdWN0aW9uJ1xuICAgICAgICB9XG4gICAgXSxcbiAgICAnd2VhdmVyX3RoZV9zd2FybSc6IFtcbiAgICAgICAge1xuICAgICAgICAgICAgbGFiZWw6ICdBdHRhY2tzJyxcbiAgICAgICAgICAgIGNvbnRyb2xUeXBlOiAnaW5wdXQnXG4gICAgICAgIH0sXG4gICAgICAgIHtcbiAgICAgICAgICAgIGF0dHJpYnV0ZU5hbWU6ICdkYW1hZ2UnLFxuICAgICAgICAgICAgbGFiZWw6ICdEQU1BR0U6JyxcbiAgICAgICAgICAgIGNvbnRyb2xUeXBlOiAndGV4dCcsXG4gICAgICAgICAgICBmbjogZnVuY3Rpb24gKHYsIGEsIHBhcmVudCwgaW5kZXgsIGFiaWxpdHlNb2RlbCwgYWJpbGl0eSkge1xuICAgICAgICAgICAgICAgIHJldHVybiB2KmE7XG4gICAgICAgICAgICB9XG4gICAgICAgIH0sXG4gICAgICAgIHtcbiAgICAgICAgICAgIGF0dHJpYnV0ZU5hbWU6ICdhcm1vcl9yZWR1Y3Rpb24nLFxuICAgICAgICAgICAgbGFiZWw6ICdEQU1BR0U6JyxcbiAgICAgICAgICAgIGNvbnRyb2xUeXBlOiAndGV4dCcsXG4gICAgICAgICAgICBmbjogZnVuY3Rpb24gKHYsIGEsIHBhcmVudCwgaW5kZXgsIGFiaWxpdHlNb2RlbCwgYWJpbGl0eSkge1xuICAgICAgICAgICAgICAgIHJldHVybiAtdiphO1xuICAgICAgICAgICAgfSxcbiAgICAgICAgICAgIHJldHVyblByb3BlcnR5OiAnYXJtb3JSZWR1Y3Rpb24nXG4gICAgICAgIH1cbiAgICBdLFxuICAgICd3aW5kcnVubmVyX3Bvd2Vyc2hvdCc6IFtcbiAgICAgICAge1xuICAgICAgICAgICAgbGFiZWw6ICdEdXJhdGlvbicsXG4gICAgICAgICAgICBjb250cm9sVHlwZTogJ2lucHV0J1xuICAgICAgICB9LFxuICAgICAgICB7XG4gICAgICAgICAgICBsYWJlbDogJ0RBTUFHRTonLFxuICAgICAgICAgICAgaWdub3JlVG9vbHRpcDogdHJ1ZSxcbiAgICAgICAgICAgIGNvbnRyb2xUeXBlOiAndGV4dCcsXG4gICAgICAgICAgICBmbjogZnVuY3Rpb24gKHYsIGEsIHBhcmVudCwgaW5kZXgsIGFiaWxpdHlNb2RlbCwgYWJpbGl0eSkge1xuICAgICAgICAgICAgICAgIHJldHVybiBhYmlsaXR5TW9kZWwuZ2V0QWJpbGl0eVByb3BlcnR5VmFsdWUoYWJpbGl0eSwgJ2RhbWFnZScpKnY7XG4gICAgICAgICAgICB9XG4gICAgICAgIH1cbiAgICBdLFxuICAgICd3aW50ZXJfd3l2ZXJuX2NvbGRfZW1icmFjZSc6IFtcbiAgICAgICAge1xuICAgICAgICAgICAgbGFiZWw6ICdEdXJhdGlvbicsXG4gICAgICAgICAgICBjb250cm9sVHlwZTogJ2lucHV0J1xuICAgICAgICB9LFxuICAgICAgICB7XG4gICAgICAgICAgICBsYWJlbDogJ0FsbHkgTWF4IEhlYWx0aCcsXG4gICAgICAgICAgICBjb250cm9sVHlwZTogJ2lucHV0J1xuICAgICAgICB9LFxuICAgICAgICB7XG4gICAgICAgICAgICBhdHRyaWJ1dGVOYW1lOiAnaGVhbF9wZXJjZW50YWdlJyxcbiAgICAgICAgICAgIGxhYmVsOiAnVE9UQUwgSEVBTDonLFxuICAgICAgICAgICAgaWdub3JlVG9vbHRpcDogdHJ1ZSxcbiAgICAgICAgICAgIGNvbnRyb2xUeXBlOiAndGV4dCcsXG4gICAgICAgICAgICBjb250cm9sczogWzAsMV0sXG4gICAgICAgICAgICBmbjogZnVuY3Rpb24gKHYsIGEsIHBhcmVudCwgaW5kZXgsIGFiaWxpdHlNb2RlbCwgYWJpbGl0eSkge1xuICAgICAgICAgICAgICAgIHZhciBiYXNlX2hlYWwgPSBhYmlsaXR5TW9kZWwuZ2V0QWJpbGl0eUF0dHJpYnV0ZVZhbHVlKGFiaWxpdHkuYXR0cmlidXRlcywgJ2hlYWxfYWRkaXRpdmUnLGFiaWxpdHkubGV2ZWwoKSk7XG4gICAgICAgICAgICAgICAgcmV0dXJuIChiYXNlX2hlYWwgKyB2WzFdICogYS8xMDApICogdlswXTtcbiAgICAgICAgICAgIH1cbiAgICAgICAgfVxuICAgIF0sXG4gICAgJ3dpc3Bfc3Bpcml0cyc6IFtcbiAgICAgICAge1xuICAgICAgICAgICAgbGFiZWw6ICdDb2xsaXNpb24gQ291bnQnLFxuICAgICAgICAgICAgY29udHJvbFR5cGU6ICdpbnB1dCdcbiAgICAgICAgfSxcbiAgICAgICAge1xuICAgICAgICAgICAgYXR0cmlidXRlTmFtZTogJ2hlcm9fZGFtYWdlJyxcbiAgICAgICAgICAgIGxhYmVsOiAnVG90YWwgRGFtYWdlJyxcbiAgICAgICAgICAgIGNvbnRyb2xUeXBlOiAndGV4dCcsXG4gICAgICAgICAgICBmbjogZnVuY3Rpb24gKHYsIGEsIHBhcmVudCwgaW5kZXgsIGFiaWxpdHlNb2RlbCwgYWJpbGl0eSkge1xuICAgICAgICAgICAgICAgIHJldHVybiB2KmE7XG4gICAgICAgICAgICB9XG4gICAgICAgIH0sXG4gICAgICAgIHtcbiAgICAgICAgICAgIGF0dHJpYnV0ZU5hbWU6ICdjcmVlcF9kYW1hZ2UnLFxuICAgICAgICAgICAgbGFiZWw6ICdUb3RhbCBEYW1hZ2UnLFxuICAgICAgICAgICAgY29udHJvbFR5cGU6ICd0ZXh0JyxcbiAgICAgICAgICAgIGZuOiBmdW5jdGlvbiAodiwgYSwgcGFyZW50LCBpbmRleCwgYWJpbGl0eU1vZGVsLCBhYmlsaXR5KSB7XG4gICAgICAgICAgICAgICAgcmV0dXJuIHYqYTtcbiAgICAgICAgICAgIH1cbiAgICAgICAgfVxuICAgIF0sXG4gICAgJ3dpc3Bfb3ZlcmNoYXJnZSc6IFtcbiAgICAgICAge1xuICAgICAgICAgICAgbGFiZWw6ICdDdXJyZW50IEhQJyxcbiAgICAgICAgICAgIGNvbnRyb2xUeXBlOiAnaW5wdXQnXG4gICAgICAgIH0sXG4gICAgICAgIHtcbiAgICAgICAgICAgIGF0dHJpYnV0ZU5hbWU6ICdkcmFpbl9wY3QnLFxuICAgICAgICAgICAgbGFiZWw6ICdIUCBEUkFJTkVEOicsXG4gICAgICAgICAgICBpZ25vcmVUb29sdGlwOiB0cnVlLCBcbiAgICAgICAgICAgIGNvbnRyb2xUeXBlOiAndGV4dCcsXG4gICAgICAgICAgICBmbjogZnVuY3Rpb24gKHYsIGEsIHBhcmVudCwgaW5kZXgsIGFiaWxpdHlNb2RlbCwgYWJpbGl0eSkge1xuICAgICAgICAgICAgICAgIHJldHVybiB2KmE7XG4gICAgICAgICAgICB9XG4gICAgICAgIH0sXG4gICAgICAgIHtcbiAgICAgICAgICAgIGxhYmVsOiAnQ3VycmVudCBNUCcsXG4gICAgICAgICAgICBjb250cm9sVHlwZTogJ2lucHV0J1xuICAgICAgICB9LFxuICAgICAgICB7XG4gICAgICAgICAgICBhdHRyaWJ1dGVOYW1lOiAnZHJhaW5fcGN0JyxcbiAgICAgICAgICAgIGxhYmVsOiAnTVAgRFJBSU5FRDonLFxuICAgICAgICAgICAgaWdub3JlVG9vbHRpcDogdHJ1ZSwgXG4gICAgICAgICAgICBjb250cm9sVHlwZTogJ3RleHQnLFxuICAgICAgICAgICAgZm46IGZ1bmN0aW9uICh2LCBhLCBwYXJlbnQsIGluZGV4LCBhYmlsaXR5TW9kZWwsIGFiaWxpdHkpIHtcbiAgICAgICAgICAgICAgICByZXR1cm4gdiphO1xuICAgICAgICAgICAgfVxuICAgICAgICB9LFxuICAgICAgICB7XG4gICAgICAgICAgICBhdHRyaWJ1dGVOYW1lOiAnYm9udXNfYXR0YWNrX3NwZWVkJyxcbiAgICAgICAgICAgIGxhYmVsOiAnVG90YWwgRGFtYWdlJyxcbiAgICAgICAgICAgIGNvbnRyb2xUeXBlOiAndGV4dCcsXG4gICAgICAgICAgICBmbjogZnVuY3Rpb24gKHYsIGEsIHBhcmVudCwgaW5kZXgsIGFiaWxpdHlNb2RlbCwgYWJpbGl0eSkge1xuICAgICAgICAgICAgICAgIHJldHVybiBhO1xuICAgICAgICAgICAgfSxcbiAgICAgICAgICAgIHJldHVyblByb3BlcnR5OiAnYXR0YWNrc3BlZWQnXG4gICAgICAgIH0sXG4gICAgICAgIHtcbiAgICAgICAgICAgIGF0dHJpYnV0ZU5hbWU6ICdib251c19kYW1hZ2VfcGN0JyxcbiAgICAgICAgICAgIGxhYmVsOiAnVG90YWwgRGFtYWdlJyxcbiAgICAgICAgICAgIGNvbnRyb2xUeXBlOiAndGV4dCcsXG4gICAgICAgICAgICBmbjogZnVuY3Rpb24gKHYsIGEsIHBhcmVudCwgaW5kZXgsIGFiaWxpdHlNb2RlbCwgYWJpbGl0eSkge1xuICAgICAgICAgICAgICAgIHJldHVybiBhO1xuICAgICAgICAgICAgfSxcbiAgICAgICAgICAgIHJldHVyblByb3BlcnR5OiAnZGFtYWdlUmVkdWN0aW9uJ1xuICAgICAgICB9XG4gICAgXSxcbiAgICAnd2l0Y2hfZG9jdG9yX3BhcmFseXppbmdfY2Fzayc6IFtcbiAgICAgICAge1xuICAgICAgICAgICAgbGFiZWw6ICdIZXJvIEJvdW5jZSBDb3VudCcsXG4gICAgICAgICAgICBjb250cm9sVHlwZTogJ2lucHV0J1xuICAgICAgICB9LFxuICAgICAgICB7XG4gICAgICAgICAgICBhdHRyaWJ1dGVOYW1lOiAnaGVyb19kYW1hZ2UnLFxuICAgICAgICAgICAgbGFiZWw6ICdUb3RhbCBEYW1hZ2UnLFxuICAgICAgICAgICAgY29udHJvbFR5cGU6ICd0ZXh0JyxcbiAgICAgICAgICAgIGZuOiBmdW5jdGlvbiAodiwgYSwgcGFyZW50LCBpbmRleCwgYWJpbGl0eU1vZGVsLCBhYmlsaXR5KSB7XG4gICAgICAgICAgICAgICAgdmFyIGJvdW5jZXMgPSBhYmlsaXR5TW9kZWwuZ2V0QWJpbGl0eUF0dHJpYnV0ZVZhbHVlKGFiaWxpdHkuYXR0cmlidXRlcywgJ2JvdW5jZXMnLGFiaWxpdHkubGV2ZWwoKSk7XG4gICAgICAgICAgICAgICAgcmV0dXJuIE1hdGgubWluKE1hdGgubWF4KHYsIDApLCBib3VuY2VzKSphO1xuICAgICAgICAgICAgfVxuICAgICAgICB9LFxuICAgICAgICB7XG4gICAgICAgICAgICBsYWJlbDogJ0NyZWVwIEJvdW5jZSBDb3VudCcsXG4gICAgICAgICAgICBjb250cm9sVHlwZTogJ2lucHV0J1xuICAgICAgICB9LFxuICAgICAgICB7XG4gICAgICAgICAgICBhdHRyaWJ1dGVOYW1lOiAnaGVyb19kYW1hZ2UnLFxuICAgICAgICAgICAgbGFiZWw6ICdDUkVFUCBEQU1BR0U6JyxcbiAgICAgICAgICAgIGlnbm9yZVRvb2x0aXA6IHRydWUsXG4gICAgICAgICAgICBjb250cm9sVHlwZTogJ3RleHQnLFxuICAgICAgICAgICAgZm46IGZ1bmN0aW9uICh2LCBhLCBwYXJlbnQsIGluZGV4LCBhYmlsaXR5TW9kZWwsIGFiaWxpdHkpIHtcbiAgICAgICAgICAgICAgICB2YXIgYm91bmNlcyA9IGFiaWxpdHlNb2RlbC5nZXRBYmlsaXR5QXR0cmlidXRlVmFsdWUoYWJpbGl0eS5hdHRyaWJ1dGVzLCAnYm91bmNlcycsYWJpbGl0eS5sZXZlbCgpKTtcbiAgICAgICAgICAgICAgICB2YXIgZGFtYWdlID0gYWJpbGl0eU1vZGVsLmdldEFiaWxpdHlQcm9wZXJ0eVZhbHVlKGFiaWxpdHksICdkYW1hZ2UnKTtcbiAgICAgICAgICAgICAgICByZXR1cm4gTWF0aC5taW4oTWF0aC5tYXgodiwgMCksIGJvdW5jZXMpKmRhbWFnZTtcbiAgICAgICAgICAgIH1cbiAgICAgICAgfVxuICAgIF0sXG4gICAgJ3dpdGNoX2RvY3Rvcl92b29kb29fcmVzdG9yYXRpb24nOiBbXG4gICAgICAgIHtcbiAgICAgICAgICAgIGxhYmVsOiAnRHVyYXRpb24nLFxuICAgICAgICAgICAgY29udHJvbFR5cGU6ICdpbnB1dCdcbiAgICAgICAgfSxcbiAgICAgICAge1xuICAgICAgICAgICAgYXR0cmlidXRlTmFtZTogJ2hlYWwnLFxuICAgICAgICAgICAgbGFiZWw6ICdUb3RhbCBEYW1hZ2UnLFxuICAgICAgICAgICAgY29udHJvbFR5cGU6ICd0ZXh0JyxcbiAgICAgICAgICAgIGZuOiBmdW5jdGlvbiAodiwgYSwgcGFyZW50LCBpbmRleCwgYWJpbGl0eU1vZGVsLCBhYmlsaXR5KSB7XG4gICAgICAgICAgICAgICAgdmFyIGludGVydmFsID0gYWJpbGl0eU1vZGVsLmdldEFiaWxpdHlBdHRyaWJ1dGVWYWx1ZShhYmlsaXR5LmF0dHJpYnV0ZXMsICdoZWFsX2ludGVydmFsJyxhYmlsaXR5LmxldmVsKCkpO1xuICAgICAgICAgICAgICAgIHZhciBoZWFsX3Blcl90aWNrID0gYSAqIGludGVydmFsO1xuICAgICAgICAgICAgICAgIHZhciB0aWNrcyA9IE1hdGgubWF4KE1hdGguZmxvb3IodiAvIGludGVydmFsKSAtIDEsIDApO1xuICAgICAgICAgICAgICAgIHJldHVybiBoZWFsX3Blcl90aWNrICogdGlja3M7XG4gICAgICAgICAgICB9XG4gICAgICAgIH0sXG4gICAgICAgIHtcbiAgICAgICAgICAgIGF0dHJpYnV0ZU5hbWU6ICdtYW5hX3Blcl9zZWNvbmQnLFxuICAgICAgICAgICAgbGFiZWw6ICdNQU5BIENPU1Q6JyxcbiAgICAgICAgICAgIGlnbm9yZVRvb2x0aXA6IHRydWUsXG4gICAgICAgICAgICBjb250cm9sVHlwZTogJ3RleHQnLFxuICAgICAgICAgICAgZm46IGZ1bmN0aW9uICh2LCBhLCBwYXJlbnQsIGluZGV4LCBhYmlsaXR5TW9kZWwsIGFiaWxpdHkpIHtcbiAgICAgICAgICAgICAgICB2YXIgaW50ZXJ2YWwgPSBhYmlsaXR5TW9kZWwuZ2V0QWJpbGl0eUF0dHJpYnV0ZVZhbHVlKGFiaWxpdHkuYXR0cmlidXRlcywgJ2hlYWxfaW50ZXJ2YWwnLGFiaWxpdHkubGV2ZWwoKSk7XG4gICAgICAgICAgICAgICAgdmFyIG1hbmFfcGVyX3RpY2sgPSBhICogaW50ZXJ2YWw7XG4gICAgICAgICAgICAgICAgdmFyIHRpY2tzID0gTWF0aC5tYXgoTWF0aC5mbG9vcih2IC8gaW50ZXJ2YWwpIC0gMSwgMCk7XG4gICAgICAgICAgICAgICAgcmV0dXJuIG1hbmFfcGVyX3RpY2sgKiB0aWNrcztcbiAgICAgICAgICAgIH1cbiAgICAgICAgfVxuICAgIF0sXG4gICAgJ3dpdGNoX2RvY3Rvcl9tYWxlZGljdCc6IFtcbiAgICAgICAge1xuICAgICAgICAgICAgbGFiZWw6ICdkYW1hZ2UgMC00cycsXG4gICAgICAgICAgICBjb250cm9sVHlwZTogJ2lucHV0J1xuICAgICAgICB9LFxuICAgICAgICB7XG4gICAgICAgICAgICBsYWJlbDogJ2RhbWFnZSA0LThzJyxcbiAgICAgICAgICAgIGNvbnRyb2xUeXBlOiAnaW5wdXQnXG4gICAgICAgIH0sXG4gICAgICAgIHtcbiAgICAgICAgICAgIGxhYmVsOiAnZGFtYWdlIDgtMTJzJyxcbiAgICAgICAgICAgIGNvbnRyb2xUeXBlOiAnaW5wdXQnXG4gICAgICAgIH0sXG4gICAgICAgIHtcbiAgICAgICAgICAgIGF0dHJpYnV0ZU5hbWU6ICdib251c19kYW1hZ2UnLFxuICAgICAgICAgICAgbGFiZWw6ICdEb3QgRGFtYWdlIGFmdGVyIDNzOicsXG4gICAgICAgICAgICBpZ25vcmVUb29sdGlwOiB0cnVlLFxuICAgICAgICAgICAgY29udHJvbFR5cGU6ICdtZXRob2QnLFxuICAgICAgICAgICAgZm46IGZ1bmN0aW9uICh2LCBhLCBwYXJlbnQsIGluZGV4LCBhYmlsaXR5TW9kZWwsIGFiaWxpdHkpIHtcbiAgICAgICAgICAgICAgICB2YXIgZGFtYWdlID0gYWJpbGl0eU1vZGVsLmdldEFiaWxpdHlQcm9wZXJ0eVZhbHVlKGFiaWxpdHksICdkYW1hZ2UnKTtcbiAgICAgICAgICAgICAgICByZXR1cm4gMypkYW1hZ2U7XG4gICAgICAgICAgICB9XG4gICAgICAgIH0sXG4gICAgICAgIHtcbiAgICAgICAgICAgIGF0dHJpYnV0ZU5hbWU6ICdib251c19kYW1hZ2UnLFxuICAgICAgICAgICAgbGFiZWw6ICdCdXJzdCBEYW1hZ2UgYXQgNHM6JyxcbiAgICAgICAgICAgIGlnbm9yZVRvb2x0aXA6IHRydWUsXG4gICAgICAgICAgICBjb250cm9sVHlwZTogJ21ldGhvZCcsXG4gICAgICAgICAgICBjb250cm9sczogWzAsIDNdLFxuICAgICAgICAgICAgZm46IGZ1bmN0aW9uICh2LCBhLCBwYXJlbnQsIGluZGV4LCBhYmlsaXR5TW9kZWwsIGFiaWxpdHkpIHtcbiAgICAgICAgICAgICAgICB2YXIgZGFtYWdlID0gYWJpbGl0eU1vZGVsLmdldEFiaWxpdHlQcm9wZXJ0eVZhbHVlKGFiaWxpdHksICdkYW1hZ2UnKTtcbiAgICAgICAgICAgICAgICB2YXIgZCA9IHYucmVkdWNlKGZ1bmN0aW9uIChtZW1vLCBvKSB7IHJldHVybiBtZW1vICsgbyB9LCAwKTtcbiAgICAgICAgICAgICAgICByZXR1cm4gTWF0aC5tYXgoZCwgMCkgKiBhLzEwMDtcbiAgICAgICAgICAgIH1cbiAgICAgICAgfSxcbiAgICAgICAge1xuICAgICAgICAgICAgYXR0cmlidXRlTmFtZTogJ2JvbnVzX2RhbWFnZScsXG4gICAgICAgICAgICBsYWJlbDogJ0RvdCBEYW1hZ2UgYWZ0ZXIgN3M6JyxcbiAgICAgICAgICAgIGlnbm9yZVRvb2x0aXA6IHRydWUsXG4gICAgICAgICAgICBjb250cm9sVHlwZTogJ21ldGhvZCcsXG4gICAgICAgICAgICBmbjogZnVuY3Rpb24gKHYsIGEsIHBhcmVudCwgaW5kZXgsIGFiaWxpdHlNb2RlbCwgYWJpbGl0eSkge1xuICAgICAgICAgICAgICAgIHZhciBkYW1hZ2UgPSBhYmlsaXR5TW9kZWwuZ2V0QWJpbGl0eVByb3BlcnR5VmFsdWUoYWJpbGl0eSwgJ2RhbWFnZScpO1xuICAgICAgICAgICAgICAgIHJldHVybiA3KmRhbWFnZTtcbiAgICAgICAgICAgIH1cbiAgICAgICAgfSxcbiAgICAgICAge1xuICAgICAgICAgICAgYXR0cmlidXRlTmFtZTogJ2JvbnVzX2RhbWFnZScsXG4gICAgICAgICAgICBsYWJlbDogJ0J1cnN0IERhbWFnZSBhdCA4czonLFxuICAgICAgICAgICAgaWdub3JlVG9vbHRpcDogdHJ1ZSxcbiAgICAgICAgICAgIGNvbnRyb2xUeXBlOiAnbWV0aG9kJyxcbiAgICAgICAgICAgIGNvbnRyb2xzOiBbMCwgMSwgNCwgNV0sXG4gICAgICAgICAgICBmbjogZnVuY3Rpb24gKHYsIGEsIHBhcmVudCwgaW5kZXgsIGFiaWxpdHlNb2RlbCwgYWJpbGl0eSkge1xuICAgICAgICAgICAgICAgIHZhciBkYW1hZ2UgPSBhYmlsaXR5TW9kZWwuZ2V0QWJpbGl0eVByb3BlcnR5VmFsdWUoYWJpbGl0eSwgJ2RhbWFnZScpO1xuICAgICAgICAgICAgICAgIHZhciBkID0gdi5yZWR1Y2UoZnVuY3Rpb24gKG1lbW8sIG8pIHsgcmV0dXJuIG1lbW8gKyBvIH0sIDApO1xuICAgICAgICAgICAgICAgIHJldHVybiBNYXRoLm1heChkLCAwKSAqIGEvMTAwO1xuICAgICAgICAgICAgfVxuICAgICAgICB9LFxuICAgICAgICB7XG4gICAgICAgICAgICBhdHRyaWJ1dGVOYW1lOiAnYm9udXNfZGFtYWdlJyxcbiAgICAgICAgICAgIGxhYmVsOiAnRG90IERhbWFnZSBhZnRlciAxMXM6JyxcbiAgICAgICAgICAgIGlnbm9yZVRvb2x0aXA6IHRydWUsXG4gICAgICAgICAgICBjb250cm9sVHlwZTogJ21ldGhvZCcsXG4gICAgICAgICAgICBmbjogZnVuY3Rpb24gKHYsIGEsIHBhcmVudCwgaW5kZXgsIGFiaWxpdHlNb2RlbCwgYWJpbGl0eSkge1xuICAgICAgICAgICAgICAgIHZhciBkYW1hZ2UgPSBhYmlsaXR5TW9kZWwuZ2V0QWJpbGl0eVByb3BlcnR5VmFsdWUoYWJpbGl0eSwgJ2RhbWFnZScpO1xuICAgICAgICAgICAgICAgIHJldHVybiAxMSpkYW1hZ2U7XG4gICAgICAgICAgICB9XG4gICAgICAgIH0sXG4gICAgICAgIHtcbiAgICAgICAgICAgIGF0dHJpYnV0ZU5hbWU6ICdib251c19kYW1hZ2UnLFxuICAgICAgICAgICAgbGFiZWw6ICdCdXJzdCBEYW1hZ2UgYXQgMTJzOicsXG4gICAgICAgICAgICBpZ25vcmVUb29sdGlwOiB0cnVlLFxuICAgICAgICAgICAgY29udHJvbFR5cGU6ICdtZXRob2QnLFxuICAgICAgICAgICAgY29udHJvbHM6IFswLCAxLCAyLCA0LCA2LCA3XSxcbiAgICAgICAgICAgIGZuOiBmdW5jdGlvbiAodiwgYSwgcGFyZW50LCBpbmRleCwgYWJpbGl0eU1vZGVsLCBhYmlsaXR5KSB7XG4gICAgICAgICAgICAgICAgdmFyIGRhbWFnZSA9IGFiaWxpdHlNb2RlbC5nZXRBYmlsaXR5UHJvcGVydHlWYWx1ZShhYmlsaXR5LCAnZGFtYWdlJyk7XG4gICAgICAgICAgICAgICAgdmFyIGQgPSB2LnJlZHVjZShmdW5jdGlvbiAobWVtbywgbykgeyByZXR1cm4gbWVtbyArIG8gfSwgMCk7XG4gICAgICAgICAgICAgICAgcmV0dXJuIE1hdGgubWF4KGQsIDApICogYS8xMDA7XG4gICAgICAgICAgICB9XG4gICAgICAgIH0sXG4gICAgICAgIHtcbiAgICAgICAgICAgIGF0dHJpYnV0ZU5hbWU6ICdib251c19kYW1hZ2UnLFxuICAgICAgICAgICAgbGFiZWw6ICdUb3RhbCBCdXJzdCBEYW1hZ2U6JyxcbiAgICAgICAgICAgIGlnbm9yZVRvb2x0aXA6IHRydWUsXG4gICAgICAgICAgICBjb250cm9sVHlwZTogJ21ldGhvZCcsXG4gICAgICAgICAgICBjb250cm9sczogWzQsIDYsIDhdLFxuICAgICAgICAgICAgZm46IGZ1bmN0aW9uICh2LCBhLCBwYXJlbnQsIGluZGV4LCBhYmlsaXR5TW9kZWwsIGFiaWxpdHkpIHtcbiAgICAgICAgICAgICAgICByZXR1cm4gdi5yZWR1Y2UoZnVuY3Rpb24gKG1lbW8sIG8pIHsgcmV0dXJuIG1lbW8gKyBvIH0sIDApO1xuICAgICAgICAgICAgfVxuICAgICAgICB9LFxuICAgICAgICB7XG4gICAgICAgICAgICBhdHRyaWJ1dGVOYW1lOiAnYm9udXNfZGFtYWdlJyxcbiAgICAgICAgICAgIGxhYmVsOiAnVG90YWwgTWFsZWRpY3QgRGFtYWdlOicsXG4gICAgICAgICAgICBpZ25vcmVUb29sdGlwOiB0cnVlLFxuICAgICAgICAgICAgY29udHJvbFR5cGU6ICdtZXRob2QnLFxuICAgICAgICAgICAgY29udHJvbHM6IFs5XSxcbiAgICAgICAgICAgIGZuOiBmdW5jdGlvbiAodiwgYSwgcGFyZW50LCBpbmRleCwgYWJpbGl0eU1vZGVsLCBhYmlsaXR5KSB7XG4gICAgICAgICAgICAgICAgdmFyIGR1cmF0aW9uID0gYWJpbGl0eU1vZGVsLmdldEFiaWxpdHlBdHRyaWJ1dGVWYWx1ZShhYmlsaXR5LmF0dHJpYnV0ZXMsICdkdXJhdGlvbl90b29sdGlwJywwKTtcbiAgICAgICAgICAgICAgICB2YXIgZGFtYWdlID0gYWJpbGl0eU1vZGVsLmdldEFiaWxpdHlQcm9wZXJ0eVZhbHVlKGFiaWxpdHksICdkYW1hZ2UnKTtcbiAgICAgICAgICAgICAgICByZXR1cm4gZGFtYWdlICogZHVyYXRpb24gKyB2WzBdO1xuICAgICAgICAgICAgfVxuICAgICAgICB9LFxuICAgICAgICB7XG4gICAgICAgICAgICBsYWJlbDogJ0R1cmF0aW9uJyxcbiAgICAgICAgICAgIGNvbnRyb2xUeXBlOiAnaW5wdXQnXG4gICAgICAgIH0sXG4gICAgICAgIHtcbiAgICAgICAgICAgIGF0dHJpYnV0ZU5hbWU6ICdib251c19kYW1hZ2UnLFxuICAgICAgICAgICAgbGFiZWw6ICdET1QgRGFtYWdlJyxcbiAgICAgICAgICAgIGNvbnRyb2xUeXBlOiAndGV4dCcsXG4gICAgICAgICAgICBmbjogZnVuY3Rpb24gKHYsIGEsIHBhcmVudCwgaW5kZXgsIGFiaWxpdHlNb2RlbCwgYWJpbGl0eSkge1xuICAgICAgICAgICAgICAgIHZhciBkdXJhdGlvbiA9IGFiaWxpdHlNb2RlbC5nZXRBYmlsaXR5QXR0cmlidXRlVmFsdWUoYWJpbGl0eS5hdHRyaWJ1dGVzLCAnZHVyYXRpb25fdG9vbHRpcCcsMCk7XG4gICAgICAgICAgICAgICAgcmV0dXJuIGFiaWxpdHlNb2RlbC5nZXRBYmlsaXR5UHJvcGVydHlWYWx1ZShhYmlsaXR5LCAnZGFtYWdlJykqTWF0aC5taW4oTWF0aC5tYXgodiwgMCksIGR1cmF0aW9uKTtcbiAgICAgICAgICAgIH1cbiAgICAgICAgfVxuICAgIF0sXG4gICAgJ3dpdGNoX2RvY3Rvcl9kZWF0aF93YXJkJzogW1xuICAgICAgICB7XG4gICAgICAgICAgICBsYWJlbDogJ0R1cmF0aW9uJyxcbiAgICAgICAgICAgIGNvbnRyb2xUeXBlOiAnaW5wdXQnXG4gICAgICAgIH0sXG4gICAgICAgIHtcbiAgICAgICAgICAgIGF0dHJpYnV0ZU5hbWU6ICdkYW1hZ2UnLFxuICAgICAgICAgICAgbGFiZWw6ICdUb3RhbCBEYW1hZ2UnLFxuICAgICAgICAgICAgY29udHJvbFR5cGU6ICd0ZXh0JyxcbiAgICAgICAgICAgIGZuOiBmdW5jdGlvbiAodiwgYSwgcGFyZW50LCBpbmRleCwgYWJpbGl0eU1vZGVsLCBhYmlsaXR5KSB7XG4gICAgICAgICAgICAgICAgcmV0dXJuIHYqYTtcbiAgICAgICAgICAgIH1cbiAgICAgICAgfVxuICAgIF0sXG4gICAgJ3p1dXNfc3RhdGljX2ZpZWxkJzogW1xuICAgICAgICB7XG4gICAgICAgICAgICBsYWJlbDogJ0VuZW15IEhQJyxcbiAgICAgICAgICAgIGNvbnRyb2xUeXBlOiAnaW5wdXQnXG4gICAgICAgIH0sXG4gICAgICAgIHtcbiAgICAgICAgICAgIGF0dHJpYnV0ZU5hbWU6ICdkYW1hZ2VfaGVhbHRoX3BjdCcsXG4gICAgICAgICAgICBsYWJlbDogJ0RBTUFHRTonLFxuICAgICAgICAgICAgaWdub3JlVG9vbHRpcDogdHJ1ZSxcbiAgICAgICAgICAgIGNvbnRyb2xUeXBlOiAndGV4dCcsXG4gICAgICAgICAgICBmbjogZnVuY3Rpb24gKHYsIGEsIHBhcmVudCwgaW5kZXgsIGFiaWxpdHlNb2RlbCwgYWJpbGl0eSkge1xuICAgICAgICAgICAgICAgIHJldHVybiB2KmEvMTAwO1xuICAgICAgICAgICAgfVxuICAgICAgICB9XG4gICAgXVxufVxuXG5tb2R1bGUuZXhwb3J0cyA9IGFiaWxpdHlEYXRhOyIsIid1c2Ugc3RyaWN0JztcbnZhciBrbyA9ICh0eXBlb2Ygd2luZG93ICE9PSBcInVuZGVmaW5lZFwiID8gd2luZG93WydrbyddIDogdHlwZW9mIGdsb2JhbCAhPT0gXCJ1bmRlZmluZWRcIiA/IGdsb2JhbFsna28nXSA6IG51bGwpO1xuXG5rby5tYXBwaW5nID0gcmVxdWlyZSgnLi4vbGliL2tub2Nrb3V0Lm1hcHBpbmcnKTtcbmtvLndyYXAgPSByZXF1aXJlKCcuLi9saWIva25vY2tvdXQud3JhcCcpO1xuXG5rby5leHRlbmRlcnMubnVtZXJpYyA9IGZ1bmN0aW9uKHRhcmdldCwgb3B0cykge1xuICAgIC8vY3JlYXRlIGEgd3JpdGFibGUgY29tcHV0ZWQgb2JzZXJ2YWJsZSB0byBpbnRlcmNlcHQgd3JpdGVzIHRvIG91ciBvYnNlcnZhYmxlXG4gICAgdmFyIHJlc3VsdCA9IGtvLnB1cmVDb21wdXRlZCh7XG4gICAgICAgIHJlYWQ6IHRhcmdldCwgIC8vYWx3YXlzIHJldHVybiB0aGUgb3JpZ2luYWwgb2JzZXJ2YWJsZXMgdmFsdWVcbiAgICAgICAgd3JpdGU6IGZ1bmN0aW9uKG5ld1ZhbHVlKSB7XG4gICAgICAgICAgICB2YXIgY3VycmVudCA9IHRhcmdldCgpLFxuICAgICAgICAgICAgICAgIHJvdW5kaW5nTXVsdGlwbGllciA9IE1hdGgucG93KDEwLCAob3B0cyA9PT0gT2JqZWN0KG9wdHMpID8gb3B0cy5wcmVjaXNpb24gOiBvcHRzKSB8fCAwKSxcbiAgICAgICAgICAgICAgICBuZXdWYWx1ZUFzTnVtID0gaXNOYU4obmV3VmFsdWUpID8gKG9wdHMuZGVmYXVsdFZhbHVlIHx8IDApIDogK25ld1ZhbHVlLFxuICAgICAgICAgICAgICAgIHZhbHVlVG9Xcml0ZSA9IE1hdGgucm91bmQobmV3VmFsdWVBc051bSAqIHJvdW5kaW5nTXVsdGlwbGllcikgLyByb3VuZGluZ011bHRpcGxpZXI7XG4gXG4gICAgICAgICAgICAvL29ubHkgd3JpdGUgaWYgaXQgY2hhbmdlZFxuICAgICAgICAgICAgaWYgKHZhbHVlVG9Xcml0ZSAhPT0gY3VycmVudCkge1xuICAgICAgICAgICAgICAgIHRhcmdldCh2YWx1ZVRvV3JpdGUpO1xuICAgICAgICAgICAgfSBlbHNlIHtcbiAgICAgICAgICAgICAgICAvL2lmIHRoZSByb3VuZGVkIHZhbHVlIGlzIHRoZSBzYW1lLCBidXQgYSBkaWZmZXJlbnQgdmFsdWUgd2FzIHdyaXR0ZW4sIGZvcmNlIGEgbm90aWZpY2F0aW9uIGZvciB0aGUgY3VycmVudCBmaWVsZFxuICAgICAgICAgICAgICAgIGlmIChuZXdWYWx1ZSAhPT0gY3VycmVudCkge1xuICAgICAgICAgICAgICAgICAgICB0YXJnZXQubm90aWZ5U3Vic2NyaWJlcnModmFsdWVUb1dyaXRlKTtcbiAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICB9XG4gICAgICAgIH1cbiAgICB9KS5leHRlbmQoeyBub3RpZnk6ICdhbHdheXMnIH0pO1xuIFxuICAgIC8vaW5pdGlhbGl6ZSB3aXRoIGN1cnJlbnQgdmFsdWUgdG8gbWFrZSBzdXJlIGl0IGlzIHJvdW5kZWQgYXBwcm9wcmlhdGVseVxuICAgIHJlc3VsdCh0YXJnZXQoKSk7XG4gXG4gICAgLy9yZXR1cm4gdGhlIG5ldyBjb21wdXRlZCBvYnNlcnZhYmxlXG4gICAgcmV0dXJuIHJlc3VsdDtcbn07XG5cbm1vZHVsZS5leHBvcnRzID0ga287IiwidmFyIElsbHVzaW9uT3B0aW9uID0gZnVuY3Rpb24gKG5hbWUsIGRpc3BsYXluYW1lLCBiYXNlSGVybykge1xuICAgIHRoaXMuaWxsdXNpb25OYW1lID0gbmFtZTtcbiAgICB0aGlzLmlsbHVzaW9uRGlzcGxheU5hbWUgPSBkaXNwbGF5bmFtZTtcbiAgICB0aGlzLmJhc2VIZXJvID0gYmFzZUhlcm87XG59O1xuXG5tb2R1bGUuZXhwb3J0cyA9IElsbHVzaW9uT3B0aW9uOyIsInZhciBpbGx1c2lvbkRhdGEgPSB7XG4gICAgY2hhb3Nfa25pZ2h0X3BoYW50YXNtOiB7XG4gICAgICAgIGhlcm86ICdjaGFvc19rbmlnaHQnLFxuICAgICAgICBkaXNwbGF5TmFtZTogJ0NoYW9zIEtuaWdodCBQaGFudGFzbScsXG4gICAgICAgIHVzZV9zZWxlY3RlZF9oZXJvOiBmYWxzZSxcbiAgICAgICAgbWF4X2xldmVsOiAzLFxuICAgICAgICBvdXRnb2luZ19kYW1hZ2U6ICdvdXRnb2luZ19kYW1hZ2UnLFxuICAgICAgICBpbmNvbWluZ19kYW1hZ2U6ICdpbmNvbWluZ19kYW1hZ2UnXG4gICAgfSxcbiAgICBuYWdhX3NpcmVuX21pcnJvcl9pbWFnZToge1xuICAgICAgICBoZXJvOiAnbmFnYV9zaXJlbicsXG4gICAgICAgIGRpc3BsYXlOYW1lOiAnTmFnYSBTaXJlbiBNaXJyb3IgSW1hZ2UnLFxuICAgICAgICB1c2Vfc2VsZWN0ZWRfaGVybzogZmFsc2UsXG4gICAgICAgIG1heF9sZXZlbDogNCxcbiAgICAgICAgb3V0Z29pbmdfZGFtYWdlOiAnb3V0Z29pbmdfZGFtYWdlJyxcbiAgICAgICAgaW5jb21pbmdfZGFtYWdlOiAnaW5jb21pbmdfZGFtYWdlJ1xuICAgIH0sXG4gICAgZGFya19zZWVyX3dhbGxfb2ZfcmVwbGljYToge1xuICAgICAgICBoZXJvOiAnZGFya19zZWVyJyxcbiAgICAgICAgZGlzcGxheU5hbWU6ICdEYXJrIFNlZXIgV2FsbCBvZiBSZXBsaWNhJyxcbiAgICAgICAgdXNlX3NlbGVjdGVkX2hlcm86IHRydWUsXG4gICAgICAgIG1heF9sZXZlbDogMyxcbiAgICAgICAgb3V0Z29pbmdfZGFtYWdlOiAncmVwbGljYV9kYW1hZ2Vfb3V0Z29pbmcnLFxuICAgICAgICBpbmNvbWluZ19kYW1hZ2U6ICdyZXBsaWNhX2RhbWFnZV9pbmNvbWluZycsXG4gICAgICAgIG91dGdvaW5nX2RhbWFnZV9zY2VwdGVyOiAncmVwbGljYV9kYW1hZ2Vfb3V0Z29pbmdfc2NlcHRlcidcbiAgICB9LFxuICAgIG1vcnBobGluZ19yZXBsaWNhdGU6IHtcbiAgICAgICAgaGVybzogJ21vcnBobGluZycsXG4gICAgICAgIGRpc3BsYXlOYW1lOiAnTW9ycGhsaW5nIFJlcGxpY2F0ZScsXG4gICAgICAgIHVzZV9zZWxlY3RlZF9oZXJvOiB0cnVlLFxuICAgICAgICBtYXhfbGV2ZWw6IDMsXG4gICAgICAgIG91dGdvaW5nX2RhbWFnZTogJ2lsbHVzaW9uX2RhbWFnZV9vdXRfcGN0JyxcbiAgICAgICAgaW5jb21pbmdfZGFtYWdlOiAnaWxsdXNpb25fZGFtYWdlX2luX3BjdCdcbiAgICB9LFxuICAgIHBoYW50b21fbGFuY2VyX2RvcHBlbHdhbGs6IHtcbiAgICAgICAgaGVybzogJ3BoYW50b21fbGFuY2VyJyxcbiAgICAgICAgZGlzcGxheU5hbWU6ICdQaGFudG9tIExhbmNlciBEb3BwZWx3YWxrJyxcbiAgICAgICAgdXNlX3NlbGVjdGVkX2hlcm86IGZhbHNlLFxuICAgICAgICBtYXhfbGV2ZWw6IDQsXG4gICAgICAgIG91dGdvaW5nX2RhbWFnZTogJ2lsbHVzaW9uX2RhbWFnZV9vdXRfcGN0JyxcbiAgICAgICAgaW5jb21pbmdfZGFtYWdlOiAnaWxsdXNpb25fZGFtYWdlX2luX3BjdCcgICAgICAgIFxuICAgIH0sXG4gICAgcGhhbnRvbV9sYW5jZXJfanV4dGFwb3NlOiB7XG4gICAgICAgIGhlcm86ICdwaGFudG9tX2xhbmNlcicsXG4gICAgICAgIGRpc3BsYXlOYW1lOiAnUGhhbnRvbSBMYW5jZXIgSnV4dGFwb3NlJyxcbiAgICAgICAgdXNlX3NlbGVjdGVkX2hlcm86IGZhbHNlLFxuICAgICAgICBtYXhfbGV2ZWw6IDQsXG4gICAgICAgIG91dGdvaW5nX2RhbWFnZTogJ2lsbHVzaW9uX2RhbWFnZV9vdXRfcGN0JyxcbiAgICAgICAgaW5jb21pbmdfZGFtYWdlOiAnaWxsdXNpb25fZGFtYWdlX2luX3BjdCcgICAgICAgIFxuICAgIH0sXG4gICAgcGhhbnRvbV9sYW5jZXJfc3Bpcml0X2xhbmNlOiB7XG4gICAgICAgIGhlcm86ICdwaGFudG9tX2xhbmNlcicsXG4gICAgICAgIGRpc3BsYXlOYW1lOiAnUGhhbnRvbSBMYW5jZXIgU3Bpcml0IExhbmNlJyxcbiAgICAgICAgdXNlX3NlbGVjdGVkX2hlcm86IGZhbHNlLFxuICAgICAgICBtYXhfbGV2ZWw6IDQsXG4gICAgICAgIG91dGdvaW5nX2RhbWFnZTogJ2lsbHVzaW9uX2RhbWFnZV9vdXRfcGN0JyxcbiAgICAgICAgaW5jb21pbmdfZGFtYWdlOiAnaWxsdXNpb25fZGFtYWdlX2luX3BjdCcgICAgICAgIFxuICAgIH0sXG4gICAgc2hhZG93X2RlbW9uX2Rpc3J1cHRpb246IHtcbiAgICAgICAgaGVybzogJ3NoYWRvd19kZW1vbicsXG4gICAgICAgIGRpc3BsYXlOYW1lOiAnU2hhZG93IERlbW9uIERpc3J1cHRpb24nLFxuICAgICAgICB1c2Vfc2VsZWN0ZWRfaGVybzogdHJ1ZSxcbiAgICAgICAgbWF4X2xldmVsOiA0LFxuICAgICAgICBvdXRnb2luZ19kYW1hZ2U6ICdpbGx1c2lvbl9vdXRnb2luZ19kYW1hZ2UnLFxuICAgICAgICBpbmNvbWluZ19kYW1hZ2U6ICdpbGx1c2lvbl9pbmNvbWluZ19kYW1hZ2UnICAgICAgICBcbiAgICB9LFxuICAgIHNwZWN0cmVfaGF1bnQ6IHtcbiAgICAgICAgaGVybzogJ3NwZWN0cmUnLFxuICAgICAgICBkaXNwbGF5TmFtZTogJ1NwZWN0cmUgSGF1bnQnLFxuICAgICAgICB1c2Vfc2VsZWN0ZWRfaGVybzogZmFsc2UsXG4gICAgICAgIG1heF9sZXZlbDogMyxcbiAgICAgICAgb3V0Z29pbmdfZGFtYWdlOiAnaWxsdXNpb25fZGFtYWdlX291dGdvaW5nJyxcbiAgICAgICAgaW5jb21pbmdfZGFtYWdlOiAnaWxsdXNpb25fZGFtYWdlX2luY29taW5nJyAgICAgICAgXG4gICAgfSxcbiAgICB0ZXJyb3JibGFkZV9jb25qdXJlX2ltYWdlOiB7XG4gICAgICAgIGhlcm86ICd0ZXJyb3JibGFkZScsXG4gICAgICAgIGRpc3BsYXlOYW1lOiAnVGVycm9yYmxhZGUgQ29uanVyZSBJbWFnZScsXG4gICAgICAgIHVzZV9zZWxlY3RlZF9oZXJvOiBmYWxzZSxcbiAgICAgICAgbWF4X2xldmVsOiA0LFxuICAgICAgICBvdXRnb2luZ19kYW1hZ2U6ICdpbGx1c2lvbl9vdXRnb2luZ19kYW1hZ2UnLFxuICAgICAgICBpbmNvbWluZ19kYW1hZ2U6ICdpbGx1c2lvbl9pbmNvbWluZ19kYW1hZ2UnICAgICAgICBcbiAgICB9LFxuICAgIHRlcnJvcmJsYWRlX3JlZmxlY3Rpb246IHtcbiAgICAgICAgaGVybzogJ3RlcnJvcmJsYWRlJyxcbiAgICAgICAgZGlzcGxheU5hbWU6ICdUZXJyb3JibGFkZSBSZWZsZWN0aW9uJyxcbiAgICAgICAgdXNlX3NlbGVjdGVkX2hlcm86IHRydWUsXG4gICAgICAgIG1heF9sZXZlbDogNCxcbiAgICAgICAgb3V0Z29pbmdfZGFtYWdlOiAnaWxsdXNpb25fb3V0Z29pbmdfZGFtYWdlJyAgICAgXG4gICAgfSxcbiAgICBpdGVtX21hbnRhOiB7XG4gICAgICAgIGhlcm86ICcnLFxuICAgICAgICBpc19pdGVtOiB0cnVlLFxuICAgICAgICBkaXNwbGF5TmFtZTogJ01hbnRhIFN0eWxlIElsbHVzaW9uJyxcbiAgICAgICAgdXNlX3NlbGVjdGVkX2hlcm86IHRydWUsXG4gICAgICAgIG1heF9sZXZlbDogMSxcbiAgICAgICAgb3V0Z29pbmdfZGFtYWdlX21lbGVlOiAnaW1hZ2VzX2RvX2RhbWFnZV9wZXJjZW50X21lbGVlJyxcbiAgICAgICAgaW5jb21pbmdfZGFtYWdlX21lbGVlOiAnaW1hZ2VzX3Rha2VfZGFtYWdlX3BlcmNlbnRfbWVsZWUnLFxuICAgICAgICBvdXRnb2luZ19kYW1hZ2VfcmFuZ2VkOiAnaW1hZ2VzX2RvX2RhbWFnZV9wZXJjZW50X3JhbmdlZCcsXG4gICAgICAgIGluY29taW5nX2RhbWFnZV9yYW5nZWQ6ICdpbWFnZXNfdGFrZV9kYW1hZ2VfcGVyY2VudF9yYW5nZWQnXG4gICAgfVxufVxuXG5tb2R1bGUuZXhwb3J0cyA9IGlsbHVzaW9uRGF0YTsiLCJ2YXIgSWxsdXNpb25PcHRpb24gPSByZXF1aXJlKFwiLi9JbGx1c2lvbk9wdGlvblwiKTtcbnZhciBpbGx1c2lvbkRhdGEgPSByZXF1aXJlKFwiLi9pbGx1c2lvbkRhdGFcIik7XG5cbnZhciBpbGx1c2lvbk9wdGlvbnNBcnJheSA9IFtdO1xuZm9yICh2YXIgaCBpbiBpbGx1c2lvbkRhdGEpIHtcbiAgICBpbGx1c2lvbk9wdGlvbnNBcnJheS5wdXNoKG5ldyBJbGx1c2lvbk9wdGlvbihoLCBpbGx1c2lvbkRhdGFbaF0uZGlzcGxheU5hbWUsIGlsbHVzaW9uRGF0YVtoXS5oZXJvKSk7XG59XG5cbm1vZHVsZS5leHBvcnRzID0gaWxsdXNpb25PcHRpb25zQXJyYXk7IiwidmFyIHN0YWNrYWJsZUl0ZW1zID0gcmVxdWlyZShcIi4vc3RhY2thYmxlSXRlbXNcIik7XG52YXIgbGV2ZWxJdGVtcyA9IHJlcXVpcmUoXCIuL2xldmVsSXRlbXNcIik7XG52YXIgaXRlbXNXaXRoQWN0aXZlID0gcmVxdWlyZShcIi4vaXRlbXNXaXRoQWN0aXZlXCIpO1xuXG52YXIgQmFzaWNJbnZlbnRvcnlWaWV3TW9kZWwgPSBmdW5jdGlvbiAoaCkge1xuICAgIHZhciBzZWxmID0gdGhpcztcbiAgICBzZWxmLml0ZW1zID0ga28ub2JzZXJ2YWJsZUFycmF5KFtdKTtcbiAgICBzZWxmLmFjdGl2ZUl0ZW1zID0ga28ub2JzZXJ2YWJsZUFycmF5KFtdKTtcbiAgICBzZWxmLmFkZEl0ZW0gPSBmdW5jdGlvbiAoZGF0YSwgZXZlbnQpIHtcbiAgICAgICAgaWYgKGRhdGEuc2VsZWN0ZWRJdGVtKCkgIT0gdW5kZWZpbmVkKSB7XG4gICAgICAgICAgICB2YXIgbmV3X2l0ZW0gPSB7XG4gICAgICAgICAgICAgICAgaXRlbTogZGF0YS5zZWxlY3RlZEl0ZW0oKS5zcGxpdCgnfCcpWzBdLFxuICAgICAgICAgICAgICAgIHN0YXRlOiBrby5vYnNlcnZhYmxlKDApLFxuICAgICAgICAgICAgICAgIHNpemU6IGRhdGEuaXRlbUlucHV0VmFsdWUoKSxcbiAgICAgICAgICAgICAgICBlbmFibGVkOiBrby5vYnNlcnZhYmxlKHRydWUpXG4gICAgICAgICAgICB9XG4gICAgICAgICAgICBzd2l0Y2ggKG5ld19pdGVtLml0ZW0pIHtcbiAgICAgICAgICAgICAgICBjYXNlICdkYWdvbic6XG4gICAgICAgICAgICAgICAgICAgIG5ld19pdGVtLnNpemUgPSBNYXRoLm1pbihuZXdfaXRlbS5zaXplLCA1KTtcbiAgICAgICAgICAgICAgICBicmVhaztcbiAgICAgICAgICAgICAgICBicmVhaztcbiAgICAgICAgICAgICAgICBjYXNlICd0cmF2ZWxfYm9vdHMnOlxuICAgICAgICAgICAgICAgIGNhc2UgJ2RpZmZ1c2FsX2JsYWRlJzpcbiAgICAgICAgICAgICAgICAgICAgbmV3X2l0ZW0uc2l6ZSA9IE1hdGgubWluKG5ld19pdGVtLnNpemUsIDIpO1xuICAgICAgICAgICAgICAgIGJyZWFrO1xuICAgICAgICAgICAgICAgIGNhc2UgJ25lY3Jvbm9taWNvbic6XG4gICAgICAgICAgICAgICAgICAgIG5ld19pdGVtLnNpemUgPSBNYXRoLm1pbihuZXdfaXRlbS5zaXplLCAzKTtcbiAgICAgICAgICAgICAgICBicmVhaztcbiAgICAgICAgICAgIH1cbiAgICAgICAgICAgIHRoaXMuaXRlbXMucHVzaChuZXdfaXRlbSk7XG4gICAgICAgICAgICBpZiAoZGF0YS5zZWxlY3RlZEl0ZW0oKSA9PT0gJ3Jpbmdfb2ZfYXF1aWxhJyB8fCBkYXRhLnNlbGVjdGVkSXRlbSgpID09PSAncmluZ19vZl9iYXNpbGl1cycgfHwgZGF0YS5zZWxlY3RlZEl0ZW0oKSA9PT0gJ2hlYXJ0Jykge1xuICAgICAgICAgICAgICAgIHRoaXMudG9nZ2xlSXRlbSh1bmRlZmluZWQsIG5ld19pdGVtLCB1bmRlZmluZWQpO1xuICAgICAgICAgICAgfVxuICAgICAgICB9XG4gICAgfS5iaW5kKHRoaXMpO1xuICAgIHNlbGYudG9nZ2xlSXRlbSA9IGZ1bmN0aW9uIChpbmRleCwgZGF0YSwgZXZlbnQpIHtcbiAgICAgICAgaWYgKGl0ZW1zV2l0aEFjdGl2ZS5pbmRleE9mKGRhdGEuaXRlbSkgPj0gMCkge1xuICAgICAgICAgICAgaWYgKHRoaXMuYWN0aXZlSXRlbXMuaW5kZXhPZihkYXRhKSA8IDApIHtcbiAgICAgICAgICAgICAgICB0aGlzLmFjdGl2ZUl0ZW1zLnB1c2goZGF0YSk7XG4gICAgICAgICAgICB9XG4gICAgICAgICAgICBlbHNlIHtcbiAgICAgICAgICAgICAgICB0aGlzLmFjdGl2ZUl0ZW1zLnJlbW92ZShkYXRhKTtcbiAgICAgICAgICAgIH1cbiAgICAgICAgICAgIHN3aXRjaCAoZGF0YS5pdGVtKSB7XG4gICAgICAgICAgICAgICAgY2FzZSAncG93ZXJfdHJlYWRzJzpcbiAgICAgICAgICAgICAgICAgICAgaWYgKGRhdGEuc3RhdGUoKSA8IDIpIHtcbiAgICAgICAgICAgICAgICAgICAgICAgIGRhdGEuc3RhdGUoZGF0YS5zdGF0ZSgpICsgMSk7XG4gICAgICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgICAgICAgZWxzZSB7XG4gICAgICAgICAgICAgICAgICAgICAgICBkYXRhLnN0YXRlKDApO1xuICAgICAgICAgICAgICAgICAgICB9ICAgICAgICAgICAgICAgIFxuICAgICAgICAgICAgICAgIGJyZWFrO1xuICAgICAgICAgICAgICAgIGRlZmF1bHQ6XG4gICAgICAgICAgICAgICAgICAgIGlmIChkYXRhLnN0YXRlKCkgPT0gMCkge1xuICAgICAgICAgICAgICAgICAgICAgICAgZGF0YS5zdGF0ZSgxKTtcbiAgICAgICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICAgICAgICBlbHNlIHtcbiAgICAgICAgICAgICAgICAgICAgICAgIGRhdGEuc3RhdGUoMCk7XG4gICAgICAgICAgICAgICAgICAgIH0gICAgICAgICAgICAgICAgXG4gICAgICAgICAgICAgICAgYnJlYWs7XG4gICAgICAgICAgICB9XG4gICAgICAgIH1cbiAgICB9LmJpbmQodGhpcyk7XG4gICAgc2VsZi5yZW1vdmVJdGVtID0gZnVuY3Rpb24gKGl0ZW0pIHtcbiAgICAgICAgdGhpcy5hY3RpdmVJdGVtcy5yZW1vdmUoaXRlbSk7XG4gICAgICAgIHRoaXMuaXRlbXMucmVtb3ZlKGl0ZW0pO1xuICAgIH0uYmluZCh0aGlzKTtcbiAgICBzZWxmLnRvZ2dsZU11dGVJdGVtID0gZnVuY3Rpb24gKGl0ZW0pIHtcbiAgICAgICAgaXRlbS5lbmFibGVkKCFpdGVtLmVuYWJsZWQoKSk7XG4gICAgfS5iaW5kKHRoaXMpO1xuICAgIHNlbGYucmVtb3ZlQWxsID0gZnVuY3Rpb24gKCkge1xuICAgICAgICB0aGlzLmFjdGl2ZUl0ZW1zLnJlbW92ZUFsbCgpO1xuICAgICAgICB0aGlzLml0ZW1zLnJlbW92ZUFsbCgpO1xuICAgIH0uYmluZCh0aGlzKTtcbn1cbkJhc2ljSW52ZW50b3J5Vmlld01vZGVsLnByb3RvdHlwZS5nZXRJdGVtSW1hZ2UgPSBmdW5jdGlvbiAoZGF0YSkge1xuICAgIHZhciBzdGF0ZSA9IGtvLnV0aWxzLnVud3JhcE9ic2VydmFibGUoZGF0YS5zdGF0ZSk7XG4gICAgc3dpdGNoIChkYXRhLml0ZW0pIHtcbiAgICAgICAgY2FzZSAncG93ZXJfdHJlYWRzJzpcbiAgICAgICAgICAgIGlmIChzdGF0ZSA9PSAwKSB7XG4gICAgICAgICAgICAgICAgcmV0dXJuICcvbWVkaWEvaW1hZ2VzL2l0ZW1zLycgKyBkYXRhLml0ZW0gKyAnX3N0ci5wbmcnO1xuICAgICAgICAgICAgfVxuICAgICAgICAgICAgZWxzZSBpZiAoc3RhdGUgPT0gMSkge1xuICAgICAgICAgICAgICAgIHJldHVybiAnL21lZGlhL2ltYWdlcy9pdGVtcy8nICsgZGF0YS5pdGVtICsgJ19pbnQucG5nJztcbiAgICAgICAgICAgIH1cbiAgICAgICAgICAgIGVsc2Uge1xuICAgICAgICAgICAgICAgIHJldHVybiAnL21lZGlhL2ltYWdlcy9pdGVtcy8nICsgZGF0YS5pdGVtICsgJ19hZ2kucG5nJztcbiAgICAgICAgICAgIH1cbiAgICAgICAgYnJlYWs7XG4gICAgICAgIGNhc2UgJ3RyYW5xdWlsX2Jvb3RzJzpcbiAgICAgICAgY2FzZSAncmluZ19vZl9iYXNpbGl1cyc6XG4gICAgICAgICAgICBpZiAoc3RhdGUgPT0gMCkge1xuICAgICAgICAgICAgICAgIHJldHVybiAnL21lZGlhL2ltYWdlcy9pdGVtcy8nICsgZGF0YS5pdGVtICsgJy5wbmcnO1xuICAgICAgICAgICAgfVxuICAgICAgICAgICAgZWxzZSB7XG4gICAgICAgICAgICAgICAgcmV0dXJuICcvbWVkaWEvaW1hZ2VzL2l0ZW1zLycgKyBkYXRhLml0ZW0gKyAnX2FjdGl2ZS5wbmcnO1xuICAgICAgICAgICAgfVxuICAgICAgICBicmVhaztcbiAgICAgICAgY2FzZSAnYXJtbGV0JzpcbiAgICAgICAgICAgIGlmIChzdGF0ZSA9PSAwKSB7XG4gICAgICAgICAgICAgICAgcmV0dXJuICcvbWVkaWEvaW1hZ2VzL2l0ZW1zLycgKyBkYXRhLml0ZW0gKyAnLnBuZyc7XG4gICAgICAgICAgICB9XG4gICAgICAgICAgICBlbHNlIHtcbiAgICAgICAgICAgICAgICByZXR1cm4gJy9tZWRpYS9pbWFnZXMvaXRlbXMvJyArIGRhdGEuaXRlbSArICdfYWN0aXZlLnBuZyc7XG4gICAgICAgICAgICB9XG4gICAgICAgIGJyZWFrO1xuICAgICAgICBjYXNlICdyaW5nX29mX2FxdWlsYSc6XG4gICAgICAgICAgICBpZiAoc3RhdGUgPT0gMCkge1xuICAgICAgICAgICAgICAgIHJldHVybiAnL21lZGlhL2ltYWdlcy9pdGVtcy8nICsgZGF0YS5pdGVtICsgJ19hY3RpdmUucG5nJztcbiAgICAgICAgICAgIH1cbiAgICAgICAgICAgIGVsc2Uge1xuICAgICAgICAgICAgICAgIHJldHVybiAnL21lZGlhL2ltYWdlcy9pdGVtcy8nICsgZGF0YS5pdGVtICsgJy5wbmcnO1xuICAgICAgICAgICAgfVxuICAgICAgICBicmVhaztcbiAgICAgICAgY2FzZSAnZGFnb24nOlxuICAgICAgICBjYXNlICdkaWZmdXNhbF9ibGFkZSc6XG4gICAgICAgIGNhc2UgJ3RyYXZlbF9ib290cyc6XG4gICAgICAgIGNhc2UgJ25lY3Jvbm9taWNvbic6XG4gICAgICAgICAgICBpZiAoZGF0YS5zaXplID4gMSkge1xuICAgICAgICAgICAgICAgIHJldHVybiAnL21lZGlhL2ltYWdlcy9pdGVtcy8nICsgZGF0YS5pdGVtICsgJ18nICsgZGF0YS5zaXplICsgJy5wbmcnO1xuICAgICAgICAgICAgfVxuICAgICAgICAgICAgZWxzZSB7XG4gICAgICAgICAgICAgICAgcmV0dXJuICcvbWVkaWEvaW1hZ2VzL2l0ZW1zLycgKyBkYXRhLml0ZW0gKyAnLnBuZyc7XG4gICAgICAgICAgICB9XG4gICAgICAgIGJyZWFrO1xuICAgICAgICBkZWZhdWx0OlxuICAgICAgICAgICAgcmV0dXJuICcvbWVkaWEvaW1hZ2VzL2l0ZW1zLycgKyBkYXRhLml0ZW0gKyAnLnBuZyc7ICAgICAgICAgICAgXG4gICAgICAgIGJyZWFrO1xuICAgIH1cbn07XG5CYXNpY0ludmVudG9yeVZpZXdNb2RlbC5wcm90b3R5cGUuZ2V0SXRlbVNpemVMYWJlbCA9IGZ1bmN0aW9uIChkYXRhKSB7XG4gICAgaWYgKHN0YWNrYWJsZUl0ZW1zLmluZGV4T2YoZGF0YS5pdGVtKSAhPSAtMSkge1xuICAgICAgICByZXR1cm4gJzxzcGFuIHN0eWxlPVwiZm9udC1zaXplOjEwcHhcIj5RdHk6IDwvc3Bhbj4nICsgZGF0YS5zaXplO1xuICAgIH1cbiAgICBlbHNlIGlmIChsZXZlbEl0ZW1zLmluZGV4T2YoZGF0YS5pdGVtKSAhPSAtMSkge1xuICAgICAgICByZXR1cm4gJzxzcGFuIHN0eWxlPVwiZm9udC1zaXplOjEwcHhcIj5Mdmw6IDwvc3Bhbj4nICsgZGF0YS5zaXplO1xuICAgIH1cbiAgICBlbHNlIGlmIChkYXRhLml0ZW0gPT0gJ2Jsb29kc3RvbmUnKSB7XG4gICAgICAgIHJldHVybiAnPHNwYW4gc3R5bGU9XCJmb250LXNpemU6MTBweFwiPkNoYXJnZXM6IDwvc3Bhbj4nICsgZGF0YS5zaXplO1xuICAgIH1cbiAgICBlbHNlIHtcbiAgICAgICAgcmV0dXJuICcnO1xuICAgIH1cbn07XG5CYXNpY0ludmVudG9yeVZpZXdNb2RlbC5wcm90b3R5cGUuZ2V0QWN0aXZlQm9yZGVyID0gZnVuY3Rpb24gKGRhdGEpIHtcbiAgICBzd2l0Y2ggKGRhdGEuaXRlbSkge1xuICAgICAgICBjYXNlICdwb3dlcl90cmVhZHMnOlxuICAgICAgICBjYXNlICd0cmFucXVpbF9ib290cyc6XG4gICAgICAgIGNhc2UgJ3Jpbmdfb2ZfYmFzaWxpdXMnOlxuICAgICAgICBjYXNlICdyaW5nX29mX2FxdWlsYSc6XG4gICAgICAgIGNhc2UgJ2FybWxldCc6XG4gICAgICAgICAgICByZXR1cm4gMDtcbiAgICAgICAgYnJlYWs7XG4gICAgICAgIGRlZmF1bHQ6XG4gICAgICAgICAgICByZXR1cm4ga28udXRpbHMudW53cmFwT2JzZXJ2YWJsZShkYXRhLnN0YXRlKTsgICAgXG4gICAgICAgIGJyZWFrO1xuICAgIH1cbn1cbkJhc2ljSW52ZW50b3J5Vmlld01vZGVsLnByb3RvdHlwZS5nZXRJdGVtQXR0cmlidXRlVmFsdWUgPSBmdW5jdGlvbiAoYXR0cmlidXRlcywgYXR0cmlidXRlTmFtZSwgbGV2ZWwpIHtcbiAgICBmb3IgKHZhciBpID0gMDsgaSA8IGF0dHJpYnV0ZXMubGVuZ3RoOyBpKyspIHtcbiAgICAgICAgaWYgKGF0dHJpYnV0ZXNbaV0ubmFtZSA9PSBhdHRyaWJ1dGVOYW1lKSB7XG4gICAgICAgICAgICBpZiAobGV2ZWwgPT0gMCkge1xuICAgICAgICAgICAgICAgIHJldHVybiBwYXJzZUZsb2F0KGF0dHJpYnV0ZXNbaV0udmFsdWVbMF0pO1xuICAgICAgICAgICAgfVxuICAgICAgICAgICAgZWxzZSBpZiAobGV2ZWwgPiBhdHRyaWJ1dGVzW2ldLnZhbHVlLmxlbmd0aCkge1xuICAgICAgICAgICAgICAgIHJldHVybiBwYXJzZUZsb2F0KGF0dHJpYnV0ZXNbaV0udmFsdWVbMF0pO1xuICAgICAgICAgICAgfVxuICAgICAgICAgICAgZWxzZSB7XG4gICAgICAgICAgICAgICAgcmV0dXJuIHBhcnNlRmxvYXQoYXR0cmlidXRlc1tpXS52YWx1ZVtsZXZlbCAtIDFdKTtcbiAgICAgICAgICAgIH1cbiAgICAgICAgfVxuICAgIH1cbn1cblxubW9kdWxlLmV4cG9ydHMgPSBCYXNpY0ludmVudG9yeVZpZXdNb2RlbDsiLCIndXNlIHN0cmljdCc7XG52YXIga28gPSByZXF1aXJlKCcuLi9oZXJvY2FsY19rbm9ja291dCcpO1xuXG52YXIgc3RhY2thYmxlSXRlbXMgPSByZXF1aXJlKFwiLi9zdGFja2FibGVJdGVtc1wiKTtcbnZhciBsZXZlbEl0ZW1zID0gcmVxdWlyZShcIi4vbGV2ZWxJdGVtc1wiKTtcbnZhciBCYXNpY0ludmVudG9yeVZpZXdNb2RlbCA9IHJlcXVpcmUoXCIuL0Jhc2ljSW52ZW50b3J5Vmlld01vZGVsXCIpO1xudmFyIGl0ZW1PcHRpb25zQXJyYXkgPSByZXF1aXJlKFwiLi9pdGVtT3B0aW9uc0FycmF5XCIpO1xudmFyIGl0ZW1CdWZmT3B0aW9ucyA9IHJlcXVpcmUoXCIuL2l0ZW1CdWZmT3B0aW9uc1wiKTtcbnZhciBpdGVtRGVidWZmT3B0aW9ucyA9IHJlcXVpcmUoXCIuL2l0ZW1EZWJ1ZmZPcHRpb25zXCIpO1xuXG52YXIgSW52ZW50b3J5Vmlld01vZGVsID0gZnVuY3Rpb24gKGl0ZW1EYXRhLCBoKSB7XG4gICAgdmFyIHNlbGYgPSB0aGlzO1xuICAgIEJhc2ljSW52ZW50b3J5Vmlld01vZGVsLmNhbGwodGhpcywgaCk7XG4gICAgc2VsZi5oZXJvID0gaDtcbiAgICBzZWxmLmhhc0ludmVudG9yeSA9IGtvLm9ic2VydmFibGUodHJ1ZSk7XG4gICAgc2VsZi5pdGVtcyA9IGtvLm9ic2VydmFibGVBcnJheShbXSk7XG4gICAgc2VsZi5hY3RpdmVJdGVtcyA9IGtvLm9ic2VydmFibGVBcnJheShbXSk7XG4gICAgc2VsZi5oYXNTY2VwdGVyID0ga28uY29tcHV0ZWQoZnVuY3Rpb24gKCkge1xuICAgICAgICBmb3IgKHZhciBpID0gMDsgaSA8IHNlbGYuaXRlbXMoKS5sZW5ndGg7IGkrKykge1xuICAgICAgICAgICAgdmFyIGl0ZW0gPSBzZWxmLml0ZW1zKClbaV0uaXRlbTtcbiAgICAgICAgICAgIGlmIChpdGVtID09PSAndWx0aW1hdGVfc2NlcHRlcicgJiYgc2VsZi5pdGVtcygpW2ldLmVuYWJsZWQoKSkge1xuICAgICAgICAgICAgICAgIHJldHVybiB0cnVlO1xuICAgICAgICAgICAgfVxuICAgICAgICAgICAgXG4gICAgICAgIH1cbiAgICAgICAgcmV0dXJuIGZhbHNlO1xuICAgIH0sIHRoaXMpO1xuICAgIHNlbGYuaXNFdGhlcmVhbCA9IGtvLmNvbXB1dGVkKGZ1bmN0aW9uICgpIHtcbiAgICAgICAgZm9yICh2YXIgaSA9IDA7IGkgPCBzZWxmLml0ZW1zKCkubGVuZ3RoOyBpKyspIHtcbiAgICAgICAgICAgIHZhciBpdGVtID0gc2VsZi5pdGVtcygpW2ldLml0ZW07XG4gICAgICAgICAgICB2YXIgaXNBY3RpdmUgPSBzZWxmLmFjdGl2ZUl0ZW1zLmluZGV4T2Yoc2VsZi5pdGVtcygpW2ldKSA+PSAwID8gdHJ1ZSA6IGZhbHNlO1xuICAgICAgICAgICAgaWYgKChpdGVtID09PSAnZ2hvc3QnIHx8IGl0ZW0gPT09ICdldGhlcmVhbF9ibGFkZScpICYmIHNlbGYuaXRlbXMoKVtpXS5lbmFibGVkKCkgJiYgaXNBY3RpdmUpIHtcbiAgICAgICAgICAgICAgICByZXR1cm4gdHJ1ZTtcbiAgICAgICAgICAgIH1cbiAgICAgICAgfVxuICAgICAgICByZXR1cm4gZmFsc2U7XG4gICAgfSwgdGhpcyk7XG4gICAgc2VsZi5pc1NoZWVwZWQgPSBrby5jb21wdXRlZChmdW5jdGlvbiAoKSB7XG4gICAgICAgIGZvciAodmFyIGkgPSAwOyBpIDwgc2VsZi5pdGVtcygpLmxlbmd0aDsgaSsrKSB7XG4gICAgICAgICAgICB2YXIgaXRlbSA9IHNlbGYuaXRlbXMoKVtpXS5pdGVtO1xuICAgICAgICAgICAgdmFyIGlzQWN0aXZlID0gc2VsZi5hY3RpdmVJdGVtcy5pbmRleE9mKHNlbGYuaXRlbXMoKVtpXSkgPj0gMCA/IHRydWUgOiBmYWxzZTtcbiAgICAgICAgICAgIGlmIChpdGVtID09PSAnc2hlZXBzdGljaycgJiYgc2VsZi5pdGVtcygpW2ldLmVuYWJsZWQoKSAmJiBpc0FjdGl2ZSkge1xuICAgICAgICAgICAgICAgIHJldHVybiB0cnVlO1xuICAgICAgICAgICAgfVxuICAgICAgICB9XG4gICAgICAgIHJldHVybiBmYWxzZTtcbiAgICB9LCB0aGlzKTtcbiAgICBzZWxmLnRvdGFsQ29zdCA9IGtvLmNvbXB1dGVkKGZ1bmN0aW9uICgpIHtcbiAgICAgICAgdmFyIGMgPSAwO1xuICAgICAgICBmb3IgKHZhciBpID0gMDsgaSA8IHNlbGYuaXRlbXMoKS5sZW5ndGg7IGkrKykge1xuICAgICAgICAgICAgdmFyIGl0ZW0gPSBzZWxmLml0ZW1zKClbaV0uaXRlbTtcbiAgICAgICAgICAgIGlmICghc2VsZi5pdGVtcygpW2ldLmVuYWJsZWQoKSkgY29udGludWU7XG4gICAgICAgICAgICBpZiAoc3RhY2thYmxlSXRlbXMuaW5kZXhPZihpdGVtKSAhPSAtMSkge1xuICAgICAgICAgICAgICAgIGMgKz0gaXRlbURhdGFbJ2l0ZW1fJyArIGl0ZW1dLml0ZW1jb3N0ICogc2VsZi5pdGVtcygpW2ldLnNpemU7XG4gICAgICAgICAgICB9XG4gICAgICAgICAgICBlbHNlIGlmIChsZXZlbEl0ZW1zLmluZGV4T2YoaXRlbSkgIT0gLTEpIHtcbiAgICAgICAgICAgICAgICBzd2l0Y2goaXRlbSkge1xuICAgICAgICAgICAgICAgICAgICBjYXNlICdkaWZmdXNhbF9ibGFkZSc6XG4gICAgICAgICAgICAgICAgICAgICAgICBjICs9IGl0ZW1EYXRhWydpdGVtXycgKyBpdGVtXS5pdGVtY29zdCArIChzZWxmLml0ZW1zKClbaV0uc2l6ZSAtIDEpICogNzAwO1xuICAgICAgICAgICAgICAgICAgICBicmVhaztcbiAgICAgICAgICAgICAgICAgICAgY2FzZSAnbmVjcm9ub21pY29uJzpcbiAgICAgICAgICAgICAgICAgICAgY2FzZSAnZGFnb24nOlxuICAgICAgICAgICAgICAgICAgICAgICAgYyArPSBpdGVtRGF0YVsnaXRlbV8nICsgaXRlbV0uaXRlbWNvc3QgKyAoc2VsZi5pdGVtcygpW2ldLnNpemUgLSAxKSAqIDEyNTA7XG4gICAgICAgICAgICAgICAgICAgIGJyZWFrO1xuICAgICAgICAgICAgICAgICAgICBkZWZhdWx0OlxuICAgICAgICAgICAgICAgICAgICAgICAgYyArPSBpdGVtRGF0YVsnaXRlbV8nICsgaXRlbV0uaXRlbWNvc3Q7XG4gICAgICAgICAgICAgICAgICAgIGJyZWFrO1xuICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgIH1cbiAgICAgICAgICAgIGVsc2Uge1xuICAgICAgICAgICAgICAgIGMgKz0gaXRlbURhdGFbJ2l0ZW1fJyArIGl0ZW1dLml0ZW1jb3N0O1xuICAgICAgICAgICAgfVxuICAgICAgICAgICAgXG4gICAgICAgIH1cbiAgICAgICAgcmV0dXJuIGM7XG4gICAgfSwgdGhpcyk7XG4gICAgc2VsZi5hZGRJdGVtQnVmZiA9IGZ1bmN0aW9uIChkYXRhLCBldmVudCkge1xuICAgICAgICBpZiAoc2VsZi5oYXNJbnZlbnRvcnkoKSAmJiBzZWxmLnNlbGVjdGVkSXRlbUJ1ZmYoKSAhPSB1bmRlZmluZWQpIHtcbiAgICAgICAgICAgIHZhciBuZXdfaXRlbSA9IHtcbiAgICAgICAgICAgICAgICBpdGVtOiBzZWxmLnNlbGVjdGVkSXRlbUJ1ZmYoKSxcbiAgICAgICAgICAgICAgICBzdGF0ZToga28ub2JzZXJ2YWJsZSgwKSxcbiAgICAgICAgICAgICAgICBzaXplOiAxLFxuICAgICAgICAgICAgICAgIGVuYWJsZWQ6IGtvLm9ic2VydmFibGUodHJ1ZSlcbiAgICAgICAgICAgIH1cbiAgICAgICAgICAgIHNlbGYuaXRlbXMucHVzaChuZXdfaXRlbSk7XG4gICAgICAgICAgICBpZiAoc2VsZi5zZWxlY3RlZEl0ZW1CdWZmKCkgPT09ICdyaW5nX29mX2FxdWlsYScgfHwgc2VsZi5zZWxlY3RlZEl0ZW1CdWZmKCkgPT09ICdyaW5nX29mX2Jhc2lsaXVzJykge1xuICAgICAgICAgICAgICAgIHNlbGYudG9nZ2xlSXRlbSh1bmRlZmluZWQsIG5ld19pdGVtLCB1bmRlZmluZWQpO1xuICAgICAgICAgICAgfVxuICAgICAgICB9XG4gICAgfTtcbiAgICBzZWxmLmFkZEl0ZW1EZWJ1ZmYgPSBmdW5jdGlvbiAoZGF0YSwgZXZlbnQpIHtcbiAgICAgICAgaWYgKHNlbGYuaGFzSW52ZW50b3J5KCkgJiYgc2VsZi5zZWxlY3RlZEl0ZW1EZWJ1ZmYoKSAhPSB1bmRlZmluZWQpIHtcbiAgICAgICAgICAgIHZhciBuZXdfaXRlbSA9IHtcbiAgICAgICAgICAgICAgICBpdGVtOiBzZWxmLnNlbGVjdGVkSXRlbURlYnVmZigpLnNwbGl0KCd8JylbMF0sXG4gICAgICAgICAgICAgICAgc3RhdGU6IGtvLm9ic2VydmFibGUoMCksXG4gICAgICAgICAgICAgICAgc2l6ZTogMSxcbiAgICAgICAgICAgICAgICBlbmFibGVkOiBrby5vYnNlcnZhYmxlKHRydWUpXG4gICAgICAgICAgICB9XG4gICAgICAgICAgICBpZiAoc2VsZi5zZWxlY3RlZEl0ZW1EZWJ1ZmYoKS5zcGxpdCgnfCcpLmxlbmd0aCA9PSAyKSB7XG4gICAgICAgICAgICAgICAgbmV3X2l0ZW0uZGVidWZmID0gc2VsZi5zZWxlY3RlZEl0ZW1EZWJ1ZmYoKS5zcGxpdCgnfCcpWzFdXG4gICAgICAgICAgICB9XG4gICAgICAgICAgICBzZWxmLml0ZW1zLnB1c2gobmV3X2l0ZW0pO1xuICAgICAgICAgICAgaWYgKHNlbGYuc2VsZWN0ZWRJdGVtRGVidWZmKCkgPT09ICdyaW5nX29mX2FxdWlsYScgfHwgc2VsZi5zZWxlY3RlZEl0ZW1EZWJ1ZmYoKSA9PT0gJ3Jpbmdfb2ZfYmFzaWxpdXMnKSB7XG4gICAgICAgICAgICAgICAgc2VsZi50b2dnbGVJdGVtKHVuZGVmaW5lZCwgbmV3X2l0ZW0sIHVuZGVmaW5lZCk7XG4gICAgICAgICAgICB9XG4gICAgICAgIH1cbiAgICB9O1xuICAgIFxuICAgIHNlbGYuZ2V0QXR0cmlidXRlcyA9IGZ1bmN0aW9uIChhdHRyaWJ1dGV0eXBlKSB7XG4gICAgICAgIHZhciB0b3RhbEF0dHJpYnV0ZSA9IDA7XG4gICAgICAgIGZvciAodmFyIGkgPSAwOyBpIDwgc2VsZi5pdGVtcygpLmxlbmd0aDsgaSsrKSB7XG4gICAgICAgICAgICB2YXIgaXRlbSA9IHNlbGYuaXRlbXMoKVtpXS5pdGVtO1xuICAgICAgICAgICAgdmFyIGlzQWN0aXZlID0gc2VsZi5hY3RpdmVJdGVtcy5pbmRleE9mKHNlbGYuaXRlbXMoKVtpXSkgPj0gMCA/IHRydWUgOiBmYWxzZTtcbiAgICAgICAgICAgIGlmICghc2VsZi5pdGVtcygpW2ldLmVuYWJsZWQoKSkgY29udGludWU7XG4gICAgICAgICAgICB2YXIgc2l6ZSA9IHNlbGYuaXRlbXMoKVtpXS5zaXplO1xuICAgICAgICAgICAgZm9yICh2YXIgaiA9IDA7IGogPCBpdGVtRGF0YVsnaXRlbV8nICsgaXRlbV0uYXR0cmlidXRlcy5sZW5ndGg7IGorKykge1xuICAgICAgICAgICAgICAgIHZhciBhdHRyaWJ1dGUgPSBpdGVtRGF0YVsnaXRlbV8nICsgaXRlbV0uYXR0cmlidXRlc1tqXTtcbiAgICAgICAgICAgICAgICBzd2l0Y2goYXR0cmlidXRlLm5hbWUpIHtcbiAgICAgICAgICAgICAgICAgICAgY2FzZSAnYm9udXNfYWxsX3N0YXRzJzpcbiAgICAgICAgICAgICAgICAgICAgICAgIHRvdGFsQXR0cmlidXRlICs9IHBhcnNlSW50KGF0dHJpYnV0ZS52YWx1ZVswXSk7XG4gICAgICAgICAgICAgICAgICAgIGJyZWFrO1xuICAgICAgICAgICAgICAgICAgICBjYXNlICdib251c19zdGF0cyc6XG4gICAgICAgICAgICAgICAgICAgICAgICB0b3RhbEF0dHJpYnV0ZSArPSBwYXJzZUludChhdHRyaWJ1dGUudmFsdWVbMF0pO1xuICAgICAgICAgICAgICAgICAgICBicmVhaztcbiAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgICAgc3dpdGNoKGF0dHJpYnV0ZXR5cGUpIHtcbiAgICAgICAgICAgICAgICAgICAgY2FzZSAnYWdpJzpcbiAgICAgICAgICAgICAgICAgICAgICAgIGlmIChhdHRyaWJ1dGUubmFtZSA9PSAnYm9udXNfYWdpbGl0eScpIHtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICBpZiAoaXRlbSA9PSAnZGlmZnVzYWxfYmxhZGUnKSB7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIHRvdGFsQXR0cmlidXRlICs9IHBhcnNlSW50KGF0dHJpYnV0ZS52YWx1ZVtzaXplLTFdKTtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgZWxzZSB7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIHRvdGFsQXR0cmlidXRlICs9IHBhcnNlSW50KGF0dHJpYnV0ZS52YWx1ZVswXSk7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICAgICAgICAgICAgaWYgKGF0dHJpYnV0ZS5uYW1lID09ICdib251c19zdGF0JyAmJiBzZWxmLml0ZW1zKClbaV0uc3RhdGUoKSA9PSAyKSB7dG90YWxBdHRyaWJ1dGUgKz0gcGFyc2VJbnQoYXR0cmlidXRlLnZhbHVlWzBdKTt9O1xuICAgICAgICAgICAgICAgICAgICAgICAgaWYgKGF0dHJpYnV0ZS5uYW1lID09ICdib251c19hZ2knKSB7dG90YWxBdHRyaWJ1dGUgKz0gcGFyc2VJbnQoYXR0cmlidXRlLnZhbHVlWzBdKTt9O1xuICAgICAgICAgICAgICAgICAgICBicmVhaztcbiAgICAgICAgICAgICAgICAgICAgY2FzZSAnaW50JzpcbiAgICAgICAgICAgICAgICAgICAgICAgIGlmIChhdHRyaWJ1dGUubmFtZSA9PSAnYm9udXNfaW50ZWxsZWN0Jykge1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgIGlmIChpdGVtID09ICduZWNyb25vbWljb24nKSB7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIHRvdGFsQXR0cmlidXRlICs9IHBhcnNlSW50KGF0dHJpYnV0ZS52YWx1ZVtzaXplLTFdKTtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgZWxzZSBpZiAoaXRlbSA9PSAnZGlmZnVzYWxfYmxhZGUnKSB7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIHRvdGFsQXR0cmlidXRlICs9IHBhcnNlSW50KGF0dHJpYnV0ZS52YWx1ZVtzaXplLTFdKTtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgZWxzZSBpZiAoaXRlbSA9PSAnZGFnb24nKSB7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIHRvdGFsQXR0cmlidXRlICs9IHBhcnNlSW50KGF0dHJpYnV0ZS52YWx1ZVtzaXplLTFdKTtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgZWxzZSB7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIHRvdGFsQXR0cmlidXRlICs9IHBhcnNlSW50KGF0dHJpYnV0ZS52YWx1ZVswXSk7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICAgICAgICAgICAgaWYgKGF0dHJpYnV0ZS5uYW1lID09ICdib251c19pbnRlbGxpZ2VuY2UnKSB7dG90YWxBdHRyaWJ1dGUgKz0gcGFyc2VJbnQoYXR0cmlidXRlLnZhbHVlWzBdKTt9O1xuICAgICAgICAgICAgICAgICAgICAgICAgaWYgKGF0dHJpYnV0ZS5uYW1lID09ICdib251c19pbnQnKSB7dG90YWxBdHRyaWJ1dGUgKz0gcGFyc2VJbnQoYXR0cmlidXRlLnZhbHVlWzBdKTt9O1xuICAgICAgICAgICAgICAgICAgICAgICAgaWYgKGF0dHJpYnV0ZS5uYW1lID09ICdib251c19zdGF0JyAmJiBzZWxmLml0ZW1zKClbaV0uc3RhdGUoKSA9PSAxKSB7dG90YWxBdHRyaWJ1dGUgKz0gcGFyc2VJbnQoYXR0cmlidXRlLnZhbHVlWzBdKTt9O1xuICAgICAgICAgICAgICAgICAgICBicmVhaztcbiAgICAgICAgICAgICAgICAgICAgY2FzZSAnc3RyJzpcbiAgICAgICAgICAgICAgICAgICAgICAgIGlmIChhdHRyaWJ1dGUubmFtZSA9PSAnYm9udXNfc3RyZW5ndGgnKSB7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgaWYgKGl0ZW0gPT0gJ25lY3Jvbm9taWNvbicpIHtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgdG90YWxBdHRyaWJ1dGUgKz0gcGFyc2VJbnQoYXR0cmlidXRlLnZhbHVlW3NpemUtMV0pO1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgICAgICAgICAgICAgICBlbHNlIHtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgdG90YWxBdHRyaWJ1dGUgKz0gcGFyc2VJbnQoYXR0cmlidXRlLnZhbHVlWzBdKTtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgICAgICAgICAgICBpZiAoYXR0cmlidXRlLm5hbWUgPT0gJ2JvbnVzX3N0YXQnICYmIHNlbGYuaXRlbXMoKVtpXS5zdGF0ZSgpID09IDApIHt0b3RhbEF0dHJpYnV0ZSArPSBwYXJzZUludChhdHRyaWJ1dGUudmFsdWVbMF0pO307XG4gICAgICAgICAgICAgICAgICAgICAgICBpZiAoYXR0cmlidXRlLm5hbWUgPT0gJ2JvbnVzX3N0cicpIHt0b3RhbEF0dHJpYnV0ZSArPSBwYXJzZUludChhdHRyaWJ1dGUudmFsdWVbMF0pO307XG4gICAgICAgICAgICAgICAgICAgICAgICBpZiAoYXR0cmlidXRlLm5hbWUgPT0gJ3VuaG9seV9ib251c19zdHJlbmd0aCcgJiYgaXNBY3RpdmUpIHt0b3RhbEF0dHJpYnV0ZSArPSBwYXJzZUludChhdHRyaWJ1dGUudmFsdWVbMF0pO307XG4gICAgICAgICAgICAgICAgICAgIGJyZWFrO1xuICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgIH1cbiAgICAgICAgfVxuICAgICAgICByZXR1cm4gdG90YWxBdHRyaWJ1dGU7XG4gICAgfTtcbiAgICBzZWxmLmdldEJhc2ggPSBmdW5jdGlvbiAoYXR0YWNrdHlwZSkge1xuICAgICAgICB2YXIgdG90YWxBdHRyaWJ1dGUgPSAxO1xuICAgICAgICBmb3IgKHZhciBpID0gMDsgaSA8IHNlbGYuaXRlbXMoKS5sZW5ndGg7IGkrKykge1xuICAgICAgICAgICAgdmFyIGl0ZW0gPSBzZWxmLml0ZW1zKClbaV0uaXRlbTtcbiAgICAgICAgICAgIGlmICghc2VsZi5pdGVtcygpW2ldLmVuYWJsZWQoKSkgY29udGludWU7XG4gICAgICAgICAgICBmb3IgKHZhciBqID0gMDsgaiA8IGl0ZW1EYXRhWydpdGVtXycgKyBpdGVtXS5hdHRyaWJ1dGVzLmxlbmd0aDsgaisrKSB7XG4gICAgICAgICAgICAgICAgdmFyIGF0dHJpYnV0ZSA9IGl0ZW1EYXRhWydpdGVtXycgKyBpdGVtXS5hdHRyaWJ1dGVzW2pdO1xuICAgICAgICAgICAgICAgIHN3aXRjaChhdHRyaWJ1dGUubmFtZSkge1xuICAgICAgICAgICAgICAgICAgICBjYXNlICdiYXNoX2NoYW5jZSc6XG4gICAgICAgICAgICAgICAgICAgICAgICB0b3RhbEF0dHJpYnV0ZSAqPSAoMSAtIHBhcnNlSW50KGF0dHJpYnV0ZS52YWx1ZVswXSkgLyAxMDApO1xuICAgICAgICAgICAgICAgICAgICBicmVhaztcbiAgICAgICAgICAgICAgICAgICAgY2FzZSAnYmFzaF9jaGFuY2VfbWVsZWUnOlxuICAgICAgICAgICAgICAgICAgICAgICAgaWYgKGF0dGFja3R5cGUgPT0gJ0RPVEFfVU5JVF9DQVBfTUVMRUVfQVRUQUNLJykgeyB0b3RhbEF0dHJpYnV0ZSAqPSAoMSAtIHBhcnNlSW50KGF0dHJpYnV0ZS52YWx1ZVswXSkgLyAxMDApOyB9O1xuICAgICAgICAgICAgICAgICAgICBicmVhaztcbiAgICAgICAgICAgICAgICAgICAgY2FzZSAnYmFzaF9jaGFuY2VfcmFuZ2VkJzpcbiAgICAgICAgICAgICAgICAgICAgICAgIGlmIChhdHRhY2t0eXBlID09ICdET1RBX1VOSVRfQ0FQX1JBTkdFRF9BVFRBQ0snKSB7IHRvdGFsQXR0cmlidXRlICo9ICgxIC0gcGFyc2VJbnQoYXR0cmlidXRlLnZhbHVlWzBdKSAvIDEwMCk7IH07XG4gICAgICAgICAgICAgICAgICAgIGJyZWFrO1xuICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgIH1cbiAgICAgICAgfVxuICAgICAgICByZXR1cm4gdG90YWxBdHRyaWJ1dGU7XG4gICAgfTtcbiAgICBcbiAgICBzZWxmLmdldENyaXRDaGFuY2UgPSBmdW5jdGlvbiAoKSB7XG4gICAgICAgIHZhciB0b3RhbEF0dHJpYnV0ZSA9IDE7XG4gICAgICAgIGZvciAodmFyIGkgPSAwOyBpIDwgc2VsZi5pdGVtcygpLmxlbmd0aDsgaSsrKSB7XG4gICAgICAgICAgICB2YXIgaXRlbSA9IHNlbGYuaXRlbXMoKVtpXS5pdGVtO1xuICAgICAgICAgICAgdmFyIGlzQWN0aXZlID0gc2VsZi5hY3RpdmVJdGVtcy5pbmRleE9mKHNlbGYuaXRlbXMoKVtpXSkgPj0gMCA/IHRydWUgOiBmYWxzZTtcbiAgICAgICAgICAgIGlmICghc2VsZi5pdGVtcygpW2ldLmVuYWJsZWQoKSkgY29udGludWU7XG4gICAgICAgICAgICBmb3IgKHZhciBqID0gMDsgaiA8IGl0ZW1EYXRhWydpdGVtXycgKyBpdGVtXS5hdHRyaWJ1dGVzLmxlbmd0aDsgaisrKSB7XG4gICAgICAgICAgICAgICAgdmFyIGF0dHJpYnV0ZSA9IGl0ZW1EYXRhWydpdGVtXycgKyBpdGVtXS5hdHRyaWJ1dGVzW2pdO1xuICAgICAgICAgICAgICAgIHN3aXRjaChhdHRyaWJ1dGUubmFtZSkge1xuICAgICAgICAgICAgICAgICAgICBjYXNlICdjcml0X2NoYW5jZSc6XG4gICAgICAgICAgICAgICAgICAgICAgICB0b3RhbEF0dHJpYnV0ZSAqPSAoMSAtIHBhcnNlSW50KGF0dHJpYnV0ZS52YWx1ZVswXSkgLyAxMDApO1xuICAgICAgICAgICAgICAgICAgICBicmVhaztcbiAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICB9XG4gICAgICAgIH1cbiAgICAgICAgcmV0dXJuIHRvdGFsQXR0cmlidXRlO1xuICAgIH07XG4gICAgXG4gICAgc2VsZi5nZXRDcml0U291cmNlID0gZnVuY3Rpb24gKCkge1xuICAgICAgICB2YXIgc291cmNlcyA9IHt9O1xuICAgICAgICBmb3IgKHZhciBpID0gMDsgaSA8IHNlbGYuaXRlbXMoKS5sZW5ndGg7IGkrKykge1xuICAgICAgICAgICAgdmFyIGl0ZW0gPSBzZWxmLml0ZW1zKClbaV0uaXRlbTtcbiAgICAgICAgICAgIHZhciBpc0FjdGl2ZSA9IHNlbGYuYWN0aXZlSXRlbXMuaW5kZXhPZihzZWxmLml0ZW1zKClbaV0pID49IDAgPyB0cnVlIDogZmFsc2U7XG4gICAgICAgICAgICBpZiAoIXNlbGYuaXRlbXMoKVtpXS5lbmFibGVkKCkpIGNvbnRpbnVlO1xuICAgICAgICAgICAgc3dpdGNoIChpdGVtKSB7XG4gICAgICAgICAgICAgICAgY2FzZSAnbGVzc2VyX2NyaXQnOlxuICAgICAgICAgICAgICAgIGNhc2UgJ2dyZWF0ZXJfY3JpdCc6XG4gICAgICAgICAgICAgICAgY2FzZSAnYmxvb2R0aG9ybic6XG4gICAgICAgICAgICAgICAgICAgIGlmIChzb3VyY2VzW2l0ZW1dID09IHVuZGVmaW5lZCkge1xuICAgICAgICAgICAgICAgICAgICAgICAgc291cmNlc1tpdGVtXSA9IHtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAnY2hhbmNlJzogc2VsZi5nZXRJdGVtQXR0cmlidXRlVmFsdWUoaXRlbURhdGFbJ2l0ZW1fJyArIGl0ZW1dLmF0dHJpYnV0ZXMsICdjcml0X2NoYW5jZScsIDApIC8gMTAwLFxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICdtdWx0aXBsaWVyJzogc2VsZi5nZXRJdGVtQXR0cmlidXRlVmFsdWUoaXRlbURhdGFbJ2l0ZW1fJyArIGl0ZW1dLmF0dHJpYnV0ZXMsICdjcml0X211bHRpcGxpZXInLCAwKSAvIDEwMCxcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAnY291bnQnOiAxLFxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICdkaXNwbGF5bmFtZSc6IGl0ZW1EYXRhWydpdGVtXycgKyBpdGVtXS5kaXNwbGF5bmFtZVxuICAgICAgICAgICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgICAgICAgIGVsc2Uge1xuICAgICAgICAgICAgICAgICAgICAgICAgc291cmNlc1tpdGVtXS5jb3VudCArPSAxO1xuICAgICAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgICAgYnJlYWs7XG4gICAgICAgICAgICB9XG4gICAgICAgICAgICBpZiAoaXRlbSA9PT0gJ2Jsb29kdGhvcm4nICYmIGlzQWN0aXZlKSB7XG4gICAgICAgICAgICAgICAgaWYgKHNvdXJjZXNbJ3NvdWxfcmVuZCddID09IHVuZGVmaW5lZCkge1xuICAgICAgICAgICAgICAgICAgICBzb3VyY2VzWydzb3VsX3JlbmQnXSA9IHtcbiAgICAgICAgICAgICAgICAgICAgICAgICdjaGFuY2UnOiAxLFxuICAgICAgICAgICAgICAgICAgICAgICAgJ211bHRpcGxpZXInOiBzZWxmLmdldEl0ZW1BdHRyaWJ1dGVWYWx1ZShpdGVtRGF0YVsnaXRlbV8nICsgaXRlbV0uYXR0cmlidXRlcywgJ3RhcmdldF9jcml0X211bHRpcGxpZXInLCAwKSAvIDEwMCxcbiAgICAgICAgICAgICAgICAgICAgICAgICdjb3VudCc6IDEsXG4gICAgICAgICAgICAgICAgICAgICAgICAnZGlzcGxheW5hbWUnOiAnU291bCBSZW5kJ1xuICAgICAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICAgIGVsc2Uge1xuICAgICAgICAgICAgICAgICAgICBzb3VyY2VzWydzb3VsX3JlbmQnXS5jb3VudCArPSAxO1xuICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgIH1cbiAgICAgICAgfVxuICAgICAgICByZXR1cm4gc291cmNlcztcbiAgICB9O1xuXG4gICAgc2VsZi5nZXRDbGVhdmVTb3VyY2UgPSBmdW5jdGlvbiAoKSB7XG4gICAgICAgIHZhciBzb3VyY2VzID0ge307XG4gICAgICAgIGZvciAodmFyIGkgPSAwOyBpIDwgc2VsZi5pdGVtcygpLmxlbmd0aDsgaSsrKSB7XG4gICAgICAgICAgICB2YXIgaXRlbSA9IHNlbGYuaXRlbXMoKVtpXS5pdGVtO1xuICAgICAgICAgICAgdmFyIGlzQWN0aXZlID0gc2VsZi5hY3RpdmVJdGVtcy5pbmRleE9mKHNlbGYuaXRlbXMoKVtpXSkgPj0gMCA/IHRydWUgOiBmYWxzZTtcbiAgICAgICAgICAgIGlmICghc2VsZi5pdGVtcygpW2ldLmVuYWJsZWQoKSkgY29udGludWU7XG4gICAgICAgICAgICBzd2l0Y2ggKGl0ZW0pIHtcbiAgICAgICAgICAgICAgICBjYXNlICdiZnVyeSc6XG4gICAgICAgICAgICAgICAgICAgIGlmIChzb3VyY2VzW2l0ZW1dID09IHVuZGVmaW5lZCkge1xuICAgICAgICAgICAgICAgICAgICAgICAgc291cmNlc1tpdGVtXSA9IHtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAncmFkaXVzJzogc2VsZi5nZXRJdGVtQXR0cmlidXRlVmFsdWUoaXRlbURhdGFbJ2l0ZW1fJyArIGl0ZW1dLmF0dHJpYnV0ZXMsICdjbGVhdmVfcmFkaXVzJywgMCksXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgJ21hZ25pdHVkZSc6IHNlbGYuZ2V0SXRlbUF0dHJpYnV0ZVZhbHVlKGl0ZW1EYXRhWydpdGVtXycgKyBpdGVtXS5hdHRyaWJ1dGVzLCAnY2xlYXZlX2RhbWFnZV9wZXJjZW50JywgMCkgLyAxMDAsXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgJ2NvdW50JzogMSxcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAnZGlzcGxheW5hbWUnOiBpdGVtRGF0YVsnaXRlbV8nICsgaXRlbV0uZGlzcGxheW5hbWVcbiAgICAgICAgICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICAgICAgICBlbHNlIHtcbiAgICAgICAgICAgICAgICAgICAgICAgIHNvdXJjZXNbaXRlbV0uY291bnQgKz0gMTtcbiAgICAgICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICAgIGJyZWFrO1xuICAgICAgICAgICAgfVxuXG4gICAgICAgIH1cbiAgICAgICAgcmV0dXJuIHNvdXJjZXM7XG4gICAgfTtcbiAgICBcbiAgICBzZWxmLmdldEJhc2hTb3VyY2UgPSBmdW5jdGlvbiAoYXR0YWNrdHlwZSkge1xuICAgICAgICB2YXIgc291cmNlcyA9IHt9O1xuICAgICAgICBmb3IgKHZhciBpID0gMDsgaSA8IHNlbGYuaXRlbXMoKS5sZW5ndGg7IGkrKykge1xuICAgICAgICAgICAgdmFyIGl0ZW0gPSBzZWxmLml0ZW1zKClbaV0uaXRlbTtcbiAgICAgICAgICAgIHZhciBpc0FjdGl2ZSA9IHNlbGYuYWN0aXZlSXRlbXMuaW5kZXhPZihzZWxmLml0ZW1zKClbaV0pID49IDAgPyB0cnVlIDogZmFsc2U7XG4gICAgICAgICAgICBpZiAoIXNlbGYuaXRlbXMoKVtpXS5lbmFibGVkKCkpIGNvbnRpbnVlO1xuICAgICAgICAgICAgc3dpdGNoIChpdGVtKSB7XG4gICAgICAgICAgICAgICAgY2FzZSAnamF2ZWxpbic6XG4gICAgICAgICAgICAgICAgICAgIGlmIChzb3VyY2VzW2l0ZW1dID09IHVuZGVmaW5lZCkge1xuICAgICAgICAgICAgICAgICAgICAgICAgc291cmNlc1tpdGVtXSA9IHtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAnZGFtYWdlJzogc2VsZi5nZXRJdGVtQXR0cmlidXRlVmFsdWUoaXRlbURhdGFbJ2l0ZW1fJyArIGl0ZW1dLmF0dHJpYnV0ZXMsICdib251c19jaGFuY2VfZGFtYWdlJywgMSksXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgJ2RhbWFnZVR5cGUnOiAnbWFnaWMnLFxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICdjb3VudCc6IDEsXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgJ2NoYW5jZSc6IHNlbGYuZ2V0SXRlbUF0dHJpYnV0ZVZhbHVlKGl0ZW1EYXRhWydpdGVtXycgKyBpdGVtXS5hdHRyaWJ1dGVzLCAnYm9udXNfY2hhbmNlJywgMSkgLyAxMDAsXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgJ2Rpc3BsYXluYW1lJzogaXRlbURhdGFbJ2l0ZW1fJyArIGl0ZW1dLmRpc3BsYXluYW1lICsgJyBQaWVyY2UnXG4gICAgICAgICAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgICAgICAgZWxzZSB7XG4gICAgICAgICAgICAgICAgICAgICAgICBzb3VyY2VzW2l0ZW1dLmNvdW50ICs9IDE7XG4gICAgICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgICBicmVhaztcbiAgICAgICAgICAgICAgICBjYXNlICdtb25rZXlfa2luZ19iYXInOlxuICAgICAgICAgICAgICAgICAgICBpZiAoc291cmNlc1tpdGVtXSA9PSB1bmRlZmluZWQpIHtcbiAgICAgICAgICAgICAgICAgICAgICAgIHNvdXJjZXNbaXRlbV0gPSB7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgJ2l0ZW0nOiBpdGVtLFxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICdjaGFuY2UnOiBzZWxmLmdldEl0ZW1BdHRyaWJ1dGVWYWx1ZShpdGVtRGF0YVsnaXRlbV8nICsgaXRlbV0uYXR0cmlidXRlcywgJ2Jhc2hfY2hhbmNlJywgMCkgLyAxMDAsXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgJ2RhbWFnZSc6IHNlbGYuZ2V0SXRlbUF0dHJpYnV0ZVZhbHVlKGl0ZW1EYXRhWydpdGVtXycgKyBpdGVtXS5hdHRyaWJ1dGVzLCAnYmFzaF9kYW1hZ2UnLCAwKSxcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAnZHVyYXRpb24nOiBzZWxmLmdldEl0ZW1BdHRyaWJ1dGVWYWx1ZShpdGVtRGF0YVsnaXRlbV8nICsgaXRlbV0uYXR0cmlidXRlcywgJ2Jhc2hfc3R1bicsIDApLFxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICdjb3VudCc6IDEsXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgJ2RhbWFnZVR5cGUnOiAnbWFnaWMnLFxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICdkaXNwbGF5bmFtZSc6ICdNaW5pLUJhc2gnIC8vaXRlbURhdGFbJ2l0ZW1fJyArIGl0ZW1dLmRpc3BsYXluYW1lXG4gICAgICAgICAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgICAgICAgZWxzZSB7XG4gICAgICAgICAgICAgICAgICAgICAgICBzb3VyY2VzW2l0ZW1dLmNvdW50ICs9IDE7XG4gICAgICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgICBicmVhaztcbiAgICAgICAgICAgICAgICBjYXNlICdhYnlzc2FsX2JsYWRlJzpcbiAgICAgICAgICAgICAgICBjYXNlICdiYXNoZXInOlxuICAgICAgICAgICAgICAgICAgICBpZiAoIXNvdXJjZXMuaGFzT3duUHJvcGVydHkoJ2Jhc2gnKSkge1xuICAgICAgICAgICAgICAgICAgICAgICAgc291cmNlc1snYmFzaCddID0ge1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgICdpdGVtJzogaXRlbSxcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAnY2hhbmNlJzogc2VsZi5nZXRJdGVtQXR0cmlidXRlVmFsdWUoaXRlbURhdGFbJ2l0ZW1fJyArIGl0ZW1dLmF0dHJpYnV0ZXMsIChhdHRhY2t0eXBlID09ICdET1RBX1VOSVRfQ0FQX01FTEVFX0FUVEFDSycpID8nYmFzaF9jaGFuY2VfbWVsZWUnIDogJ2Jhc2hfY2hhbmNlX3JhbmdlZCcsIDApIC8gMTAwLFxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICdkYW1hZ2UnOiBzZWxmLmdldEl0ZW1BdHRyaWJ1dGVWYWx1ZShpdGVtRGF0YVsnaXRlbV8nICsgaXRlbV0uYXR0cmlidXRlcywgJ2JvbnVzX2NoYW5jZV9kYW1hZ2UnLCAwKSxcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAnZHVyYXRpb24nOiBzZWxmLmdldEl0ZW1BdHRyaWJ1dGVWYWx1ZShpdGVtRGF0YVsnaXRlbV8nICsgaXRlbV0uYXR0cmlidXRlcywgJ2Jhc2hfZHVyYXRpb24nLCAwKSxcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAnY291bnQnOiAxLFxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICdkYW1hZ2VUeXBlJzogJ3BoeXNpY2FsJyxcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAnZGlzcGxheW5hbWUnOiAnQmFzaCcgLy9pdGVtRGF0YVsnaXRlbV8nICsgaXRlbV0uZGlzcGxheW5hbWVcbiAgICAgICAgICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICAgICAgICBlbHNlIHtcbiAgICAgICAgICAgICAgICAgICAgICAgIC8vc291cmNlc1tpdGVtXS5jb3VudCArPSAxO1xuICAgICAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgICAgYnJlYWs7XG4gICAgICAgICAgICB9XG5cbiAgICAgICAgfVxuICAgICAgICByZXR1cm4gc291cmNlcztcbiAgICB9O1xuICAgIFxuICAgIHNlbGYuZ2V0T3JiUHJvY1NvdXJjZSA9IGZ1bmN0aW9uICgpIHtcbiAgICAgICAgdmFyIHNvdXJjZXMgPSB7fTtcbiAgICAgICAgZm9yICh2YXIgaSA9IDA7IGkgPCBzZWxmLml0ZW1zKCkubGVuZ3RoOyBpKyspIHtcbiAgICAgICAgICAgIHZhciBpdGVtID0gc2VsZi5pdGVtcygpW2ldLml0ZW07XG4gICAgICAgICAgICB2YXIgaXNBY3RpdmUgPSBzZWxmLmFjdGl2ZUl0ZW1zLmluZGV4T2Yoc2VsZi5pdGVtcygpW2ldKSA+PSAwID8gdHJ1ZSA6IGZhbHNlO1xuICAgICAgICAgICAgaWYgKCFzZWxmLml0ZW1zKClbaV0uZW5hYmxlZCgpKSBjb250aW51ZTtcbiAgICAgICAgICAgIHN3aXRjaCAoaXRlbSkge1xuICAgICAgICAgICAgICAgIGNhc2UgJ21hZWxzdHJvbSc6XG4gICAgICAgICAgICAgICAgY2FzZSAnbWpvbGxuaXInOlxuICAgICAgICAgICAgICAgICAgICBpZiAoc291cmNlc1tpdGVtXSA9PSB1bmRlZmluZWQpIHtcbiAgICAgICAgICAgICAgICAgICAgICAgIHNvdXJjZXNbaXRlbV0gPSB7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgJ2NoYW5jZSc6IHNlbGYuZ2V0SXRlbUF0dHJpYnV0ZVZhbHVlKGl0ZW1EYXRhWydpdGVtXycgKyBpdGVtXS5hdHRyaWJ1dGVzLCAnY2hhaW5fY2hhbmNlJywgMCkgLyAxMDAsXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgJ2RhbWFnZSc6IHNlbGYuZ2V0SXRlbUF0dHJpYnV0ZVZhbHVlKGl0ZW1EYXRhWydpdGVtXycgKyBpdGVtXS5hdHRyaWJ1dGVzLCAnY2hhaW5fZGFtYWdlJywgMCksXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgJ2NvdW50JzogMSxcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAnZGFtYWdlVHlwZSc6ICdtYWdpYycsXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgJ2Rpc3BsYXluYW1lJzogaXRlbURhdGFbJ2l0ZW1fJyArIGl0ZW1dLmRpc3BsYXluYW1lXG4gICAgICAgICAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgICAgICAgZWxzZSB7XG4gICAgICAgICAgICAgICAgICAgICAgICBzb3VyY2VzW2l0ZW1dLmNvdW50ICs9IDE7XG4gICAgICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgICBicmVhaztcbiAgICAgICAgICAgIH1cblxuICAgICAgICB9XG4gICAgICAgIHJldHVybiBzb3VyY2VzO1xuICAgIH07XG5cbiAgICBzZWxmLmdldE9yYlNvdXJjZSA9IGZ1bmN0aW9uICgpIHtcbiAgICAgICAgdmFyIHNvdXJjZXMgPSB7fTtcbiAgICAgICAgZm9yICh2YXIgaSA9IDA7IGkgPCBzZWxmLml0ZW1zKCkubGVuZ3RoOyBpKyspIHtcbiAgICAgICAgICAgIHZhciBpdGVtID0gc2VsZi5pdGVtcygpW2ldLml0ZW07XG4gICAgICAgICAgICB2YXIgaXNBY3RpdmUgPSBzZWxmLmFjdGl2ZUl0ZW1zLmluZGV4T2Yoc2VsZi5pdGVtcygpW2ldKSA+PSAwID8gdHJ1ZSA6IGZhbHNlO1xuICAgICAgICAgICAgaWYgKCFzZWxmLml0ZW1zKClbaV0uZW5hYmxlZCgpKSBjb250aW51ZTtcbiAgICAgICAgICAgIHN3aXRjaCAoaXRlbSkge1xuICAgICAgICAgICAgICAgIGNhc2UgJ2RpZmZ1c2FsX2JsYWRlJzpcbiAgICAgICAgICAgICAgICAgICAgaWYgKHNvdXJjZXNbaXRlbV0gPT0gdW5kZWZpbmVkKSB7XG4gICAgICAgICAgICAgICAgICAgICAgICBzb3VyY2VzW2l0ZW1dID0ge1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgICdjaGFuY2UnOiAxLFxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICdkYW1hZ2UnOiBzZWxmLmdldEl0ZW1BdHRyaWJ1dGVWYWx1ZShpdGVtRGF0YVsnaXRlbV8nICsgaXRlbV0uYXR0cmlidXRlcywgJ2ZlZWRiYWNrX21hbmFfYnVybicsIHNlbGYuaXRlbXMoKVtpXS5zaXplKSxcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAnY291bnQnOiAxLFxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICdkYW1hZ2VUeXBlJzogJ3BoeXNpY2FsJyxcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAnZGlzcGxheW5hbWUnOiBpdGVtRGF0YVsnaXRlbV8nICsgaXRlbV0uZGlzcGxheW5hbWVcbiAgICAgICAgICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICAgICAgICBlbHNlIHtcbiAgICAgICAgICAgICAgICAgICAgICAgIHNvdXJjZXNbaXRlbV0uY291bnQgKz0gMTtcbiAgICAgICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICAgIGJyZWFrO1xuICAgICAgICAgICAgfVxuXG4gICAgICAgIH1cbiAgICAgICAgcmV0dXJuIHNvdXJjZXM7XG4gICAgfTtcbiAgICBcbiAgICBzZWxmLmdldEhlYWx0aCA9IGZ1bmN0aW9uICgpIHtcbiAgICAgICAgdmFyIHRvdGFsQXR0cmlidXRlID0gMDtcbiAgICAgICAgZm9yICh2YXIgaSA9IDA7IGkgPCBzZWxmLml0ZW1zKCkubGVuZ3RoOyBpKyspIHtcbiAgICAgICAgICAgIHZhciBpdGVtID0gc2VsZi5pdGVtcygpW2ldLml0ZW07XG4gICAgICAgICAgICBpZiAoIXNlbGYuaXRlbXMoKVtpXS5lbmFibGVkKCkpIGNvbnRpbnVlO1xuICAgICAgICAgICAgZm9yICh2YXIgaiA9IDA7IGogPCBpdGVtRGF0YVsnaXRlbV8nICsgaXRlbV0uYXR0cmlidXRlcy5sZW5ndGg7IGorKykge1xuICAgICAgICAgICAgICAgIHZhciBhdHRyaWJ1dGUgPSBpdGVtRGF0YVsnaXRlbV8nICsgaXRlbV0uYXR0cmlidXRlc1tqXTtcbiAgICAgICAgICAgICAgICBzd2l0Y2goYXR0cmlidXRlLm5hbWUpIHtcbiAgICAgICAgICAgICAgICAgICAgY2FzZSAnYm9udXNfaGVhbHRoJzpcbiAgICAgICAgICAgICAgICAgICAgICAgIHRvdGFsQXR0cmlidXRlICs9IHBhcnNlSW50KGF0dHJpYnV0ZS52YWx1ZVswXSk7XG4gICAgICAgICAgICAgICAgICAgIGJyZWFrO1xuICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgIH1cbiAgICAgICAgfVxuICAgICAgICByZXR1cm4gdG90YWxBdHRyaWJ1dGU7XG4gICAgfTtcbiAgICBzZWxmLmdldEhlYWx0aFJlZ2VuID0gZnVuY3Rpb24gKCkge1xuICAgICAgICB2YXIgdG90YWxBdHRyaWJ1dGUgPSAwO1xuICAgICAgICBmb3IgKHZhciBpID0gMDsgaSA8IHNlbGYuaXRlbXMoKS5sZW5ndGg7IGkrKykge1xuICAgICAgICAgICAgdmFyIGl0ZW0gPSBzZWxmLml0ZW1zKClbaV0uaXRlbTtcbiAgICAgICAgICAgIHZhciBpc0FjdGl2ZSA9IHNlbGYuYWN0aXZlSXRlbXMuaW5kZXhPZihzZWxmLml0ZW1zKClbaV0pID49IDAgPyB0cnVlIDogZmFsc2U7XG4gICAgICAgICAgICBpZiAoIXNlbGYuaXRlbXMoKVtpXS5lbmFibGVkKCkpIGNvbnRpbnVlO1xuICAgICAgICAgICAgZm9yICh2YXIgaiA9IDA7IGogPCBpdGVtRGF0YVsnaXRlbV8nICsgaXRlbV0uYXR0cmlidXRlcy5sZW5ndGg7IGorKykge1xuICAgICAgICAgICAgICAgIHZhciBhdHRyaWJ1dGUgPSBpdGVtRGF0YVsnaXRlbV8nICsgaXRlbV0uYXR0cmlidXRlc1tqXTtcbiAgICAgICAgICAgICAgICBzd2l0Y2goYXR0cmlidXRlLm5hbWUpIHtcbiAgICAgICAgICAgICAgICAgICAgY2FzZSAnaGVhbHRoX3JlZ2VuJzpcbiAgICAgICAgICAgICAgICAgICAgY2FzZSAnYm9udXNfcmVnZW4nOlxuICAgICAgICAgICAgICAgICAgICAgICAgdG90YWxBdHRyaWJ1dGUgKz0gcGFyc2VJbnQoYXR0cmlidXRlLnZhbHVlWzBdKTtcbiAgICAgICAgICAgICAgICAgICAgYnJlYWs7XG4gICAgICAgICAgICAgICAgICAgIGNhc2UgJ2JvbnVzX2hlYWx0aF9yZWdlbic6XG4gICAgICAgICAgICAgICAgICAgICAgICBpZiAoaXRlbSA9PSAndHJhbnF1aWxfYm9vdHMnICYmICFpc0FjdGl2ZSkge1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgIHRvdGFsQXR0cmlidXRlICs9IHBhcnNlSW50KGF0dHJpYnV0ZS52YWx1ZVswXSk7XG4gICAgICAgICAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgICAgICAgICAgICBlbHNlIGlmIChpdGVtICE9ICd0cmFucXVpbF9ib290cycpIHtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICB0b3RhbEF0dHJpYnV0ZSArPSBwYXJzZUludChhdHRyaWJ1dGUudmFsdWVbMF0pO1xuICAgICAgICAgICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICAgICAgICBicmVhaztcbiAgICAgICAgICAgICAgICAgICAgY2FzZSAnaHBfcmVnZW4nOlxuICAgICAgICAgICAgICAgICAgICAgICAgdG90YWxBdHRyaWJ1dGUgKz0gcGFyc2VJbnQoYXR0cmlidXRlLnZhbHVlWzBdKTtcbiAgICAgICAgICAgICAgICAgICAgYnJlYWs7XG4gICAgICAgICAgICAgICAgICAgIGNhc2UgJ2hlYWx0aF9yZWdlbl9yYXRlJzpcbiAgICAgICAgICAgICAgICAgICAgICAgIGlmIChpdGVtID09ICdoZWFydCcgJiYgaXNBY3RpdmUpIHtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICB0b3RhbEF0dHJpYnV0ZSArPSAocGFyc2VJbnQoYXR0cmlidXRlLnZhbHVlWzBdKSAvIDEwMCkgKiBzZWxmLmhlcm8uaGVhbHRoKCk7XG4gICAgICAgICAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgICAgICAgIGJyZWFrO1xuICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgIH1cbiAgICAgICAgfVxuICAgICAgICByZXR1cm4gdG90YWxBdHRyaWJ1dGU7XG4gICAgfTtcbiAgICBzZWxmLmdldEhlYWx0aFJlZ2VuQXVyYSA9IGZ1bmN0aW9uIChlKSB7XG4gICAgICAgIHZhciB0b3RhbEF0dHJpYnV0ZSA9IDAsXG4gICAgICAgICAgICBleGNsdWRlTGlzdCA9IGUgfHwgW107XG4gICAgICAgIGZvciAodmFyIGkgPSAwOyBpIDwgc2VsZi5pdGVtcygpLmxlbmd0aDsgaSsrKSB7XG4gICAgICAgICAgICB2YXIgaXRlbSA9IHNlbGYuaXRlbXMoKVtpXS5pdGVtO1xuICAgICAgICAgICAgdmFyIGlzQWN0aXZlID0gc2VsZi5hY3RpdmVJdGVtcy5pbmRleE9mKHNlbGYuaXRlbXMoKVtpXSkgPj0gMCA/IHRydWUgOiBmYWxzZTtcbiAgICAgICAgICAgIGlmICghc2VsZi5pdGVtcygpW2ldLmVuYWJsZWQoKSkgY29udGludWU7XG4gICAgICAgICAgICBmb3IgKHZhciBqID0gMDsgaiA8IGl0ZW1EYXRhWydpdGVtXycgKyBpdGVtXS5hdHRyaWJ1dGVzLmxlbmd0aDsgaisrKSB7XG4gICAgICAgICAgICAgICAgdmFyIGF0dHJpYnV0ZSA9IGl0ZW1EYXRhWydpdGVtXycgKyBpdGVtXS5hdHRyaWJ1dGVzW2pdO1xuICAgICAgICAgICAgICAgIGlmIChleGNsdWRlTGlzdC5pbmRleE9mKGl0ZW0gKyBhdHRyaWJ1dGUubmFtZSkgPiAtMSkgY29udGludWU7XG4gICAgICAgICAgICAgICAgc3dpdGNoKGF0dHJpYnV0ZS5uYW1lKSB7XG4gICAgICAgICAgICAgICAgICAgIGNhc2UgJ2F1cmFfaGVhbHRoX3JlZ2VuJzpcbiAgICAgICAgICAgICAgICAgICAgICAgIHRvdGFsQXR0cmlidXRlICs9IHBhcnNlSW50KGF0dHJpYnV0ZS52YWx1ZVswXSk7XG4gICAgICAgICAgICAgICAgICAgICAgICBleGNsdWRlTGlzdC5wdXNoKGl0ZW0gKyBhdHRyaWJ1dGUubmFtZSk7XG4gICAgICAgICAgICAgICAgICAgIGJyZWFrO1xuICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgIH1cbiAgICAgICAgfVxuICAgICAgICByZXR1cm4ge3ZhbHVlOiB0b3RhbEF0dHJpYnV0ZSwgZXhjbHVkZUxpc3Q6IGV4Y2x1ZGVMaXN0fTtcbiAgICB9O1xuICAgIFxuICAgIHNlbGYuZ2V0TWFuYSA9IGZ1bmN0aW9uICgpIHtcbiAgICAgICAgdmFyIHRvdGFsQXR0cmlidXRlID0gMDtcbiAgICAgICAgZm9yICh2YXIgaSA9IDA7IGkgPCBzZWxmLml0ZW1zKCkubGVuZ3RoOyBpKyspIHtcbiAgICAgICAgICAgIHZhciBpdGVtID0gc2VsZi5pdGVtcygpW2ldLml0ZW07XG4gICAgICAgICAgICBpZiAoIXNlbGYuaXRlbXMoKVtpXS5lbmFibGVkKCkpIGNvbnRpbnVlO1xuICAgICAgICAgICAgZm9yICh2YXIgaiA9IDA7IGogPCBpdGVtRGF0YVsnaXRlbV8nICsgaXRlbV0uYXR0cmlidXRlcy5sZW5ndGg7IGorKykge1xuICAgICAgICAgICAgICAgIHZhciBhdHRyaWJ1dGUgPSBpdGVtRGF0YVsnaXRlbV8nICsgaXRlbV0uYXR0cmlidXRlc1tqXTtcbiAgICAgICAgICAgICAgICBzd2l0Y2goYXR0cmlidXRlLm5hbWUpIHtcbiAgICAgICAgICAgICAgICAgICAgY2FzZSAnYm9udXNfbWFuYSc6XG4gICAgICAgICAgICAgICAgICAgICAgICB0b3RhbEF0dHJpYnV0ZSArPSBwYXJzZUludChhdHRyaWJ1dGUudmFsdWVbMF0pO1xuICAgICAgICAgICAgICAgICAgICBicmVhaztcbiAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICB9XG4gICAgICAgIH1cbiAgICAgICAgcmV0dXJuIHRvdGFsQXR0cmlidXRlO1xuICAgIH07XG4gICAgXG4gICAgc2VsZi5nZXRNYW5hUmVnZW4gPSBmdW5jdGlvbiAoKSB7XG4gICAgICAgIHZhciB0b3RhbEF0dHJpYnV0ZSA9IDA7XG4gICAgICAgIGZvciAodmFyIGkgPSAwOyBpIDwgc2VsZi5pdGVtcygpLmxlbmd0aDsgaSsrKSB7XG4gICAgICAgICAgICB2YXIgaXRlbSA9IHNlbGYuaXRlbXMoKVtpXS5pdGVtO1xuICAgICAgICAgICAgaWYgKCFzZWxmLml0ZW1zKClbaV0uZW5hYmxlZCgpKSBjb250aW51ZTtcbiAgICAgICAgICAgIGZvciAodmFyIGogPSAwOyBqIDwgaXRlbURhdGFbJ2l0ZW1fJyArIGl0ZW1dLmF0dHJpYnV0ZXMubGVuZ3RoOyBqKyspIHtcbiAgICAgICAgICAgICAgICB2YXIgYXR0cmlidXRlID0gaXRlbURhdGFbJ2l0ZW1fJyArIGl0ZW1dLmF0dHJpYnV0ZXNbal07XG4gICAgICAgICAgICAgICAgc3dpdGNoKGF0dHJpYnV0ZS5uYW1lKSB7XG4gICAgICAgICAgICAgICAgICAgIGNhc2UgJ2F1cmFfbWFuYV9yZWdlbic6XG4gICAgICAgICAgICAgICAgICAgIGNhc2UgJ21hbmFfcmVnZW5fYXVyYSc6XG4gICAgICAgICAgICAgICAgICAgICAgICB0b3RhbEF0dHJpYnV0ZSArPSBwYXJzZUZsb2F0KGF0dHJpYnV0ZS52YWx1ZVswXSk7XG4gICAgICAgICAgICAgICAgICAgIGJyZWFrO1xuICAgICAgICAgICAgICAgICAgICBjYXNlICdtYW5hX3JlZ2VuJzpcbiAgICAgICAgICAgICAgICAgICAgICAgIGlmIChpdGVtID09ICdpbmZ1c2VkX3JhaW5kcm9wJykgdG90YWxBdHRyaWJ1dGUgKz0gcGFyc2VGbG9hdChhdHRyaWJ1dGUudmFsdWVbMF0pO1xuICAgICAgICAgICAgICAgICAgICBicmVhaztcbiAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICB9XG4gICAgICAgIH1cbiAgICAgICAgcmV0dXJuIHRvdGFsQXR0cmlidXRlOyAgICBcbiAgICB9O1xuICAgIHNlbGYuZ2V0TWFuYVJlZ2VuUGVyY2VudCA9IGZ1bmN0aW9uICgpIHtcbiAgICAgICAgdmFyIHRvdGFsQXR0cmlidXRlID0gMDtcbiAgICAgICAgZm9yICh2YXIgaSA9IDA7IGkgPCBzZWxmLml0ZW1zKCkubGVuZ3RoOyBpKyspIHtcbiAgICAgICAgICAgIHZhciBpdGVtID0gc2VsZi5pdGVtcygpW2ldLml0ZW07XG4gICAgICAgICAgICBpZiAoIXNlbGYuaXRlbXMoKVtpXS5lbmFibGVkKCkpIGNvbnRpbnVlO1xuICAgICAgICAgICAgZm9yICh2YXIgaiA9IDA7IGogPCBpdGVtRGF0YVsnaXRlbV8nICsgaXRlbV0uYXR0cmlidXRlcy5sZW5ndGg7IGorKykge1xuICAgICAgICAgICAgICAgIHZhciBhdHRyaWJ1dGUgPSBpdGVtRGF0YVsnaXRlbV8nICsgaXRlbV0uYXR0cmlidXRlc1tqXTtcbiAgICAgICAgICAgICAgICBzd2l0Y2goYXR0cmlidXRlLm5hbWUpIHtcbiAgICAgICAgICAgICAgICAgICAgY2FzZSAnYm9udXNfbWFuYV9yZWdlbic6XG4gICAgICAgICAgICAgICAgICAgIGNhc2UgJ21hbmFfcmVnZW4nOlxuICAgICAgICAgICAgICAgICAgICBjYXNlICdib251c19tYW5hX3JlZ2VuX3BjdCc6XG4gICAgICAgICAgICAgICAgICAgICAgICBpZiAoaXRlbSAhPSAnaW5mdXNlZF9yYWluZHJvcCcpIHRvdGFsQXR0cmlidXRlICs9IHBhcnNlRmxvYXQoYXR0cmlidXRlLnZhbHVlWzBdKTtcbiAgICAgICAgICAgICAgICAgICAgYnJlYWs7XG4gICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgfVxuICAgICAgICB9XG4gICAgICAgIHJldHVybiB0b3RhbEF0dHJpYnV0ZSAvIDEwMDsgICAgXG4gICAgfTtcbiAgICBzZWxmLmdldE1hbmFSZWdlbkJsb29kc3RvbmUgPSBmdW5jdGlvbiAoKSB7XG4gICAgICAgIGZvciAodmFyIGkgPSAwOyBpIDwgc2VsZi5pdGVtcygpLmxlbmd0aDsgaSsrKSB7XG4gICAgICAgICAgICB2YXIgaXRlbSA9IHNlbGYuaXRlbXMoKVtpXS5pdGVtO1xuICAgICAgICAgICAgaWYgKCFzZWxmLml0ZW1zKClbaV0uZW5hYmxlZCgpKSBjb250aW51ZTtcbiAgICAgICAgICAgIGlmIChpdGVtLmluZGV4T2YoJ2Jsb29kc3RvbmUnKSAhPSAtMSkge1xuICAgICAgICAgICAgICAgIHJldHVybiBwYXJzZUludChzZWxmLml0ZW1zKClbaV0uc2l6ZSk7XG4gICAgICAgICAgICB9XG4gICAgICAgIH1cbiAgICAgICAgcmV0dXJuIDA7XG4gICAgfTtcbiAgICBcbiAgICBzZWxmLmdldEFybW9yID0gZnVuY3Rpb24gKCkge1xuICAgICAgICB2YXIgdG90YWxBdHRyaWJ1dGUgPSAwO1xuICAgICAgICBmb3IgKHZhciBpID0gMDsgaSA8IHNlbGYuaXRlbXMoKS5sZW5ndGg7IGkrKykge1xuICAgICAgICAgICAgdmFyIGl0ZW0gPSBzZWxmLml0ZW1zKClbaV0uaXRlbTtcbiAgICAgICAgICAgIHZhciBpc0FjdGl2ZSA9IHNlbGYuYWN0aXZlSXRlbXMuaW5kZXhPZihzZWxmLml0ZW1zKClbaV0pID49IDAgPyB0cnVlIDogZmFsc2U7XG4gICAgICAgICAgICBpZiAoIXNlbGYuaXRlbXMoKVtpXS5lbmFibGVkKCkpIGNvbnRpbnVlO1xuICAgICAgICAgICAgZm9yICh2YXIgaiA9IDA7IGogPCBpdGVtRGF0YVsnaXRlbV8nICsgaXRlbV0uYXR0cmlidXRlcy5sZW5ndGg7IGorKykge1xuICAgICAgICAgICAgICAgIHZhciBhdHRyaWJ1dGUgPSBpdGVtRGF0YVsnaXRlbV8nICsgaXRlbV0uYXR0cmlidXRlc1tqXTtcbiAgICAgICAgICAgICAgICBzd2l0Y2goYXR0cmlidXRlLm5hbWUpIHtcbiAgICAgICAgICAgICAgICAgICAgY2FzZSAnYm9udXNfYXJtb3InOlxuICAgICAgICAgICAgICAgICAgICAgICAgaWYgKCFpc0FjdGl2ZSB8fCAoaXRlbSAhPSAnbWVkYWxsaW9uX29mX2NvdXJhZ2UnICYmIGl0ZW0gIT0gJ3NvbGFyX2NyZXN0JykpIHsgdG90YWxBdHRyaWJ1dGUgKz0gcGFyc2VJbnQoYXR0cmlidXRlLnZhbHVlWzBdKTsgfTtcbiAgICAgICAgICAgICAgICAgICAgYnJlYWs7XG4gICAgICAgICAgICAgICAgICAgIGNhc2UgJ3VuaG9seV9ib251c19hcm1vcic6XG4gICAgICAgICAgICAgICAgICAgICAgICBpZiAoaXNBY3RpdmUgJiYgaXRlbSA9PSAnYXJtbGV0JykgeyB0b3RhbEF0dHJpYnV0ZSArPSBwYXJzZUludChhdHRyaWJ1dGUudmFsdWVbMF0pOyB9O1xuICAgICAgICAgICAgICAgICAgICBicmVhaztcbiAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICB9XG4gICAgICAgIH1cbiAgICAgICAgcmV0dXJuIHRvdGFsQXR0cmlidXRlO1xuICAgIH07XG4gICAgXG4gICAgc2VsZi5nZXRBcm1vckF1cmEgPSBmdW5jdGlvbiAoYUxpc3QpIHtcbiAgICAgICAgdmFyIHRvdGFsQXR0cmlidXRlID0gMCxcbiAgICAgICAgICAgIGF0dHJpYnV0ZUxpc3QgPSBhTGlzdCB8fCBbXTtcbiAgICAgICAgZm9yICh2YXIgaSA9IDA7IGkgPCBzZWxmLml0ZW1zKCkubGVuZ3RoOyBpKyspIHtcbiAgICAgICAgICAgIHZhciBpdGVtID0gc2VsZi5pdGVtcygpW2ldLml0ZW07XG4gICAgICAgICAgICB2YXIgaXNBY3RpdmUgPSBzZWxmLmFjdGl2ZUl0ZW1zLmluZGV4T2Yoc2VsZi5pdGVtcygpW2ldKSA+PSAwID8gdHJ1ZSA6IGZhbHNlO1xuICAgICAgICAgICAgaWYgKCFzZWxmLml0ZW1zKClbaV0uZW5hYmxlZCgpKSBjb250aW51ZTtcbiAgICAgICAgICAgIGZvciAodmFyIGogPSAwO2ogPCBpdGVtRGF0YVsnaXRlbV8nICsgaXRlbV0uYXR0cmlidXRlcy5sZW5ndGg7IGorKykge1xuICAgICAgICAgICAgICAgIHZhciBhdHRyaWJ1dGUgPSBpdGVtRGF0YVsnaXRlbV8nICsgaXRlbV0uYXR0cmlidXRlc1tqXTtcbiAgICAgICAgICAgICAgICBpZiAoYXR0cmlidXRlTGlzdC5maW5kKGZ1bmN0aW9uIChhKSB7IHJldHVybiBhdHRyaWJ1dGUubmFtZSA9PSBhLm5hbWU7IH0pKSBjb250aW51ZTtcbiAgICAgICAgICAgICAgICBzd2l0Y2goYXR0cmlidXRlLm5hbWUpIHtcbiAgICAgICAgICAgICAgICAgICAgLy8gYnVja2xlclxuICAgICAgICAgICAgICAgICAgICBjYXNlICdib251c19hb2VfYXJtb3InOlxuICAgICAgICAgICAgICAgICAgICAgICAgaWYgKGlzQWN0aXZlKSB7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgYXR0cmlidXRlTGlzdC5wdXNoKHsnbmFtZSc6YXR0cmlidXRlLm5hbWUsICd2YWx1ZSc6IHBhcnNlSW50KGF0dHJpYnV0ZS52YWx1ZVswXSl9KTtcbiAgICAgICAgICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgICAgICAgYnJlYWs7XG4gICAgICAgICAgICAgICAgICAgIC8vIGFzc2F1bHRcbiAgICAgICAgICAgICAgICAgICAgY2FzZSAnYXVyYV9wb3NpdGl2ZV9hcm1vcic6XG4gICAgICAgICAgICAgICAgICAgICAgICBhdHRyaWJ1dGVMaXN0LnB1c2goeyduYW1lJzphdHRyaWJ1dGUubmFtZSwgJ3ZhbHVlJzogcGFyc2VJbnQoYXR0cmlidXRlLnZhbHVlWzBdKX0pO1xuICAgICAgICAgICAgICAgICAgICBicmVhaztcbiAgICAgICAgICAgICAgICAgICAgLy8gcmluZ19vZl9hcXVpbGEscmluZ19vZl9iYXNpbGl1c1xuICAgICAgICAgICAgICAgICAgICBjYXNlICdhdXJhX2JvbnVzX2FybW9yJzpcbiAgICAgICAgICAgICAgICAgICAgICAgIGlmIChpc0FjdGl2ZSkge1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgIGF0dHJpYnV0ZUxpc3QucHVzaCh7J25hbWUnOmF0dHJpYnV0ZS5uYW1lLCAndmFsdWUnOiBwYXJzZUludChhdHRyaWJ1dGUudmFsdWVbMF0pfSk7XG4gICAgICAgICAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgICAgICAgIGJyZWFrO1xuICAgICAgICAgICAgICAgICAgICAvLyB2bGFkbWlyXG4gICAgICAgICAgICAgICAgICAgIGNhc2UgJ2FybW9yX2F1cmEnOlxuICAgICAgICAgICAgICAgICAgICAgICAgYXR0cmlidXRlTGlzdC5wdXNoKHsnbmFtZSc6YXR0cmlidXRlLm5hbWUsICd2YWx1ZSc6IHBhcnNlSW50KGF0dHJpYnV0ZS52YWx1ZVswXSl9KTtcbiAgICAgICAgICAgICAgICAgICAgYnJlYWs7XG4gICAgICAgICAgICAgICAgICAgIC8vIG1la2Fuc21cbiAgICAgICAgICAgICAgICAgICAgY2FzZSAnaGVhbF9ib251c19hcm1vcic6XG4gICAgICAgICAgICAgICAgICAgICAgICBpZiAoaXNBY3RpdmUpIHtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICBhdHRyaWJ1dGVMaXN0LnB1c2goeyduYW1lJzphdHRyaWJ1dGUubmFtZSwgJ3ZhbHVlJzogcGFyc2VJbnQoYXR0cmlidXRlLnZhbHVlWzBdKX0pO1xuICAgICAgICAgICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICAgICAgICBicmVhaztcbiAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICB9XG4gICAgICAgIH1cbiAgICAgICAgLy8gcmVtb3ZlIGJ1Y2tsZXIgaWYgdGhlcmUgaXMgYSBtZWthbnNtXG4gICAgICAgIGlmIChhdHRyaWJ1dGVMaXN0LmZpbmQoZnVuY3Rpb24gKGF0dHJpYnV0ZSkgeyByZXR1cm4gYXR0cmlidXRlLm5hbWUgPT0gJ2hlYWxfYm9udXNfYXJtb3InOyB9KSkge1xuICAgICAgICAgICAgYXR0cmlidXRlTGlzdCA9IGF0dHJpYnV0ZUxpc3QuZmlsdGVyKGZ1bmN0aW9uIChhdHRyaWJ1dGUpIHtcbiAgICAgICAgICAgICAgICByZXR1cm4gYXR0cmlidXRlLm5hbWUgIT09ICdib251c19hb2VfYXJtb3InO1xuICAgICAgICAgICAgfSk7XG4gICAgICAgIH1cbiAgICAgICAgLy8gcmVtb3ZlIHJpbmdfb2ZfYXF1aWxhLHJpbmdfb2ZfYmFzaWxpdXMgaWYgdGhlcmUgaXMgYSB2bGFkbWlyXG4gICAgICAgIGlmIChhdHRyaWJ1dGVMaXN0LmZpbmQoZnVuY3Rpb24gKGF0dHJpYnV0ZSkgeyByZXR1cm4gYXR0cmlidXRlLm5hbWUgPT0gJ2FybW9yX2F1cmEnOyB9KSkge1xuICAgICAgICAgICAgYXR0cmlidXRlTGlzdCA9IGF0dHJpYnV0ZUxpc3QuZmlsdGVyKGZ1bmN0aW9uIChhdHRyaWJ1dGUpIHtcbiAgICAgICAgICAgICAgICByZXR1cm4gYXR0cmlidXRlLm5hbWUgIT09ICdhdXJhX2JvbnVzX2FybW9yJztcbiAgICAgICAgICAgIH0pO1xuICAgICAgICB9XG4gICAgICAgIFxuICAgICAgICB0b3RhbEF0dHJpYnV0ZSA9IGF0dHJpYnV0ZUxpc3QucmVkdWNlKGZ1bmN0aW9uIChtZW1vLCBhdHRyaWJ1dGUpIHtcbiAgICAgICAgICAgIHJldHVybiBtZW1vICs9IGF0dHJpYnV0ZS52YWx1ZTtcbiAgICAgICAgfSwgMCk7XG4gICAgICAgIHJldHVybiB7dmFsdWU6IHRvdGFsQXR0cmlidXRlLCBhdHRyaWJ1dGVzOiBhdHRyaWJ1dGVMaXN0fTtcbiAgICB9O1xuICAgIHNlbGYuZ2V0QXJtb3JSZWR1Y3Rpb24gPSBmdW5jdGlvbiAoZSkge1xuICAgICAgICB2YXIgdG90YWxBdHRyaWJ1dGUgPSAwLFxuICAgICAgICAgICAgZXhjbHVkZUxpc3QgPSBlIHx8IFtdO1xuICAgICAgICBmb3IgKHZhciBpID0gMDsgaSA8IHNlbGYuaXRlbXMoKS5sZW5ndGg7IGkrKykge1xuICAgICAgICAgICAgdmFyIGl0ZW0gPSBzZWxmLml0ZW1zKClbaV0uaXRlbTtcbiAgICAgICAgICAgIHZhciBpc0FjdGl2ZSA9IHNlbGYuYWN0aXZlSXRlbXMuaW5kZXhPZihzZWxmLml0ZW1zKClbaV0pID49IDAgPyB0cnVlIDogZmFsc2U7XG4gICAgICAgICAgICBpZiAoIXNlbGYuaXRlbXMoKVtpXS5lbmFibGVkKCkpIGNvbnRpbnVlO1xuICAgICAgICAgICAgZm9yICh2YXIgaiA9IDA7IGogPCBpdGVtRGF0YVsnaXRlbV8nICsgaXRlbV0uYXR0cmlidXRlcy5sZW5ndGg7IGorKykge1xuICAgICAgICAgICAgICAgIHZhciBhdHRyaWJ1dGUgPSBpdGVtRGF0YVsnaXRlbV8nICsgaXRlbV0uYXR0cmlidXRlc1tqXTtcbiAgICAgICAgICAgICAgICBpZiAoZXhjbHVkZUxpc3QuaW5kZXhPZihhdHRyaWJ1dGUubmFtZSkgPiAtMSB8fCBleGNsdWRlTGlzdC5pbmRleE9mKGl0ZW0gKyAnXycgKyBhdHRyaWJ1dGUubmFtZSkgPiAtMSkgY29udGludWU7XG4gICAgICAgICAgICAgICAgc3dpdGNoKGF0dHJpYnV0ZS5uYW1lKSB7XG4gICAgICAgICAgICAgICAgICAgIGNhc2UgJ2FybW9yX3JlZHVjdGlvbic6XG4gICAgICAgICAgICAgICAgICAgICAgICBpZiAoaXNBY3RpdmUgfHwgKGl0ZW0gIT0gJ21lZGFsbGlvbl9vZl9jb3VyYWdlJyAmJiBpdGVtICE9ICdzb2xhcl9jcmVzdCcpKSB7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgdG90YWxBdHRyaWJ1dGUgKz0gcGFyc2VJbnQoYXR0cmlidXRlLnZhbHVlWzBdKTtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICBleGNsdWRlTGlzdC5wdXNoKGl0ZW0gKyAnXycgKyBhdHRyaWJ1dGUubmFtZSk7XG4gICAgICAgICAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgICAgICAgIGJyZWFrO1xuICAgICAgICAgICAgICAgICAgICBjYXNlICdhdXJhX25lZ2F0aXZlX2FybW9yJzpcbiAgICAgICAgICAgICAgICAgICAgICAgIHRvdGFsQXR0cmlidXRlICs9IHBhcnNlSW50KGF0dHJpYnV0ZS52YWx1ZVswXSk7XG4gICAgICAgICAgICAgICAgICAgICAgICBleGNsdWRlTGlzdC5wdXNoKGF0dHJpYnV0ZS5uYW1lKTtcbiAgICAgICAgICAgICAgICAgICAgYnJlYWs7XG4gICAgICAgICAgICAgICAgICAgIGNhc2UgJ2NvcnJ1cHRpb25fYXJtb3InOlxuICAgICAgICAgICAgICAgICAgICAgICAgdG90YWxBdHRyaWJ1dGUgKz0gcGFyc2VJbnQoYXR0cmlidXRlLnZhbHVlWzBdKTtcbiAgICAgICAgICAgICAgICAgICAgICAgIGV4Y2x1ZGVMaXN0LnB1c2goYXR0cmlidXRlLm5hbWUpO1xuICAgICAgICAgICAgICAgICAgICBicmVhaztcbiAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICB9XG4gICAgICAgIH1cbiAgICAgICAgcmV0dXJuIHt2YWx1ZTogdG90YWxBdHRyaWJ1dGUsIGV4Y2x1ZGVMaXN0OiBleGNsdWRlTGlzdH07XG4gICAgfTtcbiAgICBzZWxmLmdldEV2YXNpb24gPSBmdW5jdGlvbiAoKSB7XG4gICAgICAgIHZhciB0b3RhbEF0dHJpYnV0ZSA9IDE7XG4gICAgICAgIGZvciAodmFyIGkgPSAwOyBpIDwgc2VsZi5pdGVtcygpLmxlbmd0aDsgaSsrKSB7XG4gICAgICAgICAgICB2YXIgaXRlbSA9IHNlbGYuaXRlbXMoKVtpXS5pdGVtO1xuICAgICAgICAgICAgdmFyIGlzQWN0aXZlID0gc2VsZi5hY3RpdmVJdGVtcy5pbmRleE9mKHNlbGYuaXRlbXMoKVtpXSkgPj0gMCA/IHRydWUgOiBmYWxzZTtcbiAgICAgICAgICAgIGlmICghc2VsZi5pdGVtcygpW2ldLmVuYWJsZWQoKSkgY29udGludWU7XG4gICAgICAgICAgICBmb3IgKHZhciBqID0gMDsgaiA8IGl0ZW1EYXRhWydpdGVtXycgKyBpdGVtXS5hdHRyaWJ1dGVzLmxlbmd0aDsgaisrKSB7XG4gICAgICAgICAgICAgICAgdmFyIGF0dHJpYnV0ZSA9IGl0ZW1EYXRhWydpdGVtXycgKyBpdGVtXS5hdHRyaWJ1dGVzW2pdO1xuICAgICAgICAgICAgICAgIHN3aXRjaChhdHRyaWJ1dGUubmFtZSkge1xuICAgICAgICAgICAgICAgICAgICBjYXNlICdib251c19ldmFzaW9uJzpcbiAgICAgICAgICAgICAgICAgICAgICAgIGlmICghaXNBY3RpdmUgfHwgKGl0ZW0gIT0gJ2J1dHRlcmZseScgJiYgaXRlbSAhPSAnc29sYXJfY3Jlc3QnKSkgeyB0b3RhbEF0dHJpYnV0ZSAqPSAoMSAtIHBhcnNlSW50KGF0dHJpYnV0ZS52YWx1ZVswXSkgLyAxMDApOyB9XG4gICAgICAgICAgICAgICAgICAgIGJyZWFrO1xuICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgIH1cbiAgICAgICAgfVxuICAgICAgICByZXR1cm4gdG90YWxBdHRyaWJ1dGU7XG4gICAgfTtcbiAgICBzZWxmLmdldE1vdmVtZW50U3BlZWRGbGF0ID0gZnVuY3Rpb24gKCkge1xuICAgICAgICB2YXIgdG90YWxBdHRyaWJ1dGUgPSAwLFxuICAgICAgICBoYXNCb290cyA9IGZhbHNlLFxuICAgICAgICBoYXNFdWxzID0gZmFsc2UsXG4gICAgICAgIGhhc1dpbmRMYWNlID0gZmFsc2UsXG4gICAgICAgIGJvb3RJdGVtcyA9IFsnYm9vdHMnLCdwaGFzZV9ib290cycsJ2FyY2FuZV9ib290cycsJ3RyYXZlbF9ib290cycsJ3Bvd2VyX3RyZWFkcycsJ3RyYW5xdWlsX2Jvb3RzJywnZ3VhcmRpYW5fZ3JlYXZlcyddO1xuICAgICAgICBmb3IgKHZhciBpID0gMDsgaSA8IHNlbGYuaXRlbXMoKS5sZW5ndGg7IGkrKykge1xuICAgICAgICAgICAgdmFyIGl0ZW0gPSBzZWxmLml0ZW1zKClbaV0uaXRlbTtcbiAgICAgICAgICAgIHZhciBpc0FjdGl2ZSA9IHNlbGYuYWN0aXZlSXRlbXMuaW5kZXhPZihzZWxmLml0ZW1zKClbaV0pID49IDAgPyB0cnVlIDogZmFsc2U7XG4gICAgICAgICAgICBpZiAoIXNlbGYuaXRlbXMoKVtpXS5lbmFibGVkKCkpIGNvbnRpbnVlO1xuICAgICAgICAgICAgZm9yICh2YXIgaiA9IDA7IGogPCBpdGVtRGF0YVsnaXRlbV8nICsgaXRlbV0uYXR0cmlidXRlcy5sZW5ndGg7IGorKykge1xuICAgICAgICAgICAgICAgIHZhciBhdHRyaWJ1dGUgPSBpdGVtRGF0YVsnaXRlbV8nICsgaXRlbV0uYXR0cmlidXRlc1tqXTtcbiAgICAgICAgICAgICAgICBzd2l0Y2goYXR0cmlidXRlLm5hbWUpIHtcbiAgICAgICAgICAgICAgICAgICAgY2FzZSAnYm9udXNfbW92ZW1lbnRfc3BlZWQnOlxuICAgICAgICAgICAgICAgICAgICAgICAgaWYgKCFoYXNCb290cyAmJiBib290SXRlbXMuaW5kZXhPZihpdGVtKSA+PSAwKSB7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgaWYgKGl0ZW0gIT0gJ3RyYW5xdWlsX2Jvb3RzJyB8fCAoaXRlbSA9PSAndHJhbnF1aWxfYm9vdHMnICYmICFpc0FjdGl2ZSkpIHtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgdG90YWxBdHRyaWJ1dGUgKz0gcGFyc2VJbnQoYXR0cmlidXRlLnZhbHVlWzBdKTtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgaGFzQm9vdHMgPSB0cnVlO1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgICAgICAgICAgIC8vZWxzZSBpZiAoIWhhc0V1bHMgJiYgaXRlbSA9PSAnY3ljbG9uZScpIHtcbiAgICAgICAgICAgICAgICAgICAgICAgIGVsc2UgaWYgKGl0ZW0gPT0gJ2N5Y2xvbmUnKSB7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgdG90YWxBdHRyaWJ1dGUgKz0gcGFyc2VJbnQoYXR0cmlidXRlLnZhbHVlWzBdKTtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICBoYXNFdWxzID0gdHJ1ZTtcbiAgICAgICAgICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgICAgICAgYnJlYWs7XG4gICAgICAgICAgICAgICAgICAgIGNhc2UgJ2Jyb2tlbl9tb3ZlbWVudF9zcGVlZCc6XG4gICAgICAgICAgICAgICAgICAgICAgICBpZiAoIWhhc0Jvb3RzICYmIGJvb3RJdGVtcy5pbmRleE9mKGl0ZW0pID49IDApIHtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICBpZiAoaXRlbSA9PSAndHJhbnF1aWxfYm9vdHMnICYmIGlzQWN0aXZlKSB7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIHRvdGFsQXR0cmlidXRlICs9IHBhcnNlSW50KGF0dHJpYnV0ZS52YWx1ZVswXSk7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIGhhc0Jvb3RzID0gdHJ1ZTtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgICAgICAgIGJyZWFrO1xuICAgICAgICAgICAgICAgICAgICBjYXNlICdib251c19tb3ZlbWVudCc6XG4gICAgICAgICAgICAgICAgICAgICAgICBpZiAoIWhhc0Jvb3RzICYmIGJvb3RJdGVtcy5pbmRleE9mKGl0ZW0pID49IDApIHtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICB0b3RhbEF0dHJpYnV0ZSArPSBwYXJzZUludChhdHRyaWJ1dGUudmFsdWVbMF0pO1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgIGhhc0Jvb3RzID0gdHJ1ZTtcbiAgICAgICAgICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgICAgICAgYnJlYWs7XG4gICAgICAgICAgICAgICAgICAgIGNhc2UgJ21vdmVtZW50X3NwZWVkJzpcbiAgICAgICAgICAgICAgICAgICAgICAgIGlmICghaGFzV2luZExhY2UgJiYgaXRlbSA9PSAnd2luZF9sYWNlJykge1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgIHRvdGFsQXR0cmlidXRlICs9IHBhcnNlSW50KGF0dHJpYnV0ZS52YWx1ZVswXSk7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgaGFzV2luZExhY2UgPSB0cnVlO1xuICAgICAgICAgICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICAgICAgICBicmVhaztcbiAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICB9XG4gICAgICAgIH1cbiAgICAgICAgcmV0dXJuIHRvdGFsQXR0cmlidXRlO1xuICAgIH07XG4gICAgc2VsZi5nZXRNb3ZlbWVudFNwZWVkUGVyY2VudCA9IGZ1bmN0aW9uIChlKSB7XG4gICAgICAgIHZhciB0b3RhbEF0dHJpYnV0ZSA9IDAsXG4gICAgICAgICAgICBleGNsdWRlTGlzdCA9IGUgfHwgW10sXG4gICAgICAgICAgICBoYXNZYXNoYSA9IGZhbHNlLFxuICAgICAgICAgICAgaGFzRHJ1bXMgPSBmYWxzZSxcbiAgICAgICAgICAgIGhhc0RydW1zQWN0aXZlID0gZmFsc2UsXG4gICAgICAgICAgICBoYXNQaGFzZUFjdGl2ZSA9IGZhbHNlLFxuICAgICAgICAgICAgaGFzU2hhZG93QmxhZGVBY3RpdmUgPSBmYWxzZSxcbiAgICAgICAgICAgIGhhc0J1dHRlcmZseUFjdGl2ZSA9IGZhbHNlLFxuICAgICAgICAgICAgaGFzTW9NQWN0aXZlID0gZmFsc2UsXG4gICAgICAgICAgICB5YXNoYUl0ZW1zID0gWydtYW50YScsJ3lhc2hhJywnc2FuZ2VfYW5kX3lhc2hhJ107XG4gICAgICAgIGZvciAodmFyIGkgPSAwOyBpIDwgc2VsZi5pdGVtcygpLmxlbmd0aDsgaSsrKSB7XG4gICAgICAgICAgICB2YXIgaXRlbSA9IHNlbGYuaXRlbXMoKVtpXS5pdGVtO1xuICAgICAgICAgICAgdmFyIGlzQWN0aXZlID0gc2VsZi5hY3RpdmVJdGVtcy5pbmRleE9mKHNlbGYuaXRlbXMoKVtpXSkgPj0gMCA/IHRydWUgOiBmYWxzZTtcbiAgICAgICAgICAgIGlmICghc2VsZi5pdGVtcygpW2ldLmVuYWJsZWQoKSkgY29udGludWU7XG4gICAgICAgICAgICBmb3IgKHZhciBqID0gMDsgaiA8IGl0ZW1EYXRhWydpdGVtXycgKyBpdGVtXS5hdHRyaWJ1dGVzLmxlbmd0aDsgaisrKSB7XG4gICAgICAgICAgICAgICAgdmFyIGF0dHJpYnV0ZSA9IGl0ZW1EYXRhWydpdGVtXycgKyBpdGVtXS5hdHRyaWJ1dGVzW2pdO1xuICAgICAgICAgICAgICAgIGlmIChleGNsdWRlTGlzdC5pbmRleE9mKGF0dHJpYnV0ZS5uYW1lKSA+IC0xKSBjb250aW51ZTtcbiAgICAgICAgICAgICAgICBzd2l0Y2goYXR0cmlidXRlLm5hbWUpIHtcbiAgICAgICAgICAgICAgICAgICAgY2FzZSAnbW92ZW1lbnRfc3BlZWRfcGVyY2VudF9ib251cyc6XG4gICAgICAgICAgICAgICAgICAgICAgICBpZiAoIWhhc1lhc2hhICYmIHlhc2hhSXRlbXMuaW5kZXhPZihpdGVtKSA+PSAwKSB7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgdG90YWxBdHRyaWJ1dGUgKz0gcGFyc2VJbnQoYXR0cmlidXRlLnZhbHVlWzBdKTtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICBoYXNZYXNoYSA9IHRydWU7XG4gICAgICAgICAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgICAgICAgIGJyZWFrO1xuICAgICAgICAgICAgICAgICAgICBjYXNlICdib251c19hdXJhX21vdmVtZW50X3NwZWVkX3BjdCc6XG4gICAgICAgICAgICAgICAgICAgICAgICBpZiAoIWhhc0RydW1zICYmIGl0ZW0gPT0gJ2FuY2llbnRfamFuZ2dvJykge1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgIHRvdGFsQXR0cmlidXRlICs9IHBhcnNlSW50KGF0dHJpYnV0ZS52YWx1ZVswXSk7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgaGFzRHJ1bXMgPSB0cnVlO1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgIGV4Y2x1ZGVMaXN0LnB1c2goYXR0cmlidXRlLm5hbWUpO1xuICAgICAgICAgICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICAgICAgICBicmVhaztcbiAgICAgICAgICAgICAgICAgICAgY2FzZSAncGhhc2VfbW92ZW1lbnRfc3BlZWQnOlxuICAgICAgICAgICAgICAgICAgICAgICAgaWYgKGlzQWN0aXZlICYmICFoYXNQaGFzZUFjdGl2ZSkge1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgIHRvdGFsQXR0cmlidXRlICs9IHBhcnNlSW50KGF0dHJpYnV0ZS52YWx1ZVswXSk7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgaGFzUGhhc2VBY3RpdmUgPSB0cnVlO1xuICAgICAgICAgICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICAgICAgICBicmVhaztcbiAgICAgICAgICAgICAgICAgICAgY2FzZSAnYm9udXNfbW92ZW1lbnRfc3BlZWRfcGN0JzpcbiAgICAgICAgICAgICAgICAgICAgICAgIGlmIChpc0FjdGl2ZSAmJiAhaGFzRHJ1bXNBY3RpdmUgJiYgaXRlbSA9PSAnYW5jaWVudF9qYW5nZ28nKSB7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgdG90YWxBdHRyaWJ1dGUgKz0gcGFyc2VJbnQoYXR0cmlidXRlLnZhbHVlWzBdKTtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICBoYXNEcnVtc0FjdGl2ZSA9IHRydWU7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgZXhjbHVkZUxpc3QucHVzaChhdHRyaWJ1dGUubmFtZSk7XG4gICAgICAgICAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgICAgICAgIGJyZWFrO1xuICAgICAgICAgICAgICAgICAgICBjYXNlICd3aW5kd2Fsa19tb3ZlbWVudF9zcGVlZCc6XG4gICAgICAgICAgICAgICAgICAgICAgICBpZiAoaXNBY3RpdmUgJiYgIWhhc1NoYWRvd0JsYWRlQWN0aXZlICYmIChpdGVtID09ICdpbnZpc19zd29yZCcgfHwgaXRlbSA9PSAnc2lsdmVyX2VkZ2UnKSkge1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgIHRvdGFsQXR0cmlidXRlICs9IHBhcnNlSW50KGF0dHJpYnV0ZS52YWx1ZVswXSk7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgaGFzU2hhZG93QmxhZGVBY3RpdmUgPSB0cnVlO1xuICAgICAgICAgICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICAgICAgICBicmVhaztcbiAgICAgICAgICAgICAgICAgICAgY2FzZSAnYmVyc2Vya19ib251c19tb3ZlbWVudF9zcGVlZCc6XG4gICAgICAgICAgICAgICAgICAgICAgICBpZiAoaXNBY3RpdmUgJiYgIWhhc01vTUFjdGl2ZSAmJiBpdGVtID09ICdtYXNrX29mX21hZG5lc3MnKSB7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgdG90YWxBdHRyaWJ1dGUgKz0gcGFyc2VJbnQoYXR0cmlidXRlLnZhbHVlWzBdKTtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICBoYXNNb01BY3RpdmUgPSB0cnVlO1xuICAgICAgICAgICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICAgICAgICBicmVhaztcbiAgICAgICAgICAgICAgICAgICAgY2FzZSAnYm9udXNfbW92ZW1lbnRfc3BlZWQnOiAvL21hbnRhXG4gICAgICAgICAgICAgICAgICAgICAgICBpZiAoIWhhc1lhc2hhICYmIGl0ZW0gPT0gJ21hbnRhJykge1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgIHRvdGFsQXR0cmlidXRlICs9IHBhcnNlSW50KGF0dHJpYnV0ZS52YWx1ZVswXSk7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgaGFzWWFzaGEgPSB0cnVlO1xuICAgICAgICAgICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICAgICAgICAgICAgZWxzZSBpZiAoaXRlbSA9PSAnc21va2Vfb2ZfZGVjZWl0JyAmJiBpc0FjdGl2ZSkge1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgIHRvdGFsQXR0cmlidXRlICs9IHBhcnNlSW50KGF0dHJpYnV0ZS52YWx1ZVswXSk7XG4gICAgICAgICAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgICAgICAgIGJyZWFrO1xuICAgICAgICAgICAgICAgICAgICBjYXNlICdib251c19tb3ZlX3NwZWVkJzpcbiAgICAgICAgICAgICAgICAgICAgICAgIGlmIChpc0FjdGl2ZSAmJiAhaGFzQnV0dGVyZmx5QWN0aXZlICYmIGl0ZW0gPT0gJ2J1dHRlcmZseScpIHtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICB0b3RhbEF0dHJpYnV0ZSArPSBwYXJzZUludChhdHRyaWJ1dGUudmFsdWVbMF0pO1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgIGhhc0J1dHRlcmZseUFjdGl2ZSA9IHRydWU7XG4gICAgICAgICAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgICAgICAgIGJyZWFrO1xuICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgIH1cbiAgICAgICAgfVxuICAgICAgICByZXR1cm4ge3ZhbHVlOiB0b3RhbEF0dHJpYnV0ZS8xMDAsIGV4Y2x1ZGVMaXN0OiBleGNsdWRlTGlzdH07XG4gICAgfTtcbiAgICBcbiAgICBzZWxmLmdldE1vdmVtZW50U3BlZWRQZXJjZW50UmVkdWN0aW9uID0gZnVuY3Rpb24gKGUpIHtcbiAgICAgICAgdmFyIHRvdGFsQXR0cmlidXRlID0gMCxcbiAgICAgICAgICAgIGV4Y2x1ZGVMaXN0ID0gZSB8fCBbXTtcbiAgICAgICAgZm9yICh2YXIgaSA9IDA7IGkgPCBzZWxmLml0ZW1zKCkubGVuZ3RoOyBpKyspIHtcbiAgICAgICAgICAgIHZhciBpdGVtID0gc2VsZi5pdGVtcygpW2ldLml0ZW07XG4gICAgICAgICAgICB2YXIgaXNBY3RpdmUgPSBzZWxmLmFjdGl2ZUl0ZW1zLmluZGV4T2Yoc2VsZi5pdGVtcygpW2ldKSA+PSAwID8gdHJ1ZSA6IGZhbHNlO1xuICAgICAgICAgICAgaWYgKCFzZWxmLml0ZW1zKClbaV0uZW5hYmxlZCgpKSBjb250aW51ZTtcbiAgICAgICAgICAgIGZvciAodmFyIGogPSAwOyBqIDwgaXRlbURhdGFbJ2l0ZW1fJyArIGl0ZW1dLmF0dHJpYnV0ZXMubGVuZ3RoOyBqKyspIHtcbiAgICAgICAgICAgICAgICB2YXIgYXR0cmlidXRlID0gaXRlbURhdGFbJ2l0ZW1fJyArIGl0ZW1dLmF0dHJpYnV0ZXNbal07XG4gICAgICAgICAgICAgICAgaWYgKGV4Y2x1ZGVMaXN0LmluZGV4T2YoYXR0cmlidXRlLm5hbWUpID4gLTEpIGNvbnRpbnVlO1xuICAgICAgICAgICAgICAgIHN3aXRjaChhdHRyaWJ1dGUubmFtZSkge1xuICAgICAgICAgICAgICAgICAgICBjYXNlICdtb3Zlc3BlZWQnOlxuICAgICAgICAgICAgICAgICAgICAgICAgaWYgKGl0ZW0gPT0gJ2R1c3QnICYmIGlzQWN0aXZlKSB7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgdG90YWxBdHRyaWJ1dGUgKz0gcGFyc2VJbnQoYXR0cmlidXRlLnZhbHVlWzBdKTtcbiAgICAgICAgICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgICAgICAgY2FzZSAnYmxhc3RfbW92ZW1lbnRfc3BlZWQnOlxuICAgICAgICAgICAgICAgICAgICAgICAgaWYgKGl0ZW0gPT0gJ3NoaXZhc19ndWFyZCcgJiYgaXNBY3RpdmUpIHtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICB0b3RhbEF0dHJpYnV0ZSArPSBwYXJzZUludChhdHRyaWJ1dGUudmFsdWVbMF0pO1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgIGV4Y2x1ZGVMaXN0LnB1c2goYXR0cmlidXRlLm5hbWUpO1xuICAgICAgICAgICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICAgICAgICBjYXNlICdjb2xkX21vdmVtZW50X3NwZWVkJzpcbiAgICAgICAgICAgICAgICAgICAgICAgIGlmIChpdGVtID09ICdza2FkaScpIHtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICB0b3RhbEF0dHJpYnV0ZSArPSBwYXJzZUludChhdHRyaWJ1dGUudmFsdWVbMF0pO1xuICAgICAgICAgICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICAgICAgICBicmVhaztcbiAgICAgICAgICAgICAgICAgICAgY2FzZSAnbWFpbV9tb3ZlbWVudF9zcGVlZCc6XG4gICAgICAgICAgICAgICAgICAgICAgICBpZiAoc2VsZi5pdGVtcygpW2ldLmRlYnVmZiAmJiBzZWxmLml0ZW1zKClbaV0uZGVidWZmID09ICdtYWltJykge1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgIHRvdGFsQXR0cmlidXRlICs9IHBhcnNlSW50KGF0dHJpYnV0ZS52YWx1ZVswXSk7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgZXhjbHVkZUxpc3QucHVzaChhdHRyaWJ1dGUubmFtZSk7XG4gICAgICAgICAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgICAgICAgIGJyZWFrO1xuICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgIH1cbiAgICAgICAgfVxuICAgICAgICByZXR1cm4ge3ZhbHVlOiB0b3RhbEF0dHJpYnV0ZS8xMDAsIGV4Y2x1ZGVMaXN0OiBleGNsdWRlTGlzdH07XG4gICAgfTtcbiAgICBcbiAgICBzZWxmLmdldEJvbnVzRGFtYWdlID0gZnVuY3Rpb24gKCkge1xuICAgICAgICB2YXIgdG90YWxBdHRyaWJ1dGUgPSAwO1xuICAgICAgICB2YXIgc291cmNlcyA9IHt9O1xuICAgICAgICBmb3IgKHZhciBpID0gMDsgaSA8IHNlbGYuaXRlbXMoKS5sZW5ndGg7IGkrKykge1xuICAgICAgICAgICAgdmFyIGl0ZW0gPSBzZWxmLml0ZW1zKClbaV0uaXRlbTtcbiAgICAgICAgICAgIHZhciBpc0FjdGl2ZSA9IHNlbGYuYWN0aXZlSXRlbXMuaW5kZXhPZihzZWxmLml0ZW1zKClbaV0pID49IDAgPyB0cnVlIDogZmFsc2U7XG4gICAgICAgICAgICBpZiAoIXNlbGYuaXRlbXMoKVtpXS5lbmFibGVkKCkpIGNvbnRpbnVlO1xuICAgICAgICAgICAgZm9yICh2YXIgaiA9IDA7IGogPCBpdGVtRGF0YVsnaXRlbV8nICsgaXRlbV0uYXR0cmlidXRlcy5sZW5ndGg7IGorKykge1xuICAgICAgICAgICAgICAgIHZhciBhdHRyaWJ1dGUgPSBpdGVtRGF0YVsnaXRlbV8nICsgaXRlbV0uYXR0cmlidXRlc1tqXTtcbiAgICAgICAgICAgICAgICBzd2l0Y2goYXR0cmlidXRlLm5hbWUpIHtcbiAgICAgICAgICAgICAgICAgICAgY2FzZSAnYm9udXNfZGFtYWdlJzpcbiAgICAgICAgICAgICAgICAgICAgICAgIHRvdGFsQXR0cmlidXRlICs9IHBhcnNlSW50KGF0dHJpYnV0ZS52YWx1ZVswXSk7XG4gICAgICAgICAgICAgICAgICAgICAgICBpZiAoc291cmNlc1tpdGVtXSA9PSB1bmRlZmluZWQpIHtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICBzb3VyY2VzW2l0ZW1dID0ge1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAnZGFtYWdlJzogcGFyc2VJbnQoYXR0cmlidXRlLnZhbHVlWzBdKSxcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgJ2RhbWFnZVR5cGUnOiAncGh5c2ljYWwnLFxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAnY291bnQnOjEsXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICdkaXNwbGF5bmFtZSc6IGl0ZW1EYXRhWydpdGVtXycgKyBpdGVtXS5kaXNwbGF5bmFtZVxuICAgICAgICAgICAgICAgICAgICAgICAgICAgIH0gICAgICAgICAgICAgICAgICAgICAgICAgICAgXG4gICAgICAgICAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgICAgICAgICAgICBlbHNlIHtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICBzb3VyY2VzW2l0ZW1dLmNvdW50ICs9IDE7XG4gICAgICAgICAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgICAgICAgIGJyZWFrO1xuICAgICAgICAgICAgICAgICAgICBjYXNlICd1bmhvbHlfYm9udXNfZGFtYWdlJzpcbiAgICAgICAgICAgICAgICAgICAgICAgIGlmIChpc0FjdGl2ZSkge1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgIHRvdGFsQXR0cmlidXRlICs9IHBhcnNlSW50KGF0dHJpYnV0ZS52YWx1ZVswXSk7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgaWYgKHNvdXJjZXNbaXRlbSArICdfYWN0aXZlJ10gPT0gdW5kZWZpbmVkKSB7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIHNvdXJjZXNbaXRlbSArICdfYWN0aXZlJ10gPSB7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAnZGFtYWdlJzogcGFyc2VJbnQoYXR0cmlidXRlLnZhbHVlWzBdKSxcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICdkYW1hZ2VUeXBlJzogJ3BoeXNpY2FsJyxcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICdjb3VudCc6MSxcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICdkaXNwbGF5bmFtZSc6IGl0ZW1EYXRhWydpdGVtXycgKyBpdGVtXS5kaXNwbGF5bmFtZSArICcgVW5ob2x5IFN0cmVuZ3RoJ1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICB9ICAgICAgICAgICAgICAgICAgICAgICAgICAgIFxuICAgICAgICAgICAgICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgICAgICAgICAgICAgICBlbHNlIHtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgc291cmNlc1tpdGVtXS5jb3VudCArPSAxO1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgICAgICAgYnJlYWs7XG4gICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgfVxuICAgICAgICB9XG4gICAgICAgIHJldHVybiB7IHNvdXJjZXM6IHNvdXJjZXMsIHRvdGFsOiB0b3RhbEF0dHJpYnV0ZSB9O1xuICAgIH07XG4gICAgc2VsZi5nZXRCb251c0RhbWFnZVBlcmNlbnQgPSBmdW5jdGlvbiAocykge1xuICAgICAgICBzID0gcyB8fCB7c291cmNlczp7fSx0b3RhbDowfTtcbiAgICAgICAgdmFyIHRvdGFsQXR0cmlidXRlID0gcy50b3RhbCB8fCAwO1xuICAgICAgICB2YXIgc291cmNlcyA9IHMuc291cmNlcyB8fCB7fTtcbiAgICAgICAgZm9yICh2YXIgaSA9IDA7IGkgPCBzZWxmLml0ZW1zKCkubGVuZ3RoOyBpKyspIHtcbiAgICAgICAgICAgIHZhciBpdGVtID0gc2VsZi5pdGVtcygpW2ldLml0ZW07XG4gICAgICAgICAgICB2YXIgaXNBY3RpdmUgPSBzZWxmLmFjdGl2ZUl0ZW1zLmluZGV4T2Yoc2VsZi5pdGVtcygpW2ldKSA+PSAwID8gdHJ1ZSA6IGZhbHNlO1xuICAgICAgICAgICAgaWYgKCFzZWxmLml0ZW1zKClbaV0uZW5hYmxlZCgpKSBjb250aW51ZTtcbiAgICAgICAgICAgIGZvciAodmFyIGogPSAwOyBqIDwgaXRlbURhdGFbJ2l0ZW1fJyArIGl0ZW1dLmF0dHJpYnV0ZXMubGVuZ3RoOyBqKyspIHtcbiAgICAgICAgICAgICAgICB2YXIgYXR0cmlidXRlID0gaXRlbURhdGFbJ2l0ZW1fJyArIGl0ZW1dLmF0dHJpYnV0ZXNbal07XG4gICAgICAgICAgICAgICAgc3dpdGNoKGF0dHJpYnV0ZS5uYW1lKSB7XG4gICAgICAgICAgICAgICAgICAgIGNhc2UgJ2RhbWFnZV9hdXJhJzpcbiAgICAgICAgICAgICAgICAgICAgICAgIGlmIChzb3VyY2VzW2l0ZW1dID09IHVuZGVmaW5lZCkge1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgIHRvdGFsQXR0cmlidXRlICs9IHBhcnNlSW50KGF0dHJpYnV0ZS52YWx1ZVswXSkgLyAxMDA7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgc291cmNlc1tpdGVtXSA9IHtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgJ2RhbWFnZSc6IHBhcnNlSW50KGF0dHJpYnV0ZS52YWx1ZVswXSkgLyAxMDAsXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICdkYW1hZ2VUeXBlJzogJ3BoeXNpY2FsJyxcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgJ2NvdW50JzoxLFxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAnZGlzcGxheW5hbWUnOiBpdGVtRGF0YVsnaXRlbV8nICsgaXRlbV0uZGlzcGxheW5hbWVcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgICAgICAgICAgICAvLyBlbHNlIHtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAvLyBzb3VyY2VzW2l0ZW1dLmNvdW50ICs9IDE7XG4gICAgICAgICAgICAgICAgICAgICAgICAvLyB9XG4gICAgICAgICAgICAgICAgICAgIGJyZWFrO1xuICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgIH1cbiAgICAgICAgfVxuICAgICAgICByZXR1cm4geyBzb3VyY2VzOiBzb3VyY2VzLCB0b3RhbDogdG90YWxBdHRyaWJ1dGUgfTtcbiAgICB9O1xuICAgIHNlbGYuZ2V0QXR0YWNrU3BlZWQgPSBmdW5jdGlvbiAoZSkge1xuICAgICAgICB2YXIgdG90YWxBdHRyaWJ1dGUgPSAwLFxuICAgICAgICAgICAgaGFzUG93ZXJUcmVhZHMgPSBmYWxzZSxcbiAgICAgICAgICAgIGV4Y2x1ZGVMaXN0ID0gZSB8fCBbXTtcbiAgICAgICAgZm9yICh2YXIgaSA9IDA7IGkgPCBzZWxmLml0ZW1zKCkubGVuZ3RoOyBpKyspIHtcbiAgICAgICAgICAgIHZhciBpdGVtID0gc2VsZi5pdGVtcygpW2ldLml0ZW07XG4gICAgICAgICAgICB2YXIgaXNBY3RpdmUgPSBzZWxmLmFjdGl2ZUl0ZW1zLmluZGV4T2Yoc2VsZi5pdGVtcygpW2ldKSA+PSAwID8gdHJ1ZSA6IGZhbHNlO1xuICAgICAgICAgICAgaWYgKCFzZWxmLml0ZW1zKClbaV0uZW5hYmxlZCgpKSBjb250aW51ZTtcbiAgICAgICAgICAgIGZvciAodmFyIGogPSAwOyBqIDwgaXRlbURhdGFbJ2l0ZW1fJyArIGl0ZW1dLmF0dHJpYnV0ZXMubGVuZ3RoOyBqKyspIHtcbiAgICAgICAgICAgICAgICB2YXIgYXR0cmlidXRlID0gaXRlbURhdGFbJ2l0ZW1fJyArIGl0ZW1dLmF0dHJpYnV0ZXNbal07XG4gICAgICAgICAgICAgICAgaWYgKGV4Y2x1ZGVMaXN0LmluZGV4T2YoYXR0cmlidXRlLm5hbWUpID4gLTEpIGNvbnRpbnVlO1xuICAgICAgICAgICAgICAgIHN3aXRjaChhdHRyaWJ1dGUubmFtZSkge1xuICAgICAgICAgICAgICAgICAgICBjYXNlICdib251c19hdHRhY2tfc3BlZWQnOlxuICAgICAgICAgICAgICAgICAgICAgICAgaWYgKGl0ZW0gPT0gJ3Bvd2VyX3RyZWFkcycpIHtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICBpZiAoIWhhc1Bvd2VyVHJlYWRzKSB7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIHRvdGFsQXR0cmlidXRlICs9IHBhcnNlSW50KGF0dHJpYnV0ZS52YWx1ZVswXSk7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIGhhc1Bvd2VyVHJlYWRzID0gdHJ1ZTtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgICAgICAgICAgICBlbHNlIGlmIChpdGVtID09ICdtb29uX3NoYXJkJykge1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgIGlmICghaXNBY3RpdmUpIHtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgdG90YWxBdHRyaWJ1dGUgKz0gcGFyc2VJbnQoYXR0cmlidXRlLnZhbHVlWzBdKTtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgICAgICAgICAgICBlbHNlIGlmIChpdGVtID09ICdodXJyaWNhbmVfcGlrZScpIHtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICBpZiAoaXNBY3RpdmUpIHtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgdG90YWxBdHRyaWJ1dGUgKz0gcGFyc2VJbnQoYXR0cmlidXRlLnZhbHVlWzBdKTtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgICAgICAgICAgICBlbHNlIHtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICB0b3RhbEF0dHJpYnV0ZSArPSBwYXJzZUludChhdHRyaWJ1dGUudmFsdWVbMF0pO1xuICAgICAgICAgICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICAgICAgICBicmVhaztcbiAgICAgICAgICAgICAgICAgICAgY2FzZSAnY29uc3VtZWRfYm9udXMnOlxuICAgICAgICAgICAgICAgICAgICAgICAgaWYgKGl0ZW0gPT0gJ21vb25fc2hhcmQnICYmIGlzQWN0aXZlKSB7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgdG90YWxBdHRyaWJ1dGUgKz0gcGFyc2VJbnQoYXR0cmlidXRlLnZhbHVlWzBdKTtcbiAgICAgICAgICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgICAgICAgYnJlYWs7XG4gICAgICAgICAgICAgICAgICAgIGJyZWFrO1xuICAgICAgICAgICAgICAgICAgICBjYXNlICdib251c19zcGVlZCc6XG4gICAgICAgICAgICAgICAgICAgICAgICB0b3RhbEF0dHJpYnV0ZSArPSBwYXJzZUludChhdHRyaWJ1dGUudmFsdWVbMF0pO1xuICAgICAgICAgICAgICAgICAgICBicmVhaztcbiAgICAgICAgICAgICAgICAgICAgY2FzZSAnYXVyYV9hdHRhY2tfc3BlZWQnOlxuICAgICAgICAgICAgICAgICAgICAgICAgaWYgKGl0ZW0gIT0gJ3NoaXZhc19ndWFyZCcpIHsgdG90YWxBdHRyaWJ1dGUgKz0gcGFyc2VJbnQoYXR0cmlidXRlLnZhbHVlWzBdKTsgfTtcbiAgICAgICAgICAgICAgICAgICAgYnJlYWs7XG4gICAgICAgICAgICAgICAgICAgIC8vIGFuY2llbnRfamFuZ2dvXG4gICAgICAgICAgICAgICAgICAgIGNhc2UgJ2JvbnVzX2F1cmFfYXR0YWNrX3NwZWVkX3BjdCc6XG4gICAgICAgICAgICAgICAgICAgICAgICB0b3RhbEF0dHJpYnV0ZSArPSBwYXJzZUludChhdHRyaWJ1dGUudmFsdWVbMF0pO1xuICAgICAgICAgICAgICAgICAgICAgICAgZXhjbHVkZUxpc3QucHVzaChhdHRyaWJ1dGUubmFtZSk7XG4gICAgICAgICAgICAgICAgICAgIGJyZWFrO1xuICAgICAgICAgICAgICAgICAgICAvLyBhbmNpZW50X2phbmdnb1xuICAgICAgICAgICAgICAgICAgICBjYXNlICdib251c19hdHRhY2tfc3BlZWRfcGN0JzpcbiAgICAgICAgICAgICAgICAgICAgICAgIGlmIChpc0FjdGl2ZSkge1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgIHRvdGFsQXR0cmlidXRlICs9IHBhcnNlSW50KGF0dHJpYnV0ZS52YWx1ZVswXSk7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgZXhjbHVkZUxpc3QucHVzaChhdHRyaWJ1dGUubmFtZSk7XG4gICAgICAgICAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgICAgICAgIGJyZWFrO1xuICAgICAgICAgICAgICAgICAgICBjYXNlICd1bmhvbHlfYm9udXNfYXR0YWNrX3NwZWVkJzpcbiAgICAgICAgICAgICAgICAgICAgICAgIGlmIChpc0FjdGl2ZSkgeyB0b3RhbEF0dHJpYnV0ZSArPSBwYXJzZUludChhdHRyaWJ1dGUudmFsdWVbMF0pOyB9O1xuICAgICAgICAgICAgICAgICAgICBicmVhaztcbiAgICAgICAgICAgICAgICAgICAgY2FzZSAnYmVyc2Vya19ib251c19hdHRhY2tfc3BlZWQnOlxuICAgICAgICAgICAgICAgICAgICAgICAgaWYgKGlzQWN0aXZlKSB7IHRvdGFsQXR0cmlidXRlICs9IHBhcnNlSW50KGF0dHJpYnV0ZS52YWx1ZVswXSk7IH07XG4gICAgICAgICAgICAgICAgICAgIGJyZWFrO1xuICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgIH1cbiAgICAgICAgfVxuICAgICAgICByZXR1cm4ge3ZhbHVlOiB0b3RhbEF0dHJpYnV0ZSwgZXhjbHVkZUxpc3Q6IGV4Y2x1ZGVMaXN0fTtcbiAgICB9O1xuICAgIHNlbGYuZ2V0QXR0YWNrU3BlZWRSZWR1Y3Rpb24gPSBmdW5jdGlvbiAoZSkge1xuICAgICAgICB2YXIgdG90YWxBdHRyaWJ1dGUgPSAwLFxuICAgICAgICAgICAgZXhjbHVkZUxpc3QgPSBlIHx8IFtdO1xuICAgICAgICBmb3IgKHZhciBpID0gMDsgaSA8IHNlbGYuaXRlbXMoKS5sZW5ndGg7IGkrKykge1xuICAgICAgICAgICAgdmFyIGl0ZW0gPSBzZWxmLml0ZW1zKClbaV0uaXRlbTtcbiAgICAgICAgICAgIHZhciBpc0FjdGl2ZSA9IHNlbGYuYWN0aXZlSXRlbXMuaW5kZXhPZihzZWxmLml0ZW1zKClbaV0pID49IDAgPyB0cnVlIDogZmFsc2U7XG4gICAgICAgICAgICBpZiAoIXNlbGYuaXRlbXMoKVtpXS5lbmFibGVkKCkpIGNvbnRpbnVlO1xuICAgICAgICAgICAgZm9yICh2YXIgaiA9IDA7IGogPCBpdGVtRGF0YVsnaXRlbV8nICsgaXRlbV0uYXR0cmlidXRlcy5sZW5ndGg7IGorKykge1xuICAgICAgICAgICAgICAgIHZhciBhdHRyaWJ1dGUgPSBpdGVtRGF0YVsnaXRlbV8nICsgaXRlbV0uYXR0cmlidXRlc1tqXTtcbiAgICAgICAgICAgICAgICBpZiAoZXhjbHVkZUxpc3QuaW5kZXhPZihhdHRyaWJ1dGUubmFtZSkgPiAtMSkgY29udGludWU7XG4gICAgICAgICAgICAgICAgc3dpdGNoKGF0dHJpYnV0ZS5uYW1lKSB7XG4gICAgICAgICAgICAgICAgICAgIGNhc2UgJ2F1cmFfYXR0YWNrX3NwZWVkJzpcbiAgICAgICAgICAgICAgICAgICAgICAgIGlmIChpdGVtID09ICdzaGl2YXNfZ3VhcmQnKSB7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgdG90YWxBdHRyaWJ1dGUgKz0gcGFyc2VJbnQoYXR0cmlidXRlLnZhbHVlWzBdKTtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICBleGNsdWRlTGlzdC5wdXNoKGF0dHJpYnV0ZS5uYW1lKTtcbiAgICAgICAgICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgICAgICAgYnJlYWs7XG4gICAgICAgICAgICAgICAgICAgIGNhc2UgJ2NvbGRfYXR0YWNrX3NwZWVkJzpcbiAgICAgICAgICAgICAgICAgICAgICAgIGlmIChpdGVtID09ICdza2FkaScpIHtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICB0b3RhbEF0dHJpYnV0ZSArPSBwYXJzZUludChhdHRyaWJ1dGUudmFsdWVbMF0pO1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgIGV4Y2x1ZGVMaXN0LnB1c2goYXR0cmlidXRlLm5hbWUpO1xuICAgICAgICAgICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICAgICAgICBicmVhaztcbiAgICAgICAgICAgICAgICAgICAgY2FzZSAnbWFpbV9hdHRhY2tfc3BlZWQnOlxuICAgICAgICAgICAgICAgICAgICAgICAgaWYgKHNlbGYuaXRlbXMoKVtpXS5kZWJ1ZmYgJiYgc2VsZi5pdGVtcygpW2ldLmRlYnVmZiA9PSAnbWFpbScpIHtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICB0b3RhbEF0dHJpYnV0ZSArPSBwYXJzZUludChhdHRyaWJ1dGUudmFsdWVbMF0pO1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgIGV4Y2x1ZGVMaXN0LnB1c2goYXR0cmlidXRlLm5hbWUpO1xuICAgICAgICAgICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICAgICAgICBicmVhaztcbiAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICB9XG4gICAgICAgIH1cbiAgICAgICAgcmV0dXJuIHt2YWx1ZTogdG90YWxBdHRyaWJ1dGUsIGV4Y2x1ZGVMaXN0OiBleGNsdWRlTGlzdH07XG4gICAgfTtcbiAgICBzZWxmLmdldExpZmVzdGVhbCA9IGZ1bmN0aW9uICgpIHtcbiAgICAgICAgdmFyIHRvdGFsQXR0cmlidXRlID0gMDtcbiAgICAgICAgZm9yICh2YXIgaSA9IDA7IGkgPCBzZWxmLml0ZW1zKCkubGVuZ3RoOyBpKyspIHtcbiAgICAgICAgICAgIHZhciBpdGVtID0gc2VsZi5pdGVtcygpW2ldLml0ZW07XG4gICAgICAgICAgICB2YXIgaXNBY3RpdmUgPSBzZWxmLmFjdGl2ZUl0ZW1zLmluZGV4T2Yoc2VsZi5pdGVtcygpW2ldKSA+PSAwID8gdHJ1ZSA6IGZhbHNlO1xuICAgICAgICAgICAgaWYgKCFzZWxmLml0ZW1zKClbaV0uZW5hYmxlZCgpKSBjb250aW51ZTtcbiAgICAgICAgICAgIGZvciAodmFyIGogPSAwOyBqIDwgaXRlbURhdGFbJ2l0ZW1fJyArIGl0ZW1dLmF0dHJpYnV0ZXMubGVuZ3RoOyBqKyspIHtcbiAgICAgICAgICAgICAgICB2YXIgYXR0cmlidXRlID0gaXRlbURhdGFbJ2l0ZW1fJyArIGl0ZW1dLmF0dHJpYnV0ZXNbal07XG4gICAgICAgICAgICAgICAgc3dpdGNoKGF0dHJpYnV0ZS5uYW1lKSB7XG4gICAgICAgICAgICAgICAgICAgIGNhc2UgJ2xpZmVzdGVhbF9wZXJjZW50JzpcbiAgICAgICAgICAgICAgICAgICAgICAgIGlmIChpdGVtID09ICdzYXRhbmljJykge1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgIGlmICghaXNBY3RpdmUpIHsgcmV0dXJuIHBhcnNlSW50KGF0dHJpYnV0ZS52YWx1ZVswXSk7IH07XG4gICAgICAgICAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgICAgICAgICAgICBlbHNlIHtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICByZXR1cm4gcGFyc2VJbnQoYXR0cmlidXRlLnZhbHVlWzBdKTtcbiAgICAgICAgICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgICAgICAgYnJlYWs7XG4gICAgICAgICAgICAgICAgICAgIGNhc2UgJ3VuaG9seV9saWZlc3RlYWxfcGVyY2VudCc6XG4gICAgICAgICAgICAgICAgICAgICAgICBpZiAoaXNBY3RpdmUpIHsgcmV0dXJuIHBhcnNlSW50KGF0dHJpYnV0ZS52YWx1ZVswXSk7IH07XG4gICAgICAgICAgICAgICAgICAgIGJyZWFrO1xuICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgIH1cbiAgICAgICAgfVxuICAgICAgICByZXR1cm4gdG90YWxBdHRyaWJ1dGU7XG4gICAgfTtcbiAgICBzZWxmLmdldExpZmVzdGVhbEF1cmEgPSBmdW5jdGlvbiAoZSkge1xuICAgICAgICB2YXIgdG90YWxBdHRyaWJ1dGUgPSAwLFxuICAgICAgICAgICAgZXhjbHVkZUxpc3QgPSBlIHx8IFtdO1xuICAgICAgICBmb3IgKHZhciBpID0gMDsgaSA8IHNlbGYuaXRlbXMoKS5sZW5ndGg7IGkrKykge1xuICAgICAgICAgICAgdmFyIGl0ZW0gPSBzZWxmLml0ZW1zKClbaV0uaXRlbTtcbiAgICAgICAgICAgIHZhciBpc0FjdGl2ZSA9IHNlbGYuYWN0aXZlSXRlbXMuaW5kZXhPZihzZWxmLml0ZW1zKClbaV0pID49IDAgPyB0cnVlIDogZmFsc2U7XG4gICAgICAgICAgICBpZiAoIXNlbGYuaXRlbXMoKVtpXS5lbmFibGVkKCkpIGNvbnRpbnVlO1xuICAgICAgICAgICAgZm9yICh2YXIgaiA9IDA7IGogPCBpdGVtRGF0YVsnaXRlbV8nICsgaXRlbV0uYXR0cmlidXRlcy5sZW5ndGg7IGorKykge1xuICAgICAgICAgICAgICAgIHZhciBhdHRyaWJ1dGUgPSBpdGVtRGF0YVsnaXRlbV8nICsgaXRlbV0uYXR0cmlidXRlc1tqXTtcbiAgICAgICAgICAgICAgICBpZiAoZXhjbHVkZUxpc3QuaW5kZXhPZihhdHRyaWJ1dGUubmFtZSkgPiAtMSkgY29udGludWU7XG4gICAgICAgICAgICAgICAgc3dpdGNoKGF0dHJpYnV0ZS5uYW1lKSB7XG4gICAgICAgICAgICAgICAgICAgIGNhc2UgJ3ZhbXBpcmljX2F1cmEnOlxuICAgICAgICAgICAgICAgICAgICAgICAgdG90YWxBdHRyaWJ1dGUgKz0gcGFyc2VJbnQoYXR0cmlidXRlLnZhbHVlWzBdKTtcbiAgICAgICAgICAgICAgICAgICAgICAgIGV4Y2x1ZGVMaXN0LnB1c2goYXR0cmlidXRlLm5hbWUpO1xuICAgICAgICAgICAgICAgICAgICBicmVhaztcbiAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICB9XG4gICAgICAgIH1cbiAgICAgICAgcmV0dXJuIHt2YWx1ZTogdG90YWxBdHRyaWJ1dGUsIGV4Y2x1ZGVMaXN0OiBleGNsdWRlTGlzdH07XG4gICAgfTtcbiAgICBzZWxmLmdldE1hZ2ljUmVzaXN0ID0gZnVuY3Rpb24gKCkge1xuICAgICAgICB2YXIgdG90YWxBdHRyaWJ1dGUgPSAxO1xuICAgICAgICBmb3IgKHZhciBpID0gMDsgaSA8IHNlbGYuaXRlbXMoKS5sZW5ndGg7IGkrKykge1xuICAgICAgICAgICAgdmFyIGl0ZW0gPSBzZWxmLml0ZW1zKClbaV0uaXRlbTtcbiAgICAgICAgICAgIHZhciBpc0FjdGl2ZSA9IHNlbGYuYWN0aXZlSXRlbXMuaW5kZXhPZihzZWxmLml0ZW1zKClbaV0pID49IDAgPyB0cnVlIDogZmFsc2U7XG4gICAgICAgICAgICBpZiAoIXNlbGYuaXRlbXMoKVtpXS5lbmFibGVkKCkpIGNvbnRpbnVlO1xuICAgICAgICAgICAgZm9yICh2YXIgaiA9IDA7IGogPCBpdGVtRGF0YVsnaXRlbV8nICsgaXRlbV0uYXR0cmlidXRlcy5sZW5ndGg7IGorKykge1xuICAgICAgICAgICAgICAgIHZhciBhdHRyaWJ1dGUgPSBpdGVtRGF0YVsnaXRlbV8nICsgaXRlbV0uYXR0cmlidXRlc1tqXTtcbiAgICAgICAgICAgICAgICBzd2l0Y2goYXR0cmlidXRlLm5hbWUpIHtcbiAgICAgICAgICAgICAgICAgICAgY2FzZSAnYm9udXNfbWFnaWNhbF9hcm1vcic6XG4gICAgICAgICAgICAgICAgICAgICAgICB0b3RhbEF0dHJpYnV0ZSAqPSAoMSAtIHBhcnNlSW50KGF0dHJpYnV0ZS52YWx1ZVswXSkgLyAxMDApO1xuICAgICAgICAgICAgICAgICAgICBicmVhaztcbiAgICAgICAgICAgICAgICAgICAgY2FzZSAnYm9udXNfc3BlbGxfcmVzaXN0JzpcbiAgICAgICAgICAgICAgICAgICAgICAgIHRvdGFsQXR0cmlidXRlICo9ICgxIC0gcGFyc2VJbnQoYXR0cmlidXRlLnZhbHVlWzBdKSAvIDEwMCk7XG4gICAgICAgICAgICAgICAgICAgIGJyZWFrO1xuICAgICAgICAgICAgICAgICAgICBjYXNlICdtYWdpY19yZXNpc3RhbmNlJzpcbiAgICAgICAgICAgICAgICAgICAgICAgIHRvdGFsQXR0cmlidXRlICo9ICgxIC0gcGFyc2VJbnQoYXR0cmlidXRlLnZhbHVlWzBdKSAvIDEwMCk7XG4gICAgICAgICAgICAgICAgICAgIGJyZWFrO1xuICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgIH1cbiAgICAgICAgfVxuICAgICAgICByZXR1cm4gdG90YWxBdHRyaWJ1dGU7XG4gICAgfTtcbiAgICBzZWxmLmdldE1hZ2ljUmVzaXN0UmVkdWN0aW9uU2VsZiA9IGZ1bmN0aW9uICgpIHtcbiAgICAgICAgdmFyIHRvdGFsQXR0cmlidXRlID0gMTtcbiAgICAgICAgZm9yICh2YXIgaSA9IDA7IGkgPCBzZWxmLml0ZW1zKCkubGVuZ3RoOyBpKyspIHtcbiAgICAgICAgICAgIHZhciBpdGVtID0gc2VsZi5pdGVtcygpW2ldLml0ZW07XG4gICAgICAgICAgICB2YXIgaXNBY3RpdmUgPSBzZWxmLmFjdGl2ZUl0ZW1zLmluZGV4T2Yoc2VsZi5pdGVtcygpW2ldKSA+PSAwID8gdHJ1ZSA6IGZhbHNlO1xuICAgICAgICAgICAgaWYgKCFzZWxmLml0ZW1zKClbaV0uZW5hYmxlZCgpKSBjb250aW51ZTtcbiAgICAgICAgICAgIGlmIChpc0FjdGl2ZSkge1xuICAgICAgICAgICAgICAgIGZvciAodmFyIGogPSAwOyBqIDwgaXRlbURhdGFbJ2l0ZW1fJyArIGl0ZW1dLmF0dHJpYnV0ZXMubGVuZ3RoOyBqKyspIHtcbiAgICAgICAgICAgICAgICAgICAgdmFyIGF0dHJpYnV0ZSA9IGl0ZW1EYXRhWydpdGVtXycgKyBpdGVtXS5hdHRyaWJ1dGVzW2pdO1xuICAgICAgICAgICAgICAgICAgICBzd2l0Y2goYXR0cmlidXRlLm5hbWUpIHtcbiAgICAgICAgICAgICAgICAgICAgICAgIGNhc2UgJ2V4dHJhX3NwZWxsX2RhbWFnZV9wZXJjZW50JzpcbiAgICAgICAgICAgICAgICAgICAgICAgIGNhc2UgJ2V0aGVyZWFsX2RhbWFnZV9ib251cyc6XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgcmV0dXJuICgxIC0gcGFyc2VJbnQoYXR0cmlidXRlLnZhbHVlWzBdKSAvIDEwMCk7XG4gICAgICAgICAgICAgICAgICAgICAgICBicmVhaztcbiAgICAgICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgIH1cbiAgICAgICAgfVxuICAgICAgICByZXR1cm4gdG90YWxBdHRyaWJ1dGU7XG4gICAgfTsgICBcbiAgICBzZWxmLmdldE1hZ2ljUmVzaXN0UmVkdWN0aW9uID0gZnVuY3Rpb24gKCkge1xuICAgICAgICB2YXIgdG90YWxBdHRyaWJ1dGUgPSAxO1xuICAgICAgICBmb3IgKHZhciBpID0gMDsgaSA8IHNlbGYuaXRlbXMoKS5sZW5ndGg7IGkrKykge1xuICAgICAgICAgICAgdmFyIGl0ZW0gPSBzZWxmLml0ZW1zKClbaV0uaXRlbTtcbiAgICAgICAgICAgIHZhciBpc0FjdGl2ZSA9IHNlbGYuYWN0aXZlSXRlbXMuaW5kZXhPZihzZWxmLml0ZW1zKClbaV0pID49IDAgPyB0cnVlIDogZmFsc2U7XG4gICAgICAgICAgICBpZiAoIXNlbGYuaXRlbXMoKVtpXS5lbmFibGVkKCkpIGNvbnRpbnVlO1xuICAgICAgICAgICAgaWYgKGlzQWN0aXZlKSB7XG4gICAgICAgICAgICAgICAgZm9yICh2YXIgaiA9IDA7IGogPCBpdGVtRGF0YVsnaXRlbV8nICsgaXRlbV0uYXR0cmlidXRlcy5sZW5ndGg7IGorKykge1xuICAgICAgICAgICAgICAgICAgICB2YXIgYXR0cmlidXRlID0gaXRlbURhdGFbJ2l0ZW1fJyArIGl0ZW1dLmF0dHJpYnV0ZXNbal07XG4gICAgICAgICAgICAgICAgICAgIHN3aXRjaChhdHRyaWJ1dGUubmFtZSkge1xuICAgICAgICAgICAgICAgICAgICAgICAgY2FzZSAnZXRoZXJlYWxfZGFtYWdlX2JvbnVzJzpcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICBpZiAoIXNlbGYuaXNFdGhlcmVhbCgpKSB0b3RhbEF0dHJpYnV0ZSAqPSAoMSAtIHBhcnNlSW50KGF0dHJpYnV0ZS52YWx1ZVswXSkgLyAxMDApO1xuICAgICAgICAgICAgICAgICAgICAgICAgY2FzZSAncmVzaXN0X2RlYnVmZic6XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgdG90YWxBdHRyaWJ1dGUgKj0gKDEgLSBwYXJzZUludChhdHRyaWJ1dGUudmFsdWVbMF0pIC8gMTAwKTtcbiAgICAgICAgICAgICAgICAgICAgICAgIGJyZWFrO1xuICAgICAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgfVxuICAgICAgICB9XG4gICAgICAgIHJldHVybiB0b3RhbEF0dHJpYnV0ZTtcbiAgICB9OyAgICAgICAgXG5cbiAgICBzZWxmLmdldFZpc2lvblJhbmdlTmlnaHQgPSBrby5jb21wdXRlZChmdW5jdGlvbiAoKSB7XG4gICAgICAgIHZhciB0b3RhbEF0dHJpYnV0ZSA9IDA7XG4gICAgICAgIGZvciAodmFyIGkgPSAwOyBpIDwgc2VsZi5pdGVtcygpLmxlbmd0aDsgaSsrKSB7XG4gICAgICAgICAgICB2YXIgaXRlbSA9IHNlbGYuaXRlbXMoKVtpXS5pdGVtO1xuICAgICAgICAgICAgdmFyIGlzQWN0aXZlID0gc2VsZi5hY3RpdmVJdGVtcy5pbmRleE9mKHNlbGYuaXRlbXMoKVtpXSkgPj0gMCA/IHRydWUgOiBmYWxzZTtcbiAgICAgICAgICAgIGlmICghc2VsZi5pdGVtcygpW2ldLmVuYWJsZWQoKSkgY29udGludWU7XG4gICAgICAgICAgICBmb3IgKHZhciBqID0gMDsgaiA8IGl0ZW1EYXRhWydpdGVtXycgKyBpdGVtXS5hdHRyaWJ1dGVzLmxlbmd0aDsgaisrKSB7XG4gICAgICAgICAgICAgICAgdmFyIGF0dHJpYnV0ZSA9IGl0ZW1EYXRhWydpdGVtXycgKyBpdGVtXS5hdHRyaWJ1dGVzW2pdO1xuICAgICAgICAgICAgICAgIHN3aXRjaChhdHRyaWJ1dGUubmFtZSkge1xuICAgICAgICAgICAgICAgICAgICBjYXNlICdib251c19uaWdodF92aXNpb24nOlxuICAgICAgICAgICAgICAgICAgICAgICAgaWYgKGl0ZW0gIT0gJ21vb25fc2hhcmQnIHx8ICFpc0FjdGl2ZSkge1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgIHRvdGFsQXR0cmlidXRlICs9IHBhcnNlSW50KGF0dHJpYnV0ZS52YWx1ZVswXSk7XG4gICAgICAgICAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgICAgICAgIGJyZWFrO1xuICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgIH1cbiAgICAgICAgfVxuICAgICAgICByZXR1cm4gdG90YWxBdHRyaWJ1dGU7XG4gICAgfSk7XG4gICAgXG4gICAgc2VsZi5nZXRBdHRhY2tSYW5nZSA9IGZ1bmN0aW9uIChhdHRhY2t0eXBlLCBhTGlzdCkge1xuICAgICAgICB2YXIgdG90YWxBdHRyaWJ1dGUgPSAwLFxuICAgICAgICAgICAgYXR0cmlidXRlTGlzdCA9IGFMaXN0IHx8IFtdO1xuICAgICAgICBmb3IgKHZhciBpID0gMDsgaSA8IHNlbGYuaXRlbXMoKS5sZW5ndGg7IGkrKykge1xuICAgICAgICAgICAgdmFyIGl0ZW0gPSBzZWxmLml0ZW1zKClbaV0uaXRlbTtcbiAgICAgICAgICAgIHZhciBpc0FjdGl2ZSA9IHNlbGYuYWN0aXZlSXRlbXMuaW5kZXhPZihzZWxmLml0ZW1zKClbaV0pID49IDAgPyB0cnVlIDogZmFsc2U7XG4gICAgICAgICAgICBpZiAoIXNlbGYuaXRlbXMoKVtpXS5lbmFibGVkKCkpIGNvbnRpbnVlO1xuICAgICAgICAgICAgZm9yICh2YXIgaiA9IDA7aiA8IGl0ZW1EYXRhWydpdGVtXycgKyBpdGVtXS5hdHRyaWJ1dGVzLmxlbmd0aDsgaisrKSB7XG4gICAgICAgICAgICAgICAgdmFyIGF0dHJpYnV0ZSA9IGl0ZW1EYXRhWydpdGVtXycgKyBpdGVtXS5hdHRyaWJ1dGVzW2pdO1xuICAgICAgICAgICAgICAgIGlmIChhdHRyaWJ1dGVMaXN0LmZpbmQoZnVuY3Rpb24gKGEpIHsgcmV0dXJuIGF0dHJpYnV0ZS5uYW1lID09IGEubmFtZTsgfSkpIGNvbnRpbnVlO1xuICAgICAgICAgICAgICAgIHN3aXRjaChhdHRyaWJ1dGUubmFtZSkge1xuICAgICAgICAgICAgICAgICAgICAvLyBkcmFnb25fbGFuY2VcbiAgICAgICAgICAgICAgICAgICAgY2FzZSAnYmFzZV9hdHRhY2tfcmFuZ2UnOlxuICAgICAgICAgICAgICAgICAgICAgICAgaWYgKGF0dGFja3R5cGUgPT0gJ0RPVEFfVU5JVF9DQVBfUkFOR0VEX0FUVEFDSycpIGF0dHJpYnV0ZUxpc3QucHVzaCh7J25hbWUnOmF0dHJpYnV0ZS5uYW1lLCAndmFsdWUnOiBwYXJzZUludChhdHRyaWJ1dGUudmFsdWVbMF0pfSk7XG4gICAgICAgICAgICAgICAgICAgIGJyZWFrO1xuICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgIH1cbiAgICAgICAgfVxuICAgICAgICBcbiAgICAgICAgdG90YWxBdHRyaWJ1dGUgPSBhdHRyaWJ1dGVMaXN0LnJlZHVjZShmdW5jdGlvbiAobWVtbywgYXR0cmlidXRlKSB7XG4gICAgICAgICAgICByZXR1cm4gbWVtbyArPSBhdHRyaWJ1dGUudmFsdWU7XG4gICAgICAgIH0sIDApO1xuICAgICAgICByZXR1cm4ge3ZhbHVlOiB0b3RhbEF0dHJpYnV0ZSwgYXR0cmlidXRlczogYXR0cmlidXRlTGlzdH07XG4gICAgfTtcbiAgICBcbiAgICBzZWxmLmdldE1pc3NDaGFuY2UgPSBmdW5jdGlvbiAoZSkge1xuICAgICAgICB2YXIgdG90YWxBdHRyaWJ1dGUgPSAxLFxuICAgICAgICAgICAgZXhjbHVkZUxpc3QgPSBlIHx8IFtdO1xuICAgICAgICBmb3IgKHZhciBpID0gMDsgaSA8IHNlbGYuaXRlbXMoKS5sZW5ndGg7IGkrKykge1xuICAgICAgICAgICAgdmFyIGl0ZW0gPSBzZWxmLml0ZW1zKClbaV0uaXRlbTtcbiAgICAgICAgICAgIHZhciBpc0FjdGl2ZSA9IHNlbGYuYWN0aXZlSXRlbXMuaW5kZXhPZihzZWxmLml0ZW1zKClbaV0pID49IDAgPyB0cnVlIDogZmFsc2U7XG4gICAgICAgICAgICBpZiAoIXNlbGYuaXRlbXMoKVtpXS5lbmFibGVkKCkpIGNvbnRpbnVlO1xuICAgICAgICAgICAgZm9yICh2YXIgaiA9IDA7IGogPCBpdGVtRGF0YVsnaXRlbV8nICsgaXRlbV0uYXR0cmlidXRlcy5sZW5ndGg7IGorKykge1xuICAgICAgICAgICAgICAgIHZhciBhdHRyaWJ1dGUgPSBpdGVtRGF0YVsnaXRlbV8nICsgaXRlbV0uYXR0cmlidXRlc1tqXTtcbiAgICAgICAgICAgICAgICBpZiAoZXhjbHVkZUxpc3QuaW5kZXhPZihhdHRyaWJ1dGUubmFtZSkgPiAtMSkgY29udGludWU7XG4gICAgICAgICAgICAgICAgc3dpdGNoKGF0dHJpYnV0ZS5uYW1lKSB7XG4gICAgICAgICAgICAgICAgICAgIGNhc2UgJ21pc3NfY2hhbmNlJzpcbiAgICAgICAgICAgICAgICAgICAgICAgIGlmIChpdGVtID09PSAnc29sYXJfY3Jlc3QnICYmIGlzQWN0aXZlKSB7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgdG90YWxBdHRyaWJ1dGUgKj0gKDEgLSBwYXJzZUludChhdHRyaWJ1dGUudmFsdWVbMF0pIC8gMTAwKTtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICBleGNsdWRlTGlzdC5wdXNoKGF0dHJpYnV0ZS5uYW1lKTtcbiAgICAgICAgICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgICAgICAgYnJlYWs7XG4gICAgICAgICAgICAgICAgICAgIGNhc2UgJ2JsaW5kX3BjdCc6XG4gICAgICAgICAgICAgICAgICAgICAgICB0b3RhbEF0dHJpYnV0ZSAqPSAoMSAtIHBhcnNlSW50KGF0dHJpYnV0ZS52YWx1ZVswXSkgLyAxMDApO1xuICAgICAgICAgICAgICAgICAgICAgICAgZXhjbHVkZUxpc3QucHVzaChhdHRyaWJ1dGUubmFtZSk7XG4gICAgICAgICAgICAgICAgICAgIGJyZWFrO1xuICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgIH1cbiAgICAgICAgfVxuICAgICAgICByZXR1cm4ge3ZhbHVlOiB0b3RhbEF0dHJpYnV0ZSwgZXhjbHVkZUxpc3Q6IGV4Y2x1ZGVMaXN0fTtcbiAgICB9O1xuICAgIFxuICAgIHNlbGYuZ2V0QmFzZURhbWFnZVJlZHVjdGlvblBjdCA9IGZ1bmN0aW9uICgpIHtcbiAgICAgICAgdmFyIHRvdGFsQXR0cmlidXRlID0gMTtcbiAgICAgICAgZm9yICh2YXIgaSA9IDA7IGkgPCBzZWxmLml0ZW1zKCkubGVuZ3RoOyBpKyspIHtcbiAgICAgICAgICAgIHZhciBpdGVtID0gc2VsZi5pdGVtcygpW2ldLml0ZW07XG4gICAgICAgICAgICB2YXIgaXNBY3RpdmUgPSBzZWxmLmFjdGl2ZUl0ZW1zLmluZGV4T2Yoc2VsZi5pdGVtcygpW2ldKSA+PSAwID8gdHJ1ZSA6IGZhbHNlO1xuICAgICAgICAgICAgaWYgKCFzZWxmLml0ZW1zKClbaV0uZW5hYmxlZCgpKSBjb250aW51ZTtcbiAgICAgICAgICAgIGZvciAodmFyIGogPSAwOyBqIDwgaXRlbURhdGFbJ2l0ZW1fJyArIGl0ZW1dLmF0dHJpYnV0ZXMubGVuZ3RoOyBqKyspIHtcbiAgICAgICAgICAgICAgICB2YXIgYXR0cmlidXRlID0gaXRlbURhdGFbJ2l0ZW1fJyArIGl0ZW1dLmF0dHJpYnV0ZXNbal07XG4gICAgICAgICAgICAgICAgc3dpdGNoKGF0dHJpYnV0ZS5uYW1lKSB7XG4gICAgICAgICAgICAgICAgICAgIGNhc2UgJ2JhY2tzdGFiX3JlZHVjdGlvbic6XG4gICAgICAgICAgICAgICAgICAgICAgICBpZiAoc2VsZi5pdGVtcygpW2ldLmRlYnVmZiAmJiBzZWxmLml0ZW1zKClbaV0uZGVidWZmID09ICdzaGFkb3dfd2FsaycpIHtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICB0b3RhbEF0dHJpYnV0ZSAqPSAoMSArIHBhcnNlSW50KGF0dHJpYnV0ZS52YWx1ZVswXSkgLyAxMDApO1xuICAgICAgICAgICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICAgICAgICBicmVhaztcbiAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICB9XG4gICAgICAgIH1cbiAgICAgICAgcmV0dXJuIHRvdGFsQXR0cmlidXRlO1xuICAgIH07ICAgIFxuICAgIHNlbGYuZ2V0Qm9udXNEYW1hZ2VSZWR1Y3Rpb25QY3QgPSBmdW5jdGlvbiAoKSB7XG4gICAgICAgIHZhciB0b3RhbEF0dHJpYnV0ZSA9IDE7XG4gICAgICAgIGZvciAodmFyIGkgPSAwOyBpIDwgc2VsZi5pdGVtcygpLmxlbmd0aDsgaSsrKSB7XG4gICAgICAgICAgICB2YXIgaXRlbSA9IHNlbGYuaXRlbXMoKVtpXS5pdGVtO1xuICAgICAgICAgICAgdmFyIGlzQWN0aXZlID0gc2VsZi5hY3RpdmVJdGVtcy5pbmRleE9mKHNlbGYuaXRlbXMoKVtpXSkgPj0gMCA/IHRydWUgOiBmYWxzZTtcbiAgICAgICAgICAgIGlmICghc2VsZi5pdGVtcygpW2ldLmVuYWJsZWQoKSkgY29udGludWU7XG4gICAgICAgICAgICBmb3IgKHZhciBqID0gMDsgaiA8IGl0ZW1EYXRhWydpdGVtXycgKyBpdGVtXS5hdHRyaWJ1dGVzLmxlbmd0aDsgaisrKSB7XG4gICAgICAgICAgICAgICAgdmFyIGF0dHJpYnV0ZSA9IGl0ZW1EYXRhWydpdGVtXycgKyBpdGVtXS5hdHRyaWJ1dGVzW2pdO1xuICAgICAgICAgICAgICAgIHN3aXRjaChhdHRyaWJ1dGUubmFtZSkge1xuICAgICAgICAgICAgICAgICAgICBjYXNlICdiYWNrc3RhYl9yZWR1Y3Rpb24nOlxuICAgICAgICAgICAgICAgICAgICAgICAgaWYgKHNlbGYuaXRlbXMoKVtpXS5kZWJ1ZmYgJiYgc2VsZi5pdGVtcygpW2ldLmRlYnVmZiA9PSAnc2hhZG93X3dhbGsnKSB7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgdG90YWxBdHRyaWJ1dGUgKj0gKDEgKyBwYXJzZUludChhdHRyaWJ1dGUudmFsdWVbMF0pIC8gMTAwKTtcbiAgICAgICAgICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgICAgICAgYnJlYWs7XG4gICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgfVxuICAgICAgICB9XG4gICAgICAgIHJldHVybiB0b3RhbEF0dHJpYnV0ZTtcbiAgICB9O1xuICAgIFxuICAgIHNlbGYuaXRlbU9wdGlvbnMgPSBrby5vYnNlcnZhYmxlQXJyYXkoaXRlbU9wdGlvbnNBcnJheS5pdGVtcyk7XG4gICAgXG4gICAgc2VsZi5pdGVtQnVmZk9wdGlvbnMgPSBrby5vYnNlcnZhYmxlQXJyYXkoaXRlbUJ1ZmZPcHRpb25zLml0ZW1zKTtcbiAgICBzZWxmLnNlbGVjdGVkSXRlbUJ1ZmYgPSBrby5vYnNlcnZhYmxlKCdhc3NhdWx0Jyk7XG5cbiAgICBzZWxmLml0ZW1EZWJ1ZmZPcHRpb25zID0ga28ub2JzZXJ2YWJsZUFycmF5KGl0ZW1EZWJ1ZmZPcHRpb25zLml0ZW1zKTtcbiAgICBzZWxmLnNlbGVjdGVkSXRlbURlYnVmZiA9IGtvLm9ic2VydmFibGUoJ2Fzc2F1bHQnKTtcbiAgICBcbiAgICByZXR1cm4gc2VsZjtcbn07XG5JbnZlbnRvcnlWaWV3TW9kZWwucHJvdG90eXBlID0gT2JqZWN0LmNyZWF0ZShCYXNpY0ludmVudG9yeVZpZXdNb2RlbC5wcm90b3R5cGUpO1xuSW52ZW50b3J5Vmlld01vZGVsLnByb3RvdHlwZS5jb25zdHJ1Y3RvciA9IEludmVudG9yeVZpZXdNb2RlbDtcblxubW9kdWxlLmV4cG9ydHMgPSBJbnZlbnRvcnlWaWV3TW9kZWw7IiwidmFyIEl0ZW1JbnB1dCA9IGZ1bmN0aW9uIChpdGVtRGF0YSwgdmFsdWUsIG5hbWUsIGRlYnVmZikge1xuICAgIGlmIChpdGVtRGF0YVsnaXRlbV8nICsgdmFsdWVdLkl0ZW1BbGlhc2VzIGluc3RhbmNlb2YgQXJyYXkpIHtcbiAgICAgICAgdmFyIGl0ZW1BbGlhcyA9IGl0ZW1EYXRhWydpdGVtXycgKyB2YWx1ZV0uSXRlbUFsaWFzZXMuam9pbignICcpO1xuICAgIH1cbiAgICBlbHNlIHtcbiAgICAgICAgdmFyIGl0ZW1BbGlhcyA9IGl0ZW1EYXRhWydpdGVtXycgKyB2YWx1ZV0uSXRlbUFsaWFzZXM7XG4gICAgfVxuICAgIHRoaXMudmFsdWUgPSBrby5vYnNlcnZhYmxlKHZhbHVlKTtcbiAgICB0aGlzLmRlYnVmZiA9IGtvLm9ic2VydmFibGUoZGVidWZmKTtcbiAgICBpZiAodGhpcy5kZWJ1ZmYoKSkge1xuICAgICAgICB0aGlzLnZhbHVlID0ga28ub2JzZXJ2YWJsZSh2YWx1ZSArICd8JyArIGRlYnVmZi5pZCk7XG4gICAgICAgIHRoaXMubmFtZSA9IGtvLm9ic2VydmFibGUobmFtZSArICcgKCcgKyBkZWJ1ZmYubmFtZSArICcpJyk7XG4gICAgICAgIHRoaXMuZGlzcGxheW5hbWUgPSBrby5vYnNlcnZhYmxlKG5hbWUgKyAnICgnICsgZGVidWZmLm5hbWUgKyAnKSA8c3BhbiBzdHlsZT1cImRpc3BsYXk6bm9uZVwiPicgKyAnOycgKyBpdGVtQWxpYXMgKyAnPC9zcGFuPicpO1xuICAgIH1cbiAgICBlbHNlIHtcbiAgICAgICAgdGhpcy52YWx1ZSA9IGtvLm9ic2VydmFibGUodmFsdWUpO1xuICAgICAgICB0aGlzLm5hbWUgPSBrby5vYnNlcnZhYmxlKG5hbWUpO1xuICAgICAgICB0aGlzLmRpc3BsYXluYW1lID0ga28ub2JzZXJ2YWJsZShuYW1lICsgJyA8c3BhbiBzdHlsZT1cImRpc3BsYXk6bm9uZVwiPicgKyAnOycgKyBpdGVtQWxpYXMgKyAnPC9zcGFuPicpO1xuICAgIH1cbn07XG5cbm1vZHVsZS5leHBvcnRzID0gSXRlbUlucHV0OyIsInZhciBJdGVtSW5wdXQgPSByZXF1aXJlKFwiLi9JdGVtSW5wdXRcIik7XG52YXIgaXRlbUJ1ZmZzID0gWydhc3NhdWx0JywgJ2FuY2llbnRfamFuZ2dvJywgJ2hlYWRkcmVzcycsICdtZWthbnNtJywgJ3BpcGUnLCAncmluZ19vZl9hcXVpbGEnLCAndmxhZG1pcicsICdyaW5nX29mX2Jhc2lsaXVzJywgJ2J1Y2tsZXInLCAnc29sYXJfY3Jlc3QnXTtcbnZhciBpdGVtQnVmZk9wdGlvbnMgPSB7fTtcblxudmFyIGluaXQgPSBmdW5jdGlvbiAoaXRlbURhdGEpIHtcbiAgICBpdGVtQnVmZk9wdGlvbnMuaXRlbXMgPSBpdGVtQnVmZnMubWFwKGZ1bmN0aW9uKGl0ZW0pIHtcbiAgICAgICAgcmV0dXJuIG5ldyBJdGVtSW5wdXQoaXRlbURhdGEsIGl0ZW0sIGl0ZW1EYXRhWydpdGVtXycgKyBpdGVtXS5kaXNwbGF5bmFtZSk7XG4gICAgfSk7XG4gICAgcmV0dXJuIGl0ZW1CdWZmT3B0aW9ucy5pdGVtcztcbn1cblxuaXRlbUJ1ZmZPcHRpb25zLmluaXQgPSBpbml0O1xuXG5tb2R1bGUuZXhwb3J0cyA9IGl0ZW1CdWZmT3B0aW9uczsiLCJ2YXIgSXRlbUlucHV0ID0gcmVxdWlyZShcIi4vSXRlbUlucHV0XCIpO1xudmFyIGl0ZW1EZWJ1ZmZzID0gW1xuICAgIHtpdGVtOiAnYXNzYXVsdCcsIGRlYnVmZjogbnVsbH0sXG4gICAge2l0ZW06ICdzaGl2YXNfZ3VhcmQnLCBkZWJ1ZmY6IG51bGx9LFxuICAgIHtpdGVtOiAnZGVzb2xhdG9yJywgZGVidWZmOiBudWxsfSxcbiAgICB7aXRlbTogJ21lZGFsbGlvbl9vZl9jb3VyYWdlJywgZGVidWZmOiBudWxsfSxcbiAgICB7aXRlbTogJ3JhZGlhbmNlJywgZGVidWZmOiBudWxsfSxcbiAgICB7aXRlbTogJ3NoZWVwc3RpY2snLCBkZWJ1ZmY6IG51bGx9LFxuICAgIHtpdGVtOiAndmVpbF9vZl9kaXNjb3JkJywgZGVidWZmOiBudWxsfSxcbiAgICB7aXRlbTogJ3NvbGFyX2NyZXN0JywgZGVidWZmOiBudWxsfSxcbiAgICB7aXRlbTogJ3NpbHZlcl9lZGdlJywgZGVidWZmOiB7aWQ6ICdzaGFkb3dfd2FsaycsIG5hbWU6ICdTaGFkb3cgV2Fsayd9fSxcbiAgICB7aXRlbTogJ3NpbHZlcl9lZGdlJywgZGVidWZmOiB7aWQ6ICdtYWltJywgbmFtZTogJ0xlc3NlciBNYWltJ319XG5dXG52YXIgaXRlbURlYnVmZk9wdGlvbnMgPSB7fTtcblxudmFyIGluaXQgPSBmdW5jdGlvbiAoaXRlbURhdGEpIHtcbiAgICBpdGVtRGVidWZmT3B0aW9ucy5pdGVtcyA9IGl0ZW1EZWJ1ZmZzLm1hcChmdW5jdGlvbihpdGVtKSB7XG4gICAgICAgIHJldHVybiBuZXcgSXRlbUlucHV0KGl0ZW1EYXRhLCBpdGVtLml0ZW0sIGl0ZW1EYXRhWydpdGVtXycgKyBpdGVtLml0ZW1dLmRpc3BsYXluYW1lLCBpdGVtLmRlYnVmZik7XG4gICAgfSk7XG4gICAgcmV0dXJuIGl0ZW1EZWJ1ZmZPcHRpb25zLml0ZW1zO1xufVxuXG5pdGVtRGVidWZmT3B0aW9ucy5pbml0ID0gaW5pdDtcblxubW9kdWxlLmV4cG9ydHMgPSBpdGVtRGVidWZmT3B0aW9uczsiLCJ2YXIgdmFsaWRJdGVtcyA9IHJlcXVpcmUoXCIuL3ZhbGlkSXRlbXNcIik7XG52YXIgSXRlbUlucHV0ID0gcmVxdWlyZShcIi4vSXRlbUlucHV0XCIpO1xuXG52YXIgaXRlbU9wdGlvbnNBcnJheSA9IHt9O1xuXG52YXIgaW5pdCA9IGZ1bmN0aW9uIChpdGVtRGF0YSkge1xuICAgIGl0ZW1PcHRpb25zQXJyYXkuaXRlbXMgPSBbXTtcbiAgICBmb3IgKHZhciBpID0gMDsgaSA8IHZhbGlkSXRlbXMubGVuZ3RoOyBpKyspIHtcbiAgICAgICAgaXRlbU9wdGlvbnNBcnJheS5pdGVtcy5wdXNoKG5ldyBJdGVtSW5wdXQoaXRlbURhdGEsIHZhbGlkSXRlbXNbaV0sIGl0ZW1EYXRhWydpdGVtXycgKyB2YWxpZEl0ZW1zW2ldXS5kaXNwbGF5bmFtZSkpO1xuICAgIH1cbiAgICByZXR1cm4gaXRlbU9wdGlvbnNBcnJheS5pdGVtcztcbn1cblxuaXRlbU9wdGlvbnNBcnJheS5pbml0ID0gaW5pdDtcblxubW9kdWxlLmV4cG9ydHMgPSBpdGVtT3B0aW9uc0FycmF5OyIsIm1vZHVsZS5leHBvcnRzID0gWydzb2xhcl9jcmVzdCcsICdoZWFydCcsJ3Ntb2tlX29mX2RlY2VpdCcsJ2R1c3QnLCdnaG9zdCcsJ3RyYW5xdWlsX2Jvb3RzJywncGhhc2VfYm9vdHMnLCdwb3dlcl90cmVhZHMnLCdidWNrbGVyJywnbWVkYWxsaW9uX29mX2NvdXJhZ2UnLCdhbmNpZW50X2phbmdnbycsJ21la2Fuc20nLCdwaXBlJywndmVpbF9vZl9kaXNjb3JkJywncm9kX29mX2F0b3MnLCdvcmNoaWQnLCdzaGVlcHN0aWNrJywnYXJtbGV0JywnaW52aXNfc3dvcmQnLCdldGhlcmVhbF9ibGFkZScsJ3NoaXZhc19ndWFyZCcsJ21hbnRhJywnbWFza19vZl9tYWRuZXNzJywnZGlmZnVzYWxfYmxhZGUnLCdtam9sbG5pcicsJ3NhdGFuaWMnLCdyaW5nX29mX2Jhc2lsaXVzJywncmluZ19vZl9hcXVpbGEnLCAnYnV0dGVyZmx5JywgJ21vb25fc2hhcmQnLCAnc2lsdmVyX2VkZ2UnLCdibG9vZHRob3JuJywnaHVycmljYW5lX3Bpa2UnXTsiLCJtb2R1bGUuZXhwb3J0cyA9IFsnbmVjcm9ub21pY29uJywnZGFnb24nLCdkaWZmdXNhbF9ibGFkZScsJ3RyYXZlbF9ib290cyddOyIsIm1vZHVsZS5leHBvcnRzID0gWydjbGFyaXR5JywnZmxhc2snLCdkdXN0Jywnd2FyZF9vYnNlcnZlcicsJ3dhcmRfc2VudHJ5JywndGFuZ28nLCd0cHNjcm9sbCcsJ3Ntb2tlX29mX2RlY2VpdCddOyIsIm1vZHVsZS5leHBvcnRzID0gW1wiYWJ5c3NhbF9ibGFkZVwiLFwidWx0aW1hdGVfc2NlcHRlclwiLFwiY291cmllclwiLFwiYXJjYW5lX2Jvb3RzXCIsXCJhcm1sZXRcIixcImFzc2F1bHRcIixcImJvb3RzX29mX2VsdmVzXCIsXCJiZnVyeVwiLFwiYmVsdF9vZl9zdHJlbmd0aFwiLFwiYmxhY2tfa2luZ19iYXJcIixcImJsYWRlX21haWxcIixcImJsYWRlX29mX2FsYWNyaXR5XCIsXCJibGFkZXNfb2ZfYXR0YWNrXCIsXCJibGlua1wiLFwiYmxvb2RzdG9uZVwiLFwiYm9vdHNcIixcInRyYXZlbF9ib290c1wiLFwiYm90dGxlXCIsXCJicmFjZXJcIixcImJyb2Fkc3dvcmRcIixcImJ1Y2tsZXJcIixcImJ1dHRlcmZseVwiLFwiY2hhaW5tYWlsXCIsXCJjaXJjbGV0XCIsXCJjbGFyaXR5XCIsXCJjbGF5bW9yZVwiLFwiY2xvYWtcIixcImxlc3Nlcl9jcml0XCIsXCJncmVhdGVyX2NyaXRcIixcImRhZ29uXCIsXCJkZW1vbl9lZGdlXCIsXCJkZXNvbGF0b3JcIixcImRpZmZ1c2FsX2JsYWRlXCIsXCJyYXBpZXJcIixcImFuY2llbnRfamFuZ2dvXCIsXCJkdXN0XCIsXCJlYWdsZVwiLFwiZW5lcmd5X2Jvb3N0ZXJcIixcImV0aGVyZWFsX2JsYWRlXCIsXCJjeWNsb25lXCIsXCJza2FkaVwiLFwiZmx5aW5nX2NvdXJpZXJcIixcImZvcmNlX3N0YWZmXCIsXCJnYXVudGxldHNcIixcImdlbVwiLFwiZ2hvc3RcIixcImdsb3Zlc1wiLFwiaGFuZF9vZl9taWRhc1wiLFwiaGVhZGRyZXNzXCIsXCJmbGFza1wiLFwiaGVhcnRcIixcImhlYXZlbnNfaGFsYmVyZFwiLFwiaGVsbV9vZl9pcm9uX3dpbGxcIixcImhlbG1fb2ZfdGhlX2RvbWluYXRvclwiLFwiaG9vZF9vZl9kZWZpYW5jZVwiLFwiaHlwZXJzdG9uZVwiLFwiYnJhbmNoZXNcIixcImphdmVsaW5cIixcInNwaGVyZVwiLFwibWFlbHN0cm9tXCIsXCJtYWdpY19zdGlja1wiLFwibWFnaWNfd2FuZFwiLFwibWFudGFcIixcIm1hbnRsZVwiLFwibWFza19vZl9tYWRuZXNzXCIsXCJtZWRhbGxpb25fb2ZfY291cmFnZVwiLFwibWVrYW5zbVwiLFwibWl0aHJpbF9oYW1tZXJcIixcIm1qb2xsbmlyXCIsXCJtb25rZXlfa2luZ19iYXJcIixcImxpZmVzdGVhbFwiLFwibXlzdGljX3N0YWZmXCIsXCJuZWNyb25vbWljb25cIixcIm51bGxfdGFsaXNtYW5cIixcIm9ibGl2aW9uX3N0YWZmXCIsXCJ3YXJkX29ic2VydmVyXCIsXCJvZ3JlX2F4ZVwiLFwib3JiX29mX3Zlbm9tXCIsXCJvcmNoaWRcIixcInBlcnNcIixcInBoYXNlX2Jvb3RzXCIsXCJwaXBlXCIsXCJwbGF0ZW1haWxcIixcInBvaW50X2Jvb3N0ZXJcIixcInBvb3JfbWFuc19zaGllbGRcIixcInBvd2VyX3RyZWFkc1wiLFwicXVhcnRlcnN0YWZmXCIsXCJxdWVsbGluZ19ibGFkZVwiLFwicmFkaWFuY2VcIixcInJlYXZlclwiLFwicmVmcmVzaGVyXCIsXCJyaW5nX29mX2FxdWlsYVwiLFwicmluZ19vZl9iYXNpbGl1c1wiLFwicmluZ19vZl9oZWFsdGhcIixcInJpbmdfb2ZfcHJvdGVjdGlvblwiLFwicmluZ19vZl9yZWdlblwiLFwicm9iZVwiLFwicm9kX29mX2F0b3NcIixcInJlbGljXCIsXCJzb2JpX21hc2tcIixcInNhbmdlXCIsXCJzYW5nZV9hbmRfeWFzaGFcIixcInNhdGFuaWNcIixcInNoZWVwc3RpY2tcIixcIndhcmRfc2VudHJ5XCIsXCJzaGFkb3dfYW11bGV0XCIsXCJpbnZpc19zd29yZFwiLFwic2hpdmFzX2d1YXJkXCIsXCJiYXNoZXJcIixcInNsaXBwZXJzXCIsXCJzbW9rZV9vZl9kZWNlaXRcIixcInNvdWxfYm9vc3RlclwiLFwic291bF9yaW5nXCIsXCJzdGFmZl9vZl93aXphcmRyeVwiLFwic3RvdXRfc2hpZWxkXCIsXCJ0YWxpc21hbl9vZl9ldmFzaW9uXCIsXCJ0YW5nb1wiLFwidHBzY3JvbGxcIixcInRyYW5xdWlsX2Jvb3RzXCIsXCJ1bHRpbWF0ZV9vcmJcIixcInVybl9vZl9zaGFkb3dzXCIsXCJ2YW5ndWFyZFwiLFwidmVpbF9vZl9kaXNjb3JkXCIsXCJ2aXRhbGl0eV9ib29zdGVyXCIsXCJ2bGFkbWlyXCIsXCJ2b2lkX3N0b25lXCIsXCJ3cmFpdGhfYmFuZFwiLFwieWFzaGFcIixcImNyaW1zb25fZ3VhcmRcIixcImVuY2hhbnRlZF9tYW5nb1wiLFwibG90dXNfb3JiXCIsXCJnbGltbWVyX2NhcGVcIixcImd1YXJkaWFuX2dyZWF2ZXNcIixcIm1vb25fc2hhcmRcIixcInNpbHZlcl9lZGdlXCIsXCJzb2xhcl9jcmVzdFwiLFwib2N0YXJpbmVfY29yZVwiLFwiYWV0aGVyX2xlbnNcIixcImZhZXJpZV9maXJlXCIsXCJpcm9uX3RhbG9uXCIsXCJkcmFnb25fbGFuY2VcIixcImVjaG9fc2FicmVcIixcImluZnVzZWRfcmFpbmRyb3BcIixcImJsaWdodF9zdG9uZVwiLFwid2luZF9sYWNlXCIsXCJ0b21lX29mX2tub3dsZWRnZVwiLFwiYmxvb2R0aG9yblwiLFwiaHVycmljYW5lX3Bpa2VcIl07IiwiJ3VzZSBzdHJpY3QnO1xuXG52YXIgY29yZSA9IHt9O1xuY29yZS5JbnZlbnRvcnlWaWV3TW9kZWwgPSByZXF1aXJlKFwiLi9pbnZlbnRvcnkvSW52ZW50b3J5Vmlld01vZGVsXCIpO1xuY29yZS5BYmlsaXR5TW9kZWwgPSByZXF1aXJlKFwiLi9BYmlsaXR5TW9kZWxcIik7XG5jb3JlLkJ1ZmZWaWV3TW9kZWwgPSByZXF1aXJlKFwiLi9CdWZmVmlld01vZGVsXCIpO1xuY29yZS5IZXJvTW9kZWwgPSByZXF1aXJlKFwiLi9oZXJvL0hlcm9Nb2RlbFwiKTtcbmNvcmUuQ2xvbmVNb2RlbCA9IHJlcXVpcmUoXCIuL2hlcm8vQ2xvbmVNb2RlbFwiKTtcbmNvcmUuVW5pdE1vZGVsID0gcmVxdWlyZShcIi4vaGVyby9Vbml0TW9kZWxcIik7XG5jb3JlLklsbHVzaW9uTW9kZWwgPSByZXF1aXJlKFwiLi9oZXJvL0lsbHVzaW9uTW9kZWxcIik7XG5jb3JlLkRhdGEgPSByZXF1aXJlKFwiLi9kYXRhL21haW5cIik7XG5jb3JlLlV0aWwgPSByZXF1aXJlKFwiLi91dGlsL21haW5cIik7XG5cbmNvcmUuaW5pdCA9IGZ1bmN0aW9uIChIRVJPREFUQV9QQVRILCBJVEVNREFUQV9QQVRILCBVTklUREFUQV9QQVRILCBjYWxsYmFjaykge1xuICAgIGNvcmUuRGF0YS5pbml0KEhFUk9EQVRBX1BBVEgsIElURU1EQVRBX1BBVEgsIFVOSVREQVRBX1BBVEgsIGZ1bmN0aW9uICgpIHtcbiAgICAgICAgY29yZS5IZXJvT3B0aW9ucyA9IHJlcXVpcmUoXCIuL2hlcm8vaGVyb09wdGlvbnNBcnJheVwiKS5pbml0KGNvcmUuRGF0YS5oZXJvRGF0YSk7XG4gICAgICAgIGNvcmUuQnVmZk9wdGlvbnMgPSByZXF1aXJlKFwiLi9idWZmcy9idWZmT3B0aW9uc0FycmF5XCIpLmluaXQoY29yZS5EYXRhLmhlcm9EYXRhLCBjb3JlLkRhdGEudW5pdERhdGEpO1xuICAgICAgICBjb3JlLkRlYnVmZk9wdGlvbnMgPSByZXF1aXJlKFwiLi9idWZmcy9kZWJ1ZmZPcHRpb25zQXJyYXlcIikuaW5pdChjb3JlLkRhdGEuaGVyb0RhdGEsIGNvcmUuRGF0YS51bml0RGF0YSk7XG4gICAgICAgIGNvcmUuSXRlbU9wdGlvbnMgPSByZXF1aXJlKFwiLi9pbnZlbnRvcnkvaXRlbU9wdGlvbnNBcnJheVwiKS5pbml0KGNvcmUuRGF0YS5pdGVtRGF0YSk7XG4gICAgICAgIGNvcmUuSXRlbUJ1ZmZPcHRpb25zID0gcmVxdWlyZShcIi4vaW52ZW50b3J5L2l0ZW1CdWZmT3B0aW9uc1wiKS5pbml0KGNvcmUuRGF0YS5pdGVtRGF0YSk7XG4gICAgICAgIGNvcmUuSXRlbURlYnVmZk9wdGlvbnMgPSByZXF1aXJlKFwiLi9pbnZlbnRvcnkvaXRlbURlYnVmZk9wdGlvbnNcIikuaW5pdChjb3JlLkRhdGEuaXRlbURhdGEpO1xuICAgICAgICBjYWxsYmFjaygpO1xuICAgIH0pO1xufVxuXG5tb2R1bGUuZXhwb3J0cyA9IGNvcmU7IiwidmFyIGV4dGVuZCA9IGZ1bmN0aW9uIChvdXQpIHtcbiAgICBvdXQgPSBvdXQgfHwge307XG5cbiAgICBmb3IgKHZhciBpID0gMTsgaSA8IGFyZ3VtZW50cy5sZW5ndGg7IGkrKykge1xuICAgICAgICB2YXIgb2JqID0gYXJndW1lbnRzW2ldO1xuXG4gICAgICAgIGlmICghb2JqKVxuICAgICAgICAgICAgY29udGludWU7XG5cbiAgICAgICAgZm9yICh2YXIga2V5IGluIG9iaikge1xuICAgICAgICAgICAgaWYgKG9iai5oYXNPd25Qcm9wZXJ0eShrZXkpKSB7XG4gICAgICAgICAgICAgICAgaWYgKHR5cGVvZiBvYmpba2V5XSA9PT0gJ29iamVjdCcpXG4gICAgICAgICAgICAgICAgICAgIG91dFtrZXldID0gZXh0ZW5kKG91dFtrZXldLCBvYmpba2V5XSk7XG4gICAgICAgICAgICAgICAgZWxzZVxuICAgICAgICAgICAgICAgICAgICBvdXRba2V5XSA9IG9ialtrZXldO1xuICAgICAgICAgICAgfVxuICAgICAgICB9XG4gICAgfVxuXG4gICAgcmV0dXJuIG91dDtcbn07XG5cbm1vZHVsZS5leHBvcnRzID0gZXh0ZW5kOyIsInZhciBmaW5kV2hlcmUgPSBmdW5jdGlvbiAoYXJyLCBvYmopIHtcbiAgICBhcnJMb29wOiBmb3IgKHZhciBpID0gMDsgaSA8IGFyci5sZW5ndGg7IGkrKykge1xuICAgICAgICBvYmpMb29wOiBmb3IgKHZhciBrZXkgaW4gb2JqKSB7XG4gICAgICAgICAgICBpZiAoYXJyW2ldW2tleV0gIT0gb2JqW2tleV0pIHtcbiAgICAgICAgICAgICAgICBjb250aW51ZSBhcnJMb29wO1xuICAgICAgICAgICAgfVxuICAgICAgICB9XG4gICAgICAgIHJldHVybiBhcnJbaV07XG4gICAgfVxufVxuXG5tb2R1bGUuZXhwb3J0cyA9IGZpbmRXaGVyZTsiLCJcInVzZSBzdHJpY3RcIjtcblxudmFyIGdldEpTT04gPSBmdW5jdGlvbiAodXJsLCBzdWNjZXNzQ2FsbGJhY2ssIGVycm9yQ2FsbGJhY2spIHtcbiAgICB2YXIgcmVxdWVzdCA9IG5ldyBYTUxIdHRwUmVxdWVzdCgpO1xuICAgIHJlcXVlc3Qub3BlbignR0VUJywgdXJsLCB0cnVlKTtcblxuICAgIHJlcXVlc3Qub25sb2FkID0gZnVuY3Rpb24oKSB7XG4gICAgICAgIGlmIChyZXF1ZXN0LnN0YXR1cyA+PSAyMDAgJiYgcmVxdWVzdC5zdGF0dXMgPCA0MDApIHtcbiAgICAgICAgICAgIC8vIFN1Y2Nlc3MhXG4gICAgICAgICAgICB2YXIgZGF0YSA9IEpTT04ucGFyc2UocmVxdWVzdC5yZXNwb25zZVRleHQpO1xuICAgICAgICAgICAgc3VjY2Vzc0NhbGxiYWNrKGRhdGEpO1xuICAgICAgICB9IGVsc2Uge1xuICAgICAgICAgICAgLy8gV2UgcmVhY2hlZCBvdXIgdGFyZ2V0IHNlcnZlciwgYnV0IGl0IHJldHVybmVkIGFuIGVycm9yXG4gICAgICAgICAgICBlcnJvckNhbGxiYWNrKCk7XG4gICAgICAgIH1cbiAgICB9O1xuXG4gICAgcmVxdWVzdC5vbmVycm9yID0gZnVuY3Rpb24oKSB7XG4gICAgICAgIC8vIFRoZXJlIHdhcyBhIGNvbm5lY3Rpb24gZXJyb3Igb2Ygc29tZSBzb3J0XG4gICAgICAgIGVycm9yQ2FsbGJhY2soKTtcbiAgICB9O1xuXG4gICAgcmVxdWVzdC5zZW5kKCk7XG59XG5cbm1vZHVsZS5leHBvcnRzID0gZ2V0SlNPTjsiLCJ2YXIgaXNFbXB0eSA9IGZ1bmN0aW9uIChvYmopIHtcbiAgICByZXR1cm4gT2JqZWN0LmtleXMob2JqKS5sZW5ndGggPT09IDAgJiYgb2JqLmNvbnN0cnVjdG9yID09PSBPYmplY3Q7XG59XG5cbm1vZHVsZS5leHBvcnRzID0gaXNFbXB0eTsiLCIndXNlIHN0cmljdCc7XG5cbnZhciB1dGlsID0ge307XG51dGlsLmV4dGVuZCA9IHJlcXVpcmUoXCIuL2V4dGVuZFwiKTtcbnV0aWwuZmluZFdoZXJlID0gcmVxdWlyZShcIi4vZmluZFdoZXJlXCIpO1xudXRpbC5nZXRKU09OID0gcmVxdWlyZShcIi4vZ2V0SlNPTlwiKTtcbnV0aWwudW5pb24gPSByZXF1aXJlKFwiLi91bmlvblwiKTtcbnV0aWwudW5pcXVlSWQgPSByZXF1aXJlKFwiLi91bmlxdWVJZFwiKTtcbnV0aWwudW5pcXVlcyA9IHJlcXVpcmUoXCIuL3VuaXF1ZXNcIik7XG5cbm1vZHVsZS5leHBvcnRzID0gdXRpbDsiLCJcInVzZSBzdHJpY3RcIjtcbnZhciB1bmlxdWVzID0gcmVxdWlyZShcIi4vdW5pcXVlc1wiKTtcblxudmFyIHVuaW9uID0gZnVuY3Rpb24gKGEsIGIpIHtcbiAgICB2YXIgYXJyID0gYS5jb25jYXQoYik7XG4gICAgcmV0dXJuIHVuaXF1ZXMoYXJyKTtcbn1cblxubW9kdWxlLmV4cG9ydHMgPSB1bmlvbjsiLCJcInVzZSBzdHJpY3RcIjtcblxudmFyIGlkQ291bnRlciA9IDA7XG52YXIgdW5pcXVlSWQgPSBmdW5jdGlvbiAocHJlZml4KSB7XG4gICAgdmFyIGlkID0gKytpZENvdW50ZXIgKyAnJztcbiAgICByZXR1cm4gcHJlZml4ID8gcHJlZml4ICsgaWQgOiBpZDtcbn07XG5cbm1vZHVsZS5leHBvcnRzID0gdW5pcXVlSWQ7IiwiXCJ1c2Ugc3RyaWN0XCI7XG52YXIgdW5pcXVlcyA9IGZ1bmN0aW9uIChhcnIpIHtcbiAgICB2YXIgYSA9IFtdO1xuICAgIGZvciAodmFyIGk9MCwgbD1hcnIubGVuZ3RoOyBpPGw7IGkrKylcbiAgICAgICAgaWYgKGEuaW5kZXhPZihhcnJbaV0pID09PSAtMSAmJiBhcnJbaV0gIT09ICcnKVxuICAgICAgICAgICAgYS5wdXNoKGFycltpXSk7XG4gICAgcmV0dXJuIGE7XG59XG5cbm1vZHVsZS5leHBvcnRzID0gdW5pcXVlczsiLCIoZnVuY3Rpb24gKGZhY3RvcnkpIHtcblx0Ly8gTW9kdWxlIHN5c3RlbXMgbWFnaWMgZGFuY2UuXG5cblx0aWYgKHR5cGVvZiByZXF1aXJlID09PSBcImZ1bmN0aW9uXCIgJiYgdHlwZW9mIGV4cG9ydHMgPT09IFwib2JqZWN0XCIgJiYgdHlwZW9mIG1vZHVsZSA9PT0gXCJvYmplY3RcIikge1xuXHRcdC8vIENvbW1vbkpTIG9yIE5vZGU6IGhhcmQtY29kZWQgZGVwZW5kZW5jeSBvbiBcImtub2Nrb3V0XCJcblx0XHRmYWN0b3J5KCh0eXBlb2Ygd2luZG93ICE9PSBcInVuZGVmaW5lZFwiID8gd2luZG93WydrbyddIDogdHlwZW9mIGdsb2JhbCAhPT0gXCJ1bmRlZmluZWRcIiA/IGdsb2JhbFsna28nXSA6IG51bGwpLCBleHBvcnRzKTtcblx0fSBlbHNlIGlmICh0eXBlb2YgZGVmaW5lID09PSBcImZ1bmN0aW9uXCIgJiYgZGVmaW5lW1wiYW1kXCJdKSB7XG5cdFx0Ly8gQU1EIGFub255bW91cyBtb2R1bGUgd2l0aCBoYXJkLWNvZGVkIGRlcGVuZGVuY3kgb24gXCJrbm9ja291dFwiXG5cdFx0ZGVmaW5lKFtcImtub2Nrb3V0XCIsIFwiZXhwb3J0c1wiXSwgZmFjdG9yeSk7XG5cdH0gZWxzZSB7XG5cdFx0Ly8gPHNjcmlwdD4gdGFnOiB1c2UgdGhlIGdsb2JhbCBga29gIG9iamVjdCwgYXR0YWNoaW5nIGEgYG1hcHBpbmdgIHByb3BlcnR5XG5cdFx0ZmFjdG9yeShrbywga28ubWFwcGluZyA9IHt9KTtcblx0fVxufShmdW5jdGlvbiAoa28sIGV4cG9ydHMpIHtcblx0dmFyIERFQlVHPXRydWU7XG5cdHZhciBtYXBwaW5nUHJvcGVydHkgPSBcIl9fa29fbWFwcGluZ19fXCI7XG5cdHZhciByZWFsS29EZXBlbmRlbnRPYnNlcnZhYmxlID0ga28uZGVwZW5kZW50T2JzZXJ2YWJsZTtcblx0dmFyIG1hcHBpbmdOZXN0aW5nID0gMDtcblx0dmFyIGRlcGVuZGVudE9ic2VydmFibGVzO1xuXHR2YXIgdmlzaXRlZE9iamVjdHM7XG5cdHZhciByZWNvZ25pemVkUm9vdFByb3BlcnRpZXMgPSBbXCJjcmVhdGVcIiwgXCJ1cGRhdGVcIiwgXCJrZXlcIiwgXCJhcnJheUNoYW5nZWRcIl07XG5cdHZhciBlbXB0eVJldHVybiA9IHt9O1xuXG5cdHZhciBfZGVmYXVsdE9wdGlvbnMgPSB7XG5cdFx0aW5jbHVkZTogW1wiX2Rlc3Ryb3lcIl0sXG5cdFx0aWdub3JlOiBbXSxcblx0XHRjb3B5OiBbXSxcblx0XHRvYnNlcnZlOiBbXVxuXHR9O1xuXHR2YXIgZGVmYXVsdE9wdGlvbnMgPSBfZGVmYXVsdE9wdGlvbnM7XG5cblx0Ly8gQXV0aG9yOiBLZW5ueVRNIEAgU3RhY2tPdmVyZmxvd1xuXHRmdW5jdGlvbiB1bmlvbkFycmF5cyAoeCwgeSkge1xuXHRcdHZhciBvYmogPSB7fTtcblx0XHRmb3IgKHZhciBpID0geC5sZW5ndGggLSAxOyBpID49IDA7IC0tIGkpIG9ialt4W2ldXSA9IHhbaV07XG5cdFx0Zm9yICh2YXIgaSA9IHkubGVuZ3RoIC0gMTsgaSA+PSAwOyAtLSBpKSBvYmpbeVtpXV0gPSB5W2ldO1xuXHRcdHZhciByZXMgPSBbXTtcblxuXHRcdGZvciAodmFyIGsgaW4gb2JqKSB7XG5cdFx0XHRyZXMucHVzaChvYmpba10pO1xuXHRcdH07XG5cblx0XHRyZXR1cm4gcmVzO1xuXHR9XG5cblx0ZnVuY3Rpb24gZXh0ZW5kT2JqZWN0KGRlc3RpbmF0aW9uLCBzb3VyY2UpIHtcblx0XHR2YXIgZGVzdFR5cGU7XG5cblx0XHRmb3IgKHZhciBrZXkgaW4gc291cmNlKSB7XG5cdFx0XHRpZiAoc291cmNlLmhhc093blByb3BlcnR5KGtleSkgJiYgc291cmNlW2tleV0pIHtcblx0XHRcdFx0ZGVzdFR5cGUgPSBleHBvcnRzLmdldFR5cGUoZGVzdGluYXRpb25ba2V5XSk7XG5cdFx0XHRcdGlmIChrZXkgJiYgZGVzdGluYXRpb25ba2V5XSAmJiBkZXN0VHlwZSAhPT0gXCJhcnJheVwiICYmIGRlc3RUeXBlICE9PSBcInN0cmluZ1wiKSB7XG5cdFx0XHRcdFx0ZXh0ZW5kT2JqZWN0KGRlc3RpbmF0aW9uW2tleV0sIHNvdXJjZVtrZXldKTtcblx0XHRcdFx0fSBlbHNlIHtcblx0XHRcdFx0XHR2YXIgYm90aEFycmF5cyA9IGV4cG9ydHMuZ2V0VHlwZShkZXN0aW5hdGlvbltrZXldKSA9PT0gXCJhcnJheVwiICYmIGV4cG9ydHMuZ2V0VHlwZShzb3VyY2Vba2V5XSkgPT09IFwiYXJyYXlcIjtcblx0XHRcdFx0XHRpZiAoYm90aEFycmF5cykge1xuXHRcdFx0XHRcdFx0ZGVzdGluYXRpb25ba2V5XSA9IHVuaW9uQXJyYXlzKGRlc3RpbmF0aW9uW2tleV0sIHNvdXJjZVtrZXldKTtcblx0XHRcdFx0XHR9IGVsc2Uge1xuXHRcdFx0XHRcdFx0ZGVzdGluYXRpb25ba2V5XSA9IHNvdXJjZVtrZXldO1xuXHRcdFx0XHRcdH1cblx0XHRcdFx0fVxuXHRcdFx0fVxuXHRcdH1cblx0fVxuXG5cdGZ1bmN0aW9uIG1lcmdlKG9iajEsIG9iajIpIHtcblx0XHR2YXIgbWVyZ2VkID0ge307XG5cdFx0ZXh0ZW5kT2JqZWN0KG1lcmdlZCwgb2JqMSk7XG5cdFx0ZXh0ZW5kT2JqZWN0KG1lcmdlZCwgb2JqMik7XG5cblx0XHRyZXR1cm4gbWVyZ2VkO1xuXHR9XG5cblx0ZXhwb3J0cy5pc01hcHBlZCA9IGZ1bmN0aW9uICh2aWV3TW9kZWwpIHtcblx0XHR2YXIgdW53cmFwcGVkID0ga28udXRpbHMudW53cmFwT2JzZXJ2YWJsZSh2aWV3TW9kZWwpO1xuXHRcdHJldHVybiB1bndyYXBwZWQgJiYgdW53cmFwcGVkW21hcHBpbmdQcm9wZXJ0eV07XG5cdH1cblxuXHRleHBvcnRzLmZyb21KUyA9IGZ1bmN0aW9uIChqc09iamVjdCAvKiwgaW5wdXRPcHRpb25zLCB0YXJnZXQqLyApIHtcblx0XHRpZiAoYXJndW1lbnRzLmxlbmd0aCA9PSAwKSB0aHJvdyBuZXcgRXJyb3IoXCJXaGVuIGNhbGxpbmcga28uZnJvbUpTLCBwYXNzIHRoZSBvYmplY3QgeW91IHdhbnQgdG8gY29udmVydC5cIik7XG5cblx0XHR0cnkge1xuXHRcdFx0aWYgKCFtYXBwaW5nTmVzdGluZysrKSB7XG5cdFx0XHRcdGRlcGVuZGVudE9ic2VydmFibGVzID0gW107XG5cdFx0XHRcdHZpc2l0ZWRPYmplY3RzID0gbmV3IG9iamVjdExvb2t1cCgpO1xuXHRcdFx0fVxuXG5cdFx0XHR2YXIgb3B0aW9ucztcblx0XHRcdHZhciB0YXJnZXQ7XG5cblx0XHRcdGlmIChhcmd1bWVudHMubGVuZ3RoID09IDIpIHtcblx0XHRcdFx0aWYgKGFyZ3VtZW50c1sxXVttYXBwaW5nUHJvcGVydHldKSB7XG5cdFx0XHRcdFx0dGFyZ2V0ID0gYXJndW1lbnRzWzFdO1xuXHRcdFx0XHR9IGVsc2Uge1xuXHRcdFx0XHRcdG9wdGlvbnMgPSBhcmd1bWVudHNbMV07XG5cdFx0XHRcdH1cblx0XHRcdH1cblx0XHRcdGlmIChhcmd1bWVudHMubGVuZ3RoID09IDMpIHtcblx0XHRcdFx0b3B0aW9ucyA9IGFyZ3VtZW50c1sxXTtcblx0XHRcdFx0dGFyZ2V0ID0gYXJndW1lbnRzWzJdO1xuXHRcdFx0fVxuXG5cdFx0XHRpZiAodGFyZ2V0KSB7XG5cdFx0XHRcdG9wdGlvbnMgPSBtZXJnZShvcHRpb25zLCB0YXJnZXRbbWFwcGluZ1Byb3BlcnR5XSk7XG5cdFx0XHR9XG5cdFx0XHRvcHRpb25zID0gZmlsbE9wdGlvbnMob3B0aW9ucyk7XG5cblx0XHRcdHZhciByZXN1bHQgPSB1cGRhdGVWaWV3TW9kZWwodGFyZ2V0LCBqc09iamVjdCwgb3B0aW9ucyk7XG5cdFx0XHRpZiAodGFyZ2V0KSB7XG5cdFx0XHRcdHJlc3VsdCA9IHRhcmdldDtcblx0XHRcdH1cblxuXHRcdFx0Ly8gRXZhbHVhdGUgYW55IGRlcGVuZGVudCBvYnNlcnZhYmxlcyB0aGF0IHdlcmUgcHJveGllZC5cblx0XHRcdC8vIERvIHRoaXMgYWZ0ZXIgdGhlIG1vZGVsJ3Mgb2JzZXJ2YWJsZXMgaGF2ZSBiZWVuIGNyZWF0ZWRcblx0XHRcdGlmICghLS1tYXBwaW5nTmVzdGluZykge1xuXHRcdFx0XHR3aGlsZSAoZGVwZW5kZW50T2JzZXJ2YWJsZXMubGVuZ3RoKSB7XG5cdFx0XHRcdFx0dmFyIERPID0gZGVwZW5kZW50T2JzZXJ2YWJsZXMucG9wKCk7XG5cdFx0XHRcdFx0aWYgKERPKSB7XG5cdFx0XHRcdFx0XHRETygpO1xuXHRcdFx0XHRcdFx0XG5cdFx0XHRcdFx0XHQvLyBNb3ZlIHRoaXMgbWFnaWMgcHJvcGVydHkgdG8gdGhlIHVuZGVybHlpbmcgZGVwZW5kZW50IG9ic2VydmFibGVcblx0XHRcdFx0XHRcdERPLl9fRE9bXCJ0aHJvdHRsZUV2YWx1YXRpb25cIl0gPSBET1tcInRocm90dGxlRXZhbHVhdGlvblwiXTtcblx0XHRcdFx0XHR9XG5cdFx0XHRcdH1cblx0XHRcdH1cblxuXHRcdFx0Ly8gU2F2ZSBhbnkgbmV3IG1hcHBpbmcgb3B0aW9ucyBpbiB0aGUgdmlldyBtb2RlbCwgc28gdGhhdCB1cGRhdGVGcm9tSlMgY2FuIHVzZSB0aGVtIGxhdGVyLlxuXHRcdFx0cmVzdWx0W21hcHBpbmdQcm9wZXJ0eV0gPSBtZXJnZShyZXN1bHRbbWFwcGluZ1Byb3BlcnR5XSwgb3B0aW9ucyk7XG5cblx0XHRcdHJldHVybiByZXN1bHQ7XG5cdFx0fSBjYXRjaChlKSB7XG5cdFx0XHRtYXBwaW5nTmVzdGluZyA9IDA7XG5cdFx0XHR0aHJvdyBlO1xuXHRcdH1cblx0fTtcblxuXHRleHBvcnRzLmZyb21KU09OID0gZnVuY3Rpb24gKGpzb25TdHJpbmcgLyosIG9wdGlvbnMsIHRhcmdldCovICkge1xuXHRcdHZhciBwYXJzZWQgPSBrby51dGlscy5wYXJzZUpzb24oanNvblN0cmluZyk7XG5cdFx0YXJndW1lbnRzWzBdID0gcGFyc2VkO1xuXHRcdHJldHVybiBleHBvcnRzLmZyb21KUy5hcHBseSh0aGlzLCBhcmd1bWVudHMpO1xuXHR9O1xuXG5cdGV4cG9ydHMudXBkYXRlRnJvbUpTID0gZnVuY3Rpb24gKHZpZXdNb2RlbCkge1xuXHRcdHRocm93IG5ldyBFcnJvcihcImtvLm1hcHBpbmcudXBkYXRlRnJvbUpTLCB1c2Uga28ubWFwcGluZy5mcm9tSlMgaW5zdGVhZC4gUGxlYXNlIG5vdGUgdGhhdCB0aGUgb3JkZXIgb2YgcGFyYW1ldGVycyBpcyBkaWZmZXJlbnQhXCIpO1xuXHR9O1xuXG5cdGV4cG9ydHMudXBkYXRlRnJvbUpTT04gPSBmdW5jdGlvbiAodmlld01vZGVsKSB7XG5cdFx0dGhyb3cgbmV3IEVycm9yKFwia28ubWFwcGluZy51cGRhdGVGcm9tSlNPTiwgdXNlIGtvLm1hcHBpbmcuZnJvbUpTT04gaW5zdGVhZC4gUGxlYXNlIG5vdGUgdGhhdCB0aGUgb3JkZXIgb2YgcGFyYW1ldGVycyBpcyBkaWZmZXJlbnQhXCIpO1xuXHR9O1xuXG5cdGV4cG9ydHMudG9KUyA9IGZ1bmN0aW9uIChyb290T2JqZWN0LCBvcHRpb25zKSB7XG5cdFx0aWYgKCFkZWZhdWx0T3B0aW9ucykgZXhwb3J0cy5yZXNldERlZmF1bHRPcHRpb25zKCk7XG5cblx0XHRpZiAoYXJndW1lbnRzLmxlbmd0aCA9PSAwKSB0aHJvdyBuZXcgRXJyb3IoXCJXaGVuIGNhbGxpbmcga28ubWFwcGluZy50b0pTLCBwYXNzIHRoZSBvYmplY3QgeW91IHdhbnQgdG8gY29udmVydC5cIik7XG5cdFx0aWYgKGV4cG9ydHMuZ2V0VHlwZShkZWZhdWx0T3B0aW9ucy5pZ25vcmUpICE9PSBcImFycmF5XCIpIHRocm93IG5ldyBFcnJvcihcImtvLm1hcHBpbmcuZGVmYXVsdE9wdGlvbnMoKS5pZ25vcmUgc2hvdWxkIGJlIGFuIGFycmF5LlwiKTtcblx0XHRpZiAoZXhwb3J0cy5nZXRUeXBlKGRlZmF1bHRPcHRpb25zLmluY2x1ZGUpICE9PSBcImFycmF5XCIpIHRocm93IG5ldyBFcnJvcihcImtvLm1hcHBpbmcuZGVmYXVsdE9wdGlvbnMoKS5pbmNsdWRlIHNob3VsZCBiZSBhbiBhcnJheS5cIik7XG5cdFx0aWYgKGV4cG9ydHMuZ2V0VHlwZShkZWZhdWx0T3B0aW9ucy5jb3B5KSAhPT0gXCJhcnJheVwiKSB0aHJvdyBuZXcgRXJyb3IoXCJrby5tYXBwaW5nLmRlZmF1bHRPcHRpb25zKCkuY29weSBzaG91bGQgYmUgYW4gYXJyYXkuXCIpO1xuXG5cdFx0Ly8gTWVyZ2UgaW4gdGhlIG9wdGlvbnMgdXNlZCBpbiBmcm9tSlNcblx0XHRvcHRpb25zID0gZmlsbE9wdGlvbnMob3B0aW9ucywgcm9vdE9iamVjdFttYXBwaW5nUHJvcGVydHldKTtcblxuXHRcdC8vIFdlIGp1c3QgdW53cmFwIGV2ZXJ5dGhpbmcgYXQgZXZlcnkgbGV2ZWwgaW4gdGhlIG9iamVjdCBncmFwaFxuXHRcdHJldHVybiBleHBvcnRzLnZpc2l0TW9kZWwocm9vdE9iamVjdCwgZnVuY3Rpb24gKHgpIHtcblx0XHRcdHJldHVybiBrby51dGlscy51bndyYXBPYnNlcnZhYmxlKHgpXG5cdFx0fSwgb3B0aW9ucyk7XG5cdH07XG5cblx0ZXhwb3J0cy50b0pTT04gPSBmdW5jdGlvbiAocm9vdE9iamVjdCwgb3B0aW9ucykge1xuXHRcdHZhciBwbGFpbkphdmFTY3JpcHRPYmplY3QgPSBleHBvcnRzLnRvSlMocm9vdE9iamVjdCwgb3B0aW9ucyk7XG5cdFx0cmV0dXJuIGtvLnV0aWxzLnN0cmluZ2lmeUpzb24ocGxhaW5KYXZhU2NyaXB0T2JqZWN0KTtcblx0fTtcblxuXHRleHBvcnRzLmRlZmF1bHRPcHRpb25zID0gZnVuY3Rpb24gKCkge1xuXHRcdGlmIChhcmd1bWVudHMubGVuZ3RoID4gMCkge1xuXHRcdFx0ZGVmYXVsdE9wdGlvbnMgPSBhcmd1bWVudHNbMF07XG5cdFx0fSBlbHNlIHtcblx0XHRcdHJldHVybiBkZWZhdWx0T3B0aW9ucztcblx0XHR9XG5cdH07XG5cblx0ZXhwb3J0cy5yZXNldERlZmF1bHRPcHRpb25zID0gZnVuY3Rpb24gKCkge1xuXHRcdGRlZmF1bHRPcHRpb25zID0ge1xuXHRcdFx0aW5jbHVkZTogX2RlZmF1bHRPcHRpb25zLmluY2x1ZGUuc2xpY2UoMCksXG5cdFx0XHRpZ25vcmU6IF9kZWZhdWx0T3B0aW9ucy5pZ25vcmUuc2xpY2UoMCksXG5cdFx0XHRjb3B5OiBfZGVmYXVsdE9wdGlvbnMuY29weS5zbGljZSgwKVxuXHRcdH07XG5cdH07XG5cblx0ZXhwb3J0cy5nZXRUeXBlID0gZnVuY3Rpb24oeCkge1xuXHRcdGlmICgoeCkgJiYgKHR5cGVvZiAoeCkgPT09IFwib2JqZWN0XCIpKSB7XG5cdFx0XHRpZiAoeC5jb25zdHJ1Y3RvciA9PT0gRGF0ZSkgcmV0dXJuIFwiZGF0ZVwiO1xuXHRcdFx0aWYgKHguY29uc3RydWN0b3IgPT09IEFycmF5KSByZXR1cm4gXCJhcnJheVwiO1xuXHRcdH1cblx0XHRyZXR1cm4gdHlwZW9mIHg7XG5cdH1cblxuXHRmdW5jdGlvbiBmaWxsT3B0aW9ucyhyYXdPcHRpb25zLCBvdGhlck9wdGlvbnMpIHtcblx0XHR2YXIgb3B0aW9ucyA9IG1lcmdlKHt9LCByYXdPcHRpb25zKTtcblxuXHRcdC8vIE1vdmUgcmVjb2duaXplZCByb290LWxldmVsIHByb3BlcnRpZXMgaW50byBhIHJvb3QgbmFtZXNwYWNlXG5cdFx0Zm9yICh2YXIgaSA9IHJlY29nbml6ZWRSb290UHJvcGVydGllcy5sZW5ndGggLSAxOyBpID49IDA7IGktLSkge1xuXHRcdFx0dmFyIHByb3BlcnR5ID0gcmVjb2duaXplZFJvb3RQcm9wZXJ0aWVzW2ldO1xuXHRcdFx0XG5cdFx0XHQvLyBDYXJyeSBvbiwgdW5sZXNzIHRoaXMgcHJvcGVydHkgaXMgcHJlc2VudFxuXHRcdFx0aWYgKCFvcHRpb25zW3Byb3BlcnR5XSkgY29udGludWU7XG5cdFx0XHRcblx0XHRcdC8vIE1vdmUgdGhlIHByb3BlcnR5IGludG8gdGhlIHJvb3QgbmFtZXNwYWNlXG5cdFx0XHRpZiAoIShvcHRpb25zW1wiXCJdIGluc3RhbmNlb2YgT2JqZWN0KSkgb3B0aW9uc1tcIlwiXSA9IHt9O1xuXHRcdFx0b3B0aW9uc1tcIlwiXVtwcm9wZXJ0eV0gPSBvcHRpb25zW3Byb3BlcnR5XTtcblx0XHRcdGRlbGV0ZSBvcHRpb25zW3Byb3BlcnR5XTtcblx0XHR9XG5cblx0XHRpZiAob3RoZXJPcHRpb25zKSB7XG5cdFx0XHRvcHRpb25zLmlnbm9yZSA9IG1lcmdlQXJyYXlzKG90aGVyT3B0aW9ucy5pZ25vcmUsIG9wdGlvbnMuaWdub3JlKTtcblx0XHRcdG9wdGlvbnMuaW5jbHVkZSA9IG1lcmdlQXJyYXlzKG90aGVyT3B0aW9ucy5pbmNsdWRlLCBvcHRpb25zLmluY2x1ZGUpO1xuXHRcdFx0b3B0aW9ucy5jb3B5ID0gbWVyZ2VBcnJheXMob3RoZXJPcHRpb25zLmNvcHksIG9wdGlvbnMuY29weSk7XG5cdFx0XHRvcHRpb25zLm9ic2VydmUgPSBtZXJnZUFycmF5cyhvdGhlck9wdGlvbnMub2JzZXJ2ZSwgb3B0aW9ucy5vYnNlcnZlKTtcblx0XHR9XG5cdFx0b3B0aW9ucy5pZ25vcmUgPSBtZXJnZUFycmF5cyhvcHRpb25zLmlnbm9yZSwgZGVmYXVsdE9wdGlvbnMuaWdub3JlKTtcblx0XHRvcHRpb25zLmluY2x1ZGUgPSBtZXJnZUFycmF5cyhvcHRpb25zLmluY2x1ZGUsIGRlZmF1bHRPcHRpb25zLmluY2x1ZGUpO1xuXHRcdG9wdGlvbnMuY29weSA9IG1lcmdlQXJyYXlzKG9wdGlvbnMuY29weSwgZGVmYXVsdE9wdGlvbnMuY29weSk7XG5cdFx0b3B0aW9ucy5vYnNlcnZlID0gbWVyZ2VBcnJheXMob3B0aW9ucy5vYnNlcnZlLCBkZWZhdWx0T3B0aW9ucy5vYnNlcnZlKTtcblxuXHRcdG9wdGlvbnMubWFwcGVkUHJvcGVydGllcyA9IG9wdGlvbnMubWFwcGVkUHJvcGVydGllcyB8fCB7fTtcblx0XHRvcHRpb25zLmNvcGllZFByb3BlcnRpZXMgPSBvcHRpb25zLmNvcGllZFByb3BlcnRpZXMgfHwge307XG5cdFx0cmV0dXJuIG9wdGlvbnM7XG5cdH1cblxuXHRmdW5jdGlvbiBtZXJnZUFycmF5cyhhLCBiKSB7XG5cdFx0aWYgKGV4cG9ydHMuZ2V0VHlwZShhKSAhPT0gXCJhcnJheVwiKSB7XG5cdFx0XHRpZiAoZXhwb3J0cy5nZXRUeXBlKGEpID09PSBcInVuZGVmaW5lZFwiKSBhID0gW107XG5cdFx0XHRlbHNlIGEgPSBbYV07XG5cdFx0fVxuXHRcdGlmIChleHBvcnRzLmdldFR5cGUoYikgIT09IFwiYXJyYXlcIikge1xuXHRcdFx0aWYgKGV4cG9ydHMuZ2V0VHlwZShiKSA9PT0gXCJ1bmRlZmluZWRcIikgYiA9IFtdO1xuXHRcdFx0ZWxzZSBiID0gW2JdO1xuXHRcdH1cblxuXHRcdHJldHVybiBrby51dGlscy5hcnJheUdldERpc3RpbmN0VmFsdWVzKGEuY29uY2F0KGIpKTtcblx0fVxuXG5cdC8vIFdoZW4gdXNpbmcgYSAnY3JlYXRlJyBjYWxsYmFjaywgd2UgcHJveHkgdGhlIGRlcGVuZGVudCBvYnNlcnZhYmxlIHNvIHRoYXQgaXQgZG9lc24ndCBpbW1lZGlhdGVseSBldmFsdWF0ZSBvbiBjcmVhdGlvbi5cblx0Ly8gVGhlIHJlYXNvbiBpcyB0aGF0IHRoZSBkZXBlbmRlbnQgb2JzZXJ2YWJsZXMgaW4gdGhlIHVzZXItc3BlY2lmaWVkIGNhbGxiYWNrIG1heSBjb250YWluIHJlZmVyZW5jZXMgdG8gcHJvcGVydGllcyB0aGF0IGhhdmUgbm90IGJlZW4gbWFwcGVkIHlldC5cblx0ZnVuY3Rpb24gd2l0aFByb3h5RGVwZW5kZW50T2JzZXJ2YWJsZShkZXBlbmRlbnRPYnNlcnZhYmxlcywgY2FsbGJhY2spIHtcblx0XHR2YXIgbG9jYWxETyA9IGtvLmRlcGVuZGVudE9ic2VydmFibGU7XG5cdFx0a28uZGVwZW5kZW50T2JzZXJ2YWJsZSA9IGZ1bmN0aW9uIChyZWFkLCBvd25lciwgb3B0aW9ucykge1xuXHRcdFx0b3B0aW9ucyA9IG9wdGlvbnMgfHwge307XG5cblx0XHRcdGlmIChyZWFkICYmIHR5cGVvZiByZWFkID09IFwib2JqZWN0XCIpIHsgLy8gbWlycm9ycyBjb25kaXRpb24gaW4ga25vY2tvdXQgaW1wbGVtZW50YXRpb24gb2YgRE8nc1xuXHRcdFx0XHRvcHRpb25zID0gcmVhZDtcblx0XHRcdH1cblxuXHRcdFx0dmFyIHJlYWxEZWZlckV2YWx1YXRpb24gPSBvcHRpb25zLmRlZmVyRXZhbHVhdGlvbjtcblxuXHRcdFx0dmFyIGlzUmVtb3ZlZCA9IGZhbHNlO1xuXG5cdFx0XHQvLyBXZSB3cmFwIHRoZSBvcmlnaW5hbCBkZXBlbmRlbnQgb2JzZXJ2YWJsZSBzbyB0aGF0IHdlIGNhbiByZW1vdmUgaXQgZnJvbSB0aGUgJ2RlcGVuZGVudE9ic2VydmFibGVzJyBsaXN0IHdlIG5lZWQgdG8gZXZhbHVhdGUgYWZ0ZXIgbWFwcGluZyBoYXNcblx0XHRcdC8vIGNvbXBsZXRlZCBpZiB0aGUgdXNlciBhbHJlYWR5IGV2YWx1YXRlZCB0aGUgRE8gdGhlbXNlbHZlcyBpbiB0aGUgbWVhbnRpbWUuXG5cdFx0XHR2YXIgd3JhcCA9IGZ1bmN0aW9uIChETykge1xuXHRcdFx0XHQvLyBUZW1wb3JhcmlseSByZXZlcnQga28uZGVwZW5kZW50T2JzZXJ2YWJsZSwgc2luY2UgaXQgaXMgdXNlZCBpbiBrby5pc1dyaXRlYWJsZU9ic2VydmFibGVcblx0XHRcdFx0dmFyIHRtcCA9IGtvLmRlcGVuZGVudE9ic2VydmFibGU7XG5cdFx0XHRcdGtvLmRlcGVuZGVudE9ic2VydmFibGUgPSByZWFsS29EZXBlbmRlbnRPYnNlcnZhYmxlO1xuXHRcdFx0XHR2YXIgaXNXcml0ZWFibGUgPSBrby5pc1dyaXRlYWJsZU9ic2VydmFibGUoRE8pO1xuXHRcdFx0XHRrby5kZXBlbmRlbnRPYnNlcnZhYmxlID0gdG1wO1xuXG5cdFx0XHRcdHZhciB3cmFwcGVkID0gcmVhbEtvRGVwZW5kZW50T2JzZXJ2YWJsZSh7XG5cdFx0XHRcdFx0cmVhZDogZnVuY3Rpb24gKCkge1xuXHRcdFx0XHRcdFx0aWYgKCFpc1JlbW92ZWQpIHtcblx0XHRcdFx0XHRcdFx0a28udXRpbHMuYXJyYXlSZW1vdmVJdGVtKGRlcGVuZGVudE9ic2VydmFibGVzLCBETyk7XG5cdFx0XHRcdFx0XHRcdGlzUmVtb3ZlZCA9IHRydWU7XG5cdFx0XHRcdFx0XHR9XG5cdFx0XHRcdFx0XHRyZXR1cm4gRE8uYXBwbHkoRE8sIGFyZ3VtZW50cyk7XG5cdFx0XHRcdFx0fSxcblx0XHRcdFx0XHR3cml0ZTogaXNXcml0ZWFibGUgJiYgZnVuY3Rpb24gKHZhbCkge1xuXHRcdFx0XHRcdFx0cmV0dXJuIERPKHZhbCk7XG5cdFx0XHRcdFx0fSxcblx0XHRcdFx0XHRkZWZlckV2YWx1YXRpb246IHRydWVcblx0XHRcdFx0fSk7XG5cdFx0XHRcdGlmIChERUJVRykgd3JhcHBlZC5fd3JhcHBlciA9IHRydWU7XG5cdFx0XHRcdHdyYXBwZWQuX19ETyA9IERPO1xuXHRcdFx0XHRyZXR1cm4gd3JhcHBlZDtcblx0XHRcdH07XG5cdFx0XHRcblx0XHRcdG9wdGlvbnMuZGVmZXJFdmFsdWF0aW9uID0gdHJ1ZTsgLy8gd2lsbCBlaXRoZXIgc2V0IGZvciBqdXN0IG9wdGlvbnMsIG9yIGJvdGggcmVhZC9vcHRpb25zLlxuXHRcdFx0dmFyIHJlYWxEZXBlbmRlbnRPYnNlcnZhYmxlID0gbmV3IHJlYWxLb0RlcGVuZGVudE9ic2VydmFibGUocmVhZCwgb3duZXIsIG9wdGlvbnMpO1xuXG5cdFx0XHRpZiAoIXJlYWxEZWZlckV2YWx1YXRpb24pIHtcblx0XHRcdFx0cmVhbERlcGVuZGVudE9ic2VydmFibGUgPSB3cmFwKHJlYWxEZXBlbmRlbnRPYnNlcnZhYmxlKTtcblx0XHRcdFx0ZGVwZW5kZW50T2JzZXJ2YWJsZXMucHVzaChyZWFsRGVwZW5kZW50T2JzZXJ2YWJsZSk7XG5cdFx0XHR9XG5cblx0XHRcdHJldHVybiByZWFsRGVwZW5kZW50T2JzZXJ2YWJsZTtcblx0XHR9XG5cdFx0a28uZGVwZW5kZW50T2JzZXJ2YWJsZS5mbiA9IHJlYWxLb0RlcGVuZGVudE9ic2VydmFibGUuZm47XG5cdFx0a28uY29tcHV0ZWQgPSBrby5kZXBlbmRlbnRPYnNlcnZhYmxlO1xuXHRcdHZhciByZXN1bHQgPSBjYWxsYmFjaygpO1xuXHRcdGtvLmRlcGVuZGVudE9ic2VydmFibGUgPSBsb2NhbERPO1xuXHRcdGtvLmNvbXB1dGVkID0ga28uZGVwZW5kZW50T2JzZXJ2YWJsZTtcblx0XHRyZXR1cm4gcmVzdWx0O1xuXHR9XG5cblx0ZnVuY3Rpb24gdXBkYXRlVmlld01vZGVsKG1hcHBlZFJvb3RPYmplY3QsIHJvb3RPYmplY3QsIG9wdGlvbnMsIHBhcmVudE5hbWUsIHBhcmVudCwgcGFyZW50UHJvcGVydHlOYW1lLCBtYXBwZWRQYXJlbnQpIHtcblx0XHR2YXIgaXNBcnJheSA9IGV4cG9ydHMuZ2V0VHlwZShrby51dGlscy51bndyYXBPYnNlcnZhYmxlKHJvb3RPYmplY3QpKSA9PT0gXCJhcnJheVwiO1xuXG5cdFx0cGFyZW50UHJvcGVydHlOYW1lID0gcGFyZW50UHJvcGVydHlOYW1lIHx8IFwiXCI7XG5cblx0XHQvLyBJZiB0aGlzIG9iamVjdCB3YXMgYWxyZWFkeSBtYXBwZWQgcHJldmlvdXNseSwgdGFrZSB0aGUgb3B0aW9ucyBmcm9tIHRoZXJlIGFuZCBtZXJnZSB0aGVtIHdpdGggb3VyIGV4aXN0aW5nIG9uZXMuXG5cdFx0aWYgKGV4cG9ydHMuaXNNYXBwZWQobWFwcGVkUm9vdE9iamVjdCkpIHtcblx0XHRcdHZhciBwcmV2aW91c01hcHBpbmcgPSBrby51dGlscy51bndyYXBPYnNlcnZhYmxlKG1hcHBlZFJvb3RPYmplY3QpW21hcHBpbmdQcm9wZXJ0eV07XG5cdFx0XHRvcHRpb25zID0gbWVyZ2UocHJldmlvdXNNYXBwaW5nLCBvcHRpb25zKTtcblx0XHR9XG5cblx0XHR2YXIgY2FsbGJhY2tQYXJhbXMgPSB7XG5cdFx0XHRkYXRhOiByb290T2JqZWN0LFxuXHRcdFx0cGFyZW50OiBtYXBwZWRQYXJlbnQgfHwgcGFyZW50XG5cdFx0fTtcblxuXHRcdHZhciBoYXNDcmVhdGVDYWxsYmFjayA9IGZ1bmN0aW9uICgpIHtcblx0XHRcdHJldHVybiBvcHRpb25zW3BhcmVudE5hbWVdICYmIG9wdGlvbnNbcGFyZW50TmFtZV0uY3JlYXRlIGluc3RhbmNlb2YgRnVuY3Rpb247XG5cdFx0fTtcblxuXHRcdHZhciBjcmVhdGVDYWxsYmFjayA9IGZ1bmN0aW9uIChkYXRhKSB7XG5cdFx0XHRyZXR1cm4gd2l0aFByb3h5RGVwZW5kZW50T2JzZXJ2YWJsZShkZXBlbmRlbnRPYnNlcnZhYmxlcywgZnVuY3Rpb24gKCkge1xuXHRcdFx0XHRcblx0XHRcdFx0aWYgKGtvLnV0aWxzLnVud3JhcE9ic2VydmFibGUocGFyZW50KSBpbnN0YW5jZW9mIEFycmF5KSB7XG5cdFx0XHRcdFx0cmV0dXJuIG9wdGlvbnNbcGFyZW50TmFtZV0uY3JlYXRlKHtcblx0XHRcdFx0XHRcdGRhdGE6IGRhdGEgfHwgY2FsbGJhY2tQYXJhbXMuZGF0YSxcblx0XHRcdFx0XHRcdHBhcmVudDogY2FsbGJhY2tQYXJhbXMucGFyZW50LFxuXHRcdFx0XHRcdFx0c2tpcDogZW1wdHlSZXR1cm5cblx0XHRcdFx0XHR9KTtcblx0XHRcdFx0fSBlbHNlIHtcblx0XHRcdFx0XHRyZXR1cm4gb3B0aW9uc1twYXJlbnROYW1lXS5jcmVhdGUoe1xuXHRcdFx0XHRcdFx0ZGF0YTogZGF0YSB8fCBjYWxsYmFja1BhcmFtcy5kYXRhLFxuXHRcdFx0XHRcdFx0cGFyZW50OiBjYWxsYmFja1BhcmFtcy5wYXJlbnRcblx0XHRcdFx0XHR9KTtcblx0XHRcdFx0fVx0XHRcdFx0XG5cdFx0XHR9KTtcblx0XHR9O1xuXG5cdFx0dmFyIGhhc1VwZGF0ZUNhbGxiYWNrID0gZnVuY3Rpb24gKCkge1xuXHRcdFx0cmV0dXJuIG9wdGlvbnNbcGFyZW50TmFtZV0gJiYgb3B0aW9uc1twYXJlbnROYW1lXS51cGRhdGUgaW5zdGFuY2VvZiBGdW5jdGlvbjtcblx0XHR9O1xuXG5cdFx0dmFyIHVwZGF0ZUNhbGxiYWNrID0gZnVuY3Rpb24gKG9iaiwgZGF0YSkge1xuXHRcdFx0dmFyIHBhcmFtcyA9IHtcblx0XHRcdFx0ZGF0YTogZGF0YSB8fCBjYWxsYmFja1BhcmFtcy5kYXRhLFxuXHRcdFx0XHRwYXJlbnQ6IGNhbGxiYWNrUGFyYW1zLnBhcmVudCxcblx0XHRcdFx0dGFyZ2V0OiBrby51dGlscy51bndyYXBPYnNlcnZhYmxlKG9iailcblx0XHRcdH07XG5cblx0XHRcdGlmIChrby5pc1dyaXRlYWJsZU9ic2VydmFibGUob2JqKSkge1xuXHRcdFx0XHRwYXJhbXMub2JzZXJ2YWJsZSA9IG9iajtcblx0XHRcdH1cblxuXHRcdFx0cmV0dXJuIG9wdGlvbnNbcGFyZW50TmFtZV0udXBkYXRlKHBhcmFtcyk7XG5cdFx0fVxuXG5cdFx0dmFyIGFscmVhZHlNYXBwZWQgPSB2aXNpdGVkT2JqZWN0cy5nZXQocm9vdE9iamVjdCk7XG5cdFx0aWYgKGFscmVhZHlNYXBwZWQpIHtcblx0XHRcdHJldHVybiBhbHJlYWR5TWFwcGVkO1xuXHRcdH1cblxuXHRcdHBhcmVudE5hbWUgPSBwYXJlbnROYW1lIHx8IFwiXCI7XG5cblx0XHRpZiAoIWlzQXJyYXkpIHtcblx0XHRcdC8vIEZvciBhdG9taWMgdHlwZXMsIGRvIGEgZGlyZWN0IHVwZGF0ZSBvbiB0aGUgb2JzZXJ2YWJsZVxuXHRcdFx0aWYgKCFjYW5IYXZlUHJvcGVydGllcyhyb290T2JqZWN0KSkge1xuXHRcdFx0XHRzd2l0Y2ggKGV4cG9ydHMuZ2V0VHlwZShyb290T2JqZWN0KSkge1xuXHRcdFx0XHRjYXNlIFwiZnVuY3Rpb25cIjpcblx0XHRcdFx0XHRpZiAoaGFzVXBkYXRlQ2FsbGJhY2soKSkge1xuXHRcdFx0XHRcdFx0aWYgKGtvLmlzV3JpdGVhYmxlT2JzZXJ2YWJsZShyb290T2JqZWN0KSkge1xuXHRcdFx0XHRcdFx0XHRyb290T2JqZWN0KHVwZGF0ZUNhbGxiYWNrKHJvb3RPYmplY3QpKTtcblx0XHRcdFx0XHRcdFx0bWFwcGVkUm9vdE9iamVjdCA9IHJvb3RPYmplY3Q7XG5cdFx0XHRcdFx0XHR9IGVsc2Uge1xuXHRcdFx0XHRcdFx0XHRtYXBwZWRSb290T2JqZWN0ID0gdXBkYXRlQ2FsbGJhY2socm9vdE9iamVjdCk7XG5cdFx0XHRcdFx0XHR9XG5cdFx0XHRcdFx0fSBlbHNlIHtcblx0XHRcdFx0XHRcdG1hcHBlZFJvb3RPYmplY3QgPSByb290T2JqZWN0O1xuXHRcdFx0XHRcdH1cblx0XHRcdFx0XHRicmVhaztcblx0XHRcdFx0ZGVmYXVsdDpcblx0XHRcdFx0XHRpZiAoa28uaXNXcml0ZWFibGVPYnNlcnZhYmxlKG1hcHBlZFJvb3RPYmplY3QpKSB7XG5cdFx0XHRcdFx0XHRpZiAoaGFzVXBkYXRlQ2FsbGJhY2soKSkge1xuXHRcdFx0XHRcdFx0XHR2YXIgdmFsdWVUb1dyaXRlID0gdXBkYXRlQ2FsbGJhY2sobWFwcGVkUm9vdE9iamVjdCk7XG5cdFx0XHRcdFx0XHRcdG1hcHBlZFJvb3RPYmplY3QodmFsdWVUb1dyaXRlKTtcblx0XHRcdFx0XHRcdFx0cmV0dXJuIHZhbHVlVG9Xcml0ZTtcblx0XHRcdFx0XHRcdH0gZWxzZSB7XG5cdFx0XHRcdFx0XHRcdHZhciB2YWx1ZVRvV3JpdGUgPSBrby51dGlscy51bndyYXBPYnNlcnZhYmxlKHJvb3RPYmplY3QpO1xuXHRcdFx0XHRcdFx0XHRtYXBwZWRSb290T2JqZWN0KHZhbHVlVG9Xcml0ZSk7XG5cdFx0XHRcdFx0XHRcdHJldHVybiB2YWx1ZVRvV3JpdGU7XG5cdFx0XHRcdFx0XHR9XG5cdFx0XHRcdFx0fSBlbHNlIHtcblx0XHRcdFx0XHRcdHZhciBoYXNDcmVhdGVPclVwZGF0ZUNhbGxiYWNrID0gaGFzQ3JlYXRlQ2FsbGJhY2soKSB8fCBoYXNVcGRhdGVDYWxsYmFjaygpO1xuXHRcdFx0XHRcdFx0XG5cdFx0XHRcdFx0XHRpZiAoaGFzQ3JlYXRlQ2FsbGJhY2soKSkge1xuXHRcdFx0XHRcdFx0XHRtYXBwZWRSb290T2JqZWN0ID0gY3JlYXRlQ2FsbGJhY2soKTtcblx0XHRcdFx0XHRcdH0gZWxzZSB7XG5cdFx0XHRcdFx0XHRcdG1hcHBlZFJvb3RPYmplY3QgPSBrby5vYnNlcnZhYmxlKGtvLnV0aWxzLnVud3JhcE9ic2VydmFibGUocm9vdE9iamVjdCkpO1xuXHRcdFx0XHRcdFx0fVxuXG5cdFx0XHRcdFx0XHRpZiAoaGFzVXBkYXRlQ2FsbGJhY2soKSkge1xuXHRcdFx0XHRcdFx0XHRtYXBwZWRSb290T2JqZWN0KHVwZGF0ZUNhbGxiYWNrKG1hcHBlZFJvb3RPYmplY3QpKTtcblx0XHRcdFx0XHRcdH1cblx0XHRcdFx0XHRcdFxuXHRcdFx0XHRcdFx0aWYgKGhhc0NyZWF0ZU9yVXBkYXRlQ2FsbGJhY2spIHJldHVybiBtYXBwZWRSb290T2JqZWN0O1xuXHRcdFx0XHRcdH1cblx0XHRcdFx0fVxuXG5cdFx0XHR9IGVsc2Uge1xuXHRcdFx0XHRtYXBwZWRSb290T2JqZWN0ID0ga28udXRpbHMudW53cmFwT2JzZXJ2YWJsZShtYXBwZWRSb290T2JqZWN0KTtcblx0XHRcdFx0aWYgKCFtYXBwZWRSb290T2JqZWN0KSB7XG5cdFx0XHRcdFx0aWYgKGhhc0NyZWF0ZUNhbGxiYWNrKCkpIHtcblx0XHRcdFx0XHRcdHZhciByZXN1bHQgPSBjcmVhdGVDYWxsYmFjaygpO1xuXG5cdFx0XHRcdFx0XHRpZiAoaGFzVXBkYXRlQ2FsbGJhY2soKSkge1xuXHRcdFx0XHRcdFx0XHRyZXN1bHQgPSB1cGRhdGVDYWxsYmFjayhyZXN1bHQpO1xuXHRcdFx0XHRcdFx0fVxuXG5cdFx0XHRcdFx0XHRyZXR1cm4gcmVzdWx0O1xuXHRcdFx0XHRcdH0gZWxzZSB7XG5cdFx0XHRcdFx0XHRpZiAoaGFzVXBkYXRlQ2FsbGJhY2soKSkge1xuXHRcdFx0XHRcdFx0XHRyZXR1cm4gdXBkYXRlQ2FsbGJhY2socmVzdWx0KTtcblx0XHRcdFx0XHRcdH1cblxuXHRcdFx0XHRcdFx0bWFwcGVkUm9vdE9iamVjdCA9IHt9O1xuXHRcdFx0XHRcdH1cblx0XHRcdFx0fVxuXG5cdFx0XHRcdGlmIChoYXNVcGRhdGVDYWxsYmFjaygpKSB7XG5cdFx0XHRcdFx0bWFwcGVkUm9vdE9iamVjdCA9IHVwZGF0ZUNhbGxiYWNrKG1hcHBlZFJvb3RPYmplY3QpO1xuXHRcdFx0XHR9XG5cblx0XHRcdFx0dmlzaXRlZE9iamVjdHMuc2F2ZShyb290T2JqZWN0LCBtYXBwZWRSb290T2JqZWN0KTtcblx0XHRcdFx0aWYgKGhhc1VwZGF0ZUNhbGxiYWNrKCkpIHJldHVybiBtYXBwZWRSb290T2JqZWN0O1xuXG5cdFx0XHRcdC8vIEZvciBub24tYXRvbWljIHR5cGVzLCB2aXNpdCBhbGwgcHJvcGVydGllcyBhbmQgdXBkYXRlIHJlY3Vyc2l2ZWx5XG5cdFx0XHRcdHZpc2l0UHJvcGVydGllc09yQXJyYXlFbnRyaWVzKHJvb3RPYmplY3QsIGZ1bmN0aW9uIChpbmRleGVyKSB7XG5cdFx0XHRcdFx0dmFyIGZ1bGxQcm9wZXJ0eU5hbWUgPSBwYXJlbnRQcm9wZXJ0eU5hbWUubGVuZ3RoID8gcGFyZW50UHJvcGVydHlOYW1lICsgXCIuXCIgKyBpbmRleGVyIDogaW5kZXhlcjtcblxuXHRcdFx0XHRcdGlmIChrby51dGlscy5hcnJheUluZGV4T2Yob3B0aW9ucy5pZ25vcmUsIGZ1bGxQcm9wZXJ0eU5hbWUpICE9IC0xKSB7XG5cdFx0XHRcdFx0XHRyZXR1cm47XG5cdFx0XHRcdFx0fVxuXG5cdFx0XHRcdFx0aWYgKGtvLnV0aWxzLmFycmF5SW5kZXhPZihvcHRpb25zLmNvcHksIGZ1bGxQcm9wZXJ0eU5hbWUpICE9IC0xKSB7XG5cdFx0XHRcdFx0XHRtYXBwZWRSb290T2JqZWN0W2luZGV4ZXJdID0gcm9vdE9iamVjdFtpbmRleGVyXTtcblx0XHRcdFx0XHRcdHJldHVybjtcblx0XHRcdFx0XHR9XG5cblx0XHRcdFx0XHRpZih0eXBlb2Ygcm9vdE9iamVjdFtpbmRleGVyXSAhPSBcIm9iamVjdFwiICYmIHR5cGVvZiByb290T2JqZWN0W2luZGV4ZXJdICE9IFwiYXJyYXlcIiAmJiBvcHRpb25zLm9ic2VydmUubGVuZ3RoID4gMCAmJiBrby51dGlscy5hcnJheUluZGV4T2Yob3B0aW9ucy5vYnNlcnZlLCBmdWxsUHJvcGVydHlOYW1lKSA9PSAtMSlcblx0XHRcdFx0XHR7XG5cdFx0XHRcdFx0XHRtYXBwZWRSb290T2JqZWN0W2luZGV4ZXJdID0gcm9vdE9iamVjdFtpbmRleGVyXTtcblx0XHRcdFx0XHRcdG9wdGlvbnMuY29waWVkUHJvcGVydGllc1tmdWxsUHJvcGVydHlOYW1lXSA9IHRydWU7XG5cdFx0XHRcdFx0XHRyZXR1cm47XG5cdFx0XHRcdFx0fVxuXHRcdFx0XHRcdFxuXHRcdFx0XHRcdC8vIEluIGNhc2Ugd2UgYXJlIGFkZGluZyBhbiBhbHJlYWR5IG1hcHBlZCBwcm9wZXJ0eSwgZmlsbCBpdCB3aXRoIHRoZSBwcmV2aW91c2x5IG1hcHBlZCBwcm9wZXJ0eSB2YWx1ZSB0byBwcmV2ZW50IHJlY3Vyc2lvbi5cblx0XHRcdFx0XHQvLyBJZiB0aGlzIGlzIGEgcHJvcGVydHkgdGhhdCB3YXMgZ2VuZXJhdGVkIGJ5IGZyb21KUywgd2Ugc2hvdWxkIHVzZSB0aGUgb3B0aW9ucyBzcGVjaWZpZWQgdGhlcmVcblx0XHRcdFx0XHR2YXIgcHJldk1hcHBlZFByb3BlcnR5ID0gdmlzaXRlZE9iamVjdHMuZ2V0KHJvb3RPYmplY3RbaW5kZXhlcl0pO1xuXHRcdFx0XHRcdHZhciByZXR2YWwgPSB1cGRhdGVWaWV3TW9kZWwobWFwcGVkUm9vdE9iamVjdFtpbmRleGVyXSwgcm9vdE9iamVjdFtpbmRleGVyXSwgb3B0aW9ucywgaW5kZXhlciwgbWFwcGVkUm9vdE9iamVjdCwgZnVsbFByb3BlcnR5TmFtZSwgbWFwcGVkUm9vdE9iamVjdCk7XG5cdFx0XHRcdFx0dmFyIHZhbHVlID0gcHJldk1hcHBlZFByb3BlcnR5IHx8IHJldHZhbDtcblx0XHRcdFx0XHRcblx0XHRcdFx0XHRpZihvcHRpb25zLm9ic2VydmUubGVuZ3RoID4gMCAmJiBrby51dGlscy5hcnJheUluZGV4T2Yob3B0aW9ucy5vYnNlcnZlLCBmdWxsUHJvcGVydHlOYW1lKSA9PSAtMSlcblx0XHRcdFx0XHR7XG5cdFx0XHRcdFx0XHRtYXBwZWRSb290T2JqZWN0W2luZGV4ZXJdID0gdmFsdWUoKTtcblx0XHRcdFx0XHRcdG9wdGlvbnMuY29waWVkUHJvcGVydGllc1tmdWxsUHJvcGVydHlOYW1lXSA9IHRydWU7XG5cdFx0XHRcdFx0XHRyZXR1cm47XG5cdFx0XHRcdFx0fVxuXHRcdFx0XHRcdFxuXHRcdFx0XHRcdGlmIChrby5pc1dyaXRlYWJsZU9ic2VydmFibGUobWFwcGVkUm9vdE9iamVjdFtpbmRleGVyXSkpIHtcblx0XHRcdFx0XHRcdHZhbHVlID0ga28udXRpbHMudW53cmFwT2JzZXJ2YWJsZSh2YWx1ZSk7XG5cdFx0XHRcdFx0XHRpZiAobWFwcGVkUm9vdE9iamVjdFtpbmRleGVyXSgpICE9PSB2YWx1ZSkge1xuXHRcdFx0XHRcdFx0XHRtYXBwZWRSb290T2JqZWN0W2luZGV4ZXJdKHZhbHVlKTtcblx0XHRcdFx0XHRcdH1cblx0XHRcdFx0XHR9IGVsc2Uge1xuXHRcdFx0XHRcdFx0dmFsdWUgPSBtYXBwZWRSb290T2JqZWN0W2luZGV4ZXJdID09PSB1bmRlZmluZWQgPyB2YWx1ZSA6IGtvLnV0aWxzLnVud3JhcE9ic2VydmFibGUodmFsdWUpO1xuXHRcdFx0XHRcdFx0bWFwcGVkUm9vdE9iamVjdFtpbmRleGVyXSA9IHZhbHVlO1xuXHRcdFx0XHRcdH1cblxuXHRcdFx0XHRcdG9wdGlvbnMubWFwcGVkUHJvcGVydGllc1tmdWxsUHJvcGVydHlOYW1lXSA9IHRydWU7XG5cdFx0XHRcdH0pO1xuXHRcdFx0fVxuXHRcdH0gZWxzZSB7IC8vbWFwcGVkUm9vdE9iamVjdCBpcyBhbiBhcnJheVxuXHRcdFx0dmFyIGNoYW5nZXMgPSBbXTtcblxuXHRcdFx0dmFyIGhhc0tleUNhbGxiYWNrID0gZmFsc2U7XG5cdFx0XHR2YXIga2V5Q2FsbGJhY2sgPSBmdW5jdGlvbiAoeCkge1xuXHRcdFx0XHRyZXR1cm4geDtcblx0XHRcdH1cblx0XHRcdGlmIChvcHRpb25zW3BhcmVudE5hbWVdICYmIG9wdGlvbnNbcGFyZW50TmFtZV0ua2V5KSB7XG5cdFx0XHRcdGtleUNhbGxiYWNrID0gb3B0aW9uc1twYXJlbnROYW1lXS5rZXk7XG5cdFx0XHRcdGhhc0tleUNhbGxiYWNrID0gdHJ1ZTtcblx0XHRcdH1cblxuXHRcdFx0aWYgKCFrby5pc09ic2VydmFibGUobWFwcGVkUm9vdE9iamVjdCkpIHtcblx0XHRcdFx0Ly8gV2hlbiBjcmVhdGluZyB0aGUgbmV3IG9ic2VydmFibGUgYXJyYXksIGFsc28gYWRkIGEgYnVuY2ggb2YgdXRpbGl0eSBmdW5jdGlvbnMgdGhhdCB0YWtlIHRoZSAna2V5JyBvZiB0aGUgYXJyYXkgaXRlbXMgaW50byBhY2NvdW50LlxuXHRcdFx0XHRtYXBwZWRSb290T2JqZWN0ID0ga28ub2JzZXJ2YWJsZUFycmF5KFtdKTtcblxuXHRcdFx0XHRtYXBwZWRSb290T2JqZWN0Lm1hcHBlZFJlbW92ZSA9IGZ1bmN0aW9uICh2YWx1ZU9yUHJlZGljYXRlKSB7XG5cdFx0XHRcdFx0dmFyIHByZWRpY2F0ZSA9IHR5cGVvZiB2YWx1ZU9yUHJlZGljYXRlID09IFwiZnVuY3Rpb25cIiA/IHZhbHVlT3JQcmVkaWNhdGUgOiBmdW5jdGlvbiAodmFsdWUpIHtcblx0XHRcdFx0XHRcdFx0cmV0dXJuIHZhbHVlID09PSBrZXlDYWxsYmFjayh2YWx1ZU9yUHJlZGljYXRlKTtcblx0XHRcdFx0XHRcdH07XG5cdFx0XHRcdFx0cmV0dXJuIG1hcHBlZFJvb3RPYmplY3QucmVtb3ZlKGZ1bmN0aW9uIChpdGVtKSB7XG5cdFx0XHRcdFx0XHRyZXR1cm4gcHJlZGljYXRlKGtleUNhbGxiYWNrKGl0ZW0pKTtcblx0XHRcdFx0XHR9KTtcblx0XHRcdFx0fVxuXG5cdFx0XHRcdG1hcHBlZFJvb3RPYmplY3QubWFwcGVkUmVtb3ZlQWxsID0gZnVuY3Rpb24gKGFycmF5T2ZWYWx1ZXMpIHtcblx0XHRcdFx0XHR2YXIgYXJyYXlPZktleXMgPSBmaWx0ZXJBcnJheUJ5S2V5KGFycmF5T2ZWYWx1ZXMsIGtleUNhbGxiYWNrKTtcblx0XHRcdFx0XHRyZXR1cm4gbWFwcGVkUm9vdE9iamVjdC5yZW1vdmUoZnVuY3Rpb24gKGl0ZW0pIHtcblx0XHRcdFx0XHRcdHJldHVybiBrby51dGlscy5hcnJheUluZGV4T2YoYXJyYXlPZktleXMsIGtleUNhbGxiYWNrKGl0ZW0pKSAhPSAtMTtcblx0XHRcdFx0XHR9KTtcblx0XHRcdFx0fVxuXG5cdFx0XHRcdG1hcHBlZFJvb3RPYmplY3QubWFwcGVkRGVzdHJveSA9IGZ1bmN0aW9uICh2YWx1ZU9yUHJlZGljYXRlKSB7XG5cdFx0XHRcdFx0dmFyIHByZWRpY2F0ZSA9IHR5cGVvZiB2YWx1ZU9yUHJlZGljYXRlID09IFwiZnVuY3Rpb25cIiA/IHZhbHVlT3JQcmVkaWNhdGUgOiBmdW5jdGlvbiAodmFsdWUpIHtcblx0XHRcdFx0XHRcdFx0cmV0dXJuIHZhbHVlID09PSBrZXlDYWxsYmFjayh2YWx1ZU9yUHJlZGljYXRlKTtcblx0XHRcdFx0XHRcdH07XG5cdFx0XHRcdFx0cmV0dXJuIG1hcHBlZFJvb3RPYmplY3QuZGVzdHJveShmdW5jdGlvbiAoaXRlbSkge1xuXHRcdFx0XHRcdFx0cmV0dXJuIHByZWRpY2F0ZShrZXlDYWxsYmFjayhpdGVtKSk7XG5cdFx0XHRcdFx0fSk7XG5cdFx0XHRcdH1cblxuXHRcdFx0XHRtYXBwZWRSb290T2JqZWN0Lm1hcHBlZERlc3Ryb3lBbGwgPSBmdW5jdGlvbiAoYXJyYXlPZlZhbHVlcykge1xuXHRcdFx0XHRcdHZhciBhcnJheU9mS2V5cyA9IGZpbHRlckFycmF5QnlLZXkoYXJyYXlPZlZhbHVlcywga2V5Q2FsbGJhY2spO1xuXHRcdFx0XHRcdHJldHVybiBtYXBwZWRSb290T2JqZWN0LmRlc3Ryb3koZnVuY3Rpb24gKGl0ZW0pIHtcblx0XHRcdFx0XHRcdHJldHVybiBrby51dGlscy5hcnJheUluZGV4T2YoYXJyYXlPZktleXMsIGtleUNhbGxiYWNrKGl0ZW0pKSAhPSAtMTtcblx0XHRcdFx0XHR9KTtcblx0XHRcdFx0fVxuXG5cdFx0XHRcdG1hcHBlZFJvb3RPYmplY3QubWFwcGVkSW5kZXhPZiA9IGZ1bmN0aW9uIChpdGVtKSB7XG5cdFx0XHRcdFx0dmFyIGtleXMgPSBmaWx0ZXJBcnJheUJ5S2V5KG1hcHBlZFJvb3RPYmplY3QoKSwga2V5Q2FsbGJhY2spO1xuXHRcdFx0XHRcdHZhciBrZXkgPSBrZXlDYWxsYmFjayhpdGVtKTtcblx0XHRcdFx0XHRyZXR1cm4ga28udXRpbHMuYXJyYXlJbmRleE9mKGtleXMsIGtleSk7XG5cdFx0XHRcdH1cblxuXHRcdFx0XHRtYXBwZWRSb290T2JqZWN0Lm1hcHBlZEdldCA9IGZ1bmN0aW9uIChpdGVtKSB7XG5cdFx0XHRcdFx0cmV0dXJuIG1hcHBlZFJvb3RPYmplY3QoKVttYXBwZWRSb290T2JqZWN0Lm1hcHBlZEluZGV4T2YoaXRlbSldO1xuXHRcdFx0XHR9XG5cblx0XHRcdFx0bWFwcGVkUm9vdE9iamVjdC5tYXBwZWRDcmVhdGUgPSBmdW5jdGlvbiAodmFsdWUpIHtcblx0XHRcdFx0XHRpZiAobWFwcGVkUm9vdE9iamVjdC5tYXBwZWRJbmRleE9mKHZhbHVlKSAhPT0gLTEpIHtcblx0XHRcdFx0XHRcdHRocm93IG5ldyBFcnJvcihcIlRoZXJlIGFscmVhZHkgaXMgYW4gb2JqZWN0IHdpdGggdGhlIGtleSB0aGF0IHlvdSBzcGVjaWZpZWQuXCIpO1xuXHRcdFx0XHRcdH1cblxuXHRcdFx0XHRcdHZhciBpdGVtID0gaGFzQ3JlYXRlQ2FsbGJhY2soKSA/IGNyZWF0ZUNhbGxiYWNrKHZhbHVlKSA6IHZhbHVlO1xuXHRcdFx0XHRcdGlmIChoYXNVcGRhdGVDYWxsYmFjaygpKSB7XG5cdFx0XHRcdFx0XHR2YXIgbmV3VmFsdWUgPSB1cGRhdGVDYWxsYmFjayhpdGVtLCB2YWx1ZSk7XG5cdFx0XHRcdFx0XHRpZiAoa28uaXNXcml0ZWFibGVPYnNlcnZhYmxlKGl0ZW0pKSB7XG5cdFx0XHRcdFx0XHRcdGl0ZW0obmV3VmFsdWUpO1xuXHRcdFx0XHRcdFx0fSBlbHNlIHtcblx0XHRcdFx0XHRcdFx0aXRlbSA9IG5ld1ZhbHVlO1xuXHRcdFx0XHRcdFx0fVxuXHRcdFx0XHRcdH1cblx0XHRcdFx0XHRtYXBwZWRSb290T2JqZWN0LnB1c2goaXRlbSk7XG5cdFx0XHRcdFx0cmV0dXJuIGl0ZW07XG5cdFx0XHRcdH1cblx0XHRcdH1cblxuXHRcdFx0dmFyIGN1cnJlbnRBcnJheUtleXMgPSBmaWx0ZXJBcnJheUJ5S2V5KGtvLnV0aWxzLnVud3JhcE9ic2VydmFibGUobWFwcGVkUm9vdE9iamVjdCksIGtleUNhbGxiYWNrKS5zb3J0KCk7XG5cdFx0XHR2YXIgbmV3QXJyYXlLZXlzID0gZmlsdGVyQXJyYXlCeUtleShyb290T2JqZWN0LCBrZXlDYWxsYmFjayk7XG5cdFx0XHRpZiAoaGFzS2V5Q2FsbGJhY2spIG5ld0FycmF5S2V5cy5zb3J0KCk7XG5cdFx0XHR2YXIgZWRpdFNjcmlwdCA9IGtvLnV0aWxzLmNvbXBhcmVBcnJheXMoY3VycmVudEFycmF5S2V5cywgbmV3QXJyYXlLZXlzKTtcblxuXHRcdFx0dmFyIGlnbm9yZUluZGV4T2YgPSB7fTtcblx0XHRcdFxuXHRcdFx0dmFyIGksIGo7XG5cblx0XHRcdHZhciB1bndyYXBwZWRSb290T2JqZWN0ID0ga28udXRpbHMudW53cmFwT2JzZXJ2YWJsZShyb290T2JqZWN0KTtcblx0XHRcdHZhciBpdGVtc0J5S2V5ID0ge307XG5cdFx0XHR2YXIgb3B0aW1pemVkS2V5cyA9IHRydWU7XG5cdFx0XHRmb3IgKGkgPSAwLCBqID0gdW53cmFwcGVkUm9vdE9iamVjdC5sZW5ndGg7IGkgPCBqOyBpKyspIHtcblx0XHRcdFx0dmFyIGtleSA9IGtleUNhbGxiYWNrKHVud3JhcHBlZFJvb3RPYmplY3RbaV0pO1xuXHRcdFx0XHRpZiAoa2V5ID09PSB1bmRlZmluZWQgfHwga2V5IGluc3RhbmNlb2YgT2JqZWN0KSB7XG5cdFx0XHRcdFx0b3B0aW1pemVkS2V5cyA9IGZhbHNlO1xuXHRcdFx0XHRcdGJyZWFrO1xuXHRcdFx0XHR9XG5cdFx0XHRcdGl0ZW1zQnlLZXlba2V5XSA9IHVud3JhcHBlZFJvb3RPYmplY3RbaV07XG5cdFx0XHR9XG5cblx0XHRcdHZhciBuZXdDb250ZW50cyA9IFtdO1xuXHRcdFx0dmFyIHBhc3NlZE92ZXIgPSAwO1xuXHRcdFx0Zm9yIChpID0gMCwgaiA9IGVkaXRTY3JpcHQubGVuZ3RoOyBpIDwgajsgaSsrKSB7XG5cdFx0XHRcdHZhciBrZXkgPSBlZGl0U2NyaXB0W2ldO1xuXHRcdFx0XHR2YXIgbWFwcGVkSXRlbTtcblx0XHRcdFx0dmFyIGZ1bGxQcm9wZXJ0eU5hbWUgPSBwYXJlbnRQcm9wZXJ0eU5hbWUgKyBcIltcIiArIGkgKyBcIl1cIjtcblx0XHRcdFx0c3dpdGNoIChrZXkuc3RhdHVzKSB7XG5cdFx0XHRcdGNhc2UgXCJhZGRlZFwiOlxuXHRcdFx0XHRcdHZhciBpdGVtID0gb3B0aW1pemVkS2V5cyA/IGl0ZW1zQnlLZXlba2V5LnZhbHVlXSA6IGdldEl0ZW1CeUtleShrby51dGlscy51bndyYXBPYnNlcnZhYmxlKHJvb3RPYmplY3QpLCBrZXkudmFsdWUsIGtleUNhbGxiYWNrKTtcblx0XHRcdFx0XHRtYXBwZWRJdGVtID0gdXBkYXRlVmlld01vZGVsKHVuZGVmaW5lZCwgaXRlbSwgb3B0aW9ucywgcGFyZW50TmFtZSwgbWFwcGVkUm9vdE9iamVjdCwgZnVsbFByb3BlcnR5TmFtZSwgcGFyZW50KTtcblx0XHRcdFx0XHRpZighaGFzQ3JlYXRlQ2FsbGJhY2soKSkge1xuXHRcdFx0XHRcdFx0bWFwcGVkSXRlbSA9IGtvLnV0aWxzLnVud3JhcE9ic2VydmFibGUobWFwcGVkSXRlbSk7XG5cdFx0XHRcdFx0fVxuXG5cdFx0XHRcdFx0dmFyIGluZGV4ID0gaWdub3JhYmxlSW5kZXhPZihrby51dGlscy51bndyYXBPYnNlcnZhYmxlKHJvb3RPYmplY3QpLCBpdGVtLCBpZ25vcmVJbmRleE9mKTtcblx0XHRcdFx0XHRcblx0XHRcdFx0XHRpZiAobWFwcGVkSXRlbSA9PT0gZW1wdHlSZXR1cm4pIHtcblx0XHRcdFx0XHRcdHBhc3NlZE92ZXIrKztcblx0XHRcdFx0XHR9IGVsc2Uge1xuXHRcdFx0XHRcdFx0bmV3Q29udGVudHNbaW5kZXggLSBwYXNzZWRPdmVyXSA9IG1hcHBlZEl0ZW07XG5cdFx0XHRcdFx0fVxuXHRcdFx0XHRcdFx0XG5cdFx0XHRcdFx0aWdub3JlSW5kZXhPZltpbmRleF0gPSB0cnVlO1xuXHRcdFx0XHRcdGJyZWFrO1xuXHRcdFx0XHRjYXNlIFwicmV0YWluZWRcIjpcblx0XHRcdFx0XHR2YXIgaXRlbSA9IG9wdGltaXplZEtleXMgPyBpdGVtc0J5S2V5W2tleS52YWx1ZV0gOiBnZXRJdGVtQnlLZXkoa28udXRpbHMudW53cmFwT2JzZXJ2YWJsZShyb290T2JqZWN0KSwga2V5LnZhbHVlLCBrZXlDYWxsYmFjayk7XG5cdFx0XHRcdFx0bWFwcGVkSXRlbSA9IGdldEl0ZW1CeUtleShtYXBwZWRSb290T2JqZWN0LCBrZXkudmFsdWUsIGtleUNhbGxiYWNrKTtcblx0XHRcdFx0XHR1cGRhdGVWaWV3TW9kZWwobWFwcGVkSXRlbSwgaXRlbSwgb3B0aW9ucywgcGFyZW50TmFtZSwgbWFwcGVkUm9vdE9iamVjdCwgZnVsbFByb3BlcnR5TmFtZSwgcGFyZW50KTtcblxuXHRcdFx0XHRcdHZhciBpbmRleCA9IGlnbm9yYWJsZUluZGV4T2Yoa28udXRpbHMudW53cmFwT2JzZXJ2YWJsZShyb290T2JqZWN0KSwgaXRlbSwgaWdub3JlSW5kZXhPZik7XG5cdFx0XHRcdFx0bmV3Q29udGVudHNbaW5kZXhdID0gbWFwcGVkSXRlbTtcblx0XHRcdFx0XHRpZ25vcmVJbmRleE9mW2luZGV4XSA9IHRydWU7XG5cdFx0XHRcdFx0YnJlYWs7XG5cdFx0XHRcdGNhc2UgXCJkZWxldGVkXCI6XG5cdFx0XHRcdFx0bWFwcGVkSXRlbSA9IGdldEl0ZW1CeUtleShtYXBwZWRSb290T2JqZWN0LCBrZXkudmFsdWUsIGtleUNhbGxiYWNrKTtcblx0XHRcdFx0XHRicmVhaztcblx0XHRcdFx0fVxuXG5cdFx0XHRcdGNoYW5nZXMucHVzaCh7XG5cdFx0XHRcdFx0ZXZlbnQ6IGtleS5zdGF0dXMsXG5cdFx0XHRcdFx0aXRlbTogbWFwcGVkSXRlbVxuXHRcdFx0XHR9KTtcblx0XHRcdH1cblxuXHRcdFx0bWFwcGVkUm9vdE9iamVjdChuZXdDb250ZW50cyk7XG5cblx0XHRcdGlmIChvcHRpb25zW3BhcmVudE5hbWVdICYmIG9wdGlvbnNbcGFyZW50TmFtZV0uYXJyYXlDaGFuZ2VkKSB7XG5cdFx0XHRcdGtvLnV0aWxzLmFycmF5Rm9yRWFjaChjaGFuZ2VzLCBmdW5jdGlvbiAoY2hhbmdlKSB7XG5cdFx0XHRcdFx0b3B0aW9uc1twYXJlbnROYW1lXS5hcnJheUNoYW5nZWQoY2hhbmdlLmV2ZW50LCBjaGFuZ2UuaXRlbSk7XG5cdFx0XHRcdH0pO1xuXHRcdFx0fVxuXHRcdH1cblxuXHRcdHJldHVybiBtYXBwZWRSb290T2JqZWN0O1xuXHR9XG5cblx0ZnVuY3Rpb24gaWdub3JhYmxlSW5kZXhPZihhcnJheSwgaXRlbSwgaWdub3JlSW5kaWNlcykge1xuXHRcdGZvciAodmFyIGkgPSAwLCBqID0gYXJyYXkubGVuZ3RoOyBpIDwgajsgaSsrKSB7XG5cdFx0XHRpZiAoaWdub3JlSW5kaWNlc1tpXSA9PT0gdHJ1ZSkgY29udGludWU7XG5cdFx0XHRpZiAoYXJyYXlbaV0gPT09IGl0ZW0pIHJldHVybiBpO1xuXHRcdH1cblx0XHRyZXR1cm4gbnVsbDtcblx0fVxuXG5cdGZ1bmN0aW9uIG1hcEtleShpdGVtLCBjYWxsYmFjaykge1xuXHRcdHZhciBtYXBwZWRJdGVtO1xuXHRcdGlmIChjYWxsYmFjaykgbWFwcGVkSXRlbSA9IGNhbGxiYWNrKGl0ZW0pO1xuXHRcdGlmIChleHBvcnRzLmdldFR5cGUobWFwcGVkSXRlbSkgPT09IFwidW5kZWZpbmVkXCIpIG1hcHBlZEl0ZW0gPSBpdGVtO1xuXG5cdFx0cmV0dXJuIGtvLnV0aWxzLnVud3JhcE9ic2VydmFibGUobWFwcGVkSXRlbSk7XG5cdH1cblxuXHRmdW5jdGlvbiBnZXRJdGVtQnlLZXkoYXJyYXksIGtleSwgY2FsbGJhY2spIHtcblx0XHRhcnJheSA9IGtvLnV0aWxzLnVud3JhcE9ic2VydmFibGUoYXJyYXkpO1xuXHRcdGZvciAodmFyIGkgPSAwLCBqID0gYXJyYXkubGVuZ3RoOyBpIDwgajsgaSsrKSB7XG5cdFx0XHR2YXIgaXRlbSA9IGFycmF5W2ldO1xuXHRcdFx0aWYgKG1hcEtleShpdGVtLCBjYWxsYmFjaykgPT09IGtleSkgcmV0dXJuIGl0ZW07XG5cdFx0fVxuXG5cdFx0dGhyb3cgbmV3IEVycm9yKFwiV2hlbiBjYWxsaW5nIGtvLnVwZGF0ZSosIHRoZSBrZXkgJ1wiICsga2V5ICsgXCInIHdhcyBub3QgZm91bmQhXCIpO1xuXHR9XG5cblx0ZnVuY3Rpb24gZmlsdGVyQXJyYXlCeUtleShhcnJheSwgY2FsbGJhY2spIHtcblx0XHRyZXR1cm4ga28udXRpbHMuYXJyYXlNYXAoa28udXRpbHMudW53cmFwT2JzZXJ2YWJsZShhcnJheSksIGZ1bmN0aW9uIChpdGVtKSB7XG5cdFx0XHRpZiAoY2FsbGJhY2spIHtcblx0XHRcdFx0cmV0dXJuIG1hcEtleShpdGVtLCBjYWxsYmFjayk7XG5cdFx0XHR9IGVsc2Uge1xuXHRcdFx0XHRyZXR1cm4gaXRlbTtcblx0XHRcdH1cblx0XHR9KTtcblx0fVxuXG5cdGZ1bmN0aW9uIHZpc2l0UHJvcGVydGllc09yQXJyYXlFbnRyaWVzKHJvb3RPYmplY3QsIHZpc2l0b3JDYWxsYmFjaykge1xuXHRcdGlmIChleHBvcnRzLmdldFR5cGUocm9vdE9iamVjdCkgPT09IFwiYXJyYXlcIikge1xuXHRcdFx0Zm9yICh2YXIgaSA9IDA7IGkgPCByb290T2JqZWN0Lmxlbmd0aDsgaSsrKVxuXHRcdFx0dmlzaXRvckNhbGxiYWNrKGkpO1xuXHRcdH0gZWxzZSB7XG5cdFx0XHRmb3IgKHZhciBwcm9wZXJ0eU5hbWUgaW4gcm9vdE9iamVjdClcblx0XHRcdHZpc2l0b3JDYWxsYmFjayhwcm9wZXJ0eU5hbWUpO1xuXHRcdH1cblx0fTtcblxuXHRmdW5jdGlvbiBjYW5IYXZlUHJvcGVydGllcyhvYmplY3QpIHtcblx0XHR2YXIgdHlwZSA9IGV4cG9ydHMuZ2V0VHlwZShvYmplY3QpO1xuXHRcdHJldHVybiAoKHR5cGUgPT09IFwib2JqZWN0XCIpIHx8ICh0eXBlID09PSBcImFycmF5XCIpKSAmJiAob2JqZWN0ICE9PSBudWxsKTtcblx0fVxuXG5cdC8vIEJhc2VkIG9uIHRoZSBwYXJlbnROYW1lLCB0aGlzIGNyZWF0ZXMgYSBmdWxseSBjbGFzc2lmaWVkIG5hbWUgb2YgYSBwcm9wZXJ0eVxuXG5cdGZ1bmN0aW9uIGdldFByb3BlcnR5TmFtZShwYXJlbnROYW1lLCBwYXJlbnQsIGluZGV4ZXIpIHtcblx0XHR2YXIgcHJvcGVydHlOYW1lID0gcGFyZW50TmFtZSB8fCBcIlwiO1xuXHRcdGlmIChleHBvcnRzLmdldFR5cGUocGFyZW50KSA9PT0gXCJhcnJheVwiKSB7XG5cdFx0XHRpZiAocGFyZW50TmFtZSkge1xuXHRcdFx0XHRwcm9wZXJ0eU5hbWUgKz0gXCJbXCIgKyBpbmRleGVyICsgXCJdXCI7XG5cdFx0XHR9XG5cdFx0fSBlbHNlIHtcblx0XHRcdGlmIChwYXJlbnROYW1lKSB7XG5cdFx0XHRcdHByb3BlcnR5TmFtZSArPSBcIi5cIjtcblx0XHRcdH1cblx0XHRcdHByb3BlcnR5TmFtZSArPSBpbmRleGVyO1xuXHRcdH1cblx0XHRyZXR1cm4gcHJvcGVydHlOYW1lO1xuXHR9XG5cblx0ZXhwb3J0cy52aXNpdE1vZGVsID0gZnVuY3Rpb24gKHJvb3RPYmplY3QsIGNhbGxiYWNrLCBvcHRpb25zKSB7XG5cdFx0b3B0aW9ucyA9IG9wdGlvbnMgfHwge307XG5cdFx0b3B0aW9ucy52aXNpdGVkT2JqZWN0cyA9IG9wdGlvbnMudmlzaXRlZE9iamVjdHMgfHwgbmV3IG9iamVjdExvb2t1cCgpO1xuXG5cdFx0dmFyIG1hcHBlZFJvb3RPYmplY3Q7XG5cdFx0dmFyIHVud3JhcHBlZFJvb3RPYmplY3QgPSBrby51dGlscy51bndyYXBPYnNlcnZhYmxlKHJvb3RPYmplY3QpO1xuXG5cdFx0aWYgKCFjYW5IYXZlUHJvcGVydGllcyh1bndyYXBwZWRSb290T2JqZWN0KSkge1xuXHRcdFx0cmV0dXJuIGNhbGxiYWNrKHJvb3RPYmplY3QsIG9wdGlvbnMucGFyZW50TmFtZSk7XG5cdFx0fSBlbHNlIHtcblx0XHRcdG9wdGlvbnMgPSBmaWxsT3B0aW9ucyhvcHRpb25zLCB1bndyYXBwZWRSb290T2JqZWN0W21hcHBpbmdQcm9wZXJ0eV0pO1xuXG5cdFx0XHQvLyBPbmx5IGRvIGEgY2FsbGJhY2ssIGJ1dCBpZ25vcmUgdGhlIHJlc3VsdHNcblx0XHRcdGNhbGxiYWNrKHJvb3RPYmplY3QsIG9wdGlvbnMucGFyZW50TmFtZSk7XG5cdFx0XHRtYXBwZWRSb290T2JqZWN0ID0gZXhwb3J0cy5nZXRUeXBlKHVud3JhcHBlZFJvb3RPYmplY3QpID09PSBcImFycmF5XCIgPyBbXSA6IHt9O1xuXHRcdH1cblxuXHRcdG9wdGlvbnMudmlzaXRlZE9iamVjdHMuc2F2ZShyb290T2JqZWN0LCBtYXBwZWRSb290T2JqZWN0KTtcblxuXHRcdHZhciBwYXJlbnROYW1lID0gb3B0aW9ucy5wYXJlbnROYW1lO1xuXHRcdHZpc2l0UHJvcGVydGllc09yQXJyYXlFbnRyaWVzKHVud3JhcHBlZFJvb3RPYmplY3QsIGZ1bmN0aW9uIChpbmRleGVyKSB7XG5cdFx0XHRpZiAob3B0aW9ucy5pZ25vcmUgJiYga28udXRpbHMuYXJyYXlJbmRleE9mKG9wdGlvbnMuaWdub3JlLCBpbmRleGVyKSAhPSAtMSkgcmV0dXJuO1xuXG5cdFx0XHR2YXIgcHJvcGVydHlWYWx1ZSA9IHVud3JhcHBlZFJvb3RPYmplY3RbaW5kZXhlcl07XG5cdFx0XHRvcHRpb25zLnBhcmVudE5hbWUgPSBnZXRQcm9wZXJ0eU5hbWUocGFyZW50TmFtZSwgdW53cmFwcGVkUm9vdE9iamVjdCwgaW5kZXhlcik7XG5cblx0XHRcdC8vIElmIHdlIGRvbid0IHdhbnQgdG8gZXhwbGljaXRseSBjb3B5IHRoZSB1bm1hcHBlZCBwcm9wZXJ0eS4uLlxuXHRcdFx0aWYgKGtvLnV0aWxzLmFycmF5SW5kZXhPZihvcHRpb25zLmNvcHksIGluZGV4ZXIpID09PSAtMSkge1xuXHRcdFx0XHQvLyAuLi5maW5kIG91dCBpZiBpdCdzIGEgcHJvcGVydHkgd2Ugd2FudCB0byBleHBsaWNpdGx5IGluY2x1ZGVcblx0XHRcdFx0aWYgKGtvLnV0aWxzLmFycmF5SW5kZXhPZihvcHRpb25zLmluY2x1ZGUsIGluZGV4ZXIpID09PSAtMSkge1xuXHRcdFx0XHRcdC8vIFRoZSBtYXBwZWQgcHJvcGVydGllcyBvYmplY3QgY29udGFpbnMgYWxsIHRoZSBwcm9wZXJ0aWVzIHRoYXQgd2VyZSBwYXJ0IG9mIHRoZSBvcmlnaW5hbCBvYmplY3QuXG5cdFx0XHRcdFx0Ly8gSWYgYSBwcm9wZXJ0eSBkb2VzIG5vdCBleGlzdCwgYW5kIGl0IGlzIG5vdCBiZWNhdXNlIGl0IGlzIHBhcnQgb2YgYW4gYXJyYXkgKGUuZy4gXCJteVByb3BbM11cIiksIHRoZW4gaXQgc2hvdWxkIG5vdCBiZSB1bm1hcHBlZC5cblx0XHRcdFx0ICAgIGlmICh1bndyYXBwZWRSb290T2JqZWN0W21hcHBpbmdQcm9wZXJ0eV1cblx0XHRcdFx0ICAgICAgICAmJiB1bndyYXBwZWRSb290T2JqZWN0W21hcHBpbmdQcm9wZXJ0eV0ubWFwcGVkUHJvcGVydGllcyAmJiAhdW53cmFwcGVkUm9vdE9iamVjdFttYXBwaW5nUHJvcGVydHldLm1hcHBlZFByb3BlcnRpZXNbaW5kZXhlcl1cblx0XHRcdFx0ICAgICAgICAmJiB1bndyYXBwZWRSb290T2JqZWN0W21hcHBpbmdQcm9wZXJ0eV0uY29waWVkUHJvcGVydGllcyAmJiAhdW53cmFwcGVkUm9vdE9iamVjdFttYXBwaW5nUHJvcGVydHldLmNvcGllZFByb3BlcnRpZXNbaW5kZXhlcl1cblx0XHRcdFx0ICAgICAgICAmJiAhKGV4cG9ydHMuZ2V0VHlwZSh1bndyYXBwZWRSb290T2JqZWN0KSA9PT0gXCJhcnJheVwiKSkge1xuXHRcdFx0XHRcdFx0cmV0dXJuO1xuXHRcdFx0XHRcdH1cblx0XHRcdFx0fVxuXHRcdFx0fVxuXG5cdFx0XHR2YXIgb3V0cHV0UHJvcGVydHk7XG5cdFx0XHRzd2l0Y2ggKGV4cG9ydHMuZ2V0VHlwZShrby51dGlscy51bndyYXBPYnNlcnZhYmxlKHByb3BlcnR5VmFsdWUpKSkge1xuXHRcdFx0Y2FzZSBcIm9iamVjdFwiOlxuXHRcdFx0Y2FzZSBcImFycmF5XCI6XG5cdFx0XHRjYXNlIFwidW5kZWZpbmVkXCI6XG5cdFx0XHRcdHZhciBwcmV2aW91c2x5TWFwcGVkVmFsdWUgPSBvcHRpb25zLnZpc2l0ZWRPYmplY3RzLmdldChwcm9wZXJ0eVZhbHVlKTtcblx0XHRcdFx0bWFwcGVkUm9vdE9iamVjdFtpbmRleGVyXSA9IChleHBvcnRzLmdldFR5cGUocHJldmlvdXNseU1hcHBlZFZhbHVlKSAhPT0gXCJ1bmRlZmluZWRcIikgPyBwcmV2aW91c2x5TWFwcGVkVmFsdWUgOiBleHBvcnRzLnZpc2l0TW9kZWwocHJvcGVydHlWYWx1ZSwgY2FsbGJhY2ssIG9wdGlvbnMpO1xuXHRcdFx0XHRicmVhaztcblx0XHRcdGRlZmF1bHQ6XG5cdFx0XHRcdG1hcHBlZFJvb3RPYmplY3RbaW5kZXhlcl0gPSBjYWxsYmFjayhwcm9wZXJ0eVZhbHVlLCBvcHRpb25zLnBhcmVudE5hbWUpO1xuXHRcdFx0fVxuXHRcdH0pO1xuXG5cdFx0cmV0dXJuIG1hcHBlZFJvb3RPYmplY3Q7XG5cdH1cblxuXHRmdW5jdGlvbiBzaW1wbGVPYmplY3RMb29rdXAoKSB7XG5cdFx0dmFyIGtleXMgPSBbXTtcblx0XHR2YXIgdmFsdWVzID0gW107XG5cdFx0dGhpcy5zYXZlID0gZnVuY3Rpb24gKGtleSwgdmFsdWUpIHtcblx0XHRcdHZhciBleGlzdGluZ0luZGV4ID0ga28udXRpbHMuYXJyYXlJbmRleE9mKGtleXMsIGtleSk7XG5cdFx0XHRpZiAoZXhpc3RpbmdJbmRleCA+PSAwKSB2YWx1ZXNbZXhpc3RpbmdJbmRleF0gPSB2YWx1ZTtcblx0XHRcdGVsc2Uge1xuXHRcdFx0XHRrZXlzLnB1c2goa2V5KTtcblx0XHRcdFx0dmFsdWVzLnB1c2godmFsdWUpO1xuXHRcdFx0fVxuXHRcdH07XG5cdFx0dGhpcy5nZXQgPSBmdW5jdGlvbiAoa2V5KSB7XG5cdFx0XHR2YXIgZXhpc3RpbmdJbmRleCA9IGtvLnV0aWxzLmFycmF5SW5kZXhPZihrZXlzLCBrZXkpO1xuXHRcdFx0dmFyIHZhbHVlID0gKGV4aXN0aW5nSW5kZXggPj0gMCkgPyB2YWx1ZXNbZXhpc3RpbmdJbmRleF0gOiB1bmRlZmluZWQ7XG5cdFx0XHRyZXR1cm4gdmFsdWU7XG5cdFx0fTtcblx0fTtcblx0XG5cdGZ1bmN0aW9uIG9iamVjdExvb2t1cCgpIHtcblx0XHR2YXIgYnVja2V0cyA9IHt9O1xuXHRcdFxuXHRcdHZhciBmaW5kQnVja2V0ID0gZnVuY3Rpb24oa2V5KSB7XG5cdFx0XHR2YXIgYnVja2V0S2V5O1xuXHRcdFx0dHJ5IHtcblx0XHRcdFx0YnVja2V0S2V5ID0ga2V5Oy8vSlNPTi5zdHJpbmdpZnkoa2V5KTtcblx0XHRcdH1cblx0XHRcdGNhdGNoIChlKSB7XG5cdFx0XHRcdGJ1Y2tldEtleSA9IFwiJCQkXCI7XG5cdFx0XHR9XG5cblx0XHRcdHZhciBidWNrZXQgPSBidWNrZXRzW2J1Y2tldEtleV07XG5cdFx0XHRpZiAoYnVja2V0ID09PSB1bmRlZmluZWQpIHtcblx0XHRcdFx0YnVja2V0ID0gbmV3IHNpbXBsZU9iamVjdExvb2t1cCgpO1xuXHRcdFx0XHRidWNrZXRzW2J1Y2tldEtleV0gPSBidWNrZXQ7XG5cdFx0XHR9XG5cdFx0XHRyZXR1cm4gYnVja2V0O1xuXHRcdH07XG5cdFx0XG5cdFx0dGhpcy5zYXZlID0gZnVuY3Rpb24gKGtleSwgdmFsdWUpIHtcblx0XHRcdGZpbmRCdWNrZXQoa2V5KS5zYXZlKGtleSwgdmFsdWUpO1xuXHRcdH07XG5cdFx0dGhpcy5nZXQgPSBmdW5jdGlvbiAoa2V5KSB7XG5cdFx0XHRyZXR1cm4gZmluZEJ1Y2tldChrZXkpLmdldChrZXkpO1xuXHRcdH07XG5cdH07XG59KSk7IiwiLy8gS25vY2tvdXQgRmFzdCBNYXBwaW5nIHYwLjFcbi8vIExpY2Vuc2U6IE1JVCAoaHR0cDovL3d3dy5vcGVuc291cmNlLm9yZy9saWNlbnNlcy9taXQtbGljZW5zZS5waHApXG5cbihmdW5jdGlvbiAoZmFjdG9yeSkge1xuXHQvLyBNb2R1bGUgc3lzdGVtcyBtYWdpYyBkYW5jZS5cblxuXHRpZiAodHlwZW9mIHJlcXVpcmUgPT09IFwiZnVuY3Rpb25cIiAmJiB0eXBlb2YgZXhwb3J0cyA9PT0gXCJvYmplY3RcIiAmJiB0eXBlb2YgbW9kdWxlID09PSBcIm9iamVjdFwiKSB7XG5cdFx0Ly8gQ29tbW9uSlMgb3IgTm9kZTogaGFyZC1jb2RlZCBkZXBlbmRlbmN5IG9uIFwia25vY2tvdXRcIlxuXHRcdGZhY3RvcnkoKHR5cGVvZiB3aW5kb3cgIT09IFwidW5kZWZpbmVkXCIgPyB3aW5kb3dbJ2tvJ10gOiB0eXBlb2YgZ2xvYmFsICE9PSBcInVuZGVmaW5lZFwiID8gZ2xvYmFsWydrbyddIDogbnVsbCksIGV4cG9ydHMpO1xuXHR9IGVsc2UgaWYgKHR5cGVvZiBkZWZpbmUgPT09IFwiZnVuY3Rpb25cIiAmJiBkZWZpbmVbXCJhbWRcIl0pIHtcblx0XHQvLyBBTUQgYW5vbnltb3VzIG1vZHVsZSB3aXRoIGhhcmQtY29kZWQgZGVwZW5kZW5jeSBvbiBcImtub2Nrb3V0XCJcblx0XHRkZWZpbmUoW1wia25vY2tvdXRcIiwgXCJleHBvcnRzXCJdLCBmYWN0b3J5KTtcblx0fSBlbHNlIHtcblx0XHQvLyA8c2NyaXB0PiB0YWc6IHVzZSB0aGUgZ2xvYmFsIGBrb2Agb2JqZWN0LCBhdHRhY2hpbmcgYSBgd3JhcGAgcHJvcGVydHlcblx0XHRmYWN0b3J5KGtvLCBrby53cmFwID0ge30pO1xuXHR9XG59KGZ1bmN0aW9uIChrbywgZXhwb3J0cykge1xuICAgIFxuICAgIC8vIHRoaXMgZnVuY3Rpb24gbWltaWNzIGtvLm1hcHBpbmdcbiAgICBleHBvcnRzLmZyb21KUyA9IGZ1bmN0aW9uKGpzT2JqZWN0LCBjb21wdXRlZEZ1bmN0aW9ucylcbiAgICB7XG4gICAgICAgIHJlc2V0KCk7XG5cdHJldHVybiB3cmFwKGpzT2JqZWN0LCBjb21wdXRlZEZ1bmN0aW9ucyk7XG4gICAgfVxuXG4gICAgLy8gdGhpcyBmdW5jdGlvbiB1bndyYXBzIHRoZSBvdXRlciBmb3IgYXNzaWduaW5nIHRoZSByZXN1bHQgdG8gYW4gb2JzZXJ2YWJsZVxuICAgIC8vIHNlZSBodHRwczovL2dpdGh1Yi5jb20vU3RldmVTYW5kZXJzb24va25vY2tvdXQvaXNzdWVzLzUxN1xuICAgIGV4cG9ydHMudXBkYXRlRnJvbUpTID0gZnVuY3Rpb24ob2JzZXJ2YWJsZSwganNPYmplY3QsIGNvbXB1dGVkRnVuY3Rpb25zKVxuICAgIHtcbiAgICAgICAgcmVzZXQoKTtcblx0cmV0dXJuIG9ic2VydmFibGUoa28udXRpbHMudW53cmFwT2JzZXJ2YWJsZSh3cmFwKGpzT2JqZWN0LCBjb21wdXRlZEZ1bmN0aW9ucykpKTtcbiAgICB9XG5cbiAgICBleHBvcnRzLmZyb21KU09OID0gZnVuY3Rpb24gKGpzb25TdHJpbmcsIGNvbXB1dGVkRnVuY3Rpb25zKSB7XG5cdHZhciBwYXJzZWQgPSBrby51dGlscy5wYXJzZUpzb24oanNvblN0cmluZyk7XG5cdGFyZ3VtZW50c1swXSA9IHBhcnNlZDtcblx0cmV0dXJuIGV4cG9ydHMuZnJvbUpTLmFwcGx5KHRoaXMsIGNvbXB1dGVkRnVuY3Rpb25zKTtcbiAgICB9O1xuICAgIFxuICAgIGV4cG9ydHMudG9KUyA9IGZ1bmN0aW9uIChvYnNlcnZhYmxlKSB7XG5cdHJldHVybiB1bndyYXAob2JzZXJ2YWJsZSk7XG4gICAgfVxuXG4gICAgZXhwb3J0cy50b0pTT04gPSBmdW5jdGlvbiAob2JzZXJ2YWJsZSkge1xuXHR2YXIgcGxhaW5KYXZhU2NyaXB0T2JqZWN0ID0gZXhwb3J0cy50b0pTKG9ic2VydmFibGUpO1xuXHRyZXR1cm4ga28udXRpbHMuc3RyaW5naWZ5SnNvbihwbGFpbkphdmFTY3JpcHRPYmplY3QpO1xuICAgIH07XG5cbiAgICBmdW5jdGlvbiB0eXBlT2YodmFsdWUpIHtcblx0dmFyIHMgPSB0eXBlb2YgdmFsdWU7XG5cdGlmIChzID09PSAnb2JqZWN0Jykge1xuICAgICAgICAgICAgaWYgKHZhbHVlKSB7XG4gICAgICAgICAgICAgICAgaWYgKHZhbHVlLmNvbnN0cnVjdG9yID09IERhdGUpXG4gICAgICAgICAgICAgICAgICAgIHMgPSAnZGF0ZSc7XG5cdFx0ZWxzZSBpZiAoT2JqZWN0LnByb3RvdHlwZS50b1N0cmluZy5jYWxsKHZhbHVlKSA9PSAnW29iamVjdCBBcnJheV0nKVxuICAgICAgICAgICAgICAgICAgICBzID0gJ2FycmF5JztcbiAgICAgICAgICAgIH0gZWxzZSB7XG5cdFx0cyA9ICdudWxsJztcbiAgICAgICAgICAgIH1cblx0fVxuXHRyZXR1cm4gcztcbiAgICB9XG5cbiAgICAvLyB1bndyYXBwaW5nXG4gICAgZnVuY3Rpb24gdW53cmFwT2JqZWN0KG8pXG4gICAge1xuXHR2YXIgdCA9IHt9O1xuXG5cdGZvciAodmFyIGsgaW4gbylcblx0e1xuXHQgICAgdmFyIHYgPSBvW2tdO1xuXG5cdCAgICBpZiAoa28uaXNDb21wdXRlZCh2KSlcblx0XHRjb250aW51ZTtcblxuXHQgICAgdFtrXSA9IHVud3JhcCh2KTtcblx0fVxuXG5cdHJldHVybiB0O1xuICAgIH1cblxuICAgIGZ1bmN0aW9uIHVud3JhcEFycmF5KGEpXG4gICAge1xuXHR2YXIgciA9IFtdO1xuXG5cdGlmICghYSB8fCBhLmxlbmd0aCA9PSAwKVxuXHQgICAgcmV0dXJuIHI7XG5cdFxuXHRmb3IgKHZhciBpID0gMCwgbCA9IGEubGVuZ3RoOyBpIDwgbDsgKytpKVxuXHQgICAgci5wdXNoKHVud3JhcChhW2ldKSk7XG5cblx0cmV0dXJuIHI7XG4gICAgfVxuXG4gICAgZnVuY3Rpb24gdW53cmFwKHYpXG4gICAge1xuXHR2YXIgaXNPYnNlcnZhYmxlID0ga28uaXNPYnNlcnZhYmxlKHYpO1xuXG5cdGlmIChpc09ic2VydmFibGUpXG5cdHtcblx0ICAgIHZhciB2YWwgPSB2KCk7XG5cblx0ICAgIHJldHVybiB1bndyYXAodmFsKTtcblx0fVxuXHRlbHNlXG5cdHtcblx0ICAgIGlmICh0eXBlT2YodikgPT0gXCJhcnJheVwiKVxuXHQgICAge1xuXHRcdHJldHVybiB1bndyYXBBcnJheSh2KTtcblx0ICAgIH1cblx0ICAgIGVsc2UgaWYgKHR5cGVPZih2KSA9PSBcIm9iamVjdFwiKVxuXHQgICAge1xuXHRcdHJldHVybiB1bndyYXBPYmplY3Qodik7XG5cdCAgICB9XG5cdCAgICBlbHNlXG5cdCAgICB7XG5cdFx0cmV0dXJuIHY7XG5cdCAgICB9XG5cdH1cbiAgICB9XG5cbiAgICBmdW5jdGlvbiByZXNldCgpXG4gICAge1xuICAgICAgICBwYXJlbnRzID0gW3tvYmo6IG51bGwsIHdyYXBwZWQ6IG51bGwsIGx2bDogXCJcIn1dO1xuICAgIH0gICAgXG4gICAgXG4gICAgLy8gd3JhcHBpbmdcblxuICAgIGZ1bmN0aW9uIHdyYXBPYmplY3QobywgY29tcHV0ZWRGdW5jdGlvbnMpXG4gICAge1xuICAgICAgICAvLyBjaGVjayBmb3IgaW5maW5pdGUgcmVjdXJzaW9uXG4gICAgICAgIGZvciAodmFyIGkgPSAwOyBpIDwgcGFyZW50cy5sZW5ndGg7ICsraSkge1xuICAgICAgICAgICAgaWYgKHBhcmVudHNbaV0ub2JqID09PSBvKSB7XG4gICAgICAgICAgICAgICAgcmV0dXJuIHBhcmVudHNbaV0ud3JhcHBlZDtcbiAgICAgICAgICAgIH1cbiAgICAgICAgfVxuXG5cdHZhciB0ID0ge307XG5cblx0Zm9yICh2YXIgayBpbiBvKVxuXHR7XG5cdCAgICB2YXIgdiA9IG9ba107XG5cbiAgICAgICAgICAgIHBhcmVudHMucHVzaCh7b2JqOiBvLCB3cmFwcGVkOiB0LCBsdmw6IGN1cnJlbnRMdmwoKSArIFwiL1wiICsga30pO1xuXG5cdCAgICB0W2tdID0gd3JhcCh2LCBjb21wdXRlZEZ1bmN0aW9ucyk7XG5cbiAgICAgICAgICAgIHBhcmVudHMucG9wKCk7XG5cdH1cblxuXHRpZiAoY29tcHV0ZWRGdW5jdGlvbnMgJiYgY29tcHV0ZWRGdW5jdGlvbnNbY3VycmVudEx2bCgpXSlcblx0ICAgIHQgPSBjb21wdXRlZEZ1bmN0aW9uc1tjdXJyZW50THZsKCldKHQpO1xuXG4gICAgICAgIGlmIChoYXNFUzVQbHVnaW4oKSlcbiAgICAgICAgICAgIGtvLnRyYWNrKHQpO1xuXG5cdHJldHVybiB0O1xuICAgIH1cblxuICAgIGZ1bmN0aW9uIHdyYXBBcnJheShhLCBjb21wdXRlZEZ1bmN0aW9ucylcbiAgICB7XG5cdHZhciByID0ga28ub2JzZXJ2YWJsZUFycmF5KCk7XG5cblx0aWYgKCFhIHx8IGEubGVuZ3RoID09IDApXG5cdCAgICByZXR1cm4gcjtcblxuXHRmb3IgKHZhciBpID0gMCwgbCA9IGEubGVuZ3RoOyBpIDwgbDsgKytpKVxuXHQgICAgci5wdXNoKHdyYXAoYVtpXSwgY29tcHV0ZWRGdW5jdGlvbnMpKTtcblxuXHRyZXR1cm4gcjtcbiAgICB9XG5cbiAgICAvLyBhIHN0YWNrLCB1c2VkIGZvciB0d28gcHVycG9zZXM6XG4gICAgLy8gIC0gY2lyY3VsYXIgcmVmZXJlbmNlIGNoZWNraW5nXG4gICAgLy8gIC0gY29tcHV0ZWQgZnVuY3Rpb25zXG4gICAgdmFyIHBhcmVudHM7XG5cbiAgICBmdW5jdGlvbiBjdXJyZW50THZsKClcbiAgICB7XG5cdHJldHVybiBwYXJlbnRzW3BhcmVudHMubGVuZ3RoLTFdLmx2bDtcbiAgICB9XG5cbiAgICBmdW5jdGlvbiB3cmFwKHYsIGNvbXB1dGVkRnVuY3Rpb25zKVxuICAgIHtcblx0aWYgKHR5cGVPZih2KSA9PSBcImFycmF5XCIpXG5cdHtcblx0ICAgIHJldHVybiB3cmFwQXJyYXkodiwgY29tcHV0ZWRGdW5jdGlvbnMpO1xuXHR9XG5cdGVsc2UgaWYgKHR5cGVPZih2KSA9PSBcIm9iamVjdFwiKVxuXHR7XG5cdCAgICByZXR1cm4gd3JhcE9iamVjdCh2LCBjb21wdXRlZEZ1bmN0aW9ucyk7XG5cdH1cblx0ZWxzZVxuXHR7XG4gICAgICAgICAgICBpZiAoIWhhc0VTNVBsdWdpbigpICYmIHR5cGVvZiB2ICE9PSAnZnVuY3Rpb24nKVxuICAgICAgICAgICAge1xuXHQgICAgICAgIHZhciB0ID0ga28ub2JzZXJ2YWJsZSgpO1xuXHQgICAgICAgIHQodik7XG5cdCAgICAgICAgcmV0dXJuIHQ7XG4gICAgICAgICAgICB9IGVsc2VcbiAgICAgICAgICAgICAgICByZXR1cm4gdjtcblx0fVxuICAgIH1cblxuICAgIGZ1bmN0aW9uIGhhc0VTNVBsdWdpbigpXG4gICAge1xuICAgICAgICByZXR1cm4ga28udHJhY2sgIT0gbnVsbDtcbiAgICB9XG59KSk7IiwiLyohXG4gKiBDaGFydC5qc1xuICogaHR0cDovL2NoYXJ0anMub3JnL1xuICogVmVyc2lvbjogMS4xLjFcbiAqXG4gKiBDb3B5cmlnaHQgMjAxNSBOaWNrIERvd25pZVxuICogUmVsZWFzZWQgdW5kZXIgdGhlIE1JVCBsaWNlbnNlXG4gKiBodHRwczovL2dpdGh1Yi5jb20vbm5uaWNrL0NoYXJ0LmpzL2Jsb2IvbWFzdGVyL0xJQ0VOU0UubWRcbiAqL1xuXG5cbihmdW5jdGlvbigpe1xuXG5cdFwidXNlIHN0cmljdFwiO1xuXG5cdC8vRGVjbGFyZSByb290IHZhcmlhYmxlIC0gd2luZG93IGluIHRoZSBicm93c2VyLCBnbG9iYWwgb24gdGhlIHNlcnZlclxuXHR2YXIgcm9vdCA9IHRoaXMsXG5cdFx0cHJldmlvdXMgPSByb290LkNoYXJ0O1xuXG5cdC8vT2NjdXB5IHRoZSBnbG9iYWwgdmFyaWFibGUgb2YgQ2hhcnQsIGFuZCBjcmVhdGUgYSBzaW1wbGUgYmFzZSBjbGFzc1xuXHR2YXIgQ2hhcnQgPSBmdW5jdGlvbihjb250ZXh0KXtcblx0XHR2YXIgY2hhcnQgPSB0aGlzO1xuXHRcdHRoaXMuY2FudmFzID0gY29udGV4dC5jYW52YXM7XG5cblx0XHR0aGlzLmN0eCA9IGNvbnRleHQ7XG5cblx0XHQvL1ZhcmlhYmxlcyBnbG9iYWwgdG8gdGhlIGNoYXJ0XG5cdFx0dmFyIGNvbXB1dGVEaW1lbnNpb24gPSBmdW5jdGlvbihlbGVtZW50LGRpbWVuc2lvbilcblx0XHR7XG5cdFx0XHRpZiAoZWxlbWVudFsnb2Zmc2V0JytkaW1lbnNpb25dKVxuXHRcdFx0e1xuXHRcdFx0XHRyZXR1cm4gZWxlbWVudFsnb2Zmc2V0JytkaW1lbnNpb25dO1xuXHRcdFx0fVxuXHRcdFx0ZWxzZVxuXHRcdFx0e1xuXHRcdFx0XHRyZXR1cm4gZG9jdW1lbnQuZGVmYXVsdFZpZXcuZ2V0Q29tcHV0ZWRTdHlsZShlbGVtZW50KS5nZXRQcm9wZXJ0eVZhbHVlKGRpbWVuc2lvbik7XG5cdFx0XHR9XG5cdFx0fTtcblxuXHRcdHZhciB3aWR0aCA9IHRoaXMud2lkdGggPSBjb21wdXRlRGltZW5zaW9uKGNvbnRleHQuY2FudmFzLCdXaWR0aCcpIHx8IGNvbnRleHQuY2FudmFzLndpZHRoO1xuXHRcdHZhciBoZWlnaHQgPSB0aGlzLmhlaWdodCA9IGNvbXB1dGVEaW1lbnNpb24oY29udGV4dC5jYW52YXMsJ0hlaWdodCcpIHx8IGNvbnRleHQuY2FudmFzLmhlaWdodDtcblxuXHRcdHRoaXMuYXNwZWN0UmF0aW8gPSB0aGlzLndpZHRoIC8gdGhpcy5oZWlnaHQ7XG5cdFx0Ly9IaWdoIHBpeGVsIGRlbnNpdHkgZGlzcGxheXMgLSBtdWx0aXBseSB0aGUgc2l6ZSBvZiB0aGUgY2FudmFzIGhlaWdodC93aWR0aCBieSB0aGUgZGV2aWNlIHBpeGVsIHJhdGlvLCB0aGVuIHNjYWxlLlxuXHRcdGhlbHBlcnMucmV0aW5hU2NhbGUodGhpcyk7XG5cblx0XHRyZXR1cm4gdGhpcztcblx0fTtcblx0Ly9HbG9iYWxseSBleHBvc2UgdGhlIGRlZmF1bHRzIHRvIGFsbG93IGZvciB1c2VyIHVwZGF0aW5nL2NoYW5naW5nXG5cdENoYXJ0LmRlZmF1bHRzID0ge1xuXHRcdGdsb2JhbDoge1xuXHRcdFx0Ly8gQm9vbGVhbiAtIFdoZXRoZXIgdG8gYW5pbWF0ZSB0aGUgY2hhcnRcblx0XHRcdGFuaW1hdGlvbjogdHJ1ZSxcblxuXHRcdFx0Ly8gTnVtYmVyIC0gTnVtYmVyIG9mIGFuaW1hdGlvbiBzdGVwc1xuXHRcdFx0YW5pbWF0aW9uU3RlcHM6IDYwLFxuXG5cdFx0XHQvLyBTdHJpbmcgLSBBbmltYXRpb24gZWFzaW5nIGVmZmVjdFxuXHRcdFx0YW5pbWF0aW9uRWFzaW5nOiBcImVhc2VPdXRRdWFydFwiLFxuXG5cdFx0XHQvLyBCb29sZWFuIC0gSWYgd2Ugc2hvdWxkIHNob3cgdGhlIHNjYWxlIGF0IGFsbFxuXHRcdFx0c2hvd1NjYWxlOiB0cnVlLFxuXG5cdFx0XHQvLyBCb29sZWFuIC0gSWYgd2Ugd2FudCB0byBvdmVycmlkZSB3aXRoIGEgaGFyZCBjb2RlZCBzY2FsZVxuXHRcdFx0c2NhbGVPdmVycmlkZTogZmFsc2UsXG5cblx0XHRcdC8vICoqIFJlcXVpcmVkIGlmIHNjYWxlT3ZlcnJpZGUgaXMgdHJ1ZSAqKlxuXHRcdFx0Ly8gTnVtYmVyIC0gVGhlIG51bWJlciBvZiBzdGVwcyBpbiBhIGhhcmQgY29kZWQgc2NhbGVcblx0XHRcdHNjYWxlU3RlcHM6IG51bGwsXG5cdFx0XHQvLyBOdW1iZXIgLSBUaGUgdmFsdWUganVtcCBpbiB0aGUgaGFyZCBjb2RlZCBzY2FsZVxuXHRcdFx0c2NhbGVTdGVwV2lkdGg6IG51bGwsXG5cdFx0XHQvLyBOdW1iZXIgLSBUaGUgc2NhbGUgc3RhcnRpbmcgdmFsdWVcblx0XHRcdHNjYWxlU3RhcnRWYWx1ZTogbnVsbCxcblxuXHRcdFx0Ly8gU3RyaW5nIC0gQ29sb3VyIG9mIHRoZSBzY2FsZSBsaW5lXG5cdFx0XHRzY2FsZUxpbmVDb2xvcjogXCJyZ2JhKDAsMCwwLC4xKVwiLFxuXG5cdFx0XHQvLyBOdW1iZXIgLSBQaXhlbCB3aWR0aCBvZiB0aGUgc2NhbGUgbGluZVxuXHRcdFx0c2NhbGVMaW5lV2lkdGg6IDEsXG5cblx0XHRcdC8vIEJvb2xlYW4gLSBXaGV0aGVyIHRvIHNob3cgbGFiZWxzIG9uIHRoZSBzY2FsZVxuXHRcdFx0c2NhbGVTaG93TGFiZWxzOiB0cnVlLFxuXG5cdFx0XHQvLyBJbnRlcnBvbGF0ZWQgSlMgc3RyaW5nIC0gY2FuIGFjY2VzcyB2YWx1ZVxuXHRcdFx0c2NhbGVMYWJlbDogXCI8JT12YWx1ZSU+XCIsXG5cblx0XHRcdC8vIEJvb2xlYW4gLSBXaGV0aGVyIHRoZSBzY2FsZSBzaG91bGQgc3RpY2sgdG8gaW50ZWdlcnMsIGFuZCBub3Qgc2hvdyBhbnkgZmxvYXRzIGV2ZW4gaWYgZHJhd2luZyBzcGFjZSBpcyB0aGVyZVxuXHRcdFx0c2NhbGVJbnRlZ2Vyc09ubHk6IHRydWUsXG5cblx0XHRcdC8vIEJvb2xlYW4gLSBXaGV0aGVyIHRoZSBzY2FsZSBzaG91bGQgc3RhcnQgYXQgemVybywgb3IgYW4gb3JkZXIgb2YgbWFnbml0dWRlIGRvd24gZnJvbSB0aGUgbG93ZXN0IHZhbHVlXG5cdFx0XHRzY2FsZUJlZ2luQXRaZXJvOiBmYWxzZSxcblxuXHRcdFx0Ly8gU3RyaW5nIC0gU2NhbGUgbGFiZWwgZm9udCBkZWNsYXJhdGlvbiBmb3IgdGhlIHNjYWxlIGxhYmVsXG5cdFx0XHRzY2FsZUZvbnRGYW1pbHk6IFwiJ0hlbHZldGljYSBOZXVlJywgJ0hlbHZldGljYScsICdBcmlhbCcsIHNhbnMtc2VyaWZcIixcblxuXHRcdFx0Ly8gTnVtYmVyIC0gU2NhbGUgbGFiZWwgZm9udCBzaXplIGluIHBpeGVsc1xuXHRcdFx0c2NhbGVGb250U2l6ZTogMTIsXG5cblx0XHRcdC8vIFN0cmluZyAtIFNjYWxlIGxhYmVsIGZvbnQgd2VpZ2h0IHN0eWxlXG5cdFx0XHRzY2FsZUZvbnRTdHlsZTogXCJub3JtYWxcIixcblxuXHRcdFx0Ly8gU3RyaW5nIC0gU2NhbGUgbGFiZWwgZm9udCBjb2xvdXJcblx0XHRcdHNjYWxlRm9udENvbG9yOiBcIiM2NjZcIixcblxuXHRcdFx0Ly8gQm9vbGVhbiAtIHdoZXRoZXIgb3Igbm90IHRoZSBjaGFydCBzaG91bGQgYmUgcmVzcG9uc2l2ZSBhbmQgcmVzaXplIHdoZW4gdGhlIGJyb3dzZXIgZG9lcy5cblx0XHRcdHJlc3BvbnNpdmU6IGZhbHNlLFxuXG5cdFx0XHQvLyBCb29sZWFuIC0gd2hldGhlciB0byBtYWludGFpbiB0aGUgc3RhcnRpbmcgYXNwZWN0IHJhdGlvIG9yIG5vdCB3aGVuIHJlc3BvbnNpdmUsIGlmIHNldCB0byBmYWxzZSwgd2lsbCB0YWtlIHVwIGVudGlyZSBjb250YWluZXJcblx0XHRcdG1haW50YWluQXNwZWN0UmF0aW86IHRydWUsXG5cblx0XHRcdC8vIEJvb2xlYW4gLSBEZXRlcm1pbmVzIHdoZXRoZXIgdG8gZHJhdyB0b29sdGlwcyBvbiB0aGUgY2FudmFzIG9yIG5vdCAtIGF0dGFjaGVzIGV2ZW50cyB0byB0b3VjaG1vdmUgJiBtb3VzZW1vdmVcblx0XHRcdHNob3dUb29sdGlwczogdHJ1ZSxcblxuXHRcdFx0Ly8gQm9vbGVhbiAtIERldGVybWluZXMgd2hldGhlciB0byBkcmF3IGJ1aWx0LWluIHRvb2x0aXAgb3IgY2FsbCBjdXN0b20gdG9vbHRpcCBmdW5jdGlvblxuXHRcdFx0Y3VzdG9tVG9vbHRpcHM6IGZhbHNlLFxuXG5cdFx0XHQvLyBBcnJheSAtIEFycmF5IG9mIHN0cmluZyBuYW1lcyB0byBhdHRhY2ggdG9vbHRpcCBldmVudHNcblx0XHRcdHRvb2x0aXBFdmVudHM6IFtcIm1vdXNlbW92ZVwiLCBcInRvdWNoc3RhcnRcIiwgXCJ0b3VjaG1vdmVcIiwgXCJtb3VzZW91dFwiXSxcblxuXHRcdFx0Ly8gU3RyaW5nIC0gVG9vbHRpcCBiYWNrZ3JvdW5kIGNvbG91clxuXHRcdFx0dG9vbHRpcEZpbGxDb2xvcjogXCJyZ2JhKDAsMCwwLDAuOClcIixcblxuXHRcdFx0Ly8gU3RyaW5nIC0gVG9vbHRpcCBsYWJlbCBmb250IGRlY2xhcmF0aW9uIGZvciB0aGUgc2NhbGUgbGFiZWxcblx0XHRcdHRvb2x0aXBGb250RmFtaWx5OiBcIidIZWx2ZXRpY2EgTmV1ZScsICdIZWx2ZXRpY2EnLCAnQXJpYWwnLCBzYW5zLXNlcmlmXCIsXG5cblx0XHRcdC8vIE51bWJlciAtIFRvb2x0aXAgbGFiZWwgZm9udCBzaXplIGluIHBpeGVsc1xuXHRcdFx0dG9vbHRpcEZvbnRTaXplOiAxNCxcblxuXHRcdFx0Ly8gU3RyaW5nIC0gVG9vbHRpcCBmb250IHdlaWdodCBzdHlsZVxuXHRcdFx0dG9vbHRpcEZvbnRTdHlsZTogXCJub3JtYWxcIixcblxuXHRcdFx0Ly8gU3RyaW5nIC0gVG9vbHRpcCBsYWJlbCBmb250IGNvbG91clxuXHRcdFx0dG9vbHRpcEZvbnRDb2xvcjogXCIjZmZmXCIsXG5cblx0XHRcdC8vIFN0cmluZyAtIFRvb2x0aXAgdGl0bGUgZm9udCBkZWNsYXJhdGlvbiBmb3IgdGhlIHNjYWxlIGxhYmVsXG5cdFx0XHR0b29sdGlwVGl0bGVGb250RmFtaWx5OiBcIidIZWx2ZXRpY2EgTmV1ZScsICdIZWx2ZXRpY2EnLCAnQXJpYWwnLCBzYW5zLXNlcmlmXCIsXG5cblx0XHRcdC8vIE51bWJlciAtIFRvb2x0aXAgdGl0bGUgZm9udCBzaXplIGluIHBpeGVsc1xuXHRcdFx0dG9vbHRpcFRpdGxlRm9udFNpemU6IDE0LFxuXG5cdFx0XHQvLyBTdHJpbmcgLSBUb29sdGlwIHRpdGxlIGZvbnQgd2VpZ2h0IHN0eWxlXG5cdFx0XHR0b29sdGlwVGl0bGVGb250U3R5bGU6IFwiYm9sZFwiLFxuXG5cdFx0XHQvLyBTdHJpbmcgLSBUb29sdGlwIHRpdGxlIGZvbnQgY29sb3VyXG5cdFx0XHR0b29sdGlwVGl0bGVGb250Q29sb3I6IFwiI2ZmZlwiLFxuXG5cdFx0XHQvLyBTdHJpbmcgLSBUb29sdGlwIHRpdGxlIHRlbXBsYXRlXG5cdFx0XHR0b29sdGlwVGl0bGVUZW1wbGF0ZTogXCI8JT0gbGFiZWwlPlwiLFxuXG5cdFx0XHQvLyBOdW1iZXIgLSBwaXhlbCB3aWR0aCBvZiBwYWRkaW5nIGFyb3VuZCB0b29sdGlwIHRleHRcblx0XHRcdHRvb2x0aXBZUGFkZGluZzogNixcblxuXHRcdFx0Ly8gTnVtYmVyIC0gcGl4ZWwgd2lkdGggb2YgcGFkZGluZyBhcm91bmQgdG9vbHRpcCB0ZXh0XG5cdFx0XHR0b29sdGlwWFBhZGRpbmc6IDYsXG5cblx0XHRcdC8vIE51bWJlciAtIFNpemUgb2YgdGhlIGNhcmV0IG9uIHRoZSB0b29sdGlwXG5cdFx0XHR0b29sdGlwQ2FyZXRTaXplOiA4LFxuXG5cdFx0XHQvLyBOdW1iZXIgLSBQaXhlbCByYWRpdXMgb2YgdGhlIHRvb2x0aXAgYm9yZGVyXG5cdFx0XHR0b29sdGlwQ29ybmVyUmFkaXVzOiA2LFxuXG5cdFx0XHQvLyBOdW1iZXIgLSBQaXhlbCBvZmZzZXQgZnJvbSBwb2ludCB4IHRvIHRvb2x0aXAgZWRnZVxuXHRcdFx0dG9vbHRpcFhPZmZzZXQ6IDEwLFxuXG5cdFx0XHQvLyBTdHJpbmcgLSBUZW1wbGF0ZSBzdHJpbmcgZm9yIHNpbmdsZSB0b29sdGlwc1xuXHRcdFx0dG9vbHRpcFRlbXBsYXRlOiBcIjwlaWYgKGxhYmVsKXslPjwlPWxhYmVsJT46IDwlfSU+PCU9IHZhbHVlICU+XCIsXG5cblx0XHRcdC8vIFN0cmluZyAtIFRlbXBsYXRlIHN0cmluZyBmb3Igc2luZ2xlIHRvb2x0aXBzXG5cdFx0XHRtdWx0aVRvb2x0aXBUZW1wbGF0ZTogXCI8JT0gZGF0YXNldExhYmVsICU+OiA8JT0gdmFsdWUgJT5cIixcblxuXHRcdFx0Ly8gU3RyaW5nIC0gQ29sb3VyIGJlaGluZCB0aGUgbGVnZW5kIGNvbG91ciBibG9ja1xuXHRcdFx0bXVsdGlUb29sdGlwS2V5QmFja2dyb3VuZDogJyNmZmYnLFxuXG5cdFx0XHQvLyBBcnJheSAtIEEgbGlzdCBvZiBjb2xvcnMgdG8gdXNlIGFzIHRoZSBkZWZhdWx0c1xuXHRcdFx0c2VnbWVudENvbG9yRGVmYXVsdDogW1wiI0E2Q0VFM1wiLCBcIiMxRjc4QjRcIiwgXCIjQjJERjhBXCIsIFwiIzMzQTAyQ1wiLCBcIiNGQjlBOTlcIiwgXCIjRTMxQTFDXCIsIFwiI0ZEQkY2RlwiLCBcIiNGRjdGMDBcIiwgXCIjQ0FCMkQ2XCIsIFwiIzZBM0Q5QVwiLCBcIiNCNEI0ODJcIiwgXCIjQjE1OTI4XCIgXSxcblxuXHRcdFx0Ly8gQXJyYXkgLSBBIGxpc3Qgb2YgaGlnaGxpZ2h0IGNvbG9ycyB0byB1c2UgYXMgdGhlIGRlZmF1bHRzXG5cdFx0XHRzZWdtZW50SGlnaGxpZ2h0Q29sb3JEZWZhdWx0czogWyBcIiNDRUY2RkZcIiwgXCIjNDdBMERDXCIsIFwiI0RBRkZCMlwiLCBcIiM1QkM4NTRcIiwgXCIjRkZDMkMxXCIsIFwiI0ZGNDI0NFwiLCBcIiNGRkU3OTdcIiwgXCIjRkZBNzI4XCIsIFwiI0YyREFGRVwiLCBcIiM5MjY1QzJcIiwgXCIjRENEQ0FBXCIsIFwiI0Q5ODE1MFwiIF0sXG5cblx0XHRcdC8vIEZ1bmN0aW9uIC0gV2lsbCBmaXJlIG9uIGFuaW1hdGlvbiBwcm9ncmVzc2lvbi5cblx0XHRcdG9uQW5pbWF0aW9uUHJvZ3Jlc3M6IGZ1bmN0aW9uKCl7fSxcblxuXHRcdFx0Ly8gRnVuY3Rpb24gLSBXaWxsIGZpcmUgb24gYW5pbWF0aW9uIGNvbXBsZXRpb24uXG5cdFx0XHRvbkFuaW1hdGlvbkNvbXBsZXRlOiBmdW5jdGlvbigpe31cblxuXHRcdH1cblx0fTtcblxuXHQvL0NyZWF0ZSBhIGRpY3Rpb25hcnkgb2YgY2hhcnQgdHlwZXMsIHRvIGFsbG93IGZvciBleHRlbnNpb24gb2YgZXhpc3RpbmcgdHlwZXNcblx0Q2hhcnQudHlwZXMgPSB7fTtcblxuXHQvL0dsb2JhbCBDaGFydCBoZWxwZXJzIG9iamVjdCBmb3IgdXRpbGl0eSBtZXRob2RzIGFuZCBjbGFzc2VzXG5cdHZhciBoZWxwZXJzID0gQ2hhcnQuaGVscGVycyA9IHt9O1xuXG5cdFx0Ly8tLSBCYXNpYyBqcyB1dGlsaXR5IG1ldGhvZHNcblx0dmFyIGVhY2ggPSBoZWxwZXJzLmVhY2ggPSBmdW5jdGlvbihsb29wYWJsZSxjYWxsYmFjayxzZWxmKXtcblx0XHRcdHZhciBhZGRpdGlvbmFsQXJncyA9IEFycmF5LnByb3RvdHlwZS5zbGljZS5jYWxsKGFyZ3VtZW50cywgMyk7XG5cdFx0XHQvLyBDaGVjayB0byBzZWUgaWYgbnVsbCBvciB1bmRlZmluZWQgZmlyc3RseS5cblx0XHRcdGlmIChsb29wYWJsZSl7XG5cdFx0XHRcdGlmIChsb29wYWJsZS5sZW5ndGggPT09ICtsb29wYWJsZS5sZW5ndGgpe1xuXHRcdFx0XHRcdHZhciBpO1xuXHRcdFx0XHRcdGZvciAoaT0wOyBpPGxvb3BhYmxlLmxlbmd0aDsgaSsrKXtcblx0XHRcdFx0XHRcdGNhbGxiYWNrLmFwcGx5KHNlbGYsW2xvb3BhYmxlW2ldLCBpXS5jb25jYXQoYWRkaXRpb25hbEFyZ3MpKTtcblx0XHRcdFx0XHR9XG5cdFx0XHRcdH1cblx0XHRcdFx0ZWxzZXtcblx0XHRcdFx0XHRmb3IgKHZhciBpdGVtIGluIGxvb3BhYmxlKXtcblx0XHRcdFx0XHRcdGNhbGxiYWNrLmFwcGx5KHNlbGYsW2xvb3BhYmxlW2l0ZW1dLGl0ZW1dLmNvbmNhdChhZGRpdGlvbmFsQXJncykpO1xuXHRcdFx0XHRcdH1cblx0XHRcdFx0fVxuXHRcdFx0fVxuXHRcdH0sXG5cdFx0Y2xvbmUgPSBoZWxwZXJzLmNsb25lID0gZnVuY3Rpb24ob2JqKXtcblx0XHRcdHZhciBvYmpDbG9uZSA9IHt9O1xuXHRcdFx0ZWFjaChvYmosZnVuY3Rpb24odmFsdWUsa2V5KXtcblx0XHRcdFx0aWYgKG9iai5oYXNPd25Qcm9wZXJ0eShrZXkpKXtcblx0XHRcdFx0XHRvYmpDbG9uZVtrZXldID0gdmFsdWU7XG5cdFx0XHRcdH1cblx0XHRcdH0pO1xuXHRcdFx0cmV0dXJuIG9iakNsb25lO1xuXHRcdH0sXG5cdFx0ZXh0ZW5kID0gaGVscGVycy5leHRlbmQgPSBmdW5jdGlvbihiYXNlKXtcblx0XHRcdGVhY2goQXJyYXkucHJvdG90eXBlLnNsaWNlLmNhbGwoYXJndW1lbnRzLDEpLCBmdW5jdGlvbihleHRlbnNpb25PYmplY3QpIHtcblx0XHRcdFx0ZWFjaChleHRlbnNpb25PYmplY3QsZnVuY3Rpb24odmFsdWUsa2V5KXtcblx0XHRcdFx0XHRpZiAoZXh0ZW5zaW9uT2JqZWN0Lmhhc093blByb3BlcnR5KGtleSkpe1xuXHRcdFx0XHRcdFx0YmFzZVtrZXldID0gdmFsdWU7XG5cdFx0XHRcdFx0fVxuXHRcdFx0XHR9KTtcblx0XHRcdH0pO1xuXHRcdFx0cmV0dXJuIGJhc2U7XG5cdFx0fSxcblx0XHRtZXJnZSA9IGhlbHBlcnMubWVyZ2UgPSBmdW5jdGlvbihiYXNlLG1hc3Rlcil7XG5cdFx0XHQvL01lcmdlIHByb3BlcnRpZXMgaW4gbGVmdCBvYmplY3Qgb3ZlciB0byBhIHNoYWxsb3cgY2xvbmUgb2Ygb2JqZWN0IHJpZ2h0LlxuXHRcdFx0dmFyIGFyZ3MgPSBBcnJheS5wcm90b3R5cGUuc2xpY2UuY2FsbChhcmd1bWVudHMsMCk7XG5cdFx0XHRhcmdzLnVuc2hpZnQoe30pO1xuXHRcdFx0cmV0dXJuIGV4dGVuZC5hcHBseShudWxsLCBhcmdzKTtcblx0XHR9LFxuXHRcdGluZGV4T2YgPSBoZWxwZXJzLmluZGV4T2YgPSBmdW5jdGlvbihhcnJheVRvU2VhcmNoLCBpdGVtKXtcblx0XHRcdGlmIChBcnJheS5wcm90b3R5cGUuaW5kZXhPZikge1xuXHRcdFx0XHRyZXR1cm4gYXJyYXlUb1NlYXJjaC5pbmRleE9mKGl0ZW0pO1xuXHRcdFx0fVxuXHRcdFx0ZWxzZXtcblx0XHRcdFx0Zm9yICh2YXIgaSA9IDA7IGkgPCBhcnJheVRvU2VhcmNoLmxlbmd0aDsgaSsrKSB7XG5cdFx0XHRcdFx0aWYgKGFycmF5VG9TZWFyY2hbaV0gPT09IGl0ZW0pIHJldHVybiBpO1xuXHRcdFx0XHR9XG5cdFx0XHRcdHJldHVybiAtMTtcblx0XHRcdH1cblx0XHR9LFxuXHRcdHdoZXJlID0gaGVscGVycy53aGVyZSA9IGZ1bmN0aW9uKGNvbGxlY3Rpb24sIGZpbHRlckNhbGxiYWNrKXtcblx0XHRcdHZhciBmaWx0ZXJlZCA9IFtdO1xuXG5cdFx0XHRoZWxwZXJzLmVhY2goY29sbGVjdGlvbiwgZnVuY3Rpb24oaXRlbSl7XG5cdFx0XHRcdGlmIChmaWx0ZXJDYWxsYmFjayhpdGVtKSl7XG5cdFx0XHRcdFx0ZmlsdGVyZWQucHVzaChpdGVtKTtcblx0XHRcdFx0fVxuXHRcdFx0fSk7XG5cblx0XHRcdHJldHVybiBmaWx0ZXJlZDtcblx0XHR9LFxuXHRcdGZpbmROZXh0V2hlcmUgPSBoZWxwZXJzLmZpbmROZXh0V2hlcmUgPSBmdW5jdGlvbihhcnJheVRvU2VhcmNoLCBmaWx0ZXJDYWxsYmFjaywgc3RhcnRJbmRleCl7XG5cdFx0XHQvLyBEZWZhdWx0IHRvIHN0YXJ0IG9mIHRoZSBhcnJheVxuXHRcdFx0aWYgKCFzdGFydEluZGV4KXtcblx0XHRcdFx0c3RhcnRJbmRleCA9IC0xO1xuXHRcdFx0fVxuXHRcdFx0Zm9yICh2YXIgaSA9IHN0YXJ0SW5kZXggKyAxOyBpIDwgYXJyYXlUb1NlYXJjaC5sZW5ndGg7IGkrKykge1xuXHRcdFx0XHR2YXIgY3VycmVudEl0ZW0gPSBhcnJheVRvU2VhcmNoW2ldO1xuXHRcdFx0XHRpZiAoZmlsdGVyQ2FsbGJhY2soY3VycmVudEl0ZW0pKXtcblx0XHRcdFx0XHRyZXR1cm4gY3VycmVudEl0ZW07XG5cdFx0XHRcdH1cblx0XHRcdH1cblx0XHR9LFxuXHRcdGZpbmRQcmV2aW91c1doZXJlID0gaGVscGVycy5maW5kUHJldmlvdXNXaGVyZSA9IGZ1bmN0aW9uKGFycmF5VG9TZWFyY2gsIGZpbHRlckNhbGxiYWNrLCBzdGFydEluZGV4KXtcblx0XHRcdC8vIERlZmF1bHQgdG8gZW5kIG9mIHRoZSBhcnJheVxuXHRcdFx0aWYgKCFzdGFydEluZGV4KXtcblx0XHRcdFx0c3RhcnRJbmRleCA9IGFycmF5VG9TZWFyY2gubGVuZ3RoO1xuXHRcdFx0fVxuXHRcdFx0Zm9yICh2YXIgaSA9IHN0YXJ0SW5kZXggLSAxOyBpID49IDA7IGktLSkge1xuXHRcdFx0XHR2YXIgY3VycmVudEl0ZW0gPSBhcnJheVRvU2VhcmNoW2ldO1xuXHRcdFx0XHRpZiAoZmlsdGVyQ2FsbGJhY2soY3VycmVudEl0ZW0pKXtcblx0XHRcdFx0XHRyZXR1cm4gY3VycmVudEl0ZW07XG5cdFx0XHRcdH1cblx0XHRcdH1cblx0XHR9LFxuXHRcdGluaGVyaXRzID0gaGVscGVycy5pbmhlcml0cyA9IGZ1bmN0aW9uKGV4dGVuc2lvbnMpe1xuXHRcdFx0Ly9CYXNpYyBqYXZhc2NyaXB0IGluaGVyaXRhbmNlIGJhc2VkIG9uIHRoZSBtb2RlbCBjcmVhdGVkIGluIEJhY2tib25lLmpzXG5cdFx0XHR2YXIgcGFyZW50ID0gdGhpcztcblx0XHRcdHZhciBDaGFydEVsZW1lbnQgPSAoZXh0ZW5zaW9ucyAmJiBleHRlbnNpb25zLmhhc093blByb3BlcnR5KFwiY29uc3RydWN0b3JcIikpID8gZXh0ZW5zaW9ucy5jb25zdHJ1Y3RvciA6IGZ1bmN0aW9uKCl7IHJldHVybiBwYXJlbnQuYXBwbHkodGhpcywgYXJndW1lbnRzKTsgfTtcblxuXHRcdFx0dmFyIFN1cnJvZ2F0ZSA9IGZ1bmN0aW9uKCl7IHRoaXMuY29uc3RydWN0b3IgPSBDaGFydEVsZW1lbnQ7fTtcblx0XHRcdFN1cnJvZ2F0ZS5wcm90b3R5cGUgPSBwYXJlbnQucHJvdG90eXBlO1xuXHRcdFx0Q2hhcnRFbGVtZW50LnByb3RvdHlwZSA9IG5ldyBTdXJyb2dhdGUoKTtcblxuXHRcdFx0Q2hhcnRFbGVtZW50LmV4dGVuZCA9IGluaGVyaXRzO1xuXG5cdFx0XHRpZiAoZXh0ZW5zaW9ucykgZXh0ZW5kKENoYXJ0RWxlbWVudC5wcm90b3R5cGUsIGV4dGVuc2lvbnMpO1xuXG5cdFx0XHRDaGFydEVsZW1lbnQuX19zdXBlcl9fID0gcGFyZW50LnByb3RvdHlwZTtcblxuXHRcdFx0cmV0dXJuIENoYXJ0RWxlbWVudDtcblx0XHR9LFxuXHRcdG5vb3AgPSBoZWxwZXJzLm5vb3AgPSBmdW5jdGlvbigpe30sXG5cdFx0dWlkID0gaGVscGVycy51aWQgPSAoZnVuY3Rpb24oKXtcblx0XHRcdHZhciBpZD0wO1xuXHRcdFx0cmV0dXJuIGZ1bmN0aW9uKCl7XG5cdFx0XHRcdHJldHVybiBcImNoYXJ0LVwiICsgaWQrKztcblx0XHRcdH07XG5cdFx0fSkoKSxcblx0XHR3YXJuID0gaGVscGVycy53YXJuID0gZnVuY3Rpb24oc3RyKXtcblx0XHRcdC8vTWV0aG9kIGZvciB3YXJuaW5nIG9mIGVycm9yc1xuXHRcdFx0aWYgKHdpbmRvdy5jb25zb2xlICYmIHR5cGVvZiB3aW5kb3cuY29uc29sZS53YXJuID09PSBcImZ1bmN0aW9uXCIpIGNvbnNvbGUud2FybihzdHIpO1xuXHRcdH0sXG5cdFx0YW1kID0gaGVscGVycy5hbWQgPSAodHlwZW9mIGRlZmluZSA9PT0gJ2Z1bmN0aW9uJyAmJiBkZWZpbmUuYW1kKSxcblx0XHQvLy0tIE1hdGggbWV0aG9kc1xuXHRcdGlzTnVtYmVyID0gaGVscGVycy5pc051bWJlciA9IGZ1bmN0aW9uKG4pe1xuXHRcdFx0cmV0dXJuICFpc05hTihwYXJzZUZsb2F0KG4pKSAmJiBpc0Zpbml0ZShuKTtcblx0XHR9LFxuXHRcdG1heCA9IGhlbHBlcnMubWF4ID0gZnVuY3Rpb24oYXJyYXkpe1xuXHRcdFx0cmV0dXJuIE1hdGgubWF4LmFwcGx5KCBNYXRoLCBhcnJheSApO1xuXHRcdH0sXG5cdFx0bWluID0gaGVscGVycy5taW4gPSBmdW5jdGlvbihhcnJheSl7XG5cdFx0XHRyZXR1cm4gTWF0aC5taW4uYXBwbHkoIE1hdGgsIGFycmF5ICk7XG5cdFx0fSxcblx0XHRjYXAgPSBoZWxwZXJzLmNhcCA9IGZ1bmN0aW9uKHZhbHVlVG9DYXAsbWF4VmFsdWUsbWluVmFsdWUpe1xuXHRcdFx0aWYoaXNOdW1iZXIobWF4VmFsdWUpKSB7XG5cdFx0XHRcdGlmKCB2YWx1ZVRvQ2FwID4gbWF4VmFsdWUgKSB7XG5cdFx0XHRcdFx0cmV0dXJuIG1heFZhbHVlO1xuXHRcdFx0XHR9XG5cdFx0XHR9XG5cdFx0XHRlbHNlIGlmKGlzTnVtYmVyKG1pblZhbHVlKSl7XG5cdFx0XHRcdGlmICggdmFsdWVUb0NhcCA8IG1pblZhbHVlICl7XG5cdFx0XHRcdFx0cmV0dXJuIG1pblZhbHVlO1xuXHRcdFx0XHR9XG5cdFx0XHR9XG5cdFx0XHRyZXR1cm4gdmFsdWVUb0NhcDtcblx0XHR9LFxuXHRcdGdldERlY2ltYWxQbGFjZXMgPSBoZWxwZXJzLmdldERlY2ltYWxQbGFjZXMgPSBmdW5jdGlvbihudW0pe1xuXHRcdFx0aWYgKG51bSUxIT09MCAmJiBpc051bWJlcihudW0pKXtcblx0XHRcdFx0dmFyIHMgPSBudW0udG9TdHJpbmcoKTtcblx0XHRcdFx0aWYocy5pbmRleE9mKFwiZS1cIikgPCAwKXtcblx0XHRcdFx0XHQvLyBubyBleHBvbmVudCwgZS5nLiAwLjAxXG5cdFx0XHRcdFx0cmV0dXJuIHMuc3BsaXQoXCIuXCIpWzFdLmxlbmd0aDtcblx0XHRcdFx0fVxuXHRcdFx0XHRlbHNlIGlmKHMuaW5kZXhPZihcIi5cIikgPCAwKSB7XG5cdFx0XHRcdFx0Ly8gbm8gZGVjaW1hbCBwb2ludCwgZS5nLiAxZS05XG5cdFx0XHRcdFx0cmV0dXJuIHBhcnNlSW50KHMuc3BsaXQoXCJlLVwiKVsxXSk7XG5cdFx0XHRcdH1cblx0XHRcdFx0ZWxzZSB7XG5cdFx0XHRcdFx0Ly8gZXhwb25lbnQgYW5kIGRlY2ltYWwgcG9pbnQsIGUuZy4gMS4yM2UtOVxuXHRcdFx0XHRcdHZhciBwYXJ0cyA9IHMuc3BsaXQoXCIuXCIpWzFdLnNwbGl0KFwiZS1cIik7XG5cdFx0XHRcdFx0cmV0dXJuIHBhcnRzWzBdLmxlbmd0aCArIHBhcnNlSW50KHBhcnRzWzFdKTtcblx0XHRcdFx0fVxuXHRcdFx0fVxuXHRcdFx0ZWxzZSB7XG5cdFx0XHRcdHJldHVybiAwO1xuXHRcdFx0fVxuXHRcdH0sXG5cdFx0dG9SYWRpYW5zID0gaGVscGVycy5yYWRpYW5zID0gZnVuY3Rpb24oZGVncmVlcyl7XG5cdFx0XHRyZXR1cm4gZGVncmVlcyAqIChNYXRoLlBJLzE4MCk7XG5cdFx0fSxcblx0XHQvLyBHZXRzIHRoZSBhbmdsZSBmcm9tIHZlcnRpY2FsIHVwcmlnaHQgdG8gdGhlIHBvaW50IGFib3V0IGEgY2VudHJlLlxuXHRcdGdldEFuZ2xlRnJvbVBvaW50ID0gaGVscGVycy5nZXRBbmdsZUZyb21Qb2ludCA9IGZ1bmN0aW9uKGNlbnRyZVBvaW50LCBhbmdsZVBvaW50KXtcblx0XHRcdHZhciBkaXN0YW5jZUZyb21YQ2VudGVyID0gYW5nbGVQb2ludC54IC0gY2VudHJlUG9pbnQueCxcblx0XHRcdFx0ZGlzdGFuY2VGcm9tWUNlbnRlciA9IGFuZ2xlUG9pbnQueSAtIGNlbnRyZVBvaW50LnksXG5cdFx0XHRcdHJhZGlhbERpc3RhbmNlRnJvbUNlbnRlciA9IE1hdGguc3FydCggZGlzdGFuY2VGcm9tWENlbnRlciAqIGRpc3RhbmNlRnJvbVhDZW50ZXIgKyBkaXN0YW5jZUZyb21ZQ2VudGVyICogZGlzdGFuY2VGcm9tWUNlbnRlcik7XG5cblxuXHRcdFx0dmFyIGFuZ2xlID0gTWF0aC5QSSAqIDIgKyBNYXRoLmF0YW4yKGRpc3RhbmNlRnJvbVlDZW50ZXIsIGRpc3RhbmNlRnJvbVhDZW50ZXIpO1xuXG5cdFx0XHQvL0lmIHRoZSBzZWdtZW50IGlzIGluIHRoZSB0b3AgbGVmdCBxdWFkcmFudCwgd2UgbmVlZCB0byBhZGQgYW5vdGhlciByb3RhdGlvbiB0byB0aGUgYW5nbGVcblx0XHRcdGlmIChkaXN0YW5jZUZyb21YQ2VudGVyIDwgMCAmJiBkaXN0YW5jZUZyb21ZQ2VudGVyIDwgMCl7XG5cdFx0XHRcdGFuZ2xlICs9IE1hdGguUEkqMjtcblx0XHRcdH1cblxuXHRcdFx0cmV0dXJuIHtcblx0XHRcdFx0YW5nbGU6IGFuZ2xlLFxuXHRcdFx0XHRkaXN0YW5jZTogcmFkaWFsRGlzdGFuY2VGcm9tQ2VudGVyXG5cdFx0XHR9O1xuXHRcdH0sXG5cdFx0YWxpYXNQaXhlbCA9IGhlbHBlcnMuYWxpYXNQaXhlbCA9IGZ1bmN0aW9uKHBpeGVsV2lkdGgpe1xuXHRcdFx0cmV0dXJuIChwaXhlbFdpZHRoICUgMiA9PT0gMCkgPyAwIDogMC41O1xuXHRcdH0sXG5cdFx0c3BsaW5lQ3VydmUgPSBoZWxwZXJzLnNwbGluZUN1cnZlID0gZnVuY3Rpb24oRmlyc3RQb2ludCxNaWRkbGVQb2ludCxBZnRlclBvaW50LHQpe1xuXHRcdFx0Ly9Qcm9wcyB0byBSb2IgU3BlbmNlciBhdCBzY2FsZWQgaW5ub3ZhdGlvbiBmb3IgaGlzIHBvc3Qgb24gc3BsaW5pbmcgYmV0d2VlbiBwb2ludHNcblx0XHRcdC8vaHR0cDovL3NjYWxlZGlubm92YXRpb24uY29tL2FuYWx5dGljcy9zcGxpbmVzL2Fib3V0U3BsaW5lcy5odG1sXG5cdFx0XHR2YXIgZDAxPU1hdGguc3FydChNYXRoLnBvdyhNaWRkbGVQb2ludC54LUZpcnN0UG9pbnQueCwyKStNYXRoLnBvdyhNaWRkbGVQb2ludC55LUZpcnN0UG9pbnQueSwyKSksXG5cdFx0XHRcdGQxMj1NYXRoLnNxcnQoTWF0aC5wb3coQWZ0ZXJQb2ludC54LU1pZGRsZVBvaW50LngsMikrTWF0aC5wb3coQWZ0ZXJQb2ludC55LU1pZGRsZVBvaW50LnksMikpLFxuXHRcdFx0XHRmYT10KmQwMS8oZDAxK2QxMiksLy8gc2NhbGluZyBmYWN0b3IgZm9yIHRyaWFuZ2xlIFRhXG5cdFx0XHRcdGZiPXQqZDEyLyhkMDErZDEyKTtcblx0XHRcdHJldHVybiB7XG5cdFx0XHRcdGlubmVyIDoge1xuXHRcdFx0XHRcdHggOiBNaWRkbGVQb2ludC54LWZhKihBZnRlclBvaW50LngtRmlyc3RQb2ludC54KSxcblx0XHRcdFx0XHR5IDogTWlkZGxlUG9pbnQueS1mYSooQWZ0ZXJQb2ludC55LUZpcnN0UG9pbnQueSlcblx0XHRcdFx0fSxcblx0XHRcdFx0b3V0ZXIgOiB7XG5cdFx0XHRcdFx0eDogTWlkZGxlUG9pbnQueCtmYiooQWZ0ZXJQb2ludC54LUZpcnN0UG9pbnQueCksXG5cdFx0XHRcdFx0eSA6IE1pZGRsZVBvaW50LnkrZmIqKEFmdGVyUG9pbnQueS1GaXJzdFBvaW50LnkpXG5cdFx0XHRcdH1cblx0XHRcdH07XG5cdFx0fSxcblx0XHRjYWxjdWxhdGVPcmRlck9mTWFnbml0dWRlID0gaGVscGVycy5jYWxjdWxhdGVPcmRlck9mTWFnbml0dWRlID0gZnVuY3Rpb24odmFsKXtcblx0XHRcdHJldHVybiBNYXRoLmZsb29yKE1hdGgubG9nKHZhbCkgLyBNYXRoLkxOMTApO1xuXHRcdH0sXG5cdFx0Y2FsY3VsYXRlU2NhbGVSYW5nZSA9IGhlbHBlcnMuY2FsY3VsYXRlU2NhbGVSYW5nZSA9IGZ1bmN0aW9uKHZhbHVlc0FycmF5LCBkcmF3aW5nU2l6ZSwgdGV4dFNpemUsIHN0YXJ0RnJvbVplcm8sIGludGVnZXJzT25seSl7XG5cblx0XHRcdC8vU2V0IGEgbWluaW11bSBzdGVwIG9mIHR3byAtIGEgcG9pbnQgYXQgdGhlIHRvcCBvZiB0aGUgZ3JhcGgsIGFuZCBhIHBvaW50IGF0IHRoZSBiYXNlXG5cdFx0XHR2YXIgbWluU3RlcHMgPSAyLFxuXHRcdFx0XHRtYXhTdGVwcyA9IE1hdGguZmxvb3IoZHJhd2luZ1NpemUvKHRleHRTaXplICogMS41KSksXG5cdFx0XHRcdHNraXBGaXR0aW5nID0gKG1pblN0ZXBzID49IG1heFN0ZXBzKTtcblxuXHRcdFx0Ly8gRmlsdGVyIG91dCBudWxsIHZhbHVlcyBzaW5jZSB0aGVzZSB3b3VsZCBtaW4oKSB0byB6ZXJvXG5cdFx0XHR2YXIgdmFsdWVzID0gW107XG5cdFx0XHRlYWNoKHZhbHVlc0FycmF5LCBmdW5jdGlvbiggdiApe1xuXHRcdFx0XHR2ID09IG51bGwgfHwgdmFsdWVzLnB1c2goIHYgKTtcblx0XHRcdH0pO1xuXHRcdFx0dmFyIG1pblZhbHVlID0gbWluKHZhbHVlcyksXG5cdFx0XHQgICAgbWF4VmFsdWUgPSBtYXgodmFsdWVzKTtcblxuXHRcdFx0Ly8gV2UgbmVlZCBzb21lIGRlZ3JlZSBvZiBzZXBhcmF0aW9uIGhlcmUgdG8gY2FsY3VsYXRlIHRoZSBzY2FsZXMgaWYgYWxsIHRoZSB2YWx1ZXMgYXJlIHRoZSBzYW1lXG5cdFx0XHQvLyBBZGRpbmcvbWludXNpbmcgMC41IHdpbGwgZ2l2ZSB1cyBhIHJhbmdlIG9mIDEuXG5cdFx0XHRpZiAobWF4VmFsdWUgPT09IG1pblZhbHVlKXtcblx0XHRcdFx0bWF4VmFsdWUgKz0gMC41O1xuXHRcdFx0XHQvLyBTbyB3ZSBkb24ndCBlbmQgdXAgd2l0aCBhIGdyYXBoIHdpdGggYSBuZWdhdGl2ZSBzdGFydCB2YWx1ZSBpZiB3ZSd2ZSBzYWlkIGFsd2F5cyBzdGFydCBmcm9tIHplcm9cblx0XHRcdFx0aWYgKG1pblZhbHVlID49IDAuNSAmJiAhc3RhcnRGcm9tWmVybyl7XG5cdFx0XHRcdFx0bWluVmFsdWUgLT0gMC41O1xuXHRcdFx0XHR9XG5cdFx0XHRcdGVsc2V7XG5cdFx0XHRcdFx0Ly8gTWFrZSB1cCBhIHdob2xlIG51bWJlciBhYm92ZSB0aGUgdmFsdWVzXG5cdFx0XHRcdFx0bWF4VmFsdWUgKz0gMC41O1xuXHRcdFx0XHR9XG5cdFx0XHR9XG5cblx0XHRcdHZhclx0dmFsdWVSYW5nZSA9IE1hdGguYWJzKG1heFZhbHVlIC0gbWluVmFsdWUpLFxuXHRcdFx0XHRyYW5nZU9yZGVyT2ZNYWduaXR1ZGUgPSBjYWxjdWxhdGVPcmRlck9mTWFnbml0dWRlKHZhbHVlUmFuZ2UpLFxuXHRcdFx0XHRncmFwaE1heCA9IE1hdGguY2VpbChtYXhWYWx1ZSAvICgxICogTWF0aC5wb3coMTAsIHJhbmdlT3JkZXJPZk1hZ25pdHVkZSkpKSAqIE1hdGgucG93KDEwLCByYW5nZU9yZGVyT2ZNYWduaXR1ZGUpLFxuXHRcdFx0XHRncmFwaE1pbiA9IChzdGFydEZyb21aZXJvKSA/IDAgOiBNYXRoLmZsb29yKG1pblZhbHVlIC8gKDEgKiBNYXRoLnBvdygxMCwgcmFuZ2VPcmRlck9mTWFnbml0dWRlKSkpICogTWF0aC5wb3coMTAsIHJhbmdlT3JkZXJPZk1hZ25pdHVkZSksXG5cdFx0XHRcdGdyYXBoUmFuZ2UgPSBncmFwaE1heCAtIGdyYXBoTWluLFxuXHRcdFx0XHRzdGVwVmFsdWUgPSBNYXRoLnBvdygxMCwgcmFuZ2VPcmRlck9mTWFnbml0dWRlKSxcblx0XHRcdFx0bnVtYmVyT2ZTdGVwcyA9IE1hdGgucm91bmQoZ3JhcGhSYW5nZSAvIHN0ZXBWYWx1ZSk7XG5cblx0XHRcdC8vSWYgd2UgaGF2ZSBtb3JlIHNwYWNlIG9uIHRoZSBncmFwaCB3ZSdsbCB1c2UgaXQgdG8gZ2l2ZSBtb3JlIGRlZmluaXRpb24gdG8gdGhlIGRhdGFcblx0XHRcdHdoaWxlKChudW1iZXJPZlN0ZXBzID4gbWF4U3RlcHMgfHwgKG51bWJlck9mU3RlcHMgKiAyKSA8IG1heFN0ZXBzKSAmJiAhc2tpcEZpdHRpbmcpIHtcblx0XHRcdFx0aWYobnVtYmVyT2ZTdGVwcyA+IG1heFN0ZXBzKXtcblx0XHRcdFx0XHRzdGVwVmFsdWUgKj0yO1xuXHRcdFx0XHRcdG51bWJlck9mU3RlcHMgPSBNYXRoLnJvdW5kKGdyYXBoUmFuZ2Uvc3RlcFZhbHVlKTtcblx0XHRcdFx0XHQvLyBEb24ndCBldmVyIGRlYWwgd2l0aCBhIGRlY2ltYWwgbnVtYmVyIG9mIHN0ZXBzIC0gY2FuY2VsIGZpdHRpbmcgYW5kIGp1c3QgdXNlIHRoZSBtaW5pbXVtIG51bWJlciBvZiBzdGVwcy5cblx0XHRcdFx0XHRpZiAobnVtYmVyT2ZTdGVwcyAlIDEgIT09IDApe1xuXHRcdFx0XHRcdFx0c2tpcEZpdHRpbmcgPSB0cnVlO1xuXHRcdFx0XHRcdH1cblx0XHRcdFx0fVxuXHRcdFx0XHQvL1dlIGNhbiBmaXQgaW4gZG91YmxlIHRoZSBhbW91bnQgb2Ygc2NhbGUgcG9pbnRzIG9uIHRoZSBzY2FsZVxuXHRcdFx0XHRlbHNle1xuXHRcdFx0XHRcdC8vSWYgdXNlciBoYXMgZGVjbGFyZWQgaW50cyBvbmx5LCBhbmQgdGhlIHN0ZXAgdmFsdWUgaXNuJ3QgYSBkZWNpbWFsXG5cdFx0XHRcdFx0aWYgKGludGVnZXJzT25seSAmJiByYW5nZU9yZGVyT2ZNYWduaXR1ZGUgPj0gMCl7XG5cdFx0XHRcdFx0XHQvL0lmIHRoZSB1c2VyIGhhcyBzYWlkIGludGVnZXJzIG9ubHksIHdlIG5lZWQgdG8gY2hlY2sgdGhhdCBtYWtpbmcgdGhlIHNjYWxlIG1vcmUgZ3JhbnVsYXIgd291bGRuJ3QgbWFrZSBpdCBhIGZsb2F0XG5cdFx0XHRcdFx0XHRpZihzdGVwVmFsdWUvMiAlIDEgPT09IDApe1xuXHRcdFx0XHRcdFx0XHRzdGVwVmFsdWUgLz0yO1xuXHRcdFx0XHRcdFx0XHRudW1iZXJPZlN0ZXBzID0gTWF0aC5yb3VuZChncmFwaFJhbmdlL3N0ZXBWYWx1ZSk7XG5cdFx0XHRcdFx0XHR9XG5cdFx0XHRcdFx0XHQvL0lmIGl0IHdvdWxkIG1ha2UgaXQgYSBmbG9hdCBicmVhayBvdXQgb2YgdGhlIGxvb3Bcblx0XHRcdFx0XHRcdGVsc2V7XG5cdFx0XHRcdFx0XHRcdGJyZWFrO1xuXHRcdFx0XHRcdFx0fVxuXHRcdFx0XHRcdH1cblx0XHRcdFx0XHQvL0lmIHRoZSBzY2FsZSBkb2Vzbid0IGhhdmUgdG8gYmUgYW4gaW50LCBtYWtlIHRoZSBzY2FsZSBtb3JlIGdyYW51bGFyIGFueXdheS5cblx0XHRcdFx0XHRlbHNle1xuXHRcdFx0XHRcdFx0c3RlcFZhbHVlIC89Mjtcblx0XHRcdFx0XHRcdG51bWJlck9mU3RlcHMgPSBNYXRoLnJvdW5kKGdyYXBoUmFuZ2Uvc3RlcFZhbHVlKTtcblx0XHRcdFx0XHR9XG5cblx0XHRcdFx0fVxuXHRcdFx0fVxuXG5cdFx0XHRpZiAoc2tpcEZpdHRpbmcpe1xuXHRcdFx0XHRudW1iZXJPZlN0ZXBzID0gbWluU3RlcHM7XG5cdFx0XHRcdHN0ZXBWYWx1ZSA9IGdyYXBoUmFuZ2UgLyBudW1iZXJPZlN0ZXBzO1xuXHRcdFx0fVxuXG5cdFx0XHRyZXR1cm4ge1xuXHRcdFx0XHRzdGVwcyA6IG51bWJlck9mU3RlcHMsXG5cdFx0XHRcdHN0ZXBWYWx1ZSA6IHN0ZXBWYWx1ZSxcblx0XHRcdFx0bWluIDogZ3JhcGhNaW4sXG5cdFx0XHRcdG1heFx0OiBncmFwaE1pbiArIChudW1iZXJPZlN0ZXBzICogc3RlcFZhbHVlKVxuXHRcdFx0fTtcblxuXHRcdH0sXG5cdFx0LyoganNoaW50IGlnbm9yZTpzdGFydCAqL1xuXHRcdC8vIEJsb3dzIHVwIGpzaGludCBlcnJvcnMgYmFzZWQgb24gdGhlIG5ldyBGdW5jdGlvbiBjb25zdHJ1Y3RvclxuXHRcdC8vVGVtcGxhdGluZyBtZXRob2RzXG5cdFx0Ly9KYXZhc2NyaXB0IG1pY3JvIHRlbXBsYXRpbmcgYnkgSm9obiBSZXNpZyAtIHNvdXJjZSBhdCBodHRwOi8vZWpvaG4ub3JnL2Jsb2cvamF2YXNjcmlwdC1taWNyby10ZW1wbGF0aW5nL1xuXHRcdHRlbXBsYXRlID0gaGVscGVycy50ZW1wbGF0ZSA9IGZ1bmN0aW9uKHRlbXBsYXRlU3RyaW5nLCB2YWx1ZXNPYmplY3Qpe1xuXG5cdFx0XHQvLyBJZiB0ZW1wbGF0ZVN0cmluZyBpcyBmdW5jdGlvbiByYXRoZXIgdGhhbiBzdHJpbmctdGVtcGxhdGUgLSBjYWxsIHRoZSBmdW5jdGlvbiBmb3IgdmFsdWVzT2JqZWN0XG5cblx0XHRcdGlmKHRlbXBsYXRlU3RyaW5nIGluc3RhbmNlb2YgRnVuY3Rpb24pe1xuXHRcdFx0IFx0cmV0dXJuIHRlbXBsYXRlU3RyaW5nKHZhbHVlc09iamVjdCk7XG5cdFx0IFx0fVxuXG5cdFx0XHR2YXIgY2FjaGUgPSB7fTtcblx0XHRcdGZ1bmN0aW9uIHRtcGwoc3RyLCBkYXRhKXtcblx0XHRcdFx0Ly8gRmlndXJlIG91dCBpZiB3ZSdyZSBnZXR0aW5nIGEgdGVtcGxhdGUsIG9yIGlmIHdlIG5lZWQgdG9cblx0XHRcdFx0Ly8gbG9hZCB0aGUgdGVtcGxhdGUgLSBhbmQgYmUgc3VyZSB0byBjYWNoZSB0aGUgcmVzdWx0LlxuXHRcdFx0XHR2YXIgZm4gPSAhL1xcVy8udGVzdChzdHIpID9cblx0XHRcdFx0Y2FjaGVbc3RyXSA9IGNhY2hlW3N0cl0gOlxuXG5cdFx0XHRcdC8vIEdlbmVyYXRlIGEgcmV1c2FibGUgZnVuY3Rpb24gdGhhdCB3aWxsIHNlcnZlIGFzIGEgdGVtcGxhdGVcblx0XHRcdFx0Ly8gZ2VuZXJhdG9yIChhbmQgd2hpY2ggd2lsbCBiZSBjYWNoZWQpLlxuXHRcdFx0XHRuZXcgRnVuY3Rpb24oXCJvYmpcIixcblx0XHRcdFx0XHRcInZhciBwPVtdLHByaW50PWZ1bmN0aW9uKCl7cC5wdXNoLmFwcGx5KHAsYXJndW1lbnRzKTt9O1wiICtcblxuXHRcdFx0XHRcdC8vIEludHJvZHVjZSB0aGUgZGF0YSBhcyBsb2NhbCB2YXJpYWJsZXMgdXNpbmcgd2l0aCgpe31cblx0XHRcdFx0XHRcIndpdGgob2JqKXtwLnB1c2goJ1wiICtcblxuXHRcdFx0XHRcdC8vIENvbnZlcnQgdGhlIHRlbXBsYXRlIGludG8gcHVyZSBKYXZhU2NyaXB0XG5cdFx0XHRcdFx0c3RyXG5cdFx0XHRcdFx0XHQucmVwbGFjZSgvW1xcclxcdFxcbl0vZywgXCIgXCIpXG5cdFx0XHRcdFx0XHQuc3BsaXQoXCI8JVwiKS5qb2luKFwiXFx0XCIpXG5cdFx0XHRcdFx0XHQucmVwbGFjZSgvKChefCU+KVteXFx0XSopJy9nLCBcIiQxXFxyXCIpXG5cdFx0XHRcdFx0XHQucmVwbGFjZSgvXFx0PSguKj8pJT4vZywgXCInLCQxLCdcIilcblx0XHRcdFx0XHRcdC5zcGxpdChcIlxcdFwiKS5qb2luKFwiJyk7XCIpXG5cdFx0XHRcdFx0XHQuc3BsaXQoXCIlPlwiKS5qb2luKFwicC5wdXNoKCdcIilcblx0XHRcdFx0XHRcdC5zcGxpdChcIlxcclwiKS5qb2luKFwiXFxcXCdcIikgK1xuXHRcdFx0XHRcdFwiJyk7fXJldHVybiBwLmpvaW4oJycpO1wiXG5cdFx0XHRcdCk7XG5cblx0XHRcdFx0Ly8gUHJvdmlkZSBzb21lIGJhc2ljIGN1cnJ5aW5nIHRvIHRoZSB1c2VyXG5cdFx0XHRcdHJldHVybiBkYXRhID8gZm4oIGRhdGEgKSA6IGZuO1xuXHRcdFx0fVxuXHRcdFx0cmV0dXJuIHRtcGwodGVtcGxhdGVTdHJpbmcsdmFsdWVzT2JqZWN0KTtcblx0XHR9LFxuXHRcdC8qIGpzaGludCBpZ25vcmU6ZW5kICovXG5cdFx0Z2VuZXJhdGVMYWJlbHMgPSBoZWxwZXJzLmdlbmVyYXRlTGFiZWxzID0gZnVuY3Rpb24odGVtcGxhdGVTdHJpbmcsbnVtYmVyT2ZTdGVwcyxncmFwaE1pbixzdGVwVmFsdWUpe1xuXHRcdFx0dmFyIGxhYmVsc0FycmF5ID0gbmV3IEFycmF5KG51bWJlck9mU3RlcHMpO1xuXHRcdFx0aWYgKHRlbXBsYXRlU3RyaW5nKXtcblx0XHRcdFx0ZWFjaChsYWJlbHNBcnJheSxmdW5jdGlvbih2YWwsaW5kZXgpe1xuXHRcdFx0XHRcdGxhYmVsc0FycmF5W2luZGV4XSA9IHRlbXBsYXRlKHRlbXBsYXRlU3RyaW5nLHt2YWx1ZTogKGdyYXBoTWluICsgKHN0ZXBWYWx1ZSooaW5kZXgrMSkpKX0pO1xuXHRcdFx0XHR9KTtcblx0XHRcdH1cblx0XHRcdHJldHVybiBsYWJlbHNBcnJheTtcblx0XHR9LFxuXHRcdC8vLS1BbmltYXRpb24gbWV0aG9kc1xuXHRcdC8vRWFzaW5nIGZ1bmN0aW9ucyBhZGFwdGVkIGZyb20gUm9iZXJ0IFBlbm5lcidzIGVhc2luZyBlcXVhdGlvbnNcblx0XHQvL2h0dHA6Ly93d3cucm9iZXJ0cGVubmVyLmNvbS9lYXNpbmcvXG5cdFx0ZWFzaW5nRWZmZWN0cyA9IGhlbHBlcnMuZWFzaW5nRWZmZWN0cyA9IHtcblx0XHRcdGxpbmVhcjogZnVuY3Rpb24gKHQpIHtcblx0XHRcdFx0cmV0dXJuIHQ7XG5cdFx0XHR9LFxuXHRcdFx0ZWFzZUluUXVhZDogZnVuY3Rpb24gKHQpIHtcblx0XHRcdFx0cmV0dXJuIHQgKiB0O1xuXHRcdFx0fSxcblx0XHRcdGVhc2VPdXRRdWFkOiBmdW5jdGlvbiAodCkge1xuXHRcdFx0XHRyZXR1cm4gLTEgKiB0ICogKHQgLSAyKTtcblx0XHRcdH0sXG5cdFx0XHRlYXNlSW5PdXRRdWFkOiBmdW5jdGlvbiAodCkge1xuXHRcdFx0XHRpZiAoKHQgLz0gMSAvIDIpIDwgMSl7XG5cdFx0XHRcdFx0cmV0dXJuIDEgLyAyICogdCAqIHQ7XG5cdFx0XHRcdH1cblx0XHRcdFx0cmV0dXJuIC0xIC8gMiAqICgoLS10KSAqICh0IC0gMikgLSAxKTtcblx0XHRcdH0sXG5cdFx0XHRlYXNlSW5DdWJpYzogZnVuY3Rpb24gKHQpIHtcblx0XHRcdFx0cmV0dXJuIHQgKiB0ICogdDtcblx0XHRcdH0sXG5cdFx0XHRlYXNlT3V0Q3ViaWM6IGZ1bmN0aW9uICh0KSB7XG5cdFx0XHRcdHJldHVybiAxICogKCh0ID0gdCAvIDEgLSAxKSAqIHQgKiB0ICsgMSk7XG5cdFx0XHR9LFxuXHRcdFx0ZWFzZUluT3V0Q3ViaWM6IGZ1bmN0aW9uICh0KSB7XG5cdFx0XHRcdGlmICgodCAvPSAxIC8gMikgPCAxKXtcblx0XHRcdFx0XHRyZXR1cm4gMSAvIDIgKiB0ICogdCAqIHQ7XG5cdFx0XHRcdH1cblx0XHRcdFx0cmV0dXJuIDEgLyAyICogKCh0IC09IDIpICogdCAqIHQgKyAyKTtcblx0XHRcdH0sXG5cdFx0XHRlYXNlSW5RdWFydDogZnVuY3Rpb24gKHQpIHtcblx0XHRcdFx0cmV0dXJuIHQgKiB0ICogdCAqIHQ7XG5cdFx0XHR9LFxuXHRcdFx0ZWFzZU91dFF1YXJ0OiBmdW5jdGlvbiAodCkge1xuXHRcdFx0XHRyZXR1cm4gLTEgKiAoKHQgPSB0IC8gMSAtIDEpICogdCAqIHQgKiB0IC0gMSk7XG5cdFx0XHR9LFxuXHRcdFx0ZWFzZUluT3V0UXVhcnQ6IGZ1bmN0aW9uICh0KSB7XG5cdFx0XHRcdGlmICgodCAvPSAxIC8gMikgPCAxKXtcblx0XHRcdFx0XHRyZXR1cm4gMSAvIDIgKiB0ICogdCAqIHQgKiB0O1xuXHRcdFx0XHR9XG5cdFx0XHRcdHJldHVybiAtMSAvIDIgKiAoKHQgLT0gMikgKiB0ICogdCAqIHQgLSAyKTtcblx0XHRcdH0sXG5cdFx0XHRlYXNlSW5RdWludDogZnVuY3Rpb24gKHQpIHtcblx0XHRcdFx0cmV0dXJuIDEgKiAodCAvPSAxKSAqIHQgKiB0ICogdCAqIHQ7XG5cdFx0XHR9LFxuXHRcdFx0ZWFzZU91dFF1aW50OiBmdW5jdGlvbiAodCkge1xuXHRcdFx0XHRyZXR1cm4gMSAqICgodCA9IHQgLyAxIC0gMSkgKiB0ICogdCAqIHQgKiB0ICsgMSk7XG5cdFx0XHR9LFxuXHRcdFx0ZWFzZUluT3V0UXVpbnQ6IGZ1bmN0aW9uICh0KSB7XG5cdFx0XHRcdGlmICgodCAvPSAxIC8gMikgPCAxKXtcblx0XHRcdFx0XHRyZXR1cm4gMSAvIDIgKiB0ICogdCAqIHQgKiB0ICogdDtcblx0XHRcdFx0fVxuXHRcdFx0XHRyZXR1cm4gMSAvIDIgKiAoKHQgLT0gMikgKiB0ICogdCAqIHQgKiB0ICsgMik7XG5cdFx0XHR9LFxuXHRcdFx0ZWFzZUluU2luZTogZnVuY3Rpb24gKHQpIHtcblx0XHRcdFx0cmV0dXJuIC0xICogTWF0aC5jb3ModCAvIDEgKiAoTWF0aC5QSSAvIDIpKSArIDE7XG5cdFx0XHR9LFxuXHRcdFx0ZWFzZU91dFNpbmU6IGZ1bmN0aW9uICh0KSB7XG5cdFx0XHRcdHJldHVybiAxICogTWF0aC5zaW4odCAvIDEgKiAoTWF0aC5QSSAvIDIpKTtcblx0XHRcdH0sXG5cdFx0XHRlYXNlSW5PdXRTaW5lOiBmdW5jdGlvbiAodCkge1xuXHRcdFx0XHRyZXR1cm4gLTEgLyAyICogKE1hdGguY29zKE1hdGguUEkgKiB0IC8gMSkgLSAxKTtcblx0XHRcdH0sXG5cdFx0XHRlYXNlSW5FeHBvOiBmdW5jdGlvbiAodCkge1xuXHRcdFx0XHRyZXR1cm4gKHQgPT09IDApID8gMSA6IDEgKiBNYXRoLnBvdygyLCAxMCAqICh0IC8gMSAtIDEpKTtcblx0XHRcdH0sXG5cdFx0XHRlYXNlT3V0RXhwbzogZnVuY3Rpb24gKHQpIHtcblx0XHRcdFx0cmV0dXJuICh0ID09PSAxKSA/IDEgOiAxICogKC1NYXRoLnBvdygyLCAtMTAgKiB0IC8gMSkgKyAxKTtcblx0XHRcdH0sXG5cdFx0XHRlYXNlSW5PdXRFeHBvOiBmdW5jdGlvbiAodCkge1xuXHRcdFx0XHRpZiAodCA9PT0gMCl7XG5cdFx0XHRcdFx0cmV0dXJuIDA7XG5cdFx0XHRcdH1cblx0XHRcdFx0aWYgKHQgPT09IDEpe1xuXHRcdFx0XHRcdHJldHVybiAxO1xuXHRcdFx0XHR9XG5cdFx0XHRcdGlmICgodCAvPSAxIC8gMikgPCAxKXtcblx0XHRcdFx0XHRyZXR1cm4gMSAvIDIgKiBNYXRoLnBvdygyLCAxMCAqICh0IC0gMSkpO1xuXHRcdFx0XHR9XG5cdFx0XHRcdHJldHVybiAxIC8gMiAqICgtTWF0aC5wb3coMiwgLTEwICogLS10KSArIDIpO1xuXHRcdFx0fSxcblx0XHRcdGVhc2VJbkNpcmM6IGZ1bmN0aW9uICh0KSB7XG5cdFx0XHRcdGlmICh0ID49IDEpe1xuXHRcdFx0XHRcdHJldHVybiB0O1xuXHRcdFx0XHR9XG5cdFx0XHRcdHJldHVybiAtMSAqIChNYXRoLnNxcnQoMSAtICh0IC89IDEpICogdCkgLSAxKTtcblx0XHRcdH0sXG5cdFx0XHRlYXNlT3V0Q2lyYzogZnVuY3Rpb24gKHQpIHtcblx0XHRcdFx0cmV0dXJuIDEgKiBNYXRoLnNxcnQoMSAtICh0ID0gdCAvIDEgLSAxKSAqIHQpO1xuXHRcdFx0fSxcblx0XHRcdGVhc2VJbk91dENpcmM6IGZ1bmN0aW9uICh0KSB7XG5cdFx0XHRcdGlmICgodCAvPSAxIC8gMikgPCAxKXtcblx0XHRcdFx0XHRyZXR1cm4gLTEgLyAyICogKE1hdGguc3FydCgxIC0gdCAqIHQpIC0gMSk7XG5cdFx0XHRcdH1cblx0XHRcdFx0cmV0dXJuIDEgLyAyICogKE1hdGguc3FydCgxIC0gKHQgLT0gMikgKiB0KSArIDEpO1xuXHRcdFx0fSxcblx0XHRcdGVhc2VJbkVsYXN0aWM6IGZ1bmN0aW9uICh0KSB7XG5cdFx0XHRcdHZhciBzID0gMS43MDE1ODtcblx0XHRcdFx0dmFyIHAgPSAwO1xuXHRcdFx0XHR2YXIgYSA9IDE7XG5cdFx0XHRcdGlmICh0ID09PSAwKXtcblx0XHRcdFx0XHRyZXR1cm4gMDtcblx0XHRcdFx0fVxuXHRcdFx0XHRpZiAoKHQgLz0gMSkgPT0gMSl7XG5cdFx0XHRcdFx0cmV0dXJuIDE7XG5cdFx0XHRcdH1cblx0XHRcdFx0aWYgKCFwKXtcblx0XHRcdFx0XHRwID0gMSAqIDAuMztcblx0XHRcdFx0fVxuXHRcdFx0XHRpZiAoYSA8IE1hdGguYWJzKDEpKSB7XG5cdFx0XHRcdFx0YSA9IDE7XG5cdFx0XHRcdFx0cyA9IHAgLyA0O1xuXHRcdFx0XHR9IGVsc2V7XG5cdFx0XHRcdFx0cyA9IHAgLyAoMiAqIE1hdGguUEkpICogTWF0aC5hc2luKDEgLyBhKTtcblx0XHRcdFx0fVxuXHRcdFx0XHRyZXR1cm4gLShhICogTWF0aC5wb3coMiwgMTAgKiAodCAtPSAxKSkgKiBNYXRoLnNpbigodCAqIDEgLSBzKSAqICgyICogTWF0aC5QSSkgLyBwKSk7XG5cdFx0XHR9LFxuXHRcdFx0ZWFzZU91dEVsYXN0aWM6IGZ1bmN0aW9uICh0KSB7XG5cdFx0XHRcdHZhciBzID0gMS43MDE1ODtcblx0XHRcdFx0dmFyIHAgPSAwO1xuXHRcdFx0XHR2YXIgYSA9IDE7XG5cdFx0XHRcdGlmICh0ID09PSAwKXtcblx0XHRcdFx0XHRyZXR1cm4gMDtcblx0XHRcdFx0fVxuXHRcdFx0XHRpZiAoKHQgLz0gMSkgPT0gMSl7XG5cdFx0XHRcdFx0cmV0dXJuIDE7XG5cdFx0XHRcdH1cblx0XHRcdFx0aWYgKCFwKXtcblx0XHRcdFx0XHRwID0gMSAqIDAuMztcblx0XHRcdFx0fVxuXHRcdFx0XHRpZiAoYSA8IE1hdGguYWJzKDEpKSB7XG5cdFx0XHRcdFx0YSA9IDE7XG5cdFx0XHRcdFx0cyA9IHAgLyA0O1xuXHRcdFx0XHR9IGVsc2V7XG5cdFx0XHRcdFx0cyA9IHAgLyAoMiAqIE1hdGguUEkpICogTWF0aC5hc2luKDEgLyBhKTtcblx0XHRcdFx0fVxuXHRcdFx0XHRyZXR1cm4gYSAqIE1hdGgucG93KDIsIC0xMCAqIHQpICogTWF0aC5zaW4oKHQgKiAxIC0gcykgKiAoMiAqIE1hdGguUEkpIC8gcCkgKyAxO1xuXHRcdFx0fSxcblx0XHRcdGVhc2VJbk91dEVsYXN0aWM6IGZ1bmN0aW9uICh0KSB7XG5cdFx0XHRcdHZhciBzID0gMS43MDE1ODtcblx0XHRcdFx0dmFyIHAgPSAwO1xuXHRcdFx0XHR2YXIgYSA9IDE7XG5cdFx0XHRcdGlmICh0ID09PSAwKXtcblx0XHRcdFx0XHRyZXR1cm4gMDtcblx0XHRcdFx0fVxuXHRcdFx0XHRpZiAoKHQgLz0gMSAvIDIpID09IDIpe1xuXHRcdFx0XHRcdHJldHVybiAxO1xuXHRcdFx0XHR9XG5cdFx0XHRcdGlmICghcCl7XG5cdFx0XHRcdFx0cCA9IDEgKiAoMC4zICogMS41KTtcblx0XHRcdFx0fVxuXHRcdFx0XHRpZiAoYSA8IE1hdGguYWJzKDEpKSB7XG5cdFx0XHRcdFx0YSA9IDE7XG5cdFx0XHRcdFx0cyA9IHAgLyA0O1xuXHRcdFx0XHR9IGVsc2Uge1xuXHRcdFx0XHRcdHMgPSBwIC8gKDIgKiBNYXRoLlBJKSAqIE1hdGguYXNpbigxIC8gYSk7XG5cdFx0XHRcdH1cblx0XHRcdFx0aWYgKHQgPCAxKXtcblx0XHRcdFx0XHRyZXR1cm4gLTAuNSAqIChhICogTWF0aC5wb3coMiwgMTAgKiAodCAtPSAxKSkgKiBNYXRoLnNpbigodCAqIDEgLSBzKSAqICgyICogTWF0aC5QSSkgLyBwKSk7fVxuXHRcdFx0XHRyZXR1cm4gYSAqIE1hdGgucG93KDIsIC0xMCAqICh0IC09IDEpKSAqIE1hdGguc2luKCh0ICogMSAtIHMpICogKDIgKiBNYXRoLlBJKSAvIHApICogMC41ICsgMTtcblx0XHRcdH0sXG5cdFx0XHRlYXNlSW5CYWNrOiBmdW5jdGlvbiAodCkge1xuXHRcdFx0XHR2YXIgcyA9IDEuNzAxNTg7XG5cdFx0XHRcdHJldHVybiAxICogKHQgLz0gMSkgKiB0ICogKChzICsgMSkgKiB0IC0gcyk7XG5cdFx0XHR9LFxuXHRcdFx0ZWFzZU91dEJhY2s6IGZ1bmN0aW9uICh0KSB7XG5cdFx0XHRcdHZhciBzID0gMS43MDE1ODtcblx0XHRcdFx0cmV0dXJuIDEgKiAoKHQgPSB0IC8gMSAtIDEpICogdCAqICgocyArIDEpICogdCArIHMpICsgMSk7XG5cdFx0XHR9LFxuXHRcdFx0ZWFzZUluT3V0QmFjazogZnVuY3Rpb24gKHQpIHtcblx0XHRcdFx0dmFyIHMgPSAxLjcwMTU4O1xuXHRcdFx0XHRpZiAoKHQgLz0gMSAvIDIpIDwgMSl7XG5cdFx0XHRcdFx0cmV0dXJuIDEgLyAyICogKHQgKiB0ICogKCgocyAqPSAoMS41MjUpKSArIDEpICogdCAtIHMpKTtcblx0XHRcdFx0fVxuXHRcdFx0XHRyZXR1cm4gMSAvIDIgKiAoKHQgLT0gMikgKiB0ICogKCgocyAqPSAoMS41MjUpKSArIDEpICogdCArIHMpICsgMik7XG5cdFx0XHR9LFxuXHRcdFx0ZWFzZUluQm91bmNlOiBmdW5jdGlvbiAodCkge1xuXHRcdFx0XHRyZXR1cm4gMSAtIGVhc2luZ0VmZmVjdHMuZWFzZU91dEJvdW5jZSgxIC0gdCk7XG5cdFx0XHR9LFxuXHRcdFx0ZWFzZU91dEJvdW5jZTogZnVuY3Rpb24gKHQpIHtcblx0XHRcdFx0aWYgKCh0IC89IDEpIDwgKDEgLyAyLjc1KSkge1xuXHRcdFx0XHRcdHJldHVybiAxICogKDcuNTYyNSAqIHQgKiB0KTtcblx0XHRcdFx0fSBlbHNlIGlmICh0IDwgKDIgLyAyLjc1KSkge1xuXHRcdFx0XHRcdHJldHVybiAxICogKDcuNTYyNSAqICh0IC09ICgxLjUgLyAyLjc1KSkgKiB0ICsgMC43NSk7XG5cdFx0XHRcdH0gZWxzZSBpZiAodCA8ICgyLjUgLyAyLjc1KSkge1xuXHRcdFx0XHRcdHJldHVybiAxICogKDcuNTYyNSAqICh0IC09ICgyLjI1IC8gMi43NSkpICogdCArIDAuOTM3NSk7XG5cdFx0XHRcdH0gZWxzZSB7XG5cdFx0XHRcdFx0cmV0dXJuIDEgKiAoNy41NjI1ICogKHQgLT0gKDIuNjI1IC8gMi43NSkpICogdCArIDAuOTg0Mzc1KTtcblx0XHRcdFx0fVxuXHRcdFx0fSxcblx0XHRcdGVhc2VJbk91dEJvdW5jZTogZnVuY3Rpb24gKHQpIHtcblx0XHRcdFx0aWYgKHQgPCAxIC8gMil7XG5cdFx0XHRcdFx0cmV0dXJuIGVhc2luZ0VmZmVjdHMuZWFzZUluQm91bmNlKHQgKiAyKSAqIDAuNTtcblx0XHRcdFx0fVxuXHRcdFx0XHRyZXR1cm4gZWFzaW5nRWZmZWN0cy5lYXNlT3V0Qm91bmNlKHQgKiAyIC0gMSkgKiAwLjUgKyAxICogMC41O1xuXHRcdFx0fVxuXHRcdH0sXG5cdFx0Ly9SZXF1ZXN0IGFuaW1hdGlvbiBwb2x5ZmlsbCAtIGh0dHA6Ly93d3cucGF1bGlyaXNoLmNvbS8yMDExL3JlcXVlc3RhbmltYXRpb25mcmFtZS1mb3Itc21hcnQtYW5pbWF0aW5nL1xuXHRcdHJlcXVlc3RBbmltRnJhbWUgPSBoZWxwZXJzLnJlcXVlc3RBbmltRnJhbWUgPSAoZnVuY3Rpb24oKXtcblx0XHRcdHJldHVybiB3aW5kb3cucmVxdWVzdEFuaW1hdGlvbkZyYW1lIHx8XG5cdFx0XHRcdHdpbmRvdy53ZWJraXRSZXF1ZXN0QW5pbWF0aW9uRnJhbWUgfHxcblx0XHRcdFx0d2luZG93Lm1velJlcXVlc3RBbmltYXRpb25GcmFtZSB8fFxuXHRcdFx0XHR3aW5kb3cub1JlcXVlc3RBbmltYXRpb25GcmFtZSB8fFxuXHRcdFx0XHR3aW5kb3cubXNSZXF1ZXN0QW5pbWF0aW9uRnJhbWUgfHxcblx0XHRcdFx0ZnVuY3Rpb24oY2FsbGJhY2spIHtcblx0XHRcdFx0XHRyZXR1cm4gd2luZG93LnNldFRpbWVvdXQoY2FsbGJhY2ssIDEwMDAgLyA2MCk7XG5cdFx0XHRcdH07XG5cdFx0fSkoKSxcblx0XHRjYW5jZWxBbmltRnJhbWUgPSBoZWxwZXJzLmNhbmNlbEFuaW1GcmFtZSA9IChmdW5jdGlvbigpe1xuXHRcdFx0cmV0dXJuIHdpbmRvdy5jYW5jZWxBbmltYXRpb25GcmFtZSB8fFxuXHRcdFx0XHR3aW5kb3cud2Via2l0Q2FuY2VsQW5pbWF0aW9uRnJhbWUgfHxcblx0XHRcdFx0d2luZG93Lm1vekNhbmNlbEFuaW1hdGlvbkZyYW1lIHx8XG5cdFx0XHRcdHdpbmRvdy5vQ2FuY2VsQW5pbWF0aW9uRnJhbWUgfHxcblx0XHRcdFx0d2luZG93Lm1zQ2FuY2VsQW5pbWF0aW9uRnJhbWUgfHxcblx0XHRcdFx0ZnVuY3Rpb24oY2FsbGJhY2spIHtcblx0XHRcdFx0XHRyZXR1cm4gd2luZG93LmNsZWFyVGltZW91dChjYWxsYmFjaywgMTAwMCAvIDYwKTtcblx0XHRcdFx0fTtcblx0XHR9KSgpLFxuXHRcdGFuaW1hdGlvbkxvb3AgPSBoZWxwZXJzLmFuaW1hdGlvbkxvb3AgPSBmdW5jdGlvbihjYWxsYmFjayx0b3RhbFN0ZXBzLGVhc2luZ1N0cmluZyxvblByb2dyZXNzLG9uQ29tcGxldGUsY2hhcnRJbnN0YW5jZSl7XG5cblx0XHRcdHZhciBjdXJyZW50U3RlcCA9IDAsXG5cdFx0XHRcdGVhc2luZ0Z1bmN0aW9uID0gZWFzaW5nRWZmZWN0c1tlYXNpbmdTdHJpbmddIHx8IGVhc2luZ0VmZmVjdHMubGluZWFyO1xuXG5cdFx0XHR2YXIgYW5pbWF0aW9uRnJhbWUgPSBmdW5jdGlvbigpe1xuXHRcdFx0XHRjdXJyZW50U3RlcCsrO1xuXHRcdFx0XHR2YXIgc3RlcERlY2ltYWwgPSBjdXJyZW50U3RlcC90b3RhbFN0ZXBzO1xuXHRcdFx0XHR2YXIgZWFzZURlY2ltYWwgPSBlYXNpbmdGdW5jdGlvbihzdGVwRGVjaW1hbCk7XG5cblx0XHRcdFx0Y2FsbGJhY2suY2FsbChjaGFydEluc3RhbmNlLGVhc2VEZWNpbWFsLHN0ZXBEZWNpbWFsLCBjdXJyZW50U3RlcCk7XG5cdFx0XHRcdG9uUHJvZ3Jlc3MuY2FsbChjaGFydEluc3RhbmNlLGVhc2VEZWNpbWFsLHN0ZXBEZWNpbWFsKTtcblx0XHRcdFx0aWYgKGN1cnJlbnRTdGVwIDwgdG90YWxTdGVwcyl7XG5cdFx0XHRcdFx0Y2hhcnRJbnN0YW5jZS5hbmltYXRpb25GcmFtZSA9IHJlcXVlc3RBbmltRnJhbWUoYW5pbWF0aW9uRnJhbWUpO1xuXHRcdFx0XHR9IGVsc2V7XG5cdFx0XHRcdFx0b25Db21wbGV0ZS5hcHBseShjaGFydEluc3RhbmNlKTtcblx0XHRcdFx0fVxuXHRcdFx0fTtcblx0XHRcdHJlcXVlc3RBbmltRnJhbWUoYW5pbWF0aW9uRnJhbWUpO1xuXHRcdH0sXG5cdFx0Ly8tLSBET00gbWV0aG9kc1xuXHRcdGdldFJlbGF0aXZlUG9zaXRpb24gPSBoZWxwZXJzLmdldFJlbGF0aXZlUG9zaXRpb24gPSBmdW5jdGlvbihldnQpe1xuXHRcdFx0dmFyIG1vdXNlWCwgbW91c2VZO1xuXHRcdFx0dmFyIGUgPSBldnQub3JpZ2luYWxFdmVudCB8fCBldnQsXG5cdFx0XHRcdGNhbnZhcyA9IGV2dC5jdXJyZW50VGFyZ2V0IHx8IGV2dC5zcmNFbGVtZW50LFxuXHRcdFx0XHRib3VuZGluZ1JlY3QgPSBjYW52YXMuZ2V0Qm91bmRpbmdDbGllbnRSZWN0KCk7XG5cblx0XHRcdGlmIChlLnRvdWNoZXMpe1xuXHRcdFx0XHRtb3VzZVggPSBlLnRvdWNoZXNbMF0uY2xpZW50WCAtIGJvdW5kaW5nUmVjdC5sZWZ0O1xuXHRcdFx0XHRtb3VzZVkgPSBlLnRvdWNoZXNbMF0uY2xpZW50WSAtIGJvdW5kaW5nUmVjdC50b3A7XG5cblx0XHRcdH1cblx0XHRcdGVsc2V7XG5cdFx0XHRcdG1vdXNlWCA9IGUuY2xpZW50WCAtIGJvdW5kaW5nUmVjdC5sZWZ0O1xuXHRcdFx0XHRtb3VzZVkgPSBlLmNsaWVudFkgLSBib3VuZGluZ1JlY3QudG9wO1xuXHRcdFx0fVxuXG5cdFx0XHRyZXR1cm4ge1xuXHRcdFx0XHR4IDogbW91c2VYLFxuXHRcdFx0XHR5IDogbW91c2VZXG5cdFx0XHR9O1xuXG5cdFx0fSxcblx0XHRhZGRFdmVudCA9IGhlbHBlcnMuYWRkRXZlbnQgPSBmdW5jdGlvbihub2RlLGV2ZW50VHlwZSxtZXRob2Qpe1xuXHRcdFx0aWYgKG5vZGUuYWRkRXZlbnRMaXN0ZW5lcil7XG5cdFx0XHRcdG5vZGUuYWRkRXZlbnRMaXN0ZW5lcihldmVudFR5cGUsbWV0aG9kKTtcblx0XHRcdH0gZWxzZSBpZiAobm9kZS5hdHRhY2hFdmVudCl7XG5cdFx0XHRcdG5vZGUuYXR0YWNoRXZlbnQoXCJvblwiK2V2ZW50VHlwZSwgbWV0aG9kKTtcblx0XHRcdH0gZWxzZSB7XG5cdFx0XHRcdG5vZGVbXCJvblwiK2V2ZW50VHlwZV0gPSBtZXRob2Q7XG5cdFx0XHR9XG5cdFx0fSxcblx0XHRyZW1vdmVFdmVudCA9IGhlbHBlcnMucmVtb3ZlRXZlbnQgPSBmdW5jdGlvbihub2RlLCBldmVudFR5cGUsIGhhbmRsZXIpe1xuXHRcdFx0aWYgKG5vZGUucmVtb3ZlRXZlbnRMaXN0ZW5lcil7XG5cdFx0XHRcdG5vZGUucmVtb3ZlRXZlbnRMaXN0ZW5lcihldmVudFR5cGUsIGhhbmRsZXIsIGZhbHNlKTtcblx0XHRcdH0gZWxzZSBpZiAobm9kZS5kZXRhY2hFdmVudCl7XG5cdFx0XHRcdG5vZGUuZGV0YWNoRXZlbnQoXCJvblwiK2V2ZW50VHlwZSxoYW5kbGVyKTtcblx0XHRcdH0gZWxzZXtcblx0XHRcdFx0bm9kZVtcIm9uXCIgKyBldmVudFR5cGVdID0gbm9vcDtcblx0XHRcdH1cblx0XHR9LFxuXHRcdGJpbmRFdmVudHMgPSBoZWxwZXJzLmJpbmRFdmVudHMgPSBmdW5jdGlvbihjaGFydEluc3RhbmNlLCBhcnJheU9mRXZlbnRzLCBoYW5kbGVyKXtcblx0XHRcdC8vIENyZWF0ZSB0aGUgZXZlbnRzIG9iamVjdCBpZiBpdCdzIG5vdCBhbHJlYWR5IHByZXNlbnRcblx0XHRcdGlmICghY2hhcnRJbnN0YW5jZS5ldmVudHMpIGNoYXJ0SW5zdGFuY2UuZXZlbnRzID0ge307XG5cblx0XHRcdGVhY2goYXJyYXlPZkV2ZW50cyxmdW5jdGlvbihldmVudE5hbWUpe1xuXHRcdFx0XHRjaGFydEluc3RhbmNlLmV2ZW50c1tldmVudE5hbWVdID0gZnVuY3Rpb24oKXtcblx0XHRcdFx0XHRoYW5kbGVyLmFwcGx5KGNoYXJ0SW5zdGFuY2UsIGFyZ3VtZW50cyk7XG5cdFx0XHRcdH07XG5cdFx0XHRcdGFkZEV2ZW50KGNoYXJ0SW5zdGFuY2UuY2hhcnQuY2FudmFzLGV2ZW50TmFtZSxjaGFydEluc3RhbmNlLmV2ZW50c1tldmVudE5hbWVdKTtcblx0XHRcdH0pO1xuXHRcdH0sXG5cdFx0dW5iaW5kRXZlbnRzID0gaGVscGVycy51bmJpbmRFdmVudHMgPSBmdW5jdGlvbiAoY2hhcnRJbnN0YW5jZSwgYXJyYXlPZkV2ZW50cykge1xuXHRcdFx0ZWFjaChhcnJheU9mRXZlbnRzLCBmdW5jdGlvbihoYW5kbGVyLGV2ZW50TmFtZSl7XG5cdFx0XHRcdHJlbW92ZUV2ZW50KGNoYXJ0SW5zdGFuY2UuY2hhcnQuY2FudmFzLCBldmVudE5hbWUsIGhhbmRsZXIpO1xuXHRcdFx0fSk7XG5cdFx0fSxcblx0XHRnZXRNYXhpbXVtV2lkdGggPSBoZWxwZXJzLmdldE1heGltdW1XaWR0aCA9IGZ1bmN0aW9uKGRvbU5vZGUpe1xuXHRcdFx0dmFyIGNvbnRhaW5lciA9IGRvbU5vZGUucGFyZW50Tm9kZSxcblx0XHRcdCAgICBwYWRkaW5nID0gcGFyc2VJbnQoZ2V0U3R5bGUoY29udGFpbmVyLCAncGFkZGluZy1sZWZ0JykpICsgcGFyc2VJbnQoZ2V0U3R5bGUoY29udGFpbmVyLCAncGFkZGluZy1yaWdodCcpKTtcblx0XHRcdC8vIFRPRE8gPSBjaGVjayBjcm9zcyBicm93c2VyIHN0dWZmIHdpdGggdGhpcy5cblx0XHRcdHJldHVybiBjb250YWluZXIgPyBjb250YWluZXIuY2xpZW50V2lkdGggLSBwYWRkaW5nIDogMDtcblx0XHR9LFxuXHRcdGdldE1heGltdW1IZWlnaHQgPSBoZWxwZXJzLmdldE1heGltdW1IZWlnaHQgPSBmdW5jdGlvbihkb21Ob2RlKXtcblx0XHRcdHZhciBjb250YWluZXIgPSBkb21Ob2RlLnBhcmVudE5vZGUsXG5cdFx0XHQgICAgcGFkZGluZyA9IHBhcnNlSW50KGdldFN0eWxlKGNvbnRhaW5lciwgJ3BhZGRpbmctYm90dG9tJykpICsgcGFyc2VJbnQoZ2V0U3R5bGUoY29udGFpbmVyLCAncGFkZGluZy10b3AnKSk7XG5cdFx0XHQvLyBUT0RPID0gY2hlY2sgY3Jvc3MgYnJvd3NlciBzdHVmZiB3aXRoIHRoaXMuXG5cdFx0XHRyZXR1cm4gY29udGFpbmVyID8gY29udGFpbmVyLmNsaWVudEhlaWdodCAtIHBhZGRpbmcgOiAwO1xuXHRcdH0sXG5cdFx0Z2V0U3R5bGUgPSBoZWxwZXJzLmdldFN0eWxlID0gZnVuY3Rpb24gKGVsLCBwcm9wZXJ0eSkge1xuXHRcdFx0cmV0dXJuIGVsLmN1cnJlbnRTdHlsZSA/XG5cdFx0XHRcdGVsLmN1cnJlbnRTdHlsZVtwcm9wZXJ0eV0gOlxuXHRcdFx0XHRkb2N1bWVudC5kZWZhdWx0Vmlldy5nZXRDb21wdXRlZFN0eWxlKGVsLCBudWxsKS5nZXRQcm9wZXJ0eVZhbHVlKHByb3BlcnR5KTtcblx0XHR9LFxuXHRcdGdldE1heGltdW1TaXplID0gaGVscGVycy5nZXRNYXhpbXVtU2l6ZSA9IGhlbHBlcnMuZ2V0TWF4aW11bVdpZHRoLCAvLyBsZWdhY3kgc3VwcG9ydFxuXHRcdHJldGluYVNjYWxlID0gaGVscGVycy5yZXRpbmFTY2FsZSA9IGZ1bmN0aW9uKGNoYXJ0KXtcblx0XHRcdHZhciBjdHggPSBjaGFydC5jdHgsXG5cdFx0XHRcdHdpZHRoID0gY2hhcnQuY2FudmFzLndpZHRoLFxuXHRcdFx0XHRoZWlnaHQgPSBjaGFydC5jYW52YXMuaGVpZ2h0O1xuXG5cdFx0XHRpZiAod2luZG93LmRldmljZVBpeGVsUmF0aW8pIHtcblx0XHRcdFx0Y3R4LmNhbnZhcy5zdHlsZS53aWR0aCA9IHdpZHRoICsgXCJweFwiO1xuXHRcdFx0XHRjdHguY2FudmFzLnN0eWxlLmhlaWdodCA9IGhlaWdodCArIFwicHhcIjtcblx0XHRcdFx0Y3R4LmNhbnZhcy5oZWlnaHQgPSBoZWlnaHQgKiB3aW5kb3cuZGV2aWNlUGl4ZWxSYXRpbztcblx0XHRcdFx0Y3R4LmNhbnZhcy53aWR0aCA9IHdpZHRoICogd2luZG93LmRldmljZVBpeGVsUmF0aW87XG5cdFx0XHRcdGN0eC5zY2FsZSh3aW5kb3cuZGV2aWNlUGl4ZWxSYXRpbywgd2luZG93LmRldmljZVBpeGVsUmF0aW8pO1xuXHRcdFx0fVxuXHRcdH0sXG5cdFx0Ly8tLSBDYW52YXMgbWV0aG9kc1xuXHRcdGNsZWFyID0gaGVscGVycy5jbGVhciA9IGZ1bmN0aW9uKGNoYXJ0KXtcblx0XHRcdGNoYXJ0LmN0eC5jbGVhclJlY3QoMCwwLGNoYXJ0LndpZHRoLGNoYXJ0LmhlaWdodCk7XG5cdFx0fSxcblx0XHRmb250U3RyaW5nID0gaGVscGVycy5mb250U3RyaW5nID0gZnVuY3Rpb24ocGl4ZWxTaXplLGZvbnRTdHlsZSxmb250RmFtaWx5KXtcblx0XHRcdHJldHVybiBmb250U3R5bGUgKyBcIiBcIiArIHBpeGVsU2l6ZStcInB4IFwiICsgZm9udEZhbWlseTtcblx0XHR9LFxuXHRcdGxvbmdlc3RUZXh0ID0gaGVscGVycy5sb25nZXN0VGV4dCA9IGZ1bmN0aW9uKGN0eCxmb250LGFycmF5T2ZTdHJpbmdzKXtcblx0XHRcdGN0eC5mb250ID0gZm9udDtcblx0XHRcdHZhciBsb25nZXN0ID0gMDtcblx0XHRcdGVhY2goYXJyYXlPZlN0cmluZ3MsZnVuY3Rpb24oc3RyaW5nKXtcblx0XHRcdFx0dmFyIHRleHRXaWR0aCA9IGN0eC5tZWFzdXJlVGV4dChzdHJpbmcpLndpZHRoO1xuXHRcdFx0XHRsb25nZXN0ID0gKHRleHRXaWR0aCA+IGxvbmdlc3QpID8gdGV4dFdpZHRoIDogbG9uZ2VzdDtcblx0XHRcdH0pO1xuXHRcdFx0cmV0dXJuIGxvbmdlc3Q7XG5cdFx0fSxcblx0XHRkcmF3Um91bmRlZFJlY3RhbmdsZSA9IGhlbHBlcnMuZHJhd1JvdW5kZWRSZWN0YW5nbGUgPSBmdW5jdGlvbihjdHgseCx5LHdpZHRoLGhlaWdodCxyYWRpdXMpe1xuXHRcdFx0Y3R4LmJlZ2luUGF0aCgpO1xuXHRcdFx0Y3R4Lm1vdmVUbyh4ICsgcmFkaXVzLCB5KTtcblx0XHRcdGN0eC5saW5lVG8oeCArIHdpZHRoIC0gcmFkaXVzLCB5KTtcblx0XHRcdGN0eC5xdWFkcmF0aWNDdXJ2ZVRvKHggKyB3aWR0aCwgeSwgeCArIHdpZHRoLCB5ICsgcmFkaXVzKTtcblx0XHRcdGN0eC5saW5lVG8oeCArIHdpZHRoLCB5ICsgaGVpZ2h0IC0gcmFkaXVzKTtcblx0XHRcdGN0eC5xdWFkcmF0aWNDdXJ2ZVRvKHggKyB3aWR0aCwgeSArIGhlaWdodCwgeCArIHdpZHRoIC0gcmFkaXVzLCB5ICsgaGVpZ2h0KTtcblx0XHRcdGN0eC5saW5lVG8oeCArIHJhZGl1cywgeSArIGhlaWdodCk7XG5cdFx0XHRjdHgucXVhZHJhdGljQ3VydmVUbyh4LCB5ICsgaGVpZ2h0LCB4LCB5ICsgaGVpZ2h0IC0gcmFkaXVzKTtcblx0XHRcdGN0eC5saW5lVG8oeCwgeSArIHJhZGl1cyk7XG5cdFx0XHRjdHgucXVhZHJhdGljQ3VydmVUbyh4LCB5LCB4ICsgcmFkaXVzLCB5KTtcblx0XHRcdGN0eC5jbG9zZVBhdGgoKTtcblx0XHR9O1xuXG5cblx0Ly9TdG9yZSBhIHJlZmVyZW5jZSB0byBlYWNoIGluc3RhbmNlIC0gYWxsb3dpbmcgdXMgdG8gZ2xvYmFsbHkgcmVzaXplIGNoYXJ0IGluc3RhbmNlcyBvbiB3aW5kb3cgcmVzaXplLlxuXHQvL0Rlc3Ryb3kgbWV0aG9kIG9uIHRoZSBjaGFydCB3aWxsIHJlbW92ZSB0aGUgaW5zdGFuY2Ugb2YgdGhlIGNoYXJ0IGZyb20gdGhpcyByZWZlcmVuY2UuXG5cdENoYXJ0Lmluc3RhbmNlcyA9IHt9O1xuXG5cdENoYXJ0LlR5cGUgPSBmdW5jdGlvbihkYXRhLG9wdGlvbnMsY2hhcnQpe1xuXHRcdHRoaXMub3B0aW9ucyA9IG9wdGlvbnM7XG5cdFx0dGhpcy5jaGFydCA9IGNoYXJ0O1xuXHRcdHRoaXMuaWQgPSB1aWQoKTtcblx0XHQvL0FkZCB0aGUgY2hhcnQgaW5zdGFuY2UgdG8gdGhlIGdsb2JhbCBuYW1lc3BhY2Vcblx0XHRDaGFydC5pbnN0YW5jZXNbdGhpcy5pZF0gPSB0aGlzO1xuXG5cdFx0Ly8gSW5pdGlhbGl6ZSBpcyBhbHdheXMgY2FsbGVkIHdoZW4gYSBjaGFydCB0eXBlIGlzIGNyZWF0ZWRcblx0XHQvLyBCeSBkZWZhdWx0IGl0IGlzIGEgbm8gb3AsIGJ1dCBpdCBzaG91bGQgYmUgZXh0ZW5kZWRcblx0XHRpZiAob3B0aW9ucy5yZXNwb25zaXZlKXtcblx0XHRcdHRoaXMucmVzaXplKCk7XG5cdFx0fVxuXHRcdHRoaXMuaW5pdGlhbGl6ZS5jYWxsKHRoaXMsZGF0YSk7XG5cdH07XG5cblx0Ly9Db3JlIG1ldGhvZHMgdGhhdCdsbCBiZSBhIHBhcnQgb2YgZXZlcnkgY2hhcnQgdHlwZVxuXHRleHRlbmQoQ2hhcnQuVHlwZS5wcm90b3R5cGUse1xuXHRcdGluaXRpYWxpemUgOiBmdW5jdGlvbigpe3JldHVybiB0aGlzO30sXG5cdFx0Y2xlYXIgOiBmdW5jdGlvbigpe1xuXHRcdFx0Y2xlYXIodGhpcy5jaGFydCk7XG5cdFx0XHRyZXR1cm4gdGhpcztcblx0XHR9LFxuXHRcdHN0b3AgOiBmdW5jdGlvbigpe1xuXHRcdFx0Ly8gU3RvcHMgYW55IGN1cnJlbnQgYW5pbWF0aW9uIGxvb3Agb2NjdXJpbmdcblx0XHRcdENoYXJ0LmFuaW1hdGlvblNlcnZpY2UuY2FuY2VsQW5pbWF0aW9uKHRoaXMpO1xuXHRcdFx0cmV0dXJuIHRoaXM7XG5cdFx0fSxcblx0XHRyZXNpemUgOiBmdW5jdGlvbihjYWxsYmFjayl7XG5cdFx0XHR0aGlzLnN0b3AoKTtcblx0XHRcdHZhciBjYW52YXMgPSB0aGlzLmNoYXJ0LmNhbnZhcyxcblx0XHRcdFx0bmV3V2lkdGggPSBnZXRNYXhpbXVtV2lkdGgodGhpcy5jaGFydC5jYW52YXMpLFxuXHRcdFx0XHRuZXdIZWlnaHQgPSB0aGlzLm9wdGlvbnMubWFpbnRhaW5Bc3BlY3RSYXRpbyA/IG5ld1dpZHRoIC8gdGhpcy5jaGFydC5hc3BlY3RSYXRpbyA6IGdldE1heGltdW1IZWlnaHQodGhpcy5jaGFydC5jYW52YXMpO1xuXG5cdFx0XHRjYW52YXMud2lkdGggPSB0aGlzLmNoYXJ0LndpZHRoID0gbmV3V2lkdGg7XG5cdFx0XHRjYW52YXMuaGVpZ2h0ID0gdGhpcy5jaGFydC5oZWlnaHQgPSBuZXdIZWlnaHQ7XG5cblx0XHRcdHJldGluYVNjYWxlKHRoaXMuY2hhcnQpO1xuXG5cdFx0XHRpZiAodHlwZW9mIGNhbGxiYWNrID09PSBcImZ1bmN0aW9uXCIpe1xuXHRcdFx0XHRjYWxsYmFjay5hcHBseSh0aGlzLCBBcnJheS5wcm90b3R5cGUuc2xpY2UuY2FsbChhcmd1bWVudHMsIDEpKTtcblx0XHRcdH1cblx0XHRcdHJldHVybiB0aGlzO1xuXHRcdH0sXG5cdFx0cmVmbG93IDogbm9vcCxcblx0XHRyZW5kZXIgOiBmdW5jdGlvbihyZWZsb3cpe1xuXHRcdFx0aWYgKHJlZmxvdyl7XG5cdFx0XHRcdHRoaXMucmVmbG93KCk7XG5cdFx0XHR9XG5cdFx0XHRcblx0XHRcdGlmICh0aGlzLm9wdGlvbnMuYW5pbWF0aW9uICYmICFyZWZsb3cpe1xuXHRcdFx0XHR2YXIgYW5pbWF0aW9uID0gbmV3IENoYXJ0LkFuaW1hdGlvbigpO1xuXHRcdFx0XHRhbmltYXRpb24ubnVtU3RlcHMgPSB0aGlzLm9wdGlvbnMuYW5pbWF0aW9uU3RlcHM7XG5cdFx0XHRcdGFuaW1hdGlvbi5lYXNpbmcgPSB0aGlzLm9wdGlvbnMuYW5pbWF0aW9uRWFzaW5nO1xuXHRcdFx0XHRcblx0XHRcdFx0Ly8gcmVuZGVyIGZ1bmN0aW9uXG5cdFx0XHRcdGFuaW1hdGlvbi5yZW5kZXIgPSBmdW5jdGlvbihjaGFydEluc3RhbmNlLCBhbmltYXRpb25PYmplY3QpIHtcblx0XHRcdFx0XHR2YXIgZWFzaW5nRnVuY3Rpb24gPSBoZWxwZXJzLmVhc2luZ0VmZmVjdHNbYW5pbWF0aW9uT2JqZWN0LmVhc2luZ107XG5cdFx0XHRcdFx0dmFyIHN0ZXBEZWNpbWFsID0gYW5pbWF0aW9uT2JqZWN0LmN1cnJlbnRTdGVwIC8gYW5pbWF0aW9uT2JqZWN0Lm51bVN0ZXBzO1xuXHRcdFx0XHRcdHZhciBlYXNlRGVjaW1hbCA9IGVhc2luZ0Z1bmN0aW9uKHN0ZXBEZWNpbWFsKTtcblx0XHRcdFx0XHRcblx0XHRcdFx0XHRjaGFydEluc3RhbmNlLmRyYXcoZWFzZURlY2ltYWwsIHN0ZXBEZWNpbWFsLCBhbmltYXRpb25PYmplY3QuY3VycmVudFN0ZXApO1xuXHRcdFx0XHR9O1xuXHRcdFx0XHRcblx0XHRcdFx0Ly8gdXNlciBldmVudHNcblx0XHRcdFx0YW5pbWF0aW9uLm9uQW5pbWF0aW9uUHJvZ3Jlc3MgPSB0aGlzLm9wdGlvbnMub25BbmltYXRpb25Qcm9ncmVzcztcblx0XHRcdFx0YW5pbWF0aW9uLm9uQW5pbWF0aW9uQ29tcGxldGUgPSB0aGlzLm9wdGlvbnMub25BbmltYXRpb25Db21wbGV0ZTtcblx0XHRcdFx0XG5cdFx0XHRcdENoYXJ0LmFuaW1hdGlvblNlcnZpY2UuYWRkQW5pbWF0aW9uKHRoaXMsIGFuaW1hdGlvbik7XG5cdFx0XHR9XG5cdFx0XHRlbHNle1xuXHRcdFx0XHR0aGlzLmRyYXcoKTtcblx0XHRcdFx0dGhpcy5vcHRpb25zLm9uQW5pbWF0aW9uQ29tcGxldGUuY2FsbCh0aGlzKTtcblx0XHRcdH1cblx0XHRcdHJldHVybiB0aGlzO1xuXHRcdH0sXG5cdFx0Z2VuZXJhdGVMZWdlbmQgOiBmdW5jdGlvbigpe1xuXHRcdFx0cmV0dXJuIGhlbHBlcnMudGVtcGxhdGUodGhpcy5vcHRpb25zLmxlZ2VuZFRlbXBsYXRlLCB0aGlzKTtcblx0XHR9LFxuXHRcdGRlc3Ryb3kgOiBmdW5jdGlvbigpe1xuXHRcdFx0dGhpcy5zdG9wKCk7XG5cdFx0XHR0aGlzLmNsZWFyKCk7XG5cdFx0XHR1bmJpbmRFdmVudHModGhpcywgdGhpcy5ldmVudHMpO1xuXHRcdFx0dmFyIGNhbnZhcyA9IHRoaXMuY2hhcnQuY2FudmFzO1xuXG5cdFx0XHQvLyBSZXNldCBjYW52YXMgaGVpZ2h0L3dpZHRoIGF0dHJpYnV0ZXMgc3RhcnRzIGEgZnJlc2ggd2l0aCB0aGUgY2FudmFzIGNvbnRleHRcblx0XHRcdGNhbnZhcy53aWR0aCA9IHRoaXMuY2hhcnQud2lkdGg7XG5cdFx0XHRjYW52YXMuaGVpZ2h0ID0gdGhpcy5jaGFydC5oZWlnaHQ7XG5cblx0XHRcdC8vIDwgSUU5IGRvZXNuJ3Qgc3VwcG9ydCByZW1vdmVQcm9wZXJ0eVxuXHRcdFx0aWYgKGNhbnZhcy5zdHlsZS5yZW1vdmVQcm9wZXJ0eSkge1xuXHRcdFx0XHRjYW52YXMuc3R5bGUucmVtb3ZlUHJvcGVydHkoJ3dpZHRoJyk7XG5cdFx0XHRcdGNhbnZhcy5zdHlsZS5yZW1vdmVQcm9wZXJ0eSgnaGVpZ2h0Jyk7XG5cdFx0XHR9IGVsc2Uge1xuXHRcdFx0XHRjYW52YXMuc3R5bGUucmVtb3ZlQXR0cmlidXRlKCd3aWR0aCcpO1xuXHRcdFx0XHRjYW52YXMuc3R5bGUucmVtb3ZlQXR0cmlidXRlKCdoZWlnaHQnKTtcblx0XHRcdH1cblxuXHRcdFx0ZGVsZXRlIENoYXJ0Lmluc3RhbmNlc1t0aGlzLmlkXTtcblx0XHR9LFxuXHRcdHNob3dUb29sdGlwIDogZnVuY3Rpb24oQ2hhcnRFbGVtZW50cywgZm9yY2VSZWRyYXcpe1xuXHRcdFx0Ly8gT25seSByZWRyYXcgdGhlIGNoYXJ0IGlmIHdlJ3ZlIGFjdHVhbGx5IGNoYW5nZWQgd2hhdCB3ZSdyZSBob3ZlcmluZyBvbi5cblx0XHRcdGlmICh0eXBlb2YgdGhpcy5hY3RpdmVFbGVtZW50cyA9PT0gJ3VuZGVmaW5lZCcpIHRoaXMuYWN0aXZlRWxlbWVudHMgPSBbXTtcblxuXHRcdFx0dmFyIGlzQ2hhbmdlZCA9IChmdW5jdGlvbihFbGVtZW50cyl7XG5cdFx0XHRcdHZhciBjaGFuZ2VkID0gZmFsc2U7XG5cblx0XHRcdFx0aWYgKEVsZW1lbnRzLmxlbmd0aCAhPT0gdGhpcy5hY3RpdmVFbGVtZW50cy5sZW5ndGgpe1xuXHRcdFx0XHRcdGNoYW5nZWQgPSB0cnVlO1xuXHRcdFx0XHRcdHJldHVybiBjaGFuZ2VkO1xuXHRcdFx0XHR9XG5cblx0XHRcdFx0ZWFjaChFbGVtZW50cywgZnVuY3Rpb24oZWxlbWVudCwgaW5kZXgpe1xuXHRcdFx0XHRcdGlmIChlbGVtZW50ICE9PSB0aGlzLmFjdGl2ZUVsZW1lbnRzW2luZGV4XSl7XG5cdFx0XHRcdFx0XHRjaGFuZ2VkID0gdHJ1ZTtcblx0XHRcdFx0XHR9XG5cdFx0XHRcdH0sIHRoaXMpO1xuXHRcdFx0XHRyZXR1cm4gY2hhbmdlZDtcblx0XHRcdH0pLmNhbGwodGhpcywgQ2hhcnRFbGVtZW50cyk7XG5cblx0XHRcdGlmICghaXNDaGFuZ2VkICYmICFmb3JjZVJlZHJhdyl7XG5cdFx0XHRcdHJldHVybjtcblx0XHRcdH1cblx0XHRcdGVsc2V7XG5cdFx0XHRcdHRoaXMuYWN0aXZlRWxlbWVudHMgPSBDaGFydEVsZW1lbnRzO1xuXHRcdFx0fVxuXHRcdFx0dGhpcy5kcmF3KCk7XG5cdFx0XHRpZih0aGlzLm9wdGlvbnMuY3VzdG9tVG9vbHRpcHMpe1xuXHRcdFx0XHR0aGlzLm9wdGlvbnMuY3VzdG9tVG9vbHRpcHMoZmFsc2UpO1xuXHRcdFx0fVxuXHRcdFx0aWYgKENoYXJ0RWxlbWVudHMubGVuZ3RoID4gMCl7XG5cdFx0XHRcdC8vIElmIHdlIGhhdmUgbXVsdGlwbGUgZGF0YXNldHMsIHNob3cgYSBNdWx0aVRvb2x0aXAgZm9yIGFsbCBvZiB0aGUgZGF0YSBwb2ludHMgYXQgdGhhdCBpbmRleFxuXHRcdFx0XHRpZiAodGhpcy5kYXRhc2V0cyAmJiB0aGlzLmRhdGFzZXRzLmxlbmd0aCA+IDEpIHtcblx0XHRcdFx0XHR2YXIgZGF0YUFycmF5LFxuXHRcdFx0XHRcdFx0ZGF0YUluZGV4O1xuXG5cdFx0XHRcdFx0Zm9yICh2YXIgaSA9IHRoaXMuZGF0YXNldHMubGVuZ3RoIC0gMTsgaSA+PSAwOyBpLS0pIHtcblx0XHRcdFx0XHRcdGRhdGFBcnJheSA9IHRoaXMuZGF0YXNldHNbaV0ucG9pbnRzIHx8IHRoaXMuZGF0YXNldHNbaV0uYmFycyB8fCB0aGlzLmRhdGFzZXRzW2ldLnNlZ21lbnRzO1xuXHRcdFx0XHRcdFx0ZGF0YUluZGV4ID0gaW5kZXhPZihkYXRhQXJyYXksIENoYXJ0RWxlbWVudHNbMF0pO1xuXHRcdFx0XHRcdFx0aWYgKGRhdGFJbmRleCAhPT0gLTEpe1xuXHRcdFx0XHRcdFx0XHRicmVhaztcblx0XHRcdFx0XHRcdH1cblx0XHRcdFx0XHR9XG5cdFx0XHRcdFx0dmFyIHRvb2x0aXBMYWJlbHMgPSBbXSxcblx0XHRcdFx0XHRcdHRvb2x0aXBDb2xvcnMgPSBbXSxcblx0XHRcdFx0XHRcdG1lZGlhblBvc2l0aW9uID0gKGZ1bmN0aW9uKGluZGV4KSB7XG5cblx0XHRcdFx0XHRcdFx0Ly8gR2V0IGFsbCB0aGUgcG9pbnRzIGF0IHRoYXQgcGFydGljdWxhciBpbmRleFxuXHRcdFx0XHRcdFx0XHR2YXIgRWxlbWVudHMgPSBbXSxcblx0XHRcdFx0XHRcdFx0XHRkYXRhQ29sbGVjdGlvbixcblx0XHRcdFx0XHRcdFx0XHR4UG9zaXRpb25zID0gW10sXG5cdFx0XHRcdFx0XHRcdFx0eVBvc2l0aW9ucyA9IFtdLFxuXHRcdFx0XHRcdFx0XHRcdHhNYXgsXG5cdFx0XHRcdFx0XHRcdFx0eU1heCxcblx0XHRcdFx0XHRcdFx0XHR4TWluLFxuXHRcdFx0XHRcdFx0XHRcdHlNaW47XG5cdFx0XHRcdFx0XHRcdGhlbHBlcnMuZWFjaCh0aGlzLmRhdGFzZXRzLCBmdW5jdGlvbihkYXRhc2V0KXtcblx0XHRcdFx0XHRcdFx0XHRkYXRhQ29sbGVjdGlvbiA9IGRhdGFzZXQucG9pbnRzIHx8IGRhdGFzZXQuYmFycyB8fCBkYXRhc2V0LnNlZ21lbnRzO1xuXHRcdFx0XHRcdFx0XHRcdGlmIChkYXRhQ29sbGVjdGlvbltkYXRhSW5kZXhdICYmIGRhdGFDb2xsZWN0aW9uW2RhdGFJbmRleF0uaGFzVmFsdWUoKSl7XG5cdFx0XHRcdFx0XHRcdFx0XHRFbGVtZW50cy5wdXNoKGRhdGFDb2xsZWN0aW9uW2RhdGFJbmRleF0pO1xuXHRcdFx0XHRcdFx0XHRcdH1cblx0XHRcdFx0XHRcdFx0fSk7XG5cblx0XHRcdFx0XHRcdFx0aGVscGVycy5lYWNoKEVsZW1lbnRzLCBmdW5jdGlvbihlbGVtZW50KSB7XG5cdFx0XHRcdFx0XHRcdFx0eFBvc2l0aW9ucy5wdXNoKGVsZW1lbnQueCk7XG5cdFx0XHRcdFx0XHRcdFx0eVBvc2l0aW9ucy5wdXNoKGVsZW1lbnQueSk7XG5cblxuXHRcdFx0XHRcdFx0XHRcdC8vSW5jbHVkZSBhbnkgY29sb3VyIGluZm9ybWF0aW9uIGFib3V0IHRoZSBlbGVtZW50XG5cdFx0XHRcdFx0XHRcdFx0dG9vbHRpcExhYmVscy5wdXNoKGhlbHBlcnMudGVtcGxhdGUodGhpcy5vcHRpb25zLm11bHRpVG9vbHRpcFRlbXBsYXRlLCBlbGVtZW50KSk7XG5cdFx0XHRcdFx0XHRcdFx0dG9vbHRpcENvbG9ycy5wdXNoKHtcblx0XHRcdFx0XHRcdFx0XHRcdGZpbGw6IGVsZW1lbnQuX3NhdmVkLmZpbGxDb2xvciB8fCBlbGVtZW50LmZpbGxDb2xvcixcblx0XHRcdFx0XHRcdFx0XHRcdHN0cm9rZTogZWxlbWVudC5fc2F2ZWQuc3Ryb2tlQ29sb3IgfHwgZWxlbWVudC5zdHJva2VDb2xvclxuXHRcdFx0XHRcdFx0XHRcdH0pO1xuXG5cdFx0XHRcdFx0XHRcdH0sIHRoaXMpO1xuXG5cdFx0XHRcdFx0XHRcdHlNaW4gPSBtaW4oeVBvc2l0aW9ucyk7XG5cdFx0XHRcdFx0XHRcdHlNYXggPSBtYXgoeVBvc2l0aW9ucyk7XG5cblx0XHRcdFx0XHRcdFx0eE1pbiA9IG1pbih4UG9zaXRpb25zKTtcblx0XHRcdFx0XHRcdFx0eE1heCA9IG1heCh4UG9zaXRpb25zKTtcblxuXHRcdFx0XHRcdFx0XHRyZXR1cm4ge1xuXHRcdFx0XHRcdFx0XHRcdHg6ICh4TWluID4gdGhpcy5jaGFydC53aWR0aC8yKSA/IHhNaW4gOiB4TWF4LFxuXHRcdFx0XHRcdFx0XHRcdHk6ICh5TWluICsgeU1heCkvMlxuXHRcdFx0XHRcdFx0XHR9O1xuXHRcdFx0XHRcdFx0fSkuY2FsbCh0aGlzLCBkYXRhSW5kZXgpO1xuXG5cdFx0XHRcdFx0bmV3IENoYXJ0Lk11bHRpVG9vbHRpcCh7XG5cdFx0XHRcdFx0XHR4OiBtZWRpYW5Qb3NpdGlvbi54LFxuXHRcdFx0XHRcdFx0eTogbWVkaWFuUG9zaXRpb24ueSxcblx0XHRcdFx0XHRcdHhQYWRkaW5nOiB0aGlzLm9wdGlvbnMudG9vbHRpcFhQYWRkaW5nLFxuXHRcdFx0XHRcdFx0eVBhZGRpbmc6IHRoaXMub3B0aW9ucy50b29sdGlwWVBhZGRpbmcsXG5cdFx0XHRcdFx0XHR4T2Zmc2V0OiB0aGlzLm9wdGlvbnMudG9vbHRpcFhPZmZzZXQsXG5cdFx0XHRcdFx0XHRmaWxsQ29sb3I6IHRoaXMub3B0aW9ucy50b29sdGlwRmlsbENvbG9yLFxuXHRcdFx0XHRcdFx0dGV4dENvbG9yOiB0aGlzLm9wdGlvbnMudG9vbHRpcEZvbnRDb2xvcixcblx0XHRcdFx0XHRcdGZvbnRGYW1pbHk6IHRoaXMub3B0aW9ucy50b29sdGlwRm9udEZhbWlseSxcblx0XHRcdFx0XHRcdGZvbnRTdHlsZTogdGhpcy5vcHRpb25zLnRvb2x0aXBGb250U3R5bGUsXG5cdFx0XHRcdFx0XHRmb250U2l6ZTogdGhpcy5vcHRpb25zLnRvb2x0aXBGb250U2l6ZSxcblx0XHRcdFx0XHRcdHRpdGxlVGV4dENvbG9yOiB0aGlzLm9wdGlvbnMudG9vbHRpcFRpdGxlRm9udENvbG9yLFxuXHRcdFx0XHRcdFx0dGl0bGVGb250RmFtaWx5OiB0aGlzLm9wdGlvbnMudG9vbHRpcFRpdGxlRm9udEZhbWlseSxcblx0XHRcdFx0XHRcdHRpdGxlRm9udFN0eWxlOiB0aGlzLm9wdGlvbnMudG9vbHRpcFRpdGxlRm9udFN0eWxlLFxuXHRcdFx0XHRcdFx0dGl0bGVGb250U2l6ZTogdGhpcy5vcHRpb25zLnRvb2x0aXBUaXRsZUZvbnRTaXplLFxuXHRcdFx0XHRcdFx0Y29ybmVyUmFkaXVzOiB0aGlzLm9wdGlvbnMudG9vbHRpcENvcm5lclJhZGl1cyxcblx0XHRcdFx0XHRcdGxhYmVsczogdG9vbHRpcExhYmVscyxcblx0XHRcdFx0XHRcdGxlZ2VuZENvbG9yczogdG9vbHRpcENvbG9ycyxcblx0XHRcdFx0XHRcdGxlZ2VuZENvbG9yQmFja2dyb3VuZCA6IHRoaXMub3B0aW9ucy5tdWx0aVRvb2x0aXBLZXlCYWNrZ3JvdW5kLFxuXHRcdFx0XHRcdFx0dGl0bGU6IHRlbXBsYXRlKHRoaXMub3B0aW9ucy50b29sdGlwVGl0bGVUZW1wbGF0ZSxDaGFydEVsZW1lbnRzWzBdKSxcblx0XHRcdFx0XHRcdGNoYXJ0OiB0aGlzLmNoYXJ0LFxuXHRcdFx0XHRcdFx0Y3R4OiB0aGlzLmNoYXJ0LmN0eCxcblx0XHRcdFx0XHRcdGN1c3RvbTogdGhpcy5vcHRpb25zLmN1c3RvbVRvb2x0aXBzXG5cdFx0XHRcdFx0fSkuZHJhdygpO1xuXG5cdFx0XHRcdH0gZWxzZSB7XG5cdFx0XHRcdFx0ZWFjaChDaGFydEVsZW1lbnRzLCBmdW5jdGlvbihFbGVtZW50KSB7XG5cdFx0XHRcdFx0XHR2YXIgdG9vbHRpcFBvc2l0aW9uID0gRWxlbWVudC50b29sdGlwUG9zaXRpb24oKTtcblx0XHRcdFx0XHRcdG5ldyBDaGFydC5Ub29sdGlwKHtcblx0XHRcdFx0XHRcdFx0eDogTWF0aC5yb3VuZCh0b29sdGlwUG9zaXRpb24ueCksXG5cdFx0XHRcdFx0XHRcdHk6IE1hdGgucm91bmQodG9vbHRpcFBvc2l0aW9uLnkpLFxuXHRcdFx0XHRcdFx0XHR4UGFkZGluZzogdGhpcy5vcHRpb25zLnRvb2x0aXBYUGFkZGluZyxcblx0XHRcdFx0XHRcdFx0eVBhZGRpbmc6IHRoaXMub3B0aW9ucy50b29sdGlwWVBhZGRpbmcsXG5cdFx0XHRcdFx0XHRcdGZpbGxDb2xvcjogdGhpcy5vcHRpb25zLnRvb2x0aXBGaWxsQ29sb3IsXG5cdFx0XHRcdFx0XHRcdHRleHRDb2xvcjogdGhpcy5vcHRpb25zLnRvb2x0aXBGb250Q29sb3IsXG5cdFx0XHRcdFx0XHRcdGZvbnRGYW1pbHk6IHRoaXMub3B0aW9ucy50b29sdGlwRm9udEZhbWlseSxcblx0XHRcdFx0XHRcdFx0Zm9udFN0eWxlOiB0aGlzLm9wdGlvbnMudG9vbHRpcEZvbnRTdHlsZSxcblx0XHRcdFx0XHRcdFx0Zm9udFNpemU6IHRoaXMub3B0aW9ucy50b29sdGlwRm9udFNpemUsXG5cdFx0XHRcdFx0XHRcdGNhcmV0SGVpZ2h0OiB0aGlzLm9wdGlvbnMudG9vbHRpcENhcmV0U2l6ZSxcblx0XHRcdFx0XHRcdFx0Y29ybmVyUmFkaXVzOiB0aGlzLm9wdGlvbnMudG9vbHRpcENvcm5lclJhZGl1cyxcblx0XHRcdFx0XHRcdFx0dGV4dDogdGVtcGxhdGUodGhpcy5vcHRpb25zLnRvb2x0aXBUZW1wbGF0ZSwgRWxlbWVudCksXG5cdFx0XHRcdFx0XHRcdGNoYXJ0OiB0aGlzLmNoYXJ0LFxuXHRcdFx0XHRcdFx0XHRjdXN0b206IHRoaXMub3B0aW9ucy5jdXN0b21Ub29sdGlwc1xuXHRcdFx0XHRcdFx0fSkuZHJhdygpO1xuXHRcdFx0XHRcdH0sIHRoaXMpO1xuXHRcdFx0XHR9XG5cdFx0XHR9XG5cdFx0XHRyZXR1cm4gdGhpcztcblx0XHR9LFxuXHRcdHRvQmFzZTY0SW1hZ2UgOiBmdW5jdGlvbigpe1xuXHRcdFx0cmV0dXJuIHRoaXMuY2hhcnQuY2FudmFzLnRvRGF0YVVSTC5hcHBseSh0aGlzLmNoYXJ0LmNhbnZhcywgYXJndW1lbnRzKTtcblx0XHR9XG5cdH0pO1xuXG5cdENoYXJ0LlR5cGUuZXh0ZW5kID0gZnVuY3Rpb24oZXh0ZW5zaW9ucyl7XG5cblx0XHR2YXIgcGFyZW50ID0gdGhpcztcblxuXHRcdHZhciBDaGFydFR5cGUgPSBmdW5jdGlvbigpe1xuXHRcdFx0cmV0dXJuIHBhcmVudC5hcHBseSh0aGlzLGFyZ3VtZW50cyk7XG5cdFx0fTtcblxuXHRcdC8vQ29weSB0aGUgcHJvdG90eXBlIG9iamVjdCBvZiB0aGUgdGhpcyBjbGFzc1xuXHRcdENoYXJ0VHlwZS5wcm90b3R5cGUgPSBjbG9uZShwYXJlbnQucHJvdG90eXBlKTtcblx0XHQvL05vdyBvdmVyd3JpdGUgc29tZSBvZiB0aGUgcHJvcGVydGllcyBpbiB0aGUgYmFzZSBjbGFzcyB3aXRoIHRoZSBuZXcgZXh0ZW5zaW9uc1xuXHRcdGV4dGVuZChDaGFydFR5cGUucHJvdG90eXBlLCBleHRlbnNpb25zKTtcblxuXHRcdENoYXJ0VHlwZS5leHRlbmQgPSBDaGFydC5UeXBlLmV4dGVuZDtcblxuXHRcdGlmIChleHRlbnNpb25zLm5hbWUgfHwgcGFyZW50LnByb3RvdHlwZS5uYW1lKXtcblxuXHRcdFx0dmFyIGNoYXJ0TmFtZSA9IGV4dGVuc2lvbnMubmFtZSB8fCBwYXJlbnQucHJvdG90eXBlLm5hbWU7XG5cdFx0XHQvL0Fzc2lnbiBhbnkgcG90ZW50aWFsIGRlZmF1bHQgdmFsdWVzIG9mIHRoZSBuZXcgY2hhcnQgdHlwZVxuXG5cdFx0XHQvL0lmIG5vbmUgYXJlIGRlZmluZWQsIHdlJ2xsIHVzZSBhIGNsb25lIG9mIHRoZSBjaGFydCB0eXBlIHRoaXMgaXMgYmVpbmcgZXh0ZW5kZWQgZnJvbS5cblx0XHRcdC8vSS5lLiBpZiB3ZSBleHRlbmQgYSBsaW5lIGNoYXJ0LCB3ZSdsbCB1c2UgdGhlIGRlZmF1bHRzIGZyb20gdGhlIGxpbmUgY2hhcnQgaWYgb3VyIG5ldyBjaGFydFxuXHRcdFx0Ly9kb2Vzbid0IGRlZmluZSBzb21lIGRlZmF1bHRzIG9mIHRoZWlyIG93bi5cblxuXHRcdFx0dmFyIGJhc2VEZWZhdWx0cyA9IChDaGFydC5kZWZhdWx0c1twYXJlbnQucHJvdG90eXBlLm5hbWVdKSA/IGNsb25lKENoYXJ0LmRlZmF1bHRzW3BhcmVudC5wcm90b3R5cGUubmFtZV0pIDoge307XG5cblx0XHRcdENoYXJ0LmRlZmF1bHRzW2NoYXJ0TmFtZV0gPSBleHRlbmQoYmFzZURlZmF1bHRzLGV4dGVuc2lvbnMuZGVmYXVsdHMpO1xuXG5cdFx0XHRDaGFydC50eXBlc1tjaGFydE5hbWVdID0gQ2hhcnRUeXBlO1xuXG5cdFx0XHQvL1JlZ2lzdGVyIHRoaXMgbmV3IGNoYXJ0IHR5cGUgaW4gdGhlIENoYXJ0IHByb3RvdHlwZVxuXHRcdFx0Q2hhcnQucHJvdG90eXBlW2NoYXJ0TmFtZV0gPSBmdW5jdGlvbihkYXRhLG9wdGlvbnMpe1xuXHRcdFx0XHR2YXIgY29uZmlnID0gbWVyZ2UoQ2hhcnQuZGVmYXVsdHMuZ2xvYmFsLCBDaGFydC5kZWZhdWx0c1tjaGFydE5hbWVdLCBvcHRpb25zIHx8IHt9KTtcblx0XHRcdFx0cmV0dXJuIG5ldyBDaGFydFR5cGUoZGF0YSxjb25maWcsdGhpcyk7XG5cdFx0XHR9O1xuXHRcdH0gZWxzZXtcblx0XHRcdHdhcm4oXCJOYW1lIG5vdCBwcm92aWRlZCBmb3IgdGhpcyBjaGFydCwgc28gaXQgaGFzbid0IGJlZW4gcmVnaXN0ZXJlZFwiKTtcblx0XHR9XG5cdFx0cmV0dXJuIHBhcmVudDtcblx0fTtcblxuXHRDaGFydC5FbGVtZW50ID0gZnVuY3Rpb24oY29uZmlndXJhdGlvbil7XG5cdFx0ZXh0ZW5kKHRoaXMsY29uZmlndXJhdGlvbik7XG5cdFx0dGhpcy5pbml0aWFsaXplLmFwcGx5KHRoaXMsYXJndW1lbnRzKTtcblx0XHR0aGlzLnNhdmUoKTtcblx0fTtcblx0ZXh0ZW5kKENoYXJ0LkVsZW1lbnQucHJvdG90eXBlLHtcblx0XHRpbml0aWFsaXplIDogZnVuY3Rpb24oKXt9LFxuXHRcdHJlc3RvcmUgOiBmdW5jdGlvbihwcm9wcyl7XG5cdFx0XHRpZiAoIXByb3BzKXtcblx0XHRcdFx0ZXh0ZW5kKHRoaXMsdGhpcy5fc2F2ZWQpO1xuXHRcdFx0fSBlbHNlIHtcblx0XHRcdFx0ZWFjaChwcm9wcyxmdW5jdGlvbihrZXkpe1xuXHRcdFx0XHRcdHRoaXNba2V5XSA9IHRoaXMuX3NhdmVkW2tleV07XG5cdFx0XHRcdH0sdGhpcyk7XG5cdFx0XHR9XG5cdFx0XHRyZXR1cm4gdGhpcztcblx0XHR9LFxuXHRcdHNhdmUgOiBmdW5jdGlvbigpe1xuXHRcdFx0dGhpcy5fc2F2ZWQgPSBjbG9uZSh0aGlzKTtcblx0XHRcdGRlbGV0ZSB0aGlzLl9zYXZlZC5fc2F2ZWQ7XG5cdFx0XHRyZXR1cm4gdGhpcztcblx0XHR9LFxuXHRcdHVwZGF0ZSA6IGZ1bmN0aW9uKG5ld1Byb3BzKXtcblx0XHRcdGVhY2gobmV3UHJvcHMsZnVuY3Rpb24odmFsdWUsa2V5KXtcblx0XHRcdFx0dGhpcy5fc2F2ZWRba2V5XSA9IHRoaXNba2V5XTtcblx0XHRcdFx0dGhpc1trZXldID0gdmFsdWU7XG5cdFx0XHR9LHRoaXMpO1xuXHRcdFx0cmV0dXJuIHRoaXM7XG5cdFx0fSxcblx0XHR0cmFuc2l0aW9uIDogZnVuY3Rpb24ocHJvcHMsZWFzZSl7XG5cdFx0XHRlYWNoKHByb3BzLGZ1bmN0aW9uKHZhbHVlLGtleSl7XG5cdFx0XHRcdHRoaXNba2V5XSA9ICgodmFsdWUgLSB0aGlzLl9zYXZlZFtrZXldKSAqIGVhc2UpICsgdGhpcy5fc2F2ZWRba2V5XTtcblx0XHRcdH0sdGhpcyk7XG5cdFx0XHRyZXR1cm4gdGhpcztcblx0XHR9LFxuXHRcdHRvb2x0aXBQb3NpdGlvbiA6IGZ1bmN0aW9uKCl7XG5cdFx0XHRyZXR1cm4ge1xuXHRcdFx0XHR4IDogdGhpcy54LFxuXHRcdFx0XHR5IDogdGhpcy55XG5cdFx0XHR9O1xuXHRcdH0sXG5cdFx0aGFzVmFsdWU6IGZ1bmN0aW9uKCl7XG5cdFx0XHRyZXR1cm4gaXNOdW1iZXIodGhpcy52YWx1ZSk7XG5cdFx0fVxuXHR9KTtcblxuXHRDaGFydC5FbGVtZW50LmV4dGVuZCA9IGluaGVyaXRzO1xuXG5cblx0Q2hhcnQuUG9pbnQgPSBDaGFydC5FbGVtZW50LmV4dGVuZCh7XG5cdFx0ZGlzcGxheTogdHJ1ZSxcblx0XHRpblJhbmdlOiBmdW5jdGlvbihjaGFydFgsY2hhcnRZKXtcblx0XHRcdHZhciBoaXREZXRlY3Rpb25SYW5nZSA9IHRoaXMuaGl0RGV0ZWN0aW9uUmFkaXVzICsgdGhpcy5yYWRpdXM7XG5cdFx0XHRyZXR1cm4gKChNYXRoLnBvdyhjaGFydFgtdGhpcy54LCAyKStNYXRoLnBvdyhjaGFydFktdGhpcy55LCAyKSkgPCBNYXRoLnBvdyhoaXREZXRlY3Rpb25SYW5nZSwyKSk7XG5cdFx0fSxcblx0XHRkcmF3IDogZnVuY3Rpb24oKXtcblx0XHRcdGlmICh0aGlzLmRpc3BsYXkpe1xuXHRcdFx0XHR2YXIgY3R4ID0gdGhpcy5jdHg7XG5cdFx0XHRcdGN0eC5iZWdpblBhdGgoKTtcblxuXHRcdFx0XHRjdHguYXJjKHRoaXMueCwgdGhpcy55LCB0aGlzLnJhZGl1cywgMCwgTWF0aC5QSSoyKTtcblx0XHRcdFx0Y3R4LmNsb3NlUGF0aCgpO1xuXG5cdFx0XHRcdGN0eC5zdHJva2VTdHlsZSA9IHRoaXMuc3Ryb2tlQ29sb3I7XG5cdFx0XHRcdGN0eC5saW5lV2lkdGggPSB0aGlzLnN0cm9rZVdpZHRoO1xuXG5cdFx0XHRcdGN0eC5maWxsU3R5bGUgPSB0aGlzLmZpbGxDb2xvcjtcblxuXHRcdFx0XHRjdHguZmlsbCgpO1xuXHRcdFx0XHRjdHguc3Ryb2tlKCk7XG5cdFx0XHR9XG5cblxuXHRcdFx0Ly9RdWljayBkZWJ1ZyBmb3IgYmV6aWVyIGN1cnZlIHNwbGluaW5nXG5cdFx0XHQvL0hpZ2hsaWdodHMgY29udHJvbCBwb2ludHMgYW5kIHRoZSBsaW5lIGJldHdlZW4gdGhlbS5cblx0XHRcdC8vSGFuZHkgZm9yIGRldiAtIHN0cmlwcGVkIGluIHRoZSBtaW4gdmVyc2lvbi5cblxuXHRcdFx0Ly8gY3R4LnNhdmUoKTtcblx0XHRcdC8vIGN0eC5maWxsU3R5bGUgPSBcImJsYWNrXCI7XG5cdFx0XHQvLyBjdHguc3Ryb2tlU3R5bGUgPSBcImJsYWNrXCJcblx0XHRcdC8vIGN0eC5iZWdpblBhdGgoKTtcblx0XHRcdC8vIGN0eC5hcmModGhpcy5jb250cm9sUG9pbnRzLmlubmVyLngsdGhpcy5jb250cm9sUG9pbnRzLmlubmVyLnksIDIsIDAsIE1hdGguUEkqMik7XG5cdFx0XHQvLyBjdHguZmlsbCgpO1xuXG5cdFx0XHQvLyBjdHguYmVnaW5QYXRoKCk7XG5cdFx0XHQvLyBjdHguYXJjKHRoaXMuY29udHJvbFBvaW50cy5vdXRlci54LHRoaXMuY29udHJvbFBvaW50cy5vdXRlci55LCAyLCAwLCBNYXRoLlBJKjIpO1xuXHRcdFx0Ly8gY3R4LmZpbGwoKTtcblxuXHRcdFx0Ly8gY3R4Lm1vdmVUbyh0aGlzLmNvbnRyb2xQb2ludHMuaW5uZXIueCx0aGlzLmNvbnRyb2xQb2ludHMuaW5uZXIueSk7XG5cdFx0XHQvLyBjdHgubGluZVRvKHRoaXMueCwgdGhpcy55KTtcblx0XHRcdC8vIGN0eC5saW5lVG8odGhpcy5jb250cm9sUG9pbnRzLm91dGVyLngsdGhpcy5jb250cm9sUG9pbnRzLm91dGVyLnkpO1xuXHRcdFx0Ly8gY3R4LnN0cm9rZSgpO1xuXG5cdFx0XHQvLyBjdHgucmVzdG9yZSgpO1xuXG5cblxuXHRcdH1cblx0fSk7XG5cblx0Q2hhcnQuQXJjID0gQ2hhcnQuRWxlbWVudC5leHRlbmQoe1xuXHRcdGluUmFuZ2UgOiBmdW5jdGlvbihjaGFydFgsY2hhcnRZKXtcblxuXHRcdFx0dmFyIHBvaW50UmVsYXRpdmVQb3NpdGlvbiA9IGhlbHBlcnMuZ2V0QW5nbGVGcm9tUG9pbnQodGhpcywge1xuXHRcdFx0XHR4OiBjaGFydFgsXG5cdFx0XHRcdHk6IGNoYXJ0WVxuXHRcdFx0fSk7XG5cblx0XHRcdC8vIE5vcm1hbGl6ZSBhbGwgYW5nbGVzIHRvIDAgLSAyKlBJICgwIC0gMzYwwrApXG5cdFx0XHR2YXIgcG9pbnRSZWxhdGl2ZUFuZ2xlID0gcG9pbnRSZWxhdGl2ZVBvc2l0aW9uLmFuZ2xlICUgKE1hdGguUEkgKiAyKSxcblx0XHRcdCAgICBzdGFydEFuZ2xlID0gKE1hdGguUEkgKiAyICsgdGhpcy5zdGFydEFuZ2xlKSAlIChNYXRoLlBJICogMiksXG5cdFx0XHQgICAgZW5kQW5nbGUgPSAoTWF0aC5QSSAqIDIgKyB0aGlzLmVuZEFuZ2xlKSAlIChNYXRoLlBJICogMikgfHwgMzYwO1xuXG5cdFx0XHQvLyBDYWxjdWxhdGUgd2V0aGVyIHRoZSBwb2ludFJlbGF0aXZlQW5nbGUgaXMgYmV0d2VlbiB0aGUgc3RhcnQgYW5kIHRoZSBlbmQgYW5nbGVcblx0XHRcdHZhciBiZXR3ZWVuQW5nbGVzID0gKGVuZEFuZ2xlIDwgc3RhcnRBbmdsZSkgP1xuXHRcdFx0XHRwb2ludFJlbGF0aXZlQW5nbGUgPD0gZW5kQW5nbGUgfHwgcG9pbnRSZWxhdGl2ZUFuZ2xlID49IHN0YXJ0QW5nbGU6XG5cdFx0XHRcdHBvaW50UmVsYXRpdmVBbmdsZSA+PSBzdGFydEFuZ2xlICYmIHBvaW50UmVsYXRpdmVBbmdsZSA8PSBlbmRBbmdsZTtcblxuXHRcdFx0Ly9DaGVjayBpZiB3aXRoaW4gdGhlIHJhbmdlIG9mIHRoZSBvcGVuL2Nsb3NlIGFuZ2xlXG5cdFx0XHR2YXIgd2l0aGluUmFkaXVzID0gKHBvaW50UmVsYXRpdmVQb3NpdGlvbi5kaXN0YW5jZSA+PSB0aGlzLmlubmVyUmFkaXVzICYmIHBvaW50UmVsYXRpdmVQb3NpdGlvbi5kaXN0YW5jZSA8PSB0aGlzLm91dGVyUmFkaXVzKTtcblxuXHRcdFx0cmV0dXJuIChiZXR3ZWVuQW5nbGVzICYmIHdpdGhpblJhZGl1cyk7XG5cdFx0XHQvL0Vuc3VyZSB3aXRoaW4gdGhlIG91dHNpZGUgb2YgdGhlIGFyYyBjZW50cmUsIGJ1dCBpbnNpZGUgYXJjIG91dGVyXG5cdFx0fSxcblx0XHR0b29sdGlwUG9zaXRpb24gOiBmdW5jdGlvbigpe1xuXHRcdFx0dmFyIGNlbnRyZUFuZ2xlID0gdGhpcy5zdGFydEFuZ2xlICsgKCh0aGlzLmVuZEFuZ2xlIC0gdGhpcy5zdGFydEFuZ2xlKSAvIDIpLFxuXHRcdFx0XHRyYW5nZUZyb21DZW50cmUgPSAodGhpcy5vdXRlclJhZGl1cyAtIHRoaXMuaW5uZXJSYWRpdXMpIC8gMiArIHRoaXMuaW5uZXJSYWRpdXM7XG5cdFx0XHRyZXR1cm4ge1xuXHRcdFx0XHR4IDogdGhpcy54ICsgKE1hdGguY29zKGNlbnRyZUFuZ2xlKSAqIHJhbmdlRnJvbUNlbnRyZSksXG5cdFx0XHRcdHkgOiB0aGlzLnkgKyAoTWF0aC5zaW4oY2VudHJlQW5nbGUpICogcmFuZ2VGcm9tQ2VudHJlKVxuXHRcdFx0fTtcblx0XHR9LFxuXHRcdGRyYXcgOiBmdW5jdGlvbihhbmltYXRpb25QZXJjZW50KXtcblxuXHRcdFx0dmFyIGVhc2luZ0RlY2ltYWwgPSBhbmltYXRpb25QZXJjZW50IHx8IDE7XG5cblx0XHRcdHZhciBjdHggPSB0aGlzLmN0eDtcblxuXHRcdFx0Y3R4LmJlZ2luUGF0aCgpO1xuXG5cdFx0XHRjdHguYXJjKHRoaXMueCwgdGhpcy55LCB0aGlzLm91dGVyUmFkaXVzIDwgMCA/IDAgOiB0aGlzLm91dGVyUmFkaXVzLCB0aGlzLnN0YXJ0QW5nbGUsIHRoaXMuZW5kQW5nbGUpO1xuXG4gICAgICAgICAgICBjdHguYXJjKHRoaXMueCwgdGhpcy55LCB0aGlzLmlubmVyUmFkaXVzIDwgMCA/IDAgOiB0aGlzLmlubmVyUmFkaXVzLCB0aGlzLmVuZEFuZ2xlLCB0aGlzLnN0YXJ0QW5nbGUsIHRydWUpO1xuXG5cdFx0XHRjdHguY2xvc2VQYXRoKCk7XG5cdFx0XHRjdHguc3Ryb2tlU3R5bGUgPSB0aGlzLnN0cm9rZUNvbG9yO1xuXHRcdFx0Y3R4LmxpbmVXaWR0aCA9IHRoaXMuc3Ryb2tlV2lkdGg7XG5cblx0XHRcdGN0eC5maWxsU3R5bGUgPSB0aGlzLmZpbGxDb2xvcjtcblxuXHRcdFx0Y3R4LmZpbGwoKTtcblx0XHRcdGN0eC5saW5lSm9pbiA9ICdiZXZlbCc7XG5cblx0XHRcdGlmICh0aGlzLnNob3dTdHJva2Upe1xuXHRcdFx0XHRjdHguc3Ryb2tlKCk7XG5cdFx0XHR9XG5cdFx0fVxuXHR9KTtcblxuXHRDaGFydC5SZWN0YW5nbGUgPSBDaGFydC5FbGVtZW50LmV4dGVuZCh7XG5cdFx0ZHJhdyA6IGZ1bmN0aW9uKCl7XG5cdFx0XHR2YXIgY3R4ID0gdGhpcy5jdHgsXG5cdFx0XHRcdGhhbGZXaWR0aCA9IHRoaXMud2lkdGgvMixcblx0XHRcdFx0bGVmdFggPSB0aGlzLnggLSBoYWxmV2lkdGgsXG5cdFx0XHRcdHJpZ2h0WCA9IHRoaXMueCArIGhhbGZXaWR0aCxcblx0XHRcdFx0dG9wID0gdGhpcy5iYXNlIC0gKHRoaXMuYmFzZSAtIHRoaXMueSksXG5cdFx0XHRcdGhhbGZTdHJva2UgPSB0aGlzLnN0cm9rZVdpZHRoIC8gMjtcblxuXHRcdFx0Ly8gQ2FudmFzIGRvZXNuJ3QgYWxsb3cgdXMgdG8gc3Ryb2tlIGluc2lkZSB0aGUgd2lkdGggc28gd2UgY2FuXG5cdFx0XHQvLyBhZGp1c3QgdGhlIHNpemVzIHRvIGZpdCBpZiB3ZSdyZSBzZXR0aW5nIGEgc3Ryb2tlIG9uIHRoZSBsaW5lXG5cdFx0XHRpZiAodGhpcy5zaG93U3Ryb2tlKXtcblx0XHRcdFx0bGVmdFggKz0gaGFsZlN0cm9rZTtcblx0XHRcdFx0cmlnaHRYIC09IGhhbGZTdHJva2U7XG5cdFx0XHRcdHRvcCArPSBoYWxmU3Ryb2tlO1xuXHRcdFx0fVxuXG5cdFx0XHRjdHguYmVnaW5QYXRoKCk7XG5cblx0XHRcdGN0eC5maWxsU3R5bGUgPSB0aGlzLmZpbGxDb2xvcjtcblx0XHRcdGN0eC5zdHJva2VTdHlsZSA9IHRoaXMuc3Ryb2tlQ29sb3I7XG5cdFx0XHRjdHgubGluZVdpZHRoID0gdGhpcy5zdHJva2VXaWR0aDtcblxuXHRcdFx0Ly8gSXQnZCBiZSBuaWNlIHRvIGtlZXAgdGhpcyBjbGFzcyB0b3RhbGx5IGdlbmVyaWMgdG8gYW55IHJlY3RhbmdsZVxuXHRcdFx0Ly8gYW5kIHNpbXBseSBzcGVjaWZ5IHdoaWNoIGJvcmRlciB0byBtaXNzIG91dC5cblx0XHRcdGN0eC5tb3ZlVG8obGVmdFgsIHRoaXMuYmFzZSk7XG5cdFx0XHRjdHgubGluZVRvKGxlZnRYLCB0b3ApO1xuXHRcdFx0Y3R4LmxpbmVUbyhyaWdodFgsIHRvcCk7XG5cdFx0XHRjdHgubGluZVRvKHJpZ2h0WCwgdGhpcy5iYXNlKTtcblx0XHRcdGN0eC5maWxsKCk7XG5cdFx0XHRpZiAodGhpcy5zaG93U3Ryb2tlKXtcblx0XHRcdFx0Y3R4LnN0cm9rZSgpO1xuXHRcdFx0fVxuXHRcdH0sXG5cdFx0aGVpZ2h0IDogZnVuY3Rpb24oKXtcblx0XHRcdHJldHVybiB0aGlzLmJhc2UgLSB0aGlzLnk7XG5cdFx0fSxcblx0XHRpblJhbmdlIDogZnVuY3Rpb24oY2hhcnRYLGNoYXJ0WSl7XG5cdFx0XHRyZXR1cm4gKGNoYXJ0WCA+PSB0aGlzLnggLSB0aGlzLndpZHRoLzIgJiYgY2hhcnRYIDw9IHRoaXMueCArIHRoaXMud2lkdGgvMikgJiYgKGNoYXJ0WSA+PSB0aGlzLnkgJiYgY2hhcnRZIDw9IHRoaXMuYmFzZSk7XG5cdFx0fVxuXHR9KTtcblxuXHRDaGFydC5BbmltYXRpb24gPSBDaGFydC5FbGVtZW50LmV4dGVuZCh7XG5cdFx0Y3VycmVudFN0ZXA6IG51bGwsIC8vIHRoZSBjdXJyZW50IGFuaW1hdGlvbiBzdGVwXG5cdFx0bnVtU3RlcHM6IDYwLCAvLyBkZWZhdWx0IG51bWJlciBvZiBzdGVwc1xuXHRcdGVhc2luZzogXCJcIiwgLy8gdGhlIGVhc2luZyB0byB1c2UgZm9yIHRoaXMgYW5pbWF0aW9uXG5cdFx0cmVuZGVyOiBudWxsLCAvLyByZW5kZXIgZnVuY3Rpb24gdXNlZCBieSB0aGUgYW5pbWF0aW9uIHNlcnZpY2Vcblx0XHRcblx0XHRvbkFuaW1hdGlvblByb2dyZXNzOiBudWxsLCAvLyB1c2VyIHNwZWNpZmllZCBjYWxsYmFjayB0byBmaXJlIG9uIGVhY2ggc3RlcCBvZiB0aGUgYW5pbWF0aW9uIFxuXHRcdG9uQW5pbWF0aW9uQ29tcGxldGU6IG51bGwsIC8vIHVzZXIgc3BlY2lmaWVkIGNhbGxiYWNrIHRvIGZpcmUgd2hlbiB0aGUgYW5pbWF0aW9uIGZpbmlzaGVzXG5cdH0pO1xuXHRcblx0Q2hhcnQuVG9vbHRpcCA9IENoYXJ0LkVsZW1lbnQuZXh0ZW5kKHtcblx0XHRkcmF3IDogZnVuY3Rpb24oKXtcblxuXHRcdFx0dmFyIGN0eCA9IHRoaXMuY2hhcnQuY3R4O1xuXG5cdFx0XHRjdHguZm9udCA9IGZvbnRTdHJpbmcodGhpcy5mb250U2l6ZSx0aGlzLmZvbnRTdHlsZSx0aGlzLmZvbnRGYW1pbHkpO1xuXG5cdFx0XHR0aGlzLnhBbGlnbiA9IFwiY2VudGVyXCI7XG5cdFx0XHR0aGlzLnlBbGlnbiA9IFwiYWJvdmVcIjtcblxuXHRcdFx0Ly9EaXN0YW5jZSBiZXR3ZWVuIHRoZSBhY3R1YWwgZWxlbWVudC55IHBvc2l0aW9uIGFuZCB0aGUgc3RhcnQgb2YgdGhlIHRvb2x0aXAgY2FyZXRcblx0XHRcdHZhciBjYXJldFBhZGRpbmcgPSB0aGlzLmNhcmV0UGFkZGluZyA9IDI7XG5cblx0XHRcdHZhciB0b29sdGlwV2lkdGggPSBjdHgubWVhc3VyZVRleHQodGhpcy50ZXh0KS53aWR0aCArIDIqdGhpcy54UGFkZGluZyxcblx0XHRcdFx0dG9vbHRpcFJlY3RIZWlnaHQgPSB0aGlzLmZvbnRTaXplICsgMip0aGlzLnlQYWRkaW5nLFxuXHRcdFx0XHR0b29sdGlwSGVpZ2h0ID0gdG9vbHRpcFJlY3RIZWlnaHQgKyB0aGlzLmNhcmV0SGVpZ2h0ICsgY2FyZXRQYWRkaW5nO1xuXG5cdFx0XHRpZiAodGhpcy54ICsgdG9vbHRpcFdpZHRoLzIgPnRoaXMuY2hhcnQud2lkdGgpe1xuXHRcdFx0XHR0aGlzLnhBbGlnbiA9IFwibGVmdFwiO1xuXHRcdFx0fSBlbHNlIGlmICh0aGlzLnggLSB0b29sdGlwV2lkdGgvMiA8IDApe1xuXHRcdFx0XHR0aGlzLnhBbGlnbiA9IFwicmlnaHRcIjtcblx0XHRcdH1cblxuXHRcdFx0aWYgKHRoaXMueSAtIHRvb2x0aXBIZWlnaHQgPCAwKXtcblx0XHRcdFx0dGhpcy55QWxpZ24gPSBcImJlbG93XCI7XG5cdFx0XHR9XG5cblxuXHRcdFx0dmFyIHRvb2x0aXBYID0gdGhpcy54IC0gdG9vbHRpcFdpZHRoLzIsXG5cdFx0XHRcdHRvb2x0aXBZID0gdGhpcy55IC0gdG9vbHRpcEhlaWdodDtcblxuXHRcdFx0Y3R4LmZpbGxTdHlsZSA9IHRoaXMuZmlsbENvbG9yO1xuXG5cdFx0XHQvLyBDdXN0b20gVG9vbHRpcHNcblx0XHRcdGlmKHRoaXMuY3VzdG9tKXtcblx0XHRcdFx0dGhpcy5jdXN0b20odGhpcyk7XG5cdFx0XHR9XG5cdFx0XHRlbHNle1xuXHRcdFx0XHRzd2l0Y2godGhpcy55QWxpZ24pXG5cdFx0XHRcdHtcblx0XHRcdFx0Y2FzZSBcImFib3ZlXCI6XG5cdFx0XHRcdFx0Ly9EcmF3IGEgY2FyZXQgYWJvdmUgdGhlIHgveVxuXHRcdFx0XHRcdGN0eC5iZWdpblBhdGgoKTtcblx0XHRcdFx0XHRjdHgubW92ZVRvKHRoaXMueCx0aGlzLnkgLSBjYXJldFBhZGRpbmcpO1xuXHRcdFx0XHRcdGN0eC5saW5lVG8odGhpcy54ICsgdGhpcy5jYXJldEhlaWdodCwgdGhpcy55IC0gKGNhcmV0UGFkZGluZyArIHRoaXMuY2FyZXRIZWlnaHQpKTtcblx0XHRcdFx0XHRjdHgubGluZVRvKHRoaXMueCAtIHRoaXMuY2FyZXRIZWlnaHQsIHRoaXMueSAtIChjYXJldFBhZGRpbmcgKyB0aGlzLmNhcmV0SGVpZ2h0KSk7XG5cdFx0XHRcdFx0Y3R4LmNsb3NlUGF0aCgpO1xuXHRcdFx0XHRcdGN0eC5maWxsKCk7XG5cdFx0XHRcdFx0YnJlYWs7XG5cdFx0XHRcdGNhc2UgXCJiZWxvd1wiOlxuXHRcdFx0XHRcdHRvb2x0aXBZID0gdGhpcy55ICsgY2FyZXRQYWRkaW5nICsgdGhpcy5jYXJldEhlaWdodDtcblx0XHRcdFx0XHQvL0RyYXcgYSBjYXJldCBiZWxvdyB0aGUgeC95XG5cdFx0XHRcdFx0Y3R4LmJlZ2luUGF0aCgpO1xuXHRcdFx0XHRcdGN0eC5tb3ZlVG8odGhpcy54LCB0aGlzLnkgKyBjYXJldFBhZGRpbmcpO1xuXHRcdFx0XHRcdGN0eC5saW5lVG8odGhpcy54ICsgdGhpcy5jYXJldEhlaWdodCwgdGhpcy55ICsgY2FyZXRQYWRkaW5nICsgdGhpcy5jYXJldEhlaWdodCk7XG5cdFx0XHRcdFx0Y3R4LmxpbmVUbyh0aGlzLnggLSB0aGlzLmNhcmV0SGVpZ2h0LCB0aGlzLnkgKyBjYXJldFBhZGRpbmcgKyB0aGlzLmNhcmV0SGVpZ2h0KTtcblx0XHRcdFx0XHRjdHguY2xvc2VQYXRoKCk7XG5cdFx0XHRcdFx0Y3R4LmZpbGwoKTtcblx0XHRcdFx0XHRicmVhaztcblx0XHRcdFx0fVxuXG5cdFx0XHRcdHN3aXRjaCh0aGlzLnhBbGlnbilcblx0XHRcdFx0e1xuXHRcdFx0XHRjYXNlIFwibGVmdFwiOlxuXHRcdFx0XHRcdHRvb2x0aXBYID0gdGhpcy54IC0gdG9vbHRpcFdpZHRoICsgKHRoaXMuY29ybmVyUmFkaXVzICsgdGhpcy5jYXJldEhlaWdodCk7XG5cdFx0XHRcdFx0YnJlYWs7XG5cdFx0XHRcdGNhc2UgXCJyaWdodFwiOlxuXHRcdFx0XHRcdHRvb2x0aXBYID0gdGhpcy54IC0gKHRoaXMuY29ybmVyUmFkaXVzICsgdGhpcy5jYXJldEhlaWdodCk7XG5cdFx0XHRcdFx0YnJlYWs7XG5cdFx0XHRcdH1cblxuXHRcdFx0XHRkcmF3Um91bmRlZFJlY3RhbmdsZShjdHgsdG9vbHRpcFgsdG9vbHRpcFksdG9vbHRpcFdpZHRoLHRvb2x0aXBSZWN0SGVpZ2h0LHRoaXMuY29ybmVyUmFkaXVzKTtcblxuXHRcdFx0XHRjdHguZmlsbCgpO1xuXG5cdFx0XHRcdGN0eC5maWxsU3R5bGUgPSB0aGlzLnRleHRDb2xvcjtcblx0XHRcdFx0Y3R4LnRleHRBbGlnbiA9IFwiY2VudGVyXCI7XG5cdFx0XHRcdGN0eC50ZXh0QmFzZWxpbmUgPSBcIm1pZGRsZVwiO1xuXHRcdFx0XHRjdHguZmlsbFRleHQodGhpcy50ZXh0LCB0b29sdGlwWCArIHRvb2x0aXBXaWR0aC8yLCB0b29sdGlwWSArIHRvb2x0aXBSZWN0SGVpZ2h0LzIpO1xuXHRcdFx0fVxuXHRcdH1cblx0fSk7XG5cblx0Q2hhcnQuTXVsdGlUb29sdGlwID0gQ2hhcnQuRWxlbWVudC5leHRlbmQoe1xuXHRcdGluaXRpYWxpemUgOiBmdW5jdGlvbigpe1xuXHRcdFx0dGhpcy5mb250ID0gZm9udFN0cmluZyh0aGlzLmZvbnRTaXplLHRoaXMuZm9udFN0eWxlLHRoaXMuZm9udEZhbWlseSk7XG5cblx0XHRcdHRoaXMudGl0bGVGb250ID0gZm9udFN0cmluZyh0aGlzLnRpdGxlRm9udFNpemUsdGhpcy50aXRsZUZvbnRTdHlsZSx0aGlzLnRpdGxlRm9udEZhbWlseSk7XG5cblx0XHRcdHRoaXMudGl0bGVIZWlnaHQgPSB0aGlzLnRpdGxlID8gdGhpcy50aXRsZUZvbnRTaXplICogMS41IDogMDtcblx0XHRcdHRoaXMuaGVpZ2h0ID0gKHRoaXMubGFiZWxzLmxlbmd0aCAqIHRoaXMuZm9udFNpemUpICsgKCh0aGlzLmxhYmVscy5sZW5ndGgtMSkgKiAodGhpcy5mb250U2l6ZS8yKSkgKyAodGhpcy55UGFkZGluZyoyKSArIHRoaXMudGl0bGVIZWlnaHQ7XG5cblx0XHRcdHRoaXMuY3R4LmZvbnQgPSB0aGlzLnRpdGxlRm9udDtcblxuXHRcdFx0dmFyIHRpdGxlV2lkdGggPSB0aGlzLmN0eC5tZWFzdXJlVGV4dCh0aGlzLnRpdGxlKS53aWR0aCxcblx0XHRcdFx0Ly9MYWJlbCBoYXMgYSBsZWdlbmQgc3F1YXJlIGFzIHdlbGwgc28gYWNjb3VudCBmb3IgdGhpcy5cblx0XHRcdFx0bGFiZWxXaWR0aCA9IGxvbmdlc3RUZXh0KHRoaXMuY3R4LHRoaXMuZm9udCx0aGlzLmxhYmVscykgKyB0aGlzLmZvbnRTaXplICsgMyxcblx0XHRcdFx0bG9uZ2VzdFRleHRXaWR0aCA9IG1heChbbGFiZWxXaWR0aCx0aXRsZVdpZHRoXSk7XG5cblx0XHRcdHRoaXMud2lkdGggPSBsb25nZXN0VGV4dFdpZHRoICsgKHRoaXMueFBhZGRpbmcqMik7XG5cblxuXHRcdFx0dmFyIGhhbGZIZWlnaHQgPSB0aGlzLmhlaWdodC8yO1xuXG5cdFx0XHQvL0NoZWNrIHRvIGVuc3VyZSB0aGUgaGVpZ2h0IHdpbGwgZml0IG9uIHRoZSBjYW52YXNcblx0XHRcdGlmICh0aGlzLnkgLSBoYWxmSGVpZ2h0IDwgMCApe1xuXHRcdFx0XHR0aGlzLnkgPSBoYWxmSGVpZ2h0O1xuXHRcdFx0fSBlbHNlIGlmICh0aGlzLnkgKyBoYWxmSGVpZ2h0ID4gdGhpcy5jaGFydC5oZWlnaHQpe1xuXHRcdFx0XHR0aGlzLnkgPSB0aGlzLmNoYXJ0LmhlaWdodCAtIGhhbGZIZWlnaHQ7XG5cdFx0XHR9XG5cblx0XHRcdC8vRGVjaWRlIHdoZXRoZXIgdG8gYWxpZ24gbGVmdCBvciByaWdodCBiYXNlZCBvbiBwb3NpdGlvbiBvbiBjYW52YXNcblx0XHRcdGlmICh0aGlzLnggPiB0aGlzLmNoYXJ0LndpZHRoLzIpe1xuXHRcdFx0XHR0aGlzLnggLT0gdGhpcy54T2Zmc2V0ICsgdGhpcy53aWR0aDtcblx0XHRcdH0gZWxzZSB7XG5cdFx0XHRcdHRoaXMueCArPSB0aGlzLnhPZmZzZXQ7XG5cdFx0XHR9XG5cblxuXHRcdH0sXG5cdFx0Z2V0TGluZUhlaWdodCA6IGZ1bmN0aW9uKGluZGV4KXtcblx0XHRcdHZhciBiYXNlTGluZUhlaWdodCA9IHRoaXMueSAtICh0aGlzLmhlaWdodC8yKSArIHRoaXMueVBhZGRpbmcsXG5cdFx0XHRcdGFmdGVyVGl0bGVJbmRleCA9IGluZGV4LTE7XG5cblx0XHRcdC8vSWYgdGhlIGluZGV4IGlzIHplcm8sIHdlJ3JlIGdldHRpbmcgdGhlIHRpdGxlXG5cdFx0XHRpZiAoaW5kZXggPT09IDApe1xuXHRcdFx0XHRyZXR1cm4gYmFzZUxpbmVIZWlnaHQgKyB0aGlzLnRpdGxlSGVpZ2h0IC8gMztcblx0XHRcdH0gZWxzZXtcblx0XHRcdFx0cmV0dXJuIGJhc2VMaW5lSGVpZ2h0ICsgKCh0aGlzLmZvbnRTaXplICogMS41ICogYWZ0ZXJUaXRsZUluZGV4KSArIHRoaXMuZm9udFNpemUgLyAyKSArIHRoaXMudGl0bGVIZWlnaHQ7XG5cdFx0XHR9XG5cblx0XHR9LFxuXHRcdGRyYXcgOiBmdW5jdGlvbigpe1xuXHRcdFx0Ly8gQ3VzdG9tIFRvb2x0aXBzXG5cdFx0XHRpZih0aGlzLmN1c3RvbSl7XG5cdFx0XHRcdHRoaXMuY3VzdG9tKHRoaXMpO1xuXHRcdFx0fVxuXHRcdFx0ZWxzZXtcblx0XHRcdFx0ZHJhd1JvdW5kZWRSZWN0YW5nbGUodGhpcy5jdHgsdGhpcy54LHRoaXMueSAtIHRoaXMuaGVpZ2h0LzIsdGhpcy53aWR0aCx0aGlzLmhlaWdodCx0aGlzLmNvcm5lclJhZGl1cyk7XG5cdFx0XHRcdHZhciBjdHggPSB0aGlzLmN0eDtcblx0XHRcdFx0Y3R4LmZpbGxTdHlsZSA9IHRoaXMuZmlsbENvbG9yO1xuXHRcdFx0XHRjdHguZmlsbCgpO1xuXHRcdFx0XHRjdHguY2xvc2VQYXRoKCk7XG5cblx0XHRcdFx0Y3R4LnRleHRBbGlnbiA9IFwibGVmdFwiO1xuXHRcdFx0XHRjdHgudGV4dEJhc2VsaW5lID0gXCJtaWRkbGVcIjtcblx0XHRcdFx0Y3R4LmZpbGxTdHlsZSA9IHRoaXMudGl0bGVUZXh0Q29sb3I7XG5cdFx0XHRcdGN0eC5mb250ID0gdGhpcy50aXRsZUZvbnQ7XG5cblx0XHRcdFx0Y3R4LmZpbGxUZXh0KHRoaXMudGl0bGUsdGhpcy54ICsgdGhpcy54UGFkZGluZywgdGhpcy5nZXRMaW5lSGVpZ2h0KDApKTtcblxuXHRcdFx0XHRjdHguZm9udCA9IHRoaXMuZm9udDtcblx0XHRcdFx0aGVscGVycy5lYWNoKHRoaXMubGFiZWxzLGZ1bmN0aW9uKGxhYmVsLGluZGV4KXtcblx0XHRcdFx0XHRjdHguZmlsbFN0eWxlID0gdGhpcy50ZXh0Q29sb3I7XG5cdFx0XHRcdFx0Y3R4LmZpbGxUZXh0KGxhYmVsLHRoaXMueCArIHRoaXMueFBhZGRpbmcgKyB0aGlzLmZvbnRTaXplICsgMywgdGhpcy5nZXRMaW5lSGVpZ2h0KGluZGV4ICsgMSkpO1xuXG5cdFx0XHRcdFx0Ly9BIGJpdCBnbmFybHksIGJ1dCBjbGVhcmluZyB0aGlzIHJlY3RhbmdsZSBicmVha3Mgd2hlbiB1c2luZyBleHBsb3JlcmNhbnZhcyAoY2xlYXJzIHdob2xlIGNhbnZhcylcblx0XHRcdFx0XHQvL2N0eC5jbGVhclJlY3QodGhpcy54ICsgdGhpcy54UGFkZGluZywgdGhpcy5nZXRMaW5lSGVpZ2h0KGluZGV4ICsgMSkgLSB0aGlzLmZvbnRTaXplLzIsIHRoaXMuZm9udFNpemUsIHRoaXMuZm9udFNpemUpO1xuXHRcdFx0XHRcdC8vSW5zdGVhZCB3ZSdsbCBtYWtlIGEgd2hpdGUgZmlsbGVkIGJsb2NrIHRvIHB1dCB0aGUgbGVnZW5kQ29sb3VyIHBhbGV0dGUgb3Zlci5cblxuXHRcdFx0XHRcdGN0eC5maWxsU3R5bGUgPSB0aGlzLmxlZ2VuZENvbG9yQmFja2dyb3VuZDtcblx0XHRcdFx0XHRjdHguZmlsbFJlY3QodGhpcy54ICsgdGhpcy54UGFkZGluZywgdGhpcy5nZXRMaW5lSGVpZ2h0KGluZGV4ICsgMSkgLSB0aGlzLmZvbnRTaXplLzIsIHRoaXMuZm9udFNpemUsIHRoaXMuZm9udFNpemUpO1xuXG5cdFx0XHRcdFx0Y3R4LmZpbGxTdHlsZSA9IHRoaXMubGVnZW5kQ29sb3JzW2luZGV4XS5maWxsO1xuXHRcdFx0XHRcdGN0eC5maWxsUmVjdCh0aGlzLnggKyB0aGlzLnhQYWRkaW5nLCB0aGlzLmdldExpbmVIZWlnaHQoaW5kZXggKyAxKSAtIHRoaXMuZm9udFNpemUvMiwgdGhpcy5mb250U2l6ZSwgdGhpcy5mb250U2l6ZSk7XG5cblxuXHRcdFx0XHR9LHRoaXMpO1xuXHRcdFx0fVxuXHRcdH1cblx0fSk7XG5cblx0Q2hhcnQuU2NhbGUgPSBDaGFydC5FbGVtZW50LmV4dGVuZCh7XG5cdFx0aW5pdGlhbGl6ZSA6IGZ1bmN0aW9uKCl7XG5cdFx0XHR0aGlzLmZpdCgpO1xuXHRcdH0sXG5cdFx0YnVpbGRZTGFiZWxzIDogZnVuY3Rpb24oKXtcblx0XHRcdHRoaXMueUxhYmVscyA9IFtdO1xuXG5cdFx0XHR2YXIgc3RlcERlY2ltYWxQbGFjZXMgPSBnZXREZWNpbWFsUGxhY2VzKHRoaXMuc3RlcFZhbHVlKTtcblxuXHRcdFx0Zm9yICh2YXIgaT0wOyBpPD10aGlzLnN0ZXBzOyBpKyspe1xuXHRcdFx0XHR0aGlzLnlMYWJlbHMucHVzaCh0ZW1wbGF0ZSh0aGlzLnRlbXBsYXRlU3RyaW5nLHt2YWx1ZToodGhpcy5taW4gKyAoaSAqIHRoaXMuc3RlcFZhbHVlKSkudG9GaXhlZChzdGVwRGVjaW1hbFBsYWNlcyl9KSk7XG5cdFx0XHR9XG5cdFx0XHR0aGlzLnlMYWJlbFdpZHRoID0gKHRoaXMuZGlzcGxheSAmJiB0aGlzLnNob3dMYWJlbHMpID8gbG9uZ2VzdFRleHQodGhpcy5jdHgsdGhpcy5mb250LHRoaXMueUxhYmVscykgKyAxMCA6IDA7XG5cdFx0fSxcblx0XHRhZGRYTGFiZWwgOiBmdW5jdGlvbihsYWJlbCl7XG5cdFx0XHR0aGlzLnhMYWJlbHMucHVzaChsYWJlbCk7XG5cdFx0XHR0aGlzLnZhbHVlc0NvdW50Kys7XG5cdFx0XHR0aGlzLmZpdCgpO1xuXHRcdH0sXG5cdFx0cmVtb3ZlWExhYmVsIDogZnVuY3Rpb24oKXtcblx0XHRcdHRoaXMueExhYmVscy5zaGlmdCgpO1xuXHRcdFx0dGhpcy52YWx1ZXNDb3VudC0tO1xuXHRcdFx0dGhpcy5maXQoKTtcblx0XHR9LFxuXHRcdC8vIEZpdHRpbmcgbG9vcCB0byByb3RhdGUgeCBMYWJlbHMgYW5kIGZpZ3VyZSBvdXQgd2hhdCBmaXRzIHRoZXJlLCBhbmQgYWxzbyBjYWxjdWxhdGUgaG93IG1hbnkgWSBzdGVwcyB0byB1c2Vcblx0XHRmaXQ6IGZ1bmN0aW9uKCl7XG5cdFx0XHQvLyBGaXJzdCB3ZSBuZWVkIHRoZSB3aWR0aCBvZiB0aGUgeUxhYmVscywgYXNzdW1pbmcgdGhlIHhMYWJlbHMgYXJlbid0IHJvdGF0ZWRcblxuXHRcdFx0Ly8gVG8gZG8gdGhhdCB3ZSBuZWVkIHRoZSBiYXNlIGxpbmUgYXQgdGhlIHRvcCBhbmQgYmFzZSBvZiB0aGUgY2hhcnQsIGFzc3VtaW5nIHRoZXJlIGlzIG5vIHggbGFiZWwgcm90YXRpb25cblx0XHRcdHRoaXMuc3RhcnRQb2ludCA9ICh0aGlzLmRpc3BsYXkpID8gdGhpcy5mb250U2l6ZSA6IDA7XG5cdFx0XHR0aGlzLmVuZFBvaW50ID0gKHRoaXMuZGlzcGxheSkgPyB0aGlzLmhlaWdodCAtICh0aGlzLmZvbnRTaXplICogMS41KSAtIDUgOiB0aGlzLmhlaWdodDsgLy8gLTUgdG8gcGFkIGxhYmVsc1xuXG5cdFx0XHQvLyBBcHBseSBwYWRkaW5nIHNldHRpbmdzIHRvIHRoZSBzdGFydCBhbmQgZW5kIHBvaW50LlxuXHRcdFx0dGhpcy5zdGFydFBvaW50ICs9IHRoaXMucGFkZGluZztcblx0XHRcdHRoaXMuZW5kUG9pbnQgLT0gdGhpcy5wYWRkaW5nO1xuXG5cdFx0XHQvLyBDYWNoZSB0aGUgc3RhcnRpbmcgZW5kcG9pbnQsIGV4Y2x1ZGluZyB0aGUgc3BhY2UgZm9yIHggbGFiZWxzXG5cdFx0XHR2YXIgY2FjaGVkRW5kUG9pbnQgPSB0aGlzLmVuZFBvaW50O1xuXG5cdFx0XHQvLyBDYWNoZSB0aGUgc3RhcnRpbmcgaGVpZ2h0LCBzbyBjYW4gZGV0ZXJtaW5lIGlmIHdlIG5lZWQgdG8gcmVjYWxjdWxhdGUgdGhlIHNjYWxlIHlBeGlzXG5cdFx0XHR2YXIgY2FjaGVkSGVpZ2h0ID0gdGhpcy5lbmRQb2ludCAtIHRoaXMuc3RhcnRQb2ludCxcblx0XHRcdFx0Y2FjaGVkWUxhYmVsV2lkdGg7XG5cblx0XHRcdC8vIEJ1aWxkIHRoZSBjdXJyZW50IHlMYWJlbHMgc28gd2UgaGF2ZSBhbiBpZGVhIG9mIHdoYXQgc2l6ZSB0aGV5J2xsIGJlIHRvIHN0YXJ0XG5cdFx0XHQvKlxuXHRcdFx0ICpcdFRoaXMgc2V0cyB3aGF0IGlzIHJldHVybmVkIGZyb20gY2FsY3VsYXRlU2NhbGVSYW5nZSBhcyBzdGF0aWMgcHJvcGVydGllcyBvZiB0aGlzIGNsYXNzOlxuXHRcdFx0ICpcblx0XHRcdFx0dGhpcy5zdGVwcztcblx0XHRcdFx0dGhpcy5zdGVwVmFsdWU7XG5cdFx0XHRcdHRoaXMubWluO1xuXHRcdFx0XHR0aGlzLm1heDtcblx0XHRcdCAqXG5cdFx0XHQgKi9cblx0XHRcdHRoaXMuY2FsY3VsYXRlWVJhbmdlKGNhY2hlZEhlaWdodCk7XG5cblx0XHRcdC8vIFdpdGggdGhlc2UgcHJvcGVydGllcyBzZXQgd2UgY2FuIG5vdyBidWlsZCB0aGUgYXJyYXkgb2YgeUxhYmVsc1xuXHRcdFx0Ly8gYW5kIGFsc28gdGhlIHdpZHRoIG9mIHRoZSBsYXJnZXN0IHlMYWJlbFxuXHRcdFx0dGhpcy5idWlsZFlMYWJlbHMoKTtcblxuXHRcdFx0dGhpcy5jYWxjdWxhdGVYTGFiZWxSb3RhdGlvbigpO1xuXG5cdFx0XHR3aGlsZSgoY2FjaGVkSGVpZ2h0ID4gdGhpcy5lbmRQb2ludCAtIHRoaXMuc3RhcnRQb2ludCkpe1xuXHRcdFx0XHRjYWNoZWRIZWlnaHQgPSB0aGlzLmVuZFBvaW50IC0gdGhpcy5zdGFydFBvaW50O1xuXHRcdFx0XHRjYWNoZWRZTGFiZWxXaWR0aCA9IHRoaXMueUxhYmVsV2lkdGg7XG5cblx0XHRcdFx0dGhpcy5jYWxjdWxhdGVZUmFuZ2UoY2FjaGVkSGVpZ2h0KTtcblx0XHRcdFx0dGhpcy5idWlsZFlMYWJlbHMoKTtcblxuXHRcdFx0XHQvLyBPbmx5IGdvIHRocm91Z2ggdGhlIHhMYWJlbCBsb29wIGFnYWluIGlmIHRoZSB5TGFiZWwgd2lkdGggaGFzIGNoYW5nZWRcblx0XHRcdFx0aWYgKGNhY2hlZFlMYWJlbFdpZHRoIDwgdGhpcy55TGFiZWxXaWR0aCl7XG5cdFx0XHRcdFx0dGhpcy5lbmRQb2ludCA9IGNhY2hlZEVuZFBvaW50O1xuXHRcdFx0XHRcdHRoaXMuY2FsY3VsYXRlWExhYmVsUm90YXRpb24oKTtcblx0XHRcdFx0fVxuXHRcdFx0fVxuXG5cdFx0fSxcblx0XHRjYWxjdWxhdGVYTGFiZWxSb3RhdGlvbiA6IGZ1bmN0aW9uKCl7XG5cdFx0XHQvL0dldCB0aGUgd2lkdGggb2YgZWFjaCBncmlkIGJ5IGNhbGN1bGF0aW5nIHRoZSBkaWZmZXJlbmNlXG5cdFx0XHQvL2JldHdlZW4geCBvZmZzZXRzIGJldHdlZW4gMCBhbmQgMS5cblxuXHRcdFx0dGhpcy5jdHguZm9udCA9IHRoaXMuZm9udDtcblxuXHRcdFx0dmFyIGZpcnN0V2lkdGggPSB0aGlzLmN0eC5tZWFzdXJlVGV4dCh0aGlzLnhMYWJlbHNbMF0pLndpZHRoLFxuXHRcdFx0XHRsYXN0V2lkdGggPSB0aGlzLmN0eC5tZWFzdXJlVGV4dCh0aGlzLnhMYWJlbHNbdGhpcy54TGFiZWxzLmxlbmd0aCAtIDFdKS53aWR0aCxcblx0XHRcdFx0Zmlyc3RSb3RhdGVkLFxuXHRcdFx0XHRsYXN0Um90YXRlZDtcblxuXG5cdFx0XHR0aGlzLnhTY2FsZVBhZGRpbmdSaWdodCA9IGxhc3RXaWR0aC8yICsgMztcblx0XHRcdHRoaXMueFNjYWxlUGFkZGluZ0xlZnQgPSAoZmlyc3RXaWR0aC8yID4gdGhpcy55TGFiZWxXaWR0aCkgPyBmaXJzdFdpZHRoLzIgOiB0aGlzLnlMYWJlbFdpZHRoO1xuXG5cdFx0XHR0aGlzLnhMYWJlbFJvdGF0aW9uID0gMDtcblx0XHRcdGlmICh0aGlzLmRpc3BsYXkpe1xuXHRcdFx0XHR2YXIgb3JpZ2luYWxMYWJlbFdpZHRoID0gbG9uZ2VzdFRleHQodGhpcy5jdHgsdGhpcy5mb250LHRoaXMueExhYmVscyksXG5cdFx0XHRcdFx0Y29zUm90YXRpb24sXG5cdFx0XHRcdFx0Zmlyc3RSb3RhdGVkV2lkdGg7XG5cdFx0XHRcdHRoaXMueExhYmVsV2lkdGggPSBvcmlnaW5hbExhYmVsV2lkdGg7XG5cdFx0XHRcdC8vQWxsb3cgMyBwaXhlbHMgeDIgcGFkZGluZyBlaXRoZXIgc2lkZSBmb3IgbGFiZWwgcmVhZGFiaWxpdHlcblx0XHRcdFx0dmFyIHhHcmlkV2lkdGggPSBNYXRoLmZsb29yKHRoaXMuY2FsY3VsYXRlWCgxKSAtIHRoaXMuY2FsY3VsYXRlWCgwKSkgLSA2O1xuXG5cdFx0XHRcdC8vTWF4IGxhYmVsIHJvdGF0ZSBzaG91bGQgYmUgOTAgLSBhbHNvIGFjdCBhcyBhIGxvb3AgY291bnRlclxuXHRcdFx0XHR3aGlsZSAoKHRoaXMueExhYmVsV2lkdGggPiB4R3JpZFdpZHRoICYmIHRoaXMueExhYmVsUm90YXRpb24gPT09IDApIHx8ICh0aGlzLnhMYWJlbFdpZHRoID4geEdyaWRXaWR0aCAmJiB0aGlzLnhMYWJlbFJvdGF0aW9uIDw9IDkwICYmIHRoaXMueExhYmVsUm90YXRpb24gPiAwKSl7XG5cdFx0XHRcdFx0Y29zUm90YXRpb24gPSBNYXRoLmNvcyh0b1JhZGlhbnModGhpcy54TGFiZWxSb3RhdGlvbikpO1xuXG5cdFx0XHRcdFx0Zmlyc3RSb3RhdGVkID0gY29zUm90YXRpb24gKiBmaXJzdFdpZHRoO1xuXHRcdFx0XHRcdGxhc3RSb3RhdGVkID0gY29zUm90YXRpb24gKiBsYXN0V2lkdGg7XG5cblx0XHRcdFx0XHQvLyBXZSdyZSByaWdodCBhbGlnbmluZyB0aGUgdGV4dCBub3cuXG5cdFx0XHRcdFx0aWYgKGZpcnN0Um90YXRlZCArIHRoaXMuZm9udFNpemUgLyAyID4gdGhpcy55TGFiZWxXaWR0aCl7XG5cdFx0XHRcdFx0XHR0aGlzLnhTY2FsZVBhZGRpbmdMZWZ0ID0gZmlyc3RSb3RhdGVkICsgdGhpcy5mb250U2l6ZSAvIDI7XG5cdFx0XHRcdFx0fVxuXHRcdFx0XHRcdHRoaXMueFNjYWxlUGFkZGluZ1JpZ2h0ID0gdGhpcy5mb250U2l6ZS8yO1xuXG5cblx0XHRcdFx0XHR0aGlzLnhMYWJlbFJvdGF0aW9uKys7XG5cdFx0XHRcdFx0dGhpcy54TGFiZWxXaWR0aCA9IGNvc1JvdGF0aW9uICogb3JpZ2luYWxMYWJlbFdpZHRoO1xuXG5cdFx0XHRcdH1cblx0XHRcdFx0aWYgKHRoaXMueExhYmVsUm90YXRpb24gPiAwKXtcblx0XHRcdFx0XHR0aGlzLmVuZFBvaW50IC09IE1hdGguc2luKHRvUmFkaWFucyh0aGlzLnhMYWJlbFJvdGF0aW9uKSkqb3JpZ2luYWxMYWJlbFdpZHRoICsgMztcblx0XHRcdFx0fVxuXHRcdFx0fVxuXHRcdFx0ZWxzZXtcblx0XHRcdFx0dGhpcy54TGFiZWxXaWR0aCA9IDA7XG5cdFx0XHRcdHRoaXMueFNjYWxlUGFkZGluZ1JpZ2h0ID0gdGhpcy5wYWRkaW5nO1xuXHRcdFx0XHR0aGlzLnhTY2FsZVBhZGRpbmdMZWZ0ID0gdGhpcy5wYWRkaW5nO1xuXHRcdFx0fVxuXG5cdFx0fSxcblx0XHQvLyBOZWVkcyB0byBiZSBvdmVyaWRkZW4gaW4gZWFjaCBDaGFydCB0eXBlXG5cdFx0Ly8gT3RoZXJ3aXNlIHdlIG5lZWQgdG8gcGFzcyBhbGwgdGhlIGRhdGEgaW50byB0aGUgc2NhbGUgY2xhc3Ncblx0XHRjYWxjdWxhdGVZUmFuZ2U6IG5vb3AsXG5cdFx0ZHJhd2luZ0FyZWE6IGZ1bmN0aW9uKCl7XG5cdFx0XHRyZXR1cm4gdGhpcy5zdGFydFBvaW50IC0gdGhpcy5lbmRQb2ludDtcblx0XHR9LFxuXHRcdGNhbGN1bGF0ZVkgOiBmdW5jdGlvbih2YWx1ZSl7XG5cdFx0XHR2YXIgc2NhbGluZ0ZhY3RvciA9IHRoaXMuZHJhd2luZ0FyZWEoKSAvICh0aGlzLm1pbiAtIHRoaXMubWF4KTtcblx0XHRcdHJldHVybiB0aGlzLmVuZFBvaW50IC0gKHNjYWxpbmdGYWN0b3IgKiAodmFsdWUgLSB0aGlzLm1pbikpO1xuXHRcdH0sXG5cdFx0Y2FsY3VsYXRlWCA6IGZ1bmN0aW9uKGluZGV4KXtcblx0XHRcdHZhciBpc1JvdGF0ZWQgPSAodGhpcy54TGFiZWxSb3RhdGlvbiA+IDApLFxuXHRcdFx0XHQvLyBpbm5lcldpZHRoID0gKHRoaXMub2Zmc2V0R3JpZExpbmVzKSA/IHRoaXMud2lkdGggLSBvZmZzZXRMZWZ0IC0gdGhpcy5wYWRkaW5nIDogdGhpcy53aWR0aCAtIChvZmZzZXRMZWZ0ICsgaGFsZkxhYmVsV2lkdGggKiAyKSAtIHRoaXMucGFkZGluZyxcblx0XHRcdFx0aW5uZXJXaWR0aCA9IHRoaXMud2lkdGggLSAodGhpcy54U2NhbGVQYWRkaW5nTGVmdCArIHRoaXMueFNjYWxlUGFkZGluZ1JpZ2h0KSxcblx0XHRcdFx0dmFsdWVXaWR0aCA9IGlubmVyV2lkdGgvTWF0aC5tYXgoKHRoaXMudmFsdWVzQ291bnQgLSAoKHRoaXMub2Zmc2V0R3JpZExpbmVzKSA/IDAgOiAxKSksIDEpLFxuXHRcdFx0XHR2YWx1ZU9mZnNldCA9ICh2YWx1ZVdpZHRoICogaW5kZXgpICsgdGhpcy54U2NhbGVQYWRkaW5nTGVmdDtcblxuXHRcdFx0aWYgKHRoaXMub2Zmc2V0R3JpZExpbmVzKXtcblx0XHRcdFx0dmFsdWVPZmZzZXQgKz0gKHZhbHVlV2lkdGgvMik7XG5cdFx0XHR9XG5cblx0XHRcdHJldHVybiBNYXRoLnJvdW5kKHZhbHVlT2Zmc2V0KTtcblx0XHR9LFxuXHRcdHVwZGF0ZSA6IGZ1bmN0aW9uKG5ld1Byb3BzKXtcblx0XHRcdGhlbHBlcnMuZXh0ZW5kKHRoaXMsIG5ld1Byb3BzKTtcblx0XHRcdHRoaXMuZml0KCk7XG5cdFx0fSxcblx0XHRkcmF3IDogZnVuY3Rpb24oKXtcblx0XHRcdHZhciBjdHggPSB0aGlzLmN0eCxcblx0XHRcdFx0eUxhYmVsR2FwID0gKHRoaXMuZW5kUG9pbnQgLSB0aGlzLnN0YXJ0UG9pbnQpIC8gdGhpcy5zdGVwcyxcblx0XHRcdFx0eFN0YXJ0ID0gTWF0aC5yb3VuZCh0aGlzLnhTY2FsZVBhZGRpbmdMZWZ0KTtcblx0XHRcdGlmICh0aGlzLmRpc3BsYXkpe1xuXHRcdFx0XHRjdHguZmlsbFN0eWxlID0gdGhpcy50ZXh0Q29sb3I7XG5cdFx0XHRcdGN0eC5mb250ID0gdGhpcy5mb250O1xuXHRcdFx0XHRlYWNoKHRoaXMueUxhYmVscyxmdW5jdGlvbihsYWJlbFN0cmluZyxpbmRleCl7XG5cdFx0XHRcdFx0dmFyIHlMYWJlbENlbnRlciA9IHRoaXMuZW5kUG9pbnQgLSAoeUxhYmVsR2FwICogaW5kZXgpLFxuXHRcdFx0XHRcdFx0bGluZVBvc2l0aW9uWSA9IE1hdGgucm91bmQoeUxhYmVsQ2VudGVyKSxcblx0XHRcdFx0XHRcdGRyYXdIb3Jpem9udGFsTGluZSA9IHRoaXMuc2hvd0hvcml6b250YWxMaW5lcztcblxuXHRcdFx0XHRcdGN0eC50ZXh0QWxpZ24gPSBcInJpZ2h0XCI7XG5cdFx0XHRcdFx0Y3R4LnRleHRCYXNlbGluZSA9IFwibWlkZGxlXCI7XG5cdFx0XHRcdFx0aWYgKHRoaXMuc2hvd0xhYmVscyl7XG5cdFx0XHRcdFx0XHRjdHguZmlsbFRleHQobGFiZWxTdHJpbmcseFN0YXJ0IC0gMTAseUxhYmVsQ2VudGVyKTtcblx0XHRcdFx0XHR9XG5cblx0XHRcdFx0XHQvLyBUaGlzIGlzIFggYXhpcywgc28gZHJhdyBpdFxuXHRcdFx0XHRcdGlmIChpbmRleCA9PT0gMCAmJiAhZHJhd0hvcml6b250YWxMaW5lKXtcblx0XHRcdFx0XHRcdGRyYXdIb3Jpem9udGFsTGluZSA9IHRydWU7XG5cdFx0XHRcdFx0fVxuXG5cdFx0XHRcdFx0aWYgKGRyYXdIb3Jpem9udGFsTGluZSl7XG5cdFx0XHRcdFx0XHRjdHguYmVnaW5QYXRoKCk7XG5cdFx0XHRcdFx0fVxuXG5cdFx0XHRcdFx0aWYgKGluZGV4ID4gMCl7XG5cdFx0XHRcdFx0XHQvLyBUaGlzIGlzIGEgZ3JpZCBsaW5lIGluIHRoZSBjZW50cmUsIHNvIGRyb3AgdGhhdFxuXHRcdFx0XHRcdFx0Y3R4LmxpbmVXaWR0aCA9IHRoaXMuZ3JpZExpbmVXaWR0aDtcblx0XHRcdFx0XHRcdGN0eC5zdHJva2VTdHlsZSA9IHRoaXMuZ3JpZExpbmVDb2xvcjtcblx0XHRcdFx0XHR9IGVsc2Uge1xuXHRcdFx0XHRcdFx0Ly8gVGhpcyBpcyB0aGUgZmlyc3QgbGluZSBvbiB0aGUgc2NhbGVcblx0XHRcdFx0XHRcdGN0eC5saW5lV2lkdGggPSB0aGlzLmxpbmVXaWR0aDtcblx0XHRcdFx0XHRcdGN0eC5zdHJva2VTdHlsZSA9IHRoaXMubGluZUNvbG9yO1xuXHRcdFx0XHRcdH1cblxuXHRcdFx0XHRcdGxpbmVQb3NpdGlvblkgKz0gaGVscGVycy5hbGlhc1BpeGVsKGN0eC5saW5lV2lkdGgpO1xuXG5cdFx0XHRcdFx0aWYoZHJhd0hvcml6b250YWxMaW5lKXtcblx0XHRcdFx0XHRcdGN0eC5tb3ZlVG8oeFN0YXJ0LCBsaW5lUG9zaXRpb25ZKTtcblx0XHRcdFx0XHRcdGN0eC5saW5lVG8odGhpcy53aWR0aCwgbGluZVBvc2l0aW9uWSk7XG5cdFx0XHRcdFx0XHRjdHguc3Ryb2tlKCk7XG5cdFx0XHRcdFx0XHRjdHguY2xvc2VQYXRoKCk7XG5cdFx0XHRcdFx0fVxuXG5cdFx0XHRcdFx0Y3R4LmxpbmVXaWR0aCA9IHRoaXMubGluZVdpZHRoO1xuXHRcdFx0XHRcdGN0eC5zdHJva2VTdHlsZSA9IHRoaXMubGluZUNvbG9yO1xuXHRcdFx0XHRcdGN0eC5iZWdpblBhdGgoKTtcblx0XHRcdFx0XHRjdHgubW92ZVRvKHhTdGFydCAtIDUsIGxpbmVQb3NpdGlvblkpO1xuXHRcdFx0XHRcdGN0eC5saW5lVG8oeFN0YXJ0LCBsaW5lUG9zaXRpb25ZKTtcblx0XHRcdFx0XHRjdHguc3Ryb2tlKCk7XG5cdFx0XHRcdFx0Y3R4LmNsb3NlUGF0aCgpO1xuXG5cdFx0XHRcdH0sdGhpcyk7XG5cblx0XHRcdFx0ZWFjaCh0aGlzLnhMYWJlbHMsZnVuY3Rpb24obGFiZWwsaW5kZXgpe1xuXHRcdFx0XHRcdHZhciB4UG9zID0gdGhpcy5jYWxjdWxhdGVYKGluZGV4KSArIGFsaWFzUGl4ZWwodGhpcy5saW5lV2lkdGgpLFxuXHRcdFx0XHRcdFx0Ly8gQ2hlY2sgdG8gc2VlIGlmIGxpbmUvYmFyIGhlcmUgYW5kIGRlY2lkZSB3aGVyZSB0byBwbGFjZSB0aGUgbGluZVxuXHRcdFx0XHRcdFx0bGluZVBvcyA9IHRoaXMuY2FsY3VsYXRlWChpbmRleCAtICh0aGlzLm9mZnNldEdyaWRMaW5lcyA/IDAuNSA6IDApKSArIGFsaWFzUGl4ZWwodGhpcy5saW5lV2lkdGgpLFxuXHRcdFx0XHRcdFx0aXNSb3RhdGVkID0gKHRoaXMueExhYmVsUm90YXRpb24gPiAwKSxcblx0XHRcdFx0XHRcdGRyYXdWZXJ0aWNhbExpbmUgPSB0aGlzLnNob3dWZXJ0aWNhbExpbmVzO1xuXG5cdFx0XHRcdFx0Ly8gVGhpcyBpcyBZIGF4aXMsIHNvIGRyYXcgaXRcblx0XHRcdFx0XHRpZiAoaW5kZXggPT09IDAgJiYgIWRyYXdWZXJ0aWNhbExpbmUpe1xuXHRcdFx0XHRcdFx0ZHJhd1ZlcnRpY2FsTGluZSA9IHRydWU7XG5cdFx0XHRcdFx0fVxuXG5cdFx0XHRcdFx0aWYgKGRyYXdWZXJ0aWNhbExpbmUpe1xuXHRcdFx0XHRcdFx0Y3R4LmJlZ2luUGF0aCgpO1xuXHRcdFx0XHRcdH1cblxuXHRcdFx0XHRcdGlmIChpbmRleCA+IDApe1xuXHRcdFx0XHRcdFx0Ly8gVGhpcyBpcyBhIGdyaWQgbGluZSBpbiB0aGUgY2VudHJlLCBzbyBkcm9wIHRoYXRcblx0XHRcdFx0XHRcdGN0eC5saW5lV2lkdGggPSB0aGlzLmdyaWRMaW5lV2lkdGg7XG5cdFx0XHRcdFx0XHRjdHguc3Ryb2tlU3R5bGUgPSB0aGlzLmdyaWRMaW5lQ29sb3I7XG5cdFx0XHRcdFx0fSBlbHNlIHtcblx0XHRcdFx0XHRcdC8vIFRoaXMgaXMgdGhlIGZpcnN0IGxpbmUgb24gdGhlIHNjYWxlXG5cdFx0XHRcdFx0XHRjdHgubGluZVdpZHRoID0gdGhpcy5saW5lV2lkdGg7XG5cdFx0XHRcdFx0XHRjdHguc3Ryb2tlU3R5bGUgPSB0aGlzLmxpbmVDb2xvcjtcblx0XHRcdFx0XHR9XG5cblx0XHRcdFx0XHRpZiAoZHJhd1ZlcnRpY2FsTGluZSl7XG5cdFx0XHRcdFx0XHRjdHgubW92ZVRvKGxpbmVQb3MsdGhpcy5lbmRQb2ludCk7XG5cdFx0XHRcdFx0XHRjdHgubGluZVRvKGxpbmVQb3MsdGhpcy5zdGFydFBvaW50IC0gMyk7XG5cdFx0XHRcdFx0XHRjdHguc3Ryb2tlKCk7XG5cdFx0XHRcdFx0XHRjdHguY2xvc2VQYXRoKCk7XG5cdFx0XHRcdFx0fVxuXG5cblx0XHRcdFx0XHRjdHgubGluZVdpZHRoID0gdGhpcy5saW5lV2lkdGg7XG5cdFx0XHRcdFx0Y3R4LnN0cm9rZVN0eWxlID0gdGhpcy5saW5lQ29sb3I7XG5cblxuXHRcdFx0XHRcdC8vIFNtYWxsIGxpbmVzIGF0IHRoZSBib3R0b20gb2YgdGhlIGJhc2UgZ3JpZCBsaW5lXG5cdFx0XHRcdFx0Y3R4LmJlZ2luUGF0aCgpO1xuXHRcdFx0XHRcdGN0eC5tb3ZlVG8obGluZVBvcyx0aGlzLmVuZFBvaW50KTtcblx0XHRcdFx0XHRjdHgubGluZVRvKGxpbmVQb3MsdGhpcy5lbmRQb2ludCArIDUpO1xuXHRcdFx0XHRcdGN0eC5zdHJva2UoKTtcblx0XHRcdFx0XHRjdHguY2xvc2VQYXRoKCk7XG5cblx0XHRcdFx0XHRjdHguc2F2ZSgpO1xuXHRcdFx0XHRcdGN0eC50cmFuc2xhdGUoeFBvcywoaXNSb3RhdGVkKSA/IHRoaXMuZW5kUG9pbnQgKyAxMiA6IHRoaXMuZW5kUG9pbnQgKyA4KTtcblx0XHRcdFx0XHRjdHgucm90YXRlKHRvUmFkaWFucyh0aGlzLnhMYWJlbFJvdGF0aW9uKSotMSk7XG5cdFx0XHRcdFx0Y3R4LmZvbnQgPSB0aGlzLmZvbnQ7XG5cdFx0XHRcdFx0Y3R4LnRleHRBbGlnbiA9IChpc1JvdGF0ZWQpID8gXCJyaWdodFwiIDogXCJjZW50ZXJcIjtcblx0XHRcdFx0XHRjdHgudGV4dEJhc2VsaW5lID0gKGlzUm90YXRlZCkgPyBcIm1pZGRsZVwiIDogXCJ0b3BcIjtcblx0XHRcdFx0XHRjdHguZmlsbFRleHQobGFiZWwsIDAsIDApO1xuXHRcdFx0XHRcdGN0eC5yZXN0b3JlKCk7XG5cdFx0XHRcdH0sdGhpcyk7XG5cblx0XHRcdH1cblx0XHR9XG5cblx0fSk7XG5cblx0Q2hhcnQuUmFkaWFsU2NhbGUgPSBDaGFydC5FbGVtZW50LmV4dGVuZCh7XG5cdFx0aW5pdGlhbGl6ZTogZnVuY3Rpb24oKXtcblx0XHRcdHRoaXMuc2l6ZSA9IG1pbihbdGhpcy5oZWlnaHQsIHRoaXMud2lkdGhdKTtcblx0XHRcdHRoaXMuZHJhd2luZ0FyZWEgPSAodGhpcy5kaXNwbGF5KSA/ICh0aGlzLnNpemUvMikgLSAodGhpcy5mb250U2l6ZS8yICsgdGhpcy5iYWNrZHJvcFBhZGRpbmdZKSA6ICh0aGlzLnNpemUvMik7XG5cdFx0fSxcblx0XHRjYWxjdWxhdGVDZW50ZXJPZmZzZXQ6IGZ1bmN0aW9uKHZhbHVlKXtcblx0XHRcdC8vIFRha2UgaW50byBhY2NvdW50IGhhbGYgZm9udCBzaXplICsgdGhlIHlQYWRkaW5nIG9mIHRoZSB0b3AgdmFsdWVcblx0XHRcdHZhciBzY2FsaW5nRmFjdG9yID0gdGhpcy5kcmF3aW5nQXJlYSAvICh0aGlzLm1heCAtIHRoaXMubWluKTtcblxuXHRcdFx0cmV0dXJuICh2YWx1ZSAtIHRoaXMubWluKSAqIHNjYWxpbmdGYWN0b3I7XG5cdFx0fSxcblx0XHR1cGRhdGUgOiBmdW5jdGlvbigpe1xuXHRcdFx0aWYgKCF0aGlzLmxpbmVBcmMpe1xuXHRcdFx0XHR0aGlzLnNldFNjYWxlU2l6ZSgpO1xuXHRcdFx0fSBlbHNlIHtcblx0XHRcdFx0dGhpcy5kcmF3aW5nQXJlYSA9ICh0aGlzLmRpc3BsYXkpID8gKHRoaXMuc2l6ZS8yKSAtICh0aGlzLmZvbnRTaXplLzIgKyB0aGlzLmJhY2tkcm9wUGFkZGluZ1kpIDogKHRoaXMuc2l6ZS8yKTtcblx0XHRcdH1cblx0XHRcdHRoaXMuYnVpbGRZTGFiZWxzKCk7XG5cdFx0fSxcblx0XHRidWlsZFlMYWJlbHM6IGZ1bmN0aW9uKCl7XG5cdFx0XHR0aGlzLnlMYWJlbHMgPSBbXTtcblxuXHRcdFx0dmFyIHN0ZXBEZWNpbWFsUGxhY2VzID0gZ2V0RGVjaW1hbFBsYWNlcyh0aGlzLnN0ZXBWYWx1ZSk7XG5cblx0XHRcdGZvciAodmFyIGk9MDsgaTw9dGhpcy5zdGVwczsgaSsrKXtcblx0XHRcdFx0dGhpcy55TGFiZWxzLnB1c2godGVtcGxhdGUodGhpcy50ZW1wbGF0ZVN0cmluZyx7dmFsdWU6KHRoaXMubWluICsgKGkgKiB0aGlzLnN0ZXBWYWx1ZSkpLnRvRml4ZWQoc3RlcERlY2ltYWxQbGFjZXMpfSkpO1xuXHRcdFx0fVxuXHRcdH0sXG5cdFx0Z2V0Q2lyY3VtZmVyZW5jZSA6IGZ1bmN0aW9uKCl7XG5cdFx0XHRyZXR1cm4gKChNYXRoLlBJKjIpIC8gdGhpcy52YWx1ZXNDb3VudCk7XG5cdFx0fSxcblx0XHRzZXRTY2FsZVNpemU6IGZ1bmN0aW9uKCl7XG5cdFx0XHQvKlxuXHRcdFx0ICogUmlnaHQsIHRoaXMgaXMgcmVhbGx5IGNvbmZ1c2luZyBhbmQgdGhlcmUgaXMgYSBsb3Qgb2YgbWF0aHMgZ29pbmcgb24gaGVyZVxuXHRcdFx0ICogVGhlIGdpc3Qgb2YgdGhlIHByb2JsZW0gaXMgaGVyZTogaHR0cHM6Ly9naXN0LmdpdGh1Yi5jb20vbm5uaWNrLzY5NmNjOWM1NWY0YjBiZWI4ZmU5XG5cdFx0XHQgKlxuXHRcdFx0ICogUmVhY3Rpb246IGh0dHBzOi8vZGwuZHJvcGJveHVzZXJjb250ZW50LmNvbS91LzM0NjAxMzYzL3Rvb211Y2hzY2llbmNlLmdpZlxuXHRcdFx0ICpcblx0XHRcdCAqIFNvbHV0aW9uOlxuXHRcdFx0ICpcblx0XHRcdCAqIFdlIGFzc3VtZSB0aGUgcmFkaXVzIG9mIHRoZSBwb2x5Z29uIGlzIGhhbGYgdGhlIHNpemUgb2YgdGhlIGNhbnZhcyBhdCBmaXJzdFxuXHRcdFx0ICogYXQgZWFjaCBpbmRleCB3ZSBjaGVjayBpZiB0aGUgdGV4dCBvdmVybGFwcy5cblx0XHRcdCAqXG5cdFx0XHQgKiBXaGVyZSBpdCBkb2VzLCB3ZSBzdG9yZSB0aGF0IGFuZ2xlIGFuZCB0aGF0IGluZGV4LlxuXHRcdFx0ICpcblx0XHRcdCAqIEFmdGVyIGZpbmRpbmcgdGhlIGxhcmdlc3QgaW5kZXggYW5kIGFuZ2xlIHdlIGNhbGN1bGF0ZSBob3cgbXVjaCB3ZSBuZWVkIHRvIHJlbW92ZVxuXHRcdFx0ICogZnJvbSB0aGUgc2hhcGUgcmFkaXVzIHRvIG1vdmUgdGhlIHBvaW50IGlud2FyZHMgYnkgdGhhdCB4LlxuXHRcdFx0ICpcblx0XHRcdCAqIFdlIGF2ZXJhZ2UgdGhlIGxlZnQgYW5kIHJpZ2h0IGRpc3RhbmNlcyB0byBnZXQgdGhlIG1heGltdW0gc2hhcGUgcmFkaXVzIHRoYXQgY2FuIGZpdCBpbiB0aGUgYm94XG5cdFx0XHQgKiBhbG9uZyB3aXRoIGxhYmVscy5cblx0XHRcdCAqXG5cdFx0XHQgKiBPbmNlIHdlIGhhdmUgdGhhdCwgd2UgY2FuIGZpbmQgdGhlIGNlbnRyZSBwb2ludCBmb3IgdGhlIGNoYXJ0LCBieSB0YWtpbmcgdGhlIHggdGV4dCBwcm90cnVzaW9uXG5cdFx0XHQgKiBvbiBlYWNoIHNpZGUsIHJlbW92aW5nIHRoYXQgZnJvbSB0aGUgc2l6ZSwgaGFsdmluZyBpdCBhbmQgYWRkaW5nIHRoZSBsZWZ0IHggcHJvdHJ1c2lvbiB3aWR0aC5cblx0XHRcdCAqXG5cdFx0XHQgKiBUaGlzIHdpbGwgbWVhbiB3ZSBoYXZlIGEgc2hhcGUgZml0dGVkIHRvIHRoZSBjYW52YXMsIGFzIGxhcmdlIGFzIGl0IGNhbiBiZSB3aXRoIHRoZSBsYWJlbHNcblx0XHRcdCAqIGFuZCBwb3NpdGlvbiBpdCBpbiB0aGUgbW9zdCBzcGFjZSBlZmZpY2llbnQgbWFubmVyXG5cdFx0XHQgKlxuXHRcdFx0ICogaHR0cHM6Ly9kbC5kcm9wYm94dXNlcmNvbnRlbnQuY29tL3UvMzQ2MDEzNjMveWVhaHNjaWVuY2UuZ2lmXG5cdFx0XHQgKi9cblxuXG5cdFx0XHQvLyBHZXQgbWF4aW11bSByYWRpdXMgb2YgdGhlIHBvbHlnb24uIEVpdGhlciBoYWxmIHRoZSBoZWlnaHQgKG1pbnVzIHRoZSB0ZXh0IHdpZHRoKSBvciBoYWxmIHRoZSB3aWR0aC5cblx0XHRcdC8vIFVzZSB0aGlzIHRvIGNhbGN1bGF0ZSB0aGUgb2Zmc2V0ICsgY2hhbmdlLiAtIE1ha2Ugc3VyZSBML1IgcHJvdHJ1c2lvbiBpcyBhdCBsZWFzdCAwIHRvIHN0b3AgaXNzdWVzIHdpdGggY2VudHJlIHBvaW50c1xuXHRcdFx0dmFyIGxhcmdlc3RQb3NzaWJsZVJhZGl1cyA9IG1pbihbKHRoaXMuaGVpZ2h0LzIgLSB0aGlzLnBvaW50TGFiZWxGb250U2l6ZSAtIDUpLCB0aGlzLndpZHRoLzJdKSxcblx0XHRcdFx0cG9pbnRQb3NpdGlvbixcblx0XHRcdFx0aSxcblx0XHRcdFx0dGV4dFdpZHRoLFxuXHRcdFx0XHRoYWxmVGV4dFdpZHRoLFxuXHRcdFx0XHRmdXJ0aGVzdFJpZ2h0ID0gdGhpcy53aWR0aCxcblx0XHRcdFx0ZnVydGhlc3RSaWdodEluZGV4LFxuXHRcdFx0XHRmdXJ0aGVzdFJpZ2h0QW5nbGUsXG5cdFx0XHRcdGZ1cnRoZXN0TGVmdCA9IDAsXG5cdFx0XHRcdGZ1cnRoZXN0TGVmdEluZGV4LFxuXHRcdFx0XHRmdXJ0aGVzdExlZnRBbmdsZSxcblx0XHRcdFx0eFByb3RydXNpb25MZWZ0LFxuXHRcdFx0XHR4UHJvdHJ1c2lvblJpZ2h0LFxuXHRcdFx0XHRyYWRpdXNSZWR1Y3Rpb25SaWdodCxcblx0XHRcdFx0cmFkaXVzUmVkdWN0aW9uTGVmdCxcblx0XHRcdFx0bWF4V2lkdGhSYWRpdXM7XG5cdFx0XHR0aGlzLmN0eC5mb250ID0gZm9udFN0cmluZyh0aGlzLnBvaW50TGFiZWxGb250U2l6ZSx0aGlzLnBvaW50TGFiZWxGb250U3R5bGUsdGhpcy5wb2ludExhYmVsRm9udEZhbWlseSk7XG5cdFx0XHRmb3IgKGk9MDtpPHRoaXMudmFsdWVzQ291bnQ7aSsrKXtcblx0XHRcdFx0Ly8gNXB4IHRvIHNwYWNlIHRoZSB0ZXh0IHNsaWdodGx5IG91dCAtIHNpbWlsYXIgdG8gd2hhdCB3ZSBkbyBpbiB0aGUgZHJhdyBmdW5jdGlvbi5cblx0XHRcdFx0cG9pbnRQb3NpdGlvbiA9IHRoaXMuZ2V0UG9pbnRQb3NpdGlvbihpLCBsYXJnZXN0UG9zc2libGVSYWRpdXMpO1xuXHRcdFx0XHR0ZXh0V2lkdGggPSB0aGlzLmN0eC5tZWFzdXJlVGV4dCh0ZW1wbGF0ZSh0aGlzLnRlbXBsYXRlU3RyaW5nLCB7IHZhbHVlOiB0aGlzLmxhYmVsc1tpXSB9KSkud2lkdGggKyA1O1xuXHRcdFx0XHRpZiAoaSA9PT0gMCB8fCBpID09PSB0aGlzLnZhbHVlc0NvdW50LzIpe1xuXHRcdFx0XHRcdC8vIElmIHdlJ3JlIGF0IGluZGV4IHplcm8sIG9yIGV4YWN0bHkgdGhlIG1pZGRsZSwgd2UncmUgYXQgZXhhY3RseSB0aGUgdG9wL2JvdHRvbVxuXHRcdFx0XHRcdC8vIG9mIHRoZSByYWRhciBjaGFydCwgc28gdGV4dCB3aWxsIGJlIGFsaWduZWQgY2VudHJhbGx5LCBzbyB3ZSdsbCBoYWxmIGl0IGFuZCBjb21wYXJlXG5cdFx0XHRcdFx0Ly8gdy9sZWZ0IGFuZCByaWdodCB0ZXh0IHNpemVzXG5cdFx0XHRcdFx0aGFsZlRleHRXaWR0aCA9IHRleHRXaWR0aC8yO1xuXHRcdFx0XHRcdGlmIChwb2ludFBvc2l0aW9uLnggKyBoYWxmVGV4dFdpZHRoID4gZnVydGhlc3RSaWdodCkge1xuXHRcdFx0XHRcdFx0ZnVydGhlc3RSaWdodCA9IHBvaW50UG9zaXRpb24ueCArIGhhbGZUZXh0V2lkdGg7XG5cdFx0XHRcdFx0XHRmdXJ0aGVzdFJpZ2h0SW5kZXggPSBpO1xuXHRcdFx0XHRcdH1cblx0XHRcdFx0XHRpZiAocG9pbnRQb3NpdGlvbi54IC0gaGFsZlRleHRXaWR0aCA8IGZ1cnRoZXN0TGVmdCkge1xuXHRcdFx0XHRcdFx0ZnVydGhlc3RMZWZ0ID0gcG9pbnRQb3NpdGlvbi54IC0gaGFsZlRleHRXaWR0aDtcblx0XHRcdFx0XHRcdGZ1cnRoZXN0TGVmdEluZGV4ID0gaTtcblx0XHRcdFx0XHR9XG5cdFx0XHRcdH1cblx0XHRcdFx0ZWxzZSBpZiAoaSA8IHRoaXMudmFsdWVzQ291bnQvMikge1xuXHRcdFx0XHRcdC8vIExlc3MgdGhhbiBoYWxmIHRoZSB2YWx1ZXMgbWVhbnMgd2UnbGwgbGVmdCBhbGlnbiB0aGUgdGV4dFxuXHRcdFx0XHRcdGlmIChwb2ludFBvc2l0aW9uLnggKyB0ZXh0V2lkdGggPiBmdXJ0aGVzdFJpZ2h0KSB7XG5cdFx0XHRcdFx0XHRmdXJ0aGVzdFJpZ2h0ID0gcG9pbnRQb3NpdGlvbi54ICsgdGV4dFdpZHRoO1xuXHRcdFx0XHRcdFx0ZnVydGhlc3RSaWdodEluZGV4ID0gaTtcblx0XHRcdFx0XHR9XG5cdFx0XHRcdH1cblx0XHRcdFx0ZWxzZSBpZiAoaSA+IHRoaXMudmFsdWVzQ291bnQvMil7XG5cdFx0XHRcdFx0Ly8gTW9yZSB0aGFuIGhhbGYgdGhlIHZhbHVlcyBtZWFucyB3ZSdsbCByaWdodCBhbGlnbiB0aGUgdGV4dFxuXHRcdFx0XHRcdGlmIChwb2ludFBvc2l0aW9uLnggLSB0ZXh0V2lkdGggPCBmdXJ0aGVzdExlZnQpIHtcblx0XHRcdFx0XHRcdGZ1cnRoZXN0TGVmdCA9IHBvaW50UG9zaXRpb24ueCAtIHRleHRXaWR0aDtcblx0XHRcdFx0XHRcdGZ1cnRoZXN0TGVmdEluZGV4ID0gaTtcblx0XHRcdFx0XHR9XG5cdFx0XHRcdH1cblx0XHRcdH1cblxuXHRcdFx0eFByb3RydXNpb25MZWZ0ID0gZnVydGhlc3RMZWZ0O1xuXG5cdFx0XHR4UHJvdHJ1c2lvblJpZ2h0ID0gTWF0aC5jZWlsKGZ1cnRoZXN0UmlnaHQgLSB0aGlzLndpZHRoKTtcblxuXHRcdFx0ZnVydGhlc3RSaWdodEFuZ2xlID0gdGhpcy5nZXRJbmRleEFuZ2xlKGZ1cnRoZXN0UmlnaHRJbmRleCk7XG5cblx0XHRcdGZ1cnRoZXN0TGVmdEFuZ2xlID0gdGhpcy5nZXRJbmRleEFuZ2xlKGZ1cnRoZXN0TGVmdEluZGV4KTtcblxuXHRcdFx0cmFkaXVzUmVkdWN0aW9uUmlnaHQgPSB4UHJvdHJ1c2lvblJpZ2h0IC8gTWF0aC5zaW4oZnVydGhlc3RSaWdodEFuZ2xlICsgTWF0aC5QSS8yKTtcblxuXHRcdFx0cmFkaXVzUmVkdWN0aW9uTGVmdCA9IHhQcm90cnVzaW9uTGVmdCAvIE1hdGguc2luKGZ1cnRoZXN0TGVmdEFuZ2xlICsgTWF0aC5QSS8yKTtcblxuXHRcdFx0Ly8gRW5zdXJlIHdlIGFjdHVhbGx5IG5lZWQgdG8gcmVkdWNlIHRoZSBzaXplIG9mIHRoZSBjaGFydFxuXHRcdFx0cmFkaXVzUmVkdWN0aW9uUmlnaHQgPSAoaXNOdW1iZXIocmFkaXVzUmVkdWN0aW9uUmlnaHQpKSA/IHJhZGl1c1JlZHVjdGlvblJpZ2h0IDogMDtcblx0XHRcdHJhZGl1c1JlZHVjdGlvbkxlZnQgPSAoaXNOdW1iZXIocmFkaXVzUmVkdWN0aW9uTGVmdCkpID8gcmFkaXVzUmVkdWN0aW9uTGVmdCA6IDA7XG5cblx0XHRcdHRoaXMuZHJhd2luZ0FyZWEgPSBsYXJnZXN0UG9zc2libGVSYWRpdXMgLSAocmFkaXVzUmVkdWN0aW9uTGVmdCArIHJhZGl1c1JlZHVjdGlvblJpZ2h0KS8yO1xuXG5cdFx0XHQvL3RoaXMuZHJhd2luZ0FyZWEgPSBtaW4oW21heFdpZHRoUmFkaXVzLCAodGhpcy5oZWlnaHQgLSAoMiAqICh0aGlzLnBvaW50TGFiZWxGb250U2l6ZSArIDUpKSkvMl0pXG5cdFx0XHR0aGlzLnNldENlbnRlclBvaW50KHJhZGl1c1JlZHVjdGlvbkxlZnQsIHJhZGl1c1JlZHVjdGlvblJpZ2h0KTtcblxuXHRcdH0sXG5cdFx0c2V0Q2VudGVyUG9pbnQ6IGZ1bmN0aW9uKGxlZnRNb3ZlbWVudCwgcmlnaHRNb3ZlbWVudCl7XG5cblx0XHRcdHZhciBtYXhSaWdodCA9IHRoaXMud2lkdGggLSByaWdodE1vdmVtZW50IC0gdGhpcy5kcmF3aW5nQXJlYSxcblx0XHRcdFx0bWF4TGVmdCA9IGxlZnRNb3ZlbWVudCArIHRoaXMuZHJhd2luZ0FyZWE7XG5cblx0XHRcdHRoaXMueENlbnRlciA9IChtYXhMZWZ0ICsgbWF4UmlnaHQpLzI7XG5cdFx0XHQvLyBBbHdheXMgdmVydGljYWxseSBpbiB0aGUgY2VudHJlIGFzIHRoZSB0ZXh0IGhlaWdodCBkb2Vzbid0IGNoYW5nZVxuXHRcdFx0dGhpcy55Q2VudGVyID0gKHRoaXMuaGVpZ2h0LzIpO1xuXHRcdH0sXG5cblx0XHRnZXRJbmRleEFuZ2xlIDogZnVuY3Rpb24oaW5kZXgpe1xuXHRcdFx0dmFyIGFuZ2xlTXVsdGlwbGllciA9IChNYXRoLlBJICogMikgLyB0aGlzLnZhbHVlc0NvdW50O1xuXHRcdFx0Ly8gU3RhcnQgZnJvbSB0aGUgdG9wIGluc3RlYWQgb2YgcmlnaHQsIHNvIHJlbW92ZSBhIHF1YXJ0ZXIgb2YgdGhlIGNpcmNsZVxuXG5cdFx0XHRyZXR1cm4gaW5kZXggKiBhbmdsZU11bHRpcGxpZXIgLSAoTWF0aC5QSS8yKTtcblx0XHR9LFxuXHRcdGdldFBvaW50UG9zaXRpb24gOiBmdW5jdGlvbihpbmRleCwgZGlzdGFuY2VGcm9tQ2VudGVyKXtcblx0XHRcdHZhciB0aGlzQW5nbGUgPSB0aGlzLmdldEluZGV4QW5nbGUoaW5kZXgpO1xuXHRcdFx0cmV0dXJuIHtcblx0XHRcdFx0eCA6IChNYXRoLmNvcyh0aGlzQW5nbGUpICogZGlzdGFuY2VGcm9tQ2VudGVyKSArIHRoaXMueENlbnRlcixcblx0XHRcdFx0eSA6IChNYXRoLnNpbih0aGlzQW5nbGUpICogZGlzdGFuY2VGcm9tQ2VudGVyKSArIHRoaXMueUNlbnRlclxuXHRcdFx0fTtcblx0XHR9LFxuXHRcdGRyYXc6IGZ1bmN0aW9uKCl7XG5cdFx0XHRpZiAodGhpcy5kaXNwbGF5KXtcblx0XHRcdFx0dmFyIGN0eCA9IHRoaXMuY3R4O1xuXHRcdFx0XHRlYWNoKHRoaXMueUxhYmVscywgZnVuY3Rpb24obGFiZWwsIGluZGV4KXtcblx0XHRcdFx0XHQvLyBEb24ndCBkcmF3IGEgY2VudHJlIHZhbHVlXG5cdFx0XHRcdFx0aWYgKGluZGV4ID4gMCl7XG5cdFx0XHRcdFx0XHR2YXIgeUNlbnRlck9mZnNldCA9IGluZGV4ICogKHRoaXMuZHJhd2luZ0FyZWEvdGhpcy5zdGVwcyksXG5cdFx0XHRcdFx0XHRcdHlIZWlnaHQgPSB0aGlzLnlDZW50ZXIgLSB5Q2VudGVyT2Zmc2V0LFxuXHRcdFx0XHRcdFx0XHRwb2ludFBvc2l0aW9uO1xuXG5cdFx0XHRcdFx0XHQvLyBEcmF3IGNpcmN1bGFyIGxpbmVzIGFyb3VuZCB0aGUgc2NhbGVcblx0XHRcdFx0XHRcdGlmICh0aGlzLmxpbmVXaWR0aCA+IDApe1xuXHRcdFx0XHRcdFx0XHRjdHguc3Ryb2tlU3R5bGUgPSB0aGlzLmxpbmVDb2xvcjtcblx0XHRcdFx0XHRcdFx0Y3R4LmxpbmVXaWR0aCA9IHRoaXMubGluZVdpZHRoO1xuXG5cdFx0XHRcdFx0XHRcdGlmKHRoaXMubGluZUFyYyl7XG5cdFx0XHRcdFx0XHRcdFx0Y3R4LmJlZ2luUGF0aCgpO1xuXHRcdFx0XHRcdFx0XHRcdGN0eC5hcmModGhpcy54Q2VudGVyLCB0aGlzLnlDZW50ZXIsIHlDZW50ZXJPZmZzZXQsIDAsIE1hdGguUEkqMik7XG5cdFx0XHRcdFx0XHRcdFx0Y3R4LmNsb3NlUGF0aCgpO1xuXHRcdFx0XHRcdFx0XHRcdGN0eC5zdHJva2UoKTtcblx0XHRcdFx0XHRcdFx0fSBlbHNle1xuXHRcdFx0XHRcdFx0XHRcdGN0eC5iZWdpblBhdGgoKTtcblx0XHRcdFx0XHRcdFx0XHRmb3IgKHZhciBpPTA7aTx0aGlzLnZhbHVlc0NvdW50O2krKylcblx0XHRcdFx0XHRcdFx0XHR7XG5cdFx0XHRcdFx0XHRcdFx0XHRwb2ludFBvc2l0aW9uID0gdGhpcy5nZXRQb2ludFBvc2l0aW9uKGksIHRoaXMuY2FsY3VsYXRlQ2VudGVyT2Zmc2V0KHRoaXMubWluICsgKGluZGV4ICogdGhpcy5zdGVwVmFsdWUpKSk7XG5cdFx0XHRcdFx0XHRcdFx0XHRpZiAoaSA9PT0gMCl7XG5cdFx0XHRcdFx0XHRcdFx0XHRcdGN0eC5tb3ZlVG8ocG9pbnRQb3NpdGlvbi54LCBwb2ludFBvc2l0aW9uLnkpO1xuXHRcdFx0XHRcdFx0XHRcdFx0fSBlbHNlIHtcblx0XHRcdFx0XHRcdFx0XHRcdFx0Y3R4LmxpbmVUbyhwb2ludFBvc2l0aW9uLngsIHBvaW50UG9zaXRpb24ueSk7XG5cdFx0XHRcdFx0XHRcdFx0XHR9XG5cdFx0XHRcdFx0XHRcdFx0fVxuXHRcdFx0XHRcdFx0XHRcdGN0eC5jbG9zZVBhdGgoKTtcblx0XHRcdFx0XHRcdFx0XHRjdHguc3Ryb2tlKCk7XG5cdFx0XHRcdFx0XHRcdH1cblx0XHRcdFx0XHRcdH1cblx0XHRcdFx0XHRcdGlmKHRoaXMuc2hvd0xhYmVscyl7XG5cdFx0XHRcdFx0XHRcdGN0eC5mb250ID0gZm9udFN0cmluZyh0aGlzLmZvbnRTaXplLHRoaXMuZm9udFN0eWxlLHRoaXMuZm9udEZhbWlseSk7XG5cdFx0XHRcdFx0XHRcdGlmICh0aGlzLnNob3dMYWJlbEJhY2tkcm9wKXtcblx0XHRcdFx0XHRcdFx0XHR2YXIgbGFiZWxXaWR0aCA9IGN0eC5tZWFzdXJlVGV4dChsYWJlbCkud2lkdGg7XG5cdFx0XHRcdFx0XHRcdFx0Y3R4LmZpbGxTdHlsZSA9IHRoaXMuYmFja2Ryb3BDb2xvcjtcblx0XHRcdFx0XHRcdFx0XHRjdHguZmlsbFJlY3QoXG5cdFx0XHRcdFx0XHRcdFx0XHR0aGlzLnhDZW50ZXIgLSBsYWJlbFdpZHRoLzIgLSB0aGlzLmJhY2tkcm9wUGFkZGluZ1gsXG5cdFx0XHRcdFx0XHRcdFx0XHR5SGVpZ2h0IC0gdGhpcy5mb250U2l6ZS8yIC0gdGhpcy5iYWNrZHJvcFBhZGRpbmdZLFxuXHRcdFx0XHRcdFx0XHRcdFx0bGFiZWxXaWR0aCArIHRoaXMuYmFja2Ryb3BQYWRkaW5nWCoyLFxuXHRcdFx0XHRcdFx0XHRcdFx0dGhpcy5mb250U2l6ZSArIHRoaXMuYmFja2Ryb3BQYWRkaW5nWSoyXG5cdFx0XHRcdFx0XHRcdFx0KTtcblx0XHRcdFx0XHRcdFx0fVxuXHRcdFx0XHRcdFx0XHRjdHgudGV4dEFsaWduID0gJ2NlbnRlcic7XG5cdFx0XHRcdFx0XHRcdGN0eC50ZXh0QmFzZWxpbmUgPSBcIm1pZGRsZVwiO1xuXHRcdFx0XHRcdFx0XHRjdHguZmlsbFN0eWxlID0gdGhpcy5mb250Q29sb3I7XG5cdFx0XHRcdFx0XHRcdGN0eC5maWxsVGV4dChsYWJlbCwgdGhpcy54Q2VudGVyLCB5SGVpZ2h0KTtcblx0XHRcdFx0XHRcdH1cblx0XHRcdFx0XHR9XG5cdFx0XHRcdH0sIHRoaXMpO1xuXG5cdFx0XHRcdGlmICghdGhpcy5saW5lQXJjKXtcblx0XHRcdFx0XHRjdHgubGluZVdpZHRoID0gdGhpcy5hbmdsZUxpbmVXaWR0aDtcblx0XHRcdFx0XHRjdHguc3Ryb2tlU3R5bGUgPSB0aGlzLmFuZ2xlTGluZUNvbG9yO1xuXHRcdFx0XHRcdGZvciAodmFyIGkgPSB0aGlzLnZhbHVlc0NvdW50IC0gMTsgaSA+PSAwOyBpLS0pIHtcblx0XHRcdFx0XHRcdHZhciBjZW50ZXJPZmZzZXQgPSBudWxsLCBvdXRlclBvc2l0aW9uID0gbnVsbDtcblxuXHRcdFx0XHRcdFx0aWYgKHRoaXMuYW5nbGVMaW5lV2lkdGggPiAwICYmIChpICUgdGhpcy5hbmdsZUxpbmVJbnRlcnZhbCA9PT0gMCkpe1xuXHRcdFx0XHRcdFx0XHRjZW50ZXJPZmZzZXQgPSB0aGlzLmNhbGN1bGF0ZUNlbnRlck9mZnNldCh0aGlzLm1heCk7XG5cdFx0XHRcdFx0XHRcdG91dGVyUG9zaXRpb24gPSB0aGlzLmdldFBvaW50UG9zaXRpb24oaSwgY2VudGVyT2Zmc2V0KTtcblx0XHRcdFx0XHRcdFx0Y3R4LmJlZ2luUGF0aCgpO1xuXHRcdFx0XHRcdFx0XHRjdHgubW92ZVRvKHRoaXMueENlbnRlciwgdGhpcy55Q2VudGVyKTtcblx0XHRcdFx0XHRcdFx0Y3R4LmxpbmVUbyhvdXRlclBvc2l0aW9uLngsIG91dGVyUG9zaXRpb24ueSk7XG5cdFx0XHRcdFx0XHRcdGN0eC5zdHJva2UoKTtcblx0XHRcdFx0XHRcdFx0Y3R4LmNsb3NlUGF0aCgpO1xuXHRcdFx0XHRcdFx0fVxuXG5cdFx0XHRcdFx0XHRpZiAodGhpcy5iYWNrZ3JvdW5kQ29sb3JzICYmIHRoaXMuYmFja2dyb3VuZENvbG9ycy5sZW5ndGggPT0gdGhpcy52YWx1ZXNDb3VudCkge1xuXHRcdFx0XHRcdFx0XHRpZiAoY2VudGVyT2Zmc2V0ID09IG51bGwpXG5cdFx0XHRcdFx0XHRcdFx0Y2VudGVyT2Zmc2V0ID0gdGhpcy5jYWxjdWxhdGVDZW50ZXJPZmZzZXQodGhpcy5tYXgpO1xuXG5cdFx0XHRcdFx0XHRcdGlmIChvdXRlclBvc2l0aW9uID09IG51bGwpXG5cdFx0XHRcdFx0XHRcdFx0b3V0ZXJQb3NpdGlvbiA9IHRoaXMuZ2V0UG9pbnRQb3NpdGlvbihpLCBjZW50ZXJPZmZzZXQpO1xuXG5cdFx0XHRcdFx0XHRcdHZhciBwcmV2aW91c091dGVyUG9zaXRpb24gPSB0aGlzLmdldFBvaW50UG9zaXRpb24oaSA9PT0gMCA/IHRoaXMudmFsdWVzQ291bnQgLSAxIDogaSAtIDEsIGNlbnRlck9mZnNldCk7XG5cdFx0XHRcdFx0XHRcdHZhciBuZXh0T3V0ZXJQb3NpdGlvbiA9IHRoaXMuZ2V0UG9pbnRQb3NpdGlvbihpID09PSB0aGlzLnZhbHVlc0NvdW50IC0gMSA/IDAgOiBpICsgMSwgY2VudGVyT2Zmc2V0KTtcblxuXHRcdFx0XHRcdFx0XHR2YXIgcHJldmlvdXNPdXRlckhhbGZ3YXkgPSB7IHg6IChwcmV2aW91c091dGVyUG9zaXRpb24ueCArIG91dGVyUG9zaXRpb24ueCkgLyAyLCB5OiAocHJldmlvdXNPdXRlclBvc2l0aW9uLnkgKyBvdXRlclBvc2l0aW9uLnkpIC8gMiB9O1xuXHRcdFx0XHRcdFx0XHR2YXIgbmV4dE91dGVySGFsZndheSA9IHsgeDogKG91dGVyUG9zaXRpb24ueCArIG5leHRPdXRlclBvc2l0aW9uLngpIC8gMiwgeTogKG91dGVyUG9zaXRpb24ueSArIG5leHRPdXRlclBvc2l0aW9uLnkpIC8gMiB9O1xuXG5cdFx0XHRcdFx0XHRcdGN0eC5iZWdpblBhdGgoKTtcblx0XHRcdFx0XHRcdFx0Y3R4Lm1vdmVUbyh0aGlzLnhDZW50ZXIsIHRoaXMueUNlbnRlcik7XG5cdFx0XHRcdFx0XHRcdGN0eC5saW5lVG8ocHJldmlvdXNPdXRlckhhbGZ3YXkueCwgcHJldmlvdXNPdXRlckhhbGZ3YXkueSk7XG5cdFx0XHRcdFx0XHRcdGN0eC5saW5lVG8ob3V0ZXJQb3NpdGlvbi54LCBvdXRlclBvc2l0aW9uLnkpO1xuXHRcdFx0XHRcdFx0XHRjdHgubGluZVRvKG5leHRPdXRlckhhbGZ3YXkueCwgbmV4dE91dGVySGFsZndheS55KTtcblx0XHRcdFx0XHRcdFx0Y3R4LmZpbGxTdHlsZSA9IHRoaXMuYmFja2dyb3VuZENvbG9yc1tpXTtcblx0XHRcdFx0XHRcdFx0Y3R4LmZpbGwoKTtcblx0XHRcdFx0XHRcdFx0Y3R4LmNsb3NlUGF0aCgpO1xuXHRcdFx0XHRcdFx0fVxuXHRcdFx0XHRcdFx0Ly8gRXh0cmEgM3B4IG91dCBmb3Igc29tZSBsYWJlbCBzcGFjaW5nXG5cdFx0XHRcdFx0XHR2YXIgcG9pbnRMYWJlbFBvc2l0aW9uID0gdGhpcy5nZXRQb2ludFBvc2l0aW9uKGksIHRoaXMuY2FsY3VsYXRlQ2VudGVyT2Zmc2V0KHRoaXMubWF4KSArIDUpO1xuXHRcdFx0XHRcdFx0Y3R4LmZvbnQgPSBmb250U3RyaW5nKHRoaXMucG9pbnRMYWJlbEZvbnRTaXplLHRoaXMucG9pbnRMYWJlbEZvbnRTdHlsZSx0aGlzLnBvaW50TGFiZWxGb250RmFtaWx5KTtcblx0XHRcdFx0XHRcdGN0eC5maWxsU3R5bGUgPSB0aGlzLnBvaW50TGFiZWxGb250Q29sb3I7XG5cblx0XHRcdFx0XHRcdHZhciBsYWJlbHNDb3VudCA9IHRoaXMubGFiZWxzLmxlbmd0aCxcblx0XHRcdFx0XHRcdFx0aGFsZkxhYmVsc0NvdW50ID0gdGhpcy5sYWJlbHMubGVuZ3RoLzIsXG5cdFx0XHRcdFx0XHRcdHF1YXJ0ZXJMYWJlbHNDb3VudCA9IGhhbGZMYWJlbHNDb3VudC8yLFxuXHRcdFx0XHRcdFx0XHR1cHBlckhhbGYgPSAoaSA8IHF1YXJ0ZXJMYWJlbHNDb3VudCB8fCBpID4gbGFiZWxzQ291bnQgLSBxdWFydGVyTGFiZWxzQ291bnQpLFxuXHRcdFx0XHRcdFx0XHRleGFjdFF1YXJ0ZXIgPSAoaSA9PT0gcXVhcnRlckxhYmVsc0NvdW50IHx8IGkgPT09IGxhYmVsc0NvdW50IC0gcXVhcnRlckxhYmVsc0NvdW50KTtcblx0XHRcdFx0XHRcdGlmIChpID09PSAwKXtcblx0XHRcdFx0XHRcdFx0Y3R4LnRleHRBbGlnbiA9ICdjZW50ZXInO1xuXHRcdFx0XHRcdFx0fSBlbHNlIGlmKGkgPT09IGhhbGZMYWJlbHNDb3VudCl7XG5cdFx0XHRcdFx0XHRcdGN0eC50ZXh0QWxpZ24gPSAnY2VudGVyJztcblx0XHRcdFx0XHRcdH0gZWxzZSBpZiAoaSA8IGhhbGZMYWJlbHNDb3VudCl7XG5cdFx0XHRcdFx0XHRcdGN0eC50ZXh0QWxpZ24gPSAnbGVmdCc7XG5cdFx0XHRcdFx0XHR9IGVsc2Uge1xuXHRcdFx0XHRcdFx0XHRjdHgudGV4dEFsaWduID0gJ3JpZ2h0Jztcblx0XHRcdFx0XHRcdH1cblxuXHRcdFx0XHRcdFx0Ly8gU2V0IHRoZSBjb3JyZWN0IHRleHQgYmFzZWxpbmUgYmFzZWQgb24gb3V0ZXIgcG9zaXRpb25pbmdcblx0XHRcdFx0XHRcdGlmIChleGFjdFF1YXJ0ZXIpe1xuXHRcdFx0XHRcdFx0XHRjdHgudGV4dEJhc2VsaW5lID0gJ21pZGRsZSc7XG5cdFx0XHRcdFx0XHR9IGVsc2UgaWYgKHVwcGVySGFsZil7XG5cdFx0XHRcdFx0XHRcdGN0eC50ZXh0QmFzZWxpbmUgPSAnYm90dG9tJztcblx0XHRcdFx0XHRcdH0gZWxzZSB7XG5cdFx0XHRcdFx0XHRcdGN0eC50ZXh0QmFzZWxpbmUgPSAndG9wJztcblx0XHRcdFx0XHRcdH1cblxuXHRcdFx0XHRcdFx0Y3R4LmZpbGxUZXh0KHRoaXMubGFiZWxzW2ldLCBwb2ludExhYmVsUG9zaXRpb24ueCwgcG9pbnRMYWJlbFBvc2l0aW9uLnkpO1xuXHRcdFx0XHRcdH1cblx0XHRcdFx0fVxuXHRcdFx0fVxuXHRcdH1cblx0fSk7XG5cblx0Q2hhcnQuYW5pbWF0aW9uU2VydmljZSA9IHtcblx0XHRmcmFtZUR1cmF0aW9uOiAxNyxcblx0XHRhbmltYXRpb25zOiBbXSxcblx0XHRkcm9wRnJhbWVzOiAwLFxuXHRcdGFkZEFuaW1hdGlvbjogZnVuY3Rpb24oY2hhcnRJbnN0YW5jZSwgYW5pbWF0aW9uT2JqZWN0KSB7XG5cdFx0XHRmb3IgKHZhciBpbmRleCA9IDA7IGluZGV4IDwgdGhpcy5hbmltYXRpb25zLmxlbmd0aDsgKysgaW5kZXgpe1xuXHRcdFx0XHRpZiAodGhpcy5hbmltYXRpb25zW2luZGV4XS5jaGFydEluc3RhbmNlID09PSBjaGFydEluc3RhbmNlKXtcblx0XHRcdFx0XHQvLyByZXBsYWNpbmcgYW4gaW4gcHJvZ3Jlc3MgYW5pbWF0aW9uXG5cdFx0XHRcdFx0dGhpcy5hbmltYXRpb25zW2luZGV4XS5hbmltYXRpb25PYmplY3QgPSBhbmltYXRpb25PYmplY3Q7XG5cdFx0XHRcdFx0cmV0dXJuO1xuXHRcdFx0XHR9XG5cdFx0XHR9XG5cdFx0XHRcblx0XHRcdHRoaXMuYW5pbWF0aW9ucy5wdXNoKHtcblx0XHRcdFx0Y2hhcnRJbnN0YW5jZTogY2hhcnRJbnN0YW5jZSxcblx0XHRcdFx0YW5pbWF0aW9uT2JqZWN0OiBhbmltYXRpb25PYmplY3Rcblx0XHRcdH0pO1xuXG5cdFx0XHQvLyBJZiB0aGVyZSBhcmUgbm8gYW5pbWF0aW9ucyBxdWV1ZWQsIG1hbnVhbGx5IGtpY2tzdGFydCBhIGRpZ2VzdCwgZm9yIGxhY2sgb2YgYSBiZXR0ZXIgd29yZFxuXHRcdFx0aWYgKHRoaXMuYW5pbWF0aW9ucy5sZW5ndGggPT0gMSkge1xuXHRcdFx0XHRoZWxwZXJzLnJlcXVlc3RBbmltRnJhbWUuY2FsbCh3aW5kb3csIHRoaXMuZGlnZXN0V3JhcHBlcik7XG5cdFx0XHR9XG5cdFx0fSxcblx0XHQvLyBDYW5jZWwgdGhlIGFuaW1hdGlvbiBmb3IgYSBnaXZlbiBjaGFydCBpbnN0YW5jZVxuXHRcdGNhbmNlbEFuaW1hdGlvbjogZnVuY3Rpb24oY2hhcnRJbnN0YW5jZSkge1xuXHRcdFx0dmFyIGluZGV4ID0gaGVscGVycy5maW5kTmV4dFdoZXJlKHRoaXMuYW5pbWF0aW9ucywgZnVuY3Rpb24oYW5pbWF0aW9uV3JhcHBlcikge1xuXHRcdFx0XHRyZXR1cm4gYW5pbWF0aW9uV3JhcHBlci5jaGFydEluc3RhbmNlID09PSBjaGFydEluc3RhbmNlO1xuXHRcdFx0fSk7XG5cdFx0XHRcblx0XHRcdGlmIChpbmRleClcblx0XHRcdHtcblx0XHRcdFx0dGhpcy5hbmltYXRpb25zLnNwbGljZShpbmRleCwgMSk7XG5cdFx0XHR9XG5cdFx0fSxcblx0XHQvLyBjYWxscyBzdGFydERpZ2VzdCB3aXRoIHRoZSBwcm9wZXIgY29udGV4dFxuXHRcdGRpZ2VzdFdyYXBwZXI6IGZ1bmN0aW9uKCkge1xuXHRcdFx0Q2hhcnQuYW5pbWF0aW9uU2VydmljZS5zdGFydERpZ2VzdC5jYWxsKENoYXJ0LmFuaW1hdGlvblNlcnZpY2UpO1xuXHRcdH0sXG5cdFx0c3RhcnREaWdlc3Q6IGZ1bmN0aW9uKCkge1xuXG5cdFx0XHR2YXIgc3RhcnRUaW1lID0gRGF0ZS5ub3coKTtcblx0XHRcdHZhciBmcmFtZXNUb0Ryb3AgPSAwO1xuXG5cdFx0XHRpZih0aGlzLmRyb3BGcmFtZXMgPiAxKXtcblx0XHRcdFx0ZnJhbWVzVG9Ecm9wID0gTWF0aC5mbG9vcih0aGlzLmRyb3BGcmFtZXMpO1xuXHRcdFx0XHR0aGlzLmRyb3BGcmFtZXMgLT0gZnJhbWVzVG9Ecm9wO1xuXHRcdFx0fVxuXG5cdFx0XHRmb3IgKHZhciBpID0gMDsgaSA8IHRoaXMuYW5pbWF0aW9ucy5sZW5ndGg7IGkrKykge1xuXG5cdFx0XHRcdGlmICh0aGlzLmFuaW1hdGlvbnNbaV0uYW5pbWF0aW9uT2JqZWN0LmN1cnJlbnRTdGVwID09PSBudWxsKXtcblx0XHRcdFx0XHR0aGlzLmFuaW1hdGlvbnNbaV0uYW5pbWF0aW9uT2JqZWN0LmN1cnJlbnRTdGVwID0gMDtcblx0XHRcdFx0fVxuXG5cdFx0XHRcdHRoaXMuYW5pbWF0aW9uc1tpXS5hbmltYXRpb25PYmplY3QuY3VycmVudFN0ZXAgKz0gMSArIGZyYW1lc1RvRHJvcDtcblx0XHRcdFx0aWYodGhpcy5hbmltYXRpb25zW2ldLmFuaW1hdGlvbk9iamVjdC5jdXJyZW50U3RlcCA+IHRoaXMuYW5pbWF0aW9uc1tpXS5hbmltYXRpb25PYmplY3QubnVtU3RlcHMpe1xuXHRcdFx0XHRcdHRoaXMuYW5pbWF0aW9uc1tpXS5hbmltYXRpb25PYmplY3QuY3VycmVudFN0ZXAgPSB0aGlzLmFuaW1hdGlvbnNbaV0uYW5pbWF0aW9uT2JqZWN0Lm51bVN0ZXBzO1xuXHRcdFx0XHR9XG5cdFx0XHRcdFxuXHRcdFx0XHR0aGlzLmFuaW1hdGlvbnNbaV0uYW5pbWF0aW9uT2JqZWN0LnJlbmRlcih0aGlzLmFuaW1hdGlvbnNbaV0uY2hhcnRJbnN0YW5jZSwgdGhpcy5hbmltYXRpb25zW2ldLmFuaW1hdGlvbk9iamVjdCk7XG5cdFx0XHRcdFxuXHRcdFx0XHQvLyBDaGVjayBpZiBleGVjdXRlZCB0aGUgbGFzdCBmcmFtZS5cblx0XHRcdFx0aWYgKHRoaXMuYW5pbWF0aW9uc1tpXS5hbmltYXRpb25PYmplY3QuY3VycmVudFN0ZXAgPT0gdGhpcy5hbmltYXRpb25zW2ldLmFuaW1hdGlvbk9iamVjdC5udW1TdGVwcyl7XG5cdFx0XHRcdFx0Ly8gQ2FsbCBvbkFuaW1hdGlvbkNvbXBsZXRlXG5cdFx0XHRcdFx0dGhpcy5hbmltYXRpb25zW2ldLmFuaW1hdGlvbk9iamVjdC5vbkFuaW1hdGlvbkNvbXBsZXRlLmNhbGwodGhpcy5hbmltYXRpb25zW2ldLmNoYXJ0SW5zdGFuY2UpO1xuXHRcdFx0XHRcdC8vIFJlbW92ZSB0aGUgYW5pbWF0aW9uLlxuXHRcdFx0XHRcdHRoaXMuYW5pbWF0aW9ucy5zcGxpY2UoaSwgMSk7XG5cdFx0XHRcdFx0Ly8gS2VlcCB0aGUgaW5kZXggaW4gcGxhY2UgdG8gb2Zmc2V0IHRoZSBzcGxpY2Vcblx0XHRcdFx0XHRpLS07XG5cdFx0XHRcdH1cblx0XHRcdH1cblxuXHRcdFx0dmFyIGVuZFRpbWUgPSBEYXRlLm5vdygpO1xuXHRcdFx0dmFyIGRlbGF5ID0gZW5kVGltZSAtIHN0YXJ0VGltZSAtIHRoaXMuZnJhbWVEdXJhdGlvbjtcblx0XHRcdHZhciBmcmFtZURlbGF5ID0gZGVsYXkgLyB0aGlzLmZyYW1lRHVyYXRpb247XG5cblx0XHRcdGlmKGZyYW1lRGVsYXkgPiAxKXtcblx0XHRcdFx0dGhpcy5kcm9wRnJhbWVzICs9IGZyYW1lRGVsYXk7XG5cdFx0XHR9XG5cblx0XHRcdC8vIERvIHdlIGhhdmUgbW9yZSBzdHVmZiB0byBhbmltYXRlP1xuXHRcdFx0aWYgKHRoaXMuYW5pbWF0aW9ucy5sZW5ndGggPiAwKXtcblx0XHRcdFx0aGVscGVycy5yZXF1ZXN0QW5pbUZyYW1lLmNhbGwod2luZG93LCB0aGlzLmRpZ2VzdFdyYXBwZXIpO1xuXHRcdFx0fVxuXHRcdH1cblx0fTtcblxuXHQvLyBBdHRhY2ggZ2xvYmFsIGV2ZW50IHRvIHJlc2l6ZSBlYWNoIGNoYXJ0IGluc3RhbmNlIHdoZW4gdGhlIGJyb3dzZXIgcmVzaXplc1xuXHRoZWxwZXJzLmFkZEV2ZW50KHdpbmRvdywgXCJyZXNpemVcIiwgKGZ1bmN0aW9uKCl7XG5cdFx0Ly8gQmFzaWMgZGVib3VuY2Ugb2YgcmVzaXplIGZ1bmN0aW9uIHNvIGl0IGRvZXNuJ3QgaHVydCBwZXJmb3JtYW5jZSB3aGVuIHJlc2l6aW5nIGJyb3dzZXIuXG5cdFx0dmFyIHRpbWVvdXQ7XG5cdFx0cmV0dXJuIGZ1bmN0aW9uKCl7XG5cdFx0XHRjbGVhclRpbWVvdXQodGltZW91dCk7XG5cdFx0XHR0aW1lb3V0ID0gc2V0VGltZW91dChmdW5jdGlvbigpe1xuXHRcdFx0XHRlYWNoKENoYXJ0Lmluc3RhbmNlcyxmdW5jdGlvbihpbnN0YW5jZSl7XG5cdFx0XHRcdFx0Ly8gSWYgdGhlIHJlc3BvbnNpdmUgZmxhZyBpcyBzZXQgaW4gdGhlIGNoYXJ0IGluc3RhbmNlIGNvbmZpZ1xuXHRcdFx0XHRcdC8vIENhc2NhZGUgdGhlIHJlc2l6ZSBldmVudCBkb3duIHRvIHRoZSBjaGFydC5cblx0XHRcdFx0XHRpZiAoaW5zdGFuY2Uub3B0aW9ucy5yZXNwb25zaXZlKXtcblx0XHRcdFx0XHRcdGluc3RhbmNlLnJlc2l6ZShpbnN0YW5jZS5yZW5kZXIsIHRydWUpO1xuXHRcdFx0XHRcdH1cblx0XHRcdFx0fSk7XG5cdFx0XHR9LCA1MCk7XG5cdFx0fTtcblx0fSkoKSk7XG5cblxuXHRpZiAoYW1kKSB7XG5cdFx0ZGVmaW5lKCdDaGFydCcsIFtdLCBmdW5jdGlvbigpe1xuXHRcdFx0cmV0dXJuIENoYXJ0O1xuXHRcdH0pO1xuXHR9IGVsc2UgaWYgKHR5cGVvZiBtb2R1bGUgPT09ICdvYmplY3QnICYmIG1vZHVsZS5leHBvcnRzKSB7XG5cdFx0bW9kdWxlLmV4cG9ydHMgPSBDaGFydDtcblx0fVxuXG5cdHJvb3QuQ2hhcnQgPSBDaGFydDtcblxuXHRDaGFydC5ub0NvbmZsaWN0ID0gZnVuY3Rpb24oKXtcblx0XHRyb290LkNoYXJ0ID0gcHJldmlvdXM7XG5cdFx0cmV0dXJuIENoYXJ0O1xuXHR9O1xuXG59KS5jYWxsKHRoaXMpO1xuXG4oZnVuY3Rpb24oKXtcblx0XCJ1c2Ugc3RyaWN0XCI7XG5cblx0dmFyIHJvb3QgPSB0aGlzLFxuXHRcdENoYXJ0ID0gcm9vdC5DaGFydCxcblx0XHRoZWxwZXJzID0gQ2hhcnQuaGVscGVycztcblxuXG5cdHZhciBkZWZhdWx0Q29uZmlnID0ge1xuXHRcdC8vQm9vbGVhbiAtIFdoZXRoZXIgdGhlIHNjYWxlIHNob3VsZCBzdGFydCBhdCB6ZXJvLCBvciBhbiBvcmRlciBvZiBtYWduaXR1ZGUgZG93biBmcm9tIHRoZSBsb3dlc3QgdmFsdWVcblx0XHRzY2FsZUJlZ2luQXRaZXJvIDogdHJ1ZSxcblxuXHRcdC8vQm9vbGVhbiAtIFdoZXRoZXIgZ3JpZCBsaW5lcyBhcmUgc2hvd24gYWNyb3NzIHRoZSBjaGFydFxuXHRcdHNjYWxlU2hvd0dyaWRMaW5lcyA6IHRydWUsXG5cblx0XHQvL1N0cmluZyAtIENvbG91ciBvZiB0aGUgZ3JpZCBsaW5lc1xuXHRcdHNjYWxlR3JpZExpbmVDb2xvciA6IFwicmdiYSgwLDAsMCwuMDUpXCIsXG5cblx0XHQvL051bWJlciAtIFdpZHRoIG9mIHRoZSBncmlkIGxpbmVzXG5cdFx0c2NhbGVHcmlkTGluZVdpZHRoIDogMSxcblxuXHRcdC8vQm9vbGVhbiAtIFdoZXRoZXIgdG8gc2hvdyBob3Jpem9udGFsIGxpbmVzIChleGNlcHQgWCBheGlzKVxuXHRcdHNjYWxlU2hvd0hvcml6b250YWxMaW5lczogdHJ1ZSxcblxuXHRcdC8vQm9vbGVhbiAtIFdoZXRoZXIgdG8gc2hvdyB2ZXJ0aWNhbCBsaW5lcyAoZXhjZXB0IFkgYXhpcylcblx0XHRzY2FsZVNob3dWZXJ0aWNhbExpbmVzOiB0cnVlLFxuXG5cdFx0Ly9Cb29sZWFuIC0gSWYgdGhlcmUgaXMgYSBzdHJva2Ugb24gZWFjaCBiYXJcblx0XHRiYXJTaG93U3Ryb2tlIDogdHJ1ZSxcblxuXHRcdC8vTnVtYmVyIC0gUGl4ZWwgd2lkdGggb2YgdGhlIGJhciBzdHJva2Vcblx0XHRiYXJTdHJva2VXaWR0aCA6IDIsXG5cblx0XHQvL051bWJlciAtIFNwYWNpbmcgYmV0d2VlbiBlYWNoIG9mIHRoZSBYIHZhbHVlIHNldHNcblx0XHRiYXJWYWx1ZVNwYWNpbmcgOiA1LFxuXG5cdFx0Ly9OdW1iZXIgLSBTcGFjaW5nIGJldHdlZW4gZGF0YSBzZXRzIHdpdGhpbiBYIHZhbHVlc1xuXHRcdGJhckRhdGFzZXRTcGFjaW5nIDogMSxcblxuXHRcdC8vU3RyaW5nIC0gQSBsZWdlbmQgdGVtcGxhdGVcblx0XHRsZWdlbmRUZW1wbGF0ZSA6IFwiPHVsIGNsYXNzPVxcXCI8JT1uYW1lLnRvTG93ZXJDYXNlKCklPi1sZWdlbmRcXFwiPjwlIGZvciAodmFyIGk9MDsgaTxkYXRhc2V0cy5sZW5ndGg7IGkrKyl7JT48bGk+PHNwYW4gY2xhc3M9XFxcIjwlPW5hbWUudG9Mb3dlckNhc2UoKSU+LWxlZ2VuZC1pY29uXFxcIiBzdHlsZT1cXFwiYmFja2dyb3VuZC1jb2xvcjo8JT1kYXRhc2V0c1tpXS5maWxsQ29sb3IlPlxcXCI+PC9zcGFuPjxzcGFuIGNsYXNzPVxcXCI8JT1uYW1lLnRvTG93ZXJDYXNlKCklPi1sZWdlbmQtdGV4dFxcXCI+PCVpZihkYXRhc2V0c1tpXS5sYWJlbCl7JT48JT1kYXRhc2V0c1tpXS5sYWJlbCU+PCV9JT48L3NwYW4+PC9saT48JX0lPjwvdWw+XCJcblxuXHR9O1xuXG5cblx0Q2hhcnQuVHlwZS5leHRlbmQoe1xuXHRcdG5hbWU6IFwiQmFyXCIsXG5cdFx0ZGVmYXVsdHMgOiBkZWZhdWx0Q29uZmlnLFxuXHRcdGluaXRpYWxpemU6ICBmdW5jdGlvbihkYXRhKXtcblxuXHRcdFx0Ly9FeHBvc2Ugb3B0aW9ucyBhcyBhIHNjb3BlIHZhcmlhYmxlIGhlcmUgc28gd2UgY2FuIGFjY2VzcyBpdCBpbiB0aGUgU2NhbGVDbGFzc1xuXHRcdFx0dmFyIG9wdGlvbnMgPSB0aGlzLm9wdGlvbnM7XG5cblx0XHRcdHRoaXMuU2NhbGVDbGFzcyA9IENoYXJ0LlNjYWxlLmV4dGVuZCh7XG5cdFx0XHRcdG9mZnNldEdyaWRMaW5lcyA6IHRydWUsXG5cdFx0XHRcdGNhbGN1bGF0ZUJhclggOiBmdW5jdGlvbihkYXRhc2V0Q291bnQsIGRhdGFzZXRJbmRleCwgYmFySW5kZXgpe1xuXHRcdFx0XHRcdC8vUmV1c2FibGUgbWV0aG9kIGZvciBjYWxjdWxhdGluZyB0aGUgeFBvc2l0aW9uIG9mIGEgZ2l2ZW4gYmFyIGJhc2VkIG9uIGRhdGFzZXRJbmRleCAmIHdpZHRoIG9mIHRoZSBiYXJcblx0XHRcdFx0XHR2YXIgeFdpZHRoID0gdGhpcy5jYWxjdWxhdGVCYXNlV2lkdGgoKSxcblx0XHRcdFx0XHRcdHhBYnNvbHV0ZSA9IHRoaXMuY2FsY3VsYXRlWChiYXJJbmRleCkgLSAoeFdpZHRoLzIpLFxuXHRcdFx0XHRcdFx0YmFyV2lkdGggPSB0aGlzLmNhbGN1bGF0ZUJhcldpZHRoKGRhdGFzZXRDb3VudCk7XG5cblx0XHRcdFx0XHRyZXR1cm4geEFic29sdXRlICsgKGJhcldpZHRoICogZGF0YXNldEluZGV4KSArIChkYXRhc2V0SW5kZXggKiBvcHRpb25zLmJhckRhdGFzZXRTcGFjaW5nKSArIGJhcldpZHRoLzI7XG5cdFx0XHRcdH0sXG5cdFx0XHRcdGNhbGN1bGF0ZUJhc2VXaWR0aCA6IGZ1bmN0aW9uKCl7XG5cdFx0XHRcdFx0cmV0dXJuICh0aGlzLmNhbGN1bGF0ZVgoMSkgLSB0aGlzLmNhbGN1bGF0ZVgoMCkpIC0gKDIqb3B0aW9ucy5iYXJWYWx1ZVNwYWNpbmcpO1xuXHRcdFx0XHR9LFxuXHRcdFx0XHRjYWxjdWxhdGVCYXJXaWR0aCA6IGZ1bmN0aW9uKGRhdGFzZXRDb3VudCl7XG5cdFx0XHRcdFx0Ly9UaGUgcGFkZGluZyBiZXR3ZWVuIGRhdGFzZXRzIGlzIHRvIHRoZSByaWdodCBvZiBlYWNoIGJhciwgcHJvdmlkaW5nIHRoYXQgdGhlcmUgYXJlIG1vcmUgdGhhbiAxIGRhdGFzZXRcblx0XHRcdFx0XHR2YXIgYmFzZVdpZHRoID0gdGhpcy5jYWxjdWxhdGVCYXNlV2lkdGgoKSAtICgoZGF0YXNldENvdW50IC0gMSkgKiBvcHRpb25zLmJhckRhdGFzZXRTcGFjaW5nKTtcblxuXHRcdFx0XHRcdHJldHVybiAoYmFzZVdpZHRoIC8gZGF0YXNldENvdW50KTtcblx0XHRcdFx0fVxuXHRcdFx0fSk7XG5cblx0XHRcdHRoaXMuZGF0YXNldHMgPSBbXTtcblxuXHRcdFx0Ly9TZXQgdXAgdG9vbHRpcCBldmVudHMgb24gdGhlIGNoYXJ0XG5cdFx0XHRpZiAodGhpcy5vcHRpb25zLnNob3dUb29sdGlwcyl7XG5cdFx0XHRcdGhlbHBlcnMuYmluZEV2ZW50cyh0aGlzLCB0aGlzLm9wdGlvbnMudG9vbHRpcEV2ZW50cywgZnVuY3Rpb24oZXZ0KXtcblx0XHRcdFx0XHR2YXIgYWN0aXZlQmFycyA9IChldnQudHlwZSAhPT0gJ21vdXNlb3V0JykgPyB0aGlzLmdldEJhcnNBdEV2ZW50KGV2dCkgOiBbXTtcblxuXHRcdFx0XHRcdHRoaXMuZWFjaEJhcnMoZnVuY3Rpb24oYmFyKXtcblx0XHRcdFx0XHRcdGJhci5yZXN0b3JlKFsnZmlsbENvbG9yJywgJ3N0cm9rZUNvbG9yJ10pO1xuXHRcdFx0XHRcdH0pO1xuXHRcdFx0XHRcdGhlbHBlcnMuZWFjaChhY3RpdmVCYXJzLCBmdW5jdGlvbihhY3RpdmVCYXIpe1xuXHRcdFx0XHRcdFx0aWYgKGFjdGl2ZUJhcikge1xuXHRcdFx0XHRcdFx0XHRhY3RpdmVCYXIuZmlsbENvbG9yID0gYWN0aXZlQmFyLmhpZ2hsaWdodEZpbGw7XG5cdFx0XHRcdFx0XHRcdGFjdGl2ZUJhci5zdHJva2VDb2xvciA9IGFjdGl2ZUJhci5oaWdobGlnaHRTdHJva2U7XG5cdFx0XHRcdFx0XHR9XG5cdFx0XHRcdFx0fSk7XG5cdFx0XHRcdFx0dGhpcy5zaG93VG9vbHRpcChhY3RpdmVCYXJzKTtcblx0XHRcdFx0fSk7XG5cdFx0XHR9XG5cblx0XHRcdC8vRGVjbGFyZSB0aGUgZXh0ZW5zaW9uIG9mIHRoZSBkZWZhdWx0IHBvaW50LCB0byBjYXRlciBmb3IgdGhlIG9wdGlvbnMgcGFzc2VkIGluIHRvIHRoZSBjb25zdHJ1Y3RvclxuXHRcdFx0dGhpcy5CYXJDbGFzcyA9IENoYXJ0LlJlY3RhbmdsZS5leHRlbmQoe1xuXHRcdFx0XHRzdHJva2VXaWR0aCA6IHRoaXMub3B0aW9ucy5iYXJTdHJva2VXaWR0aCxcblx0XHRcdFx0c2hvd1N0cm9rZSA6IHRoaXMub3B0aW9ucy5iYXJTaG93U3Ryb2tlLFxuXHRcdFx0XHRjdHggOiB0aGlzLmNoYXJ0LmN0eFxuXHRcdFx0fSk7XG5cblx0XHRcdC8vSXRlcmF0ZSB0aHJvdWdoIGVhY2ggb2YgdGhlIGRhdGFzZXRzLCBhbmQgYnVpbGQgdGhpcyBpbnRvIGEgcHJvcGVydHkgb2YgdGhlIGNoYXJ0XG5cdFx0XHRoZWxwZXJzLmVhY2goZGF0YS5kYXRhc2V0cyxmdW5jdGlvbihkYXRhc2V0LGRhdGFzZXRJbmRleCl7XG5cblx0XHRcdFx0dmFyIGRhdGFzZXRPYmplY3QgPSB7XG5cdFx0XHRcdFx0bGFiZWwgOiBkYXRhc2V0LmxhYmVsIHx8IG51bGwsXG5cdFx0XHRcdFx0ZmlsbENvbG9yIDogZGF0YXNldC5maWxsQ29sb3IsXG5cdFx0XHRcdFx0c3Ryb2tlQ29sb3IgOiBkYXRhc2V0LnN0cm9rZUNvbG9yLFxuXHRcdFx0XHRcdGJhcnMgOiBbXVxuXHRcdFx0XHR9O1xuXG5cdFx0XHRcdHRoaXMuZGF0YXNldHMucHVzaChkYXRhc2V0T2JqZWN0KTtcblxuXHRcdFx0XHRoZWxwZXJzLmVhY2goZGF0YXNldC5kYXRhLGZ1bmN0aW9uKGRhdGFQb2ludCxpbmRleCl7XG5cdFx0XHRcdFx0Ly9BZGQgYSBuZXcgcG9pbnQgZm9yIGVhY2ggcGllY2Ugb2YgZGF0YSwgcGFzc2luZyBhbnkgcmVxdWlyZWQgZGF0YSB0byBkcmF3LlxuXHRcdFx0XHRcdGRhdGFzZXRPYmplY3QuYmFycy5wdXNoKG5ldyB0aGlzLkJhckNsYXNzKHtcblx0XHRcdFx0XHRcdHZhbHVlIDogZGF0YVBvaW50LFxuXHRcdFx0XHRcdFx0bGFiZWwgOiBkYXRhLmxhYmVsc1tpbmRleF0sXG5cdFx0XHRcdFx0XHRkYXRhc2V0TGFiZWw6IGRhdGFzZXQubGFiZWwsXG5cdFx0XHRcdFx0XHRzdHJva2VDb2xvciA6ICh0eXBlb2YgZGF0YXNldC5zdHJva2VDb2xvciA9PSAnb2JqZWN0JykgPyBkYXRhc2V0LnN0cm9rZUNvbG9yW2luZGV4XSA6IGRhdGFzZXQuc3Ryb2tlQ29sb3IsXG5cdFx0XHRcdFx0XHRmaWxsQ29sb3IgOiAodHlwZW9mIGRhdGFzZXQuZmlsbENvbG9yID09ICdvYmplY3QnKSA/IGRhdGFzZXQuZmlsbENvbG9yW2luZGV4XSA6IGRhdGFzZXQuZmlsbENvbG9yLFxuXHRcdFx0XHRcdFx0aGlnaGxpZ2h0RmlsbCA6IChkYXRhc2V0LmhpZ2hsaWdodEZpbGwpID8gKHR5cGVvZiBkYXRhc2V0LmhpZ2hsaWdodEZpbGwgPT0gJ29iamVjdCcpID8gZGF0YXNldC5oaWdobGlnaHRGaWxsW2luZGV4XSA6IGRhdGFzZXQuaGlnaGxpZ2h0RmlsbCA6ICh0eXBlb2YgZGF0YXNldC5maWxsQ29sb3IgPT0gJ29iamVjdCcpID8gZGF0YXNldC5maWxsQ29sb3JbaW5kZXhdIDogZGF0YXNldC5maWxsQ29sb3IsXG5cdFx0XHRcdFx0XHRoaWdobGlnaHRTdHJva2UgOiAoZGF0YXNldC5oaWdobGlnaHRTdHJva2UpID8gKHR5cGVvZiBkYXRhc2V0LmhpZ2hsaWdodFN0cm9rZSA9PSAnb2JqZWN0JykgPyBkYXRhc2V0LmhpZ2hsaWdodFN0cm9rZVtpbmRleF0gOiBkYXRhc2V0LmhpZ2hsaWdodFN0cm9rZSA6ICh0eXBlb2YgZGF0YXNldC5zdHJva2VDb2xvciA9PSAnb2JqZWN0JykgPyBkYXRhc2V0LnN0cm9rZUNvbG9yW2luZGV4XSA6IGRhdGFzZXQuc3Ryb2tlQ29sb3Jcblx0XHRcdFx0XHR9KSk7XG5cdFx0XHRcdH0sdGhpcyk7XG5cblx0XHRcdH0sdGhpcyk7XG5cblx0XHRcdHRoaXMuYnVpbGRTY2FsZShkYXRhLmxhYmVscyk7XG5cblx0XHRcdHRoaXMuQmFyQ2xhc3MucHJvdG90eXBlLmJhc2UgPSB0aGlzLnNjYWxlLmVuZFBvaW50O1xuXG5cdFx0XHR0aGlzLmVhY2hCYXJzKGZ1bmN0aW9uKGJhciwgaW5kZXgsIGRhdGFzZXRJbmRleCl7XG5cdFx0XHRcdGhlbHBlcnMuZXh0ZW5kKGJhciwge1xuXHRcdFx0XHRcdHdpZHRoIDogdGhpcy5zY2FsZS5jYWxjdWxhdGVCYXJXaWR0aCh0aGlzLmRhdGFzZXRzLmxlbmd0aCksXG5cdFx0XHRcdFx0eDogdGhpcy5zY2FsZS5jYWxjdWxhdGVCYXJYKHRoaXMuZGF0YXNldHMubGVuZ3RoLCBkYXRhc2V0SW5kZXgsIGluZGV4KSxcblx0XHRcdFx0XHR5OiB0aGlzLnNjYWxlLmVuZFBvaW50XG5cdFx0XHRcdH0pO1xuXHRcdFx0XHRiYXIuc2F2ZSgpO1xuXHRcdFx0fSwgdGhpcyk7XG5cblx0XHRcdHRoaXMucmVuZGVyKCk7XG5cdFx0fSxcblx0XHR1cGRhdGUgOiBmdW5jdGlvbigpe1xuXHRcdFx0dGhpcy5zY2FsZS51cGRhdGUoKTtcblx0XHRcdC8vIFJlc2V0IGFueSBoaWdobGlnaHQgY29sb3VycyBiZWZvcmUgdXBkYXRpbmcuXG5cdFx0XHRoZWxwZXJzLmVhY2godGhpcy5hY3RpdmVFbGVtZW50cywgZnVuY3Rpb24oYWN0aXZlRWxlbWVudCl7XG5cdFx0XHRcdGFjdGl2ZUVsZW1lbnQucmVzdG9yZShbJ2ZpbGxDb2xvcicsICdzdHJva2VDb2xvciddKTtcblx0XHRcdH0pO1xuXG5cdFx0XHR0aGlzLmVhY2hCYXJzKGZ1bmN0aW9uKGJhcil7XG5cdFx0XHRcdGJhci5zYXZlKCk7XG5cdFx0XHR9KTtcblx0XHRcdHRoaXMucmVuZGVyKCk7XG5cdFx0fSxcblx0XHRlYWNoQmFycyA6IGZ1bmN0aW9uKGNhbGxiYWNrKXtcblx0XHRcdGhlbHBlcnMuZWFjaCh0aGlzLmRhdGFzZXRzLGZ1bmN0aW9uKGRhdGFzZXQsIGRhdGFzZXRJbmRleCl7XG5cdFx0XHRcdGhlbHBlcnMuZWFjaChkYXRhc2V0LmJhcnMsIGNhbGxiYWNrLCB0aGlzLCBkYXRhc2V0SW5kZXgpO1xuXHRcdFx0fSx0aGlzKTtcblx0XHR9LFxuXHRcdGdldEJhcnNBdEV2ZW50IDogZnVuY3Rpb24oZSl7XG5cdFx0XHR2YXIgYmFyc0FycmF5ID0gW10sXG5cdFx0XHRcdGV2ZW50UG9zaXRpb24gPSBoZWxwZXJzLmdldFJlbGF0aXZlUG9zaXRpb24oZSksXG5cdFx0XHRcdGRhdGFzZXRJdGVyYXRvciA9IGZ1bmN0aW9uKGRhdGFzZXQpe1xuXHRcdFx0XHRcdGJhcnNBcnJheS5wdXNoKGRhdGFzZXQuYmFyc1tiYXJJbmRleF0pO1xuXHRcdFx0XHR9LFxuXHRcdFx0XHRiYXJJbmRleDtcblxuXHRcdFx0Zm9yICh2YXIgZGF0YXNldEluZGV4ID0gMDsgZGF0YXNldEluZGV4IDwgdGhpcy5kYXRhc2V0cy5sZW5ndGg7IGRhdGFzZXRJbmRleCsrKSB7XG5cdFx0XHRcdGZvciAoYmFySW5kZXggPSAwOyBiYXJJbmRleCA8IHRoaXMuZGF0YXNldHNbZGF0YXNldEluZGV4XS5iYXJzLmxlbmd0aDsgYmFySW5kZXgrKykge1xuXHRcdFx0XHRcdGlmICh0aGlzLmRhdGFzZXRzW2RhdGFzZXRJbmRleF0uYmFyc1tiYXJJbmRleF0uaW5SYW5nZShldmVudFBvc2l0aW9uLngsZXZlbnRQb3NpdGlvbi55KSl7XG5cdFx0XHRcdFx0XHRoZWxwZXJzLmVhY2godGhpcy5kYXRhc2V0cywgZGF0YXNldEl0ZXJhdG9yKTtcblx0XHRcdFx0XHRcdHJldHVybiBiYXJzQXJyYXk7XG5cdFx0XHRcdFx0fVxuXHRcdFx0XHR9XG5cdFx0XHR9XG5cblx0XHRcdHJldHVybiBiYXJzQXJyYXk7XG5cdFx0fSxcblx0XHRidWlsZFNjYWxlIDogZnVuY3Rpb24obGFiZWxzKXtcblx0XHRcdHZhciBzZWxmID0gdGhpcztcblxuXHRcdFx0dmFyIGRhdGFUb3RhbCA9IGZ1bmN0aW9uKCl7XG5cdFx0XHRcdHZhciB2YWx1ZXMgPSBbXTtcblx0XHRcdFx0c2VsZi5lYWNoQmFycyhmdW5jdGlvbihiYXIpe1xuXHRcdFx0XHRcdHZhbHVlcy5wdXNoKGJhci52YWx1ZSk7XG5cdFx0XHRcdH0pO1xuXHRcdFx0XHRyZXR1cm4gdmFsdWVzO1xuXHRcdFx0fTtcblxuXHRcdFx0dmFyIHNjYWxlT3B0aW9ucyA9IHtcblx0XHRcdFx0dGVtcGxhdGVTdHJpbmcgOiB0aGlzLm9wdGlvbnMuc2NhbGVMYWJlbCxcblx0XHRcdFx0aGVpZ2h0IDogdGhpcy5jaGFydC5oZWlnaHQsXG5cdFx0XHRcdHdpZHRoIDogdGhpcy5jaGFydC53aWR0aCxcblx0XHRcdFx0Y3R4IDogdGhpcy5jaGFydC5jdHgsXG5cdFx0XHRcdHRleHRDb2xvciA6IHRoaXMub3B0aW9ucy5zY2FsZUZvbnRDb2xvcixcblx0XHRcdFx0Zm9udFNpemUgOiB0aGlzLm9wdGlvbnMuc2NhbGVGb250U2l6ZSxcblx0XHRcdFx0Zm9udFN0eWxlIDogdGhpcy5vcHRpb25zLnNjYWxlRm9udFN0eWxlLFxuXHRcdFx0XHRmb250RmFtaWx5IDogdGhpcy5vcHRpb25zLnNjYWxlRm9udEZhbWlseSxcblx0XHRcdFx0dmFsdWVzQ291bnQgOiBsYWJlbHMubGVuZ3RoLFxuXHRcdFx0XHRiZWdpbkF0WmVybyA6IHRoaXMub3B0aW9ucy5zY2FsZUJlZ2luQXRaZXJvLFxuXHRcdFx0XHRpbnRlZ2Vyc09ubHkgOiB0aGlzLm9wdGlvbnMuc2NhbGVJbnRlZ2Vyc09ubHksXG5cdFx0XHRcdGNhbGN1bGF0ZVlSYW5nZTogZnVuY3Rpb24oY3VycmVudEhlaWdodCl7XG5cdFx0XHRcdFx0dmFyIHVwZGF0ZWRSYW5nZXMgPSBoZWxwZXJzLmNhbGN1bGF0ZVNjYWxlUmFuZ2UoXG5cdFx0XHRcdFx0XHRkYXRhVG90YWwoKSxcblx0XHRcdFx0XHRcdGN1cnJlbnRIZWlnaHQsXG5cdFx0XHRcdFx0XHR0aGlzLmZvbnRTaXplLFxuXHRcdFx0XHRcdFx0dGhpcy5iZWdpbkF0WmVybyxcblx0XHRcdFx0XHRcdHRoaXMuaW50ZWdlcnNPbmx5XG5cdFx0XHRcdFx0KTtcblx0XHRcdFx0XHRoZWxwZXJzLmV4dGVuZCh0aGlzLCB1cGRhdGVkUmFuZ2VzKTtcblx0XHRcdFx0fSxcblx0XHRcdFx0eExhYmVscyA6IGxhYmVscyxcblx0XHRcdFx0Zm9udCA6IGhlbHBlcnMuZm9udFN0cmluZyh0aGlzLm9wdGlvbnMuc2NhbGVGb250U2l6ZSwgdGhpcy5vcHRpb25zLnNjYWxlRm9udFN0eWxlLCB0aGlzLm9wdGlvbnMuc2NhbGVGb250RmFtaWx5KSxcblx0XHRcdFx0bGluZVdpZHRoIDogdGhpcy5vcHRpb25zLnNjYWxlTGluZVdpZHRoLFxuXHRcdFx0XHRsaW5lQ29sb3IgOiB0aGlzLm9wdGlvbnMuc2NhbGVMaW5lQ29sb3IsXG5cdFx0XHRcdHNob3dIb3Jpem9udGFsTGluZXMgOiB0aGlzLm9wdGlvbnMuc2NhbGVTaG93SG9yaXpvbnRhbExpbmVzLFxuXHRcdFx0XHRzaG93VmVydGljYWxMaW5lcyA6IHRoaXMub3B0aW9ucy5zY2FsZVNob3dWZXJ0aWNhbExpbmVzLFxuXHRcdFx0XHRncmlkTGluZVdpZHRoIDogKHRoaXMub3B0aW9ucy5zY2FsZVNob3dHcmlkTGluZXMpID8gdGhpcy5vcHRpb25zLnNjYWxlR3JpZExpbmVXaWR0aCA6IDAsXG5cdFx0XHRcdGdyaWRMaW5lQ29sb3IgOiAodGhpcy5vcHRpb25zLnNjYWxlU2hvd0dyaWRMaW5lcykgPyB0aGlzLm9wdGlvbnMuc2NhbGVHcmlkTGluZUNvbG9yIDogXCJyZ2JhKDAsMCwwLDApXCIsXG5cdFx0XHRcdHBhZGRpbmcgOiAodGhpcy5vcHRpb25zLnNob3dTY2FsZSkgPyAwIDogKHRoaXMub3B0aW9ucy5iYXJTaG93U3Ryb2tlKSA/IHRoaXMub3B0aW9ucy5iYXJTdHJva2VXaWR0aCA6IDAsXG5cdFx0XHRcdHNob3dMYWJlbHMgOiB0aGlzLm9wdGlvbnMuc2NhbGVTaG93TGFiZWxzLFxuXHRcdFx0XHRkaXNwbGF5IDogdGhpcy5vcHRpb25zLnNob3dTY2FsZVxuXHRcdFx0fTtcblxuXHRcdFx0aWYgKHRoaXMub3B0aW9ucy5zY2FsZU92ZXJyaWRlKXtcblx0XHRcdFx0aGVscGVycy5leHRlbmQoc2NhbGVPcHRpb25zLCB7XG5cdFx0XHRcdFx0Y2FsY3VsYXRlWVJhbmdlOiBoZWxwZXJzLm5vb3AsXG5cdFx0XHRcdFx0c3RlcHM6IHRoaXMub3B0aW9ucy5zY2FsZVN0ZXBzLFxuXHRcdFx0XHRcdHN0ZXBWYWx1ZTogdGhpcy5vcHRpb25zLnNjYWxlU3RlcFdpZHRoLFxuXHRcdFx0XHRcdG1pbjogdGhpcy5vcHRpb25zLnNjYWxlU3RhcnRWYWx1ZSxcblx0XHRcdFx0XHRtYXg6IHRoaXMub3B0aW9ucy5zY2FsZVN0YXJ0VmFsdWUgKyAodGhpcy5vcHRpb25zLnNjYWxlU3RlcHMgKiB0aGlzLm9wdGlvbnMuc2NhbGVTdGVwV2lkdGgpXG5cdFx0XHRcdH0pO1xuXHRcdFx0fVxuXG5cdFx0XHR0aGlzLnNjYWxlID0gbmV3IHRoaXMuU2NhbGVDbGFzcyhzY2FsZU9wdGlvbnMpO1xuXHRcdH0sXG5cdFx0YWRkRGF0YSA6IGZ1bmN0aW9uKHZhbHVlc0FycmF5LGxhYmVsKXtcblx0XHRcdC8vTWFwIHRoZSB2YWx1ZXMgYXJyYXkgZm9yIGVhY2ggb2YgdGhlIGRhdGFzZXRzXG5cdFx0XHRoZWxwZXJzLmVhY2godmFsdWVzQXJyYXksZnVuY3Rpb24odmFsdWUsZGF0YXNldEluZGV4KXtcblx0XHRcdFx0Ly9BZGQgYSBuZXcgcG9pbnQgZm9yIGVhY2ggcGllY2Ugb2YgZGF0YSwgcGFzc2luZyBhbnkgcmVxdWlyZWQgZGF0YSB0byBkcmF3LlxuXHRcdFx0XHR0aGlzLmRhdGFzZXRzW2RhdGFzZXRJbmRleF0uYmFycy5wdXNoKG5ldyB0aGlzLkJhckNsYXNzKHtcblx0XHRcdFx0XHR2YWx1ZSA6IHZhbHVlLFxuXHRcdFx0XHRcdGxhYmVsIDogbGFiZWwsXG5cdFx0XHRcdFx0ZGF0YXNldExhYmVsOiB0aGlzLmRhdGFzZXRzW2RhdGFzZXRJbmRleF0ubGFiZWwsXG5cdFx0XHRcdFx0eDogdGhpcy5zY2FsZS5jYWxjdWxhdGVCYXJYKHRoaXMuZGF0YXNldHMubGVuZ3RoLCBkYXRhc2V0SW5kZXgsIHRoaXMuc2NhbGUudmFsdWVzQ291bnQrMSksXG5cdFx0XHRcdFx0eTogdGhpcy5zY2FsZS5lbmRQb2ludCxcblx0XHRcdFx0XHR3aWR0aCA6IHRoaXMuc2NhbGUuY2FsY3VsYXRlQmFyV2lkdGgodGhpcy5kYXRhc2V0cy5sZW5ndGgpLFxuXHRcdFx0XHRcdGJhc2UgOiB0aGlzLnNjYWxlLmVuZFBvaW50LFxuXHRcdFx0XHRcdHN0cm9rZUNvbG9yIDogdGhpcy5kYXRhc2V0c1tkYXRhc2V0SW5kZXhdLnN0cm9rZUNvbG9yLFxuXHRcdFx0XHRcdGZpbGxDb2xvciA6IHRoaXMuZGF0YXNldHNbZGF0YXNldEluZGV4XS5maWxsQ29sb3Jcblx0XHRcdFx0fSkpO1xuXHRcdFx0fSx0aGlzKTtcblxuXHRcdFx0dGhpcy5zY2FsZS5hZGRYTGFiZWwobGFiZWwpO1xuXHRcdFx0Ly9UaGVuIHJlLXJlbmRlciB0aGUgY2hhcnQuXG5cdFx0XHR0aGlzLnVwZGF0ZSgpO1xuXHRcdH0sXG5cdFx0cmVtb3ZlRGF0YSA6IGZ1bmN0aW9uKCl7XG5cdFx0XHR0aGlzLnNjYWxlLnJlbW92ZVhMYWJlbCgpO1xuXHRcdFx0Ly9UaGVuIHJlLXJlbmRlciB0aGUgY2hhcnQuXG5cdFx0XHRoZWxwZXJzLmVhY2godGhpcy5kYXRhc2V0cyxmdW5jdGlvbihkYXRhc2V0KXtcblx0XHRcdFx0ZGF0YXNldC5iYXJzLnNoaWZ0KCk7XG5cdFx0XHR9LHRoaXMpO1xuXHRcdFx0dGhpcy51cGRhdGUoKTtcblx0XHR9LFxuXHRcdHJlZmxvdyA6IGZ1bmN0aW9uKCl7XG5cdFx0XHRoZWxwZXJzLmV4dGVuZCh0aGlzLkJhckNsYXNzLnByb3RvdHlwZSx7XG5cdFx0XHRcdHk6IHRoaXMuc2NhbGUuZW5kUG9pbnQsXG5cdFx0XHRcdGJhc2UgOiB0aGlzLnNjYWxlLmVuZFBvaW50XG5cdFx0XHR9KTtcblx0XHRcdHZhciBuZXdTY2FsZVByb3BzID0gaGVscGVycy5leHRlbmQoe1xuXHRcdFx0XHRoZWlnaHQgOiB0aGlzLmNoYXJ0LmhlaWdodCxcblx0XHRcdFx0d2lkdGggOiB0aGlzLmNoYXJ0LndpZHRoXG5cdFx0XHR9KTtcblx0XHRcdHRoaXMuc2NhbGUudXBkYXRlKG5ld1NjYWxlUHJvcHMpO1xuXHRcdH0sXG5cdFx0ZHJhdyA6IGZ1bmN0aW9uKGVhc2Upe1xuXHRcdFx0dmFyIGVhc2luZ0RlY2ltYWwgPSBlYXNlIHx8IDE7XG5cdFx0XHR0aGlzLmNsZWFyKCk7XG5cblx0XHRcdHZhciBjdHggPSB0aGlzLmNoYXJ0LmN0eDtcblxuXHRcdFx0dGhpcy5zY2FsZS5kcmF3KGVhc2luZ0RlY2ltYWwpO1xuXG5cdFx0XHQvL0RyYXcgYWxsIHRoZSBiYXJzIGZvciBlYWNoIGRhdGFzZXRcblx0XHRcdGhlbHBlcnMuZWFjaCh0aGlzLmRhdGFzZXRzLGZ1bmN0aW9uKGRhdGFzZXQsZGF0YXNldEluZGV4KXtcblx0XHRcdFx0aGVscGVycy5lYWNoKGRhdGFzZXQuYmFycyxmdW5jdGlvbihiYXIsaW5kZXgpe1xuXHRcdFx0XHRcdGlmIChiYXIuaGFzVmFsdWUoKSl7XG5cdFx0XHRcdFx0XHRiYXIuYmFzZSA9IHRoaXMuc2NhbGUuZW5kUG9pbnQ7XG5cdFx0XHRcdFx0XHQvL1RyYW5zaXRpb24gdGhlbiBkcmF3XG5cdFx0XHRcdFx0XHRiYXIudHJhbnNpdGlvbih7XG5cdFx0XHRcdFx0XHRcdHggOiB0aGlzLnNjYWxlLmNhbGN1bGF0ZUJhclgodGhpcy5kYXRhc2V0cy5sZW5ndGgsIGRhdGFzZXRJbmRleCwgaW5kZXgpLFxuXHRcdFx0XHRcdFx0XHR5IDogdGhpcy5zY2FsZS5jYWxjdWxhdGVZKGJhci52YWx1ZSksXG5cdFx0XHRcdFx0XHRcdHdpZHRoIDogdGhpcy5zY2FsZS5jYWxjdWxhdGVCYXJXaWR0aCh0aGlzLmRhdGFzZXRzLmxlbmd0aClcblx0XHRcdFx0XHRcdH0sIGVhc2luZ0RlY2ltYWwpLmRyYXcoKTtcblx0XHRcdFx0XHR9XG5cdFx0XHRcdH0sdGhpcyk7XG5cblx0XHRcdH0sdGhpcyk7XG5cdFx0fVxuXHR9KTtcblxuXG59KS5jYWxsKHRoaXMpO1xuXG4oZnVuY3Rpb24oKXtcblx0XCJ1c2Ugc3RyaWN0XCI7XG5cblx0dmFyIHJvb3QgPSB0aGlzLFxuXHRcdENoYXJ0ID0gcm9vdC5DaGFydCxcblx0XHQvL0NhY2hlIGEgbG9jYWwgcmVmZXJlbmNlIHRvIENoYXJ0LmhlbHBlcnNcblx0XHRoZWxwZXJzID0gQ2hhcnQuaGVscGVycztcblxuXHR2YXIgZGVmYXVsdENvbmZpZyA9IHtcblx0XHQvL0Jvb2xlYW4gLSBXaGV0aGVyIHdlIHNob3VsZCBzaG93IGEgc3Ryb2tlIG9uIGVhY2ggc2VnbWVudFxuXHRcdHNlZ21lbnRTaG93U3Ryb2tlIDogdHJ1ZSxcblxuXHRcdC8vU3RyaW5nIC0gVGhlIGNvbG91ciBvZiBlYWNoIHNlZ21lbnQgc3Ryb2tlXG5cdFx0c2VnbWVudFN0cm9rZUNvbG9yIDogXCIjZmZmXCIsXG5cblx0XHQvL051bWJlciAtIFRoZSB3aWR0aCBvZiBlYWNoIHNlZ21lbnQgc3Ryb2tlXG5cdFx0c2VnbWVudFN0cm9rZVdpZHRoIDogMixcblxuXHRcdC8vVGhlIHBlcmNlbnRhZ2Ugb2YgdGhlIGNoYXJ0IHRoYXQgd2UgY3V0IG91dCBvZiB0aGUgbWlkZGxlLlxuXHRcdHBlcmNlbnRhZ2VJbm5lckN1dG91dCA6IDUwLFxuXG5cdFx0Ly9OdW1iZXIgLSBBbW91bnQgb2YgYW5pbWF0aW9uIHN0ZXBzXG5cdFx0YW5pbWF0aW9uU3RlcHMgOiAxMDAsXG5cblx0XHQvL1N0cmluZyAtIEFuaW1hdGlvbiBlYXNpbmcgZWZmZWN0XG5cdFx0YW5pbWF0aW9uRWFzaW5nIDogXCJlYXNlT3V0Qm91bmNlXCIsXG5cblx0XHQvL0Jvb2xlYW4gLSBXaGV0aGVyIHdlIGFuaW1hdGUgdGhlIHJvdGF0aW9uIG9mIHRoZSBEb3VnaG51dFxuXHRcdGFuaW1hdGVSb3RhdGUgOiB0cnVlLFxuXG5cdFx0Ly9Cb29sZWFuIC0gV2hldGhlciB3ZSBhbmltYXRlIHNjYWxpbmcgdGhlIERvdWdobnV0IGZyb20gdGhlIGNlbnRyZVxuXHRcdGFuaW1hdGVTY2FsZSA6IGZhbHNlLFxuXG5cdFx0Ly9TdHJpbmcgLSBBIGxlZ2VuZCB0ZW1wbGF0ZVxuXHRcdGxlZ2VuZFRlbXBsYXRlIDogXCI8dWwgY2xhc3M9XFxcIjwlPW5hbWUudG9Mb3dlckNhc2UoKSU+LWxlZ2VuZFxcXCI+PCUgZm9yICh2YXIgaT0wOyBpPHNlZ21lbnRzLmxlbmd0aDsgaSsrKXslPjxsaT48c3BhbiBjbGFzcz1cXFwiPCU9bmFtZS50b0xvd2VyQ2FzZSgpJT4tbGVnZW5kLWljb25cXFwiIHN0eWxlPVxcXCJiYWNrZ3JvdW5kLWNvbG9yOjwlPXNlZ21lbnRzW2ldLmZpbGxDb2xvciU+XFxcIj48L3NwYW4+PHNwYW4gY2xhc3M9XFxcIjwlPW5hbWUudG9Mb3dlckNhc2UoKSU+LWxlZ2VuZC10ZXh0XFxcIj48JWlmKHNlZ21lbnRzW2ldLmxhYmVsKXslPjwlPXNlZ21lbnRzW2ldLmxhYmVsJT48JX0lPjwvc3Bhbj48L2xpPjwlfSU+PC91bD5cIlxuXG5cdH07XG5cblx0Q2hhcnQuVHlwZS5leHRlbmQoe1xuXHRcdC8vUGFzc2luZyBpbiBhIG5hbWUgcmVnaXN0ZXJzIHRoaXMgY2hhcnQgaW4gdGhlIENoYXJ0IG5hbWVzcGFjZVxuXHRcdG5hbWU6IFwiRG91Z2hudXRcIixcblx0XHQvL1Byb3ZpZGluZyBhIGRlZmF1bHRzIHdpbGwgYWxzbyByZWdpc3RlciB0aGUgZGVmYXVsdHMgaW4gdGhlIGNoYXJ0IG5hbWVzcGFjZVxuXHRcdGRlZmF1bHRzIDogZGVmYXVsdENvbmZpZyxcblx0XHQvL0luaXRpYWxpemUgaXMgZmlyZWQgd2hlbiB0aGUgY2hhcnQgaXMgaW5pdGlhbGl6ZWQgLSBEYXRhIGlzIHBhc3NlZCBpbiBhcyBhIHBhcmFtZXRlclxuXHRcdC8vQ29uZmlnIGlzIGF1dG9tYXRpY2FsbHkgbWVyZ2VkIGJ5IHRoZSBjb3JlIG9mIENoYXJ0LmpzLCBhbmQgaXMgYXZhaWxhYmxlIGF0IHRoaXMub3B0aW9uc1xuXHRcdGluaXRpYWxpemU6ICBmdW5jdGlvbihkYXRhKXtcblxuXHRcdFx0Ly9EZWNsYXJlIHNlZ21lbnRzIGFzIGEgc3RhdGljIHByb3BlcnR5IHRvIHByZXZlbnQgaW5oZXJpdGluZyBhY3Jvc3MgdGhlIENoYXJ0IHR5cGUgcHJvdG90eXBlXG5cdFx0XHR0aGlzLnNlZ21lbnRzID0gW107XG5cdFx0XHR0aGlzLm91dGVyUmFkaXVzID0gKGhlbHBlcnMubWluKFt0aGlzLmNoYXJ0LndpZHRoLHRoaXMuY2hhcnQuaGVpZ2h0XSkgLVx0dGhpcy5vcHRpb25zLnNlZ21lbnRTdHJva2VXaWR0aC8yKS8yO1xuXG5cdFx0XHR0aGlzLlNlZ21lbnRBcmMgPSBDaGFydC5BcmMuZXh0ZW5kKHtcblx0XHRcdFx0Y3R4IDogdGhpcy5jaGFydC5jdHgsXG5cdFx0XHRcdHggOiB0aGlzLmNoYXJ0LndpZHRoLzIsXG5cdFx0XHRcdHkgOiB0aGlzLmNoYXJ0LmhlaWdodC8yXG5cdFx0XHR9KTtcblxuXHRcdFx0Ly9TZXQgdXAgdG9vbHRpcCBldmVudHMgb24gdGhlIGNoYXJ0XG5cdFx0XHRpZiAodGhpcy5vcHRpb25zLnNob3dUb29sdGlwcyl7XG5cdFx0XHRcdGhlbHBlcnMuYmluZEV2ZW50cyh0aGlzLCB0aGlzLm9wdGlvbnMudG9vbHRpcEV2ZW50cywgZnVuY3Rpb24oZXZ0KXtcblx0XHRcdFx0XHR2YXIgYWN0aXZlU2VnbWVudHMgPSAoZXZ0LnR5cGUgIT09ICdtb3VzZW91dCcpID8gdGhpcy5nZXRTZWdtZW50c0F0RXZlbnQoZXZ0KSA6IFtdO1xuXG5cdFx0XHRcdFx0aGVscGVycy5lYWNoKHRoaXMuc2VnbWVudHMsZnVuY3Rpb24oc2VnbWVudCl7XG5cdFx0XHRcdFx0XHRzZWdtZW50LnJlc3RvcmUoW1wiZmlsbENvbG9yXCJdKTtcblx0XHRcdFx0XHR9KTtcblx0XHRcdFx0XHRoZWxwZXJzLmVhY2goYWN0aXZlU2VnbWVudHMsZnVuY3Rpb24oYWN0aXZlU2VnbWVudCl7XG5cdFx0XHRcdFx0XHRhY3RpdmVTZWdtZW50LmZpbGxDb2xvciA9IGFjdGl2ZVNlZ21lbnQuaGlnaGxpZ2h0Q29sb3I7XG5cdFx0XHRcdFx0fSk7XG5cdFx0XHRcdFx0dGhpcy5zaG93VG9vbHRpcChhY3RpdmVTZWdtZW50cyk7XG5cdFx0XHRcdH0pO1xuXHRcdFx0fVxuXHRcdFx0dGhpcy5jYWxjdWxhdGVUb3RhbChkYXRhKTtcblxuXHRcdFx0aGVscGVycy5lYWNoKGRhdGEsZnVuY3Rpb24oZGF0YXBvaW50LCBpbmRleCl7XG5cdFx0XHRcdGlmICghZGF0YXBvaW50LmNvbG9yKSB7XG5cdFx0XHRcdFx0ZGF0YXBvaW50LmNvbG9yID0gJ2hzbCgnICsgKDM2MCAqIGluZGV4IC8gZGF0YS5sZW5ndGgpICsgJywgMTAwJSwgNTAlKSc7XG5cdFx0XHRcdH1cblx0XHRcdFx0dGhpcy5hZGREYXRhKGRhdGFwb2ludCwgaW5kZXgsIHRydWUpO1xuXHRcdFx0fSx0aGlzKTtcblxuXHRcdFx0dGhpcy5yZW5kZXIoKTtcblx0XHR9LFxuXHRcdGdldFNlZ21lbnRzQXRFdmVudCA6IGZ1bmN0aW9uKGUpe1xuXHRcdFx0dmFyIHNlZ21lbnRzQXJyYXkgPSBbXTtcblxuXHRcdFx0dmFyIGxvY2F0aW9uID0gaGVscGVycy5nZXRSZWxhdGl2ZVBvc2l0aW9uKGUpO1xuXG5cdFx0XHRoZWxwZXJzLmVhY2godGhpcy5zZWdtZW50cyxmdW5jdGlvbihzZWdtZW50KXtcblx0XHRcdFx0aWYgKHNlZ21lbnQuaW5SYW5nZShsb2NhdGlvbi54LGxvY2F0aW9uLnkpKSBzZWdtZW50c0FycmF5LnB1c2goc2VnbWVudCk7XG5cdFx0XHR9LHRoaXMpO1xuXHRcdFx0cmV0dXJuIHNlZ21lbnRzQXJyYXk7XG5cdFx0fSxcblx0XHRhZGREYXRhIDogZnVuY3Rpb24oc2VnbWVudCwgYXRJbmRleCwgc2lsZW50KXtcblx0XHRcdHZhciBpbmRleCA9IGF0SW5kZXggIT09IHVuZGVmaW5lZCA/IGF0SW5kZXggOiB0aGlzLnNlZ21lbnRzLmxlbmd0aDtcblx0XHRcdGlmICggdHlwZW9mKHNlZ21lbnQuY29sb3IpID09PSBcInVuZGVmaW5lZFwiICkge1xuXHRcdFx0XHRzZWdtZW50LmNvbG9yID0gQ2hhcnQuZGVmYXVsdHMuZ2xvYmFsLnNlZ21lbnRDb2xvckRlZmF1bHRbaW5kZXggJSBDaGFydC5kZWZhdWx0cy5nbG9iYWwuc2VnbWVudENvbG9yRGVmYXVsdC5sZW5ndGhdO1xuXHRcdFx0XHRzZWdtZW50LmhpZ2hsaWdodCA9IENoYXJ0LmRlZmF1bHRzLmdsb2JhbC5zZWdtZW50SGlnaGxpZ2h0Q29sb3JEZWZhdWx0c1tpbmRleCAlIENoYXJ0LmRlZmF1bHRzLmdsb2JhbC5zZWdtZW50SGlnaGxpZ2h0Q29sb3JEZWZhdWx0cy5sZW5ndGhdO1x0XHRcdFx0XG5cdFx0XHR9XG5cdFx0XHR0aGlzLnNlZ21lbnRzLnNwbGljZShpbmRleCwgMCwgbmV3IHRoaXMuU2VnbWVudEFyYyh7XG5cdFx0XHRcdHZhbHVlIDogc2VnbWVudC52YWx1ZSxcblx0XHRcdFx0b3V0ZXJSYWRpdXMgOiAodGhpcy5vcHRpb25zLmFuaW1hdGVTY2FsZSkgPyAwIDogdGhpcy5vdXRlclJhZGl1cyxcblx0XHRcdFx0aW5uZXJSYWRpdXMgOiAodGhpcy5vcHRpb25zLmFuaW1hdGVTY2FsZSkgPyAwIDogKHRoaXMub3V0ZXJSYWRpdXMvMTAwKSAqIHRoaXMub3B0aW9ucy5wZXJjZW50YWdlSW5uZXJDdXRvdXQsXG5cdFx0XHRcdGZpbGxDb2xvciA6IHNlZ21lbnQuY29sb3IsXG5cdFx0XHRcdGhpZ2hsaWdodENvbG9yIDogc2VnbWVudC5oaWdobGlnaHQgfHwgc2VnbWVudC5jb2xvcixcblx0XHRcdFx0c2hvd1N0cm9rZSA6IHRoaXMub3B0aW9ucy5zZWdtZW50U2hvd1N0cm9rZSxcblx0XHRcdFx0c3Ryb2tlV2lkdGggOiB0aGlzLm9wdGlvbnMuc2VnbWVudFN0cm9rZVdpZHRoLFxuXHRcdFx0XHRzdHJva2VDb2xvciA6IHRoaXMub3B0aW9ucy5zZWdtZW50U3Ryb2tlQ29sb3IsXG5cdFx0XHRcdHN0YXJ0QW5nbGUgOiBNYXRoLlBJICogMS41LFxuXHRcdFx0XHRjaXJjdW1mZXJlbmNlIDogKHRoaXMub3B0aW9ucy5hbmltYXRlUm90YXRlKSA/IDAgOiB0aGlzLmNhbGN1bGF0ZUNpcmN1bWZlcmVuY2Uoc2VnbWVudC52YWx1ZSksXG5cdFx0XHRcdGxhYmVsIDogc2VnbWVudC5sYWJlbFxuXHRcdFx0fSkpO1xuXHRcdFx0aWYgKCFzaWxlbnQpe1xuXHRcdFx0XHR0aGlzLnJlZmxvdygpO1xuXHRcdFx0XHR0aGlzLnVwZGF0ZSgpO1xuXHRcdFx0fVxuXHRcdH0sXG5cdFx0Y2FsY3VsYXRlQ2lyY3VtZmVyZW5jZSA6IGZ1bmN0aW9uKHZhbHVlKSB7XG5cdFx0XHRpZiAoIHRoaXMudG90YWwgPiAwICkge1xuXHRcdFx0XHRyZXR1cm4gKE1hdGguUEkqMikqKHZhbHVlIC8gdGhpcy50b3RhbCk7XG5cdFx0XHR9IGVsc2Uge1xuXHRcdFx0XHRyZXR1cm4gMDtcblx0XHRcdH1cblx0XHR9LFxuXHRcdGNhbGN1bGF0ZVRvdGFsIDogZnVuY3Rpb24oZGF0YSl7XG5cdFx0XHR0aGlzLnRvdGFsID0gMDtcblx0XHRcdGhlbHBlcnMuZWFjaChkYXRhLGZ1bmN0aW9uKHNlZ21lbnQpe1xuXHRcdFx0XHR0aGlzLnRvdGFsICs9IE1hdGguYWJzKHNlZ21lbnQudmFsdWUpO1xuXHRcdFx0fSx0aGlzKTtcblx0XHR9LFxuXHRcdHVwZGF0ZSA6IGZ1bmN0aW9uKCl7XG5cdFx0XHR0aGlzLmNhbGN1bGF0ZVRvdGFsKHRoaXMuc2VnbWVudHMpO1xuXG5cdFx0XHQvLyBSZXNldCBhbnkgaGlnaGxpZ2h0IGNvbG91cnMgYmVmb3JlIHVwZGF0aW5nLlxuXHRcdFx0aGVscGVycy5lYWNoKHRoaXMuYWN0aXZlRWxlbWVudHMsIGZ1bmN0aW9uKGFjdGl2ZUVsZW1lbnQpe1xuXHRcdFx0XHRhY3RpdmVFbGVtZW50LnJlc3RvcmUoWydmaWxsQ29sb3InXSk7XG5cdFx0XHR9KTtcblxuXHRcdFx0aGVscGVycy5lYWNoKHRoaXMuc2VnbWVudHMsZnVuY3Rpb24oc2VnbWVudCl7XG5cdFx0XHRcdHNlZ21lbnQuc2F2ZSgpO1xuXHRcdFx0fSk7XG5cdFx0XHR0aGlzLnJlbmRlcigpO1xuXHRcdH0sXG5cblx0XHRyZW1vdmVEYXRhOiBmdW5jdGlvbihhdEluZGV4KXtcblx0XHRcdHZhciBpbmRleFRvRGVsZXRlID0gKGhlbHBlcnMuaXNOdW1iZXIoYXRJbmRleCkpID8gYXRJbmRleCA6IHRoaXMuc2VnbWVudHMubGVuZ3RoLTE7XG5cdFx0XHR0aGlzLnNlZ21lbnRzLnNwbGljZShpbmRleFRvRGVsZXRlLCAxKTtcblx0XHRcdHRoaXMucmVmbG93KCk7XG5cdFx0XHR0aGlzLnVwZGF0ZSgpO1xuXHRcdH0sXG5cblx0XHRyZWZsb3cgOiBmdW5jdGlvbigpe1xuXHRcdFx0aGVscGVycy5leHRlbmQodGhpcy5TZWdtZW50QXJjLnByb3RvdHlwZSx7XG5cdFx0XHRcdHggOiB0aGlzLmNoYXJ0LndpZHRoLzIsXG5cdFx0XHRcdHkgOiB0aGlzLmNoYXJ0LmhlaWdodC8yXG5cdFx0XHR9KTtcblx0XHRcdHRoaXMub3V0ZXJSYWRpdXMgPSAoaGVscGVycy5taW4oW3RoaXMuY2hhcnQud2lkdGgsdGhpcy5jaGFydC5oZWlnaHRdKSAtXHR0aGlzLm9wdGlvbnMuc2VnbWVudFN0cm9rZVdpZHRoLzIpLzI7XG5cdFx0XHRoZWxwZXJzLmVhY2godGhpcy5zZWdtZW50cywgZnVuY3Rpb24oc2VnbWVudCl7XG5cdFx0XHRcdHNlZ21lbnQudXBkYXRlKHtcblx0XHRcdFx0XHRvdXRlclJhZGl1cyA6IHRoaXMub3V0ZXJSYWRpdXMsXG5cdFx0XHRcdFx0aW5uZXJSYWRpdXMgOiAodGhpcy5vdXRlclJhZGl1cy8xMDApICogdGhpcy5vcHRpb25zLnBlcmNlbnRhZ2VJbm5lckN1dG91dFxuXHRcdFx0XHR9KTtcblx0XHRcdH0sIHRoaXMpO1xuXHRcdH0sXG5cdFx0ZHJhdyA6IGZ1bmN0aW9uKGVhc2VEZWNpbWFsKXtcblx0XHRcdHZhciBhbmltRGVjaW1hbCA9IChlYXNlRGVjaW1hbCkgPyBlYXNlRGVjaW1hbCA6IDE7XG5cdFx0XHR0aGlzLmNsZWFyKCk7XG5cdFx0XHRoZWxwZXJzLmVhY2godGhpcy5zZWdtZW50cyxmdW5jdGlvbihzZWdtZW50LGluZGV4KXtcblx0XHRcdFx0c2VnbWVudC50cmFuc2l0aW9uKHtcblx0XHRcdFx0XHRjaXJjdW1mZXJlbmNlIDogdGhpcy5jYWxjdWxhdGVDaXJjdW1mZXJlbmNlKHNlZ21lbnQudmFsdWUpLFxuXHRcdFx0XHRcdG91dGVyUmFkaXVzIDogdGhpcy5vdXRlclJhZGl1cyxcblx0XHRcdFx0XHRpbm5lclJhZGl1cyA6ICh0aGlzLm91dGVyUmFkaXVzLzEwMCkgKiB0aGlzLm9wdGlvbnMucGVyY2VudGFnZUlubmVyQ3V0b3V0XG5cdFx0XHRcdH0sYW5pbURlY2ltYWwpO1xuXG5cdFx0XHRcdHNlZ21lbnQuZW5kQW5nbGUgPSBzZWdtZW50LnN0YXJ0QW5nbGUgKyBzZWdtZW50LmNpcmN1bWZlcmVuY2U7XG5cblx0XHRcdFx0c2VnbWVudC5kcmF3KCk7XG5cdFx0XHRcdGlmIChpbmRleCA9PT0gMCl7XG5cdFx0XHRcdFx0c2VnbWVudC5zdGFydEFuZ2xlID0gTWF0aC5QSSAqIDEuNTtcblx0XHRcdFx0fVxuXHRcdFx0XHQvL0NoZWNrIHRvIHNlZSBpZiBpdCdzIHRoZSBsYXN0IHNlZ21lbnQsIGlmIG5vdCBnZXQgdGhlIG5leHQgYW5kIHVwZGF0ZSB0aGUgc3RhcnQgYW5nbGVcblx0XHRcdFx0aWYgKGluZGV4IDwgdGhpcy5zZWdtZW50cy5sZW5ndGgtMSl7XG5cdFx0XHRcdFx0dGhpcy5zZWdtZW50c1tpbmRleCsxXS5zdGFydEFuZ2xlID0gc2VnbWVudC5lbmRBbmdsZTtcblx0XHRcdFx0fVxuXHRcdFx0fSx0aGlzKTtcblxuXHRcdH1cblx0fSk7XG5cblx0Q2hhcnQudHlwZXMuRG91Z2hudXQuZXh0ZW5kKHtcblx0XHRuYW1lIDogXCJQaWVcIixcblx0XHRkZWZhdWx0cyA6IGhlbHBlcnMubWVyZ2UoZGVmYXVsdENvbmZpZyx7cGVyY2VudGFnZUlubmVyQ3V0b3V0IDogMH0pXG5cdH0pO1xuXG59KS5jYWxsKHRoaXMpO1xuXG4oZnVuY3Rpb24oKXtcblx0XCJ1c2Ugc3RyaWN0XCI7XG5cblx0dmFyIHJvb3QgPSB0aGlzLFxuXHRcdENoYXJ0ID0gcm9vdC5DaGFydCxcblx0XHRoZWxwZXJzID0gQ2hhcnQuaGVscGVycztcblxuXHR2YXIgZGVmYXVsdENvbmZpZyA9IHtcblxuXHRcdC8vL0Jvb2xlYW4gLSBXaGV0aGVyIGdyaWQgbGluZXMgYXJlIHNob3duIGFjcm9zcyB0aGUgY2hhcnRcblx0XHRzY2FsZVNob3dHcmlkTGluZXMgOiB0cnVlLFxuXG5cdFx0Ly9TdHJpbmcgLSBDb2xvdXIgb2YgdGhlIGdyaWQgbGluZXNcblx0XHRzY2FsZUdyaWRMaW5lQ29sb3IgOiBcInJnYmEoMCwwLDAsLjA1KVwiLFxuXG5cdFx0Ly9OdW1iZXIgLSBXaWR0aCBvZiB0aGUgZ3JpZCBsaW5lc1xuXHRcdHNjYWxlR3JpZExpbmVXaWR0aCA6IDEsXG5cblx0XHQvL0Jvb2xlYW4gLSBXaGV0aGVyIHRvIHNob3cgaG9yaXpvbnRhbCBsaW5lcyAoZXhjZXB0IFggYXhpcylcblx0XHRzY2FsZVNob3dIb3Jpem9udGFsTGluZXM6IHRydWUsXG5cblx0XHQvL0Jvb2xlYW4gLSBXaGV0aGVyIHRvIHNob3cgdmVydGljYWwgbGluZXMgKGV4Y2VwdCBZIGF4aXMpXG5cdFx0c2NhbGVTaG93VmVydGljYWxMaW5lczogdHJ1ZSxcblxuXHRcdC8vQm9vbGVhbiAtIFdoZXRoZXIgdGhlIGxpbmUgaXMgY3VydmVkIGJldHdlZW4gcG9pbnRzXG5cdFx0YmV6aWVyQ3VydmUgOiB0cnVlLFxuXG5cdFx0Ly9OdW1iZXIgLSBUZW5zaW9uIG9mIHRoZSBiZXppZXIgY3VydmUgYmV0d2VlbiBwb2ludHNcblx0XHRiZXppZXJDdXJ2ZVRlbnNpb24gOiAwLjQsXG5cblx0XHQvL0Jvb2xlYW4gLSBXaGV0aGVyIHRvIHNob3cgYSBkb3QgZm9yIGVhY2ggcG9pbnRcblx0XHRwb2ludERvdCA6IHRydWUsXG5cblx0XHQvL051bWJlciAtIFJhZGl1cyBvZiBlYWNoIHBvaW50IGRvdCBpbiBwaXhlbHNcblx0XHRwb2ludERvdFJhZGl1cyA6IDQsXG5cblx0XHQvL051bWJlciAtIFBpeGVsIHdpZHRoIG9mIHBvaW50IGRvdCBzdHJva2Vcblx0XHRwb2ludERvdFN0cm9rZVdpZHRoIDogMSxcblxuXHRcdC8vTnVtYmVyIC0gYW1vdW50IGV4dHJhIHRvIGFkZCB0byB0aGUgcmFkaXVzIHRvIGNhdGVyIGZvciBoaXQgZGV0ZWN0aW9uIG91dHNpZGUgdGhlIGRyYXduIHBvaW50XG5cdFx0cG9pbnRIaXREZXRlY3Rpb25SYWRpdXMgOiAyMCxcblxuXHRcdC8vQm9vbGVhbiAtIFdoZXRoZXIgdG8gc2hvdyBhIHN0cm9rZSBmb3IgZGF0YXNldHNcblx0XHRkYXRhc2V0U3Ryb2tlIDogdHJ1ZSxcblxuXHRcdC8vTnVtYmVyIC0gUGl4ZWwgd2lkdGggb2YgZGF0YXNldCBzdHJva2Vcblx0XHRkYXRhc2V0U3Ryb2tlV2lkdGggOiAyLFxuXG5cdFx0Ly9Cb29sZWFuIC0gV2hldGhlciB0byBmaWxsIHRoZSBkYXRhc2V0IHdpdGggYSBjb2xvdXJcblx0XHRkYXRhc2V0RmlsbCA6IHRydWUsXG5cblx0XHQvL1N0cmluZyAtIEEgbGVnZW5kIHRlbXBsYXRlXG5cdFx0bGVnZW5kVGVtcGxhdGUgOiBcIjx1bCBjbGFzcz1cXFwiPCU9bmFtZS50b0xvd2VyQ2FzZSgpJT4tbGVnZW5kXFxcIj48JSBmb3IgKHZhciBpPTA7IGk8ZGF0YXNldHMubGVuZ3RoOyBpKyspeyU+PGxpPjxzcGFuIGNsYXNzPVxcXCI8JT1uYW1lLnRvTG93ZXJDYXNlKCklPi1sZWdlbmQtaWNvblxcXCIgc3R5bGU9XFxcImJhY2tncm91bmQtY29sb3I6PCU9ZGF0YXNldHNbaV0uc3Ryb2tlQ29sb3IlPlxcXCI+PC9zcGFuPjxzcGFuIGNsYXNzPVxcXCI8JT1uYW1lLnRvTG93ZXJDYXNlKCklPi1sZWdlbmQtdGV4dFxcXCI+PCVpZihkYXRhc2V0c1tpXS5sYWJlbCl7JT48JT1kYXRhc2V0c1tpXS5sYWJlbCU+PCV9JT48L3NwYW4+PC9saT48JX0lPjwvdWw+XCIsXG5cblx0XHQvL0Jvb2xlYW4gLSBXaGV0aGVyIHRvIGhvcml6b250YWxseSBjZW50ZXIgdGhlIGxhYmVsIGFuZCBwb2ludCBkb3QgaW5zaWRlIHRoZSBncmlkXG5cdFx0b2Zmc2V0R3JpZExpbmVzIDogZmFsc2VcblxuXHR9O1xuXG5cblx0Q2hhcnQuVHlwZS5leHRlbmQoe1xuXHRcdG5hbWU6IFwiTGluZVwiLFxuXHRcdGRlZmF1bHRzIDogZGVmYXVsdENvbmZpZyxcblx0XHRpbml0aWFsaXplOiAgZnVuY3Rpb24oZGF0YSl7XG5cdFx0XHQvL0RlY2xhcmUgdGhlIGV4dGVuc2lvbiBvZiB0aGUgZGVmYXVsdCBwb2ludCwgdG8gY2F0ZXIgZm9yIHRoZSBvcHRpb25zIHBhc3NlZCBpbiB0byB0aGUgY29uc3RydWN0b3Jcblx0XHRcdHRoaXMuUG9pbnRDbGFzcyA9IENoYXJ0LlBvaW50LmV4dGVuZCh7XG5cdFx0XHRcdG9mZnNldEdyaWRMaW5lcyA6IHRoaXMub3B0aW9ucy5vZmZzZXRHcmlkTGluZXMsXG5cdFx0XHRcdHN0cm9rZVdpZHRoIDogdGhpcy5vcHRpb25zLnBvaW50RG90U3Ryb2tlV2lkdGgsXG5cdFx0XHRcdHJhZGl1cyA6IHRoaXMub3B0aW9ucy5wb2ludERvdFJhZGl1cyxcblx0XHRcdFx0ZGlzcGxheTogdGhpcy5vcHRpb25zLnBvaW50RG90LFxuXHRcdFx0XHRoaXREZXRlY3Rpb25SYWRpdXMgOiB0aGlzLm9wdGlvbnMucG9pbnRIaXREZXRlY3Rpb25SYWRpdXMsXG5cdFx0XHRcdGN0eCA6IHRoaXMuY2hhcnQuY3R4LFxuXHRcdFx0XHRpblJhbmdlIDogZnVuY3Rpb24obW91c2VYKXtcblx0XHRcdFx0XHRyZXR1cm4gKE1hdGgucG93KG1vdXNlWC10aGlzLngsIDIpIDwgTWF0aC5wb3codGhpcy5yYWRpdXMgKyB0aGlzLmhpdERldGVjdGlvblJhZGl1cywyKSk7XG5cdFx0XHRcdH1cblx0XHRcdH0pO1xuXG5cdFx0XHR0aGlzLmRhdGFzZXRzID0gW107XG5cblx0XHRcdC8vU2V0IHVwIHRvb2x0aXAgZXZlbnRzIG9uIHRoZSBjaGFydFxuXHRcdFx0aWYgKHRoaXMub3B0aW9ucy5zaG93VG9vbHRpcHMpe1xuXHRcdFx0XHRoZWxwZXJzLmJpbmRFdmVudHModGhpcywgdGhpcy5vcHRpb25zLnRvb2x0aXBFdmVudHMsIGZ1bmN0aW9uKGV2dCl7XG5cdFx0XHRcdFx0dmFyIGFjdGl2ZVBvaW50cyA9IChldnQudHlwZSAhPT0gJ21vdXNlb3V0JykgPyB0aGlzLmdldFBvaW50c0F0RXZlbnQoZXZ0KSA6IFtdO1xuXHRcdFx0XHRcdHRoaXMuZWFjaFBvaW50cyhmdW5jdGlvbihwb2ludCl7XG5cdFx0XHRcdFx0XHRwb2ludC5yZXN0b3JlKFsnZmlsbENvbG9yJywgJ3N0cm9rZUNvbG9yJ10pO1xuXHRcdFx0XHRcdH0pO1xuXHRcdFx0XHRcdGhlbHBlcnMuZWFjaChhY3RpdmVQb2ludHMsIGZ1bmN0aW9uKGFjdGl2ZVBvaW50KXtcblx0XHRcdFx0XHRcdGFjdGl2ZVBvaW50LmZpbGxDb2xvciA9IGFjdGl2ZVBvaW50LmhpZ2hsaWdodEZpbGw7XG5cdFx0XHRcdFx0XHRhY3RpdmVQb2ludC5zdHJva2VDb2xvciA9IGFjdGl2ZVBvaW50LmhpZ2hsaWdodFN0cm9rZTtcblx0XHRcdFx0XHR9KTtcblx0XHRcdFx0XHR0aGlzLnNob3dUb29sdGlwKGFjdGl2ZVBvaW50cyk7XG5cdFx0XHRcdH0pO1xuXHRcdFx0fVxuXG5cdFx0XHQvL0l0ZXJhdGUgdGhyb3VnaCBlYWNoIG9mIHRoZSBkYXRhc2V0cywgYW5kIGJ1aWxkIHRoaXMgaW50byBhIHByb3BlcnR5IG9mIHRoZSBjaGFydFxuXHRcdFx0aGVscGVycy5lYWNoKGRhdGEuZGF0YXNldHMsZnVuY3Rpb24oZGF0YXNldCl7XG5cblx0XHRcdFx0dmFyIGRhdGFzZXRPYmplY3QgPSB7XG5cdFx0XHRcdFx0bGFiZWwgOiBkYXRhc2V0LmxhYmVsIHx8IG51bGwsXG5cdFx0XHRcdFx0ZmlsbENvbG9yIDogZGF0YXNldC5maWxsQ29sb3IsXG5cdFx0XHRcdFx0c3Ryb2tlQ29sb3IgOiBkYXRhc2V0LnN0cm9rZUNvbG9yLFxuXHRcdFx0XHRcdHBvaW50Q29sb3IgOiBkYXRhc2V0LnBvaW50Q29sb3IsXG5cdFx0XHRcdFx0cG9pbnRTdHJva2VDb2xvciA6IGRhdGFzZXQucG9pbnRTdHJva2VDb2xvcixcblx0XHRcdFx0XHRwb2ludHMgOiBbXVxuXHRcdFx0XHR9O1xuXG5cdFx0XHRcdHRoaXMuZGF0YXNldHMucHVzaChkYXRhc2V0T2JqZWN0KTtcblxuXG5cdFx0XHRcdGhlbHBlcnMuZWFjaChkYXRhc2V0LmRhdGEsZnVuY3Rpb24oZGF0YVBvaW50LGluZGV4KXtcblx0XHRcdFx0XHQvL0FkZCBhIG5ldyBwb2ludCBmb3IgZWFjaCBwaWVjZSBvZiBkYXRhLCBwYXNzaW5nIGFueSByZXF1aXJlZCBkYXRhIHRvIGRyYXcuXG5cdFx0XHRcdFx0ZGF0YXNldE9iamVjdC5wb2ludHMucHVzaChuZXcgdGhpcy5Qb2ludENsYXNzKHtcblx0XHRcdFx0XHRcdHZhbHVlIDogZGF0YVBvaW50LFxuXHRcdFx0XHRcdFx0bGFiZWwgOiBkYXRhLmxhYmVsc1tpbmRleF0sXG5cdFx0XHRcdFx0XHRkYXRhc2V0TGFiZWw6IGRhdGFzZXQubGFiZWwsXG5cdFx0XHRcdFx0XHRzdHJva2VDb2xvciA6IGRhdGFzZXQucG9pbnRTdHJva2VDb2xvcixcblx0XHRcdFx0XHRcdGZpbGxDb2xvciA6IGRhdGFzZXQucG9pbnRDb2xvcixcblx0XHRcdFx0XHRcdGhpZ2hsaWdodEZpbGwgOiBkYXRhc2V0LnBvaW50SGlnaGxpZ2h0RmlsbCB8fCBkYXRhc2V0LnBvaW50Q29sb3IsXG5cdFx0XHRcdFx0XHRoaWdobGlnaHRTdHJva2UgOiBkYXRhc2V0LnBvaW50SGlnaGxpZ2h0U3Ryb2tlIHx8IGRhdGFzZXQucG9pbnRTdHJva2VDb2xvclxuXHRcdFx0XHRcdH0pKTtcblx0XHRcdFx0fSx0aGlzKTtcblxuXHRcdFx0XHR0aGlzLmJ1aWxkU2NhbGUoZGF0YS5sYWJlbHMpO1xuXG5cblx0XHRcdFx0dGhpcy5lYWNoUG9pbnRzKGZ1bmN0aW9uKHBvaW50LCBpbmRleCl7XG5cdFx0XHRcdFx0aGVscGVycy5leHRlbmQocG9pbnQsIHtcblx0XHRcdFx0XHRcdHg6IHRoaXMuc2NhbGUuY2FsY3VsYXRlWChpbmRleCksXG5cdFx0XHRcdFx0XHR5OiB0aGlzLnNjYWxlLmVuZFBvaW50XG5cdFx0XHRcdFx0fSk7XG5cdFx0XHRcdFx0cG9pbnQuc2F2ZSgpO1xuXHRcdFx0XHR9LCB0aGlzKTtcblxuXHRcdFx0fSx0aGlzKTtcblxuXG5cdFx0XHR0aGlzLnJlbmRlcigpO1xuXHRcdH0sXG5cdFx0dXBkYXRlIDogZnVuY3Rpb24oKXtcblx0XHRcdHRoaXMuc2NhbGUudXBkYXRlKCk7XG5cdFx0XHQvLyBSZXNldCBhbnkgaGlnaGxpZ2h0IGNvbG91cnMgYmVmb3JlIHVwZGF0aW5nLlxuXHRcdFx0aGVscGVycy5lYWNoKHRoaXMuYWN0aXZlRWxlbWVudHMsIGZ1bmN0aW9uKGFjdGl2ZUVsZW1lbnQpe1xuXHRcdFx0XHRhY3RpdmVFbGVtZW50LnJlc3RvcmUoWydmaWxsQ29sb3InLCAnc3Ryb2tlQ29sb3InXSk7XG5cdFx0XHR9KTtcblx0XHRcdHRoaXMuZWFjaFBvaW50cyhmdW5jdGlvbihwb2ludCl7XG5cdFx0XHRcdHBvaW50LnNhdmUoKTtcblx0XHRcdH0pO1xuXHRcdFx0dGhpcy5yZW5kZXIoKTtcblx0XHR9LFxuXHRcdGVhY2hQb2ludHMgOiBmdW5jdGlvbihjYWxsYmFjayl7XG5cdFx0XHRoZWxwZXJzLmVhY2godGhpcy5kYXRhc2V0cyxmdW5jdGlvbihkYXRhc2V0KXtcblx0XHRcdFx0aGVscGVycy5lYWNoKGRhdGFzZXQucG9pbnRzLGNhbGxiYWNrLHRoaXMpO1xuXHRcdFx0fSx0aGlzKTtcblx0XHR9LFxuXHRcdGdldFBvaW50c0F0RXZlbnQgOiBmdW5jdGlvbihlKXtcblx0XHRcdHZhciBwb2ludHNBcnJheSA9IFtdLFxuXHRcdFx0XHRldmVudFBvc2l0aW9uID0gaGVscGVycy5nZXRSZWxhdGl2ZVBvc2l0aW9uKGUpO1xuXHRcdFx0aGVscGVycy5lYWNoKHRoaXMuZGF0YXNldHMsZnVuY3Rpb24oZGF0YXNldCl7XG5cdFx0XHRcdGhlbHBlcnMuZWFjaChkYXRhc2V0LnBvaW50cyxmdW5jdGlvbihwb2ludCl7XG5cdFx0XHRcdFx0aWYgKHBvaW50LmluUmFuZ2UoZXZlbnRQb3NpdGlvbi54LGV2ZW50UG9zaXRpb24ueSkpIHBvaW50c0FycmF5LnB1c2gocG9pbnQpO1xuXHRcdFx0XHR9KTtcblx0XHRcdH0sdGhpcyk7XG5cdFx0XHRyZXR1cm4gcG9pbnRzQXJyYXk7XG5cdFx0fSxcblx0XHRidWlsZFNjYWxlIDogZnVuY3Rpb24obGFiZWxzKXtcblx0XHRcdHZhciBzZWxmID0gdGhpcztcblxuXHRcdFx0dmFyIGRhdGFUb3RhbCA9IGZ1bmN0aW9uKCl7XG5cdFx0XHRcdHZhciB2YWx1ZXMgPSBbXTtcblx0XHRcdFx0c2VsZi5lYWNoUG9pbnRzKGZ1bmN0aW9uKHBvaW50KXtcblx0XHRcdFx0XHR2YWx1ZXMucHVzaChwb2ludC52YWx1ZSk7XG5cdFx0XHRcdH0pO1xuXG5cdFx0XHRcdHJldHVybiB2YWx1ZXM7XG5cdFx0XHR9O1xuXG5cdFx0XHR2YXIgc2NhbGVPcHRpb25zID0ge1xuXHRcdFx0XHR0ZW1wbGF0ZVN0cmluZyA6IHRoaXMub3B0aW9ucy5zY2FsZUxhYmVsLFxuXHRcdFx0XHRoZWlnaHQgOiB0aGlzLmNoYXJ0LmhlaWdodCxcblx0XHRcdFx0d2lkdGggOiB0aGlzLmNoYXJ0LndpZHRoLFxuXHRcdFx0XHRjdHggOiB0aGlzLmNoYXJ0LmN0eCxcblx0XHRcdFx0dGV4dENvbG9yIDogdGhpcy5vcHRpb25zLnNjYWxlRm9udENvbG9yLFxuXHRcdFx0XHRvZmZzZXRHcmlkTGluZXMgOiB0aGlzLm9wdGlvbnMub2Zmc2V0R3JpZExpbmVzLFxuXHRcdFx0XHRmb250U2l6ZSA6IHRoaXMub3B0aW9ucy5zY2FsZUZvbnRTaXplLFxuXHRcdFx0XHRmb250U3R5bGUgOiB0aGlzLm9wdGlvbnMuc2NhbGVGb250U3R5bGUsXG5cdFx0XHRcdGZvbnRGYW1pbHkgOiB0aGlzLm9wdGlvbnMuc2NhbGVGb250RmFtaWx5LFxuXHRcdFx0XHR2YWx1ZXNDb3VudCA6IGxhYmVscy5sZW5ndGgsXG5cdFx0XHRcdGJlZ2luQXRaZXJvIDogdGhpcy5vcHRpb25zLnNjYWxlQmVnaW5BdFplcm8sXG5cdFx0XHRcdGludGVnZXJzT25seSA6IHRoaXMub3B0aW9ucy5zY2FsZUludGVnZXJzT25seSxcblx0XHRcdFx0Y2FsY3VsYXRlWVJhbmdlIDogZnVuY3Rpb24oY3VycmVudEhlaWdodCl7XG5cdFx0XHRcdFx0dmFyIHVwZGF0ZWRSYW5nZXMgPSBoZWxwZXJzLmNhbGN1bGF0ZVNjYWxlUmFuZ2UoXG5cdFx0XHRcdFx0XHRkYXRhVG90YWwoKSxcblx0XHRcdFx0XHRcdGN1cnJlbnRIZWlnaHQsXG5cdFx0XHRcdFx0XHR0aGlzLmZvbnRTaXplLFxuXHRcdFx0XHRcdFx0dGhpcy5iZWdpbkF0WmVybyxcblx0XHRcdFx0XHRcdHRoaXMuaW50ZWdlcnNPbmx5XG5cdFx0XHRcdFx0KTtcblx0XHRcdFx0XHRoZWxwZXJzLmV4dGVuZCh0aGlzLCB1cGRhdGVkUmFuZ2VzKTtcblx0XHRcdFx0fSxcblx0XHRcdFx0eExhYmVscyA6IGxhYmVscyxcblx0XHRcdFx0Zm9udCA6IGhlbHBlcnMuZm9udFN0cmluZyh0aGlzLm9wdGlvbnMuc2NhbGVGb250U2l6ZSwgdGhpcy5vcHRpb25zLnNjYWxlRm9udFN0eWxlLCB0aGlzLm9wdGlvbnMuc2NhbGVGb250RmFtaWx5KSxcblx0XHRcdFx0bGluZVdpZHRoIDogdGhpcy5vcHRpb25zLnNjYWxlTGluZVdpZHRoLFxuXHRcdFx0XHRsaW5lQ29sb3IgOiB0aGlzLm9wdGlvbnMuc2NhbGVMaW5lQ29sb3IsXG5cdFx0XHRcdHNob3dIb3Jpem9udGFsTGluZXMgOiB0aGlzLm9wdGlvbnMuc2NhbGVTaG93SG9yaXpvbnRhbExpbmVzLFxuXHRcdFx0XHRzaG93VmVydGljYWxMaW5lcyA6IHRoaXMub3B0aW9ucy5zY2FsZVNob3dWZXJ0aWNhbExpbmVzLFxuXHRcdFx0XHRncmlkTGluZVdpZHRoIDogKHRoaXMub3B0aW9ucy5zY2FsZVNob3dHcmlkTGluZXMpID8gdGhpcy5vcHRpb25zLnNjYWxlR3JpZExpbmVXaWR0aCA6IDAsXG5cdFx0XHRcdGdyaWRMaW5lQ29sb3IgOiAodGhpcy5vcHRpb25zLnNjYWxlU2hvd0dyaWRMaW5lcykgPyB0aGlzLm9wdGlvbnMuc2NhbGVHcmlkTGluZUNvbG9yIDogXCJyZ2JhKDAsMCwwLDApXCIsXG5cdFx0XHRcdHBhZGRpbmc6ICh0aGlzLm9wdGlvbnMuc2hvd1NjYWxlKSA/IDAgOiB0aGlzLm9wdGlvbnMucG9pbnREb3RSYWRpdXMgKyB0aGlzLm9wdGlvbnMucG9pbnREb3RTdHJva2VXaWR0aCxcblx0XHRcdFx0c2hvd0xhYmVscyA6IHRoaXMub3B0aW9ucy5zY2FsZVNob3dMYWJlbHMsXG5cdFx0XHRcdGRpc3BsYXkgOiB0aGlzLm9wdGlvbnMuc2hvd1NjYWxlXG5cdFx0XHR9O1xuXG5cdFx0XHRpZiAodGhpcy5vcHRpb25zLnNjYWxlT3ZlcnJpZGUpe1xuXHRcdFx0XHRoZWxwZXJzLmV4dGVuZChzY2FsZU9wdGlvbnMsIHtcblx0XHRcdFx0XHRjYWxjdWxhdGVZUmFuZ2U6IGhlbHBlcnMubm9vcCxcblx0XHRcdFx0XHRzdGVwczogdGhpcy5vcHRpb25zLnNjYWxlU3RlcHMsXG5cdFx0XHRcdFx0c3RlcFZhbHVlOiB0aGlzLm9wdGlvbnMuc2NhbGVTdGVwV2lkdGgsXG5cdFx0XHRcdFx0bWluOiB0aGlzLm9wdGlvbnMuc2NhbGVTdGFydFZhbHVlLFxuXHRcdFx0XHRcdG1heDogdGhpcy5vcHRpb25zLnNjYWxlU3RhcnRWYWx1ZSArICh0aGlzLm9wdGlvbnMuc2NhbGVTdGVwcyAqIHRoaXMub3B0aW9ucy5zY2FsZVN0ZXBXaWR0aClcblx0XHRcdFx0fSk7XG5cdFx0XHR9XG5cblxuXHRcdFx0dGhpcy5zY2FsZSA9IG5ldyBDaGFydC5TY2FsZShzY2FsZU9wdGlvbnMpO1xuXHRcdH0sXG5cdFx0YWRkRGF0YSA6IGZ1bmN0aW9uKHZhbHVlc0FycmF5LGxhYmVsKXtcblx0XHRcdC8vTWFwIHRoZSB2YWx1ZXMgYXJyYXkgZm9yIGVhY2ggb2YgdGhlIGRhdGFzZXRzXG5cblx0XHRcdGhlbHBlcnMuZWFjaCh2YWx1ZXNBcnJheSxmdW5jdGlvbih2YWx1ZSxkYXRhc2V0SW5kZXgpe1xuXHRcdFx0XHQvL0FkZCBhIG5ldyBwb2ludCBmb3IgZWFjaCBwaWVjZSBvZiBkYXRhLCBwYXNzaW5nIGFueSByZXF1aXJlZCBkYXRhIHRvIGRyYXcuXG5cdFx0XHRcdHRoaXMuZGF0YXNldHNbZGF0YXNldEluZGV4XS5wb2ludHMucHVzaChuZXcgdGhpcy5Qb2ludENsYXNzKHtcblx0XHRcdFx0XHR2YWx1ZSA6IHZhbHVlLFxuXHRcdFx0XHRcdGxhYmVsIDogbGFiZWwsXG5cdFx0XHRcdFx0ZGF0YXNldExhYmVsOiB0aGlzLmRhdGFzZXRzW2RhdGFzZXRJbmRleF0ubGFiZWwsXG5cdFx0XHRcdFx0eDogdGhpcy5zY2FsZS5jYWxjdWxhdGVYKHRoaXMuc2NhbGUudmFsdWVzQ291bnQrMSksXG5cdFx0XHRcdFx0eTogdGhpcy5zY2FsZS5lbmRQb2ludCxcblx0XHRcdFx0XHRzdHJva2VDb2xvciA6IHRoaXMuZGF0YXNldHNbZGF0YXNldEluZGV4XS5wb2ludFN0cm9rZUNvbG9yLFxuXHRcdFx0XHRcdGZpbGxDb2xvciA6IHRoaXMuZGF0YXNldHNbZGF0YXNldEluZGV4XS5wb2ludENvbG9yXG5cdFx0XHRcdH0pKTtcblx0XHRcdH0sdGhpcyk7XG5cblx0XHRcdHRoaXMuc2NhbGUuYWRkWExhYmVsKGxhYmVsKTtcblx0XHRcdC8vVGhlbiByZS1yZW5kZXIgdGhlIGNoYXJ0LlxuXHRcdFx0dGhpcy51cGRhdGUoKTtcblx0XHR9LFxuXHRcdHJlbW92ZURhdGEgOiBmdW5jdGlvbigpe1xuXHRcdFx0dGhpcy5zY2FsZS5yZW1vdmVYTGFiZWwoKTtcblx0XHRcdC8vVGhlbiByZS1yZW5kZXIgdGhlIGNoYXJ0LlxuXHRcdFx0aGVscGVycy5lYWNoKHRoaXMuZGF0YXNldHMsZnVuY3Rpb24oZGF0YXNldCl7XG5cdFx0XHRcdGRhdGFzZXQucG9pbnRzLnNoaWZ0KCk7XG5cdFx0XHR9LHRoaXMpO1xuXHRcdFx0dGhpcy51cGRhdGUoKTtcblx0XHR9LFxuXHRcdHJlZmxvdyA6IGZ1bmN0aW9uKCl7XG5cdFx0XHR2YXIgbmV3U2NhbGVQcm9wcyA9IGhlbHBlcnMuZXh0ZW5kKHtcblx0XHRcdFx0aGVpZ2h0IDogdGhpcy5jaGFydC5oZWlnaHQsXG5cdFx0XHRcdHdpZHRoIDogdGhpcy5jaGFydC53aWR0aFxuXHRcdFx0fSk7XG5cdFx0XHR0aGlzLnNjYWxlLnVwZGF0ZShuZXdTY2FsZVByb3BzKTtcblx0XHR9LFxuXHRcdGRyYXcgOiBmdW5jdGlvbihlYXNlKXtcblx0XHRcdHZhciBlYXNpbmdEZWNpbWFsID0gZWFzZSB8fCAxO1xuXHRcdFx0dGhpcy5jbGVhcigpO1xuXG5cdFx0XHR2YXIgY3R4ID0gdGhpcy5jaGFydC5jdHg7XG5cblx0XHRcdC8vIFNvbWUgaGVscGVyIG1ldGhvZHMgZm9yIGdldHRpbmcgdGhlIG5leHQvcHJldiBwb2ludHNcblx0XHRcdHZhciBoYXNWYWx1ZSA9IGZ1bmN0aW9uKGl0ZW0pe1xuXHRcdFx0XHRyZXR1cm4gaXRlbS52YWx1ZSAhPT0gbnVsbDtcblx0XHRcdH0sXG5cdFx0XHRuZXh0UG9pbnQgPSBmdW5jdGlvbihwb2ludCwgY29sbGVjdGlvbiwgaW5kZXgpe1xuXHRcdFx0XHRyZXR1cm4gaGVscGVycy5maW5kTmV4dFdoZXJlKGNvbGxlY3Rpb24sIGhhc1ZhbHVlLCBpbmRleCkgfHwgcG9pbnQ7XG5cdFx0XHR9LFxuXHRcdFx0cHJldmlvdXNQb2ludCA9IGZ1bmN0aW9uKHBvaW50LCBjb2xsZWN0aW9uLCBpbmRleCl7XG5cdFx0XHRcdHJldHVybiBoZWxwZXJzLmZpbmRQcmV2aW91c1doZXJlKGNvbGxlY3Rpb24sIGhhc1ZhbHVlLCBpbmRleCkgfHwgcG9pbnQ7XG5cdFx0XHR9O1xuXG5cdFx0XHRpZiAoIXRoaXMuc2NhbGUpIHJldHVybjtcblx0XHRcdHRoaXMuc2NhbGUuZHJhdyhlYXNpbmdEZWNpbWFsKTtcblxuXG5cdFx0XHRoZWxwZXJzLmVhY2godGhpcy5kYXRhc2V0cyxmdW5jdGlvbihkYXRhc2V0KXtcblx0XHRcdFx0dmFyIHBvaW50c1dpdGhWYWx1ZXMgPSBoZWxwZXJzLndoZXJlKGRhdGFzZXQucG9pbnRzLCBoYXNWYWx1ZSk7XG5cblx0XHRcdFx0Ly9UcmFuc2l0aW9uIGVhY2ggcG9pbnQgZmlyc3Qgc28gdGhhdCB0aGUgbGluZSBhbmQgcG9pbnQgZHJhd2luZyBpc24ndCBvdXQgb2Ygc3luY1xuXHRcdFx0XHQvL1dlIGNhbiB1c2UgdGhpcyBleHRyYSBsb29wIHRvIGNhbGN1bGF0ZSB0aGUgY29udHJvbCBwb2ludHMgb2YgdGhpcyBkYXRhc2V0IGFsc28gaW4gdGhpcyBsb29wXG5cblx0XHRcdFx0aGVscGVycy5lYWNoKGRhdGFzZXQucG9pbnRzLCBmdW5jdGlvbihwb2ludCwgaW5kZXgpe1xuXHRcdFx0XHRcdGlmIChwb2ludC5oYXNWYWx1ZSgpKXtcblx0XHRcdFx0XHRcdHBvaW50LnRyYW5zaXRpb24oe1xuXHRcdFx0XHRcdFx0XHR5IDogdGhpcy5zY2FsZS5jYWxjdWxhdGVZKHBvaW50LnZhbHVlKSxcblx0XHRcdFx0XHRcdFx0eCA6IHRoaXMuc2NhbGUuY2FsY3VsYXRlWChpbmRleClcblx0XHRcdFx0XHRcdH0sIGVhc2luZ0RlY2ltYWwpO1xuXHRcdFx0XHRcdH1cblx0XHRcdFx0fSx0aGlzKTtcblxuXG5cdFx0XHRcdC8vIENvbnRyb2wgcG9pbnRzIG5lZWQgdG8gYmUgY2FsY3VsYXRlZCBpbiBhIHNlcGFyYXRlIGxvb3AsIGJlY2F1c2Ugd2UgbmVlZCB0byBrbm93IHRoZSBjdXJyZW50IHgveSBvZiB0aGUgcG9pbnRcblx0XHRcdFx0Ly8gVGhpcyB3b3VsZCBjYXVzZSBpc3N1ZXMgd2hlbiB0aGVyZSBpcyBubyBhbmltYXRpb24sIGJlY2F1c2UgdGhlIHkgb2YgdGhlIG5leHQgcG9pbnQgd291bGQgYmUgMCwgc28gYmV6aWVycyB3b3VsZCBiZSBza2V3ZWRcblx0XHRcdFx0aWYgKHRoaXMub3B0aW9ucy5iZXppZXJDdXJ2ZSl7XG5cdFx0XHRcdFx0aGVscGVycy5lYWNoKHBvaW50c1dpdGhWYWx1ZXMsIGZ1bmN0aW9uKHBvaW50LCBpbmRleCl7XG5cdFx0XHRcdFx0XHR2YXIgdGVuc2lvbiA9IChpbmRleCA+IDAgJiYgaW5kZXggPCBwb2ludHNXaXRoVmFsdWVzLmxlbmd0aCAtIDEpID8gdGhpcy5vcHRpb25zLmJlemllckN1cnZlVGVuc2lvbiA6IDA7XG5cdFx0XHRcdFx0XHRwb2ludC5jb250cm9sUG9pbnRzID0gaGVscGVycy5zcGxpbmVDdXJ2ZShcblx0XHRcdFx0XHRcdFx0cHJldmlvdXNQb2ludChwb2ludCwgcG9pbnRzV2l0aFZhbHVlcywgaW5kZXgpLFxuXHRcdFx0XHRcdFx0XHRwb2ludCxcblx0XHRcdFx0XHRcdFx0bmV4dFBvaW50KHBvaW50LCBwb2ludHNXaXRoVmFsdWVzLCBpbmRleCksXG5cdFx0XHRcdFx0XHRcdHRlbnNpb25cblx0XHRcdFx0XHRcdCk7XG5cblx0XHRcdFx0XHRcdC8vIFByZXZlbnQgdGhlIGJlemllciBnb2luZyBvdXRzaWRlIG9mIHRoZSBib3VuZHMgb2YgdGhlIGdyYXBoXG5cblx0XHRcdFx0XHRcdC8vIENhcCBwdXRlciBiZXppZXIgaGFuZGxlcyB0byB0aGUgdXBwZXIvbG93ZXIgc2NhbGUgYm91bmRzXG5cdFx0XHRcdFx0XHRpZiAocG9pbnQuY29udHJvbFBvaW50cy5vdXRlci55ID4gdGhpcy5zY2FsZS5lbmRQb2ludCl7XG5cdFx0XHRcdFx0XHRcdHBvaW50LmNvbnRyb2xQb2ludHMub3V0ZXIueSA9IHRoaXMuc2NhbGUuZW5kUG9pbnQ7XG5cdFx0XHRcdFx0XHR9XG5cdFx0XHRcdFx0XHRlbHNlIGlmIChwb2ludC5jb250cm9sUG9pbnRzLm91dGVyLnkgPCB0aGlzLnNjYWxlLnN0YXJ0UG9pbnQpe1xuXHRcdFx0XHRcdFx0XHRwb2ludC5jb250cm9sUG9pbnRzLm91dGVyLnkgPSB0aGlzLnNjYWxlLnN0YXJ0UG9pbnQ7XG5cdFx0XHRcdFx0XHR9XG5cblx0XHRcdFx0XHRcdC8vIENhcCBpbm5lciBiZXppZXIgaGFuZGxlcyB0byB0aGUgdXBwZXIvbG93ZXIgc2NhbGUgYm91bmRzXG5cdFx0XHRcdFx0XHRpZiAocG9pbnQuY29udHJvbFBvaW50cy5pbm5lci55ID4gdGhpcy5zY2FsZS5lbmRQb2ludCl7XG5cdFx0XHRcdFx0XHRcdHBvaW50LmNvbnRyb2xQb2ludHMuaW5uZXIueSA9IHRoaXMuc2NhbGUuZW5kUG9pbnQ7XG5cdFx0XHRcdFx0XHR9XG5cdFx0XHRcdFx0XHRlbHNlIGlmIChwb2ludC5jb250cm9sUG9pbnRzLmlubmVyLnkgPCB0aGlzLnNjYWxlLnN0YXJ0UG9pbnQpe1xuXHRcdFx0XHRcdFx0XHRwb2ludC5jb250cm9sUG9pbnRzLmlubmVyLnkgPSB0aGlzLnNjYWxlLnN0YXJ0UG9pbnQ7XG5cdFx0XHRcdFx0XHR9XG5cdFx0XHRcdFx0fSx0aGlzKTtcblx0XHRcdFx0fVxuXG5cblx0XHRcdFx0Ly9EcmF3IHRoZSBsaW5lIGJldHdlZW4gYWxsIHRoZSBwb2ludHNcblx0XHRcdFx0Y3R4LmxpbmVXaWR0aCA9IHRoaXMub3B0aW9ucy5kYXRhc2V0U3Ryb2tlV2lkdGg7XG5cdFx0XHRcdGN0eC5zdHJva2VTdHlsZSA9IGRhdGFzZXQuc3Ryb2tlQ29sb3I7XG5cdFx0XHRcdGN0eC5iZWdpblBhdGgoKTtcblxuXHRcdFx0XHRoZWxwZXJzLmVhY2gocG9pbnRzV2l0aFZhbHVlcywgZnVuY3Rpb24ocG9pbnQsIGluZGV4KXtcblx0XHRcdFx0XHRpZiAoaW5kZXggPT09IDApe1xuXHRcdFx0XHRcdFx0Y3R4Lm1vdmVUbyhwb2ludC54LCBwb2ludC55KTtcblx0XHRcdFx0XHR9XG5cdFx0XHRcdFx0ZWxzZXtcblx0XHRcdFx0XHRcdGlmKHRoaXMub3B0aW9ucy5iZXppZXJDdXJ2ZSl7XG5cdFx0XHRcdFx0XHRcdHZhciBwcmV2aW91cyA9IHByZXZpb3VzUG9pbnQocG9pbnQsIHBvaW50c1dpdGhWYWx1ZXMsIGluZGV4KTtcblxuXHRcdFx0XHRcdFx0XHRjdHguYmV6aWVyQ3VydmVUbyhcblx0XHRcdFx0XHRcdFx0XHRwcmV2aW91cy5jb250cm9sUG9pbnRzLm91dGVyLngsXG5cdFx0XHRcdFx0XHRcdFx0cHJldmlvdXMuY29udHJvbFBvaW50cy5vdXRlci55LFxuXHRcdFx0XHRcdFx0XHRcdHBvaW50LmNvbnRyb2xQb2ludHMuaW5uZXIueCxcblx0XHRcdFx0XHRcdFx0XHRwb2ludC5jb250cm9sUG9pbnRzLmlubmVyLnksXG5cdFx0XHRcdFx0XHRcdFx0cG9pbnQueCxcblx0XHRcdFx0XHRcdFx0XHRwb2ludC55XG5cdFx0XHRcdFx0XHRcdCk7XG5cdFx0XHRcdFx0XHR9XG5cdFx0XHRcdFx0XHRlbHNle1xuXHRcdFx0XHRcdFx0XHRjdHgubGluZVRvKHBvaW50LngscG9pbnQueSk7XG5cdFx0XHRcdFx0XHR9XG5cdFx0XHRcdFx0fVxuXHRcdFx0XHR9LCB0aGlzKTtcblxuXHRcdFx0XHRpZiAodGhpcy5vcHRpb25zLmRhdGFzZXRTdHJva2UpIHtcblx0XHRcdFx0XHRjdHguc3Ryb2tlKCk7XG5cdFx0XHRcdH1cblxuXHRcdFx0XHRpZiAodGhpcy5vcHRpb25zLmRhdGFzZXRGaWxsICYmIHBvaW50c1dpdGhWYWx1ZXMubGVuZ3RoID4gMCl7XG5cdFx0XHRcdFx0Ly9Sb3VuZCBvZmYgdGhlIGxpbmUgYnkgZ29pbmcgdG8gdGhlIGJhc2Ugb2YgdGhlIGNoYXJ0LCBiYWNrIHRvIHRoZSBzdGFydCwgdGhlbiBmaWxsLlxuXHRcdFx0XHRcdGN0eC5saW5lVG8ocG9pbnRzV2l0aFZhbHVlc1twb2ludHNXaXRoVmFsdWVzLmxlbmd0aCAtIDFdLngsIHRoaXMuc2NhbGUuZW5kUG9pbnQpO1xuXHRcdFx0XHRcdGN0eC5saW5lVG8ocG9pbnRzV2l0aFZhbHVlc1swXS54LCB0aGlzLnNjYWxlLmVuZFBvaW50KTtcblx0XHRcdFx0XHRjdHguZmlsbFN0eWxlID0gZGF0YXNldC5maWxsQ29sb3I7XG5cdFx0XHRcdFx0Y3R4LmNsb3NlUGF0aCgpO1xuXHRcdFx0XHRcdGN0eC5maWxsKCk7XG5cdFx0XHRcdH1cblxuXHRcdFx0XHQvL05vdyBkcmF3IHRoZSBwb2ludHMgb3ZlciB0aGUgbGluZVxuXHRcdFx0XHQvL0EgbGl0dGxlIGluZWZmaWNpZW50IGRvdWJsZSBsb29waW5nLCBidXQgYmV0dGVyIHRoYW4gdGhlIGxpbmVcblx0XHRcdFx0Ly9sYWdnaW5nIGJlaGluZCB0aGUgcG9pbnQgcG9zaXRpb25zXG5cdFx0XHRcdGhlbHBlcnMuZWFjaChwb2ludHNXaXRoVmFsdWVzLGZ1bmN0aW9uKHBvaW50KXtcblx0XHRcdFx0XHRwb2ludC5kcmF3KCk7XG5cdFx0XHRcdH0pO1xuXHRcdFx0fSx0aGlzKTtcblx0XHR9XG5cdH0pO1xuXG5cbn0pLmNhbGwodGhpcyk7XG5cbihmdW5jdGlvbigpe1xuXHRcInVzZSBzdHJpY3RcIjtcblxuXHR2YXIgcm9vdCA9IHRoaXMsXG5cdFx0Q2hhcnQgPSByb290LkNoYXJ0LFxuXHRcdC8vQ2FjaGUgYSBsb2NhbCByZWZlcmVuY2UgdG8gQ2hhcnQuaGVscGVyc1xuXHRcdGhlbHBlcnMgPSBDaGFydC5oZWxwZXJzO1xuXG5cdHZhciBkZWZhdWx0Q29uZmlnID0ge1xuXHRcdC8vQm9vbGVhbiAtIFNob3cgYSBiYWNrZHJvcCB0byB0aGUgc2NhbGUgbGFiZWxcblx0XHRzY2FsZVNob3dMYWJlbEJhY2tkcm9wIDogdHJ1ZSxcblxuXHRcdC8vU3RyaW5nIC0gVGhlIGNvbG91ciBvZiB0aGUgbGFiZWwgYmFja2Ryb3Bcblx0XHRzY2FsZUJhY2tkcm9wQ29sb3IgOiBcInJnYmEoMjU1LDI1NSwyNTUsMC43NSlcIixcblxuXHRcdC8vIEJvb2xlYW4gLSBXaGV0aGVyIHRoZSBzY2FsZSBzaG91bGQgYmVnaW4gYXQgemVyb1xuXHRcdHNjYWxlQmVnaW5BdFplcm8gOiB0cnVlLFxuXG5cdFx0Ly9OdW1iZXIgLSBUaGUgYmFja2Ryb3AgcGFkZGluZyBhYm92ZSAmIGJlbG93IHRoZSBsYWJlbCBpbiBwaXhlbHNcblx0XHRzY2FsZUJhY2tkcm9wUGFkZGluZ1kgOiAyLFxuXG5cdFx0Ly9OdW1iZXIgLSBUaGUgYmFja2Ryb3AgcGFkZGluZyB0byB0aGUgc2lkZSBvZiB0aGUgbGFiZWwgaW4gcGl4ZWxzXG5cdFx0c2NhbGVCYWNrZHJvcFBhZGRpbmdYIDogMixcblxuXHRcdC8vQm9vbGVhbiAtIFNob3cgbGluZSBmb3IgZWFjaCB2YWx1ZSBpbiB0aGUgc2NhbGVcblx0XHRzY2FsZVNob3dMaW5lIDogdHJ1ZSxcblxuXHRcdC8vQm9vbGVhbiAtIFN0cm9rZSBhIGxpbmUgYXJvdW5kIGVhY2ggc2VnbWVudCBpbiB0aGUgY2hhcnRcblx0XHRzZWdtZW50U2hvd1N0cm9rZSA6IHRydWUsXG5cblx0XHQvL1N0cmluZyAtIFRoZSBjb2xvdXIgb2YgdGhlIHN0cm9rZSBvbiBlYWNoIHNlZ21lbnQuXG5cdFx0c2VnbWVudFN0cm9rZUNvbG9yIDogXCIjZmZmXCIsXG5cblx0XHQvL051bWJlciAtIFRoZSB3aWR0aCBvZiB0aGUgc3Ryb2tlIHZhbHVlIGluIHBpeGVsc1xuXHRcdHNlZ21lbnRTdHJva2VXaWR0aCA6IDIsXG5cblx0XHQvL051bWJlciAtIEFtb3VudCBvZiBhbmltYXRpb24gc3RlcHNcblx0XHRhbmltYXRpb25TdGVwcyA6IDEwMCxcblxuXHRcdC8vU3RyaW5nIC0gQW5pbWF0aW9uIGVhc2luZyBlZmZlY3QuXG5cdFx0YW5pbWF0aW9uRWFzaW5nIDogXCJlYXNlT3V0Qm91bmNlXCIsXG5cblx0XHQvL0Jvb2xlYW4gLSBXaGV0aGVyIHRvIGFuaW1hdGUgdGhlIHJvdGF0aW9uIG9mIHRoZSBjaGFydFxuXHRcdGFuaW1hdGVSb3RhdGUgOiB0cnVlLFxuXG5cdFx0Ly9Cb29sZWFuIC0gV2hldGhlciB0byBhbmltYXRlIHNjYWxpbmcgdGhlIGNoYXJ0IGZyb20gdGhlIGNlbnRyZVxuXHRcdGFuaW1hdGVTY2FsZSA6IGZhbHNlLFxuXG5cdFx0Ly9TdHJpbmcgLSBBIGxlZ2VuZCB0ZW1wbGF0ZVxuXHRcdGxlZ2VuZFRlbXBsYXRlIDogXCI8dWwgY2xhc3M9XFxcIjwlPW5hbWUudG9Mb3dlckNhc2UoKSU+LWxlZ2VuZFxcXCI+PCUgZm9yICh2YXIgaT0wOyBpPHNlZ21lbnRzLmxlbmd0aDsgaSsrKXslPjxsaT48c3BhbiBjbGFzcz1cXFwiPCU9bmFtZS50b0xvd2VyQ2FzZSgpJT4tbGVnZW5kLWljb25cXFwiIHN0eWxlPVxcXCJiYWNrZ3JvdW5kLWNvbG9yOjwlPXNlZ21lbnRzW2ldLmZpbGxDb2xvciU+XFxcIj48L3NwYW4+PHNwYW4gY2xhc3M9XFxcIjwlPW5hbWUudG9Mb3dlckNhc2UoKSU+LWxlZ2VuZC10ZXh0XFxcIj48JWlmKHNlZ21lbnRzW2ldLmxhYmVsKXslPjwlPXNlZ21lbnRzW2ldLmxhYmVsJT48JX0lPjwvc3Bhbj48L2xpPjwlfSU+PC91bD5cIlxuXHR9O1xuXG5cblx0Q2hhcnQuVHlwZS5leHRlbmQoe1xuXHRcdC8vUGFzc2luZyBpbiBhIG5hbWUgcmVnaXN0ZXJzIHRoaXMgY2hhcnQgaW4gdGhlIENoYXJ0IG5hbWVzcGFjZVxuXHRcdG5hbWU6IFwiUG9sYXJBcmVhXCIsXG5cdFx0Ly9Qcm92aWRpbmcgYSBkZWZhdWx0cyB3aWxsIGFsc28gcmVnaXN0ZXIgdGhlIGRlZmF1bHRzIGluIHRoZSBjaGFydCBuYW1lc3BhY2Vcblx0XHRkZWZhdWx0cyA6IGRlZmF1bHRDb25maWcsXG5cdFx0Ly9Jbml0aWFsaXplIGlzIGZpcmVkIHdoZW4gdGhlIGNoYXJ0IGlzIGluaXRpYWxpemVkIC0gRGF0YSBpcyBwYXNzZWQgaW4gYXMgYSBwYXJhbWV0ZXJcblx0XHQvL0NvbmZpZyBpcyBhdXRvbWF0aWNhbGx5IG1lcmdlZCBieSB0aGUgY29yZSBvZiBDaGFydC5qcywgYW5kIGlzIGF2YWlsYWJsZSBhdCB0aGlzLm9wdGlvbnNcblx0XHRpbml0aWFsaXplOiAgZnVuY3Rpb24oZGF0YSl7XG5cdFx0XHR0aGlzLnNlZ21lbnRzID0gW107XG5cdFx0XHQvL0RlY2xhcmUgc2VnbWVudCBjbGFzcyBhcyBhIGNoYXJ0IGluc3RhbmNlIHNwZWNpZmljIGNsYXNzLCBzbyBpdCBjYW4gc2hhcmUgcHJvcHMgZm9yIHRoaXMgaW5zdGFuY2Vcblx0XHRcdHRoaXMuU2VnbWVudEFyYyA9IENoYXJ0LkFyYy5leHRlbmQoe1xuXHRcdFx0XHRzaG93U3Ryb2tlIDogdGhpcy5vcHRpb25zLnNlZ21lbnRTaG93U3Ryb2tlLFxuXHRcdFx0XHRzdHJva2VXaWR0aCA6IHRoaXMub3B0aW9ucy5zZWdtZW50U3Ryb2tlV2lkdGgsXG5cdFx0XHRcdHN0cm9rZUNvbG9yIDogdGhpcy5vcHRpb25zLnNlZ21lbnRTdHJva2VDb2xvcixcblx0XHRcdFx0Y3R4IDogdGhpcy5jaGFydC5jdHgsXG5cdFx0XHRcdGlubmVyUmFkaXVzIDogMCxcblx0XHRcdFx0eCA6IHRoaXMuY2hhcnQud2lkdGgvMixcblx0XHRcdFx0eSA6IHRoaXMuY2hhcnQuaGVpZ2h0LzJcblx0XHRcdH0pO1xuXHRcdFx0dGhpcy5zY2FsZSA9IG5ldyBDaGFydC5SYWRpYWxTY2FsZSh7XG5cdFx0XHRcdGRpc3BsYXk6IHRoaXMub3B0aW9ucy5zaG93U2NhbGUsXG5cdFx0XHRcdGZvbnRTdHlsZTogdGhpcy5vcHRpb25zLnNjYWxlRm9udFN0eWxlLFxuXHRcdFx0XHRmb250U2l6ZTogdGhpcy5vcHRpb25zLnNjYWxlRm9udFNpemUsXG5cdFx0XHRcdGZvbnRGYW1pbHk6IHRoaXMub3B0aW9ucy5zY2FsZUZvbnRGYW1pbHksXG5cdFx0XHRcdGZvbnRDb2xvcjogdGhpcy5vcHRpb25zLnNjYWxlRm9udENvbG9yLFxuXHRcdFx0XHRzaG93TGFiZWxzOiB0aGlzLm9wdGlvbnMuc2NhbGVTaG93TGFiZWxzLFxuXHRcdFx0XHRzaG93TGFiZWxCYWNrZHJvcDogdGhpcy5vcHRpb25zLnNjYWxlU2hvd0xhYmVsQmFja2Ryb3AsXG5cdFx0XHRcdGJhY2tkcm9wQ29sb3I6IHRoaXMub3B0aW9ucy5zY2FsZUJhY2tkcm9wQ29sb3IsXG5cdFx0XHRcdGJhY2tkcm9wUGFkZGluZ1kgOiB0aGlzLm9wdGlvbnMuc2NhbGVCYWNrZHJvcFBhZGRpbmdZLFxuXHRcdFx0XHRiYWNrZHJvcFBhZGRpbmdYOiB0aGlzLm9wdGlvbnMuc2NhbGVCYWNrZHJvcFBhZGRpbmdYLFxuXHRcdFx0XHRsaW5lV2lkdGg6ICh0aGlzLm9wdGlvbnMuc2NhbGVTaG93TGluZSkgPyB0aGlzLm9wdGlvbnMuc2NhbGVMaW5lV2lkdGggOiAwLFxuXHRcdFx0XHRsaW5lQ29sb3I6IHRoaXMub3B0aW9ucy5zY2FsZUxpbmVDb2xvcixcblx0XHRcdFx0bGluZUFyYzogdHJ1ZSxcblx0XHRcdFx0d2lkdGg6IHRoaXMuY2hhcnQud2lkdGgsXG5cdFx0XHRcdGhlaWdodDogdGhpcy5jaGFydC5oZWlnaHQsXG5cdFx0XHRcdHhDZW50ZXI6IHRoaXMuY2hhcnQud2lkdGgvMixcblx0XHRcdFx0eUNlbnRlcjogdGhpcy5jaGFydC5oZWlnaHQvMixcblx0XHRcdFx0Y3R4IDogdGhpcy5jaGFydC5jdHgsXG5cdFx0XHRcdHRlbXBsYXRlU3RyaW5nOiB0aGlzLm9wdGlvbnMuc2NhbGVMYWJlbCxcblx0XHRcdFx0dmFsdWVzQ291bnQ6IGRhdGEubGVuZ3RoXG5cdFx0XHR9KTtcblxuXHRcdFx0dGhpcy51cGRhdGVTY2FsZVJhbmdlKGRhdGEpO1xuXG5cdFx0XHR0aGlzLnNjYWxlLnVwZGF0ZSgpO1xuXG5cdFx0XHRoZWxwZXJzLmVhY2goZGF0YSxmdW5jdGlvbihzZWdtZW50LGluZGV4KXtcblx0XHRcdFx0dGhpcy5hZGREYXRhKHNlZ21lbnQsaW5kZXgsdHJ1ZSk7XG5cdFx0XHR9LHRoaXMpO1xuXG5cdFx0XHQvL1NldCB1cCB0b29sdGlwIGV2ZW50cyBvbiB0aGUgY2hhcnRcblx0XHRcdGlmICh0aGlzLm9wdGlvbnMuc2hvd1Rvb2x0aXBzKXtcblx0XHRcdFx0aGVscGVycy5iaW5kRXZlbnRzKHRoaXMsIHRoaXMub3B0aW9ucy50b29sdGlwRXZlbnRzLCBmdW5jdGlvbihldnQpe1xuXHRcdFx0XHRcdHZhciBhY3RpdmVTZWdtZW50cyA9IChldnQudHlwZSAhPT0gJ21vdXNlb3V0JykgPyB0aGlzLmdldFNlZ21lbnRzQXRFdmVudChldnQpIDogW107XG5cdFx0XHRcdFx0aGVscGVycy5lYWNoKHRoaXMuc2VnbWVudHMsZnVuY3Rpb24oc2VnbWVudCl7XG5cdFx0XHRcdFx0XHRzZWdtZW50LnJlc3RvcmUoW1wiZmlsbENvbG9yXCJdKTtcblx0XHRcdFx0XHR9KTtcblx0XHRcdFx0XHRoZWxwZXJzLmVhY2goYWN0aXZlU2VnbWVudHMsZnVuY3Rpb24oYWN0aXZlU2VnbWVudCl7XG5cdFx0XHRcdFx0XHRhY3RpdmVTZWdtZW50LmZpbGxDb2xvciA9IGFjdGl2ZVNlZ21lbnQuaGlnaGxpZ2h0Q29sb3I7XG5cdFx0XHRcdFx0fSk7XG5cdFx0XHRcdFx0dGhpcy5zaG93VG9vbHRpcChhY3RpdmVTZWdtZW50cyk7XG5cdFx0XHRcdH0pO1xuXHRcdFx0fVxuXG5cdFx0XHR0aGlzLnJlbmRlcigpO1xuXHRcdH0sXG5cdFx0Z2V0U2VnbWVudHNBdEV2ZW50IDogZnVuY3Rpb24oZSl7XG5cdFx0XHR2YXIgc2VnbWVudHNBcnJheSA9IFtdO1xuXG5cdFx0XHR2YXIgbG9jYXRpb24gPSBoZWxwZXJzLmdldFJlbGF0aXZlUG9zaXRpb24oZSk7XG5cblx0XHRcdGhlbHBlcnMuZWFjaCh0aGlzLnNlZ21lbnRzLGZ1bmN0aW9uKHNlZ21lbnQpe1xuXHRcdFx0XHRpZiAoc2VnbWVudC5pblJhbmdlKGxvY2F0aW9uLngsbG9jYXRpb24ueSkpIHNlZ21lbnRzQXJyYXkucHVzaChzZWdtZW50KTtcblx0XHRcdH0sdGhpcyk7XG5cdFx0XHRyZXR1cm4gc2VnbWVudHNBcnJheTtcblx0XHR9LFxuXHRcdGFkZERhdGEgOiBmdW5jdGlvbihzZWdtZW50LCBhdEluZGV4LCBzaWxlbnQpe1xuXHRcdFx0dmFyIGluZGV4ID0gYXRJbmRleCB8fCB0aGlzLnNlZ21lbnRzLmxlbmd0aDtcblxuXHRcdFx0dGhpcy5zZWdtZW50cy5zcGxpY2UoaW5kZXgsIDAsIG5ldyB0aGlzLlNlZ21lbnRBcmMoe1xuXHRcdFx0XHRmaWxsQ29sb3I6IHNlZ21lbnQuY29sb3IsXG5cdFx0XHRcdGhpZ2hsaWdodENvbG9yOiBzZWdtZW50LmhpZ2hsaWdodCB8fCBzZWdtZW50LmNvbG9yLFxuXHRcdFx0XHRsYWJlbDogc2VnbWVudC5sYWJlbCxcblx0XHRcdFx0dmFsdWU6IHNlZ21lbnQudmFsdWUsXG5cdFx0XHRcdG91dGVyUmFkaXVzOiAodGhpcy5vcHRpb25zLmFuaW1hdGVTY2FsZSkgPyAwIDogdGhpcy5zY2FsZS5jYWxjdWxhdGVDZW50ZXJPZmZzZXQoc2VnbWVudC52YWx1ZSksXG5cdFx0XHRcdGNpcmN1bWZlcmVuY2U6ICh0aGlzLm9wdGlvbnMuYW5pbWF0ZVJvdGF0ZSkgPyAwIDogdGhpcy5zY2FsZS5nZXRDaXJjdW1mZXJlbmNlKCksXG5cdFx0XHRcdHN0YXJ0QW5nbGU6IE1hdGguUEkgKiAxLjVcblx0XHRcdH0pKTtcblx0XHRcdGlmICghc2lsZW50KXtcblx0XHRcdFx0dGhpcy5yZWZsb3coKTtcblx0XHRcdFx0dGhpcy51cGRhdGUoKTtcblx0XHRcdH1cblx0XHR9LFxuXHRcdHJlbW92ZURhdGE6IGZ1bmN0aW9uKGF0SW5kZXgpe1xuXHRcdFx0dmFyIGluZGV4VG9EZWxldGUgPSAoaGVscGVycy5pc051bWJlcihhdEluZGV4KSkgPyBhdEluZGV4IDogdGhpcy5zZWdtZW50cy5sZW5ndGgtMTtcblx0XHRcdHRoaXMuc2VnbWVudHMuc3BsaWNlKGluZGV4VG9EZWxldGUsIDEpO1xuXHRcdFx0dGhpcy5yZWZsb3coKTtcblx0XHRcdHRoaXMudXBkYXRlKCk7XG5cdFx0fSxcblx0XHRjYWxjdWxhdGVUb3RhbDogZnVuY3Rpb24oZGF0YSl7XG5cdFx0XHR0aGlzLnRvdGFsID0gMDtcblx0XHRcdGhlbHBlcnMuZWFjaChkYXRhLGZ1bmN0aW9uKHNlZ21lbnQpe1xuXHRcdFx0XHR0aGlzLnRvdGFsICs9IHNlZ21lbnQudmFsdWU7XG5cdFx0XHR9LHRoaXMpO1xuXHRcdFx0dGhpcy5zY2FsZS52YWx1ZXNDb3VudCA9IHRoaXMuc2VnbWVudHMubGVuZ3RoO1xuXHRcdH0sXG5cdFx0dXBkYXRlU2NhbGVSYW5nZTogZnVuY3Rpb24oZGF0YXBvaW50cyl7XG5cdFx0XHR2YXIgdmFsdWVzQXJyYXkgPSBbXTtcblx0XHRcdGhlbHBlcnMuZWFjaChkYXRhcG9pbnRzLGZ1bmN0aW9uKHNlZ21lbnQpe1xuXHRcdFx0XHR2YWx1ZXNBcnJheS5wdXNoKHNlZ21lbnQudmFsdWUpO1xuXHRcdFx0fSk7XG5cblx0XHRcdHZhciBzY2FsZVNpemVzID0gKHRoaXMub3B0aW9ucy5zY2FsZU92ZXJyaWRlKSA/XG5cdFx0XHRcdHtcblx0XHRcdFx0XHRzdGVwczogdGhpcy5vcHRpb25zLnNjYWxlU3RlcHMsXG5cdFx0XHRcdFx0c3RlcFZhbHVlOiB0aGlzLm9wdGlvbnMuc2NhbGVTdGVwV2lkdGgsXG5cdFx0XHRcdFx0bWluOiB0aGlzLm9wdGlvbnMuc2NhbGVTdGFydFZhbHVlLFxuXHRcdFx0XHRcdG1heDogdGhpcy5vcHRpb25zLnNjYWxlU3RhcnRWYWx1ZSArICh0aGlzLm9wdGlvbnMuc2NhbGVTdGVwcyAqIHRoaXMub3B0aW9ucy5zY2FsZVN0ZXBXaWR0aClcblx0XHRcdFx0fSA6XG5cdFx0XHRcdGhlbHBlcnMuY2FsY3VsYXRlU2NhbGVSYW5nZShcblx0XHRcdFx0XHR2YWx1ZXNBcnJheSxcblx0XHRcdFx0XHRoZWxwZXJzLm1pbihbdGhpcy5jaGFydC53aWR0aCwgdGhpcy5jaGFydC5oZWlnaHRdKS8yLFxuXHRcdFx0XHRcdHRoaXMub3B0aW9ucy5zY2FsZUZvbnRTaXplLFxuXHRcdFx0XHRcdHRoaXMub3B0aW9ucy5zY2FsZUJlZ2luQXRaZXJvLFxuXHRcdFx0XHRcdHRoaXMub3B0aW9ucy5zY2FsZUludGVnZXJzT25seVxuXHRcdFx0XHQpO1xuXG5cdFx0XHRoZWxwZXJzLmV4dGVuZChcblx0XHRcdFx0dGhpcy5zY2FsZSxcblx0XHRcdFx0c2NhbGVTaXplcyxcblx0XHRcdFx0e1xuXHRcdFx0XHRcdHNpemU6IGhlbHBlcnMubWluKFt0aGlzLmNoYXJ0LndpZHRoLCB0aGlzLmNoYXJ0LmhlaWdodF0pLFxuXHRcdFx0XHRcdHhDZW50ZXI6IHRoaXMuY2hhcnQud2lkdGgvMixcblx0XHRcdFx0XHR5Q2VudGVyOiB0aGlzLmNoYXJ0LmhlaWdodC8yXG5cdFx0XHRcdH1cblx0XHRcdCk7XG5cblx0XHR9LFxuXHRcdHVwZGF0ZSA6IGZ1bmN0aW9uKCl7XG5cdFx0XHR0aGlzLmNhbGN1bGF0ZVRvdGFsKHRoaXMuc2VnbWVudHMpO1xuXG5cdFx0XHRoZWxwZXJzLmVhY2godGhpcy5zZWdtZW50cyxmdW5jdGlvbihzZWdtZW50KXtcblx0XHRcdFx0c2VnbWVudC5zYXZlKCk7XG5cdFx0XHR9KTtcblx0XHRcdFxuXHRcdFx0dGhpcy5yZWZsb3coKTtcblx0XHRcdHRoaXMucmVuZGVyKCk7XG5cdFx0fSxcblx0XHRyZWZsb3cgOiBmdW5jdGlvbigpe1xuXHRcdFx0aGVscGVycy5leHRlbmQodGhpcy5TZWdtZW50QXJjLnByb3RvdHlwZSx7XG5cdFx0XHRcdHggOiB0aGlzLmNoYXJ0LndpZHRoLzIsXG5cdFx0XHRcdHkgOiB0aGlzLmNoYXJ0LmhlaWdodC8yXG5cdFx0XHR9KTtcblx0XHRcdHRoaXMudXBkYXRlU2NhbGVSYW5nZSh0aGlzLnNlZ21lbnRzKTtcblx0XHRcdHRoaXMuc2NhbGUudXBkYXRlKCk7XG5cblx0XHRcdGhlbHBlcnMuZXh0ZW5kKHRoaXMuc2NhbGUse1xuXHRcdFx0XHR4Q2VudGVyOiB0aGlzLmNoYXJ0LndpZHRoLzIsXG5cdFx0XHRcdHlDZW50ZXI6IHRoaXMuY2hhcnQuaGVpZ2h0LzJcblx0XHRcdH0pO1xuXG5cdFx0XHRoZWxwZXJzLmVhY2godGhpcy5zZWdtZW50cywgZnVuY3Rpb24oc2VnbWVudCl7XG5cdFx0XHRcdHNlZ21lbnQudXBkYXRlKHtcblx0XHRcdFx0XHRvdXRlclJhZGl1cyA6IHRoaXMuc2NhbGUuY2FsY3VsYXRlQ2VudGVyT2Zmc2V0KHNlZ21lbnQudmFsdWUpXG5cdFx0XHRcdH0pO1xuXHRcdFx0fSwgdGhpcyk7XG5cblx0XHR9LFxuXHRcdGRyYXcgOiBmdW5jdGlvbihlYXNlKXtcblx0XHRcdHZhciBlYXNpbmdEZWNpbWFsID0gZWFzZSB8fCAxO1xuXHRcdFx0Ly9DbGVhciAmIGRyYXcgdGhlIGNhbnZhc1xuXHRcdFx0dGhpcy5jbGVhcigpO1xuXHRcdFx0aGVscGVycy5lYWNoKHRoaXMuc2VnbWVudHMsZnVuY3Rpb24oc2VnbWVudCwgaW5kZXgpe1xuXHRcdFx0XHRzZWdtZW50LnRyYW5zaXRpb24oe1xuXHRcdFx0XHRcdGNpcmN1bWZlcmVuY2UgOiB0aGlzLnNjYWxlLmdldENpcmN1bWZlcmVuY2UoKSxcblx0XHRcdFx0XHRvdXRlclJhZGl1cyA6IHRoaXMuc2NhbGUuY2FsY3VsYXRlQ2VudGVyT2Zmc2V0KHNlZ21lbnQudmFsdWUpXG5cdFx0XHRcdH0sZWFzaW5nRGVjaW1hbCk7XG5cblx0XHRcdFx0c2VnbWVudC5lbmRBbmdsZSA9IHNlZ21lbnQuc3RhcnRBbmdsZSArIHNlZ21lbnQuY2lyY3VtZmVyZW5jZTtcblxuXHRcdFx0XHQvLyBJZiB3ZSd2ZSByZW1vdmVkIHRoZSBmaXJzdCBzZWdtZW50IHdlIG5lZWQgdG8gc2V0IHRoZSBmaXJzdCBvbmUgdG9cblx0XHRcdFx0Ly8gc3RhcnQgYXQgdGhlIHRvcC5cblx0XHRcdFx0aWYgKGluZGV4ID09PSAwKXtcblx0XHRcdFx0XHRzZWdtZW50LnN0YXJ0QW5nbGUgPSBNYXRoLlBJICogMS41O1xuXHRcdFx0XHR9XG5cblx0XHRcdFx0Ly9DaGVjayB0byBzZWUgaWYgaXQncyB0aGUgbGFzdCBzZWdtZW50LCBpZiBub3QgZ2V0IHRoZSBuZXh0IGFuZCB1cGRhdGUgdGhlIHN0YXJ0IGFuZ2xlXG5cdFx0XHRcdGlmIChpbmRleCA8IHRoaXMuc2VnbWVudHMubGVuZ3RoIC0gMSl7XG5cdFx0XHRcdFx0dGhpcy5zZWdtZW50c1tpbmRleCsxXS5zdGFydEFuZ2xlID0gc2VnbWVudC5lbmRBbmdsZTtcblx0XHRcdFx0fVxuXHRcdFx0XHRzZWdtZW50LmRyYXcoKTtcblx0XHRcdH0sIHRoaXMpO1xuXHRcdFx0dGhpcy5zY2FsZS5kcmF3KCk7XG5cdFx0fVxuXHR9KTtcblxufSkuY2FsbCh0aGlzKTtcblxuKGZ1bmN0aW9uKCl7XG5cdFwidXNlIHN0cmljdFwiO1xuXG5cdHZhciByb290ID0gdGhpcyxcblx0XHRDaGFydCA9IHJvb3QuQ2hhcnQsXG5cdFx0aGVscGVycyA9IENoYXJ0LmhlbHBlcnM7XG5cblxuXG5cdENoYXJ0LlR5cGUuZXh0ZW5kKHtcblx0XHRuYW1lOiBcIlJhZGFyXCIsXG5cdFx0ZGVmYXVsdHM6e1xuXHRcdFx0Ly9Cb29sZWFuIC0gV2hldGhlciB0byBzaG93IGxpbmVzIGZvciBlYWNoIHNjYWxlIHBvaW50XG5cdFx0XHRzY2FsZVNob3dMaW5lIDogdHJ1ZSxcblxuXHRcdFx0Ly9Cb29sZWFuIC0gV2hldGhlciB3ZSBzaG93IHRoZSBhbmdsZSBsaW5lcyBvdXQgb2YgdGhlIHJhZGFyXG5cdFx0XHRhbmdsZVNob3dMaW5lT3V0IDogdHJ1ZSxcblxuXHRcdFx0Ly9Cb29sZWFuIC0gV2hldGhlciB0byBzaG93IGxhYmVscyBvbiB0aGUgc2NhbGVcblx0XHRcdHNjYWxlU2hvd0xhYmVscyA6IGZhbHNlLFxuXG5cdFx0XHQvLyBCb29sZWFuIC0gV2hldGhlciB0aGUgc2NhbGUgc2hvdWxkIGJlZ2luIGF0IHplcm9cblx0XHRcdHNjYWxlQmVnaW5BdFplcm8gOiB0cnVlLFxuXG5cdFx0XHQvL1N0cmluZyAtIENvbG91ciBvZiB0aGUgYW5nbGUgbGluZVxuXHRcdFx0YW5nbGVMaW5lQ29sb3IgOiBcInJnYmEoMCwwLDAsLjEpXCIsXG5cblx0XHRcdC8vTnVtYmVyIC0gUGl4ZWwgd2lkdGggb2YgdGhlIGFuZ2xlIGxpbmVcblx0XHRcdGFuZ2xlTGluZVdpZHRoIDogMSxcblxuXHRcdFx0Ly9OdW1iZXIgLSBJbnRlcnZhbCBhdCB3aGljaCB0byBkcmF3IGFuZ2xlIGxpbmVzIChcImV2ZXJ5IE50aCBwb2ludFwiKVxuXHRcdFx0YW5nbGVMaW5lSW50ZXJ2YWw6IDEsXG5cblx0XHRcdC8vU3RyaW5nIC0gUG9pbnQgbGFiZWwgZm9udCBkZWNsYXJhdGlvblxuXHRcdFx0cG9pbnRMYWJlbEZvbnRGYW1pbHkgOiBcIidBcmlhbCdcIixcblxuXHRcdFx0Ly9TdHJpbmcgLSBQb2ludCBsYWJlbCBmb250IHdlaWdodFxuXHRcdFx0cG9pbnRMYWJlbEZvbnRTdHlsZSA6IFwibm9ybWFsXCIsXG5cblx0XHRcdC8vTnVtYmVyIC0gUG9pbnQgbGFiZWwgZm9udCBzaXplIGluIHBpeGVsc1xuXHRcdFx0cG9pbnRMYWJlbEZvbnRTaXplIDogMTAsXG5cblx0XHRcdC8vU3RyaW5nIC0gUG9pbnQgbGFiZWwgZm9udCBjb2xvdXJcblx0XHRcdHBvaW50TGFiZWxGb250Q29sb3IgOiBcIiM2NjZcIixcblxuXHRcdFx0Ly9Cb29sZWFuIC0gV2hldGhlciB0byBzaG93IGEgZG90IGZvciBlYWNoIHBvaW50XG5cdFx0XHRwb2ludERvdCA6IHRydWUsXG5cblx0XHRcdC8vTnVtYmVyIC0gUmFkaXVzIG9mIGVhY2ggcG9pbnQgZG90IGluIHBpeGVsc1xuXHRcdFx0cG9pbnREb3RSYWRpdXMgOiAzLFxuXG5cdFx0XHQvL051bWJlciAtIFBpeGVsIHdpZHRoIG9mIHBvaW50IGRvdCBzdHJva2Vcblx0XHRcdHBvaW50RG90U3Ryb2tlV2lkdGggOiAxLFxuXG5cdFx0XHQvL051bWJlciAtIGFtb3VudCBleHRyYSB0byBhZGQgdG8gdGhlIHJhZGl1cyB0byBjYXRlciBmb3IgaGl0IGRldGVjdGlvbiBvdXRzaWRlIHRoZSBkcmF3biBwb2ludFxuXHRcdFx0cG9pbnRIaXREZXRlY3Rpb25SYWRpdXMgOiAyMCxcblxuXHRcdFx0Ly9Cb29sZWFuIC0gV2hldGhlciB0byBzaG93IGEgc3Ryb2tlIGZvciBkYXRhc2V0c1xuXHRcdFx0ZGF0YXNldFN0cm9rZSA6IHRydWUsXG5cblx0XHRcdC8vTnVtYmVyIC0gUGl4ZWwgd2lkdGggb2YgZGF0YXNldCBzdHJva2Vcblx0XHRcdGRhdGFzZXRTdHJva2VXaWR0aCA6IDIsXG5cblx0XHRcdC8vQm9vbGVhbiAtIFdoZXRoZXIgdG8gZmlsbCB0aGUgZGF0YXNldCB3aXRoIGEgY29sb3VyXG5cdFx0XHRkYXRhc2V0RmlsbCA6IHRydWUsXG5cblx0XHRcdC8vU3RyaW5nIC0gQSBsZWdlbmQgdGVtcGxhdGVcblx0XHRcdGxlZ2VuZFRlbXBsYXRlIDogXCI8dWwgY2xhc3M9XFxcIjwlPW5hbWUudG9Mb3dlckNhc2UoKSU+LWxlZ2VuZFxcXCI+PCUgZm9yICh2YXIgaT0wOyBpPGRhdGFzZXRzLmxlbmd0aDsgaSsrKXslPjxsaT48c3BhbiBjbGFzcz1cXFwiPCU9bmFtZS50b0xvd2VyQ2FzZSgpJT4tbGVnZW5kLWljb25cXFwiIHN0eWxlPVxcXCJiYWNrZ3JvdW5kLWNvbG9yOjwlPWRhdGFzZXRzW2ldLnN0cm9rZUNvbG9yJT5cXFwiPjwvc3Bhbj48c3BhbiBjbGFzcz1cXFwiPCU9bmFtZS50b0xvd2VyQ2FzZSgpJT4tbGVnZW5kLXRleHRcXFwiPjwlaWYoZGF0YXNldHNbaV0ubGFiZWwpeyU+PCU9ZGF0YXNldHNbaV0ubGFiZWwlPjwlfSU+PC9zcGFuPjwvbGk+PCV9JT48L3VsPlwiXG5cblx0XHR9LFxuXG5cdFx0aW5pdGlhbGl6ZTogZnVuY3Rpb24oZGF0YSl7XG5cdFx0XHR0aGlzLlBvaW50Q2xhc3MgPSBDaGFydC5Qb2ludC5leHRlbmQoe1xuXHRcdFx0XHRzdHJva2VXaWR0aCA6IHRoaXMub3B0aW9ucy5wb2ludERvdFN0cm9rZVdpZHRoLFxuXHRcdFx0XHRyYWRpdXMgOiB0aGlzLm9wdGlvbnMucG9pbnREb3RSYWRpdXMsXG5cdFx0XHRcdGRpc3BsYXk6IHRoaXMub3B0aW9ucy5wb2ludERvdCxcblx0XHRcdFx0aGl0RGV0ZWN0aW9uUmFkaXVzIDogdGhpcy5vcHRpb25zLnBvaW50SGl0RGV0ZWN0aW9uUmFkaXVzLFxuXHRcdFx0XHRjdHggOiB0aGlzLmNoYXJ0LmN0eFxuXHRcdFx0fSk7XG5cblx0XHRcdHRoaXMuZGF0YXNldHMgPSBbXTtcblxuXHRcdFx0dGhpcy5idWlsZFNjYWxlKGRhdGEpO1xuXG5cdFx0XHQvL1NldCB1cCB0b29sdGlwIGV2ZW50cyBvbiB0aGUgY2hhcnRcblx0XHRcdGlmICh0aGlzLm9wdGlvbnMuc2hvd1Rvb2x0aXBzKXtcblx0XHRcdFx0aGVscGVycy5iaW5kRXZlbnRzKHRoaXMsIHRoaXMub3B0aW9ucy50b29sdGlwRXZlbnRzLCBmdW5jdGlvbihldnQpe1xuXHRcdFx0XHRcdHZhciBhY3RpdmVQb2ludHNDb2xsZWN0aW9uID0gKGV2dC50eXBlICE9PSAnbW91c2VvdXQnKSA/IHRoaXMuZ2V0UG9pbnRzQXRFdmVudChldnQpIDogW107XG5cblx0XHRcdFx0XHR0aGlzLmVhY2hQb2ludHMoZnVuY3Rpb24ocG9pbnQpe1xuXHRcdFx0XHRcdFx0cG9pbnQucmVzdG9yZShbJ2ZpbGxDb2xvcicsICdzdHJva2VDb2xvciddKTtcblx0XHRcdFx0XHR9KTtcblx0XHRcdFx0XHRoZWxwZXJzLmVhY2goYWN0aXZlUG9pbnRzQ29sbGVjdGlvbiwgZnVuY3Rpb24oYWN0aXZlUG9pbnQpe1xuXHRcdFx0XHRcdFx0YWN0aXZlUG9pbnQuZmlsbENvbG9yID0gYWN0aXZlUG9pbnQuaGlnaGxpZ2h0RmlsbDtcblx0XHRcdFx0XHRcdGFjdGl2ZVBvaW50LnN0cm9rZUNvbG9yID0gYWN0aXZlUG9pbnQuaGlnaGxpZ2h0U3Ryb2tlO1xuXHRcdFx0XHRcdH0pO1xuXG5cdFx0XHRcdFx0dGhpcy5zaG93VG9vbHRpcChhY3RpdmVQb2ludHNDb2xsZWN0aW9uKTtcblx0XHRcdFx0fSk7XG5cdFx0XHR9XG5cblx0XHRcdC8vSXRlcmF0ZSB0aHJvdWdoIGVhY2ggb2YgdGhlIGRhdGFzZXRzLCBhbmQgYnVpbGQgdGhpcyBpbnRvIGEgcHJvcGVydHkgb2YgdGhlIGNoYXJ0XG5cdFx0XHRoZWxwZXJzLmVhY2goZGF0YS5kYXRhc2V0cyxmdW5jdGlvbihkYXRhc2V0KXtcblxuXHRcdFx0XHR2YXIgZGF0YXNldE9iamVjdCA9IHtcblx0XHRcdFx0XHRsYWJlbDogZGF0YXNldC5sYWJlbCB8fCBudWxsLFxuXHRcdFx0XHRcdGZpbGxDb2xvciA6IGRhdGFzZXQuZmlsbENvbG9yLFxuXHRcdFx0XHRcdHN0cm9rZUNvbG9yIDogZGF0YXNldC5zdHJva2VDb2xvcixcblx0XHRcdFx0XHRwb2ludENvbG9yIDogZGF0YXNldC5wb2ludENvbG9yLFxuXHRcdFx0XHRcdHBvaW50U3Ryb2tlQ29sb3IgOiBkYXRhc2V0LnBvaW50U3Ryb2tlQ29sb3IsXG5cdFx0XHRcdFx0cG9pbnRzIDogW11cblx0XHRcdFx0fTtcblxuXHRcdFx0XHR0aGlzLmRhdGFzZXRzLnB1c2goZGF0YXNldE9iamVjdCk7XG5cblx0XHRcdFx0aGVscGVycy5lYWNoKGRhdGFzZXQuZGF0YSxmdW5jdGlvbihkYXRhUG9pbnQsaW5kZXgpe1xuXHRcdFx0XHRcdC8vQWRkIGEgbmV3IHBvaW50IGZvciBlYWNoIHBpZWNlIG9mIGRhdGEsIHBhc3NpbmcgYW55IHJlcXVpcmVkIGRhdGEgdG8gZHJhdy5cblx0XHRcdFx0XHR2YXIgcG9pbnRQb3NpdGlvbjtcblx0XHRcdFx0XHRpZiAoIXRoaXMuc2NhbGUuYW5pbWF0aW9uKXtcblx0XHRcdFx0XHRcdHBvaW50UG9zaXRpb24gPSB0aGlzLnNjYWxlLmdldFBvaW50UG9zaXRpb24oaW5kZXgsIHRoaXMuc2NhbGUuY2FsY3VsYXRlQ2VudGVyT2Zmc2V0KGRhdGFQb2ludCkpO1xuXHRcdFx0XHRcdH1cblx0XHRcdFx0XHRkYXRhc2V0T2JqZWN0LnBvaW50cy5wdXNoKG5ldyB0aGlzLlBvaW50Q2xhc3Moe1xuXHRcdFx0XHRcdFx0dmFsdWUgOiBkYXRhUG9pbnQsXG5cdFx0XHRcdFx0XHRsYWJlbCA6IGRhdGEubGFiZWxzW2luZGV4XSxcblx0XHRcdFx0XHRcdGRhdGFzZXRMYWJlbDogZGF0YXNldC5sYWJlbCxcblx0XHRcdFx0XHRcdHg6ICh0aGlzLm9wdGlvbnMuYW5pbWF0aW9uKSA/IHRoaXMuc2NhbGUueENlbnRlciA6IHBvaW50UG9zaXRpb24ueCxcblx0XHRcdFx0XHRcdHk6ICh0aGlzLm9wdGlvbnMuYW5pbWF0aW9uKSA/IHRoaXMuc2NhbGUueUNlbnRlciA6IHBvaW50UG9zaXRpb24ueSxcblx0XHRcdFx0XHRcdHN0cm9rZUNvbG9yIDogZGF0YXNldC5wb2ludFN0cm9rZUNvbG9yLFxuXHRcdFx0XHRcdFx0ZmlsbENvbG9yIDogZGF0YXNldC5wb2ludENvbG9yLFxuXHRcdFx0XHRcdFx0aGlnaGxpZ2h0RmlsbCA6IGRhdGFzZXQucG9pbnRIaWdobGlnaHRGaWxsIHx8IGRhdGFzZXQucG9pbnRDb2xvcixcblx0XHRcdFx0XHRcdGhpZ2hsaWdodFN0cm9rZSA6IGRhdGFzZXQucG9pbnRIaWdobGlnaHRTdHJva2UgfHwgZGF0YXNldC5wb2ludFN0cm9rZUNvbG9yXG5cdFx0XHRcdFx0fSkpO1xuXHRcdFx0XHR9LHRoaXMpO1xuXG5cdFx0XHR9LHRoaXMpO1xuXG5cdFx0XHR0aGlzLnJlbmRlcigpO1xuXHRcdH0sXG5cdFx0ZWFjaFBvaW50cyA6IGZ1bmN0aW9uKGNhbGxiYWNrKXtcblx0XHRcdGhlbHBlcnMuZWFjaCh0aGlzLmRhdGFzZXRzLGZ1bmN0aW9uKGRhdGFzZXQpe1xuXHRcdFx0XHRoZWxwZXJzLmVhY2goZGF0YXNldC5wb2ludHMsY2FsbGJhY2ssdGhpcyk7XG5cdFx0XHR9LHRoaXMpO1xuXHRcdH0sXG5cblx0XHRnZXRQb2ludHNBdEV2ZW50IDogZnVuY3Rpb24oZXZ0KXtcblx0XHRcdHZhciBtb3VzZVBvc2l0aW9uID0gaGVscGVycy5nZXRSZWxhdGl2ZVBvc2l0aW9uKGV2dCksXG5cdFx0XHRcdGZyb21DZW50ZXIgPSBoZWxwZXJzLmdldEFuZ2xlRnJvbVBvaW50KHtcblx0XHRcdFx0XHR4OiB0aGlzLnNjYWxlLnhDZW50ZXIsXG5cdFx0XHRcdFx0eTogdGhpcy5zY2FsZS55Q2VudGVyXG5cdFx0XHRcdH0sIG1vdXNlUG9zaXRpb24pO1xuXG5cdFx0XHR2YXIgYW5nbGVQZXJJbmRleCA9IChNYXRoLlBJICogMikgL3RoaXMuc2NhbGUudmFsdWVzQ291bnQsXG5cdFx0XHRcdHBvaW50SW5kZXggPSBNYXRoLnJvdW5kKChmcm9tQ2VudGVyLmFuZ2xlIC0gTWF0aC5QSSAqIDEuNSkgLyBhbmdsZVBlckluZGV4KSxcblx0XHRcdFx0YWN0aXZlUG9pbnRzQ29sbGVjdGlvbiA9IFtdO1xuXG5cdFx0XHQvLyBJZiB3ZSdyZSBhdCB0aGUgdG9wLCBtYWtlIHRoZSBwb2ludEluZGV4IDAgdG8gZ2V0IHRoZSBmaXJzdCBvZiB0aGUgYXJyYXkuXG5cdFx0XHRpZiAocG9pbnRJbmRleCA+PSB0aGlzLnNjYWxlLnZhbHVlc0NvdW50IHx8IHBvaW50SW5kZXggPCAwKXtcblx0XHRcdFx0cG9pbnRJbmRleCA9IDA7XG5cdFx0XHR9XG5cblx0XHRcdGlmIChmcm9tQ2VudGVyLmRpc3RhbmNlIDw9IHRoaXMuc2NhbGUuZHJhd2luZ0FyZWEpe1xuXHRcdFx0XHRoZWxwZXJzLmVhY2godGhpcy5kYXRhc2V0cywgZnVuY3Rpb24oZGF0YXNldCl7XG5cdFx0XHRcdFx0YWN0aXZlUG9pbnRzQ29sbGVjdGlvbi5wdXNoKGRhdGFzZXQucG9pbnRzW3BvaW50SW5kZXhdKTtcblx0XHRcdFx0fSk7XG5cdFx0XHR9XG5cblx0XHRcdHJldHVybiBhY3RpdmVQb2ludHNDb2xsZWN0aW9uO1xuXHRcdH0sXG5cblx0XHRidWlsZFNjYWxlIDogZnVuY3Rpb24oZGF0YSl7XG5cdFx0XHR0aGlzLnNjYWxlID0gbmV3IENoYXJ0LlJhZGlhbFNjYWxlKHtcblx0XHRcdFx0ZGlzcGxheTogdGhpcy5vcHRpb25zLnNob3dTY2FsZSxcblx0XHRcdFx0Zm9udFN0eWxlOiB0aGlzLm9wdGlvbnMuc2NhbGVGb250U3R5bGUsXG5cdFx0XHRcdGZvbnRTaXplOiB0aGlzLm9wdGlvbnMuc2NhbGVGb250U2l6ZSxcblx0XHRcdFx0Zm9udEZhbWlseTogdGhpcy5vcHRpb25zLnNjYWxlRm9udEZhbWlseSxcblx0XHRcdFx0Zm9udENvbG9yOiB0aGlzLm9wdGlvbnMuc2NhbGVGb250Q29sb3IsXG5cdFx0XHRcdHNob3dMYWJlbHM6IHRoaXMub3B0aW9ucy5zY2FsZVNob3dMYWJlbHMsXG5cdFx0XHRcdHNob3dMYWJlbEJhY2tkcm9wOiB0aGlzLm9wdGlvbnMuc2NhbGVTaG93TGFiZWxCYWNrZHJvcCxcblx0XHRcdFx0YmFja2Ryb3BDb2xvcjogdGhpcy5vcHRpb25zLnNjYWxlQmFja2Ryb3BDb2xvcixcblx0XHRcdFx0YmFja2dyb3VuZENvbG9yczogdGhpcy5vcHRpb25zLnNjYWxlQmFja2dyb3VuZENvbG9ycyxcblx0XHRcdFx0YmFja2Ryb3BQYWRkaW5nWSA6IHRoaXMub3B0aW9ucy5zY2FsZUJhY2tkcm9wUGFkZGluZ1ksXG5cdFx0XHRcdGJhY2tkcm9wUGFkZGluZ1g6IHRoaXMub3B0aW9ucy5zY2FsZUJhY2tkcm9wUGFkZGluZ1gsXG5cdFx0XHRcdGxpbmVXaWR0aDogKHRoaXMub3B0aW9ucy5zY2FsZVNob3dMaW5lKSA/IHRoaXMub3B0aW9ucy5zY2FsZUxpbmVXaWR0aCA6IDAsXG5cdFx0XHRcdGxpbmVDb2xvcjogdGhpcy5vcHRpb25zLnNjYWxlTGluZUNvbG9yLFxuXHRcdFx0XHRhbmdsZUxpbmVDb2xvciA6IHRoaXMub3B0aW9ucy5hbmdsZUxpbmVDb2xvcixcblx0XHRcdFx0YW5nbGVMaW5lV2lkdGggOiAodGhpcy5vcHRpb25zLmFuZ2xlU2hvd0xpbmVPdXQpID8gdGhpcy5vcHRpb25zLmFuZ2xlTGluZVdpZHRoIDogMCxcbiAgICAgICAgYW5nbGVMaW5lSW50ZXJ2YWw6ICh0aGlzLm9wdGlvbnMuYW5nbGVMaW5lSW50ZXJ2YWwpID8gdGhpcy5vcHRpb25zLmFuZ2xlTGluZUludGVydmFsIDogMSxcblx0XHRcdFx0Ly8gUG9pbnQgbGFiZWxzIGF0IHRoZSBlZGdlIG9mIGVhY2ggbGluZVxuXHRcdFx0XHRwb2ludExhYmVsRm9udENvbG9yIDogdGhpcy5vcHRpb25zLnBvaW50TGFiZWxGb250Q29sb3IsXG5cdFx0XHRcdHBvaW50TGFiZWxGb250U2l6ZSA6IHRoaXMub3B0aW9ucy5wb2ludExhYmVsRm9udFNpemUsXG5cdFx0XHRcdHBvaW50TGFiZWxGb250RmFtaWx5IDogdGhpcy5vcHRpb25zLnBvaW50TGFiZWxGb250RmFtaWx5LFxuXHRcdFx0XHRwb2ludExhYmVsRm9udFN0eWxlIDogdGhpcy5vcHRpb25zLnBvaW50TGFiZWxGb250U3R5bGUsXG5cdFx0XHRcdGhlaWdodCA6IHRoaXMuY2hhcnQuaGVpZ2h0LFxuXHRcdFx0XHR3aWR0aDogdGhpcy5jaGFydC53aWR0aCxcblx0XHRcdFx0eENlbnRlcjogdGhpcy5jaGFydC53aWR0aC8yLFxuXHRcdFx0XHR5Q2VudGVyOiB0aGlzLmNoYXJ0LmhlaWdodC8yLFxuXHRcdFx0XHRjdHggOiB0aGlzLmNoYXJ0LmN0eCxcblx0XHRcdFx0dGVtcGxhdGVTdHJpbmc6IHRoaXMub3B0aW9ucy5zY2FsZUxhYmVsLFxuXHRcdFx0XHRsYWJlbHM6IGRhdGEubGFiZWxzLFxuXHRcdFx0XHR2YWx1ZXNDb3VudDogZGF0YS5kYXRhc2V0c1swXS5kYXRhLmxlbmd0aFxuXHRcdFx0fSk7XG5cblx0XHRcdHRoaXMuc2NhbGUuc2V0U2NhbGVTaXplKCk7XG5cdFx0XHR0aGlzLnVwZGF0ZVNjYWxlUmFuZ2UoZGF0YS5kYXRhc2V0cyk7XG5cdFx0XHR0aGlzLnNjYWxlLmJ1aWxkWUxhYmVscygpO1xuXHRcdH0sXG5cdFx0dXBkYXRlU2NhbGVSYW5nZTogZnVuY3Rpb24oZGF0YXNldHMpe1xuXHRcdFx0dmFyIHZhbHVlc0FycmF5ID0gKGZ1bmN0aW9uKCl7XG5cdFx0XHRcdHZhciB0b3RhbERhdGFBcnJheSA9IFtdO1xuXHRcdFx0XHRoZWxwZXJzLmVhY2goZGF0YXNldHMsZnVuY3Rpb24oZGF0YXNldCl7XG5cdFx0XHRcdFx0aWYgKGRhdGFzZXQuZGF0YSl7XG5cdFx0XHRcdFx0XHR0b3RhbERhdGFBcnJheSA9IHRvdGFsRGF0YUFycmF5LmNvbmNhdChkYXRhc2V0LmRhdGEpO1xuXHRcdFx0XHRcdH1cblx0XHRcdFx0XHRlbHNlIHtcblx0XHRcdFx0XHRcdGhlbHBlcnMuZWFjaChkYXRhc2V0LnBvaW50cywgZnVuY3Rpb24ocG9pbnQpe1xuXHRcdFx0XHRcdFx0XHR0b3RhbERhdGFBcnJheS5wdXNoKHBvaW50LnZhbHVlKTtcblx0XHRcdFx0XHRcdH0pO1xuXHRcdFx0XHRcdH1cblx0XHRcdFx0fSk7XG5cdFx0XHRcdHJldHVybiB0b3RhbERhdGFBcnJheTtcblx0XHRcdH0pKCk7XG5cblxuXHRcdFx0dmFyIHNjYWxlU2l6ZXMgPSAodGhpcy5vcHRpb25zLnNjYWxlT3ZlcnJpZGUpID9cblx0XHRcdFx0e1xuXHRcdFx0XHRcdHN0ZXBzOiB0aGlzLm9wdGlvbnMuc2NhbGVTdGVwcyxcblx0XHRcdFx0XHRzdGVwVmFsdWU6IHRoaXMub3B0aW9ucy5zY2FsZVN0ZXBXaWR0aCxcblx0XHRcdFx0XHRtaW46IHRoaXMub3B0aW9ucy5zY2FsZVN0YXJ0VmFsdWUsXG5cdFx0XHRcdFx0bWF4OiB0aGlzLm9wdGlvbnMuc2NhbGVTdGFydFZhbHVlICsgKHRoaXMub3B0aW9ucy5zY2FsZVN0ZXBzICogdGhpcy5vcHRpb25zLnNjYWxlU3RlcFdpZHRoKVxuXHRcdFx0XHR9IDpcblx0XHRcdFx0aGVscGVycy5jYWxjdWxhdGVTY2FsZVJhbmdlKFxuXHRcdFx0XHRcdHZhbHVlc0FycmF5LFxuXHRcdFx0XHRcdGhlbHBlcnMubWluKFt0aGlzLmNoYXJ0LndpZHRoLCB0aGlzLmNoYXJ0LmhlaWdodF0pLzIsXG5cdFx0XHRcdFx0dGhpcy5vcHRpb25zLnNjYWxlRm9udFNpemUsXG5cdFx0XHRcdFx0dGhpcy5vcHRpb25zLnNjYWxlQmVnaW5BdFplcm8sXG5cdFx0XHRcdFx0dGhpcy5vcHRpb25zLnNjYWxlSW50ZWdlcnNPbmx5XG5cdFx0XHRcdCk7XG5cblx0XHRcdGhlbHBlcnMuZXh0ZW5kKFxuXHRcdFx0XHR0aGlzLnNjYWxlLFxuXHRcdFx0XHRzY2FsZVNpemVzXG5cdFx0XHQpO1xuXG5cdFx0fSxcblx0XHRhZGREYXRhIDogZnVuY3Rpb24odmFsdWVzQXJyYXksbGFiZWwpe1xuXHRcdFx0Ly9NYXAgdGhlIHZhbHVlcyBhcnJheSBmb3IgZWFjaCBvZiB0aGUgZGF0YXNldHNcblx0XHRcdHRoaXMuc2NhbGUudmFsdWVzQ291bnQrKztcblx0XHRcdGhlbHBlcnMuZWFjaCh2YWx1ZXNBcnJheSxmdW5jdGlvbih2YWx1ZSxkYXRhc2V0SW5kZXgpe1xuXHRcdFx0XHR2YXIgcG9pbnRQb3NpdGlvbiA9IHRoaXMuc2NhbGUuZ2V0UG9pbnRQb3NpdGlvbih0aGlzLnNjYWxlLnZhbHVlc0NvdW50LCB0aGlzLnNjYWxlLmNhbGN1bGF0ZUNlbnRlck9mZnNldCh2YWx1ZSkpO1xuXHRcdFx0XHR0aGlzLmRhdGFzZXRzW2RhdGFzZXRJbmRleF0ucG9pbnRzLnB1c2gobmV3IHRoaXMuUG9pbnRDbGFzcyh7XG5cdFx0XHRcdFx0dmFsdWUgOiB2YWx1ZSxcblx0XHRcdFx0XHRsYWJlbCA6IGxhYmVsLFxuXHRcdFx0XHRcdGRhdGFzZXRMYWJlbDogdGhpcy5kYXRhc2V0c1tkYXRhc2V0SW5kZXhdLmxhYmVsLFxuXHRcdFx0XHRcdHg6IHBvaW50UG9zaXRpb24ueCxcblx0XHRcdFx0XHR5OiBwb2ludFBvc2l0aW9uLnksXG5cdFx0XHRcdFx0c3Ryb2tlQ29sb3IgOiB0aGlzLmRhdGFzZXRzW2RhdGFzZXRJbmRleF0ucG9pbnRTdHJva2VDb2xvcixcblx0XHRcdFx0XHRmaWxsQ29sb3IgOiB0aGlzLmRhdGFzZXRzW2RhdGFzZXRJbmRleF0ucG9pbnRDb2xvclxuXHRcdFx0XHR9KSk7XG5cdFx0XHR9LHRoaXMpO1xuXG5cdFx0XHR0aGlzLnNjYWxlLmxhYmVscy5wdXNoKGxhYmVsKTtcblxuXHRcdFx0dGhpcy5yZWZsb3coKTtcblxuXHRcdFx0dGhpcy51cGRhdGUoKTtcblx0XHR9LFxuXHRcdHJlbW92ZURhdGEgOiBmdW5jdGlvbigpe1xuXHRcdFx0dGhpcy5zY2FsZS52YWx1ZXNDb3VudC0tO1xuXHRcdFx0dGhpcy5zY2FsZS5sYWJlbHMuc2hpZnQoKTtcblx0XHRcdGhlbHBlcnMuZWFjaCh0aGlzLmRhdGFzZXRzLGZ1bmN0aW9uKGRhdGFzZXQpe1xuXHRcdFx0XHRkYXRhc2V0LnBvaW50cy5zaGlmdCgpO1xuXHRcdFx0fSx0aGlzKTtcblx0XHRcdHRoaXMucmVmbG93KCk7XG5cdFx0XHR0aGlzLnVwZGF0ZSgpO1xuXHRcdH0sXG5cdFx0dXBkYXRlIDogZnVuY3Rpb24oKXtcblx0XHRcdHRoaXMuZWFjaFBvaW50cyhmdW5jdGlvbihwb2ludCl7XG5cdFx0XHRcdHBvaW50LnNhdmUoKTtcblx0XHRcdH0pO1xuXHRcdFx0dGhpcy5yZWZsb3coKTtcblx0XHRcdHRoaXMucmVuZGVyKCk7XG5cdFx0fSxcblx0XHRyZWZsb3c6IGZ1bmN0aW9uKCl7XG5cdFx0XHRoZWxwZXJzLmV4dGVuZCh0aGlzLnNjYWxlLCB7XG5cdFx0XHRcdHdpZHRoIDogdGhpcy5jaGFydC53aWR0aCxcblx0XHRcdFx0aGVpZ2h0OiB0aGlzLmNoYXJ0LmhlaWdodCxcblx0XHRcdFx0c2l6ZSA6IGhlbHBlcnMubWluKFt0aGlzLmNoYXJ0LndpZHRoLCB0aGlzLmNoYXJ0LmhlaWdodF0pLFxuXHRcdFx0XHR4Q2VudGVyOiB0aGlzLmNoYXJ0LndpZHRoLzIsXG5cdFx0XHRcdHlDZW50ZXI6IHRoaXMuY2hhcnQuaGVpZ2h0LzJcblx0XHRcdH0pO1xuXHRcdFx0dGhpcy51cGRhdGVTY2FsZVJhbmdlKHRoaXMuZGF0YXNldHMpO1xuXHRcdFx0dGhpcy5zY2FsZS5zZXRTY2FsZVNpemUoKTtcblx0XHRcdHRoaXMuc2NhbGUuYnVpbGRZTGFiZWxzKCk7XG5cdFx0fSxcblx0XHRkcmF3IDogZnVuY3Rpb24oZWFzZSl7XG5cdFx0XHR2YXIgZWFzZURlY2ltYWwgPSBlYXNlIHx8IDEsXG5cdFx0XHRcdGN0eCA9IHRoaXMuY2hhcnQuY3R4O1xuXHRcdFx0dGhpcy5jbGVhcigpO1xuXHRcdFx0dGhpcy5zY2FsZS5kcmF3KCk7XG5cblx0XHRcdGhlbHBlcnMuZWFjaCh0aGlzLmRhdGFzZXRzLGZ1bmN0aW9uKGRhdGFzZXQpe1xuXG5cdFx0XHRcdC8vVHJhbnNpdGlvbiBlYWNoIHBvaW50IGZpcnN0IHNvIHRoYXQgdGhlIGxpbmUgYW5kIHBvaW50IGRyYXdpbmcgaXNuJ3Qgb3V0IG9mIHN5bmNcblx0XHRcdFx0aGVscGVycy5lYWNoKGRhdGFzZXQucG9pbnRzLGZ1bmN0aW9uKHBvaW50LGluZGV4KXtcblx0XHRcdFx0XHRpZiAocG9pbnQuaGFzVmFsdWUoKSl7XG5cdFx0XHRcdFx0XHRwb2ludC50cmFuc2l0aW9uKHRoaXMuc2NhbGUuZ2V0UG9pbnRQb3NpdGlvbihpbmRleCwgdGhpcy5zY2FsZS5jYWxjdWxhdGVDZW50ZXJPZmZzZXQocG9pbnQudmFsdWUpKSwgZWFzZURlY2ltYWwpO1xuXHRcdFx0XHRcdH1cblx0XHRcdFx0fSx0aGlzKTtcblxuXG5cblx0XHRcdFx0Ly9EcmF3IHRoZSBsaW5lIGJldHdlZW4gYWxsIHRoZSBwb2ludHNcblx0XHRcdFx0Y3R4LmxpbmVXaWR0aCA9IHRoaXMub3B0aW9ucy5kYXRhc2V0U3Ryb2tlV2lkdGg7XG5cdFx0XHRcdGN0eC5zdHJva2VTdHlsZSA9IGRhdGFzZXQuc3Ryb2tlQ29sb3I7XG5cdFx0XHRcdGN0eC5iZWdpblBhdGgoKTtcblx0XHRcdFx0aGVscGVycy5lYWNoKGRhdGFzZXQucG9pbnRzLGZ1bmN0aW9uKHBvaW50LGluZGV4KXtcblx0XHRcdFx0XHRpZiAoaW5kZXggPT09IDApe1xuXHRcdFx0XHRcdFx0Y3R4Lm1vdmVUbyhwb2ludC54LHBvaW50LnkpO1xuXHRcdFx0XHRcdH1cblx0XHRcdFx0XHRlbHNle1xuXHRcdFx0XHRcdFx0Y3R4LmxpbmVUbyhwb2ludC54LHBvaW50LnkpO1xuXHRcdFx0XHRcdH1cblx0XHRcdFx0fSx0aGlzKTtcblx0XHRcdFx0Y3R4LmNsb3NlUGF0aCgpO1xuXHRcdFx0XHRjdHguc3Ryb2tlKCk7XG5cblx0XHRcdFx0Y3R4LmZpbGxTdHlsZSA9IGRhdGFzZXQuZmlsbENvbG9yO1xuXHRcdFx0XHRpZih0aGlzLm9wdGlvbnMuZGF0YXNldEZpbGwpe1xuXHRcdFx0XHRcdGN0eC5maWxsKCk7XG5cdFx0XHRcdH1cblx0XHRcdFx0Ly9Ob3cgZHJhdyB0aGUgcG9pbnRzIG92ZXIgdGhlIGxpbmVcblx0XHRcdFx0Ly9BIGxpdHRsZSBpbmVmZmljaWVudCBkb3VibGUgbG9vcGluZywgYnV0IGJldHRlciB0aGFuIHRoZSBsaW5lXG5cdFx0XHRcdC8vbGFnZ2luZyBiZWhpbmQgdGhlIHBvaW50IHBvc2l0aW9uc1xuXHRcdFx0XHRoZWxwZXJzLmVhY2goZGF0YXNldC5wb2ludHMsZnVuY3Rpb24ocG9pbnQpe1xuXHRcdFx0XHRcdGlmIChwb2ludC5oYXNWYWx1ZSgpKXtcblx0XHRcdFx0XHRcdHBvaW50LmRyYXcoKTtcblx0XHRcdFx0XHR9XG5cdFx0XHRcdH0pO1xuXG5cdFx0XHR9LHRoaXMpO1xuXG5cdFx0fVxuXG5cdH0pO1xuXG5cblxuXG5cbn0pLmNhbGwodGhpcyk7XG4iLCIvKiFcbiAqIGpRdWVyeSBVSSA6ZGF0YSAxLjEyLjFcbiAqIGh0dHA6Ly9qcXVlcnl1aS5jb21cbiAqXG4gKiBDb3B5cmlnaHQgalF1ZXJ5IEZvdW5kYXRpb24gYW5kIG90aGVyIGNvbnRyaWJ1dG9yc1xuICogUmVsZWFzZWQgdW5kZXIgdGhlIE1JVCBsaWNlbnNlLlxuICogaHR0cDovL2pxdWVyeS5vcmcvbGljZW5zZVxuICovXG5cbi8vPj5sYWJlbDogOmRhdGEgU2VsZWN0b3Jcbi8vPj5ncm91cDogQ29yZVxuLy8+PmRlc2NyaXB0aW9uOiBTZWxlY3RzIGVsZW1lbnRzIHdoaWNoIGhhdmUgZGF0YSBzdG9yZWQgdW5kZXIgdGhlIHNwZWNpZmllZCBrZXkuXG4vLz4+ZG9jczogaHR0cDovL2FwaS5qcXVlcnl1aS5jb20vZGF0YS1zZWxlY3Rvci9cblxuKCBmdW5jdGlvbiggZmFjdG9yeSApIHtcblx0aWYgKCB0eXBlb2YgZGVmaW5lID09PSBcImZ1bmN0aW9uXCIgJiYgZGVmaW5lLmFtZCApIHtcblxuXHRcdC8vIEFNRC4gUmVnaXN0ZXIgYXMgYW4gYW5vbnltb3VzIG1vZHVsZS5cblx0XHRkZWZpbmUoIFsgXCJqcXVlcnlcIiwgXCIuL3ZlcnNpb25cIiBdLCBmYWN0b3J5ICk7XG5cdH0gZWxzZSB7XG5cblx0XHQvLyBCcm93c2VyIGdsb2JhbHNcblx0XHRmYWN0b3J5KCBqUXVlcnkgKTtcblx0fVxufSAoIGZ1bmN0aW9uKCAkICkge1xucmV0dXJuICQuZXh0ZW5kKCAkLmV4cHJbIFwiOlwiIF0sIHtcblx0ZGF0YTogJC5leHByLmNyZWF0ZVBzZXVkbyA/XG5cdFx0JC5leHByLmNyZWF0ZVBzZXVkbyggZnVuY3Rpb24oIGRhdGFOYW1lICkge1xuXHRcdFx0cmV0dXJuIGZ1bmN0aW9uKCBlbGVtICkge1xuXHRcdFx0XHRyZXR1cm4gISEkLmRhdGEoIGVsZW0sIGRhdGFOYW1lICk7XG5cdFx0XHR9O1xuXHRcdH0gKSA6XG5cblx0XHQvLyBTdXBwb3J0OiBqUXVlcnkgPDEuOFxuXHRcdGZ1bmN0aW9uKCBlbGVtLCBpLCBtYXRjaCApIHtcblx0XHRcdHJldHVybiAhISQuZGF0YSggZWxlbSwgbWF0Y2hbIDMgXSApO1xuXHRcdH1cbn0gKTtcbn0gKSApO1xuIiwiLyohXG4gKiBqUXVlcnkgVUkgRGlzYWJsZSBTZWxlY3Rpb24gMS4xMi4xXG4gKiBodHRwOi8vanF1ZXJ5dWkuY29tXG4gKlxuICogQ29weXJpZ2h0IGpRdWVyeSBGb3VuZGF0aW9uIGFuZCBvdGhlciBjb250cmlidXRvcnNcbiAqIFJlbGVhc2VkIHVuZGVyIHRoZSBNSVQgbGljZW5zZS5cbiAqIGh0dHA6Ly9qcXVlcnkub3JnL2xpY2Vuc2VcbiAqL1xuXG4vLz4+bGFiZWw6IGRpc2FibGVTZWxlY3Rpb25cbi8vPj5ncm91cDogQ29yZVxuLy8+PmRlc2NyaXB0aW9uOiBEaXNhYmxlIHNlbGVjdGlvbiBvZiB0ZXh0IGNvbnRlbnQgd2l0aGluIHRoZSBzZXQgb2YgbWF0Y2hlZCBlbGVtZW50cy5cbi8vPj5kb2NzOiBodHRwOi8vYXBpLmpxdWVyeXVpLmNvbS9kaXNhYmxlU2VsZWN0aW9uL1xuXG4vLyBUaGlzIGZpbGUgaXMgZGVwcmVjYXRlZFxuKCBmdW5jdGlvbiggZmFjdG9yeSApIHtcblx0aWYgKCB0eXBlb2YgZGVmaW5lID09PSBcImZ1bmN0aW9uXCIgJiYgZGVmaW5lLmFtZCApIHtcblxuXHRcdC8vIEFNRC4gUmVnaXN0ZXIgYXMgYW4gYW5vbnltb3VzIG1vZHVsZS5cblx0XHRkZWZpbmUoIFsgXCJqcXVlcnlcIiwgXCIuL3ZlcnNpb25cIiBdLCBmYWN0b3J5ICk7XG5cdH0gZWxzZSB7XG5cblx0XHQvLyBCcm93c2VyIGdsb2JhbHNcblx0XHRmYWN0b3J5KCBqUXVlcnkgKTtcblx0fVxufSAoIGZ1bmN0aW9uKCAkICkge1xuXG5yZXR1cm4gJC5mbi5leHRlbmQoIHtcblx0ZGlzYWJsZVNlbGVjdGlvbjogKCBmdW5jdGlvbigpIHtcblx0XHR2YXIgZXZlbnRUeXBlID0gXCJvbnNlbGVjdHN0YXJ0XCIgaW4gZG9jdW1lbnQuY3JlYXRlRWxlbWVudCggXCJkaXZcIiApID9cblx0XHRcdFwic2VsZWN0c3RhcnRcIiA6XG5cdFx0XHRcIm1vdXNlZG93blwiO1xuXG5cdFx0cmV0dXJuIGZ1bmN0aW9uKCkge1xuXHRcdFx0cmV0dXJuIHRoaXMub24oIGV2ZW50VHlwZSArIFwiLnVpLWRpc2FibGVTZWxlY3Rpb25cIiwgZnVuY3Rpb24oIGV2ZW50ICkge1xuXHRcdFx0XHRldmVudC5wcmV2ZW50RGVmYXVsdCgpO1xuXHRcdFx0fSApO1xuXHRcdH07XG5cdH0gKSgpLFxuXG5cdGVuYWJsZVNlbGVjdGlvbjogZnVuY3Rpb24oKSB7XG5cdFx0cmV0dXJuIHRoaXMub2ZmKCBcIi51aS1kaXNhYmxlU2VsZWN0aW9uXCIgKTtcblx0fVxufSApO1xuXG59ICkgKTtcbiIsIi8qIVxuICogalF1ZXJ5IFVJIEZvY3VzYWJsZSAxLjEyLjFcbiAqIGh0dHA6Ly9qcXVlcnl1aS5jb21cbiAqXG4gKiBDb3B5cmlnaHQgalF1ZXJ5IEZvdW5kYXRpb24gYW5kIG90aGVyIGNvbnRyaWJ1dG9yc1xuICogUmVsZWFzZWQgdW5kZXIgdGhlIE1JVCBsaWNlbnNlLlxuICogaHR0cDovL2pxdWVyeS5vcmcvbGljZW5zZVxuICovXG5cbi8vPj5sYWJlbDogOmZvY3VzYWJsZSBTZWxlY3RvclxuLy8+Pmdyb3VwOiBDb3JlXG4vLz4+ZGVzY3JpcHRpb246IFNlbGVjdHMgZWxlbWVudHMgd2hpY2ggY2FuIGJlIGZvY3VzZWQuXG4vLz4+ZG9jczogaHR0cDovL2FwaS5qcXVlcnl1aS5jb20vZm9jdXNhYmxlLXNlbGVjdG9yL1xuXG4oIGZ1bmN0aW9uKCBmYWN0b3J5ICkge1xuXHRpZiAoIHR5cGVvZiBkZWZpbmUgPT09IFwiZnVuY3Rpb25cIiAmJiBkZWZpbmUuYW1kICkge1xuXG5cdFx0Ly8gQU1ELiBSZWdpc3RlciBhcyBhbiBhbm9ueW1vdXMgbW9kdWxlLlxuXHRcdGRlZmluZSggWyBcImpxdWVyeVwiLCBcIi4vdmVyc2lvblwiIF0sIGZhY3RvcnkgKTtcblx0fSBlbHNlIHtcblxuXHRcdC8vIEJyb3dzZXIgZ2xvYmFsc1xuXHRcdGZhY3RvcnkoIGpRdWVyeSApO1xuXHR9XG59ICggZnVuY3Rpb24oICQgKSB7XG5cbi8vIFNlbGVjdG9yc1xuJC51aS5mb2N1c2FibGUgPSBmdW5jdGlvbiggZWxlbWVudCwgaGFzVGFiaW5kZXggKSB7XG5cdHZhciBtYXAsIG1hcE5hbWUsIGltZywgZm9jdXNhYmxlSWZWaXNpYmxlLCBmaWVsZHNldCxcblx0XHRub2RlTmFtZSA9IGVsZW1lbnQubm9kZU5hbWUudG9Mb3dlckNhc2UoKTtcblxuXHRpZiAoIFwiYXJlYVwiID09PSBub2RlTmFtZSApIHtcblx0XHRtYXAgPSBlbGVtZW50LnBhcmVudE5vZGU7XG5cdFx0bWFwTmFtZSA9IG1hcC5uYW1lO1xuXHRcdGlmICggIWVsZW1lbnQuaHJlZiB8fCAhbWFwTmFtZSB8fCBtYXAubm9kZU5hbWUudG9Mb3dlckNhc2UoKSAhPT0gXCJtYXBcIiApIHtcblx0XHRcdHJldHVybiBmYWxzZTtcblx0XHR9XG5cdFx0aW1nID0gJCggXCJpbWdbdXNlbWFwPScjXCIgKyBtYXBOYW1lICsgXCInXVwiICk7XG5cdFx0cmV0dXJuIGltZy5sZW5ndGggPiAwICYmIGltZy5pcyggXCI6dmlzaWJsZVwiICk7XG5cdH1cblxuXHRpZiAoIC9eKGlucHV0fHNlbGVjdHx0ZXh0YXJlYXxidXR0b258b2JqZWN0KSQvLnRlc3QoIG5vZGVOYW1lICkgKSB7XG5cdFx0Zm9jdXNhYmxlSWZWaXNpYmxlID0gIWVsZW1lbnQuZGlzYWJsZWQ7XG5cblx0XHRpZiAoIGZvY3VzYWJsZUlmVmlzaWJsZSApIHtcblxuXHRcdFx0Ly8gRm9ybSBjb250cm9scyB3aXRoaW4gYSBkaXNhYmxlZCBmaWVsZHNldCBhcmUgZGlzYWJsZWQuXG5cdFx0XHQvLyBIb3dldmVyLCBjb250cm9scyB3aXRoaW4gdGhlIGZpZWxkc2V0J3MgbGVnZW5kIGRvIG5vdCBnZXQgZGlzYWJsZWQuXG5cdFx0XHQvLyBTaW5jZSBjb250cm9scyBnZW5lcmFsbHkgYXJlbid0IHBsYWNlZCBpbnNpZGUgbGVnZW5kcywgd2Ugc2tpcFxuXHRcdFx0Ly8gdGhpcyBwb3J0aW9uIG9mIHRoZSBjaGVjay5cblx0XHRcdGZpZWxkc2V0ID0gJCggZWxlbWVudCApLmNsb3Nlc3QoIFwiZmllbGRzZXRcIiApWyAwIF07XG5cdFx0XHRpZiAoIGZpZWxkc2V0ICkge1xuXHRcdFx0XHRmb2N1c2FibGVJZlZpc2libGUgPSAhZmllbGRzZXQuZGlzYWJsZWQ7XG5cdFx0XHR9XG5cdFx0fVxuXHR9IGVsc2UgaWYgKCBcImFcIiA9PT0gbm9kZU5hbWUgKSB7XG5cdFx0Zm9jdXNhYmxlSWZWaXNpYmxlID0gZWxlbWVudC5ocmVmIHx8IGhhc1RhYmluZGV4O1xuXHR9IGVsc2Uge1xuXHRcdGZvY3VzYWJsZUlmVmlzaWJsZSA9IGhhc1RhYmluZGV4O1xuXHR9XG5cblx0cmV0dXJuIGZvY3VzYWJsZUlmVmlzaWJsZSAmJiAkKCBlbGVtZW50ICkuaXMoIFwiOnZpc2libGVcIiApICYmIHZpc2libGUoICQoIGVsZW1lbnQgKSApO1xufTtcblxuLy8gU3VwcG9ydDogSUUgOCBvbmx5XG4vLyBJRSA4IGRvZXNuJ3QgcmVzb2x2ZSBpbmhlcml0IHRvIHZpc2libGUvaGlkZGVuIGZvciBjb21wdXRlZCB2YWx1ZXNcbmZ1bmN0aW9uIHZpc2libGUoIGVsZW1lbnQgKSB7XG5cdHZhciB2aXNpYmlsaXR5ID0gZWxlbWVudC5jc3MoIFwidmlzaWJpbGl0eVwiICk7XG5cdHdoaWxlICggdmlzaWJpbGl0eSA9PT0gXCJpbmhlcml0XCIgKSB7XG5cdFx0ZWxlbWVudCA9IGVsZW1lbnQucGFyZW50KCk7XG5cdFx0dmlzaWJpbGl0eSA9IGVsZW1lbnQuY3NzKCBcInZpc2liaWxpdHlcIiApO1xuXHR9XG5cdHJldHVybiB2aXNpYmlsaXR5ICE9PSBcImhpZGRlblwiO1xufVxuXG4kLmV4dGVuZCggJC5leHByWyBcIjpcIiBdLCB7XG5cdGZvY3VzYWJsZTogZnVuY3Rpb24oIGVsZW1lbnQgKSB7XG5cdFx0cmV0dXJuICQudWkuZm9jdXNhYmxlKCBlbGVtZW50LCAkLmF0dHIoIGVsZW1lbnQsIFwidGFiaW5kZXhcIiApICE9IG51bGwgKTtcblx0fVxufSApO1xuXG5yZXR1cm4gJC51aS5mb2N1c2FibGU7XG5cbn0gKSApO1xuIiwiKCBmdW5jdGlvbiggZmFjdG9yeSApIHtcblx0aWYgKCB0eXBlb2YgZGVmaW5lID09PSBcImZ1bmN0aW9uXCIgJiYgZGVmaW5lLmFtZCApIHtcblxuXHRcdC8vIEFNRC4gUmVnaXN0ZXIgYXMgYW4gYW5vbnltb3VzIG1vZHVsZS5cblx0XHRkZWZpbmUoIFsgXCJqcXVlcnlcIiwgXCIuL3ZlcnNpb25cIiBdLCBmYWN0b3J5ICk7XG5cdH0gZWxzZSB7XG5cblx0XHQvLyBCcm93c2VyIGdsb2JhbHNcblx0XHRmYWN0b3J5KCBqUXVlcnkgKTtcblx0fVxufSAoIGZ1bmN0aW9uKCAkICkge1xuXG4vLyBUaGlzIGZpbGUgaXMgZGVwcmVjYXRlZFxucmV0dXJuICQudWkuaWUgPSAhIS9tc2llIFtcXHcuXSsvLmV4ZWMoIG5hdmlnYXRvci51c2VyQWdlbnQudG9Mb3dlckNhc2UoKSApO1xufSApICk7XG4iLCIvKiFcbiAqIGpRdWVyeSBVSSBLZXljb2RlIDEuMTIuMVxuICogaHR0cDovL2pxdWVyeXVpLmNvbVxuICpcbiAqIENvcHlyaWdodCBqUXVlcnkgRm91bmRhdGlvbiBhbmQgb3RoZXIgY29udHJpYnV0b3JzXG4gKiBSZWxlYXNlZCB1bmRlciB0aGUgTUlUIGxpY2Vuc2UuXG4gKiBodHRwOi8vanF1ZXJ5Lm9yZy9saWNlbnNlXG4gKi9cblxuLy8+PmxhYmVsOiBLZXljb2RlXG4vLz4+Z3JvdXA6IENvcmVcbi8vPj5kZXNjcmlwdGlvbjogUHJvdmlkZSBrZXljb2RlcyBhcyBrZXluYW1lc1xuLy8+PmRvY3M6IGh0dHA6Ly9hcGkuanF1ZXJ5dWkuY29tL2pRdWVyeS51aS5rZXlDb2RlL1xuXG4oIGZ1bmN0aW9uKCBmYWN0b3J5ICkge1xuXHRpZiAoIHR5cGVvZiBkZWZpbmUgPT09IFwiZnVuY3Rpb25cIiAmJiBkZWZpbmUuYW1kICkge1xuXG5cdFx0Ly8gQU1ELiBSZWdpc3RlciBhcyBhbiBhbm9ueW1vdXMgbW9kdWxlLlxuXHRcdGRlZmluZSggWyBcImpxdWVyeVwiLCBcIi4vdmVyc2lvblwiIF0sIGZhY3RvcnkgKTtcblx0fSBlbHNlIHtcblxuXHRcdC8vIEJyb3dzZXIgZ2xvYmFsc1xuXHRcdGZhY3RvcnkoIGpRdWVyeSApO1xuXHR9XG59ICggZnVuY3Rpb24oICQgKSB7XG5yZXR1cm4gJC51aS5rZXlDb2RlID0ge1xuXHRCQUNLU1BBQ0U6IDgsXG5cdENPTU1BOiAxODgsXG5cdERFTEVURTogNDYsXG5cdERPV046IDQwLFxuXHRFTkQ6IDM1LFxuXHRFTlRFUjogMTMsXG5cdEVTQ0FQRTogMjcsXG5cdEhPTUU6IDM2LFxuXHRMRUZUOiAzNyxcblx0UEFHRV9ET1dOOiAzNCxcblx0UEFHRV9VUDogMzMsXG5cdFBFUklPRDogMTkwLFxuXHRSSUdIVDogMzksXG5cdFNQQUNFOiAzMixcblx0VEFCOiA5LFxuXHRVUDogMzhcbn07XG5cbn0gKSApO1xuIiwiKCBmdW5jdGlvbiggZmFjdG9yeSApIHtcblx0aWYgKCB0eXBlb2YgZGVmaW5lID09PSBcImZ1bmN0aW9uXCIgJiYgZGVmaW5lLmFtZCApIHtcblxuXHRcdC8vIEFNRC4gUmVnaXN0ZXIgYXMgYW4gYW5vbnltb3VzIG1vZHVsZS5cblx0XHRkZWZpbmUoIFsgXCJqcXVlcnlcIiwgXCIuL3ZlcnNpb25cIiBdLCBmYWN0b3J5ICk7XG5cdH0gZWxzZSB7XG5cblx0XHQvLyBCcm93c2VyIGdsb2JhbHNcblx0XHRmYWN0b3J5KCBqUXVlcnkgKTtcblx0fVxufSAoIGZ1bmN0aW9uKCAkICkge1xuXG4vLyAkLnVpLnBsdWdpbiBpcyBkZXByZWNhdGVkLiBVc2UgJC53aWRnZXQoKSBleHRlbnNpb25zIGluc3RlYWQuXG5yZXR1cm4gJC51aS5wbHVnaW4gPSB7XG5cdGFkZDogZnVuY3Rpb24oIG1vZHVsZSwgb3B0aW9uLCBzZXQgKSB7XG5cdFx0dmFyIGksXG5cdFx0XHRwcm90byA9ICQudWlbIG1vZHVsZSBdLnByb3RvdHlwZTtcblx0XHRmb3IgKCBpIGluIHNldCApIHtcblx0XHRcdHByb3RvLnBsdWdpbnNbIGkgXSA9IHByb3RvLnBsdWdpbnNbIGkgXSB8fCBbXTtcblx0XHRcdHByb3RvLnBsdWdpbnNbIGkgXS5wdXNoKCBbIG9wdGlvbiwgc2V0WyBpIF0gXSApO1xuXHRcdH1cblx0fSxcblx0Y2FsbDogZnVuY3Rpb24oIGluc3RhbmNlLCBuYW1lLCBhcmdzLCBhbGxvd0Rpc2Nvbm5lY3RlZCApIHtcblx0XHR2YXIgaSxcblx0XHRcdHNldCA9IGluc3RhbmNlLnBsdWdpbnNbIG5hbWUgXTtcblxuXHRcdGlmICggIXNldCApIHtcblx0XHRcdHJldHVybjtcblx0XHR9XG5cblx0XHRpZiAoICFhbGxvd0Rpc2Nvbm5lY3RlZCAmJiAoICFpbnN0YW5jZS5lbGVtZW50WyAwIF0ucGFyZW50Tm9kZSB8fFxuXHRcdFx0XHRpbnN0YW5jZS5lbGVtZW50WyAwIF0ucGFyZW50Tm9kZS5ub2RlVHlwZSA9PT0gMTEgKSApIHtcblx0XHRcdHJldHVybjtcblx0XHR9XG5cblx0XHRmb3IgKCBpID0gMDsgaSA8IHNldC5sZW5ndGg7IGkrKyApIHtcblx0XHRcdGlmICggaW5zdGFuY2Uub3B0aW9uc1sgc2V0WyBpIF1bIDAgXSBdICkge1xuXHRcdFx0XHRzZXRbIGkgXVsgMSBdLmFwcGx5KCBpbnN0YW5jZS5lbGVtZW50LCBhcmdzICk7XG5cdFx0XHR9XG5cdFx0fVxuXHR9XG59O1xuXG59ICkgKTtcbiIsIi8qIVxuICogalF1ZXJ5IFVJIFBvc2l0aW9uIDEuMTIuMVxuICogaHR0cDovL2pxdWVyeXVpLmNvbVxuICpcbiAqIENvcHlyaWdodCBqUXVlcnkgRm91bmRhdGlvbiBhbmQgb3RoZXIgY29udHJpYnV0b3JzXG4gKiBSZWxlYXNlZCB1bmRlciB0aGUgTUlUIGxpY2Vuc2UuXG4gKiBodHRwOi8vanF1ZXJ5Lm9yZy9saWNlbnNlXG4gKlxuICogaHR0cDovL2FwaS5qcXVlcnl1aS5jb20vcG9zaXRpb24vXG4gKi9cblxuLy8+PmxhYmVsOiBQb3NpdGlvblxuLy8+Pmdyb3VwOiBDb3JlXG4vLz4+ZGVzY3JpcHRpb246IFBvc2l0aW9ucyBlbGVtZW50cyByZWxhdGl2ZSB0byBvdGhlciBlbGVtZW50cy5cbi8vPj5kb2NzOiBodHRwOi8vYXBpLmpxdWVyeXVpLmNvbS9wb3NpdGlvbi9cbi8vPj5kZW1vczogaHR0cDovL2pxdWVyeXVpLmNvbS9wb3NpdGlvbi9cblxuKCBmdW5jdGlvbiggZmFjdG9yeSApIHtcblx0aWYgKCB0eXBlb2YgZGVmaW5lID09PSBcImZ1bmN0aW9uXCIgJiYgZGVmaW5lLmFtZCApIHtcblxuXHRcdC8vIEFNRC4gUmVnaXN0ZXIgYXMgYW4gYW5vbnltb3VzIG1vZHVsZS5cblx0XHRkZWZpbmUoIFsgXCJqcXVlcnlcIiwgXCIuL3ZlcnNpb25cIiBdLCBmYWN0b3J5ICk7XG5cdH0gZWxzZSB7XG5cblx0XHQvLyBCcm93c2VyIGdsb2JhbHNcblx0XHRmYWN0b3J5KCBqUXVlcnkgKTtcblx0fVxufSggZnVuY3Rpb24oICQgKSB7XG4oIGZ1bmN0aW9uKCkge1xudmFyIGNhY2hlZFNjcm9sbGJhcldpZHRoLFxuXHRtYXggPSBNYXRoLm1heCxcblx0YWJzID0gTWF0aC5hYnMsXG5cdHJob3Jpem9udGFsID0gL2xlZnR8Y2VudGVyfHJpZ2h0Lyxcblx0cnZlcnRpY2FsID0gL3RvcHxjZW50ZXJ8Ym90dG9tLyxcblx0cm9mZnNldCA9IC9bXFwrXFwtXVxcZCsoXFwuW1xcZF0rKT8lPy8sXG5cdHJwb3NpdGlvbiA9IC9eXFx3Ky8sXG5cdHJwZXJjZW50ID0gLyUkLyxcblx0X3Bvc2l0aW9uID0gJC5mbi5wb3NpdGlvbjtcblxuZnVuY3Rpb24gZ2V0T2Zmc2V0cyggb2Zmc2V0cywgd2lkdGgsIGhlaWdodCApIHtcblx0cmV0dXJuIFtcblx0XHRwYXJzZUZsb2F0KCBvZmZzZXRzWyAwIF0gKSAqICggcnBlcmNlbnQudGVzdCggb2Zmc2V0c1sgMCBdICkgPyB3aWR0aCAvIDEwMCA6IDEgKSxcblx0XHRwYXJzZUZsb2F0KCBvZmZzZXRzWyAxIF0gKSAqICggcnBlcmNlbnQudGVzdCggb2Zmc2V0c1sgMSBdICkgPyBoZWlnaHQgLyAxMDAgOiAxIClcblx0XTtcbn1cblxuZnVuY3Rpb24gcGFyc2VDc3MoIGVsZW1lbnQsIHByb3BlcnR5ICkge1xuXHRyZXR1cm4gcGFyc2VJbnQoICQuY3NzKCBlbGVtZW50LCBwcm9wZXJ0eSApLCAxMCApIHx8IDA7XG59XG5cbmZ1bmN0aW9uIGdldERpbWVuc2lvbnMoIGVsZW0gKSB7XG5cdHZhciByYXcgPSBlbGVtWyAwIF07XG5cdGlmICggcmF3Lm5vZGVUeXBlID09PSA5ICkge1xuXHRcdHJldHVybiB7XG5cdFx0XHR3aWR0aDogZWxlbS53aWR0aCgpLFxuXHRcdFx0aGVpZ2h0OiBlbGVtLmhlaWdodCgpLFxuXHRcdFx0b2Zmc2V0OiB7IHRvcDogMCwgbGVmdDogMCB9XG5cdFx0fTtcblx0fVxuXHRpZiAoICQuaXNXaW5kb3coIHJhdyApICkge1xuXHRcdHJldHVybiB7XG5cdFx0XHR3aWR0aDogZWxlbS53aWR0aCgpLFxuXHRcdFx0aGVpZ2h0OiBlbGVtLmhlaWdodCgpLFxuXHRcdFx0b2Zmc2V0OiB7IHRvcDogZWxlbS5zY3JvbGxUb3AoKSwgbGVmdDogZWxlbS5zY3JvbGxMZWZ0KCkgfVxuXHRcdH07XG5cdH1cblx0aWYgKCByYXcucHJldmVudERlZmF1bHQgKSB7XG5cdFx0cmV0dXJuIHtcblx0XHRcdHdpZHRoOiAwLFxuXHRcdFx0aGVpZ2h0OiAwLFxuXHRcdFx0b2Zmc2V0OiB7IHRvcDogcmF3LnBhZ2VZLCBsZWZ0OiByYXcucGFnZVggfVxuXHRcdH07XG5cdH1cblx0cmV0dXJuIHtcblx0XHR3aWR0aDogZWxlbS5vdXRlcldpZHRoKCksXG5cdFx0aGVpZ2h0OiBlbGVtLm91dGVySGVpZ2h0KCksXG5cdFx0b2Zmc2V0OiBlbGVtLm9mZnNldCgpXG5cdH07XG59XG5cbiQucG9zaXRpb24gPSB7XG5cdHNjcm9sbGJhcldpZHRoOiBmdW5jdGlvbigpIHtcblx0XHRpZiAoIGNhY2hlZFNjcm9sbGJhcldpZHRoICE9PSB1bmRlZmluZWQgKSB7XG5cdFx0XHRyZXR1cm4gY2FjaGVkU2Nyb2xsYmFyV2lkdGg7XG5cdFx0fVxuXHRcdHZhciB3MSwgdzIsXG5cdFx0XHRkaXYgPSAkKCBcIjxkaXYgXCIgK1xuXHRcdFx0XHRcInN0eWxlPSdkaXNwbGF5OmJsb2NrO3Bvc2l0aW9uOmFic29sdXRlO3dpZHRoOjUwcHg7aGVpZ2h0OjUwcHg7b3ZlcmZsb3c6aGlkZGVuOyc+XCIgK1xuXHRcdFx0XHRcIjxkaXYgc3R5bGU9J2hlaWdodDoxMDBweDt3aWR0aDphdXRvOyc+PC9kaXY+PC9kaXY+XCIgKSxcblx0XHRcdGlubmVyRGl2ID0gZGl2LmNoaWxkcmVuKClbIDAgXTtcblxuXHRcdCQoIFwiYm9keVwiICkuYXBwZW5kKCBkaXYgKTtcblx0XHR3MSA9IGlubmVyRGl2Lm9mZnNldFdpZHRoO1xuXHRcdGRpdi5jc3MoIFwib3ZlcmZsb3dcIiwgXCJzY3JvbGxcIiApO1xuXG5cdFx0dzIgPSBpbm5lckRpdi5vZmZzZXRXaWR0aDtcblxuXHRcdGlmICggdzEgPT09IHcyICkge1xuXHRcdFx0dzIgPSBkaXZbIDAgXS5jbGllbnRXaWR0aDtcblx0XHR9XG5cblx0XHRkaXYucmVtb3ZlKCk7XG5cblx0XHRyZXR1cm4gKCBjYWNoZWRTY3JvbGxiYXJXaWR0aCA9IHcxIC0gdzIgKTtcblx0fSxcblx0Z2V0U2Nyb2xsSW5mbzogZnVuY3Rpb24oIHdpdGhpbiApIHtcblx0XHR2YXIgb3ZlcmZsb3dYID0gd2l0aGluLmlzV2luZG93IHx8IHdpdGhpbi5pc0RvY3VtZW50ID8gXCJcIiA6XG5cdFx0XHRcdHdpdGhpbi5lbGVtZW50LmNzcyggXCJvdmVyZmxvdy14XCIgKSxcblx0XHRcdG92ZXJmbG93WSA9IHdpdGhpbi5pc1dpbmRvdyB8fCB3aXRoaW4uaXNEb2N1bWVudCA/IFwiXCIgOlxuXHRcdFx0XHR3aXRoaW4uZWxlbWVudC5jc3MoIFwib3ZlcmZsb3cteVwiICksXG5cdFx0XHRoYXNPdmVyZmxvd1ggPSBvdmVyZmxvd1ggPT09IFwic2Nyb2xsXCIgfHxcblx0XHRcdFx0KCBvdmVyZmxvd1ggPT09IFwiYXV0b1wiICYmIHdpdGhpbi53aWR0aCA8IHdpdGhpbi5lbGVtZW50WyAwIF0uc2Nyb2xsV2lkdGggKSxcblx0XHRcdGhhc092ZXJmbG93WSA9IG92ZXJmbG93WSA9PT0gXCJzY3JvbGxcIiB8fFxuXHRcdFx0XHQoIG92ZXJmbG93WSA9PT0gXCJhdXRvXCIgJiYgd2l0aGluLmhlaWdodCA8IHdpdGhpbi5lbGVtZW50WyAwIF0uc2Nyb2xsSGVpZ2h0ICk7XG5cdFx0cmV0dXJuIHtcblx0XHRcdHdpZHRoOiBoYXNPdmVyZmxvd1kgPyAkLnBvc2l0aW9uLnNjcm9sbGJhcldpZHRoKCkgOiAwLFxuXHRcdFx0aGVpZ2h0OiBoYXNPdmVyZmxvd1ggPyAkLnBvc2l0aW9uLnNjcm9sbGJhcldpZHRoKCkgOiAwXG5cdFx0fTtcblx0fSxcblx0Z2V0V2l0aGluSW5mbzogZnVuY3Rpb24oIGVsZW1lbnQgKSB7XG5cdFx0dmFyIHdpdGhpbkVsZW1lbnQgPSAkKCBlbGVtZW50IHx8IHdpbmRvdyApLFxuXHRcdFx0aXNXaW5kb3cgPSAkLmlzV2luZG93KCB3aXRoaW5FbGVtZW50WyAwIF0gKSxcblx0XHRcdGlzRG9jdW1lbnQgPSAhIXdpdGhpbkVsZW1lbnRbIDAgXSAmJiB3aXRoaW5FbGVtZW50WyAwIF0ubm9kZVR5cGUgPT09IDksXG5cdFx0XHRoYXNPZmZzZXQgPSAhaXNXaW5kb3cgJiYgIWlzRG9jdW1lbnQ7XG5cdFx0cmV0dXJuIHtcblx0XHRcdGVsZW1lbnQ6IHdpdGhpbkVsZW1lbnQsXG5cdFx0XHRpc1dpbmRvdzogaXNXaW5kb3csXG5cdFx0XHRpc0RvY3VtZW50OiBpc0RvY3VtZW50LFxuXHRcdFx0b2Zmc2V0OiBoYXNPZmZzZXQgPyAkKCBlbGVtZW50ICkub2Zmc2V0KCkgOiB7IGxlZnQ6IDAsIHRvcDogMCB9LFxuXHRcdFx0c2Nyb2xsTGVmdDogd2l0aGluRWxlbWVudC5zY3JvbGxMZWZ0KCksXG5cdFx0XHRzY3JvbGxUb3A6IHdpdGhpbkVsZW1lbnQuc2Nyb2xsVG9wKCksXG5cdFx0XHR3aWR0aDogd2l0aGluRWxlbWVudC5vdXRlcldpZHRoKCksXG5cdFx0XHRoZWlnaHQ6IHdpdGhpbkVsZW1lbnQub3V0ZXJIZWlnaHQoKVxuXHRcdH07XG5cdH1cbn07XG5cbiQuZm4ucG9zaXRpb24gPSBmdW5jdGlvbiggb3B0aW9ucyApIHtcblx0aWYgKCAhb3B0aW9ucyB8fCAhb3B0aW9ucy5vZiApIHtcblx0XHRyZXR1cm4gX3Bvc2l0aW9uLmFwcGx5KCB0aGlzLCBhcmd1bWVudHMgKTtcblx0fVxuXG5cdC8vIE1ha2UgYSBjb3B5LCB3ZSBkb24ndCB3YW50IHRvIG1vZGlmeSBhcmd1bWVudHNcblx0b3B0aW9ucyA9ICQuZXh0ZW5kKCB7fSwgb3B0aW9ucyApO1xuXG5cdHZhciBhdE9mZnNldCwgdGFyZ2V0V2lkdGgsIHRhcmdldEhlaWdodCwgdGFyZ2V0T2Zmc2V0LCBiYXNlUG9zaXRpb24sIGRpbWVuc2lvbnMsXG5cdFx0dGFyZ2V0ID0gJCggb3B0aW9ucy5vZiApLFxuXHRcdHdpdGhpbiA9ICQucG9zaXRpb24uZ2V0V2l0aGluSW5mbyggb3B0aW9ucy53aXRoaW4gKSxcblx0XHRzY3JvbGxJbmZvID0gJC5wb3NpdGlvbi5nZXRTY3JvbGxJbmZvKCB3aXRoaW4gKSxcblx0XHRjb2xsaXNpb24gPSAoIG9wdGlvbnMuY29sbGlzaW9uIHx8IFwiZmxpcFwiICkuc3BsaXQoIFwiIFwiICksXG5cdFx0b2Zmc2V0cyA9IHt9O1xuXG5cdGRpbWVuc2lvbnMgPSBnZXREaW1lbnNpb25zKCB0YXJnZXQgKTtcblx0aWYgKCB0YXJnZXRbIDAgXS5wcmV2ZW50RGVmYXVsdCApIHtcblxuXHRcdC8vIEZvcmNlIGxlZnQgdG9wIHRvIGFsbG93IGZsaXBwaW5nXG5cdFx0b3B0aW9ucy5hdCA9IFwibGVmdCB0b3BcIjtcblx0fVxuXHR0YXJnZXRXaWR0aCA9IGRpbWVuc2lvbnMud2lkdGg7XG5cdHRhcmdldEhlaWdodCA9IGRpbWVuc2lvbnMuaGVpZ2h0O1xuXHR0YXJnZXRPZmZzZXQgPSBkaW1lbnNpb25zLm9mZnNldDtcblxuXHQvLyBDbG9uZSB0byByZXVzZSBvcmlnaW5hbCB0YXJnZXRPZmZzZXQgbGF0ZXJcblx0YmFzZVBvc2l0aW9uID0gJC5leHRlbmQoIHt9LCB0YXJnZXRPZmZzZXQgKTtcblxuXHQvLyBGb3JjZSBteSBhbmQgYXQgdG8gaGF2ZSB2YWxpZCBob3Jpem9udGFsIGFuZCB2ZXJ0aWNhbCBwb3NpdGlvbnNcblx0Ly8gaWYgYSB2YWx1ZSBpcyBtaXNzaW5nIG9yIGludmFsaWQsIGl0IHdpbGwgYmUgY29udmVydGVkIHRvIGNlbnRlclxuXHQkLmVhY2goIFsgXCJteVwiLCBcImF0XCIgXSwgZnVuY3Rpb24oKSB7XG5cdFx0dmFyIHBvcyA9ICggb3B0aW9uc1sgdGhpcyBdIHx8IFwiXCIgKS5zcGxpdCggXCIgXCIgKSxcblx0XHRcdGhvcml6b250YWxPZmZzZXQsXG5cdFx0XHR2ZXJ0aWNhbE9mZnNldDtcblxuXHRcdGlmICggcG9zLmxlbmd0aCA9PT0gMSApIHtcblx0XHRcdHBvcyA9IHJob3Jpem9udGFsLnRlc3QoIHBvc1sgMCBdICkgP1xuXHRcdFx0XHRwb3MuY29uY2F0KCBbIFwiY2VudGVyXCIgXSApIDpcblx0XHRcdFx0cnZlcnRpY2FsLnRlc3QoIHBvc1sgMCBdICkgP1xuXHRcdFx0XHRcdFsgXCJjZW50ZXJcIiBdLmNvbmNhdCggcG9zICkgOlxuXHRcdFx0XHRcdFsgXCJjZW50ZXJcIiwgXCJjZW50ZXJcIiBdO1xuXHRcdH1cblx0XHRwb3NbIDAgXSA9IHJob3Jpem9udGFsLnRlc3QoIHBvc1sgMCBdICkgPyBwb3NbIDAgXSA6IFwiY2VudGVyXCI7XG5cdFx0cG9zWyAxIF0gPSBydmVydGljYWwudGVzdCggcG9zWyAxIF0gKSA/IHBvc1sgMSBdIDogXCJjZW50ZXJcIjtcblxuXHRcdC8vIENhbGN1bGF0ZSBvZmZzZXRzXG5cdFx0aG9yaXpvbnRhbE9mZnNldCA9IHJvZmZzZXQuZXhlYyggcG9zWyAwIF0gKTtcblx0XHR2ZXJ0aWNhbE9mZnNldCA9IHJvZmZzZXQuZXhlYyggcG9zWyAxIF0gKTtcblx0XHRvZmZzZXRzWyB0aGlzIF0gPSBbXG5cdFx0XHRob3Jpem9udGFsT2Zmc2V0ID8gaG9yaXpvbnRhbE9mZnNldFsgMCBdIDogMCxcblx0XHRcdHZlcnRpY2FsT2Zmc2V0ID8gdmVydGljYWxPZmZzZXRbIDAgXSA6IDBcblx0XHRdO1xuXG5cdFx0Ly8gUmVkdWNlIHRvIGp1c3QgdGhlIHBvc2l0aW9ucyB3aXRob3V0IHRoZSBvZmZzZXRzXG5cdFx0b3B0aW9uc1sgdGhpcyBdID0gW1xuXHRcdFx0cnBvc2l0aW9uLmV4ZWMoIHBvc1sgMCBdIClbIDAgXSxcblx0XHRcdHJwb3NpdGlvbi5leGVjKCBwb3NbIDEgXSApWyAwIF1cblx0XHRdO1xuXHR9ICk7XG5cblx0Ly8gTm9ybWFsaXplIGNvbGxpc2lvbiBvcHRpb25cblx0aWYgKCBjb2xsaXNpb24ubGVuZ3RoID09PSAxICkge1xuXHRcdGNvbGxpc2lvblsgMSBdID0gY29sbGlzaW9uWyAwIF07XG5cdH1cblxuXHRpZiAoIG9wdGlvbnMuYXRbIDAgXSA9PT0gXCJyaWdodFwiICkge1xuXHRcdGJhc2VQb3NpdGlvbi5sZWZ0ICs9IHRhcmdldFdpZHRoO1xuXHR9IGVsc2UgaWYgKCBvcHRpb25zLmF0WyAwIF0gPT09IFwiY2VudGVyXCIgKSB7XG5cdFx0YmFzZVBvc2l0aW9uLmxlZnQgKz0gdGFyZ2V0V2lkdGggLyAyO1xuXHR9XG5cblx0aWYgKCBvcHRpb25zLmF0WyAxIF0gPT09IFwiYm90dG9tXCIgKSB7XG5cdFx0YmFzZVBvc2l0aW9uLnRvcCArPSB0YXJnZXRIZWlnaHQ7XG5cdH0gZWxzZSBpZiAoIG9wdGlvbnMuYXRbIDEgXSA9PT0gXCJjZW50ZXJcIiApIHtcblx0XHRiYXNlUG9zaXRpb24udG9wICs9IHRhcmdldEhlaWdodCAvIDI7XG5cdH1cblxuXHRhdE9mZnNldCA9IGdldE9mZnNldHMoIG9mZnNldHMuYXQsIHRhcmdldFdpZHRoLCB0YXJnZXRIZWlnaHQgKTtcblx0YmFzZVBvc2l0aW9uLmxlZnQgKz0gYXRPZmZzZXRbIDAgXTtcblx0YmFzZVBvc2l0aW9uLnRvcCArPSBhdE9mZnNldFsgMSBdO1xuXG5cdHJldHVybiB0aGlzLmVhY2goIGZ1bmN0aW9uKCkge1xuXHRcdHZhciBjb2xsaXNpb25Qb3NpdGlvbiwgdXNpbmcsXG5cdFx0XHRlbGVtID0gJCggdGhpcyApLFxuXHRcdFx0ZWxlbVdpZHRoID0gZWxlbS5vdXRlcldpZHRoKCksXG5cdFx0XHRlbGVtSGVpZ2h0ID0gZWxlbS5vdXRlckhlaWdodCgpLFxuXHRcdFx0bWFyZ2luTGVmdCA9IHBhcnNlQ3NzKCB0aGlzLCBcIm1hcmdpbkxlZnRcIiApLFxuXHRcdFx0bWFyZ2luVG9wID0gcGFyc2VDc3MoIHRoaXMsIFwibWFyZ2luVG9wXCIgKSxcblx0XHRcdGNvbGxpc2lvbldpZHRoID0gZWxlbVdpZHRoICsgbWFyZ2luTGVmdCArIHBhcnNlQ3NzKCB0aGlzLCBcIm1hcmdpblJpZ2h0XCIgKSArXG5cdFx0XHRcdHNjcm9sbEluZm8ud2lkdGgsXG5cdFx0XHRjb2xsaXNpb25IZWlnaHQgPSBlbGVtSGVpZ2h0ICsgbWFyZ2luVG9wICsgcGFyc2VDc3MoIHRoaXMsIFwibWFyZ2luQm90dG9tXCIgKSArXG5cdFx0XHRcdHNjcm9sbEluZm8uaGVpZ2h0LFxuXHRcdFx0cG9zaXRpb24gPSAkLmV4dGVuZCgge30sIGJhc2VQb3NpdGlvbiApLFxuXHRcdFx0bXlPZmZzZXQgPSBnZXRPZmZzZXRzKCBvZmZzZXRzLm15LCBlbGVtLm91dGVyV2lkdGgoKSwgZWxlbS5vdXRlckhlaWdodCgpICk7XG5cblx0XHRpZiAoIG9wdGlvbnMubXlbIDAgXSA9PT0gXCJyaWdodFwiICkge1xuXHRcdFx0cG9zaXRpb24ubGVmdCAtPSBlbGVtV2lkdGg7XG5cdFx0fSBlbHNlIGlmICggb3B0aW9ucy5teVsgMCBdID09PSBcImNlbnRlclwiICkge1xuXHRcdFx0cG9zaXRpb24ubGVmdCAtPSBlbGVtV2lkdGggLyAyO1xuXHRcdH1cblxuXHRcdGlmICggb3B0aW9ucy5teVsgMSBdID09PSBcImJvdHRvbVwiICkge1xuXHRcdFx0cG9zaXRpb24udG9wIC09IGVsZW1IZWlnaHQ7XG5cdFx0fSBlbHNlIGlmICggb3B0aW9ucy5teVsgMSBdID09PSBcImNlbnRlclwiICkge1xuXHRcdFx0cG9zaXRpb24udG9wIC09IGVsZW1IZWlnaHQgLyAyO1xuXHRcdH1cblxuXHRcdHBvc2l0aW9uLmxlZnQgKz0gbXlPZmZzZXRbIDAgXTtcblx0XHRwb3NpdGlvbi50b3AgKz0gbXlPZmZzZXRbIDEgXTtcblxuXHRcdGNvbGxpc2lvblBvc2l0aW9uID0ge1xuXHRcdFx0bWFyZ2luTGVmdDogbWFyZ2luTGVmdCxcblx0XHRcdG1hcmdpblRvcDogbWFyZ2luVG9wXG5cdFx0fTtcblxuXHRcdCQuZWFjaCggWyBcImxlZnRcIiwgXCJ0b3BcIiBdLCBmdW5jdGlvbiggaSwgZGlyICkge1xuXHRcdFx0aWYgKCAkLnVpLnBvc2l0aW9uWyBjb2xsaXNpb25bIGkgXSBdICkge1xuXHRcdFx0XHQkLnVpLnBvc2l0aW9uWyBjb2xsaXNpb25bIGkgXSBdWyBkaXIgXSggcG9zaXRpb24sIHtcblx0XHRcdFx0XHR0YXJnZXRXaWR0aDogdGFyZ2V0V2lkdGgsXG5cdFx0XHRcdFx0dGFyZ2V0SGVpZ2h0OiB0YXJnZXRIZWlnaHQsXG5cdFx0XHRcdFx0ZWxlbVdpZHRoOiBlbGVtV2lkdGgsXG5cdFx0XHRcdFx0ZWxlbUhlaWdodDogZWxlbUhlaWdodCxcblx0XHRcdFx0XHRjb2xsaXNpb25Qb3NpdGlvbjogY29sbGlzaW9uUG9zaXRpb24sXG5cdFx0XHRcdFx0Y29sbGlzaW9uV2lkdGg6IGNvbGxpc2lvbldpZHRoLFxuXHRcdFx0XHRcdGNvbGxpc2lvbkhlaWdodDogY29sbGlzaW9uSGVpZ2h0LFxuXHRcdFx0XHRcdG9mZnNldDogWyBhdE9mZnNldFsgMCBdICsgbXlPZmZzZXRbIDAgXSwgYXRPZmZzZXQgWyAxIF0gKyBteU9mZnNldFsgMSBdIF0sXG5cdFx0XHRcdFx0bXk6IG9wdGlvbnMubXksXG5cdFx0XHRcdFx0YXQ6IG9wdGlvbnMuYXQsXG5cdFx0XHRcdFx0d2l0aGluOiB3aXRoaW4sXG5cdFx0XHRcdFx0ZWxlbTogZWxlbVxuXHRcdFx0XHR9ICk7XG5cdFx0XHR9XG5cdFx0fSApO1xuXG5cdFx0aWYgKCBvcHRpb25zLnVzaW5nICkge1xuXG5cdFx0XHQvLyBBZGRzIGZlZWRiYWNrIGFzIHNlY29uZCBhcmd1bWVudCB0byB1c2luZyBjYWxsYmFjaywgaWYgcHJlc2VudFxuXHRcdFx0dXNpbmcgPSBmdW5jdGlvbiggcHJvcHMgKSB7XG5cdFx0XHRcdHZhciBsZWZ0ID0gdGFyZ2V0T2Zmc2V0LmxlZnQgLSBwb3NpdGlvbi5sZWZ0LFxuXHRcdFx0XHRcdHJpZ2h0ID0gbGVmdCArIHRhcmdldFdpZHRoIC0gZWxlbVdpZHRoLFxuXHRcdFx0XHRcdHRvcCA9IHRhcmdldE9mZnNldC50b3AgLSBwb3NpdGlvbi50b3AsXG5cdFx0XHRcdFx0Ym90dG9tID0gdG9wICsgdGFyZ2V0SGVpZ2h0IC0gZWxlbUhlaWdodCxcblx0XHRcdFx0XHRmZWVkYmFjayA9IHtcblx0XHRcdFx0XHRcdHRhcmdldDoge1xuXHRcdFx0XHRcdFx0XHRlbGVtZW50OiB0YXJnZXQsXG5cdFx0XHRcdFx0XHRcdGxlZnQ6IHRhcmdldE9mZnNldC5sZWZ0LFxuXHRcdFx0XHRcdFx0XHR0b3A6IHRhcmdldE9mZnNldC50b3AsXG5cdFx0XHRcdFx0XHRcdHdpZHRoOiB0YXJnZXRXaWR0aCxcblx0XHRcdFx0XHRcdFx0aGVpZ2h0OiB0YXJnZXRIZWlnaHRcblx0XHRcdFx0XHRcdH0sXG5cdFx0XHRcdFx0XHRlbGVtZW50OiB7XG5cdFx0XHRcdFx0XHRcdGVsZW1lbnQ6IGVsZW0sXG5cdFx0XHRcdFx0XHRcdGxlZnQ6IHBvc2l0aW9uLmxlZnQsXG5cdFx0XHRcdFx0XHRcdHRvcDogcG9zaXRpb24udG9wLFxuXHRcdFx0XHRcdFx0XHR3aWR0aDogZWxlbVdpZHRoLFxuXHRcdFx0XHRcdFx0XHRoZWlnaHQ6IGVsZW1IZWlnaHRcblx0XHRcdFx0XHRcdH0sXG5cdFx0XHRcdFx0XHRob3Jpem9udGFsOiByaWdodCA8IDAgPyBcImxlZnRcIiA6IGxlZnQgPiAwID8gXCJyaWdodFwiIDogXCJjZW50ZXJcIixcblx0XHRcdFx0XHRcdHZlcnRpY2FsOiBib3R0b20gPCAwID8gXCJ0b3BcIiA6IHRvcCA+IDAgPyBcImJvdHRvbVwiIDogXCJtaWRkbGVcIlxuXHRcdFx0XHRcdH07XG5cdFx0XHRcdGlmICggdGFyZ2V0V2lkdGggPCBlbGVtV2lkdGggJiYgYWJzKCBsZWZ0ICsgcmlnaHQgKSA8IHRhcmdldFdpZHRoICkge1xuXHRcdFx0XHRcdGZlZWRiYWNrLmhvcml6b250YWwgPSBcImNlbnRlclwiO1xuXHRcdFx0XHR9XG5cdFx0XHRcdGlmICggdGFyZ2V0SGVpZ2h0IDwgZWxlbUhlaWdodCAmJiBhYnMoIHRvcCArIGJvdHRvbSApIDwgdGFyZ2V0SGVpZ2h0ICkge1xuXHRcdFx0XHRcdGZlZWRiYWNrLnZlcnRpY2FsID0gXCJtaWRkbGVcIjtcblx0XHRcdFx0fVxuXHRcdFx0XHRpZiAoIG1heCggYWJzKCBsZWZ0ICksIGFicyggcmlnaHQgKSApID4gbWF4KCBhYnMoIHRvcCApLCBhYnMoIGJvdHRvbSApICkgKSB7XG5cdFx0XHRcdFx0ZmVlZGJhY2suaW1wb3J0YW50ID0gXCJob3Jpem9udGFsXCI7XG5cdFx0XHRcdH0gZWxzZSB7XG5cdFx0XHRcdFx0ZmVlZGJhY2suaW1wb3J0YW50ID0gXCJ2ZXJ0aWNhbFwiO1xuXHRcdFx0XHR9XG5cdFx0XHRcdG9wdGlvbnMudXNpbmcuY2FsbCggdGhpcywgcHJvcHMsIGZlZWRiYWNrICk7XG5cdFx0XHR9O1xuXHRcdH1cblxuXHRcdGVsZW0ub2Zmc2V0KCAkLmV4dGVuZCggcG9zaXRpb24sIHsgdXNpbmc6IHVzaW5nIH0gKSApO1xuXHR9ICk7XG59O1xuXG4kLnVpLnBvc2l0aW9uID0ge1xuXHRmaXQ6IHtcblx0XHRsZWZ0OiBmdW5jdGlvbiggcG9zaXRpb24sIGRhdGEgKSB7XG5cdFx0XHR2YXIgd2l0aGluID0gZGF0YS53aXRoaW4sXG5cdFx0XHRcdHdpdGhpbk9mZnNldCA9IHdpdGhpbi5pc1dpbmRvdyA/IHdpdGhpbi5zY3JvbGxMZWZ0IDogd2l0aGluLm9mZnNldC5sZWZ0LFxuXHRcdFx0XHRvdXRlcldpZHRoID0gd2l0aGluLndpZHRoLFxuXHRcdFx0XHRjb2xsaXNpb25Qb3NMZWZ0ID0gcG9zaXRpb24ubGVmdCAtIGRhdGEuY29sbGlzaW9uUG9zaXRpb24ubWFyZ2luTGVmdCxcblx0XHRcdFx0b3ZlckxlZnQgPSB3aXRoaW5PZmZzZXQgLSBjb2xsaXNpb25Qb3NMZWZ0LFxuXHRcdFx0XHRvdmVyUmlnaHQgPSBjb2xsaXNpb25Qb3NMZWZ0ICsgZGF0YS5jb2xsaXNpb25XaWR0aCAtIG91dGVyV2lkdGggLSB3aXRoaW5PZmZzZXQsXG5cdFx0XHRcdG5ld092ZXJSaWdodDtcblxuXHRcdFx0Ly8gRWxlbWVudCBpcyB3aWRlciB0aGFuIHdpdGhpblxuXHRcdFx0aWYgKCBkYXRhLmNvbGxpc2lvbldpZHRoID4gb3V0ZXJXaWR0aCApIHtcblxuXHRcdFx0XHQvLyBFbGVtZW50IGlzIGluaXRpYWxseSBvdmVyIHRoZSBsZWZ0IHNpZGUgb2Ygd2l0aGluXG5cdFx0XHRcdGlmICggb3ZlckxlZnQgPiAwICYmIG92ZXJSaWdodCA8PSAwICkge1xuXHRcdFx0XHRcdG5ld092ZXJSaWdodCA9IHBvc2l0aW9uLmxlZnQgKyBvdmVyTGVmdCArIGRhdGEuY29sbGlzaW9uV2lkdGggLSBvdXRlcldpZHRoIC1cblx0XHRcdFx0XHRcdHdpdGhpbk9mZnNldDtcblx0XHRcdFx0XHRwb3NpdGlvbi5sZWZ0ICs9IG92ZXJMZWZ0IC0gbmV3T3ZlclJpZ2h0O1xuXG5cdFx0XHRcdC8vIEVsZW1lbnQgaXMgaW5pdGlhbGx5IG92ZXIgcmlnaHQgc2lkZSBvZiB3aXRoaW5cblx0XHRcdFx0fSBlbHNlIGlmICggb3ZlclJpZ2h0ID4gMCAmJiBvdmVyTGVmdCA8PSAwICkge1xuXHRcdFx0XHRcdHBvc2l0aW9uLmxlZnQgPSB3aXRoaW5PZmZzZXQ7XG5cblx0XHRcdFx0Ly8gRWxlbWVudCBpcyBpbml0aWFsbHkgb3ZlciBib3RoIGxlZnQgYW5kIHJpZ2h0IHNpZGVzIG9mIHdpdGhpblxuXHRcdFx0XHR9IGVsc2Uge1xuXHRcdFx0XHRcdGlmICggb3ZlckxlZnQgPiBvdmVyUmlnaHQgKSB7XG5cdFx0XHRcdFx0XHRwb3NpdGlvbi5sZWZ0ID0gd2l0aGluT2Zmc2V0ICsgb3V0ZXJXaWR0aCAtIGRhdGEuY29sbGlzaW9uV2lkdGg7XG5cdFx0XHRcdFx0fSBlbHNlIHtcblx0XHRcdFx0XHRcdHBvc2l0aW9uLmxlZnQgPSB3aXRoaW5PZmZzZXQ7XG5cdFx0XHRcdFx0fVxuXHRcdFx0XHR9XG5cblx0XHRcdC8vIFRvbyBmYXIgbGVmdCAtPiBhbGlnbiB3aXRoIGxlZnQgZWRnZVxuXHRcdFx0fSBlbHNlIGlmICggb3ZlckxlZnQgPiAwICkge1xuXHRcdFx0XHRwb3NpdGlvbi5sZWZ0ICs9IG92ZXJMZWZ0O1xuXG5cdFx0XHQvLyBUb28gZmFyIHJpZ2h0IC0+IGFsaWduIHdpdGggcmlnaHQgZWRnZVxuXHRcdFx0fSBlbHNlIGlmICggb3ZlclJpZ2h0ID4gMCApIHtcblx0XHRcdFx0cG9zaXRpb24ubGVmdCAtPSBvdmVyUmlnaHQ7XG5cblx0XHRcdC8vIEFkanVzdCBiYXNlZCBvbiBwb3NpdGlvbiBhbmQgbWFyZ2luXG5cdFx0XHR9IGVsc2Uge1xuXHRcdFx0XHRwb3NpdGlvbi5sZWZ0ID0gbWF4KCBwb3NpdGlvbi5sZWZ0IC0gY29sbGlzaW9uUG9zTGVmdCwgcG9zaXRpb24ubGVmdCApO1xuXHRcdFx0fVxuXHRcdH0sXG5cdFx0dG9wOiBmdW5jdGlvbiggcG9zaXRpb24sIGRhdGEgKSB7XG5cdFx0XHR2YXIgd2l0aGluID0gZGF0YS53aXRoaW4sXG5cdFx0XHRcdHdpdGhpbk9mZnNldCA9IHdpdGhpbi5pc1dpbmRvdyA/IHdpdGhpbi5zY3JvbGxUb3AgOiB3aXRoaW4ub2Zmc2V0LnRvcCxcblx0XHRcdFx0b3V0ZXJIZWlnaHQgPSBkYXRhLndpdGhpbi5oZWlnaHQsXG5cdFx0XHRcdGNvbGxpc2lvblBvc1RvcCA9IHBvc2l0aW9uLnRvcCAtIGRhdGEuY29sbGlzaW9uUG9zaXRpb24ubWFyZ2luVG9wLFxuXHRcdFx0XHRvdmVyVG9wID0gd2l0aGluT2Zmc2V0IC0gY29sbGlzaW9uUG9zVG9wLFxuXHRcdFx0XHRvdmVyQm90dG9tID0gY29sbGlzaW9uUG9zVG9wICsgZGF0YS5jb2xsaXNpb25IZWlnaHQgLSBvdXRlckhlaWdodCAtIHdpdGhpbk9mZnNldCxcblx0XHRcdFx0bmV3T3ZlckJvdHRvbTtcblxuXHRcdFx0Ly8gRWxlbWVudCBpcyB0YWxsZXIgdGhhbiB3aXRoaW5cblx0XHRcdGlmICggZGF0YS5jb2xsaXNpb25IZWlnaHQgPiBvdXRlckhlaWdodCApIHtcblxuXHRcdFx0XHQvLyBFbGVtZW50IGlzIGluaXRpYWxseSBvdmVyIHRoZSB0b3Agb2Ygd2l0aGluXG5cdFx0XHRcdGlmICggb3ZlclRvcCA+IDAgJiYgb3ZlckJvdHRvbSA8PSAwICkge1xuXHRcdFx0XHRcdG5ld092ZXJCb3R0b20gPSBwb3NpdGlvbi50b3AgKyBvdmVyVG9wICsgZGF0YS5jb2xsaXNpb25IZWlnaHQgLSBvdXRlckhlaWdodCAtXG5cdFx0XHRcdFx0XHR3aXRoaW5PZmZzZXQ7XG5cdFx0XHRcdFx0cG9zaXRpb24udG9wICs9IG92ZXJUb3AgLSBuZXdPdmVyQm90dG9tO1xuXG5cdFx0XHRcdC8vIEVsZW1lbnQgaXMgaW5pdGlhbGx5IG92ZXIgYm90dG9tIG9mIHdpdGhpblxuXHRcdFx0XHR9IGVsc2UgaWYgKCBvdmVyQm90dG9tID4gMCAmJiBvdmVyVG9wIDw9IDAgKSB7XG5cdFx0XHRcdFx0cG9zaXRpb24udG9wID0gd2l0aGluT2Zmc2V0O1xuXG5cdFx0XHRcdC8vIEVsZW1lbnQgaXMgaW5pdGlhbGx5IG92ZXIgYm90aCB0b3AgYW5kIGJvdHRvbSBvZiB3aXRoaW5cblx0XHRcdFx0fSBlbHNlIHtcblx0XHRcdFx0XHRpZiAoIG92ZXJUb3AgPiBvdmVyQm90dG9tICkge1xuXHRcdFx0XHRcdFx0cG9zaXRpb24udG9wID0gd2l0aGluT2Zmc2V0ICsgb3V0ZXJIZWlnaHQgLSBkYXRhLmNvbGxpc2lvbkhlaWdodDtcblx0XHRcdFx0XHR9IGVsc2Uge1xuXHRcdFx0XHRcdFx0cG9zaXRpb24udG9wID0gd2l0aGluT2Zmc2V0O1xuXHRcdFx0XHRcdH1cblx0XHRcdFx0fVxuXG5cdFx0XHQvLyBUb28gZmFyIHVwIC0+IGFsaWduIHdpdGggdG9wXG5cdFx0XHR9IGVsc2UgaWYgKCBvdmVyVG9wID4gMCApIHtcblx0XHRcdFx0cG9zaXRpb24udG9wICs9IG92ZXJUb3A7XG5cblx0XHRcdC8vIFRvbyBmYXIgZG93biAtPiBhbGlnbiB3aXRoIGJvdHRvbSBlZGdlXG5cdFx0XHR9IGVsc2UgaWYgKCBvdmVyQm90dG9tID4gMCApIHtcblx0XHRcdFx0cG9zaXRpb24udG9wIC09IG92ZXJCb3R0b207XG5cblx0XHRcdC8vIEFkanVzdCBiYXNlZCBvbiBwb3NpdGlvbiBhbmQgbWFyZ2luXG5cdFx0XHR9IGVsc2Uge1xuXHRcdFx0XHRwb3NpdGlvbi50b3AgPSBtYXgoIHBvc2l0aW9uLnRvcCAtIGNvbGxpc2lvblBvc1RvcCwgcG9zaXRpb24udG9wICk7XG5cdFx0XHR9XG5cdFx0fVxuXHR9LFxuXHRmbGlwOiB7XG5cdFx0bGVmdDogZnVuY3Rpb24oIHBvc2l0aW9uLCBkYXRhICkge1xuXHRcdFx0dmFyIHdpdGhpbiA9IGRhdGEud2l0aGluLFxuXHRcdFx0XHR3aXRoaW5PZmZzZXQgPSB3aXRoaW4ub2Zmc2V0LmxlZnQgKyB3aXRoaW4uc2Nyb2xsTGVmdCxcblx0XHRcdFx0b3V0ZXJXaWR0aCA9IHdpdGhpbi53aWR0aCxcblx0XHRcdFx0b2Zmc2V0TGVmdCA9IHdpdGhpbi5pc1dpbmRvdyA/IHdpdGhpbi5zY3JvbGxMZWZ0IDogd2l0aGluLm9mZnNldC5sZWZ0LFxuXHRcdFx0XHRjb2xsaXNpb25Qb3NMZWZ0ID0gcG9zaXRpb24ubGVmdCAtIGRhdGEuY29sbGlzaW9uUG9zaXRpb24ubWFyZ2luTGVmdCxcblx0XHRcdFx0b3ZlckxlZnQgPSBjb2xsaXNpb25Qb3NMZWZ0IC0gb2Zmc2V0TGVmdCxcblx0XHRcdFx0b3ZlclJpZ2h0ID0gY29sbGlzaW9uUG9zTGVmdCArIGRhdGEuY29sbGlzaW9uV2lkdGggLSBvdXRlcldpZHRoIC0gb2Zmc2V0TGVmdCxcblx0XHRcdFx0bXlPZmZzZXQgPSBkYXRhLm15WyAwIF0gPT09IFwibGVmdFwiID9cblx0XHRcdFx0XHQtZGF0YS5lbGVtV2lkdGggOlxuXHRcdFx0XHRcdGRhdGEubXlbIDAgXSA9PT0gXCJyaWdodFwiID9cblx0XHRcdFx0XHRcdGRhdGEuZWxlbVdpZHRoIDpcblx0XHRcdFx0XHRcdDAsXG5cdFx0XHRcdGF0T2Zmc2V0ID0gZGF0YS5hdFsgMCBdID09PSBcImxlZnRcIiA/XG5cdFx0XHRcdFx0ZGF0YS50YXJnZXRXaWR0aCA6XG5cdFx0XHRcdFx0ZGF0YS5hdFsgMCBdID09PSBcInJpZ2h0XCIgP1xuXHRcdFx0XHRcdFx0LWRhdGEudGFyZ2V0V2lkdGggOlxuXHRcdFx0XHRcdFx0MCxcblx0XHRcdFx0b2Zmc2V0ID0gLTIgKiBkYXRhLm9mZnNldFsgMCBdLFxuXHRcdFx0XHRuZXdPdmVyUmlnaHQsXG5cdFx0XHRcdG5ld092ZXJMZWZ0O1xuXG5cdFx0XHRpZiAoIG92ZXJMZWZ0IDwgMCApIHtcblx0XHRcdFx0bmV3T3ZlclJpZ2h0ID0gcG9zaXRpb24ubGVmdCArIG15T2Zmc2V0ICsgYXRPZmZzZXQgKyBvZmZzZXQgKyBkYXRhLmNvbGxpc2lvbldpZHRoIC1cblx0XHRcdFx0XHRvdXRlcldpZHRoIC0gd2l0aGluT2Zmc2V0O1xuXHRcdFx0XHRpZiAoIG5ld092ZXJSaWdodCA8IDAgfHwgbmV3T3ZlclJpZ2h0IDwgYWJzKCBvdmVyTGVmdCApICkge1xuXHRcdFx0XHRcdHBvc2l0aW9uLmxlZnQgKz0gbXlPZmZzZXQgKyBhdE9mZnNldCArIG9mZnNldDtcblx0XHRcdFx0fVxuXHRcdFx0fSBlbHNlIGlmICggb3ZlclJpZ2h0ID4gMCApIHtcblx0XHRcdFx0bmV3T3ZlckxlZnQgPSBwb3NpdGlvbi5sZWZ0IC0gZGF0YS5jb2xsaXNpb25Qb3NpdGlvbi5tYXJnaW5MZWZ0ICsgbXlPZmZzZXQgK1xuXHRcdFx0XHRcdGF0T2Zmc2V0ICsgb2Zmc2V0IC0gb2Zmc2V0TGVmdDtcblx0XHRcdFx0aWYgKCBuZXdPdmVyTGVmdCA+IDAgfHwgYWJzKCBuZXdPdmVyTGVmdCApIDwgb3ZlclJpZ2h0ICkge1xuXHRcdFx0XHRcdHBvc2l0aW9uLmxlZnQgKz0gbXlPZmZzZXQgKyBhdE9mZnNldCArIG9mZnNldDtcblx0XHRcdFx0fVxuXHRcdFx0fVxuXHRcdH0sXG5cdFx0dG9wOiBmdW5jdGlvbiggcG9zaXRpb24sIGRhdGEgKSB7XG5cdFx0XHR2YXIgd2l0aGluID0gZGF0YS53aXRoaW4sXG5cdFx0XHRcdHdpdGhpbk9mZnNldCA9IHdpdGhpbi5vZmZzZXQudG9wICsgd2l0aGluLnNjcm9sbFRvcCxcblx0XHRcdFx0b3V0ZXJIZWlnaHQgPSB3aXRoaW4uaGVpZ2h0LFxuXHRcdFx0XHRvZmZzZXRUb3AgPSB3aXRoaW4uaXNXaW5kb3cgPyB3aXRoaW4uc2Nyb2xsVG9wIDogd2l0aGluLm9mZnNldC50b3AsXG5cdFx0XHRcdGNvbGxpc2lvblBvc1RvcCA9IHBvc2l0aW9uLnRvcCAtIGRhdGEuY29sbGlzaW9uUG9zaXRpb24ubWFyZ2luVG9wLFxuXHRcdFx0XHRvdmVyVG9wID0gY29sbGlzaW9uUG9zVG9wIC0gb2Zmc2V0VG9wLFxuXHRcdFx0XHRvdmVyQm90dG9tID0gY29sbGlzaW9uUG9zVG9wICsgZGF0YS5jb2xsaXNpb25IZWlnaHQgLSBvdXRlckhlaWdodCAtIG9mZnNldFRvcCxcblx0XHRcdFx0dG9wID0gZGF0YS5teVsgMSBdID09PSBcInRvcFwiLFxuXHRcdFx0XHRteU9mZnNldCA9IHRvcCA/XG5cdFx0XHRcdFx0LWRhdGEuZWxlbUhlaWdodCA6XG5cdFx0XHRcdFx0ZGF0YS5teVsgMSBdID09PSBcImJvdHRvbVwiID9cblx0XHRcdFx0XHRcdGRhdGEuZWxlbUhlaWdodCA6XG5cdFx0XHRcdFx0XHQwLFxuXHRcdFx0XHRhdE9mZnNldCA9IGRhdGEuYXRbIDEgXSA9PT0gXCJ0b3BcIiA/XG5cdFx0XHRcdFx0ZGF0YS50YXJnZXRIZWlnaHQgOlxuXHRcdFx0XHRcdGRhdGEuYXRbIDEgXSA9PT0gXCJib3R0b21cIiA/XG5cdFx0XHRcdFx0XHQtZGF0YS50YXJnZXRIZWlnaHQgOlxuXHRcdFx0XHRcdFx0MCxcblx0XHRcdFx0b2Zmc2V0ID0gLTIgKiBkYXRhLm9mZnNldFsgMSBdLFxuXHRcdFx0XHRuZXdPdmVyVG9wLFxuXHRcdFx0XHRuZXdPdmVyQm90dG9tO1xuXHRcdFx0aWYgKCBvdmVyVG9wIDwgMCApIHtcblx0XHRcdFx0bmV3T3ZlckJvdHRvbSA9IHBvc2l0aW9uLnRvcCArIG15T2Zmc2V0ICsgYXRPZmZzZXQgKyBvZmZzZXQgKyBkYXRhLmNvbGxpc2lvbkhlaWdodCAtXG5cdFx0XHRcdFx0b3V0ZXJIZWlnaHQgLSB3aXRoaW5PZmZzZXQ7XG5cdFx0XHRcdGlmICggbmV3T3ZlckJvdHRvbSA8IDAgfHwgbmV3T3ZlckJvdHRvbSA8IGFicyggb3ZlclRvcCApICkge1xuXHRcdFx0XHRcdHBvc2l0aW9uLnRvcCArPSBteU9mZnNldCArIGF0T2Zmc2V0ICsgb2Zmc2V0O1xuXHRcdFx0XHR9XG5cdFx0XHR9IGVsc2UgaWYgKCBvdmVyQm90dG9tID4gMCApIHtcblx0XHRcdFx0bmV3T3ZlclRvcCA9IHBvc2l0aW9uLnRvcCAtIGRhdGEuY29sbGlzaW9uUG9zaXRpb24ubWFyZ2luVG9wICsgbXlPZmZzZXQgKyBhdE9mZnNldCArXG5cdFx0XHRcdFx0b2Zmc2V0IC0gb2Zmc2V0VG9wO1xuXHRcdFx0XHRpZiAoIG5ld092ZXJUb3AgPiAwIHx8IGFicyggbmV3T3ZlclRvcCApIDwgb3ZlckJvdHRvbSApIHtcblx0XHRcdFx0XHRwb3NpdGlvbi50b3AgKz0gbXlPZmZzZXQgKyBhdE9mZnNldCArIG9mZnNldDtcblx0XHRcdFx0fVxuXHRcdFx0fVxuXHRcdH1cblx0fSxcblx0ZmxpcGZpdDoge1xuXHRcdGxlZnQ6IGZ1bmN0aW9uKCkge1xuXHRcdFx0JC51aS5wb3NpdGlvbi5mbGlwLmxlZnQuYXBwbHkoIHRoaXMsIGFyZ3VtZW50cyApO1xuXHRcdFx0JC51aS5wb3NpdGlvbi5maXQubGVmdC5hcHBseSggdGhpcywgYXJndW1lbnRzICk7XG5cdFx0fSxcblx0XHR0b3A6IGZ1bmN0aW9uKCkge1xuXHRcdFx0JC51aS5wb3NpdGlvbi5mbGlwLnRvcC5hcHBseSggdGhpcywgYXJndW1lbnRzICk7XG5cdFx0XHQkLnVpLnBvc2l0aW9uLmZpdC50b3AuYXBwbHkoIHRoaXMsIGFyZ3VtZW50cyApO1xuXHRcdH1cblx0fVxufTtcblxufSApKCk7XG5cbnJldHVybiAkLnVpLnBvc2l0aW9uO1xuXG59ICkgKTtcbiIsIiggZnVuY3Rpb24oIGZhY3RvcnkgKSB7XG5cdGlmICggdHlwZW9mIGRlZmluZSA9PT0gXCJmdW5jdGlvblwiICYmIGRlZmluZS5hbWQgKSB7XG5cblx0XHQvLyBBTUQuIFJlZ2lzdGVyIGFzIGFuIGFub255bW91cyBtb2R1bGUuXG5cdFx0ZGVmaW5lKCBbIFwianF1ZXJ5XCIsIFwiLi92ZXJzaW9uXCIgXSwgZmFjdG9yeSApO1xuXHR9IGVsc2Uge1xuXG5cdFx0Ly8gQnJvd3NlciBnbG9iYWxzXG5cdFx0ZmFjdG9yeSggalF1ZXJ5ICk7XG5cdH1cbn0gKCBmdW5jdGlvbiggJCApIHtcbnJldHVybiAkLnVpLnNhZmVBY3RpdmVFbGVtZW50ID0gZnVuY3Rpb24oIGRvY3VtZW50ICkge1xuXHR2YXIgYWN0aXZlRWxlbWVudDtcblxuXHQvLyBTdXBwb3J0OiBJRSA5IG9ubHlcblx0Ly8gSUU5IHRocm93cyBhbiBcIlVuc3BlY2lmaWVkIGVycm9yXCIgYWNjZXNzaW5nIGRvY3VtZW50LmFjdGl2ZUVsZW1lbnQgZnJvbSBhbiA8aWZyYW1lPlxuXHR0cnkge1xuXHRcdGFjdGl2ZUVsZW1lbnQgPSBkb2N1bWVudC5hY3RpdmVFbGVtZW50O1xuXHR9IGNhdGNoICggZXJyb3IgKSB7XG5cdFx0YWN0aXZlRWxlbWVudCA9IGRvY3VtZW50LmJvZHk7XG5cdH1cblxuXHQvLyBTdXBwb3J0OiBJRSA5IC0gMTEgb25seVxuXHQvLyBJRSBtYXkgcmV0dXJuIG51bGwgaW5zdGVhZCBvZiBhbiBlbGVtZW50XG5cdC8vIEludGVyZXN0aW5nbHksIHRoaXMgb25seSBzZWVtcyB0byBvY2N1ciB3aGVuIE5PVCBpbiBhbiBpZnJhbWVcblx0aWYgKCAhYWN0aXZlRWxlbWVudCApIHtcblx0XHRhY3RpdmVFbGVtZW50ID0gZG9jdW1lbnQuYm9keTtcblx0fVxuXG5cdC8vIFN1cHBvcnQ6IElFIDExIG9ubHlcblx0Ly8gSUUxMSByZXR1cm5zIGEgc2VlbWluZ2x5IGVtcHR5IG9iamVjdCBpbiBzb21lIGNhc2VzIHdoZW4gYWNjZXNzaW5nXG5cdC8vIGRvY3VtZW50LmFjdGl2ZUVsZW1lbnQgZnJvbSBhbiA8aWZyYW1lPlxuXHRpZiAoICFhY3RpdmVFbGVtZW50Lm5vZGVOYW1lICkge1xuXHRcdGFjdGl2ZUVsZW1lbnQgPSBkb2N1bWVudC5ib2R5O1xuXHR9XG5cblx0cmV0dXJuIGFjdGl2ZUVsZW1lbnQ7XG59O1xuXG59ICkgKTtcbiIsIiggZnVuY3Rpb24oIGZhY3RvcnkgKSB7XG5cdGlmICggdHlwZW9mIGRlZmluZSA9PT0gXCJmdW5jdGlvblwiICYmIGRlZmluZS5hbWQgKSB7XG5cblx0XHQvLyBBTUQuIFJlZ2lzdGVyIGFzIGFuIGFub255bW91cyBtb2R1bGUuXG5cdFx0ZGVmaW5lKCBbIFwianF1ZXJ5XCIsIFwiLi92ZXJzaW9uXCIgXSwgZmFjdG9yeSApO1xuXHR9IGVsc2Uge1xuXG5cdFx0Ly8gQnJvd3NlciBnbG9iYWxzXG5cdFx0ZmFjdG9yeSggalF1ZXJ5ICk7XG5cdH1cbn0gKCBmdW5jdGlvbiggJCApIHtcbnJldHVybiAkLnVpLnNhZmVCbHVyID0gZnVuY3Rpb24oIGVsZW1lbnQgKSB7XG5cblx0Ly8gU3VwcG9ydDogSUU5IC0gMTAgb25seVxuXHQvLyBJZiB0aGUgPGJvZHk+IGlzIGJsdXJyZWQsIElFIHdpbGwgc3dpdGNoIHdpbmRvd3MsIHNlZSAjOTQyMFxuXHRpZiAoIGVsZW1lbnQgJiYgZWxlbWVudC5ub2RlTmFtZS50b0xvd2VyQ2FzZSgpICE9PSBcImJvZHlcIiApIHtcblx0XHQkKCBlbGVtZW50ICkudHJpZ2dlciggXCJibHVyXCIgKTtcblx0fVxufTtcblxufSApICk7XG4iLCIvKiFcbiAqIGpRdWVyeSBVSSBTY3JvbGwgUGFyZW50IDEuMTIuMVxuICogaHR0cDovL2pxdWVyeXVpLmNvbVxuICpcbiAqIENvcHlyaWdodCBqUXVlcnkgRm91bmRhdGlvbiBhbmQgb3RoZXIgY29udHJpYnV0b3JzXG4gKiBSZWxlYXNlZCB1bmRlciB0aGUgTUlUIGxpY2Vuc2UuXG4gKiBodHRwOi8vanF1ZXJ5Lm9yZy9saWNlbnNlXG4gKi9cblxuLy8+PmxhYmVsOiBzY3JvbGxQYXJlbnRcbi8vPj5ncm91cDogQ29yZVxuLy8+PmRlc2NyaXB0aW9uOiBHZXQgdGhlIGNsb3Nlc3QgYW5jZXN0b3IgZWxlbWVudCB0aGF0IGlzIHNjcm9sbGFibGUuXG4vLz4+ZG9jczogaHR0cDovL2FwaS5qcXVlcnl1aS5jb20vc2Nyb2xsUGFyZW50L1xuXG4oIGZ1bmN0aW9uKCBmYWN0b3J5ICkge1xuXHRpZiAoIHR5cGVvZiBkZWZpbmUgPT09IFwiZnVuY3Rpb25cIiAmJiBkZWZpbmUuYW1kICkge1xuXG5cdFx0Ly8gQU1ELiBSZWdpc3RlciBhcyBhbiBhbm9ueW1vdXMgbW9kdWxlLlxuXHRcdGRlZmluZSggWyBcImpxdWVyeVwiLCBcIi4vdmVyc2lvblwiIF0sIGZhY3RvcnkgKTtcblx0fSBlbHNlIHtcblxuXHRcdC8vIEJyb3dzZXIgZ2xvYmFsc1xuXHRcdGZhY3RvcnkoIGpRdWVyeSApO1xuXHR9XG59ICggZnVuY3Rpb24oICQgKSB7XG5cbnJldHVybiAkLmZuLnNjcm9sbFBhcmVudCA9IGZ1bmN0aW9uKCBpbmNsdWRlSGlkZGVuICkge1xuXHR2YXIgcG9zaXRpb24gPSB0aGlzLmNzcyggXCJwb3NpdGlvblwiICksXG5cdFx0ZXhjbHVkZVN0YXRpY1BhcmVudCA9IHBvc2l0aW9uID09PSBcImFic29sdXRlXCIsXG5cdFx0b3ZlcmZsb3dSZWdleCA9IGluY2x1ZGVIaWRkZW4gPyAvKGF1dG98c2Nyb2xsfGhpZGRlbikvIDogLyhhdXRvfHNjcm9sbCkvLFxuXHRcdHNjcm9sbFBhcmVudCA9IHRoaXMucGFyZW50cygpLmZpbHRlciggZnVuY3Rpb24oKSB7XG5cdFx0XHR2YXIgcGFyZW50ID0gJCggdGhpcyApO1xuXHRcdFx0aWYgKCBleGNsdWRlU3RhdGljUGFyZW50ICYmIHBhcmVudC5jc3MoIFwicG9zaXRpb25cIiApID09PSBcInN0YXRpY1wiICkge1xuXHRcdFx0XHRyZXR1cm4gZmFsc2U7XG5cdFx0XHR9XG5cdFx0XHRyZXR1cm4gb3ZlcmZsb3dSZWdleC50ZXN0KCBwYXJlbnQuY3NzKCBcIm92ZXJmbG93XCIgKSArIHBhcmVudC5jc3MoIFwib3ZlcmZsb3cteVwiICkgK1xuXHRcdFx0XHRwYXJlbnQuY3NzKCBcIm92ZXJmbG93LXhcIiApICk7XG5cdFx0fSApLmVxKCAwICk7XG5cblx0cmV0dXJuIHBvc2l0aW9uID09PSBcImZpeGVkXCIgfHwgIXNjcm9sbFBhcmVudC5sZW5ndGggP1xuXHRcdCQoIHRoaXNbIDAgXS5vd25lckRvY3VtZW50IHx8IGRvY3VtZW50ICkgOlxuXHRcdHNjcm9sbFBhcmVudDtcbn07XG5cbn0gKSApO1xuIiwiLyohXG4gKiBqUXVlcnkgVUkgVGFiYmFibGUgMS4xMi4xXG4gKiBodHRwOi8vanF1ZXJ5dWkuY29tXG4gKlxuICogQ29weXJpZ2h0IGpRdWVyeSBGb3VuZGF0aW9uIGFuZCBvdGhlciBjb250cmlidXRvcnNcbiAqIFJlbGVhc2VkIHVuZGVyIHRoZSBNSVQgbGljZW5zZS5cbiAqIGh0dHA6Ly9qcXVlcnkub3JnL2xpY2Vuc2VcbiAqL1xuXG4vLz4+bGFiZWw6IDp0YWJiYWJsZSBTZWxlY3RvclxuLy8+Pmdyb3VwOiBDb3JlXG4vLz4+ZGVzY3JpcHRpb246IFNlbGVjdHMgZWxlbWVudHMgd2hpY2ggY2FuIGJlIHRhYmJlZCB0by5cbi8vPj5kb2NzOiBodHRwOi8vYXBpLmpxdWVyeXVpLmNvbS90YWJiYWJsZS1zZWxlY3Rvci9cblxuKCBmdW5jdGlvbiggZmFjdG9yeSApIHtcblx0aWYgKCB0eXBlb2YgZGVmaW5lID09PSBcImZ1bmN0aW9uXCIgJiYgZGVmaW5lLmFtZCApIHtcblxuXHRcdC8vIEFNRC4gUmVnaXN0ZXIgYXMgYW4gYW5vbnltb3VzIG1vZHVsZS5cblx0XHRkZWZpbmUoIFsgXCJqcXVlcnlcIiwgXCIuL3ZlcnNpb25cIiwgXCIuL2ZvY3VzYWJsZVwiIF0sIGZhY3RvcnkgKTtcblx0fSBlbHNlIHtcblxuXHRcdC8vIEJyb3dzZXIgZ2xvYmFsc1xuXHRcdGZhY3RvcnkoIGpRdWVyeSApO1xuXHR9XG59ICggZnVuY3Rpb24oICQgKSB7XG5cbnJldHVybiAkLmV4dGVuZCggJC5leHByWyBcIjpcIiBdLCB7XG5cdHRhYmJhYmxlOiBmdW5jdGlvbiggZWxlbWVudCApIHtcblx0XHR2YXIgdGFiSW5kZXggPSAkLmF0dHIoIGVsZW1lbnQsIFwidGFiaW5kZXhcIiApLFxuXHRcdFx0aGFzVGFiaW5kZXggPSB0YWJJbmRleCAhPSBudWxsO1xuXHRcdHJldHVybiAoICFoYXNUYWJpbmRleCB8fCB0YWJJbmRleCA+PSAwICkgJiYgJC51aS5mb2N1c2FibGUoIGVsZW1lbnQsIGhhc1RhYmluZGV4ICk7XG5cdH1cbn0gKTtcblxufSApICk7XG4iLCIvKiFcbiAqIGpRdWVyeSBVSSBVbmlxdWUgSUQgMS4xMi4xXG4gKiBodHRwOi8vanF1ZXJ5dWkuY29tXG4gKlxuICogQ29weXJpZ2h0IGpRdWVyeSBGb3VuZGF0aW9uIGFuZCBvdGhlciBjb250cmlidXRvcnNcbiAqIFJlbGVhc2VkIHVuZGVyIHRoZSBNSVQgbGljZW5zZS5cbiAqIGh0dHA6Ly9qcXVlcnkub3JnL2xpY2Vuc2VcbiAqL1xuXG4vLz4+bGFiZWw6IHVuaXF1ZUlkXG4vLz4+Z3JvdXA6IENvcmVcbi8vPj5kZXNjcmlwdGlvbjogRnVuY3Rpb25zIHRvIGdlbmVyYXRlIGFuZCByZW1vdmUgdW5pcXVlSWQnc1xuLy8+PmRvY3M6IGh0dHA6Ly9hcGkuanF1ZXJ5dWkuY29tL3VuaXF1ZUlkL1xuXG4oIGZ1bmN0aW9uKCBmYWN0b3J5ICkge1xuXHRpZiAoIHR5cGVvZiBkZWZpbmUgPT09IFwiZnVuY3Rpb25cIiAmJiBkZWZpbmUuYW1kICkge1xuXG5cdFx0Ly8gQU1ELiBSZWdpc3RlciBhcyBhbiBhbm9ueW1vdXMgbW9kdWxlLlxuXHRcdGRlZmluZSggWyBcImpxdWVyeVwiLCBcIi4vdmVyc2lvblwiIF0sIGZhY3RvcnkgKTtcblx0fSBlbHNlIHtcblxuXHRcdC8vIEJyb3dzZXIgZ2xvYmFsc1xuXHRcdGZhY3RvcnkoIGpRdWVyeSApO1xuXHR9XG59ICggZnVuY3Rpb24oICQgKSB7XG5cbnJldHVybiAkLmZuLmV4dGVuZCgge1xuXHR1bmlxdWVJZDogKCBmdW5jdGlvbigpIHtcblx0XHR2YXIgdXVpZCA9IDA7XG5cblx0XHRyZXR1cm4gZnVuY3Rpb24oKSB7XG5cdFx0XHRyZXR1cm4gdGhpcy5lYWNoKCBmdW5jdGlvbigpIHtcblx0XHRcdFx0aWYgKCAhdGhpcy5pZCApIHtcblx0XHRcdFx0XHR0aGlzLmlkID0gXCJ1aS1pZC1cIiArICggKyt1dWlkICk7XG5cdFx0XHRcdH1cblx0XHRcdH0gKTtcblx0XHR9O1xuXHR9ICkoKSxcblxuXHRyZW1vdmVVbmlxdWVJZDogZnVuY3Rpb24oKSB7XG5cdFx0cmV0dXJuIHRoaXMuZWFjaCggZnVuY3Rpb24oKSB7XG5cdFx0XHRpZiAoIC9edWktaWQtXFxkKyQvLnRlc3QoIHRoaXMuaWQgKSApIHtcblx0XHRcdFx0JCggdGhpcyApLnJlbW92ZUF0dHIoIFwiaWRcIiApO1xuXHRcdFx0fVxuXHRcdH0gKTtcblx0fVxufSApO1xuXG59ICkgKTtcbiIsIiggZnVuY3Rpb24oIGZhY3RvcnkgKSB7XG5cdGlmICggdHlwZW9mIGRlZmluZSA9PT0gXCJmdW5jdGlvblwiICYmIGRlZmluZS5hbWQgKSB7XG5cblx0XHQvLyBBTUQuIFJlZ2lzdGVyIGFzIGFuIGFub255bW91cyBtb2R1bGUuXG5cdFx0ZGVmaW5lKCBbIFwianF1ZXJ5XCIgXSwgZmFjdG9yeSApO1xuXHR9IGVsc2Uge1xuXG5cdFx0Ly8gQnJvd3NlciBnbG9iYWxzXG5cdFx0ZmFjdG9yeSggalF1ZXJ5ICk7XG5cdH1cbn0gKCBmdW5jdGlvbiggJCApIHtcblxuJC51aSA9ICQudWkgfHwge307XG5cbnJldHVybiAkLnVpLnZlcnNpb24gPSBcIjEuMTIuMVwiO1xuXG59ICkgKTtcbiIsIi8qIVxuICogalF1ZXJ5IFVJIFdpZGdldCAxLjEyLjFcbiAqIGh0dHA6Ly9qcXVlcnl1aS5jb21cbiAqXG4gKiBDb3B5cmlnaHQgalF1ZXJ5IEZvdW5kYXRpb24gYW5kIG90aGVyIGNvbnRyaWJ1dG9yc1xuICogUmVsZWFzZWQgdW5kZXIgdGhlIE1JVCBsaWNlbnNlLlxuICogaHR0cDovL2pxdWVyeS5vcmcvbGljZW5zZVxuICovXG5cbi8vPj5sYWJlbDogV2lkZ2V0XG4vLz4+Z3JvdXA6IENvcmVcbi8vPj5kZXNjcmlwdGlvbjogUHJvdmlkZXMgYSBmYWN0b3J5IGZvciBjcmVhdGluZyBzdGF0ZWZ1bCB3aWRnZXRzIHdpdGggYSBjb21tb24gQVBJLlxuLy8+PmRvY3M6IGh0dHA6Ly9hcGkuanF1ZXJ5dWkuY29tL2pRdWVyeS53aWRnZXQvXG4vLz4+ZGVtb3M6IGh0dHA6Ly9qcXVlcnl1aS5jb20vd2lkZ2V0L1xuXG4oIGZ1bmN0aW9uKCBmYWN0b3J5ICkge1xuXHRpZiAoIHR5cGVvZiBkZWZpbmUgPT09IFwiZnVuY3Rpb25cIiAmJiBkZWZpbmUuYW1kICkge1xuXG5cdFx0Ly8gQU1ELiBSZWdpc3RlciBhcyBhbiBhbm9ueW1vdXMgbW9kdWxlLlxuXHRcdGRlZmluZSggWyBcImpxdWVyeVwiLCBcIi4vdmVyc2lvblwiIF0sIGZhY3RvcnkgKTtcblx0fSBlbHNlIHtcblxuXHRcdC8vIEJyb3dzZXIgZ2xvYmFsc1xuXHRcdGZhY3RvcnkoIGpRdWVyeSApO1xuXHR9XG59KCBmdW5jdGlvbiggJCApIHtcblxudmFyIHdpZGdldFV1aWQgPSAwO1xudmFyIHdpZGdldFNsaWNlID0gQXJyYXkucHJvdG90eXBlLnNsaWNlO1xuXG4kLmNsZWFuRGF0YSA9ICggZnVuY3Rpb24oIG9yaWcgKSB7XG5cdHJldHVybiBmdW5jdGlvbiggZWxlbXMgKSB7XG5cdFx0dmFyIGV2ZW50cywgZWxlbSwgaTtcblx0XHRmb3IgKCBpID0gMDsgKCBlbGVtID0gZWxlbXNbIGkgXSApICE9IG51bGw7IGkrKyApIHtcblx0XHRcdHRyeSB7XG5cblx0XHRcdFx0Ly8gT25seSB0cmlnZ2VyIHJlbW92ZSB3aGVuIG5lY2Vzc2FyeSB0byBzYXZlIHRpbWVcblx0XHRcdFx0ZXZlbnRzID0gJC5fZGF0YSggZWxlbSwgXCJldmVudHNcIiApO1xuXHRcdFx0XHRpZiAoIGV2ZW50cyAmJiBldmVudHMucmVtb3ZlICkge1xuXHRcdFx0XHRcdCQoIGVsZW0gKS50cmlnZ2VySGFuZGxlciggXCJyZW1vdmVcIiApO1xuXHRcdFx0XHR9XG5cblx0XHRcdC8vIEh0dHA6Ly9idWdzLmpxdWVyeS5jb20vdGlja2V0LzgyMzVcblx0XHRcdH0gY2F0Y2ggKCBlICkge31cblx0XHR9XG5cdFx0b3JpZyggZWxlbXMgKTtcblx0fTtcbn0gKSggJC5jbGVhbkRhdGEgKTtcblxuJC53aWRnZXQgPSBmdW5jdGlvbiggbmFtZSwgYmFzZSwgcHJvdG90eXBlICkge1xuXHR2YXIgZXhpc3RpbmdDb25zdHJ1Y3RvciwgY29uc3RydWN0b3IsIGJhc2VQcm90b3R5cGU7XG5cblx0Ly8gUHJveGllZFByb3RvdHlwZSBhbGxvd3MgdGhlIHByb3ZpZGVkIHByb3RvdHlwZSB0byByZW1haW4gdW5tb2RpZmllZFxuXHQvLyBzbyB0aGF0IGl0IGNhbiBiZSB1c2VkIGFzIGEgbWl4aW4gZm9yIG11bHRpcGxlIHdpZGdldHMgKCM4ODc2KVxuXHR2YXIgcHJveGllZFByb3RvdHlwZSA9IHt9O1xuXG5cdHZhciBuYW1lc3BhY2UgPSBuYW1lLnNwbGl0KCBcIi5cIiApWyAwIF07XG5cdG5hbWUgPSBuYW1lLnNwbGl0KCBcIi5cIiApWyAxIF07XG5cdHZhciBmdWxsTmFtZSA9IG5hbWVzcGFjZSArIFwiLVwiICsgbmFtZTtcblxuXHRpZiAoICFwcm90b3R5cGUgKSB7XG5cdFx0cHJvdG90eXBlID0gYmFzZTtcblx0XHRiYXNlID0gJC5XaWRnZXQ7XG5cdH1cblxuXHRpZiAoICQuaXNBcnJheSggcHJvdG90eXBlICkgKSB7XG5cdFx0cHJvdG90eXBlID0gJC5leHRlbmQuYXBwbHkoIG51bGwsIFsge30gXS5jb25jYXQoIHByb3RvdHlwZSApICk7XG5cdH1cblxuXHQvLyBDcmVhdGUgc2VsZWN0b3IgZm9yIHBsdWdpblxuXHQkLmV4cHJbIFwiOlwiIF1bIGZ1bGxOYW1lLnRvTG93ZXJDYXNlKCkgXSA9IGZ1bmN0aW9uKCBlbGVtICkge1xuXHRcdHJldHVybiAhISQuZGF0YSggZWxlbSwgZnVsbE5hbWUgKTtcblx0fTtcblxuXHQkWyBuYW1lc3BhY2UgXSA9ICRbIG5hbWVzcGFjZSBdIHx8IHt9O1xuXHRleGlzdGluZ0NvbnN0cnVjdG9yID0gJFsgbmFtZXNwYWNlIF1bIG5hbWUgXTtcblx0Y29uc3RydWN0b3IgPSAkWyBuYW1lc3BhY2UgXVsgbmFtZSBdID0gZnVuY3Rpb24oIG9wdGlvbnMsIGVsZW1lbnQgKSB7XG5cblx0XHQvLyBBbGxvdyBpbnN0YW50aWF0aW9uIHdpdGhvdXQgXCJuZXdcIiBrZXl3b3JkXG5cdFx0aWYgKCAhdGhpcy5fY3JlYXRlV2lkZ2V0ICkge1xuXHRcdFx0cmV0dXJuIG5ldyBjb25zdHJ1Y3Rvciggb3B0aW9ucywgZWxlbWVudCApO1xuXHRcdH1cblxuXHRcdC8vIEFsbG93IGluc3RhbnRpYXRpb24gd2l0aG91dCBpbml0aWFsaXppbmcgZm9yIHNpbXBsZSBpbmhlcml0YW5jZVxuXHRcdC8vIG11c3QgdXNlIFwibmV3XCIga2V5d29yZCAodGhlIGNvZGUgYWJvdmUgYWx3YXlzIHBhc3NlcyBhcmdzKVxuXHRcdGlmICggYXJndW1lbnRzLmxlbmd0aCApIHtcblx0XHRcdHRoaXMuX2NyZWF0ZVdpZGdldCggb3B0aW9ucywgZWxlbWVudCApO1xuXHRcdH1cblx0fTtcblxuXHQvLyBFeHRlbmQgd2l0aCB0aGUgZXhpc3RpbmcgY29uc3RydWN0b3IgdG8gY2Fycnkgb3ZlciBhbnkgc3RhdGljIHByb3BlcnRpZXNcblx0JC5leHRlbmQoIGNvbnN0cnVjdG9yLCBleGlzdGluZ0NvbnN0cnVjdG9yLCB7XG5cdFx0dmVyc2lvbjogcHJvdG90eXBlLnZlcnNpb24sXG5cblx0XHQvLyBDb3B5IHRoZSBvYmplY3QgdXNlZCB0byBjcmVhdGUgdGhlIHByb3RvdHlwZSBpbiBjYXNlIHdlIG5lZWQgdG9cblx0XHQvLyByZWRlZmluZSB0aGUgd2lkZ2V0IGxhdGVyXG5cdFx0X3Byb3RvOiAkLmV4dGVuZCgge30sIHByb3RvdHlwZSApLFxuXG5cdFx0Ly8gVHJhY2sgd2lkZ2V0cyB0aGF0IGluaGVyaXQgZnJvbSB0aGlzIHdpZGdldCBpbiBjYXNlIHRoaXMgd2lkZ2V0IGlzXG5cdFx0Ly8gcmVkZWZpbmVkIGFmdGVyIGEgd2lkZ2V0IGluaGVyaXRzIGZyb20gaXRcblx0XHRfY2hpbGRDb25zdHJ1Y3RvcnM6IFtdXG5cdH0gKTtcblxuXHRiYXNlUHJvdG90eXBlID0gbmV3IGJhc2UoKTtcblxuXHQvLyBXZSBuZWVkIHRvIG1ha2UgdGhlIG9wdGlvbnMgaGFzaCBhIHByb3BlcnR5IGRpcmVjdGx5IG9uIHRoZSBuZXcgaW5zdGFuY2Vcblx0Ly8gb3RoZXJ3aXNlIHdlJ2xsIG1vZGlmeSB0aGUgb3B0aW9ucyBoYXNoIG9uIHRoZSBwcm90b3R5cGUgdGhhdCB3ZSdyZVxuXHQvLyBpbmhlcml0aW5nIGZyb21cblx0YmFzZVByb3RvdHlwZS5vcHRpb25zID0gJC53aWRnZXQuZXh0ZW5kKCB7fSwgYmFzZVByb3RvdHlwZS5vcHRpb25zICk7XG5cdCQuZWFjaCggcHJvdG90eXBlLCBmdW5jdGlvbiggcHJvcCwgdmFsdWUgKSB7XG5cdFx0aWYgKCAhJC5pc0Z1bmN0aW9uKCB2YWx1ZSApICkge1xuXHRcdFx0cHJveGllZFByb3RvdHlwZVsgcHJvcCBdID0gdmFsdWU7XG5cdFx0XHRyZXR1cm47XG5cdFx0fVxuXHRcdHByb3hpZWRQcm90b3R5cGVbIHByb3AgXSA9ICggZnVuY3Rpb24oKSB7XG5cdFx0XHRmdW5jdGlvbiBfc3VwZXIoKSB7XG5cdFx0XHRcdHJldHVybiBiYXNlLnByb3RvdHlwZVsgcHJvcCBdLmFwcGx5KCB0aGlzLCBhcmd1bWVudHMgKTtcblx0XHRcdH1cblxuXHRcdFx0ZnVuY3Rpb24gX3N1cGVyQXBwbHkoIGFyZ3MgKSB7XG5cdFx0XHRcdHJldHVybiBiYXNlLnByb3RvdHlwZVsgcHJvcCBdLmFwcGx5KCB0aGlzLCBhcmdzICk7XG5cdFx0XHR9XG5cblx0XHRcdHJldHVybiBmdW5jdGlvbigpIHtcblx0XHRcdFx0dmFyIF9fc3VwZXIgPSB0aGlzLl9zdXBlcjtcblx0XHRcdFx0dmFyIF9fc3VwZXJBcHBseSA9IHRoaXMuX3N1cGVyQXBwbHk7XG5cdFx0XHRcdHZhciByZXR1cm5WYWx1ZTtcblxuXHRcdFx0XHR0aGlzLl9zdXBlciA9IF9zdXBlcjtcblx0XHRcdFx0dGhpcy5fc3VwZXJBcHBseSA9IF9zdXBlckFwcGx5O1xuXG5cdFx0XHRcdHJldHVyblZhbHVlID0gdmFsdWUuYXBwbHkoIHRoaXMsIGFyZ3VtZW50cyApO1xuXG5cdFx0XHRcdHRoaXMuX3N1cGVyID0gX19zdXBlcjtcblx0XHRcdFx0dGhpcy5fc3VwZXJBcHBseSA9IF9fc3VwZXJBcHBseTtcblxuXHRcdFx0XHRyZXR1cm4gcmV0dXJuVmFsdWU7XG5cdFx0XHR9O1xuXHRcdH0gKSgpO1xuXHR9ICk7XG5cdGNvbnN0cnVjdG9yLnByb3RvdHlwZSA9ICQud2lkZ2V0LmV4dGVuZCggYmFzZVByb3RvdHlwZSwge1xuXG5cdFx0Ly8gVE9ETzogcmVtb3ZlIHN1cHBvcnQgZm9yIHdpZGdldEV2ZW50UHJlZml4XG5cdFx0Ly8gYWx3YXlzIHVzZSB0aGUgbmFtZSArIGEgY29sb24gYXMgdGhlIHByZWZpeCwgZS5nLiwgZHJhZ2dhYmxlOnN0YXJ0XG5cdFx0Ly8gZG9uJ3QgcHJlZml4IGZvciB3aWRnZXRzIHRoYXQgYXJlbid0IERPTS1iYXNlZFxuXHRcdHdpZGdldEV2ZW50UHJlZml4OiBleGlzdGluZ0NvbnN0cnVjdG9yID8gKCBiYXNlUHJvdG90eXBlLndpZGdldEV2ZW50UHJlZml4IHx8IG5hbWUgKSA6IG5hbWVcblx0fSwgcHJveGllZFByb3RvdHlwZSwge1xuXHRcdGNvbnN0cnVjdG9yOiBjb25zdHJ1Y3Rvcixcblx0XHRuYW1lc3BhY2U6IG5hbWVzcGFjZSxcblx0XHR3aWRnZXROYW1lOiBuYW1lLFxuXHRcdHdpZGdldEZ1bGxOYW1lOiBmdWxsTmFtZVxuXHR9ICk7XG5cblx0Ly8gSWYgdGhpcyB3aWRnZXQgaXMgYmVpbmcgcmVkZWZpbmVkIHRoZW4gd2UgbmVlZCB0byBmaW5kIGFsbCB3aWRnZXRzIHRoYXRcblx0Ly8gYXJlIGluaGVyaXRpbmcgZnJvbSBpdCBhbmQgcmVkZWZpbmUgYWxsIG9mIHRoZW0gc28gdGhhdCB0aGV5IGluaGVyaXQgZnJvbVxuXHQvLyB0aGUgbmV3IHZlcnNpb24gb2YgdGhpcyB3aWRnZXQuIFdlJ3JlIGVzc2VudGlhbGx5IHRyeWluZyB0byByZXBsYWNlIG9uZVxuXHQvLyBsZXZlbCBpbiB0aGUgcHJvdG90eXBlIGNoYWluLlxuXHRpZiAoIGV4aXN0aW5nQ29uc3RydWN0b3IgKSB7XG5cdFx0JC5lYWNoKCBleGlzdGluZ0NvbnN0cnVjdG9yLl9jaGlsZENvbnN0cnVjdG9ycywgZnVuY3Rpb24oIGksIGNoaWxkICkge1xuXHRcdFx0dmFyIGNoaWxkUHJvdG90eXBlID0gY2hpbGQucHJvdG90eXBlO1xuXG5cdFx0XHQvLyBSZWRlZmluZSB0aGUgY2hpbGQgd2lkZ2V0IHVzaW5nIHRoZSBzYW1lIHByb3RvdHlwZSB0aGF0IHdhc1xuXHRcdFx0Ly8gb3JpZ2luYWxseSB1c2VkLCBidXQgaW5oZXJpdCBmcm9tIHRoZSBuZXcgdmVyc2lvbiBvZiB0aGUgYmFzZVxuXHRcdFx0JC53aWRnZXQoIGNoaWxkUHJvdG90eXBlLm5hbWVzcGFjZSArIFwiLlwiICsgY2hpbGRQcm90b3R5cGUud2lkZ2V0TmFtZSwgY29uc3RydWN0b3IsXG5cdFx0XHRcdGNoaWxkLl9wcm90byApO1xuXHRcdH0gKTtcblxuXHRcdC8vIFJlbW92ZSB0aGUgbGlzdCBvZiBleGlzdGluZyBjaGlsZCBjb25zdHJ1Y3RvcnMgZnJvbSB0aGUgb2xkIGNvbnN0cnVjdG9yXG5cdFx0Ly8gc28gdGhlIG9sZCBjaGlsZCBjb25zdHJ1Y3RvcnMgY2FuIGJlIGdhcmJhZ2UgY29sbGVjdGVkXG5cdFx0ZGVsZXRlIGV4aXN0aW5nQ29uc3RydWN0b3IuX2NoaWxkQ29uc3RydWN0b3JzO1xuXHR9IGVsc2Uge1xuXHRcdGJhc2UuX2NoaWxkQ29uc3RydWN0b3JzLnB1c2goIGNvbnN0cnVjdG9yICk7XG5cdH1cblxuXHQkLndpZGdldC5icmlkZ2UoIG5hbWUsIGNvbnN0cnVjdG9yICk7XG5cblx0cmV0dXJuIGNvbnN0cnVjdG9yO1xufTtcblxuJC53aWRnZXQuZXh0ZW5kID0gZnVuY3Rpb24oIHRhcmdldCApIHtcblx0dmFyIGlucHV0ID0gd2lkZ2V0U2xpY2UuY2FsbCggYXJndW1lbnRzLCAxICk7XG5cdHZhciBpbnB1dEluZGV4ID0gMDtcblx0dmFyIGlucHV0TGVuZ3RoID0gaW5wdXQubGVuZ3RoO1xuXHR2YXIga2V5O1xuXHR2YXIgdmFsdWU7XG5cblx0Zm9yICggOyBpbnB1dEluZGV4IDwgaW5wdXRMZW5ndGg7IGlucHV0SW5kZXgrKyApIHtcblx0XHRmb3IgKCBrZXkgaW4gaW5wdXRbIGlucHV0SW5kZXggXSApIHtcblx0XHRcdHZhbHVlID0gaW5wdXRbIGlucHV0SW5kZXggXVsga2V5IF07XG5cdFx0XHRpZiAoIGlucHV0WyBpbnB1dEluZGV4IF0uaGFzT3duUHJvcGVydHkoIGtleSApICYmIHZhbHVlICE9PSB1bmRlZmluZWQgKSB7XG5cblx0XHRcdFx0Ly8gQ2xvbmUgb2JqZWN0c1xuXHRcdFx0XHRpZiAoICQuaXNQbGFpbk9iamVjdCggdmFsdWUgKSApIHtcblx0XHRcdFx0XHR0YXJnZXRbIGtleSBdID0gJC5pc1BsYWluT2JqZWN0KCB0YXJnZXRbIGtleSBdICkgP1xuXHRcdFx0XHRcdFx0JC53aWRnZXQuZXh0ZW5kKCB7fSwgdGFyZ2V0WyBrZXkgXSwgdmFsdWUgKSA6XG5cblx0XHRcdFx0XHRcdC8vIERvbid0IGV4dGVuZCBzdHJpbmdzLCBhcnJheXMsIGV0Yy4gd2l0aCBvYmplY3RzXG5cdFx0XHRcdFx0XHQkLndpZGdldC5leHRlbmQoIHt9LCB2YWx1ZSApO1xuXG5cdFx0XHRcdC8vIENvcHkgZXZlcnl0aGluZyBlbHNlIGJ5IHJlZmVyZW5jZVxuXHRcdFx0XHR9IGVsc2Uge1xuXHRcdFx0XHRcdHRhcmdldFsga2V5IF0gPSB2YWx1ZTtcblx0XHRcdFx0fVxuXHRcdFx0fVxuXHRcdH1cblx0fVxuXHRyZXR1cm4gdGFyZ2V0O1xufTtcblxuJC53aWRnZXQuYnJpZGdlID0gZnVuY3Rpb24oIG5hbWUsIG9iamVjdCApIHtcblx0dmFyIGZ1bGxOYW1lID0gb2JqZWN0LnByb3RvdHlwZS53aWRnZXRGdWxsTmFtZSB8fCBuYW1lO1xuXHQkLmZuWyBuYW1lIF0gPSBmdW5jdGlvbiggb3B0aW9ucyApIHtcblx0XHR2YXIgaXNNZXRob2RDYWxsID0gdHlwZW9mIG9wdGlvbnMgPT09IFwic3RyaW5nXCI7XG5cdFx0dmFyIGFyZ3MgPSB3aWRnZXRTbGljZS5jYWxsKCBhcmd1bWVudHMsIDEgKTtcblx0XHR2YXIgcmV0dXJuVmFsdWUgPSB0aGlzO1xuXG5cdFx0aWYgKCBpc01ldGhvZENhbGwgKSB7XG5cblx0XHRcdC8vIElmIHRoaXMgaXMgYW4gZW1wdHkgY29sbGVjdGlvbiwgd2UgbmVlZCB0byBoYXZlIHRoZSBpbnN0YW5jZSBtZXRob2Rcblx0XHRcdC8vIHJldHVybiB1bmRlZmluZWQgaW5zdGVhZCBvZiB0aGUgalF1ZXJ5IGluc3RhbmNlXG5cdFx0XHRpZiAoICF0aGlzLmxlbmd0aCAmJiBvcHRpb25zID09PSBcImluc3RhbmNlXCIgKSB7XG5cdFx0XHRcdHJldHVyblZhbHVlID0gdW5kZWZpbmVkO1xuXHRcdFx0fSBlbHNlIHtcblx0XHRcdFx0dGhpcy5lYWNoKCBmdW5jdGlvbigpIHtcblx0XHRcdFx0XHR2YXIgbWV0aG9kVmFsdWU7XG5cdFx0XHRcdFx0dmFyIGluc3RhbmNlID0gJC5kYXRhKCB0aGlzLCBmdWxsTmFtZSApO1xuXG5cdFx0XHRcdFx0aWYgKCBvcHRpb25zID09PSBcImluc3RhbmNlXCIgKSB7XG5cdFx0XHRcdFx0XHRyZXR1cm5WYWx1ZSA9IGluc3RhbmNlO1xuXHRcdFx0XHRcdFx0cmV0dXJuIGZhbHNlO1xuXHRcdFx0XHRcdH1cblxuXHRcdFx0XHRcdGlmICggIWluc3RhbmNlICkge1xuXHRcdFx0XHRcdFx0cmV0dXJuICQuZXJyb3IoIFwiY2Fubm90IGNhbGwgbWV0aG9kcyBvbiBcIiArIG5hbWUgK1xuXHRcdFx0XHRcdFx0XHRcIiBwcmlvciB0byBpbml0aWFsaXphdGlvbjsgXCIgK1xuXHRcdFx0XHRcdFx0XHRcImF0dGVtcHRlZCB0byBjYWxsIG1ldGhvZCAnXCIgKyBvcHRpb25zICsgXCInXCIgKTtcblx0XHRcdFx0XHR9XG5cblx0XHRcdFx0XHRpZiAoICEkLmlzRnVuY3Rpb24oIGluc3RhbmNlWyBvcHRpb25zIF0gKSB8fCBvcHRpb25zLmNoYXJBdCggMCApID09PSBcIl9cIiApIHtcblx0XHRcdFx0XHRcdHJldHVybiAkLmVycm9yKCBcIm5vIHN1Y2ggbWV0aG9kICdcIiArIG9wdGlvbnMgKyBcIicgZm9yIFwiICsgbmFtZSArXG5cdFx0XHRcdFx0XHRcdFwiIHdpZGdldCBpbnN0YW5jZVwiICk7XG5cdFx0XHRcdFx0fVxuXG5cdFx0XHRcdFx0bWV0aG9kVmFsdWUgPSBpbnN0YW5jZVsgb3B0aW9ucyBdLmFwcGx5KCBpbnN0YW5jZSwgYXJncyApO1xuXG5cdFx0XHRcdFx0aWYgKCBtZXRob2RWYWx1ZSAhPT0gaW5zdGFuY2UgJiYgbWV0aG9kVmFsdWUgIT09IHVuZGVmaW5lZCApIHtcblx0XHRcdFx0XHRcdHJldHVyblZhbHVlID0gbWV0aG9kVmFsdWUgJiYgbWV0aG9kVmFsdWUuanF1ZXJ5ID9cblx0XHRcdFx0XHRcdFx0cmV0dXJuVmFsdWUucHVzaFN0YWNrKCBtZXRob2RWYWx1ZS5nZXQoKSApIDpcblx0XHRcdFx0XHRcdFx0bWV0aG9kVmFsdWU7XG5cdFx0XHRcdFx0XHRyZXR1cm4gZmFsc2U7XG5cdFx0XHRcdFx0fVxuXHRcdFx0XHR9ICk7XG5cdFx0XHR9XG5cdFx0fSBlbHNlIHtcblxuXHRcdFx0Ly8gQWxsb3cgbXVsdGlwbGUgaGFzaGVzIHRvIGJlIHBhc3NlZCBvbiBpbml0XG5cdFx0XHRpZiAoIGFyZ3MubGVuZ3RoICkge1xuXHRcdFx0XHRvcHRpb25zID0gJC53aWRnZXQuZXh0ZW5kLmFwcGx5KCBudWxsLCBbIG9wdGlvbnMgXS5jb25jYXQoIGFyZ3MgKSApO1xuXHRcdFx0fVxuXG5cdFx0XHR0aGlzLmVhY2goIGZ1bmN0aW9uKCkge1xuXHRcdFx0XHR2YXIgaW5zdGFuY2UgPSAkLmRhdGEoIHRoaXMsIGZ1bGxOYW1lICk7XG5cdFx0XHRcdGlmICggaW5zdGFuY2UgKSB7XG5cdFx0XHRcdFx0aW5zdGFuY2Uub3B0aW9uKCBvcHRpb25zIHx8IHt9ICk7XG5cdFx0XHRcdFx0aWYgKCBpbnN0YW5jZS5faW5pdCApIHtcblx0XHRcdFx0XHRcdGluc3RhbmNlLl9pbml0KCk7XG5cdFx0XHRcdFx0fVxuXHRcdFx0XHR9IGVsc2Uge1xuXHRcdFx0XHRcdCQuZGF0YSggdGhpcywgZnVsbE5hbWUsIG5ldyBvYmplY3QoIG9wdGlvbnMsIHRoaXMgKSApO1xuXHRcdFx0XHR9XG5cdFx0XHR9ICk7XG5cdFx0fVxuXG5cdFx0cmV0dXJuIHJldHVyblZhbHVlO1xuXHR9O1xufTtcblxuJC5XaWRnZXQgPSBmdW5jdGlvbiggLyogb3B0aW9ucywgZWxlbWVudCAqLyApIHt9O1xuJC5XaWRnZXQuX2NoaWxkQ29uc3RydWN0b3JzID0gW107XG5cbiQuV2lkZ2V0LnByb3RvdHlwZSA9IHtcblx0d2lkZ2V0TmFtZTogXCJ3aWRnZXRcIixcblx0d2lkZ2V0RXZlbnRQcmVmaXg6IFwiXCIsXG5cdGRlZmF1bHRFbGVtZW50OiBcIjxkaXY+XCIsXG5cblx0b3B0aW9uczoge1xuXHRcdGNsYXNzZXM6IHt9LFxuXHRcdGRpc2FibGVkOiBmYWxzZSxcblxuXHRcdC8vIENhbGxiYWNrc1xuXHRcdGNyZWF0ZTogbnVsbFxuXHR9LFxuXG5cdF9jcmVhdGVXaWRnZXQ6IGZ1bmN0aW9uKCBvcHRpb25zLCBlbGVtZW50ICkge1xuXHRcdGVsZW1lbnQgPSAkKCBlbGVtZW50IHx8IHRoaXMuZGVmYXVsdEVsZW1lbnQgfHwgdGhpcyApWyAwIF07XG5cdFx0dGhpcy5lbGVtZW50ID0gJCggZWxlbWVudCApO1xuXHRcdHRoaXMudXVpZCA9IHdpZGdldFV1aWQrKztcblx0XHR0aGlzLmV2ZW50TmFtZXNwYWNlID0gXCIuXCIgKyB0aGlzLndpZGdldE5hbWUgKyB0aGlzLnV1aWQ7XG5cblx0XHR0aGlzLmJpbmRpbmdzID0gJCgpO1xuXHRcdHRoaXMuaG92ZXJhYmxlID0gJCgpO1xuXHRcdHRoaXMuZm9jdXNhYmxlID0gJCgpO1xuXHRcdHRoaXMuY2xhc3Nlc0VsZW1lbnRMb29rdXAgPSB7fTtcblxuXHRcdGlmICggZWxlbWVudCAhPT0gdGhpcyApIHtcblx0XHRcdCQuZGF0YSggZWxlbWVudCwgdGhpcy53aWRnZXRGdWxsTmFtZSwgdGhpcyApO1xuXHRcdFx0dGhpcy5fb24oIHRydWUsIHRoaXMuZWxlbWVudCwge1xuXHRcdFx0XHRyZW1vdmU6IGZ1bmN0aW9uKCBldmVudCApIHtcblx0XHRcdFx0XHRpZiAoIGV2ZW50LnRhcmdldCA9PT0gZWxlbWVudCApIHtcblx0XHRcdFx0XHRcdHRoaXMuZGVzdHJveSgpO1xuXHRcdFx0XHRcdH1cblx0XHRcdFx0fVxuXHRcdFx0fSApO1xuXHRcdFx0dGhpcy5kb2N1bWVudCA9ICQoIGVsZW1lbnQuc3R5bGUgP1xuXG5cdFx0XHRcdC8vIEVsZW1lbnQgd2l0aGluIHRoZSBkb2N1bWVudFxuXHRcdFx0XHRlbGVtZW50Lm93bmVyRG9jdW1lbnQgOlxuXG5cdFx0XHRcdC8vIEVsZW1lbnQgaXMgd2luZG93IG9yIGRvY3VtZW50XG5cdFx0XHRcdGVsZW1lbnQuZG9jdW1lbnQgfHwgZWxlbWVudCApO1xuXHRcdFx0dGhpcy53aW5kb3cgPSAkKCB0aGlzLmRvY3VtZW50WyAwIF0uZGVmYXVsdFZpZXcgfHwgdGhpcy5kb2N1bWVudFsgMCBdLnBhcmVudFdpbmRvdyApO1xuXHRcdH1cblxuXHRcdHRoaXMub3B0aW9ucyA9ICQud2lkZ2V0LmV4dGVuZCgge30sXG5cdFx0XHR0aGlzLm9wdGlvbnMsXG5cdFx0XHR0aGlzLl9nZXRDcmVhdGVPcHRpb25zKCksXG5cdFx0XHRvcHRpb25zICk7XG5cblx0XHR0aGlzLl9jcmVhdGUoKTtcblxuXHRcdGlmICggdGhpcy5vcHRpb25zLmRpc2FibGVkICkge1xuXHRcdFx0dGhpcy5fc2V0T3B0aW9uRGlzYWJsZWQoIHRoaXMub3B0aW9ucy5kaXNhYmxlZCApO1xuXHRcdH1cblxuXHRcdHRoaXMuX3RyaWdnZXIoIFwiY3JlYXRlXCIsIG51bGwsIHRoaXMuX2dldENyZWF0ZUV2ZW50RGF0YSgpICk7XG5cdFx0dGhpcy5faW5pdCgpO1xuXHR9LFxuXG5cdF9nZXRDcmVhdGVPcHRpb25zOiBmdW5jdGlvbigpIHtcblx0XHRyZXR1cm4ge307XG5cdH0sXG5cblx0X2dldENyZWF0ZUV2ZW50RGF0YTogJC5ub29wLFxuXG5cdF9jcmVhdGU6ICQubm9vcCxcblxuXHRfaW5pdDogJC5ub29wLFxuXG5cdGRlc3Ryb3k6IGZ1bmN0aW9uKCkge1xuXHRcdHZhciB0aGF0ID0gdGhpcztcblxuXHRcdHRoaXMuX2Rlc3Ryb3koKTtcblx0XHQkLmVhY2goIHRoaXMuY2xhc3Nlc0VsZW1lbnRMb29rdXAsIGZ1bmN0aW9uKCBrZXksIHZhbHVlICkge1xuXHRcdFx0dGhhdC5fcmVtb3ZlQ2xhc3MoIHZhbHVlLCBrZXkgKTtcblx0XHR9ICk7XG5cblx0XHQvLyBXZSBjYW4gcHJvYmFibHkgcmVtb3ZlIHRoZSB1bmJpbmQgY2FsbHMgaW4gMi4wXG5cdFx0Ly8gYWxsIGV2ZW50IGJpbmRpbmdzIHNob3VsZCBnbyB0aHJvdWdoIHRoaXMuX29uKClcblx0XHR0aGlzLmVsZW1lbnRcblx0XHRcdC5vZmYoIHRoaXMuZXZlbnROYW1lc3BhY2UgKVxuXHRcdFx0LnJlbW92ZURhdGEoIHRoaXMud2lkZ2V0RnVsbE5hbWUgKTtcblx0XHR0aGlzLndpZGdldCgpXG5cdFx0XHQub2ZmKCB0aGlzLmV2ZW50TmFtZXNwYWNlIClcblx0XHRcdC5yZW1vdmVBdHRyKCBcImFyaWEtZGlzYWJsZWRcIiApO1xuXG5cdFx0Ly8gQ2xlYW4gdXAgZXZlbnRzIGFuZCBzdGF0ZXNcblx0XHR0aGlzLmJpbmRpbmdzLm9mZiggdGhpcy5ldmVudE5hbWVzcGFjZSApO1xuXHR9LFxuXG5cdF9kZXN0cm95OiAkLm5vb3AsXG5cblx0d2lkZ2V0OiBmdW5jdGlvbigpIHtcblx0XHRyZXR1cm4gdGhpcy5lbGVtZW50O1xuXHR9LFxuXG5cdG9wdGlvbjogZnVuY3Rpb24oIGtleSwgdmFsdWUgKSB7XG5cdFx0dmFyIG9wdGlvbnMgPSBrZXk7XG5cdFx0dmFyIHBhcnRzO1xuXHRcdHZhciBjdXJPcHRpb247XG5cdFx0dmFyIGk7XG5cblx0XHRpZiAoIGFyZ3VtZW50cy5sZW5ndGggPT09IDAgKSB7XG5cblx0XHRcdC8vIERvbid0IHJldHVybiBhIHJlZmVyZW5jZSB0byB0aGUgaW50ZXJuYWwgaGFzaFxuXHRcdFx0cmV0dXJuICQud2lkZ2V0LmV4dGVuZCgge30sIHRoaXMub3B0aW9ucyApO1xuXHRcdH1cblxuXHRcdGlmICggdHlwZW9mIGtleSA9PT0gXCJzdHJpbmdcIiApIHtcblxuXHRcdFx0Ly8gSGFuZGxlIG5lc3RlZCBrZXlzLCBlLmcuLCBcImZvby5iYXJcIiA9PiB7IGZvbzogeyBiYXI6IF9fXyB9IH1cblx0XHRcdG9wdGlvbnMgPSB7fTtcblx0XHRcdHBhcnRzID0ga2V5LnNwbGl0KCBcIi5cIiApO1xuXHRcdFx0a2V5ID0gcGFydHMuc2hpZnQoKTtcblx0XHRcdGlmICggcGFydHMubGVuZ3RoICkge1xuXHRcdFx0XHRjdXJPcHRpb24gPSBvcHRpb25zWyBrZXkgXSA9ICQud2lkZ2V0LmV4dGVuZCgge30sIHRoaXMub3B0aW9uc1sga2V5IF0gKTtcblx0XHRcdFx0Zm9yICggaSA9IDA7IGkgPCBwYXJ0cy5sZW5ndGggLSAxOyBpKysgKSB7XG5cdFx0XHRcdFx0Y3VyT3B0aW9uWyBwYXJ0c1sgaSBdIF0gPSBjdXJPcHRpb25bIHBhcnRzWyBpIF0gXSB8fCB7fTtcblx0XHRcdFx0XHRjdXJPcHRpb24gPSBjdXJPcHRpb25bIHBhcnRzWyBpIF0gXTtcblx0XHRcdFx0fVxuXHRcdFx0XHRrZXkgPSBwYXJ0cy5wb3AoKTtcblx0XHRcdFx0aWYgKCBhcmd1bWVudHMubGVuZ3RoID09PSAxICkge1xuXHRcdFx0XHRcdHJldHVybiBjdXJPcHRpb25bIGtleSBdID09PSB1bmRlZmluZWQgPyBudWxsIDogY3VyT3B0aW9uWyBrZXkgXTtcblx0XHRcdFx0fVxuXHRcdFx0XHRjdXJPcHRpb25bIGtleSBdID0gdmFsdWU7XG5cdFx0XHR9IGVsc2Uge1xuXHRcdFx0XHRpZiAoIGFyZ3VtZW50cy5sZW5ndGggPT09IDEgKSB7XG5cdFx0XHRcdFx0cmV0dXJuIHRoaXMub3B0aW9uc1sga2V5IF0gPT09IHVuZGVmaW5lZCA/IG51bGwgOiB0aGlzLm9wdGlvbnNbIGtleSBdO1xuXHRcdFx0XHR9XG5cdFx0XHRcdG9wdGlvbnNbIGtleSBdID0gdmFsdWU7XG5cdFx0XHR9XG5cdFx0fVxuXG5cdFx0dGhpcy5fc2V0T3B0aW9ucyggb3B0aW9ucyApO1xuXG5cdFx0cmV0dXJuIHRoaXM7XG5cdH0sXG5cblx0X3NldE9wdGlvbnM6IGZ1bmN0aW9uKCBvcHRpb25zICkge1xuXHRcdHZhciBrZXk7XG5cblx0XHRmb3IgKCBrZXkgaW4gb3B0aW9ucyApIHtcblx0XHRcdHRoaXMuX3NldE9wdGlvbigga2V5LCBvcHRpb25zWyBrZXkgXSApO1xuXHRcdH1cblxuXHRcdHJldHVybiB0aGlzO1xuXHR9LFxuXG5cdF9zZXRPcHRpb246IGZ1bmN0aW9uKCBrZXksIHZhbHVlICkge1xuXHRcdGlmICgga2V5ID09PSBcImNsYXNzZXNcIiApIHtcblx0XHRcdHRoaXMuX3NldE9wdGlvbkNsYXNzZXMoIHZhbHVlICk7XG5cdFx0fVxuXG5cdFx0dGhpcy5vcHRpb25zWyBrZXkgXSA9IHZhbHVlO1xuXG5cdFx0aWYgKCBrZXkgPT09IFwiZGlzYWJsZWRcIiApIHtcblx0XHRcdHRoaXMuX3NldE9wdGlvbkRpc2FibGVkKCB2YWx1ZSApO1xuXHRcdH1cblxuXHRcdHJldHVybiB0aGlzO1xuXHR9LFxuXG5cdF9zZXRPcHRpb25DbGFzc2VzOiBmdW5jdGlvbiggdmFsdWUgKSB7XG5cdFx0dmFyIGNsYXNzS2V5LCBlbGVtZW50cywgY3VycmVudEVsZW1lbnRzO1xuXG5cdFx0Zm9yICggY2xhc3NLZXkgaW4gdmFsdWUgKSB7XG5cdFx0XHRjdXJyZW50RWxlbWVudHMgPSB0aGlzLmNsYXNzZXNFbGVtZW50TG9va3VwWyBjbGFzc0tleSBdO1xuXHRcdFx0aWYgKCB2YWx1ZVsgY2xhc3NLZXkgXSA9PT0gdGhpcy5vcHRpb25zLmNsYXNzZXNbIGNsYXNzS2V5IF0gfHxcblx0XHRcdFx0XHQhY3VycmVudEVsZW1lbnRzIHx8XG5cdFx0XHRcdFx0IWN1cnJlbnRFbGVtZW50cy5sZW5ndGggKSB7XG5cdFx0XHRcdGNvbnRpbnVlO1xuXHRcdFx0fVxuXG5cdFx0XHQvLyBXZSBhcmUgZG9pbmcgdGhpcyB0byBjcmVhdGUgYSBuZXcgalF1ZXJ5IG9iamVjdCBiZWNhdXNlIHRoZSBfcmVtb3ZlQ2xhc3MoKSBjYWxsXG5cdFx0XHQvLyBvbiB0aGUgbmV4dCBsaW5lIGlzIGdvaW5nIHRvIGRlc3Ryb3kgdGhlIHJlZmVyZW5jZSB0byB0aGUgY3VycmVudCBlbGVtZW50cyBiZWluZ1xuXHRcdFx0Ly8gdHJhY2tlZC4gV2UgbmVlZCB0byBzYXZlIGEgY29weSBvZiB0aGlzIGNvbGxlY3Rpb24gc28gdGhhdCB3ZSBjYW4gYWRkIHRoZSBuZXcgY2xhc3Nlc1xuXHRcdFx0Ly8gYmVsb3cuXG5cdFx0XHRlbGVtZW50cyA9ICQoIGN1cnJlbnRFbGVtZW50cy5nZXQoKSApO1xuXHRcdFx0dGhpcy5fcmVtb3ZlQ2xhc3MoIGN1cnJlbnRFbGVtZW50cywgY2xhc3NLZXkgKTtcblxuXHRcdFx0Ly8gV2UgZG9uJ3QgdXNlIF9hZGRDbGFzcygpIGhlcmUsIGJlY2F1c2UgdGhhdCB1c2VzIHRoaXMub3B0aW9ucy5jbGFzc2VzXG5cdFx0XHQvLyBmb3IgZ2VuZXJhdGluZyB0aGUgc3RyaW5nIG9mIGNsYXNzZXMuIFdlIHdhbnQgdG8gdXNlIHRoZSB2YWx1ZSBwYXNzZWQgaW4gZnJvbVxuXHRcdFx0Ly8gX3NldE9wdGlvbigpLCB0aGlzIGlzIHRoZSBuZXcgdmFsdWUgb2YgdGhlIGNsYXNzZXMgb3B0aW9uIHdoaWNoIHdhcyBwYXNzZWQgdG9cblx0XHRcdC8vIF9zZXRPcHRpb24oKS4gV2UgcGFzcyB0aGlzIHZhbHVlIGRpcmVjdGx5IHRvIF9jbGFzc2VzKCkuXG5cdFx0XHRlbGVtZW50cy5hZGRDbGFzcyggdGhpcy5fY2xhc3Nlcygge1xuXHRcdFx0XHRlbGVtZW50OiBlbGVtZW50cyxcblx0XHRcdFx0a2V5czogY2xhc3NLZXksXG5cdFx0XHRcdGNsYXNzZXM6IHZhbHVlLFxuXHRcdFx0XHRhZGQ6IHRydWVcblx0XHRcdH0gKSApO1xuXHRcdH1cblx0fSxcblxuXHRfc2V0T3B0aW9uRGlzYWJsZWQ6IGZ1bmN0aW9uKCB2YWx1ZSApIHtcblx0XHR0aGlzLl90b2dnbGVDbGFzcyggdGhpcy53aWRnZXQoKSwgdGhpcy53aWRnZXRGdWxsTmFtZSArIFwiLWRpc2FibGVkXCIsIG51bGwsICEhdmFsdWUgKTtcblxuXHRcdC8vIElmIHRoZSB3aWRnZXQgaXMgYmVjb21pbmcgZGlzYWJsZWQsIHRoZW4gbm90aGluZyBpcyBpbnRlcmFjdGl2ZVxuXHRcdGlmICggdmFsdWUgKSB7XG5cdFx0XHR0aGlzLl9yZW1vdmVDbGFzcyggdGhpcy5ob3ZlcmFibGUsIG51bGwsIFwidWktc3RhdGUtaG92ZXJcIiApO1xuXHRcdFx0dGhpcy5fcmVtb3ZlQ2xhc3MoIHRoaXMuZm9jdXNhYmxlLCBudWxsLCBcInVpLXN0YXRlLWZvY3VzXCIgKTtcblx0XHR9XG5cdH0sXG5cblx0ZW5hYmxlOiBmdW5jdGlvbigpIHtcblx0XHRyZXR1cm4gdGhpcy5fc2V0T3B0aW9ucyggeyBkaXNhYmxlZDogZmFsc2UgfSApO1xuXHR9LFxuXG5cdGRpc2FibGU6IGZ1bmN0aW9uKCkge1xuXHRcdHJldHVybiB0aGlzLl9zZXRPcHRpb25zKCB7IGRpc2FibGVkOiB0cnVlIH0gKTtcblx0fSxcblxuXHRfY2xhc3NlczogZnVuY3Rpb24oIG9wdGlvbnMgKSB7XG5cdFx0dmFyIGZ1bGwgPSBbXTtcblx0XHR2YXIgdGhhdCA9IHRoaXM7XG5cblx0XHRvcHRpb25zID0gJC5leHRlbmQoIHtcblx0XHRcdGVsZW1lbnQ6IHRoaXMuZWxlbWVudCxcblx0XHRcdGNsYXNzZXM6IHRoaXMub3B0aW9ucy5jbGFzc2VzIHx8IHt9XG5cdFx0fSwgb3B0aW9ucyApO1xuXG5cdFx0ZnVuY3Rpb24gcHJvY2Vzc0NsYXNzU3RyaW5nKCBjbGFzc2VzLCBjaGVja09wdGlvbiApIHtcblx0XHRcdHZhciBjdXJyZW50LCBpO1xuXHRcdFx0Zm9yICggaSA9IDA7IGkgPCBjbGFzc2VzLmxlbmd0aDsgaSsrICkge1xuXHRcdFx0XHRjdXJyZW50ID0gdGhhdC5jbGFzc2VzRWxlbWVudExvb2t1cFsgY2xhc3Nlc1sgaSBdIF0gfHwgJCgpO1xuXHRcdFx0XHRpZiAoIG9wdGlvbnMuYWRkICkge1xuXHRcdFx0XHRcdGN1cnJlbnQgPSAkKCAkLnVuaXF1ZSggY3VycmVudC5nZXQoKS5jb25jYXQoIG9wdGlvbnMuZWxlbWVudC5nZXQoKSApICkgKTtcblx0XHRcdFx0fSBlbHNlIHtcblx0XHRcdFx0XHRjdXJyZW50ID0gJCggY3VycmVudC5ub3QoIG9wdGlvbnMuZWxlbWVudCApLmdldCgpICk7XG5cdFx0XHRcdH1cblx0XHRcdFx0dGhhdC5jbGFzc2VzRWxlbWVudExvb2t1cFsgY2xhc3Nlc1sgaSBdIF0gPSBjdXJyZW50O1xuXHRcdFx0XHRmdWxsLnB1c2goIGNsYXNzZXNbIGkgXSApO1xuXHRcdFx0XHRpZiAoIGNoZWNrT3B0aW9uICYmIG9wdGlvbnMuY2xhc3Nlc1sgY2xhc3Nlc1sgaSBdIF0gKSB7XG5cdFx0XHRcdFx0ZnVsbC5wdXNoKCBvcHRpb25zLmNsYXNzZXNbIGNsYXNzZXNbIGkgXSBdICk7XG5cdFx0XHRcdH1cblx0XHRcdH1cblx0XHR9XG5cblx0XHR0aGlzLl9vbiggb3B0aW9ucy5lbGVtZW50LCB7XG5cdFx0XHRcInJlbW92ZVwiOiBcIl91bnRyYWNrQ2xhc3Nlc0VsZW1lbnRcIlxuXHRcdH0gKTtcblxuXHRcdGlmICggb3B0aW9ucy5rZXlzICkge1xuXHRcdFx0cHJvY2Vzc0NsYXNzU3RyaW5nKCBvcHRpb25zLmtleXMubWF0Y2goIC9cXFMrL2cgKSB8fCBbXSwgdHJ1ZSApO1xuXHRcdH1cblx0XHRpZiAoIG9wdGlvbnMuZXh0cmEgKSB7XG5cdFx0XHRwcm9jZXNzQ2xhc3NTdHJpbmcoIG9wdGlvbnMuZXh0cmEubWF0Y2goIC9cXFMrL2cgKSB8fCBbXSApO1xuXHRcdH1cblxuXHRcdHJldHVybiBmdWxsLmpvaW4oIFwiIFwiICk7XG5cdH0sXG5cblx0X3VudHJhY2tDbGFzc2VzRWxlbWVudDogZnVuY3Rpb24oIGV2ZW50ICkge1xuXHRcdHZhciB0aGF0ID0gdGhpcztcblx0XHQkLmVhY2goIHRoYXQuY2xhc3Nlc0VsZW1lbnRMb29rdXAsIGZ1bmN0aW9uKCBrZXksIHZhbHVlICkge1xuXHRcdFx0aWYgKCAkLmluQXJyYXkoIGV2ZW50LnRhcmdldCwgdmFsdWUgKSAhPT0gLTEgKSB7XG5cdFx0XHRcdHRoYXQuY2xhc3Nlc0VsZW1lbnRMb29rdXBbIGtleSBdID0gJCggdmFsdWUubm90KCBldmVudC50YXJnZXQgKS5nZXQoKSApO1xuXHRcdFx0fVxuXHRcdH0gKTtcblx0fSxcblxuXHRfcmVtb3ZlQ2xhc3M6IGZ1bmN0aW9uKCBlbGVtZW50LCBrZXlzLCBleHRyYSApIHtcblx0XHRyZXR1cm4gdGhpcy5fdG9nZ2xlQ2xhc3MoIGVsZW1lbnQsIGtleXMsIGV4dHJhLCBmYWxzZSApO1xuXHR9LFxuXG5cdF9hZGRDbGFzczogZnVuY3Rpb24oIGVsZW1lbnQsIGtleXMsIGV4dHJhICkge1xuXHRcdHJldHVybiB0aGlzLl90b2dnbGVDbGFzcyggZWxlbWVudCwga2V5cywgZXh0cmEsIHRydWUgKTtcblx0fSxcblxuXHRfdG9nZ2xlQ2xhc3M6IGZ1bmN0aW9uKCBlbGVtZW50LCBrZXlzLCBleHRyYSwgYWRkICkge1xuXHRcdGFkZCA9ICggdHlwZW9mIGFkZCA9PT0gXCJib29sZWFuXCIgKSA/IGFkZCA6IGV4dHJhO1xuXHRcdHZhciBzaGlmdCA9ICggdHlwZW9mIGVsZW1lbnQgPT09IFwic3RyaW5nXCIgfHwgZWxlbWVudCA9PT0gbnVsbCApLFxuXHRcdFx0b3B0aW9ucyA9IHtcblx0XHRcdFx0ZXh0cmE6IHNoaWZ0ID8ga2V5cyA6IGV4dHJhLFxuXHRcdFx0XHRrZXlzOiBzaGlmdCA/IGVsZW1lbnQgOiBrZXlzLFxuXHRcdFx0XHRlbGVtZW50OiBzaGlmdCA/IHRoaXMuZWxlbWVudCA6IGVsZW1lbnQsXG5cdFx0XHRcdGFkZDogYWRkXG5cdFx0XHR9O1xuXHRcdG9wdGlvbnMuZWxlbWVudC50b2dnbGVDbGFzcyggdGhpcy5fY2xhc3Nlcyggb3B0aW9ucyApLCBhZGQgKTtcblx0XHRyZXR1cm4gdGhpcztcblx0fSxcblxuXHRfb246IGZ1bmN0aW9uKCBzdXBwcmVzc0Rpc2FibGVkQ2hlY2ssIGVsZW1lbnQsIGhhbmRsZXJzICkge1xuXHRcdHZhciBkZWxlZ2F0ZUVsZW1lbnQ7XG5cdFx0dmFyIGluc3RhbmNlID0gdGhpcztcblxuXHRcdC8vIE5vIHN1cHByZXNzRGlzYWJsZWRDaGVjayBmbGFnLCBzaHVmZmxlIGFyZ3VtZW50c1xuXHRcdGlmICggdHlwZW9mIHN1cHByZXNzRGlzYWJsZWRDaGVjayAhPT0gXCJib29sZWFuXCIgKSB7XG5cdFx0XHRoYW5kbGVycyA9IGVsZW1lbnQ7XG5cdFx0XHRlbGVtZW50ID0gc3VwcHJlc3NEaXNhYmxlZENoZWNrO1xuXHRcdFx0c3VwcHJlc3NEaXNhYmxlZENoZWNrID0gZmFsc2U7XG5cdFx0fVxuXG5cdFx0Ly8gTm8gZWxlbWVudCBhcmd1bWVudCwgc2h1ZmZsZSBhbmQgdXNlIHRoaXMuZWxlbWVudFxuXHRcdGlmICggIWhhbmRsZXJzICkge1xuXHRcdFx0aGFuZGxlcnMgPSBlbGVtZW50O1xuXHRcdFx0ZWxlbWVudCA9IHRoaXMuZWxlbWVudDtcblx0XHRcdGRlbGVnYXRlRWxlbWVudCA9IHRoaXMud2lkZ2V0KCk7XG5cdFx0fSBlbHNlIHtcblx0XHRcdGVsZW1lbnQgPSBkZWxlZ2F0ZUVsZW1lbnQgPSAkKCBlbGVtZW50ICk7XG5cdFx0XHR0aGlzLmJpbmRpbmdzID0gdGhpcy5iaW5kaW5ncy5hZGQoIGVsZW1lbnQgKTtcblx0XHR9XG5cblx0XHQkLmVhY2goIGhhbmRsZXJzLCBmdW5jdGlvbiggZXZlbnQsIGhhbmRsZXIgKSB7XG5cdFx0XHRmdW5jdGlvbiBoYW5kbGVyUHJveHkoKSB7XG5cblx0XHRcdFx0Ly8gQWxsb3cgd2lkZ2V0cyB0byBjdXN0b21pemUgdGhlIGRpc2FibGVkIGhhbmRsaW5nXG5cdFx0XHRcdC8vIC0gZGlzYWJsZWQgYXMgYW4gYXJyYXkgaW5zdGVhZCBvZiBib29sZWFuXG5cdFx0XHRcdC8vIC0gZGlzYWJsZWQgY2xhc3MgYXMgbWV0aG9kIGZvciBkaXNhYmxpbmcgaW5kaXZpZHVhbCBwYXJ0c1xuXHRcdFx0XHRpZiAoICFzdXBwcmVzc0Rpc2FibGVkQ2hlY2sgJiZcblx0XHRcdFx0XHRcdCggaW5zdGFuY2Uub3B0aW9ucy5kaXNhYmxlZCA9PT0gdHJ1ZSB8fFxuXHRcdFx0XHRcdFx0JCggdGhpcyApLmhhc0NsYXNzKCBcInVpLXN0YXRlLWRpc2FibGVkXCIgKSApICkge1xuXHRcdFx0XHRcdHJldHVybjtcblx0XHRcdFx0fVxuXHRcdFx0XHRyZXR1cm4gKCB0eXBlb2YgaGFuZGxlciA9PT0gXCJzdHJpbmdcIiA/IGluc3RhbmNlWyBoYW5kbGVyIF0gOiBoYW5kbGVyIClcblx0XHRcdFx0XHQuYXBwbHkoIGluc3RhbmNlLCBhcmd1bWVudHMgKTtcblx0XHRcdH1cblxuXHRcdFx0Ly8gQ29weSB0aGUgZ3VpZCBzbyBkaXJlY3QgdW5iaW5kaW5nIHdvcmtzXG5cdFx0XHRpZiAoIHR5cGVvZiBoYW5kbGVyICE9PSBcInN0cmluZ1wiICkge1xuXHRcdFx0XHRoYW5kbGVyUHJveHkuZ3VpZCA9IGhhbmRsZXIuZ3VpZCA9XG5cdFx0XHRcdFx0aGFuZGxlci5ndWlkIHx8IGhhbmRsZXJQcm94eS5ndWlkIHx8ICQuZ3VpZCsrO1xuXHRcdFx0fVxuXG5cdFx0XHR2YXIgbWF0Y2ggPSBldmVudC5tYXRjaCggL14oW1xcdzotXSopXFxzKiguKikkLyApO1xuXHRcdFx0dmFyIGV2ZW50TmFtZSA9IG1hdGNoWyAxIF0gKyBpbnN0YW5jZS5ldmVudE5hbWVzcGFjZTtcblx0XHRcdHZhciBzZWxlY3RvciA9IG1hdGNoWyAyIF07XG5cblx0XHRcdGlmICggc2VsZWN0b3IgKSB7XG5cdFx0XHRcdGRlbGVnYXRlRWxlbWVudC5vbiggZXZlbnROYW1lLCBzZWxlY3RvciwgaGFuZGxlclByb3h5ICk7XG5cdFx0XHR9IGVsc2Uge1xuXHRcdFx0XHRlbGVtZW50Lm9uKCBldmVudE5hbWUsIGhhbmRsZXJQcm94eSApO1xuXHRcdFx0fVxuXHRcdH0gKTtcblx0fSxcblxuXHRfb2ZmOiBmdW5jdGlvbiggZWxlbWVudCwgZXZlbnROYW1lICkge1xuXHRcdGV2ZW50TmFtZSA9ICggZXZlbnROYW1lIHx8IFwiXCIgKS5zcGxpdCggXCIgXCIgKS5qb2luKCB0aGlzLmV2ZW50TmFtZXNwYWNlICsgXCIgXCIgKSArXG5cdFx0XHR0aGlzLmV2ZW50TmFtZXNwYWNlO1xuXHRcdGVsZW1lbnQub2ZmKCBldmVudE5hbWUgKS5vZmYoIGV2ZW50TmFtZSApO1xuXG5cdFx0Ly8gQ2xlYXIgdGhlIHN0YWNrIHRvIGF2b2lkIG1lbW9yeSBsZWFrcyAoIzEwMDU2KVxuXHRcdHRoaXMuYmluZGluZ3MgPSAkKCB0aGlzLmJpbmRpbmdzLm5vdCggZWxlbWVudCApLmdldCgpICk7XG5cdFx0dGhpcy5mb2N1c2FibGUgPSAkKCB0aGlzLmZvY3VzYWJsZS5ub3QoIGVsZW1lbnQgKS5nZXQoKSApO1xuXHRcdHRoaXMuaG92ZXJhYmxlID0gJCggdGhpcy5ob3ZlcmFibGUubm90KCBlbGVtZW50ICkuZ2V0KCkgKTtcblx0fSxcblxuXHRfZGVsYXk6IGZ1bmN0aW9uKCBoYW5kbGVyLCBkZWxheSApIHtcblx0XHRmdW5jdGlvbiBoYW5kbGVyUHJveHkoKSB7XG5cdFx0XHRyZXR1cm4gKCB0eXBlb2YgaGFuZGxlciA9PT0gXCJzdHJpbmdcIiA/IGluc3RhbmNlWyBoYW5kbGVyIF0gOiBoYW5kbGVyIClcblx0XHRcdFx0LmFwcGx5KCBpbnN0YW5jZSwgYXJndW1lbnRzICk7XG5cdFx0fVxuXHRcdHZhciBpbnN0YW5jZSA9IHRoaXM7XG5cdFx0cmV0dXJuIHNldFRpbWVvdXQoIGhhbmRsZXJQcm94eSwgZGVsYXkgfHwgMCApO1xuXHR9LFxuXG5cdF9ob3ZlcmFibGU6IGZ1bmN0aW9uKCBlbGVtZW50ICkge1xuXHRcdHRoaXMuaG92ZXJhYmxlID0gdGhpcy5ob3ZlcmFibGUuYWRkKCBlbGVtZW50ICk7XG5cdFx0dGhpcy5fb24oIGVsZW1lbnQsIHtcblx0XHRcdG1vdXNlZW50ZXI6IGZ1bmN0aW9uKCBldmVudCApIHtcblx0XHRcdFx0dGhpcy5fYWRkQ2xhc3MoICQoIGV2ZW50LmN1cnJlbnRUYXJnZXQgKSwgbnVsbCwgXCJ1aS1zdGF0ZS1ob3ZlclwiICk7XG5cdFx0XHR9LFxuXHRcdFx0bW91c2VsZWF2ZTogZnVuY3Rpb24oIGV2ZW50ICkge1xuXHRcdFx0XHR0aGlzLl9yZW1vdmVDbGFzcyggJCggZXZlbnQuY3VycmVudFRhcmdldCApLCBudWxsLCBcInVpLXN0YXRlLWhvdmVyXCIgKTtcblx0XHRcdH1cblx0XHR9ICk7XG5cdH0sXG5cblx0X2ZvY3VzYWJsZTogZnVuY3Rpb24oIGVsZW1lbnQgKSB7XG5cdFx0dGhpcy5mb2N1c2FibGUgPSB0aGlzLmZvY3VzYWJsZS5hZGQoIGVsZW1lbnQgKTtcblx0XHR0aGlzLl9vbiggZWxlbWVudCwge1xuXHRcdFx0Zm9jdXNpbjogZnVuY3Rpb24oIGV2ZW50ICkge1xuXHRcdFx0XHR0aGlzLl9hZGRDbGFzcyggJCggZXZlbnQuY3VycmVudFRhcmdldCApLCBudWxsLCBcInVpLXN0YXRlLWZvY3VzXCIgKTtcblx0XHRcdH0sXG5cdFx0XHRmb2N1c291dDogZnVuY3Rpb24oIGV2ZW50ICkge1xuXHRcdFx0XHR0aGlzLl9yZW1vdmVDbGFzcyggJCggZXZlbnQuY3VycmVudFRhcmdldCApLCBudWxsLCBcInVpLXN0YXRlLWZvY3VzXCIgKTtcblx0XHRcdH1cblx0XHR9ICk7XG5cdH0sXG5cblx0X3RyaWdnZXI6IGZ1bmN0aW9uKCB0eXBlLCBldmVudCwgZGF0YSApIHtcblx0XHR2YXIgcHJvcCwgb3JpZztcblx0XHR2YXIgY2FsbGJhY2sgPSB0aGlzLm9wdGlvbnNbIHR5cGUgXTtcblxuXHRcdGRhdGEgPSBkYXRhIHx8IHt9O1xuXHRcdGV2ZW50ID0gJC5FdmVudCggZXZlbnQgKTtcblx0XHRldmVudC50eXBlID0gKCB0eXBlID09PSB0aGlzLndpZGdldEV2ZW50UHJlZml4ID9cblx0XHRcdHR5cGUgOlxuXHRcdFx0dGhpcy53aWRnZXRFdmVudFByZWZpeCArIHR5cGUgKS50b0xvd2VyQ2FzZSgpO1xuXG5cdFx0Ly8gVGhlIG9yaWdpbmFsIGV2ZW50IG1heSBjb21lIGZyb20gYW55IGVsZW1lbnRcblx0XHQvLyBzbyB3ZSBuZWVkIHRvIHJlc2V0IHRoZSB0YXJnZXQgb24gdGhlIG5ldyBldmVudFxuXHRcdGV2ZW50LnRhcmdldCA9IHRoaXMuZWxlbWVudFsgMCBdO1xuXG5cdFx0Ly8gQ29weSBvcmlnaW5hbCBldmVudCBwcm9wZXJ0aWVzIG92ZXIgdG8gdGhlIG5ldyBldmVudFxuXHRcdG9yaWcgPSBldmVudC5vcmlnaW5hbEV2ZW50O1xuXHRcdGlmICggb3JpZyApIHtcblx0XHRcdGZvciAoIHByb3AgaW4gb3JpZyApIHtcblx0XHRcdFx0aWYgKCAhKCBwcm9wIGluIGV2ZW50ICkgKSB7XG5cdFx0XHRcdFx0ZXZlbnRbIHByb3AgXSA9IG9yaWdbIHByb3AgXTtcblx0XHRcdFx0fVxuXHRcdFx0fVxuXHRcdH1cblxuXHRcdHRoaXMuZWxlbWVudC50cmlnZ2VyKCBldmVudCwgZGF0YSApO1xuXHRcdHJldHVybiAhKCAkLmlzRnVuY3Rpb24oIGNhbGxiYWNrICkgJiZcblx0XHRcdGNhbGxiYWNrLmFwcGx5KCB0aGlzLmVsZW1lbnRbIDAgXSwgWyBldmVudCBdLmNvbmNhdCggZGF0YSApICkgPT09IGZhbHNlIHx8XG5cdFx0XHRldmVudC5pc0RlZmF1bHRQcmV2ZW50ZWQoKSApO1xuXHR9XG59O1xuXG4kLmVhY2goIHsgc2hvdzogXCJmYWRlSW5cIiwgaGlkZTogXCJmYWRlT3V0XCIgfSwgZnVuY3Rpb24oIG1ldGhvZCwgZGVmYXVsdEVmZmVjdCApIHtcblx0JC5XaWRnZXQucHJvdG90eXBlWyBcIl9cIiArIG1ldGhvZCBdID0gZnVuY3Rpb24oIGVsZW1lbnQsIG9wdGlvbnMsIGNhbGxiYWNrICkge1xuXHRcdGlmICggdHlwZW9mIG9wdGlvbnMgPT09IFwic3RyaW5nXCIgKSB7XG5cdFx0XHRvcHRpb25zID0geyBlZmZlY3Q6IG9wdGlvbnMgfTtcblx0XHR9XG5cblx0XHR2YXIgaGFzT3B0aW9ucztcblx0XHR2YXIgZWZmZWN0TmFtZSA9ICFvcHRpb25zID9cblx0XHRcdG1ldGhvZCA6XG5cdFx0XHRvcHRpb25zID09PSB0cnVlIHx8IHR5cGVvZiBvcHRpb25zID09PSBcIm51bWJlclwiID9cblx0XHRcdFx0ZGVmYXVsdEVmZmVjdCA6XG5cdFx0XHRcdG9wdGlvbnMuZWZmZWN0IHx8IGRlZmF1bHRFZmZlY3Q7XG5cblx0XHRvcHRpb25zID0gb3B0aW9ucyB8fCB7fTtcblx0XHRpZiAoIHR5cGVvZiBvcHRpb25zID09PSBcIm51bWJlclwiICkge1xuXHRcdFx0b3B0aW9ucyA9IHsgZHVyYXRpb246IG9wdGlvbnMgfTtcblx0XHR9XG5cblx0XHRoYXNPcHRpb25zID0gISQuaXNFbXB0eU9iamVjdCggb3B0aW9ucyApO1xuXHRcdG9wdGlvbnMuY29tcGxldGUgPSBjYWxsYmFjaztcblxuXHRcdGlmICggb3B0aW9ucy5kZWxheSApIHtcblx0XHRcdGVsZW1lbnQuZGVsYXkoIG9wdGlvbnMuZGVsYXkgKTtcblx0XHR9XG5cblx0XHRpZiAoIGhhc09wdGlvbnMgJiYgJC5lZmZlY3RzICYmICQuZWZmZWN0cy5lZmZlY3RbIGVmZmVjdE5hbWUgXSApIHtcblx0XHRcdGVsZW1lbnRbIG1ldGhvZCBdKCBvcHRpb25zICk7XG5cdFx0fSBlbHNlIGlmICggZWZmZWN0TmFtZSAhPT0gbWV0aG9kICYmIGVsZW1lbnRbIGVmZmVjdE5hbWUgXSApIHtcblx0XHRcdGVsZW1lbnRbIGVmZmVjdE5hbWUgXSggb3B0aW9ucy5kdXJhdGlvbiwgb3B0aW9ucy5lYXNpbmcsIGNhbGxiYWNrICk7XG5cdFx0fSBlbHNlIHtcblx0XHRcdGVsZW1lbnQucXVldWUoIGZ1bmN0aW9uKCBuZXh0ICkge1xuXHRcdFx0XHQkKCB0aGlzIClbIG1ldGhvZCBdKCk7XG5cdFx0XHRcdGlmICggY2FsbGJhY2sgKSB7XG5cdFx0XHRcdFx0Y2FsbGJhY2suY2FsbCggZWxlbWVudFsgMCBdICk7XG5cdFx0XHRcdH1cblx0XHRcdFx0bmV4dCgpO1xuXHRcdFx0fSApO1xuXHRcdH1cblx0fTtcbn0gKTtcblxucmV0dXJuICQud2lkZ2V0O1xuXG59ICkgKTtcbiIsIi8qIVxuICogalF1ZXJ5IFVJIEF1dG9jb21wbGV0ZSAxLjEyLjFcbiAqIGh0dHA6Ly9qcXVlcnl1aS5jb21cbiAqXG4gKiBDb3B5cmlnaHQgalF1ZXJ5IEZvdW5kYXRpb24gYW5kIG90aGVyIGNvbnRyaWJ1dG9yc1xuICogUmVsZWFzZWQgdW5kZXIgdGhlIE1JVCBsaWNlbnNlLlxuICogaHR0cDovL2pxdWVyeS5vcmcvbGljZW5zZVxuICovXG5cbi8vPj5sYWJlbDogQXV0b2NvbXBsZXRlXG4vLz4+Z3JvdXA6IFdpZGdldHNcbi8vPj5kZXNjcmlwdGlvbjogTGlzdHMgc3VnZ2VzdGVkIHdvcmRzIGFzIHRoZSB1c2VyIGlzIHR5cGluZy5cbi8vPj5kb2NzOiBodHRwOi8vYXBpLmpxdWVyeXVpLmNvbS9hdXRvY29tcGxldGUvXG4vLz4+ZGVtb3M6IGh0dHA6Ly9qcXVlcnl1aS5jb20vYXV0b2NvbXBsZXRlL1xuLy8+PmNzcy5zdHJ1Y3R1cmU6IC4uLy4uL3RoZW1lcy9iYXNlL2NvcmUuY3NzXG4vLz4+Y3NzLnN0cnVjdHVyZTogLi4vLi4vdGhlbWVzL2Jhc2UvYXV0b2NvbXBsZXRlLmNzc1xuLy8+PmNzcy50aGVtZTogLi4vLi4vdGhlbWVzL2Jhc2UvdGhlbWUuY3NzXG5cbiggZnVuY3Rpb24oIGZhY3RvcnkgKSB7XG5cdGlmICggdHlwZW9mIGRlZmluZSA9PT0gXCJmdW5jdGlvblwiICYmIGRlZmluZS5hbWQgKSB7XG5cblx0XHQvLyBBTUQuIFJlZ2lzdGVyIGFzIGFuIGFub255bW91cyBtb2R1bGUuXG5cdFx0ZGVmaW5lKCBbXG5cdFx0XHRcImpxdWVyeVwiLFxuXHRcdFx0XCIuL21lbnVcIixcblx0XHRcdFwiLi4va2V5Y29kZVwiLFxuXHRcdFx0XCIuLi9wb3NpdGlvblwiLFxuXHRcdFx0XCIuLi9zYWZlLWFjdGl2ZS1lbGVtZW50XCIsXG5cdFx0XHRcIi4uL3ZlcnNpb25cIixcblx0XHRcdFwiLi4vd2lkZ2V0XCJcblx0XHRdLCBmYWN0b3J5ICk7XG5cdH0gZWxzZSB7XG5cblx0XHQvLyBCcm93c2VyIGdsb2JhbHNcblx0XHRmYWN0b3J5KCBqUXVlcnkgKTtcblx0fVxufSggZnVuY3Rpb24oICQgKSB7XG5cbiQud2lkZ2V0KCBcInVpLmF1dG9jb21wbGV0ZVwiLCB7XG5cdHZlcnNpb246IFwiMS4xMi4xXCIsXG5cdGRlZmF1bHRFbGVtZW50OiBcIjxpbnB1dD5cIixcblx0b3B0aW9uczoge1xuXHRcdGFwcGVuZFRvOiBudWxsLFxuXHRcdGF1dG9Gb2N1czogZmFsc2UsXG5cdFx0ZGVsYXk6IDMwMCxcblx0XHRtaW5MZW5ndGg6IDEsXG5cdFx0cG9zaXRpb246IHtcblx0XHRcdG15OiBcImxlZnQgdG9wXCIsXG5cdFx0XHRhdDogXCJsZWZ0IGJvdHRvbVwiLFxuXHRcdFx0Y29sbGlzaW9uOiBcIm5vbmVcIlxuXHRcdH0sXG5cdFx0c291cmNlOiBudWxsLFxuXG5cdFx0Ly8gQ2FsbGJhY2tzXG5cdFx0Y2hhbmdlOiBudWxsLFxuXHRcdGNsb3NlOiBudWxsLFxuXHRcdGZvY3VzOiBudWxsLFxuXHRcdG9wZW46IG51bGwsXG5cdFx0cmVzcG9uc2U6IG51bGwsXG5cdFx0c2VhcmNoOiBudWxsLFxuXHRcdHNlbGVjdDogbnVsbFxuXHR9LFxuXG5cdHJlcXVlc3RJbmRleDogMCxcblx0cGVuZGluZzogMCxcblxuXHRfY3JlYXRlOiBmdW5jdGlvbigpIHtcblxuXHRcdC8vIFNvbWUgYnJvd3NlcnMgb25seSByZXBlYXQga2V5ZG93biBldmVudHMsIG5vdCBrZXlwcmVzcyBldmVudHMsXG5cdFx0Ly8gc28gd2UgdXNlIHRoZSBzdXBwcmVzc0tleVByZXNzIGZsYWcgdG8gZGV0ZXJtaW5lIGlmIHdlJ3ZlIGFscmVhZHlcblx0XHQvLyBoYW5kbGVkIHRoZSBrZXlkb3duIGV2ZW50LiAjNzI2OVxuXHRcdC8vIFVuZm9ydHVuYXRlbHkgdGhlIGNvZGUgZm9yICYgaW4ga2V5cHJlc3MgaXMgdGhlIHNhbWUgYXMgdGhlIHVwIGFycm93LFxuXHRcdC8vIHNvIHdlIHVzZSB0aGUgc3VwcHJlc3NLZXlQcmVzc1JlcGVhdCBmbGFnIHRvIGF2b2lkIGhhbmRsaW5nIGtleXByZXNzXG5cdFx0Ly8gZXZlbnRzIHdoZW4gd2Uga25vdyB0aGUga2V5ZG93biBldmVudCB3YXMgdXNlZCB0byBtb2RpZnkgdGhlXG5cdFx0Ly8gc2VhcmNoIHRlcm0uICM3Nzk5XG5cdFx0dmFyIHN1cHByZXNzS2V5UHJlc3MsIHN1cHByZXNzS2V5UHJlc3NSZXBlYXQsIHN1cHByZXNzSW5wdXQsXG5cdFx0XHRub2RlTmFtZSA9IHRoaXMuZWxlbWVudFsgMCBdLm5vZGVOYW1lLnRvTG93ZXJDYXNlKCksXG5cdFx0XHRpc1RleHRhcmVhID0gbm9kZU5hbWUgPT09IFwidGV4dGFyZWFcIixcblx0XHRcdGlzSW5wdXQgPSBub2RlTmFtZSA9PT0gXCJpbnB1dFwiO1xuXG5cdFx0Ly8gVGV4dGFyZWFzIGFyZSBhbHdheXMgbXVsdGktbGluZVxuXHRcdC8vIElucHV0cyBhcmUgYWx3YXlzIHNpbmdsZS1saW5lLCBldmVuIGlmIGluc2lkZSBhIGNvbnRlbnRFZGl0YWJsZSBlbGVtZW50XG5cdFx0Ly8gSUUgYWxzbyB0cmVhdHMgaW5wdXRzIGFzIGNvbnRlbnRFZGl0YWJsZVxuXHRcdC8vIEFsbCBvdGhlciBlbGVtZW50IHR5cGVzIGFyZSBkZXRlcm1pbmVkIGJ5IHdoZXRoZXIgb3Igbm90IHRoZXkncmUgY29udGVudEVkaXRhYmxlXG5cdFx0dGhpcy5pc011bHRpTGluZSA9IGlzVGV4dGFyZWEgfHwgIWlzSW5wdXQgJiYgdGhpcy5faXNDb250ZW50RWRpdGFibGUoIHRoaXMuZWxlbWVudCApO1xuXG5cdFx0dGhpcy52YWx1ZU1ldGhvZCA9IHRoaXMuZWxlbWVudFsgaXNUZXh0YXJlYSB8fCBpc0lucHV0ID8gXCJ2YWxcIiA6IFwidGV4dFwiIF07XG5cdFx0dGhpcy5pc05ld01lbnUgPSB0cnVlO1xuXG5cdFx0dGhpcy5fYWRkQ2xhc3MoIFwidWktYXV0b2NvbXBsZXRlLWlucHV0XCIgKTtcblx0XHR0aGlzLmVsZW1lbnQuYXR0ciggXCJhdXRvY29tcGxldGVcIiwgXCJvZmZcIiApO1xuXG5cdFx0dGhpcy5fb24oIHRoaXMuZWxlbWVudCwge1xuXHRcdFx0a2V5ZG93bjogZnVuY3Rpb24oIGV2ZW50ICkge1xuXHRcdFx0XHRpZiAoIHRoaXMuZWxlbWVudC5wcm9wKCBcInJlYWRPbmx5XCIgKSApIHtcblx0XHRcdFx0XHRzdXBwcmVzc0tleVByZXNzID0gdHJ1ZTtcblx0XHRcdFx0XHRzdXBwcmVzc0lucHV0ID0gdHJ1ZTtcblx0XHRcdFx0XHRzdXBwcmVzc0tleVByZXNzUmVwZWF0ID0gdHJ1ZTtcblx0XHRcdFx0XHRyZXR1cm47XG5cdFx0XHRcdH1cblxuXHRcdFx0XHRzdXBwcmVzc0tleVByZXNzID0gZmFsc2U7XG5cdFx0XHRcdHN1cHByZXNzSW5wdXQgPSBmYWxzZTtcblx0XHRcdFx0c3VwcHJlc3NLZXlQcmVzc1JlcGVhdCA9IGZhbHNlO1xuXHRcdFx0XHR2YXIga2V5Q29kZSA9ICQudWkua2V5Q29kZTtcblx0XHRcdFx0c3dpdGNoICggZXZlbnQua2V5Q29kZSApIHtcblx0XHRcdFx0Y2FzZSBrZXlDb2RlLlBBR0VfVVA6XG5cdFx0XHRcdFx0c3VwcHJlc3NLZXlQcmVzcyA9IHRydWU7XG5cdFx0XHRcdFx0dGhpcy5fbW92ZSggXCJwcmV2aW91c1BhZ2VcIiwgZXZlbnQgKTtcblx0XHRcdFx0XHRicmVhaztcblx0XHRcdFx0Y2FzZSBrZXlDb2RlLlBBR0VfRE9XTjpcblx0XHRcdFx0XHRzdXBwcmVzc0tleVByZXNzID0gdHJ1ZTtcblx0XHRcdFx0XHR0aGlzLl9tb3ZlKCBcIm5leHRQYWdlXCIsIGV2ZW50ICk7XG5cdFx0XHRcdFx0YnJlYWs7XG5cdFx0XHRcdGNhc2Uga2V5Q29kZS5VUDpcblx0XHRcdFx0XHRzdXBwcmVzc0tleVByZXNzID0gdHJ1ZTtcblx0XHRcdFx0XHR0aGlzLl9rZXlFdmVudCggXCJwcmV2aW91c1wiLCBldmVudCApO1xuXHRcdFx0XHRcdGJyZWFrO1xuXHRcdFx0XHRjYXNlIGtleUNvZGUuRE9XTjpcblx0XHRcdFx0XHRzdXBwcmVzc0tleVByZXNzID0gdHJ1ZTtcblx0XHRcdFx0XHR0aGlzLl9rZXlFdmVudCggXCJuZXh0XCIsIGV2ZW50ICk7XG5cdFx0XHRcdFx0YnJlYWs7XG5cdFx0XHRcdGNhc2Uga2V5Q29kZS5FTlRFUjpcblxuXHRcdFx0XHRcdC8vIHdoZW4gbWVudSBpcyBvcGVuIGFuZCBoYXMgZm9jdXNcblx0XHRcdFx0XHRpZiAoIHRoaXMubWVudS5hY3RpdmUgKSB7XG5cblx0XHRcdFx0XHRcdC8vICM2MDU1IC0gT3BlcmEgc3RpbGwgYWxsb3dzIHRoZSBrZXlwcmVzcyB0byBvY2N1clxuXHRcdFx0XHRcdFx0Ly8gd2hpY2ggY2F1c2VzIGZvcm1zIHRvIHN1Ym1pdFxuXHRcdFx0XHRcdFx0c3VwcHJlc3NLZXlQcmVzcyA9IHRydWU7XG5cdFx0XHRcdFx0XHRldmVudC5wcmV2ZW50RGVmYXVsdCgpO1xuXHRcdFx0XHRcdFx0dGhpcy5tZW51LnNlbGVjdCggZXZlbnQgKTtcblx0XHRcdFx0XHR9XG5cdFx0XHRcdFx0YnJlYWs7XG5cdFx0XHRcdGNhc2Uga2V5Q29kZS5UQUI6XG5cdFx0XHRcdFx0aWYgKCB0aGlzLm1lbnUuYWN0aXZlICkge1xuXHRcdFx0XHRcdFx0dGhpcy5tZW51LnNlbGVjdCggZXZlbnQgKTtcblx0XHRcdFx0XHR9XG5cdFx0XHRcdFx0YnJlYWs7XG5cdFx0XHRcdGNhc2Uga2V5Q29kZS5FU0NBUEU6XG5cdFx0XHRcdFx0aWYgKCB0aGlzLm1lbnUuZWxlbWVudC5pcyggXCI6dmlzaWJsZVwiICkgKSB7XG5cdFx0XHRcdFx0XHRpZiAoICF0aGlzLmlzTXVsdGlMaW5lICkge1xuXHRcdFx0XHRcdFx0XHR0aGlzLl92YWx1ZSggdGhpcy50ZXJtICk7XG5cdFx0XHRcdFx0XHR9XG5cdFx0XHRcdFx0XHR0aGlzLmNsb3NlKCBldmVudCApO1xuXG5cdFx0XHRcdFx0XHQvLyBEaWZmZXJlbnQgYnJvd3NlcnMgaGF2ZSBkaWZmZXJlbnQgZGVmYXVsdCBiZWhhdmlvciBmb3IgZXNjYXBlXG5cdFx0XHRcdFx0XHQvLyBTaW5nbGUgcHJlc3MgY2FuIG1lYW4gdW5kbyBvciBjbGVhclxuXHRcdFx0XHRcdFx0Ly8gRG91YmxlIHByZXNzIGluIElFIG1lYW5zIGNsZWFyIHRoZSB3aG9sZSBmb3JtXG5cdFx0XHRcdFx0XHRldmVudC5wcmV2ZW50RGVmYXVsdCgpO1xuXHRcdFx0XHRcdH1cblx0XHRcdFx0XHRicmVhaztcblx0XHRcdFx0ZGVmYXVsdDpcblx0XHRcdFx0XHRzdXBwcmVzc0tleVByZXNzUmVwZWF0ID0gdHJ1ZTtcblxuXHRcdFx0XHRcdC8vIHNlYXJjaCB0aW1lb3V0IHNob3VsZCBiZSB0cmlnZ2VyZWQgYmVmb3JlIHRoZSBpbnB1dCB2YWx1ZSBpcyBjaGFuZ2VkXG5cdFx0XHRcdFx0dGhpcy5fc2VhcmNoVGltZW91dCggZXZlbnQgKTtcblx0XHRcdFx0XHRicmVhaztcblx0XHRcdFx0fVxuXHRcdFx0fSxcblx0XHRcdGtleXByZXNzOiBmdW5jdGlvbiggZXZlbnQgKSB7XG5cdFx0XHRcdGlmICggc3VwcHJlc3NLZXlQcmVzcyApIHtcblx0XHRcdFx0XHRzdXBwcmVzc0tleVByZXNzID0gZmFsc2U7XG5cdFx0XHRcdFx0aWYgKCAhdGhpcy5pc011bHRpTGluZSB8fCB0aGlzLm1lbnUuZWxlbWVudC5pcyggXCI6dmlzaWJsZVwiICkgKSB7XG5cdFx0XHRcdFx0XHRldmVudC5wcmV2ZW50RGVmYXVsdCgpO1xuXHRcdFx0XHRcdH1cblx0XHRcdFx0XHRyZXR1cm47XG5cdFx0XHRcdH1cblx0XHRcdFx0aWYgKCBzdXBwcmVzc0tleVByZXNzUmVwZWF0ICkge1xuXHRcdFx0XHRcdHJldHVybjtcblx0XHRcdFx0fVxuXG5cdFx0XHRcdC8vIFJlcGxpY2F0ZSBzb21lIGtleSBoYW5kbGVycyB0byBhbGxvdyB0aGVtIHRvIHJlcGVhdCBpbiBGaXJlZm94IGFuZCBPcGVyYVxuXHRcdFx0XHR2YXIga2V5Q29kZSA9ICQudWkua2V5Q29kZTtcblx0XHRcdFx0c3dpdGNoICggZXZlbnQua2V5Q29kZSApIHtcblx0XHRcdFx0Y2FzZSBrZXlDb2RlLlBBR0VfVVA6XG5cdFx0XHRcdFx0dGhpcy5fbW92ZSggXCJwcmV2aW91c1BhZ2VcIiwgZXZlbnQgKTtcblx0XHRcdFx0XHRicmVhaztcblx0XHRcdFx0Y2FzZSBrZXlDb2RlLlBBR0VfRE9XTjpcblx0XHRcdFx0XHR0aGlzLl9tb3ZlKCBcIm5leHRQYWdlXCIsIGV2ZW50ICk7XG5cdFx0XHRcdFx0YnJlYWs7XG5cdFx0XHRcdGNhc2Uga2V5Q29kZS5VUDpcblx0XHRcdFx0XHR0aGlzLl9rZXlFdmVudCggXCJwcmV2aW91c1wiLCBldmVudCApO1xuXHRcdFx0XHRcdGJyZWFrO1xuXHRcdFx0XHRjYXNlIGtleUNvZGUuRE9XTjpcblx0XHRcdFx0XHR0aGlzLl9rZXlFdmVudCggXCJuZXh0XCIsIGV2ZW50ICk7XG5cdFx0XHRcdFx0YnJlYWs7XG5cdFx0XHRcdH1cblx0XHRcdH0sXG5cdFx0XHRpbnB1dDogZnVuY3Rpb24oIGV2ZW50ICkge1xuXHRcdFx0XHRpZiAoIHN1cHByZXNzSW5wdXQgKSB7XG5cdFx0XHRcdFx0c3VwcHJlc3NJbnB1dCA9IGZhbHNlO1xuXHRcdFx0XHRcdGV2ZW50LnByZXZlbnREZWZhdWx0KCk7XG5cdFx0XHRcdFx0cmV0dXJuO1xuXHRcdFx0XHR9XG5cdFx0XHRcdHRoaXMuX3NlYXJjaFRpbWVvdXQoIGV2ZW50ICk7XG5cdFx0XHR9LFxuXHRcdFx0Zm9jdXM6IGZ1bmN0aW9uKCkge1xuXHRcdFx0XHR0aGlzLnNlbGVjdGVkSXRlbSA9IG51bGw7XG5cdFx0XHRcdHRoaXMucHJldmlvdXMgPSB0aGlzLl92YWx1ZSgpO1xuXHRcdFx0fSxcblx0XHRcdGJsdXI6IGZ1bmN0aW9uKCBldmVudCApIHtcblx0XHRcdFx0aWYgKCB0aGlzLmNhbmNlbEJsdXIgKSB7XG5cdFx0XHRcdFx0ZGVsZXRlIHRoaXMuY2FuY2VsQmx1cjtcblx0XHRcdFx0XHRyZXR1cm47XG5cdFx0XHRcdH1cblxuXHRcdFx0XHRjbGVhclRpbWVvdXQoIHRoaXMuc2VhcmNoaW5nICk7XG5cdFx0XHRcdHRoaXMuY2xvc2UoIGV2ZW50ICk7XG5cdFx0XHRcdHRoaXMuX2NoYW5nZSggZXZlbnQgKTtcblx0XHRcdH1cblx0XHR9ICk7XG5cblx0XHR0aGlzLl9pbml0U291cmNlKCk7XG5cdFx0dGhpcy5tZW51ID0gJCggXCI8dWw+XCIgKVxuXHRcdFx0LmFwcGVuZFRvKCB0aGlzLl9hcHBlbmRUbygpIClcblx0XHRcdC5tZW51KCB7XG5cblx0XHRcdFx0Ly8gZGlzYWJsZSBBUklBIHN1cHBvcnQsIHRoZSBsaXZlIHJlZ2lvbiB0YWtlcyBjYXJlIG9mIHRoYXRcblx0XHRcdFx0cm9sZTogbnVsbFxuXHRcdFx0fSApXG5cdFx0XHQuaGlkZSgpXG5cdFx0XHQubWVudSggXCJpbnN0YW5jZVwiICk7XG5cblx0XHR0aGlzLl9hZGRDbGFzcyggdGhpcy5tZW51LmVsZW1lbnQsIFwidWktYXV0b2NvbXBsZXRlXCIsIFwidWktZnJvbnRcIiApO1xuXHRcdHRoaXMuX29uKCB0aGlzLm1lbnUuZWxlbWVudCwge1xuXHRcdFx0bW91c2Vkb3duOiBmdW5jdGlvbiggZXZlbnQgKSB7XG5cblx0XHRcdFx0Ly8gcHJldmVudCBtb3ZpbmcgZm9jdXMgb3V0IG9mIHRoZSB0ZXh0IGZpZWxkXG5cdFx0XHRcdGV2ZW50LnByZXZlbnREZWZhdWx0KCk7XG5cblx0XHRcdFx0Ly8gSUUgZG9lc24ndCBwcmV2ZW50IG1vdmluZyBmb2N1cyBldmVuIHdpdGggZXZlbnQucHJldmVudERlZmF1bHQoKVxuXHRcdFx0XHQvLyBzbyB3ZSBzZXQgYSBmbGFnIHRvIGtub3cgd2hlbiB3ZSBzaG91bGQgaWdub3JlIHRoZSBibHVyIGV2ZW50XG5cdFx0XHRcdHRoaXMuY2FuY2VsQmx1ciA9IHRydWU7XG5cdFx0XHRcdHRoaXMuX2RlbGF5KCBmdW5jdGlvbigpIHtcblx0XHRcdFx0XHRkZWxldGUgdGhpcy5jYW5jZWxCbHVyO1xuXG5cdFx0XHRcdFx0Ly8gU3VwcG9ydDogSUUgOCBvbmx5XG5cdFx0XHRcdFx0Ly8gUmlnaHQgY2xpY2tpbmcgYSBtZW51IGl0ZW0gb3Igc2VsZWN0aW5nIHRleHQgZnJvbSB0aGUgbWVudSBpdGVtcyB3aWxsXG5cdFx0XHRcdFx0Ly8gcmVzdWx0IGluIGZvY3VzIG1vdmluZyBvdXQgb2YgdGhlIGlucHV0LiBIb3dldmVyLCB3ZSd2ZSBhbHJlYWR5IHJlY2VpdmVkXG5cdFx0XHRcdFx0Ly8gYW5kIGlnbm9yZWQgdGhlIGJsdXIgZXZlbnQgYmVjYXVzZSBvZiB0aGUgY2FuY2VsQmx1ciBmbGFnIHNldCBhYm92ZS4gU29cblx0XHRcdFx0XHQvLyB3ZSByZXN0b3JlIGZvY3VzIHRvIGVuc3VyZSB0aGF0IHRoZSBtZW51IGNsb3NlcyBwcm9wZXJseSBiYXNlZCBvbiB0aGUgdXNlcidzXG5cdFx0XHRcdFx0Ly8gbmV4dCBhY3Rpb25zLlxuXHRcdFx0XHRcdGlmICggdGhpcy5lbGVtZW50WyAwIF0gIT09ICQudWkuc2FmZUFjdGl2ZUVsZW1lbnQoIHRoaXMuZG9jdW1lbnRbIDAgXSApICkge1xuXHRcdFx0XHRcdFx0dGhpcy5lbGVtZW50LnRyaWdnZXIoIFwiZm9jdXNcIiApO1xuXHRcdFx0XHRcdH1cblx0XHRcdFx0fSApO1xuXHRcdFx0fSxcblx0XHRcdG1lbnVmb2N1czogZnVuY3Rpb24oIGV2ZW50LCB1aSApIHtcblx0XHRcdFx0dmFyIGxhYmVsLCBpdGVtO1xuXG5cdFx0XHRcdC8vIHN1cHBvcnQ6IEZpcmVmb3hcblx0XHRcdFx0Ly8gUHJldmVudCBhY2NpZGVudGFsIGFjdGl2YXRpb24gb2YgbWVudSBpdGVtcyBpbiBGaXJlZm94ICgjNzAyNCAjOTExOClcblx0XHRcdFx0aWYgKCB0aGlzLmlzTmV3TWVudSApIHtcblx0XHRcdFx0XHR0aGlzLmlzTmV3TWVudSA9IGZhbHNlO1xuXHRcdFx0XHRcdGlmICggZXZlbnQub3JpZ2luYWxFdmVudCAmJiAvXm1vdXNlLy50ZXN0KCBldmVudC5vcmlnaW5hbEV2ZW50LnR5cGUgKSApIHtcblx0XHRcdFx0XHRcdHRoaXMubWVudS5ibHVyKCk7XG5cblx0XHRcdFx0XHRcdHRoaXMuZG9jdW1lbnQub25lKCBcIm1vdXNlbW92ZVwiLCBmdW5jdGlvbigpIHtcblx0XHRcdFx0XHRcdFx0JCggZXZlbnQudGFyZ2V0ICkudHJpZ2dlciggZXZlbnQub3JpZ2luYWxFdmVudCApO1xuXHRcdFx0XHRcdFx0fSApO1xuXG5cdFx0XHRcdFx0XHRyZXR1cm47XG5cdFx0XHRcdFx0fVxuXHRcdFx0XHR9XG5cblx0XHRcdFx0aXRlbSA9IHVpLml0ZW0uZGF0YSggXCJ1aS1hdXRvY29tcGxldGUtaXRlbVwiICk7XG5cdFx0XHRcdGlmICggZmFsc2UgIT09IHRoaXMuX3RyaWdnZXIoIFwiZm9jdXNcIiwgZXZlbnQsIHsgaXRlbTogaXRlbSB9ICkgKSB7XG5cblx0XHRcdFx0XHQvLyB1c2UgdmFsdWUgdG8gbWF0Y2ggd2hhdCB3aWxsIGVuZCB1cCBpbiB0aGUgaW5wdXQsIGlmIGl0IHdhcyBhIGtleSBldmVudFxuXHRcdFx0XHRcdGlmICggZXZlbnQub3JpZ2luYWxFdmVudCAmJiAvXmtleS8udGVzdCggZXZlbnQub3JpZ2luYWxFdmVudC50eXBlICkgKSB7XG5cdFx0XHRcdFx0XHR0aGlzLl92YWx1ZSggaXRlbS52YWx1ZSApO1xuXHRcdFx0XHRcdH1cblx0XHRcdFx0fVxuXG5cdFx0XHRcdC8vIEFubm91bmNlIHRoZSB2YWx1ZSBpbiB0aGUgbGl2ZVJlZ2lvblxuXHRcdFx0XHRsYWJlbCA9IHVpLml0ZW0uYXR0ciggXCJhcmlhLWxhYmVsXCIgKSB8fCBpdGVtLnZhbHVlO1xuXHRcdFx0XHRpZiAoIGxhYmVsICYmICQudHJpbSggbGFiZWwgKS5sZW5ndGggKSB7XG5cdFx0XHRcdFx0dGhpcy5saXZlUmVnaW9uLmNoaWxkcmVuKCkuaGlkZSgpO1xuXHRcdFx0XHRcdCQoIFwiPGRpdj5cIiApLnRleHQoIGxhYmVsICkuYXBwZW5kVG8oIHRoaXMubGl2ZVJlZ2lvbiApO1xuXHRcdFx0XHR9XG5cdFx0XHR9LFxuXHRcdFx0bWVudXNlbGVjdDogZnVuY3Rpb24oIGV2ZW50LCB1aSApIHtcblx0XHRcdFx0dmFyIGl0ZW0gPSB1aS5pdGVtLmRhdGEoIFwidWktYXV0b2NvbXBsZXRlLWl0ZW1cIiApLFxuXHRcdFx0XHRcdHByZXZpb3VzID0gdGhpcy5wcmV2aW91cztcblxuXHRcdFx0XHQvLyBPbmx5IHRyaWdnZXIgd2hlbiBmb2N1cyB3YXMgbG9zdCAoY2xpY2sgb24gbWVudSlcblx0XHRcdFx0aWYgKCB0aGlzLmVsZW1lbnRbIDAgXSAhPT0gJC51aS5zYWZlQWN0aXZlRWxlbWVudCggdGhpcy5kb2N1bWVudFsgMCBdICkgKSB7XG5cdFx0XHRcdFx0dGhpcy5lbGVtZW50LnRyaWdnZXIoIFwiZm9jdXNcIiApO1xuXHRcdFx0XHRcdHRoaXMucHJldmlvdXMgPSBwcmV2aW91cztcblxuXHRcdFx0XHRcdC8vICM2MTA5IC0gSUUgdHJpZ2dlcnMgdHdvIGZvY3VzIGV2ZW50cyBhbmQgdGhlIHNlY29uZFxuXHRcdFx0XHRcdC8vIGlzIGFzeW5jaHJvbm91cywgc28gd2UgbmVlZCB0byByZXNldCB0aGUgcHJldmlvdXNcblx0XHRcdFx0XHQvLyB0ZXJtIHN5bmNocm9ub3VzbHkgYW5kIGFzeW5jaHJvbm91c2x5IDotKFxuXHRcdFx0XHRcdHRoaXMuX2RlbGF5KCBmdW5jdGlvbigpIHtcblx0XHRcdFx0XHRcdHRoaXMucHJldmlvdXMgPSBwcmV2aW91cztcblx0XHRcdFx0XHRcdHRoaXMuc2VsZWN0ZWRJdGVtID0gaXRlbTtcblx0XHRcdFx0XHR9ICk7XG5cdFx0XHRcdH1cblxuXHRcdFx0XHRpZiAoIGZhbHNlICE9PSB0aGlzLl90cmlnZ2VyKCBcInNlbGVjdFwiLCBldmVudCwgeyBpdGVtOiBpdGVtIH0gKSApIHtcblx0XHRcdFx0XHR0aGlzLl92YWx1ZSggaXRlbS52YWx1ZSApO1xuXHRcdFx0XHR9XG5cblx0XHRcdFx0Ly8gcmVzZXQgdGhlIHRlcm0gYWZ0ZXIgdGhlIHNlbGVjdCBldmVudFxuXHRcdFx0XHQvLyB0aGlzIGFsbG93cyBjdXN0b20gc2VsZWN0IGhhbmRsaW5nIHRvIHdvcmsgcHJvcGVybHlcblx0XHRcdFx0dGhpcy50ZXJtID0gdGhpcy5fdmFsdWUoKTtcblxuXHRcdFx0XHR0aGlzLmNsb3NlKCBldmVudCApO1xuXHRcdFx0XHR0aGlzLnNlbGVjdGVkSXRlbSA9IGl0ZW07XG5cdFx0XHR9XG5cdFx0fSApO1xuXG5cdFx0dGhpcy5saXZlUmVnaW9uID0gJCggXCI8ZGl2PlwiLCB7XG5cdFx0XHRyb2xlOiBcInN0YXR1c1wiLFxuXHRcdFx0XCJhcmlhLWxpdmVcIjogXCJhc3NlcnRpdmVcIixcblx0XHRcdFwiYXJpYS1yZWxldmFudFwiOiBcImFkZGl0aW9uc1wiXG5cdFx0fSApXG5cdFx0XHQuYXBwZW5kVG8oIHRoaXMuZG9jdW1lbnRbIDAgXS5ib2R5ICk7XG5cblx0XHR0aGlzLl9hZGRDbGFzcyggdGhpcy5saXZlUmVnaW9uLCBudWxsLCBcInVpLWhlbHBlci1oaWRkZW4tYWNjZXNzaWJsZVwiICk7XG5cblx0XHQvLyBUdXJuaW5nIG9mZiBhdXRvY29tcGxldGUgcHJldmVudHMgdGhlIGJyb3dzZXIgZnJvbSByZW1lbWJlcmluZyB0aGVcblx0XHQvLyB2YWx1ZSB3aGVuIG5hdmlnYXRpbmcgdGhyb3VnaCBoaXN0b3J5LCBzbyB3ZSByZS1lbmFibGUgYXV0b2NvbXBsZXRlXG5cdFx0Ly8gaWYgdGhlIHBhZ2UgaXMgdW5sb2FkZWQgYmVmb3JlIHRoZSB3aWRnZXQgaXMgZGVzdHJveWVkLiAjNzc5MFxuXHRcdHRoaXMuX29uKCB0aGlzLndpbmRvdywge1xuXHRcdFx0YmVmb3JldW5sb2FkOiBmdW5jdGlvbigpIHtcblx0XHRcdFx0dGhpcy5lbGVtZW50LnJlbW92ZUF0dHIoIFwiYXV0b2NvbXBsZXRlXCIgKTtcblx0XHRcdH1cblx0XHR9ICk7XG5cdH0sXG5cblx0X2Rlc3Ryb3k6IGZ1bmN0aW9uKCkge1xuXHRcdGNsZWFyVGltZW91dCggdGhpcy5zZWFyY2hpbmcgKTtcblx0XHR0aGlzLmVsZW1lbnQucmVtb3ZlQXR0ciggXCJhdXRvY29tcGxldGVcIiApO1xuXHRcdHRoaXMubWVudS5lbGVtZW50LnJlbW92ZSgpO1xuXHRcdHRoaXMubGl2ZVJlZ2lvbi5yZW1vdmUoKTtcblx0fSxcblxuXHRfc2V0T3B0aW9uOiBmdW5jdGlvbigga2V5LCB2YWx1ZSApIHtcblx0XHR0aGlzLl9zdXBlcigga2V5LCB2YWx1ZSApO1xuXHRcdGlmICgga2V5ID09PSBcInNvdXJjZVwiICkge1xuXHRcdFx0dGhpcy5faW5pdFNvdXJjZSgpO1xuXHRcdH1cblx0XHRpZiAoIGtleSA9PT0gXCJhcHBlbmRUb1wiICkge1xuXHRcdFx0dGhpcy5tZW51LmVsZW1lbnQuYXBwZW5kVG8oIHRoaXMuX2FwcGVuZFRvKCkgKTtcblx0XHR9XG5cdFx0aWYgKCBrZXkgPT09IFwiZGlzYWJsZWRcIiAmJiB2YWx1ZSAmJiB0aGlzLnhociApIHtcblx0XHRcdHRoaXMueGhyLmFib3J0KCk7XG5cdFx0fVxuXHR9LFxuXG5cdF9pc0V2ZW50VGFyZ2V0SW5XaWRnZXQ6IGZ1bmN0aW9uKCBldmVudCApIHtcblx0XHR2YXIgbWVudUVsZW1lbnQgPSB0aGlzLm1lbnUuZWxlbWVudFsgMCBdO1xuXG5cdFx0cmV0dXJuIGV2ZW50LnRhcmdldCA9PT0gdGhpcy5lbGVtZW50WyAwIF0gfHxcblx0XHRcdGV2ZW50LnRhcmdldCA9PT0gbWVudUVsZW1lbnQgfHxcblx0XHRcdCQuY29udGFpbnMoIG1lbnVFbGVtZW50LCBldmVudC50YXJnZXQgKTtcblx0fSxcblxuXHRfY2xvc2VPbkNsaWNrT3V0c2lkZTogZnVuY3Rpb24oIGV2ZW50ICkge1xuXHRcdGlmICggIXRoaXMuX2lzRXZlbnRUYXJnZXRJbldpZGdldCggZXZlbnQgKSApIHtcblx0XHRcdHRoaXMuY2xvc2UoKTtcblx0XHR9XG5cdH0sXG5cblx0X2FwcGVuZFRvOiBmdW5jdGlvbigpIHtcblx0XHR2YXIgZWxlbWVudCA9IHRoaXMub3B0aW9ucy5hcHBlbmRUbztcblxuXHRcdGlmICggZWxlbWVudCApIHtcblx0XHRcdGVsZW1lbnQgPSBlbGVtZW50LmpxdWVyeSB8fCBlbGVtZW50Lm5vZGVUeXBlID9cblx0XHRcdFx0JCggZWxlbWVudCApIDpcblx0XHRcdFx0dGhpcy5kb2N1bWVudC5maW5kKCBlbGVtZW50ICkuZXEoIDAgKTtcblx0XHR9XG5cblx0XHRpZiAoICFlbGVtZW50IHx8ICFlbGVtZW50WyAwIF0gKSB7XG5cdFx0XHRlbGVtZW50ID0gdGhpcy5lbGVtZW50LmNsb3Nlc3QoIFwiLnVpLWZyb250LCBkaWFsb2dcIiApO1xuXHRcdH1cblxuXHRcdGlmICggIWVsZW1lbnQubGVuZ3RoICkge1xuXHRcdFx0ZWxlbWVudCA9IHRoaXMuZG9jdW1lbnRbIDAgXS5ib2R5O1xuXHRcdH1cblxuXHRcdHJldHVybiBlbGVtZW50O1xuXHR9LFxuXG5cdF9pbml0U291cmNlOiBmdW5jdGlvbigpIHtcblx0XHR2YXIgYXJyYXksIHVybCxcblx0XHRcdHRoYXQgPSB0aGlzO1xuXHRcdGlmICggJC5pc0FycmF5KCB0aGlzLm9wdGlvbnMuc291cmNlICkgKSB7XG5cdFx0XHRhcnJheSA9IHRoaXMub3B0aW9ucy5zb3VyY2U7XG5cdFx0XHR0aGlzLnNvdXJjZSA9IGZ1bmN0aW9uKCByZXF1ZXN0LCByZXNwb25zZSApIHtcblx0XHRcdFx0cmVzcG9uc2UoICQudWkuYXV0b2NvbXBsZXRlLmZpbHRlciggYXJyYXksIHJlcXVlc3QudGVybSApICk7XG5cdFx0XHR9O1xuXHRcdH0gZWxzZSBpZiAoIHR5cGVvZiB0aGlzLm9wdGlvbnMuc291cmNlID09PSBcInN0cmluZ1wiICkge1xuXHRcdFx0dXJsID0gdGhpcy5vcHRpb25zLnNvdXJjZTtcblx0XHRcdHRoaXMuc291cmNlID0gZnVuY3Rpb24oIHJlcXVlc3QsIHJlc3BvbnNlICkge1xuXHRcdFx0XHRpZiAoIHRoYXQueGhyICkge1xuXHRcdFx0XHRcdHRoYXQueGhyLmFib3J0KCk7XG5cdFx0XHRcdH1cblx0XHRcdFx0dGhhdC54aHIgPSAkLmFqYXgoIHtcblx0XHRcdFx0XHR1cmw6IHVybCxcblx0XHRcdFx0XHRkYXRhOiByZXF1ZXN0LFxuXHRcdFx0XHRcdGRhdGFUeXBlOiBcImpzb25cIixcblx0XHRcdFx0XHRzdWNjZXNzOiBmdW5jdGlvbiggZGF0YSApIHtcblx0XHRcdFx0XHRcdHJlc3BvbnNlKCBkYXRhICk7XG5cdFx0XHRcdFx0fSxcblx0XHRcdFx0XHRlcnJvcjogZnVuY3Rpb24oKSB7XG5cdFx0XHRcdFx0XHRyZXNwb25zZSggW10gKTtcblx0XHRcdFx0XHR9XG5cdFx0XHRcdH0gKTtcblx0XHRcdH07XG5cdFx0fSBlbHNlIHtcblx0XHRcdHRoaXMuc291cmNlID0gdGhpcy5vcHRpb25zLnNvdXJjZTtcblx0XHR9XG5cdH0sXG5cblx0X3NlYXJjaFRpbWVvdXQ6IGZ1bmN0aW9uKCBldmVudCApIHtcblx0XHRjbGVhclRpbWVvdXQoIHRoaXMuc2VhcmNoaW5nICk7XG5cdFx0dGhpcy5zZWFyY2hpbmcgPSB0aGlzLl9kZWxheSggZnVuY3Rpb24oKSB7XG5cblx0XHRcdC8vIFNlYXJjaCBpZiB0aGUgdmFsdWUgaGFzIGNoYW5nZWQsIG9yIGlmIHRoZSB1c2VyIHJldHlwZXMgdGhlIHNhbWUgdmFsdWUgKHNlZSAjNzQzNClcblx0XHRcdHZhciBlcXVhbFZhbHVlcyA9IHRoaXMudGVybSA9PT0gdGhpcy5fdmFsdWUoKSxcblx0XHRcdFx0bWVudVZpc2libGUgPSB0aGlzLm1lbnUuZWxlbWVudC5pcyggXCI6dmlzaWJsZVwiICksXG5cdFx0XHRcdG1vZGlmaWVyS2V5ID0gZXZlbnQuYWx0S2V5IHx8IGV2ZW50LmN0cmxLZXkgfHwgZXZlbnQubWV0YUtleSB8fCBldmVudC5zaGlmdEtleTtcblxuXHRcdFx0aWYgKCAhZXF1YWxWYWx1ZXMgfHwgKCBlcXVhbFZhbHVlcyAmJiAhbWVudVZpc2libGUgJiYgIW1vZGlmaWVyS2V5ICkgKSB7XG5cdFx0XHRcdHRoaXMuc2VsZWN0ZWRJdGVtID0gbnVsbDtcblx0XHRcdFx0dGhpcy5zZWFyY2goIG51bGwsIGV2ZW50ICk7XG5cdFx0XHR9XG5cdFx0fSwgdGhpcy5vcHRpb25zLmRlbGF5ICk7XG5cdH0sXG5cblx0c2VhcmNoOiBmdW5jdGlvbiggdmFsdWUsIGV2ZW50ICkge1xuXHRcdHZhbHVlID0gdmFsdWUgIT0gbnVsbCA/IHZhbHVlIDogdGhpcy5fdmFsdWUoKTtcblxuXHRcdC8vIEFsd2F5cyBzYXZlIHRoZSBhY3R1YWwgdmFsdWUsIG5vdCB0aGUgb25lIHBhc3NlZCBhcyBhbiBhcmd1bWVudFxuXHRcdHRoaXMudGVybSA9IHRoaXMuX3ZhbHVlKCk7XG5cblx0XHRpZiAoIHZhbHVlLmxlbmd0aCA8IHRoaXMub3B0aW9ucy5taW5MZW5ndGggKSB7XG5cdFx0XHRyZXR1cm4gdGhpcy5jbG9zZSggZXZlbnQgKTtcblx0XHR9XG5cblx0XHRpZiAoIHRoaXMuX3RyaWdnZXIoIFwic2VhcmNoXCIsIGV2ZW50ICkgPT09IGZhbHNlICkge1xuXHRcdFx0cmV0dXJuO1xuXHRcdH1cblxuXHRcdHJldHVybiB0aGlzLl9zZWFyY2goIHZhbHVlICk7XG5cdH0sXG5cblx0X3NlYXJjaDogZnVuY3Rpb24oIHZhbHVlICkge1xuXHRcdHRoaXMucGVuZGluZysrO1xuXHRcdHRoaXMuX2FkZENsYXNzKCBcInVpLWF1dG9jb21wbGV0ZS1sb2FkaW5nXCIgKTtcblx0XHR0aGlzLmNhbmNlbFNlYXJjaCA9IGZhbHNlO1xuXG5cdFx0dGhpcy5zb3VyY2UoIHsgdGVybTogdmFsdWUgfSwgdGhpcy5fcmVzcG9uc2UoKSApO1xuXHR9LFxuXG5cdF9yZXNwb25zZTogZnVuY3Rpb24oKSB7XG5cdFx0dmFyIGluZGV4ID0gKyt0aGlzLnJlcXVlc3RJbmRleDtcblxuXHRcdHJldHVybiAkLnByb3h5KCBmdW5jdGlvbiggY29udGVudCApIHtcblx0XHRcdGlmICggaW5kZXggPT09IHRoaXMucmVxdWVzdEluZGV4ICkge1xuXHRcdFx0XHR0aGlzLl9fcmVzcG9uc2UoIGNvbnRlbnQgKTtcblx0XHRcdH1cblxuXHRcdFx0dGhpcy5wZW5kaW5nLS07XG5cdFx0XHRpZiAoICF0aGlzLnBlbmRpbmcgKSB7XG5cdFx0XHRcdHRoaXMuX3JlbW92ZUNsYXNzKCBcInVpLWF1dG9jb21wbGV0ZS1sb2FkaW5nXCIgKTtcblx0XHRcdH1cblx0XHR9LCB0aGlzICk7XG5cdH0sXG5cblx0X19yZXNwb25zZTogZnVuY3Rpb24oIGNvbnRlbnQgKSB7XG5cdFx0aWYgKCBjb250ZW50ICkge1xuXHRcdFx0Y29udGVudCA9IHRoaXMuX25vcm1hbGl6ZSggY29udGVudCApO1xuXHRcdH1cblx0XHR0aGlzLl90cmlnZ2VyKCBcInJlc3BvbnNlXCIsIG51bGwsIHsgY29udGVudDogY29udGVudCB9ICk7XG5cdFx0aWYgKCAhdGhpcy5vcHRpb25zLmRpc2FibGVkICYmIGNvbnRlbnQgJiYgY29udGVudC5sZW5ndGggJiYgIXRoaXMuY2FuY2VsU2VhcmNoICkge1xuXHRcdFx0dGhpcy5fc3VnZ2VzdCggY29udGVudCApO1xuXHRcdFx0dGhpcy5fdHJpZ2dlciggXCJvcGVuXCIgKTtcblx0XHR9IGVsc2Uge1xuXG5cdFx0XHQvLyB1c2UgLl9jbG9zZSgpIGluc3RlYWQgb2YgLmNsb3NlKCkgc28gd2UgZG9uJ3QgY2FuY2VsIGZ1dHVyZSBzZWFyY2hlc1xuXHRcdFx0dGhpcy5fY2xvc2UoKTtcblx0XHR9XG5cdH0sXG5cblx0Y2xvc2U6IGZ1bmN0aW9uKCBldmVudCApIHtcblx0XHR0aGlzLmNhbmNlbFNlYXJjaCA9IHRydWU7XG5cdFx0dGhpcy5fY2xvc2UoIGV2ZW50ICk7XG5cdH0sXG5cblx0X2Nsb3NlOiBmdW5jdGlvbiggZXZlbnQgKSB7XG5cblx0XHQvLyBSZW1vdmUgdGhlIGhhbmRsZXIgdGhhdCBjbG9zZXMgdGhlIG1lbnUgb24gb3V0c2lkZSBjbGlja3Ncblx0XHR0aGlzLl9vZmYoIHRoaXMuZG9jdW1lbnQsIFwibW91c2Vkb3duXCIgKTtcblxuXHRcdGlmICggdGhpcy5tZW51LmVsZW1lbnQuaXMoIFwiOnZpc2libGVcIiApICkge1xuXHRcdFx0dGhpcy5tZW51LmVsZW1lbnQuaGlkZSgpO1xuXHRcdFx0dGhpcy5tZW51LmJsdXIoKTtcblx0XHRcdHRoaXMuaXNOZXdNZW51ID0gdHJ1ZTtcblx0XHRcdHRoaXMuX3RyaWdnZXIoIFwiY2xvc2VcIiwgZXZlbnQgKTtcblx0XHR9XG5cdH0sXG5cblx0X2NoYW5nZTogZnVuY3Rpb24oIGV2ZW50ICkge1xuXHRcdGlmICggdGhpcy5wcmV2aW91cyAhPT0gdGhpcy5fdmFsdWUoKSApIHtcblx0XHRcdHRoaXMuX3RyaWdnZXIoIFwiY2hhbmdlXCIsIGV2ZW50LCB7IGl0ZW06IHRoaXMuc2VsZWN0ZWRJdGVtIH0gKTtcblx0XHR9XG5cdH0sXG5cblx0X25vcm1hbGl6ZTogZnVuY3Rpb24oIGl0ZW1zICkge1xuXG5cdFx0Ly8gYXNzdW1lIGFsbCBpdGVtcyBoYXZlIHRoZSByaWdodCBmb3JtYXQgd2hlbiB0aGUgZmlyc3QgaXRlbSBpcyBjb21wbGV0ZVxuXHRcdGlmICggaXRlbXMubGVuZ3RoICYmIGl0ZW1zWyAwIF0ubGFiZWwgJiYgaXRlbXNbIDAgXS52YWx1ZSApIHtcblx0XHRcdHJldHVybiBpdGVtcztcblx0XHR9XG5cdFx0cmV0dXJuICQubWFwKCBpdGVtcywgZnVuY3Rpb24oIGl0ZW0gKSB7XG5cdFx0XHRpZiAoIHR5cGVvZiBpdGVtID09PSBcInN0cmluZ1wiICkge1xuXHRcdFx0XHRyZXR1cm4ge1xuXHRcdFx0XHRcdGxhYmVsOiBpdGVtLFxuXHRcdFx0XHRcdHZhbHVlOiBpdGVtXG5cdFx0XHRcdH07XG5cdFx0XHR9XG5cdFx0XHRyZXR1cm4gJC5leHRlbmQoIHt9LCBpdGVtLCB7XG5cdFx0XHRcdGxhYmVsOiBpdGVtLmxhYmVsIHx8IGl0ZW0udmFsdWUsXG5cdFx0XHRcdHZhbHVlOiBpdGVtLnZhbHVlIHx8IGl0ZW0ubGFiZWxcblx0XHRcdH0gKTtcblx0XHR9ICk7XG5cdH0sXG5cblx0X3N1Z2dlc3Q6IGZ1bmN0aW9uKCBpdGVtcyApIHtcblx0XHR2YXIgdWwgPSB0aGlzLm1lbnUuZWxlbWVudC5lbXB0eSgpO1xuXHRcdHRoaXMuX3JlbmRlck1lbnUoIHVsLCBpdGVtcyApO1xuXHRcdHRoaXMuaXNOZXdNZW51ID0gdHJ1ZTtcblx0XHR0aGlzLm1lbnUucmVmcmVzaCgpO1xuXG5cdFx0Ly8gU2l6ZSBhbmQgcG9zaXRpb24gbWVudVxuXHRcdHVsLnNob3coKTtcblx0XHR0aGlzLl9yZXNpemVNZW51KCk7XG5cdFx0dWwucG9zaXRpb24oICQuZXh0ZW5kKCB7XG5cdFx0XHRvZjogdGhpcy5lbGVtZW50XG5cdFx0fSwgdGhpcy5vcHRpb25zLnBvc2l0aW9uICkgKTtcblxuXHRcdGlmICggdGhpcy5vcHRpb25zLmF1dG9Gb2N1cyApIHtcblx0XHRcdHRoaXMubWVudS5uZXh0KCk7XG5cdFx0fVxuXG5cdFx0Ly8gTGlzdGVuIGZvciBpbnRlcmFjdGlvbnMgb3V0c2lkZSBvZiB0aGUgd2lkZ2V0ICgjNjY0Milcblx0XHR0aGlzLl9vbiggdGhpcy5kb2N1bWVudCwge1xuXHRcdFx0bW91c2Vkb3duOiBcIl9jbG9zZU9uQ2xpY2tPdXRzaWRlXCJcblx0XHR9ICk7XG5cdH0sXG5cblx0X3Jlc2l6ZU1lbnU6IGZ1bmN0aW9uKCkge1xuXHRcdHZhciB1bCA9IHRoaXMubWVudS5lbGVtZW50O1xuXHRcdHVsLm91dGVyV2lkdGgoIE1hdGgubWF4KFxuXG5cdFx0XHQvLyBGaXJlZm94IHdyYXBzIGxvbmcgdGV4dCAocG9zc2libHkgYSByb3VuZGluZyBidWcpXG5cdFx0XHQvLyBzbyB3ZSBhZGQgMXB4IHRvIGF2b2lkIHRoZSB3cmFwcGluZyAoIzc1MTMpXG5cdFx0XHR1bC53aWR0aCggXCJcIiApLm91dGVyV2lkdGgoKSArIDEsXG5cdFx0XHR0aGlzLmVsZW1lbnQub3V0ZXJXaWR0aCgpXG5cdFx0KSApO1xuXHR9LFxuXG5cdF9yZW5kZXJNZW51OiBmdW5jdGlvbiggdWwsIGl0ZW1zICkge1xuXHRcdHZhciB0aGF0ID0gdGhpcztcblx0XHQkLmVhY2goIGl0ZW1zLCBmdW5jdGlvbiggaW5kZXgsIGl0ZW0gKSB7XG5cdFx0XHR0aGF0Ll9yZW5kZXJJdGVtRGF0YSggdWwsIGl0ZW0gKTtcblx0XHR9ICk7XG5cdH0sXG5cblx0X3JlbmRlckl0ZW1EYXRhOiBmdW5jdGlvbiggdWwsIGl0ZW0gKSB7XG5cdFx0cmV0dXJuIHRoaXMuX3JlbmRlckl0ZW0oIHVsLCBpdGVtICkuZGF0YSggXCJ1aS1hdXRvY29tcGxldGUtaXRlbVwiLCBpdGVtICk7XG5cdH0sXG5cblx0X3JlbmRlckl0ZW06IGZ1bmN0aW9uKCB1bCwgaXRlbSApIHtcblx0XHRyZXR1cm4gJCggXCI8bGk+XCIgKVxuXHRcdFx0LmFwcGVuZCggJCggXCI8ZGl2PlwiICkudGV4dCggaXRlbS5sYWJlbCApIClcblx0XHRcdC5hcHBlbmRUbyggdWwgKTtcblx0fSxcblxuXHRfbW92ZTogZnVuY3Rpb24oIGRpcmVjdGlvbiwgZXZlbnQgKSB7XG5cdFx0aWYgKCAhdGhpcy5tZW51LmVsZW1lbnQuaXMoIFwiOnZpc2libGVcIiApICkge1xuXHRcdFx0dGhpcy5zZWFyY2goIG51bGwsIGV2ZW50ICk7XG5cdFx0XHRyZXR1cm47XG5cdFx0fVxuXHRcdGlmICggdGhpcy5tZW51LmlzRmlyc3RJdGVtKCkgJiYgL15wcmV2aW91cy8udGVzdCggZGlyZWN0aW9uICkgfHxcblx0XHRcdFx0dGhpcy5tZW51LmlzTGFzdEl0ZW0oKSAmJiAvXm5leHQvLnRlc3QoIGRpcmVjdGlvbiApICkge1xuXG5cdFx0XHRpZiAoICF0aGlzLmlzTXVsdGlMaW5lICkge1xuXHRcdFx0XHR0aGlzLl92YWx1ZSggdGhpcy50ZXJtICk7XG5cdFx0XHR9XG5cblx0XHRcdHRoaXMubWVudS5ibHVyKCk7XG5cdFx0XHRyZXR1cm47XG5cdFx0fVxuXHRcdHRoaXMubWVudVsgZGlyZWN0aW9uIF0oIGV2ZW50ICk7XG5cdH0sXG5cblx0d2lkZ2V0OiBmdW5jdGlvbigpIHtcblx0XHRyZXR1cm4gdGhpcy5tZW51LmVsZW1lbnQ7XG5cdH0sXG5cblx0X3ZhbHVlOiBmdW5jdGlvbigpIHtcblx0XHRyZXR1cm4gdGhpcy52YWx1ZU1ldGhvZC5hcHBseSggdGhpcy5lbGVtZW50LCBhcmd1bWVudHMgKTtcblx0fSxcblxuXHRfa2V5RXZlbnQ6IGZ1bmN0aW9uKCBrZXlFdmVudCwgZXZlbnQgKSB7XG5cdFx0aWYgKCAhdGhpcy5pc011bHRpTGluZSB8fCB0aGlzLm1lbnUuZWxlbWVudC5pcyggXCI6dmlzaWJsZVwiICkgKSB7XG5cdFx0XHR0aGlzLl9tb3ZlKCBrZXlFdmVudCwgZXZlbnQgKTtcblxuXHRcdFx0Ly8gUHJldmVudHMgbW92aW5nIGN1cnNvciB0byBiZWdpbm5pbmcvZW5kIG9mIHRoZSB0ZXh0IGZpZWxkIGluIHNvbWUgYnJvd3NlcnNcblx0XHRcdGV2ZW50LnByZXZlbnREZWZhdWx0KCk7XG5cdFx0fVxuXHR9LFxuXG5cdC8vIFN1cHBvcnQ6IENocm9tZSA8PTUwXG5cdC8vIFdlIHNob3VsZCBiZSBhYmxlIHRvIGp1c3QgdXNlIHRoaXMuZWxlbWVudC5wcm9wKCBcImlzQ29udGVudEVkaXRhYmxlXCIgKVxuXHQvLyBidXQgaGlkZGVuIGVsZW1lbnRzIGFsd2F5cyByZXBvcnQgZmFsc2UgaW4gQ2hyb21lLlxuXHQvLyBodHRwczovL2NvZGUuZ29vZ2xlLmNvbS9wL2Nocm9taXVtL2lzc3Vlcy9kZXRhaWw/aWQ9MzEzMDgyXG5cdF9pc0NvbnRlbnRFZGl0YWJsZTogZnVuY3Rpb24oIGVsZW1lbnQgKSB7XG5cdFx0aWYgKCAhZWxlbWVudC5sZW5ndGggKSB7XG5cdFx0XHRyZXR1cm4gZmFsc2U7XG5cdFx0fVxuXG5cdFx0dmFyIGVkaXRhYmxlID0gZWxlbWVudC5wcm9wKCBcImNvbnRlbnRFZGl0YWJsZVwiICk7XG5cblx0XHRpZiAoIGVkaXRhYmxlID09PSBcImluaGVyaXRcIiApIHtcblx0XHQgIHJldHVybiB0aGlzLl9pc0NvbnRlbnRFZGl0YWJsZSggZWxlbWVudC5wYXJlbnQoKSApO1xuXHRcdH1cblxuXHRcdHJldHVybiBlZGl0YWJsZSA9PT0gXCJ0cnVlXCI7XG5cdH1cbn0gKTtcblxuJC5leHRlbmQoICQudWkuYXV0b2NvbXBsZXRlLCB7XG5cdGVzY2FwZVJlZ2V4OiBmdW5jdGlvbiggdmFsdWUgKSB7XG5cdFx0cmV0dXJuIHZhbHVlLnJlcGxhY2UoIC9bXFwtXFxbXFxde30oKSorPy4sXFxcXFxcXiR8I1xcc10vZywgXCJcXFxcJCZcIiApO1xuXHR9LFxuXHRmaWx0ZXI6IGZ1bmN0aW9uKCBhcnJheSwgdGVybSApIHtcblx0XHR2YXIgbWF0Y2hlciA9IG5ldyBSZWdFeHAoICQudWkuYXV0b2NvbXBsZXRlLmVzY2FwZVJlZ2V4KCB0ZXJtICksIFwiaVwiICk7XG5cdFx0cmV0dXJuICQuZ3JlcCggYXJyYXksIGZ1bmN0aW9uKCB2YWx1ZSApIHtcblx0XHRcdHJldHVybiBtYXRjaGVyLnRlc3QoIHZhbHVlLmxhYmVsIHx8IHZhbHVlLnZhbHVlIHx8IHZhbHVlICk7XG5cdFx0fSApO1xuXHR9XG59ICk7XG5cbi8vIExpdmUgcmVnaW9uIGV4dGVuc2lvbiwgYWRkaW5nIGEgYG1lc3NhZ2VzYCBvcHRpb25cbi8vIE5PVEU6IFRoaXMgaXMgYW4gZXhwZXJpbWVudGFsIEFQSS4gV2UgYXJlIHN0aWxsIGludmVzdGlnYXRpbmdcbi8vIGEgZnVsbCBzb2x1dGlvbiBmb3Igc3RyaW5nIG1hbmlwdWxhdGlvbiBhbmQgaW50ZXJuYXRpb25hbGl6YXRpb24uXG4kLndpZGdldCggXCJ1aS5hdXRvY29tcGxldGVcIiwgJC51aS5hdXRvY29tcGxldGUsIHtcblx0b3B0aW9uczoge1xuXHRcdG1lc3NhZ2VzOiB7XG5cdFx0XHRub1Jlc3VsdHM6IFwiTm8gc2VhcmNoIHJlc3VsdHMuXCIsXG5cdFx0XHRyZXN1bHRzOiBmdW5jdGlvbiggYW1vdW50ICkge1xuXHRcdFx0XHRyZXR1cm4gYW1vdW50ICsgKCBhbW91bnQgPiAxID8gXCIgcmVzdWx0cyBhcmVcIiA6IFwiIHJlc3VsdCBpc1wiICkgK1xuXHRcdFx0XHRcdFwiIGF2YWlsYWJsZSwgdXNlIHVwIGFuZCBkb3duIGFycm93IGtleXMgdG8gbmF2aWdhdGUuXCI7XG5cdFx0XHR9XG5cdFx0fVxuXHR9LFxuXG5cdF9fcmVzcG9uc2U6IGZ1bmN0aW9uKCBjb250ZW50ICkge1xuXHRcdHZhciBtZXNzYWdlO1xuXHRcdHRoaXMuX3N1cGVyQXBwbHkoIGFyZ3VtZW50cyApO1xuXHRcdGlmICggdGhpcy5vcHRpb25zLmRpc2FibGVkIHx8IHRoaXMuY2FuY2VsU2VhcmNoICkge1xuXHRcdFx0cmV0dXJuO1xuXHRcdH1cblx0XHRpZiAoIGNvbnRlbnQgJiYgY29udGVudC5sZW5ndGggKSB7XG5cdFx0XHRtZXNzYWdlID0gdGhpcy5vcHRpb25zLm1lc3NhZ2VzLnJlc3VsdHMoIGNvbnRlbnQubGVuZ3RoICk7XG5cdFx0fSBlbHNlIHtcblx0XHRcdG1lc3NhZ2UgPSB0aGlzLm9wdGlvbnMubWVzc2FnZXMubm9SZXN1bHRzO1xuXHRcdH1cblx0XHR0aGlzLmxpdmVSZWdpb24uY2hpbGRyZW4oKS5oaWRlKCk7XG5cdFx0JCggXCI8ZGl2PlwiICkudGV4dCggbWVzc2FnZSApLmFwcGVuZFRvKCB0aGlzLmxpdmVSZWdpb24gKTtcblx0fVxufSApO1xuXG5yZXR1cm4gJC51aS5hdXRvY29tcGxldGU7XG5cbn0gKSApO1xuIiwiLyohXG4gKiBqUXVlcnkgVUkgQnV0dG9uIDEuMTIuMVxuICogaHR0cDovL2pxdWVyeXVpLmNvbVxuICpcbiAqIENvcHlyaWdodCBqUXVlcnkgRm91bmRhdGlvbiBhbmQgb3RoZXIgY29udHJpYnV0b3JzXG4gKiBSZWxlYXNlZCB1bmRlciB0aGUgTUlUIGxpY2Vuc2UuXG4gKiBodHRwOi8vanF1ZXJ5Lm9yZy9saWNlbnNlXG4gKi9cblxuLy8+PmxhYmVsOiBCdXR0b25cbi8vPj5ncm91cDogV2lkZ2V0c1xuLy8+PmRlc2NyaXB0aW9uOiBFbmhhbmNlcyBhIGZvcm0gd2l0aCB0aGVtZWFibGUgYnV0dG9ucy5cbi8vPj5kb2NzOiBodHRwOi8vYXBpLmpxdWVyeXVpLmNvbS9idXR0b24vXG4vLz4+ZGVtb3M6IGh0dHA6Ly9qcXVlcnl1aS5jb20vYnV0dG9uL1xuLy8+PmNzcy5zdHJ1Y3R1cmU6IC4uLy4uL3RoZW1lcy9iYXNlL2NvcmUuY3NzXG4vLz4+Y3NzLnN0cnVjdHVyZTogLi4vLi4vdGhlbWVzL2Jhc2UvYnV0dG9uLmNzc1xuLy8+PmNzcy50aGVtZTogLi4vLi4vdGhlbWVzL2Jhc2UvdGhlbWUuY3NzXG5cbiggZnVuY3Rpb24oIGZhY3RvcnkgKSB7XG5cdGlmICggdHlwZW9mIGRlZmluZSA9PT0gXCJmdW5jdGlvblwiICYmIGRlZmluZS5hbWQgKSB7XG5cblx0XHQvLyBBTUQuIFJlZ2lzdGVyIGFzIGFuIGFub255bW91cyBtb2R1bGUuXG5cdFx0ZGVmaW5lKCBbXG5cdFx0XHRcImpxdWVyeVwiLFxuXG5cdFx0XHQvLyBUaGVzZSBhcmUgb25seSBmb3IgYmFja2NvbXBhdFxuXHRcdFx0Ly8gVE9ETzogUmVtb3ZlIGFmdGVyIDEuMTJcblx0XHRcdFwiLi9jb250cm9sZ3JvdXBcIixcblx0XHRcdFwiLi9jaGVja2JveHJhZGlvXCIsXG5cblx0XHRcdFwiLi4va2V5Y29kZVwiLFxuXHRcdFx0XCIuLi93aWRnZXRcIlxuXHRcdF0sIGZhY3RvcnkgKTtcblx0fSBlbHNlIHtcblxuXHRcdC8vIEJyb3dzZXIgZ2xvYmFsc1xuXHRcdGZhY3RvcnkoIGpRdWVyeSApO1xuXHR9XG59KCBmdW5jdGlvbiggJCApIHtcblxuJC53aWRnZXQoIFwidWkuYnV0dG9uXCIsIHtcblx0dmVyc2lvbjogXCIxLjEyLjFcIixcblx0ZGVmYXVsdEVsZW1lbnQ6IFwiPGJ1dHRvbj5cIixcblx0b3B0aW9uczoge1xuXHRcdGNsYXNzZXM6IHtcblx0XHRcdFwidWktYnV0dG9uXCI6IFwidWktY29ybmVyLWFsbFwiXG5cdFx0fSxcblx0XHRkaXNhYmxlZDogbnVsbCxcblx0XHRpY29uOiBudWxsLFxuXHRcdGljb25Qb3NpdGlvbjogXCJiZWdpbm5pbmdcIixcblx0XHRsYWJlbDogbnVsbCxcblx0XHRzaG93TGFiZWw6IHRydWVcblx0fSxcblxuXHRfZ2V0Q3JlYXRlT3B0aW9uczogZnVuY3Rpb24oKSB7XG5cdFx0dmFyIGRpc2FibGVkLFxuXG5cdFx0XHQvLyBUaGlzIGlzIHRvIHN1cHBvcnQgY2FzZXMgbGlrZSBpbiBqUXVlcnkgTW9iaWxlIHdoZXJlIHRoZSBiYXNlIHdpZGdldCBkb2VzIGhhdmVcblx0XHRcdC8vIGFuIGltcGxlbWVudGF0aW9uIG9mIF9nZXRDcmVhdGVPcHRpb25zXG5cdFx0XHRvcHRpb25zID0gdGhpcy5fc3VwZXIoKSB8fCB7fTtcblxuXHRcdHRoaXMuaXNJbnB1dCA9IHRoaXMuZWxlbWVudC5pcyggXCJpbnB1dFwiICk7XG5cblx0XHRkaXNhYmxlZCA9IHRoaXMuZWxlbWVudFsgMCBdLmRpc2FibGVkO1xuXHRcdGlmICggZGlzYWJsZWQgIT0gbnVsbCApIHtcblx0XHRcdG9wdGlvbnMuZGlzYWJsZWQgPSBkaXNhYmxlZDtcblx0XHR9XG5cblx0XHR0aGlzLm9yaWdpbmFsTGFiZWwgPSB0aGlzLmlzSW5wdXQgPyB0aGlzLmVsZW1lbnQudmFsKCkgOiB0aGlzLmVsZW1lbnQuaHRtbCgpO1xuXHRcdGlmICggdGhpcy5vcmlnaW5hbExhYmVsICkge1xuXHRcdFx0b3B0aW9ucy5sYWJlbCA9IHRoaXMub3JpZ2luYWxMYWJlbDtcblx0XHR9XG5cblx0XHRyZXR1cm4gb3B0aW9ucztcblx0fSxcblxuXHRfY3JlYXRlOiBmdW5jdGlvbigpIHtcblx0XHRpZiAoICF0aGlzLm9wdGlvbi5zaG93TGFiZWwgJiAhdGhpcy5vcHRpb25zLmljb24gKSB7XG5cdFx0XHR0aGlzLm9wdGlvbnMuc2hvd0xhYmVsID0gdHJ1ZTtcblx0XHR9XG5cblx0XHQvLyBXZSBoYXZlIHRvIGNoZWNrIHRoZSBvcHRpb24gYWdhaW4gaGVyZSBldmVuIHRob3VnaCB3ZSBkaWQgaW4gX2dldENyZWF0ZU9wdGlvbnMsXG5cdFx0Ly8gYmVjYXVzZSBudWxsIG1heSBoYXZlIGJlZW4gcGFzc2VkIG9uIGluaXQgd2hpY2ggd291bGQgb3ZlcnJpZGUgd2hhdCB3YXMgc2V0IGluXG5cdFx0Ly8gX2dldENyZWF0ZU9wdGlvbnNcblx0XHRpZiAoIHRoaXMub3B0aW9ucy5kaXNhYmxlZCA9PSBudWxsICkge1xuXHRcdFx0dGhpcy5vcHRpb25zLmRpc2FibGVkID0gdGhpcy5lbGVtZW50WyAwIF0uZGlzYWJsZWQgfHwgZmFsc2U7XG5cdFx0fVxuXG5cdFx0dGhpcy5oYXNUaXRsZSA9ICEhdGhpcy5lbGVtZW50LmF0dHIoIFwidGl0bGVcIiApO1xuXG5cdFx0Ly8gQ2hlY2sgdG8gc2VlIGlmIHRoZSBsYWJlbCBuZWVkcyB0byBiZSBzZXQgb3IgaWYgaXRzIGFscmVhZHkgY29ycmVjdFxuXHRcdGlmICggdGhpcy5vcHRpb25zLmxhYmVsICYmIHRoaXMub3B0aW9ucy5sYWJlbCAhPT0gdGhpcy5vcmlnaW5hbExhYmVsICkge1xuXHRcdFx0aWYgKCB0aGlzLmlzSW5wdXQgKSB7XG5cdFx0XHRcdHRoaXMuZWxlbWVudC52YWwoIHRoaXMub3B0aW9ucy5sYWJlbCApO1xuXHRcdFx0fSBlbHNlIHtcblx0XHRcdFx0dGhpcy5lbGVtZW50Lmh0bWwoIHRoaXMub3B0aW9ucy5sYWJlbCApO1xuXHRcdFx0fVxuXHRcdH1cblx0XHR0aGlzLl9hZGRDbGFzcyggXCJ1aS1idXR0b25cIiwgXCJ1aS13aWRnZXRcIiApO1xuXHRcdHRoaXMuX3NldE9wdGlvbiggXCJkaXNhYmxlZFwiLCB0aGlzLm9wdGlvbnMuZGlzYWJsZWQgKTtcblx0XHR0aGlzLl9lbmhhbmNlKCk7XG5cblx0XHRpZiAoIHRoaXMuZWxlbWVudC5pcyggXCJhXCIgKSApIHtcblx0XHRcdHRoaXMuX29uKCB7XG5cdFx0XHRcdFwia2V5dXBcIjogZnVuY3Rpb24oIGV2ZW50ICkge1xuXHRcdFx0XHRcdGlmICggZXZlbnQua2V5Q29kZSA9PT0gJC51aS5rZXlDb2RlLlNQQUNFICkge1xuXHRcdFx0XHRcdFx0ZXZlbnQucHJldmVudERlZmF1bHQoKTtcblxuXHRcdFx0XHRcdFx0Ly8gU3VwcG9ydDogUGhhbnRvbUpTIDw9IDEuOSwgSUUgOCBPbmx5XG5cdFx0XHRcdFx0XHQvLyBJZiBhIG5hdGl2ZSBjbGljayBpcyBhdmFpbGFibGUgdXNlIGl0IHNvIHdlIGFjdHVhbGx5IGNhdXNlIG5hdmlnYXRpb25cblx0XHRcdFx0XHRcdC8vIG90aGVyd2lzZSBqdXN0IHRyaWdnZXIgYSBjbGljayBldmVudFxuXHRcdFx0XHRcdFx0aWYgKCB0aGlzLmVsZW1lbnRbIDAgXS5jbGljayApIHtcblx0XHRcdFx0XHRcdFx0dGhpcy5lbGVtZW50WyAwIF0uY2xpY2soKTtcblx0XHRcdFx0XHRcdH0gZWxzZSB7XG5cdFx0XHRcdFx0XHRcdHRoaXMuZWxlbWVudC50cmlnZ2VyKCBcImNsaWNrXCIgKTtcblx0XHRcdFx0XHRcdH1cblx0XHRcdFx0XHR9XG5cdFx0XHRcdH1cblx0XHRcdH0gKTtcblx0XHR9XG5cdH0sXG5cblx0X2VuaGFuY2U6IGZ1bmN0aW9uKCkge1xuXHRcdGlmICggIXRoaXMuZWxlbWVudC5pcyggXCJidXR0b25cIiApICkge1xuXHRcdFx0dGhpcy5lbGVtZW50LmF0dHIoIFwicm9sZVwiLCBcImJ1dHRvblwiICk7XG5cdFx0fVxuXG5cdFx0aWYgKCB0aGlzLm9wdGlvbnMuaWNvbiApIHtcblx0XHRcdHRoaXMuX3VwZGF0ZUljb24oIFwiaWNvblwiLCB0aGlzLm9wdGlvbnMuaWNvbiApO1xuXHRcdFx0dGhpcy5fdXBkYXRlVG9vbHRpcCgpO1xuXHRcdH1cblx0fSxcblxuXHRfdXBkYXRlVG9vbHRpcDogZnVuY3Rpb24oKSB7XG5cdFx0dGhpcy50aXRsZSA9IHRoaXMuZWxlbWVudC5hdHRyKCBcInRpdGxlXCIgKTtcblxuXHRcdGlmICggIXRoaXMub3B0aW9ucy5zaG93TGFiZWwgJiYgIXRoaXMudGl0bGUgKSB7XG5cdFx0XHR0aGlzLmVsZW1lbnQuYXR0ciggXCJ0aXRsZVwiLCB0aGlzLm9wdGlvbnMubGFiZWwgKTtcblx0XHR9XG5cdH0sXG5cblx0X3VwZGF0ZUljb246IGZ1bmN0aW9uKCBvcHRpb24sIHZhbHVlICkge1xuXHRcdHZhciBpY29uID0gb3B0aW9uICE9PSBcImljb25Qb3NpdGlvblwiLFxuXHRcdFx0cG9zaXRpb24gPSBpY29uID8gdGhpcy5vcHRpb25zLmljb25Qb3NpdGlvbiA6IHZhbHVlLFxuXHRcdFx0ZGlzcGxheUJsb2NrID0gcG9zaXRpb24gPT09IFwidG9wXCIgfHwgcG9zaXRpb24gPT09IFwiYm90dG9tXCI7XG5cblx0XHQvLyBDcmVhdGUgaWNvblxuXHRcdGlmICggIXRoaXMuaWNvbiApIHtcblx0XHRcdHRoaXMuaWNvbiA9ICQoIFwiPHNwYW4+XCIgKTtcblxuXHRcdFx0dGhpcy5fYWRkQ2xhc3MoIHRoaXMuaWNvbiwgXCJ1aS1idXR0b24taWNvblwiLCBcInVpLWljb25cIiApO1xuXG5cdFx0XHRpZiAoICF0aGlzLm9wdGlvbnMuc2hvd0xhYmVsICkge1xuXHRcdFx0XHR0aGlzLl9hZGRDbGFzcyggXCJ1aS1idXR0b24taWNvbi1vbmx5XCIgKTtcblx0XHRcdH1cblx0XHR9IGVsc2UgaWYgKCBpY29uICkge1xuXG5cdFx0XHQvLyBJZiB3ZSBhcmUgdXBkYXRpbmcgdGhlIGljb24gcmVtb3ZlIHRoZSBvbGQgaWNvbiBjbGFzc1xuXHRcdFx0dGhpcy5fcmVtb3ZlQ2xhc3MoIHRoaXMuaWNvbiwgbnVsbCwgdGhpcy5vcHRpb25zLmljb24gKTtcblx0XHR9XG5cblx0XHQvLyBJZiB3ZSBhcmUgdXBkYXRpbmcgdGhlIGljb24gYWRkIHRoZSBuZXcgaWNvbiBjbGFzc1xuXHRcdGlmICggaWNvbiApIHtcblx0XHRcdHRoaXMuX2FkZENsYXNzKCB0aGlzLmljb24sIG51bGwsIHZhbHVlICk7XG5cdFx0fVxuXG5cdFx0dGhpcy5fYXR0YWNoSWNvbiggcG9zaXRpb24gKTtcblxuXHRcdC8vIElmIHRoZSBpY29uIGlzIG9uIHRvcCBvciBib3R0b20gd2UgbmVlZCB0byBhZGQgdGhlIHVpLXdpZGdldC1pY29uLWJsb2NrIGNsYXNzIGFuZCByZW1vdmVcblx0XHQvLyB0aGUgaWNvblNwYWNlIGlmIHRoZXJlIGlzIG9uZS5cblx0XHRpZiAoIGRpc3BsYXlCbG9jayApIHtcblx0XHRcdHRoaXMuX2FkZENsYXNzKCB0aGlzLmljb24sIG51bGwsIFwidWktd2lkZ2V0LWljb24tYmxvY2tcIiApO1xuXHRcdFx0aWYgKCB0aGlzLmljb25TcGFjZSApIHtcblx0XHRcdFx0dGhpcy5pY29uU3BhY2UucmVtb3ZlKCk7XG5cdFx0XHR9XG5cdFx0fSBlbHNlIHtcblxuXHRcdFx0Ly8gUG9zaXRpb24gaXMgYmVnaW5uaW5nIG9yIGVuZCBzbyByZW1vdmUgdGhlIHVpLXdpZGdldC1pY29uLWJsb2NrIGNsYXNzIGFuZCBhZGQgdGhlXG5cdFx0XHQvLyBzcGFjZSBpZiBpdCBkb2VzIG5vdCBleGlzdFxuXHRcdFx0aWYgKCAhdGhpcy5pY29uU3BhY2UgKSB7XG5cdFx0XHRcdHRoaXMuaWNvblNwYWNlID0gJCggXCI8c3Bhbj4gPC9zcGFuPlwiICk7XG5cdFx0XHRcdHRoaXMuX2FkZENsYXNzKCB0aGlzLmljb25TcGFjZSwgXCJ1aS1idXR0b24taWNvbi1zcGFjZVwiICk7XG5cdFx0XHR9XG5cdFx0XHR0aGlzLl9yZW1vdmVDbGFzcyggdGhpcy5pY29uLCBudWxsLCBcInVpLXdpZ2V0LWljb24tYmxvY2tcIiApO1xuXHRcdFx0dGhpcy5fYXR0YWNoSWNvblNwYWNlKCBwb3NpdGlvbiApO1xuXHRcdH1cblx0fSxcblxuXHRfZGVzdHJveTogZnVuY3Rpb24oKSB7XG5cdFx0dGhpcy5lbGVtZW50LnJlbW92ZUF0dHIoIFwicm9sZVwiICk7XG5cblx0XHRpZiAoIHRoaXMuaWNvbiApIHtcblx0XHRcdHRoaXMuaWNvbi5yZW1vdmUoKTtcblx0XHR9XG5cdFx0aWYgKCB0aGlzLmljb25TcGFjZSApIHtcblx0XHRcdHRoaXMuaWNvblNwYWNlLnJlbW92ZSgpO1xuXHRcdH1cblx0XHRpZiAoICF0aGlzLmhhc1RpdGxlICkge1xuXHRcdFx0dGhpcy5lbGVtZW50LnJlbW92ZUF0dHIoIFwidGl0bGVcIiApO1xuXHRcdH1cblx0fSxcblxuXHRfYXR0YWNoSWNvblNwYWNlOiBmdW5jdGlvbiggaWNvblBvc2l0aW9uICkge1xuXHRcdHRoaXMuaWNvblsgL14oPzplbmR8Ym90dG9tKS8udGVzdCggaWNvblBvc2l0aW9uICkgPyBcImJlZm9yZVwiIDogXCJhZnRlclwiIF0oIHRoaXMuaWNvblNwYWNlICk7XG5cdH0sXG5cblx0X2F0dGFjaEljb246IGZ1bmN0aW9uKCBpY29uUG9zaXRpb24gKSB7XG5cdFx0dGhpcy5lbGVtZW50WyAvXig/OmVuZHxib3R0b20pLy50ZXN0KCBpY29uUG9zaXRpb24gKSA/IFwiYXBwZW5kXCIgOiBcInByZXBlbmRcIiBdKCB0aGlzLmljb24gKTtcblx0fSxcblxuXHRfc2V0T3B0aW9uczogZnVuY3Rpb24oIG9wdGlvbnMgKSB7XG5cdFx0dmFyIG5ld1Nob3dMYWJlbCA9IG9wdGlvbnMuc2hvd0xhYmVsID09PSB1bmRlZmluZWQgP1xuXHRcdFx0XHR0aGlzLm9wdGlvbnMuc2hvd0xhYmVsIDpcblx0XHRcdFx0b3B0aW9ucy5zaG93TGFiZWwsXG5cdFx0XHRuZXdJY29uID0gb3B0aW9ucy5pY29uID09PSB1bmRlZmluZWQgPyB0aGlzLm9wdGlvbnMuaWNvbiA6IG9wdGlvbnMuaWNvbjtcblxuXHRcdGlmICggIW5ld1Nob3dMYWJlbCAmJiAhbmV3SWNvbiApIHtcblx0XHRcdG9wdGlvbnMuc2hvd0xhYmVsID0gdHJ1ZTtcblx0XHR9XG5cdFx0dGhpcy5fc3VwZXIoIG9wdGlvbnMgKTtcblx0fSxcblxuXHRfc2V0T3B0aW9uOiBmdW5jdGlvbigga2V5LCB2YWx1ZSApIHtcblx0XHRpZiAoIGtleSA9PT0gXCJpY29uXCIgKSB7XG5cdFx0XHRpZiAoIHZhbHVlICkge1xuXHRcdFx0XHR0aGlzLl91cGRhdGVJY29uKCBrZXksIHZhbHVlICk7XG5cdFx0XHR9IGVsc2UgaWYgKCB0aGlzLmljb24gKSB7XG5cdFx0XHRcdHRoaXMuaWNvbi5yZW1vdmUoKTtcblx0XHRcdFx0aWYgKCB0aGlzLmljb25TcGFjZSApIHtcblx0XHRcdFx0XHR0aGlzLmljb25TcGFjZS5yZW1vdmUoKTtcblx0XHRcdFx0fVxuXHRcdFx0fVxuXHRcdH1cblxuXHRcdGlmICgga2V5ID09PSBcImljb25Qb3NpdGlvblwiICkge1xuXHRcdFx0dGhpcy5fdXBkYXRlSWNvbigga2V5LCB2YWx1ZSApO1xuXHRcdH1cblxuXHRcdC8vIE1ha2Ugc3VyZSB3ZSBjYW4ndCBlbmQgdXAgd2l0aCBhIGJ1dHRvbiB0aGF0IGhhcyBuZWl0aGVyIHRleHQgbm9yIGljb25cblx0XHRpZiAoIGtleSA9PT0gXCJzaG93TGFiZWxcIiApIHtcblx0XHRcdFx0dGhpcy5fdG9nZ2xlQ2xhc3MoIFwidWktYnV0dG9uLWljb24tb25seVwiLCBudWxsLCAhdmFsdWUgKTtcblx0XHRcdFx0dGhpcy5fdXBkYXRlVG9vbHRpcCgpO1xuXHRcdH1cblxuXHRcdGlmICgga2V5ID09PSBcImxhYmVsXCIgKSB7XG5cdFx0XHRpZiAoIHRoaXMuaXNJbnB1dCApIHtcblx0XHRcdFx0dGhpcy5lbGVtZW50LnZhbCggdmFsdWUgKTtcblx0XHRcdH0gZWxzZSB7XG5cblx0XHRcdFx0Ly8gSWYgdGhlcmUgaXMgYW4gaWNvbiwgYXBwZW5kIGl0LCBlbHNlIG5vdGhpbmcgdGhlbiBhcHBlbmQgdGhlIHZhbHVlXG5cdFx0XHRcdC8vIHRoaXMgYXZvaWRzIHJlbW92YWwgb2YgdGhlIGljb24gd2hlbiBzZXR0aW5nIGxhYmVsIHRleHRcblx0XHRcdFx0dGhpcy5lbGVtZW50Lmh0bWwoIHZhbHVlICk7XG5cdFx0XHRcdGlmICggdGhpcy5pY29uICkge1xuXHRcdFx0XHRcdHRoaXMuX2F0dGFjaEljb24oIHRoaXMub3B0aW9ucy5pY29uUG9zaXRpb24gKTtcblx0XHRcdFx0XHR0aGlzLl9hdHRhY2hJY29uU3BhY2UoIHRoaXMub3B0aW9ucy5pY29uUG9zaXRpb24gKTtcblx0XHRcdFx0fVxuXHRcdFx0fVxuXHRcdH1cblxuXHRcdHRoaXMuX3N1cGVyKCBrZXksIHZhbHVlICk7XG5cblx0XHRpZiAoIGtleSA9PT0gXCJkaXNhYmxlZFwiICkge1xuXHRcdFx0dGhpcy5fdG9nZ2xlQ2xhc3MoIG51bGwsIFwidWktc3RhdGUtZGlzYWJsZWRcIiwgdmFsdWUgKTtcblx0XHRcdHRoaXMuZWxlbWVudFsgMCBdLmRpc2FibGVkID0gdmFsdWU7XG5cdFx0XHRpZiAoIHZhbHVlICkge1xuXHRcdFx0XHR0aGlzLmVsZW1lbnQuYmx1cigpO1xuXHRcdFx0fVxuXHRcdH1cblx0fSxcblxuXHRyZWZyZXNoOiBmdW5jdGlvbigpIHtcblxuXHRcdC8vIE1ha2Ugc3VyZSB0byBvbmx5IGNoZWNrIGRpc2FibGVkIGlmIGl0cyBhbiBlbGVtZW50IHRoYXQgc3VwcG9ydHMgdGhpcyBvdGhlcndpc2Vcblx0XHQvLyBjaGVjayBmb3IgdGhlIGRpc2FibGVkIGNsYXNzIHRvIGRldGVybWluZSBzdGF0ZVxuXHRcdHZhciBpc0Rpc2FibGVkID0gdGhpcy5lbGVtZW50LmlzKCBcImlucHV0LCBidXR0b25cIiApID9cblx0XHRcdHRoaXMuZWxlbWVudFsgMCBdLmRpc2FibGVkIDogdGhpcy5lbGVtZW50Lmhhc0NsYXNzKCBcInVpLWJ1dHRvbi1kaXNhYmxlZFwiICk7XG5cblx0XHRpZiAoIGlzRGlzYWJsZWQgIT09IHRoaXMub3B0aW9ucy5kaXNhYmxlZCApIHtcblx0XHRcdHRoaXMuX3NldE9wdGlvbnMoIHsgZGlzYWJsZWQ6IGlzRGlzYWJsZWQgfSApO1xuXHRcdH1cblxuXHRcdHRoaXMuX3VwZGF0ZVRvb2x0aXAoKTtcblx0fVxufSApO1xuXG4vLyBERVBSRUNBVEVEXG5pZiAoICQudWlCYWNrQ29tcGF0ICE9PSBmYWxzZSApIHtcblxuXHQvLyBUZXh0IGFuZCBJY29ucyBvcHRpb25zXG5cdCQud2lkZ2V0KCBcInVpLmJ1dHRvblwiLCAkLnVpLmJ1dHRvbiwge1xuXHRcdG9wdGlvbnM6IHtcblx0XHRcdHRleHQ6IHRydWUsXG5cdFx0XHRpY29uczoge1xuXHRcdFx0XHRwcmltYXJ5OiBudWxsLFxuXHRcdFx0XHRzZWNvbmRhcnk6IG51bGxcblx0XHRcdH1cblx0XHR9LFxuXG5cdFx0X2NyZWF0ZTogZnVuY3Rpb24oKSB7XG5cdFx0XHRpZiAoIHRoaXMub3B0aW9ucy5zaG93TGFiZWwgJiYgIXRoaXMub3B0aW9ucy50ZXh0ICkge1xuXHRcdFx0XHR0aGlzLm9wdGlvbnMuc2hvd0xhYmVsID0gdGhpcy5vcHRpb25zLnRleHQ7XG5cdFx0XHR9XG5cdFx0XHRpZiAoICF0aGlzLm9wdGlvbnMuc2hvd0xhYmVsICYmIHRoaXMub3B0aW9ucy50ZXh0ICkge1xuXHRcdFx0XHR0aGlzLm9wdGlvbnMudGV4dCA9IHRoaXMub3B0aW9ucy5zaG93TGFiZWw7XG5cdFx0XHR9XG5cdFx0XHRpZiAoICF0aGlzLm9wdGlvbnMuaWNvbiAmJiAoIHRoaXMub3B0aW9ucy5pY29ucy5wcmltYXJ5IHx8XG5cdFx0XHRcdFx0dGhpcy5vcHRpb25zLmljb25zLnNlY29uZGFyeSApICkge1xuXHRcdFx0XHRpZiAoIHRoaXMub3B0aW9ucy5pY29ucy5wcmltYXJ5ICkge1xuXHRcdFx0XHRcdHRoaXMub3B0aW9ucy5pY29uID0gdGhpcy5vcHRpb25zLmljb25zLnByaW1hcnk7XG5cdFx0XHRcdH0gZWxzZSB7XG5cdFx0XHRcdFx0dGhpcy5vcHRpb25zLmljb24gPSB0aGlzLm9wdGlvbnMuaWNvbnMuc2Vjb25kYXJ5O1xuXHRcdFx0XHRcdHRoaXMub3B0aW9ucy5pY29uUG9zaXRpb24gPSBcImVuZFwiO1xuXHRcdFx0XHR9XG5cdFx0XHR9IGVsc2UgaWYgKCB0aGlzLm9wdGlvbnMuaWNvbiApIHtcblx0XHRcdFx0dGhpcy5vcHRpb25zLmljb25zLnByaW1hcnkgPSB0aGlzLm9wdGlvbnMuaWNvbjtcblx0XHRcdH1cblx0XHRcdHRoaXMuX3N1cGVyKCk7XG5cdFx0fSxcblxuXHRcdF9zZXRPcHRpb246IGZ1bmN0aW9uKCBrZXksIHZhbHVlICkge1xuXHRcdFx0aWYgKCBrZXkgPT09IFwidGV4dFwiICkge1xuXHRcdFx0XHR0aGlzLl9zdXBlciggXCJzaG93TGFiZWxcIiwgdmFsdWUgKTtcblx0XHRcdFx0cmV0dXJuO1xuXHRcdFx0fVxuXHRcdFx0aWYgKCBrZXkgPT09IFwic2hvd0xhYmVsXCIgKSB7XG5cdFx0XHRcdHRoaXMub3B0aW9ucy50ZXh0ID0gdmFsdWU7XG5cdFx0XHR9XG5cdFx0XHRpZiAoIGtleSA9PT0gXCJpY29uXCIgKSB7XG5cdFx0XHRcdHRoaXMub3B0aW9ucy5pY29ucy5wcmltYXJ5ID0gdmFsdWU7XG5cdFx0XHR9XG5cdFx0XHRpZiAoIGtleSA9PT0gXCJpY29uc1wiICkge1xuXHRcdFx0XHRpZiAoIHZhbHVlLnByaW1hcnkgKSB7XG5cdFx0XHRcdFx0dGhpcy5fc3VwZXIoIFwiaWNvblwiLCB2YWx1ZS5wcmltYXJ5ICk7XG5cdFx0XHRcdFx0dGhpcy5fc3VwZXIoIFwiaWNvblBvc2l0aW9uXCIsIFwiYmVnaW5uaW5nXCIgKTtcblx0XHRcdFx0fSBlbHNlIGlmICggdmFsdWUuc2Vjb25kYXJ5ICkge1xuXHRcdFx0XHRcdHRoaXMuX3N1cGVyKCBcImljb25cIiwgdmFsdWUuc2Vjb25kYXJ5ICk7XG5cdFx0XHRcdFx0dGhpcy5fc3VwZXIoIFwiaWNvblBvc2l0aW9uXCIsIFwiZW5kXCIgKTtcblx0XHRcdFx0fVxuXHRcdFx0fVxuXHRcdFx0dGhpcy5fc3VwZXJBcHBseSggYXJndW1lbnRzICk7XG5cdFx0fVxuXHR9ICk7XG5cblx0JC5mbi5idXR0b24gPSAoIGZ1bmN0aW9uKCBvcmlnICkge1xuXHRcdHJldHVybiBmdW5jdGlvbigpIHtcblx0XHRcdGlmICggIXRoaXMubGVuZ3RoIHx8ICggdGhpcy5sZW5ndGggJiYgdGhpc1sgMCBdLnRhZ05hbWUgIT09IFwiSU5QVVRcIiApIHx8XG5cdFx0XHRcdFx0KCB0aGlzLmxlbmd0aCAmJiB0aGlzWyAwIF0udGFnTmFtZSA9PT0gXCJJTlBVVFwiICYmIChcblx0XHRcdFx0XHRcdHRoaXMuYXR0ciggXCJ0eXBlXCIgKSAhPT0gXCJjaGVja2JveFwiICYmIHRoaXMuYXR0ciggXCJ0eXBlXCIgKSAhPT0gXCJyYWRpb1wiXG5cdFx0XHRcdFx0KSApICkge1xuXHRcdFx0XHRyZXR1cm4gb3JpZy5hcHBseSggdGhpcywgYXJndW1lbnRzICk7XG5cdFx0XHR9XG5cdFx0XHRpZiAoICEkLnVpLmNoZWNrYm94cmFkaW8gKSB7XG5cdFx0XHRcdCQuZXJyb3IoIFwiQ2hlY2tib3hyYWRpbyB3aWRnZXQgbWlzc2luZ1wiICk7XG5cdFx0XHR9XG5cdFx0XHRpZiAoIGFyZ3VtZW50cy5sZW5ndGggPT09IDAgKSB7XG5cdFx0XHRcdHJldHVybiB0aGlzLmNoZWNrYm94cmFkaW8oIHtcblx0XHRcdFx0XHRcImljb25cIjogZmFsc2Vcblx0XHRcdFx0fSApO1xuXHRcdFx0fVxuXHRcdFx0cmV0dXJuIHRoaXMuY2hlY2tib3hyYWRpby5hcHBseSggdGhpcywgYXJndW1lbnRzICk7XG5cdFx0fTtcblx0fSApKCAkLmZuLmJ1dHRvbiApO1xuXG5cdCQuZm4uYnV0dG9uc2V0ID0gZnVuY3Rpb24oKSB7XG5cdFx0aWYgKCAhJC51aS5jb250cm9sZ3JvdXAgKSB7XG5cdFx0XHQkLmVycm9yKCBcIkNvbnRyb2xncm91cCB3aWRnZXQgbWlzc2luZ1wiICk7XG5cdFx0fVxuXHRcdGlmICggYXJndW1lbnRzWyAwIF0gPT09IFwib3B0aW9uXCIgJiYgYXJndW1lbnRzWyAxIF0gPT09IFwiaXRlbXNcIiAmJiBhcmd1bWVudHNbIDIgXSApIHtcblx0XHRcdHJldHVybiB0aGlzLmNvbnRyb2xncm91cC5hcHBseSggdGhpcyxcblx0XHRcdFx0WyBhcmd1bWVudHNbIDAgXSwgXCJpdGVtcy5idXR0b25cIiwgYXJndW1lbnRzWyAyIF0gXSApO1xuXHRcdH1cblx0XHRpZiAoIGFyZ3VtZW50c1sgMCBdID09PSBcIm9wdGlvblwiICYmIGFyZ3VtZW50c1sgMSBdID09PSBcIml0ZW1zXCIgKSB7XG5cdFx0XHRyZXR1cm4gdGhpcy5jb250cm9sZ3JvdXAuYXBwbHkoIHRoaXMsIFsgYXJndW1lbnRzWyAwIF0sIFwiaXRlbXMuYnV0dG9uXCIgXSApO1xuXHRcdH1cblx0XHRpZiAoIHR5cGVvZiBhcmd1bWVudHNbIDAgXSA9PT0gXCJvYmplY3RcIiAmJiBhcmd1bWVudHNbIDAgXS5pdGVtcyApIHtcblx0XHRcdGFyZ3VtZW50c1sgMCBdLml0ZW1zID0ge1xuXHRcdFx0XHRidXR0b246IGFyZ3VtZW50c1sgMCBdLml0ZW1zXG5cdFx0XHR9O1xuXHRcdH1cblx0XHRyZXR1cm4gdGhpcy5jb250cm9sZ3JvdXAuYXBwbHkoIHRoaXMsIGFyZ3VtZW50cyApO1xuXHR9O1xufVxuXG5yZXR1cm4gJC51aS5idXR0b247XG5cbn0gKSApO1xuIiwiLyohXG4gKiBqUXVlcnkgVUkgRGlhbG9nIDEuMTIuMVxuICogaHR0cDovL2pxdWVyeXVpLmNvbVxuICpcbiAqIENvcHlyaWdodCBqUXVlcnkgRm91bmRhdGlvbiBhbmQgb3RoZXIgY29udHJpYnV0b3JzXG4gKiBSZWxlYXNlZCB1bmRlciB0aGUgTUlUIGxpY2Vuc2UuXG4gKiBodHRwOi8vanF1ZXJ5Lm9yZy9saWNlbnNlXG4gKi9cblxuLy8+PmxhYmVsOiBEaWFsb2dcbi8vPj5ncm91cDogV2lkZ2V0c1xuLy8+PmRlc2NyaXB0aW9uOiBEaXNwbGF5cyBjdXN0b21pemFibGUgZGlhbG9nIHdpbmRvd3MuXG4vLz4+ZG9jczogaHR0cDovL2FwaS5qcXVlcnl1aS5jb20vZGlhbG9nL1xuLy8+PmRlbW9zOiBodHRwOi8vanF1ZXJ5dWkuY29tL2RpYWxvZy9cbi8vPj5jc3Muc3RydWN0dXJlOiAuLi8uLi90aGVtZXMvYmFzZS9jb3JlLmNzc1xuLy8+PmNzcy5zdHJ1Y3R1cmU6IC4uLy4uL3RoZW1lcy9iYXNlL2RpYWxvZy5jc3Ncbi8vPj5jc3MudGhlbWU6IC4uLy4uL3RoZW1lcy9iYXNlL3RoZW1lLmNzc1xuXG4oIGZ1bmN0aW9uKCBmYWN0b3J5ICkge1xuXHRpZiAoIHR5cGVvZiBkZWZpbmUgPT09IFwiZnVuY3Rpb25cIiAmJiBkZWZpbmUuYW1kICkge1xuXG5cdFx0Ly8gQU1ELiBSZWdpc3RlciBhcyBhbiBhbm9ueW1vdXMgbW9kdWxlLlxuXHRcdGRlZmluZSggW1xuXHRcdFx0XCJqcXVlcnlcIixcblx0XHRcdFwiLi9idXR0b25cIixcblx0XHRcdFwiLi9kcmFnZ2FibGVcIixcblx0XHRcdFwiLi9tb3VzZVwiLFxuXHRcdFx0XCIuL3Jlc2l6YWJsZVwiLFxuXHRcdFx0XCIuLi9mb2N1c2FibGVcIixcblx0XHRcdFwiLi4va2V5Y29kZVwiLFxuXHRcdFx0XCIuLi9wb3NpdGlvblwiLFxuXHRcdFx0XCIuLi9zYWZlLWFjdGl2ZS1lbGVtZW50XCIsXG5cdFx0XHRcIi4uL3NhZmUtYmx1clwiLFxuXHRcdFx0XCIuLi90YWJiYWJsZVwiLFxuXHRcdFx0XCIuLi91bmlxdWUtaWRcIixcblx0XHRcdFwiLi4vdmVyc2lvblwiLFxuXHRcdFx0XCIuLi93aWRnZXRcIlxuXHRcdF0sIGZhY3RvcnkgKTtcblx0fSBlbHNlIHtcblxuXHRcdC8vIEJyb3dzZXIgZ2xvYmFsc1xuXHRcdGZhY3RvcnkoIGpRdWVyeSApO1xuXHR9XG59KCBmdW5jdGlvbiggJCApIHtcblxuJC53aWRnZXQoIFwidWkuZGlhbG9nXCIsIHtcblx0dmVyc2lvbjogXCIxLjEyLjFcIixcblx0b3B0aW9uczoge1xuXHRcdGFwcGVuZFRvOiBcImJvZHlcIixcblx0XHRhdXRvT3BlbjogdHJ1ZSxcblx0XHRidXR0b25zOiBbXSxcblx0XHRjbGFzc2VzOiB7XG5cdFx0XHRcInVpLWRpYWxvZ1wiOiBcInVpLWNvcm5lci1hbGxcIixcblx0XHRcdFwidWktZGlhbG9nLXRpdGxlYmFyXCI6IFwidWktY29ybmVyLWFsbFwiXG5cdFx0fSxcblx0XHRjbG9zZU9uRXNjYXBlOiB0cnVlLFxuXHRcdGNsb3NlVGV4dDogXCJDbG9zZVwiLFxuXHRcdGRyYWdnYWJsZTogdHJ1ZSxcblx0XHRoaWRlOiBudWxsLFxuXHRcdGhlaWdodDogXCJhdXRvXCIsXG5cdFx0bWF4SGVpZ2h0OiBudWxsLFxuXHRcdG1heFdpZHRoOiBudWxsLFxuXHRcdG1pbkhlaWdodDogMTUwLFxuXHRcdG1pbldpZHRoOiAxNTAsXG5cdFx0bW9kYWw6IGZhbHNlLFxuXHRcdHBvc2l0aW9uOiB7XG5cdFx0XHRteTogXCJjZW50ZXJcIixcblx0XHRcdGF0OiBcImNlbnRlclwiLFxuXHRcdFx0b2Y6IHdpbmRvdyxcblx0XHRcdGNvbGxpc2lvbjogXCJmaXRcIixcblxuXHRcdFx0Ly8gRW5zdXJlIHRoZSB0aXRsZWJhciBpcyBhbHdheXMgdmlzaWJsZVxuXHRcdFx0dXNpbmc6IGZ1bmN0aW9uKCBwb3MgKSB7XG5cdFx0XHRcdHZhciB0b3BPZmZzZXQgPSAkKCB0aGlzICkuY3NzKCBwb3MgKS5vZmZzZXQoKS50b3A7XG5cdFx0XHRcdGlmICggdG9wT2Zmc2V0IDwgMCApIHtcblx0XHRcdFx0XHQkKCB0aGlzICkuY3NzKCBcInRvcFwiLCBwb3MudG9wIC0gdG9wT2Zmc2V0ICk7XG5cdFx0XHRcdH1cblx0XHRcdH1cblx0XHR9LFxuXHRcdHJlc2l6YWJsZTogdHJ1ZSxcblx0XHRzaG93OiBudWxsLFxuXHRcdHRpdGxlOiBudWxsLFxuXHRcdHdpZHRoOiAzMDAsXG5cblx0XHQvLyBDYWxsYmFja3Ncblx0XHRiZWZvcmVDbG9zZTogbnVsbCxcblx0XHRjbG9zZTogbnVsbCxcblx0XHRkcmFnOiBudWxsLFxuXHRcdGRyYWdTdGFydDogbnVsbCxcblx0XHRkcmFnU3RvcDogbnVsbCxcblx0XHRmb2N1czogbnVsbCxcblx0XHRvcGVuOiBudWxsLFxuXHRcdHJlc2l6ZTogbnVsbCxcblx0XHRyZXNpemVTdGFydDogbnVsbCxcblx0XHRyZXNpemVTdG9wOiBudWxsXG5cdH0sXG5cblx0c2l6ZVJlbGF0ZWRPcHRpb25zOiB7XG5cdFx0YnV0dG9uczogdHJ1ZSxcblx0XHRoZWlnaHQ6IHRydWUsXG5cdFx0bWF4SGVpZ2h0OiB0cnVlLFxuXHRcdG1heFdpZHRoOiB0cnVlLFxuXHRcdG1pbkhlaWdodDogdHJ1ZSxcblx0XHRtaW5XaWR0aDogdHJ1ZSxcblx0XHR3aWR0aDogdHJ1ZVxuXHR9LFxuXG5cdHJlc2l6YWJsZVJlbGF0ZWRPcHRpb25zOiB7XG5cdFx0bWF4SGVpZ2h0OiB0cnVlLFxuXHRcdG1heFdpZHRoOiB0cnVlLFxuXHRcdG1pbkhlaWdodDogdHJ1ZSxcblx0XHRtaW5XaWR0aDogdHJ1ZVxuXHR9LFxuXG5cdF9jcmVhdGU6IGZ1bmN0aW9uKCkge1xuXHRcdHRoaXMub3JpZ2luYWxDc3MgPSB7XG5cdFx0XHRkaXNwbGF5OiB0aGlzLmVsZW1lbnRbIDAgXS5zdHlsZS5kaXNwbGF5LFxuXHRcdFx0d2lkdGg6IHRoaXMuZWxlbWVudFsgMCBdLnN0eWxlLndpZHRoLFxuXHRcdFx0bWluSGVpZ2h0OiB0aGlzLmVsZW1lbnRbIDAgXS5zdHlsZS5taW5IZWlnaHQsXG5cdFx0XHRtYXhIZWlnaHQ6IHRoaXMuZWxlbWVudFsgMCBdLnN0eWxlLm1heEhlaWdodCxcblx0XHRcdGhlaWdodDogdGhpcy5lbGVtZW50WyAwIF0uc3R5bGUuaGVpZ2h0XG5cdFx0fTtcblx0XHR0aGlzLm9yaWdpbmFsUG9zaXRpb24gPSB7XG5cdFx0XHRwYXJlbnQ6IHRoaXMuZWxlbWVudC5wYXJlbnQoKSxcblx0XHRcdGluZGV4OiB0aGlzLmVsZW1lbnQucGFyZW50KCkuY2hpbGRyZW4oKS5pbmRleCggdGhpcy5lbGVtZW50IClcblx0XHR9O1xuXHRcdHRoaXMub3JpZ2luYWxUaXRsZSA9IHRoaXMuZWxlbWVudC5hdHRyKCBcInRpdGxlXCIgKTtcblx0XHRpZiAoIHRoaXMub3B0aW9ucy50aXRsZSA9PSBudWxsICYmIHRoaXMub3JpZ2luYWxUaXRsZSAhPSBudWxsICkge1xuXHRcdFx0dGhpcy5vcHRpb25zLnRpdGxlID0gdGhpcy5vcmlnaW5hbFRpdGxlO1xuXHRcdH1cblxuXHRcdC8vIERpYWxvZ3MgY2FuJ3QgYmUgZGlzYWJsZWRcblx0XHRpZiAoIHRoaXMub3B0aW9ucy5kaXNhYmxlZCApIHtcblx0XHRcdHRoaXMub3B0aW9ucy5kaXNhYmxlZCA9IGZhbHNlO1xuXHRcdH1cblxuXHRcdHRoaXMuX2NyZWF0ZVdyYXBwZXIoKTtcblxuXHRcdHRoaXMuZWxlbWVudFxuXHRcdFx0LnNob3coKVxuXHRcdFx0LnJlbW92ZUF0dHIoIFwidGl0bGVcIiApXG5cdFx0XHQuYXBwZW5kVG8oIHRoaXMudWlEaWFsb2cgKTtcblxuXHRcdHRoaXMuX2FkZENsYXNzKCBcInVpLWRpYWxvZy1jb250ZW50XCIsIFwidWktd2lkZ2V0LWNvbnRlbnRcIiApO1xuXG5cdFx0dGhpcy5fY3JlYXRlVGl0bGViYXIoKTtcblx0XHR0aGlzLl9jcmVhdGVCdXR0b25QYW5lKCk7XG5cblx0XHRpZiAoIHRoaXMub3B0aW9ucy5kcmFnZ2FibGUgJiYgJC5mbi5kcmFnZ2FibGUgKSB7XG5cdFx0XHR0aGlzLl9tYWtlRHJhZ2dhYmxlKCk7XG5cdFx0fVxuXHRcdGlmICggdGhpcy5vcHRpb25zLnJlc2l6YWJsZSAmJiAkLmZuLnJlc2l6YWJsZSApIHtcblx0XHRcdHRoaXMuX21ha2VSZXNpemFibGUoKTtcblx0XHR9XG5cblx0XHR0aGlzLl9pc09wZW4gPSBmYWxzZTtcblxuXHRcdHRoaXMuX3RyYWNrRm9jdXMoKTtcblx0fSxcblxuXHRfaW5pdDogZnVuY3Rpb24oKSB7XG5cdFx0aWYgKCB0aGlzLm9wdGlvbnMuYXV0b09wZW4gKSB7XG5cdFx0XHR0aGlzLm9wZW4oKTtcblx0XHR9XG5cdH0sXG5cblx0X2FwcGVuZFRvOiBmdW5jdGlvbigpIHtcblx0XHR2YXIgZWxlbWVudCA9IHRoaXMub3B0aW9ucy5hcHBlbmRUbztcblx0XHRpZiAoIGVsZW1lbnQgJiYgKCBlbGVtZW50LmpxdWVyeSB8fCBlbGVtZW50Lm5vZGVUeXBlICkgKSB7XG5cdFx0XHRyZXR1cm4gJCggZWxlbWVudCApO1xuXHRcdH1cblx0XHRyZXR1cm4gdGhpcy5kb2N1bWVudC5maW5kKCBlbGVtZW50IHx8IFwiYm9keVwiICkuZXEoIDAgKTtcblx0fSxcblxuXHRfZGVzdHJveTogZnVuY3Rpb24oKSB7XG5cdFx0dmFyIG5leHQsXG5cdFx0XHRvcmlnaW5hbFBvc2l0aW9uID0gdGhpcy5vcmlnaW5hbFBvc2l0aW9uO1xuXG5cdFx0dGhpcy5fdW50cmFja0luc3RhbmNlKCk7XG5cdFx0dGhpcy5fZGVzdHJveU92ZXJsYXkoKTtcblxuXHRcdHRoaXMuZWxlbWVudFxuXHRcdFx0LnJlbW92ZVVuaXF1ZUlkKClcblx0XHRcdC5jc3MoIHRoaXMub3JpZ2luYWxDc3MgKVxuXG5cdFx0XHQvLyBXaXRob3V0IGRldGFjaGluZyBmaXJzdCwgdGhlIGZvbGxvd2luZyBiZWNvbWVzIHJlYWxseSBzbG93XG5cdFx0XHQuZGV0YWNoKCk7XG5cblx0XHR0aGlzLnVpRGlhbG9nLnJlbW92ZSgpO1xuXG5cdFx0aWYgKCB0aGlzLm9yaWdpbmFsVGl0bGUgKSB7XG5cdFx0XHR0aGlzLmVsZW1lbnQuYXR0ciggXCJ0aXRsZVwiLCB0aGlzLm9yaWdpbmFsVGl0bGUgKTtcblx0XHR9XG5cblx0XHRuZXh0ID0gb3JpZ2luYWxQb3NpdGlvbi5wYXJlbnQuY2hpbGRyZW4oKS5lcSggb3JpZ2luYWxQb3NpdGlvbi5pbmRleCApO1xuXG5cdFx0Ly8gRG9uJ3QgdHJ5IHRvIHBsYWNlIHRoZSBkaWFsb2cgbmV4dCB0byBpdHNlbGYgKCM4NjEzKVxuXHRcdGlmICggbmV4dC5sZW5ndGggJiYgbmV4dFsgMCBdICE9PSB0aGlzLmVsZW1lbnRbIDAgXSApIHtcblx0XHRcdG5leHQuYmVmb3JlKCB0aGlzLmVsZW1lbnQgKTtcblx0XHR9IGVsc2Uge1xuXHRcdFx0b3JpZ2luYWxQb3NpdGlvbi5wYXJlbnQuYXBwZW5kKCB0aGlzLmVsZW1lbnQgKTtcblx0XHR9XG5cdH0sXG5cblx0d2lkZ2V0OiBmdW5jdGlvbigpIHtcblx0XHRyZXR1cm4gdGhpcy51aURpYWxvZztcblx0fSxcblxuXHRkaXNhYmxlOiAkLm5vb3AsXG5cdGVuYWJsZTogJC5ub29wLFxuXG5cdGNsb3NlOiBmdW5jdGlvbiggZXZlbnQgKSB7XG5cdFx0dmFyIHRoYXQgPSB0aGlzO1xuXG5cdFx0aWYgKCAhdGhpcy5faXNPcGVuIHx8IHRoaXMuX3RyaWdnZXIoIFwiYmVmb3JlQ2xvc2VcIiwgZXZlbnQgKSA9PT0gZmFsc2UgKSB7XG5cdFx0XHRyZXR1cm47XG5cdFx0fVxuXG5cdFx0dGhpcy5faXNPcGVuID0gZmFsc2U7XG5cdFx0dGhpcy5fZm9jdXNlZEVsZW1lbnQgPSBudWxsO1xuXHRcdHRoaXMuX2Rlc3Ryb3lPdmVybGF5KCk7XG5cdFx0dGhpcy5fdW50cmFja0luc3RhbmNlKCk7XG5cblx0XHRpZiAoICF0aGlzLm9wZW5lci5maWx0ZXIoIFwiOmZvY3VzYWJsZVwiICkudHJpZ2dlciggXCJmb2N1c1wiICkubGVuZ3RoICkge1xuXG5cdFx0XHQvLyBIaWRpbmcgYSBmb2N1c2VkIGVsZW1lbnQgZG9lc24ndCB0cmlnZ2VyIGJsdXIgaW4gV2ViS2l0XG5cdFx0XHQvLyBzbyBpbiBjYXNlIHdlIGhhdmUgbm90aGluZyB0byBmb2N1cyBvbiwgZXhwbGljaXRseSBibHVyIHRoZSBhY3RpdmUgZWxlbWVudFxuXHRcdFx0Ly8gaHR0cHM6Ly9idWdzLndlYmtpdC5vcmcvc2hvd19idWcuY2dpP2lkPTQ3MTgyXG5cdFx0XHQkLnVpLnNhZmVCbHVyKCAkLnVpLnNhZmVBY3RpdmVFbGVtZW50KCB0aGlzLmRvY3VtZW50WyAwIF0gKSApO1xuXHRcdH1cblxuXHRcdHRoaXMuX2hpZGUoIHRoaXMudWlEaWFsb2csIHRoaXMub3B0aW9ucy5oaWRlLCBmdW5jdGlvbigpIHtcblx0XHRcdHRoYXQuX3RyaWdnZXIoIFwiY2xvc2VcIiwgZXZlbnQgKTtcblx0XHR9ICk7XG5cdH0sXG5cblx0aXNPcGVuOiBmdW5jdGlvbigpIHtcblx0XHRyZXR1cm4gdGhpcy5faXNPcGVuO1xuXHR9LFxuXG5cdG1vdmVUb1RvcDogZnVuY3Rpb24oKSB7XG5cdFx0dGhpcy5fbW92ZVRvVG9wKCk7XG5cdH0sXG5cblx0X21vdmVUb1RvcDogZnVuY3Rpb24oIGV2ZW50LCBzaWxlbnQgKSB7XG5cdFx0dmFyIG1vdmVkID0gZmFsc2UsXG5cdFx0XHR6SW5kaWNlcyA9IHRoaXMudWlEaWFsb2cuc2libGluZ3MoIFwiLnVpLWZyb250OnZpc2libGVcIiApLm1hcCggZnVuY3Rpb24oKSB7XG5cdFx0XHRcdHJldHVybiArJCggdGhpcyApLmNzcyggXCJ6LWluZGV4XCIgKTtcblx0XHRcdH0gKS5nZXQoKSxcblx0XHRcdHpJbmRleE1heCA9IE1hdGgubWF4LmFwcGx5KCBudWxsLCB6SW5kaWNlcyApO1xuXG5cdFx0aWYgKCB6SW5kZXhNYXggPj0gK3RoaXMudWlEaWFsb2cuY3NzKCBcInotaW5kZXhcIiApICkge1xuXHRcdFx0dGhpcy51aURpYWxvZy5jc3MoIFwiei1pbmRleFwiLCB6SW5kZXhNYXggKyAxICk7XG5cdFx0XHRtb3ZlZCA9IHRydWU7XG5cdFx0fVxuXG5cdFx0aWYgKCBtb3ZlZCAmJiAhc2lsZW50ICkge1xuXHRcdFx0dGhpcy5fdHJpZ2dlciggXCJmb2N1c1wiLCBldmVudCApO1xuXHRcdH1cblx0XHRyZXR1cm4gbW92ZWQ7XG5cdH0sXG5cblx0b3BlbjogZnVuY3Rpb24oKSB7XG5cdFx0dmFyIHRoYXQgPSB0aGlzO1xuXHRcdGlmICggdGhpcy5faXNPcGVuICkge1xuXHRcdFx0aWYgKCB0aGlzLl9tb3ZlVG9Ub3AoKSApIHtcblx0XHRcdFx0dGhpcy5fZm9jdXNUYWJiYWJsZSgpO1xuXHRcdFx0fVxuXHRcdFx0cmV0dXJuO1xuXHRcdH1cblxuXHRcdHRoaXMuX2lzT3BlbiA9IHRydWU7XG5cdFx0dGhpcy5vcGVuZXIgPSAkKCAkLnVpLnNhZmVBY3RpdmVFbGVtZW50KCB0aGlzLmRvY3VtZW50WyAwIF0gKSApO1xuXG5cdFx0dGhpcy5fc2l6ZSgpO1xuXHRcdHRoaXMuX3Bvc2l0aW9uKCk7XG5cdFx0dGhpcy5fY3JlYXRlT3ZlcmxheSgpO1xuXHRcdHRoaXMuX21vdmVUb1RvcCggbnVsbCwgdHJ1ZSApO1xuXG5cdFx0Ly8gRW5zdXJlIHRoZSBvdmVybGF5IGlzIG1vdmVkIHRvIHRoZSB0b3Agd2l0aCB0aGUgZGlhbG9nLCBidXQgb25seSB3aGVuXG5cdFx0Ly8gb3BlbmluZy4gVGhlIG92ZXJsYXkgc2hvdWxkbid0IG1vdmUgYWZ0ZXIgdGhlIGRpYWxvZyBpcyBvcGVuIHNvIHRoYXRcblx0XHQvLyBtb2RlbGVzcyBkaWFsb2dzIG9wZW5lZCBhZnRlciB0aGUgbW9kYWwgZGlhbG9nIHN0YWNrIHByb3Blcmx5LlxuXHRcdGlmICggdGhpcy5vdmVybGF5ICkge1xuXHRcdFx0dGhpcy5vdmVybGF5LmNzcyggXCJ6LWluZGV4XCIsIHRoaXMudWlEaWFsb2cuY3NzKCBcInotaW5kZXhcIiApIC0gMSApO1xuXHRcdH1cblxuXHRcdHRoaXMuX3Nob3coIHRoaXMudWlEaWFsb2csIHRoaXMub3B0aW9ucy5zaG93LCBmdW5jdGlvbigpIHtcblx0XHRcdHRoYXQuX2ZvY3VzVGFiYmFibGUoKTtcblx0XHRcdHRoYXQuX3RyaWdnZXIoIFwiZm9jdXNcIiApO1xuXHRcdH0gKTtcblxuXHRcdC8vIFRyYWNrIHRoZSBkaWFsb2cgaW1tZWRpYXRlbHkgdXBvbiBvcGVuZW5pbmcgaW4gY2FzZSBhIGZvY3VzIGV2ZW50XG5cdFx0Ly8gc29tZWhvdyBvY2N1cnMgb3V0c2lkZSBvZiB0aGUgZGlhbG9nIGJlZm9yZSBhbiBlbGVtZW50IGluc2lkZSB0aGVcblx0XHQvLyBkaWFsb2cgaXMgZm9jdXNlZCAoIzEwMTUyKVxuXHRcdHRoaXMuX21ha2VGb2N1c1RhcmdldCgpO1xuXG5cdFx0dGhpcy5fdHJpZ2dlciggXCJvcGVuXCIgKTtcblx0fSxcblxuXHRfZm9jdXNUYWJiYWJsZTogZnVuY3Rpb24oKSB7XG5cblx0XHQvLyBTZXQgZm9jdXMgdG8gdGhlIGZpcnN0IG1hdGNoOlxuXHRcdC8vIDEuIEFuIGVsZW1lbnQgdGhhdCB3YXMgZm9jdXNlZCBwcmV2aW91c2x5XG5cdFx0Ly8gMi4gRmlyc3QgZWxlbWVudCBpbnNpZGUgdGhlIGRpYWxvZyBtYXRjaGluZyBbYXV0b2ZvY3VzXVxuXHRcdC8vIDMuIFRhYmJhYmxlIGVsZW1lbnQgaW5zaWRlIHRoZSBjb250ZW50IGVsZW1lbnRcblx0XHQvLyA0LiBUYWJiYWJsZSBlbGVtZW50IGluc2lkZSB0aGUgYnV0dG9ucGFuZVxuXHRcdC8vIDUuIFRoZSBjbG9zZSBidXR0b25cblx0XHQvLyA2LiBUaGUgZGlhbG9nIGl0c2VsZlxuXHRcdHZhciBoYXNGb2N1cyA9IHRoaXMuX2ZvY3VzZWRFbGVtZW50O1xuXHRcdGlmICggIWhhc0ZvY3VzICkge1xuXHRcdFx0aGFzRm9jdXMgPSB0aGlzLmVsZW1lbnQuZmluZCggXCJbYXV0b2ZvY3VzXVwiICk7XG5cdFx0fVxuXHRcdGlmICggIWhhc0ZvY3VzLmxlbmd0aCApIHtcblx0XHRcdGhhc0ZvY3VzID0gdGhpcy5lbGVtZW50LmZpbmQoIFwiOnRhYmJhYmxlXCIgKTtcblx0XHR9XG5cdFx0aWYgKCAhaGFzRm9jdXMubGVuZ3RoICkge1xuXHRcdFx0aGFzRm9jdXMgPSB0aGlzLnVpRGlhbG9nQnV0dG9uUGFuZS5maW5kKCBcIjp0YWJiYWJsZVwiICk7XG5cdFx0fVxuXHRcdGlmICggIWhhc0ZvY3VzLmxlbmd0aCApIHtcblx0XHRcdGhhc0ZvY3VzID0gdGhpcy51aURpYWxvZ1RpdGxlYmFyQ2xvc2UuZmlsdGVyKCBcIjp0YWJiYWJsZVwiICk7XG5cdFx0fVxuXHRcdGlmICggIWhhc0ZvY3VzLmxlbmd0aCApIHtcblx0XHRcdGhhc0ZvY3VzID0gdGhpcy51aURpYWxvZztcblx0XHR9XG5cdFx0aGFzRm9jdXMuZXEoIDAgKS50cmlnZ2VyKCBcImZvY3VzXCIgKTtcblx0fSxcblxuXHRfa2VlcEZvY3VzOiBmdW5jdGlvbiggZXZlbnQgKSB7XG5cdFx0ZnVuY3Rpb24gY2hlY2tGb2N1cygpIHtcblx0XHRcdHZhciBhY3RpdmVFbGVtZW50ID0gJC51aS5zYWZlQWN0aXZlRWxlbWVudCggdGhpcy5kb2N1bWVudFsgMCBdICksXG5cdFx0XHRcdGlzQWN0aXZlID0gdGhpcy51aURpYWxvZ1sgMCBdID09PSBhY3RpdmVFbGVtZW50IHx8XG5cdFx0XHRcdFx0JC5jb250YWlucyggdGhpcy51aURpYWxvZ1sgMCBdLCBhY3RpdmVFbGVtZW50ICk7XG5cdFx0XHRpZiAoICFpc0FjdGl2ZSApIHtcblx0XHRcdFx0dGhpcy5fZm9jdXNUYWJiYWJsZSgpO1xuXHRcdFx0fVxuXHRcdH1cblx0XHRldmVudC5wcmV2ZW50RGVmYXVsdCgpO1xuXHRcdGNoZWNrRm9jdXMuY2FsbCggdGhpcyApO1xuXG5cdFx0Ly8gc3VwcG9ydDogSUVcblx0XHQvLyBJRSA8PSA4IGRvZXNuJ3QgcHJldmVudCBtb3ZpbmcgZm9jdXMgZXZlbiB3aXRoIGV2ZW50LnByZXZlbnREZWZhdWx0KClcblx0XHQvLyBzbyB3ZSBjaGVjayBhZ2FpbiBsYXRlclxuXHRcdHRoaXMuX2RlbGF5KCBjaGVja0ZvY3VzICk7XG5cdH0sXG5cblx0X2NyZWF0ZVdyYXBwZXI6IGZ1bmN0aW9uKCkge1xuXHRcdHRoaXMudWlEaWFsb2cgPSAkKCBcIjxkaXY+XCIgKVxuXHRcdFx0LmhpZGUoKVxuXHRcdFx0LmF0dHIoIHtcblxuXHRcdFx0XHQvLyBTZXR0aW5nIHRhYkluZGV4IG1ha2VzIHRoZSBkaXYgZm9jdXNhYmxlXG5cdFx0XHRcdHRhYkluZGV4OiAtMSxcblx0XHRcdFx0cm9sZTogXCJkaWFsb2dcIlxuXHRcdFx0fSApXG5cdFx0XHQuYXBwZW5kVG8oIHRoaXMuX2FwcGVuZFRvKCkgKTtcblxuXHRcdHRoaXMuX2FkZENsYXNzKCB0aGlzLnVpRGlhbG9nLCBcInVpLWRpYWxvZ1wiLCBcInVpLXdpZGdldCB1aS13aWRnZXQtY29udGVudCB1aS1mcm9udFwiICk7XG5cdFx0dGhpcy5fb24oIHRoaXMudWlEaWFsb2csIHtcblx0XHRcdGtleWRvd246IGZ1bmN0aW9uKCBldmVudCApIHtcblx0XHRcdFx0aWYgKCB0aGlzLm9wdGlvbnMuY2xvc2VPbkVzY2FwZSAmJiAhZXZlbnQuaXNEZWZhdWx0UHJldmVudGVkKCkgJiYgZXZlbnQua2V5Q29kZSAmJlxuXHRcdFx0XHRcdFx0ZXZlbnQua2V5Q29kZSA9PT0gJC51aS5rZXlDb2RlLkVTQ0FQRSApIHtcblx0XHRcdFx0XHRldmVudC5wcmV2ZW50RGVmYXVsdCgpO1xuXHRcdFx0XHRcdHRoaXMuY2xvc2UoIGV2ZW50ICk7XG5cdFx0XHRcdFx0cmV0dXJuO1xuXHRcdFx0XHR9XG5cblx0XHRcdFx0Ly8gUHJldmVudCB0YWJiaW5nIG91dCBvZiBkaWFsb2dzXG5cdFx0XHRcdGlmICggZXZlbnQua2V5Q29kZSAhPT0gJC51aS5rZXlDb2RlLlRBQiB8fCBldmVudC5pc0RlZmF1bHRQcmV2ZW50ZWQoKSApIHtcblx0XHRcdFx0XHRyZXR1cm47XG5cdFx0XHRcdH1cblx0XHRcdFx0dmFyIHRhYmJhYmxlcyA9IHRoaXMudWlEaWFsb2cuZmluZCggXCI6dGFiYmFibGVcIiApLFxuXHRcdFx0XHRcdGZpcnN0ID0gdGFiYmFibGVzLmZpbHRlciggXCI6Zmlyc3RcIiApLFxuXHRcdFx0XHRcdGxhc3QgPSB0YWJiYWJsZXMuZmlsdGVyKCBcIjpsYXN0XCIgKTtcblxuXHRcdFx0XHRpZiAoICggZXZlbnQudGFyZ2V0ID09PSBsYXN0WyAwIF0gfHwgZXZlbnQudGFyZ2V0ID09PSB0aGlzLnVpRGlhbG9nWyAwIF0gKSAmJlxuXHRcdFx0XHRcdFx0IWV2ZW50LnNoaWZ0S2V5ICkge1xuXHRcdFx0XHRcdHRoaXMuX2RlbGF5KCBmdW5jdGlvbigpIHtcblx0XHRcdFx0XHRcdGZpcnN0LnRyaWdnZXIoIFwiZm9jdXNcIiApO1xuXHRcdFx0XHRcdH0gKTtcblx0XHRcdFx0XHRldmVudC5wcmV2ZW50RGVmYXVsdCgpO1xuXHRcdFx0XHR9IGVsc2UgaWYgKCAoIGV2ZW50LnRhcmdldCA9PT0gZmlyc3RbIDAgXSB8fFxuXHRcdFx0XHRcdFx0ZXZlbnQudGFyZ2V0ID09PSB0aGlzLnVpRGlhbG9nWyAwIF0gKSAmJiBldmVudC5zaGlmdEtleSApIHtcblx0XHRcdFx0XHR0aGlzLl9kZWxheSggZnVuY3Rpb24oKSB7XG5cdFx0XHRcdFx0XHRsYXN0LnRyaWdnZXIoIFwiZm9jdXNcIiApO1xuXHRcdFx0XHRcdH0gKTtcblx0XHRcdFx0XHRldmVudC5wcmV2ZW50RGVmYXVsdCgpO1xuXHRcdFx0XHR9XG5cdFx0XHR9LFxuXHRcdFx0bW91c2Vkb3duOiBmdW5jdGlvbiggZXZlbnQgKSB7XG5cdFx0XHRcdGlmICggdGhpcy5fbW92ZVRvVG9wKCBldmVudCApICkge1xuXHRcdFx0XHRcdHRoaXMuX2ZvY3VzVGFiYmFibGUoKTtcblx0XHRcdFx0fVxuXHRcdFx0fVxuXHRcdH0gKTtcblxuXHRcdC8vIFdlIGFzc3VtZSB0aGF0IGFueSBleGlzdGluZyBhcmlhLWRlc2NyaWJlZGJ5IGF0dHJpYnV0ZSBtZWFuc1xuXHRcdC8vIHRoYXQgdGhlIGRpYWxvZyBjb250ZW50IGlzIG1hcmtlZCB1cCBwcm9wZXJseVxuXHRcdC8vIG90aGVyd2lzZSB3ZSBicnV0ZSBmb3JjZSB0aGUgY29udGVudCBhcyB0aGUgZGVzY3JpcHRpb25cblx0XHRpZiAoICF0aGlzLmVsZW1lbnQuZmluZCggXCJbYXJpYS1kZXNjcmliZWRieV1cIiApLmxlbmd0aCApIHtcblx0XHRcdHRoaXMudWlEaWFsb2cuYXR0cigge1xuXHRcdFx0XHRcImFyaWEtZGVzY3JpYmVkYnlcIjogdGhpcy5lbGVtZW50LnVuaXF1ZUlkKCkuYXR0ciggXCJpZFwiIClcblx0XHRcdH0gKTtcblx0XHR9XG5cdH0sXG5cblx0X2NyZWF0ZVRpdGxlYmFyOiBmdW5jdGlvbigpIHtcblx0XHR2YXIgdWlEaWFsb2dUaXRsZTtcblxuXHRcdHRoaXMudWlEaWFsb2dUaXRsZWJhciA9ICQoIFwiPGRpdj5cIiApO1xuXHRcdHRoaXMuX2FkZENsYXNzKCB0aGlzLnVpRGlhbG9nVGl0bGViYXIsXG5cdFx0XHRcInVpLWRpYWxvZy10aXRsZWJhclwiLCBcInVpLXdpZGdldC1oZWFkZXIgdWktaGVscGVyLWNsZWFyZml4XCIgKTtcblx0XHR0aGlzLl9vbiggdGhpcy51aURpYWxvZ1RpdGxlYmFyLCB7XG5cdFx0XHRtb3VzZWRvd246IGZ1bmN0aW9uKCBldmVudCApIHtcblxuXHRcdFx0XHQvLyBEb24ndCBwcmV2ZW50IGNsaWNrIG9uIGNsb3NlIGJ1dHRvbiAoIzg4MzgpXG5cdFx0XHRcdC8vIEZvY3VzaW5nIGEgZGlhbG9nIHRoYXQgaXMgcGFydGlhbGx5IHNjcm9sbGVkIG91dCBvZiB2aWV3XG5cdFx0XHRcdC8vIGNhdXNlcyB0aGUgYnJvd3NlciB0byBzY3JvbGwgaXQgaW50byB2aWV3LCBwcmV2ZW50aW5nIHRoZSBjbGljayBldmVudFxuXHRcdFx0XHRpZiAoICEkKCBldmVudC50YXJnZXQgKS5jbG9zZXN0KCBcIi51aS1kaWFsb2ctdGl0bGViYXItY2xvc2VcIiApICkge1xuXG5cdFx0XHRcdFx0Ly8gRGlhbG9nIGlzbid0IGdldHRpbmcgZm9jdXMgd2hlbiBkcmFnZ2luZyAoIzgwNjMpXG5cdFx0XHRcdFx0dGhpcy51aURpYWxvZy50cmlnZ2VyKCBcImZvY3VzXCIgKTtcblx0XHRcdFx0fVxuXHRcdFx0fVxuXHRcdH0gKTtcblxuXHRcdC8vIFN1cHBvcnQ6IElFXG5cdFx0Ly8gVXNlIHR5cGU9XCJidXR0b25cIiB0byBwcmV2ZW50IGVudGVyIGtleXByZXNzZXMgaW4gdGV4dGJveGVzIGZyb20gY2xvc2luZyB0aGVcblx0XHQvLyBkaWFsb2cgaW4gSUUgKCM5MzEyKVxuXHRcdHRoaXMudWlEaWFsb2dUaXRsZWJhckNsb3NlID0gJCggXCI8YnV0dG9uIHR5cGU9J2J1dHRvbic+PC9idXR0b24+XCIgKVxuXHRcdFx0LmJ1dHRvbigge1xuXHRcdFx0XHRsYWJlbDogJCggXCI8YT5cIiApLnRleHQoIHRoaXMub3B0aW9ucy5jbG9zZVRleHQgKS5odG1sKCksXG5cdFx0XHRcdGljb246IFwidWktaWNvbi1jbG9zZXRoaWNrXCIsXG5cdFx0XHRcdHNob3dMYWJlbDogZmFsc2Vcblx0XHRcdH0gKVxuXHRcdFx0LmFwcGVuZFRvKCB0aGlzLnVpRGlhbG9nVGl0bGViYXIgKTtcblxuXHRcdHRoaXMuX2FkZENsYXNzKCB0aGlzLnVpRGlhbG9nVGl0bGViYXJDbG9zZSwgXCJ1aS1kaWFsb2ctdGl0bGViYXItY2xvc2VcIiApO1xuXHRcdHRoaXMuX29uKCB0aGlzLnVpRGlhbG9nVGl0bGViYXJDbG9zZSwge1xuXHRcdFx0Y2xpY2s6IGZ1bmN0aW9uKCBldmVudCApIHtcblx0XHRcdFx0ZXZlbnQucHJldmVudERlZmF1bHQoKTtcblx0XHRcdFx0dGhpcy5jbG9zZSggZXZlbnQgKTtcblx0XHRcdH1cblx0XHR9ICk7XG5cblx0XHR1aURpYWxvZ1RpdGxlID0gJCggXCI8c3Bhbj5cIiApLnVuaXF1ZUlkKCkucHJlcGVuZFRvKCB0aGlzLnVpRGlhbG9nVGl0bGViYXIgKTtcblx0XHR0aGlzLl9hZGRDbGFzcyggdWlEaWFsb2dUaXRsZSwgXCJ1aS1kaWFsb2ctdGl0bGVcIiApO1xuXHRcdHRoaXMuX3RpdGxlKCB1aURpYWxvZ1RpdGxlICk7XG5cblx0XHR0aGlzLnVpRGlhbG9nVGl0bGViYXIucHJlcGVuZFRvKCB0aGlzLnVpRGlhbG9nICk7XG5cblx0XHR0aGlzLnVpRGlhbG9nLmF0dHIoIHtcblx0XHRcdFwiYXJpYS1sYWJlbGxlZGJ5XCI6IHVpRGlhbG9nVGl0bGUuYXR0ciggXCJpZFwiIClcblx0XHR9ICk7XG5cdH0sXG5cblx0X3RpdGxlOiBmdW5jdGlvbiggdGl0bGUgKSB7XG5cdFx0aWYgKCB0aGlzLm9wdGlvbnMudGl0bGUgKSB7XG5cdFx0XHR0aXRsZS50ZXh0KCB0aGlzLm9wdGlvbnMudGl0bGUgKTtcblx0XHR9IGVsc2Uge1xuXHRcdFx0dGl0bGUuaHRtbCggXCImIzE2MDtcIiApO1xuXHRcdH1cblx0fSxcblxuXHRfY3JlYXRlQnV0dG9uUGFuZTogZnVuY3Rpb24oKSB7XG5cdFx0dGhpcy51aURpYWxvZ0J1dHRvblBhbmUgPSAkKCBcIjxkaXY+XCIgKTtcblx0XHR0aGlzLl9hZGRDbGFzcyggdGhpcy51aURpYWxvZ0J1dHRvblBhbmUsIFwidWktZGlhbG9nLWJ1dHRvbnBhbmVcIixcblx0XHRcdFwidWktd2lkZ2V0LWNvbnRlbnQgdWktaGVscGVyLWNsZWFyZml4XCIgKTtcblxuXHRcdHRoaXMudWlCdXR0b25TZXQgPSAkKCBcIjxkaXY+XCIgKVxuXHRcdFx0LmFwcGVuZFRvKCB0aGlzLnVpRGlhbG9nQnV0dG9uUGFuZSApO1xuXHRcdHRoaXMuX2FkZENsYXNzKCB0aGlzLnVpQnV0dG9uU2V0LCBcInVpLWRpYWxvZy1idXR0b25zZXRcIiApO1xuXG5cdFx0dGhpcy5fY3JlYXRlQnV0dG9ucygpO1xuXHR9LFxuXG5cdF9jcmVhdGVCdXR0b25zOiBmdW5jdGlvbigpIHtcblx0XHR2YXIgdGhhdCA9IHRoaXMsXG5cdFx0XHRidXR0b25zID0gdGhpcy5vcHRpb25zLmJ1dHRvbnM7XG5cblx0XHQvLyBJZiB3ZSBhbHJlYWR5IGhhdmUgYSBidXR0b24gcGFuZSwgcmVtb3ZlIGl0XG5cdFx0dGhpcy51aURpYWxvZ0J1dHRvblBhbmUucmVtb3ZlKCk7XG5cdFx0dGhpcy51aUJ1dHRvblNldC5lbXB0eSgpO1xuXG5cdFx0aWYgKCAkLmlzRW1wdHlPYmplY3QoIGJ1dHRvbnMgKSB8fCAoICQuaXNBcnJheSggYnV0dG9ucyApICYmICFidXR0b25zLmxlbmd0aCApICkge1xuXHRcdFx0dGhpcy5fcmVtb3ZlQ2xhc3MoIHRoaXMudWlEaWFsb2csIFwidWktZGlhbG9nLWJ1dHRvbnNcIiApO1xuXHRcdFx0cmV0dXJuO1xuXHRcdH1cblxuXHRcdCQuZWFjaCggYnV0dG9ucywgZnVuY3Rpb24oIG5hbWUsIHByb3BzICkge1xuXHRcdFx0dmFyIGNsaWNrLCBidXR0b25PcHRpb25zO1xuXHRcdFx0cHJvcHMgPSAkLmlzRnVuY3Rpb24oIHByb3BzICkgP1xuXHRcdFx0XHR7IGNsaWNrOiBwcm9wcywgdGV4dDogbmFtZSB9IDpcblx0XHRcdFx0cHJvcHM7XG5cblx0XHRcdC8vIERlZmF1bHQgdG8gYSBub24tc3VibWl0dGluZyBidXR0b25cblx0XHRcdHByb3BzID0gJC5leHRlbmQoIHsgdHlwZTogXCJidXR0b25cIiB9LCBwcm9wcyApO1xuXG5cdFx0XHQvLyBDaGFuZ2UgdGhlIGNvbnRleHQgZm9yIHRoZSBjbGljayBjYWxsYmFjayB0byBiZSB0aGUgbWFpbiBlbGVtZW50XG5cdFx0XHRjbGljayA9IHByb3BzLmNsaWNrO1xuXHRcdFx0YnV0dG9uT3B0aW9ucyA9IHtcblx0XHRcdFx0aWNvbjogcHJvcHMuaWNvbixcblx0XHRcdFx0aWNvblBvc2l0aW9uOiBwcm9wcy5pY29uUG9zaXRpb24sXG5cdFx0XHRcdHNob3dMYWJlbDogcHJvcHMuc2hvd0xhYmVsLFxuXG5cdFx0XHRcdC8vIERlcHJlY2F0ZWQgb3B0aW9uc1xuXHRcdFx0XHRpY29uczogcHJvcHMuaWNvbnMsXG5cdFx0XHRcdHRleHQ6IHByb3BzLnRleHRcblx0XHRcdH07XG5cblx0XHRcdGRlbGV0ZSBwcm9wcy5jbGljaztcblx0XHRcdGRlbGV0ZSBwcm9wcy5pY29uO1xuXHRcdFx0ZGVsZXRlIHByb3BzLmljb25Qb3NpdGlvbjtcblx0XHRcdGRlbGV0ZSBwcm9wcy5zaG93TGFiZWw7XG5cblx0XHRcdC8vIERlcHJlY2F0ZWQgb3B0aW9uc1xuXHRcdFx0ZGVsZXRlIHByb3BzLmljb25zO1xuXHRcdFx0aWYgKCB0eXBlb2YgcHJvcHMudGV4dCA9PT0gXCJib29sZWFuXCIgKSB7XG5cdFx0XHRcdGRlbGV0ZSBwcm9wcy50ZXh0O1xuXHRcdFx0fVxuXG5cdFx0XHQkKCBcIjxidXR0b24+PC9idXR0b24+XCIsIHByb3BzIClcblx0XHRcdFx0LmJ1dHRvbiggYnV0dG9uT3B0aW9ucyApXG5cdFx0XHRcdC5hcHBlbmRUbyggdGhhdC51aUJ1dHRvblNldCApXG5cdFx0XHRcdC5vbiggXCJjbGlja1wiLCBmdW5jdGlvbigpIHtcblx0XHRcdFx0XHRjbGljay5hcHBseSggdGhhdC5lbGVtZW50WyAwIF0sIGFyZ3VtZW50cyApO1xuXHRcdFx0XHR9ICk7XG5cdFx0fSApO1xuXHRcdHRoaXMuX2FkZENsYXNzKCB0aGlzLnVpRGlhbG9nLCBcInVpLWRpYWxvZy1idXR0b25zXCIgKTtcblx0XHR0aGlzLnVpRGlhbG9nQnV0dG9uUGFuZS5hcHBlbmRUbyggdGhpcy51aURpYWxvZyApO1xuXHR9LFxuXG5cdF9tYWtlRHJhZ2dhYmxlOiBmdW5jdGlvbigpIHtcblx0XHR2YXIgdGhhdCA9IHRoaXMsXG5cdFx0XHRvcHRpb25zID0gdGhpcy5vcHRpb25zO1xuXG5cdFx0ZnVuY3Rpb24gZmlsdGVyZWRVaSggdWkgKSB7XG5cdFx0XHRyZXR1cm4ge1xuXHRcdFx0XHRwb3NpdGlvbjogdWkucG9zaXRpb24sXG5cdFx0XHRcdG9mZnNldDogdWkub2Zmc2V0XG5cdFx0XHR9O1xuXHRcdH1cblxuXHRcdHRoaXMudWlEaWFsb2cuZHJhZ2dhYmxlKCB7XG5cdFx0XHRjYW5jZWw6IFwiLnVpLWRpYWxvZy1jb250ZW50LCAudWktZGlhbG9nLXRpdGxlYmFyLWNsb3NlXCIsXG5cdFx0XHRoYW5kbGU6IFwiLnVpLWRpYWxvZy10aXRsZWJhclwiLFxuXHRcdFx0Y29udGFpbm1lbnQ6IFwiZG9jdW1lbnRcIixcblx0XHRcdHN0YXJ0OiBmdW5jdGlvbiggZXZlbnQsIHVpICkge1xuXHRcdFx0XHR0aGF0Ll9hZGRDbGFzcyggJCggdGhpcyApLCBcInVpLWRpYWxvZy1kcmFnZ2luZ1wiICk7XG5cdFx0XHRcdHRoYXQuX2Jsb2NrRnJhbWVzKCk7XG5cdFx0XHRcdHRoYXQuX3RyaWdnZXIoIFwiZHJhZ1N0YXJ0XCIsIGV2ZW50LCBmaWx0ZXJlZFVpKCB1aSApICk7XG5cdFx0XHR9LFxuXHRcdFx0ZHJhZzogZnVuY3Rpb24oIGV2ZW50LCB1aSApIHtcblx0XHRcdFx0dGhhdC5fdHJpZ2dlciggXCJkcmFnXCIsIGV2ZW50LCBmaWx0ZXJlZFVpKCB1aSApICk7XG5cdFx0XHR9LFxuXHRcdFx0c3RvcDogZnVuY3Rpb24oIGV2ZW50LCB1aSApIHtcblx0XHRcdFx0dmFyIGxlZnQgPSB1aS5vZmZzZXQubGVmdCAtIHRoYXQuZG9jdW1lbnQuc2Nyb2xsTGVmdCgpLFxuXHRcdFx0XHRcdHRvcCA9IHVpLm9mZnNldC50b3AgLSB0aGF0LmRvY3VtZW50LnNjcm9sbFRvcCgpO1xuXG5cdFx0XHRcdG9wdGlvbnMucG9zaXRpb24gPSB7XG5cdFx0XHRcdFx0bXk6IFwibGVmdCB0b3BcIixcblx0XHRcdFx0XHRhdDogXCJsZWZ0XCIgKyAoIGxlZnQgPj0gMCA/IFwiK1wiIDogXCJcIiApICsgbGVmdCArIFwiIFwiICtcblx0XHRcdFx0XHRcdFwidG9wXCIgKyAoIHRvcCA+PSAwID8gXCIrXCIgOiBcIlwiICkgKyB0b3AsXG5cdFx0XHRcdFx0b2Y6IHRoYXQud2luZG93XG5cdFx0XHRcdH07XG5cdFx0XHRcdHRoYXQuX3JlbW92ZUNsYXNzKCAkKCB0aGlzICksIFwidWktZGlhbG9nLWRyYWdnaW5nXCIgKTtcblx0XHRcdFx0dGhhdC5fdW5ibG9ja0ZyYW1lcygpO1xuXHRcdFx0XHR0aGF0Ll90cmlnZ2VyKCBcImRyYWdTdG9wXCIsIGV2ZW50LCBmaWx0ZXJlZFVpKCB1aSApICk7XG5cdFx0XHR9XG5cdFx0fSApO1xuXHR9LFxuXG5cdF9tYWtlUmVzaXphYmxlOiBmdW5jdGlvbigpIHtcblx0XHR2YXIgdGhhdCA9IHRoaXMsXG5cdFx0XHRvcHRpb25zID0gdGhpcy5vcHRpb25zLFxuXHRcdFx0aGFuZGxlcyA9IG9wdGlvbnMucmVzaXphYmxlLFxuXG5cdFx0XHQvLyAudWktcmVzaXphYmxlIGhhcyBwb3NpdGlvbjogcmVsYXRpdmUgZGVmaW5lZCBpbiB0aGUgc3R5bGVzaGVldFxuXHRcdFx0Ly8gYnV0IGRpYWxvZ3MgaGF2ZSB0byB1c2UgYWJzb2x1dGUgb3IgZml4ZWQgcG9zaXRpb25pbmdcblx0XHRcdHBvc2l0aW9uID0gdGhpcy51aURpYWxvZy5jc3MoIFwicG9zaXRpb25cIiApLFxuXHRcdFx0cmVzaXplSGFuZGxlcyA9IHR5cGVvZiBoYW5kbGVzID09PSBcInN0cmluZ1wiID9cblx0XHRcdFx0aGFuZGxlcyA6XG5cdFx0XHRcdFwibixlLHMsdyxzZSxzdyxuZSxud1wiO1xuXG5cdFx0ZnVuY3Rpb24gZmlsdGVyZWRVaSggdWkgKSB7XG5cdFx0XHRyZXR1cm4ge1xuXHRcdFx0XHRvcmlnaW5hbFBvc2l0aW9uOiB1aS5vcmlnaW5hbFBvc2l0aW9uLFxuXHRcdFx0XHRvcmlnaW5hbFNpemU6IHVpLm9yaWdpbmFsU2l6ZSxcblx0XHRcdFx0cG9zaXRpb246IHVpLnBvc2l0aW9uLFxuXHRcdFx0XHRzaXplOiB1aS5zaXplXG5cdFx0XHR9O1xuXHRcdH1cblxuXHRcdHRoaXMudWlEaWFsb2cucmVzaXphYmxlKCB7XG5cdFx0XHRjYW5jZWw6IFwiLnVpLWRpYWxvZy1jb250ZW50XCIsXG5cdFx0XHRjb250YWlubWVudDogXCJkb2N1bWVudFwiLFxuXHRcdFx0YWxzb1Jlc2l6ZTogdGhpcy5lbGVtZW50LFxuXHRcdFx0bWF4V2lkdGg6IG9wdGlvbnMubWF4V2lkdGgsXG5cdFx0XHRtYXhIZWlnaHQ6IG9wdGlvbnMubWF4SGVpZ2h0LFxuXHRcdFx0bWluV2lkdGg6IG9wdGlvbnMubWluV2lkdGgsXG5cdFx0XHRtaW5IZWlnaHQ6IHRoaXMuX21pbkhlaWdodCgpLFxuXHRcdFx0aGFuZGxlczogcmVzaXplSGFuZGxlcyxcblx0XHRcdHN0YXJ0OiBmdW5jdGlvbiggZXZlbnQsIHVpICkge1xuXHRcdFx0XHR0aGF0Ll9hZGRDbGFzcyggJCggdGhpcyApLCBcInVpLWRpYWxvZy1yZXNpemluZ1wiICk7XG5cdFx0XHRcdHRoYXQuX2Jsb2NrRnJhbWVzKCk7XG5cdFx0XHRcdHRoYXQuX3RyaWdnZXIoIFwicmVzaXplU3RhcnRcIiwgZXZlbnQsIGZpbHRlcmVkVWkoIHVpICkgKTtcblx0XHRcdH0sXG5cdFx0XHRyZXNpemU6IGZ1bmN0aW9uKCBldmVudCwgdWkgKSB7XG5cdFx0XHRcdHRoYXQuX3RyaWdnZXIoIFwicmVzaXplXCIsIGV2ZW50LCBmaWx0ZXJlZFVpKCB1aSApICk7XG5cdFx0XHR9LFxuXHRcdFx0c3RvcDogZnVuY3Rpb24oIGV2ZW50LCB1aSApIHtcblx0XHRcdFx0dmFyIG9mZnNldCA9IHRoYXQudWlEaWFsb2cub2Zmc2V0KCksXG5cdFx0XHRcdFx0bGVmdCA9IG9mZnNldC5sZWZ0IC0gdGhhdC5kb2N1bWVudC5zY3JvbGxMZWZ0KCksXG5cdFx0XHRcdFx0dG9wID0gb2Zmc2V0LnRvcCAtIHRoYXQuZG9jdW1lbnQuc2Nyb2xsVG9wKCk7XG5cblx0XHRcdFx0b3B0aW9ucy5oZWlnaHQgPSB0aGF0LnVpRGlhbG9nLmhlaWdodCgpO1xuXHRcdFx0XHRvcHRpb25zLndpZHRoID0gdGhhdC51aURpYWxvZy53aWR0aCgpO1xuXHRcdFx0XHRvcHRpb25zLnBvc2l0aW9uID0ge1xuXHRcdFx0XHRcdG15OiBcImxlZnQgdG9wXCIsXG5cdFx0XHRcdFx0YXQ6IFwibGVmdFwiICsgKCBsZWZ0ID49IDAgPyBcIitcIiA6IFwiXCIgKSArIGxlZnQgKyBcIiBcIiArXG5cdFx0XHRcdFx0XHRcInRvcFwiICsgKCB0b3AgPj0gMCA/IFwiK1wiIDogXCJcIiApICsgdG9wLFxuXHRcdFx0XHRcdG9mOiB0aGF0LndpbmRvd1xuXHRcdFx0XHR9O1xuXHRcdFx0XHR0aGF0Ll9yZW1vdmVDbGFzcyggJCggdGhpcyApLCBcInVpLWRpYWxvZy1yZXNpemluZ1wiICk7XG5cdFx0XHRcdHRoYXQuX3VuYmxvY2tGcmFtZXMoKTtcblx0XHRcdFx0dGhhdC5fdHJpZ2dlciggXCJyZXNpemVTdG9wXCIsIGV2ZW50LCBmaWx0ZXJlZFVpKCB1aSApICk7XG5cdFx0XHR9XG5cdFx0fSApXG5cdFx0XHQuY3NzKCBcInBvc2l0aW9uXCIsIHBvc2l0aW9uICk7XG5cdH0sXG5cblx0X3RyYWNrRm9jdXM6IGZ1bmN0aW9uKCkge1xuXHRcdHRoaXMuX29uKCB0aGlzLndpZGdldCgpLCB7XG5cdFx0XHRmb2N1c2luOiBmdW5jdGlvbiggZXZlbnQgKSB7XG5cdFx0XHRcdHRoaXMuX21ha2VGb2N1c1RhcmdldCgpO1xuXHRcdFx0XHR0aGlzLl9mb2N1c2VkRWxlbWVudCA9ICQoIGV2ZW50LnRhcmdldCApO1xuXHRcdFx0fVxuXHRcdH0gKTtcblx0fSxcblxuXHRfbWFrZUZvY3VzVGFyZ2V0OiBmdW5jdGlvbigpIHtcblx0XHR0aGlzLl91bnRyYWNrSW5zdGFuY2UoKTtcblx0XHR0aGlzLl90cmFja2luZ0luc3RhbmNlcygpLnVuc2hpZnQoIHRoaXMgKTtcblx0fSxcblxuXHRfdW50cmFja0luc3RhbmNlOiBmdW5jdGlvbigpIHtcblx0XHR2YXIgaW5zdGFuY2VzID0gdGhpcy5fdHJhY2tpbmdJbnN0YW5jZXMoKSxcblx0XHRcdGV4aXN0cyA9ICQuaW5BcnJheSggdGhpcywgaW5zdGFuY2VzICk7XG5cdFx0aWYgKCBleGlzdHMgIT09IC0xICkge1xuXHRcdFx0aW5zdGFuY2VzLnNwbGljZSggZXhpc3RzLCAxICk7XG5cdFx0fVxuXHR9LFxuXG5cdF90cmFja2luZ0luc3RhbmNlczogZnVuY3Rpb24oKSB7XG5cdFx0dmFyIGluc3RhbmNlcyA9IHRoaXMuZG9jdW1lbnQuZGF0YSggXCJ1aS1kaWFsb2ctaW5zdGFuY2VzXCIgKTtcblx0XHRpZiAoICFpbnN0YW5jZXMgKSB7XG5cdFx0XHRpbnN0YW5jZXMgPSBbXTtcblx0XHRcdHRoaXMuZG9jdW1lbnQuZGF0YSggXCJ1aS1kaWFsb2ctaW5zdGFuY2VzXCIsIGluc3RhbmNlcyApO1xuXHRcdH1cblx0XHRyZXR1cm4gaW5zdGFuY2VzO1xuXHR9LFxuXG5cdF9taW5IZWlnaHQ6IGZ1bmN0aW9uKCkge1xuXHRcdHZhciBvcHRpb25zID0gdGhpcy5vcHRpb25zO1xuXG5cdFx0cmV0dXJuIG9wdGlvbnMuaGVpZ2h0ID09PSBcImF1dG9cIiA/XG5cdFx0XHRvcHRpb25zLm1pbkhlaWdodCA6XG5cdFx0XHRNYXRoLm1pbiggb3B0aW9ucy5taW5IZWlnaHQsIG9wdGlvbnMuaGVpZ2h0ICk7XG5cdH0sXG5cblx0X3Bvc2l0aW9uOiBmdW5jdGlvbigpIHtcblxuXHRcdC8vIE5lZWQgdG8gc2hvdyB0aGUgZGlhbG9nIHRvIGdldCB0aGUgYWN0dWFsIG9mZnNldCBpbiB0aGUgcG9zaXRpb24gcGx1Z2luXG5cdFx0dmFyIGlzVmlzaWJsZSA9IHRoaXMudWlEaWFsb2cuaXMoIFwiOnZpc2libGVcIiApO1xuXHRcdGlmICggIWlzVmlzaWJsZSApIHtcblx0XHRcdHRoaXMudWlEaWFsb2cuc2hvdygpO1xuXHRcdH1cblx0XHR0aGlzLnVpRGlhbG9nLnBvc2l0aW9uKCB0aGlzLm9wdGlvbnMucG9zaXRpb24gKTtcblx0XHRpZiAoICFpc1Zpc2libGUgKSB7XG5cdFx0XHR0aGlzLnVpRGlhbG9nLmhpZGUoKTtcblx0XHR9XG5cdH0sXG5cblx0X3NldE9wdGlvbnM6IGZ1bmN0aW9uKCBvcHRpb25zICkge1xuXHRcdHZhciB0aGF0ID0gdGhpcyxcblx0XHRcdHJlc2l6ZSA9IGZhbHNlLFxuXHRcdFx0cmVzaXphYmxlT3B0aW9ucyA9IHt9O1xuXG5cdFx0JC5lYWNoKCBvcHRpb25zLCBmdW5jdGlvbigga2V5LCB2YWx1ZSApIHtcblx0XHRcdHRoYXQuX3NldE9wdGlvbigga2V5LCB2YWx1ZSApO1xuXG5cdFx0XHRpZiAoIGtleSBpbiB0aGF0LnNpemVSZWxhdGVkT3B0aW9ucyApIHtcblx0XHRcdFx0cmVzaXplID0gdHJ1ZTtcblx0XHRcdH1cblx0XHRcdGlmICgga2V5IGluIHRoYXQucmVzaXphYmxlUmVsYXRlZE9wdGlvbnMgKSB7XG5cdFx0XHRcdHJlc2l6YWJsZU9wdGlvbnNbIGtleSBdID0gdmFsdWU7XG5cdFx0XHR9XG5cdFx0fSApO1xuXG5cdFx0aWYgKCByZXNpemUgKSB7XG5cdFx0XHR0aGlzLl9zaXplKCk7XG5cdFx0XHR0aGlzLl9wb3NpdGlvbigpO1xuXHRcdH1cblx0XHRpZiAoIHRoaXMudWlEaWFsb2cuaXMoIFwiOmRhdGEodWktcmVzaXphYmxlKVwiICkgKSB7XG5cdFx0XHR0aGlzLnVpRGlhbG9nLnJlc2l6YWJsZSggXCJvcHRpb25cIiwgcmVzaXphYmxlT3B0aW9ucyApO1xuXHRcdH1cblx0fSxcblxuXHRfc2V0T3B0aW9uOiBmdW5jdGlvbigga2V5LCB2YWx1ZSApIHtcblx0XHR2YXIgaXNEcmFnZ2FibGUsIGlzUmVzaXphYmxlLFxuXHRcdFx0dWlEaWFsb2cgPSB0aGlzLnVpRGlhbG9nO1xuXG5cdFx0aWYgKCBrZXkgPT09IFwiZGlzYWJsZWRcIiApIHtcblx0XHRcdHJldHVybjtcblx0XHR9XG5cblx0XHR0aGlzLl9zdXBlcigga2V5LCB2YWx1ZSApO1xuXG5cdFx0aWYgKCBrZXkgPT09IFwiYXBwZW5kVG9cIiApIHtcblx0XHRcdHRoaXMudWlEaWFsb2cuYXBwZW5kVG8oIHRoaXMuX2FwcGVuZFRvKCkgKTtcblx0XHR9XG5cblx0XHRpZiAoIGtleSA9PT0gXCJidXR0b25zXCIgKSB7XG5cdFx0XHR0aGlzLl9jcmVhdGVCdXR0b25zKCk7XG5cdFx0fVxuXG5cdFx0aWYgKCBrZXkgPT09IFwiY2xvc2VUZXh0XCIgKSB7XG5cdFx0XHR0aGlzLnVpRGlhbG9nVGl0bGViYXJDbG9zZS5idXR0b24oIHtcblxuXHRcdFx0XHQvLyBFbnN1cmUgdGhhdCB3ZSBhbHdheXMgcGFzcyBhIHN0cmluZ1xuXHRcdFx0XHRsYWJlbDogJCggXCI8YT5cIiApLnRleHQoIFwiXCIgKyB0aGlzLm9wdGlvbnMuY2xvc2VUZXh0ICkuaHRtbCgpXG5cdFx0XHR9ICk7XG5cdFx0fVxuXG5cdFx0aWYgKCBrZXkgPT09IFwiZHJhZ2dhYmxlXCIgKSB7XG5cdFx0XHRpc0RyYWdnYWJsZSA9IHVpRGlhbG9nLmlzKCBcIjpkYXRhKHVpLWRyYWdnYWJsZSlcIiApO1xuXHRcdFx0aWYgKCBpc0RyYWdnYWJsZSAmJiAhdmFsdWUgKSB7XG5cdFx0XHRcdHVpRGlhbG9nLmRyYWdnYWJsZSggXCJkZXN0cm95XCIgKTtcblx0XHRcdH1cblxuXHRcdFx0aWYgKCAhaXNEcmFnZ2FibGUgJiYgdmFsdWUgKSB7XG5cdFx0XHRcdHRoaXMuX21ha2VEcmFnZ2FibGUoKTtcblx0XHRcdH1cblx0XHR9XG5cblx0XHRpZiAoIGtleSA9PT0gXCJwb3NpdGlvblwiICkge1xuXHRcdFx0dGhpcy5fcG9zaXRpb24oKTtcblx0XHR9XG5cblx0XHRpZiAoIGtleSA9PT0gXCJyZXNpemFibGVcIiApIHtcblxuXHRcdFx0Ly8gY3VycmVudGx5IHJlc2l6YWJsZSwgYmVjb21pbmcgbm9uLXJlc2l6YWJsZVxuXHRcdFx0aXNSZXNpemFibGUgPSB1aURpYWxvZy5pcyggXCI6ZGF0YSh1aS1yZXNpemFibGUpXCIgKTtcblx0XHRcdGlmICggaXNSZXNpemFibGUgJiYgIXZhbHVlICkge1xuXHRcdFx0XHR1aURpYWxvZy5yZXNpemFibGUoIFwiZGVzdHJveVwiICk7XG5cdFx0XHR9XG5cblx0XHRcdC8vIEN1cnJlbnRseSByZXNpemFibGUsIGNoYW5naW5nIGhhbmRsZXNcblx0XHRcdGlmICggaXNSZXNpemFibGUgJiYgdHlwZW9mIHZhbHVlID09PSBcInN0cmluZ1wiICkge1xuXHRcdFx0XHR1aURpYWxvZy5yZXNpemFibGUoIFwib3B0aW9uXCIsIFwiaGFuZGxlc1wiLCB2YWx1ZSApO1xuXHRcdFx0fVxuXG5cdFx0XHQvLyBDdXJyZW50bHkgbm9uLXJlc2l6YWJsZSwgYmVjb21pbmcgcmVzaXphYmxlXG5cdFx0XHRpZiAoICFpc1Jlc2l6YWJsZSAmJiB2YWx1ZSAhPT0gZmFsc2UgKSB7XG5cdFx0XHRcdHRoaXMuX21ha2VSZXNpemFibGUoKTtcblx0XHRcdH1cblx0XHR9XG5cblx0XHRpZiAoIGtleSA9PT0gXCJ0aXRsZVwiICkge1xuXHRcdFx0dGhpcy5fdGl0bGUoIHRoaXMudWlEaWFsb2dUaXRsZWJhci5maW5kKCBcIi51aS1kaWFsb2ctdGl0bGVcIiApICk7XG5cdFx0fVxuXHR9LFxuXG5cdF9zaXplOiBmdW5jdGlvbigpIHtcblxuXHRcdC8vIElmIHRoZSB1c2VyIGhhcyByZXNpemVkIHRoZSBkaWFsb2csIHRoZSAudWktZGlhbG9nIGFuZCAudWktZGlhbG9nLWNvbnRlbnRcblx0XHQvLyBkaXZzIHdpbGwgYm90aCBoYXZlIHdpZHRoIGFuZCBoZWlnaHQgc2V0LCBzbyB3ZSBuZWVkIHRvIHJlc2V0IHRoZW1cblx0XHR2YXIgbm9uQ29udGVudEhlaWdodCwgbWluQ29udGVudEhlaWdodCwgbWF4Q29udGVudEhlaWdodCxcblx0XHRcdG9wdGlvbnMgPSB0aGlzLm9wdGlvbnM7XG5cblx0XHQvLyBSZXNldCBjb250ZW50IHNpemluZ1xuXHRcdHRoaXMuZWxlbWVudC5zaG93KCkuY3NzKCB7XG5cdFx0XHR3aWR0aDogXCJhdXRvXCIsXG5cdFx0XHRtaW5IZWlnaHQ6IDAsXG5cdFx0XHRtYXhIZWlnaHQ6IFwibm9uZVwiLFxuXHRcdFx0aGVpZ2h0OiAwXG5cdFx0fSApO1xuXG5cdFx0aWYgKCBvcHRpb25zLm1pbldpZHRoID4gb3B0aW9ucy53aWR0aCApIHtcblx0XHRcdG9wdGlvbnMud2lkdGggPSBvcHRpb25zLm1pbldpZHRoO1xuXHRcdH1cblxuXHRcdC8vIFJlc2V0IHdyYXBwZXIgc2l6aW5nXG5cdFx0Ly8gZGV0ZXJtaW5lIHRoZSBoZWlnaHQgb2YgYWxsIHRoZSBub24tY29udGVudCBlbGVtZW50c1xuXHRcdG5vbkNvbnRlbnRIZWlnaHQgPSB0aGlzLnVpRGlhbG9nLmNzcygge1xuXHRcdFx0aGVpZ2h0OiBcImF1dG9cIixcblx0XHRcdHdpZHRoOiBvcHRpb25zLndpZHRoXG5cdFx0fSApXG5cdFx0XHQub3V0ZXJIZWlnaHQoKTtcblx0XHRtaW5Db250ZW50SGVpZ2h0ID0gTWF0aC5tYXgoIDAsIG9wdGlvbnMubWluSGVpZ2h0IC0gbm9uQ29udGVudEhlaWdodCApO1xuXHRcdG1heENvbnRlbnRIZWlnaHQgPSB0eXBlb2Ygb3B0aW9ucy5tYXhIZWlnaHQgPT09IFwibnVtYmVyXCIgP1xuXHRcdFx0TWF0aC5tYXgoIDAsIG9wdGlvbnMubWF4SGVpZ2h0IC0gbm9uQ29udGVudEhlaWdodCApIDpcblx0XHRcdFwibm9uZVwiO1xuXG5cdFx0aWYgKCBvcHRpb25zLmhlaWdodCA9PT0gXCJhdXRvXCIgKSB7XG5cdFx0XHR0aGlzLmVsZW1lbnQuY3NzKCB7XG5cdFx0XHRcdG1pbkhlaWdodDogbWluQ29udGVudEhlaWdodCxcblx0XHRcdFx0bWF4SGVpZ2h0OiBtYXhDb250ZW50SGVpZ2h0LFxuXHRcdFx0XHRoZWlnaHQ6IFwiYXV0b1wiXG5cdFx0XHR9ICk7XG5cdFx0fSBlbHNlIHtcblx0XHRcdHRoaXMuZWxlbWVudC5oZWlnaHQoIE1hdGgubWF4KCAwLCBvcHRpb25zLmhlaWdodCAtIG5vbkNvbnRlbnRIZWlnaHQgKSApO1xuXHRcdH1cblxuXHRcdGlmICggdGhpcy51aURpYWxvZy5pcyggXCI6ZGF0YSh1aS1yZXNpemFibGUpXCIgKSApIHtcblx0XHRcdHRoaXMudWlEaWFsb2cucmVzaXphYmxlKCBcIm9wdGlvblwiLCBcIm1pbkhlaWdodFwiLCB0aGlzLl9taW5IZWlnaHQoKSApO1xuXHRcdH1cblx0fSxcblxuXHRfYmxvY2tGcmFtZXM6IGZ1bmN0aW9uKCkge1xuXHRcdHRoaXMuaWZyYW1lQmxvY2tzID0gdGhpcy5kb2N1bWVudC5maW5kKCBcImlmcmFtZVwiICkubWFwKCBmdW5jdGlvbigpIHtcblx0XHRcdHZhciBpZnJhbWUgPSAkKCB0aGlzICk7XG5cblx0XHRcdHJldHVybiAkKCBcIjxkaXY+XCIgKVxuXHRcdFx0XHQuY3NzKCB7XG5cdFx0XHRcdFx0cG9zaXRpb246IFwiYWJzb2x1dGVcIixcblx0XHRcdFx0XHR3aWR0aDogaWZyYW1lLm91dGVyV2lkdGgoKSxcblx0XHRcdFx0XHRoZWlnaHQ6IGlmcmFtZS5vdXRlckhlaWdodCgpXG5cdFx0XHRcdH0gKVxuXHRcdFx0XHQuYXBwZW5kVG8oIGlmcmFtZS5wYXJlbnQoKSApXG5cdFx0XHRcdC5vZmZzZXQoIGlmcmFtZS5vZmZzZXQoKSApWyAwIF07XG5cdFx0fSApO1xuXHR9LFxuXG5cdF91bmJsb2NrRnJhbWVzOiBmdW5jdGlvbigpIHtcblx0XHRpZiAoIHRoaXMuaWZyYW1lQmxvY2tzICkge1xuXHRcdFx0dGhpcy5pZnJhbWVCbG9ja3MucmVtb3ZlKCk7XG5cdFx0XHRkZWxldGUgdGhpcy5pZnJhbWVCbG9ja3M7XG5cdFx0fVxuXHR9LFxuXG5cdF9hbGxvd0ludGVyYWN0aW9uOiBmdW5jdGlvbiggZXZlbnQgKSB7XG5cdFx0aWYgKCAkKCBldmVudC50YXJnZXQgKS5jbG9zZXN0KCBcIi51aS1kaWFsb2dcIiApLmxlbmd0aCApIHtcblx0XHRcdHJldHVybiB0cnVlO1xuXHRcdH1cblxuXHRcdC8vIFRPRE86IFJlbW92ZSBoYWNrIHdoZW4gZGF0ZXBpY2tlciBpbXBsZW1lbnRzXG5cdFx0Ly8gdGhlIC51aS1mcm9udCBsb2dpYyAoIzg5ODkpXG5cdFx0cmV0dXJuICEhJCggZXZlbnQudGFyZ2V0ICkuY2xvc2VzdCggXCIudWktZGF0ZXBpY2tlclwiICkubGVuZ3RoO1xuXHR9LFxuXG5cdF9jcmVhdGVPdmVybGF5OiBmdW5jdGlvbigpIHtcblx0XHRpZiAoICF0aGlzLm9wdGlvbnMubW9kYWwgKSB7XG5cdFx0XHRyZXR1cm47XG5cdFx0fVxuXG5cdFx0Ly8gV2UgdXNlIGEgZGVsYXkgaW4gY2FzZSB0aGUgb3ZlcmxheSBpcyBjcmVhdGVkIGZyb20gYW5cblx0XHQvLyBldmVudCB0aGF0IHdlJ3JlIGdvaW5nIHRvIGJlIGNhbmNlbGxpbmcgKCMyODA0KVxuXHRcdHZhciBpc09wZW5pbmcgPSB0cnVlO1xuXHRcdHRoaXMuX2RlbGF5KCBmdW5jdGlvbigpIHtcblx0XHRcdGlzT3BlbmluZyA9IGZhbHNlO1xuXHRcdH0gKTtcblxuXHRcdGlmICggIXRoaXMuZG9jdW1lbnQuZGF0YSggXCJ1aS1kaWFsb2ctb3ZlcmxheXNcIiApICkge1xuXG5cdFx0XHQvLyBQcmV2ZW50IHVzZSBvZiBhbmNob3JzIGFuZCBpbnB1dHNcblx0XHRcdC8vIFVzaW5nIF9vbigpIGZvciBhbiBldmVudCBoYW5kbGVyIHNoYXJlZCBhY3Jvc3MgbWFueSBpbnN0YW5jZXMgaXNcblx0XHRcdC8vIHNhZmUgYmVjYXVzZSB0aGUgZGlhbG9ncyBzdGFjayBhbmQgbXVzdCBiZSBjbG9zZWQgaW4gcmV2ZXJzZSBvcmRlclxuXHRcdFx0dGhpcy5fb24oIHRoaXMuZG9jdW1lbnQsIHtcblx0XHRcdFx0Zm9jdXNpbjogZnVuY3Rpb24oIGV2ZW50ICkge1xuXHRcdFx0XHRcdGlmICggaXNPcGVuaW5nICkge1xuXHRcdFx0XHRcdFx0cmV0dXJuO1xuXHRcdFx0XHRcdH1cblxuXHRcdFx0XHRcdGlmICggIXRoaXMuX2FsbG93SW50ZXJhY3Rpb24oIGV2ZW50ICkgKSB7XG5cdFx0XHRcdFx0XHRldmVudC5wcmV2ZW50RGVmYXVsdCgpO1xuXHRcdFx0XHRcdFx0dGhpcy5fdHJhY2tpbmdJbnN0YW5jZXMoKVsgMCBdLl9mb2N1c1RhYmJhYmxlKCk7XG5cdFx0XHRcdFx0fVxuXHRcdFx0XHR9XG5cdFx0XHR9ICk7XG5cdFx0fVxuXG5cdFx0dGhpcy5vdmVybGF5ID0gJCggXCI8ZGl2PlwiIClcblx0XHRcdC5hcHBlbmRUbyggdGhpcy5fYXBwZW5kVG8oKSApO1xuXG5cdFx0dGhpcy5fYWRkQ2xhc3MoIHRoaXMub3ZlcmxheSwgbnVsbCwgXCJ1aS13aWRnZXQtb3ZlcmxheSB1aS1mcm9udFwiICk7XG5cdFx0dGhpcy5fb24oIHRoaXMub3ZlcmxheSwge1xuXHRcdFx0bW91c2Vkb3duOiBcIl9rZWVwRm9jdXNcIlxuXHRcdH0gKTtcblx0XHR0aGlzLmRvY3VtZW50LmRhdGEoIFwidWktZGlhbG9nLW92ZXJsYXlzXCIsXG5cdFx0XHQoIHRoaXMuZG9jdW1lbnQuZGF0YSggXCJ1aS1kaWFsb2ctb3ZlcmxheXNcIiApIHx8IDAgKSArIDEgKTtcblx0fSxcblxuXHRfZGVzdHJveU92ZXJsYXk6IGZ1bmN0aW9uKCkge1xuXHRcdGlmICggIXRoaXMub3B0aW9ucy5tb2RhbCApIHtcblx0XHRcdHJldHVybjtcblx0XHR9XG5cblx0XHRpZiAoIHRoaXMub3ZlcmxheSApIHtcblx0XHRcdHZhciBvdmVybGF5cyA9IHRoaXMuZG9jdW1lbnQuZGF0YSggXCJ1aS1kaWFsb2ctb3ZlcmxheXNcIiApIC0gMTtcblxuXHRcdFx0aWYgKCAhb3ZlcmxheXMgKSB7XG5cdFx0XHRcdHRoaXMuX29mZiggdGhpcy5kb2N1bWVudCwgXCJmb2N1c2luXCIgKTtcblx0XHRcdFx0dGhpcy5kb2N1bWVudC5yZW1vdmVEYXRhKCBcInVpLWRpYWxvZy1vdmVybGF5c1wiICk7XG5cdFx0XHR9IGVsc2Uge1xuXHRcdFx0XHR0aGlzLmRvY3VtZW50LmRhdGEoIFwidWktZGlhbG9nLW92ZXJsYXlzXCIsIG92ZXJsYXlzICk7XG5cdFx0XHR9XG5cblx0XHRcdHRoaXMub3ZlcmxheS5yZW1vdmUoKTtcblx0XHRcdHRoaXMub3ZlcmxheSA9IG51bGw7XG5cdFx0fVxuXHR9XG59ICk7XG5cbi8vIERFUFJFQ0FURURcbi8vIFRPRE86IHN3aXRjaCByZXR1cm4gYmFjayB0byB3aWRnZXQgZGVjbGFyYXRpb24gYXQgdG9wIG9mIGZpbGUgd2hlbiB0aGlzIGlzIHJlbW92ZWRcbmlmICggJC51aUJhY2tDb21wYXQgIT09IGZhbHNlICkge1xuXG5cdC8vIEJhY2tjb21wYXQgZm9yIGRpYWxvZ0NsYXNzIG9wdGlvblxuXHQkLndpZGdldCggXCJ1aS5kaWFsb2dcIiwgJC51aS5kaWFsb2csIHtcblx0XHRvcHRpb25zOiB7XG5cdFx0XHRkaWFsb2dDbGFzczogXCJcIlxuXHRcdH0sXG5cdFx0X2NyZWF0ZVdyYXBwZXI6IGZ1bmN0aW9uKCkge1xuXHRcdFx0dGhpcy5fc3VwZXIoKTtcblx0XHRcdHRoaXMudWlEaWFsb2cuYWRkQ2xhc3MoIHRoaXMub3B0aW9ucy5kaWFsb2dDbGFzcyApO1xuXHRcdH0sXG5cdFx0X3NldE9wdGlvbjogZnVuY3Rpb24oIGtleSwgdmFsdWUgKSB7XG5cdFx0XHRpZiAoIGtleSA9PT0gXCJkaWFsb2dDbGFzc1wiICkge1xuXHRcdFx0XHR0aGlzLnVpRGlhbG9nXG5cdFx0XHRcdFx0LnJlbW92ZUNsYXNzKCB0aGlzLm9wdGlvbnMuZGlhbG9nQ2xhc3MgKVxuXHRcdFx0XHRcdC5hZGRDbGFzcyggdmFsdWUgKTtcblx0XHRcdH1cblx0XHRcdHRoaXMuX3N1cGVyQXBwbHkoIGFyZ3VtZW50cyApO1xuXHRcdH1cblx0fSApO1xufVxuXG5yZXR1cm4gJC51aS5kaWFsb2c7XG5cbn0gKSApO1xuIiwiLyohXG4gKiBqUXVlcnkgVUkgRHJhZ2dhYmxlIDEuMTIuMVxuICogaHR0cDovL2pxdWVyeXVpLmNvbVxuICpcbiAqIENvcHlyaWdodCBqUXVlcnkgRm91bmRhdGlvbiBhbmQgb3RoZXIgY29udHJpYnV0b3JzXG4gKiBSZWxlYXNlZCB1bmRlciB0aGUgTUlUIGxpY2Vuc2UuXG4gKiBodHRwOi8vanF1ZXJ5Lm9yZy9saWNlbnNlXG4gKi9cblxuLy8+PmxhYmVsOiBEcmFnZ2FibGVcbi8vPj5ncm91cDogSW50ZXJhY3Rpb25zXG4vLz4+ZGVzY3JpcHRpb246IEVuYWJsZXMgZHJhZ2dpbmcgZnVuY3Rpb25hbGl0eSBmb3IgYW55IGVsZW1lbnQuXG4vLz4+ZG9jczogaHR0cDovL2FwaS5qcXVlcnl1aS5jb20vZHJhZ2dhYmxlL1xuLy8+PmRlbW9zOiBodHRwOi8vanF1ZXJ5dWkuY29tL2RyYWdnYWJsZS9cbi8vPj5jc3Muc3RydWN0dXJlOiAuLi8uLi90aGVtZXMvYmFzZS9kcmFnZ2FibGUuY3NzXG5cbiggZnVuY3Rpb24oIGZhY3RvcnkgKSB7XG5cdGlmICggdHlwZW9mIGRlZmluZSA9PT0gXCJmdW5jdGlvblwiICYmIGRlZmluZS5hbWQgKSB7XG5cblx0XHQvLyBBTUQuIFJlZ2lzdGVyIGFzIGFuIGFub255bW91cyBtb2R1bGUuXG5cdFx0ZGVmaW5lKCBbXG5cdFx0XHRcImpxdWVyeVwiLFxuXHRcdFx0XCIuL21vdXNlXCIsXG5cdFx0XHRcIi4uL2RhdGFcIixcblx0XHRcdFwiLi4vcGx1Z2luXCIsXG5cdFx0XHRcIi4uL3NhZmUtYWN0aXZlLWVsZW1lbnRcIixcblx0XHRcdFwiLi4vc2FmZS1ibHVyXCIsXG5cdFx0XHRcIi4uL3Njcm9sbC1wYXJlbnRcIixcblx0XHRcdFwiLi4vdmVyc2lvblwiLFxuXHRcdFx0XCIuLi93aWRnZXRcIlxuXHRcdF0sIGZhY3RvcnkgKTtcblx0fSBlbHNlIHtcblxuXHRcdC8vIEJyb3dzZXIgZ2xvYmFsc1xuXHRcdGZhY3RvcnkoIGpRdWVyeSApO1xuXHR9XG59KCBmdW5jdGlvbiggJCApIHtcblxuJC53aWRnZXQoIFwidWkuZHJhZ2dhYmxlXCIsICQudWkubW91c2UsIHtcblx0dmVyc2lvbjogXCIxLjEyLjFcIixcblx0d2lkZ2V0RXZlbnRQcmVmaXg6IFwiZHJhZ1wiLFxuXHRvcHRpb25zOiB7XG5cdFx0YWRkQ2xhc3NlczogdHJ1ZSxcblx0XHRhcHBlbmRUbzogXCJwYXJlbnRcIixcblx0XHRheGlzOiBmYWxzZSxcblx0XHRjb25uZWN0VG9Tb3J0YWJsZTogZmFsc2UsXG5cdFx0Y29udGFpbm1lbnQ6IGZhbHNlLFxuXHRcdGN1cnNvcjogXCJhdXRvXCIsXG5cdFx0Y3Vyc29yQXQ6IGZhbHNlLFxuXHRcdGdyaWQ6IGZhbHNlLFxuXHRcdGhhbmRsZTogZmFsc2UsXG5cdFx0aGVscGVyOiBcIm9yaWdpbmFsXCIsXG5cdFx0aWZyYW1lRml4OiBmYWxzZSxcblx0XHRvcGFjaXR5OiBmYWxzZSxcblx0XHRyZWZyZXNoUG9zaXRpb25zOiBmYWxzZSxcblx0XHRyZXZlcnQ6IGZhbHNlLFxuXHRcdHJldmVydER1cmF0aW9uOiA1MDAsXG5cdFx0c2NvcGU6IFwiZGVmYXVsdFwiLFxuXHRcdHNjcm9sbDogdHJ1ZSxcblx0XHRzY3JvbGxTZW5zaXRpdml0eTogMjAsXG5cdFx0c2Nyb2xsU3BlZWQ6IDIwLFxuXHRcdHNuYXA6IGZhbHNlLFxuXHRcdHNuYXBNb2RlOiBcImJvdGhcIixcblx0XHRzbmFwVG9sZXJhbmNlOiAyMCxcblx0XHRzdGFjazogZmFsc2UsXG5cdFx0ekluZGV4OiBmYWxzZSxcblxuXHRcdC8vIENhbGxiYWNrc1xuXHRcdGRyYWc6IG51bGwsXG5cdFx0c3RhcnQ6IG51bGwsXG5cdFx0c3RvcDogbnVsbFxuXHR9LFxuXHRfY3JlYXRlOiBmdW5jdGlvbigpIHtcblxuXHRcdGlmICggdGhpcy5vcHRpb25zLmhlbHBlciA9PT0gXCJvcmlnaW5hbFwiICkge1xuXHRcdFx0dGhpcy5fc2V0UG9zaXRpb25SZWxhdGl2ZSgpO1xuXHRcdH1cblx0XHRpZiAoIHRoaXMub3B0aW9ucy5hZGRDbGFzc2VzICkge1xuXHRcdFx0dGhpcy5fYWRkQ2xhc3MoIFwidWktZHJhZ2dhYmxlXCIgKTtcblx0XHR9XG5cdFx0dGhpcy5fc2V0SGFuZGxlQ2xhc3NOYW1lKCk7XG5cblx0XHR0aGlzLl9tb3VzZUluaXQoKTtcblx0fSxcblxuXHRfc2V0T3B0aW9uOiBmdW5jdGlvbigga2V5LCB2YWx1ZSApIHtcblx0XHR0aGlzLl9zdXBlcigga2V5LCB2YWx1ZSApO1xuXHRcdGlmICgga2V5ID09PSBcImhhbmRsZVwiICkge1xuXHRcdFx0dGhpcy5fcmVtb3ZlSGFuZGxlQ2xhc3NOYW1lKCk7XG5cdFx0XHR0aGlzLl9zZXRIYW5kbGVDbGFzc05hbWUoKTtcblx0XHR9XG5cdH0sXG5cblx0X2Rlc3Ryb3k6IGZ1bmN0aW9uKCkge1xuXHRcdGlmICggKCB0aGlzLmhlbHBlciB8fCB0aGlzLmVsZW1lbnQgKS5pcyggXCIudWktZHJhZ2dhYmxlLWRyYWdnaW5nXCIgKSApIHtcblx0XHRcdHRoaXMuZGVzdHJveU9uQ2xlYXIgPSB0cnVlO1xuXHRcdFx0cmV0dXJuO1xuXHRcdH1cblx0XHR0aGlzLl9yZW1vdmVIYW5kbGVDbGFzc05hbWUoKTtcblx0XHR0aGlzLl9tb3VzZURlc3Ryb3koKTtcblx0fSxcblxuXHRfbW91c2VDYXB0dXJlOiBmdW5jdGlvbiggZXZlbnQgKSB7XG5cdFx0dmFyIG8gPSB0aGlzLm9wdGlvbnM7XG5cblx0XHQvLyBBbW9uZyBvdGhlcnMsIHByZXZlbnQgYSBkcmFnIG9uIGEgcmVzaXphYmxlLWhhbmRsZVxuXHRcdGlmICggdGhpcy5oZWxwZXIgfHwgby5kaXNhYmxlZCB8fFxuXHRcdFx0XHQkKCBldmVudC50YXJnZXQgKS5jbG9zZXN0KCBcIi51aS1yZXNpemFibGUtaGFuZGxlXCIgKS5sZW5ndGggPiAwICkge1xuXHRcdFx0cmV0dXJuIGZhbHNlO1xuXHRcdH1cblxuXHRcdC8vUXVpdCBpZiB3ZSdyZSBub3Qgb24gYSB2YWxpZCBoYW5kbGVcblx0XHR0aGlzLmhhbmRsZSA9IHRoaXMuX2dldEhhbmRsZSggZXZlbnQgKTtcblx0XHRpZiAoICF0aGlzLmhhbmRsZSApIHtcblx0XHRcdHJldHVybiBmYWxzZTtcblx0XHR9XG5cblx0XHR0aGlzLl9ibHVyQWN0aXZlRWxlbWVudCggZXZlbnQgKTtcblxuXHRcdHRoaXMuX2Jsb2NrRnJhbWVzKCBvLmlmcmFtZUZpeCA9PT0gdHJ1ZSA/IFwiaWZyYW1lXCIgOiBvLmlmcmFtZUZpeCApO1xuXG5cdFx0cmV0dXJuIHRydWU7XG5cblx0fSxcblxuXHRfYmxvY2tGcmFtZXM6IGZ1bmN0aW9uKCBzZWxlY3RvciApIHtcblx0XHR0aGlzLmlmcmFtZUJsb2NrcyA9IHRoaXMuZG9jdW1lbnQuZmluZCggc2VsZWN0b3IgKS5tYXAoIGZ1bmN0aW9uKCkge1xuXHRcdFx0dmFyIGlmcmFtZSA9ICQoIHRoaXMgKTtcblxuXHRcdFx0cmV0dXJuICQoIFwiPGRpdj5cIiApXG5cdFx0XHRcdC5jc3MoIFwicG9zaXRpb25cIiwgXCJhYnNvbHV0ZVwiIClcblx0XHRcdFx0LmFwcGVuZFRvKCBpZnJhbWUucGFyZW50KCkgKVxuXHRcdFx0XHQub3V0ZXJXaWR0aCggaWZyYW1lLm91dGVyV2lkdGgoKSApXG5cdFx0XHRcdC5vdXRlckhlaWdodCggaWZyYW1lLm91dGVySGVpZ2h0KCkgKVxuXHRcdFx0XHQub2Zmc2V0KCBpZnJhbWUub2Zmc2V0KCkgKVsgMCBdO1xuXHRcdH0gKTtcblx0fSxcblxuXHRfdW5ibG9ja0ZyYW1lczogZnVuY3Rpb24oKSB7XG5cdFx0aWYgKCB0aGlzLmlmcmFtZUJsb2NrcyApIHtcblx0XHRcdHRoaXMuaWZyYW1lQmxvY2tzLnJlbW92ZSgpO1xuXHRcdFx0ZGVsZXRlIHRoaXMuaWZyYW1lQmxvY2tzO1xuXHRcdH1cblx0fSxcblxuXHRfYmx1ckFjdGl2ZUVsZW1lbnQ6IGZ1bmN0aW9uKCBldmVudCApIHtcblx0XHR2YXIgYWN0aXZlRWxlbWVudCA9ICQudWkuc2FmZUFjdGl2ZUVsZW1lbnQoIHRoaXMuZG9jdW1lbnRbIDAgXSApLFxuXHRcdFx0dGFyZ2V0ID0gJCggZXZlbnQudGFyZ2V0ICk7XG5cblx0XHQvLyBEb24ndCBibHVyIGlmIHRoZSBldmVudCBvY2N1cnJlZCBvbiBhbiBlbGVtZW50IHRoYXQgaXMgd2l0aGluXG5cdFx0Ly8gdGhlIGN1cnJlbnRseSBmb2N1c2VkIGVsZW1lbnRcblx0XHQvLyBTZWUgIzEwNTI3LCAjMTI0NzJcblx0XHRpZiAoIHRhcmdldC5jbG9zZXN0KCBhY3RpdmVFbGVtZW50ICkubGVuZ3RoICkge1xuXHRcdFx0cmV0dXJuO1xuXHRcdH1cblxuXHRcdC8vIEJsdXIgYW55IGVsZW1lbnQgdGhhdCBjdXJyZW50bHkgaGFzIGZvY3VzLCBzZWUgIzQyNjFcblx0XHQkLnVpLnNhZmVCbHVyKCBhY3RpdmVFbGVtZW50ICk7XG5cdH0sXG5cblx0X21vdXNlU3RhcnQ6IGZ1bmN0aW9uKCBldmVudCApIHtcblxuXHRcdHZhciBvID0gdGhpcy5vcHRpb25zO1xuXG5cdFx0Ly9DcmVhdGUgYW5kIGFwcGVuZCB0aGUgdmlzaWJsZSBoZWxwZXJcblx0XHR0aGlzLmhlbHBlciA9IHRoaXMuX2NyZWF0ZUhlbHBlciggZXZlbnQgKTtcblxuXHRcdHRoaXMuX2FkZENsYXNzKCB0aGlzLmhlbHBlciwgXCJ1aS1kcmFnZ2FibGUtZHJhZ2dpbmdcIiApO1xuXG5cdFx0Ly9DYWNoZSB0aGUgaGVscGVyIHNpemVcblx0XHR0aGlzLl9jYWNoZUhlbHBlclByb3BvcnRpb25zKCk7XG5cblx0XHQvL0lmIGRkbWFuYWdlciBpcyB1c2VkIGZvciBkcm9wcGFibGVzLCBzZXQgdGhlIGdsb2JhbCBkcmFnZ2FibGVcblx0XHRpZiAoICQudWkuZGRtYW5hZ2VyICkge1xuXHRcdFx0JC51aS5kZG1hbmFnZXIuY3VycmVudCA9IHRoaXM7XG5cdFx0fVxuXG5cdFx0Lypcblx0XHQgKiAtIFBvc2l0aW9uIGdlbmVyYXRpb24gLVxuXHRcdCAqIFRoaXMgYmxvY2sgZ2VuZXJhdGVzIGV2ZXJ5dGhpbmcgcG9zaXRpb24gcmVsYXRlZCAtIGl0J3MgdGhlIGNvcmUgb2YgZHJhZ2dhYmxlcy5cblx0XHQgKi9cblxuXHRcdC8vQ2FjaGUgdGhlIG1hcmdpbnMgb2YgdGhlIG9yaWdpbmFsIGVsZW1lbnRcblx0XHR0aGlzLl9jYWNoZU1hcmdpbnMoKTtcblxuXHRcdC8vU3RvcmUgdGhlIGhlbHBlcidzIGNzcyBwb3NpdGlvblxuXHRcdHRoaXMuY3NzUG9zaXRpb24gPSB0aGlzLmhlbHBlci5jc3MoIFwicG9zaXRpb25cIiApO1xuXHRcdHRoaXMuc2Nyb2xsUGFyZW50ID0gdGhpcy5oZWxwZXIuc2Nyb2xsUGFyZW50KCB0cnVlICk7XG5cdFx0dGhpcy5vZmZzZXRQYXJlbnQgPSB0aGlzLmhlbHBlci5vZmZzZXRQYXJlbnQoKTtcblx0XHR0aGlzLmhhc0ZpeGVkQW5jZXN0b3IgPSB0aGlzLmhlbHBlci5wYXJlbnRzKCkuZmlsdGVyKCBmdW5jdGlvbigpIHtcblx0XHRcdFx0cmV0dXJuICQoIHRoaXMgKS5jc3MoIFwicG9zaXRpb25cIiApID09PSBcImZpeGVkXCI7XG5cdFx0XHR9ICkubGVuZ3RoID4gMDtcblxuXHRcdC8vVGhlIGVsZW1lbnQncyBhYnNvbHV0ZSBwb3NpdGlvbiBvbiB0aGUgcGFnZSBtaW51cyBtYXJnaW5zXG5cdFx0dGhpcy5wb3NpdGlvbkFicyA9IHRoaXMuZWxlbWVudC5vZmZzZXQoKTtcblx0XHR0aGlzLl9yZWZyZXNoT2Zmc2V0cyggZXZlbnQgKTtcblxuXHRcdC8vR2VuZXJhdGUgdGhlIG9yaWdpbmFsIHBvc2l0aW9uXG5cdFx0dGhpcy5vcmlnaW5hbFBvc2l0aW9uID0gdGhpcy5wb3NpdGlvbiA9IHRoaXMuX2dlbmVyYXRlUG9zaXRpb24oIGV2ZW50LCBmYWxzZSApO1xuXHRcdHRoaXMub3JpZ2luYWxQYWdlWCA9IGV2ZW50LnBhZ2VYO1xuXHRcdHRoaXMub3JpZ2luYWxQYWdlWSA9IGV2ZW50LnBhZ2VZO1xuXG5cdFx0Ly9BZGp1c3QgdGhlIG1vdXNlIG9mZnNldCByZWxhdGl2ZSB0byB0aGUgaGVscGVyIGlmIFwiY3Vyc29yQXRcIiBpcyBzdXBwbGllZFxuXHRcdCggby5jdXJzb3JBdCAmJiB0aGlzLl9hZGp1c3RPZmZzZXRGcm9tSGVscGVyKCBvLmN1cnNvckF0ICkgKTtcblxuXHRcdC8vU2V0IGEgY29udGFpbm1lbnQgaWYgZ2l2ZW4gaW4gdGhlIG9wdGlvbnNcblx0XHR0aGlzLl9zZXRDb250YWlubWVudCgpO1xuXG5cdFx0Ly9UcmlnZ2VyIGV2ZW50ICsgY2FsbGJhY2tzXG5cdFx0aWYgKCB0aGlzLl90cmlnZ2VyKCBcInN0YXJ0XCIsIGV2ZW50ICkgPT09IGZhbHNlICkge1xuXHRcdFx0dGhpcy5fY2xlYXIoKTtcblx0XHRcdHJldHVybiBmYWxzZTtcblx0XHR9XG5cblx0XHQvL1JlY2FjaGUgdGhlIGhlbHBlciBzaXplXG5cdFx0dGhpcy5fY2FjaGVIZWxwZXJQcm9wb3J0aW9ucygpO1xuXG5cdFx0Ly9QcmVwYXJlIHRoZSBkcm9wcGFibGUgb2Zmc2V0c1xuXHRcdGlmICggJC51aS5kZG1hbmFnZXIgJiYgIW8uZHJvcEJlaGF2aW91ciApIHtcblx0XHRcdCQudWkuZGRtYW5hZ2VyLnByZXBhcmVPZmZzZXRzKCB0aGlzLCBldmVudCApO1xuXHRcdH1cblxuXHRcdC8vIEV4ZWN1dGUgdGhlIGRyYWcgb25jZSAtIHRoaXMgY2F1c2VzIHRoZSBoZWxwZXIgbm90IHRvIGJlIHZpc2libGUgYmVmb3JlIGdldHRpbmcgaXRzXG5cdFx0Ly8gY29ycmVjdCBwb3NpdGlvblxuXHRcdHRoaXMuX21vdXNlRHJhZyggZXZlbnQsIHRydWUgKTtcblxuXHRcdC8vIElmIHRoZSBkZG1hbmFnZXIgaXMgdXNlZCBmb3IgZHJvcHBhYmxlcywgaW5mb3JtIHRoZSBtYW5hZ2VyIHRoYXQgZHJhZ2dpbmcgaGFzIHN0YXJ0ZWRcblx0XHQvLyAoc2VlICM1MDAzKVxuXHRcdGlmICggJC51aS5kZG1hbmFnZXIgKSB7XG5cdFx0XHQkLnVpLmRkbWFuYWdlci5kcmFnU3RhcnQoIHRoaXMsIGV2ZW50ICk7XG5cdFx0fVxuXG5cdFx0cmV0dXJuIHRydWU7XG5cdH0sXG5cblx0X3JlZnJlc2hPZmZzZXRzOiBmdW5jdGlvbiggZXZlbnQgKSB7XG5cdFx0dGhpcy5vZmZzZXQgPSB7XG5cdFx0XHR0b3A6IHRoaXMucG9zaXRpb25BYnMudG9wIC0gdGhpcy5tYXJnaW5zLnRvcCxcblx0XHRcdGxlZnQ6IHRoaXMucG9zaXRpb25BYnMubGVmdCAtIHRoaXMubWFyZ2lucy5sZWZ0LFxuXHRcdFx0c2Nyb2xsOiBmYWxzZSxcblx0XHRcdHBhcmVudDogdGhpcy5fZ2V0UGFyZW50T2Zmc2V0KCksXG5cdFx0XHRyZWxhdGl2ZTogdGhpcy5fZ2V0UmVsYXRpdmVPZmZzZXQoKVxuXHRcdH07XG5cblx0XHR0aGlzLm9mZnNldC5jbGljayA9IHtcblx0XHRcdGxlZnQ6IGV2ZW50LnBhZ2VYIC0gdGhpcy5vZmZzZXQubGVmdCxcblx0XHRcdHRvcDogZXZlbnQucGFnZVkgLSB0aGlzLm9mZnNldC50b3Bcblx0XHR9O1xuXHR9LFxuXG5cdF9tb3VzZURyYWc6IGZ1bmN0aW9uKCBldmVudCwgbm9Qcm9wYWdhdGlvbiApIHtcblxuXHRcdC8vIHJlc2V0IGFueSBuZWNlc3NhcnkgY2FjaGVkIHByb3BlcnRpZXMgKHNlZSAjNTAwOSlcblx0XHRpZiAoIHRoaXMuaGFzRml4ZWRBbmNlc3RvciApIHtcblx0XHRcdHRoaXMub2Zmc2V0LnBhcmVudCA9IHRoaXMuX2dldFBhcmVudE9mZnNldCgpO1xuXHRcdH1cblxuXHRcdC8vQ29tcHV0ZSB0aGUgaGVscGVycyBwb3NpdGlvblxuXHRcdHRoaXMucG9zaXRpb24gPSB0aGlzLl9nZW5lcmF0ZVBvc2l0aW9uKCBldmVudCwgdHJ1ZSApO1xuXHRcdHRoaXMucG9zaXRpb25BYnMgPSB0aGlzLl9jb252ZXJ0UG9zaXRpb25UbyggXCJhYnNvbHV0ZVwiICk7XG5cblx0XHQvL0NhbGwgcGx1Z2lucyBhbmQgY2FsbGJhY2tzIGFuZCB1c2UgdGhlIHJlc3VsdGluZyBwb3NpdGlvbiBpZiBzb21ldGhpbmcgaXMgcmV0dXJuZWRcblx0XHRpZiAoICFub1Byb3BhZ2F0aW9uICkge1xuXHRcdFx0dmFyIHVpID0gdGhpcy5fdWlIYXNoKCk7XG5cdFx0XHRpZiAoIHRoaXMuX3RyaWdnZXIoIFwiZHJhZ1wiLCBldmVudCwgdWkgKSA9PT0gZmFsc2UgKSB7XG5cdFx0XHRcdHRoaXMuX21vdXNlVXAoIG5ldyAkLkV2ZW50KCBcIm1vdXNldXBcIiwgZXZlbnQgKSApO1xuXHRcdFx0XHRyZXR1cm4gZmFsc2U7XG5cdFx0XHR9XG5cdFx0XHR0aGlzLnBvc2l0aW9uID0gdWkucG9zaXRpb247XG5cdFx0fVxuXG5cdFx0dGhpcy5oZWxwZXJbIDAgXS5zdHlsZS5sZWZ0ID0gdGhpcy5wb3NpdGlvbi5sZWZ0ICsgXCJweFwiO1xuXHRcdHRoaXMuaGVscGVyWyAwIF0uc3R5bGUudG9wID0gdGhpcy5wb3NpdGlvbi50b3AgKyBcInB4XCI7XG5cblx0XHRpZiAoICQudWkuZGRtYW5hZ2VyICkge1xuXHRcdFx0JC51aS5kZG1hbmFnZXIuZHJhZyggdGhpcywgZXZlbnQgKTtcblx0XHR9XG5cblx0XHRyZXR1cm4gZmFsc2U7XG5cdH0sXG5cblx0X21vdXNlU3RvcDogZnVuY3Rpb24oIGV2ZW50ICkge1xuXG5cdFx0Ly9JZiB3ZSBhcmUgdXNpbmcgZHJvcHBhYmxlcywgaW5mb3JtIHRoZSBtYW5hZ2VyIGFib3V0IHRoZSBkcm9wXG5cdFx0dmFyIHRoYXQgPSB0aGlzLFxuXHRcdFx0ZHJvcHBlZCA9IGZhbHNlO1xuXHRcdGlmICggJC51aS5kZG1hbmFnZXIgJiYgIXRoaXMub3B0aW9ucy5kcm9wQmVoYXZpb3VyICkge1xuXHRcdFx0ZHJvcHBlZCA9ICQudWkuZGRtYW5hZ2VyLmRyb3AoIHRoaXMsIGV2ZW50ICk7XG5cdFx0fVxuXG5cdFx0Ly9pZiBhIGRyb3AgY29tZXMgZnJvbSBvdXRzaWRlIChhIHNvcnRhYmxlKVxuXHRcdGlmICggdGhpcy5kcm9wcGVkICkge1xuXHRcdFx0ZHJvcHBlZCA9IHRoaXMuZHJvcHBlZDtcblx0XHRcdHRoaXMuZHJvcHBlZCA9IGZhbHNlO1xuXHRcdH1cblxuXHRcdGlmICggKCB0aGlzLm9wdGlvbnMucmV2ZXJ0ID09PSBcImludmFsaWRcIiAmJiAhZHJvcHBlZCApIHx8XG5cdFx0XHRcdCggdGhpcy5vcHRpb25zLnJldmVydCA9PT0gXCJ2YWxpZFwiICYmIGRyb3BwZWQgKSB8fFxuXHRcdFx0XHR0aGlzLm9wdGlvbnMucmV2ZXJ0ID09PSB0cnVlIHx8ICggJC5pc0Z1bmN0aW9uKCB0aGlzLm9wdGlvbnMucmV2ZXJ0ICkgJiZcblx0XHRcdFx0dGhpcy5vcHRpb25zLnJldmVydC5jYWxsKCB0aGlzLmVsZW1lbnQsIGRyb3BwZWQgKSApXG5cdFx0KSB7XG5cdFx0XHQkKCB0aGlzLmhlbHBlciApLmFuaW1hdGUoXG5cdFx0XHRcdHRoaXMub3JpZ2luYWxQb3NpdGlvbixcblx0XHRcdFx0cGFyc2VJbnQoIHRoaXMub3B0aW9ucy5yZXZlcnREdXJhdGlvbiwgMTAgKSxcblx0XHRcdFx0ZnVuY3Rpb24oKSB7XG5cdFx0XHRcdFx0aWYgKCB0aGF0Ll90cmlnZ2VyKCBcInN0b3BcIiwgZXZlbnQgKSAhPT0gZmFsc2UgKSB7XG5cdFx0XHRcdFx0XHR0aGF0Ll9jbGVhcigpO1xuXHRcdFx0XHRcdH1cblx0XHRcdFx0fVxuXHRcdFx0KTtcblx0XHR9IGVsc2Uge1xuXHRcdFx0aWYgKCB0aGlzLl90cmlnZ2VyKCBcInN0b3BcIiwgZXZlbnQgKSAhPT0gZmFsc2UgKSB7XG5cdFx0XHRcdHRoaXMuX2NsZWFyKCk7XG5cdFx0XHR9XG5cdFx0fVxuXG5cdFx0cmV0dXJuIGZhbHNlO1xuXHR9LFxuXG5cdF9tb3VzZVVwOiBmdW5jdGlvbiggZXZlbnQgKSB7XG5cdFx0dGhpcy5fdW5ibG9ja0ZyYW1lcygpO1xuXG5cdFx0Ly8gSWYgdGhlIGRkbWFuYWdlciBpcyB1c2VkIGZvciBkcm9wcGFibGVzLCBpbmZvcm0gdGhlIG1hbmFnZXIgdGhhdCBkcmFnZ2luZyBoYXMgc3RvcHBlZFxuXHRcdC8vIChzZWUgIzUwMDMpXG5cdFx0aWYgKCAkLnVpLmRkbWFuYWdlciApIHtcblx0XHRcdCQudWkuZGRtYW5hZ2VyLmRyYWdTdG9wKCB0aGlzLCBldmVudCApO1xuXHRcdH1cblxuXHRcdC8vIE9ubHkgbmVlZCB0byBmb2N1cyBpZiB0aGUgZXZlbnQgb2NjdXJyZWQgb24gdGhlIGRyYWdnYWJsZSBpdHNlbGYsIHNlZSAjMTA1Mjdcblx0XHRpZiAoIHRoaXMuaGFuZGxlRWxlbWVudC5pcyggZXZlbnQudGFyZ2V0ICkgKSB7XG5cblx0XHRcdC8vIFRoZSBpbnRlcmFjdGlvbiBpcyBvdmVyOyB3aGV0aGVyIG9yIG5vdCB0aGUgY2xpY2sgcmVzdWx0ZWQgaW4gYSBkcmFnLFxuXHRcdFx0Ly8gZm9jdXMgdGhlIGVsZW1lbnRcblx0XHRcdHRoaXMuZWxlbWVudC50cmlnZ2VyKCBcImZvY3VzXCIgKTtcblx0XHR9XG5cblx0XHRyZXR1cm4gJC51aS5tb3VzZS5wcm90b3R5cGUuX21vdXNlVXAuY2FsbCggdGhpcywgZXZlbnQgKTtcblx0fSxcblxuXHRjYW5jZWw6IGZ1bmN0aW9uKCkge1xuXG5cdFx0aWYgKCB0aGlzLmhlbHBlci5pcyggXCIudWktZHJhZ2dhYmxlLWRyYWdnaW5nXCIgKSApIHtcblx0XHRcdHRoaXMuX21vdXNlVXAoIG5ldyAkLkV2ZW50KCBcIm1vdXNldXBcIiwgeyB0YXJnZXQ6IHRoaXMuZWxlbWVudFsgMCBdIH0gKSApO1xuXHRcdH0gZWxzZSB7XG5cdFx0XHR0aGlzLl9jbGVhcigpO1xuXHRcdH1cblxuXHRcdHJldHVybiB0aGlzO1xuXG5cdH0sXG5cblx0X2dldEhhbmRsZTogZnVuY3Rpb24oIGV2ZW50ICkge1xuXHRcdHJldHVybiB0aGlzLm9wdGlvbnMuaGFuZGxlID9cblx0XHRcdCEhJCggZXZlbnQudGFyZ2V0ICkuY2xvc2VzdCggdGhpcy5lbGVtZW50LmZpbmQoIHRoaXMub3B0aW9ucy5oYW5kbGUgKSApLmxlbmd0aCA6XG5cdFx0XHR0cnVlO1xuXHR9LFxuXG5cdF9zZXRIYW5kbGVDbGFzc05hbWU6IGZ1bmN0aW9uKCkge1xuXHRcdHRoaXMuaGFuZGxlRWxlbWVudCA9IHRoaXMub3B0aW9ucy5oYW5kbGUgP1xuXHRcdFx0dGhpcy5lbGVtZW50LmZpbmQoIHRoaXMub3B0aW9ucy5oYW5kbGUgKSA6IHRoaXMuZWxlbWVudDtcblx0XHR0aGlzLl9hZGRDbGFzcyggdGhpcy5oYW5kbGVFbGVtZW50LCBcInVpLWRyYWdnYWJsZS1oYW5kbGVcIiApO1xuXHR9LFxuXG5cdF9yZW1vdmVIYW5kbGVDbGFzc05hbWU6IGZ1bmN0aW9uKCkge1xuXHRcdHRoaXMuX3JlbW92ZUNsYXNzKCB0aGlzLmhhbmRsZUVsZW1lbnQsIFwidWktZHJhZ2dhYmxlLWhhbmRsZVwiICk7XG5cdH0sXG5cblx0X2NyZWF0ZUhlbHBlcjogZnVuY3Rpb24oIGV2ZW50ICkge1xuXG5cdFx0dmFyIG8gPSB0aGlzLm9wdGlvbnMsXG5cdFx0XHRoZWxwZXJJc0Z1bmN0aW9uID0gJC5pc0Z1bmN0aW9uKCBvLmhlbHBlciApLFxuXHRcdFx0aGVscGVyID0gaGVscGVySXNGdW5jdGlvbiA/XG5cdFx0XHRcdCQoIG8uaGVscGVyLmFwcGx5KCB0aGlzLmVsZW1lbnRbIDAgXSwgWyBldmVudCBdICkgKSA6XG5cdFx0XHRcdCggby5oZWxwZXIgPT09IFwiY2xvbmVcIiA/XG5cdFx0XHRcdFx0dGhpcy5lbGVtZW50LmNsb25lKCkucmVtb3ZlQXR0ciggXCJpZFwiICkgOlxuXHRcdFx0XHRcdHRoaXMuZWxlbWVudCApO1xuXG5cdFx0aWYgKCAhaGVscGVyLnBhcmVudHMoIFwiYm9keVwiICkubGVuZ3RoICkge1xuXHRcdFx0aGVscGVyLmFwcGVuZFRvKCAoIG8uYXBwZW5kVG8gPT09IFwicGFyZW50XCIgP1xuXHRcdFx0XHR0aGlzLmVsZW1lbnRbIDAgXS5wYXJlbnROb2RlIDpcblx0XHRcdFx0by5hcHBlbmRUbyApICk7XG5cdFx0fVxuXG5cdFx0Ly8gSHR0cDovL2J1Z3MuanF1ZXJ5dWkuY29tL3RpY2tldC85NDQ2XG5cdFx0Ly8gYSBoZWxwZXIgZnVuY3Rpb24gY2FuIHJldHVybiB0aGUgb3JpZ2luYWwgZWxlbWVudFxuXHRcdC8vIHdoaWNoIHdvdWxkbid0IGhhdmUgYmVlbiBzZXQgdG8gcmVsYXRpdmUgaW4gX2NyZWF0ZVxuXHRcdGlmICggaGVscGVySXNGdW5jdGlvbiAmJiBoZWxwZXJbIDAgXSA9PT0gdGhpcy5lbGVtZW50WyAwIF0gKSB7XG5cdFx0XHR0aGlzLl9zZXRQb3NpdGlvblJlbGF0aXZlKCk7XG5cdFx0fVxuXG5cdFx0aWYgKCBoZWxwZXJbIDAgXSAhPT0gdGhpcy5lbGVtZW50WyAwIF0gJiZcblx0XHRcdFx0ISggLyhmaXhlZHxhYnNvbHV0ZSkvICkudGVzdCggaGVscGVyLmNzcyggXCJwb3NpdGlvblwiICkgKSApIHtcblx0XHRcdGhlbHBlci5jc3MoIFwicG9zaXRpb25cIiwgXCJhYnNvbHV0ZVwiICk7XG5cdFx0fVxuXG5cdFx0cmV0dXJuIGhlbHBlcjtcblxuXHR9LFxuXG5cdF9zZXRQb3NpdGlvblJlbGF0aXZlOiBmdW5jdGlvbigpIHtcblx0XHRpZiAoICEoIC9eKD86cnxhfGYpLyApLnRlc3QoIHRoaXMuZWxlbWVudC5jc3MoIFwicG9zaXRpb25cIiApICkgKSB7XG5cdFx0XHR0aGlzLmVsZW1lbnRbIDAgXS5zdHlsZS5wb3NpdGlvbiA9IFwicmVsYXRpdmVcIjtcblx0XHR9XG5cdH0sXG5cblx0X2FkanVzdE9mZnNldEZyb21IZWxwZXI6IGZ1bmN0aW9uKCBvYmogKSB7XG5cdFx0aWYgKCB0eXBlb2Ygb2JqID09PSBcInN0cmluZ1wiICkge1xuXHRcdFx0b2JqID0gb2JqLnNwbGl0KCBcIiBcIiApO1xuXHRcdH1cblx0XHRpZiAoICQuaXNBcnJheSggb2JqICkgKSB7XG5cdFx0XHRvYmogPSB7IGxlZnQ6ICtvYmpbIDAgXSwgdG9wOiArb2JqWyAxIF0gfHwgMCB9O1xuXHRcdH1cblx0XHRpZiAoIFwibGVmdFwiIGluIG9iaiApIHtcblx0XHRcdHRoaXMub2Zmc2V0LmNsaWNrLmxlZnQgPSBvYmoubGVmdCArIHRoaXMubWFyZ2lucy5sZWZ0O1xuXHRcdH1cblx0XHRpZiAoIFwicmlnaHRcIiBpbiBvYmogKSB7XG5cdFx0XHR0aGlzLm9mZnNldC5jbGljay5sZWZ0ID0gdGhpcy5oZWxwZXJQcm9wb3J0aW9ucy53aWR0aCAtIG9iai5yaWdodCArIHRoaXMubWFyZ2lucy5sZWZ0O1xuXHRcdH1cblx0XHRpZiAoIFwidG9wXCIgaW4gb2JqICkge1xuXHRcdFx0dGhpcy5vZmZzZXQuY2xpY2sudG9wID0gb2JqLnRvcCArIHRoaXMubWFyZ2lucy50b3A7XG5cdFx0fVxuXHRcdGlmICggXCJib3R0b21cIiBpbiBvYmogKSB7XG5cdFx0XHR0aGlzLm9mZnNldC5jbGljay50b3AgPSB0aGlzLmhlbHBlclByb3BvcnRpb25zLmhlaWdodCAtIG9iai5ib3R0b20gKyB0aGlzLm1hcmdpbnMudG9wO1xuXHRcdH1cblx0fSxcblxuXHRfaXNSb290Tm9kZTogZnVuY3Rpb24oIGVsZW1lbnQgKSB7XG5cdFx0cmV0dXJuICggLyhodG1sfGJvZHkpL2kgKS50ZXN0KCBlbGVtZW50LnRhZ05hbWUgKSB8fCBlbGVtZW50ID09PSB0aGlzLmRvY3VtZW50WyAwIF07XG5cdH0sXG5cblx0X2dldFBhcmVudE9mZnNldDogZnVuY3Rpb24oKSB7XG5cblx0XHQvL0dldCB0aGUgb2Zmc2V0UGFyZW50IGFuZCBjYWNoZSBpdHMgcG9zaXRpb25cblx0XHR2YXIgcG8gPSB0aGlzLm9mZnNldFBhcmVudC5vZmZzZXQoKSxcblx0XHRcdGRvY3VtZW50ID0gdGhpcy5kb2N1bWVudFsgMCBdO1xuXG5cdFx0Ly8gVGhpcyBpcyBhIHNwZWNpYWwgY2FzZSB3aGVyZSB3ZSBuZWVkIHRvIG1vZGlmeSBhIG9mZnNldCBjYWxjdWxhdGVkIG9uIHN0YXJ0LCBzaW5jZSB0aGVcblx0XHQvLyBmb2xsb3dpbmcgaGFwcGVuZWQ6XG5cdFx0Ly8gMS4gVGhlIHBvc2l0aW9uIG9mIHRoZSBoZWxwZXIgaXMgYWJzb2x1dGUsIHNvIGl0J3MgcG9zaXRpb24gaXMgY2FsY3VsYXRlZCBiYXNlZCBvbiB0aGVcblx0XHQvLyBuZXh0IHBvc2l0aW9uZWQgcGFyZW50XG5cdFx0Ly8gMi4gVGhlIGFjdHVhbCBvZmZzZXQgcGFyZW50IGlzIGEgY2hpbGQgb2YgdGhlIHNjcm9sbCBwYXJlbnQsIGFuZCB0aGUgc2Nyb2xsIHBhcmVudCBpc24ndFxuXHRcdC8vIHRoZSBkb2N1bWVudCwgd2hpY2ggbWVhbnMgdGhhdCB0aGUgc2Nyb2xsIGlzIGluY2x1ZGVkIGluIHRoZSBpbml0aWFsIGNhbGN1bGF0aW9uIG9mIHRoZVxuXHRcdC8vIG9mZnNldCBvZiB0aGUgcGFyZW50LCBhbmQgbmV2ZXIgcmVjYWxjdWxhdGVkIHVwb24gZHJhZ1xuXHRcdGlmICggdGhpcy5jc3NQb3NpdGlvbiA9PT0gXCJhYnNvbHV0ZVwiICYmIHRoaXMuc2Nyb2xsUGFyZW50WyAwIF0gIT09IGRvY3VtZW50ICYmXG5cdFx0XHRcdCQuY29udGFpbnMoIHRoaXMuc2Nyb2xsUGFyZW50WyAwIF0sIHRoaXMub2Zmc2V0UGFyZW50WyAwIF0gKSApIHtcblx0XHRcdHBvLmxlZnQgKz0gdGhpcy5zY3JvbGxQYXJlbnQuc2Nyb2xsTGVmdCgpO1xuXHRcdFx0cG8udG9wICs9IHRoaXMuc2Nyb2xsUGFyZW50LnNjcm9sbFRvcCgpO1xuXHRcdH1cblxuXHRcdGlmICggdGhpcy5faXNSb290Tm9kZSggdGhpcy5vZmZzZXRQYXJlbnRbIDAgXSApICkge1xuXHRcdFx0cG8gPSB7IHRvcDogMCwgbGVmdDogMCB9O1xuXHRcdH1cblxuXHRcdHJldHVybiB7XG5cdFx0XHR0b3A6IHBvLnRvcCArICggcGFyc2VJbnQoIHRoaXMub2Zmc2V0UGFyZW50LmNzcyggXCJib3JkZXJUb3BXaWR0aFwiICksIDEwICkgfHwgMCApLFxuXHRcdFx0bGVmdDogcG8ubGVmdCArICggcGFyc2VJbnQoIHRoaXMub2Zmc2V0UGFyZW50LmNzcyggXCJib3JkZXJMZWZ0V2lkdGhcIiApLCAxMCApIHx8IDAgKVxuXHRcdH07XG5cblx0fSxcblxuXHRfZ2V0UmVsYXRpdmVPZmZzZXQ6IGZ1bmN0aW9uKCkge1xuXHRcdGlmICggdGhpcy5jc3NQb3NpdGlvbiAhPT0gXCJyZWxhdGl2ZVwiICkge1xuXHRcdFx0cmV0dXJuIHsgdG9wOiAwLCBsZWZ0OiAwIH07XG5cdFx0fVxuXG5cdFx0dmFyIHAgPSB0aGlzLmVsZW1lbnQucG9zaXRpb24oKSxcblx0XHRcdHNjcm9sbElzUm9vdE5vZGUgPSB0aGlzLl9pc1Jvb3ROb2RlKCB0aGlzLnNjcm9sbFBhcmVudFsgMCBdICk7XG5cblx0XHRyZXR1cm4ge1xuXHRcdFx0dG9wOiBwLnRvcCAtICggcGFyc2VJbnQoIHRoaXMuaGVscGVyLmNzcyggXCJ0b3BcIiApLCAxMCApIHx8IDAgKSArXG5cdFx0XHRcdCggIXNjcm9sbElzUm9vdE5vZGUgPyB0aGlzLnNjcm9sbFBhcmVudC5zY3JvbGxUb3AoKSA6IDAgKSxcblx0XHRcdGxlZnQ6IHAubGVmdCAtICggcGFyc2VJbnQoIHRoaXMuaGVscGVyLmNzcyggXCJsZWZ0XCIgKSwgMTAgKSB8fCAwICkgK1xuXHRcdFx0XHQoICFzY3JvbGxJc1Jvb3ROb2RlID8gdGhpcy5zY3JvbGxQYXJlbnQuc2Nyb2xsTGVmdCgpIDogMCApXG5cdFx0fTtcblxuXHR9LFxuXG5cdF9jYWNoZU1hcmdpbnM6IGZ1bmN0aW9uKCkge1xuXHRcdHRoaXMubWFyZ2lucyA9IHtcblx0XHRcdGxlZnQ6ICggcGFyc2VJbnQoIHRoaXMuZWxlbWVudC5jc3MoIFwibWFyZ2luTGVmdFwiICksIDEwICkgfHwgMCApLFxuXHRcdFx0dG9wOiAoIHBhcnNlSW50KCB0aGlzLmVsZW1lbnQuY3NzKCBcIm1hcmdpblRvcFwiICksIDEwICkgfHwgMCApLFxuXHRcdFx0cmlnaHQ6ICggcGFyc2VJbnQoIHRoaXMuZWxlbWVudC5jc3MoIFwibWFyZ2luUmlnaHRcIiApLCAxMCApIHx8IDAgKSxcblx0XHRcdGJvdHRvbTogKCBwYXJzZUludCggdGhpcy5lbGVtZW50LmNzcyggXCJtYXJnaW5Cb3R0b21cIiApLCAxMCApIHx8IDAgKVxuXHRcdH07XG5cdH0sXG5cblx0X2NhY2hlSGVscGVyUHJvcG9ydGlvbnM6IGZ1bmN0aW9uKCkge1xuXHRcdHRoaXMuaGVscGVyUHJvcG9ydGlvbnMgPSB7XG5cdFx0XHR3aWR0aDogdGhpcy5oZWxwZXIub3V0ZXJXaWR0aCgpLFxuXHRcdFx0aGVpZ2h0OiB0aGlzLmhlbHBlci5vdXRlckhlaWdodCgpXG5cdFx0fTtcblx0fSxcblxuXHRfc2V0Q29udGFpbm1lbnQ6IGZ1bmN0aW9uKCkge1xuXG5cdFx0dmFyIGlzVXNlclNjcm9sbGFibGUsIGMsIGNlLFxuXHRcdFx0byA9IHRoaXMub3B0aW9ucyxcblx0XHRcdGRvY3VtZW50ID0gdGhpcy5kb2N1bWVudFsgMCBdO1xuXG5cdFx0dGhpcy5yZWxhdGl2ZUNvbnRhaW5lciA9IG51bGw7XG5cblx0XHRpZiAoICFvLmNvbnRhaW5tZW50ICkge1xuXHRcdFx0dGhpcy5jb250YWlubWVudCA9IG51bGw7XG5cdFx0XHRyZXR1cm47XG5cdFx0fVxuXG5cdFx0aWYgKCBvLmNvbnRhaW5tZW50ID09PSBcIndpbmRvd1wiICkge1xuXHRcdFx0dGhpcy5jb250YWlubWVudCA9IFtcblx0XHRcdFx0JCggd2luZG93ICkuc2Nyb2xsTGVmdCgpIC0gdGhpcy5vZmZzZXQucmVsYXRpdmUubGVmdCAtIHRoaXMub2Zmc2V0LnBhcmVudC5sZWZ0LFxuXHRcdFx0XHQkKCB3aW5kb3cgKS5zY3JvbGxUb3AoKSAtIHRoaXMub2Zmc2V0LnJlbGF0aXZlLnRvcCAtIHRoaXMub2Zmc2V0LnBhcmVudC50b3AsXG5cdFx0XHRcdCQoIHdpbmRvdyApLnNjcm9sbExlZnQoKSArICQoIHdpbmRvdyApLndpZHRoKCkgLVxuXHRcdFx0XHRcdHRoaXMuaGVscGVyUHJvcG9ydGlvbnMud2lkdGggLSB0aGlzLm1hcmdpbnMubGVmdCxcblx0XHRcdFx0JCggd2luZG93ICkuc2Nyb2xsVG9wKCkgK1xuXHRcdFx0XHRcdCggJCggd2luZG93ICkuaGVpZ2h0KCkgfHwgZG9jdW1lbnQuYm9keS5wYXJlbnROb2RlLnNjcm9sbEhlaWdodCApIC1cblx0XHRcdFx0XHR0aGlzLmhlbHBlclByb3BvcnRpb25zLmhlaWdodCAtIHRoaXMubWFyZ2lucy50b3Bcblx0XHRcdF07XG5cdFx0XHRyZXR1cm47XG5cdFx0fVxuXG5cdFx0aWYgKCBvLmNvbnRhaW5tZW50ID09PSBcImRvY3VtZW50XCIgKSB7XG5cdFx0XHR0aGlzLmNvbnRhaW5tZW50ID0gW1xuXHRcdFx0XHQwLFxuXHRcdFx0XHQwLFxuXHRcdFx0XHQkKCBkb2N1bWVudCApLndpZHRoKCkgLSB0aGlzLmhlbHBlclByb3BvcnRpb25zLndpZHRoIC0gdGhpcy5tYXJnaW5zLmxlZnQsXG5cdFx0XHRcdCggJCggZG9jdW1lbnQgKS5oZWlnaHQoKSB8fCBkb2N1bWVudC5ib2R5LnBhcmVudE5vZGUuc2Nyb2xsSGVpZ2h0ICkgLVxuXHRcdFx0XHRcdHRoaXMuaGVscGVyUHJvcG9ydGlvbnMuaGVpZ2h0IC0gdGhpcy5tYXJnaW5zLnRvcFxuXHRcdFx0XTtcblx0XHRcdHJldHVybjtcblx0XHR9XG5cblx0XHRpZiAoIG8uY29udGFpbm1lbnQuY29uc3RydWN0b3IgPT09IEFycmF5ICkge1xuXHRcdFx0dGhpcy5jb250YWlubWVudCA9IG8uY29udGFpbm1lbnQ7XG5cdFx0XHRyZXR1cm47XG5cdFx0fVxuXG5cdFx0aWYgKCBvLmNvbnRhaW5tZW50ID09PSBcInBhcmVudFwiICkge1xuXHRcdFx0by5jb250YWlubWVudCA9IHRoaXMuaGVscGVyWyAwIF0ucGFyZW50Tm9kZTtcblx0XHR9XG5cblx0XHRjID0gJCggby5jb250YWlubWVudCApO1xuXHRcdGNlID0gY1sgMCBdO1xuXG5cdFx0aWYgKCAhY2UgKSB7XG5cdFx0XHRyZXR1cm47XG5cdFx0fVxuXG5cdFx0aXNVc2VyU2Nyb2xsYWJsZSA9IC8oc2Nyb2xsfGF1dG8pLy50ZXN0KCBjLmNzcyggXCJvdmVyZmxvd1wiICkgKTtcblxuXHRcdHRoaXMuY29udGFpbm1lbnQgPSBbXG5cdFx0XHQoIHBhcnNlSW50KCBjLmNzcyggXCJib3JkZXJMZWZ0V2lkdGhcIiApLCAxMCApIHx8IDAgKSArXG5cdFx0XHRcdCggcGFyc2VJbnQoIGMuY3NzKCBcInBhZGRpbmdMZWZ0XCIgKSwgMTAgKSB8fCAwICksXG5cdFx0XHQoIHBhcnNlSW50KCBjLmNzcyggXCJib3JkZXJUb3BXaWR0aFwiICksIDEwICkgfHwgMCApICtcblx0XHRcdFx0KCBwYXJzZUludCggYy5jc3MoIFwicGFkZGluZ1RvcFwiICksIDEwICkgfHwgMCApLFxuXHRcdFx0KCBpc1VzZXJTY3JvbGxhYmxlID8gTWF0aC5tYXgoIGNlLnNjcm9sbFdpZHRoLCBjZS5vZmZzZXRXaWR0aCApIDogY2Uub2Zmc2V0V2lkdGggKSAtXG5cdFx0XHRcdCggcGFyc2VJbnQoIGMuY3NzKCBcImJvcmRlclJpZ2h0V2lkdGhcIiApLCAxMCApIHx8IDAgKSAtXG5cdFx0XHRcdCggcGFyc2VJbnQoIGMuY3NzKCBcInBhZGRpbmdSaWdodFwiICksIDEwICkgfHwgMCApIC1cblx0XHRcdFx0dGhpcy5oZWxwZXJQcm9wb3J0aW9ucy53aWR0aCAtXG5cdFx0XHRcdHRoaXMubWFyZ2lucy5sZWZ0IC1cblx0XHRcdFx0dGhpcy5tYXJnaW5zLnJpZ2h0LFxuXHRcdFx0KCBpc1VzZXJTY3JvbGxhYmxlID8gTWF0aC5tYXgoIGNlLnNjcm9sbEhlaWdodCwgY2Uub2Zmc2V0SGVpZ2h0ICkgOiBjZS5vZmZzZXRIZWlnaHQgKSAtXG5cdFx0XHRcdCggcGFyc2VJbnQoIGMuY3NzKCBcImJvcmRlckJvdHRvbVdpZHRoXCIgKSwgMTAgKSB8fCAwICkgLVxuXHRcdFx0XHQoIHBhcnNlSW50KCBjLmNzcyggXCJwYWRkaW5nQm90dG9tXCIgKSwgMTAgKSB8fCAwICkgLVxuXHRcdFx0XHR0aGlzLmhlbHBlclByb3BvcnRpb25zLmhlaWdodCAtXG5cdFx0XHRcdHRoaXMubWFyZ2lucy50b3AgLVxuXHRcdFx0XHR0aGlzLm1hcmdpbnMuYm90dG9tXG5cdFx0XTtcblx0XHR0aGlzLnJlbGF0aXZlQ29udGFpbmVyID0gYztcblx0fSxcblxuXHRfY29udmVydFBvc2l0aW9uVG86IGZ1bmN0aW9uKCBkLCBwb3MgKSB7XG5cblx0XHRpZiAoICFwb3MgKSB7XG5cdFx0XHRwb3MgPSB0aGlzLnBvc2l0aW9uO1xuXHRcdH1cblxuXHRcdHZhciBtb2QgPSBkID09PSBcImFic29sdXRlXCIgPyAxIDogLTEsXG5cdFx0XHRzY3JvbGxJc1Jvb3ROb2RlID0gdGhpcy5faXNSb290Tm9kZSggdGhpcy5zY3JvbGxQYXJlbnRbIDAgXSApO1xuXG5cdFx0cmV0dXJuIHtcblx0XHRcdHRvcDogKFxuXG5cdFx0XHRcdC8vIFRoZSBhYnNvbHV0ZSBtb3VzZSBwb3NpdGlvblxuXHRcdFx0XHRwb3MudG9wXHQrXG5cblx0XHRcdFx0Ly8gT25seSBmb3IgcmVsYXRpdmUgcG9zaXRpb25lZCBub2RlczogUmVsYXRpdmUgb2Zmc2V0IGZyb20gZWxlbWVudCB0byBvZmZzZXQgcGFyZW50XG5cdFx0XHRcdHRoaXMub2Zmc2V0LnJlbGF0aXZlLnRvcCAqIG1vZCArXG5cblx0XHRcdFx0Ly8gVGhlIG9mZnNldFBhcmVudCdzIG9mZnNldCB3aXRob3V0IGJvcmRlcnMgKG9mZnNldCArIGJvcmRlcilcblx0XHRcdFx0dGhpcy5vZmZzZXQucGFyZW50LnRvcCAqIG1vZCAtXG5cdFx0XHRcdCggKCB0aGlzLmNzc1Bvc2l0aW9uID09PSBcImZpeGVkXCIgP1xuXHRcdFx0XHRcdC10aGlzLm9mZnNldC5zY3JvbGwudG9wIDpcblx0XHRcdFx0XHQoIHNjcm9sbElzUm9vdE5vZGUgPyAwIDogdGhpcy5vZmZzZXQuc2Nyb2xsLnRvcCApICkgKiBtb2QgKVxuXHRcdFx0KSxcblx0XHRcdGxlZnQ6IChcblxuXHRcdFx0XHQvLyBUaGUgYWJzb2x1dGUgbW91c2UgcG9zaXRpb25cblx0XHRcdFx0cG9zLmxlZnQgK1xuXG5cdFx0XHRcdC8vIE9ubHkgZm9yIHJlbGF0aXZlIHBvc2l0aW9uZWQgbm9kZXM6IFJlbGF0aXZlIG9mZnNldCBmcm9tIGVsZW1lbnQgdG8gb2Zmc2V0IHBhcmVudFxuXHRcdFx0XHR0aGlzLm9mZnNldC5yZWxhdGl2ZS5sZWZ0ICogbW9kICtcblxuXHRcdFx0XHQvLyBUaGUgb2Zmc2V0UGFyZW50J3Mgb2Zmc2V0IHdpdGhvdXQgYm9yZGVycyAob2Zmc2V0ICsgYm9yZGVyKVxuXHRcdFx0XHR0aGlzLm9mZnNldC5wYXJlbnQubGVmdCAqIG1vZFx0LVxuXHRcdFx0XHQoICggdGhpcy5jc3NQb3NpdGlvbiA9PT0gXCJmaXhlZFwiID9cblx0XHRcdFx0XHQtdGhpcy5vZmZzZXQuc2Nyb2xsLmxlZnQgOlxuXHRcdFx0XHRcdCggc2Nyb2xsSXNSb290Tm9kZSA/IDAgOiB0aGlzLm9mZnNldC5zY3JvbGwubGVmdCApICkgKiBtb2QgKVxuXHRcdFx0KVxuXHRcdH07XG5cblx0fSxcblxuXHRfZ2VuZXJhdGVQb3NpdGlvbjogZnVuY3Rpb24oIGV2ZW50LCBjb25zdHJhaW5Qb3NpdGlvbiApIHtcblxuXHRcdHZhciBjb250YWlubWVudCwgY28sIHRvcCwgbGVmdCxcblx0XHRcdG8gPSB0aGlzLm9wdGlvbnMsXG5cdFx0XHRzY3JvbGxJc1Jvb3ROb2RlID0gdGhpcy5faXNSb290Tm9kZSggdGhpcy5zY3JvbGxQYXJlbnRbIDAgXSApLFxuXHRcdFx0cGFnZVggPSBldmVudC5wYWdlWCxcblx0XHRcdHBhZ2VZID0gZXZlbnQucGFnZVk7XG5cblx0XHQvLyBDYWNoZSB0aGUgc2Nyb2xsXG5cdFx0aWYgKCAhc2Nyb2xsSXNSb290Tm9kZSB8fCAhdGhpcy5vZmZzZXQuc2Nyb2xsICkge1xuXHRcdFx0dGhpcy5vZmZzZXQuc2Nyb2xsID0ge1xuXHRcdFx0XHR0b3A6IHRoaXMuc2Nyb2xsUGFyZW50LnNjcm9sbFRvcCgpLFxuXHRcdFx0XHRsZWZ0OiB0aGlzLnNjcm9sbFBhcmVudC5zY3JvbGxMZWZ0KClcblx0XHRcdH07XG5cdFx0fVxuXG5cdFx0Lypcblx0XHQgKiAtIFBvc2l0aW9uIGNvbnN0cmFpbmluZyAtXG5cdFx0ICogQ29uc3RyYWluIHRoZSBwb3NpdGlvbiB0byBhIG1peCBvZiBncmlkLCBjb250YWlubWVudC5cblx0XHQgKi9cblxuXHRcdC8vIElmIHdlIGFyZSBub3QgZHJhZ2dpbmcgeWV0LCB3ZSB3b24ndCBjaGVjayBmb3Igb3B0aW9uc1xuXHRcdGlmICggY29uc3RyYWluUG9zaXRpb24gKSB7XG5cdFx0XHRpZiAoIHRoaXMuY29udGFpbm1lbnQgKSB7XG5cdFx0XHRcdGlmICggdGhpcy5yZWxhdGl2ZUNvbnRhaW5lciApIHtcblx0XHRcdFx0XHRjbyA9IHRoaXMucmVsYXRpdmVDb250YWluZXIub2Zmc2V0KCk7XG5cdFx0XHRcdFx0Y29udGFpbm1lbnQgPSBbXG5cdFx0XHRcdFx0XHR0aGlzLmNvbnRhaW5tZW50WyAwIF0gKyBjby5sZWZ0LFxuXHRcdFx0XHRcdFx0dGhpcy5jb250YWlubWVudFsgMSBdICsgY28udG9wLFxuXHRcdFx0XHRcdFx0dGhpcy5jb250YWlubWVudFsgMiBdICsgY28ubGVmdCxcblx0XHRcdFx0XHRcdHRoaXMuY29udGFpbm1lbnRbIDMgXSArIGNvLnRvcFxuXHRcdFx0XHRcdF07XG5cdFx0XHRcdH0gZWxzZSB7XG5cdFx0XHRcdFx0Y29udGFpbm1lbnQgPSB0aGlzLmNvbnRhaW5tZW50O1xuXHRcdFx0XHR9XG5cblx0XHRcdFx0aWYgKCBldmVudC5wYWdlWCAtIHRoaXMub2Zmc2V0LmNsaWNrLmxlZnQgPCBjb250YWlubWVudFsgMCBdICkge1xuXHRcdFx0XHRcdHBhZ2VYID0gY29udGFpbm1lbnRbIDAgXSArIHRoaXMub2Zmc2V0LmNsaWNrLmxlZnQ7XG5cdFx0XHRcdH1cblx0XHRcdFx0aWYgKCBldmVudC5wYWdlWSAtIHRoaXMub2Zmc2V0LmNsaWNrLnRvcCA8IGNvbnRhaW5tZW50WyAxIF0gKSB7XG5cdFx0XHRcdFx0cGFnZVkgPSBjb250YWlubWVudFsgMSBdICsgdGhpcy5vZmZzZXQuY2xpY2sudG9wO1xuXHRcdFx0XHR9XG5cdFx0XHRcdGlmICggZXZlbnQucGFnZVggLSB0aGlzLm9mZnNldC5jbGljay5sZWZ0ID4gY29udGFpbm1lbnRbIDIgXSApIHtcblx0XHRcdFx0XHRwYWdlWCA9IGNvbnRhaW5tZW50WyAyIF0gKyB0aGlzLm9mZnNldC5jbGljay5sZWZ0O1xuXHRcdFx0XHR9XG5cdFx0XHRcdGlmICggZXZlbnQucGFnZVkgLSB0aGlzLm9mZnNldC5jbGljay50b3AgPiBjb250YWlubWVudFsgMyBdICkge1xuXHRcdFx0XHRcdHBhZ2VZID0gY29udGFpbm1lbnRbIDMgXSArIHRoaXMub2Zmc2V0LmNsaWNrLnRvcDtcblx0XHRcdFx0fVxuXHRcdFx0fVxuXG5cdFx0XHRpZiAoIG8uZ3JpZCApIHtcblxuXHRcdFx0XHQvL0NoZWNrIGZvciBncmlkIGVsZW1lbnRzIHNldCB0byAwIHRvIHByZXZlbnQgZGl2aWRlIGJ5IDAgZXJyb3IgY2F1c2luZyBpbnZhbGlkXG5cdFx0XHRcdC8vIGFyZ3VtZW50IGVycm9ycyBpbiBJRSAoc2VlIHRpY2tldCAjNjk1MClcblx0XHRcdFx0dG9wID0gby5ncmlkWyAxIF0gPyB0aGlzLm9yaWdpbmFsUGFnZVkgKyBNYXRoLnJvdW5kKCAoIHBhZ2VZIC1cblx0XHRcdFx0XHR0aGlzLm9yaWdpbmFsUGFnZVkgKSAvIG8uZ3JpZFsgMSBdICkgKiBvLmdyaWRbIDEgXSA6IHRoaXMub3JpZ2luYWxQYWdlWTtcblx0XHRcdFx0cGFnZVkgPSBjb250YWlubWVudCA/ICggKCB0b3AgLSB0aGlzLm9mZnNldC5jbGljay50b3AgPj0gY29udGFpbm1lbnRbIDEgXSB8fFxuXHRcdFx0XHRcdHRvcCAtIHRoaXMub2Zmc2V0LmNsaWNrLnRvcCA+IGNvbnRhaW5tZW50WyAzIF0gKSA/XG5cdFx0XHRcdFx0XHR0b3AgOlxuXHRcdFx0XHRcdFx0KCAoIHRvcCAtIHRoaXMub2Zmc2V0LmNsaWNrLnRvcCA+PSBjb250YWlubWVudFsgMSBdICkgP1xuXHRcdFx0XHRcdFx0XHR0b3AgLSBvLmdyaWRbIDEgXSA6IHRvcCArIG8uZ3JpZFsgMSBdICkgKSA6IHRvcDtcblxuXHRcdFx0XHRsZWZ0ID0gby5ncmlkWyAwIF0gPyB0aGlzLm9yaWdpbmFsUGFnZVggK1xuXHRcdFx0XHRcdE1hdGgucm91bmQoICggcGFnZVggLSB0aGlzLm9yaWdpbmFsUGFnZVggKSAvIG8uZ3JpZFsgMCBdICkgKiBvLmdyaWRbIDAgXSA6XG5cdFx0XHRcdFx0dGhpcy5vcmlnaW5hbFBhZ2VYO1xuXHRcdFx0XHRwYWdlWCA9IGNvbnRhaW5tZW50ID8gKCAoIGxlZnQgLSB0aGlzLm9mZnNldC5jbGljay5sZWZ0ID49IGNvbnRhaW5tZW50WyAwIF0gfHxcblx0XHRcdFx0XHRsZWZ0IC0gdGhpcy5vZmZzZXQuY2xpY2subGVmdCA+IGNvbnRhaW5tZW50WyAyIF0gKSA/XG5cdFx0XHRcdFx0XHRsZWZ0IDpcblx0XHRcdFx0XHRcdCggKCBsZWZ0IC0gdGhpcy5vZmZzZXQuY2xpY2subGVmdCA+PSBjb250YWlubWVudFsgMCBdICkgP1xuXHRcdFx0XHRcdFx0XHRsZWZ0IC0gby5ncmlkWyAwIF0gOiBsZWZ0ICsgby5ncmlkWyAwIF0gKSApIDogbGVmdDtcblx0XHRcdH1cblxuXHRcdFx0aWYgKCBvLmF4aXMgPT09IFwieVwiICkge1xuXHRcdFx0XHRwYWdlWCA9IHRoaXMub3JpZ2luYWxQYWdlWDtcblx0XHRcdH1cblxuXHRcdFx0aWYgKCBvLmF4aXMgPT09IFwieFwiICkge1xuXHRcdFx0XHRwYWdlWSA9IHRoaXMub3JpZ2luYWxQYWdlWTtcblx0XHRcdH1cblx0XHR9XG5cblx0XHRyZXR1cm4ge1xuXHRcdFx0dG9wOiAoXG5cblx0XHRcdFx0Ly8gVGhlIGFic29sdXRlIG1vdXNlIHBvc2l0aW9uXG5cdFx0XHRcdHBhZ2VZIC1cblxuXHRcdFx0XHQvLyBDbGljayBvZmZzZXQgKHJlbGF0aXZlIHRvIHRoZSBlbGVtZW50KVxuXHRcdFx0XHR0aGlzLm9mZnNldC5jbGljay50b3AgLVxuXG5cdFx0XHRcdC8vIE9ubHkgZm9yIHJlbGF0aXZlIHBvc2l0aW9uZWQgbm9kZXM6IFJlbGF0aXZlIG9mZnNldCBmcm9tIGVsZW1lbnQgdG8gb2Zmc2V0IHBhcmVudFxuXHRcdFx0XHR0aGlzLm9mZnNldC5yZWxhdGl2ZS50b3AgLVxuXG5cdFx0XHRcdC8vIFRoZSBvZmZzZXRQYXJlbnQncyBvZmZzZXQgd2l0aG91dCBib3JkZXJzIChvZmZzZXQgKyBib3JkZXIpXG5cdFx0XHRcdHRoaXMub2Zmc2V0LnBhcmVudC50b3AgK1xuXHRcdFx0XHQoIHRoaXMuY3NzUG9zaXRpb24gPT09IFwiZml4ZWRcIiA/XG5cdFx0XHRcdFx0LXRoaXMub2Zmc2V0LnNjcm9sbC50b3AgOlxuXHRcdFx0XHRcdCggc2Nyb2xsSXNSb290Tm9kZSA/IDAgOiB0aGlzLm9mZnNldC5zY3JvbGwudG9wICkgKVxuXHRcdFx0KSxcblx0XHRcdGxlZnQ6IChcblxuXHRcdFx0XHQvLyBUaGUgYWJzb2x1dGUgbW91c2UgcG9zaXRpb25cblx0XHRcdFx0cGFnZVggLVxuXG5cdFx0XHRcdC8vIENsaWNrIG9mZnNldCAocmVsYXRpdmUgdG8gdGhlIGVsZW1lbnQpXG5cdFx0XHRcdHRoaXMub2Zmc2V0LmNsaWNrLmxlZnQgLVxuXG5cdFx0XHRcdC8vIE9ubHkgZm9yIHJlbGF0aXZlIHBvc2l0aW9uZWQgbm9kZXM6IFJlbGF0aXZlIG9mZnNldCBmcm9tIGVsZW1lbnQgdG8gb2Zmc2V0IHBhcmVudFxuXHRcdFx0XHR0aGlzLm9mZnNldC5yZWxhdGl2ZS5sZWZ0IC1cblxuXHRcdFx0XHQvLyBUaGUgb2Zmc2V0UGFyZW50J3Mgb2Zmc2V0IHdpdGhvdXQgYm9yZGVycyAob2Zmc2V0ICsgYm9yZGVyKVxuXHRcdFx0XHR0aGlzLm9mZnNldC5wYXJlbnQubGVmdCArXG5cdFx0XHRcdCggdGhpcy5jc3NQb3NpdGlvbiA9PT0gXCJmaXhlZFwiID9cblx0XHRcdFx0XHQtdGhpcy5vZmZzZXQuc2Nyb2xsLmxlZnQgOlxuXHRcdFx0XHRcdCggc2Nyb2xsSXNSb290Tm9kZSA/IDAgOiB0aGlzLm9mZnNldC5zY3JvbGwubGVmdCApIClcblx0XHRcdClcblx0XHR9O1xuXG5cdH0sXG5cblx0X2NsZWFyOiBmdW5jdGlvbigpIHtcblx0XHR0aGlzLl9yZW1vdmVDbGFzcyggdGhpcy5oZWxwZXIsIFwidWktZHJhZ2dhYmxlLWRyYWdnaW5nXCIgKTtcblx0XHRpZiAoIHRoaXMuaGVscGVyWyAwIF0gIT09IHRoaXMuZWxlbWVudFsgMCBdICYmICF0aGlzLmNhbmNlbEhlbHBlclJlbW92YWwgKSB7XG5cdFx0XHR0aGlzLmhlbHBlci5yZW1vdmUoKTtcblx0XHR9XG5cdFx0dGhpcy5oZWxwZXIgPSBudWxsO1xuXHRcdHRoaXMuY2FuY2VsSGVscGVyUmVtb3ZhbCA9IGZhbHNlO1xuXHRcdGlmICggdGhpcy5kZXN0cm95T25DbGVhciApIHtcblx0XHRcdHRoaXMuZGVzdHJveSgpO1xuXHRcdH1cblx0fSxcblxuXHQvLyBGcm9tIG5vdyBvbiBidWxrIHN0dWZmIC0gbWFpbmx5IGhlbHBlcnNcblxuXHRfdHJpZ2dlcjogZnVuY3Rpb24oIHR5cGUsIGV2ZW50LCB1aSApIHtcblx0XHR1aSA9IHVpIHx8IHRoaXMuX3VpSGFzaCgpO1xuXHRcdCQudWkucGx1Z2luLmNhbGwoIHRoaXMsIHR5cGUsIFsgZXZlbnQsIHVpLCB0aGlzIF0sIHRydWUgKTtcblxuXHRcdC8vIEFic29sdXRlIHBvc2l0aW9uIGFuZCBvZmZzZXQgKHNlZSAjNjg4NCApIGhhdmUgdG8gYmUgcmVjYWxjdWxhdGVkIGFmdGVyIHBsdWdpbnNcblx0XHRpZiAoIC9eKGRyYWd8c3RhcnR8c3RvcCkvLnRlc3QoIHR5cGUgKSApIHtcblx0XHRcdHRoaXMucG9zaXRpb25BYnMgPSB0aGlzLl9jb252ZXJ0UG9zaXRpb25UbyggXCJhYnNvbHV0ZVwiICk7XG5cdFx0XHR1aS5vZmZzZXQgPSB0aGlzLnBvc2l0aW9uQWJzO1xuXHRcdH1cblx0XHRyZXR1cm4gJC5XaWRnZXQucHJvdG90eXBlLl90cmlnZ2VyLmNhbGwoIHRoaXMsIHR5cGUsIGV2ZW50LCB1aSApO1xuXHR9LFxuXG5cdHBsdWdpbnM6IHt9LFxuXG5cdF91aUhhc2g6IGZ1bmN0aW9uKCkge1xuXHRcdHJldHVybiB7XG5cdFx0XHRoZWxwZXI6IHRoaXMuaGVscGVyLFxuXHRcdFx0cG9zaXRpb246IHRoaXMucG9zaXRpb24sXG5cdFx0XHRvcmlnaW5hbFBvc2l0aW9uOiB0aGlzLm9yaWdpbmFsUG9zaXRpb24sXG5cdFx0XHRvZmZzZXQ6IHRoaXMucG9zaXRpb25BYnNcblx0XHR9O1xuXHR9XG5cbn0gKTtcblxuJC51aS5wbHVnaW4uYWRkKCBcImRyYWdnYWJsZVwiLCBcImNvbm5lY3RUb1NvcnRhYmxlXCIsIHtcblx0c3RhcnQ6IGZ1bmN0aW9uKCBldmVudCwgdWksIGRyYWdnYWJsZSApIHtcblx0XHR2YXIgdWlTb3J0YWJsZSA9ICQuZXh0ZW5kKCB7fSwgdWksIHtcblx0XHRcdGl0ZW06IGRyYWdnYWJsZS5lbGVtZW50XG5cdFx0fSApO1xuXG5cdFx0ZHJhZ2dhYmxlLnNvcnRhYmxlcyA9IFtdO1xuXHRcdCQoIGRyYWdnYWJsZS5vcHRpb25zLmNvbm5lY3RUb1NvcnRhYmxlICkuZWFjaCggZnVuY3Rpb24oKSB7XG5cdFx0XHR2YXIgc29ydGFibGUgPSAkKCB0aGlzICkuc29ydGFibGUoIFwiaW5zdGFuY2VcIiApO1xuXG5cdFx0XHRpZiAoIHNvcnRhYmxlICYmICFzb3J0YWJsZS5vcHRpb25zLmRpc2FibGVkICkge1xuXHRcdFx0XHRkcmFnZ2FibGUuc29ydGFibGVzLnB1c2goIHNvcnRhYmxlICk7XG5cblx0XHRcdFx0Ly8gUmVmcmVzaFBvc2l0aW9ucyBpcyBjYWxsZWQgYXQgZHJhZyBzdGFydCB0byByZWZyZXNoIHRoZSBjb250YWluZXJDYWNoZVxuXHRcdFx0XHQvLyB3aGljaCBpcyB1c2VkIGluIGRyYWcuIFRoaXMgZW5zdXJlcyBpdCdzIGluaXRpYWxpemVkIGFuZCBzeW5jaHJvbml6ZWRcblx0XHRcdFx0Ly8gd2l0aCBhbnkgY2hhbmdlcyB0aGF0IG1pZ2h0IGhhdmUgaGFwcGVuZWQgb24gdGhlIHBhZ2Ugc2luY2UgaW5pdGlhbGl6YXRpb24uXG5cdFx0XHRcdHNvcnRhYmxlLnJlZnJlc2hQb3NpdGlvbnMoKTtcblx0XHRcdFx0c29ydGFibGUuX3RyaWdnZXIoIFwiYWN0aXZhdGVcIiwgZXZlbnQsIHVpU29ydGFibGUgKTtcblx0XHRcdH1cblx0XHR9ICk7XG5cdH0sXG5cdHN0b3A6IGZ1bmN0aW9uKCBldmVudCwgdWksIGRyYWdnYWJsZSApIHtcblx0XHR2YXIgdWlTb3J0YWJsZSA9ICQuZXh0ZW5kKCB7fSwgdWksIHtcblx0XHRcdGl0ZW06IGRyYWdnYWJsZS5lbGVtZW50XG5cdFx0fSApO1xuXG5cdFx0ZHJhZ2dhYmxlLmNhbmNlbEhlbHBlclJlbW92YWwgPSBmYWxzZTtcblxuXHRcdCQuZWFjaCggZHJhZ2dhYmxlLnNvcnRhYmxlcywgZnVuY3Rpb24oKSB7XG5cdFx0XHR2YXIgc29ydGFibGUgPSB0aGlzO1xuXG5cdFx0XHRpZiAoIHNvcnRhYmxlLmlzT3ZlciApIHtcblx0XHRcdFx0c29ydGFibGUuaXNPdmVyID0gMDtcblxuXHRcdFx0XHQvLyBBbGxvdyB0aGlzIHNvcnRhYmxlIHRvIGhhbmRsZSByZW1vdmluZyB0aGUgaGVscGVyXG5cdFx0XHRcdGRyYWdnYWJsZS5jYW5jZWxIZWxwZXJSZW1vdmFsID0gdHJ1ZTtcblx0XHRcdFx0c29ydGFibGUuY2FuY2VsSGVscGVyUmVtb3ZhbCA9IGZhbHNlO1xuXG5cdFx0XHRcdC8vIFVzZSBfc3RvcmVkQ1NTIFRvIHJlc3RvcmUgcHJvcGVydGllcyBpbiB0aGUgc29ydGFibGUsXG5cdFx0XHRcdC8vIGFzIHRoaXMgYWxzbyBoYW5kbGVzIHJldmVydCAoIzk2NzUpIHNpbmNlIHRoZSBkcmFnZ2FibGVcblx0XHRcdFx0Ly8gbWF5IGhhdmUgbW9kaWZpZWQgdGhlbSBpbiB1bmV4cGVjdGVkIHdheXMgKCM4ODA5KVxuXHRcdFx0XHRzb3J0YWJsZS5fc3RvcmVkQ1NTID0ge1xuXHRcdFx0XHRcdHBvc2l0aW9uOiBzb3J0YWJsZS5wbGFjZWhvbGRlci5jc3MoIFwicG9zaXRpb25cIiApLFxuXHRcdFx0XHRcdHRvcDogc29ydGFibGUucGxhY2Vob2xkZXIuY3NzKCBcInRvcFwiICksXG5cdFx0XHRcdFx0bGVmdDogc29ydGFibGUucGxhY2Vob2xkZXIuY3NzKCBcImxlZnRcIiApXG5cdFx0XHRcdH07XG5cblx0XHRcdFx0c29ydGFibGUuX21vdXNlU3RvcCggZXZlbnQgKTtcblxuXHRcdFx0XHQvLyBPbmNlIGRyYWcgaGFzIGVuZGVkLCB0aGUgc29ydGFibGUgc2hvdWxkIHJldHVybiB0byB1c2luZ1xuXHRcdFx0XHQvLyBpdHMgb3JpZ2luYWwgaGVscGVyLCBub3QgdGhlIHNoYXJlZCBoZWxwZXIgZnJvbSBkcmFnZ2FibGVcblx0XHRcdFx0c29ydGFibGUub3B0aW9ucy5oZWxwZXIgPSBzb3J0YWJsZS5vcHRpb25zLl9oZWxwZXI7XG5cdFx0XHR9IGVsc2Uge1xuXG5cdFx0XHRcdC8vIFByZXZlbnQgdGhpcyBTb3J0YWJsZSBmcm9tIHJlbW92aW5nIHRoZSBoZWxwZXIuXG5cdFx0XHRcdC8vIEhvd2V2ZXIsIGRvbid0IHNldCB0aGUgZHJhZ2dhYmxlIHRvIHJlbW92ZSB0aGUgaGVscGVyXG5cdFx0XHRcdC8vIGVpdGhlciBhcyBhbm90aGVyIGNvbm5lY3RlZCBTb3J0YWJsZSBtYXkgeWV0IGhhbmRsZSB0aGUgcmVtb3ZhbC5cblx0XHRcdFx0c29ydGFibGUuY2FuY2VsSGVscGVyUmVtb3ZhbCA9IHRydWU7XG5cblx0XHRcdFx0c29ydGFibGUuX3RyaWdnZXIoIFwiZGVhY3RpdmF0ZVwiLCBldmVudCwgdWlTb3J0YWJsZSApO1xuXHRcdFx0fVxuXHRcdH0gKTtcblx0fSxcblx0ZHJhZzogZnVuY3Rpb24oIGV2ZW50LCB1aSwgZHJhZ2dhYmxlICkge1xuXHRcdCQuZWFjaCggZHJhZ2dhYmxlLnNvcnRhYmxlcywgZnVuY3Rpb24oKSB7XG5cdFx0XHR2YXIgaW5uZXJtb3N0SW50ZXJzZWN0aW5nID0gZmFsc2UsXG5cdFx0XHRcdHNvcnRhYmxlID0gdGhpcztcblxuXHRcdFx0Ly8gQ29weSBvdmVyIHZhcmlhYmxlcyB0aGF0IHNvcnRhYmxlJ3MgX2ludGVyc2VjdHNXaXRoIHVzZXNcblx0XHRcdHNvcnRhYmxlLnBvc2l0aW9uQWJzID0gZHJhZ2dhYmxlLnBvc2l0aW9uQWJzO1xuXHRcdFx0c29ydGFibGUuaGVscGVyUHJvcG9ydGlvbnMgPSBkcmFnZ2FibGUuaGVscGVyUHJvcG9ydGlvbnM7XG5cdFx0XHRzb3J0YWJsZS5vZmZzZXQuY2xpY2sgPSBkcmFnZ2FibGUub2Zmc2V0LmNsaWNrO1xuXG5cdFx0XHRpZiAoIHNvcnRhYmxlLl9pbnRlcnNlY3RzV2l0aCggc29ydGFibGUuY29udGFpbmVyQ2FjaGUgKSApIHtcblx0XHRcdFx0aW5uZXJtb3N0SW50ZXJzZWN0aW5nID0gdHJ1ZTtcblxuXHRcdFx0XHQkLmVhY2goIGRyYWdnYWJsZS5zb3J0YWJsZXMsIGZ1bmN0aW9uKCkge1xuXG5cdFx0XHRcdFx0Ly8gQ29weSBvdmVyIHZhcmlhYmxlcyB0aGF0IHNvcnRhYmxlJ3MgX2ludGVyc2VjdHNXaXRoIHVzZXNcblx0XHRcdFx0XHR0aGlzLnBvc2l0aW9uQWJzID0gZHJhZ2dhYmxlLnBvc2l0aW9uQWJzO1xuXHRcdFx0XHRcdHRoaXMuaGVscGVyUHJvcG9ydGlvbnMgPSBkcmFnZ2FibGUuaGVscGVyUHJvcG9ydGlvbnM7XG5cdFx0XHRcdFx0dGhpcy5vZmZzZXQuY2xpY2sgPSBkcmFnZ2FibGUub2Zmc2V0LmNsaWNrO1xuXG5cdFx0XHRcdFx0aWYgKCB0aGlzICE9PSBzb3J0YWJsZSAmJlxuXHRcdFx0XHRcdFx0XHR0aGlzLl9pbnRlcnNlY3RzV2l0aCggdGhpcy5jb250YWluZXJDYWNoZSApICYmXG5cdFx0XHRcdFx0XHRcdCQuY29udGFpbnMoIHNvcnRhYmxlLmVsZW1lbnRbIDAgXSwgdGhpcy5lbGVtZW50WyAwIF0gKSApIHtcblx0XHRcdFx0XHRcdGlubmVybW9zdEludGVyc2VjdGluZyA9IGZhbHNlO1xuXHRcdFx0XHRcdH1cblxuXHRcdFx0XHRcdHJldHVybiBpbm5lcm1vc3RJbnRlcnNlY3Rpbmc7XG5cdFx0XHRcdH0gKTtcblx0XHRcdH1cblxuXHRcdFx0aWYgKCBpbm5lcm1vc3RJbnRlcnNlY3RpbmcgKSB7XG5cblx0XHRcdFx0Ly8gSWYgaXQgaW50ZXJzZWN0cywgd2UgdXNlIGEgbGl0dGxlIGlzT3ZlciB2YXJpYWJsZSBhbmQgc2V0IGl0IG9uY2UsXG5cdFx0XHRcdC8vIHNvIHRoYXQgdGhlIG1vdmUtaW4gc3R1ZmYgZ2V0cyBmaXJlZCBvbmx5IG9uY2UuXG5cdFx0XHRcdGlmICggIXNvcnRhYmxlLmlzT3ZlciApIHtcblx0XHRcdFx0XHRzb3J0YWJsZS5pc092ZXIgPSAxO1xuXG5cdFx0XHRcdFx0Ly8gU3RvcmUgZHJhZ2dhYmxlJ3MgcGFyZW50IGluIGNhc2Ugd2UgbmVlZCB0byByZWFwcGVuZCB0byBpdCBsYXRlci5cblx0XHRcdFx0XHRkcmFnZ2FibGUuX3BhcmVudCA9IHVpLmhlbHBlci5wYXJlbnQoKTtcblxuXHRcdFx0XHRcdHNvcnRhYmxlLmN1cnJlbnRJdGVtID0gdWkuaGVscGVyXG5cdFx0XHRcdFx0XHQuYXBwZW5kVG8oIHNvcnRhYmxlLmVsZW1lbnQgKVxuXHRcdFx0XHRcdFx0LmRhdGEoIFwidWktc29ydGFibGUtaXRlbVwiLCB0cnVlICk7XG5cblx0XHRcdFx0XHQvLyBTdG9yZSBoZWxwZXIgb3B0aW9uIHRvIGxhdGVyIHJlc3RvcmUgaXRcblx0XHRcdFx0XHRzb3J0YWJsZS5vcHRpb25zLl9oZWxwZXIgPSBzb3J0YWJsZS5vcHRpb25zLmhlbHBlcjtcblxuXHRcdFx0XHRcdHNvcnRhYmxlLm9wdGlvbnMuaGVscGVyID0gZnVuY3Rpb24oKSB7XG5cdFx0XHRcdFx0XHRyZXR1cm4gdWkuaGVscGVyWyAwIF07XG5cdFx0XHRcdFx0fTtcblxuXHRcdFx0XHRcdC8vIEZpcmUgdGhlIHN0YXJ0IGV2ZW50cyBvZiB0aGUgc29ydGFibGUgd2l0aCBvdXIgcGFzc2VkIGJyb3dzZXIgZXZlbnQsXG5cdFx0XHRcdFx0Ly8gYW5kIG91ciBvd24gaGVscGVyIChzbyBpdCBkb2Vzbid0IGNyZWF0ZSBhIG5ldyBvbmUpXG5cdFx0XHRcdFx0ZXZlbnQudGFyZ2V0ID0gc29ydGFibGUuY3VycmVudEl0ZW1bIDAgXTtcblx0XHRcdFx0XHRzb3J0YWJsZS5fbW91c2VDYXB0dXJlKCBldmVudCwgdHJ1ZSApO1xuXHRcdFx0XHRcdHNvcnRhYmxlLl9tb3VzZVN0YXJ0KCBldmVudCwgdHJ1ZSwgdHJ1ZSApO1xuXG5cdFx0XHRcdFx0Ly8gQmVjYXVzZSB0aGUgYnJvd3NlciBldmVudCBpcyB3YXkgb2ZmIHRoZSBuZXcgYXBwZW5kZWQgcG9ydGxldCxcblx0XHRcdFx0XHQvLyBtb2RpZnkgbmVjZXNzYXJ5IHZhcmlhYmxlcyB0byByZWZsZWN0IHRoZSBjaGFuZ2VzXG5cdFx0XHRcdFx0c29ydGFibGUub2Zmc2V0LmNsaWNrLnRvcCA9IGRyYWdnYWJsZS5vZmZzZXQuY2xpY2sudG9wO1xuXHRcdFx0XHRcdHNvcnRhYmxlLm9mZnNldC5jbGljay5sZWZ0ID0gZHJhZ2dhYmxlLm9mZnNldC5jbGljay5sZWZ0O1xuXHRcdFx0XHRcdHNvcnRhYmxlLm9mZnNldC5wYXJlbnQubGVmdCAtPSBkcmFnZ2FibGUub2Zmc2V0LnBhcmVudC5sZWZ0IC1cblx0XHRcdFx0XHRcdHNvcnRhYmxlLm9mZnNldC5wYXJlbnQubGVmdDtcblx0XHRcdFx0XHRzb3J0YWJsZS5vZmZzZXQucGFyZW50LnRvcCAtPSBkcmFnZ2FibGUub2Zmc2V0LnBhcmVudC50b3AgLVxuXHRcdFx0XHRcdFx0c29ydGFibGUub2Zmc2V0LnBhcmVudC50b3A7XG5cblx0XHRcdFx0XHRkcmFnZ2FibGUuX3RyaWdnZXIoIFwidG9Tb3J0YWJsZVwiLCBldmVudCApO1xuXG5cdFx0XHRcdFx0Ly8gSW5mb3JtIGRyYWdnYWJsZSB0aGF0IHRoZSBoZWxwZXIgaXMgaW4gYSB2YWxpZCBkcm9wIHpvbmUsXG5cdFx0XHRcdFx0Ly8gdXNlZCBzb2xlbHkgaW4gdGhlIHJldmVydCBvcHRpb24gdG8gaGFuZGxlIFwidmFsaWQvaW52YWxpZFwiLlxuXHRcdFx0XHRcdGRyYWdnYWJsZS5kcm9wcGVkID0gc29ydGFibGUuZWxlbWVudDtcblxuXHRcdFx0XHRcdC8vIE5lZWQgdG8gcmVmcmVzaFBvc2l0aW9ucyBvZiBhbGwgc29ydGFibGVzIGluIHRoZSBjYXNlIHRoYXRcblx0XHRcdFx0XHQvLyBhZGRpbmcgdG8gb25lIHNvcnRhYmxlIGNoYW5nZXMgdGhlIGxvY2F0aW9uIG9mIHRoZSBvdGhlciBzb3J0YWJsZXMgKCM5Njc1KVxuXHRcdFx0XHRcdCQuZWFjaCggZHJhZ2dhYmxlLnNvcnRhYmxlcywgZnVuY3Rpb24oKSB7XG5cdFx0XHRcdFx0XHR0aGlzLnJlZnJlc2hQb3NpdGlvbnMoKTtcblx0XHRcdFx0XHR9ICk7XG5cblx0XHRcdFx0XHQvLyBIYWNrIHNvIHJlY2VpdmUvdXBkYXRlIGNhbGxiYWNrcyB3b3JrIChtb3N0bHkpXG5cdFx0XHRcdFx0ZHJhZ2dhYmxlLmN1cnJlbnRJdGVtID0gZHJhZ2dhYmxlLmVsZW1lbnQ7XG5cdFx0XHRcdFx0c29ydGFibGUuZnJvbU91dHNpZGUgPSBkcmFnZ2FibGU7XG5cdFx0XHRcdH1cblxuXHRcdFx0XHRpZiAoIHNvcnRhYmxlLmN1cnJlbnRJdGVtICkge1xuXHRcdFx0XHRcdHNvcnRhYmxlLl9tb3VzZURyYWcoIGV2ZW50ICk7XG5cblx0XHRcdFx0XHQvLyBDb3B5IHRoZSBzb3J0YWJsZSdzIHBvc2l0aW9uIGJlY2F1c2UgdGhlIGRyYWdnYWJsZSdzIGNhbiBwb3RlbnRpYWxseSByZWZsZWN0XG5cdFx0XHRcdFx0Ly8gYSByZWxhdGl2ZSBwb3NpdGlvbiwgd2hpbGUgc29ydGFibGUgaXMgYWx3YXlzIGFic29sdXRlLCB3aGljaCB0aGUgZHJhZ2dlZFxuXHRcdFx0XHRcdC8vIGVsZW1lbnQgaGFzIG5vdyBiZWNvbWUuICgjODgwOSlcblx0XHRcdFx0XHR1aS5wb3NpdGlvbiA9IHNvcnRhYmxlLnBvc2l0aW9uO1xuXHRcdFx0XHR9XG5cdFx0XHR9IGVsc2Uge1xuXG5cdFx0XHRcdC8vIElmIGl0IGRvZXNuJ3QgaW50ZXJzZWN0IHdpdGggdGhlIHNvcnRhYmxlLCBhbmQgaXQgaW50ZXJzZWN0ZWQgYmVmb3JlLFxuXHRcdFx0XHQvLyB3ZSBmYWtlIHRoZSBkcmFnIHN0b3Agb2YgdGhlIHNvcnRhYmxlLCBidXQgbWFrZSBzdXJlIGl0IGRvZXNuJ3QgcmVtb3ZlXG5cdFx0XHRcdC8vIHRoZSBoZWxwZXIgYnkgdXNpbmcgY2FuY2VsSGVscGVyUmVtb3ZhbC5cblx0XHRcdFx0aWYgKCBzb3J0YWJsZS5pc092ZXIgKSB7XG5cblx0XHRcdFx0XHRzb3J0YWJsZS5pc092ZXIgPSAwO1xuXHRcdFx0XHRcdHNvcnRhYmxlLmNhbmNlbEhlbHBlclJlbW92YWwgPSB0cnVlO1xuXG5cdFx0XHRcdFx0Ly8gQ2FsbGluZyBzb3J0YWJsZSdzIG1vdXNlU3RvcCB3b3VsZCB0cmlnZ2VyIGEgcmV2ZXJ0LFxuXHRcdFx0XHRcdC8vIHNvIHJldmVydCBtdXN0IGJlIHRlbXBvcmFyaWx5IGZhbHNlIHVudGlsIGFmdGVyIG1vdXNlU3RvcCBpcyBjYWxsZWQuXG5cdFx0XHRcdFx0c29ydGFibGUub3B0aW9ucy5fcmV2ZXJ0ID0gc29ydGFibGUub3B0aW9ucy5yZXZlcnQ7XG5cdFx0XHRcdFx0c29ydGFibGUub3B0aW9ucy5yZXZlcnQgPSBmYWxzZTtcblxuXHRcdFx0XHRcdHNvcnRhYmxlLl90cmlnZ2VyKCBcIm91dFwiLCBldmVudCwgc29ydGFibGUuX3VpSGFzaCggc29ydGFibGUgKSApO1xuXHRcdFx0XHRcdHNvcnRhYmxlLl9tb3VzZVN0b3AoIGV2ZW50LCB0cnVlICk7XG5cblx0XHRcdFx0XHQvLyBSZXN0b3JlIHNvcnRhYmxlIGJlaGF2aW9ycyB0aGF0IHdlcmUgbW9kZmllZFxuXHRcdFx0XHRcdC8vIHdoZW4gdGhlIGRyYWdnYWJsZSBlbnRlcmVkIHRoZSBzb3J0YWJsZSBhcmVhICgjOTQ4MSlcblx0XHRcdFx0XHRzb3J0YWJsZS5vcHRpb25zLnJldmVydCA9IHNvcnRhYmxlLm9wdGlvbnMuX3JldmVydDtcblx0XHRcdFx0XHRzb3J0YWJsZS5vcHRpb25zLmhlbHBlciA9IHNvcnRhYmxlLm9wdGlvbnMuX2hlbHBlcjtcblxuXHRcdFx0XHRcdGlmICggc29ydGFibGUucGxhY2Vob2xkZXIgKSB7XG5cdFx0XHRcdFx0XHRzb3J0YWJsZS5wbGFjZWhvbGRlci5yZW1vdmUoKTtcblx0XHRcdFx0XHR9XG5cblx0XHRcdFx0XHQvLyBSZXN0b3JlIGFuZCByZWNhbGN1bGF0ZSB0aGUgZHJhZ2dhYmxlJ3Mgb2Zmc2V0IGNvbnNpZGVyaW5nIHRoZSBzb3J0YWJsZVxuXHRcdFx0XHRcdC8vIG1heSBoYXZlIG1vZGlmaWVkIHRoZW0gaW4gdW5leHBlY3RlZCB3YXlzLiAoIzg4MDksICMxMDY2OSlcblx0XHRcdFx0XHR1aS5oZWxwZXIuYXBwZW5kVG8oIGRyYWdnYWJsZS5fcGFyZW50ICk7XG5cdFx0XHRcdFx0ZHJhZ2dhYmxlLl9yZWZyZXNoT2Zmc2V0cyggZXZlbnQgKTtcblx0XHRcdFx0XHR1aS5wb3NpdGlvbiA9IGRyYWdnYWJsZS5fZ2VuZXJhdGVQb3NpdGlvbiggZXZlbnQsIHRydWUgKTtcblxuXHRcdFx0XHRcdGRyYWdnYWJsZS5fdHJpZ2dlciggXCJmcm9tU29ydGFibGVcIiwgZXZlbnQgKTtcblxuXHRcdFx0XHRcdC8vIEluZm9ybSBkcmFnZ2FibGUgdGhhdCB0aGUgaGVscGVyIGlzIG5vIGxvbmdlciBpbiBhIHZhbGlkIGRyb3Agem9uZVxuXHRcdFx0XHRcdGRyYWdnYWJsZS5kcm9wcGVkID0gZmFsc2U7XG5cblx0XHRcdFx0XHQvLyBOZWVkIHRvIHJlZnJlc2hQb3NpdGlvbnMgb2YgYWxsIHNvcnRhYmxlcyBqdXN0IGluIGNhc2UgcmVtb3Zpbmdcblx0XHRcdFx0XHQvLyBmcm9tIG9uZSBzb3J0YWJsZSBjaGFuZ2VzIHRoZSBsb2NhdGlvbiBvZiBvdGhlciBzb3J0YWJsZXMgKCM5Njc1KVxuXHRcdFx0XHRcdCQuZWFjaCggZHJhZ2dhYmxlLnNvcnRhYmxlcywgZnVuY3Rpb24oKSB7XG5cdFx0XHRcdFx0XHR0aGlzLnJlZnJlc2hQb3NpdGlvbnMoKTtcblx0XHRcdFx0XHR9ICk7XG5cdFx0XHRcdH1cblx0XHRcdH1cblx0XHR9ICk7XG5cdH1cbn0gKTtcblxuJC51aS5wbHVnaW4uYWRkKCBcImRyYWdnYWJsZVwiLCBcImN1cnNvclwiLCB7XG5cdHN0YXJ0OiBmdW5jdGlvbiggZXZlbnQsIHVpLCBpbnN0YW5jZSApIHtcblx0XHR2YXIgdCA9ICQoIFwiYm9keVwiICksXG5cdFx0XHRvID0gaW5zdGFuY2Uub3B0aW9ucztcblxuXHRcdGlmICggdC5jc3MoIFwiY3Vyc29yXCIgKSApIHtcblx0XHRcdG8uX2N1cnNvciA9IHQuY3NzKCBcImN1cnNvclwiICk7XG5cdFx0fVxuXHRcdHQuY3NzKCBcImN1cnNvclwiLCBvLmN1cnNvciApO1xuXHR9LFxuXHRzdG9wOiBmdW5jdGlvbiggZXZlbnQsIHVpLCBpbnN0YW5jZSApIHtcblx0XHR2YXIgbyA9IGluc3RhbmNlLm9wdGlvbnM7XG5cdFx0aWYgKCBvLl9jdXJzb3IgKSB7XG5cdFx0XHQkKCBcImJvZHlcIiApLmNzcyggXCJjdXJzb3JcIiwgby5fY3Vyc29yICk7XG5cdFx0fVxuXHR9XG59ICk7XG5cbiQudWkucGx1Z2luLmFkZCggXCJkcmFnZ2FibGVcIiwgXCJvcGFjaXR5XCIsIHtcblx0c3RhcnQ6IGZ1bmN0aW9uKCBldmVudCwgdWksIGluc3RhbmNlICkge1xuXHRcdHZhciB0ID0gJCggdWkuaGVscGVyICksXG5cdFx0XHRvID0gaW5zdGFuY2Uub3B0aW9ucztcblx0XHRpZiAoIHQuY3NzKCBcIm9wYWNpdHlcIiApICkge1xuXHRcdFx0by5fb3BhY2l0eSA9IHQuY3NzKCBcIm9wYWNpdHlcIiApO1xuXHRcdH1cblx0XHR0LmNzcyggXCJvcGFjaXR5XCIsIG8ub3BhY2l0eSApO1xuXHR9LFxuXHRzdG9wOiBmdW5jdGlvbiggZXZlbnQsIHVpLCBpbnN0YW5jZSApIHtcblx0XHR2YXIgbyA9IGluc3RhbmNlLm9wdGlvbnM7XG5cdFx0aWYgKCBvLl9vcGFjaXR5ICkge1xuXHRcdFx0JCggdWkuaGVscGVyICkuY3NzKCBcIm9wYWNpdHlcIiwgby5fb3BhY2l0eSApO1xuXHRcdH1cblx0fVxufSApO1xuXG4kLnVpLnBsdWdpbi5hZGQoIFwiZHJhZ2dhYmxlXCIsIFwic2Nyb2xsXCIsIHtcblx0c3RhcnQ6IGZ1bmN0aW9uKCBldmVudCwgdWksIGkgKSB7XG5cdFx0aWYgKCAhaS5zY3JvbGxQYXJlbnROb3RIaWRkZW4gKSB7XG5cdFx0XHRpLnNjcm9sbFBhcmVudE5vdEhpZGRlbiA9IGkuaGVscGVyLnNjcm9sbFBhcmVudCggZmFsc2UgKTtcblx0XHR9XG5cblx0XHRpZiAoIGkuc2Nyb2xsUGFyZW50Tm90SGlkZGVuWyAwIF0gIT09IGkuZG9jdW1lbnRbIDAgXSAmJlxuXHRcdFx0XHRpLnNjcm9sbFBhcmVudE5vdEhpZGRlblsgMCBdLnRhZ05hbWUgIT09IFwiSFRNTFwiICkge1xuXHRcdFx0aS5vdmVyZmxvd09mZnNldCA9IGkuc2Nyb2xsUGFyZW50Tm90SGlkZGVuLm9mZnNldCgpO1xuXHRcdH1cblx0fSxcblx0ZHJhZzogZnVuY3Rpb24oIGV2ZW50LCB1aSwgaSAgKSB7XG5cblx0XHR2YXIgbyA9IGkub3B0aW9ucyxcblx0XHRcdHNjcm9sbGVkID0gZmFsc2UsXG5cdFx0XHRzY3JvbGxQYXJlbnQgPSBpLnNjcm9sbFBhcmVudE5vdEhpZGRlblsgMCBdLFxuXHRcdFx0ZG9jdW1lbnQgPSBpLmRvY3VtZW50WyAwIF07XG5cblx0XHRpZiAoIHNjcm9sbFBhcmVudCAhPT0gZG9jdW1lbnQgJiYgc2Nyb2xsUGFyZW50LnRhZ05hbWUgIT09IFwiSFRNTFwiICkge1xuXHRcdFx0aWYgKCAhby5heGlzIHx8IG8uYXhpcyAhPT0gXCJ4XCIgKSB7XG5cdFx0XHRcdGlmICggKCBpLm92ZXJmbG93T2Zmc2V0LnRvcCArIHNjcm9sbFBhcmVudC5vZmZzZXRIZWlnaHQgKSAtIGV2ZW50LnBhZ2VZIDxcblx0XHRcdFx0XHRcdG8uc2Nyb2xsU2Vuc2l0aXZpdHkgKSB7XG5cdFx0XHRcdFx0c2Nyb2xsUGFyZW50LnNjcm9sbFRvcCA9IHNjcm9sbGVkID0gc2Nyb2xsUGFyZW50LnNjcm9sbFRvcCArIG8uc2Nyb2xsU3BlZWQ7XG5cdFx0XHRcdH0gZWxzZSBpZiAoIGV2ZW50LnBhZ2VZIC0gaS5vdmVyZmxvd09mZnNldC50b3AgPCBvLnNjcm9sbFNlbnNpdGl2aXR5ICkge1xuXHRcdFx0XHRcdHNjcm9sbFBhcmVudC5zY3JvbGxUb3AgPSBzY3JvbGxlZCA9IHNjcm9sbFBhcmVudC5zY3JvbGxUb3AgLSBvLnNjcm9sbFNwZWVkO1xuXHRcdFx0XHR9XG5cdFx0XHR9XG5cblx0XHRcdGlmICggIW8uYXhpcyB8fCBvLmF4aXMgIT09IFwieVwiICkge1xuXHRcdFx0XHRpZiAoICggaS5vdmVyZmxvd09mZnNldC5sZWZ0ICsgc2Nyb2xsUGFyZW50Lm9mZnNldFdpZHRoICkgLSBldmVudC5wYWdlWCA8XG5cdFx0XHRcdFx0XHRvLnNjcm9sbFNlbnNpdGl2aXR5ICkge1xuXHRcdFx0XHRcdHNjcm9sbFBhcmVudC5zY3JvbGxMZWZ0ID0gc2Nyb2xsZWQgPSBzY3JvbGxQYXJlbnQuc2Nyb2xsTGVmdCArIG8uc2Nyb2xsU3BlZWQ7XG5cdFx0XHRcdH0gZWxzZSBpZiAoIGV2ZW50LnBhZ2VYIC0gaS5vdmVyZmxvd09mZnNldC5sZWZ0IDwgby5zY3JvbGxTZW5zaXRpdml0eSApIHtcblx0XHRcdFx0XHRzY3JvbGxQYXJlbnQuc2Nyb2xsTGVmdCA9IHNjcm9sbGVkID0gc2Nyb2xsUGFyZW50LnNjcm9sbExlZnQgLSBvLnNjcm9sbFNwZWVkO1xuXHRcdFx0XHR9XG5cdFx0XHR9XG5cblx0XHR9IGVsc2Uge1xuXG5cdFx0XHRpZiAoICFvLmF4aXMgfHwgby5heGlzICE9PSBcInhcIiApIHtcblx0XHRcdFx0aWYgKCBldmVudC5wYWdlWSAtICQoIGRvY3VtZW50ICkuc2Nyb2xsVG9wKCkgPCBvLnNjcm9sbFNlbnNpdGl2aXR5ICkge1xuXHRcdFx0XHRcdHNjcm9sbGVkID0gJCggZG9jdW1lbnQgKS5zY3JvbGxUb3AoICQoIGRvY3VtZW50ICkuc2Nyb2xsVG9wKCkgLSBvLnNjcm9sbFNwZWVkICk7XG5cdFx0XHRcdH0gZWxzZSBpZiAoICQoIHdpbmRvdyApLmhlaWdodCgpIC0gKCBldmVudC5wYWdlWSAtICQoIGRvY3VtZW50ICkuc2Nyb2xsVG9wKCkgKSA8XG5cdFx0XHRcdFx0XHRvLnNjcm9sbFNlbnNpdGl2aXR5ICkge1xuXHRcdFx0XHRcdHNjcm9sbGVkID0gJCggZG9jdW1lbnQgKS5zY3JvbGxUb3AoICQoIGRvY3VtZW50ICkuc2Nyb2xsVG9wKCkgKyBvLnNjcm9sbFNwZWVkICk7XG5cdFx0XHRcdH1cblx0XHRcdH1cblxuXHRcdFx0aWYgKCAhby5heGlzIHx8IG8uYXhpcyAhPT0gXCJ5XCIgKSB7XG5cdFx0XHRcdGlmICggZXZlbnQucGFnZVggLSAkKCBkb2N1bWVudCApLnNjcm9sbExlZnQoKSA8IG8uc2Nyb2xsU2Vuc2l0aXZpdHkgKSB7XG5cdFx0XHRcdFx0c2Nyb2xsZWQgPSAkKCBkb2N1bWVudCApLnNjcm9sbExlZnQoXG5cdFx0XHRcdFx0XHQkKCBkb2N1bWVudCApLnNjcm9sbExlZnQoKSAtIG8uc2Nyb2xsU3BlZWRcblx0XHRcdFx0XHQpO1xuXHRcdFx0XHR9IGVsc2UgaWYgKCAkKCB3aW5kb3cgKS53aWR0aCgpIC0gKCBldmVudC5wYWdlWCAtICQoIGRvY3VtZW50ICkuc2Nyb2xsTGVmdCgpICkgPFxuXHRcdFx0XHRcdFx0by5zY3JvbGxTZW5zaXRpdml0eSApIHtcblx0XHRcdFx0XHRzY3JvbGxlZCA9ICQoIGRvY3VtZW50ICkuc2Nyb2xsTGVmdChcblx0XHRcdFx0XHRcdCQoIGRvY3VtZW50ICkuc2Nyb2xsTGVmdCgpICsgby5zY3JvbGxTcGVlZFxuXHRcdFx0XHRcdCk7XG5cdFx0XHRcdH1cblx0XHRcdH1cblxuXHRcdH1cblxuXHRcdGlmICggc2Nyb2xsZWQgIT09IGZhbHNlICYmICQudWkuZGRtYW5hZ2VyICYmICFvLmRyb3BCZWhhdmlvdXIgKSB7XG5cdFx0XHQkLnVpLmRkbWFuYWdlci5wcmVwYXJlT2Zmc2V0cyggaSwgZXZlbnQgKTtcblx0XHR9XG5cblx0fVxufSApO1xuXG4kLnVpLnBsdWdpbi5hZGQoIFwiZHJhZ2dhYmxlXCIsIFwic25hcFwiLCB7XG5cdHN0YXJ0OiBmdW5jdGlvbiggZXZlbnQsIHVpLCBpICkge1xuXG5cdFx0dmFyIG8gPSBpLm9wdGlvbnM7XG5cblx0XHRpLnNuYXBFbGVtZW50cyA9IFtdO1xuXG5cdFx0JCggby5zbmFwLmNvbnN0cnVjdG9yICE9PSBTdHJpbmcgPyAoIG8uc25hcC5pdGVtcyB8fCBcIjpkYXRhKHVpLWRyYWdnYWJsZSlcIiApIDogby5zbmFwIClcblx0XHRcdC5lYWNoKCBmdW5jdGlvbigpIHtcblx0XHRcdFx0dmFyICR0ID0gJCggdGhpcyApLFxuXHRcdFx0XHRcdCRvID0gJHQub2Zmc2V0KCk7XG5cdFx0XHRcdGlmICggdGhpcyAhPT0gaS5lbGVtZW50WyAwIF0gKSB7XG5cdFx0XHRcdFx0aS5zbmFwRWxlbWVudHMucHVzaCgge1xuXHRcdFx0XHRcdFx0aXRlbTogdGhpcyxcblx0XHRcdFx0XHRcdHdpZHRoOiAkdC5vdXRlcldpZHRoKCksIGhlaWdodDogJHQub3V0ZXJIZWlnaHQoKSxcblx0XHRcdFx0XHRcdHRvcDogJG8udG9wLCBsZWZ0OiAkby5sZWZ0XG5cdFx0XHRcdFx0fSApO1xuXHRcdFx0XHR9XG5cdFx0XHR9ICk7XG5cblx0fSxcblx0ZHJhZzogZnVuY3Rpb24oIGV2ZW50LCB1aSwgaW5zdCApIHtcblxuXHRcdHZhciB0cywgYnMsIGxzLCBycywgbCwgciwgdCwgYiwgaSwgZmlyc3QsXG5cdFx0XHRvID0gaW5zdC5vcHRpb25zLFxuXHRcdFx0ZCA9IG8uc25hcFRvbGVyYW5jZSxcblx0XHRcdHgxID0gdWkub2Zmc2V0LmxlZnQsIHgyID0geDEgKyBpbnN0LmhlbHBlclByb3BvcnRpb25zLndpZHRoLFxuXHRcdFx0eTEgPSB1aS5vZmZzZXQudG9wLCB5MiA9IHkxICsgaW5zdC5oZWxwZXJQcm9wb3J0aW9ucy5oZWlnaHQ7XG5cblx0XHRmb3IgKCBpID0gaW5zdC5zbmFwRWxlbWVudHMubGVuZ3RoIC0gMTsgaSA+PSAwOyBpLS0gKSB7XG5cblx0XHRcdGwgPSBpbnN0LnNuYXBFbGVtZW50c1sgaSBdLmxlZnQgLSBpbnN0Lm1hcmdpbnMubGVmdDtcblx0XHRcdHIgPSBsICsgaW5zdC5zbmFwRWxlbWVudHNbIGkgXS53aWR0aDtcblx0XHRcdHQgPSBpbnN0LnNuYXBFbGVtZW50c1sgaSBdLnRvcCAtIGluc3QubWFyZ2lucy50b3A7XG5cdFx0XHRiID0gdCArIGluc3Quc25hcEVsZW1lbnRzWyBpIF0uaGVpZ2h0O1xuXG5cdFx0XHRpZiAoIHgyIDwgbCAtIGQgfHwgeDEgPiByICsgZCB8fCB5MiA8IHQgLSBkIHx8IHkxID4gYiArIGQgfHxcblx0XHRcdFx0XHQhJC5jb250YWlucyggaW5zdC5zbmFwRWxlbWVudHNbIGkgXS5pdGVtLm93bmVyRG9jdW1lbnQsXG5cdFx0XHRcdFx0aW5zdC5zbmFwRWxlbWVudHNbIGkgXS5pdGVtICkgKSB7XG5cdFx0XHRcdGlmICggaW5zdC5zbmFwRWxlbWVudHNbIGkgXS5zbmFwcGluZyApIHtcblx0XHRcdFx0XHQoIGluc3Qub3B0aW9ucy5zbmFwLnJlbGVhc2UgJiZcblx0XHRcdFx0XHRcdGluc3Qub3B0aW9ucy5zbmFwLnJlbGVhc2UuY2FsbChcblx0XHRcdFx0XHRcdFx0aW5zdC5lbGVtZW50LFxuXHRcdFx0XHRcdFx0XHRldmVudCxcblx0XHRcdFx0XHRcdFx0JC5leHRlbmQoIGluc3QuX3VpSGFzaCgpLCB7IHNuYXBJdGVtOiBpbnN0LnNuYXBFbGVtZW50c1sgaSBdLml0ZW0gfSApXG5cdFx0XHRcdFx0XHQpICk7XG5cdFx0XHRcdH1cblx0XHRcdFx0aW5zdC5zbmFwRWxlbWVudHNbIGkgXS5zbmFwcGluZyA9IGZhbHNlO1xuXHRcdFx0XHRjb250aW51ZTtcblx0XHRcdH1cblxuXHRcdFx0aWYgKCBvLnNuYXBNb2RlICE9PSBcImlubmVyXCIgKSB7XG5cdFx0XHRcdHRzID0gTWF0aC5hYnMoIHQgLSB5MiApIDw9IGQ7XG5cdFx0XHRcdGJzID0gTWF0aC5hYnMoIGIgLSB5MSApIDw9IGQ7XG5cdFx0XHRcdGxzID0gTWF0aC5hYnMoIGwgLSB4MiApIDw9IGQ7XG5cdFx0XHRcdHJzID0gTWF0aC5hYnMoIHIgLSB4MSApIDw9IGQ7XG5cdFx0XHRcdGlmICggdHMgKSB7XG5cdFx0XHRcdFx0dWkucG9zaXRpb24udG9wID0gaW5zdC5fY29udmVydFBvc2l0aW9uVG8oIFwicmVsYXRpdmVcIiwge1xuXHRcdFx0XHRcdFx0dG9wOiB0IC0gaW5zdC5oZWxwZXJQcm9wb3J0aW9ucy5oZWlnaHQsXG5cdFx0XHRcdFx0XHRsZWZ0OiAwXG5cdFx0XHRcdFx0fSApLnRvcDtcblx0XHRcdFx0fVxuXHRcdFx0XHRpZiAoIGJzICkge1xuXHRcdFx0XHRcdHVpLnBvc2l0aW9uLnRvcCA9IGluc3QuX2NvbnZlcnRQb3NpdGlvblRvKCBcInJlbGF0aXZlXCIsIHtcblx0XHRcdFx0XHRcdHRvcDogYixcblx0XHRcdFx0XHRcdGxlZnQ6IDBcblx0XHRcdFx0XHR9ICkudG9wO1xuXHRcdFx0XHR9XG5cdFx0XHRcdGlmICggbHMgKSB7XG5cdFx0XHRcdFx0dWkucG9zaXRpb24ubGVmdCA9IGluc3QuX2NvbnZlcnRQb3NpdGlvblRvKCBcInJlbGF0aXZlXCIsIHtcblx0XHRcdFx0XHRcdHRvcDogMCxcblx0XHRcdFx0XHRcdGxlZnQ6IGwgLSBpbnN0LmhlbHBlclByb3BvcnRpb25zLndpZHRoXG5cdFx0XHRcdFx0fSApLmxlZnQ7XG5cdFx0XHRcdH1cblx0XHRcdFx0aWYgKCBycyApIHtcblx0XHRcdFx0XHR1aS5wb3NpdGlvbi5sZWZ0ID0gaW5zdC5fY29udmVydFBvc2l0aW9uVG8oIFwicmVsYXRpdmVcIiwge1xuXHRcdFx0XHRcdFx0dG9wOiAwLFxuXHRcdFx0XHRcdFx0bGVmdDogclxuXHRcdFx0XHRcdH0gKS5sZWZ0O1xuXHRcdFx0XHR9XG5cdFx0XHR9XG5cblx0XHRcdGZpcnN0ID0gKCB0cyB8fCBicyB8fCBscyB8fCBycyApO1xuXG5cdFx0XHRpZiAoIG8uc25hcE1vZGUgIT09IFwib3V0ZXJcIiApIHtcblx0XHRcdFx0dHMgPSBNYXRoLmFicyggdCAtIHkxICkgPD0gZDtcblx0XHRcdFx0YnMgPSBNYXRoLmFicyggYiAtIHkyICkgPD0gZDtcblx0XHRcdFx0bHMgPSBNYXRoLmFicyggbCAtIHgxICkgPD0gZDtcblx0XHRcdFx0cnMgPSBNYXRoLmFicyggciAtIHgyICkgPD0gZDtcblx0XHRcdFx0aWYgKCB0cyApIHtcblx0XHRcdFx0XHR1aS5wb3NpdGlvbi50b3AgPSBpbnN0Ll9jb252ZXJ0UG9zaXRpb25UbyggXCJyZWxhdGl2ZVwiLCB7XG5cdFx0XHRcdFx0XHR0b3A6IHQsXG5cdFx0XHRcdFx0XHRsZWZ0OiAwXG5cdFx0XHRcdFx0fSApLnRvcDtcblx0XHRcdFx0fVxuXHRcdFx0XHRpZiAoIGJzICkge1xuXHRcdFx0XHRcdHVpLnBvc2l0aW9uLnRvcCA9IGluc3QuX2NvbnZlcnRQb3NpdGlvblRvKCBcInJlbGF0aXZlXCIsIHtcblx0XHRcdFx0XHRcdHRvcDogYiAtIGluc3QuaGVscGVyUHJvcG9ydGlvbnMuaGVpZ2h0LFxuXHRcdFx0XHRcdFx0bGVmdDogMFxuXHRcdFx0XHRcdH0gKS50b3A7XG5cdFx0XHRcdH1cblx0XHRcdFx0aWYgKCBscyApIHtcblx0XHRcdFx0XHR1aS5wb3NpdGlvbi5sZWZ0ID0gaW5zdC5fY29udmVydFBvc2l0aW9uVG8oIFwicmVsYXRpdmVcIiwge1xuXHRcdFx0XHRcdFx0dG9wOiAwLFxuXHRcdFx0XHRcdFx0bGVmdDogbFxuXHRcdFx0XHRcdH0gKS5sZWZ0O1xuXHRcdFx0XHR9XG5cdFx0XHRcdGlmICggcnMgKSB7XG5cdFx0XHRcdFx0dWkucG9zaXRpb24ubGVmdCA9IGluc3QuX2NvbnZlcnRQb3NpdGlvblRvKCBcInJlbGF0aXZlXCIsIHtcblx0XHRcdFx0XHRcdHRvcDogMCxcblx0XHRcdFx0XHRcdGxlZnQ6IHIgLSBpbnN0LmhlbHBlclByb3BvcnRpb25zLndpZHRoXG5cdFx0XHRcdFx0fSApLmxlZnQ7XG5cdFx0XHRcdH1cblx0XHRcdH1cblxuXHRcdFx0aWYgKCAhaW5zdC5zbmFwRWxlbWVudHNbIGkgXS5zbmFwcGluZyAmJiAoIHRzIHx8IGJzIHx8IGxzIHx8IHJzIHx8IGZpcnN0ICkgKSB7XG5cdFx0XHRcdCggaW5zdC5vcHRpb25zLnNuYXAuc25hcCAmJlxuXHRcdFx0XHRcdGluc3Qub3B0aW9ucy5zbmFwLnNuYXAuY2FsbChcblx0XHRcdFx0XHRcdGluc3QuZWxlbWVudCxcblx0XHRcdFx0XHRcdGV2ZW50LFxuXHRcdFx0XHRcdFx0JC5leHRlbmQoIGluc3QuX3VpSGFzaCgpLCB7XG5cdFx0XHRcdFx0XHRcdHNuYXBJdGVtOiBpbnN0LnNuYXBFbGVtZW50c1sgaSBdLml0ZW1cblx0XHRcdFx0XHRcdH0gKSApICk7XG5cdFx0XHR9XG5cdFx0XHRpbnN0LnNuYXBFbGVtZW50c1sgaSBdLnNuYXBwaW5nID0gKCB0cyB8fCBicyB8fCBscyB8fCBycyB8fCBmaXJzdCApO1xuXG5cdFx0fVxuXG5cdH1cbn0gKTtcblxuJC51aS5wbHVnaW4uYWRkKCBcImRyYWdnYWJsZVwiLCBcInN0YWNrXCIsIHtcblx0c3RhcnQ6IGZ1bmN0aW9uKCBldmVudCwgdWksIGluc3RhbmNlICkge1xuXHRcdHZhciBtaW4sXG5cdFx0XHRvID0gaW5zdGFuY2Uub3B0aW9ucyxcblx0XHRcdGdyb3VwID0gJC5tYWtlQXJyYXkoICQoIG8uc3RhY2sgKSApLnNvcnQoIGZ1bmN0aW9uKCBhLCBiICkge1xuXHRcdFx0XHRyZXR1cm4gKCBwYXJzZUludCggJCggYSApLmNzcyggXCJ6SW5kZXhcIiApLCAxMCApIHx8IDAgKSAtXG5cdFx0XHRcdFx0KCBwYXJzZUludCggJCggYiApLmNzcyggXCJ6SW5kZXhcIiApLCAxMCApIHx8IDAgKTtcblx0XHRcdH0gKTtcblxuXHRcdGlmICggIWdyb3VwLmxlbmd0aCApIHsgcmV0dXJuOyB9XG5cblx0XHRtaW4gPSBwYXJzZUludCggJCggZ3JvdXBbIDAgXSApLmNzcyggXCJ6SW5kZXhcIiApLCAxMCApIHx8IDA7XG5cdFx0JCggZ3JvdXAgKS5lYWNoKCBmdW5jdGlvbiggaSApIHtcblx0XHRcdCQoIHRoaXMgKS5jc3MoIFwiekluZGV4XCIsIG1pbiArIGkgKTtcblx0XHR9ICk7XG5cdFx0dGhpcy5jc3MoIFwiekluZGV4XCIsICggbWluICsgZ3JvdXAubGVuZ3RoICkgKTtcblx0fVxufSApO1xuXG4kLnVpLnBsdWdpbi5hZGQoIFwiZHJhZ2dhYmxlXCIsIFwiekluZGV4XCIsIHtcblx0c3RhcnQ6IGZ1bmN0aW9uKCBldmVudCwgdWksIGluc3RhbmNlICkge1xuXHRcdHZhciB0ID0gJCggdWkuaGVscGVyICksXG5cdFx0XHRvID0gaW5zdGFuY2Uub3B0aW9ucztcblxuXHRcdGlmICggdC5jc3MoIFwiekluZGV4XCIgKSApIHtcblx0XHRcdG8uX3pJbmRleCA9IHQuY3NzKCBcInpJbmRleFwiICk7XG5cdFx0fVxuXHRcdHQuY3NzKCBcInpJbmRleFwiLCBvLnpJbmRleCApO1xuXHR9LFxuXHRzdG9wOiBmdW5jdGlvbiggZXZlbnQsIHVpLCBpbnN0YW5jZSApIHtcblx0XHR2YXIgbyA9IGluc3RhbmNlLm9wdGlvbnM7XG5cblx0XHRpZiAoIG8uX3pJbmRleCApIHtcblx0XHRcdCQoIHVpLmhlbHBlciApLmNzcyggXCJ6SW5kZXhcIiwgby5fekluZGV4ICk7XG5cdFx0fVxuXHR9XG59ICk7XG5cbnJldHVybiAkLnVpLmRyYWdnYWJsZTtcblxufSApICk7XG4iLCIvKiFcbiAqIGpRdWVyeSBVSSBNZW51IDEuMTIuMVxuICogaHR0cDovL2pxdWVyeXVpLmNvbVxuICpcbiAqIENvcHlyaWdodCBqUXVlcnkgRm91bmRhdGlvbiBhbmQgb3RoZXIgY29udHJpYnV0b3JzXG4gKiBSZWxlYXNlZCB1bmRlciB0aGUgTUlUIGxpY2Vuc2UuXG4gKiBodHRwOi8vanF1ZXJ5Lm9yZy9saWNlbnNlXG4gKi9cblxuLy8+PmxhYmVsOiBNZW51XG4vLz4+Z3JvdXA6IFdpZGdldHNcbi8vPj5kZXNjcmlwdGlvbjogQ3JlYXRlcyBuZXN0YWJsZSBtZW51cy5cbi8vPj5kb2NzOiBodHRwOi8vYXBpLmpxdWVyeXVpLmNvbS9tZW51L1xuLy8+PmRlbW9zOiBodHRwOi8vanF1ZXJ5dWkuY29tL21lbnUvXG4vLz4+Y3NzLnN0cnVjdHVyZTogLi4vLi4vdGhlbWVzL2Jhc2UvY29yZS5jc3Ncbi8vPj5jc3Muc3RydWN0dXJlOiAuLi8uLi90aGVtZXMvYmFzZS9tZW51LmNzc1xuLy8+PmNzcy50aGVtZTogLi4vLi4vdGhlbWVzL2Jhc2UvdGhlbWUuY3NzXG5cbiggZnVuY3Rpb24oIGZhY3RvcnkgKSB7XG5cdGlmICggdHlwZW9mIGRlZmluZSA9PT0gXCJmdW5jdGlvblwiICYmIGRlZmluZS5hbWQgKSB7XG5cblx0XHQvLyBBTUQuIFJlZ2lzdGVyIGFzIGFuIGFub255bW91cyBtb2R1bGUuXG5cdFx0ZGVmaW5lKCBbXG5cdFx0XHRcImpxdWVyeVwiLFxuXHRcdFx0XCIuLi9rZXljb2RlXCIsXG5cdFx0XHRcIi4uL3Bvc2l0aW9uXCIsXG5cdFx0XHRcIi4uL3NhZmUtYWN0aXZlLWVsZW1lbnRcIixcblx0XHRcdFwiLi4vdW5pcXVlLWlkXCIsXG5cdFx0XHRcIi4uL3ZlcnNpb25cIixcblx0XHRcdFwiLi4vd2lkZ2V0XCJcblx0XHRdLCBmYWN0b3J5ICk7XG5cdH0gZWxzZSB7XG5cblx0XHQvLyBCcm93c2VyIGdsb2JhbHNcblx0XHRmYWN0b3J5KCBqUXVlcnkgKTtcblx0fVxufSggZnVuY3Rpb24oICQgKSB7XG5cbnJldHVybiAkLndpZGdldCggXCJ1aS5tZW51XCIsIHtcblx0dmVyc2lvbjogXCIxLjEyLjFcIixcblx0ZGVmYXVsdEVsZW1lbnQ6IFwiPHVsPlwiLFxuXHRkZWxheTogMzAwLFxuXHRvcHRpb25zOiB7XG5cdFx0aWNvbnM6IHtcblx0XHRcdHN1Ym1lbnU6IFwidWktaWNvbi1jYXJldC0xLWVcIlxuXHRcdH0sXG5cdFx0aXRlbXM6IFwiPiAqXCIsXG5cdFx0bWVudXM6IFwidWxcIixcblx0XHRwb3NpdGlvbjoge1xuXHRcdFx0bXk6IFwibGVmdCB0b3BcIixcblx0XHRcdGF0OiBcInJpZ2h0IHRvcFwiXG5cdFx0fSxcblx0XHRyb2xlOiBcIm1lbnVcIixcblxuXHRcdC8vIENhbGxiYWNrc1xuXHRcdGJsdXI6IG51bGwsXG5cdFx0Zm9jdXM6IG51bGwsXG5cdFx0c2VsZWN0OiBudWxsXG5cdH0sXG5cblx0X2NyZWF0ZTogZnVuY3Rpb24oKSB7XG5cdFx0dGhpcy5hY3RpdmVNZW51ID0gdGhpcy5lbGVtZW50O1xuXG5cdFx0Ly8gRmxhZyB1c2VkIHRvIHByZXZlbnQgZmlyaW5nIG9mIHRoZSBjbGljayBoYW5kbGVyXG5cdFx0Ly8gYXMgdGhlIGV2ZW50IGJ1YmJsZXMgdXAgdGhyb3VnaCBuZXN0ZWQgbWVudXNcblx0XHR0aGlzLm1vdXNlSGFuZGxlZCA9IGZhbHNlO1xuXHRcdHRoaXMuZWxlbWVudFxuXHRcdFx0LnVuaXF1ZUlkKClcblx0XHRcdC5hdHRyKCB7XG5cdFx0XHRcdHJvbGU6IHRoaXMub3B0aW9ucy5yb2xlLFxuXHRcdFx0XHR0YWJJbmRleDogMFxuXHRcdFx0fSApO1xuXG5cdFx0dGhpcy5fYWRkQ2xhc3MoIFwidWktbWVudVwiLCBcInVpLXdpZGdldCB1aS13aWRnZXQtY29udGVudFwiICk7XG5cdFx0dGhpcy5fb24oIHtcblxuXHRcdFx0Ly8gUHJldmVudCBmb2N1cyBmcm9tIHN0aWNraW5nIHRvIGxpbmtzIGluc2lkZSBtZW51IGFmdGVyIGNsaWNraW5nXG5cdFx0XHQvLyB0aGVtIChmb2N1cyBzaG91bGQgYWx3YXlzIHN0YXkgb24gVUwgZHVyaW5nIG5hdmlnYXRpb24pLlxuXHRcdFx0XCJtb3VzZWRvd24gLnVpLW1lbnUtaXRlbVwiOiBmdW5jdGlvbiggZXZlbnQgKSB7XG5cdFx0XHRcdGV2ZW50LnByZXZlbnREZWZhdWx0KCk7XG5cdFx0XHR9LFxuXHRcdFx0XCJjbGljayAudWktbWVudS1pdGVtXCI6IGZ1bmN0aW9uKCBldmVudCApIHtcblx0XHRcdFx0dmFyIHRhcmdldCA9ICQoIGV2ZW50LnRhcmdldCApO1xuXHRcdFx0XHR2YXIgYWN0aXZlID0gJCggJC51aS5zYWZlQWN0aXZlRWxlbWVudCggdGhpcy5kb2N1bWVudFsgMCBdICkgKTtcblx0XHRcdFx0aWYgKCAhdGhpcy5tb3VzZUhhbmRsZWQgJiYgdGFyZ2V0Lm5vdCggXCIudWktc3RhdGUtZGlzYWJsZWRcIiApLmxlbmd0aCApIHtcblx0XHRcdFx0XHR0aGlzLnNlbGVjdCggZXZlbnQgKTtcblxuXHRcdFx0XHRcdC8vIE9ubHkgc2V0IHRoZSBtb3VzZUhhbmRsZWQgZmxhZyBpZiB0aGUgZXZlbnQgd2lsbCBidWJibGUsIHNlZSAjOTQ2OS5cblx0XHRcdFx0XHRpZiAoICFldmVudC5pc1Byb3BhZ2F0aW9uU3RvcHBlZCgpICkge1xuXHRcdFx0XHRcdFx0dGhpcy5tb3VzZUhhbmRsZWQgPSB0cnVlO1xuXHRcdFx0XHRcdH1cblxuXHRcdFx0XHRcdC8vIE9wZW4gc3VibWVudSBvbiBjbGlja1xuXHRcdFx0XHRcdGlmICggdGFyZ2V0LmhhcyggXCIudWktbWVudVwiICkubGVuZ3RoICkge1xuXHRcdFx0XHRcdFx0dGhpcy5leHBhbmQoIGV2ZW50ICk7XG5cdFx0XHRcdFx0fSBlbHNlIGlmICggIXRoaXMuZWxlbWVudC5pcyggXCI6Zm9jdXNcIiApICYmXG5cdFx0XHRcdFx0XHRcdGFjdGl2ZS5jbG9zZXN0KCBcIi51aS1tZW51XCIgKS5sZW5ndGggKSB7XG5cblx0XHRcdFx0XHRcdC8vIFJlZGlyZWN0IGZvY3VzIHRvIHRoZSBtZW51XG5cdFx0XHRcdFx0XHR0aGlzLmVsZW1lbnQudHJpZ2dlciggXCJmb2N1c1wiLCBbIHRydWUgXSApO1xuXG5cdFx0XHRcdFx0XHQvLyBJZiB0aGUgYWN0aXZlIGl0ZW0gaXMgb24gdGhlIHRvcCBsZXZlbCwgbGV0IGl0IHN0YXkgYWN0aXZlLlxuXHRcdFx0XHRcdFx0Ly8gT3RoZXJ3aXNlLCBibHVyIHRoZSBhY3RpdmUgaXRlbSBzaW5jZSBpdCBpcyBubyBsb25nZXIgdmlzaWJsZS5cblx0XHRcdFx0XHRcdGlmICggdGhpcy5hY3RpdmUgJiYgdGhpcy5hY3RpdmUucGFyZW50cyggXCIudWktbWVudVwiICkubGVuZ3RoID09PSAxICkge1xuXHRcdFx0XHRcdFx0XHRjbGVhclRpbWVvdXQoIHRoaXMudGltZXIgKTtcblx0XHRcdFx0XHRcdH1cblx0XHRcdFx0XHR9XG5cdFx0XHRcdH1cblx0XHRcdH0sXG5cdFx0XHRcIm1vdXNlZW50ZXIgLnVpLW1lbnUtaXRlbVwiOiBmdW5jdGlvbiggZXZlbnQgKSB7XG5cblx0XHRcdFx0Ly8gSWdub3JlIG1vdXNlIGV2ZW50cyB3aGlsZSB0eXBlYWhlYWQgaXMgYWN0aXZlLCBzZWUgIzEwNDU4LlxuXHRcdFx0XHQvLyBQcmV2ZW50cyBmb2N1c2luZyB0aGUgd3JvbmcgaXRlbSB3aGVuIHR5cGVhaGVhZCBjYXVzZXMgYSBzY3JvbGwgd2hpbGUgdGhlIG1vdXNlXG5cdFx0XHRcdC8vIGlzIG92ZXIgYW4gaXRlbSBpbiB0aGUgbWVudVxuXHRcdFx0XHRpZiAoIHRoaXMucHJldmlvdXNGaWx0ZXIgKSB7XG5cdFx0XHRcdFx0cmV0dXJuO1xuXHRcdFx0XHR9XG5cblx0XHRcdFx0dmFyIGFjdHVhbFRhcmdldCA9ICQoIGV2ZW50LnRhcmdldCApLmNsb3Nlc3QoIFwiLnVpLW1lbnUtaXRlbVwiICksXG5cdFx0XHRcdFx0dGFyZ2V0ID0gJCggZXZlbnQuY3VycmVudFRhcmdldCApO1xuXG5cdFx0XHRcdC8vIElnbm9yZSBidWJibGVkIGV2ZW50cyBvbiBwYXJlbnQgaXRlbXMsIHNlZSAjMTE2NDFcblx0XHRcdFx0aWYgKCBhY3R1YWxUYXJnZXRbIDAgXSAhPT0gdGFyZ2V0WyAwIF0gKSB7XG5cdFx0XHRcdFx0cmV0dXJuO1xuXHRcdFx0XHR9XG5cblx0XHRcdFx0Ly8gUmVtb3ZlIHVpLXN0YXRlLWFjdGl2ZSBjbGFzcyBmcm9tIHNpYmxpbmdzIG9mIHRoZSBuZXdseSBmb2N1c2VkIG1lbnUgaXRlbVxuXHRcdFx0XHQvLyB0byBhdm9pZCBhIGp1bXAgY2F1c2VkIGJ5IGFkamFjZW50IGVsZW1lbnRzIGJvdGggaGF2aW5nIGEgY2xhc3Mgd2l0aCBhIGJvcmRlclxuXHRcdFx0XHR0aGlzLl9yZW1vdmVDbGFzcyggdGFyZ2V0LnNpYmxpbmdzKCkuY2hpbGRyZW4oIFwiLnVpLXN0YXRlLWFjdGl2ZVwiICksXG5cdFx0XHRcdFx0bnVsbCwgXCJ1aS1zdGF0ZS1hY3RpdmVcIiApO1xuXHRcdFx0XHR0aGlzLmZvY3VzKCBldmVudCwgdGFyZ2V0ICk7XG5cdFx0XHR9LFxuXHRcdFx0bW91c2VsZWF2ZTogXCJjb2xsYXBzZUFsbFwiLFxuXHRcdFx0XCJtb3VzZWxlYXZlIC51aS1tZW51XCI6IFwiY29sbGFwc2VBbGxcIixcblx0XHRcdGZvY3VzOiBmdW5jdGlvbiggZXZlbnQsIGtlZXBBY3RpdmVJdGVtICkge1xuXG5cdFx0XHRcdC8vIElmIHRoZXJlJ3MgYWxyZWFkeSBhbiBhY3RpdmUgaXRlbSwga2VlcCBpdCBhY3RpdmVcblx0XHRcdFx0Ly8gSWYgbm90LCBhY3RpdmF0ZSB0aGUgZmlyc3QgaXRlbVxuXHRcdFx0XHR2YXIgaXRlbSA9IHRoaXMuYWN0aXZlIHx8IHRoaXMuZWxlbWVudC5maW5kKCB0aGlzLm9wdGlvbnMuaXRlbXMgKS5lcSggMCApO1xuXG5cdFx0XHRcdGlmICggIWtlZXBBY3RpdmVJdGVtICkge1xuXHRcdFx0XHRcdHRoaXMuZm9jdXMoIGV2ZW50LCBpdGVtICk7XG5cdFx0XHRcdH1cblx0XHRcdH0sXG5cdFx0XHRibHVyOiBmdW5jdGlvbiggZXZlbnQgKSB7XG5cdFx0XHRcdHRoaXMuX2RlbGF5KCBmdW5jdGlvbigpIHtcblx0XHRcdFx0XHR2YXIgbm90Q29udGFpbmVkID0gISQuY29udGFpbnMoXG5cdFx0XHRcdFx0XHR0aGlzLmVsZW1lbnRbIDAgXSxcblx0XHRcdFx0XHRcdCQudWkuc2FmZUFjdGl2ZUVsZW1lbnQoIHRoaXMuZG9jdW1lbnRbIDAgXSApXG5cdFx0XHRcdFx0KTtcblx0XHRcdFx0XHRpZiAoIG5vdENvbnRhaW5lZCApIHtcblx0XHRcdFx0XHRcdHRoaXMuY29sbGFwc2VBbGwoIGV2ZW50ICk7XG5cdFx0XHRcdFx0fVxuXHRcdFx0XHR9ICk7XG5cdFx0XHR9LFxuXHRcdFx0a2V5ZG93bjogXCJfa2V5ZG93blwiXG5cdFx0fSApO1xuXG5cdFx0dGhpcy5yZWZyZXNoKCk7XG5cblx0XHQvLyBDbGlja3Mgb3V0c2lkZSBvZiBhIG1lbnUgY29sbGFwc2UgYW55IG9wZW4gbWVudXNcblx0XHR0aGlzLl9vbiggdGhpcy5kb2N1bWVudCwge1xuXHRcdFx0Y2xpY2s6IGZ1bmN0aW9uKCBldmVudCApIHtcblx0XHRcdFx0aWYgKCB0aGlzLl9jbG9zZU9uRG9jdW1lbnRDbGljayggZXZlbnQgKSApIHtcblx0XHRcdFx0XHR0aGlzLmNvbGxhcHNlQWxsKCBldmVudCApO1xuXHRcdFx0XHR9XG5cblx0XHRcdFx0Ly8gUmVzZXQgdGhlIG1vdXNlSGFuZGxlZCBmbGFnXG5cdFx0XHRcdHRoaXMubW91c2VIYW5kbGVkID0gZmFsc2U7XG5cdFx0XHR9XG5cdFx0fSApO1xuXHR9LFxuXG5cdF9kZXN0cm95OiBmdW5jdGlvbigpIHtcblx0XHR2YXIgaXRlbXMgPSB0aGlzLmVsZW1lbnQuZmluZCggXCIudWktbWVudS1pdGVtXCIgKVxuXHRcdFx0XHQucmVtb3ZlQXR0ciggXCJyb2xlIGFyaWEtZGlzYWJsZWRcIiApLFxuXHRcdFx0c3VibWVudXMgPSBpdGVtcy5jaGlsZHJlbiggXCIudWktbWVudS1pdGVtLXdyYXBwZXJcIiApXG5cdFx0XHRcdC5yZW1vdmVVbmlxdWVJZCgpXG5cdFx0XHRcdC5yZW1vdmVBdHRyKCBcInRhYkluZGV4IHJvbGUgYXJpYS1oYXNwb3B1cFwiICk7XG5cblx0XHQvLyBEZXN0cm95IChzdWIpbWVudXNcblx0XHR0aGlzLmVsZW1lbnRcblx0XHRcdC5yZW1vdmVBdHRyKCBcImFyaWEtYWN0aXZlZGVzY2VuZGFudFwiIClcblx0XHRcdC5maW5kKCBcIi51aS1tZW51XCIgKS5hZGRCYWNrKClcblx0XHRcdFx0LnJlbW92ZUF0dHIoIFwicm9sZSBhcmlhLWxhYmVsbGVkYnkgYXJpYS1leHBhbmRlZCBhcmlhLWhpZGRlbiBhcmlhLWRpc2FibGVkIFwiICtcblx0XHRcdFx0XHRcInRhYkluZGV4XCIgKVxuXHRcdFx0XHQucmVtb3ZlVW5pcXVlSWQoKVxuXHRcdFx0XHQuc2hvdygpO1xuXG5cdFx0c3VibWVudXMuY2hpbGRyZW4oKS5lYWNoKCBmdW5jdGlvbigpIHtcblx0XHRcdHZhciBlbGVtID0gJCggdGhpcyApO1xuXHRcdFx0aWYgKCBlbGVtLmRhdGEoIFwidWktbWVudS1zdWJtZW51LWNhcmV0XCIgKSApIHtcblx0XHRcdFx0ZWxlbS5yZW1vdmUoKTtcblx0XHRcdH1cblx0XHR9ICk7XG5cdH0sXG5cblx0X2tleWRvd246IGZ1bmN0aW9uKCBldmVudCApIHtcblx0XHR2YXIgbWF0Y2gsIHByZXYsIGNoYXJhY3Rlciwgc2tpcCxcblx0XHRcdHByZXZlbnREZWZhdWx0ID0gdHJ1ZTtcblxuXHRcdHN3aXRjaCAoIGV2ZW50LmtleUNvZGUgKSB7XG5cdFx0Y2FzZSAkLnVpLmtleUNvZGUuUEFHRV9VUDpcblx0XHRcdHRoaXMucHJldmlvdXNQYWdlKCBldmVudCApO1xuXHRcdFx0YnJlYWs7XG5cdFx0Y2FzZSAkLnVpLmtleUNvZGUuUEFHRV9ET1dOOlxuXHRcdFx0dGhpcy5uZXh0UGFnZSggZXZlbnQgKTtcblx0XHRcdGJyZWFrO1xuXHRcdGNhc2UgJC51aS5rZXlDb2RlLkhPTUU6XG5cdFx0XHR0aGlzLl9tb3ZlKCBcImZpcnN0XCIsIFwiZmlyc3RcIiwgZXZlbnQgKTtcblx0XHRcdGJyZWFrO1xuXHRcdGNhc2UgJC51aS5rZXlDb2RlLkVORDpcblx0XHRcdHRoaXMuX21vdmUoIFwibGFzdFwiLCBcImxhc3RcIiwgZXZlbnQgKTtcblx0XHRcdGJyZWFrO1xuXHRcdGNhc2UgJC51aS5rZXlDb2RlLlVQOlxuXHRcdFx0dGhpcy5wcmV2aW91cyggZXZlbnQgKTtcblx0XHRcdGJyZWFrO1xuXHRcdGNhc2UgJC51aS5rZXlDb2RlLkRPV046XG5cdFx0XHR0aGlzLm5leHQoIGV2ZW50ICk7XG5cdFx0XHRicmVhaztcblx0XHRjYXNlICQudWkua2V5Q29kZS5MRUZUOlxuXHRcdFx0dGhpcy5jb2xsYXBzZSggZXZlbnQgKTtcblx0XHRcdGJyZWFrO1xuXHRcdGNhc2UgJC51aS5rZXlDb2RlLlJJR0hUOlxuXHRcdFx0aWYgKCB0aGlzLmFjdGl2ZSAmJiAhdGhpcy5hY3RpdmUuaXMoIFwiLnVpLXN0YXRlLWRpc2FibGVkXCIgKSApIHtcblx0XHRcdFx0dGhpcy5leHBhbmQoIGV2ZW50ICk7XG5cdFx0XHR9XG5cdFx0XHRicmVhaztcblx0XHRjYXNlICQudWkua2V5Q29kZS5FTlRFUjpcblx0XHRjYXNlICQudWkua2V5Q29kZS5TUEFDRTpcblx0XHRcdHRoaXMuX2FjdGl2YXRlKCBldmVudCApO1xuXHRcdFx0YnJlYWs7XG5cdFx0Y2FzZSAkLnVpLmtleUNvZGUuRVNDQVBFOlxuXHRcdFx0dGhpcy5jb2xsYXBzZSggZXZlbnQgKTtcblx0XHRcdGJyZWFrO1xuXHRcdGRlZmF1bHQ6XG5cdFx0XHRwcmV2ZW50RGVmYXVsdCA9IGZhbHNlO1xuXHRcdFx0cHJldiA9IHRoaXMucHJldmlvdXNGaWx0ZXIgfHwgXCJcIjtcblx0XHRcdHNraXAgPSBmYWxzZTtcblxuXHRcdFx0Ly8gU3VwcG9ydCBudW1iZXIgcGFkIHZhbHVlc1xuXHRcdFx0Y2hhcmFjdGVyID0gZXZlbnQua2V5Q29kZSA+PSA5NiAmJiBldmVudC5rZXlDb2RlIDw9IDEwNSA/XG5cdFx0XHRcdCggZXZlbnQua2V5Q29kZSAtIDk2ICkudG9TdHJpbmcoKSA6IFN0cmluZy5mcm9tQ2hhckNvZGUoIGV2ZW50LmtleUNvZGUgKTtcblxuXHRcdFx0Y2xlYXJUaW1lb3V0KCB0aGlzLmZpbHRlclRpbWVyICk7XG5cblx0XHRcdGlmICggY2hhcmFjdGVyID09PSBwcmV2ICkge1xuXHRcdFx0XHRza2lwID0gdHJ1ZTtcblx0XHRcdH0gZWxzZSB7XG5cdFx0XHRcdGNoYXJhY3RlciA9IHByZXYgKyBjaGFyYWN0ZXI7XG5cdFx0XHR9XG5cblx0XHRcdG1hdGNoID0gdGhpcy5fZmlsdGVyTWVudUl0ZW1zKCBjaGFyYWN0ZXIgKTtcblx0XHRcdG1hdGNoID0gc2tpcCAmJiBtYXRjaC5pbmRleCggdGhpcy5hY3RpdmUubmV4dCgpICkgIT09IC0xID9cblx0XHRcdFx0dGhpcy5hY3RpdmUubmV4dEFsbCggXCIudWktbWVudS1pdGVtXCIgKSA6XG5cdFx0XHRcdG1hdGNoO1xuXG5cdFx0XHQvLyBJZiBubyBtYXRjaGVzIG9uIHRoZSBjdXJyZW50IGZpbHRlciwgcmVzZXQgdG8gdGhlIGxhc3QgY2hhcmFjdGVyIHByZXNzZWRcblx0XHRcdC8vIHRvIG1vdmUgZG93biB0aGUgbWVudSB0byB0aGUgZmlyc3QgaXRlbSB0aGF0IHN0YXJ0cyB3aXRoIHRoYXQgY2hhcmFjdGVyXG5cdFx0XHRpZiAoICFtYXRjaC5sZW5ndGggKSB7XG5cdFx0XHRcdGNoYXJhY3RlciA9IFN0cmluZy5mcm9tQ2hhckNvZGUoIGV2ZW50LmtleUNvZGUgKTtcblx0XHRcdFx0bWF0Y2ggPSB0aGlzLl9maWx0ZXJNZW51SXRlbXMoIGNoYXJhY3RlciApO1xuXHRcdFx0fVxuXG5cdFx0XHRpZiAoIG1hdGNoLmxlbmd0aCApIHtcblx0XHRcdFx0dGhpcy5mb2N1cyggZXZlbnQsIG1hdGNoICk7XG5cdFx0XHRcdHRoaXMucHJldmlvdXNGaWx0ZXIgPSBjaGFyYWN0ZXI7XG5cdFx0XHRcdHRoaXMuZmlsdGVyVGltZXIgPSB0aGlzLl9kZWxheSggZnVuY3Rpb24oKSB7XG5cdFx0XHRcdFx0ZGVsZXRlIHRoaXMucHJldmlvdXNGaWx0ZXI7XG5cdFx0XHRcdH0sIDEwMDAgKTtcblx0XHRcdH0gZWxzZSB7XG5cdFx0XHRcdGRlbGV0ZSB0aGlzLnByZXZpb3VzRmlsdGVyO1xuXHRcdFx0fVxuXHRcdH1cblxuXHRcdGlmICggcHJldmVudERlZmF1bHQgKSB7XG5cdFx0XHRldmVudC5wcmV2ZW50RGVmYXVsdCgpO1xuXHRcdH1cblx0fSxcblxuXHRfYWN0aXZhdGU6IGZ1bmN0aW9uKCBldmVudCApIHtcblx0XHRpZiAoIHRoaXMuYWN0aXZlICYmICF0aGlzLmFjdGl2ZS5pcyggXCIudWktc3RhdGUtZGlzYWJsZWRcIiApICkge1xuXHRcdFx0aWYgKCB0aGlzLmFjdGl2ZS5jaGlsZHJlbiggXCJbYXJpYS1oYXNwb3B1cD0ndHJ1ZSddXCIgKS5sZW5ndGggKSB7XG5cdFx0XHRcdHRoaXMuZXhwYW5kKCBldmVudCApO1xuXHRcdFx0fSBlbHNlIHtcblx0XHRcdFx0dGhpcy5zZWxlY3QoIGV2ZW50ICk7XG5cdFx0XHR9XG5cdFx0fVxuXHR9LFxuXG5cdHJlZnJlc2g6IGZ1bmN0aW9uKCkge1xuXHRcdHZhciBtZW51cywgaXRlbXMsIG5ld1N1Ym1lbnVzLCBuZXdJdGVtcywgbmV3V3JhcHBlcnMsXG5cdFx0XHR0aGF0ID0gdGhpcyxcblx0XHRcdGljb24gPSB0aGlzLm9wdGlvbnMuaWNvbnMuc3VibWVudSxcblx0XHRcdHN1Ym1lbnVzID0gdGhpcy5lbGVtZW50LmZpbmQoIHRoaXMub3B0aW9ucy5tZW51cyApO1xuXG5cdFx0dGhpcy5fdG9nZ2xlQ2xhc3MoIFwidWktbWVudS1pY29uc1wiLCBudWxsLCAhIXRoaXMuZWxlbWVudC5maW5kKCBcIi51aS1pY29uXCIgKS5sZW5ndGggKTtcblxuXHRcdC8vIEluaXRpYWxpemUgbmVzdGVkIG1lbnVzXG5cdFx0bmV3U3VibWVudXMgPSBzdWJtZW51cy5maWx0ZXIoIFwiOm5vdCgudWktbWVudSlcIiApXG5cdFx0XHQuaGlkZSgpXG5cdFx0XHQuYXR0cigge1xuXHRcdFx0XHRyb2xlOiB0aGlzLm9wdGlvbnMucm9sZSxcblx0XHRcdFx0XCJhcmlhLWhpZGRlblwiOiBcInRydWVcIixcblx0XHRcdFx0XCJhcmlhLWV4cGFuZGVkXCI6IFwiZmFsc2VcIlxuXHRcdFx0fSApXG5cdFx0XHQuZWFjaCggZnVuY3Rpb24oKSB7XG5cdFx0XHRcdHZhciBtZW51ID0gJCggdGhpcyApLFxuXHRcdFx0XHRcdGl0ZW0gPSBtZW51LnByZXYoKSxcblx0XHRcdFx0XHRzdWJtZW51Q2FyZXQgPSAkKCBcIjxzcGFuPlwiICkuZGF0YSggXCJ1aS1tZW51LXN1Ym1lbnUtY2FyZXRcIiwgdHJ1ZSApO1xuXG5cdFx0XHRcdHRoYXQuX2FkZENsYXNzKCBzdWJtZW51Q2FyZXQsIFwidWktbWVudS1pY29uXCIsIFwidWktaWNvbiBcIiArIGljb24gKTtcblx0XHRcdFx0aXRlbVxuXHRcdFx0XHRcdC5hdHRyKCBcImFyaWEtaGFzcG9wdXBcIiwgXCJ0cnVlXCIgKVxuXHRcdFx0XHRcdC5wcmVwZW5kKCBzdWJtZW51Q2FyZXQgKTtcblx0XHRcdFx0bWVudS5hdHRyKCBcImFyaWEtbGFiZWxsZWRieVwiLCBpdGVtLmF0dHIoIFwiaWRcIiApICk7XG5cdFx0XHR9ICk7XG5cblx0XHR0aGlzLl9hZGRDbGFzcyggbmV3U3VibWVudXMsIFwidWktbWVudVwiLCBcInVpLXdpZGdldCB1aS13aWRnZXQtY29udGVudCB1aS1mcm9udFwiICk7XG5cblx0XHRtZW51cyA9IHN1Ym1lbnVzLmFkZCggdGhpcy5lbGVtZW50ICk7XG5cdFx0aXRlbXMgPSBtZW51cy5maW5kKCB0aGlzLm9wdGlvbnMuaXRlbXMgKTtcblxuXHRcdC8vIEluaXRpYWxpemUgbWVudS1pdGVtcyBjb250YWluaW5nIHNwYWNlcyBhbmQvb3IgZGFzaGVzIG9ubHkgYXMgZGl2aWRlcnNcblx0XHRpdGVtcy5ub3QoIFwiLnVpLW1lbnUtaXRlbVwiICkuZWFjaCggZnVuY3Rpb24oKSB7XG5cdFx0XHR2YXIgaXRlbSA9ICQoIHRoaXMgKTtcblx0XHRcdGlmICggdGhhdC5faXNEaXZpZGVyKCBpdGVtICkgKSB7XG5cdFx0XHRcdHRoYXQuX2FkZENsYXNzKCBpdGVtLCBcInVpLW1lbnUtZGl2aWRlclwiLCBcInVpLXdpZGdldC1jb250ZW50XCIgKTtcblx0XHRcdH1cblx0XHR9ICk7XG5cblx0XHQvLyBEb24ndCByZWZyZXNoIGxpc3QgaXRlbXMgdGhhdCBhcmUgYWxyZWFkeSBhZGFwdGVkXG5cdFx0bmV3SXRlbXMgPSBpdGVtcy5ub3QoIFwiLnVpLW1lbnUtaXRlbSwgLnVpLW1lbnUtZGl2aWRlclwiICk7XG5cdFx0bmV3V3JhcHBlcnMgPSBuZXdJdGVtcy5jaGlsZHJlbigpXG5cdFx0XHQubm90KCBcIi51aS1tZW51XCIgKVxuXHRcdFx0XHQudW5pcXVlSWQoKVxuXHRcdFx0XHQuYXR0cigge1xuXHRcdFx0XHRcdHRhYkluZGV4OiAtMSxcblx0XHRcdFx0XHRyb2xlOiB0aGlzLl9pdGVtUm9sZSgpXG5cdFx0XHRcdH0gKTtcblx0XHR0aGlzLl9hZGRDbGFzcyggbmV3SXRlbXMsIFwidWktbWVudS1pdGVtXCIgKVxuXHRcdFx0Ll9hZGRDbGFzcyggbmV3V3JhcHBlcnMsIFwidWktbWVudS1pdGVtLXdyYXBwZXJcIiApO1xuXG5cdFx0Ly8gQWRkIGFyaWEtZGlzYWJsZWQgYXR0cmlidXRlIHRvIGFueSBkaXNhYmxlZCBtZW51IGl0ZW1cblx0XHRpdGVtcy5maWx0ZXIoIFwiLnVpLXN0YXRlLWRpc2FibGVkXCIgKS5hdHRyKCBcImFyaWEtZGlzYWJsZWRcIiwgXCJ0cnVlXCIgKTtcblxuXHRcdC8vIElmIHRoZSBhY3RpdmUgaXRlbSBoYXMgYmVlbiByZW1vdmVkLCBibHVyIHRoZSBtZW51XG5cdFx0aWYgKCB0aGlzLmFjdGl2ZSAmJiAhJC5jb250YWlucyggdGhpcy5lbGVtZW50WyAwIF0sIHRoaXMuYWN0aXZlWyAwIF0gKSApIHtcblx0XHRcdHRoaXMuYmx1cigpO1xuXHRcdH1cblx0fSxcblxuXHRfaXRlbVJvbGU6IGZ1bmN0aW9uKCkge1xuXHRcdHJldHVybiB7XG5cdFx0XHRtZW51OiBcIm1lbnVpdGVtXCIsXG5cdFx0XHRsaXN0Ym94OiBcIm9wdGlvblwiXG5cdFx0fVsgdGhpcy5vcHRpb25zLnJvbGUgXTtcblx0fSxcblxuXHRfc2V0T3B0aW9uOiBmdW5jdGlvbigga2V5LCB2YWx1ZSApIHtcblx0XHRpZiAoIGtleSA9PT0gXCJpY29uc1wiICkge1xuXHRcdFx0dmFyIGljb25zID0gdGhpcy5lbGVtZW50LmZpbmQoIFwiLnVpLW1lbnUtaWNvblwiICk7XG5cdFx0XHR0aGlzLl9yZW1vdmVDbGFzcyggaWNvbnMsIG51bGwsIHRoaXMub3B0aW9ucy5pY29ucy5zdWJtZW51IClcblx0XHRcdFx0Ll9hZGRDbGFzcyggaWNvbnMsIG51bGwsIHZhbHVlLnN1Ym1lbnUgKTtcblx0XHR9XG5cdFx0dGhpcy5fc3VwZXIoIGtleSwgdmFsdWUgKTtcblx0fSxcblxuXHRfc2V0T3B0aW9uRGlzYWJsZWQ6IGZ1bmN0aW9uKCB2YWx1ZSApIHtcblx0XHR0aGlzLl9zdXBlciggdmFsdWUgKTtcblxuXHRcdHRoaXMuZWxlbWVudC5hdHRyKCBcImFyaWEtZGlzYWJsZWRcIiwgU3RyaW5nKCB2YWx1ZSApICk7XG5cdFx0dGhpcy5fdG9nZ2xlQ2xhc3MoIG51bGwsIFwidWktc3RhdGUtZGlzYWJsZWRcIiwgISF2YWx1ZSApO1xuXHR9LFxuXG5cdGZvY3VzOiBmdW5jdGlvbiggZXZlbnQsIGl0ZW0gKSB7XG5cdFx0dmFyIG5lc3RlZCwgZm9jdXNlZCwgYWN0aXZlUGFyZW50O1xuXHRcdHRoaXMuYmx1ciggZXZlbnQsIGV2ZW50ICYmIGV2ZW50LnR5cGUgPT09IFwiZm9jdXNcIiApO1xuXG5cdFx0dGhpcy5fc2Nyb2xsSW50b1ZpZXcoIGl0ZW0gKTtcblxuXHRcdHRoaXMuYWN0aXZlID0gaXRlbS5maXJzdCgpO1xuXG5cdFx0Zm9jdXNlZCA9IHRoaXMuYWN0aXZlLmNoaWxkcmVuKCBcIi51aS1tZW51LWl0ZW0td3JhcHBlclwiICk7XG5cdFx0dGhpcy5fYWRkQ2xhc3MoIGZvY3VzZWQsIG51bGwsIFwidWktc3RhdGUtYWN0aXZlXCIgKTtcblxuXHRcdC8vIE9ubHkgdXBkYXRlIGFyaWEtYWN0aXZlZGVzY2VuZGFudCBpZiB0aGVyZSdzIGEgcm9sZVxuXHRcdC8vIG90aGVyd2lzZSB3ZSBhc3N1bWUgZm9jdXMgaXMgbWFuYWdlZCBlbHNld2hlcmVcblx0XHRpZiAoIHRoaXMub3B0aW9ucy5yb2xlICkge1xuXHRcdFx0dGhpcy5lbGVtZW50LmF0dHIoIFwiYXJpYS1hY3RpdmVkZXNjZW5kYW50XCIsIGZvY3VzZWQuYXR0ciggXCJpZFwiICkgKTtcblx0XHR9XG5cblx0XHQvLyBIaWdobGlnaHQgYWN0aXZlIHBhcmVudCBtZW51IGl0ZW0sIGlmIGFueVxuXHRcdGFjdGl2ZVBhcmVudCA9IHRoaXMuYWN0aXZlXG5cdFx0XHQucGFyZW50KClcblx0XHRcdFx0LmNsb3Nlc3QoIFwiLnVpLW1lbnUtaXRlbVwiIClcblx0XHRcdFx0XHQuY2hpbGRyZW4oIFwiLnVpLW1lbnUtaXRlbS13cmFwcGVyXCIgKTtcblx0XHR0aGlzLl9hZGRDbGFzcyggYWN0aXZlUGFyZW50LCBudWxsLCBcInVpLXN0YXRlLWFjdGl2ZVwiICk7XG5cblx0XHRpZiAoIGV2ZW50ICYmIGV2ZW50LnR5cGUgPT09IFwia2V5ZG93blwiICkge1xuXHRcdFx0dGhpcy5fY2xvc2UoKTtcblx0XHR9IGVsc2Uge1xuXHRcdFx0dGhpcy50aW1lciA9IHRoaXMuX2RlbGF5KCBmdW5jdGlvbigpIHtcblx0XHRcdFx0dGhpcy5fY2xvc2UoKTtcblx0XHRcdH0sIHRoaXMuZGVsYXkgKTtcblx0XHR9XG5cblx0XHRuZXN0ZWQgPSBpdGVtLmNoaWxkcmVuKCBcIi51aS1tZW51XCIgKTtcblx0XHRpZiAoIG5lc3RlZC5sZW5ndGggJiYgZXZlbnQgJiYgKCAvXm1vdXNlLy50ZXN0KCBldmVudC50eXBlICkgKSApIHtcblx0XHRcdHRoaXMuX3N0YXJ0T3BlbmluZyggbmVzdGVkICk7XG5cdFx0fVxuXHRcdHRoaXMuYWN0aXZlTWVudSA9IGl0ZW0ucGFyZW50KCk7XG5cblx0XHR0aGlzLl90cmlnZ2VyKCBcImZvY3VzXCIsIGV2ZW50LCB7IGl0ZW06IGl0ZW0gfSApO1xuXHR9LFxuXG5cdF9zY3JvbGxJbnRvVmlldzogZnVuY3Rpb24oIGl0ZW0gKSB7XG5cdFx0dmFyIGJvcmRlclRvcCwgcGFkZGluZ1RvcCwgb2Zmc2V0LCBzY3JvbGwsIGVsZW1lbnRIZWlnaHQsIGl0ZW1IZWlnaHQ7XG5cdFx0aWYgKCB0aGlzLl9oYXNTY3JvbGwoKSApIHtcblx0XHRcdGJvcmRlclRvcCA9IHBhcnNlRmxvYXQoICQuY3NzKCB0aGlzLmFjdGl2ZU1lbnVbIDAgXSwgXCJib3JkZXJUb3BXaWR0aFwiICkgKSB8fCAwO1xuXHRcdFx0cGFkZGluZ1RvcCA9IHBhcnNlRmxvYXQoICQuY3NzKCB0aGlzLmFjdGl2ZU1lbnVbIDAgXSwgXCJwYWRkaW5nVG9wXCIgKSApIHx8IDA7XG5cdFx0XHRvZmZzZXQgPSBpdGVtLm9mZnNldCgpLnRvcCAtIHRoaXMuYWN0aXZlTWVudS5vZmZzZXQoKS50b3AgLSBib3JkZXJUb3AgLSBwYWRkaW5nVG9wO1xuXHRcdFx0c2Nyb2xsID0gdGhpcy5hY3RpdmVNZW51LnNjcm9sbFRvcCgpO1xuXHRcdFx0ZWxlbWVudEhlaWdodCA9IHRoaXMuYWN0aXZlTWVudS5oZWlnaHQoKTtcblx0XHRcdGl0ZW1IZWlnaHQgPSBpdGVtLm91dGVySGVpZ2h0KCk7XG5cblx0XHRcdGlmICggb2Zmc2V0IDwgMCApIHtcblx0XHRcdFx0dGhpcy5hY3RpdmVNZW51LnNjcm9sbFRvcCggc2Nyb2xsICsgb2Zmc2V0ICk7XG5cdFx0XHR9IGVsc2UgaWYgKCBvZmZzZXQgKyBpdGVtSGVpZ2h0ID4gZWxlbWVudEhlaWdodCApIHtcblx0XHRcdFx0dGhpcy5hY3RpdmVNZW51LnNjcm9sbFRvcCggc2Nyb2xsICsgb2Zmc2V0IC0gZWxlbWVudEhlaWdodCArIGl0ZW1IZWlnaHQgKTtcblx0XHRcdH1cblx0XHR9XG5cdH0sXG5cblx0Ymx1cjogZnVuY3Rpb24oIGV2ZW50LCBmcm9tRm9jdXMgKSB7XG5cdFx0aWYgKCAhZnJvbUZvY3VzICkge1xuXHRcdFx0Y2xlYXJUaW1lb3V0KCB0aGlzLnRpbWVyICk7XG5cdFx0fVxuXG5cdFx0aWYgKCAhdGhpcy5hY3RpdmUgKSB7XG5cdFx0XHRyZXR1cm47XG5cdFx0fVxuXG5cdFx0dGhpcy5fcmVtb3ZlQ2xhc3MoIHRoaXMuYWN0aXZlLmNoaWxkcmVuKCBcIi51aS1tZW51LWl0ZW0td3JhcHBlclwiICksXG5cdFx0XHRudWxsLCBcInVpLXN0YXRlLWFjdGl2ZVwiICk7XG5cblx0XHR0aGlzLl90cmlnZ2VyKCBcImJsdXJcIiwgZXZlbnQsIHsgaXRlbTogdGhpcy5hY3RpdmUgfSApO1xuXHRcdHRoaXMuYWN0aXZlID0gbnVsbDtcblx0fSxcblxuXHRfc3RhcnRPcGVuaW5nOiBmdW5jdGlvbiggc3VibWVudSApIHtcblx0XHRjbGVhclRpbWVvdXQoIHRoaXMudGltZXIgKTtcblxuXHRcdC8vIERvbid0IG9wZW4gaWYgYWxyZWFkeSBvcGVuIGZpeGVzIGEgRmlyZWZveCBidWcgdGhhdCBjYXVzZWQgYSAuNSBwaXhlbFxuXHRcdC8vIHNoaWZ0IGluIHRoZSBzdWJtZW51IHBvc2l0aW9uIHdoZW4gbW91c2luZyBvdmVyIHRoZSBjYXJldCBpY29uXG5cdFx0aWYgKCBzdWJtZW51LmF0dHIoIFwiYXJpYS1oaWRkZW5cIiApICE9PSBcInRydWVcIiApIHtcblx0XHRcdHJldHVybjtcblx0XHR9XG5cblx0XHR0aGlzLnRpbWVyID0gdGhpcy5fZGVsYXkoIGZ1bmN0aW9uKCkge1xuXHRcdFx0dGhpcy5fY2xvc2UoKTtcblx0XHRcdHRoaXMuX29wZW4oIHN1Ym1lbnUgKTtcblx0XHR9LCB0aGlzLmRlbGF5ICk7XG5cdH0sXG5cblx0X29wZW46IGZ1bmN0aW9uKCBzdWJtZW51ICkge1xuXHRcdHZhciBwb3NpdGlvbiA9ICQuZXh0ZW5kKCB7XG5cdFx0XHRvZjogdGhpcy5hY3RpdmVcblx0XHR9LCB0aGlzLm9wdGlvbnMucG9zaXRpb24gKTtcblxuXHRcdGNsZWFyVGltZW91dCggdGhpcy50aW1lciApO1xuXHRcdHRoaXMuZWxlbWVudC5maW5kKCBcIi51aS1tZW51XCIgKS5ub3QoIHN1Ym1lbnUucGFyZW50cyggXCIudWktbWVudVwiICkgKVxuXHRcdFx0LmhpZGUoKVxuXHRcdFx0LmF0dHIoIFwiYXJpYS1oaWRkZW5cIiwgXCJ0cnVlXCIgKTtcblxuXHRcdHN1Ym1lbnVcblx0XHRcdC5zaG93KClcblx0XHRcdC5yZW1vdmVBdHRyKCBcImFyaWEtaGlkZGVuXCIgKVxuXHRcdFx0LmF0dHIoIFwiYXJpYS1leHBhbmRlZFwiLCBcInRydWVcIiApXG5cdFx0XHQucG9zaXRpb24oIHBvc2l0aW9uICk7XG5cdH0sXG5cblx0Y29sbGFwc2VBbGw6IGZ1bmN0aW9uKCBldmVudCwgYWxsICkge1xuXHRcdGNsZWFyVGltZW91dCggdGhpcy50aW1lciApO1xuXHRcdHRoaXMudGltZXIgPSB0aGlzLl9kZWxheSggZnVuY3Rpb24oKSB7XG5cblx0XHRcdC8vIElmIHdlIHdlcmUgcGFzc2VkIGFuIGV2ZW50LCBsb29rIGZvciB0aGUgc3VibWVudSB0aGF0IGNvbnRhaW5zIHRoZSBldmVudFxuXHRcdFx0dmFyIGN1cnJlbnRNZW51ID0gYWxsID8gdGhpcy5lbGVtZW50IDpcblx0XHRcdFx0JCggZXZlbnQgJiYgZXZlbnQudGFyZ2V0ICkuY2xvc2VzdCggdGhpcy5lbGVtZW50LmZpbmQoIFwiLnVpLW1lbnVcIiApICk7XG5cblx0XHRcdC8vIElmIHdlIGZvdW5kIG5vIHZhbGlkIHN1Ym1lbnUgYW5jZXN0b3IsIHVzZSB0aGUgbWFpbiBtZW51IHRvIGNsb3NlIGFsbFxuXHRcdFx0Ly8gc3ViIG1lbnVzIGFueXdheVxuXHRcdFx0aWYgKCAhY3VycmVudE1lbnUubGVuZ3RoICkge1xuXHRcdFx0XHRjdXJyZW50TWVudSA9IHRoaXMuZWxlbWVudDtcblx0XHRcdH1cblxuXHRcdFx0dGhpcy5fY2xvc2UoIGN1cnJlbnRNZW51ICk7XG5cblx0XHRcdHRoaXMuYmx1ciggZXZlbnQgKTtcblxuXHRcdFx0Ly8gV29yayBhcm91bmQgYWN0aXZlIGl0ZW0gc3RheWluZyBhY3RpdmUgYWZ0ZXIgbWVudSBpcyBibHVycmVkXG5cdFx0XHR0aGlzLl9yZW1vdmVDbGFzcyggY3VycmVudE1lbnUuZmluZCggXCIudWktc3RhdGUtYWN0aXZlXCIgKSwgbnVsbCwgXCJ1aS1zdGF0ZS1hY3RpdmVcIiApO1xuXG5cdFx0XHR0aGlzLmFjdGl2ZU1lbnUgPSBjdXJyZW50TWVudTtcblx0XHR9LCB0aGlzLmRlbGF5ICk7XG5cdH0sXG5cblx0Ly8gV2l0aCBubyBhcmd1bWVudHMsIGNsb3NlcyB0aGUgY3VycmVudGx5IGFjdGl2ZSBtZW51IC0gaWYgbm90aGluZyBpcyBhY3RpdmVcblx0Ly8gaXQgY2xvc2VzIGFsbCBtZW51cy4gIElmIHBhc3NlZCBhbiBhcmd1bWVudCwgaXQgd2lsbCBzZWFyY2ggZm9yIG1lbnVzIEJFTE9XXG5cdF9jbG9zZTogZnVuY3Rpb24oIHN0YXJ0TWVudSApIHtcblx0XHRpZiAoICFzdGFydE1lbnUgKSB7XG5cdFx0XHRzdGFydE1lbnUgPSB0aGlzLmFjdGl2ZSA/IHRoaXMuYWN0aXZlLnBhcmVudCgpIDogdGhpcy5lbGVtZW50O1xuXHRcdH1cblxuXHRcdHN0YXJ0TWVudS5maW5kKCBcIi51aS1tZW51XCIgKVxuXHRcdFx0LmhpZGUoKVxuXHRcdFx0LmF0dHIoIFwiYXJpYS1oaWRkZW5cIiwgXCJ0cnVlXCIgKVxuXHRcdFx0LmF0dHIoIFwiYXJpYS1leHBhbmRlZFwiLCBcImZhbHNlXCIgKTtcblx0fSxcblxuXHRfY2xvc2VPbkRvY3VtZW50Q2xpY2s6IGZ1bmN0aW9uKCBldmVudCApIHtcblx0XHRyZXR1cm4gISQoIGV2ZW50LnRhcmdldCApLmNsb3Nlc3QoIFwiLnVpLW1lbnVcIiApLmxlbmd0aDtcblx0fSxcblxuXHRfaXNEaXZpZGVyOiBmdW5jdGlvbiggaXRlbSApIHtcblxuXHRcdC8vIE1hdGNoIGh5cGhlbiwgZW0gZGFzaCwgZW4gZGFzaFxuXHRcdHJldHVybiAhL1teXFwtXFx1MjAxNFxcdTIwMTNcXHNdLy50ZXN0KCBpdGVtLnRleHQoKSApO1xuXHR9LFxuXG5cdGNvbGxhcHNlOiBmdW5jdGlvbiggZXZlbnQgKSB7XG5cdFx0dmFyIG5ld0l0ZW0gPSB0aGlzLmFjdGl2ZSAmJlxuXHRcdFx0dGhpcy5hY3RpdmUucGFyZW50KCkuY2xvc2VzdCggXCIudWktbWVudS1pdGVtXCIsIHRoaXMuZWxlbWVudCApO1xuXHRcdGlmICggbmV3SXRlbSAmJiBuZXdJdGVtLmxlbmd0aCApIHtcblx0XHRcdHRoaXMuX2Nsb3NlKCk7XG5cdFx0XHR0aGlzLmZvY3VzKCBldmVudCwgbmV3SXRlbSApO1xuXHRcdH1cblx0fSxcblxuXHRleHBhbmQ6IGZ1bmN0aW9uKCBldmVudCApIHtcblx0XHR2YXIgbmV3SXRlbSA9IHRoaXMuYWN0aXZlICYmXG5cdFx0XHR0aGlzLmFjdGl2ZVxuXHRcdFx0XHQuY2hpbGRyZW4oIFwiLnVpLW1lbnUgXCIgKVxuXHRcdFx0XHRcdC5maW5kKCB0aGlzLm9wdGlvbnMuaXRlbXMgKVxuXHRcdFx0XHRcdFx0LmZpcnN0KCk7XG5cblx0XHRpZiAoIG5ld0l0ZW0gJiYgbmV3SXRlbS5sZW5ndGggKSB7XG5cdFx0XHR0aGlzLl9vcGVuKCBuZXdJdGVtLnBhcmVudCgpICk7XG5cblx0XHRcdC8vIERlbGF5IHNvIEZpcmVmb3ggd2lsbCBub3QgaGlkZSBhY3RpdmVkZXNjZW5kYW50IGNoYW5nZSBpbiBleHBhbmRpbmcgc3VibWVudSBmcm9tIEFUXG5cdFx0XHR0aGlzLl9kZWxheSggZnVuY3Rpb24oKSB7XG5cdFx0XHRcdHRoaXMuZm9jdXMoIGV2ZW50LCBuZXdJdGVtICk7XG5cdFx0XHR9ICk7XG5cdFx0fVxuXHR9LFxuXG5cdG5leHQ6IGZ1bmN0aW9uKCBldmVudCApIHtcblx0XHR0aGlzLl9tb3ZlKCBcIm5leHRcIiwgXCJmaXJzdFwiLCBldmVudCApO1xuXHR9LFxuXG5cdHByZXZpb3VzOiBmdW5jdGlvbiggZXZlbnQgKSB7XG5cdFx0dGhpcy5fbW92ZSggXCJwcmV2XCIsIFwibGFzdFwiLCBldmVudCApO1xuXHR9LFxuXG5cdGlzRmlyc3RJdGVtOiBmdW5jdGlvbigpIHtcblx0XHRyZXR1cm4gdGhpcy5hY3RpdmUgJiYgIXRoaXMuYWN0aXZlLnByZXZBbGwoIFwiLnVpLW1lbnUtaXRlbVwiICkubGVuZ3RoO1xuXHR9LFxuXG5cdGlzTGFzdEl0ZW06IGZ1bmN0aW9uKCkge1xuXHRcdHJldHVybiB0aGlzLmFjdGl2ZSAmJiAhdGhpcy5hY3RpdmUubmV4dEFsbCggXCIudWktbWVudS1pdGVtXCIgKS5sZW5ndGg7XG5cdH0sXG5cblx0X21vdmU6IGZ1bmN0aW9uKCBkaXJlY3Rpb24sIGZpbHRlciwgZXZlbnQgKSB7XG5cdFx0dmFyIG5leHQ7XG5cdFx0aWYgKCB0aGlzLmFjdGl2ZSApIHtcblx0XHRcdGlmICggZGlyZWN0aW9uID09PSBcImZpcnN0XCIgfHwgZGlyZWN0aW9uID09PSBcImxhc3RcIiApIHtcblx0XHRcdFx0bmV4dCA9IHRoaXMuYWN0aXZlXG5cdFx0XHRcdFx0WyBkaXJlY3Rpb24gPT09IFwiZmlyc3RcIiA/IFwicHJldkFsbFwiIDogXCJuZXh0QWxsXCIgXSggXCIudWktbWVudS1pdGVtXCIgKVxuXHRcdFx0XHRcdC5lcSggLTEgKTtcblx0XHRcdH0gZWxzZSB7XG5cdFx0XHRcdG5leHQgPSB0aGlzLmFjdGl2ZVxuXHRcdFx0XHRcdFsgZGlyZWN0aW9uICsgXCJBbGxcIiBdKCBcIi51aS1tZW51LWl0ZW1cIiApXG5cdFx0XHRcdFx0LmVxKCAwICk7XG5cdFx0XHR9XG5cdFx0fVxuXHRcdGlmICggIW5leHQgfHwgIW5leHQubGVuZ3RoIHx8ICF0aGlzLmFjdGl2ZSApIHtcblx0XHRcdG5leHQgPSB0aGlzLmFjdGl2ZU1lbnUuZmluZCggdGhpcy5vcHRpb25zLml0ZW1zIClbIGZpbHRlciBdKCk7XG5cdFx0fVxuXG5cdFx0dGhpcy5mb2N1cyggZXZlbnQsIG5leHQgKTtcblx0fSxcblxuXHRuZXh0UGFnZTogZnVuY3Rpb24oIGV2ZW50ICkge1xuXHRcdHZhciBpdGVtLCBiYXNlLCBoZWlnaHQ7XG5cblx0XHRpZiAoICF0aGlzLmFjdGl2ZSApIHtcblx0XHRcdHRoaXMubmV4dCggZXZlbnQgKTtcblx0XHRcdHJldHVybjtcblx0XHR9XG5cdFx0aWYgKCB0aGlzLmlzTGFzdEl0ZW0oKSApIHtcblx0XHRcdHJldHVybjtcblx0XHR9XG5cdFx0aWYgKCB0aGlzLl9oYXNTY3JvbGwoKSApIHtcblx0XHRcdGJhc2UgPSB0aGlzLmFjdGl2ZS5vZmZzZXQoKS50b3A7XG5cdFx0XHRoZWlnaHQgPSB0aGlzLmVsZW1lbnQuaGVpZ2h0KCk7XG5cdFx0XHR0aGlzLmFjdGl2ZS5uZXh0QWxsKCBcIi51aS1tZW51LWl0ZW1cIiApLmVhY2goIGZ1bmN0aW9uKCkge1xuXHRcdFx0XHRpdGVtID0gJCggdGhpcyApO1xuXHRcdFx0XHRyZXR1cm4gaXRlbS5vZmZzZXQoKS50b3AgLSBiYXNlIC0gaGVpZ2h0IDwgMDtcblx0XHRcdH0gKTtcblxuXHRcdFx0dGhpcy5mb2N1cyggZXZlbnQsIGl0ZW0gKTtcblx0XHR9IGVsc2Uge1xuXHRcdFx0dGhpcy5mb2N1cyggZXZlbnQsIHRoaXMuYWN0aXZlTWVudS5maW5kKCB0aGlzLm9wdGlvbnMuaXRlbXMgKVxuXHRcdFx0XHRbICF0aGlzLmFjdGl2ZSA/IFwiZmlyc3RcIiA6IFwibGFzdFwiIF0oKSApO1xuXHRcdH1cblx0fSxcblxuXHRwcmV2aW91c1BhZ2U6IGZ1bmN0aW9uKCBldmVudCApIHtcblx0XHR2YXIgaXRlbSwgYmFzZSwgaGVpZ2h0O1xuXHRcdGlmICggIXRoaXMuYWN0aXZlICkge1xuXHRcdFx0dGhpcy5uZXh0KCBldmVudCApO1xuXHRcdFx0cmV0dXJuO1xuXHRcdH1cblx0XHRpZiAoIHRoaXMuaXNGaXJzdEl0ZW0oKSApIHtcblx0XHRcdHJldHVybjtcblx0XHR9XG5cdFx0aWYgKCB0aGlzLl9oYXNTY3JvbGwoKSApIHtcblx0XHRcdGJhc2UgPSB0aGlzLmFjdGl2ZS5vZmZzZXQoKS50b3A7XG5cdFx0XHRoZWlnaHQgPSB0aGlzLmVsZW1lbnQuaGVpZ2h0KCk7XG5cdFx0XHR0aGlzLmFjdGl2ZS5wcmV2QWxsKCBcIi51aS1tZW51LWl0ZW1cIiApLmVhY2goIGZ1bmN0aW9uKCkge1xuXHRcdFx0XHRpdGVtID0gJCggdGhpcyApO1xuXHRcdFx0XHRyZXR1cm4gaXRlbS5vZmZzZXQoKS50b3AgLSBiYXNlICsgaGVpZ2h0ID4gMDtcblx0XHRcdH0gKTtcblxuXHRcdFx0dGhpcy5mb2N1cyggZXZlbnQsIGl0ZW0gKTtcblx0XHR9IGVsc2Uge1xuXHRcdFx0dGhpcy5mb2N1cyggZXZlbnQsIHRoaXMuYWN0aXZlTWVudS5maW5kKCB0aGlzLm9wdGlvbnMuaXRlbXMgKS5maXJzdCgpICk7XG5cdFx0fVxuXHR9LFxuXG5cdF9oYXNTY3JvbGw6IGZ1bmN0aW9uKCkge1xuXHRcdHJldHVybiB0aGlzLmVsZW1lbnQub3V0ZXJIZWlnaHQoKSA8IHRoaXMuZWxlbWVudC5wcm9wKCBcInNjcm9sbEhlaWdodFwiICk7XG5cdH0sXG5cblx0c2VsZWN0OiBmdW5jdGlvbiggZXZlbnQgKSB7XG5cblx0XHQvLyBUT0RPOiBJdCBzaG91bGQgbmV2ZXIgYmUgcG9zc2libGUgdG8gbm90IGhhdmUgYW4gYWN0aXZlIGl0ZW0gYXQgdGhpc1xuXHRcdC8vIHBvaW50LCBidXQgdGhlIHRlc3RzIGRvbid0IHRyaWdnZXIgbW91c2VlbnRlciBiZWZvcmUgY2xpY2suXG5cdFx0dGhpcy5hY3RpdmUgPSB0aGlzLmFjdGl2ZSB8fCAkKCBldmVudC50YXJnZXQgKS5jbG9zZXN0KCBcIi51aS1tZW51LWl0ZW1cIiApO1xuXHRcdHZhciB1aSA9IHsgaXRlbTogdGhpcy5hY3RpdmUgfTtcblx0XHRpZiAoICF0aGlzLmFjdGl2ZS5oYXMoIFwiLnVpLW1lbnVcIiApLmxlbmd0aCApIHtcblx0XHRcdHRoaXMuY29sbGFwc2VBbGwoIGV2ZW50LCB0cnVlICk7XG5cdFx0fVxuXHRcdHRoaXMuX3RyaWdnZXIoIFwic2VsZWN0XCIsIGV2ZW50LCB1aSApO1xuXHR9LFxuXG5cdF9maWx0ZXJNZW51SXRlbXM6IGZ1bmN0aW9uKCBjaGFyYWN0ZXIgKSB7XG5cdFx0dmFyIGVzY2FwZWRDaGFyYWN0ZXIgPSBjaGFyYWN0ZXIucmVwbGFjZSggL1tcXC1cXFtcXF17fSgpKis/LixcXFxcXFxeJHwjXFxzXS9nLCBcIlxcXFwkJlwiICksXG5cdFx0XHRyZWdleCA9IG5ldyBSZWdFeHAoIFwiXlwiICsgZXNjYXBlZENoYXJhY3RlciwgXCJpXCIgKTtcblxuXHRcdHJldHVybiB0aGlzLmFjdGl2ZU1lbnVcblx0XHRcdC5maW5kKCB0aGlzLm9wdGlvbnMuaXRlbXMgKVxuXG5cdFx0XHRcdC8vIE9ubHkgbWF0Y2ggb24gaXRlbXMsIG5vdCBkaXZpZGVycyBvciBvdGhlciBjb250ZW50ICgjMTA1NzEpXG5cdFx0XHRcdC5maWx0ZXIoIFwiLnVpLW1lbnUtaXRlbVwiIClcblx0XHRcdFx0XHQuZmlsdGVyKCBmdW5jdGlvbigpIHtcblx0XHRcdFx0XHRcdHJldHVybiByZWdleC50ZXN0KFxuXHRcdFx0XHRcdFx0XHQkLnRyaW0oICQoIHRoaXMgKS5jaGlsZHJlbiggXCIudWktbWVudS1pdGVtLXdyYXBwZXJcIiApLnRleHQoKSApICk7XG5cdFx0XHRcdFx0fSApO1xuXHR9XG59ICk7XG5cbn0gKSApO1xuIiwiLyohXG4gKiBqUXVlcnkgVUkgTW91c2UgMS4xMi4xXG4gKiBodHRwOi8vanF1ZXJ5dWkuY29tXG4gKlxuICogQ29weXJpZ2h0IGpRdWVyeSBGb3VuZGF0aW9uIGFuZCBvdGhlciBjb250cmlidXRvcnNcbiAqIFJlbGVhc2VkIHVuZGVyIHRoZSBNSVQgbGljZW5zZS5cbiAqIGh0dHA6Ly9qcXVlcnkub3JnL2xpY2Vuc2VcbiAqL1xuXG4vLz4+bGFiZWw6IE1vdXNlXG4vLz4+Z3JvdXA6IFdpZGdldHNcbi8vPj5kZXNjcmlwdGlvbjogQWJzdHJhY3RzIG1vdXNlLWJhc2VkIGludGVyYWN0aW9ucyB0byBhc3Npc3QgaW4gY3JlYXRpbmcgY2VydGFpbiB3aWRnZXRzLlxuLy8+PmRvY3M6IGh0dHA6Ly9hcGkuanF1ZXJ5dWkuY29tL21vdXNlL1xuXG4oIGZ1bmN0aW9uKCBmYWN0b3J5ICkge1xuXHRpZiAoIHR5cGVvZiBkZWZpbmUgPT09IFwiZnVuY3Rpb25cIiAmJiBkZWZpbmUuYW1kICkge1xuXG5cdFx0Ly8gQU1ELiBSZWdpc3RlciBhcyBhbiBhbm9ueW1vdXMgbW9kdWxlLlxuXHRcdGRlZmluZSggW1xuXHRcdFx0XCJqcXVlcnlcIixcblx0XHRcdFwiLi4vaWVcIixcblx0XHRcdFwiLi4vdmVyc2lvblwiLFxuXHRcdFx0XCIuLi93aWRnZXRcIlxuXHRcdF0sIGZhY3RvcnkgKTtcblx0fSBlbHNlIHtcblxuXHRcdC8vIEJyb3dzZXIgZ2xvYmFsc1xuXHRcdGZhY3RvcnkoIGpRdWVyeSApO1xuXHR9XG59KCBmdW5jdGlvbiggJCApIHtcblxudmFyIG1vdXNlSGFuZGxlZCA9IGZhbHNlO1xuJCggZG9jdW1lbnQgKS5vbiggXCJtb3VzZXVwXCIsIGZ1bmN0aW9uKCkge1xuXHRtb3VzZUhhbmRsZWQgPSBmYWxzZTtcbn0gKTtcblxucmV0dXJuICQud2lkZ2V0KCBcInVpLm1vdXNlXCIsIHtcblx0dmVyc2lvbjogXCIxLjEyLjFcIixcblx0b3B0aW9uczoge1xuXHRcdGNhbmNlbDogXCJpbnB1dCwgdGV4dGFyZWEsIGJ1dHRvbiwgc2VsZWN0LCBvcHRpb25cIixcblx0XHRkaXN0YW5jZTogMSxcblx0XHRkZWxheTogMFxuXHR9LFxuXHRfbW91c2VJbml0OiBmdW5jdGlvbigpIHtcblx0XHR2YXIgdGhhdCA9IHRoaXM7XG5cblx0XHR0aGlzLmVsZW1lbnRcblx0XHRcdC5vbiggXCJtb3VzZWRvd24uXCIgKyB0aGlzLndpZGdldE5hbWUsIGZ1bmN0aW9uKCBldmVudCApIHtcblx0XHRcdFx0cmV0dXJuIHRoYXQuX21vdXNlRG93biggZXZlbnQgKTtcblx0XHRcdH0gKVxuXHRcdFx0Lm9uKCBcImNsaWNrLlwiICsgdGhpcy53aWRnZXROYW1lLCBmdW5jdGlvbiggZXZlbnQgKSB7XG5cdFx0XHRcdGlmICggdHJ1ZSA9PT0gJC5kYXRhKCBldmVudC50YXJnZXQsIHRoYXQud2lkZ2V0TmFtZSArIFwiLnByZXZlbnRDbGlja0V2ZW50XCIgKSApIHtcblx0XHRcdFx0XHQkLnJlbW92ZURhdGEoIGV2ZW50LnRhcmdldCwgdGhhdC53aWRnZXROYW1lICsgXCIucHJldmVudENsaWNrRXZlbnRcIiApO1xuXHRcdFx0XHRcdGV2ZW50LnN0b3BJbW1lZGlhdGVQcm9wYWdhdGlvbigpO1xuXHRcdFx0XHRcdHJldHVybiBmYWxzZTtcblx0XHRcdFx0fVxuXHRcdFx0fSApO1xuXG5cdFx0dGhpcy5zdGFydGVkID0gZmFsc2U7XG5cdH0sXG5cblx0Ly8gVE9ETzogbWFrZSBzdXJlIGRlc3Ryb3lpbmcgb25lIGluc3RhbmNlIG9mIG1vdXNlIGRvZXNuJ3QgbWVzcyB3aXRoXG5cdC8vIG90aGVyIGluc3RhbmNlcyBvZiBtb3VzZVxuXHRfbW91c2VEZXN0cm95OiBmdW5jdGlvbigpIHtcblx0XHR0aGlzLmVsZW1lbnQub2ZmKCBcIi5cIiArIHRoaXMud2lkZ2V0TmFtZSApO1xuXHRcdGlmICggdGhpcy5fbW91c2VNb3ZlRGVsZWdhdGUgKSB7XG5cdFx0XHR0aGlzLmRvY3VtZW50XG5cdFx0XHRcdC5vZmYoIFwibW91c2Vtb3ZlLlwiICsgdGhpcy53aWRnZXROYW1lLCB0aGlzLl9tb3VzZU1vdmVEZWxlZ2F0ZSApXG5cdFx0XHRcdC5vZmYoIFwibW91c2V1cC5cIiArIHRoaXMud2lkZ2V0TmFtZSwgdGhpcy5fbW91c2VVcERlbGVnYXRlICk7XG5cdFx0fVxuXHR9LFxuXG5cdF9tb3VzZURvd246IGZ1bmN0aW9uKCBldmVudCApIHtcblxuXHRcdC8vIGRvbid0IGxldCBtb3JlIHRoYW4gb25lIHdpZGdldCBoYW5kbGUgbW91c2VTdGFydFxuXHRcdGlmICggbW91c2VIYW5kbGVkICkge1xuXHRcdFx0cmV0dXJuO1xuXHRcdH1cblxuXHRcdHRoaXMuX21vdXNlTW92ZWQgPSBmYWxzZTtcblxuXHRcdC8vIFdlIG1heSBoYXZlIG1pc3NlZCBtb3VzZXVwIChvdXQgb2Ygd2luZG93KVxuXHRcdCggdGhpcy5fbW91c2VTdGFydGVkICYmIHRoaXMuX21vdXNlVXAoIGV2ZW50ICkgKTtcblxuXHRcdHRoaXMuX21vdXNlRG93bkV2ZW50ID0gZXZlbnQ7XG5cblx0XHR2YXIgdGhhdCA9IHRoaXMsXG5cdFx0XHRidG5Jc0xlZnQgPSAoIGV2ZW50LndoaWNoID09PSAxICksXG5cblx0XHRcdC8vIGV2ZW50LnRhcmdldC5ub2RlTmFtZSB3b3JrcyBhcm91bmQgYSBidWcgaW4gSUUgOCB3aXRoXG5cdFx0XHQvLyBkaXNhYmxlZCBpbnB1dHMgKCM3NjIwKVxuXHRcdFx0ZWxJc0NhbmNlbCA9ICggdHlwZW9mIHRoaXMub3B0aW9ucy5jYW5jZWwgPT09IFwic3RyaW5nXCIgJiYgZXZlbnQudGFyZ2V0Lm5vZGVOYW1lID9cblx0XHRcdFx0JCggZXZlbnQudGFyZ2V0ICkuY2xvc2VzdCggdGhpcy5vcHRpb25zLmNhbmNlbCApLmxlbmd0aCA6IGZhbHNlICk7XG5cdFx0aWYgKCAhYnRuSXNMZWZ0IHx8IGVsSXNDYW5jZWwgfHwgIXRoaXMuX21vdXNlQ2FwdHVyZSggZXZlbnQgKSApIHtcblx0XHRcdHJldHVybiB0cnVlO1xuXHRcdH1cblxuXHRcdHRoaXMubW91c2VEZWxheU1ldCA9ICF0aGlzLm9wdGlvbnMuZGVsYXk7XG5cdFx0aWYgKCAhdGhpcy5tb3VzZURlbGF5TWV0ICkge1xuXHRcdFx0dGhpcy5fbW91c2VEZWxheVRpbWVyID0gc2V0VGltZW91dCggZnVuY3Rpb24oKSB7XG5cdFx0XHRcdHRoYXQubW91c2VEZWxheU1ldCA9IHRydWU7XG5cdFx0XHR9LCB0aGlzLm9wdGlvbnMuZGVsYXkgKTtcblx0XHR9XG5cblx0XHRpZiAoIHRoaXMuX21vdXNlRGlzdGFuY2VNZXQoIGV2ZW50ICkgJiYgdGhpcy5fbW91c2VEZWxheU1ldCggZXZlbnQgKSApIHtcblx0XHRcdHRoaXMuX21vdXNlU3RhcnRlZCA9ICggdGhpcy5fbW91c2VTdGFydCggZXZlbnQgKSAhPT0gZmFsc2UgKTtcblx0XHRcdGlmICggIXRoaXMuX21vdXNlU3RhcnRlZCApIHtcblx0XHRcdFx0ZXZlbnQucHJldmVudERlZmF1bHQoKTtcblx0XHRcdFx0cmV0dXJuIHRydWU7XG5cdFx0XHR9XG5cdFx0fVxuXG5cdFx0Ly8gQ2xpY2sgZXZlbnQgbWF5IG5ldmVyIGhhdmUgZmlyZWQgKEdlY2tvICYgT3BlcmEpXG5cdFx0aWYgKCB0cnVlID09PSAkLmRhdGEoIGV2ZW50LnRhcmdldCwgdGhpcy53aWRnZXROYW1lICsgXCIucHJldmVudENsaWNrRXZlbnRcIiApICkge1xuXHRcdFx0JC5yZW1vdmVEYXRhKCBldmVudC50YXJnZXQsIHRoaXMud2lkZ2V0TmFtZSArIFwiLnByZXZlbnRDbGlja0V2ZW50XCIgKTtcblx0XHR9XG5cblx0XHQvLyBUaGVzZSBkZWxlZ2F0ZXMgYXJlIHJlcXVpcmVkIHRvIGtlZXAgY29udGV4dFxuXHRcdHRoaXMuX21vdXNlTW92ZURlbGVnYXRlID0gZnVuY3Rpb24oIGV2ZW50ICkge1xuXHRcdFx0cmV0dXJuIHRoYXQuX21vdXNlTW92ZSggZXZlbnQgKTtcblx0XHR9O1xuXHRcdHRoaXMuX21vdXNlVXBEZWxlZ2F0ZSA9IGZ1bmN0aW9uKCBldmVudCApIHtcblx0XHRcdHJldHVybiB0aGF0Ll9tb3VzZVVwKCBldmVudCApO1xuXHRcdH07XG5cblx0XHR0aGlzLmRvY3VtZW50XG5cdFx0XHQub24oIFwibW91c2Vtb3ZlLlwiICsgdGhpcy53aWRnZXROYW1lLCB0aGlzLl9tb3VzZU1vdmVEZWxlZ2F0ZSApXG5cdFx0XHQub24oIFwibW91c2V1cC5cIiArIHRoaXMud2lkZ2V0TmFtZSwgdGhpcy5fbW91c2VVcERlbGVnYXRlICk7XG5cblx0XHRldmVudC5wcmV2ZW50RGVmYXVsdCgpO1xuXG5cdFx0bW91c2VIYW5kbGVkID0gdHJ1ZTtcblx0XHRyZXR1cm4gdHJ1ZTtcblx0fSxcblxuXHRfbW91c2VNb3ZlOiBmdW5jdGlvbiggZXZlbnQgKSB7XG5cblx0XHQvLyBPbmx5IGNoZWNrIGZvciBtb3VzZXVwcyBvdXRzaWRlIHRoZSBkb2N1bWVudCBpZiB5b3UndmUgbW92ZWQgaW5zaWRlIHRoZSBkb2N1bWVudFxuXHRcdC8vIGF0IGxlYXN0IG9uY2UuIFRoaXMgcHJldmVudHMgdGhlIGZpcmluZyBvZiBtb3VzZXVwIGluIHRoZSBjYXNlIG9mIElFPDksIHdoaWNoIHdpbGxcblx0XHQvLyBmaXJlIGEgbW91c2Vtb3ZlIGV2ZW50IGlmIGNvbnRlbnQgaXMgcGxhY2VkIHVuZGVyIHRoZSBjdXJzb3IuIFNlZSAjNzc3OFxuXHRcdC8vIFN1cHBvcnQ6IElFIDw5XG5cdFx0aWYgKCB0aGlzLl9tb3VzZU1vdmVkICkge1xuXG5cdFx0XHQvLyBJRSBtb3VzZXVwIGNoZWNrIC0gbW91c2V1cCBoYXBwZW5lZCB3aGVuIG1vdXNlIHdhcyBvdXQgb2Ygd2luZG93XG5cdFx0XHRpZiAoICQudWkuaWUgJiYgKCAhZG9jdW1lbnQuZG9jdW1lbnRNb2RlIHx8IGRvY3VtZW50LmRvY3VtZW50TW9kZSA8IDkgKSAmJlxuXHRcdFx0XHRcdCFldmVudC5idXR0b24gKSB7XG5cdFx0XHRcdHJldHVybiB0aGlzLl9tb3VzZVVwKCBldmVudCApO1xuXG5cdFx0XHQvLyBJZnJhbWUgbW91c2V1cCBjaGVjayAtIG1vdXNldXAgb2NjdXJyZWQgaW4gYW5vdGhlciBkb2N1bWVudFxuXHRcdFx0fSBlbHNlIGlmICggIWV2ZW50LndoaWNoICkge1xuXG5cdFx0XHRcdC8vIFN1cHBvcnQ6IFNhZmFyaSA8PTggLSA5XG5cdFx0XHRcdC8vIFNhZmFyaSBzZXRzIHdoaWNoIHRvIDAgaWYgeW91IHByZXNzIGFueSBvZiB0aGUgZm9sbG93aW5nIGtleXNcblx0XHRcdFx0Ly8gZHVyaW5nIGEgZHJhZyAoIzE0NDYxKVxuXHRcdFx0XHRpZiAoIGV2ZW50Lm9yaWdpbmFsRXZlbnQuYWx0S2V5IHx8IGV2ZW50Lm9yaWdpbmFsRXZlbnQuY3RybEtleSB8fFxuXHRcdFx0XHRcdFx0ZXZlbnQub3JpZ2luYWxFdmVudC5tZXRhS2V5IHx8IGV2ZW50Lm9yaWdpbmFsRXZlbnQuc2hpZnRLZXkgKSB7XG5cdFx0XHRcdFx0dGhpcy5pZ25vcmVNaXNzaW5nV2hpY2ggPSB0cnVlO1xuXHRcdFx0XHR9IGVsc2UgaWYgKCAhdGhpcy5pZ25vcmVNaXNzaW5nV2hpY2ggKSB7XG5cdFx0XHRcdFx0cmV0dXJuIHRoaXMuX21vdXNlVXAoIGV2ZW50ICk7XG5cdFx0XHRcdH1cblx0XHRcdH1cblx0XHR9XG5cblx0XHRpZiAoIGV2ZW50LndoaWNoIHx8IGV2ZW50LmJ1dHRvbiApIHtcblx0XHRcdHRoaXMuX21vdXNlTW92ZWQgPSB0cnVlO1xuXHRcdH1cblxuXHRcdGlmICggdGhpcy5fbW91c2VTdGFydGVkICkge1xuXHRcdFx0dGhpcy5fbW91c2VEcmFnKCBldmVudCApO1xuXHRcdFx0cmV0dXJuIGV2ZW50LnByZXZlbnREZWZhdWx0KCk7XG5cdFx0fVxuXG5cdFx0aWYgKCB0aGlzLl9tb3VzZURpc3RhbmNlTWV0KCBldmVudCApICYmIHRoaXMuX21vdXNlRGVsYXlNZXQoIGV2ZW50ICkgKSB7XG5cdFx0XHR0aGlzLl9tb3VzZVN0YXJ0ZWQgPVxuXHRcdFx0XHQoIHRoaXMuX21vdXNlU3RhcnQoIHRoaXMuX21vdXNlRG93bkV2ZW50LCBldmVudCApICE9PSBmYWxzZSApO1xuXHRcdFx0KCB0aGlzLl9tb3VzZVN0YXJ0ZWQgPyB0aGlzLl9tb3VzZURyYWcoIGV2ZW50ICkgOiB0aGlzLl9tb3VzZVVwKCBldmVudCApICk7XG5cdFx0fVxuXG5cdFx0cmV0dXJuICF0aGlzLl9tb3VzZVN0YXJ0ZWQ7XG5cdH0sXG5cblx0X21vdXNlVXA6IGZ1bmN0aW9uKCBldmVudCApIHtcblx0XHR0aGlzLmRvY3VtZW50XG5cdFx0XHQub2ZmKCBcIm1vdXNlbW92ZS5cIiArIHRoaXMud2lkZ2V0TmFtZSwgdGhpcy5fbW91c2VNb3ZlRGVsZWdhdGUgKVxuXHRcdFx0Lm9mZiggXCJtb3VzZXVwLlwiICsgdGhpcy53aWRnZXROYW1lLCB0aGlzLl9tb3VzZVVwRGVsZWdhdGUgKTtcblxuXHRcdGlmICggdGhpcy5fbW91c2VTdGFydGVkICkge1xuXHRcdFx0dGhpcy5fbW91c2VTdGFydGVkID0gZmFsc2U7XG5cblx0XHRcdGlmICggZXZlbnQudGFyZ2V0ID09PSB0aGlzLl9tb3VzZURvd25FdmVudC50YXJnZXQgKSB7XG5cdFx0XHRcdCQuZGF0YSggZXZlbnQudGFyZ2V0LCB0aGlzLndpZGdldE5hbWUgKyBcIi5wcmV2ZW50Q2xpY2tFdmVudFwiLCB0cnVlICk7XG5cdFx0XHR9XG5cblx0XHRcdHRoaXMuX21vdXNlU3RvcCggZXZlbnQgKTtcblx0XHR9XG5cblx0XHRpZiAoIHRoaXMuX21vdXNlRGVsYXlUaW1lciApIHtcblx0XHRcdGNsZWFyVGltZW91dCggdGhpcy5fbW91c2VEZWxheVRpbWVyICk7XG5cdFx0XHRkZWxldGUgdGhpcy5fbW91c2VEZWxheVRpbWVyO1xuXHRcdH1cblxuXHRcdHRoaXMuaWdub3JlTWlzc2luZ1doaWNoID0gZmFsc2U7XG5cdFx0bW91c2VIYW5kbGVkID0gZmFsc2U7XG5cdFx0ZXZlbnQucHJldmVudERlZmF1bHQoKTtcblx0fSxcblxuXHRfbW91c2VEaXN0YW5jZU1ldDogZnVuY3Rpb24oIGV2ZW50ICkge1xuXHRcdHJldHVybiAoIE1hdGgubWF4KFxuXHRcdFx0XHRNYXRoLmFicyggdGhpcy5fbW91c2VEb3duRXZlbnQucGFnZVggLSBldmVudC5wYWdlWCApLFxuXHRcdFx0XHRNYXRoLmFicyggdGhpcy5fbW91c2VEb3duRXZlbnQucGFnZVkgLSBldmVudC5wYWdlWSApXG5cdFx0XHQpID49IHRoaXMub3B0aW9ucy5kaXN0YW5jZVxuXHRcdCk7XG5cdH0sXG5cblx0X21vdXNlRGVsYXlNZXQ6IGZ1bmN0aW9uKCAvKiBldmVudCAqLyApIHtcblx0XHRyZXR1cm4gdGhpcy5tb3VzZURlbGF5TWV0O1xuXHR9LFxuXG5cdC8vIFRoZXNlIGFyZSBwbGFjZWhvbGRlciBtZXRob2RzLCB0byBiZSBvdmVycmlkZW4gYnkgZXh0ZW5kaW5nIHBsdWdpblxuXHRfbW91c2VTdGFydDogZnVuY3Rpb24oIC8qIGV2ZW50ICovICkge30sXG5cdF9tb3VzZURyYWc6IGZ1bmN0aW9uKCAvKiBldmVudCAqLyApIHt9LFxuXHRfbW91c2VTdG9wOiBmdW5jdGlvbiggLyogZXZlbnQgKi8gKSB7fSxcblx0X21vdXNlQ2FwdHVyZTogZnVuY3Rpb24oIC8qIGV2ZW50ICovICkgeyByZXR1cm4gdHJ1ZTsgfVxufSApO1xuXG59ICkgKTtcbiIsIi8qIVxuICogalF1ZXJ5IFVJIFJlc2l6YWJsZSAxLjEyLjFcbiAqIGh0dHA6Ly9qcXVlcnl1aS5jb21cbiAqXG4gKiBDb3B5cmlnaHQgalF1ZXJ5IEZvdW5kYXRpb24gYW5kIG90aGVyIGNvbnRyaWJ1dG9yc1xuICogUmVsZWFzZWQgdW5kZXIgdGhlIE1JVCBsaWNlbnNlLlxuICogaHR0cDovL2pxdWVyeS5vcmcvbGljZW5zZVxuICovXG5cbi8vPj5sYWJlbDogUmVzaXphYmxlXG4vLz4+Z3JvdXA6IEludGVyYWN0aW9uc1xuLy8+PmRlc2NyaXB0aW9uOiBFbmFibGVzIHJlc2l6ZSBmdW5jdGlvbmFsaXR5IGZvciBhbnkgZWxlbWVudC5cbi8vPj5kb2NzOiBodHRwOi8vYXBpLmpxdWVyeXVpLmNvbS9yZXNpemFibGUvXG4vLz4+ZGVtb3M6IGh0dHA6Ly9qcXVlcnl1aS5jb20vcmVzaXphYmxlL1xuLy8+PmNzcy5zdHJ1Y3R1cmU6IC4uLy4uL3RoZW1lcy9iYXNlL2NvcmUuY3NzXG4vLz4+Y3NzLnN0cnVjdHVyZTogLi4vLi4vdGhlbWVzL2Jhc2UvcmVzaXphYmxlLmNzc1xuLy8+PmNzcy50aGVtZTogLi4vLi4vdGhlbWVzL2Jhc2UvdGhlbWUuY3NzXG5cbiggZnVuY3Rpb24oIGZhY3RvcnkgKSB7XG5cdGlmICggdHlwZW9mIGRlZmluZSA9PT0gXCJmdW5jdGlvblwiICYmIGRlZmluZS5hbWQgKSB7XG5cblx0XHQvLyBBTUQuIFJlZ2lzdGVyIGFzIGFuIGFub255bW91cyBtb2R1bGUuXG5cdFx0ZGVmaW5lKCBbXG5cdFx0XHRcImpxdWVyeVwiLFxuXHRcdFx0XCIuL21vdXNlXCIsXG5cdFx0XHRcIi4uL2Rpc2FibGUtc2VsZWN0aW9uXCIsXG5cdFx0XHRcIi4uL3BsdWdpblwiLFxuXHRcdFx0XCIuLi92ZXJzaW9uXCIsXG5cdFx0XHRcIi4uL3dpZGdldFwiXG5cdFx0XSwgZmFjdG9yeSApO1xuXHR9IGVsc2Uge1xuXG5cdFx0Ly8gQnJvd3NlciBnbG9iYWxzXG5cdFx0ZmFjdG9yeSggalF1ZXJ5ICk7XG5cdH1cbn0oIGZ1bmN0aW9uKCAkICkge1xuXG4kLndpZGdldCggXCJ1aS5yZXNpemFibGVcIiwgJC51aS5tb3VzZSwge1xuXHR2ZXJzaW9uOiBcIjEuMTIuMVwiLFxuXHR3aWRnZXRFdmVudFByZWZpeDogXCJyZXNpemVcIixcblx0b3B0aW9uczoge1xuXHRcdGFsc29SZXNpemU6IGZhbHNlLFxuXHRcdGFuaW1hdGU6IGZhbHNlLFxuXHRcdGFuaW1hdGVEdXJhdGlvbjogXCJzbG93XCIsXG5cdFx0YW5pbWF0ZUVhc2luZzogXCJzd2luZ1wiLFxuXHRcdGFzcGVjdFJhdGlvOiBmYWxzZSxcblx0XHRhdXRvSGlkZTogZmFsc2UsXG5cdFx0Y2xhc3Nlczoge1xuXHRcdFx0XCJ1aS1yZXNpemFibGUtc2VcIjogXCJ1aS1pY29uIHVpLWljb24tZ3JpcHNtYWxsLWRpYWdvbmFsLXNlXCJcblx0XHR9LFxuXHRcdGNvbnRhaW5tZW50OiBmYWxzZSxcblx0XHRnaG9zdDogZmFsc2UsXG5cdFx0Z3JpZDogZmFsc2UsXG5cdFx0aGFuZGxlczogXCJlLHMsc2VcIixcblx0XHRoZWxwZXI6IGZhbHNlLFxuXHRcdG1heEhlaWdodDogbnVsbCxcblx0XHRtYXhXaWR0aDogbnVsbCxcblx0XHRtaW5IZWlnaHQ6IDEwLFxuXHRcdG1pbldpZHRoOiAxMCxcblxuXHRcdC8vIFNlZSAjNzk2MFxuXHRcdHpJbmRleDogOTAsXG5cblx0XHQvLyBDYWxsYmFja3Ncblx0XHRyZXNpemU6IG51bGwsXG5cdFx0c3RhcnQ6IG51bGwsXG5cdFx0c3RvcDogbnVsbFxuXHR9LFxuXG5cdF9udW06IGZ1bmN0aW9uKCB2YWx1ZSApIHtcblx0XHRyZXR1cm4gcGFyc2VGbG9hdCggdmFsdWUgKSB8fCAwO1xuXHR9LFxuXG5cdF9pc051bWJlcjogZnVuY3Rpb24oIHZhbHVlICkge1xuXHRcdHJldHVybiAhaXNOYU4oIHBhcnNlRmxvYXQoIHZhbHVlICkgKTtcblx0fSxcblxuXHRfaGFzU2Nyb2xsOiBmdW5jdGlvbiggZWwsIGEgKSB7XG5cblx0XHRpZiAoICQoIGVsICkuY3NzKCBcIm92ZXJmbG93XCIgKSA9PT0gXCJoaWRkZW5cIiApIHtcblx0XHRcdHJldHVybiBmYWxzZTtcblx0XHR9XG5cblx0XHR2YXIgc2Nyb2xsID0gKCBhICYmIGEgPT09IFwibGVmdFwiICkgPyBcInNjcm9sbExlZnRcIiA6IFwic2Nyb2xsVG9wXCIsXG5cdFx0XHRoYXMgPSBmYWxzZTtcblxuXHRcdGlmICggZWxbIHNjcm9sbCBdID4gMCApIHtcblx0XHRcdHJldHVybiB0cnVlO1xuXHRcdH1cblxuXHRcdC8vIFRPRE86IGRldGVybWluZSB3aGljaCBjYXNlcyBhY3R1YWxseSBjYXVzZSB0aGlzIHRvIGhhcHBlblxuXHRcdC8vIGlmIHRoZSBlbGVtZW50IGRvZXNuJ3QgaGF2ZSB0aGUgc2Nyb2xsIHNldCwgc2VlIGlmIGl0J3MgcG9zc2libGUgdG9cblx0XHQvLyBzZXQgdGhlIHNjcm9sbFxuXHRcdGVsWyBzY3JvbGwgXSA9IDE7XG5cdFx0aGFzID0gKCBlbFsgc2Nyb2xsIF0gPiAwICk7XG5cdFx0ZWxbIHNjcm9sbCBdID0gMDtcblx0XHRyZXR1cm4gaGFzO1xuXHR9LFxuXG5cdF9jcmVhdGU6IGZ1bmN0aW9uKCkge1xuXG5cdFx0dmFyIG1hcmdpbnMsXG5cdFx0XHRvID0gdGhpcy5vcHRpb25zLFxuXHRcdFx0dGhhdCA9IHRoaXM7XG5cdFx0dGhpcy5fYWRkQ2xhc3MoIFwidWktcmVzaXphYmxlXCIgKTtcblxuXHRcdCQuZXh0ZW5kKCB0aGlzLCB7XG5cdFx0XHRfYXNwZWN0UmF0aW86ICEhKCBvLmFzcGVjdFJhdGlvICksXG5cdFx0XHRhc3BlY3RSYXRpbzogby5hc3BlY3RSYXRpbyxcblx0XHRcdG9yaWdpbmFsRWxlbWVudDogdGhpcy5lbGVtZW50LFxuXHRcdFx0X3Byb3BvcnRpb25hbGx5UmVzaXplRWxlbWVudHM6IFtdLFxuXHRcdFx0X2hlbHBlcjogby5oZWxwZXIgfHwgby5naG9zdCB8fCBvLmFuaW1hdGUgPyBvLmhlbHBlciB8fCBcInVpLXJlc2l6YWJsZS1oZWxwZXJcIiA6IG51bGxcblx0XHR9ICk7XG5cblx0XHQvLyBXcmFwIHRoZSBlbGVtZW50IGlmIGl0IGNhbm5vdCBob2xkIGNoaWxkIG5vZGVzXG5cdFx0aWYgKCB0aGlzLmVsZW1lbnRbIDAgXS5ub2RlTmFtZS5tYXRjaCggL14oY2FudmFzfHRleHRhcmVhfGlucHV0fHNlbGVjdHxidXR0b258aW1nKSQvaSApICkge1xuXG5cdFx0XHR0aGlzLmVsZW1lbnQud3JhcChcblx0XHRcdFx0JCggXCI8ZGl2IGNsYXNzPSd1aS13cmFwcGVyJyBzdHlsZT0nb3ZlcmZsb3c6IGhpZGRlbjsnPjwvZGl2PlwiICkuY3NzKCB7XG5cdFx0XHRcdFx0cG9zaXRpb246IHRoaXMuZWxlbWVudC5jc3MoIFwicG9zaXRpb25cIiApLFxuXHRcdFx0XHRcdHdpZHRoOiB0aGlzLmVsZW1lbnQub3V0ZXJXaWR0aCgpLFxuXHRcdFx0XHRcdGhlaWdodDogdGhpcy5lbGVtZW50Lm91dGVySGVpZ2h0KCksXG5cdFx0XHRcdFx0dG9wOiB0aGlzLmVsZW1lbnQuY3NzKCBcInRvcFwiICksXG5cdFx0XHRcdFx0bGVmdDogdGhpcy5lbGVtZW50LmNzcyggXCJsZWZ0XCIgKVxuXHRcdFx0XHR9IClcblx0XHRcdCk7XG5cblx0XHRcdHRoaXMuZWxlbWVudCA9IHRoaXMuZWxlbWVudC5wYXJlbnQoKS5kYXRhKFxuXHRcdFx0XHRcInVpLXJlc2l6YWJsZVwiLCB0aGlzLmVsZW1lbnQucmVzaXphYmxlKCBcImluc3RhbmNlXCIgKVxuXHRcdFx0KTtcblxuXHRcdFx0dGhpcy5lbGVtZW50SXNXcmFwcGVyID0gdHJ1ZTtcblxuXHRcdFx0bWFyZ2lucyA9IHtcblx0XHRcdFx0bWFyZ2luVG9wOiB0aGlzLm9yaWdpbmFsRWxlbWVudC5jc3MoIFwibWFyZ2luVG9wXCIgKSxcblx0XHRcdFx0bWFyZ2luUmlnaHQ6IHRoaXMub3JpZ2luYWxFbGVtZW50LmNzcyggXCJtYXJnaW5SaWdodFwiICksXG5cdFx0XHRcdG1hcmdpbkJvdHRvbTogdGhpcy5vcmlnaW5hbEVsZW1lbnQuY3NzKCBcIm1hcmdpbkJvdHRvbVwiICksXG5cdFx0XHRcdG1hcmdpbkxlZnQ6IHRoaXMub3JpZ2luYWxFbGVtZW50LmNzcyggXCJtYXJnaW5MZWZ0XCIgKVxuXHRcdFx0fTtcblxuXHRcdFx0dGhpcy5lbGVtZW50LmNzcyggbWFyZ2lucyApO1xuXHRcdFx0dGhpcy5vcmlnaW5hbEVsZW1lbnQuY3NzKCBcIm1hcmdpblwiLCAwICk7XG5cblx0XHRcdC8vIHN1cHBvcnQ6IFNhZmFyaVxuXHRcdFx0Ly8gUHJldmVudCBTYWZhcmkgdGV4dGFyZWEgcmVzaXplXG5cdFx0XHR0aGlzLm9yaWdpbmFsUmVzaXplU3R5bGUgPSB0aGlzLm9yaWdpbmFsRWxlbWVudC5jc3MoIFwicmVzaXplXCIgKTtcblx0XHRcdHRoaXMub3JpZ2luYWxFbGVtZW50LmNzcyggXCJyZXNpemVcIiwgXCJub25lXCIgKTtcblxuXHRcdFx0dGhpcy5fcHJvcG9ydGlvbmFsbHlSZXNpemVFbGVtZW50cy5wdXNoKCB0aGlzLm9yaWdpbmFsRWxlbWVudC5jc3MoIHtcblx0XHRcdFx0cG9zaXRpb246IFwic3RhdGljXCIsXG5cdFx0XHRcdHpvb206IDEsXG5cdFx0XHRcdGRpc3BsYXk6IFwiYmxvY2tcIlxuXHRcdFx0fSApICk7XG5cblx0XHRcdC8vIFN1cHBvcnQ6IElFOVxuXHRcdFx0Ly8gYXZvaWQgSUUganVtcCAoaGFyZCBzZXQgdGhlIG1hcmdpbilcblx0XHRcdHRoaXMub3JpZ2luYWxFbGVtZW50LmNzcyggbWFyZ2lucyApO1xuXG5cdFx0XHR0aGlzLl9wcm9wb3J0aW9uYWxseVJlc2l6ZSgpO1xuXHRcdH1cblxuXHRcdHRoaXMuX3NldHVwSGFuZGxlcygpO1xuXG5cdFx0aWYgKCBvLmF1dG9IaWRlICkge1xuXHRcdFx0JCggdGhpcy5lbGVtZW50IClcblx0XHRcdFx0Lm9uKCBcIm1vdXNlZW50ZXJcIiwgZnVuY3Rpb24oKSB7XG5cdFx0XHRcdFx0aWYgKCBvLmRpc2FibGVkICkge1xuXHRcdFx0XHRcdFx0cmV0dXJuO1xuXHRcdFx0XHRcdH1cblx0XHRcdFx0XHR0aGF0Ll9yZW1vdmVDbGFzcyggXCJ1aS1yZXNpemFibGUtYXV0b2hpZGVcIiApO1xuXHRcdFx0XHRcdHRoYXQuX2hhbmRsZXMuc2hvdygpO1xuXHRcdFx0XHR9IClcblx0XHRcdFx0Lm9uKCBcIm1vdXNlbGVhdmVcIiwgZnVuY3Rpb24oKSB7XG5cdFx0XHRcdFx0aWYgKCBvLmRpc2FibGVkICkge1xuXHRcdFx0XHRcdFx0cmV0dXJuO1xuXHRcdFx0XHRcdH1cblx0XHRcdFx0XHRpZiAoICF0aGF0LnJlc2l6aW5nICkge1xuXHRcdFx0XHRcdFx0dGhhdC5fYWRkQ2xhc3MoIFwidWktcmVzaXphYmxlLWF1dG9oaWRlXCIgKTtcblx0XHRcdFx0XHRcdHRoYXQuX2hhbmRsZXMuaGlkZSgpO1xuXHRcdFx0XHRcdH1cblx0XHRcdFx0fSApO1xuXHRcdH1cblxuXHRcdHRoaXMuX21vdXNlSW5pdCgpO1xuXHR9LFxuXG5cdF9kZXN0cm95OiBmdW5jdGlvbigpIHtcblxuXHRcdHRoaXMuX21vdXNlRGVzdHJveSgpO1xuXG5cdFx0dmFyIHdyYXBwZXIsXG5cdFx0XHRfZGVzdHJveSA9IGZ1bmN0aW9uKCBleHAgKSB7XG5cdFx0XHRcdCQoIGV4cCApXG5cdFx0XHRcdFx0LnJlbW92ZURhdGEoIFwicmVzaXphYmxlXCIgKVxuXHRcdFx0XHRcdC5yZW1vdmVEYXRhKCBcInVpLXJlc2l6YWJsZVwiIClcblx0XHRcdFx0XHQub2ZmKCBcIi5yZXNpemFibGVcIiApXG5cdFx0XHRcdFx0LmZpbmQoIFwiLnVpLXJlc2l6YWJsZS1oYW5kbGVcIiApXG5cdFx0XHRcdFx0XHQucmVtb3ZlKCk7XG5cdFx0XHR9O1xuXG5cdFx0Ly8gVE9ETzogVW53cmFwIGF0IHNhbWUgRE9NIHBvc2l0aW9uXG5cdFx0aWYgKCB0aGlzLmVsZW1lbnRJc1dyYXBwZXIgKSB7XG5cdFx0XHRfZGVzdHJveSggdGhpcy5lbGVtZW50ICk7XG5cdFx0XHR3cmFwcGVyID0gdGhpcy5lbGVtZW50O1xuXHRcdFx0dGhpcy5vcmlnaW5hbEVsZW1lbnQuY3NzKCB7XG5cdFx0XHRcdHBvc2l0aW9uOiB3cmFwcGVyLmNzcyggXCJwb3NpdGlvblwiICksXG5cdFx0XHRcdHdpZHRoOiB3cmFwcGVyLm91dGVyV2lkdGgoKSxcblx0XHRcdFx0aGVpZ2h0OiB3cmFwcGVyLm91dGVySGVpZ2h0KCksXG5cdFx0XHRcdHRvcDogd3JhcHBlci5jc3MoIFwidG9wXCIgKSxcblx0XHRcdFx0bGVmdDogd3JhcHBlci5jc3MoIFwibGVmdFwiIClcblx0XHRcdH0gKS5pbnNlcnRBZnRlciggd3JhcHBlciApO1xuXHRcdFx0d3JhcHBlci5yZW1vdmUoKTtcblx0XHR9XG5cblx0XHR0aGlzLm9yaWdpbmFsRWxlbWVudC5jc3MoIFwicmVzaXplXCIsIHRoaXMub3JpZ2luYWxSZXNpemVTdHlsZSApO1xuXHRcdF9kZXN0cm95KCB0aGlzLm9yaWdpbmFsRWxlbWVudCApO1xuXG5cdFx0cmV0dXJuIHRoaXM7XG5cdH0sXG5cblx0X3NldE9wdGlvbjogZnVuY3Rpb24oIGtleSwgdmFsdWUgKSB7XG5cdFx0dGhpcy5fc3VwZXIoIGtleSwgdmFsdWUgKTtcblxuXHRcdHN3aXRjaCAoIGtleSApIHtcblx0XHRjYXNlIFwiaGFuZGxlc1wiOlxuXHRcdFx0dGhpcy5fcmVtb3ZlSGFuZGxlcygpO1xuXHRcdFx0dGhpcy5fc2V0dXBIYW5kbGVzKCk7XG5cdFx0XHRicmVhaztcblx0XHRkZWZhdWx0OlxuXHRcdFx0YnJlYWs7XG5cdFx0fVxuXHR9LFxuXG5cdF9zZXR1cEhhbmRsZXM6IGZ1bmN0aW9uKCkge1xuXHRcdHZhciBvID0gdGhpcy5vcHRpb25zLCBoYW5kbGUsIGksIG4sIGhuYW1lLCBheGlzLCB0aGF0ID0gdGhpcztcblx0XHR0aGlzLmhhbmRsZXMgPSBvLmhhbmRsZXMgfHxcblx0XHRcdCggISQoIFwiLnVpLXJlc2l6YWJsZS1oYW5kbGVcIiwgdGhpcy5lbGVtZW50ICkubGVuZ3RoID9cblx0XHRcdFx0XCJlLHMsc2VcIiA6IHtcblx0XHRcdFx0XHRuOiBcIi51aS1yZXNpemFibGUtblwiLFxuXHRcdFx0XHRcdGU6IFwiLnVpLXJlc2l6YWJsZS1lXCIsXG5cdFx0XHRcdFx0czogXCIudWktcmVzaXphYmxlLXNcIixcblx0XHRcdFx0XHR3OiBcIi51aS1yZXNpemFibGUtd1wiLFxuXHRcdFx0XHRcdHNlOiBcIi51aS1yZXNpemFibGUtc2VcIixcblx0XHRcdFx0XHRzdzogXCIudWktcmVzaXphYmxlLXN3XCIsXG5cdFx0XHRcdFx0bmU6IFwiLnVpLXJlc2l6YWJsZS1uZVwiLFxuXHRcdFx0XHRcdG53OiBcIi51aS1yZXNpemFibGUtbndcIlxuXHRcdFx0XHR9ICk7XG5cblx0XHR0aGlzLl9oYW5kbGVzID0gJCgpO1xuXHRcdGlmICggdGhpcy5oYW5kbGVzLmNvbnN0cnVjdG9yID09PSBTdHJpbmcgKSB7XG5cblx0XHRcdGlmICggdGhpcy5oYW5kbGVzID09PSBcImFsbFwiICkge1xuXHRcdFx0XHR0aGlzLmhhbmRsZXMgPSBcIm4sZSxzLHcsc2Usc3csbmUsbndcIjtcblx0XHRcdH1cblxuXHRcdFx0biA9IHRoaXMuaGFuZGxlcy5zcGxpdCggXCIsXCIgKTtcblx0XHRcdHRoaXMuaGFuZGxlcyA9IHt9O1xuXG5cdFx0XHRmb3IgKCBpID0gMDsgaSA8IG4ubGVuZ3RoOyBpKysgKSB7XG5cblx0XHRcdFx0aGFuZGxlID0gJC50cmltKCBuWyBpIF0gKTtcblx0XHRcdFx0aG5hbWUgPSBcInVpLXJlc2l6YWJsZS1cIiArIGhhbmRsZTtcblx0XHRcdFx0YXhpcyA9ICQoIFwiPGRpdj5cIiApO1xuXHRcdFx0XHR0aGlzLl9hZGRDbGFzcyggYXhpcywgXCJ1aS1yZXNpemFibGUtaGFuZGxlIFwiICsgaG5hbWUgKTtcblxuXHRcdFx0XHRheGlzLmNzcyggeyB6SW5kZXg6IG8uekluZGV4IH0gKTtcblxuXHRcdFx0XHR0aGlzLmhhbmRsZXNbIGhhbmRsZSBdID0gXCIudWktcmVzaXphYmxlLVwiICsgaGFuZGxlO1xuXHRcdFx0XHR0aGlzLmVsZW1lbnQuYXBwZW5kKCBheGlzICk7XG5cdFx0XHR9XG5cblx0XHR9XG5cblx0XHR0aGlzLl9yZW5kZXJBeGlzID0gZnVuY3Rpb24oIHRhcmdldCApIHtcblxuXHRcdFx0dmFyIGksIGF4aXMsIHBhZFBvcywgcGFkV3JhcHBlcjtcblxuXHRcdFx0dGFyZ2V0ID0gdGFyZ2V0IHx8IHRoaXMuZWxlbWVudDtcblxuXHRcdFx0Zm9yICggaSBpbiB0aGlzLmhhbmRsZXMgKSB7XG5cblx0XHRcdFx0aWYgKCB0aGlzLmhhbmRsZXNbIGkgXS5jb25zdHJ1Y3RvciA9PT0gU3RyaW5nICkge1xuXHRcdFx0XHRcdHRoaXMuaGFuZGxlc1sgaSBdID0gdGhpcy5lbGVtZW50LmNoaWxkcmVuKCB0aGlzLmhhbmRsZXNbIGkgXSApLmZpcnN0KCkuc2hvdygpO1xuXHRcdFx0XHR9IGVsc2UgaWYgKCB0aGlzLmhhbmRsZXNbIGkgXS5qcXVlcnkgfHwgdGhpcy5oYW5kbGVzWyBpIF0ubm9kZVR5cGUgKSB7XG5cdFx0XHRcdFx0dGhpcy5oYW5kbGVzWyBpIF0gPSAkKCB0aGlzLmhhbmRsZXNbIGkgXSApO1xuXHRcdFx0XHRcdHRoaXMuX29uKCB0aGlzLmhhbmRsZXNbIGkgXSwgeyBcIm1vdXNlZG93blwiOiB0aGF0Ll9tb3VzZURvd24gfSApO1xuXHRcdFx0XHR9XG5cblx0XHRcdFx0aWYgKCB0aGlzLmVsZW1lbnRJc1dyYXBwZXIgJiZcblx0XHRcdFx0XHRcdHRoaXMub3JpZ2luYWxFbGVtZW50WyAwIF1cblx0XHRcdFx0XHRcdFx0Lm5vZGVOYW1lXG5cdFx0XHRcdFx0XHRcdC5tYXRjaCggL14odGV4dGFyZWF8aW5wdXR8c2VsZWN0fGJ1dHRvbikkL2kgKSApIHtcblx0XHRcdFx0XHRheGlzID0gJCggdGhpcy5oYW5kbGVzWyBpIF0sIHRoaXMuZWxlbWVudCApO1xuXG5cdFx0XHRcdFx0cGFkV3JhcHBlciA9IC9zd3xuZXxud3xzZXxufHMvLnRlc3QoIGkgKSA/XG5cdFx0XHRcdFx0XHRheGlzLm91dGVySGVpZ2h0KCkgOlxuXHRcdFx0XHRcdFx0YXhpcy5vdXRlcldpZHRoKCk7XG5cblx0XHRcdFx0XHRwYWRQb3MgPSBbIFwicGFkZGluZ1wiLFxuXHRcdFx0XHRcdFx0L25lfG53fG4vLnRlc3QoIGkgKSA/IFwiVG9wXCIgOlxuXHRcdFx0XHRcdFx0L3NlfHN3fHMvLnRlc3QoIGkgKSA/IFwiQm90dG9tXCIgOlxuXHRcdFx0XHRcdFx0L15lJC8udGVzdCggaSApID8gXCJSaWdodFwiIDogXCJMZWZ0XCIgXS5qb2luKCBcIlwiICk7XG5cblx0XHRcdFx0XHR0YXJnZXQuY3NzKCBwYWRQb3MsIHBhZFdyYXBwZXIgKTtcblxuXHRcdFx0XHRcdHRoaXMuX3Byb3BvcnRpb25hbGx5UmVzaXplKCk7XG5cdFx0XHRcdH1cblxuXHRcdFx0XHR0aGlzLl9oYW5kbGVzID0gdGhpcy5faGFuZGxlcy5hZGQoIHRoaXMuaGFuZGxlc1sgaSBdICk7XG5cdFx0XHR9XG5cdFx0fTtcblxuXHRcdC8vIFRPRE86IG1ha2UgcmVuZGVyQXhpcyBhIHByb3RvdHlwZSBmdW5jdGlvblxuXHRcdHRoaXMuX3JlbmRlckF4aXMoIHRoaXMuZWxlbWVudCApO1xuXG5cdFx0dGhpcy5faGFuZGxlcyA9IHRoaXMuX2hhbmRsZXMuYWRkKCB0aGlzLmVsZW1lbnQuZmluZCggXCIudWktcmVzaXphYmxlLWhhbmRsZVwiICkgKTtcblx0XHR0aGlzLl9oYW5kbGVzLmRpc2FibGVTZWxlY3Rpb24oKTtcblxuXHRcdHRoaXMuX2hhbmRsZXMub24oIFwibW91c2VvdmVyXCIsIGZ1bmN0aW9uKCkge1xuXHRcdFx0aWYgKCAhdGhhdC5yZXNpemluZyApIHtcblx0XHRcdFx0aWYgKCB0aGlzLmNsYXNzTmFtZSApIHtcblx0XHRcdFx0XHRheGlzID0gdGhpcy5jbGFzc05hbWUubWF0Y2goIC91aS1yZXNpemFibGUtKHNlfHN3fG5lfG53fG58ZXxzfHcpL2kgKTtcblx0XHRcdFx0fVxuXHRcdFx0XHR0aGF0LmF4aXMgPSBheGlzICYmIGF4aXNbIDEgXSA/IGF4aXNbIDEgXSA6IFwic2VcIjtcblx0XHRcdH1cblx0XHR9ICk7XG5cblx0XHRpZiAoIG8uYXV0b0hpZGUgKSB7XG5cdFx0XHR0aGlzLl9oYW5kbGVzLmhpZGUoKTtcblx0XHRcdHRoaXMuX2FkZENsYXNzKCBcInVpLXJlc2l6YWJsZS1hdXRvaGlkZVwiICk7XG5cdFx0fVxuXHR9LFxuXG5cdF9yZW1vdmVIYW5kbGVzOiBmdW5jdGlvbigpIHtcblx0XHR0aGlzLl9oYW5kbGVzLnJlbW92ZSgpO1xuXHR9LFxuXG5cdF9tb3VzZUNhcHR1cmU6IGZ1bmN0aW9uKCBldmVudCApIHtcblx0XHR2YXIgaSwgaGFuZGxlLFxuXHRcdFx0Y2FwdHVyZSA9IGZhbHNlO1xuXG5cdFx0Zm9yICggaSBpbiB0aGlzLmhhbmRsZXMgKSB7XG5cdFx0XHRoYW5kbGUgPSAkKCB0aGlzLmhhbmRsZXNbIGkgXSApWyAwIF07XG5cdFx0XHRpZiAoIGhhbmRsZSA9PT0gZXZlbnQudGFyZ2V0IHx8ICQuY29udGFpbnMoIGhhbmRsZSwgZXZlbnQudGFyZ2V0ICkgKSB7XG5cdFx0XHRcdGNhcHR1cmUgPSB0cnVlO1xuXHRcdFx0fVxuXHRcdH1cblxuXHRcdHJldHVybiAhdGhpcy5vcHRpb25zLmRpc2FibGVkICYmIGNhcHR1cmU7XG5cdH0sXG5cblx0X21vdXNlU3RhcnQ6IGZ1bmN0aW9uKCBldmVudCApIHtcblxuXHRcdHZhciBjdXJsZWZ0LCBjdXJ0b3AsIGN1cnNvcixcblx0XHRcdG8gPSB0aGlzLm9wdGlvbnMsXG5cdFx0XHRlbCA9IHRoaXMuZWxlbWVudDtcblxuXHRcdHRoaXMucmVzaXppbmcgPSB0cnVlO1xuXG5cdFx0dGhpcy5fcmVuZGVyUHJveHkoKTtcblxuXHRcdGN1cmxlZnQgPSB0aGlzLl9udW0oIHRoaXMuaGVscGVyLmNzcyggXCJsZWZ0XCIgKSApO1xuXHRcdGN1cnRvcCA9IHRoaXMuX251bSggdGhpcy5oZWxwZXIuY3NzKCBcInRvcFwiICkgKTtcblxuXHRcdGlmICggby5jb250YWlubWVudCApIHtcblx0XHRcdGN1cmxlZnQgKz0gJCggby5jb250YWlubWVudCApLnNjcm9sbExlZnQoKSB8fCAwO1xuXHRcdFx0Y3VydG9wICs9ICQoIG8uY29udGFpbm1lbnQgKS5zY3JvbGxUb3AoKSB8fCAwO1xuXHRcdH1cblxuXHRcdHRoaXMub2Zmc2V0ID0gdGhpcy5oZWxwZXIub2Zmc2V0KCk7XG5cdFx0dGhpcy5wb3NpdGlvbiA9IHsgbGVmdDogY3VybGVmdCwgdG9wOiBjdXJ0b3AgfTtcblxuXHRcdHRoaXMuc2l6ZSA9IHRoaXMuX2hlbHBlciA/IHtcblx0XHRcdFx0d2lkdGg6IHRoaXMuaGVscGVyLndpZHRoKCksXG5cdFx0XHRcdGhlaWdodDogdGhpcy5oZWxwZXIuaGVpZ2h0KClcblx0XHRcdH0gOiB7XG5cdFx0XHRcdHdpZHRoOiBlbC53aWR0aCgpLFxuXHRcdFx0XHRoZWlnaHQ6IGVsLmhlaWdodCgpXG5cdFx0XHR9O1xuXG5cdFx0dGhpcy5vcmlnaW5hbFNpemUgPSB0aGlzLl9oZWxwZXIgPyB7XG5cdFx0XHRcdHdpZHRoOiBlbC5vdXRlcldpZHRoKCksXG5cdFx0XHRcdGhlaWdodDogZWwub3V0ZXJIZWlnaHQoKVxuXHRcdFx0fSA6IHtcblx0XHRcdFx0d2lkdGg6IGVsLndpZHRoKCksXG5cdFx0XHRcdGhlaWdodDogZWwuaGVpZ2h0KClcblx0XHRcdH07XG5cblx0XHR0aGlzLnNpemVEaWZmID0ge1xuXHRcdFx0d2lkdGg6IGVsLm91dGVyV2lkdGgoKSAtIGVsLndpZHRoKCksXG5cdFx0XHRoZWlnaHQ6IGVsLm91dGVySGVpZ2h0KCkgLSBlbC5oZWlnaHQoKVxuXHRcdH07XG5cblx0XHR0aGlzLm9yaWdpbmFsUG9zaXRpb24gPSB7IGxlZnQ6IGN1cmxlZnQsIHRvcDogY3VydG9wIH07XG5cdFx0dGhpcy5vcmlnaW5hbE1vdXNlUG9zaXRpb24gPSB7IGxlZnQ6IGV2ZW50LnBhZ2VYLCB0b3A6IGV2ZW50LnBhZ2VZIH07XG5cblx0XHR0aGlzLmFzcGVjdFJhdGlvID0gKCB0eXBlb2Ygby5hc3BlY3RSYXRpbyA9PT0gXCJudW1iZXJcIiApID9cblx0XHRcdG8uYXNwZWN0UmF0aW8gOlxuXHRcdFx0KCAoIHRoaXMub3JpZ2luYWxTaXplLndpZHRoIC8gdGhpcy5vcmlnaW5hbFNpemUuaGVpZ2h0ICkgfHwgMSApO1xuXG5cdFx0Y3Vyc29yID0gJCggXCIudWktcmVzaXphYmxlLVwiICsgdGhpcy5heGlzICkuY3NzKCBcImN1cnNvclwiICk7XG5cdFx0JCggXCJib2R5XCIgKS5jc3MoIFwiY3Vyc29yXCIsIGN1cnNvciA9PT0gXCJhdXRvXCIgPyB0aGlzLmF4aXMgKyBcIi1yZXNpemVcIiA6IGN1cnNvciApO1xuXG5cdFx0dGhpcy5fYWRkQ2xhc3MoIFwidWktcmVzaXphYmxlLXJlc2l6aW5nXCIgKTtcblx0XHR0aGlzLl9wcm9wYWdhdGUoIFwic3RhcnRcIiwgZXZlbnQgKTtcblx0XHRyZXR1cm4gdHJ1ZTtcblx0fSxcblxuXHRfbW91c2VEcmFnOiBmdW5jdGlvbiggZXZlbnQgKSB7XG5cblx0XHR2YXIgZGF0YSwgcHJvcHMsXG5cdFx0XHRzbXAgPSB0aGlzLm9yaWdpbmFsTW91c2VQb3NpdGlvbixcblx0XHRcdGEgPSB0aGlzLmF4aXMsXG5cdFx0XHRkeCA9ICggZXZlbnQucGFnZVggLSBzbXAubGVmdCApIHx8IDAsXG5cdFx0XHRkeSA9ICggZXZlbnQucGFnZVkgLSBzbXAudG9wICkgfHwgMCxcblx0XHRcdHRyaWdnZXIgPSB0aGlzLl9jaGFuZ2VbIGEgXTtcblxuXHRcdHRoaXMuX3VwZGF0ZVByZXZQcm9wZXJ0aWVzKCk7XG5cblx0XHRpZiAoICF0cmlnZ2VyICkge1xuXHRcdFx0cmV0dXJuIGZhbHNlO1xuXHRcdH1cblxuXHRcdGRhdGEgPSB0cmlnZ2VyLmFwcGx5KCB0aGlzLCBbIGV2ZW50LCBkeCwgZHkgXSApO1xuXG5cdFx0dGhpcy5fdXBkYXRlVmlydHVhbEJvdW5kYXJpZXMoIGV2ZW50LnNoaWZ0S2V5ICk7XG5cdFx0aWYgKCB0aGlzLl9hc3BlY3RSYXRpbyB8fCBldmVudC5zaGlmdEtleSApIHtcblx0XHRcdGRhdGEgPSB0aGlzLl91cGRhdGVSYXRpbyggZGF0YSwgZXZlbnQgKTtcblx0XHR9XG5cblx0XHRkYXRhID0gdGhpcy5fcmVzcGVjdFNpemUoIGRhdGEsIGV2ZW50ICk7XG5cblx0XHR0aGlzLl91cGRhdGVDYWNoZSggZGF0YSApO1xuXG5cdFx0dGhpcy5fcHJvcGFnYXRlKCBcInJlc2l6ZVwiLCBldmVudCApO1xuXG5cdFx0cHJvcHMgPSB0aGlzLl9hcHBseUNoYW5nZXMoKTtcblxuXHRcdGlmICggIXRoaXMuX2hlbHBlciAmJiB0aGlzLl9wcm9wb3J0aW9uYWxseVJlc2l6ZUVsZW1lbnRzLmxlbmd0aCApIHtcblx0XHRcdHRoaXMuX3Byb3BvcnRpb25hbGx5UmVzaXplKCk7XG5cdFx0fVxuXG5cdFx0aWYgKCAhJC5pc0VtcHR5T2JqZWN0KCBwcm9wcyApICkge1xuXHRcdFx0dGhpcy5fdXBkYXRlUHJldlByb3BlcnRpZXMoKTtcblx0XHRcdHRoaXMuX3RyaWdnZXIoIFwicmVzaXplXCIsIGV2ZW50LCB0aGlzLnVpKCkgKTtcblx0XHRcdHRoaXMuX2FwcGx5Q2hhbmdlcygpO1xuXHRcdH1cblxuXHRcdHJldHVybiBmYWxzZTtcblx0fSxcblxuXHRfbW91c2VTdG9wOiBmdW5jdGlvbiggZXZlbnQgKSB7XG5cblx0XHR0aGlzLnJlc2l6aW5nID0gZmFsc2U7XG5cdFx0dmFyIHByLCBpc3RhLCBzb2Zmc2V0aCwgc29mZnNldHcsIHMsIGxlZnQsIHRvcCxcblx0XHRcdG8gPSB0aGlzLm9wdGlvbnMsIHRoYXQgPSB0aGlzO1xuXG5cdFx0aWYgKCB0aGlzLl9oZWxwZXIgKSB7XG5cblx0XHRcdHByID0gdGhpcy5fcHJvcG9ydGlvbmFsbHlSZXNpemVFbGVtZW50cztcblx0XHRcdGlzdGEgPSBwci5sZW5ndGggJiYgKCAvdGV4dGFyZWEvaSApLnRlc3QoIHByWyAwIF0ubm9kZU5hbWUgKTtcblx0XHRcdHNvZmZzZXRoID0gaXN0YSAmJiB0aGlzLl9oYXNTY3JvbGwoIHByWyAwIF0sIFwibGVmdFwiICkgPyAwIDogdGhhdC5zaXplRGlmZi5oZWlnaHQ7XG5cdFx0XHRzb2Zmc2V0dyA9IGlzdGEgPyAwIDogdGhhdC5zaXplRGlmZi53aWR0aDtcblxuXHRcdFx0cyA9IHtcblx0XHRcdFx0d2lkdGg6ICggdGhhdC5oZWxwZXIud2lkdGgoKSAgLSBzb2Zmc2V0dyApLFxuXHRcdFx0XHRoZWlnaHQ6ICggdGhhdC5oZWxwZXIuaGVpZ2h0KCkgLSBzb2Zmc2V0aCApXG5cdFx0XHR9O1xuXHRcdFx0bGVmdCA9ICggcGFyc2VGbG9hdCggdGhhdC5lbGVtZW50LmNzcyggXCJsZWZ0XCIgKSApICtcblx0XHRcdFx0KCB0aGF0LnBvc2l0aW9uLmxlZnQgLSB0aGF0Lm9yaWdpbmFsUG9zaXRpb24ubGVmdCApICkgfHwgbnVsbDtcblx0XHRcdHRvcCA9ICggcGFyc2VGbG9hdCggdGhhdC5lbGVtZW50LmNzcyggXCJ0b3BcIiApICkgK1xuXHRcdFx0XHQoIHRoYXQucG9zaXRpb24udG9wIC0gdGhhdC5vcmlnaW5hbFBvc2l0aW9uLnRvcCApICkgfHwgbnVsbDtcblxuXHRcdFx0aWYgKCAhby5hbmltYXRlICkge1xuXHRcdFx0XHR0aGlzLmVsZW1lbnQuY3NzKCAkLmV4dGVuZCggcywgeyB0b3A6IHRvcCwgbGVmdDogbGVmdCB9ICkgKTtcblx0XHRcdH1cblxuXHRcdFx0dGhhdC5oZWxwZXIuaGVpZ2h0KCB0aGF0LnNpemUuaGVpZ2h0ICk7XG5cdFx0XHR0aGF0LmhlbHBlci53aWR0aCggdGhhdC5zaXplLndpZHRoICk7XG5cblx0XHRcdGlmICggdGhpcy5faGVscGVyICYmICFvLmFuaW1hdGUgKSB7XG5cdFx0XHRcdHRoaXMuX3Byb3BvcnRpb25hbGx5UmVzaXplKCk7XG5cdFx0XHR9XG5cdFx0fVxuXG5cdFx0JCggXCJib2R5XCIgKS5jc3MoIFwiY3Vyc29yXCIsIFwiYXV0b1wiICk7XG5cblx0XHR0aGlzLl9yZW1vdmVDbGFzcyggXCJ1aS1yZXNpemFibGUtcmVzaXppbmdcIiApO1xuXG5cdFx0dGhpcy5fcHJvcGFnYXRlKCBcInN0b3BcIiwgZXZlbnQgKTtcblxuXHRcdGlmICggdGhpcy5faGVscGVyICkge1xuXHRcdFx0dGhpcy5oZWxwZXIucmVtb3ZlKCk7XG5cdFx0fVxuXG5cdFx0cmV0dXJuIGZhbHNlO1xuXG5cdH0sXG5cblx0X3VwZGF0ZVByZXZQcm9wZXJ0aWVzOiBmdW5jdGlvbigpIHtcblx0XHR0aGlzLnByZXZQb3NpdGlvbiA9IHtcblx0XHRcdHRvcDogdGhpcy5wb3NpdGlvbi50b3AsXG5cdFx0XHRsZWZ0OiB0aGlzLnBvc2l0aW9uLmxlZnRcblx0XHR9O1xuXHRcdHRoaXMucHJldlNpemUgPSB7XG5cdFx0XHR3aWR0aDogdGhpcy5zaXplLndpZHRoLFxuXHRcdFx0aGVpZ2h0OiB0aGlzLnNpemUuaGVpZ2h0XG5cdFx0fTtcblx0fSxcblxuXHRfYXBwbHlDaGFuZ2VzOiBmdW5jdGlvbigpIHtcblx0XHR2YXIgcHJvcHMgPSB7fTtcblxuXHRcdGlmICggdGhpcy5wb3NpdGlvbi50b3AgIT09IHRoaXMucHJldlBvc2l0aW9uLnRvcCApIHtcblx0XHRcdHByb3BzLnRvcCA9IHRoaXMucG9zaXRpb24udG9wICsgXCJweFwiO1xuXHRcdH1cblx0XHRpZiAoIHRoaXMucG9zaXRpb24ubGVmdCAhPT0gdGhpcy5wcmV2UG9zaXRpb24ubGVmdCApIHtcblx0XHRcdHByb3BzLmxlZnQgPSB0aGlzLnBvc2l0aW9uLmxlZnQgKyBcInB4XCI7XG5cdFx0fVxuXHRcdGlmICggdGhpcy5zaXplLndpZHRoICE9PSB0aGlzLnByZXZTaXplLndpZHRoICkge1xuXHRcdFx0cHJvcHMud2lkdGggPSB0aGlzLnNpemUud2lkdGggKyBcInB4XCI7XG5cdFx0fVxuXHRcdGlmICggdGhpcy5zaXplLmhlaWdodCAhPT0gdGhpcy5wcmV2U2l6ZS5oZWlnaHQgKSB7XG5cdFx0XHRwcm9wcy5oZWlnaHQgPSB0aGlzLnNpemUuaGVpZ2h0ICsgXCJweFwiO1xuXHRcdH1cblxuXHRcdHRoaXMuaGVscGVyLmNzcyggcHJvcHMgKTtcblxuXHRcdHJldHVybiBwcm9wcztcblx0fSxcblxuXHRfdXBkYXRlVmlydHVhbEJvdW5kYXJpZXM6IGZ1bmN0aW9uKCBmb3JjZUFzcGVjdFJhdGlvICkge1xuXHRcdHZhciBwTWluV2lkdGgsIHBNYXhXaWR0aCwgcE1pbkhlaWdodCwgcE1heEhlaWdodCwgYixcblx0XHRcdG8gPSB0aGlzLm9wdGlvbnM7XG5cblx0XHRiID0ge1xuXHRcdFx0bWluV2lkdGg6IHRoaXMuX2lzTnVtYmVyKCBvLm1pbldpZHRoICkgPyBvLm1pbldpZHRoIDogMCxcblx0XHRcdG1heFdpZHRoOiB0aGlzLl9pc051bWJlciggby5tYXhXaWR0aCApID8gby5tYXhXaWR0aCA6IEluZmluaXR5LFxuXHRcdFx0bWluSGVpZ2h0OiB0aGlzLl9pc051bWJlciggby5taW5IZWlnaHQgKSA/IG8ubWluSGVpZ2h0IDogMCxcblx0XHRcdG1heEhlaWdodDogdGhpcy5faXNOdW1iZXIoIG8ubWF4SGVpZ2h0ICkgPyBvLm1heEhlaWdodCA6IEluZmluaXR5XG5cdFx0fTtcblxuXHRcdGlmICggdGhpcy5fYXNwZWN0UmF0aW8gfHwgZm9yY2VBc3BlY3RSYXRpbyApIHtcblx0XHRcdHBNaW5XaWR0aCA9IGIubWluSGVpZ2h0ICogdGhpcy5hc3BlY3RSYXRpbztcblx0XHRcdHBNaW5IZWlnaHQgPSBiLm1pbldpZHRoIC8gdGhpcy5hc3BlY3RSYXRpbztcblx0XHRcdHBNYXhXaWR0aCA9IGIubWF4SGVpZ2h0ICogdGhpcy5hc3BlY3RSYXRpbztcblx0XHRcdHBNYXhIZWlnaHQgPSBiLm1heFdpZHRoIC8gdGhpcy5hc3BlY3RSYXRpbztcblxuXHRcdFx0aWYgKCBwTWluV2lkdGggPiBiLm1pbldpZHRoICkge1xuXHRcdFx0XHRiLm1pbldpZHRoID0gcE1pbldpZHRoO1xuXHRcdFx0fVxuXHRcdFx0aWYgKCBwTWluSGVpZ2h0ID4gYi5taW5IZWlnaHQgKSB7XG5cdFx0XHRcdGIubWluSGVpZ2h0ID0gcE1pbkhlaWdodDtcblx0XHRcdH1cblx0XHRcdGlmICggcE1heFdpZHRoIDwgYi5tYXhXaWR0aCApIHtcblx0XHRcdFx0Yi5tYXhXaWR0aCA9IHBNYXhXaWR0aDtcblx0XHRcdH1cblx0XHRcdGlmICggcE1heEhlaWdodCA8IGIubWF4SGVpZ2h0ICkge1xuXHRcdFx0XHRiLm1heEhlaWdodCA9IHBNYXhIZWlnaHQ7XG5cdFx0XHR9XG5cdFx0fVxuXHRcdHRoaXMuX3ZCb3VuZGFyaWVzID0gYjtcblx0fSxcblxuXHRfdXBkYXRlQ2FjaGU6IGZ1bmN0aW9uKCBkYXRhICkge1xuXHRcdHRoaXMub2Zmc2V0ID0gdGhpcy5oZWxwZXIub2Zmc2V0KCk7XG5cdFx0aWYgKCB0aGlzLl9pc051bWJlciggZGF0YS5sZWZ0ICkgKSB7XG5cdFx0XHR0aGlzLnBvc2l0aW9uLmxlZnQgPSBkYXRhLmxlZnQ7XG5cdFx0fVxuXHRcdGlmICggdGhpcy5faXNOdW1iZXIoIGRhdGEudG9wICkgKSB7XG5cdFx0XHR0aGlzLnBvc2l0aW9uLnRvcCA9IGRhdGEudG9wO1xuXHRcdH1cblx0XHRpZiAoIHRoaXMuX2lzTnVtYmVyKCBkYXRhLmhlaWdodCApICkge1xuXHRcdFx0dGhpcy5zaXplLmhlaWdodCA9IGRhdGEuaGVpZ2h0O1xuXHRcdH1cblx0XHRpZiAoIHRoaXMuX2lzTnVtYmVyKCBkYXRhLndpZHRoICkgKSB7XG5cdFx0XHR0aGlzLnNpemUud2lkdGggPSBkYXRhLndpZHRoO1xuXHRcdH1cblx0fSxcblxuXHRfdXBkYXRlUmF0aW86IGZ1bmN0aW9uKCBkYXRhICkge1xuXG5cdFx0dmFyIGNwb3MgPSB0aGlzLnBvc2l0aW9uLFxuXHRcdFx0Y3NpemUgPSB0aGlzLnNpemUsXG5cdFx0XHRhID0gdGhpcy5heGlzO1xuXG5cdFx0aWYgKCB0aGlzLl9pc051bWJlciggZGF0YS5oZWlnaHQgKSApIHtcblx0XHRcdGRhdGEud2lkdGggPSAoIGRhdGEuaGVpZ2h0ICogdGhpcy5hc3BlY3RSYXRpbyApO1xuXHRcdH0gZWxzZSBpZiAoIHRoaXMuX2lzTnVtYmVyKCBkYXRhLndpZHRoICkgKSB7XG5cdFx0XHRkYXRhLmhlaWdodCA9ICggZGF0YS53aWR0aCAvIHRoaXMuYXNwZWN0UmF0aW8gKTtcblx0XHR9XG5cblx0XHRpZiAoIGEgPT09IFwic3dcIiApIHtcblx0XHRcdGRhdGEubGVmdCA9IGNwb3MubGVmdCArICggY3NpemUud2lkdGggLSBkYXRhLndpZHRoICk7XG5cdFx0XHRkYXRhLnRvcCA9IG51bGw7XG5cdFx0fVxuXHRcdGlmICggYSA9PT0gXCJud1wiICkge1xuXHRcdFx0ZGF0YS50b3AgPSBjcG9zLnRvcCArICggY3NpemUuaGVpZ2h0IC0gZGF0YS5oZWlnaHQgKTtcblx0XHRcdGRhdGEubGVmdCA9IGNwb3MubGVmdCArICggY3NpemUud2lkdGggLSBkYXRhLndpZHRoICk7XG5cdFx0fVxuXG5cdFx0cmV0dXJuIGRhdGE7XG5cdH0sXG5cblx0X3Jlc3BlY3RTaXplOiBmdW5jdGlvbiggZGF0YSApIHtcblxuXHRcdHZhciBvID0gdGhpcy5fdkJvdW5kYXJpZXMsXG5cdFx0XHRhID0gdGhpcy5heGlzLFxuXHRcdFx0aXNtYXh3ID0gdGhpcy5faXNOdW1iZXIoIGRhdGEud2lkdGggKSAmJiBvLm1heFdpZHRoICYmICggby5tYXhXaWR0aCA8IGRhdGEud2lkdGggKSxcblx0XHRcdGlzbWF4aCA9IHRoaXMuX2lzTnVtYmVyKCBkYXRhLmhlaWdodCApICYmIG8ubWF4SGVpZ2h0ICYmICggby5tYXhIZWlnaHQgPCBkYXRhLmhlaWdodCApLFxuXHRcdFx0aXNtaW53ID0gdGhpcy5faXNOdW1iZXIoIGRhdGEud2lkdGggKSAmJiBvLm1pbldpZHRoICYmICggby5taW5XaWR0aCA+IGRhdGEud2lkdGggKSxcblx0XHRcdGlzbWluaCA9IHRoaXMuX2lzTnVtYmVyKCBkYXRhLmhlaWdodCApICYmIG8ubWluSGVpZ2h0ICYmICggby5taW5IZWlnaHQgPiBkYXRhLmhlaWdodCApLFxuXHRcdFx0ZHcgPSB0aGlzLm9yaWdpbmFsUG9zaXRpb24ubGVmdCArIHRoaXMub3JpZ2luYWxTaXplLndpZHRoLFxuXHRcdFx0ZGggPSB0aGlzLm9yaWdpbmFsUG9zaXRpb24udG9wICsgdGhpcy5vcmlnaW5hbFNpemUuaGVpZ2h0LFxuXHRcdFx0Y3cgPSAvc3d8bnd8dy8udGVzdCggYSApLCBjaCA9IC9ud3xuZXxuLy50ZXN0KCBhICk7XG5cdFx0aWYgKCBpc21pbncgKSB7XG5cdFx0XHRkYXRhLndpZHRoID0gby5taW5XaWR0aDtcblx0XHR9XG5cdFx0aWYgKCBpc21pbmggKSB7XG5cdFx0XHRkYXRhLmhlaWdodCA9IG8ubWluSGVpZ2h0O1xuXHRcdH1cblx0XHRpZiAoIGlzbWF4dyApIHtcblx0XHRcdGRhdGEud2lkdGggPSBvLm1heFdpZHRoO1xuXHRcdH1cblx0XHRpZiAoIGlzbWF4aCApIHtcblx0XHRcdGRhdGEuaGVpZ2h0ID0gby5tYXhIZWlnaHQ7XG5cdFx0fVxuXG5cdFx0aWYgKCBpc21pbncgJiYgY3cgKSB7XG5cdFx0XHRkYXRhLmxlZnQgPSBkdyAtIG8ubWluV2lkdGg7XG5cdFx0fVxuXHRcdGlmICggaXNtYXh3ICYmIGN3ICkge1xuXHRcdFx0ZGF0YS5sZWZ0ID0gZHcgLSBvLm1heFdpZHRoO1xuXHRcdH1cblx0XHRpZiAoIGlzbWluaCAmJiBjaCApIHtcblx0XHRcdGRhdGEudG9wID0gZGggLSBvLm1pbkhlaWdodDtcblx0XHR9XG5cdFx0aWYgKCBpc21heGggJiYgY2ggKSB7XG5cdFx0XHRkYXRhLnRvcCA9IGRoIC0gby5tYXhIZWlnaHQ7XG5cdFx0fVxuXG5cdFx0Ly8gRml4aW5nIGp1bXAgZXJyb3Igb24gdG9wL2xlZnQgLSBidWcgIzIzMzBcblx0XHRpZiAoICFkYXRhLndpZHRoICYmICFkYXRhLmhlaWdodCAmJiAhZGF0YS5sZWZ0ICYmIGRhdGEudG9wICkge1xuXHRcdFx0ZGF0YS50b3AgPSBudWxsO1xuXHRcdH0gZWxzZSBpZiAoICFkYXRhLndpZHRoICYmICFkYXRhLmhlaWdodCAmJiAhZGF0YS50b3AgJiYgZGF0YS5sZWZ0ICkge1xuXHRcdFx0ZGF0YS5sZWZ0ID0gbnVsbDtcblx0XHR9XG5cblx0XHRyZXR1cm4gZGF0YTtcblx0fSxcblxuXHRfZ2V0UGFkZGluZ1BsdXNCb3JkZXJEaW1lbnNpb25zOiBmdW5jdGlvbiggZWxlbWVudCApIHtcblx0XHR2YXIgaSA9IDAsXG5cdFx0XHR3aWR0aHMgPSBbXSxcblx0XHRcdGJvcmRlcnMgPSBbXG5cdFx0XHRcdGVsZW1lbnQuY3NzKCBcImJvcmRlclRvcFdpZHRoXCIgKSxcblx0XHRcdFx0ZWxlbWVudC5jc3MoIFwiYm9yZGVyUmlnaHRXaWR0aFwiICksXG5cdFx0XHRcdGVsZW1lbnQuY3NzKCBcImJvcmRlckJvdHRvbVdpZHRoXCIgKSxcblx0XHRcdFx0ZWxlbWVudC5jc3MoIFwiYm9yZGVyTGVmdFdpZHRoXCIgKVxuXHRcdFx0XSxcblx0XHRcdHBhZGRpbmdzID0gW1xuXHRcdFx0XHRlbGVtZW50LmNzcyggXCJwYWRkaW5nVG9wXCIgKSxcblx0XHRcdFx0ZWxlbWVudC5jc3MoIFwicGFkZGluZ1JpZ2h0XCIgKSxcblx0XHRcdFx0ZWxlbWVudC5jc3MoIFwicGFkZGluZ0JvdHRvbVwiICksXG5cdFx0XHRcdGVsZW1lbnQuY3NzKCBcInBhZGRpbmdMZWZ0XCIgKVxuXHRcdFx0XTtcblxuXHRcdGZvciAoIDsgaSA8IDQ7IGkrKyApIHtcblx0XHRcdHdpZHRoc1sgaSBdID0gKCBwYXJzZUZsb2F0KCBib3JkZXJzWyBpIF0gKSB8fCAwICk7XG5cdFx0XHR3aWR0aHNbIGkgXSArPSAoIHBhcnNlRmxvYXQoIHBhZGRpbmdzWyBpIF0gKSB8fCAwICk7XG5cdFx0fVxuXG5cdFx0cmV0dXJuIHtcblx0XHRcdGhlaWdodDogd2lkdGhzWyAwIF0gKyB3aWR0aHNbIDIgXSxcblx0XHRcdHdpZHRoOiB3aWR0aHNbIDEgXSArIHdpZHRoc1sgMyBdXG5cdFx0fTtcblx0fSxcblxuXHRfcHJvcG9ydGlvbmFsbHlSZXNpemU6IGZ1bmN0aW9uKCkge1xuXG5cdFx0aWYgKCAhdGhpcy5fcHJvcG9ydGlvbmFsbHlSZXNpemVFbGVtZW50cy5sZW5ndGggKSB7XG5cdFx0XHRyZXR1cm47XG5cdFx0fVxuXG5cdFx0dmFyIHByZWwsXG5cdFx0XHRpID0gMCxcblx0XHRcdGVsZW1lbnQgPSB0aGlzLmhlbHBlciB8fCB0aGlzLmVsZW1lbnQ7XG5cblx0XHRmb3IgKCA7IGkgPCB0aGlzLl9wcm9wb3J0aW9uYWxseVJlc2l6ZUVsZW1lbnRzLmxlbmd0aDsgaSsrICkge1xuXG5cdFx0XHRwcmVsID0gdGhpcy5fcHJvcG9ydGlvbmFsbHlSZXNpemVFbGVtZW50c1sgaSBdO1xuXG5cdFx0XHQvLyBUT0RPOiBTZWVtcyBsaWtlIGEgYnVnIHRvIGNhY2hlIHRoaXMub3V0ZXJEaW1lbnNpb25zXG5cdFx0XHQvLyBjb25zaWRlcmluZyB0aGF0IHdlIGFyZSBpbiBhIGxvb3AuXG5cdFx0XHRpZiAoICF0aGlzLm91dGVyRGltZW5zaW9ucyApIHtcblx0XHRcdFx0dGhpcy5vdXRlckRpbWVuc2lvbnMgPSB0aGlzLl9nZXRQYWRkaW5nUGx1c0JvcmRlckRpbWVuc2lvbnMoIHByZWwgKTtcblx0XHRcdH1cblxuXHRcdFx0cHJlbC5jc3MoIHtcblx0XHRcdFx0aGVpZ2h0OiAoIGVsZW1lbnQuaGVpZ2h0KCkgLSB0aGlzLm91dGVyRGltZW5zaW9ucy5oZWlnaHQgKSB8fCAwLFxuXHRcdFx0XHR3aWR0aDogKCBlbGVtZW50LndpZHRoKCkgLSB0aGlzLm91dGVyRGltZW5zaW9ucy53aWR0aCApIHx8IDBcblx0XHRcdH0gKTtcblxuXHRcdH1cblxuXHR9LFxuXG5cdF9yZW5kZXJQcm94eTogZnVuY3Rpb24oKSB7XG5cblx0XHR2YXIgZWwgPSB0aGlzLmVsZW1lbnQsIG8gPSB0aGlzLm9wdGlvbnM7XG5cdFx0dGhpcy5lbGVtZW50T2Zmc2V0ID0gZWwub2Zmc2V0KCk7XG5cblx0XHRpZiAoIHRoaXMuX2hlbHBlciApIHtcblxuXHRcdFx0dGhpcy5oZWxwZXIgPSB0aGlzLmhlbHBlciB8fCAkKCBcIjxkaXYgc3R5bGU9J292ZXJmbG93OmhpZGRlbjsnPjwvZGl2PlwiICk7XG5cblx0XHRcdHRoaXMuX2FkZENsYXNzKCB0aGlzLmhlbHBlciwgdGhpcy5faGVscGVyICk7XG5cdFx0XHR0aGlzLmhlbHBlci5jc3MoIHtcblx0XHRcdFx0d2lkdGg6IHRoaXMuZWxlbWVudC5vdXRlcldpZHRoKCksXG5cdFx0XHRcdGhlaWdodDogdGhpcy5lbGVtZW50Lm91dGVySGVpZ2h0KCksXG5cdFx0XHRcdHBvc2l0aW9uOiBcImFic29sdXRlXCIsXG5cdFx0XHRcdGxlZnQ6IHRoaXMuZWxlbWVudE9mZnNldC5sZWZ0ICsgXCJweFwiLFxuXHRcdFx0XHR0b3A6IHRoaXMuZWxlbWVudE9mZnNldC50b3AgKyBcInB4XCIsXG5cdFx0XHRcdHpJbmRleDogKytvLnpJbmRleCAvL1RPRE86IERvbid0IG1vZGlmeSBvcHRpb25cblx0XHRcdH0gKTtcblxuXHRcdFx0dGhpcy5oZWxwZXJcblx0XHRcdFx0LmFwcGVuZFRvKCBcImJvZHlcIiApXG5cdFx0XHRcdC5kaXNhYmxlU2VsZWN0aW9uKCk7XG5cblx0XHR9IGVsc2Uge1xuXHRcdFx0dGhpcy5oZWxwZXIgPSB0aGlzLmVsZW1lbnQ7XG5cdFx0fVxuXG5cdH0sXG5cblx0X2NoYW5nZToge1xuXHRcdGU6IGZ1bmN0aW9uKCBldmVudCwgZHggKSB7XG5cdFx0XHRyZXR1cm4geyB3aWR0aDogdGhpcy5vcmlnaW5hbFNpemUud2lkdGggKyBkeCB9O1xuXHRcdH0sXG5cdFx0dzogZnVuY3Rpb24oIGV2ZW50LCBkeCApIHtcblx0XHRcdHZhciBjcyA9IHRoaXMub3JpZ2luYWxTaXplLCBzcCA9IHRoaXMub3JpZ2luYWxQb3NpdGlvbjtcblx0XHRcdHJldHVybiB7IGxlZnQ6IHNwLmxlZnQgKyBkeCwgd2lkdGg6IGNzLndpZHRoIC0gZHggfTtcblx0XHR9LFxuXHRcdG46IGZ1bmN0aW9uKCBldmVudCwgZHgsIGR5ICkge1xuXHRcdFx0dmFyIGNzID0gdGhpcy5vcmlnaW5hbFNpemUsIHNwID0gdGhpcy5vcmlnaW5hbFBvc2l0aW9uO1xuXHRcdFx0cmV0dXJuIHsgdG9wOiBzcC50b3AgKyBkeSwgaGVpZ2h0OiBjcy5oZWlnaHQgLSBkeSB9O1xuXHRcdH0sXG5cdFx0czogZnVuY3Rpb24oIGV2ZW50LCBkeCwgZHkgKSB7XG5cdFx0XHRyZXR1cm4geyBoZWlnaHQ6IHRoaXMub3JpZ2luYWxTaXplLmhlaWdodCArIGR5IH07XG5cdFx0fSxcblx0XHRzZTogZnVuY3Rpb24oIGV2ZW50LCBkeCwgZHkgKSB7XG5cdFx0XHRyZXR1cm4gJC5leHRlbmQoIHRoaXMuX2NoYW5nZS5zLmFwcGx5KCB0aGlzLCBhcmd1bWVudHMgKSxcblx0XHRcdFx0dGhpcy5fY2hhbmdlLmUuYXBwbHkoIHRoaXMsIFsgZXZlbnQsIGR4LCBkeSBdICkgKTtcblx0XHR9LFxuXHRcdHN3OiBmdW5jdGlvbiggZXZlbnQsIGR4LCBkeSApIHtcblx0XHRcdHJldHVybiAkLmV4dGVuZCggdGhpcy5fY2hhbmdlLnMuYXBwbHkoIHRoaXMsIGFyZ3VtZW50cyApLFxuXHRcdFx0XHR0aGlzLl9jaGFuZ2Uudy5hcHBseSggdGhpcywgWyBldmVudCwgZHgsIGR5IF0gKSApO1xuXHRcdH0sXG5cdFx0bmU6IGZ1bmN0aW9uKCBldmVudCwgZHgsIGR5ICkge1xuXHRcdFx0cmV0dXJuICQuZXh0ZW5kKCB0aGlzLl9jaGFuZ2Uubi5hcHBseSggdGhpcywgYXJndW1lbnRzICksXG5cdFx0XHRcdHRoaXMuX2NoYW5nZS5lLmFwcGx5KCB0aGlzLCBbIGV2ZW50LCBkeCwgZHkgXSApICk7XG5cdFx0fSxcblx0XHRudzogZnVuY3Rpb24oIGV2ZW50LCBkeCwgZHkgKSB7XG5cdFx0XHRyZXR1cm4gJC5leHRlbmQoIHRoaXMuX2NoYW5nZS5uLmFwcGx5KCB0aGlzLCBhcmd1bWVudHMgKSxcblx0XHRcdFx0dGhpcy5fY2hhbmdlLncuYXBwbHkoIHRoaXMsIFsgZXZlbnQsIGR4LCBkeSBdICkgKTtcblx0XHR9XG5cdH0sXG5cblx0X3Byb3BhZ2F0ZTogZnVuY3Rpb24oIG4sIGV2ZW50ICkge1xuXHRcdCQudWkucGx1Z2luLmNhbGwoIHRoaXMsIG4sIFsgZXZlbnQsIHRoaXMudWkoKSBdICk7XG5cdFx0KCBuICE9PSBcInJlc2l6ZVwiICYmIHRoaXMuX3RyaWdnZXIoIG4sIGV2ZW50LCB0aGlzLnVpKCkgKSApO1xuXHR9LFxuXG5cdHBsdWdpbnM6IHt9LFxuXG5cdHVpOiBmdW5jdGlvbigpIHtcblx0XHRyZXR1cm4ge1xuXHRcdFx0b3JpZ2luYWxFbGVtZW50OiB0aGlzLm9yaWdpbmFsRWxlbWVudCxcblx0XHRcdGVsZW1lbnQ6IHRoaXMuZWxlbWVudCxcblx0XHRcdGhlbHBlcjogdGhpcy5oZWxwZXIsXG5cdFx0XHRwb3NpdGlvbjogdGhpcy5wb3NpdGlvbixcblx0XHRcdHNpemU6IHRoaXMuc2l6ZSxcblx0XHRcdG9yaWdpbmFsU2l6ZTogdGhpcy5vcmlnaW5hbFNpemUsXG5cdFx0XHRvcmlnaW5hbFBvc2l0aW9uOiB0aGlzLm9yaWdpbmFsUG9zaXRpb25cblx0XHR9O1xuXHR9XG5cbn0gKTtcblxuLypcbiAqIFJlc2l6YWJsZSBFeHRlbnNpb25zXG4gKi9cblxuJC51aS5wbHVnaW4uYWRkKCBcInJlc2l6YWJsZVwiLCBcImFuaW1hdGVcIiwge1xuXG5cdHN0b3A6IGZ1bmN0aW9uKCBldmVudCApIHtcblx0XHR2YXIgdGhhdCA9ICQoIHRoaXMgKS5yZXNpemFibGUoIFwiaW5zdGFuY2VcIiApLFxuXHRcdFx0byA9IHRoYXQub3B0aW9ucyxcblx0XHRcdHByID0gdGhhdC5fcHJvcG9ydGlvbmFsbHlSZXNpemVFbGVtZW50cyxcblx0XHRcdGlzdGEgPSBwci5sZW5ndGggJiYgKCAvdGV4dGFyZWEvaSApLnRlc3QoIHByWyAwIF0ubm9kZU5hbWUgKSxcblx0XHRcdHNvZmZzZXRoID0gaXN0YSAmJiB0aGF0Ll9oYXNTY3JvbGwoIHByWyAwIF0sIFwibGVmdFwiICkgPyAwIDogdGhhdC5zaXplRGlmZi5oZWlnaHQsXG5cdFx0XHRzb2Zmc2V0dyA9IGlzdGEgPyAwIDogdGhhdC5zaXplRGlmZi53aWR0aCxcblx0XHRcdHN0eWxlID0ge1xuXHRcdFx0XHR3aWR0aDogKCB0aGF0LnNpemUud2lkdGggLSBzb2Zmc2V0dyApLFxuXHRcdFx0XHRoZWlnaHQ6ICggdGhhdC5zaXplLmhlaWdodCAtIHNvZmZzZXRoIClcblx0XHRcdH0sXG5cdFx0XHRsZWZ0ID0gKCBwYXJzZUZsb2F0KCB0aGF0LmVsZW1lbnQuY3NzKCBcImxlZnRcIiApICkgK1xuXHRcdFx0XHQoIHRoYXQucG9zaXRpb24ubGVmdCAtIHRoYXQub3JpZ2luYWxQb3NpdGlvbi5sZWZ0ICkgKSB8fCBudWxsLFxuXHRcdFx0dG9wID0gKCBwYXJzZUZsb2F0KCB0aGF0LmVsZW1lbnQuY3NzKCBcInRvcFwiICkgKSArXG5cdFx0XHRcdCggdGhhdC5wb3NpdGlvbi50b3AgLSB0aGF0Lm9yaWdpbmFsUG9zaXRpb24udG9wICkgKSB8fCBudWxsO1xuXG5cdFx0dGhhdC5lbGVtZW50LmFuaW1hdGUoXG5cdFx0XHQkLmV4dGVuZCggc3R5bGUsIHRvcCAmJiBsZWZ0ID8geyB0b3A6IHRvcCwgbGVmdDogbGVmdCB9IDoge30gKSwge1xuXHRcdFx0XHRkdXJhdGlvbjogby5hbmltYXRlRHVyYXRpb24sXG5cdFx0XHRcdGVhc2luZzogby5hbmltYXRlRWFzaW5nLFxuXHRcdFx0XHRzdGVwOiBmdW5jdGlvbigpIHtcblxuXHRcdFx0XHRcdHZhciBkYXRhID0ge1xuXHRcdFx0XHRcdFx0d2lkdGg6IHBhcnNlRmxvYXQoIHRoYXQuZWxlbWVudC5jc3MoIFwid2lkdGhcIiApICksXG5cdFx0XHRcdFx0XHRoZWlnaHQ6IHBhcnNlRmxvYXQoIHRoYXQuZWxlbWVudC5jc3MoIFwiaGVpZ2h0XCIgKSApLFxuXHRcdFx0XHRcdFx0dG9wOiBwYXJzZUZsb2F0KCB0aGF0LmVsZW1lbnQuY3NzKCBcInRvcFwiICkgKSxcblx0XHRcdFx0XHRcdGxlZnQ6IHBhcnNlRmxvYXQoIHRoYXQuZWxlbWVudC5jc3MoIFwibGVmdFwiICkgKVxuXHRcdFx0XHRcdH07XG5cblx0XHRcdFx0XHRpZiAoIHByICYmIHByLmxlbmd0aCApIHtcblx0XHRcdFx0XHRcdCQoIHByWyAwIF0gKS5jc3MoIHsgd2lkdGg6IGRhdGEud2lkdGgsIGhlaWdodDogZGF0YS5oZWlnaHQgfSApO1xuXHRcdFx0XHRcdH1cblxuXHRcdFx0XHRcdC8vIFByb3BhZ2F0aW5nIHJlc2l6ZSwgYW5kIHVwZGF0aW5nIHZhbHVlcyBmb3IgZWFjaCBhbmltYXRpb24gc3RlcFxuXHRcdFx0XHRcdHRoYXQuX3VwZGF0ZUNhY2hlKCBkYXRhICk7XG5cdFx0XHRcdFx0dGhhdC5fcHJvcGFnYXRlKCBcInJlc2l6ZVwiLCBldmVudCApO1xuXG5cdFx0XHRcdH1cblx0XHRcdH1cblx0XHQpO1xuXHR9XG5cbn0gKTtcblxuJC51aS5wbHVnaW4uYWRkKCBcInJlc2l6YWJsZVwiLCBcImNvbnRhaW5tZW50XCIsIHtcblxuXHRzdGFydDogZnVuY3Rpb24oKSB7XG5cdFx0dmFyIGVsZW1lbnQsIHAsIGNvLCBjaCwgY3csIHdpZHRoLCBoZWlnaHQsXG5cdFx0XHR0aGF0ID0gJCggdGhpcyApLnJlc2l6YWJsZSggXCJpbnN0YW5jZVwiICksXG5cdFx0XHRvID0gdGhhdC5vcHRpb25zLFxuXHRcdFx0ZWwgPSB0aGF0LmVsZW1lbnQsXG5cdFx0XHRvYyA9IG8uY29udGFpbm1lbnQsXG5cdFx0XHRjZSA9ICggb2MgaW5zdGFuY2VvZiAkICkgP1xuXHRcdFx0XHRvYy5nZXQoIDAgKSA6XG5cdFx0XHRcdCggL3BhcmVudC8udGVzdCggb2MgKSApID8gZWwucGFyZW50KCkuZ2V0KCAwICkgOiBvYztcblxuXHRcdGlmICggIWNlICkge1xuXHRcdFx0cmV0dXJuO1xuXHRcdH1cblxuXHRcdHRoYXQuY29udGFpbmVyRWxlbWVudCA9ICQoIGNlICk7XG5cblx0XHRpZiAoIC9kb2N1bWVudC8udGVzdCggb2MgKSB8fCBvYyA9PT0gZG9jdW1lbnQgKSB7XG5cdFx0XHR0aGF0LmNvbnRhaW5lck9mZnNldCA9IHtcblx0XHRcdFx0bGVmdDogMCxcblx0XHRcdFx0dG9wOiAwXG5cdFx0XHR9O1xuXHRcdFx0dGhhdC5jb250YWluZXJQb3NpdGlvbiA9IHtcblx0XHRcdFx0bGVmdDogMCxcblx0XHRcdFx0dG9wOiAwXG5cdFx0XHR9O1xuXG5cdFx0XHR0aGF0LnBhcmVudERhdGEgPSB7XG5cdFx0XHRcdGVsZW1lbnQ6ICQoIGRvY3VtZW50ICksXG5cdFx0XHRcdGxlZnQ6IDAsXG5cdFx0XHRcdHRvcDogMCxcblx0XHRcdFx0d2lkdGg6ICQoIGRvY3VtZW50ICkud2lkdGgoKSxcblx0XHRcdFx0aGVpZ2h0OiAkKCBkb2N1bWVudCApLmhlaWdodCgpIHx8IGRvY3VtZW50LmJvZHkucGFyZW50Tm9kZS5zY3JvbGxIZWlnaHRcblx0XHRcdH07XG5cdFx0fSBlbHNlIHtcblx0XHRcdGVsZW1lbnQgPSAkKCBjZSApO1xuXHRcdFx0cCA9IFtdO1xuXHRcdFx0JCggWyBcIlRvcFwiLCBcIlJpZ2h0XCIsIFwiTGVmdFwiLCBcIkJvdHRvbVwiIF0gKS5lYWNoKCBmdW5jdGlvbiggaSwgbmFtZSApIHtcblx0XHRcdFx0cFsgaSBdID0gdGhhdC5fbnVtKCBlbGVtZW50LmNzcyggXCJwYWRkaW5nXCIgKyBuYW1lICkgKTtcblx0XHRcdH0gKTtcblxuXHRcdFx0dGhhdC5jb250YWluZXJPZmZzZXQgPSBlbGVtZW50Lm9mZnNldCgpO1xuXHRcdFx0dGhhdC5jb250YWluZXJQb3NpdGlvbiA9IGVsZW1lbnQucG9zaXRpb24oKTtcblx0XHRcdHRoYXQuY29udGFpbmVyU2l6ZSA9IHtcblx0XHRcdFx0aGVpZ2h0OiAoIGVsZW1lbnQuaW5uZXJIZWlnaHQoKSAtIHBbIDMgXSApLFxuXHRcdFx0XHR3aWR0aDogKCBlbGVtZW50LmlubmVyV2lkdGgoKSAtIHBbIDEgXSApXG5cdFx0XHR9O1xuXG5cdFx0XHRjbyA9IHRoYXQuY29udGFpbmVyT2Zmc2V0O1xuXHRcdFx0Y2ggPSB0aGF0LmNvbnRhaW5lclNpemUuaGVpZ2h0O1xuXHRcdFx0Y3cgPSB0aGF0LmNvbnRhaW5lclNpemUud2lkdGg7XG5cdFx0XHR3aWR0aCA9ICggdGhhdC5faGFzU2Nyb2xsICggY2UsIFwibGVmdFwiICkgPyBjZS5zY3JvbGxXaWR0aCA6IGN3ICk7XG5cdFx0XHRoZWlnaHQgPSAoIHRoYXQuX2hhc1Njcm9sbCAoIGNlICkgPyBjZS5zY3JvbGxIZWlnaHQgOiBjaCApIDtcblxuXHRcdFx0dGhhdC5wYXJlbnREYXRhID0ge1xuXHRcdFx0XHRlbGVtZW50OiBjZSxcblx0XHRcdFx0bGVmdDogY28ubGVmdCxcblx0XHRcdFx0dG9wOiBjby50b3AsXG5cdFx0XHRcdHdpZHRoOiB3aWR0aCxcblx0XHRcdFx0aGVpZ2h0OiBoZWlnaHRcblx0XHRcdH07XG5cdFx0fVxuXHR9LFxuXG5cdHJlc2l6ZTogZnVuY3Rpb24oIGV2ZW50ICkge1xuXHRcdHZhciB3b3NldCwgaG9zZXQsIGlzUGFyZW50LCBpc09mZnNldFJlbGF0aXZlLFxuXHRcdFx0dGhhdCA9ICQoIHRoaXMgKS5yZXNpemFibGUoIFwiaW5zdGFuY2VcIiApLFxuXHRcdFx0byA9IHRoYXQub3B0aW9ucyxcblx0XHRcdGNvID0gdGhhdC5jb250YWluZXJPZmZzZXQsXG5cdFx0XHRjcCA9IHRoYXQucG9zaXRpb24sXG5cdFx0XHRwUmF0aW8gPSB0aGF0Ll9hc3BlY3RSYXRpbyB8fCBldmVudC5zaGlmdEtleSxcblx0XHRcdGNvcCA9IHtcblx0XHRcdFx0dG9wOiAwLFxuXHRcdFx0XHRsZWZ0OiAwXG5cdFx0XHR9LFxuXHRcdFx0Y2UgPSB0aGF0LmNvbnRhaW5lckVsZW1lbnQsXG5cdFx0XHRjb250aW51ZVJlc2l6ZSA9IHRydWU7XG5cblx0XHRpZiAoIGNlWyAwIF0gIT09IGRvY3VtZW50ICYmICggL3N0YXRpYy8gKS50ZXN0KCBjZS5jc3MoIFwicG9zaXRpb25cIiApICkgKSB7XG5cdFx0XHRjb3AgPSBjbztcblx0XHR9XG5cblx0XHRpZiAoIGNwLmxlZnQgPCAoIHRoYXQuX2hlbHBlciA/IGNvLmxlZnQgOiAwICkgKSB7XG5cdFx0XHR0aGF0LnNpemUud2lkdGggPSB0aGF0LnNpemUud2lkdGggK1xuXHRcdFx0XHQoIHRoYXQuX2hlbHBlciA/XG5cdFx0XHRcdFx0KCB0aGF0LnBvc2l0aW9uLmxlZnQgLSBjby5sZWZ0ICkgOlxuXHRcdFx0XHRcdCggdGhhdC5wb3NpdGlvbi5sZWZ0IC0gY29wLmxlZnQgKSApO1xuXG5cdFx0XHRpZiAoIHBSYXRpbyApIHtcblx0XHRcdFx0dGhhdC5zaXplLmhlaWdodCA9IHRoYXQuc2l6ZS53aWR0aCAvIHRoYXQuYXNwZWN0UmF0aW87XG5cdFx0XHRcdGNvbnRpbnVlUmVzaXplID0gZmFsc2U7XG5cdFx0XHR9XG5cdFx0XHR0aGF0LnBvc2l0aW9uLmxlZnQgPSBvLmhlbHBlciA/IGNvLmxlZnQgOiAwO1xuXHRcdH1cblxuXHRcdGlmICggY3AudG9wIDwgKCB0aGF0Ll9oZWxwZXIgPyBjby50b3AgOiAwICkgKSB7XG5cdFx0XHR0aGF0LnNpemUuaGVpZ2h0ID0gdGhhdC5zaXplLmhlaWdodCArXG5cdFx0XHRcdCggdGhhdC5faGVscGVyID9cblx0XHRcdFx0XHQoIHRoYXQucG9zaXRpb24udG9wIC0gY28udG9wICkgOlxuXHRcdFx0XHRcdHRoYXQucG9zaXRpb24udG9wICk7XG5cblx0XHRcdGlmICggcFJhdGlvICkge1xuXHRcdFx0XHR0aGF0LnNpemUud2lkdGggPSB0aGF0LnNpemUuaGVpZ2h0ICogdGhhdC5hc3BlY3RSYXRpbztcblx0XHRcdFx0Y29udGludWVSZXNpemUgPSBmYWxzZTtcblx0XHRcdH1cblx0XHRcdHRoYXQucG9zaXRpb24udG9wID0gdGhhdC5faGVscGVyID8gY28udG9wIDogMDtcblx0XHR9XG5cblx0XHRpc1BhcmVudCA9IHRoYXQuY29udGFpbmVyRWxlbWVudC5nZXQoIDAgKSA9PT0gdGhhdC5lbGVtZW50LnBhcmVudCgpLmdldCggMCApO1xuXHRcdGlzT2Zmc2V0UmVsYXRpdmUgPSAvcmVsYXRpdmV8YWJzb2x1dGUvLnRlc3QoIHRoYXQuY29udGFpbmVyRWxlbWVudC5jc3MoIFwicG9zaXRpb25cIiApICk7XG5cblx0XHRpZiAoIGlzUGFyZW50ICYmIGlzT2Zmc2V0UmVsYXRpdmUgKSB7XG5cdFx0XHR0aGF0Lm9mZnNldC5sZWZ0ID0gdGhhdC5wYXJlbnREYXRhLmxlZnQgKyB0aGF0LnBvc2l0aW9uLmxlZnQ7XG5cdFx0XHR0aGF0Lm9mZnNldC50b3AgPSB0aGF0LnBhcmVudERhdGEudG9wICsgdGhhdC5wb3NpdGlvbi50b3A7XG5cdFx0fSBlbHNlIHtcblx0XHRcdHRoYXQub2Zmc2V0LmxlZnQgPSB0aGF0LmVsZW1lbnQub2Zmc2V0KCkubGVmdDtcblx0XHRcdHRoYXQub2Zmc2V0LnRvcCA9IHRoYXQuZWxlbWVudC5vZmZzZXQoKS50b3A7XG5cdFx0fVxuXG5cdFx0d29zZXQgPSBNYXRoLmFicyggdGhhdC5zaXplRGlmZi53aWR0aCArXG5cdFx0XHQoIHRoYXQuX2hlbHBlciA/XG5cdFx0XHRcdHRoYXQub2Zmc2V0LmxlZnQgLSBjb3AubGVmdCA6XG5cdFx0XHRcdCggdGhhdC5vZmZzZXQubGVmdCAtIGNvLmxlZnQgKSApICk7XG5cblx0XHRob3NldCA9IE1hdGguYWJzKCB0aGF0LnNpemVEaWZmLmhlaWdodCArXG5cdFx0XHQoIHRoYXQuX2hlbHBlciA/XG5cdFx0XHRcdHRoYXQub2Zmc2V0LnRvcCAtIGNvcC50b3AgOlxuXHRcdFx0XHQoIHRoYXQub2Zmc2V0LnRvcCAtIGNvLnRvcCApICkgKTtcblxuXHRcdGlmICggd29zZXQgKyB0aGF0LnNpemUud2lkdGggPj0gdGhhdC5wYXJlbnREYXRhLndpZHRoICkge1xuXHRcdFx0dGhhdC5zaXplLndpZHRoID0gdGhhdC5wYXJlbnREYXRhLndpZHRoIC0gd29zZXQ7XG5cdFx0XHRpZiAoIHBSYXRpbyApIHtcblx0XHRcdFx0dGhhdC5zaXplLmhlaWdodCA9IHRoYXQuc2l6ZS53aWR0aCAvIHRoYXQuYXNwZWN0UmF0aW87XG5cdFx0XHRcdGNvbnRpbnVlUmVzaXplID0gZmFsc2U7XG5cdFx0XHR9XG5cdFx0fVxuXG5cdFx0aWYgKCBob3NldCArIHRoYXQuc2l6ZS5oZWlnaHQgPj0gdGhhdC5wYXJlbnREYXRhLmhlaWdodCApIHtcblx0XHRcdHRoYXQuc2l6ZS5oZWlnaHQgPSB0aGF0LnBhcmVudERhdGEuaGVpZ2h0IC0gaG9zZXQ7XG5cdFx0XHRpZiAoIHBSYXRpbyApIHtcblx0XHRcdFx0dGhhdC5zaXplLndpZHRoID0gdGhhdC5zaXplLmhlaWdodCAqIHRoYXQuYXNwZWN0UmF0aW87XG5cdFx0XHRcdGNvbnRpbnVlUmVzaXplID0gZmFsc2U7XG5cdFx0XHR9XG5cdFx0fVxuXG5cdFx0aWYgKCAhY29udGludWVSZXNpemUgKSB7XG5cdFx0XHR0aGF0LnBvc2l0aW9uLmxlZnQgPSB0aGF0LnByZXZQb3NpdGlvbi5sZWZ0O1xuXHRcdFx0dGhhdC5wb3NpdGlvbi50b3AgPSB0aGF0LnByZXZQb3NpdGlvbi50b3A7XG5cdFx0XHR0aGF0LnNpemUud2lkdGggPSB0aGF0LnByZXZTaXplLndpZHRoO1xuXHRcdFx0dGhhdC5zaXplLmhlaWdodCA9IHRoYXQucHJldlNpemUuaGVpZ2h0O1xuXHRcdH1cblx0fSxcblxuXHRzdG9wOiBmdW5jdGlvbigpIHtcblx0XHR2YXIgdGhhdCA9ICQoIHRoaXMgKS5yZXNpemFibGUoIFwiaW5zdGFuY2VcIiApLFxuXHRcdFx0byA9IHRoYXQub3B0aW9ucyxcblx0XHRcdGNvID0gdGhhdC5jb250YWluZXJPZmZzZXQsXG5cdFx0XHRjb3AgPSB0aGF0LmNvbnRhaW5lclBvc2l0aW9uLFxuXHRcdFx0Y2UgPSB0aGF0LmNvbnRhaW5lckVsZW1lbnQsXG5cdFx0XHRoZWxwZXIgPSAkKCB0aGF0LmhlbHBlciApLFxuXHRcdFx0aG8gPSBoZWxwZXIub2Zmc2V0KCksXG5cdFx0XHR3ID0gaGVscGVyLm91dGVyV2lkdGgoKSAtIHRoYXQuc2l6ZURpZmYud2lkdGgsXG5cdFx0XHRoID0gaGVscGVyLm91dGVySGVpZ2h0KCkgLSB0aGF0LnNpemVEaWZmLmhlaWdodDtcblxuXHRcdGlmICggdGhhdC5faGVscGVyICYmICFvLmFuaW1hdGUgJiYgKCAvcmVsYXRpdmUvICkudGVzdCggY2UuY3NzKCBcInBvc2l0aW9uXCIgKSApICkge1xuXHRcdFx0JCggdGhpcyApLmNzcygge1xuXHRcdFx0XHRsZWZ0OiBoby5sZWZ0IC0gY29wLmxlZnQgLSBjby5sZWZ0LFxuXHRcdFx0XHR3aWR0aDogdyxcblx0XHRcdFx0aGVpZ2h0OiBoXG5cdFx0XHR9ICk7XG5cdFx0fVxuXG5cdFx0aWYgKCB0aGF0Ll9oZWxwZXIgJiYgIW8uYW5pbWF0ZSAmJiAoIC9zdGF0aWMvICkudGVzdCggY2UuY3NzKCBcInBvc2l0aW9uXCIgKSApICkge1xuXHRcdFx0JCggdGhpcyApLmNzcygge1xuXHRcdFx0XHRsZWZ0OiBoby5sZWZ0IC0gY29wLmxlZnQgLSBjby5sZWZ0LFxuXHRcdFx0XHR3aWR0aDogdyxcblx0XHRcdFx0aGVpZ2h0OiBoXG5cdFx0XHR9ICk7XG5cdFx0fVxuXHR9XG59ICk7XG5cbiQudWkucGx1Z2luLmFkZCggXCJyZXNpemFibGVcIiwgXCJhbHNvUmVzaXplXCIsIHtcblxuXHRzdGFydDogZnVuY3Rpb24oKSB7XG5cdFx0dmFyIHRoYXQgPSAkKCB0aGlzICkucmVzaXphYmxlKCBcImluc3RhbmNlXCIgKSxcblx0XHRcdG8gPSB0aGF0Lm9wdGlvbnM7XG5cblx0XHQkKCBvLmFsc29SZXNpemUgKS5lYWNoKCBmdW5jdGlvbigpIHtcblx0XHRcdHZhciBlbCA9ICQoIHRoaXMgKTtcblx0XHRcdGVsLmRhdGEoIFwidWktcmVzaXphYmxlLWFsc29yZXNpemVcIiwge1xuXHRcdFx0XHR3aWR0aDogcGFyc2VGbG9hdCggZWwud2lkdGgoKSApLCBoZWlnaHQ6IHBhcnNlRmxvYXQoIGVsLmhlaWdodCgpICksXG5cdFx0XHRcdGxlZnQ6IHBhcnNlRmxvYXQoIGVsLmNzcyggXCJsZWZ0XCIgKSApLCB0b3A6IHBhcnNlRmxvYXQoIGVsLmNzcyggXCJ0b3BcIiApIClcblx0XHRcdH0gKTtcblx0XHR9ICk7XG5cdH0sXG5cblx0cmVzaXplOiBmdW5jdGlvbiggZXZlbnQsIHVpICkge1xuXHRcdHZhciB0aGF0ID0gJCggdGhpcyApLnJlc2l6YWJsZSggXCJpbnN0YW5jZVwiICksXG5cdFx0XHRvID0gdGhhdC5vcHRpb25zLFxuXHRcdFx0b3MgPSB0aGF0Lm9yaWdpbmFsU2l6ZSxcblx0XHRcdG9wID0gdGhhdC5vcmlnaW5hbFBvc2l0aW9uLFxuXHRcdFx0ZGVsdGEgPSB7XG5cdFx0XHRcdGhlaWdodDogKCB0aGF0LnNpemUuaGVpZ2h0IC0gb3MuaGVpZ2h0ICkgfHwgMCxcblx0XHRcdFx0d2lkdGg6ICggdGhhdC5zaXplLndpZHRoIC0gb3Mud2lkdGggKSB8fCAwLFxuXHRcdFx0XHR0b3A6ICggdGhhdC5wb3NpdGlvbi50b3AgLSBvcC50b3AgKSB8fCAwLFxuXHRcdFx0XHRsZWZ0OiAoIHRoYXQucG9zaXRpb24ubGVmdCAtIG9wLmxlZnQgKSB8fCAwXG5cdFx0XHR9O1xuXG5cdFx0XHQkKCBvLmFsc29SZXNpemUgKS5lYWNoKCBmdW5jdGlvbigpIHtcblx0XHRcdFx0dmFyIGVsID0gJCggdGhpcyApLCBzdGFydCA9ICQoIHRoaXMgKS5kYXRhKCBcInVpLXJlc2l6YWJsZS1hbHNvcmVzaXplXCIgKSwgc3R5bGUgPSB7fSxcblx0XHRcdFx0XHRjc3MgPSBlbC5wYXJlbnRzKCB1aS5vcmlnaW5hbEVsZW1lbnRbIDAgXSApLmxlbmd0aCA/XG5cdFx0XHRcdFx0XHRcdFsgXCJ3aWR0aFwiLCBcImhlaWdodFwiIF0gOlxuXHRcdFx0XHRcdFx0XHRbIFwid2lkdGhcIiwgXCJoZWlnaHRcIiwgXCJ0b3BcIiwgXCJsZWZ0XCIgXTtcblxuXHRcdFx0XHQkLmVhY2goIGNzcywgZnVuY3Rpb24oIGksIHByb3AgKSB7XG5cdFx0XHRcdFx0dmFyIHN1bSA9ICggc3RhcnRbIHByb3AgXSB8fCAwICkgKyAoIGRlbHRhWyBwcm9wIF0gfHwgMCApO1xuXHRcdFx0XHRcdGlmICggc3VtICYmIHN1bSA+PSAwICkge1xuXHRcdFx0XHRcdFx0c3R5bGVbIHByb3AgXSA9IHN1bSB8fCBudWxsO1xuXHRcdFx0XHRcdH1cblx0XHRcdFx0fSApO1xuXG5cdFx0XHRcdGVsLmNzcyggc3R5bGUgKTtcblx0XHRcdH0gKTtcblx0fSxcblxuXHRzdG9wOiBmdW5jdGlvbigpIHtcblx0XHQkKCB0aGlzICkucmVtb3ZlRGF0YSggXCJ1aS1yZXNpemFibGUtYWxzb3Jlc2l6ZVwiICk7XG5cdH1cbn0gKTtcblxuJC51aS5wbHVnaW4uYWRkKCBcInJlc2l6YWJsZVwiLCBcImdob3N0XCIsIHtcblxuXHRzdGFydDogZnVuY3Rpb24oKSB7XG5cblx0XHR2YXIgdGhhdCA9ICQoIHRoaXMgKS5yZXNpemFibGUoIFwiaW5zdGFuY2VcIiApLCBjcyA9IHRoYXQuc2l6ZTtcblxuXHRcdHRoYXQuZ2hvc3QgPSB0aGF0Lm9yaWdpbmFsRWxlbWVudC5jbG9uZSgpO1xuXHRcdHRoYXQuZ2hvc3QuY3NzKCB7XG5cdFx0XHRvcGFjaXR5OiAwLjI1LFxuXHRcdFx0ZGlzcGxheTogXCJibG9ja1wiLFxuXHRcdFx0cG9zaXRpb246IFwicmVsYXRpdmVcIixcblx0XHRcdGhlaWdodDogY3MuaGVpZ2h0LFxuXHRcdFx0d2lkdGg6IGNzLndpZHRoLFxuXHRcdFx0bWFyZ2luOiAwLFxuXHRcdFx0bGVmdDogMCxcblx0XHRcdHRvcDogMFxuXHRcdH0gKTtcblxuXHRcdHRoYXQuX2FkZENsYXNzKCB0aGF0Lmdob3N0LCBcInVpLXJlc2l6YWJsZS1naG9zdFwiICk7XG5cblx0XHQvLyBERVBSRUNBVEVEXG5cdFx0Ly8gVE9ETzogcmVtb3ZlIGFmdGVyIDEuMTJcblx0XHRpZiAoICQudWlCYWNrQ29tcGF0ICE9PSBmYWxzZSAmJiB0eXBlb2YgdGhhdC5vcHRpb25zLmdob3N0ID09PSBcInN0cmluZ1wiICkge1xuXG5cdFx0XHQvLyBHaG9zdCBvcHRpb25cblx0XHRcdHRoYXQuZ2hvc3QuYWRkQ2xhc3MoIHRoaXMub3B0aW9ucy5naG9zdCApO1xuXHRcdH1cblxuXHRcdHRoYXQuZ2hvc3QuYXBwZW5kVG8oIHRoYXQuaGVscGVyICk7XG5cblx0fSxcblxuXHRyZXNpemU6IGZ1bmN0aW9uKCkge1xuXHRcdHZhciB0aGF0ID0gJCggdGhpcyApLnJlc2l6YWJsZSggXCJpbnN0YW5jZVwiICk7XG5cdFx0aWYgKCB0aGF0Lmdob3N0ICkge1xuXHRcdFx0dGhhdC5naG9zdC5jc3MoIHtcblx0XHRcdFx0cG9zaXRpb246IFwicmVsYXRpdmVcIixcblx0XHRcdFx0aGVpZ2h0OiB0aGF0LnNpemUuaGVpZ2h0LFxuXHRcdFx0XHR3aWR0aDogdGhhdC5zaXplLndpZHRoXG5cdFx0XHR9ICk7XG5cdFx0fVxuXHR9LFxuXG5cdHN0b3A6IGZ1bmN0aW9uKCkge1xuXHRcdHZhciB0aGF0ID0gJCggdGhpcyApLnJlc2l6YWJsZSggXCJpbnN0YW5jZVwiICk7XG5cdFx0aWYgKCB0aGF0Lmdob3N0ICYmIHRoYXQuaGVscGVyICkge1xuXHRcdFx0dGhhdC5oZWxwZXIuZ2V0KCAwICkucmVtb3ZlQ2hpbGQoIHRoYXQuZ2hvc3QuZ2V0KCAwICkgKTtcblx0XHR9XG5cdH1cblxufSApO1xuXG4kLnVpLnBsdWdpbi5hZGQoIFwicmVzaXphYmxlXCIsIFwiZ3JpZFwiLCB7XG5cblx0cmVzaXplOiBmdW5jdGlvbigpIHtcblx0XHR2YXIgb3V0ZXJEaW1lbnNpb25zLFxuXHRcdFx0dGhhdCA9ICQoIHRoaXMgKS5yZXNpemFibGUoIFwiaW5zdGFuY2VcIiApLFxuXHRcdFx0byA9IHRoYXQub3B0aW9ucyxcblx0XHRcdGNzID0gdGhhdC5zaXplLFxuXHRcdFx0b3MgPSB0aGF0Lm9yaWdpbmFsU2l6ZSxcblx0XHRcdG9wID0gdGhhdC5vcmlnaW5hbFBvc2l0aW9uLFxuXHRcdFx0YSA9IHRoYXQuYXhpcyxcblx0XHRcdGdyaWQgPSB0eXBlb2Ygby5ncmlkID09PSBcIm51bWJlclwiID8gWyBvLmdyaWQsIG8uZ3JpZCBdIDogby5ncmlkLFxuXHRcdFx0Z3JpZFggPSAoIGdyaWRbIDAgXSB8fCAxICksXG5cdFx0XHRncmlkWSA9ICggZ3JpZFsgMSBdIHx8IDEgKSxcblx0XHRcdG94ID0gTWF0aC5yb3VuZCggKCBjcy53aWR0aCAtIG9zLndpZHRoICkgLyBncmlkWCApICogZ3JpZFgsXG5cdFx0XHRveSA9IE1hdGgucm91bmQoICggY3MuaGVpZ2h0IC0gb3MuaGVpZ2h0ICkgLyBncmlkWSApICogZ3JpZFksXG5cdFx0XHRuZXdXaWR0aCA9IG9zLndpZHRoICsgb3gsXG5cdFx0XHRuZXdIZWlnaHQgPSBvcy5oZWlnaHQgKyBveSxcblx0XHRcdGlzTWF4V2lkdGggPSBvLm1heFdpZHRoICYmICggby5tYXhXaWR0aCA8IG5ld1dpZHRoICksXG5cdFx0XHRpc01heEhlaWdodCA9IG8ubWF4SGVpZ2h0ICYmICggby5tYXhIZWlnaHQgPCBuZXdIZWlnaHQgKSxcblx0XHRcdGlzTWluV2lkdGggPSBvLm1pbldpZHRoICYmICggby5taW5XaWR0aCA+IG5ld1dpZHRoICksXG5cdFx0XHRpc01pbkhlaWdodCA9IG8ubWluSGVpZ2h0ICYmICggby5taW5IZWlnaHQgPiBuZXdIZWlnaHQgKTtcblxuXHRcdG8uZ3JpZCA9IGdyaWQ7XG5cblx0XHRpZiAoIGlzTWluV2lkdGggKSB7XG5cdFx0XHRuZXdXaWR0aCArPSBncmlkWDtcblx0XHR9XG5cdFx0aWYgKCBpc01pbkhlaWdodCApIHtcblx0XHRcdG5ld0hlaWdodCArPSBncmlkWTtcblx0XHR9XG5cdFx0aWYgKCBpc01heFdpZHRoICkge1xuXHRcdFx0bmV3V2lkdGggLT0gZ3JpZFg7XG5cdFx0fVxuXHRcdGlmICggaXNNYXhIZWlnaHQgKSB7XG5cdFx0XHRuZXdIZWlnaHQgLT0gZ3JpZFk7XG5cdFx0fVxuXG5cdFx0aWYgKCAvXihzZXxzfGUpJC8udGVzdCggYSApICkge1xuXHRcdFx0dGhhdC5zaXplLndpZHRoID0gbmV3V2lkdGg7XG5cdFx0XHR0aGF0LnNpemUuaGVpZ2h0ID0gbmV3SGVpZ2h0O1xuXHRcdH0gZWxzZSBpZiAoIC9eKG5lKSQvLnRlc3QoIGEgKSApIHtcblx0XHRcdHRoYXQuc2l6ZS53aWR0aCA9IG5ld1dpZHRoO1xuXHRcdFx0dGhhdC5zaXplLmhlaWdodCA9IG5ld0hlaWdodDtcblx0XHRcdHRoYXQucG9zaXRpb24udG9wID0gb3AudG9wIC0gb3k7XG5cdFx0fSBlbHNlIGlmICggL14oc3cpJC8udGVzdCggYSApICkge1xuXHRcdFx0dGhhdC5zaXplLndpZHRoID0gbmV3V2lkdGg7XG5cdFx0XHR0aGF0LnNpemUuaGVpZ2h0ID0gbmV3SGVpZ2h0O1xuXHRcdFx0dGhhdC5wb3NpdGlvbi5sZWZ0ID0gb3AubGVmdCAtIG94O1xuXHRcdH0gZWxzZSB7XG5cdFx0XHRpZiAoIG5ld0hlaWdodCAtIGdyaWRZIDw9IDAgfHwgbmV3V2lkdGggLSBncmlkWCA8PSAwICkge1xuXHRcdFx0XHRvdXRlckRpbWVuc2lvbnMgPSB0aGF0Ll9nZXRQYWRkaW5nUGx1c0JvcmRlckRpbWVuc2lvbnMoIHRoaXMgKTtcblx0XHRcdH1cblxuXHRcdFx0aWYgKCBuZXdIZWlnaHQgLSBncmlkWSA+IDAgKSB7XG5cdFx0XHRcdHRoYXQuc2l6ZS5oZWlnaHQgPSBuZXdIZWlnaHQ7XG5cdFx0XHRcdHRoYXQucG9zaXRpb24udG9wID0gb3AudG9wIC0gb3k7XG5cdFx0XHR9IGVsc2Uge1xuXHRcdFx0XHRuZXdIZWlnaHQgPSBncmlkWSAtIG91dGVyRGltZW5zaW9ucy5oZWlnaHQ7XG5cdFx0XHRcdHRoYXQuc2l6ZS5oZWlnaHQgPSBuZXdIZWlnaHQ7XG5cdFx0XHRcdHRoYXQucG9zaXRpb24udG9wID0gb3AudG9wICsgb3MuaGVpZ2h0IC0gbmV3SGVpZ2h0O1xuXHRcdFx0fVxuXHRcdFx0aWYgKCBuZXdXaWR0aCAtIGdyaWRYID4gMCApIHtcblx0XHRcdFx0dGhhdC5zaXplLndpZHRoID0gbmV3V2lkdGg7XG5cdFx0XHRcdHRoYXQucG9zaXRpb24ubGVmdCA9IG9wLmxlZnQgLSBveDtcblx0XHRcdH0gZWxzZSB7XG5cdFx0XHRcdG5ld1dpZHRoID0gZ3JpZFggLSBvdXRlckRpbWVuc2lvbnMud2lkdGg7XG5cdFx0XHRcdHRoYXQuc2l6ZS53aWR0aCA9IG5ld1dpZHRoO1xuXHRcdFx0XHR0aGF0LnBvc2l0aW9uLmxlZnQgPSBvcC5sZWZ0ICsgb3Mud2lkdGggLSBuZXdXaWR0aDtcblx0XHRcdH1cblx0XHR9XG5cdH1cblxufSApO1xuXG5yZXR1cm4gJC51aS5yZXNpemFibGU7XG5cbn0gKSApO1xuIiwiLyohXG4gKiBqUXVlcnkgVUkgU3Bpbm5lciAxLjEyLjFcbiAqIGh0dHA6Ly9qcXVlcnl1aS5jb21cbiAqXG4gKiBDb3B5cmlnaHQgalF1ZXJ5IEZvdW5kYXRpb24gYW5kIG90aGVyIGNvbnRyaWJ1dG9yc1xuICogUmVsZWFzZWQgdW5kZXIgdGhlIE1JVCBsaWNlbnNlLlxuICogaHR0cDovL2pxdWVyeS5vcmcvbGljZW5zZVxuICovXG5cbi8vPj5sYWJlbDogU3Bpbm5lclxuLy8+Pmdyb3VwOiBXaWRnZXRzXG4vLz4+ZGVzY3JpcHRpb246IERpc3BsYXlzIGJ1dHRvbnMgdG8gZWFzaWx5IGlucHV0IG51bWJlcnMgdmlhIHRoZSBrZXlib2FyZCBvciBtb3VzZS5cbi8vPj5kb2NzOiBodHRwOi8vYXBpLmpxdWVyeXVpLmNvbS9zcGlubmVyL1xuLy8+PmRlbW9zOiBodHRwOi8vanF1ZXJ5dWkuY29tL3NwaW5uZXIvXG4vLz4+Y3NzLnN0cnVjdHVyZTogLi4vLi4vdGhlbWVzL2Jhc2UvY29yZS5jc3Ncbi8vPj5jc3Muc3RydWN0dXJlOiAuLi8uLi90aGVtZXMvYmFzZS9zcGlubmVyLmNzc1xuLy8+PmNzcy50aGVtZTogLi4vLi4vdGhlbWVzL2Jhc2UvdGhlbWUuY3NzXG5cbiggZnVuY3Rpb24oIGZhY3RvcnkgKSB7XG5cdGlmICggdHlwZW9mIGRlZmluZSA9PT0gXCJmdW5jdGlvblwiICYmIGRlZmluZS5hbWQgKSB7XG5cblx0XHQvLyBBTUQuIFJlZ2lzdGVyIGFzIGFuIGFub255bW91cyBtb2R1bGUuXG5cdFx0ZGVmaW5lKCBbXG5cdFx0XHRcImpxdWVyeVwiLFxuXHRcdFx0XCIuL2J1dHRvblwiLFxuXHRcdFx0XCIuLi92ZXJzaW9uXCIsXG5cdFx0XHRcIi4uL2tleWNvZGVcIixcblx0XHRcdFwiLi4vc2FmZS1hY3RpdmUtZWxlbWVudFwiLFxuXHRcdFx0XCIuLi93aWRnZXRcIlxuXHRcdF0sIGZhY3RvcnkgKTtcblx0fSBlbHNlIHtcblxuXHRcdC8vIEJyb3dzZXIgZ2xvYmFsc1xuXHRcdGZhY3RvcnkoIGpRdWVyeSApO1xuXHR9XG59KCBmdW5jdGlvbiggJCApIHtcblxuZnVuY3Rpb24gc3Bpbm5lck1vZGlmZXIoIGZuICkge1xuXHRyZXR1cm4gZnVuY3Rpb24oKSB7XG5cdFx0dmFyIHByZXZpb3VzID0gdGhpcy5lbGVtZW50LnZhbCgpO1xuXHRcdGZuLmFwcGx5KCB0aGlzLCBhcmd1bWVudHMgKTtcblx0XHR0aGlzLl9yZWZyZXNoKCk7XG5cdFx0aWYgKCBwcmV2aW91cyAhPT0gdGhpcy5lbGVtZW50LnZhbCgpICkge1xuXHRcdFx0dGhpcy5fdHJpZ2dlciggXCJjaGFuZ2VcIiApO1xuXHRcdH1cblx0fTtcbn1cblxuJC53aWRnZXQoIFwidWkuc3Bpbm5lclwiLCB7XG5cdHZlcnNpb246IFwiMS4xMi4xXCIsXG5cdGRlZmF1bHRFbGVtZW50OiBcIjxpbnB1dD5cIixcblx0d2lkZ2V0RXZlbnRQcmVmaXg6IFwic3BpblwiLFxuXHRvcHRpb25zOiB7XG5cdFx0Y2xhc3Nlczoge1xuXHRcdFx0XCJ1aS1zcGlubmVyXCI6IFwidWktY29ybmVyLWFsbFwiLFxuXHRcdFx0XCJ1aS1zcGlubmVyLWRvd25cIjogXCJ1aS1jb3JuZXItYnJcIixcblx0XHRcdFwidWktc3Bpbm5lci11cFwiOiBcInVpLWNvcm5lci10clwiXG5cdFx0fSxcblx0XHRjdWx0dXJlOiBudWxsLFxuXHRcdGljb25zOiB7XG5cdFx0XHRkb3duOiBcInVpLWljb24tdHJpYW5nbGUtMS1zXCIsXG5cdFx0XHR1cDogXCJ1aS1pY29uLXRyaWFuZ2xlLTEtblwiXG5cdFx0fSxcblx0XHRpbmNyZW1lbnRhbDogdHJ1ZSxcblx0XHRtYXg6IG51bGwsXG5cdFx0bWluOiBudWxsLFxuXHRcdG51bWJlckZvcm1hdDogbnVsbCxcblx0XHRwYWdlOiAxMCxcblx0XHRzdGVwOiAxLFxuXG5cdFx0Y2hhbmdlOiBudWxsLFxuXHRcdHNwaW46IG51bGwsXG5cdFx0c3RhcnQ6IG51bGwsXG5cdFx0c3RvcDogbnVsbFxuXHR9LFxuXG5cdF9jcmVhdGU6IGZ1bmN0aW9uKCkge1xuXG5cdFx0Ly8gaGFuZGxlIHN0cmluZyB2YWx1ZXMgdGhhdCBuZWVkIHRvIGJlIHBhcnNlZFxuXHRcdHRoaXMuX3NldE9wdGlvbiggXCJtYXhcIiwgdGhpcy5vcHRpb25zLm1heCApO1xuXHRcdHRoaXMuX3NldE9wdGlvbiggXCJtaW5cIiwgdGhpcy5vcHRpb25zLm1pbiApO1xuXHRcdHRoaXMuX3NldE9wdGlvbiggXCJzdGVwXCIsIHRoaXMub3B0aW9ucy5zdGVwICk7XG5cblx0XHQvLyBPbmx5IGZvcm1hdCBpZiB0aGVyZSBpcyBhIHZhbHVlLCBwcmV2ZW50cyB0aGUgZmllbGQgZnJvbSBiZWluZyBtYXJrZWRcblx0XHQvLyBhcyBpbnZhbGlkIGluIEZpcmVmb3gsIHNlZSAjOTU3My5cblx0XHRpZiAoIHRoaXMudmFsdWUoKSAhPT0gXCJcIiApIHtcblxuXHRcdFx0Ly8gRm9ybWF0IHRoZSB2YWx1ZSwgYnV0IGRvbid0IGNvbnN0cmFpbi5cblx0XHRcdHRoaXMuX3ZhbHVlKCB0aGlzLmVsZW1lbnQudmFsKCksIHRydWUgKTtcblx0XHR9XG5cblx0XHR0aGlzLl9kcmF3KCk7XG5cdFx0dGhpcy5fb24oIHRoaXMuX2V2ZW50cyApO1xuXHRcdHRoaXMuX3JlZnJlc2goKTtcblxuXHRcdC8vIFR1cm5pbmcgb2ZmIGF1dG9jb21wbGV0ZSBwcmV2ZW50cyB0aGUgYnJvd3NlciBmcm9tIHJlbWVtYmVyaW5nIHRoZVxuXHRcdC8vIHZhbHVlIHdoZW4gbmF2aWdhdGluZyB0aHJvdWdoIGhpc3RvcnksIHNvIHdlIHJlLWVuYWJsZSBhdXRvY29tcGxldGVcblx0XHQvLyBpZiB0aGUgcGFnZSBpcyB1bmxvYWRlZCBiZWZvcmUgdGhlIHdpZGdldCBpcyBkZXN0cm95ZWQuICM3NzkwXG5cdFx0dGhpcy5fb24oIHRoaXMud2luZG93LCB7XG5cdFx0XHRiZWZvcmV1bmxvYWQ6IGZ1bmN0aW9uKCkge1xuXHRcdFx0XHR0aGlzLmVsZW1lbnQucmVtb3ZlQXR0ciggXCJhdXRvY29tcGxldGVcIiApO1xuXHRcdFx0fVxuXHRcdH0gKTtcblx0fSxcblxuXHRfZ2V0Q3JlYXRlT3B0aW9uczogZnVuY3Rpb24oKSB7XG5cdFx0dmFyIG9wdGlvbnMgPSB0aGlzLl9zdXBlcigpO1xuXHRcdHZhciBlbGVtZW50ID0gdGhpcy5lbGVtZW50O1xuXG5cdFx0JC5lYWNoKCBbIFwibWluXCIsIFwibWF4XCIsIFwic3RlcFwiIF0sIGZ1bmN0aW9uKCBpLCBvcHRpb24gKSB7XG5cdFx0XHR2YXIgdmFsdWUgPSBlbGVtZW50LmF0dHIoIG9wdGlvbiApO1xuXHRcdFx0aWYgKCB2YWx1ZSAhPSBudWxsICYmIHZhbHVlLmxlbmd0aCApIHtcblx0XHRcdFx0b3B0aW9uc1sgb3B0aW9uIF0gPSB2YWx1ZTtcblx0XHRcdH1cblx0XHR9ICk7XG5cblx0XHRyZXR1cm4gb3B0aW9ucztcblx0fSxcblxuXHRfZXZlbnRzOiB7XG5cdFx0a2V5ZG93bjogZnVuY3Rpb24oIGV2ZW50ICkge1xuXHRcdFx0aWYgKCB0aGlzLl9zdGFydCggZXZlbnQgKSAmJiB0aGlzLl9rZXlkb3duKCBldmVudCApICkge1xuXHRcdFx0XHRldmVudC5wcmV2ZW50RGVmYXVsdCgpO1xuXHRcdFx0fVxuXHRcdH0sXG5cdFx0a2V5dXA6IFwiX3N0b3BcIixcblx0XHRmb2N1czogZnVuY3Rpb24oKSB7XG5cdFx0XHR0aGlzLnByZXZpb3VzID0gdGhpcy5lbGVtZW50LnZhbCgpO1xuXHRcdH0sXG5cdFx0Ymx1cjogZnVuY3Rpb24oIGV2ZW50ICkge1xuXHRcdFx0aWYgKCB0aGlzLmNhbmNlbEJsdXIgKSB7XG5cdFx0XHRcdGRlbGV0ZSB0aGlzLmNhbmNlbEJsdXI7XG5cdFx0XHRcdHJldHVybjtcblx0XHRcdH1cblxuXHRcdFx0dGhpcy5fc3RvcCgpO1xuXHRcdFx0dGhpcy5fcmVmcmVzaCgpO1xuXHRcdFx0aWYgKCB0aGlzLnByZXZpb3VzICE9PSB0aGlzLmVsZW1lbnQudmFsKCkgKSB7XG5cdFx0XHRcdHRoaXMuX3RyaWdnZXIoIFwiY2hhbmdlXCIsIGV2ZW50ICk7XG5cdFx0XHR9XG5cdFx0fSxcblx0XHRtb3VzZXdoZWVsOiBmdW5jdGlvbiggZXZlbnQsIGRlbHRhICkge1xuXHRcdFx0aWYgKCAhZGVsdGEgKSB7XG5cdFx0XHRcdHJldHVybjtcblx0XHRcdH1cblx0XHRcdGlmICggIXRoaXMuc3Bpbm5pbmcgJiYgIXRoaXMuX3N0YXJ0KCBldmVudCApICkge1xuXHRcdFx0XHRyZXR1cm4gZmFsc2U7XG5cdFx0XHR9XG5cblx0XHRcdHRoaXMuX3NwaW4oICggZGVsdGEgPiAwID8gMSA6IC0xICkgKiB0aGlzLm9wdGlvbnMuc3RlcCwgZXZlbnQgKTtcblx0XHRcdGNsZWFyVGltZW91dCggdGhpcy5tb3VzZXdoZWVsVGltZXIgKTtcblx0XHRcdHRoaXMubW91c2V3aGVlbFRpbWVyID0gdGhpcy5fZGVsYXkoIGZ1bmN0aW9uKCkge1xuXHRcdFx0XHRpZiAoIHRoaXMuc3Bpbm5pbmcgKSB7XG5cdFx0XHRcdFx0dGhpcy5fc3RvcCggZXZlbnQgKTtcblx0XHRcdFx0fVxuXHRcdFx0fSwgMTAwICk7XG5cdFx0XHRldmVudC5wcmV2ZW50RGVmYXVsdCgpO1xuXHRcdH0sXG5cdFx0XCJtb3VzZWRvd24gLnVpLXNwaW5uZXItYnV0dG9uXCI6IGZ1bmN0aW9uKCBldmVudCApIHtcblx0XHRcdHZhciBwcmV2aW91cztcblxuXHRcdFx0Ly8gV2UgbmV2ZXIgd2FudCB0aGUgYnV0dG9ucyB0byBoYXZlIGZvY3VzOyB3aGVuZXZlciB0aGUgdXNlciBpc1xuXHRcdFx0Ly8gaW50ZXJhY3Rpbmcgd2l0aCB0aGUgc3Bpbm5lciwgdGhlIGZvY3VzIHNob3VsZCBiZSBvbiB0aGUgaW5wdXQuXG5cdFx0XHQvLyBJZiB0aGUgaW5wdXQgaXMgZm9jdXNlZCB0aGVuIHRoaXMucHJldmlvdXMgaXMgcHJvcGVybHkgc2V0IGZyb21cblx0XHRcdC8vIHdoZW4gdGhlIGlucHV0IGZpcnN0IHJlY2VpdmVkIGZvY3VzLiBJZiB0aGUgaW5wdXQgaXMgbm90IGZvY3VzZWRcblx0XHRcdC8vIHRoZW4gd2UgbmVlZCB0byBzZXQgdGhpcy5wcmV2aW91cyBiYXNlZCBvbiB0aGUgdmFsdWUgYmVmb3JlIHNwaW5uaW5nLlxuXHRcdFx0cHJldmlvdXMgPSB0aGlzLmVsZW1lbnRbIDAgXSA9PT0gJC51aS5zYWZlQWN0aXZlRWxlbWVudCggdGhpcy5kb2N1bWVudFsgMCBdICkgP1xuXHRcdFx0XHR0aGlzLnByZXZpb3VzIDogdGhpcy5lbGVtZW50LnZhbCgpO1xuXHRcdFx0ZnVuY3Rpb24gY2hlY2tGb2N1cygpIHtcblx0XHRcdFx0dmFyIGlzQWN0aXZlID0gdGhpcy5lbGVtZW50WyAwIF0gPT09ICQudWkuc2FmZUFjdGl2ZUVsZW1lbnQoIHRoaXMuZG9jdW1lbnRbIDAgXSApO1xuXHRcdFx0XHRpZiAoICFpc0FjdGl2ZSApIHtcblx0XHRcdFx0XHR0aGlzLmVsZW1lbnQudHJpZ2dlciggXCJmb2N1c1wiICk7XG5cdFx0XHRcdFx0dGhpcy5wcmV2aW91cyA9IHByZXZpb3VzO1xuXG5cdFx0XHRcdFx0Ly8gc3VwcG9ydDogSUVcblx0XHRcdFx0XHQvLyBJRSBzZXRzIGZvY3VzIGFzeW5jaHJvbm91c2x5LCBzbyB3ZSBuZWVkIHRvIGNoZWNrIGlmIGZvY3VzXG5cdFx0XHRcdFx0Ly8gbW92ZWQgb2ZmIG9mIHRoZSBpbnB1dCBiZWNhdXNlIHRoZSB1c2VyIGNsaWNrZWQgb24gdGhlIGJ1dHRvbi5cblx0XHRcdFx0XHR0aGlzLl9kZWxheSggZnVuY3Rpb24oKSB7XG5cdFx0XHRcdFx0XHR0aGlzLnByZXZpb3VzID0gcHJldmlvdXM7XG5cdFx0XHRcdFx0fSApO1xuXHRcdFx0XHR9XG5cdFx0XHR9XG5cblx0XHRcdC8vIEVuc3VyZSBmb2N1cyBpcyBvbiAob3Igc3RheXMgb24pIHRoZSB0ZXh0IGZpZWxkXG5cdFx0XHRldmVudC5wcmV2ZW50RGVmYXVsdCgpO1xuXHRcdFx0Y2hlY2tGb2N1cy5jYWxsKCB0aGlzICk7XG5cblx0XHRcdC8vIFN1cHBvcnQ6IElFXG5cdFx0XHQvLyBJRSBkb2Vzbid0IHByZXZlbnQgbW92aW5nIGZvY3VzIGV2ZW4gd2l0aCBldmVudC5wcmV2ZW50RGVmYXVsdCgpXG5cdFx0XHQvLyBzbyB3ZSBzZXQgYSBmbGFnIHRvIGtub3cgd2hlbiB3ZSBzaG91bGQgaWdub3JlIHRoZSBibHVyIGV2ZW50XG5cdFx0XHQvLyBhbmQgY2hlY2sgKGFnYWluKSBpZiBmb2N1cyBtb3ZlZCBvZmYgb2YgdGhlIGlucHV0LlxuXHRcdFx0dGhpcy5jYW5jZWxCbHVyID0gdHJ1ZTtcblx0XHRcdHRoaXMuX2RlbGF5KCBmdW5jdGlvbigpIHtcblx0XHRcdFx0ZGVsZXRlIHRoaXMuY2FuY2VsQmx1cjtcblx0XHRcdFx0Y2hlY2tGb2N1cy5jYWxsKCB0aGlzICk7XG5cdFx0XHR9ICk7XG5cblx0XHRcdGlmICggdGhpcy5fc3RhcnQoIGV2ZW50ICkgPT09IGZhbHNlICkge1xuXHRcdFx0XHRyZXR1cm47XG5cdFx0XHR9XG5cblx0XHRcdHRoaXMuX3JlcGVhdCggbnVsbCwgJCggZXZlbnQuY3VycmVudFRhcmdldCApXG5cdFx0XHRcdC5oYXNDbGFzcyggXCJ1aS1zcGlubmVyLXVwXCIgKSA/IDEgOiAtMSwgZXZlbnQgKTtcblx0XHR9LFxuXHRcdFwibW91c2V1cCAudWktc3Bpbm5lci1idXR0b25cIjogXCJfc3RvcFwiLFxuXHRcdFwibW91c2VlbnRlciAudWktc3Bpbm5lci1idXR0b25cIjogZnVuY3Rpb24oIGV2ZW50ICkge1xuXG5cdFx0XHQvLyBidXR0b24gd2lsbCBhZGQgdWktc3RhdGUtYWN0aXZlIGlmIG1vdXNlIHdhcyBkb3duIHdoaWxlIG1vdXNlbGVhdmUgYW5kIGtlcHQgZG93blxuXHRcdFx0aWYgKCAhJCggZXZlbnQuY3VycmVudFRhcmdldCApLmhhc0NsYXNzKCBcInVpLXN0YXRlLWFjdGl2ZVwiICkgKSB7XG5cdFx0XHRcdHJldHVybjtcblx0XHRcdH1cblxuXHRcdFx0aWYgKCB0aGlzLl9zdGFydCggZXZlbnQgKSA9PT0gZmFsc2UgKSB7XG5cdFx0XHRcdHJldHVybiBmYWxzZTtcblx0XHRcdH1cblx0XHRcdHRoaXMuX3JlcGVhdCggbnVsbCwgJCggZXZlbnQuY3VycmVudFRhcmdldCApXG5cdFx0XHRcdC5oYXNDbGFzcyggXCJ1aS1zcGlubmVyLXVwXCIgKSA/IDEgOiAtMSwgZXZlbnQgKTtcblx0XHR9LFxuXG5cdFx0Ly8gVE9ETzogZG8gd2UgcmVhbGx5IHdhbnQgdG8gY29uc2lkZXIgdGhpcyBhIHN0b3A/XG5cdFx0Ly8gc2hvdWxkbid0IHdlIGp1c3Qgc3RvcCB0aGUgcmVwZWF0ZXIgYW5kIHdhaXQgdW50aWwgbW91c2V1cCBiZWZvcmVcblx0XHQvLyB3ZSB0cmlnZ2VyIHRoZSBzdG9wIGV2ZW50P1xuXHRcdFwibW91c2VsZWF2ZSAudWktc3Bpbm5lci1idXR0b25cIjogXCJfc3RvcFwiXG5cdH0sXG5cblx0Ly8gU3VwcG9ydCBtb2JpbGUgZW5oYW5jZWQgb3B0aW9uIGFuZCBtYWtlIGJhY2tjb21wYXQgbW9yZSBzYW5lXG5cdF9lbmhhbmNlOiBmdW5jdGlvbigpIHtcblx0XHR0aGlzLnVpU3Bpbm5lciA9IHRoaXMuZWxlbWVudFxuXHRcdFx0LmF0dHIoIFwiYXV0b2NvbXBsZXRlXCIsIFwib2ZmXCIgKVxuXHRcdFx0LndyYXAoIFwiPHNwYW4+XCIgKVxuXHRcdFx0LnBhcmVudCgpXG5cblx0XHRcdFx0Ly8gQWRkIGJ1dHRvbnNcblx0XHRcdFx0LmFwcGVuZChcblx0XHRcdFx0XHRcIjxhPjwvYT48YT48L2E+XCJcblx0XHRcdFx0KTtcblx0fSxcblxuXHRfZHJhdzogZnVuY3Rpb24oKSB7XG5cdFx0dGhpcy5fZW5oYW5jZSgpO1xuXG5cdFx0dGhpcy5fYWRkQ2xhc3MoIHRoaXMudWlTcGlubmVyLCBcInVpLXNwaW5uZXJcIiwgXCJ1aS13aWRnZXQgdWktd2lkZ2V0LWNvbnRlbnRcIiApO1xuXHRcdHRoaXMuX2FkZENsYXNzKCBcInVpLXNwaW5uZXItaW5wdXRcIiApO1xuXG5cdFx0dGhpcy5lbGVtZW50LmF0dHIoIFwicm9sZVwiLCBcInNwaW5idXR0b25cIiApO1xuXG5cdFx0Ly8gQnV0dG9uIGJpbmRpbmdzXG5cdFx0dGhpcy5idXR0b25zID0gdGhpcy51aVNwaW5uZXIuY2hpbGRyZW4oIFwiYVwiIClcblx0XHRcdC5hdHRyKCBcInRhYkluZGV4XCIsIC0xIClcblx0XHRcdC5hdHRyKCBcImFyaWEtaGlkZGVuXCIsIHRydWUgKVxuXHRcdFx0LmJ1dHRvbigge1xuXHRcdFx0XHRjbGFzc2VzOiB7XG5cdFx0XHRcdFx0XCJ1aS1idXR0b25cIjogXCJcIlxuXHRcdFx0XHR9XG5cdFx0XHR9ICk7XG5cblx0XHQvLyBUT0RPOiBSaWdodCBub3cgYnV0dG9uIGRvZXMgbm90IHN1cHBvcnQgY2xhc3NlcyB0aGlzIGlzIGFscmVhZHkgdXBkYXRlZCBpbiBidXR0b24gUFJcblx0XHR0aGlzLl9yZW1vdmVDbGFzcyggdGhpcy5idXR0b25zLCBcInVpLWNvcm5lci1hbGxcIiApO1xuXG5cdFx0dGhpcy5fYWRkQ2xhc3MoIHRoaXMuYnV0dG9ucy5maXJzdCgpLCBcInVpLXNwaW5uZXItYnV0dG9uIHVpLXNwaW5uZXItdXBcIiApO1xuXHRcdHRoaXMuX2FkZENsYXNzKCB0aGlzLmJ1dHRvbnMubGFzdCgpLCBcInVpLXNwaW5uZXItYnV0dG9uIHVpLXNwaW5uZXItZG93blwiICk7XG5cdFx0dGhpcy5idXR0b25zLmZpcnN0KCkuYnV0dG9uKCB7XG5cdFx0XHRcImljb25cIjogdGhpcy5vcHRpb25zLmljb25zLnVwLFxuXHRcdFx0XCJzaG93TGFiZWxcIjogZmFsc2Vcblx0XHR9ICk7XG5cdFx0dGhpcy5idXR0b25zLmxhc3QoKS5idXR0b24oIHtcblx0XHRcdFwiaWNvblwiOiB0aGlzLm9wdGlvbnMuaWNvbnMuZG93bixcblx0XHRcdFwic2hvd0xhYmVsXCI6IGZhbHNlXG5cdFx0fSApO1xuXG5cdFx0Ly8gSUUgNiBkb2Vzbid0IHVuZGVyc3RhbmQgaGVpZ2h0OiA1MCUgZm9yIHRoZSBidXR0b25zXG5cdFx0Ly8gdW5sZXNzIHRoZSB3cmFwcGVyIGhhcyBhbiBleHBsaWNpdCBoZWlnaHRcblx0XHRpZiAoIHRoaXMuYnV0dG9ucy5oZWlnaHQoKSA+IE1hdGguY2VpbCggdGhpcy51aVNwaW5uZXIuaGVpZ2h0KCkgKiAwLjUgKSAmJlxuXHRcdFx0XHR0aGlzLnVpU3Bpbm5lci5oZWlnaHQoKSA+IDAgKSB7XG5cdFx0XHR0aGlzLnVpU3Bpbm5lci5oZWlnaHQoIHRoaXMudWlTcGlubmVyLmhlaWdodCgpICk7XG5cdFx0fVxuXHR9LFxuXG5cdF9rZXlkb3duOiBmdW5jdGlvbiggZXZlbnQgKSB7XG5cdFx0dmFyIG9wdGlvbnMgPSB0aGlzLm9wdGlvbnMsXG5cdFx0XHRrZXlDb2RlID0gJC51aS5rZXlDb2RlO1xuXG5cdFx0c3dpdGNoICggZXZlbnQua2V5Q29kZSApIHtcblx0XHRjYXNlIGtleUNvZGUuVVA6XG5cdFx0XHR0aGlzLl9yZXBlYXQoIG51bGwsIDEsIGV2ZW50ICk7XG5cdFx0XHRyZXR1cm4gdHJ1ZTtcblx0XHRjYXNlIGtleUNvZGUuRE9XTjpcblx0XHRcdHRoaXMuX3JlcGVhdCggbnVsbCwgLTEsIGV2ZW50ICk7XG5cdFx0XHRyZXR1cm4gdHJ1ZTtcblx0XHRjYXNlIGtleUNvZGUuUEFHRV9VUDpcblx0XHRcdHRoaXMuX3JlcGVhdCggbnVsbCwgb3B0aW9ucy5wYWdlLCBldmVudCApO1xuXHRcdFx0cmV0dXJuIHRydWU7XG5cdFx0Y2FzZSBrZXlDb2RlLlBBR0VfRE9XTjpcblx0XHRcdHRoaXMuX3JlcGVhdCggbnVsbCwgLW9wdGlvbnMucGFnZSwgZXZlbnQgKTtcblx0XHRcdHJldHVybiB0cnVlO1xuXHRcdH1cblxuXHRcdHJldHVybiBmYWxzZTtcblx0fSxcblxuXHRfc3RhcnQ6IGZ1bmN0aW9uKCBldmVudCApIHtcblx0XHRpZiAoICF0aGlzLnNwaW5uaW5nICYmIHRoaXMuX3RyaWdnZXIoIFwic3RhcnRcIiwgZXZlbnQgKSA9PT0gZmFsc2UgKSB7XG5cdFx0XHRyZXR1cm4gZmFsc2U7XG5cdFx0fVxuXG5cdFx0aWYgKCAhdGhpcy5jb3VudGVyICkge1xuXHRcdFx0dGhpcy5jb3VudGVyID0gMTtcblx0XHR9XG5cdFx0dGhpcy5zcGlubmluZyA9IHRydWU7XG5cdFx0cmV0dXJuIHRydWU7XG5cdH0sXG5cblx0X3JlcGVhdDogZnVuY3Rpb24oIGksIHN0ZXBzLCBldmVudCApIHtcblx0XHRpID0gaSB8fCA1MDA7XG5cblx0XHRjbGVhclRpbWVvdXQoIHRoaXMudGltZXIgKTtcblx0XHR0aGlzLnRpbWVyID0gdGhpcy5fZGVsYXkoIGZ1bmN0aW9uKCkge1xuXHRcdFx0dGhpcy5fcmVwZWF0KCA0MCwgc3RlcHMsIGV2ZW50ICk7XG5cdFx0fSwgaSApO1xuXG5cdFx0dGhpcy5fc3Bpbiggc3RlcHMgKiB0aGlzLm9wdGlvbnMuc3RlcCwgZXZlbnQgKTtcblx0fSxcblxuXHRfc3BpbjogZnVuY3Rpb24oIHN0ZXAsIGV2ZW50ICkge1xuXHRcdHZhciB2YWx1ZSA9IHRoaXMudmFsdWUoKSB8fCAwO1xuXG5cdFx0aWYgKCAhdGhpcy5jb3VudGVyICkge1xuXHRcdFx0dGhpcy5jb3VudGVyID0gMTtcblx0XHR9XG5cblx0XHR2YWx1ZSA9IHRoaXMuX2FkanVzdFZhbHVlKCB2YWx1ZSArIHN0ZXAgKiB0aGlzLl9pbmNyZW1lbnQoIHRoaXMuY291bnRlciApICk7XG5cblx0XHRpZiAoICF0aGlzLnNwaW5uaW5nIHx8IHRoaXMuX3RyaWdnZXIoIFwic3BpblwiLCBldmVudCwgeyB2YWx1ZTogdmFsdWUgfSApICE9PSBmYWxzZSApIHtcblx0XHRcdHRoaXMuX3ZhbHVlKCB2YWx1ZSApO1xuXHRcdFx0dGhpcy5jb3VudGVyKys7XG5cdFx0fVxuXHR9LFxuXG5cdF9pbmNyZW1lbnQ6IGZ1bmN0aW9uKCBpICkge1xuXHRcdHZhciBpbmNyZW1lbnRhbCA9IHRoaXMub3B0aW9ucy5pbmNyZW1lbnRhbDtcblxuXHRcdGlmICggaW5jcmVtZW50YWwgKSB7XG5cdFx0XHRyZXR1cm4gJC5pc0Z1bmN0aW9uKCBpbmNyZW1lbnRhbCApID9cblx0XHRcdFx0aW5jcmVtZW50YWwoIGkgKSA6XG5cdFx0XHRcdE1hdGguZmxvb3IoIGkgKiBpICogaSAvIDUwMDAwIC0gaSAqIGkgLyA1MDAgKyAxNyAqIGkgLyAyMDAgKyAxICk7XG5cdFx0fVxuXG5cdFx0cmV0dXJuIDE7XG5cdH0sXG5cblx0X3ByZWNpc2lvbjogZnVuY3Rpb24oKSB7XG5cdFx0dmFyIHByZWNpc2lvbiA9IHRoaXMuX3ByZWNpc2lvbk9mKCB0aGlzLm9wdGlvbnMuc3RlcCApO1xuXHRcdGlmICggdGhpcy5vcHRpb25zLm1pbiAhPT0gbnVsbCApIHtcblx0XHRcdHByZWNpc2lvbiA9IE1hdGgubWF4KCBwcmVjaXNpb24sIHRoaXMuX3ByZWNpc2lvbk9mKCB0aGlzLm9wdGlvbnMubWluICkgKTtcblx0XHR9XG5cdFx0cmV0dXJuIHByZWNpc2lvbjtcblx0fSxcblxuXHRfcHJlY2lzaW9uT2Y6IGZ1bmN0aW9uKCBudW0gKSB7XG5cdFx0dmFyIHN0ciA9IG51bS50b1N0cmluZygpLFxuXHRcdFx0ZGVjaW1hbCA9IHN0ci5pbmRleE9mKCBcIi5cIiApO1xuXHRcdHJldHVybiBkZWNpbWFsID09PSAtMSA/IDAgOiBzdHIubGVuZ3RoIC0gZGVjaW1hbCAtIDE7XG5cdH0sXG5cblx0X2FkanVzdFZhbHVlOiBmdW5jdGlvbiggdmFsdWUgKSB7XG5cdFx0dmFyIGJhc2UsIGFib3ZlTWluLFxuXHRcdFx0b3B0aW9ucyA9IHRoaXMub3B0aW9ucztcblxuXHRcdC8vIE1ha2Ugc3VyZSB3ZSdyZSBhdCBhIHZhbGlkIHN0ZXBcblx0XHQvLyAtIGZpbmQgb3V0IHdoZXJlIHdlIGFyZSByZWxhdGl2ZSB0byB0aGUgYmFzZSAobWluIG9yIDApXG5cdFx0YmFzZSA9IG9wdGlvbnMubWluICE9PSBudWxsID8gb3B0aW9ucy5taW4gOiAwO1xuXHRcdGFib3ZlTWluID0gdmFsdWUgLSBiYXNlO1xuXG5cdFx0Ly8gLSByb3VuZCB0byB0aGUgbmVhcmVzdCBzdGVwXG5cdFx0YWJvdmVNaW4gPSBNYXRoLnJvdW5kKCBhYm92ZU1pbiAvIG9wdGlvbnMuc3RlcCApICogb3B0aW9ucy5zdGVwO1xuXG5cdFx0Ly8gLSByb3VuZGluZyBpcyBiYXNlZCBvbiAwLCBzbyBhZGp1c3QgYmFjayB0byBvdXIgYmFzZVxuXHRcdHZhbHVlID0gYmFzZSArIGFib3ZlTWluO1xuXG5cdFx0Ly8gRml4IHByZWNpc2lvbiBmcm9tIGJhZCBKUyBmbG9hdGluZyBwb2ludCBtYXRoXG5cdFx0dmFsdWUgPSBwYXJzZUZsb2F0KCB2YWx1ZS50b0ZpeGVkKCB0aGlzLl9wcmVjaXNpb24oKSApICk7XG5cblx0XHQvLyBDbGFtcCB0aGUgdmFsdWVcblx0XHRpZiAoIG9wdGlvbnMubWF4ICE9PSBudWxsICYmIHZhbHVlID4gb3B0aW9ucy5tYXggKSB7XG5cdFx0XHRyZXR1cm4gb3B0aW9ucy5tYXg7XG5cdFx0fVxuXHRcdGlmICggb3B0aW9ucy5taW4gIT09IG51bGwgJiYgdmFsdWUgPCBvcHRpb25zLm1pbiApIHtcblx0XHRcdHJldHVybiBvcHRpb25zLm1pbjtcblx0XHR9XG5cblx0XHRyZXR1cm4gdmFsdWU7XG5cdH0sXG5cblx0X3N0b3A6IGZ1bmN0aW9uKCBldmVudCApIHtcblx0XHRpZiAoICF0aGlzLnNwaW5uaW5nICkge1xuXHRcdFx0cmV0dXJuO1xuXHRcdH1cblxuXHRcdGNsZWFyVGltZW91dCggdGhpcy50aW1lciApO1xuXHRcdGNsZWFyVGltZW91dCggdGhpcy5tb3VzZXdoZWVsVGltZXIgKTtcblx0XHR0aGlzLmNvdW50ZXIgPSAwO1xuXHRcdHRoaXMuc3Bpbm5pbmcgPSBmYWxzZTtcblx0XHR0aGlzLl90cmlnZ2VyKCBcInN0b3BcIiwgZXZlbnQgKTtcblx0fSxcblxuXHRfc2V0T3B0aW9uOiBmdW5jdGlvbigga2V5LCB2YWx1ZSApIHtcblx0XHR2YXIgcHJldlZhbHVlLCBmaXJzdCwgbGFzdDtcblxuXHRcdGlmICgga2V5ID09PSBcImN1bHR1cmVcIiB8fCBrZXkgPT09IFwibnVtYmVyRm9ybWF0XCIgKSB7XG5cdFx0XHRwcmV2VmFsdWUgPSB0aGlzLl9wYXJzZSggdGhpcy5lbGVtZW50LnZhbCgpICk7XG5cdFx0XHR0aGlzLm9wdGlvbnNbIGtleSBdID0gdmFsdWU7XG5cdFx0XHR0aGlzLmVsZW1lbnQudmFsKCB0aGlzLl9mb3JtYXQoIHByZXZWYWx1ZSApICk7XG5cdFx0XHRyZXR1cm47XG5cdFx0fVxuXG5cdFx0aWYgKCBrZXkgPT09IFwibWF4XCIgfHwga2V5ID09PSBcIm1pblwiIHx8IGtleSA9PT0gXCJzdGVwXCIgKSB7XG5cdFx0XHRpZiAoIHR5cGVvZiB2YWx1ZSA9PT0gXCJzdHJpbmdcIiApIHtcblx0XHRcdFx0dmFsdWUgPSB0aGlzLl9wYXJzZSggdmFsdWUgKTtcblx0XHRcdH1cblx0XHR9XG5cdFx0aWYgKCBrZXkgPT09IFwiaWNvbnNcIiApIHtcblx0XHRcdGZpcnN0ID0gdGhpcy5idXR0b25zLmZpcnN0KCkuZmluZCggXCIudWktaWNvblwiICk7XG5cdFx0XHR0aGlzLl9yZW1vdmVDbGFzcyggZmlyc3QsIG51bGwsIHRoaXMub3B0aW9ucy5pY29ucy51cCApO1xuXHRcdFx0dGhpcy5fYWRkQ2xhc3MoIGZpcnN0LCBudWxsLCB2YWx1ZS51cCApO1xuXHRcdFx0bGFzdCA9IHRoaXMuYnV0dG9ucy5sYXN0KCkuZmluZCggXCIudWktaWNvblwiICk7XG5cdFx0XHR0aGlzLl9yZW1vdmVDbGFzcyggbGFzdCwgbnVsbCwgdGhpcy5vcHRpb25zLmljb25zLmRvd24gKTtcblx0XHRcdHRoaXMuX2FkZENsYXNzKCBsYXN0LCBudWxsLCB2YWx1ZS5kb3duICk7XG5cdFx0fVxuXG5cdFx0dGhpcy5fc3VwZXIoIGtleSwgdmFsdWUgKTtcblx0fSxcblxuXHRfc2V0T3B0aW9uRGlzYWJsZWQ6IGZ1bmN0aW9uKCB2YWx1ZSApIHtcblx0XHR0aGlzLl9zdXBlciggdmFsdWUgKTtcblxuXHRcdHRoaXMuX3RvZ2dsZUNsYXNzKCB0aGlzLnVpU3Bpbm5lciwgbnVsbCwgXCJ1aS1zdGF0ZS1kaXNhYmxlZFwiLCAhIXZhbHVlICk7XG5cdFx0dGhpcy5lbGVtZW50LnByb3AoIFwiZGlzYWJsZWRcIiwgISF2YWx1ZSApO1xuXHRcdHRoaXMuYnV0dG9ucy5idXR0b24oIHZhbHVlID8gXCJkaXNhYmxlXCIgOiBcImVuYWJsZVwiICk7XG5cdH0sXG5cblx0X3NldE9wdGlvbnM6IHNwaW5uZXJNb2RpZmVyKCBmdW5jdGlvbiggb3B0aW9ucyApIHtcblx0XHR0aGlzLl9zdXBlciggb3B0aW9ucyApO1xuXHR9ICksXG5cblx0X3BhcnNlOiBmdW5jdGlvbiggdmFsICkge1xuXHRcdGlmICggdHlwZW9mIHZhbCA9PT0gXCJzdHJpbmdcIiAmJiB2YWwgIT09IFwiXCIgKSB7XG5cdFx0XHR2YWwgPSB3aW5kb3cuR2xvYmFsaXplICYmIHRoaXMub3B0aW9ucy5udW1iZXJGb3JtYXQgP1xuXHRcdFx0XHRHbG9iYWxpemUucGFyc2VGbG9hdCggdmFsLCAxMCwgdGhpcy5vcHRpb25zLmN1bHR1cmUgKSA6ICt2YWw7XG5cdFx0fVxuXHRcdHJldHVybiB2YWwgPT09IFwiXCIgfHwgaXNOYU4oIHZhbCApID8gbnVsbCA6IHZhbDtcblx0fSxcblxuXHRfZm9ybWF0OiBmdW5jdGlvbiggdmFsdWUgKSB7XG5cdFx0aWYgKCB2YWx1ZSA9PT0gXCJcIiApIHtcblx0XHRcdHJldHVybiBcIlwiO1xuXHRcdH1cblx0XHRyZXR1cm4gd2luZG93Lkdsb2JhbGl6ZSAmJiB0aGlzLm9wdGlvbnMubnVtYmVyRm9ybWF0ID9cblx0XHRcdEdsb2JhbGl6ZS5mb3JtYXQoIHZhbHVlLCB0aGlzLm9wdGlvbnMubnVtYmVyRm9ybWF0LCB0aGlzLm9wdGlvbnMuY3VsdHVyZSApIDpcblx0XHRcdHZhbHVlO1xuXHR9LFxuXG5cdF9yZWZyZXNoOiBmdW5jdGlvbigpIHtcblx0XHR0aGlzLmVsZW1lbnQuYXR0cigge1xuXHRcdFx0XCJhcmlhLXZhbHVlbWluXCI6IHRoaXMub3B0aW9ucy5taW4sXG5cdFx0XHRcImFyaWEtdmFsdWVtYXhcIjogdGhpcy5vcHRpb25zLm1heCxcblxuXHRcdFx0Ly8gVE9ETzogd2hhdCBzaG91bGQgd2UgZG8gd2l0aCB2YWx1ZXMgdGhhdCBjYW4ndCBiZSBwYXJzZWQ/XG5cdFx0XHRcImFyaWEtdmFsdWVub3dcIjogdGhpcy5fcGFyc2UoIHRoaXMuZWxlbWVudC52YWwoKSApXG5cdFx0fSApO1xuXHR9LFxuXG5cdGlzVmFsaWQ6IGZ1bmN0aW9uKCkge1xuXHRcdHZhciB2YWx1ZSA9IHRoaXMudmFsdWUoKTtcblxuXHRcdC8vIE51bGwgaXMgaW52YWxpZFxuXHRcdGlmICggdmFsdWUgPT09IG51bGwgKSB7XG5cdFx0XHRyZXR1cm4gZmFsc2U7XG5cdFx0fVxuXG5cdFx0Ly8gSWYgdmFsdWUgZ2V0cyBhZGp1c3RlZCwgaXQncyBpbnZhbGlkXG5cdFx0cmV0dXJuIHZhbHVlID09PSB0aGlzLl9hZGp1c3RWYWx1ZSggdmFsdWUgKTtcblx0fSxcblxuXHQvLyBVcGRhdGUgdGhlIHZhbHVlIHdpdGhvdXQgdHJpZ2dlcmluZyBjaGFuZ2Vcblx0X3ZhbHVlOiBmdW5jdGlvbiggdmFsdWUsIGFsbG93QW55ICkge1xuXHRcdHZhciBwYXJzZWQ7XG5cdFx0aWYgKCB2YWx1ZSAhPT0gXCJcIiApIHtcblx0XHRcdHBhcnNlZCA9IHRoaXMuX3BhcnNlKCB2YWx1ZSApO1xuXHRcdFx0aWYgKCBwYXJzZWQgIT09IG51bGwgKSB7XG5cdFx0XHRcdGlmICggIWFsbG93QW55ICkge1xuXHRcdFx0XHRcdHBhcnNlZCA9IHRoaXMuX2FkanVzdFZhbHVlKCBwYXJzZWQgKTtcblx0XHRcdFx0fVxuXHRcdFx0XHR2YWx1ZSA9IHRoaXMuX2Zvcm1hdCggcGFyc2VkICk7XG5cdFx0XHR9XG5cdFx0fVxuXHRcdHRoaXMuZWxlbWVudC52YWwoIHZhbHVlICk7XG5cdFx0dGhpcy5fcmVmcmVzaCgpO1xuXHR9LFxuXG5cdF9kZXN0cm95OiBmdW5jdGlvbigpIHtcblx0XHR0aGlzLmVsZW1lbnRcblx0XHRcdC5wcm9wKCBcImRpc2FibGVkXCIsIGZhbHNlIClcblx0XHRcdC5yZW1vdmVBdHRyKCBcImF1dG9jb21wbGV0ZSByb2xlIGFyaWEtdmFsdWVtaW4gYXJpYS12YWx1ZW1heCBhcmlhLXZhbHVlbm93XCIgKTtcblxuXHRcdHRoaXMudWlTcGlubmVyLnJlcGxhY2VXaXRoKCB0aGlzLmVsZW1lbnQgKTtcblx0fSxcblxuXHRzdGVwVXA6IHNwaW5uZXJNb2RpZmVyKCBmdW5jdGlvbiggc3RlcHMgKSB7XG5cdFx0dGhpcy5fc3RlcFVwKCBzdGVwcyApO1xuXHR9ICksXG5cdF9zdGVwVXA6IGZ1bmN0aW9uKCBzdGVwcyApIHtcblx0XHRpZiAoIHRoaXMuX3N0YXJ0KCkgKSB7XG5cdFx0XHR0aGlzLl9zcGluKCAoIHN0ZXBzIHx8IDEgKSAqIHRoaXMub3B0aW9ucy5zdGVwICk7XG5cdFx0XHR0aGlzLl9zdG9wKCk7XG5cdFx0fVxuXHR9LFxuXG5cdHN0ZXBEb3duOiBzcGlubmVyTW9kaWZlciggZnVuY3Rpb24oIHN0ZXBzICkge1xuXHRcdHRoaXMuX3N0ZXBEb3duKCBzdGVwcyApO1xuXHR9ICksXG5cdF9zdGVwRG93bjogZnVuY3Rpb24oIHN0ZXBzICkge1xuXHRcdGlmICggdGhpcy5fc3RhcnQoKSApIHtcblx0XHRcdHRoaXMuX3NwaW4oICggc3RlcHMgfHwgMSApICogLXRoaXMub3B0aW9ucy5zdGVwICk7XG5cdFx0XHR0aGlzLl9zdG9wKCk7XG5cdFx0fVxuXHR9LFxuXG5cdHBhZ2VVcDogc3Bpbm5lck1vZGlmZXIoIGZ1bmN0aW9uKCBwYWdlcyApIHtcblx0XHR0aGlzLl9zdGVwVXAoICggcGFnZXMgfHwgMSApICogdGhpcy5vcHRpb25zLnBhZ2UgKTtcblx0fSApLFxuXG5cdHBhZ2VEb3duOiBzcGlubmVyTW9kaWZlciggZnVuY3Rpb24oIHBhZ2VzICkge1xuXHRcdHRoaXMuX3N0ZXBEb3duKCAoIHBhZ2VzIHx8IDEgKSAqIHRoaXMub3B0aW9ucy5wYWdlICk7XG5cdH0gKSxcblxuXHR2YWx1ZTogZnVuY3Rpb24oIG5ld1ZhbCApIHtcblx0XHRpZiAoICFhcmd1bWVudHMubGVuZ3RoICkge1xuXHRcdFx0cmV0dXJuIHRoaXMuX3BhcnNlKCB0aGlzLmVsZW1lbnQudmFsKCkgKTtcblx0XHR9XG5cdFx0c3Bpbm5lck1vZGlmZXIoIHRoaXMuX3ZhbHVlICkuY2FsbCggdGhpcywgbmV3VmFsICk7XG5cdH0sXG5cblx0d2lkZ2V0OiBmdW5jdGlvbigpIHtcblx0XHRyZXR1cm4gdGhpcy51aVNwaW5uZXI7XG5cdH1cbn0gKTtcblxuLy8gREVQUkVDQVRFRFxuLy8gVE9ETzogc3dpdGNoIHJldHVybiBiYWNrIHRvIHdpZGdldCBkZWNsYXJhdGlvbiBhdCB0b3Agb2YgZmlsZSB3aGVuIHRoaXMgaXMgcmVtb3ZlZFxuaWYgKCAkLnVpQmFja0NvbXBhdCAhPT0gZmFsc2UgKSB7XG5cblx0Ly8gQmFja2NvbXBhdCBmb3Igc3Bpbm5lciBodG1sIGV4dGVuc2lvbiBwb2ludHNcblx0JC53aWRnZXQoIFwidWkuc3Bpbm5lclwiLCAkLnVpLnNwaW5uZXIsIHtcblx0XHRfZW5oYW5jZTogZnVuY3Rpb24oKSB7XG5cdFx0XHR0aGlzLnVpU3Bpbm5lciA9IHRoaXMuZWxlbWVudFxuXHRcdFx0XHQuYXR0ciggXCJhdXRvY29tcGxldGVcIiwgXCJvZmZcIiApXG5cdFx0XHRcdC53cmFwKCB0aGlzLl91aVNwaW5uZXJIdG1sKCkgKVxuXHRcdFx0XHQucGFyZW50KClcblxuXHRcdFx0XHRcdC8vIEFkZCBidXR0b25zXG5cdFx0XHRcdFx0LmFwcGVuZCggdGhpcy5fYnV0dG9uSHRtbCgpICk7XG5cdFx0fSxcblx0XHRfdWlTcGlubmVySHRtbDogZnVuY3Rpb24oKSB7XG5cdFx0XHRyZXR1cm4gXCI8c3Bhbj5cIjtcblx0XHR9LFxuXG5cdFx0X2J1dHRvbkh0bWw6IGZ1bmN0aW9uKCkge1xuXHRcdFx0cmV0dXJuIFwiPGE+PC9hPjxhPjwvYT5cIjtcblx0XHR9XG5cdH0gKTtcbn1cblxucmV0dXJuICQudWkuc3Bpbm5lcjtcblxufSApICk7XG4iLCIhZnVuY3Rpb24oZSxyKXtpZihcIm9iamVjdFwiPT10eXBlb2YgZXhwb3J0cyYmXCJvYmplY3RcIj09dHlwZW9mIG1vZHVsZSltb2R1bGUuZXhwb3J0cz1yKCk7ZWxzZSBpZihcImZ1bmN0aW9uXCI9PXR5cGVvZiBkZWZpbmUmJmRlZmluZS5hbWQpZGVmaW5lKFtdLHIpO2Vsc2V7dmFyIHQ9cigpO2Zvcih2YXIgbiBpbiB0KShcIm9iamVjdFwiPT10eXBlb2YgZXhwb3J0cz9leHBvcnRzOmUpW25dPXRbbl19fSh0aGlzLGZ1bmN0aW9uKCl7cmV0dXJuIGZ1bmN0aW9uKGUpe2Z1bmN0aW9uIHIobil7aWYodFtuXSlyZXR1cm4gdFtuXS5leHBvcnRzO3ZhciBvPXRbbl09e2V4cG9ydHM6e30saWQ6bixsb2FkZWQ6ITF9O3JldHVybiBlW25dLmNhbGwoby5leHBvcnRzLG8sby5leHBvcnRzLHIpLG8ubG9hZGVkPSEwLG8uZXhwb3J0c312YXIgdD17fTtyZXR1cm4gci5tPWUsci5jPXQsci5wPVwiXCIscigwKX0oW2Z1bmN0aW9uKGUscix0KXtlLmV4cG9ydHM9dCgxKX0sZnVuY3Rpb24oZSxyLHQpe1widXNlIHN0cmljdFwiO2Z1bmN0aW9uIG4oKXt2YXIgZT1cInVuZGVmaW5lZFwiPT10eXBlb2YgSlNPTj97fTpKU09OO28uc2V0dXBKU09OKGUpfXZhciBvPXQoMiksaT10KDMpO24oKTt2YXIgYT13aW5kb3cuX3JvbGxiYXJDb25maWcscz1hJiZhLmdsb2JhbEFsaWFzfHxcIlJvbGxiYXJcIix1PXdpbmRvd1tzXSYmXCJ1bmRlZmluZWRcIiE9dHlwZW9mIHdpbmRvd1tzXS5zaGltSWQ7IXUmJmE/by53cmFwcGVyLmluaXQoYSk6KHdpbmRvdy5Sb2xsYmFyPW8ud3JhcHBlcix3aW5kb3cuUm9sbGJhck5vdGlmaWVyPWkuTm90aWZpZXIpLGUuZXhwb3J0cz1vLndyYXBwZXJ9LGZ1bmN0aW9uKGUscix0KXtcInVzZSBzdHJpY3RcIjtmdW5jdGlvbiBuKGUscix0KXshdFs0XSYmd2luZG93Ll9yb2xsYmFyV3JhcHBlZEVycm9yJiYodFs0XT13aW5kb3cuX3JvbGxiYXJXcmFwcGVkRXJyb3Isd2luZG93Ll9yb2xsYmFyV3JhcHBlZEVycm9yPW51bGwpLGUudW5jYXVnaHRFcnJvci5hcHBseShlLHQpLHImJnIuYXBwbHkod2luZG93LHQpfWZ1bmN0aW9uIG8oZSxyKXtpZihyLmhhc093blByb3BlcnR5JiZyLmhhc093blByb3BlcnR5KFwiYWRkRXZlbnRMaXN0ZW5lclwiKSl7dmFyIHQ9ci5hZGRFdmVudExpc3RlbmVyO3IuYWRkRXZlbnRMaXN0ZW5lcj1mdW5jdGlvbihyLG4sbyl7dC5jYWxsKHRoaXMscixlLndyYXAobiksbyl9O3ZhciBuPXIucmVtb3ZlRXZlbnRMaXN0ZW5lcjtyLnJlbW92ZUV2ZW50TGlzdGVuZXI9ZnVuY3Rpb24oZSxyLHQpe24uY2FsbCh0aGlzLGUsciYmci5fd3JhcHBlZHx8cix0KX19fXZhciBpPXQoMyksYT10KDgpLHM9aS5Ob3RpZmllcjt3aW5kb3cuX3JvbGxiYXJXcmFwcGVkRXJyb3I9bnVsbDt2YXIgdT17fTt1LmluaXQ9ZnVuY3Rpb24oZSxyKXt2YXIgdD1uZXcgcyhyKTtpZih0LmNvbmZpZ3VyZShlKSxlLmNhcHR1cmVVbmNhdWdodCl7dmFyIGk7ciYmYS5pc1R5cGUoci5fcm9sbGJhck9sZE9uRXJyb3IsXCJmdW5jdGlvblwiKT9pPXIuX3JvbGxiYXJPbGRPbkVycm9yOndpbmRvdy5vbmVycm9yJiYhd2luZG93Lm9uZXJyb3IuYmVsb25nc1RvU2hpbSYmKGk9d2luZG93Lm9uZXJyb3IpLHdpbmRvdy5vbmVycm9yPWZ1bmN0aW9uKCl7dmFyIGU9QXJyYXkucHJvdG90eXBlLnNsaWNlLmNhbGwoYXJndW1lbnRzLDApO24odCxpLGUpfTt2YXIgdSxjLGw9W1wiRXZlbnRUYXJnZXRcIixcIldpbmRvd1wiLFwiTm9kZVwiLFwiQXBwbGljYXRpb25DYWNoZVwiLFwiQXVkaW9UcmFja0xpc3RcIixcIkNoYW5uZWxNZXJnZXJOb2RlXCIsXCJDcnlwdG9PcGVyYXRpb25cIixcIkV2ZW50U291cmNlXCIsXCJGaWxlUmVhZGVyXCIsXCJIVE1MVW5rbm93bkVsZW1lbnRcIixcIklEQkRhdGFiYXNlXCIsXCJJREJSZXF1ZXN0XCIsXCJJREJUcmFuc2FjdGlvblwiLFwiS2V5T3BlcmF0aW9uXCIsXCJNZWRpYUNvbnRyb2xsZXJcIixcIk1lc3NhZ2VQb3J0XCIsXCJNb2RhbFdpbmRvd1wiLFwiTm90aWZpY2F0aW9uXCIsXCJTVkdFbGVtZW50SW5zdGFuY2VcIixcIlNjcmVlblwiLFwiVGV4dFRyYWNrXCIsXCJUZXh0VHJhY2tDdWVcIixcIlRleHRUcmFja0xpc3RcIixcIldlYlNvY2tldFwiLFwiV2ViU29ja2V0V29ya2VyXCIsXCJXb3JrZXJcIixcIlhNTEh0dHBSZXF1ZXN0XCIsXCJYTUxIdHRwUmVxdWVzdEV2ZW50VGFyZ2V0XCIsXCJYTUxIdHRwUmVxdWVzdFVwbG9hZFwiXTtmb3IodT0wO3U8bC5sZW5ndGg7Kyt1KWM9bFt1XSx3aW5kb3dbY10mJndpbmRvd1tjXS5wcm90b3R5cGUmJm8odCx3aW5kb3dbY10ucHJvdG90eXBlKX1yZXR1cm4gZS5jYXB0dXJlVW5oYW5kbGVkUmVqZWN0aW9ucyYmKHImJmEuaXNUeXBlKHIuX3VuaGFuZGxlZFJlamVjdGlvbkhhbmRsZXIsXCJmdW5jdGlvblwiKSYmd2luZG93LnJlbW92ZUV2ZW50TGlzdGVuZXIoXCJ1bmhhbmRsZWRyZWplY3Rpb25cIixyLl91bmhhbmRsZWRSZWplY3Rpb25IYW5kbGVyKSx0Ll91bmhhbmRsZWRSZWplY3Rpb25IYW5kbGVyPWZ1bmN0aW9uKGUpe3ZhciByPWUucmVhc29uLG49ZS5wcm9taXNlLG89ZS5kZXRhaWw7IXImJm8mJihyPW8ucmVhc29uLG49by5wcm9taXNlKSx0LnVuaGFuZGxlZFJlamVjdGlvbihyLG4pfSx3aW5kb3cuYWRkRXZlbnRMaXN0ZW5lcihcInVuaGFuZGxlZHJlamVjdGlvblwiLHQuX3VuaGFuZGxlZFJlamVjdGlvbkhhbmRsZXIpKSx3aW5kb3cuUm9sbGJhcj10LHMucHJvY2Vzc1BheWxvYWRzKCksdH0sZS5leHBvcnRzPXt3cmFwcGVyOnUsc2V0dXBKU09OOmkuc2V0dXBKU09OfX0sZnVuY3Rpb24oZSxyLHQpe1widXNlIHN0cmljdFwiO2Z1bmN0aW9uIG4oZSl7RT1lLHcuc2V0dXBKU09OKGUpfWZ1bmN0aW9uIG8oZSxyKXtyZXR1cm4gZnVuY3Rpb24oKXt2YXIgdD1yfHx0aGlzO3RyeXtyZXR1cm4gZS5hcHBseSh0LGFyZ3VtZW50cyl9Y2F0Y2gobil7Y29uc29sZS5lcnJvcihcIltSb2xsYmFyXTpcIixuKX19fWZ1bmN0aW9uIGkoKXtofHwoaD1zZXRUaW1lb3V0KGYsMWUzKSl9ZnVuY3Rpb24gYSgpe3JldHVybiBffWZ1bmN0aW9uIHMoZSl7Xz1ffHx0aGlzO3ZhciByPVwiaHR0cHM6Ly9cIitzLkRFRkFVTFRfRU5EUE9JTlQ7dGhpcy5vcHRpb25zPXtlbmFibGVkOiEwLGVuZHBvaW50OnIsZW52aXJvbm1lbnQ6XCJwcm9kdWN0aW9uXCIsc2NydWJGaWVsZHM6ZyhbXSxzLkRFRkFVTFRfU0NSVUJfRklFTERTKSxjaGVja0lnbm9yZTpudWxsLGxvZ0xldmVsOnMuREVGQVVMVF9MT0dfTEVWRUwscmVwb3J0TGV2ZWw6cy5ERUZBVUxUX1JFUE9SVF9MRVZFTCx1bmNhdWdodEVycm9yTGV2ZWw6cy5ERUZBVUxUX1VOQ0FVR0hUX0VSUk9SX0xFVkVMLHBheWxvYWQ6e319LHRoaXMubGFzdEVycm9yPW51bGwsdGhpcy5wbHVnaW5zPXt9LHRoaXMucGFyZW50Tm90aWZpZXI9ZSxlJiYoZS5oYXNPd25Qcm9wZXJ0eShcInNoaW1JZFwiKT9lLm5vdGlmaWVyPXRoaXM6dGhpcy5jb25maWd1cmUoZS5vcHRpb25zKSl9ZnVuY3Rpb24gdShlKXt3aW5kb3cuX3JvbGxiYXJQYXlsb2FkUXVldWUucHVzaChlKSxpKCl9ZnVuY3Rpb24gYyhlKXtyZXR1cm4gbyhmdW5jdGlvbigpe3ZhciByPXRoaXMuX2dldExvZ0FyZ3MoYXJndW1lbnRzKTtyZXR1cm4gdGhpcy5fbG9nKGV8fHIubGV2ZWx8fHRoaXMub3B0aW9ucy5sb2dMZXZlbHx8cy5ERUZBVUxUX0xPR19MRVZFTCxyLm1lc3NhZ2Usci5lcnIsci5jdXN0b20sci5jYWxsYmFjayl9KX1mdW5jdGlvbiBsKGUscil7ZXx8KGU9cj9FLnN0cmluZ2lmeShyKTpcIlwiKTt2YXIgdD17Ym9keTplfTtyZXR1cm4gciYmKHQuZXh0cmE9ZyghMCx7fSxyKSkse21lc3NhZ2U6dH19ZnVuY3Rpb24gcChlLHIsdCl7dmFyIG49bS5ndWVzc0Vycm9yQ2xhc3Moci5tZXNzYWdlKSxvPXIubmFtZXx8blswXSxpPW5bMV0sYT17ZXhjZXB0aW9uOntcImNsYXNzXCI6byxtZXNzYWdlOml9fTtpZihlJiYoYS5leGNlcHRpb24uZGVzY3JpcHRpb249ZXx8XCJ1bmNhdWdodCBleGNlcHRpb25cIiksci5zdGFjayl7dmFyIHMsdSxjLHAsZixkLGgsdztmb3IoYS5mcmFtZXM9W10saD0wO2g8ci5zdGFjay5sZW5ndGg7KytoKXM9ci5zdGFja1toXSx1PXtmaWxlbmFtZTpzLnVybD92LnNhbml0aXplVXJsKHMudXJsKTpcIih1bmtub3duKVwiLGxpbmVubzpzLmxpbmV8fG51bGwsbWV0aG9kOnMuZnVuYyYmXCI/XCIhPT1zLmZ1bmM/cy5mdW5jOlwiW2Fub255bW91c11cIixjb2xubzpzLmNvbHVtbn0sYz1wPWY9bnVsbCxkPXMuY29udGV4dD9zLmNvbnRleHQubGVuZ3RoOjAsZCYmKHc9TWF0aC5mbG9vcihkLzIpLHA9cy5jb250ZXh0LnNsaWNlKDAsdyksYz1zLmNvbnRleHRbd10sZj1zLmNvbnRleHQuc2xpY2UodykpLGMmJih1LmNvZGU9YyksKHB8fGYpJiYodS5jb250ZXh0PXt9LHAmJnAubGVuZ3RoJiYodS5jb250ZXh0LnByZT1wKSxmJiZmLmxlbmd0aCYmKHUuY29udGV4dC5wb3N0PWYpKSxzLmFyZ3MmJih1LmFyZ3M9cy5hcmdzKSxhLmZyYW1lcy5wdXNoKHUpO3JldHVybiBhLmZyYW1lcy5yZXZlcnNlKCksdCYmKGEuZXh0cmE9ZyghMCx7fSx0KSkse3RyYWNlOmF9fXJldHVybiBsKG8rXCI6IFwiK2ksdCl9ZnVuY3Rpb24gZigpe3ZhciBlO3RyeXtmb3IoO2U9d2luZG93Ll9yb2xsYmFyUGF5bG9hZFF1ZXVlLnNoaWZ0KCk7KWQoZSl9ZmluYWxseXtoPXZvaWQgMH19ZnVuY3Rpb24gZChlKXt2YXIgcj1lLmVuZHBvaW50VXJsLHQ9ZS5hY2Nlc3NUb2tlbixuPWUucGF5bG9hZCxvPWUuY2FsbGJhY2t8fGZ1bmN0aW9uKCl7fSxpPShuZXcgRGF0ZSkuZ2V0VGltZSgpO2ktTD49NmU0JiYoTD1pLFI9MCk7dmFyIGE9d2luZG93Ll9nbG9iYWxSb2xsYmFyT3B0aW9ucy5tYXhJdGVtcyxjPXdpbmRvdy5fZ2xvYmFsUm9sbGJhck9wdGlvbnMuaXRlbXNQZXJNaW51dGUsbD1mdW5jdGlvbigpe3JldHVybiFuLmlnbm9yZVJhdGVMaW1pdCYmYT49MSYmVD49YX0scD1mdW5jdGlvbigpe3JldHVybiFuLmlnbm9yZVJhdGVMaW1pdCYmYz49MSYmUj49Y307cmV0dXJuIGwoKT92b2lkIG8obmV3IEVycm9yKGErXCIgbWF4IGl0ZW1zIHJlYWNoZWRcIikpOnAoKT92b2lkIG8obmV3IEVycm9yKGMrXCIgaXRlbXMgcGVyIG1pbnV0ZSByZWFjaGVkXCIpKTooVCsrLFIrKyxsKCkmJl8uX2xvZyhfLm9wdGlvbnMudW5jYXVnaHRFcnJvckxldmVsLFwibWF4SXRlbXMgaGFzIGJlZW4gaGl0LiBJZ25vcmluZyBlcnJvcnMgZm9yIHRoZSByZW1haW5kZXIgb2YgdGhlIGN1cnJlbnQgcGFnZSBsb2FkLlwiLG51bGwse21heEl0ZW1zOmF9LG51bGwsITEsITApLG4uaWdub3JlUmF0ZUxpbWl0JiZkZWxldGUgbi5pZ25vcmVSYXRlTGltaXQsdm9pZCB5LnBvc3Qocix0LG4sZnVuY3Rpb24ocix0KXtyZXR1cm4gcj8ociBpbnN0YW5jZW9mIGImJihlLmNhbGxiYWNrPWZ1bmN0aW9uKCl7fSxzZXRUaW1lb3V0KGZ1bmN0aW9uKCl7dShlKX0scy5SRVRSWV9ERUxBWSkpLG8ocikpOm8obnVsbCx0KX0pKX12YXIgaCxnPXQoNCksbT10KDUpLHY9dCg4KSx3PXQoMTApLHk9dy5YSFIsYj13LkNvbm5lY3Rpb25FcnJvcixFPW51bGw7cy5OT1RJRklFUl9WRVJTSU9OPVwiMS45LjJcIixzLkRFRkFVTFRfRU5EUE9JTlQ9XCJhcGkucm9sbGJhci5jb20vYXBpLzEvXCIscy5ERUZBVUxUX1NDUlVCX0ZJRUxEUz1bXCJwd1wiLFwicGFzc1wiLFwicGFzc3dkXCIsXCJwYXNzd29yZFwiLFwic2VjcmV0XCIsXCJjb25maXJtX3Bhc3N3b3JkXCIsXCJjb25maXJtUGFzc3dvcmRcIixcInBhc3N3b3JkX2NvbmZpcm1hdGlvblwiLFwicGFzc3dvcmRDb25maXJtYXRpb25cIixcImFjY2Vzc190b2tlblwiLFwiYWNjZXNzVG9rZW5cIixcInNlY3JldF9rZXlcIixcInNlY3JldEtleVwiLFwic2VjcmV0VG9rZW5cIl0scy5ERUZBVUxUX0xPR19MRVZFTD1cImRlYnVnXCIscy5ERUZBVUxUX1JFUE9SVF9MRVZFTD1cImRlYnVnXCIscy5ERUZBVUxUX1VOQ0FVR0hUX0VSUk9SX0xFVkVMPVwiZXJyb3JcIixzLkRFRkFVTFRfSVRFTVNfUEVSX01JTj02MCxzLkRFRkFVTFRfTUFYX0lURU1TPTAscy5MRVZFTFM9e2RlYnVnOjAsaW5mbzoxLHdhcm5pbmc6MixlcnJvcjozLGNyaXRpY2FsOjR9LHMuUkVUUllfREVMQVk9MWU0LHdpbmRvdy5fcm9sbGJhclBheWxvYWRRdWV1ZT13aW5kb3cuX3JvbGxiYXJQYXlsb2FkUXVldWV8fFtdLHdpbmRvdy5fZ2xvYmFsUm9sbGJhck9wdGlvbnM9e3N0YXJ0VGltZToobmV3IERhdGUpLmdldFRpbWUoKSxtYXhJdGVtczpzLkRFRkFVTFRfTUFYX0lURU1TLGl0ZW1zUGVyTWludXRlOnMuREVGQVVMVF9JVEVNU19QRVJfTUlOfTt2YXIgXyx4PXMucHJvdG90eXBlO3guX2dldExvZ0FyZ3M9ZnVuY3Rpb24oZSl7Zm9yKHZhciByLHQsbixpLGEsdSxjPXRoaXMub3B0aW9ucy5sb2dMZXZlbHx8cy5ERUZBVUxUX0xPR19MRVZFTCxsPVtdLHA9MDtwPGUubGVuZ3RoOysrcCl1PWVbcF0sYT12LnR5cGVOYW1lKHUpLFwic3RyaW5nXCI9PT1hP3I/bC5wdXNoKHUpOnI9dTpcImZ1bmN0aW9uXCI9PT1hP2k9byh1LHRoaXMpOlwiZGF0ZVwiPT09YT9sLnB1c2godSk6XCJlcnJvclwiPT09YXx8dSBpbnN0YW5jZW9mIEVycm9yfHxcInVuZGVmaW5lZFwiIT10eXBlb2YgRE9NRXhjZXB0aW9uJiZ1IGluc3RhbmNlb2YgRE9NRXhjZXB0aW9uP3Q/bC5wdXNoKHUpOnQ9dTpcIm9iamVjdFwiIT09YSYmXCJhcnJheVwiIT09YXx8KG4/bC5wdXNoKHUpOm49dSk7cmV0dXJuIGwubGVuZ3RoJiYobj1ufHx7fSxuLmV4dHJhQXJncz1sKSx7bGV2ZWw6YyxtZXNzYWdlOnIsZXJyOnQsY3VzdG9tOm4sY2FsbGJhY2s6aX19LHguX3JvdXRlPWZ1bmN0aW9uKGUpe3ZhciByPXRoaXMub3B0aW9ucy5lbmRwb2ludCx0PS9cXC8kLy50ZXN0KHIpLG49L15cXC8vLnRlc3QoZSk7cmV0dXJuIHQmJm4/ZT1lLnN1YnN0cmluZygxKTp0fHxufHwoZT1cIi9cIitlKSxyK2V9LHguX3Byb2Nlc3NTaGltUXVldWU9ZnVuY3Rpb24oZSl7Zm9yKHZhciByLHQsbixvLGksYSx1LGM9e307dD1lLnNoaWZ0KCk7KXI9dC5zaGltLG49dC5tZXRob2Qsbz10LmFyZ3MsaT1yLnBhcmVudFNoaW0sdT1jW3Iuc2hpbUlkXSx1fHwoaT8oYT1jW2kuc2hpbUlkXSx1PW5ldyBzKGEpKTp1PXRoaXMsY1tyLnNoaW1JZF09dSksdVtuXSYmdi5pc1R5cGUodVtuXSxcImZ1bmN0aW9uXCIpJiZ1W25dLmFwcGx5KHUsbyl9LHguX2J1aWxkUGF5bG9hZD1mdW5jdGlvbihlLHIsdCxuLG8pe3ZhciBpPXRoaXMub3B0aW9ucy5hY2Nlc3NUb2tlbixhPXRoaXMub3B0aW9ucy5lbnZpcm9ubWVudCx1PWcoITAse30sdGhpcy5vcHRpb25zLnBheWxvYWQpLGM9di51dWlkNCgpO2lmKHZvaWQgMD09PXMuTEVWRUxTW3JdKXRocm93IG5ldyBFcnJvcihcIkludmFsaWQgbGV2ZWxcIik7aWYoIXQmJiFuJiYhbyl0aHJvdyBuZXcgRXJyb3IoXCJObyBtZXNzYWdlLCBzdGFjayBpbmZvIG9yIGN1c3RvbSBkYXRhXCIpO3ZhciBsPXtlbnZpcm9ubWVudDphLGVuZHBvaW50OnRoaXMub3B0aW9ucy5lbmRwb2ludCx1dWlkOmMsbGV2ZWw6cixwbGF0Zm9ybTpcImJyb3dzZXJcIixmcmFtZXdvcms6XCJicm93c2VyLWpzXCIsbGFuZ3VhZ2U6XCJqYXZhc2NyaXB0XCIsYm9keTp0aGlzLl9idWlsZEJvZHkodCxuLG8pLHJlcXVlc3Q6e3VybDp3aW5kb3cubG9jYXRpb24uaHJlZixxdWVyeV9zdHJpbmc6d2luZG93LmxvY2F0aW9uLnNlYXJjaCx1c2VyX2lwOlwiJHJlbW90ZV9pcFwifSxjbGllbnQ6e3J1bnRpbWVfbXM6ZS5nZXRUaW1lKCktd2luZG93Ll9nbG9iYWxSb2xsYmFyT3B0aW9ucy5zdGFydFRpbWUsdGltZXN0YW1wOk1hdGgucm91bmQoZS5nZXRUaW1lKCkvMWUzKSxqYXZhc2NyaXB0Onticm93c2VyOndpbmRvdy5uYXZpZ2F0b3IudXNlckFnZW50LGxhbmd1YWdlOndpbmRvdy5uYXZpZ2F0b3IubGFuZ3VhZ2UsY29va2llX2VuYWJsZWQ6d2luZG93Lm5hdmlnYXRvci5jb29raWVFbmFibGVkLHNjcmVlbjp7d2lkdGg6d2luZG93LnNjcmVlbi53aWR0aCxoZWlnaHQ6d2luZG93LnNjcmVlbi5oZWlnaHR9LHBsdWdpbnM6dGhpcy5fZ2V0QnJvd3NlclBsdWdpbnMoKX19LHNlcnZlcjp7fSxub3RpZmllcjp7bmFtZTpcInJvbGxiYXItYnJvd3Nlci1qc1wiLHZlcnNpb246cy5OT1RJRklFUl9WRVJTSU9OfX07dS5ib2R5JiZkZWxldGUgdS5ib2R5O3ZhciBwPXthY2Nlc3NfdG9rZW46aSxkYXRhOmcoITAsbCx1KX07cmV0dXJuIHRoaXMuX3NjcnViKHAuZGF0YSkscH0seC5fYnVpbGRCb2R5PWZ1bmN0aW9uKGUscix0KXt2YXIgbjtyZXR1cm4gbj1yP3AoZSxyLHQpOmwoZSx0KX0seC5fZ2V0QnJvd3NlclBsdWdpbnM9ZnVuY3Rpb24oKXtpZighdGhpcy5fYnJvd3NlclBsdWdpbnMpe3ZhciBlLHIsdD13aW5kb3cubmF2aWdhdG9yLnBsdWdpbnN8fFtdLG49dC5sZW5ndGgsbz1bXTtmb3Iocj0wO3I8bjsrK3IpZT10W3JdLG8ucHVzaCh7bmFtZTplLm5hbWUsZGVzY3JpcHRpb246ZS5kZXNjcmlwdGlvbn0pO3RoaXMuX2Jyb3dzZXJQbHVnaW5zPW99cmV0dXJuIHRoaXMuX2Jyb3dzZXJQbHVnaW5zfSx4Ll9zY3J1Yj1mdW5jdGlvbihlKXtmdW5jdGlvbiByKGUscix0LG4sbyxpKXtyZXR1cm4gcit2LnJlZGFjdChpKX1mdW5jdGlvbiB0KGUpe3ZhciB0O2lmKHYuaXNUeXBlKGUsXCJzdHJpbmdcIikpZm9yKHQ9MDt0PHMubGVuZ3RoOysrdCllPWUucmVwbGFjZShzW3RdLHIpO3JldHVybiBlfWZ1bmN0aW9uIG4oZSxyKXt2YXIgdDtmb3IodD0wO3Q8YS5sZW5ndGg7Kyt0KWlmKGFbdF0udGVzdChlKSl7cj12LnJlZGFjdChyKTticmVha31yZXR1cm4gcn1mdW5jdGlvbiBvKGUscil7dmFyIG89bihlLHIpO3JldHVybiBvPT09cj90KG8pOm99dmFyIGk9dGhpcy5vcHRpb25zLnNjcnViRmllbGRzLGE9dGhpcy5fZ2V0U2NydWJGaWVsZFJlZ2V4cyhpKSxzPXRoaXMuX2dldFNjcnViUXVlcnlQYXJhbVJlZ2V4cyhpKTtyZXR1cm4gdi50cmF2ZXJzZShlLG8pLGV9LHguX2dldFNjcnViRmllbGRSZWdleHM9ZnVuY3Rpb24oZSl7Zm9yKHZhciByLHQ9W10sbj0wO248ZS5sZW5ndGg7KytuKXI9XCJcXFxcWz8oJTVbYkJdKT9cIitlW25dK1wiXFxcXFs/KCU1W2JCXSk/XFxcXF0/KCU1W2REXSk/XCIsdC5wdXNoKG5ldyBSZWdFeHAocixcImlcIikpO3JldHVybiB0fSx4Ll9nZXRTY3J1YlF1ZXJ5UGFyYW1SZWdleHM9ZnVuY3Rpb24oZSl7Zm9yKHZhciByLHQ9W10sbj0wO248ZS5sZW5ndGg7KytuKXI9XCJcXFxcWz8oJTVbYkJdKT9cIitlW25dK1wiXFxcXFs/KCU1W2JCXSk/XFxcXF0/KCU1W2REXSk/XCIsdC5wdXNoKG5ldyBSZWdFeHAoXCIoXCIrcitcIj0pKFteJlxcXFxuXSspXCIsXCJpZ21cIikpO3JldHVybiB0fSx4Ll91cmxJc1doaXRlbGlzdGVkPWZ1bmN0aW9uKGUpe3ZhciByLHQsbixvLGksYSxzLHUsYyxsO3RyeXtpZihyPXRoaXMub3B0aW9ucy5ob3N0V2hpdGVMaXN0LHQ9ZSYmZS5kYXRhJiZlLmRhdGEuYm9keSYmZS5kYXRhLmJvZHkudHJhY2UsIXJ8fDA9PT1yLmxlbmd0aClyZXR1cm4hMDtpZighdClyZXR1cm4hMDtmb3Iocz1yLmxlbmd0aCxpPXQuZnJhbWVzLmxlbmd0aCxjPTA7YzxpO2MrKyl7aWYobj10LmZyYW1lc1tjXSxvPW4uZmlsZW5hbWUsIXYuaXNUeXBlKG8sXCJzdHJpbmdcIikpcmV0dXJuITA7Zm9yKGw9MDtsPHM7bCsrKWlmKGE9cltsXSx1PW5ldyBSZWdFeHAoYSksdS50ZXN0KG8pKXJldHVybiEwfX1jYXRjaChwKXtyZXR1cm4gdGhpcy5jb25maWd1cmUoe2hvc3RXaGl0ZUxpc3Q6bnVsbH0pLGNvbnNvbGUuZXJyb3IoXCJbUm9sbGJhcl06IEVycm9yIHdoaWxlIHJlYWRpbmcgeW91ciBjb25maWd1cmF0aW9uJ3MgaG9zdFdoaXRlTGlzdCBvcHRpb24uIFJlbW92aW5nIGN1c3RvbSBob3N0V2hpdGVMaXN0LlwiLHApLCEwfXJldHVybiExfSx4Ll9tZXNzYWdlSXNJZ25vcmVkPWZ1bmN0aW9uKGUpe3ZhciByLHQsbixvLGksYSxzLHUsYzt0cnl7aWYoaT0hMSxuPXRoaXMub3B0aW9ucy5pZ25vcmVkTWVzc2FnZXMsIW58fDA9PT1uLmxlbmd0aClyZXR1cm4hMTtpZihzPWUmJmUuZGF0YSYmZS5kYXRhLmJvZHksdT1zJiZzLnRyYWNlJiZzLnRyYWNlLmV4Y2VwdGlvbiYmcy50cmFjZS5leGNlcHRpb24ubWVzc2FnZSxjPXMmJnMubWVzc2FnZSYmcy5tZXNzYWdlLmJvZHkscj11fHxjLCFyKXJldHVybiExO2ZvcihvPW4ubGVuZ3RoLHQ9MDt0PG8mJihhPW5ldyBSZWdFeHAoblt0XSxcImdpXCIpLCEoaT1hLnRlc3QocikpKTt0KyspO31jYXRjaChsKXt0aGlzLmNvbmZpZ3VyZSh7aWdub3JlZE1lc3NhZ2VzOm51bGx9KSxjb25zb2xlLmVycm9yKFwiW1JvbGxiYXJdOiBFcnJvciB3aGlsZSByZWFkaW5nIHlvdXIgY29uZmlndXJhdGlvbidzIGlnbm9yZWRNZXNzYWdlcyBvcHRpb24uIFJlbW92aW5nIGN1c3RvbSBpZ25vcmVkTWVzc2FnZXMuXCIpfXJldHVybiBpfSx4Ll9lbnF1ZXVlUGF5bG9hZD1mdW5jdGlvbihlLHIsdCxuKXt2YXIgbz17Y2FsbGJhY2s6bixhY2Nlc3NUb2tlbjp0aGlzLm9wdGlvbnMuYWNjZXNzVG9rZW4sZW5kcG9pbnRVcmw6dGhpcy5fcm91dGUoXCJpdGVtL1wiKSxwYXlsb2FkOmV9LGk9ZnVuY3Rpb24oKXtpZihuKXt2YXIgZT1cIlRoaXMgaXRlbSB3YXMgbm90IHNlbnQgdG8gUm9sbGJhciBiZWNhdXNlIGl0IHdhcyBpZ25vcmVkLiBUaGlzIGNhbiBoYXBwZW4gaWYgYSBjdXN0b20gY2hlY2tJZ25vcmUoKSBmdW5jdGlvbiB3YXMgdXNlZCBvciBpZiB0aGUgaXRlbSdzIGxldmVsIHdhcyBsZXNzIHRoYW4gdGhlIG5vdGlmaWVyJyByZXBvcnRMZXZlbC4gU2VlIGh0dHBzOi8vcm9sbGJhci5jb20vZG9jcy9ub3RpZmllci9yb2xsYmFyLmpzL2NvbmZpZ3VyYXRpb24gZm9yIG1vcmUgZGV0YWlscy5cIjtuKG51bGwse2VycjowLHJlc3VsdDp7aWQ6bnVsbCx1dWlkOm51bGwsbWVzc2FnZTplfX0pfX07aWYodGhpcy5faW50ZXJuYWxDaGVja0lnbm9yZShyLHQsZSkpcmV0dXJuIHZvaWQgaSgpO3RyeXtpZih2LmlzVHlwZSh0aGlzLm9wdGlvbnMuY2hlY2tJZ25vcmUsXCJmdW5jdGlvblwiKSYmdGhpcy5vcHRpb25zLmNoZWNrSWdub3JlKHIsdCxlKSlyZXR1cm4gdm9pZCBpKCl9Y2F0Y2goYSl7dGhpcy5jb25maWd1cmUoe2NoZWNrSWdub3JlOm51bGx9KSxjb25zb2xlLmVycm9yKFwiW1JvbGxiYXJdOiBFcnJvciB3aGlsZSBjYWxsaW5nIGN1c3RvbSBjaGVja0lnbm9yZSgpIGZ1bmN0aW9uLiBSZW1vdmluZyBjdXN0b20gY2hlY2tJZ25vcmUoKS5cIixhKX1pZih0aGlzLl91cmxJc1doaXRlbGlzdGVkKGUpJiYhdGhpcy5fbWVzc2FnZUlzSWdub3JlZChlKSl7aWYodGhpcy5vcHRpb25zLnZlcmJvc2Upe2lmKGUuZGF0YSYmZS5kYXRhLmJvZHkmJmUuZGF0YS5ib2R5LnRyYWNlKXt2YXIgcz1lLmRhdGEuYm9keS50cmFjZSxjPXMuZXhjZXB0aW9uLm1lc3NhZ2U7Y29uc29sZS5lcnJvcihcIltSb2xsYmFyXTogXCIsYyl9Y29uc29sZS5pbmZvKFwiW1JvbGxiYXJdOiBcIixvKX12LmlzVHlwZSh0aGlzLm9wdGlvbnMubG9nRnVuY3Rpb24sXCJmdW5jdGlvblwiKSYmdGhpcy5vcHRpb25zLmxvZ0Z1bmN0aW9uKG8pO3RyeXt2LmlzVHlwZSh0aGlzLm9wdGlvbnMudHJhbnNmb3JtLFwiZnVuY3Rpb25cIikmJnRoaXMub3B0aW9ucy50cmFuc2Zvcm0oZSl9Y2F0Y2goYSl7dGhpcy5jb25maWd1cmUoe3RyYW5zZm9ybTpudWxsfSksY29uc29sZS5lcnJvcihcIltSb2xsYmFyXTogRXJyb3Igd2hpbGUgY2FsbGluZyBjdXN0b20gdHJhbnNmb3JtKCkgZnVuY3Rpb24uIFJlbW92aW5nIGN1c3RvbSB0cmFuc2Zvcm0oKS5cIixhKX10aGlzLm9wdGlvbnMuZW5hYmxlZCYmdShvKX19LHguX2ludGVybmFsQ2hlY2tJZ25vcmU9ZnVuY3Rpb24oZSxyLHQpe3ZhciBuPXJbMF0sbz1zLkxFVkVMU1tuXXx8MCxpPXMuTEVWRUxTW3RoaXMub3B0aW9ucy5yZXBvcnRMZXZlbF18fDA7aWYobzxpKXJldHVybiEwO3ZhciBhPXRoaXMub3B0aW9ucz90aGlzLm9wdGlvbnMucGx1Z2luczp7fTtpZihhJiZhLmpxdWVyeSYmYS5qcXVlcnkuaWdub3JlQWpheEVycm9ycyl0cnl7cmV0dXJuISF0LmRhdGEuYm9keS5tZXNzYWdlLmV4dHJhLmlzQWpheH1jYXRjaCh1KXtyZXR1cm4hMX1yZXR1cm4hMX0seC5fbG9nPWZ1bmN0aW9uKGUscix0LG4sbyxpLGEpe3ZhciBzPW51bGw7aWYodCl0cnl7aWYocz10Ll9zYXZlZFN0YWNrVHJhY2U/dC5fc2F2ZWRTdGFja1RyYWNlOm0ucGFyc2UodCksdD09PXRoaXMubGFzdEVycm9yKXJldHVybjt0aGlzLmxhc3RFcnJvcj10fWNhdGNoKHUpe2NvbnNvbGUuZXJyb3IoXCJbUm9sbGJhcl06IEVycm9yIHdoaWxlIHBhcnNpbmcgdGhlIGVycm9yIG9iamVjdC5cIix1KSxyPXQubWVzc2FnZXx8dC5kZXNjcmlwdGlvbnx8cnx8U3RyaW5nKHQpLHQ9bnVsbH12YXIgYz10aGlzLl9idWlsZFBheWxvYWQobmV3IERhdGUsZSxyLHMsbik7YSYmKGMuaWdub3JlUmF0ZUxpbWl0PSEwKSx0aGlzLl9lbnF1ZXVlUGF5bG9hZChjLCEhaSxbZSxyLHQsbl0sbyl9LHgubG9nPWMoKSx4LmRlYnVnPWMoXCJkZWJ1Z1wiKSx4LmluZm89YyhcImluZm9cIikseC53YXJuPWMoXCJ3YXJuaW5nXCIpLHgud2FybmluZz1jKFwid2FybmluZ1wiKSx4LmVycm9yPWMoXCJlcnJvclwiKSx4LmNyaXRpY2FsPWMoXCJjcml0aWNhbFwiKSx4LnVuY2F1Z2h0RXJyb3I9byhmdW5jdGlvbihlLHIsdCxuLG8saSl7aWYoaT1pfHxudWxsLG8mJnYuaXNUeXBlKG8sXCJlcnJvclwiKSlyZXR1cm4gdm9pZCB0aGlzLl9sb2codGhpcy5vcHRpb25zLnVuY2F1Z2h0RXJyb3JMZXZlbCxlLG8saSxudWxsLCEwKTtpZihyJiZ2LmlzVHlwZShyLFwiZXJyb3JcIikpcmV0dXJuIHZvaWQgdGhpcy5fbG9nKHRoaXMub3B0aW9ucy51bmNhdWdodEVycm9yTGV2ZWwsZSxyLGksbnVsbCwhMCk7dmFyIGE9e3VybDpyfHxcIlwiLGxpbmU6dH07YS5mdW5jPW0uZ3Vlc3NGdW5jdGlvbk5hbWUoYS51cmwsYS5saW5lKSxhLmNvbnRleHQ9bS5nYXRoZXJDb250ZXh0KGEudXJsLGEubGluZSk7dmFyIHM9e21vZGU6XCJvbmVycm9yXCIsbWVzc2FnZTpvP1N0cmluZyhvKTplfHxcInVuY2F1Z2h0IGV4Y2VwdGlvblwiLHVybDpkb2N1bWVudC5sb2NhdGlvbi5ocmVmLHN0YWNrOlthXSx1c2VyYWdlbnQ6bmF2aWdhdG9yLnVzZXJBZ2VudH0sdT10aGlzLl9idWlsZFBheWxvYWQobmV3IERhdGUsdGhpcy5vcHRpb25zLnVuY2F1Z2h0RXJyb3JMZXZlbCxlLHMsaSk7dGhpcy5fZW5xdWV1ZVBheWxvYWQodSwhMCxbdGhpcy5vcHRpb25zLnVuY2F1Z2h0RXJyb3JMZXZlbCxlLHIsdCxuLG9dKX0pLHgudW5oYW5kbGVkUmVqZWN0aW9uPW8oZnVuY3Rpb24oZSxyKXtpZihudWxsPT1lKXJldHVybiB2b2lkIF8uX2xvZyhfLm9wdGlvbnMudW5jYXVnaHRFcnJvckxldmVsLFwidW5oYW5kbGVkIHJlamVjdGlvbiB3YXMgbnVsbCBvciB1bmRlZmluZWQhXCIsbnVsbCx7fSxudWxsLCExLCExKTt2YXIgdD1lLm1lc3NhZ2V8fChlP1N0cmluZyhlKTpcInVuaGFuZGxlZCByZWplY3Rpb25cIiksbj1lLl9yb2xsYmFyQ29udGV4dHx8ci5fcm9sbGJhckNvbnRleHR8fG51bGw7aWYoZSYmdi5pc1R5cGUoZSxcImVycm9yXCIpKXJldHVybiB2b2lkIHRoaXMuX2xvZyh0aGlzLm9wdGlvbnMudW5jYXVnaHRFcnJvckxldmVsLHQsZSxuLG51bGwsITApO3ZhciBvPXt1cmw6XCJcIixsaW5lOjB9O28uZnVuYz1tLmd1ZXNzRnVuY3Rpb25OYW1lKG8udXJsLG8ubGluZSksby5jb250ZXh0PW0uZ2F0aGVyQ29udGV4dChvLnVybCxvLmxpbmUpO3ZhciBpPXttb2RlOlwidW5oYW5kbGVkcmVqZWN0aW9uXCIsbWVzc2FnZTp0LHVybDpkb2N1bWVudC5sb2NhdGlvbi5ocmVmLHN0YWNrOltvXSx1c2VyYWdlbnQ6bmF2aWdhdG9yLnVzZXJBZ2VudH0sYT10aGlzLl9idWlsZFBheWxvYWQobmV3IERhdGUsdGhpcy5vcHRpb25zLnVuY2F1Z2h0RXJyb3JMZXZlbCx0LGksbik7dGhpcy5fZW5xdWV1ZVBheWxvYWQoYSwhMCxbdGhpcy5vcHRpb25zLnVuY2F1Z2h0RXJyb3JMZXZlbCx0LG8udXJsLG8ubGluZSwwLGUscl0pfSkseC5nbG9iYWw9byhmdW5jdGlvbihlKXtlPWV8fHt9O3ZhciByPXtzdGFydFRpbWU6ZS5zdGFydFRpbWUsbWF4SXRlbXM6ZS5tYXhJdGVtcyxpdGVtc1Blck1pbnV0ZTplLml0ZW1zUGVyTWludXRlfTtnKCEwLHdpbmRvdy5fZ2xvYmFsUm9sbGJhck9wdGlvbnMsciksdm9pZCAwIT09ZS5tYXhJdGVtcyYmKFQ9MCksdm9pZCAwIT09ZS5pdGVtc1Blck1pbnV0ZSYmKFI9MCl9KSx4LmNvbmZpZ3VyZT1vKGZ1bmN0aW9uKGUscil7dmFyIHQ9ZyghMCx7fSxlKTtnKCFyLHRoaXMub3B0aW9ucyx0KSx0aGlzLmdsb2JhbCh0KX0pLHguc2NvcGU9byhmdW5jdGlvbihlKXt2YXIgcj1uZXcgcyh0aGlzKTtyZXR1cm4gZyghMCxyLm9wdGlvbnMucGF5bG9hZCxlKSxyfSkseC53cmFwPWZ1bmN0aW9uKGUscil7dHJ5e3ZhciB0O2lmKHQ9di5pc1R5cGUocixcImZ1bmN0aW9uXCIpP3I6ZnVuY3Rpb24oKXtyZXR1cm4gcnx8e319LCF2LmlzVHlwZShlLFwiZnVuY3Rpb25cIikpcmV0dXJuIGU7aWYoZS5faXNXcmFwKXJldHVybiBlO2lmKCFlLl93cmFwcGVkKXtlLl93cmFwcGVkPWZ1bmN0aW9uKCl7dHJ5e3JldHVybiBlLmFwcGx5KHRoaXMsYXJndW1lbnRzKX1jYXRjaChyKXt0aHJvd1wic3RyaW5nXCI9PXR5cGVvZiByJiYocj1uZXcgU3RyaW5nKHIpKSxyLnN0YWNrfHwoci5fc2F2ZWRTdGFja1RyYWNlPW0ucGFyc2UocikpLHIuX3JvbGxiYXJDb250ZXh0PXQoKXx8e30sci5fcm9sbGJhckNvbnRleHQuX3dyYXBwZWRTb3VyY2U9ZS50b1N0cmluZygpLHdpbmRvdy5fcm9sbGJhcldyYXBwZWRFcnJvcj1yLHJ9fSxlLl93cmFwcGVkLl9pc1dyYXA9ITA7Zm9yKHZhciBuIGluIGUpZS5oYXNPd25Qcm9wZXJ0eShuKSYmKGUuX3dyYXBwZWRbbl09ZVtuXSl9cmV0dXJuIGUuX3dyYXBwZWR9Y2F0Y2gobyl7cmV0dXJuIGV9fSx4LmxvYWRGdWxsPWZ1bmN0aW9uKCl7Y29uc29sZS5lcnJvcihcIltSb2xsYmFyXTogVW5leHBlY3RlZCBSb2xsYmFyLmxvYWRGdWxsKCkgY2FsbGVkIG9uIGEgTm90aWZpZXIgaW5zdGFuY2VcIil9LHMucHJvY2Vzc1BheWxvYWRzPWZ1bmN0aW9uKGUpe3JldHVybiBlP3ZvaWQgZigpOnZvaWQgaSgpfTt2YXIgTD0obmV3IERhdGUpLmdldFRpbWUoKSxUPTAsUj0wO2UuZXhwb3J0cz17Tm90aWZpZXI6cyxzZXR1cEpTT046bix0b3BMZXZlbE5vdGlmaWVyOmF9fSxmdW5jdGlvbihlLHIpe1widXNlIHN0cmljdFwiO3ZhciB0PU9iamVjdC5wcm90b3R5cGUuaGFzT3duUHJvcGVydHksbj1PYmplY3QucHJvdG90eXBlLnRvU3RyaW5nLG89ZnVuY3Rpb24oZSl7cmV0dXJuXCJmdW5jdGlvblwiPT10eXBlb2YgQXJyYXkuaXNBcnJheT9BcnJheS5pc0FycmF5KGUpOlwiW29iamVjdCBBcnJheV1cIj09PW4uY2FsbChlKX0saT1mdW5jdGlvbihlKXtpZighZXx8XCJbb2JqZWN0IE9iamVjdF1cIiE9PW4uY2FsbChlKSlyZXR1cm4hMTt2YXIgcj10LmNhbGwoZSxcImNvbnN0cnVjdG9yXCIpLG89ZS5jb25zdHJ1Y3RvciYmZS5jb25zdHJ1Y3Rvci5wcm90b3R5cGUmJnQuY2FsbChlLmNvbnN0cnVjdG9yLnByb3RvdHlwZSxcImlzUHJvdG90eXBlT2ZcIik7aWYoZS5jb25zdHJ1Y3RvciYmIXImJiFvKXJldHVybiExO3ZhciBpO2ZvcihpIGluIGUpO3JldHVyblwidW5kZWZpbmVkXCI9PXR5cGVvZiBpfHx0LmNhbGwoZSxpKX07ZS5leHBvcnRzPWZ1bmN0aW9uIGEoKXt2YXIgZSxyLHQsbixzLHUsYz1hcmd1bWVudHNbMF0sbD0xLHA9YXJndW1lbnRzLmxlbmd0aCxmPSExO2ZvcihcImJvb2xlYW5cIj09dHlwZW9mIGM/KGY9YyxjPWFyZ3VtZW50c1sxXXx8e30sbD0yKTooXCJvYmplY3RcIiE9dHlwZW9mIGMmJlwiZnVuY3Rpb25cIiE9dHlwZW9mIGN8fG51bGw9PWMpJiYoYz17fSk7bDxwOysrbClpZihlPWFyZ3VtZW50c1tsXSxudWxsIT1lKWZvcihyIGluIGUpdD1jW3JdLG49ZVtyXSxjIT09biYmKGYmJm4mJihpKG4pfHwocz1vKG4pKSk/KHM/KHM9ITEsdT10JiZvKHQpP3Q6W10pOnU9dCYmaSh0KT90Ont9LGNbcl09YShmLHUsbikpOlwidW5kZWZpbmVkXCIhPXR5cGVvZiBuJiYoY1tyXT1uKSk7cmV0dXJuIGN9fSxmdW5jdGlvbihlLHIsdCl7XCJ1c2Ugc3RyaWN0XCI7ZnVuY3Rpb24gbigpe3JldHVybiBsfWZ1bmN0aW9uIG8oKXtyZXR1cm4gbnVsbH1mdW5jdGlvbiBpKGUpe3ZhciByPXt9O3JldHVybiByLl9zdGFja0ZyYW1lPWUsci51cmw9ZS5maWxlTmFtZSxyLmxpbmU9ZS5saW5lTnVtYmVyLHIuZnVuYz1lLmZ1bmN0aW9uTmFtZSxyLmNvbHVtbj1lLmNvbHVtbk51bWJlcixyLmFyZ3M9ZS5hcmdzLHIuY29udGV4dD1vKHIudXJsLHIubGluZSkscn1mdW5jdGlvbiBhKGUpe2Z1bmN0aW9uIHIoKXt2YXIgcj1bXTt0cnl7cj1jLnBhcnNlKGUpfWNhdGNoKHQpe3I9W119Zm9yKHZhciBuPVtdLG89MDtvPHIubGVuZ3RoO28rKyluLnB1c2gobmV3IGkocltvXSkpO3JldHVybiBufXJldHVybntzdGFjazpyKCksbWVzc2FnZTplLm1lc3NhZ2UsbmFtZTplLm5hbWV9fWZ1bmN0aW9uIHMoZSl7cmV0dXJuIG5ldyBhKGUpfWZ1bmN0aW9uIHUoZSl7aWYoIWUpcmV0dXJuW1wiVW5rbm93biBlcnJvci4gVGhlcmUgd2FzIG5vIGVycm9yIG1lc3NhZ2UgdG8gZGlzcGxheS5cIixcIlwiXTt2YXIgcj1lLm1hdGNoKHApLHQ9XCIodW5rbm93bilcIjtyZXR1cm4gciYmKHQ9cltyLmxlbmd0aC0xXSxlPWUucmVwbGFjZSgocltyLmxlbmd0aC0yXXx8XCJcIikrdCtcIjpcIixcIlwiKSxlPWUucmVwbGFjZSgvKF5bXFxzXSt8W1xcc10rJCkvZyxcIlwiKSksW3QsZV19dmFyIGM9dCg2KSxsPVwiP1wiLHA9bmV3IFJlZ0V4cChcIl4oKFthLXpBLVowLTktXyQgXSopOiAqKT8oVW5jYXVnaHQgKT8oW2EtekEtWjAtOS1fJCBdKik6IFwiKTtlLmV4cG9ydHM9e2d1ZXNzRnVuY3Rpb25OYW1lOm4sZ3Vlc3NFcnJvckNsYXNzOnUsZ2F0aGVyQ29udGV4dDpvLHBhcnNlOnMsU3RhY2s6YSxGcmFtZTppfX0sZnVuY3Rpb24oZSxyLHQpe3ZhciBuLG8saTshZnVuY3Rpb24oYSxzKXtcInVzZSBzdHJpY3RcIjtvPVt0KDcpXSxuPXMsaT1cImZ1bmN0aW9uXCI9PXR5cGVvZiBuP24uYXBwbHkocixvKTpuLCEodm9pZCAwIT09aSYmKGUuZXhwb3J0cz1pKSl9KHRoaXMsZnVuY3Rpb24oZSl7XCJ1c2Ugc3RyaWN0XCI7ZnVuY3Rpb24gcihlLHIsdCl7aWYoXCJmdW5jdGlvblwiPT10eXBlb2YgQXJyYXkucHJvdG90eXBlLm1hcClyZXR1cm4gZS5tYXAocix0KTtmb3IodmFyIG49bmV3IEFycmF5KGUubGVuZ3RoKSxvPTA7bzxlLmxlbmd0aDtvKyspbltvXT1yLmNhbGwodCxlW29dKTtyZXR1cm4gbn1mdW5jdGlvbiB0KGUscix0KXtpZihcImZ1bmN0aW9uXCI9PXR5cGVvZiBBcnJheS5wcm90b3R5cGUuZmlsdGVyKXJldHVybiBlLmZpbHRlcihyLHQpO2Zvcih2YXIgbj1bXSxvPTA7bzxlLmxlbmd0aDtvKyspci5jYWxsKHQsZVtvXSkmJm4ucHVzaChlW29dKTtyZXR1cm4gbn12YXIgbj0vKF58QClcXFMrXFw6XFxkKy8sbz0vXlxccyphdCAuKihcXFMrXFw6XFxkK3xcXChuYXRpdmVcXCkpL20saT0vXihldmFsQCk/KFxcW25hdGl2ZSBjb2RlXFxdKT8kLztyZXR1cm57cGFyc2U6ZnVuY3Rpb24oZSl7aWYoXCJ1bmRlZmluZWRcIiE9dHlwZW9mIGUuc3RhY2t0cmFjZXx8XCJ1bmRlZmluZWRcIiE9dHlwZW9mIGVbXCJvcGVyYSNzb3VyY2Vsb2NcIl0pcmV0dXJuIHRoaXMucGFyc2VPcGVyYShlKTtpZihlLnN0YWNrJiZlLnN0YWNrLm1hdGNoKG8pKXJldHVybiB0aGlzLnBhcnNlVjhPcklFKGUpO2lmKGUuc3RhY2spcmV0dXJuIHRoaXMucGFyc2VGRk9yU2FmYXJpKGUpO3Rocm93IG5ldyBFcnJvcihcIkNhbm5vdCBwYXJzZSBnaXZlbiBFcnJvciBvYmplY3RcIil9LGV4dHJhY3RMb2NhdGlvbjpmdW5jdGlvbihlKXtpZihlLmluZGV4T2YoXCI6XCIpPT09LTEpcmV0dXJuW2VdO3ZhciByPWUucmVwbGFjZSgvW1xcKFxcKVxcc10vZyxcIlwiKS5zcGxpdChcIjpcIiksdD1yLnBvcCgpLG49cltyLmxlbmd0aC0xXTtpZighaXNOYU4ocGFyc2VGbG9hdChuKSkmJmlzRmluaXRlKG4pKXt2YXIgbz1yLnBvcCgpO3JldHVybltyLmpvaW4oXCI6XCIpLG8sdF19cmV0dXJuW3Iuam9pbihcIjpcIiksdCx2b2lkIDBdfSxwYXJzZVY4T3JJRTpmdW5jdGlvbihuKXt2YXIgaT10KG4uc3RhY2suc3BsaXQoXCJcXG5cIiksZnVuY3Rpb24oZSl7cmV0dXJuISFlLm1hdGNoKG8pfSx0aGlzKTtyZXR1cm4gcihpLGZ1bmN0aW9uKHIpe3IuaW5kZXhPZihcIihldmFsIFwiKT4tMSYmKHI9ci5yZXBsYWNlKC9ldmFsIGNvZGUvZyxcImV2YWxcIikucmVwbGFjZSgvKFxcKGV2YWwgYXQgW15cXCgpXSopfChcXClcXCwuKiQpL2csXCJcIikpO3ZhciB0PXIucmVwbGFjZSgvXlxccysvLFwiXCIpLnJlcGxhY2UoL1xcKGV2YWwgY29kZS9nLFwiKFwiKS5zcGxpdCgvXFxzKy8pLnNsaWNlKDEpLG49dGhpcy5leHRyYWN0TG9jYXRpb24odC5wb3AoKSksbz10LmpvaW4oXCIgXCIpfHx2b2lkIDAsaT1cImV2YWxcIj09PW5bMF0/dm9pZCAwOm5bMF07cmV0dXJuIG5ldyBlKG8sKHZvaWQgMCksaSxuWzFdLG5bMl0scil9LHRoaXMpfSxwYXJzZUZGT3JTYWZhcmk6ZnVuY3Rpb24obil7dmFyIG89dChuLnN0YWNrLnNwbGl0KFwiXFxuXCIpLGZ1bmN0aW9uKGUpe3JldHVybiFlLm1hdGNoKGkpfSx0aGlzKTtyZXR1cm4gcihvLGZ1bmN0aW9uKHIpe2lmKHIuaW5kZXhPZihcIiA+IGV2YWxcIik+LTEmJihyPXIucmVwbGFjZSgvIGxpbmUgKFxcZCspKD86ID4gZXZhbCBsaW5lIFxcZCspKiA+IGV2YWxcXDpcXGQrXFw6XFxkKy9nLFwiOiQxXCIpKSxyLmluZGV4T2YoXCJAXCIpPT09LTEmJnIuaW5kZXhPZihcIjpcIik9PT0tMSlyZXR1cm4gbmV3IGUocik7dmFyIHQ9ci5zcGxpdChcIkBcIiksbj10aGlzLmV4dHJhY3RMb2NhdGlvbih0LnBvcCgpKSxvPXQuc2hpZnQoKXx8dm9pZCAwO3JldHVybiBuZXcgZShvLCh2b2lkIDApLG5bMF0sblsxXSxuWzJdLHIpfSx0aGlzKX0scGFyc2VPcGVyYTpmdW5jdGlvbihlKXtyZXR1cm4hZS5zdGFja3RyYWNlfHxlLm1lc3NhZ2UuaW5kZXhPZihcIlxcblwiKT4tMSYmZS5tZXNzYWdlLnNwbGl0KFwiXFxuXCIpLmxlbmd0aD5lLnN0YWNrdHJhY2Uuc3BsaXQoXCJcXG5cIikubGVuZ3RoP3RoaXMucGFyc2VPcGVyYTkoZSk6ZS5zdGFjaz90aGlzLnBhcnNlT3BlcmExMShlKTp0aGlzLnBhcnNlT3BlcmExMChlKX0scGFyc2VPcGVyYTk6ZnVuY3Rpb24ocil7Zm9yKHZhciB0PS9MaW5lIChcXGQrKS4qc2NyaXB0ICg/OmluICk/KFxcUyspL2ksbj1yLm1lc3NhZ2Uuc3BsaXQoXCJcXG5cIiksbz1bXSxpPTIsYT1uLmxlbmd0aDtpPGE7aSs9Mil7dmFyIHM9dC5leGVjKG5baV0pO3MmJm8ucHVzaChuZXcgZSgodm9pZCAwKSwodm9pZCAwKSxzWzJdLHNbMV0sKHZvaWQgMCksbltpXSkpfXJldHVybiBvfSxwYXJzZU9wZXJhMTA6ZnVuY3Rpb24ocil7Zm9yKHZhciB0PS9MaW5lIChcXGQrKS4qc2NyaXB0ICg/OmluICk/KFxcUyspKD86OiBJbiBmdW5jdGlvbiAoXFxTKykpPyQvaSxuPXIuc3RhY2t0cmFjZS5zcGxpdChcIlxcblwiKSxvPVtdLGk9MCxhPW4ubGVuZ3RoO2k8YTtpKz0yKXt2YXIgcz10LmV4ZWMobltpXSk7cyYmby5wdXNoKG5ldyBlKHNbM118fHZvaWQgMCwodm9pZCAwKSxzWzJdLHNbMV0sKHZvaWQgMCksbltpXSkpfXJldHVybiBvfSxwYXJzZU9wZXJhMTE6ZnVuY3Rpb24obyl7dmFyIGk9dChvLnN0YWNrLnNwbGl0KFwiXFxuXCIpLGZ1bmN0aW9uKGUpe3JldHVybiEhZS5tYXRjaChuKSYmIWUubWF0Y2goL15FcnJvciBjcmVhdGVkIGF0Lyl9LHRoaXMpO3JldHVybiByKGksZnVuY3Rpb24ocil7dmFyIHQsbj1yLnNwbGl0KFwiQFwiKSxvPXRoaXMuZXh0cmFjdExvY2F0aW9uKG4ucG9wKCkpLGk9bi5zaGlmdCgpfHxcIlwiLGE9aS5yZXBsYWNlKC88YW5vbnltb3VzIGZ1bmN0aW9uKDogKFxcdyspKT8+LyxcIiQyXCIpLnJlcGxhY2UoL1xcKFteXFwpXSpcXCkvZyxcIlwiKXx8dm9pZCAwO2kubWF0Y2goL1xcKChbXlxcKV0qKVxcKS8pJiYodD1pLnJlcGxhY2UoL15bXlxcKF0rXFwoKFteXFwpXSopXFwpJC8sXCIkMVwiKSk7dmFyIHM9dm9pZCAwPT09dHx8XCJbYXJndW1lbnRzIG5vdCBhdmFpbGFibGVdXCI9PT10P3ZvaWQgMDp0LnNwbGl0KFwiLFwiKTtyZXR1cm4gbmV3IGUoYSxzLG9bMF0sb1sxXSxvWzJdLHIpfSx0aGlzKX19fSl9LGZ1bmN0aW9uKGUscix0KXt2YXIgbixvLGk7IWZ1bmN0aW9uKHQsYSl7XCJ1c2Ugc3RyaWN0XCI7bz1bXSxuPWEsaT1cImZ1bmN0aW9uXCI9PXR5cGVvZiBuP24uYXBwbHkocixvKTpuLCEodm9pZCAwIT09aSYmKGUuZXhwb3J0cz1pKSl9KHRoaXMsZnVuY3Rpb24oKXtcInVzZSBzdHJpY3RcIjtmdW5jdGlvbiBlKGUpe3JldHVybiFpc05hTihwYXJzZUZsb2F0KGUpKSYmaXNGaW5pdGUoZSl9ZnVuY3Rpb24gcihlLHIsdCxuLG8saSl7dm9pZCAwIT09ZSYmdGhpcy5zZXRGdW5jdGlvbk5hbWUoZSksdm9pZCAwIT09ciYmdGhpcy5zZXRBcmdzKHIpLHZvaWQgMCE9PXQmJnRoaXMuc2V0RmlsZU5hbWUodCksdm9pZCAwIT09biYmdGhpcy5zZXRMaW5lTnVtYmVyKG4pLHZvaWQgMCE9PW8mJnRoaXMuc2V0Q29sdW1uTnVtYmVyKG8pLHZvaWQgMCE9PWkmJnRoaXMuc2V0U291cmNlKGkpfXJldHVybiByLnByb3RvdHlwZT17Z2V0RnVuY3Rpb25OYW1lOmZ1bmN0aW9uKCl7cmV0dXJuIHRoaXMuZnVuY3Rpb25OYW1lfSxzZXRGdW5jdGlvbk5hbWU6ZnVuY3Rpb24oZSl7dGhpcy5mdW5jdGlvbk5hbWU9U3RyaW5nKGUpfSxnZXRBcmdzOmZ1bmN0aW9uKCl7cmV0dXJuIHRoaXMuYXJnc30sc2V0QXJnczpmdW5jdGlvbihlKXtpZihcIltvYmplY3QgQXJyYXldXCIhPT1PYmplY3QucHJvdG90eXBlLnRvU3RyaW5nLmNhbGwoZSkpdGhyb3cgbmV3IFR5cGVFcnJvcihcIkFyZ3MgbXVzdCBiZSBhbiBBcnJheVwiKTt0aGlzLmFyZ3M9ZX0sZ2V0RmlsZU5hbWU6ZnVuY3Rpb24oKXtyZXR1cm4gdGhpcy5maWxlTmFtZX0sc2V0RmlsZU5hbWU6ZnVuY3Rpb24oZSl7dGhpcy5maWxlTmFtZT1TdHJpbmcoZSl9LGdldExpbmVOdW1iZXI6ZnVuY3Rpb24oKXtyZXR1cm4gdGhpcy5saW5lTnVtYmVyfSxzZXRMaW5lTnVtYmVyOmZ1bmN0aW9uKHIpe2lmKCFlKHIpKXRocm93IG5ldyBUeXBlRXJyb3IoXCJMaW5lIE51bWJlciBtdXN0IGJlIGEgTnVtYmVyXCIpO3RoaXMubGluZU51bWJlcj1OdW1iZXIocil9LGdldENvbHVtbk51bWJlcjpmdW5jdGlvbigpe3JldHVybiB0aGlzLmNvbHVtbk51bWJlcn0sc2V0Q29sdW1uTnVtYmVyOmZ1bmN0aW9uKHIpe2lmKCFlKHIpKXRocm93IG5ldyBUeXBlRXJyb3IoXCJDb2x1bW4gTnVtYmVyIG11c3QgYmUgYSBOdW1iZXJcIik7dGhpcy5jb2x1bW5OdW1iZXI9TnVtYmVyKHIpfSxnZXRTb3VyY2U6ZnVuY3Rpb24oKXtyZXR1cm4gdGhpcy5zb3VyY2V9LHNldFNvdXJjZTpmdW5jdGlvbihlKXt0aGlzLnNvdXJjZT1TdHJpbmcoZSl9LHRvU3RyaW5nOmZ1bmN0aW9uKCl7dmFyIHI9dGhpcy5nZXRGdW5jdGlvbk5hbWUoKXx8XCJ7YW5vbnltb3VzfVwiLHQ9XCIoXCIrKHRoaXMuZ2V0QXJncygpfHxbXSkuam9pbihcIixcIikrXCIpXCIsbj10aGlzLmdldEZpbGVOYW1lKCk/XCJAXCIrdGhpcy5nZXRGaWxlTmFtZSgpOlwiXCIsbz1lKHRoaXMuZ2V0TGluZU51bWJlcigpKT9cIjpcIit0aGlzLmdldExpbmVOdW1iZXIoKTpcIlwiLGk9ZSh0aGlzLmdldENvbHVtbk51bWJlcigpKT9cIjpcIit0aGlzLmdldENvbHVtbk51bWJlcigpOlwiXCI7cmV0dXJuIHIrdCtuK28raX19LHJ9KX0sZnVuY3Rpb24oZSxyLHQpe1widXNlIHN0cmljdFwiO2Z1bmN0aW9uIG4oZSl7cmV0dXJue30udG9TdHJpbmcuY2FsbChlKS5tYXRjaCgvXFxzKFthLXpBLVpdKykvKVsxXS50b0xvd2VyQ2FzZSgpfWZ1bmN0aW9uIG8oZSxyKXtyZXR1cm4gbihlKT09PXJ9ZnVuY3Rpb24gaShlKXtpZighbyhlLFwic3RyaW5nXCIpKXRocm93IG5ldyBFcnJvcihcInJlY2VpdmVkIGludmFsaWQgaW5wdXRcIik7Zm9yKHZhciByPWwsdD1yLnBhcnNlcltyLnN0cmljdE1vZGU/XCJzdHJpY3RcIjpcImxvb3NlXCJdLmV4ZWMoZSksbj17fSxpPTE0O2ktLTspbltyLmtleVtpXV09dFtpXXx8XCJcIjtyZXR1cm4gbltyLnEubmFtZV09e30sbltyLmtleVsxMl1dLnJlcGxhY2Uoci5xLnBhcnNlcixmdW5jdGlvbihlLHQsbyl7dCYmKG5bci5xLm5hbWVdW3RdPW8pfSksbn1mdW5jdGlvbiBhKGUpe3ZhciByPWkoZSk7cmV0dXJuXCJcIj09PXIuYW5jaG9yJiYoci5zb3VyY2U9ci5zb3VyY2UucmVwbGFjZShcIiNcIixcIlwiKSksZT1yLnNvdXJjZS5yZXBsYWNlKFwiP1wiK3IucXVlcnksXCJcIil9ZnVuY3Rpb24gcyhlLHIpe3ZhciB0LG4saSxhPW8oZSxcIm9iamVjdFwiKSx1PW8oZSxcImFycmF5XCIpLGM9W107aWYoYSlmb3IodCBpbiBlKWUuaGFzT3duUHJvcGVydHkodCkmJmMucHVzaCh0KTtlbHNlIGlmKHUpZm9yKGk9MDtpPGUubGVuZ3RoOysraSljLnB1c2goaSk7Zm9yKGk9MDtpPGMubGVuZ3RoOysraSl0PWNbaV0sbj1lW3RdLGE9byhuLFwib2JqZWN0XCIpLHU9byhuLFwiYXJyYXlcIiksYXx8dT9lW3RdPXMobixyKTplW3RdPXIodCxuKTtyZXR1cm4gZX1mdW5jdGlvbiB1KGUpe3JldHVybiBlPVN0cmluZyhlKSxuZXcgQXJyYXkoZS5sZW5ndGgrMSkuam9pbihcIipcIil9ZnVuY3Rpb24gYygpe3ZhciBlPShuZXcgRGF0ZSkuZ2V0VGltZSgpLHI9XCJ4eHh4eHh4eC14eHh4LTR4eHgteXh4eC14eHh4eHh4eHh4eHhcIi5yZXBsYWNlKC9beHldL2csZnVuY3Rpb24ocil7dmFyIHQ9KGUrMTYqTWF0aC5yYW5kb20oKSklMTZ8MDtyZXR1cm4gZT1NYXRoLmZsb29yKGUvMTYpLChcInhcIj09PXI/dDo3JnR8OCkudG9TdHJpbmcoMTYpfSk7cmV0dXJuIHJ9dCg5KTt2YXIgbD17c3RyaWN0TW9kZTohMSxrZXk6W1wic291cmNlXCIsXCJwcm90b2NvbFwiLFwiYXV0aG9yaXR5XCIsXCJ1c2VySW5mb1wiLFwidXNlclwiLFwicGFzc3dvcmRcIixcImhvc3RcIixcInBvcnRcIixcInJlbGF0aXZlXCIsXCJwYXRoXCIsXCJkaXJlY3RvcnlcIixcImZpbGVcIixcInF1ZXJ5XCIsXCJhbmNob3JcIl0scTp7bmFtZTpcInF1ZXJ5S2V5XCIscGFyc2VyOi8oPzpefCYpKFteJj1dKik9PyhbXiZdKikvZ30scGFyc2VyOntzdHJpY3Q6L14oPzooW146XFwvPyNdKyk6KT8oPzpcXC9cXC8oKD86KChbXjpAXSopKD86OihbXjpAXSopKT8pP0ApPyhbXjpcXC8/I10qKSg/OjooXFxkKikpPykpPygoKCg/OltePyNcXC9dKlxcLykqKShbXj8jXSopKSg/OlxcPyhbXiNdKikpPyg/OiMoLiopKT8pLyxsb29zZTovXig/Oig/IVteOkBdKzpbXjpAXFwvXSpAKShbXjpcXC8/Iy5dKyk6KT8oPzpcXC9cXC8pPygoPzooKFteOkBdKikoPzo6KFteOkBdKikpPyk/QCk/KFteOlxcLz8jXSopKD86OihcXGQqKSk/KSgoKFxcLyg/OltePyNdKD8hW14/I1xcL10qXFwuW14/I1xcLy5dKyg/Ols/I118JCkpKSpcXC8/KT8oW14/I1xcL10qKSkoPzpcXD8oW14jXSopKT8oPzojKC4qKSk/KS99fSxwPXtpc1R5cGU6byxwYXJzZVVyaTppLHBhcnNlVXJpT3B0aW9uczpsLHJlZGFjdDp1LHNhbml0aXplVXJsOmEsdHJhdmVyc2U6cyx0eXBlTmFtZTpuLHV1aWQ0OmN9O2UuZXhwb3J0cz1wfSxmdW5jdGlvbihlLHIpeyFmdW5jdGlvbihlKXtcInVzZSBzdHJpY3RcIjtlLmNvbnNvbGU9ZS5jb25zb2xlfHx7fTtmb3IodmFyIHIsdCxuPWUuY29uc29sZSxvPXt9LGk9ZnVuY3Rpb24oKXt9LGE9XCJtZW1vcnlcIi5zcGxpdChcIixcIikscz1cImFzc2VydCxjbGVhcixjb3VudCxkZWJ1ZyxkaXIsZGlyeG1sLGVycm9yLGV4Y2VwdGlvbixncm91cCxncm91cENvbGxhcHNlZCxncm91cEVuZCxpbmZvLGxvZyxtYXJrVGltZWxpbmUscHJvZmlsZSxwcm9maWxlcyxwcm9maWxlRW5kLHNob3csdGFibGUsdGltZSx0aW1lRW5kLHRpbWVsaW5lLHRpbWVsaW5lRW5kLHRpbWVTdGFtcCx0cmFjZSx3YXJuXCIuc3BsaXQoXCIsXCIpO3I9YS5wb3AoKTspbltyXXx8KG5bcl09byk7Zm9yKDt0PXMucG9wKCk7KW5bdF18fChuW3RdPWkpfShcInVuZGVmaW5lZFwiPT10eXBlb2Ygd2luZG93P3RoaXM6d2luZG93KX0sZnVuY3Rpb24oZSxyLHQpe1widXNlIHN0cmljdFwiO2Z1bmN0aW9uIG4oZSl7YT1lfWZ1bmN0aW9uIG8oZSl7dGhpcy5uYW1lPVwiQ29ubmVjdGlvbiBFcnJvclwiLHRoaXMubWVzc2FnZT1lLHRoaXMuc3RhY2s9KG5ldyBFcnJvcikuc3RhY2t9dmFyIGk9dCg4KSxhPW51bGw7by5wcm90b3R5cGU9T2JqZWN0LmNyZWF0ZShFcnJvci5wcm90b3R5cGUpLG8ucHJvdG90eXBlLmNvbnN0cnVjdG9yPW87dmFyIHM9e1hNTEh0dHBGYWN0b3JpZXM6W2Z1bmN0aW9uKCl7cmV0dXJuIG5ldyBYTUxIdHRwUmVxdWVzdH0sZnVuY3Rpb24oKXtyZXR1cm4gbmV3IEFjdGl2ZVhPYmplY3QoXCJNc3htbDIuWE1MSFRUUFwiKX0sZnVuY3Rpb24oKXtyZXR1cm4gbmV3IEFjdGl2ZVhPYmplY3QoXCJNc3htbDMuWE1MSFRUUFwiKX0sZnVuY3Rpb24oKXtyZXR1cm4gbmV3IEFjdGl2ZVhPYmplY3QoXCJNaWNyb3NvZnQuWE1MSFRUUFwiKX1dLGNyZWF0ZVhNTEhUVFBPYmplY3Q6ZnVuY3Rpb24oKXt2YXIgZSxyPSExLHQ9cy5YTUxIdHRwRmFjdG9yaWVzLG49dC5sZW5ndGg7Zm9yKGU9MDtlPG47ZSsrKXRyeXtyPXRbZV0oKTticmVha31jYXRjaChvKXt9cmV0dXJuIHJ9LHBvc3Q6ZnVuY3Rpb24oZSxyLHQsbil7aWYoIWkuaXNUeXBlKHQsXCJvYmplY3RcIikpdGhyb3cgbmV3IEVycm9yKFwiRXhwZWN0ZWQgYW4gb2JqZWN0IHRvIFBPU1RcIik7dD1hLnN0cmluZ2lmeSh0KSxuPW58fGZ1bmN0aW9uKCl7fTt2YXIgdT1zLmNyZWF0ZVhNTEhUVFBPYmplY3QoKTtpZih1KXRyeXt0cnl7dmFyIGM9ZnVuY3Rpb24oKXt0cnl7aWYoYyYmND09PXUucmVhZHlTdGF0ZSl7Yz12b2lkIDA7dmFyIGU9YS5wYXJzZSh1LnJlc3BvbnNlVGV4dCk7MjAwPT09dS5zdGF0dXM/bihudWxsLGUpOmkuaXNUeXBlKHUuc3RhdHVzLFwibnVtYmVyXCIpJiZ1LnN0YXR1cz49NDAwJiZ1LnN0YXR1czw2MDA/KDQwMz09dS5zdGF0dXMmJmNvbnNvbGUuZXJyb3IoXCJbUm9sbGJhcl06XCIrZS5tZXNzYWdlKSxuKG5ldyBFcnJvcihTdHJpbmcodS5zdGF0dXMpKSkpOm4obmV3IG8oXCJYSFIgcmVzcG9uc2UgaGFkIG5vIHN0YXR1cyBjb2RlIChsaWtlbHkgY29ubmVjdGlvbiBmYWlsdXJlKVwiKSl9fWNhdGNoKHIpe3ZhciB0O3Q9ciYmci5zdGFjaz9yOm5ldyBFcnJvcihyKSxuKHQpfX07dS5vcGVuKFwiUE9TVFwiLGUsITApLHUuc2V0UmVxdWVzdEhlYWRlciYmKHUuc2V0UmVxdWVzdEhlYWRlcihcIkNvbnRlbnQtVHlwZVwiLFwiYXBwbGljYXRpb24vanNvblwiKSx1LnNldFJlcXVlc3RIZWFkZXIoXCJYLVJvbGxiYXItQWNjZXNzLVRva2VuXCIscikpLHUub25yZWFkeXN0YXRlY2hhbmdlPWMsdS5zZW5kKHQpfWNhdGNoKGwpe2lmKFwidW5kZWZpbmVkXCIhPXR5cGVvZiBYRG9tYWluUmVxdWVzdCl7XCJodHRwOlwiPT09d2luZG93LmxvY2F0aW9uLmhyZWYuc3Vic3RyaW5nKDAsNSkmJlwiaHR0cHNcIj09PWUuc3Vic3RyaW5nKDAsNSkmJihlPVwiaHR0cFwiK2Uuc3Vic3RyaW5nKDUpKTt2YXIgcD1mdW5jdGlvbigpe24obmV3IG8oXCJSZXF1ZXN0IHRpbWVkIG91dFwiKSl9LGY9ZnVuY3Rpb24oKXtuKG5ldyBFcnJvcihcIkVycm9yIGR1cmluZyByZXF1ZXN0XCIpKX0sZD1mdW5jdGlvbigpe24obnVsbCxhLnBhcnNlKHUucmVzcG9uc2VUZXh0KSl9O3U9bmV3IFhEb21haW5SZXF1ZXN0LHUub25wcm9ncmVzcz1mdW5jdGlvbigpe30sdS5vbnRpbWVvdXQ9cCx1Lm9uZXJyb3I9Zix1Lm9ubG9hZD1kLHUub3BlbihcIlBPU1RcIixlLCEwKSx1LnNlbmQodCl9fX1jYXRjaChoKXtuKGgpfX19O2UuZXhwb3J0cz17WEhSOnMsc2V0dXBKU09OOm4sQ29ubmVjdGlvbkVycm9yOm99fV0pfSk7IiwiJ3VzZSBzdHJpY3QnO1xudmFyIGtvID0gcmVxdWlyZSgnLi9oZXJvY2FsY19rbm9ja291dCcpO1xuICAgIFxudmFyIG15ID0gcmVxdWlyZShcImRvdGEtaGVyby1jYWxjdWxhdG9yLWxpYnJhcnlcIik7XG52YXIgQWJpbGl0eU1vZGVsID0gcmVxdWlyZShcImRvdGEtaGVyby1jYWxjdWxhdG9yLWxpYnJhcnkvc3JjL2hlcm9jYWxjL0FiaWxpdHlNb2RlbFwiKTtcbnZhciBCYXNpY0ludmVudG9yeVZpZXdNb2RlbCA9IHJlcXVpcmUoXCJkb3RhLWhlcm8tY2FsY3VsYXRvci1saWJyYXJ5L3NyYy9oZXJvY2FsYy9pbnZlbnRvcnkvQmFzaWNJbnZlbnRvcnlWaWV3TW9kZWxcIik7XG52YXIgdW5pb24gPSByZXF1aXJlKFwiZG90YS1oZXJvLWNhbGN1bGF0b3ItbGlicmFyeS9zcmMvaGVyb2NhbGMvdXRpbC91bmlvblwiKTtcblxudmFyIGludmVudG9yeUNsaXBCb2FyZCA9IHtcbiAgICBpdGVtczogW10sXG4gICAgYWN0aXZlSXRlbXM6IFtdXG59O1xuXG52YXIgR3JhcGhQcm9wZXJ0eU9wdGlvbiA9IGZ1bmN0aW9uIChpZCwgbGFiZWwpIHtcbiAgICB0aGlzLmlkID0gaWQ7XG4gICAgdGhpcy5sYWJlbCA9IGxhYmVsO1xufTtcblxuQWJpbGl0eU1vZGVsLnByb3RvdHlwZS5pc1FXRVIgPSBmdW5jdGlvbiAoYWJpbGl0eSkge1xuICAgIHJldHVybiAoYWJpbGl0eS5kaXNwbGF5bmFtZSAhPSAnRW1wdHknICYmICAoYWJpbGl0eS5iZWhhdmlvci5pbmRleE9mKCdET1RBX0FCSUxJVFlfQkVIQVZJT1JfSElEREVOJykgPT0gLTEgfHwgYWJpbGl0eS5uYW1lLmluZGV4T2YoJ2ludm9rZXJfJykgIT0gLTEpICYmIGFiaWxpdHkuYmVoYXZpb3IuaW5kZXhPZignRE9UQV9BQklMSVRZX0JFSEFWSU9SX05PVF9MRUFSTkFCTEUnKSA9PSAtMSlcbn1cblxudmFyIEJ1aWxkRXhwbG9yZXJWaWV3TW9kZWwgPSBmdW5jdGlvbiAoaCkge1xudmFyIHNlbGYgPSB0aGlzO1xuICAgIHNlbGYucGFyZW50ID0gaDtcblxuICAgIHNlbGYuaXRlbUJ1aWxkID0ga28ub2JzZXJ2YWJsZUFycmF5KFtdKTtcbiAgICBzZWxmLnNraWxsQnVpbGQgPSBrby5vYnNlcnZhYmxlQXJyYXkoW10pO1xuICAgIHNlbGYuZ3JhcGhEYXRhSXRlbVJvd3MgPSBbXTtcbiAgICBmb3IgKHZhciBpID0gMDsgaSA8IDI1OyBpKyspIHtcbiAgICAgICAgc2VsZi5pdGVtQnVpbGQucHVzaChuZXcgQmFzaWNJbnZlbnRvcnlWaWV3TW9kZWwoKSk7XG4gICAgICAgIHNlbGYuaXRlbUJ1aWxkKClbaV0uY2FycnlPdmVyID0ga28ub2JzZXJ2YWJsZSh0cnVlKTtcbiAgICAgICAgc2VsZi5za2lsbEJ1aWxkLnB1c2goa28ub2JzZXJ2YWJsZSgtMSkpO1xuICAgICAgICBzZWxmLmdyYXBoRGF0YUl0ZW1Sb3dzLnB1c2goa28ub2JzZXJ2YWJsZShmYWxzZSkpO1xuICAgIH1cbiAgICBzZWxmLnRvZ2dsZUl0ZW1CdWlsZENhcnJ5T3ZlciA9IGZ1bmN0aW9uIChpbmRleCkge1xuICAgICAgICBzZWxmLml0ZW1CdWlsZCgpW2luZGV4XS5jYXJyeU92ZXIoIXNlbGYuaXRlbUJ1aWxkKClbaW5kZXhdLmNhcnJ5T3ZlcigpKTtcbiAgICB9XG4gICAgXG4gICAgc2VsZi5hYmlsaXR5TWFwRGF0YSA9IFswLDEsMiwzLDRdO1xuICAgIHNlbGYuYWJpbGl0eU1hcEhlcm8gPSBzZWxmLnBhcmVudC5zZWxlY3RlZEhlcm8oKS5oZXJvTmFtZTtcbiAgICBzZWxmLmFiaWxpdHlNYXAgPSBrby5jb21wdXRlZChmdW5jdGlvbiAoKSB7XG4gICAgICAgIGlmIChzZWxmLmFiaWxpdHlNYXBIZXJvID09IHNlbGYucGFyZW50LnNlbGVjdGVkSGVybygpLmhlcm9OYW1lKSByZXR1cm47XG4gICAgICAgIHNlbGYuYWJpbGl0eU1hcEhlcm8gPSBzZWxmLnBhcmVudC5zZWxlY3RlZEhlcm8oKS5oZXJvTmFtZTtcbiAgICAgICAgdmFyIG5ld01hcCA9IHNlbGYucGFyZW50LmFiaWxpdHkoKS5hYmlsaXRpZXMoKS5tYXAoZnVuY3Rpb24oYWJpbGl0eSwgaW5kZXgpIHtcbiAgICAgICAgICAgIGlmIChzZWxmLnBhcmVudC5hYmlsaXR5KCkuaXNRV0VSKGFiaWxpdHkpKSB7XG4gICAgICAgICAgICAgICAgcmV0dXJuIGluZGV4O1xuICAgICAgICAgICAgfVxuICAgICAgICAgICAgZWxzZSB7XG4gICAgICAgICAgICAgICAgcmV0dXJuIC0xO1xuICAgICAgICAgICAgfVxuICAgICAgICB9KS5maWx0ZXIoZnVuY3Rpb24oZWxlbWVudCkgeyByZXR1cm4gZWxlbWVudCAhPSAtMTsgfSk7XG4gICAgICAgIGZvciAodmFyIGkgPSAwOyBpIDwgMjU7IGkrKykge1xuICAgICAgICAgICAgdmFyIGFiaWxpdHlWYWx1ZSA9IHNlbGYuc2tpbGxCdWlsZCgpW2ldKCk7XG4gICAgICAgICAgICBpZiAoYWJpbGl0eVZhbHVlID09IC0xKSBjb250aW51ZTtcbiAgICAgICAgICAgIFxuICAgICAgICAgICAgdmFyIGFiaWxpdHlJbmRleCA9IHNlbGYuYWJpbGl0eU1hcERhdGEuaW5kZXhPZihhYmlsaXR5VmFsdWUpO1xuICAgICAgICAgICAgdmFyIG5ld1ZhbHVlID0gbmV3TWFwW2FiaWxpdHlJbmRleF07XG4gICAgICAgICAgICBpZiAobmV3VmFsdWUgIT0gYWJpbGl0eVZhbHVlKSB7XG4gICAgICAgICAgICAgICAgc2VsZi5za2lsbEJ1aWxkKClbaV0obmV3VmFsdWUpO1xuICAgICAgICAgICAgfVxuICAgICAgICB9XG4gICAgICAgIHNlbGYuYWJpbGl0eU1hcERhdGEgPSBuZXdNYXA7XG4gICAgfSk7XG4gICAgXG4gICAgc2VsZi5hdmFpbGFibGVTa2lsbEJ1aWxkUG9pbnRzID0ga28uY29tcHV0ZWQoZnVuY3Rpb24gKCkge1xuICAgICAgICByZXR1cm4gc2VsZi5za2lsbEJ1aWxkKCkucmVkdWNlKGZ1bmN0aW9uKG1lbW8sIG51bSl7IHJldHVybiBtZW1vICsgKG51bSgpID09IC0xKTsgfSwgMCk7XG4gICAgfSk7XG4gICAgc2VsZi5nZXRTa2lsbEJ1aWxkQWJpbGl0eUxldmVsID0gZnVuY3Rpb24gKGluZGV4KSB7XG4gICAgICAgIHJldHVybiBzZWxmLnNraWxsQnVpbGQoKS5yZWR1Y2UoZnVuY3Rpb24obWVtbywgbnVtKXsgcmV0dXJuIG1lbW8gKyAobnVtKCkgPT0gaW5kZXgpOyB9LCAwKTtcbiAgICB9O1xuICAgIHNlbGYudG9nZ2xlQWJpbGl0eVNraWxsQnVpbGQgPSBmdW5jdGlvbiAoaW5kZXgsIGFiaWxpdHlJbmRleCwgZGF0YSwgZXZlbnQpIHtcbiAgICAgICAgaWYgKHNlbGYuc2tpbGxCdWlsZCgpW2luZGV4XSgpICE9IGFiaWxpdHlJbmRleCkge1xuICAgICAgICAgICAgdmFyIGFiaWxpdHkgPSBzZWxmLnBhcmVudC5hYmlsaXR5KCkuYWJpbGl0aWVzKClbYWJpbGl0eUluZGV4XSxcbiAgICAgICAgICAgICAgICBhYmlsaXR5VHlwZSA9IGFiaWxpdHkuYWJpbGl0eXR5cGUsXG4gICAgICAgICAgICAgICAgc2tpbGxCdWlsZFNsaWNlID0gc2VsZi5za2lsbEJ1aWxkKCkuc2xpY2UoMCwgaW5kZXgpLFxuICAgICAgICAgICAgICAgIGN1cnJlbnRBYmlsaXR5TGV2ZWwgPSBzZWxmLnNraWxsQnVpbGQoKS5yZWR1Y2UoZnVuY3Rpb24obWVtbywgbnVtKXsgcmV0dXJuIG1lbW8gKyAobnVtKCkgPT0gYWJpbGl0eUluZGV4KTsgfSwgMCksXG4gICAgICAgICAgICAgICAgbiA9IHNraWxsQnVpbGRTbGljZS5yZWR1Y2UoZnVuY3Rpb24obWVtbywgbnVtKXsgcmV0dXJuIG1lbW8gKyAobnVtKCkgPT0gYWJpbGl0eUluZGV4KTsgfSwgMCk7XG4gICAgICAgICAgICBcbiAgICAgICAgICAgIGlmIChzZWxmLklzVmFsaWRBYmlsaXR5TGV2ZWwoYWJpbGl0eSwgc2VsZi5wYXJlbnQuc2VsZWN0ZWRIZXJvKCkuaGVyb05hbWUsIGluZGV4ICsgMSwgbikpIHtcbiAgICAgICAgICAgICAgICBzZWxmLnNraWxsQnVpbGQoKVtpbmRleF0oYWJpbGl0eUluZGV4KTtcbiAgICAgICAgICAgICAgICBmb3IgKHZhciBpID0gaW5kZXggKyAxOyBpIDwgMjU7IGkrKykge1xuICAgICAgICAgICAgICAgICAgICBpZiAoc2VsZi5za2lsbEJ1aWxkKClbaV0oKSA9PSBhYmlsaXR5SW5kZXgpIHtcbiAgICAgICAgICAgICAgICAgICAgICAgIG4rKztcbiAgICAgICAgICAgICAgICAgICAgICAgIGlmICghc2VsZi5Jc1ZhbGlkQWJpbGl0eUxldmVsKGFiaWxpdHksIHNlbGYucGFyZW50LnNlbGVjdGVkSGVybygpLmhlcm9OYW1lLCBpICsgMSwgbikpIHtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICBzZWxmLnNraWxsQnVpbGQoKVtpXSgtMSk7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgbi0tO1xuICAgICAgICAgICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgfVxuICAgICAgICAgICAgZWxzZSBpZiAobiA+IDAgJiYgc2VsZi5Jc1ZhbGlkQWJpbGl0eUxldmVsKGFiaWxpdHksIHNlbGYucGFyZW50LnNlbGVjdGVkSGVybygpLmhlcm9OYW1lLCBpbmRleCArIDEsIG4gLSAxKSkge1xuICAgICAgICAgICAgICAgIGZvciAodmFyIGkgPSBza2lsbEJ1aWxkU2xpY2UubGVuZ3RoIC0gMTsgaSA+PSAwOyBpLS0pIHtcbiAgICAgICAgICAgICAgICAgICAgaWYgKHNraWxsQnVpbGRTbGljZVtpXSgpID09IGFiaWxpdHlJbmRleCkge1xuICAgICAgICAgICAgICAgICAgICAgICAgc2VsZi5za2lsbEJ1aWxkKClbaV0oLTEpO1xuICAgICAgICAgICAgICAgICAgICAgICAgc2VsZi5za2lsbEJ1aWxkKClbaW5kZXhdKGFiaWxpdHlJbmRleCk7XG4gICAgICAgICAgICAgICAgICAgICAgICBicmVhaztcbiAgICAgICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgIH1cbiAgICAgICAgfVxuICAgICAgICBlbHNlIHtcbiAgICAgICAgICAgIHNlbGYuc2tpbGxCdWlsZCgpW2luZGV4XSgtMSk7XG4gICAgICAgIH1cbiAgICB9O1xuICAgIHNlbGYuSXNWYWxpZEFiaWxpdHlMZXZlbCA9IGZ1bmN0aW9uIChhYmlsaXR5LCBoZXJvTmFtZSwgaGVyb0xldmVsLCBhYmlsaXR5TGV2ZWwpIHtcbiAgICAgICAgdmFyIGEgPSAxLCBiID0gMiwgbSA9IDQ7XG4gICAgICAgIGlmIChhYmlsaXR5Lm5hbWUgPT0gJ2F0dHJpYnV0ZV9ib251cycpIHtcbiAgICAgICAgICAgIG0gPSAxMDtcbiAgICAgICAgfVxuICAgICAgICBlbHNlIHtcbiAgICAgICAgICAgIGlmIChhYmlsaXR5LmFiaWxpdHl0eXBlID09ICdET1RBX0FCSUxJVFlfVFlQRV9VTFRJTUFURScpIHtcbiAgICAgICAgICAgICAgICBpZiAoaGVyb05hbWUgPT0gJ2ludm9rZXInKSB7XG4gICAgICAgICAgICAgICAgICAgIGEgPSAyO1xuICAgICAgICAgICAgICAgICAgICBiID0gNTtcbiAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgICAgZWxzZSBpZiAoaGVyb05hbWUgPT0gJ21lZXBvJykge1xuICAgICAgICAgICAgICAgICAgICBhID0gMztcbiAgICAgICAgICAgICAgICAgICAgYiA9IDc7XG4gICAgICAgICAgICAgICAgICAgIG0gPSAzO1xuICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgICBlbHNlIHtcbiAgICAgICAgICAgICAgICAgICAgYSA9IDY7XG4gICAgICAgICAgICAgICAgICAgIGIgPSA1O1xuICAgICAgICAgICAgICAgICAgICBtID0gMztcbiAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICB9XG4gICAgICAgICAgICBlbHNlIHtcbiAgICAgICAgICAgICAgICBpZiAoaGVyb05hbWUgPT0gJ2ludm9rZXInKSB7XG4gICAgICAgICAgICAgICAgICAgIG0gPSA3O1xuICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgIH0gICAgICAgICAgICAgICAgXG4gICAgICAgIH1cbiAgICAgICAgXG4gICAgICAgIHJldHVybiBoZXJvTGV2ZWwgPj0gYSArIGIgKiBhYmlsaXR5TGV2ZWwgJiYgYWJpbGl0eUxldmVsIDwgbTtcbiAgICB9XG4gICAgXG4gICAgc2VsZi5yZXNldEl0ZW1CdWlsZCA9IGZ1bmN0aW9uIChpbmRleCkge1xuICAgICAgICBzZWxmLml0ZW1CdWlsZCgpW2luZGV4XS5yZW1vdmVBbGwoKTtcbiAgICB9OyAgICAgICAgXG4gICAgc2VsZi5yZXNldEFsbEl0ZW1CdWlsZHMgPSBmdW5jdGlvbiAoKSB7XG4gICAgICAgIGZvciAodmFyIGkgPSAwOyBpIDwgMjU7IGkrKykge1xuICAgICAgICAgICAgc2VsZi5pdGVtQnVpbGQoKVtpXS5yZW1vdmVBbGwoKTtcbiAgICAgICAgICAgIHNlbGYuaXRlbUJ1aWxkKClbaV0uY2FycnlPdmVyKHRydWUpO1xuICAgICAgICB9XG4gICAgfTtcbiAgICBzZWxmLnJlc2V0U2tpbGxCdWlsZCA9IGZ1bmN0aW9uICgpIHtcbiAgICAgICAgZm9yICh2YXIgaSA9IDA7IGkgPCAyNTsgaSsrKSB7XG4gICAgICAgICAgICBzZWxmLnNraWxsQnVpbGQoKVtpXSgtMSk7XG4gICAgICAgIH1cbiAgICB9O1xuICAgIHNlbGYuZ3JhcGhEYXRhID0ga28ub2JzZXJ2YWJsZUFycmF5KFtdKTtcbiAgICBzZWxmLmdyYXBoRGF0YUhlYWRlciA9IGtvLm9ic2VydmFibGUoc2VsZi5wYXJlbnQuc2VsZWN0ZWRIZXJvKCkuaGVyb0Rpc3BsYXlOYW1lKTtcbiAgICBzZWxmLnBhcmVudC5zZWxlY3RlZEhlcm8uc3Vic2NyaWJlKGZ1bmN0aW9uIChuZXdWYWx1ZSkge1xuICAgICAgICBzZWxmLmdyYXBoRGF0YUhlYWRlcihzZWxmLnBhcmVudC5zZWxlY3RlZEhlcm8oKS5oZXJvRGlzcGxheU5hbWUpO1xuICAgIH0pO1xuICAgIHNlbGYuZ3JhcGhEYXRhRGVzY3JpcHRpb24gPSBrby5vYnNlcnZhYmxlKCcnKTtcbiAgICBzZWxmLmdyYXBoUHJvcGVydGllcyA9IGtvLm9ic2VydmFibGVBcnJheShbXG4gICAgICAgIG5ldyBHcmFwaFByb3BlcnR5T3B0aW9uKCd0b3RhbEFybW9yUGh5c2ljYWwnLCAnQXJtb3InKSxcbiAgICAgICAgbmV3IEdyYXBoUHJvcGVydHlPcHRpb24oJ3RvdGFsQXJtb3JQaHlzaWNhbFJlZHVjdGlvbicsICdQaHlzaWNhbCBEYW1hZ2UgUmVkdWN0aW9uJyksXG4gICAgICAgIG5ldyBHcmFwaFByb3BlcnR5T3B0aW9uKCd0b3RhbE1hZ2ljUmVzaXN0YW5jZScsICdNYWdpY2FsIFJlc2lzdGFuY2UnKSxcbiAgICAgICAgbmV3IEdyYXBoUHJvcGVydHlPcHRpb24oJ2hlYWx0aCcsICdIZWFsdGgnKSxcbiAgICAgICAgbmV3IEdyYXBoUHJvcGVydHlPcHRpb24oJ2hlYWx0aHJlZ2VuJywgJ0hlYWx0aCBSZWdlbmVyYXRpb24nKSxcbiAgICAgICAgbmV3IEdyYXBoUHJvcGVydHlPcHRpb24oJ21hbmEnLCAnTWFuYScpLFxuICAgICAgICBuZXcgR3JhcGhQcm9wZXJ0eU9wdGlvbignbWFuYXJlZ2VuJywgJ01hbmEgUmVnZW5lcmF0aW9uJyksXG4gICAgICAgIG5ldyBHcmFwaFByb3BlcnR5T3B0aW9uKCdlaHBQaHlzaWNhbCcsICdFSFAgUGh5c2ljYWwnKSxcbiAgICAgICAgbmV3IEdyYXBoUHJvcGVydHlPcHRpb24oJ2VocE1hZ2ljYWwnLCAnRUhQIE1hZ2ljYWwnKSxcbiAgICAgICAgbmV3IEdyYXBoUHJvcGVydHlPcHRpb24oJ2RhbWFnZScsICdEYW1hZ2UgcGVyIGF0dGFjaycpLFxuICAgICAgICBuZXcgR3JhcGhQcm9wZXJ0eU9wdGlvbignZHBzJywgJ0RhbWFnZSBwZXIgc2Vjb25kJyksXG4gICAgICAgIG5ldyBHcmFwaFByb3BlcnR5T3B0aW9uKCdhdHRhY2tzUGVyU2Vjb25kJywgJ0F0dGFja3MgcGVyIHNlY29uZCcpLFxuICAgICAgICBuZXcgR3JhcGhQcm9wZXJ0eU9wdGlvbignYXR0YWNrVGltZScsICdUaW1lIHBlciBhdHRhY2snKVxuICAgIF0pO1xuICAgIHNlbGYuZ3JhcGggPSBmdW5jdGlvbigpIHtcbiAgICAgICAgdmFyIHNhdmVkQWJpbGl0eUxldmVscyA9IFtdLFxuICAgICAgICAgICAgc2F2ZWRMZXZlbCA9IHNlbGYucGFyZW50LnNlbGVjdGVkSGVyb0xldmVsKCksXG4gICAgICAgICAgICBzYXZlZEl0ZW1zID0gc2VsZi5wYXJlbnQuaW52ZW50b3J5Lml0ZW1zKCksXG4gICAgICAgICAgICBzYXZlZEFjdGl2ZUl0ZW1zID0gc2VsZi5wYXJlbnQuaW52ZW50b3J5LmFjdGl2ZUl0ZW1zKCksXG4gICAgICAgICAgICBzID0ga28udG9KUyhzZWxmLnNraWxsQnVpbGQpLFxuICAgICAgICAgICAgY2FycnlPdmVySXRlbXMgPSBbXSxcbiAgICAgICAgICAgIGNhcnJ5T3ZlckFjdGl2ZUl0ZW1zID0gW10sXG4gICAgICAgICAgICBkYXRhc2V0ID0gW107XG4gICAgICAgIGZvciAodmFyIGkgPSAwOyBpIDwgc2VsZi5wYXJlbnQuYWJpbGl0eSgpLmFiaWxpdGllcygpLmxlbmd0aDsgaSsrKSB7XG4gICAgICAgICAgICBzYXZlZEFiaWxpdHlMZXZlbHMucHVzaChzZWxmLnBhcmVudC5hYmlsaXR5KCkuYWJpbGl0aWVzKClbaV0ubGV2ZWwoKSk7XG4gICAgICAgIH1cbiAgICAgICAgZm9yICh2YXIgaSA9IDE7IGkgPCAyNjsgaSsrKSB7XG4gICAgICAgICAgICBzZWxmLnBhcmVudC5zZWxlY3RlZEhlcm9MZXZlbChpKTtcbiAgICAgICAgICAgIHZhciBza2lsbEJ1aWxkU3Vic2V0ID0gcy5zbGljZSgwLCBpKTtcbiAgICAgICAgICAgIGZvciAodmFyIGogPSAwOyBqIDwgc2VsZi5wYXJlbnQuYWJpbGl0eSgpLmFiaWxpdGllcygpLmxlbmd0aDsgaisrKSB7XG4gICAgICAgICAgICAgICAgdmFyIGEgPSBzZWxmLnBhcmVudC5hYmlsaXR5KCkuYWJpbGl0aWVzKClbal0sXG4gICAgICAgICAgICAgICAgICAgIGNvdW50ID0gc2tpbGxCdWlsZFN1YnNldC5yZWR1Y2UoZnVuY3Rpb24obWVtbywgbnVtKSB7XG4gICAgICAgICAgICAgICAgICAgICAgICByZXR1cm4gbWVtbyArIChudW0gPT0gaik7XG4gICAgICAgICAgICAgICAgICAgIH0sIDApO1xuICAgICAgICAgICAgICAgIGEubGV2ZWwoY291bnQpO1xuICAgICAgICAgICAgfVxuXG4gICAgICAgICAgICBpZiAoIXNlbGYuaXRlbUJ1aWxkKClbaSAtIDFdLmNhcnJ5T3ZlcigpKSB7XG4gICAgICAgICAgICAgICAgY2FycnlPdmVySXRlbXMgPSBbXTtcbiAgICAgICAgICAgICAgICBjYXJyeU92ZXJBY3RpdmVJdGVtcyA9IFtdO1xuICAgICAgICAgICAgfVxuICAgICAgICAgICAgY2FycnlPdmVySXRlbXMgPSBjYXJyeU92ZXJJdGVtcy5jb25jYXQoc2VsZi5pdGVtQnVpbGQoKVtpIC0gMV0uaXRlbXMoKSk7XG4gICAgICAgICAgICBjYXJyeU92ZXJBY3RpdmVJdGVtcyA9IGNhcnJ5T3ZlckFjdGl2ZUl0ZW1zLmNvbmNhdChzZWxmLml0ZW1CdWlsZCgpW2kgLSAxXS5hY3RpdmVJdGVtcygpKTtcblxuICAgICAgICAgICAgc2VsZi5wYXJlbnQuaW52ZW50b3J5Lml0ZW1zKGNhcnJ5T3Zlckl0ZW1zKTtcbiAgICAgICAgICAgIHNlbGYucGFyZW50LmludmVudG9yeS5hY3RpdmVJdGVtcyhjYXJyeU92ZXJBY3RpdmVJdGVtcyk7XG4gICAgICAgICAgICB2YXIgZGF0YU9iaiA9IHt9O1xuICAgICAgICAgICAgZm9yICh2YXIgaiA9IDA7IGogPCBzZWxmLmdyYXBoUHJvcGVydGllcygpLmxlbmd0aDsgaisrKSB7XG4gICAgICAgICAgICAgICAgdmFyIHByb3AgPSBzZWxmLmdyYXBoUHJvcGVydGllcygpW2pdO1xuICAgICAgICAgICAgICAgIHN3aXRjaCAocHJvcC5pZCkge1xuICAgICAgICAgICAgICAgICAgICBjYXNlICdkcHMnOlxuICAgICAgICAgICAgICAgICAgICAgICAgZGF0YU9ialtwcm9wLmlkXSA9IHNlbGYucGFyZW50WydkYW1hZ2VUb3RhbEluZm8nXSgpLnRvdGFsUm93WzJdKCkudG9GaXhlZCgyKTtcbiAgICAgICAgICAgICAgICAgICAgICAgIGJyZWFrO1xuICAgICAgICAgICAgICAgICAgICBjYXNlICdkYW1hZ2UnOlxuICAgICAgICAgICAgICAgICAgICAgICAgZGF0YU9ialtwcm9wLmlkXSA9IHNlbGYucGFyZW50WydkYW1hZ2VUb3RhbEluZm8nXSgpLnRvdGFsUm93WzBdKCkudG9GaXhlZCgyKTtcbiAgICAgICAgICAgICAgICAgICAgICAgIGJyZWFrO1xuICAgICAgICAgICAgICAgICAgICBkZWZhdWx0OlxuICAgICAgICAgICAgICAgICAgICAgICAgZGF0YU9ialtwcm9wLmlkXSA9IHNlbGYucGFyZW50W3Byb3AuaWRdKCk7XG4gICAgICAgICAgICAgICAgICAgICAgICBicmVhaztcbiAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICB9XG5cbiAgICAgICAgICAgIGRhdGFPYmouaXRlbXMgPSBjYXJyeU92ZXJJdGVtcy5tYXAoZnVuY3Rpb24oaXRlbSkge1xuICAgICAgICAgICAgICAgIHJldHVybiBrby50b0pTKGl0ZW0pO1xuICAgICAgICAgICAgfSk7XG4gICAgICAgICAgICBkYXRhc2V0LnB1c2goZGF0YU9iaik7XG4gICAgICAgICAgICBpZiAoY2FycnlPdmVySXRlbXMgPiAwKSB7XG4gICAgICAgICAgICAgICAgc2VsZi5ncmFwaERhdGFJdGVtUm93c1tpIC0gMV0odHJ1ZSk7XG4gICAgICAgICAgICB9XG4gICAgICAgIH1cbiAgICAgICAgdmFyIGRhdGEgPSB7XG4gICAgICAgICAgICBoZWFkZXI6IHNlbGYuZ3JhcGhEYXRhSGVhZGVyKCksXG4gICAgICAgICAgICBkZXNjcmlwdGlvbjogc2VsZi5ncmFwaERhdGFEZXNjcmlwdGlvbigpLFxuICAgICAgICAgICAgaXRlbXM6IHNlbGYucGFyZW50LmludmVudG9yeS5pdGVtcygpLm1hcChmdW5jdGlvbihpdGVtKSB7XG4gICAgICAgICAgICAgICAgcmV0dXJuIGtvLnRvSlMoaXRlbSk7XG4gICAgICAgICAgICB9KSxcbiAgICAgICAgICAgIHNraWxsQnVpbGQ6IGtvLnRvSlMoc2VsZi5za2lsbEJ1aWxkKSxcbiAgICAgICAgICAgIGRhdGE6IGRhdGFzZXQsXG4gICAgICAgICAgICBhYmlsaXR5TWFwOiBzZWxmLmFiaWxpdHlNYXBEYXRhLnNsaWNlKDApLFxuICAgICAgICAgICAgY3VtdWxhdGl2ZVNraWxsQnVpbGQ6IFtdLFxuICAgICAgICAgICAgdmlzaWJsZToga28ub2JzZXJ2YWJsZSh0cnVlKVxuICAgICAgICB9XG4gICAgICAgIGZvciAodmFyIGkgPSAwOyBpIDwgMjU7IGkrKykge1xuICAgICAgICAgICAgdmFyIHNraWxsQnVpbGRBdExldmVsID0gW10sXG4gICAgICAgICAgICAgICAgc2tpbGxCdWlsZFNsaWNlID0gZGF0YS5za2lsbEJ1aWxkLnNsaWNlKDAsIGkgKyAxKTtcbiAgICAgICAgICAgIGZvciAodmFyIGogPSAwOyBqIDwgZGF0YS5hYmlsaXR5TWFwLmxlbmd0aDsgaisrKSB7XG4gICAgICAgICAgICAgICAgdmFyIGFiaWxpdHlJbmRleCA9IGRhdGEuYWJpbGl0eU1hcFtqXTtcbiAgICAgICAgICAgICAgICBza2lsbEJ1aWxkQXRMZXZlbC5wdXNoKHNraWxsQnVpbGRTbGljZS5yZWR1Y2UoZnVuY3Rpb24obWVtbywgbnVtKSB7XG4gICAgICAgICAgICAgICAgICAgIHJldHVybiBtZW1vICsgKG51bSA9PSBhYmlsaXR5SW5kZXgpO1xuICAgICAgICAgICAgICAgIH0sIDApKTtcbiAgICAgICAgICAgIH1cbiAgICAgICAgICAgIGRhdGEuY3VtdWxhdGl2ZVNraWxsQnVpbGQucHVzaChza2lsbEJ1aWxkQXRMZXZlbCk7XG4gICAgICAgIH1cblxuICAgICAgICBzZWxmLmdyYXBoRGF0YS5wdXNoKGRhdGEpO1xuICAgICAgICBzZWxmLnBhcmVudC5zZWxlY3RlZEhlcm9MZXZlbChzYXZlZExldmVsKTtcbiAgICAgICAgZm9yICh2YXIgaSA9IDA7IGkgPCBzZWxmLnBhcmVudC5hYmlsaXR5KCkuYWJpbGl0aWVzKCkubGVuZ3RoOyBpKyspIHtcbiAgICAgICAgICAgIHNlbGYucGFyZW50LmFiaWxpdHkoKS5hYmlsaXRpZXMoKVtpXS5sZXZlbChzYXZlZEFiaWxpdHlMZXZlbHNbaV0pO1xuICAgICAgICB9XG4gICAgICAgIHNlbGYucGFyZW50LmludmVudG9yeS5pdGVtcyhzYXZlZEl0ZW1zKTtcbiAgICAgICAgc2VsZi5wYXJlbnQuaW52ZW50b3J5LmFjdGl2ZUl0ZW1zKHNhdmVkQWN0aXZlSXRlbXMpO1xuICAgIH07XG4gICAgc2VsZi5yZW1vdmVHcmFwaERhdGFTZXQgPSBmdW5jdGlvbiAoZGF0YSkge1xuICAgICAgICBzZWxmLmdyYXBoRGF0YS5yZW1vdmUoZGF0YSk7XG4gICAgfVxuICAgIHNlbGYuc2VsZWN0ZWRHcmFwaFByb3BlcnR5ID0ga28ub2JzZXJ2YWJsZShzZWxmLmdyYXBoUHJvcGVydGllcygpWzBdLmlkKTtcbiAgICBcbiAgICBzZWxmLmdyYXBoQ2hhcnRPcHRpb25zID0ga28uY29tcHV0ZWQoZnVuY3Rpb24gKCkge1xuICAgICAgICB2YXIgY29sb3IgPSAncmdiKDE1MSwgMTU0LCAxNjIpJztcbiAgICAgICAgcmV0dXJuIHtcbiAgICAgICAgICAgIHJlc3BvbnNpdmU6IHRydWUsXG4gICAgICAgICAgICBkYXRhc2V0U3Ryb2tlOiBmYWxzZSxcbiAgICAgICAgICAgIGRhdGFzZXRTdHJva2VXaWR0aDogLTEsXG4gICAgICAgICAgICBkYXRhc2V0RmlsbDogZmFsc2UsXG4gICAgICAgICAgICBwb2ludEhpdERldGVjdGlvblJhZGl1cyA6IDEwLFxuICAgICAgICAgICAgc2NhbGVGb250Q29sb3I6IGNvbG9yLFxuICAgICAgICAgICAgc2NhbGVMaW5lQ29sb3I6IGNvbG9yLnJlcGxhY2UoJ3JnYicsICdyZ2JhJykucmVwbGFjZSgnKScsICcsIC4xKScpLFxuICAgICAgICAgICAgc2NhbGVHcmlkTGluZUNvbG9yOiBjb2xvci5yZXBsYWNlKCdyZ2InLCAncmdiYScpLnJlcGxhY2UoJyknLCAnLCAuMSknKVxuICAgICAgICB9XG4gICAgfSk7XG4gICAgc2VsZi5ncmFwaENoYXJ0RGF0YSA9IGtvLmNvbXB1dGVkKGZ1bmN0aW9uICgpIHtcbiAgICAgICAgdmFyIGRhdGEgPSB7XG4gICAgICAgICAgICBsYWJlbHM6IFtdLFxuICAgICAgICAgICAgZGF0YXNldHM6IFtdXG4gICAgICAgIH1cbiAgICAgICAgZm9yICh2YXIgaSA9IDA7IGkgPCAyNTsgaSsrKSB7XG4gICAgICAgICAgICBkYXRhLmxhYmVscy5wdXNoKChpKzEpLnRvU3RyaW5nKCkpO1xuICAgICAgICB9XG4gICAgICAgIGZvciAodmFyIGkgPSAwOyBpIDwgc2VsZi5ncmFwaERhdGEoKS5sZW5ndGg7IGkrKykge1xuICAgICAgICAgICAgdmFyIGRhdGFPYmogPSBzZWxmLmdyYXBoRGF0YSgpW2ldLFxuICAgICAgICAgICAgICAgIGRhdGFzZXQgPSB7XG4gICAgICAgICAgICAgICAgICAgIGxhYmVsOiBkYXRhT2JqLmhlYWRlcixcbiAgICAgICAgICAgICAgICAgICAgZmlsbENvbG9yOiBzZWxmLmdyYXBoRGlzdGluY3RDb2xvcihzZWxmLmdyYXBoRGF0YSgpLmxlbmd0aCwgaSwgLjEpLFxuICAgICAgICAgICAgICAgICAgICBzdHJva2VDb2xvcjogc2VsZi5ncmFwaERpc3RpbmN0Q29sb3Ioc2VsZi5ncmFwaERhdGEoKS5sZW5ndGgsIGksIDEpLFxuICAgICAgICAgICAgICAgICAgICBwb2ludENvbG9yOiBzZWxmLmdyYXBoRGlzdGluY3RDb2xvcihzZWxmLmdyYXBoRGF0YSgpLmxlbmd0aCwgaSwgMSksXG4gICAgICAgICAgICAgICAgICAgIHBvaW50U3Ryb2tlQ29sb3I6IHNlbGYuZ3JhcGhEaXN0aW5jdENvbG9yKHNlbGYuZ3JhcGhEYXRhKCkubGVuZ3RoLCBpLCAxKSxcbiAgICAgICAgICAgICAgICAgICAgcG9pbnRIaWdobGlnaHRGaWxsOiBzZWxmLmdyYXBoRGlzdGluY3RDb2xvcihzZWxmLmdyYXBoRGF0YSgpLmxlbmd0aCwgaSwgLjEpLFxuICAgICAgICAgICAgICAgICAgICBwb2ludEhpZ2hsaWdodFN0cm9rZTogc2VsZi5ncmFwaERpc3RpbmN0Q29sb3Ioc2VsZi5ncmFwaERhdGEoKS5sZW5ndGgsIGksIC41KSxcbiAgICAgICAgICAgICAgICAgICAgZGF0YTogZGF0YU9iai5kYXRhLm1hcChmdW5jdGlvbiAobykge1xuICAgICAgICAgICAgICAgICAgICAgICAgcmV0dXJuIG9bc2VsZi5zZWxlY3RlZEdyYXBoUHJvcGVydHkoKV1cbiAgICAgICAgICAgICAgICAgICAgfSlcbiAgICAgICAgICAgICAgICB9O1xuICAgICAgICAgICAgZGF0YS5kYXRhc2V0cy5wdXNoKGRhdGFzZXQpO1xuICAgICAgICB9XG4gICAgICAgIHJldHVybiBkYXRhO1xuICAgIH0pO1xuICAgIHNlbGYuZ3JhcGhEaXN0aW5jdENvbG9yID0gZnVuY3Rpb24gKG1heCwgaW5kZXgsIGFscGhhKSB7XG4gICAgICAgIHZhciBhbHBoYSA9IGFscGhhIHx8IDEsXG4gICAgICAgICAgICByZ2JhID0gc2VsZi5oc2xUb1JnYigoMSAvIG1heCkgKiBpbmRleCAlIDEsIDEsIC41KTtcbiAgICAgICAgcmdiYS5wdXNoKGFscGhhKTtcbiAgICAgICAgcmV0dXJuIFwicmdiYShcIiArIHJnYmEuam9pbigpICsgXCIpXCI7XG4gICAgfVxuICAgIHNlbGYuZ2V0RGlzdGluY3RDb2xvciA9IGZ1bmN0aW9uIChtYXgsIGluZGV4LCBhbHBoYSkge1xuICAgICAgICB2YXIgYWxwaGEgPSBhbHBoYSB8fCAxO1xuICAgICAgICByZ2JhID0gc2VsZi5oc2xUb1JnYigoMSAvIG1heCkgKiBpbmRleCAlIDEsIDEsIC41KTtcbiAgICAgICAgcmdiYS5wdXNoKGFscGhhKTtcbiAgICAgICAgcmV0dXJuIHJnYmE7XG4gICAgfVxuICAgIHNlbGYuaHNsVG9SZ2IgPSBmdW5jdGlvbihoLCBzLCBsKSB7XG4gICAgICAgIHZhciByLCBnLCBiO1xuICAgICAgICBpZiAocyA9PSAwKSB7XG4gICAgICAgICAgICByID0gZyA9IGIgPSBsOyAvLyBhY2hyb21hdGljXG4gICAgICAgIH1cbiAgICAgICAgZWxzZSB7XG4gICAgICAgICAgICB2YXIgaHVlMnJnYiA9IGZ1bmN0aW9uIGh1ZTJyZ2IocCwgcSwgdCkge1xuICAgICAgICAgICAgICAgIGlmICh0IDwgMCkgdCArPSAxO1xuICAgICAgICAgICAgICAgIGlmICh0ID4gMSkgdCAtPSAxO1xuICAgICAgICAgICAgICAgIGlmICh0IDwgMSAvIDYpIHJldHVybiBwICsgKHEgLSBwKSAqIDYgKiB0O1xuICAgICAgICAgICAgICAgIGlmICh0IDwgMSAvIDIpIHJldHVybiBxO1xuICAgICAgICAgICAgICAgIGlmICh0IDwgMiAvIDMpIHJldHVybiBwICsgKHEgLSBwKSAqICgyIC8gMyAtIHQpICogNjtcbiAgICAgICAgICAgICAgICByZXR1cm4gcDtcbiAgICAgICAgICAgIH1cblxuICAgICAgICAgICAgdmFyIHEgPSBsIDwgMC41ID8gbCAqICgxICsgcykgOiBsICsgcyAtIGwgKiBzO1xuICAgICAgICAgICAgdmFyIHAgPSAyICogbCAtIHE7XG4gICAgICAgICAgICByID0gaHVlMnJnYihwLCBxLCBoICsgMSAvIDMpO1xuICAgICAgICAgICAgZyA9IGh1ZTJyZ2IocCwgcSwgaCk7XG4gICAgICAgICAgICBiID0gaHVlMnJnYihwLCBxLCBoIC0gMSAvIDMpO1xuICAgICAgICB9XG5cbiAgICAgICAgcmV0dXJuIFtNYXRoLnJvdW5kKHIgKiAyNTUpLCBNYXRoLnJvdW5kKGcgKiAyNTUpLCBNYXRoLnJvdW5kKGIgKiAyNTUpXTtcbiAgICB9XG4gICAgXG4gICAgc2VsZi5zaG93R3JhcGhJdGVtQnVpbGRSb3dzID0ga28ub2JzZXJ2YWJsZShmYWxzZSk7XG4gICAgc2VsZi5zaG93R3JhcGhTa2lsbEJ1aWxkQ29sdW1ucyA9IGtvLm9ic2VydmFibGUoZmFsc2UpO1xuICAgIHNlbGYuZ3JhcGhSb3dIYXNJdGVtcyA9IGZ1bmN0aW9uIChpbmRleCkge1xuICAgICAgICByZXR1cm4gc2VsZi5ncmFwaERhdGEoKS5zb21lKGZ1bmN0aW9uIChkYXRhc2V0KSB7XG4gICAgICAgICAgICByZXR1cm4gZGF0YXNldC52aXNpYmxlKCkgJiYgZGF0YXNldC5kYXRhW2luZGV4XS5pdGVtcy5sZW5ndGggPiAwO1xuICAgICAgICB9KTtcbiAgICB9XG5cbiAgICBzZWxmLnNlbGVjdEludmVudG9yeSA9IGZ1bmN0aW9uIChpbmRleCkge1xuICAgICAgICBzZWxmLnBhcmVudC5zZWxlY3RlZEludmVudG9yeShzZWxmLnBhcmVudC5zZWxlY3RlZEludmVudG9yeSgpID09IGluZGV4ID8gLTEgOiBpbmRleCk7XG4gICAgfVxuICAgIHNlbGYuZ2V0U2VsZWN0ZWRJbnZlbnRvcnkgPSBrby5wdXJlQ29tcHV0ZWQoZnVuY3Rpb24gKCkge1xuICAgICAgICBpZiAoc2VsZi5wYXJlbnQuc2VsZWN0ZWRJbnZlbnRvcnkoKSA9PSAtMSkge1xuICAgICAgICAgICAgcmV0dXJuIHNlbGYucGFyZW50LmludmVudG9yeTtcbiAgICAgICAgfVxuICAgICAgICBlbHNlIHtcbiAgICAgICAgICAgIHJldHVybiBzZWxmLml0ZW1CdWlsZCgpW3NlbGYucGFyZW50LnNlbGVjdGVkSW52ZW50b3J5KCldO1xuICAgICAgICB9XG4gICAgfSk7XG4gICAgc2VsZi5jb3B5SW52ZW50b3J5ID0gZnVuY3Rpb24gKGluZGV4KSB7XG4gICAgICAgIGlmIChzZWxmLnBhcmVudC5zZWxlY3RlZEludmVudG9yeSgpICE9IC0xICYmIHNlbGYucGFyZW50LnNlbGVjdGVkSW52ZW50b3J5KCkgIT0gaW5kZXgpIHtcbiAgICAgICAgICAgIHNlbGYuaXRlbUJ1aWxkKClbc2VsZi5wYXJlbnQuc2VsZWN0ZWRJbnZlbnRvcnkoKV0uaXRlbXMoc2VsZi5pdGVtQnVpbGQoKVtzZWxmLnBhcmVudC5zZWxlY3RlZEludmVudG9yeSgpXS5pdGVtcygpLmNvbmNhdChzZWxmLml0ZW1CdWlsZCgpW2luZGV4XS5pdGVtcygpKSk7XG4gICAgICAgICAgICBzZWxmLml0ZW1CdWlsZCgpW3NlbGYucGFyZW50LnNlbGVjdGVkSW52ZW50b3J5KCldLmFjdGl2ZUl0ZW1zKHVuaW9uKHNlbGYuaXRlbUJ1aWxkKClbc2VsZi5wYXJlbnQuc2VsZWN0ZWRJbnZlbnRvcnkoKV0uYWN0aXZlSXRlbXMoKSwgc2VsZi5pdGVtQnVpbGQoKVtpbmRleF0uYWN0aXZlSXRlbXMoKSkpO1xuICAgICAgICB9XG4gICAgfVxuICAgIHNlbGYuY29weUludmVudG9yeVRvQ2xpcEJvYXJkID0gZnVuY3Rpb24gKGluZGV4KSB7XG4gICAgICAgIGlmIChpbmRleCA9PSAtMSkge1xuICAgICAgICAgICAgaW52ZW50b3J5Q2xpcEJvYXJkLml0ZW1zID0gc2VsZi5wYXJlbnQuaW52ZW50b3J5Lml0ZW1zLnNsaWNlKDApO1xuICAgICAgICAgICAgaW52ZW50b3J5Q2xpcEJvYXJkLmFjdGl2ZUl0ZW1zID0gc2VsZi5wYXJlbnQuaW52ZW50b3J5LmFjdGl2ZUl0ZW1zLnNsaWNlKDApOyAgICAgICAgICAgIFxuICAgICAgICB9XG4gICAgICAgIGVsc2Uge1xuICAgICAgICAgICAgaW52ZW50b3J5Q2xpcEJvYXJkLml0ZW1zID0gc2VsZi5pdGVtQnVpbGQoKVtpbmRleF0uaXRlbXMuc2xpY2UoMCk7XG4gICAgICAgICAgICBpbnZlbnRvcnlDbGlwQm9hcmQuYWN0aXZlSXRlbXMgPSBzZWxmLml0ZW1CdWlsZCgpW2luZGV4XS5hY3RpdmVJdGVtcy5zbGljZSgwKTtcbiAgICAgICAgfVxuICAgIH1cbiAgICBzZWxmLnBhc3RlSW52ZW50b3J5RnJvbUNsaXBCb2FyZCA9IGZ1bmN0aW9uIChpbmRleCkge1xuICAgICAgICBpZiAoaW52ZW50b3J5Q2xpcEJvYXJkLml0ZW1zLmxlbmd0aCA+IDApIHtcbiAgICAgICAgICAgIGlmIChpbmRleCA9PSAtMSkge1xuICAgICAgICAgICAgICAgIHNlbGYucGFyZW50LmludmVudG9yeS5pdGVtcyhzZWxmLnBhcmVudC5pbnZlbnRvcnkuaXRlbXMoKS5jb25jYXQoaW52ZW50b3J5Q2xpcEJvYXJkLml0ZW1zKSk7XG4gICAgICAgICAgICAgICAgc2VsZi5wYXJlbnQuaW52ZW50b3J5LmFjdGl2ZUl0ZW1zKHVuaW9uKHNlbGYucGFyZW50LmludmVudG9yeS5hY3RpdmVJdGVtcygpLCBpbnZlbnRvcnlDbGlwQm9hcmQuYWN0aXZlSXRlbXMpKTsgICAgXG4gICAgICAgICAgICB9XG4gICAgICAgICAgICBlbHNlIHtcbiAgICAgICAgICAgICAgICBzZWxmLml0ZW1CdWlsZCgpW2luZGV4XS5pdGVtcyhzZWxmLml0ZW1CdWlsZCgpW2luZGV4XS5pdGVtcygpLmNvbmNhdChpbnZlbnRvcnlDbGlwQm9hcmQuaXRlbXMpKTtcbiAgICAgICAgICAgICAgICBzZWxmLml0ZW1CdWlsZCgpW2luZGV4XS5hY3RpdmVJdGVtcyh1bmlvbihzZWxmLml0ZW1CdWlsZCgpW2luZGV4XS5hY3RpdmVJdGVtcygpLCBpbnZlbnRvcnlDbGlwQm9hcmQuYWN0aXZlSXRlbXMpKTtcbiAgICAgICAgICAgIH1cbiAgICAgICAgfVxuICAgIH1cbiAgICBzZWxmLmxvYWRHcmFwaERhdGEgPSBmdW5jdGlvbiAoZGF0YSkge1xuICAgICAgICBzZWxmLnBhcmVudC5zZWN0aW9uRGlzcGxheSgpWydza2lsbGJ1aWxkJ10odHJ1ZSk7XG4gICAgICAgIGZvciAodmFyIGkgPSAwOyBpIDwgZGF0YS5sZW5ndGg7IGkrKykge1xuICAgICAgICAgICAgZGF0YVtpXS52aXNpYmxlID0ga28ub2JzZXJ2YWJsZShkYXRhW2ldLnZpc2libGUpO1xuICAgICAgICB9XG4gICAgICAgIHNlbGYuZ3JhcGhEYXRhKGRhdGEpO1xuICAgIH1cbiAgICBzZWxmLmdyYXBoQ2hhcnRDb250ZXh0ID0ga28ub2JzZXJ2YWJsZSgpO1xuICAgIHNlbGYuZXhwb3J0SW1hZ2UgPSBmdW5jdGlvbiAoKSB7XG4gICAgICAgIHZhciB3ID0gd2luZG93Lm9wZW4oKTtcbiAgICAgICAgdy5kb2N1bWVudC53cml0ZSgnPGltZyBzcmM9XCInKyBzZWxmLmdyYXBoQ2hhcnRDb250ZXh0KCkuY2FudmFzLnRvRGF0YVVSTCgpICsnXCIvPicpO1xuICAgIH1cbiAgICByZXR1cm4gc2VsZjtcbn1cblxubW9kdWxlLmV4cG9ydHMgPSBCdWlsZEV4cGxvcmVyVmlld01vZGVsOyIsIlwidXNlIHN0cmljdFwiO1xudmFyIGtvID0gKHR5cGVvZiB3aW5kb3cgIT09IFwidW5kZWZpbmVkXCIgPyB3aW5kb3dbJ2tvJ10gOiB0eXBlb2YgZ2xvYmFsICE9PSBcInVuZGVmaW5lZFwiID8gZ2xvYmFsWydrbyddIDogbnVsbCk7XG52YXIgSGVyb0NhbGMgPSByZXF1aXJlKFwiZG90YS1oZXJvLWNhbGN1bGF0b3ItbGlicmFyeVwiKTtcbnZhciBEYW1hZ2VBbXBWaWV3TW9kZWwgPSByZXF1aXJlKFwiLi9EYW1hZ2VBbXBWaWV3TW9kZWxcIik7XG52YXIgSGVyb0RhbWFnZUFtcE1peGluID0gcmVxdWlyZShcIi4vSGVyb0RhbWFnZUFtcE1peGluXCIpO1xuXG52YXIgQ2xvbmVWaWV3TW9kZWwgPSBmdW5jdGlvbiAoaGVyb0RhdGEsIGl0ZW1EYXRhLCB1bml0RGF0YSwgaCwgcCkge1xuICAgIHZhciBzZWxmID0gdGhpcztcbiAgICBIZXJvQ2FsYy5DbG9uZU1vZGVsLmNhbGwodGhpcywgaGVyb0RhdGEsIGl0ZW1EYXRhLCBoLCBwKTtcbiAgICBzZWxmLmJvdW5kID0ga28ub2JzZXJ2YWJsZShmYWxzZSk7XG4gICAgXG4gICAgc2VsZi5zZWN0aW9uRGlzcGxheSA9IGtvLm9ic2VydmFibGUoe1xuICAgICAgICAnaW52ZW50b3J5Jzoga28ub2JzZXJ2YWJsZSh0cnVlKSxcbiAgICAgICAgJ2FiaWxpdHknOiBrby5vYnNlcnZhYmxlKHRydWUpLFxuICAgICAgICAnYnVmZic6IGtvLm9ic2VydmFibGUodHJ1ZSksXG4gICAgICAgICdkZWJ1ZmYnOiBrby5vYnNlcnZhYmxlKHRydWUpLFxuICAgICAgICAnZGFtYWdlYW1wJzoga28ub2JzZXJ2YWJsZShmYWxzZSksXG4gICAgICAgICdpbGx1c2lvbic6IGtvLm9ic2VydmFibGUoZmFsc2UpLFxuICAgICAgICAnc2tpbGxidWlsZCc6IGtvLm9ic2VydmFibGUoZmFsc2UpLFxuICAgICAgICAnc2tpbGxidWlsZC1za2lsbHMnOiBrby5vYnNlcnZhYmxlKHRydWUpLFxuICAgICAgICAnc2tpbGxidWlsZC1pdGVtcyc6IGtvLm9ic2VydmFibGUodHJ1ZSlcbiAgICB9KTtcbiAgICBzZWxmLnNlY3Rpb25EaXNwbGF5VG9nZ2xlID0gZnVuY3Rpb24gKHNlY3Rpb24pIHtcbiAgICAgICAgc2VsZi5zZWN0aW9uRGlzcGxheSgpW3NlY3Rpb25dKCFzZWxmLnNlY3Rpb25EaXNwbGF5KClbc2VjdGlvbl0oKSk7XG4gICAgfVxuICAgIHNlbGYuc2hvd1VuaXRUYWIgPSBrby5vYnNlcnZhYmxlKGZhbHNlKTtcbiAgICBzZWxmLnNob3dEaWZmID0ga28ub2JzZXJ2YWJsZShmYWxzZSk7XG4gICAgc2VsZi5zaG93Q3JpdGljYWxTdHJpa2VEZXRhaWxzID0ga28ub2JzZXJ2YWJsZShmYWxzZSk7XG4gICAgc2VsZi5zaG93RGFtYWdlRGV0YWlscyA9IGtvLm9ic2VydmFibGUoZmFsc2UpO1xuICAgIHNlbGYuc2hvd1N0YXREZXRhaWxzID0ga28ub2JzZXJ2YWJsZShmYWxzZSk7XG4gICAgc2VsZi5zaG93RGFtYWdlQW1wQ2FsY0RldGFpbHMgPSBrby5vYnNlcnZhYmxlKGZhbHNlKTtcbiAgICBcbiAgICBzZWxmLmRhbWFnZUFtcGxpZmljYXRpb24gPSBuZXcgRGFtYWdlQW1wVmlld01vZGVsKGhlcm9EYXRhLCBpdGVtRGF0YSwgdW5pdERhdGEpO1xuICAgIHNlbGYuZGFtYWdlUmVkdWN0aW9uID0gbmV3IERhbWFnZUFtcFZpZXdNb2RlbChoZXJvRGF0YSwgaXRlbURhdGEsIHVuaXREYXRhKTtcbiAgICBIZXJvRGFtYWdlQW1wTWl4aW4oc2VsZik7XG59XG5DbG9uZVZpZXdNb2RlbC5wcm90b3R5cGUgPSBPYmplY3QuY3JlYXRlKEhlcm9DYWxjLkNsb25lTW9kZWwucHJvdG90eXBlKTtcbkNsb25lVmlld01vZGVsLnByb3RvdHlwZS5jb25zdHJ1Y3RvciA9IENsb25lVmlld01vZGVsO1xuXG5tb2R1bGUuZXhwb3J0cyA9IENsb25lVmlld01vZGVsOyIsIid1c2Ugc3RyaWN0JztcbnZhciBrbyA9IHJlcXVpcmUoJy4vaGVyb2NhbGNfa25vY2tvdXQnKTtcblxudmFyIEJ1ZmZWaWV3TW9kZWwgPSByZXF1aXJlKFwiZG90YS1oZXJvLWNhbGN1bGF0b3ItbGlicmFyeS9zcmMvaGVyb2NhbGMvQnVmZlZpZXdNb2RlbFwiKTtcbnZhciBCdWZmTW9kZWwgPSByZXF1aXJlKFwiZG90YS1oZXJvLWNhbGN1bGF0b3ItbGlicmFyeS9zcmMvaGVyb2NhbGMvYnVmZnMvQnVmZk1vZGVsXCIpO1xudmFyIGZpbmRXaGVyZSA9IHJlcXVpcmUoXCJkb3RhLWhlcm8tY2FsY3VsYXRvci1saWJyYXJ5L3NyYy9oZXJvY2FsYy91dGlsL2ZpbmRXaGVyZVwiKTtcblxudmFyIERhbWFnZUFtcFZpZXdNb2RlbCA9IGZ1bmN0aW9uIChoZXJvRGF0YSwgaXRlbURhdGEsIHVuaXREYXRhLCBhKSB7XG4gICAgdmFyIHNlbGYgPSB0aGlzO1xuICAgIEJ1ZmZWaWV3TW9kZWwuY2FsbCh0aGlzLCBpdGVtRGF0YSwga28ub2JzZXJ2YWJsZUFycmF5KFtdKSk7XG4gICAgc2VsZi5hdmFpbGFibGVCdWZmcyA9IGtvLm9ic2VydmFibGVBcnJheShbXG4gICAgICAgIG5ldyBCdWZmTW9kZWwoaGVyb0RhdGEsIHVuaXREYXRhLCAnc2xhcmRhcicsICdzbGFyZGFyX3NwcmludCcpLFxuICAgICAgICBuZXcgQnVmZk1vZGVsKGhlcm9EYXRhLCB1bml0RGF0YSwgJ3VuZHlpbmcnLCAndW5keWluZ19mbGVzaF9nb2xlbScpLFxuICAgICAgICBuZXcgQnVmZk1vZGVsKGhlcm9EYXRhLCB1bml0RGF0YSwgJ2NoZW4nLCAnY2hlbl9wZW5pdGVuY2UnKSxcbiAgICAgICAgbmV3IEJ1ZmZNb2RlbChoZXJvRGF0YSwgdW5pdERhdGEsICdtZWR1c2EnLCAnbWVkdXNhX3N0b25lX2dhemUnKSxcbiAgICAgICAgbmV3IEJ1ZmZNb2RlbChoZXJvRGF0YSwgdW5pdERhdGEsICdzaGFkb3dfZGVtb24nLCAnc2hhZG93X2RlbW9uX3NvdWxfY2F0Y2hlcicpXG4gICAgXSk7XG4gICAgc2VsZi5hdmFpbGFibGVEZWJ1ZmZzID0ga28ub2JzZXJ2YWJsZUFycmF5KFtcbiAgICAgICAgbmV3IEJ1ZmZNb2RlbChoZXJvRGF0YSwgdW5pdERhdGEsICdtZWR1c2EnLCAnbWVkdXNhX21hbmFfc2hpZWxkJyksXG4gICAgICAgIC8vbmV3IEJ1ZmZNb2RlbChoZXJvRGF0YSwgdW5pdERhdGEsICd0ZW1wbGFyX2Fzc2Fzc2luJywgJ3RlbXBsYXJfYXNzYXNzaW5fcmVmcmFjdGlvbicpLFxuICAgICAgICAvL25ldyBCdWZmTW9kZWwoaGVyb0RhdGEsIHVuaXREYXRhLCAnZmFjZWxlc3Nfdm9pZCcsICdmYWNlbGVzc192b2lkX2JhY2t0cmFjaycpLFxuICAgICAgICAvL25ldyBCdWZmTW9kZWwoaGVyb0RhdGEsIHVuaXREYXRhLCAnbnl4X2Fzc2Fzc2luJywgJ255eF9hc3Nhc3Npbl9zcGlrZWRfY2FyYXBhY2UnKSxcbiAgICAgICAgbmV3IEJ1ZmZNb2RlbChoZXJvRGF0YSwgdW5pdERhdGEsICdzcGVjdHJlJywgJ3NwZWN0cmVfZGlzcGVyc2lvbicpLFxuICAgICAgICBuZXcgQnVmZk1vZGVsKGhlcm9EYXRhLCB1bml0RGF0YSwgJ3dpc3AnLCAnd2lzcF9vdmVyY2hhcmdlJyksXG4gICAgICAgIG5ldyBCdWZmTW9kZWwoaGVyb0RhdGEsIHVuaXREYXRhLCAnYnJpc3RsZWJhY2snLCAnYnJpc3RsZWJhY2tfYnJpc3RsZWJhY2snKSxcbiAgICAgICAgLy9uZXcgQnVmZk1vZGVsKGhlcm9EYXRhLCB1bml0RGF0YSwgJ2FiYWRkb24nLCAnYWJhZGRvbl9ib3Jyb3dlZF90aW1lJyksXG4gICAgICAgIC8vbmV3IEJ1ZmZNb2RlbChoZXJvRGF0YSwgdW5pdERhdGEsICdhYmFkZG9uJywgJ2FiYWRkb25fYXBob3RpY19zaGllbGQnKSxcbiAgICAgICAgLy9uZXcgQnVmZk1vZGVsKGhlcm9EYXRhLCB1bml0RGF0YSwgJ2RhenpsZScsICdkYXp6bGVfc2hhbGxvd19ncmF2ZScpLFxuICAgICAgICAvL25ldyBCdWZmTW9kZWwoaGVyb0RhdGEsIHVuaXREYXRhLCAndHJlYW50JywgJ3RyZWFudF9saXZpbmdfYXJtb3InKSxcbiAgICAgICAgbmV3IEJ1ZmZNb2RlbChoZXJvRGF0YSwgdW5pdERhdGEsICdrdW5ra2EnLCAna3Vua2thX2dob3N0c2hpcCcpXG4gICAgXSk7XG4gICAgc2VsZi5zZWxlY3RlZEJ1ZmYgPSBrby5vYnNlcnZhYmxlKHNlbGYuYXZhaWxhYmxlQnVmZnMoKVswXSk7XG4gICAgXG4gICAgc2VsZi5idWZmcyA9IGtvLm9ic2VydmFibGVBcnJheShbXSk7XG5cbiAgICBzZWxmLmdldEFiaWxpdHlEYW1hZ2VBbXBWYWx1ZSA9IGZ1bmN0aW9uIChhYmlsaXR5TmFtZSwgYXR0cmlidXRlTmFtZSkge1xuICAgICAgICB2YXIgYSA9IGZpbmRXaGVyZShzZWxmLmJ1ZmZzKCksIHtuYW1lOiBhYmlsaXR5TmFtZX0pO1xuICAgICAgICBpZiAoYSA9PSB1bmRlZmluZWQpIHtcbiAgICAgICAgICAgIHJldHVybiAwO1xuICAgICAgICB9XG4gICAgICAgIGVsc2Uge1xuICAgICAgICAgICAgdmFyIGFiaWxpdHkgPSBhLmRhdGE7XG4gICAgICAgICAgICByZXR1cm4gc2VsZi5nZXRBYmlsaXR5QXR0cmlidXRlVmFsdWUoYWJpbGl0eS5hdHRyaWJ1dGVzLCBhdHRyaWJ1dGVOYW1lLCBhYmlsaXR5LmxldmVsKCkpO1xuICAgICAgICB9XG4gICAgfVxuICAgIFxuICAgIHNlbGYuZ2V0RGFtYWdlTXVsdGlwbGllclNvdXJjZXMgPSBrby5jb21wdXRlZChmdW5jdGlvbiAoKSB7XG4gICAgICAgIHZhciBzb3VyY2VzID0ge307XG4gICAgICAgIGZvciAodmFyIGkgPSAwOyBpIDwgc2VsZi5hYmlsaXRpZXMoKS5sZW5ndGg7IGkrKykge1xuICAgICAgICAgICAgdmFyIGFiaWxpdHkgPSBzZWxmLmFiaWxpdGllcygpW2ldO1xuICAgICAgICAgICAgICAgIGlmIChhYmlsaXR5LmxldmVsKCkgPiAwICYmIChhYmlsaXR5LmlzQWN0aXZlKCkgfHwgKGFiaWxpdHkuYmVoYXZpb3IuaW5kZXhPZignRE9UQV9BQklMSVRZX0JFSEFWSU9SX1BBU1NJVkUnKSAhPSAtMSkpKSB7XG4gICAgICAgICAgICAgICAgICAgIHN3aXRjaCAoYWJpbGl0eS5uYW1lKSB7XG4gICAgICAgICAgICAgICAgICAgICAgICBjYXNlICdicmlzdGxlYmFja19icmlzdGxlYmFjayc6XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgc291cmNlc1thYmlsaXR5Lm5hbWVdID0ge1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAnbXVsdGlwbGllcic6IGFiaWxpdHkuZGFtYWdlUmVkdWN0aW9uKCkgLyAxMDAsXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICdkYW1hZ2VUeXBlJzogJ3BoeXNpY2FsJyxcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgJ2Rpc3BsYXluYW1lJzogYWJpbGl0eS5kaXNwbGF5bmFtZVxuICAgICAgICAgICAgICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgICAgICAgICAgIGJyZWFrO1xuICAgICAgICAgICAgICAgICAgICAgICAgY2FzZSAnc2xhcmRhcl9zcHJpbnQnOlxuICAgICAgICAgICAgICAgICAgICAgICAgICAgIHNvdXJjZXNbYWJpbGl0eS5uYW1lXSA9IHtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgJ211bHRpcGxpZXInOiBzZWxmLmdldEFiaWxpdHlBdHRyaWJ1dGVWYWx1ZShhYmlsaXR5LmF0dHJpYnV0ZXMsICdib251c19kYW1hZ2UnLCBhYmlsaXR5LmxldmVsKCkpIC8gMTAwLFxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAnZGFtYWdlVHlwZSc6ICdwaHlzaWNhbCcsXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICdkaXNwbGF5bmFtZSc6IGFiaWxpdHkuZGlzcGxheW5hbWVcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgICAgICAgICAgICBicmVhaztcbiAgICAgICAgICAgICAgICAgICAgICAgIGNhc2UgJ3VuZHlpbmdfZmxlc2hfZ29sZW0nOlxuICAgICAgICAgICAgICAgICAgICAgICAgICAgIHNvdXJjZXNbYWJpbGl0eS5uYW1lXSA9IHtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgJ211bHRpcGxpZXInOiBhYmlsaXR5LmRhbWFnZUFtcGxpZmljYXRpb24oKSAvIDEwMCxcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgJ2RhbWFnZVR5cGUnOiAncGh5c2ljYWwnLFxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAnZGlzcGxheW5hbWUnOiBhYmlsaXR5LmRpc3BsYXluYW1lXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICAgICAgICAgICAgYnJlYWs7XG4gICAgICAgICAgICAgICAgICAgICAgICBjYXNlICdtZWR1c2Ffc3RvbmVfZ2F6ZSc6XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgc291cmNlc1thYmlsaXR5Lm5hbWVdID0ge1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAnbXVsdGlwbGllcic6IHNlbGYuZ2V0QWJpbGl0eUF0dHJpYnV0ZVZhbHVlKGFiaWxpdHkuYXR0cmlidXRlcywgJ2JvbnVzX3BoeXNpY2FsX2RhbWFnZScsIGFiaWxpdHkubGV2ZWwoKSkgLyAxMDAsXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICdkYW1hZ2VUeXBlJzogJ3BoeXNpY2FsJyxcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgJ2Rpc3BsYXluYW1lJzogYWJpbGl0eS5kaXNwbGF5bmFtZVxuICAgICAgICAgICAgICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgICAgICAgICAgIGJyZWFrO1xuICAgICAgICAgICAgICAgICAgICAgICAgY2FzZSAnY2hlbl9wZW5pdGVuY2UnOlxuICAgICAgICAgICAgICAgICAgICAgICAgICAgIHNvdXJjZXNbYWJpbGl0eS5uYW1lXSA9IHtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgJ211bHRpcGxpZXInOiBzZWxmLmdldEFiaWxpdHlBdHRyaWJ1dGVWYWx1ZShhYmlsaXR5LmF0dHJpYnV0ZXMsICdib251c19kYW1hZ2VfdGFrZW4nLCBhYmlsaXR5LmxldmVsKCkpIC8gMTAwLFxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAnZGFtYWdlVHlwZSc6ICdwaHlzaWNhbCcsXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICdkaXNwbGF5bmFtZSc6IGFiaWxpdHkuZGlzcGxheW5hbWVcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgICAgICAgICAgICBicmVhaztcbiAgICAgICAgICAgICAgICAgICAgICAgIGNhc2UgJ3NoYWRvd19kZW1vbl9zb3VsX2NhdGNoZXInOlxuICAgICAgICAgICAgICAgICAgICAgICAgICAgIHNvdXJjZXNbYWJpbGl0eS5uYW1lXSA9IHtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgJ211bHRpcGxpZXInOiBzZWxmLmdldEFiaWxpdHlBdHRyaWJ1dGVWYWx1ZShhYmlsaXR5LmF0dHJpYnV0ZXMsICdib251c19kYW1hZ2VfdGFrZW4nLCBhYmlsaXR5LmxldmVsKCkpIC8gMTAwLFxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAnZGFtYWdlVHlwZSc6ICdwdXJlJyxcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgJ2Rpc3BsYXluYW1lJzogYWJpbGl0eS5kaXNwbGF5bmFtZVxuICAgICAgICAgICAgICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgICAgICAgICAgIGJyZWFrO1xuICAgICAgICAgICAgICAgICAgICAgICAgY2FzZSAnbWVkdXNhX21hbmFfc2hpZWxkJzpcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICBzb3VyY2VzW2FiaWxpdHkubmFtZV0gPSB7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICdtdWx0aXBsaWVyJzogYWJpbGl0eS5kYW1hZ2VSZWR1Y3Rpb24oKSAvIDEwMCxcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgJ2RhbWFnZVR5cGUnOiAncGh5c2ljYWwnLFxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAnZGlzcGxheW5hbWUnOiBhYmlsaXR5LmRpc3BsYXluYW1lXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgfSAgICAgICAgICAgICAgICAgICAgICAgICAgICBcbiAgICAgICAgICAgICAgICAgICAgICAgIGJyZWFrO1xuICAgICAgICAgICAgICAgICAgICAgICAgY2FzZSAnc3BlY3RyZV9kaXNwZXJzaW9uJzpcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICBzb3VyY2VzW2FiaWxpdHkubmFtZV0gPSB7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICdtdWx0aXBsaWVyJzogLXNlbGYuZ2V0QWJpbGl0eUF0dHJpYnV0ZVZhbHVlKGFiaWxpdHkuYXR0cmlidXRlcywgJ2RhbWFnZV9yZWZsZWN0aW9uX3BjdCcsIGFiaWxpdHkubGV2ZWwoKSkgLyAxMDAsXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICdkYW1hZ2VUeXBlJzogJ3BlcmNlbnRyZWR1Y3Rpb24nLFxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAnZGlzcGxheW5hbWUnOiBhYmlsaXR5LmRpc3BsYXluYW1lXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgfSAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgXG4gICAgICAgICAgICAgICAgICAgICAgICBicmVhaztcbiAgICAgICAgICAgICAgICAgICAgICAgIGNhc2UgJ2FiYWRkb25fYXBob3RpY19zaGllbGQnOlxuICAgICAgICAgICAgICAgICAgICAgICAgICAgIHNvdXJjZXNbYWJpbGl0eS5uYW1lXSA9IHtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgJ211bHRpcGxpZXInOiBzZWxmLmdldEFiaWxpdHlBdHRyaWJ1dGVWYWx1ZShhYmlsaXR5LmF0dHJpYnV0ZXMsICdkYW1hZ2VfYWJzb3JiJywgYWJpbGl0eS5sZXZlbCgpKSxcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgJ2RhbWFnZVR5cGUnOiAnZmxhdHJlZHVjdGlvbicsXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICdkaXNwbGF5bmFtZSc6IGFiaWxpdHkuZGlzcGxheW5hbWVcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICB9ICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBcbiAgICAgICAgICAgICAgICAgICAgICAgIGJyZWFrO1xuICAgICAgICAgICAgICAgICAgICAgICAgY2FzZSAna3Vua2thX2dob3N0c2hpcCc6XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgc291cmNlc1thYmlsaXR5Lm5hbWVdID0ge1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAnbXVsdGlwbGllcic6IC01MCAvIDEwMCxcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgJ2RhbWFnZVR5cGUnOiAncGVyY2VudHJlZHVjdGlvbicsXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICdkaXNwbGF5bmFtZSc6IGFiaWxpdHkuZGlzcGxheW5hbWVcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICB9ICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBcbiAgICAgICAgICAgICAgICAgICAgICAgIGJyZWFrO1xuICAgICAgICAgICAgICAgICAgICAgICAgY2FzZSAnd2lzcF9vdmVyY2hhcmdlJzpcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICBzb3VyY2VzW2FiaWxpdHkubmFtZV0gPSB7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICdtdWx0aXBsaWVyJzogc2VsZi5nZXRBYmlsaXR5QXR0cmlidXRlVmFsdWUoYWJpbGl0eS5hdHRyaWJ1dGVzLCAnYm9udXNfZGFtYWdlX3BjdCcsIGFiaWxpdHkubGV2ZWwoKSkgLyAxMDAsXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICdkYW1hZ2VUeXBlJzogJ3BlcmNlbnRyZWR1Y3Rpb24nLFxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAnZGlzcGxheW5hbWUnOiBhYmlsaXR5LmRpc3BsYXluYW1lXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgfSAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgXG4gICAgICAgICAgICAgICAgICAgICAgICBicmVhaztcbiAgICAgICAgICAgICAgICAgICAgICAgIC8qY2FzZSAnZmFjZWxlc3Nfdm9pZF9iYWNrdHJhY2snOlxuICAgICAgICAgICAgICAgICAgICAgICAgICAgIHNvdXJjZXNbYWJpbGl0eS5uYW1lXSA9IHtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgJ211bHRpcGxpZXInOiAtc2VsZi5nZXRBYmlsaXR5QXR0cmlidXRlVmFsdWUoYWJpbGl0eS5hdHRyaWJ1dGVzLCAnZG9kZ2VfY2hhbmNlX3BjdCcsIGFiaWxpdHkubGV2ZWwoKSkgLyAxMDAsXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICdkYW1hZ2VUeXBlJzogJ3BlcmNlbnRyZWR1Y3Rpb24nLFxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAnZGlzcGxheW5hbWUnOiBhYmlsaXR5LmRpc3BsYXluYW1lXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgfSAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgXG4gICAgICAgICAgICAgICAgICAgICAgICBicmVhazsqL1xuICAgICAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgICAgfVxuICAgICAgICB9XG4gICAgICAgIHJldHVybiBzb3VyY2VzO1xuICAgIH0pO1xuICAgIFxuICAgIHJldHVybiBzZWxmO1xufVxuRGFtYWdlQW1wVmlld01vZGVsLnByb3RvdHlwZSA9IE9iamVjdC5jcmVhdGUoQnVmZlZpZXdNb2RlbC5wcm90b3R5cGUpO1xuRGFtYWdlQW1wVmlld01vZGVsLnByb3RvdHlwZS5jb25zdHJ1Y3RvciA9IERhbWFnZUFtcFZpZXdNb2RlbDtcblxubW9kdWxlLmV4cG9ydHMgPSBEYW1hZ2VBbXBWaWV3TW9kZWw7IiwiJ3VzZSBzdHJpY3QnO1xudmFyIGtvID0gcmVxdWlyZSgnLi9oZXJvY2FsY19rbm9ja291dCcpO1xudmFyICQgPSAodHlwZW9mIHdpbmRvdyAhPT0gXCJ1bmRlZmluZWRcIiA/IHdpbmRvd1snJCddIDogdHlwZW9mIGdsb2JhbCAhPT0gXCJ1bmRlZmluZWRcIiA/IGdsb2JhbFsnJCddIDogbnVsbCk7XG5yZXF1aXJlKCcuL2pxdWVyeS11aS5jdXN0b20nKTtcblxua28uY29tcG9uZW50cy5yZWdpc3RlcignaGVyby1wYW5lJywgeyB0ZW1wbGF0ZTogXCI8ZGl2IGNsYXNzPVxcXCJyb3dcXFwiPlxcbiAgICA8ZGl2IGNsYXNzPVxcXCJjb2wtbWQtMyBjb2wtc20tNlxcXCI+XFxuICAgICAgICA8aW1nIGNsYXNzPVxcXCJpbWctcm91bmRlZCBoZXJvLWltYWdlXFxcIiBkYXRhLWJpbmQ9XFxcImF0dHI6e3NyYzogJy9tZWRpYS9pbWFnZXMvaGVyb2VzLycgKyBzZWxlY3RlZEhlcm8oKS5oZXJvTmFtZSArICcucG5nJ31cXFwiLz5cXG4gICAgPC9kaXY+XFxuICAgIDxkaXYgY2xhc3M9XFxcImNvbC1tZC05IGNvbC1zbS02XFxcIj5cXG4gICAgICAgIDxkaXYgY2xhc3M9XFxcInJvdyBmb3JtLWdyb3VwXFxcIj5cXG4gICAgICAgICAgICA8ZGl2IGNsYXNzPVxcXCJjb2wtbWQtNlxcXCI+XFxuICAgICAgICAgICAgICAgIDxsYWJlbCBmb3I9XFxcImhlcm9zZWxlY3RcXFwiPkhlcm88L2xhYmVsPlxcbiAgICAgICAgICAgICAgICA8c2VsZWN0IGlkPVxcXCJoZXJvc2VsZWN0XFxcIiBjbGFzcz1cXFwiZm9ybS1jb250cm9sXFxcIiBkYXRhLWJpbmQ9XFxcIm9wdGlvbnM6IGF2YWlsYWJsZUhlcm9lcyAsIG9wdGlvbnNUZXh0OiAnaGVyb0Rpc3BsYXlOYW1lJywgdmFsdWU6IHNlbGVjdGVkSGVyb1xcXCI+PC9zZWxlY3Q+XFxuICAgICAgICAgICAgPC9kaXY+XFxuICAgICAgICAgICAgPGRpdiBjbGFzcz1cXFwiY29sLW1kLTZcXFwiPlxcbiAgICAgICAgICAgICAgICA8bGFiZWwgZm9yPVxcXCJoZXJvbGV2ZWxcXFwiPkxldmVsPC9sYWJlbD5cXG4gICAgICAgICAgICAgICAgPGlucHV0IGlkPVxcXCJoZXJvbGV2ZWxcXFwiIGRhdGEtYmluZD1cXFwic3Bpbm5lcjogc2VsZWN0ZWRIZXJvTGV2ZWwsIHNwaW5uZXJPcHRpb25zOiB7IG1pbjogMSwgbWF4OiAyNSB9XFxcIj5cXG4gICAgICAgICAgICA8L2Rpdj5cXG4gICAgICAgIDwvZGl2PlxcbiAgICAgICAgPGRpdiBjbGFzcz1cXFwicm93XFxcIj5cXG4gICAgICAgICAgICA8ZGl2IGNsYXNzPVxcXCJjb2wtbWQtNlxcXCI+XFxuICAgICAgICAgICAgICAgIDxsYWJlbCBmb3I9XFxcImVuZW15c2VsZWN0XFxcIj5FbmVteTwvbGFiZWw+XFxuICAgICAgICAgICAgICAgIDxzZWxlY3QgaWQ9XFxcImVuZW15c2VsZWN0XFxcIiBjbGFzcz1cXFwiZm9ybS1jb250cm9sXFxcIiBkYXRhLWJpbmQ9XFxcImNzczogZW5lbXkoKS5wbGF5ZXJDb2xvckNzcywgb3B0aW9uczogYXZhaWxhYmxlRW5lbWllcyAsIG9wdGlvbnNUZXh0OiAnaGVyb0Rpc3BsYXlOYW1lJywgdmFsdWU6IHNlbGVjdGVkRW5lbXksIG9wdGlvbnNBZnRlclJlbmRlcjogc2V0SGVyb09wdGlvblN0eWxpbmdcXFwiPjwvc2VsZWN0PlxcbiAgICAgICAgICAgIDwvZGl2PlxcbiAgICAgICAgICAgIDxkaXYgY2xhc3M9XFxcImNvbC1tZC02XFxcIj5cXG4gICAgICAgICAgICAgICAgPGxhYmVsIGZvcj1cXFwiZW5lbXlzZWxlY3RcXFwiPkNvbXBhcmUgdG88L2xhYmVsPlxcbiAgICAgICAgICAgICAgICA8c2VsZWN0IGlkPVxcXCJlbmVteXNlbGVjdFxcXCIgY2xhc3M9XFxcImZvcm0tY29udHJvbFxcXCIgZGF0YS1iaW5kPVxcXCJjc3M6IGhlcm9Db21wYXJlKCkucGxheWVyQ29sb3JDc3MsIG9wdGlvbnM6IGF2YWlsYWJsZUNvbXBhcmUgLCBvcHRpb25zVGV4dDogJ2hlcm9EaXNwbGF5TmFtZScsIHZhbHVlOiBzZWxlY3RlZENvbXBhcmUsIG9wdGlvbnNBZnRlclJlbmRlcjogc2V0SGVyb09wdGlvblN0eWxpbmdcXFwiPjwvc2VsZWN0PlxcbiAgICAgICAgICAgIDwvZGl2PlxcbiAgICAgICAgICAgIDxkaXYgY2xhc3M9XFxcImNvbC1tZC0xMiBjaGVja2JveFxcXCIgc3R5bGU9XFxcIm1hcmdpbi1ib3R0b206MHB4O3BhZGRpbmctbGVmdDozNHB4O1xcXCIgZGF0YS1iaW5kPVxcXCJ2aXNpYmxlOiAkcm9vdC5sYXlvdXQoKSA9PSAwXFxcIj5cXG4gICAgICAgICAgICAgICAgPGxhYmVsPjxpbnB1dCB0eXBlPVxcXCJjaGVja2JveFxcXCIgc3R5bGU9XFxcImZsb2F0Om5vbmU7bWFyZ2luLXJpZ2h0OjVweDtcXFwiIGRhdGEtYmluZD1cXFwiY2hlY2tlZDogc2hvd0RpZmZcXFwiPjxzcGFuIHN0eWxlPVxcXCJmb250LXNpemU6MTJweFxcXCI+U2hvdyA8YWJiciB0aXRsZT1cXFwiVGhlIGRpZmZlcmVuY2UgYmV0d2VlbiB0d28gYWRqYWNlbnQgaGVybyB0YWJzIHNob3duIG5leHQgdG8gZWFjaCBzdGF0LlxcXCI+ZGVsdGEgdmFsdWVzPC9hYmJyPi4gPHNwYW4gZGF0YS1iaW5kPVxcXCJ2aXNpYmxlOiBzaG93RGlmZlxcXCI+Q29tcGFyaW5nIGxldmVsIDxzcGFuIGRhdGEtYmluZD1cXFwidGV4dDogc2VsZWN0ZWRIZXJvTGV2ZWxcXFwiPjwvc3Bhbj4gPHNwYW4gZGF0YS1iaW5kPVxcXCJ0ZXh0OiBoZXJvRGF0YSgpLmRpc3BsYXluYW1lLCBjc3M6IHBsYXllckNvbG9yQ3NzXFxcIj48L3NwYW4+IHRvIGxldmVsIDxzcGFuIGRhdGEtYmluZD1cXFwidGV4dDogaGVyb0NvbXBhcmUoKS5zZWxlY3RlZEhlcm9MZXZlbFxcXCI+PC9zcGFuPiA8c3BhbiBkYXRhLWJpbmQ9XFxcInRleHQ6IGhlcm9Db21wYXJlKCkuaGVyb0RhdGEoKS5kaXNwbGF5bmFtZSwgY3NzOiBoZXJvQ29tcGFyZSgpLnBsYXllckNvbG9yQ3NzXFxcIj48L3NwYW4+Ljwvc3Bhbj48L3NwYW4+PC9sYWJlbD5cXG4gICAgICAgICAgICAgICAgPGxhYmVsIHN0eWxlPVxcXCJtYXJnaW4tbGVmdDoyNXB4O2ZvbnQtc2l6ZToxMnB4O1xcXCI+PGlucHV0IHR5cGU9XFxcImNoZWNrYm94XFxcIiBzdHlsZT1cXFwiZmxvYXQ6bm9uZTttYXJnaW4tcmlnaHQ6NXB4O1xcXCIgZGF0YS1iaW5kPVxcXCJjaGVja2VkOiBzaG93VW5pdFRhYlxcXCI+U2hvdyB1bml0IHRhYjwvbGFiZWw+XFxuICAgICAgICAgICAgPC9kaXY+XFxuICAgICAgICA8L2Rpdj5cXG4gICAgPC9kaXY+XFxuPC9kaXY+XFxuXFxuPGRpdiBjbGFzcz1cXFwicm93XFxcIj5cXG4gICAgPGRpdiBjbGFzcz1cXFwiY29sLW1kLTRcXFwiIGRhdGEtYmluZD1cXFwiY3NzOiB7J2NvbC1tZC00JzogJHJvb3QubGF5b3V0KCkgPT0gMCwgJ2NvbC1tZC0xMic6ICRyb290LmxheW91dCgpID09IDF9XFxcIj5cXG4gICAgICAgIDxkaXYgY2xhc3M9XFxcInJvd1xcXCI+XFxuICAgICAgICAgICAgPGgzIGNsYXNzPVxcXCJjb2wtbWQtMTJcXFwiPlN0YXRzIDxhIGNsYXNzPVxcXCJidG4gYnRuLWRlZmF1bHQgYnRuLXhzXFxcIiBkYXRhLWJpbmQ9XFxcInRvZ2dsZTogc2hvd1N0YXREZXRhaWxzLCB0ZXh0OiAhc2hvd1N0YXREZXRhaWxzKCkgPyAnU2hvdyBtb3JlJyA6ICdTaG93IGxlc3MnLCBhdHRyOiB7dGl0bGU6ICFzaG93U3RhdERldGFpbHMoKSA/ICdDbGljayB0byBzaG93IGJhc2Ugc3RhdHMnIDogJ0NsaWNrIHRvIGhpZGUgYmFzZSBzdGF0cyd9XFxcIj48L2E+XFxuICAgICAgICAgICAgICAgIDxkaXYgc3R5bGU9XFxcIm1hcmdpbi1sZWZ0OjE1cHg7ZGlzcGxheTppbmxpbmU7XFxcIiBkYXRhLWJpbmQ9XFxcInN0eWxlOiB7J2Rpc3BsYXknOiAkcm9vdC5sYXlvdXQoKSA9PSAxID8gJ2lubGluZScgOiAnbm9uZSd9XFxcIj5cXG4gICAgICAgICAgICAgICAgICAgIDxsYWJlbD48aW5wdXQgdHlwZT1cXFwiY2hlY2tib3hcXFwiIHN0eWxlPVxcXCJmbG9hdDpub25lO21hcmdpbi1yaWdodDo1cHg7XFxcIiBkYXRhLWJpbmQ9XFxcImNoZWNrZWQ6IHNob3dEaWZmXFxcIj48c3BhbiBzdHlsZT1cXFwiZm9udC1zaXplOjEycHhcXFwiPlNob3cgPGFiYnIgdGl0bGU9XFxcIlRoZSBkaWZmZXJlbmNlIGJldHdlZW4gdHdvIGFkamFjZW50IGhlcm8gdGFicyBzaG93biBuZXh0IHRvIGVhY2ggc3RhdC5cXFwiPmRlbHRhIHZhbHVlczwvYWJicj4uIDxzcGFuIGRhdGEtYmluZD1cXFwidmlzaWJsZTogc2hvd0RpZmZcXFwiPkNvbXBhcmluZyBsZXZlbCA8c3BhbiBkYXRhLWJpbmQ9XFxcInRleHQ6IHNlbGVjdGVkSGVyb0xldmVsXFxcIj48L3NwYW4+IDxzcGFuIGRhdGEtYmluZD1cXFwidGV4dDogaGVyb0RhdGEoKS5kaXNwbGF5bmFtZSwgY3NzOiBwbGF5ZXJDb2xvckNzc1xcXCI+PC9zcGFuPiB0byBsZXZlbCA8c3BhbiBkYXRhLWJpbmQ9XFxcInRleHQ6IGhlcm9Db21wYXJlKCkuc2VsZWN0ZWRIZXJvTGV2ZWxcXFwiPjwvc3Bhbj4gPHNwYW4gZGF0YS1iaW5kPVxcXCJ0ZXh0OiBoZXJvQ29tcGFyZSgpLmhlcm9EYXRhKCkuZGlzcGxheW5hbWUsIGNzczogaGVyb0NvbXBhcmUoKS5wbGF5ZXJDb2xvckNzc1xcXCI+PC9zcGFuPi48L3NwYW4+PC9zcGFuPjwvbGFiZWw+XFxuICAgICAgICAgICAgICAgICAgICA8bGFiZWwgc3R5bGU9XFxcIm1hcmdpbi1sZWZ0OjI1cHg7Zm9udC1zaXplOjEycHg7XFxcIj48aW5wdXQgdHlwZT1cXFwiY2hlY2tib3hcXFwiIHN0eWxlPVxcXCJmbG9hdDpub25lO21hcmdpbi1yaWdodDo1cHg7XFxcIiBkYXRhLWJpbmQ9XFxcImNoZWNrZWQ6IHNob3dVbml0VGFiXFxcIj5TaG93IHVuaXQgdGFiPC9sYWJlbD5cXG4gICAgICAgICAgICAgICAgPC9kaXY+XFxuICAgICAgICAgICAgPC9oMz5cXG5cXG4gICAgICAgICAgICA8ZGl2IGNsYXNzPVxcXCJjb2wtbWQtMTJcXFwiIGRhdGEtYmluZD1cXFwidmlzaWJsZTogc2hvd1N0YXREZXRhaWxzKCksIGNzczogeydjb2wtbWQtMTInOiAkcm9vdC5sYXlvdXQoKSA9PSAwLCAnY29sLW1kLTMnOiAkcm9vdC5sYXlvdXQoKSA9PSAxfSwgY29tcG9uZW50OiB7bmFtZTogJ3N0YXRzLWFkZGl0aW9uYWwnLCBwYXJhbXM6ICRkYXRhfVxcXCI+PC9kaXY+XFxuXFxuICAgICAgICAgICAgPGRpdiBjbGFzcz1cXFwic3RhdHNjb250YWluZXJcXFwiIGRhdGEtYmluZD1cXFwiZm9yZWFjaDogJHJvb3QuYWxsSXRlbXNcXFwiPlxcbiAgICAgICAgICAgICAgICA8ZGl2IGRhdGEtYmluZD1cXFwiY29tcG9uZW50OiB7IG5hbWU6ICRkYXRhLnZhbHVlLCBwYXJhbXM6ICRwYXJlbnRDb250ZXh0LiRkYXRhfVxcXCI+PC9kaXY+XFxuICAgICAgICAgICAgPC9kaXY+XFxuICAgICAgICA8L2Rpdj5cXG4gICAgPC9kaXY+XFxuICAgIDxkaXYgY2xhc3M9XFxcImNvbC1tZC04XFxcIiBkYXRhLWJpbmQ9XFxcImNzczogeydjb2wtbWQtOCc6ICRyb290LmxheW91dCgpID09IDAsICdjb2wtbWQtMTInOiAkcm9vdC5sYXlvdXQoKSA9PSAxfVxcXCI+XFxuICAgICAgICA8ZGl2IGRhdGEtYmluZD1cXFwiY29tcG9uZW50OiB7IG5hbWU6ICdkYW1hZ2UtZGV0YWlscycsIHBhcmFtczogJGRhdGF9XFxcIj48L2Rpdj5cXG4gICAgXFxuICAgICAgICA8ZGl2IGNsYXNzPVxcXCJyb3dcXFwiPlxcbiAgICAgICAgICAgIDxkaXYgY2xhc3M9XFxcImNvbC1tZC0xMlxcXCIgZGF0YS1iaW5kPVxcXCJpdGVtQnVpbGRUYWJsZTogJGRhdGEuYnVpbGRFeHBsb3JlclxcXCI+XFxuICAgICAgICAgICAgICAgIDxoMyBjbGFzcz1cXFwic2VjdGlvbl9oZWFkZXJcXFwiIGRhdGEtYmluZD1cXFwidG9nZ2xlOiBzZWN0aW9uRGlzcGxheSgpLmludmVudG9yeSwgY3NzOiB7IHNlY3Rpb25fZGlzYWJsZWQ6ICFzZWN0aW9uRGlzcGxheSgpLmludmVudG9yeSgpIH1cXFwiPkludmVudG9yeSA8c21hbGwgc3R5bGU9XFxcImNvbG9yOmdvbGRlbnJvZFxcXCIgZGF0YS1iaW5kPVxcXCJodG1sOiBpbnZlbnRvcnkudG90YWxDb3N0KCkgPyAnPGltZyBzcmM9XFxcXCdodHRwOi8vY2RuLmRvdGEyLmNvbS9hcHBzL2RvdGEyL2ltYWdlcy90b29sdGlwcy9nb2xkLnBuZ1xcXFwnLz4gJyArIGludmVudG9yeS50b3RhbENvc3QoKSA6ICcnIFxcXCI+PC9zbWFsbD48L2gzPlxcbiAgICAgICAgICAgICAgICA8ZGl2IGlkPVxcXCJpbnZlbnRvcnlcXFwiIGNsYXNzPVxcXCJpbnZlbnRvcnkgaG92ZXItY3Vyc29yXFxcIiBkYXRhLWJpbmQ9XFxcImNsaWNrOiBmdW5jdGlvbiAoZGF0YSwgZXZlbnQpIHsgYnVpbGRFeHBsb3Jlci5zZWxlY3RJbnZlbnRvcnkoLTEpOyB9LCBjc3M6IHsncm93LWhpZ2hsaWdodCc6IHNlbGVjdGVkSW52ZW50b3J5KCkgPT0gLTF9LCB0ZW1wbGF0ZTogeyBuYW1lOiAnaXRlbS10ZW1wbGF0ZScsIGZvcmVhY2g6IGludmVudG9yeS5pdGVtcyB9LCB2aXNpYmxlOiBzZWN0aW9uRGlzcGxheSgpLmludmVudG9yeSgpXFxcIj48L2Rpdj5cXG4gICAgICAgICAgICA8L2Rpdj5cXG4gICAgICAgIDwvZGl2PlxcbiAgICAgICAgXFxuICAgICAgICA8ZGl2IGNsYXNzPVxcXCJyb3dcXFwiPlxcbiAgICAgICAgICAgIDxkaXYgY2xhc3M9XFxcImNvbC1tZC0xMlxcXCI+XFxuICAgICAgICAgICAgICAgIDxoMyBjbGFzcz1cXFwic2VjdGlvbl9oZWFkZXJcXFwiIGRhdGEtYmluZD1cXFwidG9nZ2xlOiBzZWN0aW9uRGlzcGxheSgpLmFiaWxpdHksIGNzczogeyBzZWN0aW9uX2Rpc2FibGVkOiAhc2VjdGlvbkRpc3BsYXkoKS5hYmlsaXR5KCkgfVxcXCI+QWJpbGl0aWVzIDxzbWFsbCBzdHlsZT1cXFwiY29sb3I6aW5oZXJpdFxcXCIgZGF0YS1iaW5kPVxcXCJ0ZXh0OiBhdmFpbGFibGVTa2lsbFBvaW50cygpID8gKGF2YWlsYWJsZVNraWxsUG9pbnRzKCkgPT0gMSA/ICcxIHVuc3BlbnQgc2tpbGxwb2ludCcgOiBhdmFpbGFibGVTa2lsbFBvaW50cygpICsgJyB1bnNwZW50IHNraWxscG9pbnRzJykgOiAnJ1xcXCI+PC9zbWFsbD48L2gzPlxcbiAgICAgICAgICAgICAgICA8ZGl2IGNsYXNzPVxcXCJyb3dcXFwiIGRhdGEtYmluZD1cXFwidmlzaWJsZTogc2VjdGlvbkRpc3BsYXkoKS5hYmlsaXR5KCksIGZvcmVhY2g6IGFiaWxpdHkoKS5hYmlsaXRpZXMoKVxcXCI+XFxuICAgICAgICAgICAgICAgICAgICA8ZGl2IGRhdGEtYmluZD1cXFwiY29tcG9uZW50OiB7IG5hbWU6ICdhYmlsaXR5JywgcGFyYW1zOiAkZGF0YSB9XFxcIj48L2Rpdj5cXG4gICAgICAgICAgICAgICAgPC9kaXY+XFxuICAgICAgICAgICAgICAgIDxkaXYgY2xhc3M9XFxcImZvcm0taG9yaXpvbnRhbFxcXCIgZGF0YS1iaW5kPVxcXCJpZjogc2VsZWN0ZWRIZXJvKCkuaGVyb05hbWUgPT0gJ3NpbGVuY2VyJywgdmlzaWJsZTogc2VjdGlvbkRpc3BsYXkoKS5hYmlsaXR5KClcXFwiPlxcbiAgICAgICAgICAgICAgICAgICAgPGRpdiBjbGFzcz1cXFwiZm9ybS1ncm91cFxcXCI+XFxuICAgICAgICAgICAgICAgICAgICAgICAgICAgIDxkaXYgY2xhc3M9XFxcImNvbC1tZC0yIGNvbnRyb2wtbGFiZWxcXFwiPlxcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgPGxhYmVsIGZvcj1cXFwiaW50ZWxsaWdlbmNlc3RvbGVuXFxcIj5JbnRlbGxpZ2VuY2UgU3RvbGVuPC9sYWJlbD5cXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgPC9kaXY+XFxuICAgICAgICAgICAgICAgICAgICAgICAgICAgIDxkaXYgY2xhc3M9XFxcImNvbC1tZC0yXFxcIj5cXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIDxpbnB1dCBjbGFzcz1cXFwiZm9ybS1jb250cm9sXFxcIiBpZD1cXFwiaW50ZWxsaWdlbmNlc3RvbGVuXFxcIiBkYXRhLWJpbmQ9XFxcInZhbHVlOiBpbnRTdG9sZW5cXFwiIC8+XFxuICAgICAgICAgICAgICAgICAgICAgICAgICAgIDwvZGl2PlxcbiAgICAgICAgICAgICAgICAgICAgPC9kaXY+XFxuICAgICAgICAgICAgICAgIDwvZGl2PlxcbiAgICAgICAgICAgIDwvZGl2PlxcbiAgICAgICAgPC9kaXY+XFxuXFxuICAgICAgICA8ZGl2IGRhdGEtYmluZD1cXFwiY29tcG9uZW50OiB7IG5hbWU6ICd0YWxlbnQtc2VjdGlvbicsIHBhcmFtczogJGRhdGF9XFxcIj48L2Rpdj5cXG4gICAgICAgIFxcbiAgICAgICAgPGRpdiBkYXRhLWJpbmQ9XFxcImNvbXBvbmVudDogeyBuYW1lOiAnYnVmZi1zZWN0aW9uJywgcGFyYW1zOiAkZGF0YX1cXFwiPjwvZGl2PlxcbiAgICAgICAgXFxuICAgICAgICA8ZGl2IGNsYXNzPVxcXCJyb3dcXFwiIGRhdGEtYmluZD1cXFwiY29tcG9uZW50OiB7IG5hbWU6ICdkYW1hZ2UtYW1wJywgcGFyYW1zOiAkZGF0YX1cXFwiPjwvZGl2PlxcblxcbiAgICAgICAgPGRpdiBjbGFzcz1cXFwicm93XFxcIj5cXG4gICAgICAgICAgICA8ZGl2IGNsYXNzPVxcXCJjb2wtbWQtMTJcXFwiPlxcbiAgICAgICAgICAgICAgICA8aDMgY2xhc3M9XFxcInNlY3Rpb25faGVhZGVyXFxcIiBkYXRhLWJpbmQ9XFxcInRvZ2dsZTogc2VjdGlvbkRpc3BsYXkoKS5pbGx1c2lvbiwgY3NzOiB7IHNlY3Rpb25fZGlzYWJsZWQ6ICFzZWN0aW9uRGlzcGxheSgpLmlsbHVzaW9uKCkgfVxcXCI+SWxsdXNpb25zPC9oMz5cXG4gICAgICAgICAgICAgICAgPGRpdiBkYXRhLWJpbmQ9XFxcInZpc2libGU6IHNlY3Rpb25EaXNwbGF5KCkuaWxsdXNpb24oKSwgbGF6eUJpbmRpbmc6IHNlY3Rpb25EaXNwbGF5KCkuaWxsdXNpb25cXFwiPlxcbiAgICAgICAgICAgICAgICAgICAgPGg0IHN0eWxlPVxcXCJjb2xvcjpyZWRcXFwiPlVuZGVyIENvbnN0cnVjdGlvbjwvaDQ+XFxuICAgICAgICAgICAgICAgICAgICA8ZGl2IGNsYXNzPVxcXCJmb3JtLWhvcml6b250YWxcXFwiPlxcbiAgICAgICAgICAgICAgICAgICAgICAgIDxkaXYgY2xhc3M9XFxcImZvcm0tZ3JvdXBcXFwiPlxcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgPGRpdiBjbGFzcz1cXFwiY29sLW1kLTIgY29udHJvbC1sYWJlbFxcXCI+XFxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgPGxhYmVsIGZvcj1cXFwiaWxsdXNpb25TZWxlY3RcXFwiPlR5cGU8L2xhYmVsPlxcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgPC9kaXY+XFxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICA8ZGl2IGNsYXNzPVxcXCJjb2wtbWQtMTBcXFwiPlxcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIDxzZWxlY3QgaWQ9XFxcImlsbHVzaW9uU2VsZWN0XFxcIiBjbGFzcz1cXFwiZm9ybS1jb250cm9sXFxcIiBkYXRhLWJpbmQ9XFxcIm9wdGlvbnM6IGF2YWlsYWJsZUlsbHVzaW9ucyAsIG9wdGlvbnNUZXh0OiAnaWxsdXNpb25EaXNwbGF5TmFtZScsIHZhbHVlOiBzZWxlY3RlZElsbHVzaW9uXFxcIj48L3NlbGVjdD5cXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIDwvZGl2PlxcbiAgICAgICAgICAgICAgICAgICAgICAgIDwvZGl2PlxcbiAgICAgICAgICAgICAgICAgICAgICAgIDxkaXYgY2xhc3M9XFxcImZvcm0tZ3JvdXBcXFwiPlxcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgPGRpdiBjbGFzcz1cXFwiY29sLW1kLTIgY29udHJvbC1sYWJlbFxcXCI+XFxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgPGxhYmVsIGZvcj1cXFwiaWxsdXNpb25hYmlsaXR5bGV2ZWxcXFwiPkFiaWxpdHkgTGV2ZWw8L2xhYmVsPlxcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgPC9kaXY+XFxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICA8ZGl2IGNsYXNzPVxcXCJjb2wtbWQtMTBcXFwiPlxcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIDxzZWxlY3QgaWQ9XFxcImlsbHVzaW9uYWJpbGl0eWxldmVsXFxcIiBjbGFzcz1cXFwiZm9ybS1jb250cm9sXFxcIiBkYXRhLWJpbmQ9XFxcInZhbHVlOiBpbGx1c2lvbkFiaWxpdHlMZXZlbCwgZm9yZWFjaDogbmV3IEFycmF5KGlsbHVzaW9uQWJpbGl0eU1heExldmVsKCkpXFxcIj5cXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgPG9wdGlvbiBkYXRhLWJpbmQ9XFxcInRleHQ6ICRpbmRleCgpKzFcXFwiPjwvb3B0aW9uPlxcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIDwvc2VsZWN0PlxcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgPC9kaXY+XFxuICAgICAgICAgICAgICAgICAgICAgICAgPC9kaXY+XFxuICAgICAgICAgICAgICAgICAgICAgICAgPGRpdiBjbGFzcz1cXFwiZm9ybS1ncm91cFxcXCI+XFxuICAgICAgICAgICAgICAgICAgICAgICAgICAgIDxkaXYgY2xhc3M9XFxcImNvbC1tZC1vZmZzZXQtMiBjb2wtbWQtMTBcXFwiPlxcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgPGJ1dHRvbiBjbGFzcz1cXFwiYnRuIGJ0bi1kZWZhdWx0XFxcIiBkYXRhLWJpbmQ9XFxcImNsaWNrOiBhZGRJbGx1c2lvblxcXCI+QWRkIElsbHVzaW9uPC9idXR0b24+XFxuICAgICAgICAgICAgICAgICAgICAgICAgICAgIDwvZGl2PlxcbiAgICAgICAgICAgICAgICAgICAgICAgIDwvZGl2PlxcbiAgICAgICAgICAgICAgICAgICAgPC9kaXY+XFxuICAgICAgICAgICAgICAgIDwvZGl2PlxcbiAgICAgICAgICAgIDwvZGl2PlxcbiAgICAgICAgPC9kaXY+XFxuICAgIDwvZGl2PlxcbiAgICBcXG4gICAgPGRpdiBjbGFzcz1cXFwiY29sLW1kLTEyXFxcIj5cXG4gICAgICAgIDxoMyBjbGFzcz1cXFwic2VjdGlvbl9oZWFkZXJcXFwiIGRhdGEtYmluZD1cXFwidG9nZ2xlOiBzZWN0aW9uRGlzcGxheSgpLnNraWxsYnVpbGQsIGNzczogeyBzZWN0aW9uX2Rpc2FibGVkOiAhc2VjdGlvbkRpc3BsYXkoKS5za2lsbGJ1aWxkKCkgfVxcXCI+QnVpbGQgRXhwbG9yZXI8L2gzPlxcbiAgICAgICAgPGRpdiBkYXRhLWJpbmQ9XFxcInZpc2libGU6IHNlY3Rpb25EaXNwbGF5KCkuc2tpbGxidWlsZCgpLCBhdHRyOiB7aWQ6ICdzZWN0aW9uLWJ1aWxkLWV4cGxvcmVyLScgKyBpbmRleCgpIH0sIGxhenlCaW5kaW5nOiBzZWN0aW9uRGlzcGxheSgpLnNraWxsYnVpbGRcXFwiPlxcbiAgICAgICAgICAgIDxkaXYgY2xhc3M9XFxcInNlY3Rpb24tY29udGVudFxcXCI+ICAgIFxcbiAgICAgICAgICAgICAgICA8ZGl2IGNsYXNzPVxcXCJjb2wtbWQtMTJcXFwiPlxcbiAgICAgICAgICAgICAgICAgICAgPGg0IGNsYXNzPVxcXCJzZWN0aW9uX2hlYWRlclxcXCIgZGF0YS1iaW5kPVxcXCJ0b2dnbGU6IHNlY3Rpb25EaXNwbGF5KClbJ3NraWxsYnVpbGQtc2tpbGxzJ10sIGNzczogeyBzZWN0aW9uX2Rpc2FibGVkOiAhc2VjdGlvbkRpc3BsYXkoKVsnc2tpbGxidWlsZC1za2lsbHMnXSgpIH1cXFwiPlNraWxsIEJ1aWxkIDxzbWFsbCBzdHlsZT1cXFwiY29sb3I6aW5oZXJpdFxcXCIgZGF0YS1iaW5kPVxcXCJ0ZXh0OiBidWlsZEV4cGxvcmVyLmF2YWlsYWJsZVNraWxsQnVpbGRQb2ludHMoKSA/IChidWlsZEV4cGxvcmVyLmF2YWlsYWJsZVNraWxsQnVpbGRQb2ludHMoKSA9PSAxID8gJzEgdW5zcGVudCBza2lsbHBvaW50JyA6IGJ1aWxkRXhwbG9yZXIuYXZhaWxhYmxlU2tpbGxCdWlsZFBvaW50cygpICsgJyB1bnNwZW50IHNraWxscG9pbnRzJykgOiAnJ1xcXCI+PC9zbWFsbD48L2g0PlxcbiAgICAgICAgICAgICAgICAgICAgICAgIDxkaXYgZGF0YS1iaW5kPVxcXCJ2aXNpYmxlOiBzZWN0aW9uRGlzcGxheSgpWydza2lsbGJ1aWxkLXNraWxscyddXFxcIj5cXG4gICAgICAgICAgICAgICAgICAgICAgICA8dGFibGU+XFxuICAgICAgICAgICAgICAgICAgICAgICAgICAgIDx0Ym9keSBkYXRhLWJpbmQ9XFxcInRlbXBsYXRlOiB7IG5hbWU6ICdhYmlsaXR5LTMtdGVtcGxhdGUnLCBmb3JlYWNoOiBhYmlsaXR5KCkuYWJpbGl0aWVzKCkgfVxcXCI+PC90Ym9keT5cXG4gICAgICAgICAgICAgICAgICAgICAgICA8L3RhYmxlPlxcbiAgICAgICAgICAgICAgICAgICAgICAgIDxkaXYgY2xhc3M9XFxcImZvcm0tZ3JvdXBcXFwiPlxcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICA8YnV0dG9uIGNsYXNzPVxcXCJidG4gYnRuLWRlZmF1bHRcXFwiIGRhdGEtYmluZD1cXFwiY2xpY2s6IGJ1aWxkRXhwbG9yZXIucmVzZXRTa2lsbEJ1aWxkXFxcIj5DbGVhcjwvYnV0dG9uPlxcbiAgICAgICAgICAgICAgICAgICAgICAgIDwvZGl2PlxcbiAgICAgICAgICAgICAgICAgICAgPC9kaXY+XFxuICAgICAgICAgICAgICAgIDwvZGl2PlxcbiAgICAgICAgICAgICAgICA8ZGl2IGNsYXNzPVxcXCJjb2wtbWQtMTJcXFwiPlxcbiAgICAgICAgICAgICAgICAgICAgPGg0IGNsYXNzPVxcXCJzZWN0aW9uX2hlYWRlclxcXCIgZGF0YS1iaW5kPVxcXCJ0b2dnbGU6IHNlY3Rpb25EaXNwbGF5KClbJ3NraWxsYnVpbGQtaXRlbXMnXSwgY3NzOiB7IHNlY3Rpb25fZGlzYWJsZWQ6ICFzZWN0aW9uRGlzcGxheSgpWydza2lsbGJ1aWxkLWl0ZW1zJ10oKSB9XFxcIj5JdGVtIEJ1aWxkPC9oND5cXG4gICAgICAgICAgICAgICAgICAgIDxkaXYgZGF0YS1iaW5kPVxcXCJ2aXNpYmxlOiBzZWN0aW9uRGlzcGxheSgpWydza2lsbGJ1aWxkLWl0ZW1zJ11cXFwiPlxcbiAgICAgICAgICAgICAgICAgICAgICAgIDx0YWJsZSBjbGFzcz1cXFwidGFibGVcXFwiPlxcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICA8dGhlYWQ+XFxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICA8dHI+XFxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgPHRoPkxldmVsPC90aD5cXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICA8dGggY2xhc3M9XFxcInRleHQtY2VudGVyXFxcIj5JbnZlbnRvcnk8L3RoPlxcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIDx0aD48L3RoPlxcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIDx0aD48L3RoPlxcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIDx0aD48L3RoPlxcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgPC90cj5cXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgPC90aGVhZD5cXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgPHRib2R5IGRhdGEtYmluZD1cXFwiZm9yZWFjaDogbmV3IEFycmF5KDI1KSwgaXRlbUJ1aWxkVGFibGU6IGJ1aWxkRXhwbG9yZXJcXFwiPlxcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgPHRyIGNsYXNzPVxcXCJob3Zlci1jdXJzb3JcXFwiIGRhdGEtYmluZD1cXFwiY3NzOiB7J3Jvdy1oaWdobGlnaHQnOiAkcGFyZW50LnNlbGVjdGVkSW52ZW50b3J5KCkgPT0gJGluZGV4KCl9XFxcIj5cXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICA8dGQgY2xhc3M9XFxcImNhcnJ5LW92ZXJcXFwiIGRhdGEtYmluZD1cXFwiY2xpY2s6IGZ1bmN0aW9uIChkYXRhLCBldmVudCkgeyAkcGFyZW50LmJ1aWxkRXhwbG9yZXIuc2VsZWN0SW52ZW50b3J5KCRpbmRleCgpKTsgfVxcXCI+XFxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIDxzdHJvbmcgZGF0YS1iaW5kPVxcXCJ0ZXh0OiAoJGluZGV4KCkgKyAxKVxcXCI+PC9zdHJvbmc+XFxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIDxhIGNsYXNzPVxcXCJidG4gYnRuLWRlZmF1bHQgYnRuLXhzIGdseXBoaWNvblxcXCIgZGF0YS1iaW5kPVxcXCJ2aXNpYmxlOiAkaW5kZXgoKSA+IDAsIHRvZ2dsZTogJHBhcmVudC5idWlsZEV4cGxvcmVyLml0ZW1CdWlsZCgpWyRpbmRleCgpXS5jYXJyeU92ZXIsIHByZXZlbnRCdWJibGU6ICdjbGljaycsIGNzczogeyAnZ2x5cGhpY29uLWFycm93LWRvd24nOiAkcGFyZW50LmJ1aWxkRXhwbG9yZXIuaXRlbUJ1aWxkKClbJGluZGV4KCldLmNhcnJ5T3ZlcigpLCAnZ2x5cGhpY29uLXN0b3AnOiAhJHBhcmVudC5idWlsZEV4cGxvcmVyLml0ZW1CdWlsZCgpWyRpbmRleCgpXS5jYXJyeU92ZXIoKSB9XFxcIiB0aXRsZT1cXFwiQ2Fycnkgb3ZlciBpdGVtcyB0byBuZXh0IGxldmVsJ3MgaW52ZW50b3J5XFxcIj48L2E+XFxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgPC90ZD5cXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICA8dGQgY2xhc3M9XFxcImNvbC1tZC0xMFxcXCIgZGF0YS1iaW5kPVxcXCJjbGljazogZnVuY3Rpb24gKGRhdGEsIGV2ZW50KSB7ICRwYXJlbnQuYnVpbGRFeHBsb3Jlci5zZWxlY3RJbnZlbnRvcnkoJGluZGV4KCkpOyB9XFxcIj5cXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgPGRpdiBjbGFzcz1cXFwiaXRlbUJ1aWxkLWludmVudG9yeVxcXCIgZGF0YS1iaW5kPVxcXCJ0ZW1wbGF0ZTogeyBuYW1lOiAnaXRlbUJ1aWxkLWl0ZW0tdGVtcGxhdGUnLCBmb3JlYWNoOiAkcGFyZW50LmJ1aWxkRXhwbG9yZXIuaXRlbUJ1aWxkKClbJGluZGV4KCldLml0ZW1zIH1cXFwiPjwvZGl2PlxcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIDwvdGQ+XFxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgPHRkPlxcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICA8YSBjbGFzcz1cXFwiYnRuIGJ0bi1kZWZhdWx0IGJ0bi14c1xcXCIgZGF0YS1iaW5kPVxcXCJjbGljazogZnVuY3Rpb24gKGRhdGEsIGV2ZW50KSB7ICRwYXJlbnQuYnVpbGRFeHBsb3Jlci5jb3B5SW52ZW50b3J5VG9DbGlwQm9hcmQoJGluZGV4KCkpOyB9XFxcIiB0aXRsZT1cXFwiQ29weSBpdGVtc1xcXCI+Q29weTwvYT5cXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICA8L3RkPlxcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIDx0ZD5cXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgPGEgY2xhc3M9XFxcImJ0biBidG4tZGVmYXVsdCBidG4teHNcXFwiIGRhdGEtYmluZD1cXFwiY2xpY2s6IGZ1bmN0aW9uIChkYXRhLCBldmVudCkgeyAkcGFyZW50LmJ1aWxkRXhwbG9yZXIucGFzdGVJbnZlbnRvcnlGcm9tQ2xpcEJvYXJkKCRpbmRleCgpKTsgfVxcXCIgdGl0bGU9XFxcIlBhc3RlIGl0ZW1zXFxcIj5QYXN0ZTwvYT5cXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICA8L3RkPlxcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIDx0ZD5cXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgPGEgY2xhc3M9XFxcImJ0biBidG4tZGVmYXVsdCBidG4teHNcXFwiIGRhdGEtYmluZD1cXFwiY2xpY2s6IGZ1bmN0aW9uIChkYXRhLCBldmVudCkgeyAkcGFyZW50LmJ1aWxkRXhwbG9yZXIucmVzZXRJdGVtQnVpbGQoJGluZGV4KCkpOyB9XFxcIiB0aXRsZT1cXFwiQ2xlYXIgaW52ZW50b3J5XFxcIj5DbGVhcjwvYT5cXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICA8L3RkPlxcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgPC90cj5cXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgPC90Ym9keT5cXG4gICAgICAgICAgICAgICAgICAgICAgICA8L3RhYmxlPlxcbiAgICAgICAgICAgICAgICAgICAgICAgIDxkaXYgY2xhc3M9XFxcImZvcm0tZ3JvdXBcXFwiPlxcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICA8YnV0dG9uIGNsYXNzPVxcXCJidG4gYnRuLWRlZmF1bHRcXFwiIGRhdGEtYmluZD1cXFwiY2xpY2s6IGJ1aWxkRXhwbG9yZXIucmVzZXRBbGxJdGVtQnVpbGRzXFxcIj5DbGVhcjwvYnV0dG9uPlxcbiAgICAgICAgICAgICAgICAgICAgICAgIDwvZGl2PlxcbiAgICAgICAgICAgICAgICAgICAgPC9kaXY+XFxuICAgICAgICAgICAgICAgIDwvZGl2PlxcbiAgICAgICAgICAgICAgICA8ZGl2IGNsYXNzPVxcXCJmb3JtLWdyb3VwXFxcIj5cXG4gICAgICAgICAgICAgICAgICAgIDxsYWJlbD5EYXRhIHNldCBoZWFkZXIgbGFiZWw8L2xhYmVsPlxcbiAgICAgICAgICAgICAgICAgICAgPGlucHV0IHR5cGU9XFxcInRleHRcXFwiIGNsYXNzPVxcXCJmb3JtLWNvbnRyb2xcXFwiIGRhdGEtYmluZD1cXFwidmFsdWU6IGJ1aWxkRXhwbG9yZXIuZ3JhcGhEYXRhSGVhZGVyXFxcIj5cXG4gICAgICAgICAgICAgICAgPC9kaXY+XFxuICAgICAgICAgICAgICAgIDxkaXYgY2xhc3M9XFxcImZvcm0tZ3JvdXBcXFwiPlxcbiAgICAgICAgICAgICAgICAgICAgPGxhYmVsPkRhdGEgc2V0IGRlc2NyaXB0aW9uPC9sYWJlbD5cXG4gICAgICAgICAgICAgICAgICAgIDxpbnB1dCB0eXBlPVxcXCJ0ZXh0XFxcIiBjbGFzcz1cXFwiZm9ybS1jb250cm9sXFxcIiBkYXRhLWJpbmQ9XFxcInZhbHVlOiBidWlsZEV4cGxvcmVyLmdyYXBoRGF0YURlc2NyaXB0aW9uXFxcIj5cXG4gICAgICAgICAgICAgICAgPC9kaXY+XFxuICAgICAgICAgICAgICAgIDxkaXYgY2xhc3M9XFxcImZvcm0tZ3JvdXBcXFwiPlxcbiAgICAgICAgICAgICAgICAgICAgPGJ1dHRvbiBjbGFzcz1cXFwiYnRuIGJ0bi1kZWZhdWx0XFxcIiBkYXRhLWJpbmQ9XFxcImNsaWNrOiBidWlsZEV4cGxvcmVyLmdyYXBoXFxcIj5BZGQgZGF0YSBzZXQ8L2J1dHRvbj5cXG4gICAgICAgICAgICAgICAgPC9kaXY+XFxuICAgICAgICAgICAgICAgIDxkaXYgY2xhc3M9XFxcImZvcm0tZ3JvdXBcXFwiPlxcbiAgICAgICAgICAgICAgICAgICAgPGxhYmVsPkhlcm8gUHJvcGVydHk8L2xhYmVsPlxcbiAgICAgICAgICAgICAgICAgICAgPHNlbGVjdCBjbGFzcz1cXFwiZm9ybS1jb250cm9sXFxcIiBkYXRhLWJpbmQ9XFxcIm9wdGlvbnM6IGJ1aWxkRXhwbG9yZXIuZ3JhcGhQcm9wZXJ0aWVzLCBvcHRpb25zVGV4dDogJ2xhYmVsJywgb3B0aW9uc1ZhbHVlOiAnaWQnLCB2YWx1ZTogYnVpbGRFeHBsb3Jlci5zZWxlY3RlZEdyYXBoUHJvcGVydHlcXFwiPjwvc2VsZWN0PlxcbiAgICAgICAgICAgICAgICA8L2Rpdj5cXG4gICAgICAgICAgICAgICAgPCEtLSBrbyBpZjogYnVpbGRFeHBsb3Jlci5ncmFwaERhdGEoKS5sZW5ndGggPiAwIC0tPlxcbiAgICAgICAgICAgICAgICA8ZGl2IGNsYXNzPVxcXCJmb3JtLWdyb3VwXFxcIiBkYXRhLWJpbmQ9XFxcImNoYXJ0OiBidWlsZEV4cGxvcmVyLmdyYXBoQ2hhcnREYXRhLCBjaGFydFR5cGU6ICdTY2F0dGVyJywgY2hhcnRPcHRpb25zOiBidWlsZEV4cGxvcmVyLmdyYXBoQ2hhcnRPcHRpb25zKCksIGNoYXJ0Q29udGV4dDogYnVpbGRFeHBsb3Jlci5ncmFwaENoYXJ0Q29udGV4dFxcXCI+PC9kaXY+XFxuICAgICAgICAgICAgICAgIDxkaXYgY2xhc3M9XFxcImZvcm0tZ3JvdXBcXFwiPlxcbiAgICAgICAgICAgICAgICAgIDxidXR0b24gY2xhc3M9XFxcImJ0biBidG4tZGVmYXVsdFxcXCIgZGF0YS1iaW5kPVxcXCJjbGljazogYnVpbGRFeHBsb3Jlci5leHBvcnRJbWFnZVxcXCI+PHNwYW4gY2xhc3M9XFxcImdseXBoaWNvbiBnbHlwaGljb24tZXhwb3J0XFxcIj48L3NwYW4+IEV4cG9ydCBJbWFnZTwvYnV0dG9uPlxcbiAgICAgICAgICAgICAgICA8L2Rpdj5cXG4gICAgICAgICAgICAgICAgPGJ1dHRvbiBjbGFzcz1cXFwiYnRuIGJ0bi1kZWZhdWx0IGJ0bi14c1xcXCIgZGF0YS1iaW5kPVxcXCJ0b2dnbGU6IGJ1aWxkRXhwbG9yZXIuc2hvd0dyYXBoSXRlbUJ1aWxkUm93cywgY3NzOiB7J3RvZ2dsZWQnOiBidWlsZEV4cGxvcmVyLnNob3dHcmFwaEl0ZW1CdWlsZFJvd3N9XFxcIj5TaG93IGl0ZW0gYnVpbGQgcm93czwvYnV0dG9uPlxcbiAgICAgICAgICAgICAgICA8YnV0dG9uIGNsYXNzPVxcXCJidG4gYnRuLWRlZmF1bHQgYnRuLXhzXFxcIiBkYXRhLWJpbmQ9XFxcInRvZ2dsZTogYnVpbGRFeHBsb3Jlci5zaG93R3JhcGhTa2lsbEJ1aWxkQ29sdW1ucywgY3NzOiB7J3RvZ2dsZWQnOiBidWlsZEV4cGxvcmVyLnNob3dHcmFwaFNraWxsQnVpbGRDb2x1bW5zfVxcXCI+U2hvdyBza2lsbCBidWlsZCBjb2x1bW5zPC9idXR0b24+XFxuICAgICAgICAgICAgICAgIDx0YWJsZSBjbGFzcz1cXFwidGFibGUgYnVpbGQtdGFibGVcXFwiPlxcbiAgICAgICAgICAgICAgICAgICAgPHRoZWFkPlxcbiAgICAgICAgICAgICAgICAgICAgICAgIDx0cj5cXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgPHRoIGNsYXNzPVxcXCJyaWdodC1ib3JkZXJcXFwiPkxldmVsPC90aD5cXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgPCEtLSBrbyBmb3JlYWNoOiBidWlsZEV4cGxvcmVyLmdyYXBoRGF0YSAtLT5cXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgPHRoIGNsYXNzPVxcXCJ0ZXh0LWNlbnRlclxcXCIgZGF0YS1iaW5kPVxcXCJjc3M6IHsgJ3JpZ2h0LWJvcmRlcic6ICEkcGFyZW50LmJ1aWxkRXhwbG9yZXIuc2hvd0dyYXBoU2tpbGxCdWlsZENvbHVtbnMoKSB8fCAhJGRhdGEudmlzaWJsZSgpIH1cXFwiPlxcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgPHNwYW4gZGF0YS1iaW5kPVxcXCJjc3M6IHsgJ3Rvb2x0aXAtdW5kZXJsaW5lJzogJGRhdGEuZGVzY3JpcHRpb24gfSwgdG9vbHRpcDoge3RpdGxlOiAkZGF0YS5kZXNjcmlwdGlvbiwgcGxhY2VtZW50OiAnYm90dG9tJ30sIHZpc2libGU6ICRkYXRhLnZpc2libGUoKSwgdGV4dDogJGRhdGEuaGVhZGVyLCBzdHlsZTogeyBjb2xvcjogJHBhcmVudC5idWlsZEV4cGxvcmVyLmdyYXBoRGlzdGluY3RDb2xvcigkcGFyZW50LmJ1aWxkRXhwbG9yZXIuZ3JhcGhEYXRhKCkubGVuZ3RoLCAkaW5kZXgoKSwgMSkgfVxcXCI+PC9zcGFuPlxcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgPHNwYW4gY2xhc3M9XFxcImJ0biBidG4teHMgZ2x5cGhpY29uIGdseXBoaWNvbi1pbmZvLXNpZ25cXFwiIGRhdGEtYmluZD1cXFwidmlzaWJsZTogJGRhdGEudmlzaWJsZSgpLCBwb3BvdmVyOiB7dGVtcGxhdGU6ICdwb3BvdmVyLWdyYXBoRGF0YS10ZW1wbGF0ZScsIGRhdGE6ICRkYXRhLCBvcHRpb25zOiB7fSB9XFxcIj48L3NwYW4+XFxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICA8YnV0dG9uIGNsYXNzPVxcXCJidG4gYnRuLWRlZmF1bHQgYnRuLXhzIHNob3AtYnV0dG9uIGdseXBoaWNvbiBnbHlwaGljb24tcmVtb3ZlIHB1bGwtcmlnaHRcXFwiIGNsYXNzPVxcXCJjbG9zZVxcXCIgZGF0YS1iaW5kPVxcXCJ2aXNpYmxlOiAhJHBhcmVudC5idWlsZEV4cGxvcmVyLnNob3dHcmFwaFNraWxsQnVpbGRDb2x1bW5zKCkgfHwgISRkYXRhLnZpc2libGUoKSwgY2xpY2s6IGZ1bmN0aW9uKGRhdGEsIGV2ZW50KSB7ICRwYXJlbnQuYnVpbGRFeHBsb3Jlci5yZW1vdmVHcmFwaERhdGFTZXQoJGRhdGEpOyB9XFxcIj48L2J1dHRvbj5cXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIDxidXR0b24gY2xhc3M9XFxcImJ0biBidG4tZGVmYXVsdCBidG4teHMgc2hvcC1idXR0b24gZ2x5cGhpY29uIHB1bGwtcmlnaHRcXFwiIGRhdGEtYmluZD1cXFwidmlzaWJsZTogISRwYXJlbnQuYnVpbGRFeHBsb3Jlci5zaG93R3JhcGhTa2lsbEJ1aWxkQ29sdW1ucygpIHx8ICEkZGF0YS52aXNpYmxlKCksIHRvZ2dsZTogJGRhdGEudmlzaWJsZSwgY3NzOiB7ICdnbHlwaGljb24tbWludXMnOiAkZGF0YS52aXNpYmxlKCksICdnbHlwaGljb24tcGx1cyc6ICEkZGF0YS52aXNpYmxlKCl9XFxcIj48L2J1dHRvbj5cXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgPC90aD5cXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgPHRoIGNsYXNzPVxcXCJ0ZXh0LWxlZnQgcmlnaHQtYm9yZGVyXFxcIiBkYXRhLWJpbmQ9XFxcInZpc2libGU6ICRkYXRhLnZpc2libGUoKSAmJiAkcGFyZW50LmJ1aWxkRXhwbG9yZXIuc2hvd0dyYXBoU2tpbGxCdWlsZENvbHVtbnMoKVxcXCI+PGFiYnIgdGl0bGU9XFxcIlEtVy1FLVItU3RhdHNcXFwiPlNraWxsIEJ1aWxkPC9hYmJyPlxcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgPGJ1dHRvbiBjbGFzcz1cXFwiYnRuIGJ0bi1kZWZhdWx0IGJ0bi14cyBzaG9wLWJ1dHRvbiBnbHlwaGljb24gZ2x5cGhpY29uLXJlbW92ZSBwdWxsLXJpZ2h0XFxcIiBjbGFzcz1cXFwiY2xvc2VcXFwiIGRhdGEtYmluZD1cXFwidmlzaWJsZTogJHBhcmVudC5idWlsZEV4cGxvcmVyLnNob3dHcmFwaFNraWxsQnVpbGRDb2x1bW5zKCksIGNsaWNrOiBmdW5jdGlvbihkYXRhLCBldmVudCkgeyAkcGFyZW50LmJ1aWxkRXhwbG9yZXIucmVtb3ZlR3JhcGhEYXRhU2V0KCRkYXRhKTsgfVxcXCI+PC9idXR0b24+XFxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICA8YnV0dG9uIGNsYXNzPVxcXCJidG4gYnRuLWRlZmF1bHQgYnRuLXhzIHNob3AtYnV0dG9uIGdseXBoaWNvbiBwdWxsLXJpZ2h0XFxcIiBkYXRhLWJpbmQ9XFxcInZpc2libGU6ICRwYXJlbnQuYnVpbGRFeHBsb3Jlci5zaG93R3JhcGhTa2lsbEJ1aWxkQ29sdW1ucygpLCB0b2dnbGU6ICRkYXRhLnZpc2libGUsIGNzczogeyAnZ2x5cGhpY29uLW1pbnVzJzogJGRhdGEudmlzaWJsZSgpLCAnZ2x5cGhpY29uLXBsdXMnOiAhJGRhdGEudmlzaWJsZSgpfVxcXCI+PC9idXR0b24+XFxuICAgICAgICAgICAgICAgICAgICAgICAgICAgIDwvdGg+XFxuICAgICAgICAgICAgICAgICAgICAgICAgICAgIDwhLS0gL2tvIC0tPlxcbiAgICAgICAgICAgICAgICAgICAgICAgIDwvdHI+XFxuICAgICAgICAgICAgICAgICAgICA8L3RoZWFkPlxcbiAgICAgICAgICAgICAgICAgICAgPHRib2R5IGRhdGEtYmluZD1cXFwiZm9yZWFjaDogbmV3IEFycmF5KGJ1aWxkRXhwbG9yZXIuZ3JhcGhEYXRhKClbMF0uZGF0YS5sZW5ndGgpXFxcIj5cXG4gICAgICAgICAgICAgICAgICAgICAgICA8dHI+XFxuICAgICAgICAgICAgICAgICAgICAgICAgICAgIDx0ZCBjbGFzcz1cXFwicmlnaHQtYm9yZGVyXFxcIj5cXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIDxzdHJvbmcgZGF0YS1iaW5kPVxcXCJ0ZXh0OiAoJGluZGV4KCkgKyAxKVxcXCI+PC9zdHJvbmc+XFxuICAgICAgICAgICAgICAgICAgICAgICAgICAgIDwvdGQ+XFxuICAgICAgICAgICAgICAgICAgICAgICAgICAgIDwhLS0ga28gZm9yZWFjaDogbmV3IEFycmF5KCRwYXJlbnQuYnVpbGRFeHBsb3Jlci5ncmFwaERhdGEoKS5sZW5ndGgpIC0tPlxcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICA8dGQgY2xhc3M9XFxcInRleHQtcmlnaHRcXFwiIGRhdGEtYmluZD1cXFwiY3NzOiB7ICdyaWdodC1ib3JkZXInOiAhJHBhcmVudHNbMV0uYnVpbGRFeHBsb3Jlci5zaG93R3JhcGhTa2lsbEJ1aWxkQ29sdW1ucygpIHx8ICEkcGFyZW50c1sxXS5idWlsZEV4cGxvcmVyLmdyYXBoRGF0YSgpWyRpbmRleCgpXS52aXNpYmxlKCkgfVxcXCI+XFxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICA8c3BhbiBkYXRhLWJpbmQ9XFxcInZpc2libGU6ICRwYXJlbnRzWzFdLmJ1aWxkRXhwbG9yZXIuZ3JhcGhEYXRhKClbJGluZGV4KCldLnZpc2libGUoKSwgdGV4dDogJHBhcmVudHNbMV0uYnVpbGRFeHBsb3Jlci5ncmFwaERhdGEoKVskaW5kZXgoKV0uZGF0YVskcGFyZW50Q29udGV4dC4kaW5kZXgoKV1bJHBhcmVudHNbMV0uYnVpbGRFeHBsb3Jlci5zZWxlY3RlZEdyYXBoUHJvcGVydHkoKV1cXFwiPjwvc3Bhbj5cXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgPC90ZD5cXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgPHRkIGNsYXNzPVxcXCJ0ZXh0LWxlZnQgcmlnaHQtYm9yZGVyXFxcIiBkYXRhLWJpbmQ9XFxcInZpc2libGU6ICRwYXJlbnRzWzFdLmJ1aWxkRXhwbG9yZXIuZ3JhcGhEYXRhKClbJGluZGV4KCldLnZpc2libGUoKSAmJiAkcGFyZW50c1sxXS5idWlsZEV4cGxvcmVyLnNob3dHcmFwaFNraWxsQnVpbGRDb2x1bW5zKCksIHRleHQ6ICRwYXJlbnRzWzFdLmJ1aWxkRXhwbG9yZXIuZ3JhcGhEYXRhKClbJGluZGV4KCldLmN1bXVsYXRpdmVTa2lsbEJ1aWxkWyRwYXJlbnRDb250ZXh0LiRpbmRleCgpXS5qb2luKCctJylcXFwiPjwvdGQ+XFxuICAgICAgICAgICAgICAgICAgICAgICAgICAgIDwhLS0gL2tvIC0tPlxcbiAgICAgICAgICAgICAgICAgICAgICAgIDwvdHI+XFxuICAgICAgICAgICAgICAgICAgICAgICAgPHRyIGNsYXNzPVxcXCJpdGVtQnVpbGQtaW52ZW50b3J5XFxcIiBkYXRhLWJpbmQ9XFxcInZpc2libGU6ICRwYXJlbnQuYnVpbGRFeHBsb3Jlci5zaG93R3JhcGhJdGVtQnVpbGRSb3dzKCkgJiYgJHBhcmVudC5idWlsZEV4cGxvcmVyLmdyYXBoUm93SGFzSXRlbXMoJGluZGV4KCkpXFxcIj5cXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgPHRkIGNsYXNzPVxcXCJyaWdodC1ib3JkZXItaXRlbXJvdyBuby10b3AtYm9yZGVyXFxcIj48L3RkPlxcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICA8IS0tIGtvIGZvcmVhY2g6IG5ldyBBcnJheSgkcGFyZW50LmJ1aWxkRXhwbG9yZXIuZ3JhcGhEYXRhKCkubGVuZ3RoKSAtLT5cXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgPHRkIGNsYXNzPVxcXCJyaWdodC1ib3JkZXItaXRlbXJvdyBuby10b3AtYm9yZGVyXFxcIiBkYXRhLWJpbmQ9XFxcImF0dHI6IHsgY29sc3BhbjogJHBhcmVudHNbMV0uYnVpbGRFeHBsb3Jlci5ncmFwaERhdGEoKVskaW5kZXgoKV0udmlzaWJsZSgpICYmICRwYXJlbnRzWzFdLmJ1aWxkRXhwbG9yZXIuc2hvd0dyYXBoU2tpbGxCdWlsZENvbHVtbnMoKSA/IDIgOiAxIH1cXFwiPlxcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgPGRpdiBkYXRhLWJpbmQ9XFxcInZpc2libGU6ICRwYXJlbnRzWzFdLmJ1aWxkRXhwbG9yZXIuZ3JhcGhEYXRhKClbJGluZGV4KCldLnZpc2libGUoKSwgZm9yZWFjaDogJHBhcmVudHNbMV0uYnVpbGRFeHBsb3Jlci5ncmFwaERhdGEoKVskaW5kZXgoKV0uZGF0YVskcGFyZW50Q29udGV4dC4kaW5kZXgoKV0uaXRlbXNcXFwiPlxcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIDxpbWcgY2xhc3M9XFxcIml0ZW1CdWlsZC1pbWctc20gaW1nLXJvdW5kZWRcXFwiIGRhdGEtYmluZD1cXFwiY3NzOiB7IGl0ZW1fZGlzYWJsZWQ6ICFlbmFibGVkLCBpdGVtX2FjdGl2ZTogJHBhcmVudHNbMl0uaW52ZW50b3J5LmdldEFjdGl2ZUJvcmRlcigkZGF0YSkgPT0gMSwgaXRlbV9pbmFjdGl2ZTogJHBhcmVudHNbMl0uaW52ZW50b3J5LmdldEFjdGl2ZUJvcmRlcigkZGF0YSkgPT0gMCB9LCBhdHRyOnsgc3JjOiAkcGFyZW50c1syXS5pbnZlbnRvcnkuZ2V0SXRlbUltYWdlKCRkYXRhKSB9XFxcIi8+XFxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgPGRpdiBzdHlsZT1cXFwiZmxvYXQ6bGVmdFxcXCIgZGF0YS1iaW5kPVxcXCJ2aXNpYmxlOiAkcGFyZW50c1syXS5pbnZlbnRvcnkuZ2V0SXRlbVNpemVMYWJlbCgkZGF0YSkgIT0gJydcXFwiPlxcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICA8ZGl2IGRhdGEtYmluZD1cXFwiaHRtbDogJHBhcmVudHNbMl0uaW52ZW50b3J5LmdldEl0ZW1TaXplTGFiZWwoJGRhdGEpXFxcIiBzdHlsZT1cXFwicG9zaXRpb246YWJzb2x1dGU7bGVmdDowO2JvdHRvbTowO2NvbG9yOndoaXRlO29wYWNpdHk6LjU7YmFja2dyb3VuZC1jb2xvcjpibGFjaztwYWRkaW5nOjBweCAycHhcXFwiPjwvZGl2PlxcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICA8ZGl2IGRhdGEtYmluZD1cXFwiaHRtbDogJHBhcmVudHNbMl0uaW52ZW50b3J5LmdldEl0ZW1TaXplTGFiZWwoJGRhdGEpXFxcIiBzdHlsZT1cXFwicG9zaXRpb246YWJzb2x1dGU7bGVmdDowO2JvdHRvbTowO2NvbG9yOndoaXRlO3BhZGRpbmc6MHB4IDJweFxcXCI+PC9kaXY+XFxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgPC9kaXY+XFxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICA8L2Rpdj5cXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgPC90ZD5cXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgPCEtLSAva28gLS0+XFxuICAgICAgICAgICAgICAgICAgICAgICAgPC90cj5cXG4gICAgICAgICAgICAgICAgICAgIDwvdGJvZHk+XFxuICAgICAgICAgICAgICAgIDwvdGFibGU+XFxuICAgICAgICAgICAgICAgIDwhLS0gL2tvIC0tPlxcbiAgICAgICAgICAgIDwvZGl2PlxcbiAgICAgICAgPC9kaXY+XFxuICAgIDwvZGl2PlxcblxcbjwvZGl2PlwiIH0pO1xua28uY29tcG9uZW50cy5yZWdpc3RlcigndW5pdC1wYW5lJywgeyB0ZW1wbGF0ZTogXCI8ZGl2IGNsYXNzPVxcXCJyb3dcXFwiPlxcbiAgICA8ZGl2IGNsYXNzPVxcXCJjb2wtbWQtNFxcXCI+XFxuICAgICAgICA8aW1nIGNsYXNzPVxcXCJpbWctcm91bmRlZFxcXCIgZGF0YS1iaW5kPVxcXCJhdHRyOntzcmM6IHNlbGVjdGVkVW5pdCgpLmltYWdlfVxcXCIvPlxcbiAgICA8L2Rpdj5cXG4gICAgPGRpdiBjbGFzcz1cXFwiY29sLW1kLTRcXFwiPlxcbiAgICAgICAgPGxhYmVsIGZvcj1cXFwidW5pdHNlbGVjdFxcXCI+VW5pdDwvbGFiZWw+XFxuICAgICAgICA8c2VsZWN0IGlkPVxcXCJ1bml0c2VsZWN0XFxcIiBjbGFzcz1cXFwiZm9ybS1jb250cm9sXFxcIiBkYXRhLWJpbmQ9XFxcIm9wdGlvbnM6IGF2YWlsYWJsZVVuaXRzICwgb3B0aW9uc1RleHQ6ICdoZXJvRGlzcGxheU5hbWUnLCB2YWx1ZTogc2VsZWN0ZWRVbml0XFxcIj48L3NlbGVjdD5cXG4gICAgPC9kaXY+XFxuICAgIDxkaXYgY2xhc3M9XFxcImNvbC1tZC00XFxcIj5cXG4gICAgICAgIDxsYWJlbCBmb3I9XFxcInVuaXRsZXZlbFxcXCI+TGV2ZWw8L2xhYmVsPlxcbiAgICAgICAgPHAgY2xhc3M9XFxcImZvcm0tY29udHJvbC1zdGF0aWNcXFwiIGRhdGEtYmluZD1cXFwidmlzaWJsZTogc2VsZWN0ZWRVbml0KCkubGV2ZWxzID09IDAsIHRleHQ6IGhlcm9EYXRhKCkubGV2ZWxcXFwiPjwvcD5cXG4gICAgICAgIDxzZWxlY3QgaWQ9XFxcImhlcm9sZXZlbFxcXCIgY2xhc3M9XFxcImZvcm0tY29udHJvbFxcXCIgZGF0YS1iaW5kPVxcXCJ2aXNpYmxlOiBzZWxlY3RlZFVuaXQoKS5sZXZlbHMgPiAwLCB2YWx1ZTogc2VsZWN0ZWRVbml0TGV2ZWwsIGZvcmVhY2g6IG5ldyBBcnJheShzZWxlY3RlZFVuaXQoKS5sZXZlbHMpXFxcIj5cXG4gICAgICAgICAgICA8b3B0aW9uIGRhdGEtYmluZD1cXFwidGV4dDogJGluZGV4KCkrMVxcXCI+PC9vcHRpb24+XFxuICAgICAgICA8L3NlbGVjdD5cXG4gICAgPC9kaXY+XFxuPC9kaXY+XFxuXFxuPGRpdiBjbGFzcz1cXFwicm93XFxcIj5cXG4gICAgPGRpdiBjbGFzcz1cXFwiY29sLW1kLTRcXFwiIGRhdGEtYmluZD1cXFwiY3NzOiB7J2NvbC1tZC00JzogJHJvb3QubGF5b3V0KCkgPT0gMCwgJ2NvbC1tZC0xMic6ICRyb290LmxheW91dCgpID09IDF9XFxcIj5cXG4gICAgICAgIDxkaXYgY2xhc3M9XFxcInJvd1xcXCI+XFxuICAgICAgICAgICAgPGgzIGNsYXNzPVxcXCJjb2wtbWQtMTJcXFwiPlN0YXRzIDxhIGNsYXNzPVxcXCJidG4gYnRuLWRlZmF1bHQgYnRuLXhzXFxcIiBkYXRhLWJpbmQ9XFxcInRvZ2dsZTogc2hvd1N0YXREZXRhaWxzLCB0ZXh0OiAhc2hvd1N0YXREZXRhaWxzKCkgPyAnU2hvdyBtb3JlJyA6ICdTaG93IGxlc3MnLCBhdHRyOiB7dGl0bGU6ICFzaG93U3RhdERldGFpbHMoKSA/ICdDbGljayB0byBzaG93IGJhc2Ugc3RhdHMnIDogJ0NsaWNrIHRvIGhpZGUgYmFzZSBzdGF0cyd9XFxcIj48L2E+PC9oMz5cXG5cXG4gICAgICAgICAgICA8ZGl2IGNsYXNzPVxcXCJjb2wtbWQtM1xcXCIgZGF0YS1iaW5kPVxcXCJ2aXNpYmxlOiBzaG93U3RhdERldGFpbHMoKSwgY29tcG9uZW50OiB7bmFtZTogJ3N0YXRzLWFkZGl0aW9uYWwnLCBwYXJhbXM6ICRkYXRhfVxcXCI+PC9kaXY+XFxuICAgICAgICAgICAgXFxuICAgICAgICAgICAgPGRpdiBjbGFzcz1cXFwiY29sLW1kLTEyXFxcIiBkYXRhLWJpbmQ9XFxcImNzczogeydjb2wtbWQtMTInOiAkcm9vdC5sYXlvdXQoKSA9PSAwLCAnY29sLW1kLTMnOiAkcm9vdC5sYXlvdXQoKSA9PSAxfVxcXCI+XFxuICAgICAgICAgICAgICAgIDx0YWJsZSBjbGFzcz1cXFwidGFibGUgdGFibGUtY29uZGVuc2VkXFxcIj5cXG4gICAgICAgICAgICAgICAgPHRib2R5PlxcbiAgICAgICAgICAgICAgICA8dHI+PHRkPkdvbGQ6PC90ZD48dGQgY2xhc3M9XFxcInRleHQtcmlnaHRcXFwiPjxzcGFuIGRhdGEtYmluZD1cXFwidGV4dDogaGVyb0RhdGEoKS5ib3VudHlnb2xkbWluID09IGhlcm9EYXRhKCkuYm91bnR5Z29sZG1heCA/IGhlcm9EYXRhKCkuYm91bnR5Z29sZG1heCA6IGhlcm9EYXRhKCkuYm91bnR5Z29sZG1pbiArICctJyArIGhlcm9EYXRhKCkuYm91bnR5Z29sZG1heFxcXCI+PC9zcGFuPjwvdGQ+PC90cj5cXG4gICAgICAgICAgICAgICAgPHRyPjx0ZD5FeHBlcmllbmNlOjwvdGQ+PHRkIGNsYXNzPVxcXCJ0ZXh0LXJpZ2h0XFxcIj48c3BhbiBkYXRhLWJpbmQ9XFxcInRleHQ6IGhlcm9EYXRhKCkuYm91bnR5eHBcXFwiPjwvc3Bhbj48L3RkPjwvdHI+XFxuICAgICAgICAgICAgICAgIDx0cj48dGQ+TGV2ZWw6PC90ZD48dGQgY2xhc3M9XFxcInRleHQtcmlnaHRcXFwiPjxzcGFuIGRhdGEtYmluZD1cXFwidGV4dDogaGVyb0RhdGEoKS5sZXZlbFxcXCI+PC9zcGFuPjwvdGQ+PC90cj5cXG4gICAgICAgICAgICAgICAgPHRyPjx0ZD48YWJiciB0aXRsZT1cXFwiTW92ZW1lbnQgU3BlZWRcXFwiPk1TPC9hYmJyPjo8L3RkPjx0ZCBjbGFzcz1cXFwidGV4dC1yaWdodFxcXCI+PHNwYW4gZGF0YS1iaW5kPVxcXCJ0ZXh0OiB0b3RhbE1vdmVtZW50U3BlZWRcXFwiPjwvc3Bhbj48L3RkPjwvdHI+XFxuICAgICAgICAgICAgICAgIDx0cj48dGQ+VHVybiBSYXRlOjwvdGQ+PHRkIGNsYXNzPVxcXCJ0ZXh0LXJpZ2h0XFxcIj48c3BhbiBkYXRhLWJpbmQ9XFxcInRleHQ6IHRvdGFsVHVyblJhdGVcXFwiPjwvc3Bhbj48L3RkPjwvdHI+XFxuICAgICAgICAgICAgICAgIDx0cj48dGQ+U2lnaHQgUmFuZ2U6PC90ZD48dGQgY2xhc3M9XFxcInRleHQtcmlnaHRcXFwiPjxzcGFuIGRhdGEtYmluZD1cXFwiaHRtbDogJzxhYmJyIHRpdGxlPVxcXFwnRGF5XFxcXCc+JyArIHZpc2lvbnJhbmdlZGF5KCkgKyAnPC9hYmJyPi88YWJiciB0aXRsZT1cXFxcJ05pZ2h0XFxcXCc+JyArIHZpc2lvbnJhbmdlbmlnaHQoKSArICc8L2FiYnI+J1xcXCI+PC9zcGFuPjwvdGQ+PC90cj5cXG4gICAgICAgICAgICAgICAgPC90Ym9keT5cXG4gICAgICAgICAgICAgICAgPC90YWJsZT5cXG4gICAgICAgICAgICA8L2Rpdj5cXG5cXG5cXG4gICAgICAgICAgICA8ZGl2IGNsYXNzPVxcXCJjb2wtbWQtMTJcXFwiIGRhdGEtYmluZD1cXFwiY3NzOiB7J2NvbC1tZC0xMic6ICRyb290LmxheW91dCgpID09IDAsICdjb2wtbWQtMyc6ICRyb290LmxheW91dCgpID09IDF9XFxcIj5cXG4gICAgICAgICAgICAgICAgPHRhYmxlIGNsYXNzPVxcXCJ0YWJsZSB0YWJsZS1jb25kZW5zZWRcXFwiPlxcbiAgICAgICAgICAgICAgICA8dGJvZHk+XFxuICAgICAgICAgICAgICAgIDx0cj48dGQ+SGVhbHRoOjwvdGQ+PHRkIGNsYXNzPVxcXCJ0ZXh0LXJpZ2h0XFxcIj48c3BhbiBkYXRhLWJpbmQ9XFxcInRleHQ6IGhlYWx0aFxcXCI+PC9zcGFuPjwvdGQ+PC90cj5cXG4gICAgICAgICAgICAgICAgPHRyPjx0ZD5IZWFsdGggUmVnZW46PC90ZD48dGQgY2xhc3M9XFxcInRleHQtcmlnaHRcXFwiPjxzcGFuIGRhdGEtYmluZD1cXFwidGV4dDogaGVhbHRocmVnZW5cXFwiPjwvc3Bhbj48L3RkPjwvdHI+XFxuICAgICAgICAgICAgICAgIDx0cj48dGQ+TWFuYTo8L3RkPjx0ZCBjbGFzcz1cXFwidGV4dC1yaWdodFxcXCI+PHNwYW4gZGF0YS1iaW5kPVxcXCJ0ZXh0OiBtYW5hXFxcIj48L3NwYW4+PC90ZD48L3RyPlxcbiAgICAgICAgICAgICAgICA8dHI+PHRkPk1hbmEgUmVnZW46PC90ZD48dGQgY2xhc3M9XFxcInRleHQtcmlnaHRcXFwiPjxzcGFuIGRhdGEtYmluZD1cXFwidGV4dDogbWFuYXJlZ2VuXFxcIj48L3NwYW4+PC90ZD48L3RyPlxcbiAgICAgICAgICAgICAgICA8dHI+PHRkPlBoeXNpY2FsIDxhYmJyIHRpdGxlPVxcXCJFZmZlY3RpdmUgSGl0IFBvaW50c1xcXCI+RUhQPC9hYmJyPjo8L3RkPjx0ZCBjbGFzcz1cXFwidGV4dC1yaWdodFxcXCI+PHNwYW4gZGF0YS1iaW5kPVxcXCJ0ZXh0OiBlaHBQaHlzaWNhbFxcXCI+PC9zcGFuPjwvdGQ+PC90cj5cXG4gICAgICAgICAgICAgICAgPHRyPjx0ZD5NYWdpY2FsIDxhYmJyIHRpdGxlPVxcXCJFZmZlY3RpdmUgSGl0IFBvaW50c1xcXCI+RUhQPC9hYmJyPjo8L3RkPjx0ZCBjbGFzcz1cXFwidGV4dC1yaWdodFxcXCI+PHNwYW4gZGF0YS1iaW5kPVxcXCJ0ZXh0OiBlaHBNYWdpY2FsXFxcIj48L3NwYW4+PC90ZD48L3RyPlxcbiAgICAgICAgICAgICAgICA8L3Rib2R5PlxcbiAgICAgICAgICAgICAgICA8L3RhYmxlPlxcbiAgICAgICAgICAgIDwvZGl2PlxcblxcbiAgICAgICAgICAgIDxkaXYgY2xhc3M9XFxcImNvbC1tZC0xMlxcXCIgZGF0YS1iaW5kPVxcXCJjc3M6IHsnY29sLW1kLTEyJzogJHJvb3QubGF5b3V0KCkgPT0gMCwgJ2NvbC1tZC0zJzogJHJvb3QubGF5b3V0KCkgPT0gMX1cXFwiPlxcbiAgICAgICAgICAgICAgICA8dGFibGUgY2xhc3M9XFxcInRhYmxlIHRhYmxlLWNvbmRlbnNlZFxcXCI+XFxuICAgICAgICAgICAgICAgIDx0Ym9keT5cXG4gICAgICAgICAgICAgICAgPHRyPjx0ZD5Bcm1vcjo8L3RkPjx0ZCBjbGFzcz1cXFwidGV4dC1yaWdodFxcXCI+PHNwYW4gZGF0YS1iaW5kPVxcXCJ0ZXh0OiB0b3RhbEFybW9yUGh5c2ljYWxcXFwiPjwvc3Bhbj48L3RkPjwvdHI+XFxuICAgICAgICAgICAgICAgIDx0cj48dGQ+TWFnaWMgUmVzOjwvdGQ+PHRkIGNsYXNzPVxcXCJ0ZXh0LXJpZ2h0XFxcIj48c3BhbiBkYXRhLWJpbmQ9XFxcImh0bWw6IHRvdGFsTWFnaWNSZXNpc3RhbmNlKCkudG9GaXhlZCgyKSArICclJ1xcXCI+PC9zcGFuPjwvdGQ+PC90cj5cXG4gICAgICAgICAgICAgICAgPHRyPjx0ZD5MaWZlc3RlYWw6PC90ZD48dGQgY2xhc3M9XFxcInRleHQtcmlnaHRcXFwiPjxzcGFuIGRhdGEtYmluZD1cXFwidGV4dDogbGlmZXN0ZWFsXFxcIj48L3NwYW4+PC90ZD48L3RyPlxcbiAgICAgICAgICAgICAgICA8dHI+PHRkPkV2YXNpb246PC90ZD48dGQgY2xhc3M9XFxcInRleHQtcmlnaHRcXFwiPjxzcGFuIGRhdGEtYmluZD1cXFwidGV4dDogZXZhc2lvblxcXCI+PC9zcGFuPjwvdGQ+PC90cj5cXG4gICAgICAgICAgICAgICAgPHRyPjx0ZD5CYXNoOjwvdGQ+PHRkIGNsYXNzPVxcXCJ0ZXh0LXJpZ2h0XFxcIj48c3BhbiBkYXRhLWJpbmQ9XFxcInRleHQ6IGJhc2hcXFwiPjwvc3Bhbj48L3RkPjwvdHI+XFxuICAgICAgICAgICAgICAgIDx0cj48dGQ+TWlzcyBDaGFuY2U6PC90ZD48dGQgY2xhc3M9XFxcInRleHQtcmlnaHRcXFwiPjxzcGFuIGRhdGEtYmluZD1cXFwidGV4dDogbWlzc0NoYW5jZVxcXCI+PC9zcGFuPjwvdGQ+PC90cj5cXG4gICAgICAgICAgICAgICAgPC90Ym9keT5cXG4gICAgICAgICAgICAgICAgPHRib2R5IGNsYXNzPVxcXCJ0YWJsZWRyb3Bkb3duXFxcIiBzdHlsZT1cXFwiYm9yZGVyLXRvcDowXFxcIiBkYXRhLWJpbmQ9XFxcInZpc2libGU6IHNob3dDcml0aWNhbFN0cmlrZURldGFpbHMoKSxmb3JlYWNoOiBjcml0SW5mbygpLnNvdXJjZXNcXFwiPlxcbiAgICAgICAgICAgICAgICA8dHI+PHRkIGNvbHNwYW49Mj48c3Ryb25nIGRhdGEtYmluZD1cXFwidGV4dDogJGRhdGEubmFtZVxcXCI+PC9zdHJvbmc+PC90ZD48L3RyPlxcbiAgICAgICAgICAgICAgICA8dHI+PHRkPkNyaXQgQ2hhbmNlOjwvdGQ+PHRkIGNsYXNzPVxcXCJ0ZXh0LXJpZ2h0XFxcIj48c3BhbiBkYXRhLWJpbmQ9XFxcInRleHQ6ICgkZGF0YS50b3RhbGNoYW5jZSAqIDEwMCkudG9GaXhlZCgyKSArICclJ1xcXCI+PC9zcGFuPjwvdGQ+PC90cj5cXG4gICAgICAgICAgICAgICAgPHRyPjx0ZD5Dcml0IE11bHRpcGxpZXI6PC90ZD48dGQgY2xhc3M9XFxcInRleHQtcmlnaHRcXFwiPjxzcGFuIGRhdGEtYmluZD1cXFwidGV4dDogKCRkYXRhLm11bHRpcGxpZXIgKiAxMDApLnRvRml4ZWQoMikgKyAnJSdcXFwiPjwvc3Bhbj48L3RkPjwvdHI+XFxuICAgICAgICAgICAgICAgIDwvdGJvZHk+XFxuICAgICAgICAgICAgICAgIDwvdGFibGU+XFxuICAgICAgICAgICAgPC9kaXY+XFxuXFxuICAgICAgICAgICAgPGRpdiBjbGFzcz1cXFwiY29sLW1kLTEyXFxcIiBkYXRhLWJpbmQ9XFxcImNzczogeydjb2wtbWQtMTInOiAkcm9vdC5sYXlvdXQoKSA9PSAwLCAnY29sLW1kLTMnOiAkcm9vdC5sYXlvdXQoKSA9PSAxfVxcXCI+XFxuICAgICAgICAgICAgICAgIDx0YWJsZSBjbGFzcz1cXFwidGFibGUgdGFibGUtY29uZGVuc2VkXFxcIj5cXG4gICAgICAgICAgICAgICAgPHRib2R5PlxcbiAgICAgICAgICAgICAgICA8dHI+XFxuICAgICAgICAgICAgICAgICAgICA8dGQ+RGFtYWdlOjwvdGQ+XFxuICAgICAgICAgICAgICAgICAgICA8dGQgY2xhc3M9XFxcInRleHQtcmlnaHRcXFwiPlxcbiAgICAgICAgICAgICAgICAgICAgICAgIDxzcGFuIGRhdGEtYmluZD1cXFwiaHRtbDogYmFzZURhbWFnZSgpWzBdICsgJy0nICsgYmFzZURhbWFnZSgpWzFdXFxcIj48L3NwYW4+XFxuICAgICAgICAgICAgICAgICAgICAgICAgPHNwYW4gc3R5bGU9XFxcImNvbG9yOmdyZWVuXFxcIiBkYXRhLWJpbmQ9XFxcInZpc2libGU6IGJvbnVzRGFtYWdlKCkgPiAwLCB0ZXh0OiAnICsgJyArIGJvbnVzRGFtYWdlKClcXFwiPjwvc3Bhbj5cXG4gICAgICAgICAgICAgICAgICAgICAgICA8c3BhbiBzdHlsZT1cXFwiY29sb3I6cmVkXFxcIiBkYXRhLWJpbmQ9XFxcInZpc2libGU6IGJvbnVzRGFtYWdlUmVkdWN0aW9uKCkgIT0gMCwgdGV4dDogJyAtICcgKyBib251c0RhbWFnZVJlZHVjdGlvbigpXFxcIj48L3NwYW4+XFxuICAgICAgICAgICAgICAgICAgICA8L3RkPlxcbiAgICAgICAgICAgICAgICA8L3RyPlxcbiAgICAgICAgICAgICAgICA8dHI+PHRkPjxhYmJyIHRpdGxlPVxcXCJJbmNyZWFzZWQgQXR0YWNrIFNwZWVkXFxcIj5JQVM8L2FiYnI+OjwvdGQ+PHRkIGNsYXNzPVxcXCJ0ZXh0LXJpZ2h0XFxcIj48c3BhbiBkYXRhLWJpbmQ9XFxcInRleHQ6IGlhc1xcXCI+PC9zcGFuPjwvdGQ+PC90cj5cXG4gICAgICAgICAgICAgICAgPHRyPjx0ZD48YWJiciB0aXRsZT1cXFwiQmFzZSBBdHRhY2sgVGltZVxcXCI+QkFUPC9hYmJyPjo8L3RkPjx0ZCBjbGFzcz1cXFwidGV4dC1yaWdodFxcXCI+PHNwYW4gZGF0YS1iaW5kPVxcXCJ0ZXh0OiBiYXRcXFwiPjwvc3Bhbj48L3RkPjwvdHI+XFxuICAgICAgICAgICAgICAgIDx0cj48dGQ+QXR0YWNrIFRpbWU6PC90ZD48dGQgY2xhc3M9XFxcInRleHQtcmlnaHRcXFwiPjxzcGFuIGRhdGEtYmluZD1cXFwidGV4dDogYXR0YWNrVGltZVxcXCI+PC9zcGFuPjwvdGQ+PC90cj5cXG4gICAgICAgICAgICAgICAgPHRyPjx0ZD5BdHRhY2sgLyBTZWM6PC90ZD48dGQgY2xhc3M9XFxcInRleHQtcmlnaHRcXFwiPjxzcGFuIGRhdGEtYmluZD1cXFwidGV4dDogYXR0YWNrc1BlclNlY29uZCgpLnRvRml4ZWQoMilcXFwiPjwvc3Bhbj48L3RkPjwvdHI+XFxuICAgICAgICAgICAgICAgIDx0cj48dGQ+QXR0YWNrIFJhbmdlOjwvdGQ+PHRkIGNsYXNzPVxcXCJ0ZXh0LXJpZ2h0XFxcIj48c3BhbiBkYXRhLWJpbmQ9XFxcInRleHQ6IHRvdGFsYXR0YWNrcmFuZ2VcXFwiPjwvc3Bhbj48L3RkPjwvdHI+XFxuICAgICAgICAgICAgICAgIDwvdGJvZHk+XFxuICAgICAgICAgICAgICAgIDwvdGFibGU+XFxuICAgICAgICAgICAgPC9kaXY+XFxuICAgICAgICA8L2Rpdj5cXG4gICAgPC9kaXY+XFxuICAgIDxkaXYgY2xhc3M9XFxcImNvbC1tZC04XFxcIiBkYXRhLWJpbmQ9XFxcImNzczogeydjb2wtbWQtOCc6ICRyb290LmxheW91dCgpID09IDAsICdjb2wtbWQtMTInOiAkcm9vdC5sYXlvdXQoKSA9PSAxfVxcXCI+XFxuICAgICAgICA8ZGl2IGRhdGEtYmluZD1cXFwiY29tcG9uZW50OiB7IG5hbWU6ICdkYW1hZ2UtZGV0YWlscycsIHBhcmFtczogJGRhdGF9XFxcIj48L2Rpdj5cXG4gICAgICAgIFxcbiAgICAgICAgPGRpdiBjbGFzcz1cXFwicm93XFxcIj5cXG4gICAgICAgICAgICA8ZGl2IGNsYXNzPVxcXCJjb2wtbWQtMTJcXFwiPlxcbiAgICAgICAgICAgICAgICA8aDMgY2xhc3M9XFxcInNlY3Rpb25faGVhZGVyXFxcIiBkYXRhLWJpbmQ9XFxcInRvZ2dsZTogc2VjdGlvbkRpc3BsYXkoKS5pbnZlbnRvcnksIGNzczogeyBzZWN0aW9uX2Rpc2FibGVkOiAhc2VjdGlvbkRpc3BsYXkoKS5pbnZlbnRvcnkoKSB9XFxcIj5JbnZlbnRvcnkgPHNtYWxsIHN0eWxlPVxcXCJjb2xvcjpnb2xkZW5yb2RcXFwiIGRhdGEtYmluZD1cXFwiaHRtbDogaW52ZW50b3J5LnRvdGFsQ29zdCgpID8gJzxpbWcgc3JjPVxcXFwnaHR0cDovL2Nkbi5kb3RhMi5jb20vYXBwcy9kb3RhMi9pbWFnZXMvdG9vbHRpcHMvZ29sZC5wbmdcXFxcJy8+ICcgKyBpbnZlbnRvcnkudG90YWxDb3N0KCkgOiAnJyBcXFwiPjwvc21hbGw+PC9oMz5cXG4gICAgICAgICAgICAgICAgPGRpdiBpZD1cXFwiaW52ZW50b3J5XFxcIiBjbGFzcz1cXFwiaW52ZW50b3J5IGhvdmVyLWN1cnNvclxcXCIgZGF0YS1iaW5kPVxcXCJjbGljazogZnVuY3Rpb24gKGRhdGEsIGV2ZW50KSB7IGJ1aWxkRXhwbG9yZXIuc2VsZWN0SW52ZW50b3J5KC0xKTsgfSwgY3NzOiB7J3Jvdy1oaWdobGlnaHQnOiBzZWxlY3RlZEludmVudG9yeSgpID09IC0xfSwgdGVtcGxhdGU6IHsgbmFtZTogJ2l0ZW0tdGVtcGxhdGUnLCBmb3JlYWNoOiBpbnZlbnRvcnkuaXRlbXMgfSwgdmlzaWJsZTogc2VjdGlvbkRpc3BsYXkoKS5pbnZlbnRvcnkoKVxcXCI+PC9kaXY+XFxuICAgICAgICAgICAgPC9kaXY+XFxuICAgICAgICA8L2Rpdj5cXG4gICAgICAgIFxcbiAgICAgICAgPGRpdiBjbGFzcz1cXFwicm93XFxcIj5cXG4gICAgICAgICAgICA8ZGl2IGNsYXNzPVxcXCJjb2wtbWQtMTJcXFwiPlxcbiAgICAgICAgICAgICAgICA8aDMgY2xhc3M9XFxcInNlY3Rpb25faGVhZGVyXFxcIiBkYXRhLWJpbmQ9XFxcInRvZ2dsZTogc2VjdGlvbkRpc3BsYXkoKS5hYmlsaXR5LCBjc3M6IHsgc2VjdGlvbl9kaXNhYmxlZDogIXNlY3Rpb25EaXNwbGF5KCkuYWJpbGl0eSgpIH1cXFwiPkFiaWxpdGllczwvaDM+XFxuICAgICAgICAgICAgICAgIDxkaXYgY2xhc3M9XFxcInJvd1xcXCIgZGF0YS1iaW5kPVxcXCJ2aXNpYmxlOiBzZWN0aW9uRGlzcGxheSgpLmFiaWxpdHkoKSwgZm9yZWFjaDogYWJpbGl0eSgpLmFiaWxpdGllcygpXFxcIj5cXG4gICAgICAgICAgICAgICAgICAgIDxkaXYgZGF0YS1iaW5kPVxcXCJjb21wb25lbnQ6IHsgbmFtZTogJ2FiaWxpdHknLCBwYXJhbXM6ICRkYXRhIH1cXFwiPjwvZGl2PlxcbiAgICAgICAgICAgICAgICA8L2Rpdj5cXG4gICAgICAgICAgICA8L2Rpdj5cXG4gICAgICAgIDwvZGl2PlxcblxcbiAgICAgICAgPGRpdiBkYXRhLWJpbmQ9XFxcImNvbXBvbmVudDogeyBuYW1lOiAnYnVmZi1zZWN0aW9uJywgcGFyYW1zOiAkZGF0YX1cXFwiPjwvZGl2PlxcbiAgICA8L2Rpdj5cXG48L2Rpdj5cIiB9KTtcbmtvLmNvbXBvbmVudHMucmVnaXN0ZXIoJ2Nsb25lLXBhbmUnLCB7IHRlbXBsYXRlOiBcIjxkaXYgY2xhc3M9XFxcInJvd1xcXCI+XFxuICAgIDxkaXYgY2xhc3M9XFxcImNvbC1tZC00XFxcIj5cXG4gICAgICAgIDxpbWcgY2xhc3M9XFxcImltZy1yb3VuZGVkXFxcIiBkYXRhLWJpbmQ9XFxcImF0dHI6e3NyYzogJy9tZWRpYS9pbWFnZXMvaGVyb2VzL21lZXBvLnBuZyd9XFxcIi8+XFxuICAgIDwvZGl2PlxcbjwvZGl2PlxcblxcbjxkaXYgY2xhc3M9XFxcInJvd1xcXCI+XFxuICAgIDxkaXYgY2xhc3M9XFxcImNvbC1tZC00XFxcIiBkYXRhLWJpbmQ9XFxcImNzczogeydjb2wtbWQtNCc6ICRyb290LmxheW91dCgpID09IDAsICdjb2wtbWQtMTInOiAkcm9vdC5sYXlvdXQoKSA9PSAxfVxcXCI+XFxuICAgICAgICA8ZGl2IGNsYXNzPVxcXCJyb3dcXFwiPlxcbiAgICAgICAgICAgIDxoMyBjbGFzcz1cXFwiY29sLW1kLTEyXFxcIj5TdGF0cyA8YSBjbGFzcz1cXFwiYnRuIGJ0bi1kZWZhdWx0IGJ0bi14c1xcXCIgZGF0YS1iaW5kPVxcXCJ0b2dnbGU6IHNob3dTdGF0RGV0YWlscywgdGV4dDogIXNob3dTdGF0RGV0YWlscygpID8gJ1Nob3cgbW9yZScgOiAnU2hvdyBsZXNzJywgYXR0cjoge3RpdGxlOiAhc2hvd1N0YXREZXRhaWxzKCkgPyAnQ2xpY2sgdG8gc2hvdyBiYXNlIHN0YXRzJyA6ICdDbGljayB0byBoaWRlIGJhc2Ugc3RhdHMnfVxcXCI+PC9hPjwvaDM+XFxuXFxuICAgICAgICAgICAgPGRpdiBjbGFzcz1cXFwiY29sLW1kLTEyXFxcIiBkYXRhLWJpbmQ9XFxcInZpc2libGU6IHNob3dTdGF0RGV0YWlscygpLCBjc3M6IHsnY29sLW1kLTEyJzogJHJvb3QubGF5b3V0KCkgPT0gMCwgJ2NvbC1tZC0zJzogJHJvb3QubGF5b3V0KCkgPT0gMX0sIGNvbXBvbmVudDoge25hbWU6ICdzdGF0cy1hZGRpdGlvbmFsJywgcGFyYW1zOiAkZGF0YX1cXFwiPjwvZGl2PlxcblxcbiAgICAgICAgICAgIDxkaXYgY2xhc3M9XFxcInN0YXRzY29udGFpbmVyXFxcIiBkYXRhLWJpbmQ9XFxcImZvcmVhY2g6ICRyb290LmFsbEl0ZW1zXFxcIj5cXG4gICAgICAgICAgICAgICAgPGRpdiBkYXRhLWJpbmQ9XFxcImNvbXBvbmVudDogeyBuYW1lOiAkZGF0YS52YWx1ZSwgcGFyYW1zOiAkcm9vdC5oZXJvZXNbJHBhcmVudENvbnRleHQuJGluZGV4KCldLmNsb25lKCl9XFxcIj48L2Rpdj5cXG4gICAgICAgICAgICA8L2Rpdj5cXG4gICAgICAgIDwvZGl2PlxcbiAgICA8L2Rpdj5cXG4gICAgPGRpdiBjbGFzcz1cXFwiY29sLW1kLThcXFwiIGRhdGEtYmluZD1cXFwiY3NzOiB7J2NvbC1tZC04JzogJHJvb3QubGF5b3V0KCkgPT0gMCwgJ2NvbC1tZC0xMic6ICRyb290LmxheW91dCgpID09IDF9XFxcIj5cXG4gICAgICAgIDxkaXYgZGF0YS1iaW5kPVxcXCJjb21wb25lbnQ6IHsgbmFtZTogJ2RhbWFnZS1kZXRhaWxzJywgcGFyYW1zOiAkZGF0YX1cXFwiPjwvZGl2PlxcbiAgICAgICAgXFxuICAgICAgICA8ZGl2IGNsYXNzPVxcXCJyb3dcXFwiPlxcbiAgICAgICAgICAgIDxkaXYgY2xhc3M9XFxcImNvbC1tZC0xMlxcXCI+XFxuICAgICAgICAgICAgICAgIDxoMyBjbGFzcz1cXFwic2VjdGlvbl9oZWFkZXJcXFwiIGRhdGEtYmluZD1cXFwidG9nZ2xlOiBzZWN0aW9uRGlzcGxheSgpLmludmVudG9yeSwgY3NzOiB7IHNlY3Rpb25fZGlzYWJsZWQ6ICFzZWN0aW9uRGlzcGxheSgpLmludmVudG9yeSgpIH1cXFwiPkludmVudG9yeSA8c21hbGwgc3R5bGU9XFxcImNvbG9yOmdvbGRlbnJvZFxcXCIgZGF0YS1iaW5kPVxcXCJodG1sOiBpbnZlbnRvcnkudG90YWxDb3N0KCkgPyAnPGltZyBzcmM9XFxcXCdodHRwOi8vY2RuLmRvdGEyLmNvbS9hcHBzL2RvdGEyL2ltYWdlcy90b29sdGlwcy9nb2xkLnBuZ1xcXFwnLz4gJyArIGludmVudG9yeS50b3RhbENvc3QoKSA6ICcnIFxcXCI+PC9zbWFsbD48L2gzPlxcbiAgICAgICAgICAgICAgICA8ZGl2IGlkPVxcXCJpbnZlbnRvcnlcXFwiIGNsYXNzPVxcXCJpbnZlbnRvcnkgaG92ZXItY3Vyc29yXFxcIiBkYXRhLWJpbmQ9XFxcImNsaWNrOiBmdW5jdGlvbiAoZGF0YSwgZXZlbnQpIHsgYnVpbGRFeHBsb3Jlci5zZWxlY3RJbnZlbnRvcnkoLTEpOyB9LCBjc3M6IHsncm93LWhpZ2hsaWdodCc6IHNlbGVjdGVkSW52ZW50b3J5KCkgPT0gLTF9LCB0ZW1wbGF0ZTogeyBuYW1lOiAnaXRlbS10ZW1wbGF0ZScsIGZvcmVhY2g6IGludmVudG9yeS5pdGVtcyB9LCB2aXNpYmxlOiBzZWN0aW9uRGlzcGxheSgpLmludmVudG9yeSgpXFxcIj48L2Rpdj5cXG4gICAgICAgICAgICA8L2Rpdj5cXG4gICAgICAgIDwvZGl2PlxcblxcbiAgICAgICAgPGRpdiBjbGFzcz1cXFwicm93XFxcIiBkYXRhLWJpbmQ9XFxcImNvbXBvbmVudDogeyBuYW1lOiAnZGFtYWdlLWFtcCcsIHBhcmFtczogJGRhdGF9XFxcIj48L2Rpdj5cXG4gICAgPC9kaXY+XFxuPC9kaXY+XCIgfSk7XG5rby5jb21wb25lbnRzLnJlZ2lzdGVyKCdpbGx1c2lvbi1wYW5lJywgeyB0ZW1wbGF0ZTogXCI8ZGl2IGNsYXNzPVxcXCJyb3dcXFwiPlxcbiAgICA8ZGl2IGNsYXNzPVxcXCJjb2wtbWQtNFxcXCI+XFxuICAgICAgICA8ZGl2IGNsYXNzPVxcXCJpbWctcm91bmRlZFxcXCIgc3R5bGU9XFxcImJhY2tncm91bmQtY29sb3I6IzQyOGJjYTtkaXNwbGF5OmlubGluZS1ibG9ja1xcXCI+XFxuICAgICAgICAgICAgPGltZyBjbGFzcz1cXFwiaW1nLXJvdW5kZWRcXFwiIHN0eWxlPVxcXCJvcGFjaXR5Oi41XFxcIiBkYXRhLWJpbmQ9XFxcImF0dHI6e3NyYzogJy9tZWRpYS9pbWFnZXMvaGVyb2VzLycgKyBzZWxlY3RlZEhlcm8oKS5oZXJvTmFtZSArICcucG5nJ31cXFwiLz5cXG4gICAgICAgIDwvZGl2PlxcbiAgICA8L2Rpdj5cXG4gICAgPGRpdiBjbGFzcz1cXFwiY29sLW1kLTRcXFwiPlxcbiAgICAgICAgPGxhYmVsIGZvcj1cXFwiaWxsdXNpb25sZXZlbFxcXCIgZGF0YS1iaW5kPVxcXCJ0ZXh0OiBpbGx1c2lvbkRpc3BsYXlOYW1lXFxcIj48L2xhYmVsPlxcbiAgICAgICAgPHRhYmxlIGNsYXNzPVxcXCJ0YWJsZVxcXCI+XFxuICAgICAgICAgICAgPHRib2R5PlxcbiAgICAgICAgICAgIDx0cj5cXG4gICAgICAgICAgICAgICAgPHRkPkRhbWFnZSBEZWFsdDwvdGQ+XFxuICAgICAgICAgICAgICAgIDx0ZCBjbGFzcz1cXFwidGV4dC1yaWdodFxcXCIgZGF0YS1iaW5kPVxcXCJ0ZXh0OiAoZ2V0T3V0Z29pbmdEYW1hZ2VNdWx0aXBsaWVyKGlsbHVzaW9uVHlwZSgpLCBmYWxzZSwgaGVyb0RhdGEoKS5hdHRhY2t0eXBlKSoxMDApLnRvRml4ZWQoMCkrJyUnXFxcIj48L3RkPlxcbiAgICAgICAgICAgIDwvdHI+XFxuICAgICAgICAgICAgPHRyPlxcbiAgICAgICAgICAgICAgICA8dGQ+RGFtYWdlIFRha2VuPC90ZD5cXG4gICAgICAgICAgICAgICAgPHRkIGNsYXNzPVxcXCJ0ZXh0LXJpZ2h0XFxcIiBkYXRhLWJpbmQ9XFxcInRleHQ6IChnZXRJbmNvbWluZ0RhbWFnZU11bHRpcGxpZXIoaWxsdXNpb25UeXBlKCksIGZhbHNlLCBoZXJvRGF0YSgpLmF0dGFja3R5cGUpKjEwMCkudG9GaXhlZCgwKSsnJSdcXFwiPjwvdGQ+XFxuICAgICAgICAgICAgPC90cj5cXG4gICAgICAgICAgICA8L3Rib2R5PlxcbiAgICAgICAgPC90YWJsZT5cXG4gICAgPC9kaXY+XFxuICAgIDxkaXYgY2xhc3M9XFxcImNvbC1tZC00XFxcIj5cXG4gICAgICAgIDxkaXYgZGF0YS1iaW5kPVxcXCJ2aXNpYmxlOiBpbGx1c2lvblR5cGUoKSAhPSAnaXRlbV9tYW50YSdcXFwiPlxcbiAgICAgICAgICAgIDxsYWJlbCBmb3I9XFxcImlsbHVzaW9ubGV2ZWxcXFwiPkFiaWxpdHkgTGV2ZWw8L2xhYmVsPlxcbiAgICAgICAgICAgIDxzZWxlY3QgaWQ9XFxcImlsbHVzaW9ubGV2ZWxcXFwiIGNsYXNzPVxcXCJmb3JtLWNvbnRyb2xcXFwiIGRhdGEtYmluZD1cXFwidmFsdWU6IGlsbHVzaW9uQWJpbGl0eUxldmVsLCBmb3JlYWNoOiBuZXcgQXJyYXkoaWxsdXNpb25BYmlsaXR5TWF4TGV2ZWwoKSlcXFwiPlxcbiAgICAgICAgICAgICAgICA8b3B0aW9uIGRhdGEtYmluZD1cXFwidGV4dDogJGluZGV4KCkrMVxcXCI+PC9vcHRpb24+XFxuICAgICAgICAgICAgPC9zZWxlY3Q+XFxuICAgICAgICA8L2Rpdj5cXG4gICAgPC9kaXY+XFxuPC9kaXY+XFxuXFxuPGRpdiBjbGFzcz1cXFwicm93XFxcIj5cXG4gICAgPGRpdiBjbGFzcz1cXFwiY29sLW1kLTRcXFwiIGRhdGEtYmluZD1cXFwiY3NzOiB7J2NvbC1tZC00JzogJHJvb3QubGF5b3V0KCkgPT0gMCwgJ2NvbC1tZC0xMic6ICRyb290LmxheW91dCgpID09IDF9XFxcIj5cXG4gICAgICAgIDxkaXYgY2xhc3M9XFxcInJvd1xcXCI+XFxuICAgICAgICAgICAgPGgzIGNsYXNzPVxcXCJjb2wtbWQtMTJcXFwiPlN0YXRzIDxhIGNsYXNzPVxcXCJidG4gYnRuLWRlZmF1bHQgYnRuLXhzXFxcIiBkYXRhLWJpbmQ9XFxcInRvZ2dsZTogc2hvd1N0YXREZXRhaWxzLCB0ZXh0OiAhc2hvd1N0YXREZXRhaWxzKCkgPyAnU2hvdyBtb3JlJyA6ICdTaG93IGxlc3MnLCBhdHRyOiB7dGl0bGU6ICFzaG93U3RhdERldGFpbHMoKSA/ICdDbGljayB0byBzaG93IGJhc2Ugc3RhdHMnIDogJ0NsaWNrIHRvIGhpZGUgYmFzZSBzdGF0cyd9XFxcIj48L2E+PC9oMz5cXG5cXG4gICAgICAgICAgICA8ZGl2IGNsYXNzPVxcXCJjb2wtbWQtMTJcXFwiIGRhdGEtYmluZD1cXFwidmlzaWJsZTogc2hvd1N0YXREZXRhaWxzKCksIGNzczogeydjb2wtbWQtMTInOiAkcm9vdC5sYXlvdXQoKSA9PSAwLCAnY29sLW1kLTMnOiAkcm9vdC5sYXlvdXQoKSA9PSAxfSwgY29tcG9uZW50OiB7bmFtZTogJ3N0YXRzLWFkZGl0aW9uYWwnLCBwYXJhbXM6ICRkYXRhfVxcXCI+XFxuICAgICAgICAgICAgPC9kaXY+XFxuICAgICAgICAgICAgPGRpdiBjbGFzcz1cXFwic3RhdHNjb250YWluZXJcXFwiIGRhdGEtYmluZD1cXFwiZm9yZWFjaDogJHJvb3QuYWxsSXRlbXNcXFwiPlxcbiAgICAgICAgICAgICAgICA8ZGl2IGRhdGEtYmluZD1cXFwiY29tcG9uZW50OiB7IG5hbWU6ICRkYXRhLnZhbHVlLCBwYXJhbXM6ICRwYXJlbnRDb250ZXh0LiRkYXRhfVxcXCI+PC9kaXY+XFxuICAgICAgICAgICAgPC9kaXY+XFxuICAgICAgICA8L2Rpdj5cXG4gICAgPC9kaXY+XFxuICAgIDxkaXYgY2xhc3M9XFxcImNvbC1tZC04XFxcIiBkYXRhLWJpbmQ9XFxcImNzczogeydjb2wtbWQtNCc6ICRyb290LmxheW91dCgpID09IDAsICdjb2wtbWQtMTInOiAkcm9vdC5sYXlvdXQoKSA9PSAxfVxcXCI+XFxuICAgICAgICA8ZGl2IGNsYXNzPVxcXCJyb3dcXFwiPlxcbiAgICAgICAgICAgIDxkaXYgY2xhc3M9XFxcImNvbC1tZC0xMlxcXCI+XFxuICAgICAgICAgICAgICAgIDxoMyBjbGFzcz1cXFwic2VjdGlvbl9oZWFkZXJcXFwiIGRhdGEtYmluZD1cXFwidG9nZ2xlOiBzZWN0aW9uRGlzcGxheSgpLmludmVudG9yeSwgY3NzOiB7IHNlY3Rpb25fZGlzYWJsZWQ6ICFzZWN0aW9uRGlzcGxheSgpLmludmVudG9yeSgpIH1cXFwiPkludmVudG9yeSA8c21hbGwgc3R5bGU9XFxcImNvbG9yOmdvbGRlbnJvZFxcXCIgZGF0YS1iaW5kPVxcXCJodG1sOiBpbnZlbnRvcnkudG90YWxDb3N0KCkgPyAnPGltZyBzcmM9XFxcXCdodHRwOi8vY2RuLmRvdGEyLmNvbS9hcHBzL2RvdGEyL2ltYWdlcy90b29sdGlwcy9nb2xkLnBuZ1xcXFwnLz4gJyArIGludmVudG9yeS50b3RhbENvc3QoKSA6ICcnIFxcXCI+PC9zbWFsbD48L2gzPlxcbiAgICAgICAgICAgICAgICA8ZGl2IGlkPVxcXCJpbnZlbnRvcnlcXFwiIGNsYXNzPVxcXCJpbnZlbnRvcnkgaG92ZXItY3Vyc29yXFxcIiBkYXRhLWJpbmQ9XFxcImNsaWNrOiBmdW5jdGlvbiAoZGF0YSwgZXZlbnQpIHsgYnVpbGRFeHBsb3Jlci5zZWxlY3RJbnZlbnRvcnkoLTEpOyB9LCBjc3M6IHsncm93LWhpZ2hsaWdodCc6IHNlbGVjdGVkSW52ZW50b3J5KCkgPT0gLTF9LCBmb3JlYWNoOiBpbnZlbnRvcnkuaXRlbXMsIHZpc2libGU6IHNlY3Rpb25EaXNwbGF5KCkuaW52ZW50b3J5KClcXFwiPlxcbiAgICAgICAgICAgICAgICAgICAgPGRpdiBjbGFzcz1cXFwiYnRuLWdyb3VwXFxcIj5cXG4gICAgICAgICAgICAgICAgICAgICAgICA8aW1nIHN0eWxlPVxcXCJ3aWR0aDo3NXB4O1xcXCIgY2xhc3M9XFxcImltZy1yb3VuZGVkXFxcIiBkYXRhLWJpbmQ9XFxcImNzczogeyBpdGVtX2Rpc2FibGVkOiAhZW5hYmxlZCgpLCBpdGVtX2FjdGl2ZTogJHBhcmVudC5pbnZlbnRvcnkuZ2V0QWN0aXZlQm9yZGVyKCRkYXRhKSA9PSAxLCBpdGVtX2luYWN0aXZlOiAkcGFyZW50LmludmVudG9yeS5nZXRBY3RpdmVCb3JkZXIoJGRhdGEpID09IDAgfSwgYXR0cjp7IHNyYzogJHBhcmVudC5pbnZlbnRvcnkuZ2V0SXRlbUltYWdlKCRkYXRhKSB9LCBjbGljazogZnVuY3Rpb24oZGF0YSwgZXZlbnQpIHsgJHBhcmVudC5pbnZlbnRvcnkudG9nZ2xlSXRlbSgkaW5kZXgsIGRhdGEsIGV2ZW50KTsgfSwgZXZlbnQ6IHsgZGJsY2xpY2s6ICRwYXJlbnQuaW52ZW50b3J5LnJlbW92ZUl0ZW0gfVxcXCIvPlxcbiAgICAgICAgICAgICAgICAgICAgICAgIDxkaXYgc3R5bGU9XFxcImZsb2F0OmxlZnRcXFwiIGRhdGEtYmluZD1cXFwidmlzaWJsZTogJHBhcmVudC5pbnZlbnRvcnkuZ2V0SXRlbVNpemVMYWJlbCgkZGF0YSkgIT0gJydcXFwiPlxcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICA8ZGl2IGRhdGEtYmluZD1cXFwiaHRtbDogJHBhcmVudC5pbnZlbnRvcnkuZ2V0SXRlbVNpemVMYWJlbCgkZGF0YSlcXFwiIHN0eWxlPVxcXCJwb3NpdGlvbjphYnNvbHV0ZTtsZWZ0OjA7Ym90dG9tOjA7Y29sb3I6d2hpdGU7b3BhY2l0eTouNTtiYWNrZ3JvdW5kLWNvbG9yOmJsYWNrO3BhZGRpbmc6MHB4IDJweFxcXCI+PC9kaXY+XFxuICAgICAgICAgICAgICAgICAgICAgICAgICAgIDxkaXYgZGF0YS1iaW5kPVxcXCJodG1sOiAkcGFyZW50LmludmVudG9yeS5nZXRJdGVtU2l6ZUxhYmVsKCRkYXRhKVxcXCIgc3R5bGU9XFxcInBvc2l0aW9uOmFic29sdXRlO2xlZnQ6MDtib3R0b206MDtjb2xvcjp3aGl0ZTtwYWRkaW5nOjBweCAycHhcXFwiPjwvZGl2PlxcbiAgICAgICAgICAgICAgICAgICAgICAgIDwvZGl2PlxcbiAgICAgICAgICAgICAgICAgICAgPC9kaXY+XFxuICAgICAgICAgICAgICAgIDwvZGl2PlxcbiAgICAgICAgICAgIDwvZGl2PlxcbiAgICAgICAgPC9kaXY+XFxuICAgIDwvZGl2PlxcbjwvZGl2PlwiIH0pO1xua28uY29tcG9uZW50cy5yZWdpc3RlcignYnVmZi1zZXR0aW5ncycsIHsgdGVtcGxhdGU6IFwiPGRpdiBjbGFzcz1cXFwiZm9ybS1ob3Jpem9udGFsXFxcIj5cXG4gICAgPGRpdiBkYXRhLWJpbmQ9XFxcImZvcmVhY2g6IGRhdGFcXFwiPlxcbiAgICAgICAgPGRpdiBjbGFzcz1cXFwiZm9ybS1ncm91cFxcXCIgZGF0YS1iaW5kPVxcXCJ2aXNpYmxlOiAoZGlzcGxheSA9PSB1bmRlZmluZWQgfHwgZGlzcGxheSA9PSAnYnVmZicpXFxcIj5cXG4gICAgICAgICAgICA8bGFiZWwgY2xhc3M9XFxcImNvbC1tZC02IGNvbnRyb2wtbGFiZWxcXFwiIGRhdGEtYmluZD1cXFwiY3NzOiB7J2NoZWNrYm94LWxhYmVsJzogY29udHJvbFR5cGUgPT0gJ2NoZWNrYm94J30sIGF0dHI6IHsnZm9yJzogbGFiZWxOYW1lfSwgaHRtbDogbGFiZWxOYW1lXFxcIj48L2xhYmVsPlxcbiAgICAgICAgICAgIDxkaXYgZGF0YS1iaW5kPVxcXCJpZjogY29udHJvbFR5cGUgPT0gJ2lucHV0JyAmJiAoZGlzcGxheSA9PSB1bmRlZmluZWQgfHwgZGlzcGxheSA9PSAnYnVmZicgfHwgZGlzcGxheSA9PSAnaGlkZGVuJylcXFwiPlxcbiAgICAgICAgICAgICAgICA8ZGl2IGNsYXNzPVxcXCJjb2wtbWQtNlxcXCI+PGlucHV0IGNsYXNzPVxcXCJmb3JtLWNvbnRyb2xcXFwiIGRhdGEtYmluZD1cXFwiYXR0cjogeydpZCc6IGxhYmVsTmFtZX0sIHZhbHVlOiBjb250cm9sVmFsXFxcIj48L2Rpdj5cXG4gICAgICAgICAgICA8L2Rpdj5cXG4gICAgICAgICAgICA8ZGl2IGRhdGEtYmluZD1cXFwiaWY6IGNvbnRyb2xUeXBlID09ICdjaGVja2JveCcgJiYgKGRpc3BsYXkgPT0gdW5kZWZpbmVkIHx8IGRpc3BsYXkgPT0gJ2J1ZmYnIHx8IGRpc3BsYXkgPT0gJ2hpZGRlbicpXFxcIj5cXG4gICAgICAgICAgICAgICAgPGRpdiBjbGFzcz1cXFwiY29sLW1kLTZcXFwiPlxcbiAgICAgICAgICAgICAgICAgICAgPGRpdiBjbGFzcz1cXFwiY2hlY2tib3hcXFwiPlxcbiAgICAgICAgICAgICAgICAgICAgICAgIDxpbnB1dCB0eXBlPVxcXCJjaGVja2JveFxcXCIgZGF0YS1iaW5kPVxcXCJhdHRyOiB7J2lkJzogbGFiZWxOYW1lfSwgY2hlY2tlZDogY29udHJvbFZhbFxcXCI+XFxuICAgICAgICAgICAgICAgICAgICA8L2Rpdj5cXG4gICAgICAgICAgICAgICAgPC9kaXY+XFxuICAgICAgICAgICAgPC9kaXY+XFxuICAgICAgICAgICAgPGRpdiBkYXRhLWJpbmQ9XFxcImlmOiAoY29udHJvbFR5cGUgPT0gJ3RleHQnIHx8IGNvbnRyb2xUeXBlID09ICdtZXRob2QnKSAmJiAoZGlzcGxheSA9PSB1bmRlZmluZWQgfHwgZGlzcGxheSA9PSAnYnVmZicgfHwgZGlzcGxheSA9PSAnaGlkZGVuJylcXFwiPlxcbiAgICAgICAgICAgICAgICA8ZGl2IGNsYXNzPVxcXCJjb2wtbWQtNlxcXCI+PHAgY2xhc3M9XFxcImZvcm0tY29udHJvbC1zdGF0aWNcXFwiIGRhdGEtYmluZD1cXFwiaHRtbDogY29udHJvbFZhbFxcXCI+PC9wPjwvZGl2PlxcbiAgICAgICAgICAgIDwvZGl2PlxcbiAgICAgICAgICAgIDxkaXYgZGF0YS1iaW5kPVxcXCJpZjogY29udHJvbFR5cGUgPT0gJ3JhZGlvJyAmJiAoZGlzcGxheSA9PSB1bmRlZmluZWQgfHwgZGlzcGxheSA9PSAnYnVmZicgfHwgZGlzcGxheSA9PSAnaGlkZGVuJylcXFwiPlxcbiAgICAgICAgICAgICAgICA8ZGl2IGNsYXNzPVxcXCJjb2wtbWQtNlxcXCI+XFxuICAgICAgICAgICAgICAgICAgICA8IS0tIGtvIGZvcmVhY2g6IGNvbnRyb2xPcHRpb25zIC0tPlxcbiAgICAgICAgICAgICAgICAgICAgPGRpdiBjbGFzcz1cXFwicmFkaW9cXFwiPlxcbiAgICAgICAgICAgICAgICAgICAgICAgIDxsYWJlbD5cXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgPGlucHV0IHR5cGU9XFxcInJhZGlvXFxcIiBkYXRhLWJpbmQ9XFxcImF0dHI6IHsnaWQnOiAkcGFyZW50LmxhYmVsTmFtZSArIHZhbHVlLCB2YWx1ZTogdmFsdWV9LCBjaGVja2VkOiAkcGFyZW50LmNvbnRyb2xWYWxcXFwiPlxcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICA8c3BhbiBkYXRhLWJpbmQ9XFxcInRleHQ6IHRleHRcXFwiPjwvc3Bhbj5cXG4gICAgICAgICAgICAgICAgICAgICAgICA8L2xhYmVsPlxcbiAgICAgICAgICAgICAgICAgICAgPC9kaXY+XFxuICAgICAgICAgICAgICAgICAgICA8IS0tIC9rbyAtLT5cXG4gICAgICAgICAgICAgICAgPC9kaXY+XFxuICAgICAgICAgICAgPC9kaXY+XFxuICAgICAgICA8L2Rpdj5cXG4gICAgPC9kaXY+XFxuPC9kaXY+XCIgfSk7XG5rby5jb21wb25lbnRzLnJlZ2lzdGVyKCd0YWxlbnQtc2VjdGlvbicsIHsgdGVtcGxhdGU6IFwiPGRpdiBjbGFzcz1cXFwicm93XFxcIj5cXG4gICAgPGRpdiBjbGFzcz1cXFwiY29sLW1kLTEyXFxcIj5cXG4gICAgICAgIDxoMyBjbGFzcz1cXFwic2VjdGlvbl9oZWFkZXJcXFwiIGRhdGEtYmluZD1cXFwidG9nZ2xlOiBzZWN0aW9uRGlzcGxheSgpLnRhbGVudCwgY3NzOiB7IHNlY3Rpb25fZGlzYWJsZWQ6ICFzZWN0aW9uRGlzcGxheSgpLnRhbGVudCgpIH1cXFwiPlRhbGVudHM8L2gzPlxcbiAgICAgICAgPGRpdiBjbGFzcz1cXFwicm93XFxcIiBkYXRhLWJpbmQ9XFxcImZvcmVhY2g6IGhlcm9EYXRhKCkudGFsZW50cywgdmlzaWJsZTogc2VjdGlvbkRpc3BsYXkoKS50YWxlbnQoKVxcXCI+XFxuICAgICAgICAgICAgPGRpdiBjbGFzcz1cXFwidGFsZW50IGNvbC14cy0xMlxcXCI+XFxuICAgICAgICAgICAgICAgIDxsYWJlbCBjbGFzcz1cXFwidGFsZW50LWxldmVsIGNvbC1zbS00IGNvbC14cy0xMlxcXCIgZGF0YS1iaW5kPVxcXCJ0ZXh0OiAnTGV2ZWwgJyArICgkaW5kZXgoKSAqIDUgKyAxMCkgKyAnOidcXFwiPjwvbGFiZWw+XFxuICAgICAgICAgICAgICAgIDxkaXYgY2xhc3M9XFxcInRhbGVudC0xIGNvbC1zbS00IGNvbC14cy0xMiBidG4gYnRuLWRlZmF1bHQgYnRuLXNtXFxcIiBkYXRhLWJpbmQ9XFxcInRleHQ6ICRkYXRhWzBdLmRpc3BsYXluYW1lLCBjbGljazogZnVuY3Rpb24gKCkgeyAkcGFyZW50LnRvZ2dsZVRhbGVudCgkaW5kZXgoKSwgMCkgfSwgY3NzOiB7J3RvZ2dsZWQnOiAkcGFyZW50LnRhbGVudHNbJGluZGV4KCldKCkgPT0gMH1cXFwiPjwvZGl2PlxcbiAgICAgICAgICAgICAgICA8ZGl2IGNsYXNzPVxcXCJ0YWxlbnQtMiBjb2wtc20tNCBjb2wteHMtMTIgYnRuIGJ0bi1kZWZhdWx0IGJ0bi1zbVxcXCIgZGF0YS1iaW5kPVxcXCJ0ZXh0OiAkZGF0YVsxXS5kaXNwbGF5bmFtZSwgY2xpY2s6IGZ1bmN0aW9uICgpIHsgJHBhcmVudC50b2dnbGVUYWxlbnQoJGluZGV4KCksIDEpIH0sIGNzczogeyd0b2dnbGVkJzogJHBhcmVudC50YWxlbnRzWyRpbmRleCgpXSgpID09IDF9XFxcIj48L2Rpdj5cXG4gICAgICAgICAgICA8L2Rpdj5cXG4gICAgICAgIDwvZGl2PlxcbiAgICA8L2Rpdj5cXG48L2Rpdj5cIiB9KTtcbmtvLmNvbXBvbmVudHMucmVnaXN0ZXIoJ2l0ZW0tYnVmZicsIHsgdGVtcGxhdGU6IFwiPGRpdiBjbGFzcz1cXFwiYnRuLWdyb3VwXFxcIj5cXG4gICAgPGltZyBzdHlsZT1cXFwid2lkdGg6NzVweDtcXFwiIGNsYXNzPVxcXCJpbWctcm91bmRlZFxcXCIgZGF0YS1iaW5kPVxcXCJjc3M6IHsgaXRlbV9kaXNhYmxlZDogIWVuYWJsZWQoKSwgaXRlbV9hY3RpdmU6ICRwYXJlbnRzWzFdLmJ1ZmZzLml0ZW1CdWZmcy5nZXRBY3RpdmVCb3JkZXIoJGRhdGEpID09IDEsIGl0ZW1faW5hY3RpdmU6ICRwYXJlbnRzWzFdLmJ1ZmZzLml0ZW1CdWZmcy5nZXRBY3RpdmVCb3JkZXIoJGRhdGEpID09IDAgfSwgYXR0cjp7IHNyYzogJHBhcmVudHNbMV0uYnVmZnMuaXRlbUJ1ZmZzLmdldEl0ZW1JbWFnZSgkZGF0YSkgfSwgY2xpY2s6IGZ1bmN0aW9uKGRhdGEsIGV2ZW50KSB7ICRwYXJlbnRzWzFdLmJ1ZmZzLml0ZW1CdWZmcy50b2dnbGVJdGVtKCRpbmRleCwgZGF0YSwgZXZlbnQpOyB9LCBldmVudDogeyBkYmxjbGljazogJHBhcmVudHNbMV0uYnVmZnMuaXRlbUJ1ZmZzLnJlbW92ZUl0ZW0gfVxcXCIvPlxcbiAgICA8ZGl2IGNsYXNzPVxcXCJidG4tZ3JvdXAtdmVydGljYWxcXFwiPlxcbiAgICAgICAgPGJ1dHRvbiBzdHlsZT1cXFwicGFkZGluZzozcHggMTBweDtcXFwiIGNsYXNzPVxcXCJidG4gYnRuLWRlZmF1bHQgYnRuLXhzXFxcIiB0aXRsZT1cXFwiUmVtb3ZlIEl0ZW1cXFwiIGRhdGEtYmluZD1cXFwiY2xpY2s6ICRwYXJlbnRzWzFdLmJ1ZmZzLml0ZW1CdWZmcy5yZW1vdmVJdGVtXFxcIj4mdGltZXM7PC9idXR0b24+XFxuICAgICAgICA8YnV0dG9uIHN0eWxlPVxcXCJwYWRkaW5nOjNweCAxMHB4O1xcXCIgY2xhc3M9XFxcImJ0biBidG4tZGVmYXVsdCBidG4teHNcXFwiIHRpdGxlPVxcXCJEaXNhYmxlL0VuYWJsZSBJdGVtXFxcIiBkYXRhLWJpbmQ9XFxcImNsaWNrOiAkcGFyZW50c1sxXS5idWZmcy5pdGVtQnVmZnMudG9nZ2xlTXV0ZUl0ZW0sIGh0bWw6IGVuYWJsZWQoKSA/ICdvJyA6ICctJywgYXR0cjoge3RpdGxlOiBlbmFibGVkKCkgPyAnRGlzYWJsZSBJdGVtJyA6ICdFbmFibGUgSXRlbSd9XFxcIj5vPC9idXR0b24+XFxuICAgIDwvZGl2PlxcbjwvZGl2PlwiIH0pO1xua28uY29tcG9uZW50cy5yZWdpc3RlcignaXRlbS1kZWJ1ZmYnLCB7IHRlbXBsYXRlOiBcIjxkaXYgY2xhc3M9XFxcImJ0bi1ncm91cFxcXCI+XFxuICAgIDxpbWcgc3R5bGU9XFxcIndpZHRoOjc1cHg7XFxcIiBjbGFzcz1cXFwiaW1nLXJvdW5kZWRcXFwiIGRhdGEtYmluZD1cXFwiY3NzOiB7IGl0ZW1fZGlzYWJsZWQ6ICFlbmFibGVkKCksIGl0ZW1fYWN0aXZlOiAkcGFyZW50c1sxXS5kZWJ1ZmZzLml0ZW1CdWZmcy5nZXRBY3RpdmVCb3JkZXIoJGRhdGEpID09IDEsIGl0ZW1faW5hY3RpdmU6ICRwYXJlbnRzWzFdLmRlYnVmZnMuaXRlbUJ1ZmZzLmdldEFjdGl2ZUJvcmRlcigkZGF0YSkgPT0gMCB9LCBhdHRyOnsgc3JjOiAkcGFyZW50c1sxXS5kZWJ1ZmZzLml0ZW1CdWZmcy5nZXRJdGVtSW1hZ2UoJGRhdGEpIH0sIGNsaWNrOiBmdW5jdGlvbihkYXRhLCBldmVudCkgeyAkcGFyZW50c1sxXS5kZWJ1ZmZzLml0ZW1CdWZmcy50b2dnbGVJdGVtKCRpbmRleCwgZGF0YSwgZXZlbnQpOyB9LCBldmVudDogeyBkYmxjbGljazogJHBhcmVudHNbMV0uZGVidWZmcy5pdGVtQnVmZnMucmVtb3ZlSXRlbSB9XFxcIi8+XFxuICAgIDxkaXYgY2xhc3M9XFxcImJ0bi1ncm91cC12ZXJ0aWNhbFxcXCI+XFxuICAgICAgICA8YnV0dG9uIHN0eWxlPVxcXCJwYWRkaW5nOjNweCAxMHB4O1xcXCIgY2xhc3M9XFxcImJ0biBidG4tZGVmYXVsdCBidG4teHNcXFwiIHRpdGxlPVxcXCJSZW1vdmUgSXRlbVxcXCIgZGF0YS1iaW5kPVxcXCJjbGljazogJHBhcmVudHNbMV0uZGVidWZmcy5pdGVtQnVmZnMucmVtb3ZlSXRlbVxcXCI+JnRpbWVzOzwvYnV0dG9uPlxcbiAgICAgICAgPGJ1dHRvbiBzdHlsZT1cXFwicGFkZGluZzozcHggMTBweDtcXFwiIGNsYXNzPVxcXCJidG4gYnRuLWRlZmF1bHQgYnRuLXhzXFxcIiB0aXRsZT1cXFwiRGlzYWJsZS9FbmFibGUgSXRlbVxcXCIgZGF0YS1iaW5kPVxcXCJjbGljazogJHBhcmVudHNbMV0uZGVidWZmcy5pdGVtQnVmZnMudG9nZ2xlTXV0ZUl0ZW0sIGh0bWw6IGVuYWJsZWQoKSA/ICdvJyA6ICctJywgYXR0cjoge3RpdGxlOiBlbmFibGVkKCkgPyAnRGlzYWJsZSBJdGVtJyA6ICdFbmFibGUgSXRlbSd9XFxcIj5vPC9idXR0b24+XFxuICAgIDwvZGl2PlxcbjwvZGl2PlwiIH0pO1xua28uY29tcG9uZW50cy5yZWdpc3RlcignYnVmZi1zZWN0aW9uJywgeyB0ZW1wbGF0ZTogXCI8ZGl2IGNsYXNzPVxcXCJyb3dcXFwiPlxcbiAgICA8ZGl2IGNsYXNzPVxcXCJjb2wtbWQtMTJcXFwiPlxcbiAgICAgICAgPGgzIGNsYXNzPVxcXCJzZWN0aW9uX2hlYWRlclxcXCIgZGF0YS1iaW5kPVxcXCJ0b2dnbGU6IHNlY3Rpb25EaXNwbGF5KCkuYnVmZiwgY3NzOiB7IHNlY3Rpb25fZGlzYWJsZWQ6ICFzZWN0aW9uRGlzcGxheSgpLmJ1ZmYoKSB9XFxcIj5CdWZmczwvaDM+XFxuICAgICAgICA8ZGl2IGNsYXNzPVxcXCJmb3JtLWhvcml6b250YWxcXFwiIGRhdGEtYmluZD1cXFwidmlzaWJsZTogc2VjdGlvbkRpc3BsYXkoKS5idWZmKClcXFwiPlxcbiAgICAgICAgICAgIDxkaXYgY2xhc3M9XFxcImZvcm0tZ3JvdXBcXFwiPlxcbiAgICAgICAgICAgICAgICA8ZGl2IGNsYXNzPVxcXCJjb2wtbWQtNlxcXCI+XFxuICAgICAgICAgICAgICAgICAgICA8c2VsZWN0IGlkPVxcXCJidWZmc2VsZWN0XFxcIiBjbGFzcz1cXFwiZm9ybS1jb250cm9sXFxcIiBkYXRhLWJpbmQ9XFxcIm9wdGlvbnM6IGJ1ZmZzLmF2YWlsYWJsZUJ1ZmZzICwgb3B0aW9uc1RleHQ6ICdidWZmRGlzcGxheU5hbWUnLCB2YWx1ZTogYnVmZnMuc2VsZWN0ZWRCdWZmXFxcIj48L3NlbGVjdD5cXG4gICAgICAgICAgICAgICAgPC9kaXY+XFxuICAgICAgICAgICAgICAgIDxkaXYgY2xhc3M9XFxcImNvbC1tZC02XFxcIj5cXG4gICAgICAgICAgICAgICAgICAgIDxidXR0b24gY2xhc3M9XFxcImJ0biBidG4tZGVmYXVsdFxcXCIgZGF0YS1iaW5kPVxcXCJjbGljazogYnVmZnMuYWRkQnVmZlxcXCI+QWRkPC9idXR0b24+XFxuICAgICAgICAgICAgICAgICAgICA8YnV0dG9uIGNsYXNzPVxcXCJidG4gYnRuLWRlZmF1bHRcXFwiIGRhdGEtYmluZD1cXFwiY2xpY2s6IGZ1bmN0aW9uKGRhdGEsZXZlbnQpIHsgYnVmZnMucmVtb3ZlQnVmZihkYXRhLCBldmVudCwgYnVmZnMuc2VsZWN0ZWRCdWZmKCkuYnVmZk5hbWUpIH1cXFwiPlJlbW92ZTwvYnV0dG9uPlxcbiAgICAgICAgICAgICAgICA8L2Rpdj5cXG4gICAgICAgICAgICA8L2Rpdj5cXG4gICAgICAgIDwvZGl2PlxcbiAgICAgICAgPGRpdiBjbGFzcz1cXFwicm93XFxcIiBkYXRhLWJpbmQ9XFxcImZvcmVhY2g6IGJ1ZmZzLmJ1ZmZzLCB2aXNpYmxlOiBzZWN0aW9uRGlzcGxheSgpLmJ1ZmYoKVxcXCI+XFxuICAgICAgICAgICAgPGRpdiBkYXRhLWJpbmQ9XFxcImNzczoge3JvdzogJGRhdGEuZGF0YS5pc0RldGFpbCgpIHx8ICgkaW5kZXgoKSA8ICRwYXJlbnQuYnVmZnMuYnVmZnMoKS5sZW5ndGgtMSAmJiAkcGFyZW50LmJ1ZmZzLmJ1ZmZzKClbJGluZGV4KCkrMV0uZGF0YS5pc0RldGFpbCgpKSwgcm93MjogJGRhdGEuZGF0YS5pc0RldGFpbCgpIHx8ICgkaW5kZXgoKSA8ICRwYXJlbnQuYnVmZnMuYnVmZnMoKS5sZW5ndGgtMSAmJiAkcGFyZW50LmJ1ZmZzLmJ1ZmZzKClbJGluZGV4KCkrMV0uZGF0YS5pc0RldGFpbCgpKSB9XFxcIj5cXG4gICAgICAgICAgICAgICAgPGRpdiBjbGFzcz1cXFwiY29sLW1kLTMgdGV4dC1jZW50ZXIgYm90dG9tLWJ1ZmZlcjJcXFwiIGRhdGEtYmluZD1cXFwiY3NzOiB7J2NvbC1tZC0zJzogJHJvb3QubGF5b3V0KCkgPT0gMCwgJ2NvbC1tZC0yJzogJHJvb3QubGF5b3V0KCkgPT0gMX1cXFwiPlxcbiAgICAgICAgICAgICAgICAgICAgPGltZyBzdHlsZT1cXFwicGFkZGluZzowcHg7bWFyZ2luLWJvdHRvbToxcHg7XFxcIiBjbGFzcz1cXFwiaW1nLXJvdW5kZWQgYWJpbGl0eVxcXCIgZGF0YS1iaW5kPVxcXCJjc3M6IHsgYWJpbGl0eV9hY3RpdmU6ICRkYXRhLmRhdGEuaXNBY3RpdmUoKSB8fCAkZGF0YS5kYXRhLmJlaGF2aW9yLmluZGV4T2YoJ0RPVEFfQUJJTElUWV9CRUhBVklPUl9QQVNTSVZFJykgIT0gLTEsIGFiaWxpdHlfaW5hY3RpdmU6ICEkZGF0YS5kYXRhLmlzQWN0aXZlKCkgJiYgJGRhdGEuZGF0YS5iZWhhdmlvci5pbmRleE9mKCdET1RBX0FCSUxJVFlfQkVIQVZJT1JfUEFTU0lWRScpID09IC0xLCBidG46ICRkYXRhLmRhdGEuYmVoYXZpb3IuaW5kZXhPZignRE9UQV9BQklMSVRZX0JFSEFWSU9SX1BBU1NJVkUnKSA9PSAtMSwgJ2J0bi1kZWZhdWx0JzogJGRhdGEuZGF0YS5iZWhhdmlvci5pbmRleE9mKCdET1RBX0FCSUxJVFlfQkVIQVZJT1JfUEFTU0lWRScpID09IC0xfSwgYXR0cjp7c3JjOiAnL21lZGlhL2ltYWdlcy9zcGVsbGljb25zLycgKyAkZGF0YS5kYXRhLm5hbWUgKyAnLnBuZyd9LCBjbGljazogZnVuY3Rpb24oZGF0YSwgZXZlbnQpIHsgJHBhcmVudC5idWZmcy50b2dnbGVCdWZmKCRpbmRleCwgZGF0YS5kYXRhLCBldmVudCk7IH0sIGV2ZW50OiB7IGRibGNsaWNrOiBmdW5jdGlvbihkYXRhLGV2ZW50KSB7ICRwYXJlbnQuYnVmZnMucmVtb3ZlQnVmZihkYXRhLCBldmVudCwgJGRhdGEuZGF0YS5uYW1lKSB9IH1cXFwiLz5cXG4gICAgICAgICAgICAgICAgICAgIDxkaXYgY2xhc3M9XFxcInByb2dyZXNzXFxcIiBzdHlsZT1cXFwicG9zaXRpb246cmVsYXRpdmVcXFwiPlxcbiAgICAgICAgICAgICAgICAgICAgICAgIDxkaXYgc3R5bGU9XFxcInBvc2l0aW9uOmFic29sdXRlO3dpZHRoOjEwMCU7Y29sb3I6d2hpdGU7XFxcIiBjbGFzcz1cXFwidGV4dC1jZW50ZXJcXFwiIGRhdGEtYmluZD1cXFwidmlzaWJsZTogJHBhcmVudC5nZXRBYmlsaXR5TGV2ZWxNYXgoJGRhdGEuZGF0YSkgPiAwLCB0ZXh0OiAkZGF0YS5kYXRhLmxldmVsKCkgKyAnLycgKyAkcGFyZW50LmdldEFiaWxpdHlMZXZlbE1heCgkZGF0YS5kYXRhKVxcXCI+PC9kaXY+XFxuICAgICAgICAgICAgICAgICAgICAgICAgPGRpdiBjbGFzcz1cXFwicHJvZ3Jlc3MtYmFyIHByb2dyZXNzLWJhci1kYW5nZXJcXFwiIHJvbGU9XFxcInByb2dyZXNzYmFyXFxcIiBhcmlhLXZhbHVlbm93PVxcXCI2MFxcXCIgYXJpYS12YWx1ZW1pbj1cXFwiMFxcXCIgYXJpYS12YWx1ZW1heD1cXFwiMTAwXFxcIiBzdHlsZT1cXFwid2lkdGg6IDYwJTtcXFwiIGRhdGEtYmluZD1cXFwiYXR0cjogeyAnYXJpYS12YWx1ZW5vdyc6ICgkcGFyZW50LmdldEFiaWxpdHlMZXZlbE1heCgkZGF0YS5kYXRhKSA+IDAgPyAkZGF0YS5kYXRhLmxldmVsKCkvJHBhcmVudC5nZXRBYmlsaXR5TGV2ZWxNYXgoJGRhdGEuZGF0YSkqMTAwIDogMCkgfSwgc3R5bGU6IHsgd2lkdGg6ICgkcGFyZW50LmdldEFiaWxpdHlMZXZlbE1heCgkZGF0YS5kYXRhKSA+IDAgPyAkZGF0YS5kYXRhLmxldmVsKCkvJHBhcmVudC5nZXRBYmlsaXR5TGV2ZWxNYXgoJGRhdGEuZGF0YSkqMTAwIDogMCkgKyAnJScgfVxcXCI+PC9kaXY+XFxuICAgICAgICAgICAgICAgICAgICA8L2Rpdj5cXG4gICAgICAgICAgICAgICAgICAgIDxkaXYgY2xhc3M9XFxcImJ0bi1ncm91cCBidG4tZ3JvdXAtanVzdGlmaWVkXFxcIiBkYXRhLWJpbmQ9XFxcImlmOiAkZGF0YS5kYXRhLmJlaGF2aW9yLmluZGV4T2YoJ0RPVEFfQUJJTElUWV9CRUhBVklPUl9OT1RfTEVBUk5BQkxFJykgPT0gLTFcXFwiPlxcbiAgICAgICAgICAgICAgICAgICAgICAgIDxhIGNsYXNzPVxcXCJidG4gYnRuLWRlZmF1bHQgYnRuLXNtXFxcIiBkYXRhLWJpbmQ9XFxcImNsaWNrOiBmdW5jdGlvbihkYXRhLCBldmVudCkgeyAkcGFyZW50LmJ1ZmZzLmxldmVsRG93bkFiaWxpdHkoJGluZGV4LCBkYXRhLmRhdGEsIGV2ZW50LCAkcGFyZW50KTsgfVxcXCI+LTwvYT5cXG4gICAgICAgICAgICAgICAgICAgICAgICA8YSBjbGFzcz1cXFwiYnRuIGJ0bi1kZWZhdWx0IGJ0bi1zbVxcXCIgZGF0YS1iaW5kPVxcXCJjbGljazogZnVuY3Rpb24oZGF0YSwgZXZlbnQpIHsgJHBhcmVudC5idWZmcy5sZXZlbFVwQWJpbGl0eSgkaW5kZXgsIGRhdGEuZGF0YSwgZXZlbnQsICRwYXJlbnQpOyB9XFxcIj4rPC9hPlxcbiAgICAgICAgICAgICAgICAgICAgPC9kaXY+XFxuICAgICAgICAgICAgICAgICAgICA8ZGl2IGNsYXNzPVxcXCJidG4tZ3JvdXAgYnRuLWdyb3VwLWp1c3RpZmllZFxcXCI+XFxuICAgICAgICAgICAgICAgICAgICAgICAgPGEgY2xhc3M9XFxcImJ0biBidG4tZGVmYXVsdCBidG4tc21cXFwiIGRhdGEtYmluZD1cXFwiY2xpY2s6IGZ1bmN0aW9uKGRhdGEsIGV2ZW50KSB7ICRwYXJlbnQuYnVmZnMudG9nZ2xlQnVmZkRldGFpbCgkaW5kZXgsIGRhdGEsIGV2ZW50KTsgfSwgY3NzOiB7J3RvZ2dsZWQnOiAkZGF0YS5kYXRhLmlzRGV0YWlsfVxcXCI+RGV0YWlsczwvYT5cXG4gICAgICAgICAgICAgICAgICAgIDwvZGl2PlxcbiAgICAgICAgICAgICAgICA8L2Rpdj5cXG4gICAgICAgICAgICAgICAgPGRpdiBjbGFzcz1cXFwiY29sLW1kLTkgYm90dG9tLWJ1ZmZlclxcXCIgZGF0YS1iaW5kPVxcXCJ2aXNpYmxlOiAkZGF0YS5kYXRhLmlzRGV0YWlsKClcXFwiPlxcbiAgICAgICAgICAgICAgICAgICAgPGJ1dHRvbiB0eXBlPVxcXCJidXR0b25cXFwiIGNsYXNzPVxcXCJjbG9zZVxcXCIgZGF0YS1iaW5kPVxcXCJjbGljazogZnVuY3Rpb24oZGF0YSwgZXZlbnQpIHsgJHBhcmVudC5idWZmcy50b2dnbGVCdWZmRGV0YWlsKCRpbmRleCwgZGF0YS5kYXRhLCBldmVudCk7IH1cXFwiPiZ0aW1lczs8L2J1dHRvbj5cXG4gICAgICAgICAgICAgICAgICAgIDxkaXYgZGF0YS1iaW5kPVxcXCJodG1sOiAkcGFyZW50LmFiaWxpdHkoKS5nZXRBYmlsaXR5VG9vbHRpcERhdGEoJGRhdGEuaGVybywgJGRhdGEuZGF0YS5uYW1lKVxcXCI+PC9kaXY+XFxuICAgICAgICAgICAgICAgICAgICA8ZGl2IGRhdGEtYmluZD1cXFwiaWY6ICRkYXRhLmRhdGEubmFtZSBpbiAkcGFyZW50LmJ1ZmZzLmFiaWxpdHlEYXRhICYmICRwYXJlbnQuYnVmZnMuYnVmZnMoKVskaW5kZXgoKV0uZGF0YS5sZXZlbCgpID4gMFxcXCI+XFxuICAgICAgICAgICAgICAgICAgICAgICAgPGRpdiBjbGFzcz1cXFwiY29sLW1kLThcXFwiPlxcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICA8ZGl2IGRhdGEtYmluZD1cXFwiY29tcG9uZW50OiB7IG5hbWU6ICdidWZmLXNldHRpbmdzJywgcGFyYW1zOiAkcGFyZW50LmJ1ZmZzLmFiaWxpdHlTZXR0aW5nc0RhdGEoJGRhdGEuZGF0YS5uYW1lLCAkcGFyZW50LCAkaW5kZXgoKSkgfVxcXCI+PC9kaXY+XFxuICAgICAgICAgICAgICAgICAgICAgICAgPC9kaXY+XFxuICAgICAgICAgICAgICAgICAgICA8L2Rpdj5cXG4gICAgICAgICAgICAgICAgPC9kaXY+XFxuICAgICAgICAgICAgPC9kaXY+XFxuICAgICAgICA8L2Rpdj5cXG4gICAgICAgIFxcbiAgICAgICAgPGRpdiBjbGFzcz1cXFwiZm9ybS1ob3Jpem9udGFsXFxcIiBkYXRhLWJpbmQ9XFxcInZpc2libGU6IHNlY3Rpb25EaXNwbGF5KCkuYnVmZigpXFxcIj5cXG4gICAgICAgICAgICA8ZGl2IGNsYXNzPVxcXCJmb3JtLWdyb3VwXFxcIj5cXG4gICAgICAgICAgICAgICAgPGRpdiBjbGFzcz1cXFwiY29sLW1kLTZcXFwiPlxcbiAgICAgICAgICAgICAgICAgICAgPGRpdiBjbGFzcz1cXFwiaW5wdXQtZ3JvdXBcXFwiPlxcbiAgICAgICAgICAgICAgICAgICAgICAgIDxpbnB1dCBjbGFzcz1cXFwiZm9ybS1jb250cm9sXFxcIiBpZD1cXFwiYXV0bzJcXFwiIGRhdGEtYmluZD1cXFwiYXR0cjoge2lkOiBpZCgpICsgJy1hdXRvMicgfSwganFBdXRvOiB7IGF1dG9Gb2N1czogdHJ1ZSwgaHRtbDogdHJ1ZSB9LCBqcUF1dG9Tb3VyY2U6IGJ1ZmZzLml0ZW1CdWZmcy5pdGVtQnVmZk9wdGlvbnMsIGpxQXV0b1ZhbHVlOiBidWZmcy5pdGVtQnVmZnMuc2VsZWN0ZWRJdGVtQnVmZiwganFBdXRvU291cmNlTGFiZWw6ICdkaXNwbGF5bmFtZScsIGpxQXV0b1NvdXJjZUlucHV0VmFsdWU6ICduYW1lJywganFBdXRvU291cmNlVmFsdWU6ICd2YWx1ZSdcXFwiIC8+XFxuICAgICAgICAgICAgICAgICAgICAgICAgPHNwYW4gY2xhc3M9XFxcImlucHV0LWdyb3VwLWJ0blxcXCI+XFxuICAgICAgICAgICAgICAgICAgICAgICAgICAgIDxidXR0b24gY2xhc3M9XFxcImJ0biBidG4tZGVmYXVsdFxcXCIgZGF0YS1iaW5kPVxcXCJqcUF1dG9Db21ibzogaWQoKSArICctYXV0bzInXFxcIj48c3BhbiBjbGFzcz1cXFwiZ2x5cGhpY29uIGdseXBoaWNvbi1zZWFyY2hcXFwiPjwvc3Bhbj48L2J1dHRvbj5cXG4gICAgICAgICAgICAgICAgICAgICAgICA8L3NwYW4+XFxuICAgICAgICAgICAgICAgICAgICA8L2Rpdj5cXG4gICAgICAgICAgICAgICAgPC9kaXY+XFxuICAgICAgICAgICAgICAgIDxkaXYgY2xhc3M9XFxcImNvbC1tZC02XFxcIj5cXG4gICAgICAgICAgICAgICAgICAgIDxidXR0b24gY2xhc3M9XFxcImJ0biBidG4tZGVmYXVsdFxcXCIgZGF0YS1iaW5kPVxcXCJjbGljazogYnVmZnMuaXRlbUJ1ZmZzLmFkZEl0ZW1CdWZmXFxcIj5BZGQ8L2J1dHRvbj5cXG4gICAgICAgICAgICAgICAgPC9kaXY+XFxuICAgICAgICAgICAgPC9kaXY+XFxuICAgICAgICA8L2Rpdj5cXG4gICAgICAgIDxkaXYgZGF0YS1iaW5kPVxcXCJmb3JlYWNoOiBidWZmcy5pdGVtQnVmZnMuaXRlbXMsIHZpc2libGU6IHNlY3Rpb25EaXNwbGF5KCkuYnVmZigpXFxcIj5cXG4gICAgICAgICAgICA8ZGl2IGNsYXNzPVxcXCJwdWxsLWxlZnRcXFwiIHN0eWxlPVxcXCJtYXJnaW4tcmlnaHQ6MTBweFxcXCIgZGF0YS1iaW5kPVxcXCJjb21wb25lbnQ6IHsgbmFtZTogJ2l0ZW0tYnVmZicsIHBhcmFtczogJGRhdGF9XFxcIj48L2Rpdj5cXG4gICAgICAgIDwvZGl2PlxcbiAgICA8L2Rpdj5cXG48L2Rpdj5cXG5cXG48ZGl2IGNsYXNzPVxcXCJyb3dcXFwiPlxcbiAgICA8ZGl2IGNsYXNzPVxcXCJjb2wtbWQtMTJcXFwiPlxcbiAgICAgICAgPGgzIGNsYXNzPVxcXCJzZWN0aW9uX2hlYWRlclxcXCIgZGF0YS1iaW5kPVxcXCJ0b2dnbGU6IHNlY3Rpb25EaXNwbGF5KCkuZGVidWZmLCBjc3M6IHsgc2VjdGlvbl9kaXNhYmxlZDogIXNlY3Rpb25EaXNwbGF5KCkuZGVidWZmKCkgfVxcXCI+RGVidWZmczwvaDM+XFxuICAgICAgICA8ZGl2IGNsYXNzPVxcXCJmb3JtLWhvcml6b250YWxcXFwiIGRhdGEtYmluZD1cXFwidmlzaWJsZTogc2VjdGlvbkRpc3BsYXkoKS5kZWJ1ZmYoKVxcXCI+XFxuICAgICAgICAgICAgPGRpdiBjbGFzcz1cXFwiZm9ybS1ncm91cFxcXCI+XFxuICAgICAgICAgICAgICAgIDxkaXYgY2xhc3M9XFxcImNvbC1tZC02XFxcIj5cXG4gICAgICAgICAgICAgICAgICAgIDxzZWxlY3QgaWQ9XFxcImJ1ZmZzZWxlY3RcXFwiIGNsYXNzPVxcXCJmb3JtLWNvbnRyb2xcXFwiIGRhdGEtYmluZD1cXFwib3B0aW9uczogZGVidWZmcy5hdmFpbGFibGVEZWJ1ZmZzICwgb3B0aW9uc1RleHQ6ICdidWZmRGlzcGxheU5hbWUnLCB2YWx1ZTogZGVidWZmcy5zZWxlY3RlZEJ1ZmZcXFwiPjwvc2VsZWN0PlxcbiAgICAgICAgICAgICAgICA8L2Rpdj5cXG4gICAgICAgICAgICAgICAgPGRpdiBjbGFzcz1cXFwiY29sLW1kLTZcXFwiPlxcbiAgICAgICAgICAgICAgICAgICAgPGJ1dHRvbiBjbGFzcz1cXFwiYnRuIGJ0bi1kZWZhdWx0XFxcIiBkYXRhLWJpbmQ9XFxcImNsaWNrOiBkZWJ1ZmZzLmFkZEJ1ZmZcXFwiPkFkZDwvYnV0dG9uPlxcbiAgICAgICAgICAgICAgICAgICAgPGJ1dHRvbiBjbGFzcz1cXFwiYnRuIGJ0bi1kZWZhdWx0XFxcIiBkYXRhLWJpbmQ9XFxcImNsaWNrOiBmdW5jdGlvbihkYXRhLGV2ZW50KSB7IGRlYnVmZnMucmVtb3ZlQnVmZihkYXRhLCBldmVudCwgZGVidWZmcy5zZWxlY3RlZEJ1ZmYoKS5idWZmTmFtZSkgfVxcXCI+UmVtb3ZlPC9idXR0b24+XFxuICAgICAgICAgICAgICAgIDwvZGl2PlxcbiAgICAgICAgICAgIDwvZGl2PlxcbiAgICAgICAgPC9kaXY+XFxuXFxuICAgICAgICA8ZGl2IGNsYXNzPVxcXCJyb3dcXFwiIGRhdGEtYmluZD1cXFwiZm9yZWFjaDogZGVidWZmcy5idWZmcywgdmlzaWJsZTogc2VjdGlvbkRpc3BsYXkoKS5kZWJ1ZmYoKVxcXCI+XFxuICAgICAgICAgICAgPGRpdiBkYXRhLWJpbmQ9XFxcImNzczoge3JvdzogJGRhdGEuZGF0YS5pc0RldGFpbCgpIHx8ICgkaW5kZXgoKSA8ICRwYXJlbnQuZGVidWZmcy5idWZmcygpLmxlbmd0aC0xICYmICRwYXJlbnQuZGVidWZmcy5idWZmcygpWyRpbmRleCgpKzFdLmRhdGEuaXNEZXRhaWwoKSksIHJvdzI6ICRkYXRhLmRhdGEuaXNEZXRhaWwoKSB8fCAoJGluZGV4KCkgPCAkcGFyZW50LmRlYnVmZnMuYnVmZnMoKS5sZW5ndGgtMSAmJiAkcGFyZW50LmRlYnVmZnMuYnVmZnMoKVskaW5kZXgoKSsxXS5kYXRhLmlzRGV0YWlsKCkpIH1cXFwiPlxcbiAgICAgICAgICAgICAgICA8ZGl2IGNsYXNzPVxcXCJjb2wtbWQtMyB0ZXh0LWNlbnRlciBib3R0b20tYnVmZmVyMlxcXCIgZGF0YS1iaW5kPVxcXCJjc3M6IHsnY29sLW1kLTMnOiAkcm9vdC5sYXlvdXQoKSA9PSAwLCAnY29sLW1kLTInOiAkcm9vdC5sYXlvdXQoKSA9PSAxfVxcXCI+XFxuICAgICAgICAgICAgICAgICAgICA8aW1nIHN0eWxlPVxcXCJwYWRkaW5nOjBweDttYXJnaW4tYm90dG9tOjFweDtcXFwiIGNsYXNzPVxcXCJpbWctcm91bmRlZCBhYmlsaXR5XFxcIiBkYXRhLWJpbmQ9XFxcImNzczogeyBhYmlsaXR5X2FjdGl2ZTogJGRhdGEuZGF0YS5pc0FjdGl2ZSgpIHx8ICRkYXRhLmRhdGEuYmVoYXZpb3IuaW5kZXhPZignRE9UQV9BQklMSVRZX0JFSEFWSU9SX1BBU1NJVkUnKSAhPSAtMSwgYWJpbGl0eV9pbmFjdGl2ZTogISRkYXRhLmRhdGEuaXNBY3RpdmUoKSAmJiAkZGF0YS5kYXRhLmJlaGF2aW9yLmluZGV4T2YoJ0RPVEFfQUJJTElUWV9CRUhBVklPUl9QQVNTSVZFJykgPT0gLTEsIGJ0bjogJGRhdGEuZGF0YS5iZWhhdmlvci5pbmRleE9mKCdET1RBX0FCSUxJVFlfQkVIQVZJT1JfUEFTU0lWRScpID09IC0xLCAnYnRuLWRlZmF1bHQnOiAkZGF0YS5kYXRhLmJlaGF2aW9yLmluZGV4T2YoJ0RPVEFfQUJJTElUWV9CRUhBVklPUl9QQVNTSVZFJykgPT0gLTF9LCBhdHRyOntzcmM6ICcvbWVkaWEvaW1hZ2VzL3NwZWxsaWNvbnMvJyArICRkYXRhLmRhdGEubmFtZSArICcucG5nJ30sIGNsaWNrOiBmdW5jdGlvbihkYXRhLCBldmVudCkgeyAkcGFyZW50LmRlYnVmZnMudG9nZ2xlQnVmZigkaW5kZXgsIGRhdGEuZGF0YSwgZXZlbnQpOyB9LCBldmVudDogeyBkYmxjbGljazogZnVuY3Rpb24oZGF0YSxldmVudCkgeyAkcGFyZW50LmRlYnVmZnMucmVtb3ZlQnVmZihkYXRhLCBldmVudCwgJGRhdGEuZGF0YS5uYW1lKSB9IH1cXFwiLz5cXG4gICAgICAgICAgICAgICAgICAgIDxkaXYgY2xhc3M9XFxcInByb2dyZXNzXFxcIiBzdHlsZT1cXFwicG9zaXRpb246cmVsYXRpdmVcXFwiPlxcbiAgICAgICAgICAgICAgICAgICAgICAgIDxkaXYgc3R5bGU9XFxcInBvc2l0aW9uOmFic29sdXRlO3dpZHRoOjEwMCU7Y29sb3I6d2hpdGU7XFxcIiBjbGFzcz1cXFwidGV4dC1jZW50ZXJcXFwiIGRhdGEtYmluZD1cXFwidmlzaWJsZTogJHBhcmVudC5nZXRBYmlsaXR5TGV2ZWxNYXgoJGRhdGEuZGF0YSkgPiAwLCB0ZXh0OiAkZGF0YS5kYXRhLmxldmVsKCkgKyAnLycgKyAkcGFyZW50LmdldEFiaWxpdHlMZXZlbE1heCgkZGF0YS5kYXRhKVxcXCI+PC9kaXY+XFxuICAgICAgICAgICAgICAgICAgICAgICAgPGRpdiBjbGFzcz1cXFwicHJvZ3Jlc3MtYmFyIHByb2dyZXNzLWJhci1kYW5nZXJcXFwiIHJvbGU9XFxcInByb2dyZXNzYmFyXFxcIiBhcmlhLXZhbHVlbm93PVxcXCI2MFxcXCIgYXJpYS12YWx1ZW1pbj1cXFwiMFxcXCIgYXJpYS12YWx1ZW1heD1cXFwiMTAwXFxcIiBzdHlsZT1cXFwid2lkdGg6IDYwJTtcXFwiIGRhdGEtYmluZD1cXFwiYXR0cjogeyAnYXJpYS12YWx1ZW5vdyc6ICgkcGFyZW50LmdldEFiaWxpdHlMZXZlbE1heCgkZGF0YS5kYXRhKSA+IDAgPyAkZGF0YS5kYXRhLmxldmVsKCkvJHBhcmVudC5nZXRBYmlsaXR5TGV2ZWxNYXgoJGRhdGEuZGF0YSkqMTAwIDogMCkgfSwgc3R5bGU6IHsgd2lkdGg6ICgkcGFyZW50LmdldEFiaWxpdHlMZXZlbE1heCgkZGF0YS5kYXRhKSA+IDAgPyAkZGF0YS5kYXRhLmxldmVsKCkvJHBhcmVudC5nZXRBYmlsaXR5TGV2ZWxNYXgoJGRhdGEuZGF0YSkqMTAwIDogMCkgKyAnJScgfVxcXCI+PC9kaXY+XFxuICAgICAgICAgICAgICAgICAgICA8L2Rpdj5cXG4gICAgICAgICAgICAgICAgICAgIDxkaXYgY2xhc3M9XFxcImJ0bi1ncm91cCBidG4tZ3JvdXAtanVzdGlmaWVkXFxcIiBkYXRhLWJpbmQ9XFxcImlmOiAkZGF0YS5kYXRhLmJlaGF2aW9yLmluZGV4T2YoJ0RPVEFfQUJJTElUWV9CRUhBVklPUl9OT1RfTEVBUk5BQkxFJykgPT0gLTFcXFwiPlxcbiAgICAgICAgICAgICAgICAgICAgICAgIDxhIGNsYXNzPVxcXCJidG4gYnRuLWRlZmF1bHQgYnRuLXNtXFxcIiBkYXRhLWJpbmQ9XFxcImNsaWNrOiBmdW5jdGlvbihkYXRhLCBldmVudCkgeyAkcGFyZW50LmRlYnVmZnMubGV2ZWxEb3duQWJpbGl0eSgkaW5kZXgsIGRhdGEuZGF0YSwgZXZlbnQsICRwYXJlbnQpOyB9XFxcIj4tPC9hPlxcbiAgICAgICAgICAgICAgICAgICAgICAgIDxhIGNsYXNzPVxcXCJidG4gYnRuLWRlZmF1bHQgYnRuLXNtXFxcIiBkYXRhLWJpbmQ9XFxcImNsaWNrOiBmdW5jdGlvbihkYXRhLCBldmVudCkgeyAkcGFyZW50LmRlYnVmZnMubGV2ZWxVcEFiaWxpdHkoJGluZGV4LCBkYXRhLmRhdGEsIGV2ZW50LCAkcGFyZW50KTsgfVxcXCI+KzwvYT5cXG4gICAgICAgICAgICAgICAgICAgIDwvZGl2PlxcbiAgICAgICAgICAgICAgICAgICAgPGRpdiBjbGFzcz1cXFwiYnRuLWdyb3VwIGJ0bi1ncm91cC1qdXN0aWZpZWRcXFwiPlxcbiAgICAgICAgICAgICAgICAgICAgICAgIDxhIGNsYXNzPVxcXCJidG4gYnRuLWRlZmF1bHQgYnRuLXNtXFxcIiBkYXRhLWJpbmQ9XFxcImNsaWNrOiBmdW5jdGlvbihkYXRhLCBldmVudCkgeyAkcGFyZW50LmRlYnVmZnMudG9nZ2xlQnVmZkRldGFpbCgkaW5kZXgsIGRhdGEsIGV2ZW50KTsgfSwgY3NzOiB7J3RvZ2dsZWQnOiAkZGF0YS5kYXRhLmlzRGV0YWlsfVxcXCI+RGV0YWlsczwvYT5cXG4gICAgICAgICAgICAgICAgICAgIDwvZGl2PlxcbiAgICAgICAgICAgICAgICA8L2Rpdj5cXG4gICAgICAgICAgICAgICAgPGRpdiBjbGFzcz1cXFwiY29sLW1kLTkgYm90dG9tLWJ1ZmZlclxcXCIgZGF0YS1iaW5kPVxcXCJ2aXNpYmxlOiAkZGF0YS5kYXRhLmlzRGV0YWlsKClcXFwiPlxcbiAgICAgICAgICAgICAgICAgICAgPGJ1dHRvbiB0eXBlPVxcXCJidXR0b25cXFwiIGNsYXNzPVxcXCJjbG9zZVxcXCIgZGF0YS1iaW5kPVxcXCJjbGljazogZnVuY3Rpb24oZGF0YSwgZXZlbnQpIHsgJHBhcmVudC5kZWJ1ZmZzLnRvZ2dsZUJ1ZmZEZXRhaWwoJGluZGV4LCBkYXRhLmRhdGEsIGV2ZW50KTsgfVxcXCI+JnRpbWVzOzwvYnV0dG9uPlxcbiAgICAgICAgICAgICAgICAgICAgPGRpdiBkYXRhLWJpbmQ9XFxcImh0bWw6ICRwYXJlbnQuYWJpbGl0eSgpLmdldEFiaWxpdHlUb29sdGlwRGF0YSgkZGF0YS5oZXJvLCAkZGF0YS5kYXRhLm5hbWUpXFxcIj48L2Rpdj5cXG4gICAgICAgICAgICAgICAgICAgIDxkaXYgZGF0YS1iaW5kPVxcXCJpZjogJGRhdGEuZGF0YS5uYW1lIGluICRwYXJlbnQuZGVidWZmcy5hYmlsaXR5RGF0YSAmJiAkcGFyZW50LmRlYnVmZnMuYnVmZnMoKVskaW5kZXgoKV0uZGF0YS5sZXZlbCgpID4gMFxcXCI+XFxuICAgICAgICAgICAgICAgICAgICAgICAgPGRpdiBjbGFzcz1cXFwiY29sLW1kLThcXFwiPlxcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICA8ZGl2IGRhdGEtYmluZD1cXFwiY29tcG9uZW50OiB7IG5hbWU6ICdidWZmLXNldHRpbmdzJywgcGFyYW1zOiAkcGFyZW50LmRlYnVmZnMuYWJpbGl0eVNldHRpbmdzRGF0YSgkZGF0YS5kYXRhLm5hbWUsICRwYXJlbnQsICRpbmRleCgpKSB9XFxcIj48L2Rpdj5cXG4gICAgICAgICAgICAgICAgICAgICAgICA8L2Rpdj5cXG4gICAgICAgICAgICAgICAgICAgIDwvZGl2PlxcbiAgICAgICAgICAgICAgICA8L2Rpdj5cXG4gICAgICAgICAgICA8L2Rpdj5cXG4gICAgICAgIDwvZGl2PlxcbiAgICAgICAgXFxuICAgICAgICA8ZGl2IGNsYXNzPVxcXCJmb3JtLWhvcml6b250YWxcXFwiIGRhdGEtYmluZD1cXFwidmlzaWJsZTogc2VjdGlvbkRpc3BsYXkoKS5kZWJ1ZmYoKVxcXCI+XFxuICAgICAgICAgICAgPGRpdiBjbGFzcz1cXFwiZm9ybS1ncm91cFxcXCI+XFxuICAgICAgICAgICAgICAgIDxkaXYgY2xhc3M9XFxcImNvbC1tZC02XFxcIj5cXG4gICAgICAgICAgICAgICAgICAgIDxkaXYgY2xhc3M9XFxcImlucHV0LWdyb3VwXFxcIj5cXG4gICAgICAgICAgICAgICAgICAgICAgICA8aW5wdXQgY2xhc3M9XFxcImZvcm0tY29udHJvbFxcXCIgaWQ9XFxcImF1dG8zXFxcIiBkYXRhLWJpbmQ9XFxcImF0dHI6IHtpZDogaWQoKSArICctYXV0bzMnIH0sIGpxQXV0bzogeyBhdXRvRm9jdXM6IHRydWUsIGh0bWw6IHRydWUgfSwganFBdXRvU291cmNlOiBkZWJ1ZmZzLml0ZW1CdWZmcy5pdGVtRGVidWZmT3B0aW9ucywganFBdXRvVmFsdWU6IGRlYnVmZnMuaXRlbUJ1ZmZzLnNlbGVjdGVkSXRlbURlYnVmZiwganFBdXRvU291cmNlTGFiZWw6ICdkaXNwbGF5bmFtZScsIGpxQXV0b1NvdXJjZUlucHV0VmFsdWU6ICduYW1lJywganFBdXRvU291cmNlVmFsdWU6ICd2YWx1ZSdcXFwiIC8+XFxuICAgICAgICAgICAgICAgICAgICAgICAgPHNwYW4gY2xhc3M9XFxcImlucHV0LWdyb3VwLWJ0blxcXCI+XFxuICAgICAgICAgICAgICAgICAgICAgICAgICAgIDxidXR0b24gY2xhc3M9XFxcImJ0biBidG4tZGVmYXVsdFxcXCIgZGF0YS1iaW5kPVxcXCJqcUF1dG9Db21ibzogaWQoKSArICctYXV0bzMnXFxcIj48c3BhbiBjbGFzcz1cXFwiZ2x5cGhpY29uIGdseXBoaWNvbi1zZWFyY2hcXFwiPjwvc3Bhbj48L2J1dHRvbj5cXG4gICAgICAgICAgICAgICAgICAgICAgICA8L3NwYW4+XFxuICAgICAgICAgICAgICAgICAgICA8L2Rpdj5cXG4gICAgICAgICAgICAgICAgPC9kaXY+XFxuICAgICAgICAgICAgICAgIDxkaXYgY2xhc3M9XFxcImNvbC1tZC02XFxcIj5cXG4gICAgICAgICAgICAgICAgICAgIDxidXR0b24gY2xhc3M9XFxcImJ0biBidG4tZGVmYXVsdFxcXCIgZGF0YS1iaW5kPVxcXCJjbGljazogZGVidWZmcy5pdGVtQnVmZnMuYWRkSXRlbURlYnVmZlxcXCI+QWRkPC9idXR0b24+XFxuICAgICAgICAgICAgICAgIDwvZGl2PlxcbiAgICAgICAgICAgIDwvZGl2PlxcbiAgICAgICAgPC9kaXY+XFxuICAgICAgICA8ZGl2IGRhdGEtYmluZD1cXFwiZm9yZWFjaDogZGVidWZmcy5pdGVtQnVmZnMuaXRlbXMsIHZpc2libGU6IHNlY3Rpb25EaXNwbGF5KCkuZGVidWZmKClcXFwiPlxcbiAgICAgICAgICAgIDxkaXYgY2xhc3M9XFxcInB1bGwtbGVmdFxcXCIgc3R5bGU9XFxcIm1hcmdpbi1yaWdodDoxMHB4XFxcIiBkYXRhLWJpbmQ9XFxcImNvbXBvbmVudDogeyBuYW1lOiAnaXRlbS1kZWJ1ZmYnLCBwYXJhbXM6ICRkYXRhfVxcXCI+PC9kaXY+XFxuICAgICAgICA8L2Rpdj5cXG4gICAgPC9kaXY+XFxuPC9kaXY+XCIgfSk7XG5rby5jb21wb25lbnRzLnJlZ2lzdGVyKCdkYW1hZ2UtZGV0YWlscycsIHsgdGVtcGxhdGU6IFwiPGRpdiBjbGFzcz1cXFwicm93XFxcIj5cXG4gICAgPGRpdiBjbGFzcz1cXFwiY29sLW1kLTEyXFxcIj5cXG4gICAgICAgIDxoMyBzdHlsZT1cXFwiZGlzcGxheTpibG9jaztcXFwiIGNsYXNzPVxcXCJzZWN0aW9uX2hlYWRlclxcXCIgZGF0YS1iaW5kPVxcXCJ0b2dnbGU6IHNob3dEYW1hZ2VEZXRhaWxzLCBjc3M6IHsgc2VjdGlvbl9kaXNhYmxlZDogIXNob3dEYW1hZ2VEZXRhaWxzKCkgfVxcXCI+RGFtYWdlIERldGFpbHNcXG4gICAgICAgICAgICA8c3BhbiBjbGFzcz1cXFwicHVsbC1yaWdodFxcXCIgZGF0YS1iaW5kPVxcXCJ2aXNpYmxlOiBzaG93RGFtYWdlRGV0YWlscygpXFxcIj5cXG4gICAgICAgICAgICAgICAgPHNtYWxsIHN0eWxlPVxcXCJ0ZXh0LWFsaWduOmNlbnRlclxcXCIgZGF0YS1iaW5kPVxcXCJzdHlsZToge2NvbG9yOiBnZXREYW1hZ2VUeXBlQ29sb3IoJ3BoeXNpY2FsJyl9XFxcIj5QaHlzaWNhbDwvc21hbGw+XFxuICAgICAgICAgICAgICAgIDxzbWFsbCBzdHlsZT1cXFwidGV4dC1hbGlnbjpjZW50ZXJcXFwiIGRhdGEtYmluZD1cXFwic3R5bGU6IHtjb2xvcjogZ2V0RGFtYWdlVHlwZUNvbG9yKCdtYWdpYycpfVxcXCI+TWFnaWNhbDwvc21hbGw+XFxuICAgICAgICAgICAgICAgIDxzbWFsbCBzdHlsZT1cXFwidGV4dC1hbGlnbjpjZW50ZXJcXFwiIGRhdGEtYmluZD1cXFwic3R5bGU6IHtjb2xvcjogZ2V0RGFtYWdlVHlwZUNvbG9yKCdwdXJlJyl9XFxcIj5QdXJlPC9zbWFsbD5cXG4gICAgICAgICAgICA8L3NwYW4+XFxuICAgICAgICA8L2gzPlxcbiAgICAgICAgPHRhYmxlIGNsYXNzPVxcXCJ0YWJsZSBkYW1hZ2UtZGV0YWlsc1xcXCIgZGF0YS1iaW5kPVxcXCJ2aXNpYmxlOiBzaG93RGFtYWdlRGV0YWlscygpXFxcIj5cXG4gICAgICAgICAgICA8dGhlYWQ+XFxuICAgICAgICAgICAgICAgIDx0ciBjbGFzcz1cXFwiZGFtYWdlLWRldGFpbHMtaGVhZGVyLXJvd1xcXCI+XFxuICAgICAgICAgICAgICAgICAgICA8dGQ+PC90ZD5cXG4gICAgICAgICAgICAgICAgICAgIDx0ZCBjbGFzcz1cXFwidGV4dC1jZW50ZXJcXFwiIGNvbHNwYW49XFxcIjJcXFwiPjxzdHJvbmc+QXR0YWNrIERhbWFnZTwvc3Ryb25nPjxpbWcgc3JjPVxcXCJpbWcvcmVkdWNfaWNvbi5wbmdcXFwiIGNsYXNzPVxcXCJwdWxsLXJpZ2h0XFxcIiBkYXRhLWJpbmQ9XFxcImF0dHI6IHt0aXRsZTogJ0FmdGVyIHJlZHVjdGlvbnMgZnJvbSAnICsgZW5lbXkoKS5oZXJvRGF0YSgpLmRpc3BsYXluYW1lfVxcXCI+PC90ZD5cXG4gICAgICAgICAgICAgICAgICAgIDx0ZCBjbGFzcz1cXFwidGV4dC1jZW50ZXJcXFwiIGNvbHNwYW49XFxcIjJcXFwiPjxzdHJvbmc+RFBTPC9zdHJvbmc+PGltZyBzcmM9XFxcImltZy9yZWR1Y19pY29uLnBuZ1xcXCIgY2xhc3M9XFxcInB1bGwtcmlnaHRcXFwiIGRhdGEtYmluZD1cXFwiYXR0cjoge3RpdGxlOiAnQWZ0ZXIgcmVkdWN0aW9ucyBmcm9tICcgKyBlbmVteSgpLmhlcm9EYXRhKCkuZGlzcGxheW5hbWV9XFxcIj48L3RkPlxcbiAgICAgICAgICAgICAgICA8L3RyPlxcbiAgICAgICAgICAgICAgICA8dHIgY2xhc3M9XFxcImRhbWFnZS1kZXRhaWxzLWhlYWRlci1yb3ctMiB0b3RhbC1yb3dcXFwiPlxcbiAgICAgICAgICAgICAgICAgICAgPHRkPjxzdHJvbmc+VG90YWw8L3N0cm9uZz48L3RkPlxcbiAgICAgICAgICAgICAgICAgICAgPHRkIGNsYXNzPVxcXCJ0ZXh0LXJpZ2h0XFxcIiBkYXRhLWJpbmQ9XFxcInRleHQ6IGRhbWFnZVRvdGFsSW5mbygpLnRvdGFsUm93WzBdKCkudG9GaXhlZCgyKVxcXCI+PC90ZD5cXG4gICAgICAgICAgICAgICAgICAgIDx0ZCBjbGFzcz1cXFwidGV4dC1yaWdodFxcXCIgZGF0YS1iaW5kPVxcXCJ0ZXh0OiBkYW1hZ2VUb3RhbEluZm8oKS50b3RhbFJvd1sxXSgpLnRvRml4ZWQoMilcXFwiPjwvdGQ+XFxuICAgICAgICAgICAgICAgICAgICA8dGQgY2xhc3M9XFxcInRleHQtcmlnaHRcXFwiIGRhdGEtYmluZD1cXFwidGV4dDogZGFtYWdlVG90YWxJbmZvKCkudG90YWxSb3dbMl0oKS50b0ZpeGVkKDIpXFxcIj48L3RkPlxcbiAgICAgICAgICAgICAgICAgICAgPHRkIGNsYXNzPVxcXCJ0ZXh0LXJpZ2h0XFxcIiBkYXRhLWJpbmQ9XFxcInRleHQ6IGRhbWFnZVRvdGFsSW5mbygpLnRvdGFsUm93WzNdKCkudG9GaXhlZCgyKVxcXCI+PC90ZD5cXG4gICAgICAgICAgICAgICAgPC90cj5cXG4gICAgICAgICAgICA8L3RoZWFkPlxcbiAgICAgICAgICAgIDwhLS0ga28gZm9yZWFjaDogZGFtYWdlVG90YWxJbmZvKCkuYXR0YWNrcyAtLT5cXG4gICAgICAgICAgICA8dGJvZHk+XFxuICAgICAgICAgICAgICAgIDx0ciBjbGFzcz1cXFwiaW5kZW50IHN1YnRvdGFsLXJvd1xcXCIgZGF0YS1iaW5kPVxcXCJ0b2dnbGU6ICRkYXRhLmVuYWJsZWQsIGNzczogeyAnaW5hY3RpdmUnOiAhJGRhdGEuZW5hYmxlZCgpIH1cXFwiPlxcbiAgICAgICAgICAgICAgICAgICAgPHRkPlxcbiAgICAgICAgICAgICAgICAgICAgICAgIDxidXR0b24gY2xhc3M9XFxcImJ0biBidG4tZGVmYXVsdCBidG4teHMgZ2x5cGhpY29uIHB1bGwtbGVmdFxcXCIgZGF0YS1iaW5kPVxcXCJ0b2dnbGU6ICRkYXRhLmVuYWJsZWQsIGNzczogeydnbHlwaGljb24tZXllLW9wZW4nOiAkZGF0YS5lbmFibGVkKCksICdnbHlwaGljb24tZXllLWNsb3NlJzogISRkYXRhLmVuYWJsZWQoKX0sIHByZXZlbnRCdWJibGU6ICdjbGljaydcXFwiPjwvYnV0dG9uPlxcbiAgICAgICAgICAgICAgICAgICAgICAgIDxidXR0b24gY2xhc3M9XFxcImJ0biBidG4tZGVmYXVsdCBidG4teHMgZ2x5cGhpY29uIHB1bGwtcmlnaHRcXFwiIGRhdGEtYmluZD1cXFwidG9nZ2xlOiAkZGF0YS52aXNpYmxlLCBjc3M6IHsnZ2x5cGhpY29uLW1pbnVzJzogJGRhdGEudmlzaWJsZSgpLCAnZ2x5cGhpY29uLXBsdXMnOiAhJGRhdGEudmlzaWJsZSgpfSwgcHJldmVudEJ1YmJsZTogJ2NsaWNrJ1xcXCI+PC9idXR0b24+XFxuICAgICAgICAgICAgICAgICAgICAgICAgPHN0cm9uZz48c3BhbiBkYXRhLWJpbmQ9XFxcInRleHQ6ICRkYXRhLm5hbWVcXFwiPjwvc3Bhbj48L3N0cm9uZz5cXG4gICAgICAgICAgICAgICAgICAgIDwvdGQ+XFxuICAgICAgICAgICAgICAgICAgICA8dGQgY2xhc3M9XFxcInRleHQtcmlnaHRcXFwiIGRhdGEtYmluZD1cXFwidGV4dDogJGRhdGEudG90YWxSb3dbMF0oKS50b0ZpeGVkKDIpXFxcIj48L3RkPlxcbiAgICAgICAgICAgICAgICAgICAgPHRkIGNsYXNzPVxcXCJ0ZXh0LXJpZ2h0XFxcIiBkYXRhLWJpbmQ9XFxcInRleHQ6ICRkYXRhLnRvdGFsUm93WzFdKCkudG9GaXhlZCgyKVxcXCI+PC90ZD5cXG4gICAgICAgICAgICAgICAgICAgIDx0ZCBjbGFzcz1cXFwidGV4dC1yaWdodFxcXCIgZGF0YS1iaW5kPVxcXCJ0ZXh0OiAkZGF0YS50b3RhbFJvd1syXSgpLnRvRml4ZWQoMilcXFwiPjwvdGQ+XFxuICAgICAgICAgICAgICAgICAgICA8dGQgY2xhc3M9XFxcInRleHQtcmlnaHRcXFwiIGRhdGEtYmluZD1cXFwidGV4dDogJGRhdGEudG90YWxSb3dbM10oKS50b0ZpeGVkKDIpXFxcIj48L3RkPlxcbiAgICAgICAgICAgICAgICA8L3RyPlxcbiAgICAgICAgICAgIDwvdGJvZHk+XFxuICAgICAgICAgICAgPHRib2R5IGNsYXNzPVxcXCJpbmRlbnRcXFwiIGRhdGEtYmluZD1cXFwiZm9yZWFjaDogJGRhdGEuc291cmNlcywgdmlzaWJsZTogJGRhdGEudmlzaWJsZVxcXCI+XFxuICAgICAgICAgICAgICAgIDx0ciBkYXRhLWJpbmQ9XFxcInRvZ2dsZTogJGRhdGEuZW5hYmxlZCwgY3NzOiB7ICdpbmFjdGl2ZSc6ICEkZGF0YS5lbmFibGVkKCkgfVxcXCI+XFxuICAgICAgICAgICAgICAgICAgICA8dGQgY2xhc3M9XFxcImluZGVudFxcXCI+XFxuICAgICAgICAgICAgICAgICAgICAgICAgPHNwYW4gZGF0YS1iaW5kPVxcXCJ0ZXh0OiAkZGF0YS5uYW1lXFxcIj48L3NwYW4+XFxuICAgICAgICAgICAgICAgICAgICAgICAgPGJ1dHRvbiBjbGFzcz1cXFwiYnRuIGJ0bi1kZWZhdWx0IGJ0bi14cyBnbHlwaGljb24gcHVsbC1sZWZ0XFxcIiBkYXRhLWJpbmQ9XFxcInRvZ2dsZTogJGRhdGEuZW5hYmxlZCwgY3NzOiB7J2dseXBoaWNvbi1leWUtb3Blbic6ICRkYXRhLmVuYWJsZWQoKSwgJ2dseXBoaWNvbi1leWUtY2xvc2UnOiAhJGRhdGEuZW5hYmxlZCgpfSwgcHJldmVudEJ1YmJsZTogJ2NsaWNrJ1xcXCI+PC9idXR0b24+XFxuICAgICAgICAgICAgICAgICAgICA8L3RkPlxcbiAgICAgICAgICAgICAgICAgICAgPHRkIGNsYXNzPVxcXCJ0ZXh0LXJpZ2h0XFxcIj48c3BhbiBkYXRhLWJpbmQ9XFxcImh0bWw6ICRkYXRhLmRhbWFnZS50b0ZpeGVkKDIpLCBzdHlsZToge2NvbG9yOiAkcGFyZW50c1sxXS5nZXREYW1hZ2VUeXBlQ29sb3IoJGRhdGEuZGFtYWdlVHlwZSl9XFxcIj48L3NwYW4+PC90ZD5cXG4gICAgICAgICAgICAgICAgICAgIDx0ZCBjbGFzcz1cXFwidGV4dC1yaWdodFxcXCI+PHNwYW4gZGF0YS1iaW5kPVxcXCJodG1sOiAkZGF0YS5kYW1hZ2VSZWR1Y2VkLnRvRml4ZWQoMiksIHN0eWxlOiB7Y29sb3I6ICRwYXJlbnRzWzFdLmdldERhbWFnZVR5cGVDb2xvcigkZGF0YS5kYW1hZ2VUeXBlKX1cXFwiPjwvc3Bhbj48L3RkPlxcbiAgICAgICAgICAgICAgICAgICAgPHRkIGNsYXNzPVxcXCJ0ZXh0LXJpZ2h0XFxcIj48c3BhbiBkYXRhLWJpbmQ9XFxcImh0bWw6ICRkYXRhLmRwcy50b0ZpeGVkKDIpLCBzdHlsZToge2NvbG9yOiAkcGFyZW50c1sxXS5nZXREYW1hZ2VUeXBlQ29sb3IoJGRhdGEuZGFtYWdlVHlwZSl9XFxcIj48L3NwYW4+PC90ZD5cXG4gICAgICAgICAgICAgICAgICAgIDx0ZCBjbGFzcz1cXFwidGV4dC1yaWdodFxcXCI+PHNwYW4gZGF0YS1iaW5kPVxcXCJodG1sOiAkZGF0YS5kcHNSZWR1Y2VkLnRvRml4ZWQoMiksIHN0eWxlOiB7Y29sb3I6ICRwYXJlbnRzWzFdLmdldERhbWFnZVR5cGVDb2xvcigkZGF0YS5kYW1hZ2VUeXBlKX1cXFwiPjwvc3Bhbj48L3RkPlxcbiAgICAgICAgICAgICAgICA8L3RyPlxcbiAgICAgICAgICAgIDwvdGJvZHk+XFxuICAgICAgICAgICAgPHRyIGNsYXNzPVxcXCJpbmRlbnQgY3JpdFxcXCIgZGF0YS1iaW5kPVxcXCJ2aXNpYmxlOiAkZGF0YS52aXNpYmxlKCkgJiYgJGRhdGEuc291cmNlc0NyaXQubGVuZ3RoID4gMFxcXCI+XFxuICAgICAgICAgICAgICAgIDx0ZCBjbGFzcz1cXFwiaW5kZW50XFxcIj5Dcml0aWNhbCBTdHJpa2UgUHJvYywgPHNwYW4gZGF0YS1iaW5kPVxcXCJ0ZXh0OiAoJGRhdGEudG90YWxDcml0Q2hhbmNlICogMTAwKS50b0ZpeGVkKDEpICsgJyUnXFxcIj48L3NwYW4+PC90ZD5cXG4gICAgICAgICAgICAgICAgPHRkIGNsYXNzPVxcXCJ0ZXh0LXJpZ2h0XFxcIiBkYXRhLWJpbmQ9XFxcInRleHQ6ICRkYXRhLnRvdGFsQ3JpdFJvd1swXSgpLnRvRml4ZWQoMilcXFwiPjwvdGQ+XFxuICAgICAgICAgICAgICAgIDx0ZCBjbGFzcz1cXFwidGV4dC1yaWdodFxcXCIgZGF0YS1iaW5kPVxcXCJ0ZXh0OiAkZGF0YS50b3RhbENyaXRSb3dbMV0oKS50b0ZpeGVkKDIpXFxcIj48L3RkPlxcbiAgICAgICAgICAgICAgICA8dGQgY2xhc3M9XFxcInRleHQtcmlnaHRcXFwiIGRhdGEtYmluZD1cXFwidGV4dDogJGRhdGEudG90YWxDcml0Um93WzJdKCkudG9GaXhlZCgyKVxcXCI+PC90ZD5cXG4gICAgICAgICAgICAgICAgPHRkIGNsYXNzPVxcXCJ0ZXh0LXJpZ2h0XFxcIiBkYXRhLWJpbmQ9XFxcInRleHQ6ICRkYXRhLnRvdGFsQ3JpdFJvd1szXSgpLnRvRml4ZWQoMilcXFwiPjwvdGQ+XFxuICAgICAgICAgICAgPC90cj5cXG4gICAgICAgICAgICA8dGJvZHkgY2xhc3M9XFxcImluZGVudFxcXCIgZGF0YS1iaW5kPVxcXCJ2aXNpYmxlOiAkZGF0YS52aXNpYmxlLCBmb3JlYWNoOiAkZGF0YS5zb3VyY2VzQ3JpdFxcXCI+XFxuICAgICAgICAgICAgICAgIDx0ciBjbGFzcz1cXFwiaW5kZW50IGNyaXRcXFwiIGRhdGEtYmluZD1cXFwidG9nZ2xlOiAkZGF0YS5lbmFibGVkLCBjc3M6IHsgJ2luYWN0aXZlJzogISRkYXRhLmVuYWJsZWQoKSB9XFxcIj5cXG4gICAgICAgICAgICAgICAgICAgIDx0ZCBjbGFzcz1cXFwiaW5kZW50XFxcIj5cXG4gICAgICAgICAgICAgICAgICAgICAgICA8c3BhbiBkYXRhLWJpbmQ9XFxcInRleHQ6ICRkYXRhLm5hbWVcXFwiPjwvc3Bhbj5cXG4gICAgICAgICAgICAgICAgICAgICAgICA8YnV0dG9uIGNsYXNzPVxcXCJidG4gYnRuLWRlZmF1bHQgYnRuLXhzIGdseXBoaWNvbiBwdWxsLWxlZnRcXFwiIGRhdGEtYmluZD1cXFwidG9nZ2xlOiAkZGF0YS5lbmFibGVkLCBjc3M6IHsnZ2x5cGhpY29uLWV5ZS1vcGVuJzogJGRhdGEuZW5hYmxlZCgpLCAnZ2x5cGhpY29uLWV5ZS1jbG9zZSc6ICEkZGF0YS5lbmFibGVkKCl9LCBwcmV2ZW50QnViYmxlOiAnY2xpY2snXFxcIj48L2J1dHRvbj5cXG4gICAgICAgICAgICAgICAgICAgIDwvdGQ+XFxuICAgICAgICAgICAgICAgICAgICA8dGQgY2xhc3M9XFxcInRleHQtcmlnaHRcXFwiPjxzcGFuIGRhdGEtYmluZD1cXFwiaHRtbDogJGRhdGEuZGFtYWdlLnRvRml4ZWQoMilcXFwiPjwvc3Bhbj48L3RkPlxcbiAgICAgICAgICAgICAgICAgICAgPHRkIGNsYXNzPVxcXCJ0ZXh0LXJpZ2h0XFxcIj48c3BhbiBkYXRhLWJpbmQ9XFxcImh0bWw6ICRkYXRhLmRhbWFnZVJlZHVjZWQudG9GaXhlZCgyKVxcXCI+PC9zcGFuPjwvdGQ+XFxuICAgICAgICAgICAgICAgICAgICA8dGQgY2xhc3M9XFxcInRleHQtcmlnaHRcXFwiPjxzcGFuIGRhdGEtYmluZD1cXFwiaHRtbDogJGRhdGEuZHBzLnRvRml4ZWQoMilcXFwiPjwvc3Bhbj48L3RkPlxcbiAgICAgICAgICAgICAgICAgICAgPHRkIGNsYXNzPVxcXCJ0ZXh0LXJpZ2h0XFxcIj48c3BhbiBkYXRhLWJpbmQ9XFxcImh0bWw6ICRkYXRhLmRwc1JlZHVjZWQudG9GaXhlZCgyKVxcXCI+PC9zcGFuPjwvdGQ+XFxuICAgICAgICAgICAgICAgIDwvdHI+XFxuICAgICAgICAgICAgPC90Ym9keT5cXG4gICAgICAgICAgICA8IS0tIC9rbyAtLT5cXG4gICAgICAgICAgICA8dGJvZHk+XFxuICAgICAgICAgICAgICAgIDx0ciBkYXRhLWJpbmQ9XFxcInZpc2libGU6IGNsZWF2ZUluZm8oKS5sZW5ndGggPiAwXFxcIj5cXG4gICAgICAgICAgICAgICAgICAgIDx0ZCBjb2xzcGFuPTM+PHN0cm9uZz5DbGVhdmU8L3N0cm9uZz48L3RkPlxcbiAgICAgICAgICAgICAgICA8L3RyPlxcbiAgICAgICAgICAgIDwvdGJvZHk+ICAgIFxcbiAgICAgICAgICAgIDx0Ym9keSBkYXRhLWJpbmQ9XFxcImZvcmVhY2g6IGNsZWF2ZUluZm8oKVxcXCI+XFxuICAgICAgICAgICAgICAgIDx0cj48dGQ+UmFkaXVzOjwvdGQ+PHRkIGNsYXNzPVxcXCJ0ZXh0LXJpZ2h0XFxcIj48c3BhbiBkYXRhLWJpbmQ9XFxcImh0bWw6ICRkYXRhLnJhZGl1c1xcXCI+PC9zcGFuPjwvdGQ+PC90cj5cXG4gICAgICAgICAgICAgICAgPHRyPjx0ZD5NYWduaXR1ZGU6PC90ZD48dGQgY2xhc3M9XFxcInRleHQtcmlnaHRcXFwiPjxzcGFuIGRhdGEtYmluZD1cXFwiaHRtbDogKCRkYXRhLm1hZ25pdHVkZSAqIDEwMCkudG9GaXhlZCgyKSArICclJ1xcXCI+PC9zcGFuPjwvdGQ+PC90cj5cXG4gICAgICAgICAgICAgICAgPHRyPlxcbiAgICAgICAgICAgICAgICAgICAgPHRkPkNsZWF2ZSBEYW1hZ2U6PC90ZD5cXG4gICAgICAgICAgICAgICAgICAgIDx0ZCBjbGFzcz1cXFwidGV4dC1yaWdodFxcXCI+PHNwYW4gZGF0YS1iaW5kPVxcXCJodG1sOiAoJGRhdGEubWFnbml0dWRlICogJHBhcmVudC5kYW1hZ2VUb3RhbEluZm8oKS50b3RhbCkudG9GaXhlZCgyKVxcXCI+PC9zcGFuPjwvdGQ+XFxuICAgICAgICAgICAgICAgIDwvdHI+XFxuICAgICAgICAgICAgPC90Ym9keT5cXG4gICAgICAgIFxcbiAgICAgICAgPC90YWJsZT5cXG4gICAgPC9kaXY+XFxuPC9kaXY+XCIgfSk7XG5rby5jb21wb25lbnRzLnJlZ2lzdGVyKCdkYW1hZ2UtYW1wJywgeyB0ZW1wbGF0ZTogXCI8ZGl2IGNsYXNzPVxcXCJjb2wtbWQtMTJcXFwiPlxcbiAgICA8aDMgY2xhc3M9XFxcInNlY3Rpb25faGVhZGVyXFxcIiBkYXRhLWJpbmQ9XFxcInRvZ2dsZTogc2VjdGlvbkRpc3BsYXkoKS5kYW1hZ2VhbXAsIGNzczogeyBzZWN0aW9uX2Rpc2FibGVkOiAhc2VjdGlvbkRpc3BsYXkoKS5kYW1hZ2VhbXAoKSB9XFxcIj5EYW1hZ2UgQW1wbGlmaWNhdGlvbiAmIFJlZHVjdGlvbjwvaDM+XFxuICAgIDxkaXYgZGF0YS1iaW5kPVxcXCJ2aXNpYmxlOiBzZWN0aW9uRGlzcGxheSgpLmRhbWFnZWFtcCgpLCBsYXp5QmluZGluZzogc2VjdGlvbkRpc3BsYXkoKS5kYW1hZ2VhbXBcXFwiPlxcbiAgICAgICAgPGRpdiBjbGFzcz1cXFwiZm9ybS1ob3Jpem9udGFsXFxcIj5cXG4gICAgICAgICAgICA8ZGl2IGNsYXNzPVxcXCJmb3JtLWdyb3VwXFxcIj5cXG4gICAgICAgICAgICAgICAgICAgIDxkaXYgY2xhc3M9XFxcImNvbC1tZC0zIGNvbnRyb2wtbGFiZWxcXFwiPlxcbiAgICAgICAgICAgICAgICAgICAgICAgIDxsYWJlbCBmb3I9XFxcImRhbWFnZWlucHV0XFxcIj5EYW1hZ2U8L2xhYmVsPlxcbiAgICAgICAgICAgICAgICAgICAgPC9kaXY+XFxuICAgICAgICAgICAgICAgICAgICA8ZGl2IGNsYXNzPVxcXCJjb2wtbWQtNlxcXCI+XFxuICAgICAgICAgICAgICAgICAgICAgICAgPGlucHV0IGNsYXNzPVxcXCJmb3JtLWNvbnRyb2xcXFwiIGlkPVxcXCJkYW1hZ2VpbnB1dFxcXCIgZGF0YS1iaW5kPVxcXCJ2YWx1ZTogZGFtYWdlSW5wdXRWYWx1ZVxcXCIgLz5cXG4gICAgICAgICAgICAgICAgICAgIDwvZGl2PlxcbiAgICAgICAgICAgIDwvZGl2PlxcbiAgICAgICAgPC9kaXY+XFxuICAgICAgICA8ZGl2IGNsYXNzPVxcXCJmb3JtLWhvcml6b250YWxcXFwiPlxcbiAgICAgICAgICAgIDxkaXYgY2xhc3M9XFxcImZvcm0tZ3JvdXBcXFwiPlxcbiAgICAgICAgICAgICAgICAgICAgPGRpdiBjbGFzcz1cXFwiY29sLW1kLTMgY29udHJvbC1sYWJlbFxcXCI+XFxuICAgICAgICAgICAgICAgICAgICAgICAgPGxhYmVsIGZvcj1cXFwiYnVmZmFtcHNlbGVjdFxcXCI+QW1wbGlmaWNhdGlvbjwvbGFiZWw+XFxuICAgICAgICAgICAgICAgICAgICA8L2Rpdj5cXG4gICAgICAgICAgICAgICAgICAgIDxkaXYgY2xhc3M9XFxcImNvbC1tZC01XFxcIj5cXG4gICAgICAgICAgICAgICAgICAgICAgICA8c2VsZWN0IGlkPVxcXCJidWZmYW1wc2VsZWN0XFxcIiBjbGFzcz1cXFwiZm9ybS1jb250cm9sXFxcIiBkYXRhLWJpbmQ9XFxcIm9wdGlvbnM6IGRhbWFnZUFtcGxpZmljYXRpb24uYXZhaWxhYmxlQnVmZnMgLCBvcHRpb25zVGV4dDogJ2J1ZmZEaXNwbGF5TmFtZScsIHZhbHVlOiBkYW1hZ2VBbXBsaWZpY2F0aW9uLnNlbGVjdGVkQnVmZlxcXCI+PC9zZWxlY3Q+XFxuICAgICAgICAgICAgICAgICAgICA8L2Rpdj5cXG4gICAgICAgICAgICAgICAgICAgIDxkaXYgY2xhc3M9XFxcImNvbC1tZC00XFxcIj5cXG4gICAgICAgICAgICAgICAgICAgICAgICA8YnV0dG9uIGNsYXNzPVxcXCJidG4gYnRuLWRlZmF1bHRcXFwiIGRhdGEtYmluZD1cXFwiY2xpY2s6IGRhbWFnZUFtcGxpZmljYXRpb24uYWRkQnVmZlxcXCI+QWRkPC9idXR0b24+XFxuICAgICAgICAgICAgICAgICAgICAgICAgPGJ1dHRvbiBjbGFzcz1cXFwiYnRuIGJ0bi1kZWZhdWx0XFxcIiBkYXRhLWJpbmQ9XFxcImNsaWNrOiBmdW5jdGlvbihkYXRhLGV2ZW50KSB7IGRhbWFnZUFtcGxpZmljYXRpb24ucmVtb3ZlQnVmZihkYXRhLCBldmVudCwgZGFtYWdlQW1wbGlmaWNhdGlvbi5zZWxlY3RlZEJ1ZmYoKS5idWZmTmFtZSkgfVxcXCI+UmVtb3ZlPC9idXR0b24+XFxuICAgICAgICAgICAgICAgICAgICA8L2Rpdj5cXG4gICAgICAgICAgICA8L2Rpdj5cXG4gICAgICAgIDwvZGl2PlxcbiAgICAgICAgPGRpdiBjbGFzcz1cXFwicm93XFxcIiBkYXRhLWJpbmQ9XFxcImZvcmVhY2g6IGRhbWFnZUFtcGxpZmljYXRpb24uYnVmZnNcXFwiPlxcbiAgICAgICAgICAgIDxkaXYgZGF0YS1iaW5kPVxcXCJjc3M6IHtyb3c6ICRkYXRhLmRhdGEuaXNEZXRhaWwoKSB8fCAoJGluZGV4KCkgPCAkcGFyZW50LmRhbWFnZUFtcGxpZmljYXRpb24uYnVmZnMoKS5sZW5ndGgtMSAmJiAkcGFyZW50LmRhbWFnZUFtcGxpZmljYXRpb24uYnVmZnMoKVskaW5kZXgoKSsxXS5kYXRhLmlzRGV0YWlsKCkpLCByb3cyOiAkZGF0YS5kYXRhLmlzRGV0YWlsKCkgfHwgKCRpbmRleCgpIDwgJHBhcmVudC5kYW1hZ2VBbXBsaWZpY2F0aW9uLmJ1ZmZzKCkubGVuZ3RoLTEgJiYgJHBhcmVudC5kYW1hZ2VBbXBsaWZpY2F0aW9uLmJ1ZmZzKClbJGluZGV4KCkrMV0uZGF0YS5pc0RldGFpbCgpKSB9XFxcIj5cXG4gICAgICAgICAgICAgICAgPGRpdiBjbGFzcz1cXFwiY29sLW1kLTMgdGV4dC1jZW50ZXIgYm90dG9tLWJ1ZmZlciByb3cyXFxcIiBkYXRhLWJpbmQ9XFxcImNzczogeydjb2wtbWQtMyc6ICRyb290LmxheW91dCgpID09IDAsICdjb2wtbWQtMic6ICRyb290LmxheW91dCgpID09IDF9XFxcIj5cXG4gICAgICAgICAgICAgICAgICAgIDxpbWcgc3R5bGU9XFxcInBhZGRpbmc6MHB4O21hcmdpbi1ib3R0b206MXB4O1xcXCIgY2xhc3M9XFxcImltZy1yb3VuZGVkIGFiaWxpdHlcXFwiIGRhdGEtYmluZD1cXFwiY3NzOiB7IGFiaWxpdHlfYWN0aXZlOiAkZGF0YS5kYXRhLmlzQWN0aXZlKCkgfHwgJGRhdGEuZGF0YS5iZWhhdmlvci5pbmRleE9mKCdET1RBX0FCSUxJVFlfQkVIQVZJT1JfUEFTU0lWRScpICE9IC0xLCBhYmlsaXR5X2luYWN0aXZlOiAhJGRhdGEuZGF0YS5pc0FjdGl2ZSgpICYmICRkYXRhLmRhdGEuYmVoYXZpb3IuaW5kZXhPZignRE9UQV9BQklMSVRZX0JFSEFWSU9SX1BBU1NJVkUnKSA9PSAtMSwgYnRuOiAkZGF0YS5kYXRhLmJlaGF2aW9yLmluZGV4T2YoJ0RPVEFfQUJJTElUWV9CRUhBVklPUl9QQVNTSVZFJykgPT0gLTEsICdidG4tZGVmYXVsdCc6ICRkYXRhLmRhdGEuYmVoYXZpb3IuaW5kZXhPZignRE9UQV9BQklMSVRZX0JFSEFWSU9SX1BBU1NJVkUnKSA9PSAtMX0sIGF0dHI6e3NyYzogJy9tZWRpYS9pbWFnZXMvc3BlbGxpY29ucy8nICsgJGRhdGEuZGF0YS5uYW1lICsgJy5wbmcnfSwgY2xpY2s6IGZ1bmN0aW9uKGRhdGEsIGV2ZW50KSB7ICRwYXJlbnQuZGFtYWdlQW1wbGlmaWNhdGlvbi50b2dnbGVCdWZmKCRpbmRleCwgZGF0YS5kYXRhLCBldmVudCk7IH0sIGV2ZW50OiB7IGRibGNsaWNrOiBmdW5jdGlvbihkYXRhLGV2ZW50KSB7ICRwYXJlbnQuZGFtYWdlQW1wbGlmaWNhdGlvbi5yZW1vdmVCdWZmKGRhdGEsIGV2ZW50LCAkZGF0YS5kYXRhLm5hbWUpIH0gfVxcXCIvPlxcbiAgICAgICAgICAgICAgICAgICAgPGRpdiBjbGFzcz1cXFwicHJvZ3Jlc3NcXFwiIHN0eWxlPVxcXCJwb3NpdGlvbjpyZWxhdGl2ZVxcXCI+XFxuICAgICAgICAgICAgICAgICAgICAgICAgPGRpdiBzdHlsZT1cXFwicG9zaXRpb246YWJzb2x1dGU7d2lkdGg6MTAwJTtjb2xvcjp3aGl0ZTtcXFwiIGNsYXNzPVxcXCJ0ZXh0LWNlbnRlclxcXCIgZGF0YS1iaW5kPVxcXCJ2aXNpYmxlOiAkcGFyZW50LmdldEFiaWxpdHlMZXZlbE1heCgkZGF0YS5kYXRhKSA+IDAsIHRleHQ6ICRkYXRhLmRhdGEubGV2ZWwoKSArICcvJyArICRwYXJlbnQuZ2V0QWJpbGl0eUxldmVsTWF4KCRkYXRhLmRhdGEpXFxcIj48L2Rpdj5cXG4gICAgICAgICAgICAgICAgICAgICAgICA8ZGl2IGNsYXNzPVxcXCJwcm9ncmVzcy1iYXIgcHJvZ3Jlc3MtYmFyLWRhbmdlclxcXCIgcm9sZT1cXFwicHJvZ3Jlc3NiYXJcXFwiIGFyaWEtdmFsdWVub3c9XFxcIjYwXFxcIiBhcmlhLXZhbHVlbWluPVxcXCIwXFxcIiBhcmlhLXZhbHVlbWF4PVxcXCIxMDBcXFwiIHN0eWxlPVxcXCJ3aWR0aDogNjAlO1xcXCIgZGF0YS1iaW5kPVxcXCJhdHRyOiB7ICdhcmlhLXZhbHVlbm93JzogKCRwYXJlbnQuZ2V0QWJpbGl0eUxldmVsTWF4KCRkYXRhLmRhdGEpID4gMCA/ICRkYXRhLmRhdGEubGV2ZWwoKS8kcGFyZW50LmdldEFiaWxpdHlMZXZlbE1heCgkZGF0YS5kYXRhKSoxMDAgOiAwKSB9LCBzdHlsZTogeyB3aWR0aDogKCRwYXJlbnQuZ2V0QWJpbGl0eUxldmVsTWF4KCRkYXRhLmRhdGEpID4gMCA/ICRkYXRhLmRhdGEubGV2ZWwoKS8kcGFyZW50LmdldEFiaWxpdHlMZXZlbE1heCgkZGF0YS5kYXRhKSoxMDAgOiAwKSArICclJyB9XFxcIj48L2Rpdj5cXG4gICAgICAgICAgICAgICAgICAgIDwvZGl2PlxcbiAgICAgICAgICAgICAgICAgICAgPGRpdiBjbGFzcz1cXFwiYnRuLWdyb3VwIGJ0bi1ncm91cC1qdXN0aWZpZWRcXFwiIGRhdGEtYmluZD1cXFwiaWY6ICRkYXRhLmRhdGEuYmVoYXZpb3IuaW5kZXhPZignRE9UQV9BQklMSVRZX0JFSEFWSU9SX05PVF9MRUFSTkFCTEUnKSA9PSAtMVxcXCI+XFxuICAgICAgICAgICAgICAgICAgICAgICAgPGEgY2xhc3M9XFxcImJ0biBidG4tZGVmYXVsdCBidG4tc21cXFwiIGRhdGEtYmluZD1cXFwiY2xpY2s6IGZ1bmN0aW9uKGRhdGEsIGV2ZW50KSB7ICRwYXJlbnQuZGFtYWdlQW1wbGlmaWNhdGlvbi5sZXZlbERvd25BYmlsaXR5KCRpbmRleCwgZGF0YS5kYXRhLCBldmVudCwgJHBhcmVudCk7IH1cXFwiPi08L2E+XFxuICAgICAgICAgICAgICAgICAgICAgICAgPGEgY2xhc3M9XFxcImJ0biBidG4tZGVmYXVsdCBidG4tc21cXFwiIGRhdGEtYmluZD1cXFwiY2xpY2s6IGZ1bmN0aW9uKGRhdGEsIGV2ZW50KSB7ICRwYXJlbnQuZGFtYWdlQW1wbGlmaWNhdGlvbi5sZXZlbFVwQWJpbGl0eSgkaW5kZXgsIGRhdGEuZGF0YSwgZXZlbnQsICRwYXJlbnQpOyB9XFxcIj4rPC9hPlxcbiAgICAgICAgICAgICAgICAgICAgPC9kaXY+XFxuICAgICAgICAgICAgICAgICAgICA8ZGl2IGNsYXNzPVxcXCJidG4tZ3JvdXAgYnRuLWdyb3VwLWp1c3RpZmllZFxcXCI+XFxuICAgICAgICAgICAgICAgICAgICAgICAgPGEgY2xhc3M9XFxcImJ0biBidG4tZGVmYXVsdCBidG4tc21cXFwiIGRhdGEtYmluZD1cXFwiY2xpY2s6IGZ1bmN0aW9uKGRhdGEsIGV2ZW50KSB7ICRwYXJlbnQuZGFtYWdlQW1wbGlmaWNhdGlvbi50b2dnbGVCdWZmRGV0YWlsKCRpbmRleCwgZGF0YSwgZXZlbnQpOyB9LCBjc3M6IHsndG9nZ2xlZCc6ICRkYXRhLmRhdGEuaXNEZXRhaWx9XFxcIj5EZXRhaWxzPC9hPlxcbiAgICAgICAgICAgICAgICAgICAgPC9kaXY+XFxuICAgICAgICAgICAgICAgIDwvZGl2PlxcbiAgICAgICAgICAgICAgICA8ZGl2IGNsYXNzPVxcXCJjb2wtbWQtOSBib3R0b20tYnVmZmVyXFxcIiBkYXRhLWJpbmQ9XFxcInZpc2libGU6ICRkYXRhLmRhdGEuaXNEZXRhaWwoKVxcXCI+XFxuICAgICAgICAgICAgICAgICAgICA8YnV0dG9uIHR5cGU9XFxcImJ1dHRvblxcXCIgY2xhc3M9XFxcImNsb3NlXFxcIiBkYXRhLWJpbmQ9XFxcImNsaWNrOiBmdW5jdGlvbihkYXRhLCBldmVudCkgeyAkcGFyZW50LmRhbWFnZUFtcGxpZmljYXRpb24udG9nZ2xlQnVmZkRldGFpbCgkaW5kZXgsIGRhdGEuZGF0YSwgZXZlbnQpOyB9XFxcIj4mdGltZXM7PC9idXR0b24+XFxuICAgICAgICAgICAgICAgICAgICA8ZGl2IGRhdGEtYmluZD1cXFwiaHRtbDogJHBhcmVudC5hYmlsaXR5KCkuZ2V0QWJpbGl0eVRvb2x0aXBEYXRhKCRkYXRhLmhlcm8sICRkYXRhLmRhdGEubmFtZSlcXFwiPjwvZGl2PlxcbiAgICAgICAgICAgICAgICAgICAgPGRpdiBkYXRhLWJpbmQ9XFxcImlmOiAkZGF0YS5kYXRhLm5hbWUgaW4gJHBhcmVudC5kYW1hZ2VBbXBsaWZpY2F0aW9uLmFiaWxpdHlEYXRhICYmICRwYXJlbnQuZGFtYWdlQW1wbGlmaWNhdGlvbi5idWZmcygpWyRpbmRleCgpXS5kYXRhLmxldmVsKCkgPiAwXFxcIj5cXG4gICAgICAgICAgICAgICAgICAgICAgICA8ZGl2IGNsYXNzPVxcXCJjb2wtbWQtOFxcXCI+XFxuICAgICAgICAgICAgICAgICAgICAgICAgICAgIDxkaXYgZGF0YS1iaW5kPVxcXCJjb21wb25lbnQ6IHsgbmFtZTogJ2J1ZmYtc2V0dGluZ3MnLCBwYXJhbXM6ICRwYXJlbnQuZGFtYWdlQW1wbGlmaWNhdGlvbi5hYmlsaXR5U2V0dGluZ3NEYXRhKCRkYXRhLmRhdGEubmFtZSwgJHBhcmVudCwgJGluZGV4KCkpIH1cXFwiPjwvZGl2PlxcbiAgICAgICAgICAgICAgICAgICAgICAgIDwvZGl2PlxcbiAgICAgICAgICAgICAgICAgICAgPC9kaXY+XFxuICAgICAgICAgICAgICAgIDwvZGl2PlxcbiAgICAgICAgICAgIDwvZGl2PlxcbiAgICAgICAgPC9kaXY+XFxuICAgICAgICA8ZGl2IGNsYXNzPVxcXCJmb3JtLWhvcml6b250YWxcXFwiPlxcbiAgICAgICAgICAgIDxkaXYgY2xhc3M9XFxcImZvcm0tZ3JvdXBcXFwiPlxcbiAgICAgICAgICAgICAgICAgICAgPGRpdiBjbGFzcz1cXFwiY29sLW1kLTMgY29udHJvbC1sYWJlbFxcXCI+XFxuICAgICAgICAgICAgICAgICAgICAgICAgPGxhYmVsIGZvcj1cXFwiYnVmZnJlZHVjdGlvbnNlbGVjdFxcXCI+UmVkdWN0aW9uPC9sYWJlbD5cXG4gICAgICAgICAgICAgICAgICAgIDwvZGl2PlxcbiAgICAgICAgICAgICAgICAgICAgPGRpdiBjbGFzcz1cXFwiY29sLW1kLTVcXFwiPlxcbiAgICAgICAgICAgICAgICAgICAgICAgIDxzZWxlY3QgaWQ9XFxcImJ1ZmZyZWR1Y3Rpb25zZWxlY3RcXFwiIGNsYXNzPVxcXCJmb3JtLWNvbnRyb2xcXFwiIGRhdGEtYmluZD1cXFwib3B0aW9uczogZGFtYWdlUmVkdWN0aW9uLmF2YWlsYWJsZURlYnVmZnMgLCBvcHRpb25zVGV4dDogJ2J1ZmZEaXNwbGF5TmFtZScsIHZhbHVlOiBkYW1hZ2VSZWR1Y3Rpb24uc2VsZWN0ZWRCdWZmXFxcIj48L3NlbGVjdD5cXG4gICAgICAgICAgICAgICAgICAgIDwvZGl2PlxcbiAgICAgICAgICAgICAgICAgICAgPGRpdiBjbGFzcz1cXFwiY29sLW1kLTRcXFwiPlxcbiAgICAgICAgICAgICAgICAgICAgICAgIDxidXR0b24gY2xhc3M9XFxcImJ0biBidG4tZGVmYXVsdFxcXCIgZGF0YS1iaW5kPVxcXCJjbGljazogZGFtYWdlUmVkdWN0aW9uLmFkZEJ1ZmZcXFwiPkFkZDwvYnV0dG9uPlxcbiAgICAgICAgICAgICAgICAgICAgICAgIDxidXR0b24gY2xhc3M9XFxcImJ0biBidG4tZGVmYXVsdFxcXCIgZGF0YS1iaW5kPVxcXCJjbGljazogZnVuY3Rpb24oZGF0YSxldmVudCkgeyBkYW1hZ2VSZWR1Y3Rpb24ucmVtb3ZlQnVmZihkYXRhLCBldmVudCwgZGFtYWdlUmVkdWN0aW9uLnNlbGVjdGVkQnVmZigpLmJ1ZmZOYW1lKSB9XFxcIj5SZW1vdmU8L2J1dHRvbj5cXG4gICAgICAgICAgICAgICAgICAgIDwvZGl2PlxcbiAgICAgICAgICAgIDwvZGl2PlxcbiAgICAgICAgPC9kaXY+XFxuICAgICAgICA8ZGl2IGNsYXNzPVxcXCJyb3dcXFwiIGRhdGEtYmluZD1cXFwiZm9yZWFjaDogZGFtYWdlUmVkdWN0aW9uLmJ1ZmZzXFxcIj5cXG4gICAgICAgICAgICA8ZGl2IGRhdGEtYmluZD1cXFwiY3NzOiB7cm93OiAkZGF0YS5kYXRhLmlzRGV0YWlsKCkgfHwgKCRpbmRleCgpIDwgJHBhcmVudC5kYW1hZ2VSZWR1Y3Rpb24uYnVmZnMoKS5sZW5ndGgtMSAmJiAkcGFyZW50LmRhbWFnZVJlZHVjdGlvbi5idWZmcygpWyRpbmRleCgpKzFdLmRhdGEuaXNEZXRhaWwoKSksIHJvdzI6ICRkYXRhLmRhdGEuaXNEZXRhaWwoKSB8fCAoJGluZGV4KCkgPCAkcGFyZW50LmRhbWFnZVJlZHVjdGlvbi5idWZmcygpLmxlbmd0aC0xICYmICRwYXJlbnQuZGFtYWdlUmVkdWN0aW9uLmJ1ZmZzKClbJGluZGV4KCkrMV0uZGF0YS5pc0RldGFpbCgpKSB9XFxcIj5cXG4gICAgICAgICAgICAgICAgPGRpdiBjbGFzcz1cXFwiY29sLW1kLTMgdGV4dC1jZW50ZXIgYm90dG9tLWJ1ZmZlciByb3cyXFxcIiBkYXRhLWJpbmQ9XFxcImNzczogeydjb2wtbWQtMyc6ICRyb290LmxheW91dCgpID09IDAsICdjb2wtbWQtMic6ICRyb290LmxheW91dCgpID09IDF9XFxcIj5cXG4gICAgICAgICAgICAgICAgICAgIDxpbWcgc3R5bGU9XFxcInBhZGRpbmc6MHB4O21hcmdpbi1ib3R0b206MXB4O1xcXCIgY2xhc3M9XFxcImltZy1yb3VuZGVkIGFiaWxpdHlcXFwiIGRhdGEtYmluZD1cXFwiY3NzOiB7IGFiaWxpdHlfYWN0aXZlOiAkZGF0YS5kYXRhLmlzQWN0aXZlKCkgfHwgJGRhdGEuZGF0YS5iZWhhdmlvci5pbmRleE9mKCdET1RBX0FCSUxJVFlfQkVIQVZJT1JfUEFTU0lWRScpICE9IC0xLCBhYmlsaXR5X2luYWN0aXZlOiAhJGRhdGEuZGF0YS5pc0FjdGl2ZSgpICYmICRkYXRhLmRhdGEuYmVoYXZpb3IuaW5kZXhPZignRE9UQV9BQklMSVRZX0JFSEFWSU9SX1BBU1NJVkUnKSA9PSAtMSwgYnRuOiAkZGF0YS5kYXRhLmJlaGF2aW9yLmluZGV4T2YoJ0RPVEFfQUJJTElUWV9CRUhBVklPUl9QQVNTSVZFJykgPT0gLTEsICdidG4tZGVmYXVsdCc6ICRkYXRhLmRhdGEuYmVoYXZpb3IuaW5kZXhPZignRE9UQV9BQklMSVRZX0JFSEFWSU9SX1BBU1NJVkUnKSA9PSAtMX0sIGF0dHI6e3NyYzogJy9tZWRpYS9pbWFnZXMvc3BlbGxpY29ucy8nICsgJGRhdGEuZGF0YS5uYW1lICsgJy5wbmcnfSwgY2xpY2s6IGZ1bmN0aW9uKGRhdGEsIGV2ZW50KSB7ICRwYXJlbnQuZGFtYWdlUmVkdWN0aW9uLnRvZ2dsZUJ1ZmYoJGluZGV4LCBkYXRhLmRhdGEsIGV2ZW50KTsgfSwgZXZlbnQ6IHsgZGJsY2xpY2s6IGZ1bmN0aW9uKGRhdGEsZXZlbnQpIHsgJHBhcmVudC5kYW1hZ2VSZWR1Y3Rpb24ucmVtb3ZlQnVmZihkYXRhLCBldmVudCwgJGRhdGEuZGF0YS5uYW1lKSB9IH1cXFwiLz5cXG4gICAgICAgICAgICAgICAgICAgIDxkaXYgY2xhc3M9XFxcInByb2dyZXNzXFxcIiBzdHlsZT1cXFwicG9zaXRpb246cmVsYXRpdmVcXFwiPlxcbiAgICAgICAgICAgICAgICAgICAgICAgIDxkaXYgc3R5bGU9XFxcInBvc2l0aW9uOmFic29sdXRlO3dpZHRoOjEwMCU7Y29sb3I6d2hpdGU7XFxcIiBjbGFzcz1cXFwidGV4dC1jZW50ZXJcXFwiIGRhdGEtYmluZD1cXFwidmlzaWJsZTogJHBhcmVudC5nZXRBYmlsaXR5TGV2ZWxNYXgoJGRhdGEuZGF0YSkgPiAwLCB0ZXh0OiAkZGF0YS5kYXRhLmxldmVsKCkgKyAnLycgKyAkcGFyZW50LmdldEFiaWxpdHlMZXZlbE1heCgkZGF0YS5kYXRhKVxcXCI+PC9kaXY+XFxuICAgICAgICAgICAgICAgICAgICAgICAgPGRpdiBjbGFzcz1cXFwicHJvZ3Jlc3MtYmFyIHByb2dyZXNzLWJhci1kYW5nZXJcXFwiIHJvbGU9XFxcInByb2dyZXNzYmFyXFxcIiBhcmlhLXZhbHVlbm93PVxcXCI2MFxcXCIgYXJpYS12YWx1ZW1pbj1cXFwiMFxcXCIgYXJpYS12YWx1ZW1heD1cXFwiMTAwXFxcIiBzdHlsZT1cXFwid2lkdGg6IDYwJTtcXFwiIGRhdGEtYmluZD1cXFwiYXR0cjogeyAnYXJpYS12YWx1ZW5vdyc6ICgkcGFyZW50LmdldEFiaWxpdHlMZXZlbE1heCgkZGF0YS5kYXRhKSA+IDAgPyAkZGF0YS5kYXRhLmxldmVsKCkvJHBhcmVudC5nZXRBYmlsaXR5TGV2ZWxNYXgoJGRhdGEuZGF0YSkqMTAwIDogMCkgfSwgc3R5bGU6IHsgd2lkdGg6ICgkcGFyZW50LmdldEFiaWxpdHlMZXZlbE1heCgkZGF0YS5kYXRhKSA+IDAgPyAkZGF0YS5kYXRhLmxldmVsKCkvJHBhcmVudC5nZXRBYmlsaXR5TGV2ZWxNYXgoJGRhdGEuZGF0YSkqMTAwIDogMCkgKyAnJScgfVxcXCI+PC9kaXY+XFxuICAgICAgICAgICAgICAgICAgICA8L2Rpdj5cXG4gICAgICAgICAgICAgICAgICAgIDxkaXYgY2xhc3M9XFxcImJ0bi1ncm91cCBidG4tZ3JvdXAtanVzdGlmaWVkXFxcIiBkYXRhLWJpbmQ9XFxcImlmOiAkZGF0YS5kYXRhLmJlaGF2aW9yLmluZGV4T2YoJ0RPVEFfQUJJTElUWV9CRUhBVklPUl9OT1RfTEVBUk5BQkxFJykgPT0gLTFcXFwiPlxcbiAgICAgICAgICAgICAgICAgICAgICAgIDxhIGNsYXNzPVxcXCJidG4gYnRuLWRlZmF1bHQgYnRuLXNtXFxcIiBkYXRhLWJpbmQ9XFxcImNsaWNrOiBmdW5jdGlvbihkYXRhLCBldmVudCkgeyAkcGFyZW50LmRhbWFnZVJlZHVjdGlvbi5sZXZlbERvd25BYmlsaXR5KCRpbmRleCwgZGF0YS5kYXRhLCBldmVudCwgJHBhcmVudCk7IH1cXFwiPi08L2E+XFxuICAgICAgICAgICAgICAgICAgICAgICAgPGEgY2xhc3M9XFxcImJ0biBidG4tZGVmYXVsdCBidG4tc21cXFwiIGRhdGEtYmluZD1cXFwiY2xpY2s6IGZ1bmN0aW9uKGRhdGEsIGV2ZW50KSB7ICRwYXJlbnQuZGFtYWdlUmVkdWN0aW9uLmxldmVsVXBBYmlsaXR5KCRpbmRleCwgZGF0YS5kYXRhLCBldmVudCwgJHBhcmVudCk7IH1cXFwiPis8L2E+XFxuICAgICAgICAgICAgICAgICAgICA8L2Rpdj5cXG4gICAgICAgICAgICAgICAgICAgIDxkaXYgY2xhc3M9XFxcImJ0bi1ncm91cCBidG4tZ3JvdXAtanVzdGlmaWVkXFxcIj5cXG4gICAgICAgICAgICAgICAgICAgICAgICA8YSBjbGFzcz1cXFwiYnRuIGJ0bi1kZWZhdWx0IGJ0bi1zbVxcXCIgZGF0YS1iaW5kPVxcXCJjbGljazogZnVuY3Rpb24oZGF0YSwgZXZlbnQpIHsgJHBhcmVudC5kYW1hZ2VSZWR1Y3Rpb24udG9nZ2xlQnVmZkRldGFpbCgkaW5kZXgsIGRhdGEsIGV2ZW50KTsgfSwgY3NzOiB7J3RvZ2dsZWQnOiAkZGF0YS5kYXRhLmlzRGV0YWlsfVxcXCI+RGV0YWlsczwvYT5cXG4gICAgICAgICAgICAgICAgICAgIDwvZGl2PlxcbiAgICAgICAgICAgICAgICA8L2Rpdj5cXG4gICAgICAgICAgICAgICAgPGRpdiBjbGFzcz1cXFwiY29sLW1kLTkgYm90dG9tLWJ1ZmZlclxcXCIgZGF0YS1iaW5kPVxcXCJ2aXNpYmxlOiAkZGF0YS5kYXRhLmlzRGV0YWlsKClcXFwiPlxcbiAgICAgICAgICAgICAgICAgICAgPGJ1dHRvbiB0eXBlPVxcXCJidXR0b25cXFwiIGNsYXNzPVxcXCJjbG9zZVxcXCIgZGF0YS1iaW5kPVxcXCJjbGljazogZnVuY3Rpb24oZGF0YSwgZXZlbnQpIHsgJHBhcmVudC5kYW1hZ2VSZWR1Y3Rpb24udG9nZ2xlQnVmZkRldGFpbCgkaW5kZXgsIGRhdGEuZGF0YSwgZXZlbnQpOyB9XFxcIj4mdGltZXM7PC9idXR0b24+XFxuICAgICAgICAgICAgICAgICAgICA8ZGl2IGRhdGEtYmluZD1cXFwiaHRtbDogJHBhcmVudC5hYmlsaXR5KCkuZ2V0QWJpbGl0eVRvb2x0aXBEYXRhKCRkYXRhLmhlcm8sICRkYXRhLmRhdGEubmFtZSlcXFwiPjwvZGl2PlxcbiAgICAgICAgICAgICAgICAgICAgPGRpdiBkYXRhLWJpbmQ9XFxcImlmOiAkZGF0YS5kYXRhLm5hbWUgaW4gJHBhcmVudC5kYW1hZ2VSZWR1Y3Rpb24uYWJpbGl0eURhdGEgJiYgJHBhcmVudC5kYW1hZ2VSZWR1Y3Rpb24uYnVmZnMoKVskaW5kZXgoKV0uZGF0YS5sZXZlbCgpID4gMFxcXCI+XFxuICAgICAgICAgICAgICAgICAgICAgICAgPGRpdiBjbGFzcz1cXFwiY29sLW1kLThcXFwiPlxcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICA8ZGl2IGRhdGEtYmluZD1cXFwiY29tcG9uZW50OiB7IG5hbWU6ICdidWZmLXNldHRpbmdzJywgcGFyYW1zOiAkcGFyZW50LmRhbWFnZVJlZHVjdGlvbi5hYmlsaXR5U2V0dGluZ3NEYXRhKCRkYXRhLmRhdGEubmFtZSwgJHBhcmVudCwgJGluZGV4KCkpIH1cXFwiPjwvZGl2PlxcbiAgICAgICAgICAgICAgICAgICAgICAgIDwvZGl2PlxcbiAgICAgICAgICAgICAgICAgICAgPC9kaXY+XFxuICAgICAgICAgICAgICAgIDwvZGl2PlxcbiAgICAgICAgICAgIDwvZGl2PlxcbiAgICAgICAgPC9kaXY+XFxuICAgICAgICBcXG4gICAgICAgIDxoND5DYWxjdWxhdGlvbnMgPGEgY2xhc3M9XFxcImJ0biBidG4tZGVmYXVsdCBidG4teHNcXFwiIGRhdGEtYmluZD1cXFwidG9nZ2xlOiBzaG93RGFtYWdlQW1wQ2FsY0RldGFpbHMsIHRleHQ6ICFzaG93RGFtYWdlQW1wQ2FsY0RldGFpbHMoKSA/ICdTaG93IGRldGFpbHMnIDogJ0hpZGUgZGV0YWlscydcXFwiPjwvYT48L2g0PlxcbiAgICAgICAgPHRhYmxlIGNsYXNzPVxcXCJ0YWJsZVxcXCI+XFxuICAgICAgICAgICAgPHRib2R5PlxcbiAgICAgICAgICAgICAgICA8IS0tIGtvIGZvcmVhY2g6IGRhbWFnZUlucHV0TW9kaWZpZWQoKS5kYXRhIC0tPlxcbiAgICAgICAgICAgICAgICA8dHIgZGF0YS1iaW5kPVxcXCJ2aXNpYmxlOiAkcGFyZW50LnNob3dEYW1hZ2VBbXBDYWxjRGV0YWlscygpXFxcIj5cXG4gICAgICAgICAgICAgICAgICAgIDx0ZD48c3BhbiBzdHlsZT1cXFwidGV4dC1kZWNvcmF0aW9uOiB1bmRlcmxpbmU7XFxcIiBkYXRhLWJpbmQ9XFxcInRleHQ6ICRkYXRhLmxhYmVsICsgJyBkYW1hZ2UnXFxcIj48L3NwYW4+PC90ZD5cXG4gICAgICAgICAgICAgICAgICAgIDx0ZCBjbGFzcz1cXFwidGV4dC1yaWdodFxcXCI+PHNwYW4gZGF0YS1iaW5kPVxcXCJodG1sOiBNYXRoLnJvdW5kKCRkYXRhLnZhbHVlICogMTAwKSAvIDEwMCwgc3R5bGU6IHtjb2xvcjogJHBhcmVudC5nZXREYW1hZ2VUeXBlQ29sb3IoJGRhdGEuZGFtYWdlVHlwZSl9XFxcIj48L3NwYW4+PC90ZD5cXG4gICAgICAgICAgICAgICAgPC90cj5cXG4gICAgICAgICAgICAgICAgICAgIDwhLS0ga28gZm9yZWFjaDogJGRhdGEuZGF0YSAtLT5cXG4gICAgICAgICAgICAgICAgICAgIDx0ciBkYXRhLWJpbmQ9XFxcInZpc2libGU6ICRwYXJlbnRzWzFdLnNob3dEYW1hZ2VBbXBDYWxjRGV0YWlscygpXFxcIj5cXG4gICAgICAgICAgICAgICAgICAgICAgICA8dGQ+PHNwYW4gZGF0YS1iaW5kPVxcXCJ0ZXh0OiAkZGF0YS5sYWJlbFxcXCI+PC9zcGFuPjwvdGQ+XFxuICAgICAgICAgICAgICAgICAgICAgICAgPHRkIGNsYXNzPVxcXCJ0ZXh0LXJpZ2h0XFxcIj48c3BhbiBkYXRhLWJpbmQ9XFxcImh0bWw6IE1hdGgucm91bmQoJGRhdGEudmFsdWUgKiAxMDApIC8gMTAwLCBkaWZmU3R5bGU6ICRkYXRhLnZhbHVlXFxcIj48L3NwYW4+PC90ZD5cXG4gICAgICAgICAgICAgICAgICAgIDwvdHI+XFxuICAgICAgICAgICAgICAgICAgICA8IS0tIC9rbyAtLT5cXG4gICAgICAgICAgICAgICAgPHRyIGRhdGEtYmluZD1cXFwiY3NzOiB7c3VidG90YWw6ICRwYXJlbnQuc2hvd0RhbWFnZUFtcENhbGNEZXRhaWxzKCl9XFxcIj5cXG4gICAgICAgICAgICAgICAgICAgIDx0ZCBkYXRhLWJpbmQ9XFxcInZpc2libGU6ICRwYXJlbnQuc2hvd0RhbWFnZUFtcENhbGNEZXRhaWxzKClcXFwiPjxzcGFuIGRhdGEtYmluZD1cXFwidGV4dDogJGRhdGEubGFiZWwgKyAnIGRhbWFnZSBzdWJ0b3RhbCdcXFwiPjwvc3Bhbj48L3RkPlxcbiAgICAgICAgICAgICAgICAgICAgPHRkIGRhdGEtYmluZD1cXFwidmlzaWJsZTogISRwYXJlbnQuc2hvd0RhbWFnZUFtcENhbGNEZXRhaWxzKClcXFwiPjxzcGFuIGRhdGEtYmluZD1cXFwidGV4dDogJGRhdGEubGFiZWwgKyAnIGRhbWFnZSdcXFwiPjwvc3Bhbj48L3RkPlxcbiAgICAgICAgICAgICAgICAgICAgPHRkIGNsYXNzPVxcXCJ0ZXh0LXJpZ2h0XFxcIj48c3BhbiBkYXRhLWJpbmQ9XFxcImh0bWw6IE1hdGgucm91bmQoJGRhdGEudG90YWwgKiAxMDApIC8gMTAwLCBzdHlsZToge2NvbG9yOiAkcGFyZW50LmdldERhbWFnZVR5cGVDb2xvcigkZGF0YS5kYW1hZ2VUeXBlKX1cXFwiPjwvc3Bhbj48L3RkPlxcbiAgICAgICAgICAgICAgICA8L3RyPlxcbiAgICAgICAgICAgICAgICA8IS0tIC9rbyAtLT5cXG4gICAgICAgICAgICAgICAgPHRyPlxcbiAgICAgICAgICAgICAgICAgICAgPHRkPjxzdHJvbmcgZGF0YS1iaW5kPVxcXCJ0ZXh0OiBkYW1hZ2VJbnB1dE1vZGlmaWVkKCkubGFiZWwgKyAnIGRhbWFnZSdcXFwiPjwvc3Ryb25nPjwvdGQ+XFxuICAgICAgICAgICAgICAgICAgICA8dGQgY2xhc3M9XFxcInRleHQtcmlnaHRcXFwiPjxzdHJvbmcgZGF0YS1iaW5kPVxcXCJodG1sOiBNYXRoLnJvdW5kKGRhbWFnZUlucHV0TW9kaWZpZWQoKS50b3RhbCAqIDEwMCkgLyAxMDAsIHN0eWxlOiB7Y29sb3I6IGdldERhbWFnZVR5cGVDb2xvcihkYW1hZ2VJbnB1dE1vZGlmaWVkKCkuZGFtYWdlVHlwZSl9XFxcIj48L3N0cm9uZz48L3RkPlxcbiAgICAgICAgICAgICAgICA8L3RyPlxcbiAgICAgICAgICAgIDwvdGJvZHk+XFxuICAgICAgICA8L3RhYmxlPlxcbiAgICA8L2Rpdj5cXG48L2Rpdj5cIiB9KTtcbmtvLmNvbXBvbmVudHMucmVnaXN0ZXIoJ2FiaWxpdHknLCB7IHRlbXBsYXRlOiBcIjxkaXYgZGF0YS1iaW5kPVxcXCJpZjogJGRhdGEuZGlzcGxheW5hbWUgIT0gJ0VtcHR5JyAmJiAgKCRkYXRhLmJlaGF2aW9yLmluZGV4T2YoJ0RPVEFfQUJJTElUWV9CRUhBVklPUl9ISURERU4nKSA9PSAtMSB8fCAkZGF0YS5uYW1lLmluZGV4T2YoJ2ludm9rZXJfJykgIT0gLTEpLFxcbnN0eWxlOiB7Y2xlYXI6ICRkYXRhLm5hbWUgPT0gJ2ludm9rZXJfY29sZF9zbmFwJyB8fCAkZGF0YS5uYW1lID09ICdpbnZva2VyX2NoYW9zX21ldGVvcicgPyAnYm90aCcgOiAnJ30sXFxuY3NzOiB7cm93OiAkZGF0YS5pc0RldGFpbCgpIHx8ICgkaW5kZXgoKSA8ICRwYXJlbnRzWzFdLmFiaWxpdHkoKS5hYmlsaXRpZXMoKS5sZW5ndGgtMSAmJiAkcGFyZW50c1sxXS5hYmlsaXR5KCkuYWJpbGl0aWVzKClbJGluZGV4KCkrMV0uaXNEZXRhaWwoKSksIHJvdzM6ICRkYXRhLmlzRGV0YWlsKCkgfHwgKCRpbmRleCgpIDwgJHBhcmVudHNbMV0uYWJpbGl0eSgpLmFiaWxpdGllcygpLmxlbmd0aC0xICYmICRwYXJlbnRzWzFdLmFiaWxpdHkoKS5hYmlsaXRpZXMoKVskaW5kZXgoKSsxXS5pc0RldGFpbCgpKSB9XFxcIj5cXG4gICAgPGRpdiBjbGFzcz1cXFwiY29sLW1kLTMgdGV4dC1jZW50ZXIgYm90dG9tLWJ1ZmZlciByb3cyXFxcIiBkYXRhLWJpbmQ9XFxcImNzczogeydjb2wtbWQtMyc6ICRyb290LmxheW91dCgpID09IDAsICdjb2wtbWQtMic6ICRyb290LmxheW91dCgpID09IDF9XFxcIj5cXG4gICAgICAgIDxpbWcgc3R5bGU9XFxcInBhZGRpbmc6MHB4O21hcmdpbi1ib3R0b206MXB4O1xcXCIgY2xhc3M9XFxcImltZy1yb3VuZGVkIGFiaWxpdHlcXFwiIGRhdGEtYmluZD1cXFwiY3NzOiB7IGFiaWxpdHlfYWN0aXZlOiAkZGF0YS5pc0FjdGl2ZSgpIHx8ICRkYXRhLmJlaGF2aW9yLmluZGV4T2YoJ0RPVEFfQUJJTElUWV9CRUhBVklPUl9QQVNTSVZFJykgIT0gLTEsIGFiaWxpdHlfaW5hY3RpdmU6ICEkZGF0YS5pc0FjdGl2ZSgpICYmICRkYXRhLmJlaGF2aW9yLmluZGV4T2YoJ0RPVEFfQUJJTElUWV9CRUhBVklPUl9QQVNTSVZFJykgPT0gLTEsIGJ0bjogJGRhdGEuYmVoYXZpb3IuaW5kZXhPZignRE9UQV9BQklMSVRZX0JFSEFWSU9SX1BBU1NJVkUnKSA9PSAtMSwgJ2J0bi1kZWZhdWx0JzogJGRhdGEuYmVoYXZpb3IuaW5kZXhPZignRE9UQV9BQklMSVRZX0JFSEFWSU9SX1BBU1NJVkUnKSA9PSAtMX0sIGF0dHI6e3NyYzogJy9tZWRpYS9pbWFnZXMvc3BlbGxpY29ucy8nICsgJGRhdGEubmFtZSArICcucG5nJ30sIGNsaWNrOiBmdW5jdGlvbihkYXRhLCBldmVudCkgeyAkcGFyZW50c1sxXS5hYmlsaXR5KCkudG9nZ2xlQWJpbGl0eSgkaW5kZXgsIGRhdGEsIGV2ZW50KTsgfVxcXCIvPlxcbiAgICAgICAgPGRpdiBjbGFzcz1cXFwicHJvZ3Jlc3NcXFwiIHN0eWxlPVxcXCJwb3NpdGlvbjpyZWxhdGl2ZVxcXCI+XFxuICAgICAgICAgICAgPGRpdiBzdHlsZT1cXFwicG9zaXRpb246YWJzb2x1dGU7d2lkdGg6MTAwJTtjb2xvcjp3aGl0ZTtcXFwiIGNsYXNzPVxcXCJ0ZXh0LWNlbnRlclxcXCIgZGF0YS1iaW5kPVxcXCJ2aXNpYmxlOiAkcGFyZW50c1sxXS5nZXRBYmlsaXR5TGV2ZWxNYXgoJGRhdGEpID4gMCwgdGV4dDogJGRhdGEubGV2ZWwoKSArICcvJyArICRwYXJlbnRzWzFdLmdldEFiaWxpdHlMZXZlbE1heCgkZGF0YSlcXFwiPjwvZGl2PlxcbiAgICAgICAgICAgIDxkaXYgY2xhc3M9XFxcInByb2dyZXNzLWJhciBwcm9ncmVzcy1iYXItZGFuZ2VyXFxcIiByb2xlPVxcXCJwcm9ncmVzc2JhclxcXCIgYXJpYS12YWx1ZW5vdz1cXFwiNjBcXFwiIGFyaWEtdmFsdWVtaW49XFxcIjBcXFwiIGFyaWEtdmFsdWVtYXg9XFxcIjEwMFxcXCIgc3R5bGU9XFxcIndpZHRoOiA2MCU7XFxcIiBkYXRhLWJpbmQ9XFxcImF0dHI6IHsgJ2FyaWEtdmFsdWVub3cnOiAoJHBhcmVudHNbMV0uZ2V0QWJpbGl0eUxldmVsTWF4KCRkYXRhKSA+IDAgPyAkZGF0YS5sZXZlbCgpLyRwYXJlbnRzWzFdLmdldEFiaWxpdHlMZXZlbE1heCgkZGF0YSkqMTAwIDogMCkgfSwgc3R5bGU6IHsgd2lkdGg6ICgkcGFyZW50c1sxXS5nZXRBYmlsaXR5TGV2ZWxNYXgoJGRhdGEpID4gMCA/ICRkYXRhLmxldmVsKCkvJHBhcmVudHNbMV0uZ2V0QWJpbGl0eUxldmVsTWF4KCRkYXRhKSoxMDAgOiAwKSArICclJyB9XFxcIj48L2Rpdj5cXG4gICAgICAgIDwvZGl2PlxcbiAgICAgICAgPGRpdiBjbGFzcz1cXFwiYnRuLWdyb3VwIGJ0bi1ncm91cC1qdXN0aWZpZWRcXFwiIGRhdGEtYmluZD1cXFwiaWY6ICRkYXRhLmJlaGF2aW9yLmluZGV4T2YoJ0RPVEFfQUJJTElUWV9CRUhBVklPUl9OT1RfTEVBUk5BQkxFJykgPT0gLTFcXFwiPlxcbiAgICAgICAgICAgIDxhIGNsYXNzPVxcXCJidG4gYnRuLWRlZmF1bHQgYnRuLXNtXFxcIiBkYXRhLWJpbmQ9XFxcImNsaWNrOiBmdW5jdGlvbihkYXRhLCBldmVudCkgeyAkcGFyZW50c1sxXS5hYmlsaXR5KCkubGV2ZWxEb3duQWJpbGl0eSgkaW5kZXgsIGRhdGEsIGV2ZW50LCAkcGFyZW50c1sxXSk7IH1cXFwiPi08L2E+XFxuICAgICAgICAgICAgPGEgY2xhc3M9XFxcImJ0biBidG4tZGVmYXVsdCBidG4tc21cXFwiIGRhdGEtYmluZD1cXFwiY2xpY2s6IGZ1bmN0aW9uKGRhdGEsIGV2ZW50KSB7ICRwYXJlbnRzWzFdLmFiaWxpdHkoKS5sZXZlbFVwQWJpbGl0eSgkaW5kZXgsIGRhdGEsIGV2ZW50LCAkcGFyZW50c1sxXSk7IH1cXFwiPis8L2E+XFxuICAgICAgICA8L2Rpdj5cXG4gICAgICAgIDxkaXYgY2xhc3M9XFxcImJ0bi1ncm91cCBidG4tZ3JvdXAtanVzdGlmaWVkXFxcIj5cXG4gICAgICAgICAgICA8YSBjbGFzcz1cXFwiYnRuIGJ0bi1kZWZhdWx0IGJ0bi1zbVxcXCIgZGF0YS1iaW5kPVxcXCJjbGljazogZnVuY3Rpb24oZGF0YSwgZXZlbnQpIHsgJHBhcmVudHNbMV0uYWJpbGl0eSgpLnRvZ2dsZUFiaWxpdHlEZXRhaWwoJGluZGV4LCBkYXRhLCBldmVudCk7IH0sIGNzczogeyd0b2dnbGVkJzogJGRhdGEuaXNEZXRhaWx9XFxcIj5EZXRhaWxzPC9hPlxcbiAgICAgICAgPC9kaXY+XFxuICAgICAgICA8ZGl2IGNsYXNzPVxcXCJidG4tZ3JvdXAgYnRuLWdyb3VwLWp1c3RpZmllZFxcXCIgZGF0YS1iaW5kPVxcXCJpZjogJGRhdGEuYmVoYXZpb3IuaW5kZXhPZignRE9UQV9BQklMSVRZX0JFSEFWSU9SX05PVF9MRUFSTkFCTEUnKSAhPSAtMVxcXCI+XFxuICAgICAgICAgICAgPGEgY2xhc3M9XFxcImJ0biBidG4tZGVmYXVsdCBidG4tc20gYnRuLWJsb2NrXFxcIiBzdHlsZT1cXFwidmlzaWJpbGl0eTpoaWRkZW47XFxcIj4mbWRhc2g7PC9hPlxcbiAgICAgICAgPC9kaXY+XFxuICAgIDwvZGl2PlxcbiAgICA8ZGl2IGNsYXNzPVxcXCJjb2wtbWQtOSBib3R0b20tYnVmZmVyMlxcXCIgZGF0YS1iaW5kPVxcXCJ2aXNpYmxlOiAkZGF0YS5pc0RldGFpbCgpXFxcIj5cXG4gICAgICAgIDxidXR0b24gdHlwZT1cXFwiYnV0dG9uXFxcIiBjbGFzcz1cXFwiY2xvc2VcXFwiIGRhdGEtYmluZD1cXFwiY2xpY2s6IGZ1bmN0aW9uKGRhdGEsIGV2ZW50KSB7ICRwYXJlbnRzWzFdLmFiaWxpdHkoKS50b2dnbGVBYmlsaXR5RGV0YWlsKCRpbmRleCwgZGF0YSwgZXZlbnQpOyB9XFxcIj4mdGltZXM7PC9idXR0b24+XFxuICAgICAgICA8ZGl2IGRhdGEtYmluZD1cXFwiaHRtbDogJHBhcmVudHNbMV0uYWJpbGl0eSgpLmdldEFiaWxpdHlUb29sdGlwRGF0YSgkcGFyZW50c1sxXS5oZXJvSWQoKSwgJGRhdGEubmFtZSlcXFwiPjwvZGl2PlxcbiAgICAgICAgPGRpdiBkYXRhLWJpbmQ9XFxcImlmOiAkZGF0YS5uYW1lIGluICRwYXJlbnRzWzFdLmFiaWxpdHkoKS5hYmlsaXR5RGF0YSAmJiAkcGFyZW50c1sxXS5hYmlsaXR5KCkuYWJpbGl0aWVzKClbJGluZGV4KCldLmxldmVsKCkgPiAwXFxcIj5cXG4gICAgICAgICAgICA8ZGl2IGNsYXNzPVxcXCJjb2wtbWQtMTJcXFwiIHN0eWxlPVxcXCJtYXJnaW4tdG9wOiAxMHB4XFxcIiA+XFxuICAgICAgICAgICAgICAgIDxkaXYgZGF0YS1iaW5kPVxcXCJ0ZW1wbGF0ZTogeyBuYW1lOiAnYWJpbGl0eS1zZXR0aW5ncy10ZW1wbGF0ZScsIGRhdGE6ICRwYXJlbnRzWzFdLmFiaWxpdHkoKS5hYmlsaXR5U2V0dGluZ3NEYXRhKCRkYXRhLm5hbWUsICRwYXJlbnRzWzFdLCAkaW5kZXgoKSkgfVxcXCI+PC9kaXY+XFxuICAgICAgICAgICAgPC9kaXY+XFxuICAgICAgICA8L2Rpdj5cXG4gICAgPC9kaXY+XFxuPC9kaXY+XCIgfSk7XG5rby5jb21wb25lbnRzLnJlZ2lzdGVyKCdzaG9wJywgcmVxdWlyZSgnLi4vY29tcG9uZW50cy9zaG9wJykpO1xua28uY29tcG9uZW50cy5yZWdpc3Rlcignc3RhdCcsIHsgdGVtcGxhdGU6IFwiPHNwYW4gZGF0YS1iaW5kPVxcXCJ0ZXh0OiBwYXJzZUZsb2F0KGhlcm9bc3RhdF0oKSkudG9TdHJpbmcoKVxcXCI+PC9zcGFuPjxzcGFuIGRhdGEtYmluZD1cXFwiaHRtbDogJHJvb3QuZ2V0RGlmZlRleHQoaGVyby5kaWZmW3N0YXRdKCkpLCBkaWZmQ3NzOiBoZXJvLmRpZmZbc3RhdF0sIGRpZmZDc3NTdGF0OiBzdGF0LCB2aXNpYmxlOiBoZXJvLnNob3dEaWZmXFxcIj48L3NwYW4+XCIgfSk7XG5rby5jb21wb25lbnRzLnJlZ2lzdGVyKCdzdGF0czAnLCB7IHRlbXBsYXRlOiBcIjxkaXYgY2xhc3M9XFxcImNvbC1tZC0xMiBzdGF0czBcXFwiIGRhdGEtYmluZD1cXFwiY3NzOiB7J2NvbC1tZC0xMic6ICRyb290LmxheW91dCgpID09IDAsICdjb2wtbWQtMyc6ICRyb290LmxheW91dCgpID09IDF9XFxcIj5cXG4gICAgPHRhYmxlIGNsYXNzPVxcXCJ0YWJsZSB0YWJsZS1jb25kZW5zZWRcXFwiPlxcbiAgICA8dGJvZHk+XFxuICAgIDx0cj48dGQ+U3RyZW5ndGg6PC90ZD48dGQgY2xhc3M9XFxcInRleHQtcmlnaHRcXFwiIGRhdGEtYmluZD1cXFwiY29tcG9uZW50OiB7IG5hbWU6ICdzdGF0JywgcGFyYW1zOiB7J2hlcm8nOiAkZGF0YSwgJ3N0YXQnOiAndG90YWxTdHInIH0gfVxcXCI+PC90ZD48L3RyPlxcbiAgICA8dHI+PHRkPkFnaWxpdHk6PC90ZD48dGQgY2xhc3M9XFxcInRleHQtcmlnaHRcXFwiIGRhdGEtYmluZD1cXFwiY29tcG9uZW50OiB7IG5hbWU6ICdzdGF0JywgcGFyYW1zOiB7J2hlcm8nOiAkZGF0YSwgJ3N0YXQnOiAndG90YWxBZ2knIH0gfVxcXCI+PC90ZD48L3RyPlxcbiAgICA8dHI+PHRkPkludGVsbGlnZW5jZTo8L3RkPjx0ZCBjbGFzcz1cXFwidGV4dC1yaWdodFxcXCIgZGF0YS1iaW5kPVxcXCJjb21wb25lbnQ6IHsgbmFtZTogJ3N0YXQnLCBwYXJhbXM6IHsnaGVybyc6ICRkYXRhLCAnc3RhdCc6ICd0b3RhbEludCcgfSB9XFxcIj48L3RkPjwvdHI+XFxuICAgIDx0cj48dGQ+PGFiYnIgdGl0bGU9XFxcIk1vdmVtZW50IFNwZWVkXFxcIj5NUzwvYWJicj46PC90ZD48dGQgY2xhc3M9XFxcInRleHQtcmlnaHRcXFwiIGRhdGEtYmluZD1cXFwiY29tcG9uZW50OiB7IG5hbWU6ICdzdGF0JywgcGFyYW1zOiB7J2hlcm8nOiAkZGF0YSwgJ3N0YXQnOiAndG90YWxNb3ZlbWVudFNwZWVkJyB9IH1cXFwiPjwvdGQ+PC90cj5cXG4gICAgPHRyPjx0ZD5UdXJuIFJhdGU6PC90ZD48dGQgY2xhc3M9XFxcInRleHQtcmlnaHRcXFwiIGRhdGEtYmluZD1cXFwiY29tcG9uZW50OiB7IG5hbWU6ICdzdGF0JywgcGFyYW1zOiB7J2hlcm8nOiAkZGF0YSwgJ3N0YXQnOiAndG90YWxUdXJuUmF0ZScgfSB9XFxcIj48L3RkPjwvdHI+XFxuICAgIDx0cj48dGQ+U2lnaHQgUmFuZ2U6PC90ZD48dGQgY2xhc3M9XFxcInRleHQtcmlnaHRcXFwiPjxzcGFuIGRhdGEtYmluZD1cXFwiaHRtbDogJzxhYmJyIHRpdGxlPVxcXFwnRGF5XFxcXCc+JyArIHZpc2lvbnJhbmdlZGF5KCkgKyAnPC9hYmJyPi88YWJiciB0aXRsZT1cXFxcJ05pZ2h0XFxcXCc+JyArIHZpc2lvbnJhbmdlbmlnaHQoKSArICc8L2FiYnI+J1xcXCI+PC9zcGFuPjwvdGQ+PC90cj5cXG4gICAgPC90Ym9keT5cXG4gICAgPC90YWJsZT5cXG48L2Rpdj5cIiB9KTtcbmtvLmNvbXBvbmVudHMucmVnaXN0ZXIoJ3N0YXRzMScsIHsgdGVtcGxhdGU6IFwiPGRpdiBjbGFzcz1cXFwiY29sLW1kLTEyIHN0YXRzMVxcXCIgZGF0YS1iaW5kPVxcXCJjc3M6IHsnY29sLW1kLTEyJzogJHJvb3QubGF5b3V0KCkgPT0gMCwgJ2NvbC1tZC0zJzogJHJvb3QubGF5b3V0KCkgPT0gMX1cXFwiPlxcbiAgICA8dGFibGUgY2xhc3M9XFxcInRhYmxlIHRhYmxlLWNvbmRlbnNlZFxcXCI+XFxuICAgIDx0Ym9keT5cXG4gICAgPHRyPjx0ZD5Bcm1vcjo8L3RkPjx0ZCBjbGFzcz1cXFwidGV4dC1yaWdodFxcXCIgZGF0YS1iaW5kPVxcXCJjb21wb25lbnQ6IHsgbmFtZTogJ3N0YXQnLCBwYXJhbXM6IHsnaGVybyc6ICRkYXRhLCAnc3RhdCc6ICd0b3RhbEFybW9yUGh5c2ljYWwnIH0gfVxcXCI+PC90ZD48L3RyPlxcbiAgICA8dHI+PHRkPkhlYWx0aDo8L3RkPjx0ZCBjbGFzcz1cXFwidGV4dC1yaWdodFxcXCIgZGF0YS1iaW5kPVxcXCJjb21wb25lbnQ6IHsgbmFtZTogJ3N0YXQnLCBwYXJhbXM6IHsnaGVybyc6ICRkYXRhLCAnc3RhdCc6ICdoZWFsdGgnIH0gfVxcXCI+PC90ZD48L3RyPlxcbiAgICA8dHI+PHRkPkhlYWx0aCBSZWdlbjo8L3RkPjx0ZCBjbGFzcz1cXFwidGV4dC1yaWdodFxcXCIgZGF0YS1iaW5kPVxcXCJjb21wb25lbnQ6IHsgbmFtZTogJ3N0YXQnLCBwYXJhbXM6IHsnaGVybyc6ICRkYXRhLCAnc3RhdCc6ICdoZWFsdGhyZWdlbicgfSB9XFxcIj48L3RkPjwvdHI+XFxuICAgIDx0cj48dGQ+TWFuYTo8L3RkPjx0ZCBjbGFzcz1cXFwidGV4dC1yaWdodFxcXCIgZGF0YS1iaW5kPVxcXCJjb21wb25lbnQ6IHsgbmFtZTogJ3N0YXQnLCBwYXJhbXM6IHsnaGVybyc6ICRkYXRhLCAnc3RhdCc6ICdtYW5hJyB9IH1cXFwiPjwvdGQ+PC90cj5cXG4gICAgPHRyPjx0ZD5NYW5hIFJlZ2VuOjwvdGQ+PHRkIGNsYXNzPVxcXCJ0ZXh0LXJpZ2h0XFxcIiBkYXRhLWJpbmQ9XFxcImNvbXBvbmVudDogeyBuYW1lOiAnc3RhdCcsIHBhcmFtczogeydoZXJvJzogJGRhdGEsICdzdGF0JzogJ21hbmFyZWdlbicgfSB9XFxcIj48L3RkPjwvdHI+XFxuICAgIDx0cj48dGQ+UGh5c2ljYWwgPGFiYnIgdGl0bGU9XFxcIkVmZmVjdGl2ZSBIaXQgUG9pbnRzXFxcIj5FSFA8L2FiYnI+OjwvdGQ+PHRkIGNsYXNzPVxcXCJ0ZXh0LXJpZ2h0XFxcIiBkYXRhLWJpbmQ9XFxcImNvbXBvbmVudDogeyBuYW1lOiAnc3RhdCcsIHBhcmFtczogeydoZXJvJzogJGRhdGEsICdzdGF0JzogJ2VocFBoeXNpY2FsJyB9IH1cXFwiPjwvdGQ+PC90cj5cXG4gICAgPHRyPjx0ZD5NYWdpY2FsIDxhYmJyIHRpdGxlPVxcXCJFZmZlY3RpdmUgSGl0IFBvaW50c1xcXCI+RUhQPC9hYmJyPjo8L3RkPjx0ZCBjbGFzcz1cXFwidGV4dC1yaWdodFxcXCIgZGF0YS1iaW5kPVxcXCJjb21wb25lbnQ6IHsgbmFtZTogJ3N0YXQnLCBwYXJhbXM6IHsnaGVybyc6ICRkYXRhLCAnc3RhdCc6ICdlaHBNYWdpY2FsJyB9IH1cXFwiPjwvdGQ+PC90cj5cXG4gICAgPC90Ym9keT5cXG4gICAgPC90YWJsZT5cXG48L2Rpdj5cIiB9KTtcbmtvLmNvbXBvbmVudHMucmVnaXN0ZXIoJ3N0YXRzMicsIHsgdGVtcGxhdGU6IFwiPGRpdiBjbGFzcz1cXFwiY29sLW1kLTEyIHN0YXRzMlxcXCIgZGF0YS1iaW5kPVxcXCJjc3M6IHsnY29sLW1kLTEyJzogJHJvb3QubGF5b3V0KCkgPT0gMCwgJ2NvbC1tZC0zJzogJHJvb3QubGF5b3V0KCkgPT0gMX1cXFwiPlxcbiAgICA8dGFibGUgY2xhc3M9XFxcInRhYmxlIHRhYmxlLWNvbmRlbnNlZFxcXCI+XFxuICAgIDx0Ym9keT5cXG4gICAgPHRyPjx0ZD4lUGh5cyBSZXM6PC90ZD48dGQgY2xhc3M9XFxcInRleHQtcmlnaHRcXFwiIGRhdGEtYmluZD1cXFwiY29tcG9uZW50OiB7IG5hbWU6ICdzdGF0JywgcGFyYW1zOiB7J2hlcm8nOiAkZGF0YSwgJ3N0YXQnOiAndG90YWxBcm1vclBoeXNpY2FsUmVkdWN0aW9uJyB9IH1cXFwiPjwvdGQ+PC90cj5cXG4gICAgPHRyPjx0ZD4lTWFnaWMgUmVzOjwvdGQ+PHRkIGNsYXNzPVxcXCJ0ZXh0LXJpZ2h0XFxcIiBkYXRhLWJpbmQ9XFxcImNvbXBvbmVudDogeyBuYW1lOiAnc3RhdCcsIHBhcmFtczogeydoZXJvJzogJGRhdGEsICdzdGF0JzogJ3RvdGFsTWFnaWNSZXNpc3RhbmNlJyB9IH1cXFwiPjwvdGQ+PC90cj5cXG4gICAgPHRyPjx0ZD4lTGlmZXN0ZWFsOjwvdGQ+PHRkIGNsYXNzPVxcXCJ0ZXh0LXJpZ2h0XFxcIiBkYXRhLWJpbmQ9XFxcImNvbXBvbmVudDogeyBuYW1lOiAnc3RhdCcsIHBhcmFtczogeydoZXJvJzogJGRhdGEsICdzdGF0JzogJ2xpZmVzdGVhbCcgfSB9XFxcIj48L3RkPjwvdHI+XFxuICAgIDx0cj48dGQ+JUV2YXNpb246PC90ZD48dGQgY2xhc3M9XFxcInRleHQtcmlnaHRcXFwiIGRhdGEtYmluZD1cXFwiY29tcG9uZW50OiB7IG5hbWU6ICdzdGF0JywgcGFyYW1zOiB7J2hlcm8nOiAkZGF0YSwgJ3N0YXQnOiAnZXZhc2lvbicgfSB9XFxcIj48L3RkPjwvdHI+XFxuICAgIDx0cj48dGQ+JUJhc2g6PC90ZD48dGQgY2xhc3M9XFxcInRleHQtcmlnaHRcXFwiIGRhdGEtYmluZD1cXFwiY29tcG9uZW50OiB7IG5hbWU6ICdzdGF0JywgcGFyYW1zOiB7J2hlcm8nOiAkZGF0YSwgJ3N0YXQnOiAnYmFzaCcgfSB9XFxcIj48L3RkPjwvdHI+XFxuICAgIDx0cj48dGQ+JU1pc3MgQ2hhbmNlOjwvdGQ+PHRkIGNsYXNzPVxcXCJ0ZXh0LXJpZ2h0XFxcIiBkYXRhLWJpbmQ9XFxcImNvbXBvbmVudDogeyBuYW1lOiAnc3RhdCcsIHBhcmFtczogeydoZXJvJzogJGRhdGEsICdzdGF0JzogJ21pc3NDaGFuY2UnIH0gfVxcXCI+PC90ZD48L3RyPlxcbiAgICA8dHIgc3R5bGU9XFxcImRpc3BsYXk6IG5vbmVcXFwiPjx0ZCBjb2xzcGFuPTI+PGEgY2xhc3M9XFxcImJ0biBidG4tZGVmYXVsdCBidG4tYmxvY2sgYnRuLXhzXFxcIiBkYXRhLWJpbmQ9XFxcImNzczoge2Rpc2FibGVkOiBjcml0SW5mbygpLnNvdXJjZXMubGVuZ3RoID09IDAgPyAnZGlzYWJsZWQnIDogJycsICd0b2dnbGVkJzogc2hvd0NyaXRpY2FsU3RyaWtlRGV0YWlsc30sIHRvZ2dsZTogc2hvd0NyaXRpY2FsU3RyaWtlRGV0YWlsc1xcXCI+Q3JpdGljYWwgU3RyaWtlIERldGFpbHM8L2E+PC90ZD48L3RyPlxcbiAgICA8L3Rib2R5PlxcbiAgICA8dGJvZHkgY2xhc3M9XFxcInRhYmxlZHJvcGRvd25cXFwiIHN0eWxlPVxcXCJib3JkZXItdG9wOjBcXFwiIGRhdGEtYmluZD1cXFwidmlzaWJsZTogc2hvd0NyaXRpY2FsU3RyaWtlRGV0YWlscygpLGZvcmVhY2g6IGNyaXRJbmZvKCkuc291cmNlc1xcXCI+XFxuICAgIDx0cj48dGQgY29sc3Bhbj0yPjxzdHJvbmcgZGF0YS1iaW5kPVxcXCJ0ZXh0OiAkZGF0YS5uYW1lXFxcIj48L3N0cm9uZz48L3RkPjwvdHI+XFxuICAgIDx0cj48dGQ+Q3JpdCBDaGFuY2U6PC90ZD48dGQgY2xhc3M9XFxcInRleHQtcmlnaHRcXFwiPjxzcGFuIGRhdGEtYmluZD1cXFwidGV4dDogKCRkYXRhLnRvdGFsY2hhbmNlICogMTAwKS50b0ZpeGVkKDIpICsgJyUnXFxcIj48L3NwYW4+PC90ZD48L3RyPlxcbiAgICA8dHI+PHRkPkNyaXQgTXVsdGlwbGllcjo8L3RkPjx0ZCBjbGFzcz1cXFwidGV4dC1yaWdodFxcXCI+PHNwYW4gZGF0YS1iaW5kPVxcXCJ0ZXh0OiAoJGRhdGEubXVsdGlwbGllciAqIDEwMCkudG9GaXhlZCgyKSArICclJ1xcXCI+PC9zcGFuPjwvdGQ+PC90cj5cXG4gICAgPC90Ym9keT5cXG4gICAgPC90YWJsZT5cXG48L2Rpdj5cIiB9KTtcbmtvLmNvbXBvbmVudHMucmVnaXN0ZXIoJ3N0YXRzMycsIHsgdGVtcGxhdGU6IFwiPGRpdiBjbGFzcz1cXFwiY29sLW1kLTEyIHN0YXRzM1xcXCIgZGF0YS1iaW5kPVxcXCJjc3M6IHsnY29sLW1kLTEyJzogJHJvb3QubGF5b3V0KCkgPT0gMCwgJ2NvbC1tZC0zJzogJHJvb3QubGF5b3V0KCkgPT0gMX1cXFwiPlxcbiAgICA8dGFibGUgY2xhc3M9XFxcInRhYmxlIHRhYmxlLWNvbmRlbnNlZFxcXCI+XFxuICAgIDx0Ym9keT5cXG4gICAgPHRyPlxcbiAgICAgICAgPHRkPkRhbWFnZTo8L3RkPlxcbiAgICAgICAgPHRkIGNsYXNzPVxcXCJ0ZXh0LXJpZ2h0XFxcIj5cXG4gICAgICAgICAgICA8c3BhbiBkYXRhLWJpbmQ9XFxcImh0bWw6IGJhc2VEYW1hZ2UoKVswXS50b0ZpeGVkKDApXFxcIj48L3NwYW4+XFxuICAgICAgICAgICAgPHNwYW4gZGF0YS1iaW5kPVxcXCJodG1sOiAkcm9vdC5nZXREaWZmVGV4dChkaWZmWydiYXNlRGFtYWdlJ10oKVswXSksIGNzczogeydkaWZmUG9zJzogZGlmZlsnYmFzZURhbWFnZSddKClbMF0gPiAwLCAnZGlmZk5lZyc6IGRpZmZbJ2Jhc2VEYW1hZ2UnXSgpWzBdIDwgMH0sIHZpc2libGU6IHNob3dEaWZmXFxcIj48L3NwYW4+XFxuICAgICAgICAgICAgPHNwYW4+Jm5kYXNoOzwvc3Bhbj5cXG4gICAgICAgICAgICA8c3BhbiBkYXRhLWJpbmQ9XFxcImh0bWw6IGJhc2VEYW1hZ2UoKVsxXS50b0ZpeGVkKDApXFxcIj48L3NwYW4+XFxuICAgICAgICAgICAgPHNwYW4gZGF0YS1iaW5kPVxcXCJodG1sOiAkcm9vdC5nZXREaWZmVGV4dChkaWZmWydiYXNlRGFtYWdlJ10oKVsxXSksIGNzczogeydkaWZmUG9zJzogZGlmZlsnYmFzZURhbWFnZSddKClbMV0gPiAwLCAnZGlmZk5lZyc6IGRpZmZbJ2Jhc2VEYW1hZ2UnXSgpWzFdIDwgMH0sIHZpc2libGU6IHNob3dEaWZmXFxcIj48L3NwYW4+XFxuICAgICAgICAgICAgPHNwYW4gc3R5bGU9XFxcImNvbG9yOmdyZWVuXFxcIiBkYXRhLWJpbmQ9XFxcInZpc2libGU6IGJvbnVzRGFtYWdlKCkgPiAwLCBodG1sOiAnICsgJyArIGJvbnVzRGFtYWdlKCkudG9GaXhlZCgwKVxcXCI+PC9zcGFuPlxcbiAgICAgICAgICAgIDxzcGFuIGRhdGEtYmluZD1cXFwiaHRtbDogJHJvb3QuZ2V0RGlmZlRleHQoZGlmZlsnYm9udXNEYW1hZ2UnXSgpKSwgY3NzOiB7J2RpZmZQb3MnOiBkaWZmWydib251c0RhbWFnZSddKCkgPiAwLCAnZGlmZk5lZyc6IGRpZmZbJ2JvbnVzRGFtYWdlJ10oKSA8IDB9LCB2aXNpYmxlOiBzaG93RGlmZlxcXCI+PC9zcGFuPlxcbiAgICAgICAgICAgIDxzcGFuIHN0eWxlPVxcXCJjb2xvcjpyZWRcXFwiIGRhdGEtYmluZD1cXFwidmlzaWJsZTogYm9udXNEYW1hZ2VSZWR1Y3Rpb24oKSAhPSAwLCBodG1sOiAnIC0gJyArIGJvbnVzRGFtYWdlUmVkdWN0aW9uKCkudG9GaXhlZCgwKVxcXCI+PC9zcGFuPlxcbiAgICAgICAgICAgIDxzcGFuIGRhdGEtYmluZD1cXFwiaHRtbDogJHJvb3QuZ2V0RGlmZlRleHQoZGlmZlsnYm9udXNEYW1hZ2VSZWR1Y3Rpb24nXSgpKSwgY3NzOiB7J2RpZmZQb3MnOiBkaWZmWydib251c0RhbWFnZVJlZHVjdGlvbiddKCkgPiAwLCAnZGlmZk5lZyc6IGRpZmZbJ2JvbnVzRGFtYWdlUmVkdWN0aW9uJ10oKSA8IDB9LCB2aXNpYmxlOiBzaG93RGlmZlxcXCI+PC9zcGFuPlxcbiAgICAgICAgPC90ZD5cXG4gICAgPC90cj5cXG4gICAgPHRyPjx0ZD48YWJiciB0aXRsZT1cXFwiSW5jcmVhc2VkIEF0dGFjayBTcGVlZFxcXCI+SUFTPC9hYmJyPjo8L3RkPjx0ZCBjbGFzcz1cXFwidGV4dC1yaWdodFxcXCIgZGF0YS1iaW5kPVxcXCJjb21wb25lbnQ6IHsgbmFtZTogJ3N0YXQnLCBwYXJhbXM6IHsnaGVybyc6ICRkYXRhLCAnc3RhdCc6ICdpYXMnIH0gfVxcXCI+PC90ZD48L3RyPlxcbiAgICA8dHI+PHRkPjxhYmJyIHRpdGxlPVxcXCJCYXNlIEF0dGFjayBUaW1lXFxcIj5CQVQ8L2FiYnI+OjwvdGQ+PHRkIGNsYXNzPVxcXCJ0ZXh0LXJpZ2h0XFxcIiBkYXRhLWJpbmQ9XFxcImNvbXBvbmVudDogeyBuYW1lOiAnc3RhdCcsIHBhcmFtczogeydoZXJvJzogJGRhdGEsICdzdGF0JzogJ2JhdCcgfSB9XFxcIj48L3RkPjwvdHI+XFxuICAgIDx0cj48dGQ+QXR0YWNrIFRpbWU6PC90ZD48dGQgY2xhc3M9XFxcInRleHQtcmlnaHRcXFwiIGRhdGEtYmluZD1cXFwiY29tcG9uZW50OiB7IG5hbWU6ICdzdGF0JywgcGFyYW1zOiB7J2hlcm8nOiAkZGF0YSwgJ3N0YXQnOiAnYXR0YWNrVGltZScgfSB9XFxcIj48L3RkPjwvdHI+XFxuICAgIDx0cj48dGQ+QXR0YWNrICZmcmFzbDsgU2VjOjwvdGQ+PHRkIGNsYXNzPVxcXCJ0ZXh0LXJpZ2h0XFxcIiBkYXRhLWJpbmQ9XFxcImNvbXBvbmVudDogeyBuYW1lOiAnc3RhdCcsIHBhcmFtczogeydoZXJvJzogJGRhdGEsICdzdGF0JzogJ2F0dGFja3NQZXJTZWNvbmQnIH0gfVxcXCI+PC90ZD48L3RyPlxcbiAgICA8dHI+PHRkPkF0dGFjayBSYW5nZTo8L3RkPjx0ZCBjbGFzcz1cXFwidGV4dC1yaWdodFxcXCIgZGF0YS1iaW5kPVxcXCJjb21wb25lbnQ6IHsgbmFtZTogJ3N0YXQnLCBwYXJhbXM6IHsnaGVybyc6ICRkYXRhLCAnc3RhdCc6ICd0b3RhbGF0dGFja3JhbmdlJyB9IH1cXFwiPjwvdGQ+PC90cj5cXG4gICAgPC90Ym9keT5cXG4gICAgPC90YWJsZT5cXG48L2Rpdj5cIiB9KTtcbmtvLmNvbXBvbmVudHMucmVnaXN0ZXIoJ3N0YXRzLWFkZGl0aW9uYWwnLCB7IHRlbXBsYXRlOiBcIjx0YWJsZSBjbGFzcz1cXFwidGFibGUgdGFibGUtY29uZGVuc2VkXFxcIj5cXG4gICAgPHRib2R5PlxcbiAgICAgICAgPHRyPjx0ZD5CYXNlIFN0cmVuZ3RoOjwvdGQ+PHRkIGNsYXNzPVxcXCJ0ZXh0LXJpZ2h0XFxcIj48c3BhbiBkYXRhLWJpbmQ9XFxcInRleHQ6IGhlcm9EYXRhKCkuYXR0cmlidXRlYmFzZXN0cmVuZ3RoXFxcIj48L3NwYW4+PC90ZD48L3RyPlxcbiAgICAgICAgPHRyPjx0ZD5TdHJlbmd0aCBHYWluOjwvdGQ+PHRkIGNsYXNzPVxcXCJ0ZXh0LXJpZ2h0XFxcIj48c3BhbiBkYXRhLWJpbmQ9XFxcInRleHQ6IGhlcm9EYXRhKCkuYXR0cmlidXRlc3RyZW5ndGhnYWluXFxcIj48L3NwYW4+PC90ZD48L3RyPlxcbiAgICAgICAgPHRyPjx0ZD5CYXNlIEFnaWxpdHk6PC90ZD48dGQgY2xhc3M9XFxcInRleHQtcmlnaHRcXFwiPjxzcGFuIGRhdGEtYmluZD1cXFwidGV4dDogaGVyb0RhdGEoKS5hdHRyaWJ1dGViYXNlYWdpbGl0eVxcXCI+PC9zcGFuPjwvdGQ+PC90cj5cXG4gICAgICAgIDx0cj48dGQ+QWdpbGl0eSBHYWluOjwvdGQ+PHRkIGNsYXNzPVxcXCJ0ZXh0LXJpZ2h0XFxcIj48c3BhbiBkYXRhLWJpbmQ9XFxcInRleHQ6IGhlcm9EYXRhKCkuYXR0cmlidXRlYWdpbGl0eWdhaW5cXFwiPjwvc3Bhbj48L3RkPjwvdHI+XFxuICAgICAgICA8dHI+PHRkPkJhc2UgSW50ZWxsaWdlbmNlOjwvdGQ+PHRkIGNsYXNzPVxcXCJ0ZXh0LXJpZ2h0XFxcIj48c3BhbiBkYXRhLWJpbmQ9XFxcInRleHQ6IGhlcm9EYXRhKCkuYXR0cmlidXRlYmFzZWludGVsbGlnZW5jZVxcXCI+PC9zcGFuPjwvdGQ+PC90cj5cXG4gICAgICAgIDx0cj48dGQ+SW50ZWxsaWdlbmNlIEdhaW46PC90ZD48dGQgY2xhc3M9XFxcInRleHQtcmlnaHRcXFwiPjxzcGFuIGRhdGEtYmluZD1cXFwidGV4dDogaGVyb0RhdGEoKS5hdHRyaWJ1dGVpbnRlbGxpZ2VuY2VnYWluXFxcIj48L3NwYW4+PC90ZD48L3RyPlxcbiAgICAgICAgPHRyPjx0ZD5CYXNlIEFybW9yOjwvdGQ+PHRkIGNsYXNzPVxcXCJ0ZXh0LXJpZ2h0XFxcIj48c3BhbiBkYXRhLWJpbmQ9XFxcInRleHQ6IGhlcm9EYXRhKCkuYXJtb3JwaHlzaWNhbFxcXCI+PC9zcGFuPjwvdGQ+PC90cj5cXG4gICAgICAgIDx0cj48dGQ+PGFiYnIgdGl0bGU9XFxcIkJhc2UgQXJtb3IgKyBhcm1vciBmcm9tIGJhc2UgYWdpbGl0eVxcXCI+U3RhcnRpbmcgQXJtb3I6PC9hYmJyPjwvdGQ+PHRkIGNsYXNzPVxcXCJ0ZXh0LXJpZ2h0XFxcIj48c3BhbiBkYXRhLWJpbmQ9XFxcInRleHQ6IHBhcnNlRmxvYXQoJGRhdGEuc3RhcnRpbmdBcm1vcigpKS50b1N0cmluZygpXFxcIj48L3NwYW4+PC90ZD48L3RyPlxcbiAgICAgICAgPHRyPjx0ZD5CYXNlIE1hZ2ljIFJlczo8L3RkPjx0ZCBjbGFzcz1cXFwidGV4dC1yaWdodFxcXCI+PHNwYW4gZGF0YS1iaW5kPVxcXCJ0ZXh0OiBoZXJvRGF0YSgpLm1hZ2ljYWxyZXNpc3RhbmNlICsgJyUnXFxcIj48L3NwYW4+PC90ZD48L3RyPlxcbiAgICAgICAgPHRyPjx0ZD5CYXNlIEF0dGFjayBQb2ludDo8L3RkPjx0ZCBjbGFzcz1cXFwidGV4dC1yaWdodFxcXCI+PHNwYW4gZGF0YS1iaW5kPVxcXCJ0ZXh0OiBoZXJvRGF0YSgpLmF0dGFja3BvaW50XFxcIj48L3NwYW4+PC90ZD48L3RyPlxcbiAgICAgICAgPHRyPjx0ZD48YWJiciBkYXRhLWJpbmQ9XFxcImF0dHI6IHsgdGl0bGU6ICdUb3RhbCBleHBlcmllbmNlIHJlcXVpcmVkIHRvIHJlYWNoIGxldmVsICcgKyAkZGF0YS5zZWxlY3RlZEhlcm9MZXZlbCgpIH1cXFwiPlRvdGFsIEV4cDo8L2FiYnI+PC90ZD48dGQgY2xhc3M9XFxcInRleHQtcmlnaHRcXFwiPjxzcGFuIGRhdGEtYmluZD1cXFwidGV4dDogJGRhdGEudG90YWxFeHAoKVxcXCI+PC9zcGFuPjwvc3Bhbj48L3RkPjwvdHI+XFxuICAgICAgICA8dHI+PHRkPjxhYmJyIHRpdGxlPVxcXCJFeHBlcmllbmNlIHJlcXVpcmVkIGZvciBuZXh0IGxldmVsXFxcIj5OZXh0IGxldmVsIGV4cDo8L2FiYnI+PC90ZD48dGQgY2xhc3M9XFxcInRleHQtcmlnaHRcXFwiPjxzcGFuIGRhdGEtYmluZD1cXFwiaHRtbDogJGRhdGEubmV4dExldmVsRXhwKClcXFwiPjwvc3Bhbj48L3NwYW4+PC90ZD48L3RyPlxcbiAgICAgICAgPHRyPjx0ZD5SZXNwYXduIFRpbWU6PC90ZD48dGQgY2xhc3M9XFxcInRleHQtcmlnaHRcXFwiPjxzcGFuIGRhdGEtYmluZD1cXFwidGV4dDogJGRhdGEucmVzcGF3blRpbWUoKVxcXCI+PC9zcGFuPjwvdGQ+PC90cj5cXG4gICAgPC90Ym9keT5cXG48L3RhYmxlPlwiIH0pO1xuXG4vLyBUaGUgYXBwIGV4dGVuZHMgdGhlIGhlcm9jYWxjIGxpYnJhcnksIHByb3ZpZGVzIGEgZnJvbnRlbmRcbnZhciBteSA9IHJlcXVpcmUoXCJkb3RhLWhlcm8tY2FsY3VsYXRvci1saWJyYXJ5XCIpO1xudmFyIGZpbmRXaGVyZSA9IHJlcXVpcmUoXCJkb3RhLWhlcm8tY2FsY3VsYXRvci1saWJyYXJ5L3NyYy9oZXJvY2FsYy91dGlsL2ZpbmRXaGVyZVwiKTtcbnZhciB1bmlxdWVJZCA9IHJlcXVpcmUoXCJkb3RhLWhlcm8tY2FsY3VsYXRvci1saWJyYXJ5L3NyYy9oZXJvY2FsYy91dGlsL3VuaXF1ZUlkXCIpO1xudmFyIGl0ZW1EYXRhID0gcmVxdWlyZShcImRvdGEtaGVyby1jYWxjdWxhdG9yLWxpYnJhcnkvc3JjL2hlcm9jYWxjL2RhdGEvbWFpblwiKS5pdGVtRGF0YTtcbnZhciB1bml0RGF0YSA9IHJlcXVpcmUoXCJkb3RhLWhlcm8tY2FsY3VsYXRvci1saWJyYXJ5L3NyYy9oZXJvY2FsYy9kYXRhL21haW5cIikudW5pdERhdGE7XG52YXIgaGVyb0RhdGEgPSByZXF1aXJlKFwiZG90YS1oZXJvLWNhbGN1bGF0b3ItbGlicmFyeS9zcmMvaGVyb2NhbGMvZGF0YS9tYWluXCIpLmhlcm9EYXRhO1xudmFyIHN0YWNrYWJsZUl0ZW1zID0gcmVxdWlyZShcImRvdGEtaGVyby1jYWxjdWxhdG9yLWxpYnJhcnkvc3JjL2hlcm9jYWxjL2ludmVudG9yeS9zdGFja2FibGVJdGVtc1wiKTtcbnZhciBsZXZlbEl0ZW1zID0gcmVxdWlyZShcImRvdGEtaGVyby1jYWxjdWxhdG9yLWxpYnJhcnkvc3JjL2hlcm9jYWxjL2ludmVudG9yeS9sZXZlbEl0ZW1zXCIpO1xudmFyIGdldEl0ZW1Ub29sdGlwRGF0YSA9IHJlcXVpcmUoXCIuL2hlcm9jYWxjX3Rvb2x0aXBzX2l0ZW1cIik7XG52YXIgZ2V0QWJpbGl0eVRvb2x0aXBEYXRhID0gcmVxdWlyZShcIi4vaGVyb2NhbGNfdG9vbHRpcHNfYWJpbGl0eVwiKTtcbnZhciBIZXJvVmlld01vZGVsID0gcmVxdWlyZShcIi4vSGVyb1ZpZXdNb2RlbFwiKTtcbnZhciBDbG9uZVZpZXdNb2RlbCA9IHJlcXVpcmUoXCIuL0Nsb25lVmlld01vZGVsXCIpO1xudmFyIFVuaXRWaWV3TW9kZWwgPSByZXF1aXJlKFwiLi9Vbml0Vmlld01vZGVsXCIpO1xudmFyIEFiaWxpdHlNb2RlbCA9IHJlcXVpcmUoXCJkb3RhLWhlcm8tY2FsY3VsYXRvci1saWJyYXJ5L3NyYy9oZXJvY2FsYy9BYmlsaXR5TW9kZWxcIik7XG5BYmlsaXR5TW9kZWwucHJvdG90eXBlLmdldEFiaWxpdHlUb29sdGlwRGF0YSA9IGZ1bmN0aW9uIChoZXJvLCBlbCkge1xuICAgIHJldHVybiBnZXRBYmlsaXR5VG9vbHRpcERhdGEoaGVyb0RhdGEsIHVuaXREYXRhLCBoZXJvLCBlbCk7XG59XG5cbnZhciBQbGF5ZXJDb2xvcnMgPSBbXG4gICAgXCIjMkU2QUU2XCIsIC8vQmx1ZVxuICAgIFwiIzVERTZBRFwiLCAvL1RlYWxcbiAgICBcIiNBRDAwQURcIiwgLy9QdXJwbGVcbiAgICBcIiNEQ0Q5MEFcIiwgLy9ZZWxsb3dcbiAgICBcIiNFNjYyMDBcIiwgLy9PcmFuZ2VcbiAgICBcIiNFNjdBQjBcIiwgLy9QaW5rXG4gICAgXCIjOTJBNDQwXCIsIC8vUHVzIFllbGxvd1xuICAgIFwiIzVDQzVFMFwiLCAvL0xpZ2h0IEJsdWVcbiAgICBcIiMwMDc3MUZcIiwgLy9HcmVlblxuICAgIFwiIzk1NjAwMFwiIC8vQnJvd25cbl07XG5cbnZhciBUYWIgPSBmdW5jdGlvbiAoaWQsIGhyZWYsIGRhdGEsIHRleHQsIGNvbG9yLCB0ZW1wbGF0ZSkge1xuICAgIHZhciBzZWxmID0gdGhpcztcbiAgICBzZWxmLmlkID0gaWQ7XG4gICAgc2VsZi5ocmVmID0gaHJlZjtcbiAgICBzZWxmLmNvbG9yID0gY29sb3I7XG4gICAgc2VsZi5kYXRhID0gZGF0YTtcbiAgICBzZWxmLmRhdGEuaWQgPSBrby5vYnNlcnZhYmxlKHNlbGYuaHJlZik7XG4gICAgc2VsZi50ZXh0ID0gdGV4dDtcbiAgICBzZWxmLnRlbXBsYXRlID0gdGVtcGxhdGU7XG4gICAgcmV0dXJuIHNlbGY7XG59XG5UYWIucHJvdG90eXBlLnRvSlMgPSBmdW5jdGlvbiAoKSB7XG4gICAgcmV0dXJuIHtcbiAgICAgICAgaWQ6IHRoaXMuaWQsXG4gICAgICAgIGhyZWY6IHRoaXMuaHJlZixcbiAgICAgICAgY29sb3I6IHRoaXMuY29sb3IsXG4gICAgICAgIHRleHQ6IHRoaXMudGV4dCxcbiAgICAgICAgdGVtcGxhdGU6IHRoaXMudGVtcGxhdGVcbiAgICB9XG59XG5cbnZhciBUYWJHcm91cCA9IGZ1bmN0aW9uIChoZXJvLCB1bml0LCBjbG9uZSkge1xuICAgIHZhciBzZWxmID0gdGhpcztcbiAgICBzZWxmLmhlcm8gPSBoZXJvO1xuICAgIHNlbGYudW5pdCA9IHVuaXQ7XG4gICAgc2VsZi5jbG9uZSA9IGNsb25lO1xuICAgIHNlbGYuaWxsdXNpb25zID0ga28ub2JzZXJ2YWJsZUFycmF5KFtdKTtcbiAgICByZXR1cm4gc2VsZjtcbn1cblRhYkdyb3VwLnByb3RvdHlwZS50b0pTID0gZnVuY3Rpb24gKCkge1xuICAgIHJldHVybiB7XG4gICAgICAgIGhlcm86IHRoaXMuaGVyby50b0pTKCksXG4gICAgICAgIHVuaXQ6IHRoaXMudW5pdC50b0pTKCksXG4gICAgICAgIGNsb25lOiB0aGlzLmNsb25lLnRvSlMoKSxcbiAgICAgICAgaWxsdXNpb25zOiB0aGlzLmlsbHVzaW9ucygpLm1hcChmdW5jdGlvbiAoaWxsdXNpb24pIHsgcmV0dXJuIGlsbHVzaW9uLnRvSlMoKTsgfSlcbiAgICB9XG59XG5cbnZhciBIZXJvQ2FsY3VsYXRvclZpZXdNb2RlbCA9IGZ1bmN0aW9uICh0b29sdGlwVVJMKSB7XG4gICAgdmFyIHNlbGYgPSB0aGlzO1xuICAgIHNlbGYuaGVyb2VzID0gW107XG4gICAgXG4gICAgZ2V0QWJpbGl0eVRvb2x0aXBEYXRhLmluaXQodG9vbHRpcFVSTCk7XG5cbiAgICBmb3IgKHZhciBpID0gMDsgaSA8IDEwOyBpKyspIHtcbiAgICAgICAgc2VsZi5oZXJvZXMucHVzaChuZXcgSGVyb1ZpZXdNb2RlbChoZXJvRGF0YSwgaXRlbURhdGEsIHVuaXREYXRhLCBpKSk7XG4gICAgfVxuICAgIFxuICAgIGZvciAodmFyIGkgPSAwOyBpIDwgNTsgaSsrKSB7XG4gICAgICAgIHZhciBhcnIgPSBbXTtcbiAgICAgICAgZm9yICh2YXIgaiA9IDU7IGogPCAxMDsgaisrKSB7XG4gICAgICAgICAgICBhcnIucHVzaChzZWxmLmhlcm9lc1tqXSk7XG4gICAgICAgIH1cbiAgICAgICAgc2VsZi5oZXJvZXNbaV0uZW5lbWllcy5wdXNoLmFwcGx5KHNlbGYuaGVyb2VzW2ldLmVuZW1pZXMsIGFycik7XG4gICAgfVxuICAgIGZvciAodmFyIGkgPSA1OyBpIDwgMTA7IGkrKykge1xuICAgICAgICB2YXIgYXJyID0gW107XG4gICAgICAgIGZvciAodmFyIGogPSAwOyBqIDwgNTsgaisrKSB7XG4gICAgICAgICAgICBhcnIucHVzaChzZWxmLmhlcm9lc1tqXSk7XG4gICAgICAgIH1cbiAgICAgICAgc2VsZi5oZXJvZXNbaV0uZW5lbWllcy5wdXNoLmFwcGx5KHNlbGYuaGVyb2VzW2ldLmVuZW1pZXMsIGFycik7XG4gICAgfVxuICAgIGZvciAodmFyIGkgPSAwOyBpIDwgMTA7IGkrKykge1xuICAgICAgICB2YXIgYXJyID0gW107XG4gICAgICAgIGZvciAodmFyIGogPSAwOyBqIDwgMTA7IGorKykge1xuICAgICAgICAgICAgaWYgKGkgIT09IGopIGFyci5wdXNoKHNlbGYuaGVyb2VzW2pdKTtcbiAgICAgICAgfVxuICAgICAgICBzZWxmLmhlcm9lc1tpXS5vdGhlckhlcm9lcy5wdXNoLmFwcGx5KHNlbGYuaGVyb2VzW2ldLm90aGVySGVyb2VzLCBhcnIpO1xuICAgIH1cbiAgICBcbiAgICBmb3IgKHZhciBpID0gMDsgaSA8IDEwOyBpKyspIHtcbiAgICAgICAgc2VsZi5oZXJvZXNbaV0uY2xvbmUgPSBrby5vYnNlcnZhYmxlKG5ldyBDbG9uZVZpZXdNb2RlbChoZXJvRGF0YSwgaXRlbURhdGEsIHVuaXREYXRhLCAnbWVlcG8nLCBzZWxmLmhlcm9lc1tpXSkpO1xuICAgICAgICBzZWxmLmhlcm9lc1tpXS51bml0ID0ga28ub2JzZXJ2YWJsZShuZXcgVW5pdFZpZXdNb2RlbChoZXJvRGF0YSwgaXRlbURhdGEsIHVuaXREYXRhLCAnYWJhZGRvbicsIHNlbGYuaGVyb2VzW2ldKSk7XG4gICAgICAgIFxuICAgICAgICBzZWxmLmhlcm9lc1tpXS5zZWxlY3RlZENvbXBhcmUoc2VsZi5oZXJvZXNbaV0uYXZhaWxhYmxlQ29tcGFyZSgpW2kgPCA1ID8gNCArIGkgOiBpIC0gNV0pO1xuICAgICAgICBzZWxmLmhlcm9lc1tpXS5zZWxlY3RlZEVuZW15KHNlbGYuaGVyb2VzW2ldLmF2YWlsYWJsZUVuZW1pZXMoKVtpICUgNV0pO1xuICAgICAgICAvL3NlbGYuaGVyb2VzW2ldLmVuZW15ID0ga28ub2JzZXJ2YWJsZShzZWxmLmhlcm9lc1tpIDwgMiA/IDIgOiAwXSk7XG4gICAgICAgIHNlbGYuaGVyb2VzW2ldLnVuaXQoKS5lbmVteShzZWxmLmhlcm9lc1tpXS5lbmVteSgpKTtcbiAgICAgICAgLy9zZWxmLmhlcm9lc1tpXS51bml0KCkuZW5lbXkgPSBrby5vYnNlcnZhYmxlKHNlbGYuaGVyb2VzW2kgPCAyID8gMiA6IDBdKTtcbiAgICAgICAgLy9zZWxmLmhlcm9lc1tpXS5oZXJvQ29tcGFyZSA9IGtvLm9ic2VydmFibGUoc2VsZi5oZXJvZXNbMSAtIChpICUgMikgKyAoaSA8IDIgPyAwIDogMildKTtcbiAgICAgICAgXG4gICAgICAgIHNlbGYuaGVyb2VzW2ldLnVuaXQoKS5zZWxlY3RlZFVuaXQoc2VsZi5oZXJvZXNbaV0udW5pdCgpLmF2YWlsYWJsZVVuaXRzKClbMF0pO1xuICAgICAgICAvL3NlbGYuaGVyb2VzW2ldLnNlbGVjdGVkSGVybyhzZWxmLmhlcm9lc1tpXS5hdmFpbGFibGVIZXJvZXMoKVtpIDwgMiA/IDAgOiAyXSk7XG4gICAgICAgIHNlbGYuaGVyb2VzW2ldLmlsbHVzaW9ucy5zdWJzY3JpYmUoZnVuY3Rpb24gKGNoYW5nZXMpIHtcbiAgICAgICAgICAgIGZvciAodmFyIGkgPSAwOyBpIDwgY2hhbmdlcy5sZW5ndGg7IGkrKykge1xuICAgICAgICAgICAgICAgIGlmIChjaGFuZ2VzW2ldLnN0YXR1cyA9PSAnYWRkZWQnKSB7XG4gICAgICAgICAgICAgICAgICAgIHZhciBjb2xvciA9IHRoaXMuaW5kZXggPCAyID8gJyM1Y2I4NWMnIDogJyNkOTUzNGYnLFxuICAgICAgICAgICAgICAgICAgICAgICAgaiA9IHVuaXF1ZUlkKCk7XG4gICAgICAgICAgICAgICAgICAgIHNlbGYudGFicygpW3RoaXMuaW5kZXhdLmlsbHVzaW9ucy5wdXNoKFxuICAgICAgICAgICAgICAgICAgICAgICAgbmV3IFRhYihcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAnaWxsdXNpb25UYWInICsgdGhpcy5pbmRleCArICctJyArIGosXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgJ2lsbHVzaW9uUGFuZScgKyB0aGlzLmluZGV4ICsgJy0nICsgaixcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICBzZWxmLmhlcm9lc1t0aGlzLmluZGV4XS5pbGx1c2lvbnMoKVtzZWxmLnRhYnMoKVt0aGlzLmluZGV4XS5pbGx1c2lvbnMoKS5sZW5ndGhdKCksXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgJ0lsbHVzaW9uICcgKyBqLFxuICAgICAgICAgICAgICAgICAgICAgICAgICAgIGNvbG9yLFxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICdpbGx1c2lvbi1wYW5lJylcbiAgICAgICAgICAgICAgICAgICAgKTtcbiAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICB9XG4gICAgICAgIH0sIHt2bTogdGhpcywgaW5kZXg6IGl9LCBcImFycmF5Q2hhbmdlXCIpO1xuICAgIH1cbiAgICAvL3NlbGYuaGVyb2VzWzBdLnNob3dVbml0VGFiKHRydWUpO1xuICAgIHNlbGYuaGVyb2VzWzBdLmJvdW5kKHRydWUpO1xuICAgIHNlbGYudGFicyA9IGtvLm9ic2VydmFibGVBcnJheShbXSk7XG4gICAgdmFyIHRhYnNBcnIgPSBbXTtcbiAgICBmb3IgKHZhciBpID0gMDsgaSA8IDEwOyBpKyspIHtcbiAgICAgICAgLy92YXIgY29sb3IgPSBpIDwgNSA/ICcjNWNiODVjJyA6ICcjZDk1MzRmJztcbiAgICAgICAgdmFyIGNvbG9yID0gUGxheWVyQ29sb3JzW2ldO1xuICAgICAgICB2YXIgdGFiR3JvdXAgPSBuZXcgVGFiR3JvdXAoXG4gICAgICAgICAgICBuZXcgVGFiKCdoZXJvVGFiJyArIGksICdoZXJvUGFuZScgKyBpLCBzZWxmLmhlcm9lc1tpXSwgJ0hlcm8gJyArIGksIGNvbG9yLCAnaGVyby1wYW5lJyksXG4gICAgICAgICAgICBuZXcgVGFiKCd1bml0VGFiJyArIGksICd1bml0UGFuZScgKyBpLCBzZWxmLmhlcm9lc1tpXS51bml0KCksICdVbml0ICcgKyBpLCBjb2xvciwgJ3VuaXQtcGFuZScpLFxuICAgICAgICAgICAgbmV3IFRhYignY2xvbmVUYWInICsgaSwgJ2Nsb25lUGFuZScgKyBpLCBzZWxmLmhlcm9lc1tpXS5jbG9uZSgpLCAnTWVlcG8gQ2xvbmUgJyArIGksIGNvbG9yLCAnY2xvbmUtcGFuZScpXG4gICAgICAgICk7XG4gICAgICAgIC8vc2VsZi50YWJzLnB1c2godGFiR3JvdXApO1xuICAgICAgICB0YWJzQXJyLnB1c2godGFiR3JvdXApO1xuICAgIH1cbiAgICBzZWxmLnRhYnMucHVzaC5hcHBseShzZWxmLnRhYnMsIHRhYnNBcnIpOy8vLnNsaWNlKDAsIDEpKTtcblxuICAgIHNlbGYuc2VsZWN0ZWRJdGVtID0ga28ub2JzZXJ2YWJsZSgpO1xuICAgIHNlbGYubGF5b3V0ID0ga28ub2JzZXJ2YWJsZShcIjFcIik7XG4gICAgc2VsZi5kaXNwbGF5U2hvcCA9IGtvLm9ic2VydmFibGUodHJ1ZSk7XG4gICAgc2VsZi5kaXNwbGF5U2hvcEl0ZW1Ub29sdGlwID0ga28ub2JzZXJ2YWJsZSh0cnVlKTtcbiAgICBzZWxmLmFsbEl0ZW1zID0ga28ub2JzZXJ2YWJsZUFycmF5KFtcbiAgICAgICAge25hbWU6ICdTdHIsIEFnaSwgSW50LCBNUywgVHVybiwgU2lnaHQnLCB2YWx1ZTogJ3N0YXRzMCd9LFxuICAgICAgICB7bmFtZTogJ0FybW9yLCBIZWFsdGgsIE1hbmEsIFJlZ2VuLCBFSFAnLCB2YWx1ZTogJ3N0YXRzMSd9LFxuICAgICAgICB7bmFtZTogJ1BoeXMgUmVzLCBNYWdpYyBSZXMsIExpZmVzdGVhbCwgRXZhc2lvbiwgQmFzaCwgTWlzcycsIHZhbHVlOiAnc3RhdHMyJ30sXG4gICAgICAgIHtuYW1lOiAnRGFtYWdlLCBJQVMsIEJBVCwgQXR0YWNrJywgdmFsdWU6ICdzdGF0czMnfVxuICAgIF0pOyAvLyBJbml0aWFsIGl0ZW1zXG4gICAgc2VsZi5zZWxlY3RlZEl0ZW1zID0ga28ub2JzZXJ2YWJsZUFycmF5KFtdKTsgXG4gICAgc2VsZi5tb3ZlVXAgPSBmdW5jdGlvbiAoKSB7XG4gICAgICAgIHZhciBzdGFydCA9IHNlbGYuYWxsSXRlbXMuaW5kZXhPZihzZWxmLnNlbGVjdGVkSXRlbXMoKVswXSksXG4gICAgICAgICAgICBlbmQgPSBzZWxmLmFsbEl0ZW1zLmluZGV4T2Yoc2VsZi5zZWxlY3RlZEl0ZW1zKClbc2VsZi5zZWxlY3RlZEl0ZW1zKCkubGVuZ3RoIC0gMV0pO1xuICAgICAgICBpZiAoc3RhcnQgPiAwKSB7XG4gICAgICAgICAgICB2YXIgZSA9IHNlbGYuYWxsSXRlbXMuc3BsaWNlKHN0YXJ0IC0gMSwgMSk7XG4gICAgICAgICAgICBzZWxmLmFsbEl0ZW1zLnNwbGljZShlbmQsIDAsIGVbMF0pOyAgICAgICAgICAgIFxuICAgICAgICB9XG4gICAgfTtcbiAgICBzZWxmLm1vdmVEb3duID0gZnVuY3Rpb24gKCkge1xuICAgICAgICB2YXIgc3RhcnQgPSBzZWxmLmFsbEl0ZW1zLmluZGV4T2Yoc2VsZi5zZWxlY3RlZEl0ZW1zKClbMF0pLFxuICAgICAgICAgICAgZW5kID0gc2VsZi5hbGxJdGVtcy5pbmRleE9mKHNlbGYuc2VsZWN0ZWRJdGVtcygpW3NlbGYuc2VsZWN0ZWRJdGVtcygpLmxlbmd0aCAtIDFdKTsgICAgICAgIFxuICAgICAgICBpZiAoZW5kIDwgc2VsZi5hbGxJdGVtcygpLmxlbmd0aCAtIDEpIHtcbiAgICAgICAgICAgIHZhciBlID0gc2VsZi5hbGxJdGVtcy5zcGxpY2UoZW5kICsgMSwgMSk7XG4gICAgICAgICAgICBzZWxmLmFsbEl0ZW1zLnNwbGljZShzdGFydCwgMCwgZVswXSk7XG4gICAgICAgIH1cbiAgICB9O1xuICAgIHNlbGYuc2VsZWN0ZWRUYWJJZCA9IGtvLm9ic2VydmFibGUoJ2hlcm9UYWIwJyk7XG4gICAgc2VsZi5nZXRTZWxlY3RlZFRhYiA9IGZ1bmN0aW9uICh0YWJJZCkge1xuICAgICAgICB2YXIgaW5kaWNlcyA9IHRhYklkLnJlcGxhY2UoJ2hlcm9UYWInLCAnJykucmVwbGFjZSgnY2xvbmVUYWInLCAnJykucmVwbGFjZSgndW5pdFRhYicsICcnKS5yZXBsYWNlKCdpbGx1c2lvblRhYicsICcnKS5zcGxpdCgnLScpLFxuICAgICAgICAgICAgaW5kZXggPSBpbmRpY2VzWzBdLFxuICAgICAgICAgICAgdGFiID0gc2VsZi50YWJzKClbaW5kZXhdO1xuICAgICAgICByZXR1cm4gdGFiO1xuICAgIH1cbiAgICBzZWxmLnNlbGVjdGVkVGFiID0ga28uY29tcHV0ZWQoZnVuY3Rpb24gKCkge1xuICAgICAgICAvKnZhciBpbmRpY2VzID0gc2VsZi5zZWxlY3RlZFRhYklkKCkucmVwbGFjZSgnaGVyb1RhYicsICcnKS5yZXBsYWNlKCdjbG9uZVRhYicsICcnKS5yZXBsYWNlKCd1bml0VGFiJywgJycpLnJlcGxhY2UoJ2lsbHVzaW9uVGFiJywgJycpLnNwbGl0KCctJyksXG4gICAgICAgICAgICBpbmRleCA9IGluZGljZXNbMF0sXG4gICAgICAgICAgICB0YWIgPSBzZWxmLnRhYnMoKVtpbmRleF07Ki9cbiAgICAgICAgdmFyIHRhYiA9IHNlbGYuZ2V0U2VsZWN0ZWRUYWIoc2VsZi5zZWxlY3RlZFRhYklkKCkpO1xuICAgICAgICBpZiAoc2VsZi5zZWxlY3RlZFRhYklkKCkuaW5kZXhPZignaGVybycpICE9IC0xKSB7XG4gICAgICAgICAgICByZXR1cm4gdGFiLmhlcm87XG4gICAgICAgIH1cbiAgICAgICAgZWxzZSBpZiAoc2VsZi5zZWxlY3RlZFRhYklkKCkuaW5kZXhPZigndW5pdCcpICE9IC0xKSB7XG4gICAgICAgICAgICByZXR1cm4gdGFiLnVuaXQ7XG4gICAgICAgIH1cbiAgICAgICAgZWxzZSBpZiAoc2VsZi5zZWxlY3RlZFRhYklkKCkuaW5kZXhPZignY2xvbmUnKSAhPSAtMSkge1xuICAgICAgICAgICAgcmV0dXJuIHRhYi5jbG9uZTtcbiAgICAgICAgfVxuICAgICAgICBlbHNlIGlmIChzZWxmLnNlbGVjdGVkVGFiSWQoKS5pbmRleE9mKCdpbGx1c2lvbicpICE9IC0xKSB7XG4gICAgICAgICAgICByZXR1cm4gdGFiLmlsbHVzaW9ucygpLmZpbmQoZnVuY3Rpb24gKHRhYikge1xuICAgICAgICAgICAgICAgIHJldHVybiB0YWIuaWQgPT0gc2VsZi5zZWxlY3RlZFRhYklkKCk7XG4gICAgICAgICAgICB9KTtcbiAgICAgICAgfVxuICAgICAgICBlbHNlIHtcbiAgICAgICAgICAgIHJldHVybiBzZWxmLnRhYnMoKVswXS5oZXJvO1xuICAgICAgICB9XG4gICAgfSk7XG4gICAgc2VsZi5zZWxlY3RlZFRhYnMgPSBrby5vYnNlcnZhYmxlQXJyYXkoWydoZXJvVGFiMCcsICdoZXJvVGFiMSddKTtcbiAgICAvL3NlbGYuc2VsZWN0ZWRUYWJzLnB1c2goJ2hlcm9UYWIwJyk7XG4gICAgLy9zZWxmLnNlbGVjdGVkVGFicy5wdXNoKCdoZXJvVGFiMScpO1xuICAgIHNlbGYuYm91bmRTZXR0aW5ncyA9IGtvLm9ic2VydmFibGUoZmFsc2UpO1xuICAgIHNlbGYuY2xpY2tUYWIgPSBmdW5jdGlvbiAoZGF0YSwgZXZlbnQsIGluZGV4KSB7XG4gICAgICAgIC8qaWYgKGV2ZW50LnRhcmdldC5pZCAhPSAnc2V0dGluZ3NUYWInKSB7XG4gICAgICAgICAgICBzZWxmLnNlbGVjdGVkVGFiSWQoZXZlbnQudGFyZ2V0LmlkKTtcbiAgICAgICAgfSovXG4gICAgICAgIHNlbGYuc2VsZWN0ZWRUYWJJZChldmVudC50YXJnZXQuaWQpO1xuICAgICAgICBpZiAoc2VsZi5zZWxlY3RlZFRhYnMoKVsxXSAhPSBldmVudC50YXJnZXQuaWQpIHtcbiAgICAgICAgICAgIHNlbGYuc2VsZWN0ZWRUYWJzLnNoaWZ0KCk7XG4gICAgICAgICAgICBzZWxmLnNlbGVjdGVkVGFicy5wdXNoKGV2ZW50LnRhcmdldC5pZCk7XG4gICAgICAgIH1cbiAgICAgICAgaWYgKHNlbGYuc2VsZWN0ZWRUYWIoKS5kYXRhLmhhc093blByb3BlcnR5KCdib3VuZCcpKSB7XG4gICAgICAgICAgICBzZWxmLnNlbGVjdGVkVGFiKCkuZGF0YS5ib3VuZCh0cnVlKTtcblxuICAgICAgICAgICAgLy8gbWFrZSBzdXJlIGJ1aWxkIGV4cGxvcmVyIGdyYXBoIHJlbmRlcnNcbiAgICAgICAgICAgIGlmIChzZWxmLnNlbGVjdGVkVGFiKCkuZGF0YS5oYXNPd25Qcm9wZXJ0eSgnYnVpbGRFeHBsb3JlcicpKSB7XG4gICAgICAgICAgICAgICAgc2V0VGltZW91dChmdW5jdGlvbiAoKSB7XG4gICAgICAgICAgICAgICAgICAgIHNlbGYuc2VsZWN0ZWRUYWIoKS5kYXRhLmJ1aWxkRXhwbG9yZXIuZ3JhcGhEYXRhLnZhbHVlSGFzTXV0YXRlZCgpO1xuICAgICAgICAgICAgICAgIH0sIDApO1xuICAgICAgICAgICAgfVxuICAgICAgICB9XG4gICAgICAgIGlmIChldmVudC50YXJnZXQuaWQgPT09ICdzZXR0aW5nc1RhYicpIHNlbGYuYm91bmRTZXR0aW5ncyh0cnVlKTtcbiAgICB9O1xuICAgIHNlbGYuaXNTZWNvbmRUYWIgPSBmdW5jdGlvbiAoaWQpIHtcbiAgICAgICAgcmV0dXJuIHNlbGYuc2VsZWN0ZWRUYWJzKCkuaW5kZXhPZihpZCkgPiAtMSAmJiBzZWxmLnNlbGVjdGVkVGFiSWQoKSAhPSBpZDtcbiAgICB9XG4gICAgXG4gICAgc2VsZi5zaG93U2lkZVRhYklkID0gZnVuY3Rpb24gKGlkKSB7XG4gICAgICAgIHJldHVybiBzZWxmLnNlbGVjdGVkVGFicygpLmluZGV4T2YoaWQpID4gLTEgJiYgc2VsZi5zaWRlVmlldygpO1xuICAgIH07XG4gICAgXG4gICAgc2VsZi5yZW1vdmVUYWIgPSBmdW5jdGlvbiAoaW5kZXgsIGRhdGEsIGV2ZW50LCB0YWIpIHtcbiAgICAgICAgaWYgKGRhdGEuaWQgPT0gc2VsZi5zZWxlY3RlZFRhYklkKCkpIHtcbiAgICAgICAgICAgIC8vc2VsZi5zZWxlY3RlZFRhYklkKCdoZXJvVGFiMCcpO1xuICAgICAgICAgICAgc2VsZi5jbGlja1RhYihudWxsLCB7dGFyZ2V0OiB7aWQ6ICdoZXJvVGFiMCd9fSk7XG4gICAgICAgICAgICAkKCcjaGVyb1RhYjAnKS50YWIoJ3Nob3cnKTtcbiAgICAgICAgfVxuICAgICAgICBzZWxmLnRhYnMoKVt0YWJdLmlsbHVzaW9ucy5yZW1vdmUoZnVuY3Rpb24gKGlsbHVzaW9uKSB7XG4gICAgICAgICAgICByZXR1cm4gaWxsdXNpb24gPT0gZGF0YTtcbiAgICAgICAgfSk7XG4gICAgICAgIHNlbGYuaGVyb2VzW3RhYl0uaWxsdXNpb25zLnJlbW92ZShmdW5jdGlvbiAoaWxsdXNpb24pIHtcbiAgICAgICAgICAgIHJldHVybiBpbGx1c2lvbigpID09IGRhdGEuZGF0YTtcbiAgICAgICAgfSk7XG4gICAgfTtcbiAgICBcbiAgICBzZWxmLnNpZGVWaWV3ID0ga28ub2JzZXJ2YWJsZShmYWxzZSk7XG4gICAgc2VsZi5zaWRlVmlldy5zdWJzY3JpYmUoZnVuY3Rpb24gKG5ld1ZhbHVlKSB7XG4gICAgICAgIGlmIChuZXdWYWx1ZSkge1xuICAgICAgICAgICAgaWYgKCFzZWxmLnNob3BQb3BvdXQoKSkge1xuICAgICAgICAgICAgICAgIHNlbGYuZGlzcGxheVNob3AoZmFsc2UpO1xuICAgICAgICAgICAgfVxuICAgICAgICAgICAgZm9yICh2YXIgaSA9IDA7IGkgPCBzZWxmLnNlbGVjdGVkVGFicygpLmxlbmd0aDsgaSsrKSB7XG4gICAgICAgICAgICAgICAgdmFyIHRhYiA9IHNlbGYuZ2V0U2VsZWN0ZWRUYWIoc2VsZi5zZWxlY3RlZFRhYnMoKVtpXSk7XG4gICAgICAgICAgICAgICAgaWYgKHRhYiAmJiB0YWIuaGVyby5kYXRhLmhhc093blByb3BlcnR5KCdib3VuZCcpKSB7XG4gICAgICAgICAgICAgICAgICAgIHRhYi5oZXJvLmRhdGEuYm91bmQodHJ1ZSk7XG4gICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgfVxuICAgICAgICAgICAgc2VsZi5sYXlvdXQoXCIwXCIpO1xuICAgICAgICB9XG4gICAgfSk7XG4gICAgdmFyICR3aW5kb3cgPSAkKHdpbmRvdyk7XG4gICAgc2VsZi53aW5kb3dXaWR0aCA9IGtvLm9ic2VydmFibGUoJHdpbmRvdy53aWR0aCgpKTtcbiAgICBzZWxmLndpbmRvd0hlaWdodCA9IGtvLm9ic2VydmFibGUoJHdpbmRvdy5oZWlnaHQoKSk7XG4gICAgJHdpbmRvdy5yZXNpemUoZnVuY3Rpb24gKCkgeyBcbiAgICAgICAgc2VsZi53aW5kb3dXaWR0aCgkd2luZG93LndpZHRoKCkpO1xuICAgICAgICBzZWxmLndpbmRvd0hlaWdodCgkd2luZG93LmhlaWdodCgpKTtcbiAgICB9KTtcbiAgICBzZWxmLnNob3BEb2NrID0ga28ub2JzZXJ2YWJsZShmYWxzZSk7XG4gICAgc2VsZi5zaG9wRG9jay5zdWJzY3JpYmUoZnVuY3Rpb24gKG5ld1ZhbHVlKSB7XG4gICAgICAgIGlmIChuZXdWYWx1ZSkge1xuICAgICAgICAgICAgc2VsZi5zaG9wUG9wb3V0KGZhbHNlKTtcbiAgICAgICAgfVxuICAgICAgICBlbHNlIHtcbiAgICAgICAgfVxuICAgIH0pO1xuXG4gICAgc2VsZi5zaG9wRG9ja1RyaWdnZXIgPSBrby5jb21wdXRlZChmdW5jdGlvbiAoKSB7XG4gICAgICAgIHNlbGYud2luZG93V2lkdGgoKTtcbiAgICAgICAgc2VsZi5zaG9wRG9jaygpO1xuICAgIH0pO1xuICAgIHNlbGYuc2hvcFBvcG91dCA9IGtvLm9ic2VydmFibGUoZmFsc2UpO1xuICAgIHNlbGYuc2hvcFBvcG91dC5zdWJzY3JpYmUoZnVuY3Rpb24gKG5ld1ZhbHVlKSB7XG4gICAgICAgIGlmIChuZXdWYWx1ZSkge1xuICAgICAgICAgICAgc2VsZi5kaXNwbGF5U2hvcCh0cnVlKTtcbiAgICAgICAgICAgICQoIFwiI3Nob3AtZGlhbG9nXCIgKS5kaWFsb2coe1xuICAgICAgICAgICAgICAgIG1pbldpZHRoOiAzODAsXG4gICAgICAgICAgICAgICAgbWluSGVpZ2h0OiAwLFxuICAgICAgICAgICAgICAgIGNsb3NlVGV4dDogXCJcIixcbiAgICAgICAgICAgICAgICBvcGVuOiBmdW5jdGlvbiAoIGV2ZW50LCB1aSApIHtcbiAgICAgICAgICAgICAgICAgICAgJChldmVudC50YXJnZXQub2Zmc2V0UGFyZW50KS5maW5kKCcudWktZGlhbG9nLXRpdGxlYmFyJykuZmluZCgnYnV0dG9uJylcbiAgICAgICAgICAgICAgICAgICAgICAgIC5hZGRDbGFzcygnY2xvc2UgZ2x5cGhpY29uIGdseXBoaWNvbi1yZW1vdmUgc2hvcC1idXR0b24gYnRuIGJ0bi1kZWZhdWx0IGJ0bi14cyBwdWxsLXJpZ2h0JylcbiAgICAgICAgICAgICAgICAgICAgICAgIC5yZW1vdmVDbGFzcygndWktYnV0dG9uIHVpLXdpZGdldCB1aS1zdGF0ZS1kZWZhdWx0IHVpLWNvcm5lci1hbGwgdWktYnV0dG9uLWljb24tb25seSB1aS1kaWFsb2ctdGl0bGViYXItY2xvc2UgY2xvc2UnKVxuICAgICAgICAgICAgICAgICAgICAgICAgLmNzcygnbWFyZ2luLXJpZ2h0JywnMHB4JylcbiAgICAgICAgICAgICAgICAgICAgICAgIC5wYXJlbnQoKVxuICAgICAgICAgICAgICAgICAgICAgICAgICAgIC5hcHBlbmQoJCgnI3Nob3AtbWluaW1pemUnKSlcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAuYXBwZW5kKCQoJyNzaG9wLW1heGltaXplJykpO1xuICAgICAgICAgICAgICAgICAgICAkKGV2ZW50LnRhcmdldC5vZmZzZXRQYXJlbnQpLmZpbmQoJy51aS1kaWFsb2ctdGl0bGViYXInKS5kYmxjbGljayhmdW5jdGlvbiAoKSB7XG4gICAgICAgICAgICAgICAgICAgICAgICBzZWxmLmRpc3BsYXlTaG9wKCFzZWxmLmRpc3BsYXlTaG9wKCkpO1xuICAgICAgICAgICAgICAgICAgICB9KTtcbiAgICAgICAgICAgICAgICB9LFxuICAgICAgICAgICAgICAgIGNsb3NlOiBmdW5jdGlvbiAoIGV2ZW50LCB1aSApIHtcbiAgICAgICAgICAgICAgICAgICAgc2VsZi5zaG9wUG9wb3V0KGZhbHNlKTtcbiAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICB9KTtcbiAgICAgICAgfVxuICAgICAgICBlbHNlIHtcbiAgICAgICAgICAgICQoJyNzaG9wLWNvbnRhaW5lcicpLnByZXBlbmQoJCgnI3Nob3AtbWluaW1pemUnKSkucHJlcGVuZCgkKCcjc2hvcC1tYXhpbWl6ZScpKTtcbiAgICAgICAgICAgICQoIFwiI3Nob3AtZGlhbG9nXCIgKS5kaWFsb2coXCJkZXN0cm95XCIpO1xuICAgICAgICB9XG4gICAgfSk7XG5cbiAgICBzZWxmLmFkZEl0ZW0gPSBmdW5jdGlvbiAoZGF0YSwgZXZlbnQpIHtcbiAgICAgICAgc2VsZi5zZWxlY3RlZFRhYigpLmRhdGEuYnVpbGRFeHBsb3Jlci5nZXRTZWxlY3RlZEludmVudG9yeSgpLmFkZEl0ZW0oZGF0YSwgZXZlbnQpO1xuICAgIH1cbiAgICBzZWxmLml0ZW1PcHRpb25zID0ga28uY29tcHV0ZWQoZnVuY3Rpb24gKCkge1xuICAgICAgICByZXR1cm4gc2VsZi5zZWxlY3RlZFRhYigpLmRhdGEuaW52ZW50b3J5Lml0ZW1PcHRpb25zKCk7XG4gICAgfSk7XG4gICAgXG4gICAgc2VsZi5jaGFuZ2VTZWxlY3RlZEl0ZW0gPSBmdW5jdGlvbiAoZGF0YSwgZXZlbnQpIHtcbiAgICAgICAgc2VsZi5pdGVtSW5wdXRWYWx1ZSgxKTtcbiAgICAgICAgc2VsZi5zZWxlY3RlZEl0ZW0oZXZlbnQudGFyZ2V0LmlkKTtcbiAgICB9XG4gICAgXG4gICAgc2VsZi5nZXRJdGVtVG9vbHRpcERhdGEgPSBrby5jb21wdXRlZChmdW5jdGlvbiAoKSB7XG4gICAgICAgIHJldHVybiBnZXRJdGVtVG9vbHRpcERhdGEoaXRlbURhdGEsIHNlbGYuc2VsZWN0ZWRJdGVtKCkpO1xuICAgIH0sIHRoaXMpO1xuICAgIHNlbGYuZ2V0SXRlbUlucHV0TGFiZWwgPSBrby5jb21wdXRlZChmdW5jdGlvbiAoKSB7XG4gICAgICAgIGlmIChzdGFja2FibGVJdGVtcy5pbmRleE9mKHNlbGYuc2VsZWN0ZWRJdGVtKCkpICE9IC0xKSB7XG4gICAgICAgICAgICByZXR1cm4gJ1N0YWNrIFNpemUnXG4gICAgICAgIH1cbiAgICAgICAgZWxzZSBpZiAobGV2ZWxJdGVtcy5pbmRleE9mKHNlbGYuc2VsZWN0ZWRJdGVtKCkpICE9IC0xKSB7XG4gICAgICAgICAgICByZXR1cm4gJ1VwZ3JhZGUgTGV2ZWwnXG4gICAgICAgIH1cbiAgICAgICAgZWxzZSBpZiAoc2VsZi5zZWxlY3RlZEl0ZW0oKSA9PSAnYmxvb2RzdG9uZScpIHtcbiAgICAgICAgICAgIHJldHVybiAnQ2hhcmdlcydcbiAgICAgICAgfVxuICAgICAgICBlbHNlIHtcbiAgICAgICAgICAgIHJldHVybiAnJ1xuICAgICAgICB9XG4gICAgfSwgdGhpcyk7XG4gICAgc2VsZi5pdGVtSW5wdXRWYWx1ZSA9IGtvLm9ic2VydmFibGUoMSk7XG4gICAgc2VsZi5zYXZlTGluayA9IGtvLm9ic2VydmFibGUoKTtcbiAgICBzZWxmLmdldEFwcFN0YXRlID0gZnVuY3Rpb24gKCkge1xuICAgICAgICB2YXIgZGF0YSA9IHtcbiAgICAgICAgICAgIHNlbGVjdGVkSXRlbTogc2VsZi5zZWxlY3RlZEl0ZW0sXG4gICAgICAgICAgICBsYXlvdXQ6IHNlbGYubGF5b3V0LFxuICAgICAgICAgICAgZGlzcGxheVNob3A6IHNlbGYuZGlzcGxheVNob3AsXG4gICAgICAgICAgICBkaXNwbGF5U2hvcEl0ZW1Ub29sdGlwOiBzZWxmLmRpc3BsYXlTaG9wSXRlbVRvb2x0aXAsXG4gICAgICAgICAgICBhbGxJdGVtczogc2VsZi5hbGxJdGVtcyxcbiAgICAgICAgICAgIHNlbGVjdGVkSXRlbXM6IHNlbGYuc2VsZWN0ZWRJdGVtcyxcbiAgICAgICAgICAgIHNlbGVjdGVkVGFiSWQ6IHNlbGYuc2VsZWN0ZWRUYWJJZCxcbiAgICAgICAgICAgIHNlbGVjdGVkVGFiczogc2VsZi5zZWxlY3RlZFRhYnMsXG4gICAgICAgICAgICBib3VuZFNldHRpbmdzOiBzZWxmLmJvdW5kU2V0dGluZ3MsXG4gICAgICAgICAgICBzaWRlVmlldzogc2VsZi5zaWRlVmlldyxcbiAgICAgICAgICAgIHdpbmRvd1dpZHRoOiBzZWxmLndpbmRvd1dpZHRoLFxuICAgICAgICAgICAgd2luZG93SGVpZ2h0OiBzZWxmLndpbmRvd0hlaWdodCxcbiAgICAgICAgICAgIHNob3BEb2NrOiBzZWxmLnNob3BEb2NrLFxuICAgICAgICAgICAgc2hvcFBvcG91dDogc2VsZi5zaG9wUG9wb3V0LFxuICAgICAgICAgICAgaXRlbUlucHV0VmFsdWU6IHNlbGYuaXRlbUlucHV0VmFsdWUsXG4gICAgICAgICAgICBzYXZlTGluazogc2VsZi5zYXZlTGlua1xuICAgICAgICB9XG4gICAgICAgIGRhdGEudGFicyA9IHNlbGYudGFicygpLm1hcChmdW5jdGlvbiAodGFiKSB7IHJldHVybiB0YWIudG9KUygpIH0pO1xuICAgICAgICByZXR1cm4ga28udG9KUyhkYXRhKTtcbiAgICB9XG4gICAgc2VsZi5nZXRTYXZlRGF0YSA9IGZ1bmN0aW9uICgpIHtcbiAgICAgICAgdmFyIGRhdGEgPSB7XG4gICAgICAgICAgICB2ZXJzaW9uOiBcIjEuMy4wXCIsXG4gICAgICAgICAgICBoZXJvZXM6IFtdXG4gICAgICAgIH1cbiAgICAgICAgZm9yICh2YXIgaSA9IDA7IGkgPCAxMDsgaSsrKSB7XG4gICAgICAgICAgICB2YXIgaGVybyA9IHNlbGYuaGVyb2VzW2ldO1xuICAgICAgICAgICAgdmFyIGQgPSB7XG4gICAgICAgICAgICAgICAgaGVybzogaGVyby5zZWxlY3RlZEhlcm8oKS5oZXJvTmFtZSxcbiAgICAgICAgICAgICAgICBsZXZlbDogaGVyby5zZWxlY3RlZEhlcm9MZXZlbCgpLFxuICAgICAgICAgICAgICAgIGl0ZW1zOiBbXSxcbiAgICAgICAgICAgICAgICBhYmlsaXRpZXM6IFtdLFxuICAgICAgICAgICAgICAgIHNraWxsUG9pbnRIaXN0b3J5OiBoZXJvLnNraWxsUG9pbnRIaXN0b3J5KCksXG4gICAgICAgICAgICAgICAgYnVmZnM6IFtdLFxuICAgICAgICAgICAgICAgIGl0ZW1CdWZmczogW10sXG4gICAgICAgICAgICAgICAgZGVidWZmczogW10sXG4gICAgICAgICAgICAgICAgaXRlbURlYnVmZnM6IFtdLFxuICAgICAgICAgICAgICAgIGdyYXBoRGF0YTogW10sXG4gICAgICAgICAgICAgICAgZW5lbXlJbmRleDogaGVyby5lbmVteSgpLmluZGV4KCksXG4gICAgICAgICAgICAgICAgaGVyb0NvbXBhcmVJbmRleDogaGVyby5oZXJvQ29tcGFyZSgpLmluZGV4KClcbiAgICAgICAgICAgIH1cbiAgICAgICAgICAgIC8vIGl0ZW1zXG4gICAgICAgICAgICBmb3IgKHZhciBqID0gMDsgaiA8IGhlcm8uaW52ZW50b3J5Lml0ZW1zKCkubGVuZ3RoOyBqKyspIHtcbiAgICAgICAgICAgICAgICBkLml0ZW1zLnB1c2goa28udG9KUyhoZXJvLmludmVudG9yeS5pdGVtcygpW2pdKSk7XG4gICAgICAgICAgICB9XG4gICAgICAgICAgICAvLyBhYmlsaXRpZXNcbiAgICAgICAgICAgIGZvciAodmFyIGogPSAwOyBqIDwgaGVyby5hYmlsaXR5KCkuYWJpbGl0aWVzKCkubGVuZ3RoOyBqKyspIHtcbiAgICAgICAgICAgICAgICBkLmFiaWxpdGllcy5wdXNoKHtcbiAgICAgICAgICAgICAgICAgICAgbGV2ZWw6IGhlcm8uYWJpbGl0eSgpLmFiaWxpdGllcygpW2pdLmxldmVsKCksXG4gICAgICAgICAgICAgICAgICAgIGlzQWN0aXZlOiBoZXJvLmFiaWxpdHkoKS5hYmlsaXRpZXMoKVtqXS5pc0FjdGl2ZSgpXG4gICAgICAgICAgICAgICAgfSk7XG4gICAgICAgICAgICB9XG4gICAgICAgICAgICAvLyBidWZmc1xuICAgICAgICAgICAgZm9yICh2YXIgaiA9IDA7IGogPCBoZXJvLmJ1ZmZzLmJ1ZmZzKCkubGVuZ3RoOyBqKyspIHtcbiAgICAgICAgICAgICAgICBkLmJ1ZmZzLnB1c2goe1xuICAgICAgICAgICAgICAgICAgICBuYW1lOiBoZXJvLmJ1ZmZzLmJ1ZmZzKClbal0ubmFtZSxcbiAgICAgICAgICAgICAgICAgICAgbGV2ZWw6IGhlcm8uYnVmZnMuYnVmZnMoKVtqXS5kYXRhLmxldmVsKCksXG4gICAgICAgICAgICAgICAgICAgIGlzQWN0aXZlOiBoZXJvLmJ1ZmZzLmJ1ZmZzKClbal0uZGF0YS5pc0FjdGl2ZSgpXG4gICAgICAgICAgICAgICAgfSk7XG4gICAgICAgICAgICB9XG4gICAgICAgICAgICBcbiAgICAgICAgICAgIC8vIGRlYnVmZnNcbiAgICAgICAgICAgIGZvciAodmFyIGogPSAwOyBqIDwgaGVyby5kZWJ1ZmZzLmJ1ZmZzKCkubGVuZ3RoOyBqKyspIHtcbiAgICAgICAgICAgICAgICBkLmRlYnVmZnMucHVzaCh7XG4gICAgICAgICAgICAgICAgICAgIG5hbWU6IGhlcm8uZGVidWZmcy5idWZmcygpW2pdLm5hbWUsXG4gICAgICAgICAgICAgICAgICAgIGxldmVsOiBoZXJvLmRlYnVmZnMuYnVmZnMoKVtqXS5kYXRhLmxldmVsKCksXG4gICAgICAgICAgICAgICAgICAgIGlzQWN0aXZlOiBoZXJvLmRlYnVmZnMuYnVmZnMoKVtqXS5kYXRhLmlzQWN0aXZlKClcbiAgICAgICAgICAgICAgICB9KTtcbiAgICAgICAgICAgIH1cblxuICAgICAgICAgICAgLy8gaXRlbSBidWZmc1xuICAgICAgICAgICAgZm9yICh2YXIgaiA9IDA7IGogPCBoZXJvLmJ1ZmZzLml0ZW1CdWZmcy5pdGVtcygpLmxlbmd0aDsgaisrKSB7XG4gICAgICAgICAgICAgICAgZC5pdGVtQnVmZnMucHVzaChrby50b0pTKGhlcm8uYnVmZnMuaXRlbUJ1ZmZzLml0ZW1zKClbal0pKTtcbiAgICAgICAgICAgIH1cbiAgICAgICAgICAgIFxuICAgICAgICAgICAgLy8gaXRlbSBkZWJ1ZmZzXG4gICAgICAgICAgICBmb3IgKHZhciBqID0gMDsgaiA8IGhlcm8uZGVidWZmcy5pdGVtQnVmZnMuaXRlbXMoKS5sZW5ndGg7IGorKykge1xuICAgICAgICAgICAgICAgIGQuaXRlbURlYnVmZnMucHVzaChrby50b0pTKGhlcm8uZGVidWZmcy5pdGVtQnVmZnMuaXRlbXMoKVtqXSkpO1xuICAgICAgICAgICAgfVxuICAgICAgICAgICAgXG4gICAgICAgICAgICAvLyBncmFwaCBkYXRhXG4gICAgICAgICAgICBkLmdyYXBoRGF0YSA9IGtvLnRvSlMoaGVyby5idWlsZEV4cGxvcmVyLmdyYXBoRGF0YSk7XG4gICAgICAgICAgICBcbiAgICAgICAgICAgIGRhdGEuaGVyb2VzLnB1c2goZCk7XG4gICAgICAgIH1cbiAgICAgICAgcmV0dXJuIGRhdGE7XG4gICAgfVxuICAgIHNlbGYuc2F2ZSA9IGZ1bmN0aW9uICgpIHtcbiAgICAgICAgdmFyIGRhdGEgPSBzZWxmLmdldFNhdmVEYXRhKCk7XG4gICAgICAgIHZhciBzZXJpYWxpemVkID0gSlNPTi5zdHJpbmdpZnkoZGF0YSk7XG4gICAgICAgICQuYWpheCh7XG4gICAgICAgICAgICB0eXBlOiBcIlBPU1RcIixcbiAgICAgICAgICAgIHVybDogXCJzYXZlLnBocFwiLFxuICAgICAgICAgICAgZGF0YTogeydkYXRhJzogc2VyaWFsaXplZH0sXG4gICAgICAgICAgICBkYXRhVHlwZTogXCJqc29uXCIsXG4gICAgICAgICAgICBzdWNjZXNzOiBmdW5jdGlvbiAoZGF0YSl7XG4gICAgICAgICAgICAgICAgc2VsZi5zYXZlTGluayhbbG9jYXRpb24ucHJvdG9jb2wsICcvLycsIGxvY2F0aW9uLmhvc3QsIGxvY2F0aW9uLnBhdGhuYW1lXS5qb2luKCcnKSArICc/aWQ9JyArIGRhdGEuZmlsZSk7XG4gICAgICAgICAgICB9LFxuICAgICAgICAgICAgZmFpbHVyZTogZnVuY3Rpb24gKGVyck1zZykge1xuICAgICAgICAgICAgICAgIGFsZXJ0KFwiU2F2ZSByZXF1ZXN0IGZhaWxlZC5cIik7XG4gICAgICAgICAgICB9XG4gICAgICAgIH0pO1xuICAgIH1cbiAgICBzZWxmLmxvYWQgPSBmdW5jdGlvbiAoZGF0YSkge1xuICAgICAgICBmb3IgKHZhciBpID0gMDsgaSA8IGRhdGEuaGVyb2VzLmxlbmd0aDsgaSsrKSB7XG4gICAgICAgICAgICB2YXIgaGVybyA9IHNlbGYuaGVyb2VzW2ldO1xuICAgICAgICAgICAgaGVyby5zZWxlY3RlZEhlcm8oZmluZFdoZXJlKGhlcm8uYXZhaWxhYmxlSGVyb2VzKCksIHsnaGVyb05hbWUnOiBkYXRhLmhlcm9lc1tpXS5oZXJvfSkpO1xuICAgICAgICAgICAgaGVyby5zZWxlY3RlZEhlcm9MZXZlbChkYXRhLmhlcm9lc1tpXS5sZXZlbCk7XG4gICAgICAgICAgICBoZXJvLmludmVudG9yeS5pdGVtcy5yZW1vdmVBbGwoKTtcbiAgICAgICAgICAgIGhlcm8uaW52ZW50b3J5LmFjdGl2ZUl0ZW1zLnJlbW92ZUFsbCgpO1xuICAgICAgICAgICAgXG4gICAgICAgICAgICAvLyBsb2FkIGhlcm8gY29tcGFyZVxuICAgICAgICAgICAgaWYgKGRhdGEuaGVyb2VzW2ldLmhhc093blByb3BlcnR5KCdoZXJvQ29tcGFyZUluZGV4JykpIHtcbiAgICAgICAgICAgICAgICB2YXIgbyA9IGhlcm8uYXZhaWxhYmxlQ29tcGFyZSgpLmZpbHRlcihmdW5jdGlvbiAob3B0aW9uKSB7XG4gICAgICAgICAgICAgICAgICAgIHJldHVybiBvcHRpb24uaGVyby5pbmRleCgpID09IGRhdGEuaGVyb2VzW2ldLmhlcm9Db21wYXJlSW5kZXg7XG4gICAgICAgICAgICAgICAgfSk7XG4gICAgICAgICAgICAgICAgaWYgKG8ubGVuZ3RoKSB7XG4gICAgICAgICAgICAgICAgICAgIGhlcm8uc2VsZWN0ZWRDb21wYXJlKG9bMF0pO1xuICAgICAgICAgICAgICAgICAgICBoZXJvLmhlcm9Db21wYXJlKG9bMF0uaGVybyk7XG4gICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgfVxuICAgICAgICAgICAgXG4gICAgICAgICAgICAvLyBsb2FkIGVuZW15XG4gICAgICAgICAgICBpZiAoZGF0YS5oZXJvZXNbaV0uaGFzT3duUHJvcGVydHkoJ2VuZW15SW5kZXgnKSkge1xuICAgICAgICAgICAgICAgIHZhciBvID0gaGVyby5hdmFpbGFibGVFbmVtaWVzKCkuZmlsdGVyKGZ1bmN0aW9uIChvcHRpb24pIHtcbiAgICAgICAgICAgICAgICAgICAgcmV0dXJuIG9wdGlvbi5oZXJvLmluZGV4KCkgPT0gZGF0YS5oZXJvZXNbaV0uZW5lbXlJbmRleDtcbiAgICAgICAgICAgICAgICB9KTtcbiAgICAgICAgICAgICAgICBpZiAoby5sZW5ndGgpIHtcbiAgICAgICAgICAgICAgICAgICAgaGVyby5zZWxlY3RlZEVuZW15KG9bMF0pO1xuICAgICAgICAgICAgICAgICAgICBoZXJvLmVuZW15KG9bMF0uaGVybyk7XG4gICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgfVxuICAgICAgICAgICAgXG4gICAgICAgICAgICAvLyBsb2FkIGl0ZW1zXG4gICAgICAgICAgICBmb3IgKHZhciBqID0gMDsgaiA8IGRhdGEuaGVyb2VzW2ldLml0ZW1zLmxlbmd0aDsgaisrKSB7XG4gICAgICAgICAgICAgICAgdmFyIGl0ZW0gPSBkYXRhLmhlcm9lc1tpXS5pdGVtc1tqXTtcbiAgICAgICAgICAgICAgICB2YXIgbmV3X2l0ZW0gPSB7XG4gICAgICAgICAgICAgICAgICAgIGl0ZW06IGl0ZW0uaXRlbSxcbiAgICAgICAgICAgICAgICAgICAgc3RhdGU6IGtvLm9ic2VydmFibGUoaXRlbS5zdGF0ZSksXG4gICAgICAgICAgICAgICAgICAgIHNpemU6IGl0ZW0uc2l6ZSxcbiAgICAgICAgICAgICAgICAgICAgZW5hYmxlZDoga28ub2JzZXJ2YWJsZShpdGVtLmVuYWJsZWQpXG4gICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICAgIGhlcm8uaW52ZW50b3J5Lml0ZW1zLnB1c2gobmV3X2l0ZW0pO1xuICAgICAgICAgICAgfVxuXG4gICAgICAgICAgICAvLyBsb2FkIGFiaWxpdGllc1xuICAgICAgICAgICAgZm9yICh2YXIgaiA9IDA7IGogPCBkYXRhLmhlcm9lc1tpXS5hYmlsaXRpZXMubGVuZ3RoOyBqKyspIHtcbiAgICAgICAgICAgICAgICBoZXJvLmFiaWxpdHkoKS5hYmlsaXRpZXMoKVtqXS5sZXZlbChkYXRhLmhlcm9lc1tpXS5hYmlsaXRpZXNbal0ubGV2ZWwpO1xuICAgICAgICAgICAgICAgIGhlcm8uYWJpbGl0eSgpLmFiaWxpdGllcygpW2pdLmlzQWN0aXZlKGRhdGEuaGVyb2VzW2ldLmFiaWxpdGllc1tqXS5pc0FjdGl2ZSk7XG4gICAgICAgICAgICB9XG4gICAgICAgICAgICBoZXJvLnNraWxsUG9pbnRIaXN0b3J5KGRhdGEuaGVyb2VzW2ldLnNraWxsUG9pbnRIaXN0b3J5KTtcblxuICAgICAgICAgICAgLy8gbG9hZCBidWZmc1xuICAgICAgICAgICAgZm9yICh2YXIgaiA9IDA7IGogPCBkYXRhLmhlcm9lc1tpXS5idWZmcy5sZW5ndGg7IGorKykge1xuICAgICAgICAgICAgICAgIGhlcm8uYnVmZnMuc2VsZWN0ZWRCdWZmKGZpbmRXaGVyZShoZXJvLmJ1ZmZzLmF2YWlsYWJsZUJ1ZmZzKCksIHtidWZmTmFtZTogZGF0YS5oZXJvZXNbaV0uYnVmZnNbal0ubmFtZX0pKTtcbiAgICAgICAgICAgICAgICBoZXJvLmJ1ZmZzLmFkZEJ1ZmYoaGVybywge30pO1xuICAgICAgICAgICAgICAgIHZhciBiID0gZmluZFdoZXJlKGhlcm8uYnVmZnMuYnVmZnMoKSwgeyBuYW1lOiBkYXRhLmhlcm9lc1tpXS5idWZmc1tqXS5uYW1lIH0pO1xuICAgICAgICAgICAgICAgIGIuZGF0YS5sZXZlbChkYXRhLmhlcm9lc1tpXS5idWZmc1tqXS5sZXZlbCk7XG4gICAgICAgICAgICAgICAgYi5kYXRhLmlzQWN0aXZlKGRhdGEuaGVyb2VzW2ldLmJ1ZmZzW2pdLmlzQWN0aXZlKTtcbiAgICAgICAgICAgIH1cblxuICAgICAgICAgICAgLy8gbG9hZCBkZWJ1ZmZzXG4gICAgICAgICAgICBmb3IgKHZhciBqID0gMDsgaiA8IGRhdGEuaGVyb2VzW2ldLmRlYnVmZnMubGVuZ3RoOyBqKyspIHtcbiAgICAgICAgICAgICAgICBoZXJvLmRlYnVmZnMuc2VsZWN0ZWRCdWZmKGZpbmRXaGVyZShoZXJvLmRlYnVmZnMuYXZhaWxhYmxlRGVidWZmcygpLCB7YnVmZk5hbWU6IGRhdGEuaGVyb2VzW2ldLmRlYnVmZnNbal0ubmFtZX0pKTtcbiAgICAgICAgICAgICAgICBoZXJvLmRlYnVmZnMuYWRkQnVmZihoZXJvLCB7fSk7XG4gICAgICAgICAgICAgICAgdmFyIGIgPSBmaW5kV2hlcmUoaGVyby5kZWJ1ZmZzLmJ1ZmZzKCksIHsgbmFtZTogZGF0YS5oZXJvZXNbaV0uZGVidWZmc1tqXS5uYW1lIH0pO1xuICAgICAgICAgICAgICAgIGIuZGF0YS5sZXZlbChkYXRhLmhlcm9lc1tpXS5kZWJ1ZmZzW2pdLmxldmVsKTtcbiAgICAgICAgICAgICAgICBiLmRhdGEuaXNBY3RpdmUoZGF0YS5oZXJvZXNbaV0uZGVidWZmc1tqXS5pc0FjdGl2ZSk7XG4gICAgICAgICAgICB9XG5cbiAgICAgICAgICAgIC8vIGxvYWQgaXRlbSBidWZmc1xuICAgICAgICAgICAgaWYgKGRhdGEuaGVyb2VzW2ldLml0ZW1CdWZmcykge1xuICAgICAgICAgICAgICAgIGZvciAodmFyIGogPSAwOyBqIDwgZGF0YS5oZXJvZXNbaV0uaXRlbUJ1ZmZzLmxlbmd0aDsgaisrKSB7XG4gICAgICAgICAgICAgICAgICAgIHZhciBpdGVtID0gZGF0YS5oZXJvZXNbaV0uaXRlbUJ1ZmZzW2pdO1xuICAgICAgICAgICAgICAgICAgICB2YXIgbmV3X2l0ZW0gPSB7XG4gICAgICAgICAgICAgICAgICAgICAgICBpdGVtOiBpdGVtLml0ZW0sXG4gICAgICAgICAgICAgICAgICAgICAgICBzdGF0ZToga28ub2JzZXJ2YWJsZShpdGVtLnN0YXRlKSxcbiAgICAgICAgICAgICAgICAgICAgICAgIHNpemU6IGl0ZW0uc2l6ZSxcbiAgICAgICAgICAgICAgICAgICAgICAgIGVuYWJsZWQ6IGtvLm9ic2VydmFibGUoaXRlbS5lbmFibGVkKVxuICAgICAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgICAgICAgIGhlcm8uYnVmZnMuaXRlbUJ1ZmZzLml0ZW1zLnB1c2gobmV3X2l0ZW0pO1xuICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgIH1cblxuICAgICAgICAgICAgLy8gbG9hZCBpdGVtIGRlYnVmZnNcbiAgICAgICAgICAgIGlmIChkYXRhLmhlcm9lc1tpXS5pdGVtRGVidWZmcykge1xuICAgICAgICAgICAgICAgIGZvciAodmFyIGogPSAwOyBqIDwgZGF0YS5oZXJvZXNbaV0uaXRlbURlYnVmZnMubGVuZ3RoOyBqKyspIHtcbiAgICAgICAgICAgICAgICAgICAgdmFyIGl0ZW0gPSBkYXRhLmhlcm9lc1tpXS5pdGVtRGVidWZmc1tqXTtcbiAgICAgICAgICAgICAgICAgICAgdmFyIG5ld19pdGVtID0ge1xuICAgICAgICAgICAgICAgICAgICAgICAgaXRlbTogaXRlbS5pdGVtLFxuICAgICAgICAgICAgICAgICAgICAgICAgc3RhdGU6IGtvLm9ic2VydmFibGUoaXRlbS5zdGF0ZSksXG4gICAgICAgICAgICAgICAgICAgICAgICBzaXplOiBpdGVtLnNpemUsXG4gICAgICAgICAgICAgICAgICAgICAgICBlbmFibGVkOiBrby5vYnNlcnZhYmxlKGl0ZW0uZW5hYmxlZClcbiAgICAgICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICAgICAgICBoZXJvLmRlYnVmZnMuaXRlbUJ1ZmZzLml0ZW1zLnB1c2gobmV3X2l0ZW0pO1xuICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgIH1cbiAgICAgICAgICAgIFxuICAgICAgICAgICAgLy8gbG9hZCBncmFwaCBkYXRhXG4gICAgICAgICAgICBpZiAoZGF0YS5oZXJvZXNbaV0uZ3JhcGhEYXRhKSB7XG4gICAgICAgICAgICAgICAgaGVyby5idWlsZEV4cGxvcmVyLmxvYWRHcmFwaERhdGEoZGF0YS5oZXJvZXNbaV0uZ3JhcGhEYXRhKTtcbiAgICAgICAgICAgIH1cbiAgICAgICAgfVxuICAgIH1cbiAgICBcbiAgICBzZWxmLnNlbmRSZXBvcnQgPSBmdW5jdGlvbiAoKSB7XG4gICAgICAgIGlmICgkKCcjQnVnUmVwb3J0Rm9ybVRleHQnKS52YWwoKSkge1xuICAgICAgICAgICAgJC5wb3N0KCBcInJlcG9ydC5waHBcIiwgeyBuYW1lOiAkKCcjQnVnUmVwb3J0Rm9ybU5hbWUnKS52YWwoKSwgZW1haWw6ICQoJyNCdWdSZXBvcnRGb3JtRW1haWwnKS52YWwoKSwgYm9keTogJCgnI0J1Z1JlcG9ydEZvcm1UZXh0JykudmFsKCkgfSlcbiAgICAgICAgICAgIC5kb25lKGZ1bmN0aW9uIChkYXRhKSB7XG4gICAgICAgICAgICAgICAgaWYgKGRhdGEgPT0gJ1N1Y2Nlc3MnKSB7XG4gICAgICAgICAgICAgICAgICAgIGFsZXJ0KCdSZXBvcnQgc3VjY2Vzc2Z1bGx5IHNlbnQuIFRoYW5rcyEnKTtcbiAgICAgICAgICAgICAgICAgICAgJCgnI0J1Z1JlcG9ydEZvcm1UZXh0JykudmFsKCcnKTtcbiAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgICAgZWxzZSB7XG4gICAgICAgICAgICAgICAgICAgIGFsZXJ0KCdGYWlsZWQgdG8gc2VuZCByZXBvcnQuIFRyeSBhZ2FpbiBsYXRlciBvciBlbWFpbCBhZG1pbkBkZXZpbGVzay5jb20nKTtcbiAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICB9KTtcbiAgICAgICAgICAgICQoJyNteU1vZGFsJykubW9kYWwoJ2hpZGUnKTtcbiAgICAgICAgfVxuICAgICAgICBlbHNlIHtcbiAgICAgICAgICAgIGFsZXJ0KCdNZXNzYWdlIGlzIHJlcXVpcmVkLicpO1xuICAgICAgICB9XG4gICAgfVxuICAgIFxuICAgIHNlbGYuZ2V0UHJvcGVydHkgPSBmdW5jdGlvbiAob2JqLCBwcm9wZXJ0aWVzKSB7XG4gICAgICAgIHZhciByZXN1bHQgPSBvYmo7XG4gICAgICAgIGZvciAodmFyIGkgPSAwOyBpIDwgcHJvcGVydGllcy5sZW5ndGg7IGkrKykge1xuICAgICAgICAgICAgcmVzdWx0ID0gcmVzdWx0W3Byb3BlcnRpZXNbaV1dO1xuICAgICAgICB9XG4gICAgICAgIHJldHVybiByZXN1bHQ7XG4gICAgfTtcbiAgICBcbiAgICBzZWxmLmdldERpZmZUZXh0V3JhcHBlciA9IGZ1bmN0aW9uIChoZXJvLCBwcm9wZXJ0eSkge1xuICAgICAgICByZXR1cm4gc2VsZi5nZXREaWZmVGV4dChzZWxmLmdldERpZmZNYWduaXR1ZGUoaGVybywgcHJvcGVydHkpKTtcbiAgICB9XG4gICAgXG4gICAgc2VsZi5nZXREaWZmTWFnbml0dWRlID0gZnVuY3Rpb24gKGhlcm8sIHByb3BlcnR5KSB7XG4gICAgICAgIHZhciBwcm9wZXJ0aWVzID0gcHJvcGVydHkuc3BsaXQoJy4nKTtcbiAgICAgICAgcmV0dXJuIHNlbGYuZ2V0UHJvcGVydHkoaGVyby5kYW1hZ2VUb3RhbEluZm8oKSwgcHJvcGVydGllcykudG9GaXhlZCgyKSAtIHNlbGYuZ2V0UHJvcGVydHkoaGVyby5oZXJvQ29tcGFyZSgpLmRhbWFnZVRvdGFsSW5mbygpLCBwcm9wZXJ0aWVzKS50b0ZpeGVkKDIpO1xuICAgIH1cbiAgICBcbiAgICBzZWxmLmdldERpZmZUZXh0ID0gZnVuY3Rpb24gKHZhbHVlKSB7XG4gICAgICAgIGlmICh2YWx1ZSA+IDApIHtcbiAgICAgICAgICAgIHJldHVybiAnKycgKyBwYXJzZUZsb2F0KHZhbHVlLnRvRml4ZWQoMikpO1xuICAgICAgICB9XG4gICAgICAgIGVsc2UgaWYgKHZhbHVlIDwgMCkge1xuICAgICAgICAgICAgcmV0dXJuICcmbWludXM7JyArIHBhcnNlRmxvYXQodmFsdWUudG9GaXhlZCgyKSotMSkudG9TdHJpbmcoKTtcbiAgICAgICAgfVxuICAgICAgICBlbHNlIHtcbiAgICAgICAgICAgIHJldHVybiAnJztcbiAgICAgICAgfVxuICAgIH1cbiAgICBzZWxmLmhpZ2hsaWdodGVkVGFiSW50ZXJuYWwgPSBrby5vYnNlcnZhYmxlKCcnKTtcbiAgICBzZWxmLmhpZ2hsaWdodGVkVGFiID0ga28uY29tcHV0ZWQoZnVuY3Rpb24gKCkge1xuICAgICAgICByZXR1cm4gc2VsZi5oaWdobGlnaHRlZFRhYkludGVybmFsKCk7XG4gICAgfSkuZXh0ZW5kKHsgdGhyb3R0bGU6IDEwMCB9KTtcbiAgICBzZWxmLmhpZ2hsaWdodFRhYiA9IGZ1bmN0aW9uIChkYXRhKSB7XG4gICAgICAgIHNlbGYuaGlnaGxpZ2h0ZWRUYWJJbnRlcm5hbChkYXRhKTtcbiAgICB9XG4gICAgc2VsZi51bmhpZ2hsaWdodFRhYiA9IGZ1bmN0aW9uIChkYXRhKSB7XG4gICAgICAgIHNlbGYuaGlnaGxpZ2h0ZWRUYWJJbnRlcm5hbCgnJyk7XG4gICAgfVxufVxuXG5tb2R1bGUuZXhwb3J0cyA9IEhlcm9DYWxjdWxhdG9yVmlld01vZGVsOyIsIid1c2Ugc3RyaWN0JztcbnZhciBrbyA9IHJlcXVpcmUoJy4vaGVyb2NhbGNfa25vY2tvdXQnKTtcbnZhciBleHRlbmQgPSByZXF1aXJlKFwiZG90YS1oZXJvLWNhbGN1bGF0b3ItbGlicmFyeS9zcmMvaGVyb2NhbGMvdXRpbC9leHRlbmRcIik7XG52YXIgZmluZFdoZXJlID0gcmVxdWlyZShcImRvdGEtaGVyby1jYWxjdWxhdG9yLWxpYnJhcnkvc3JjL2hlcm9jYWxjL3V0aWwvZmluZFdoZXJlXCIpO1xuXG52YXIgRGFtYWdlSW5zdGFuY2UgPSBmdW5jdGlvbiAobGFiZWwsIGRhbWFnZVR5cGUsIHZhbHVlLCBkYXRhLCB0b3RhbCkge1xuICAgIHRoaXMubGFiZWwgPSBsYWJlbCB8fCAnJztcbiAgICB0aGlzLmRhbWFnZVR5cGUgPSBkYW1hZ2VUeXBlIHx8ICcnO1xuICAgIHRoaXMudmFsdWUgPSBwYXJzZUZsb2F0KHZhbHVlKSB8fCAwO1xuICAgIHRoaXMuZGF0YSA9IGRhdGEgfHwgW107XG4gICAgdGhpcy50b3RhbCA9IHBhcnNlRmxvYXQodG90YWwpIHx8IDA7XG59XG5cbnZhciBIZXJvRGFtYWdlQW1wTWl4aW4gPSBmdW5jdGlvbiAoc2VsZikge1xuICAgIHNlbGYuZGFtYWdlQnJhY2tldHMgPSBbXG4gICAgICAgIFsnbWVkdXNhX21hbmFfc2hpZWxkJywgJ3RlbXBsYXJfYXNzYXNzaW5fcmVmcmFjdGlvbicsICdmYWNlbGVzc192b2lkX2JhY2t0cmFjaycsICdueXhfYXNzYXNzaW5fc3Bpa2VkX2NhcmFwYWNlJ10sXG4gICAgICAgIFsnc3BlY3RyZV9kaXNwZXJzaW9uJywgJ3dpc3Bfb3ZlcmNoYXJnZScsICdzbGFyZGFyX3NwcmludCcsJ2JyaXN0bGViYWNrX2JyaXN0bGViYWNrJywgJ3VuZHlpbmdfZmxlc2hfZ29sZW0nXSxcbiAgICAgICAgWydhYmFkZG9uX2JvcnJvd2VkX3RpbWUnLCAnYWJhZGRvbl9hcGhvdGljX3NoaWVsZCcsICdrdW5ra2FfZ2hvc3RzaGlwJywgJ3RyZWFudF9saXZpbmdfYXJtb3InXSxcbiAgICAgICAgWydjaGVuX3Blbml0ZW5jZScsICdtZWR1c2Ffc3RvbmVfZ2F6ZScsICdzaGFkb3dfZGVtb25fc291bF9jYXRjaGVyJ10sXG4gICAgICAgIFsnZGF6emxlX3NoYWxsb3dfZ3JhdmUnXVxuICAgIF07XG4gICAgXG4gICAgc2VsZi5nZXREYW1hZ2VBZnRlckJyYWNrZXQgPSBmdW5jdGlvbiAoaW5pdGlhbERhbWFnZSxpbmRleCkge1xuICAgICAgICB2YXIgYnJhY2tldCA9IHNlbGYuZGFtYWdlQnJhY2tldHNbaW5kZXhdO1xuICAgICAgICB2YXIgbXVsdGlwbGllciA9IDE7XG4gICAgICAgIGZvciAodmFyIGkgPSAwOyBpIDwgYnJhY2tldC5sZW5ndGg7IGkrKykge1xuICAgICAgICAgICAgaWYgKGZpbmRXaGVyZShzZWxmLmRhbWFnZUFtcGxpZmljYXRpb24uYnVmZnMsIHtuYW1lOiBicmFja2V0W2ldLm5hbWV9KSAhPSB1bmRlZmluZWQgfHwgZmluZFdoZXJlKHNlbGYuZGFtYWdlUmVkdWN0aW9uLmJ1ZmZzLCB7bmFtZTogYnJhY2tldFtpXS5uYW1lfSkgIT0gdW5kZWZpbmVkKSB7XG4gICAgICAgICAgICAgICAgbXVsdGlwbGllciArPSBicmFja2V0W2ldLnZhbHVlO1xuICAgICAgICAgICAgfVxuICAgICAgICB9O1xuICAgICAgICByZXR1cm4gaW5pdGlhbERhbWFnZSAqIG11bHRpcGxpZXI7XG4gICAgfTtcbiAgICBcbiAgICBzZWxmLnByb2Nlc3NEYW1hZ2VBbXBSZWR1Y0JyYWNrZXQgPSBmdW5jdGlvbiAoaW5kZXgsIHNvdXJjZXMsIGRhbWFnZSkge1xuICAgICAgICB2YXIgbXVsdGlwbGllciA9IDEsXG4gICAgICAgICAgICBkYXRhID0gW10sXG4gICAgICAgICAgICBkYW1hZ2UgPSBwYXJzZUZsb2F0KGRhbWFnZSksXG4gICAgICAgICAgICB0b3RhbCA9IHBhcnNlRmxvYXQoZGFtYWdlKTtcbiAgICAgICAgICAgIFxuICAgICAgICBmb3IgKHZhciBpID0gMDsgaSA8IHNlbGYuZGFtYWdlQnJhY2tldHNbaW5kZXhdLmxlbmd0aDsgaSsrKSB7XG4gICAgICAgICAgICBpZiAoc291cmNlc1tzZWxmLmRhbWFnZUJyYWNrZXRzW2luZGV4XVtpXV0gIT0gdW5kZWZpbmVkKSB7XG4gICAgICAgICAgICAgICAgbXVsdGlwbGllciA9IDEgKyBwYXJzZUZsb2F0KHNvdXJjZXNbc2VsZi5kYW1hZ2VCcmFja2V0c1tpbmRleF1baV1dLm11bHRpcGxpZXIpO1xuICAgICAgICAgICAgICAgIHRvdGFsICs9IChkYW1hZ2UgKiBtdWx0aXBsaWVyKSAtIGRhbWFnZTtcbiAgICAgICAgICAgICAgICBkYXRhLnB1c2gobmV3IERhbWFnZUluc3RhbmNlKFxuICAgICAgICAgICAgICAgICAgICBzb3VyY2VzW3NlbGYuZGFtYWdlQnJhY2tldHNbaW5kZXhdW2ldXS5kaXNwbGF5bmFtZSxcbiAgICAgICAgICAgICAgICAgICAgc291cmNlc1tzZWxmLmRhbWFnZUJyYWNrZXRzW2luZGV4XVtpXV0uZGFtYWdlVHlwZSxcbiAgICAgICAgICAgICAgICAgICAgKGRhbWFnZSAqIG11bHRpcGxpZXIpIC0gZGFtYWdlLFxuICAgICAgICAgICAgICAgICAgICBbXSxcbiAgICAgICAgICAgICAgICAgICAgdG90YWxcbiAgICAgICAgICAgICAgICApKTtcbiAgICAgICAgICAgIH1cbiAgICAgICAgfVxuICAgICAgICByZXR1cm4gZGF0YTtcbiAgICB9XG4gICAgXG4gICAgc2VsZi5nZXREYW1hZ2VBbXBSZWR1Y0luc3RhbmNlID0gZnVuY3Rpb24oc291cmNlcywgaW5pdGlhbERhbWFnZSwgYWJpbGl0eSwgZGFtYWdlVHlwZSkge1xuICAgICAgICB2YXIgZGF0YSA9IFtdLFxuICAgICAgICAgICAgZGFtYWdlID0gcGFyc2VGbG9hdChpbml0aWFsRGFtYWdlKSxcbiAgICAgICAgICAgIHByZXZEYW1hZ2UgPSBkYW1hZ2UsXG4gICAgICAgICAgICBsYWJlbCA9IGFiaWxpdHkgPT0gJ2luaXRpYWwnID8gJ0luaXRpYWwnIDogc291cmNlc1thYmlsaXR5XS5kaXNwbGF5bmFtZTtcblxuICAgICAgICAvLyBCcmFja2V0IDBcbiAgICAgICAgZGF0YSA9IGRhdGEuY29uY2F0KHNlbGYucHJvY2Vzc0RhbWFnZUFtcFJlZHVjQnJhY2tldCgwLCBzb3VyY2VzLCBkYW1hZ2UpKTtcbiAgICAgICAgZGFtYWdlID0gZGF0YVtkYXRhLmxlbmd0aCAtIDFdID8gZGF0YVtkYXRhLmxlbmd0aCAtIDFdLnRvdGFsIDogZGFtYWdlO1xuXG4gICAgICAgIC8vIEJyYWNrZXQgMVxuICAgICAgICBkYXRhID0gZGF0YS5jb25jYXQoc2VsZi5wcm9jZXNzRGFtYWdlQW1wUmVkdWNCcmFja2V0KDEsIHNvdXJjZXMsIGRhbWFnZSkpO1xuICAgICAgICBkYW1hZ2UgPSBkYXRhW2RhdGEubGVuZ3RoIC0gMV0gPyBkYXRhW2RhdGEubGVuZ3RoIC0gMV0udG90YWwgOiBkYW1hZ2U7XG4gICAgICAgIFxuICAgICAgICAvLyBCcmFja2V0IDJcbiAgICAgICAgZGF0YSA9IGRhdGEuY29uY2F0KHNlbGYucHJvY2Vzc0RhbWFnZUFtcFJlZHVjQnJhY2tldCgyLCBzb3VyY2VzLCBkYW1hZ2UpKTtcbiAgICAgICAgZGFtYWdlID0gZGF0YVtkYXRhLmxlbmd0aCAtIDFdID8gZGF0YVtkYXRhLmxlbmd0aCAtIDFdLnRvdGFsIDogZGFtYWdlO1xuXG4gICAgICAgIHJldHVybiBuZXcgRGFtYWdlSW5zdGFuY2UobGFiZWwsIGRhbWFnZVR5cGUsIGluaXRpYWxEYW1hZ2UsIGRhdGEsIGRhdGFbZGF0YS5sZW5ndGggLSAxXSA/IGRhdGFbZGF0YS5sZW5ndGggLSAxXS50b3RhbCA6IGRhbWFnZSk7XG4gICAgfVxuICAgIFxuICAgIHNlbGYuZ2V0RGFtYWdlQW1wUmVkdWMgPSBmdW5jdGlvbiAoaW5pdGlhbERhbWFnZSkge1xuICAgICAgICB2YXIgaW5zdGFuY2VzID0gW10sXG4gICAgICAgICAgICBzb3VyY2VzID0ge30sXG4gICAgICAgICAgICBzb3VyY2VzQW1wID0gc2VsZi5kYW1hZ2VSZWR1Y3Rpb24uZ2V0RGFtYWdlTXVsdGlwbGllclNvdXJjZXMoKSxcbiAgICAgICAgICAgIHNvdXJjZXNSZWR1YyA9IHNlbGYuZGFtYWdlQW1wbGlmaWNhdGlvbi5nZXREYW1hZ2VNdWx0aXBsaWVyU291cmNlcygpO1xuICAgICAgICBleHRlbmQoc291cmNlcywgc291cmNlc0FtcCk7XG4gICAgICAgIGV4dGVuZChzb3VyY2VzLCBzb3VyY2VzUmVkdWMpO1xuICAgICAgICAvLyBJbml0aWFsIGRhbWFnZSBpbnN0YW5jZVxuICAgICAgICBpbnN0YW5jZXMucHVzaChzZWxmLmdldERhbWFnZUFtcFJlZHVjSW5zdGFuY2Uoc291cmNlcywgaW5pdGlhbERhbWFnZSwgJ2luaXRpYWwnLCAncGh5c2ljYWwnKSk7XG4gICAgICAgIFxuICAgICAgICAvLyBCcmFja2V0IDQgZGFtYWdlIGluc3RhbmNlc1xuICAgICAgICB2YXIgYjQgPSBbJ3NoYWRvd19kZW1vbl9zb3VsX2NhdGNoZXInLCAnbWVkdXNhX3N0b25lX2dhemUnLCAnY2hlbl9wZW5pdGVuY2UnXTtcbiAgICAgICAgZm9yICh2YXIgaSA9IDA7IGkgPCBiNC5sZW5ndGg7IGkrKykge1xuICAgICAgICAgICAgaWYgKHNvdXJjZXNbYjRbaV1dICE9IHVuZGVmaW5lZCkge1xuICAgICAgICAgICAgICAgIGluc3RhbmNlcy5wdXNoKHNlbGYuZ2V0RGFtYWdlQW1wUmVkdWNJbnN0YW5jZShzb3VyY2VzLCBpbml0aWFsRGFtYWdlICogc291cmNlc1tiNFtpXV0ubXVsdGlwbGllciwgYjRbaV0sIHNvdXJjZXNbYjRbaV1dLmRhbWFnZVR5cGUpKTtcbiAgICAgICAgICAgIH1cbiAgICAgICAgfVxuICAgIFxuICAgICAgICByZXR1cm4gbmV3IERhbWFnZUluc3RhbmNlKCdUb3RhbCcsICdwaHlzaWNhbCcsIGluaXRpYWxEYW1hZ2UsIGluc3RhbmNlcywgaW5zdGFuY2VzLnJlZHVjZShmdW5jdGlvbihtZW1vLCBpKSB7cmV0dXJuIHBhcnNlRmxvYXQobWVtbykgKyBwYXJzZUZsb2F0KGkudG90YWwpO30sIDApKTtcbiAgICB9O1xuICAgIFxuICAgIHNlbGYuZGFtYWdlSW5wdXRWYWx1ZSA9IGtvLm9ic2VydmFibGUoMCk7XG4gICAgc2VsZi5kYW1hZ2VJbnB1dE1vZGlmaWVkID0ga28uY29tcHV0ZWQoZnVuY3Rpb24gKCkge1xuICAgICAgICByZXR1cm4gc2VsZi5nZXREYW1hZ2VBbXBSZWR1YyhzZWxmLmRhbWFnZUlucHV0VmFsdWUoKSk7XG4gICAgfSk7XG59XG5cbm1vZHVsZS5leHBvcnRzID0gSGVyb0RhbWFnZUFtcE1peGluOyIsIlwidXNlIHN0cmljdFwiO1xudmFyIGtvID0gKHR5cGVvZiB3aW5kb3cgIT09IFwidW5kZWZpbmVkXCIgPyB3aW5kb3dbJ2tvJ10gOiB0eXBlb2YgZ2xvYmFsICE9PSBcInVuZGVmaW5lZFwiID8gZ2xvYmFsWydrbyddIDogbnVsbCk7XG52YXIgSGVyb0NhbGMgPSByZXF1aXJlKFwiZG90YS1oZXJvLWNhbGN1bGF0b3ItbGlicmFyeVwiKTtcbnZhciBEYW1hZ2VBbXBWaWV3TW9kZWwgPSByZXF1aXJlKFwiLi9EYW1hZ2VBbXBWaWV3TW9kZWxcIik7XG52YXIgQnVpbGRFeHBsb3JlclZpZXdNb2RlbCA9IHJlcXVpcmUoXCIuL0J1aWxkRXhwbG9yZXJWaWV3TW9kZWxcIik7XG52YXIgSGVyb0RhbWFnZUFtcE1peGluID0gcmVxdWlyZShcIi4vSGVyb0RhbWFnZUFtcE1peGluXCIpO1xudmFyIGlsbHVzaW9uT3B0aW9uc0FycmF5ID0gcmVxdWlyZShcImRvdGEtaGVyby1jYWxjdWxhdG9yLWxpYnJhcnkvc3JjL2hlcm9jYWxjL2lsbHVzaW9uL2lsbHVzaW9uT3B0aW9uc0FycmF5XCIpO1xudmFyIGlsbHVzaW9uRGF0YSA9IHJlcXVpcmUoXCJkb3RhLWhlcm8tY2FsY3VsYXRvci1saWJyYXJ5L3NyYy9oZXJvY2FsYy9pbGx1c2lvbi9pbGx1c2lvbkRhdGFcIik7XG52YXIgSWxsdXNpb25WaWV3TW9kZWwgPSByZXF1aXJlKFwiLi9JbGx1c2lvblZpZXdNb2RlbFwiKTtcblxudmFyIEhlcm9PcHRpb24yID0gZnVuY3Rpb24gKGhlcm8pIHtcbiAgICB0aGlzLmhlcm9OYW1lID0ga28uY29tcHV0ZWQoZnVuY3Rpb24gKCkge1xuICAgICAgICByZXR1cm4gaGVyby5zZWxlY3RlZEhlcm8oKS5oZXJvTmFtZTtcbiAgICB9KTtcbiAgICB0aGlzLmhlcm9EaXNwbGF5TmFtZSA9IGtvLmNvbXB1dGVkKGZ1bmN0aW9uICgpIHtcbiAgICAgICAgcmV0dXJuIGhlcm8uc2VsZWN0ZWRIZXJvKCkuaGVyb0Rpc3BsYXlOYW1lO1xuICAgIH0pO1xuICAgIHRoaXMuaGVybyA9IGhlcm87XG59O1xuXG52YXIgSGVyb1ZpZXdNb2RlbCA9IGZ1bmN0aW9uIChoZXJvRGF0YSwgaXRlbURhdGEsIHVuaXREYXRhLCBoKSB7XG4gICAgdmFyIHNlbGYgPSB0aGlzO1xuICAgIHNlbGYuaW5kZXggPSBrby5vYnNlcnZhYmxlKGgpO1xuICAgIHNlbGYuYXZhaWxhYmxlSGVyb2VzID0ga28ub2JzZXJ2YWJsZUFycmF5KEhlcm9DYWxjLkhlcm9PcHRpb25zKTtcbiAgICBzZWxmLmF2YWlsYWJsZUhlcm9lcy5zb3J0KGZ1bmN0aW9uIChsZWZ0LCByaWdodCkge1xuICAgICAgICByZXR1cm4gbGVmdC5oZXJvRGlzcGxheU5hbWUgPT0gcmlnaHQuaGVyb0Rpc3BsYXlOYW1lID8gMCA6IChsZWZ0Lmhlcm9EaXNwbGF5TmFtZSA8IHJpZ2h0Lmhlcm9EaXNwbGF5TmFtZSA/IC0xIDogMSk7XG4gICAgfSk7XG4gICAgc2VsZi5zZWxlY3RlZEhlcm8gPSBrby5vYnNlcnZhYmxlKHNlbGYuYXZhaWxhYmxlSGVyb2VzKClbaF0pO1xuICAgIFxuICAgIEhlcm9DYWxjLkhlcm9Nb2RlbC5jYWxsKHRoaXMsIGhlcm9EYXRhLCBpdGVtRGF0YSwgc2VsZi5zZWxlY3RlZEhlcm8oKS5oZXJvTmFtZSk7XG4gICAgXG4gICAgc2VsZi5zZWxlY3RlZEhlcm8uc3Vic2NyaWJlKGZ1bmN0aW9uIChuZXdWYWx1ZSkge1xuICAgICAgICBzZWxmLmhlcm9JZChuZXdWYWx1ZS5oZXJvTmFtZSk7XG4gICAgfSk7XG4gICAgXG4gICAgc2VsZi5pbGx1c2lvbnMgPSBrby5vYnNlcnZhYmxlQXJyYXkoW10pO1xuICAgIHNlbGYuYXZhaWxhYmxlSWxsdXNpb25zID0ga28ub2JzZXJ2YWJsZUFycmF5KGlsbHVzaW9uT3B0aW9uc0FycmF5KTtcbiAgICBzZWxmLnNlbGVjdGVkSWxsdXNpb24gPSBrby5vYnNlcnZhYmxlKHNlbGYuYXZhaWxhYmxlSWxsdXNpb25zKClbMF0pO1xuICAgIHNlbGYuaWxsdXNpb25BYmlsaXR5TGV2ZWwgPSBrby5vYnNlcnZhYmxlKDEpO1xuICAgIHNlbGYuaWxsdXNpb25BYmlsaXR5TWF4TGV2ZWwgPSBrby5jb21wdXRlZChmdW5jdGlvbiAoKSB7XG4gICAgICAgIHJldHVybiBpbGx1c2lvbkRhdGFbc2VsZi5zZWxlY3RlZElsbHVzaW9uKCkuaWxsdXNpb25OYW1lXS5tYXhfbGV2ZWw7XG4gICAgfSk7XG4gICAgc2VsZi5hZGRJbGx1c2lvbiA9IGZ1bmN0aW9uIChkYXRhLCBldmVudCkge1xuICAgICAgICBzZWxmLmlsbHVzaW9ucy5wdXNoKGtvLm9ic2VydmFibGUobmV3IElsbHVzaW9uVmlld01vZGVsKGhlcm9EYXRhLCBpdGVtRGF0YSwgMCwgc2VsZiwgc2VsZi5pbGx1c2lvbkFiaWxpdHlMZXZlbCgpKSkpO1xuICAgIH07XG4gICAgXG4gICAgc2VsZi5ib3VuZCA9IGtvLm9ic2VydmFibGUoZmFsc2UpO1xuICAgIHNlbGYucGxheWVyQ29sb3JDc3MgPSBrby5jb21wdXRlZChmdW5jdGlvbiAoKSB7XG4gICAgICAgIHJldHVybiAncGxheWVyLWNvbG9yLScgKyBzZWxmLmluZGV4KCk7XG4gICAgfSk7XG4gICAgc2VsZi5oZXJvT3B0aW9uID0gbmV3IEhlcm9PcHRpb24yKHNlbGYpO1xuICAgIHNlbGYub3RoZXJIZXJvZXMgPSBrby5vYnNlcnZhYmxlQXJyYXkoW10pO1xuICAgIHNlbGYuYXZhaWxhYmxlQ29tcGFyZSA9IGtvLmNvbXB1dGVkKGZ1bmN0aW9uICgpIHtcbiAgICAgICAgcmV0dXJuIHNlbGYub3RoZXJIZXJvZXMoKS5tYXAoZnVuY3Rpb24gKG8pIHtcbiAgICAgICAgICAgIHJldHVybiBvLmhlcm9PcHRpb247XG4gICAgICAgIH0pO1xuICAgIH0pO1xuICAgIHNlbGYuc2VsZWN0ZWRDb21wYXJlID0ga28ub2JzZXJ2YWJsZSgpO1xuICAgIHNlbGYuc2VsZWN0ZWRDb21wYXJlLnN1YnNjcmliZShmdW5jdGlvbiAobmV3VmFsdWUpIHtcbiAgICAgICAgc2VsZi5oZXJvQ29tcGFyZShuZXdWYWx1ZS5oZXJvKTtcbiAgICB9KTtcbiAgICBzZWxmLmVuZW1pZXMgPSBrby5vYnNlcnZhYmxlQXJyYXkoW10pO1xuICAgIHNlbGYuYXZhaWxhYmxlRW5lbWllcyA9IGtvLmNvbXB1dGVkKGZ1bmN0aW9uICgpIHtcbiAgICAgICAgcmV0dXJuIHNlbGYuZW5lbWllcygpLm1hcChmdW5jdGlvbiAobykge1xuICAgICAgICAgICAgcmV0dXJuIG8uaGVyb09wdGlvbjtcbiAgICAgICAgfSk7XG4gICAgfSk7XG4gICAgc2VsZi5zZWxlY3RlZEVuZW15ID0ga28ub2JzZXJ2YWJsZSgpO1xuICAgIHNlbGYuc2VsZWN0ZWRFbmVteS5zdWJzY3JpYmUoZnVuY3Rpb24gKG5ld1ZhbHVlKSB7XG4gICAgICAgIHNlbGYuZW5lbXkobmV3VmFsdWUuaGVybyk7XG4gICAgfSk7XG4gICAgc2VsZi5zZXRIZXJvT3B0aW9uU3R5bGluZyA9IGZ1bmN0aW9uKG9wdGlvbiwgaXRlbSkge1xuICAgICAgICBrby5hcHBseUJpbmRpbmdzVG9Ob2RlKG9wdGlvbiwge2NzczogaXRlbS5oZXJvLnBsYXllckNvbG9yQ3NzKCkgfSwgaXRlbSk7XG4gICAgfVxuICAgIHNlbGYuc2VjdGlvbkRpc3BsYXkgPSBrby5vYnNlcnZhYmxlKHtcbiAgICAgICAgJ2ludmVudG9yeSc6IGtvLm9ic2VydmFibGUodHJ1ZSksXG4gICAgICAgICdhYmlsaXR5Jzoga28ub2JzZXJ2YWJsZSh0cnVlKSxcbiAgICAgICAgJ3RhbGVudCc6IGtvLm9ic2VydmFibGUodHJ1ZSksXG4gICAgICAgICdidWZmJzoga28ub2JzZXJ2YWJsZSh0cnVlKSxcbiAgICAgICAgJ2RlYnVmZic6IGtvLm9ic2VydmFibGUodHJ1ZSksXG4gICAgICAgICdkYW1hZ2VhbXAnOiBrby5vYnNlcnZhYmxlKGZhbHNlKSxcbiAgICAgICAgJ2lsbHVzaW9uJzoga28ub2JzZXJ2YWJsZShmYWxzZSksXG4gICAgICAgICdza2lsbGJ1aWxkJzoga28ub2JzZXJ2YWJsZShmYWxzZSksXG4gICAgICAgICdza2lsbGJ1aWxkLXNraWxscyc6IGtvLm9ic2VydmFibGUodHJ1ZSksXG4gICAgICAgICdza2lsbGJ1aWxkLWl0ZW1zJzoga28ub2JzZXJ2YWJsZSh0cnVlKVxuICAgIH0pO1xuICAgIHNlbGYuc2VjdGlvbkRpc3BsYXlUb2dnbGUgPSBmdW5jdGlvbiAoc2VjdGlvbikge1xuICAgICAgICBzZWxmLnNlY3Rpb25EaXNwbGF5KClbc2VjdGlvbl0oIXNlbGYuc2VjdGlvbkRpc3BsYXkoKVtzZWN0aW9uXSgpKTtcbiAgICB9XG4gICAgc2VsZi5zaG93VW5pdFRhYiA9IGtvLm9ic2VydmFibGUoZmFsc2UpO1xuICAgIHNlbGYuc2hvd0RpZmYgPSBrby5vYnNlcnZhYmxlKGZhbHNlKTtcbiAgICBzZWxmLnNob3dDcml0aWNhbFN0cmlrZURldGFpbHMgPSBrby5vYnNlcnZhYmxlKGZhbHNlKTtcbiAgICBzZWxmLnNob3dEYW1hZ2VEZXRhaWxzID0ga28ub2JzZXJ2YWJsZShmYWxzZSk7XG4gICAgc2VsZi5zaG93U3RhdERldGFpbHMgPSBrby5vYnNlcnZhYmxlKGZhbHNlKTtcbiAgICBzZWxmLnNob3dEYW1hZ2VBbXBDYWxjRGV0YWlscyA9IGtvLm9ic2VydmFibGUoZmFsc2UpO1xuICAgIFxuICAgIHNlbGYuZGFtYWdlQW1wbGlmaWNhdGlvbiA9IG5ldyBEYW1hZ2VBbXBWaWV3TW9kZWwoaGVyb0RhdGEsIGl0ZW1EYXRhLCB1bml0RGF0YSk7XG4gICAgc2VsZi5kYW1hZ2VSZWR1Y3Rpb24gPSBuZXcgRGFtYWdlQW1wVmlld01vZGVsKGhlcm9EYXRhLCBpdGVtRGF0YSwgdW5pdERhdGEpO1xuICAgIHNlbGYuYnVpbGRFeHBsb3JlciA9IG5ldyBCdWlsZEV4cGxvcmVyVmlld01vZGVsKHNlbGYpO1xuICAgIEhlcm9EYW1hZ2VBbXBNaXhpbihzZWxmKTtcbn1cbkhlcm9WaWV3TW9kZWwucHJvdG90eXBlID0gT2JqZWN0LmNyZWF0ZShIZXJvQ2FsYy5IZXJvTW9kZWwucHJvdG90eXBlKTtcbkhlcm9WaWV3TW9kZWwucHJvdG90eXBlLmNvbnN0cnVjdG9yID0gSGVyb1ZpZXdNb2RlbDtcblxubW9kdWxlLmV4cG9ydHMgPSBIZXJvVmlld01vZGVsOyIsIid1c2Ugc3RyaWN0JztcbnZhciBrbyA9IHJlcXVpcmUoJy4vaGVyb2NhbGNfa25vY2tvdXQnKTtcbiAgICBcbnZhciBIZXJvQ2FsYyA9IHJlcXVpcmUoXCJkb3RhLWhlcm8tY2FsY3VsYXRvci1saWJyYXJ5XCIpO1xudmFyIGlsbHVzaW9uRGF0YSA9IHJlcXVpcmUoXCJkb3RhLWhlcm8tY2FsY3VsYXRvci1saWJyYXJ5L3NyYy9oZXJvY2FsYy9pbGx1c2lvbi9pbGx1c2lvbkRhdGFcIik7XG52YXIgaGVyb0RhdGEgPSByZXF1aXJlKFwiZG90YS1oZXJvLWNhbGN1bGF0b3ItbGlicmFyeS9zcmMvaGVyb2NhbGMvZGF0YS9tYWluXCIpLmhlcm9EYXRhO1xudmFyIGl0ZW1EYXRhID0gcmVxdWlyZShcImRvdGEtaGVyby1jYWxjdWxhdG9yLWxpYnJhcnkvc3JjL2hlcm9jYWxjL2RhdGEvbWFpblwiKS5pdGVtRGF0YTtcbnZhciBmaW5kV2hlcmUgPSByZXF1aXJlKFwiZG90YS1oZXJvLWNhbGN1bGF0b3ItbGlicmFyeS9zcmMvaGVyb2NhbGMvdXRpbC9maW5kV2hlcmVcIik7XG5cbnZhciBJbGx1c2lvblZpZXdNb2RlbCA9IGZ1bmN0aW9uIChoZXJvRGF0YSwgaXRlbURhdGEsIGgsIHAsIGFiaWxpdHlMZXZlbCkge1xuICAgIHZhciBzZWxmID0gdGhpcztcbiAgICBzZWxmLnBhcmVudCA9IHA7XG4gICAgc2VsZi5pbGx1c2lvblR5cGUgPSBrby5vYnNlcnZhYmxlKHNlbGYucGFyZW50LnNlbGVjdGVkSWxsdXNpb24oKS5pbGx1c2lvbk5hbWUpO1xuICAgIGlmICghaWxsdXNpb25EYXRhW3NlbGYuaWxsdXNpb25UeXBlKCldLnVzZV9zZWxlY3RlZF9oZXJvKSB7XG4gICAgICAgIEhlcm9DYWxjLklsbHVzaW9uTW9kZWwuY2FsbCh0aGlzLCBoZXJvRGF0YSwgaXRlbURhdGEsIHNlbGYucGFyZW50LnNlbGVjdGVkSWxsdXNpb24oKS5iYXNlSGVybywgcCwgYWJpbGl0eUxldmVsKTtcbiAgICAgICAgc2VsZi5zZWxlY3RlZEhlcm8gPSBrby5vYnNlcnZhYmxlKGZpbmRXaGVyZShzZWxmLnBhcmVudC5hdmFpbGFibGVIZXJvZXMoKSwge2hlcm9OYW1lOiBzZWxmLnBhcmVudC5zZWxlY3RlZElsbHVzaW9uKCkuYmFzZUhlcm99KSk7XG4gICAgfVxuICAgIGVsc2Uge1xuICAgICAgICBIZXJvQ2FsYy5JbGx1c2lvbk1vZGVsLmNhbGwodGhpcywgaGVyb0RhdGEsIGl0ZW1EYXRhLCBzZWxmLnBhcmVudC5zZWxlY3RlZEhlcm8oKS5oZXJvTmFtZSwgcCwgYWJpbGl0eUxldmVsKTtcbiAgICAgICAgc2VsZi5zZWxlY3RlZEhlcm8gPSBrby5vYnNlcnZhYmxlKHNlbGYucGFyZW50LnNlbGVjdGVkSGVybygpKTtcbiAgICB9XG4gICAgXG4gICAgc2VsZi5pbnZlbnRvcnkgPSBzZWxmLnBhcmVudC5pbnZlbnRvcnk7XG4gICAgc2VsZi5pbGx1c2lvbkRpc3BsYXlOYW1lID0ga28ub2JzZXJ2YWJsZShzZWxmLnBhcmVudC5zZWxlY3RlZElsbHVzaW9uKCkuaWxsdXNpb25EaXNwbGF5TmFtZSk7XG4gICAgc2VsZi5pbGx1c2lvbkFiaWxpdHlNYXhMZXZlbCA9IGtvLm9ic2VydmFibGUoaWxsdXNpb25EYXRhW3NlbGYucGFyZW50LnNlbGVjdGVkSWxsdXNpb24oKS5pbGx1c2lvbk5hbWVdLm1heF9sZXZlbCk7XG4gICAgLyppZiAoIWlsbHVzaW9uRGF0YVtzZWxmLmlsbHVzaW9uVHlwZSgpXS51c2Vfc2VsZWN0ZWRfaGVybykge1xuICAgICAgICBzZWxmLnNlbGVjdGVkSGVybyhmaW5kV2hlcmUoc2VsZi5wYXJlbnQuYXZhaWxhYmxlSGVyb2VzKCksIHtoZXJvTmFtZTogc2VsZi5wYXJlbnQuc2VsZWN0ZWRJbGx1c2lvbigpLmJhc2VIZXJvfSkpO1xuICAgIH1cbiAgICBlbHNlIHtcbiAgICAgICAgc2VsZi5zZWxlY3RlZEhlcm8oc2VsZi5wYXJlbnQuc2VsZWN0ZWRIZXJvKCkpO1xuICAgIH0qL1xuICAgIHNlbGYuc2VsZWN0ZWRIZXJvTGV2ZWwoc2VsZi5wYXJlbnQuc2VsZWN0ZWRIZXJvTGV2ZWwoKSk7XG4gICAgLypzZWxmLmhlcm8gPSBrby5jb21wdXRlZChmdW5jdGlvbigpIHtcbiAgICAgICAgcmV0dXJuIGtvLndyYXAuZnJvbUpTKGhlcm9EYXRhWyducGNfZG90YV9oZXJvXycgKyBzZWxmLnNlbGVjdGVkSGVybygpLmhlcm9OYW1lXSk7XG4gICAgfSk7Ki9cbiAgICBcbiAgICBzZWxmLmFiaWxpdHkoKS5nZXRBdHRyaWJ1dGVCb251c0xldmVsID0gc2VsZi5wYXJlbnQuYWJpbGl0eSgpLmdldEF0dHJpYnV0ZUJvbnVzTGV2ZWw7XG4gICAgXG4gICAgc2VsZi5zZWN0aW9uRGlzcGxheSA9IGtvLm9ic2VydmFibGUoe1xuICAgICAgICAnaW52ZW50b3J5Jzoga28ub2JzZXJ2YWJsZSh0cnVlKSxcbiAgICAgICAgJ2FiaWxpdHknOiBrby5vYnNlcnZhYmxlKHRydWUpLFxuICAgICAgICAnYnVmZic6IGtvLm9ic2VydmFibGUodHJ1ZSksXG4gICAgICAgICdkZWJ1ZmYnOiBrby5vYnNlcnZhYmxlKHRydWUpLFxuICAgICAgICAnZGFtYWdlYW1wJzoga28ub2JzZXJ2YWJsZShmYWxzZSksXG4gICAgICAgICdpbGx1c2lvbic6IGtvLm9ic2VydmFibGUoZmFsc2UpLFxuICAgICAgICAnc2tpbGxidWlsZCc6IGtvLm9ic2VydmFibGUoZmFsc2UpLFxuICAgICAgICAnc2tpbGxidWlsZC1za2lsbHMnOiBrby5vYnNlcnZhYmxlKHRydWUpLFxuICAgICAgICAnc2tpbGxidWlsZC1pdGVtcyc6IGtvLm9ic2VydmFibGUodHJ1ZSlcbiAgICB9KTtcbiAgICBzZWxmLnNlY3Rpb25EaXNwbGF5VG9nZ2xlID0gZnVuY3Rpb24gKHNlY3Rpb24pIHtcbiAgICAgICAgc2VsZi5zZWN0aW9uRGlzcGxheSgpW3NlY3Rpb25dKCFzZWxmLnNlY3Rpb25EaXNwbGF5KClbc2VjdGlvbl0oKSk7XG4gICAgfVxuICAgIHNlbGYuc2hvd1VuaXRUYWIgPSBrby5vYnNlcnZhYmxlKGZhbHNlKTtcbiAgICBzZWxmLnNob3dEaWZmID0ga28ub2JzZXJ2YWJsZShmYWxzZSk7XG4gICAgc2VsZi5zaG93Q3JpdGljYWxTdHJpa2VEZXRhaWxzID0ga28ub2JzZXJ2YWJsZShmYWxzZSk7XG4gICAgc2VsZi5zaG93RGFtYWdlRGV0YWlscyA9IGtvLm9ic2VydmFibGUoZmFsc2UpO1xuICAgIHNlbGYuc2hvd1N0YXREZXRhaWxzID0ga28ub2JzZXJ2YWJsZShmYWxzZSk7XG4gICAgcmV0dXJuIHNlbGY7XG59XG5JbGx1c2lvblZpZXdNb2RlbC5wcm90b3R5cGUgPSBPYmplY3QuY3JlYXRlKEhlcm9DYWxjLklsbHVzaW9uTW9kZWwucHJvdG90eXBlKTtcbklsbHVzaW9uVmlld01vZGVsLnByb3RvdHlwZS5jb25zdHJ1Y3RvciA9IElsbHVzaW9uVmlld01vZGVsO1xuXG5tb2R1bGUuZXhwb3J0cyA9IElsbHVzaW9uVmlld01vZGVsOyIsIlwidXNlIHN0cmljdFwiO1xudmFyIGtvID0gKHR5cGVvZiB3aW5kb3cgIT09IFwidW5kZWZpbmVkXCIgPyB3aW5kb3dbJ2tvJ10gOiB0eXBlb2YgZ2xvYmFsICE9PSBcInVuZGVmaW5lZFwiID8gZ2xvYmFsWydrbyddIDogbnVsbCk7XG52YXIgSGVyb0NhbGMgPSByZXF1aXJlKFwiZG90YS1oZXJvLWNhbGN1bGF0b3ItbGlicmFyeVwiKTtcbnZhciBVbml0T3B0aW9uID0gcmVxdWlyZShcImRvdGEtaGVyby1jYWxjdWxhdG9yLWxpYnJhcnkvc3JjL2hlcm9jYWxjL2hlcm8vVW5pdE9wdGlvblwiKTtcblxudmFyIFVuaXRWaWV3TW9kZWwgPSBmdW5jdGlvbiAoaGVyb0RhdGEsIGl0ZW1EYXRhLCB1bml0RGF0YSwgaCwgcCkge1xuICAgIHZhciBzZWxmID0gdGhpcztcbiAgICBzZWxmLmluZGV4ID0ga28ub2JzZXJ2YWJsZShoKTtcbiAgICBzZWxmLnNlbGVjdGVkVW5pdExldmVsID0ga28ub2JzZXJ2YWJsZSgxKTtcbiAgICBzZWxmLmF2YWlsYWJsZVVuaXRzID0ga28ub2JzZXJ2YWJsZUFycmF5KFtcbiAgICAgICAgbmV3IFVuaXRPcHRpb24oJ25wY19kb3RhX2xvbmVfZHJ1aWRfYmVhcicsICdMb25lIERydWlkIFNwaXJpdCBCZWFyJyw0LCcvbWVkaWEvaW1hZ2VzL3VuaXRzL3NwaXJpdF9iZWFyLnBuZycsIHNlbGYuc2VsZWN0ZWRVbml0TGV2ZWwpLFxuICAgICAgICBuZXcgVW5pdE9wdGlvbignbnBjX2RvdGFfYnJld21hc3Rlcl9lYXJ0aF8nLCdCcmV3bWFzdGVyIEVhcnRoIFdhcnJpb3InLDMsJy9tZWRpYS9pbWFnZXMvdW5pdHMvbnBjX2RvdGFfYnJld21hc3Rlcl9lYXJ0aC5wbmcnLCBzZWxmLnNlbGVjdGVkVW5pdExldmVsKSxcbiAgICAgICAgbmV3IFVuaXRPcHRpb24oJ25wY19kb3RhX2JyZXdtYXN0ZXJfZmlyZV8nLCdCcmV3bWFzdGVyIEZpcmUgV2FycmlvcicsMywnL21lZGlhL2ltYWdlcy91bml0cy9ucGNfZG90YV9icmV3bWFzdGVyX2ZpcmUucG5nJywgc2VsZi5zZWxlY3RlZFVuaXRMZXZlbCksXG4gICAgICAgIG5ldyBVbml0T3B0aW9uKCducGNfZG90YV9icmV3bWFzdGVyX3N0b3JtXycsJ0JyZXdtYXN0ZXIgU3Rvcm0gV2FycmlvcicsMywnL21lZGlhL2ltYWdlcy91bml0cy9ucGNfZG90YV9icmV3bWFzdGVyX3N0b3JtLnBuZycsIHNlbGYuc2VsZWN0ZWRVbml0TGV2ZWwpLFxuICAgICAgICBuZXcgVW5pdE9wdGlvbignbnBjX2RvdGFfbmVjcm9ub21pY29uX2FyY2hlcl8nLCdOZWNyb25vbWljb24gQXJjaGVyJywzLCcvbWVkaWEvaW1hZ2VzL3VuaXRzL25wY19kb3RhX25lY3Jvbm9taWNvbl9hcmNoZXIucG5nJywgc2VsZi5zZWxlY3RlZFVuaXRMZXZlbCksXG4gICAgICAgIG5ldyBVbml0T3B0aW9uKCducGNfZG90YV9uZWNyb25vbWljb25fd2Fycmlvcl8nLCdOZWNyb25vbWljb24gV2FycmlvcicsMywnL21lZGlhL2ltYWdlcy91bml0cy9ucGNfZG90YV9uZWNyb25vbWljb25fd2Fycmlvci5wbmcnLCBzZWxmLnNlbGVjdGVkVW5pdExldmVsKSxcbiAgICAgICAgbmV3IFVuaXRPcHRpb24oJ25wY19kb3RhX2x5Y2FuX3dvbGYnLCdMeWNhbiBXb2xmJyw0LCcvbWVkaWEvaW1hZ2VzL3VuaXRzL25wY19kb3RhX2x5Y2FuX3dvbGYucG5nJywgc2VsZi5zZWxlY3RlZFVuaXRMZXZlbCksXG4gICAgICAgIG5ldyBVbml0T3B0aW9uKCducGNfZG90YV92aXNhZ2VfZmFtaWxpYXInLCdWaXNhZ2UgRmFtaWxpYXInLDMsJy9tZWRpYS9pbWFnZXMvdW5pdHMvbnBjX2RvdGFfdmlzYWdlX2ZhbWlsaWFyLnBuZycsIHNlbGYuc2VsZWN0ZWRVbml0TGV2ZWwpXG4gICAgXSk7XG4gICAgc2VsZi5zZWxlY3RlZFVuaXQgPSBrby5vYnNlcnZhYmxlKHNlbGYuYXZhaWxhYmxlVW5pdHMoKVswXSk7XG4gICAgSGVyb0NhbGMuVW5pdE1vZGVsLmNhbGwodGhpcywgaGVyb0RhdGEsIGl0ZW1EYXRhLCB1bml0RGF0YSwgc2VsZi5zZWxlY3RlZFVuaXQoKS5oZXJvTmFtZSgpKTtcbiAgICBcbiAgICBzZWxmLnNlbGVjdGVkVW5pdExldmVsLnN1YnNjcmliZShmdW5jdGlvbihuZXdWYWx1ZSkge1xuICAgICAgICBzZWxmLnVuaXRMZXZlbChuZXdWYWx1ZSk7XG4gICAgICAgIHNlbGYudW5pdElkKHNlbGYuc2VsZWN0ZWRVbml0KCkuaGVyb05hbWUoKSk7XG4gICAgfSk7XG4gICAgc2VsZi5zZWxlY3RlZFVuaXQuc3Vic2NyaWJlKGZ1bmN0aW9uKG5ld1ZhbHVlKSB7XG4gICAgICAgIGlmIChuZXdWYWx1ZS5oZXJvTmFtZSgpLmluZGV4T2YoJ25wY19kb3RhX2xvbmVfZHJ1aWRfYmVhcicpICE9IC0xKSB7XG4gICAgICAgICAgICBzZWxmLmludmVudG9yeS5oYXNJbnZlbnRvcnkodHJ1ZSk7XG4gICAgICAgICAgICBzZWxmLmludmVudG9yeS5pdGVtcy5yZW1vdmVBbGwoKTtcbiAgICAgICAgICAgIHNlbGYuaW52ZW50b3J5LmFjdGl2ZUl0ZW1zLnJlbW92ZUFsbCgpO1xuICAgICAgICB9XG4gICAgICAgIGVsc2Uge1xuICAgICAgICAgICAgc2VsZi5pbnZlbnRvcnkuaGFzSW52ZW50b3J5KGZhbHNlKTtcbiAgICAgICAgICAgIHNlbGYuaW52ZW50b3J5Lml0ZW1zLnJlbW92ZUFsbCgpO1xuICAgICAgICAgICAgc2VsZi5pbnZlbnRvcnkuYWN0aXZlSXRlbXMucmVtb3ZlQWxsKCk7XG4gICAgICAgIH1cbiAgICAgICAgc2VsZi51bml0SWQobmV3VmFsdWUuaGVyb05hbWUoKSk7XG4gICAgfSk7XG4gICAgXG4gICAgXG4gICAgc2VsZi5ib3VuZCA9IGtvLm9ic2VydmFibGUoZmFsc2UpO1xuICAgIHNlbGYucGxheWVyQ29sb3JDc3MgPSBrby5jb21wdXRlZChmdW5jdGlvbiAoKSB7XG4gICAgICAgIHJldHVybiAncGxheWVyLWNvbG9yLScgKyBzZWxmLmluZGV4KCk7XG4gICAgfSk7XG4gICAgc2VsZi5zZXRIZXJvT3B0aW9uU3R5bGluZyA9IGZ1bmN0aW9uKG9wdGlvbiwgaXRlbSkge1xuICAgICAgICBrby5hcHBseUJpbmRpbmdzVG9Ob2RlKG9wdGlvbiwge2NzczogaXRlbS5oZXJvLnBsYXllckNvbG9yQ3NzKCkgfSwgaXRlbSk7XG4gICAgfVxuICAgIHNlbGYuc2VjdGlvbkRpc3BsYXkgPSBrby5vYnNlcnZhYmxlKHtcbiAgICAgICAgJ2ludmVudG9yeSc6IGtvLm9ic2VydmFibGUodHJ1ZSksXG4gICAgICAgICdhYmlsaXR5Jzoga28ub2JzZXJ2YWJsZSh0cnVlKSxcbiAgICAgICAgJ2J1ZmYnOiBrby5vYnNlcnZhYmxlKHRydWUpLFxuICAgICAgICAnZGVidWZmJzoga28ub2JzZXJ2YWJsZSh0cnVlKSxcbiAgICAgICAgJ2RhbWFnZWFtcCc6IGtvLm9ic2VydmFibGUoZmFsc2UpLFxuICAgICAgICAnaWxsdXNpb24nOiBrby5vYnNlcnZhYmxlKGZhbHNlKSxcbiAgICAgICAgJ3NraWxsYnVpbGQnOiBrby5vYnNlcnZhYmxlKGZhbHNlKSxcbiAgICAgICAgJ3NraWxsYnVpbGQtc2tpbGxzJzoga28ub2JzZXJ2YWJsZSh0cnVlKSxcbiAgICAgICAgJ3NraWxsYnVpbGQtaXRlbXMnOiBrby5vYnNlcnZhYmxlKHRydWUpXG4gICAgfSk7XG4gICAgc2VsZi5zZWN0aW9uRGlzcGxheVRvZ2dsZSA9IGZ1bmN0aW9uIChzZWN0aW9uKSB7XG4gICAgICAgIHNlbGYuc2VjdGlvbkRpc3BsYXkoKVtzZWN0aW9uXSghc2VsZi5zZWN0aW9uRGlzcGxheSgpW3NlY3Rpb25dKCkpO1xuICAgIH1cbiAgICBzZWxmLnNob3dVbml0VGFiID0ga28ub2JzZXJ2YWJsZShmYWxzZSk7XG4gICAgc2VsZi5zaG93RGlmZiA9IGtvLm9ic2VydmFibGUoZmFsc2UpO1xuICAgIHNlbGYuc2hvd0NyaXRpY2FsU3RyaWtlRGV0YWlscyA9IGtvLm9ic2VydmFibGUoZmFsc2UpO1xuICAgIHNlbGYuc2hvd0RhbWFnZURldGFpbHMgPSBrby5vYnNlcnZhYmxlKGZhbHNlKTtcbiAgICBzZWxmLnNob3dTdGF0RGV0YWlscyA9IGtvLm9ic2VydmFibGUoZmFsc2UpO1xuXG59XG5Vbml0Vmlld01vZGVsLnByb3RvdHlwZSA9IE9iamVjdC5jcmVhdGUoSGVyb0NhbGMuVW5pdE1vZGVsLnByb3RvdHlwZSk7XG5Vbml0Vmlld01vZGVsLnByb3RvdHlwZS5jb25zdHJ1Y3RvciA9IFVuaXRWaWV3TW9kZWw7XG5cbm1vZHVsZS5leHBvcnRzID0gVW5pdFZpZXdNb2RlbDsiLCJcInVzZSBzdHJpY3RcIjtcblxudmFyIGdldFBhcmFtZXRlckJ5TmFtZSA9IGZ1bmN0aW9uIChuYW1lKSB7XG4gICAgbmFtZSA9IG5hbWUucmVwbGFjZSgvW1xcW10vLCBcIlxcXFxbXCIpLnJlcGxhY2UoL1tcXF1dLywgXCJcXFxcXVwiKTtcbiAgICB2YXIgcmVnZXggPSBuZXcgUmVnRXhwKFwiW1xcXFw/Jl1cIiArIG5hbWUgKyBcIj0oW14mI10qKVwiKSxcbiAgICAgICAgcmVzdWx0cyA9IHJlZ2V4LmV4ZWMobG9jYXRpb24uc2VhcmNoKTtcbiAgICByZXR1cm4gcmVzdWx0cyA9PSBudWxsID8gXCJcIiA6IGRlY29kZVVSSUNvbXBvbmVudChyZXN1bHRzWzFdLnJlcGxhY2UoL1xcKy9nLCBcIiBcIikpO1xufVxuXG5tb2R1bGUuZXhwb3J0cyA9IGdldFBhcmFtZXRlckJ5TmFtZTsiLCIndXNlIHN0cmljdCc7XG52YXIga28gPSAodHlwZW9mIHdpbmRvdyAhPT0gXCJ1bmRlZmluZWRcIiA/IHdpbmRvd1sna28nXSA6IHR5cGVvZiBnbG9iYWwgIT09IFwidW5kZWZpbmVkXCIgPyBnbG9iYWxbJ2tvJ10gOiBudWxsKTtcbnZhciAkID0gKHR5cGVvZiB3aW5kb3cgIT09IFwidW5kZWZpbmVkXCIgPyB3aW5kb3dbJyQnXSA6IHR5cGVvZiBnbG9iYWwgIT09IFwidW5kZWZpbmVkXCIgPyBnbG9iYWxbJyQnXSA6IG51bGwpO1xudmFyIENoYXJ0ID0gcmVxdWlyZSgnY2hhcnQuanMnKTtcbnJlcXVpcmUoJy4uL2xpYi9DaGFydC5zY2F0dGVyJyk7XG5cbmtvLmJpbmRpbmdIYW5kbGVycy5zdG9wQmluZGluZyA9IHtcbiAgICBpbml0OiBmdW5jdGlvbigpIHtcbiAgICAgICAgcmV0dXJuIHsgY29udHJvbHNEZXNjZW5kYW50QmluZGluZ3M6IHRydWUgfTtcbiAgICB9XG59O1xuXG5rby52aXJ0dWFsRWxlbWVudHMuYWxsb3dlZEJpbmRpbmdzLnN0b3BCaW5kaW5nID0gdHJ1ZTtcblxua28uYmluZGluZ0hhbmRsZXJzLmxhenlCaW5kaW5nID0ge1xuICAgIGluaXQ6IGZ1bmN0aW9uKGVsZW1lbnQsIHZhbHVlQWNjZXNzb3IsIGFsbEJpbmRpbmdzQWNjZXNzb3IsIHZpZXdNb2RlbCwgYmluZGluZ0NvbnRleHQpIHtcbiAgICAgICAga28udXRpbHMuZG9tRGF0YS5zZXQoZWxlbWVudCwgJ2lzQm91bmQnLCBmYWxzZSlcbiAgICAgICAgXG4gICAgICAgIC8vIEFsc28gdGVsbCBLTyAqbm90KiB0byBiaW5kIHRoZSBkZXNjZW5kYW50cyBpdHNlbGYsIG90aGVyd2lzZSB0aGV5IHdpbGwgYmUgYm91bmQgdHdpY2VcbiAgICAgICAgcmV0dXJuIHsgY29udHJvbHNEZXNjZW5kYW50QmluZGluZ3M6IHRydWUgfTtcbiAgICB9LFxuICAgIHVwZGF0ZTogZnVuY3Rpb24oZWxlbWVudCwgdmFsdWVBY2Nlc3NvciwgYWxsQmluZGluZ3NBY2Nlc3Nvciwgdmlld01vZGVsLCBiaW5kaW5nQ29udGV4dCkge1xuICAgICAgICB2YXIgdmFsID0ga28udW53cmFwKHZhbHVlQWNjZXNzb3IoKSksXG4gICAgICAgICAgICBpc0JvdW5kID0ga28udXRpbHMuZG9tRGF0YS5nZXQoZWxlbWVudCwgJ2lzQm91bmQnKTtcbiAgICAgICAgaWYgKHZhbCAmJiAhaXNCb3VuZCkge1xuICAgICAgICAgICAga28udXRpbHMuZG9tRGF0YS5zZXQoZWxlbWVudCwgJ2lzQm91bmQnLCB0cnVlKTtcbiAgICAgICAgICAgIGtvLmFwcGx5QmluZGluZ3NUb0Rlc2NlbmRhbnRzKGJpbmRpbmdDb250ZXh0LCBlbGVtZW50KTtcbiAgICAgICAgfVxuICAgIH1cbn07XG5cbmtvLnZpcnR1YWxFbGVtZW50cy5hbGxvd2VkQmluZGluZ3MubGF6eUJpbmRpbmcgPSB0cnVlO1xuXG5rby5iaW5kaW5nSGFuZGxlcnMuaXRlbUJ1aWxkVGFibGUgPSB7XG4gICAgaW5pdDogZnVuY3Rpb24oZWxlbWVudCwgdmFsdWVBY2Nlc3NvciwgYWxsQmluZGluZ3NBY2Nlc3Nvciwgdmlld01vZGVsLCBiaW5kaW5nQ29udGV4dCkge1xuICAgICAgICB2YXIgYnVpbGRFeHBsb3JlciA9IGtvLnVud3JhcCh2YWx1ZUFjY2Vzc29yKCkpLFxuICAgICAgICAgICAgJGVsID0gJChlbGVtZW50KTtcblxuICAgICAgICB2YXIgcHJlc3NlZEtleXMgPSB7fTtcbiAgICAgICAga28udXRpbHMuZG9tRGF0YS5zZXQoZWxlbWVudCwgJ3ByZXNzZWRLZXlzJywgcHJlc3NlZEtleXMpO1xuICAgICAgICBcbiAgICAgICAgdmFyIGtleURvd25IYW5kbGVyID0gZnVuY3Rpb24oZSkge1xuICAgICAgICAgICAgdmFyIHByZXNzZWRLZXlzID0ga28udXRpbHMuZG9tRGF0YS5nZXQoZWxlbWVudCwgJ3ByZXNzZWRLZXlzJyk7XG4gICAgICAgICAgICBwcmVzc2VkS2V5c1tlLndoaWNoXSA9IHRydWU7XG4gICAgICAgICAgICBrby51dGlscy5kb21EYXRhLnNldChlbGVtZW50LCAncHJlc3NlZEtleXMnLCBwcmVzc2VkS2V5cyk7XG4gICAgICAgIH1cbiAgICAgICAga28udXRpbHMuZG9tRGF0YS5zZXQoZWxlbWVudCwgJ2tleURvd25IYW5kbGVyJywga2V5RG93bkhhbmRsZXIpO1xuICAgICAgICBcbiAgICAgICAgdmFyIGtleVVwSGFuZGxlciA9IGZ1bmN0aW9uKGUpIHtcbiAgICAgICAgICAgIHZhciBwcmVzc2VkS2V5cyA9IGtvLnV0aWxzLmRvbURhdGEuZ2V0KGVsZW1lbnQsICdwcmVzc2VkS2V5cycpO1xuICAgICAgICAgICAgaWYgKChwcmVzc2VkS2V5c1sxN10gJiYgcHJlc3NlZEtleXNbNjddKSB8fCAocHJlc3NlZEtleXNbMTddICYmIHByZXNzZWRLZXlzWzg2XSkpIHsgLy8gY3RybCArIGNcbiAgICAgICAgICAgICAgICB2YXIgJGhvdmVyZWRSb3dzID0gJChlbGVtZW50KS5maW5kKCcuaG92ZXItY3Vyc29yOmhvdmVyJyk7XG4gICAgICAgICAgICAgICAgaWYgKCRob3ZlcmVkUm93cy5sZW5ndGggPT0gMSkge1xuICAgICAgICAgICAgICAgICAgICBpZiAocHJlc3NlZEtleXNbNjddKSB7XG4gICAgICAgICAgICAgICAgICAgICAgICBidWlsZEV4cGxvcmVyLmNvcHlJbnZlbnRvcnlUb0NsaXBCb2FyZCgkKFwidHJcIiwgJChlbGVtZW50KSkuaW5kZXgoJGhvdmVyZWRSb3dzWzBdKSk7XG4gICAgICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgICAgICAgZWxzZSB7XG4gICAgICAgICAgICAgICAgICAgICAgICBidWlsZEV4cGxvcmVyLnBhc3RlSW52ZW50b3J5RnJvbUNsaXBCb2FyZCgkKFwidHJcIiwgJChlbGVtZW50KSkuaW5kZXgoJGhvdmVyZWRSb3dzWzBdKSk7XG4gICAgICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgICAgICAgJGhvdmVyZWRSb3dzLmZhZGVPdXQoNTApLmZhZGVJbig1MCk7XG4gICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgfVxuICAgICAgICAgICAgZGVsZXRlIHByZXNzZWRLZXlzW2Uud2hpY2hdO1xuICAgICAgICAgICAga28udXRpbHMuZG9tRGF0YS5zZXQoZWxlbWVudCwgJ3ByZXNzZWRLZXlzJywgcHJlc3NlZEtleXMpO1xuICAgICAgICB9XG4gICAgICAgIGtvLnV0aWxzLmRvbURhdGEuc2V0KGVsZW1lbnQsICdrZXlVcEhhbmRsZXInLCBrZXlVcEhhbmRsZXIpO1xuICAgICAgICBcbiAgICAgICAgJChkb2N1bWVudCkuYmluZCggXCJrZXlkb3duXCIsIGtleURvd25IYW5kbGVyICk7XG4gICAgICAgICQoZG9jdW1lbnQpLmJpbmQoIFwia2V5dXBcIiwga2V5VXBIYW5kbGVyICk7XG5cbiAgICAgICAga28udXRpbHMuZG9tTm9kZURpc3Bvc2FsLmFkZERpc3Bvc2VDYWxsYmFjayhlbGVtZW50LCBmdW5jdGlvbigpIHtcbiAgICAgICAgICAgIHZhciBrZXlEb3duSGFuZGxlciA9IGtvLnV0aWxzLmRvbURhdGEuZ2V0KGVsZW1lbnQsICdrZXlEb3duSGFuZGxlcicpO1xuICAgICAgICAgICAgdmFyIGtleVVwSGFuZGxlciA9IGtvLnV0aWxzLmRvbURhdGEuZ2V0KGVsZW1lbnQsICdrZXlVcEhhbmRsZXInKTtcbiAgICAgICAgICAgICQoZG9jdW1lbnQpLnVuYmluZCggXCJrZXlkb3duXCIsIGtleURvd25IYW5kbGVyICk7XG4gICAgICAgICAgICAkKGRvY3VtZW50KS51bmJpbmQoIFwia2V5dXBcIiwga2V5VXBIYW5kbGVyICk7XG4gICAgICAgIH0pO1xuICAgIH1cbn07XG5cbmtvLmJpbmRpbmdIYW5kbGVycy5wcmV2ZW50QnViYmxlID0ge1xuICAgIGluaXQ6IGZ1bmN0aW9uKGVsZW1lbnQsIHZhbHVlQWNjZXNzb3IpIHtcbiAgICAgICAgdmFyIGV2ZW50TmFtZSA9IGtvLnV0aWxzLnVud3JhcE9ic2VydmFibGUodmFsdWVBY2Nlc3NvcigpKTtcbiAgICAgICAga28udXRpbHMucmVnaXN0ZXJFdmVudEhhbmRsZXIoZWxlbWVudCwgZXZlbnROYW1lLCBmdW5jdGlvbihldmVudCkge1xuICAgICAgICAgICBldmVudC5jYW5jZWxCdWJibGUgPSB0cnVlO1xuICAgICAgICAgICBpZiAoZXZlbnQuc3RvcFByb3BhZ2F0aW9uKSB7XG4gICAgICAgICAgICAgICAgZXZlbnQuc3RvcFByb3BhZ2F0aW9uKCk7XG4gICAgICAgICAgIH0gICAgICAgICAgICAgICAgXG4gICAgICAgIH0pO1xuICAgIH0gICAgICAgIFxufTtcblxua28uYmluZGluZ0hhbmRsZXJzLnRvZ2dsZSA9IHtcbiAgICBpbml0OiBmdW5jdGlvbiAoZWxlbWVudCwgdmFsdWVBY2Nlc3Nvcikge1xuICAgICAgICB2YXIgdmFsdWUgPSB2YWx1ZUFjY2Vzc29yKCk7XG4gICAgICAgIGtvLmFwcGx5QmluZGluZ3NUb05vZGUoZWxlbWVudCwge1xuICAgICAgICAgICAgY2xpY2s6IGZ1bmN0aW9uICgpIHtcbiAgICAgICAgICAgICAgICB2YWx1ZSghdmFsdWUoKSk7XG4gICAgICAgICAgICB9XG4gICAgICAgIH0pO1xuICAgIH1cbn07XG5cbmtvLmJpbmRpbmdIYW5kbGVycy5zaG9wRG9ja1N0eWxlID0ge1xuICAgIGluaXQ6IGZ1bmN0aW9uKGVsZW1lbnQsIHZhbHVlQWNjZXNzb3IsIGFsbEJpbmRpbmdzQWNjZXNzb3IsIHZpZXdNb2RlbCwgYmluZGluZ0NvbnRleHQpIHtcbiAgICAgICAgdmFyIHZhbHVlID0ga28udXRpbHMudW53cmFwT2JzZXJ2YWJsZSh2YWx1ZUFjY2Vzc29yKCkpO1xuICAgICAgICBpZiAoYmluZGluZ0NvbnRleHQuJGRhdGEuc2hvcERvY2soKSAmJiAhYmluZGluZ0NvbnRleHQuJGRhdGEuc2hvcFBvcG91dCgpKSB7XG4gICAgICAgICAgICBrby5hcHBseUJpbmRpbmdzVG9Ob2RlKGVsZW1lbnQsIHsgc3R5bGU6IHsgaGVpZ2h0OiAoYmluZGluZ0NvbnRleHQuJGRhdGEud2luZG93SGVpZ2h0KCkgLSA1MikgKyAncHgnLCBwb3NpdGlvbjogJ2ZpeGVkJywgcmlnaHQ6IDAsIHRvcDogJzUycHgnLCAnb3ZlcmZsb3cteSc6ICdhdXRvJyB9IH0pO1xuICAgICAgICB9XG4gICAgICAgIGVsc2Uge1xuICAgICAgICAgICAga28uYXBwbHlCaW5kaW5nc1RvTm9kZShlbGVtZW50LCB7IHN0eWxlOiB7IGhlaWdodDogJ2F1dG8nLCBwb3NpdGlvbjogJ3JlbGF0aXZlJywgcmlnaHQ6ICdpbml0aWFsJywgdG9wOiAnaW5pdGlhbCcsICdvdmVyZmxvdy15JzogJ2luaXRpYWwnIH0gfSk7XG4gICAgICAgIH1cbiAgICB9LFxuICAgIHVwZGF0ZTogZnVuY3Rpb24oZWxlbWVudCwgdmFsdWVBY2Nlc3NvciwgYWxsQmluZGluZ3NBY2Nlc3Nvciwgdmlld01vZGVsLCBiaW5kaW5nQ29udGV4dCkge1xuICAgICAgICB2YXIgdmFsdWUgPSBrby51dGlscy51bndyYXBPYnNlcnZhYmxlKHZhbHVlQWNjZXNzb3IoKSk7XG4gICAgICAgIGlmIChiaW5kaW5nQ29udGV4dC4kZGF0YS5zaG9wRG9jaygpICYmICFiaW5kaW5nQ29udGV4dC4kZGF0YS5zaG9wUG9wb3V0KCkpIHtcbiAgICAgICAgICAgIGtvLmFwcGx5QmluZGluZ3NUb05vZGUoZWxlbWVudCwgeyBzdHlsZTogeyBoZWlnaHQ6IChiaW5kaW5nQ29udGV4dC4kZGF0YS53aW5kb3dIZWlnaHQoKSAtIDUyKSArICdweCcsIHBvc2l0aW9uOiAnZml4ZWQnLCByaWdodDogMCwgdG9wOiAnNTJweCcsICdvdmVyZmxvdy15JzogJ2F1dG8nIH0gfSk7XG4gICAgICAgIH1cbiAgICAgICAgZWxzZSB7XG4gICAgICAgICAgICBrby5hcHBseUJpbmRpbmdzVG9Ob2RlKGVsZW1lbnQsIHsgc3R5bGU6IHsgaGVpZ2h0OiAnYXV0bycsIHBvc2l0aW9uOiAncmVsYXRpdmUnLCByaWdodDogJ2luaXRpYWwnLCB0b3A6ICdpbml0aWFsJywgJ292ZXJmbG93LXknOiAnaW5pdGlhbCcgfSB9KTtcbiAgICAgICAgfVxuICAgIH1cbn07XG5cbmtvLmJpbmRpbmdIYW5kbGVycy5sb2dnZXIgPSB7XG4gICAgdXBkYXRlOiBmdW5jdGlvbihlbGVtZW50LCB2YWx1ZUFjY2Vzc29yLCBhbGxCaW5kaW5ncykge1xuICAgICAgICAvL3N0b3JlIGEgY291bnRlciB3aXRoIHRoaXMgZWxlbWVudFxuICAgICAgICB2YXIgY291bnQgPSBrby51dGlscy5kb21EYXRhLmdldChlbGVtZW50LCBcIl9rb19sb2dnZXJcIikgfHwgMCxcbiAgICAgICAgICAgIGRhdGEgPSBrby50b0pTKHZhbHVlQWNjZXNzb3IoKSB8fCBhbGxCaW5kaW5ncygpKTtcblxuICAgICAgICBrby51dGlscy5kb21EYXRhLnNldChlbGVtZW50LCBcIl9rb19sb2dnZXJcIiwgKytjb3VudCk7XG5cbiAgICAgICAgaWYgKHdpbmRvdy5jb25zb2xlICYmIGNvbnNvbGUubG9nKSB7XG4gICAgICAgICAgICBjb25zb2xlLmxvZyhjb3VudCwgZWxlbWVudCwgZGF0YSk7XG4gICAgICAgIH1cbiAgICB9XG59O1xuXG5rby5iaW5kaW5nSGFuZGxlcnMudG9vbHRpcCA9IHtcbiAgICB1cGRhdGU6IGZ1bmN0aW9uIChlbGVtZW50LCB2YWx1ZUFjY2Vzc29yLCBhbGxCaW5kaW5nc0FjY2Vzc29yLCB2aWV3TW9kZWwsIGJpbmRpbmdDb250ZXh0KSB7XG4gICAgICAgIHZhciAkZWxlbWVudCwgb3B0aW9ucywgdG9vbHRpcDtcbiAgICAgICAgb3B0aW9ucyA9IGtvLnV0aWxzLnVud3JhcE9ic2VydmFibGUodmFsdWVBY2Nlc3NvcigpKTtcbiAgICAgICAgJGVsZW1lbnQgPSAkKGVsZW1lbnQpO1xuXG4gICAgICAgIC8vIElmIHRoZSB0aXRsZSBpcyBhbiBvYnNlcnZhYmxlLCBtYWtlIGl0IGF1dG8tdXBkYXRpbmcuXG4gICAgICAgIGlmIChrby5pc09ic2VydmFibGUob3B0aW9ucy50aXRsZSkpIHtcbiAgICAgICAgICAgIHZhciBpc1Rvb2xUaXBWaXNpYmxlID0gZmFsc2U7XG5cbiAgICAgICAgICAgICRlbGVtZW50Lm9uKCdzaG93LmJzLnRvb2x0aXAnLCBmdW5jdGlvbiAoKSB7XG4gICAgICAgICAgICAgICAgaXNUb29sVGlwVmlzaWJsZSA9IHRydWU7XG4gICAgICAgICAgICB9KTtcbiAgICAgICAgICAgICRlbGVtZW50Lm9uKCdoaWRlLmJzLnRvb2x0aXAnLCBmdW5jdGlvbiAoKSB7XG4gICAgICAgICAgICAgICAgaXNUb29sVGlwVmlzaWJsZSA9IGZhbHNlO1xuICAgICAgICAgICAgfSk7XG5cbiAgICAgICAgICAgIC8vIFwidHJ1ZVwiIGlzIHRoZSBib290c3RyYXAgZGVmYXVsdC5cbiAgICAgICAgICAgIHZhciBvcmlnQW5pbWF0aW9uID0gb3B0aW9ucy5hbmltYXRpb24gfHwgdHJ1ZTtcbiAgICAgICAgICAgIG9wdGlvbnMudGl0bGUuc3Vic2NyaWJlKGZ1bmN0aW9uICgpIHtcbiAgICAgICAgICAgICAgICBpZiAoaXNUb29sVGlwVmlzaWJsZSkge1xuICAgICAgICAgICAgICAgICAgICAkZWxlbWVudC5kYXRhKCdicy50b29sdGlwJykub3B0aW9ucy5hbmltYXRpb24gPSBmYWxzZTsgLy8gdGVtcG9yYXJpbHkgZGlzYWJsZSBhbmltYXRpb24gdG8gYXZvaWQgZmxpY2tlcmluZyBvZiB0aGUgdG9vbHRpcFxuICAgICAgICAgICAgICAgICAgICAkZWxlbWVudC50b29sdGlwKCdmaXhUaXRsZScpIC8vIGNhbGwgdGhpcyBtZXRob2QgdG8gdXBkYXRlIHRoZSB0aXRsZVxuICAgICAgICAgICAgICAgICAgICAgICAgLnRvb2x0aXAoJ3Nob3cnKTtcbiAgICAgICAgICAgICAgICAgICAgJGVsZW1lbnQuZGF0YSgnYnMudG9vbHRpcCcpLm9wdGlvbnMuYW5pbWF0aW9uID0gb3JpZ0FuaW1hdGlvbjtcbiAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICB9KTtcbiAgICAgICAgfVxuXG4gICAgICAgIHRvb2x0aXAgPSAkZWxlbWVudC5kYXRhKCdicy50b29sdGlwJyk7XG4gICAgICAgIGlmICh0b29sdGlwKSB7XG4gICAgICAgICAgICAkLmV4dGVuZCh0b29sdGlwLm9wdGlvbnMsIG9wdGlvbnMpO1xuICAgICAgICB9IGVsc2Uge1xuICAgICAgICAgICAgJGVsZW1lbnQudG9vbHRpcChvcHRpb25zKTtcbiAgICAgICAgfVxuICAgIH1cbn07XG5cbmtvLmJpbmRpbmdIYW5kbGVycy5wb3BvdmVyID0ge1xuICAgIGluaXQ6IGZ1bmN0aW9uIChlbGVtZW50LCB2YWx1ZUFjY2Vzc29yLCBhbGxCaW5kaW5nc0FjY2Vzc29yLCB2aWV3TW9kZWwsIGJpbmRpbmdDb250ZXh0KSB7XG4gICAgICAgIHZhciAkZWxlbWVudCA9ICQoZWxlbWVudCk7XG4gICAgICAgIHZhciBwb3BvdmVyQmluZGluZ1ZhbHVlcyA9IGtvLnV0aWxzLnVud3JhcE9ic2VydmFibGUodmFsdWVBY2Nlc3NvcigpKTtcbiAgICAgICAgdmFyIHRlbXBsYXRlID0gcG9wb3ZlckJpbmRpbmdWYWx1ZXMudGVtcGxhdGUgfHwgZmFsc2U7XG4gICAgICAgIHZhciBvcHRpb25zID0gcG9wb3ZlckJpbmRpbmdWYWx1ZXMub3B0aW9ucyB8fCB7dGl0bGU6ICdwb3BvdmVyJ307XG4gICAgICAgIHZhciBkYXRhID0gcG9wb3ZlckJpbmRpbmdWYWx1ZXMuZGF0YSB8fCBmYWxzZTtcbiAgICAgICAgaWYgKHRlbXBsYXRlICE9PSBmYWxzZSkge1xuICAgICAgICAgICAgaWYgKGRhdGEpIHtcbiAgICAgICAgICAgICAgICBvcHRpb25zLmNvbnRlbnQgPSBcIjwhLS0ga28gdGVtcGxhdGU6IHsgbmFtZTogdGVtcGxhdGUsIGlmOiBkYXRhLCBkYXRhOiBkYXRhIH0gLS0+PCEtLSAva28gLS0+XCI7XG4gICAgICAgICAgICB9XG4gICAgICAgICAgICBlbHNlIHtcbiAgICAgICAgICAgICAgICBvcHRpb25zLmNvbnRlbnQgPSAkKCcjJyArIHRlbXBsYXRlKS5odG1sKCk7XG4gICAgICAgICAgICB9XG4gICAgICAgICAgICBvcHRpb25zLmh0bWwgPSB0cnVlO1xuICAgICAgICB9XG4gICAgICAgICRlbGVtZW50Lm9uKCdzaG93bi5icy5wb3BvdmVyJywgZnVuY3Rpb24oZXZlbnQpIHtcblxuICAgICAgICAgICAgdmFyIHBvcG92ZXJEYXRhID0gJChldmVudC50YXJnZXQpLmRhdGEoKTtcbiAgICAgICAgICAgIHZhciBwb3BvdmVyRWwgPSBwb3BvdmVyRGF0YVsnYnMucG9wb3ZlciddLiR0aXA7XG4gICAgICAgICAgICB2YXIgb3B0aW9ucyA9IHBvcG92ZXJEYXRhWydicy5wb3BvdmVyJ10ub3B0aW9ucyB8fCB7fTtcbiAgICAgICAgICAgIHZhciBidXR0b24gPSAkKGV2ZW50LnRhcmdldCk7XG4gICAgICAgICAgICB2YXIgYnV0dG9uUG9zaXRpb24gPSBidXR0b24ucG9zaXRpb24oKTtcbiAgICAgICAgICAgIHZhciBidXR0b25EaW1lbnNpb25zID0ge1xuICAgICAgICAgICAgICAgIHg6IGJ1dHRvbi5vdXRlcldpZHRoKCksXG4gICAgICAgICAgICAgICAgeTogYnV0dG9uLm91dGVySGVpZ2h0KClcbiAgICAgICAgICAgIH07XG5cbiAgICAgICAgICAgIGlmIChkYXRhKSB7XG4gICAgICAgICAgICAgICAga28uYXBwbHlCaW5kaW5nc1RvTm9kZShwb3BvdmVyRWxbMF0sIHsgdGVtcGxhdGU6IHsgbmFtZTogdGVtcGxhdGUsIGRhdGE6IGRhdGEgfSB9LCBiaW5kaW5nQ29udGV4dCk7XG4gICAgICAgICAgICAgICAgLy9rby5hcHBseUJpbmRpbmdzKHt0ZW1wbGF0ZTogdGVtcGxhdGUsIGRhdGE6IGRhdGF9LCBwb3BvdmVyRWxbMF0pO1xuICAgICAgICAgICAgICAgIC8va28ucmVuZGVyVGVtcGxhdGUodGVtcGxhdGUsIGRhdGEsIHt9LCBwb3BvdmVyRWxbMF0sICdyZXBsYWNlQ2hpbGRyZW4nKTtcbiAgICAgICAgICAgIH1cbiAgICAgICAgICAgIGVsc2Uge1xuICAgICAgICAgICAgICAgIC8va28ucmVuZGVyVGVtcGxhdGUodGVtcGxhdGUsIGRhdGEsIHt9LCBwb3BvdmVyRWxbMF0sICdyZXBsYWNlQ2hpbGRyZW4nKTtcbiAgICAgICAgICAgICAgICAvL2tvLmFwcGx5QmluZGluZ3Modmlld01vZGVsLCBwb3BvdmVyRWxbMF0pO1xuICAgICAgICAgICAgfVxuXG4gICAgICAgICAgICB2YXIgcG9wb3ZlckRpbWVuc2lvbnMgPSB7XG4gICAgICAgICAgICAgICAgeDogcG9wb3ZlckVsLm91dGVyV2lkdGgoKSxcbiAgICAgICAgICAgICAgICB5OiBwb3BvdmVyRWwub3V0ZXJIZWlnaHQoKVxuICAgICAgICAgICAgfTtcblxuICAgICAgICAgICAgcG9wb3ZlckVsLmZpbmQoJ2J1dHRvbltkYXRhLWRpc21pc3M9XCJwb3BvdmVyXCJdJykuY2xpY2soZnVuY3Rpb24oKSB7XG4gICAgICAgICAgICAgICAgYnV0dG9uLnBvcG92ZXIoJ2hpZGUnKTtcbiAgICAgICAgICAgIH0pO1xuXG4gICAgICAgICAgICBzd2l0Y2ggKG9wdGlvbnMucGxhY2VtZW50KSB7XG4gICAgICAgICAgICAgICAgY2FzZSAncmlnaHQnOlxuICAgICAgICAgICAgICAgICAgICBwb3BvdmVyRWwuY3NzKHtcbiAgICAgICAgICAgICAgICAgICAgICAgIGxlZnQ6IGJ1dHRvbkRpbWVuc2lvbnMueCArIGJ1dHRvblBvc2l0aW9uLmxlZnQsXG4gICAgICAgICAgICAgICAgICAgICAgICB0b3A6IChidXR0b25EaW1lbnNpb25zLnkgLyAyICsgYnV0dG9uUG9zaXRpb24udG9wKSAtIHBvcG92ZXJEaW1lbnNpb25zLnkgLyAyXG4gICAgICAgICAgICAgICAgICAgIH0pO1xuICAgICAgICAgICAgICAgICAgICBicmVhaztcbiAgICAgICAgICAgICAgICBjYXNlICdsZWZ0JzpcbiAgICAgICAgICAgICAgICAgICAgcG9wb3ZlckVsLmNzcyh7XG4gICAgICAgICAgICAgICAgICAgICAgICBsZWZ0OiBidXR0b25Qb3NpdGlvbi5sZWZ0IC0gcG9wb3ZlckRpbWVuc2lvbnMueCxcbiAgICAgICAgICAgICAgICAgICAgICAgIHRvcDogKGJ1dHRvbkRpbWVuc2lvbnMueSAvIDIgKyBidXR0b25Qb3NpdGlvbi50b3ApIC0gcG9wb3ZlckRpbWVuc2lvbnMueSAvIDJcbiAgICAgICAgICAgICAgICAgICAgfSk7XG4gICAgICAgICAgICAgICAgICAgIGJyZWFrO1xuICAgICAgICAgICAgICAgIGNhc2UgJ3RvcCc6XG4gICAgICAgICAgICAgICAgICAgIHBvcG92ZXJFbC5jc3Moe1xuICAgICAgICAgICAgICAgICAgICAgICAgbGVmdDogYnV0dG9uUG9zaXRpb24ubGVmdCArIChidXR0b25EaW1lbnNpb25zLnggLyAyIC0gcG9wb3ZlckRpbWVuc2lvbnMueCAvIDIpLFxuICAgICAgICAgICAgICAgICAgICAgICAgdG9wOiBidXR0b25Qb3NpdGlvbi50b3AgLSBwb3BvdmVyRGltZW5zaW9ucy55XG4gICAgICAgICAgICAgICAgICAgIH0pO1xuICAgICAgICAgICAgICAgICAgICBicmVhaztcbiAgICAgICAgICAgICAgICBjYXNlICdib3R0b20nOlxuICAgICAgICAgICAgICAgICAgICBwb3BvdmVyRWwuY3NzKHtcbiAgICAgICAgICAgICAgICAgICAgICAgIGxlZnQ6IGJ1dHRvblBvc2l0aW9uLmxlZnQgKyAoYnV0dG9uRGltZW5zaW9ucy54IC8gMiAtIHBvcG92ZXJEaW1lbnNpb25zLnggLyAyKSxcbiAgICAgICAgICAgICAgICAgICAgICAgIHRvcDogYnV0dG9uUG9zaXRpb24udG9wICsgYnV0dG9uRGltZW5zaW9ucy55XG4gICAgICAgICAgICAgICAgICAgIH0pO1xuICAgICAgICAgICAgICAgICAgICBicmVhaztcbiAgICAgICAgICAgIH1cbiAgICAgICAgfSk7XG5cbiAgICAgICAgJGVsZW1lbnQucG9wb3ZlcihvcHRpb25zKTtcblxuICAgICAgICByZXR1cm4geyBjb250cm9sc0Rlc2NlbmRhbnRCaW5kaW5nczogdHJ1ZSB9O1xuXG4gICAgfVxufTtcblxua28uYmluZGluZ0hhbmRsZXJzLmNoYXJ0ID0ge1xuICAgIGluaXQ6IGZ1bmN0aW9uKGVsZW1lbnQsIHZhbHVlQWNjZXNzb3IsIGFsbEJpbmRpbmdzQWNjZXNzb3IsIHZpZXdNb2RlbCwgYmluZGluZ0NvbnRleHQpIHtcbiAgICAgICAgdmFyIG5ld0NhbnZhcyA9ICQoJzxjYW52YXMvPicpLFxuICAgICAgZGF0YSA9IGtvLnV0aWxzLnVud3JhcE9ic2VydmFibGUodmFsdWVBY2Nlc3NvcigpKSxcbiAgICAgIGN0eCA9IG5ld0NhbnZhc1swXS5nZXRDb250ZXh0KFwiMmRcIiksXG4gICAgICBjaGFydFR5cGUgPSBhbGxCaW5kaW5nc0FjY2Vzc29yKCkuY2hhcnRUeXBlLFxuICAgICAgb3B0aW9ucyA9IGFsbEJpbmRpbmdzQWNjZXNzb3IoKS5jaGFydE9wdGlvbnMgfHwge30sXG4gICAgICBjaGFydENvbnRleHQgPSBhbGxCaW5kaW5nc0FjY2Vzc29yKCkuY2hhcnRDb250ZXh0O1xuICAgICAgICAgICAgXG4gICAgICAgICQoZWxlbWVudCkuYXBwZW5kKG5ld0NhbnZhcyk7XG4gICAgICAgIHZhciBteUNoYXJ0ID0gbmV3IENoYXJ0KGN0eClbY2hhcnRUeXBlXShkYXRhLCBvcHRpb25zKTtcbiAgICAgICAga28udXRpbHMuZG9tRGF0YS5zZXQoZWxlbWVudCwgJ215Q2hhcnQnLCBteUNoYXJ0KTtcbiAgICAgICAgXG4gIC8vaGFuZGxlIGRpc3Bvc2FsIChpZiBLTyByZW1vdmVzIGJ5IHRoZSB0ZW1wbGF0ZSBiaW5kaW5nKVxuICBrby51dGlscy5kb21Ob2RlRGlzcG9zYWwuYWRkRGlzcG9zZUNhbGxiYWNrKGVsZW1lbnQsIGZ1bmN0aW9uKCkge1xuICAgIHZhciBteUNoYXJ0ID0ga28udXRpbHMuZG9tRGF0YS5nZXQoZWxlbWVudCwgJ215Q2hhcnQnKTtcbiAgICBteUNoYXJ0LmNsZWFyKCk7XG4gICAgbXlDaGFydC5kZXN0cm95KCk7XG4gIH0pO1xuICAgICAgICBcbiAgaWYgKGNoYXJ0Q29udGV4dCkge1xuICAgIGNoYXJ0Q29udGV4dChjdHgpO1xuICB9XG4gICAgfSxcbiAgICB1cGRhdGU6IGZ1bmN0aW9uKGVsZW1lbnQsIHZhbHVlQWNjZXNzb3IsIGFsbEJpbmRpbmdzQWNjZXNzb3IsIHZpZXdNb2RlbCwgYmluZGluZ0NvbnRleHQpIHtcbiAgICAgICAgdmFyIG5ld0NhbnZhcyA9ICQoJzxjYW52YXMvPicpLndpZHRoKDczMCkuaGVpZ2h0KDM2NSksXG4gICAgICBkYXRhID0ga28udXRpbHMudW53cmFwT2JzZXJ2YWJsZSh2YWx1ZUFjY2Vzc29yKCkpLFxuICAgICAgY3R4ID0gbmV3Q2FudmFzWzBdLmdldENvbnRleHQoXCIyZFwiKSxcbiAgICAgIGNoYXJ0VHlwZSA9IGFsbEJpbmRpbmdzQWNjZXNzb3IoKS5jaGFydFR5cGUsXG4gICAgICBvcHRpb25zID0gYWxsQmluZGluZ3NBY2Nlc3NvcigpLmNoYXJ0T3B0aW9ucyB8fCB7fSxcbiAgICAgIGNoYXJ0Q29udGV4dCA9IGFsbEJpbmRpbmdzQWNjZXNzb3IoKS5jaGFydENvbnRleHQsXG4gICAgICBteUNoYXJ0ID0ga28udXRpbHMuZG9tRGF0YS5nZXQoZWxlbWVudCwgJ215Q2hhcnQnKTtcbiAgICAgICAgXG4gIGlmIChteUNoYXJ0KSB7XG4gICAgbXlDaGFydC5jbGVhcigpO1xuICAgIG15Q2hhcnQuZGVzdHJveSgpO1xuICB9XG4gICAgICAgIGJpbmRpbmdDb250ZXh0LiRyb290LmRpc3BsYXlTaG9wKCk7XG4gICAgICAgIGJpbmRpbmdDb250ZXh0LiRyb290LnNpZGVWaWV3KCk7XG4gICAgICAgIGJpbmRpbmdDb250ZXh0LiRyb290LnNob3BEb2NrKCk7XG4gICAgICAgICQoZWxlbWVudCkuZW1wdHkoKTtcbiAgICAgICAgJChlbGVtZW50KS5hcHBlbmQobmV3Q2FudmFzKTtcbiAgaWYgKGRhdGEuZGF0YXNldHMubGVuZ3RoID4gMCkge1xuICAgICAgICAgICAgbXlDaGFydCA9IG5ldyBDaGFydChjdHgpW2NoYXJ0VHlwZV0oZGF0YSwgb3B0aW9ucyk7XG4gICAgICAgICAgICBrby51dGlscy5kb21EYXRhLnNldChlbGVtZW50LCAnbXlDaGFydCcsIG15Q2hhcnQpO1xuICB9XG4gIFxuICBpZiAoY2hhcnRDb250ZXh0KSB7XG4gICAgY2hhcnRDb250ZXh0KGN0eCk7XG4gIH1cbiAgICB9XG59O1xuXG5rby5iaW5kaW5nSGFuZGxlcnMuc3Bpbm5lciA9IHtcbiAgICBpbml0OiBmdW5jdGlvbihlbGVtZW50LCB2YWx1ZUFjY2Vzc29yLCBhbGxCaW5kaW5nc0FjY2Vzc29yKSB7XG4gICAgICAgIC8vaW5pdGlhbGl6ZSBkYXRlcGlja2VyIHdpdGggc29tZSBvcHRpb25hbCBvcHRpb25zXG4gICAgICAgIHZhciBvcHRpb25zID0gYWxsQmluZGluZ3NBY2Nlc3NvcigpLnNwaW5uZXJPcHRpb25zIHx8IHt9O1xuICAgICAgICBvcHRpb25zLmljb25zID0gb3B0aW9ucy5pY29ucyB8fCB7IGRvd246IFwiZ2x5cGhpY29uIGdseXBoaWNvbi10cmlhbmdsZS1ib3R0b21cIiwgdXA6IFwiZ2x5cGhpY29uIGdseXBoaWNvbi10cmlhbmdsZS10b3BcIiB9O1xuICAgICAgICAkKGVsZW1lbnQpLnNwaW5uZXIob3B0aW9ucyk7XG5cbiAgICAgICAgLy9oYW5kbGUgdGhlIGZpZWxkIGNoYW5naW5nXG4gICAgICAgIGtvLnV0aWxzLnJlZ2lzdGVyRXZlbnRIYW5kbGVyKGVsZW1lbnQsIFwic3BpbmNoYW5nZVwiLCBmdW5jdGlvbiAoKSB7XG4gICAgICAgICAgICB2YXIgb2JzZXJ2YWJsZSA9IHZhbHVlQWNjZXNzb3IoKTtcbiAgICAgICAgICAgIG9ic2VydmFibGUoJChlbGVtZW50KS5zcGlubmVyKFwidmFsdWVcIikpO1xuICAgICAgICB9KTtcblxuICAgICAgICAvL2hhbmRsZSBkaXNwb3NhbCAoaWYgS08gcmVtb3ZlcyBieSB0aGUgdGVtcGxhdGUgYmluZGluZylcbiAgICAgICAga28udXRpbHMuZG9tTm9kZURpc3Bvc2FsLmFkZERpc3Bvc2VDYWxsYmFjayhlbGVtZW50LCBmdW5jdGlvbigpIHtcbiAgICAgICAgICAgICQoZWxlbWVudCkuc3Bpbm5lcihcImRlc3Ryb3lcIik7XG4gICAgICAgIH0pO1xuXG4gICAgfSxcbiAgICB1cGRhdGU6IGZ1bmN0aW9uKGVsZW1lbnQsIHZhbHVlQWNjZXNzb3IpIHtcbiAgICAgICAgdmFyIHZhbHVlID0ga28udXRpbHMudW53cmFwT2JzZXJ2YWJsZSh2YWx1ZUFjY2Vzc29yKCkpLFxuICAgICAgICAgICAgY3VycmVudCA9ICQoZWxlbWVudCkuc3Bpbm5lcihcInZhbHVlXCIpO1xuXG4gICAgICAgIGlmICh2YWx1ZSAhPT0gY3VycmVudCkge1xuICAgICAgICAgICAgJChlbGVtZW50KS5zcGlubmVyKFwidmFsdWVcIiwgdmFsdWUpO1xuICAgICAgICB9XG4gICAgfVxufTtcblxua28uYmluZGluZ0hhbmRsZXJzLnNlY29uZFRhYiA9IHtcbiAgICB1cGRhdGU6IGZ1bmN0aW9uKGVsZW1lbnQsIHZhbHVlQWNjZXNzb3IsIGFsbEJpbmRpbmdzQWNjZXNzb3IsIHZpZXdNb2RlbCwgYmluZGluZ0NvbnRleHQpIHtcbiAgICAgICAgdmFyICRyb290ID0gYmluZGluZ0NvbnRleHQuJHJvb3QsXG4gICAgICAgICAgICB2YWx1ZSA9IGtvLnV0aWxzLnVud3JhcE9ic2VydmFibGUodmFsdWVBY2Nlc3NvcigpKTtcbiAgICAgICAga28uYXBwbHlCaW5kaW5nc1RvTm9kZShlbGVtZW50LCB7IGNzczogeydzZWNvbmQtdGFiJzogJHJvb3QuaXNTZWNvbmRUYWIodmFsdWUpICYmICRyb290LnNpZGVWaWV3KCl9IH0pO1xuICAgIH1cbn07XG5cbmtvLmJpbmRpbmdIYW5kbGVycy5ob3ZlclRhYiA9IHtcbiAgICB1cGRhdGU6IGZ1bmN0aW9uKGVsZW1lbnQsIHZhbHVlQWNjZXNzb3IsIGFsbEJpbmRpbmdzQWNjZXNzb3IsIHZpZXdNb2RlbCwgYmluZGluZ0NvbnRleHQpIHtcbiAgICAgICAgdmFyICRyb290ID0gYmluZGluZ0NvbnRleHQuJHJvb3QsXG4gICAgICAgICAgICB2YWx1ZSA9IGtvLnV0aWxzLnVud3JhcE9ic2VydmFibGUodmFsdWVBY2Nlc3NvcigpKTtcbiAgICAgICAgICAgIFxuICAgICAgICBrby51dGlscy5yZWdpc3RlckV2ZW50SGFuZGxlcihlbGVtZW50LCBcIm1vdXNlb3ZlclwiLCBmdW5jdGlvbigpIHtcbiAgICAgICAgICAgICRyb290LmhpZ2hsaWdodFRhYih2YWx1ZSk7XG4gICAgICAgIH0pOyAgXG5cbiAgICAgICAga28udXRpbHMucmVnaXN0ZXJFdmVudEhhbmRsZXIoZWxlbWVudCwgXCJtb3VzZW91dFwiLCBmdW5jdGlvbigpIHtcbiAgICAgICAgICAgICRyb290LnVuaGlnaGxpZ2h0VGFiKHZhbHVlKTtcbiAgICAgICAgfSk7ICAgICAgXG4gICAgfVxufTtcblxua28uYmluZGluZ0hhbmRsZXJzLmhvdmVyUGFuZVN0eWxlID0ge1xuICAgIGluaXQ6IGZ1bmN0aW9uKGVsZW1lbnQsIHZhbHVlQWNjZXNzb3IsIGFsbEJpbmRpbmdzQWNjZXNzb3IsIHZpZXdNb2RlbCwgYmluZGluZ0NvbnRleHQpIHtcbiAgICAgICAgdmFyICRyb290ID0gYmluZGluZ0NvbnRleHQuJHJvb3QsXG4gICAgICAgICAgICB2YWx1ZSA9IGtvLnV0aWxzLnVud3JhcE9ic2VydmFibGUodmFsdWVBY2Nlc3NvcigpKTtcbiAgICAgICAga28uYXBwbHlCaW5kaW5nc1RvTm9kZShlbGVtZW50LCB7IHN0eWxlOiB7IG9wYWNpdHk6ICEoJHJvb3Quc2lkZVZpZXcoKSkgfHwgJHJvb3QuaGlnaGxpZ2h0ZWRUYWIoKSA9PSB2YWx1ZSB8fCAkcm9vdC5oaWdobGlnaHRlZFRhYigpID09ICcnID8gMSA6IC41IH0gfSk7XG4gICAgfSxcbiAgICB1cGRhdGU6IGZ1bmN0aW9uKGVsZW1lbnQsIHZhbHVlQWNjZXNzb3IsIGFsbEJpbmRpbmdzQWNjZXNzb3IsIHZpZXdNb2RlbCwgYmluZGluZ0NvbnRleHQpIHtcbiAgICAgICAgdmFyICRyb290ID0gYmluZGluZ0NvbnRleHQuJHJvb3QsXG4gICAgICAgICAgICB2YWx1ZSA9IGtvLnV0aWxzLnVud3JhcE9ic2VydmFibGUodmFsdWVBY2Nlc3NvcigpKTtcbiAgICAgICAga28uYXBwbHlCaW5kaW5nc1RvTm9kZShlbGVtZW50LCB7IHN0eWxlOiB7IG9wYWNpdHk6ICEoJHJvb3Quc2lkZVZpZXcoKSkgfHwgJHJvb3QuaGlnaGxpZ2h0ZWRUYWIoKSA9PSB2YWx1ZSB8fCAkcm9vdC5oaWdobGlnaHRlZFRhYigpID09ICcnID8gMSA6IC41IH0gfSk7XG4gICAgfVxufTtcblxua28uYmluZGluZ0hhbmRsZXJzLmRpZmZTdHlsZSA9IHtcbiAgICBpbml0OiBmdW5jdGlvbihlbGVtZW50LCB2YWx1ZUFjY2Vzc29yLCBhbGxCaW5kaW5nc0FjY2Vzc29yLCB2aWV3TW9kZWwpIHtcbiAgICAgICAgdmFyIHZhbHVlID0ga28udXRpbHMudW53cmFwT2JzZXJ2YWJsZSh2YWx1ZUFjY2Vzc29yKCkpO1xuICAgICAgICBrby5hcHBseUJpbmRpbmdzVG9Ob2RlKGVsZW1lbnQsIHsgY3NzOiB7J2RpZmZQb3MnOiB2YWx1ZSA+IDAsICdkaWZmTmVnJzogdmFsdWUgPCAwfSB9KTtcbiAgICB9LFxuICAgIHVwZGF0ZTogZnVuY3Rpb24oZWxlbWVudCwgdmFsdWVBY2Nlc3NvciwgYWxsQmluZGluZ3NBY2Nlc3Nvciwgdmlld01vZGVsKSB7XG4gICAgICAgIHZhciB2YWx1ZSA9IGtvLnV0aWxzLnVud3JhcE9ic2VydmFibGUodmFsdWVBY2Nlc3NvcigpKTtcbiAgICAgICAga28uYXBwbHlCaW5kaW5nc1RvTm9kZShlbGVtZW50LCB7IGNzczogeydkaWZmUG9zJzogdmFsdWUgPiAwLCAnZGlmZk5lZyc6IHZhbHVlIDwgMH0gfSk7XG4gICAgfVxufTtcblxua28uYmluZGluZ0hhbmRsZXJzLmRpZmZDc3MgPSB7XG4gICAgaW5pdDogZnVuY3Rpb24oZWxlbWVudCwgdmFsdWVBY2Nlc3NvciwgYWxsQmluZGluZ3NBY2Nlc3Nvciwgdmlld01vZGVsKSB7XG4gICAgICAgIHZhciB2YWx1ZSA9IGtvLnV0aWxzLnVud3JhcE9ic2VydmFibGUodmFsdWVBY2Nlc3NvcigpKSxcbiAgICAgICAgICAgIHN0YXQgPSBhbGxCaW5kaW5nc0FjY2Vzc29yKCkuZGlmZkNzc1N0YXQ7XG4gICAgICAgIGlmIChzdGF0ID09ICdhdHRhY2tUaW1lJyB8fCBzdGF0ID09ICdiYXQnKSB7XG4gICAgICAgICAgICB2YWx1ZSA9IC12YWx1ZTtcbiAgICAgICAgfVxuICAgICAgICBrby5hcHBseUJpbmRpbmdzVG9Ob2RlKGVsZW1lbnQsIHsgY3NzOiB7J2RpZmZQb3MnOiB2YWx1ZSA+IDAsICdkaWZmTmVnJzogdmFsdWUgPCAwfSB9KTtcbiAgICB9LFxuICAgIHVwZGF0ZTogZnVuY3Rpb24oZWxlbWVudCwgdmFsdWVBY2Nlc3NvciwgYWxsQmluZGluZ3NBY2Nlc3Nvciwgdmlld01vZGVsKSB7XG4gICAgICAgIHZhciB2YWx1ZSA9IGtvLnV0aWxzLnVud3JhcE9ic2VydmFibGUodmFsdWVBY2Nlc3NvcigpKSxcbiAgICAgICAgICAgIHN0YXQgPSBhbGxCaW5kaW5nc0FjY2Vzc29yKCkuZGlmZkNzc1N0YXQ7XG4gICAgICAgIGlmIChzdGF0ID09ICdhdHRhY2tUaW1lJyB8fCBzdGF0ID09ICdiYXQnKSB7XG4gICAgICAgICAgICB2YWx1ZSA9IC12YWx1ZTtcbiAgICAgICAgfVxuICAgICAgICBrby5hcHBseUJpbmRpbmdzVG9Ob2RlKGVsZW1lbnQsIHsgY3NzOiB7J2RpZmZQb3MnOiB2YWx1ZSA+IDAsICdkaWZmTmVnJzogdmFsdWUgPCAwfSB9KTtcbiAgICB9XG59O1xuXG5rby5iaW5kaW5nSGFuZGxlcnMuanFBdXRvID0ge1xuICAgIGluaXQ6IGZ1bmN0aW9uKGVsZW1lbnQsIHZhbHVlQWNjZXNzb3IsIGFsbEJpbmRpbmdzQWNjZXNzb3IsIHZpZXdNb2RlbCkge1xuICAgICAgICB2YXIgb3B0aW9ucyA9IHZhbHVlQWNjZXNzb3IoKSB8fCB7fSxcbiAgICAgICAgICAgIGFsbEJpbmRpbmdzID0gYWxsQmluZGluZ3NBY2Nlc3NvcigpLFxuICAgICAgICAgICAgdW53cmFwID0ga28udXRpbHMudW53cmFwT2JzZXJ2YWJsZSxcbiAgICAgICAgICAgIG1vZGVsVmFsdWUgPSBhbGxCaW5kaW5ncy5qcUF1dG9WYWx1ZSxcbiAgICAgICAgICAgIHNvdXJjZSA9IGFsbEJpbmRpbmdzLmpxQXV0b1NvdXJjZSxcbiAgICAgICAgICAgIHZhbHVlUHJvcCA9IGFsbEJpbmRpbmdzLmpxQXV0b1NvdXJjZVZhbHVlLFxuICAgICAgICAgICAgaW5wdXRWYWx1ZVByb3AgPSBhbGxCaW5kaW5ncy5qcUF1dG9Tb3VyY2VJbnB1dFZhbHVlIHx8IHZhbHVlUHJvcCxcbiAgICAgICAgICAgIGxhYmVsUHJvcCA9IGFsbEJpbmRpbmdzLmpxQXV0b1NvdXJjZUxhYmVsIHx8IHZhbHVlUHJvcDtcblxuICAgICAgICAvL2Z1bmN0aW9uIHRoYXQgaXMgc2hhcmVkIGJ5IGJvdGggc2VsZWN0IGFuZCBjaGFuZ2UgZXZlbnQgaGFuZGxlcnNcbiAgICAgICAgZnVuY3Rpb24gd3JpdGVWYWx1ZVRvTW9kZWwodmFsdWVUb1dyaXRlKSB7XG4gICAgICAgICAgICBpZiAoa28uaXNXcml0ZWFibGVPYnNlcnZhYmxlKG1vZGVsVmFsdWUpKSB7XG4gICAgICAgICAgICAgICBtb2RlbFZhbHVlKHZhbHVlVG9Xcml0ZSApOyAgXG4gICAgICAgICAgICB9IGVsc2UgeyAgLy93cml0ZSB0byBub24tb2JzZXJ2YWJsZVxuICAgICAgICAgICAgICAgaWYgKGFsbEJpbmRpbmdzWydfa29fcHJvcGVydHlfd3JpdGVycyddICYmIGFsbEJpbmRpbmdzWydfa29fcHJvcGVydHlfd3JpdGVycyddWydqcUF1dG9WYWx1ZSddKVxuICAgICAgICAgICAgICAgICAgICAgICAgYWxsQmluZGluZ3NbJ19rb19wcm9wZXJ0eV93cml0ZXJzJ11bJ2pxQXV0b1ZhbHVlJ10odmFsdWVUb1dyaXRlICk7ICAgIFxuICAgICAgICAgICAgfVxuICAgICAgICB9XG4gICAgICAgIFxuICAgICAgICAvL29uIGEgc2VsZWN0aW9uIHdyaXRlIHRoZSBwcm9wZXIgdmFsdWUgdG8gdGhlIG1vZGVsXG4gICAgICAgIG9wdGlvbnMuc2VsZWN0ID0gZnVuY3Rpb24oZXZlbnQsIHVpKSB7XG4gICAgICAgICAgICB3cml0ZVZhbHVlVG9Nb2RlbCh1aS5pdGVtID8gdWkuaXRlbS5hY3R1YWxWYWx1ZSA6IG51bGwpO1xuICAgICAgICB9O1xuICAgICAgICAgICAgXG4gICAgICAgIC8vb24gYSBjaGFuZ2UsIG1ha2Ugc3VyZSB0aGF0IGl0IGlzIGEgdmFsaWQgdmFsdWUgb3IgY2xlYXIgb3V0IHRoZSBtb2RlbCB2YWx1ZVxuICAgICAgICBvcHRpb25zLmNoYW5nZSA9IGZ1bmN0aW9uKGV2ZW50LCB1aSkge1xuICAgICAgICAgICAgdmFyIGN1cnJlbnRWYWx1ZSA9ICQoZWxlbWVudCkudmFsKCk7XG4gICAgICAgICAgICB2YXIgbWF0Y2hpbmdJdGVtID0gIGtvLnV0aWxzLmFycmF5Rmlyc3QodW53cmFwKHNvdXJjZSksIGZ1bmN0aW9uKGl0ZW0pIHtcbiAgICAgICAgICAgICAgIHJldHVybiB1bndyYXAoaXRlbVtpbnB1dFZhbHVlUHJvcF0pID09PSBjdXJyZW50VmFsdWU7ICBcbiAgICAgICAgICAgIH0pO1xuICAgICAgICAgICAgXG4gICAgICAgICAgICBpZiAoIW1hdGNoaW5nSXRlbSkge1xuICAgICAgICAgICAgICAgd3JpdGVWYWx1ZVRvTW9kZWwobnVsbCk7XG4gICAgICAgICAgICB9ICAgIFxuICAgICAgICB9XG4gICAgICAgIFxuICAgICAgICBcbiAgICAgICAgLy9oYW5kbGUgdGhlIGNob2ljZXMgYmVpbmcgdXBkYXRlZCBpbiBhIERPLCB0byBkZWNvdXBsZSB2YWx1ZSB1cGRhdGVzIGZyb20gc291cmNlIChvcHRpb25zKSB1cGRhdGVzXG4gICAgICAgIHZhciBtYXBwZWRTb3VyY2UgPSBrby5kZXBlbmRlbnRPYnNlcnZhYmxlKGZ1bmN0aW9uKCkge1xuICAgICAgICAgICAgdmFyIG1hcHBlZCA9IGtvLnV0aWxzLmFycmF5TWFwKHVud3JhcChzb3VyY2UpLCBmdW5jdGlvbihpdGVtKSB7XG4gICAgICAgICAgICAgICAgdmFyIHJlc3VsdCA9IHt9O1xuICAgICAgICAgICAgICAgIHJlc3VsdC5sYWJlbCA9IGxhYmVsUHJvcCA/IHVud3JhcChpdGVtW2xhYmVsUHJvcF0pIDogdW53cmFwKGl0ZW0pLnRvU3RyaW5nKCk7ICAvL3Nob3cgaW4gcG9wLXVwIGNob2ljZXNcbiAgICAgICAgICAgICAgICByZXN1bHQudmFsdWUgPSBpbnB1dFZhbHVlUHJvcCA/IHVud3JhcChpdGVtW2lucHV0VmFsdWVQcm9wXSkgOiB1bndyYXAoaXRlbSkudG9TdHJpbmcoKTsgIC8vc2hvdyBpbiBpbnB1dCBib3hcbiAgICAgICAgICAgICAgICByZXN1bHQuYWN0dWFsVmFsdWUgPSB2YWx1ZVByb3AgPyB1bndyYXAoaXRlbVt2YWx1ZVByb3BdKSA6IGl0ZW07ICAvL3N0b3JlIGluIG1vZGVsXG4gICAgICAgICAgICAgICAgcmV0dXJuIHJlc3VsdDtcbiAgICAgICAgICAgIH0pO1xuICAgICAgICAgICAgcmV0dXJuIG1hcHBlZDsgICAgICAgICAgICAgICAgXG4gICAgICAgIH0pO1xuICAgICAgICBcbiAgICAgICAgLy93aGVuZXZlciB0aGUgaXRlbXMgdGhhdCBtYWtlIHVwIHRoZSBzb3VyY2UgYXJlIHVwZGF0ZWQsIG1ha2Ugc3VyZSB0aGF0IGF1dG9jb21wbGV0ZSBrbm93cyBpdFxuICAgICAgICBtYXBwZWRTb3VyY2Uuc3Vic2NyaWJlKGZ1bmN0aW9uKG5ld1ZhbHVlKSB7XG4gICAgICAgICAgICQoZWxlbWVudCkuYXV0b2NvbXBsZXRlKFwib3B0aW9uXCIsIFwic291cmNlXCIsIG5ld1ZhbHVlKTsgXG4gICAgICAgIH0pO1xuICAgICAgICBcbiAgICAgICAgb3B0aW9ucy5zb3VyY2UgPSBtYXBwZWRTb3VyY2UoKTtcbiAgICAgICAgXG4gICAgICAgIG9wdGlvbnMubWluTGVuZ3RoID0gMTtcbiAgICAgICAgLy9pbml0aWFsaXplIGF1dG9jb21wbGV0ZVxuICAgICAgICAkKGVsZW1lbnQpLmF1dG9jb21wbGV0ZShvcHRpb25zKTtcbiAgICB9LFxuICAgIHVwZGF0ZTogZnVuY3Rpb24oZWxlbWVudCwgdmFsdWVBY2Nlc3NvciwgYWxsQmluZGluZ3NBY2Nlc3Nvciwgdmlld01vZGVsKSB7XG4gICAgICAgLy91cGRhdGUgdmFsdWUgYmFzZWQgb24gYSBtb2RlbCBjaGFuZ2VcbiAgICAgICB2YXIgYWxsQmluZGluZ3MgPSBhbGxCaW5kaW5nc0FjY2Vzc29yKCksXG4gICAgICAgICAgIHVud3JhcCA9IGtvLnV0aWxzLnVud3JhcE9ic2VydmFibGUsXG4gICAgICAgICAgIG1vZGVsVmFsdWUgPSB1bndyYXAoYWxsQmluZGluZ3MuanFBdXRvVmFsdWUpIHx8ICcnLCBcbiAgICAgICAgICAgdmFsdWVQcm9wID0gYWxsQmluZGluZ3MuanFBdXRvU291cmNlVmFsdWUsXG4gICAgICAgICAgIGlucHV0VmFsdWVQcm9wID0gYWxsQmluZGluZ3MuanFBdXRvU291cmNlSW5wdXRWYWx1ZSB8fCB2YWx1ZVByb3A7XG4gICAgICAgIFxuICAgICAgIC8vaWYgd2UgYXJlIHdyaXRpbmcgYSBkaWZmZXJlbnQgcHJvcGVydHkgdG8gdGhlIGlucHV0IHRoYW4gd2UgYXJlIHdyaXRpbmcgdG8gdGhlIG1vZGVsLCB0aGVuIGxvY2F0ZSB0aGUgb2JqZWN0XG4gICAgICAgaWYgKHZhbHVlUHJvcCAmJiBpbnB1dFZhbHVlUHJvcCAhPT0gdmFsdWVQcm9wKSB7XG4gICAgICAgICAgIHZhciBzb3VyY2UgPSB1bndyYXAoYWxsQmluZGluZ3MuanFBdXRvU291cmNlKSB8fCBbXTtcbiAgICAgICAgICAgdmFyIG1vZGVsVmFsdWUgPSBrby51dGlscy5hcnJheUZpcnN0KHNvdXJjZSwgZnVuY3Rpb24oaXRlbSkge1xuICAgICAgICAgICAgICAgICByZXR1cm4gdW53cmFwKGl0ZW1bdmFsdWVQcm9wXSkgPT09IG1vZGVsVmFsdWU7XG4gICAgICAgICAgIH0pIHx8IHt9OyAgLy9wcm9iYWJseSBkb24ndCBuZWVkIHRoZSB8fCB7fSwgYnV0IGp1c3QgcHJvdGVjdCBhZ2FpbnN0IGEgYmFkIHZhbHVlICAgICAgICAgIFxuICAgICAgIH0gXG5cbiAgICAgICAvL3VwZGF0ZSB0aGUgZWxlbWVudCB3aXRoIHRoZSB2YWx1ZSB0aGF0IHNob3VsZCBiZSBzaG93biBpbiB0aGUgaW5wdXRcbiAgICAgICAkKGVsZW1lbnQpLnZhbChtb2RlbFZhbHVlICYmIGlucHV0VmFsdWVQcm9wICE9PSB2YWx1ZVByb3AgPyB1bndyYXAobW9kZWxWYWx1ZVtpbnB1dFZhbHVlUHJvcF0pIDogbW9kZWxWYWx1ZS50b1N0cmluZygpKTsgICAgXG4gICAgfVxufTtcblxua28uYmluZGluZ0hhbmRsZXJzLmpxQXV0b0NvbWJvID0ge1xuICAgIGluaXQ6IGZ1bmN0aW9uKGVsZW1lbnQsIHZhbHVlQWNjZXNzb3IpIHtcbiAgICAgICB2YXIgYXV0b0VsID0gJChcIiNcIiArIHZhbHVlQWNjZXNzb3IoKSk7XG4gICAgICAgXG4gICAgICAgICQoZWxlbWVudCkuY2xpY2soZnVuY3Rpb24oKSB7XG4gICAgICAgICAgIC8vIGNsb3NlIGlmIGFscmVhZHkgdmlzaWJsZVxuICAgICAgICAgICAgaWYgKGF1dG9FbC5hdXRvY29tcGxldGUoXCJ3aWRnZXRcIikuaXMoXCI6dmlzaWJsZVwiKSkge1xuICAgICAgICAgICAgICAgIGF1dG9FbC5hdXRvY29tcGxldGUoIFwiY2xvc2VcIiApO1xuICAgICAgICAgICAgICAgIHJldHVybjtcbiAgICAgICAgICAgIH1cblxuICAgICAgICAgICAvL2F1dG9FbC5ibHVyKCk7XG4gICAgICAgICAgICBhdXRvRWwuYXV0b2NvbXBsZXRlKFwic2VhcmNoXCIsIFwiIFwiKTtcbiAgICAgICAgICAgIGF1dG9FbC5mb2N1cygpOyBcbiAgICAgICAgICAgIFxuICAgICAgICB9KTtcbiAgICAgICAgXG4gICAgfSAgXG59XG5cbm1vZHVsZS5leHBvcnRzID0ga287IiwiJ3VzZSBzdHJpY3QnO1xudmFyICQgPSAodHlwZW9mIHdpbmRvdyAhPT0gXCJ1bmRlZmluZWRcIiA/IHdpbmRvd1snJCddIDogdHlwZW9mIGdsb2JhbCAhPT0gXCJ1bmRlZmluZWRcIiA/IGdsb2JhbFsnJCddIDogbnVsbCk7XG5cbnJlcXVpcmUoJy4va28uZXh0ZW5kZXJzLmFzeW5jJyk7XG5cbnZhciBhYmlsaXR5X3ZhcnMgPSB7XG4gICAgJyRoZWFsdGgnOiAnSGVhbHRoJyxcbiAgICAnJG1hbmEnOiAnTWFuYScsXG4gICAgJyRhcm1vcic6ICdBcm1vcicsXG4gICAgJyRkYW1hZ2UnOiAnRGFtYWdlJyxcbiAgICAnJHN0cic6ICdTdHJlbmd0aCcsXG4gICAgJyRpbnQnOiAnSW50ZWxsaWdlbmNlJyxcbiAgICAnJGFnaSc6ICdBZ2lsaXR5JyxcbiAgICAnJGFsbCc6ICdBbGwgQXR0cmlidXRlcycsXG4gICAgJyRhdHRhY2snOiAnQXR0YWNrIFNwZWVkJyxcbiAgICAnJGhwX3JlZ2VuJzogJ0hQIFJlZ2VuZXJhdGlvbicsXG4gICAgJyRtYW5hX3JlZ2VuJzogJ01hbmEgUmVnZW5lcmF0aW9uJyxcbiAgICAnJG1vdmVfc3BlZWQnOiAnTW92ZW1lbnQgU3BlZWQnLFxuICAgICckZXZhc2lvbic6ICdFdmFzaW9uJyxcbiAgICAnJHNwZWxsX3Jlc2lzdCc6ICdTcGVsbCBSZXNpc3RhbmNlJyxcbiAgICAnJHNlbGVjdGVkX2F0dHJpYnV0ZSc6ICdTZWxlY3RlZCBBdHRyaWJ1dGUnLFxuICAgICckc2VsZWN0ZWRfYXR0cmliJzogJ1NlbGVjdGVkIEF0dHJpYnV0ZScsXG4gICAgJyRjYXN0X3JhbmdlJzogJ0Nhc3QgUmFuZ2UnLFxuICAgICckYXR0YWNrX3JhbmdlJzogJ0F0dGFjayBSYW5nZSdcbn1cbnZhciBhYmlsaXR5VG9vbHRpcERhdGEgPSB7fTtcbnZhciBhYmlsaXR5RGFtYWdlVHlwZXMgPSB7XG4gICAgJ0RBTUFHRV9UWVBFX01BR0lDQUwnOiAnTWFnaWNhbCcsXG4gICAgJ0RBTUFHRV9UWVBFX1BVUkUnOiAnUHVyZScsXG4gICAgJ0RBTUFHRV9UWVBFX1BIWVNJQ0FMJzogJ1BoeXNpY2FsJyxcbiAgICAnREFNQUdFX1RZUEVfQ09NUE9TSVRFJzogJ0NvbXBvc2l0ZScsXG4gICAgJ0RBTUFHRV9UWVBFX0hQX1JFTU9WQUwnOiAnSFAgUmVtb3ZhbCdcbn1cbnZhciB0b29sdGlwSlNPTiA9IGtvLm9ic2VydmFibGUoKTtcblxudmFyIGdldFRvb2x0aXBBYmlsaXR5RGVzY3JpcHRpb24gPSBmdW5jdGlvbiAoaXRlbSkge1xuICAgIHZhciBkID0gdG9vbHRpcEpTT04oKSA/IHRvb2x0aXBKU09OKClbaXRlbS5uYW1lXS5kZXNjcmlwdGlvbiA6ICcnO1xuICAgIGZvciAodmFyIGkgPSAwOyBpIDwgaXRlbS5hdHRyaWJ1dGVzLmxlbmd0aDsgaSsrKSB7XG4gICAgICAgIGlmIChpdGVtLmF0dHJpYnV0ZXNbaV0ubmFtZSAhPSBudWxsKSB7XG4gICAgICAgICAgICB2YXIgYXR0cmlidXRlTmFtZSA9IGl0ZW0uYXR0cmlidXRlc1tpXS5uYW1lO1xuICAgICAgICAgICAgdmFyIGF0dHJpYnV0ZVZhbHVlID0gaXRlbS5hdHRyaWJ1dGVzW2ldLnZhbHVlWzBdO1xuICAgICAgICAgICAgZm9yICh2YXIgaiA9IDE7IGogPCBpdGVtLmF0dHJpYnV0ZXNbaV0udmFsdWUubGVuZ3RoOyBqKyspIHtcbiAgICAgICAgICAgICAgICBhdHRyaWJ1dGVWYWx1ZSArPSAnIC8gJyArIGl0ZW0uYXR0cmlidXRlc1tpXS52YWx1ZVtqXTtcbiAgICAgICAgICAgIH1cbiAgICAgICAgICAgIHJlZ2V4cCA9IG5ldyBSZWdFeHAoJyUnICsgYXR0cmlidXRlTmFtZSArICclJywgJ2dpJyk7XG4gICAgICAgICAgICBkID0gZC5yZXBsYWNlKHJlZ2V4cCwgYXR0cmlidXRlVmFsdWUpO1xuICAgICAgICB9XG4gICAgfVxuICAgIHZhciByZWdleHAgPSBuZXcgUmVnRXhwKCclJScsICdnaScpO1xuICAgIGQgPSBkLnJlcGxhY2UocmVnZXhwLCAnJScpO1xuICAgIHJlZ2V4cCA9IG5ldyBSZWdFeHAoJ1xcbicsICdnaScpO1xuICAgIGQgPSBkLnJlcGxhY2UoL1xcXFxuL2csICc8YnI+Jyk7XG4gICAgcmV0dXJuIGQ7XG59XG5cbnZhciBnZXRUb29sdGlwQWJpbGl0eUF0dHJpYnV0ZXMgPSBmdW5jdGlvbiAoaXRlbSkge1xuICAgIHZhciBhID0gJyc7XG4gICAgaWYgKGl0ZW0uZGFtYWdlLmxlbmd0aCA+IDAgJiYgaXRlbS5kYW1hZ2UucmVkdWNlKGZ1bmN0aW9uKG1lbW8sIG51bSl7IHJldHVybiBtZW1vICsgbnVtOyB9LCAwKSA+IDApIHtcbiAgICAgICAgdmFyIGF0dHJpYnV0ZVRvb2x0aXAgPSAnREFNQUdFOiAnO1xuICAgICAgICB2YXIgYXR0cmlidXRlVmFsdWUgPSBpdGVtLmRhbWFnZVswXTtcbiAgICAgICAgZm9yICh2YXIgaiA9IDE7IGogPCBpdGVtLmRhbWFnZS5sZW5ndGg7IGorKykge1xuICAgICAgICAgICAgYXR0cmlidXRlVmFsdWUgKz0gJyAvICcgKyBpdGVtLmRhbWFnZVtqXTtcbiAgICAgICAgfVxuICAgICAgICBhID0gYSArIGF0dHJpYnV0ZVRvb2x0aXAgKyAnICcgKyBhdHRyaWJ1dGVWYWx1ZSArICc8YnI+JztcbiAgICB9XG4gICAgZm9yICh2YXIgaSA9IDA7IGkgPCBpdGVtLmF0dHJpYnV0ZXMubGVuZ3RoOyBpKyspIHtcbiAgICAgICAgaWYgKGl0ZW0uYXR0cmlidXRlc1tpXS50b29sdGlwICE9IG51bGwpIHtcbiAgICAgICAgICAgIHZhciBhdHRyaWJ1dGVUb29sdGlwID0gaXRlbS5hdHRyaWJ1dGVzW2ldLnRvb2x0aXA7XG4gICAgICAgICAgICBhdHRyaWJ1dGVUb29sdGlwID0gYXR0cmlidXRlVG9vbHRpcC5yZXBsYWNlKC9cXFxcbi9nLCAnJyk7XG4gICAgICAgICAgICB2YXIgYXR0cmlidXRlVmFsdWUgPSBpdGVtLmF0dHJpYnV0ZXNbaV0udmFsdWVbMF07XG4gICAgICAgICAgICBmb3IgKHZhciBqID0gMTsgaiA8IGl0ZW0uYXR0cmlidXRlc1tpXS52YWx1ZS5sZW5ndGg7IGorKykge1xuICAgICAgICAgICAgICAgIGF0dHJpYnV0ZVZhbHVlICs9ICcgLyAnICsgaXRlbS5hdHRyaWJ1dGVzW2ldLnZhbHVlW2pdO1xuICAgICAgICAgICAgfVxuICAgICAgICAgICAgdmFyIHAgPSBhdHRyaWJ1dGVUb29sdGlwLmluZGV4T2YoJyUnKTtcbiAgICAgICAgICAgIGlmIChwID09IDApIHtcbiAgICAgICAgICAgICAgICBpZiAoYXR0cmlidXRlVmFsdWUudG9TdHJpbmcoKS5pbmRleE9mKCcvJykgPT0gLTEpIHtcbiAgICAgICAgICAgICAgICAgICAgYXR0cmlidXRlVmFsdWUgPSBhdHRyaWJ1dGVWYWx1ZS50b1N0cmluZygpLnRyaW0oKSArICclJztcbiAgICAgICAgICAgICAgICB9IGVsc2Uge1xuICAgICAgICAgICAgICAgICAgICAvL3ZhciByZWdleHAyID0gbmV3IFJlZ0V4cCgnLycsICdnaScpO1xuICAgICAgICAgICAgICAgICAgICAvL2F0dHJpYnV0ZVZhbHVlID0gYXR0cmlidXRlVmFsdWUucmVwbGFjZShyZWdleHAyLCAnJS8nKSArICclJztcbiAgICAgICAgICAgICAgICAgICAgdmFyIGF0dHJpYnV0ZVZhbHVlcyA9IGF0dHJpYnV0ZVZhbHVlLnNwbGl0KCcvJyk7XG4gICAgICAgICAgICAgICAgICAgIHZhciB0cmltbWVkQXR0cmlidXRlVmFsdWVzID0gYXR0cmlidXRlVmFsdWVzLm1hcChmdW5jdGlvbih2KSB7XG4gICAgICAgICAgICAgICAgICAgICAgICByZXR1cm4gdi50cmltKCk7XG4gICAgICAgICAgICAgICAgICAgIH0pO1xuICAgICAgICAgICAgICAgICAgICBhdHRyaWJ1dGVWYWx1ZSA9IHRyaW1tZWRBdHRyaWJ1dGVWYWx1ZXMuam9pbignJSAvICcpICsgJyUnO1xuICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgICBhdHRyaWJ1dGVUb29sdGlwID0gYXR0cmlidXRlVG9vbHRpcC5zbGljZSgxKTtcbiAgICAgICAgICAgIH1cbiAgICAgICAgICAgIHZhciBkID0gYXR0cmlidXRlVG9vbHRpcC5pbmRleE9mKCckJyk7XG4gICAgICAgICAgICBhID0gYSArIGF0dHJpYnV0ZVRvb2x0aXAgKyAnICcgKyBhdHRyaWJ1dGVWYWx1ZSArICc8YnI+JztcbiAgICAgICAgfVxuICAgIH1cbiAgICByZXR1cm4gYS50cmltKCc8YnI+Jyk7XG59XG5cbnZhciBnZXRUb29sdGlwQWJpbGl0eU1hbmFDb3N0ID0gZnVuY3Rpb24gKGl0ZW0pIHtcbiAgICB2YXIgYyA9ICcnO1xuICAgIGlmIChpdGVtLm1hbmFjb3N0LnJlZHVjZShmdW5jdGlvbihtZW1vLCBudW0peyByZXR1cm4gbWVtbyArIG51bTsgfSwgMCkgPT0gMCkge1xuICAgICAgICByZXR1cm4gYztcbiAgICB9XG4gICAgaWYgKGl0ZW0ubWFuYWNvc3QuZXZlcnkoZnVuY3Rpb24obnVtKSB7IHJldHVybiBudW0gPT0gaXRlbS5tYW5hY29zdFswXTsgfSkpIHtcbiAgICAgICAgcmV0dXJuIGl0ZW0ubWFuYWNvc3RbMF0udG9TdHJpbmcoKTtcbiAgICB9XG4gICAgZm9yICh2YXIgaSA9IDA7IGkgPCA0OyBpKyspIHtcbiAgICAgICAgaWYgKGl0ZW0ubWFuYWNvc3RbaV0gIT0gbnVsbCkge1xuICAgICAgICAgICAgYyA9IGMgKyAnICcgKyBpdGVtLm1hbmFjb3N0W2ldO1xuICAgICAgICB9XG4gICAgfVxuICAgIHJldHVybiBjO1xufVxuXG52YXIgZ2V0VG9vbHRpcEFiaWxpdHlDb29sZG93biA9IGZ1bmN0aW9uIChpdGVtKSB7XG4gICAgdmFyIGMgPSAnJztcbiAgICBpZiAoaXRlbS5jb29sZG93bi5yZWR1Y2UoZnVuY3Rpb24obWVtbywgbnVtKXsgcmV0dXJuIG1lbW8gKyBudW07IH0sIDApID09IDApIHtcbiAgICAgICAgcmV0dXJuIGM7XG4gICAgfVxuICAgIGlmIChpdGVtLmNvb2xkb3duLmV2ZXJ5KGZ1bmN0aW9uKG51bSkgeyByZXR1cm4gbnVtID09IGl0ZW0uY29vbGRvd25bMF07IH0pKSB7XG4gICAgICAgIHJldHVybiBpdGVtLmNvb2xkb3duWzBdLnRvU3RyaW5nKCk7XG4gICAgfVxuICAgIGZvciAodmFyIGkgPSAwOyBpIDwgNDsgaSsrKSB7XG4gICAgICAgIGlmIChpdGVtLmNvb2xkb3duW2ldICE9IG51bGwpIHtcbiAgICAgICAgICAgIGMgPSBjICsgJyAnICsgaXRlbS5jb29sZG93bltpXTtcbiAgICAgICAgfVxuICAgIH1cbiAgICByZXR1cm4gYztcbn1cbiAgICBcbnZhciBnZXRBYmlsaXR5VG9vbHRpcERhdGEgPSBmdW5jdGlvbihoZXJvRGF0YSwgdW5pdERhdGEsIGhlcm8sIGVsKSB7XG4gICAgaWYgKGFiaWxpdHlUb29sdGlwRGF0YVtlbF0gPT0gdW5kZWZpbmVkKSB7XG4gICAgICAgIHZhciBhYmlsaXR5TmFtZSA9IGVsXG4gICAgICAgIHZhciBhYmlsaXR5ID0ge307XG4gICAgICAgIGlmIChoZXJvRGF0YVsnbnBjX2RvdGFfaGVyb18nICsgaGVyb10gPT0gdW5kZWZpbmVkICYmIGhlcm9EYXRhW2hlcm9dID09IHVuZGVmaW5lZCkge1xuICAgICAgICAgICAgZm9yICh2YXIgaSA9IDA7IGkgPCB1bml0RGF0YVtoZXJvXS5hYmlsaXRpZXMubGVuZ3RoOyBpKyspIHtcbiAgICAgICAgICAgICAgICBpZiAodW5pdERhdGFbaGVyb10uYWJpbGl0aWVzW2ldLm5hbWUgPT0gZWwpIHtcbiAgICAgICAgICAgICAgICAgICAgYWJpbGl0eSA9IHVuaXREYXRhW2hlcm9dLmFiaWxpdGllc1tpXTtcbiAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICB9ICAgICAgICAgICAgXG4gICAgICAgIH1cbiAgICAgICAgZWxzZSB7XG4gICAgICAgICAgICBpZiAoaGVyby5pbmRleE9mKCducGNfZG90YV9oZXJvXycpID09IC0xKSBoZXJvID0gJ25wY19kb3RhX2hlcm9fJyArIGhlcm87XG4gICAgICAgICAgICBmb3IgKHZhciBpID0gMDsgaSA8IGhlcm9EYXRhW2hlcm9dLmFiaWxpdGllcy5sZW5ndGg7IGkrKykge1xuICAgICAgICAgICAgICAgIGlmIChoZXJvRGF0YVtoZXJvXS5hYmlsaXRpZXNbaV0ubmFtZSA9PSBlbCkge1xuICAgICAgICAgICAgICAgICAgICBhYmlsaXR5ID0gaGVyb0RhdGFbaGVyb10uYWJpbGl0aWVzW2ldO1xuICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgIH1cbiAgICAgICAgfVxuICAgICAgICB2YXIgZGF0YSA9ICQoJzxkaXY+JylcbiAgICAgICAgZGF0YS5hcHBlbmQoJCgnPHNwYW4+JykuaHRtbChhYmlsaXR5LmRpc3BsYXluYW1lKS5hZGRDbGFzcygnaXRlbV9maWVsZCBwdWxsLWxlZnQgaXRlbV9uYW1lJykpO1xuICAgICAgICBpZiAoYWJpbGl0eS5hYmlsaXR5dW5pdGRhbWFnZXR5cGUpIHtcbiAgICAgICAgICAgIGRhdGEuYXBwZW5kKCQoJzxzcGFuPicpLmh0bWwoYWJpbGl0eURhbWFnZVR5cGVzW2FiaWxpdHkuYWJpbGl0eXVuaXRkYW1hZ2V0eXBlXSkuYWRkQ2xhc3MoJ2l0ZW1fZmllbGQgcHVsbC1yaWdodCBpdGVtX2FiaWxpdHlfZGFtYWdlX3R5cGUnKS5jc3MoJ21hcmdpbi1yaWdodCcsJzEwcHgnKSk7XG4gICAgICAgIH1cbiAgICAgICAgZGF0YS5hcHBlbmQoJCgnPGhyPicpLmNzcygnY2xlYXInLCAnYm90aCcpKTtcbiAgICAgICAgaWYgKHRvb2x0aXBKU09OKCkgJiYgdG9vbHRpcEpTT04oKVthYmlsaXR5Lm5hbWVdICYmIHRvb2x0aXBKU09OKClbYWJpbGl0eS5uYW1lXS5kZXNjcmlwdGlvbikge1xuICAgICAgICAgICAgZGF0YS5hcHBlbmQoJCgnPGRpdj4nKS5odG1sKGdldFRvb2x0aXBBYmlsaXR5RGVzY3JpcHRpb24oYWJpbGl0eSkpLmFkZENsYXNzKCdpdGVtX2ZpZWxkIGl0ZW1fZGVzY3JpcHRpb24nKSk7XG4gICAgICAgIH1cbiAgICAgICAgdmFyIGF0dHJpYnV0ZWRhdGEgPSBnZXRUb29sdGlwQWJpbGl0eUF0dHJpYnV0ZXMoYWJpbGl0eSk7XG4gICAgICAgIGlmIChhdHRyaWJ1dGVkYXRhICE9ICcnKSB7XG4gICAgICAgICAgICBkYXRhLmFwcGVuZCgkKCc8ZGl2PicpLmh0bWwoYXR0cmlidXRlZGF0YSkuYWRkQ2xhc3MoJ2l0ZW1fZmllbGQgaXRlbV9hdHRyaWJ1dGVzJykpO1xuICAgICAgICB9XG4gICAgICAgIHZhciBjZCA9IGdldFRvb2x0aXBBYmlsaXR5Q29vbGRvd24oYWJpbGl0eSk7XG4gICAgICAgIHZhciBtYW5hID0gZ2V0VG9vbHRpcEFiaWxpdHlNYW5hQ29zdChhYmlsaXR5KTtcbiAgICAgICAgaWYgKGNkICE9ICcnIHx8IG1hbmEgIT0gJycpIHtcbiAgICAgICAgICAgIHZhciBjZG1hbmFjb3N0ID0gJCgnPGRpdj4nKS5hZGRDbGFzcygnaXRlbV9jZG1hbmEnKTtcbiAgICAgICAgICAgIGlmIChtYW5hICE9ICcnKSB7XG4gICAgICAgICAgICAgICAgY2RtYW5hY29zdC5hcHBlbmQoJCgnPHNwYW4+JykuaHRtbChtYW5hLnRyaW0oKSkuYWRkQ2xhc3MoJ2l0ZW1fZmllbGQgaXRlbV9tYW5hY29zdCcpKTtcbiAgICAgICAgICAgIH1cbiAgICAgICAgICAgIGlmIChjZCAhPSAnJykge1xuICAgICAgICAgICAgICAgIGNkbWFuYWNvc3QuYXBwZW5kKCQoJzxzcGFuPicpLmh0bWwoY2QudHJpbSgpKS5hZGRDbGFzcygnaXRlbV9maWVsZCBpdGVtX2Nvb2xkb3duJykpO1xuICAgICAgICAgICAgfVxuICAgICAgICAgICAgZGF0YS5hcHBlbmQoY2RtYW5hY29zdCk7XG4gICAgICAgIH1cbiAgICAgICAgaWYgKHRvb2x0aXBKU09OKCkgJiYgdG9vbHRpcEpTT04oKVthYmlsaXR5Lm5hbWVdICYmIHRvb2x0aXBKU09OKClbYWJpbGl0eS5uYW1lXS5kZXNjcmlwdGlvbikge1xuICAgICAgICAgICAgZGF0YS5hcHBlbmQoJCgnPGRpdj4nKS5odG1sKHRvb2x0aXBKU09OKClbYWJpbGl0eS5uYW1lXS5sb3JlKS5hZGRDbGFzcygnaXRlbV9maWVsZCBpdGVtX2xvcmUnKSk7XG4gICAgICAgIH1cbiAgICAgICAgaWYgKCF0b29sdGlwSlNPTigpKSB7XG4gICAgICAgICAgICByZXR1cm4ga28uY29tcHV0ZWQoZnVuY3Rpb24gKCkge1xuICAgICAgICAgICAgICAgIGlmICghdG9vbHRpcEpTT04oKSkge1xuICAgICAgICAgICAgICAgICAgICByZXR1cm4gZGF0YS5odG1sKCk7XG4gICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICAgIGVsc2Uge1xuICAgICAgICAgICAgICAgICAgICByZXR1cm4gZ2V0QWJpbGl0eVRvb2x0aXBEYXRhKGhlcm9EYXRhLCB1bml0RGF0YSwgaGVybywgZWwpO1xuICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgIH0pO1xuICAgICAgICB9XG4gICAgICAgIGVsc2Uge1xuICAgICAgICAgICAgYWJpbGl0eVRvb2x0aXBEYXRhW2VsXSA9IGRhdGEuaHRtbCgpO1xuICAgICAgICAgICAgcmV0dXJuIGRhdGEuaHRtbCgpO1xuICAgICAgICB9XG4gICAgfVxuICAgIGVsc2Uge1xuICAgICAgICByZXR1cm4gYWJpbGl0eVRvb2x0aXBEYXRhW2VsXTtcbiAgICB9XG59XG5cbmdldEFiaWxpdHlUb29sdGlwRGF0YS50b29sdGlwSlNPTiA9IHRvb2x0aXBKU09OO1xuXG52YXIgaW5pdCA9IGZ1bmN0aW9uICh1cmwpIHtcbiAgICAkLmdldEpTT04odXJsLCBmdW5jdGlvbiAoZGF0YSkge1xuICAgICAgICB0b29sdGlwSlNPTihkYXRhKTtcbiAgICB9KTtcbn1cbmdldEFiaWxpdHlUb29sdGlwRGF0YS5pbml0ID0gaW5pdDtcblxubW9kdWxlLmV4cG9ydHMgPSBnZXRBYmlsaXR5VG9vbHRpcERhdGE7IiwiJ3VzZSBzdHJpY3QnO1xudmFyICQgPSAodHlwZW9mIHdpbmRvdyAhPT0gXCJ1bmRlZmluZWRcIiA/IHdpbmRvd1snJCddIDogdHlwZW9mIGdsb2JhbCAhPT0gXCJ1bmRlZmluZWRcIiA/IGdsb2JhbFsnJCddIDogbnVsbCk7XG5cbnZhciBpdGVtdG9vbHRpcGRhdGEgPSB7fTtcbnZhciBhYmlsaXR5X3ZhcnMgPSB7XG4gICAgJyRoZWFsdGgnOiAnSGVhbHRoJyxcbiAgICAnJG1hbmEnOiAnTWFuYScsXG4gICAgJyRhcm1vcic6ICdBcm1vcicsXG4gICAgJyRkYW1hZ2UnOiAnRGFtYWdlJyxcbiAgICAnJHN0cic6ICdTdHJlbmd0aCcsXG4gICAgJyRpbnQnOiAnSW50ZWxsaWdlbmNlJyxcbiAgICAnJGFnaSc6ICdBZ2lsaXR5JyxcbiAgICAnJGFsbCc6ICdBbGwgQXR0cmlidXRlcycsXG4gICAgJyRhdHRhY2snOiAnQXR0YWNrIFNwZWVkJyxcbiAgICAnJGhwX3JlZ2VuJzogJ0hQIFJlZ2VuZXJhdGlvbicsXG4gICAgJyRtYW5hX3JlZ2VuJzogJ01hbmEgUmVnZW5lcmF0aW9uJyxcbiAgICAnJG1vdmVfc3BlZWQnOiAnTW92ZW1lbnQgU3BlZWQnLFxuICAgICckZXZhc2lvbic6ICdFdmFzaW9uJyxcbiAgICAnJHNwZWxsX3Jlc2lzdCc6ICdTcGVsbCBSZXNpc3RhbmNlJyxcbiAgICAnJHNlbGVjdGVkX2F0dHJpYnV0ZSc6ICdTZWxlY3RlZCBBdHRyaWJ1dGUnLFxuICAgICckc2VsZWN0ZWRfYXR0cmliJzogJ1NlbGVjdGVkIEF0dHJpYnV0ZScsXG4gICAgJyRjYXN0X3JhbmdlJzogJ0Nhc3QgUmFuZ2UnLFxuICAgICckYXR0YWNrX3JhbmdlJzogJ0F0dGFjayBSYW5nZSdcbn1cblxudmFyIGdldFRvb2x0aXBJdGVtRGVzY3JpcHRpb24gPSBmdW5jdGlvbiAoaXRlbSkge1xuICAgIHZhciBkID0gaXRlbS5kZXNjcmlwdGlvbjtcbiAgICBmb3IgKHZhciBpID0gMDsgaSA8IGl0ZW0uYXR0cmlidXRlcy5sZW5ndGg7IGkrKykge1xuICAgICAgICBpZiAoaXRlbS5hdHRyaWJ1dGVzW2ldLm5hbWUgIT0gbnVsbCkge1xuICAgICAgICAgICAgdmFyIGF0dHJpYnV0ZU5hbWUgPSBpdGVtLmF0dHJpYnV0ZXNbaV0ubmFtZTtcbiAgICAgICAgICAgIHZhciBhdHRyaWJ1dGVWYWx1ZSA9IGl0ZW0uYXR0cmlidXRlc1tpXS52YWx1ZVswXTtcbiAgICAgICAgICAgIGZvciAodmFyIGogPSAxOyBqIDwgaXRlbS5hdHRyaWJ1dGVzW2ldLnZhbHVlLmxlbmd0aDsgaisrKSB7XG4gICAgICAgICAgICAgICAgYXR0cmlidXRlVmFsdWUgKz0gJyAvICcgKyBpdGVtLmF0dHJpYnV0ZXNbaV0udmFsdWVbal07XG4gICAgICAgICAgICB9XG4gICAgICAgICAgICB2YXIgcmVnZXhwID0gbmV3IFJlZ0V4cCgnJScgKyBhdHRyaWJ1dGVOYW1lICsgJyUnLCAnZ2knKTtcbiAgICAgICAgICAgIGQgPSBkLnJlcGxhY2UocmVnZXhwLCBhdHRyaWJ1dGVWYWx1ZSApO1xuICAgICAgICB9XG4gICAgfVxuICAgIHZhciByZWdleHAgPSBuZXcgUmVnRXhwKCclJScsICdnaScpO1xuICAgIGQgPSBkLnJlcGxhY2UocmVnZXhwLCclJyk7XG4gICAgcmVnZXhwID0gbmV3IFJlZ0V4cCgnXFxuJywgJ2dpJyk7XG4gICAgZCA9IGQucmVwbGFjZSgvXFxcXG4vZywgJzxicj4nKTtcbiAgICByZXR1cm4gZDtcbn1cblxudmFyIGdldFRvb2x0aXBJdGVtQXR0cmlidXRlcyA9IGZ1bmN0aW9uIChpdGVtKSB7XG4gICAgdmFyIGEgPSAnJztcbiAgICBmb3IgKHZhciBpID0gMDsgaSA8IGl0ZW0uYXR0cmlidXRlcy5sZW5ndGg7IGkrKykge1xuICAgICAgICBpZiAoaXRlbS5hdHRyaWJ1dGVzW2ldLnRvb2x0aXAgIT0gbnVsbCkge1xuICAgICAgICAgICAgdmFyIGF0dHJpYnV0ZVRvb2x0aXAgPSBpdGVtLmF0dHJpYnV0ZXNbaV0udG9vbHRpcDtcbiAgICAgICAgICAgIHZhciBhdHRyaWJ1dGVWYWx1ZSA9IGl0ZW0uYXR0cmlidXRlc1tpXS52YWx1ZVswXTtcbiAgICAgICAgICAgIGZvciAodmFyIGogPSAxOyBqIDwgaXRlbS5hdHRyaWJ1dGVzW2ldLnZhbHVlLmxlbmd0aDsgaisrKSB7XG4gICAgICAgICAgICAgICAgYXR0cmlidXRlVmFsdWUgKz0gJyAvICcgKyBpdGVtLmF0dHJpYnV0ZXNbaV0udmFsdWVbal07XG4gICAgICAgICAgICB9XG4gICAgICAgICAgICB2YXIgcCA9IGF0dHJpYnV0ZVRvb2x0aXAuaW5kZXhPZignJScpO1xuICAgICAgICAgICAgaWYgKHAgPT0gMCkge1xuICAgICAgICAgICAgICAgIGF0dHJpYnV0ZVZhbHVlID0gYXR0cmlidXRlVmFsdWUgKyAnJSc7XG4gICAgICAgICAgICAgICAgYXR0cmlidXRlVG9vbHRpcCA9IGF0dHJpYnV0ZVRvb2x0aXAuc2xpY2UoMSk7XG4gICAgICAgICAgICB9XG4gICAgICAgICAgICB2YXIgZCA9IGF0dHJpYnV0ZVRvb2x0aXAuaW5kZXhPZignJCcpO1xuICAgICAgICAgICAgaWYgKGQgIT0gLTEpIHtcbiAgICAgICAgICAgICAgICBhID0gYSArIGF0dHJpYnV0ZVRvb2x0aXAuc2xpY2UoMCwgZCkgKyAnICcgKyBhdHRyaWJ1dGVWYWx1ZSArICcgJyArIGFiaWxpdHlfdmFyc1thdHRyaWJ1dGVUb29sdGlwLnNsaWNlKGQpXSArICc8YnI+JztcbiAgICAgICAgICAgIH1cbiAgICAgICAgICAgIGVsc2Uge1xuICAgICAgICAgICAgICAgIGEgPSBhICsgYXR0cmlidXRlVG9vbHRpcCArICcgJyArIGF0dHJpYnV0ZVZhbHVlICsgJzxicj4nO1xuICAgICAgICAgICAgfVxuICAgICAgICB9XG4gICAgfVxuICAgIHJldHVybiBhLnRyaW0oJzxicj4nKTtcbn1cblxudmFyIGdldFRvb2x0aXBJdGVtQ29vbGRvd24gPSBmdW5jdGlvbiAoaXRlbSkge1xuICAgIHZhciBjID0gJyc7XG4gICAgZm9yICh2YXIgaSA9IDA7IGkgPCBpdGVtLmNvb2xkb3duLmxlbmd0aDsgaSsrKSB7XG4gICAgICAgIGMgPSBjICsgJyAnICsgaXRlbS5jb29sZG93bltpXTtcbiAgICB9XG4gICAgcmV0dXJuIGM7XG59XG5cbnZhciBnZXRUb29sdGlwSXRlbU1hbmFDb3N0ID0gZnVuY3Rpb24gKGl0ZW0pIHtcbiAgICB2YXIgYyA9ICcnO1xuICAgIGZvciAodmFyIGkgPSAwOyBpIDwgaXRlbS5tYW5hY29zdC5sZW5ndGg7IGkrKykge1xuICAgICAgICBpZiAoaXRlbS5tYW5hY29zdFtpXSA+IDApIHtcbiAgICAgICAgICAgIGMgPSBjICsgJyAnICsgaXRlbS5tYW5hY29zdFtpXTtcbiAgICAgICAgfVxuICAgIH1cbiAgICByZXR1cm4gYztcbn1cblxudmFyIGdldEl0ZW1Ub29sdGlwRGF0YSA9IGZ1bmN0aW9uKGl0ZW1EYXRhLCBlbCkge1xuICAgIGlmIChpdGVtRGF0YVsnaXRlbV8nICsgZWxdID09IHVuZGVmaW5lZCkge1xuICAgICAgICByZXR1cm4gdW5kZWZpbmVkO1xuICAgIH1cbiAgICBpZiAoaXRlbXRvb2x0aXBkYXRhW2VsXSA9PSB1bmRlZmluZWQpIHtcbiAgICAgICAgdmFyIGl0ZW0gPSBpdGVtRGF0YVsnaXRlbV8nICsgZWxdO1xuICAgICAgICB2YXIgZGF0YSA9ICQoJzxkaXY+Jyk7XG4gICAgICAgIGRhdGEuYXBwZW5kKCQoJzxzcGFuPicpLmh0bWwoaXRlbS5kaXNwbGF5bmFtZSkuYWRkQ2xhc3MoJ2l0ZW1fZmllbGQgaXRlbV9uYW1lJykpO1xuICAgICAgICBkYXRhLmFwcGVuZCgkKCc8c3Bhbj4nKS5odG1sKGl0ZW0uaXRlbWNvc3QpLmFkZENsYXNzKCdpdGVtX2ZpZWxkIGl0ZW1fY29zdCcpKTtcbiAgICAgICAgZGF0YS5hcHBlbmQoJCgnPGhyPicpKTtcbiAgICAgICAgaWYgKGl0ZW0uZGVzY3JpcHRpb24gIT0gbnVsbCkge1xuICAgICAgICAgICAgZGF0YS5hcHBlbmQoJCgnPGRpdj4nKS5odG1sKGdldFRvb2x0aXBJdGVtRGVzY3JpcHRpb24oaXRlbSkpLmFkZENsYXNzKCdpdGVtX2ZpZWxkIGl0ZW1fZGVzY3JpcHRpb24nKSk7XG4gICAgICAgIH1cbiAgICAgICAgdmFyIGF0dHJpYnV0ZWRhdGEgPSBnZXRUb29sdGlwSXRlbUF0dHJpYnV0ZXMoaXRlbSk7XG4gICAgICAgIGlmIChhdHRyaWJ1dGVkYXRhICE9ICcnKSB7XG4gICAgICAgICAgICBkYXRhLmFwcGVuZCgkKCc8ZGl2PicpLmh0bWwoYXR0cmlidXRlZGF0YSkuYWRkQ2xhc3MoJ2l0ZW1fZmllbGQgaXRlbV9hdHRyaWJ1dGVzJykpO1xuICAgICAgICB9XG4gICAgICAgIHZhciBjZCA9IGdldFRvb2x0aXBJdGVtQ29vbGRvd24oaXRlbSk7XG4gICAgICAgIHZhciBtYW5hID0gZ2V0VG9vbHRpcEl0ZW1NYW5hQ29zdChpdGVtKTtcbiAgICAgICAgaWYgKGNkICE9ICcnIHx8IG1hbmEgIT0gJycpIHtcbiAgICAgICAgICAgIHZhciBjZG1hbmFjb3N0ID0gJCgnPGRpdj4nKS5hZGRDbGFzcygnaXRlbV9jZG1hbmEnKTtcbiAgICAgICAgICAgIGlmIChjZCAhPSAnJykge1xuICAgICAgICAgICAgICAgIGNkbWFuYWNvc3QuYXBwZW5kKCQoJzxzcGFuPicpLmh0bWwoY2QpLmFkZENsYXNzKCdpdGVtX2ZpZWxkIGl0ZW1fY29vbGRvd24nKSk7XG4gICAgICAgICAgICB9XG4gICAgICAgICAgICBpZiAobWFuYSAhPSAnJykge1xuICAgICAgICAgICAgICAgIGNkbWFuYWNvc3QuYXBwZW5kKCQoJzxzcGFuPicpLmh0bWwobWFuYSkuYWRkQ2xhc3MoJ2l0ZW1fZmllbGQgaXRlbV9tYW5hY29zdCcpKTtcbiAgICAgICAgICAgIH1cbiAgICAgICAgICAgIGRhdGEuYXBwZW5kKGNkbWFuYWNvc3QpO1xuICAgICAgICB9XG4gICAgICAgIGlmIChpdGVtLmxvcmUgIT0gbnVsbCkge1xuICAgICAgICAgICAgZGF0YS5hcHBlbmQoJCgnPGRpdj4nKS5odG1sKGl0ZW0ubG9yZSkuYWRkQ2xhc3MoJ2l0ZW1fZmllbGQgaXRlbV9sb3JlJykpO1xuICAgICAgICB9XG4gICAgICAgIGl0ZW10b29sdGlwZGF0YVtlbF0gPSBkYXRhLmh0bWwoKTtcbiAgICAgICAgcmV0dXJuIGRhdGEuaHRtbCgpO1xuICAgIH1cbiAgICBlbHNlIHtcbiAgICAgICAgcmV0dXJuIGl0ZW10b29sdGlwZGF0YVtlbF07XG4gICAgfVxufVxuXG5tb2R1bGUuZXhwb3J0cyA9IGdldEl0ZW1Ub29sdGlwRGF0YTsiLCIndXNlIHN0cmljdCc7XG52YXIgJCA9ICh0eXBlb2Ygd2luZG93ICE9PSBcInVuZGVmaW5lZFwiID8gd2luZG93WyckJ10gOiB0eXBlb2YgZ2xvYmFsICE9PSBcInVuZGVmaW5lZFwiID8gZ2xvYmFsWyckJ10gOiBudWxsKTtcbi8vcmVxdWlyZSgnanF1ZXJ5LXVpJyk7XG5yZXF1aXJlKCdqcXVlcnktdWkvdWkvdmVyc2lvbicpO1xucmVxdWlyZSgnanF1ZXJ5LXVpL3VpL3dpZGdldCcpO1xucmVxdWlyZSgnanF1ZXJ5LXVpL3VpL3VuaXF1ZS1pZCcpO1xucmVxdWlyZSgnanF1ZXJ5LXVpL3VpL3NhZmUtYWN0aXZlLWVsZW1lbnQnKTtcbnJlcXVpcmUoJ2pxdWVyeS11aS91aS9rZXljb2RlJyk7XG5yZXF1aXJlKCdqcXVlcnktdWkvdWkvcG9zaXRpb24nKTtcbnJlcXVpcmUoJ2pxdWVyeS11aS91aS9mb2N1c2FibGUnKTtcbnJlcXVpcmUoJ2pxdWVyeS11aS91aS90YWJiYWJsZScpO1xucmVxdWlyZSgnanF1ZXJ5LXVpL3VpL3BsdWdpbicpO1xucmVxdWlyZSgnanF1ZXJ5LXVpL3VpL2llJyk7XG5yZXF1aXJlKCdqcXVlcnktdWkvdWkvZGF0YScpO1xucmVxdWlyZSgnanF1ZXJ5LXVpL3VpL3Njcm9sbC1wYXJlbnQnKTtcbnJlcXVpcmUoJ2pxdWVyeS11aS91aS9kaXNhYmxlLXNlbGVjdGlvbicpO1xucmVxdWlyZSgnanF1ZXJ5LXVpL3VpL3NhZmUtYmx1cicpO1xucmVxdWlyZSgnanF1ZXJ5LXVpL3VpL3dpZGdldHMvYnV0dG9uJyk7XG5yZXF1aXJlKCdqcXVlcnktdWkvdWkvd2lkZ2V0cy9zcGlubmVyJyk7XG5yZXF1aXJlKCdqcXVlcnktdWkvdWkvd2lkZ2V0cy9tZW51Jyk7XG5yZXF1aXJlKCdqcXVlcnktdWkvdWkvd2lkZ2V0cy9hdXRvY29tcGxldGUnKTtcbnJlcXVpcmUoJ2pxdWVyeS11aS91aS93aWRnZXRzL21vdXNlJyk7XG5yZXF1aXJlKCdqcXVlcnktdWkvdWkvd2lkZ2V0cy9kcmFnZ2FibGUnKTtcbnJlcXVpcmUoJ2pxdWVyeS11aS91aS93aWRnZXRzL3Jlc2l6YWJsZScpO1xucmVxdWlyZSgnanF1ZXJ5LXVpL3VpL3dpZGdldHMvZGlhbG9nJyk7XG5cbnZhciBwcm90byA9ICQudWkuYXV0b2NvbXBsZXRlLnByb3RvdHlwZSxcbiAgICBpbml0U291cmNlID0gcHJvdG8uX2luaXRTb3VyY2U7XG5cbmZ1bmN0aW9uIGZpbHRlciggYXJyYXksIHRlcm0gKSB7XG4gICAgdmFyIG1hdGNoZXIgPSBuZXcgUmVnRXhwKCAkLnVpLmF1dG9jb21wbGV0ZS5lc2NhcGVSZWdleCh0ZXJtKSwgXCJpXCIgKTtcbiAgICByZXR1cm4gJC5ncmVwKCBhcnJheSwgZnVuY3Rpb24odmFsdWUpIHtcbiAgICAgICAgcmV0dXJuIG1hdGNoZXIudGVzdCggJCggXCI8ZGl2PlwiICkuaHRtbCggdmFsdWUubGFiZWwgfHwgdmFsdWUudmFsdWUgfHwgdmFsdWUgKS50ZXh0KCkgKTtcbiAgICB9KTtcbn1cblxuJC5leHRlbmQoIHByb3RvLCB7XG4gICAgX2luaXRTb3VyY2U6IGZ1bmN0aW9uKCkge1xuICAgICAgICBpZiAoIHRoaXMub3B0aW9ucy5odG1sICYmICQuaXNBcnJheSh0aGlzLm9wdGlvbnMuc291cmNlKSApIHtcbiAgICAgICAgICAgIHRoaXMuc291cmNlID0gZnVuY3Rpb24oIHJlcXVlc3QsIHJlc3BvbnNlICkge1xuICAgICAgICAgICAgICAgIHJlc3BvbnNlKCBmaWx0ZXIoIHRoaXMub3B0aW9ucy5zb3VyY2UsIHJlcXVlc3QudGVybSApICk7XG4gICAgICAgICAgICB9O1xuICAgICAgICB9IGVsc2Uge1xuICAgICAgICAgICAgaW5pdFNvdXJjZS5jYWxsKCB0aGlzICk7XG4gICAgICAgIH1cbiAgICB9LFxuXG4gICAgX3JlbmRlckl0ZW06IGZ1bmN0aW9uKCB1bCwgaXRlbSkge1xuICAgICAgICByZXR1cm4gJCggXCI8bGk+PC9saT5cIiApXG4gICAgICAgICAgICAuZGF0YSggXCJpdGVtLmF1dG9jb21wbGV0ZVwiLCBpdGVtIClcbiAgICAgICAgICAgIC5hcHBlbmQoICQoIFwiPGE+PC9hPlwiIClbIHRoaXMub3B0aW9ucy5odG1sID8gXCJodG1sXCIgOiBcInRleHRcIiBdKCBpdGVtLmxhYmVsICkgKVxuICAgICAgICAgICAgLmFwcGVuZFRvKCB1bCApO1xuICAgIH1cbn0pOyIsImtvLmV4dGVuZGVycy5hc3luYyA9IGZ1bmN0aW9uKGNvbXB1dGVkRGVmZXJyZWQsIGluaXRpYWxWYWx1ZSkge1xuIFxuICAgIHZhciBwbGFpbk9ic2VydmFibGUgPSBrby5vYnNlcnZhYmxlKGluaXRpYWxWYWx1ZSksIGN1cnJlbnREZWZlcnJlZDtcbiAgICBwbGFpbk9ic2VydmFibGUuaW5Qcm9ncmVzcyA9IGtvLm9ic2VydmFibGUoZmFsc2UpO1xuIFxuICAgIGtvLmNvbXB1dGVkKGZ1bmN0aW9uKCkge1xuICAgICAgICBpZiAoY3VycmVudERlZmVycmVkKSB7XG4gICAgICAgICAgICBjdXJyZW50RGVmZXJyZWQucmVqZWN0KCk7XG4gICAgICAgICAgICBjdXJyZW50RGVmZXJyZWQgPSBudWxsO1xuICAgICAgICB9XG4gXG4gICAgICAgIHZhciBuZXdEZWZlcnJlZCA9IGNvbXB1dGVkRGVmZXJyZWQoKTtcbiAgICAgICAgaWYgKG5ld0RlZmVycmVkICYmXG4gICAgICAgICAgICAodHlwZW9mIG5ld0RlZmVycmVkLmRvbmUgPT0gXCJmdW5jdGlvblwiKSkge1xuIFxuICAgICAgICAgICAgLy8gSXQncyBhIGRlZmVycmVkXG4gICAgICAgICAgICBwbGFpbk9ic2VydmFibGUuaW5Qcm9ncmVzcyh0cnVlKTtcbiBcbiAgICAgICAgICAgIC8vIENyZWF0ZSBvdXIgb3duIHdyYXBwZXIgc28gd2UgY2FuIHJlamVjdFxuICAgICAgICAgICAgY3VycmVudERlZmVycmVkID0gJC5EZWZlcnJlZCgpLmRvbmUoZnVuY3Rpb24oZGF0YSkge1xuICAgICAgICAgICAgICAgIHBsYWluT2JzZXJ2YWJsZS5pblByb2dyZXNzKGZhbHNlKTtcbiAgICAgICAgICAgICAgICBwbGFpbk9ic2VydmFibGUoZGF0YSk7XG4gICAgICAgICAgICB9KTtcbiAgICAgICAgICAgIG5ld0RlZmVycmVkLmRvbmUoY3VycmVudERlZmVycmVkLnJlc29sdmUpO1xuICAgICAgICB9IGVsc2Uge1xuICAgICAgICAgICAgLy8gQSByZWFsIHZhbHVlLCBzbyBqdXN0IHB1Ymxpc2ggaXQgaW1tZWRpYXRlbHlcbiAgICAgICAgICAgIHBsYWluT2JzZXJ2YWJsZShuZXdEZWZlcnJlZCk7XG4gICAgICAgIH1cbiAgICB9KTtcbiBcbiAgICByZXR1cm4gcGxhaW5PYnNlcnZhYmxlO1xufTsiLCJpZiAoIUFycmF5LnByb3RvdHlwZS5maW5kKSB7XG4gIEFycmF5LnByb3RvdHlwZS5maW5kID0gZnVuY3Rpb24ocHJlZGljYXRlKSB7XG4gICAgJ3VzZSBzdHJpY3QnO1xuICAgIGlmICh0aGlzID09IG51bGwpIHtcbiAgICAgIHRocm93IG5ldyBUeXBlRXJyb3IoJ0FycmF5LnByb3RvdHlwZS5maW5kIGNhbGxlZCBvbiBudWxsIG9yIHVuZGVmaW5lZCcpO1xuICAgIH1cbiAgICBpZiAodHlwZW9mIHByZWRpY2F0ZSAhPT0gJ2Z1bmN0aW9uJykge1xuICAgICAgdGhyb3cgbmV3IFR5cGVFcnJvcigncHJlZGljYXRlIG11c3QgYmUgYSBmdW5jdGlvbicpO1xuICAgIH1cbiAgICB2YXIgbGlzdCA9IE9iamVjdCh0aGlzKTtcbiAgICB2YXIgbGVuZ3RoID0gbGlzdC5sZW5ndGggPj4+IDA7XG4gICAgdmFyIHRoaXNBcmcgPSBhcmd1bWVudHNbMV07XG4gICAgdmFyIHZhbHVlO1xuXG4gICAgZm9yICh2YXIgaSA9IDA7IGkgPCBsZW5ndGg7IGkrKykge1xuICAgICAgdmFsdWUgPSBsaXN0W2ldO1xuICAgICAgaWYgKHByZWRpY2F0ZS5jYWxsKHRoaXNBcmcsIHZhbHVlLCBpLCBsaXN0KSkge1xuICAgICAgICByZXR1cm4gdmFsdWU7XG4gICAgICB9XG4gICAgfVxuICAgIHJldHVybiB1bmRlZmluZWQ7XG4gIH07XG59IiwiZnVuY3Rpb24gVmlld01vZGVsKHBhcmFtcykge1xuICAgIHZhciBzZWxmID0gdGhpcztcbiAgICBzZWxmLndpbmRvd1dpZHRoID0gcGFyYW1zLndpbmRvd1dpZHRoO1xuICAgIHNlbGYud2luZG93SGVpZ2h0ID0gcGFyYW1zLndpbmRvd0hlaWdodDtcbiAgICBzZWxmLmRpc3BsYXlTaG9wID0gcGFyYW1zLmRpc3BsYXlTaG9wO1xuICAgIHNlbGYuZGlzcGxheVNob3BJdGVtVG9vbHRpcCA9IHBhcmFtcy5kaXNwbGF5U2hvcEl0ZW1Ub29sdGlwO1xuICAgIHNlbGYuc2hvcERvY2sgPSBwYXJhbXMuc2hvcERvY2s7XG4gICAgc2VsZi5zaG9wRG9ja1RyaWdnZXIgPSBwYXJhbXMuc2hvcERvY2tUcmlnZ2VyO1xuICAgIHNlbGYuc2hvcFBvcG91dCA9IHBhcmFtcy5zaG9wUG9wb3V0O1xuICAgIHNlbGYuc2VsZWN0ZWRJdGVtID0gcGFyYW1zLnNlbGVjdGVkSXRlbTtcbiAgICBzZWxmLmFkZEl0ZW0gPSBwYXJhbXMuYWRkSXRlbTtcbiAgICBzZWxmLmNoYW5nZVNlbGVjdGVkSXRlbSA9IHBhcmFtcy5jaGFuZ2VTZWxlY3RlZEl0ZW07XG4gICAgc2VsZi5nZXRJdGVtVG9vbHRpcERhdGEgPSBwYXJhbXMuZ2V0SXRlbVRvb2x0aXBEYXRhO1xuICAgIHNlbGYuZ2V0SXRlbUlucHV0TGFiZWwgPSBwYXJhbXMuZ2V0SXRlbUlucHV0TGFiZWw7XG4gICAgc2VsZi5pdGVtSW5wdXRWYWx1ZSA9IHBhcmFtcy5pdGVtSW5wdXRWYWx1ZTtcbiAgICBzZWxmLml0ZW1PcHRpb25zID0gcGFyYW1zLml0ZW1PcHRpb25zO1xufVxuXG5tb2R1bGUuZXhwb3J0cyA9IHtcbiAgICB2aWV3TW9kZWw6IFZpZXdNb2RlbCxcbiAgICB0ZW1wbGF0ZTogXCIgICAgICAgIDxkaXYgaWQ9XFxcInNob3AtY29udGFpbmVyXFxcIiBjbGFzcz1cXFwiY29sLW1kLTEyIGNvbC1sZy00XFxcIiBkYXRhLWJpbmQ9XFxcInNob3BEb2NrU3R5bGU6IHNob3BEb2NrVHJpZ2dlciwgdmlzaWJsZTogZGlzcGxheVNob3AoKSB8fCBzaG9wUG9wb3V0KCksIGNzczogeydjb2wtbGctNCc6ICFzaG9wUG9wb3V0KCl9LCBzdHlsZTogeyAncGFkZGluZy10b3AnOiBzaG9wUG9wb3V0KCkgPyAnNXB4JyA6ICcwcHgnfVxcXCI+XFxuICAgICAgICAgICAgICA8YnV0dG9uIGlkPVxcXCJzaG9wLW1pbmltaXplXFxcIiBjbGFzcz1cXFwiYnRuIGJ0bi1kZWZhdWx0IGJ0bi14cyBzaG9wLWJ1dHRvbiBnbHlwaGljb24gZ2x5cGhpY29uLW1pbnVzIHB1bGwtcmlnaHRcXFwiIGRhdGEtYmluZD1cXFwidG9nZ2xlOiBkaXNwbGF5U2hvcCwgdmlzaWJsZTogZGlzcGxheVNob3AoKVxcXCIgdGl0bGU9XFxcIk1pbmltaXplIHNob3BcXFwiPjwvYnV0dG9uPlxcbiAgICAgICAgICAgICAgPGJ1dHRvbiBpZD1cXFwic2hvcC1tYXhpbWl6ZVxcXCIgY2xhc3M9XFxcImJ0biBidG4tZGVmYXVsdCBidG4teHMgc2hvcC1idXR0b24gZ2x5cGhpY29uIGdseXBoaWNvbi1wbHVzIHB1bGwtcmlnaHRcXFwiIGRhdGEtYmluZD1cXFwidG9nZ2xlOiBkaXNwbGF5U2hvcCwgdmlzaWJsZTogIWRpc3BsYXlTaG9wKClcXFwiIHRpdGxlPVxcXCJNYXhpbWl6ZSBzaG9wXFxcIj48L2J1dHRvbj5cXG4gICAgICAgICAgICAgIDxidXR0b24gY2xhc3M9XFxcImJ0biBidG4tZGVmYXVsdCBidG4teHMgc2hvcC1idXR0b24gZ2x5cGhpY29uIGdseXBoaWNvbi1uZXctd2luZG93IHB1bGwtcmlnaHQgaGlkZGVuLXhzXFxcIiBkYXRhLWJpbmQ9XFxcImNsaWNrOiBzaG9wUG9wb3V0LCB2aXNpYmxlOiAhc2hvcFBvcG91dCgpXFxcIiB0aXRsZT1cXFwiUG9wb3V0IHNob3BcXFwiPjwvYnV0dG9uPlxcbiAgICAgICAgICAgICAgPGJ1dHRvbiBjbGFzcz1cXFwiYnRuIGJ0bi1kZWZhdWx0IGJ0bi14cyBzaG9wLWJ1dHRvbiBnbHlwaGljb24gZ2x5cGhpY29uLWFsaWduLXJpZ2h0IHB1bGwtcmlnaHQgaGlkZGVuLXhzXFxcIiBkYXRhLWJpbmQ9XFxcInRvZ2dsZTogc2hvcERvY2ssIGF0dHI6IHsgdGl0bGU6IHNob3BEb2NrKCkgPyAnVW5kb2NrIHNob3AgdG8gcmlnaHQgc2lkZSBvZiBzY3JlZW4nIDogJ0RvY2sgc2hvcCB0byByaWdodCBzaWRlIG9mIHNjcmVlbicgfVxcXCIgPjwvYnV0dG9uPlxcbiAgICAgICAgICAgIDx1bCBpZD1cXFwic2hvcHRhYnNcXFwiIGNsYXNzPVxcXCJuYXYgbmF2LXRhYnNcXFwiIGRhdGEtYmluZD1cXFwidmlzaWJsZTogZGlzcGxheVNob3AoKVxcXCI+XFxuICAgICAgICAgICAgICA8bGk+PGEgaHJlZj1cXFwiI3Nob3BfYmFzaWNcXFwiIGRhdGEtdG9nZ2xlPVxcXCJ0YWJcXFwiPkJhc2ljPC9hPjwvbGk+XFxuICAgICAgICAgICAgICA8bGk+PGEgaHJlZj1cXFwiI3Nob3BfdXBncmFkZVxcXCIgZGF0YS10b2dnbGU9XFxcInRhYlxcXCI+VXBncmFkZTwvYT48L2xpPlxcbiAgICAgICAgICAgICAgPGxpPjxhIGhyZWY9XFxcIiNzaG9wX3NlY3JldFxcXCIgZGF0YS10b2dnbGU9XFxcInRhYlxcXCI+U2VjcmV0PC9hPjwvbGk+XFxuICAgICAgICAgICAgPC91bD5cXG4gICAgICAgICAgICA8ZGl2IGNsYXNzPVxcXCJ0YWItY29udGVudCB0ZXh0LWNlbnRlciBib3R0b20tYnVmZmVyMlxcXCIgZGF0YS1iaW5kPVxcXCJ2aXNpYmxlOiBkaXNwbGF5U2hvcCgpXFxcIj5cXG4gICAgICAgICAgICAgICAgPGRpdiBjbGFzcz1cXFwidGFiLXBhbmUgYWN0aXZlXFxcIiBpZD1cXFwic2hvcF9iYXNpY1xcXCI+XFxuPGRpdiBjbGFzcz1cXFwic2hvcC1jb2x1bW5cXFwiPlxcbiAgPGRpdiBjbGFzcz1cXFwiaGMtc2hvcCBoYy1zaG9wLWNvbnN1bWFibGVzXFxcIiBpZD1cXFwiY29uc3VtYWJsZXNcXFwiPjwvZGl2PlxcbiAgPGRpdiBjbGFzcz1cXFwiaW1nLXJvdW5kZWQgaXRlbXMtc3ByaXRlLTUweDM2IGl0ZW1zLXNwcml0ZS1jbGFyaXR5XFxcIiBpZD1cXFwiY2xhcml0eVxcXCIgZGF0YS1iaW5kPVxcXCJjbGljazogY2hhbmdlU2VsZWN0ZWRJdGVtLCBldmVudDogeyBkYmxjbGljazogYWRkSXRlbSB9XFxcIj48L2Rpdj5cXG4gIDxkaXYgY2xhc3M9XFxcImltZy1yb3VuZGVkIGl0ZW1zLXNwcml0ZS01MHgzNiBpdGVtcy1zcHJpdGUtZmFlcmllX2ZpcmVcXFwiIGlkPVxcXCJmYWVyaWVfZmlyZVxcXCIgZGF0YS1iaW5kPVxcXCJjbGljazogY2hhbmdlU2VsZWN0ZWRJdGVtLCBldmVudDogeyBkYmxjbGljazogYWRkSXRlbSB9XFxcIj48L2Rpdj5cXG4gIDxkaXYgY2xhc3M9XFxcImltZy1yb3VuZGVkIGl0ZW1zLXNwcml0ZS01MHgzNiBpdGVtcy1zcHJpdGUtZW5jaGFudGVkX21hbmdvXFxcIiBpZD1cXFwiZW5jaGFudGVkX21hbmdvXFxcIiBkYXRhLWJpbmQ9XFxcImNsaWNrOiBjaGFuZ2VTZWxlY3RlZEl0ZW0sIGV2ZW50OiB7IGRibGNsaWNrOiBhZGRJdGVtIH1cXFwiPjwvZGl2PlxcbiAgPGRpdiBjbGFzcz1cXFwiaW1nLXJvdW5kZWQgaXRlbXMtc3ByaXRlLTUweDM2IGl0ZW1zLXNwcml0ZS10YW5nb1xcXCIgaWQ9XFxcInRhbmdvXFxcIiBkYXRhLWJpbmQ9XFxcImNsaWNrOiBjaGFuZ2VTZWxlY3RlZEl0ZW0sIGV2ZW50OiB7IGRibGNsaWNrOiBhZGRJdGVtIH1cXFwiPjwvZGl2PlxcbiAgPGRpdiBjbGFzcz1cXFwiaW1nLXJvdW5kZWQgaXRlbXMtc3ByaXRlLTUweDM2IGl0ZW1zLXNwcml0ZS1mbGFza1xcXCIgaWQ9XFxcImZsYXNrXFxcIiBkYXRhLWJpbmQ9XFxcImNsaWNrOiBjaGFuZ2VTZWxlY3RlZEl0ZW0sIGV2ZW50OiB7IGRibGNsaWNrOiBhZGRJdGVtIH1cXFwiPjwvZGl2PlxcbiAgPGRpdiBjbGFzcz1cXFwiaW1nLXJvdW5kZWQgaXRlbXMtc3ByaXRlLTUweDM2IGl0ZW1zLXNwcml0ZS1zbW9rZV9vZl9kZWNlaXRcXFwiIGlkPVxcXCJzbW9rZV9vZl9kZWNlaXRcXFwiIGRhdGEtYmluZD1cXFwiY2xpY2s6IGNoYW5nZVNlbGVjdGVkSXRlbSwgZXZlbnQ6IHsgZGJsY2xpY2s6IGFkZEl0ZW0gfVxcXCI+PC9kaXY+XFxuICA8ZGl2IGNsYXNzPVxcXCJpbWctcm91bmRlZCBpdGVtcy1zcHJpdGUtNTB4MzYgaXRlbXMtc3ByaXRlLXRwc2Nyb2xsXFxcIiBpZD1cXFwidHBzY3JvbGxcXFwiIGRhdGEtYmluZD1cXFwiY2xpY2s6IGNoYW5nZVNlbGVjdGVkSXRlbSwgZXZlbnQ6IHsgZGJsY2xpY2s6IGFkZEl0ZW0gfVxcXCI+PC9kaXY+XFxuICA8ZGl2IGNsYXNzPVxcXCJpbWctcm91bmRlZCBpdGVtcy1zcHJpdGUtNTB4MzYgaXRlbXMtc3ByaXRlLWR1c3RcXFwiIGlkPVxcXCJkdXN0XFxcIiBkYXRhLWJpbmQ9XFxcImNsaWNrOiBjaGFuZ2VTZWxlY3RlZEl0ZW0sIGV2ZW50OiB7IGRibGNsaWNrOiBhZGRJdGVtIH1cXFwiPjwvZGl2PlxcbiAgPGRpdiBjbGFzcz1cXFwiaW1nLXJvdW5kZWQgaXRlbXMtc3ByaXRlLTUweDM2IGl0ZW1zLXNwcml0ZS1jb3VyaWVyXFxcIiBpZD1cXFwiY291cmllclxcXCIgZGF0YS1iaW5kPVxcXCJjbGljazogY2hhbmdlU2VsZWN0ZWRJdGVtLCBldmVudDogeyBkYmxjbGljazogYWRkSXRlbSB9XFxcIj48L2Rpdj5cXG4gIDxkaXYgY2xhc3M9XFxcImltZy1yb3VuZGVkIGl0ZW1zLXNwcml0ZS01MHgzNiBpdGVtcy1zcHJpdGUtZmx5aW5nX2NvdXJpZXJcXFwiIGlkPVxcXCJmbHlpbmdfY291cmllclxcXCIgZGF0YS1iaW5kPVxcXCJjbGljazogY2hhbmdlU2VsZWN0ZWRJdGVtLCBldmVudDogeyBkYmxjbGljazogYWRkSXRlbSB9XFxcIj48L2Rpdj5cXG4gIDxkaXYgY2xhc3M9XFxcImltZy1yb3VuZGVkIGl0ZW1zLXNwcml0ZS01MHgzNiBpdGVtcy1zcHJpdGUtd2FyZF9vYnNlcnZlclxcXCIgaWQ9XFxcIndhcmRfb2JzZXJ2ZXJcXFwiIGRhdGEtYmluZD1cXFwiY2xpY2s6IGNoYW5nZVNlbGVjdGVkSXRlbSwgZXZlbnQ6IHsgZGJsY2xpY2s6IGFkZEl0ZW0gfVxcXCI+PC9kaXY+XFxuICA8ZGl2IGNsYXNzPVxcXCJpbWctcm91bmRlZCBpdGVtcy1zcHJpdGUtNTB4MzYgaXRlbXMtc3ByaXRlLXdhcmRfc2VudHJ5XFxcIiBpZD1cXFwid2FyZF9zZW50cnlcXFwiIGRhdGEtYmluZD1cXFwiY2xpY2s6IGNoYW5nZVNlbGVjdGVkSXRlbSwgZXZlbnQ6IHsgZGJsY2xpY2s6IGFkZEl0ZW0gfVxcXCI+PC9kaXY+XFxuICA8ZGl2IGNsYXNzPVxcXCJpbWctcm91bmRlZCBpdGVtcy1zcHJpdGUtNTB4MzYgaXRlbXMtc3ByaXRlLXRvbWVfb2Zfa25vd2xlZGdlXFxcIiBpZD1cXFwidG9tZV9vZl9rbm93bGVkZ2VcXFwiIGRhdGEtYmluZD1cXFwiY2xpY2s6IGNoYW5nZVNlbGVjdGVkSXRlbSwgZXZlbnQ6IHsgZGJsY2xpY2s6IGFkZEl0ZW0gfVxcXCI+PC9kaXY+XFxuICA8ZGl2IGNsYXNzPVxcXCJpbWctcm91bmRlZCBpdGVtcy1zcHJpdGUtNTB4MzYgaXRlbXMtc3ByaXRlLWJvdHRsZVxcXCIgaWQ9XFxcImJvdHRsZVxcXCIgZGF0YS1iaW5kPVxcXCJjbGljazogY2hhbmdlU2VsZWN0ZWRJdGVtLCBldmVudDogeyBkYmxjbGljazogYWRkSXRlbSB9XFxcIj48L2Rpdj5cXG48L2Rpdj5cXG48ZGl2IGNsYXNzPVxcXCJzaG9wLWNvbHVtblxcXCI+XFxuICA8ZGl2IGNsYXNzPVxcXCJoYy1zaG9wIGhjLXNob3AtYXR0cmlidXRlc1xcXCIgaWQ9XFxcImF0dHJpYnV0ZXNcXFwiPjwvZGl2PlxcbiAgPGRpdiBjbGFzcz1cXFwiaW1nLXJvdW5kZWQgaXRlbXMtc3ByaXRlLTUweDM2IGl0ZW1zLXNwcml0ZS1icmFuY2hlc1xcXCIgaWQ9XFxcImJyYW5jaGVzXFxcIiBkYXRhLWJpbmQ9XFxcImNsaWNrOiBjaGFuZ2VTZWxlY3RlZEl0ZW0sIGV2ZW50OiB7IGRibGNsaWNrOiBhZGRJdGVtIH1cXFwiPjwvZGl2PlxcbiAgPGRpdiBjbGFzcz1cXFwiaW1nLXJvdW5kZWQgaXRlbXMtc3ByaXRlLTUweDM2IGl0ZW1zLXNwcml0ZS1nYXVudGxldHNcXFwiIGlkPVxcXCJnYXVudGxldHNcXFwiIGRhdGEtYmluZD1cXFwiY2xpY2s6IGNoYW5nZVNlbGVjdGVkSXRlbSwgZXZlbnQ6IHsgZGJsY2xpY2s6IGFkZEl0ZW0gfVxcXCI+PC9kaXY+XFxuICA8ZGl2IGNsYXNzPVxcXCJpbWctcm91bmRlZCBpdGVtcy1zcHJpdGUtNTB4MzYgaXRlbXMtc3ByaXRlLXNsaXBwZXJzXFxcIiBpZD1cXFwic2xpcHBlcnNcXFwiIGRhdGEtYmluZD1cXFwiY2xpY2s6IGNoYW5nZVNlbGVjdGVkSXRlbSwgZXZlbnQ6IHsgZGJsY2xpY2s6IGFkZEl0ZW0gfVxcXCI+PC9kaXY+XFxuICA8ZGl2IGNsYXNzPVxcXCJpbWctcm91bmRlZCBpdGVtcy1zcHJpdGUtNTB4MzYgaXRlbXMtc3ByaXRlLW1hbnRsZVxcXCIgaWQ9XFxcIm1hbnRsZVxcXCIgZGF0YS1iaW5kPVxcXCJjbGljazogY2hhbmdlU2VsZWN0ZWRJdGVtLCBldmVudDogeyBkYmxjbGljazogYWRkSXRlbSB9XFxcIj48L2Rpdj5cXG4gIDxkaXYgY2xhc3M9XFxcImltZy1yb3VuZGVkIGl0ZW1zLXNwcml0ZS01MHgzNiBpdGVtcy1zcHJpdGUtY2lyY2xldFxcXCIgaWQ9XFxcImNpcmNsZXRcXFwiIGRhdGEtYmluZD1cXFwiY2xpY2s6IGNoYW5nZVNlbGVjdGVkSXRlbSwgZXZlbnQ6IHsgZGJsY2xpY2s6IGFkZEl0ZW0gfVxcXCI+PC9kaXY+XFxuICA8ZGl2IGNsYXNzPVxcXCJpbWctcm91bmRlZCBpdGVtcy1zcHJpdGUtNTB4MzYgaXRlbXMtc3ByaXRlLWJlbHRfb2Zfc3RyZW5ndGhcXFwiIGlkPVxcXCJiZWx0X29mX3N0cmVuZ3RoXFxcIiBkYXRhLWJpbmQ9XFxcImNsaWNrOiBjaGFuZ2VTZWxlY3RlZEl0ZW0sIGV2ZW50OiB7IGRibGNsaWNrOiBhZGRJdGVtIH1cXFwiPjwvZGl2PlxcbiAgPGRpdiBjbGFzcz1cXFwiaW1nLXJvdW5kZWQgaXRlbXMtc3ByaXRlLTUweDM2IGl0ZW1zLXNwcml0ZS1ib290c19vZl9lbHZlc1xcXCIgaWQ9XFxcImJvb3RzX29mX2VsdmVzXFxcIiBkYXRhLWJpbmQ9XFxcImNsaWNrOiBjaGFuZ2VTZWxlY3RlZEl0ZW0sIGV2ZW50OiB7IGRibGNsaWNrOiBhZGRJdGVtIH1cXFwiPjwvZGl2PlxcbiAgPGRpdiBjbGFzcz1cXFwiaW1nLXJvdW5kZWQgaXRlbXMtc3ByaXRlLTUweDM2IGl0ZW1zLXNwcml0ZS1yb2JlXFxcIiBpZD1cXFwicm9iZVxcXCIgZGF0YS1iaW5kPVxcXCJjbGljazogY2hhbmdlU2VsZWN0ZWRJdGVtLCBldmVudDogeyBkYmxjbGljazogYWRkSXRlbSB9XFxcIj48L2Rpdj5cXG4gIDxkaXYgY2xhc3M9XFxcImltZy1yb3VuZGVkIGl0ZW1zLXNwcml0ZS01MHgzNiBpdGVtcy1zcHJpdGUtb2dyZV9heGVcXFwiIGlkPVxcXCJvZ3JlX2F4ZVxcXCIgZGF0YS1iaW5kPVxcXCJjbGljazogY2hhbmdlU2VsZWN0ZWRJdGVtLCBldmVudDogeyBkYmxjbGljazogYWRkSXRlbSB9XFxcIj48L2Rpdj5cXG4gIDxkaXYgY2xhc3M9XFxcImltZy1yb3VuZGVkIGl0ZW1zLXNwcml0ZS01MHgzNiBpdGVtcy1zcHJpdGUtYmxhZGVfb2ZfYWxhY3JpdHlcXFwiIGlkPVxcXCJibGFkZV9vZl9hbGFjcml0eVxcXCIgZGF0YS1iaW5kPVxcXCJjbGljazogY2hhbmdlU2VsZWN0ZWRJdGVtLCBldmVudDogeyBkYmxjbGljazogYWRkSXRlbSB9XFxcIj48L2Rpdj5cXG4gIDxkaXYgY2xhc3M9XFxcImltZy1yb3VuZGVkIGl0ZW1zLXNwcml0ZS01MHgzNiBpdGVtcy1zcHJpdGUtc3RhZmZfb2Zfd2l6YXJkcnlcXFwiIGlkPVxcXCJzdGFmZl9vZl93aXphcmRyeVxcXCIgZGF0YS1iaW5kPVxcXCJjbGljazogY2hhbmdlU2VsZWN0ZWRJdGVtLCBldmVudDogeyBkYmxjbGljazogYWRkSXRlbSB9XFxcIj48L2Rpdj5cXG4gIDxkaXYgY2xhc3M9XFxcImltZy1yb3VuZGVkIGl0ZW1zLXNwcml0ZS01MHgzNiBpdGVtcy1zcHJpdGUtZW1wdHlpdGVtYmdcXFwiIGlkPVxcXCJlbXB0eWl0ZW1iZ1xcXCI+PC9kaXY+XFxuICA8ZGl2IGNsYXNzPVxcXCJpbWctcm91bmRlZCBpdGVtcy1zcHJpdGUtNTB4MzYgaXRlbXMtc3ByaXRlLWVtcHR5aXRlbWJnXFxcIiBpZD1cXFwiZW1wdHlpdGVtYmdcXFwiPjwvZGl2PlxcbiAgPGRpdiBjbGFzcz1cXFwiaW1nLXJvdW5kZWQgaXRlbXMtc3ByaXRlLTUweDM2IGl0ZW1zLXNwcml0ZS1lbXB0eWl0ZW1iZ1xcXCIgaWQ9XFxcImVtcHR5aXRlbWJnXFxcIj48L2Rpdj5cXG48L2Rpdj5cXG48ZGl2IGNsYXNzPVxcXCJzaG9wLWNvbHVtblxcXCI+XFxuICA8ZGl2IGNsYXNzPVxcXCJoYy1zaG9wIGhjLXNob3AtYXJtYW1lbnRzXFxcIiBpZD1cXFwiYXJtYW1lbnRzXFxcIj48L2Rpdj5cXG4gIDxkaXYgY2xhc3M9XFxcImltZy1yb3VuZGVkIGl0ZW1zLXNwcml0ZS01MHgzNiBpdGVtcy1zcHJpdGUtcmluZ19vZl9wcm90ZWN0aW9uXFxcIiBpZD1cXFwicmluZ19vZl9wcm90ZWN0aW9uXFxcIiBkYXRhLWJpbmQ9XFxcImNsaWNrOiBjaGFuZ2VTZWxlY3RlZEl0ZW0sIGV2ZW50OiB7IGRibGNsaWNrOiBhZGRJdGVtIH1cXFwiPjwvZGl2PlxcbiAgPGRpdiBjbGFzcz1cXFwiaW1nLXJvdW5kZWQgaXRlbXMtc3ByaXRlLTUweDM2IGl0ZW1zLXNwcml0ZS1zdG91dF9zaGllbGRcXFwiIGlkPVxcXCJzdG91dF9zaGllbGRcXFwiIGRhdGEtYmluZD1cXFwiY2xpY2s6IGNoYW5nZVNlbGVjdGVkSXRlbSwgZXZlbnQ6IHsgZGJsY2xpY2s6IGFkZEl0ZW0gfVxcXCI+PC9kaXY+XFxuICA8ZGl2IGNsYXNzPVxcXCJpbWctcm91bmRlZCBpdGVtcy1zcHJpdGUtNTB4MzYgaXRlbXMtc3ByaXRlLXF1ZWxsaW5nX2JsYWRlXFxcIiBpZD1cXFwicXVlbGxpbmdfYmxhZGVcXFwiIGRhdGEtYmluZD1cXFwiY2xpY2s6IGNoYW5nZVNlbGVjdGVkSXRlbSwgZXZlbnQ6IHsgZGJsY2xpY2s6IGFkZEl0ZW0gfVxcXCI+PC9kaXY+XFxuICA8ZGl2IGNsYXNzPVxcXCJpbWctcm91bmRlZCBpdGVtcy1zcHJpdGUtNTB4MzYgaXRlbXMtc3ByaXRlLWluZnVzZWRfcmFpbmRyb3BcXFwiIGlkPVxcXCJpbmZ1c2VkX3JhaW5kcm9wXFxcIiBkYXRhLWJpbmQ9XFxcImNsaWNrOiBjaGFuZ2VTZWxlY3RlZEl0ZW0sIGV2ZW50OiB7IGRibGNsaWNrOiBhZGRJdGVtIH1cXFwiPjwvZGl2PlxcbiAgPGRpdiBjbGFzcz1cXFwiaW1nLXJvdW5kZWQgaXRlbXMtc3ByaXRlLTUweDM2IGl0ZW1zLXNwcml0ZS1ibGlnaHRfc3RvbmVcXFwiIGlkPVxcXCJibGlnaHRfc3RvbmVcXFwiIGRhdGEtYmluZD1cXFwiY2xpY2s6IGNoYW5nZVNlbGVjdGVkSXRlbSwgZXZlbnQ6IHsgZGJsY2xpY2s6IGFkZEl0ZW0gfVxcXCI+PC9kaXY+XFxuICA8ZGl2IGNsYXNzPVxcXCJpbWctcm91bmRlZCBpdGVtcy1zcHJpdGUtNTB4MzYgaXRlbXMtc3ByaXRlLW9yYl9vZl92ZW5vbVxcXCIgaWQ9XFxcIm9yYl9vZl92ZW5vbVxcXCIgZGF0YS1iaW5kPVxcXCJjbGljazogY2hhbmdlU2VsZWN0ZWRJdGVtLCBldmVudDogeyBkYmxjbGljazogYWRkSXRlbSB9XFxcIj48L2Rpdj5cXG4gIDxkaXYgY2xhc3M9XFxcImltZy1yb3VuZGVkIGl0ZW1zLXNwcml0ZS01MHgzNiBpdGVtcy1zcHJpdGUtYmxhZGVzX29mX2F0dGFja1xcXCIgaWQ9XFxcImJsYWRlc19vZl9hdHRhY2tcXFwiIGRhdGEtYmluZD1cXFwiY2xpY2s6IGNoYW5nZVNlbGVjdGVkSXRlbSwgZXZlbnQ6IHsgZGJsY2xpY2s6IGFkZEl0ZW0gfVxcXCI+PC9kaXY+XFxuICA8ZGl2IGNsYXNzPVxcXCJpbWctcm91bmRlZCBpdGVtcy1zcHJpdGUtNTB4MzYgaXRlbXMtc3ByaXRlLWNoYWlubWFpbFxcXCIgaWQ9XFxcImNoYWlubWFpbFxcXCIgZGF0YS1iaW5kPVxcXCJjbGljazogY2hhbmdlU2VsZWN0ZWRJdGVtLCBldmVudDogeyBkYmxjbGljazogYWRkSXRlbSB9XFxcIj48L2Rpdj5cXG4gIDxkaXYgY2xhc3M9XFxcImltZy1yb3VuZGVkIGl0ZW1zLXNwcml0ZS01MHgzNiBpdGVtcy1zcHJpdGUtcXVhcnRlcnN0YWZmXFxcIiBpZD1cXFwicXVhcnRlcnN0YWZmXFxcIiBkYXRhLWJpbmQ9XFxcImNsaWNrOiBjaGFuZ2VTZWxlY3RlZEl0ZW0sIGV2ZW50OiB7IGRibGNsaWNrOiBhZGRJdGVtIH1cXFwiPjwvZGl2PlxcbiAgPGRpdiBjbGFzcz1cXFwiaW1nLXJvdW5kZWQgaXRlbXMtc3ByaXRlLTUweDM2IGl0ZW1zLXNwcml0ZS1oZWxtX29mX2lyb25fd2lsbFxcXCIgaWQ9XFxcImhlbG1fb2ZfaXJvbl93aWxsXFxcIiBkYXRhLWJpbmQ9XFxcImNsaWNrOiBjaGFuZ2VTZWxlY3RlZEl0ZW0sIGV2ZW50OiB7IGRibGNsaWNrOiBhZGRJdGVtIH1cXFwiPjwvZGl2PlxcbiAgPGRpdiBjbGFzcz1cXFwiaW1nLXJvdW5kZWQgaXRlbXMtc3ByaXRlLTUweDM2IGl0ZW1zLXNwcml0ZS1icm9hZHN3b3JkXFxcIiBpZD1cXFwiYnJvYWRzd29yZFxcXCIgZGF0YS1iaW5kPVxcXCJjbGljazogY2hhbmdlU2VsZWN0ZWRJdGVtLCBldmVudDogeyBkYmxjbGljazogYWRkSXRlbSB9XFxcIj48L2Rpdj5cXG4gIDxkaXYgY2xhc3M9XFxcImltZy1yb3VuZGVkIGl0ZW1zLXNwcml0ZS01MHgzNiBpdGVtcy1zcHJpdGUtY2xheW1vcmVcXFwiIGlkPVxcXCJjbGF5bW9yZVxcXCIgZGF0YS1iaW5kPVxcXCJjbGljazogY2hhbmdlU2VsZWN0ZWRJdGVtLCBldmVudDogeyBkYmxjbGljazogYWRkSXRlbSB9XFxcIj48L2Rpdj5cXG4gIDxkaXYgY2xhc3M9XFxcImltZy1yb3VuZGVkIGl0ZW1zLXNwcml0ZS01MHgzNiBpdGVtcy1zcHJpdGUtamF2ZWxpblxcXCIgaWQ9XFxcImphdmVsaW5cXFwiIGRhdGEtYmluZD1cXFwiY2xpY2s6IGNoYW5nZVNlbGVjdGVkSXRlbSwgZXZlbnQ6IHsgZGJsY2xpY2s6IGFkZEl0ZW0gfVxcXCI+PC9kaXY+XFxuICA8ZGl2IGNsYXNzPVxcXCJpbWctcm91bmRlZCBpdGVtcy1zcHJpdGUtNTB4MzYgaXRlbXMtc3ByaXRlLW1pdGhyaWxfaGFtbWVyXFxcIiBpZD1cXFwibWl0aHJpbF9oYW1tZXJcXFwiIGRhdGEtYmluZD1cXFwiY2xpY2s6IGNoYW5nZVNlbGVjdGVkSXRlbSwgZXZlbnQ6IHsgZGJsY2xpY2s6IGFkZEl0ZW0gfVxcXCI+PC9kaXY+XFxuPC9kaXY+XFxuPGRpdiBjbGFzcz1cXFwic2hvcC1jb2x1bW5cXFwiPlxcbiAgPGRpdiBjbGFzcz1cXFwiaGMtc2hvcCBoYy1zaG9wLWFyY2FuZVxcXCIgaWQ9XFxcImFyY2FuZVxcXCI+PC9kaXY+XFxuICA8ZGl2IGNsYXNzPVxcXCJpbWctcm91bmRlZCBpdGVtcy1zcHJpdGUtNTB4MzYgaXRlbXMtc3ByaXRlLXdpbmRfbGFjZVxcXCIgaWQ9XFxcIndpbmRfbGFjZVxcXCIgZGF0YS1iaW5kPVxcXCJjbGljazogY2hhbmdlU2VsZWN0ZWRJdGVtLCBldmVudDogeyBkYmxjbGljazogYWRkSXRlbSB9XFxcIj48L2Rpdj5cXG4gIDxkaXYgY2xhc3M9XFxcImltZy1yb3VuZGVkIGl0ZW1zLXNwcml0ZS01MHgzNiBpdGVtcy1zcHJpdGUtbWFnaWNfc3RpY2tcXFwiIGlkPVxcXCJtYWdpY19zdGlja1xcXCIgZGF0YS1iaW5kPVxcXCJjbGljazogY2hhbmdlU2VsZWN0ZWRJdGVtLCBldmVudDogeyBkYmxjbGljazogYWRkSXRlbSB9XFxcIj48L2Rpdj5cXG4gIDxkaXYgY2xhc3M9XFxcImltZy1yb3VuZGVkIGl0ZW1zLXNwcml0ZS01MHgzNiBpdGVtcy1zcHJpdGUtc29iaV9tYXNrXFxcIiBpZD1cXFwic29iaV9tYXNrXFxcIiBkYXRhLWJpbmQ9XFxcImNsaWNrOiBjaGFuZ2VTZWxlY3RlZEl0ZW0sIGV2ZW50OiB7IGRibGNsaWNrOiBhZGRJdGVtIH1cXFwiPjwvZGl2PlxcbiAgPGRpdiBjbGFzcz1cXFwiaW1nLXJvdW5kZWQgaXRlbXMtc3ByaXRlLTUweDM2IGl0ZW1zLXNwcml0ZS1yaW5nX29mX3JlZ2VuXFxcIiBpZD1cXFwicmluZ19vZl9yZWdlblxcXCIgZGF0YS1iaW5kPVxcXCJjbGljazogY2hhbmdlU2VsZWN0ZWRJdGVtLCBldmVudDogeyBkYmxjbGljazogYWRkSXRlbSB9XFxcIj48L2Rpdj5cXG4gIDxkaXYgY2xhc3M9XFxcImltZy1yb3VuZGVkIGl0ZW1zLXNwcml0ZS01MHgzNiBpdGVtcy1zcHJpdGUtYm9vdHNcXFwiIGlkPVxcXCJib290c1xcXCIgZGF0YS1iaW5kPVxcXCJjbGljazogY2hhbmdlU2VsZWN0ZWRJdGVtLCBldmVudDogeyBkYmxjbGljazogYWRkSXRlbSB9XFxcIj48L2Rpdj5cXG4gIDxkaXYgY2xhc3M9XFxcImltZy1yb3VuZGVkIGl0ZW1zLXNwcml0ZS01MHgzNiBpdGVtcy1zcHJpdGUtZ2xvdmVzXFxcIiBpZD1cXFwiZ2xvdmVzXFxcIiBkYXRhLWJpbmQ9XFxcImNsaWNrOiBjaGFuZ2VTZWxlY3RlZEl0ZW0sIGV2ZW50OiB7IGRibGNsaWNrOiBhZGRJdGVtIH1cXFwiPjwvZGl2PlxcbiAgPGRpdiBjbGFzcz1cXFwiaW1nLXJvdW5kZWQgaXRlbXMtc3ByaXRlLTUweDM2IGl0ZW1zLXNwcml0ZS1jbG9ha1xcXCIgaWQ9XFxcImNsb2FrXFxcIiBkYXRhLWJpbmQ9XFxcImNsaWNrOiBjaGFuZ2VTZWxlY3RlZEl0ZW0sIGV2ZW50OiB7IGRibGNsaWNrOiBhZGRJdGVtIH1cXFwiPjwvZGl2PlxcbiAgPGRpdiBjbGFzcz1cXFwiaW1nLXJvdW5kZWQgaXRlbXMtc3ByaXRlLTUweDM2IGl0ZW1zLXNwcml0ZS1yaW5nX29mX2hlYWx0aFxcXCIgaWQ9XFxcInJpbmdfb2ZfaGVhbHRoXFxcIiBkYXRhLWJpbmQ9XFxcImNsaWNrOiBjaGFuZ2VTZWxlY3RlZEl0ZW0sIGV2ZW50OiB7IGRibGNsaWNrOiBhZGRJdGVtIH1cXFwiPjwvZGl2PlxcbiAgPGRpdiBjbGFzcz1cXFwiaW1nLXJvdW5kZWQgaXRlbXMtc3ByaXRlLTUweDM2IGl0ZW1zLXNwcml0ZS12b2lkX3N0b25lXFxcIiBpZD1cXFwidm9pZF9zdG9uZVxcXCIgZGF0YS1iaW5kPVxcXCJjbGljazogY2hhbmdlU2VsZWN0ZWRJdGVtLCBldmVudDogeyBkYmxjbGljazogYWRkSXRlbSB9XFxcIj48L2Rpdj5cXG4gIDxkaXYgY2xhc3M9XFxcImltZy1yb3VuZGVkIGl0ZW1zLXNwcml0ZS01MHgzNiBpdGVtcy1zcHJpdGUtZ2VtXFxcIiBpZD1cXFwiZ2VtXFxcIiBkYXRhLWJpbmQ9XFxcImNsaWNrOiBjaGFuZ2VTZWxlY3RlZEl0ZW0sIGV2ZW50OiB7IGRibGNsaWNrOiBhZGRJdGVtIH1cXFwiPjwvZGl2PlxcbiAgPGRpdiBjbGFzcz1cXFwiaW1nLXJvdW5kZWQgaXRlbXMtc3ByaXRlLTUweDM2IGl0ZW1zLXNwcml0ZS1saWZlc3RlYWxcXFwiIGlkPVxcXCJsaWZlc3RlYWxcXFwiIGRhdGEtYmluZD1cXFwiY2xpY2s6IGNoYW5nZVNlbGVjdGVkSXRlbSwgZXZlbnQ6IHsgZGJsY2xpY2s6IGFkZEl0ZW0gfVxcXCI+PC9kaXY+XFxuICA8ZGl2IGNsYXNzPVxcXCJpbWctcm91bmRlZCBpdGVtcy1zcHJpdGUtNTB4MzYgaXRlbXMtc3ByaXRlLXNoYWRvd19hbXVsZXRcXFwiIGlkPVxcXCJzaGFkb3dfYW11bGV0XFxcIiBkYXRhLWJpbmQ9XFxcImNsaWNrOiBjaGFuZ2VTZWxlY3RlZEl0ZW0sIGV2ZW50OiB7IGRibGNsaWNrOiBhZGRJdGVtIH1cXFwiPjwvZGl2PlxcbiAgPGRpdiBjbGFzcz1cXFwiaW1nLXJvdW5kZWQgaXRlbXMtc3ByaXRlLTUweDM2IGl0ZW1zLXNwcml0ZS1naG9zdFxcXCIgaWQ9XFxcImdob3N0XFxcIiBkYXRhLWJpbmQ9XFxcImNsaWNrOiBjaGFuZ2VTZWxlY3RlZEl0ZW0sIGV2ZW50OiB7IGRibGNsaWNrOiBhZGRJdGVtIH1cXFwiPjwvZGl2PlxcbiAgPGRpdiBjbGFzcz1cXFwiaW1nLXJvdW5kZWQgaXRlbXMtc3ByaXRlLTUweDM2IGl0ZW1zLXNwcml0ZS1ibGlua1xcXCIgaWQ9XFxcImJsaW5rXFxcIiBkYXRhLWJpbmQ9XFxcImNsaWNrOiBjaGFuZ2VTZWxlY3RlZEl0ZW0sIGV2ZW50OiB7IGRibGNsaWNrOiBhZGRJdGVtIH1cXFwiPjwvZGl2PlxcbjwvZGl2PlxcblxcblxcbiAgICAgICAgICAgICAgICA8L2Rpdj5cXG4gICAgICAgICAgICAgICAgPGRpdiBjbGFzcz1cXFwidGFiLXBhbmVcXFwiIGlkPVxcXCJzaG9wX3VwZ3JhZGVcXFwiPlxcbjxkaXYgY2xhc3M9XFxcInNob3AtY29sdW1uXFxcIj5cXG4gIDxkaXYgY2xhc3M9XFxcImhjLXNob3AgaGMtc2hvcC1jb21tb25cXFwiIGlkPVxcXCJjb21tb25cXFwiPjwvZGl2PlxcbiAgPGRpdiBjbGFzcz1cXFwiaW1nLXJvdW5kZWQgaXRlbXMtc3ByaXRlLTUweDM2IGl0ZW1zLXNwcml0ZS1tYWdpY193YW5kXFxcIiBpZD1cXFwibWFnaWNfd2FuZFxcXCIgZGF0YS1iaW5kPVxcXCJjbGljazogY2hhbmdlU2VsZWN0ZWRJdGVtLCBldmVudDogeyBkYmxjbGljazogYWRkSXRlbSB9XFxcIj48L2Rpdj5cXG4gIDxkaXYgY2xhc3M9XFxcImltZy1yb3VuZGVkIGl0ZW1zLXNwcml0ZS01MHgzNiBpdGVtcy1zcHJpdGUtbnVsbF90YWxpc21hblxcXCIgaWQ9XFxcIm51bGxfdGFsaXNtYW5cXFwiIGRhdGEtYmluZD1cXFwiY2xpY2s6IGNoYW5nZVNlbGVjdGVkSXRlbSwgZXZlbnQ6IHsgZGJsY2xpY2s6IGFkZEl0ZW0gfVxcXCI+PC9kaXY+XFxuICA8ZGl2IGNsYXNzPVxcXCJpbWctcm91bmRlZCBpdGVtcy1zcHJpdGUtNTB4MzYgaXRlbXMtc3ByaXRlLXdyYWl0aF9iYW5kXFxcIiBpZD1cXFwid3JhaXRoX2JhbmRcXFwiIGRhdGEtYmluZD1cXFwiY2xpY2s6IGNoYW5nZVNlbGVjdGVkSXRlbSwgZXZlbnQ6IHsgZGJsY2xpY2s6IGFkZEl0ZW0gfVxcXCI+PC9kaXY+XFxuICA8ZGl2IGNsYXNzPVxcXCJpbWctcm91bmRlZCBpdGVtcy1zcHJpdGUtNTB4MzYgaXRlbXMtc3ByaXRlLXBvb3JfbWFuc19zaGllbGRcXFwiIGlkPVxcXCJwb29yX21hbnNfc2hpZWxkXFxcIiBkYXRhLWJpbmQ9XFxcImNsaWNrOiBjaGFuZ2VTZWxlY3RlZEl0ZW0sIGV2ZW50OiB7IGRibGNsaWNrOiBhZGRJdGVtIH1cXFwiPjwvZGl2PlxcbiAgPGRpdiBjbGFzcz1cXFwiaW1nLXJvdW5kZWQgaXRlbXMtc3ByaXRlLTUweDM2IGl0ZW1zLXNwcml0ZS1icmFjZXJcXFwiIGlkPVxcXCJicmFjZXJcXFwiIGRhdGEtYmluZD1cXFwiY2xpY2s6IGNoYW5nZVNlbGVjdGVkSXRlbSwgZXZlbnQ6IHsgZGJsY2xpY2s6IGFkZEl0ZW0gfVxcXCI+PC9kaXY+XFxuICA8ZGl2IGNsYXNzPVxcXCJpbWctcm91bmRlZCBpdGVtcy1zcHJpdGUtNTB4MzYgaXRlbXMtc3ByaXRlLXNvdWxfcmluZ1xcXCIgaWQ9XFxcInNvdWxfcmluZ1xcXCIgZGF0YS1iaW5kPVxcXCJjbGljazogY2hhbmdlU2VsZWN0ZWRJdGVtLCBldmVudDogeyBkYmxjbGljazogYWRkSXRlbSB9XFxcIj48L2Rpdj5cXG4gIDxkaXYgY2xhc3M9XFxcImltZy1yb3VuZGVkIGl0ZW1zLXNwcml0ZS01MHgzNiBpdGVtcy1zcHJpdGUtcGhhc2VfYm9vdHNcXFwiIGlkPVxcXCJwaGFzZV9ib290c1xcXCIgZGF0YS1iaW5kPVxcXCJjbGljazogY2hhbmdlU2VsZWN0ZWRJdGVtLCBldmVudDogeyBkYmxjbGljazogYWRkSXRlbSB9XFxcIj48L2Rpdj5cXG4gIDxkaXYgY2xhc3M9XFxcImltZy1yb3VuZGVkIGl0ZW1zLXNwcml0ZS01MHgzNiBpdGVtcy1zcHJpdGUtcG93ZXJfdHJlYWRzXFxcIiBpZD1cXFwicG93ZXJfdHJlYWRzXFxcIiBkYXRhLWJpbmQ9XFxcImNsaWNrOiBjaGFuZ2VTZWxlY3RlZEl0ZW0sIGV2ZW50OiB7IGRibGNsaWNrOiBhZGRJdGVtIH1cXFwiPjwvZGl2PlxcbiAgPGRpdiBjbGFzcz1cXFwiaW1nLXJvdW5kZWQgaXRlbXMtc3ByaXRlLTUweDM2IGl0ZW1zLXNwcml0ZS1vYmxpdmlvbl9zdGFmZlxcXCIgaWQ9XFxcIm9ibGl2aW9uX3N0YWZmXFxcIiBkYXRhLWJpbmQ9XFxcImNsaWNrOiBjaGFuZ2VTZWxlY3RlZEl0ZW0sIGV2ZW50OiB7IGRibGNsaWNrOiBhZGRJdGVtIH1cXFwiPjwvZGl2PlxcbiAgPGRpdiBjbGFzcz1cXFwiaW1nLXJvdW5kZWQgaXRlbXMtc3ByaXRlLTUweDM2IGl0ZW1zLXNwcml0ZS1wZXJzXFxcIiBpZD1cXFwicGVyc1xcXCIgZGF0YS1iaW5kPVxcXCJjbGljazogY2hhbmdlU2VsZWN0ZWRJdGVtLCBldmVudDogeyBkYmxjbGljazogYWRkSXRlbSB9XFxcIj48L2Rpdj5cXG4gIDxkaXYgY2xhc3M9XFxcImltZy1yb3VuZGVkIGl0ZW1zLXNwcml0ZS01MHgzNiBpdGVtcy1zcHJpdGUtaGFuZF9vZl9taWRhc1xcXCIgaWQ9XFxcImhhbmRfb2ZfbWlkYXNcXFwiIGRhdGEtYmluZD1cXFwiY2xpY2s6IGNoYW5nZVNlbGVjdGVkSXRlbSwgZXZlbnQ6IHsgZGJsY2xpY2s6IGFkZEl0ZW0gfVxcXCI+PC9kaXY+XFxuICA8ZGl2IGNsYXNzPVxcXCJpbWctcm91bmRlZCBpdGVtcy1zcHJpdGUtNTB4MzYgaXRlbXMtc3ByaXRlLXRyYXZlbF9ib290c1xcXCIgaWQ9XFxcInRyYXZlbF9ib290c1xcXCIgZGF0YS1iaW5kPVxcXCJjbGljazogY2hhbmdlU2VsZWN0ZWRJdGVtLCBldmVudDogeyBkYmxjbGljazogYWRkSXRlbSB9XFxcIj48L2Rpdj5cXG4gIDxkaXYgY2xhc3M9XFxcImltZy1yb3VuZGVkIGl0ZW1zLXNwcml0ZS01MHgzNiBpdGVtcy1zcHJpdGUtbW9vbl9zaGFyZFxcXCIgaWQ9XFxcIm1vb25fc2hhcmRcXFwiIGRhdGEtYmluZD1cXFwiY2xpY2s6IGNoYW5nZVNlbGVjdGVkSXRlbSwgZXZlbnQ6IHsgZGJsY2xpY2s6IGFkZEl0ZW0gfVxcXCI+PC9kaXY+XFxuICA8ZGl2IGNsYXNzPVxcXCJpbWctcm91bmRlZCBpdGVtcy1zcHJpdGUtNTB4MzYgaXRlbXMtc3ByaXRlLWVtcHR5aXRlbWJnXFxcIiBpZD1cXFwiZW1wdHlpdGVtYmdcXFwiPjwvZGl2PlxcbjwvZGl2PlxcbjxkaXYgY2xhc3M9XFxcInNob3AtY29sdW1uXFxcIj5cXG4gIDxkaXYgY2xhc3M9XFxcImhjLXNob3AgaGMtc2hvcC1zdXBwb3J0XFxcIiBpZD1cXFwic3VwcG9ydFxcXCI+PC9kaXY+XFxuICA8ZGl2IGNsYXNzPVxcXCJpbWctcm91bmRlZCBpdGVtcy1zcHJpdGUtNTB4MzYgaXRlbXMtc3ByaXRlLXJpbmdfb2ZfYmFzaWxpdXNcXFwiIGlkPVxcXCJyaW5nX29mX2Jhc2lsaXVzXFxcIiBkYXRhLWJpbmQ9XFxcImNsaWNrOiBjaGFuZ2VTZWxlY3RlZEl0ZW0sIGV2ZW50OiB7IGRibGNsaWNrOiBhZGRJdGVtIH1cXFwiPjwvZGl2PlxcbiAgPGRpdiBjbGFzcz1cXFwiaW1nLXJvdW5kZWQgaXRlbXMtc3ByaXRlLTUweDM2IGl0ZW1zLXNwcml0ZS1pcm9uX3RhbG9uXFxcIiBpZD1cXFwiaXJvbl90YWxvblxcXCIgZGF0YS1iaW5kPVxcXCJjbGljazogY2hhbmdlU2VsZWN0ZWRJdGVtLCBldmVudDogeyBkYmxjbGljazogYWRkSXRlbSB9XFxcIj48L2Rpdj5cXG4gIDxkaXYgY2xhc3M9XFxcImltZy1yb3VuZGVkIGl0ZW1zLXNwcml0ZS01MHgzNiBpdGVtcy1zcHJpdGUtaGVhZGRyZXNzXFxcIiBpZD1cXFwiaGVhZGRyZXNzXFxcIiBkYXRhLWJpbmQ9XFxcImNsaWNrOiBjaGFuZ2VTZWxlY3RlZEl0ZW0sIGV2ZW50OiB7IGRibGNsaWNrOiBhZGRJdGVtIH1cXFwiPjwvZGl2PlxcbiAgPGRpdiBjbGFzcz1cXFwiaW1nLXJvdW5kZWQgaXRlbXMtc3ByaXRlLTUweDM2IGl0ZW1zLXNwcml0ZS1idWNrbGVyXFxcIiBpZD1cXFwiYnVja2xlclxcXCIgZGF0YS1iaW5kPVxcXCJjbGljazogY2hhbmdlU2VsZWN0ZWRJdGVtLCBldmVudDogeyBkYmxjbGljazogYWRkSXRlbSB9XFxcIj48L2Rpdj5cXG4gIDxkaXYgY2xhc3M9XFxcImltZy1yb3VuZGVkIGl0ZW1zLXNwcml0ZS01MHgzNiBpdGVtcy1zcHJpdGUtdXJuX29mX3NoYWRvd3NcXFwiIGlkPVxcXCJ1cm5fb2Zfc2hhZG93c1xcXCIgZGF0YS1iaW5kPVxcXCJjbGljazogY2hhbmdlU2VsZWN0ZWRJdGVtLCBldmVudDogeyBkYmxjbGljazogYWRkSXRlbSB9XFxcIj48L2Rpdj5cXG4gIDxkaXYgY2xhc3M9XFxcImltZy1yb3VuZGVkIGl0ZW1zLXNwcml0ZS01MHgzNiBpdGVtcy1zcHJpdGUtdHJhbnF1aWxfYm9vdHNcXFwiIGlkPVxcXCJ0cmFucXVpbF9ib290c1xcXCIgZGF0YS1iaW5kPVxcXCJjbGljazogY2hhbmdlU2VsZWN0ZWRJdGVtLCBldmVudDogeyBkYmxjbGljazogYWRkSXRlbSB9XFxcIj48L2Rpdj5cXG4gIDxkaXYgY2xhc3M9XFxcImltZy1yb3VuZGVkIGl0ZW1zLXNwcml0ZS01MHgzNiBpdGVtcy1zcHJpdGUtcmluZ19vZl9hcXVpbGFcXFwiIGlkPVxcXCJyaW5nX29mX2FxdWlsYVxcXCIgZGF0YS1iaW5kPVxcXCJjbGljazogY2hhbmdlU2VsZWN0ZWRJdGVtLCBldmVudDogeyBkYmxjbGljazogYWRkSXRlbSB9XFxcIj48L2Rpdj5cXG4gIDxkaXYgY2xhc3M9XFxcImltZy1yb3VuZGVkIGl0ZW1zLXNwcml0ZS01MHgzNiBpdGVtcy1zcHJpdGUtbWVkYWxsaW9uX29mX2NvdXJhZ2VcXFwiIGlkPVxcXCJtZWRhbGxpb25fb2ZfY291cmFnZVxcXCIgZGF0YS1iaW5kPVxcXCJjbGljazogY2hhbmdlU2VsZWN0ZWRJdGVtLCBldmVudDogeyBkYmxjbGljazogYWRkSXRlbSB9XFxcIj48L2Rpdj5cXG4gIDxkaXYgY2xhc3M9XFxcImltZy1yb3VuZGVkIGl0ZW1zLXNwcml0ZS01MHgzNiBpdGVtcy1zcHJpdGUtYXJjYW5lX2Jvb3RzXFxcIiBpZD1cXFwiYXJjYW5lX2Jvb3RzXFxcIiBkYXRhLWJpbmQ9XFxcImNsaWNrOiBjaGFuZ2VTZWxlY3RlZEl0ZW0sIGV2ZW50OiB7IGRibGNsaWNrOiBhZGRJdGVtIH1cXFwiPjwvZGl2PlxcbiAgPGRpdiBjbGFzcz1cXFwiaW1nLXJvdW5kZWQgaXRlbXMtc3ByaXRlLTUweDM2IGl0ZW1zLXNwcml0ZS1hbmNpZW50X2phbmdnb1xcXCIgaWQ9XFxcImFuY2llbnRfamFuZ2dvXFxcIiBkYXRhLWJpbmQ9XFxcImNsaWNrOiBjaGFuZ2VTZWxlY3RlZEl0ZW0sIGV2ZW50OiB7IGRibGNsaWNrOiBhZGRJdGVtIH1cXFwiPjwvZGl2PlxcbiAgPGRpdiBjbGFzcz1cXFwiaW1nLXJvdW5kZWQgaXRlbXMtc3ByaXRlLTUweDM2IGl0ZW1zLXNwcml0ZS1tZWthbnNtXFxcIiBpZD1cXFwibWVrYW5zbVxcXCIgZGF0YS1iaW5kPVxcXCJjbGljazogY2hhbmdlU2VsZWN0ZWRJdGVtLCBldmVudDogeyBkYmxjbGljazogYWRkSXRlbSB9XFxcIj48L2Rpdj5cXG4gIDxkaXYgY2xhc3M9XFxcImltZy1yb3VuZGVkIGl0ZW1zLXNwcml0ZS01MHgzNiBpdGVtcy1zcHJpdGUtdmxhZG1pclxcXCIgaWQ9XFxcInZsYWRtaXJcXFwiIGRhdGEtYmluZD1cXFwiY2xpY2s6IGNoYW5nZVNlbGVjdGVkSXRlbSwgZXZlbnQ6IHsgZGJsY2xpY2s6IGFkZEl0ZW0gfVxcXCI+PC9kaXY+XFxuICA8ZGl2IGNsYXNzPVxcXCJpbWctcm91bmRlZCBpdGVtcy1zcHJpdGUtNTB4MzYgaXRlbXMtc3ByaXRlLXBpcGVcXFwiIGlkPVxcXCJwaXBlXFxcIiBkYXRhLWJpbmQ9XFxcImNsaWNrOiBjaGFuZ2VTZWxlY3RlZEl0ZW0sIGV2ZW50OiB7IGRibGNsaWNrOiBhZGRJdGVtIH1cXFwiPjwvZGl2PlxcbiAgPGRpdiBjbGFzcz1cXFwiaW1nLXJvdW5kZWQgaXRlbXMtc3ByaXRlLTUweDM2IGl0ZW1zLXNwcml0ZS1ndWFyZGlhbl9ncmVhdmVzXFxcIiBpZD1cXFwiZ3VhcmRpYW5fZ3JlYXZlc1xcXCIgZGF0YS1iaW5kPVxcXCJjbGljazogY2hhbmdlU2VsZWN0ZWRJdGVtLCBldmVudDogeyBkYmxjbGljazogYWRkSXRlbSB9XFxcIj48L2Rpdj5cXG48L2Rpdj5cXG48ZGl2IGNsYXNzPVxcXCJzaG9wLWNvbHVtblxcXCI+XFxuICA8ZGl2IGNsYXNzPVxcXCJoYy1zaG9wIGhjLXNob3AtY2FzdGVyXFxcIiBpZD1cXFwiY2FzdGVyXFxcIj48L2Rpdj5cXG4gIDxkaXYgY2xhc3M9XFxcImltZy1yb3VuZGVkIGl0ZW1zLXNwcml0ZS01MHgzNiBpdGVtcy1zcHJpdGUtZ2xpbW1lcl9jYXBlXFxcIiBpZD1cXFwiZ2xpbW1lcl9jYXBlXFxcIiBkYXRhLWJpbmQ9XFxcImNsaWNrOiBjaGFuZ2VTZWxlY3RlZEl0ZW0sIGV2ZW50OiB7IGRibGNsaWNrOiBhZGRJdGVtIH1cXFwiPjwvZGl2PlxcbiAgPGRpdiBjbGFzcz1cXFwiaW1nLXJvdW5kZWQgaXRlbXMtc3ByaXRlLTUweDM2IGl0ZW1zLXNwcml0ZS1mb3JjZV9zdGFmZlxcXCIgaWQ9XFxcImZvcmNlX3N0YWZmXFxcIiBkYXRhLWJpbmQ9XFxcImNsaWNrOiBjaGFuZ2VTZWxlY3RlZEl0ZW0sIGV2ZW50OiB7IGRibGNsaWNrOiBhZGRJdGVtIH1cXFwiPjwvZGl2PlxcbiAgPGRpdiBjbGFzcz1cXFwiaW1nLXJvdW5kZWQgaXRlbXMtc3ByaXRlLTUweDM2IGl0ZW1zLXNwcml0ZS12ZWlsX29mX2Rpc2NvcmRcXFwiIGlkPVxcXCJ2ZWlsX29mX2Rpc2NvcmRcXFwiIGRhdGEtYmluZD1cXFwiY2xpY2s6IGNoYW5nZVNlbGVjdGVkSXRlbSwgZXZlbnQ6IHsgZGJsY2xpY2s6IGFkZEl0ZW0gfVxcXCI+PC9kaXY+XFxuICA8ZGl2IGNsYXNzPVxcXCJpbWctcm91bmRlZCBpdGVtcy1zcHJpdGUtNTB4MzYgaXRlbXMtc3ByaXRlLWFldGhlcl9sZW5zXFxcIiBpZD1cXFwiYWV0aGVyX2xlbnNcXFwiIGRhdGEtYmluZD1cXFwiY2xpY2s6IGNoYW5nZVNlbGVjdGVkSXRlbSwgZXZlbnQ6IHsgZGJsY2xpY2s6IGFkZEl0ZW0gfVxcXCI+PC9kaXY+XFxuICA8ZGl2IGNsYXNzPVxcXCJpbWctcm91bmRlZCBpdGVtcy1zcHJpdGUtNTB4MzYgaXRlbXMtc3ByaXRlLW5lY3Jvbm9taWNvblxcXCIgaWQ9XFxcIm5lY3Jvbm9taWNvblxcXCIgZGF0YS1iaW5kPVxcXCJjbGljazogY2hhbmdlU2VsZWN0ZWRJdGVtLCBldmVudDogeyBkYmxjbGljazogYWRkSXRlbSB9XFxcIj48L2Rpdj5cXG4gIDxkaXYgY2xhc3M9XFxcImltZy1yb3VuZGVkIGl0ZW1zLXNwcml0ZS01MHgzNiBpdGVtcy1zcHJpdGUtZGFnb25cXFwiIGlkPVxcXCJkYWdvblxcXCIgZGF0YS1iaW5kPVxcXCJjbGljazogY2hhbmdlU2VsZWN0ZWRJdGVtLCBldmVudDogeyBkYmxjbGljazogYWRkSXRlbSB9XFxcIj48L2Rpdj5cXG4gIDxkaXYgY2xhc3M9XFxcImltZy1yb3VuZGVkIGl0ZW1zLXNwcml0ZS01MHgzNiBpdGVtcy1zcHJpdGUtY3ljbG9uZVxcXCIgaWQ9XFxcImN5Y2xvbmVcXFwiIGRhdGEtYmluZD1cXFwiY2xpY2s6IGNoYW5nZVNlbGVjdGVkSXRlbSwgZXZlbnQ6IHsgZGJsY2xpY2s6IGFkZEl0ZW0gfVxcXCI+PC9kaXY+XFxuICA8ZGl2IGNsYXNzPVxcXCJpbWctcm91bmRlZCBpdGVtcy1zcHJpdGUtNTB4MzYgaXRlbXMtc3ByaXRlLXNvbGFyX2NyZXN0XFxcIiBpZD1cXFwic29sYXJfY3Jlc3RcXFwiIGRhdGEtYmluZD1cXFwiY2xpY2s6IGNoYW5nZVNlbGVjdGVkSXRlbSwgZXZlbnQ6IHsgZGJsY2xpY2s6IGFkZEl0ZW0gfVxcXCI+PC9kaXY+XFxuICA8ZGl2IGNsYXNzPVxcXCJpbWctcm91bmRlZCBpdGVtcy1zcHJpdGUtNTB4MzYgaXRlbXMtc3ByaXRlLXJvZF9vZl9hdG9zXFxcIiBpZD1cXFwicm9kX29mX2F0b3NcXFwiIGRhdGEtYmluZD1cXFwiY2xpY2s6IGNoYW5nZVNlbGVjdGVkSXRlbSwgZXZlbnQ6IHsgZGJsY2xpY2s6IGFkZEl0ZW0gfVxcXCI+PC9kaXY+XFxuICA8ZGl2IGNsYXNzPVxcXCJpbWctcm91bmRlZCBpdGVtcy1zcHJpdGUtNTB4MzYgaXRlbXMtc3ByaXRlLW9yY2hpZFxcXCIgaWQ9XFxcIm9yY2hpZFxcXCIgZGF0YS1iaW5kPVxcXCJjbGljazogY2hhbmdlU2VsZWN0ZWRJdGVtLCBldmVudDogeyBkYmxjbGljazogYWRkSXRlbSB9XFxcIj48L2Rpdj5cXG4gIDxkaXYgY2xhc3M9XFxcImltZy1yb3VuZGVkIGl0ZW1zLXNwcml0ZS01MHgzNiBpdGVtcy1zcHJpdGUtdWx0aW1hdGVfc2NlcHRlclxcXCIgaWQ9XFxcInVsdGltYXRlX3NjZXB0ZXJcXFwiIGRhdGEtYmluZD1cXFwiY2xpY2s6IGNoYW5nZVNlbGVjdGVkSXRlbSwgZXZlbnQ6IHsgZGJsY2xpY2s6IGFkZEl0ZW0gfVxcXCI+PC9kaXY+XFxuICA8ZGl2IGNsYXNzPVxcXCJpbWctcm91bmRlZCBpdGVtcy1zcHJpdGUtNTB4MzYgaXRlbXMtc3ByaXRlLXJlZnJlc2hlclxcXCIgaWQ9XFxcInJlZnJlc2hlclxcXCIgZGF0YS1iaW5kPVxcXCJjbGljazogY2hhbmdlU2VsZWN0ZWRJdGVtLCBldmVudDogeyBkYmxjbGljazogYWRkSXRlbSB9XFxcIj48L2Rpdj5cXG4gIDxkaXYgY2xhc3M9XFxcImltZy1yb3VuZGVkIGl0ZW1zLXNwcml0ZS01MHgzNiBpdGVtcy1zcHJpdGUtc2hlZXBzdGlja1xcXCIgaWQ9XFxcInNoZWVwc3RpY2tcXFwiIGRhdGEtYmluZD1cXFwiY2xpY2s6IGNoYW5nZVNlbGVjdGVkSXRlbSwgZXZlbnQ6IHsgZGJsY2xpY2s6IGFkZEl0ZW0gfVxcXCI+PC9kaXY+XFxuICA8ZGl2IGNsYXNzPVxcXCJpbWctcm91bmRlZCBpdGVtcy1zcHJpdGUtNTB4MzYgaXRlbXMtc3ByaXRlLW9jdGFyaW5lX2NvcmVcXFwiIGlkPVxcXCJvY3RhcmluZV9jb3JlXFxcIiBkYXRhLWJpbmQ9XFxcImNsaWNrOiBjaGFuZ2VTZWxlY3RlZEl0ZW0sIGV2ZW50OiB7IGRibGNsaWNrOiBhZGRJdGVtIH1cXFwiPjwvZGl2PlxcbjwvZGl2PlxcbjxkaXYgY2xhc3M9XFxcInNob3AtY29sdW1uXFxcIj5cXG4gIDxkaXYgY2xhc3M9XFxcImhjLXNob3AgaGMtc2hvcC13ZWFwb25zXFxcIiBpZD1cXFwid2VhcG9uc1xcXCI+PC9kaXY+XFxuICA8ZGl2IGNsYXNzPVxcXCJpbWctcm91bmRlZCBpdGVtcy1zcHJpdGUtNTB4MzYgaXRlbXMtc3ByaXRlLWxlc3Nlcl9jcml0XFxcIiBpZD1cXFwibGVzc2VyX2NyaXRcXFwiIGRhdGEtYmluZD1cXFwiY2xpY2s6IGNoYW5nZVNlbGVjdGVkSXRlbSwgZXZlbnQ6IHsgZGJsY2xpY2s6IGFkZEl0ZW0gfVxcXCI+PC9kaXY+XFxuICA8ZGl2IGNsYXNzPVxcXCJpbWctcm91bmRlZCBpdGVtcy1zcHJpdGUtNTB4MzYgaXRlbXMtc3ByaXRlLWFybWxldFxcXCIgaWQ9XFxcImFybWxldFxcXCIgZGF0YS1iaW5kPVxcXCJjbGljazogY2hhbmdlU2VsZWN0ZWRJdGVtLCBldmVudDogeyBkYmxjbGljazogYWRkSXRlbSB9XFxcIj48L2Rpdj5cXG4gIDxkaXYgY2xhc3M9XFxcImltZy1yb3VuZGVkIGl0ZW1zLXNwcml0ZS01MHgzNiBpdGVtcy1zcHJpdGUtaW52aXNfc3dvcmRcXFwiIGlkPVxcXCJpbnZpc19zd29yZFxcXCIgZGF0YS1iaW5kPVxcXCJjbGljazogY2hhbmdlU2VsZWN0ZWRJdGVtLCBldmVudDogeyBkYmxjbGljazogYWRkSXRlbSB9XFxcIj48L2Rpdj5cXG4gIDxkaXYgY2xhc3M9XFxcImltZy1yb3VuZGVkIGl0ZW1zLXNwcml0ZS01MHgzNiBpdGVtcy1zcHJpdGUtYmFzaGVyXFxcIiBpZD1cXFwiYmFzaGVyXFxcIiBkYXRhLWJpbmQ9XFxcImNsaWNrOiBjaGFuZ2VTZWxlY3RlZEl0ZW0sIGV2ZW50OiB7IGRibGNsaWNrOiBhZGRJdGVtIH1cXFwiPjwvZGl2PlxcbiAgPGRpdiBjbGFzcz1cXFwiaW1nLXJvdW5kZWQgaXRlbXMtc3ByaXRlLTUweDM2IGl0ZW1zLXNwcml0ZS1iZnVyeVxcXCIgaWQ9XFxcImJmdXJ5XFxcIiBkYXRhLWJpbmQ9XFxcImNsaWNrOiBjaGFuZ2VTZWxlY3RlZEl0ZW0sIGV2ZW50OiB7IGRibGNsaWNrOiBhZGRJdGVtIH1cXFwiPjwvZGl2PlxcbiAgPGRpdiBjbGFzcz1cXFwiaW1nLXJvdW5kZWQgaXRlbXMtc3ByaXRlLTUweDM2IGl0ZW1zLXNwcml0ZS1ldGhlcmVhbF9ibGFkZVxcXCIgaWQ9XFxcImV0aGVyZWFsX2JsYWRlXFxcIiBkYXRhLWJpbmQ9XFxcImNsaWNrOiBjaGFuZ2VTZWxlY3RlZEl0ZW0sIGV2ZW50OiB7IGRibGNsaWNrOiBhZGRJdGVtIH1cXFwiPjwvZGl2PlxcbiAgPGRpdiBjbGFzcz1cXFwiaW1nLXJvdW5kZWQgaXRlbXMtc3ByaXRlLTUweDM2IGl0ZW1zLXNwcml0ZS1zaWx2ZXJfZWRnZVxcXCIgaWQ9XFxcInNpbHZlcl9lZGdlXFxcIiBkYXRhLWJpbmQ9XFxcImNsaWNrOiBjaGFuZ2VTZWxlY3RlZEl0ZW0sIGV2ZW50OiB7IGRibGNsaWNrOiBhZGRJdGVtIH1cXFwiPjwvZGl2PlxcbiAgPGRpdiBjbGFzcz1cXFwiaW1nLXJvdW5kZWQgaXRlbXMtc3ByaXRlLTUweDM2IGl0ZW1zLXNwcml0ZS1yYWRpYW5jZVxcXCIgaWQ9XFxcInJhZGlhbmNlXFxcIiBkYXRhLWJpbmQ9XFxcImNsaWNrOiBjaGFuZ2VTZWxlY3RlZEl0ZW0sIGV2ZW50OiB7IGRibGNsaWNrOiBhZGRJdGVtIH1cXFwiPjwvZGl2PlxcbiAgPGRpdiBjbGFzcz1cXFwiaW1nLXJvdW5kZWQgaXRlbXMtc3ByaXRlLTUweDM2IGl0ZW1zLXNwcml0ZS1tb25rZXlfa2luZ19iYXJcXFwiIGlkPVxcXCJtb25rZXlfa2luZ19iYXJcXFwiIGRhdGEtYmluZD1cXFwiY2xpY2s6IGNoYW5nZVNlbGVjdGVkSXRlbSwgZXZlbnQ6IHsgZGJsY2xpY2s6IGFkZEl0ZW0gfVxcXCI+PC9kaXY+XFxuICA8ZGl2IGNsYXNzPVxcXCJpbWctcm91bmRlZCBpdGVtcy1zcHJpdGUtNTB4MzYgaXRlbXMtc3ByaXRlLWdyZWF0ZXJfY3JpdFxcXCIgaWQ9XFxcImdyZWF0ZXJfY3JpdFxcXCIgZGF0YS1iaW5kPVxcXCJjbGljazogY2hhbmdlU2VsZWN0ZWRJdGVtLCBldmVudDogeyBkYmxjbGljazogYWRkSXRlbSB9XFxcIj48L2Rpdj5cXG4gIDxkaXYgY2xhc3M9XFxcImltZy1yb3VuZGVkIGl0ZW1zLXNwcml0ZS01MHgzNiBpdGVtcy1zcHJpdGUtYnV0dGVyZmx5XFxcIiBpZD1cXFwiYnV0dGVyZmx5XFxcIiBkYXRhLWJpbmQ9XFxcImNsaWNrOiBjaGFuZ2VTZWxlY3RlZEl0ZW0sIGV2ZW50OiB7IGRibGNsaWNrOiBhZGRJdGVtIH1cXFwiPjwvZGl2PlxcbiAgPGRpdiBjbGFzcz1cXFwiaW1nLXJvdW5kZWQgaXRlbXMtc3ByaXRlLTUweDM2IGl0ZW1zLXNwcml0ZS1yYXBpZXJcXFwiIGlkPVxcXCJyYXBpZXJcXFwiIGRhdGEtYmluZD1cXFwiY2xpY2s6IGNoYW5nZVNlbGVjdGVkSXRlbSwgZXZlbnQ6IHsgZGJsY2xpY2s6IGFkZEl0ZW0gfVxcXCI+PC9kaXY+XFxuICA8ZGl2IGNsYXNzPVxcXCJpbWctcm91bmRlZCBpdGVtcy1zcHJpdGUtNTB4MzYgaXRlbXMtc3ByaXRlLWFieXNzYWxfYmxhZGVcXFwiIGlkPVxcXCJhYnlzc2FsX2JsYWRlXFxcIiBkYXRhLWJpbmQ9XFxcImNsaWNrOiBjaGFuZ2VTZWxlY3RlZEl0ZW0sIGV2ZW50OiB7IGRibGNsaWNrOiBhZGRJdGVtIH1cXFwiPjwvZGl2PlxcbiAgPGRpdiBjbGFzcz1cXFwiaW1nLXJvdW5kZWQgaXRlbXMtc3ByaXRlLTUweDM2IGl0ZW1zLXNwcml0ZS1ibG9vZHRob3JuXFxcIiBpZD1cXFwiYmxvb2R0aG9yblxcXCIgZGF0YS1iaW5kPVxcXCJjbGljazogY2hhbmdlU2VsZWN0ZWRJdGVtLCBldmVudDogeyBkYmxjbGljazogYWRkSXRlbSB9XFxcIj48L2Rpdj5cXG48L2Rpdj5cXG48ZGl2IGNsYXNzPVxcXCJzaG9wLWNvbHVtblxcXCI+XFxuICA8ZGl2IGNsYXNzPVxcXCJoYy1zaG9wIGhjLXNob3AtYXJtb3JcXFwiIGlkPVxcXCJhcm1vclxcXCI+PC9kaXY+XFxuICA8ZGl2IGNsYXNzPVxcXCJpbWctcm91bmRlZCBpdGVtcy1zcHJpdGUtNTB4MzYgaXRlbXMtc3ByaXRlLWhvb2Rfb2ZfZGVmaWFuY2VcXFwiIGlkPVxcXCJob29kX29mX2RlZmlhbmNlXFxcIiBkYXRhLWJpbmQ9XFxcImNsaWNrOiBjaGFuZ2VTZWxlY3RlZEl0ZW0sIGV2ZW50OiB7IGRibGNsaWNrOiBhZGRJdGVtIH1cXFwiPjwvZGl2PlxcbiAgPGRpdiBjbGFzcz1cXFwiaW1nLXJvdW5kZWQgaXRlbXMtc3ByaXRlLTUweDM2IGl0ZW1zLXNwcml0ZS12YW5ndWFyZFxcXCIgaWQ9XFxcInZhbmd1YXJkXFxcIiBkYXRhLWJpbmQ9XFxcImNsaWNrOiBjaGFuZ2VTZWxlY3RlZEl0ZW0sIGV2ZW50OiB7IGRibGNsaWNrOiBhZGRJdGVtIH1cXFwiPjwvZGl2PlxcbiAgPGRpdiBjbGFzcz1cXFwiaW1nLXJvdW5kZWQgaXRlbXMtc3ByaXRlLTUweDM2IGl0ZW1zLXNwcml0ZS1ibGFkZV9tYWlsXFxcIiBpZD1cXFwiYmxhZGVfbWFpbFxcXCIgZGF0YS1iaW5kPVxcXCJjbGljazogY2hhbmdlU2VsZWN0ZWRJdGVtLCBldmVudDogeyBkYmxjbGljazogYWRkSXRlbSB9XFxcIj48L2Rpdj5cXG4gIDxkaXYgY2xhc3M9XFxcImltZy1yb3VuZGVkIGl0ZW1zLXNwcml0ZS01MHgzNiBpdGVtcy1zcHJpdGUtc291bF9ib29zdGVyXFxcIiBpZD1cXFwic291bF9ib29zdGVyXFxcIiBkYXRhLWJpbmQ9XFxcImNsaWNrOiBjaGFuZ2VTZWxlY3RlZEl0ZW0sIGV2ZW50OiB7IGRibGNsaWNrOiBhZGRJdGVtIH1cXFwiPjwvZGl2PlxcbiAgPGRpdiBjbGFzcz1cXFwiaW1nLXJvdW5kZWQgaXRlbXMtc3ByaXRlLTUweDM2IGl0ZW1zLXNwcml0ZS1jcmltc29uX2d1YXJkXFxcIiBpZD1cXFwiY3JpbXNvbl9ndWFyZFxcXCIgZGF0YS1iaW5kPVxcXCJjbGljazogY2hhbmdlU2VsZWN0ZWRJdGVtLCBldmVudDogeyBkYmxjbGljazogYWRkSXRlbSB9XFxcIj48L2Rpdj5cXG4gIDxkaXYgY2xhc3M9XFxcImltZy1yb3VuZGVkIGl0ZW1zLXNwcml0ZS01MHgzNiBpdGVtcy1zcHJpdGUtYmxhY2tfa2luZ19iYXJcXFwiIGlkPVxcXCJibGFja19raW5nX2JhclxcXCIgZGF0YS1iaW5kPVxcXCJjbGljazogY2hhbmdlU2VsZWN0ZWRJdGVtLCBldmVudDogeyBkYmxjbGljazogYWRkSXRlbSB9XFxcIj48L2Rpdj5cXG4gIDxkaXYgY2xhc3M9XFxcImltZy1yb3VuZGVkIGl0ZW1zLXNwcml0ZS01MHgzNiBpdGVtcy1zcHJpdGUtbG90dXNfb3JiXFxcIiBpZD1cXFwibG90dXNfb3JiXFxcIiBkYXRhLWJpbmQ9XFxcImNsaWNrOiBjaGFuZ2VTZWxlY3RlZEl0ZW0sIGV2ZW50OiB7IGRibGNsaWNrOiBhZGRJdGVtIH1cXFwiPjwvZGl2PlxcbiAgPGRpdiBjbGFzcz1cXFwiaW1nLXJvdW5kZWQgaXRlbXMtc3ByaXRlLTUweDM2IGl0ZW1zLXNwcml0ZS1zaGl2YXNfZ3VhcmRcXFwiIGlkPVxcXCJzaGl2YXNfZ3VhcmRcXFwiIGRhdGEtYmluZD1cXFwiY2xpY2s6IGNoYW5nZVNlbGVjdGVkSXRlbSwgZXZlbnQ6IHsgZGJsY2xpY2s6IGFkZEl0ZW0gfVxcXCI+PC9kaXY+XFxuICA8ZGl2IGNsYXNzPVxcXCJpbWctcm91bmRlZCBpdGVtcy1zcHJpdGUtNTB4MzYgaXRlbXMtc3ByaXRlLWJsb29kc3RvbmVcXFwiIGlkPVxcXCJibG9vZHN0b25lXFxcIiBkYXRhLWJpbmQ9XFxcImNsaWNrOiBjaGFuZ2VTZWxlY3RlZEl0ZW0sIGV2ZW50OiB7IGRibGNsaWNrOiBhZGRJdGVtIH1cXFwiPjwvZGl2PlxcbiAgPGRpdiBjbGFzcz1cXFwiaW1nLXJvdW5kZWQgaXRlbXMtc3ByaXRlLTUweDM2IGl0ZW1zLXNwcml0ZS1tYW50YVxcXCIgaWQ9XFxcIm1hbnRhXFxcIiBkYXRhLWJpbmQ9XFxcImNsaWNrOiBjaGFuZ2VTZWxlY3RlZEl0ZW0sIGV2ZW50OiB7IGRibGNsaWNrOiBhZGRJdGVtIH1cXFwiPjwvZGl2PlxcbiAgPGRpdiBjbGFzcz1cXFwiaW1nLXJvdW5kZWQgaXRlbXMtc3ByaXRlLTUweDM2IGl0ZW1zLXNwcml0ZS1zcGhlcmVcXFwiIGlkPVxcXCJzcGhlcmVcXFwiIGRhdGEtYmluZD1cXFwiY2xpY2s6IGNoYW5nZVNlbGVjdGVkSXRlbSwgZXZlbnQ6IHsgZGJsY2xpY2s6IGFkZEl0ZW0gfVxcXCI+PC9kaXY+XFxuICA8ZGl2IGNsYXNzPVxcXCJpbWctcm91bmRlZCBpdGVtcy1zcHJpdGUtNTB4MzYgaXRlbXMtc3ByaXRlLWh1cnJpY2FuZV9waWtlXFxcIiBpZD1cXFwiaHVycmljYW5lX3Bpa2VcXFwiIGRhdGEtYmluZD1cXFwiY2xpY2s6IGNoYW5nZVNlbGVjdGVkSXRlbSwgZXZlbnQ6IHsgZGJsY2xpY2s6IGFkZEl0ZW0gfVxcXCI+PC9kaXY+XFxuICA8ZGl2IGNsYXNzPVxcXCJpbWctcm91bmRlZCBpdGVtcy1zcHJpdGUtNTB4MzYgaXRlbXMtc3ByaXRlLWFzc2F1bHRcXFwiIGlkPVxcXCJhc3NhdWx0XFxcIiBkYXRhLWJpbmQ9XFxcImNsaWNrOiBjaGFuZ2VTZWxlY3RlZEl0ZW0sIGV2ZW50OiB7IGRibGNsaWNrOiBhZGRJdGVtIH1cXFwiPjwvZGl2PlxcbiAgPGRpdiBjbGFzcz1cXFwiaW1nLXJvdW5kZWQgaXRlbXMtc3ByaXRlLTUweDM2IGl0ZW1zLXNwcml0ZS1oZWFydFxcXCIgaWQ9XFxcImhlYXJ0XFxcIiBkYXRhLWJpbmQ9XFxcImNsaWNrOiBjaGFuZ2VTZWxlY3RlZEl0ZW0sIGV2ZW50OiB7IGRibGNsaWNrOiBhZGRJdGVtIH1cXFwiPjwvZGl2PlxcbjwvZGl2PlxcbjxkaXYgY2xhc3M9XFxcInNob3AtY29sdW1uXFxcIj5cXG4gIDxkaXYgY2xhc3M9XFxcImhjLXNob3AgaGMtc2hvcC1hcnRpZmFjdHNcXFwiIGlkPVxcXCJhcnRpZmFjdHNcXFwiPjwvZGl2PlxcbiAgPGRpdiBjbGFzcz1cXFwiaW1nLXJvdW5kZWQgaXRlbXMtc3ByaXRlLTUweDM2IGl0ZW1zLXNwcml0ZS1tYXNrX29mX21hZG5lc3NcXFwiIGlkPVxcXCJtYXNrX29mX21hZG5lc3NcXFwiIGRhdGEtYmluZD1cXFwiY2xpY2s6IGNoYW5nZVNlbGVjdGVkSXRlbSwgZXZlbnQ6IHsgZGJsY2xpY2s6IGFkZEl0ZW0gfVxcXCI+PC9kaXY+XFxuICA8ZGl2IGNsYXNzPVxcXCJpbWctcm91bmRlZCBpdGVtcy1zcHJpdGUtNTB4MzYgaXRlbXMtc3ByaXRlLWhlbG1fb2ZfdGhlX2RvbWluYXRvclxcXCIgaWQ9XFxcImhlbG1fb2ZfdGhlX2RvbWluYXRvclxcXCIgZGF0YS1iaW5kPVxcXCJjbGljazogY2hhbmdlU2VsZWN0ZWRJdGVtLCBldmVudDogeyBkYmxjbGljazogYWRkSXRlbSB9XFxcIj48L2Rpdj5cXG4gIDxkaXYgY2xhc3M9XFxcImltZy1yb3VuZGVkIGl0ZW1zLXNwcml0ZS01MHgzNiBpdGVtcy1zcHJpdGUtZHJhZ29uX2xhbmNlXFxcIiBpZD1cXFwiZHJhZ29uX2xhbmNlXFxcIiBkYXRhLWJpbmQ9XFxcImNsaWNrOiBjaGFuZ2VTZWxlY3RlZEl0ZW0sIGV2ZW50OiB7IGRibGNsaWNrOiBhZGRJdGVtIH1cXFwiPjwvZGl2PlxcbiAgPGRpdiBjbGFzcz1cXFwiaW1nLXJvdW5kZWQgaXRlbXMtc3ByaXRlLTUweDM2IGl0ZW1zLXNwcml0ZS1zYW5nZVxcXCIgaWQ9XFxcInNhbmdlXFxcIiBkYXRhLWJpbmQ9XFxcImNsaWNrOiBjaGFuZ2VTZWxlY3RlZEl0ZW0sIGV2ZW50OiB7IGRibGNsaWNrOiBhZGRJdGVtIH1cXFwiPjwvZGl2PlxcbiAgPGRpdiBjbGFzcz1cXFwiaW1nLXJvdW5kZWQgaXRlbXMtc3ByaXRlLTUweDM2IGl0ZW1zLXNwcml0ZS15YXNoYVxcXCIgaWQ9XFxcInlhc2hhXFxcIiBkYXRhLWJpbmQ9XFxcImNsaWNrOiBjaGFuZ2VTZWxlY3RlZEl0ZW0sIGV2ZW50OiB7IGRibGNsaWNrOiBhZGRJdGVtIH1cXFwiPjwvZGl2PlxcbiAgPGRpdiBjbGFzcz1cXFwiaW1nLXJvdW5kZWQgaXRlbXMtc3ByaXRlLTUweDM2IGl0ZW1zLXNwcml0ZS1lY2hvX3NhYnJlXFxcIiBpZD1cXFwiZWNob19zYWJyZVxcXCIgZGF0YS1iaW5kPVxcXCJjbGljazogY2hhbmdlU2VsZWN0ZWRJdGVtLCBldmVudDogeyBkYmxjbGljazogYWRkSXRlbSB9XFxcIj48L2Rpdj5cXG4gIDxkaXYgY2xhc3M9XFxcImltZy1yb3VuZGVkIGl0ZW1zLXNwcml0ZS01MHgzNiBpdGVtcy1zcHJpdGUtbWFlbHN0cm9tXFxcIiBpZD1cXFwibWFlbHN0cm9tXFxcIiBkYXRhLWJpbmQ9XFxcImNsaWNrOiBjaGFuZ2VTZWxlY3RlZEl0ZW0sIGV2ZW50OiB7IGRibGNsaWNrOiBhZGRJdGVtIH1cXFwiPjwvZGl2PlxcbiAgPGRpdiBjbGFzcz1cXFwiaW1nLXJvdW5kZWQgaXRlbXMtc3ByaXRlLTUweDM2IGl0ZW1zLXNwcml0ZS1kaWZmdXNhbF9ibGFkZVxcXCIgaWQ9XFxcImRpZmZ1c2FsX2JsYWRlXFxcIiBkYXRhLWJpbmQ9XFxcImNsaWNrOiBjaGFuZ2VTZWxlY3RlZEl0ZW0sIGV2ZW50OiB7IGRibGNsaWNrOiBhZGRJdGVtIH1cXFwiPjwvZGl2PlxcbiAgPGRpdiBjbGFzcz1cXFwiaW1nLXJvdW5kZWQgaXRlbXMtc3ByaXRlLTUweDM2IGl0ZW1zLXNwcml0ZS1kZXNvbGF0b3JcXFwiIGlkPVxcXCJkZXNvbGF0b3JcXFwiIGRhdGEtYmluZD1cXFwiY2xpY2s6IGNoYW5nZVNlbGVjdGVkSXRlbSwgZXZlbnQ6IHsgZGJsY2xpY2s6IGFkZEl0ZW0gfVxcXCI+PC9kaXY+XFxuICA8ZGl2IGNsYXNzPVxcXCJpbWctcm91bmRlZCBpdGVtcy1zcHJpdGUtNTB4MzYgaXRlbXMtc3ByaXRlLWhlYXZlbnNfaGFsYmVyZFxcXCIgaWQ9XFxcImhlYXZlbnNfaGFsYmVyZFxcXCIgZGF0YS1iaW5kPVxcXCJjbGljazogY2hhbmdlU2VsZWN0ZWRJdGVtLCBldmVudDogeyBkYmxjbGljazogYWRkSXRlbSB9XFxcIj48L2Rpdj5cXG4gIDxkaXYgY2xhc3M9XFxcImltZy1yb3VuZGVkIGl0ZW1zLXNwcml0ZS01MHgzNiBpdGVtcy1zcHJpdGUtc2FuZ2VfYW5kX3lhc2hhXFxcIiBpZD1cXFwic2FuZ2VfYW5kX3lhc2hhXFxcIiBkYXRhLWJpbmQ9XFxcImNsaWNrOiBjaGFuZ2VTZWxlY3RlZEl0ZW0sIGV2ZW50OiB7IGRibGNsaWNrOiBhZGRJdGVtIH1cXFwiPjwvZGl2PlxcbiAgPGRpdiBjbGFzcz1cXFwiaW1nLXJvdW5kZWQgaXRlbXMtc3ByaXRlLTUweDM2IGl0ZW1zLXNwcml0ZS1za2FkaVxcXCIgaWQ9XFxcInNrYWRpXFxcIiBkYXRhLWJpbmQ9XFxcImNsaWNrOiBjaGFuZ2VTZWxlY3RlZEl0ZW0sIGV2ZW50OiB7IGRibGNsaWNrOiBhZGRJdGVtIH1cXFwiPjwvZGl2PlxcbiAgPGRpdiBjbGFzcz1cXFwiaW1nLXJvdW5kZWQgaXRlbXMtc3ByaXRlLTUweDM2IGl0ZW1zLXNwcml0ZS1tam9sbG5pclxcXCIgaWQ9XFxcIm1qb2xsbmlyXFxcIiBkYXRhLWJpbmQ9XFxcImNsaWNrOiBjaGFuZ2VTZWxlY3RlZEl0ZW0sIGV2ZW50OiB7IGRibGNsaWNrOiBhZGRJdGVtIH1cXFwiPjwvZGl2PlxcbiAgPGRpdiBjbGFzcz1cXFwiaW1nLXJvdW5kZWQgaXRlbXMtc3ByaXRlLTUweDM2IGl0ZW1zLXNwcml0ZS1zYXRhbmljXFxcIiBpZD1cXFwic2F0YW5pY1xcXCIgZGF0YS1iaW5kPVxcXCJjbGljazogY2hhbmdlU2VsZWN0ZWRJdGVtLCBldmVudDogeyBkYmxjbGljazogYWRkSXRlbSB9XFxcIj48L2Rpdj5cXG48L2Rpdj5cXG4gICAgICAgICAgICAgICAgPC9kaXY+XFxuICAgICAgICAgICAgICAgIDxkaXYgY2xhc3M9XFxcInRhYi1wYW5lXFxcIiBpZD1cXFwic2hvcF9zZWNyZXRcXFwiPlxcbjxkaXYgY2xhc3M9XFxcInNob3AtY29sdW1uXFxcIj5cXG4gIDxkaXYgY2xhc3M9XFxcImhjLXNob3AgaGMtc2hvcC1zZWNyZXRcXFwiIGlkPVxcXCJzZWNyZXRcXFwiPjwvZGl2PlxcbiAgPGRpdiBjbGFzcz1cXFwiaW1nLXJvdW5kZWQgaXRlbXMtc3ByaXRlLTUweDM2IGl0ZW1zLXNwcml0ZS1lbmVyZ3lfYm9vc3RlclxcXCIgaWQ9XFxcImVuZXJneV9ib29zdGVyXFxcIiBkYXRhLWJpbmQ9XFxcImNsaWNrOiBjaGFuZ2VTZWxlY3RlZEl0ZW0sIGV2ZW50OiB7IGRibGNsaWNrOiBhZGRJdGVtIH1cXFwiPjwvZGl2PlxcbiAgPGRpdiBjbGFzcz1cXFwiaW1nLXJvdW5kZWQgaXRlbXMtc3ByaXRlLTUweDM2IGl0ZW1zLXNwcml0ZS12aXRhbGl0eV9ib29zdGVyXFxcIiBpZD1cXFwidml0YWxpdHlfYm9vc3RlclxcXCIgZGF0YS1iaW5kPVxcXCJjbGljazogY2hhbmdlU2VsZWN0ZWRJdGVtLCBldmVudDogeyBkYmxjbGljazogYWRkSXRlbSB9XFxcIj48L2Rpdj5cXG4gIDxkaXYgY2xhc3M9XFxcImltZy1yb3VuZGVkIGl0ZW1zLXNwcml0ZS01MHgzNiBpdGVtcy1zcHJpdGUtcG9pbnRfYm9vc3RlclxcXCIgaWQ9XFxcInBvaW50X2Jvb3N0ZXJcXFwiIGRhdGEtYmluZD1cXFwiY2xpY2s6IGNoYW5nZVNlbGVjdGVkSXRlbSwgZXZlbnQ6IHsgZGJsY2xpY2s6IGFkZEl0ZW0gfVxcXCI+PC9kaXY+XFxuICA8ZGl2IGNsYXNzPVxcXCJpbWctcm91bmRlZCBpdGVtcy1zcHJpdGUtNTB4MzYgaXRlbXMtc3ByaXRlLXBsYXRlbWFpbFxcXCIgaWQ9XFxcInBsYXRlbWFpbFxcXCIgZGF0YS1iaW5kPVxcXCJjbGljazogY2hhbmdlU2VsZWN0ZWRJdGVtLCBldmVudDogeyBkYmxjbGljazogYWRkSXRlbSB9XFxcIj48L2Rpdj5cXG4gIDxkaXYgY2xhc3M9XFxcImltZy1yb3VuZGVkIGl0ZW1zLXNwcml0ZS01MHgzNiBpdGVtcy1zcHJpdGUtdGFsaXNtYW5fb2ZfZXZhc2lvblxcXCIgaWQ9XFxcInRhbGlzbWFuX29mX2V2YXNpb25cXFwiIGRhdGEtYmluZD1cXFwiY2xpY2s6IGNoYW5nZVNlbGVjdGVkSXRlbSwgZXZlbnQ6IHsgZGJsY2xpY2s6IGFkZEl0ZW0gfVxcXCI+PC9kaXY+XFxuICA8ZGl2IGNsYXNzPVxcXCJpbWctcm91bmRlZCBpdGVtcy1zcHJpdGUtNTB4MzYgaXRlbXMtc3ByaXRlLWh5cGVyc3RvbmVcXFwiIGlkPVxcXCJoeXBlcnN0b25lXFxcIiBkYXRhLWJpbmQ9XFxcImNsaWNrOiBjaGFuZ2VTZWxlY3RlZEl0ZW0sIGV2ZW50OiB7IGRibGNsaWNrOiBhZGRJdGVtIH1cXFwiPjwvZGl2PlxcbiAgPGRpdiBjbGFzcz1cXFwiaW1nLXJvdW5kZWQgaXRlbXMtc3ByaXRlLTUweDM2IGl0ZW1zLXNwcml0ZS11bHRpbWF0ZV9vcmJcXFwiIGlkPVxcXCJ1bHRpbWF0ZV9vcmJcXFwiIGRhdGEtYmluZD1cXFwiY2xpY2s6IGNoYW5nZVNlbGVjdGVkSXRlbSwgZXZlbnQ6IHsgZGJsY2xpY2s6IGFkZEl0ZW0gfVxcXCI+PC9kaXY+XFxuICA8ZGl2IGNsYXNzPVxcXCJpbWctcm91bmRlZCBpdGVtcy1zcHJpdGUtNTB4MzYgaXRlbXMtc3ByaXRlLWRlbW9uX2VkZ2VcXFwiIGlkPVxcXCJkZW1vbl9lZGdlXFxcIiBkYXRhLWJpbmQ9XFxcImNsaWNrOiBjaGFuZ2VTZWxlY3RlZEl0ZW0sIGV2ZW50OiB7IGRibGNsaWNrOiBhZGRJdGVtIH1cXFwiPjwvZGl2PlxcbiAgPGRpdiBjbGFzcz1cXFwiaW1nLXJvdW5kZWQgaXRlbXMtc3ByaXRlLTUweDM2IGl0ZW1zLXNwcml0ZS1teXN0aWNfc3RhZmZcXFwiIGlkPVxcXCJteXN0aWNfc3RhZmZcXFwiIGRhdGEtYmluZD1cXFwiY2xpY2s6IGNoYW5nZVNlbGVjdGVkSXRlbSwgZXZlbnQ6IHsgZGJsY2xpY2s6IGFkZEl0ZW0gfVxcXCI+PC9kaXY+XFxuICA8ZGl2IGNsYXNzPVxcXCJpbWctcm91bmRlZCBpdGVtcy1zcHJpdGUtNTB4MzYgaXRlbXMtc3ByaXRlLWVhZ2xlXFxcIiBpZD1cXFwiZWFnbGVcXFwiIGRhdGEtYmluZD1cXFwiY2xpY2s6IGNoYW5nZVNlbGVjdGVkSXRlbSwgZXZlbnQ6IHsgZGJsY2xpY2s6IGFkZEl0ZW0gfVxcXCI+PC9kaXY+XFxuICA8ZGl2IGNsYXNzPVxcXCJpbWctcm91bmRlZCBpdGVtcy1zcHJpdGUtNTB4MzYgaXRlbXMtc3ByaXRlLXJlYXZlclxcXCIgaWQ9XFxcInJlYXZlclxcXCIgZGF0YS1iaW5kPVxcXCJjbGljazogY2hhbmdlU2VsZWN0ZWRJdGVtLCBldmVudDogeyBkYmxjbGljazogYWRkSXRlbSB9XFxcIj48L2Rpdj5cXG4gIDxkaXYgY2xhc3M9XFxcImltZy1yb3VuZGVkIGl0ZW1zLXNwcml0ZS01MHgzNiBpdGVtcy1zcHJpdGUtcmVsaWNcXFwiIGlkPVxcXCJyZWxpY1xcXCIgZGF0YS1iaW5kPVxcXCJjbGljazogY2hhbmdlU2VsZWN0ZWRJdGVtLCBldmVudDogeyBkYmxjbGljazogYWRkSXRlbSB9XFxcIj48L2Rpdj5cXG48L2Rpdj5cXG4gICAgICAgICAgICAgICAgPC9kaXY+XFxuICAgICAgICAgICAgPC9kaXY+XFxuXFxuICAgICAgICAgICAgPGRpdiBjbGFzcz1cXFwiZm9ybS1ncm91cFxcXCIgZGF0YS1iaW5kPVxcXCJ2aXNpYmxlOiBkaXNwbGF5U2hvcCgpXFxcIj5cXG4gICAgICAgICAgICAgICAgPGRpdiBjbGFzcz1cXFwiaW5wdXQtZ3JvdXBcXFwiPlxcbiAgICAgICAgICAgICAgICAgICAgPGlucHV0IGNsYXNzPVxcXCJmb3JtLWNvbnRyb2xcXFwiIGlkPVxcXCJhdXRvXFxcIiBkYXRhLWJpbmQ9XFxcImpxQXV0bzogeyBhdXRvRm9jdXM6IHRydWUsIGh0bWw6IHRydWUgfSwganFBdXRvU291cmNlOiBpdGVtT3B0aW9ucywganFBdXRvVmFsdWU6IHNlbGVjdGVkSXRlbSwganFBdXRvU291cmNlTGFiZWw6ICdkaXNwbGF5bmFtZScsIGpxQXV0b1NvdXJjZUlucHV0VmFsdWU6ICduYW1lJywganFBdXRvU291cmNlVmFsdWU6ICd2YWx1ZSdcXFwiIC8+XFxuICAgICAgICAgICAgICAgICAgICA8c3BhbiBjbGFzcz1cXFwiaW5wdXQtZ3JvdXAtYnRuXFxcIj5cXG4gICAgICAgICAgICAgICAgICAgICAgICA8YnV0dG9uIGNsYXNzPVxcXCJidG4gYnRuLWRlZmF1bHRcXFwiIGRhdGEtYmluZD1cXFwianFBdXRvQ29tYm86ICdhdXRvJ1xcXCI+PHNwYW4gY2xhc3M9XFxcImdseXBoaWNvbiBnbHlwaGljb24tc2VhcmNoXFxcIj48L3NwYW4+PC9idXR0b24+XFxuICAgICAgICAgICAgICAgICAgICA8L3NwYW4+XFxuICAgICAgICAgICAgICAgIDwvZGl2PlxcbiAgICAgICAgICAgIDwvZGl2PlxcblxcbiAgICAgICAgICAgIDxkaXYgZGF0YS1iaW5kPVxcXCJ2aXNpYmxlOiBzZWxlY3RlZEl0ZW0oKSAmJiBkaXNwbGF5U2hvcCgpXFxcIj5cXG4gICAgICAgICAgICAgICAgPGJ1dHRvbiBjbGFzcz1cXFwiYnRuIGJ0bi1kZWZhdWx0IGJ0bi14cyBnbHlwaGljb24gZ2x5cGhpY29uLW1pbnVzIHB1bGwtcmlnaHRcXFwiIGRhdGEtYmluZD1cXFwidG9nZ2xlOiBkaXNwbGF5U2hvcEl0ZW1Ub29sdGlwLCB2aXNpYmxlOiBkaXNwbGF5U2hvcEl0ZW1Ub29sdGlwKClcXFwiIHRpdGxlPVxcXCJIaWRlIGl0ZW0gZGVzY3JpcHRpb25cXFwiPjwvYnV0dG9uPlxcbiAgICAgICAgICAgICAgICA8YnV0dG9uIGNsYXNzPVxcXCJidG4gYnRuLWRlZmF1bHQgYnRuLXhzIGdseXBoaWNvbiBnbHlwaGljb24tcGx1cyBwdWxsLXJpZ2h0XFxcIiBkYXRhLWJpbmQ9XFxcInRvZ2dsZTogZGlzcGxheVNob3BJdGVtVG9vbHRpcCwgdmlzaWJsZTogIWRpc3BsYXlTaG9wSXRlbVRvb2x0aXAoKVxcXCIgdGl0bGU9XFxcIlNob3cgaXRlbSBkZXNjcmlwdGlvblxcXCI+PC9idXR0b24+XFxuICAgICAgICAgICAgICAgIDxkaXYgZGF0YS1iaW5kPVxcXCJodG1sOiBnZXRJdGVtVG9vbHRpcERhdGEsIGNzczogeyAnaGlkZS1zaG9wLWl0ZW0tZGV0YWlscyc6ICFkaXNwbGF5U2hvcEl0ZW1Ub29sdGlwKCkgfVxcXCI+PC9kaXY+XFxuICAgICAgICAgICAgICAgIDxkaXYgc3R5bGU9XFxcIm1hcmdpbi10b3A6MTBweDttYXJnaW4tYm90dG9tOjEwcHg7XFxcIiBjbGFzcz1cXFwiZm9ybS1pbmxpbmVcXFwiIGRhdGEtYmluZD1cXFwidmlzaWJsZTogZ2V0SXRlbUlucHV0TGFiZWwoKSAhPSAnJ1xcXCI+XFxuICAgICAgICAgICAgICAgICAgICA8ZGl2IGNsYXNzPVxcXCJmb3JtLWdyb3VwXFxcIj5cXG4gICAgICAgICAgICAgICAgICAgICAgICA8bGFiZWwgZm9yPVxcXCJpdGVtaW5wdXRcXFwiIGRhdGEtYmluZD1cXFwidGV4dDogZ2V0SXRlbUlucHV0TGFiZWxcXFwiPjwvbGFiZWw+XFxuICAgICAgICAgICAgICAgICAgICAgICAgPGlucHV0IGNsYXNzPVxcXCJmb3JtLWNvbnRyb2xcXFwiIGlkPVxcXCJpdGVtaW5wdXRcXFwiIGRhdGEtYmluZD1cXFwidmFsdWU6IGl0ZW1JbnB1dFZhbHVlXFxcIiAvPlxcbiAgICAgICAgICAgICAgICAgICAgPC9kaXY+XFxuICAgICAgICAgICAgICAgIDwvZGl2PlxcbiAgICAgICAgICAgICAgICA8ZGl2IGNsYXNzPVxcXCJmb3JtLWdyb3VwIHRleHQtcmlnaHRcXFwiPlxcbiAgICAgICAgICAgICAgICAgICAgPGJ1dHRvbiBjbGFzcz1cXFwiYnRuIGJ0bi1kZWZhdWx0XFxcIiBkYXRhLWJpbmQ9XFxcImNsaWNrOiBhZGRJdGVtXFxcIj5BZGQgSXRlbTwvYnV0dG9uPlxcbiAgICAgICAgICAgICAgICA8L2Rpdj5cXG4gICAgICAgICAgICA8L2Rpdj5cXG4gICAgICAgIDwvZGl2PlwiXG59OyIsInZhciBDaGFydCA9IHJlcXVpcmUoJ2NoYXJ0LmpzJyk7XG5DaGFydC50eXBlcy5MaW5lLmV4dGVuZCh7XG4gICAgLy8gUGFzc2luZyBpbiBhIG5hbWUgcmVnaXN0ZXJzIHRoaXMgY2hhcnQgaW4gdGhlIENoYXJ0IG5hbWVzcGFjZSBpbiB0aGUgc2FtZSB3YXlcbiAgICBuYW1lOiBcIlNjYXR0ZXJcIixcbiAgICBkcmF3IDogZnVuY3Rpb24oZWFzZSl7XG4gICAgICAgICAgICB2YXIgZWFzaW5nRGVjaW1hbCA9IGVhc2UgfHwgMTtcbiAgICAgICAgICAgIHRoaXMuY2xlYXIoKTtcblxuICAgICAgICAgICAgdmFyIGN0eCA9IHRoaXMuY2hhcnQuY3R4O1xuXG4gICAgICAgICAgICAvLyBTb21lIGhlbHBlciBtZXRob2RzIGZvciBnZXR0aW5nIHRoZSBuZXh0L3ByZXYgcG9pbnRzXG4gICAgICAgICAgICB2YXIgaGFzVmFsdWUgPSBmdW5jdGlvbihpdGVtKXtcbiAgICAgICAgICAgICAgICByZXR1cm4gaXRlbS52YWx1ZSAhPT0gbnVsbDtcbiAgICAgICAgICAgIH0sXG4gICAgICAgICAgICBuZXh0UG9pbnQgPSBmdW5jdGlvbihwb2ludCwgY29sbGVjdGlvbiwgaW5kZXgpe1xuICAgICAgICAgICAgICAgIHJldHVybiBDaGFydC5oZWxwZXJzLmZpbmROZXh0V2hlcmUoY29sbGVjdGlvbiwgaGFzVmFsdWUsIGluZGV4KSB8fCBwb2ludDtcbiAgICAgICAgICAgIH0sXG4gICAgICAgICAgICBwcmV2aW91c1BvaW50ID0gZnVuY3Rpb24ocG9pbnQsIGNvbGxlY3Rpb24sIGluZGV4KXtcbiAgICAgICAgICAgICAgICByZXR1cm4gQ2hhcnQuaGVscGVycy5maW5kUHJldmlvdXNXaGVyZShjb2xsZWN0aW9uLCBoYXNWYWx1ZSwgaW5kZXgpIHx8IHBvaW50O1xuICAgICAgICAgICAgfTtcblxuICAgICAgICAgICAgdGhpcy5zY2FsZS5kcmF3KGVhc2luZ0RlY2ltYWwpO1xuXG5cbiAgICAgICAgICAgIENoYXJ0LmhlbHBlcnMuZWFjaCh0aGlzLmRhdGFzZXRzLGZ1bmN0aW9uKGRhdGFzZXQpe1xuICAgICAgICAgICAgICAgIHZhciBwb2ludHNXaXRoVmFsdWVzID0gQ2hhcnQuaGVscGVycy53aGVyZShkYXRhc2V0LnBvaW50cywgaGFzVmFsdWUpO1xuXG4gICAgICAgICAgICAgICAgLy9UcmFuc2l0aW9uIGVhY2ggcG9pbnQgZmlyc3Qgc28gdGhhdCB0aGUgbGluZSBhbmQgcG9pbnQgZHJhd2luZyBpc24ndCBvdXQgb2Ygc3luY1xuICAgICAgICAgICAgICAgIC8vV2UgY2FuIHVzZSB0aGlzIGV4dHJhIGxvb3AgdG8gY2FsY3VsYXRlIHRoZSBjb250cm9sIHBvaW50cyBvZiB0aGlzIGRhdGFzZXQgYWxzbyBpbiB0aGlzIGxvb3BcblxuICAgICAgICAgICAgICAgIENoYXJ0LmhlbHBlcnMuZWFjaChkYXRhc2V0LnBvaW50cywgZnVuY3Rpb24ocG9pbnQsIGluZGV4KXtcbiAgICAgICAgICAgICAgICAgICAgaWYgKHBvaW50Lmhhc1ZhbHVlKCkpe1xuICAgICAgICAgICAgICAgICAgICAgICAgcG9pbnQudHJhbnNpdGlvbih7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgeSA6IHRoaXMuc2NhbGUuY2FsY3VsYXRlWShwb2ludC52YWx1ZSksXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgeCA6IHRoaXMuc2NhbGUuY2FsY3VsYXRlWChpbmRleClcbiAgICAgICAgICAgICAgICAgICAgICAgIH0sIGVhc2luZ0RlY2ltYWwpO1xuICAgICAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgICAgfSx0aGlzKTtcblxuXG4gICAgICAgICAgICAgICAgLy8gQ29udHJvbCBwb2ludHMgbmVlZCB0byBiZSBjYWxjdWxhdGVkIGluIGEgc2VwZXJhdGUgbG9vcCwgYmVjYXVzZSB3ZSBuZWVkIHRvIGtub3cgdGhlIGN1cnJlbnQgeC95IG9mIHRoZSBwb2ludFxuICAgICAgICAgICAgICAgIC8vIFRoaXMgd291bGQgY2F1c2UgaXNzdWVzIHdoZW4gdGhlcmUgaXMgbm8gYW5pbWF0aW9uLCBiZWNhdXNlIHRoZSB5IG9mIHRoZSBuZXh0IHBvaW50IHdvdWxkIGJlIDAsIHNvIGJlemllcnMgd291bGQgYmUgc2tld2VkXG4gICAgICAgICAgICAgICAgaWYgKHRoaXMub3B0aW9ucy5iZXppZXJDdXJ2ZSl7XG4gICAgICAgICAgICAgICAgICAgIENoYXJ0LmhlbHBlcnMuZWFjaChwb2ludHNXaXRoVmFsdWVzLCBmdW5jdGlvbihwb2ludCwgaW5kZXgpe1xuICAgICAgICAgICAgICAgICAgICAgICAgdmFyIHRlbnNpb24gPSAoaW5kZXggPiAwICYmIGluZGV4IDwgcG9pbnRzV2l0aFZhbHVlcy5sZW5ndGggLSAxKSA/IHRoaXMub3B0aW9ucy5iZXppZXJDdXJ2ZVRlbnNpb24gOiAwO1xuICAgICAgICAgICAgICAgICAgICAgICAgcG9pbnQuY29udHJvbFBvaW50cyA9IENoYXJ0LmhlbHBlcnMuc3BsaW5lQ3VydmUoXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgcHJldmlvdXNQb2ludChwb2ludCwgcG9pbnRzV2l0aFZhbHVlcywgaW5kZXgpLFxuICAgICAgICAgICAgICAgICAgICAgICAgICAgIHBvaW50LFxuICAgICAgICAgICAgICAgICAgICAgICAgICAgIG5leHRQb2ludChwb2ludCwgcG9pbnRzV2l0aFZhbHVlcywgaW5kZXgpLFxuICAgICAgICAgICAgICAgICAgICAgICAgICAgIHRlbnNpb25cbiAgICAgICAgICAgICAgICAgICAgICAgICk7XG5cbiAgICAgICAgICAgICAgICAgICAgICAgIC8vIFByZXZlbnQgdGhlIGJlemllciBnb2luZyBvdXRzaWRlIG9mIHRoZSBib3VuZHMgb2YgdGhlIGdyYXBoXG5cbiAgICAgICAgICAgICAgICAgICAgICAgIC8vIENhcCBwdXRlciBiZXppZXIgaGFuZGxlcyB0byB0aGUgdXBwZXIvbG93ZXIgc2NhbGUgYm91bmRzXG4gICAgICAgICAgICAgICAgICAgICAgICBpZiAocG9pbnQuY29udHJvbFBvaW50cy5vdXRlci55ID4gdGhpcy5zY2FsZS5lbmRQb2ludCl7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgcG9pbnQuY29udHJvbFBvaW50cy5vdXRlci55ID0gdGhpcy5zY2FsZS5lbmRQb2ludDtcbiAgICAgICAgICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgICAgICAgICAgIGVsc2UgaWYgKHBvaW50LmNvbnRyb2xQb2ludHMub3V0ZXIueSA8IHRoaXMuc2NhbGUuc3RhcnRQb2ludCl7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgcG9pbnQuY29udHJvbFBvaW50cy5vdXRlci55ID0gdGhpcy5zY2FsZS5zdGFydFBvaW50O1xuICAgICAgICAgICAgICAgICAgICAgICAgfVxuXG4gICAgICAgICAgICAgICAgICAgICAgICAvLyBDYXAgaW5uZXIgYmV6aWVyIGhhbmRsZXMgdG8gdGhlIHVwcGVyL2xvd2VyIHNjYWxlIGJvdW5kc1xuICAgICAgICAgICAgICAgICAgICAgICAgaWYgKHBvaW50LmNvbnRyb2xQb2ludHMuaW5uZXIueSA+IHRoaXMuc2NhbGUuZW5kUG9pbnQpe1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgIHBvaW50LmNvbnRyb2xQb2ludHMuaW5uZXIueSA9IHRoaXMuc2NhbGUuZW5kUG9pbnQ7XG4gICAgICAgICAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgICAgICAgICAgICBlbHNlIGlmIChwb2ludC5jb250cm9sUG9pbnRzLmlubmVyLnkgPCB0aGlzLnNjYWxlLnN0YXJ0UG9pbnQpe1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgIHBvaW50LmNvbnRyb2xQb2ludHMuaW5uZXIueSA9IHRoaXMuc2NhbGUuc3RhcnRQb2ludDtcbiAgICAgICAgICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgICAgICAgfSx0aGlzKTtcbiAgICAgICAgICAgICAgICB9XG5cbiAgICAgICAgICAgICAgICBpZiAodGhpcy5vcHRpb25zLmRhdGFzZXRGaWxsICYmIHBvaW50c1dpdGhWYWx1ZXMubGVuZ3RoID4gMCl7XG4gICAgICAgICAgICAgICAgICAgIC8vUm91bmQgb2ZmIHRoZSBsaW5lIGJ5IGdvaW5nIHRvIHRoZSBiYXNlIG9mIHRoZSBjaGFydCwgYmFjayB0byB0aGUgc3RhcnQsIHRoZW4gZmlsbC5cbiAgICAgICAgICAgICAgICAgICAgY3R4LmxpbmVUbyhwb2ludHNXaXRoVmFsdWVzW3BvaW50c1dpdGhWYWx1ZXMubGVuZ3RoIC0gMV0ueCwgdGhpcy5zY2FsZS5lbmRQb2ludCk7XG4gICAgICAgICAgICAgICAgICAgIGN0eC5saW5lVG8ocG9pbnRzV2l0aFZhbHVlc1swXS54LCB0aGlzLnNjYWxlLmVuZFBvaW50KTtcbiAgICAgICAgICAgICAgICAgICAgY3R4LmZpbGxTdHlsZSA9IGRhdGFzZXQuZmlsbENvbG9yO1xuICAgICAgICAgICAgICAgICAgICBjdHguY2xvc2VQYXRoKCk7XG4gICAgICAgICAgICAgICAgICAgIGN0eC5maWxsKCk7XG4gICAgICAgICAgICAgICAgfVxuXG4gICAgICAgICAgICAgICAgLy9Ob3cgZHJhdyB0aGUgcG9pbnRzIG92ZXIgdGhlIGxpbmVcbiAgICAgICAgICAgICAgICAvL0EgbGl0dGxlIGluZWZmaWNpZW50IGRvdWJsZSBsb29waW5nLCBidXQgYmV0dGVyIHRoYW4gdGhlIGxpbmVcbiAgICAgICAgICAgICAgICAvL2xhZ2dpbmcgYmVoaW5kIHRoZSBwb2ludCBwb3NpdGlvbnNcbiAgICAgICAgICAgICAgICBDaGFydC5oZWxwZXJzLmVhY2gocG9pbnRzV2l0aFZhbHVlcyxmdW5jdGlvbihwb2ludCl7XG4gICAgICAgICAgICAgICAgICAgIHBvaW50LmRyYXcoKTtcbiAgICAgICAgICAgICAgICB9KTtcbiAgICAgICAgICAgIH0sdGhpcyk7XG4gICAgICAgIH1cbn0pOyIsInJlcXVpcmUoXCIuL2FwcC9wb2x5ZmlsbFwiKTtcbnZhciBSb2xsYmFyID0gcmVxdWlyZShcInJvbGxiYXItYnJvd3NlclwiKTtcbnZhciAkID0gKHR5cGVvZiB3aW5kb3cgIT09IFwidW5kZWZpbmVkXCIgPyB3aW5kb3dbJyQnXSA6IHR5cGVvZiBnbG9iYWwgIT09IFwidW5kZWZpbmVkXCIgPyBnbG9iYWxbJyQnXSA6IG51bGwpO1xudmFyIGdldFBhcmFtZXRlckJ5TmFtZSA9IHJlcXVpcmUoXCIuL2FwcC9nZXRQYXJhbWV0ZXJCeU5hbWVcIik7XG52YXIgSGVyb0NhbGMgPSByZXF1aXJlKFwiZG90YS1oZXJvLWNhbGN1bGF0b3ItbGlicmFyeVwiKTtcbnZhciBIZXJvQ2FsY3VsYXRvclZpZXdNb2RlbCA9IHJlcXVpcmUoJy4vYXBwL0hlcm9DYWxjdWxhdG9yVmlld01vZGVsJyk7XG52YXIgdmlld01vZGVsO1xuXG52YXIgQXBwID0gZnVuY3Rpb24gKGFwcENvbmZpZykge1xuICAgIFxuICAgIEhlcm9DYWxjLmluaXQobnVsbCwgbnVsbCwgbnVsbCwgZnVuY3Rpb24gKCkge1xuICAgICAgICBcbiAgICAgICAgdmlld01vZGVsID0gbmV3IEhlcm9DYWxjdWxhdG9yVmlld01vZGVsKGFwcENvbmZpZy5hYmlsaXR5VG9vbHRpcFBhdGgpO1xuICAgICAgICBrby5vcHRpb25zLmRlZmVyVXBkYXRlcyA9IHRydWU7XG4gICAgICAgIGtvLmFwcGx5QmluZGluZ3Modmlld01vZGVsKTtcbiAgICAgICAgJCgnI3NwaW5uZXInKS5oaWRlKCk7XG4gICAgICAgICQoJy5pbml0aWFsLWhpZGRlbicpLmNzcygnZGlzcGxheScsICdpbmxpbmUtYmxvY2snKTtcbiAgICAgICAgJCgnI3BvcEhlcm8wJykuYWRkQ2xhc3MoJ2FjdGl2ZScpO1xuICAgICAgICAkKCcjaGVyb1BhbmUwJykuYWRkQ2xhc3MoJ2FjdGl2ZScpO1xuICAgICAgICAkKCdbZGF0YS10b2dnbGU9XCJ0b29sdGlwXCJdJykudG9vbHRpcCgpO1xuICAgICAgICB2YXIgc2F2ZUlkID0gZ2V0UGFyYW1ldGVyQnlOYW1lKCdpZCcpO1xuICAgICAgICBpZiAoc2F2ZUlkKSB7XG4gICAgICAgICAgICAkLmdldCgnc2F2ZS8nICsgc2F2ZUlkICsgJy5qc29uJywgZnVuY3Rpb24gKGRhdGEpIHtcbiAgICAgICAgICAgICAgICB2aWV3TW9kZWwubG9hZChkYXRhKTtcbiAgICAgICAgICAgIH0pO1xuICAgICAgICB9XG4gICAgfSk7XG5cbiAgICB2YXIgbGFzdFVwZGF0ZSA9IFwiI0RFVl9CVUlMRFwiO1xuICAgICQoJyNsYXN0LXVwZGF0ZScpLnRleHQobGFzdFVwZGF0ZSk7XG5cbiAgICB2YXIgcm9sbGJhckNvbmZpZyA9IHtcbiAgICAgICAgYWNjZXNzVG9rZW46ICdkZTE5ODBmY2FiNDg0OWQ2YTdhMDY2Y2YwOThhNjUyMScsXG4gICAgICAgIGNhcHR1cmVVbmNhdWdodDogdHJ1ZSxcbiAgICAgICAgcGF5bG9hZDoge1xuICAgICAgICAgICAgZW52aXJvbm1lbnQ6ICdkZXZlbG9wbWVudCcsXG4gICAgICAgICAgICBjbGllbnQ6IHtcbiAgICAgICAgICAgICAgICBqYXZhc2NyaXB0OiB7XG4gICAgICAgICAgICAgICAgICAgIHNvdXJjZV9tYXBfZW5hYmxlZDogdHJ1ZSxcbiAgICAgICAgICAgICAgICAgICAgY29kZV92ZXJzaW9uOiBcIiNjb2RlX3ZlcnNpb25cIixcbiAgICAgICAgICAgICAgICAgICAgLy8gT3B0aW9uYWxseSBoYXZlIFJvbGxiYXIgZ3Vlc3Mgd2hpY2ggZnJhbWVzIHRoZSBlcnJvciB3YXMgdGhyb3duIGZyb21cbiAgICAgICAgICAgICAgICAgICAgLy8gd2hlbiB0aGUgYnJvd3NlciBkb2VzIG5vdCBwcm92aWRlIGxpbmUgYW5kIGNvbHVtbiBudW1iZXJzLlxuICAgICAgICAgICAgICAgICAgICBndWVzc191bmNhdWdodF9mcmFtZXM6IHRydWVcbiAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICB9XG4gICAgICAgIH1cbiAgICB9O1xuXG4gICAgdmFyIHJvbGxiYXIgPSBSb2xsYmFyLmluaXQocm9sbGJhckNvbmZpZyk7XG5cbiAgICAkKCcuZXJyb3Itd2FybmluZy12aWV3LCAuZXJyb3Itd2FybmluZy1jbG9zZScpLmNsaWNrKGZ1bmN0aW9uICgpIHtcbiAgICAgICAgJCgnLmVycm9yLXdhcm5pbmcnKS5mYWRlT3V0KDIwMCk7XG4gICAgfSk7XG5cbiAgICB2YXIgdXNlckFjdGlvbnMgPSBbXTtcbiAgICBmdW5jdGlvbiBhZGRVc2VyQWN0aW9uKG8pIHtcbiAgICAgICAgaWYgKHVzZXJBY3Rpb25zLmxlbmd0aCA+IDEwKSB7XG4gICAgICAgICAgICB1c2VyQWN0aW9ucy5zaGlmdCgpO1xuICAgICAgICB9XG4gICAgICAgIHVzZXJBY3Rpb25zLnB1c2gobyk7XG4gICAgfVxuXG4gICAgZnVuY3Rpb24gYWN0aW9uVHJhY2tXcmFwcGVyKGZ1bmMsIGV2ZW50TmFtZSkge1xuICAgICAgICByZXR1cm4gZnVuY3Rpb24oKSB7XG4gICAgICAgICAgICB2YXIgZWwgPSB0aGlzO1xuICAgICAgICAgICAgdmFyIGRhdGEgPSB7XG4gICAgICAgICAgICAgICAgZXZlbnROYW1lOiBldmVudE5hbWVcbiAgICAgICAgICAgIH07XG4gICAgICAgICAgICBpZiAoZWwuaWQpIGRhdGEuaWQgPSBlbC5pZDtcbiAgICAgICAgICAgIGlmIChlbC5zcmMpIGRhdGEuc3JjID0gZWwuc3JjO1xuICAgICAgICAgICAgaWYgKGVsLmNsYXNzTmFtZSkgZGF0YS5jbGFzc05hbWUgPSBlbC5jbGFzc05hbWU7XG4gICAgICAgICAgICBpZiAoZWwudGV4dENvbnRlbnQpIGRhdGEudGV4dENvbnRlbnQgPSBlbC50ZXh0Q29udGVudDtcbiAgICAgICAgICAgIGlmIChlbC5ub2RlTmFtZSkgZGF0YS5ub2RlTmFtZSA9IGVsLm5vZGVOYW1lO1xuICAgICAgICAgICAgaWYgKGVsLmdldEF0dHJpYnV0ZSgnZGF0YS1iaW5kJykpIGRhdGFbJ2RhdGEtYmluZCddID0gZWwuZ2V0QXR0cmlidXRlKCdkYXRhLWJpbmQnKTtcbiAgICAgICAgICAgIFxuICAgICAgICAgICAgZm9yICh2YXIgcHJvcGVydHkgaW4gZGF0YSkge1xuICAgICAgICAgICAgICAgIGlmIChkYXRhLmhhc093blByb3BlcnR5KHByb3BlcnR5KSkge1xuICAgICAgICAgICAgICAgICAgICBkYXRhW3Byb3BlcnR5XSA9IGRhdGFbcHJvcGVydHldLnN1YnN0cmluZygwLCBNYXRoLm1pbigyMDAsIGRhdGFbcHJvcGVydHldLmxlbmd0aCkpO1xuICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgIH1cbiAgICAgICAgICAgIGFkZFVzZXJBY3Rpb24oZGF0YSk7XG4gICAgICAgICAgICByZXR1cm4gZnVuYy5hcHBseSh0aGlzLCBhcmd1bWVudHMpO1xuICAgICAgICB9XG4gICAgfVxuXG4gICAgZnVuY3Rpb24gY2FsbGJhY2tXcmFwKG9iamVjdCwgcHJvcGVydHksIGFyZ3VtZW50SW5kZXgsIHdyYXBwZXJGYWN0b3J5LCBldmVudEZpbHRlcikge1xuICAgICAgICB2YXIgb3JpZ2luYWwgPSBvYmplY3RbcHJvcGVydHldO1xuICAgICAgICBvYmplY3RbcHJvcGVydHldID0gZnVuY3Rpb24oKSB7XG4gICAgICAgICAgICBpZiAoZXZlbnRGaWx0ZXIuaW5kZXhPZihhcmd1bWVudHNbMF0pICE9IC0xKSB7XG4gICAgICAgICAgICAgICAgYXJndW1lbnRzW2FyZ3VtZW50SW5kZXhdID0gd3JhcHBlckZhY3RvcnkoYXJndW1lbnRzW2FyZ3VtZW50SW5kZXhdLCBhcmd1bWVudHNbMF0pO1xuICAgICAgICAgICAgfVxuICAgICAgICAgICAgcmV0dXJuIG9yaWdpbmFsLmFwcGx5KHRoaXMsIGFyZ3VtZW50cyk7XG4gICAgICAgIH1cbiAgICAgICAgcmV0dXJuIG9yaWdpbmFsO1xuICAgIH1cblxuICAgIGNhbGxiYWNrV3JhcChFbGVtZW50LnByb3RvdHlwZSwgXCJhZGRFdmVudExpc3RlbmVyXCIsIDEsIGFjdGlvblRyYWNrV3JhcHBlciwgWydjbGljaycsICdmb2N1cycsICdibHVyJywgJ2NoYW5nZScsICdkYmxjbGljayddKVxuXG4gICAgd2luZG93Lm9uZXJyb3IgPSAoZnVuY3Rpb24gKG9sZCkge1xuICAgICAgICByZXR1cm4gZnVuY3Rpb24gKCkge1xuICAgICAgICAgICAgdmFyIHBheWxvYWQgPSB7fTtcbiAgICAgICAgICAgIHZhciBsb2dFbCA9IGRvY3VtZW50LnF1ZXJ5U2VsZWN0b3IoJyNsb2cnKTtcblxuICAgICAgICAgICAgaWYgKGxvZ0VsKSB7XG4gICAgICAgICAgICAgICAgdHJ5IHtcbiAgICAgICAgICAgICAgICAgICAgdmFyIG1zZyA9IGFyZ3VtZW50c1swXTtcbiAgICAgICAgICAgICAgICAgICAgdmFyIGVsID0gZG9jdW1lbnQuY3JlYXRlRWxlbWVudCgnZGl2Jyk7XG4gICAgICAgICAgICAgICAgICAgIGVsLmNsYXNzTGlzdC5hZGQoJ2FsZXJ0Jyk7XG4gICAgICAgICAgICAgICAgICAgIGVsLmNsYXNzTGlzdC5hZGQoJ2FsZXJ0LWRhbmdlcicpO1xuICAgICAgICAgICAgICAgICAgICBlbC5jbGFzc0xpc3QuYWRkKCdlcnJvci1sb2cnKTtcbiAgICAgICAgICAgICAgICAgICAgZWwuY2xhc3NMaXN0LmFkZCgnY29sLW1kLTEyJyk7XG4gICAgICAgICAgICAgICAgICAgIGVsLnRleHRDb250ZW50ID0gJ2Vycm9yOiAnICsgbXNnO1xuICAgICAgICAgICAgICAgICAgICBcbiAgICAgICAgICAgICAgICAgICAgdmFyIGNsb3NlQnRuID0gZG9jdW1lbnQuY3JlYXRlRWxlbWVudCgnZGl2Jyk7XG4gICAgICAgICAgICAgICAgICAgIGNsb3NlQnRuLmNsYXNzTGlzdC5hZGQoJ2Vycm9yLWxvZy1jbG9zZScpO1xuICAgICAgICAgICAgICAgICAgICBjbG9zZUJ0bi5pbm5lckhUTUwgPSBcIiZ0aW1lcztcIjtcbiAgICAgICAgICAgICAgICAgICAgY2xvc2VCdG4ub25jbGljayA9IGZ1bmN0aW9uICgpIHtcbiAgICAgICAgICAgICAgICAgICAgICAgIGxvZ0VsLnJlbW92ZUNoaWxkKGVsKTtcbiAgICAgICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICAgICAgICBlbC5hcHBlbmRDaGlsZChjbG9zZUJ0bik7XG4gICAgICAgICAgICAgICAgICAgIFxuICAgICAgICAgICAgICAgICAgICB2YXIgcmVwb3J0RWwgPSBkb2N1bWVudC5jcmVhdGVFbGVtZW50KCdhJyk7XG4gICAgICAgICAgICAgICAgICAgIHJlcG9ydEVsLmNsYXNzTGlzdC5hZGQoJ2Vycm9yLWxvZy1saW5rJyk7XG4gICAgICAgICAgICAgICAgICAgIHJlcG9ydEVsLmlubmVySFRNTCA9IFwiU2VuZCBlcnJvciByZXBvcnRcIjtcbiAgICAgICAgICAgICAgICAgICAgcmVwb3J0RWwuaHJlZiA9IFwiI1wiXG4gICAgICAgICAgICAgICAgICAgIHJlcG9ydEVsLm9uY2xpY2sgPSBmdW5jdGlvbiAoKSB7XG4gICAgICAgICAgICAgICAgICAgICAgICAkKCcjbXlNb2RhbCcpLm1vZGFsKCdzaG93Jyk7XG4gICAgICAgICAgICAgICAgICAgICAgICAkKCcjQnVnUmVwb3J0Rm9ybVRleHQnKS50ZXh0KCdlcnJvcjogJyArIG1zZyArICdcXG5cXG5EZXNjcmliZSB3aGF0IHlvdSB3ZXJlIGRvaW5nLiBUcnkgdG8gYmUgYXMgZGV0YWlsZWQgYXMgcG9zc2libGUuJyk7XG4gICAgICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgICAgICAgZWwuYXBwZW5kQ2hpbGQocmVwb3J0RWwpO1xuICAgICAgICAgICAgICAgICAgICBcbiAgICAgICAgICAgICAgICAgICAgbG9nRWwuYXBwZW5kQ2hpbGQoZWwpO1xuICAgICAgICAgICAgICAgICAgICBcbiAgICAgICAgICAgICAgICAgICAgJCgnLmVycm9yLXdhcm5pbmcnKS5mYWRlT3V0KDIwMCkuZmFkZUluKDEwMCk7XG4gICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICAgIGNhdGNoIChlKSB7XG4gICAgICAgICAgICAgICAgICAgIHJvbGxiYXIuZXJyb3IoXCJ3aW5kb3cub25lcnJvciBjcmVhdGUgZXJyb3IgbG9nIGZhaWxlZC5cIiwgZSk7XG4gICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgfVxuICAgICAgICAgICAgZWxzZSB7XG4gICAgICAgICAgICAgICAgcGF5bG9hZC5jbGllbnRMb2dDcmVhdGVkID0gZmFsc2U7XG4gICAgICAgICAgICB9XG5cbiAgICAgICAgICAgIGlmIChIZXJvQ2FsY3VsYXRvclZpZXdNb2RlbCAmJiB2aWV3TW9kZWwpIHtcbiAgICAgICAgICAgICAgICB0cnkge1xuICAgICAgICAgICAgICAgICAgICBwYXlsb2FkLmhlcm9DYWxjU3RhdGUgPSB2aWV3TW9kZWwuZ2V0U2F2ZURhdGEoKTtcbiAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgICAgY2F0Y2ggKGUpIHtcbiAgICAgICAgICAgICAgICAgICAgcm9sbGJhci5lcnJvcihcIndpbmRvdy5vbmVycm9yIGdldFNhdmVEYXRhIGZhaWxlZC5cIiwgZSk7XG4gICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICAgIHRyeSB7XG4gICAgICAgICAgICAgICAgICAgIHBheWxvYWQuYXBwU3RhdGUgPSB2aWV3TW9kZWwuZ2V0QXBwU3RhdGUoKTtcbiAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgICAgY2F0Y2ggKGUpIHtcbiAgICAgICAgICAgICAgICAgICAgcm9sbGJhci5lcnJvcihcIndpbmRvdy5vbmVycm9yIGdldEFwcFN0YXRlIGZhaWxlZC5cIiwgZSk7XG4gICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgfVxuICAgICAgICAgICAgZWxzZSB7XG4gICAgICAgICAgICAgICAgcGF5bG9hZC5hcHBTdGF0ZSA9IFwibG9hZCBmYWlsZWRcIlxuICAgICAgICAgICAgfVxuICAgICAgICAgICAgcGF5bG9hZC51c2VyQWN0aW9ucyA9IHVzZXJBY3Rpb25zO1xuICAgICAgICAgICAgcm9sbGJhci5jb25maWd1cmUoe1xuICAgICAgICAgICAgICBwYXlsb2FkOiB7Y3VzdG9tOiBwYXlsb2FkfVxuICAgICAgICAgICAgfSk7XG4gICAgICAgICAgICBcbiAgICAgICAgICAgIHJldHVybiBvbGQuYXBwbHkodGhpcywgYXJndW1lbnRzKTtcbiAgICAgICAgfVxuICAgIH0pKHdpbmRvdy5vbmVycm9yKTtcbiAgICBcbn07XG5cbm1vZHVsZS5leHBvcnRzID0gQXBwOyJdfQ==
